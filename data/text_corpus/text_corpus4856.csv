index,text
24280,just as competition cooperation is also a fundamental aspect of species growth and survival strategies an optimal degree of aggregation is necessary for survival and optimum population growth perfectly balancing competition and cooperation like cooperation species memory is also an essential aspect in terms of species behavior it is debatable whether a species uses its memory for the evaluation of cooperation in an ecosystem or not this article attempts to provide a new outlook on the relationship between the two phenomena memory and cooperation we have studied and analyzed time series abundance data for a large number of species available in the global population dynamic database gpdd database exhibiting evidence of cooperation our analysis indicates that among such cooperative species the insect community especially the moth species has a stronger memory than other taxonomy groups we finally provide the idea of the interplay between memory and cooperation regarding the system s stability these findings can open up new avenues in understanding species behavior in the ecological niche keywords fractional modeling cooperation bifurcation analysis parameter estimation memory effect data availability the authors do not have permission to share data 1 introduction cooperation has played a significant role in the sociological development of species throughout the history of the evolutionary process social groups are more stable than individuals in apparently unfavorable conditions apart from the theory of survival of the fittest by darwin 1859 there is ample evidence supporting the notion that aggregation is almost universal among species in particular the aggregation is widespread in species with sexual reproduction due to the requirement to contact other individuals of the same kind milton 1982 gompper 1997 heinsohn 1992 single species individuals frequently experience a higher mortality rate in unfavorable circumstances in contrast with cooperative individuals the prey population in groups can defend themselves better against predator attacks aggregation among predators increases the success rate of capturing their prey the well known allee principle highlights the fact that overcrowding as well as under crowding phenomena within species are limiting as a result for the continued existence of the population and its optimal growth a suitable degree of species aggregation is essential and it controls the effects of competition and cooperation in a stable manner odum and barrett 2006 another concept proposed by hamilton 1964 is kin selection according to this process an organism helps its relatives during their reproduction without paying attention to its survival and reproduction krakauer 2005 explained kin selection as the evolution of cooperation in the animal kingdom it is unclear whether an animal exhibits memory induced cooperative behavior or not animals moderate their future movement using the information of past interaction is also yet to be fully understood cheney 2011 several studies and surveys on both primate s and nonprimates cooperation issues indicate that memory acts as a critical factor in this frame however there is a paucity of experimental evidence and few studies involving mathematical modeling which is partially responsible for the lack of a comprehensive understanding of these phenomena thus the relationship between cooperation and memory is a propitious area of research till now as the cooperation mechanism can be interpreted as the gateway from weak to strong allee transition the effect of memory in cooperation requires careful analysis bhowmick et al 2015 several existing studies deal with the link between memory and species cooperation a number of them have suggested that more extended memory is more likely to lead to cooperation using the game theory qin et al 2008 observed that the memory effect has a positive impact on cooperators density they have provided extensive simulations which indicate the fact mentioned above for most of their parameters although the authors supported their claim through extensive simulation the prisoner s dilemma game is not supported by any real dataset in the study therefore the study provides only the idea of possible memory induced cooperation but cannot identify whether a population actually has a greater memory than other ones cox et al 1999 and milinski and wedekind 1998 investigated whether the memory gain through previous communications can balance because people have no information about others using the similar approach without support from the ecological dataset hilbe et al 2017 performed a similar study on memory effect in cooperation against n number of strategies for direct reciprocity only besides their study is based on human society cooperative animals do not necessarily resemble human society aktipis 2006 examined the impact of recognition memory on the evolution of cooperation the author worked under the assumption that agents have either previously cooperated or defected she showed that agents with a cooperator remembering strategy c mem could invade a population of defectors with smaller memory sizes than the agents with a defector remembering strategy d mem besides d mem agents can invade if the total number of defectors and the memory size are almost equal various studies in the literature have recommended that more effective memory is not always beneficial for cooperation janssen 2006 analyzed the impact of memory length on cooperation the study observed that smaller memory lengths led to lower cooperation levels moderate memory led to moderately mutual cooperation but high memory lengths caused moderate deterioration in cooperation horvath et al 2012 studied the role of active memory on the evolution of cooperation these authors showed that if the extent of memory is small cooperation does not survive and large memory also has an adverse effect on cooperation the cumulative evidence of these studies signifies that limited rather than extensive memory can be favorable for the evolution of cooperation several other studies also contribute partially to the debate as mentioned earlier brosnan et al 2010 demonstrate that stable cooperation between species often links to species cognitive abilities this work also shows that animals with associative learning may take more time to exhibit stable cooperation a possible reason may be that such species avoid investments without sensing its long term benefits byrne and whiten 1988 have established that cognitive skills greatly influence the development of enlarged neocortices in birds primates cetaceans and other highly cooperative vertebrates mitani et al 2010 noticed that boundary patrols of chimpanzees possess some variety of cooperation such as lethal intergroup aggression which ultimately expands their territory these behaviors illustrate that chimpanzees possess cooperation memory and planning among them krams et al 2008 suggested that a species cooperative reaction is dependent on the previous interaction with its neighbors this article shows the interplay between memory and cooperation analyzing time series abundance data for many species in the gpdd database that exhibit evidence of cooperation we will demonstrate that among such cooperative species the insect community most prominently the moth species has strong memory compared to other taxonomy groups we will also discuss the role of the interplay between memory and cooperation with the system s stability 2 the mathematical model in this article we will study the impact of memory on cooperation in a single species model bhowmick et al 2015 have introduced the concept of cooperation in the generalized θ logistic model they have scrutinized the work of sibly et al 2005 and identified twenty eight species from the global population dynamics database gpdd they integrated intraspecies cooperation as an allometric trait in logistic growth enhances the description of population growth they also provided numerical estimates of the cooperation parameter and performed stability analysis bifurcation analysis is also performed based on appropriate critical values beyond which the risk of extinction is high recently moreira et al 2013 studied the connection between the size of the cooperative primate population and the individual s memory they consider the effect of memory through a parameter and reveal that increasing memory enhances cooperation although the population may be expanding cooperativeness sustains however according to our knowledge no substantial work has been done in theoretical ecology using a fractional modeling system here we will focus on the role of cooperation and memory in species dynamics bhowmick et al 2015 introduced a generalized version of the famous ricker model where the population under consideration has non overlapping generations reproduction is seasonal and they modeled this through discrete time difference equations they incorporated the cooperation phenomenon through the cooperation parameter γ under a θ logistic set up through the relation 1 n t 1 n t exp r n t γ 1 n t k θ here r refers to the intrinsic growth rate k is the carrying capacity of the environment and θ regulates the power of the density near k the model 1 can be expressed as the form of difference equation as follows 2 δ n t n t exp r n t γ 1 n t k θ 1 following the method proposed by atici and sengul 2010 the generalization of the model 1 through a discrete time fractional difference equation model leads to the relation 3 δ α n t α 1 n t exp r n t γ 1 n t k θ 1 here α is known as the memory effect parameter and the discrete time model 1 can be recovered under α 1 the other parameters have the same interpretation as in the model 1 eq 3 represents the cooperation and the memory phenomena through the γ and α parameters respectively on a θ logistic growth model we have studied the existence uniqueness and stability analysis of the proposed model 1 see the supplementary material the cooperation parameter γ may help explain the stability of the population and the extinction risk of species and equip us with a good species conservation management tool in model 3 with fixed r θ k and α 1 i e no memory it is observed that for large γ the population loses its stability the system begins to oscillate beyond γ γ s 0 4619 and is described through a period doubling bifurcation cascade and there exists a threshold value γ c 0 5421 beyond which chaos is observed see supplementary material now in the presence of memory in the system i e α 0 1 in model 3 we observe that the nature of the stability of the population changes see fig 1 we detect chaotic oscillations through the lyapunov coefficient a more detailed bifurcation diagram and corresponding lyapunov coefficient for variable cooperation rates are in si 5 to get a clearer picture we have shown the long term relationship between memory and cooperation through a two parametric bifurcation diagram fig 2 depicts the corresponding threshold value of γ with respect to α after which the population is unstable for instance the threshold value γ s is approximately equal to 0 4103 in fig 1 a for α 0 005 and is approximately equal to 0 428 in fig 1 b for α 0 8 however in fig 2 a we observe that a high memory i e a very small value of α leads to an increase in cooperation with respect to population stability and in fig 2 b we observe that a relatively low memory i e a moderate value of α also leads to a increase in cooperation with respect to population stability therefore a high or low memory increases the cooperation and a moderate memory stabilize the cooperation the overall relationship between the cooperation and the memory looks like a quadratic curve see fig 2 c which is a very interesting finding since no standard method exists for the estimation of the model parameters of eq 3 we will estimate them through an analogous type of continuous model initially we will start from the model 1 and derive an equivalent continuous type of the model we perform the derivations in two steps first we calculate the log differences of the population size estimated at two time points t δ t and t in second step we evaluate the limit of the expression ln n t t ln n t δ t at δ t 0 we obtain the limiting model as 4 d n d t r n γ 1 1 n k θ note that the above continuous time cooperation model has been adequately well analyzed in the work of bhowmick et al 2015 however the above continuous time cooperation model of bhowmick et al 2015 in the fractional set up may be expressed as 5 d α n d t α r n γ 1 1 n k θ here r refers to the intrinsic growth rate k is the carrying capacity of the environment θ indicates the power of density regulation near k the fractional order derivative in the sense of caputo i e for α 1 model 5 leads to model 4 α 0 1 refers to the memory effect and the parameter γ is the coefficient of cooperation a high value of γ helps the population to devise some cooperative activities however the species may not sustain above a critical value of γ as a very high value of γ may lead the system to lose dynamical stability if γ 0 and α 1 there is no cooperation or memory and the population has only one stable state i e the carrying capacity 3 result for the twenty eight relevant species of the gpdd data we estimated the parameters of the fractional cooperation model 5 to identify the species where both cooperation and memory are present we employed the orthogonal distance fitting odf method golub and van loan 1980 huffel and vandewalle 1988 to estimate the parameters of our model here perpendicular distance between given points and the fitting curve is used mathematically the sum of orthogonal distance is described by i 1 n d x i f x i α 1 α 2 α n 2 here n is the number of given data points and the parameters α 1 α 2 α n influence the function f which can be called the fitting curve or the set of fitting points here d represents the distance between the experimental points with coordinates x i and the fitting curve f we have used fmincon optimization algorithms in matlab for the data fitting problem of our fractional differential equation model 5 as described by skovranek et al 2012 the estimated model parameters and error of fit using the fmincon procedure are given in table 2 here we have found that fifteen out of the twenty eight species exhibit both the cooperation and memory phenomena marked in bold or italics among these fifteen species only three species gpdd id 1149 6742 and 9279 marked in italics have the less accurate fitting in terms of error sum of squares although they possess memory see the supplementary material for detail in table 2 the row corresponding to a species name has gpdd id with a number it implies that the estimation is performed with model 5 if the gpdd id represents the term ode it implies that the estimation is performed with model 4 we present some selected fitted curves in fig 3 where the red points are the data points of the mentioned species and the red line represents the estimated curve we further estimated the standard error se and the distribution of the parameters based on the bootstrap re sampling technique as the length of the data set is small and there is no prior information available on the parameters for each of the species in table 3 we have provided the se corresponding to each parameter of the mentioned species after the seminal work of darwin 1859 a large number of researchers focused on species cooperation since then it has been an exciting topic of study for evolutionary biologists up to what extent an animal can employ human like complex mechanisms is a debatable issue in the literature researchers have a vital concern about animal cognition since they believe it can shed light on the origin of human intelligence also waal 1999 ecologists and biologists have also performed experiments on animals to get a broad idea of their cognitive system and infer if there is any synergy with complex human intelligence or not colombo and scarf 2020 premack 2007 waal 1999 most studies assume that animals from lower taxonomic rank possess simple minds which tend to emphasize the importance of associative learning and sometimes they use only associative learning to communicate with nature gigerenzer et al 1999 heyes 2012 however an ecological experimental or mathematical approach will be beneficial to investigate the mechanism followed by the animals to connect and survive in the environment mcauliffe and thornton 2012 biegler et al 2001 examined the behavior of predator birds based on their stored food retrieving habits the authors concluded that they possessed long term memory according to mcauliffe and thornton 2015 the ecologically motivated approach is inadequate to understand animal cooperation fully the psychological factor has to be incorporated to study this phenomenon mcauliffe and thornton 2015 showed that species memory and cooperation are strongly connected however no existing ecological modeling uses parameters to explain these phenomena together to the best of our knowledge it is the first mathematical model in this direction supported by a dataset on ecological populations at the same time we want to discuss a few technical points i the development of fractional differential equation fde modeling is still ongoing therefore enriched mathematical analysis of fde models is hardly possible ii an analogous and more recent development is fractional order difference equation fode modeling according to our knowledge there are no existing well established analytical methods for studying the stability of any nonlinear fode so we need to rely on the numerical simulation but the existing solution is based on gamma functions which restrict solving the model for a very large time scale 4 discussion in the present study we have identified fifteen 15 species from the bird rat butterfly moth and other insect groups which possess both memory and cooperation there is ample evidence in the literature about the presence of memory in these species some such important references are in table 1 for example dere et al 2005 empirically demonstrated the presence of episodic like memory in the mice population clayton et al 2003 experimented on memory in food caching birds they observed that the catching pattern of these birds might change according to their future needs which reflects that they possessed an excellent combination of memory and long term planning dugatkin 1997 has reported that mammals birds and insect populations cooperate with their con specific individuals he studied cooperative hunting food calls food sharing alarm calls and mobbing behavior among birds he also demonstrated foraging anti predator behavior social contracts among insects grooming behavior cooperative hunting intergroup conflicts and cooperation within nonhuman primates there is evidence of cooperation as well as memory in butterfly and moth species blackiston et al 2008 observed that moth larvae learned to avoid the training odor and that this version was still present in the adults they have reported that larvae trained at the third instar continued to show odor aversion similar to the fifth instar however they did not avoid the odor as adults indicating that post metamorphic recall involves regions of the brain that are produced in later stages of development takeuchi 2006 observed that the territorial residents of c smaragdinus had better recognition of their territories compared to intruders while they flew away from their territories in the evening they managed to return to the same places by the following day demonstrating that they have some cognitive recognition of their territory moths and butterflies are also cooperative populations wiklund et al 2001 goto et al 2002 in this study as already mentioned we have estimated various parameters of our proposed model using gpdd data and found that fifteen species of five groups possessed both memory and cooperation table 1 shows a complete list of the species with their memory impact the third column of the table depicts the memory impact of various species it shows that moths other insects and some birds have high memories although some bird rat and butterfly populations have moderate memories note that all these species choices see supplementary material for detail are based on experimental works where the authors have found cooperation and memory in various forms which we already discussed above we suggest that these fifteen species have memory maybe in various forms from low to high range in particular we observed that cooperative species considered in table 1 all the moth species have high memory however specific experiments on these species may be needed to explore this field of work further the novelty of the work is to propose a modeling framework that can quantify memory and cooperation in the presence of species data our findings also support the previous findings of memory on these species moreover we can get an idea of memory impact acting on that species the results have a different direction using our proposed new type of model we hope that further research in the field of ecological modeling will continue using this framework 5 conclusion in conclusion we have studied the memory phenomena with species cooperation in this article as two fold research work first we analyzed the relationship between cooperation and memory for the stability aspect of the system we observed that high and low memory of the species leads to an increase in cooperation according to blackiston et al 2008 the memory of moths acted on cooperation through reward and punishment of aggregation the high memory long term of reward at the larval stage will cause aggregation at the adult stage levin 2021 in low of memory short term the moths will aggregate by learning the response to the environmental cue for cooperation as an adult showing again a high cooperation grof et al 2017 therefore the association of cooperation may be possible for a high and low level of memory effect next we identified the species which possess both memory and cooperation from the gpdd bhowmick et al 2015 already published a list of twenty eight species where they have found the presence of cooperation in terms of the value of the estimated cooperation parameter we have used gpdd data in our proposed model and estimated the memory effect parameter we have provided a complete list of species that reflect both cooperation and memory in the form of a table we have demonstrated that the moth species stand out among these as all the species in this group exhibit cooperation and have high memory this study may enrich the influence of species cooperation and memory in the ecological system credit authorship contribution statement sourav rana conceptualization methodology software analysis visualization writing original draft ayanendranath basu methodology analysis writing original draft sinchan ghosh writing original draft sabyasachi bhattacharya conceptualization methodology data curation writing original draft declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests sinchan ghosh reports financial support was provided by council of scientific industrial research acknowledgments s ghosh received funds from council of scientific and industrial research grant no 09 093 0184 2019 emr i during this study period appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110235 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
24280,just as competition cooperation is also a fundamental aspect of species growth and survival strategies an optimal degree of aggregation is necessary for survival and optimum population growth perfectly balancing competition and cooperation like cooperation species memory is also an essential aspect in terms of species behavior it is debatable whether a species uses its memory for the evaluation of cooperation in an ecosystem or not this article attempts to provide a new outlook on the relationship between the two phenomena memory and cooperation we have studied and analyzed time series abundance data for a large number of species available in the global population dynamic database gpdd database exhibiting evidence of cooperation our analysis indicates that among such cooperative species the insect community especially the moth species has a stronger memory than other taxonomy groups we finally provide the idea of the interplay between memory and cooperation regarding the system s stability these findings can open up new avenues in understanding species behavior in the ecological niche keywords fractional modeling cooperation bifurcation analysis parameter estimation memory effect data availability the authors do not have permission to share data 1 introduction cooperation has played a significant role in the sociological development of species throughout the history of the evolutionary process social groups are more stable than individuals in apparently unfavorable conditions apart from the theory of survival of the fittest by darwin 1859 there is ample evidence supporting the notion that aggregation is almost universal among species in particular the aggregation is widespread in species with sexual reproduction due to the requirement to contact other individuals of the same kind milton 1982 gompper 1997 heinsohn 1992 single species individuals frequently experience a higher mortality rate in unfavorable circumstances in contrast with cooperative individuals the prey population in groups can defend themselves better against predator attacks aggregation among predators increases the success rate of capturing their prey the well known allee principle highlights the fact that overcrowding as well as under crowding phenomena within species are limiting as a result for the continued existence of the population and its optimal growth a suitable degree of species aggregation is essential and it controls the effects of competition and cooperation in a stable manner odum and barrett 2006 another concept proposed by hamilton 1964 is kin selection according to this process an organism helps its relatives during their reproduction without paying attention to its survival and reproduction krakauer 2005 explained kin selection as the evolution of cooperation in the animal kingdom it is unclear whether an animal exhibits memory induced cooperative behavior or not animals moderate their future movement using the information of past interaction is also yet to be fully understood cheney 2011 several studies and surveys on both primate s and nonprimates cooperation issues indicate that memory acts as a critical factor in this frame however there is a paucity of experimental evidence and few studies involving mathematical modeling which is partially responsible for the lack of a comprehensive understanding of these phenomena thus the relationship between cooperation and memory is a propitious area of research till now as the cooperation mechanism can be interpreted as the gateway from weak to strong allee transition the effect of memory in cooperation requires careful analysis bhowmick et al 2015 several existing studies deal with the link between memory and species cooperation a number of them have suggested that more extended memory is more likely to lead to cooperation using the game theory qin et al 2008 observed that the memory effect has a positive impact on cooperators density they have provided extensive simulations which indicate the fact mentioned above for most of their parameters although the authors supported their claim through extensive simulation the prisoner s dilemma game is not supported by any real dataset in the study therefore the study provides only the idea of possible memory induced cooperation but cannot identify whether a population actually has a greater memory than other ones cox et al 1999 and milinski and wedekind 1998 investigated whether the memory gain through previous communications can balance because people have no information about others using the similar approach without support from the ecological dataset hilbe et al 2017 performed a similar study on memory effect in cooperation against n number of strategies for direct reciprocity only besides their study is based on human society cooperative animals do not necessarily resemble human society aktipis 2006 examined the impact of recognition memory on the evolution of cooperation the author worked under the assumption that agents have either previously cooperated or defected she showed that agents with a cooperator remembering strategy c mem could invade a population of defectors with smaller memory sizes than the agents with a defector remembering strategy d mem besides d mem agents can invade if the total number of defectors and the memory size are almost equal various studies in the literature have recommended that more effective memory is not always beneficial for cooperation janssen 2006 analyzed the impact of memory length on cooperation the study observed that smaller memory lengths led to lower cooperation levels moderate memory led to moderately mutual cooperation but high memory lengths caused moderate deterioration in cooperation horvath et al 2012 studied the role of active memory on the evolution of cooperation these authors showed that if the extent of memory is small cooperation does not survive and large memory also has an adverse effect on cooperation the cumulative evidence of these studies signifies that limited rather than extensive memory can be favorable for the evolution of cooperation several other studies also contribute partially to the debate as mentioned earlier brosnan et al 2010 demonstrate that stable cooperation between species often links to species cognitive abilities this work also shows that animals with associative learning may take more time to exhibit stable cooperation a possible reason may be that such species avoid investments without sensing its long term benefits byrne and whiten 1988 have established that cognitive skills greatly influence the development of enlarged neocortices in birds primates cetaceans and other highly cooperative vertebrates mitani et al 2010 noticed that boundary patrols of chimpanzees possess some variety of cooperation such as lethal intergroup aggression which ultimately expands their territory these behaviors illustrate that chimpanzees possess cooperation memory and planning among them krams et al 2008 suggested that a species cooperative reaction is dependent on the previous interaction with its neighbors this article shows the interplay between memory and cooperation analyzing time series abundance data for many species in the gpdd database that exhibit evidence of cooperation we will demonstrate that among such cooperative species the insect community most prominently the moth species has strong memory compared to other taxonomy groups we will also discuss the role of the interplay between memory and cooperation with the system s stability 2 the mathematical model in this article we will study the impact of memory on cooperation in a single species model bhowmick et al 2015 have introduced the concept of cooperation in the generalized θ logistic model they have scrutinized the work of sibly et al 2005 and identified twenty eight species from the global population dynamics database gpdd they integrated intraspecies cooperation as an allometric trait in logistic growth enhances the description of population growth they also provided numerical estimates of the cooperation parameter and performed stability analysis bifurcation analysis is also performed based on appropriate critical values beyond which the risk of extinction is high recently moreira et al 2013 studied the connection between the size of the cooperative primate population and the individual s memory they consider the effect of memory through a parameter and reveal that increasing memory enhances cooperation although the population may be expanding cooperativeness sustains however according to our knowledge no substantial work has been done in theoretical ecology using a fractional modeling system here we will focus on the role of cooperation and memory in species dynamics bhowmick et al 2015 introduced a generalized version of the famous ricker model where the population under consideration has non overlapping generations reproduction is seasonal and they modeled this through discrete time difference equations they incorporated the cooperation phenomenon through the cooperation parameter γ under a θ logistic set up through the relation 1 n t 1 n t exp r n t γ 1 n t k θ here r refers to the intrinsic growth rate k is the carrying capacity of the environment and θ regulates the power of the density near k the model 1 can be expressed as the form of difference equation as follows 2 δ n t n t exp r n t γ 1 n t k θ 1 following the method proposed by atici and sengul 2010 the generalization of the model 1 through a discrete time fractional difference equation model leads to the relation 3 δ α n t α 1 n t exp r n t γ 1 n t k θ 1 here α is known as the memory effect parameter and the discrete time model 1 can be recovered under α 1 the other parameters have the same interpretation as in the model 1 eq 3 represents the cooperation and the memory phenomena through the γ and α parameters respectively on a θ logistic growth model we have studied the existence uniqueness and stability analysis of the proposed model 1 see the supplementary material the cooperation parameter γ may help explain the stability of the population and the extinction risk of species and equip us with a good species conservation management tool in model 3 with fixed r θ k and α 1 i e no memory it is observed that for large γ the population loses its stability the system begins to oscillate beyond γ γ s 0 4619 and is described through a period doubling bifurcation cascade and there exists a threshold value γ c 0 5421 beyond which chaos is observed see supplementary material now in the presence of memory in the system i e α 0 1 in model 3 we observe that the nature of the stability of the population changes see fig 1 we detect chaotic oscillations through the lyapunov coefficient a more detailed bifurcation diagram and corresponding lyapunov coefficient for variable cooperation rates are in si 5 to get a clearer picture we have shown the long term relationship between memory and cooperation through a two parametric bifurcation diagram fig 2 depicts the corresponding threshold value of γ with respect to α after which the population is unstable for instance the threshold value γ s is approximately equal to 0 4103 in fig 1 a for α 0 005 and is approximately equal to 0 428 in fig 1 b for α 0 8 however in fig 2 a we observe that a high memory i e a very small value of α leads to an increase in cooperation with respect to population stability and in fig 2 b we observe that a relatively low memory i e a moderate value of α also leads to a increase in cooperation with respect to population stability therefore a high or low memory increases the cooperation and a moderate memory stabilize the cooperation the overall relationship between the cooperation and the memory looks like a quadratic curve see fig 2 c which is a very interesting finding since no standard method exists for the estimation of the model parameters of eq 3 we will estimate them through an analogous type of continuous model initially we will start from the model 1 and derive an equivalent continuous type of the model we perform the derivations in two steps first we calculate the log differences of the population size estimated at two time points t δ t and t in second step we evaluate the limit of the expression ln n t t ln n t δ t at δ t 0 we obtain the limiting model as 4 d n d t r n γ 1 1 n k θ note that the above continuous time cooperation model has been adequately well analyzed in the work of bhowmick et al 2015 however the above continuous time cooperation model of bhowmick et al 2015 in the fractional set up may be expressed as 5 d α n d t α r n γ 1 1 n k θ here r refers to the intrinsic growth rate k is the carrying capacity of the environment θ indicates the power of density regulation near k the fractional order derivative in the sense of caputo i e for α 1 model 5 leads to model 4 α 0 1 refers to the memory effect and the parameter γ is the coefficient of cooperation a high value of γ helps the population to devise some cooperative activities however the species may not sustain above a critical value of γ as a very high value of γ may lead the system to lose dynamical stability if γ 0 and α 1 there is no cooperation or memory and the population has only one stable state i e the carrying capacity 3 result for the twenty eight relevant species of the gpdd data we estimated the parameters of the fractional cooperation model 5 to identify the species where both cooperation and memory are present we employed the orthogonal distance fitting odf method golub and van loan 1980 huffel and vandewalle 1988 to estimate the parameters of our model here perpendicular distance between given points and the fitting curve is used mathematically the sum of orthogonal distance is described by i 1 n d x i f x i α 1 α 2 α n 2 here n is the number of given data points and the parameters α 1 α 2 α n influence the function f which can be called the fitting curve or the set of fitting points here d represents the distance between the experimental points with coordinates x i and the fitting curve f we have used fmincon optimization algorithms in matlab for the data fitting problem of our fractional differential equation model 5 as described by skovranek et al 2012 the estimated model parameters and error of fit using the fmincon procedure are given in table 2 here we have found that fifteen out of the twenty eight species exhibit both the cooperation and memory phenomena marked in bold or italics among these fifteen species only three species gpdd id 1149 6742 and 9279 marked in italics have the less accurate fitting in terms of error sum of squares although they possess memory see the supplementary material for detail in table 2 the row corresponding to a species name has gpdd id with a number it implies that the estimation is performed with model 5 if the gpdd id represents the term ode it implies that the estimation is performed with model 4 we present some selected fitted curves in fig 3 where the red points are the data points of the mentioned species and the red line represents the estimated curve we further estimated the standard error se and the distribution of the parameters based on the bootstrap re sampling technique as the length of the data set is small and there is no prior information available on the parameters for each of the species in table 3 we have provided the se corresponding to each parameter of the mentioned species after the seminal work of darwin 1859 a large number of researchers focused on species cooperation since then it has been an exciting topic of study for evolutionary biologists up to what extent an animal can employ human like complex mechanisms is a debatable issue in the literature researchers have a vital concern about animal cognition since they believe it can shed light on the origin of human intelligence also waal 1999 ecologists and biologists have also performed experiments on animals to get a broad idea of their cognitive system and infer if there is any synergy with complex human intelligence or not colombo and scarf 2020 premack 2007 waal 1999 most studies assume that animals from lower taxonomic rank possess simple minds which tend to emphasize the importance of associative learning and sometimes they use only associative learning to communicate with nature gigerenzer et al 1999 heyes 2012 however an ecological experimental or mathematical approach will be beneficial to investigate the mechanism followed by the animals to connect and survive in the environment mcauliffe and thornton 2012 biegler et al 2001 examined the behavior of predator birds based on their stored food retrieving habits the authors concluded that they possessed long term memory according to mcauliffe and thornton 2015 the ecologically motivated approach is inadequate to understand animal cooperation fully the psychological factor has to be incorporated to study this phenomenon mcauliffe and thornton 2015 showed that species memory and cooperation are strongly connected however no existing ecological modeling uses parameters to explain these phenomena together to the best of our knowledge it is the first mathematical model in this direction supported by a dataset on ecological populations at the same time we want to discuss a few technical points i the development of fractional differential equation fde modeling is still ongoing therefore enriched mathematical analysis of fde models is hardly possible ii an analogous and more recent development is fractional order difference equation fode modeling according to our knowledge there are no existing well established analytical methods for studying the stability of any nonlinear fode so we need to rely on the numerical simulation but the existing solution is based on gamma functions which restrict solving the model for a very large time scale 4 discussion in the present study we have identified fifteen 15 species from the bird rat butterfly moth and other insect groups which possess both memory and cooperation there is ample evidence in the literature about the presence of memory in these species some such important references are in table 1 for example dere et al 2005 empirically demonstrated the presence of episodic like memory in the mice population clayton et al 2003 experimented on memory in food caching birds they observed that the catching pattern of these birds might change according to their future needs which reflects that they possessed an excellent combination of memory and long term planning dugatkin 1997 has reported that mammals birds and insect populations cooperate with their con specific individuals he studied cooperative hunting food calls food sharing alarm calls and mobbing behavior among birds he also demonstrated foraging anti predator behavior social contracts among insects grooming behavior cooperative hunting intergroup conflicts and cooperation within nonhuman primates there is evidence of cooperation as well as memory in butterfly and moth species blackiston et al 2008 observed that moth larvae learned to avoid the training odor and that this version was still present in the adults they have reported that larvae trained at the third instar continued to show odor aversion similar to the fifth instar however they did not avoid the odor as adults indicating that post metamorphic recall involves regions of the brain that are produced in later stages of development takeuchi 2006 observed that the territorial residents of c smaragdinus had better recognition of their territories compared to intruders while they flew away from their territories in the evening they managed to return to the same places by the following day demonstrating that they have some cognitive recognition of their territory moths and butterflies are also cooperative populations wiklund et al 2001 goto et al 2002 in this study as already mentioned we have estimated various parameters of our proposed model using gpdd data and found that fifteen species of five groups possessed both memory and cooperation table 1 shows a complete list of the species with their memory impact the third column of the table depicts the memory impact of various species it shows that moths other insects and some birds have high memories although some bird rat and butterfly populations have moderate memories note that all these species choices see supplementary material for detail are based on experimental works where the authors have found cooperation and memory in various forms which we already discussed above we suggest that these fifteen species have memory maybe in various forms from low to high range in particular we observed that cooperative species considered in table 1 all the moth species have high memory however specific experiments on these species may be needed to explore this field of work further the novelty of the work is to propose a modeling framework that can quantify memory and cooperation in the presence of species data our findings also support the previous findings of memory on these species moreover we can get an idea of memory impact acting on that species the results have a different direction using our proposed new type of model we hope that further research in the field of ecological modeling will continue using this framework 5 conclusion in conclusion we have studied the memory phenomena with species cooperation in this article as two fold research work first we analyzed the relationship between cooperation and memory for the stability aspect of the system we observed that high and low memory of the species leads to an increase in cooperation according to blackiston et al 2008 the memory of moths acted on cooperation through reward and punishment of aggregation the high memory long term of reward at the larval stage will cause aggregation at the adult stage levin 2021 in low of memory short term the moths will aggregate by learning the response to the environmental cue for cooperation as an adult showing again a high cooperation grof et al 2017 therefore the association of cooperation may be possible for a high and low level of memory effect next we identified the species which possess both memory and cooperation from the gpdd bhowmick et al 2015 already published a list of twenty eight species where they have found the presence of cooperation in terms of the value of the estimated cooperation parameter we have used gpdd data in our proposed model and estimated the memory effect parameter we have provided a complete list of species that reflect both cooperation and memory in the form of a table we have demonstrated that the moth species stand out among these as all the species in this group exhibit cooperation and have high memory this study may enrich the influence of species cooperation and memory in the ecological system credit authorship contribution statement sourav rana conceptualization methodology software analysis visualization writing original draft ayanendranath basu methodology analysis writing original draft sinchan ghosh writing original draft sabyasachi bhattacharya conceptualization methodology data curation writing original draft declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests sinchan ghosh reports financial support was provided by council of scientific industrial research acknowledgments s ghosh received funds from council of scientific and industrial research grant no 09 093 0184 2019 emr i during this study period appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110235 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
24281,the r language provides most applications packages currently available for ecological niche modelling in the last few years these packages have increased substantially there are now numerous packages for computing ecological niche models enms with different algorithms comparing species niches and niche models creating virtual species getting and preparing species and related environmental data filtering species records and evaluating models amongst other tasks this profusion of package options may be daunting for both beginners and more experienced r users here we provide an organised and annotated list of available packages for each task we present a concise history of the creation of these packages we briefly describe what each package does and we discuss whether the current set of r packages covers all the necessities for modelling species ecological niches this list will be accessible and updated over time on a dedicated website keywords species distribution models r language r packages biodiversity modelling biogeography spatial analyses abbreviations enm ecological niche model gui graphical user interface enfa ecological niche factor analysis sdm species distribution model gis geographical information system foss free open source software cran comprehensive r archive network data availability no data was used for the research described in the article 1 introduction ecological niche models enms which are closely related to species distribution models sdm are empirical or mathematical estimations of a species ecological niche sillero et al 2021 enms are statistical methods or theoretically derived response surfaces that relate physiological or distribution data to environmental variables to describe and or predict species distributions franklin 2010 peterson et al 2011 sillero 2011 guisan et al 2017 sillero et al 2021 enms can be calculated with statistical software e g spss statistica geographical information systems e g arcgis qgis diva gis or with dedicated graphical user interface gui software e g openmodeller modeco maxent biomapper wallace shinybiomod traditional statistical software with a gui can run an enm for example glm or gam if the species and environmental data are compiled as a table some modelling algorithms purely designed for enms such as maximum entropy phillips et al 2006 2017 or ecological niche factor analysis enfa hirzel et al 2002 are not available in traditional statistical programs but in dedicated ones some dedicated programs offer modelling solutions with all stages of the modelling process modeco guo and liu 2010 and openmodeller enrique et al 2009 are stand alone programs available for some operating systems such as microsoft windows modeco integrates several modelling tools within a gis framework algorithms support vector machines bioclim domain generalised linear model maximum likelihood classification artificial neural network rough set maximum entropy classification trees ensemble model data management and visualisation feature analysis model training and prediction and accuracy assessment openmodeller includes tools for sampling points modelling evaluating and projecting models into different environmental scenarios several algorithms are available as plugins bioclim domain mahalanobis distance garp maxent enfa and support vector machines maxent is the java software that runs the maximum entropy algorithm phillips et al 2017 biomapper is the software that runs enfa hirzel et al 2002 wallace kass et al 2018 is a modular shiny platform that guides the user through a complete modelling process making parameter choices explicit from data acquisition to plotting model predictions on an interactive map shinybiomod ondo et al 2019 is another user friendly shiny application that uses the r modelling package biomod2 thuiller et al 2009 2012 some applications are built as plugins for other programs for example sdmtoolbox is a python based toolbox for arcgis that includes functions for modelling pre and post processing tasks brown 2014 brown et al 2017 http www sdmtoolbox org or maxent model a qgis plugin to preprocess input data in maxent https geoinnova org plugin maxent maxent wallace sdmtoolbox and shinybiomod are updated regularly enms can be also calculated with programming languages such as python and r python is a high level interpreted general purpose programming language van rossum and drake 1995 it supports multiple programming paradigms including structured object orientated and functional programming r is a programming language for statistical computing with graphical capacities r core team 2022 r is widely used amongst data scientists and statisticians to analyse data and develop statistical software kabacoff 2015 both python and r are free and open source software foss allowing users to create packages that augment or complement existing functions r is one of the most used foss thanks to its ease of use versatility and object orientated framework indeed users have created thousands of packages on 28 10 2022 cran the main repository of r packages hosted 18 761 packages https cran r project org web packages a number that continues to increase over the years the field of biodiversity modelling is not an exception many packages can be directly or indirectly used for modelling species ecological niches and all related pre and post processing tasks here we provide an organised list of r packages for ecological niche models we divided the list according to the four main stages of the modelling process sillero et al 2021 1 data collection and preparation 2 model calculation 3 model evaluation and validation and 4 model application we start our review with a brief description of the development of r packages for enms over time followed by the organised list finally we discuss the current state of the universe of r packages for enms 2 methods we searched google scholar and web of science for r packages for enms using the words ecological niche model package species distribution package and species distribution model package therefore we searched for packages whose main aim was to provide functions for one or more of the four steps of the modelling process we verified that all packages found in these searches were directly related to enms we checked whether each package was available through cran and if the package had a development site on github or another similar platform we considered as release year the first year of the package publication in cran or github if the package is not on cran after obtaining a list of r packages for enms we searched in google scholar for the number of citations for each package or paper presenting that package 3 results our search allowed us to compile a total of 60 r packages for enms table 1 published since 2007 fig 1 we found 39 packages available through cran and 21 currently in development for different purposes see table 1 these packages were cited 9664 times with eighteen cited more than 100 times each and two enmeval and biomod2 more than 1000 times see table 2 3 1 a brief history of the development of r packages for ecological niche models to the best of our knowledge the first r package with functions for enms was presenceabsence freeman and moisen 2008 released in 2007 it does not compute models but provides functions for evaluating presence absence analysis either enms or diagnostic tests the package calculates the optimal threshold for translating a probability surface into presence absence maps such as percentage correctly classified sensitivity specificity and kappa it also computes the receiver operator characteristic roc curve and the area under the curve auc however the first r package developed specifically for the field of enms was biomod released in 2009 thuiller et al 2003 2009 a second version biomod2 replaced it in 2012 thuiller et al 2021 both versions provided several ensemble forecasting methods for enm algorithms generalised linear models generalised additive models multivariate adaptive regression splines mars classification tree analysis mixture discriminant analysis artificial neural networks generalised boosted models random forests and maximum entropy through java a method used posteriorly by other r packages biomod2 also included a rectilinear envelope algorithm similar to bioclim booth et al 2014 the dismo package released in 2010 hijmans et al 2021 provides tools for the complete modelling process from downloading and preparing data to evaluating the models this package implements presence only modelling algorithms bioclim domain mahalanobis distance and a presence absence algorithm boosted regression trees it can also run maxent by calling java maxlike royle et al 2012 a package released in 2011 implements a maximum likelihood algorithm as an alternative method to the maximum entropy maxent algorithm the maxlike algorithm endeavoured to estimate the probability of occurrence from presence only data royle et al 2012 instead of habitat suitability but see osorio olvera et al 2019 in 2012 besides biomod2 thuiller et al 2021 several packages were released for obtaining species records rgbif chamberlain et al 2022 calculating distribution and abundandm latimer et al 2006 analysing model uncertainties usdm naimi et al 2014 and modelling species dispersal migclim engler et al 2012 usdm includes methods from spatial statistics to analyse positional uncertainty naimi et al 2014 it also implemented the variance inflation factor vif to analyse collinearity between variables naimi et al 2014 several packages released in 2014 implemented important often novel additional tasks these included spatially filtering species records spthin aiello lammens et al 2015 generating virtual species sdmvspecies duan et al 2015 virtualspecies leroy et al 2016 modelling species range dynamics rangeshiftr bocedi et al 2014 g 2021 and automatically fine tuning and validating models to determine optimal levels of complexity enmeval muscarella et al 2014 a new version of enmeval was released in 2021 kass et al 2021 it provides functions for results visualisation data partition with spatial criteria model evaluation with cross validation and null models and niche overlap from model predictions the package was originally built for maxent models but the current version allows possible extensions for any modelling algorithm two other packages released in the same year provided tools for estimating species ecological niches using kernel interpolators instead of regression based and machine learning algorithms ecospat di cola et al 2017 and hypervolume blonder et al 2014 ecospat also provides other model related functions such as statistical comparison of species niches using the methods proposed by warren et al 2008 2010 computing ensembles of small models breiner et al 2018 analysing non analogue climates elith et al 2010 2011 mesgaran et al 2014 and evaluating model performance zoon and sdmtools were released in 2015 zoon golding et al 2018 provides functions for comparing and diagnosing models the results can be shared from an online repository sdmtools vanderwal et al 2015 has tools for post processing models including threshold selection calculating validation and landscape metrics and tracking distribution changes over time ten packages were published in 2016 sdm naimi and araújo 2016 was the third package together with dismo hijmans et al 2021 and biomod2 thuiller et al 2012 thuiller et al 2021 providing a full set of tools for the four stages of modelling data preparation model calculation with several algorithms gam glm mars svm rf and maximum entropy model evaluation and model projection sdmplay charlene et al 2021 also offers functions for the four modelling stages but only for maximum entropy and boosted regression trees another package maxnet provided a direct r implementation of the maximum entropy algorithm without the need for calling java to run the maxent software outside r this package written by the main author of maxent uses the package glmnet to fit an inhomogeneous poisson process model which is equivalent to the maximum entropy algorithm phillips et al 2017 the package rmaxent baumgartner and wilson 2022 which is also java free includes additional functionalities for projecting maxent models calculating information criteria aic aicc bic as implemented in warren et al 2010 parsing maxent lambdas files and estimating mess multivariate environmental similarity surface elith et al 2010 2011 the package miamaxent vollering et al 2019 provides pre processing e g variable selection and evaluation functions for maxent and logistic regression models enirg cánovas et al 2016 is an interface for r and grass gis and implements enfa modeva barbosa et al 2016 provides a varied set of tools for evaluating enms including discrimination and calibration metrics optimising classification thresholds and analysing model extrapolation with mess on data frames elith et al 2010 2011 sdmpredictors bosch and fernandez 2022 downloads environmental data from different climatic datasets including terrestrial marine and freshwater environments currently worldclim fick and hijmans 2017 envirem title and bemmels 2018 bio oracle tyberghein et al 2012 marspec sbrocco and barber 2013 and freshwater domisch et al 2015 biogeo robertson et al 2016 was the first package developed for automatically detecting and correcting errors in species occurrence datasets it includes functions for assessing data quality of occurrence records identifying potentially erroneous records in geographical and environmental space and providing possible alternative positions for those records another package focused on the analysis of species occurrences is red cardoso 2017 which calculates the extent of occurrence area of occupancy and red list index for groups of species red also downloads and pre processes species occurrences e g thinning and moving occurrences to the closest non na pixel maps species ranges and calculates maxent models with dismo hijmans et al 2021 package until 2016 r packages related to enms focused mainly on correlative algorithms although dismo provides some simple functions for mechanistic models in contrast nichemapr was designed specifically for mechanistic niche models including datasets of micro climate kearney and porter 2017 2020 in addition spedinstabr guisande et al 2017 selects environmental variables based on a fluctuation index which identifies the environmental factors that better discriminate between the conditions in the species area and those in the background area six packages were released on cran in 2018 providing some more interesting functionalities for instance cenfa rinnan and lawler 2019 presented a new implementation of enfa it includes algorithms for climate and ecological niche factor analyses and for visualisation of spatial variability of species sensitivity exposure and vulnerability to climate change three other packages provided different tools for supporting the modelling process here rangemodelmetadata merow et al 2019 catalogues enms with hierarchical structures through dictionaries in this way communicating and sharing the algorithms and parameters used to compute the models is easier and more accurate mopa iturbide et al 2018 provides functions for transferable models pseudo absence data generation and factor contribution quantification fuzzysim barbosa 2015 includes functions to compute fuzzy versions of species occurrence patterns based on presence absence data inverse distance interpolation trend surface analysis and prevalence independent favorability and pairwise fuzzy similarity amongst species potential distributions fuzzysim currently has additional functions for data preparation model consensus and comparison such as unique abbreviations of species names gridding thinning point occurrence data onto raster maps converting species lists to presence absence tables transposing part of a data frame selecting relevant variables for models assessing the false discovery rate or analysing and dealing with multicollinearity finally metrics hammer and frasco 2018 provides several metrics for evaluating models calculated with machine learning algorithms while bdclean gueta et al 2018 like biogeo guisande et al 2017 provides functions for cleaning and validating species occurrence data kuenm cobos et al 2019b was released in 2019 it is a package for calibrating maxent models by selecting optimal parameterisations for each study therefore the user can run multiple maxent models with different conditions and choose the best one esdm woodman et al 2019 also released in 2019 is a package for ensemble modelling of species distribution and abundance models esdm includes a graphical user interface gui built with an r shiny app the minbar package rotllan puig and traveset 2021 estimates the minimum background area by calculating several maxent models with different parameters until determining the best one sdmtune vignali et al 2020 and sdmbench angelov 2018 provide functions for calculating selecting and validating models with several algorithms of machine learning sdmselect includes functions for the selection of covariates and model specifications ellipsenm cobos et al 2019b and humboldt brown and carnaval 2019 provide advanced functions for running analyses in the environmental space ellipsenm cobos et al 2019a calculates ellipsoid envelopes calibrates and selects models replicates models and projections and assesses niche overlaps and humboldt brown and carnaval 2019 analyses the amount of the species observed environmental space that is truncated by the available environmental space providing also tools for analysing niche overlap and divergence and rarefying species occurrence records to reduce survey bias coordinatecleaner zizka et al 2019 cleans occurrence datasets similar to biogeo guisande et al 2017 and bdclean gueta et al 2018 it detects geo referencing and dating imprecisions in a standardised and reproducible way based on geographical gazetteers and a global database of georeferenced biodiversity institutions to identify records from e g horticulture or captivity in 2020 the r version of enmtools warren et al 2010 was finally released warren et al 2021 the enmtools r package not only provides tools and statistical tests for comparing species niches but also offers a full set of tools for the four modelling stages enmtools includes algorithms for presence background maxent poisson point process and presence absence gam glm models and unique evaluation tools such as monte carlo tests and null models enmtools is the only package to our knowledge where null models are calculated at the same time as the empirical models as a parameter of the algorithm function one important difference with other full set packages such as biomod2 thuiller et al 2021 or sdm naimi and araújo 2016 is that enmtools has independent functions for each algorithm similarly to dismo hijmans et al 2021 instead of one main model computing function where all algorithms are included as parameters enmtools was not the only full set package released in 2020 enmtml de andrade et al 2020 provides a single function with all arguments necessary to calculate enms including variable collinearity control bias control accessible area delimitation pseudo absence allocation data partition 13 modelling algorithms bioclim mahalanobis distance domain enfa glm gam brt random forests svm maximum entropy with quadratic and linear and default features maximum likelihood and gaussian process classification thresholds model evaluation metrics over prediction analysis ensemble modelling and projections over time and space in this way enmtml aims to simplify the entire modelling process by reducing it to a single command five more packages were released in 2020 blockcv valavi et al 2019 provides functions for generating spatially or environmentally separated folds for k fold cross validation of models blockcv can be used to separate training and test data for other modelling packages similarly enmsdm morelli et al 2020 is a complement to dismo hijmans et al 2021 with advanced functions for preparing data training and evaluating dismo models and comparing ecological niches embarcadero carlson 2020 calculates enms with bayesian additive regression trees bart including basic model summary statistics and diagnostics variable importance measures and plotting modler sánchez tapia et al 2020 provides a modelling workflow based on dismo ssdm schimtt et al 2017 calculates potential species richness from a set of stacked individual models four additional packages were released in 2021 geodata hijmans et al 2022 downloads geographic and environmental data directly into r including species occurrences and variables like climate from worldclim elevation land use soil accessibility and administrative boundaries the other three packages occassess sampbias and bracatus provide functions for detecting errors in species occurrence datasets specifically bracatus arlé et al 2021 presents a method to estimate the probability of a georeferenced record being true or false and corresponding to a native or an alien occurrence it avoids subjective thresholds of data filtering by implementing a probabilistic framework to propagate uncertainties in posterior analyses on the other hand occassess boyd et al 2021 and sampbias zizka et al 2020 detect geographical biases in species occurrence data finally five more packages were released in 2022 flexsdm velazco et al 2022 is another package providing functions for the four modelling stages it includes algorithms for presence background maxent and presence absence gam glm gbm svm rf ann modelling together with functions for survey bias correction sampling pseudo absences and background points data partitioning and reducing collinearity in predictors fitting and evaluating models ensembles of small models and ensemble models and prediction interpolation and overprediction correction itsdm song 2022 provides functions for modelling presence only records with isolation forest iforest and variations extended iforest and sciforest mcera5 klinges et al 2022 is the second r package designed for mechanistic models it includes functions for getting microclimate data from era5 climate data specieschrom kléparski and beaugrand 2022 quantifies niche optimum breadth and overlap and identifies the most discriminant combination of environmental variables bdc ribeiro et al 2022 includes functions for merging biodiversity datasets flagging and removing erroneous occurrence data cleaning parsing and harmonizing scientific names and flagging and correcting inconsistent collection dates 3 2 an organised list of packages we present the list of packages in table 2 organised by the four main modelling steps data collection and preparation model calculation model evaluation and validation and model application this list will be curated and frequently updated at https sites google com view sblab r packages for enms many packages can tackle more than one aim but they are placed in our table in only one of the modelling steps according to its main purpose we considered the following main purposes in each modelling step 1 data collection and preparation compilation of biodiversity and geographical data species filtering preprocessing data for models creating virtual species 2 model calculation mechanistic models correlative models ensemble modelling bayesian models functions complementary to other packages maxent specific enfa specific niche estimation 3 model evaluation and validation 4 model application comparison of models dispersion utilities we indicate in the table the main purpose of each package followed by a small description main contributor s main reference cran link and development website if available 4 discussion the number of packages for enms has increased over time since 2010 at least one package has been released on cran every year except in 2013 the number of packages will likely continue to increase therefore do we have all the packages we need considering our organised list some functions for enms may be redundant a varied set of enms can be computed and validated currently through several packages dismo biomod2 sdm enmeval enmtools enmtml flexsdm sdmtune and sdmbench provide multiple algorithms for presence absence presence background or presence only data ssdm schmitt et al 2017 also provides all the necessary functions for computing and validating enms but it is designed specifically to calculate potential species richness from stacked individual enms several packages for cleaning and filtering occurrence data are also available spthin bdclean coordinatecleaner bdc bracatus biogeo occassess and sampbias are specialised in correcting geographical biases in species occurrences some algorithms are available through specialised and generalistic packages for example the maxent algorithm phillips et al 2006 2017 can be computed with maxnet kuenm dismo biomod2 sdm enmeval enmtools flexsdm sdmplay enmtml ssdm minbar red and sdmtune however many of these packages use a function included in another package e g dismo on the other hand are there some missing functionalities not included in r packages for enms the user has currently at least 60 available packages providing multiple functions for all modelling steps however not all modelling steps are represented equally fewer packages are available for evaluating models in general we probably need more functions for validating models especially for computing null models raes and ter steege 2007 beale et al 2008 bohl et al 2019 only enmtools warren et al 2021 has implemented the calculation of null models as a parameter of the functions for computing enm algorithms enmeval muscarella et al 2014 kass et al 2021 also provides functions for computing null models it is desirable that validating enms with null models becomes a more extended and standard practice sillero et al 2021 there is also room for improvement in properly evaluating models on true presence only data without requiring unoccupied background localities if we consider the necessity to gather geographical environmental and biodiversity data directly from within r we will need several packages to run all modelling procedures however once the data are compiled there are several packages offering all necessary functions to compute validate and apply the models namely dismo biomod2 sdm enmeval enmtools enmtml flexsdm and sdmtune however not all these packages provide the same functionalities for example dismo hijmans et al 2021 does not have ensemble modelling functions while enmtools warren et al 2021 does not provide tools to replicate the models on the other hand enmtools warren et al 2021 validates the models both in the environmental and geographical space and it includes the computing of null models as part of the general calculation of the model recent packages have also reduced the number of steps for calculating the models in comparison to biomod2 thuiller et al 2021 which requires formatting the data through several functions before computing the models other packages have reduced the necessary steps to a minimum sdm naimi and araújo 2016 only needs one function for this pre modelling step and enmtml de andrade et al 2020 integrates all modelling steps in one single function the most cited packages are biomod2 thuiller et al 2021 and enmeval muscarella et al 2014 kass et al 2021 this is likely a representation of the users needs most users require a package for both computing and validating models some packages such as dismo hijmans et al 2021 have fewer citations probably because they do not have a paper associated users frequently forget to cite r packages or they do not know how to cite them as their citations cannot be seamlessly uploaded to a reference manager program the communication between packages should also be improved r is a free open source software enhanced by a wide community of developers and users and therefore it includes a huge diversity of approaches lovelace et al 2020 for example several packages provide tools for reading importing and exporting data either in tabular matrix data frame data table tibble or in spatial vector or raster formats sp sf raster terra stars amongst others different packages often require different classes of input objects and also produce output objects of these classes this reduces the flexibility for sharing objects between functions from different packages this is important for example if we want to apply spatial statistics baddeley et al 2015 to the results of widely used packages such as dismo hijmans et al 2021 and biomod2 w thuiller et al 2021 these two packages currently require input objects implemented by packages raster hijmans 2022a and sp pebesma and bivand 2005 which use the rgdal bivand et al 2022 and rgeos bivand and rundel 2021 packages for importing and handling spatial data however spatstat baddeley and turner 2005 the most complete package for spatial statistics currently depends on sp pebesma and bivand 2005 and sf pebesma 2018 therefore interconnection and communication amongst packages should be improved most enm packages currently use sp pebesma and bivand 2005 and raster hijmans 2022a package formats as spatial data inputs however support for some dependencies or suggestions of these packages such as rgdal rgeos and maptools will end in 2023 currently very few enm packages fuzzysim modeva blockcv dismo in part and biomod2 in the development version on github have migrated their code to newer spatial packages like terra for both raster and vector data hijmans 2022b or sf for vector data pebesma 2018 which substitute the raster and sp packages and are actively maintained besides being considerably faster future updates of r can introduce problems between versions of the packages as older spatial packages are retired therefore code migration to modern spatial packages e g terra or stars for raster data terra or sf for vector data should be a current priority for enm package developers other packages provide functions e g model computation or validation for methods rarely used in enms also other packages use enms to perform phylogeographic e g phyr li et al 2020 phylin tarroso et al 2015 and biogeographical analyses e g rangemap cobos et al 2022 some packages are in development and not currently on cran e g sdmtools vanderwal et al 2015 migclim engler et al 2012 embarcadero carlson 2020 more and more packages even widely used ones are now maintained on github instead of cran as it is often difficult to meet cran requirements we included some packages if they were published in a scientific journal even if they were not on cran they need to be installed following instructions on their development website 5 conclusions what may be the future of r packages for enms this question is not easy to answer as indicated above packages should implement better evaluation metrics and validating procedures such as null models and improve their communication and integration with the migration to modern spatial packages like terra at least for raster spatial data we hope that computing speed and stability will increase also packages should facilitate the computation of replicated models for large numbers of species without the necessity of using for loop functions and provide a more optimised syntax concerning the r language funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest joao carlos campos reports financial support was provided by fct fundação para a ciência e a tecnologia salvador arenas castro reports financial support was provided by spanish ministry of universities salvador arenas castro reports financial support was provided by eu nextgenerationeu acknowledgements ns is supported by a ceec2017 contract ceecind 02213 2017 from fundação para a ciência e a tecnologia fct sac is supported by the maría zambrano fellowship program funded by the spanish ministry of universities and the eu nextgenerationeu fund jcc is supported by a contract from montobeo project mts brb 0091 2020 funded by fct 
24281,the r language provides most applications packages currently available for ecological niche modelling in the last few years these packages have increased substantially there are now numerous packages for computing ecological niche models enms with different algorithms comparing species niches and niche models creating virtual species getting and preparing species and related environmental data filtering species records and evaluating models amongst other tasks this profusion of package options may be daunting for both beginners and more experienced r users here we provide an organised and annotated list of available packages for each task we present a concise history of the creation of these packages we briefly describe what each package does and we discuss whether the current set of r packages covers all the necessities for modelling species ecological niches this list will be accessible and updated over time on a dedicated website keywords species distribution models r language r packages biodiversity modelling biogeography spatial analyses abbreviations enm ecological niche model gui graphical user interface enfa ecological niche factor analysis sdm species distribution model gis geographical information system foss free open source software cran comprehensive r archive network data availability no data was used for the research described in the article 1 introduction ecological niche models enms which are closely related to species distribution models sdm are empirical or mathematical estimations of a species ecological niche sillero et al 2021 enms are statistical methods or theoretically derived response surfaces that relate physiological or distribution data to environmental variables to describe and or predict species distributions franklin 2010 peterson et al 2011 sillero 2011 guisan et al 2017 sillero et al 2021 enms can be calculated with statistical software e g spss statistica geographical information systems e g arcgis qgis diva gis or with dedicated graphical user interface gui software e g openmodeller modeco maxent biomapper wallace shinybiomod traditional statistical software with a gui can run an enm for example glm or gam if the species and environmental data are compiled as a table some modelling algorithms purely designed for enms such as maximum entropy phillips et al 2006 2017 or ecological niche factor analysis enfa hirzel et al 2002 are not available in traditional statistical programs but in dedicated ones some dedicated programs offer modelling solutions with all stages of the modelling process modeco guo and liu 2010 and openmodeller enrique et al 2009 are stand alone programs available for some operating systems such as microsoft windows modeco integrates several modelling tools within a gis framework algorithms support vector machines bioclim domain generalised linear model maximum likelihood classification artificial neural network rough set maximum entropy classification trees ensemble model data management and visualisation feature analysis model training and prediction and accuracy assessment openmodeller includes tools for sampling points modelling evaluating and projecting models into different environmental scenarios several algorithms are available as plugins bioclim domain mahalanobis distance garp maxent enfa and support vector machines maxent is the java software that runs the maximum entropy algorithm phillips et al 2017 biomapper is the software that runs enfa hirzel et al 2002 wallace kass et al 2018 is a modular shiny platform that guides the user through a complete modelling process making parameter choices explicit from data acquisition to plotting model predictions on an interactive map shinybiomod ondo et al 2019 is another user friendly shiny application that uses the r modelling package biomod2 thuiller et al 2009 2012 some applications are built as plugins for other programs for example sdmtoolbox is a python based toolbox for arcgis that includes functions for modelling pre and post processing tasks brown 2014 brown et al 2017 http www sdmtoolbox org or maxent model a qgis plugin to preprocess input data in maxent https geoinnova org plugin maxent maxent wallace sdmtoolbox and shinybiomod are updated regularly enms can be also calculated with programming languages such as python and r python is a high level interpreted general purpose programming language van rossum and drake 1995 it supports multiple programming paradigms including structured object orientated and functional programming r is a programming language for statistical computing with graphical capacities r core team 2022 r is widely used amongst data scientists and statisticians to analyse data and develop statistical software kabacoff 2015 both python and r are free and open source software foss allowing users to create packages that augment or complement existing functions r is one of the most used foss thanks to its ease of use versatility and object orientated framework indeed users have created thousands of packages on 28 10 2022 cran the main repository of r packages hosted 18 761 packages https cran r project org web packages a number that continues to increase over the years the field of biodiversity modelling is not an exception many packages can be directly or indirectly used for modelling species ecological niches and all related pre and post processing tasks here we provide an organised list of r packages for ecological niche models we divided the list according to the four main stages of the modelling process sillero et al 2021 1 data collection and preparation 2 model calculation 3 model evaluation and validation and 4 model application we start our review with a brief description of the development of r packages for enms over time followed by the organised list finally we discuss the current state of the universe of r packages for enms 2 methods we searched google scholar and web of science for r packages for enms using the words ecological niche model package species distribution package and species distribution model package therefore we searched for packages whose main aim was to provide functions for one or more of the four steps of the modelling process we verified that all packages found in these searches were directly related to enms we checked whether each package was available through cran and if the package had a development site on github or another similar platform we considered as release year the first year of the package publication in cran or github if the package is not on cran after obtaining a list of r packages for enms we searched in google scholar for the number of citations for each package or paper presenting that package 3 results our search allowed us to compile a total of 60 r packages for enms table 1 published since 2007 fig 1 we found 39 packages available through cran and 21 currently in development for different purposes see table 1 these packages were cited 9664 times with eighteen cited more than 100 times each and two enmeval and biomod2 more than 1000 times see table 2 3 1 a brief history of the development of r packages for ecological niche models to the best of our knowledge the first r package with functions for enms was presenceabsence freeman and moisen 2008 released in 2007 it does not compute models but provides functions for evaluating presence absence analysis either enms or diagnostic tests the package calculates the optimal threshold for translating a probability surface into presence absence maps such as percentage correctly classified sensitivity specificity and kappa it also computes the receiver operator characteristic roc curve and the area under the curve auc however the first r package developed specifically for the field of enms was biomod released in 2009 thuiller et al 2003 2009 a second version biomod2 replaced it in 2012 thuiller et al 2021 both versions provided several ensemble forecasting methods for enm algorithms generalised linear models generalised additive models multivariate adaptive regression splines mars classification tree analysis mixture discriminant analysis artificial neural networks generalised boosted models random forests and maximum entropy through java a method used posteriorly by other r packages biomod2 also included a rectilinear envelope algorithm similar to bioclim booth et al 2014 the dismo package released in 2010 hijmans et al 2021 provides tools for the complete modelling process from downloading and preparing data to evaluating the models this package implements presence only modelling algorithms bioclim domain mahalanobis distance and a presence absence algorithm boosted regression trees it can also run maxent by calling java maxlike royle et al 2012 a package released in 2011 implements a maximum likelihood algorithm as an alternative method to the maximum entropy maxent algorithm the maxlike algorithm endeavoured to estimate the probability of occurrence from presence only data royle et al 2012 instead of habitat suitability but see osorio olvera et al 2019 in 2012 besides biomod2 thuiller et al 2021 several packages were released for obtaining species records rgbif chamberlain et al 2022 calculating distribution and abundandm latimer et al 2006 analysing model uncertainties usdm naimi et al 2014 and modelling species dispersal migclim engler et al 2012 usdm includes methods from spatial statistics to analyse positional uncertainty naimi et al 2014 it also implemented the variance inflation factor vif to analyse collinearity between variables naimi et al 2014 several packages released in 2014 implemented important often novel additional tasks these included spatially filtering species records spthin aiello lammens et al 2015 generating virtual species sdmvspecies duan et al 2015 virtualspecies leroy et al 2016 modelling species range dynamics rangeshiftr bocedi et al 2014 g 2021 and automatically fine tuning and validating models to determine optimal levels of complexity enmeval muscarella et al 2014 a new version of enmeval was released in 2021 kass et al 2021 it provides functions for results visualisation data partition with spatial criteria model evaluation with cross validation and null models and niche overlap from model predictions the package was originally built for maxent models but the current version allows possible extensions for any modelling algorithm two other packages released in the same year provided tools for estimating species ecological niches using kernel interpolators instead of regression based and machine learning algorithms ecospat di cola et al 2017 and hypervolume blonder et al 2014 ecospat also provides other model related functions such as statistical comparison of species niches using the methods proposed by warren et al 2008 2010 computing ensembles of small models breiner et al 2018 analysing non analogue climates elith et al 2010 2011 mesgaran et al 2014 and evaluating model performance zoon and sdmtools were released in 2015 zoon golding et al 2018 provides functions for comparing and diagnosing models the results can be shared from an online repository sdmtools vanderwal et al 2015 has tools for post processing models including threshold selection calculating validation and landscape metrics and tracking distribution changes over time ten packages were published in 2016 sdm naimi and araújo 2016 was the third package together with dismo hijmans et al 2021 and biomod2 thuiller et al 2012 thuiller et al 2021 providing a full set of tools for the four stages of modelling data preparation model calculation with several algorithms gam glm mars svm rf and maximum entropy model evaluation and model projection sdmplay charlene et al 2021 also offers functions for the four modelling stages but only for maximum entropy and boosted regression trees another package maxnet provided a direct r implementation of the maximum entropy algorithm without the need for calling java to run the maxent software outside r this package written by the main author of maxent uses the package glmnet to fit an inhomogeneous poisson process model which is equivalent to the maximum entropy algorithm phillips et al 2017 the package rmaxent baumgartner and wilson 2022 which is also java free includes additional functionalities for projecting maxent models calculating information criteria aic aicc bic as implemented in warren et al 2010 parsing maxent lambdas files and estimating mess multivariate environmental similarity surface elith et al 2010 2011 the package miamaxent vollering et al 2019 provides pre processing e g variable selection and evaluation functions for maxent and logistic regression models enirg cánovas et al 2016 is an interface for r and grass gis and implements enfa modeva barbosa et al 2016 provides a varied set of tools for evaluating enms including discrimination and calibration metrics optimising classification thresholds and analysing model extrapolation with mess on data frames elith et al 2010 2011 sdmpredictors bosch and fernandez 2022 downloads environmental data from different climatic datasets including terrestrial marine and freshwater environments currently worldclim fick and hijmans 2017 envirem title and bemmels 2018 bio oracle tyberghein et al 2012 marspec sbrocco and barber 2013 and freshwater domisch et al 2015 biogeo robertson et al 2016 was the first package developed for automatically detecting and correcting errors in species occurrence datasets it includes functions for assessing data quality of occurrence records identifying potentially erroneous records in geographical and environmental space and providing possible alternative positions for those records another package focused on the analysis of species occurrences is red cardoso 2017 which calculates the extent of occurrence area of occupancy and red list index for groups of species red also downloads and pre processes species occurrences e g thinning and moving occurrences to the closest non na pixel maps species ranges and calculates maxent models with dismo hijmans et al 2021 package until 2016 r packages related to enms focused mainly on correlative algorithms although dismo provides some simple functions for mechanistic models in contrast nichemapr was designed specifically for mechanistic niche models including datasets of micro climate kearney and porter 2017 2020 in addition spedinstabr guisande et al 2017 selects environmental variables based on a fluctuation index which identifies the environmental factors that better discriminate between the conditions in the species area and those in the background area six packages were released on cran in 2018 providing some more interesting functionalities for instance cenfa rinnan and lawler 2019 presented a new implementation of enfa it includes algorithms for climate and ecological niche factor analyses and for visualisation of spatial variability of species sensitivity exposure and vulnerability to climate change three other packages provided different tools for supporting the modelling process here rangemodelmetadata merow et al 2019 catalogues enms with hierarchical structures through dictionaries in this way communicating and sharing the algorithms and parameters used to compute the models is easier and more accurate mopa iturbide et al 2018 provides functions for transferable models pseudo absence data generation and factor contribution quantification fuzzysim barbosa 2015 includes functions to compute fuzzy versions of species occurrence patterns based on presence absence data inverse distance interpolation trend surface analysis and prevalence independent favorability and pairwise fuzzy similarity amongst species potential distributions fuzzysim currently has additional functions for data preparation model consensus and comparison such as unique abbreviations of species names gridding thinning point occurrence data onto raster maps converting species lists to presence absence tables transposing part of a data frame selecting relevant variables for models assessing the false discovery rate or analysing and dealing with multicollinearity finally metrics hammer and frasco 2018 provides several metrics for evaluating models calculated with machine learning algorithms while bdclean gueta et al 2018 like biogeo guisande et al 2017 provides functions for cleaning and validating species occurrence data kuenm cobos et al 2019b was released in 2019 it is a package for calibrating maxent models by selecting optimal parameterisations for each study therefore the user can run multiple maxent models with different conditions and choose the best one esdm woodman et al 2019 also released in 2019 is a package for ensemble modelling of species distribution and abundance models esdm includes a graphical user interface gui built with an r shiny app the minbar package rotllan puig and traveset 2021 estimates the minimum background area by calculating several maxent models with different parameters until determining the best one sdmtune vignali et al 2020 and sdmbench angelov 2018 provide functions for calculating selecting and validating models with several algorithms of machine learning sdmselect includes functions for the selection of covariates and model specifications ellipsenm cobos et al 2019b and humboldt brown and carnaval 2019 provide advanced functions for running analyses in the environmental space ellipsenm cobos et al 2019a calculates ellipsoid envelopes calibrates and selects models replicates models and projections and assesses niche overlaps and humboldt brown and carnaval 2019 analyses the amount of the species observed environmental space that is truncated by the available environmental space providing also tools for analysing niche overlap and divergence and rarefying species occurrence records to reduce survey bias coordinatecleaner zizka et al 2019 cleans occurrence datasets similar to biogeo guisande et al 2017 and bdclean gueta et al 2018 it detects geo referencing and dating imprecisions in a standardised and reproducible way based on geographical gazetteers and a global database of georeferenced biodiversity institutions to identify records from e g horticulture or captivity in 2020 the r version of enmtools warren et al 2010 was finally released warren et al 2021 the enmtools r package not only provides tools and statistical tests for comparing species niches but also offers a full set of tools for the four modelling stages enmtools includes algorithms for presence background maxent poisson point process and presence absence gam glm models and unique evaluation tools such as monte carlo tests and null models enmtools is the only package to our knowledge where null models are calculated at the same time as the empirical models as a parameter of the algorithm function one important difference with other full set packages such as biomod2 thuiller et al 2021 or sdm naimi and araújo 2016 is that enmtools has independent functions for each algorithm similarly to dismo hijmans et al 2021 instead of one main model computing function where all algorithms are included as parameters enmtools was not the only full set package released in 2020 enmtml de andrade et al 2020 provides a single function with all arguments necessary to calculate enms including variable collinearity control bias control accessible area delimitation pseudo absence allocation data partition 13 modelling algorithms bioclim mahalanobis distance domain enfa glm gam brt random forests svm maximum entropy with quadratic and linear and default features maximum likelihood and gaussian process classification thresholds model evaluation metrics over prediction analysis ensemble modelling and projections over time and space in this way enmtml aims to simplify the entire modelling process by reducing it to a single command five more packages were released in 2020 blockcv valavi et al 2019 provides functions for generating spatially or environmentally separated folds for k fold cross validation of models blockcv can be used to separate training and test data for other modelling packages similarly enmsdm morelli et al 2020 is a complement to dismo hijmans et al 2021 with advanced functions for preparing data training and evaluating dismo models and comparing ecological niches embarcadero carlson 2020 calculates enms with bayesian additive regression trees bart including basic model summary statistics and diagnostics variable importance measures and plotting modler sánchez tapia et al 2020 provides a modelling workflow based on dismo ssdm schimtt et al 2017 calculates potential species richness from a set of stacked individual models four additional packages were released in 2021 geodata hijmans et al 2022 downloads geographic and environmental data directly into r including species occurrences and variables like climate from worldclim elevation land use soil accessibility and administrative boundaries the other three packages occassess sampbias and bracatus provide functions for detecting errors in species occurrence datasets specifically bracatus arlé et al 2021 presents a method to estimate the probability of a georeferenced record being true or false and corresponding to a native or an alien occurrence it avoids subjective thresholds of data filtering by implementing a probabilistic framework to propagate uncertainties in posterior analyses on the other hand occassess boyd et al 2021 and sampbias zizka et al 2020 detect geographical biases in species occurrence data finally five more packages were released in 2022 flexsdm velazco et al 2022 is another package providing functions for the four modelling stages it includes algorithms for presence background maxent and presence absence gam glm gbm svm rf ann modelling together with functions for survey bias correction sampling pseudo absences and background points data partitioning and reducing collinearity in predictors fitting and evaluating models ensembles of small models and ensemble models and prediction interpolation and overprediction correction itsdm song 2022 provides functions for modelling presence only records with isolation forest iforest and variations extended iforest and sciforest mcera5 klinges et al 2022 is the second r package designed for mechanistic models it includes functions for getting microclimate data from era5 climate data specieschrom kléparski and beaugrand 2022 quantifies niche optimum breadth and overlap and identifies the most discriminant combination of environmental variables bdc ribeiro et al 2022 includes functions for merging biodiversity datasets flagging and removing erroneous occurrence data cleaning parsing and harmonizing scientific names and flagging and correcting inconsistent collection dates 3 2 an organised list of packages we present the list of packages in table 2 organised by the four main modelling steps data collection and preparation model calculation model evaluation and validation and model application this list will be curated and frequently updated at https sites google com view sblab r packages for enms many packages can tackle more than one aim but they are placed in our table in only one of the modelling steps according to its main purpose we considered the following main purposes in each modelling step 1 data collection and preparation compilation of biodiversity and geographical data species filtering preprocessing data for models creating virtual species 2 model calculation mechanistic models correlative models ensemble modelling bayesian models functions complementary to other packages maxent specific enfa specific niche estimation 3 model evaluation and validation 4 model application comparison of models dispersion utilities we indicate in the table the main purpose of each package followed by a small description main contributor s main reference cran link and development website if available 4 discussion the number of packages for enms has increased over time since 2010 at least one package has been released on cran every year except in 2013 the number of packages will likely continue to increase therefore do we have all the packages we need considering our organised list some functions for enms may be redundant a varied set of enms can be computed and validated currently through several packages dismo biomod2 sdm enmeval enmtools enmtml flexsdm sdmtune and sdmbench provide multiple algorithms for presence absence presence background or presence only data ssdm schmitt et al 2017 also provides all the necessary functions for computing and validating enms but it is designed specifically to calculate potential species richness from stacked individual enms several packages for cleaning and filtering occurrence data are also available spthin bdclean coordinatecleaner bdc bracatus biogeo occassess and sampbias are specialised in correcting geographical biases in species occurrences some algorithms are available through specialised and generalistic packages for example the maxent algorithm phillips et al 2006 2017 can be computed with maxnet kuenm dismo biomod2 sdm enmeval enmtools flexsdm sdmplay enmtml ssdm minbar red and sdmtune however many of these packages use a function included in another package e g dismo on the other hand are there some missing functionalities not included in r packages for enms the user has currently at least 60 available packages providing multiple functions for all modelling steps however not all modelling steps are represented equally fewer packages are available for evaluating models in general we probably need more functions for validating models especially for computing null models raes and ter steege 2007 beale et al 2008 bohl et al 2019 only enmtools warren et al 2021 has implemented the calculation of null models as a parameter of the functions for computing enm algorithms enmeval muscarella et al 2014 kass et al 2021 also provides functions for computing null models it is desirable that validating enms with null models becomes a more extended and standard practice sillero et al 2021 there is also room for improvement in properly evaluating models on true presence only data without requiring unoccupied background localities if we consider the necessity to gather geographical environmental and biodiversity data directly from within r we will need several packages to run all modelling procedures however once the data are compiled there are several packages offering all necessary functions to compute validate and apply the models namely dismo biomod2 sdm enmeval enmtools enmtml flexsdm and sdmtune however not all these packages provide the same functionalities for example dismo hijmans et al 2021 does not have ensemble modelling functions while enmtools warren et al 2021 does not provide tools to replicate the models on the other hand enmtools warren et al 2021 validates the models both in the environmental and geographical space and it includes the computing of null models as part of the general calculation of the model recent packages have also reduced the number of steps for calculating the models in comparison to biomod2 thuiller et al 2021 which requires formatting the data through several functions before computing the models other packages have reduced the necessary steps to a minimum sdm naimi and araújo 2016 only needs one function for this pre modelling step and enmtml de andrade et al 2020 integrates all modelling steps in one single function the most cited packages are biomod2 thuiller et al 2021 and enmeval muscarella et al 2014 kass et al 2021 this is likely a representation of the users needs most users require a package for both computing and validating models some packages such as dismo hijmans et al 2021 have fewer citations probably because they do not have a paper associated users frequently forget to cite r packages or they do not know how to cite them as their citations cannot be seamlessly uploaded to a reference manager program the communication between packages should also be improved r is a free open source software enhanced by a wide community of developers and users and therefore it includes a huge diversity of approaches lovelace et al 2020 for example several packages provide tools for reading importing and exporting data either in tabular matrix data frame data table tibble or in spatial vector or raster formats sp sf raster terra stars amongst others different packages often require different classes of input objects and also produce output objects of these classes this reduces the flexibility for sharing objects between functions from different packages this is important for example if we want to apply spatial statistics baddeley et al 2015 to the results of widely used packages such as dismo hijmans et al 2021 and biomod2 w thuiller et al 2021 these two packages currently require input objects implemented by packages raster hijmans 2022a and sp pebesma and bivand 2005 which use the rgdal bivand et al 2022 and rgeos bivand and rundel 2021 packages for importing and handling spatial data however spatstat baddeley and turner 2005 the most complete package for spatial statistics currently depends on sp pebesma and bivand 2005 and sf pebesma 2018 therefore interconnection and communication amongst packages should be improved most enm packages currently use sp pebesma and bivand 2005 and raster hijmans 2022a package formats as spatial data inputs however support for some dependencies or suggestions of these packages such as rgdal rgeos and maptools will end in 2023 currently very few enm packages fuzzysim modeva blockcv dismo in part and biomod2 in the development version on github have migrated their code to newer spatial packages like terra for both raster and vector data hijmans 2022b or sf for vector data pebesma 2018 which substitute the raster and sp packages and are actively maintained besides being considerably faster future updates of r can introduce problems between versions of the packages as older spatial packages are retired therefore code migration to modern spatial packages e g terra or stars for raster data terra or sf for vector data should be a current priority for enm package developers other packages provide functions e g model computation or validation for methods rarely used in enms also other packages use enms to perform phylogeographic e g phyr li et al 2020 phylin tarroso et al 2015 and biogeographical analyses e g rangemap cobos et al 2022 some packages are in development and not currently on cran e g sdmtools vanderwal et al 2015 migclim engler et al 2012 embarcadero carlson 2020 more and more packages even widely used ones are now maintained on github instead of cran as it is often difficult to meet cran requirements we included some packages if they were published in a scientific journal even if they were not on cran they need to be installed following instructions on their development website 5 conclusions what may be the future of r packages for enms this question is not easy to answer as indicated above packages should implement better evaluation metrics and validating procedures such as null models and improve their communication and integration with the migration to modern spatial packages like terra at least for raster spatial data we hope that computing speed and stability will increase also packages should facilitate the computation of replicated models for large numbers of species without the necessity of using for loop functions and provide a more optimised syntax concerning the r language funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest joao carlos campos reports financial support was provided by fct fundação para a ciência e a tecnologia salvador arenas castro reports financial support was provided by spanish ministry of universities salvador arenas castro reports financial support was provided by eu nextgenerationeu acknowledgements ns is supported by a ceec2017 contract ceecind 02213 2017 from fundação para a ciência e a tecnologia fct sac is supported by the maría zambrano fellowship program funded by the spanish ministry of universities and the eu nextgenerationeu fund jcc is supported by a contract from montobeo project mts brb 0091 2020 funded by fct 
24282,a simplified representation or interpretation of reality using conceptual and mathematical models plays a role in understanding important phenomena especially biological ones based on medawar s mutation accumulation theory which predicts that the strength of natural selection decreases with age favouring the accumulation of deleterious genes to be expressed at advanced ages an individual based model ibm published in 1995 was designed to demonstrate the biological ageing mechanism with each individual being represented by a bitstring in a chronological manner this model is called penna model penna 1995 in honour of the creator the physicist thadeu josino pereira penna for this first time this article carries out a systematic review of the use of penna model to assess its applicability in other phenomena and biological mechanisms our results indicate that the model was extensively explored and improved by researchers from different parts of the world through small changes in the structure and base parameters of the model aimed at the biological phenomena of interest including ecology evolutionary ecology and genetics issues these changes have allowed the use of the model in other biological phenomena besides aging with studies in systems of predation competition fragmentation natural selection speciation genetics immunology epidemiology and others the model is highlighted as a fairly flexible tool for applied biological dynamics of simple use with the possibility of implementing different scales temporal or spatial and different languages computational logical or numerical in addition to the possibility of inserting parameters that modify the individual and or population that allow consistent results for decision making keywords biological dynamics bitstring mutation accumulation penna model data availability data will be made available on request 1 introduction in ecology the use of models creates a new perspective of understanding and explaining highly complex biological processes by making use of generalisations or simplifications where only phenomena considered essentially important are considered models are abstractions of reality with capacity to describe essential elements of a problem of interest wang and grant 2019 models in ecology can also be classified into different types depending on the intended approach to the problem raised jørgensen and swannack 2019 classify ecological models primarily into 11 types considering them tools for analysing ecological phenomena and their causalities jørgensen 2008 in the last two decades the number of ecological studies involving modelling has considerably increased from 300 articles per year between 1975 and 1982 to 4 000 per year in the period between 2000 and 2006 with publications starting in the 2000s utilizing mostly spatial models and models based on individuals jørgensen 2008 individual based models ibms or agent based models abms are a method that describe a given population through the discrete modelling of its very single organisms grimm and railsback 2005 in this approach each organism is called agent each agent is defined with a set of states or attribute variables and behaviours that vary between individuals and may change over time the performance observed at the population level emerges from a button up dynamic resulting from the simultaneous interactions between each individual and with the environment deangelis and grimm 2014 ibms allow studying the implications of physiological processes behavioral traits and environmental interactions synchronously an advance in ecological modeling as it allows joining structural functional quantitative and qualitative aspects in a way that suits observation data and conceptual knowledge representation reuter et al 2011 the integration of theoretical concepts with field data makes it possible to present estimates that are increasingly realistic and functional peck and hufnagl 2012 a simple and versatile model classified in the light of ecological divisions as an ibm was developed in 1995 by thadeu josino pereira penna a physicist interested in demonstrating some characteristics of the biological aging processes that occur in natural populations penna 1995 used one of the several evolutionary theories that underlie the complex and intriguing phenomenon of senescence to develop his model the so called medawar theory of accumulation of mutations this theory considers that the strength of natural selection decreases with age favouring the accumulation of deleterious genes to be expressed at advanced ages medawar 1952 early manifestation phenotypes before or during the reproductive period could be eliminated by natural selection otherwise this gene will be passed on to the offspring remaining and accumulating late in the following generations which in turn would lead to the evolution of aging medawar 1952 rose 1991 the first version of the model named penna model in honour of the creator simulated the biological aging mechanism for a hypothetical species elaborated in a computational environment and with an asexual reproductive regime penna and stauffer 1995 penna 1995 in this model each individual of this hypothetical species is represented by a bit string that contains its chronological and hereditary life history called by convention a chronological genome fig 1 the bit string has a fixed and predetermined length that indicates to a greater or lesser degree the life expectancy of the object of interest each bit string position represents the age of the individual which can be years months days among others each position is filled with 0 or 1 where 1 indicates the manifestation of a mutation or hereditary disease in a certain period of its biological cycle the maximum number of mutations bits 1 that an individual can have throughout its life or the sum of all previously defined mutations called threshold t will determine how many years that individual can survive the control of population explosion and death by non deterministic events such as resource restriction or ecological interactions such as competition and predation is represented by the verhulst factor v 1 n t k where k represents the environment carrying capacity and n t represents the population size at the present time at each round of the simulation a random number is generated for each of the individuals in the population which is compared to the value of v if the number is greater than or equal to v the individual will die even if it has not reached the sum of all its mutations in addition to the parameters intrinsic to the bit string the model incorporates some basic parameters in population studies such as reproductive age r and offspring size b and an evolutionary genetic parameter the mutation rate m which represents a fixed number of mutations that are introduced randomly in the new individuals generated adopted as m 1 for the elementary model thus the newly generated individual will inherit the sequence of bits from its parent with the accumulated mutations and the possibility of obtaining an additional deleterious mutation in any of its positions bernardes 1996 and stauffer et al 1996 were the first to adapt the penna model for sexual reproduction in the sexual model each individual is represented by a pair of bit strings containing information inherited from the father and mother fig 2 for a disease to manifest in this double stranded genome the individual must be homozygous at that position that is have 1 and 1 on both strands in positions where this individual is heterozygous that is with 1 and 0 for each strand he will manifest the disease according to a dominance factor d this dominance factor indicates the number of positions randomly chosen at the beginning of the simulation for all individuals in which when only one character 1 appears the disease will manifest itself offspring is generated by the crossing over mechanism from the bit strings of its parents the t m and b parameters and the v factor remain the default for the two model arrangements the versatility and simplicity of the penna model with chronologically structured individuals combined with the dynamism of a model that can be simulated in time and space allowed the projection of several ecological evolutionary and not to say genetic theoretical phenomena since its publication thus presenting a compendium of the evolution of the model and its main applications as well as presenting its perspectives for biological approaches especially ecological dynamics was the main objective of this elaborate synthesis in this work we carried out a systematic review of the literature on the penna model and its different biological approaches the methods applied in the systematic review and the aspects of interest are described the results obtained are presented from the analysis of the literature highlighting the main advances made in the base model and an analysis of the applicability of the works with emphasis on studies in ecology the study concludes with a discussion on the versatility and possibilities of using the model in evolutionary ecology applied ecology 2 literature search and analysis 2 1 bibliographic search the bibliographic search on the penna model considered all scientific studies published from 1995 the year of the publication of the base model penna and stauffer 1995 penna 1995 until april 2021 the searches were carried out in two official databases web of science www isiknowledge com and scopus www scopus com the terms penna model or aging model or bit string model were used as keyword combinations since the penna model is a methodological procedure with the possibility of mentioning the use of the model only in the methodological session the search for the cited terms considered the entirety of the works not being restricted as commonly practiced to the title abstract or keywords cited by returned studies that fit the assumptions presented were added to the dataset and used as additional bibliographic sources only studies that mentioned the keyword penna model ageing model or bit string model in their methodological approach were included therefore excluding the articles that cite the model but do not actually apply it exception was considered for revisions on the model thus only studies that reported applications methodological advances of the model or inductive mathematical approaches were retained for analysis fig 3 2 2 data analysis the information contained in the articles was entered into a spreadsheet containing information on the temporal progress of the model such as when the work was carried out authorship document type journal article book book section conference proceedings and serial research areas suggested by the web of science platform which categorises different subjects into five major areas arts humanities life sciences biomedicine physical sciences social sciences and technology and thematic axis simulation or biological theoretical the latter being divided into biological sub areas and other biological themes table 1 for each of the biological sub areas the thematic specificities addressed in each study were listed such as population dynamics and all its derivations predation competition carrying capacity survival rate biological aging genetic variability among others the classification of the article in biological sub areas considered the dominant theme however when an article systematically involved either in the structure of the model or in the theoretical inferences more than one area these areas were counted twice desai s work desai et al 1999 for example was classified as biological theory with ecological implications in view of the measurement of fertility rate in population dynamics and genetic implications since fertility was considered from the perspective of genetic mutations the information transcribed from the consulted works was summarised in graphs and tables allowing a descriptive visualization of the data 3 summary of information the bibliographic search returned 287 scientific works of which only those that met two criteria were selected 1 explicit use of the penna model and its derivations in the methodological structure of the predicted analysis and 2 conceptual studies such as reviews of the total studies 59 were discarded because they did not use the penna model in their methodological structure or because they only cited the model in its thematic context thus a total of 228 studies met the eligibility and inclusion criteria in the systematic review which were then carefully evaluated and separated into simulation themed studies n 63 and biological theories n 165 among which 155 studies were classified in one of the biological sub areas and 10 studies classified as other themes fig 4 the biological theoretical axis biological subareas indicated 58 publications directed to the study of phenomena classified as exclusively ecological 58 exclusively evolutionary studies and 15 exclusively genetic studies fig 5 a total of 25 studies were considered interdisciplinary as they explicitly addressed more than one of the classified sub areas the articles found in the literature for each of the biological subareas addressed different ecological evolutionary and genetic themes and concepts with many studies having integrated approaches between the different areas of interest the ecology sub area presented studies predominantly focused on population dynamics evaluating population parameters and concepts on ecological relationships for populations of the same species and or among different species the central approach in evolution was biological aging with studies in interaction with some ecological parameters in the sub areas genetics speciation and mutation were the most common ones fig 6 despite the high number of studies classified as biological theorists only few were published in journals and books in the biological areas n 30 with most studies directed to the exact sciences fig 7 regarding the chronological use of the model it was widely explored in the first decade after its publication accounting for 69 of all studies found 158 with 104 theoretical biological studies 99 biological sub areas and 05 other themes and 54 studies involving simulation fig 8 4 the manifold penna models the penna model was extensively explored over the first two decades from its creation with an approach initially aimed at improving the base structure of the model permeating by simple biological approaches to asexual organisms to the diverse and integrative implications of more complex organisms in their sexual reproductive aspects the model allowed the incorporation of parameters states and interactions that culminated in several variations and suitability of the model involving studies in the most diverse areas of ecology evolution and genetics 4 1 classic approach the penna model was originally structured to represent the intriguing phenomenon of biological aging based on the theoretical framework of the accumulation of deleterious mutations proposed by medawar 1952 the model s ability to represent individuals with their own genome heritable and subject to the pressure of natural selection made it possible to simulate population dynamics structured by age and with a quantity in the order of millions of individuals minimising errors and enabling comparisons with populations in nature by allowing the exploration of a greater number of states defined by bit strings bernardes 1996 the use and refinement of the model followed in its first decade a classic way of analyses focused on the mathematical and conceptual patterns of population distribution based on the model to the classic distribution expected by gompertz s law gompertz 1825 obtaining robust correspondences with the predicted behaviour for the mortality rate after sexual maturity which increases exponentially with age as well as their observations regarding the deviations observed for the mortality rate at older ages coe and mao 2005 kim and shim 2004 laszkiewicz et al 2003 makowiec et al 2001 sousa et al 2001 stauffer et al 1996 its simplicity as an ibm structured by age classes has expanded the possibilities applicability of penna model with emphasis on approaches in population ecological dynamics and the demonstration of behaviour predicted in genetic and evolutionary theories and assumptions for both versions of the model asexual and sexual the classical approach is presented in the study by penna et al 1995 who demonstrated the occurrence of the catastrophic senescence phenomenon of pacific salmon considering only two population parameters of the species the existence of a predetermined reproductive age and the occurrence of a single reproductive event semelparity for all individuals in the population piñol and banzon 2011 also demonstrated that the occurrence of catastrophic senescence does not depend only on the semelparous reproductive regime as demonstrated by penna et al 1995 but also the value of the reproductive age r and the parameter t of the model representing the maximum number of mutations that can be accumulated in an organism catastrophic senescence occurs when the value of t is less than or equal to the reproductive age r since there is a concentration of bad mutations in the initial bits leading to an abrupt decline in the survival rate the greater the tolerance of the organism to harmful mutations the increase in the t threshold the more gradual the aging process and the smaller the effect of the force of selection and elimination of mutations in the gene pool of the population 4 2 model parameters some parameters of the model were improved to obtain a better correspondence to the biological parameters namely the size of the genome alterations in the insertion of deleterious mutations and modifications in the verhulst factor see below details on verhulst factor 4 2 1 size of genome the limitation of 32 possible positions for the genome in the base model was first improved by argollo de menezes et al 1996 allowing the simulation for species with high life expectancy such as plant species the authors stored the age of the tested agent in only five bits of the word containing 32 positions allowing the unused bits to store the individual s threshold ages in the original model each position represents a single period of the organism s life whether in years months or minutes 4 2 2 insertion of mutations for the mutation rate m the main change refer to the fixed and relatively low values predicted in the original model commonly with m 01 for both reproductive systems asexual and sexual and the randomness of the choice of insertion position of the new mutation in the chronological genome one of the first changes in this parameter was performed by bernardes 1995 where one of the objectives of the article was to evaluate the phenomenon of mutational meltdown lynch and gabriel 1990 for large populations with a sexual reproductive regime assuming that the mutation rate in species with a sexual regime is extremely high the authors evaluated the temporal behaviour of the population for m 8 varying the birth rates the authors then found optimal values between the existence of a high mutation rate offset by an intermediate birth rate capable of keeping the population viable corroborating the evolutionary advantage for sexual reproductive regimes still in relation to the m parameter keesen et al 2017 considered the possibility of inserting up to four additional deleterious mutations in the newly generated individuals additional mutations are inserted considering a weighting between the degree of kinship existing between the parents for siblings up to four new mutations are inserted for cousins or children up to two new mutations for not related individuals the mutation inherent to the penna model is considered the changes proposed by keesen et al 2017 allowed introducing the effects of inbreeding to the model especially in small and isolated populations ito 1996 presented a mathematical formulation for the insertion of mutations expressed by a mutation matrix which represents the connection between the length of the genetic code bit string and the previously defined mutation rules insertion of bit 1 in the randomly chosen position on the string or the inversion of the values for the position which can be 0 or 1 moss de oliveira et al 1995a defined previous positions in the genomes of some individuals generated at the beginning of the simulation which provides them with a heritable positive phenotypic characteristic and induces a probabilistic mutation rate such as resistance to a disease the offspring have a 50 chance of receiving a positive or deleterious mutation in their genome generating individuals with both good and bad mutations 4 2 3 verhulst factor carrying capacity finally it is worth mentioning the changes imposed to the control of the population explosion in the penna model through the verhulst factor v the verhulst factor as originally implemented has no basis for natural biological systems since it indiscriminately eliminates any individual from the system regardless of age disease or other factors that would tend to eliminate lower fitness individuals from the system the use of a pearl verhulst factor assumes that mortality and fertility rates are independent of age depending only on the total population size raab 1998 sá martins and cebrat 2000 thus some studies have inserted verhulst implementation strategies allowing a selective choice for a given condition and or age group in thoms et al 1995 individuals under parental care are spared from the action of v because it is assumed that parental care confers a protective factor on the offspring compensating for their greater initial vulnerability puhl et al 1995 in his study of predator prey interaction v considers the proportion of each of the two populations prey n1 and predator n2 thus the probability of species survival is evaluated in terms of two factors the proportion 1 n1 n1 of prey for the probability of the survival of predators and the proportion of 1 n2 n2 of predators for the probability of the survival of prey a more sophisticated approach to the model presents space explicitly implemented through a network which represents a deterministic spatial capability rather than environmental influence the restriction arises from the spatial relationships between individuals and their neighbours which ends up preventing for example new births due to the lack of available space and consequently limiting population explosion dabkowski et al 2000 keesen et al 2017 makowiec 2001 the studies mentioned above are just a few examples of small modifications or adjustments to the model s base parameters that provided greater foundation for the already consolidated biological concepts and situations allowing for more realistic inferences and discussions 4 3 biological scenarios and inferences although most of the studies carried out with the penna model are directed to the mathematical analytical behaviour of biological concepts in view of the intended investigations the results found in many of them allow allusions consistent with what is expected in populations in nature the penna model allows inserting different intervening or driving factors in population dynamics producing different scenarios starting from a chronological order the first article that deserves to be highlighted among those found in the research platforms refers to the study carried out by de moss de oliveira et al 1995b which is one of the first ecological conservationist approaches using the penna model the authors demonstrated the effect of fishing pressure on population stability of a cod species defining ideal minimum sizes for fishing in the system of interest controlled in the model by age group the removal of a minimum percentage of individuals over reproductive age manages to maintain population stability maintaining optimal values for birth and mortality rates however a small increase in fishing pressure in the ideal age group or the withdrawal of individuals of less than or equal to reproductive age can completely destabilise the dynamics leading to the disappearance of the entire population one of the main general determinations on fishing in regulatory agencies e g fao food and agriculture organization of the united nations mapa ministry of agriculture livestock and supply brazil noaa national oceanic and atmospheric administration u s department of commerce refers to the minimum size allowed for fishing whether commercial or recreational penna et al 2001 present an approach similar to that mentioned above for the population dynamics of lobsters in northeastern brazil the authors considered not just the minimum age for capture but also a combination of minimum age and fertility since fertility in lobsters increases with age in this scenario the authors objective was to present a maintenance predictability for lobster stocks that combined age and fertility presenting an optimal value for the capture rate and an ideal maximum age the optimal value found 12 years also has measurable effects on mortality due to the accumulation of mutations since the control of withdrawal by age interferes with genetic variability more recently de souza et al 2012 evaluated the evolutionary effects of selective fishing on the body growth trajectory of a native fish species of great economic value in brazilian fisheries the pintado pseudoplatystoma corruscans the authors presented three fishing scenarios that were compared with experimental evidence validating the model as a useful tool in fishing strategies applied to other species feingold 1996 evaluated the survival rate for alaskan wolf populations subject to strong hunting pressure inserting their social structuring into packs into the model the results were compared to empirical data the so called control model obtaining similar inferences for population dynamics with low hunting pressure rates showing a balance between hunting rate and social deregulation the model was also used for population dynamics supported by assumptions described in the concept of metapopulations levins 1969 magdon 1999 and magdoń and maksymowicz 1999 assessed the evolution of subpopulations driven by environmental factors that alter migration forces or rates such as population density and carrying capacity in each x location the authors observed that at a low migration intensity the effects on the population dynamics of each subpopulation are insignificant following the rules and conditions inherent to the locality itself however the progressive increase in the flow of individuals among localities changes the population distribution among localities including local extinctions and the repopulation of empty sites recently keesen et al 2017 have evaluated the dynamics of populations subject to a scenario of fragmentation using as object of study a species of neotropical primates sapajus robustus the authors evaluated the behaviour of the population for different sizes of fragments represented in the model by l x l networks subject to the effects of population size geometric configuration of fragments and rate of dispersion the study emphasises the importance of the association of the increase of effective area and dispersion in actions that seek the conservation of the species indicating equilibrium values among the parameters tested for the existence of viable populations an approach of special interest has been proposed for an aphid species aphis gossypii comparing the simulation data under laboratory and field conditions giarola et al 2006 and for the coffee leaf miner de oliveira et al 2008 the authors evaluated the influence of environmental factors such as temperature precipitation and types of host plants as guides in biological control strategies indicating that deviations in these factors directly interfere with the fecundity values and life expectancy of the species which directly reflects the survival of the population of interest the possibilities of using the penna model are that diverse that even the insertion of learning cognition was simulated with excellence by the model bustillos and de oliveira 2004 inserted an additional string to demonstrate the knowledge acquired throughout the life of the individual they demonstrated that individuals with learning development have a longer life expectancy and that although not inheritable individuals with more accumulated knowledge after many generations by the effect of natural selection culminate in a population with better fitness finally we mention the use of the model in epidemiological dynamics two studies have evaluated the spread of epidemics for age structured populations graciani rodrigues et al 2015 he et al 2005 these studies obtained results consistent with those for real populations showing that the existence of an epidemic depends mainly on the infection rate and the mortality rate the epidemic persists in a combination of optimal values for infection rate and mortality rate if the infection rate is too low or the death rate is too high the epidemic cannot spread 5 conclusions although the conclusions presented in the consulted studies for the most part can be said to be modest if considered the intended expectation for an applied biological approach the penna model presents an immeasurable versatility of uses with the possibility of implementation for different scales temporal or spatial for different analytical languages either computational logical or strictly numerical such as differential equations in addition to the possibility of inserting individual and or population modifying parameters originally the model presented one of the possible mechanisms that govern the act of aging however subsequent approaches going beyond and presenting a universe of exploratory possibilities in the ecological ecological evolutionary and genetic ecological field that when worked in an interdisciplinary way can result in a tool to be applied to various phenomena and biological behaviours as well as a decision making tool credit authorship contribution statement fabíola keesen conceptualization investigation writing original draft writing review editing alcides castro e silva conceptualization writing original draft writing review editing carlos felipe s pinheiro conceptualization writing original draft writing review editing everaldo arashiro conceptualization writing original draft writing review editing yan ligeiro conceptualization investigation writing original draft writing review editing carlos eduardo de viveiros grelle conceptualization writing original draft writing review editing declaration of competing interest all authors declare that they have no conflicts of interest acknowledgements the authors thank andré lanna marcio argollo f de menezes and marcus v vieira for their valuable discussions and critical comments on the manuscript this study was supported by coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 fk thanks for a research scholarship from conselho nacional de desenvolvimento científico e tecnológico cnpq 140647 2018 0 cevg had grants from cnpq produtividade em pesquisa instituto nacional de ciência e tecnologia ecologia evolução e conservação da biodiversidade mcti cnpq fapeg 465610 2014 5 and ppbio cnpq mcti 
24282,a simplified representation or interpretation of reality using conceptual and mathematical models plays a role in understanding important phenomena especially biological ones based on medawar s mutation accumulation theory which predicts that the strength of natural selection decreases with age favouring the accumulation of deleterious genes to be expressed at advanced ages an individual based model ibm published in 1995 was designed to demonstrate the biological ageing mechanism with each individual being represented by a bitstring in a chronological manner this model is called penna model penna 1995 in honour of the creator the physicist thadeu josino pereira penna for this first time this article carries out a systematic review of the use of penna model to assess its applicability in other phenomena and biological mechanisms our results indicate that the model was extensively explored and improved by researchers from different parts of the world through small changes in the structure and base parameters of the model aimed at the biological phenomena of interest including ecology evolutionary ecology and genetics issues these changes have allowed the use of the model in other biological phenomena besides aging with studies in systems of predation competition fragmentation natural selection speciation genetics immunology epidemiology and others the model is highlighted as a fairly flexible tool for applied biological dynamics of simple use with the possibility of implementing different scales temporal or spatial and different languages computational logical or numerical in addition to the possibility of inserting parameters that modify the individual and or population that allow consistent results for decision making keywords biological dynamics bitstring mutation accumulation penna model data availability data will be made available on request 1 introduction in ecology the use of models creates a new perspective of understanding and explaining highly complex biological processes by making use of generalisations or simplifications where only phenomena considered essentially important are considered models are abstractions of reality with capacity to describe essential elements of a problem of interest wang and grant 2019 models in ecology can also be classified into different types depending on the intended approach to the problem raised jørgensen and swannack 2019 classify ecological models primarily into 11 types considering them tools for analysing ecological phenomena and their causalities jørgensen 2008 in the last two decades the number of ecological studies involving modelling has considerably increased from 300 articles per year between 1975 and 1982 to 4 000 per year in the period between 2000 and 2006 with publications starting in the 2000s utilizing mostly spatial models and models based on individuals jørgensen 2008 individual based models ibms or agent based models abms are a method that describe a given population through the discrete modelling of its very single organisms grimm and railsback 2005 in this approach each organism is called agent each agent is defined with a set of states or attribute variables and behaviours that vary between individuals and may change over time the performance observed at the population level emerges from a button up dynamic resulting from the simultaneous interactions between each individual and with the environment deangelis and grimm 2014 ibms allow studying the implications of physiological processes behavioral traits and environmental interactions synchronously an advance in ecological modeling as it allows joining structural functional quantitative and qualitative aspects in a way that suits observation data and conceptual knowledge representation reuter et al 2011 the integration of theoretical concepts with field data makes it possible to present estimates that are increasingly realistic and functional peck and hufnagl 2012 a simple and versatile model classified in the light of ecological divisions as an ibm was developed in 1995 by thadeu josino pereira penna a physicist interested in demonstrating some characteristics of the biological aging processes that occur in natural populations penna 1995 used one of the several evolutionary theories that underlie the complex and intriguing phenomenon of senescence to develop his model the so called medawar theory of accumulation of mutations this theory considers that the strength of natural selection decreases with age favouring the accumulation of deleterious genes to be expressed at advanced ages medawar 1952 early manifestation phenotypes before or during the reproductive period could be eliminated by natural selection otherwise this gene will be passed on to the offspring remaining and accumulating late in the following generations which in turn would lead to the evolution of aging medawar 1952 rose 1991 the first version of the model named penna model in honour of the creator simulated the biological aging mechanism for a hypothetical species elaborated in a computational environment and with an asexual reproductive regime penna and stauffer 1995 penna 1995 in this model each individual of this hypothetical species is represented by a bit string that contains its chronological and hereditary life history called by convention a chronological genome fig 1 the bit string has a fixed and predetermined length that indicates to a greater or lesser degree the life expectancy of the object of interest each bit string position represents the age of the individual which can be years months days among others each position is filled with 0 or 1 where 1 indicates the manifestation of a mutation or hereditary disease in a certain period of its biological cycle the maximum number of mutations bits 1 that an individual can have throughout its life or the sum of all previously defined mutations called threshold t will determine how many years that individual can survive the control of population explosion and death by non deterministic events such as resource restriction or ecological interactions such as competition and predation is represented by the verhulst factor v 1 n t k where k represents the environment carrying capacity and n t represents the population size at the present time at each round of the simulation a random number is generated for each of the individuals in the population which is compared to the value of v if the number is greater than or equal to v the individual will die even if it has not reached the sum of all its mutations in addition to the parameters intrinsic to the bit string the model incorporates some basic parameters in population studies such as reproductive age r and offspring size b and an evolutionary genetic parameter the mutation rate m which represents a fixed number of mutations that are introduced randomly in the new individuals generated adopted as m 1 for the elementary model thus the newly generated individual will inherit the sequence of bits from its parent with the accumulated mutations and the possibility of obtaining an additional deleterious mutation in any of its positions bernardes 1996 and stauffer et al 1996 were the first to adapt the penna model for sexual reproduction in the sexual model each individual is represented by a pair of bit strings containing information inherited from the father and mother fig 2 for a disease to manifest in this double stranded genome the individual must be homozygous at that position that is have 1 and 1 on both strands in positions where this individual is heterozygous that is with 1 and 0 for each strand he will manifest the disease according to a dominance factor d this dominance factor indicates the number of positions randomly chosen at the beginning of the simulation for all individuals in which when only one character 1 appears the disease will manifest itself offspring is generated by the crossing over mechanism from the bit strings of its parents the t m and b parameters and the v factor remain the default for the two model arrangements the versatility and simplicity of the penna model with chronologically structured individuals combined with the dynamism of a model that can be simulated in time and space allowed the projection of several ecological evolutionary and not to say genetic theoretical phenomena since its publication thus presenting a compendium of the evolution of the model and its main applications as well as presenting its perspectives for biological approaches especially ecological dynamics was the main objective of this elaborate synthesis in this work we carried out a systematic review of the literature on the penna model and its different biological approaches the methods applied in the systematic review and the aspects of interest are described the results obtained are presented from the analysis of the literature highlighting the main advances made in the base model and an analysis of the applicability of the works with emphasis on studies in ecology the study concludes with a discussion on the versatility and possibilities of using the model in evolutionary ecology applied ecology 2 literature search and analysis 2 1 bibliographic search the bibliographic search on the penna model considered all scientific studies published from 1995 the year of the publication of the base model penna and stauffer 1995 penna 1995 until april 2021 the searches were carried out in two official databases web of science www isiknowledge com and scopus www scopus com the terms penna model or aging model or bit string model were used as keyword combinations since the penna model is a methodological procedure with the possibility of mentioning the use of the model only in the methodological session the search for the cited terms considered the entirety of the works not being restricted as commonly practiced to the title abstract or keywords cited by returned studies that fit the assumptions presented were added to the dataset and used as additional bibliographic sources only studies that mentioned the keyword penna model ageing model or bit string model in their methodological approach were included therefore excluding the articles that cite the model but do not actually apply it exception was considered for revisions on the model thus only studies that reported applications methodological advances of the model or inductive mathematical approaches were retained for analysis fig 3 2 2 data analysis the information contained in the articles was entered into a spreadsheet containing information on the temporal progress of the model such as when the work was carried out authorship document type journal article book book section conference proceedings and serial research areas suggested by the web of science platform which categorises different subjects into five major areas arts humanities life sciences biomedicine physical sciences social sciences and technology and thematic axis simulation or biological theoretical the latter being divided into biological sub areas and other biological themes table 1 for each of the biological sub areas the thematic specificities addressed in each study were listed such as population dynamics and all its derivations predation competition carrying capacity survival rate biological aging genetic variability among others the classification of the article in biological sub areas considered the dominant theme however when an article systematically involved either in the structure of the model or in the theoretical inferences more than one area these areas were counted twice desai s work desai et al 1999 for example was classified as biological theory with ecological implications in view of the measurement of fertility rate in population dynamics and genetic implications since fertility was considered from the perspective of genetic mutations the information transcribed from the consulted works was summarised in graphs and tables allowing a descriptive visualization of the data 3 summary of information the bibliographic search returned 287 scientific works of which only those that met two criteria were selected 1 explicit use of the penna model and its derivations in the methodological structure of the predicted analysis and 2 conceptual studies such as reviews of the total studies 59 were discarded because they did not use the penna model in their methodological structure or because they only cited the model in its thematic context thus a total of 228 studies met the eligibility and inclusion criteria in the systematic review which were then carefully evaluated and separated into simulation themed studies n 63 and biological theories n 165 among which 155 studies were classified in one of the biological sub areas and 10 studies classified as other themes fig 4 the biological theoretical axis biological subareas indicated 58 publications directed to the study of phenomena classified as exclusively ecological 58 exclusively evolutionary studies and 15 exclusively genetic studies fig 5 a total of 25 studies were considered interdisciplinary as they explicitly addressed more than one of the classified sub areas the articles found in the literature for each of the biological subareas addressed different ecological evolutionary and genetic themes and concepts with many studies having integrated approaches between the different areas of interest the ecology sub area presented studies predominantly focused on population dynamics evaluating population parameters and concepts on ecological relationships for populations of the same species and or among different species the central approach in evolution was biological aging with studies in interaction with some ecological parameters in the sub areas genetics speciation and mutation were the most common ones fig 6 despite the high number of studies classified as biological theorists only few were published in journals and books in the biological areas n 30 with most studies directed to the exact sciences fig 7 regarding the chronological use of the model it was widely explored in the first decade after its publication accounting for 69 of all studies found 158 with 104 theoretical biological studies 99 biological sub areas and 05 other themes and 54 studies involving simulation fig 8 4 the manifold penna models the penna model was extensively explored over the first two decades from its creation with an approach initially aimed at improving the base structure of the model permeating by simple biological approaches to asexual organisms to the diverse and integrative implications of more complex organisms in their sexual reproductive aspects the model allowed the incorporation of parameters states and interactions that culminated in several variations and suitability of the model involving studies in the most diverse areas of ecology evolution and genetics 4 1 classic approach the penna model was originally structured to represent the intriguing phenomenon of biological aging based on the theoretical framework of the accumulation of deleterious mutations proposed by medawar 1952 the model s ability to represent individuals with their own genome heritable and subject to the pressure of natural selection made it possible to simulate population dynamics structured by age and with a quantity in the order of millions of individuals minimising errors and enabling comparisons with populations in nature by allowing the exploration of a greater number of states defined by bit strings bernardes 1996 the use and refinement of the model followed in its first decade a classic way of analyses focused on the mathematical and conceptual patterns of population distribution based on the model to the classic distribution expected by gompertz s law gompertz 1825 obtaining robust correspondences with the predicted behaviour for the mortality rate after sexual maturity which increases exponentially with age as well as their observations regarding the deviations observed for the mortality rate at older ages coe and mao 2005 kim and shim 2004 laszkiewicz et al 2003 makowiec et al 2001 sousa et al 2001 stauffer et al 1996 its simplicity as an ibm structured by age classes has expanded the possibilities applicability of penna model with emphasis on approaches in population ecological dynamics and the demonstration of behaviour predicted in genetic and evolutionary theories and assumptions for both versions of the model asexual and sexual the classical approach is presented in the study by penna et al 1995 who demonstrated the occurrence of the catastrophic senescence phenomenon of pacific salmon considering only two population parameters of the species the existence of a predetermined reproductive age and the occurrence of a single reproductive event semelparity for all individuals in the population piñol and banzon 2011 also demonstrated that the occurrence of catastrophic senescence does not depend only on the semelparous reproductive regime as demonstrated by penna et al 1995 but also the value of the reproductive age r and the parameter t of the model representing the maximum number of mutations that can be accumulated in an organism catastrophic senescence occurs when the value of t is less than or equal to the reproductive age r since there is a concentration of bad mutations in the initial bits leading to an abrupt decline in the survival rate the greater the tolerance of the organism to harmful mutations the increase in the t threshold the more gradual the aging process and the smaller the effect of the force of selection and elimination of mutations in the gene pool of the population 4 2 model parameters some parameters of the model were improved to obtain a better correspondence to the biological parameters namely the size of the genome alterations in the insertion of deleterious mutations and modifications in the verhulst factor see below details on verhulst factor 4 2 1 size of genome the limitation of 32 possible positions for the genome in the base model was first improved by argollo de menezes et al 1996 allowing the simulation for species with high life expectancy such as plant species the authors stored the age of the tested agent in only five bits of the word containing 32 positions allowing the unused bits to store the individual s threshold ages in the original model each position represents a single period of the organism s life whether in years months or minutes 4 2 2 insertion of mutations for the mutation rate m the main change refer to the fixed and relatively low values predicted in the original model commonly with m 01 for both reproductive systems asexual and sexual and the randomness of the choice of insertion position of the new mutation in the chronological genome one of the first changes in this parameter was performed by bernardes 1995 where one of the objectives of the article was to evaluate the phenomenon of mutational meltdown lynch and gabriel 1990 for large populations with a sexual reproductive regime assuming that the mutation rate in species with a sexual regime is extremely high the authors evaluated the temporal behaviour of the population for m 8 varying the birth rates the authors then found optimal values between the existence of a high mutation rate offset by an intermediate birth rate capable of keeping the population viable corroborating the evolutionary advantage for sexual reproductive regimes still in relation to the m parameter keesen et al 2017 considered the possibility of inserting up to four additional deleterious mutations in the newly generated individuals additional mutations are inserted considering a weighting between the degree of kinship existing between the parents for siblings up to four new mutations are inserted for cousins or children up to two new mutations for not related individuals the mutation inherent to the penna model is considered the changes proposed by keesen et al 2017 allowed introducing the effects of inbreeding to the model especially in small and isolated populations ito 1996 presented a mathematical formulation for the insertion of mutations expressed by a mutation matrix which represents the connection between the length of the genetic code bit string and the previously defined mutation rules insertion of bit 1 in the randomly chosen position on the string or the inversion of the values for the position which can be 0 or 1 moss de oliveira et al 1995a defined previous positions in the genomes of some individuals generated at the beginning of the simulation which provides them with a heritable positive phenotypic characteristic and induces a probabilistic mutation rate such as resistance to a disease the offspring have a 50 chance of receiving a positive or deleterious mutation in their genome generating individuals with both good and bad mutations 4 2 3 verhulst factor carrying capacity finally it is worth mentioning the changes imposed to the control of the population explosion in the penna model through the verhulst factor v the verhulst factor as originally implemented has no basis for natural biological systems since it indiscriminately eliminates any individual from the system regardless of age disease or other factors that would tend to eliminate lower fitness individuals from the system the use of a pearl verhulst factor assumes that mortality and fertility rates are independent of age depending only on the total population size raab 1998 sá martins and cebrat 2000 thus some studies have inserted verhulst implementation strategies allowing a selective choice for a given condition and or age group in thoms et al 1995 individuals under parental care are spared from the action of v because it is assumed that parental care confers a protective factor on the offspring compensating for their greater initial vulnerability puhl et al 1995 in his study of predator prey interaction v considers the proportion of each of the two populations prey n1 and predator n2 thus the probability of species survival is evaluated in terms of two factors the proportion 1 n1 n1 of prey for the probability of the survival of predators and the proportion of 1 n2 n2 of predators for the probability of the survival of prey a more sophisticated approach to the model presents space explicitly implemented through a network which represents a deterministic spatial capability rather than environmental influence the restriction arises from the spatial relationships between individuals and their neighbours which ends up preventing for example new births due to the lack of available space and consequently limiting population explosion dabkowski et al 2000 keesen et al 2017 makowiec 2001 the studies mentioned above are just a few examples of small modifications or adjustments to the model s base parameters that provided greater foundation for the already consolidated biological concepts and situations allowing for more realistic inferences and discussions 4 3 biological scenarios and inferences although most of the studies carried out with the penna model are directed to the mathematical analytical behaviour of biological concepts in view of the intended investigations the results found in many of them allow allusions consistent with what is expected in populations in nature the penna model allows inserting different intervening or driving factors in population dynamics producing different scenarios starting from a chronological order the first article that deserves to be highlighted among those found in the research platforms refers to the study carried out by de moss de oliveira et al 1995b which is one of the first ecological conservationist approaches using the penna model the authors demonstrated the effect of fishing pressure on population stability of a cod species defining ideal minimum sizes for fishing in the system of interest controlled in the model by age group the removal of a minimum percentage of individuals over reproductive age manages to maintain population stability maintaining optimal values for birth and mortality rates however a small increase in fishing pressure in the ideal age group or the withdrawal of individuals of less than or equal to reproductive age can completely destabilise the dynamics leading to the disappearance of the entire population one of the main general determinations on fishing in regulatory agencies e g fao food and agriculture organization of the united nations mapa ministry of agriculture livestock and supply brazil noaa national oceanic and atmospheric administration u s department of commerce refers to the minimum size allowed for fishing whether commercial or recreational penna et al 2001 present an approach similar to that mentioned above for the population dynamics of lobsters in northeastern brazil the authors considered not just the minimum age for capture but also a combination of minimum age and fertility since fertility in lobsters increases with age in this scenario the authors objective was to present a maintenance predictability for lobster stocks that combined age and fertility presenting an optimal value for the capture rate and an ideal maximum age the optimal value found 12 years also has measurable effects on mortality due to the accumulation of mutations since the control of withdrawal by age interferes with genetic variability more recently de souza et al 2012 evaluated the evolutionary effects of selective fishing on the body growth trajectory of a native fish species of great economic value in brazilian fisheries the pintado pseudoplatystoma corruscans the authors presented three fishing scenarios that were compared with experimental evidence validating the model as a useful tool in fishing strategies applied to other species feingold 1996 evaluated the survival rate for alaskan wolf populations subject to strong hunting pressure inserting their social structuring into packs into the model the results were compared to empirical data the so called control model obtaining similar inferences for population dynamics with low hunting pressure rates showing a balance between hunting rate and social deregulation the model was also used for population dynamics supported by assumptions described in the concept of metapopulations levins 1969 magdon 1999 and magdoń and maksymowicz 1999 assessed the evolution of subpopulations driven by environmental factors that alter migration forces or rates such as population density and carrying capacity in each x location the authors observed that at a low migration intensity the effects on the population dynamics of each subpopulation are insignificant following the rules and conditions inherent to the locality itself however the progressive increase in the flow of individuals among localities changes the population distribution among localities including local extinctions and the repopulation of empty sites recently keesen et al 2017 have evaluated the dynamics of populations subject to a scenario of fragmentation using as object of study a species of neotropical primates sapajus robustus the authors evaluated the behaviour of the population for different sizes of fragments represented in the model by l x l networks subject to the effects of population size geometric configuration of fragments and rate of dispersion the study emphasises the importance of the association of the increase of effective area and dispersion in actions that seek the conservation of the species indicating equilibrium values among the parameters tested for the existence of viable populations an approach of special interest has been proposed for an aphid species aphis gossypii comparing the simulation data under laboratory and field conditions giarola et al 2006 and for the coffee leaf miner de oliveira et al 2008 the authors evaluated the influence of environmental factors such as temperature precipitation and types of host plants as guides in biological control strategies indicating that deviations in these factors directly interfere with the fecundity values and life expectancy of the species which directly reflects the survival of the population of interest the possibilities of using the penna model are that diverse that even the insertion of learning cognition was simulated with excellence by the model bustillos and de oliveira 2004 inserted an additional string to demonstrate the knowledge acquired throughout the life of the individual they demonstrated that individuals with learning development have a longer life expectancy and that although not inheritable individuals with more accumulated knowledge after many generations by the effect of natural selection culminate in a population with better fitness finally we mention the use of the model in epidemiological dynamics two studies have evaluated the spread of epidemics for age structured populations graciani rodrigues et al 2015 he et al 2005 these studies obtained results consistent with those for real populations showing that the existence of an epidemic depends mainly on the infection rate and the mortality rate the epidemic persists in a combination of optimal values for infection rate and mortality rate if the infection rate is too low or the death rate is too high the epidemic cannot spread 5 conclusions although the conclusions presented in the consulted studies for the most part can be said to be modest if considered the intended expectation for an applied biological approach the penna model presents an immeasurable versatility of uses with the possibility of implementation for different scales temporal or spatial for different analytical languages either computational logical or strictly numerical such as differential equations in addition to the possibility of inserting individual and or population modifying parameters originally the model presented one of the possible mechanisms that govern the act of aging however subsequent approaches going beyond and presenting a universe of exploratory possibilities in the ecological ecological evolutionary and genetic ecological field that when worked in an interdisciplinary way can result in a tool to be applied to various phenomena and biological behaviours as well as a decision making tool credit authorship contribution statement fabíola keesen conceptualization investigation writing original draft writing review editing alcides castro e silva conceptualization writing original draft writing review editing carlos felipe s pinheiro conceptualization writing original draft writing review editing everaldo arashiro conceptualization writing original draft writing review editing yan ligeiro conceptualization investigation writing original draft writing review editing carlos eduardo de viveiros grelle conceptualization writing original draft writing review editing declaration of competing interest all authors declare that they have no conflicts of interest acknowledgements the authors thank andré lanna marcio argollo f de menezes and marcus v vieira for their valuable discussions and critical comments on the manuscript this study was supported by coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 fk thanks for a research scholarship from conselho nacional de desenvolvimento científico e tecnológico cnpq 140647 2018 0 cevg had grants from cnpq produtividade em pesquisa instituto nacional de ciência e tecnologia ecologia evolução e conservação da biodiversidade mcti cnpq fapeg 465610 2014 5 and ppbio cnpq mcti 
24283,according to classical ecological theory biodiversity at ecosystem scale can be viewed as the direct product of landscape complexity and information and the inverse product of energy dissipation the main difference between natural ecosystems and agroecosystems is the external energy driven by farmers hence it could be argued that biodiversity in biocultural landscapes can be explained by an energy information structure model we developed an energy landscape integrated analysis elia to predict biodiversity levels in human transformed landscapes elia combines the energy flow accounting in agricultural landscapes from abioeconomic point of view and landscape ecological metrics that assess the functional structure of the land cover it uses indicators to assess the energy stored in internal loops e and the information incorporated into the energy network i to establish a correlation with the resulting patterns and processes in biocultural landscapes l we tested the model on biodiversity data using butterflies and birds the results showed positive correlations between butterfly and bird species richness and elia and above all between i and elia this emphasizes how different strategies of agricultural management combined with nature conservation can be employed at certain optimal points in the relationship between the energy information structure of biocultural landscapes and the biodiversity present therein elia modelling is the key to a new research agenda that will be very useful for designing more sustainable agroecosystems metropolitan green infrastructures and land use policies in line with the forthcoming agroecology transition planned by the european commission and the food and agriculture organization keywords agroecosystem complexity social metabolism disturbance ecology biocultural landscapes species richness biodiversity conservation data availability data will be made available on request 1 introduction for centuries global human driven land use and cover change lucc has stimulated the spread of human modified habitats in many regions including the mediterranean thereby affecting biodiversity and ecosystem functioning in human transformed landscapes grove and rackham 2001 its impact has been manifold and created a very different landscape from the mosaics of the past today we see the results of organic mixed farming adapted to site specific natural conditions land cover homogenization driven by industrial farming the use of animal feed based on fossil fuels and spontaneous reforestation causing rural abandonment giampietro et al 2013 sterling and ducharne 2008 ellis et al 2008 the effects of lucc on biodiversity are already well known newbold et al 2005 ipbes 2019 and include a general decrease in species richness but also changes in species composition due to the rarefaction of habitat specialists and expansion of generalists and cosmopolitan species as well as invasions by alien species gonzález moreno et al 2013 gaertner et al 2017 facilitated by increasing propagule pressure and disturbance levels vilà and ibáñez 2011 basnou et al 2015 all these impacts lead to biotic homogenization in the most human transformed regions mckinney 2006 human transformed landscapes are today the outcome of a shifting interplay between the spatial patterns of land use types driven by the energy flows of human activity and their associated ecological processes haberl 2001 wrbka et al 2004 a widely acknowledged consensus in conservation biology known as the intermediate disturbance hypothesis cornell 1978 accepts that landscape heterogeneity is key to maintaining high biodiversity levels at intermediate disturbance levels through the interaction between on the one hand ecosystem patch diversity and on the other the ecological requirements that activate the dispersal abilities of species originating from less disturbed patches or allow colonization from the most disturbed ones perfecto and vandermeer 2010 loreau et al 2010 however the outcome also depends on the intensity and spatial distribution of the metabolic i e energy flows driven by society swift et al 2004 marull et al 2016b this recurrent interaction between landscape patterns and socioecological pressures has opened up a research field that investigates how the complexity of the energy flows driven by farming livestock rearing and forestry imprint diverse spatial patterns of human land uses that give rise either to heterogeneous or homogeneous landscapes able to house very different levels of biodiversity matthews and selman 2006 parrotta and trosper 2012 that can be addressed through a network perspective jordán 2022 the fundamentals of this research agenda can be found in morowitz s theorem that states that a flow of energy through a system is a necessary and sufficient condition for generating an organized albeit ephemeral structure morowitz 2002 the structures of living systems that emerge and evolve towards self reproducing complexity allow us to keep information organized and to transfer energy with greater efficiency away from thermodynamic equilibrium gladyshev 1999 this increase in internal complexity is achieved by exporting entropy to the environment since all living organisms are dissipative structures with multiple metabolic cycles embedded in a heterogeneous functional organization over space and time schrödinger 1944 this thermodynamic concept of organisms has close similarities to ecosystems functioning which is directly related to information complexity and inversely to entropy ho and ulanowicz 2005 when a living system becomes more complex it is also metabolically more efficient because it increases its internal information rather than its energy intake thereby also reducing entropy ulanowicz 2003 margalef 1958 1963 indicated that ecosystem succession tends to a decrease in the photosynthetic net primary production npp growth rate in other words energy combined with information increases diversity and does not produce greater uniformity similarly complex agroecosystems can store more energy and information at some points that reduce their internal entropy thanks to the exploitation of other spaces of less complexity that have larger npp rates many traditional mediterranean agroecosystems are the result of this type of balance between exploitation and conservation due to the spatial localization of different gradients of human intervention a wise intermediate disturbance pattern resulting in heterogeneous landscape mosaics gonzález bernáldez 1981 the combination of an energy flow pattern driven by complex information regarding how energy is redistributed across space is a good starting point for modelling human landscape relationships according to margalef 1991 the relationship between the external energy inputs and the dimensions that characterize the spatial patterns of its distribution gives rise to the functional structure of landscape mosaics able to host higher biodiversity than other homogeneous landscapes to test this hypothesis marull et al 2016a 2019b developed an energy landscape integrated analysis elia of agroecosystems that considers both the investment of energy stored within e and the information held in the whole network of socio metabolic energy flows i to correlate their interplay e i with the functional structure of the resulting biocultural landscape l this implies assessing whether the energy reinvested and redistributed by farming driven metabolic flows can lay the foundations for studying the linkages that exist between social metabolism landscape ecology and biodiversity which in the final instance will help generate resilient agroecosystems ho et al hu et al 2018 and sustainable land use policies padró et al 2020 testing margalef s hypothesis requires specifying and accounting for the ecological disturbance exerted by the information driven external energy that farmers incorporate into the landscape the human appropriation of net primary production hanpp is a quantitative estimate of the potential annual biological productivity reduced by human activities haberl et al 2007 krausmann et al 2013 it represents an initial approach to the interplay between anthropogenic disturbances and wildlife s ability to withstand them intermediate hanpp values are able to sustain greater biodiversity in human modified landscapes than higher ones that largely decrease habitat differentiation and negatively affect the provision of food chains free from human colonization barnes et al 2006 thus marull et al 2016a developed an intermediate disturbance complexity idc model to assess how different levels of anthropogenic disturbance at regional scale affect landscape functional structure results show a hump shaped relationship between landscape complexity free npp available for non domesticated species and biodiversity levels marull et al 2016a 2018 however it depends greatly not only on the overall flux balance of photosynthetic biomass but on the intensity and distribution of socio metabolic flows associated with either land use mosaics or homogeneous land covers in agroecosystems swift et al 2004 peterseil et al 2004 the elia modelling goes a step further than the previous idc explorations of the links between intermediate levels of socio metabolic human disturbance and the ecological functioning of biocultural landscapes carried out at regional scale marull et al 2018 it measures e as the proportion of energy remaining in the agroecosystem and i as the network of flows that allows farmers to reproduce the landscape l fund components due to the information embedded in the system according to the fund flow bioeconomic approach all biophysical flows that sustain societal metabolism are provided by living funds that to continue providing them they also need to be nourished and reproduced georgescu roegen 1971 this approach leads to a circular bioeconomic view that assesses the sustainability of socioecological systems in terms of the reproducibility of the living fund components within the biophysical structures of our societies in agroecosystems this means both the reproduction of living funds such as soil fertility which requires replenishment with organic matter and nutrients maeder et al 2002 and aboveground biodiversity which requires heterogeneous landscapes with sufficient npp free from human appropriation tscharntke et al 2012 the way in which these internal energy flows of agroecosystems recirculate and temporarily store energy within agroecosystem is by interlinking their living funds with each other through a set of bioconversions similar to how food chains in ecosystems do it we use this energy information structure model fig 1 to predict the locations of two important and particularly well known biodiversity components butterflies and birds in the human transformed landscapes here employed as empirical example the aim is to test margalef s hypothesis that the complex landscape mosaics of traditional organic agriculture were and continue to be good for biodiversity conservation margalef 1991 using butterfly and bird transects in the barcelona metropolitan region bmr we account for the association between landscape patterns composition and spatial configuration elia components e i l and biodiversity species richness and total observations after applying the elia model we use structural equation modelling sem to assess how social metabolism affects the capacity of metropolitan landscapes to host these indicators of biodiversity 2 materials and methods 2 1 study area covering 3200 km2 and with a population of 4 5 million the bmr is one of the most densely populated regions in europe fig 2 however this region still possesses several important natural and semi natural areas boasting considerable ecological diversity and valuable biocultural landscapes contrasting topography elevations ranging from 0 to 1700 m a s l and climate with ne sw gradients from moist to dry and from less to more continental afford it greater climatic and land cover variability than most mediterranean areas and are responsible for the great biodiversity present in this highly human transformed territory the region contains more than 40 habitat types of european interest according to 92 43 eu directive including natural forests scrublands and grasslands 60 of the region and semi natural habitats croplands 21 2 2 the energy landscape integrated analysis elia as explained elia is a spatially explicit model for an energy information landscape integrated analysis based on information theory applied to ecology marull et al 2016b it combines the landscape functional structure l with the interlinking pattern of energy flows driven by farming e and the information they contain i elia summarises both natural and cropland production in agroecosystems fig 3 through a combination of internal vertical axis matter energy flows derived from photosynthesis and external matter energy flows coming from human society through the farmers labour and knowledge left hand side of the horizontal axis these flows interact across the agroecosystem functioning and give rise to a final product consumed and dissipated by the human society as well right hand side of the horizontal axis the elia graph is the depiction of this socio metabolic biophysical interaction with nature in human transformed ecosystems accordingly the flows of energy carriers from the solar radiation photosynthetically converted into biomass i e the itinerary of the photosynthetic net primary production npp along the vertical axis interact with the flows farmers invest i e the itinerary of the external energy carriers moving along the horizontal axis all matter energy flows that arrive at a node split into two one incoming flow recirculates within the agroecosystem and another outgoing flow ends up in the agri food basket of consumable products delivered to society which in some cases is wasted the elia graph fig 3 resulting from this pairwise distribution of flows distinguishes between three main internal loops that characterize agroecosystem functioning 1 the most natural cycles e g forestry and livestock grazing on natural pastures which merely extract some of the npp the rest is left to internal recirculation without directly interfering with the reproductive natural cycling of these flows which end up decomposed as organic matter that temporarily accumulates energy in fertile soils where ecological turnover recommences 2 the cropland cycles which require a direct input of farmers labour through ploughing seeding weeding harvesting and fertilizing the soils where npp is reinitiated on arable land and 3 the livestock raising cycle through which a share of the previous biomass flows that circulate in loops 1 to 2 are diverted to feed farmers herds that in turn recirculate manure into cropland and pastureland while provisioning livestock products to the societal agri food chains the more linked the flows of matter and energy moving through these three cycles of a mixed farming the more complex and endowed with information the agroecosystem is the plant biomass obtained from ecosystem photosynthesis is the actual net primary production nppact i e the energy source for all the heterotrophs that live there the biomass included in the nppact that becomes available for heterotrophic species splits into unharvested biomass ub and the share of net primary production harvested by farmers npph fig 3 the ub generally remains in the same place as it was originally grown and can feed farm associated biodiversity it becomes a source of the agroecosystem total turnover att which closes the cycle of the natural subsystem this subsystem maintains the farm associated biodiversity and in turn the production of nppact again through the trophic net of non domesticated species either aboveground or in the edaphic decay processes of the soil npph splits into biomass reused br inside the agroecosystem and farmland final produce ffp that flows outside the system br is an important flow that remains within the agroecosystem thanks to the farmers investment aimed at directly or indirectly maintaining two basic funds livestock and soil fertility hence br closes the farmland subsystem circle then br is split into the share that goes to feed and bed domestic animals as livestock biomass reused lbr which can be added to the livestock total inputs lti and farmland biomass reused fbr in turn these flows add up to farmland total inputs fti as seeds green manure and other plant based fertilizers fig 3 these energy linkages in the graph enable us to see to what extent land use management is carried out by integrating or not the basic living funds of the agroecosystem finally domestic animals perform bioconversion and then the lbr flow splits into livestock final produce lfp and internal livestock services ls lfp includes a wide range of food and fibre products while ls services include driving force and animal manure together they make up livestock produce and services lps the farmland and livestock subsystems are partially closed within agroecosystems and offer a final produce fp that is consumed and dissipated outside and also receive external inputs ei therefore ub br and ls regulate the internal flows that lead to a higher or lower circularity in the pattern of energy networks in agroecosystems fig 3 they constitute important flows of recirculating biomass that contribute to the maintenance of the agroecosystem living funds that is associated biodiversity soil fertility and livestock conversely their weakening denotes an increase in the linearity and external dependence of the agroecosystem the circularity of matter energy flows is kept within the agroecosystem because the outputs of one subsystem serve as inputs for the next subsystem thereby allowing for the temporary storage of energy carriers and information within its dissipative structure interlinking their living funds through a set of energy bioconversions that said there is an exception to this rule that occurs when energy carriers circulating inside the agroecosystem due to farmers mismanagement are converted into a resource out of place i e waste we consider waste an energy flow that cannot be integrated into the structured recirculation of matter energy of the agroecosystems either because it exceeds their carrying capacity or because the way it is disposed of does not render it useful for neither keeping alive the agroecosystems funds nor to meet societal goals in some cases the monetary cost of certain biomass flows is larger than the benefits they generate and this can lead to misuse the result is a waste flow sometimes a fraction of nppact can be wasted such as crop stubble or tree pruning and are burnt rather than properly composted and used as fertilizer as it often occurred in past times when they were used as bedding straw home heating branches or animal feed leaves and green shots browsed the same may happen with a fraction of the lps generated by agro industrial feedlots whose excess is spread on cropland beyond its carrying capacity and eventually contaminates the water table a resource out of place if they exist farmland waste fw and livestock waste lw do not contribute to the renewal of the agroecosystem s funds they neither enhance its internal complexity nor meet human needs 2 2 1 measuring energy storage as a reinvestment of energy cycles e we understand agroecosystem complexity to be the differentiation of dissipative structures e g metabolic cycles that allows for a diversity of potential ranges in the system s behaviour the more complex the space time differentiation of these structures the more energy is stored within a living system hence higher mean values of even βi mean that agroecosystems are increasing in complexity because the different cycles are connected and the residence time of the stored energy increases thanks to a greater number of interlinked energy transformations circling within accordingly our way of calculating the energy stored and needed to keep the agroecosystem s funds functioning is as follows eq 1 1 e β 2 β 4 2 k 1 β 6 β 8 2 k 2 β 10 β 12 2 k 3 k 1 u b u b b r l s k 2 b r u b b r l s k 3 l s u b b r l s where the coefficients k 1 k 2 k 3 account for the share of reusing energy flows that are circulating through each of the three subsystems fig 3 which allows us to differentiate the agroecosystems fund composition and make their energy patterns comparable e remains within the range 0 1 an e close to 0 implies a low reuse of energy flows usually associated with industrial agroecosystems which are highly dissipative and dependant on external inputs an e close to 1 implies the existence of internal cycles only meaning land abandonment which is associated with the loss of biocultural landscapes or to a simple extractive use of the land i e foraging or hunting e assesses the amount of all the energy flows that are returned to the agroecosystem relative to the total amount of energy flowing across each one of the three subsystems if we pool the three subsystems together we are adopting a landscape agroecology standpoint focused on what happens with the energy carriers flowing across the different land units driven by farmers this allows us to link farming energy analysis with landscape ecology assessment 2 2 2 measuring information as the complexity of energy flow patterns i according to information theory applied in ecology hirata and ulanowicz 1984 grueber et al 2011 agroecosystems have a quantity of information embedded in their network structure that allows their reproduction to take place over time this information can be assessed through the graph complexity i e the degree to which energy flow is equally distributed across all edges and nodes of the graph or conversely is concentrated only on some edges and nodes an equal distribution of energy flows across the edges that link the nodes of a graph fig 1 means that the information carried cannot be known beforehand shannon and weaver 1949 therefore the information given by each event is the highest that can be transmitted by the channel considered in this case the agroecosystem to the farmers that manage them this type of information accounting can be seen as a measure of uncertainty or the degree of freedom for the system to behave and evolve it is called information message and registers the likelihood of the occurrence of a pair of events energy information i is always site specific font et al 2020 an important trait from a cultural standpoint in general when the i of balanced agroecosystem decrease information has been lost or transferred from the site specific traditional agroecological knowledge possessed by farmers and located at the landscape level towards higher hierarchical scales i e big corporations that produce and sold the seeds fertilizers herbicides and pesticides to industrial farmers some important parts of agroecosystem functioning are thus no longer controlled at landscape level but linked to increasingly globalised agri food chains tello and gonzález de molina 2017 we used a shannon wiener index for a metric of i adapted to be applied over each pair of βi so that this indicator will show whether the βi pairs are evenly distributed or not this metric accounts for the balance of pairwise energy flows that exit from each node in every sub process eq 2 2 i 1 6 i 1 12 β i log 2 β i γ f γ l α f α l γ f u b n p p h 2 u b n p p h f w γ l l s l f p 2 l s l f p l w α f f e i r 2 f e i r f e i n r α l l s l f p 2 l e i r l e i n r base 2 logarithms are applied as the probability is dichotomous the introduction of the information loss coefficients γ f γ l ensures that i values remain lower than 1 when the agroecosystem presents farm and or livestock waste we have also introduced the coefficients α f α l as a penalization for the use of non renewable external inputs which entail an internal information loss given that the agroecosystem functioning is no longer self reproductive i values close to 1 have an equal distribution of incoming and outgoing energy flows where the information message embedded in the agroecosystem structure is high on the other hand i values close to 0 indicate probability patterns that are far from equally distributed containing and providing less information these lower i values correspond to disintegrated agroecosystems with either low site specific information which may be related to an industrialised farm system or conversely to an almost natural turnover with no external inputs and no harvests conversely agroecosystems where i 1 have equally well distributed incoming and outgoing energy flows in each interlinked sub process which probably correspond to mixed farming systems where external inputs are balanced with the local energy recirculation therefore e measures the energy reinvested and temporarily stored in the agroecosystem and i assesses how farmers redistribute this energy in the land matrix needless to say the more complex i e internally differentiated and interlinked an agroecosystem is the greater the farming information required to manage it 2 2 3 measuring energy imprint through the landscape structure l to assess the energy imprinted in the landscape we use l a metrics of landscape heterogeneity that indicates the capacity of differentiated landscape mosaics to offer a range of habitats that sustain biodiversity loreau et al 2010 the underlying assumption is that species richness associated with agricultural landscapes depends on the landscape heterogeneity of land covers measured at scales larger than plot and farm scale eq 3 3 l i 1 k p i log k 1 p i where k is the number of different land covers potential habitats in each case and there are k 1 possible land covers in each unit of analysis we consider that the existence of urban land cover results in a loss of potential habitats thus p i is the proportion of land covers i in every unit of analysis these l values can be seen as a proxy for guaranteeing farm associated biodiversity whereby species whose populations are disturbed by agriculture can find safe haunts nearby by activating their own dispersal abilities the more diverse the vegetated land cover of an agroecological landscape the more likely it is to be able to withstand discontinuous disturbances through dispersion towards less disturbed or undisturbed spaces in the landscape 2 2 4 measuring the energy landscape integrated analysis elia after having defined the three elia indicators e i and l we can analyse their relationship we surmise that the interplay between e and i will jointly lead to complexity understood as a balanced level of intermediate self organisation we assume that an agroecosystem s complexity of energy flows e i is related to the most diverse landscapes where the ecological patterns and processes that sustain farm associated biodiversity are stronger therefore the elia index that combines the agroecological landscape functional structure with the complexity of the interlinking pattern of energy flows and can be taken as a proxy for the agroecosystem s biodiversity marull et al 2019a eq 4 4 e l i a e i l m a x e i a 1 3 where e is the energy storage i the information carried by the network structure of energy flows and l the diversity of land covers viewed as the energy imprint on the landscape structure the equilibrated m a x e i e 0 6169 k i 1 3 implies subsystem equilibrium and no waste when there is no such equilibrium the absolute m a x e i a 0 7420 k i 1 and even though this last combination is unlikely in an agroecosystem it is possible in a theoretical mathematic case hence elia theoretically ranges from 0 to 1 for any value of the parameters considered in order to understand the relationship between the stored energy e the information it contains i and its impact on the landscape l we should consider a three dimensional model fig 3c see a 3d video in supplementary material that can be interpreted in the sense that it is culture the site specific knowledge passed down from generation to generation combined with knowledge of opportunities originating from outside the farm system what allows farmers to manage the energy entering the agroecosystem in order to meet their needs and societal goals while ensuring the reproduction of its living funds in a healthy state the socio metabolic analysis is based on the bmr s energy flow fund approach to agroecosystems tello et al 2016 and uses data from the spanish ministry of agriculture and the catalan institute of statistics cattaneoet al 2018 the landscape composition and configuration was calculated using the 2009 land cover map of catalonia www creaf uab es mcsc 2 3 species studied birds and butterflies are recognized as excellent biodiversity indicators in both natural and human modified landscapes their use as bioindicators comes from the variability between species and their ability to respond quickly to environmental changes such as agricultural intensification and land abandonment santos et al 2008 melero et al 2016 stefanescu et al 2010 vallecillo et al 2008 we used butterfly data generated by the catalan butterfly monitoring scheme cbms http www catalanbms org a project that has been running for the past 25 years the survey consists of a network of sites where visual counts of adult butterflies along transects fig 2 are undertaken by volunteers at each site butterfly surveys are performed weekly during the flight period of the imagoes march september along lineal transects of ca 700 2500 m in length mean and median length 1715 and 2010 m respectively 5 m in width each transect is divided into smaller sections according to the dominant habitat type giving 6 14 sections per transect the number of individuals i e observations are then recorded per species in each section and then summarized per transect we used 91 butterfly transects from the cbms 2009 in the case of birds we obtained data from the catalan common bird monitoring scheme socc www giraffa co ico catalan ornithological institute transects consist of a 3 km walk with six sections of 500 m along which observers record all birds seen and heard and then summarize data per transect fig 2 two censuses are performed annually for breeding species april may and may june and two for wintering species december and january we used 23 bird transects from the bmr 2009 2 4 landscape factors a land cover map of the bmr 2009 was used to evaluate the landscape structure in both butterfly and bird transects these biodiversity databases consist of 91 bird transects linear buffer 500 m and 23 butterfly transects circular buffer 750 m in these buffers fig 2 a set of landscape metrics of landscape composition and configuration were obtained using gis arcgis methods for landscape composition we calculated the proportion of main land cover categories forest scrubland cropland and built up per buffer while for landscape configuration marull et al 2019 we used the land heterogeneity i e land cover diversity edge density i e the sum of edge length divided by buffer area polygon density i e the amount of patches per buffer area the largest patch index i e the area percentage of the largest patch in the buffer effective mesh size a defragmentation measure proposed by jaeger 2000 and finally the ecological connectivity inferred from the ecological connectivity index proposed by marull and mallarach 2005 2 5 statistical analyses as a test of elia using biodiversity data components we used the observed abundance i e total number of butterfly observations and species richness of butterflies and birds along the study transects despite species richness and abundance are often considered weakly related with ecosystem function we have preferred using them because of their simplicity instead of other proxies e g redundancy or richness in functional groups that could need an ad hoc definition of these groups in order to disentangle the direct and indirect effects on biodiversity of i energy storage and distribution and ii landscape composition and configuration structural equation models sem were built for each of the studied biodiversity groups butterflies and breeding and wintering birds specific sem were performed for species richness and the abundance of all pooled butterfly species and in the case of birds separately for nesting and wintering species the sem took into account the direct effects of the three elia components e i l and their indirect effects reflected in landscape composition cm using land covers as variables and in landscape configuration cn using landscape metrics as variables in order to reduce the number and the redundancy of variables in the sem we performed a principal component analysis pca on cm and cn table 1 analyses were performed using the sem package in r fox et al 2016 3 results and discussion 3 1 testing the elia model against empirical biodiversity data our study provides evidence that the societal metabolic flows driven by farming imprint different landscapes l with agroecosystems which enhance or decrease populations and species richness of butterflies and birds depending on the interplay between energy storage and its distribution pattern e i the significant results of sem are summarized in figs 4 and 5 the complete data are given in tables s1 to s8 in the supplemental material the butterfly principal component analysis table 1 shows that the first factor is the land cover composition of the landscape cm1 43 9 of variance which obtains the highest loading for forest while the second cm2 35 5 has the greatest loading for cropland the first component of land metrics assessing landscape configuration through land metrics cn1 72 4 has negative loadings for diversity and fragmentation but positive loadings for grain size and connectivity while the second component is more heterogeneous and contributes much less to explaining the variance cn2 12 2 despite being mostly associated with connectivity metrics including effective mesh size the sem results fig 4 show that total butterfly observations tbob are positively associated to elia values species richness tbsr shows no significant correlation with this model elia is negatively associated with cm1 in the tbsr model but not in the tbob model in both models cm1 and cn1 were negatively associated the r2 for the endogenous variables of tbsr and tbob models were 0 316 and 0 266 respectively when disentangling the effects of elia components e i and l i has a positive association with both tbsr and tbob while e and l are only significant and positively associated with tbob landscape composition cm and configuration cn are not significantly associated with any biodiversity component although cm1 is negatively associated with elia values in both models and cm2 is negatively associated with i only in the tbob model the r2 for the endogenous variables of tbsr and tbob are 0 420 and 0 334 respectively in the bird principal component analysis the first factor of landscape composition cm1 39 3 of variance has the highest loading for forest while the second factor cm2 31 8 has the greatest loadings for scrubland and cropland table 1 the first factor of landscape configuration cn1 53 6 has higher negative loadings for landscape diversity and fragmentation while the second cn2 27 3 has greater positive association for ecological connectivity and effective mesh size the sem results fig 5 show that breeding bird species richness bbsr and wintering bird species richness wbsr are positively related to elia values and cm2 but negatively related to cn2 elia is negatively related to cn1 in both models but only to cm1 in the bbsr model cn2 and cm1 are also negatively associated in this model the r2 for the endogenous variables of bbsr and wbsr are 0 244 and 0 210 respectively if we disentangle the effects of elia components e i and l i and e are positively and negatively correlated respectively to both bbsr and wbsr l is only associated negatively with wbsr e is negatively associated with cm2 in both models and with cm1 only in the bbsr model l and cm1 are negatively associated in this last model the r2 for the endogenous variables of bbsr and wbsr are 0 321 and 0 329 respectively 3 2 comparing elia results with margalef s hypothesis we checked margalef s hypothesis regarding the capacity of biocultural landscape mosaics resulting from a complex distribution of external energy flows of farming to host high biodiversity by comparing the links present within the spatial energy information structure with the species richness of butterflies and bird populations in the barcelona metropolitan region margalef 1991 marull et al 2018 2019a the results obtained suggest that agroecosystems could play a key role in halting the serious decline of butterfly populations in europe van swaay et al 2012 a finding that can also be taken as proxy for many other current biodiversity threats thomas 2005 the importance of the energy redistribution i to structure landscape mosaics carried out by farmers coincides with recent research highlighting the worrying decline of common bird populations in european biocultural landscapes which is related to the abandonment of age old land use patterns in human configured agroecosystems inger et al 2015 the energy landscape integrated analysis should be an efficient predictor of butterfly and bird locations in the studied human transformed landscapes indeed elia can better predict these biodiversity locations than if only landscape composition or configuration metrics are taken into account recent studies in the area have evidenced a parallel decline in species richness and functional diversity of butterfly and bird species in human transformed landscapes sol et al 2020 pla narbona et al 2022 the results suggest that farmers uneven spatial distribution of the biomass energy flows i in agroecosystems could be the key factor explaining not only butterfly observations and species richness but also breeding species richness and wintering bird species richness this is an important outcome that points to the role farmers knowledge plays in the design of the ecological functionality of biocultural landscapes through a subtle human nature relationship marull et al 2019a it also confirms the hypothesis that the interplay between the energy reinvested e and redistributed i by farmers affects the landscape functional structure l and its associated biodiversity via the harnessing of biomass flows that loop within these human transformed landscapes the analytical advances and positive empirical results obtained mean that the usual methodology of energy flow analysis of social metabolism and classical landscape ecology metrics need to be adapted enlarged and integrated to account for the complex cyclical character of human driven land use changes in biocultural landscapes traditional farm systems with a solar based metabolism tended to organise their land usages according to different gradients of spatiotemporal intensity thereby ensuring an integrated management of different land patches given that their whole subsistence depended on the endurance of that very landscape functional structure marull et al 2019a in order to offset the energy lost in the inefficient human exploitation of animal bioconversion on which farmers once had to rely to obtain traction and manure past organic farmers guaranteed that livestock breeding was carefully integrated into their use of cropland pastureland and forestland cattaneoet al 2018 while traditional organic farm management schemes with closed energy cycles in complex agroecosystems led to landscape mosaics that allowed a land sharing strategy for biological conservation tscharntke et al 2012 the agro industrial farm systems that rely on external flows of inputs from underground fossil fuels now enable society to overcome the traditional energy dependency on bioconverters schaffartzik et al 2014 as a result integrated land use management became redundant and the overcoming of this necessity led to the loss of its agroecological virtues i e its reproduction of the landscape living fund components nowadays biodiversity conservation in land matrices mostly occupied by biocultural landscapes cannot be guaranteed merely through the protection of nature protected areas land sparing to compensate for the ever more intensive industrial agriculture it requires rather an improvement of the ecological connectivity and functionality of the whole land matrix by recovering and enhancing agroecological landscape mosaics land sharing this also means agroecosystems functioning at landscape level need to be scaled up to cope with and offset the land cost of sustainability guzmán and gonzález de molina 2009 given that the relationship between energetic and biological processes that influence species richness may be due to the intermediate disturbance that characterizes biocultural landscape the integration between social metabolism and landscape ecology approaches will be crucial in future developments of sustainable land use planning 4 conclusion the environmental change caused worldwide by the decoupling of energy flows and land uses makes it increasingly urgent that societies recover their former landscape efficiency marull et al 2010 depending on the energy storage distribution e i and how these energy flows are imprinted on the landscape l agroecosystems either enhance or decrease biodiversity marull et al 2019a since the lack of an integrated management of energy flows and land uses is inherent to the current global socioecological crisis its recovery is crucial for sustainable human transformed landscapes as margalef suggested margalef 1991 the patterns of energy distribution shaped by farmers knowledge i e the distribution of energy flows according to an aim and labour i e the energy investments needed to maintain an agroecosystem s funds over time are determinant for understanding the locations of bird and butterfly species richness and abundance in mediterranean biocultural landscapes the landscape scale is crucial for managing the challenge of increasing agricultural production while improving the state of the environment via a climate smart and resilient farming transition neither agroecological intensification nor the application of a circular economy to agriculture will be possible without a rearrangement of the landscape complexity that can close their main biophysical cycles and improve their ecoefficiency this innovative line of research aims to contribute to the economic and environmental viability of scaling up organic agriculture and agriculture in general this can become possible if we learn to use the sustainable design of human transformed landscapes to close socio metabolic cycles reduce our dependence on non renewable external inputs and improve ecological processes in order to maintain biodiversity authors contributions j m designed the research and analysed the data j m j p y m and e t wrote the paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been supported by the ma4sure project mediterranean agroecosystems for sustainability and resilience under climate change funded by the european commission prima pci2021 121943 and the agroecoland project agroecological history for designing sustainable landscapes case studies from the mediterranean world funded by the spanish ministry of science and innovation pid2021 123129nb c43 we would like to thank the volunteers that participate in the bird cbbs and butterfly cbms monitoring schemes in catalonia the cbbs and cbms are funded by the catalan government and are run by the catalan ornithological institute and the granollers museum of natural sciences respectively supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110257 appendix supplementary materials image application 1 image application 2 
24283,according to classical ecological theory biodiversity at ecosystem scale can be viewed as the direct product of landscape complexity and information and the inverse product of energy dissipation the main difference between natural ecosystems and agroecosystems is the external energy driven by farmers hence it could be argued that biodiversity in biocultural landscapes can be explained by an energy information structure model we developed an energy landscape integrated analysis elia to predict biodiversity levels in human transformed landscapes elia combines the energy flow accounting in agricultural landscapes from abioeconomic point of view and landscape ecological metrics that assess the functional structure of the land cover it uses indicators to assess the energy stored in internal loops e and the information incorporated into the energy network i to establish a correlation with the resulting patterns and processes in biocultural landscapes l we tested the model on biodiversity data using butterflies and birds the results showed positive correlations between butterfly and bird species richness and elia and above all between i and elia this emphasizes how different strategies of agricultural management combined with nature conservation can be employed at certain optimal points in the relationship between the energy information structure of biocultural landscapes and the biodiversity present therein elia modelling is the key to a new research agenda that will be very useful for designing more sustainable agroecosystems metropolitan green infrastructures and land use policies in line with the forthcoming agroecology transition planned by the european commission and the food and agriculture organization keywords agroecosystem complexity social metabolism disturbance ecology biocultural landscapes species richness biodiversity conservation data availability data will be made available on request 1 introduction for centuries global human driven land use and cover change lucc has stimulated the spread of human modified habitats in many regions including the mediterranean thereby affecting biodiversity and ecosystem functioning in human transformed landscapes grove and rackham 2001 its impact has been manifold and created a very different landscape from the mosaics of the past today we see the results of organic mixed farming adapted to site specific natural conditions land cover homogenization driven by industrial farming the use of animal feed based on fossil fuels and spontaneous reforestation causing rural abandonment giampietro et al 2013 sterling and ducharne 2008 ellis et al 2008 the effects of lucc on biodiversity are already well known newbold et al 2005 ipbes 2019 and include a general decrease in species richness but also changes in species composition due to the rarefaction of habitat specialists and expansion of generalists and cosmopolitan species as well as invasions by alien species gonzález moreno et al 2013 gaertner et al 2017 facilitated by increasing propagule pressure and disturbance levels vilà and ibáñez 2011 basnou et al 2015 all these impacts lead to biotic homogenization in the most human transformed regions mckinney 2006 human transformed landscapes are today the outcome of a shifting interplay between the spatial patterns of land use types driven by the energy flows of human activity and their associated ecological processes haberl 2001 wrbka et al 2004 a widely acknowledged consensus in conservation biology known as the intermediate disturbance hypothesis cornell 1978 accepts that landscape heterogeneity is key to maintaining high biodiversity levels at intermediate disturbance levels through the interaction between on the one hand ecosystem patch diversity and on the other the ecological requirements that activate the dispersal abilities of species originating from less disturbed patches or allow colonization from the most disturbed ones perfecto and vandermeer 2010 loreau et al 2010 however the outcome also depends on the intensity and spatial distribution of the metabolic i e energy flows driven by society swift et al 2004 marull et al 2016b this recurrent interaction between landscape patterns and socioecological pressures has opened up a research field that investigates how the complexity of the energy flows driven by farming livestock rearing and forestry imprint diverse spatial patterns of human land uses that give rise either to heterogeneous or homogeneous landscapes able to house very different levels of biodiversity matthews and selman 2006 parrotta and trosper 2012 that can be addressed through a network perspective jordán 2022 the fundamentals of this research agenda can be found in morowitz s theorem that states that a flow of energy through a system is a necessary and sufficient condition for generating an organized albeit ephemeral structure morowitz 2002 the structures of living systems that emerge and evolve towards self reproducing complexity allow us to keep information organized and to transfer energy with greater efficiency away from thermodynamic equilibrium gladyshev 1999 this increase in internal complexity is achieved by exporting entropy to the environment since all living organisms are dissipative structures with multiple metabolic cycles embedded in a heterogeneous functional organization over space and time schrödinger 1944 this thermodynamic concept of organisms has close similarities to ecosystems functioning which is directly related to information complexity and inversely to entropy ho and ulanowicz 2005 when a living system becomes more complex it is also metabolically more efficient because it increases its internal information rather than its energy intake thereby also reducing entropy ulanowicz 2003 margalef 1958 1963 indicated that ecosystem succession tends to a decrease in the photosynthetic net primary production npp growth rate in other words energy combined with information increases diversity and does not produce greater uniformity similarly complex agroecosystems can store more energy and information at some points that reduce their internal entropy thanks to the exploitation of other spaces of less complexity that have larger npp rates many traditional mediterranean agroecosystems are the result of this type of balance between exploitation and conservation due to the spatial localization of different gradients of human intervention a wise intermediate disturbance pattern resulting in heterogeneous landscape mosaics gonzález bernáldez 1981 the combination of an energy flow pattern driven by complex information regarding how energy is redistributed across space is a good starting point for modelling human landscape relationships according to margalef 1991 the relationship between the external energy inputs and the dimensions that characterize the spatial patterns of its distribution gives rise to the functional structure of landscape mosaics able to host higher biodiversity than other homogeneous landscapes to test this hypothesis marull et al 2016a 2019b developed an energy landscape integrated analysis elia of agroecosystems that considers both the investment of energy stored within e and the information held in the whole network of socio metabolic energy flows i to correlate their interplay e i with the functional structure of the resulting biocultural landscape l this implies assessing whether the energy reinvested and redistributed by farming driven metabolic flows can lay the foundations for studying the linkages that exist between social metabolism landscape ecology and biodiversity which in the final instance will help generate resilient agroecosystems ho et al hu et al 2018 and sustainable land use policies padró et al 2020 testing margalef s hypothesis requires specifying and accounting for the ecological disturbance exerted by the information driven external energy that farmers incorporate into the landscape the human appropriation of net primary production hanpp is a quantitative estimate of the potential annual biological productivity reduced by human activities haberl et al 2007 krausmann et al 2013 it represents an initial approach to the interplay between anthropogenic disturbances and wildlife s ability to withstand them intermediate hanpp values are able to sustain greater biodiversity in human modified landscapes than higher ones that largely decrease habitat differentiation and negatively affect the provision of food chains free from human colonization barnes et al 2006 thus marull et al 2016a developed an intermediate disturbance complexity idc model to assess how different levels of anthropogenic disturbance at regional scale affect landscape functional structure results show a hump shaped relationship between landscape complexity free npp available for non domesticated species and biodiversity levels marull et al 2016a 2018 however it depends greatly not only on the overall flux balance of photosynthetic biomass but on the intensity and distribution of socio metabolic flows associated with either land use mosaics or homogeneous land covers in agroecosystems swift et al 2004 peterseil et al 2004 the elia modelling goes a step further than the previous idc explorations of the links between intermediate levels of socio metabolic human disturbance and the ecological functioning of biocultural landscapes carried out at regional scale marull et al 2018 it measures e as the proportion of energy remaining in the agroecosystem and i as the network of flows that allows farmers to reproduce the landscape l fund components due to the information embedded in the system according to the fund flow bioeconomic approach all biophysical flows that sustain societal metabolism are provided by living funds that to continue providing them they also need to be nourished and reproduced georgescu roegen 1971 this approach leads to a circular bioeconomic view that assesses the sustainability of socioecological systems in terms of the reproducibility of the living fund components within the biophysical structures of our societies in agroecosystems this means both the reproduction of living funds such as soil fertility which requires replenishment with organic matter and nutrients maeder et al 2002 and aboveground biodiversity which requires heterogeneous landscapes with sufficient npp free from human appropriation tscharntke et al 2012 the way in which these internal energy flows of agroecosystems recirculate and temporarily store energy within agroecosystem is by interlinking their living funds with each other through a set of bioconversions similar to how food chains in ecosystems do it we use this energy information structure model fig 1 to predict the locations of two important and particularly well known biodiversity components butterflies and birds in the human transformed landscapes here employed as empirical example the aim is to test margalef s hypothesis that the complex landscape mosaics of traditional organic agriculture were and continue to be good for biodiversity conservation margalef 1991 using butterfly and bird transects in the barcelona metropolitan region bmr we account for the association between landscape patterns composition and spatial configuration elia components e i l and biodiversity species richness and total observations after applying the elia model we use structural equation modelling sem to assess how social metabolism affects the capacity of metropolitan landscapes to host these indicators of biodiversity 2 materials and methods 2 1 study area covering 3200 km2 and with a population of 4 5 million the bmr is one of the most densely populated regions in europe fig 2 however this region still possesses several important natural and semi natural areas boasting considerable ecological diversity and valuable biocultural landscapes contrasting topography elevations ranging from 0 to 1700 m a s l and climate with ne sw gradients from moist to dry and from less to more continental afford it greater climatic and land cover variability than most mediterranean areas and are responsible for the great biodiversity present in this highly human transformed territory the region contains more than 40 habitat types of european interest according to 92 43 eu directive including natural forests scrublands and grasslands 60 of the region and semi natural habitats croplands 21 2 2 the energy landscape integrated analysis elia as explained elia is a spatially explicit model for an energy information landscape integrated analysis based on information theory applied to ecology marull et al 2016b it combines the landscape functional structure l with the interlinking pattern of energy flows driven by farming e and the information they contain i elia summarises both natural and cropland production in agroecosystems fig 3 through a combination of internal vertical axis matter energy flows derived from photosynthesis and external matter energy flows coming from human society through the farmers labour and knowledge left hand side of the horizontal axis these flows interact across the agroecosystem functioning and give rise to a final product consumed and dissipated by the human society as well right hand side of the horizontal axis the elia graph is the depiction of this socio metabolic biophysical interaction with nature in human transformed ecosystems accordingly the flows of energy carriers from the solar radiation photosynthetically converted into biomass i e the itinerary of the photosynthetic net primary production npp along the vertical axis interact with the flows farmers invest i e the itinerary of the external energy carriers moving along the horizontal axis all matter energy flows that arrive at a node split into two one incoming flow recirculates within the agroecosystem and another outgoing flow ends up in the agri food basket of consumable products delivered to society which in some cases is wasted the elia graph fig 3 resulting from this pairwise distribution of flows distinguishes between three main internal loops that characterize agroecosystem functioning 1 the most natural cycles e g forestry and livestock grazing on natural pastures which merely extract some of the npp the rest is left to internal recirculation without directly interfering with the reproductive natural cycling of these flows which end up decomposed as organic matter that temporarily accumulates energy in fertile soils where ecological turnover recommences 2 the cropland cycles which require a direct input of farmers labour through ploughing seeding weeding harvesting and fertilizing the soils where npp is reinitiated on arable land and 3 the livestock raising cycle through which a share of the previous biomass flows that circulate in loops 1 to 2 are diverted to feed farmers herds that in turn recirculate manure into cropland and pastureland while provisioning livestock products to the societal agri food chains the more linked the flows of matter and energy moving through these three cycles of a mixed farming the more complex and endowed with information the agroecosystem is the plant biomass obtained from ecosystem photosynthesis is the actual net primary production nppact i e the energy source for all the heterotrophs that live there the biomass included in the nppact that becomes available for heterotrophic species splits into unharvested biomass ub and the share of net primary production harvested by farmers npph fig 3 the ub generally remains in the same place as it was originally grown and can feed farm associated biodiversity it becomes a source of the agroecosystem total turnover att which closes the cycle of the natural subsystem this subsystem maintains the farm associated biodiversity and in turn the production of nppact again through the trophic net of non domesticated species either aboveground or in the edaphic decay processes of the soil npph splits into biomass reused br inside the agroecosystem and farmland final produce ffp that flows outside the system br is an important flow that remains within the agroecosystem thanks to the farmers investment aimed at directly or indirectly maintaining two basic funds livestock and soil fertility hence br closes the farmland subsystem circle then br is split into the share that goes to feed and bed domestic animals as livestock biomass reused lbr which can be added to the livestock total inputs lti and farmland biomass reused fbr in turn these flows add up to farmland total inputs fti as seeds green manure and other plant based fertilizers fig 3 these energy linkages in the graph enable us to see to what extent land use management is carried out by integrating or not the basic living funds of the agroecosystem finally domestic animals perform bioconversion and then the lbr flow splits into livestock final produce lfp and internal livestock services ls lfp includes a wide range of food and fibre products while ls services include driving force and animal manure together they make up livestock produce and services lps the farmland and livestock subsystems are partially closed within agroecosystems and offer a final produce fp that is consumed and dissipated outside and also receive external inputs ei therefore ub br and ls regulate the internal flows that lead to a higher or lower circularity in the pattern of energy networks in agroecosystems fig 3 they constitute important flows of recirculating biomass that contribute to the maintenance of the agroecosystem living funds that is associated biodiversity soil fertility and livestock conversely their weakening denotes an increase in the linearity and external dependence of the agroecosystem the circularity of matter energy flows is kept within the agroecosystem because the outputs of one subsystem serve as inputs for the next subsystem thereby allowing for the temporary storage of energy carriers and information within its dissipative structure interlinking their living funds through a set of energy bioconversions that said there is an exception to this rule that occurs when energy carriers circulating inside the agroecosystem due to farmers mismanagement are converted into a resource out of place i e waste we consider waste an energy flow that cannot be integrated into the structured recirculation of matter energy of the agroecosystems either because it exceeds their carrying capacity or because the way it is disposed of does not render it useful for neither keeping alive the agroecosystems funds nor to meet societal goals in some cases the monetary cost of certain biomass flows is larger than the benefits they generate and this can lead to misuse the result is a waste flow sometimes a fraction of nppact can be wasted such as crop stubble or tree pruning and are burnt rather than properly composted and used as fertilizer as it often occurred in past times when they were used as bedding straw home heating branches or animal feed leaves and green shots browsed the same may happen with a fraction of the lps generated by agro industrial feedlots whose excess is spread on cropland beyond its carrying capacity and eventually contaminates the water table a resource out of place if they exist farmland waste fw and livestock waste lw do not contribute to the renewal of the agroecosystem s funds they neither enhance its internal complexity nor meet human needs 2 2 1 measuring energy storage as a reinvestment of energy cycles e we understand agroecosystem complexity to be the differentiation of dissipative structures e g metabolic cycles that allows for a diversity of potential ranges in the system s behaviour the more complex the space time differentiation of these structures the more energy is stored within a living system hence higher mean values of even βi mean that agroecosystems are increasing in complexity because the different cycles are connected and the residence time of the stored energy increases thanks to a greater number of interlinked energy transformations circling within accordingly our way of calculating the energy stored and needed to keep the agroecosystem s funds functioning is as follows eq 1 1 e β 2 β 4 2 k 1 β 6 β 8 2 k 2 β 10 β 12 2 k 3 k 1 u b u b b r l s k 2 b r u b b r l s k 3 l s u b b r l s where the coefficients k 1 k 2 k 3 account for the share of reusing energy flows that are circulating through each of the three subsystems fig 3 which allows us to differentiate the agroecosystems fund composition and make their energy patterns comparable e remains within the range 0 1 an e close to 0 implies a low reuse of energy flows usually associated with industrial agroecosystems which are highly dissipative and dependant on external inputs an e close to 1 implies the existence of internal cycles only meaning land abandonment which is associated with the loss of biocultural landscapes or to a simple extractive use of the land i e foraging or hunting e assesses the amount of all the energy flows that are returned to the agroecosystem relative to the total amount of energy flowing across each one of the three subsystems if we pool the three subsystems together we are adopting a landscape agroecology standpoint focused on what happens with the energy carriers flowing across the different land units driven by farmers this allows us to link farming energy analysis with landscape ecology assessment 2 2 2 measuring information as the complexity of energy flow patterns i according to information theory applied in ecology hirata and ulanowicz 1984 grueber et al 2011 agroecosystems have a quantity of information embedded in their network structure that allows their reproduction to take place over time this information can be assessed through the graph complexity i e the degree to which energy flow is equally distributed across all edges and nodes of the graph or conversely is concentrated only on some edges and nodes an equal distribution of energy flows across the edges that link the nodes of a graph fig 1 means that the information carried cannot be known beforehand shannon and weaver 1949 therefore the information given by each event is the highest that can be transmitted by the channel considered in this case the agroecosystem to the farmers that manage them this type of information accounting can be seen as a measure of uncertainty or the degree of freedom for the system to behave and evolve it is called information message and registers the likelihood of the occurrence of a pair of events energy information i is always site specific font et al 2020 an important trait from a cultural standpoint in general when the i of balanced agroecosystem decrease information has been lost or transferred from the site specific traditional agroecological knowledge possessed by farmers and located at the landscape level towards higher hierarchical scales i e big corporations that produce and sold the seeds fertilizers herbicides and pesticides to industrial farmers some important parts of agroecosystem functioning are thus no longer controlled at landscape level but linked to increasingly globalised agri food chains tello and gonzález de molina 2017 we used a shannon wiener index for a metric of i adapted to be applied over each pair of βi so that this indicator will show whether the βi pairs are evenly distributed or not this metric accounts for the balance of pairwise energy flows that exit from each node in every sub process eq 2 2 i 1 6 i 1 12 β i log 2 β i γ f γ l α f α l γ f u b n p p h 2 u b n p p h f w γ l l s l f p 2 l s l f p l w α f f e i r 2 f e i r f e i n r α l l s l f p 2 l e i r l e i n r base 2 logarithms are applied as the probability is dichotomous the introduction of the information loss coefficients γ f γ l ensures that i values remain lower than 1 when the agroecosystem presents farm and or livestock waste we have also introduced the coefficients α f α l as a penalization for the use of non renewable external inputs which entail an internal information loss given that the agroecosystem functioning is no longer self reproductive i values close to 1 have an equal distribution of incoming and outgoing energy flows where the information message embedded in the agroecosystem structure is high on the other hand i values close to 0 indicate probability patterns that are far from equally distributed containing and providing less information these lower i values correspond to disintegrated agroecosystems with either low site specific information which may be related to an industrialised farm system or conversely to an almost natural turnover with no external inputs and no harvests conversely agroecosystems where i 1 have equally well distributed incoming and outgoing energy flows in each interlinked sub process which probably correspond to mixed farming systems where external inputs are balanced with the local energy recirculation therefore e measures the energy reinvested and temporarily stored in the agroecosystem and i assesses how farmers redistribute this energy in the land matrix needless to say the more complex i e internally differentiated and interlinked an agroecosystem is the greater the farming information required to manage it 2 2 3 measuring energy imprint through the landscape structure l to assess the energy imprinted in the landscape we use l a metrics of landscape heterogeneity that indicates the capacity of differentiated landscape mosaics to offer a range of habitats that sustain biodiversity loreau et al 2010 the underlying assumption is that species richness associated with agricultural landscapes depends on the landscape heterogeneity of land covers measured at scales larger than plot and farm scale eq 3 3 l i 1 k p i log k 1 p i where k is the number of different land covers potential habitats in each case and there are k 1 possible land covers in each unit of analysis we consider that the existence of urban land cover results in a loss of potential habitats thus p i is the proportion of land covers i in every unit of analysis these l values can be seen as a proxy for guaranteeing farm associated biodiversity whereby species whose populations are disturbed by agriculture can find safe haunts nearby by activating their own dispersal abilities the more diverse the vegetated land cover of an agroecological landscape the more likely it is to be able to withstand discontinuous disturbances through dispersion towards less disturbed or undisturbed spaces in the landscape 2 2 4 measuring the energy landscape integrated analysis elia after having defined the three elia indicators e i and l we can analyse their relationship we surmise that the interplay between e and i will jointly lead to complexity understood as a balanced level of intermediate self organisation we assume that an agroecosystem s complexity of energy flows e i is related to the most diverse landscapes where the ecological patterns and processes that sustain farm associated biodiversity are stronger therefore the elia index that combines the agroecological landscape functional structure with the complexity of the interlinking pattern of energy flows and can be taken as a proxy for the agroecosystem s biodiversity marull et al 2019a eq 4 4 e l i a e i l m a x e i a 1 3 where e is the energy storage i the information carried by the network structure of energy flows and l the diversity of land covers viewed as the energy imprint on the landscape structure the equilibrated m a x e i e 0 6169 k i 1 3 implies subsystem equilibrium and no waste when there is no such equilibrium the absolute m a x e i a 0 7420 k i 1 and even though this last combination is unlikely in an agroecosystem it is possible in a theoretical mathematic case hence elia theoretically ranges from 0 to 1 for any value of the parameters considered in order to understand the relationship between the stored energy e the information it contains i and its impact on the landscape l we should consider a three dimensional model fig 3c see a 3d video in supplementary material that can be interpreted in the sense that it is culture the site specific knowledge passed down from generation to generation combined with knowledge of opportunities originating from outside the farm system what allows farmers to manage the energy entering the agroecosystem in order to meet their needs and societal goals while ensuring the reproduction of its living funds in a healthy state the socio metabolic analysis is based on the bmr s energy flow fund approach to agroecosystems tello et al 2016 and uses data from the spanish ministry of agriculture and the catalan institute of statistics cattaneoet al 2018 the landscape composition and configuration was calculated using the 2009 land cover map of catalonia www creaf uab es mcsc 2 3 species studied birds and butterflies are recognized as excellent biodiversity indicators in both natural and human modified landscapes their use as bioindicators comes from the variability between species and their ability to respond quickly to environmental changes such as agricultural intensification and land abandonment santos et al 2008 melero et al 2016 stefanescu et al 2010 vallecillo et al 2008 we used butterfly data generated by the catalan butterfly monitoring scheme cbms http www catalanbms org a project that has been running for the past 25 years the survey consists of a network of sites where visual counts of adult butterflies along transects fig 2 are undertaken by volunteers at each site butterfly surveys are performed weekly during the flight period of the imagoes march september along lineal transects of ca 700 2500 m in length mean and median length 1715 and 2010 m respectively 5 m in width each transect is divided into smaller sections according to the dominant habitat type giving 6 14 sections per transect the number of individuals i e observations are then recorded per species in each section and then summarized per transect we used 91 butterfly transects from the cbms 2009 in the case of birds we obtained data from the catalan common bird monitoring scheme socc www giraffa co ico catalan ornithological institute transects consist of a 3 km walk with six sections of 500 m along which observers record all birds seen and heard and then summarize data per transect fig 2 two censuses are performed annually for breeding species april may and may june and two for wintering species december and january we used 23 bird transects from the bmr 2009 2 4 landscape factors a land cover map of the bmr 2009 was used to evaluate the landscape structure in both butterfly and bird transects these biodiversity databases consist of 91 bird transects linear buffer 500 m and 23 butterfly transects circular buffer 750 m in these buffers fig 2 a set of landscape metrics of landscape composition and configuration were obtained using gis arcgis methods for landscape composition we calculated the proportion of main land cover categories forest scrubland cropland and built up per buffer while for landscape configuration marull et al 2019 we used the land heterogeneity i e land cover diversity edge density i e the sum of edge length divided by buffer area polygon density i e the amount of patches per buffer area the largest patch index i e the area percentage of the largest patch in the buffer effective mesh size a defragmentation measure proposed by jaeger 2000 and finally the ecological connectivity inferred from the ecological connectivity index proposed by marull and mallarach 2005 2 5 statistical analyses as a test of elia using biodiversity data components we used the observed abundance i e total number of butterfly observations and species richness of butterflies and birds along the study transects despite species richness and abundance are often considered weakly related with ecosystem function we have preferred using them because of their simplicity instead of other proxies e g redundancy or richness in functional groups that could need an ad hoc definition of these groups in order to disentangle the direct and indirect effects on biodiversity of i energy storage and distribution and ii landscape composition and configuration structural equation models sem were built for each of the studied biodiversity groups butterflies and breeding and wintering birds specific sem were performed for species richness and the abundance of all pooled butterfly species and in the case of birds separately for nesting and wintering species the sem took into account the direct effects of the three elia components e i l and their indirect effects reflected in landscape composition cm using land covers as variables and in landscape configuration cn using landscape metrics as variables in order to reduce the number and the redundancy of variables in the sem we performed a principal component analysis pca on cm and cn table 1 analyses were performed using the sem package in r fox et al 2016 3 results and discussion 3 1 testing the elia model against empirical biodiversity data our study provides evidence that the societal metabolic flows driven by farming imprint different landscapes l with agroecosystems which enhance or decrease populations and species richness of butterflies and birds depending on the interplay between energy storage and its distribution pattern e i the significant results of sem are summarized in figs 4 and 5 the complete data are given in tables s1 to s8 in the supplemental material the butterfly principal component analysis table 1 shows that the first factor is the land cover composition of the landscape cm1 43 9 of variance which obtains the highest loading for forest while the second cm2 35 5 has the greatest loading for cropland the first component of land metrics assessing landscape configuration through land metrics cn1 72 4 has negative loadings for diversity and fragmentation but positive loadings for grain size and connectivity while the second component is more heterogeneous and contributes much less to explaining the variance cn2 12 2 despite being mostly associated with connectivity metrics including effective mesh size the sem results fig 4 show that total butterfly observations tbob are positively associated to elia values species richness tbsr shows no significant correlation with this model elia is negatively associated with cm1 in the tbsr model but not in the tbob model in both models cm1 and cn1 were negatively associated the r2 for the endogenous variables of tbsr and tbob models were 0 316 and 0 266 respectively when disentangling the effects of elia components e i and l i has a positive association with both tbsr and tbob while e and l are only significant and positively associated with tbob landscape composition cm and configuration cn are not significantly associated with any biodiversity component although cm1 is negatively associated with elia values in both models and cm2 is negatively associated with i only in the tbob model the r2 for the endogenous variables of tbsr and tbob are 0 420 and 0 334 respectively in the bird principal component analysis the first factor of landscape composition cm1 39 3 of variance has the highest loading for forest while the second factor cm2 31 8 has the greatest loadings for scrubland and cropland table 1 the first factor of landscape configuration cn1 53 6 has higher negative loadings for landscape diversity and fragmentation while the second cn2 27 3 has greater positive association for ecological connectivity and effective mesh size the sem results fig 5 show that breeding bird species richness bbsr and wintering bird species richness wbsr are positively related to elia values and cm2 but negatively related to cn2 elia is negatively related to cn1 in both models but only to cm1 in the bbsr model cn2 and cm1 are also negatively associated in this model the r2 for the endogenous variables of bbsr and wbsr are 0 244 and 0 210 respectively if we disentangle the effects of elia components e i and l i and e are positively and negatively correlated respectively to both bbsr and wbsr l is only associated negatively with wbsr e is negatively associated with cm2 in both models and with cm1 only in the bbsr model l and cm1 are negatively associated in this last model the r2 for the endogenous variables of bbsr and wbsr are 0 321 and 0 329 respectively 3 2 comparing elia results with margalef s hypothesis we checked margalef s hypothesis regarding the capacity of biocultural landscape mosaics resulting from a complex distribution of external energy flows of farming to host high biodiversity by comparing the links present within the spatial energy information structure with the species richness of butterflies and bird populations in the barcelona metropolitan region margalef 1991 marull et al 2018 2019a the results obtained suggest that agroecosystems could play a key role in halting the serious decline of butterfly populations in europe van swaay et al 2012 a finding that can also be taken as proxy for many other current biodiversity threats thomas 2005 the importance of the energy redistribution i to structure landscape mosaics carried out by farmers coincides with recent research highlighting the worrying decline of common bird populations in european biocultural landscapes which is related to the abandonment of age old land use patterns in human configured agroecosystems inger et al 2015 the energy landscape integrated analysis should be an efficient predictor of butterfly and bird locations in the studied human transformed landscapes indeed elia can better predict these biodiversity locations than if only landscape composition or configuration metrics are taken into account recent studies in the area have evidenced a parallel decline in species richness and functional diversity of butterfly and bird species in human transformed landscapes sol et al 2020 pla narbona et al 2022 the results suggest that farmers uneven spatial distribution of the biomass energy flows i in agroecosystems could be the key factor explaining not only butterfly observations and species richness but also breeding species richness and wintering bird species richness this is an important outcome that points to the role farmers knowledge plays in the design of the ecological functionality of biocultural landscapes through a subtle human nature relationship marull et al 2019a it also confirms the hypothesis that the interplay between the energy reinvested e and redistributed i by farmers affects the landscape functional structure l and its associated biodiversity via the harnessing of biomass flows that loop within these human transformed landscapes the analytical advances and positive empirical results obtained mean that the usual methodology of energy flow analysis of social metabolism and classical landscape ecology metrics need to be adapted enlarged and integrated to account for the complex cyclical character of human driven land use changes in biocultural landscapes traditional farm systems with a solar based metabolism tended to organise their land usages according to different gradients of spatiotemporal intensity thereby ensuring an integrated management of different land patches given that their whole subsistence depended on the endurance of that very landscape functional structure marull et al 2019a in order to offset the energy lost in the inefficient human exploitation of animal bioconversion on which farmers once had to rely to obtain traction and manure past organic farmers guaranteed that livestock breeding was carefully integrated into their use of cropland pastureland and forestland cattaneoet al 2018 while traditional organic farm management schemes with closed energy cycles in complex agroecosystems led to landscape mosaics that allowed a land sharing strategy for biological conservation tscharntke et al 2012 the agro industrial farm systems that rely on external flows of inputs from underground fossil fuels now enable society to overcome the traditional energy dependency on bioconverters schaffartzik et al 2014 as a result integrated land use management became redundant and the overcoming of this necessity led to the loss of its agroecological virtues i e its reproduction of the landscape living fund components nowadays biodiversity conservation in land matrices mostly occupied by biocultural landscapes cannot be guaranteed merely through the protection of nature protected areas land sparing to compensate for the ever more intensive industrial agriculture it requires rather an improvement of the ecological connectivity and functionality of the whole land matrix by recovering and enhancing agroecological landscape mosaics land sharing this also means agroecosystems functioning at landscape level need to be scaled up to cope with and offset the land cost of sustainability guzmán and gonzález de molina 2009 given that the relationship between energetic and biological processes that influence species richness may be due to the intermediate disturbance that characterizes biocultural landscape the integration between social metabolism and landscape ecology approaches will be crucial in future developments of sustainable land use planning 4 conclusion the environmental change caused worldwide by the decoupling of energy flows and land uses makes it increasingly urgent that societies recover their former landscape efficiency marull et al 2010 depending on the energy storage distribution e i and how these energy flows are imprinted on the landscape l agroecosystems either enhance or decrease biodiversity marull et al 2019a since the lack of an integrated management of energy flows and land uses is inherent to the current global socioecological crisis its recovery is crucial for sustainable human transformed landscapes as margalef suggested margalef 1991 the patterns of energy distribution shaped by farmers knowledge i e the distribution of energy flows according to an aim and labour i e the energy investments needed to maintain an agroecosystem s funds over time are determinant for understanding the locations of bird and butterfly species richness and abundance in mediterranean biocultural landscapes the landscape scale is crucial for managing the challenge of increasing agricultural production while improving the state of the environment via a climate smart and resilient farming transition neither agroecological intensification nor the application of a circular economy to agriculture will be possible without a rearrangement of the landscape complexity that can close their main biophysical cycles and improve their ecoefficiency this innovative line of research aims to contribute to the economic and environmental viability of scaling up organic agriculture and agriculture in general this can become possible if we learn to use the sustainable design of human transformed landscapes to close socio metabolic cycles reduce our dependence on non renewable external inputs and improve ecological processes in order to maintain biodiversity authors contributions j m designed the research and analysed the data j m j p y m and e t wrote the paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been supported by the ma4sure project mediterranean agroecosystems for sustainability and resilience under climate change funded by the european commission prima pci2021 121943 and the agroecoland project agroecological history for designing sustainable landscapes case studies from the mediterranean world funded by the spanish ministry of science and innovation pid2021 123129nb c43 we would like to thank the volunteers that participate in the bird cbbs and butterfly cbms monitoring schemes in catalonia the cbbs and cbms are funded by the catalan government and are run by the catalan ornithological institute and the granollers museum of natural sciences respectively supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110257 appendix supplementary materials image application 1 image application 2 
24284,forest fires are the leading cause of deforestation in march april and may which are the three driest months of the year 89 of all forest fires in nepal are caused by humans due to its diverse topography climate and sociodemographic interactions the region is extremely vulnerable the study aimed to investigate and forecast the spatiotemporal pattern of forest fires using space time cube forecasting models and develop a tiger habitat suitability model based on space time hotspots trends environmental geomorphological and human components modis fire hazards data in vector point format from nasa s terra and aqua satellites between the years 2000 and 2020 were utilized as the primary dataset for this investigation fire hazards from 2000 to 2013 were utilized to analyze the spatiotemporal hot cold spots trend hotspot zone in 2d and 3d then fire hazards from 2014 to 2020 were forecasted and validated with raw datasets using the space time exponential smoothing and forest based forecasting models results indicate that almost 52 77 and 69 05 of the total tiger habitat area were respectively in hotspot and uptrend zones only 0 3 of the entire tiger habitat area was identified in a cold spot zone multi criteria evaluation mce suitability analysis estimated that the areas of mahakal and seti in the west and the top of mechi in the east were found to be moderately suitable for tiger habitat when compared to the exponential smoothing method 8 40 the forest based method produced a lower average inaccuracy of 8 29 with mean rmses of 0 43 and 0 31 respectively overall the study revealed a new era of technological spatiotemporal data utilization for fire hazard incidents which could be used to identify suitable or vulnerable locations through space time analysis and forecasting techniques graphical abstract image graphical abstract keywords forest fires spatiotemporal tiger habitat space time forecasting data availability data will be made available on request 1 introduction forests are the most common ecosystem on the planet accounting for 80 of all biomass kindermann et al 2008 in 1990 according to the food and agriculture organization s fao annual report on global forest resources the world s total forest cover was 4 13 million hectares however the amount had decreased by 3 to 3 999 million hectares through 2015 keenan et al 2015 forest fires are a huge concern across the globe and improved techniques and procedures are needed to minimize the spread of such fires eugenio et al 2016 natural events such as lightning dry weather volcanic eruptions falling rock s spark spontaneous combustion and human activities including burning careless littering careless tool usage or electrical transmission sparks are the primary natural sources of forest fires scott 2000 forest fires have both direct and indirect effects including deaths destruction of buildings and infrastructure and harm to human health kochi et al 2010 it destroys 400 000 hectares of land in nepal on a yearly basis bajracharya 2002 population growth and climate change are placing unprecedented pressure on vulnerable species such as the bengal tiger which is rare and mostly found in this region of the globe carter et al 2013 forest fires in nepal are one of the most threatening natural hazards whichtake place mainly in the late dry season matin et al 2017 the frequency and intensity of forest fires have grown since the implementation of new vegetation management policies in nepal the average number of inhabitants who died due to such incidents increased from 571 during 2002 04 to 1576 during 2010 2013 shrestha 2019 this indicates a significant increase in the annual mortality rate caused by forest fires nepal where rural inhabitants have historically relied on fire for their livelihoods is one of the significant fire related causes of forest loss nepal khanal and sharma 2018 ghimire bhujel and rijal 2014 tigers of the bengal subspecies thrive in nepal s lowlands tropical woods bajracharya 2002 the use of spatiotemporal earth observation data and models for fire monitoring hazard forecasting and risk mapping has become increasingly important when it comes to implementing an effective fire control strategy there are three primary components of spatiotemporal data space where time when and objects what peuquet 1994 which may be used to determine the hotspot zones of fire hazards and most endangered tiger habitats fire risk indicators are being mapped using geospatial models in several regions of the globe saglam et al 2008 many elements including vegetation terrain and closeness to human activity in forests are considered in these models to map fire intensity and burned area moderate resolution imaging spectroradiometer modis active fire hazard data has been frequently utilized chu and guo 2015 fire monitoring risk forecasting and risk mapping have all benefited significantly from the use of earth observation data and models in various places of the world fire risk indicators have been mapped using geospatial models adab kanniah and solaimani 2013 jaiswal et al 2002 mohammadi bavaghar and shabanian 2014 sağlam et al 2008 sivrikaya et al 2014 these models consider forest cover terrain and human activity in the area to provide a risk assessment fire severity and burned area maps chu and guo 2015 chu guo and takeda 2016 and risk assessment models have made extensive use of modis data akther and hassan 2011 chowdhury and hassan 2013 chowdhury and hassan 2015 parameters for these models such as surface temperature vegetation indices and moisture indices were generated using data collected by remote sensing aguado et al 2003 bisquert sánchez and caselles 2014 leblon 2005 leblon et al 2001 however there is a lack of adequate information regarding spatial and temporal characteristics of forest fires and areas vulnerable or suitable for tiger habitats in nepal space time fire hazard analysis combining modis data with various fire observation models can effectively address those problems to our knowledge a little research has been conducted to analyze and predict the spatiotemporal pattern of forest fire using space cube models although there have been some successful implementations are available for space cube analysis in various sectors kristensson et al 2007 li et al 2010 mo et al 2020 xu et al 2021 this study is the first ever step in analyzing the spatiotemporal pattern of forest fire and forecasting the pattern using two different models therefore the research aimed to investigate and forecast the spatiotemporal patterns of forest fire using space time cube models consequentlyit identified the suitable tiger conservation areas based on space time trend and hotspot data environmental geomorphological and human components 2 study area nepal is a nation in south asia located between the latitudes of 26 22 and 30 27 and the longitude of 80 12 theelevation of this area varies from 3 to 8776 meters showing undulated ground over the whole research area the nation contains around 147481 km2 of land with more than half of it being forested fig 1 almost every year a fire occurs in numerous times throughout the summer endangering tiger habitats 3 materials and methods the research is organized into three primary sections a space time fire hazard analysis b space time forecast and c building of a tiger habitat suitability model using space time hotspots trends environmental geomorphological and human components fig 2 national aeronautics and space administration nasa provides active fire products for the last 24 and 48 hours and for the last 7 days in shapefile kml wms and text file formats from the moderate resolution imaging spectroradiometer modis mcd14dl and visible infrared imaging radiometer suite viirs 375 m vnp14imgtdl nrt and vj114imgtdl nrt modis data from nasa s terra and aqua satellites dating from 2000 to 2020 was utilized in the study modis fire observations are conducted four times each day at 1030 and 2230 hrs on the terra and aqua satellites by analyzing the fire hazards data from 2000 to 2013 two different forecasting techniques were used to forecast the spatiotemporal fire hazard pattern from 2014 to 2020 and validated with raw datasets to map the suitability zones of tiger habitats information related to threatened species e g tiger was collected from international union for conservation of nature iucn aster global digital elevation map gdem at 30m resolution landcover and national park conservation areas data were collected from food and agriculture organization additional environmental dataset such as temperature wind and precipitation were downloaded from google earth engine the data sources and their weights utilized in suitability analysis is shown in table 1 3 1 space time analysis forecasting and validation space time cubes are three dimensional data structures known as netcdf network common data form that show both absolute position x y and absolute time z dimension at the same time each grid s points are tallied according to their own time fig 3 the end time aggregation approach was used to aggregate fire occurrences within 2 km distance interval fishnet grids with a 1 year absolute time step interval in arcgis pro software in order to generate the hotspot cubes the k nearest neighbor was set for conceptualization of spatial relationships this strategy is effective when the distribution of the data changes over the research region such that some features are located distant from all other features the neighborhood distance was set at 32 km esri 2022a after creating the space cube dataset two dimensional hot and cold spot trend and three dimensional visitation maps were generated to demonstrate the effect of fire threats following that the space cube netcdf file was used to construct emerging hotspots using k nearest neighbor conceptualize spatial relationship technique the holt winters exponential smoothing approach was used to forecast forest hazards which predicted the values at each location cube by decomposing the time series at each location cube into seasonal and trend components using exponential smoothing the holt winters technique stores a large number of historical values in order to make typical forecasting about future values exponential smoothing is the process of smoothing a time series using an exponentially weighted moving average ewma when it comes to forecasting trends in time series exponential smoothing is one of the most tried and tested techniques time series values that gradually trend and exhibit seasonal behavior where values follow a recurrent cyclical pattern over a specified number of time steps are the best candidates for this method in addition leo breiman s forest based forecast random forest technique was used to forecast the values of each location in a space time cube forest regression models contain minimal data related assumptions therefore they are applicable in a variety of settings when the data includes complicated patterns or seasons or when it varies in ways that do not reflect basic mathematical functions like polynomials exponential curves or sine waves they are more successful than conventional forecasting approaches esri 2022b finally the predicted models were validated with real world fire events from 2014 to 2020 for each year using a simple percentage of error technique the models generate root mean square error rmse values which were used to compare the effectiveness of the two models 3 2 tiger suitability modeling tiger habitat suitability was modeled based on multi criteria evaluation mce using suitability modeler from arcgis pro software the model included 9 influential environmental 2 geomorphological and 2 human variables the weights and ratings were adapted from matin et al 2017 and section 4 3 table 1 lists the weights and dataset sources used in the study the weights for the suitability modeler were modified by understanding the characteristics of forest fires with tiger habitats and local context temperature wind hotspots uptrends and woodlands in landcover have a positive relationship with fire events in contrast elevation has a negative relationship with fire events indicating that less distance to waterbodies high elevation and slope have a low potential for fire events it was assumed that the higher the tiger suitability including the preservation area and location of less settled area regions lower the fire vulnerability 4 results and discussions 4 1 spatiotemporal distribution a total of 28 323 amount of fire incidents were recorded from 2000 to 2013 the summer season march to june of nepal had the highest frequency of forest fires which were continuous from day 1 to day 30 fig 4 shows that the most frequent fire incidents occurred between the 10 march and 4 may with april being the most dangerous month each year the fire peak was higher during most of the day the study region experienced a fire hazard almost yearly with 4223 3151 2925 2647 and 2538 fire incidents were recorded in 2009 2012 2010 2008 and 2004 respectively fig 4 from 2000 to 2013 hot and cold spot trend analysis revealed the overall up trends and down trends areas in several confidence levels fig 5 a the pinkish color represents the increase in fire hazards over a 13 year period whereas the darkest pixel showed the highest pick of 7 77 of the total study area meanwhile the greenish colored pixel depicted areas where fire hazards were observed in the early 2020s but these locations were less frequent than before and the area was only 0 01 of the total area the space cube hotspot study suggests the different levels and types of hot and cold spots around the study site based on the spatiotemporal fire events almost 7 of nepal s total land area experienced oscillating hot spots and 0 7 of the total land area showed as the new hotspot primarily in the narayani and janakpur areas from 2000 to 2013 the cold spot covered nearly 3 60 of the total land area with no new cold spots discovered table 2 fig 5c depicts a 3 dimensional space cube map of a hotspot whereas the z score ranged from 2 to 2 during the study period the fires had substantially influenced the tiger habitat in the research area in 2011 it was estimated that 55 and 152 bengal tigers were detected in extant 2597 km2 and probably extant 9090 km2 areas respectively almost 52 77 and 69 05 of the total tiger habitat area were in hotspot and uptrend zones respectively only 0 3 of the entire tiger habitat area was identified as a cold spot zone table 3 4 2 suitability analysis of tiger habitats the link between variables related to forest fire and tiger conservation is depicted in fig 6 naturally hotspot and trend analysis revealed the highest and most positive correlation elevation distance to road settlement and water slope and precipitation all correlated negatively with fire hotspots indicating that low values impact forest fires particularly vulnerable to forest fires were areas with a lower elevation less proximity to a roads settlements and areas with less precipitation also the relationship between temperature and wind and forest fires is positive which means that when temperatures and winds go up there are more forest fires according to the suitability map in fig 7 by undertaking environmental geomorphological and human induced factors that influence fire hazard hotspot and trend information the dhaualagiri and gandaki regions may be the most promising tiger habitat because they contain the vast conservation and wildlife protected areas because the majority of the southern portion of nepal is covered by fire risk zones only 5 of the area was identified as the most suitable tiger conservation area even though the northern part of nepal has a medium to high elevation and a low to medium temperature range the northern part was identified as a more suitable zone than the south due to other risk parameters and a secure conservation environment the areas of mahakal and seti in the west and the top of mechi in the east were found to be moderately suitable for tiger habitat 4 3 spatiotemporal forecasting of fire hazards using the fire hazard space cube data from 2000 to 2013 two forecasting models such as exponential smoothing and forest based forecast were implied to predict the spatiotemporal fire hazard location from 2014 to 2020 fire incidents data from modis were obtained and evaluated using the spatiotemporal datasets of both forecasted models from 2014 to 2020 the average rmse for the exponential smoothing and forest based forecasting approaches were 0 43 and 0 31 respectively indicating that the forest based forecasting method performed better fig 8 table 4 describes the percentage of error of predicted models fire location data based on the observed modis fire data the forest based method produced a lower average inaccuracy of 8 29 when compared to the exponential smoothing method 8 40 table 4 fig 9 depicts the forecasted and recoded fire occurrences in dark red to identify the spatial link of the predicted models for 2020 based on the validation and rmse values the study recommended a forest based spatiotemporal space cube forecasting model for this type of research both forecasting models showed significant accuracies in terms of forecasting fire incidents in nepal the space time pattern mining toolbox of arcgis pro ushers in a new era of spatial temporal data interpretation visualization trend analysis and spatial temporal data forecasting although only two forecasting models were used in this study more forecasting models with different spatial distance and neighborhood settings can be used to forecast the spatiotemporal pattern of fire hazards 4 4 limitations and prospects the fundamental disadvantage of the preceding space cube strategy was that the space cube grids were generated at 1 year intervals with a random size of 2 km because trend and emerging hotspot analyses are subjective the random grid size and interval time duration may have an impact on the ultimate results the hotspot and trend cube produced a few statistical metrics such as p values average 0 172 and z values 1 92 which can be minimized via stepwise trails despite its shortcomings the proposed framework can integrate widely established and practical approaches into a single geodatabase repository it uses a contemporary approach to analysis mapping and clustering to enhance the forecasting of space time hazards and the modelling of spatially shifting links between fire occurrences their effect on tiger conservation areas and possible human environmental interactions the identification of geographically relatively high risk clusters is required for decision making and prioritizing of locations for immediate and or gradual actions via policy implications and this research serves as a crucial reference for this since forest fires can decimate vegetation and wildlife in a short amount of time they are among the most dangerous types of natural disasters effective measures provision through prevention and control become crucial proper logistical infrastructure and enough money to prevent and put out forest fires are needed to manage the fire efficiently and effectively therefore a thorough and detailed knowledge of the areas prone to the forest fire is needed to implement any management strategy for prevention and control sharma fernandes and pokharel 2015 by analyzing and predicting vulnerable and potential fire locations widespread strategies can be implemented in advance to mitigate and prevent the fire hazard risk not only for humans but also for species 5 conclusion the study compromises historical fire incidence data to examine the spatiotemporal patterns of forest fires in nepal whilst benefits of space cube geospatial technology in spatiotemporal analysis has recently become more apparent the advancement of gis and decision analytics tools necessitates a revisiting of typical in practice fire hazard assessment frameworks for robustness reliability and policy orientation using a variety of geospatial tools and space time pattern mining approaches the proposed methodology links fire dangers and tiger habitats data from space cube hotspots as well as human environment variables the predicted fire hazard maps can be helpful in distributing firefighting equipment to the highly vulnerable fire hazard zones these forecasting models may also be helpful to take action in advance where the fore fire can be occurred with the help of potential fire forecasted data a strategy for preventing and controlling catastrophic wildfires in high risk regions may be developed and revised the government may relocate the tigers to the most suitable regions for tiger habitats identified on the suitability map in this way the tigers may be shielded from the risks of a potential fire credit authorship contribution statement abdullah al faisal conceptualization methodology formal analysis writing original draft writing reviewing editing responding reviewers comments and proofreading abdulla al kafy methodology writing reviewing editing responding reviewers comments and proofreading farzana afroz writing reviewing editing and proofreading zullyadini a rahaman supervision editing and proofreading declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge modis icun fao and google earth engine for providing the free required dataset the authors are grateful to the university of southampton for providing study materials arcgis pro license training for the space time pattern mining toolbox and direction on how to conduct the research the experts at the dynamic institution of geospatial observation network digon provided a substantial contribution toward the improvement of the final manuscript and we are grateful to them 
24284,forest fires are the leading cause of deforestation in march april and may which are the three driest months of the year 89 of all forest fires in nepal are caused by humans due to its diverse topography climate and sociodemographic interactions the region is extremely vulnerable the study aimed to investigate and forecast the spatiotemporal pattern of forest fires using space time cube forecasting models and develop a tiger habitat suitability model based on space time hotspots trends environmental geomorphological and human components modis fire hazards data in vector point format from nasa s terra and aqua satellites between the years 2000 and 2020 were utilized as the primary dataset for this investigation fire hazards from 2000 to 2013 were utilized to analyze the spatiotemporal hot cold spots trend hotspot zone in 2d and 3d then fire hazards from 2014 to 2020 were forecasted and validated with raw datasets using the space time exponential smoothing and forest based forecasting models results indicate that almost 52 77 and 69 05 of the total tiger habitat area were respectively in hotspot and uptrend zones only 0 3 of the entire tiger habitat area was identified in a cold spot zone multi criteria evaluation mce suitability analysis estimated that the areas of mahakal and seti in the west and the top of mechi in the east were found to be moderately suitable for tiger habitat when compared to the exponential smoothing method 8 40 the forest based method produced a lower average inaccuracy of 8 29 with mean rmses of 0 43 and 0 31 respectively overall the study revealed a new era of technological spatiotemporal data utilization for fire hazard incidents which could be used to identify suitable or vulnerable locations through space time analysis and forecasting techniques graphical abstract image graphical abstract keywords forest fires spatiotemporal tiger habitat space time forecasting data availability data will be made available on request 1 introduction forests are the most common ecosystem on the planet accounting for 80 of all biomass kindermann et al 2008 in 1990 according to the food and agriculture organization s fao annual report on global forest resources the world s total forest cover was 4 13 million hectares however the amount had decreased by 3 to 3 999 million hectares through 2015 keenan et al 2015 forest fires are a huge concern across the globe and improved techniques and procedures are needed to minimize the spread of such fires eugenio et al 2016 natural events such as lightning dry weather volcanic eruptions falling rock s spark spontaneous combustion and human activities including burning careless littering careless tool usage or electrical transmission sparks are the primary natural sources of forest fires scott 2000 forest fires have both direct and indirect effects including deaths destruction of buildings and infrastructure and harm to human health kochi et al 2010 it destroys 400 000 hectares of land in nepal on a yearly basis bajracharya 2002 population growth and climate change are placing unprecedented pressure on vulnerable species such as the bengal tiger which is rare and mostly found in this region of the globe carter et al 2013 forest fires in nepal are one of the most threatening natural hazards whichtake place mainly in the late dry season matin et al 2017 the frequency and intensity of forest fires have grown since the implementation of new vegetation management policies in nepal the average number of inhabitants who died due to such incidents increased from 571 during 2002 04 to 1576 during 2010 2013 shrestha 2019 this indicates a significant increase in the annual mortality rate caused by forest fires nepal where rural inhabitants have historically relied on fire for their livelihoods is one of the significant fire related causes of forest loss nepal khanal and sharma 2018 ghimire bhujel and rijal 2014 tigers of the bengal subspecies thrive in nepal s lowlands tropical woods bajracharya 2002 the use of spatiotemporal earth observation data and models for fire monitoring hazard forecasting and risk mapping has become increasingly important when it comes to implementing an effective fire control strategy there are three primary components of spatiotemporal data space where time when and objects what peuquet 1994 which may be used to determine the hotspot zones of fire hazards and most endangered tiger habitats fire risk indicators are being mapped using geospatial models in several regions of the globe saglam et al 2008 many elements including vegetation terrain and closeness to human activity in forests are considered in these models to map fire intensity and burned area moderate resolution imaging spectroradiometer modis active fire hazard data has been frequently utilized chu and guo 2015 fire monitoring risk forecasting and risk mapping have all benefited significantly from the use of earth observation data and models in various places of the world fire risk indicators have been mapped using geospatial models adab kanniah and solaimani 2013 jaiswal et al 2002 mohammadi bavaghar and shabanian 2014 sağlam et al 2008 sivrikaya et al 2014 these models consider forest cover terrain and human activity in the area to provide a risk assessment fire severity and burned area maps chu and guo 2015 chu guo and takeda 2016 and risk assessment models have made extensive use of modis data akther and hassan 2011 chowdhury and hassan 2013 chowdhury and hassan 2015 parameters for these models such as surface temperature vegetation indices and moisture indices were generated using data collected by remote sensing aguado et al 2003 bisquert sánchez and caselles 2014 leblon 2005 leblon et al 2001 however there is a lack of adequate information regarding spatial and temporal characteristics of forest fires and areas vulnerable or suitable for tiger habitats in nepal space time fire hazard analysis combining modis data with various fire observation models can effectively address those problems to our knowledge a little research has been conducted to analyze and predict the spatiotemporal pattern of forest fire using space cube models although there have been some successful implementations are available for space cube analysis in various sectors kristensson et al 2007 li et al 2010 mo et al 2020 xu et al 2021 this study is the first ever step in analyzing the spatiotemporal pattern of forest fire and forecasting the pattern using two different models therefore the research aimed to investigate and forecast the spatiotemporal patterns of forest fire using space time cube models consequentlyit identified the suitable tiger conservation areas based on space time trend and hotspot data environmental geomorphological and human components 2 study area nepal is a nation in south asia located between the latitudes of 26 22 and 30 27 and the longitude of 80 12 theelevation of this area varies from 3 to 8776 meters showing undulated ground over the whole research area the nation contains around 147481 km2 of land with more than half of it being forested fig 1 almost every year a fire occurs in numerous times throughout the summer endangering tiger habitats 3 materials and methods the research is organized into three primary sections a space time fire hazard analysis b space time forecast and c building of a tiger habitat suitability model using space time hotspots trends environmental geomorphological and human components fig 2 national aeronautics and space administration nasa provides active fire products for the last 24 and 48 hours and for the last 7 days in shapefile kml wms and text file formats from the moderate resolution imaging spectroradiometer modis mcd14dl and visible infrared imaging radiometer suite viirs 375 m vnp14imgtdl nrt and vj114imgtdl nrt modis data from nasa s terra and aqua satellites dating from 2000 to 2020 was utilized in the study modis fire observations are conducted four times each day at 1030 and 2230 hrs on the terra and aqua satellites by analyzing the fire hazards data from 2000 to 2013 two different forecasting techniques were used to forecast the spatiotemporal fire hazard pattern from 2014 to 2020 and validated with raw datasets to map the suitability zones of tiger habitats information related to threatened species e g tiger was collected from international union for conservation of nature iucn aster global digital elevation map gdem at 30m resolution landcover and national park conservation areas data were collected from food and agriculture organization additional environmental dataset such as temperature wind and precipitation were downloaded from google earth engine the data sources and their weights utilized in suitability analysis is shown in table 1 3 1 space time analysis forecasting and validation space time cubes are three dimensional data structures known as netcdf network common data form that show both absolute position x y and absolute time z dimension at the same time each grid s points are tallied according to their own time fig 3 the end time aggregation approach was used to aggregate fire occurrences within 2 km distance interval fishnet grids with a 1 year absolute time step interval in arcgis pro software in order to generate the hotspot cubes the k nearest neighbor was set for conceptualization of spatial relationships this strategy is effective when the distribution of the data changes over the research region such that some features are located distant from all other features the neighborhood distance was set at 32 km esri 2022a after creating the space cube dataset two dimensional hot and cold spot trend and three dimensional visitation maps were generated to demonstrate the effect of fire threats following that the space cube netcdf file was used to construct emerging hotspots using k nearest neighbor conceptualize spatial relationship technique the holt winters exponential smoothing approach was used to forecast forest hazards which predicted the values at each location cube by decomposing the time series at each location cube into seasonal and trend components using exponential smoothing the holt winters technique stores a large number of historical values in order to make typical forecasting about future values exponential smoothing is the process of smoothing a time series using an exponentially weighted moving average ewma when it comes to forecasting trends in time series exponential smoothing is one of the most tried and tested techniques time series values that gradually trend and exhibit seasonal behavior where values follow a recurrent cyclical pattern over a specified number of time steps are the best candidates for this method in addition leo breiman s forest based forecast random forest technique was used to forecast the values of each location in a space time cube forest regression models contain minimal data related assumptions therefore they are applicable in a variety of settings when the data includes complicated patterns or seasons or when it varies in ways that do not reflect basic mathematical functions like polynomials exponential curves or sine waves they are more successful than conventional forecasting approaches esri 2022b finally the predicted models were validated with real world fire events from 2014 to 2020 for each year using a simple percentage of error technique the models generate root mean square error rmse values which were used to compare the effectiveness of the two models 3 2 tiger suitability modeling tiger habitat suitability was modeled based on multi criteria evaluation mce using suitability modeler from arcgis pro software the model included 9 influential environmental 2 geomorphological and 2 human variables the weights and ratings were adapted from matin et al 2017 and section 4 3 table 1 lists the weights and dataset sources used in the study the weights for the suitability modeler were modified by understanding the characteristics of forest fires with tiger habitats and local context temperature wind hotspots uptrends and woodlands in landcover have a positive relationship with fire events in contrast elevation has a negative relationship with fire events indicating that less distance to waterbodies high elevation and slope have a low potential for fire events it was assumed that the higher the tiger suitability including the preservation area and location of less settled area regions lower the fire vulnerability 4 results and discussions 4 1 spatiotemporal distribution a total of 28 323 amount of fire incidents were recorded from 2000 to 2013 the summer season march to june of nepal had the highest frequency of forest fires which were continuous from day 1 to day 30 fig 4 shows that the most frequent fire incidents occurred between the 10 march and 4 may with april being the most dangerous month each year the fire peak was higher during most of the day the study region experienced a fire hazard almost yearly with 4223 3151 2925 2647 and 2538 fire incidents were recorded in 2009 2012 2010 2008 and 2004 respectively fig 4 from 2000 to 2013 hot and cold spot trend analysis revealed the overall up trends and down trends areas in several confidence levels fig 5 a the pinkish color represents the increase in fire hazards over a 13 year period whereas the darkest pixel showed the highest pick of 7 77 of the total study area meanwhile the greenish colored pixel depicted areas where fire hazards were observed in the early 2020s but these locations were less frequent than before and the area was only 0 01 of the total area the space cube hotspot study suggests the different levels and types of hot and cold spots around the study site based on the spatiotemporal fire events almost 7 of nepal s total land area experienced oscillating hot spots and 0 7 of the total land area showed as the new hotspot primarily in the narayani and janakpur areas from 2000 to 2013 the cold spot covered nearly 3 60 of the total land area with no new cold spots discovered table 2 fig 5c depicts a 3 dimensional space cube map of a hotspot whereas the z score ranged from 2 to 2 during the study period the fires had substantially influenced the tiger habitat in the research area in 2011 it was estimated that 55 and 152 bengal tigers were detected in extant 2597 km2 and probably extant 9090 km2 areas respectively almost 52 77 and 69 05 of the total tiger habitat area were in hotspot and uptrend zones respectively only 0 3 of the entire tiger habitat area was identified as a cold spot zone table 3 4 2 suitability analysis of tiger habitats the link between variables related to forest fire and tiger conservation is depicted in fig 6 naturally hotspot and trend analysis revealed the highest and most positive correlation elevation distance to road settlement and water slope and precipitation all correlated negatively with fire hotspots indicating that low values impact forest fires particularly vulnerable to forest fires were areas with a lower elevation less proximity to a roads settlements and areas with less precipitation also the relationship between temperature and wind and forest fires is positive which means that when temperatures and winds go up there are more forest fires according to the suitability map in fig 7 by undertaking environmental geomorphological and human induced factors that influence fire hazard hotspot and trend information the dhaualagiri and gandaki regions may be the most promising tiger habitat because they contain the vast conservation and wildlife protected areas because the majority of the southern portion of nepal is covered by fire risk zones only 5 of the area was identified as the most suitable tiger conservation area even though the northern part of nepal has a medium to high elevation and a low to medium temperature range the northern part was identified as a more suitable zone than the south due to other risk parameters and a secure conservation environment the areas of mahakal and seti in the west and the top of mechi in the east were found to be moderately suitable for tiger habitat 4 3 spatiotemporal forecasting of fire hazards using the fire hazard space cube data from 2000 to 2013 two forecasting models such as exponential smoothing and forest based forecast were implied to predict the spatiotemporal fire hazard location from 2014 to 2020 fire incidents data from modis were obtained and evaluated using the spatiotemporal datasets of both forecasted models from 2014 to 2020 the average rmse for the exponential smoothing and forest based forecasting approaches were 0 43 and 0 31 respectively indicating that the forest based forecasting method performed better fig 8 table 4 describes the percentage of error of predicted models fire location data based on the observed modis fire data the forest based method produced a lower average inaccuracy of 8 29 when compared to the exponential smoothing method 8 40 table 4 fig 9 depicts the forecasted and recoded fire occurrences in dark red to identify the spatial link of the predicted models for 2020 based on the validation and rmse values the study recommended a forest based spatiotemporal space cube forecasting model for this type of research both forecasting models showed significant accuracies in terms of forecasting fire incidents in nepal the space time pattern mining toolbox of arcgis pro ushers in a new era of spatial temporal data interpretation visualization trend analysis and spatial temporal data forecasting although only two forecasting models were used in this study more forecasting models with different spatial distance and neighborhood settings can be used to forecast the spatiotemporal pattern of fire hazards 4 4 limitations and prospects the fundamental disadvantage of the preceding space cube strategy was that the space cube grids were generated at 1 year intervals with a random size of 2 km because trend and emerging hotspot analyses are subjective the random grid size and interval time duration may have an impact on the ultimate results the hotspot and trend cube produced a few statistical metrics such as p values average 0 172 and z values 1 92 which can be minimized via stepwise trails despite its shortcomings the proposed framework can integrate widely established and practical approaches into a single geodatabase repository it uses a contemporary approach to analysis mapping and clustering to enhance the forecasting of space time hazards and the modelling of spatially shifting links between fire occurrences their effect on tiger conservation areas and possible human environmental interactions the identification of geographically relatively high risk clusters is required for decision making and prioritizing of locations for immediate and or gradual actions via policy implications and this research serves as a crucial reference for this since forest fires can decimate vegetation and wildlife in a short amount of time they are among the most dangerous types of natural disasters effective measures provision through prevention and control become crucial proper logistical infrastructure and enough money to prevent and put out forest fires are needed to manage the fire efficiently and effectively therefore a thorough and detailed knowledge of the areas prone to the forest fire is needed to implement any management strategy for prevention and control sharma fernandes and pokharel 2015 by analyzing and predicting vulnerable and potential fire locations widespread strategies can be implemented in advance to mitigate and prevent the fire hazard risk not only for humans but also for species 5 conclusion the study compromises historical fire incidence data to examine the spatiotemporal patterns of forest fires in nepal whilst benefits of space cube geospatial technology in spatiotemporal analysis has recently become more apparent the advancement of gis and decision analytics tools necessitates a revisiting of typical in practice fire hazard assessment frameworks for robustness reliability and policy orientation using a variety of geospatial tools and space time pattern mining approaches the proposed methodology links fire dangers and tiger habitats data from space cube hotspots as well as human environment variables the predicted fire hazard maps can be helpful in distributing firefighting equipment to the highly vulnerable fire hazard zones these forecasting models may also be helpful to take action in advance where the fore fire can be occurred with the help of potential fire forecasted data a strategy for preventing and controlling catastrophic wildfires in high risk regions may be developed and revised the government may relocate the tigers to the most suitable regions for tiger habitats identified on the suitability map in this way the tigers may be shielded from the risks of a potential fire credit authorship contribution statement abdullah al faisal conceptualization methodology formal analysis writing original draft writing reviewing editing responding reviewers comments and proofreading abdulla al kafy methodology writing reviewing editing responding reviewers comments and proofreading farzana afroz writing reviewing editing and proofreading zullyadini a rahaman supervision editing and proofreading declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge modis icun fao and google earth engine for providing the free required dataset the authors are grateful to the university of southampton for providing study materials arcgis pro license training for the space time pattern mining toolbox and direction on how to conduct the research the experts at the dynamic institution of geospatial observation network digon provided a substantial contribution toward the improvement of the final manuscript and we are grateful to them 
