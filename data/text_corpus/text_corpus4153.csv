index,text
20765,free surface oscillations within a square harbor subjected to solitary waves are investigated through physical experiments the effects of various wave heights and water depths on the resonance within the harbor are examined in this study the technique of wavelet based bicoherence spectra is employed for the first time to investigate the nonlinear wave wave interaction of the transient harbor resonance induced by solitary waves the results show that the relation between the maximum surface elevation η max within the harbor and the incident wave height of a solitary wave can be regarded as approximately linear moreover for the same incident solitary wave height the larger the water depth is the greater the value of η max becomes the analyses of the wavelet based bicoherence indicate that the natural modes of the harbor are generated in the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components the first mechanism plays a decisive role in the generations of low order natural modes while the second mechanism also has a vital catalytic role in triggering higher order modes finally it is examined that the duration of harbor oscillations changes obviously with incident wave heights and water depths keywords harbor oscillations physical experiment solitary waves resonant modes wavelet based bicoherence spectrum nonlinear wave wave interaction 1 introduction free surface resonance inside a harbor occurs when the frequencies of external forces are close to the natural frequencies of the harbor which is referred to as harbor resonance or harbor oscillations rabinovich 2009 harbor resonance may cause berthing vessels to respond violently thereby interrupting the normal loading unloading operations of the ships inside the harbor even breaking mooring lines and causing collision accidents lee and xing 2009 mei 2018 harbor resonance resulting in economic losses has been observed in numerous harbors such as long beach harbor lee and xing 2009 hualien harbor maa et al 2011 pohang harbor kumar et al 2014 and hambantota port dong et al 2020b several external forces can trigger the harbor resonance phenomenon such as low frequency waves tsunamis earthquakes wave groups internal ocean waves tides or currents rabinovich 2009 according to many analyses of in situ measured data yoshida et al 2001 bellotti and franco 2011 lopez et al 2012 thotagamuwage and pattiaratchi 2014 dong et al 2020b the most common triggering factor of low intensity harbor oscillations is probably the incident low frequency waves which are mainly generated through nonlinear interaction of short wave groups chen et al 2006 gao et al 2019b here the low intensity harbor oscillations mainly affect the moored ship motions and lead to port operation downtime zheng et al 2020a moreover tsunamis are probably the main causative factor of destructive oscillations which result in extensive damage to ships and are a threat to human safety some events of destructive harbor oscillations induced by tsunamis can be found in the literature e g rabinovich 2009 the tsunamis generated by the 1964 alaska earthquake spread to crescent city harbor california and caused 11 deaths and economic losses of tens of millions of dollars magoon 1965 on june 15 2006 the oscillation inside the ciutadella harbor increased the wave height by up to 6 m resulting in economic losses amounting to tens of millions of euros monserrat et al 2006 the kuril islands earthquake on november 15 2006 also inflicted enormous losses on crescent city harbor lee and xing 2009 therefore to prevent or mitigate the significant adverse effects of destructive harbor oscillations on the safety of mooring ships and humans more investigations have been conducted in recent years to enhance the understanding of tsunami induced harbor oscillations gao et al 2019a rupali et al 2020b tsunamis are mainly generated by submarine earthquakes offshore landslides or undersea volcanic eruptions as tsunamis propagate into shallow water areas the wave height increases the wave crest becomes steeper and the trough becomes flatter the waveforms of such tsunamis are analogous to those of solitary waves solitary waves can reflect the characteristics of tsunamis in shallow waters to a certain extent liu et al 1995 li 2000 gao et al 2016 and numerous scholars have adopted solitary waves to represent tsunamis goring 1978 carried out physical experiments of solitary waves propagating over varied topographies to simulate tsunamis propagating from the deep sea to a continental shelf trough lin et al 2012 conducted a series of experiments on solitary waves to simulate the impingement overtopping and run up of three types of tsunamis interacting with a seawall on a sloping beach dong et al 2010a investigated the transient harbor resonance induced by landslide generated impact waves through physical experiments and numerical simulations the impact waves were found to include a component with solitary wave characteristics and another with dispersive wave features the component with solitary wave characteristics plays an important role in harbor resonance in summary the solitary wave is a valid approximation for tsunamis as with many physical problems of interest numerical simulations have become an efficient tool for studying harbor oscillations bellotti 2020 gao et al 2020 ma et al 2020 rupali et al 2020a however some assumptions such as linear weakly nonlinear non breaking and inviscid must be made in a numerical model physical modeling is another important method for understanding and analyzing the characteristics of harbor oscillations which provides not only a better understanding of hydrodynamic phenomena but also the data for the verification of numerical models compared to numerical simulations physical experiments can reproduce almost all physical phenomena such as transient incident waves energy dissipation due to the fluid viscosity and wave nonlinearity and hence provide more reliable research results and contribute to a better understanding of the phenomenon of harbor oscillations liberatore and mattioli 1984 de girolamo 1996 losada et al 2008 dong et al 2010a 2020a knowledge regarding the tsunami induced maximum free surface elevation inside a harbor is vital as such it is closely related to the potentially devastating flooding thus far a few investigations have been conducted to determine the maximum free surface elevation inside harbors that are triggered by various types of tsunamis gao et al 2017 2019c 2021 however such studies are essentially confined to numerical simulations physical experiments have rarely been conducted hence given the advantages of the physical experiments as stated before it is necessary to conduct physical experiments for tsunami induced harbor oscillations in addition although it has been experimentally found that tsunamis could trigger multi mode harbor oscillations dong et al 2020a the possible generation mechanisms of multi mode oscillations have not been analyzed in detail whether they are directly generated by the transient excitation of tsunamis or are excited by the nonlinear interactions among various wave components remains unknown thus it is important to address this issue based on experimental results in which almost all physical mechanisms are included in this study physical experiments are conducted to investigate the following five issues 1 what are the effects of the water depth and the incident wave height of a solitary wave on the maximum surface elevation within the harbor 2 how does water depth affect the excitation and intensity of the natural modes of a harbor 3 what are the possible mechanisms for the generation of natural modes when a harbor is struck by a solitary wave 4 what are the effects of the water depth and the incident wave height of a solitary wave on the wave wave nonlinear interaction 5 how long would the harbor oscillations persist under various water depths and incident wave heights the novelty of the current study lies in the following two aspects 1 harbor oscillations induced by solitary waves are simulated systematically using physical experiments with various water depths and incident wave heights the experimental results are useful in the validation of a numerical model for simulating the hydrodynamic response of a harbor to solitary waves 2 for the first time the technique of squared wavelet based bicoherence spectra is utilized to analyze the nonlinear wave wave interaction in the harbor oscillations induced by solitary waves some possible mechanisms for the generation of the natural modes excited by the solitary wave are revealed the remainder of this paper is organized as follows in section 2 the setup of the physical experiments is described all data analysis techniques adopted in the present study for the complicated surface elevations are introduced in section 3 for a better explanation of the experimental results natural modes of the experimental harbor are obtained from numerical simulations in section 4 then research results and related discussions for the physical experiments are presented in section 5 finally conclusions are drawn in section 6 2 experimental setup 2 1 general description the experiments were performed in a wave basin at the state key laboratory of coastal and offshore engineering dalian university of technology china the experimental setup is shown in fig 1 fig 1 a is a schematic of the wave basin marking the zone of the model harbor the wave basin is 40 m long and 24 m wide a piston type wavemaker is located on the east side of the water basin in this study the incident wave direction is parallel to the long side of the wave basin wave absorbers indicated by the orange area are employed along the other three sides of the basin to diminish the reflected waves the model area which is 4 8 m long and 3 2 m wide is located at the southwest corner of the basin the geometric size of the harbor model is shown in fig 1 b the model harbor has a square shape with a side length of 1 0 m an entrance with a width of 0 3 m and a breakwater with dimensions of 0 7 m 0 06 m the green area in this subfigure represents the optical viewing area which is used for observation photography and video recording of the water response inside the harbor a photo of the square harbor model is shown in fig 2 the sides of the physical model are made of glass with a smooth surface the glass and angle steel in the model are joined with waterproof glue and the junction between the model and the water basin floor is impermeable the angle between the short edge of the model and the incident wave direction is set to 20 the model area is set far from the wavemaker to extend the propagation distance of the reflected waves generated by the front wall sides of the model facing the wavemaker and thereby to delay the re reflecting waves the deflection angle of 20 facilitates the absorption of the reflected waves by the wave absorbers on the northern side of the basin and thus minimizes the contamination of the experimental results by the reflected waves the deployment of the wave gauges is shown in fig 1 b for most wave frequencies the corresponding wave heights could reach a local maximum at a corner point of the harbor such that most of the natural periods of the harbor can be reflected in the water surface elevations at the corners hence three wave gauges g1 g2 and g3 are deployed at the corners of the square harbor as shown in fig 1 b another wave gauge g4 is placed 11 m away from the harbor entrance as shown in fig 1 a to measure the incident wave in the experiments the water surface elevations are measured using standard capacitance wave gauges the effective measuring range of the wave gauge is 50 cm and its measuring accuracy is 0 1 mm the sampling interval of the waves is 0 02 s 50 hz and the number of sampling points is 4096 82 s each wave test was repeated three times to examine the repeatability 2 2 incident wave parameters to investigate the influences of the water depth and the solitary wave height on the harbor resonance comprehensively different water depths and incident wave heights are considered in the experiments see table 1 for the experimental parameters note that the topography is uniform everywhere thus the water depth for all cases is characterized by a constant value of h moreover as the water surface of a solitary wave is entirely above the mean water level in theory the wave height is the same as the wave amplitude in table 1 the input wave height a i corresponds to the original value input into the wavemaker in the experiments a third order solitary wave solution grimshaw 1971 is used as the target waveform for the laboratory generation of solitary waves based on the wavemaker method proposed by malek mohammadi and testik firat 2010 generally the wave height recorded at the model zone would be slightly smaller than the input value as some important factors such as the bottom friction and the mechanical limitation of the wavemaker machine are not considered in the wavemaker method the implementation of a pre test can guarantee the target wave height near the model zone by sending larger control signal inputs to the wavemaker for simplicity the wave height recorded at gauge g4 i e the last column in table 1 is regarded as the real incident wave height hence the pre test was avoided for solitary waves and a significant amount of experimental time was saved 3 data analysis techniques for the experimental data 3 1 discrete fourier transform and morlet wavelet transform the surface motions within a harbor consist of numerous frequency components including the natural resonant modes of the harbor spectral analysis is useful for identifying these natural modes from complicated surface elevations spectral analysis techniques used extensively to investigate harbor oscillations include the discrete fourier transform dft and morlet wavelet transform mwt woo and liu 2004 dong et al 2010a 2020a kumar et al 2014 2016 gao et al 2018 the spectrum calculated by dft represents the time averaged response over the time range of the analysis losing the transient information without the assumption of a stationary signal the mwt technique can produce both frequency and time domain information from the time series of the water surface elevation in this study to reveal the time and frequency domain information of the free surface elevations inside and outside the harbor the transient characteristics of the harbor oscillations induced by a solitary wave are analyzed using the mwt technique however the frequency resolution of mwt is generally lower than that of dft torrence and compo 1998 thus for a better frequency resolution the dft is also used to extract the time averaged response amplitude of various natural modes quantitatively 3 2 wavelet based bicoherence spectrum it should be noted that both the dft and mwt cannot directly reflect the nonlinear wave wave interactions to determine whether a natural mode is generated by the direct excitation of the tsunamis or is excited by the wave nonlinearity among various wave components the wavelet based bicoherence spectrum wbs is used to measure the nonlinear wave wave interactions in the multi mode oscillations induced by the solitary wave the bicoherence spectrum is given as dong et al 2008 1 b w 2 f 1 f 2 t w t f 1 t w t f 2 t w t f 3 t d t 2 t w t f 1 t w t f 2 t 2 d t t w t f 3 t 2 d t 2 f 1 f 2 f 3 where b w 2 f 1 f 2 can reflect the relative degree of nonlinear interaction between two components with frequencies f 1 and f 2 w t f t is the wavelet spectrum of a time series selected t is the time length of the analyzed signal denotes the complex conjugate and f 1 f 2 and f 3 satisfy eq 2 the nonlinear interaction between two components with frequencies f 1 and f 2 contributes to the generation of a component with frequency f 3 the bicoherence spectrum b w 2 f 1 f 2 varying from 0 to 1 can reflect the relative degree of the nonlinear interaction the larger the value of b w 2 f 1 f 2 is the stronger the nonlinear interaction between f 1 and f 2 the application of the wbs in studying the harbor oscillations induced by the steady state incident waves could be found in dong et al 2010b moreover it is observed from eq 1 that the bicoherence spectrum is symmetric with respect to the line of f 1 f 2 that is b w 2 f 1 f 2 b w 2 f 2 f 1 hence only half of the bicoherence spectrum is shown in the rest of the discussion 4 natural modes obtained from the numerical solution 4 1 numerical setup the knowledge of natural periods and modal shapes of the experimental harbor is necessary for a better explanation of the experimental results thus a linear wave model built by ma et al 2020 is used to calculate the natural periods of the square harbor with different water depths rapidly this model is based on the extended mild slope equation emse chandrasekera and cheung 1997 in the frequency domain and is solved the hybrid finite element method mei et al 2005 it was determined experimentally that this model can capture the natural periods of the square harbor accurately zheng et al 2020b the computational domain is illustrated in fig 3 including 31 351 nodes and 61 850 triangular elements not present for simplicity linear monochromatic waves with various frequencies enter the domain from the open boundary marked by a black dashed circle the land boundaries marked by black solid lines are fully reflecting corresponding to the harbor model the locations of the numerical wave gauges are the same as those in the physical experiments see fig 1 b the amplification factor of the monochromatic wave is defined as 3 r f h f 2 h in f where h in f an arbitrary constant value is the wave height of the incident wave which has no influence on the results due to the linear simplification of the current numerical model h f denotes the response wave heights at a location inside the harbor hence the amplification diagram r f is a function of the frequency and reaches a local maximum at certain frequencies which are known as the natural frequencies of the harbor the spatial distribution of wave height corresponding to a natural frequency is regarded as the shape of the resonant mode it should be noted that the generation of solitary waves and their influences on harbor oscillations are not simulated by the current work the implementation of numerical simulations is only for obtaining the natural periods and modal shapes of the experimental harbor 4 2 numerical results the amplification factor diagram of the square harbor with a constant water depth of 0 6 m is shown in fig 4 as an example each peak in the diagram corresponds to a natural frequency of the square harbor given that the wave height can be amplified obviously at these natural frequencies thus the natural frequencies are extracted from the amplification factor diagram by identifying the x axis locations of peaks some interesting natural frequencies of the square harbor are recorded in table 2 these frequencies are also marked in fig 4 it can be observed from table 2 that the natural frequencies increase with the water depth of the square harbor harbor resonance occurs when the wavelengths of the incoming waves coincide with the characteristic length of the harbor according to the linear dispersion relation the wavelength increases with the increase in water depth hence if the water depth of a harbor decreases the natural periods of the harbor would become greater to obtain a wavelength that is long enough to match the characteristic length of the harbor i e for the trigger of harbor oscillations the first six resonant modal shapes of the square harbor are presented in fig 5 the wave height distributions are normalized by the maximum wave height of each resonant mode hence the color bar is used for all shapes and varies from 0 0 blue to 1 0 red the characteristics of resonant wave motions are useful in determining whether a resonant mode is excited for example in modes m1 and m5 the wave heights at gauges g1 g3 are nearly equal in modes m2 and m6 the wave heights at gauges g1 and g3 are much larger than those at gauge g2 the modes m2 m5 and m6 are noticeable given their very narrow shape in the diagram these special modes were first noticed by bellotti 2007 using a linear model they were further termed extreme modes and investigated by ma et al 2020 who analyzed the nonlinear effect as well moreover these modes were experimentally examined by dong et al 2020a considering both steady incident waves and transient incident waves i e solitary waves it was determined both numerically and experimentally that the extreme modes cannot be triggered by steady state waves but can be triggered by solitary waves note that the further investigation of extreme modes is not the topic of the current work 5 experimental results and discussions the outline of this section is briefly introduced herein the influences of both the water depth and the incident wave height of a solitary wave on the maximum surface elevation within the harbor are shown in subsection 5 1 in response to question 1 proposed in the introduction section the spectral analysis and variations of the amplification factor with respect to both the incident wave heights and the water depth are presented in subsection 5 2 in response to question 2 the squared wavelet based bicoherence spectra are adopted in subsection 5 3 to analyze the nonlinear wave wave interaction where some possible mechanisms for the generation of the resonant modes excited by the solitary wave are revealed addressing the issue 3 the effects of both the water depth and the incident wave height on the wave wave nonlinear interaction are examined in subsection 5 4 in response to question 4 finally the decay process of harbor oscillations is analyzed in subsection 5 5 addressing the issue 5 5 1 maximum surface elevation inside the harbor case c4 is taken as an example to illustrate the time series of the surface elevations recorded at gauges g1 g4 see fig 6 the images recorded for case c4 are illustrated in fig 7 from which it is observed that the solitary wave induces significant free surface elevations inside the harbor the wave amplitude of the solitary wave is amplified by a factor of approximately two subsequently a part of the wave energy of the solitary wave is trapped inside the harbor thereby generating periodic free oscillations note that a depression in the water i e a trailing wave follows the solitary wave see the time series 25 30 s of the wave surface at gauge g4 trailing waves are common in the laboratory generation of solitary waves e g malek mohammadi and testik firat 2010 the amplitude of the trailing wave depends on the wavemaker theory desired solitary wave shape and a h where a and h denote the amplitude and water depth respectively a discussion on how to obtain smaller trailing waves can be found in the literature e g katell and eric 2002 the solitary wave can rapidly excite the maximum surface level inside a harbor and thus the time remaining for the harbor management authority to adopt countermeasures is extremely short hence to improve our predictive ability it is necessary to study the relation between the maximum surface level inside a harbor η max as denoted in fig 6 and the offshore incident wave height of a solitary wave a 0 the variations of η max at gauges g1 g3 with respect to a 0 are presented in fig 8 the related experimental data are presented in table 3 it can be observed that at these three wave gauges η max increased with increasing a 0 as expected owing to the full reflection along the inner boundaries the wave height of the solitary wave is amplified by a factor of approximately two in all cases regardless of what the water depth and the incident wave height a 0 are furthermore it can be inferred that the wave response at gauge g2 is stronger than that at gauges g1 and g3 whereas that at gauge g3 is the weakest this is because the breakwater has the most remarkable shielding effect for the incident solitary wave at gauge g3 the above characteristics are useful in the validation of a numerical model for simulating the hydrodynamic response of a harbor to a solitary wave based on the current results fig 8 the relation between η max and a 0 can be approximately regarded as linear the influence of the water depth on η max recorded at each wave gauge inside the harbor becomes increasingly obvious with increasing a 0 when a 0 is small the three curves of η max versus a 0 at different water depths are extremely close to each other as a 0 increases the differences between them become increasingly evident particularly at gauge g3 overall under the excitation of a solitary wave with the same wave height a 0 the larger the water depth the greater the η max 5 2 excitation and intensity of natural modes spectral analysis is used to reveal the excitation of natural modes from complicated surface elevations fig 9 shows the wavelet energy spectra of case c4 which indicates that the free oscillations inside the harbor are dominated by the lowest mode m1 the wave energy near m1 decayed slowly with time which suggests that the energy of mode m1 required a long time to decay inside the harbor moreover mode m2 is observable in fig 9 at the frequency of mode m2 the spectral densities at gauges g1 and g3 are nearly equal in addition the spectral density at gauge g2 is the smallest these phenomena are consistent with the feature of mode m2 see fig 5 thereby confirming the excitation of mode m2 the generation of transient harbor oscillations was described by dong et al 2020a in harbor resonance induced by a solitary wave mass transport is apparent the mass transport is represented by a large water hump accompanied by considerable wave energy entering the harbor subsequently the water hump exits the harbor within a brief period leaving some wave energy trapped inside the harbor the majority of the energy is concentrated near the natural resonant modes of the harbor for the mwt the frequency resolution of the mwt is generally lower than that of the dft torrence and compo 1998 the frequency resolution of the mwt cannot distinguish the frequencies of modes m3 m6 see fig 9 the dft technique is then used to perform a better frequency domain analysis a total of two time ranges 32 s 82 s and 27 s 77 s are used to obtain the dft amplitude spectra for g1 g3 and g4 respectively as the solitary wave first passes by g4 and then enters the harbor after approximately 5 s the amplitude spectra of cases a4 b4 and c4 are shown in fig 10 as examples note that the amplitude spectra are normalized by the corresponding measured incident wave height of the solitary waves it can be observed that the wave energy is evident near most of the natural frequencies the generation of the large wave components with frequencies lower than mode m1 is attributed to the natural sloshing motion of the wave basin the y axis of fig 4 denotes the hydrodynamic response of the harbor to the stationary disturbance of a monochromatic wave moreover energy loss is not included in the numerical simulations the wave height inside the harbor could be amplified by many times than the incident wave height however the y axis of fig 9 corresponds to the hydrodynamic response of the harbor to the transient disturbance of a solitary wave the energy of solitary wave is partially captured inside the port and then this part of energy distributed over many wave frequencies hence each frequency in fig 9 only corresponds to a minor part of the energy of the incident solitary wave therefore y values of fig 9 are naturally much smaller than that of fig 4 when a resonant mode is excited the wave height distribution should depend on its specific modal shape whether a mode is triggered is further confirmed through its modal shapes as follows in the frequencies of modes m1 and m5 the amplitudes are similar at gauges g1 g3 in the frequencies of modes m2 and m6 the amplitudes at gauges g1 and g3 are nearly equal in addition the spectral density at gauge g2 is the smallest these phenomena are consistent with the modal shapes see fig 10 indicating that modes m1 m2 m5 and m6 are excited in cases a4 b4 and c4 in the frequency of modes m3 and m4 the rules are different in each case overall the amplitudes of modes m3 and m4 are minor the spectrum calculated using the dft technique represents the time averaged response in the time range of the analysis modes m3 and m4 might be excited but decay rapidly hence their amplitudes obtained using the dft are minor the water depth appears to have a negligible influence on the excitation of all natural modes except the first two lowest modes m1 and m2 mode m1 becomes more evident with increasing water depth however it is not clear whether mode m2 would become greater with increasing water depth these results indicate that the water depth mainly affects the energy of the lower natural modes 5 3 generation mechanisms of the natural modes from the wavelet energy spectra see fig 9 it is clear that the wave energy is transferred to higher frequencies from lower frequency waves by the wave wave nonlinear interaction however it is not clear whether the natural modes are generated by the direct excitation of the solitary wave or by wave nonlinearity among various wave components to further examine this issue the squared wavelet based bicoherence spectrum technique is adopted dong et al 2008 the squared wavelet based bicoherence spectra of cases a4 b4 and c4 are shown in fig 11 fig 13 respectively in this f 1 f 2 plane the bicoherence spectrum density along the oblique line f 1 f 2 f 3 reflects the intensity of the generation of the f 3 component from the nonlinear interaction between the f 1 and f 2 components to analyze the wave wave nonlinear interaction separately in different zones the bicoherence spectrum is divided into six zones i e z1 z6 by five oblique lines i e l1 l5 together with the axes these oblique lines recorded in table 4 are selected considering the natural frequencies of the harbor for example in group a lines l1 and l2 f 1 f 2 0 19 and 0 22 respectively enclose the frequency of mode m1 i e 0 207 similarly lines l3 and l4 f 1 f 2 0 75 and 0 93 respectively enclose the frequency of modes m2 and m3 i e 0 817 and 0 872 respectively given that the frequencies of modes m2 and m3 are too close and the frequency resolution is not small enough these two modes are considered together the locations of the natural modes m1 m6 with respect to zones z1 z6 are listed in table 5 note that the oblique lines defined in table 4 are different in figs 11 13 as the natural frequencies are different in each test group see table 2 fig 11 i e case a4 is taken as an example in the following discussion it can be observed from the amplitude spectra fig 10 that at gauge g4 which is outside the harbor the wave energy is concentrated in 0 0 9 hz meanwhile the bicoherence spectrum at gauge g4 see fig 11 a b w 2 f 1 f 2 is evident in z1 z4 in these zones f 1 f 2 0 0 9 hz this implies that at the position of gauge g4 nonlinear interaction contributes to the generation of wave components with frequencies varying from 0 to 0 9 hz in the bicoherence spectra at gauges g1 and g3 see fig 11 b and d that are inside the harbor it is observed that b w 2 f 1 f 2 is minor in zones z2 and z4 in which f 3 includes the natural frequencies of modes m1 m3 in particular in the bicoherence spectrum at gauge g2 see fig 11 c which is also inside the harbor the bicoherence spectrum density in z4 is not close to zero because mode m2 is minor at the gauge g2 position i e the excitation of m2 cannot be detected by gauge g2 see fig 5 b the aforementioned phenomena indicate that the generation of natural modes m1 m3 of the square harbor is probably not attributed to the nonlinear interaction in the case presented instead they are generated directly from the energy transfer of solitary waves the rules above can be found in fig 12 and fig 13 also although zones z2 z4 and z5 cover the natural modes the value distribution of the bicoherence spectrum density is different in these zones in zones z2 and z4 the bicoherence spectrum density is close to zero however for zone z5 the bicoherence spectrum density is small in some inner regions but it is evident in the other inner regions this phenomenon can be further explained as follows it can be observed from figs 9 and 10 that relative to m1 and m2 the other modes are minor the energy of these minor modes probably arises from the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components hence the bicoherence spectrum density is small but is not close to zero in the entire z5 zone in summary the results above indicate that some low order natural modes e g m1 and m2 are mainly generated from the excitation of the solitary wave directly the subsequent nonlinear interaction between various wave components also plays an important role in triggering some high order modes e g m6 5 4 effects of water depth and incident wave height on nonlinear wave interaction the influence of the water depth on the nonlinear wave wave interaction is further analyzed by comparing figs 11 13 it is found that the relative degree of nonlinear wave wave interaction inside the harbor is qualitatively more evident when the water depth is smaller this is probably attributed to the increasing wave nonlinearity in shallow water it is noted that the nonlinear wave interaction mainly occurs in two frequency regions that is the lower frequency zone z1 z3 and the higher frequency zone z5 z6 the nonlinear wave interaction in the lower frequency zone is more evident relative to that in the higher frequency zone moreover the nonlinear wave interaction in the lower frequency zone is not sensitive to the increasing water depth whereas the nonlinear wave interaction in the higher frequency region becomes more evident with decreasing water depth this illustrates that the influence of the water depth on the relative degree of nonlinear wave interaction is more obvious at high frequencies finally the effect of the incident wave height of a solitary wave on the nonlinear wave interaction is examined to this end the squared wavelet based bicoherence spectra at g1 of cases c3 c6 are illustrated in fig 14 by comparing subfigures a d it can be observed that the relative degree of nonlinear wave interaction inside the harbor becomes qualitatively more evident with the increase in the incident wave height additionally both the lower frequency zone z1 z3 and the higher frequency zone z5 z6 are sensitive to the increasing incident wave height 5 5 attenuation of harbor oscillations after the excitation of multi mode oscillations the transient harbor resonance slowly decays it is of interest to exam how long the oscillations persist inside the harbor in this section the decay process of harbor oscillations of all cases is investigated the transient wavelet energy for harbor oscillations is calculated by 4 e mwt t f f w t f t d f where w t f t is the wavelet spectrum f and f are the low and upper boundaries of harbor oscillations band as shown in fig 10 the energy is concentrated near the natural modes of the harbor in particular the majority of energy focused on modes m1 and m2 except the sloshing modes of the wave basins with frequencies lower than mode m1 therefore f and f are set as 0 125 and 1 4 hz respectively to consider the transient wavelet energy for harbor oscillations in the physical experiments the free surface measurement only lasts roughly 82 s however the oscillations are still evident at the end of measurement see fig 6 the duration of the harbor oscillations is estimated to be much greater than 82 s therefore the experimental data are insufficient for the study of time factor it was determined that the decay process of harbor oscillations can be described as the exponential law kulikov et al 1996 thus e mwt t is fitted by an exponential function using the least squares method from which the duration of oscillations can be estimated 5 e t e 0 exp ζ t t 0 where ζ is the unknown case specific decay coefficient t 0 and e 0 denote the selected start time i e 32 s and corresponding e mwt at the start time respectively the time interval between e t 0 e 0 and e t e 0 01 e 0 is regarded as the duration of harbor oscillations i e t e t 0 case c4 is taken as an example to illustrate the fitted curves see fig 15 the fitted ζ and the related duration of harbor oscillations t hos are denoted in fig 15 as well it is observed that the exponential function can describe the decay process fairly well moreover a close agreement could be found among the results in different wave gauges t hos and ζ at gauge g2 are slightly different from that at gauges g1 and g3 this is because mode m2 didn t contribute to e mwt t at gauge g2 the fitted decay coefficient and t hos of all cases are reported in table 6 note that t hos and the decay coefficient are negatively correlated by nature hence the decay coefficients are not analyzed here by comparing the results of group c it is seen that t hos increases with the wave amplitude for cases c1 c5 and then decreases with the wave amplitude for cases c6 c7 a possible explanation is as follow harbor oscillations have potential to persist long under a great disturbance however the energy loss such as dissipative effects and radiation damping may also increase with the disturbance hence t hos increases with the wave amplitude when the energy loss is secondary and then t hos decreases with the wave amplitude when the energy loss dominates moreover by comparing the results with close a 0 e g a4 b4 and c4 it is found that t hos decreases with the water depth which may be attributed to that the energy loss becomes more evident with the decreasing water depth 6 conclusions among the wide variety of mechanisms generating harbor oscillations tsunamis may be the main trigger of destructive oscillations investigation efforts should be increased to improve the understanding of oscillations induced by tsunami type waves in this study the free surface oscillations inside a square harbor induced by a solitary wave are investigated through physical experiments and various combinations of water depths and incident wave heights are considered the influence of the incident wave height and water depth on harbor resonance is examined the following conclusions can be drawn from the results of the present study 1 the relation between the maximum surface elevation within the harbor η max and the incident wave amplitude of a solitary wave a 0 can be approximately regarded as linear see fig 8 the influence of the water depth on η max becomes increasingly remarkable with increasing a 0 when a 0 is small the ratios of η max versus a 0 at different water depths are extremely close to each other as a 0 increases the differences between them become increasingly evident overall under the excitation of a solitary wave with the same wave height a 0 the larger the water depth is the greater the value of η max becomes 2 it seems that the water depth has little influence on the excitation of natural modes except for the first two lowest modes m1 and m2 in particular mode m1 is always shown to become more evident with increasing water depth the results above indicate that the water depth mainly affect the energy of the lower natural modes 3 the analysis results of the wavelet based bicoherence indicate that under the excitation of a solitary wave the natural modes of the harbor are generated in the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components in general the first mechanism plays a decisive role in the generations of low order natural modes e g m1 and m2 while the second mechanism also has a vital catalytic role in triggering higher order modes 4 the effects of both the water depth and the incident wave height of a solitary wave on the nonlinear wave interaction are also examined the nonlinear wave interaction is more remarkable with decreasing water depth moreover the nonlinear wave interaction inside the harbor becomes qualitatively more evident with the increase of the incident wave height 5 the duration of harbor oscillations t hos increases with the wave amplitude when the energy loss is secondary and then t hos decreases with the wave amplitude when the energy loss dominates moreover t hos decreases with the water depth which may be attributed to that the energy loss become more evident with the decreasing water depth finally we reaffirm that these conclusions are only valid for the given harbor and the variation ranges of the wave depth and the incident wave height studied in this paper moreover these conclusions are only one possible explanation for the experimental results from the authors view credit authorship contribution statement xiaozhou ma methodology supervision writing review editing zhenjun zheng methodology investigation visualization writing original draft junliang gao formal analysis methodology writing review editing hongqiao wu formal analysis data curation yujin dong formal analysis data curation guohai dong supervision methodology resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national key research and development program 2017yfc1404200 the national natural science foundation of china grant nos 52071060 51720105010 51979029 and 51911530205 the natural science foundation of jiangsu province bk20201455 the liaoning revitalization talents program xlyc1902114 liaoning province natural science foundation joint foundation program 2020 hylh 11 the fundamental research funds for the central universities grant nos dut20zd402 and dut2019tb02 and the qing lan project of jiangsu universities 
20765,free surface oscillations within a square harbor subjected to solitary waves are investigated through physical experiments the effects of various wave heights and water depths on the resonance within the harbor are examined in this study the technique of wavelet based bicoherence spectra is employed for the first time to investigate the nonlinear wave wave interaction of the transient harbor resonance induced by solitary waves the results show that the relation between the maximum surface elevation η max within the harbor and the incident wave height of a solitary wave can be regarded as approximately linear moreover for the same incident solitary wave height the larger the water depth is the greater the value of η max becomes the analyses of the wavelet based bicoherence indicate that the natural modes of the harbor are generated in the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components the first mechanism plays a decisive role in the generations of low order natural modes while the second mechanism also has a vital catalytic role in triggering higher order modes finally it is examined that the duration of harbor oscillations changes obviously with incident wave heights and water depths keywords harbor oscillations physical experiment solitary waves resonant modes wavelet based bicoherence spectrum nonlinear wave wave interaction 1 introduction free surface resonance inside a harbor occurs when the frequencies of external forces are close to the natural frequencies of the harbor which is referred to as harbor resonance or harbor oscillations rabinovich 2009 harbor resonance may cause berthing vessels to respond violently thereby interrupting the normal loading unloading operations of the ships inside the harbor even breaking mooring lines and causing collision accidents lee and xing 2009 mei 2018 harbor resonance resulting in economic losses has been observed in numerous harbors such as long beach harbor lee and xing 2009 hualien harbor maa et al 2011 pohang harbor kumar et al 2014 and hambantota port dong et al 2020b several external forces can trigger the harbor resonance phenomenon such as low frequency waves tsunamis earthquakes wave groups internal ocean waves tides or currents rabinovich 2009 according to many analyses of in situ measured data yoshida et al 2001 bellotti and franco 2011 lopez et al 2012 thotagamuwage and pattiaratchi 2014 dong et al 2020b the most common triggering factor of low intensity harbor oscillations is probably the incident low frequency waves which are mainly generated through nonlinear interaction of short wave groups chen et al 2006 gao et al 2019b here the low intensity harbor oscillations mainly affect the moored ship motions and lead to port operation downtime zheng et al 2020a moreover tsunamis are probably the main causative factor of destructive oscillations which result in extensive damage to ships and are a threat to human safety some events of destructive harbor oscillations induced by tsunamis can be found in the literature e g rabinovich 2009 the tsunamis generated by the 1964 alaska earthquake spread to crescent city harbor california and caused 11 deaths and economic losses of tens of millions of dollars magoon 1965 on june 15 2006 the oscillation inside the ciutadella harbor increased the wave height by up to 6 m resulting in economic losses amounting to tens of millions of euros monserrat et al 2006 the kuril islands earthquake on november 15 2006 also inflicted enormous losses on crescent city harbor lee and xing 2009 therefore to prevent or mitigate the significant adverse effects of destructive harbor oscillations on the safety of mooring ships and humans more investigations have been conducted in recent years to enhance the understanding of tsunami induced harbor oscillations gao et al 2019a rupali et al 2020b tsunamis are mainly generated by submarine earthquakes offshore landslides or undersea volcanic eruptions as tsunamis propagate into shallow water areas the wave height increases the wave crest becomes steeper and the trough becomes flatter the waveforms of such tsunamis are analogous to those of solitary waves solitary waves can reflect the characteristics of tsunamis in shallow waters to a certain extent liu et al 1995 li 2000 gao et al 2016 and numerous scholars have adopted solitary waves to represent tsunamis goring 1978 carried out physical experiments of solitary waves propagating over varied topographies to simulate tsunamis propagating from the deep sea to a continental shelf trough lin et al 2012 conducted a series of experiments on solitary waves to simulate the impingement overtopping and run up of three types of tsunamis interacting with a seawall on a sloping beach dong et al 2010a investigated the transient harbor resonance induced by landslide generated impact waves through physical experiments and numerical simulations the impact waves were found to include a component with solitary wave characteristics and another with dispersive wave features the component with solitary wave characteristics plays an important role in harbor resonance in summary the solitary wave is a valid approximation for tsunamis as with many physical problems of interest numerical simulations have become an efficient tool for studying harbor oscillations bellotti 2020 gao et al 2020 ma et al 2020 rupali et al 2020a however some assumptions such as linear weakly nonlinear non breaking and inviscid must be made in a numerical model physical modeling is another important method for understanding and analyzing the characteristics of harbor oscillations which provides not only a better understanding of hydrodynamic phenomena but also the data for the verification of numerical models compared to numerical simulations physical experiments can reproduce almost all physical phenomena such as transient incident waves energy dissipation due to the fluid viscosity and wave nonlinearity and hence provide more reliable research results and contribute to a better understanding of the phenomenon of harbor oscillations liberatore and mattioli 1984 de girolamo 1996 losada et al 2008 dong et al 2010a 2020a knowledge regarding the tsunami induced maximum free surface elevation inside a harbor is vital as such it is closely related to the potentially devastating flooding thus far a few investigations have been conducted to determine the maximum free surface elevation inside harbors that are triggered by various types of tsunamis gao et al 2017 2019c 2021 however such studies are essentially confined to numerical simulations physical experiments have rarely been conducted hence given the advantages of the physical experiments as stated before it is necessary to conduct physical experiments for tsunami induced harbor oscillations in addition although it has been experimentally found that tsunamis could trigger multi mode harbor oscillations dong et al 2020a the possible generation mechanisms of multi mode oscillations have not been analyzed in detail whether they are directly generated by the transient excitation of tsunamis or are excited by the nonlinear interactions among various wave components remains unknown thus it is important to address this issue based on experimental results in which almost all physical mechanisms are included in this study physical experiments are conducted to investigate the following five issues 1 what are the effects of the water depth and the incident wave height of a solitary wave on the maximum surface elevation within the harbor 2 how does water depth affect the excitation and intensity of the natural modes of a harbor 3 what are the possible mechanisms for the generation of natural modes when a harbor is struck by a solitary wave 4 what are the effects of the water depth and the incident wave height of a solitary wave on the wave wave nonlinear interaction 5 how long would the harbor oscillations persist under various water depths and incident wave heights the novelty of the current study lies in the following two aspects 1 harbor oscillations induced by solitary waves are simulated systematically using physical experiments with various water depths and incident wave heights the experimental results are useful in the validation of a numerical model for simulating the hydrodynamic response of a harbor to solitary waves 2 for the first time the technique of squared wavelet based bicoherence spectra is utilized to analyze the nonlinear wave wave interaction in the harbor oscillations induced by solitary waves some possible mechanisms for the generation of the natural modes excited by the solitary wave are revealed the remainder of this paper is organized as follows in section 2 the setup of the physical experiments is described all data analysis techniques adopted in the present study for the complicated surface elevations are introduced in section 3 for a better explanation of the experimental results natural modes of the experimental harbor are obtained from numerical simulations in section 4 then research results and related discussions for the physical experiments are presented in section 5 finally conclusions are drawn in section 6 2 experimental setup 2 1 general description the experiments were performed in a wave basin at the state key laboratory of coastal and offshore engineering dalian university of technology china the experimental setup is shown in fig 1 fig 1 a is a schematic of the wave basin marking the zone of the model harbor the wave basin is 40 m long and 24 m wide a piston type wavemaker is located on the east side of the water basin in this study the incident wave direction is parallel to the long side of the wave basin wave absorbers indicated by the orange area are employed along the other three sides of the basin to diminish the reflected waves the model area which is 4 8 m long and 3 2 m wide is located at the southwest corner of the basin the geometric size of the harbor model is shown in fig 1 b the model harbor has a square shape with a side length of 1 0 m an entrance with a width of 0 3 m and a breakwater with dimensions of 0 7 m 0 06 m the green area in this subfigure represents the optical viewing area which is used for observation photography and video recording of the water response inside the harbor a photo of the square harbor model is shown in fig 2 the sides of the physical model are made of glass with a smooth surface the glass and angle steel in the model are joined with waterproof glue and the junction between the model and the water basin floor is impermeable the angle between the short edge of the model and the incident wave direction is set to 20 the model area is set far from the wavemaker to extend the propagation distance of the reflected waves generated by the front wall sides of the model facing the wavemaker and thereby to delay the re reflecting waves the deflection angle of 20 facilitates the absorption of the reflected waves by the wave absorbers on the northern side of the basin and thus minimizes the contamination of the experimental results by the reflected waves the deployment of the wave gauges is shown in fig 1 b for most wave frequencies the corresponding wave heights could reach a local maximum at a corner point of the harbor such that most of the natural periods of the harbor can be reflected in the water surface elevations at the corners hence three wave gauges g1 g2 and g3 are deployed at the corners of the square harbor as shown in fig 1 b another wave gauge g4 is placed 11 m away from the harbor entrance as shown in fig 1 a to measure the incident wave in the experiments the water surface elevations are measured using standard capacitance wave gauges the effective measuring range of the wave gauge is 50 cm and its measuring accuracy is 0 1 mm the sampling interval of the waves is 0 02 s 50 hz and the number of sampling points is 4096 82 s each wave test was repeated three times to examine the repeatability 2 2 incident wave parameters to investigate the influences of the water depth and the solitary wave height on the harbor resonance comprehensively different water depths and incident wave heights are considered in the experiments see table 1 for the experimental parameters note that the topography is uniform everywhere thus the water depth for all cases is characterized by a constant value of h moreover as the water surface of a solitary wave is entirely above the mean water level in theory the wave height is the same as the wave amplitude in table 1 the input wave height a i corresponds to the original value input into the wavemaker in the experiments a third order solitary wave solution grimshaw 1971 is used as the target waveform for the laboratory generation of solitary waves based on the wavemaker method proposed by malek mohammadi and testik firat 2010 generally the wave height recorded at the model zone would be slightly smaller than the input value as some important factors such as the bottom friction and the mechanical limitation of the wavemaker machine are not considered in the wavemaker method the implementation of a pre test can guarantee the target wave height near the model zone by sending larger control signal inputs to the wavemaker for simplicity the wave height recorded at gauge g4 i e the last column in table 1 is regarded as the real incident wave height hence the pre test was avoided for solitary waves and a significant amount of experimental time was saved 3 data analysis techniques for the experimental data 3 1 discrete fourier transform and morlet wavelet transform the surface motions within a harbor consist of numerous frequency components including the natural resonant modes of the harbor spectral analysis is useful for identifying these natural modes from complicated surface elevations spectral analysis techniques used extensively to investigate harbor oscillations include the discrete fourier transform dft and morlet wavelet transform mwt woo and liu 2004 dong et al 2010a 2020a kumar et al 2014 2016 gao et al 2018 the spectrum calculated by dft represents the time averaged response over the time range of the analysis losing the transient information without the assumption of a stationary signal the mwt technique can produce both frequency and time domain information from the time series of the water surface elevation in this study to reveal the time and frequency domain information of the free surface elevations inside and outside the harbor the transient characteristics of the harbor oscillations induced by a solitary wave are analyzed using the mwt technique however the frequency resolution of mwt is generally lower than that of dft torrence and compo 1998 thus for a better frequency resolution the dft is also used to extract the time averaged response amplitude of various natural modes quantitatively 3 2 wavelet based bicoherence spectrum it should be noted that both the dft and mwt cannot directly reflect the nonlinear wave wave interactions to determine whether a natural mode is generated by the direct excitation of the tsunamis or is excited by the wave nonlinearity among various wave components the wavelet based bicoherence spectrum wbs is used to measure the nonlinear wave wave interactions in the multi mode oscillations induced by the solitary wave the bicoherence spectrum is given as dong et al 2008 1 b w 2 f 1 f 2 t w t f 1 t w t f 2 t w t f 3 t d t 2 t w t f 1 t w t f 2 t 2 d t t w t f 3 t 2 d t 2 f 1 f 2 f 3 where b w 2 f 1 f 2 can reflect the relative degree of nonlinear interaction between two components with frequencies f 1 and f 2 w t f t is the wavelet spectrum of a time series selected t is the time length of the analyzed signal denotes the complex conjugate and f 1 f 2 and f 3 satisfy eq 2 the nonlinear interaction between two components with frequencies f 1 and f 2 contributes to the generation of a component with frequency f 3 the bicoherence spectrum b w 2 f 1 f 2 varying from 0 to 1 can reflect the relative degree of the nonlinear interaction the larger the value of b w 2 f 1 f 2 is the stronger the nonlinear interaction between f 1 and f 2 the application of the wbs in studying the harbor oscillations induced by the steady state incident waves could be found in dong et al 2010b moreover it is observed from eq 1 that the bicoherence spectrum is symmetric with respect to the line of f 1 f 2 that is b w 2 f 1 f 2 b w 2 f 2 f 1 hence only half of the bicoherence spectrum is shown in the rest of the discussion 4 natural modes obtained from the numerical solution 4 1 numerical setup the knowledge of natural periods and modal shapes of the experimental harbor is necessary for a better explanation of the experimental results thus a linear wave model built by ma et al 2020 is used to calculate the natural periods of the square harbor with different water depths rapidly this model is based on the extended mild slope equation emse chandrasekera and cheung 1997 in the frequency domain and is solved the hybrid finite element method mei et al 2005 it was determined experimentally that this model can capture the natural periods of the square harbor accurately zheng et al 2020b the computational domain is illustrated in fig 3 including 31 351 nodes and 61 850 triangular elements not present for simplicity linear monochromatic waves with various frequencies enter the domain from the open boundary marked by a black dashed circle the land boundaries marked by black solid lines are fully reflecting corresponding to the harbor model the locations of the numerical wave gauges are the same as those in the physical experiments see fig 1 b the amplification factor of the monochromatic wave is defined as 3 r f h f 2 h in f where h in f an arbitrary constant value is the wave height of the incident wave which has no influence on the results due to the linear simplification of the current numerical model h f denotes the response wave heights at a location inside the harbor hence the amplification diagram r f is a function of the frequency and reaches a local maximum at certain frequencies which are known as the natural frequencies of the harbor the spatial distribution of wave height corresponding to a natural frequency is regarded as the shape of the resonant mode it should be noted that the generation of solitary waves and their influences on harbor oscillations are not simulated by the current work the implementation of numerical simulations is only for obtaining the natural periods and modal shapes of the experimental harbor 4 2 numerical results the amplification factor diagram of the square harbor with a constant water depth of 0 6 m is shown in fig 4 as an example each peak in the diagram corresponds to a natural frequency of the square harbor given that the wave height can be amplified obviously at these natural frequencies thus the natural frequencies are extracted from the amplification factor diagram by identifying the x axis locations of peaks some interesting natural frequencies of the square harbor are recorded in table 2 these frequencies are also marked in fig 4 it can be observed from table 2 that the natural frequencies increase with the water depth of the square harbor harbor resonance occurs when the wavelengths of the incoming waves coincide with the characteristic length of the harbor according to the linear dispersion relation the wavelength increases with the increase in water depth hence if the water depth of a harbor decreases the natural periods of the harbor would become greater to obtain a wavelength that is long enough to match the characteristic length of the harbor i e for the trigger of harbor oscillations the first six resonant modal shapes of the square harbor are presented in fig 5 the wave height distributions are normalized by the maximum wave height of each resonant mode hence the color bar is used for all shapes and varies from 0 0 blue to 1 0 red the characteristics of resonant wave motions are useful in determining whether a resonant mode is excited for example in modes m1 and m5 the wave heights at gauges g1 g3 are nearly equal in modes m2 and m6 the wave heights at gauges g1 and g3 are much larger than those at gauge g2 the modes m2 m5 and m6 are noticeable given their very narrow shape in the diagram these special modes were first noticed by bellotti 2007 using a linear model they were further termed extreme modes and investigated by ma et al 2020 who analyzed the nonlinear effect as well moreover these modes were experimentally examined by dong et al 2020a considering both steady incident waves and transient incident waves i e solitary waves it was determined both numerically and experimentally that the extreme modes cannot be triggered by steady state waves but can be triggered by solitary waves note that the further investigation of extreme modes is not the topic of the current work 5 experimental results and discussions the outline of this section is briefly introduced herein the influences of both the water depth and the incident wave height of a solitary wave on the maximum surface elevation within the harbor are shown in subsection 5 1 in response to question 1 proposed in the introduction section the spectral analysis and variations of the amplification factor with respect to both the incident wave heights and the water depth are presented in subsection 5 2 in response to question 2 the squared wavelet based bicoherence spectra are adopted in subsection 5 3 to analyze the nonlinear wave wave interaction where some possible mechanisms for the generation of the resonant modes excited by the solitary wave are revealed addressing the issue 3 the effects of both the water depth and the incident wave height on the wave wave nonlinear interaction are examined in subsection 5 4 in response to question 4 finally the decay process of harbor oscillations is analyzed in subsection 5 5 addressing the issue 5 5 1 maximum surface elevation inside the harbor case c4 is taken as an example to illustrate the time series of the surface elevations recorded at gauges g1 g4 see fig 6 the images recorded for case c4 are illustrated in fig 7 from which it is observed that the solitary wave induces significant free surface elevations inside the harbor the wave amplitude of the solitary wave is amplified by a factor of approximately two subsequently a part of the wave energy of the solitary wave is trapped inside the harbor thereby generating periodic free oscillations note that a depression in the water i e a trailing wave follows the solitary wave see the time series 25 30 s of the wave surface at gauge g4 trailing waves are common in the laboratory generation of solitary waves e g malek mohammadi and testik firat 2010 the amplitude of the trailing wave depends on the wavemaker theory desired solitary wave shape and a h where a and h denote the amplitude and water depth respectively a discussion on how to obtain smaller trailing waves can be found in the literature e g katell and eric 2002 the solitary wave can rapidly excite the maximum surface level inside a harbor and thus the time remaining for the harbor management authority to adopt countermeasures is extremely short hence to improve our predictive ability it is necessary to study the relation between the maximum surface level inside a harbor η max as denoted in fig 6 and the offshore incident wave height of a solitary wave a 0 the variations of η max at gauges g1 g3 with respect to a 0 are presented in fig 8 the related experimental data are presented in table 3 it can be observed that at these three wave gauges η max increased with increasing a 0 as expected owing to the full reflection along the inner boundaries the wave height of the solitary wave is amplified by a factor of approximately two in all cases regardless of what the water depth and the incident wave height a 0 are furthermore it can be inferred that the wave response at gauge g2 is stronger than that at gauges g1 and g3 whereas that at gauge g3 is the weakest this is because the breakwater has the most remarkable shielding effect for the incident solitary wave at gauge g3 the above characteristics are useful in the validation of a numerical model for simulating the hydrodynamic response of a harbor to a solitary wave based on the current results fig 8 the relation between η max and a 0 can be approximately regarded as linear the influence of the water depth on η max recorded at each wave gauge inside the harbor becomes increasingly obvious with increasing a 0 when a 0 is small the three curves of η max versus a 0 at different water depths are extremely close to each other as a 0 increases the differences between them become increasingly evident particularly at gauge g3 overall under the excitation of a solitary wave with the same wave height a 0 the larger the water depth the greater the η max 5 2 excitation and intensity of natural modes spectral analysis is used to reveal the excitation of natural modes from complicated surface elevations fig 9 shows the wavelet energy spectra of case c4 which indicates that the free oscillations inside the harbor are dominated by the lowest mode m1 the wave energy near m1 decayed slowly with time which suggests that the energy of mode m1 required a long time to decay inside the harbor moreover mode m2 is observable in fig 9 at the frequency of mode m2 the spectral densities at gauges g1 and g3 are nearly equal in addition the spectral density at gauge g2 is the smallest these phenomena are consistent with the feature of mode m2 see fig 5 thereby confirming the excitation of mode m2 the generation of transient harbor oscillations was described by dong et al 2020a in harbor resonance induced by a solitary wave mass transport is apparent the mass transport is represented by a large water hump accompanied by considerable wave energy entering the harbor subsequently the water hump exits the harbor within a brief period leaving some wave energy trapped inside the harbor the majority of the energy is concentrated near the natural resonant modes of the harbor for the mwt the frequency resolution of the mwt is generally lower than that of the dft torrence and compo 1998 the frequency resolution of the mwt cannot distinguish the frequencies of modes m3 m6 see fig 9 the dft technique is then used to perform a better frequency domain analysis a total of two time ranges 32 s 82 s and 27 s 77 s are used to obtain the dft amplitude spectra for g1 g3 and g4 respectively as the solitary wave first passes by g4 and then enters the harbor after approximately 5 s the amplitude spectra of cases a4 b4 and c4 are shown in fig 10 as examples note that the amplitude spectra are normalized by the corresponding measured incident wave height of the solitary waves it can be observed that the wave energy is evident near most of the natural frequencies the generation of the large wave components with frequencies lower than mode m1 is attributed to the natural sloshing motion of the wave basin the y axis of fig 4 denotes the hydrodynamic response of the harbor to the stationary disturbance of a monochromatic wave moreover energy loss is not included in the numerical simulations the wave height inside the harbor could be amplified by many times than the incident wave height however the y axis of fig 9 corresponds to the hydrodynamic response of the harbor to the transient disturbance of a solitary wave the energy of solitary wave is partially captured inside the port and then this part of energy distributed over many wave frequencies hence each frequency in fig 9 only corresponds to a minor part of the energy of the incident solitary wave therefore y values of fig 9 are naturally much smaller than that of fig 4 when a resonant mode is excited the wave height distribution should depend on its specific modal shape whether a mode is triggered is further confirmed through its modal shapes as follows in the frequencies of modes m1 and m5 the amplitudes are similar at gauges g1 g3 in the frequencies of modes m2 and m6 the amplitudes at gauges g1 and g3 are nearly equal in addition the spectral density at gauge g2 is the smallest these phenomena are consistent with the modal shapes see fig 10 indicating that modes m1 m2 m5 and m6 are excited in cases a4 b4 and c4 in the frequency of modes m3 and m4 the rules are different in each case overall the amplitudes of modes m3 and m4 are minor the spectrum calculated using the dft technique represents the time averaged response in the time range of the analysis modes m3 and m4 might be excited but decay rapidly hence their amplitudes obtained using the dft are minor the water depth appears to have a negligible influence on the excitation of all natural modes except the first two lowest modes m1 and m2 mode m1 becomes more evident with increasing water depth however it is not clear whether mode m2 would become greater with increasing water depth these results indicate that the water depth mainly affects the energy of the lower natural modes 5 3 generation mechanisms of the natural modes from the wavelet energy spectra see fig 9 it is clear that the wave energy is transferred to higher frequencies from lower frequency waves by the wave wave nonlinear interaction however it is not clear whether the natural modes are generated by the direct excitation of the solitary wave or by wave nonlinearity among various wave components to further examine this issue the squared wavelet based bicoherence spectrum technique is adopted dong et al 2008 the squared wavelet based bicoherence spectra of cases a4 b4 and c4 are shown in fig 11 fig 13 respectively in this f 1 f 2 plane the bicoherence spectrum density along the oblique line f 1 f 2 f 3 reflects the intensity of the generation of the f 3 component from the nonlinear interaction between the f 1 and f 2 components to analyze the wave wave nonlinear interaction separately in different zones the bicoherence spectrum is divided into six zones i e z1 z6 by five oblique lines i e l1 l5 together with the axes these oblique lines recorded in table 4 are selected considering the natural frequencies of the harbor for example in group a lines l1 and l2 f 1 f 2 0 19 and 0 22 respectively enclose the frequency of mode m1 i e 0 207 similarly lines l3 and l4 f 1 f 2 0 75 and 0 93 respectively enclose the frequency of modes m2 and m3 i e 0 817 and 0 872 respectively given that the frequencies of modes m2 and m3 are too close and the frequency resolution is not small enough these two modes are considered together the locations of the natural modes m1 m6 with respect to zones z1 z6 are listed in table 5 note that the oblique lines defined in table 4 are different in figs 11 13 as the natural frequencies are different in each test group see table 2 fig 11 i e case a4 is taken as an example in the following discussion it can be observed from the amplitude spectra fig 10 that at gauge g4 which is outside the harbor the wave energy is concentrated in 0 0 9 hz meanwhile the bicoherence spectrum at gauge g4 see fig 11 a b w 2 f 1 f 2 is evident in z1 z4 in these zones f 1 f 2 0 0 9 hz this implies that at the position of gauge g4 nonlinear interaction contributes to the generation of wave components with frequencies varying from 0 to 0 9 hz in the bicoherence spectra at gauges g1 and g3 see fig 11 b and d that are inside the harbor it is observed that b w 2 f 1 f 2 is minor in zones z2 and z4 in which f 3 includes the natural frequencies of modes m1 m3 in particular in the bicoherence spectrum at gauge g2 see fig 11 c which is also inside the harbor the bicoherence spectrum density in z4 is not close to zero because mode m2 is minor at the gauge g2 position i e the excitation of m2 cannot be detected by gauge g2 see fig 5 b the aforementioned phenomena indicate that the generation of natural modes m1 m3 of the square harbor is probably not attributed to the nonlinear interaction in the case presented instead they are generated directly from the energy transfer of solitary waves the rules above can be found in fig 12 and fig 13 also although zones z2 z4 and z5 cover the natural modes the value distribution of the bicoherence spectrum density is different in these zones in zones z2 and z4 the bicoherence spectrum density is close to zero however for zone z5 the bicoherence spectrum density is small in some inner regions but it is evident in the other inner regions this phenomenon can be further explained as follows it can be observed from figs 9 and 10 that relative to m1 and m2 the other modes are minor the energy of these minor modes probably arises from the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components hence the bicoherence spectrum density is small but is not close to zero in the entire z5 zone in summary the results above indicate that some low order natural modes e g m1 and m2 are mainly generated from the excitation of the solitary wave directly the subsequent nonlinear interaction between various wave components also plays an important role in triggering some high order modes e g m6 5 4 effects of water depth and incident wave height on nonlinear wave interaction the influence of the water depth on the nonlinear wave wave interaction is further analyzed by comparing figs 11 13 it is found that the relative degree of nonlinear wave wave interaction inside the harbor is qualitatively more evident when the water depth is smaller this is probably attributed to the increasing wave nonlinearity in shallow water it is noted that the nonlinear wave interaction mainly occurs in two frequency regions that is the lower frequency zone z1 z3 and the higher frequency zone z5 z6 the nonlinear wave interaction in the lower frequency zone is more evident relative to that in the higher frequency zone moreover the nonlinear wave interaction in the lower frequency zone is not sensitive to the increasing water depth whereas the nonlinear wave interaction in the higher frequency region becomes more evident with decreasing water depth this illustrates that the influence of the water depth on the relative degree of nonlinear wave interaction is more obvious at high frequencies finally the effect of the incident wave height of a solitary wave on the nonlinear wave interaction is examined to this end the squared wavelet based bicoherence spectra at g1 of cases c3 c6 are illustrated in fig 14 by comparing subfigures a d it can be observed that the relative degree of nonlinear wave interaction inside the harbor becomes qualitatively more evident with the increase in the incident wave height additionally both the lower frequency zone z1 z3 and the higher frequency zone z5 z6 are sensitive to the increasing incident wave height 5 5 attenuation of harbor oscillations after the excitation of multi mode oscillations the transient harbor resonance slowly decays it is of interest to exam how long the oscillations persist inside the harbor in this section the decay process of harbor oscillations of all cases is investigated the transient wavelet energy for harbor oscillations is calculated by 4 e mwt t f f w t f t d f where w t f t is the wavelet spectrum f and f are the low and upper boundaries of harbor oscillations band as shown in fig 10 the energy is concentrated near the natural modes of the harbor in particular the majority of energy focused on modes m1 and m2 except the sloshing modes of the wave basins with frequencies lower than mode m1 therefore f and f are set as 0 125 and 1 4 hz respectively to consider the transient wavelet energy for harbor oscillations in the physical experiments the free surface measurement only lasts roughly 82 s however the oscillations are still evident at the end of measurement see fig 6 the duration of the harbor oscillations is estimated to be much greater than 82 s therefore the experimental data are insufficient for the study of time factor it was determined that the decay process of harbor oscillations can be described as the exponential law kulikov et al 1996 thus e mwt t is fitted by an exponential function using the least squares method from which the duration of oscillations can be estimated 5 e t e 0 exp ζ t t 0 where ζ is the unknown case specific decay coefficient t 0 and e 0 denote the selected start time i e 32 s and corresponding e mwt at the start time respectively the time interval between e t 0 e 0 and e t e 0 01 e 0 is regarded as the duration of harbor oscillations i e t e t 0 case c4 is taken as an example to illustrate the fitted curves see fig 15 the fitted ζ and the related duration of harbor oscillations t hos are denoted in fig 15 as well it is observed that the exponential function can describe the decay process fairly well moreover a close agreement could be found among the results in different wave gauges t hos and ζ at gauge g2 are slightly different from that at gauges g1 and g3 this is because mode m2 didn t contribute to e mwt t at gauge g2 the fitted decay coefficient and t hos of all cases are reported in table 6 note that t hos and the decay coefficient are negatively correlated by nature hence the decay coefficients are not analyzed here by comparing the results of group c it is seen that t hos increases with the wave amplitude for cases c1 c5 and then decreases with the wave amplitude for cases c6 c7 a possible explanation is as follow harbor oscillations have potential to persist long under a great disturbance however the energy loss such as dissipative effects and radiation damping may also increase with the disturbance hence t hos increases with the wave amplitude when the energy loss is secondary and then t hos decreases with the wave amplitude when the energy loss dominates moreover by comparing the results with close a 0 e g a4 b4 and c4 it is found that t hos decreases with the water depth which may be attributed to that the energy loss becomes more evident with the decreasing water depth 6 conclusions among the wide variety of mechanisms generating harbor oscillations tsunamis may be the main trigger of destructive oscillations investigation efforts should be increased to improve the understanding of oscillations induced by tsunami type waves in this study the free surface oscillations inside a square harbor induced by a solitary wave are investigated through physical experiments and various combinations of water depths and incident wave heights are considered the influence of the incident wave height and water depth on harbor resonance is examined the following conclusions can be drawn from the results of the present study 1 the relation between the maximum surface elevation within the harbor η max and the incident wave amplitude of a solitary wave a 0 can be approximately regarded as linear see fig 8 the influence of the water depth on η max becomes increasingly remarkable with increasing a 0 when a 0 is small the ratios of η max versus a 0 at different water depths are extremely close to each other as a 0 increases the differences between them become increasingly evident overall under the excitation of a solitary wave with the same wave height a 0 the larger the water depth is the greater the value of η max becomes 2 it seems that the water depth has little influence on the excitation of natural modes except for the first two lowest modes m1 and m2 in particular mode m1 is always shown to become more evident with increasing water depth the results above indicate that the water depth mainly affect the energy of the lower natural modes 3 the analysis results of the wavelet based bicoherence indicate that under the excitation of a solitary wave the natural modes of the harbor are generated in the following two ways 1 direct generation from the energy transfer of the solitary waves and 2 the subsequent generation from the nonlinear interaction between various wave components in general the first mechanism plays a decisive role in the generations of low order natural modes e g m1 and m2 while the second mechanism also has a vital catalytic role in triggering higher order modes 4 the effects of both the water depth and the incident wave height of a solitary wave on the nonlinear wave interaction are also examined the nonlinear wave interaction is more remarkable with decreasing water depth moreover the nonlinear wave interaction inside the harbor becomes qualitatively more evident with the increase of the incident wave height 5 the duration of harbor oscillations t hos increases with the wave amplitude when the energy loss is secondary and then t hos decreases with the wave amplitude when the energy loss dominates moreover t hos decreases with the water depth which may be attributed to that the energy loss become more evident with the decreasing water depth finally we reaffirm that these conclusions are only valid for the given harbor and the variation ranges of the wave depth and the incident wave height studied in this paper moreover these conclusions are only one possible explanation for the experimental results from the authors view credit authorship contribution statement xiaozhou ma methodology supervision writing review editing zhenjun zheng methodology investigation visualization writing original draft junliang gao formal analysis methodology writing review editing hongqiao wu formal analysis data curation yujin dong formal analysis data curation guohai dong supervision methodology resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national key research and development program 2017yfc1404200 the national natural science foundation of china grant nos 52071060 51720105010 51979029 and 51911530205 the natural science foundation of jiangsu province bk20201455 the liaoning revitalization talents program xlyc1902114 liaoning province natural science foundation joint foundation program 2020 hylh 11 the fundamental research funds for the central universities grant nos dut20zd402 and dut2019tb02 and the qing lan project of jiangsu universities 
20766,a parallel multidisciplinary optimization design is proposed for the lines design of an underwater vehicle resistance and energy consumption are concerned about in obtaining the optimized lines collaborative optimization strategy is adopted to construct the optimization framework the simulated annealing algorithm in combination of the modified method of feasible directions are taken as the optimization algorithms cfd based simulation is conducted to analyze the resistance of the underwater vehicle to improve the optimization efficiency a surrogate model is incorporated into the optimization framework to approximate the cfd calculation unlike the conventional static surrogate models used in the design of underwater vehicles a dynamic surrogate based on trust region and lower confidence bound is proposed an adaptive balance parameter is taken in the lower confidence bound approach to guarantee the tradeoff between the exploitation and exploration ability of the dynamic surrogate model optimal latin hypercube algorithm is employed as the method of design of experiments radial basis function is employed to construct the surrogate model suboff model is used to demonstrate the proposed optimization scheme lines of the underwater vehicle are determined and optimization results of the resistance and energy consumption show the effectiveness of optimization scheme keywords underwater vehicle collaborative optimization resistance energy consumption cfd calculation dynamic surrogate model 1 introduction underwater vehicle is an important tool for human beings to explore and exploit ocean design of an underwater vehicle is a complex system engineering project in which multiple performances should be taken into account representative performances are hydrodynamic performances including maneuverability rapidity and seakeeping rapidity is a main concern in the design of underwater vehicles resistance is an important aspect reflecting the rapidity performance of an underwater vehicle to reduce the resistance becomes comprehensive and challenging work which can be achieved by designing optimal lines the lines also exert a considerable influence on the other hydrodynamic performances i e maneuverability and seakeeping how to obtain the optimal lines is the main concern at the stage of schematic design of an underwater vehicle optimization design provides an approach and has been widely applied during past decades for example the studies in alam et al 2014 alvarez et al 2009 joung et al 2012 sun et al 2015 from the point of view of systems engineering the design work of an underwater vehicle involves multiple disciplines such as hydrodynamics structure automation mechanics mechanical engineering electrics and communication etc conventional optimization design of an underwater vehicle observes the methodology of series design single discipline is considered at some stage of design for example at the stage of schematic design the hydrostatic and hydrodynamic performances are concerned while other disciplines like structure mechanics are ignored as a result it is apt to result in low efficiency and loss of globally optimal solution by using series design multidisciplinary design optimization mdo provides an effective way to solve that problem using this design methodology several closely related disciplines are taken into account simultaneously which guarantees the overall optimal performance improves the optimization efficiency as well since mdo was put forward in early 1980s sobieszczanski sobieski 1982 it has been developed greatly and applied widely in many areas such as aerospace engineering braun et al 1997 valerie michelle 1999 automobile engineering yang et al 2002 zhang et al 2008 and marine engineering for underwater vehicles mdo has shown its feasibility at the stage of schematic design for example mcallister et al 2002 presented a feasible mdo approach that could maximize payload length of an autonomous underwater vehicle auv cao et al 2007 proposed mdo to a conceptual submarine design in which hydrodynamics and cost were considered vlahopoulos and hart 2010 used the mdo to relating affordability and performance in a conceptual submarine design alam et al 2012 addressed a new robust design optimization approach for unmanned underwater vehicle design luo and lyu 2015 applied mdo to the hydrodynamics optimization of an auv bidoki et al 2018 proposed a multidisciplinary feasible framework in combination of particle swarm optimization for the system and static design of an auv although mdo has been proven as an effectively way in the design of underwear vehicles some issues are to be further addressed one is the optimization algorithm conventional optimization algorithms are referred to as gradient based methods such as successive quadratic programming sqp method of feasible direction mfd large scale generalized reduced gradient lsgrg and multifunction optimization system tool most although rapid convergence rate can be achieved by these algorithms it is apt to result in locally optimal solution to obtain globally optimal solutions derivative free methods are available for example genetic algorithm ga particle swarm optimization pso evolutionary algorithm ea and simulated annealing sa however using these global optimization algorithms the optimization efficiency cannot be guaranteed especially for large scale design scenarios another issue in the application of mdo to underwater vehicles is the analysis of subdiscipline empirical formula is commonly used since it provides a shortcut to evaluate the investigated performance in a subdiscipline as a result the optimization accuracy cannot be guaranteed with the development of numerical analysis methods and computer technology some high accuracy numerical computational models are introduced into the optimization framework a representative model is based on cfd technique that is used to evaluate the hydrodynamics for example liu et al 2017 liu and luo 2016 luo and lyu 2015 vasudev et al 2014 however direct incorporation of cfd calculation into a mdo platform degrades the optimization efficiency because performing a cfd calculation is time consuming and has to be repeated during an optimization process to improve the optimization efficiency surrogate models are proposed to substitute the cfd calculation luo and lyu 2015 liu and luo 2016 gu et al 2009 song et al 2013 however how to construct an appropriate surrogate model with good optimization efficiency and accuracy needs to be further studied static surrogate model and dynamic surrogate model are two kinds of surrogate model in the research on optimization design it is noted that nowadays static surrogate models are in common use while dynamic surrogate models are paid much less attention to for static surrogate models both the structure and samples are kept unchanged during an optimization process for a complex optimization scenario it requires quite a lot samples to achieve satisfactory accuracy therefore the optimization efficiency cannot be guaranteed compared with static approach a dynamic surrogate model adaptively updates the samples with proper capacity in terms of both efficiency and accuracy a dynamic surrogate model is preferable pérez et al 2002 proposed an adaptive experiment design for the construction of a response surface based surrogate model cheng and wang 2012 integrated the trust region to a mode pursing sampling based optimization framework to solve high dimensional optimization problem long et al 2014 addressed the trust region based surrogate model combined with low and high dimensional optimization examples eason and cremaschi 2014a presented an adaptive sequential sampling for surrogate model generation with artificial neural networks su et al 2017 proposed a gaussian process based dynamic surrogate model for complex engineering analysis yu et al 2020 put forward a dynamic surrogate assisted evolutionary algorithm framework for structural optimization generally speaking the research on dynamic surrogate models should be paid more attention to and its feasibility in practical engineering should be verified furthermore for example in the optimization design of marine vehicles in this paper an approach of mdo collaborative optimization co is applied to the lines design of an underwater vehicle reduction of resistance and energy consumption is the optimization goal a hybrid optimization algorithm is built up in which a global optimization algorithm sa and a rapid gradient based optimization algorithm mmfd are combined with each other to evaluate the resistance of the investigated underwater vehicle cfd calculation based on rans equation is performed and compared against experimental results within the optimization framework the cfd module is replaced by a dynamic surrogate model based on radial basis function rbf the samples used to construct the surrogate model are obtained by design of experiments doe and updated by means of trust region and lower confidence bound optimal latin hypercube algorithm is adopted as the doe method the overall optimization is carried out on an isight platform the suboff model which is from the national defense advanced research project agency groves et al 1989 liu and huang 1998 is investigated to demonstrate the optimization strategy proposed in the study the main contribution of the study is the introduction of dynamic surrogate model in the lines design of underwater vehicles instead of the conventional static surrogate model in literature another contribution of the study is the optimization algorithm based on the combination of sa and mmfd which aims to guarantee globally optimal solution and optimization efficiency 2 collaborative optimization optimization procedure is one of five important mdo components sobieski and haftka 1997 typical examples of mdo procedure are multidisciplinary feasible method mdf adelman and mantay 1991 individual discipline feasible idf balling and wilkinson 1997 simultaneous analysis and design sand lavelle et al 1991 collaborative optimization co kroo et al 1994 concurrent subspace optimization csso sobieski 1989 analytical target cascading atc lin and gea 2013 and bi level integrated system synthesis bliss sobieszczanski sobieski et al 2000 generally the development of mdo procedure has experienced three stages at the first stage the analysis and integration of disciplines are mainly concerned about the representative approach is mdf at the second stage efforts are mainly devoted to the parallel analysis of disciplines and data management typical approaches are idf and sand the third stage is characterized by the involvement of expert knowledge approaches including co csso atc and bliss are developed at this stage for a complicated engineering project like an underwater vehicle co is preferable since it is characterized by hierarchy integration and parallel processing hosseini et al 2017 the structure of co has a two level hierarchical form involving a system level optimizer and several discipline level optimizers as shown in fig 1 where f z is the optimization objective at system level x i j is the optimal design variable z j is the design variable j z is the consistency constraint j i x i is the optimization objective at discipline level x i j is the design variable at discipline level z j is the desired design variable allocated from system level g x i j x i l is the discipline level constraint in the co based optimization procedure desired values of design variables are transferred from the system level to the discipline level where optimization is carried out in parallel and independently for each discipline with respect to the allocated desired design variables from system level the optimized results are passed recursively to system level to calculate the consistency constraint meanwhile the optimization is performed at the system level such a two level optimization is conducted recurrently until the optimization goal as well as the constraint is satisfied a standard co can be described as fig 1 as can be seen at the system level the consistency constraint is a kind of equality constraint which might result in locally optimal solution or low efficiency of convergence because of the difficulty with karush kuhn tucker necessary condition measures to solve that problem are mainly referred to the alleviation of the constraints and adoption of global optimization algorithms nevertheless it should be noted that convergence to globally optimal solution is in general difficult for real application problems slack factor or penalty function is one of two usual options to alleviate the constraints for examples alexandrov and lewis 2002 lin 2004 in the study slack factors are introduced moreover adaptive simulated annealing asa is employed to guarantee the globally optimal solution asa has been proven as an effective global optimizer kirkpatrick et al 1983 rafique et al 2009 however the main disadvantage is the convergence rate especially for large scale complex design optimization therefore a gradient based optimization algorithm the modified method of feasible direction mmfd is combined with asa mmfd is characterized by robustness and rapid convergence rate secanell and suleman 2005 venter 2010 a searching strategy based on asa in combination of mmfd can be described as follows the first step is to quickly determine the range of globally optimal solution asa is employed and a big slack factor is selected secondly to precisely and quickly locate the globally optimal solution mmfd is used and a small slack factor is selected the process of improved collaborative optimization algorithm is depicted as fig 2 3 numerical simulation of hydrodynamics cfd based numerical simulation provides an effective way to evaluate the hydrodynamic performance of marine vehicles in the study fluent module of ansys a popular commercial cfd software package is employed the investigation model is taken as the underwater robot project suboff conducted by the defense advanced research projects agency since the project has already involved a wealth of experimental data moreover some of the data have been released publicly researchers within the hydrodynamic community can use the data as a reference to verify the validity of numerical simulation performed the suboff model is shown as fig 3 in which l oa is the overall length l the parallel body length l fo the forebody length l af the afterbody length l ca the afterbody cap length r the radius of the parallel middle body as an axisymmetric rotation body the mathematical model of the suboff model can be determined by radius r x in the o xyz cartesian coordinate system forebody 0 x l f o 1 r x r 1 126395101 x 0 3 x 1 4 0 44287470 x 2 0 3 x 1 3 1 0 3 x 1 4 1 2 x 1 1 2 1 parallel middle body l f o x l l f o 2 r x r afterbody l l f o x l l f o l a f 3 r x r r h 2 r h k o ε 2 x 20 20 r h 2 4 r h k o 1 3 k l ε 3 x 45 45 r h 2 6 r h k o k l ε 4 x 36 36 r h 2 4 r h k o k l ε 5 x 10 10 r h 2 r h k o 1 3 k l ε 6 x 1 2 where rh is the coefficient of minimal radius of the rear body ko the tail fat index kl the tail smoothing index the length factor ε x is expressed by 4 ε l f o l l a f x l f o afterbody cap l l f o l a f x l o a 5 r x 0 1175 r 1 3 2 x 44 733333 2 1 2 3 1 computing domain and meshing to perform numerical simulation initially it is necessary to determine the computing domain and generate grids in general a large scale domain is very burdensome for calculation moreover the requirements for workstation also increase greatly too small calculation domain cannot simulate well the underwater vehicle s movement even results in inaccurate calculations therefore the determination of an appropriate computational domain is a crucial step in cfd calculation in this study the computational domain is selected as shown in fig 4 the velocity entrance is hemispherical with the same diameter as the length of suboff the aft body is a cylinder with the same diameter as the afore body while the length twice that of suboff besides the computational domain the quality of grid also exerts an important influence on the calculation results with respect to the convergence and precision in the study unstructured grid is adopted since unstructured grid has the advantages of less human intervention and high degree of automation which helps an automatic optimization implementation it is noted that one of the tasks of the study is to build up an automatic optimization platform that will be explained subsequently in mesh generation the closer to the model the smaller the size of grid is moreover mesh refinement is carried out where the cross section sharply alters especially at the end no slip wall is defined in boundary conditions the wall function method is employed in dealing with near wall the initial height of the near wall grid is selected as y 0 45 meshing results are shown in fig 5 and fig 6 and the quality check is reported in fig 7 as can be seen from the check results the grid quality is mostly concentrated in the range of 0 7 1 or so no less than 0 3 which demonstrates the validity of meshing 3 2 numerical simulation cfd simulation strategies mainly refer to dns direct numerical simulation les large eddy simulation and rans reynolds average navier stokes simulation owing to its calculation efficiency rans simulation is in common use in the study this method is adopted to evaluate the resistance of suboff using this method the standard n s equation is transformed into a reynolds averaged governing equation by replacing a flow variable with the combination of a mean component and a fluctuating component the rans equation takes the form as yakhot et al 1992 6 u i x i 0 ρ u i t ρ u j u i x j p x i μ x j u i x j ρ u i u j s i i j 1 2 3 where u i and u j are velocity terms p is the pressure term ρ is the density of flow μ is the dynamic viscosity s i is a generalized source term ρ u i u j is the reynolds stress to solve the rans equation an additional turbulence model should be involved several turbulence models are available such as sa model standard k ω model sst k ω model standard k ε model rng k ε model realizable k ε model rsm model etc in the study sst k ω is selected which has been confirmed as an appropriate model for suboff by comparing different turbulence models applied to calculation of hydrodynamic forces of suboff bai et al 2010 in the numerical simulation forward movement at a constant speed is considered for the investigated suboff to demonstrate the cfd based simulation fig 8 presents the velocity distribution and pressure variation along with the model a comparison of resistance between experiments provided by the defense advanced research projects agency and simulation is shown in table 1 below it can be seen from the above table that the error between the cfd simulation value and the experimental value is within the allowable range of the project 8 although cfd calculation provides a precise tool to calculate the resistance of suboff it is not appropriate to directly embed the cfd module into an optimization platform the main difficulty is time consuming calculation and resultant low efficiency of optimization especially when the number of grids is huge to guarantee both the calculation accuracy and optimization efficiency a surrogate model can be used to approximate the numerical cfd simulation model 4 dynamic surrogate model 4 1 design of experiments a surrogate model can be viewed as a regression model it is constructed based on limited important samples that can be obtained by using design of experiment doe doe provides an effective way to arrange experiments it usually involves the selection of input variables output variables and control variables using doe the number and the spatial distribution of key samples needed to construct the approximate model i e surrogate model can be determined the study of doe is an important topic in optimization design several doe methods are available such as full factorial design parameter study data file orthogonal arrays central composite design latin hypercube and optimal latin hypercube etc in this study optimal latin hypercube is employed owing to the guaranteed space filling quality to determine the important variables parameter sensitivity analysis is performed by this means the number of design variables can be reduced as a result the doe efficiency can be improved meanwhile the risk of regression error lowers for the model suboff the lines parameters involve the maximal radius r the coefficient of minimal radius of the rear body rh the parallel body length l tail fat index ko and tail smoothing index kl as can be seen from the equations 1 5 the shape of the model is determined by the above five parameters for the objective resistance the main effects are described in the left plot of fig 9 where blue bars indicate a positive correlation while red bars indicate a negative correlation as can be seen the effect of velocity v is predominant other positive effects are v 2 r 2 r r v l 2 r h 2 sequentially for the objective energy consumption mass is selected as the objective in parameter sensitivity analysis because of the close relationship between mass and energy consumption the main effects are depicted as the right plot in fig 9 as can be seen the variable r exerts a major influence on mass other positive effects are sequentially r h r 2 k l k o r h 2 in the later disciplinary optimization section 4 the design variables will be determined based on the results of parameter sensitivity analysis 4 2 surrogate model surrogate models are constructed using a data driven bottom up approach the flowchart of approximation is shown as fig 10 the process involves three major steps which may be interleaved iteratively collection of sample data selection of a surrogate model and optimization of model parameters and verification of the surrogate model the scientific challenge of surrogate modelling is the generation of an accurate model using as few simulation evaluations as possible several kinds of surrogate models are available such as polynomial response surface model radial basis function rbf model kriging model support vector machine svm model space mapping model bandler et al 2004 artificial neural network ann model eason and cremaschi 2014b bayesian network model chivatá cárdenas 2019 and random forest model dasari et al 2019 comparatively the polynomial response surface model is preferred in most cases however the main difficulty with this method is the determination of the order and cross terms of the polynomial function especially for complex nonlinear problems in the study rbf surrogate model is adopted owing to the ability of interpolation of scattered multivariate data rbf based surrogate model can follow complicated shapes and accurately represent complex data queipo et al 2005 a rbf model can be viewed as a sum of weighted basis functions the number of weights depends only on the number of samples rather than the dimension of design variables as a result the calculation efficiency can be improved which is good to high dimensional and multivariate problems zhou et al 2013 to validate the surrogate model a classical model validation metric is employed i e the predictive coefficient of determination or r 2 value this validation method analyzes the correlation between the surrogate model outputs and expected outputs a value close to 1 indicates a well designed surrogate model in the study figs 11 and 12 show the validation results of surrogate models with respect to resistance and energy consumption respectively as seen the r 2 value in resistance approximation is 0 98711 and 0 96904 for energy consumption approximation which implies the high confidence of the surrogate models designed in the study 4 3 lower confidence bound since the adoption of a surrogate model in an optimization process aims to replace the time consuming numerical simulation the optimization results largely depends on the approximation accuracy of the surrogate model constructed which can be improved by a dynamic surrogate model in the dynamic model samples are updated by using some prescreening method commonly used prescreening methods refer to expected improvement ei probability of improvement pi most likely improvement mi and lower confidence bound lcb for a global optimization problem ei pi and lcb are preferable comparatively the adaptability of lcb for different optimization scenarios is better than ei and pi liu et al 2012 in the study lcb is employed to update samples in the surrogate model the objective function of lcb is defined as 7 f l b x y ˆ x w σ ˆ x where y ˆ x is the prediction result by a surrogate model σ ˆ x is the standard deviation w is the balance parameter to control the tradeoff between exploration ability and exploitation ability of lcb method in detail a larger w implies better exploration ability or global optimum while a smaller w means better exploitation ability or local optimum instead of a constant like w 2 commonly used in the study an adaptive balance parameter is proposed as 8 w 3 2 1 min x d α 3 σ ˆ x 2 σ ˆ x α 3 σ ˆ x 1 σ ˆ x α 2 σ ˆ x α 1 σ ˆ x where α is the error between preidicted value and true value i e α y ˆ x y x x d is the euclidean distance between two sample points it can be inferred from eq 4 and eq 5 that if the error is large the solution searching emphasizes more in a global range while as the error decreases the solution searching emphasizes more in a local range and the improvement of the solution accuracy by using the adaptive balance parameter the global optimal solution as well as its accuracy can be guaranteed 4 4 trust region to improve the stability of solution and convergence rate an adaptive trust region is used in dynamic surrogate model since a surrogate model is a good approximation only in a neigbourhood of x k at k iteration i e y ˆ x k y x k the iteration step in an optimzation process should be restricted in a trust region i e 9 s δ k where s denotes the iteration step is the notation of euclidean norm δ k is the trust radius and updates according to the approximation accuracy as follows alexandrov et al 1998 10 δ k c 1 s min c 2 s δ s r r 1 r r 2 o t h e r w i s e where r 1 r 2 c 1 c 2 are constants δ is an upper bound of trust radius r is a factor describing how well the surrrogate model approximates a high fidelity model cfd numerical model in the study in a first order sense defined as 11 r y x k y x k s y x k y ˆ x k s in general the closer to 1 r is the more accurate the surrogate model is consequently the trust region can be extended as reflected by the regulation of parameters in eq 7 usually r 1 r 2 1 c 1 c 2 4 5 verification of dynamic surrogate model to demonstrate the effectiveness of the proposed dynamic suggrogate model a representative test example in mdo field a speed reducer kodiyalam 1998 is taken as the verification model the optimization problem is formulated as 12 min f 0 7854 x 1 x 2 2 3 3333 x 3 2 14 9334 x 3 43 0934 1 5079 x 1 x 6 2 x 7 2 7 477 x 6 3 x 7 3 0 7854 x 4 x 6 2 x 5 x 7 2 s t g 1 27 x 1 x 2 2 x 3 1 0 0 g 2 397 5 x 1 x 2 2 x 3 2 1 0 0 g 3 1 93 x 4 3 x 2 x 3 x 6 4 1 0 g 4 1 93 x 5 3 x 2 x 3 x 7 4 1 0 g 5 745 2 x 4 2 x 2 2 x 3 3 16 9 10 6 110 x 6 3 1 0 g 6 745 2 x 5 2 x 2 2 x 3 2 157 5 10 6 85 x 7 3 1 0 g 7 x 2 x 3 40 1 0 g 8 x 1 x 2 12 0 0 g 9 5 x 1 x 2 0 g 10 1 5 x 6 1 9 x 4 1 0 g 11 1 1 x 7 1 9 x 5 1 0 where the objective f is the weight of the speed reducer x i is a design variable g i is a constant the theoretical optimum of f is 2994 several other surrogate models are used to be compared with the proposed dynamic surrogate model including a dynamic radial basis function drbf model peng et al 2011 a lower confidence bound dynamic radial basis function lcb drbf model dennis and torczon 1997 and a trust region dynamic radial basis function tr drbf mdoel long et al 2014 table 2 lists the optimization results and comparison results as can be seen the optimization efficiency and accuracy by using the proposed model are better than the other models 5 isight integration optimization 5 1 construction of optimization platform with the development of computer technology some integrated optimization platforms are created such as isight dakota modelcenter visualdoc etc in the study isight platform is adopted to conduct the design optimization of the lines of suboff model isight originates from ge s powerful cao computer aided optimization platform it provides a library of components to accomplish the simulation process of design optimization the main components refer to simcode component calculator component and optimization component specific software include three dimensional modeling software creo3 0 pre processing software icem15 0 and simulation software fluent15 0 a specific software can be automatically executed through simcode component batch file for example in the study 3d modeling of suboff is conducted by using creo3 0 when the modeling is finished isight sends the command to icem to start the pre simulation i e meshing and then output the mesh file next isight starts fluent batch file and automatically runs fluent to carry out numerical simulation after calculation the results such as the force moment and pressure impacted on suboff are passed to the next component i e the optimization component in that way new lines of suboff can be obtained and the modeling calculation optimization process will be repeated until the pre defined objective function is achieved isight platform integrates various kinds of software by building blocks combines all design flows into a unified organic and logical framework automatically runs simulation and restarts the design flow as a result it gains over traditional optimization design especially in terms of efficiency in the study at system level the optimization goal is designed as 13 f 0 6 f d 0 4 n e where f d denotes the resistance and n e denotes the energy consumption which can be theoretically determined by 14 n e ρ c x ω t v 3 2 η p where ρ is the fluid density c x the resistance coefficient ω t the area of wetted surface of the underwater vehicle η p the propeller efficiency baowei et al et al in the study the propeller efficiency is assumed as a constant being 0 96 it is noted that through eq 14 it can be inferred that n e is strongly linked to f d nevertheless in the study they are treated as different disciplines the reason is that firstly as seen from the parameter sensitivity analysis in subsection 3 1 different effects are determined for resistance and energy consumption respectively in detail the maximum radius r and the parallel length l are considered the main effects for resistance while for energy consumption the maximum radius r the coefficient of minimal radius of the rear body rh the tail fat index ko and the tail smooth index kl are considered the main effects thus in a co framework there is difference between resistance discipline and energy consumption discipline in terms of both objective and design variables secondly rbf surrogate models are constructed for resistance and energy consumption respectively as aforementioned the design variables are different for resistance and energy consumption which implies different surrogate models for resistance and energy consumption although energy consumption is strongly linked to resistance at discipline level according to the results of parameter sensitivity analysis in section 3 1 the maximum radius r and the parallel length l are selected as the design variables in the resistance discipline and correspondingly the objective function can be designed as 15 f 1 r r 1 2 l l 1 2 for a given velocity for energy consumption discipline the maximum radius r the coefficient of minimal radius of the rear body rh the tail fat index ko and the tail smooth index kl are selected as the design variables and the objective function can be designed as 16 f 2 r r 2 2 r h r h 2 2 k o k o 2 2 k l k l 2 2 it is noted that in eqs 15 and 16 the variables with subscripts 1 and 2 represent the design variables at discipline level while the variables without subscripts represent desired design variables allocated from system level the isight structure is shown as fig 13 the modules including creo icem fluent and matlab are incorporated in the task block the top block one can define the optimization goals design variables and constraints optimization of resistance discipline denoted by optimization 1 in fig 13 and optimization of energy consumption discipline denoted by optimization 2 in fig 13 are executed in parallel as seen in an optimization loop data flow starts from creo for modeling to icem for meshing to fluent for hydrodynamic calculation to matlab for dynamic surrogate model construction and subsequent optimization calculation results are fed back to the task block design variables might be modified if the optimization goals are not achieved afterwards updated design variables would be transferred to the creo module and optimization process would be repeated the detailed procedure of optimization can be described as 1 according to the mathematical model of suboff a 3d model is constructed by using creo corresponding model file with an extension of stp can be obtained at this stage 2 based on the obtained model file meshing is performed by using icem corresponding mesh file with an extension of msh can be obtained at this stage 3 based on the obtained mesh file cfd is carried out by using fluent the calculation results are recorded in a data file with an extension of txt 4 based on the cfd calculation results surrogate models are constructed in matlab optimization of the suboff lines is conducted in combination of obtained surrogated models 5 the above steps are repeated before optimization stopping rule is satisfied 5 2 optimization results the stopping rule for optimization is set as when the difference between current optimization result of objective and the historical optimum of objective is less than 0 001 i e if f o p f k 0 001 optimization stops it is noted that the historical optimum f op can be detected automatically by the isight software moreover the optimum is guaranteed by the proposed hybrid optimization algorithm i e asa mmfd as aforementioned asa guarantees globally optimal solution while mmfd guarantees the optimization efficiency fig 14 presents the optimization processes and results the velocity of the underwater vehicle is selected as 19knot 9 7922 m s as can be recognized from table 1 in general the accuracy of cfd calculation increases with an increase of velocity compared with the velocity in the last row in table 1 the selected velocity 9 7922 m s in optimization increases by around 7 in the plots in fig 14 the black points represent feasible solutions red points denote infeasible solutions while green point indicates the optimal solution table 3 lists the initial values range and optimal values of design variables and objectives in which kl ko and rh are non dimensional variables it should be noted that the initial values and setting of design space are based on the fact that for the investigated underwater vehicle a series of experiments with different lines were performed the design space reflects the range of lines both the lower bound and upper bound of the range of a design variable have corresponding experimental results so do the initial values of design variable cfd calculation and optimization within the experimental range make the results more credible comparison between static surrogate model ssm and the proposed dynamic surrogate model dsm is also presented in table 3 as can be recognized both the resistance f d and energy consumption n e descend on the basis of optimal lines no matter which surrogate model is employed moreover by comparison the optimization effect based on dsm outperforms ssm in terms of both minimization of objectives and number of iteration the optimized hull shape is shown in fig 15 and compared with the shape with original lines a distinct difference can be recognized by observing the sterns it is noted that the investigated suboff hull can be described by mathematical expression groves et al 1989 the variables in the mathematical model are the design variables in the optimization problem described in the manuscript including the maximal radius r the coefficient of minimal radius of the rear body rh the parallel body length l tail fat index ko and tail smoothing index kl therefore optimization of those design variables means the lines design of suboff 6 conclusions in the study of application of mdo to an underwater vehicle concerns are mainly focused on the construction of hybrid optimization strategy in a co framework and surrogate models to approximate the cfd calculation through the optimization results it can be concluded that 1 a combination of global optimization algorithm and gradient based optimization can improve the optimization efficiency and guarantee globally optimal solution as well 2 optimal latin hypercube based doe combined with rbf model provides an effective way to construct a surrogate model to approximate the cfd calculation for an underwater vehicle like suboff 3 a dynamic surrogate model strategy updates the samples and regenerates timely during an optimization process which can improve both the optimization accuracy and efficiency compared with static surrogate models in the study only the main body is considered appendages like fins will be taken into account in calculating hydrodynamics in the next work in addition more hydrodynamic performances such as maneuverability and seakeeping will be involved in the cfd module validation of the cfd simulation work by field test is also a next plan comparison of different combined optimization algorithms will also be studied moreover construction of the objective at system level will be studied it is noted that in the study the balance between resistance and energy consumption as shown in eq 13 is not supported by theory or experiments but by trials in next work such an issue will be studied which aims to theoretically determine the weights of disciplines when defining the system level objective credit authorship contribution statement weilin luo conceptualization methodology formal analysis xiaoming guo writing original draft investigation jiawei dai visualization methodology taichun rao data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement authors are thankful for the support by china fujian provincial department of science and technology grant 2020r0169 
20766,a parallel multidisciplinary optimization design is proposed for the lines design of an underwater vehicle resistance and energy consumption are concerned about in obtaining the optimized lines collaborative optimization strategy is adopted to construct the optimization framework the simulated annealing algorithm in combination of the modified method of feasible directions are taken as the optimization algorithms cfd based simulation is conducted to analyze the resistance of the underwater vehicle to improve the optimization efficiency a surrogate model is incorporated into the optimization framework to approximate the cfd calculation unlike the conventional static surrogate models used in the design of underwater vehicles a dynamic surrogate based on trust region and lower confidence bound is proposed an adaptive balance parameter is taken in the lower confidence bound approach to guarantee the tradeoff between the exploitation and exploration ability of the dynamic surrogate model optimal latin hypercube algorithm is employed as the method of design of experiments radial basis function is employed to construct the surrogate model suboff model is used to demonstrate the proposed optimization scheme lines of the underwater vehicle are determined and optimization results of the resistance and energy consumption show the effectiveness of optimization scheme keywords underwater vehicle collaborative optimization resistance energy consumption cfd calculation dynamic surrogate model 1 introduction underwater vehicle is an important tool for human beings to explore and exploit ocean design of an underwater vehicle is a complex system engineering project in which multiple performances should be taken into account representative performances are hydrodynamic performances including maneuverability rapidity and seakeeping rapidity is a main concern in the design of underwater vehicles resistance is an important aspect reflecting the rapidity performance of an underwater vehicle to reduce the resistance becomes comprehensive and challenging work which can be achieved by designing optimal lines the lines also exert a considerable influence on the other hydrodynamic performances i e maneuverability and seakeeping how to obtain the optimal lines is the main concern at the stage of schematic design of an underwater vehicle optimization design provides an approach and has been widely applied during past decades for example the studies in alam et al 2014 alvarez et al 2009 joung et al 2012 sun et al 2015 from the point of view of systems engineering the design work of an underwater vehicle involves multiple disciplines such as hydrodynamics structure automation mechanics mechanical engineering electrics and communication etc conventional optimization design of an underwater vehicle observes the methodology of series design single discipline is considered at some stage of design for example at the stage of schematic design the hydrostatic and hydrodynamic performances are concerned while other disciplines like structure mechanics are ignored as a result it is apt to result in low efficiency and loss of globally optimal solution by using series design multidisciplinary design optimization mdo provides an effective way to solve that problem using this design methodology several closely related disciplines are taken into account simultaneously which guarantees the overall optimal performance improves the optimization efficiency as well since mdo was put forward in early 1980s sobieszczanski sobieski 1982 it has been developed greatly and applied widely in many areas such as aerospace engineering braun et al 1997 valerie michelle 1999 automobile engineering yang et al 2002 zhang et al 2008 and marine engineering for underwater vehicles mdo has shown its feasibility at the stage of schematic design for example mcallister et al 2002 presented a feasible mdo approach that could maximize payload length of an autonomous underwater vehicle auv cao et al 2007 proposed mdo to a conceptual submarine design in which hydrodynamics and cost were considered vlahopoulos and hart 2010 used the mdo to relating affordability and performance in a conceptual submarine design alam et al 2012 addressed a new robust design optimization approach for unmanned underwater vehicle design luo and lyu 2015 applied mdo to the hydrodynamics optimization of an auv bidoki et al 2018 proposed a multidisciplinary feasible framework in combination of particle swarm optimization for the system and static design of an auv although mdo has been proven as an effectively way in the design of underwear vehicles some issues are to be further addressed one is the optimization algorithm conventional optimization algorithms are referred to as gradient based methods such as successive quadratic programming sqp method of feasible direction mfd large scale generalized reduced gradient lsgrg and multifunction optimization system tool most although rapid convergence rate can be achieved by these algorithms it is apt to result in locally optimal solution to obtain globally optimal solutions derivative free methods are available for example genetic algorithm ga particle swarm optimization pso evolutionary algorithm ea and simulated annealing sa however using these global optimization algorithms the optimization efficiency cannot be guaranteed especially for large scale design scenarios another issue in the application of mdo to underwater vehicles is the analysis of subdiscipline empirical formula is commonly used since it provides a shortcut to evaluate the investigated performance in a subdiscipline as a result the optimization accuracy cannot be guaranteed with the development of numerical analysis methods and computer technology some high accuracy numerical computational models are introduced into the optimization framework a representative model is based on cfd technique that is used to evaluate the hydrodynamics for example liu et al 2017 liu and luo 2016 luo and lyu 2015 vasudev et al 2014 however direct incorporation of cfd calculation into a mdo platform degrades the optimization efficiency because performing a cfd calculation is time consuming and has to be repeated during an optimization process to improve the optimization efficiency surrogate models are proposed to substitute the cfd calculation luo and lyu 2015 liu and luo 2016 gu et al 2009 song et al 2013 however how to construct an appropriate surrogate model with good optimization efficiency and accuracy needs to be further studied static surrogate model and dynamic surrogate model are two kinds of surrogate model in the research on optimization design it is noted that nowadays static surrogate models are in common use while dynamic surrogate models are paid much less attention to for static surrogate models both the structure and samples are kept unchanged during an optimization process for a complex optimization scenario it requires quite a lot samples to achieve satisfactory accuracy therefore the optimization efficiency cannot be guaranteed compared with static approach a dynamic surrogate model adaptively updates the samples with proper capacity in terms of both efficiency and accuracy a dynamic surrogate model is preferable pérez et al 2002 proposed an adaptive experiment design for the construction of a response surface based surrogate model cheng and wang 2012 integrated the trust region to a mode pursing sampling based optimization framework to solve high dimensional optimization problem long et al 2014 addressed the trust region based surrogate model combined with low and high dimensional optimization examples eason and cremaschi 2014a presented an adaptive sequential sampling for surrogate model generation with artificial neural networks su et al 2017 proposed a gaussian process based dynamic surrogate model for complex engineering analysis yu et al 2020 put forward a dynamic surrogate assisted evolutionary algorithm framework for structural optimization generally speaking the research on dynamic surrogate models should be paid more attention to and its feasibility in practical engineering should be verified furthermore for example in the optimization design of marine vehicles in this paper an approach of mdo collaborative optimization co is applied to the lines design of an underwater vehicle reduction of resistance and energy consumption is the optimization goal a hybrid optimization algorithm is built up in which a global optimization algorithm sa and a rapid gradient based optimization algorithm mmfd are combined with each other to evaluate the resistance of the investigated underwater vehicle cfd calculation based on rans equation is performed and compared against experimental results within the optimization framework the cfd module is replaced by a dynamic surrogate model based on radial basis function rbf the samples used to construct the surrogate model are obtained by design of experiments doe and updated by means of trust region and lower confidence bound optimal latin hypercube algorithm is adopted as the doe method the overall optimization is carried out on an isight platform the suboff model which is from the national defense advanced research project agency groves et al 1989 liu and huang 1998 is investigated to demonstrate the optimization strategy proposed in the study the main contribution of the study is the introduction of dynamic surrogate model in the lines design of underwater vehicles instead of the conventional static surrogate model in literature another contribution of the study is the optimization algorithm based on the combination of sa and mmfd which aims to guarantee globally optimal solution and optimization efficiency 2 collaborative optimization optimization procedure is one of five important mdo components sobieski and haftka 1997 typical examples of mdo procedure are multidisciplinary feasible method mdf adelman and mantay 1991 individual discipline feasible idf balling and wilkinson 1997 simultaneous analysis and design sand lavelle et al 1991 collaborative optimization co kroo et al 1994 concurrent subspace optimization csso sobieski 1989 analytical target cascading atc lin and gea 2013 and bi level integrated system synthesis bliss sobieszczanski sobieski et al 2000 generally the development of mdo procedure has experienced three stages at the first stage the analysis and integration of disciplines are mainly concerned about the representative approach is mdf at the second stage efforts are mainly devoted to the parallel analysis of disciplines and data management typical approaches are idf and sand the third stage is characterized by the involvement of expert knowledge approaches including co csso atc and bliss are developed at this stage for a complicated engineering project like an underwater vehicle co is preferable since it is characterized by hierarchy integration and parallel processing hosseini et al 2017 the structure of co has a two level hierarchical form involving a system level optimizer and several discipline level optimizers as shown in fig 1 where f z is the optimization objective at system level x i j is the optimal design variable z j is the design variable j z is the consistency constraint j i x i is the optimization objective at discipline level x i j is the design variable at discipline level z j is the desired design variable allocated from system level g x i j x i l is the discipline level constraint in the co based optimization procedure desired values of design variables are transferred from the system level to the discipline level where optimization is carried out in parallel and independently for each discipline with respect to the allocated desired design variables from system level the optimized results are passed recursively to system level to calculate the consistency constraint meanwhile the optimization is performed at the system level such a two level optimization is conducted recurrently until the optimization goal as well as the constraint is satisfied a standard co can be described as fig 1 as can be seen at the system level the consistency constraint is a kind of equality constraint which might result in locally optimal solution or low efficiency of convergence because of the difficulty with karush kuhn tucker necessary condition measures to solve that problem are mainly referred to the alleviation of the constraints and adoption of global optimization algorithms nevertheless it should be noted that convergence to globally optimal solution is in general difficult for real application problems slack factor or penalty function is one of two usual options to alleviate the constraints for examples alexandrov and lewis 2002 lin 2004 in the study slack factors are introduced moreover adaptive simulated annealing asa is employed to guarantee the globally optimal solution asa has been proven as an effective global optimizer kirkpatrick et al 1983 rafique et al 2009 however the main disadvantage is the convergence rate especially for large scale complex design optimization therefore a gradient based optimization algorithm the modified method of feasible direction mmfd is combined with asa mmfd is characterized by robustness and rapid convergence rate secanell and suleman 2005 venter 2010 a searching strategy based on asa in combination of mmfd can be described as follows the first step is to quickly determine the range of globally optimal solution asa is employed and a big slack factor is selected secondly to precisely and quickly locate the globally optimal solution mmfd is used and a small slack factor is selected the process of improved collaborative optimization algorithm is depicted as fig 2 3 numerical simulation of hydrodynamics cfd based numerical simulation provides an effective way to evaluate the hydrodynamic performance of marine vehicles in the study fluent module of ansys a popular commercial cfd software package is employed the investigation model is taken as the underwater robot project suboff conducted by the defense advanced research projects agency since the project has already involved a wealth of experimental data moreover some of the data have been released publicly researchers within the hydrodynamic community can use the data as a reference to verify the validity of numerical simulation performed the suboff model is shown as fig 3 in which l oa is the overall length l the parallel body length l fo the forebody length l af the afterbody length l ca the afterbody cap length r the radius of the parallel middle body as an axisymmetric rotation body the mathematical model of the suboff model can be determined by radius r x in the o xyz cartesian coordinate system forebody 0 x l f o 1 r x r 1 126395101 x 0 3 x 1 4 0 44287470 x 2 0 3 x 1 3 1 0 3 x 1 4 1 2 x 1 1 2 1 parallel middle body l f o x l l f o 2 r x r afterbody l l f o x l l f o l a f 3 r x r r h 2 r h k o ε 2 x 20 20 r h 2 4 r h k o 1 3 k l ε 3 x 45 45 r h 2 6 r h k o k l ε 4 x 36 36 r h 2 4 r h k o k l ε 5 x 10 10 r h 2 r h k o 1 3 k l ε 6 x 1 2 where rh is the coefficient of minimal radius of the rear body ko the tail fat index kl the tail smoothing index the length factor ε x is expressed by 4 ε l f o l l a f x l f o afterbody cap l l f o l a f x l o a 5 r x 0 1175 r 1 3 2 x 44 733333 2 1 2 3 1 computing domain and meshing to perform numerical simulation initially it is necessary to determine the computing domain and generate grids in general a large scale domain is very burdensome for calculation moreover the requirements for workstation also increase greatly too small calculation domain cannot simulate well the underwater vehicle s movement even results in inaccurate calculations therefore the determination of an appropriate computational domain is a crucial step in cfd calculation in this study the computational domain is selected as shown in fig 4 the velocity entrance is hemispherical with the same diameter as the length of suboff the aft body is a cylinder with the same diameter as the afore body while the length twice that of suboff besides the computational domain the quality of grid also exerts an important influence on the calculation results with respect to the convergence and precision in the study unstructured grid is adopted since unstructured grid has the advantages of less human intervention and high degree of automation which helps an automatic optimization implementation it is noted that one of the tasks of the study is to build up an automatic optimization platform that will be explained subsequently in mesh generation the closer to the model the smaller the size of grid is moreover mesh refinement is carried out where the cross section sharply alters especially at the end no slip wall is defined in boundary conditions the wall function method is employed in dealing with near wall the initial height of the near wall grid is selected as y 0 45 meshing results are shown in fig 5 and fig 6 and the quality check is reported in fig 7 as can be seen from the check results the grid quality is mostly concentrated in the range of 0 7 1 or so no less than 0 3 which demonstrates the validity of meshing 3 2 numerical simulation cfd simulation strategies mainly refer to dns direct numerical simulation les large eddy simulation and rans reynolds average navier stokes simulation owing to its calculation efficiency rans simulation is in common use in the study this method is adopted to evaluate the resistance of suboff using this method the standard n s equation is transformed into a reynolds averaged governing equation by replacing a flow variable with the combination of a mean component and a fluctuating component the rans equation takes the form as yakhot et al 1992 6 u i x i 0 ρ u i t ρ u j u i x j p x i μ x j u i x j ρ u i u j s i i j 1 2 3 where u i and u j are velocity terms p is the pressure term ρ is the density of flow μ is the dynamic viscosity s i is a generalized source term ρ u i u j is the reynolds stress to solve the rans equation an additional turbulence model should be involved several turbulence models are available such as sa model standard k ω model sst k ω model standard k ε model rng k ε model realizable k ε model rsm model etc in the study sst k ω is selected which has been confirmed as an appropriate model for suboff by comparing different turbulence models applied to calculation of hydrodynamic forces of suboff bai et al 2010 in the numerical simulation forward movement at a constant speed is considered for the investigated suboff to demonstrate the cfd based simulation fig 8 presents the velocity distribution and pressure variation along with the model a comparison of resistance between experiments provided by the defense advanced research projects agency and simulation is shown in table 1 below it can be seen from the above table that the error between the cfd simulation value and the experimental value is within the allowable range of the project 8 although cfd calculation provides a precise tool to calculate the resistance of suboff it is not appropriate to directly embed the cfd module into an optimization platform the main difficulty is time consuming calculation and resultant low efficiency of optimization especially when the number of grids is huge to guarantee both the calculation accuracy and optimization efficiency a surrogate model can be used to approximate the numerical cfd simulation model 4 dynamic surrogate model 4 1 design of experiments a surrogate model can be viewed as a regression model it is constructed based on limited important samples that can be obtained by using design of experiment doe doe provides an effective way to arrange experiments it usually involves the selection of input variables output variables and control variables using doe the number and the spatial distribution of key samples needed to construct the approximate model i e surrogate model can be determined the study of doe is an important topic in optimization design several doe methods are available such as full factorial design parameter study data file orthogonal arrays central composite design latin hypercube and optimal latin hypercube etc in this study optimal latin hypercube is employed owing to the guaranteed space filling quality to determine the important variables parameter sensitivity analysis is performed by this means the number of design variables can be reduced as a result the doe efficiency can be improved meanwhile the risk of regression error lowers for the model suboff the lines parameters involve the maximal radius r the coefficient of minimal radius of the rear body rh the parallel body length l tail fat index ko and tail smoothing index kl as can be seen from the equations 1 5 the shape of the model is determined by the above five parameters for the objective resistance the main effects are described in the left plot of fig 9 where blue bars indicate a positive correlation while red bars indicate a negative correlation as can be seen the effect of velocity v is predominant other positive effects are v 2 r 2 r r v l 2 r h 2 sequentially for the objective energy consumption mass is selected as the objective in parameter sensitivity analysis because of the close relationship between mass and energy consumption the main effects are depicted as the right plot in fig 9 as can be seen the variable r exerts a major influence on mass other positive effects are sequentially r h r 2 k l k o r h 2 in the later disciplinary optimization section 4 the design variables will be determined based on the results of parameter sensitivity analysis 4 2 surrogate model surrogate models are constructed using a data driven bottom up approach the flowchart of approximation is shown as fig 10 the process involves three major steps which may be interleaved iteratively collection of sample data selection of a surrogate model and optimization of model parameters and verification of the surrogate model the scientific challenge of surrogate modelling is the generation of an accurate model using as few simulation evaluations as possible several kinds of surrogate models are available such as polynomial response surface model radial basis function rbf model kriging model support vector machine svm model space mapping model bandler et al 2004 artificial neural network ann model eason and cremaschi 2014b bayesian network model chivatá cárdenas 2019 and random forest model dasari et al 2019 comparatively the polynomial response surface model is preferred in most cases however the main difficulty with this method is the determination of the order and cross terms of the polynomial function especially for complex nonlinear problems in the study rbf surrogate model is adopted owing to the ability of interpolation of scattered multivariate data rbf based surrogate model can follow complicated shapes and accurately represent complex data queipo et al 2005 a rbf model can be viewed as a sum of weighted basis functions the number of weights depends only on the number of samples rather than the dimension of design variables as a result the calculation efficiency can be improved which is good to high dimensional and multivariate problems zhou et al 2013 to validate the surrogate model a classical model validation metric is employed i e the predictive coefficient of determination or r 2 value this validation method analyzes the correlation between the surrogate model outputs and expected outputs a value close to 1 indicates a well designed surrogate model in the study figs 11 and 12 show the validation results of surrogate models with respect to resistance and energy consumption respectively as seen the r 2 value in resistance approximation is 0 98711 and 0 96904 for energy consumption approximation which implies the high confidence of the surrogate models designed in the study 4 3 lower confidence bound since the adoption of a surrogate model in an optimization process aims to replace the time consuming numerical simulation the optimization results largely depends on the approximation accuracy of the surrogate model constructed which can be improved by a dynamic surrogate model in the dynamic model samples are updated by using some prescreening method commonly used prescreening methods refer to expected improvement ei probability of improvement pi most likely improvement mi and lower confidence bound lcb for a global optimization problem ei pi and lcb are preferable comparatively the adaptability of lcb for different optimization scenarios is better than ei and pi liu et al 2012 in the study lcb is employed to update samples in the surrogate model the objective function of lcb is defined as 7 f l b x y ˆ x w σ ˆ x where y ˆ x is the prediction result by a surrogate model σ ˆ x is the standard deviation w is the balance parameter to control the tradeoff between exploration ability and exploitation ability of lcb method in detail a larger w implies better exploration ability or global optimum while a smaller w means better exploitation ability or local optimum instead of a constant like w 2 commonly used in the study an adaptive balance parameter is proposed as 8 w 3 2 1 min x d α 3 σ ˆ x 2 σ ˆ x α 3 σ ˆ x 1 σ ˆ x α 2 σ ˆ x α 1 σ ˆ x where α is the error between preidicted value and true value i e α y ˆ x y x x d is the euclidean distance between two sample points it can be inferred from eq 4 and eq 5 that if the error is large the solution searching emphasizes more in a global range while as the error decreases the solution searching emphasizes more in a local range and the improvement of the solution accuracy by using the adaptive balance parameter the global optimal solution as well as its accuracy can be guaranteed 4 4 trust region to improve the stability of solution and convergence rate an adaptive trust region is used in dynamic surrogate model since a surrogate model is a good approximation only in a neigbourhood of x k at k iteration i e y ˆ x k y x k the iteration step in an optimzation process should be restricted in a trust region i e 9 s δ k where s denotes the iteration step is the notation of euclidean norm δ k is the trust radius and updates according to the approximation accuracy as follows alexandrov et al 1998 10 δ k c 1 s min c 2 s δ s r r 1 r r 2 o t h e r w i s e where r 1 r 2 c 1 c 2 are constants δ is an upper bound of trust radius r is a factor describing how well the surrrogate model approximates a high fidelity model cfd numerical model in the study in a first order sense defined as 11 r y x k y x k s y x k y ˆ x k s in general the closer to 1 r is the more accurate the surrogate model is consequently the trust region can be extended as reflected by the regulation of parameters in eq 7 usually r 1 r 2 1 c 1 c 2 4 5 verification of dynamic surrogate model to demonstrate the effectiveness of the proposed dynamic suggrogate model a representative test example in mdo field a speed reducer kodiyalam 1998 is taken as the verification model the optimization problem is formulated as 12 min f 0 7854 x 1 x 2 2 3 3333 x 3 2 14 9334 x 3 43 0934 1 5079 x 1 x 6 2 x 7 2 7 477 x 6 3 x 7 3 0 7854 x 4 x 6 2 x 5 x 7 2 s t g 1 27 x 1 x 2 2 x 3 1 0 0 g 2 397 5 x 1 x 2 2 x 3 2 1 0 0 g 3 1 93 x 4 3 x 2 x 3 x 6 4 1 0 g 4 1 93 x 5 3 x 2 x 3 x 7 4 1 0 g 5 745 2 x 4 2 x 2 2 x 3 3 16 9 10 6 110 x 6 3 1 0 g 6 745 2 x 5 2 x 2 2 x 3 2 157 5 10 6 85 x 7 3 1 0 g 7 x 2 x 3 40 1 0 g 8 x 1 x 2 12 0 0 g 9 5 x 1 x 2 0 g 10 1 5 x 6 1 9 x 4 1 0 g 11 1 1 x 7 1 9 x 5 1 0 where the objective f is the weight of the speed reducer x i is a design variable g i is a constant the theoretical optimum of f is 2994 several other surrogate models are used to be compared with the proposed dynamic surrogate model including a dynamic radial basis function drbf model peng et al 2011 a lower confidence bound dynamic radial basis function lcb drbf model dennis and torczon 1997 and a trust region dynamic radial basis function tr drbf mdoel long et al 2014 table 2 lists the optimization results and comparison results as can be seen the optimization efficiency and accuracy by using the proposed model are better than the other models 5 isight integration optimization 5 1 construction of optimization platform with the development of computer technology some integrated optimization platforms are created such as isight dakota modelcenter visualdoc etc in the study isight platform is adopted to conduct the design optimization of the lines of suboff model isight originates from ge s powerful cao computer aided optimization platform it provides a library of components to accomplish the simulation process of design optimization the main components refer to simcode component calculator component and optimization component specific software include three dimensional modeling software creo3 0 pre processing software icem15 0 and simulation software fluent15 0 a specific software can be automatically executed through simcode component batch file for example in the study 3d modeling of suboff is conducted by using creo3 0 when the modeling is finished isight sends the command to icem to start the pre simulation i e meshing and then output the mesh file next isight starts fluent batch file and automatically runs fluent to carry out numerical simulation after calculation the results such as the force moment and pressure impacted on suboff are passed to the next component i e the optimization component in that way new lines of suboff can be obtained and the modeling calculation optimization process will be repeated until the pre defined objective function is achieved isight platform integrates various kinds of software by building blocks combines all design flows into a unified organic and logical framework automatically runs simulation and restarts the design flow as a result it gains over traditional optimization design especially in terms of efficiency in the study at system level the optimization goal is designed as 13 f 0 6 f d 0 4 n e where f d denotes the resistance and n e denotes the energy consumption which can be theoretically determined by 14 n e ρ c x ω t v 3 2 η p where ρ is the fluid density c x the resistance coefficient ω t the area of wetted surface of the underwater vehicle η p the propeller efficiency baowei et al et al in the study the propeller efficiency is assumed as a constant being 0 96 it is noted that through eq 14 it can be inferred that n e is strongly linked to f d nevertheless in the study they are treated as different disciplines the reason is that firstly as seen from the parameter sensitivity analysis in subsection 3 1 different effects are determined for resistance and energy consumption respectively in detail the maximum radius r and the parallel length l are considered the main effects for resistance while for energy consumption the maximum radius r the coefficient of minimal radius of the rear body rh the tail fat index ko and the tail smooth index kl are considered the main effects thus in a co framework there is difference between resistance discipline and energy consumption discipline in terms of both objective and design variables secondly rbf surrogate models are constructed for resistance and energy consumption respectively as aforementioned the design variables are different for resistance and energy consumption which implies different surrogate models for resistance and energy consumption although energy consumption is strongly linked to resistance at discipline level according to the results of parameter sensitivity analysis in section 3 1 the maximum radius r and the parallel length l are selected as the design variables in the resistance discipline and correspondingly the objective function can be designed as 15 f 1 r r 1 2 l l 1 2 for a given velocity for energy consumption discipline the maximum radius r the coefficient of minimal radius of the rear body rh the tail fat index ko and the tail smooth index kl are selected as the design variables and the objective function can be designed as 16 f 2 r r 2 2 r h r h 2 2 k o k o 2 2 k l k l 2 2 it is noted that in eqs 15 and 16 the variables with subscripts 1 and 2 represent the design variables at discipline level while the variables without subscripts represent desired design variables allocated from system level the isight structure is shown as fig 13 the modules including creo icem fluent and matlab are incorporated in the task block the top block one can define the optimization goals design variables and constraints optimization of resistance discipline denoted by optimization 1 in fig 13 and optimization of energy consumption discipline denoted by optimization 2 in fig 13 are executed in parallel as seen in an optimization loop data flow starts from creo for modeling to icem for meshing to fluent for hydrodynamic calculation to matlab for dynamic surrogate model construction and subsequent optimization calculation results are fed back to the task block design variables might be modified if the optimization goals are not achieved afterwards updated design variables would be transferred to the creo module and optimization process would be repeated the detailed procedure of optimization can be described as 1 according to the mathematical model of suboff a 3d model is constructed by using creo corresponding model file with an extension of stp can be obtained at this stage 2 based on the obtained model file meshing is performed by using icem corresponding mesh file with an extension of msh can be obtained at this stage 3 based on the obtained mesh file cfd is carried out by using fluent the calculation results are recorded in a data file with an extension of txt 4 based on the cfd calculation results surrogate models are constructed in matlab optimization of the suboff lines is conducted in combination of obtained surrogated models 5 the above steps are repeated before optimization stopping rule is satisfied 5 2 optimization results the stopping rule for optimization is set as when the difference between current optimization result of objective and the historical optimum of objective is less than 0 001 i e if f o p f k 0 001 optimization stops it is noted that the historical optimum f op can be detected automatically by the isight software moreover the optimum is guaranteed by the proposed hybrid optimization algorithm i e asa mmfd as aforementioned asa guarantees globally optimal solution while mmfd guarantees the optimization efficiency fig 14 presents the optimization processes and results the velocity of the underwater vehicle is selected as 19knot 9 7922 m s as can be recognized from table 1 in general the accuracy of cfd calculation increases with an increase of velocity compared with the velocity in the last row in table 1 the selected velocity 9 7922 m s in optimization increases by around 7 in the plots in fig 14 the black points represent feasible solutions red points denote infeasible solutions while green point indicates the optimal solution table 3 lists the initial values range and optimal values of design variables and objectives in which kl ko and rh are non dimensional variables it should be noted that the initial values and setting of design space are based on the fact that for the investigated underwater vehicle a series of experiments with different lines were performed the design space reflects the range of lines both the lower bound and upper bound of the range of a design variable have corresponding experimental results so do the initial values of design variable cfd calculation and optimization within the experimental range make the results more credible comparison between static surrogate model ssm and the proposed dynamic surrogate model dsm is also presented in table 3 as can be recognized both the resistance f d and energy consumption n e descend on the basis of optimal lines no matter which surrogate model is employed moreover by comparison the optimization effect based on dsm outperforms ssm in terms of both minimization of objectives and number of iteration the optimized hull shape is shown in fig 15 and compared with the shape with original lines a distinct difference can be recognized by observing the sterns it is noted that the investigated suboff hull can be described by mathematical expression groves et al 1989 the variables in the mathematical model are the design variables in the optimization problem described in the manuscript including the maximal radius r the coefficient of minimal radius of the rear body rh the parallel body length l tail fat index ko and tail smoothing index kl therefore optimization of those design variables means the lines design of suboff 6 conclusions in the study of application of mdo to an underwater vehicle concerns are mainly focused on the construction of hybrid optimization strategy in a co framework and surrogate models to approximate the cfd calculation through the optimization results it can be concluded that 1 a combination of global optimization algorithm and gradient based optimization can improve the optimization efficiency and guarantee globally optimal solution as well 2 optimal latin hypercube based doe combined with rbf model provides an effective way to construct a surrogate model to approximate the cfd calculation for an underwater vehicle like suboff 3 a dynamic surrogate model strategy updates the samples and regenerates timely during an optimization process which can improve both the optimization accuracy and efficiency compared with static surrogate models in the study only the main body is considered appendages like fins will be taken into account in calculating hydrodynamics in the next work in addition more hydrodynamic performances such as maneuverability and seakeeping will be involved in the cfd module validation of the cfd simulation work by field test is also a next plan comparison of different combined optimization algorithms will also be studied moreover construction of the objective at system level will be studied it is noted that in the study the balance between resistance and energy consumption as shown in eq 13 is not supported by theory or experiments but by trials in next work such an issue will be studied which aims to theoretically determine the weights of disciplines when defining the system level objective credit authorship contribution statement weilin luo conceptualization methodology formal analysis xiaoming guo writing original draft investigation jiawei dai visualization methodology taichun rao data curation software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement authors are thankful for the support by china fujian provincial department of science and technology grant 2020r0169 
20767,in this paper an elastoplastic modeling method is presented for dynamic consolidation of liquefiable seabed around a pipeline subjected to ocean environmental loadings i e wave and current special attention is given to the cyclic plasticity modeling of liquefiable marine sediments and the evolving soil pipeline interactions in association with the biot s dynamic consolidation theory motivated by the experimental findings this paper extends a masing type model to the liquefaction induced deformation regime of marine sediments within the cyclic plasticity framework a novel plastic flow rule is developed to capture the cyclic shearing induced volumetric strain and hence exercise direct control over the response pattern of excessive pore water pressure epwp then a model calibration procedure is outlined with respect to cyclic laboratory sample tests under various loading paths finally the combined actions of current on the wave induced dynamics of liquefiable seabed around a buried pipeline are studied by numerical examples the results demonstrate that the propagation of ocean current has major consequences for the wave induced soil structure interactions such as epwp response liquefaction pattern of seabed over the contact areas and uplift of pipeline the liquefaction triggering of seabed and the consequence for the dynamic response of pipeline in the wave and current environment are also investigated keywords cyclic plasticity currents ocean waves liquefiable seabed uplift of pipeline 1 introduction ocean wave and current generally travel along the seabed and interact with each other the ocean currents have a major consequence on the wave induced seabed response ye and jeng 2012 zhou et al 2011 performed an investigation on the soil responses around a pipeline subject to combined wave and current action through a series of flume tests in their tests it is seen that the currents have a comprehensive influence on the soil pipeline interactions precipitating the liquefaction pattern around the pipeline and the uplift of pipeline the shallowly buried pipelines are prone to complex hydraulic interactions due to the coexistence of typhoons swell waves and currents which is an essential issue in the design practice of submarine pipelines therefore it is of interest to develop a theoretical model and examine the influences of current on the wave induced dynamics of pipelines in the liquefiable marine sediments the wave induced dynamics of a submarine pipeline involves intensive interactions between pipeline and the surrounding seabed suffering the accumulation of excess pore water pressure epwp and residual liquefaction de groot et al 2006 fredsøe 2016 a large number of computational models have been and continue to be developed for the simulation of wave induced response of the pipeline buried in liquefiable seabed among these the notable advances are the simulations of the coupling of soil skeleton and pore water through the effective stress formulations the complex geometrical schematisation and the cyclic contact between the pipeline and seabed e g cheng and liu 1986 magda 1997 teh et al 2003 2006 dunn et al 2006 sawicki and mierczyński 2006 sumer et al 2006 2014 ulker et al 2010 gao et al 2011 jeng et al 2013 zhao and jeng 2016 zhao et al 2016 zhao et al 2018 yu et al 2018a 2018b 2019 2021 to date the major challenge still remains for reliable computational modeling the coupling of soil skeleton deformation and epwp buildup in reality the buildup of epwp is a result of the volumetric change caused by cyclic shear during wave propagation the generation of epwp are generally predicted either by semi empirical epwp models in loosely coupled effective stress analysis or by the biot type fully flow stress coupled analysis dobry et al 1985 sassa and sekiguchi 2001 jeng and zhao 2015 markham et al 2016 tropeano et al 2019 zhu et al 2020 chen et al 2021 zhao et al 2021 experimental observations indicate that the cyclic shear strains gradually rearrange the soil grains at the expense of soil pore volume which can pressurize the pore water and as a result cause accumulation of epwp sumer and fredsøe 2002 jeng et al 2007 kirca et al 2013 jeng and zhao 2015 zhao et al 2020 more recently zhao et al 2017 incorporated this shear volume coupling effect of soil skeleton and implemented an additional source term into the biot s equation to consider both generation and dissipation of epwp since then in zhao et al 2018 the modeling framework was applied to investigate the wave induced dynamics of pipeline in the liquefiable seabed by integrating the major features like the dynamic flow stress coupling characteristics of soil hysteretic nonlinearity of marine sediments and soil structure interaction chen et al 2021 proposed a loosely coupled effective analysis method of soil sediments that predict the accumulation of epwp by adopting a semi empirical epwp model in conjunction with the hysteresis stress strain model of soil skeleton the aforementioned studies provide useful insight on the wave induced stability of the pipelines in the liquefiable seabed formulated within the framework of poroelasticity nevertheless knowledge gaps persist particularly in the prediction of the liquefiable seabed deformation behavior and the evolving pipeline seabed interactions due to the gradual uplift of pipeline this gap highlights the significance of cyclic plasticity modelling of the liquefaction related phenomenon around submarine structures this paper intends to present an elastoplastic modeling method for the effective stress analysis of the liquefaction induced stability scenarios around a buried pipeline motivated by experimental observations we extend an existing masing type hysteretic model zhao et al 2018 into the liquefaction induced deformation regime of marine sediments within the framework of cyclic plasticity the proposed stress flow coupled analysis framework is implemented into the dynamic finite difference simulation platform within the flac3d 5 0 code environment itasca 2004 and validated with respect to the cyclic laboratory tests under the prescribed loading paths finally the dynamic response of pipeline buried in liquefiable marine sediments subject to combined wave and current actions are studied by numerical examples in particular the influence of current upon the wave induced dynamic interactions between pipeline and the surrounding liquefiable seabed is investigated in a systematic manner 2 problem definition and general solution fig 1 schematically illustrates the problem of concern which shows that a pipeline is fully buried at the depth of h within a liquefiable seabed monochromatic waves of period t travel over the seabed following with a uniform current of velocity u 0 the seabed is modeled on the basis of biot s dynamic consolidation theory the pore water flow and soil skeleton deformation are governed by the effective stress equilibrium condition and the volumetric compatibility as follows 1 g 2 u i g 1 2 ν ε i j j p i ρ u i 2 k υ w 2 p p n s k f ε j j where g shear modulus of soil skeleton u displacement vector ε strain tensor ρ soil density ν poisson s ratio n s soil porosity υ w unit weight of pore water k soil permeability and p excessive pore water pressure epwp referring to the excess over the hydrostatic pressure p 0 3 p p p w h e r e p 1 t p d t where t loading period p oscillatory epwp and p residual epwp defined as the period averaged p the epwp response is the result of the volumetric compaction of soil skeleton caused by cyclic loading which is the sum of an elastic part ε j j e and a plastic part ε j j p i e 4 ε j j ε j j e ε j j p note that the cyclic shearing induced volumetric change ε j j p of soil skeleton is the key to model the complex mechanical coupling processes ruled by epwp accumulation and cyclic degradation of soil skeleton with the aid of the biot s dynamic consolidation theory the realization of cyclic plasticity is an important step to capture these major liquefaction related features as described in sect 3 3 cyclic plasticity model the significance of cyclic plasticity is apparent in the soil structure interaction simulation due to the fact that the intensive plastic flow deformation of soil occurs at low confinement levels near liquefaction this section aims to incorporate a new plastic flow rule in order to produce the time dependent volumetric strain using the phase resolved transient shear strain the proposed model can therefore exercise more direct control over the epwp accumulation in accordance with experimental observations 3 1 nonlinearity in elastic regime if load reversal occurs prior to reaching the yielding surface the davidenkov model are applied to model the hysteretic nonlinearity of the shear stress strain relationship of soil skeleton in association with the extended masing rules as illustrated in fig 2 for the initial loading the stress strain curve follows the backbone curve 5 τ oct f bb γ oct g max γ oct 1 h γ oct 6 h γ oct γ oct γ 0 2 b 1 γ oct γ 0 2 b a where a b and γ 0 are model parameters g max is maximum shear modulus of the soil skeleton it is to note that γ oct denotes the octahedral shear strain for 3d strain state which is calculated as follows 7 γ oct 2 3 j 2 if a stress reversal occurs at a point γ rev τ rev the subsequent stress strain curve follows a path along the curve described by 8 τ oct τ rev 2 f bb γ oct γ rev 2 3 2 cyclic plasticity in this section we extend the masing type model to plastic strain regime to capture the plastic flow deformation of soil skeleton near liquefaction if loading proceeds till reaching the yielding surface the shear stress strain curves follow the flow or incremental theory of cyclic plasticity involving the backbone curve equation 5 at the first loading cycle and the subsequent stress strain curves equation 8 the incremental stress strain relation is written in the following form 9 d σ i j c i j k l d ε k l e c i j k l d ε k l d ε k l p where d σ i j and d ε i j are the tensors of stress and strain increments and d ε k l e and d ε k l p denote the elastic and plastic components of d ε i j respectively c i j k l is the tensor of elastic modulus the plastic strain increment is defined through the following 10 d ε i j p p d λ where p is a symmetric second order tensor which determines the direction of plastic deformations d λ is the non negative plastic multiplier within the cyclic plasticity framework an appropriate non associative flow rule is specified to model the phenomenological shear volume coupling mechanism of soil skeleton e g prevost 1985 elgama et al 2003 yang et al 2019 it is convenient to decompose p into the deviatoric and volumetric components in the following 11 p p p δ i j 3 p tr p in the new flow rule the deviatoric component p is associative while the volumetric component p is considered as non associative therefore it yields 12 p q where q q q δ i j 3 q tr q q denotes the out normal direction of the yield surface however the determination of the volumetric component p is clearly the major task of the proposed effective analysis framework directly related to the variation in epwp the accumulation of volumetric strain is intrinsically plastic which is a result of the cyclic shearing caused by the long term ocean wave propagation martin et al 1975 illustrated this phenomenological interaction between cyclic shearing and volumetric change and proposed a constitutive formula to characterize this shear volume coupling mechanism then byrne 1991 simplified the martin s constitutive formula with only two parameters dobry and abdoun 2017 demonstrated that no plastic volume strain can generate when the shear strain was lower than the threshold volume shear strain γ th more recently chen et al 2019 updated the byrne s constitutive formula by introducing the concept of γ th and presented the following novel incremental plastic volume strain equation 13 d ε v p v γ a c 1 exp c 2 ε v p γ a γ th c 3 γ a γ th c 3 where γ a cyclic octahedral shear strain amplitude γ th threshold volume shear strain and c 1 c 2 c 3 model constants for the soil in question which can be calibrated by conventional drained cyclic laboratory tests chen et al 2019 it is to note that d ε v p 0 if γ a γ th incorporating the parameter γ th with clear physical meaning from experimental observation we can implement this phenomenological shear volume coupling equation into the plastic flow rule as described above it is to note that equation 13 links the increment of plastic volume strain per half loading cycle with the current γ a occurring during that particular cycle motivated by the experimental observations the incremental plastic volume strain per half loading cycle is updated at the stress reversal point γ rev τ rev of the cyclic loop as seen in fig 2 14 d ε v p c 1 e x p c 2 ε v p γ rev γ th c 3 γ rev γ th c 3 a t s t r e s s r e v e r s a l p o i n t γ rev τ rev 0 o t h e r w i s e a perfectly elasto plastic assumption is made to capture the behaviour of soil skeleton near failure the mohr coloumb failure criterion is adopted to define the yield surface f by specifying a cohesion c and internal friction angle φ in effective stress space as follows 15 f σ q η σ p c where η 6 sin φ 3 sin φ c 6 c sin φ 3 sin φ σ q σ 1 σ 3 σ p σ 1 2 σ 3 3 d λ is a non negative scalar function that will vary throughout the loading history and is determined from the consistency condition which can be expressed as 16 d f f σ i j d σ i j f σ q d σ q f σ p d σ p 0 17 d σ p k d ε v d ε v p 18 d σ q 2 g d ε q d ε q p 19 d ε q p p d λ f σ q d λ where ε q ε 1 ε 3 k is bulk modulus by substituting equations 14 and 17 19 into equation 16 d λ can be solved as follows 20 d λ 2 g d ε q k η d ε v k η d ε v p 2 g once d λ is determined the stress increment can be updated in the following 21 d σ s 2 g d e 2 g q d λ 22 d σ p k d ε v k 3 p d λ where d e d ε i j 1 3 d ε v δ i j is deviatoric rate of strain tensor the proposed model with a small number of parameters can be robust and calibrated directly from conventional drained cyclic laboratory tests juang et al 2018 chen et al 2019 3 3 cyclic degradation of the soil skeleton it is well recognized that sandy soils exhibit cyclic degradation of stiffness and strength related to the residual epwp accumulation under cyclic shearing the maximum shear modulus g max of soil highly depends on the in situ buried depth therefore the confining pressure dependent formulation is used to initialize the g max in the seabed model this formulation is simple and robust with only two physical parameters of soil which can be easily determined by laboratory tests hashash and park 2001 de groot et al 2006 juang et al 2018 23 g max 0 g max 0 ref σ p 0 σ ref where g max 0 ref reference maximum tangent shear modulus σ ref reference effective stress assigned as 100 kpa as convention and σ p 0 initial mean normal effective stress defined as 24 σ p 0 γ z 1 2 k 0 3 where z in situ buried depth of soil γ effective unit weight of soil and k 0 lateral earth pressure coefficient it is noted that the maximum shear modulus g max is a fundamental parameter for the simulation and gradually decays due to the residual epwp accumulation thus taking the residual epwp ratio r u p σ p 0 as the soil state variable the updating g max is computed as de groot et al 2006 25 g max g max 0 σ p 0 p σ p 0 g max 0 1 r u note that liquefaction is triggered when the accumulation of epwp causes r u of 1 in order to avoid numerical instability at the post liquefaction stage a sufficiently small value of 3 kpa is set to be imposed on the mean effective stress σ p to maintain the residual shear strength stiffness of soil skeleton elgamal et al 2003 taborda et al 2014 zhuang et al 2015 4 numerical scheme this section introduces a stress flow coupled analysis procedure for elastoplastic consolidation of liquefiable seabed around a pipeline the proposed model involves a simulation of nonlinear pipeline seabed contact boundary conditions and explicit numerical scheme 4 1 model construction fig 3 schematically illustrates the computation model of pipeline seabed system specifically the lateral size of the model is defined as 5l l is the wave length to eliminate the cutoff boundary effect of computational domain a very refined grid in the vicinity of pipeline is built with a coarser zone away from it the quadrilateral element is adopted with the size of 0 5 0 5 m as satisfactory the convergence tests on the mesh size have been performed to achieve the balance between the accuracy and efficiency of the simulation through the trial and error analysis on the mesh size furthermore the zero thickness elements are employed to model the contact behavior between pipeline and the surrounding seabed day and potts 1994 the stokes wave theories are used to model the complex hydraulic interactions of wave and current specifically the hsu et al s 2009 third order analytical solution is employed to simulate the periodic fluid pressure p b at the seabed surface induced by the combined actions of wave and current as follows 26 p b ρ f g h 2 cosh β d 1 ω 2 β 2 h 2 2 u 0 k ω 0 cos β x ω t 3 ρ f h 2 8 ω 0 ω 0 u 0 β 2 sinh 4 β d g β 3 sinh 2 β d cos 2 β x ω t 3 ρ f β h 3 ω 0 ω 0 u 0 β 512 9 4 sinh 2 β d sinh 7 β d cos 3 β x ω t where β wave number in wave current interactions d water depth h wave height ω frequency of wave and u 0 velocity of current the dispersion equation is written by 27 ω ω 0 β h 2 ω 2 28 w h e r e ω 0 u 0 β g β tanh β d ω 2 9 8 sin h 2 β d 8 sin h 4 β d 64 sin h 4 β d ω 0 u 0 β when no current exists during the wave propagation i e u 0 0 m s the analytic equation 26 is reduced to the classic form of the third order nonlinear wave the analytical solution of the dynamic pressure p b is applied as the stress boundary at the seabed surface furthermore the following boundary conditions according to the principle of repeatability are also admitted zienkiewicz and scott 1972 ye and jeng 2012 29 σ zz σ zx 0 a t z 0 30 u x 0 u z 0 p z 0 a t z d 31 p n 0 a t r x x 0 2 z z 0 2 r where r radius of the pipeline 4 2 numerical implementation based on the explicit algorithm method and parallel computing technology in flac3d code platform itasca 2006 the proposed fully coupled effective stress method for dynamic soil structure analyses in this study was implemented with the help of embedded biot dynamic consolidation equations darcy hydraulic flow and pore fluid model to implement the proposed theory in the form of a stress update algorithm a user defined material subroutine for the proposed constitutive model was compiled in c language to define the state of the material at the gauss points within each element the inclusion of the generalized skeleton degradation allows for changes in soil shear modulus due to epwp generation the liquefaction induced geometric nonlinearity i e large deformation is handled by updating the model grid at each time step corresponding to deformation within the framework of cyclic plasticity and solid mechanics in conjunction with the embedded updated lagrangian ul method in the flac3d code furthermore the dynamic pressure induced by combined wave and current actions is applied at the seabed surface with the aid of fish programming language embedded within flac3d code prior to the dynamic analysis procedure the static step is performed to calculate in situ geostatic stress balance for the gravity of soil skeleton and the hydrostatic pore pressure p 0 to obtain the initial effective consolidation stress of the computational domain especially in the near field of pipeline note that the hydrostatic pore pressure p 0 at the seabed surface is determined by the water depth the flow chart in fig 4 outlines the schematic algorithm adopted for each calculation time step illustrating the logic which couples the soil skeleton deformation and epwp buildup the time step size δt is taken as 10 5 s to achieve convergence for the solution in this explicit stress flow coupled analysis 4 3 model validation prior to the large scale modeling of the pipeline seabed system subject to a combined wave and current action it is essential to perform element test to validate the constitutive model over the prescribed stress paths to do so an undrained strain controlled cyclic triaxial scct test of saturated fine sand is simulated by a single element using the proposed cyclic plasticity model chen et al 2019 note that only one element is built to eliminate the discretisation error as the flac3d code only updates the stress strain state by integrating the constitutive model over the prescribed loading path potts and zdravkovic 1999 the input parameters are given in table 1 the comparison between the measured and calculated results is shown in fig 5 which clearly indicates the overall trend of the calculated residual epwp ratio following the experimental data the deviator stress σ d σ z σ x calculated by the proposed model is quite consistent with that obtained from undrained scct tests similar results can also be obtained by comparing the axial stress strain hysteresis loops as the more detailed comparison of the axial stress strain hysteresis loops shows in fig 5c interestingly the oscillatory amplitudes of σ d continuously decrease significant degradation of the solid skeleton is apparent this demonstrates that the present model can well capture the effects of residual epwp accumulation on the transient shear stress strain response of soil skeleton the continuous reduction in the σ d eventually leads to a σ z σ x state triggering soil liquefaction in association with the marked decrease in the mean normal effective stress the initial axial stress strain curve and the hysteresis loops match well even when the soil becomes liquefied as plotted in fig 6 independent calibrations are performed for the proposed model against the experimental data of ishibashi et al s 1985 strain controlled cyclic torsional simple shear ctss tests on the ottawa silica sand and dobry et al s 1985 strain controlled cyclic direct simple shear cdss tests on the banding sand it is seen that the present model can satisfactorily model the epwp response of different sands 5 results and discussion this section focuses on the investigations of the liquefaction triggering mechanism of seabed in the near field of pipeline and the resulting float of pipeline under wave and current propagations wave and current are two common environmental loads on the seabed and interact with each other the computational parameters are given in table 2 the assumed soil parameters are also listed in the same table which are directly calibrated from the cyclic laboratory tests of undisturbed marine silt i e the shear stiffness and damping ratio over a wide range of shear strain as shown in fig 7 5 1 wave current induced liquefaction around pipeline in this section the effect of current is investigated by comparing the seabed response for the cases under wave loading with and without a current fig 8 shows the liquefaction progression of the seabed around the pipeline it is seen that the wave current interactions have negligible influence on the progressive patterns of liquefaction in the near field of pipeline as compared with the case under only wave loading however the wave induced liquefied zone around the pipeline is significantly expanded by the combined actions of current the generation rate of liquefaction is also amplified due to the presence of current the residual liquefaction is a result of the buildup of epwp fig 9 shows the development of the wave induced epwp versus time for the cases with and without a current as seen in this figure the epwp of the seabed surrounding the pipeline buildup faster for the case with a following current for instance at the pipeline sidewall the residual epwp generates rapidly and it only takes 26 wave cycles to trigger seabed liquefaction while 40 wave cycles are required to cause liquefaction for the case without a current furthermore the impact of current upon the seabed response at the pipeline bottom is more severe than those at the other positions notably the epwp shows different accumulation pattern underlying the pipeline the epwp builds up gently to the maximum value at the 5th wave cycle or so and then falls rapidly to negative values this specific response pattern of epwp can be traced back to the intensive seabed pipeline interactions due to the fact that the present model incorporates the liquefaction induced geometric nonlinearity the pipeline uplift can generate separation at the pipeline seabed interface and hence cause the following pore water dissipation migration around the pipeline this eventually induces the generation of negative epwp at the underlying soil which is consistent with the findings of centrifuge tests by chou et al 2011 and chian et al 2014 5 2 liquefaction induced uplift of pipeline fig 10 plots the time histories of the pipeline uplift during wave propagation with and without a current from figs 7 and 10 it can be seen that the uplift initiates when full liquefaction occurs surrounding the structure this is because that the liquefied seabed is unstable the continuous disturbance in terms of wave and current loadings leads to an abrupt increase in the uplift rate of pipeline notably the pipeline experiences obvious oscillation during the movement process indicating significant force fluctuation acting on the structure it is seen that unlike the 1d pipeline uplift pattern for the case under only wave loading the wave current interactions induce both vertical and horizontal movement of pipeline with more intensive oscillation the uplift suffered by the pipeline for the case under wave and current loading is about 71 cm amplifying 3 times of the uplift magnitude in the case under only wave loadings fig 11 plots the displacement vector of the seabed around pipeline at the time of 750 s as for the case without a current the liquefied soils surrounding the pipeline displace toward the bottom which further aggravates the uplift of pipeline as illustrated in this figure the combined current actions have pronounced influences on the wave induced displacement pattern of the subsoils at the vicinity of pipeline in terms of both magnitudes and directions 5 3 soil pipeline interactions due to wave current actions laboratory evidence indicates that natural marine deposits exhibit significant stress path dependent behavior the effect of wave current interactions can be comprehensively interpreted by the induced stress path and the cyclic response of soil element at the vicinity of pipeline fig 12 plots the cyclic stress paths in the soil element around the pipeline within the shear stress space τ xz σ z σ x 2 it is seen that the wave induced cyclic shear stress coincides well with the typical circular path as shown in fig 12a in which the principal stress axis continuously rotates with a constant deviatoric stress ishihara and towhata 1983 as shown in fig 12b the stress path under the combined wave and current actions forms a cardioid shape in the τ xz σ z σ x 2 space indicating that the magnitude of deviatoric stress cyclically changes in association with continuous principal stress axis rotation this is even more so at the pipeline sidewall as seen in fig 12c and d clearly the induced stress paths at the pipeline bottom follow practically the same traces for the cases with and without a current with a general trend of continuous decrease towards the zero stress state i e liquefaction initialization from fig 12f and e it can be observed that the combined actions of current trigger liquefaction underlying the pipeline at 25 cycles while it takes 50 cycles for the case under only wave loading indeed the liquefaction induced pipeline uplift is the result of extensive plastic flow deformation of soil skeleton and pore water dissipation migration as shown in fig 13 b the combined current action causes extensive plastic flow deformation achieving 10 deviatoric strain concentrated in the vicinity of pipeline the so called flow type failure mode can be identified in the cyclic stress strain curve for the case under wave and current loading yang and sze 2011 the failure is suddenly triggered even though the epwp generates gradually as seen in fig 9 which is featured by the triggering of abrupt strain with no stress reversals however one can see in fig 13a that sufficient stress reversals can still occur at high deviatoric strain level of 10 2 and the flow type failure does not happen even at post liquefaction stage by comparing fig 13a and b it can be concluded that the pipeline seabed interactions become even more pronounced for the failure of seabed and the induced pipeline response considering the combined action of current with wave 6 conclusions the effect of an ocean current on the wave induced liquefaction progression in the near field of pipeline is investigated within the biot s dynamic consolidation theory and cyclic plasticity permitting an explicit time matching analysis of the intensive soil structure interactions in the liquefiable seabed with the aid of flac3d 5 0 code the main conclusions are summarized below 1 the main features characterizing the liquefaction behavior of seabed and the evolving seabed pipeline interactions are incorporated into the proposed cyclic plasticity modelling method a model calibration procedure was outlined against cyclic laboratory sample test data selected representative simulation results were presented to demonstrate the model performance 2 the influences of current on the wave induced seabed liquefaction process in the near field of pipeline are examined by numerical examples the coexistence of ocean current significantly changes the original characteristics of wave induced seabed liquefaction in the vicinity of pipeline accelerating the epwp buildup and reducing the liquefaction triggering resistance 3 the disturbance in terms of wave and current propagation triggers an extensive increase of the uplift rate after liquefaction initialization the pipeline experiences obvious oscillation during the uplift process indicating significant force fluctuation on the structure the combined current actions have pronounced influence on the uplift pattern in magnitude and direction with regard to the case under only wave loading 4 the soil structure interactions impose intensive loading boundaries in the near field of pipeline the combined wave and current actions generate the cyclic change of the deviatoric stress magnitude in association with continuous principal stress axis rotation in the soil element resulting in flow type failure of seabed the liquefaction triggering of seabed and the consequence for the dynamic response of pipeline in the wave and current environment are interpreted credit authorship contribution statement kai zhao conceptualization methodology writing original draft funding acquisition qiuzhe wang software data curation visualization investigation validation su chen visualization investigation supervision haiyang zhuang writing review editing supervision guoxing chen writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was funded by the national natural science foundation of china 51978335 and the national key r d project of china 2017yfc1500403 the authors gratefully acknowledge this ﬁnancial support 
20767,in this paper an elastoplastic modeling method is presented for dynamic consolidation of liquefiable seabed around a pipeline subjected to ocean environmental loadings i e wave and current special attention is given to the cyclic plasticity modeling of liquefiable marine sediments and the evolving soil pipeline interactions in association with the biot s dynamic consolidation theory motivated by the experimental findings this paper extends a masing type model to the liquefaction induced deformation regime of marine sediments within the cyclic plasticity framework a novel plastic flow rule is developed to capture the cyclic shearing induced volumetric strain and hence exercise direct control over the response pattern of excessive pore water pressure epwp then a model calibration procedure is outlined with respect to cyclic laboratory sample tests under various loading paths finally the combined actions of current on the wave induced dynamics of liquefiable seabed around a buried pipeline are studied by numerical examples the results demonstrate that the propagation of ocean current has major consequences for the wave induced soil structure interactions such as epwp response liquefaction pattern of seabed over the contact areas and uplift of pipeline the liquefaction triggering of seabed and the consequence for the dynamic response of pipeline in the wave and current environment are also investigated keywords cyclic plasticity currents ocean waves liquefiable seabed uplift of pipeline 1 introduction ocean wave and current generally travel along the seabed and interact with each other the ocean currents have a major consequence on the wave induced seabed response ye and jeng 2012 zhou et al 2011 performed an investigation on the soil responses around a pipeline subject to combined wave and current action through a series of flume tests in their tests it is seen that the currents have a comprehensive influence on the soil pipeline interactions precipitating the liquefaction pattern around the pipeline and the uplift of pipeline the shallowly buried pipelines are prone to complex hydraulic interactions due to the coexistence of typhoons swell waves and currents which is an essential issue in the design practice of submarine pipelines therefore it is of interest to develop a theoretical model and examine the influences of current on the wave induced dynamics of pipelines in the liquefiable marine sediments the wave induced dynamics of a submarine pipeline involves intensive interactions between pipeline and the surrounding seabed suffering the accumulation of excess pore water pressure epwp and residual liquefaction de groot et al 2006 fredsøe 2016 a large number of computational models have been and continue to be developed for the simulation of wave induced response of the pipeline buried in liquefiable seabed among these the notable advances are the simulations of the coupling of soil skeleton and pore water through the effective stress formulations the complex geometrical schematisation and the cyclic contact between the pipeline and seabed e g cheng and liu 1986 magda 1997 teh et al 2003 2006 dunn et al 2006 sawicki and mierczyński 2006 sumer et al 2006 2014 ulker et al 2010 gao et al 2011 jeng et al 2013 zhao and jeng 2016 zhao et al 2016 zhao et al 2018 yu et al 2018a 2018b 2019 2021 to date the major challenge still remains for reliable computational modeling the coupling of soil skeleton deformation and epwp buildup in reality the buildup of epwp is a result of the volumetric change caused by cyclic shear during wave propagation the generation of epwp are generally predicted either by semi empirical epwp models in loosely coupled effective stress analysis or by the biot type fully flow stress coupled analysis dobry et al 1985 sassa and sekiguchi 2001 jeng and zhao 2015 markham et al 2016 tropeano et al 2019 zhu et al 2020 chen et al 2021 zhao et al 2021 experimental observations indicate that the cyclic shear strains gradually rearrange the soil grains at the expense of soil pore volume which can pressurize the pore water and as a result cause accumulation of epwp sumer and fredsøe 2002 jeng et al 2007 kirca et al 2013 jeng and zhao 2015 zhao et al 2020 more recently zhao et al 2017 incorporated this shear volume coupling effect of soil skeleton and implemented an additional source term into the biot s equation to consider both generation and dissipation of epwp since then in zhao et al 2018 the modeling framework was applied to investigate the wave induced dynamics of pipeline in the liquefiable seabed by integrating the major features like the dynamic flow stress coupling characteristics of soil hysteretic nonlinearity of marine sediments and soil structure interaction chen et al 2021 proposed a loosely coupled effective analysis method of soil sediments that predict the accumulation of epwp by adopting a semi empirical epwp model in conjunction with the hysteresis stress strain model of soil skeleton the aforementioned studies provide useful insight on the wave induced stability of the pipelines in the liquefiable seabed formulated within the framework of poroelasticity nevertheless knowledge gaps persist particularly in the prediction of the liquefiable seabed deformation behavior and the evolving pipeline seabed interactions due to the gradual uplift of pipeline this gap highlights the significance of cyclic plasticity modelling of the liquefaction related phenomenon around submarine structures this paper intends to present an elastoplastic modeling method for the effective stress analysis of the liquefaction induced stability scenarios around a buried pipeline motivated by experimental observations we extend an existing masing type hysteretic model zhao et al 2018 into the liquefaction induced deformation regime of marine sediments within the framework of cyclic plasticity the proposed stress flow coupled analysis framework is implemented into the dynamic finite difference simulation platform within the flac3d 5 0 code environment itasca 2004 and validated with respect to the cyclic laboratory tests under the prescribed loading paths finally the dynamic response of pipeline buried in liquefiable marine sediments subject to combined wave and current actions are studied by numerical examples in particular the influence of current upon the wave induced dynamic interactions between pipeline and the surrounding liquefiable seabed is investigated in a systematic manner 2 problem definition and general solution fig 1 schematically illustrates the problem of concern which shows that a pipeline is fully buried at the depth of h within a liquefiable seabed monochromatic waves of period t travel over the seabed following with a uniform current of velocity u 0 the seabed is modeled on the basis of biot s dynamic consolidation theory the pore water flow and soil skeleton deformation are governed by the effective stress equilibrium condition and the volumetric compatibility as follows 1 g 2 u i g 1 2 ν ε i j j p i ρ u i 2 k υ w 2 p p n s k f ε j j where g shear modulus of soil skeleton u displacement vector ε strain tensor ρ soil density ν poisson s ratio n s soil porosity υ w unit weight of pore water k soil permeability and p excessive pore water pressure epwp referring to the excess over the hydrostatic pressure p 0 3 p p p w h e r e p 1 t p d t where t loading period p oscillatory epwp and p residual epwp defined as the period averaged p the epwp response is the result of the volumetric compaction of soil skeleton caused by cyclic loading which is the sum of an elastic part ε j j e and a plastic part ε j j p i e 4 ε j j ε j j e ε j j p note that the cyclic shearing induced volumetric change ε j j p of soil skeleton is the key to model the complex mechanical coupling processes ruled by epwp accumulation and cyclic degradation of soil skeleton with the aid of the biot s dynamic consolidation theory the realization of cyclic plasticity is an important step to capture these major liquefaction related features as described in sect 3 3 cyclic plasticity model the significance of cyclic plasticity is apparent in the soil structure interaction simulation due to the fact that the intensive plastic flow deformation of soil occurs at low confinement levels near liquefaction this section aims to incorporate a new plastic flow rule in order to produce the time dependent volumetric strain using the phase resolved transient shear strain the proposed model can therefore exercise more direct control over the epwp accumulation in accordance with experimental observations 3 1 nonlinearity in elastic regime if load reversal occurs prior to reaching the yielding surface the davidenkov model are applied to model the hysteretic nonlinearity of the shear stress strain relationship of soil skeleton in association with the extended masing rules as illustrated in fig 2 for the initial loading the stress strain curve follows the backbone curve 5 τ oct f bb γ oct g max γ oct 1 h γ oct 6 h γ oct γ oct γ 0 2 b 1 γ oct γ 0 2 b a where a b and γ 0 are model parameters g max is maximum shear modulus of the soil skeleton it is to note that γ oct denotes the octahedral shear strain for 3d strain state which is calculated as follows 7 γ oct 2 3 j 2 if a stress reversal occurs at a point γ rev τ rev the subsequent stress strain curve follows a path along the curve described by 8 τ oct τ rev 2 f bb γ oct γ rev 2 3 2 cyclic plasticity in this section we extend the masing type model to plastic strain regime to capture the plastic flow deformation of soil skeleton near liquefaction if loading proceeds till reaching the yielding surface the shear stress strain curves follow the flow or incremental theory of cyclic plasticity involving the backbone curve equation 5 at the first loading cycle and the subsequent stress strain curves equation 8 the incremental stress strain relation is written in the following form 9 d σ i j c i j k l d ε k l e c i j k l d ε k l d ε k l p where d σ i j and d ε i j are the tensors of stress and strain increments and d ε k l e and d ε k l p denote the elastic and plastic components of d ε i j respectively c i j k l is the tensor of elastic modulus the plastic strain increment is defined through the following 10 d ε i j p p d λ where p is a symmetric second order tensor which determines the direction of plastic deformations d λ is the non negative plastic multiplier within the cyclic plasticity framework an appropriate non associative flow rule is specified to model the phenomenological shear volume coupling mechanism of soil skeleton e g prevost 1985 elgama et al 2003 yang et al 2019 it is convenient to decompose p into the deviatoric and volumetric components in the following 11 p p p δ i j 3 p tr p in the new flow rule the deviatoric component p is associative while the volumetric component p is considered as non associative therefore it yields 12 p q where q q q δ i j 3 q tr q q denotes the out normal direction of the yield surface however the determination of the volumetric component p is clearly the major task of the proposed effective analysis framework directly related to the variation in epwp the accumulation of volumetric strain is intrinsically plastic which is a result of the cyclic shearing caused by the long term ocean wave propagation martin et al 1975 illustrated this phenomenological interaction between cyclic shearing and volumetric change and proposed a constitutive formula to characterize this shear volume coupling mechanism then byrne 1991 simplified the martin s constitutive formula with only two parameters dobry and abdoun 2017 demonstrated that no plastic volume strain can generate when the shear strain was lower than the threshold volume shear strain γ th more recently chen et al 2019 updated the byrne s constitutive formula by introducing the concept of γ th and presented the following novel incremental plastic volume strain equation 13 d ε v p v γ a c 1 exp c 2 ε v p γ a γ th c 3 γ a γ th c 3 where γ a cyclic octahedral shear strain amplitude γ th threshold volume shear strain and c 1 c 2 c 3 model constants for the soil in question which can be calibrated by conventional drained cyclic laboratory tests chen et al 2019 it is to note that d ε v p 0 if γ a γ th incorporating the parameter γ th with clear physical meaning from experimental observation we can implement this phenomenological shear volume coupling equation into the plastic flow rule as described above it is to note that equation 13 links the increment of plastic volume strain per half loading cycle with the current γ a occurring during that particular cycle motivated by the experimental observations the incremental plastic volume strain per half loading cycle is updated at the stress reversal point γ rev τ rev of the cyclic loop as seen in fig 2 14 d ε v p c 1 e x p c 2 ε v p γ rev γ th c 3 γ rev γ th c 3 a t s t r e s s r e v e r s a l p o i n t γ rev τ rev 0 o t h e r w i s e a perfectly elasto plastic assumption is made to capture the behaviour of soil skeleton near failure the mohr coloumb failure criterion is adopted to define the yield surface f by specifying a cohesion c and internal friction angle φ in effective stress space as follows 15 f σ q η σ p c where η 6 sin φ 3 sin φ c 6 c sin φ 3 sin φ σ q σ 1 σ 3 σ p σ 1 2 σ 3 3 d λ is a non negative scalar function that will vary throughout the loading history and is determined from the consistency condition which can be expressed as 16 d f f σ i j d σ i j f σ q d σ q f σ p d σ p 0 17 d σ p k d ε v d ε v p 18 d σ q 2 g d ε q d ε q p 19 d ε q p p d λ f σ q d λ where ε q ε 1 ε 3 k is bulk modulus by substituting equations 14 and 17 19 into equation 16 d λ can be solved as follows 20 d λ 2 g d ε q k η d ε v k η d ε v p 2 g once d λ is determined the stress increment can be updated in the following 21 d σ s 2 g d e 2 g q d λ 22 d σ p k d ε v k 3 p d λ where d e d ε i j 1 3 d ε v δ i j is deviatoric rate of strain tensor the proposed model with a small number of parameters can be robust and calibrated directly from conventional drained cyclic laboratory tests juang et al 2018 chen et al 2019 3 3 cyclic degradation of the soil skeleton it is well recognized that sandy soils exhibit cyclic degradation of stiffness and strength related to the residual epwp accumulation under cyclic shearing the maximum shear modulus g max of soil highly depends on the in situ buried depth therefore the confining pressure dependent formulation is used to initialize the g max in the seabed model this formulation is simple and robust with only two physical parameters of soil which can be easily determined by laboratory tests hashash and park 2001 de groot et al 2006 juang et al 2018 23 g max 0 g max 0 ref σ p 0 σ ref where g max 0 ref reference maximum tangent shear modulus σ ref reference effective stress assigned as 100 kpa as convention and σ p 0 initial mean normal effective stress defined as 24 σ p 0 γ z 1 2 k 0 3 where z in situ buried depth of soil γ effective unit weight of soil and k 0 lateral earth pressure coefficient it is noted that the maximum shear modulus g max is a fundamental parameter for the simulation and gradually decays due to the residual epwp accumulation thus taking the residual epwp ratio r u p σ p 0 as the soil state variable the updating g max is computed as de groot et al 2006 25 g max g max 0 σ p 0 p σ p 0 g max 0 1 r u note that liquefaction is triggered when the accumulation of epwp causes r u of 1 in order to avoid numerical instability at the post liquefaction stage a sufficiently small value of 3 kpa is set to be imposed on the mean effective stress σ p to maintain the residual shear strength stiffness of soil skeleton elgamal et al 2003 taborda et al 2014 zhuang et al 2015 4 numerical scheme this section introduces a stress flow coupled analysis procedure for elastoplastic consolidation of liquefiable seabed around a pipeline the proposed model involves a simulation of nonlinear pipeline seabed contact boundary conditions and explicit numerical scheme 4 1 model construction fig 3 schematically illustrates the computation model of pipeline seabed system specifically the lateral size of the model is defined as 5l l is the wave length to eliminate the cutoff boundary effect of computational domain a very refined grid in the vicinity of pipeline is built with a coarser zone away from it the quadrilateral element is adopted with the size of 0 5 0 5 m as satisfactory the convergence tests on the mesh size have been performed to achieve the balance between the accuracy and efficiency of the simulation through the trial and error analysis on the mesh size furthermore the zero thickness elements are employed to model the contact behavior between pipeline and the surrounding seabed day and potts 1994 the stokes wave theories are used to model the complex hydraulic interactions of wave and current specifically the hsu et al s 2009 third order analytical solution is employed to simulate the periodic fluid pressure p b at the seabed surface induced by the combined actions of wave and current as follows 26 p b ρ f g h 2 cosh β d 1 ω 2 β 2 h 2 2 u 0 k ω 0 cos β x ω t 3 ρ f h 2 8 ω 0 ω 0 u 0 β 2 sinh 4 β d g β 3 sinh 2 β d cos 2 β x ω t 3 ρ f β h 3 ω 0 ω 0 u 0 β 512 9 4 sinh 2 β d sinh 7 β d cos 3 β x ω t where β wave number in wave current interactions d water depth h wave height ω frequency of wave and u 0 velocity of current the dispersion equation is written by 27 ω ω 0 β h 2 ω 2 28 w h e r e ω 0 u 0 β g β tanh β d ω 2 9 8 sin h 2 β d 8 sin h 4 β d 64 sin h 4 β d ω 0 u 0 β when no current exists during the wave propagation i e u 0 0 m s the analytic equation 26 is reduced to the classic form of the third order nonlinear wave the analytical solution of the dynamic pressure p b is applied as the stress boundary at the seabed surface furthermore the following boundary conditions according to the principle of repeatability are also admitted zienkiewicz and scott 1972 ye and jeng 2012 29 σ zz σ zx 0 a t z 0 30 u x 0 u z 0 p z 0 a t z d 31 p n 0 a t r x x 0 2 z z 0 2 r where r radius of the pipeline 4 2 numerical implementation based on the explicit algorithm method and parallel computing technology in flac3d code platform itasca 2006 the proposed fully coupled effective stress method for dynamic soil structure analyses in this study was implemented with the help of embedded biot dynamic consolidation equations darcy hydraulic flow and pore fluid model to implement the proposed theory in the form of a stress update algorithm a user defined material subroutine for the proposed constitutive model was compiled in c language to define the state of the material at the gauss points within each element the inclusion of the generalized skeleton degradation allows for changes in soil shear modulus due to epwp generation the liquefaction induced geometric nonlinearity i e large deformation is handled by updating the model grid at each time step corresponding to deformation within the framework of cyclic plasticity and solid mechanics in conjunction with the embedded updated lagrangian ul method in the flac3d code furthermore the dynamic pressure induced by combined wave and current actions is applied at the seabed surface with the aid of fish programming language embedded within flac3d code prior to the dynamic analysis procedure the static step is performed to calculate in situ geostatic stress balance for the gravity of soil skeleton and the hydrostatic pore pressure p 0 to obtain the initial effective consolidation stress of the computational domain especially in the near field of pipeline note that the hydrostatic pore pressure p 0 at the seabed surface is determined by the water depth the flow chart in fig 4 outlines the schematic algorithm adopted for each calculation time step illustrating the logic which couples the soil skeleton deformation and epwp buildup the time step size δt is taken as 10 5 s to achieve convergence for the solution in this explicit stress flow coupled analysis 4 3 model validation prior to the large scale modeling of the pipeline seabed system subject to a combined wave and current action it is essential to perform element test to validate the constitutive model over the prescribed stress paths to do so an undrained strain controlled cyclic triaxial scct test of saturated fine sand is simulated by a single element using the proposed cyclic plasticity model chen et al 2019 note that only one element is built to eliminate the discretisation error as the flac3d code only updates the stress strain state by integrating the constitutive model over the prescribed loading path potts and zdravkovic 1999 the input parameters are given in table 1 the comparison between the measured and calculated results is shown in fig 5 which clearly indicates the overall trend of the calculated residual epwp ratio following the experimental data the deviator stress σ d σ z σ x calculated by the proposed model is quite consistent with that obtained from undrained scct tests similar results can also be obtained by comparing the axial stress strain hysteresis loops as the more detailed comparison of the axial stress strain hysteresis loops shows in fig 5c interestingly the oscillatory amplitudes of σ d continuously decrease significant degradation of the solid skeleton is apparent this demonstrates that the present model can well capture the effects of residual epwp accumulation on the transient shear stress strain response of soil skeleton the continuous reduction in the σ d eventually leads to a σ z σ x state triggering soil liquefaction in association with the marked decrease in the mean normal effective stress the initial axial stress strain curve and the hysteresis loops match well even when the soil becomes liquefied as plotted in fig 6 independent calibrations are performed for the proposed model against the experimental data of ishibashi et al s 1985 strain controlled cyclic torsional simple shear ctss tests on the ottawa silica sand and dobry et al s 1985 strain controlled cyclic direct simple shear cdss tests on the banding sand it is seen that the present model can satisfactorily model the epwp response of different sands 5 results and discussion this section focuses on the investigations of the liquefaction triggering mechanism of seabed in the near field of pipeline and the resulting float of pipeline under wave and current propagations wave and current are two common environmental loads on the seabed and interact with each other the computational parameters are given in table 2 the assumed soil parameters are also listed in the same table which are directly calibrated from the cyclic laboratory tests of undisturbed marine silt i e the shear stiffness and damping ratio over a wide range of shear strain as shown in fig 7 5 1 wave current induced liquefaction around pipeline in this section the effect of current is investigated by comparing the seabed response for the cases under wave loading with and without a current fig 8 shows the liquefaction progression of the seabed around the pipeline it is seen that the wave current interactions have negligible influence on the progressive patterns of liquefaction in the near field of pipeline as compared with the case under only wave loading however the wave induced liquefied zone around the pipeline is significantly expanded by the combined actions of current the generation rate of liquefaction is also amplified due to the presence of current the residual liquefaction is a result of the buildup of epwp fig 9 shows the development of the wave induced epwp versus time for the cases with and without a current as seen in this figure the epwp of the seabed surrounding the pipeline buildup faster for the case with a following current for instance at the pipeline sidewall the residual epwp generates rapidly and it only takes 26 wave cycles to trigger seabed liquefaction while 40 wave cycles are required to cause liquefaction for the case without a current furthermore the impact of current upon the seabed response at the pipeline bottom is more severe than those at the other positions notably the epwp shows different accumulation pattern underlying the pipeline the epwp builds up gently to the maximum value at the 5th wave cycle or so and then falls rapidly to negative values this specific response pattern of epwp can be traced back to the intensive seabed pipeline interactions due to the fact that the present model incorporates the liquefaction induced geometric nonlinearity the pipeline uplift can generate separation at the pipeline seabed interface and hence cause the following pore water dissipation migration around the pipeline this eventually induces the generation of negative epwp at the underlying soil which is consistent with the findings of centrifuge tests by chou et al 2011 and chian et al 2014 5 2 liquefaction induced uplift of pipeline fig 10 plots the time histories of the pipeline uplift during wave propagation with and without a current from figs 7 and 10 it can be seen that the uplift initiates when full liquefaction occurs surrounding the structure this is because that the liquefied seabed is unstable the continuous disturbance in terms of wave and current loadings leads to an abrupt increase in the uplift rate of pipeline notably the pipeline experiences obvious oscillation during the movement process indicating significant force fluctuation acting on the structure it is seen that unlike the 1d pipeline uplift pattern for the case under only wave loading the wave current interactions induce both vertical and horizontal movement of pipeline with more intensive oscillation the uplift suffered by the pipeline for the case under wave and current loading is about 71 cm amplifying 3 times of the uplift magnitude in the case under only wave loadings fig 11 plots the displacement vector of the seabed around pipeline at the time of 750 s as for the case without a current the liquefied soils surrounding the pipeline displace toward the bottom which further aggravates the uplift of pipeline as illustrated in this figure the combined current actions have pronounced influences on the wave induced displacement pattern of the subsoils at the vicinity of pipeline in terms of both magnitudes and directions 5 3 soil pipeline interactions due to wave current actions laboratory evidence indicates that natural marine deposits exhibit significant stress path dependent behavior the effect of wave current interactions can be comprehensively interpreted by the induced stress path and the cyclic response of soil element at the vicinity of pipeline fig 12 plots the cyclic stress paths in the soil element around the pipeline within the shear stress space τ xz σ z σ x 2 it is seen that the wave induced cyclic shear stress coincides well with the typical circular path as shown in fig 12a in which the principal stress axis continuously rotates with a constant deviatoric stress ishihara and towhata 1983 as shown in fig 12b the stress path under the combined wave and current actions forms a cardioid shape in the τ xz σ z σ x 2 space indicating that the magnitude of deviatoric stress cyclically changes in association with continuous principal stress axis rotation this is even more so at the pipeline sidewall as seen in fig 12c and d clearly the induced stress paths at the pipeline bottom follow practically the same traces for the cases with and without a current with a general trend of continuous decrease towards the zero stress state i e liquefaction initialization from fig 12f and e it can be observed that the combined actions of current trigger liquefaction underlying the pipeline at 25 cycles while it takes 50 cycles for the case under only wave loading indeed the liquefaction induced pipeline uplift is the result of extensive plastic flow deformation of soil skeleton and pore water dissipation migration as shown in fig 13 b the combined current action causes extensive plastic flow deformation achieving 10 deviatoric strain concentrated in the vicinity of pipeline the so called flow type failure mode can be identified in the cyclic stress strain curve for the case under wave and current loading yang and sze 2011 the failure is suddenly triggered even though the epwp generates gradually as seen in fig 9 which is featured by the triggering of abrupt strain with no stress reversals however one can see in fig 13a that sufficient stress reversals can still occur at high deviatoric strain level of 10 2 and the flow type failure does not happen even at post liquefaction stage by comparing fig 13a and b it can be concluded that the pipeline seabed interactions become even more pronounced for the failure of seabed and the induced pipeline response considering the combined action of current with wave 6 conclusions the effect of an ocean current on the wave induced liquefaction progression in the near field of pipeline is investigated within the biot s dynamic consolidation theory and cyclic plasticity permitting an explicit time matching analysis of the intensive soil structure interactions in the liquefiable seabed with the aid of flac3d 5 0 code the main conclusions are summarized below 1 the main features characterizing the liquefaction behavior of seabed and the evolving seabed pipeline interactions are incorporated into the proposed cyclic plasticity modelling method a model calibration procedure was outlined against cyclic laboratory sample test data selected representative simulation results were presented to demonstrate the model performance 2 the influences of current on the wave induced seabed liquefaction process in the near field of pipeline are examined by numerical examples the coexistence of ocean current significantly changes the original characteristics of wave induced seabed liquefaction in the vicinity of pipeline accelerating the epwp buildup and reducing the liquefaction triggering resistance 3 the disturbance in terms of wave and current propagation triggers an extensive increase of the uplift rate after liquefaction initialization the pipeline experiences obvious oscillation during the uplift process indicating significant force fluctuation on the structure the combined current actions have pronounced influence on the uplift pattern in magnitude and direction with regard to the case under only wave loading 4 the soil structure interactions impose intensive loading boundaries in the near field of pipeline the combined wave and current actions generate the cyclic change of the deviatoric stress magnitude in association with continuous principal stress axis rotation in the soil element resulting in flow type failure of seabed the liquefaction triggering of seabed and the consequence for the dynamic response of pipeline in the wave and current environment are interpreted credit authorship contribution statement kai zhao conceptualization methodology writing original draft funding acquisition qiuzhe wang software data curation visualization investigation validation su chen visualization investigation supervision haiyang zhuang writing review editing supervision guoxing chen writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was funded by the national natural science foundation of china 51978335 and the national key r d project of china 2017yfc1500403 the authors gratefully acknowledge this ﬁnancial support 
20768,this paper is concerned with a multi underactuated auv three dimensional 3 d formation control method with a multi time scale structure in the presence of uncertain nonlinearities and environmental disturbances first a double layer independent position velocity fixed topology is adopted to overcome the drawback of narrow bandwidth of underwater communication then an extended high gain observer ehgo is utilized to provide compensation to uncertain nonlinearities and environmental disturbances moreover the consensus theory is incorporated with an integral sliding mode controller to guarantee that the multi underactuated auv system can track the desired trajectory while maintaining the predefined formation in addition based on the analysis for the whole formation control system the extended high gain observer is on the ultra fast time scale the integral sliding mode controller is on the fast time scale and the system state converges to the desired state on the slow time scale such multi time scale structure allows independent analysis of the dynamics in each time scale and the singular perturbation method is effectively utilized to establish the exponential stability of the equilibrium finally simulation results are presented to illustrate the control performance keywords multi underactuated auv system multi time scale singular perturbation uncertainties integral sliding mode control extended high gain observer 1 introduction the formation of autonomous underwater vehicle auv has the advantages of strong load capacity high mission efficiency and good system redundancy therefore it has become an important tool for marine survey port investigation mine detection and submarine pipeline laying and has attracted the interest of a large number of researchers evans and nahon 2004 li and lee 2005 lapierre and soetanto 2007 woolsey and techy 2009 the research focuses on the following aspects 1 the underactuated characteristics of auv system 2 the parameter uncertainty of auv system model 3 the instability of underwater communication 4 the design of formation controller and consensus theory the dynamic models of auv are usually underactuated highly nonlinear and coupled and its hydrodynamic parameters are often uncertain especially when auv may be subjected to unknown disturbances from ocean currents fossen 1994 which makes the formation control of multi underactuated auv become an arduous task breakthroughs have been made in the field of underactuated auv formation control in a decade aguiar and hespanha 2004 yuh 2000 because the auv system is a typical nonlinear system many nonlinear control methods such as backstepping method xu et al 2014 lapierre 2009 sliding mode control xu et al 2015 yan et al 2019 zhang and cao 2015 adaptive control sun et al 2018 wang et al 2020a feedback linearization method zhou et al 2017 pan et al 2011 and so on have been deeply studied to design controllers for motion control or attitude control of auv however in practical application the uncertain parameters in the auv system model will have a negative impact on the controller so a variety of adaptive methods are utilized to compensate the uncertainties and external disturbances of the system to name a few neural network method shojaei and arefi 2015 zhang et al 2009 fuzzy logic method wu et al 2015 bessa et al 2010 and conditional integrator seshagiri and khalil 2005 burger et al 2009 although the auv unit has been deeply studied for specific applications such as ocean sampling mapping minesweeping seafloor exploration multi auv cooperative operation is beneficial to improve efficiency and increase operation area and provide redundancy in case of failure one of the basic problems of multi auv cooperation is formation control namely to complete the assigned tasks while maintaining the formation based on thorough review of the literature there are several different strategies to achieve the formation control for multi auv system including artificial potential field method pan et al 2017 virtual structure method yan et al 2015 and leader following method li et al 2018 li and du 2018 ihle et al 2006 cui et al 2010 among the above strategies the leader following control method seems to be the most popular one however the above references did not take the underwater weak communication environment and the actual situation of low bandwidth into account in order to solve the problem of underwater communication delay of auv formation a h 2 h feedback control method based on feedforward control is proposed in millan et al 2014 which can ensure that the uuv formation still has effective formation performance in the case of communication delay and data packet loss in xu and li 2013 under the condition of limited communication a submarine formation maintenance control method based on line of sight los method is proposed which can maintain formation stability in the case of short interruption and data packet loss in yang et al 2013 a robust coordinated control method for stable convergence of constant bounded time delay is proposed by decoupling algorithm under the condition of time delay yan et al 2017 proposed to use markov random switching communication topology to simulate and compensate for the drawbacks of underwater acoustic communication and proposes a position velocity double layer topology to reduce the communication bandwidth ensure that the auv will not lose contact in the formation and improve the stability of the system however for a practical application oriented formation controller should not only satisfy the stability of the formation system but also improve its robustness and adaptability to system uncertain nonlinearities and unknown environment disturbances therefore under the leader following strategy a large number of robust and adaptive techniques are introduced such as neural network fuzzy control sliding mode control and so on wang et al 2020b proposed a filter backstepping based neural adaptive formation tracking control method the calculation explosion of the traditional backstepping method is avoided by using the filtering method and the adaptive neural network is used to improve the adaptive ability of the controller asif et al 2017 proposed a formation controller based on fast integral terminal sliding mode control which solved the formation problem without considering the leader s speed information although the above sliding mode control schemes had a good control effect the symbol terms used in the above sliding mode controller are usually discontinuous which will bring chattering of the control system and reduce the robustness of the system a sliding mode formation control strategy using backstepping method and adaptive neural network is proposed in wang et al 2020a and a continuous pi function is designed to avoid the influence of chattering in standard sliding mode control method a control method based on approximation is proposed in cui et al 2010 to deal with the uncertain parameters in the model and the external environment disturbance suffered by the follower auv however to the best of authors knowledge although neural networks and fuzzy adaptive controllers have advantages in approximating uncertainties and disturbances the adjustment of their learning parameters is still a challenging task in practical application cui et al 2017 to this end another method proposed in cui et al 2017 to deal with unknown nonlinearity is to design an observer to estimate the unknown external disturbance of auv and then design a controller to compensate the estimated disturbance in fernandes et al 2015 an observer based high gain output feedback motion control is proposed which takes unmodeled dynamics and measurement errors of the observed rov and unknown external environment disturbances into account the system disturbances can be estimated by extending the order of the high gain observer and such an observer is an extended high gain observer ehgo compared with other extended observers ehgo has the following two unique characteristics first it does not need the disturbance of the system to be slow time varying because the dynamic performance of ehgo is faster than that of the whole system khalil 2017 second ehgo can be used to observe disturbances caused by model uncertainties and external disturbances freidovich and khalil 2008 it is well established that for some physical systems with underactuated characteristics singularly perturbed system theory is regarded as a powerful tool for controller analysis and design in essence this method is based on the convergent solutions of some differential equations on two or more time scales in this case the time scale separation phenomenon of full dynamics leads to two low order subsystems slow reduced order and fast boundary layer subsystems which can be stable respectively so that the control problem is relatively simplified khalil 2019 freidovich and khalil 2008 khalil 2017a b this analysis method has been deeply studied in inverted pendulum system khalil 2017a b and quadrotor uav system gonzález vázquez and moreno valenzuela 2013 zhou et al 2019 therefore using singular perturbation theory and time scale theory it is significant to make some attempts to solve the problem of time scale separation in underactuated auv a dual time scale singularly perturbed control law is proposed in ren et al 2014 for ship rudder roll stabilization rrs in yi et al 2016 the singular perturbation method is used to study the horizontal plane path tracking control of underactuated surface ships and the unmodeled dynamics of the system are taken into account the path tracking control problem of auv on the vertical surface is concerned in lei 2020 and the tracking error equation is decomposed in two time scales in which the attitude angle error is a fast system and the position error is a slow system the controllers are designed independently by using the singular perturbation method all these references show the subtle and powerful ability of singular perturbation theory in the field of ocean engineering however the research on underactuated auv formation control under multi time scale structure is rarely reported in the public literature motivated by aforementioned considerations this paper studies the problem of coordinated formation and time scale separation for a class of underactuated auvs in the presence of uncertain nonlinearities and environmental disturbances as well limited underwater acoustic communication compared with previous representative literatures the main novelties and contributions of this paper are in the following aspects i the underactuated auv formation system is uniquely analyzed by combining the multi time scale decomposition phenomenon and the singular perturbation theory ii the dynamic analysis of the system is carried out independently in each time scale which significantly reduces the difficulty of designing the controller and analyzing the stability of the system iii the proposed formation controller combines the consensus theory and the integral sliding mode controller so that the formation system can accurately track the desired trajectory while maintaining the stability of the formation system iv an extended high gain observer ehgo is designed to solve the problems of the uncertain nonlinearities and environmental disturbances in the system the remainder of the paper is organized as follows section 2 formulates the mathematical model of underactuated auvs with uncertain dynamics and some useful notations and preliminaries section 3 introduces the design of the formation controller and section 4 states the time scale decomposition and closed loop system stability analysis simulation results and conclusions are given in section 5 and 6 respectively 2 preliminaries and problem formulation this section describes the mathematical model of the underactuated auvs and derives the state space equation of the underactuated auvs moreover this section provides the preliminaries of graph theory and double layer communication topology and defines the formation 2 1 preliminaries graph theory is an effective tool to describe the communication relationship within the formation the topological graph describing the communication relationship among the members of the formation is divided into directed graph and undirected graph in this paper the directed graph is used to express the communication relationship between the members of the auv formation supposing there are n members within the formation define g v ε a to represent the communication topology of the formation inspired by yan et al 2016 yan et al 2017 the communication topology is divided into location communication topology and speed communication topology and expressed as follows g p v p ε p a p g v v v ε v a v where v p v represents the set of vertices v p v 1 2 n and in this paper the vertices are auvs ε p v represents the set between pairs of vertices ε p v v p v v p v a p v denotes the adjacency matrix of the graph a p v a i j r n n satisfies that if there is i j ε p v then a i j 1 or a i j 0 the adjacency matrix a a i j t r n n satisfies d i i n j 1 n a j i d i o u t j 1 n a i j where d i i n and d i o u t are the in degree and out degree of the node or auv define the in degree matrix as a diagonal matrix d d i a g d 1 i n d 2 i n d n i n if the matrix l l i j r n n satisfies l d a then the matrix l r n n is defined as the laplacian matrix of the directed graph g v ε a according to the definition of laplacian matrix l contains a zero eigenvalue and the eigenvector corresponding to the eigenvalue is 1 n 1 1 1 r n for a directed graph there is only one zero eigenvalue if and only if the graph g v ε a is strongly connected in a directed graph g v ε a all vertices except a special vertex have a parent then this vertex without a parent is called a root and there must be a directed path connecting all other vertices at the root then such a graph is called a directed tree the directed tree must be from the root as the starting point if there is at least one vertex with a directed path to all other vertices the graph has a directed spanning tree obviously the laplacian matrix l g in this paper is invertible assumption 1 in this paper the communication graphs are balanced yan et al 2017 2 2 auv model inspired by aguiar and hespanha 2004 lapierre and soetanto 2007 do 2009 shojaei and arefi 2015 xia et al 2020 the 5 degree of freedom dof dynamics and kinematics models for a group of underactuated auvs can be presented as follows 1a η i j η i v i 1b m i v i c i v i v i d i v i v i g η i τ i the expression of the main parameters is as follows and the detailed meaning of each parameter is the same as that of above references m i is the inertia matrix c i v i is the coriolis and centripetal matrix d i v i is the hydrodynamic damping matrix and j η i is the transformation matrix from the o x y z to the e ξ η ζ respectively are given by 2 m i m 11 0 0 0 0 0 m 22 0 0 0 0 0 m 33 0 0 0 0 0 m 55 0 0 0 0 0 m 66 3 c i v i 0 0 0 m 33 w m 22 v 0 0 0 0 m 11 u 0 0 0 m 11 u 0 m 33 w 0 m 11 u 0 0 m 22 v m 33 u 0 0 0 4 d i v i d 11 0 0 0 0 0 d 22 0 0 0 0 0 d 33 0 0 0 0 0 d 55 0 0 0 0 0 d 66 5 j η i s 0 0 t s cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t 1 0 0 1 cos θ τ i τ u 0 0 τ q τ r t and τ i d τ d u τ d v τ d w τ d q τ d r t represent the control inputs and environmental disturbances respectively g η 0 0 0 ρ g g m l sin θ 0 t is the static and static moment matrix based on the underactuated auv model shown in 1 considering a group of n underactuated auvs as shown in fig 1 taking the second time derivative of η yields η j η v j η v cui et al 2017 and taking the coefficients mentioned above into it we can obtain 6 x i g x i θ i ψ i m 11 τ u i f x i y i g y i θ i ψ i m 11 τ u i f y i z i g z i θ i m 11 τ u i f z i θ i 1 m 55 τ q i f θ i ψ i g ψ i θ i m 66 τ r i f ψ i where 7 g x i θ i ψ i cos ψ i cos θ i g y i θ i ψ i sin ψ i cos θ i g z i θ i sin θ i g ψ i θ i 1 cos θ i define the first derivative of lumped system uncertainties f x i y i z i θ i ψ i as f d x i d y i d z i d θ i d ψ i which satisfies f d x i d y i d z i d θ i d ψ i f x i y i z i θ i ψ i and assuming that it satisfies the lipschitz condition the lumped system uncertainties of the underactuated auv system is due to the uncertainty of hydrodynamic coefficient modeling error and parameter perturbation and environmental disturbances according to lee et al 2015 we define state space variables x 1 i x i x 2 i x i y 1 i y i y 2 i y i z 1 i z i z 2 i z i θ 1 i θ i θ 2 i θ i ψ 1 i ψ i ψ 2 i ψ i therefore the system 6 can be expressed as 8 x 1 i x 2 i x 2 i g x i θ i ψ i m 11 τ u i f x i f x i f d x i y 1 i y 2 i y 2 i g y i θ i ψ i m 11 τ u i f y i f y i f d y i z 1 i z 2 i z 2 i g z i θ i m 11 τ u i f z i f z i f d z i 9 θ 1 i θ 2 i θ 2 i 1 m 55 τ q i f θ i f θ i f d θ i ψ 1 i ψ 2 i ψ 2 i g ψ i θ i m 66 τ r i f ψ i f ψ i f d ψ i the desired trajectory is η d x d y d z d θ d ψ d t and the pitch and yaw angles are θ d arctan 2 z d v t and ψ d arctan 2 y d x d respectively where v t x d 2 y d 2 assumption 2 b the desired trajectory is a smooth curve and any point on the curve is differentiable and the second derivative is bounded the spatial formation shape can be describe by a vector δ δ 1 t δ 2 t δ n t t ℝ 3 n where δ i δ i x δ i y δ i z t is the piecewise continuously formation vector for a u v i the motion state vector of the a u v i at some point is ℓ i t p i t v i t where p i t x 1 i t y 1 i t z 1 i t such that 10 lim t x 1 i t δ i x x d t 0 lim t y 1 i t δ i y y d t 0 lim t z 1 i t δ i z z d t 0 as shown in fig 1 for two adjacent a u v i and a u v j there exists 11 δ i j δ i j x δ i j y δ i j z t δ j x δ i x δ j y δ i y δ j z δ i z t for the leader following formation the leader l p l t v i t is defined as the reference point of the formation which satisfies lim t p l t η d 0 therefore the desired state of each follower auv is f i p i t δ i j v i t the desired point is also fixed relative to the reference point which satisfies lim t p i t p l t δ i j therefore it can also be judged that if each follower auv can converge to the desired point then each follower auv can converge to the leader and the leader can converge to the desired trajectory to this end it can be obtained the definition as follows definition 1 consider the formation of n 1 follower auvs and a leader auv the desired trajectory is η d the state of the auv is ξ i p i t v i t if the state of auv satisfies lim t p i t η d 0 it is said that the leader following formation can achieve consensus and guarantee the convergence and stability of the formation system 3 main results the purpose of this section is to solve the formation problem of multi underactuated auv system with uncertain nonlinearities and environmental disturbances in 3 d space under the framework of multi time scale theory and singularly perturbed systems the main control objective is to estimate the uncertainties of the system by designing an extended high gain observer so as to provide compensation to lumped system uncertainties and improve the robustness of the system therefore from an overall perspective the extended state observer has the fastest and the first time scale then the position and attitude controller designed by combining graph theory and integral sliding mode controller has the second time scale finally the multi underactuated auv system maintains the desired formation has the slowest and third time scale fig 2 depicts the control system structure block diagram of the a u v i 3 1 singularly perturbed system dynamics in order to facilitate the design of the controller the position and attitude error variables are defined as follows according to the formation vector 12 x 1 i x 1 i δ i x x d x 2 i x 2 i x d y 1 i y 1 i δ i y y d y 2 i y 2 i y d z 1 i z 1 i δ i z z d z 2 i z 2 i z d 13 ε 2 ε 1 2 θ 1 i θ 1 i θ d ε ε 1 θ 2 i θ 2 i θ d ε 2 ψ 1 i ψ 1 i ψ d ε ψ 2 i ψ 2 i ψ d where ε and ε 1 are positive constant denoted as perturbing parameters which satisfies ε 1 ε 1 1 here ε and ε 1 are artificial small parameters in order to provide a singular perturbation analysis taking the time derivative of 12 and 13 and substituting 8 and 9 into it yields 14 x 1 i x 2 i x 2 i f x i g x i θ i ψ i m 11 τ u i x d y 1 i y 2 i y 2 i g y i θ i ψ i m 11 τ u i f y i y d z 1 i z 2 i z 2 i g z i θ i m 11 τ u i f z i z d 15 ε ψ 1 i ψ 2 i ε ψ 2 i g ψ i θ i m 66 τ r i f ψ i ψ d ε ε 1 θ 1 i θ 2 i ε ε 1 θ 2 i 1 m 55 τ q i f θ i θ d then it is obtained that the error system 15 16 is a standard singularly perturbed system with three time scales such as p i f 1 p i ψ i θ i τ u i f ε ψ i f 2 p i ψ i θ i τ r i f ε ε 1 θ i f 3 p i ψ i θ i τ q i f p i x 1 i x 2 i y 1 i y 2 i z 1 i z 2 i denotes the position state τ denotes the control input and f represents the lumped system uncertainties obviously when the underactuated auv system forms a stable formation it is necessary to guarantee that each auv in the system has a stable attitude 3 2 extended high gain observer according to the reference lee et al 2015 for the system model shown in 8 and 9 the ehgo can be designed in the following x ˆ 1 i x ˆ 2 i l s 1 σ 1 x 1 i x ˆ 1 i x ˆ 2 i f ˆ x i g x i θ ˆ i ψ ˆ i τ u i m 11 l s 2 σ 1 2 x 1 i x ˆ 1 i f ˆ x i l s 3 σ 1 3 x 1 i x ˆ 1 i y ˆ 1 i y ˆ 2 i l s 1 σ 1 y 1 i y ˆ 1 i y ˆ 2 i f ˆ y i g y i θ ˆ i ψ ˆ i τ u i m 11 l s 2 σ 1 2 y 1 i y ˆ 1 i f ˆ y i l s 3 σ 1 3 y 1 i y ˆ 1 i 16 z ˆ 1 i z ˆ 2 i l s 1 σ 1 z 1 i z ˆ 1 i z ˆ 2 i f ˆ z i g z i θ ˆ i τ u i m 11 l s 2 σ 1 2 z 1 i z ˆ 1 i f ˆ z i l s 3 σ 1 3 z 1 i z ˆ 1 i 17 ψ ˆ 1 i ψ ˆ 2 i l f 1 σ 2 ψ 1 i ψ ˆ 1 i ψ ˆ 2 i f ˆ ψ i g ψ i θ ˆ i τ r i m 66 l f 2 σ 2 2 ψ 1 i ψ ˆ 1 i f ˆ ψ i l f 3 σ 2 3 ψ 1 i ψ ˆ 1 i θ ˆ 1 i θ ˆ 2 i l f 1 σ 3 θ 1 i θ ˆ 1 i θ ˆ 2 i f ˆ θ i τ q i m 55 l f 2 σ 3 2 θ 1 i θ ˆ 1 i f ˆ θ i l f 3 σ 3 3 θ 1 i θ ˆ 1 i where the constants l i j i s f j 1 2 3 are chosen such that the polynomials s 3 l i 1 s 2 l i 2 s l i 3 are hurwitz σ 1 2 3 are small positive constants remark 1 if there is a difference between the initial state and the initial estimated state of the system the peaking phenomenon can be generated for a very small σ j this is a drawback of the ehgos therefore according to the reference khalil 2017a b the estimation error x i x i x ˆ i is constrained in the following inequalities x j i max a σ j 1 x 0 e b t σ σ 4 j c m where a b c m are some positive constant remark 2 it is known from the zhou et al 2019 that there is a time scale separation phenomenon in the ehgo in which the attitude ehgo subsystem is a fast subsystem the position ehgo subsystem is a slow subsystem and in the attitude ehgo subsystem the pitch ehgo subsystem is faster than the yaw ehgo subsystem or more specifically the pitch observation θ ˆ is used in the yaw ehgo subsystem g ψ i θ ˆ i and the attitude observation θ ˆ i and ψ ˆ i are also used in the position ehgo subsystem g x i θ ˆ i ψ ˆ i τ u i m 11 g y i θ ˆ i ψ ˆ i τ u i m 11 g z i θ ˆ i τ u i m 11 therefore the dynamic response of the pitch ehgo in the attitude ehgo should be faster than that of the yaw ehgo and the overall dynamic response of the attitude ehgo should be faster than that of the position ehgo lei 2020 furthermore the nonlinear input coefficient can be approximated more quickly to ensure the observation accuracy of the position ehgo therefore the perturbing parameters σ i 1 i 1 2 3 should satisfy σ 3 σ 2 1 and σ 2 σ 1 1 remark 3 the perturbing parameters ε and ε 1 should satisfy ε 1 and ε 1 1 simultaneously σ 1 ε ε 1 1 this requirement can be explained intuitively as follows since the observations of ehgos are used in the error feedback system 14 15 to design the integral sliding mode controller the dynamics of ehgos should be faster than the feedback dynamics lee et al 2015 3 3 integral sliding mode controller the main tasks in this section are as follows under the action of the directed topology graph g for the position and attitude error subsystem of multi underactuated auv system the integral sliding surface is designed under the framework of consensus theory so that the system state error variables can reach the sliding surface and quickly converge to 0 along the sliding surface in other words the integral sliding mode controller can guarantee that the auv in the system forms a stable formation in this paper the two layer independent topologies are g p v p ε p a p g v v v ε v a v respectively so according to the consensus theory yields 18 x p i l i g p x 1 i x v i l i g v x 2 i y p i l i g p y 1 i y v i l i g v y 2 i z p i l i g p z 1 i z v i l i g v z 2 i θ p i l i g p θ 1 i θ v i l i g v θ 2 i ψ p i l i g p ψ 1 i ψ v i l i g v ψ 2 i assumption 3 in the double layer independent topology set the topology graph corresponds to one to one so l i g l i g p l i g v exists at any time 18 can be redefined as follows 19 x p i j g i a i j x 1 i x 1 j x v i j g i a i j x 2 i x 2 j y p i j g i a i j y 1 i y 1 j y v i j g i a i j y 2 i y 2 j z p i j g i a i j z 1 i z 1 j z v i j g i a i j z 2 i z 2 j 20 θ p i j g i a i j θ 1 i θ 1 j θ v i j g i a i j θ 2 i θ 2 j ψ p i j g i a i j ψ 1 i ψ 1 j ψ v i j g i a i j ψ 2 i ψ 2 j to move on define integral sliding mode surface 21 s x i t x v i t x p i t 0 t α x x p i β x x v i d τ s y i t y v i t y p i t 0 t α y y p i β y y v i d τ s z i t z v i t z p i t 0 t α z z p i β z z v i d τ s θ i t ε ε 1 θ v i t ε ε 1 θ p i t 0 t α θ θ p i β θ θ v i d τ s ψ i t ε ψ v i t ε ψ p i t 0 t α ψ ψ p i β ψ ψ v i d τ in order to ensure that the state variables of the system converge rapidly when they are far away from and approach to the sliding surface the following form of exponential reaching law is adopted 22 s j i k j i s j i ρ j i s i g n s j i k j i ρ j i 0 w h e r e j x y z θ ψ therefore we design the integral sliding mode controller as follows 23 τ u i m 11 g x i θ i d ψ i d f ˆ x i k x i s x i ρ x i s i g n s x i a x i τ q i m 55 f ˆ θ i k θ i s θ i ρ θ i s i g n s θ i a θ i τ r i m 66 g ψ i θ i d f ˆ ψ i k ψ i s ψ i ρ ψ i s i g n s ψ i a ψ i here 8 9 14 15 16 17 have been used 24 w h e r e t h e a u x i l i a r y c o n t r o l var i a b l e i s a x i α x x p i β x x v i a θ i α θ θ p i β θ θ v i a ψ i α ψ ψ p i β ψ ψ v i 5 time scale decomposition and closed loop system stability analysis the stability analysis for each subsystem will be done by starting from the fastest one to the slowest one in that way a multi time scale structure of the multi underactuated auv system with uncertainties is depicted in fig 3 theorem 1 consider ehgos for the a u v i there always exist σ i which satisfies σ i σ i 0 such that the observation error of ehgos asymptotically stable at the origin proof for the attitude ehgo subsystem with fast dynamics define a series of attitude observation error variables δ θ i δ θ 1 i δ θ 2 i δ θ 3 i t δ ψ i δ ψ 1 i δ ψ 2 i δ ψ 3 i t where 25 δ θ 1 i θ 1 i θ ˆ 1 i σ 3 2 δ θ 2 i θ 1 i θ ˆ 1 i σ 3 δ θ 3 i f θ i f ˆ θ i 26 δ ψ 1 i ψ 1 i ψ ˆ 1 i σ 2 2 δ ψ 2 i ψ 1 i ψ ˆ 1 i σ 2 δ ψ 3 i f ψ i f ˆ ψ i for 24 define a stretched time scale κ 3 t σ 3 differentiating these variable with respect to κ 3 and substituting 9 and 17 into it yields the boundary layer system 27 d d κ 3 δ θ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ θ i σ 3 0 0 f d θ i then the pitch observation error state equation can be written as σ 3 δ θ i a θ δ θ i σ 3 b θ f d θ i where a θ l f 1 1 0 l f 2 0 1 l f 3 0 0 b θ 0 0 1 therefore there exists positive constants l f 1 δ l f 2 δ l f 3 such that a θ is hurwitz which guarantees the asymptotic convergence of the observation error to move on consider the following lyapunov function v δ θ i σ 3 δ θ i t p δ θ i p is the solution of the equation p a θ a θ t p t q 28 v δ θ i σ 3 δ θ i t p δ θ i σ 3 δ θ i t p δ θ i a θ δ θ i σ 3 b θ f d θ i t p δ θ i δ θ i t p a θ δ θ i σ 3 b θ f d θ i δ θ i t a θ t p δ θ i σ 3 b θ f d θ i t p δ θ i δ θ i t p a θ δ θ i σ 3 δ θ i t p b θ f d θ i δ θ i t a θ t p p a θ δ θ i 2 σ 3 δ θ i t p b θ f d θ i δ θ i t q δ θ i 2 σ 3 p b θ δ θ i f d θ i 29 λ m i n q δ θ i 2 2 σ 3 f θ i p b θ δ θ i where λ m i n q is the minimum eigenvalue of q therefore the convergence condition of the observer is 30 δ θ i 2 σ 3 f θ i λ m i n q 1 p b θ from 30 it can be observed that the convergence rate of δ θ i is related to the σ 3 and the smaller the σ 3 is the faster the convergence speed of δ θ i is and with the decrease of σ 3 the observation error asymptotically converges to 0 then let σ 3 0 according to the theorem 1 in the freidovich and khalil 2008 there exists 31 δ θ i o σ 3 o t σ 3 therefore after a short transient period t σ 3 it can be concluded that δ θ i become of the order o σ 3 in the bounded compact sets ω c v δ θ i σ 3 2 c 1 where c 1 is a positive constants namely a small enough σ 3 can be selected to satisfy σ 3 σ 3 0 to ensure that the pitch observation error variables are asymptotically stable and converge to the compact set khalil and pr 2014 after the above analysis it is clear that the quasi steady state system has the isolated roots δ θ ˆ i 0 noteworthily the specific value θ ˆ i is solved according to the isolated root which can be used to analyze the stability of the slow subsystem of the attitude ehgos after the peaking phenomenon the pitch observation error becomes the order o σ 3 with θ ˆ i θ i similarly for 26 define a stretched time scale κ 2 t σ 2 differentiating these variable s with respect to κ 2 and substituting 9 and 17 into it yields the boundary layer system 32 d d κ 2 δ ψ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ ψ i σ 2 0 0 f d ψ i 0 g ψ i θ i g ψ i θ ˆ i τ r i m 66 0 where the specific value θ ˆ i could make the nonlinear coefficients tend to zero with σ 3 0 then the reduced system is 33 d d κ 2 δ ψ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ ψ i σ 2 0 0 f d ψ i according to hou and fantoni 2018 the reduce system can be used to instead of the complete model in the study of the slow dynamic of ehgos evidenced by the same token it can be proved that the yaw observation error variable is bounded a small enough σ 2 can be selected to satisfy σ 2 σ 2 0 to ensure that the observation error variables are asymptotically stable and converge to the compact set khalil and pr 2014 there exists a specific value ψ ˆ i which satisfies the isolated root δ ψ ˆ i 0 with σ 2 0 the above specific values θ ˆ i and ψ ˆ i solved by isolated roots can be used for the stability analysis of position ehgos defining the observation error variable s of slow dynamic position observer subsystem δ x i δ x 1 i δ x 2 i δ x 3 i t δ y i δ y 1 i δ y 2 i δ y 3 i t δ z i δ z 1 i δ z 2 i δ z 3 i t where 34 δ x 1 i x 1 i x ˆ 1 i σ 1 2 δ x 2 i x 1 i x ˆ 1 i σ 1 δ x 3 i f x i f ˆ x i δ y 1 i y 1 i y ˆ 1 i σ 1 2 δ y 2 i y 1 i y ˆ 1 i σ 1 δ y 3 i f y i f ˆ y i δ z 1 i z 1 i z ˆ 1 i σ 1 2 δ z 2 i z 1 i z ˆ 1 i σ 1 δ z 3 i f z i f ˆ z i define a stretched time scale κ 1 t σ 1 differentiating 34 with respect to κ 1 yields d d κ 1 δ x i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ x i σ 1 0 0 f d x i 0 g x i θ i ψ i g x i θ ˆ i ψ ˆ i τ u i m 11 0 35 d d κ 1 δ y i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ y i σ 1 0 0 f d y i 0 g y i θ i ψ i g y i θ ˆ i ψ ˆ i τ u i m 11 0 d d κ 1 δ z i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ z i σ 1 0 0 f d z i 0 g z i θ i g z i θ ˆ i τ u i m 11 0 similarly it can be proved that the position observation error is bounded and a sufficiently small σ 1 satisfying σ 1 σ 1 0 can be selected to ensure the asymptotic stability of the observation error variable khalil and pr 2014 there exists specific values x ˆ 1 i y ˆ 1 i z ˆ 1 i which satisfies the isolated root δ x ˆ i 0 δ y ˆ i 0 δ z ˆ i 0 with σ 3 0 therefore after the ehgos reach quasi steady state hierarchically i e σ 1 σ 2 σ 3 0 a reduced system with three time scales can be obtained lee et al 2015 and the stability analysis will be presented in theorem 2 theorem 2 consider the system dynamics for the a u v i is a standard singularly perturbed system with three time scales there always exist ε and ε 1 which satisfies ε ε 0 and ε 1 ε 1 0 respectively such that the state space origin of the closed loop system 14 and 15 are asymptotically stable proof first in this proof the top down td method which is opposite to the bottom up bu method in esteban et al 2013 is used to decompose equations 14 and 15 in three time scales according to the singular perturbation theory three different time scales are regarded as two different two time scale singularly perturbed problems according to the singularly perturbed model proposed in section 3 1 p i is the slow variable ψ i is the fast variable θ i is the ultra fast variable for convenience denote the different subsystem combinations to name a few p i for the slow subsystem ψ i for the fast subsystem θ i for the ultra fast subsystem ψ i θ i for the fast ultra fast subsystem first considering the singular perturbation parameters ε at the top define a stretched time scale κ 0 t ε it can be obtained a one dimensional subsystem reduced order p i subsystem and a two dimensional subsystem boundary layer ψ i θ i subsystem as follows p i p i f 1 p i f 2 p i f 3 p i f 2 p i τ u i f ψ i θ i d d κ 0 ψ i f 2 p i ψ i κ 0 θ i κ 0 τ r i f ε 1 d d κ 0 θ i f 3 p i ψ i κ 0 θ i κ 0 τ q i f p i is regarded as constant in boundary layer system ψ i θ i while f 2 p i and f 3 p i f 2 p i represents the quasi steady state of boundary layer system ψ i θ i that is when ε 0 such that f 3 p i ψ i θ i τ q i f 0 f 2 p i ψ i f 3 p i ψ i τ r i f 0 θ i f 3 p i ψ i f 3 p i f 2 p i ψ i f 2 p i esteban et al 2013 then considering the singular perturbation parameter ε 1 in the boundary layer system ψ i θ i define a stretched time scale κ κ 0 ε 1 and obtaining two one dimensional subsystems the reduced order subsystem ψ i and the boundary layer system θ i as a result yields ψ i d d κ 0 ψ i f 2 p i ψ i κ 0 f 3 p i ψ i κ 0 τ r i f θ i d d κ θ i f 3 p i ψ i θ i κ τ q i f the function f 3 p i ψ i κ 0 in the reduced order ψ i system represents the quasi steady state of the boundary layer θ i system when ε 1 0 f 3 p i ψ i θ i 0 θ i f 3 p i ψ i where p i and ψ i are regarded as constant this concludes the td method after using the above method to decompose the three time scales the stability of each subsystem can be analyzed independently which considerably simplifies the stability analysis of the closed loop system the following recalling that the tracking error system dynamics for the a u v i 14 and 15 after the above time scale decomposition according to kokotovic et al 1987 and lei 2020 the closed loop system 14 and 15 have the unique and isolated equilibrium at the origin i e p i 0 θ i 0 ψ i 0 we define a stretched time scale κ 0 t ε differentiating 15 with respect to κ 0 yields boundary layer systems 36 ε 1 d d κ 0 θ 1 i θ 2 i ε 1 d d κ 0 θ 2 i 1 m 55 τ q i f ˆ θ i θ d 37 d d κ 0 ψ 1 i ψ 2 i d d κ 0 ψ 2 i g ψ i θ ˆ i m 66 τ r i f ˆ ψ i ψ d setting ε 0 it can be obtained the solution of quasi steady state θ i f 3 p i ψ i f 3 p i f 2 p i 0 ψ i f 2 p i 0 is θ ˆ i d ψ ˆ i d substituting it into 14 yields the reduced order system x 1 i x 2 i x 2 i f ˆ x i g x i θ ˆ i d ψ ˆ i d m 11 τ u i x d 38 y 1 i y 2 i y 2 i f ˆ y i g y i θ ˆ i d ψ ˆ i d m 11 τ u i y d z 1 i z 2 i z 2 i f ˆ z i g z i θ ˆ i d m 11 τ u i z d under the integral sliding mode controller the reduced order subsystem is asymptotically stable the detailed proof is given in theorem 4 similarly boundary layer systems 36 and 37 can be treated again like a two time scale singular perturbed problem define a stretched time scale κ κ 0 ε 1 differentiating 36 with respect to κ yields boundary layer systems 39 d d κ θ 1 i θ 2 i d d κ θ 2 i 1 m 55 τ q i f ˆ θ i θ d setting ε 1 0 the solution of quasi steady state θ i f 3 p i ψ i f 3 p i f 2 p i 0 is θ ˆ i d substituting it into 37 yields the reduced order system 40 ψ 1 i ψ 2 i ψ 2 i g ψ i θ ˆ i d m 66 τ r i f ˆ ψ i ψ d the stability analysis of the system shown in equations 39 and 40 is given in theorem 3 the above proof satisfies the sufficient conditions of theorem 11 4 in khalil 2019 to claim that there exists some constants ε and ε 1 satisfy ε ε 0 and ε 1 ε 1 0 respectively guarantee that the systems 14 and 15 are asymptotically stable this complete the proof theorem 3 under the directed position communication topology g p v p ε p a p and speed communication topology g v v v ε v a v consider the fast subsystem 36 and 37 of the multi underactuated auv formation system under the action of the integral sliding mode controller 23 and the auxiliary control variable 24 there exists α ψ α θ β ψ β θ which guarantee the fast subsystems 36 and 37 asymptotically stable or more specifically the whole multi underactuated auv formation system has a consensus and stable attitude proof without loss of generality this section only provide the proof of 36 first consider a positive definite lyapunov function 41 v θ 1 2 s θ t s θ s θ s θ 1 s θ 2 s θ 3 t taking the first time derivative of 41 yields v θ s θ t k θ i s θ i ρ θ i s i g n s θ i 0 the integral sliding mode controller 23 guarantee s that the pitch subsystem state can be reached and maintained on the sliding surface s θ i next when the system state is on the sliding surface i e s θ i s θ i 0 it can be obtained 42 d d κ θ p i θ v i d d κ θ i h θ θ i 0 1 α θ 1 β θ θ p i θ v i therefore system has exponential stability at equilibrium point if there exists the match parameters α θ and β θ such that h θ is hurwitz thus due to the auxiliary control variables θ 1 i and θ 2 i are asymptotically converge to 0 similarly there exist parameters α ψ and β ψ guarantee the system 37 asymptotically stable this complete s the proof theorem 4 under the directed location communication topology g p v p ε p a p and speed communication topology g v v v ε v a v consider the slow subsystem 38 of the multi underactuated auv formation system under the action of the integral sliding mode controller 23 and the auxiliary control variable 24 there exists α x α y α z β x β y β z which guarantee s the slow subsystems 38 asymptotically stable or more specifically the whole multi underactuated auv system accurately tracks the desired trajectory and has a stable formation proof without loss of generality this section only provide the proof of x subsystem in 38 first consider a positive definite lyapunov function 43 v x 1 2 s x t s x s x s x 1 s x 2 s x 3 t differentiating 43 yields v x s x t k x i s x i ρ x i s i g n s x i 0 the integral sliding mode controller 23 guarantee s that the x subsystem state can be reached and maintained on the sliding surface s x i next when the system state is on the sliding surface i e s x i s x i 0 it can be obtained 44 x p i x v i x i h x x i 0 1 α x 1 β x x p i x v i therefore system has exponential stability at equilibrium point if there exists the match parameters α x and β x such that h x is hurwitz simultaneously x 1 i and x 2 i are asymptotically converge to 0 similarly there exists parameters α y α z β y β z guarantee the y and z subsystem in 38 asymptotically stable in other words the whole multi underactuated auv system accurately tracks the desired trajectory and has a stable formation this complete the proof 4 simulation results and discussion to illustrate the performance of the proposed controller numerical simulations have been performed by using related simulation software moreover the time scale decomposition phenomenon in the system will also be verified by simulation the parameters of the nonlinear auv mathematical model are the same as those in yan et al 2019 in this section the auv formation consists of one leader and four followers and the position velocity two layer communication topology is shown in the fig 4 where the blue arrow indicates the location communication topology and the black arrow indicates the speed communication topology the auv1 indicates the leader of the formation and the others are the followers of the formation it can be obtained from definition 1 when all follower auvs track and converge to the desired trajectory the formation is formed according to the fig 4 the laplacian matrix of the formation double layer communication topology is 45 l g p l g v 2 1 1 0 0 0 1 0 1 0 0 1 2 0 1 0 1 0 1 0 0 0 0 1 1 in order to demonstrate the 3 d coordinated movement ability of the formation system the mission scenario is considered multi underactuated auv formation tracking a spiral diving curve while maintain a formation in the presence of the lumped uncertainty of the system the detailed desired trajectory is x 10 sin 0 1 t y 10 cos 0 1 t z 0 1 t and the initial positions of each auv in the formation are arbitrarily distributed in the three dimensional space of 10 10 5 5 5 0 the simulation time range is 100s according to wang et al 2020b in this paper two disturbance models are used to verify the superiority of the proposed controller one is represented as τ i d τ d u τ d v τ d w τ d q τ d r t 0 01 m 11 m 22 m 33 m 55 m 66 t which are usually employed to describe slowly time varying disturbances far from the water surface and the other is represented as d t d d t w ω which can be employed to describe external disturbances owing to the second order wave drift and measurement noise d t τ i d τ d u τ d v τ d w τ d q τ d r t other specific parameters are given in wang et al 2020b the lumped uncertainty of the system are chosen as 46 the controller and the ehgos are implemented with the parameters as follows σ 1 0 05 σ 2 0 02 σ 3 0 001 ε 0 3 ε 1 0 2 l s 1 20 l s 2 15 l s 3 6 l f 1 20 l f 2 15 l f 3 6 5 α x α y α z 1 β x β y β z 2 α θ α ψ 1 5 β θ β ψ 2 5 k j 0 2 j x y z θ ψ ρ j 1 j x y z θ ψ 46 f x i m 33 w i q i m 22 v i r i d 11 u i m 11 cos ψ i cos θ i m 11 u i r i d 22 v i m 22 sin ψ i m 11 u i q i d 33 w i m 33 sin θ i cos ψ i u i r i sin ψ i u i q i cos ψ i sin θ i v i r i cos ψ i cos θ i w i q i cos θ i cos ψ i w i r i sin θ i sin ψ i cos θ i τ d u f y i m 33 w i q i m 22 u i r i d 11 u i m 11 sin ψ i cos θ i m 11 u i r i d 22 v i m 22 cos ψ i m 11 u i q i d 33 w i m 33 sin θ i sin ψ i u i q i sin ψ i sin θ i u i r i cos ψ i v i r i sin ψ i cos θ i w i q i cos θ i sin ψ i w i r i sin θ i cos ψ i cos θ i τ d v f z i m 33 w i q i m 22 v i r i d 11 u i m 11 sin θ i m 11 u i q i d 33 w i m 33 cos θ i u i q i cos θ i w i q i sin θ i τ d w f θ i m 33 w i u i m 11 u i w i d 55 q i g m 55 τ d q f ψ i m 22 v i u i m 11 u i v i d 66 q i m 66 cos θ i r i q i sin θ i cos 2 θ i τ d r 4 1 control performance discussion in the sequel two groups of simulation experiments show the control performance of the proposed controller under different disturbance models the simulation results of the first disturbance model are shown in figs 5 11 as shown in the fig 5 the lines of different colors represent the paths and the trajectories of different auv auv1 is the leader auv fig 5 shows the 3d trajectory of the tracking process of the formation using a two layer independent fixed communication topology under the condition of lumped uncertainty composed of slowly time varying disturbances far from the water surface and uncertain nonlinearities each auv can complete the process of gathering with other auv in any initial state figs 6 and 10 show the position and attitude states of the auv formation and the position error between each auv and the desired trajectory respectively from the above two pictures it can be observed that each auv tends to be consensus with the spatial position of other members in the formation which verifies the effectiveness of the proposed formation controller the settling time accounts for only 1 3 of the simulation time all the curves converge smoothly and the settling time is short which reflects that the observation effect of the ehgos is remarkable fig 7 shows the speed state of the auv formation the desired longitudinal velocity u d 1 m s and yaw angular velocity r d 0 1 r a d s can be calculated from the desired trajectory it can be seen from fig 7 that the longitudinal velocity and yaw angular velocity of each auv can quickly reach their desired values respectively however it can be found that the lateral velocity v does not converge to 0 the main reason is that the research object of this paper is the multi underactuated auv formation system and its lateral and vertical dynamics cannot provide control force and torque directly while in the spiral diving high speed tracking mission its ever changing yaw angle makes the nonlinear coupling of auv dynamics more intense fig 8 shows the changes in the control inputs that are actually available for each underactuated auv it can be seen that the proposed controller has sensitive response and the output curve is smooth and stable due to the disturbance compensation of ehgos moreover the system chattering can be suppressed in the proposed controller figs 9 and 10 depicts the position attitude and lumped system uncertainty observation of each auv in the formation by ehgo it can be observed that the uncertainties and the formation states can be accurately observed by ehgo and the peaking time of ehgo is short the simulation results of the second disturbance model are shown in figs 12 18 the similar parts of the two groups of simulation will not be repeated the differences however in following aspects 1 as shown in figs 13 and 14 the position and attitude states have a large shock in the adjustment process and the settling time increases obviously this is due to the change of the reference state caused by the high frequency measurement noise from the sensor at the same time the tracking of the path also leads to the oscillation around the desired trajectory 2 as shown in fig 15 during the convergence of each auv s velocity state there are constant amplitude oscillations and even local oscillations the reason is the same as above 3 similarly as shown in fig 16 the influence of high frequency measurement noise on the controller is obvious the output curve of the controller is always in a time varying state 4 as shown in figs 17 and 18 combined with the above practical results the observation and compensation of ehgos for system uncertainty and high frequency measurement noise can guarantee that it converges to the compressed bounded set near zero but it also reflects the above time varying characteristics the fast time varying characteristic of high frequency measurement noise leads to a significant increase in the settling time of the formation but the formation controller can guarantee the continuous and stable state of each member in the formation when the position and attitude state converge to zero the main reason is that 1 the dynamic performance of ehgo is faster than that of the whole system so it does not need system disturbance is slow time varying khalil 2017 2 the strong robustness of integral sliding mode controller even if there is a deviation in the system the controller can guarantee that the state of the system returns to the integral sliding mode surface as can be seen from fig 6 or fig 14 at t 30 s the attitude of each auv in the formation tends to be consistent while the position state of each auv in the formation tends to be consistent at t 40 s in the convergence of attitude state the convergence rate of the pitch is faster than that of the yaw but it is not obvious and there is almost no overshoot the obvious time scale decomposition phenomenon can also be found in figs 9 and 11 or figs 17 and 18 that is the convergence speed of the attitude observer subsystem is obviously faster than that of the position observer subsystem and within the attitude observer subsystem the pitch observer subsystem is faster than the yaw observer subsystem the reason for the above phenomenon is that as mentioned in the previous remark 3 and theorem 1 the position observer subsystem simultaneously uses the attitude observation value θ ˆ i and ψ ˆ i from the attitude observer subsystem while the yaw observer subsystem uses the pitch observation value θ ˆ i so that the pitch angle observer subsystem has the fastest dynamic therefore the simulation results show that ehgo has obvious characteristics of three time scales since the lumped uncertainties observed by ehgo are to be compensated in the controller the time scale separation will also occur in the convergence of formation position and attitude in this way the system can be analyzed independently in each time scale and the difficulty of designing the controller is reduced based on the above simulation results it can be observed that the proposed formation controller can not only track the desired trajectory but also keep the formation stable in addition in the presence of system uncertainty and different environmental disturbance models the formation can still maintain good performance therefore these simulation results adequately prove the effectiveness of the proposed controller and verify the relevant theorems proposed 4 2 comparative analysis in this section a comparison with a consensus method yan et al 2017 is proposed the simulation scenario is that auv1 tracks the desired trajectory in the presence of uncertain nonlinearity and external disturbance simulation results are illustrated as figs 19 20 it can be clearly found from figs 19 20 that under the control algorithm proposed in yan et al 2017 the convergence speed of the formation is slower and the settling time of the formation is longer due to the lumped system uncertainties complex hydrodynamic coupling and nonlinear relationship of the auv the position and attitude states of the formation change violently and require longer settling time the settling time accounts for almost half of the simulation time however under the controller proposed in this paper the settling time accounts for only 1 3 of the simulation time because the time scale decomposition in formation control is not taken into account the formation shows obvious hysteresis and state disorder moreover the transformation of the communication topology also leads to the continuous change of the reference state and increases the state fluctuation of the self adjustment process however it guarantees that all members in the formation can receive the motion state information of the formation so as to ensure that the formation can still achieve stable state 5 conclusion a formation control method for multi underactuated auv systems with uncertain nonlinearities and environmental disturbances was presented from a practical point of view that is an important contribution since the time scale decomposition between position subsystem and attitude subsystem in formation control system is uniquely analyzed based on singular perturbation theory the stability and convergence of the system dynamic are analyzed independently in each time scale and exponential stability of the equilibrium is established integral sliding mode controller incorporated with ehgo has been effectively utilized to deal with uncertain nonlinearities and environmental disturbances for a higher estimation precision finally a series of numerical simulations are carried out to illustrate the control performance of the proposed controller ultimately it is necessary to point out that we only study the situation in which high frequency measurement noise is regarded as environmental disturbance but not its direct effect on ehgo in practice the next work is devoted to dealing with such problems in addition the case that the inertia matrix is a non diagonal matrix in the auv model will be taken into account declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51879049 and the natural science foundation of heilongjiang province china grant no jj2019lh2279 
20768,this paper is concerned with a multi underactuated auv three dimensional 3 d formation control method with a multi time scale structure in the presence of uncertain nonlinearities and environmental disturbances first a double layer independent position velocity fixed topology is adopted to overcome the drawback of narrow bandwidth of underwater communication then an extended high gain observer ehgo is utilized to provide compensation to uncertain nonlinearities and environmental disturbances moreover the consensus theory is incorporated with an integral sliding mode controller to guarantee that the multi underactuated auv system can track the desired trajectory while maintaining the predefined formation in addition based on the analysis for the whole formation control system the extended high gain observer is on the ultra fast time scale the integral sliding mode controller is on the fast time scale and the system state converges to the desired state on the slow time scale such multi time scale structure allows independent analysis of the dynamics in each time scale and the singular perturbation method is effectively utilized to establish the exponential stability of the equilibrium finally simulation results are presented to illustrate the control performance keywords multi underactuated auv system multi time scale singular perturbation uncertainties integral sliding mode control extended high gain observer 1 introduction the formation of autonomous underwater vehicle auv has the advantages of strong load capacity high mission efficiency and good system redundancy therefore it has become an important tool for marine survey port investigation mine detection and submarine pipeline laying and has attracted the interest of a large number of researchers evans and nahon 2004 li and lee 2005 lapierre and soetanto 2007 woolsey and techy 2009 the research focuses on the following aspects 1 the underactuated characteristics of auv system 2 the parameter uncertainty of auv system model 3 the instability of underwater communication 4 the design of formation controller and consensus theory the dynamic models of auv are usually underactuated highly nonlinear and coupled and its hydrodynamic parameters are often uncertain especially when auv may be subjected to unknown disturbances from ocean currents fossen 1994 which makes the formation control of multi underactuated auv become an arduous task breakthroughs have been made in the field of underactuated auv formation control in a decade aguiar and hespanha 2004 yuh 2000 because the auv system is a typical nonlinear system many nonlinear control methods such as backstepping method xu et al 2014 lapierre 2009 sliding mode control xu et al 2015 yan et al 2019 zhang and cao 2015 adaptive control sun et al 2018 wang et al 2020a feedback linearization method zhou et al 2017 pan et al 2011 and so on have been deeply studied to design controllers for motion control or attitude control of auv however in practical application the uncertain parameters in the auv system model will have a negative impact on the controller so a variety of adaptive methods are utilized to compensate the uncertainties and external disturbances of the system to name a few neural network method shojaei and arefi 2015 zhang et al 2009 fuzzy logic method wu et al 2015 bessa et al 2010 and conditional integrator seshagiri and khalil 2005 burger et al 2009 although the auv unit has been deeply studied for specific applications such as ocean sampling mapping minesweeping seafloor exploration multi auv cooperative operation is beneficial to improve efficiency and increase operation area and provide redundancy in case of failure one of the basic problems of multi auv cooperation is formation control namely to complete the assigned tasks while maintaining the formation based on thorough review of the literature there are several different strategies to achieve the formation control for multi auv system including artificial potential field method pan et al 2017 virtual structure method yan et al 2015 and leader following method li et al 2018 li and du 2018 ihle et al 2006 cui et al 2010 among the above strategies the leader following control method seems to be the most popular one however the above references did not take the underwater weak communication environment and the actual situation of low bandwidth into account in order to solve the problem of underwater communication delay of auv formation a h 2 h feedback control method based on feedforward control is proposed in millan et al 2014 which can ensure that the uuv formation still has effective formation performance in the case of communication delay and data packet loss in xu and li 2013 under the condition of limited communication a submarine formation maintenance control method based on line of sight los method is proposed which can maintain formation stability in the case of short interruption and data packet loss in yang et al 2013 a robust coordinated control method for stable convergence of constant bounded time delay is proposed by decoupling algorithm under the condition of time delay yan et al 2017 proposed to use markov random switching communication topology to simulate and compensate for the drawbacks of underwater acoustic communication and proposes a position velocity double layer topology to reduce the communication bandwidth ensure that the auv will not lose contact in the formation and improve the stability of the system however for a practical application oriented formation controller should not only satisfy the stability of the formation system but also improve its robustness and adaptability to system uncertain nonlinearities and unknown environment disturbances therefore under the leader following strategy a large number of robust and adaptive techniques are introduced such as neural network fuzzy control sliding mode control and so on wang et al 2020b proposed a filter backstepping based neural adaptive formation tracking control method the calculation explosion of the traditional backstepping method is avoided by using the filtering method and the adaptive neural network is used to improve the adaptive ability of the controller asif et al 2017 proposed a formation controller based on fast integral terminal sliding mode control which solved the formation problem without considering the leader s speed information although the above sliding mode control schemes had a good control effect the symbol terms used in the above sliding mode controller are usually discontinuous which will bring chattering of the control system and reduce the robustness of the system a sliding mode formation control strategy using backstepping method and adaptive neural network is proposed in wang et al 2020a and a continuous pi function is designed to avoid the influence of chattering in standard sliding mode control method a control method based on approximation is proposed in cui et al 2010 to deal with the uncertain parameters in the model and the external environment disturbance suffered by the follower auv however to the best of authors knowledge although neural networks and fuzzy adaptive controllers have advantages in approximating uncertainties and disturbances the adjustment of their learning parameters is still a challenging task in practical application cui et al 2017 to this end another method proposed in cui et al 2017 to deal with unknown nonlinearity is to design an observer to estimate the unknown external disturbance of auv and then design a controller to compensate the estimated disturbance in fernandes et al 2015 an observer based high gain output feedback motion control is proposed which takes unmodeled dynamics and measurement errors of the observed rov and unknown external environment disturbances into account the system disturbances can be estimated by extending the order of the high gain observer and such an observer is an extended high gain observer ehgo compared with other extended observers ehgo has the following two unique characteristics first it does not need the disturbance of the system to be slow time varying because the dynamic performance of ehgo is faster than that of the whole system khalil 2017 second ehgo can be used to observe disturbances caused by model uncertainties and external disturbances freidovich and khalil 2008 it is well established that for some physical systems with underactuated characteristics singularly perturbed system theory is regarded as a powerful tool for controller analysis and design in essence this method is based on the convergent solutions of some differential equations on two or more time scales in this case the time scale separation phenomenon of full dynamics leads to two low order subsystems slow reduced order and fast boundary layer subsystems which can be stable respectively so that the control problem is relatively simplified khalil 2019 freidovich and khalil 2008 khalil 2017a b this analysis method has been deeply studied in inverted pendulum system khalil 2017a b and quadrotor uav system gonzález vázquez and moreno valenzuela 2013 zhou et al 2019 therefore using singular perturbation theory and time scale theory it is significant to make some attempts to solve the problem of time scale separation in underactuated auv a dual time scale singularly perturbed control law is proposed in ren et al 2014 for ship rudder roll stabilization rrs in yi et al 2016 the singular perturbation method is used to study the horizontal plane path tracking control of underactuated surface ships and the unmodeled dynamics of the system are taken into account the path tracking control problem of auv on the vertical surface is concerned in lei 2020 and the tracking error equation is decomposed in two time scales in which the attitude angle error is a fast system and the position error is a slow system the controllers are designed independently by using the singular perturbation method all these references show the subtle and powerful ability of singular perturbation theory in the field of ocean engineering however the research on underactuated auv formation control under multi time scale structure is rarely reported in the public literature motivated by aforementioned considerations this paper studies the problem of coordinated formation and time scale separation for a class of underactuated auvs in the presence of uncertain nonlinearities and environmental disturbances as well limited underwater acoustic communication compared with previous representative literatures the main novelties and contributions of this paper are in the following aspects i the underactuated auv formation system is uniquely analyzed by combining the multi time scale decomposition phenomenon and the singular perturbation theory ii the dynamic analysis of the system is carried out independently in each time scale which significantly reduces the difficulty of designing the controller and analyzing the stability of the system iii the proposed formation controller combines the consensus theory and the integral sliding mode controller so that the formation system can accurately track the desired trajectory while maintaining the stability of the formation system iv an extended high gain observer ehgo is designed to solve the problems of the uncertain nonlinearities and environmental disturbances in the system the remainder of the paper is organized as follows section 2 formulates the mathematical model of underactuated auvs with uncertain dynamics and some useful notations and preliminaries section 3 introduces the design of the formation controller and section 4 states the time scale decomposition and closed loop system stability analysis simulation results and conclusions are given in section 5 and 6 respectively 2 preliminaries and problem formulation this section describes the mathematical model of the underactuated auvs and derives the state space equation of the underactuated auvs moreover this section provides the preliminaries of graph theory and double layer communication topology and defines the formation 2 1 preliminaries graph theory is an effective tool to describe the communication relationship within the formation the topological graph describing the communication relationship among the members of the formation is divided into directed graph and undirected graph in this paper the directed graph is used to express the communication relationship between the members of the auv formation supposing there are n members within the formation define g v ε a to represent the communication topology of the formation inspired by yan et al 2016 yan et al 2017 the communication topology is divided into location communication topology and speed communication topology and expressed as follows g p v p ε p a p g v v v ε v a v where v p v represents the set of vertices v p v 1 2 n and in this paper the vertices are auvs ε p v represents the set between pairs of vertices ε p v v p v v p v a p v denotes the adjacency matrix of the graph a p v a i j r n n satisfies that if there is i j ε p v then a i j 1 or a i j 0 the adjacency matrix a a i j t r n n satisfies d i i n j 1 n a j i d i o u t j 1 n a i j where d i i n and d i o u t are the in degree and out degree of the node or auv define the in degree matrix as a diagonal matrix d d i a g d 1 i n d 2 i n d n i n if the matrix l l i j r n n satisfies l d a then the matrix l r n n is defined as the laplacian matrix of the directed graph g v ε a according to the definition of laplacian matrix l contains a zero eigenvalue and the eigenvector corresponding to the eigenvalue is 1 n 1 1 1 r n for a directed graph there is only one zero eigenvalue if and only if the graph g v ε a is strongly connected in a directed graph g v ε a all vertices except a special vertex have a parent then this vertex without a parent is called a root and there must be a directed path connecting all other vertices at the root then such a graph is called a directed tree the directed tree must be from the root as the starting point if there is at least one vertex with a directed path to all other vertices the graph has a directed spanning tree obviously the laplacian matrix l g in this paper is invertible assumption 1 in this paper the communication graphs are balanced yan et al 2017 2 2 auv model inspired by aguiar and hespanha 2004 lapierre and soetanto 2007 do 2009 shojaei and arefi 2015 xia et al 2020 the 5 degree of freedom dof dynamics and kinematics models for a group of underactuated auvs can be presented as follows 1a η i j η i v i 1b m i v i c i v i v i d i v i v i g η i τ i the expression of the main parameters is as follows and the detailed meaning of each parameter is the same as that of above references m i is the inertia matrix c i v i is the coriolis and centripetal matrix d i v i is the hydrodynamic damping matrix and j η i is the transformation matrix from the o x y z to the e ξ η ζ respectively are given by 2 m i m 11 0 0 0 0 0 m 22 0 0 0 0 0 m 33 0 0 0 0 0 m 55 0 0 0 0 0 m 66 3 c i v i 0 0 0 m 33 w m 22 v 0 0 0 0 m 11 u 0 0 0 m 11 u 0 m 33 w 0 m 11 u 0 0 m 22 v m 33 u 0 0 0 4 d i v i d 11 0 0 0 0 0 d 22 0 0 0 0 0 d 33 0 0 0 0 0 d 55 0 0 0 0 0 d 66 5 j η i s 0 0 t s cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t 1 0 0 1 cos θ τ i τ u 0 0 τ q τ r t and τ i d τ d u τ d v τ d w τ d q τ d r t represent the control inputs and environmental disturbances respectively g η 0 0 0 ρ g g m l sin θ 0 t is the static and static moment matrix based on the underactuated auv model shown in 1 considering a group of n underactuated auvs as shown in fig 1 taking the second time derivative of η yields η j η v j η v cui et al 2017 and taking the coefficients mentioned above into it we can obtain 6 x i g x i θ i ψ i m 11 τ u i f x i y i g y i θ i ψ i m 11 τ u i f y i z i g z i θ i m 11 τ u i f z i θ i 1 m 55 τ q i f θ i ψ i g ψ i θ i m 66 τ r i f ψ i where 7 g x i θ i ψ i cos ψ i cos θ i g y i θ i ψ i sin ψ i cos θ i g z i θ i sin θ i g ψ i θ i 1 cos θ i define the first derivative of lumped system uncertainties f x i y i z i θ i ψ i as f d x i d y i d z i d θ i d ψ i which satisfies f d x i d y i d z i d θ i d ψ i f x i y i z i θ i ψ i and assuming that it satisfies the lipschitz condition the lumped system uncertainties of the underactuated auv system is due to the uncertainty of hydrodynamic coefficient modeling error and parameter perturbation and environmental disturbances according to lee et al 2015 we define state space variables x 1 i x i x 2 i x i y 1 i y i y 2 i y i z 1 i z i z 2 i z i θ 1 i θ i θ 2 i θ i ψ 1 i ψ i ψ 2 i ψ i therefore the system 6 can be expressed as 8 x 1 i x 2 i x 2 i g x i θ i ψ i m 11 τ u i f x i f x i f d x i y 1 i y 2 i y 2 i g y i θ i ψ i m 11 τ u i f y i f y i f d y i z 1 i z 2 i z 2 i g z i θ i m 11 τ u i f z i f z i f d z i 9 θ 1 i θ 2 i θ 2 i 1 m 55 τ q i f θ i f θ i f d θ i ψ 1 i ψ 2 i ψ 2 i g ψ i θ i m 66 τ r i f ψ i f ψ i f d ψ i the desired trajectory is η d x d y d z d θ d ψ d t and the pitch and yaw angles are θ d arctan 2 z d v t and ψ d arctan 2 y d x d respectively where v t x d 2 y d 2 assumption 2 b the desired trajectory is a smooth curve and any point on the curve is differentiable and the second derivative is bounded the spatial formation shape can be describe by a vector δ δ 1 t δ 2 t δ n t t ℝ 3 n where δ i δ i x δ i y δ i z t is the piecewise continuously formation vector for a u v i the motion state vector of the a u v i at some point is ℓ i t p i t v i t where p i t x 1 i t y 1 i t z 1 i t such that 10 lim t x 1 i t δ i x x d t 0 lim t y 1 i t δ i y y d t 0 lim t z 1 i t δ i z z d t 0 as shown in fig 1 for two adjacent a u v i and a u v j there exists 11 δ i j δ i j x δ i j y δ i j z t δ j x δ i x δ j y δ i y δ j z δ i z t for the leader following formation the leader l p l t v i t is defined as the reference point of the formation which satisfies lim t p l t η d 0 therefore the desired state of each follower auv is f i p i t δ i j v i t the desired point is also fixed relative to the reference point which satisfies lim t p i t p l t δ i j therefore it can also be judged that if each follower auv can converge to the desired point then each follower auv can converge to the leader and the leader can converge to the desired trajectory to this end it can be obtained the definition as follows definition 1 consider the formation of n 1 follower auvs and a leader auv the desired trajectory is η d the state of the auv is ξ i p i t v i t if the state of auv satisfies lim t p i t η d 0 it is said that the leader following formation can achieve consensus and guarantee the convergence and stability of the formation system 3 main results the purpose of this section is to solve the formation problem of multi underactuated auv system with uncertain nonlinearities and environmental disturbances in 3 d space under the framework of multi time scale theory and singularly perturbed systems the main control objective is to estimate the uncertainties of the system by designing an extended high gain observer so as to provide compensation to lumped system uncertainties and improve the robustness of the system therefore from an overall perspective the extended state observer has the fastest and the first time scale then the position and attitude controller designed by combining graph theory and integral sliding mode controller has the second time scale finally the multi underactuated auv system maintains the desired formation has the slowest and third time scale fig 2 depicts the control system structure block diagram of the a u v i 3 1 singularly perturbed system dynamics in order to facilitate the design of the controller the position and attitude error variables are defined as follows according to the formation vector 12 x 1 i x 1 i δ i x x d x 2 i x 2 i x d y 1 i y 1 i δ i y y d y 2 i y 2 i y d z 1 i z 1 i δ i z z d z 2 i z 2 i z d 13 ε 2 ε 1 2 θ 1 i θ 1 i θ d ε ε 1 θ 2 i θ 2 i θ d ε 2 ψ 1 i ψ 1 i ψ d ε ψ 2 i ψ 2 i ψ d where ε and ε 1 are positive constant denoted as perturbing parameters which satisfies ε 1 ε 1 1 here ε and ε 1 are artificial small parameters in order to provide a singular perturbation analysis taking the time derivative of 12 and 13 and substituting 8 and 9 into it yields 14 x 1 i x 2 i x 2 i f x i g x i θ i ψ i m 11 τ u i x d y 1 i y 2 i y 2 i g y i θ i ψ i m 11 τ u i f y i y d z 1 i z 2 i z 2 i g z i θ i m 11 τ u i f z i z d 15 ε ψ 1 i ψ 2 i ε ψ 2 i g ψ i θ i m 66 τ r i f ψ i ψ d ε ε 1 θ 1 i θ 2 i ε ε 1 θ 2 i 1 m 55 τ q i f θ i θ d then it is obtained that the error system 15 16 is a standard singularly perturbed system with three time scales such as p i f 1 p i ψ i θ i τ u i f ε ψ i f 2 p i ψ i θ i τ r i f ε ε 1 θ i f 3 p i ψ i θ i τ q i f p i x 1 i x 2 i y 1 i y 2 i z 1 i z 2 i denotes the position state τ denotes the control input and f represents the lumped system uncertainties obviously when the underactuated auv system forms a stable formation it is necessary to guarantee that each auv in the system has a stable attitude 3 2 extended high gain observer according to the reference lee et al 2015 for the system model shown in 8 and 9 the ehgo can be designed in the following x ˆ 1 i x ˆ 2 i l s 1 σ 1 x 1 i x ˆ 1 i x ˆ 2 i f ˆ x i g x i θ ˆ i ψ ˆ i τ u i m 11 l s 2 σ 1 2 x 1 i x ˆ 1 i f ˆ x i l s 3 σ 1 3 x 1 i x ˆ 1 i y ˆ 1 i y ˆ 2 i l s 1 σ 1 y 1 i y ˆ 1 i y ˆ 2 i f ˆ y i g y i θ ˆ i ψ ˆ i τ u i m 11 l s 2 σ 1 2 y 1 i y ˆ 1 i f ˆ y i l s 3 σ 1 3 y 1 i y ˆ 1 i 16 z ˆ 1 i z ˆ 2 i l s 1 σ 1 z 1 i z ˆ 1 i z ˆ 2 i f ˆ z i g z i θ ˆ i τ u i m 11 l s 2 σ 1 2 z 1 i z ˆ 1 i f ˆ z i l s 3 σ 1 3 z 1 i z ˆ 1 i 17 ψ ˆ 1 i ψ ˆ 2 i l f 1 σ 2 ψ 1 i ψ ˆ 1 i ψ ˆ 2 i f ˆ ψ i g ψ i θ ˆ i τ r i m 66 l f 2 σ 2 2 ψ 1 i ψ ˆ 1 i f ˆ ψ i l f 3 σ 2 3 ψ 1 i ψ ˆ 1 i θ ˆ 1 i θ ˆ 2 i l f 1 σ 3 θ 1 i θ ˆ 1 i θ ˆ 2 i f ˆ θ i τ q i m 55 l f 2 σ 3 2 θ 1 i θ ˆ 1 i f ˆ θ i l f 3 σ 3 3 θ 1 i θ ˆ 1 i where the constants l i j i s f j 1 2 3 are chosen such that the polynomials s 3 l i 1 s 2 l i 2 s l i 3 are hurwitz σ 1 2 3 are small positive constants remark 1 if there is a difference between the initial state and the initial estimated state of the system the peaking phenomenon can be generated for a very small σ j this is a drawback of the ehgos therefore according to the reference khalil 2017a b the estimation error x i x i x ˆ i is constrained in the following inequalities x j i max a σ j 1 x 0 e b t σ σ 4 j c m where a b c m are some positive constant remark 2 it is known from the zhou et al 2019 that there is a time scale separation phenomenon in the ehgo in which the attitude ehgo subsystem is a fast subsystem the position ehgo subsystem is a slow subsystem and in the attitude ehgo subsystem the pitch ehgo subsystem is faster than the yaw ehgo subsystem or more specifically the pitch observation θ ˆ is used in the yaw ehgo subsystem g ψ i θ ˆ i and the attitude observation θ ˆ i and ψ ˆ i are also used in the position ehgo subsystem g x i θ ˆ i ψ ˆ i τ u i m 11 g y i θ ˆ i ψ ˆ i τ u i m 11 g z i θ ˆ i τ u i m 11 therefore the dynamic response of the pitch ehgo in the attitude ehgo should be faster than that of the yaw ehgo and the overall dynamic response of the attitude ehgo should be faster than that of the position ehgo lei 2020 furthermore the nonlinear input coefficient can be approximated more quickly to ensure the observation accuracy of the position ehgo therefore the perturbing parameters σ i 1 i 1 2 3 should satisfy σ 3 σ 2 1 and σ 2 σ 1 1 remark 3 the perturbing parameters ε and ε 1 should satisfy ε 1 and ε 1 1 simultaneously σ 1 ε ε 1 1 this requirement can be explained intuitively as follows since the observations of ehgos are used in the error feedback system 14 15 to design the integral sliding mode controller the dynamics of ehgos should be faster than the feedback dynamics lee et al 2015 3 3 integral sliding mode controller the main tasks in this section are as follows under the action of the directed topology graph g for the position and attitude error subsystem of multi underactuated auv system the integral sliding surface is designed under the framework of consensus theory so that the system state error variables can reach the sliding surface and quickly converge to 0 along the sliding surface in other words the integral sliding mode controller can guarantee that the auv in the system forms a stable formation in this paper the two layer independent topologies are g p v p ε p a p g v v v ε v a v respectively so according to the consensus theory yields 18 x p i l i g p x 1 i x v i l i g v x 2 i y p i l i g p y 1 i y v i l i g v y 2 i z p i l i g p z 1 i z v i l i g v z 2 i θ p i l i g p θ 1 i θ v i l i g v θ 2 i ψ p i l i g p ψ 1 i ψ v i l i g v ψ 2 i assumption 3 in the double layer independent topology set the topology graph corresponds to one to one so l i g l i g p l i g v exists at any time 18 can be redefined as follows 19 x p i j g i a i j x 1 i x 1 j x v i j g i a i j x 2 i x 2 j y p i j g i a i j y 1 i y 1 j y v i j g i a i j y 2 i y 2 j z p i j g i a i j z 1 i z 1 j z v i j g i a i j z 2 i z 2 j 20 θ p i j g i a i j θ 1 i θ 1 j θ v i j g i a i j θ 2 i θ 2 j ψ p i j g i a i j ψ 1 i ψ 1 j ψ v i j g i a i j ψ 2 i ψ 2 j to move on define integral sliding mode surface 21 s x i t x v i t x p i t 0 t α x x p i β x x v i d τ s y i t y v i t y p i t 0 t α y y p i β y y v i d τ s z i t z v i t z p i t 0 t α z z p i β z z v i d τ s θ i t ε ε 1 θ v i t ε ε 1 θ p i t 0 t α θ θ p i β θ θ v i d τ s ψ i t ε ψ v i t ε ψ p i t 0 t α ψ ψ p i β ψ ψ v i d τ in order to ensure that the state variables of the system converge rapidly when they are far away from and approach to the sliding surface the following form of exponential reaching law is adopted 22 s j i k j i s j i ρ j i s i g n s j i k j i ρ j i 0 w h e r e j x y z θ ψ therefore we design the integral sliding mode controller as follows 23 τ u i m 11 g x i θ i d ψ i d f ˆ x i k x i s x i ρ x i s i g n s x i a x i τ q i m 55 f ˆ θ i k θ i s θ i ρ θ i s i g n s θ i a θ i τ r i m 66 g ψ i θ i d f ˆ ψ i k ψ i s ψ i ρ ψ i s i g n s ψ i a ψ i here 8 9 14 15 16 17 have been used 24 w h e r e t h e a u x i l i a r y c o n t r o l var i a b l e i s a x i α x x p i β x x v i a θ i α θ θ p i β θ θ v i a ψ i α ψ ψ p i β ψ ψ v i 5 time scale decomposition and closed loop system stability analysis the stability analysis for each subsystem will be done by starting from the fastest one to the slowest one in that way a multi time scale structure of the multi underactuated auv system with uncertainties is depicted in fig 3 theorem 1 consider ehgos for the a u v i there always exist σ i which satisfies σ i σ i 0 such that the observation error of ehgos asymptotically stable at the origin proof for the attitude ehgo subsystem with fast dynamics define a series of attitude observation error variables δ θ i δ θ 1 i δ θ 2 i δ θ 3 i t δ ψ i δ ψ 1 i δ ψ 2 i δ ψ 3 i t where 25 δ θ 1 i θ 1 i θ ˆ 1 i σ 3 2 δ θ 2 i θ 1 i θ ˆ 1 i σ 3 δ θ 3 i f θ i f ˆ θ i 26 δ ψ 1 i ψ 1 i ψ ˆ 1 i σ 2 2 δ ψ 2 i ψ 1 i ψ ˆ 1 i σ 2 δ ψ 3 i f ψ i f ˆ ψ i for 24 define a stretched time scale κ 3 t σ 3 differentiating these variable with respect to κ 3 and substituting 9 and 17 into it yields the boundary layer system 27 d d κ 3 δ θ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ θ i σ 3 0 0 f d θ i then the pitch observation error state equation can be written as σ 3 δ θ i a θ δ θ i σ 3 b θ f d θ i where a θ l f 1 1 0 l f 2 0 1 l f 3 0 0 b θ 0 0 1 therefore there exists positive constants l f 1 δ l f 2 δ l f 3 such that a θ is hurwitz which guarantees the asymptotic convergence of the observation error to move on consider the following lyapunov function v δ θ i σ 3 δ θ i t p δ θ i p is the solution of the equation p a θ a θ t p t q 28 v δ θ i σ 3 δ θ i t p δ θ i σ 3 δ θ i t p δ θ i a θ δ θ i σ 3 b θ f d θ i t p δ θ i δ θ i t p a θ δ θ i σ 3 b θ f d θ i δ θ i t a θ t p δ θ i σ 3 b θ f d θ i t p δ θ i δ θ i t p a θ δ θ i σ 3 δ θ i t p b θ f d θ i δ θ i t a θ t p p a θ δ θ i 2 σ 3 δ θ i t p b θ f d θ i δ θ i t q δ θ i 2 σ 3 p b θ δ θ i f d θ i 29 λ m i n q δ θ i 2 2 σ 3 f θ i p b θ δ θ i where λ m i n q is the minimum eigenvalue of q therefore the convergence condition of the observer is 30 δ θ i 2 σ 3 f θ i λ m i n q 1 p b θ from 30 it can be observed that the convergence rate of δ θ i is related to the σ 3 and the smaller the σ 3 is the faster the convergence speed of δ θ i is and with the decrease of σ 3 the observation error asymptotically converges to 0 then let σ 3 0 according to the theorem 1 in the freidovich and khalil 2008 there exists 31 δ θ i o σ 3 o t σ 3 therefore after a short transient period t σ 3 it can be concluded that δ θ i become of the order o σ 3 in the bounded compact sets ω c v δ θ i σ 3 2 c 1 where c 1 is a positive constants namely a small enough σ 3 can be selected to satisfy σ 3 σ 3 0 to ensure that the pitch observation error variables are asymptotically stable and converge to the compact set khalil and pr 2014 after the above analysis it is clear that the quasi steady state system has the isolated roots δ θ ˆ i 0 noteworthily the specific value θ ˆ i is solved according to the isolated root which can be used to analyze the stability of the slow subsystem of the attitude ehgos after the peaking phenomenon the pitch observation error becomes the order o σ 3 with θ ˆ i θ i similarly for 26 define a stretched time scale κ 2 t σ 2 differentiating these variable s with respect to κ 2 and substituting 9 and 17 into it yields the boundary layer system 32 d d κ 2 δ ψ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ ψ i σ 2 0 0 f d ψ i 0 g ψ i θ i g ψ i θ ˆ i τ r i m 66 0 where the specific value θ ˆ i could make the nonlinear coefficients tend to zero with σ 3 0 then the reduced system is 33 d d κ 2 δ ψ i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ ψ i σ 2 0 0 f d ψ i according to hou and fantoni 2018 the reduce system can be used to instead of the complete model in the study of the slow dynamic of ehgos evidenced by the same token it can be proved that the yaw observation error variable is bounded a small enough σ 2 can be selected to satisfy σ 2 σ 2 0 to ensure that the observation error variables are asymptotically stable and converge to the compact set khalil and pr 2014 there exists a specific value ψ ˆ i which satisfies the isolated root δ ψ ˆ i 0 with σ 2 0 the above specific values θ ˆ i and ψ ˆ i solved by isolated roots can be used for the stability analysis of position ehgos defining the observation error variable s of slow dynamic position observer subsystem δ x i δ x 1 i δ x 2 i δ x 3 i t δ y i δ y 1 i δ y 2 i δ y 3 i t δ z i δ z 1 i δ z 2 i δ z 3 i t where 34 δ x 1 i x 1 i x ˆ 1 i σ 1 2 δ x 2 i x 1 i x ˆ 1 i σ 1 δ x 3 i f x i f ˆ x i δ y 1 i y 1 i y ˆ 1 i σ 1 2 δ y 2 i y 1 i y ˆ 1 i σ 1 δ y 3 i f y i f ˆ y i δ z 1 i z 1 i z ˆ 1 i σ 1 2 δ z 2 i z 1 i z ˆ 1 i σ 1 δ z 3 i f z i f ˆ z i define a stretched time scale κ 1 t σ 1 differentiating 34 with respect to κ 1 yields d d κ 1 δ x i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ x i σ 1 0 0 f d x i 0 g x i θ i ψ i g x i θ ˆ i ψ ˆ i τ u i m 11 0 35 d d κ 1 δ y i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ y i σ 1 0 0 f d y i 0 g y i θ i ψ i g y i θ ˆ i ψ ˆ i τ u i m 11 0 d d κ 1 δ z i l f 1 1 0 l f 2 0 1 l f 3 0 0 δ z i σ 1 0 0 f d z i 0 g z i θ i g z i θ ˆ i τ u i m 11 0 similarly it can be proved that the position observation error is bounded and a sufficiently small σ 1 satisfying σ 1 σ 1 0 can be selected to ensure the asymptotic stability of the observation error variable khalil and pr 2014 there exists specific values x ˆ 1 i y ˆ 1 i z ˆ 1 i which satisfies the isolated root δ x ˆ i 0 δ y ˆ i 0 δ z ˆ i 0 with σ 3 0 therefore after the ehgos reach quasi steady state hierarchically i e σ 1 σ 2 σ 3 0 a reduced system with three time scales can be obtained lee et al 2015 and the stability analysis will be presented in theorem 2 theorem 2 consider the system dynamics for the a u v i is a standard singularly perturbed system with three time scales there always exist ε and ε 1 which satisfies ε ε 0 and ε 1 ε 1 0 respectively such that the state space origin of the closed loop system 14 and 15 are asymptotically stable proof first in this proof the top down td method which is opposite to the bottom up bu method in esteban et al 2013 is used to decompose equations 14 and 15 in three time scales according to the singular perturbation theory three different time scales are regarded as two different two time scale singularly perturbed problems according to the singularly perturbed model proposed in section 3 1 p i is the slow variable ψ i is the fast variable θ i is the ultra fast variable for convenience denote the different subsystem combinations to name a few p i for the slow subsystem ψ i for the fast subsystem θ i for the ultra fast subsystem ψ i θ i for the fast ultra fast subsystem first considering the singular perturbation parameters ε at the top define a stretched time scale κ 0 t ε it can be obtained a one dimensional subsystem reduced order p i subsystem and a two dimensional subsystem boundary layer ψ i θ i subsystem as follows p i p i f 1 p i f 2 p i f 3 p i f 2 p i τ u i f ψ i θ i d d κ 0 ψ i f 2 p i ψ i κ 0 θ i κ 0 τ r i f ε 1 d d κ 0 θ i f 3 p i ψ i κ 0 θ i κ 0 τ q i f p i is regarded as constant in boundary layer system ψ i θ i while f 2 p i and f 3 p i f 2 p i represents the quasi steady state of boundary layer system ψ i θ i that is when ε 0 such that f 3 p i ψ i θ i τ q i f 0 f 2 p i ψ i f 3 p i ψ i τ r i f 0 θ i f 3 p i ψ i f 3 p i f 2 p i ψ i f 2 p i esteban et al 2013 then considering the singular perturbation parameter ε 1 in the boundary layer system ψ i θ i define a stretched time scale κ κ 0 ε 1 and obtaining two one dimensional subsystems the reduced order subsystem ψ i and the boundary layer system θ i as a result yields ψ i d d κ 0 ψ i f 2 p i ψ i κ 0 f 3 p i ψ i κ 0 τ r i f θ i d d κ θ i f 3 p i ψ i θ i κ τ q i f the function f 3 p i ψ i κ 0 in the reduced order ψ i system represents the quasi steady state of the boundary layer θ i system when ε 1 0 f 3 p i ψ i θ i 0 θ i f 3 p i ψ i where p i and ψ i are regarded as constant this concludes the td method after using the above method to decompose the three time scales the stability of each subsystem can be analyzed independently which considerably simplifies the stability analysis of the closed loop system the following recalling that the tracking error system dynamics for the a u v i 14 and 15 after the above time scale decomposition according to kokotovic et al 1987 and lei 2020 the closed loop system 14 and 15 have the unique and isolated equilibrium at the origin i e p i 0 θ i 0 ψ i 0 we define a stretched time scale κ 0 t ε differentiating 15 with respect to κ 0 yields boundary layer systems 36 ε 1 d d κ 0 θ 1 i θ 2 i ε 1 d d κ 0 θ 2 i 1 m 55 τ q i f ˆ θ i θ d 37 d d κ 0 ψ 1 i ψ 2 i d d κ 0 ψ 2 i g ψ i θ ˆ i m 66 τ r i f ˆ ψ i ψ d setting ε 0 it can be obtained the solution of quasi steady state θ i f 3 p i ψ i f 3 p i f 2 p i 0 ψ i f 2 p i 0 is θ ˆ i d ψ ˆ i d substituting it into 14 yields the reduced order system x 1 i x 2 i x 2 i f ˆ x i g x i θ ˆ i d ψ ˆ i d m 11 τ u i x d 38 y 1 i y 2 i y 2 i f ˆ y i g y i θ ˆ i d ψ ˆ i d m 11 τ u i y d z 1 i z 2 i z 2 i f ˆ z i g z i θ ˆ i d m 11 τ u i z d under the integral sliding mode controller the reduced order subsystem is asymptotically stable the detailed proof is given in theorem 4 similarly boundary layer systems 36 and 37 can be treated again like a two time scale singular perturbed problem define a stretched time scale κ κ 0 ε 1 differentiating 36 with respect to κ yields boundary layer systems 39 d d κ θ 1 i θ 2 i d d κ θ 2 i 1 m 55 τ q i f ˆ θ i θ d setting ε 1 0 the solution of quasi steady state θ i f 3 p i ψ i f 3 p i f 2 p i 0 is θ ˆ i d substituting it into 37 yields the reduced order system 40 ψ 1 i ψ 2 i ψ 2 i g ψ i θ ˆ i d m 66 τ r i f ˆ ψ i ψ d the stability analysis of the system shown in equations 39 and 40 is given in theorem 3 the above proof satisfies the sufficient conditions of theorem 11 4 in khalil 2019 to claim that there exists some constants ε and ε 1 satisfy ε ε 0 and ε 1 ε 1 0 respectively guarantee that the systems 14 and 15 are asymptotically stable this complete the proof theorem 3 under the directed position communication topology g p v p ε p a p and speed communication topology g v v v ε v a v consider the fast subsystem 36 and 37 of the multi underactuated auv formation system under the action of the integral sliding mode controller 23 and the auxiliary control variable 24 there exists α ψ α θ β ψ β θ which guarantee the fast subsystems 36 and 37 asymptotically stable or more specifically the whole multi underactuated auv formation system has a consensus and stable attitude proof without loss of generality this section only provide the proof of 36 first consider a positive definite lyapunov function 41 v θ 1 2 s θ t s θ s θ s θ 1 s θ 2 s θ 3 t taking the first time derivative of 41 yields v θ s θ t k θ i s θ i ρ θ i s i g n s θ i 0 the integral sliding mode controller 23 guarantee s that the pitch subsystem state can be reached and maintained on the sliding surface s θ i next when the system state is on the sliding surface i e s θ i s θ i 0 it can be obtained 42 d d κ θ p i θ v i d d κ θ i h θ θ i 0 1 α θ 1 β θ θ p i θ v i therefore system has exponential stability at equilibrium point if there exists the match parameters α θ and β θ such that h θ is hurwitz thus due to the auxiliary control variables θ 1 i and θ 2 i are asymptotically converge to 0 similarly there exist parameters α ψ and β ψ guarantee the system 37 asymptotically stable this complete s the proof theorem 4 under the directed location communication topology g p v p ε p a p and speed communication topology g v v v ε v a v consider the slow subsystem 38 of the multi underactuated auv formation system under the action of the integral sliding mode controller 23 and the auxiliary control variable 24 there exists α x α y α z β x β y β z which guarantee s the slow subsystems 38 asymptotically stable or more specifically the whole multi underactuated auv system accurately tracks the desired trajectory and has a stable formation proof without loss of generality this section only provide the proof of x subsystem in 38 first consider a positive definite lyapunov function 43 v x 1 2 s x t s x s x s x 1 s x 2 s x 3 t differentiating 43 yields v x s x t k x i s x i ρ x i s i g n s x i 0 the integral sliding mode controller 23 guarantee s that the x subsystem state can be reached and maintained on the sliding surface s x i next when the system state is on the sliding surface i e s x i s x i 0 it can be obtained 44 x p i x v i x i h x x i 0 1 α x 1 β x x p i x v i therefore system has exponential stability at equilibrium point if there exists the match parameters α x and β x such that h x is hurwitz simultaneously x 1 i and x 2 i are asymptotically converge to 0 similarly there exists parameters α y α z β y β z guarantee the y and z subsystem in 38 asymptotically stable in other words the whole multi underactuated auv system accurately tracks the desired trajectory and has a stable formation this complete the proof 4 simulation results and discussion to illustrate the performance of the proposed controller numerical simulations have been performed by using related simulation software moreover the time scale decomposition phenomenon in the system will also be verified by simulation the parameters of the nonlinear auv mathematical model are the same as those in yan et al 2019 in this section the auv formation consists of one leader and four followers and the position velocity two layer communication topology is shown in the fig 4 where the blue arrow indicates the location communication topology and the black arrow indicates the speed communication topology the auv1 indicates the leader of the formation and the others are the followers of the formation it can be obtained from definition 1 when all follower auvs track and converge to the desired trajectory the formation is formed according to the fig 4 the laplacian matrix of the formation double layer communication topology is 45 l g p l g v 2 1 1 0 0 0 1 0 1 0 0 1 2 0 1 0 1 0 1 0 0 0 0 1 1 in order to demonstrate the 3 d coordinated movement ability of the formation system the mission scenario is considered multi underactuated auv formation tracking a spiral diving curve while maintain a formation in the presence of the lumped uncertainty of the system the detailed desired trajectory is x 10 sin 0 1 t y 10 cos 0 1 t z 0 1 t and the initial positions of each auv in the formation are arbitrarily distributed in the three dimensional space of 10 10 5 5 5 0 the simulation time range is 100s according to wang et al 2020b in this paper two disturbance models are used to verify the superiority of the proposed controller one is represented as τ i d τ d u τ d v τ d w τ d q τ d r t 0 01 m 11 m 22 m 33 m 55 m 66 t which are usually employed to describe slowly time varying disturbances far from the water surface and the other is represented as d t d d t w ω which can be employed to describe external disturbances owing to the second order wave drift and measurement noise d t τ i d τ d u τ d v τ d w τ d q τ d r t other specific parameters are given in wang et al 2020b the lumped uncertainty of the system are chosen as 46 the controller and the ehgos are implemented with the parameters as follows σ 1 0 05 σ 2 0 02 σ 3 0 001 ε 0 3 ε 1 0 2 l s 1 20 l s 2 15 l s 3 6 l f 1 20 l f 2 15 l f 3 6 5 α x α y α z 1 β x β y β z 2 α θ α ψ 1 5 β θ β ψ 2 5 k j 0 2 j x y z θ ψ ρ j 1 j x y z θ ψ 46 f x i m 33 w i q i m 22 v i r i d 11 u i m 11 cos ψ i cos θ i m 11 u i r i d 22 v i m 22 sin ψ i m 11 u i q i d 33 w i m 33 sin θ i cos ψ i u i r i sin ψ i u i q i cos ψ i sin θ i v i r i cos ψ i cos θ i w i q i cos θ i cos ψ i w i r i sin θ i sin ψ i cos θ i τ d u f y i m 33 w i q i m 22 u i r i d 11 u i m 11 sin ψ i cos θ i m 11 u i r i d 22 v i m 22 cos ψ i m 11 u i q i d 33 w i m 33 sin θ i sin ψ i u i q i sin ψ i sin θ i u i r i cos ψ i v i r i sin ψ i cos θ i w i q i cos θ i sin ψ i w i r i sin θ i cos ψ i cos θ i τ d v f z i m 33 w i q i m 22 v i r i d 11 u i m 11 sin θ i m 11 u i q i d 33 w i m 33 cos θ i u i q i cos θ i w i q i sin θ i τ d w f θ i m 33 w i u i m 11 u i w i d 55 q i g m 55 τ d q f ψ i m 22 v i u i m 11 u i v i d 66 q i m 66 cos θ i r i q i sin θ i cos 2 θ i τ d r 4 1 control performance discussion in the sequel two groups of simulation experiments show the control performance of the proposed controller under different disturbance models the simulation results of the first disturbance model are shown in figs 5 11 as shown in the fig 5 the lines of different colors represent the paths and the trajectories of different auv auv1 is the leader auv fig 5 shows the 3d trajectory of the tracking process of the formation using a two layer independent fixed communication topology under the condition of lumped uncertainty composed of slowly time varying disturbances far from the water surface and uncertain nonlinearities each auv can complete the process of gathering with other auv in any initial state figs 6 and 10 show the position and attitude states of the auv formation and the position error between each auv and the desired trajectory respectively from the above two pictures it can be observed that each auv tends to be consensus with the spatial position of other members in the formation which verifies the effectiveness of the proposed formation controller the settling time accounts for only 1 3 of the simulation time all the curves converge smoothly and the settling time is short which reflects that the observation effect of the ehgos is remarkable fig 7 shows the speed state of the auv formation the desired longitudinal velocity u d 1 m s and yaw angular velocity r d 0 1 r a d s can be calculated from the desired trajectory it can be seen from fig 7 that the longitudinal velocity and yaw angular velocity of each auv can quickly reach their desired values respectively however it can be found that the lateral velocity v does not converge to 0 the main reason is that the research object of this paper is the multi underactuated auv formation system and its lateral and vertical dynamics cannot provide control force and torque directly while in the spiral diving high speed tracking mission its ever changing yaw angle makes the nonlinear coupling of auv dynamics more intense fig 8 shows the changes in the control inputs that are actually available for each underactuated auv it can be seen that the proposed controller has sensitive response and the output curve is smooth and stable due to the disturbance compensation of ehgos moreover the system chattering can be suppressed in the proposed controller figs 9 and 10 depicts the position attitude and lumped system uncertainty observation of each auv in the formation by ehgo it can be observed that the uncertainties and the formation states can be accurately observed by ehgo and the peaking time of ehgo is short the simulation results of the second disturbance model are shown in figs 12 18 the similar parts of the two groups of simulation will not be repeated the differences however in following aspects 1 as shown in figs 13 and 14 the position and attitude states have a large shock in the adjustment process and the settling time increases obviously this is due to the change of the reference state caused by the high frequency measurement noise from the sensor at the same time the tracking of the path also leads to the oscillation around the desired trajectory 2 as shown in fig 15 during the convergence of each auv s velocity state there are constant amplitude oscillations and even local oscillations the reason is the same as above 3 similarly as shown in fig 16 the influence of high frequency measurement noise on the controller is obvious the output curve of the controller is always in a time varying state 4 as shown in figs 17 and 18 combined with the above practical results the observation and compensation of ehgos for system uncertainty and high frequency measurement noise can guarantee that it converges to the compressed bounded set near zero but it also reflects the above time varying characteristics the fast time varying characteristic of high frequency measurement noise leads to a significant increase in the settling time of the formation but the formation controller can guarantee the continuous and stable state of each member in the formation when the position and attitude state converge to zero the main reason is that 1 the dynamic performance of ehgo is faster than that of the whole system so it does not need system disturbance is slow time varying khalil 2017 2 the strong robustness of integral sliding mode controller even if there is a deviation in the system the controller can guarantee that the state of the system returns to the integral sliding mode surface as can be seen from fig 6 or fig 14 at t 30 s the attitude of each auv in the formation tends to be consistent while the position state of each auv in the formation tends to be consistent at t 40 s in the convergence of attitude state the convergence rate of the pitch is faster than that of the yaw but it is not obvious and there is almost no overshoot the obvious time scale decomposition phenomenon can also be found in figs 9 and 11 or figs 17 and 18 that is the convergence speed of the attitude observer subsystem is obviously faster than that of the position observer subsystem and within the attitude observer subsystem the pitch observer subsystem is faster than the yaw observer subsystem the reason for the above phenomenon is that as mentioned in the previous remark 3 and theorem 1 the position observer subsystem simultaneously uses the attitude observation value θ ˆ i and ψ ˆ i from the attitude observer subsystem while the yaw observer subsystem uses the pitch observation value θ ˆ i so that the pitch angle observer subsystem has the fastest dynamic therefore the simulation results show that ehgo has obvious characteristics of three time scales since the lumped uncertainties observed by ehgo are to be compensated in the controller the time scale separation will also occur in the convergence of formation position and attitude in this way the system can be analyzed independently in each time scale and the difficulty of designing the controller is reduced based on the above simulation results it can be observed that the proposed formation controller can not only track the desired trajectory but also keep the formation stable in addition in the presence of system uncertainty and different environmental disturbance models the formation can still maintain good performance therefore these simulation results adequately prove the effectiveness of the proposed controller and verify the relevant theorems proposed 4 2 comparative analysis in this section a comparison with a consensus method yan et al 2017 is proposed the simulation scenario is that auv1 tracks the desired trajectory in the presence of uncertain nonlinearity and external disturbance simulation results are illustrated as figs 19 20 it can be clearly found from figs 19 20 that under the control algorithm proposed in yan et al 2017 the convergence speed of the formation is slower and the settling time of the formation is longer due to the lumped system uncertainties complex hydrodynamic coupling and nonlinear relationship of the auv the position and attitude states of the formation change violently and require longer settling time the settling time accounts for almost half of the simulation time however under the controller proposed in this paper the settling time accounts for only 1 3 of the simulation time because the time scale decomposition in formation control is not taken into account the formation shows obvious hysteresis and state disorder moreover the transformation of the communication topology also leads to the continuous change of the reference state and increases the state fluctuation of the self adjustment process however it guarantees that all members in the formation can receive the motion state information of the formation so as to ensure that the formation can still achieve stable state 5 conclusion a formation control method for multi underactuated auv systems with uncertain nonlinearities and environmental disturbances was presented from a practical point of view that is an important contribution since the time scale decomposition between position subsystem and attitude subsystem in formation control system is uniquely analyzed based on singular perturbation theory the stability and convergence of the system dynamic are analyzed independently in each time scale and exponential stability of the equilibrium is established integral sliding mode controller incorporated with ehgo has been effectively utilized to deal with uncertain nonlinearities and environmental disturbances for a higher estimation precision finally a series of numerical simulations are carried out to illustrate the control performance of the proposed controller ultimately it is necessary to point out that we only study the situation in which high frequency measurement noise is regarded as environmental disturbance but not its direct effect on ehgo in practice the next work is devoted to dealing with such problems in addition the case that the inertia matrix is a non diagonal matrix in the auv model will be taken into account declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51879049 and the natural science foundation of heilongjiang province china grant no jj2019lh2279 
20769,multi peaked directional wave spectra based on extensive field measurement data in the gulf of oman mohammad adibzade mehdi shafieefar hassan akbari roozbeh panahi department of civil and environmental engineering tarbiat modares university tehran iran department of civil and environmental engineering tarbiat modares university tehran iran department of civil and environmental engineering tarbiat modares university tehran iran corresponding author multi peaked directional wave spectra have been estimated by the well known maximum likelihood method and modeled by applying a numerical optimization approach that uses a gradient oqnlp algorithm the research is based on field measurement data from a 210 km long area at the northern coasts of the gulf of oman this modeling approach allows the fitting of various spectral models accordingly three directional spectrum models with combinations of frequency and directional spreading functions have been evaluated and proper models for directional waves have been presented on the other hand the introduced optimization algorithm is modified by adding a constraint to zeroth order spectral moment m0 value to improve the fitting accuracy in the frequency spectrum it has been shown that selecting the appropriate model for each of the frequency and directional functions can significantly improve the performance of both among the evaluated directional models the accuracy of the results based on both jonswap sech2 and gamma sech2 models was about 25 better in the frequency domain and about 10 better in the full directional domain than jonswap cos2s model besides in most of the observed swell components because of their wide spectrums with low peak values the use of the gamma frequency model performs better than the jonswap model keywords multi peaked wave spectra directional wave spectra wave spectra wave measurement 1 introduction offshore and coastal structures must be safe and stable against wave loads with different frequencies and directions therefore accurate description of a directional wave spectrum at a specific location is required for designing offshore and coastal structures different statistical procedures like maximum entropy method mem maximum likelihood method mlm wavelet directional method wdm or parametric models have been developed to estimate the directional wave spectrum from various types of field measurement data longuet higgins et al 1963 borgman 1969 isobe et al 1984 kobune and hashimoto 1986 kuik et al 1988 these methods have been compared by some researchers alves and melo 1999 donelan et al 2015 and have been reviewed and categorized by benoit et al 1997 generally a directional wave spectra s f θ consists of a frequency spectrum or energy spectrum s f that reflects wave energy in the frequency domain and a directional spreading distribution q f θ that describe how wave energy is distributed in the directional domain the traditional relation for modeling is as s f θ s f q f θ where the frequency spectrum is modeled by a well known one peaked spectrum model like pierson moskowitz or jonswap spectrum based on various sea states see guedes soares and moan 1991 and also the directional spreading distribution is a one peaked model like cos2s or sech2 functions see krogstad et al 1997 in the past few decades most spectral models have addressed only one peaked spectra however there are some sea states including a wind sea component in combination with one or more swell components which have been generated far from the area and has reached to the area these swells superimpose on wind sea waves and produce complex sea states that result in bimodal or even multi peaked spectra strekalov et al have proposed double peaked spectra to describe the combined sea state and implemented a pierson moskowitz spectrum for the wind sea component and a normal distribution for the swell component of a wave field strekalov et al 1972 later ochi and hubble proposed a set of double peaked spectra based on 800 spectra of wind waves at nine ocean weather stations at the north atlantic ocean with six parameters that describe each component by a gamma function ochi and hubble 1976 guedes soares on the other hand has proposed a four parameter spectral model to describe the combined situation of the swell and wind sea by two jonswap spectra while he has provided an excellent fit to the measured wave spectra from the north atlantic ocean and the north sea guedes soares 1984 torsethaugen has proposed a five parameter double peaked model by implementing the jonswap shaped model for each of the wave components he determined the representative values for the norwegian continental shelf torsethaugen 1993 due to the complexity of his model after a decade he proposed a simple model based on the main one by reducing free parameters to be more applicable without a significant loss of validity torsethaugen 2004 several studies have been conducted in the field of frequency wave spectra especially double peaked spectra on the northern part of the gulf of oman e g ghazangian et al 2015 panahi et al 2015 panahi et al 2016 golpira et al 2019 akbari et al 2019 investigated the capability of the jonswap model in describing the double peaked spectra by adopting over two sets of measurements at the gulf of oman using two different calibration methods in another article they have proposed a gaussian model for representing the primary system in double peaked spectra and a jonswap for the secondary system they have shown that using the gaussian model for the primary system is essential as it increases the overall performance of the calibrated double peaked spectra by about 50 which is more obvious in those dominated by the primary system akbari et al 2020 boukhanovsky and guedes soares 2009 have generalized the one from guedes soares 1984 and proposed an approach for modeling the multi peaked directional wave spectra for model identification and estimation of the spectral parameters of each component they applied a numerical optimization technique that uses the random linear search algorithm the total number of wave components in the spectra is identified using an iterative procedure their proposed approach allows the fitting of different spectral models to the measured wave data the hipocas data for the north atlantic were used for a case study however the differences in the performance of the modeling technique and the directional characteristics were not investigated using various directional spreading distributions by the availability of directional wave properties many approaches have been developed to classify the different wave components embedded in the wave spectrum e g gerling 1992 hasselmann et al 1994 hanson and phillips 2001 portilla et al 2009 lucas and guedes soares 2015 the main procedure usually involves the following two major steps a it starts by identification of local spectral peaks in the complete space of frequency and direction b then the association or combination of the spectral ordinates into individual common wave components the method of hanson and phillips 2001 using information about the wind and a grid of data points allows the tracking of the source of storms lucas et al 2011 applied a wave steepness method the non dimensional steepness for separating the wind sea and swell in the wave spectrum which does not require more information than the spectral ordinates panahi et al 2015 used a set of data measured in 2006 to provide a directional wave spectrum for double peaked spectra in a coastal region of the gulf of oman chabahar bay encountering both wind sea and swell to do this they adopted the non directional torsethaugen spectrum by entering the separation frequency the frequency in which the wind sea and swell components could be separated and three directional distribution functions they determined the best directional distribution for describing the observed spectra the directional characteristics other than those obtained from the double peaked spectra were not investigated the present article was motivated by the availability of a series of wave measurements from a recently established network of nortek acoustic wave and current profiler awac 2018 along the southern iranian coast this available directional information paves the way for better descriptions of the wave climate than just the 1d frequency spectrum in addition the wave spectrum and complex sea states have received a lot of attention in the recent years due to their significant effects in sea keeping safety offshore structures design small boat operations and ship passage over the harbor entrance wave forces on pipelines etc teixeira and guedes soares 2009 huang et al 2020 akbari and pooyarad 2020 all in all there is a lack of a comprehensive study of multi peaked directional spectra including one peaked double peaked three peaked or more to evaluate different models and provide wave characteristics our research is firstly conducted to provide a brief description of the main patterns of the wave climate at a 210 km long area of the northern part of the gulf of oman using measured wave data during 2016 this paper presents the estimation of the directional wave spectra by the well known maximum likelihood method it also deals with a numerical optimization technique that uses a gradient oqnlp algorithm this technique identifies the existing wave systems in given multi peaked spectra and fits parametric models to each of the individual systems it will be shown that the resulting directional models are capable of describing complex sea conditions in the frequency and directional domains also the capability of these models will be compared with each other these models were made through 1 the well known standard jonswap frequency spectrum with the more traditional and popular cos2s directional distribution 2 jonswap with sech2 directional spreading distribution first derived by donelan et al 1985 and 3 gamma frequency model with sech2 distribution the rest of this paper is structured as follows section 2 explains local measurements and estimation procedure of directional wave spectra while section 3 summarizes the formulation of multi peaked directional spectra the methodology of model identification through fitting can be found in section 4 comparative analysis of directional models is presented in section 5 followed by the variability of spectral parameters in section 6 finally the conclusion can be found in section 7 2 local measurement and data processing generally wave directional characteristics are obtained either from measurements of wave properties like surface elevation slopes or displacements in the east and north directions at one point or from the measurements of the same wave property e g surface elevation at three or more points recent years have seen the development of a new class of acoustic systems that can measure the directional wave properties in addition to current profile the wave data in this study have been extracted from a series of measurements conducted in 2016 at seven stations across more than 210 km of the northern parts of the gulf of oman using nortek acoustic wave and current awac profiler the awac is an optimal tool for wave measurements with a maximum depth of 35 m awac 2018 the location of such stations is illustrated in fig 1 details of each station are presented in table 1 stations no 8 9 and 10 in fig 1 refer to the 2006 measurements and have not been used in this study in the region of study there are generally two dominant wave directions from the west from the persian gulf and from the southeast from the indian ocean the predominant direction of swell waves are generally from the southeast but the direction of wind waves is more scattered these swells superimpose on wind waves and produce complex sea states that result in bimodal or even multi peaked directional spectra these different wave systems cannot be distinguished in the measured time series of wave profile because of their irregular nature and their coincidence however they can be detected efficiently based on their frequency content in the wave spectrum to measure the directional properties of waves the awac uses three acoustic beams at an angle of 25 to the vertical these beams are dedicated to measuring velocity also a fourth beam pointed upward is dedicated to measuring the sea surface position the awac capabilities have improved considerably with the introduction of the ast feature acoustic surface tracking which is a method of directly measuring surface elevation and allows to overcome the traditional shortcomings of the estimates from either the pressure or the velocity measurements pedersen et al 2005 compared the results of a datawell waverider buoy that was located only 20 m away from an awac deployed in 25m of water nortek storm v1 14 software is applied in this study to estimate the directional wave spectra s f θ nortek storm estimates the directional spectrum based on the mlmst method mlmst is the maximum likelihood method with surface tracking and is a special type of array processing that is well suited for awac wave measurements maximum likelihood method is a high resolution method for seismic processing developed by capon 1969 and later has become known as a method for directional spectra estimation this method is quite widely used for estimating multi peaked directional spectra and has proven to have a good level of accuracy davis and regier 1977 and borgman 1985 implemented this method in the context of ocean wave spectra the methodology used to identify events and select the spectra is similar to what was proposed earlier by panahi et al 2015 and akbari et al 2019 they utilized a threshold level to select the events with the significant wave height more than 0 9m such a procedure led to a total of 454 spectra and we will discuss the formulation and the application of the modeling approach to a few samples of those spectra in sections 3 and 4 3 formulation of multi peaked directional wave spectra the total directional spectrum for a general sea state consists of one or more wind sea and swell systems expressed as below 1 s f θ i 0 n s i f θ where the index value i is associated with the wave component number and n is the total number of wave components embedded in the spectrum it is more convenient to write the full directional wave spectrum s f θ as a product 2 s f θ s f q f θ of the frequency spectrum s f and the directional spreading function q f θ satisfying 3 0 2 π q f θ d θ 1 each wave system in eq 1 is represented by a one peaked spectrum model s f θ according to eq 2 this model is a combination of a frequency spectrum s f and a directional spreading function q f θ the first item reflects the wave energy in the frequency domain and the second one describes how wave energy is distributed in the frequency directional domain the most common representation for the frequency spectrum s f is jonswap spectrum jonswap spectrum is used in this study as follows hasselmann et al 1973 4 s j o n s w a p f m 0 f p γ c f f p 5 exp 5 4 f f p 4 γ a a exp f f p 2 2 σ 2 f p 2 σ 0 07 f f p 0 09 f f p where γ and σ are peak enhancement factor and shape parameter respectively f p is the peak frequency of the spectrum and the constant c is adopted here as follows goda 1979 5 c 5 m 0 f p 1 15 0 1688 γ 0 925 1 909 γ 1 an alternative representation of frequency spectrum by means of gamma spectrum used in the present paper is expressed as below boukhanovsky and guedes soares 2009 6 s γ f m 0 f p n m 0 n f p f f p n exp n n 1 f f p 1 n where the peak shape and width of the spectrum are governed by the value of n for modeling q f θ in eq 2 two directional spreading functions are used separately one of these functions is close to the well known cos2s directional distribution longuet higgins et al 1963 mitsuyasu et al 1975 which is implemented by boukhanovsky and guedes soares 2009 7 d f θ θ s c s cos 2 s f θ θ f θ θ f π 2 0 θ θ f π 2 where c s is a normalizing parameter required for satisfying eq 3 and s is the spreading parameter which controls the range of directional spreading around the mean direction θ and its value is increasing with the overall intensity of sea waves s and θ vary with the wave frequency and their dependence is expressed as 8 θ f θ p a θ f f p 9 s f s p f f p β f f p s p f f p β f f p where θ p and s p are the values of parameters at the peak frequency and a θ and β control the direction distribution around the peak values donelan et al 1985 argued that the directional distribution represented by eq 7 was not adequate so they proposed the following alternative parametric form for the directional distribution that we used in the present article 10 d f θ θ β 0 5 β sech 2 β θ θ f donelan et al 1985 found that β governs the width and is a function of the relative frequency the following expression is implemented here for the parametric representation of β 11 β f β p 1 f f p β 0 56 f f p 0 95 β p 2 f f p β 0 95 f f p 1 6 10 0 4 0 8393 exp 0 567 ln f f p f f p 1 6 where β f for values of f f p 1 6 in eq 11 was suggested by banner 1990 while donelan et al 1985 had assumed it was constant authoritative studies donelan et al 1985 banner 1990 young 1994 about directional wave spectra have shown that the parameterization of the directional distribution in the form of eq 10 yields a better match to the measured wave data and is more reliable than the common cos2s distribution however since cos2s are still widely used as the simple distribution with a lot of applications in engineering practice both directional spreading distributions will be implemented for modeling the purpose here thus for comparative analysis of the parametric models of multi peaked directional wave spectra based on eq 1 we made three models using the form of eqs 2 and 4 11 these models include 1 jonswap frequency spectrum with cos2s directional distribution 2 jonswap with sech2 directional distribution and 3 gamma frequency model with sech2 distribution to construct each of these parametric models we first need to know the total number of wave systems existing in the spectrum the number of n in eq 1 afterward for each wave system e g wind sea or swell component the set of unknown parameters is required for the jonswap cos2s based model on eqs 4 and 7 the set of parameters ξ i m 0 i f p i θ p i γ i s p i a θ i β i β i for the jonswap sech2 model on eqs 4 and 10 the parameters ξ i m 0 i f p i θ p i γ i β p 1 i β p 2 i a θ i β i β i and for the gamma sech2 model on eqs 6 and 10 ξ i m 0 i f p i θ p i n i β p 1 i β p 2 i a θ i β i β i are required in the next section we present a brief description of the main procedure toward identifying the number of wave systems n and the model parameters 4 model identification through fitting there are several techniques of fitting e g kuik et al 1988 panahi et al 2015 for obtaining the model parameters in eq 1 but the core of this section is similar to what was proposed by boukhanovsky and guedes soares 2009 in which the measure of fit according to eq 1 is functional to be minimized 12 j n ξ 0 0 2 π s f θ s f θ ξ 2 d f d θ n ξ m i n where s is the estimated directional wave spectrum by nortek storm v1 14 and s f θ ξ is the constructed parametric model by eq 1 numerically s f k θ l s k l are the values of the estimated directional spectrum at a regular grid point with 48 rows corresponding to discretized frequency by 0 01 hz 0 02 0 01 0 49 hz and 90 columns corresponding to discretized direction by 4 0 4 356 here it should be noted that the full directional wave spectrum s k l was calculated by multiplying the estimated frequency spectrum and the relevant directional distribution based on eq 2 to obtain model parameters and the construction of parametric model boukhanovsky and guedes soares 2009 has compared three explicit semi explicit and fully implicit methods and concluded that the last one is the best for multi peaked wave spectra with some smoothed peaks accordingly we use the fully implicit technique in which all model parameters of eq 1 and also the total number of wave systems n are obtained by means of numerical optimization of eq 12 now eq 12 is the target function that must be minimized with respect to the known estimated spectrum s k l and the unknown parametric model s f θ ξ which is dependent on both the discrete number of n and the values of continuous parameters ξ continuous parameters ξ are obtained by means of a sequential optimization procedure for the values of n 0 1 2 nowadays many optimization techniques have been developed and their capabilities have been explored by several authoritative studies dixon and szego 1978 one of the most useful and convenient methods are the family of gradient methods with a lot of applications in engineering practice one of these is oqnlp algorithm that was described in ugray et al 2007 and was designed to find global optima of problems with smooth objective and constraint functions as the problem of eq 12 with wave spectra data the optimization procedure of the oqnlp algorithm is briefly described in fig 2 now in order to make the optimization process clearer we consider one of the multi peaked spectra such as fig 3 a estimated from the measurement data and we want to fit a gamma sech2 model to it modeling this spectrum begins by assuming that the number of wave systems in spectra is equal to 1 or n 0 in eq 1 then an initial value is dedicated to each of the parameters of the directional model based on eqs 6 and 10 it should be noted that an appropriate initial value for peak parameters m 0 0 f p 0 θ p 0 can be obtained directly from the estimated spectra and the shape parameters n β p 1 0 β p 2 0 can be chosen in accordance to traditional recommendations e g n 5 β p 1 0 2 61 and β p 2 0 2 28 by means of the optimization procedure the optimal values of the nine parameters for the main wave system of the target spectrum are provided fig 3 b at the next stage a double peaked model n 1 is fitted by the above mentioned procedure and the optimal values of eighteen parameters for two wave systems according to the target spectrum are obtained fig 3 c the calculated j n 1 ξ in this step is compared with the calculated j n 0 ξ in the previous step if j n 0 ξ j n 1 ξ α then the optimization procedure must continue for n 2 and the directional model is required to be at least double peaked otherwise a single peaked model is enough for the modeling purpose numerical experiments showed that the best value for α is equal to 1 5 considering j n ξ values in fig 3 we must check the significance of the third peak in eq 1 and approximate the optimal values of the total parameters for a three peaked model this process continues until the discrepancy in the values of eq 12 for n 1 terms is less than 1 5 times that for n terms it is worth mentioning that for any spectrum defined by eqs 4 and 6 to assure realistic and positive spectral moments and for consistency of the optimization process in eq 12 we should consider some additional constraints e g n 2 s 1 β 1 and γ 1 also an upper limit can be considered for these parameters from practical experiences based on the results of the modeling presented in the next section and inspired by akbari et al 2019 using the conservation of spectral moments to calibrate double peaked spectra here we have been persuaded to make some modifications to the above mentioned optimization procedure by using an additional constraint as below to equalize the value of the calculated moments from the modeled and target spectrum 13 i 0 n m 0 i m 0 m e a s u r e d after estimating the total number of spectral peaks n and the optimal values of parameters ξ identifying and separating the local wind wave and swell components in a wave field can help to have a clearer perception of the conditions governing the sea state and is very important from the engineering point of view among several methods developed wang and hwang 2001 portilla et al 2009 liu et al 2015 we implemented the one dimensional steepness lucas et al 2011 for separation between wind sea and swell components defined as 14 δ h s λ p 2 π h s g t p 2 8 π g m 0 f p 2 where λ p and t p are the wave length and period associated with the each spectral peak if the steepness is δ 0 011 then the wave component is considered as the wind wave and otherwise a swell is expected 5 comparative analysis of multi peaked directional spectrum models measured directional wave information at seven stations in the northern part of the gulf of oman provides the required spectra for evaluating the performance of directional spectral models on the basis of eqs 1 and 2 in fig 4 there are examples of frequency spectra s f and the integrated directional spreading function q θ fitting with the described directional models on the basis of eq 12 the wave data from four stations pasabandar pozm meydani and galak are used for case studies there were three sorts of directional models in eq 1 including jonswap cos2s eqs 4 and 7 with the variable parameters γ and s jonswap sech2 eqs 4 and 10 with the variable parameters γ and β and gamma sech2 eqs 6 and 10 with the variable parameters n and β for quantitative comparison of fitting in frequency domain deviation index d i proposed by liu 1983 and implemented by henriques and guedes soares 1998 is adopted here as follows 15 d i i 1 n 100 s f i s f i s f i s f i δ f m 0 where s stands for the modeled spectrum and s is the measured one in table 2 the values of d i associated with fig 4 are shown additionally for a quantitative comparison of fitting in the frequency direction domain the normalized dimensionless approximation errors are presented in table 2 as 16 e r r o r j n ξ h s the target directional spectrum in fig 4 a1 a2 has two clear peaks in the directional spectrum but the frequency spectrum shows only one peak this means that the peak frequencies of the two wave systems are close to each other but in the directional domain their peaks are separated clearly the main advantage of the presently described technique based on eq 12 is that it involves the directional information to fit this type of spectrum and allows one to obtain more reliable results it should be noted that both systems are swell from table 2 it is seen that the d i values for all three cases are lower than 11 the fitting satisfactory range for the values of d i is lower than 25 30 liu 1983 so all the fitted models are close to each other and matched to the measured spectrum as can be seen in fig 4 a2 jonswap cos2s does not perform well in the directional domain and the value of fitting error for this model is more than that in the other two models the complicated cases of double peaked wave spectra are shown in fig 4 b1 b2 and fig 4 c1 c2 fig 4 b1 represents a wind sea dominated spectrum with a weak swell system while fig 4 c1 demonstrates a swell dominated spectrum in which the two wave components are almost overlapping in general there are some other small peaks in the full directional spectrum they are overlooked due to their little effect on the optimization process for example the left most peak in fig 4 b2 is neglected in the optimization process and it is considered as two peaked spectra the mismatch of the wind sea peaks in parametric models with the measured spectrum in fig 4 b1 may be due to the non participation of these small peaks the gamma sech2 model fitting with eq 6 10 is closer to the target spectrum than the two jonswap based models both in frequency and direction domain by comparing the values of d i and error for jonswap based models in table 2 it can be seen that the substitution of the cos2s directional distribution with sech2 has improved the fitting accuracy in the frequency and directional spectrum fig 4 d1 d2 represents a more complicated case of combined seas with four peaks in the directional spectrum each of the frequency spectra s f fig 4 d1 and the integrated directional spreading function q θ fig 4 d2 shows only two peaks two swell systems and two wind sea components exist in the wave field the two swell peaks are spaced apart by about 0 02 hz in the frequency domain and 50 in the directional space the corresponding values for the wind sea components are about 0 01 hz and 75 for this case adopting the present method allows one to select and fit the parametric model on each of the peaks and leads to a more reliable parametric representation of the spectral shape the d i values for all the three cases are lower than 23 all the fitted models are almost close to each other but still the best is the gamma sech2 model due to the error values in table 2 here the models involving the sech2 directional distribution function performed better in both frequency and directional spaces all in all choosing the appropriate directional distribution can dramatically affect the accuracy of fitting in both frequency and directional domains according to the results for all the modeled spectra replacing the cos2s distribution with the sech2 reduces the mean d i value by about 25 and the mean error value by around 10 the cos2s function did not perform well in spectra with some smooth peaks or overlapping wave systems numerical solution convergence was more difficult in models involving the cos2s than other models also the frequency model plays an important role in the accuracy of the resulting full directional spectrum in 68 of the studied spectra the accuracy of the fitting based on the gamma sech2 model was better than the jonswap sech2 the gamma frequency model despite good results in modeling overestimates the middle part of the two wave components due to its larger tail than the jonswap see fig 4 b1 fig 5 a1 and b1 show the two spectra measured from pasabandar station in the form of a contour the frequency spectra s f in both logarithmic and normal scales is also provided along with contour plots to show the high frequency details of the spectra below each of these figures three parametric models obtained based on jonswap cos2s jonswap sech2 and gamma sech2 are shown the first case fig 5 a1 has three obvious and almost separate peaks while its frequency spectrum has two overlapping peaks therefore these peaks cannot be defined correctly based on only using the frequency spectrum based on the one dimensional steepness eq 14 a swell system and two local wind sea systems have been identified as shown in fig 5 a2 a swell component and only a wind sea component were identified by the jonswap cos2s model in such cases that two wave systems with different directions have similar frequencies the cos2s is not able to accurately separate these two overlapped systems in the directional domain the d i and the error values for this model are 20 5 and 0 075 respectively in contrast the other two models including the sech2 distribution fig 5 a3 a4 well model the three systems in the spectrum the d i and the error values for the jonswap sech2 and the gamma sech2 models are 12 1 0 050 14 9 and 0 049 respectively the second case fig 5 b1 has three overlapping peaks for such a directional spectrum only one obvious peak in the frequency spectrum is visible all three systems are of the swell type the d i value for the jonswap cos2s model in fig 5 b2 is 18 3 and the error is 0 062 despite the good accuracy of this model in the frequency domain one of the components is not identified the fitting accuracy using the jonswap sech2 model fig 5 b3 significantly improved accordingly the value of d i decreased to 16 8 and the error to 0 047 which indicates an about 25 improvement in the results of the directional spectrum a noteworthy point in modeling this spectrum using models that include jonswap is that the γ values in eq 4 are equal to 1 for all identified wave systems therefore since the γ parameter cannot be less than 1 it will no longer participate in the process of optimizing and improving the results in such cases using the gamma spectrum gives better results due to having the variable parameter n see eq 6 here according to fig 5 b4 it can be seen that the most match with the measured spectrum is related to the gamma sech2 model the d i and the error values for this model are 14 2 and 0 042 respectively in fig 6 the calculated values of significant wave height hm0 are compared by integration of the target spectrum matrix and the modeled one the difference in the values of hm0 was assessed using the root mean square error r m s e which is calculated as follows 17 r m s e i 1 n h m 0 m e a s u r e d h m 0 e s t i m a t e d 2 n where n is the total number of events examined additionally the ratio of the average values of the estimated hm0 based on the parametric models including joswap cos2s jonswap sech2 and gamma sech2 to the average values of hm0 from the target spectrum is 0 89 0 92 and 0 97 respectively rmse and ratio values mean that the parametric representation using the present technique does not conserve the values of m0 of the measured spectrum and in most cases the value of the parametric model is less than the corresponding value of its measurement this has led us to address this issue by adding a constraint to conserve the actual m0 in the parametric model for this purpose we use the constraint in the form of eq 13 during the optimization process and refit the jonswap sech2 directional model using the modified approach the ratio of the average values of hm0 from the parametric models to the average of their corresponding values based on the target spectrum was equal to one using this constraint as shown in fig 6 d the rmse values are also reduced to 0 02 this means that the difference between the actual value of m0 and the parametric representation is significantly reduced it should be noted that adding such a constraint according to eq 13 in the optimization algorithm does not necessarily mean that the values on both sides of the equation will be equal and sometimes the values on both sides may be slightly different from each other for a deeper analysis of such a constraint effect in the fitting procedure a simple two peaked spectrum with clear separation of wind wave and swell components in the frequency spectrum is shown in fig 7 here the measured spectra from ramin station are compared with the modeled jonswap sech2 without and with the extra restrictions for m0 in fig 7 a it is seen that the parametric model without modification underestimates the m0 value but the modified model compensates for this shortcoming the total significant wave height in the measured spectra jonswap sech2 model and the modified one is 0 91m 0 83m 8 8 less and 0 91m respectively another effect of this algorithm modification is on the values of d i and error by implementing the new algorithm for the jonswap sech2 directional model the d i value decreased from 15 3 to 11 6 while the error increased from 0 046 to 0 049 this means that despite a small increase in the error value the fit accuracy in the frequency spectrum has been improved generally the use of this constraint reduced the d i values in the spectra studied at four stations pasabandar tang galak and meydani by an average of about 5 while the reduction at the other three stations was not significant 6 variability of spectral parameters a dataset of 454 directional wave spectra on a discrimination of 48 frequencies 0 02 0 01 0 49 hz and 90 directions 0 4 356 were estimated and fitted to the directional models through eq 1 by the fully implicit technique by eq 12 in table 3 the occurrence frequency of the single peaked double peaked and multi peaked spectra with respect to seasons and all seasons p are presented the values p w and p s indicate the frequencies of occurrence of wind sea and swell single peaked spectra respectively as can be seen the lowest frequency of occurrence is related to the single peaked spectrum of wind sea p w and is less than 13 1 in all stations p s value varies from 8 2 at the pasabandar to 22 7 at the galak station the total occurrence of single peaked spectra including wind sea and swell is 16 4 34 4 the values p 2p and p 2p indicate the frequencies of occurrence of two peaked and multi peaked spectra three peak or more respectively the value of p 2p varies from 37 7 around the westernmost station to 67 2 at the tang at 6 points double peaked spectra which can consist of a wind sea and a swell system or two wind sea or two swell systems account for about 50 or more of the overall examined spectra the value of p 2p varies from 16 4 in tang to 32 9 in pasabandar the lowest value of p 2p and the highest value of p 2p have been observed in tang the ratio between p 2p and p 2p in this station is 4 1 while that in meydani is approximately 1 3 according to table 4 more than 65 of the observed spectra along the makran coast have two peaks or more in table 3 the occurrence frequencies of all types of spectra ps with respect to the seasons are shown it should be noted that the data measurement started in mid winter 2016 and ended almost in mid autumn this duration was selected based on the dominant climatology of the region driven by the monsoon seasons most of the energetic waves in this region occur during south west or summer monsoon from june to september while the waves are generally weak during the rest of the months classified as two post monsoon or north east monsoon october to january and pre monsoon february to may the wave measurements show an obvious downward trend in the time series of the significant wave height from september to the end of november at all stations of the 454 spectra examined in this article only 25 cases about 5 5 are related to october november and february months in the post monsoon season in addition the significant wave height measured in two fall and winter seasons was less than the defined threshold value of 0 9 m and even at two stations no significant event was observed in the fall therefore it seems that the lack of data in december and january don t have a significant effect on the results presented in the table the presented results in table 3 make it possible to better understand the time of the spectra under review it is seen that the value of ps in the spring varies from 27 3 to 38 9 and in the summer it varies from 47 5 to 56 8 this means that the significant events occurred mostly in these seasons and the share of the fall and the winter in the examined events is less than 19 in table 4 the mean values of shape parameters γ s p for jonswap cos2s γ β p 1 β p 2 for joswap sech2 and n β p 1 β p 2 for gamma sech2 directional model are presented separately for wind sea and swell components with respect to the seasons moreover the average estimates of dimensionless error by eq 16 are shown for each of the above mentioned models based on the results of jonswap cos2s model the values of γ 1 3 1 6 and the values of s p 5 4 21 4 for wind waves for swell systems with narrower peak shapes the values of γ 1 1 in all stations and s p 8 2 33 4 similarly the value of γ 1 1 based on the jonswap sech2 model and it is γ 1 3 1 5 for wind waves in this model β p 2 0 5 9 for wind waves and it varies from 2 8 to 8 4 for swell waves it can be seen that for both jonswap based models the estimated peak enhancement factors are very close however by using the sech2 directional distribution instead of cos2s the mean error value based on eq 16 is decreased by approximately 9 and the mean value of d i based on eq 15 is decreased by 23 this means that in practice the fitting accuracy can be improved by using sech2 distribution it should be noted that the jonswap sech2 model converges faster and needs less computational efforts than the jonswap cos2s model based on gamma sech2 model n 5 7 6 9 for wind waves and 3 8 4 3 for swell waves the estimated values of β p for wind waves by gamma sech2 model are very close to what was approximated by jonswap sech2 and they are in the range of 2 2 and 5 6 but for swell waves they vary from 3 1 to 16 5 the reason for the difference between β p values for swell systems may be related to the fact that capabilities of gamma spectrum in modeling the swell components are better than jonswap moreover the mean values of d i for four locations pasabandar pozm tang and meydani by gamma based directional model are smaller than jonswap sech2 and those for other locations are almost equal it should be noted that the ratio of the total number of identified wind sea components to identified swell components in these four locations is less than that at other stations in other words at stations with more swell systems the d i value is lower using the gamma sech2 also the results in table 4 shows that the dimensionless error in the four mentioned stations is less than other locations in addition the gamma sech2 model defined by eqs 6 and 10 has fewer computational requirements for convergence of the optimization algorithm than the jonswap sech2 model on the other hand in 85 of cases the values of γ corresponding to the swell components are less than 1 1 because of their low peak values and wide spectrum shapes which reduce the direct contribution of γ on the modeling procedure see eq 4 in such cases the gamma frequency model provides better results by having the variable parameter n eq 6 which adjusts the peak and width of the swell spectrum since the number of swell systems is higher than the identified local wind sea waves the overall accuracy of the fits using the gamma spectrum has been somewhat better 7 conclusion in this study multi peaked directional wave spectra estimated based on the wave data measured during 2016 in the northern part of the gulf of oman makran coast by the well known maximum likelihood method mlm then these spectra modeled parametrically using a numerical optimization approach that identifies the number of existing wave systems and directional parameters for each of the systems optimization is based on a gradient oqnlp algorithm ugray et al 2007 and allows the fitting of different spectral models to the measured data three directional models include 1 jonswap cos2s 2 jonswap sech2 and 3 gamma sech2 have been developed and evaluated based on the present results we can conclude the following such modeling allowed us to consider several sea states that were not visible by using the frequency spectrum in other words the classification of spectra based on only the frequency spectrum leads to misinformation about spectral parameters the share of double peaked spectra in this region is in the range of 38 67 also about 16 33 of the observed spectra have three peaks or more that have not been considered so far substitution of the cos2s with sech2 reduces the d i value by about 25 and the error value by about 10 on average the cos2s did not perform well in spectra with some smooth peaks or overlapping wave systems in 85 of the identified swell systems the γ values are less than 1 1 because of their low peak and wider spectrum shapes which reduces the direct contribution of γ on the modeling procedure therefore the use of the gamma model improves the accuracy of the results by having the variable parameter n which adjusts the peak and width of the swell spectrum models showed that the m0 values of the parametric representation are less than the corresponding values of its measurement hence the introduced optimization modified by adding a constraint to conserve m0 value this modification improved the fit accuracy in the frequency spectrum despite a small increase in the error value on the other hand the analysis of spectral parameters showed significant variability for different stations along the makran coast and a significant variability for different seasons therefore using different spectra for modeling wind sea and swell systems and also considering the wind information at the measuring stations can improve the accuracy of the results which should be the focus of future studies credit authorship contribution statement mohammad adibzade conceptualization methodology software formal analysis investigation data curation writing original draft writing review editing mehdi shafieefar supervision resources hassan akbari writing review editing roozbeh panahi supervision analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20769,multi peaked directional wave spectra based on extensive field measurement data in the gulf of oman mohammad adibzade mehdi shafieefar hassan akbari roozbeh panahi department of civil and environmental engineering tarbiat modares university tehran iran department of civil and environmental engineering tarbiat modares university tehran iran department of civil and environmental engineering tarbiat modares university tehran iran corresponding author multi peaked directional wave spectra have been estimated by the well known maximum likelihood method and modeled by applying a numerical optimization approach that uses a gradient oqnlp algorithm the research is based on field measurement data from a 210 km long area at the northern coasts of the gulf of oman this modeling approach allows the fitting of various spectral models accordingly three directional spectrum models with combinations of frequency and directional spreading functions have been evaluated and proper models for directional waves have been presented on the other hand the introduced optimization algorithm is modified by adding a constraint to zeroth order spectral moment m0 value to improve the fitting accuracy in the frequency spectrum it has been shown that selecting the appropriate model for each of the frequency and directional functions can significantly improve the performance of both among the evaluated directional models the accuracy of the results based on both jonswap sech2 and gamma sech2 models was about 25 better in the frequency domain and about 10 better in the full directional domain than jonswap cos2s model besides in most of the observed swell components because of their wide spectrums with low peak values the use of the gamma frequency model performs better than the jonswap model keywords multi peaked wave spectra directional wave spectra wave spectra wave measurement 1 introduction offshore and coastal structures must be safe and stable against wave loads with different frequencies and directions therefore accurate description of a directional wave spectrum at a specific location is required for designing offshore and coastal structures different statistical procedures like maximum entropy method mem maximum likelihood method mlm wavelet directional method wdm or parametric models have been developed to estimate the directional wave spectrum from various types of field measurement data longuet higgins et al 1963 borgman 1969 isobe et al 1984 kobune and hashimoto 1986 kuik et al 1988 these methods have been compared by some researchers alves and melo 1999 donelan et al 2015 and have been reviewed and categorized by benoit et al 1997 generally a directional wave spectra s f θ consists of a frequency spectrum or energy spectrum s f that reflects wave energy in the frequency domain and a directional spreading distribution q f θ that describe how wave energy is distributed in the directional domain the traditional relation for modeling is as s f θ s f q f θ where the frequency spectrum is modeled by a well known one peaked spectrum model like pierson moskowitz or jonswap spectrum based on various sea states see guedes soares and moan 1991 and also the directional spreading distribution is a one peaked model like cos2s or sech2 functions see krogstad et al 1997 in the past few decades most spectral models have addressed only one peaked spectra however there are some sea states including a wind sea component in combination with one or more swell components which have been generated far from the area and has reached to the area these swells superimpose on wind sea waves and produce complex sea states that result in bimodal or even multi peaked spectra strekalov et al have proposed double peaked spectra to describe the combined sea state and implemented a pierson moskowitz spectrum for the wind sea component and a normal distribution for the swell component of a wave field strekalov et al 1972 later ochi and hubble proposed a set of double peaked spectra based on 800 spectra of wind waves at nine ocean weather stations at the north atlantic ocean with six parameters that describe each component by a gamma function ochi and hubble 1976 guedes soares on the other hand has proposed a four parameter spectral model to describe the combined situation of the swell and wind sea by two jonswap spectra while he has provided an excellent fit to the measured wave spectra from the north atlantic ocean and the north sea guedes soares 1984 torsethaugen has proposed a five parameter double peaked model by implementing the jonswap shaped model for each of the wave components he determined the representative values for the norwegian continental shelf torsethaugen 1993 due to the complexity of his model after a decade he proposed a simple model based on the main one by reducing free parameters to be more applicable without a significant loss of validity torsethaugen 2004 several studies have been conducted in the field of frequency wave spectra especially double peaked spectra on the northern part of the gulf of oman e g ghazangian et al 2015 panahi et al 2015 panahi et al 2016 golpira et al 2019 akbari et al 2019 investigated the capability of the jonswap model in describing the double peaked spectra by adopting over two sets of measurements at the gulf of oman using two different calibration methods in another article they have proposed a gaussian model for representing the primary system in double peaked spectra and a jonswap for the secondary system they have shown that using the gaussian model for the primary system is essential as it increases the overall performance of the calibrated double peaked spectra by about 50 which is more obvious in those dominated by the primary system akbari et al 2020 boukhanovsky and guedes soares 2009 have generalized the one from guedes soares 1984 and proposed an approach for modeling the multi peaked directional wave spectra for model identification and estimation of the spectral parameters of each component they applied a numerical optimization technique that uses the random linear search algorithm the total number of wave components in the spectra is identified using an iterative procedure their proposed approach allows the fitting of different spectral models to the measured wave data the hipocas data for the north atlantic were used for a case study however the differences in the performance of the modeling technique and the directional characteristics were not investigated using various directional spreading distributions by the availability of directional wave properties many approaches have been developed to classify the different wave components embedded in the wave spectrum e g gerling 1992 hasselmann et al 1994 hanson and phillips 2001 portilla et al 2009 lucas and guedes soares 2015 the main procedure usually involves the following two major steps a it starts by identification of local spectral peaks in the complete space of frequency and direction b then the association or combination of the spectral ordinates into individual common wave components the method of hanson and phillips 2001 using information about the wind and a grid of data points allows the tracking of the source of storms lucas et al 2011 applied a wave steepness method the non dimensional steepness for separating the wind sea and swell in the wave spectrum which does not require more information than the spectral ordinates panahi et al 2015 used a set of data measured in 2006 to provide a directional wave spectrum for double peaked spectra in a coastal region of the gulf of oman chabahar bay encountering both wind sea and swell to do this they adopted the non directional torsethaugen spectrum by entering the separation frequency the frequency in which the wind sea and swell components could be separated and three directional distribution functions they determined the best directional distribution for describing the observed spectra the directional characteristics other than those obtained from the double peaked spectra were not investigated the present article was motivated by the availability of a series of wave measurements from a recently established network of nortek acoustic wave and current profiler awac 2018 along the southern iranian coast this available directional information paves the way for better descriptions of the wave climate than just the 1d frequency spectrum in addition the wave spectrum and complex sea states have received a lot of attention in the recent years due to their significant effects in sea keeping safety offshore structures design small boat operations and ship passage over the harbor entrance wave forces on pipelines etc teixeira and guedes soares 2009 huang et al 2020 akbari and pooyarad 2020 all in all there is a lack of a comprehensive study of multi peaked directional spectra including one peaked double peaked three peaked or more to evaluate different models and provide wave characteristics our research is firstly conducted to provide a brief description of the main patterns of the wave climate at a 210 km long area of the northern part of the gulf of oman using measured wave data during 2016 this paper presents the estimation of the directional wave spectra by the well known maximum likelihood method it also deals with a numerical optimization technique that uses a gradient oqnlp algorithm this technique identifies the existing wave systems in given multi peaked spectra and fits parametric models to each of the individual systems it will be shown that the resulting directional models are capable of describing complex sea conditions in the frequency and directional domains also the capability of these models will be compared with each other these models were made through 1 the well known standard jonswap frequency spectrum with the more traditional and popular cos2s directional distribution 2 jonswap with sech2 directional spreading distribution first derived by donelan et al 1985 and 3 gamma frequency model with sech2 distribution the rest of this paper is structured as follows section 2 explains local measurements and estimation procedure of directional wave spectra while section 3 summarizes the formulation of multi peaked directional spectra the methodology of model identification through fitting can be found in section 4 comparative analysis of directional models is presented in section 5 followed by the variability of spectral parameters in section 6 finally the conclusion can be found in section 7 2 local measurement and data processing generally wave directional characteristics are obtained either from measurements of wave properties like surface elevation slopes or displacements in the east and north directions at one point or from the measurements of the same wave property e g surface elevation at three or more points recent years have seen the development of a new class of acoustic systems that can measure the directional wave properties in addition to current profile the wave data in this study have been extracted from a series of measurements conducted in 2016 at seven stations across more than 210 km of the northern parts of the gulf of oman using nortek acoustic wave and current awac profiler the awac is an optimal tool for wave measurements with a maximum depth of 35 m awac 2018 the location of such stations is illustrated in fig 1 details of each station are presented in table 1 stations no 8 9 and 10 in fig 1 refer to the 2006 measurements and have not been used in this study in the region of study there are generally two dominant wave directions from the west from the persian gulf and from the southeast from the indian ocean the predominant direction of swell waves are generally from the southeast but the direction of wind waves is more scattered these swells superimpose on wind waves and produce complex sea states that result in bimodal or even multi peaked directional spectra these different wave systems cannot be distinguished in the measured time series of wave profile because of their irregular nature and their coincidence however they can be detected efficiently based on their frequency content in the wave spectrum to measure the directional properties of waves the awac uses three acoustic beams at an angle of 25 to the vertical these beams are dedicated to measuring velocity also a fourth beam pointed upward is dedicated to measuring the sea surface position the awac capabilities have improved considerably with the introduction of the ast feature acoustic surface tracking which is a method of directly measuring surface elevation and allows to overcome the traditional shortcomings of the estimates from either the pressure or the velocity measurements pedersen et al 2005 compared the results of a datawell waverider buoy that was located only 20 m away from an awac deployed in 25m of water nortek storm v1 14 software is applied in this study to estimate the directional wave spectra s f θ nortek storm estimates the directional spectrum based on the mlmst method mlmst is the maximum likelihood method with surface tracking and is a special type of array processing that is well suited for awac wave measurements maximum likelihood method is a high resolution method for seismic processing developed by capon 1969 and later has become known as a method for directional spectra estimation this method is quite widely used for estimating multi peaked directional spectra and has proven to have a good level of accuracy davis and regier 1977 and borgman 1985 implemented this method in the context of ocean wave spectra the methodology used to identify events and select the spectra is similar to what was proposed earlier by panahi et al 2015 and akbari et al 2019 they utilized a threshold level to select the events with the significant wave height more than 0 9m such a procedure led to a total of 454 spectra and we will discuss the formulation and the application of the modeling approach to a few samples of those spectra in sections 3 and 4 3 formulation of multi peaked directional wave spectra the total directional spectrum for a general sea state consists of one or more wind sea and swell systems expressed as below 1 s f θ i 0 n s i f θ where the index value i is associated with the wave component number and n is the total number of wave components embedded in the spectrum it is more convenient to write the full directional wave spectrum s f θ as a product 2 s f θ s f q f θ of the frequency spectrum s f and the directional spreading function q f θ satisfying 3 0 2 π q f θ d θ 1 each wave system in eq 1 is represented by a one peaked spectrum model s f θ according to eq 2 this model is a combination of a frequency spectrum s f and a directional spreading function q f θ the first item reflects the wave energy in the frequency domain and the second one describes how wave energy is distributed in the frequency directional domain the most common representation for the frequency spectrum s f is jonswap spectrum jonswap spectrum is used in this study as follows hasselmann et al 1973 4 s j o n s w a p f m 0 f p γ c f f p 5 exp 5 4 f f p 4 γ a a exp f f p 2 2 σ 2 f p 2 σ 0 07 f f p 0 09 f f p where γ and σ are peak enhancement factor and shape parameter respectively f p is the peak frequency of the spectrum and the constant c is adopted here as follows goda 1979 5 c 5 m 0 f p 1 15 0 1688 γ 0 925 1 909 γ 1 an alternative representation of frequency spectrum by means of gamma spectrum used in the present paper is expressed as below boukhanovsky and guedes soares 2009 6 s γ f m 0 f p n m 0 n f p f f p n exp n n 1 f f p 1 n where the peak shape and width of the spectrum are governed by the value of n for modeling q f θ in eq 2 two directional spreading functions are used separately one of these functions is close to the well known cos2s directional distribution longuet higgins et al 1963 mitsuyasu et al 1975 which is implemented by boukhanovsky and guedes soares 2009 7 d f θ θ s c s cos 2 s f θ θ f θ θ f π 2 0 θ θ f π 2 where c s is a normalizing parameter required for satisfying eq 3 and s is the spreading parameter which controls the range of directional spreading around the mean direction θ and its value is increasing with the overall intensity of sea waves s and θ vary with the wave frequency and their dependence is expressed as 8 θ f θ p a θ f f p 9 s f s p f f p β f f p s p f f p β f f p where θ p and s p are the values of parameters at the peak frequency and a θ and β control the direction distribution around the peak values donelan et al 1985 argued that the directional distribution represented by eq 7 was not adequate so they proposed the following alternative parametric form for the directional distribution that we used in the present article 10 d f θ θ β 0 5 β sech 2 β θ θ f donelan et al 1985 found that β governs the width and is a function of the relative frequency the following expression is implemented here for the parametric representation of β 11 β f β p 1 f f p β 0 56 f f p 0 95 β p 2 f f p β 0 95 f f p 1 6 10 0 4 0 8393 exp 0 567 ln f f p f f p 1 6 where β f for values of f f p 1 6 in eq 11 was suggested by banner 1990 while donelan et al 1985 had assumed it was constant authoritative studies donelan et al 1985 banner 1990 young 1994 about directional wave spectra have shown that the parameterization of the directional distribution in the form of eq 10 yields a better match to the measured wave data and is more reliable than the common cos2s distribution however since cos2s are still widely used as the simple distribution with a lot of applications in engineering practice both directional spreading distributions will be implemented for modeling the purpose here thus for comparative analysis of the parametric models of multi peaked directional wave spectra based on eq 1 we made three models using the form of eqs 2 and 4 11 these models include 1 jonswap frequency spectrum with cos2s directional distribution 2 jonswap with sech2 directional distribution and 3 gamma frequency model with sech2 distribution to construct each of these parametric models we first need to know the total number of wave systems existing in the spectrum the number of n in eq 1 afterward for each wave system e g wind sea or swell component the set of unknown parameters is required for the jonswap cos2s based model on eqs 4 and 7 the set of parameters ξ i m 0 i f p i θ p i γ i s p i a θ i β i β i for the jonswap sech2 model on eqs 4 and 10 the parameters ξ i m 0 i f p i θ p i γ i β p 1 i β p 2 i a θ i β i β i and for the gamma sech2 model on eqs 6 and 10 ξ i m 0 i f p i θ p i n i β p 1 i β p 2 i a θ i β i β i are required in the next section we present a brief description of the main procedure toward identifying the number of wave systems n and the model parameters 4 model identification through fitting there are several techniques of fitting e g kuik et al 1988 panahi et al 2015 for obtaining the model parameters in eq 1 but the core of this section is similar to what was proposed by boukhanovsky and guedes soares 2009 in which the measure of fit according to eq 1 is functional to be minimized 12 j n ξ 0 0 2 π s f θ s f θ ξ 2 d f d θ n ξ m i n where s is the estimated directional wave spectrum by nortek storm v1 14 and s f θ ξ is the constructed parametric model by eq 1 numerically s f k θ l s k l are the values of the estimated directional spectrum at a regular grid point with 48 rows corresponding to discretized frequency by 0 01 hz 0 02 0 01 0 49 hz and 90 columns corresponding to discretized direction by 4 0 4 356 here it should be noted that the full directional wave spectrum s k l was calculated by multiplying the estimated frequency spectrum and the relevant directional distribution based on eq 2 to obtain model parameters and the construction of parametric model boukhanovsky and guedes soares 2009 has compared three explicit semi explicit and fully implicit methods and concluded that the last one is the best for multi peaked wave spectra with some smoothed peaks accordingly we use the fully implicit technique in which all model parameters of eq 1 and also the total number of wave systems n are obtained by means of numerical optimization of eq 12 now eq 12 is the target function that must be minimized with respect to the known estimated spectrum s k l and the unknown parametric model s f θ ξ which is dependent on both the discrete number of n and the values of continuous parameters ξ continuous parameters ξ are obtained by means of a sequential optimization procedure for the values of n 0 1 2 nowadays many optimization techniques have been developed and their capabilities have been explored by several authoritative studies dixon and szego 1978 one of the most useful and convenient methods are the family of gradient methods with a lot of applications in engineering practice one of these is oqnlp algorithm that was described in ugray et al 2007 and was designed to find global optima of problems with smooth objective and constraint functions as the problem of eq 12 with wave spectra data the optimization procedure of the oqnlp algorithm is briefly described in fig 2 now in order to make the optimization process clearer we consider one of the multi peaked spectra such as fig 3 a estimated from the measurement data and we want to fit a gamma sech2 model to it modeling this spectrum begins by assuming that the number of wave systems in spectra is equal to 1 or n 0 in eq 1 then an initial value is dedicated to each of the parameters of the directional model based on eqs 6 and 10 it should be noted that an appropriate initial value for peak parameters m 0 0 f p 0 θ p 0 can be obtained directly from the estimated spectra and the shape parameters n β p 1 0 β p 2 0 can be chosen in accordance to traditional recommendations e g n 5 β p 1 0 2 61 and β p 2 0 2 28 by means of the optimization procedure the optimal values of the nine parameters for the main wave system of the target spectrum are provided fig 3 b at the next stage a double peaked model n 1 is fitted by the above mentioned procedure and the optimal values of eighteen parameters for two wave systems according to the target spectrum are obtained fig 3 c the calculated j n 1 ξ in this step is compared with the calculated j n 0 ξ in the previous step if j n 0 ξ j n 1 ξ α then the optimization procedure must continue for n 2 and the directional model is required to be at least double peaked otherwise a single peaked model is enough for the modeling purpose numerical experiments showed that the best value for α is equal to 1 5 considering j n ξ values in fig 3 we must check the significance of the third peak in eq 1 and approximate the optimal values of the total parameters for a three peaked model this process continues until the discrepancy in the values of eq 12 for n 1 terms is less than 1 5 times that for n terms it is worth mentioning that for any spectrum defined by eqs 4 and 6 to assure realistic and positive spectral moments and for consistency of the optimization process in eq 12 we should consider some additional constraints e g n 2 s 1 β 1 and γ 1 also an upper limit can be considered for these parameters from practical experiences based on the results of the modeling presented in the next section and inspired by akbari et al 2019 using the conservation of spectral moments to calibrate double peaked spectra here we have been persuaded to make some modifications to the above mentioned optimization procedure by using an additional constraint as below to equalize the value of the calculated moments from the modeled and target spectrum 13 i 0 n m 0 i m 0 m e a s u r e d after estimating the total number of spectral peaks n and the optimal values of parameters ξ identifying and separating the local wind wave and swell components in a wave field can help to have a clearer perception of the conditions governing the sea state and is very important from the engineering point of view among several methods developed wang and hwang 2001 portilla et al 2009 liu et al 2015 we implemented the one dimensional steepness lucas et al 2011 for separation between wind sea and swell components defined as 14 δ h s λ p 2 π h s g t p 2 8 π g m 0 f p 2 where λ p and t p are the wave length and period associated with the each spectral peak if the steepness is δ 0 011 then the wave component is considered as the wind wave and otherwise a swell is expected 5 comparative analysis of multi peaked directional spectrum models measured directional wave information at seven stations in the northern part of the gulf of oman provides the required spectra for evaluating the performance of directional spectral models on the basis of eqs 1 and 2 in fig 4 there are examples of frequency spectra s f and the integrated directional spreading function q θ fitting with the described directional models on the basis of eq 12 the wave data from four stations pasabandar pozm meydani and galak are used for case studies there were three sorts of directional models in eq 1 including jonswap cos2s eqs 4 and 7 with the variable parameters γ and s jonswap sech2 eqs 4 and 10 with the variable parameters γ and β and gamma sech2 eqs 6 and 10 with the variable parameters n and β for quantitative comparison of fitting in frequency domain deviation index d i proposed by liu 1983 and implemented by henriques and guedes soares 1998 is adopted here as follows 15 d i i 1 n 100 s f i s f i s f i s f i δ f m 0 where s stands for the modeled spectrum and s is the measured one in table 2 the values of d i associated with fig 4 are shown additionally for a quantitative comparison of fitting in the frequency direction domain the normalized dimensionless approximation errors are presented in table 2 as 16 e r r o r j n ξ h s the target directional spectrum in fig 4 a1 a2 has two clear peaks in the directional spectrum but the frequency spectrum shows only one peak this means that the peak frequencies of the two wave systems are close to each other but in the directional domain their peaks are separated clearly the main advantage of the presently described technique based on eq 12 is that it involves the directional information to fit this type of spectrum and allows one to obtain more reliable results it should be noted that both systems are swell from table 2 it is seen that the d i values for all three cases are lower than 11 the fitting satisfactory range for the values of d i is lower than 25 30 liu 1983 so all the fitted models are close to each other and matched to the measured spectrum as can be seen in fig 4 a2 jonswap cos2s does not perform well in the directional domain and the value of fitting error for this model is more than that in the other two models the complicated cases of double peaked wave spectra are shown in fig 4 b1 b2 and fig 4 c1 c2 fig 4 b1 represents a wind sea dominated spectrum with a weak swell system while fig 4 c1 demonstrates a swell dominated spectrum in which the two wave components are almost overlapping in general there are some other small peaks in the full directional spectrum they are overlooked due to their little effect on the optimization process for example the left most peak in fig 4 b2 is neglected in the optimization process and it is considered as two peaked spectra the mismatch of the wind sea peaks in parametric models with the measured spectrum in fig 4 b1 may be due to the non participation of these small peaks the gamma sech2 model fitting with eq 6 10 is closer to the target spectrum than the two jonswap based models both in frequency and direction domain by comparing the values of d i and error for jonswap based models in table 2 it can be seen that the substitution of the cos2s directional distribution with sech2 has improved the fitting accuracy in the frequency and directional spectrum fig 4 d1 d2 represents a more complicated case of combined seas with four peaks in the directional spectrum each of the frequency spectra s f fig 4 d1 and the integrated directional spreading function q θ fig 4 d2 shows only two peaks two swell systems and two wind sea components exist in the wave field the two swell peaks are spaced apart by about 0 02 hz in the frequency domain and 50 in the directional space the corresponding values for the wind sea components are about 0 01 hz and 75 for this case adopting the present method allows one to select and fit the parametric model on each of the peaks and leads to a more reliable parametric representation of the spectral shape the d i values for all the three cases are lower than 23 all the fitted models are almost close to each other but still the best is the gamma sech2 model due to the error values in table 2 here the models involving the sech2 directional distribution function performed better in both frequency and directional spaces all in all choosing the appropriate directional distribution can dramatically affect the accuracy of fitting in both frequency and directional domains according to the results for all the modeled spectra replacing the cos2s distribution with the sech2 reduces the mean d i value by about 25 and the mean error value by around 10 the cos2s function did not perform well in spectra with some smooth peaks or overlapping wave systems numerical solution convergence was more difficult in models involving the cos2s than other models also the frequency model plays an important role in the accuracy of the resulting full directional spectrum in 68 of the studied spectra the accuracy of the fitting based on the gamma sech2 model was better than the jonswap sech2 the gamma frequency model despite good results in modeling overestimates the middle part of the two wave components due to its larger tail than the jonswap see fig 4 b1 fig 5 a1 and b1 show the two spectra measured from pasabandar station in the form of a contour the frequency spectra s f in both logarithmic and normal scales is also provided along with contour plots to show the high frequency details of the spectra below each of these figures three parametric models obtained based on jonswap cos2s jonswap sech2 and gamma sech2 are shown the first case fig 5 a1 has three obvious and almost separate peaks while its frequency spectrum has two overlapping peaks therefore these peaks cannot be defined correctly based on only using the frequency spectrum based on the one dimensional steepness eq 14 a swell system and two local wind sea systems have been identified as shown in fig 5 a2 a swell component and only a wind sea component were identified by the jonswap cos2s model in such cases that two wave systems with different directions have similar frequencies the cos2s is not able to accurately separate these two overlapped systems in the directional domain the d i and the error values for this model are 20 5 and 0 075 respectively in contrast the other two models including the sech2 distribution fig 5 a3 a4 well model the three systems in the spectrum the d i and the error values for the jonswap sech2 and the gamma sech2 models are 12 1 0 050 14 9 and 0 049 respectively the second case fig 5 b1 has three overlapping peaks for such a directional spectrum only one obvious peak in the frequency spectrum is visible all three systems are of the swell type the d i value for the jonswap cos2s model in fig 5 b2 is 18 3 and the error is 0 062 despite the good accuracy of this model in the frequency domain one of the components is not identified the fitting accuracy using the jonswap sech2 model fig 5 b3 significantly improved accordingly the value of d i decreased to 16 8 and the error to 0 047 which indicates an about 25 improvement in the results of the directional spectrum a noteworthy point in modeling this spectrum using models that include jonswap is that the γ values in eq 4 are equal to 1 for all identified wave systems therefore since the γ parameter cannot be less than 1 it will no longer participate in the process of optimizing and improving the results in such cases using the gamma spectrum gives better results due to having the variable parameter n see eq 6 here according to fig 5 b4 it can be seen that the most match with the measured spectrum is related to the gamma sech2 model the d i and the error values for this model are 14 2 and 0 042 respectively in fig 6 the calculated values of significant wave height hm0 are compared by integration of the target spectrum matrix and the modeled one the difference in the values of hm0 was assessed using the root mean square error r m s e which is calculated as follows 17 r m s e i 1 n h m 0 m e a s u r e d h m 0 e s t i m a t e d 2 n where n is the total number of events examined additionally the ratio of the average values of the estimated hm0 based on the parametric models including joswap cos2s jonswap sech2 and gamma sech2 to the average values of hm0 from the target spectrum is 0 89 0 92 and 0 97 respectively rmse and ratio values mean that the parametric representation using the present technique does not conserve the values of m0 of the measured spectrum and in most cases the value of the parametric model is less than the corresponding value of its measurement this has led us to address this issue by adding a constraint to conserve the actual m0 in the parametric model for this purpose we use the constraint in the form of eq 13 during the optimization process and refit the jonswap sech2 directional model using the modified approach the ratio of the average values of hm0 from the parametric models to the average of their corresponding values based on the target spectrum was equal to one using this constraint as shown in fig 6 d the rmse values are also reduced to 0 02 this means that the difference between the actual value of m0 and the parametric representation is significantly reduced it should be noted that adding such a constraint according to eq 13 in the optimization algorithm does not necessarily mean that the values on both sides of the equation will be equal and sometimes the values on both sides may be slightly different from each other for a deeper analysis of such a constraint effect in the fitting procedure a simple two peaked spectrum with clear separation of wind wave and swell components in the frequency spectrum is shown in fig 7 here the measured spectra from ramin station are compared with the modeled jonswap sech2 without and with the extra restrictions for m0 in fig 7 a it is seen that the parametric model without modification underestimates the m0 value but the modified model compensates for this shortcoming the total significant wave height in the measured spectra jonswap sech2 model and the modified one is 0 91m 0 83m 8 8 less and 0 91m respectively another effect of this algorithm modification is on the values of d i and error by implementing the new algorithm for the jonswap sech2 directional model the d i value decreased from 15 3 to 11 6 while the error increased from 0 046 to 0 049 this means that despite a small increase in the error value the fit accuracy in the frequency spectrum has been improved generally the use of this constraint reduced the d i values in the spectra studied at four stations pasabandar tang galak and meydani by an average of about 5 while the reduction at the other three stations was not significant 6 variability of spectral parameters a dataset of 454 directional wave spectra on a discrimination of 48 frequencies 0 02 0 01 0 49 hz and 90 directions 0 4 356 were estimated and fitted to the directional models through eq 1 by the fully implicit technique by eq 12 in table 3 the occurrence frequency of the single peaked double peaked and multi peaked spectra with respect to seasons and all seasons p are presented the values p w and p s indicate the frequencies of occurrence of wind sea and swell single peaked spectra respectively as can be seen the lowest frequency of occurrence is related to the single peaked spectrum of wind sea p w and is less than 13 1 in all stations p s value varies from 8 2 at the pasabandar to 22 7 at the galak station the total occurrence of single peaked spectra including wind sea and swell is 16 4 34 4 the values p 2p and p 2p indicate the frequencies of occurrence of two peaked and multi peaked spectra three peak or more respectively the value of p 2p varies from 37 7 around the westernmost station to 67 2 at the tang at 6 points double peaked spectra which can consist of a wind sea and a swell system or two wind sea or two swell systems account for about 50 or more of the overall examined spectra the value of p 2p varies from 16 4 in tang to 32 9 in pasabandar the lowest value of p 2p and the highest value of p 2p have been observed in tang the ratio between p 2p and p 2p in this station is 4 1 while that in meydani is approximately 1 3 according to table 4 more than 65 of the observed spectra along the makran coast have two peaks or more in table 3 the occurrence frequencies of all types of spectra ps with respect to the seasons are shown it should be noted that the data measurement started in mid winter 2016 and ended almost in mid autumn this duration was selected based on the dominant climatology of the region driven by the monsoon seasons most of the energetic waves in this region occur during south west or summer monsoon from june to september while the waves are generally weak during the rest of the months classified as two post monsoon or north east monsoon october to january and pre monsoon february to may the wave measurements show an obvious downward trend in the time series of the significant wave height from september to the end of november at all stations of the 454 spectra examined in this article only 25 cases about 5 5 are related to october november and february months in the post monsoon season in addition the significant wave height measured in two fall and winter seasons was less than the defined threshold value of 0 9 m and even at two stations no significant event was observed in the fall therefore it seems that the lack of data in december and january don t have a significant effect on the results presented in the table the presented results in table 3 make it possible to better understand the time of the spectra under review it is seen that the value of ps in the spring varies from 27 3 to 38 9 and in the summer it varies from 47 5 to 56 8 this means that the significant events occurred mostly in these seasons and the share of the fall and the winter in the examined events is less than 19 in table 4 the mean values of shape parameters γ s p for jonswap cos2s γ β p 1 β p 2 for joswap sech2 and n β p 1 β p 2 for gamma sech2 directional model are presented separately for wind sea and swell components with respect to the seasons moreover the average estimates of dimensionless error by eq 16 are shown for each of the above mentioned models based on the results of jonswap cos2s model the values of γ 1 3 1 6 and the values of s p 5 4 21 4 for wind waves for swell systems with narrower peak shapes the values of γ 1 1 in all stations and s p 8 2 33 4 similarly the value of γ 1 1 based on the jonswap sech2 model and it is γ 1 3 1 5 for wind waves in this model β p 2 0 5 9 for wind waves and it varies from 2 8 to 8 4 for swell waves it can be seen that for both jonswap based models the estimated peak enhancement factors are very close however by using the sech2 directional distribution instead of cos2s the mean error value based on eq 16 is decreased by approximately 9 and the mean value of d i based on eq 15 is decreased by 23 this means that in practice the fitting accuracy can be improved by using sech2 distribution it should be noted that the jonswap sech2 model converges faster and needs less computational efforts than the jonswap cos2s model based on gamma sech2 model n 5 7 6 9 for wind waves and 3 8 4 3 for swell waves the estimated values of β p for wind waves by gamma sech2 model are very close to what was approximated by jonswap sech2 and they are in the range of 2 2 and 5 6 but for swell waves they vary from 3 1 to 16 5 the reason for the difference between β p values for swell systems may be related to the fact that capabilities of gamma spectrum in modeling the swell components are better than jonswap moreover the mean values of d i for four locations pasabandar pozm tang and meydani by gamma based directional model are smaller than jonswap sech2 and those for other locations are almost equal it should be noted that the ratio of the total number of identified wind sea components to identified swell components in these four locations is less than that at other stations in other words at stations with more swell systems the d i value is lower using the gamma sech2 also the results in table 4 shows that the dimensionless error in the four mentioned stations is less than other locations in addition the gamma sech2 model defined by eqs 6 and 10 has fewer computational requirements for convergence of the optimization algorithm than the jonswap sech2 model on the other hand in 85 of cases the values of γ corresponding to the swell components are less than 1 1 because of their low peak values and wide spectrum shapes which reduce the direct contribution of γ on the modeling procedure see eq 4 in such cases the gamma frequency model provides better results by having the variable parameter n eq 6 which adjusts the peak and width of the swell spectrum since the number of swell systems is higher than the identified local wind sea waves the overall accuracy of the fits using the gamma spectrum has been somewhat better 7 conclusion in this study multi peaked directional wave spectra estimated based on the wave data measured during 2016 in the northern part of the gulf of oman makran coast by the well known maximum likelihood method mlm then these spectra modeled parametrically using a numerical optimization approach that identifies the number of existing wave systems and directional parameters for each of the systems optimization is based on a gradient oqnlp algorithm ugray et al 2007 and allows the fitting of different spectral models to the measured data three directional models include 1 jonswap cos2s 2 jonswap sech2 and 3 gamma sech2 have been developed and evaluated based on the present results we can conclude the following such modeling allowed us to consider several sea states that were not visible by using the frequency spectrum in other words the classification of spectra based on only the frequency spectrum leads to misinformation about spectral parameters the share of double peaked spectra in this region is in the range of 38 67 also about 16 33 of the observed spectra have three peaks or more that have not been considered so far substitution of the cos2s with sech2 reduces the d i value by about 25 and the error value by about 10 on average the cos2s did not perform well in spectra with some smooth peaks or overlapping wave systems in 85 of the identified swell systems the γ values are less than 1 1 because of their low peak and wider spectrum shapes which reduces the direct contribution of γ on the modeling procedure therefore the use of the gamma model improves the accuracy of the results by having the variable parameter n which adjusts the peak and width of the swell spectrum models showed that the m0 values of the parametric representation are less than the corresponding values of its measurement hence the introduced optimization modified by adding a constraint to conserve m0 value this modification improved the fit accuracy in the frequency spectrum despite a small increase in the error value on the other hand the analysis of spectral parameters showed significant variability for different stations along the makran coast and a significant variability for different seasons therefore using different spectra for modeling wind sea and swell systems and also considering the wind information at the measuring stations can improve the accuracy of the results which should be the focus of future studies credit authorship contribution statement mohammad adibzade conceptualization methodology software formal analysis investigation data curation writing original draft writing review editing mehdi shafieefar supervision resources hassan akbari writing review editing roozbeh panahi supervision analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
