index,text
3595,accurate estimation of maize evapotranspiration et is of great significance for the improvement of crop water use efficiency and precision irrigation the penman monteith model p m has been widely used to simulate crop et in the p m model the estimation accuracy of canopy resistance r c has a direct impact on et in this study based on the eddy covariance system large scale lysimeter and meteorological station data from three sites yucheng yangling and shangqiu in semi humid regions of northern china the p m model was applied to obtain canopy resistance r c pm and correlation significances between r c pm and different impact factors r n net radiation t temperature vpd saturated vapor pressure difference θ soil moisture content lai leaf area index were analysed the whole growth period of maize was divided according to different lai thresholds 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the genetic algorithms ga and differential evolution de algorithms were used to optimize the empirical parameters of the jarvis model and the p m model was applied to estimate et under different lai thresholds at the three stations the correlation significances of r c pm with different influencing factors followed the order r n lai θ vpd t and it was extremely significant with r n p 0 01 and significant with lai and θ p 0 05 the ga and de algorithm optimization results showed that the calculation accuracy of r c was highest when lai 0 5 m2 m 2 at yucheng station with r2 of 0 80 and 0 81 respectively and when lai 1 0 m2 m 2 and the accuracy of r c was highest at yangling station with r2 of 0 87 and 0 89 respectively and when lai 1 0 m2 m 2 and the accuracy of r c was highest at shangqiu station with r2 of 0 84 and 0 84 respectively combined with p m model to calculate maize et under different lai thresholds the simulation accuracy of et was best when lai 0 5 m2 m 2 at yucheng station with averege r2 of 0 85 the order of simulation et accuracy was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 when lai 1 0 m2 m 2 and the accuracy of maize et was highest at yangling and shangqiu stations with averege r2 of 0 83 and 0 85 respectively the order of simulation et accuracy was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 et accuracy calculated by the de optimization algorithm was better than that of the ga optimization algorithm with r2 of 0 40 0 84 and 0 58 0 86 respectively this study suggests that the algorithm is of great importance to optimize the empirical parameters of the jarvis model of which de optimization algorithm is recommended to simulate maize et in semi humid regions of northern china keywords penman monteith model optimization algorithm jarvis model leaf area index segmentation maize 1 introduction crop evapotranspiration et is an important process in the hydrological cycle a main factor for the dynamic relationship between crop growth and water balance and a key parameter for irrigation decision making kang et al 2000 2003 timm et al 2014 accurate estimation of evapotranspiration is of great significance for improving crop water use efficiency and realizing precision irrigation wang and dickinson 2012 tegos et al 2015 jiang et al 2016 various models have been developed to accurately estimate et at different spatio temporal scales and ecosystems e g monteith 1965 priestley and taylor 1972 hargreaves and samani 1985 doorenbos 1977 shuttleworth and wallace 1985 choudhury and monteith 1988 penman monteith model based on the principle of energy balance and aerodynamics has provided a theoretical basis for many crop models and agricultural water management schemes ortega farias et al 2004 ferguson et al 2010 mu et al 2011 ershadi et al 2015 canopy resistance describes the resistance of water vapor to soil surface through leaf stomata canopy or soil interior which is an important parameter for the p m model to calculate et li et al 2014 zhao et al 2010 kjelgaard and stockle 2001 leaf area index lai affects the canopy resistance to a large extent and then affects the accuracy of et estimation by the p m model pasquale and theodore 1998 farahani and bausch 1995 found that when lai less than 2 m2 m 2 the accuracy of canopy resistance was reduced due to the exposure of the entire canopy and thus the estimation accuracy of et by the p m model was relatively lower pasquale and theodore 1998 found that when lai more than 5 m2 m 2 it had little influence on canopy resistance and the p m model had higher accuracy in estimating et therefore sparse vegetation cover or small lai of early crops does not satisfy the assumption that p m is a large leaf model thereby affecting canopy resistance and et estimation kato et al 2004 ortega farias et al 2007 ortega farias et al 2010 monteith 1965 proposed that canopy resistance is equal to the minimum stomatal resistance divided by the leaf area involved in energy exchange jarvis 1976 introduced the influence of environmental factors on stomatal behavior and proposed the famous jarvis canopy resistance model through a series of independent functions multiplied by canopy resistance proposed by monteith 1965 which has been widely used li et al 2014 zhang et al 2008 the influencing factors in the jarvis model rn net radiation t air temperature vpd vapor pressure difference θ soil water content lai leaf area index have different degrees of influence on canopy resistance ritchie and burnett 1971 and wang et al 2005 pointed out that lai was an important parameter of crop canopy structure and could be used to classify crop growth and growth periods therefore the empirical parameters of jarvis model can be piecewise optimized according to different lai thresholds to estimate canopy resistance so as to improve the estimation accuracy of et by p m model the parameters in the jarvis model are empirical and vary with external climatic conditions and crop growing seasons yu and wang 2010 proposed that the linear fitting of empirical parameters in jarvis model with the measured data at different growth could better estimate the canopy resistance of maize liu et al 2020 calibrated the empirical parameters in the jarvis model using the nonlinear least square fitting method to simulate rice transpiration however these methods have slow convergence speed and poor stability and are often prone to local optimization biological heuristic algorithms can provide global solutions for optimization problems some researchers have used biological heuristic algorithms to optimize machine learning models and further improved the prediction accuracy of the models shiri 2017 shiri 2018 salam and islam 2020 elbeltagi et al 2020 katebi et al 2020 the commonly used biological heuristic algorithms are genetic algorithm ga yin et al 2017 wu et al 2019 differential evolution de wu et al 2020 particle swarm optimization pso petković et al 2016 wu et al 2019 artificial bee colony abc ozkan et al 2011 fire fly algorithm ffa tao et al 2018 and wolf optimization algorithm woa saman et al 2020 wu et al 2019 and wu et al 2021 optimized the extreme learning machine based on the biological heuristic algorithms ga pso and abc to estimate reference crop evapotranspiration in different climate zones of china and found that the accuracy of the optimized hybrid model was higher than that of the original model wu et al 2020 improved the hargreaves model to estimate reference crop evapotranspiration in southwest china based on intelligent algorithms de abc and pso and found that the accuracy was improved and the hargreaves model optimized by the de algorithm had the highest accuracy ghorbani et al 2018 developed a mixed mlp ffa model to predict the daily evapotranspiration by coupling the multi layer perception model mlp with the ffa algorithm and found that the prediction accuracy of the mixed mlp ffa model was better than that of the classic mlp model china has the largest maize planting area in the world up to 188 24 million hectares the semi humid area in northern china is the main maize producing region however the growth of maize is very sensitive to water condition based on the field experiment data from yucheng 2004 2005 yangling 2012 2013 and shangqiu 2014 2015 stations in the semi humid regions of northern china the objectives of this study were as follows 1 the p m model was used to obtain the canopy resistance r c pm based on the measured data of the three stations 2 the sensitivity of canopy resistance r c pm to different influencing factors rn net radiation t air temperature vpd vapor pressure difference θ soil water content and lai leaf area index was analyzed 3 according to different thresholds of lai the empirical parameters in jarvis model were segmentally optimized based on genetic algorithm ga and differential evolution algorithm de and the optimized parameters were applied to jarvis model to calculate canopy resistance finally canopy resistance was applied to p m model for et calculation the measured et data of the three stations were used to verify the calculation results and identify the optimal segmentation point of lai thresholds 2 materials and methods 2 1 experimental station the experimental data used in this study cames from the yucheng yangling and shangqiu stations in northern china the experimental crop was summer maize yucheng yangling and shangqiu stations has atemperate monsoon climate with the soil texture of brown loam yellow brown loam and clay loam respectively the basic information of the three stations is shown in table 1 and their locations are shown in fig 1 2 2 measurements 2 2 1 evapotranspiration the growth of summer maize at yucheng station was mainly measured by the eddy covariance system the height of the sensor in the vorticity system was adjusted weekly keeping the relative height between sensors 1 0 m above maize which was mainly composed of a three dimensional sonic anemometer csat3 type a kryp ton hygrometer model kh20 a temperature and humidity sensor hmp45c model and a data logger cr5000 model campbell sci inc usa meteorological data including net radiation r n air temperature t relative humidity rh and wind speed u were collected at a height of 5 m above the ground during the continuous monitoring periods meteorological data were automatically monitored by the eddy covariance system every half an hour the actual evapotranspiration of maize at yangling station was measured by a large scale lysimeter 2 0 m 2 0 m 2 3 m whose measuring accuracy was 0 02 mm data were automatically collected and recorded by the collection system every hour hence daily evaporation and transpiration would be accumulated from data during one hour the actual evapotranspiration of maize at shangqiu station was measured by a large scale lysimeter 2 5 m 2 5 m 2 5 m whose measuring accuracy was 0 02 mm considering the possible impact of equipment isolation on micrometeorological elements the soil surface in the lysimeter was kept level with the surrounding surface meteorological data were automatically monitored every half an hour 2 2 2 leaf area index representative plants were selected after seedling emergence whose leaves were randomly selected for the measurement of width and length during the growth period leaf samples were measured every 7 to 10 days at yucheng station every 7 to 14 days at yangling station and every 7 to 10 days at shangqiu station total leaf area was calculated by summing the rectangular area leaf length maximum width of each fully expanded leaf and multiplied by a factor of 0 74 li et al 2008 2 2 3 soil water content at yucheng station the soil moisture sensors decagon devices inc usa were used to measure soil water contentin the root zone thesensors were connected to automatic recorders em50 decagon devices inc usa to collect data every 30 min at yangling and shangqiu stations soil water content in the root zone of the maize was measured using soil moisture sensors wet150 inc delta t and smt 100 inc ugt the sensors were coupled to an automated data logger data were collected every 15 min the soil moisture calibrate was every 7 days by the soil drying method 2 2 4 meteorological variables an automatic meteorological station hobo at onset com puter corp usa was installed in the eddy covariance system at yucheng station to continuously record solar radiation rs air temperature t relative humidity rh wind speed u and precipitation p all data were collected every 5 s and recorded every 30 min at a height of 5 m meteorological data were obtained from a height of 5 m weather station 120 m from the experimental site at yangling station and the shangqiu station meteorological data were adopted form a height of 10 m standard automatic weather station continuous observation which mainly included solar radiation rs air temperature t relative humidity rh wind speed u precipitation p and sunshine duration n the meteorological data soil water content actual evapotranspiration and leaf area index at the three stations are shown in table 2 2 3 models 2 3 1 penman monteith model the penman monteith model p m model was used to estimate crop evapotranspiration et monteith 1965 which is defined as follows 1 λ e t δ r n g c p ρ a v p d r a δ γ 1 r c r a where λ is referencelatent heat of vaporization j kg 1 et is actual evapotranspiration mm is saturated vapor pressure and temperature curve slope kpa c 1 r n is net radiation mj m 2 s 1 c p is specific heat of air at constant pressure j kg 1 c 1 ρ a is air density kg m 3 vpd is saturation vapor pressure difference kpa r c is surface impedance s m 1 r a is aerodynamic impedance s m 1 γ is wet and dry table constant kpa c 1 the r a can be calculated as follows thom 1972 2 r a i n z d h c d i n z d z 0 k 2 u z where z is reference height m h c is mean crop height m d is zero plane displacement m d 0 67h c z 0 is controls the rough length of momentum transfer m z 0 0 13h c k is karman constant 0 41 u z is reference altitude wind speed m s 1 the parameters required to calculate et0 were computed according to fao 56 including u 2 and radiation variables the wind speed at other locations was converted to u 2 by eq 3 allen et al 1998 3 u 2 u z 4 87 in 67 8z 5 42 where u 2 and u z are the wind speed measured at 2 m and z m above the ground m s 1 z is the measured height of the ground m 2 3 2 jarvis canopy resistance model the jarvis canopy resistance model can be expressed as follows jarvis 1976 4 r c r c m i n lai active f r n f t f v p d f θ where r c is canopy resistance s m 1 r c min is the minimum canopy resistance s m 1 lai is active effective leaf area index m2 m 2 r n is net radiation mj m 2 s 1 t is air temperature c vpd is water vapor pressure deficit k pa θ is soil moisture content cm3 cm 3 the r c is related to environmental variables where the light sub model of the jarvis model can be expressed as follows takeshi 1978 dickinson 1984 jarvis 1976 noilhan and planton 1989 5 f r n k 1 e x p r n k 2 6 f t 1 k 3 25 t 2 7 f v p d 1 k 4 v p d 8 f θ 1 θ θ w θ f θ w 0 θ θ f θ w θ θ f θ θ w where k 1 k 2 k 3 and k 4 are empirical parameters θ is soil moisture content cm3 cm 3 θ w is wilting moisture content cm3 cm 3 and θ f is field capacity cm3 cm 3 the effective leaf area index is calculated as follows zhang et al 2008 9 la i active lai 2 0 5 l a i lai 2 2 l a i 4 l a i 4 where lai is the leaf area index m2 m 2 2 3 3 measured canopy resistance obtained by the re arranged p m model the measured canopy resistance was obtained by the rearranged p m model r c pm using the observed et from the eddy covariance system a large scale lysimeter and the meteorological data during the growing period at yucheng yangling and shangqiu stations the r c pm was then applied to optimiza the unknown parameters k 1 k 2 k 3 and k 4 in the jarvis model the r c pm is calculated as follows 10 r c p m δ r n g ρ a c p v p d r a δ γ λ et ec γ λ et ec r a 2 4 segmented optimization of empirical parameters in jarvis model yu and wang 2010 indicated that the empirical parameters in jarvis model would vary with experimental conditions and crop growing seasons and demonstrated that subsection optimization could improve the accuracy of canopy resistance therefore according to different values of lai and optimization algorithms the whole growth period of maize was divided into two parts lai x m2 m 2 and lai x m2 m 2 and genetic algorithm and differential evolution algorithm were used to calculate the corresponding canopy resistance r c lai values were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 respectively the data of yucheng 2004 yangling 2012 and shangqiu 2014 sites were used for optimization in stages and the data of 2005 2013 and 2015 were used for verification 2 4 1 genetic algorithm ga genetic algorithm ga is a self adaptive global optimization intelligent algorithm based on natural selection and population genetic mechanism chemin and honda 2018 its main feature is to directly operate on the structural object without derivation and function continuity using the probabilistic optimization method can automatically obtain and guide the optimized search space adaptively adjust the search direction and finally obtain the optimal solution without evaluating each generation of individuals according to a predetermined target function chemin and honda 2018 kim and singh 2014 ayse and baburao 2016 2 4 2 differential evolution algorithm de differential evolution algorithm de means that as the evolution process of evolution continues mutation operators and crossover operators are shown in eqs 12 and 13 as self adaptive changes at the beginning of the algorithm search space is expanded to prevent partial optimization the rate of convergence is accelerated at the end of evolution as for optimization problems including continuous variables and discrete variables the relationship between continuous space and discrete space is established by a replacement strategy of variable rounding so that discrete variables and continuous variables can be mutually conversed kim and singh 2014 liu et al 2015 yi et al 2016 the mutation operator f takes the value in the real numbers of interval 0 2 as the most important controlling parameter in the process of the differential evolution algorithm the value of f affects the diversity and convergence of the population in the process of the differential evolution algorithm the continuous variables and discrete variables of the real encoding adopted the mutation operators which are shown in eqs 11 and 12 respectively 11 f p 1 p 1 cos π g 2 g m 1 k 1 g k 1 g 1 g g m 12 cr p 2 p 3 cos π g 2 g m 13 f 2 0 1 k 2 g k 2 g 1 g g m where g is the current iterations g m is the maximum number of iterations p 1 p 2 p 3 k 1 and k 2 are the algorithm parameters and k 1 and k 2 take values in the real numbers of interval 0 1 to determine the mutation operator s mutation time the change range of the adaptive algorithm depends on p 1 p 2 p 3 which generally take values in the real numbers of interval 0 2 2 5 evaluation of model performance determination coefficient r 2 relative root mean absolute error rrmae mean absolute error mae and fixed affinity index d were used to evaluate the accuracy between the estimated valued and the observations specific equations of r 2 rrmae mae and d are as follows 14 r 2 i 1 n x i x y i y 2 i 1 n x i x 2 i 1 n y i y 2 15 rrmse 1 n i 1 n y i x i 2 x i 16 d 1 i 1 n y i x i i 1 n y i y x i y 17 mae i 1 n y i x i n where x i and y i are the observed value and the estimated value of the model respectively x i and y i represent the average value of the observed value and the estimated value respectively the subscript i represents the i th value of the observed value and the estimated value n is the numbers of data r 2 represents the degree of replication of the model to the observed value the higher the value of r 2 is the better the performance is both rrmse and mae value are range 0 perfect fit of worst fit d is dimensionless which ranges 0 worst fit of 1 perfect fit the results of all the above indicators were further integrated by adopting global performance indicators gpi to avoid differences in individual indicators despotovic et al 2015 the calculation formula is as follows 18 gp i i j 1 4 α j y j y ij as for indicators of r 2 and ns a j is equal to 1 while as for other indicators a j is equal to 1 y j is the median scale value of the index j and y ij is the scale value of the index j in the model i the higher the gpi value is the higher the accuracy of the model is 3 results 3 1 correlation between measured canopy resistance and different environmental factors the significance analysis of the correlation between the canopy resistance and impact factors at the three sites are shown in table 3 it can be seen that r 2 values between r c pm and radiation were 0 58 0 53 and 0 56 at the three stations respectively which were best and even reached extreme significance levels p 0 01 the r 2 between r c pm and effective leaf area index were 0 42 0 47 and 0 44 respectively and the r 2 between r c pm and soil moisture content were 0 38 0 42 and 0 41 respectively all of which reached significant levels p 0 05 therefore the correlations between r c pm and impact factors were consistent at three stations which were in the order of net radiation r n effective leaf area index lai soil moisture content θ vapor pressure deficit vpd temperature t this result was also consistent with the analysis of lagos et al 2013 3 2 calibration of canopy resistance parameters by two optimization algorithms the results of the empirical parameters k1 k2 k3 and k4 of jarvis model segmentation optimization based on six lai thresholds 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 and two algorithms ga and de are shown in table 4 there were certain differences in the segmentation optimization results of the two algorithms under different lai thresholds the parameters fitted by the two optimization algorithms according to the lai threshold of 0 1 m2 m 2 had large differences when compared to those in both periods of the other five segmented methods that is because the sensitivity of maize canopy resistance to different influencing factors changed at different periods when lai was 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the optimized parameter k1 in the first stage was smaller than that in the second stage while the parameters k2 k3 and k4 had little difference in the two stages that is because the sensitivity of canopy resistance to rn and vpd varied at different periods 3 3 segmentation methods and caculation of canopy resistance with optimized algorithms as shown in fig 2 the calculation results from the two optimization algorithms at the three stations were basically consistent with the change trend of results reversely calculated by the p m model which was from declining to stationary to fluctuating when the lai thresholds were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the simulated values r c ga de and reverse calculated results obtained by the p m model at the three stations were compared at yucheng station the errors of r c ga were 433 24 s m 1 89 57 s m 1 121 53 s m 1 179 75 s m 1 234 27 s m 1 and 323 13 s m 1 while those of r c de were 306 11 s m 1 86 83 s m 1 95 95 s m 1 189 49 s m 1 194 33 s m 1 and 203 98 s m 1 respectively at yangling station the errors of r c ga were 483 19 s m 1 96 04 s m 1 79 77 s m 1 144 80 s m 1 269 06 s m 1 and 383 19 s m 1 while those of r c de were 318 45 s m 1 86 39 s m 1 64 74 s m 1 104 80 s m 1 210 23 s m 1 and 241 26 s m 1 respectively at shangqiu station the errors of r c ga were 436 76 s m 1 116 78 s m 1 90 35 s m 1 117 88 s m 1 233 92 s m 1 and 301 32 s m 1 while those of r c de were 305 70 s m 1 126 65 s m 1 87 09 s m 1 192 35 s m 1 210 11 s m 1 and 254 35 s m 1 respectively the results showed that when lai 0 5m2 m 2 the error between the simulated canopy resistance and the calculated value of p m was smallest at yucheng station when lai 1 0 m2 m 2 the error between the two stations was the smallest in yangling and shangqiu stations fig 3 shows the precision fitting of the calculation results of piecewise optimized jarvis model and p m model at yucheng yangling and shangqiu stations based on genetic and differential evolution algorithms the precision of the piecewise optimized calculation results of the two algorithms differed significantly under different lai thresholds at yucheng station when lai 0 5 m2 m 2 the accuracy of canopy resistance calculated by piecewise optimized algorithm was highest followed by 1 0 and 1 5 m2 m 2 and r2 of r c ga were 0 80 0 79 and 0 76 while r2 of r c de were 0 81 0 79 and 0 78 respectively at yangling station when lai 1 0 m2 m 2 the accuracy of canopy resistance calculated was highest followed by 0 5 and 1 5 m2 m 2 and r2 of r c ga were 0 87 0 80 and 0 62 while r2 of r c de were 0 89 0 84 and 0 74 respectively at shangqiu station the threshold 1 0 m2 m 2 showed the best estimation accoracy among the six threshold followed by 0 5 and 1 5 m2 m 2 and r2 of r c ga were 0 84 0 78 and 0 77 while r2 of r c de were 0 84 0 81 and 0 78 respectively based on different lai thresholds at the yucheng stations the order for accuracy of canopy resistance calculated by segmention optimized jarvis model was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at the yangling and shangqiu stations the order for accuracy of canopy resistance segmention calculated was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 3 4 the influence of different optimization algorithms to estimate the canopy resistance on et estimation accuracy fig 4 shows the changes of simulated evapotranspiration and measured values based on de and ga optimization algorithms under different lai thresholds at the three stations the simulation results of two algorithms were basically consistent with the variation trends of measured values which was from rising to steady to fluctuating to declining when the lai thresholds were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the comparative results between simulation and measured values were as follows at yucheng station the errors of etga were 24 63 4 28 6 17 7 84 10 94 and 17 47 mm while the figures of etde were 18 82 4 12 5 41 7 35 9 97 and 16 82 mm respectively at yangling station the errors of etga were 21 51 7 52 4 50 9 34 13 65 and 17 45 mm while the figures of etde were 17 11 7 21 4 47 9 23 13 52 and 16 82 mm respectively at shangqiu station the errors of etga were 20 98 10 87 4 67 12 33 16 53 and 18 98 mm while the figures of etde were 19 32 9 45 4 33 14 45 15 53 and 17 78 mm respectively when lai 0 5 m2 m 2 the accuracy was highest at yangling station and when lai 1 0 m2 m 2 and it was the best performance at yangling and shangqiu stations in addition the et calculated by the ga optimization algorithm was slightly higher than the measured value while the result calculated by the de optimization algorithm was closer to the measured value this was because many parameters were applied in the calculation such as crossover rate and mutation rate in the process of selection crossover and mutation operations in the genetic algorithm the selection of these parameters was obtained by experiences which would seriously affect the optimization results wu et al 2000 fig 5 shows the accuracy of the piecewise optimization jarvis model based on de and ga algorithms to calculate evapotranspiration and measured data at yucheng station when lai 0 5 m2 m 2 the evapotranspiration etde and etga estimated by difference progression and genetic algorithm had highest accuracy followed by 1 0 and 0 5 m2 m 2 the accuracy r2 of etga was 0 84 0 81 and 0 80 while r2 of r c de was 0 86 0 83 and 0 82 respectively at yangling station when lai 1 0 m2 m 2 and it was the best performance followed by 0 5 and 1 5 m2 m 2 the accuracy r2 of etga was 0 82 0 80 and 0 79 and that of etde was 0 84 0 83 and 0 81 respectively at shangqiu station when lai 1 0 m2 m 2 and it showed the best estimation accuracy followed by 0 5 and 1 5 m2 m 2 the accuracy r2 of etga was 0 84 0 84 and 0 76 and that of etde was 0 86 0 82 and 0 80 respectively the precision order of picewise optimization calculation of maize et at yucheng station based on different lai thresholds was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at yangling and shagnqiu stations the precision order calculation was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 this can be due to difference of data acquisition scale the eddy covariance system is used to monitor et of mazie based on the principle of energy balance at yucheng station and the large lysimeter is used to obtain mazie et based on the weighing method at yangling and shangqiu stations based on de and ga optimization algorithms the precision indexes of calculated evapotranspiration and measured values at different segmented intervals at yucheng yangling and shangqiu stations are shown in table 5 at yucheng station the order of the overall accuracy was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at yangling and shangqiu stations the order of estimation accuracy was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 meanwhile the results calculated by de optimization algorithm calculation were better than those by ga algorithm with r2 of 0 40 0 84 and 0 61 0 86 mae of 0 37 1 03 and 0 22 0 84 mm d 1 respectively at yucheng station the accuracy of et segmentally simulated was highest when lai 0 5 m2 m 2 followed by lai of 1 0 and 1 5 m2 m 2 respectively according to ga optimization algorithm r 2 of 0 84 0 81 and 0 81 mae of 0 43 0 45 and 0 50 mm d 1 gpi of 0 26 0 19 and 0 11 respectively according to de optimization algorithm r 2 was 0 86 0 83 and 0 82 mae of 0 23 0 40 and 0 40 mm d 1 gpi of 1 18 0 17 and 0 11 respectively at yangling station the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 followed by that obtained when lai was 0 5 and 1 5 m2 m 2 respectively according to ga optimization algorithm r 2 was 0 82 0 80 and 0 79 mae was 0 44 0 51 and 0 53 mm d 1 gpi was 0 37 0 28 and 0 16 respectively according to de optimization algorithm r 2 was 0 84 0 83 and 0 81 mae was 0 45 0 46 and 0 49 mm d 1 gpi was 0 34 0 34 and 0 12 respectively at shangqiu station the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 followed by 0 5 and of 1 5 m2 m 2 according to ga optimization algorithm r 2 was 0 84 0 81 and 0 76 mae was 0 37 0 40 and 0 58 mm d 1 gpi was 0 29 0 25 and 0 10 respectively according to de optimization algorithm r 2 was 0 86 0 82 and 0 80 mae was 0 39 0 43 and 0 47 mm d 1 gpi was 0 20 0 14 and 0 09 respectively overall at yucheng station the accuracy of et segmentally simulated was highest when lai 0 5 m2 m 2 at yangling and shangqiu stations the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 the accuracy of et calculated by de optimization algorithm was better than that calculated by ga algorithm therefore it is recommended to use de algorithm for simulate maize evapotranspiration 4 discussion 4 1 the main drivers factors of canopy resistance the study found that the most significant factors affecting maize canopy resistance were r n and lai canopy resistance represents the overall effect of the factors such as stomatal impedance of leaves at different levels different parts and aerodynamic characteristics in canopy on the entire canopy evapotranspiration which is not a purely physiological parameter hoshika et al 2017 canopy resistance is mainly related to meteorological factors and their own physiological process and the main energy of maize leaf photosynthes is comes from solar radiation the main growth season of maize is from may to early october with the gradual enlargement of leaves there is a great difference in the radiation energy obtained by the upper and lower layers of maize and the average ground surface impedance is gradually transformed into canopy resistance li et al 2013 srivastava et al 2018 irmak et al 2013 used eight models estimating r c as a function of different combination of micrometeorological and plant variables are presented the models integrated the linear and non linear effects of regulating variables net radiation rn relative humidity rh wind speed u2 air temperature t vapor pressure deficit vpd leaf area index lai aerodynamic resistance r a to predict hourly r c they found that the accuracy of canopy resistance estimated by the model without lal or solar radiation was the lowest indicating the importance of the lai or solar radiation in estimating r c xu et al 2018 and earl and davis 2003 studied the growth structure of maize crops by using the light of row crops and found that the structure of maize crops was mainly changed by solar radiation and leaf shapes based on the multivariable regression zhou et al 2019 analyzed meteorological factors affecting canopy resistance at different scales and found that photosynthetically active radiation was the main driving factor of canopy resistance followed by the size of leaves and the relative water content li et al 2016 and huang et al 2010 used the bp neural network method to analyze the sensitivity of different impact factors r n net radiation t air temperature vpd vapor pressure deficit θ soil moisture content and lai leaf area index to the jarvis model and used different meteorological factors as input factors of the jarvis canopy resistance model whose conclusion was consistent with this study 4 2 the optimal threshold points of lai the lai is an important parameter of maize canopy structure and can be used to divide growing season wang et al 2005 jiang et al 2016 therefore the empirical parameters in the jarvis model can be fitted by the segmented methods according to the threshold of lai to estimate canopy resistance and then improve the accuracy of estimated et by the p m model it was found that when lai was 0 5 m2 m 2 the accuracy of segmented optimization estimation was best followed by 1 0 and 1 5 m2 m 2 at yucheng station when lai 1 0 m2 m 2 the accuracy estimation was best followed by 0 5 and 1 5 m2 m 2 at yangling and shangqiu stations when lai was 0 1 m2 m 2 the accuracy was worst at the station because parameters in the jarvis model are empirical and vary with the experimental condition and crop growing season meanwhile this may be difference of data acquisition scale the eddy covariance system is used to monitor et of mazie based on the principle of energy balance at yucheng station however the large lysimeter is used to obtain mazie et based on the weighing method at yangling and shangqiu stations in addition the maize canopy resistance was primarily influenced by lai li et al 2016 liu et al 2020 during the growth period the lower leaves were civered with gradual increase of leaf area while the photosynthetic rate of upper leaves increased leading to different solar radiation exposure of different parts of maize plants air temperature and water pressure affected less in the process of maize growth yan et al 2021 srivastava et al 2018 li et al 2016 it is well known that the p m model is the big leaf model li et al 2016 zheng et al 2021 yan et al 2021 in the growth process of maize when lai was 0 5 m2 m 2 at yucheng station and when lai was 1 0 m2 m 2 at yangling and shangqiu stations the canopy resistance calculated had a high accuracy which satisfied the hypothesis of the p m model so the estimation accuracy was highest with the growth of maize lai gradually became larger when lai 2 m2 m 2 the maize canopy were exposed to more sunlight the solar radiation was large and the temperature was high in july and august which was conducive to crop evapotranspiration lagos et al 2013 li et al 2016 when lai 3 m2 m 2 overlaps occurred between leaves resulting in less radiation on the middle and lower leaves lower temperaturer and higher humidity which had a great impact on the canopy resistance model and inhibited crop evapotranspiration shan et al 2020 li et al 2016 xu et al 2017 zheng et al 2021 therefore when lai 2 m2 m 2 the accuracy of evapotranspiration calculated by subsection optimization was higher than that when lai 3 m2 m 2 when lai 0 1 m2 m 2 maize leaves were small and crop transpiration was small and most evaporation came from soil evaporation so the accuracy of estimation accuracy was low this was consistent with the finding of ortega farias et al 2004 and dolman 1993 however some researchers li et al 2013 also believed that when lai 2 m2 m 2 using p m model to estimate et had better performance this was different from the conclusion in the study because combining the jarvis canopy resistance model and the soil resistance model they have developed a coupled surface resistance model and the penman monteith pm model be used to estimate sparse soybean and grape evapotranspiration et in addition the underlying layer and geographical environment of crop growth were different 4 3 the significant improvement of simulation accuracy by differential evolution de and genetic algorithm ga this study found that both differential evolution de and genetic algorithm ga can significantly improve the simulation accuracy of maize et and de is slightly higher than ga in the nonlinear processing both algorithms can obtain the optimal parameters and improve the simulation accuracy based on the swarm intelligence theory the differential evolution algorithm can dynamically track the current search situation to adjust its search strategy and has strong global convergence ability and stability yi et al 2014 genetic algorithm is a random global search developed based on the theory of biological evolution in nature and it has the ability of parallel efficient and global search chemin and honda 2018 it can automatically obtain and accumulate knowledge about the search space in the search process in the optimization process it mainly carries out selection crossover and mutation operations and adaptively controls the search process to obtain the optimal parameters kim and hung 2008 used genetic algorithm to optimize neural network model to predict alfalfa evapotranspiration and transpiration it was found that genetic algorithm has variable parameters in the process of parameter optimization such as selection rate crossover rate and mutation rate these parameters will seriously affect the optimal solution and have a certain dependence on the initial training samples wu et al 2000 chai 2010 5 conclusions based on the measured data of eddy covariance systems and large scale lysimeters at three sites in the semi humid regions of northen china this study determined the empirical parameters in the jarvis model by adopting ga and de algorithms under different lai thresholds by taking the canopy resistance reversely calculated by the p m model as the standard value canopy resistance calculated by verification parameters was verified the measured evapotranspiration data were used to verify the estimated results the main conclusions of this study are as follows 1 the canopy resistance decreased when net radiation r n air temperature t vapor pressure deficit vpd soil water content θ and leaf area index lai increased the order of the correlation significance of impact factors on the canopy resistance was r n lai θ vpd t the canopy resistance was significantly correlated with r n followed by lai θ and vpd 2 the accuracy of estimated maize r c was effectively improved by adopting the lai threshold segmentation method and ga and de algorithms to fit the empirical parameters in jarvis model at yucheng when the lai threshold was 0 5 m2 m 2 the parameters in the jarvis model fitted by the two optimization algorithms greatly improved the estimation accuracy of the canopy resistance at yangling and shangqiu stations the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 3 using differential evolution de and genetic algorithm ga optimization algorithms to calibrate the empirical parameters in jarvis model for simulate the et of maize the simulation accuracy of p m model can be effectively improved by differential evolution and genetic algorithm and the optimization result that the de is slightly higher than ga with r2 of 0 58 0 86 and 0 40 0 84 mae of 0 23 0 85 mm d 1 and 0 37 1 03 mm d 1 d of 0 73 0 88 and 0 58 0 87 credit authorship contribution statement zongjun wu writing original draft writing review editing ningbo cui conceptualization methodology writing review editing lu zhao writing review editing le han writing review editing xiaotao hu supervision funding acquisition project administration huanjie cai data curation daozhi gong supervision funding acquisition project administration liwen xing xi chen writing review editing bin zhu writing review editing min lv shidan zhu quanshan liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank yucheng yangling and shangqiu experimental stations for providing data for this study this work was also supported by the national key research and development program of china no 2016yfc0400206 the national natural science foundation of china 51922072 51779161 51009101 the science and technology projects of sichuan 22zdyf0145 22qycx0069 22qycx0073 22qycx0115 and the national key technologies r d program of china no 2015bad24b01 
3595,accurate estimation of maize evapotranspiration et is of great significance for the improvement of crop water use efficiency and precision irrigation the penman monteith model p m has been widely used to simulate crop et in the p m model the estimation accuracy of canopy resistance r c has a direct impact on et in this study based on the eddy covariance system large scale lysimeter and meteorological station data from three sites yucheng yangling and shangqiu in semi humid regions of northern china the p m model was applied to obtain canopy resistance r c pm and correlation significances between r c pm and different impact factors r n net radiation t temperature vpd saturated vapor pressure difference θ soil moisture content lai leaf area index were analysed the whole growth period of maize was divided according to different lai thresholds 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the genetic algorithms ga and differential evolution de algorithms were used to optimize the empirical parameters of the jarvis model and the p m model was applied to estimate et under different lai thresholds at the three stations the correlation significances of r c pm with different influencing factors followed the order r n lai θ vpd t and it was extremely significant with r n p 0 01 and significant with lai and θ p 0 05 the ga and de algorithm optimization results showed that the calculation accuracy of r c was highest when lai 0 5 m2 m 2 at yucheng station with r2 of 0 80 and 0 81 respectively and when lai 1 0 m2 m 2 and the accuracy of r c was highest at yangling station with r2 of 0 87 and 0 89 respectively and when lai 1 0 m2 m 2 and the accuracy of r c was highest at shangqiu station with r2 of 0 84 and 0 84 respectively combined with p m model to calculate maize et under different lai thresholds the simulation accuracy of et was best when lai 0 5 m2 m 2 at yucheng station with averege r2 of 0 85 the order of simulation et accuracy was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 when lai 1 0 m2 m 2 and the accuracy of maize et was highest at yangling and shangqiu stations with averege r2 of 0 83 and 0 85 respectively the order of simulation et accuracy was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 et accuracy calculated by the de optimization algorithm was better than that of the ga optimization algorithm with r2 of 0 40 0 84 and 0 58 0 86 respectively this study suggests that the algorithm is of great importance to optimize the empirical parameters of the jarvis model of which de optimization algorithm is recommended to simulate maize et in semi humid regions of northern china keywords penman monteith model optimization algorithm jarvis model leaf area index segmentation maize 1 introduction crop evapotranspiration et is an important process in the hydrological cycle a main factor for the dynamic relationship between crop growth and water balance and a key parameter for irrigation decision making kang et al 2000 2003 timm et al 2014 accurate estimation of evapotranspiration is of great significance for improving crop water use efficiency and realizing precision irrigation wang and dickinson 2012 tegos et al 2015 jiang et al 2016 various models have been developed to accurately estimate et at different spatio temporal scales and ecosystems e g monteith 1965 priestley and taylor 1972 hargreaves and samani 1985 doorenbos 1977 shuttleworth and wallace 1985 choudhury and monteith 1988 penman monteith model based on the principle of energy balance and aerodynamics has provided a theoretical basis for many crop models and agricultural water management schemes ortega farias et al 2004 ferguson et al 2010 mu et al 2011 ershadi et al 2015 canopy resistance describes the resistance of water vapor to soil surface through leaf stomata canopy or soil interior which is an important parameter for the p m model to calculate et li et al 2014 zhao et al 2010 kjelgaard and stockle 2001 leaf area index lai affects the canopy resistance to a large extent and then affects the accuracy of et estimation by the p m model pasquale and theodore 1998 farahani and bausch 1995 found that when lai less than 2 m2 m 2 the accuracy of canopy resistance was reduced due to the exposure of the entire canopy and thus the estimation accuracy of et by the p m model was relatively lower pasquale and theodore 1998 found that when lai more than 5 m2 m 2 it had little influence on canopy resistance and the p m model had higher accuracy in estimating et therefore sparse vegetation cover or small lai of early crops does not satisfy the assumption that p m is a large leaf model thereby affecting canopy resistance and et estimation kato et al 2004 ortega farias et al 2007 ortega farias et al 2010 monteith 1965 proposed that canopy resistance is equal to the minimum stomatal resistance divided by the leaf area involved in energy exchange jarvis 1976 introduced the influence of environmental factors on stomatal behavior and proposed the famous jarvis canopy resistance model through a series of independent functions multiplied by canopy resistance proposed by monteith 1965 which has been widely used li et al 2014 zhang et al 2008 the influencing factors in the jarvis model rn net radiation t air temperature vpd vapor pressure difference θ soil water content lai leaf area index have different degrees of influence on canopy resistance ritchie and burnett 1971 and wang et al 2005 pointed out that lai was an important parameter of crop canopy structure and could be used to classify crop growth and growth periods therefore the empirical parameters of jarvis model can be piecewise optimized according to different lai thresholds to estimate canopy resistance so as to improve the estimation accuracy of et by p m model the parameters in the jarvis model are empirical and vary with external climatic conditions and crop growing seasons yu and wang 2010 proposed that the linear fitting of empirical parameters in jarvis model with the measured data at different growth could better estimate the canopy resistance of maize liu et al 2020 calibrated the empirical parameters in the jarvis model using the nonlinear least square fitting method to simulate rice transpiration however these methods have slow convergence speed and poor stability and are often prone to local optimization biological heuristic algorithms can provide global solutions for optimization problems some researchers have used biological heuristic algorithms to optimize machine learning models and further improved the prediction accuracy of the models shiri 2017 shiri 2018 salam and islam 2020 elbeltagi et al 2020 katebi et al 2020 the commonly used biological heuristic algorithms are genetic algorithm ga yin et al 2017 wu et al 2019 differential evolution de wu et al 2020 particle swarm optimization pso petković et al 2016 wu et al 2019 artificial bee colony abc ozkan et al 2011 fire fly algorithm ffa tao et al 2018 and wolf optimization algorithm woa saman et al 2020 wu et al 2019 and wu et al 2021 optimized the extreme learning machine based on the biological heuristic algorithms ga pso and abc to estimate reference crop evapotranspiration in different climate zones of china and found that the accuracy of the optimized hybrid model was higher than that of the original model wu et al 2020 improved the hargreaves model to estimate reference crop evapotranspiration in southwest china based on intelligent algorithms de abc and pso and found that the accuracy was improved and the hargreaves model optimized by the de algorithm had the highest accuracy ghorbani et al 2018 developed a mixed mlp ffa model to predict the daily evapotranspiration by coupling the multi layer perception model mlp with the ffa algorithm and found that the prediction accuracy of the mixed mlp ffa model was better than that of the classic mlp model china has the largest maize planting area in the world up to 188 24 million hectares the semi humid area in northern china is the main maize producing region however the growth of maize is very sensitive to water condition based on the field experiment data from yucheng 2004 2005 yangling 2012 2013 and shangqiu 2014 2015 stations in the semi humid regions of northern china the objectives of this study were as follows 1 the p m model was used to obtain the canopy resistance r c pm based on the measured data of the three stations 2 the sensitivity of canopy resistance r c pm to different influencing factors rn net radiation t air temperature vpd vapor pressure difference θ soil water content and lai leaf area index was analyzed 3 according to different thresholds of lai the empirical parameters in jarvis model were segmentally optimized based on genetic algorithm ga and differential evolution algorithm de and the optimized parameters were applied to jarvis model to calculate canopy resistance finally canopy resistance was applied to p m model for et calculation the measured et data of the three stations were used to verify the calculation results and identify the optimal segmentation point of lai thresholds 2 materials and methods 2 1 experimental station the experimental data used in this study cames from the yucheng yangling and shangqiu stations in northern china the experimental crop was summer maize yucheng yangling and shangqiu stations has atemperate monsoon climate with the soil texture of brown loam yellow brown loam and clay loam respectively the basic information of the three stations is shown in table 1 and their locations are shown in fig 1 2 2 measurements 2 2 1 evapotranspiration the growth of summer maize at yucheng station was mainly measured by the eddy covariance system the height of the sensor in the vorticity system was adjusted weekly keeping the relative height between sensors 1 0 m above maize which was mainly composed of a three dimensional sonic anemometer csat3 type a kryp ton hygrometer model kh20 a temperature and humidity sensor hmp45c model and a data logger cr5000 model campbell sci inc usa meteorological data including net radiation r n air temperature t relative humidity rh and wind speed u were collected at a height of 5 m above the ground during the continuous monitoring periods meteorological data were automatically monitored by the eddy covariance system every half an hour the actual evapotranspiration of maize at yangling station was measured by a large scale lysimeter 2 0 m 2 0 m 2 3 m whose measuring accuracy was 0 02 mm data were automatically collected and recorded by the collection system every hour hence daily evaporation and transpiration would be accumulated from data during one hour the actual evapotranspiration of maize at shangqiu station was measured by a large scale lysimeter 2 5 m 2 5 m 2 5 m whose measuring accuracy was 0 02 mm considering the possible impact of equipment isolation on micrometeorological elements the soil surface in the lysimeter was kept level with the surrounding surface meteorological data were automatically monitored every half an hour 2 2 2 leaf area index representative plants were selected after seedling emergence whose leaves were randomly selected for the measurement of width and length during the growth period leaf samples were measured every 7 to 10 days at yucheng station every 7 to 14 days at yangling station and every 7 to 10 days at shangqiu station total leaf area was calculated by summing the rectangular area leaf length maximum width of each fully expanded leaf and multiplied by a factor of 0 74 li et al 2008 2 2 3 soil water content at yucheng station the soil moisture sensors decagon devices inc usa were used to measure soil water contentin the root zone thesensors were connected to automatic recorders em50 decagon devices inc usa to collect data every 30 min at yangling and shangqiu stations soil water content in the root zone of the maize was measured using soil moisture sensors wet150 inc delta t and smt 100 inc ugt the sensors were coupled to an automated data logger data were collected every 15 min the soil moisture calibrate was every 7 days by the soil drying method 2 2 4 meteorological variables an automatic meteorological station hobo at onset com puter corp usa was installed in the eddy covariance system at yucheng station to continuously record solar radiation rs air temperature t relative humidity rh wind speed u and precipitation p all data were collected every 5 s and recorded every 30 min at a height of 5 m meteorological data were obtained from a height of 5 m weather station 120 m from the experimental site at yangling station and the shangqiu station meteorological data were adopted form a height of 10 m standard automatic weather station continuous observation which mainly included solar radiation rs air temperature t relative humidity rh wind speed u precipitation p and sunshine duration n the meteorological data soil water content actual evapotranspiration and leaf area index at the three stations are shown in table 2 2 3 models 2 3 1 penman monteith model the penman monteith model p m model was used to estimate crop evapotranspiration et monteith 1965 which is defined as follows 1 λ e t δ r n g c p ρ a v p d r a δ γ 1 r c r a where λ is referencelatent heat of vaporization j kg 1 et is actual evapotranspiration mm is saturated vapor pressure and temperature curve slope kpa c 1 r n is net radiation mj m 2 s 1 c p is specific heat of air at constant pressure j kg 1 c 1 ρ a is air density kg m 3 vpd is saturation vapor pressure difference kpa r c is surface impedance s m 1 r a is aerodynamic impedance s m 1 γ is wet and dry table constant kpa c 1 the r a can be calculated as follows thom 1972 2 r a i n z d h c d i n z d z 0 k 2 u z where z is reference height m h c is mean crop height m d is zero plane displacement m d 0 67h c z 0 is controls the rough length of momentum transfer m z 0 0 13h c k is karman constant 0 41 u z is reference altitude wind speed m s 1 the parameters required to calculate et0 were computed according to fao 56 including u 2 and radiation variables the wind speed at other locations was converted to u 2 by eq 3 allen et al 1998 3 u 2 u z 4 87 in 67 8z 5 42 where u 2 and u z are the wind speed measured at 2 m and z m above the ground m s 1 z is the measured height of the ground m 2 3 2 jarvis canopy resistance model the jarvis canopy resistance model can be expressed as follows jarvis 1976 4 r c r c m i n lai active f r n f t f v p d f θ where r c is canopy resistance s m 1 r c min is the minimum canopy resistance s m 1 lai is active effective leaf area index m2 m 2 r n is net radiation mj m 2 s 1 t is air temperature c vpd is water vapor pressure deficit k pa θ is soil moisture content cm3 cm 3 the r c is related to environmental variables where the light sub model of the jarvis model can be expressed as follows takeshi 1978 dickinson 1984 jarvis 1976 noilhan and planton 1989 5 f r n k 1 e x p r n k 2 6 f t 1 k 3 25 t 2 7 f v p d 1 k 4 v p d 8 f θ 1 θ θ w θ f θ w 0 θ θ f θ w θ θ f θ θ w where k 1 k 2 k 3 and k 4 are empirical parameters θ is soil moisture content cm3 cm 3 θ w is wilting moisture content cm3 cm 3 and θ f is field capacity cm3 cm 3 the effective leaf area index is calculated as follows zhang et al 2008 9 la i active lai 2 0 5 l a i lai 2 2 l a i 4 l a i 4 where lai is the leaf area index m2 m 2 2 3 3 measured canopy resistance obtained by the re arranged p m model the measured canopy resistance was obtained by the rearranged p m model r c pm using the observed et from the eddy covariance system a large scale lysimeter and the meteorological data during the growing period at yucheng yangling and shangqiu stations the r c pm was then applied to optimiza the unknown parameters k 1 k 2 k 3 and k 4 in the jarvis model the r c pm is calculated as follows 10 r c p m δ r n g ρ a c p v p d r a δ γ λ et ec γ λ et ec r a 2 4 segmented optimization of empirical parameters in jarvis model yu and wang 2010 indicated that the empirical parameters in jarvis model would vary with experimental conditions and crop growing seasons and demonstrated that subsection optimization could improve the accuracy of canopy resistance therefore according to different values of lai and optimization algorithms the whole growth period of maize was divided into two parts lai x m2 m 2 and lai x m2 m 2 and genetic algorithm and differential evolution algorithm were used to calculate the corresponding canopy resistance r c lai values were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 respectively the data of yucheng 2004 yangling 2012 and shangqiu 2014 sites were used for optimization in stages and the data of 2005 2013 and 2015 were used for verification 2 4 1 genetic algorithm ga genetic algorithm ga is a self adaptive global optimization intelligent algorithm based on natural selection and population genetic mechanism chemin and honda 2018 its main feature is to directly operate on the structural object without derivation and function continuity using the probabilistic optimization method can automatically obtain and guide the optimized search space adaptively adjust the search direction and finally obtain the optimal solution without evaluating each generation of individuals according to a predetermined target function chemin and honda 2018 kim and singh 2014 ayse and baburao 2016 2 4 2 differential evolution algorithm de differential evolution algorithm de means that as the evolution process of evolution continues mutation operators and crossover operators are shown in eqs 12 and 13 as self adaptive changes at the beginning of the algorithm search space is expanded to prevent partial optimization the rate of convergence is accelerated at the end of evolution as for optimization problems including continuous variables and discrete variables the relationship between continuous space and discrete space is established by a replacement strategy of variable rounding so that discrete variables and continuous variables can be mutually conversed kim and singh 2014 liu et al 2015 yi et al 2016 the mutation operator f takes the value in the real numbers of interval 0 2 as the most important controlling parameter in the process of the differential evolution algorithm the value of f affects the diversity and convergence of the population in the process of the differential evolution algorithm the continuous variables and discrete variables of the real encoding adopted the mutation operators which are shown in eqs 11 and 12 respectively 11 f p 1 p 1 cos π g 2 g m 1 k 1 g k 1 g 1 g g m 12 cr p 2 p 3 cos π g 2 g m 13 f 2 0 1 k 2 g k 2 g 1 g g m where g is the current iterations g m is the maximum number of iterations p 1 p 2 p 3 k 1 and k 2 are the algorithm parameters and k 1 and k 2 take values in the real numbers of interval 0 1 to determine the mutation operator s mutation time the change range of the adaptive algorithm depends on p 1 p 2 p 3 which generally take values in the real numbers of interval 0 2 2 5 evaluation of model performance determination coefficient r 2 relative root mean absolute error rrmae mean absolute error mae and fixed affinity index d were used to evaluate the accuracy between the estimated valued and the observations specific equations of r 2 rrmae mae and d are as follows 14 r 2 i 1 n x i x y i y 2 i 1 n x i x 2 i 1 n y i y 2 15 rrmse 1 n i 1 n y i x i 2 x i 16 d 1 i 1 n y i x i i 1 n y i y x i y 17 mae i 1 n y i x i n where x i and y i are the observed value and the estimated value of the model respectively x i and y i represent the average value of the observed value and the estimated value respectively the subscript i represents the i th value of the observed value and the estimated value n is the numbers of data r 2 represents the degree of replication of the model to the observed value the higher the value of r 2 is the better the performance is both rrmse and mae value are range 0 perfect fit of worst fit d is dimensionless which ranges 0 worst fit of 1 perfect fit the results of all the above indicators were further integrated by adopting global performance indicators gpi to avoid differences in individual indicators despotovic et al 2015 the calculation formula is as follows 18 gp i i j 1 4 α j y j y ij as for indicators of r 2 and ns a j is equal to 1 while as for other indicators a j is equal to 1 y j is the median scale value of the index j and y ij is the scale value of the index j in the model i the higher the gpi value is the higher the accuracy of the model is 3 results 3 1 correlation between measured canopy resistance and different environmental factors the significance analysis of the correlation between the canopy resistance and impact factors at the three sites are shown in table 3 it can be seen that r 2 values between r c pm and radiation were 0 58 0 53 and 0 56 at the three stations respectively which were best and even reached extreme significance levels p 0 01 the r 2 between r c pm and effective leaf area index were 0 42 0 47 and 0 44 respectively and the r 2 between r c pm and soil moisture content were 0 38 0 42 and 0 41 respectively all of which reached significant levels p 0 05 therefore the correlations between r c pm and impact factors were consistent at three stations which were in the order of net radiation r n effective leaf area index lai soil moisture content θ vapor pressure deficit vpd temperature t this result was also consistent with the analysis of lagos et al 2013 3 2 calibration of canopy resistance parameters by two optimization algorithms the results of the empirical parameters k1 k2 k3 and k4 of jarvis model segmentation optimization based on six lai thresholds 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 and two algorithms ga and de are shown in table 4 there were certain differences in the segmentation optimization results of the two algorithms under different lai thresholds the parameters fitted by the two optimization algorithms according to the lai threshold of 0 1 m2 m 2 had large differences when compared to those in both periods of the other five segmented methods that is because the sensitivity of maize canopy resistance to different influencing factors changed at different periods when lai was 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the optimized parameter k1 in the first stage was smaller than that in the second stage while the parameters k2 k3 and k4 had little difference in the two stages that is because the sensitivity of canopy resistance to rn and vpd varied at different periods 3 3 segmentation methods and caculation of canopy resistance with optimized algorithms as shown in fig 2 the calculation results from the two optimization algorithms at the three stations were basically consistent with the change trend of results reversely calculated by the p m model which was from declining to stationary to fluctuating when the lai thresholds were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the simulated values r c ga de and reverse calculated results obtained by the p m model at the three stations were compared at yucheng station the errors of r c ga were 433 24 s m 1 89 57 s m 1 121 53 s m 1 179 75 s m 1 234 27 s m 1 and 323 13 s m 1 while those of r c de were 306 11 s m 1 86 83 s m 1 95 95 s m 1 189 49 s m 1 194 33 s m 1 and 203 98 s m 1 respectively at yangling station the errors of r c ga were 483 19 s m 1 96 04 s m 1 79 77 s m 1 144 80 s m 1 269 06 s m 1 and 383 19 s m 1 while those of r c de were 318 45 s m 1 86 39 s m 1 64 74 s m 1 104 80 s m 1 210 23 s m 1 and 241 26 s m 1 respectively at shangqiu station the errors of r c ga were 436 76 s m 1 116 78 s m 1 90 35 s m 1 117 88 s m 1 233 92 s m 1 and 301 32 s m 1 while those of r c de were 305 70 s m 1 126 65 s m 1 87 09 s m 1 192 35 s m 1 210 11 s m 1 and 254 35 s m 1 respectively the results showed that when lai 0 5m2 m 2 the error between the simulated canopy resistance and the calculated value of p m was smallest at yucheng station when lai 1 0 m2 m 2 the error between the two stations was the smallest in yangling and shangqiu stations fig 3 shows the precision fitting of the calculation results of piecewise optimized jarvis model and p m model at yucheng yangling and shangqiu stations based on genetic and differential evolution algorithms the precision of the piecewise optimized calculation results of the two algorithms differed significantly under different lai thresholds at yucheng station when lai 0 5 m2 m 2 the accuracy of canopy resistance calculated by piecewise optimized algorithm was highest followed by 1 0 and 1 5 m2 m 2 and r2 of r c ga were 0 80 0 79 and 0 76 while r2 of r c de were 0 81 0 79 and 0 78 respectively at yangling station when lai 1 0 m2 m 2 the accuracy of canopy resistance calculated was highest followed by 0 5 and 1 5 m2 m 2 and r2 of r c ga were 0 87 0 80 and 0 62 while r2 of r c de were 0 89 0 84 and 0 74 respectively at shangqiu station the threshold 1 0 m2 m 2 showed the best estimation accoracy among the six threshold followed by 0 5 and 1 5 m2 m 2 and r2 of r c ga were 0 84 0 78 and 0 77 while r2 of r c de were 0 84 0 81 and 0 78 respectively based on different lai thresholds at the yucheng stations the order for accuracy of canopy resistance calculated by segmention optimized jarvis model was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at the yangling and shangqiu stations the order for accuracy of canopy resistance segmention calculated was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 3 4 the influence of different optimization algorithms to estimate the canopy resistance on et estimation accuracy fig 4 shows the changes of simulated evapotranspiration and measured values based on de and ga optimization algorithms under different lai thresholds at the three stations the simulation results of two algorithms were basically consistent with the variation trends of measured values which was from rising to steady to fluctuating to declining when the lai thresholds were 0 1 0 5 1 0 1 5 2 0 and 3 0 m2 m 2 the comparative results between simulation and measured values were as follows at yucheng station the errors of etga were 24 63 4 28 6 17 7 84 10 94 and 17 47 mm while the figures of etde were 18 82 4 12 5 41 7 35 9 97 and 16 82 mm respectively at yangling station the errors of etga were 21 51 7 52 4 50 9 34 13 65 and 17 45 mm while the figures of etde were 17 11 7 21 4 47 9 23 13 52 and 16 82 mm respectively at shangqiu station the errors of etga were 20 98 10 87 4 67 12 33 16 53 and 18 98 mm while the figures of etde were 19 32 9 45 4 33 14 45 15 53 and 17 78 mm respectively when lai 0 5 m2 m 2 the accuracy was highest at yangling station and when lai 1 0 m2 m 2 and it was the best performance at yangling and shangqiu stations in addition the et calculated by the ga optimization algorithm was slightly higher than the measured value while the result calculated by the de optimization algorithm was closer to the measured value this was because many parameters were applied in the calculation such as crossover rate and mutation rate in the process of selection crossover and mutation operations in the genetic algorithm the selection of these parameters was obtained by experiences which would seriously affect the optimization results wu et al 2000 fig 5 shows the accuracy of the piecewise optimization jarvis model based on de and ga algorithms to calculate evapotranspiration and measured data at yucheng station when lai 0 5 m2 m 2 the evapotranspiration etde and etga estimated by difference progression and genetic algorithm had highest accuracy followed by 1 0 and 0 5 m2 m 2 the accuracy r2 of etga was 0 84 0 81 and 0 80 while r2 of r c de was 0 86 0 83 and 0 82 respectively at yangling station when lai 1 0 m2 m 2 and it was the best performance followed by 0 5 and 1 5 m2 m 2 the accuracy r2 of etga was 0 82 0 80 and 0 79 and that of etde was 0 84 0 83 and 0 81 respectively at shangqiu station when lai 1 0 m2 m 2 and it showed the best estimation accuracy followed by 0 5 and 1 5 m2 m 2 the accuracy r2 of etga was 0 84 0 84 and 0 76 and that of etde was 0 86 0 82 and 0 80 respectively the precision order of picewise optimization calculation of maize et at yucheng station based on different lai thresholds was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at yangling and shagnqiu stations the precision order calculation was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 this can be due to difference of data acquisition scale the eddy covariance system is used to monitor et of mazie based on the principle of energy balance at yucheng station and the large lysimeter is used to obtain mazie et based on the weighing method at yangling and shangqiu stations based on de and ga optimization algorithms the precision indexes of calculated evapotranspiration and measured values at different segmented intervals at yucheng yangling and shangqiu stations are shown in table 5 at yucheng station the order of the overall accuracy was 0 5 1 0 1 5 2 0 3 0 0 1 m2 m 2 at yangling and shangqiu stations the order of estimation accuracy was 1 0 0 5 1 5 2 0 3 0 0 1 m2 m 2 meanwhile the results calculated by de optimization algorithm calculation were better than those by ga algorithm with r2 of 0 40 0 84 and 0 61 0 86 mae of 0 37 1 03 and 0 22 0 84 mm d 1 respectively at yucheng station the accuracy of et segmentally simulated was highest when lai 0 5 m2 m 2 followed by lai of 1 0 and 1 5 m2 m 2 respectively according to ga optimization algorithm r 2 of 0 84 0 81 and 0 81 mae of 0 43 0 45 and 0 50 mm d 1 gpi of 0 26 0 19 and 0 11 respectively according to de optimization algorithm r 2 was 0 86 0 83 and 0 82 mae of 0 23 0 40 and 0 40 mm d 1 gpi of 1 18 0 17 and 0 11 respectively at yangling station the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 followed by that obtained when lai was 0 5 and 1 5 m2 m 2 respectively according to ga optimization algorithm r 2 was 0 82 0 80 and 0 79 mae was 0 44 0 51 and 0 53 mm d 1 gpi was 0 37 0 28 and 0 16 respectively according to de optimization algorithm r 2 was 0 84 0 83 and 0 81 mae was 0 45 0 46 and 0 49 mm d 1 gpi was 0 34 0 34 and 0 12 respectively at shangqiu station the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 followed by 0 5 and of 1 5 m2 m 2 according to ga optimization algorithm r 2 was 0 84 0 81 and 0 76 mae was 0 37 0 40 and 0 58 mm d 1 gpi was 0 29 0 25 and 0 10 respectively according to de optimization algorithm r 2 was 0 86 0 82 and 0 80 mae was 0 39 0 43 and 0 47 mm d 1 gpi was 0 20 0 14 and 0 09 respectively overall at yucheng station the accuracy of et segmentally simulated was highest when lai 0 5 m2 m 2 at yangling and shangqiu stations the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 the accuracy of et calculated by de optimization algorithm was better than that calculated by ga algorithm therefore it is recommended to use de algorithm for simulate maize evapotranspiration 4 discussion 4 1 the main drivers factors of canopy resistance the study found that the most significant factors affecting maize canopy resistance were r n and lai canopy resistance represents the overall effect of the factors such as stomatal impedance of leaves at different levels different parts and aerodynamic characteristics in canopy on the entire canopy evapotranspiration which is not a purely physiological parameter hoshika et al 2017 canopy resistance is mainly related to meteorological factors and their own physiological process and the main energy of maize leaf photosynthes is comes from solar radiation the main growth season of maize is from may to early october with the gradual enlargement of leaves there is a great difference in the radiation energy obtained by the upper and lower layers of maize and the average ground surface impedance is gradually transformed into canopy resistance li et al 2013 srivastava et al 2018 irmak et al 2013 used eight models estimating r c as a function of different combination of micrometeorological and plant variables are presented the models integrated the linear and non linear effects of regulating variables net radiation rn relative humidity rh wind speed u2 air temperature t vapor pressure deficit vpd leaf area index lai aerodynamic resistance r a to predict hourly r c they found that the accuracy of canopy resistance estimated by the model without lal or solar radiation was the lowest indicating the importance of the lai or solar radiation in estimating r c xu et al 2018 and earl and davis 2003 studied the growth structure of maize crops by using the light of row crops and found that the structure of maize crops was mainly changed by solar radiation and leaf shapes based on the multivariable regression zhou et al 2019 analyzed meteorological factors affecting canopy resistance at different scales and found that photosynthetically active radiation was the main driving factor of canopy resistance followed by the size of leaves and the relative water content li et al 2016 and huang et al 2010 used the bp neural network method to analyze the sensitivity of different impact factors r n net radiation t air temperature vpd vapor pressure deficit θ soil moisture content and lai leaf area index to the jarvis model and used different meteorological factors as input factors of the jarvis canopy resistance model whose conclusion was consistent with this study 4 2 the optimal threshold points of lai the lai is an important parameter of maize canopy structure and can be used to divide growing season wang et al 2005 jiang et al 2016 therefore the empirical parameters in the jarvis model can be fitted by the segmented methods according to the threshold of lai to estimate canopy resistance and then improve the accuracy of estimated et by the p m model it was found that when lai was 0 5 m2 m 2 the accuracy of segmented optimization estimation was best followed by 1 0 and 1 5 m2 m 2 at yucheng station when lai 1 0 m2 m 2 the accuracy estimation was best followed by 0 5 and 1 5 m2 m 2 at yangling and shangqiu stations when lai was 0 1 m2 m 2 the accuracy was worst at the station because parameters in the jarvis model are empirical and vary with the experimental condition and crop growing season meanwhile this may be difference of data acquisition scale the eddy covariance system is used to monitor et of mazie based on the principle of energy balance at yucheng station however the large lysimeter is used to obtain mazie et based on the weighing method at yangling and shangqiu stations in addition the maize canopy resistance was primarily influenced by lai li et al 2016 liu et al 2020 during the growth period the lower leaves were civered with gradual increase of leaf area while the photosynthetic rate of upper leaves increased leading to different solar radiation exposure of different parts of maize plants air temperature and water pressure affected less in the process of maize growth yan et al 2021 srivastava et al 2018 li et al 2016 it is well known that the p m model is the big leaf model li et al 2016 zheng et al 2021 yan et al 2021 in the growth process of maize when lai was 0 5 m2 m 2 at yucheng station and when lai was 1 0 m2 m 2 at yangling and shangqiu stations the canopy resistance calculated had a high accuracy which satisfied the hypothesis of the p m model so the estimation accuracy was highest with the growth of maize lai gradually became larger when lai 2 m2 m 2 the maize canopy were exposed to more sunlight the solar radiation was large and the temperature was high in july and august which was conducive to crop evapotranspiration lagos et al 2013 li et al 2016 when lai 3 m2 m 2 overlaps occurred between leaves resulting in less radiation on the middle and lower leaves lower temperaturer and higher humidity which had a great impact on the canopy resistance model and inhibited crop evapotranspiration shan et al 2020 li et al 2016 xu et al 2017 zheng et al 2021 therefore when lai 2 m2 m 2 the accuracy of evapotranspiration calculated by subsection optimization was higher than that when lai 3 m2 m 2 when lai 0 1 m2 m 2 maize leaves were small and crop transpiration was small and most evaporation came from soil evaporation so the accuracy of estimation accuracy was low this was consistent with the finding of ortega farias et al 2004 and dolman 1993 however some researchers li et al 2013 also believed that when lai 2 m2 m 2 using p m model to estimate et had better performance this was different from the conclusion in the study because combining the jarvis canopy resistance model and the soil resistance model they have developed a coupled surface resistance model and the penman monteith pm model be used to estimate sparse soybean and grape evapotranspiration et in addition the underlying layer and geographical environment of crop growth were different 4 3 the significant improvement of simulation accuracy by differential evolution de and genetic algorithm ga this study found that both differential evolution de and genetic algorithm ga can significantly improve the simulation accuracy of maize et and de is slightly higher than ga in the nonlinear processing both algorithms can obtain the optimal parameters and improve the simulation accuracy based on the swarm intelligence theory the differential evolution algorithm can dynamically track the current search situation to adjust its search strategy and has strong global convergence ability and stability yi et al 2014 genetic algorithm is a random global search developed based on the theory of biological evolution in nature and it has the ability of parallel efficient and global search chemin and honda 2018 it can automatically obtain and accumulate knowledge about the search space in the search process in the optimization process it mainly carries out selection crossover and mutation operations and adaptively controls the search process to obtain the optimal parameters kim and hung 2008 used genetic algorithm to optimize neural network model to predict alfalfa evapotranspiration and transpiration it was found that genetic algorithm has variable parameters in the process of parameter optimization such as selection rate crossover rate and mutation rate these parameters will seriously affect the optimal solution and have a certain dependence on the initial training samples wu et al 2000 chai 2010 5 conclusions based on the measured data of eddy covariance systems and large scale lysimeters at three sites in the semi humid regions of northen china this study determined the empirical parameters in the jarvis model by adopting ga and de algorithms under different lai thresholds by taking the canopy resistance reversely calculated by the p m model as the standard value canopy resistance calculated by verification parameters was verified the measured evapotranspiration data were used to verify the estimated results the main conclusions of this study are as follows 1 the canopy resistance decreased when net radiation r n air temperature t vapor pressure deficit vpd soil water content θ and leaf area index lai increased the order of the correlation significance of impact factors on the canopy resistance was r n lai θ vpd t the canopy resistance was significantly correlated with r n followed by lai θ and vpd 2 the accuracy of estimated maize r c was effectively improved by adopting the lai threshold segmentation method and ga and de algorithms to fit the empirical parameters in jarvis model at yucheng when the lai threshold was 0 5 m2 m 2 the parameters in the jarvis model fitted by the two optimization algorithms greatly improved the estimation accuracy of the canopy resistance at yangling and shangqiu stations the accuracy of et segmentally simulated was highest when lai 1 0 m2 m 2 3 using differential evolution de and genetic algorithm ga optimization algorithms to calibrate the empirical parameters in jarvis model for simulate the et of maize the simulation accuracy of p m model can be effectively improved by differential evolution and genetic algorithm and the optimization result that the de is slightly higher than ga with r2 of 0 58 0 86 and 0 40 0 84 mae of 0 23 0 85 mm d 1 and 0 37 1 03 mm d 1 d of 0 73 0 88 and 0 58 0 87 credit authorship contribution statement zongjun wu writing original draft writing review editing ningbo cui conceptualization methodology writing review editing lu zhao writing review editing le han writing review editing xiaotao hu supervision funding acquisition project administration huanjie cai data curation daozhi gong supervision funding acquisition project administration liwen xing xi chen writing review editing bin zhu writing review editing min lv shidan zhu quanshan liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank yucheng yangling and shangqiu experimental stations for providing data for this study this work was also supported by the national key research and development program of china no 2016yfc0400206 the national natural science foundation of china 51922072 51779161 51009101 the science and technology projects of sichuan 22zdyf0145 22qycx0069 22qycx0073 22qycx0115 and the national key technologies r d program of china no 2015bad24b01 
3596,the focus of this paper is to establish a general model which is capable of dynamic simulation of discrete fractures at any position and arbitrary distribution in rectangular closed reservoir in this article a semi analytical model for fractured horizontal wells with random distributed fracture networks is proposed to facilitate pressure transient response using a double node method a rectangular closed reservoir model and fracture network flow model are established respectively and then coupled at the fracture wall in order to deal with the flow distribution at the fracture intersection a simple adaptive material balance method is proposed in this paper which successfully solves the flow distribution at the intersection using advanced mathematical means the model is successfully solved in laplace space and then the pressure response solution in real space is obtained by stehfest numerical inversion method the obtained solutions are verified and compared with the numerical simulation results the calculation results show that the flow characteristics of the orthogonal fracture network can be roughly divided into six stages namely bi linear flow first linear flow first radial flow second linear flow second radial flow and boundary dominated flow however these flow characteristics will deviate or even be missing depending on the complexity of the fracture network finally the effects of some important parameters such as dimensionless fracture network conductivity main fracture length fracture network density reservoir area and eccentric position on pressure response and pressure field distribution are discussed in detail keywords pressure transient response fractured horizontal wells rectangular closed reservoir random distributed fracture networks semi analytical model 1 introduction the united states has set off a shale oil and gas revolution at the same time the outbreak of shale oil and gas revolution has changed the world energy pattern this revolution originated from the development of multi stage fracturing technology in horizontal wells which makes the natural fractures and hydraulic fractures in unconventional reservoirs communicate thus greatly improving the unconventional oil and gas production capacity warpinski et al 2008 wang et al 2018a since the great success of hydraulic fracturing some scholars have established models for hydraulic fracture pressure and production and then carried out a lot of simulation and analysis work gringarten and ramey 1973 cinco et al 1978 berumen et al 2000 tiab 2005 luo and tang 2015 wang et al 2018a wang et al 2018b as a pioneer in fracture simulation gringarten and ramey 1973 took the lead in solving the problem of unsteady flow in a single vertical fractured well in real time domain by using the method of green function a finite conductivity vertical fracture model was presented by cinco et al 1978 who coupled the matrix with the fracture to form the fredholm integral equation berumen et al 2000 proposed a numerical solution of a single asymmetric fracture under the condition of fixed rate and then studied the influence of asymmetric factor on the type curves tiab 2005 presented tds method to calculate the asymmetry factor luo and tang 2015 presented a fracture wing model and the non darcy effect in the fracture was considered into their model in terms of semi analytical models fredholm equation is a classical matrix fracture coupling equation which was firstly presented by cinco ley and meng 1988 some related models of multi stage fractured horizontal wells are also proposed to study the pressure responses wan and aziz 2002 and production optimization wei and economides 2005 brown et al 2009 in some tight formation escobar et al used the finite difference method to solve the coupling problem of matrix and fracture and the typical curve of multi branch fracture was proposed wan and aziz 2002 presented a semi analytical model for a horizontal well with multiple 3d fractures in a parallelepiped region wei and economides 2005 presented production index optimization model for a horizontal well with transvers fractures brown et al 2009 proposed a three dimensional flow model which is called trilinear flow model in their model the interference between fractures is ignored and the fractures are distributed equidistant whether it is a single fracture gringarten and ramey 1973 cinco et al 1978 berumen et al 2000 tiab 2005 or a horizontal well with multiple fractures wan and aziz 2002 wei and economides 2005 jia et al 2017 the common point is that the fracture is connected with the wellbore we call it the main fracture in a real reservoir fractures can be roughly divided into three types main fractures connected with wellbore secondary fractures connected with main fractures and discrete fractures in particular there are several modes of discrete fractures either connected with secondary fractures or directly connected with wellbore or connected with each other or isolated in fact according to the types of fractures they can be divided into natural fractures and artificial fractures and all the existing fractures can be classified into these two categories in the past the dual porosity model is often used to describe the flow behavior of natural fractures barenblatt et al 1960 warren and root 1963 boulton and streltsova 1977 dougherty and babu 1984 moench 1984 sen 1986 hamm and bidaux 1996 but in some shale reservoirs the scale of some secondary fractures induced by natural fractures or hydraulic fractures is also very large jourde et al 2002 fracture networks are often randomly distributed rather than cube lattices therefore the traditional double porosity model is challenged to describe such problems some scholars have focused their attention on arbitrarily distributed fractures huskey and crawford 1967 studied the effect of isolated vertical fractures on pressure distribution cinco ley et al 1976 developed type curves for a vertical well near a single infinite conductivity nature fracture and analyzed the effect of the angle of the natural fracture on pressure responses izadi and yildiz 2009 developed a semi analytical model for multiple vertical wells in discretely fractured porous media this is a very classical model considering the effect of conductivity however the model does not consider the cross flow between fractures which limits its application zeng et al 2012 developed a discrete fracture model considering the non darcy effect and analyzed the effect of non darcy number on the pressure response kuchuk and biryukov 2015 used discrete fracture model to analyze well test data of naturally fractured reservoir in detail luo et al 2018 presented a production optimization curves for a vertical well near a fracture semi analytical models have been proposed to simulate crossed fracture network chen et al 2016 wang et al 2018a wang et al 2021 or uncrossed fracture networks izadi and yildiz 2009 zeng et al 2012 kuchuk and biryukov 2015 and most of them only consider vertical wells in an infinite outer boundary condition izadi and yildiz 2009 zeng et al 2012 luo et al 2018 wang et al 2020 or a horizontal well intercepted by primary and secondary fracture networks chen et al 2016 wang et al 2018a wang et al 2018b but the unsteady model about the influence of rectangular boundary is seldom concerned in the late stage of flow the boundary will have a profound impact on the pressure response and productivity of multi stage fractured horizontal wells in addition the flow treatment of fracture intersection is an important problem the authors above put forward a method to judge the flow direction of intersection artificially however this method is ineffective for a large number of fracture simulation the objective of this paper is to establish a general framework to simulate the pressure response of horizontal wells intercepted by arbitrarily distributed fractures under rectangular closed boundary conditions a double node analysis method is proposed to describe the complex fracture network model and the adaptive material balance equation is used to solve the flow problem at the fracture intersection so that we do not need to consider the flow direction at the intersection the rectangular closed reservoir model and fracture model are established separately advanced mathematics is used to obtain the solution of laplace space such as laplace and fourier transformations the corresponding pressure field maps and type curves for a horizontal well with complex fracture networks were also generated to facilitate our interpretation into pressure response behavior in a rectangular closed reservoir the generalized framework model would provide the fundamental guidance for production performance analysis and optimization in the future 2 method 2 1 physical model fig 1 shows a schematic diagram from a simple fracture to a complex fracture network in a rectangular closed reservoir we can find that these main fractures are of equal length and perpendicular to the horizontal wellbore which is a general assumption chen et al 2016 put forward the hypothesis that the main fracture with orthogonal secondary fracture under the condition of infinite reservoir see fig 1b in fact in real reservoirs fractures are usually arbitrarily distributed which is more like fig 1c and fig 1d therefore in this paper we consider a more complex fracture network model some more detailed assumptions are as follows 1 first of all the whole reservoir flow is considered to be a pseudo three dimensional flow which looks like a two dimensional flow on the horizontal plane 2 the reservoir has constant thickness h constant porosity ϕ and constant permeability k 3 the reservoir contains a slightly compressible single phase fluid of constant compressibility ct and constant viscosity μ 4 as shown in fig 1d the fractures in reservoir include main fractures intersected fractures linked with main fractures and non intersected fractures not directly or indirectly linked with main fractures 5 a horizontal well is produced with constant flow rate q 6 the four outer boundaries of the reservoir are all closed 7 as shown in fig 2 the discrete fracture system contains nf fractures and each fracture has nfj segments with a full length lfj i fracture width wfj angle θj i with the x axis and the located position xofj i yofj i j 1 2 nf i 1 2 nfj 2 2 reservoir model according to the above physical model and based on the continuity equation and darcy s law the governing equations including intersecting and non intersecting fractures can be written as 1 1 x k μ p x y k μ p y f f t ϕ c t p t ω where 1 2 f f t j 1 n f i 1 n fj q fj i u j i t l fj i l fj i 1 2 h l fj i δ x x ofj i l fj i cos θ fj i u j i cos θ fj i δ y y ofj i l fj i sin θ fj i u j i sin θ fj i d u j i where δ is dirac delta function p is pressure in the reservoir pa k is the permeability of the reservoir m2 μ is viscosity pa s t is the time s nf is total fracture number nfj is total fracture segment number of the j th fracture h is reservoir thickness m x y is the coordinate of any point in the reservoir m qfj i is flow rate per unit of volume of the i th segment for the j th fracture m3s 1 the superscript m represents aquifer or matrix lfj i is the ith fracture segment half length for the j th fracture m ff t is fracture source sink term θfj i is the angle between the jth fracture and x axis xofj i yofj i is the coordinate of i th fracture segment starting point for the j th fracture m uj i is point source in the fracture segment m since the four boundaries of a rectangular reservoir are impermeable we can write out the outer boundary conditions 2 p x x 0 x e 0 p y y 0 y e 0 for convenience we used the dimensionless definition to make the above equation dimensionless as follows p d 2 π k h p i p b q r x d x l r y d y l r x ofdj i x ofj i l r y ofdj i y ofj i l r l fdj i l fj i l r t d kt ϕ μ c t l r 2 q fdj i q fj i q r x ed x e l r y ed y e l r where q r is the reference flow rate m3s 1 l r represents the reference length m by defining dimensionless formula we can rewrite the reservoir control equation and the eq 1 becomes 3 1 2 p d x d 2 2 p d y d 2 f fd t d p d t d ω 3 2 f fd t d j 1 n f i 1 n fj q fdj i u dj i t d l fdj i l fdj i π l fdj i δ x d x ofdj i l fdj i cos θ fdj i u dj i cos θ fdj i δ y d y ofdj i l fdj i sin θ fdj i u dj i sin θ fdj i d u dj i where p d is the dimensionless pressure td represents the dimensionless time qfdj i denote the dimensionless flow rate per unit of volume of the i th segment for the j th fracture l fdj i is the i th dimensionless fracture segment half length for the j th fracture x d y d is the dimensionless coordinate of any point in the reservoir x ofdn y ofdn is the dimensionless coordinate of i th fracture segment starting point for the j th fracture θfdj i is the dimensionless angle between the j th fracture and x axis for a rectangular closed boundary the outer boundary condition is written as 4 p d x d x d 0 x ed 0 p d y d y d 0 y ed 0 eqs 3 and 4 constitute the model of complex fracture network with multiple fracture segments in rectangular closed reservoirs which can be solved by laplace transform and finite cosine fourier transform appendix a of supplementary file lists the detailed derivation process therefore the derivation results for pressure can be written as follows 5 1 p d x d y d s π 2 x ed j 1 n f i 1 n fj q fdj i u dj i s l fdj i l fdj i cosh s y ed y d y pdj i l fdj i s sinh s y ed d u dj i π x ed m 1 cos u m x d j 1 n f i 1 n fj q fdj i u dj i s l fdj i l fdj i cos u m x pdj i cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed d u dj i where 5 2 x pdj i x ofdj i l fdj i cos θ fdj i u dj i cos θ fdj i y pdj i y ofdj i l fdj i sin θ fdj i u dj i sin θ fdj i 5 3 cosh s y ed y d y pdj i l fdj i s sinh s y ed cosh s y ed y d y pdj i l fdj i s sinh s y ed cosh s y ed y d y pdj i l fdj i s sinh s y ed 5 4 cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed 5 5 u m m π x ed m 0 1 2 3 where pd represents the dimensionless pressure in the real time domain p d is the dimensionless pressure variable of the laplace space td is the dimensionless time and s is the laplace space transform parameter eq 5 is the solution of multiple fracture segments in closed rectangular reservoir but in order to calculate efficiently the integral of eq 5 1 must be treated appendix b of supplementary file lists the treatment method by means of advanced mathematics and physics the dimensionless pressure for i th segment of the j th fracture with an arbitrary orientation angle in laplace domain is as follows 6 p dj i x dj i y dj i s π 2 x ed sin θ fdj i j 1 n f i 1 n fj q fdj i u dj i s f 1 d j i π x ed sin θ fdj i m 1 cos u m x dj i j 1 n f i 1 n fj q fdj i u dj i s f 2 d j i f 3 d j i i 1 2 3 n fj j 1 2 3 n f where 7 f 1 d j i 1 s l fdj i 2 sinh s y ed y dj i y wdj i l fdj i sin θ fdj i sinh s y ed y dj i y wdj i l fdj i sin θ fdj i sinh s y ed sinh ε 0 y ed y wdj i l fdj i sin θ fdj i y dj i sinh ε 0 y ed y wdj i l fdj i sin θ fdj i y dj i sinh s y ed 8 f 2 d j i 2 l fdj i m 1 s u m 2 s u m 2 u m 2 cot 2 θ fdj i 2 s u m 2 cos u m x wdj i y dj i y wdj i cot θ fdj i cos u m x dj i f 21 d j i cos s u m 2 x wdj i l fdj i cos θ fdj i cos s u m 2 x dj i f 22 d j i cos s u m 2 x wdj i l fdj i cos θ fdj i cos s u m 2 x dj i 9 f 21 d j i sinh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i sinh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 10 f 22 d j i sinh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i sinh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 11 f 3 d j i 2 l fdj i m 1 u m cot θ fdj i s u m 2 u m 2 cot 2 θ fdj i f 31 d j i sin u m x wdj i l fdj i cos θ fdj i cos u m x d f 32 d j i sin u m x wdj i l fdj i cos θ fdj i cos u m x d 12 f 31 d j i cosh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i cosh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 13 f 32 d j i cosh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i cosh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed eqs 6 to 13 form the final solution for a rectangular closed reservoir in order to get the final solution it is necessary to couple the fracture flow model 2 3 fracture network flow model as shown in fig 3 the fracture element is divided by big nodes each big node is divided into four small nodes and each two small nodes together with the fractures between them constitute a double node fracture element the whole fracture network can be regarded as composed of many double node elements fig 3b in which the single node element is a special case of the double node element in the double node element the small nodes at both ends have fluid inflow or outflow and the single node element can be regarded as the dead node at the other end the overall compressibility of the fracture is very small therefore fluid flow in the fracture would be steady and the governing equation in the discrete fractures can be given as 14 x k fj μ p fj x fj y k fj μ p fj y fj 0 0 x fj l j w j 2 y fj w j 2 j 1 2 n f seen from the whole reservoir the fracture can be assumed to have zero width therefore we have the pressure and flux equations 15 s fn x fj w j 2 t p fn x fj w j 2 t p x 0 t and 16 k fj p fj y fj y fj w j 2 k p y y 0 k p y y 0 k fj p fj y fj y w j 2 taking the integral average of pressure across the fracture width in the y direction and combining eqs 15 and 16 eq 14 could be replaced by 17 x k fj p fj x fj 2 k w j p y y 0 0 on the fracture surface the flux condition can be given 18 2 h l fj k μ p y y 0 q fj l fj the flow rate condition of the left node of the fracture can be given by 19 w j h k fj μ p fj x fj x fj 0 q fwk the flow rate condition of the right node of the fracture can be given by 20 w j h k fj μ p fj x fj x fj l fj q f w k 1 where kfj is the permeability in the j th fracture m2 wj is the j th fracture width m pfj is the pressure in the j th fracture pa qfwk is the k th node flow rate in the j th fracture m3 s equations 17 to 20 form the discrete fracture pressure equations now we can use the following dimensionless definitions to make the above equation dimensionless c fdj k fj w j k l r p fdj 2 π k h p i p fj q r q fdwk q fwk q r q f d w k 1 q f w k 1 q r where cfdj is the j th dimensionless fracture conductivity dimensionless pfdj is the dimensionless drawdown in the j th fracture qfdwk is the k th node dimensionless flow rate in the j th fracture through the dimensionless definitions eq 17 can become 21 2 p fdj x fdj 2 2 c fdj p y d y d 0 0 eq 18 becomes 22 p d y d y d 0 π q fdj eq 19 becomes 23 p fdj x fdj x fdj 0 q fdwk 2 π c fdj eq 14 becomes 24 p fdj x fdj x l fdj q f d w k 1 2 π c fdj eqs 21 to 24 constitute a system of dimensionless pressure equations of the fracture network flow by using the double integral method abramowitz and stegun 1965 wang et al 2021 its solution in laplace space can be solved 25 p fdwk s p fdj x d 2 π c fdj x fdj q fdwk 2 π c fdj 0 x d 0 v q fdj u d u d v further we discretize the above equation and if the fracture is divided into nfn segments for i th segment of the j th fracture eq 19 would have the following transformation 26 p fdj i x fdj i p fdwk s 2 π c fdj x fdj i q fdwk 2 π c fdj ε 1 i 1 q fdj ε s δ x j 2 2 δ x j x di ε δ x j δ x n 2 8 q fdj i s i 1 2 3 n fj j 1 2 3 n f where xfdj i is the middle point for the i th segment of the j th fracture 2 4 the semi analytical solution by coupling reservoir model and fracture network flow model in order to obtain the final semi analytical solution the reservoir model should be coupled with the fracture network model there are nf fractures in the whole reservoir and each double node fracture has nfj segments so the number of total segments is 27 n t o t a l s e g m e n t j 1 n f n fj where ntotal segment is total number of fracture segments which are total number of the fracture surface flux fracture node number is nnode k 1 2 3 the k th node has nk branches as shown in fig 3 each node has nk unknown flow rate q fdwk m m 1 2 3 n k finally the number of total unknown flow rate in the all nodes can be obtained 28 n t o t a l r a t e k 1 n node n k where ntotal rate is the total number of unknown flow rate in the fracture node each node has one unknown pressure pfdwk and the total number of unknown pressure is nnode therefore total number of unknowns is ntotal segment ntotal rate nnode according to the continuity condition that the reservoir pressure pdj i for eq 6 continuous to the fracture pressure pfd for eq 26 on the surface of fracture a system of equations can be obtained 29 p dj i p p fdj i x fdj i j 1 2 n f i 1 2 n fj eq 29 shows a system of ntotal segment equations if there is no well outflow at the node the total flow of the node is equal to zero and if there is a well at a certain node the sum of total flow rate should be equal to well flow rate the piecewise equation is expressed as follows 30 m 1 n k q fdwk m 0 n o w e l l a t t h e n o d e q fdwk well w e l l a t t h e n o d e k 1 2 n node eq 30 has a system of nnode equations in addition the k th node has nk branches and nk sub flow rate shown in fig 3b and the relationship between flow rate for each small node and flux of branch fracture segment can be given by 31 q fdwk m i 1 n fj q fdji l fdj n fj k 1 2 n node m 1 2 n k eq 31 has a system of ntotal rate equations now we have ntotal segment ntotal rate nnode equations if some branch with double node appeared the relationship in eq 31 will be rewritten as 32 q fdwk m q f d w k 1 m i 1 n fj q fdji l fdj n fj k 1 2 n node m 1 2 n k the above equation shows that the k th node and the k 1 th node have the same flow relation equation in eq 32 we have two nodes but we write only one equation so here we need to add an auxiliary equation as follows 33 p fdwk p f d w k 1 2 π c fdj l fdj q fdwk 2 π c fdj i 1 n fj q fdji p δ x j 2 δ x j l fdj i δ x j equations 29 to 33 constitute a linear equation system in laplace space which can be solved by gaussian elimination method then the derived solution is brought into equation 6 and then wellbore pressure in laplace space can be obtained the final wellbore drawdown in real time domain can be obtained by stehfest 1970 numerical inversion 3 model validation and flow characteristics the proposed model is a general model which can calculate the pressure response of complex fracture network alternatively the existing numerical simulators can simulate some simple cracks extending along the direction of the network here we choose two cases to verify our model one case is the horizontal well with multiple parallel main fractures another case is that there are some secondary parallel fractures on the main fracture in this case the main fracture and the secondary fracture must be orthogonal 3 1 comparison with numerical simulation for a horizontal well with three parallel main fractures a numerical simulator is used to verify a simple model fracture number nf is set to 3 the dimensionless conductivity for every fracture is set to 100 the dimensionless fracture length lfdj is set to 2 the dimensionless reservoir length xed and width yed is set 70 and 70 respectively the dimensionless fracture spacing is 8 fig 4 shows the validation of the presented model for a horizontal well with 3 equally spaced parallel and high conductivity fractures in rectangular closed reservoir unstructured grids are used for numerical simulation as shown in the figure on the left of fig 6 and the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively from the pressure and pressure derivative curves it can be seen that the data from the numerical simulation fit well with the data from the semi analytical model however in the early numerical simulation due to the numerical dispersion phenomenon there are some errors compared with the semi analytical solution 3 2 comparison with numerical simulation for a horizontal well with 3 equally spaced parallel and low conductivity fractures with 12 secondary fractures in rectangular closed reservoir fig 5 shows the validation of the presented model for a horizontal well with 3 equally spaced parallel and low conductivity fractures with 12 secondary fractures in rectangular closed reservoir the number of main fractures is 3 the number of secondary fractures is 12 the length of main fractures is 2 and the length of secondary fractures is also 2 conductivity value of all fractures is 10 unstructured grids are used for numerical simulation as shown in the figure on the right of fig 6 and the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively it is obviously seen from the figure that there is an excellent match throughout the entire time period except tiny time scope due to numerical dispersion phenomenon 3 3 comparison with numerical simulation for a horizontal well with 3 arbitrarily distributed main fractures with 12 arbitrarily distributed secondary fractures in rectangular closed reservoir in rectangular closed reservoir fig 7 shows the validation of the presented model for a horizontal well with 3 arbitrarily distributed main fractures with 12 arbitrarily distributed secondary fractures in rectangular closed reservoir conductivity value of all fractures is 10 the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively it is obviously seen from the figure that there is an excellent match throughout the entire time period 3 4 flow characteristics analysis as shown in fig 5 pressure and pressure derivative can reflect the flow characteristics of fluid in the reservoir fig 8 shows the pressure field corresponding to different flow stages it can be seen from the pressure derivative curve in fig 5 that the flow can be roughly divided into six stages the first stage is bilinear flow which shows a straight line with a slope of 1 4 on the pressure derivative curve occurs before the dimensionless time is less than 0 01 as shown in fig 8a in this stage the linear flow in the reservoir and the linear flow in the fracture occur simultaneously the second stage is the linear flow stage and the pressure derivative curve shows a straight line with a slope of 1 2 occurring between 0 01 and 1 of the dimensionless time as shown in fig 8b at this extreme the linear flow of the main fracture and the secondary fracture is dominant the third stage is the first radial flow stage in which the pressure derivative curve shows a constant straight line occurs between the dimensionless time 1 7 as shown in fig 8c the radial flow will concentrate near the unit composed of each main fracture and secondary fractures the fourth stage is the second linear flow stage in which the pressure derivative curve reflects the 1 2 slope straight line segment occurring between 8 and 100 of the dimensionless time as shown in fig 8d in this stage all the main fractures and secondary fractures form a whole and linear flow occurs outside the whole the fifth stage is the second radial flow stage in this stage the derivative curve represents a 1 2 constant straight line segment occurs in dimensionless time greater than 100 and less than 300 as shown in fig 8e all the sources and sinks form a whole and radial flow occurs around this whole the sixth stage is the boundary dominated flow stage and the derivative curve shows a straight line segment of unit slope which occurs when the dimensionless time is greater than 300 as shown in fig 8f when the pressure wave propagates to the boundary all the pressure in the reservoir begins to drop in this stage the pressure drop rate will be a constant also known as the quasi steady flow stage 4 results and discussion here we discuss a more general case which is the case of a multi stage fractured horizontal well in a complex fracture network the distribution of these fractures is shown in fig 9 in the figure the red solid line represents the main fractures and the green solid line represents the intersected fractures they are secondary fractures formed by fracturing and they may also be connected by the later transformation of natural fractures the blue solid line represents non intersected fractures which are not connected with the main fracture as shown in fig 9 the number of main fractures is 3 with 21 intersected fractures and the number of non intersected fractures is 20 the initial dimensionless main fracture spacing is 5 the main fracture length is 4 and the main fractures are all parallel to the y axis the dimensionless reservoir length xed and width yed is set 50 and 50 respectively 4 1 compared with a horizontal well with only three simple fractures in this part we compare the simulation results of complex fracture network with a simple case of a horizontal well with three simple fractures here the dimensionless conductivity of all fractures is set to 20 the comparison results are shown in fig 10 from the dimensionless pressure curve in the figure it can be seen that the pressure loss of complex fracture system is less than that of simple fracture suggesting that horizontal wells produce the same output and only small pressure drop is required in complex fracture system the red dotted line in the figure represents the derivative curve of simple fracture it can be seen that the flow can be roughly divided into six stages the first radial flow time is very short and not very obvious because the fracture spacing is short and the fracture length is long for complex fracture networks bilinear flow and linear flow time become very long however the first radial flow regime disappeared completely which may be the result of the interference of intersected and non intersected fractures between the main fractures in the second radial flow and boundary dominated flow stage the derivative curves for the two different fracture distributions completely coincide because the discrete fractures are only distributed near the main fractures and the distant non intersected fractures have little influence on the flow state the above analysis results can be reflected more clearly through the pressure field as can be seen from fig 11 a when the dimensionless time is 0 01 the change of pressure field mainly occurs near the fracture which is the period of bi linear flow during this period the fluid on the fracture and vertical fracture wall flows at the same time the biggest pressure loss is in the main fracture and intersected fracture at this time the pressure drop near the non intersected fracture is small when the dimensionless time is 0 1 this stage is dominated by vertical fracture linear flow as shown in fig 11b at this stage the linear flow near the fracture is the main one and at this time there is also pressure loss near the non intersected fracture fig 11c shows the pressure field distribution when the dimensionless time is equal to 1 at this time point the first radial flow occurs however due to the complexity of fracture morphology the equipotential line around the main fracture shows an irregular shape as can be seen from fig 11d the second linear flow will occur around these fracture networks over time at this time all fractures can be regarded as a whole 4 2 effect of dimensionless fracture conductivity on pressure response fig 12 shows the influence of the dimensionless fracture network conductivity on the typical curve the dimensionless fracture network conductivity is set to 5 20 50 and 300 respectively the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative we use square circle and triangle to distinguish the results of different values it can be seen from the dimensionless pressure curve that the smaller the dimensionless conductivity the higher the dimensionless pressure which means that a small dimensionless conductivity will produce a large pressure loss with the extension of time the pressure loss decreases gradually when entering the boundary dominated flow stage the dimensionless pressure curves almost coincide suggesting that the pressure loss under different dimensionless conductivity is close to the same fig 13 shows the distribution characteristics of pressure field under different dimensionless fracture network conductivity at the td 0 1 it can be seen from the figure that when the dimensionless fracture conductivity is small the pressure change is mainly concentrated near the intersected fracture near the well and the diffusion speed of pressure wave is slow as the dimensionless fracture conductivity gradually increases we can see that the pressure can spread to the distal fracture therefore the smaller the dimensionless fracture conductivity the greater the pressure loss near the wellbore under the same production 4 3 effect of main fracture length on pressure response fig 14 shows the influence of the main fracture length on the type curve the main fracture length is set to 4 3 2 and 1 respectively the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative it can be seen from the dimensionless pressure curve that the shorter the fracture the greater the dimensionless pressure which also implies that the shorter main fracture will lead to large pressure loss this can be seen from the pressure field diagram shown in fig 15 when the main fracture is short the number of fractures intersecting the main fracture becomes less which leads to a large pressure loss it can be seen from the derivative curve that the length of the main fracture mainly affects the flow behavior in the early and middle stages the long main fracture will make the bi linear flow period longer when the main fracture is short we can see that the first radial flow stage appears when the dimensionless time is greater than 1 the derivative curves under different main fracture lengths coincide suggesting that the late flow behavior is not affected by the length of main fractures fig 15 shows the distribution characteristics of pressure field under different main fracture length at the td 0 1 it can be known from the figure that when the dimensionless fracture conductivity is small the pressure change is mainly concentrated near the intersected fracture near the well and the diffusion speed of pressure wave is slow as the dimensionless fracture conductivity gradually increases we can see that the pressure can spread to the distal fracture therefore the smaller the dimensionless fracture conductivity the greater the pressure loss near the wellbore under the same production it can be seen from fig 15a to fig 15d that the propagation speed of pressure wave gradually slows down with the change of the length of the main fracture this is because when the main fracture is short fewer fractures are connected with the main fracture in the early stage the change of pressure field is mainly reflected near the main fracture it can be seen from this figure that fig 15a has officially reached the bilinear flow stage but fig 15d has reached the linear flow stage 4 4 effect of main fracture density on pressure response fig 16 shows the influence of the main fracture density on the type curve the main fracture number is set to 3 and 5 the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative the more the number of fractures is the greater the density of main fractures is it can be seen from the dimensionless pressure derivative curve that the smaller the main fracture density is the greater the dimensionless pressure is which implies that a low main fracture density will lead to a large pressure loss it can be seen from the derivative curve that the main fracture density mainly affects the derivative curve shape in the early and middle stages the influence on flow characteristics mainly occurs in the linear flow stage and the curve completely deviates from the 1 2 slope straight line fig 17 shows the distribution characteristics of pressure field under different main fracture density at the same dimensionless time td 0 1 the fracture spacing is 5 for the case with 3 main fractures and 2 5 for the case with 5 main fractures it can be seen from the figure that the more the number of fractures the greater the main fracture density and the higher or more intense the fracture interference we can also clearly see that with the increase of the number of main fractures the dimensionless fracture conductivity increases and the pressure loss is also relatively low in the process of oilfield development the density of main fractures will be a very important factor affecting production 4 5 effect of discharge area and eccentric position on pressure response fig 18 a shows the effect of discharge area on a typical curve we select three groups of different areas 50 50 40 40 and 30 30 respectively from the dimensionless pressure curve it can be seen that when the dimensionless time is less than 100 all curves coincide which implies that the discharge area has no effect on the early and medium term flow of complex fracture network when the dimensionless time is greater than 100 the smaller the discharge area is the larger the dimensionless pressure value is suggesting that a small discharge area will lead to a large pressure loss it can be seen from the derivative curve that the smaller the discharge area the earlier the quasi steady state flow time which will greatly shorten the radial flow time fig 18b shows the effect of eccentric position on a typical curve the drainage area of the reservoir is 30 50 we have selected three cases the first case is that the midpoint coordinate of the central main fracture is 0 0 the second case is that the midpoint coordinate of the central main fracture is 5 5 and the third case is that the midpoint coordinate of the central main fracture is 10 10 it can be seen from the dimensionless pressure curve that when the dimensionless time is greater than 5 the dimensionless pressure curve begins to be affected by the eccentric position case 3 is that the position of the fracture networks is closer to the boundary it can be seen that the closer the fracture network is to the boundary the greater the dimensionless pressure loss in addition the derivative curve shows that the eccentric position has a significant impact as the fracture network gets closer to the boundary the radial flow gradually disappears and the quasi steady state flow time is shortened in rectangular closed reservoir boundary effect will play an important role in the middle and late stage 5 potential applications and limitations in this paper we propose a complex fracture network flow simulation model this model is a complete forward problem the reservoir parameters fluid parameters and fracture parameters in the proposed model are known we can obtain the dynamic characteristics of the well such as pressure and flow however in real reservoirs some physical parameters are often unknown such as fracture half length fracture permeability reservoir permeability and so on these physical parameters need to be obtained by inversion combined with some geological information this will be the study of the inverse problem if we monitor the parameters such as pressure and flow we can carry out historical fitting through the proposed model and constantly correct the unknown physical parameter values until the theoretical calculated values are in the best agreement with the observed values patzek et al 2013 this will be the study of the inverse problem in the process of inverse problem research uncertainty is greatly strengthened therefore if we want to obtain more reliable results we need to combine more fracturing construction and geological information especially in the process of fracture parameter inversion of shale reservoir if more micro seismic monitoring results can be combined the fracture parameter interpretation will be more convincing the semi analytical model proposed in this paper only needs the discretization of fractures and the reservoir does not need the meshing so the amount of calculation is greatly saved however there are still some application limitations at present we consider that the fracture is only 2d case the orientation on the plane can change randomly and the fracture and fracture can cross randomly or not this can be seen from the governing equation of reservoir in future research we can continue to study 3d fractures by using the methods provided in this paper in 3d space fractures have parameters such as length width height azimuth and inclination however it is not easy to obtain the 3d solution in which case the analytical solution will be very complex how to deal with the results in such a complex situation i hope to do more discussion in the future 6 conclusions the conclusions are made as follows 1 a new semi analytical model of multi fractured horizontal wells with random distributed fracture networks in rectangular closed reservoirs was established and solved by using a double node method 2 the proposed model is verified by two sets of numerical simulation models one is the horizontal well with several parallel fractures the other is the horizontal well with several main fractures and secondary fractures because the numerical simulator adopts orthogonal grid the fractures extend along the grid direction the good fitting results show the reliability of our model 3 the results show that for regular fracture networks e g orthogonal fracture networks the flow characteristics can be roughly divided into six stages bi linear flow first linear flow first radial flow second linear flow second radial flow and boundary dominated flow the time that these flow characteristics may appear will be prolonged shortened or even disappear which is determined by the complexity of fracture network 4 the pressure dynamic characteristics of complex fracture network in rectangular closed reservoir are discussed in detail the main factors affecting the pressure dynamic characteristics of complex fracture network include the dimensionless conductivity of fracture network the length of main fractures fracture density reservoir discharge area and the eccentric position of fracture network declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china no 51774256 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127547 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3596,the focus of this paper is to establish a general model which is capable of dynamic simulation of discrete fractures at any position and arbitrary distribution in rectangular closed reservoir in this article a semi analytical model for fractured horizontal wells with random distributed fracture networks is proposed to facilitate pressure transient response using a double node method a rectangular closed reservoir model and fracture network flow model are established respectively and then coupled at the fracture wall in order to deal with the flow distribution at the fracture intersection a simple adaptive material balance method is proposed in this paper which successfully solves the flow distribution at the intersection using advanced mathematical means the model is successfully solved in laplace space and then the pressure response solution in real space is obtained by stehfest numerical inversion method the obtained solutions are verified and compared with the numerical simulation results the calculation results show that the flow characteristics of the orthogonal fracture network can be roughly divided into six stages namely bi linear flow first linear flow first radial flow second linear flow second radial flow and boundary dominated flow however these flow characteristics will deviate or even be missing depending on the complexity of the fracture network finally the effects of some important parameters such as dimensionless fracture network conductivity main fracture length fracture network density reservoir area and eccentric position on pressure response and pressure field distribution are discussed in detail keywords pressure transient response fractured horizontal wells rectangular closed reservoir random distributed fracture networks semi analytical model 1 introduction the united states has set off a shale oil and gas revolution at the same time the outbreak of shale oil and gas revolution has changed the world energy pattern this revolution originated from the development of multi stage fracturing technology in horizontal wells which makes the natural fractures and hydraulic fractures in unconventional reservoirs communicate thus greatly improving the unconventional oil and gas production capacity warpinski et al 2008 wang et al 2018a since the great success of hydraulic fracturing some scholars have established models for hydraulic fracture pressure and production and then carried out a lot of simulation and analysis work gringarten and ramey 1973 cinco et al 1978 berumen et al 2000 tiab 2005 luo and tang 2015 wang et al 2018a wang et al 2018b as a pioneer in fracture simulation gringarten and ramey 1973 took the lead in solving the problem of unsteady flow in a single vertical fractured well in real time domain by using the method of green function a finite conductivity vertical fracture model was presented by cinco et al 1978 who coupled the matrix with the fracture to form the fredholm integral equation berumen et al 2000 proposed a numerical solution of a single asymmetric fracture under the condition of fixed rate and then studied the influence of asymmetric factor on the type curves tiab 2005 presented tds method to calculate the asymmetry factor luo and tang 2015 presented a fracture wing model and the non darcy effect in the fracture was considered into their model in terms of semi analytical models fredholm equation is a classical matrix fracture coupling equation which was firstly presented by cinco ley and meng 1988 some related models of multi stage fractured horizontal wells are also proposed to study the pressure responses wan and aziz 2002 and production optimization wei and economides 2005 brown et al 2009 in some tight formation escobar et al used the finite difference method to solve the coupling problem of matrix and fracture and the typical curve of multi branch fracture was proposed wan and aziz 2002 presented a semi analytical model for a horizontal well with multiple 3d fractures in a parallelepiped region wei and economides 2005 presented production index optimization model for a horizontal well with transvers fractures brown et al 2009 proposed a three dimensional flow model which is called trilinear flow model in their model the interference between fractures is ignored and the fractures are distributed equidistant whether it is a single fracture gringarten and ramey 1973 cinco et al 1978 berumen et al 2000 tiab 2005 or a horizontal well with multiple fractures wan and aziz 2002 wei and economides 2005 jia et al 2017 the common point is that the fracture is connected with the wellbore we call it the main fracture in a real reservoir fractures can be roughly divided into three types main fractures connected with wellbore secondary fractures connected with main fractures and discrete fractures in particular there are several modes of discrete fractures either connected with secondary fractures or directly connected with wellbore or connected with each other or isolated in fact according to the types of fractures they can be divided into natural fractures and artificial fractures and all the existing fractures can be classified into these two categories in the past the dual porosity model is often used to describe the flow behavior of natural fractures barenblatt et al 1960 warren and root 1963 boulton and streltsova 1977 dougherty and babu 1984 moench 1984 sen 1986 hamm and bidaux 1996 but in some shale reservoirs the scale of some secondary fractures induced by natural fractures or hydraulic fractures is also very large jourde et al 2002 fracture networks are often randomly distributed rather than cube lattices therefore the traditional double porosity model is challenged to describe such problems some scholars have focused their attention on arbitrarily distributed fractures huskey and crawford 1967 studied the effect of isolated vertical fractures on pressure distribution cinco ley et al 1976 developed type curves for a vertical well near a single infinite conductivity nature fracture and analyzed the effect of the angle of the natural fracture on pressure responses izadi and yildiz 2009 developed a semi analytical model for multiple vertical wells in discretely fractured porous media this is a very classical model considering the effect of conductivity however the model does not consider the cross flow between fractures which limits its application zeng et al 2012 developed a discrete fracture model considering the non darcy effect and analyzed the effect of non darcy number on the pressure response kuchuk and biryukov 2015 used discrete fracture model to analyze well test data of naturally fractured reservoir in detail luo et al 2018 presented a production optimization curves for a vertical well near a fracture semi analytical models have been proposed to simulate crossed fracture network chen et al 2016 wang et al 2018a wang et al 2021 or uncrossed fracture networks izadi and yildiz 2009 zeng et al 2012 kuchuk and biryukov 2015 and most of them only consider vertical wells in an infinite outer boundary condition izadi and yildiz 2009 zeng et al 2012 luo et al 2018 wang et al 2020 or a horizontal well intercepted by primary and secondary fracture networks chen et al 2016 wang et al 2018a wang et al 2018b but the unsteady model about the influence of rectangular boundary is seldom concerned in the late stage of flow the boundary will have a profound impact on the pressure response and productivity of multi stage fractured horizontal wells in addition the flow treatment of fracture intersection is an important problem the authors above put forward a method to judge the flow direction of intersection artificially however this method is ineffective for a large number of fracture simulation the objective of this paper is to establish a general framework to simulate the pressure response of horizontal wells intercepted by arbitrarily distributed fractures under rectangular closed boundary conditions a double node analysis method is proposed to describe the complex fracture network model and the adaptive material balance equation is used to solve the flow problem at the fracture intersection so that we do not need to consider the flow direction at the intersection the rectangular closed reservoir model and fracture model are established separately advanced mathematics is used to obtain the solution of laplace space such as laplace and fourier transformations the corresponding pressure field maps and type curves for a horizontal well with complex fracture networks were also generated to facilitate our interpretation into pressure response behavior in a rectangular closed reservoir the generalized framework model would provide the fundamental guidance for production performance analysis and optimization in the future 2 method 2 1 physical model fig 1 shows a schematic diagram from a simple fracture to a complex fracture network in a rectangular closed reservoir we can find that these main fractures are of equal length and perpendicular to the horizontal wellbore which is a general assumption chen et al 2016 put forward the hypothesis that the main fracture with orthogonal secondary fracture under the condition of infinite reservoir see fig 1b in fact in real reservoirs fractures are usually arbitrarily distributed which is more like fig 1c and fig 1d therefore in this paper we consider a more complex fracture network model some more detailed assumptions are as follows 1 first of all the whole reservoir flow is considered to be a pseudo three dimensional flow which looks like a two dimensional flow on the horizontal plane 2 the reservoir has constant thickness h constant porosity ϕ and constant permeability k 3 the reservoir contains a slightly compressible single phase fluid of constant compressibility ct and constant viscosity μ 4 as shown in fig 1d the fractures in reservoir include main fractures intersected fractures linked with main fractures and non intersected fractures not directly or indirectly linked with main fractures 5 a horizontal well is produced with constant flow rate q 6 the four outer boundaries of the reservoir are all closed 7 as shown in fig 2 the discrete fracture system contains nf fractures and each fracture has nfj segments with a full length lfj i fracture width wfj angle θj i with the x axis and the located position xofj i yofj i j 1 2 nf i 1 2 nfj 2 2 reservoir model according to the above physical model and based on the continuity equation and darcy s law the governing equations including intersecting and non intersecting fractures can be written as 1 1 x k μ p x y k μ p y f f t ϕ c t p t ω where 1 2 f f t j 1 n f i 1 n fj q fj i u j i t l fj i l fj i 1 2 h l fj i δ x x ofj i l fj i cos θ fj i u j i cos θ fj i δ y y ofj i l fj i sin θ fj i u j i sin θ fj i d u j i where δ is dirac delta function p is pressure in the reservoir pa k is the permeability of the reservoir m2 μ is viscosity pa s t is the time s nf is total fracture number nfj is total fracture segment number of the j th fracture h is reservoir thickness m x y is the coordinate of any point in the reservoir m qfj i is flow rate per unit of volume of the i th segment for the j th fracture m3s 1 the superscript m represents aquifer or matrix lfj i is the ith fracture segment half length for the j th fracture m ff t is fracture source sink term θfj i is the angle between the jth fracture and x axis xofj i yofj i is the coordinate of i th fracture segment starting point for the j th fracture m uj i is point source in the fracture segment m since the four boundaries of a rectangular reservoir are impermeable we can write out the outer boundary conditions 2 p x x 0 x e 0 p y y 0 y e 0 for convenience we used the dimensionless definition to make the above equation dimensionless as follows p d 2 π k h p i p b q r x d x l r y d y l r x ofdj i x ofj i l r y ofdj i y ofj i l r l fdj i l fj i l r t d kt ϕ μ c t l r 2 q fdj i q fj i q r x ed x e l r y ed y e l r where q r is the reference flow rate m3s 1 l r represents the reference length m by defining dimensionless formula we can rewrite the reservoir control equation and the eq 1 becomes 3 1 2 p d x d 2 2 p d y d 2 f fd t d p d t d ω 3 2 f fd t d j 1 n f i 1 n fj q fdj i u dj i t d l fdj i l fdj i π l fdj i δ x d x ofdj i l fdj i cos θ fdj i u dj i cos θ fdj i δ y d y ofdj i l fdj i sin θ fdj i u dj i sin θ fdj i d u dj i where p d is the dimensionless pressure td represents the dimensionless time qfdj i denote the dimensionless flow rate per unit of volume of the i th segment for the j th fracture l fdj i is the i th dimensionless fracture segment half length for the j th fracture x d y d is the dimensionless coordinate of any point in the reservoir x ofdn y ofdn is the dimensionless coordinate of i th fracture segment starting point for the j th fracture θfdj i is the dimensionless angle between the j th fracture and x axis for a rectangular closed boundary the outer boundary condition is written as 4 p d x d x d 0 x ed 0 p d y d y d 0 y ed 0 eqs 3 and 4 constitute the model of complex fracture network with multiple fracture segments in rectangular closed reservoirs which can be solved by laplace transform and finite cosine fourier transform appendix a of supplementary file lists the detailed derivation process therefore the derivation results for pressure can be written as follows 5 1 p d x d y d s π 2 x ed j 1 n f i 1 n fj q fdj i u dj i s l fdj i l fdj i cosh s y ed y d y pdj i l fdj i s sinh s y ed d u dj i π x ed m 1 cos u m x d j 1 n f i 1 n fj q fdj i u dj i s l fdj i l fdj i cos u m x pdj i cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed d u dj i where 5 2 x pdj i x ofdj i l fdj i cos θ fdj i u dj i cos θ fdj i y pdj i y ofdj i l fdj i sin θ fdj i u dj i sin θ fdj i 5 3 cosh s y ed y d y pdj i l fdj i s sinh s y ed cosh s y ed y d y pdj i l fdj i s sinh s y ed cosh s y ed y d y pdj i l fdj i s sinh s y ed 5 4 cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed cosh s u m 2 y ed y d y pdj i l fdj i s u m 2 sinh s u m 2 y ed 5 5 u m m π x ed m 0 1 2 3 where pd represents the dimensionless pressure in the real time domain p d is the dimensionless pressure variable of the laplace space td is the dimensionless time and s is the laplace space transform parameter eq 5 is the solution of multiple fracture segments in closed rectangular reservoir but in order to calculate efficiently the integral of eq 5 1 must be treated appendix b of supplementary file lists the treatment method by means of advanced mathematics and physics the dimensionless pressure for i th segment of the j th fracture with an arbitrary orientation angle in laplace domain is as follows 6 p dj i x dj i y dj i s π 2 x ed sin θ fdj i j 1 n f i 1 n fj q fdj i u dj i s f 1 d j i π x ed sin θ fdj i m 1 cos u m x dj i j 1 n f i 1 n fj q fdj i u dj i s f 2 d j i f 3 d j i i 1 2 3 n fj j 1 2 3 n f where 7 f 1 d j i 1 s l fdj i 2 sinh s y ed y dj i y wdj i l fdj i sin θ fdj i sinh s y ed y dj i y wdj i l fdj i sin θ fdj i sinh s y ed sinh ε 0 y ed y wdj i l fdj i sin θ fdj i y dj i sinh ε 0 y ed y wdj i l fdj i sin θ fdj i y dj i sinh s y ed 8 f 2 d j i 2 l fdj i m 1 s u m 2 s u m 2 u m 2 cot 2 θ fdj i 2 s u m 2 cos u m x wdj i y dj i y wdj i cot θ fdj i cos u m x dj i f 21 d j i cos s u m 2 x wdj i l fdj i cos θ fdj i cos s u m 2 x dj i f 22 d j i cos s u m 2 x wdj i l fdj i cos θ fdj i cos s u m 2 x dj i 9 f 21 d j i sinh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i sinh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 10 f 22 d j i sinh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i sinh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 11 f 3 d j i 2 l fdj i m 1 u m cot θ fdj i s u m 2 u m 2 cot 2 θ fdj i f 31 d j i sin u m x wdj i l fdj i cos θ fdj i cos u m x d f 32 d j i sin u m x wdj i l fdj i cos θ fdj i cos u m x d 12 f 31 d j i cosh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i cosh s u m 2 y ed y wdj i y dj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed 13 f 32 d j i cosh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i cosh s u m 2 y ed y dj i y wdj i l fdj i sin θ fdj i s u m 2 sinh s u m 2 y ed eqs 6 to 13 form the final solution for a rectangular closed reservoir in order to get the final solution it is necessary to couple the fracture flow model 2 3 fracture network flow model as shown in fig 3 the fracture element is divided by big nodes each big node is divided into four small nodes and each two small nodes together with the fractures between them constitute a double node fracture element the whole fracture network can be regarded as composed of many double node elements fig 3b in which the single node element is a special case of the double node element in the double node element the small nodes at both ends have fluid inflow or outflow and the single node element can be regarded as the dead node at the other end the overall compressibility of the fracture is very small therefore fluid flow in the fracture would be steady and the governing equation in the discrete fractures can be given as 14 x k fj μ p fj x fj y k fj μ p fj y fj 0 0 x fj l j w j 2 y fj w j 2 j 1 2 n f seen from the whole reservoir the fracture can be assumed to have zero width therefore we have the pressure and flux equations 15 s fn x fj w j 2 t p fn x fj w j 2 t p x 0 t and 16 k fj p fj y fj y fj w j 2 k p y y 0 k p y y 0 k fj p fj y fj y w j 2 taking the integral average of pressure across the fracture width in the y direction and combining eqs 15 and 16 eq 14 could be replaced by 17 x k fj p fj x fj 2 k w j p y y 0 0 on the fracture surface the flux condition can be given 18 2 h l fj k μ p y y 0 q fj l fj the flow rate condition of the left node of the fracture can be given by 19 w j h k fj μ p fj x fj x fj 0 q fwk the flow rate condition of the right node of the fracture can be given by 20 w j h k fj μ p fj x fj x fj l fj q f w k 1 where kfj is the permeability in the j th fracture m2 wj is the j th fracture width m pfj is the pressure in the j th fracture pa qfwk is the k th node flow rate in the j th fracture m3 s equations 17 to 20 form the discrete fracture pressure equations now we can use the following dimensionless definitions to make the above equation dimensionless c fdj k fj w j k l r p fdj 2 π k h p i p fj q r q fdwk q fwk q r q f d w k 1 q f w k 1 q r where cfdj is the j th dimensionless fracture conductivity dimensionless pfdj is the dimensionless drawdown in the j th fracture qfdwk is the k th node dimensionless flow rate in the j th fracture through the dimensionless definitions eq 17 can become 21 2 p fdj x fdj 2 2 c fdj p y d y d 0 0 eq 18 becomes 22 p d y d y d 0 π q fdj eq 19 becomes 23 p fdj x fdj x fdj 0 q fdwk 2 π c fdj eq 14 becomes 24 p fdj x fdj x l fdj q f d w k 1 2 π c fdj eqs 21 to 24 constitute a system of dimensionless pressure equations of the fracture network flow by using the double integral method abramowitz and stegun 1965 wang et al 2021 its solution in laplace space can be solved 25 p fdwk s p fdj x d 2 π c fdj x fdj q fdwk 2 π c fdj 0 x d 0 v q fdj u d u d v further we discretize the above equation and if the fracture is divided into nfn segments for i th segment of the j th fracture eq 19 would have the following transformation 26 p fdj i x fdj i p fdwk s 2 π c fdj x fdj i q fdwk 2 π c fdj ε 1 i 1 q fdj ε s δ x j 2 2 δ x j x di ε δ x j δ x n 2 8 q fdj i s i 1 2 3 n fj j 1 2 3 n f where xfdj i is the middle point for the i th segment of the j th fracture 2 4 the semi analytical solution by coupling reservoir model and fracture network flow model in order to obtain the final semi analytical solution the reservoir model should be coupled with the fracture network model there are nf fractures in the whole reservoir and each double node fracture has nfj segments so the number of total segments is 27 n t o t a l s e g m e n t j 1 n f n fj where ntotal segment is total number of fracture segments which are total number of the fracture surface flux fracture node number is nnode k 1 2 3 the k th node has nk branches as shown in fig 3 each node has nk unknown flow rate q fdwk m m 1 2 3 n k finally the number of total unknown flow rate in the all nodes can be obtained 28 n t o t a l r a t e k 1 n node n k where ntotal rate is the total number of unknown flow rate in the fracture node each node has one unknown pressure pfdwk and the total number of unknown pressure is nnode therefore total number of unknowns is ntotal segment ntotal rate nnode according to the continuity condition that the reservoir pressure pdj i for eq 6 continuous to the fracture pressure pfd for eq 26 on the surface of fracture a system of equations can be obtained 29 p dj i p p fdj i x fdj i j 1 2 n f i 1 2 n fj eq 29 shows a system of ntotal segment equations if there is no well outflow at the node the total flow of the node is equal to zero and if there is a well at a certain node the sum of total flow rate should be equal to well flow rate the piecewise equation is expressed as follows 30 m 1 n k q fdwk m 0 n o w e l l a t t h e n o d e q fdwk well w e l l a t t h e n o d e k 1 2 n node eq 30 has a system of nnode equations in addition the k th node has nk branches and nk sub flow rate shown in fig 3b and the relationship between flow rate for each small node and flux of branch fracture segment can be given by 31 q fdwk m i 1 n fj q fdji l fdj n fj k 1 2 n node m 1 2 n k eq 31 has a system of ntotal rate equations now we have ntotal segment ntotal rate nnode equations if some branch with double node appeared the relationship in eq 31 will be rewritten as 32 q fdwk m q f d w k 1 m i 1 n fj q fdji l fdj n fj k 1 2 n node m 1 2 n k the above equation shows that the k th node and the k 1 th node have the same flow relation equation in eq 32 we have two nodes but we write only one equation so here we need to add an auxiliary equation as follows 33 p fdwk p f d w k 1 2 π c fdj l fdj q fdwk 2 π c fdj i 1 n fj q fdji p δ x j 2 δ x j l fdj i δ x j equations 29 to 33 constitute a linear equation system in laplace space which can be solved by gaussian elimination method then the derived solution is brought into equation 6 and then wellbore pressure in laplace space can be obtained the final wellbore drawdown in real time domain can be obtained by stehfest 1970 numerical inversion 3 model validation and flow characteristics the proposed model is a general model which can calculate the pressure response of complex fracture network alternatively the existing numerical simulators can simulate some simple cracks extending along the direction of the network here we choose two cases to verify our model one case is the horizontal well with multiple parallel main fractures another case is that there are some secondary parallel fractures on the main fracture in this case the main fracture and the secondary fracture must be orthogonal 3 1 comparison with numerical simulation for a horizontal well with three parallel main fractures a numerical simulator is used to verify a simple model fracture number nf is set to 3 the dimensionless conductivity for every fracture is set to 100 the dimensionless fracture length lfdj is set to 2 the dimensionless reservoir length xed and width yed is set 70 and 70 respectively the dimensionless fracture spacing is 8 fig 4 shows the validation of the presented model for a horizontal well with 3 equally spaced parallel and high conductivity fractures in rectangular closed reservoir unstructured grids are used for numerical simulation as shown in the figure on the left of fig 6 and the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively from the pressure and pressure derivative curves it can be seen that the data from the numerical simulation fit well with the data from the semi analytical model however in the early numerical simulation due to the numerical dispersion phenomenon there are some errors compared with the semi analytical solution 3 2 comparison with numerical simulation for a horizontal well with 3 equally spaced parallel and low conductivity fractures with 12 secondary fractures in rectangular closed reservoir fig 5 shows the validation of the presented model for a horizontal well with 3 equally spaced parallel and low conductivity fractures with 12 secondary fractures in rectangular closed reservoir the number of main fractures is 3 the number of secondary fractures is 12 the length of main fractures is 2 and the length of secondary fractures is also 2 conductivity value of all fractures is 10 unstructured grids are used for numerical simulation as shown in the figure on the right of fig 6 and the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively it is obviously seen from the figure that there is an excellent match throughout the entire time period except tiny time scope due to numerical dispersion phenomenon 3 3 comparison with numerical simulation for a horizontal well with 3 arbitrarily distributed main fractures with 12 arbitrarily distributed secondary fractures in rectangular closed reservoir in rectangular closed reservoir fig 7 shows the validation of the presented model for a horizontal well with 3 arbitrarily distributed main fractures with 12 arbitrarily distributed secondary fractures in rectangular closed reservoir conductivity value of all fractures is 10 the basic data for numerical simulation is shown in table 1 the blue long solid line and the blue circle represent the dimensionless pressure calculated by our model and the dimensionless pressure calculated by numerical simulation respectively the red long dotted line and the red square box represent the pressure derivative calculated by our model and the pressure derivative calculated by numerical simulation respectively it is obviously seen from the figure that there is an excellent match throughout the entire time period 3 4 flow characteristics analysis as shown in fig 5 pressure and pressure derivative can reflect the flow characteristics of fluid in the reservoir fig 8 shows the pressure field corresponding to different flow stages it can be seen from the pressure derivative curve in fig 5 that the flow can be roughly divided into six stages the first stage is bilinear flow which shows a straight line with a slope of 1 4 on the pressure derivative curve occurs before the dimensionless time is less than 0 01 as shown in fig 8a in this stage the linear flow in the reservoir and the linear flow in the fracture occur simultaneously the second stage is the linear flow stage and the pressure derivative curve shows a straight line with a slope of 1 2 occurring between 0 01 and 1 of the dimensionless time as shown in fig 8b at this extreme the linear flow of the main fracture and the secondary fracture is dominant the third stage is the first radial flow stage in which the pressure derivative curve shows a constant straight line occurs between the dimensionless time 1 7 as shown in fig 8c the radial flow will concentrate near the unit composed of each main fracture and secondary fractures the fourth stage is the second linear flow stage in which the pressure derivative curve reflects the 1 2 slope straight line segment occurring between 8 and 100 of the dimensionless time as shown in fig 8d in this stage all the main fractures and secondary fractures form a whole and linear flow occurs outside the whole the fifth stage is the second radial flow stage in this stage the derivative curve represents a 1 2 constant straight line segment occurs in dimensionless time greater than 100 and less than 300 as shown in fig 8e all the sources and sinks form a whole and radial flow occurs around this whole the sixth stage is the boundary dominated flow stage and the derivative curve shows a straight line segment of unit slope which occurs when the dimensionless time is greater than 300 as shown in fig 8f when the pressure wave propagates to the boundary all the pressure in the reservoir begins to drop in this stage the pressure drop rate will be a constant also known as the quasi steady flow stage 4 results and discussion here we discuss a more general case which is the case of a multi stage fractured horizontal well in a complex fracture network the distribution of these fractures is shown in fig 9 in the figure the red solid line represents the main fractures and the green solid line represents the intersected fractures they are secondary fractures formed by fracturing and they may also be connected by the later transformation of natural fractures the blue solid line represents non intersected fractures which are not connected with the main fracture as shown in fig 9 the number of main fractures is 3 with 21 intersected fractures and the number of non intersected fractures is 20 the initial dimensionless main fracture spacing is 5 the main fracture length is 4 and the main fractures are all parallel to the y axis the dimensionless reservoir length xed and width yed is set 50 and 50 respectively 4 1 compared with a horizontal well with only three simple fractures in this part we compare the simulation results of complex fracture network with a simple case of a horizontal well with three simple fractures here the dimensionless conductivity of all fractures is set to 20 the comparison results are shown in fig 10 from the dimensionless pressure curve in the figure it can be seen that the pressure loss of complex fracture system is less than that of simple fracture suggesting that horizontal wells produce the same output and only small pressure drop is required in complex fracture system the red dotted line in the figure represents the derivative curve of simple fracture it can be seen that the flow can be roughly divided into six stages the first radial flow time is very short and not very obvious because the fracture spacing is short and the fracture length is long for complex fracture networks bilinear flow and linear flow time become very long however the first radial flow regime disappeared completely which may be the result of the interference of intersected and non intersected fractures between the main fractures in the second radial flow and boundary dominated flow stage the derivative curves for the two different fracture distributions completely coincide because the discrete fractures are only distributed near the main fractures and the distant non intersected fractures have little influence on the flow state the above analysis results can be reflected more clearly through the pressure field as can be seen from fig 11 a when the dimensionless time is 0 01 the change of pressure field mainly occurs near the fracture which is the period of bi linear flow during this period the fluid on the fracture and vertical fracture wall flows at the same time the biggest pressure loss is in the main fracture and intersected fracture at this time the pressure drop near the non intersected fracture is small when the dimensionless time is 0 1 this stage is dominated by vertical fracture linear flow as shown in fig 11b at this stage the linear flow near the fracture is the main one and at this time there is also pressure loss near the non intersected fracture fig 11c shows the pressure field distribution when the dimensionless time is equal to 1 at this time point the first radial flow occurs however due to the complexity of fracture morphology the equipotential line around the main fracture shows an irregular shape as can be seen from fig 11d the second linear flow will occur around these fracture networks over time at this time all fractures can be regarded as a whole 4 2 effect of dimensionless fracture conductivity on pressure response fig 12 shows the influence of the dimensionless fracture network conductivity on the typical curve the dimensionless fracture network conductivity is set to 5 20 50 and 300 respectively the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative we use square circle and triangle to distinguish the results of different values it can be seen from the dimensionless pressure curve that the smaller the dimensionless conductivity the higher the dimensionless pressure which means that a small dimensionless conductivity will produce a large pressure loss with the extension of time the pressure loss decreases gradually when entering the boundary dominated flow stage the dimensionless pressure curves almost coincide suggesting that the pressure loss under different dimensionless conductivity is close to the same fig 13 shows the distribution characteristics of pressure field under different dimensionless fracture network conductivity at the td 0 1 it can be seen from the figure that when the dimensionless fracture conductivity is small the pressure change is mainly concentrated near the intersected fracture near the well and the diffusion speed of pressure wave is slow as the dimensionless fracture conductivity gradually increases we can see that the pressure can spread to the distal fracture therefore the smaller the dimensionless fracture conductivity the greater the pressure loss near the wellbore under the same production 4 3 effect of main fracture length on pressure response fig 14 shows the influence of the main fracture length on the type curve the main fracture length is set to 4 3 2 and 1 respectively the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative it can be seen from the dimensionless pressure curve that the shorter the fracture the greater the dimensionless pressure which also implies that the shorter main fracture will lead to large pressure loss this can be seen from the pressure field diagram shown in fig 15 when the main fracture is short the number of fractures intersecting the main fracture becomes less which leads to a large pressure loss it can be seen from the derivative curve that the length of the main fracture mainly affects the flow behavior in the early and middle stages the long main fracture will make the bi linear flow period longer when the main fracture is short we can see that the first radial flow stage appears when the dimensionless time is greater than 1 the derivative curves under different main fracture lengths coincide suggesting that the late flow behavior is not affected by the length of main fractures fig 15 shows the distribution characteristics of pressure field under different main fracture length at the td 0 1 it can be known from the figure that when the dimensionless fracture conductivity is small the pressure change is mainly concentrated near the intersected fracture near the well and the diffusion speed of pressure wave is slow as the dimensionless fracture conductivity gradually increases we can see that the pressure can spread to the distal fracture therefore the smaller the dimensionless fracture conductivity the greater the pressure loss near the wellbore under the same production it can be seen from fig 15a to fig 15d that the propagation speed of pressure wave gradually slows down with the change of the length of the main fracture this is because when the main fracture is short fewer fractures are connected with the main fracture in the early stage the change of pressure field is mainly reflected near the main fracture it can be seen from this figure that fig 15a has officially reached the bilinear flow stage but fig 15d has reached the linear flow stage 4 4 effect of main fracture density on pressure response fig 16 shows the influence of the main fracture density on the type curve the main fracture number is set to 3 and 5 the solid line in the figure represents the dimensionless pressure and the dotted line represents the dimensionless pressure derivative the more the number of fractures is the greater the density of main fractures is it can be seen from the dimensionless pressure derivative curve that the smaller the main fracture density is the greater the dimensionless pressure is which implies that a low main fracture density will lead to a large pressure loss it can be seen from the derivative curve that the main fracture density mainly affects the derivative curve shape in the early and middle stages the influence on flow characteristics mainly occurs in the linear flow stage and the curve completely deviates from the 1 2 slope straight line fig 17 shows the distribution characteristics of pressure field under different main fracture density at the same dimensionless time td 0 1 the fracture spacing is 5 for the case with 3 main fractures and 2 5 for the case with 5 main fractures it can be seen from the figure that the more the number of fractures the greater the main fracture density and the higher or more intense the fracture interference we can also clearly see that with the increase of the number of main fractures the dimensionless fracture conductivity increases and the pressure loss is also relatively low in the process of oilfield development the density of main fractures will be a very important factor affecting production 4 5 effect of discharge area and eccentric position on pressure response fig 18 a shows the effect of discharge area on a typical curve we select three groups of different areas 50 50 40 40 and 30 30 respectively from the dimensionless pressure curve it can be seen that when the dimensionless time is less than 100 all curves coincide which implies that the discharge area has no effect on the early and medium term flow of complex fracture network when the dimensionless time is greater than 100 the smaller the discharge area is the larger the dimensionless pressure value is suggesting that a small discharge area will lead to a large pressure loss it can be seen from the derivative curve that the smaller the discharge area the earlier the quasi steady state flow time which will greatly shorten the radial flow time fig 18b shows the effect of eccentric position on a typical curve the drainage area of the reservoir is 30 50 we have selected three cases the first case is that the midpoint coordinate of the central main fracture is 0 0 the second case is that the midpoint coordinate of the central main fracture is 5 5 and the third case is that the midpoint coordinate of the central main fracture is 10 10 it can be seen from the dimensionless pressure curve that when the dimensionless time is greater than 5 the dimensionless pressure curve begins to be affected by the eccentric position case 3 is that the position of the fracture networks is closer to the boundary it can be seen that the closer the fracture network is to the boundary the greater the dimensionless pressure loss in addition the derivative curve shows that the eccentric position has a significant impact as the fracture network gets closer to the boundary the radial flow gradually disappears and the quasi steady state flow time is shortened in rectangular closed reservoir boundary effect will play an important role in the middle and late stage 5 potential applications and limitations in this paper we propose a complex fracture network flow simulation model this model is a complete forward problem the reservoir parameters fluid parameters and fracture parameters in the proposed model are known we can obtain the dynamic characteristics of the well such as pressure and flow however in real reservoirs some physical parameters are often unknown such as fracture half length fracture permeability reservoir permeability and so on these physical parameters need to be obtained by inversion combined with some geological information this will be the study of the inverse problem if we monitor the parameters such as pressure and flow we can carry out historical fitting through the proposed model and constantly correct the unknown physical parameter values until the theoretical calculated values are in the best agreement with the observed values patzek et al 2013 this will be the study of the inverse problem in the process of inverse problem research uncertainty is greatly strengthened therefore if we want to obtain more reliable results we need to combine more fracturing construction and geological information especially in the process of fracture parameter inversion of shale reservoir if more micro seismic monitoring results can be combined the fracture parameter interpretation will be more convincing the semi analytical model proposed in this paper only needs the discretization of fractures and the reservoir does not need the meshing so the amount of calculation is greatly saved however there are still some application limitations at present we consider that the fracture is only 2d case the orientation on the plane can change randomly and the fracture and fracture can cross randomly or not this can be seen from the governing equation of reservoir in future research we can continue to study 3d fractures by using the methods provided in this paper in 3d space fractures have parameters such as length width height azimuth and inclination however it is not easy to obtain the 3d solution in which case the analytical solution will be very complex how to deal with the results in such a complex situation i hope to do more discussion in the future 6 conclusions the conclusions are made as follows 1 a new semi analytical model of multi fractured horizontal wells with random distributed fracture networks in rectangular closed reservoirs was established and solved by using a double node method 2 the proposed model is verified by two sets of numerical simulation models one is the horizontal well with several parallel fractures the other is the horizontal well with several main fractures and secondary fractures because the numerical simulator adopts orthogonal grid the fractures extend along the grid direction the good fitting results show the reliability of our model 3 the results show that for regular fracture networks e g orthogonal fracture networks the flow characteristics can be roughly divided into six stages bi linear flow first linear flow first radial flow second linear flow second radial flow and boundary dominated flow the time that these flow characteristics may appear will be prolonged shortened or even disappear which is determined by the complexity of fracture network 4 the pressure dynamic characteristics of complex fracture network in rectangular closed reservoir are discussed in detail the main factors affecting the pressure dynamic characteristics of complex fracture network include the dimensionless conductivity of fracture network the length of main fractures fracture density reservoir discharge area and the eccentric position of fracture network declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china no 51774256 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127547 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3597,a new solution for advective dispersive solute transport is developed for three dimensional aquifer of finite thickness and width infinite extent along the direction of flow dual porosity equilibrium linear sorption and first order decay of both the sorbed and dissolved mass with coefficients that may differ in the mobile and immobile domains and with initial concentration distribution or with source represented by a volumetric mass generation term of arbitrary time dependence the analytical laplace domain solution is numericaly inverted into the time domain the model is benchmarked against mt3dms and simpler analytical models the model is sensitive to transport parameters describing the dual domain suggesting it may be used for evaluating tracer tests the model is suitable for checking accuracy of numerical models and identifying ranges of key transport parameters keywords analytical solute transport dual porosity finite thickness aquifer nomenclature a x a y a z dispersivity in the principal directions l b aquifer thickness l c x y z t concentration m l3 d m molecular diffusion coefficient in water l2 t d x d y d z dispersion coefficients in principal directions l2 t d x d m q θ m a x etc f mass fraction of sorbent in contact with mobile dissolved mass k distribution coefficient l3 m m and i subscripts for mobile and immobile regions respectively indices are omitted in relations that apply to both regions q darcy flux l t w aquifer width l α transfer coefficient for mass exchange between mobile and immobile domains t 1 ϕ proportion of mobile porosity λ first order decay coefficient t 1 ρ dry bulk density of soil m l3 θ water content porosity for fully saturated soil θ m ϕ θ mobile porosity θ i 1 ϕ θ immobile porosity 1 introduction analytical solute transport models have an important role in guiding the selection of transport parameters and providing a check on accuracy for more detailed and complex numerical solute transport models analytical models can only represent rather simplified problem geometry and uniform flowfield but their input is simple and their accuracy is not affected by spatial and temporal discretization and numerical dispersion an analytical model for solute transport with a volumetric source term in a three dimensional dual porosity aquifer of finite thickness with first order reactions for dissolved and sorbed mass is not available the new solution presented below accounts for dual porosity sorption coefficients that differ in the mobile and immobile domains decay coefficients that differ for the sorbed and dissolved mass and in the mobile and immobile domains and a point or volumetric source term of arbitrary time dependence the following literature review is focused on models for three dimensional transport time domain solutions for advective dispersive transport of a single species in a three dimensional aquifer of single porosity and finite thickness with sorption and decay and with a specified concentration patch source are available in integral form wexler 1992 neville 1994 batu 1996 wang and wu 2009 liao et al 2021 derived a time domain solution for chain decaying species in a single porosity aquifer with a patch source perina 2021 developed an analytical laplace domain solution for transport of chain decaying species with a patch source of arbitrary time dependency in an aquifer of dual porosity and finite thickness the patch source is convenient because it can represent either a first or third type boundary condition and is applicable to many field scenarios solutions for solute transport from point or volumetric sources in a three dimensional aquifer of single porosity include the leij et al 1991 model for an infinite domain with various source geometries wexler 1992 solution for a point source in a finite or infinite domain boupha et al 2004 solution for a transient point source in a semi infinite domain neville 2006 solutions for point and volumetric sources in an infinite domain paladino et al 2018 solution for a finite thickness domain with various source geometries and wang and wu 2009 solution for a finite or infinite domain with a volumetric mass generation source leij et al 1993 derived a solution for an infinite domain of dual porosity with a patch source or with volumetric initial concentration distribution in the dual porosity model advection occurs in the fraction of the porosity that is mobile while groundwater present in the immobile porosity is stagnant the diffusion controlled mass exchange between the mobile and immobile porosity leads to tailing of plumes molz 2014 in the dispersion coefficient for the dual domain conceptual model the dispersivity may be minimized or set to zero because mechanical dispersion is represented by the mass transfer between the mobile and immobile porosity domains when this mass transfer rate is high the dual domain model behaves like a single domain model whose porosity approaches the total porosity of the porous medium on the other hand as the mass transfer rate approaches zero the dual domain model becomes equivalent to a single domain model with total porosity approaching the mobile porosity zheng and wang 1999 the first order rate coefficient for mass transfer between the mobile and immobile domains is difficult to quantify haggerty and gorelick 1995 and becomes a fitting parameter in practice neville et al 2000 only a limited number of analytical transport models account for dual porosity including one dimensional problems van genuchten and wagenet 1989 toride et al 1993 haggerty and gorelick 1995 neville et al 2000 three dimensional aquifer with rate limited sorption stauffer and hatfield 1992 three dimensional aquifer of infinite thickness with various source geometries leij et al 1993 leij and toride 1997 and chain decaying species in a three dimensional aquifer with a patch source perina 2021 mechanical dispersion is traditionally treated as a fickian term added to molecular diffusion e g bear 1972 zheng and bennett 1995 although this concept has been shown to be approximate zheng et al 2011 molz 2014 it is convenient for deriving an analytical solution a new solution for advective dispersive solute transport is developed for the following conditions the aquifer has finite thickness finite width infinite extent along the direction of flow and dual porosity the model domain represents a single aquifer layer with no solute mass exchange at the top and bottom and at the lateral boundaries parallel to groundwater flow direction the initial condition is zero concentration except for a special case coefficients for equilibrium linear sorption may differ for the mobile and immobile domains coefficients for first order decay may differ for the sorbed and dissolved mass and also in the mobile and immobile domains the source is defined by a mass generation term with arbitrary time dependence located at a point or uniformly distributed over a rectangular prism as a special case the source term may be replaced with initial concentration the bottom boundary may represent impermeable aquifer bottom and the top boundary may represent the water table or confining layer the lateral boundaries may represent impermeable aquifer boundaries or they may be extended so that they do not affect the simulated plume the volumetric mass generation term may represent for example the injection of a tracer mass release from a contaminated zone or mass generation in a reactive barrier because the transport problem is linear more complex configuration of sources may be represented by superposition a hypothetical transport problem may include superposition of sources and initial concentrations the chosen geometry a rectangular prism is a convenient building block for representing more complicated distribution of initial concentrations or sources the transport problem is solved analytically in the laplace domain and numerically inverted into the time domain the new model is benchmarked against widely used analytical and numerical solute transport models 2 mathematical model this section presents the governing equations boundary and initial conditions solution method special cases and numerical evaluation 2 1 governing equations the governing equations for solute concentrations c m x y z t and c i x y z t in the mobile and immobile regions respectively are modified from neville et al 2000 by extending to three dimensions and using linear instead of non equilibrium sorption the governing equation is 1 θ m f ρ k m t c m θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m t δ x x 0 δ y y 0 δ z z 0 for the mobile region and 2 θ i 1 f ρ k i t c i θ i λ i 1 f ρ λ si k i c i α c m c i for the immobile region the point source m t δ x x 0 δ y y 0 δ z z 0 where m is the time dependent mass generation rate per unit volume at point x 0 y 0 z 0 will be integrated over the volume of the source zone the remaining symbols are explained in nomenclature 2 2 initial and boundary conditions in the following subscripts m and i are omitted because the conditions apply to both domains the initial condition is zero concentration over the entire domain 3 c x y z 0 0 an alternate initial condition with uniform initial concentration within a rectangular prism will be considered as a special case no solute transport occurs across the lateral and vertical boundaries 4 y c x 0 z t 0 5 y c x w z t 0 6 z c x y 0 t 0 7 z c x y b t 0 the domain is infinite along the direction of flow x axis 8 c x y z t 0 2 3 solution the solution is obtained by applying the laplace transform in time t followed by the change of dependent variable to remove the advection term complex fourier transform in x and finite fourier cosine transforms in y and z e g churchill 1972 a point source solution is derived first then integrated over the volume of a rectangular prism perpendicular to the direction of flow 2 3 1 laplace transform taking the laplace transform in time t p of 1 and 2 while making use of the operational property t c p c c 0 results in 9 θ m f ρ k m p θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m δ x x 0 δ y y 0 δ z z 0 10 c i β c m 11a β α θ i 1 f ρ k i p θ i λ i 1 f ρ λ si k i α substitution for c i reduces the system to one governing equation 12 φ c m θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m δ x x 0 δ y y 0 δ z z 0 13 φ θ m f ρ k m p θ m λ m f ρ λ sm k m α 1 β 2 3 2 change of dependent variable variable substitution to remove the advective term is convenient to facilitate using the fourier transform in x following the approach of marino 1974 and wexler 1992 who used similar transformations in the time domain the substitution 14 c m g exp q 2 θ m d x x removes the term q x c m and adds the term q 2 4 θ m d x g to 12 after cancelling the exponential terms the governing equation becomes 15 ψ g θ m d x 2 x 2 g θ m d y 2 y 2 g θ m d z 2 z 2 g m exp q 2 θ m d x x δ x x 0 δ y y 0 δ z z 0 16 ψ φ q 2 4 θ m d x 2 3 3 fourier transforms applying the complex fourier transform in x to 15 followed by finite fourier cosine transforms in y and z g p x y z g p ξ ϖ n η k and making use of their operational properties f 2 g x 2 1 2 π g x e i ξ x i ξ 2 g and f cos 2 g y 2 1 n g y y w g y y 0 ϖ n 2 g leads to 17 ψ ξ 2 θ m d x ϖ n 2 θ m d y η k 2 θ m d z g m exp qx 0 2 θ m d x i ξ x 0 cos ϖ n y 0 cos η k z 0 18 ϖ n n π w 19 η k k π b the changed variable transform solution for a point source is 20 g m exp qx 0 2 θ m d x i ξ x 0 cos ϖ n y 0 cos η k z 0 ψ ξ 2 θ m d x ϖ n 2 θ m d y η k 2 θ m d z 2 3 4 inverse fourier transforms and change to the original variable the inverse fourier transform in x utilizes the transform pairs phillips and parr 1995 21 f x x 0 e ix 0 ξ f ξ and 22 e a x 2 a a 2 ξ 2 to get 23 g m exp cx 0 a x x 0 2 θ m d x cos ϖ n y 0 cos η k z 0 a where 24 a ψ ϖ n 2 θ m d y η k 2 θ m d z θ m d x 25 c q 2 θ m d x applying the double inverse finite fourier cosine transform with the inverse transform in y defined as c 1 w c 0 2 w n 1 c n cos ϖ n y to 23 and changing back to the original dependent variable provides the laplace domain solution for a point source 26 c m m φ exp cx where 27 φ 1 bw y 0 0 2 bw n 1 y n 0 cos ϖ n y 2 b k 1 1 w y 0 k 2 w n 1 y n k cos ϖ n y cos η k z 28 y n k exp cx 0 a x x 0 cos ϖ n y 0 cos η k z 0 2 θ m d x a 2 3 5 laplace domain solution for rectangular prism the solution of the form 29 c m m φ xyz exp cx where m is the mass generation rate per unit volume of the aquifer is obtained by integrating 26 with respect to x 0 y 0 and z 0 over the volume of a rectangular prism defined by x 1 x 0 x 2 y 1 y 0 y 2 z 1 z 0 z 2 the integration along x is shown in appendix the term φ xyz is 30 φ xyz 1 bw θ 0 0 2 bw n 1 θ n 0 cos ϖ n y 2 b k 1 1 w θ 0 k 2 w n 1 θ n k cos ϖ n y cos η k z 31 θ n k x 2 θ m d x a sin ϖ n y 2 sin ϖ n y 1 ϖ n sin η k z 2 sin η k z 1 η k 32 x exp ax a c exp a c x 2 exp a c x 1 if x x 2 exp ax a c exp a c x 2 exp a c x 1 if x x 1 exp ax a c exp a c x exp a c x 1 exp ax a c exp a c x 2 exp a c x otherwise the terms with n 0 and k 0 are obtained as limits for example θ 0 0 is 33 θ 0 0 x 0 0 2 θ m d x a 0 0 y 2 y 1 z 2 z 1 the solution for c i is given by 10 2 4 special cases several special cases are considered 2 4 1 single porosity aquifer by setting ϕ 1 and f 1 the solution represents a single porosity aquifer coefficients for the immobile domain have no effect 2 4 2 one dimensional model as the source is stretched across the entire domain in the y and z directions for y 1 0 y 2 w z 1 0 and z 2 b 30 reduces to the first term where according to 33 the factor bw cancels out to get 34 φ x x 0 0 2 θ m d x a 0 0 and the solution represents one dimensional transport 2 4 3 steady state as t a steady state solution is derived as lim p 0 p c then all terms multiplied by p become zero and 29 with m replaced by a constant represents a steady state solution 2 4 4 initial concentration specifying m in 29 to be an instantaneous pulse the model represents an initial mass distribution such as after injection for some applications it is more convenient to consider a special case with initial concentration distribution and no source so that the initial concentration in the mobile domain c m 0 may differ from the initial concentration in the immobile region c i 0 for example the situation when c m 0 0 and c i 0 0 may represent the conditions after injection of a tracer while c i 0 c m 0 may represent the conditions after a pump and treat system flushed the mass in the mobile domain sorption equilibrium is assumed in each porosity domain let the rectangular volume x 1 x 0 x 2 y 1 y 0 y 2 z 1 z 0 z 2 contain a uniform initial concentration distribution and let the initial concentrations outside this region be zero first assume an initial concentration same form for c m and c i at a point 35 c x y z 0 c 0 h where 36 h δ x x 0 δ y y 0 δ z z 0 dx 0 dy 0 dz 0 that will later be integrated over the rectangular prism removing the source term from 1 and taking the laplace transform in time of 1 and 2 while utilizing the transform property t c p c c 0 the equations become 37 θ m f ρ k m p θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m c m 0 θ m f ρ k m h and 38 c i β c m β α c i 0 θ i 1 f ρ k i h substituting from 38 in 37 leads to 39 φ c m θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m c m 0 θ m f ρ k m h β c i 0 θ i 1 f ρ k i h the only difference between eqs 39 and 12 is that the source term containing m is replaced with the terms containing c m 0 and c i 0 making the substitution 40 c m 0 θ m f ρ k m β c i 0 θ i 1 f ρ k i m in 29 provides the solution for 39 eq 38 for a point initial concentration must still be integrated over the volume of the prism to obtain c i for the volumetric initial concentration the first term on the right hand side of 38 integrated over the prism is 29 multiplied by β the second term is integrated β α c i 0 θ i 1 f ρ k i x 1 x 2 δ x x 0 dx 0 y 1 y 2 δ y y 0 dy 0 z 1 z 2 δ z z 0 dz 0 to get 41 c i β c m β α c i 0 θ i 1 f ρ k i ϝ where 42 ϝ u x x 1 u x x 2 u y y 1 u y y 2 u z z 1 u z z 2 and u x is the unit step function 2 5 source term the source term m t allows arbitrary time dependent mass generation term perina 2021 presented several forms of time dependence that allow flexible representation of the source history including instantaneous pulse constant concentration or if the source is defined by a series of discrete data pairs t k and m k it can be represented by step wise changes or piece wise linear approximation 2 6 numerical evaluation the sine and cosine terms in the inverse fourier cosine transforms result in oscillating series that can be efficiently terminated to a desired tolerance after an appropriate number of terms determined by re writing the summation terms through trigonometric identities to determine the lowest frequency components perina 2021 the de hoog et al 1982 numerical laplace transform algorithm is used in this work because it can handle the arbitrary time dependence of the source term and has been shown to be accurate for solute transport e g moench 1991 boupha et al 2004 2 7 remarks the problem defined by 1 to 8 may be solved in the time domain using fourier transforms in x y and z however for a continuous source this approach leads to a convolution integral that has to be evaluated numerically the solution would be classified as semi analytical in comparison the laplace domain solution requires that 29 be only evaluated once for each summation term of the inverse laplace transform while still accommodating an arbitrary time dependence of the source term thus in terms of computational effort the time domain solution would not offer clear advantages over the laplace domain solution 3 benchmark simulations benchmark comparison with time domain analytical models neville 2006 is shown in fig 1 for an instantaneous point source and instantaneous and continuous volumetric rectangular prism source observations are at different locations for each case the neville 2006 analytical models are for an aquifer of infinite extent in all three dimensions therefore the model domain was extended and the source placed in the middle so that the effects of boundaries would be negligible during the simulation time the results for each test case are identical because the neville 2006 analytical models are time domain solutions this comparison serves as a check on the accuracy of both the new model and the suitability of the laplace transform inversion algorithm de hoog et al 1982 for this problem the input parameters are shown in the supplementary information in tables s1 s2 and s3 the new model is next compared to a numerical model prepared with mt3dms zheng and wang 1999 the model domain is 250 m along flow direction 145 m wide and 5 m high horizontal grid spacing is 1 m and vertical 0 5 m the simulation represents an initial concentration distribution within a rectangular block inside the model domain at 50 x 75 60 y 85 3 5 z 5 and no additional sources longitudinal transverse horizontal and transverse vertical dispersivity values are 2 5 m 0 25 m and 0 025 m the darcy flux is 3 5 m y ϕ 0 5 α 0 05 y 1 θ 0 35 ρ 1 7225 g cm3 and k m k i 0 1 cm3 g courant number is 1 and peclet number is 0 4 zheng and wang 1999 observation points are placed at cell centers along y 72 5 m at z 4 25 and x 99 5 149 5 200 5 and at z 2 25 m and x 100 5 150 5 199 5 m for the analytical model the x distances are reduced by 0 5 m 1 2 cell size to match the distance between the observations and the block of initial concentrations in mt3dms the model is a replication of neville 2004 model with more refined horizontal spacing and dual porosity added the method of characteristics and total variation diminishing solvers in mt3dms gave nearly identical results there is a good agreement between mt3dms and the new model for an aquifer with dual porosity and no sorption single porosity with sorption and dual porosity with sorption fig 2 4 sensitivity analysis fig 3 shows sensitivity of the new model to ϕ for two values of α the source is constant for the first 100 days then zero the input parameters are shown in tables4 for high α the model is insensitive to ϕ the value of f is set equal to ϕ for each simulation the parameters ϕ and α are probably not physically independent for a real aquifer because α depends on the area of the interface between the mobile and immobile pore space and that is related to ϕ fig 4 shows sensitivity to λ m λ ms λ i and λ is for the input parameters in tables4 and with α 0 01 and ϕ 0 5 the base case has no decay and a value of 0 02 day 1 is assigned to the respective decay coefficient only in each simulation the results show λ to be a sensitive parameter for each domain and phase the sensitivity would change with sorption coefficients ϕ and α sensitivity to the sorption coefficients in both domains is shown in fig 5 increasing k i leads to tailing the model is sensitive to λ for both domains and phases k m k i ϕ and α sensitivity to other parameters such as dispersivity has been reported extensively in the literature 5 conclusions the main novelty of the new model is that it accounts for solute transport in a three dimensional aquifer of finite thickness and dual porosity with a point or volumetric mass generation source term of arbitrary time dependency and with sorption and decay coefficients that may differ for mobile or immobile domains and dissolved and sorbed mass the solution has a closed form in the laplace domain and is inverted using the de hoog et al 1982 algorithm the new solution is benchmarked against analytical models for single porosity aquifer and against a numerical model for transport in a single or dual porosity aquifer the model is shown to be sensitive to λ m λ sm λ i λ si k m k i ϕ and α these results suggest that the model may be used for evaluating tracer test experiments the new model is suitable for checking the accuracy of numerical models and identifying suitable ranges of values for key parameters it can simulate the effect of individual transport parameters such as different decay rates or sorption coefficients in the mobile and immobile domains the volumetric mass generation source can represent reactive barriers or source zones with time dependent production of solute superposition of the rectangular source terms with flexible time dependence can represent more complicated source zones data availability no observation data sets were used in this work the simulations may be recreated from the described inputs the coding of the new solution will be included in an upcoming epa report declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the preparation of the benchmark simulations was funded by the u s environmental protection agency epa under contract ep s9 13 02 this manuscript was prepared outside of work funded by and does not represent the views of the epa the author wishes to thank christopher neville of s s papadopulos associates inc for providing documentation for the benchmark models neville 2004 neville 2006 and to junqi huang stephen kraemer and matthew small of the epa office of research and development for their review of a draft report documenting this work the author also wishes to thank the editor and two anonymous reviewers for their helpful detailed review comments and independent verification of the benchmark simulations with analytical models appendix a integration along x the integral along x may be written as 43 φ x x 1 x 2 φ dx 0 all terms of φ contain exponentials with x 0 that can be combined and integrated along the x axis 44 x x 1 x 2 exp a x x 0 cx 0 dx 0 45 c q 2 θ m d x 46 a ψ ϖ n 2 θ m d y η k 2 θ m d z θ m d x the absolute value in the integrand necessitates splitting of the integral into parts 47 x x 1 x 2 exp a x x 0 cx 0 dx 0 if x x 2 x 1 x 2 exp a x 0 x cx 0 dx 0 if x x 1 x 1 x exp a x x 0 cx 0 dx 0 x x 2 exp a x 0 x cx 0 dx 0 otherwise evaluating the integrals comprising the term x resuts in 32 appendix b supplementary data supplementary data associated with this article can be found in the online version athttps doi org 10 1016 j jhydrol 2022 127520 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 supplementary data 5 
3597,a new solution for advective dispersive solute transport is developed for three dimensional aquifer of finite thickness and width infinite extent along the direction of flow dual porosity equilibrium linear sorption and first order decay of both the sorbed and dissolved mass with coefficients that may differ in the mobile and immobile domains and with initial concentration distribution or with source represented by a volumetric mass generation term of arbitrary time dependence the analytical laplace domain solution is numericaly inverted into the time domain the model is benchmarked against mt3dms and simpler analytical models the model is sensitive to transport parameters describing the dual domain suggesting it may be used for evaluating tracer tests the model is suitable for checking accuracy of numerical models and identifying ranges of key transport parameters keywords analytical solute transport dual porosity finite thickness aquifer nomenclature a x a y a z dispersivity in the principal directions l b aquifer thickness l c x y z t concentration m l3 d m molecular diffusion coefficient in water l2 t d x d y d z dispersion coefficients in principal directions l2 t d x d m q θ m a x etc f mass fraction of sorbent in contact with mobile dissolved mass k distribution coefficient l3 m m and i subscripts for mobile and immobile regions respectively indices are omitted in relations that apply to both regions q darcy flux l t w aquifer width l α transfer coefficient for mass exchange between mobile and immobile domains t 1 ϕ proportion of mobile porosity λ first order decay coefficient t 1 ρ dry bulk density of soil m l3 θ water content porosity for fully saturated soil θ m ϕ θ mobile porosity θ i 1 ϕ θ immobile porosity 1 introduction analytical solute transport models have an important role in guiding the selection of transport parameters and providing a check on accuracy for more detailed and complex numerical solute transport models analytical models can only represent rather simplified problem geometry and uniform flowfield but their input is simple and their accuracy is not affected by spatial and temporal discretization and numerical dispersion an analytical model for solute transport with a volumetric source term in a three dimensional dual porosity aquifer of finite thickness with first order reactions for dissolved and sorbed mass is not available the new solution presented below accounts for dual porosity sorption coefficients that differ in the mobile and immobile domains decay coefficients that differ for the sorbed and dissolved mass and in the mobile and immobile domains and a point or volumetric source term of arbitrary time dependence the following literature review is focused on models for three dimensional transport time domain solutions for advective dispersive transport of a single species in a three dimensional aquifer of single porosity and finite thickness with sorption and decay and with a specified concentration patch source are available in integral form wexler 1992 neville 1994 batu 1996 wang and wu 2009 liao et al 2021 derived a time domain solution for chain decaying species in a single porosity aquifer with a patch source perina 2021 developed an analytical laplace domain solution for transport of chain decaying species with a patch source of arbitrary time dependency in an aquifer of dual porosity and finite thickness the patch source is convenient because it can represent either a first or third type boundary condition and is applicable to many field scenarios solutions for solute transport from point or volumetric sources in a three dimensional aquifer of single porosity include the leij et al 1991 model for an infinite domain with various source geometries wexler 1992 solution for a point source in a finite or infinite domain boupha et al 2004 solution for a transient point source in a semi infinite domain neville 2006 solutions for point and volumetric sources in an infinite domain paladino et al 2018 solution for a finite thickness domain with various source geometries and wang and wu 2009 solution for a finite or infinite domain with a volumetric mass generation source leij et al 1993 derived a solution for an infinite domain of dual porosity with a patch source or with volumetric initial concentration distribution in the dual porosity model advection occurs in the fraction of the porosity that is mobile while groundwater present in the immobile porosity is stagnant the diffusion controlled mass exchange between the mobile and immobile porosity leads to tailing of plumes molz 2014 in the dispersion coefficient for the dual domain conceptual model the dispersivity may be minimized or set to zero because mechanical dispersion is represented by the mass transfer between the mobile and immobile porosity domains when this mass transfer rate is high the dual domain model behaves like a single domain model whose porosity approaches the total porosity of the porous medium on the other hand as the mass transfer rate approaches zero the dual domain model becomes equivalent to a single domain model with total porosity approaching the mobile porosity zheng and wang 1999 the first order rate coefficient for mass transfer between the mobile and immobile domains is difficult to quantify haggerty and gorelick 1995 and becomes a fitting parameter in practice neville et al 2000 only a limited number of analytical transport models account for dual porosity including one dimensional problems van genuchten and wagenet 1989 toride et al 1993 haggerty and gorelick 1995 neville et al 2000 three dimensional aquifer with rate limited sorption stauffer and hatfield 1992 three dimensional aquifer of infinite thickness with various source geometries leij et al 1993 leij and toride 1997 and chain decaying species in a three dimensional aquifer with a patch source perina 2021 mechanical dispersion is traditionally treated as a fickian term added to molecular diffusion e g bear 1972 zheng and bennett 1995 although this concept has been shown to be approximate zheng et al 2011 molz 2014 it is convenient for deriving an analytical solution a new solution for advective dispersive solute transport is developed for the following conditions the aquifer has finite thickness finite width infinite extent along the direction of flow and dual porosity the model domain represents a single aquifer layer with no solute mass exchange at the top and bottom and at the lateral boundaries parallel to groundwater flow direction the initial condition is zero concentration except for a special case coefficients for equilibrium linear sorption may differ for the mobile and immobile domains coefficients for first order decay may differ for the sorbed and dissolved mass and also in the mobile and immobile domains the source is defined by a mass generation term with arbitrary time dependence located at a point or uniformly distributed over a rectangular prism as a special case the source term may be replaced with initial concentration the bottom boundary may represent impermeable aquifer bottom and the top boundary may represent the water table or confining layer the lateral boundaries may represent impermeable aquifer boundaries or they may be extended so that they do not affect the simulated plume the volumetric mass generation term may represent for example the injection of a tracer mass release from a contaminated zone or mass generation in a reactive barrier because the transport problem is linear more complex configuration of sources may be represented by superposition a hypothetical transport problem may include superposition of sources and initial concentrations the chosen geometry a rectangular prism is a convenient building block for representing more complicated distribution of initial concentrations or sources the transport problem is solved analytically in the laplace domain and numerically inverted into the time domain the new model is benchmarked against widely used analytical and numerical solute transport models 2 mathematical model this section presents the governing equations boundary and initial conditions solution method special cases and numerical evaluation 2 1 governing equations the governing equations for solute concentrations c m x y z t and c i x y z t in the mobile and immobile regions respectively are modified from neville et al 2000 by extending to three dimensions and using linear instead of non equilibrium sorption the governing equation is 1 θ m f ρ k m t c m θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m t δ x x 0 δ y y 0 δ z z 0 for the mobile region and 2 θ i 1 f ρ k i t c i θ i λ i 1 f ρ λ si k i c i α c m c i for the immobile region the point source m t δ x x 0 δ y y 0 δ z z 0 where m is the time dependent mass generation rate per unit volume at point x 0 y 0 z 0 will be integrated over the volume of the source zone the remaining symbols are explained in nomenclature 2 2 initial and boundary conditions in the following subscripts m and i are omitted because the conditions apply to both domains the initial condition is zero concentration over the entire domain 3 c x y z 0 0 an alternate initial condition with uniform initial concentration within a rectangular prism will be considered as a special case no solute transport occurs across the lateral and vertical boundaries 4 y c x 0 z t 0 5 y c x w z t 0 6 z c x y 0 t 0 7 z c x y b t 0 the domain is infinite along the direction of flow x axis 8 c x y z t 0 2 3 solution the solution is obtained by applying the laplace transform in time t followed by the change of dependent variable to remove the advection term complex fourier transform in x and finite fourier cosine transforms in y and z e g churchill 1972 a point source solution is derived first then integrated over the volume of a rectangular prism perpendicular to the direction of flow 2 3 1 laplace transform taking the laplace transform in time t p of 1 and 2 while making use of the operational property t c p c c 0 results in 9 θ m f ρ k m p θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m δ x x 0 δ y y 0 δ z z 0 10 c i β c m 11a β α θ i 1 f ρ k i p θ i λ i 1 f ρ λ si k i α substitution for c i reduces the system to one governing equation 12 φ c m θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m m δ x x 0 δ y y 0 δ z z 0 13 φ θ m f ρ k m p θ m λ m f ρ λ sm k m α 1 β 2 3 2 change of dependent variable variable substitution to remove the advective term is convenient to facilitate using the fourier transform in x following the approach of marino 1974 and wexler 1992 who used similar transformations in the time domain the substitution 14 c m g exp q 2 θ m d x x removes the term q x c m and adds the term q 2 4 θ m d x g to 12 after cancelling the exponential terms the governing equation becomes 15 ψ g θ m d x 2 x 2 g θ m d y 2 y 2 g θ m d z 2 z 2 g m exp q 2 θ m d x x δ x x 0 δ y y 0 δ z z 0 16 ψ φ q 2 4 θ m d x 2 3 3 fourier transforms applying the complex fourier transform in x to 15 followed by finite fourier cosine transforms in y and z g p x y z g p ξ ϖ n η k and making use of their operational properties f 2 g x 2 1 2 π g x e i ξ x i ξ 2 g and f cos 2 g y 2 1 n g y y w g y y 0 ϖ n 2 g leads to 17 ψ ξ 2 θ m d x ϖ n 2 θ m d y η k 2 θ m d z g m exp qx 0 2 θ m d x i ξ x 0 cos ϖ n y 0 cos η k z 0 18 ϖ n n π w 19 η k k π b the changed variable transform solution for a point source is 20 g m exp qx 0 2 θ m d x i ξ x 0 cos ϖ n y 0 cos η k z 0 ψ ξ 2 θ m d x ϖ n 2 θ m d y η k 2 θ m d z 2 3 4 inverse fourier transforms and change to the original variable the inverse fourier transform in x utilizes the transform pairs phillips and parr 1995 21 f x x 0 e ix 0 ξ f ξ and 22 e a x 2 a a 2 ξ 2 to get 23 g m exp cx 0 a x x 0 2 θ m d x cos ϖ n y 0 cos η k z 0 a where 24 a ψ ϖ n 2 θ m d y η k 2 θ m d z θ m d x 25 c q 2 θ m d x applying the double inverse finite fourier cosine transform with the inverse transform in y defined as c 1 w c 0 2 w n 1 c n cos ϖ n y to 23 and changing back to the original dependent variable provides the laplace domain solution for a point source 26 c m m φ exp cx where 27 φ 1 bw y 0 0 2 bw n 1 y n 0 cos ϖ n y 2 b k 1 1 w y 0 k 2 w n 1 y n k cos ϖ n y cos η k z 28 y n k exp cx 0 a x x 0 cos ϖ n y 0 cos η k z 0 2 θ m d x a 2 3 5 laplace domain solution for rectangular prism the solution of the form 29 c m m φ xyz exp cx where m is the mass generation rate per unit volume of the aquifer is obtained by integrating 26 with respect to x 0 y 0 and z 0 over the volume of a rectangular prism defined by x 1 x 0 x 2 y 1 y 0 y 2 z 1 z 0 z 2 the integration along x is shown in appendix the term φ xyz is 30 φ xyz 1 bw θ 0 0 2 bw n 1 θ n 0 cos ϖ n y 2 b k 1 1 w θ 0 k 2 w n 1 θ n k cos ϖ n y cos η k z 31 θ n k x 2 θ m d x a sin ϖ n y 2 sin ϖ n y 1 ϖ n sin η k z 2 sin η k z 1 η k 32 x exp ax a c exp a c x 2 exp a c x 1 if x x 2 exp ax a c exp a c x 2 exp a c x 1 if x x 1 exp ax a c exp a c x exp a c x 1 exp ax a c exp a c x 2 exp a c x otherwise the terms with n 0 and k 0 are obtained as limits for example θ 0 0 is 33 θ 0 0 x 0 0 2 θ m d x a 0 0 y 2 y 1 z 2 z 1 the solution for c i is given by 10 2 4 special cases several special cases are considered 2 4 1 single porosity aquifer by setting ϕ 1 and f 1 the solution represents a single porosity aquifer coefficients for the immobile domain have no effect 2 4 2 one dimensional model as the source is stretched across the entire domain in the y and z directions for y 1 0 y 2 w z 1 0 and z 2 b 30 reduces to the first term where according to 33 the factor bw cancels out to get 34 φ x x 0 0 2 θ m d x a 0 0 and the solution represents one dimensional transport 2 4 3 steady state as t a steady state solution is derived as lim p 0 p c then all terms multiplied by p become zero and 29 with m replaced by a constant represents a steady state solution 2 4 4 initial concentration specifying m in 29 to be an instantaneous pulse the model represents an initial mass distribution such as after injection for some applications it is more convenient to consider a special case with initial concentration distribution and no source so that the initial concentration in the mobile domain c m 0 may differ from the initial concentration in the immobile region c i 0 for example the situation when c m 0 0 and c i 0 0 may represent the conditions after injection of a tracer while c i 0 c m 0 may represent the conditions after a pump and treat system flushed the mass in the mobile domain sorption equilibrium is assumed in each porosity domain let the rectangular volume x 1 x 0 x 2 y 1 y 0 y 2 z 1 z 0 z 2 contain a uniform initial concentration distribution and let the initial concentrations outside this region be zero first assume an initial concentration same form for c m and c i at a point 35 c x y z 0 c 0 h where 36 h δ x x 0 δ y y 0 δ z z 0 dx 0 dy 0 dz 0 that will later be integrated over the rectangular prism removing the source term from 1 and taking the laplace transform in time of 1 and 2 while utilizing the transform property t c p c c 0 the equations become 37 θ m f ρ k m p θ m λ m f ρ λ sm k m c m α c m c i θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m c m 0 θ m f ρ k m h and 38 c i β c m β α c i 0 θ i 1 f ρ k i h substituting from 38 in 37 leads to 39 φ c m θ m d x 2 x 2 c m θ m d y 2 y 2 c m θ m d z 2 z 2 c m q x c m c m 0 θ m f ρ k m h β c i 0 θ i 1 f ρ k i h the only difference between eqs 39 and 12 is that the source term containing m is replaced with the terms containing c m 0 and c i 0 making the substitution 40 c m 0 θ m f ρ k m β c i 0 θ i 1 f ρ k i m in 29 provides the solution for 39 eq 38 for a point initial concentration must still be integrated over the volume of the prism to obtain c i for the volumetric initial concentration the first term on the right hand side of 38 integrated over the prism is 29 multiplied by β the second term is integrated β α c i 0 θ i 1 f ρ k i x 1 x 2 δ x x 0 dx 0 y 1 y 2 δ y y 0 dy 0 z 1 z 2 δ z z 0 dz 0 to get 41 c i β c m β α c i 0 θ i 1 f ρ k i ϝ where 42 ϝ u x x 1 u x x 2 u y y 1 u y y 2 u z z 1 u z z 2 and u x is the unit step function 2 5 source term the source term m t allows arbitrary time dependent mass generation term perina 2021 presented several forms of time dependence that allow flexible representation of the source history including instantaneous pulse constant concentration or if the source is defined by a series of discrete data pairs t k and m k it can be represented by step wise changes or piece wise linear approximation 2 6 numerical evaluation the sine and cosine terms in the inverse fourier cosine transforms result in oscillating series that can be efficiently terminated to a desired tolerance after an appropriate number of terms determined by re writing the summation terms through trigonometric identities to determine the lowest frequency components perina 2021 the de hoog et al 1982 numerical laplace transform algorithm is used in this work because it can handle the arbitrary time dependence of the source term and has been shown to be accurate for solute transport e g moench 1991 boupha et al 2004 2 7 remarks the problem defined by 1 to 8 may be solved in the time domain using fourier transforms in x y and z however for a continuous source this approach leads to a convolution integral that has to be evaluated numerically the solution would be classified as semi analytical in comparison the laplace domain solution requires that 29 be only evaluated once for each summation term of the inverse laplace transform while still accommodating an arbitrary time dependence of the source term thus in terms of computational effort the time domain solution would not offer clear advantages over the laplace domain solution 3 benchmark simulations benchmark comparison with time domain analytical models neville 2006 is shown in fig 1 for an instantaneous point source and instantaneous and continuous volumetric rectangular prism source observations are at different locations for each case the neville 2006 analytical models are for an aquifer of infinite extent in all three dimensions therefore the model domain was extended and the source placed in the middle so that the effects of boundaries would be negligible during the simulation time the results for each test case are identical because the neville 2006 analytical models are time domain solutions this comparison serves as a check on the accuracy of both the new model and the suitability of the laplace transform inversion algorithm de hoog et al 1982 for this problem the input parameters are shown in the supplementary information in tables s1 s2 and s3 the new model is next compared to a numerical model prepared with mt3dms zheng and wang 1999 the model domain is 250 m along flow direction 145 m wide and 5 m high horizontal grid spacing is 1 m and vertical 0 5 m the simulation represents an initial concentration distribution within a rectangular block inside the model domain at 50 x 75 60 y 85 3 5 z 5 and no additional sources longitudinal transverse horizontal and transverse vertical dispersivity values are 2 5 m 0 25 m and 0 025 m the darcy flux is 3 5 m y ϕ 0 5 α 0 05 y 1 θ 0 35 ρ 1 7225 g cm3 and k m k i 0 1 cm3 g courant number is 1 and peclet number is 0 4 zheng and wang 1999 observation points are placed at cell centers along y 72 5 m at z 4 25 and x 99 5 149 5 200 5 and at z 2 25 m and x 100 5 150 5 199 5 m for the analytical model the x distances are reduced by 0 5 m 1 2 cell size to match the distance between the observations and the block of initial concentrations in mt3dms the model is a replication of neville 2004 model with more refined horizontal spacing and dual porosity added the method of characteristics and total variation diminishing solvers in mt3dms gave nearly identical results there is a good agreement between mt3dms and the new model for an aquifer with dual porosity and no sorption single porosity with sorption and dual porosity with sorption fig 2 4 sensitivity analysis fig 3 shows sensitivity of the new model to ϕ for two values of α the source is constant for the first 100 days then zero the input parameters are shown in tables4 for high α the model is insensitive to ϕ the value of f is set equal to ϕ for each simulation the parameters ϕ and α are probably not physically independent for a real aquifer because α depends on the area of the interface between the mobile and immobile pore space and that is related to ϕ fig 4 shows sensitivity to λ m λ ms λ i and λ is for the input parameters in tables4 and with α 0 01 and ϕ 0 5 the base case has no decay and a value of 0 02 day 1 is assigned to the respective decay coefficient only in each simulation the results show λ to be a sensitive parameter for each domain and phase the sensitivity would change with sorption coefficients ϕ and α sensitivity to the sorption coefficients in both domains is shown in fig 5 increasing k i leads to tailing the model is sensitive to λ for both domains and phases k m k i ϕ and α sensitivity to other parameters such as dispersivity has been reported extensively in the literature 5 conclusions the main novelty of the new model is that it accounts for solute transport in a three dimensional aquifer of finite thickness and dual porosity with a point or volumetric mass generation source term of arbitrary time dependency and with sorption and decay coefficients that may differ for mobile or immobile domains and dissolved and sorbed mass the solution has a closed form in the laplace domain and is inverted using the de hoog et al 1982 algorithm the new solution is benchmarked against analytical models for single porosity aquifer and against a numerical model for transport in a single or dual porosity aquifer the model is shown to be sensitive to λ m λ sm λ i λ si k m k i ϕ and α these results suggest that the model may be used for evaluating tracer test experiments the new model is suitable for checking the accuracy of numerical models and identifying suitable ranges of values for key parameters it can simulate the effect of individual transport parameters such as different decay rates or sorption coefficients in the mobile and immobile domains the volumetric mass generation source can represent reactive barriers or source zones with time dependent production of solute superposition of the rectangular source terms with flexible time dependence can represent more complicated source zones data availability no observation data sets were used in this work the simulations may be recreated from the described inputs the coding of the new solution will be included in an upcoming epa report declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the preparation of the benchmark simulations was funded by the u s environmental protection agency epa under contract ep s9 13 02 this manuscript was prepared outside of work funded by and does not represent the views of the epa the author wishes to thank christopher neville of s s papadopulos associates inc for providing documentation for the benchmark models neville 2004 neville 2006 and to junqi huang stephen kraemer and matthew small of the epa office of research and development for their review of a draft report documenting this work the author also wishes to thank the editor and two anonymous reviewers for their helpful detailed review comments and independent verification of the benchmark simulations with analytical models appendix a integration along x the integral along x may be written as 43 φ x x 1 x 2 φ dx 0 all terms of φ contain exponentials with x 0 that can be combined and integrated along the x axis 44 x x 1 x 2 exp a x x 0 cx 0 dx 0 45 c q 2 θ m d x 46 a ψ ϖ n 2 θ m d y η k 2 θ m d z θ m d x the absolute value in the integrand necessitates splitting of the integral into parts 47 x x 1 x 2 exp a x x 0 cx 0 dx 0 if x x 2 x 1 x 2 exp a x 0 x cx 0 dx 0 if x x 1 x 1 x exp a x x 0 cx 0 dx 0 x x 2 exp a x 0 x cx 0 dx 0 otherwise evaluating the integrals comprising the term x resuts in 32 appendix b supplementary data supplementary data associated with this article can be found in the online version athttps doi org 10 1016 j jhydrol 2022 127520 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 supplementary data 5 
3598,the installation of green infrastructure gi is a popular strategy for reducing stormwater runoff that contributes to combined sewer overflows csos however quantifying the impact of proposed gi systems on cso discharges is a difficult task that requires the simulation of runoff in a complex network of land parcels drainage controls and sewer pipes in this study the performance of porous pavement pp was examined with a focus on how the spatial design of pp features affects predicted cso volume numerical experiments were performed to explore how simulation based designs can identify specific subcatchments for cost effective pp implementation subject to budgetary constraints among the alternative design strategies considered simulation optimization was effective at finding cost effective solutions the experiments showed that pp can achieve substantial cso reductions across a range of rainfalls budgets and cso drainage characteristics but the performance is sensitive to the spatial configuration of the features good performing systems were also identified by generating multiple realizations via a randomized clustering strategy with additional improvement provided by the more computationally expensive optimization process keywords porous pavements green infrastructure stormwater modeling gi spatial design gi clustering simulation optimization notation i set of subcatchments in the csoshed j set of clusters β pp area budget to be deployed in the csoshed α assigned pp area a s u b c i area of the subcatchment i i a s u b c i j area of the subcatchment i i that belongs to the cluster j j δ i distance from the centroid of subcatchment i i to the outfall 1 introduction the prevalence of constructed impervious surfaces in urban centers is expected to increase due to population growth and urbanization leading to a potentially large increase in stormwater runoff unless concurrent control strategies are implemented e g sohn et al 2020 hassan et al 2020 for cities with combined sewer systems the number and volume of combined sewer overflows csos the untreated discharges of wastewater and stormwater during rainfall events are frequently the focus of regulatory compliance and an important driver for green infrastructure gi selection and placement under budget constraints e g torres et al 2019 tools to predict the gi impact on cso discharges range from simplified hydrology based equations to complex urban drainage models e g mccorquodale et al 2007 behr and montalto 2008 ghodsi et al 2021 fontecha et al 2016 for design it is common to evaluate the impacts of gi features using model simulations of multiple configurations e g ghodsi et al 2021 quantifying the city wide impact of gi requires a simulation of the full urban drainage system typically a complex network of land parcels drainage controls and sewer pipes lucas and sample 2015 illustrated how the design of a gi system can be accomplished by simulating multiple scenarios using a year of continuous rainfall data a process that can be very computationally demanding this work also indicated that gi can perform better than traditional gray infrastructure for reducing cso volumes but may be less effective for reducing the frequency of activations using a similar simulation based approach ghodsi et al 2021 performed a large number of computationally demanding simulations to demonstrate that the targeted placement of rain barrels and cisterns could reduce cso volume up to 24 for a medium sized urban case study as an alternative to comparing independently generated gi designs coupled simulation optimization can be used to find the number and locations of gi features that satisfy constraints and maximize cso benefits formal optimization can be particularly effective when the spatial locations of gi features favor disfavor certain benefits in a nonuniform manner zhang and chui 2018 hopkins et al 2017 ferrans et al 2021 furthermore when some gi benefits are potentially conflicting i e an improvement in one objective has a negative effect on another large scale simulations can be more effective when embedded in a multi objective optimization problem zhang and chui 2018 torres et al 2021 examples of simulation optimization to minimize runoff volumes and peak flows are provided by damodaram and zechman 2013 and liu et al 2016 a drawback of the simulation optimization approach is its computational burden for example regulatory requirements often emphasize the design goal of reducing the magnitude and frequency of cso events however these performance measures can be difficult to evaluate for urban drainage simulations that require substantial computational time for a single model execution liu et al 2016 for example simulating cso behavior throughout the medium sized city of buffalo new york requires up to 36 h of computation time for a calendar year a heavy computational burden when the numerical model needs to be repeatedly executed in a multi objective design context thousands of simulations may be needed to delineate the pareto front i e set of efficient solutions where improvements in one objective are not possible without worsening another hartikainen et al 2011 in many cases the high computational burden has limited the use of simulation optimization for real world cases see lund et al 2018 for a review on optimization using models to represent the dynamic of the urban drainage system this barrier has been reduced somewhat by the use of parallel computing architecture to reduce the wall clock time for design applications e g sadler et al 2019 robey and zamora 2021 hodges et al 2020 this study is focused on the placement of porous pavement pp features which are easy to install and do not affect the function of common urban spaces such as sidewalks parking lots and streets although designed for stormwater management pp can also mitigate the urban heat island effect stempihar et al 2012 reduce urban noise liu et al 2016 and enhance road safety ali et al 2012 joshi et al 2021 performed long term simulations to compare pp implementation strategies at the catchment scale and found that a distributed pp scheme could achieve up to 70 cso volume reduction for the case study montalto et al 2007 and fu et al 2019 also simulated the impact of pp on predicted cso volumes but these studies did not explore alternative spatial configurations while considerable research has addressed the hydrologic performance of individual pp features e g kim et al 2015 jato espino et al 2016 the impact of multiple pp components within a city wide system has received limited attention because the scale of an individual feature is likely to be much smaller than the urban drainage basin the large number of candidate locations results in a computationally demanding analysis as a first step toward addressing this issue this study expands the scale of interest from a single pp feature to a csoshed i e the drainage area contributing to a single cso outfall to address the problems associated with placing a small number of features in a large spatial domain we compared several pp spatial design strategies including budget constrained random placement engineering judgement and simulation optimization numerical experiments were used to address the extent to which the pp spatial placement impacts reductions in the volume of cso discharges this study reports the results of numerical experiments designed to evaluate how the placement of pp features within a medium sized city scale watershed affects predicted reductions in cso discharges following an approach currently adopted by city planners the design problem was framed as a budget constrained comparison of alternative pp designs across a set of high priority csosheds in addition to quantifying the effectiveness of pp for cso reduction the study explored four alternative simulation based strategies to identify effective designs with a reasonable computational budget the results advance the current understanding of stormwater management by 1 identifying alternative simulation based gi design approaches for large study areas 2 quantifying the impact of multiple pp components within large larger than previously studied areas and 3 characterizing the computational demand associated with large scale gi design 2 methodology 2 1 urban drainage model the numerical experiments utilized the state of practice storm water management model swmm rossman 2015 a dynamic rainfall runoff model that simulates stormwater quantity and quality in urban watersheds gironás et al 2010 swmm was developed by the us environmental protection agency and is widely used by researchers and practitioners because of its expansive capabilities numerical sophistication and open source access swmm can be used for both single event and long term simulations including time sensitive decision making such as real time control applications e g sun et al 2020 and short term and collaborative planning e g burger et al 2014 garcía et al 2015 sadler et al 2019 for city scale simulations a single swmm execution time can range from hours to days depending on the study area size and the detail with which the drainage system is represented for design applications e g zhi et al 2020 the overall run time increases proportionally with the number of scenarios evaluated in simulation optimization the run time also increases with the number of scenario specific model evaluations this study used swmm v5 1 rossman 2015 to simulate the behavior of pp deployed at the scale of a subcatchment a modeled area of land comprising a mix of pervious and impervious surfaces draining to a common outlet model outputs were inspected to determine the impact of pp on cso discharges into individual csosheds 2 2 pp simulation using swmm low impact development lid module the swmm low impact development lid module was used to simulate pp as a layered system consisting of surface pavement soil storage and underdrain components e g xie et al 2017 zhang and guo 2015 during a rainfall event stormwater is transported vertically through the pp layers at model calculated infiltration rates if the water inflow exceeds the underlying soil infiltration capacity the simulated water level rises until it reaches the drain outflow if the drainage volume exceeds the underdrain capacity the water depth will continue to increase until it reaches the ground surface and generates unmanaged runoff the pp system empties during the time between rainfalls through different paths depending on the structures design the water can exit the bottom via percolation and evapotranspiration and can be routed through the drain to the outlet or pervious area of the parent subcatchment the function of the pp structures is to delay the discharge by temporarily detaining runoff and by modifying the possible paths of the stormwater groundwater infiltration evaporation and delayed flow through the underdrain fig 1 shows the pp parameters in swmm with the assigned model values summarized in table 1 these values could be modified by a designer based on on site features for this study model values were determined by a combination of sensitivity runs and literature appraisal zhu et al 2019 schlüter and jefferies 2002 zhang and guo 2015 the last column of table 1 provides a qualitative appraisal of parameter sensitivity using event based simulations see madrazo uribeetxebarria et al 2021 for a comprehensive sensitivity analysis of particular importance the pp were assigned an impervious bottom layer and an underdrain with no offset modeled as an orifice that drains to the parent subcatchment outlet 2 3 scale of numerical experiments programs for cso mitigation are commonly directed at the scale of a csoshed bsa 2019 given a limited budget available for a single cso mitigation project the most natural approach would be to identify the csoshed that would most benefit from pp intervention the numerical experiments were therefore designed to consider a variety of design assumptions pp budget and rainfall scenarios as well as a representative set of csosheds with diverse features size shape land use etc in this approach various combination of pp budget rainfall event and targeted csoshed were assembled to provide candidate cso mitigation projects the numerical experiments described below explored the performance of alternative simulation based pp design strategies as applied to the selected set of candidate projects as described below a particular focus for the selected design strategies was the spatial placement or location of pp throughout a given csoshed 2 4 spatial design strategies to generate candidate pp spatial designs within a targeted csoshed four different design strategies were evaluated with the design goal of minimizing the total cso volume for a specified storm event see fig 2 each independent strategy was evaluated using swmm event based simulations with candidate fixed area pp placements constrained to subcatchments within the given csoshed containing roads and parking lots the two expert judgment strategies middle column in fig 2 were identified as promising design strategies based on a series of preliminary numerical experiments flow diagrams illustrating the spatial design algorithms are shown in the appendix a1 a4 2 4 1 strategy 1 budget constrained random placement the random placement strategy begins by randomly selecting a subcatchment within a csoshed the algorithm then assigns pp to the entire available area of the selected subcatchment until the budget is depleted the process is repeated until the remaining budget is exhausted using this algorithm a total of 1 000 realizations were generated per each analyzed csoshed i e 1 000 realizations for each hypothetical cso mitigation project and the best performing design in terms of cso reduction was selected from each set of realizations as the preferred design for the corresponding cso mitigation project 2 4 2 strategy 2 expert judgement 2 4 2 1 downstream first in series of preliminary experiments it was observed that pp features located closer to the csoshed outfall may be more effective at cso reduction this relationship is hydrologically plausible because subcatchments located near a csoshed outfall are likely to receive overland flow from a larger drainage area to leverage this insight a so called downstream first algorithm was developed that ranks subcatchments according to increasing distance to the given csoshed outfall and then assigns pp features to subcatchments in order of increasing rank i e nearest subcatchment first followed by the second closest subcatchment etc until the area budget is depleted because the distance based ranking generates a single pp spatial configuration the downstream first design strategy requires only one swmm execution per csoshed and budget 2 4 2 2 clustering in contrast with the two strategies described above the clustering exploits the potential advantage of pp aggregation the concept of clustering is supported by previous research suggesting that spatial connection between gi structures can improve efficiency in runoff reduction and pollutant treatment e g brown et al 2012 collinge 1996 a design strategy based on the k means algorithm peña et al 1999 was developed that generates candidate pp spatial configurations in three steps first the algorithm partitions a given csoshed is into k clusters of adjacent subcatchments based on the subcatchment centroid second one of the k clusters is randomly selected for pp placement third subcatchments within the selected cluster are randomly selected until the pp budget is depleted if the budget is not exhausted in the first cluster the algorithm selects an adjacent cluster to continue with the pp assignment until the budget is depleted a total of 1 000 clustered pp configurations were developed for each analyzed csoshed requiring 1 000 swmm executions the best performing design in terms of cso reduction was selected from each set of 1 000 realizations as the preferred design for the corresponding cso mitigation project 2 4 2 3 strategy 3 simulation optimization the automated optimization of a simulation model is a popular strategy for identifying low cost designs that satisfy performance goals april et al 2003 furthermore the use of parallel processing across multiple compute nodes i e siu and singh 1997 is an effective strategy to reduce the required wall clock time e g chang et al 2005 schryen 2020 among computing search algorithms the asynchronous parallel dynamically dimensioned search pdds tolson et al 2014 was selected for its ability to handle the large number of variables associated with candidate pp spatial configurations like the other strategies above the optimization is constrained by the pp budget and available area in each subcatchment these constraints were implemented as penalty functions the decision variables of the simulation optimization were the area of the pp and the location subcatchment in which they were placed this algorithm differs from the other strategies in that it is not required to assign pp to the entire available area in a selected subcatchment the overall objective was to identify a pp spatial configuration that minimizes the cso volume predicted by the swmm model note that pdds was selected to provide a typical benchmark performance but other optimization algorithms may be suitable for the simulation optimization strategy 3 case study the city of buffalo system consists of 1 300 km of sewers serving a population of 250 000 people in an area of 136 km2 us census bureau 2019 the system is considered combined with 1 270 km of sewer pipes carrying both wastewater and stormwater nogle 2019 fifty two permitted cso outfalls see fig 3 discharge to the great lakes system including the scajaquada creek the buffalo river the niagara river the niagara falls and the lake ontario to protect water resources and maintain regulatory compliance the city of buffalo has developed a long term control plan whose objectives include cso abatement by a combination of gray and green infrastructure malcolm pirnie arcadis 2017 3 1 the city of buffalo swmm model this study utilized a calibrated system wide urban drainage model implemented in swmm arcadis 2018 the model contains 60 000 subcatchments and 96 000 links including conduits orifices and weirs as opposed to the traditional lumped approach that represents land surfaces as distinct areal subcatchments each with a unique set of runoff parameters the buffalo swmm model uses a modeling at the source approach that delineates different types of surfaces as independent yet interconnected subcatchment features ghodsi et al 2021 the primary purpose of this approach is to increase the level of detail in the surface runoff routing but the use of subdivided areal subcatchments also supports a more precise delineation of gi functionality for example a single areal subcatchment consisting of multiple surfaces such as roofs lawns or streets is modeled as spatially overlapping smaller subcatchments one per surface type allowing the modeler to more accurately match gi type cisterns green roofs pp with the target land surface roofs streets or parking lots thirteen types of surfaces are modeled in the current buffalo swmm model including two types of roofs connected and disconnected to the sewer system streets parking lots and lawns see ghodsi et al 2021 for a detailed description of all sub catchment types this study focused on pp placement in the targeted subcatchments streets and parking lots which comprise 17 8 km2 9 074 swmm subcatchments fig 4 depicts the types of modelled surfaces that drain to the street and parking lot subcatchments 3 2 rainfall events exploratory runs performed with the buffalo swmm model indicated that a long term simulation for the designated design rainfall year 1993 requires up to 36 h using a single processor to reduce the computational burden this study used an event based approach in which the 1993 precipitation time series was analyzed to extract individual rainfall events a minimum dry period of six hours was used to delineate storms see fig 5 as expected smaller 0 01 cm and shorter 4 h rainfall events occurred more frequently since this study focuses on the use of gi for cso abatement and considering that cso discharges are typically observed for more intense rainfalls yu et al 2018 mailhot et al 2015 two large events were selected r1 4 47 cm rainfall in 12 h peak intensity of 1 37 cm hr and r2 3 45 cm rainfall in 25 h peak intensity of 0 30 in hr event r2 figs 6 and 7 illustrate the hyetographs of the selected rainfall events 3 3 csoshed and pp budget the selection of the csosheds was designed to capture city wide variation across three types of criteria 1 cso outfall discharge volume 2 land use land cover and population density and 3 area width and slope selected csosheds were delineated by backward tracking the links nodes and subcatchments draining to each outfall using the pcswmm tool select upstream chi 2021 the selected csosheds include neighborhoods across buffalo s east south and downtown areas encompassing a quarter of the city land area and about half of its population bsa 2019 the csosheds discharge to the scajaquada creek the buffalo river or the niagara river see table 2 table 2 summarizes the relevant characteristics of the four csosheds among other differences the selected csosheds occupy substantially different areas from 1 14 to 7 km2 53 the proportion of impervious surface is similar for three of the four csosheds 34 to 39 while 53 contains only 12 impervious surface the annual total discharge of these cso outfalls represents 29 of the city total volume while the subcatchment areas and pipe lengths corresponds to 35 and 54 of the total system respectively table 3 summarizes spatial aspects of the design scenarios consistent with the general approach of local decision makers 0 2 km2 of pp area per csoshed was selected as a short term planning goal with 0 4 km2 as a long term goal the estimated costs to implement these area budgets were approximately us 26 and 52 million dollars based on an assumed unit cost of 129 dollars per m2 each csoshed was optimized separately i e treated as a separate cso mitigation project hence by considering the 0 2 and 0 4 km2 area budgets the modeling experiments covered a wide range of interventions from 5 to 78 of the pp available area and from 0 34 to 17 of the total csoshed area 3 4 summary of numerical experiments for the buffalo case study the four selected csosheds were analyzed for two rainfall events two pp area budgets and four design strategies for pp placement resulting in a total of 16 hypothetical cso mitigation projects and 64 experimental setups 4 design strategies per mitigation project the budget constrained random placement and cluster based design strategies were each evaluated using 1 000 realizations per strategy three iterations of the pdds simulation optimization were performed for each of the 16 hypothetical mitigation projects the pdds perturbation value was set at 0 2 and the maximum number of objective function evaluations for each pdds trial was set to 10 000 for the clustering design strategy the k means parameter for each csoshed k number of partitions was fixed so that the area of each cluster was similar to the area of the budget 0 2 km2 and 0 4 km2 allowing the algorithm to potentially deploy the entire pp budget within a single cluster 3 5 software and hardware this study utilized a combination of the ostrich swmm macro et al 2019 and ostrich matott 2006 toolkits the swmm 5 1 stormwater simulator rossman 2015 and the user interface pcswmm 7 4 3220 chi 2021 ostrich is an open source model independent simulation optimization toolkit that implements a variety of optimization search algorithms including the pdds algorithm that was selected for this research ostrich swmm is a python interface that allows ostrich to dynamically insert gi components into a baseline see section 3 1 below swmm model the numerical experiments leveraged a linux based high performance computing cluster consisting of 144 intel e5 2650v2 compute nodes with 2 60 ghz clock speed 64 gb of ram and 16 processors per node ccr 2021 the parallel tasks in the pdds strategy were distributed across 120 nodes and 480 processors 4 results 4 1 baseline current condition and all in scenarios table 4 shows the predicted cso volumes resulting from the two rainfall events for each csoshed the results indicate that 1 as expected the selected hypothetical cso mitigation scenarios resulted in a diversity of baseline cso discharge behavior 2 pp installation can substantially reduce cso discharges 3 the per square kilometer efficiency is affected by both the storm hydrology and the drainage characteristics of the csoshed and 4 given an unlimited budget a simple all in analysis can help decision makers identify priority csosheds for pp intervention the baseline no pp discharge varied considerably across the csosheds with a range of 1 8 26 4 thousand m3 for r1 storm and 0 3 18 8 thousand m3 for r2 storm although the largest discharge occurred at 53 which has the largest drainage area the cso discharge was not proportional to overall area 14 for example drains the second largest area but generated the lowest r1 discharge when the baseline discharge was normalized to the impervious area 53 generated the largest r1 discharge 3 79 thousand m3 per impervious km2 and 14 the smallest 0 29 thousand m3 km2 on this basis 53 appears to be the best candidate for pp installation of interest is that 53 also reported the second lowest all in cost efficiency 0 8 thousand m3 pp km2 normalized baseline discharges were considerably lower for the r2 storm 0 05 to 2 68 thousand m3 km2 but the ordering or ranking of csoshed performance was similar when pp were implemented in all streets and parking lots the range of predicted cso reduction was large for all scenarios for r1 reduction volumes ranged from 0 56 to 2 88 thousand m3 11 to 76 of the baseline for r2 the range was 0 26 to 0 91 thousand m3 5 to 87 the largest overall reduction for both rainfalls occurred for 53 with the lowest reductions in 14 and 27 for r1 and r2 respectively when normalized to pp area 14 0 40 thousand m3 km2 was substantially less efficient than the others 0 92 1 09 thousand m3 km2 the efficiency also varied significantly between rainfalls for most csosheds for example in 27 the pp were much less effective reducing the r1 discharge 22 as opposed to 50 for r2 discharge on the basis of efficiency the best candidates for all in pp were 27 for r1 and 33 for r2 4 2 comparison of the pp budgets table 5 summarizes the cso volume reductions for the best performing pp spatial configuration this is from the range of solutions the best performing solution is located in the upper limit of the cso volume reduction range for the 0 2 km2 pp budget the most effective configurations provided meaningful cso reductions that ranged from 0 3 to 0 6 thousand m3 although the overall reductions were less the efficiencies were larger than the all in scenario ranging from 0 37 to 2 8 thousand m3 km2 furthermore the ordering of 0 2 km2 efficiencies differed from the all in scenario for r1 the highest efficiency was observed for 33 2 84 thousand m3 km2 suggesting it as the best candidate for 0 2 km2 pp placement when the pp budget was increased from 0 2 to 0 4 km2 greater overall cso reductions were observed 33 remained the most efficient for the more severe r1 however the magnitude and ordering of the 0 4 km2 improvement differed by both storm and csoshed table 5 also shows that with the exception of 53 the thousand m3 km2 efficiencies of the 0 4 km2 budget were very low for r2 suggesting that the benefits of pp for this longer and less severe storm could be limited the volume reductions for the r2 were generally smaller than for r1 considering the difference between r1 and r2 peaks see figs 6 and 7 these results point out that peak volumes could be a key variable for pp performance a larger range of peaks are required to test this hypothesis in particular 27 and 33 had very low efficiencies however 53 exhibited a similar efficiency for both storms even a slight increase for r2 that can be attributed to the randomized design process for the r2 design storm 53 would provide the best performance for both 0 2 and 0 4 km2 budgets the comparison across design scenarios indicates that the best location to install pp is highly dependent on both the budget and the selection of a design storm event for example 33 would be the best candidate for the larger r1 storm but would experience no benefit for the smaller r2 storm 4 3 comparison of the pp design strategies the importance of the design strategy can be quantified by examining the difference between the upper limit smallest simulated cso volume larger cso volume reduction and lower limit largest simulated cso volume smallest cso volume reduction spatial configurations from the range of solutions table 6 summarizes the largest and smallest simulated cso volumes across all design strategies and fig 8 shows the upper limit cso volume reduction using the four strategies for r1 and the 0 2 km2 budget the difference in cso reductions across the various design strategies ranged from 0 1 to 9 0 thousand m3 a substantial difference that motivates attention to the design procedure the greatest difference r1 0 2 km2 was observed for 53 which has the largest drainage area and second largest area available for pp the smallest design difference was observed for 27 where the 0 2 km2 design budget is a relatively large fraction 28 of the available pp area in general the upper limit spatial designs were identified by either the optimization or clustering strategies which examined a large number of randomized realizations constrained by the k means algorithm the optimization usually produced pp spatial configurations close in performance to the best solution and the strategy was successful in avoiding inefficient solutions nonetheless the computational demand for optimization was much higher on the order of 24 h versus 3 h for 1 000 realizations of the random cluster strategy while computational improvement may be possible for the optimization strategy it appears that the simple design strategy of generating a large number of clustered realizations may be more expedient when computational resources are limited furthermore the clustering algorithm was usually able to identify slightly better solutions than the unguided random strategy the percentage differences across the various methods were on average 23 and the best result was typically generated by the clustering method attempts to identify common attributes of the best performing clustered solutions e g degree of pp dispersion average subcatchment distance to the outfall were unsuccessful more research is needed to quantify the number of swmm runs needed to identify good performing clustered solution and the characteristics spatial or non spatial that explain the relative performance of clustered pp configurations it is noted that for 53 the different design strategies generated small differences in the simulated cso volume between 1 5 and 3 4 csoshed 53 receives a substantial discharge from scajaquada creek up to 16 of its volume and these flows are not affected by pp furthermore the pp budgets are small compared to the csoshed total area 0 34 and 0 68 for the 0 2 km2 and 0 4 km2 respectively and area available for pp these attributes suggest that the identification of an efficient pp spatial configuration solution may be more difficult when the impact on the csoshed discharge is relatively small and the pp budget is a small proportion of the possible subcatchments finally the downstream first algorithm did not perform as well as the other design strategies but yielded fairly good results considering it required only a single evaluation of the swmm model as such the downstream first strategy may be a reasonable choice if only a single realization is feasible 4 4 a hybrid approach the effectiveness of the clustering design strategy was somewhat surprising and this motivated several additional exploratory pdds optimizations in which the initial pdds solution was seeded with the best solution obtained by the clustering design strategy this hybrid procedure allows the pdds algorithm to leverage a priori information generated by the relatively inexpensive clustering strategy the optimal solutions generated via this hybrid approach yielded up to 10 improvement relative to the initial cluster based solutions and up to 21 improvement relative to the corresponding randomly seeded pdds solutions this suggests that sacrificing a small portion of the pdds budget in favor of an initial seeding step based on clustering could potentially boost pdds performance seeding pdds with the results from other design strategies might also yield similar improvement but was not explored in this study 5 discussion and limitations from the set of upper limit solutions largest cso volume reductions the pp spatial distributions were examined for each csoshed no obvious spatial pattern could be identified and the best candidates for pp design varied across csosheds and design storm it was also noted that the ratio of street subcatchments to parking lot subcatchments varied substantially across the optimal solutions from 0 7 to 1 7 the lack of a clear hydrologic explanation for the best performing pp spatial configurations motivates additional work to identify common features and spatial patterns of good performing designs e g upstream vs downstream aggregated vs disaggregated connectivity metrics etc because these csosheds represent a single urban watershed and a particular swmm model caution should be exercised in extrapolating the results furthermore results from event based simulations may differ from more time consuming year long swmm simulations which may be required for regulatory compliance it is also noted that this study focused only on cso discharge volumes future research will consider other performance metrics such as cso outfall activations in continuous simulations and or peak flow attenuation furthermore the study used a single pp design for all simulations but further improvement may be possible by adjusting particular components such as pp storage volume drainage plumbing and or media characteristics 6 conclusions for a city scale watershed the design selection and placement of pp features can be treated as a coupled simulation optimization problem for applications involving a complex urban drainage model identifying an optimal solution with a high degree of confidence may be infeasible when computational resources are limited eden et al 2018 however the swmm tools and algorithms developed in this study were shown to be effective in identifying efficient pp spatial configurations for the complex city of buffalo case study within a reasonable computational budget which was leveraged by the use of parallel processing for cities similar to the case study the simulations showed that pp can achieve substantial cso reductions but the effectiveness is sensitive to the spatial configuration of the pp features within individual csosheds the best strategy for a large scale pp spatial design was a combination of expert judgment and optimization in particular the study indicated that a clustering oriented design can provide a good starting solution to seed a subsequent optimization nonetheless more work is needed to improve both components of the hybrid approach and explore the dependence of optimal designs on the details of problem formulation e g single vs multiple objective functions penalization values integer vs continuous variables etc although not the best performer for all scenarios in this study there are many potential advantages of simulation optimization particularly if implemented in a parallel computing environment the ability to incorporate more complex cost and constraint functions would allow the designer to examine trade offs between competing multiple objectives and exploit cost differences that have a spatial component e g efficiencies due to spatial clustering logistical constraints in particular neighborhoods continuing work is recommended to explore alternative optimization algorithms and search parameters as well as the formulation of objectives and constraints to best reflect the particulars of stormwater and gi systems credit authorship contribution statement maría nariné torres conceptualization data curation formal analysis investigation methodology resources software supervision validation visualization writing original draft writing review editing alan rabideau supervision visualization writing original draft writing review editing funding acquisition project administration seyed hamed ghodsi conceptualization formal analysis investigation methodology writing original draft zhenduo zhu data curation formal analysis investigation methodology resources writing review editing l shawn matott data curation resources software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank the buffalo sewer authority bsa for providing research funding the swmm model and supporting information we thank the computational hydraulics international chi for providing a university grant to use the pcswmm model support system the project was also supported by the university at buffalo ub institute for research and education in energy environment and water renew and the ub center for computational research the opinions and findings presented in this paper are those of the authors and do not represent the views of the bsa appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127465 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3598,the installation of green infrastructure gi is a popular strategy for reducing stormwater runoff that contributes to combined sewer overflows csos however quantifying the impact of proposed gi systems on cso discharges is a difficult task that requires the simulation of runoff in a complex network of land parcels drainage controls and sewer pipes in this study the performance of porous pavement pp was examined with a focus on how the spatial design of pp features affects predicted cso volume numerical experiments were performed to explore how simulation based designs can identify specific subcatchments for cost effective pp implementation subject to budgetary constraints among the alternative design strategies considered simulation optimization was effective at finding cost effective solutions the experiments showed that pp can achieve substantial cso reductions across a range of rainfalls budgets and cso drainage characteristics but the performance is sensitive to the spatial configuration of the features good performing systems were also identified by generating multiple realizations via a randomized clustering strategy with additional improvement provided by the more computationally expensive optimization process keywords porous pavements green infrastructure stormwater modeling gi spatial design gi clustering simulation optimization notation i set of subcatchments in the csoshed j set of clusters β pp area budget to be deployed in the csoshed α assigned pp area a s u b c i area of the subcatchment i i a s u b c i j area of the subcatchment i i that belongs to the cluster j j δ i distance from the centroid of subcatchment i i to the outfall 1 introduction the prevalence of constructed impervious surfaces in urban centers is expected to increase due to population growth and urbanization leading to a potentially large increase in stormwater runoff unless concurrent control strategies are implemented e g sohn et al 2020 hassan et al 2020 for cities with combined sewer systems the number and volume of combined sewer overflows csos the untreated discharges of wastewater and stormwater during rainfall events are frequently the focus of regulatory compliance and an important driver for green infrastructure gi selection and placement under budget constraints e g torres et al 2019 tools to predict the gi impact on cso discharges range from simplified hydrology based equations to complex urban drainage models e g mccorquodale et al 2007 behr and montalto 2008 ghodsi et al 2021 fontecha et al 2016 for design it is common to evaluate the impacts of gi features using model simulations of multiple configurations e g ghodsi et al 2021 quantifying the city wide impact of gi requires a simulation of the full urban drainage system typically a complex network of land parcels drainage controls and sewer pipes lucas and sample 2015 illustrated how the design of a gi system can be accomplished by simulating multiple scenarios using a year of continuous rainfall data a process that can be very computationally demanding this work also indicated that gi can perform better than traditional gray infrastructure for reducing cso volumes but may be less effective for reducing the frequency of activations using a similar simulation based approach ghodsi et al 2021 performed a large number of computationally demanding simulations to demonstrate that the targeted placement of rain barrels and cisterns could reduce cso volume up to 24 for a medium sized urban case study as an alternative to comparing independently generated gi designs coupled simulation optimization can be used to find the number and locations of gi features that satisfy constraints and maximize cso benefits formal optimization can be particularly effective when the spatial locations of gi features favor disfavor certain benefits in a nonuniform manner zhang and chui 2018 hopkins et al 2017 ferrans et al 2021 furthermore when some gi benefits are potentially conflicting i e an improvement in one objective has a negative effect on another large scale simulations can be more effective when embedded in a multi objective optimization problem zhang and chui 2018 torres et al 2021 examples of simulation optimization to minimize runoff volumes and peak flows are provided by damodaram and zechman 2013 and liu et al 2016 a drawback of the simulation optimization approach is its computational burden for example regulatory requirements often emphasize the design goal of reducing the magnitude and frequency of cso events however these performance measures can be difficult to evaluate for urban drainage simulations that require substantial computational time for a single model execution liu et al 2016 for example simulating cso behavior throughout the medium sized city of buffalo new york requires up to 36 h of computation time for a calendar year a heavy computational burden when the numerical model needs to be repeatedly executed in a multi objective design context thousands of simulations may be needed to delineate the pareto front i e set of efficient solutions where improvements in one objective are not possible without worsening another hartikainen et al 2011 in many cases the high computational burden has limited the use of simulation optimization for real world cases see lund et al 2018 for a review on optimization using models to represent the dynamic of the urban drainage system this barrier has been reduced somewhat by the use of parallel computing architecture to reduce the wall clock time for design applications e g sadler et al 2019 robey and zamora 2021 hodges et al 2020 this study is focused on the placement of porous pavement pp features which are easy to install and do not affect the function of common urban spaces such as sidewalks parking lots and streets although designed for stormwater management pp can also mitigate the urban heat island effect stempihar et al 2012 reduce urban noise liu et al 2016 and enhance road safety ali et al 2012 joshi et al 2021 performed long term simulations to compare pp implementation strategies at the catchment scale and found that a distributed pp scheme could achieve up to 70 cso volume reduction for the case study montalto et al 2007 and fu et al 2019 also simulated the impact of pp on predicted cso volumes but these studies did not explore alternative spatial configurations while considerable research has addressed the hydrologic performance of individual pp features e g kim et al 2015 jato espino et al 2016 the impact of multiple pp components within a city wide system has received limited attention because the scale of an individual feature is likely to be much smaller than the urban drainage basin the large number of candidate locations results in a computationally demanding analysis as a first step toward addressing this issue this study expands the scale of interest from a single pp feature to a csoshed i e the drainage area contributing to a single cso outfall to address the problems associated with placing a small number of features in a large spatial domain we compared several pp spatial design strategies including budget constrained random placement engineering judgement and simulation optimization numerical experiments were used to address the extent to which the pp spatial placement impacts reductions in the volume of cso discharges this study reports the results of numerical experiments designed to evaluate how the placement of pp features within a medium sized city scale watershed affects predicted reductions in cso discharges following an approach currently adopted by city planners the design problem was framed as a budget constrained comparison of alternative pp designs across a set of high priority csosheds in addition to quantifying the effectiveness of pp for cso reduction the study explored four alternative simulation based strategies to identify effective designs with a reasonable computational budget the results advance the current understanding of stormwater management by 1 identifying alternative simulation based gi design approaches for large study areas 2 quantifying the impact of multiple pp components within large larger than previously studied areas and 3 characterizing the computational demand associated with large scale gi design 2 methodology 2 1 urban drainage model the numerical experiments utilized the state of practice storm water management model swmm rossman 2015 a dynamic rainfall runoff model that simulates stormwater quantity and quality in urban watersheds gironás et al 2010 swmm was developed by the us environmental protection agency and is widely used by researchers and practitioners because of its expansive capabilities numerical sophistication and open source access swmm can be used for both single event and long term simulations including time sensitive decision making such as real time control applications e g sun et al 2020 and short term and collaborative planning e g burger et al 2014 garcía et al 2015 sadler et al 2019 for city scale simulations a single swmm execution time can range from hours to days depending on the study area size and the detail with which the drainage system is represented for design applications e g zhi et al 2020 the overall run time increases proportionally with the number of scenarios evaluated in simulation optimization the run time also increases with the number of scenario specific model evaluations this study used swmm v5 1 rossman 2015 to simulate the behavior of pp deployed at the scale of a subcatchment a modeled area of land comprising a mix of pervious and impervious surfaces draining to a common outlet model outputs were inspected to determine the impact of pp on cso discharges into individual csosheds 2 2 pp simulation using swmm low impact development lid module the swmm low impact development lid module was used to simulate pp as a layered system consisting of surface pavement soil storage and underdrain components e g xie et al 2017 zhang and guo 2015 during a rainfall event stormwater is transported vertically through the pp layers at model calculated infiltration rates if the water inflow exceeds the underlying soil infiltration capacity the simulated water level rises until it reaches the drain outflow if the drainage volume exceeds the underdrain capacity the water depth will continue to increase until it reaches the ground surface and generates unmanaged runoff the pp system empties during the time between rainfalls through different paths depending on the structures design the water can exit the bottom via percolation and evapotranspiration and can be routed through the drain to the outlet or pervious area of the parent subcatchment the function of the pp structures is to delay the discharge by temporarily detaining runoff and by modifying the possible paths of the stormwater groundwater infiltration evaporation and delayed flow through the underdrain fig 1 shows the pp parameters in swmm with the assigned model values summarized in table 1 these values could be modified by a designer based on on site features for this study model values were determined by a combination of sensitivity runs and literature appraisal zhu et al 2019 schlüter and jefferies 2002 zhang and guo 2015 the last column of table 1 provides a qualitative appraisal of parameter sensitivity using event based simulations see madrazo uribeetxebarria et al 2021 for a comprehensive sensitivity analysis of particular importance the pp were assigned an impervious bottom layer and an underdrain with no offset modeled as an orifice that drains to the parent subcatchment outlet 2 3 scale of numerical experiments programs for cso mitigation are commonly directed at the scale of a csoshed bsa 2019 given a limited budget available for a single cso mitigation project the most natural approach would be to identify the csoshed that would most benefit from pp intervention the numerical experiments were therefore designed to consider a variety of design assumptions pp budget and rainfall scenarios as well as a representative set of csosheds with diverse features size shape land use etc in this approach various combination of pp budget rainfall event and targeted csoshed were assembled to provide candidate cso mitigation projects the numerical experiments described below explored the performance of alternative simulation based pp design strategies as applied to the selected set of candidate projects as described below a particular focus for the selected design strategies was the spatial placement or location of pp throughout a given csoshed 2 4 spatial design strategies to generate candidate pp spatial designs within a targeted csoshed four different design strategies were evaluated with the design goal of minimizing the total cso volume for a specified storm event see fig 2 each independent strategy was evaluated using swmm event based simulations with candidate fixed area pp placements constrained to subcatchments within the given csoshed containing roads and parking lots the two expert judgment strategies middle column in fig 2 were identified as promising design strategies based on a series of preliminary numerical experiments flow diagrams illustrating the spatial design algorithms are shown in the appendix a1 a4 2 4 1 strategy 1 budget constrained random placement the random placement strategy begins by randomly selecting a subcatchment within a csoshed the algorithm then assigns pp to the entire available area of the selected subcatchment until the budget is depleted the process is repeated until the remaining budget is exhausted using this algorithm a total of 1 000 realizations were generated per each analyzed csoshed i e 1 000 realizations for each hypothetical cso mitigation project and the best performing design in terms of cso reduction was selected from each set of realizations as the preferred design for the corresponding cso mitigation project 2 4 2 strategy 2 expert judgement 2 4 2 1 downstream first in series of preliminary experiments it was observed that pp features located closer to the csoshed outfall may be more effective at cso reduction this relationship is hydrologically plausible because subcatchments located near a csoshed outfall are likely to receive overland flow from a larger drainage area to leverage this insight a so called downstream first algorithm was developed that ranks subcatchments according to increasing distance to the given csoshed outfall and then assigns pp features to subcatchments in order of increasing rank i e nearest subcatchment first followed by the second closest subcatchment etc until the area budget is depleted because the distance based ranking generates a single pp spatial configuration the downstream first design strategy requires only one swmm execution per csoshed and budget 2 4 2 2 clustering in contrast with the two strategies described above the clustering exploits the potential advantage of pp aggregation the concept of clustering is supported by previous research suggesting that spatial connection between gi structures can improve efficiency in runoff reduction and pollutant treatment e g brown et al 2012 collinge 1996 a design strategy based on the k means algorithm peña et al 1999 was developed that generates candidate pp spatial configurations in three steps first the algorithm partitions a given csoshed is into k clusters of adjacent subcatchments based on the subcatchment centroid second one of the k clusters is randomly selected for pp placement third subcatchments within the selected cluster are randomly selected until the pp budget is depleted if the budget is not exhausted in the first cluster the algorithm selects an adjacent cluster to continue with the pp assignment until the budget is depleted a total of 1 000 clustered pp configurations were developed for each analyzed csoshed requiring 1 000 swmm executions the best performing design in terms of cso reduction was selected from each set of 1 000 realizations as the preferred design for the corresponding cso mitigation project 2 4 2 3 strategy 3 simulation optimization the automated optimization of a simulation model is a popular strategy for identifying low cost designs that satisfy performance goals april et al 2003 furthermore the use of parallel processing across multiple compute nodes i e siu and singh 1997 is an effective strategy to reduce the required wall clock time e g chang et al 2005 schryen 2020 among computing search algorithms the asynchronous parallel dynamically dimensioned search pdds tolson et al 2014 was selected for its ability to handle the large number of variables associated with candidate pp spatial configurations like the other strategies above the optimization is constrained by the pp budget and available area in each subcatchment these constraints were implemented as penalty functions the decision variables of the simulation optimization were the area of the pp and the location subcatchment in which they were placed this algorithm differs from the other strategies in that it is not required to assign pp to the entire available area in a selected subcatchment the overall objective was to identify a pp spatial configuration that minimizes the cso volume predicted by the swmm model note that pdds was selected to provide a typical benchmark performance but other optimization algorithms may be suitable for the simulation optimization strategy 3 case study the city of buffalo system consists of 1 300 km of sewers serving a population of 250 000 people in an area of 136 km2 us census bureau 2019 the system is considered combined with 1 270 km of sewer pipes carrying both wastewater and stormwater nogle 2019 fifty two permitted cso outfalls see fig 3 discharge to the great lakes system including the scajaquada creek the buffalo river the niagara river the niagara falls and the lake ontario to protect water resources and maintain regulatory compliance the city of buffalo has developed a long term control plan whose objectives include cso abatement by a combination of gray and green infrastructure malcolm pirnie arcadis 2017 3 1 the city of buffalo swmm model this study utilized a calibrated system wide urban drainage model implemented in swmm arcadis 2018 the model contains 60 000 subcatchments and 96 000 links including conduits orifices and weirs as opposed to the traditional lumped approach that represents land surfaces as distinct areal subcatchments each with a unique set of runoff parameters the buffalo swmm model uses a modeling at the source approach that delineates different types of surfaces as independent yet interconnected subcatchment features ghodsi et al 2021 the primary purpose of this approach is to increase the level of detail in the surface runoff routing but the use of subdivided areal subcatchments also supports a more precise delineation of gi functionality for example a single areal subcatchment consisting of multiple surfaces such as roofs lawns or streets is modeled as spatially overlapping smaller subcatchments one per surface type allowing the modeler to more accurately match gi type cisterns green roofs pp with the target land surface roofs streets or parking lots thirteen types of surfaces are modeled in the current buffalo swmm model including two types of roofs connected and disconnected to the sewer system streets parking lots and lawns see ghodsi et al 2021 for a detailed description of all sub catchment types this study focused on pp placement in the targeted subcatchments streets and parking lots which comprise 17 8 km2 9 074 swmm subcatchments fig 4 depicts the types of modelled surfaces that drain to the street and parking lot subcatchments 3 2 rainfall events exploratory runs performed with the buffalo swmm model indicated that a long term simulation for the designated design rainfall year 1993 requires up to 36 h using a single processor to reduce the computational burden this study used an event based approach in which the 1993 precipitation time series was analyzed to extract individual rainfall events a minimum dry period of six hours was used to delineate storms see fig 5 as expected smaller 0 01 cm and shorter 4 h rainfall events occurred more frequently since this study focuses on the use of gi for cso abatement and considering that cso discharges are typically observed for more intense rainfalls yu et al 2018 mailhot et al 2015 two large events were selected r1 4 47 cm rainfall in 12 h peak intensity of 1 37 cm hr and r2 3 45 cm rainfall in 25 h peak intensity of 0 30 in hr event r2 figs 6 and 7 illustrate the hyetographs of the selected rainfall events 3 3 csoshed and pp budget the selection of the csosheds was designed to capture city wide variation across three types of criteria 1 cso outfall discharge volume 2 land use land cover and population density and 3 area width and slope selected csosheds were delineated by backward tracking the links nodes and subcatchments draining to each outfall using the pcswmm tool select upstream chi 2021 the selected csosheds include neighborhoods across buffalo s east south and downtown areas encompassing a quarter of the city land area and about half of its population bsa 2019 the csosheds discharge to the scajaquada creek the buffalo river or the niagara river see table 2 table 2 summarizes the relevant characteristics of the four csosheds among other differences the selected csosheds occupy substantially different areas from 1 14 to 7 km2 53 the proportion of impervious surface is similar for three of the four csosheds 34 to 39 while 53 contains only 12 impervious surface the annual total discharge of these cso outfalls represents 29 of the city total volume while the subcatchment areas and pipe lengths corresponds to 35 and 54 of the total system respectively table 3 summarizes spatial aspects of the design scenarios consistent with the general approach of local decision makers 0 2 km2 of pp area per csoshed was selected as a short term planning goal with 0 4 km2 as a long term goal the estimated costs to implement these area budgets were approximately us 26 and 52 million dollars based on an assumed unit cost of 129 dollars per m2 each csoshed was optimized separately i e treated as a separate cso mitigation project hence by considering the 0 2 and 0 4 km2 area budgets the modeling experiments covered a wide range of interventions from 5 to 78 of the pp available area and from 0 34 to 17 of the total csoshed area 3 4 summary of numerical experiments for the buffalo case study the four selected csosheds were analyzed for two rainfall events two pp area budgets and four design strategies for pp placement resulting in a total of 16 hypothetical cso mitigation projects and 64 experimental setups 4 design strategies per mitigation project the budget constrained random placement and cluster based design strategies were each evaluated using 1 000 realizations per strategy three iterations of the pdds simulation optimization were performed for each of the 16 hypothetical mitigation projects the pdds perturbation value was set at 0 2 and the maximum number of objective function evaluations for each pdds trial was set to 10 000 for the clustering design strategy the k means parameter for each csoshed k number of partitions was fixed so that the area of each cluster was similar to the area of the budget 0 2 km2 and 0 4 km2 allowing the algorithm to potentially deploy the entire pp budget within a single cluster 3 5 software and hardware this study utilized a combination of the ostrich swmm macro et al 2019 and ostrich matott 2006 toolkits the swmm 5 1 stormwater simulator rossman 2015 and the user interface pcswmm 7 4 3220 chi 2021 ostrich is an open source model independent simulation optimization toolkit that implements a variety of optimization search algorithms including the pdds algorithm that was selected for this research ostrich swmm is a python interface that allows ostrich to dynamically insert gi components into a baseline see section 3 1 below swmm model the numerical experiments leveraged a linux based high performance computing cluster consisting of 144 intel e5 2650v2 compute nodes with 2 60 ghz clock speed 64 gb of ram and 16 processors per node ccr 2021 the parallel tasks in the pdds strategy were distributed across 120 nodes and 480 processors 4 results 4 1 baseline current condition and all in scenarios table 4 shows the predicted cso volumes resulting from the two rainfall events for each csoshed the results indicate that 1 as expected the selected hypothetical cso mitigation scenarios resulted in a diversity of baseline cso discharge behavior 2 pp installation can substantially reduce cso discharges 3 the per square kilometer efficiency is affected by both the storm hydrology and the drainage characteristics of the csoshed and 4 given an unlimited budget a simple all in analysis can help decision makers identify priority csosheds for pp intervention the baseline no pp discharge varied considerably across the csosheds with a range of 1 8 26 4 thousand m3 for r1 storm and 0 3 18 8 thousand m3 for r2 storm although the largest discharge occurred at 53 which has the largest drainage area the cso discharge was not proportional to overall area 14 for example drains the second largest area but generated the lowest r1 discharge when the baseline discharge was normalized to the impervious area 53 generated the largest r1 discharge 3 79 thousand m3 per impervious km2 and 14 the smallest 0 29 thousand m3 km2 on this basis 53 appears to be the best candidate for pp installation of interest is that 53 also reported the second lowest all in cost efficiency 0 8 thousand m3 pp km2 normalized baseline discharges were considerably lower for the r2 storm 0 05 to 2 68 thousand m3 km2 but the ordering or ranking of csoshed performance was similar when pp were implemented in all streets and parking lots the range of predicted cso reduction was large for all scenarios for r1 reduction volumes ranged from 0 56 to 2 88 thousand m3 11 to 76 of the baseline for r2 the range was 0 26 to 0 91 thousand m3 5 to 87 the largest overall reduction for both rainfalls occurred for 53 with the lowest reductions in 14 and 27 for r1 and r2 respectively when normalized to pp area 14 0 40 thousand m3 km2 was substantially less efficient than the others 0 92 1 09 thousand m3 km2 the efficiency also varied significantly between rainfalls for most csosheds for example in 27 the pp were much less effective reducing the r1 discharge 22 as opposed to 50 for r2 discharge on the basis of efficiency the best candidates for all in pp were 27 for r1 and 33 for r2 4 2 comparison of the pp budgets table 5 summarizes the cso volume reductions for the best performing pp spatial configuration this is from the range of solutions the best performing solution is located in the upper limit of the cso volume reduction range for the 0 2 km2 pp budget the most effective configurations provided meaningful cso reductions that ranged from 0 3 to 0 6 thousand m3 although the overall reductions were less the efficiencies were larger than the all in scenario ranging from 0 37 to 2 8 thousand m3 km2 furthermore the ordering of 0 2 km2 efficiencies differed from the all in scenario for r1 the highest efficiency was observed for 33 2 84 thousand m3 km2 suggesting it as the best candidate for 0 2 km2 pp placement when the pp budget was increased from 0 2 to 0 4 km2 greater overall cso reductions were observed 33 remained the most efficient for the more severe r1 however the magnitude and ordering of the 0 4 km2 improvement differed by both storm and csoshed table 5 also shows that with the exception of 53 the thousand m3 km2 efficiencies of the 0 4 km2 budget were very low for r2 suggesting that the benefits of pp for this longer and less severe storm could be limited the volume reductions for the r2 were generally smaller than for r1 considering the difference between r1 and r2 peaks see figs 6 and 7 these results point out that peak volumes could be a key variable for pp performance a larger range of peaks are required to test this hypothesis in particular 27 and 33 had very low efficiencies however 53 exhibited a similar efficiency for both storms even a slight increase for r2 that can be attributed to the randomized design process for the r2 design storm 53 would provide the best performance for both 0 2 and 0 4 km2 budgets the comparison across design scenarios indicates that the best location to install pp is highly dependent on both the budget and the selection of a design storm event for example 33 would be the best candidate for the larger r1 storm but would experience no benefit for the smaller r2 storm 4 3 comparison of the pp design strategies the importance of the design strategy can be quantified by examining the difference between the upper limit smallest simulated cso volume larger cso volume reduction and lower limit largest simulated cso volume smallest cso volume reduction spatial configurations from the range of solutions table 6 summarizes the largest and smallest simulated cso volumes across all design strategies and fig 8 shows the upper limit cso volume reduction using the four strategies for r1 and the 0 2 km2 budget the difference in cso reductions across the various design strategies ranged from 0 1 to 9 0 thousand m3 a substantial difference that motivates attention to the design procedure the greatest difference r1 0 2 km2 was observed for 53 which has the largest drainage area and second largest area available for pp the smallest design difference was observed for 27 where the 0 2 km2 design budget is a relatively large fraction 28 of the available pp area in general the upper limit spatial designs were identified by either the optimization or clustering strategies which examined a large number of randomized realizations constrained by the k means algorithm the optimization usually produced pp spatial configurations close in performance to the best solution and the strategy was successful in avoiding inefficient solutions nonetheless the computational demand for optimization was much higher on the order of 24 h versus 3 h for 1 000 realizations of the random cluster strategy while computational improvement may be possible for the optimization strategy it appears that the simple design strategy of generating a large number of clustered realizations may be more expedient when computational resources are limited furthermore the clustering algorithm was usually able to identify slightly better solutions than the unguided random strategy the percentage differences across the various methods were on average 23 and the best result was typically generated by the clustering method attempts to identify common attributes of the best performing clustered solutions e g degree of pp dispersion average subcatchment distance to the outfall were unsuccessful more research is needed to quantify the number of swmm runs needed to identify good performing clustered solution and the characteristics spatial or non spatial that explain the relative performance of clustered pp configurations it is noted that for 53 the different design strategies generated small differences in the simulated cso volume between 1 5 and 3 4 csoshed 53 receives a substantial discharge from scajaquada creek up to 16 of its volume and these flows are not affected by pp furthermore the pp budgets are small compared to the csoshed total area 0 34 and 0 68 for the 0 2 km2 and 0 4 km2 respectively and area available for pp these attributes suggest that the identification of an efficient pp spatial configuration solution may be more difficult when the impact on the csoshed discharge is relatively small and the pp budget is a small proportion of the possible subcatchments finally the downstream first algorithm did not perform as well as the other design strategies but yielded fairly good results considering it required only a single evaluation of the swmm model as such the downstream first strategy may be a reasonable choice if only a single realization is feasible 4 4 a hybrid approach the effectiveness of the clustering design strategy was somewhat surprising and this motivated several additional exploratory pdds optimizations in which the initial pdds solution was seeded with the best solution obtained by the clustering design strategy this hybrid procedure allows the pdds algorithm to leverage a priori information generated by the relatively inexpensive clustering strategy the optimal solutions generated via this hybrid approach yielded up to 10 improvement relative to the initial cluster based solutions and up to 21 improvement relative to the corresponding randomly seeded pdds solutions this suggests that sacrificing a small portion of the pdds budget in favor of an initial seeding step based on clustering could potentially boost pdds performance seeding pdds with the results from other design strategies might also yield similar improvement but was not explored in this study 5 discussion and limitations from the set of upper limit solutions largest cso volume reductions the pp spatial distributions were examined for each csoshed no obvious spatial pattern could be identified and the best candidates for pp design varied across csosheds and design storm it was also noted that the ratio of street subcatchments to parking lot subcatchments varied substantially across the optimal solutions from 0 7 to 1 7 the lack of a clear hydrologic explanation for the best performing pp spatial configurations motivates additional work to identify common features and spatial patterns of good performing designs e g upstream vs downstream aggregated vs disaggregated connectivity metrics etc because these csosheds represent a single urban watershed and a particular swmm model caution should be exercised in extrapolating the results furthermore results from event based simulations may differ from more time consuming year long swmm simulations which may be required for regulatory compliance it is also noted that this study focused only on cso discharge volumes future research will consider other performance metrics such as cso outfall activations in continuous simulations and or peak flow attenuation furthermore the study used a single pp design for all simulations but further improvement may be possible by adjusting particular components such as pp storage volume drainage plumbing and or media characteristics 6 conclusions for a city scale watershed the design selection and placement of pp features can be treated as a coupled simulation optimization problem for applications involving a complex urban drainage model identifying an optimal solution with a high degree of confidence may be infeasible when computational resources are limited eden et al 2018 however the swmm tools and algorithms developed in this study were shown to be effective in identifying efficient pp spatial configurations for the complex city of buffalo case study within a reasonable computational budget which was leveraged by the use of parallel processing for cities similar to the case study the simulations showed that pp can achieve substantial cso reductions but the effectiveness is sensitive to the spatial configuration of the pp features within individual csosheds the best strategy for a large scale pp spatial design was a combination of expert judgment and optimization in particular the study indicated that a clustering oriented design can provide a good starting solution to seed a subsequent optimization nonetheless more work is needed to improve both components of the hybrid approach and explore the dependence of optimal designs on the details of problem formulation e g single vs multiple objective functions penalization values integer vs continuous variables etc although not the best performer for all scenarios in this study there are many potential advantages of simulation optimization particularly if implemented in a parallel computing environment the ability to incorporate more complex cost and constraint functions would allow the designer to examine trade offs between competing multiple objectives and exploit cost differences that have a spatial component e g efficiencies due to spatial clustering logistical constraints in particular neighborhoods continuing work is recommended to explore alternative optimization algorithms and search parameters as well as the formulation of objectives and constraints to best reflect the particulars of stormwater and gi systems credit authorship contribution statement maría nariné torres conceptualization data curation formal analysis investigation methodology resources software supervision validation visualization writing original draft writing review editing alan rabideau supervision visualization writing original draft writing review editing funding acquisition project administration seyed hamed ghodsi conceptualization formal analysis investigation methodology writing original draft zhenduo zhu data curation formal analysis investigation methodology resources writing review editing l shawn matott data curation resources software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank the buffalo sewer authority bsa for providing research funding the swmm model and supporting information we thank the computational hydraulics international chi for providing a university grant to use the pcswmm model support system the project was also supported by the university at buffalo ub institute for research and education in energy environment and water renew and the ub center for computational research the opinions and findings presented in this paper are those of the authors and do not represent the views of the bsa appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127465 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3599,the influence of roughness aperture and asperity irregularity on fluid flow regimes in rough rock fractures was investigated by performing coupled triaxial water flow tests and fluid dynamic computation ten sets of fabricated curved wedges were developed to obtain different fracture surface roughness by splitting under compression three fluid flow regimes were identified in mated rock fractures pre linear flow at low flow velocity linear darcy s flow at the medium flow velocity and post linear flow at high flow velocity in pre linear flow regime the increasing rate of flow rate increased with water pressure gradient but it decreased in post linear flow regime the pre linear flow is ascribed to the slippage effect of water fracture interfaces while the post linear flow is mainly due to inertial effects the critical hydraulic gradient for fluid flow regime transition from pre linear to linear flow increased with the increase of confining stress the numerical modeling shows that the asperity irregularity influences the flow regime for low speed flow in fracture under slip boundary condition the slip flux per unit width in the fracture with triangular asperity is largest while that of rectangular asperity is smallest for high speed flow in fracture with non slip boundary condition the rectangular asperity element causes more severe nonlinearity when compared to the fractures of trapezoidal and triangular asperity elements keywords flow regime fluid flow hydraulic gradient fracture surface roughness nonlinear flow 1 introduction fluid flow through rock fractures widely occurs in nature and many reservoir applications such as hydrogeology chen et al 2020 wen et al 2013 hydraulics huang et al 2018 oil gas storage and exploitation biagi et al 2015 geothermal extraction danko et al 2020 ghassemi and zhou 2011 contaminant pollution control noiriel et al 2013 and nuclear waste disposal tsang et al 2015 rock fractures are usually rough both the primary and secondary fracture roughness can have significant influences on the fluid flow process depending on the scale of interest zou et al 2015 the local asperity along rock fracture surfaces changes the shape of preferential flow pathways regionally tsang and neretnieks 1998 wang et al 2016a wang et al 2021b furthermore aperture is a key factor determining the fluid flow in a rock fracture dependent on confinement wang et al 2021a watanabe et al 2008 even though many research efforts have been made on fluid flow regimes in rock fractures gan and elsworth 2016 guo et al 2020 liu et al 2020 ranjith and darlington 2007 the flow process is still elusive such as the emergence of the nonlinear flow regime darcy s law was firstly proposed by darcy in 1856 when conducting water flow through sand brown 2002 sukop et al 2013 the darcy s law describes the laminar fluid flow through pipe and parallel platen channels very well simplifying rock fracture consists of two smooth parallel platens cubic law has been derived when the fluid flow conforms to darcy s law zimmerman and bodvarsson 1996 however the real rock fractures are usually rough the waviness of two confined fracture walls changes the tortuosity of fluid flow for open rock fracture with large aperture the influence of this rough boundary layer on fluid flow may be insignificant such as the rock fractures with a low contact area proportion however with the decrease of aperture the fluid pressure head loss caused by the boundary waviness could be paramount the prediction with cubic law could overestimate the discharge of flow in tight rock fracture ge 1997 zhang et al 2015a zhang et al 2015b to extend the applicability of cubic law different formulas have been developed for fluid flow through rock fractures ju et al 2019 qian et al 2011 wang et al 2015 witherspoon et al 1980 zimmerman et al 1992 for fluid flow through rock fractures a deviation from linear darcy s law has been observed with the increase of flow velocity wang et al 2020 zhang and nemcik 2013a zimmerman et al 2004 the term post linear flow is used to denote this nonlinear flow here as it deviates from the darcy s flow with the increase of flow velocity the post linear flow has been observed at both low and high hydraulic gradients in rock fractures wen et al 2013 zhang and nemcik 2013a zimmerman et al 2004 attributed this post linear flow to the inertial effect chen et al 2015 conducted fluid flow tests in rough granite fractures under a wide range of confining stresses 1 30 mpa and further argued that the post linear flow was triggered by inertial effect at low confining stresses the fracture dilation at further confining stresses and strong fluid solid interaction at the highest confining stresses therefore the extra pressure head loss causing the nonlinear deviation from darcy s law is not only related to flow velocity but also dependent on the fracture roughness aperture and asperity irregularities chen et al 2015 cunningham et al 2020 xing et al 2021 zhang et al 2015b different from post linear flow a distinctly different nonlinear flow was observed for slow flow in natural and artificial unconsolidated porous media bagci et al 2014 kececioglu and jiang 1994 macini et al 2011 this nonlinear flow occurred before the darcy s flow and is termed as the pre linear flow here soni et al 1978 attributed it to molecular forces however siddiqui et al 2016 argued that the pre linear flow is due to the static friction of fluid and rock interaction the rock fractures can close tightly under confinement showing a characteristic of low permeability porous media an arising question is whether the pre linear flow exists in rock fracture if the pre linear flow exists in rock fractures the underlying mechanism behind should be further explored so far the influence of fracture roughness on fluid flow has been substantially studied brown 1987 chen et al 2019 cunningham et al 2020 wang et al 2016a zhang and nemcik 2013a for one hand fracture surface roughness enhances flow resistance for the other hand the undulation of the fracture surface and isolated contact areas make flow pathways tortuous as a consequence eddy flow can develop around asperity irregularity increasing the inertial effect wang et al 2016a zou et al 2017 additionally fracture surface roughness affects normal closure or shear dilation when subjected to normal compaction or shearing chen et al 2000 huang et al 2017 javadi et al 2014 kong and chen 2018 which in turn influences the fluid flow process on the field scale cornet et al 2003 conducted the coupled fluid flow normal stress experiment and found that the hydraulic and mechanical aperture become equivalent only when the latter is over 15 μm therefore the role of fracture roughness in fluid flow should be properly evaluated in particular a systematic study of the influence of a wide range of fracture roughness on the fluid flow process is essential to provide new data to advance the discipline frontier this investigation aims to investigate fluid flow regime transition in a single rock fracture under different fracture roughness aperture and asperity irregularity the coupled triaxial water flow tests were conducted on sandstone fractures with different surface roughness under the confining stresses of 1 8 mpa the typical fracture profiles were harvested by splitting the rock cores under compression with the fabricated ten sets of barton s jrc profiles corresponding to joint roughness coefficient jrc from 0 to 20 then the surface morphology of rock fractures was digitized with a non contacted high precision optical scanner after that a series of water flow tests through sandstone fractures under different inlet water pressures and confining stresses σ 3 were carried out with the developed triaxial cell to further investigate the influence of regional asperity irregularity slip and non slip boundary condition on the fluid flow process the computational fluid dynamic cfd simulation was conducted for water flow through rock fractures of rectangular trapezoidal and triangular asperity elements respectively 2 theoretical background the well known navier stokes n s equations describe the motion of fluid through rock fracture very well which expresses the momentum conservation of fluid flow for the incompressible newtonian flow the n s equations can be written xia et al 2017 1 ρ u t u u p f μ 2 u where ρ ml 3 is the fluid density t t is the time μ ml 1t 1 is the dynamic viscosity of the fluid u lt 1 is the velocity vector of flow p ml 1t 2 is the fluid pressure and f mlt 2 is the body force vector acting on the fluid the n s equations contain four variables that need to be derived the n s equations describe fluid flow in fractured rock mass accurately nevertheless the existence of the convective acceleration term u u renders the equation to be nonlinear making it difficult to solve the equation efficiently especially for natural rock with complicated fracture morphology some simplified empirical formulas have been proposed for convenient engineering applications darcy s law has been used to describe the laminar flow through rock fractures at a low flow rate or reynolds number 2 q k 0 a μ p where q l3t 1 is the volumetric flow rate k 0 l2 is the intrinsic permeability and a l2 is the cross sectional area perpendicular to the flow direction assuming the flow conforms to darcy s law and simplifying that the rock fracture consists of two smooth parallel platens the cubic law can be derived from navier stokes equations 3 q w e h 3 12 μ p where w l is the fracture width and the eh l is the hydraulic aperture of the two smooth parallel platens according to eq 3 the permeability can be obtained 4 k 0 e h 2 12 to describe the nonlinear flow in a single rock fracture some empirical and semi empirical formulas were developed among them forchheimer s equation has been widely used in the form of a zero intercept quadratic relation 5 p a q b q 2 where a ml 5t 1 and b ml 8 are the model coefficients representing energy loss components due to viscous and inertial dissipation effects respectively in which a μ k 0 a and is related with the intrinsic permeability of the fracture media with regard to b it relates to the geometric properties of fracture and can be determined by empirically zeng and grigg 2006 zhang and nemcik 2013a showed that both coefficients a and b increase with confining stress in other words the nonlinear term coefficient b increased along with the decrease of fracture aperture alternatively izbash s law in the form of a power function has been proposed to describe the nonlinear fluid flow in rock fractures 6 p λ q m where λ and m are empirical coefficients experimental data show m varies from 1 to 2 for fluid flow in rock fracture bordier and zimmer 2000 qian et al 2005 zhang and nemcik 2013a as a dimensionless parameter reynolds number re has been commonly used to identify the onset of the transition from linear to nonlinear flow in fractured and porous media it is the ratio of inertial forces to viscous forces 7 re ρ v e h μ ρ q μ w where v lt 1 is the flow rate in the fractures q v a and a w e h 3 methodology 3 1 sample preparation the fine grain sandstone was taken from a quarry in chongqing china it is a grey white feldspathic sandstone with a natural average density of 2 49 g cm3 and an average porosity of 4 37 the x ray diffraction analysis shows that the sandstone is composed of 51 feldspar 28 quartz 15 other minerals and 6 clay matrix intact cylindrical rock samples of 50 mm in diameter were cored from a sandstone block in the laboratory then the cored sandstone samples were polished using the lapping machine to achieve two smooth and parallel ends approximately 100 mm in length the permeability of the sandstone samples is low ranging 10 16 10 17 m2 to obtain a variety of surface roughness fractured samples ten sets of the auxiliary splitting gadgets covering jrc from 0 to 20 were fabricated as shown in fig 1 each set is made up of a splitting wedge and splitting holder in case of specimen damage after cracking the curved wedges with different fracture roughness profiles were fabricated as follows firstly barton s profiles with the joint roughness coefficient jrc between 0 and 20 were imported into the computer then these curved profiles were carved on the stainless metal using a digitally controlled machine dc 50b the carved wedges were quenched and thermally handled to improve the stiffness corresponding to typical fracture profiles of jrc from 0 to 20 ten sets of cracking wedges were prepared in total fig 1 the cored sandstones were split into two fracture halves using the fabricated splitting wedges under the quasi static compression fig 1 consequently ten fractured samples of different fracture profiles were prepared and their geometrical dimensions are listed in table 1 even though ten sets of fracture roughness were prepared with different curved splitting wedges the mean fracture surfaces were maintained to be along the longitudinal direction and perpendicular to the two parallel cylindrical ends therefore the normal stress of the rock fracture is approximately to the lateral confinement in the triaxial cell 3 2 fracture roughness measurement the fracture surface morphology was measured using a 3d non contact optical scanner cronos dual open technologies inc italy the measurement accuracy is 0 1 mm in the horizontal direction of the fracture surface and the resolution is 0 02 mm in the elevation direction multiple scans from different angles of view were performed on the same fracture surface of each sandstone sample the data of multiple images from multiple scans are merged into one topographic image data to eliminate blind data spots caused by a single scan the merging of multiple image data was conducted in the instrumental software by matching a limited number of marked reference points note that the marked reference points are not on the same straight line fig 2 shows the asperity height distribution of the fracture surface each fracture surface was divided into ten equally spaced sections along the flow direction and nine representative 2d profiles from the upper surface of the fractured sample were extracted fig 3 shows the fracture profiles of prepared fracture samples it can be seen that the average fracture profile morphology of most sandstone samples is generally similar to the corresponding barton s empirical profiles the statistical parameters the peak asperity height ξ and the arithmetic average of asperity height ra of fracture surfaces were analysed to quantitatively characterize the fracture surface roughness 8 ξ z max z min 9 r a 1 n i 1 n z i where n is the total number of data points forming a profile line zi is the asperity elevation zmax is the maximum asperity height and zmin is the minimum asperity height the specified jrc of each fractured sample was determined empirically tse and cruden 1979 10 jrc 32 2 32 47 log z 2 11 z 2 1 n 1 i 1 n 1 z i 1 z i 2 x i 1 x i 2 1 2 where z 2 is the root mean square of the first derivative of the profile height xi zi and xi 1 zi 1 represent the coordinate of adjacent points on the profile in jrc determination the sampling interval of 0 5 mm was selected tatone and grasselli 2010 the calculated roughness parameters and jrc were averaged over the nine profiles and are listed in table 1 the results show that the jrc ranges from 8 9 to 19 0 for fracture samples it is worth noting that there is significant difference in jrc between the calculated one with statistical roughness parameter z2 and that evaluated with the barton s jrc despite the similar geometric fracture profiles for instance the jrc calculated by eq 10 is 14 9 whereas the jrc range given by barton s jrc is 10 to 12 for fracture profile s6 the reason is that the barton s jrc profiles are two dimensional while the harvested ten sandstone fracture samples are three dimensional even though the harvested ten sandstone fracture samples are prepared with the barton s jrc curved wedges the fracture profiles along the direction perpendicular to the flow direction still show heterogeneity 3 3 test set up and procedure the experiments of fluid flow through a single rock fracture under different confining stresses were conducted in laboratory using an upgraded triaxial flow testing system the system consists of a triaxial cell loading unit water supply unit monitoring unit and a computer aided data acquisition unit as schematically demonstrated in fig 4 the pressurized water entered the rock fracture from the triaxial cell base going through the fractured sample and flows out of the triaxial cell through the top cap after the water flow stabilized the mass of the discharged water was recorded over a fixed time interval using a sensitive electrical balance scale with a precision of 0 01 g prior to the test rock fracture was enclosed with 1 mm thick heat shrinkable sleeve membrane and two grooved circular platens were placed onto the upper and lower ends of fractured sandstone sample to enable water to evenly access the whole fracture width fig 4 the enclosed fractured sandstone sample was fixed to the top and bottom caps subsequently the triaxial cell was assembled at the beginning a low level of axial stress of 1 mpa was applied to the both ends of the fractured sandstone sample during the tests to hold the fractured sandstone sample in the triaxial cell then the triaxial cell was filled with silicone oil by a servo controlled hydraulic pump and the confinement was applied to 1 mpa by the pressurized oil after that the water flow tests started following the experimental plan the confining pressure was raised step by step from 1 mpa to 8 mpa with an increment of 1 mpa and the water flow tests of different pressure gradients were conducted at each required confining stress level during the tests water pressure control was applied in the fluid flow experiment the confining stress inlet and outlet water pressure was continuously recorded by pressure transducer the head pressure difference is equal to the inlet water pressure minus the outlet water pressure note that the water pressure should be lower than the specified confining stress by approximately 200 kpa during the tests to prevent the collapse of the fractured sample within the triaxial cell 4 results and discussion 4 1 flow rate in terms of pressure gradient the fluid flow tests were performed under room temperature of approximately 20 c for the relatively low permeability and average porosity 4 37 the rock matrix is assumed to be impermeable when compared to water flow through rock fractures the water was assumed to be incompressible with a density of ρ 1 103 kg m3 and dynamic viscosity of μ 1 10 3 pa s fig 5 shows the relationship between water pressure gradient p and the measured volumetric flow rate q of mated sandstone fracture samples under confining stresses from 1 to 8 mpa obviously the flow rate increased with the water pressure gradient however the flow rate does not uniformly follow a linear relationship in terms of the pressure gradient noted that the number of flow data points under the low confining stress is relatively less than that of under the relative high confining stress the reason is that the injected water pressure needs be maintained lower than the confining stress to prevent the sample collapse and the fluid leakage between the sleeve membrane and fracture sample chen et al 2015 zhang and nemcik 2013a fig 5 also shows that the flow rate decreased with the increase of confining stress under the same water pressure gradient which is due to the fracture closure by the enhanced confining stress additionally the slope of the water pressure gradient in terms of volumetric flow rate became steeper as the confining stress increased from 1 to 8 mpa this reflects the evolution in flow resistance that is with the increase of the confining stress fracture aperture decreased and flow path tortuosity increased resulting in the increase in flow resistance 4 2 identification of fluid flow patterns to further investigate fluid flow regimes in all sandstone fracture samples the ratio of volumetric flow rate q to hydraulic gradient j against the hydraulic gradient is used to depict the flow data here hydraulic gradient j is defined as the ratio the pressure drop to fracture length along the flow direction j p i p o ρgl where the p i ml 1t 2 and p o ml 1t 2 are fluid pressure at inlet and outlet respectively g lt 2 is the gravitational acceleration fig 6 shows the curves of q j versus j as fluid flow through sandstone fractures the flow pattern of the whole flow process can be easily identified from the curves as shown in fig 6 according to the experimental data an overall increasing trend in q j was observed at the relatively small values of j for all rock fracture samples fig 6 even though slight fluctuations can be observed this means that the increasing rate of volumetric flow rate increased at this stage and a non linear flow pattern appeared at the low j which is recognized as the pre linear flow noted that the pre linear flow is not apparent under the low confining stress with further increase of j q j shows different flow patterns for different sandstone fracture samples under various confining stresses for the trend of q j being almost invariable with the increase of j fluid flow regime is identified as linear flow pattern such as the fracture sample no 1 under the confining stress of 5 mpa however a decreasing or increasing trend of the q j with the increase of hydraulic gradient j is identified as the post linear flow pattern such as for fracture samples nos 1 and 10 under the confining stress of 5 mpa based on the analysis above the non uniform flow patterns occurred in different sandstone fracture samples with different surface roughness under various confining stresses which includes pre linear linear and post linear flow based on izbash s equation zhang and nemcik 2013b introduced flow resistance r ml 5t 1 r p q c q n 1 ρ μ w p re to analyze flow pattern defining that the constant flow resistance with n 1 represents linear darcy s flow while n 1 represents non darcy flow fig 7 shows the relationship of the flow resistance versus reynolds number for all fracture samples under different confining stresses taking the fracture sample no 8 in fig 7 for example flow resistance dramatically decreased at a low range of reynolds number corresponding to n 1 confirmed that the pre linear flow occurred with the increase of reynolds number the flow resistance kept approximately as a constant corresponding to n 1 representing linear darcy s flow fig 7 also shows that flow resistance showed either an increase or decrease trend at the higher reynolds number corresponding to n 1 or n 1 such as fracture samples nos 8 and 1 under the confining stress of 4 mpa this indicates that the post linear flow occurred again fig 7 confirms that two non linear flow patterns sequentially occurred with the increase of pressure gradient the former occurred before the fluid flow entering the linear darcy s stage and the other one occurred after darcy s flow stage the mated rock fractures are used in this study it can be observed that the post linear flow only occurred with increase of reynolds number under certain circumstances and the linear flow still holds for most cases the reason is that the initial fracture aperture of mated rock fracture samples is small and the fracture aperture further decreases with the increase of confining stress as a result the range of reynolds number is relatively small and it is commonly limited to 0 10 however the post linear flow occurs in some fracture samples even within the same reynolds number such as fracture sample no 8 this indicates that the post linear flow is also related to the specific fracture roughness therefore the occurrence of post linear flow can be ascribed to the combined effect of the fracture aperture flow velocity and fracture roughness rather than a single factor due to the complex mechanism of post linear flow the influence of regional roughness and the irregularities of asperity needs to be further investigated 4 3 the type of flow regime transition in fracture samples based on analysis above four representative types of water flow evolution were observed in mated rough rock fractures under various confining stresses fig 8 in the first type both pre linear and linear flow patterns occurred without the presence of post linear flow fig 8a this type of fluid flow regime transition becomes more common for rock fractures subjected to relatively high confining stresses i e σ 3 5 8 mpa where the rock fracture can close more tightly in the pre linear flow stage the flow rate increased with the water pressure nonlinearly but the increase rate of normalized flow rate in terms of hydraulic gradient gradually lowered until ceased to be invariable exhibiting a similar fluid flow behavior of the non newtonian fluid flow di federico 1997 liu and birkholzer 2012 zhou et al 2015 it is known that water is a kind of newtonian fluid and the mechanism of this pre linear flow may be attributed to the slippage effect between fracture walls and fluid due to water solid interaction which can reduce the drag friction between the fluid and the boundary walls of fracture as fluid flows slowly through rough walled rock fracture the fluid velocity is not zero on the rock walled surfaces fig 9 shows the slip boundary condition of fracture walls and it can be implemented via navier slip boundary condition u s l s u z wall brochard and degennes 1992 zhou et al 2020 where us lt 1 is the velocity vector at fracture wall ls l is the slip length and u z t 1 is the velocity gradient in the direction normal to the fracture surface the condition that ls 0 represents that fluid flow follows no slip condition at the wall surface the navier slip boundary condition has been confirmed for its validity in flow path of a nanoscale and microscale aperture chen et al 2015 lee et al 2007 wang et al 2016b zhang et al 2013 with the increase of confining stress the rock fracture was further compacted to close tightly and the tight rock fracture can be approximated to clusters of connected and isolated pores furthermore the seepage mechanism characteristics in the rock fractures are changed for instance the flow rate decreased nonlinearly with an increase in the confining stress wang et al 2021a in addition the clusters of connected and isolated small pores are conducive to the appearance of the slippage effect when the slippage occurs the loss of pressure drop for flow drive decreases compared to the no slip boundary condition which can indirectly enhance fracture hydraulic conductivity accordingly the excessive discharge contributes to the nonlinearity of flow to compare the resultant difference in fluid flow behavior of rock fracture computational fluid dynamic simulation was conducted for fluid flow through rock fracture channel under both the slip and no slip boundary condition by holding the fluid pressure difference between the inlet and outlet of the fracture model 10 pa fig 10 shows an example of the difference in the velocity field in the fracture flow with no slip and slip boundaries under the no slip boundary condition fig 10a the section line velocity perpendicular to the main flow direction fits well with the hagen poiseuille flow in the fracture model where the flow velocity along the boundary wall is zero however a noticeable deviation away from the hagen poiseuille flow was observed for the slip boundary case in addition the flow velocity in the slip boundary is greater than that of no slip boundary although the velocity of pre linear flow phase is relatively small it is of significance for leakage assessment and optimization design in many rock reservoirs i e oil and gas exploitation hazardous waste control and groundwater resources protection in the second type a three stage flow pattern appeared such as rock fracture sample no 10 at the confining stress of 4 mpa fig 8b where fluid flow tends to be pre linear at small values of j followed by a linear flow when the pressure gradient j reaches and exceeds somewhat high value and finally q j slightly decreased in terms of j illustrating a weak post linear flow pattern at higher j this three stage flow pattern is prevalent at moderate confining stress condition such post linear flow could be attributed to the inertial effect another three stage flow pattern was also observed in rough walled rock fracture such as rock fracture sample no 1 under the confining stress of 5 mpa fig 8c where the pre linear linear and post linear flow patterns sequentially appeared with the increase of pressure gradient however it is noted that this post linear flow is different from the post linear flow mentioned above showing a slightly downward increase trend in curves of pressure gradient versus volumetric flow rate i e sample 1 in fig 5 one possible reason is that the fracture aperture increased abruptly at some high water pressure gradient and consequently the increasing rate of volumetric flow rate increased fig 8d shows the fourth type of fluid flow regime transition where a two stage flow pattern linear and post linear flow appeared with the increase of j at small j the flow tended to be linear and transited to be post linear at high values of j this type of fluid flow regime transition generally occurred at relatively low confining stress circumstance where the pre linear flow does not exist due to large fracture aperture even at small values of j 4 4 effect of confining stress on flow regime transition the flow pattern analyses above also show that the pre linear flow is not significant or may not appear at low confining stresses due to the large fracture aperture with the increase of confining stress there is a relatively stable pre linear flow stage at low flow velocity therefore confining stress affects the flow patterns to more clearly understand the effect of confining stress on the flow pattern fig 11 shows the evolution of q j with respect to j for rock fracture samples under confining stresses of 5 6 7 and 8 mpa it can be seen that the variation in q j against j followed an exponential function and the fitting curves show a very similar trend for different fracture samples in fig 11 the pre linear flow stage is highlighted approximately in cyan it shows that the critical hydraulic gradient of the fluid flow transition from pre linear to linear flow increased with the increase of confining stress the influence of confining stress on the fluid flow regime transition can be attributed to the change of fracture aperture when rock fractures are subjected to confining stress the fracture will close further reducing the fracture aperture fig 12 shows the variation in the normal deformation versus confining stress of intact and fractured sandstone samples used in the test there is an approximate hyperbolic function between normal deformation and confining stress bandis et al 1983 li et al 2016 saeb and amadei 1992 also the lateral deformation of intact sandstone is much smaller than that of fractured sandstone indicating that the fracture dominates in the normal deformation under compaction for further analysis the equivalent hydraulic aperture eh under a specific amount of confining stress was calculated using cubic law e h 12 μ q w p 1 3 with the data of linear flow phase and plotted in fig 13 a the hydraulic aperture decreased with an increase in confining stress following a hyperbolic function trend and it varies approximately from 5 μm to 40 μm for sandstone fracture samples at the confining stress of 1 to 8 mpa among all rock fractures rock fracture sample no 8 has the largest hydraulic aperture under the same confining stress this may be related to the high asperity of fracture surface of rock fracture sample no 8 fig 13b shows the variation of the peak asperity roughness parameter and hydraulic aperture of rock fracture samples overall the hydraulic aperture has a positive correlation with the peak asperity height 4 5 the influence of slip boundary and asperity irregularity on low velocity flow in the real fluid flow through open rock fractures the fluid flow regime is influenced by the three dimensional volume confined by the two rough fracture walls while the fluid flow regime in the closed rock fractures is influenced by fracture roughness aperture and contact areas making the flow pathway tortuous and forming preferential flow this is a very complicated situation due to the waviness variation of fracture surface over the whole flow direction chen et al 2021 rong et al 2020 zhang and nemcik 2013a the experimental data above have shown the appearance of pre linear linear and post linear flow of fluid flow through rock fractures however the bulk flow experimental tests in the triaxial cell constrains the specific flow process observation making the quantitative evaluation of the influence of the individual factors on the flow regime transition is impossible therefore cfd modeling was conducted to analyze the influence of individual factors on the fluid flow regime transition in rock fractures the asperities along the fracture surfaces cause the geometric irregularity affecting fluid flow behavior to investigate the influence of fracture roughness on pre linear flow three two dimensional 2d fracture models with the same length and height but with rectangular trapezoidal and triangular asperity elements were numerically developed while holding the same fracture aperture 0 5 mm fig 14 the navier stokes equations eq 1 were solved for three fracture models with the finite element method in comsol multiphysics constant pressure from 1 to 100 pa were applied at the inlet boundary and the hydraulic pressure at the outlet boundary was set to zero both the slip and no slip cases were considered as the wall condition of fracture for the slip boundary case the slip length l s is assumed to be a constant and l s is determined using the following equation zhou et al 2020 13 l s c 1 c 2 c 3 e where e l is fracture aperture size approximately equal to 500 µm in the established model c 1 8 9648 c 2 1 1573 and c 3 0 9956 the values of c 1 c 3 are obtained by fitting the functional relationship between ls and the fracture aperture e based on the calibration flow experiments conducted by lee et al 2007 zhou et al 2020 therefore the slip length ls 8 84 μm fig 15 shows the evolution of flow rate against hydraulic gradient in the fracture models for different flow channels the flow rate increased with hydraulic gradient in a similar manner it can also be seen that the flow rate is significantly greater at the slip boundary than that of the no slip boundary at ls 8 84 μm the difference of flow rate between the slip and no slip boundaries under the same hydraulic gradient is around 10 indicating that the hydraulic conductivity of rock fracture is enhanced as the slip condition of fracture walls reduces the drag friction between the fluid and the fracture walls therefore the excessive flow can be attributed to the fluid slippage effect causing the pre linear flow fig 15 also shows that the flow rate is not equal among different rock fractures despite the fact that all fractures subjected to the same hydraulic gradient this may be caused by the difference in asperity shape in contrast the hydraulic conductivity of fracture of triangular shape asperity is the highest while the fracture with rectangular shape asperity is the lowest illustrating that the rectangular asperity affects fluid flow more significantly for the no slip boundary the difference of flow rate in different rock fractures can be ascribed to the inconsistent fracture asperity shape while for the slip boundary case the difference of flow rate in different fractures is the result of the combined effect of the inconsistent fracture asperity shape and the slippage effect fig 15d shows that under the slip condition the slip flux an additional flow rate due to slip at the solid liquid of triangular asperity is largest while that of rectangular asperity is smallest it is known that the boundary slippage is also affected the fracture roughness wettability hydrophobicity and hydrophilicity of the surface microscopically bonaccurso et al 2003 cottin bizonne et al 2005 lee et al 2014 vinogradova 1995 it seems that triangular asperity enhanced the hydrophobicity of the surface for fluid flow through real rock fractures the fracture surface morphology and void geometry are much more complicated than the simulated cases and a variety of factors such as flow tortuosity void heterogeneity and aperture could influence the boundary slip condition here only the influence of rectangular trapezoidal and triangular asperity conditions on the fluid flow process was considered further assessment is needed to describe the influence of real rough fracture on the slip boundary condition in addition as fracture aperture size increase the slip length of the slip boundary also increases lee et al 2007 therefore the slip flux also increases under the same hydraulic gradient a rock fracture of a high and steep asperity may own a larger fracture aperture as shown in fig 13b causing the slip flux may be relatively larger in such a rock fracture the analysis above has illustrated the influence of slippage boundary on the fluid flow regime at the low flow velocity condition however the determination of the slip boundary condition is essential to demark the start and ending of the pre linear flow under the slip boundary condition the slip velocity us 0 while us 0 for non slip boundary condition therefore at the microscopic scale boundary slip can be determined with some measurement techniques such as micro particle image velocimetry ou and rothstein 2005 near field laser velocimetry hervet and leger 2003 surface force apparatus baudry et al 2001 and atomic force microscope bonaccurso et al 2003 4 6 the influence of asperity irregularity on high velocity flow in the fracture models mentioned above fluid flow in fractures deviates from the linear flow to form a non linear flow with the increase of hydraulic gradient from 0 2 to 2 0 that is the post linear flow stage the forchheimer equation describes the flow data numerical modeling very well fig 16 a where the fracture wall condition is only set as a no slip boundary the flow rate of the fracture model with rectangular asperity element was smaller than those of trapezoid and triangle while under the same hydraulic gradient indicating that the rectangular asperity element affects the fluid flow more significantly fig 16b c and d show the velocity contours and streamlines at the interval x 0 015 m 0 026 m along the flow direction under a hydraulic gradient of 2 0 the evolution of streamlines indicates that obvious eddy flow occurred at the corners of the asperity element at the post linear flow stage the nonlinearity of fluid flow in fractures is essentially ascribed to the inertial effects which is due to high flow velocity or the effect of fracture roughness when fluid flows through rough walled rock fracture the presence of asperity on the fracture surface enhances flow resistance furthermore the localized eddy flow consumes extra pressure drop and reduces the effective discharge in the fractures it can also be observed that the backflow region in the rock fracture with the rectangular asperity element is larger than that of the fractures with trapezoidal and triangular asperity elements indicating that the rectangular asperity element causes the largest obstruction to fluid flow when compared to trapezoidal and triangular asperity elements in terms of the triangular trapezoidal and rectangular asperity elements these asperity elements exhibit different geometric features and this factor is the main reason for the difference in fluid flow in the fractures with these asperity elements 5 conclusions the study investigated the fluid flow regime transition rough rock fractures considering the influence of different fracture roughness aperture and asperity irregularity ten sets of wedges corresponding to jrc from 0 to 20 were fabricated to obtain the rock fractures of different surface roughness a series of water flow tests were conducted on sandstone fractures using the developed triaxial fluid flow test system under confining stresses from 1 mpa to 8 mpa the influence of asperity irregularity slip and non slip boundary walls on the fluid flow was further investigated by performing fluid dynamic computation by analysing the evolution trend in q j with respect to j three flow regimes the pre linear linear and post linear flow were identified for water flow through mated sandstone fractures an initial pre linear flow pattern at very low flow rates and then a linear flow pattern with the increase of flow rate and finally the post linear flow pattern at high flow rates the pre linear flow is attributed to the fluid slippage on the fracture wall in the pre linear flow stage the fracture roughness and aperture mainly affect the fluid slippage and hence the fluid flow in addition numerical simulation shows that the slip flux per unit width in the fracture with triangular asperity element is largest while that of rectangular asperity is smallest also the critical hydraulic gradient for fluid flow regime transition from pre linear to linear flow increased with the increase of confining stress in contrast the post linear flow is mainly ascribed to the inertial effect due to the increase of flow velocity caused by the increase of hydraulic gradient and the effect of fracture surface roughness in addition numerical simulation shows that the discharge per unit width in the fracture with triangular asperity element is highest however it becomes the smallest in the fracture with rectangular asperity element implying that the rectangular asperity element influences the fluid flow more significantly credit authorship contribution statement yong luo conceptualization methodology formal analysis writing original draft data curation formal analysis software zhenyu zhang conceptualization methodology supervision writing review editing funding acquisition project administration yakun wang writing review editing jan nemcik writing review editing resources jiahua wang methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was financially supported by the national natural science foundation of china no 51674047 and 51911530152 
3599,the influence of roughness aperture and asperity irregularity on fluid flow regimes in rough rock fractures was investigated by performing coupled triaxial water flow tests and fluid dynamic computation ten sets of fabricated curved wedges were developed to obtain different fracture surface roughness by splitting under compression three fluid flow regimes were identified in mated rock fractures pre linear flow at low flow velocity linear darcy s flow at the medium flow velocity and post linear flow at high flow velocity in pre linear flow regime the increasing rate of flow rate increased with water pressure gradient but it decreased in post linear flow regime the pre linear flow is ascribed to the slippage effect of water fracture interfaces while the post linear flow is mainly due to inertial effects the critical hydraulic gradient for fluid flow regime transition from pre linear to linear flow increased with the increase of confining stress the numerical modeling shows that the asperity irregularity influences the flow regime for low speed flow in fracture under slip boundary condition the slip flux per unit width in the fracture with triangular asperity is largest while that of rectangular asperity is smallest for high speed flow in fracture with non slip boundary condition the rectangular asperity element causes more severe nonlinearity when compared to the fractures of trapezoidal and triangular asperity elements keywords flow regime fluid flow hydraulic gradient fracture surface roughness nonlinear flow 1 introduction fluid flow through rock fractures widely occurs in nature and many reservoir applications such as hydrogeology chen et al 2020 wen et al 2013 hydraulics huang et al 2018 oil gas storage and exploitation biagi et al 2015 geothermal extraction danko et al 2020 ghassemi and zhou 2011 contaminant pollution control noiriel et al 2013 and nuclear waste disposal tsang et al 2015 rock fractures are usually rough both the primary and secondary fracture roughness can have significant influences on the fluid flow process depending on the scale of interest zou et al 2015 the local asperity along rock fracture surfaces changes the shape of preferential flow pathways regionally tsang and neretnieks 1998 wang et al 2016a wang et al 2021b furthermore aperture is a key factor determining the fluid flow in a rock fracture dependent on confinement wang et al 2021a watanabe et al 2008 even though many research efforts have been made on fluid flow regimes in rock fractures gan and elsworth 2016 guo et al 2020 liu et al 2020 ranjith and darlington 2007 the flow process is still elusive such as the emergence of the nonlinear flow regime darcy s law was firstly proposed by darcy in 1856 when conducting water flow through sand brown 2002 sukop et al 2013 the darcy s law describes the laminar fluid flow through pipe and parallel platen channels very well simplifying rock fracture consists of two smooth parallel platens cubic law has been derived when the fluid flow conforms to darcy s law zimmerman and bodvarsson 1996 however the real rock fractures are usually rough the waviness of two confined fracture walls changes the tortuosity of fluid flow for open rock fracture with large aperture the influence of this rough boundary layer on fluid flow may be insignificant such as the rock fractures with a low contact area proportion however with the decrease of aperture the fluid pressure head loss caused by the boundary waviness could be paramount the prediction with cubic law could overestimate the discharge of flow in tight rock fracture ge 1997 zhang et al 2015a zhang et al 2015b to extend the applicability of cubic law different formulas have been developed for fluid flow through rock fractures ju et al 2019 qian et al 2011 wang et al 2015 witherspoon et al 1980 zimmerman et al 1992 for fluid flow through rock fractures a deviation from linear darcy s law has been observed with the increase of flow velocity wang et al 2020 zhang and nemcik 2013a zimmerman et al 2004 the term post linear flow is used to denote this nonlinear flow here as it deviates from the darcy s flow with the increase of flow velocity the post linear flow has been observed at both low and high hydraulic gradients in rock fractures wen et al 2013 zhang and nemcik 2013a zimmerman et al 2004 attributed this post linear flow to the inertial effect chen et al 2015 conducted fluid flow tests in rough granite fractures under a wide range of confining stresses 1 30 mpa and further argued that the post linear flow was triggered by inertial effect at low confining stresses the fracture dilation at further confining stresses and strong fluid solid interaction at the highest confining stresses therefore the extra pressure head loss causing the nonlinear deviation from darcy s law is not only related to flow velocity but also dependent on the fracture roughness aperture and asperity irregularities chen et al 2015 cunningham et al 2020 xing et al 2021 zhang et al 2015b different from post linear flow a distinctly different nonlinear flow was observed for slow flow in natural and artificial unconsolidated porous media bagci et al 2014 kececioglu and jiang 1994 macini et al 2011 this nonlinear flow occurred before the darcy s flow and is termed as the pre linear flow here soni et al 1978 attributed it to molecular forces however siddiqui et al 2016 argued that the pre linear flow is due to the static friction of fluid and rock interaction the rock fractures can close tightly under confinement showing a characteristic of low permeability porous media an arising question is whether the pre linear flow exists in rock fracture if the pre linear flow exists in rock fractures the underlying mechanism behind should be further explored so far the influence of fracture roughness on fluid flow has been substantially studied brown 1987 chen et al 2019 cunningham et al 2020 wang et al 2016a zhang and nemcik 2013a for one hand fracture surface roughness enhances flow resistance for the other hand the undulation of the fracture surface and isolated contact areas make flow pathways tortuous as a consequence eddy flow can develop around asperity irregularity increasing the inertial effect wang et al 2016a zou et al 2017 additionally fracture surface roughness affects normal closure or shear dilation when subjected to normal compaction or shearing chen et al 2000 huang et al 2017 javadi et al 2014 kong and chen 2018 which in turn influences the fluid flow process on the field scale cornet et al 2003 conducted the coupled fluid flow normal stress experiment and found that the hydraulic and mechanical aperture become equivalent only when the latter is over 15 μm therefore the role of fracture roughness in fluid flow should be properly evaluated in particular a systematic study of the influence of a wide range of fracture roughness on the fluid flow process is essential to provide new data to advance the discipline frontier this investigation aims to investigate fluid flow regime transition in a single rock fracture under different fracture roughness aperture and asperity irregularity the coupled triaxial water flow tests were conducted on sandstone fractures with different surface roughness under the confining stresses of 1 8 mpa the typical fracture profiles were harvested by splitting the rock cores under compression with the fabricated ten sets of barton s jrc profiles corresponding to joint roughness coefficient jrc from 0 to 20 then the surface morphology of rock fractures was digitized with a non contacted high precision optical scanner after that a series of water flow tests through sandstone fractures under different inlet water pressures and confining stresses σ 3 were carried out with the developed triaxial cell to further investigate the influence of regional asperity irregularity slip and non slip boundary condition on the fluid flow process the computational fluid dynamic cfd simulation was conducted for water flow through rock fractures of rectangular trapezoidal and triangular asperity elements respectively 2 theoretical background the well known navier stokes n s equations describe the motion of fluid through rock fracture very well which expresses the momentum conservation of fluid flow for the incompressible newtonian flow the n s equations can be written xia et al 2017 1 ρ u t u u p f μ 2 u where ρ ml 3 is the fluid density t t is the time μ ml 1t 1 is the dynamic viscosity of the fluid u lt 1 is the velocity vector of flow p ml 1t 2 is the fluid pressure and f mlt 2 is the body force vector acting on the fluid the n s equations contain four variables that need to be derived the n s equations describe fluid flow in fractured rock mass accurately nevertheless the existence of the convective acceleration term u u renders the equation to be nonlinear making it difficult to solve the equation efficiently especially for natural rock with complicated fracture morphology some simplified empirical formulas have been proposed for convenient engineering applications darcy s law has been used to describe the laminar flow through rock fractures at a low flow rate or reynolds number 2 q k 0 a μ p where q l3t 1 is the volumetric flow rate k 0 l2 is the intrinsic permeability and a l2 is the cross sectional area perpendicular to the flow direction assuming the flow conforms to darcy s law and simplifying that the rock fracture consists of two smooth parallel platens the cubic law can be derived from navier stokes equations 3 q w e h 3 12 μ p where w l is the fracture width and the eh l is the hydraulic aperture of the two smooth parallel platens according to eq 3 the permeability can be obtained 4 k 0 e h 2 12 to describe the nonlinear flow in a single rock fracture some empirical and semi empirical formulas were developed among them forchheimer s equation has been widely used in the form of a zero intercept quadratic relation 5 p a q b q 2 where a ml 5t 1 and b ml 8 are the model coefficients representing energy loss components due to viscous and inertial dissipation effects respectively in which a μ k 0 a and is related with the intrinsic permeability of the fracture media with regard to b it relates to the geometric properties of fracture and can be determined by empirically zeng and grigg 2006 zhang and nemcik 2013a showed that both coefficients a and b increase with confining stress in other words the nonlinear term coefficient b increased along with the decrease of fracture aperture alternatively izbash s law in the form of a power function has been proposed to describe the nonlinear fluid flow in rock fractures 6 p λ q m where λ and m are empirical coefficients experimental data show m varies from 1 to 2 for fluid flow in rock fracture bordier and zimmer 2000 qian et al 2005 zhang and nemcik 2013a as a dimensionless parameter reynolds number re has been commonly used to identify the onset of the transition from linear to nonlinear flow in fractured and porous media it is the ratio of inertial forces to viscous forces 7 re ρ v e h μ ρ q μ w where v lt 1 is the flow rate in the fractures q v a and a w e h 3 methodology 3 1 sample preparation the fine grain sandstone was taken from a quarry in chongqing china it is a grey white feldspathic sandstone with a natural average density of 2 49 g cm3 and an average porosity of 4 37 the x ray diffraction analysis shows that the sandstone is composed of 51 feldspar 28 quartz 15 other minerals and 6 clay matrix intact cylindrical rock samples of 50 mm in diameter were cored from a sandstone block in the laboratory then the cored sandstone samples were polished using the lapping machine to achieve two smooth and parallel ends approximately 100 mm in length the permeability of the sandstone samples is low ranging 10 16 10 17 m2 to obtain a variety of surface roughness fractured samples ten sets of the auxiliary splitting gadgets covering jrc from 0 to 20 were fabricated as shown in fig 1 each set is made up of a splitting wedge and splitting holder in case of specimen damage after cracking the curved wedges with different fracture roughness profiles were fabricated as follows firstly barton s profiles with the joint roughness coefficient jrc between 0 and 20 were imported into the computer then these curved profiles were carved on the stainless metal using a digitally controlled machine dc 50b the carved wedges were quenched and thermally handled to improve the stiffness corresponding to typical fracture profiles of jrc from 0 to 20 ten sets of cracking wedges were prepared in total fig 1 the cored sandstones were split into two fracture halves using the fabricated splitting wedges under the quasi static compression fig 1 consequently ten fractured samples of different fracture profiles were prepared and their geometrical dimensions are listed in table 1 even though ten sets of fracture roughness were prepared with different curved splitting wedges the mean fracture surfaces were maintained to be along the longitudinal direction and perpendicular to the two parallel cylindrical ends therefore the normal stress of the rock fracture is approximately to the lateral confinement in the triaxial cell 3 2 fracture roughness measurement the fracture surface morphology was measured using a 3d non contact optical scanner cronos dual open technologies inc italy the measurement accuracy is 0 1 mm in the horizontal direction of the fracture surface and the resolution is 0 02 mm in the elevation direction multiple scans from different angles of view were performed on the same fracture surface of each sandstone sample the data of multiple images from multiple scans are merged into one topographic image data to eliminate blind data spots caused by a single scan the merging of multiple image data was conducted in the instrumental software by matching a limited number of marked reference points note that the marked reference points are not on the same straight line fig 2 shows the asperity height distribution of the fracture surface each fracture surface was divided into ten equally spaced sections along the flow direction and nine representative 2d profiles from the upper surface of the fractured sample were extracted fig 3 shows the fracture profiles of prepared fracture samples it can be seen that the average fracture profile morphology of most sandstone samples is generally similar to the corresponding barton s empirical profiles the statistical parameters the peak asperity height ξ and the arithmetic average of asperity height ra of fracture surfaces were analysed to quantitatively characterize the fracture surface roughness 8 ξ z max z min 9 r a 1 n i 1 n z i where n is the total number of data points forming a profile line zi is the asperity elevation zmax is the maximum asperity height and zmin is the minimum asperity height the specified jrc of each fractured sample was determined empirically tse and cruden 1979 10 jrc 32 2 32 47 log z 2 11 z 2 1 n 1 i 1 n 1 z i 1 z i 2 x i 1 x i 2 1 2 where z 2 is the root mean square of the first derivative of the profile height xi zi and xi 1 zi 1 represent the coordinate of adjacent points on the profile in jrc determination the sampling interval of 0 5 mm was selected tatone and grasselli 2010 the calculated roughness parameters and jrc were averaged over the nine profiles and are listed in table 1 the results show that the jrc ranges from 8 9 to 19 0 for fracture samples it is worth noting that there is significant difference in jrc between the calculated one with statistical roughness parameter z2 and that evaluated with the barton s jrc despite the similar geometric fracture profiles for instance the jrc calculated by eq 10 is 14 9 whereas the jrc range given by barton s jrc is 10 to 12 for fracture profile s6 the reason is that the barton s jrc profiles are two dimensional while the harvested ten sandstone fracture samples are three dimensional even though the harvested ten sandstone fracture samples are prepared with the barton s jrc curved wedges the fracture profiles along the direction perpendicular to the flow direction still show heterogeneity 3 3 test set up and procedure the experiments of fluid flow through a single rock fracture under different confining stresses were conducted in laboratory using an upgraded triaxial flow testing system the system consists of a triaxial cell loading unit water supply unit monitoring unit and a computer aided data acquisition unit as schematically demonstrated in fig 4 the pressurized water entered the rock fracture from the triaxial cell base going through the fractured sample and flows out of the triaxial cell through the top cap after the water flow stabilized the mass of the discharged water was recorded over a fixed time interval using a sensitive electrical balance scale with a precision of 0 01 g prior to the test rock fracture was enclosed with 1 mm thick heat shrinkable sleeve membrane and two grooved circular platens were placed onto the upper and lower ends of fractured sandstone sample to enable water to evenly access the whole fracture width fig 4 the enclosed fractured sandstone sample was fixed to the top and bottom caps subsequently the triaxial cell was assembled at the beginning a low level of axial stress of 1 mpa was applied to the both ends of the fractured sandstone sample during the tests to hold the fractured sandstone sample in the triaxial cell then the triaxial cell was filled with silicone oil by a servo controlled hydraulic pump and the confinement was applied to 1 mpa by the pressurized oil after that the water flow tests started following the experimental plan the confining pressure was raised step by step from 1 mpa to 8 mpa with an increment of 1 mpa and the water flow tests of different pressure gradients were conducted at each required confining stress level during the tests water pressure control was applied in the fluid flow experiment the confining stress inlet and outlet water pressure was continuously recorded by pressure transducer the head pressure difference is equal to the inlet water pressure minus the outlet water pressure note that the water pressure should be lower than the specified confining stress by approximately 200 kpa during the tests to prevent the collapse of the fractured sample within the triaxial cell 4 results and discussion 4 1 flow rate in terms of pressure gradient the fluid flow tests were performed under room temperature of approximately 20 c for the relatively low permeability and average porosity 4 37 the rock matrix is assumed to be impermeable when compared to water flow through rock fractures the water was assumed to be incompressible with a density of ρ 1 103 kg m3 and dynamic viscosity of μ 1 10 3 pa s fig 5 shows the relationship between water pressure gradient p and the measured volumetric flow rate q of mated sandstone fracture samples under confining stresses from 1 to 8 mpa obviously the flow rate increased with the water pressure gradient however the flow rate does not uniformly follow a linear relationship in terms of the pressure gradient noted that the number of flow data points under the low confining stress is relatively less than that of under the relative high confining stress the reason is that the injected water pressure needs be maintained lower than the confining stress to prevent the sample collapse and the fluid leakage between the sleeve membrane and fracture sample chen et al 2015 zhang and nemcik 2013a fig 5 also shows that the flow rate decreased with the increase of confining stress under the same water pressure gradient which is due to the fracture closure by the enhanced confining stress additionally the slope of the water pressure gradient in terms of volumetric flow rate became steeper as the confining stress increased from 1 to 8 mpa this reflects the evolution in flow resistance that is with the increase of the confining stress fracture aperture decreased and flow path tortuosity increased resulting in the increase in flow resistance 4 2 identification of fluid flow patterns to further investigate fluid flow regimes in all sandstone fracture samples the ratio of volumetric flow rate q to hydraulic gradient j against the hydraulic gradient is used to depict the flow data here hydraulic gradient j is defined as the ratio the pressure drop to fracture length along the flow direction j p i p o ρgl where the p i ml 1t 2 and p o ml 1t 2 are fluid pressure at inlet and outlet respectively g lt 2 is the gravitational acceleration fig 6 shows the curves of q j versus j as fluid flow through sandstone fractures the flow pattern of the whole flow process can be easily identified from the curves as shown in fig 6 according to the experimental data an overall increasing trend in q j was observed at the relatively small values of j for all rock fracture samples fig 6 even though slight fluctuations can be observed this means that the increasing rate of volumetric flow rate increased at this stage and a non linear flow pattern appeared at the low j which is recognized as the pre linear flow noted that the pre linear flow is not apparent under the low confining stress with further increase of j q j shows different flow patterns for different sandstone fracture samples under various confining stresses for the trend of q j being almost invariable with the increase of j fluid flow regime is identified as linear flow pattern such as the fracture sample no 1 under the confining stress of 5 mpa however a decreasing or increasing trend of the q j with the increase of hydraulic gradient j is identified as the post linear flow pattern such as for fracture samples nos 1 and 10 under the confining stress of 5 mpa based on the analysis above the non uniform flow patterns occurred in different sandstone fracture samples with different surface roughness under various confining stresses which includes pre linear linear and post linear flow based on izbash s equation zhang and nemcik 2013b introduced flow resistance r ml 5t 1 r p q c q n 1 ρ μ w p re to analyze flow pattern defining that the constant flow resistance with n 1 represents linear darcy s flow while n 1 represents non darcy flow fig 7 shows the relationship of the flow resistance versus reynolds number for all fracture samples under different confining stresses taking the fracture sample no 8 in fig 7 for example flow resistance dramatically decreased at a low range of reynolds number corresponding to n 1 confirmed that the pre linear flow occurred with the increase of reynolds number the flow resistance kept approximately as a constant corresponding to n 1 representing linear darcy s flow fig 7 also shows that flow resistance showed either an increase or decrease trend at the higher reynolds number corresponding to n 1 or n 1 such as fracture samples nos 8 and 1 under the confining stress of 4 mpa this indicates that the post linear flow occurred again fig 7 confirms that two non linear flow patterns sequentially occurred with the increase of pressure gradient the former occurred before the fluid flow entering the linear darcy s stage and the other one occurred after darcy s flow stage the mated rock fractures are used in this study it can be observed that the post linear flow only occurred with increase of reynolds number under certain circumstances and the linear flow still holds for most cases the reason is that the initial fracture aperture of mated rock fracture samples is small and the fracture aperture further decreases with the increase of confining stress as a result the range of reynolds number is relatively small and it is commonly limited to 0 10 however the post linear flow occurs in some fracture samples even within the same reynolds number such as fracture sample no 8 this indicates that the post linear flow is also related to the specific fracture roughness therefore the occurrence of post linear flow can be ascribed to the combined effect of the fracture aperture flow velocity and fracture roughness rather than a single factor due to the complex mechanism of post linear flow the influence of regional roughness and the irregularities of asperity needs to be further investigated 4 3 the type of flow regime transition in fracture samples based on analysis above four representative types of water flow evolution were observed in mated rough rock fractures under various confining stresses fig 8 in the first type both pre linear and linear flow patterns occurred without the presence of post linear flow fig 8a this type of fluid flow regime transition becomes more common for rock fractures subjected to relatively high confining stresses i e σ 3 5 8 mpa where the rock fracture can close more tightly in the pre linear flow stage the flow rate increased with the water pressure nonlinearly but the increase rate of normalized flow rate in terms of hydraulic gradient gradually lowered until ceased to be invariable exhibiting a similar fluid flow behavior of the non newtonian fluid flow di federico 1997 liu and birkholzer 2012 zhou et al 2015 it is known that water is a kind of newtonian fluid and the mechanism of this pre linear flow may be attributed to the slippage effect between fracture walls and fluid due to water solid interaction which can reduce the drag friction between the fluid and the boundary walls of fracture as fluid flows slowly through rough walled rock fracture the fluid velocity is not zero on the rock walled surfaces fig 9 shows the slip boundary condition of fracture walls and it can be implemented via navier slip boundary condition u s l s u z wall brochard and degennes 1992 zhou et al 2020 where us lt 1 is the velocity vector at fracture wall ls l is the slip length and u z t 1 is the velocity gradient in the direction normal to the fracture surface the condition that ls 0 represents that fluid flow follows no slip condition at the wall surface the navier slip boundary condition has been confirmed for its validity in flow path of a nanoscale and microscale aperture chen et al 2015 lee et al 2007 wang et al 2016b zhang et al 2013 with the increase of confining stress the rock fracture was further compacted to close tightly and the tight rock fracture can be approximated to clusters of connected and isolated pores furthermore the seepage mechanism characteristics in the rock fractures are changed for instance the flow rate decreased nonlinearly with an increase in the confining stress wang et al 2021a in addition the clusters of connected and isolated small pores are conducive to the appearance of the slippage effect when the slippage occurs the loss of pressure drop for flow drive decreases compared to the no slip boundary condition which can indirectly enhance fracture hydraulic conductivity accordingly the excessive discharge contributes to the nonlinearity of flow to compare the resultant difference in fluid flow behavior of rock fracture computational fluid dynamic simulation was conducted for fluid flow through rock fracture channel under both the slip and no slip boundary condition by holding the fluid pressure difference between the inlet and outlet of the fracture model 10 pa fig 10 shows an example of the difference in the velocity field in the fracture flow with no slip and slip boundaries under the no slip boundary condition fig 10a the section line velocity perpendicular to the main flow direction fits well with the hagen poiseuille flow in the fracture model where the flow velocity along the boundary wall is zero however a noticeable deviation away from the hagen poiseuille flow was observed for the slip boundary case in addition the flow velocity in the slip boundary is greater than that of no slip boundary although the velocity of pre linear flow phase is relatively small it is of significance for leakage assessment and optimization design in many rock reservoirs i e oil and gas exploitation hazardous waste control and groundwater resources protection in the second type a three stage flow pattern appeared such as rock fracture sample no 10 at the confining stress of 4 mpa fig 8b where fluid flow tends to be pre linear at small values of j followed by a linear flow when the pressure gradient j reaches and exceeds somewhat high value and finally q j slightly decreased in terms of j illustrating a weak post linear flow pattern at higher j this three stage flow pattern is prevalent at moderate confining stress condition such post linear flow could be attributed to the inertial effect another three stage flow pattern was also observed in rough walled rock fracture such as rock fracture sample no 1 under the confining stress of 5 mpa fig 8c where the pre linear linear and post linear flow patterns sequentially appeared with the increase of pressure gradient however it is noted that this post linear flow is different from the post linear flow mentioned above showing a slightly downward increase trend in curves of pressure gradient versus volumetric flow rate i e sample 1 in fig 5 one possible reason is that the fracture aperture increased abruptly at some high water pressure gradient and consequently the increasing rate of volumetric flow rate increased fig 8d shows the fourth type of fluid flow regime transition where a two stage flow pattern linear and post linear flow appeared with the increase of j at small j the flow tended to be linear and transited to be post linear at high values of j this type of fluid flow regime transition generally occurred at relatively low confining stress circumstance where the pre linear flow does not exist due to large fracture aperture even at small values of j 4 4 effect of confining stress on flow regime transition the flow pattern analyses above also show that the pre linear flow is not significant or may not appear at low confining stresses due to the large fracture aperture with the increase of confining stress there is a relatively stable pre linear flow stage at low flow velocity therefore confining stress affects the flow patterns to more clearly understand the effect of confining stress on the flow pattern fig 11 shows the evolution of q j with respect to j for rock fracture samples under confining stresses of 5 6 7 and 8 mpa it can be seen that the variation in q j against j followed an exponential function and the fitting curves show a very similar trend for different fracture samples in fig 11 the pre linear flow stage is highlighted approximately in cyan it shows that the critical hydraulic gradient of the fluid flow transition from pre linear to linear flow increased with the increase of confining stress the influence of confining stress on the fluid flow regime transition can be attributed to the change of fracture aperture when rock fractures are subjected to confining stress the fracture will close further reducing the fracture aperture fig 12 shows the variation in the normal deformation versus confining stress of intact and fractured sandstone samples used in the test there is an approximate hyperbolic function between normal deformation and confining stress bandis et al 1983 li et al 2016 saeb and amadei 1992 also the lateral deformation of intact sandstone is much smaller than that of fractured sandstone indicating that the fracture dominates in the normal deformation under compaction for further analysis the equivalent hydraulic aperture eh under a specific amount of confining stress was calculated using cubic law e h 12 μ q w p 1 3 with the data of linear flow phase and plotted in fig 13 a the hydraulic aperture decreased with an increase in confining stress following a hyperbolic function trend and it varies approximately from 5 μm to 40 μm for sandstone fracture samples at the confining stress of 1 to 8 mpa among all rock fractures rock fracture sample no 8 has the largest hydraulic aperture under the same confining stress this may be related to the high asperity of fracture surface of rock fracture sample no 8 fig 13b shows the variation of the peak asperity roughness parameter and hydraulic aperture of rock fracture samples overall the hydraulic aperture has a positive correlation with the peak asperity height 4 5 the influence of slip boundary and asperity irregularity on low velocity flow in the real fluid flow through open rock fractures the fluid flow regime is influenced by the three dimensional volume confined by the two rough fracture walls while the fluid flow regime in the closed rock fractures is influenced by fracture roughness aperture and contact areas making the flow pathway tortuous and forming preferential flow this is a very complicated situation due to the waviness variation of fracture surface over the whole flow direction chen et al 2021 rong et al 2020 zhang and nemcik 2013a the experimental data above have shown the appearance of pre linear linear and post linear flow of fluid flow through rock fractures however the bulk flow experimental tests in the triaxial cell constrains the specific flow process observation making the quantitative evaluation of the influence of the individual factors on the flow regime transition is impossible therefore cfd modeling was conducted to analyze the influence of individual factors on the fluid flow regime transition in rock fractures the asperities along the fracture surfaces cause the geometric irregularity affecting fluid flow behavior to investigate the influence of fracture roughness on pre linear flow three two dimensional 2d fracture models with the same length and height but with rectangular trapezoidal and triangular asperity elements were numerically developed while holding the same fracture aperture 0 5 mm fig 14 the navier stokes equations eq 1 were solved for three fracture models with the finite element method in comsol multiphysics constant pressure from 1 to 100 pa were applied at the inlet boundary and the hydraulic pressure at the outlet boundary was set to zero both the slip and no slip cases were considered as the wall condition of fracture for the slip boundary case the slip length l s is assumed to be a constant and l s is determined using the following equation zhou et al 2020 13 l s c 1 c 2 c 3 e where e l is fracture aperture size approximately equal to 500 µm in the established model c 1 8 9648 c 2 1 1573 and c 3 0 9956 the values of c 1 c 3 are obtained by fitting the functional relationship between ls and the fracture aperture e based on the calibration flow experiments conducted by lee et al 2007 zhou et al 2020 therefore the slip length ls 8 84 μm fig 15 shows the evolution of flow rate against hydraulic gradient in the fracture models for different flow channels the flow rate increased with hydraulic gradient in a similar manner it can also be seen that the flow rate is significantly greater at the slip boundary than that of the no slip boundary at ls 8 84 μm the difference of flow rate between the slip and no slip boundaries under the same hydraulic gradient is around 10 indicating that the hydraulic conductivity of rock fracture is enhanced as the slip condition of fracture walls reduces the drag friction between the fluid and the fracture walls therefore the excessive flow can be attributed to the fluid slippage effect causing the pre linear flow fig 15 also shows that the flow rate is not equal among different rock fractures despite the fact that all fractures subjected to the same hydraulic gradient this may be caused by the difference in asperity shape in contrast the hydraulic conductivity of fracture of triangular shape asperity is the highest while the fracture with rectangular shape asperity is the lowest illustrating that the rectangular asperity affects fluid flow more significantly for the no slip boundary the difference of flow rate in different rock fractures can be ascribed to the inconsistent fracture asperity shape while for the slip boundary case the difference of flow rate in different fractures is the result of the combined effect of the inconsistent fracture asperity shape and the slippage effect fig 15d shows that under the slip condition the slip flux an additional flow rate due to slip at the solid liquid of triangular asperity is largest while that of rectangular asperity is smallest it is known that the boundary slippage is also affected the fracture roughness wettability hydrophobicity and hydrophilicity of the surface microscopically bonaccurso et al 2003 cottin bizonne et al 2005 lee et al 2014 vinogradova 1995 it seems that triangular asperity enhanced the hydrophobicity of the surface for fluid flow through real rock fractures the fracture surface morphology and void geometry are much more complicated than the simulated cases and a variety of factors such as flow tortuosity void heterogeneity and aperture could influence the boundary slip condition here only the influence of rectangular trapezoidal and triangular asperity conditions on the fluid flow process was considered further assessment is needed to describe the influence of real rough fracture on the slip boundary condition in addition as fracture aperture size increase the slip length of the slip boundary also increases lee et al 2007 therefore the slip flux also increases under the same hydraulic gradient a rock fracture of a high and steep asperity may own a larger fracture aperture as shown in fig 13b causing the slip flux may be relatively larger in such a rock fracture the analysis above has illustrated the influence of slippage boundary on the fluid flow regime at the low flow velocity condition however the determination of the slip boundary condition is essential to demark the start and ending of the pre linear flow under the slip boundary condition the slip velocity us 0 while us 0 for non slip boundary condition therefore at the microscopic scale boundary slip can be determined with some measurement techniques such as micro particle image velocimetry ou and rothstein 2005 near field laser velocimetry hervet and leger 2003 surface force apparatus baudry et al 2001 and atomic force microscope bonaccurso et al 2003 4 6 the influence of asperity irregularity on high velocity flow in the fracture models mentioned above fluid flow in fractures deviates from the linear flow to form a non linear flow with the increase of hydraulic gradient from 0 2 to 2 0 that is the post linear flow stage the forchheimer equation describes the flow data numerical modeling very well fig 16 a where the fracture wall condition is only set as a no slip boundary the flow rate of the fracture model with rectangular asperity element was smaller than those of trapezoid and triangle while under the same hydraulic gradient indicating that the rectangular asperity element affects the fluid flow more significantly fig 16b c and d show the velocity contours and streamlines at the interval x 0 015 m 0 026 m along the flow direction under a hydraulic gradient of 2 0 the evolution of streamlines indicates that obvious eddy flow occurred at the corners of the asperity element at the post linear flow stage the nonlinearity of fluid flow in fractures is essentially ascribed to the inertial effects which is due to high flow velocity or the effect of fracture roughness when fluid flows through rough walled rock fracture the presence of asperity on the fracture surface enhances flow resistance furthermore the localized eddy flow consumes extra pressure drop and reduces the effective discharge in the fractures it can also be observed that the backflow region in the rock fracture with the rectangular asperity element is larger than that of the fractures with trapezoidal and triangular asperity elements indicating that the rectangular asperity element causes the largest obstruction to fluid flow when compared to trapezoidal and triangular asperity elements in terms of the triangular trapezoidal and rectangular asperity elements these asperity elements exhibit different geometric features and this factor is the main reason for the difference in fluid flow in the fractures with these asperity elements 5 conclusions the study investigated the fluid flow regime transition rough rock fractures considering the influence of different fracture roughness aperture and asperity irregularity ten sets of wedges corresponding to jrc from 0 to 20 were fabricated to obtain the rock fractures of different surface roughness a series of water flow tests were conducted on sandstone fractures using the developed triaxial fluid flow test system under confining stresses from 1 mpa to 8 mpa the influence of asperity irregularity slip and non slip boundary walls on the fluid flow was further investigated by performing fluid dynamic computation by analysing the evolution trend in q j with respect to j three flow regimes the pre linear linear and post linear flow were identified for water flow through mated sandstone fractures an initial pre linear flow pattern at very low flow rates and then a linear flow pattern with the increase of flow rate and finally the post linear flow pattern at high flow rates the pre linear flow is attributed to the fluid slippage on the fracture wall in the pre linear flow stage the fracture roughness and aperture mainly affect the fluid slippage and hence the fluid flow in addition numerical simulation shows that the slip flux per unit width in the fracture with triangular asperity element is largest while that of rectangular asperity is smallest also the critical hydraulic gradient for fluid flow regime transition from pre linear to linear flow increased with the increase of confining stress in contrast the post linear flow is mainly ascribed to the inertial effect due to the increase of flow velocity caused by the increase of hydraulic gradient and the effect of fracture surface roughness in addition numerical simulation shows that the discharge per unit width in the fracture with triangular asperity element is highest however it becomes the smallest in the fracture with rectangular asperity element implying that the rectangular asperity element influences the fluid flow more significantly credit authorship contribution statement yong luo conceptualization methodology formal analysis writing original draft data curation formal analysis software zhenyu zhang conceptualization methodology supervision writing review editing funding acquisition project administration yakun wang writing review editing jan nemcik writing review editing resources jiahua wang methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was financially supported by the national natural science foundation of china no 51674047 and 51911530152 
