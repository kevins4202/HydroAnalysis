index,text
3070,models provide quantitative solutions that enable better understanding of karst soils hydrology a location in central spain was selected to implement a 1 d hydrological model that uses a reservoir cascade scheme rcs approach to simulate soil water content swc at daily resolution the model simulates swc for six soil layers and includes additional modules to reproduce preferential flow regime the soil profile in the model is 0 5 m deep developed in silt loam soil on top of dolomite marbles three different configurations of the model were considered configuration 1 considers a basic rcs module whereas other configurations include preferential flows thus configuration 2 considers rcs module together with a continuous preferential flow module where 1 to 5 of available swc from each layer is drained every day along preferential pathways configuration 3 contains a discontinuous preferential flow module in addition to previous modules the discontinuous preferential flow is only activated during rainfall events occurring after long dry periods simulated swc values are compared with measured swc values so model parameters are iteratively adjusted to optimize the model results the model produces the best simulations implementing the configuration 3 when matrix flow and two preferential flow regimes are considered the model shows that preferential flows significantly contribute to recharge and should not be neglected in soil hydrological models and recharge estimations in karst areas keywords karst soil hydrological model reservoir cascade scheme recharge macroporosity preferential flows data availability data will be made available on request 1 introduction approximately quarter of world s population partially or completely depends on water resources from karst underground ford and williams 2007 thus understanding of water dynamics in karst areas is of crucial importance before reaching the aquifer water passes through soil epikarst and vadose zone where it is subject to different processes which impact its properties berthelin et al 2020 soil is the first media controlling quantity and quality of water reaching the aquifer williams and fowler 2002 tooth and fairchild 2003 clothier et al 2008 charlier et al 2012 thus to understand water dynamics in karst systems it is necessary to first understand transport and distribution of water in soil soil moisture is one of the important components involved in complex dynamics between climate soil water and vegetation lin et al 2005 monitoring soil water dynamics enables understanding soil in terms of natural filter and buffer medium which is an important property since karst areas are highly vulnerable to contamination lin et al 2005 keestra et al 2012 wu et al 2021 to understand describe and predict water movement in soil different models are being used richards 1931 jones and kiniry 1986 manabe 1969 williams et al 1989 littleboy et al 1992 vanclooster et al 1994 raes 2002 jones et al 2003 šimůnek et al 2008 van dam et al 2008 westenbroek et al 2010 arnold et al 2012 huth et al 2012 models are approximations of a real world and the best models are considered to be the ones which give results closest to reality and at the same time require least number of parameters and model complexity wheater et al 2007 since porosity and permeability of soluble rocks are difficult to predict daly et al 2002 water flow is also difficult to model and to predict two major approaches are commonly used when simulating soil water movement 1 numerical solutions of richards equation richards 1931 and 2 reservoir cascade scheme mao et al 2018 the major processes employed in these two approaches are similar but the level of detail differs significantly ranatunga et al 2008 models based on richards equation solve hydraulic and hydrodynamic equations that describe water flow in porous media ranatunga et al 2008 and are considered appropriate if the modeller has obtained physical data and needs to know the fluxes and potentials by depth riha et al 1994 although these kinds of models provide detailed mathematical explanation of water flow in porous media at the same time they require big amount of input parameters which are not always available ma et al 2013 the most common alternative to simulate soil water content swc and movement are the so called reservoir cascade scheme rcs models which solve water balance in soil by using simplified or empirical equations zha 2014 mao et al 2018 these models are also known as tipping bucket models manabe 1969 jones and kiniry 1986 riha et al 1994 raes 2002 jones et al 2003 kendy et al 2003 westenbroek et al 2010 arnold et al 2012 abeysingha et al 2015 since they consider soil as a unit made of imaginary layers i e buckets or reservoirs each reservoir gains and loses water by major hydrological processes which include precipitation runoff plant interception evaporation transpiration infiltration redistribution and drainage or deep percolation ranatunga et al 2008 mao et al 2018 soil field capacity fc is considered a key parameter in the rcs approach since it represents a threshold that controls processes of drainage and runoff in a way that drainage and or runoff are limited to events when swc exceeds fc of a certain layer romano et al 2011 these kinds of models are useful when some of the parameters are not available i e when the modeller has data only on soil moisture contents at various field moisture states which provides information on saturation field capacity and permanent wilting point and only needs to know the moisture content by depth riha et al 1994 this is often the case in karst mediterranean soils where due to high rockiness and shallow soil depths lange et al 2010 yaalon 1997 it is difficult to obtain dense measurement networks coppola et al 2013 karst areas generally lack well developed surface drainage due to high porosity and permeability of carbonate rocks simms 2014 thus the water flow in their unsaturated zone is mostly considered vertical dal soglio et al 2020 to simulate soil drainage models in pure karst areas consider only one dimension 1 d flow e g comas bru and mcdermott 2015 domínguez villar et al 2021 while runoff is considered negligible when studying soil water movement it is important to differentiate between different types of water flow in soils apart from matrix flow preferential flows are important phenomena and although widely studied they are still a feature misrepresented in models simulating the water content and its movement in soils flury et al 1994 allaire 1997 buttle and mcdonald 2002 šimůnek et al 2003 gazis and feng 2004 gärdenäs et al 2006 jarvis 2007 lin and zhou 2008 luo et al 2008 mooney and morris 2008 roulier et al 2008 legout et al 2009 preferential flows are defined as all phenomena where water and solutes move along certain pathways while bypassing a fraction of the porous matrix hendrickx and flury 2001 clothier et al 2008 allaire et al 2009 distinguish four types of preferential flow crack flow preferential flow along continuous cracks in soil burrow flow flow along channels produced by soil fauna finger flow preferential flow that occurs at the interface between soil layers of different texture and lateral flow water moves laterally along an inclined hydraulically restrictive layer furthermore allaire et al 2009 define macropore flow as flow composed from crack flow and burrow flow tooth and fairchild 2003 distinguish soil matrix and macropore flow and emphasize that matrix flow dominates during dry periods while macropore flow is important during recharge lange et al 2010 as well noticed that during dry conditions preferential infiltration and percolation are limited compared to situations when soil is wet and much quicker vertical flow occurs preferential flows in soils are described using dual porosity dual permeability multi porosity or multi permeability models which are mostly based on combining richards equation with composite equations for the hydraulic properties or kinematic wave equations van genuchten and wierenga 1976 pruess and wang 1987 gerke and van genuchten 1993 gwo et al 1995 hutson and wagenet 1995 šimůnek et al 2003 still modelling of preferential flows represents a challenge since coupling of fracture and matrix domains is not trivial šimůnek et al 2003 sternagel et al 2019 preferential flows are particularly important in karst areas since they enable rapid and abrupt water percolation through the soil profile without possibility of soil to filter water and buffer chemical processes clothier et al 2008 kan et al 2019 mediterranean karst soils are often shallow and rocky lange et al 2010 yaalon 1997 due to such characteristics it is often difficult to obtain detailed soil water measurements and thus extensive number of parameters required to run certain models therefore the rcs approach is often the best approach to simulate water content in such soils here we develop a 1 d model at daily resolution following the rcs approach the model simulates water content for six soil layers and identifies two different preferential flow patterns the model also estimates the amount of water that enters as recharge from the soil to the karst underneath the study site was selected since there is a cave underneath and a better knowledge of water flow dynamics above the cave is of key importance for understanding the cave hydrology in detail improving cave managing and contributing to further scientific research in this location 2 regional setting the study site 40 9 15 n 5 4 20 w is located above eagle cave in tietar valley within the ávila province in central spain fig 1 a the soil site is in a hill with a general moderate slope i e 15 to 20 however the slope is not gradual since frequent rock outcrops concentrate most of the altitudinal differences whereas soil patches have gentle slopes or levelled surfaces fig 1b and 1c there are no runnels or gullies developed on slopes of the hill that would show evidence of runoff there are no depressions along the surface of the slope because soil patches smooth the typical karst dissolution features at the top of epikarst nevertheless there are clint and grikes developed under soil patches resulting in enclosed depressions i e dm to m in scale that can be observed when digging soil pits between rock outcrops the bedrock is composed of marbles of cambrian age martín escorza 1971 characterized by dolomite mineralogy here magnesite is a common mineral while goethite is the dominant accessory component krklec et al 2016 such carbonate outcrops are karstified and have increased permeability mapa hidrogeológico de españa 1991 the soil profile is quite uniform approximately 60 cm thick fig 1d without a visible a horizon and only a discontinuous patchy o horizon 1 cm thick thus the profile is represented by a typical red b horizon with a homogeneous granular structure through the full profile granules of this structure are typically 1 to 2 mm in diameter favouring macropores between them the contact with the bedrock is sharp and irregular lacking a c horizon the irregularity at the base of the soil represents already weathered epikarst with narrow cracks i e cm to dm scale wide resulting in typical clint and grikes subsoil topography fig 1 major mineral components of the soil are iron oxides giving characteristic red colour to the soil quartz feldspar and kaolinite where amount of iron oxides increases with depth krklec et al 2016 soil of the wider study area is classified as chromic cambisol and chromic luvisol forteza bonnin and lorenzo martín 1988 local meteorological conditions are recorded in a station operative since 2009 located 100 m from the experiment site mean annual temperatures recorded during 2019 2020 and 2021 were 15 0 c 15 3 c and 14 9 c respectively with maximum values of 32 6 c july 2019 31 3 c july 2020 and 30 3 c august 2021 and minimum values of 0 3 c january 2019 1 1 c january 2020 and 1 2 c january 2021 total amount of precipitation during 1 year period was 474 01 mm 2019 563 37 mm 2020 and 550 96 mm 2021 with maximum monthly values of 187 31 mm december 2019 103 75 march 2020 and 127 46 mm september 2021 and minimum monthly values of 1 03 mm june 2019 0 56 mm february 2020 and 1 15 mm march 2021 the area has an evergreen oak forest with patchy shrub cover underneath 3 methods 3 1 soil monitoring station and analyses a soil monitoring station equipped with frequency domain sensors ec 5 5te 5tm connected to a decagon em50 device was installed in 2018 at the study site fig 1e sensors positioned at depths of 10 20 30 40 and 50 cm in the soil are measuring swc m3 m3 at 1 hour intervals the meteorological station provides data on amount of precipitation and temperature at 10 minute intervals prior to soil sampling terrain reconnaissance was performed to select the most representative location for soil pit soil sampling was performed in december 2019 from the soil profile where undisturbed samples were collected samples were collected along the profile at 5 cm depth intervals up to the depth of 65 cm depth of the parent rock using 100 cm3 soil cylinders laboratory analyses were performed to determine basic soil properties swc and fc were measured by gravimetric method iso 11461 2001 bulk density bd was measured after drying the soil at 105 c iso 11272 2017 while particle density pd was measured in water using 100 ml pycnometer iso 11508 2017 total porosity tp and air filled porosity ac were calculated according to danielson and sutherland 1986 soil particle size distribution was measured by the robinson pipette method with wet sieving and sedimentation after dispersion with sodium pyrophosphate na4p2o7 0 4 m iso 11277 2009 while soil ph was measured using combined glass electrode in a 1 5 ν ν suspension of soil in water and soil in kcl solution c 1 m swc values measured on sensors were calibrated with swc values measured in the lab on the undisturbed soil samples collected in december 2019 3 2 concept of the model in order to simulate water movement through the karst soil we developed a 1 d model at daily resolution which simulates swc the model assumes no runoff or sub surface lateral flows as typically considered in hydrological models of karst the vadose zone e g comas bru and mcdermott 2015 domínguez villar et al 2021 a scale of 1 day resolution is chosen since it is more than enough to understand most of the key karst hydrology processes for which the model is designed thus the model ignores any lag time related to infiltration through the soil observations on the studied soil support its good drainage with a quick response to infiltration events i e within 24 h through the full soil profile supporting the assumption of synchrony in the hydrological response through the soil at daily resolution this assumption enables to simplify the model a key characteristic of a good model wheater et al 2007 the model is developed using the rcs approach where the soil column is divided in six imaginary layers i e reservoirs located at depths of 0 5 5 10 10 20 20 30 30 40 and 40 50 cm under the soil surface each layer gains water through drainage from the levels above and loses water by evapotranspiration or down flow parameters used in the model are listed in table 1 while characteristics of soil layers and values of used constants are reported in table 2 values of all used thresholds and constants were set to obtain highest correlation between measured and modelled data and are constant through time thickness of soil layers used in the model was set to range between sensors placed in the soil but to account for special soil hydrology conditions in the soil atmosphere boundary layer first 10 cm of the soil were divided in two layers therefore instead of five there are six soil layers used in the model thus the first layer is labelled as layer 0 and expands from 0 to 5 cm below soil surface this surficial layer has the highest evapotranspiration rate and prevents small precipitation events when soil conditions are relatively dry to be recorded in the soil layer 1 which is supported by observations recorded in the logger installed at 10 cm in depth the number of layers selected in the model has a limited impact on the results as shown in a sensitivity test performed with different number of layers supplementary material therefore the number of layers i e six layers was chosen to enable direct comparison of measurements and simulations that implies one layer per logger installed in the soil plus a zero layer or boundary layer to reproduce special dynamics between the soil and the atmosphere daily potential evapotranspiration was calculated using thornthwaite equation thornthwaite 1948 thornthwaite and mather 1957 pereira and pruit 2004 trajković 2005 1 pet 16 n 360 10 t k 1 12 0 2 t k 1 514 0 016 k 1 12 0 2 t k 1 514 0 5 where pet is daily potential evapotranspiration mm day n is maximum duration of sunlight h day t is average daily temperature c tk is average monthly temperature c and k is the month of measurement thornthwaite method is widely used for calculating potential evapotranspiration and is considered practical since the only required parameter is temperature although this method is not recommended for arid climate areas since evapotranspiration values could be significantly underestimated trajković 2009 the model here presented uses actual evapotranspiration aet instead of pet to correct such limitations however daily pet values are still considered in aet calculations since pet varies through the soil profile each layer is assigned a different fraction of the daily evapotranspiration we use summer periods for calculating those fractions since evapotranspiration rates without significant precipitation events allow discerning the amount of water losses dominated by evapotranspiration at different depths during these periods when swc was below fc differences in swc were calculated at each of the five depths in the soil where monitoring data is available water loss during these periods is completely attributed to evapotranspiration five different periods were selected for calculations soil water losses from all depths were added to calculate the total soil water loss for each period and the fraction of each layer was attributed in relation to that total soil water loss value the proportion of evapotranspiration implemented in each layer of the model was the result of averaging the results obtained during the five considered periods evapotranspiration for the uppermost 10 cm of the soil was divided between layer 0 and layer 1 in a way that a higher evapotranspiration percentage is given to the uppermost layer in agreement with the depth evapotranspiration gradient observed in the studied profile optimizing the correlation between observations and simulations daily aet for a particular layer is calculated applying the formula 2 aet i x d pet i swc real i 1 s w c r e s fc s w c r e s where aet is daily actual evapotranspiration mm day xd is fraction of aet for layer d d 0 1 2 3 4 5 swc real is real soil water content mm and swc res is residual soil water content mm i e water that is bond by adsorptive forces to soil particles so tight that it cannot be neither evapotranspirated neither drained the concept of swc res is similar to the parameter of soil permanent wilting point although is given a different name since the value is not obtained by the same procedure and absolute values of both parameters might differ swc res is obtained from the calibrated swc signal as the minimum swc expected during summer months the term swc real swc res refers to available swc i e water that is capable to either evapotranspirate or drain from the soil fc is the field capacity mm and i and i 1 represent the current day and previous day respectively the model is executed in three different configurations with three different modules configuration 1 contains module a basic rcs module configuration 2 contains module a and module b module which simulates continuous preferential flows while configuration 3 contains module a module b and module c module which simulates discontinuous preferential flows 3 2 1 configuration 1 basic rcs in the basic rcs configuration that only uses module a fig 2 layer 0 gains water when precipitation occurs and loses water by aet and drainage 3 swc pot i 0 swc pot i 1 0 prec i aet i 0 d i 1 0 where swc pot is potential swc value mm i e water content in the soil not limited by fc fc is the field capacity mm prec is precipitation mm aet is actual evapotranspiration mm d is drainage mm subscript 0 refers to the layer 0 and subscripts i and i 1 refers to the current and the previous day respectively data on precipitation are obtained from the meteorological station while fc value is obtained from calibrated swc sensor measurements during winter and spring larger rain events result in peaks of swc with similar maximum values the field capacity for each layer is slightly below those maximum swc values following those considerations the specific value of fc was set for each layer of the model when the correlation coefficients between simulations and observations were the highest real swc swc reali is the soil water content actually present i e simulated by the model in the soil and is defined as if swc pot i f c t h e n swc real i swc pot i if swc pot i f c t h e n swc real i f c when water content in a layer exceeds fc water starts draining to the layer underneath otherwise no drainage occurs if swc pot i f c t h e n d i swc pot i f c therefore the process of drainage represents water output from the upper layer and at the same time input for the layer below drainage from the deepest layer is considered as the recharge entering the vadose zone of karst since the model is designed for karst areas no runoff is considered thus in the configuration 1 we assume that recharge to karst occurs only when fc of layer 5 is exceeded for every layer below layer 0 swc poti is defined as 4 swc pot i x swc pot i 1 x d i x 1 aet i x d i 1 x where x represents the number of the layer x 1 2 3 4 5 3 2 2 configuration 2 rcs with continuous preferential flows configuration 2 assumes that on top of the module a that considers matrix flow drainage when fc of layer is exceeded there is an additional drainage accounted by module b which occurs as continuous preferential flows therefore module b assumes that every day specific percentage of available swc is drained from each layer along preferential pathways pf1 in the soil drainage accounted by module b occurs even if fc of the layer is not exceeded in the concept of configuration 2 fig 2 daily precipitation entering layer 0 is divided into 1 precipitation that enters matrix flow mf and 2 precipitation that enters continuous preferential flows pf1 5 mf i k mf prec i 6 p f 1 i k p f 1 prec i where kmf and kpf1 are fractions of daily precipitation prec mm and subscript i refers to the calculated day therefore potential soil water content swc pot for layer 0 is defined as 7 swc pot i 0 swc pot i 1 0 mf i p f 1 i dmf i 1 0 d p f 1 i 1 0 aet i 0 where dmf is drainage mm occurring when fc of the soil layer is exceeded while dpf1 is the component of drainage mm occurring as preferential flows and is defined as 8 d p f 1 i 0 k d p f 1 0 swc real i s w c r e s where kdpf1 0 is a fraction of available swc swc reali swc res which drains as pf1 kdpf1 is chosen for each layer to give the highest correlation between measured and simulated values for every next layer swc pot and dpf1 are defined as 9 swc pot i x swc pot i 1 x dmf i x 1 d p f 1 i x 1 dmf i 1 x d p f 1 i 1 x aet i x 10 d p f 1 i x k d p f 1 x swc real i s w c r e s where x is the number of a layer x 1 2 3 4 5 3 2 3 configuration 3 rcs with continuous and discontinuous preferential flows configuration 3 includes previous modules module a and module b and as well introduces a new module module c which includes preferential flows pf2 that only occur during particular meteorological conditions in the concept of the configuration 3 of the model fig 2 daily precipitation is divided into prec1 and pf1 11 p r e c 1 i k p r e c 1 prec i 12 p f 1 i k p f 1 prec i where kprec1 and kpf1 are fractions of daily precipitation prec pf1 refers to continuous preferential flows as part of module b explained already in the previous section while subscript i refers to the day of calculations prec1 is divided into matrix flow mf and discontinuous preferential flow pf2 13 p f 2 i k p f 2 p r e c 1 i if p f 2 i 0 t h e n mf i 1 k p f 2 p r e c 1 i if p f 2 i 0 t h e n mf i p r e c 1 i pf2 is activated during rainy days when pet is higher than a threshold thres 1 and daily precipitation is larger than a threshold thres 2 if pet i t h r e s 1 a n d prec i t h r e s 2 t h e n p f 2 i 0 when module c is operative a fraction of prec1 kpf2 enters the soil as pf2 while the rest of prec1 enters the soil as mf when pf2 has no flow 100 of prec1 enters the soil as mf therefore in the configuration 3 of the model the drainage from each layer is divided into drainage entering the layer as matrix flow dmf as continuous preferential flow dpf1 and as discontinuous preferential flow dpf2 potential soil water content swc pot for layer 0 is defined as 14 swc pot i 0 swc pot i 1 0 mf i p f 1 i p f 2 i dmf i 1 0 d p f 1 i 1 0 d p f 2 i 0 aet i 0 for every subsequent layer swc pot is defined as 15 swc pot i x swc p ot i 1 x dmf i x 1 d p f 1 i x 1 d p f 2 i x 1 dmf i 1 x d p f 1 i 1 x d p f 2 i x aet i x where subscript x is the number of a layer x 1 2 3 4 5 for pf2 an additional condition is introduced if the dpf2 from the layer above is higher than a threshold thres 3 certain fraction kdpf2 of pf2 directly drains to the layer below while the rest remains within layer accounting for soil water balance of the layer if p f 2 i t h r e s 3 t h e n d p f 2 i 0 k d p f 2 0 p f 2 i for layer 0 i e if d p f 2 i x 1 t h r e s 3 t h e n d p f 2 i x k d p f 2 x d p f 2 i x 1 for layers 1 2 3 4 and 5 where x is the number of a layer x 1 2 3 4 5 and x 1 represents the layer above it if the dpf2 from the above layer is less than threshold thres 3 100 of pf2 drains directly to the layer underneath i f p f 2 t h r e s 3 t h e n d p f 2 i 0 p f 2 i for layer 0 i e if d p f 2 i x 1 t h r e s 3 t h e n d p f 2 i x d p f 2 i x 1 for layers 1 2 3 4 and 5 where is the number of a layer x 1 2 3 4 5 and x 1 represents the layer above it the drainage that comes out of the layer 5 represents the recharge to the karst in this case recharge from soil to karst occurs every day due to pf1 component of module b and additional discontinuous recharge occurs when swc of soil layer 5 exceeds fc or pf2 in layer 5 operate 4 results results of analysed soil properties are shown in tables 3 and 4 values of swc at the time of collection ranged between 0 30 and 0 36 m3 m3 while fc values ranged between 0 44 and 0 52 m3 m3 average bulk density bd values are higher in deeper part of the soil profile 1 26 g cm3 at 30 65 cm compared to the shallower soil depths 1 08 g cm3 at 0 30 cm while average particle density pd values are negligibly higher in deeper soil parts 3 02 g cm3 at 0 30 cm and 3 06 g cm3at 30 65 cm average values of total porosity tp and air filled porosity ac are lower in deeper soil parts where tp is 64 3 at 0 30 cm and 58 8 at 30 65 cm while ac is 15 5 at 0 30 cm and 9 9 at 30 65 cm soil ph values measured in suspension of soil in water phh2o ranged between 6 43 and 7 02 while those measured in suspension of soil in kcl solution phkcl ranged between 5 75 and 6 45 textural analysis of soil samples table 4 showed that the most abundant soil fraction is silt coarse and fine silt 0 063 0 002 mm according to iuss working group wrb 2015 soil texture is classified as silt loam through the whole soil profile recorded swc m3 m3 signals during the period between may 2019 and august 2021 are shown in fig 3 measured water content is higher during winter and spring months ranging between 0 3 and 0 4 m3 m3 while during summer months swc decreases progressively until the end of the dry season when values range between 0 16 and 0 28 m3 m3 the model simulates swc for six different layers and provides results in mm while swc records are initially measured in m3 m3 thus for the purpose of comparing observations with modelled results the swc record values were transformed to mm of water in 10 cm thick soil layers unit transformation is made in a way that swc signal measured at the base of a level integrates all the water in that level e g signal measured at 20 cm is compared to simulated value of layer 2 measured and simulated swc signals for three different configurations of the model are shown in figs 4 6 when implementing configuration 1 which only considers module a the simulation produces good fit between modelled and recorded values during summer months on the contrary during winter and spring months the simulated swc keeps relatively high values whereas observed swc signal shows significant decreases in swc after rainfall events see arrows in fig 4 for major examples of simulation mismatches when implementing the module b in the configuration 2 the simulation better explains water content during winter and spring months see gray arrows in fig 5 but some of the peaks during summer months see black arrows in fig 5 which were already poorly simulated with configuration 1 still remain unexplained in configuration 2 when the configuration 3 of the model is implemented considering three modules at once the simulation optimizes the results during winter and spring months as well as during summer months fig 6 simulating all significant events recorded in the measured swc signals the coefficient of determination r2 was used to test the fit of the different simulations to the recorded observations figs 4 6 although configuration 1 already explains 70 of the variance of the recorded signal for all levels configurations 2 and 3 improves significantly the results of simulations that in the best scenario explains 80 of the full variance of all simulated levels when only the configuration 1 is implemented simulated recharge does not occur during summer months fig 7 in the case of configuration 2 simulated recharge to the karst occurs every day even during dry summer months although barely visible in fig 7 since the amount of recharge during summer is very limited configuration 3 enables higher amount of recharge to occur even during summer periods highest recharge for all three configurations occurred during winter 2019 when reporting recharge as percentage of precipitation configuration 1 simulates that during the period between 1st of may 2019 and 30th of april 2020 46 4 of precipitation entered from soil to the karst as recharge while for period from 1st of may 2020 to 30th of april 2021 the simulated recharge was 37 4 of precipitation considering the two periods abovementioned the configuration 2 of the model predicts 50 9 and 44 7 of precipitation entering to the karst as recharge respectively when configuration 3 of the model is considered the simulations predict 57 3 of precipitation entering the karst as recharge during the first period and 52 8 during the second period as well during first period 56 5 of recharge originates from mf 23 4 from pf1 and 20 2 from pf2 while during second period 38 2 of recharge originates from matrix flow 32 1 from pf1 and 29 7 from pf2 5 discussion soil analyses showed that in the deeper part of the soil profile 30 65 cm average soil bd and pd values are higher while average tp and ac values are lower compared to those measured in shallower part of the soil profile i e 0 30 cm such values can be attributed to higher soil compaction in the lower part of the soil profile the model considers that water flows vertically justifying its 1 d nature this is supported by the lack of observation of ponding water after large precipitation events over the surface of the soil as well as the absence of runnels and gullies in the slopes of the hill data analysis shows that there is a linear response of swc at the top of the soil i e 10 cm in depth to large precipitation events i e 5 mm supporting that no runoff takes place even during large precipitation events see supplementary material on the other hand the clint and grikes morphology developed between the top of the epikarst and the base of the soil prevents lateral water flow at the soil rock interface the irregular topography of the soil rock contact often has enclosed depressions of small scale dm to m in scale and open cracks at the epikarst surface cm to dm in size are excellent drainage conduits for draining soil water to the vadose zone of karst thus field observations and soil water content analyses support the absence of lateral water flow on the surface or the base of soil profile at the studied site these observations agree with the vertical water flow in soils and the vadose zone of karst in other regions comas bru and mcdermott 2015 dal soglio et al 2020 domínguez villar et al 2021 during winter and spring periods when swc values are high measured swc signal immediately reacts to precipitation events fig 3 without any delay at daily timescale swc and precipitation values at 1 hour resolution for selected winter and summer periods are shown in fig 8 due to low evapotranspiration and frequent precipitation swc during winter period was already high prior to observed precipitation event fig 8a following the observed precipitation event swc signals recorded at different depths reacted within 24 h rapid water percolation through the soil is the result of its silt loam texture as well as its granular structure this good drainage is the reason why surface water accumulations i e ponds were never observed at the study site even during very intense rain events during summer months due to pronounced evapotranspiration and rare precipitation events swc values are lower than those measured during winter months evapotranspiration is more pronounced in shallower soil levels as it is clearly visible during summer months on the 10 cm signal fig 3 after summer rain events some of the shallower soil levels increase their swc however from these levels that show increase in swc after summer rain events their response time is also within 24 h as in winter this fast drainage limits the impact of infiltration delays at the time scale of the model i e 1 day still providing a highly resolved simulation to solve problems of karst recharge in caves and groundwater systems module a as part of configuration 1 simulates matrix flow i e assumes that water drainage only occurs when fc of each soil layer is exceeded and overestimates swc during winter and spring months fig 4 since evapotranspiration from late autumn to early spring is relatively low it is assumed that the excess of swc simulated during this period is not the result of poor evapotranspiration estimation but of preferential flows present in the soil preferential flows occur when preferential pathways in soil enable fast water movement such preferential pathways can be present in shape of cracks burrows macropores tunnels formed by tree roots etc therefore two more configurations were introduced in the model configuration 2 assumes that besides drainage when fc is exceeded module a every day soil drains certain amount of available water content in the form of preferential flows pf1 in module b configuration 2 therefore better explains swc in autumn to spring months it is as well noticed that in deeper soil layers higher percentage of available swc is lost due to pf1 compared to the shallower soil layers for example for the layer 1 the best fit between modelled and measured swc values is obtained when the model predicts that approximately 2 of available swc is drained as preferential flows via pf1 whereas for layer 5 the best fit is obtained when 5 of available swc is drained as preferential flows via pf1 table 2 this variability in the water drainage as pf1 is probably the result of higher amount of macropores in deeper soil parts although configuration 2 explained much more variability compared to configuration 1 still some of the peaks on measured swc signal during summer periods remained unexplained peaks marked by black arrows in fig 5 for that reason configuration 3 was introduced which apart from drainage in form of matrix flow module a and continuous preferential flows module b includes preferential flows that occur during certain meteorological conditions module c mostly during late summer and early autumn these second kind of preferential flows occur in case of precipitation events that occur after long dry periods fig 8b they are thought to occur due to open fissures cracks or other kind of macropores within the soil developed during these prolonged dry periods macropores that cause pf2 are evidently not present in soil during winter and spring periods some possible causes for discontinuity of these macropores could be seasonal volumetric changes in soil desiccation cracks or the creation refill of burrows produced by soil fauna peaks of recorded swc signal at different soil depths occurring during late summer and early autumn months fig 3 clearly indicate the existence of drainage even when the fc threshold was not exceeded in these cases despite swc values on shallower levels are below the fc value there are still peaks visible on the swc signal of levels underneath i e water percolated to deeper soil sections even when fc of the upper layer was not exceeded fig 8b shows an example of water drainage when the fc dashed line in the graph was not exceeded because of drainage through pf2 where the delay is as well within 24 h besides meteorological conditions required for discontinuous preferential flow to occur i e high evapotranspiration rates and significant precipitation events module c as well comprises conditions that refer to the amount of water that drains to soil layers underneath thus module c assumes that if drainage from the upper soil layer is higher than certain threshold thres 3 certain percentage of pf2 drains from the current layer to the layer below while the rest stays in the current layer thus if drainage from the upper layer is less than the thres 3 water that enters such soil layer by pf2 only drains to the layer underneath without impacting the swc of the soil layer i e the water bypasses the layers without impacting their swc therefore it is evident that rapid water percolation through the soil profile is not only caused by granular soil structure due to high percentage of silt fraction i e 60 70 but as well by different kinds of macropores which enable preferential flows it is important to note that although this model uses simple rcs approach it still manages to accurately explain the measured swc furthermore this model allows estimation of preferential flows without using the complex richards equation in the configuration 1 recharge is limited to events when soil fc is exceeded thus recharge does not occur during summer months since the module b assumes that soil drains water at daily scale in form of preferential flows recharge no matter how small as well occurs every day as shown in fig 7 continuous preferential flows are common during winter and spring periods when they significantly contribute to total annual recharge module c introduces a scenario in which large amounts of water are drained during precipitation events occurring during dry periods due to which even during summer months large amounts of recharge occur therefore configuration 3 simulates the highest amount of recharge around 50 of precipitation when observing the full year periods during period of 1st may 2010 30th april 2020 mf was dominant source of recharge 56 of recharge originates from matrix flow and 44 from preferential flows while during period of 1st may 2020 30th april 2021 preferential flows were dominant source of recharge 62 of recharge originated from preferential flows and 38 from matrix flow domínguez villar et al 2021 developed a hydrological model for the same location in central spain the model was designed to understand the isotopic composition of drip waters of eagle cave and simulated results were compared with measured discharge patterns and isotopic composition of different drips despite that study focuses on the water flow in the vadose zone of the karst the model also contains a single soil layer as part of the hydrological system the model accounts for concepts such as field capacity to trigger the more important recharge events from the soil and preferential flows were also required for optimizing the simulated and observed isotope values of the cave drip waters resulting in recharge taking place in all seasons including summer the model by domínguez villar et al 2021 considers that recharge occurs not only through the soil but also through bedrock exposures even if values such as recharge and actual evapotranspiration cannot be directly compared i e they are implemented in different years and our model focuses only on the soil drainage quantification of recharge and actual evapotranspiration provide similar figures in both models and more importantly both models show the significance of various preferential flows however domínguez villar et al 2021 report that most of the recharge from soil during years 2009 2013 occurs when accumulated water exceeds the field capacity since our model provides a more detailed simulation of the water drainage through the soil we were capable to better understand drainage in the soil at different depths and identify a continuous preferential flow that domínguez villar et al 2021 associated to infiltration through bedrock exposures so our research suggests that part of continuous preferential flows could be drained though the soil and not just though cracks and fissures in the bedrock in any case the good agreement between two models that are calibrated against different observational data suggest that preferential flows in this karst system are of significant relevance for the recharge that supplies water to the cave drips soil drainage and karst hydrology at eagle cave are not different to those that can be found in other karst terrains therefore the implications of the model here developed have a wide impact to understand the recharge in soils developed over karst terrains our model requires a limited number of data to be implemented in other karst sites and number of soil layers can be defined by the user depending on site specific characteristics and the desired spatial resolution during last decades numerous studies have put their focus on soil macropores and the existence of preferential flows in the soil system flury et al 1994 allaire 1997 hendrickx and flury 2001 buttle and mcdonald 2002 šimůnek et al 2003 gazis and feng 2004 gärdenäs et al 2006 jarvis 2007 clothier et al 2008 lin and zhou 2008 luo et al 2008 mooney and morris 2008 roulier et al 2008 allaire et al 2009 legout et al 2009 in big pores water is not held under the influence of capillary forces and such voids enable rapid movement of water solutes and pollutants through the soil schumacher 1864 beven and germann 1982 in karst hydrology the occurrence of preferential flows is well known lange et al 2010 kogovšek and petrič 2013 sohrt et al 2014 wang et al 2018 katuwal et al 2021 our study confirms that preferential flows are not limited to conduits and fissures in the carbonate rocks but are as well present in soils over karst terrains due to the development of different macropores therefore our study highlights the need for considering preferential flows in soils for the detailed characterization of recharge in karst regions 6 conclusions one dimensional hydrological model which simulates swc at daily resolution is developed for karst regions using the rcs approach the model simulates swc for six soil depth intervals from 0 to 50 cm depth the model shows that preferential flows in karst soils should not be neglected since they significantly contribute to amount of recharge to the karst underground when preferential flows modules are not implemented i e configuration 1 the model assumes that drainage to the underneath layer or recharge occurs only when fc of the layer is exceeded therefore when configuration 1 of the model is implemented simulated recharge does not occur during summer months and high monthly recharge occurs during months with high precipitation rate i e during autumn to spring months two different modules are considered to implement preferential flows the module b enables every day between 1 and 5 of available swc to be drained from soil layers as continuous preferential flows on the other hand the module c enables the transport of water along macropores created during prolonged dry periods in late summer and early autumn thus pf1 occurs due to macropores that are constantly present in soil while pf2 has seasonal character and occurs due to macropores that are formed during prolonged dry periods drainage of water in the soil via continuous and discontinuous preferential flows is more pronounced in deeper parts of soil probably due to higher amount of macropores as well continuous preferential flows are more pronounced during winter and spring periods due to the high available swc since continuous preferential flow is present at daily resolution water recharge from soil to the underground as well occurs at daily scale even during dry summer periods when soil water contents are low discontinuous preferential flow as well contributes significantly to recharge since temporal macropore pathways enable rapid transport of large amounts of water through the soil in karst areas it is important to understand all processes which enable fast transport of larger amounts of water the developed model enables better understanding of drainage in soils of karst areas and as well estimates recharge a key parameter for better understanding hydrogeology of karst regions furthermore implementation of the model to other locations requires only calibration of functions with local parameters credit authorship contribution statement mirna švob david domínguez villar conceptualization formal analysis investigation writing original draft kristina krklec funding acquisition investigation writing original draft project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is part of the research project inter comparison of karst denudation measurement methods kademe ip 2018 01 7080 and young researchers career development project training new doctoral students dok 2018 09 5748 financed by croatian science foundation the publication was supported by the open access publication fund of the university of zagreb faculty of agriculture appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128147 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3070,models provide quantitative solutions that enable better understanding of karst soils hydrology a location in central spain was selected to implement a 1 d hydrological model that uses a reservoir cascade scheme rcs approach to simulate soil water content swc at daily resolution the model simulates swc for six soil layers and includes additional modules to reproduce preferential flow regime the soil profile in the model is 0 5 m deep developed in silt loam soil on top of dolomite marbles three different configurations of the model were considered configuration 1 considers a basic rcs module whereas other configurations include preferential flows thus configuration 2 considers rcs module together with a continuous preferential flow module where 1 to 5 of available swc from each layer is drained every day along preferential pathways configuration 3 contains a discontinuous preferential flow module in addition to previous modules the discontinuous preferential flow is only activated during rainfall events occurring after long dry periods simulated swc values are compared with measured swc values so model parameters are iteratively adjusted to optimize the model results the model produces the best simulations implementing the configuration 3 when matrix flow and two preferential flow regimes are considered the model shows that preferential flows significantly contribute to recharge and should not be neglected in soil hydrological models and recharge estimations in karst areas keywords karst soil hydrological model reservoir cascade scheme recharge macroporosity preferential flows data availability data will be made available on request 1 introduction approximately quarter of world s population partially or completely depends on water resources from karst underground ford and williams 2007 thus understanding of water dynamics in karst areas is of crucial importance before reaching the aquifer water passes through soil epikarst and vadose zone where it is subject to different processes which impact its properties berthelin et al 2020 soil is the first media controlling quantity and quality of water reaching the aquifer williams and fowler 2002 tooth and fairchild 2003 clothier et al 2008 charlier et al 2012 thus to understand water dynamics in karst systems it is necessary to first understand transport and distribution of water in soil soil moisture is one of the important components involved in complex dynamics between climate soil water and vegetation lin et al 2005 monitoring soil water dynamics enables understanding soil in terms of natural filter and buffer medium which is an important property since karst areas are highly vulnerable to contamination lin et al 2005 keestra et al 2012 wu et al 2021 to understand describe and predict water movement in soil different models are being used richards 1931 jones and kiniry 1986 manabe 1969 williams et al 1989 littleboy et al 1992 vanclooster et al 1994 raes 2002 jones et al 2003 šimůnek et al 2008 van dam et al 2008 westenbroek et al 2010 arnold et al 2012 huth et al 2012 models are approximations of a real world and the best models are considered to be the ones which give results closest to reality and at the same time require least number of parameters and model complexity wheater et al 2007 since porosity and permeability of soluble rocks are difficult to predict daly et al 2002 water flow is also difficult to model and to predict two major approaches are commonly used when simulating soil water movement 1 numerical solutions of richards equation richards 1931 and 2 reservoir cascade scheme mao et al 2018 the major processes employed in these two approaches are similar but the level of detail differs significantly ranatunga et al 2008 models based on richards equation solve hydraulic and hydrodynamic equations that describe water flow in porous media ranatunga et al 2008 and are considered appropriate if the modeller has obtained physical data and needs to know the fluxes and potentials by depth riha et al 1994 although these kinds of models provide detailed mathematical explanation of water flow in porous media at the same time they require big amount of input parameters which are not always available ma et al 2013 the most common alternative to simulate soil water content swc and movement are the so called reservoir cascade scheme rcs models which solve water balance in soil by using simplified or empirical equations zha 2014 mao et al 2018 these models are also known as tipping bucket models manabe 1969 jones and kiniry 1986 riha et al 1994 raes 2002 jones et al 2003 kendy et al 2003 westenbroek et al 2010 arnold et al 2012 abeysingha et al 2015 since they consider soil as a unit made of imaginary layers i e buckets or reservoirs each reservoir gains and loses water by major hydrological processes which include precipitation runoff plant interception evaporation transpiration infiltration redistribution and drainage or deep percolation ranatunga et al 2008 mao et al 2018 soil field capacity fc is considered a key parameter in the rcs approach since it represents a threshold that controls processes of drainage and runoff in a way that drainage and or runoff are limited to events when swc exceeds fc of a certain layer romano et al 2011 these kinds of models are useful when some of the parameters are not available i e when the modeller has data only on soil moisture contents at various field moisture states which provides information on saturation field capacity and permanent wilting point and only needs to know the moisture content by depth riha et al 1994 this is often the case in karst mediterranean soils where due to high rockiness and shallow soil depths lange et al 2010 yaalon 1997 it is difficult to obtain dense measurement networks coppola et al 2013 karst areas generally lack well developed surface drainage due to high porosity and permeability of carbonate rocks simms 2014 thus the water flow in their unsaturated zone is mostly considered vertical dal soglio et al 2020 to simulate soil drainage models in pure karst areas consider only one dimension 1 d flow e g comas bru and mcdermott 2015 domínguez villar et al 2021 while runoff is considered negligible when studying soil water movement it is important to differentiate between different types of water flow in soils apart from matrix flow preferential flows are important phenomena and although widely studied they are still a feature misrepresented in models simulating the water content and its movement in soils flury et al 1994 allaire 1997 buttle and mcdonald 2002 šimůnek et al 2003 gazis and feng 2004 gärdenäs et al 2006 jarvis 2007 lin and zhou 2008 luo et al 2008 mooney and morris 2008 roulier et al 2008 legout et al 2009 preferential flows are defined as all phenomena where water and solutes move along certain pathways while bypassing a fraction of the porous matrix hendrickx and flury 2001 clothier et al 2008 allaire et al 2009 distinguish four types of preferential flow crack flow preferential flow along continuous cracks in soil burrow flow flow along channels produced by soil fauna finger flow preferential flow that occurs at the interface between soil layers of different texture and lateral flow water moves laterally along an inclined hydraulically restrictive layer furthermore allaire et al 2009 define macropore flow as flow composed from crack flow and burrow flow tooth and fairchild 2003 distinguish soil matrix and macropore flow and emphasize that matrix flow dominates during dry periods while macropore flow is important during recharge lange et al 2010 as well noticed that during dry conditions preferential infiltration and percolation are limited compared to situations when soil is wet and much quicker vertical flow occurs preferential flows in soils are described using dual porosity dual permeability multi porosity or multi permeability models which are mostly based on combining richards equation with composite equations for the hydraulic properties or kinematic wave equations van genuchten and wierenga 1976 pruess and wang 1987 gerke and van genuchten 1993 gwo et al 1995 hutson and wagenet 1995 šimůnek et al 2003 still modelling of preferential flows represents a challenge since coupling of fracture and matrix domains is not trivial šimůnek et al 2003 sternagel et al 2019 preferential flows are particularly important in karst areas since they enable rapid and abrupt water percolation through the soil profile without possibility of soil to filter water and buffer chemical processes clothier et al 2008 kan et al 2019 mediterranean karst soils are often shallow and rocky lange et al 2010 yaalon 1997 due to such characteristics it is often difficult to obtain detailed soil water measurements and thus extensive number of parameters required to run certain models therefore the rcs approach is often the best approach to simulate water content in such soils here we develop a 1 d model at daily resolution following the rcs approach the model simulates water content for six soil layers and identifies two different preferential flow patterns the model also estimates the amount of water that enters as recharge from the soil to the karst underneath the study site was selected since there is a cave underneath and a better knowledge of water flow dynamics above the cave is of key importance for understanding the cave hydrology in detail improving cave managing and contributing to further scientific research in this location 2 regional setting the study site 40 9 15 n 5 4 20 w is located above eagle cave in tietar valley within the ávila province in central spain fig 1 a the soil site is in a hill with a general moderate slope i e 15 to 20 however the slope is not gradual since frequent rock outcrops concentrate most of the altitudinal differences whereas soil patches have gentle slopes or levelled surfaces fig 1b and 1c there are no runnels or gullies developed on slopes of the hill that would show evidence of runoff there are no depressions along the surface of the slope because soil patches smooth the typical karst dissolution features at the top of epikarst nevertheless there are clint and grikes developed under soil patches resulting in enclosed depressions i e dm to m in scale that can be observed when digging soil pits between rock outcrops the bedrock is composed of marbles of cambrian age martín escorza 1971 characterized by dolomite mineralogy here magnesite is a common mineral while goethite is the dominant accessory component krklec et al 2016 such carbonate outcrops are karstified and have increased permeability mapa hidrogeológico de españa 1991 the soil profile is quite uniform approximately 60 cm thick fig 1d without a visible a horizon and only a discontinuous patchy o horizon 1 cm thick thus the profile is represented by a typical red b horizon with a homogeneous granular structure through the full profile granules of this structure are typically 1 to 2 mm in diameter favouring macropores between them the contact with the bedrock is sharp and irregular lacking a c horizon the irregularity at the base of the soil represents already weathered epikarst with narrow cracks i e cm to dm scale wide resulting in typical clint and grikes subsoil topography fig 1 major mineral components of the soil are iron oxides giving characteristic red colour to the soil quartz feldspar and kaolinite where amount of iron oxides increases with depth krklec et al 2016 soil of the wider study area is classified as chromic cambisol and chromic luvisol forteza bonnin and lorenzo martín 1988 local meteorological conditions are recorded in a station operative since 2009 located 100 m from the experiment site mean annual temperatures recorded during 2019 2020 and 2021 were 15 0 c 15 3 c and 14 9 c respectively with maximum values of 32 6 c july 2019 31 3 c july 2020 and 30 3 c august 2021 and minimum values of 0 3 c january 2019 1 1 c january 2020 and 1 2 c january 2021 total amount of precipitation during 1 year period was 474 01 mm 2019 563 37 mm 2020 and 550 96 mm 2021 with maximum monthly values of 187 31 mm december 2019 103 75 march 2020 and 127 46 mm september 2021 and minimum monthly values of 1 03 mm june 2019 0 56 mm february 2020 and 1 15 mm march 2021 the area has an evergreen oak forest with patchy shrub cover underneath 3 methods 3 1 soil monitoring station and analyses a soil monitoring station equipped with frequency domain sensors ec 5 5te 5tm connected to a decagon em50 device was installed in 2018 at the study site fig 1e sensors positioned at depths of 10 20 30 40 and 50 cm in the soil are measuring swc m3 m3 at 1 hour intervals the meteorological station provides data on amount of precipitation and temperature at 10 minute intervals prior to soil sampling terrain reconnaissance was performed to select the most representative location for soil pit soil sampling was performed in december 2019 from the soil profile where undisturbed samples were collected samples were collected along the profile at 5 cm depth intervals up to the depth of 65 cm depth of the parent rock using 100 cm3 soil cylinders laboratory analyses were performed to determine basic soil properties swc and fc were measured by gravimetric method iso 11461 2001 bulk density bd was measured after drying the soil at 105 c iso 11272 2017 while particle density pd was measured in water using 100 ml pycnometer iso 11508 2017 total porosity tp and air filled porosity ac were calculated according to danielson and sutherland 1986 soil particle size distribution was measured by the robinson pipette method with wet sieving and sedimentation after dispersion with sodium pyrophosphate na4p2o7 0 4 m iso 11277 2009 while soil ph was measured using combined glass electrode in a 1 5 ν ν suspension of soil in water and soil in kcl solution c 1 m swc values measured on sensors were calibrated with swc values measured in the lab on the undisturbed soil samples collected in december 2019 3 2 concept of the model in order to simulate water movement through the karst soil we developed a 1 d model at daily resolution which simulates swc the model assumes no runoff or sub surface lateral flows as typically considered in hydrological models of karst the vadose zone e g comas bru and mcdermott 2015 domínguez villar et al 2021 a scale of 1 day resolution is chosen since it is more than enough to understand most of the key karst hydrology processes for which the model is designed thus the model ignores any lag time related to infiltration through the soil observations on the studied soil support its good drainage with a quick response to infiltration events i e within 24 h through the full soil profile supporting the assumption of synchrony in the hydrological response through the soil at daily resolution this assumption enables to simplify the model a key characteristic of a good model wheater et al 2007 the model is developed using the rcs approach where the soil column is divided in six imaginary layers i e reservoirs located at depths of 0 5 5 10 10 20 20 30 30 40 and 40 50 cm under the soil surface each layer gains water through drainage from the levels above and loses water by evapotranspiration or down flow parameters used in the model are listed in table 1 while characteristics of soil layers and values of used constants are reported in table 2 values of all used thresholds and constants were set to obtain highest correlation between measured and modelled data and are constant through time thickness of soil layers used in the model was set to range between sensors placed in the soil but to account for special soil hydrology conditions in the soil atmosphere boundary layer first 10 cm of the soil were divided in two layers therefore instead of five there are six soil layers used in the model thus the first layer is labelled as layer 0 and expands from 0 to 5 cm below soil surface this surficial layer has the highest evapotranspiration rate and prevents small precipitation events when soil conditions are relatively dry to be recorded in the soil layer 1 which is supported by observations recorded in the logger installed at 10 cm in depth the number of layers selected in the model has a limited impact on the results as shown in a sensitivity test performed with different number of layers supplementary material therefore the number of layers i e six layers was chosen to enable direct comparison of measurements and simulations that implies one layer per logger installed in the soil plus a zero layer or boundary layer to reproduce special dynamics between the soil and the atmosphere daily potential evapotranspiration was calculated using thornthwaite equation thornthwaite 1948 thornthwaite and mather 1957 pereira and pruit 2004 trajković 2005 1 pet 16 n 360 10 t k 1 12 0 2 t k 1 514 0 016 k 1 12 0 2 t k 1 514 0 5 where pet is daily potential evapotranspiration mm day n is maximum duration of sunlight h day t is average daily temperature c tk is average monthly temperature c and k is the month of measurement thornthwaite method is widely used for calculating potential evapotranspiration and is considered practical since the only required parameter is temperature although this method is not recommended for arid climate areas since evapotranspiration values could be significantly underestimated trajković 2009 the model here presented uses actual evapotranspiration aet instead of pet to correct such limitations however daily pet values are still considered in aet calculations since pet varies through the soil profile each layer is assigned a different fraction of the daily evapotranspiration we use summer periods for calculating those fractions since evapotranspiration rates without significant precipitation events allow discerning the amount of water losses dominated by evapotranspiration at different depths during these periods when swc was below fc differences in swc were calculated at each of the five depths in the soil where monitoring data is available water loss during these periods is completely attributed to evapotranspiration five different periods were selected for calculations soil water losses from all depths were added to calculate the total soil water loss for each period and the fraction of each layer was attributed in relation to that total soil water loss value the proportion of evapotranspiration implemented in each layer of the model was the result of averaging the results obtained during the five considered periods evapotranspiration for the uppermost 10 cm of the soil was divided between layer 0 and layer 1 in a way that a higher evapotranspiration percentage is given to the uppermost layer in agreement with the depth evapotranspiration gradient observed in the studied profile optimizing the correlation between observations and simulations daily aet for a particular layer is calculated applying the formula 2 aet i x d pet i swc real i 1 s w c r e s fc s w c r e s where aet is daily actual evapotranspiration mm day xd is fraction of aet for layer d d 0 1 2 3 4 5 swc real is real soil water content mm and swc res is residual soil water content mm i e water that is bond by adsorptive forces to soil particles so tight that it cannot be neither evapotranspirated neither drained the concept of swc res is similar to the parameter of soil permanent wilting point although is given a different name since the value is not obtained by the same procedure and absolute values of both parameters might differ swc res is obtained from the calibrated swc signal as the minimum swc expected during summer months the term swc real swc res refers to available swc i e water that is capable to either evapotranspirate or drain from the soil fc is the field capacity mm and i and i 1 represent the current day and previous day respectively the model is executed in three different configurations with three different modules configuration 1 contains module a basic rcs module configuration 2 contains module a and module b module which simulates continuous preferential flows while configuration 3 contains module a module b and module c module which simulates discontinuous preferential flows 3 2 1 configuration 1 basic rcs in the basic rcs configuration that only uses module a fig 2 layer 0 gains water when precipitation occurs and loses water by aet and drainage 3 swc pot i 0 swc pot i 1 0 prec i aet i 0 d i 1 0 where swc pot is potential swc value mm i e water content in the soil not limited by fc fc is the field capacity mm prec is precipitation mm aet is actual evapotranspiration mm d is drainage mm subscript 0 refers to the layer 0 and subscripts i and i 1 refers to the current and the previous day respectively data on precipitation are obtained from the meteorological station while fc value is obtained from calibrated swc sensor measurements during winter and spring larger rain events result in peaks of swc with similar maximum values the field capacity for each layer is slightly below those maximum swc values following those considerations the specific value of fc was set for each layer of the model when the correlation coefficients between simulations and observations were the highest real swc swc reali is the soil water content actually present i e simulated by the model in the soil and is defined as if swc pot i f c t h e n swc real i swc pot i if swc pot i f c t h e n swc real i f c when water content in a layer exceeds fc water starts draining to the layer underneath otherwise no drainage occurs if swc pot i f c t h e n d i swc pot i f c therefore the process of drainage represents water output from the upper layer and at the same time input for the layer below drainage from the deepest layer is considered as the recharge entering the vadose zone of karst since the model is designed for karst areas no runoff is considered thus in the configuration 1 we assume that recharge to karst occurs only when fc of layer 5 is exceeded for every layer below layer 0 swc poti is defined as 4 swc pot i x swc pot i 1 x d i x 1 aet i x d i 1 x where x represents the number of the layer x 1 2 3 4 5 3 2 2 configuration 2 rcs with continuous preferential flows configuration 2 assumes that on top of the module a that considers matrix flow drainage when fc of layer is exceeded there is an additional drainage accounted by module b which occurs as continuous preferential flows therefore module b assumes that every day specific percentage of available swc is drained from each layer along preferential pathways pf1 in the soil drainage accounted by module b occurs even if fc of the layer is not exceeded in the concept of configuration 2 fig 2 daily precipitation entering layer 0 is divided into 1 precipitation that enters matrix flow mf and 2 precipitation that enters continuous preferential flows pf1 5 mf i k mf prec i 6 p f 1 i k p f 1 prec i where kmf and kpf1 are fractions of daily precipitation prec mm and subscript i refers to the calculated day therefore potential soil water content swc pot for layer 0 is defined as 7 swc pot i 0 swc pot i 1 0 mf i p f 1 i dmf i 1 0 d p f 1 i 1 0 aet i 0 where dmf is drainage mm occurring when fc of the soil layer is exceeded while dpf1 is the component of drainage mm occurring as preferential flows and is defined as 8 d p f 1 i 0 k d p f 1 0 swc real i s w c r e s where kdpf1 0 is a fraction of available swc swc reali swc res which drains as pf1 kdpf1 is chosen for each layer to give the highest correlation between measured and simulated values for every next layer swc pot and dpf1 are defined as 9 swc pot i x swc pot i 1 x dmf i x 1 d p f 1 i x 1 dmf i 1 x d p f 1 i 1 x aet i x 10 d p f 1 i x k d p f 1 x swc real i s w c r e s where x is the number of a layer x 1 2 3 4 5 3 2 3 configuration 3 rcs with continuous and discontinuous preferential flows configuration 3 includes previous modules module a and module b and as well introduces a new module module c which includes preferential flows pf2 that only occur during particular meteorological conditions in the concept of the configuration 3 of the model fig 2 daily precipitation is divided into prec1 and pf1 11 p r e c 1 i k p r e c 1 prec i 12 p f 1 i k p f 1 prec i where kprec1 and kpf1 are fractions of daily precipitation prec pf1 refers to continuous preferential flows as part of module b explained already in the previous section while subscript i refers to the day of calculations prec1 is divided into matrix flow mf and discontinuous preferential flow pf2 13 p f 2 i k p f 2 p r e c 1 i if p f 2 i 0 t h e n mf i 1 k p f 2 p r e c 1 i if p f 2 i 0 t h e n mf i p r e c 1 i pf2 is activated during rainy days when pet is higher than a threshold thres 1 and daily precipitation is larger than a threshold thres 2 if pet i t h r e s 1 a n d prec i t h r e s 2 t h e n p f 2 i 0 when module c is operative a fraction of prec1 kpf2 enters the soil as pf2 while the rest of prec1 enters the soil as mf when pf2 has no flow 100 of prec1 enters the soil as mf therefore in the configuration 3 of the model the drainage from each layer is divided into drainage entering the layer as matrix flow dmf as continuous preferential flow dpf1 and as discontinuous preferential flow dpf2 potential soil water content swc pot for layer 0 is defined as 14 swc pot i 0 swc pot i 1 0 mf i p f 1 i p f 2 i dmf i 1 0 d p f 1 i 1 0 d p f 2 i 0 aet i 0 for every subsequent layer swc pot is defined as 15 swc pot i x swc p ot i 1 x dmf i x 1 d p f 1 i x 1 d p f 2 i x 1 dmf i 1 x d p f 1 i 1 x d p f 2 i x aet i x where subscript x is the number of a layer x 1 2 3 4 5 for pf2 an additional condition is introduced if the dpf2 from the layer above is higher than a threshold thres 3 certain fraction kdpf2 of pf2 directly drains to the layer below while the rest remains within layer accounting for soil water balance of the layer if p f 2 i t h r e s 3 t h e n d p f 2 i 0 k d p f 2 0 p f 2 i for layer 0 i e if d p f 2 i x 1 t h r e s 3 t h e n d p f 2 i x k d p f 2 x d p f 2 i x 1 for layers 1 2 3 4 and 5 where x is the number of a layer x 1 2 3 4 5 and x 1 represents the layer above it if the dpf2 from the above layer is less than threshold thres 3 100 of pf2 drains directly to the layer underneath i f p f 2 t h r e s 3 t h e n d p f 2 i 0 p f 2 i for layer 0 i e if d p f 2 i x 1 t h r e s 3 t h e n d p f 2 i x d p f 2 i x 1 for layers 1 2 3 4 and 5 where is the number of a layer x 1 2 3 4 5 and x 1 represents the layer above it the drainage that comes out of the layer 5 represents the recharge to the karst in this case recharge from soil to karst occurs every day due to pf1 component of module b and additional discontinuous recharge occurs when swc of soil layer 5 exceeds fc or pf2 in layer 5 operate 4 results results of analysed soil properties are shown in tables 3 and 4 values of swc at the time of collection ranged between 0 30 and 0 36 m3 m3 while fc values ranged between 0 44 and 0 52 m3 m3 average bulk density bd values are higher in deeper part of the soil profile 1 26 g cm3 at 30 65 cm compared to the shallower soil depths 1 08 g cm3 at 0 30 cm while average particle density pd values are negligibly higher in deeper soil parts 3 02 g cm3 at 0 30 cm and 3 06 g cm3at 30 65 cm average values of total porosity tp and air filled porosity ac are lower in deeper soil parts where tp is 64 3 at 0 30 cm and 58 8 at 30 65 cm while ac is 15 5 at 0 30 cm and 9 9 at 30 65 cm soil ph values measured in suspension of soil in water phh2o ranged between 6 43 and 7 02 while those measured in suspension of soil in kcl solution phkcl ranged between 5 75 and 6 45 textural analysis of soil samples table 4 showed that the most abundant soil fraction is silt coarse and fine silt 0 063 0 002 mm according to iuss working group wrb 2015 soil texture is classified as silt loam through the whole soil profile recorded swc m3 m3 signals during the period between may 2019 and august 2021 are shown in fig 3 measured water content is higher during winter and spring months ranging between 0 3 and 0 4 m3 m3 while during summer months swc decreases progressively until the end of the dry season when values range between 0 16 and 0 28 m3 m3 the model simulates swc for six different layers and provides results in mm while swc records are initially measured in m3 m3 thus for the purpose of comparing observations with modelled results the swc record values were transformed to mm of water in 10 cm thick soil layers unit transformation is made in a way that swc signal measured at the base of a level integrates all the water in that level e g signal measured at 20 cm is compared to simulated value of layer 2 measured and simulated swc signals for three different configurations of the model are shown in figs 4 6 when implementing configuration 1 which only considers module a the simulation produces good fit between modelled and recorded values during summer months on the contrary during winter and spring months the simulated swc keeps relatively high values whereas observed swc signal shows significant decreases in swc after rainfall events see arrows in fig 4 for major examples of simulation mismatches when implementing the module b in the configuration 2 the simulation better explains water content during winter and spring months see gray arrows in fig 5 but some of the peaks during summer months see black arrows in fig 5 which were already poorly simulated with configuration 1 still remain unexplained in configuration 2 when the configuration 3 of the model is implemented considering three modules at once the simulation optimizes the results during winter and spring months as well as during summer months fig 6 simulating all significant events recorded in the measured swc signals the coefficient of determination r2 was used to test the fit of the different simulations to the recorded observations figs 4 6 although configuration 1 already explains 70 of the variance of the recorded signal for all levels configurations 2 and 3 improves significantly the results of simulations that in the best scenario explains 80 of the full variance of all simulated levels when only the configuration 1 is implemented simulated recharge does not occur during summer months fig 7 in the case of configuration 2 simulated recharge to the karst occurs every day even during dry summer months although barely visible in fig 7 since the amount of recharge during summer is very limited configuration 3 enables higher amount of recharge to occur even during summer periods highest recharge for all three configurations occurred during winter 2019 when reporting recharge as percentage of precipitation configuration 1 simulates that during the period between 1st of may 2019 and 30th of april 2020 46 4 of precipitation entered from soil to the karst as recharge while for period from 1st of may 2020 to 30th of april 2021 the simulated recharge was 37 4 of precipitation considering the two periods abovementioned the configuration 2 of the model predicts 50 9 and 44 7 of precipitation entering to the karst as recharge respectively when configuration 3 of the model is considered the simulations predict 57 3 of precipitation entering the karst as recharge during the first period and 52 8 during the second period as well during first period 56 5 of recharge originates from mf 23 4 from pf1 and 20 2 from pf2 while during second period 38 2 of recharge originates from matrix flow 32 1 from pf1 and 29 7 from pf2 5 discussion soil analyses showed that in the deeper part of the soil profile 30 65 cm average soil bd and pd values are higher while average tp and ac values are lower compared to those measured in shallower part of the soil profile i e 0 30 cm such values can be attributed to higher soil compaction in the lower part of the soil profile the model considers that water flows vertically justifying its 1 d nature this is supported by the lack of observation of ponding water after large precipitation events over the surface of the soil as well as the absence of runnels and gullies in the slopes of the hill data analysis shows that there is a linear response of swc at the top of the soil i e 10 cm in depth to large precipitation events i e 5 mm supporting that no runoff takes place even during large precipitation events see supplementary material on the other hand the clint and grikes morphology developed between the top of the epikarst and the base of the soil prevents lateral water flow at the soil rock interface the irregular topography of the soil rock contact often has enclosed depressions of small scale dm to m in scale and open cracks at the epikarst surface cm to dm in size are excellent drainage conduits for draining soil water to the vadose zone of karst thus field observations and soil water content analyses support the absence of lateral water flow on the surface or the base of soil profile at the studied site these observations agree with the vertical water flow in soils and the vadose zone of karst in other regions comas bru and mcdermott 2015 dal soglio et al 2020 domínguez villar et al 2021 during winter and spring periods when swc values are high measured swc signal immediately reacts to precipitation events fig 3 without any delay at daily timescale swc and precipitation values at 1 hour resolution for selected winter and summer periods are shown in fig 8 due to low evapotranspiration and frequent precipitation swc during winter period was already high prior to observed precipitation event fig 8a following the observed precipitation event swc signals recorded at different depths reacted within 24 h rapid water percolation through the soil is the result of its silt loam texture as well as its granular structure this good drainage is the reason why surface water accumulations i e ponds were never observed at the study site even during very intense rain events during summer months due to pronounced evapotranspiration and rare precipitation events swc values are lower than those measured during winter months evapotranspiration is more pronounced in shallower soil levels as it is clearly visible during summer months on the 10 cm signal fig 3 after summer rain events some of the shallower soil levels increase their swc however from these levels that show increase in swc after summer rain events their response time is also within 24 h as in winter this fast drainage limits the impact of infiltration delays at the time scale of the model i e 1 day still providing a highly resolved simulation to solve problems of karst recharge in caves and groundwater systems module a as part of configuration 1 simulates matrix flow i e assumes that water drainage only occurs when fc of each soil layer is exceeded and overestimates swc during winter and spring months fig 4 since evapotranspiration from late autumn to early spring is relatively low it is assumed that the excess of swc simulated during this period is not the result of poor evapotranspiration estimation but of preferential flows present in the soil preferential flows occur when preferential pathways in soil enable fast water movement such preferential pathways can be present in shape of cracks burrows macropores tunnels formed by tree roots etc therefore two more configurations were introduced in the model configuration 2 assumes that besides drainage when fc is exceeded module a every day soil drains certain amount of available water content in the form of preferential flows pf1 in module b configuration 2 therefore better explains swc in autumn to spring months it is as well noticed that in deeper soil layers higher percentage of available swc is lost due to pf1 compared to the shallower soil layers for example for the layer 1 the best fit between modelled and measured swc values is obtained when the model predicts that approximately 2 of available swc is drained as preferential flows via pf1 whereas for layer 5 the best fit is obtained when 5 of available swc is drained as preferential flows via pf1 table 2 this variability in the water drainage as pf1 is probably the result of higher amount of macropores in deeper soil parts although configuration 2 explained much more variability compared to configuration 1 still some of the peaks on measured swc signal during summer periods remained unexplained peaks marked by black arrows in fig 5 for that reason configuration 3 was introduced which apart from drainage in form of matrix flow module a and continuous preferential flows module b includes preferential flows that occur during certain meteorological conditions module c mostly during late summer and early autumn these second kind of preferential flows occur in case of precipitation events that occur after long dry periods fig 8b they are thought to occur due to open fissures cracks or other kind of macropores within the soil developed during these prolonged dry periods macropores that cause pf2 are evidently not present in soil during winter and spring periods some possible causes for discontinuity of these macropores could be seasonal volumetric changes in soil desiccation cracks or the creation refill of burrows produced by soil fauna peaks of recorded swc signal at different soil depths occurring during late summer and early autumn months fig 3 clearly indicate the existence of drainage even when the fc threshold was not exceeded in these cases despite swc values on shallower levels are below the fc value there are still peaks visible on the swc signal of levels underneath i e water percolated to deeper soil sections even when fc of the upper layer was not exceeded fig 8b shows an example of water drainage when the fc dashed line in the graph was not exceeded because of drainage through pf2 where the delay is as well within 24 h besides meteorological conditions required for discontinuous preferential flow to occur i e high evapotranspiration rates and significant precipitation events module c as well comprises conditions that refer to the amount of water that drains to soil layers underneath thus module c assumes that if drainage from the upper soil layer is higher than certain threshold thres 3 certain percentage of pf2 drains from the current layer to the layer below while the rest stays in the current layer thus if drainage from the upper layer is less than the thres 3 water that enters such soil layer by pf2 only drains to the layer underneath without impacting the swc of the soil layer i e the water bypasses the layers without impacting their swc therefore it is evident that rapid water percolation through the soil profile is not only caused by granular soil structure due to high percentage of silt fraction i e 60 70 but as well by different kinds of macropores which enable preferential flows it is important to note that although this model uses simple rcs approach it still manages to accurately explain the measured swc furthermore this model allows estimation of preferential flows without using the complex richards equation in the configuration 1 recharge is limited to events when soil fc is exceeded thus recharge does not occur during summer months since the module b assumes that soil drains water at daily scale in form of preferential flows recharge no matter how small as well occurs every day as shown in fig 7 continuous preferential flows are common during winter and spring periods when they significantly contribute to total annual recharge module c introduces a scenario in which large amounts of water are drained during precipitation events occurring during dry periods due to which even during summer months large amounts of recharge occur therefore configuration 3 simulates the highest amount of recharge around 50 of precipitation when observing the full year periods during period of 1st may 2010 30th april 2020 mf was dominant source of recharge 56 of recharge originates from matrix flow and 44 from preferential flows while during period of 1st may 2020 30th april 2021 preferential flows were dominant source of recharge 62 of recharge originated from preferential flows and 38 from matrix flow domínguez villar et al 2021 developed a hydrological model for the same location in central spain the model was designed to understand the isotopic composition of drip waters of eagle cave and simulated results were compared with measured discharge patterns and isotopic composition of different drips despite that study focuses on the water flow in the vadose zone of the karst the model also contains a single soil layer as part of the hydrological system the model accounts for concepts such as field capacity to trigger the more important recharge events from the soil and preferential flows were also required for optimizing the simulated and observed isotope values of the cave drip waters resulting in recharge taking place in all seasons including summer the model by domínguez villar et al 2021 considers that recharge occurs not only through the soil but also through bedrock exposures even if values such as recharge and actual evapotranspiration cannot be directly compared i e they are implemented in different years and our model focuses only on the soil drainage quantification of recharge and actual evapotranspiration provide similar figures in both models and more importantly both models show the significance of various preferential flows however domínguez villar et al 2021 report that most of the recharge from soil during years 2009 2013 occurs when accumulated water exceeds the field capacity since our model provides a more detailed simulation of the water drainage through the soil we were capable to better understand drainage in the soil at different depths and identify a continuous preferential flow that domínguez villar et al 2021 associated to infiltration through bedrock exposures so our research suggests that part of continuous preferential flows could be drained though the soil and not just though cracks and fissures in the bedrock in any case the good agreement between two models that are calibrated against different observational data suggest that preferential flows in this karst system are of significant relevance for the recharge that supplies water to the cave drips soil drainage and karst hydrology at eagle cave are not different to those that can be found in other karst terrains therefore the implications of the model here developed have a wide impact to understand the recharge in soils developed over karst terrains our model requires a limited number of data to be implemented in other karst sites and number of soil layers can be defined by the user depending on site specific characteristics and the desired spatial resolution during last decades numerous studies have put their focus on soil macropores and the existence of preferential flows in the soil system flury et al 1994 allaire 1997 hendrickx and flury 2001 buttle and mcdonald 2002 šimůnek et al 2003 gazis and feng 2004 gärdenäs et al 2006 jarvis 2007 clothier et al 2008 lin and zhou 2008 luo et al 2008 mooney and morris 2008 roulier et al 2008 allaire et al 2009 legout et al 2009 in big pores water is not held under the influence of capillary forces and such voids enable rapid movement of water solutes and pollutants through the soil schumacher 1864 beven and germann 1982 in karst hydrology the occurrence of preferential flows is well known lange et al 2010 kogovšek and petrič 2013 sohrt et al 2014 wang et al 2018 katuwal et al 2021 our study confirms that preferential flows are not limited to conduits and fissures in the carbonate rocks but are as well present in soils over karst terrains due to the development of different macropores therefore our study highlights the need for considering preferential flows in soils for the detailed characterization of recharge in karst regions 6 conclusions one dimensional hydrological model which simulates swc at daily resolution is developed for karst regions using the rcs approach the model simulates swc for six soil depth intervals from 0 to 50 cm depth the model shows that preferential flows in karst soils should not be neglected since they significantly contribute to amount of recharge to the karst underground when preferential flows modules are not implemented i e configuration 1 the model assumes that drainage to the underneath layer or recharge occurs only when fc of the layer is exceeded therefore when configuration 1 of the model is implemented simulated recharge does not occur during summer months and high monthly recharge occurs during months with high precipitation rate i e during autumn to spring months two different modules are considered to implement preferential flows the module b enables every day between 1 and 5 of available swc to be drained from soil layers as continuous preferential flows on the other hand the module c enables the transport of water along macropores created during prolonged dry periods in late summer and early autumn thus pf1 occurs due to macropores that are constantly present in soil while pf2 has seasonal character and occurs due to macropores that are formed during prolonged dry periods drainage of water in the soil via continuous and discontinuous preferential flows is more pronounced in deeper parts of soil probably due to higher amount of macropores as well continuous preferential flows are more pronounced during winter and spring periods due to the high available swc since continuous preferential flow is present at daily resolution water recharge from soil to the underground as well occurs at daily scale even during dry summer periods when soil water contents are low discontinuous preferential flow as well contributes significantly to recharge since temporal macropore pathways enable rapid transport of large amounts of water through the soil in karst areas it is important to understand all processes which enable fast transport of larger amounts of water the developed model enables better understanding of drainage in soils of karst areas and as well estimates recharge a key parameter for better understanding hydrogeology of karst regions furthermore implementation of the model to other locations requires only calibration of functions with local parameters credit authorship contribution statement mirna švob david domínguez villar conceptualization formal analysis investigation writing original draft kristina krklec funding acquisition investigation writing original draft project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is part of the research project inter comparison of karst denudation measurement methods kademe ip 2018 01 7080 and young researchers career development project training new doctoral students dok 2018 09 5748 financed by croatian science foundation the publication was supported by the open access publication fund of the university of zagreb faculty of agriculture appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128147 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3071,amplifying the frequency and loss of weather and hydrological extremes under climate warming have aroused increasing human concerns in recent decades and it is particularly the case for compound drought heatwave cdh events the drought index based on the hypothesis of non stationarity is of great significance for the study of cdh events here we presented spatiotemporal patterns of cdh general heatwaves ghw he heatwave that does not occur in dry months and relevant circulation backgrounds in eastern china we found that heatwaves are starting earlier and ending later and later while the termination date of heatwaves in southern china is late than those in northern china significant increases since the 1980 s were detected in the frequency duration and intensity of heatwaves and the frequency of cdh events in eastern china besides heatwaves were observed mainly in the middle and lower yangtze river basin and in the sichuan basin as well most areas of eastern china were dominated by higher occurrence probability of cdhs in july and the probability was as high as 0 49 the duration and intensity of the cdhs were 0 28 days longer and 11 14 higher than ghws further examinations show that the western pacific subtropical high wpsh has a significant influence on the occurrence of heatwaves the average position of the wpsh is shifted westward and its intensity is relatively stronger thus favoring the occurrence of heatwave events the occurrence of compound events in eastern china cannot be separated from the influence of large scale circulation and atmospheric changes keywords heatwaves meteorological drought compound drought heatwave events nspei data availability the authors do not have permission to share data 1 introduction global warming will amplify extreme meteorological events and will have profound impacts on socioeconomic development gao et al 2019 tegegne et al 2020 zscheischler et al 2018 compared with single extreme event the impact of compound drought heatwave cdh events is more severe leonard et al 2014 zhang et al 2021b the cdh disasters in eastern europe and russia in 2003 2010 and 2018 caused considerable mortalities and socioeconomic losses liu et al 2020 cdh events in europe have resulted in two fold increase in crop losses over the past 50 years bras et al 2021 therefore a thorough understanding of cdh is highly significant for human mitigation to natural hazards in the backdrop of global warming a heatwave event is defined as a period with air temperature higher than a certain threshold and synchronous occurrence of drought and heatwave is defined as a cdh event kong et al 2020 shi et al 2021 mukherjee and mishra 2020 drought is usually accompanied by high air temperature and sometimes heatwave lu et al 2018 luo et al 2017a compared with weather and climate isolated events compound events can have severe socio economic effects even if the individual events that make up the compound event are not all extreme events ridder et al 2020 chapman et al 2019 the occurrence and effects of cdh events have been studied extensively increased frequency and severity of cdh events were reported across china kong et al 2020 luo et al 2022 india sharma and mujumdar 2017 the united states mazdiyasni and aghakouchak 2015 and europe manning et al 2019 further studies include the application of combined distribution and magnitude index to grade assessment wang et al 2018 zhang et al 2022 previous studies are generally based on stationarity hypothesis to calculate drought index however in the context of frequent human activities and global warming stationary hypothesis has been gradually questioned gu et al 2019 rashid and beecham 2019 recent studies in different parts of the world have showed that stationarity assumption has been difficult to apply to change of climate song et al 2020 zhang et al 2021a therefore it is necessary to study drought index based on non stationary hypothesis moreover it seems that drought promotes heat waves shi et al 2021 the temporal and spatial differences of such promoting effect still need further research so as to explore the mechanism behind drought triggering and amplifying the heat waves and provide a basis for possible further research in the future eastern china east of 100 e is mainly characterized by a monsoon climate and the western north pacific subtropical high wnpsh and it is also heavily populated and highly economically developed liu et al 2019 zheng et al 2019 located in the east part of eurasia continent eastern and neighbored to the pacific ocean eastern china hence is highly sensitive to climate changes and weather extremes there have aroused considered concerns from academic community zhang et al 2017 chen and zhai 2017 however the spatiotemporal behaviors of chd in eastern china remain unclear and warrant further examinations by using both relative and absolute air temperature thresholds to identify heatwaves and using the non stationary standardized precipitation evapotranspiration index nspei to identify drought events here we analyzed spatiotemporal patterns of cdh across eastern china from 1970 to 2019 and quantified the relations of heatwaves with droughts and the changes of cdh events 2 data and methods 2 1 data the meteorological data during 1970 2019 used in this study were sourced from the national climate center of the china meteorological administration cma https data cma cn specific variables include precipitation and temperature wind speed barometric pressure sunshine hours relative humidity and other variables needed in the calculation of potential evapotranspiration considering the length of the data and excluding the stations with 1 missing record we selected 1784 meteorological stations covering most of eastern china fig 1 and the meteorological stations were classified into four groups with different grades of duration and intensity of the heatwaves by hierarchical clustering method stations with almost no risk of heatwaves anr stations with low risk of heatwaves lr stations with medium risk of heatwaves mr and stations with high risk of heatwaves hr the missing data were processed based on cubic convolution zhang et al 2011 and the wpsh intensity index was obtained from the climate monitoring center of cma the geopotential height and other reanalysis data were obtained from theera5 reanalysis datasets with 0 25 spatial resolution and month time resolution https www ecmwf int 2 2 methods 2 2 1 definition of heatwaves heatwave event has been defined by cma as a period with daily maximum temperature of 35 c for at least 3 consecutive days e g shen et al 2018 however the heatwave indicators by absolute thresholds tend to underestimate the damage or losses caused by heatwaves at high latitudes and are not appropriate for analysis of heatwaves in various regions xie et al 2020 luo and lau 2021 the relative threshold by percentile of temperature can reflect the adaptation of inhabitants to high air temperature in different climate regimes however it is difficult to differentiate the high temperature based on the index and the actual high temperature ye et al 2013 in this case we took the relative and absolute temperature thresholds to define heatwaves when t 90 i e 90th quantile temperature of the maximum daily summer temperature 30 c t 0 t 90 otherwise when t 90 30 c t 0 30 c a heatwave process occurs if the daily maximum temperature i e t max t 0 lasts for 3 days for the sake of spatiotemporal analysis of the heatwaves we analyzed the heat wave frequency hwf the yearly number of heat waves heat wave duration hwd the duration of a heatwave event and heat wave intensity hwi the sum of the daily maximum temperatures during throughout a heatwave event luo et al 2020 ye et al 2013 2 2 2 non stationary standardized precipitation evapotranspiration index the standardized precipitation evapotranspiration index spei has been widely used in studies of meteorological drought beguería et al 2014 vicente serrano et al 2010 however spei assumes stationarity of the meteorological processes and may potentially overestimate the responses of meteorological droughts to warming climate here we proposed a non stationary standardized precipitation evapotranspiration index nspei to monitor meteorological droughts across eastern china wen et al 2020 it is to use time varying position parameters to fit log logistic distributions the nspei was computed as follows 1 calculate the difference d t between monthly precipitation p t and monthly pet t 1 d t p t pet t the smooth spline function was then used to fit d t 2 s s dt h t 1 n d t f d t 2 h d t min dt max f d t 2 d t where f is a linear fitting function of d t h is a smoothing parameter t is the time series t 1 n and pet t is the potential evapotranspiration based on the penman monteith evapotranspiration formula so ss dt is a data series calculated by local polynomial regression fitting of d t according to eq 1 and eq 2 the time varying position parameters γ d t can be obtained as follows γ d t t s s dt in eq 3 the position parameter γ d t is equal to s s dt at time t 2 calculate the log logistic probability distribution d t 4 f d t α β γ d t a β d t γ d t α β 1 1 d t γ d t α β 2 5 f x 0 x f d t α β γ d t d t 1 α d t γ d t β 1 where α β and γ d t are the scale shape and position parameters respectively 3 estimate the parameters using probability weighting methods pwms vicente serrano et al 2010 based on the empirical frequency to compute nspei 6 w s 1 n i 1 n 1 f i s d i f i i 0 35 n 7 nspei w c 0 c 2 c 3 w s 2 1 d 1 w s d 2 w s 2 d 3 w s 3 w 2 ln p in eq 6 n is the number of data series and f i is the frequency estimation ws is the s order of pwm in eq 7 when p 0 5 p is the cumulative probability and p 1 f x when p 0 5 p 1 p the other parameters are as follows c 0 2 515517 c 1 0 802853 c 2 0 010328 d 1 1 432788 d 2 0 189269 and d 3 0 001308 table 1 presents the classification table for the nspei 2 2 3 cdh events and compound event magnitude index a cdh event refers to the synchronous occurrence of meteorological drought and heatwave we identified the monthly drought conditions based on the nspei index heatwave events that occur in dry months according to the starting date of the heatwave process are considered as cdh events kong et al 2020 the cdh frequency was calculated based on the dry months in which the heatwave occurred no matter how many heatwaves occurred in that month besides we also analyzed the occurrence probability of heatwave events in a backdrop of atmospheric drying conditions where the number of dry months with heatwave events regardless of the number of heatwave processes were subdivided by the total number of dry months we have analyzed the annual frequency of cdh events cdhf months with cdh events per year and the variations in the compound drought heatwave magnitude index cdhmi and the maximum duration of cdh events reflects the maximum duration of heatwave days in a drought context the cdhmi is calculated based on the probability of heat wave and drought events exceeding normal thresholds and reflects the intensity of the composite event to some extent wang et al 2021 wu et al 2019 zhang et al 2021c the cdhmi is calculated as follows fig 2 c d h m i p d δ d p t i 1 n δ t n δd indicated the magnitude of drought which is the difference between monthly drought indicator nspei and the drought threshold the threshold was 0 according to the nspei calculation and δd 0 if no drought occurs in the month δt indicated the magnitude of heatwaves which is the difference between the maximum temperature and the temperature threshold t0 during all heatwave occurrences and the temperature threshold was determined in a similar way to 2 2 2 and n is the number of days in the month on which the cdh event occurred number of all heatwave days in the month pd δd and pt δt are the probabilities of δd and δt obtained from empirical distributions based on non parametric distributions 2 2 4 statistical methods here we used correlations by the kendall τ test ribeiro et al 2020 to analyze the spatiotemporal distributions of heatwave events the generalized pareto gp distribution was used to fit the duration and intensity of composite heatwave events huang et al 2021 we calculated the spatiotemporal variation in the return periods and the probability density distributions of the heatwave duration and intensity for each station kernel density estimation is a non parametric test method that can examine the distribution characteristics of data from the data itself okabe et al 2009 and it was used to analyze the characteristics of the probability of heatwaves under a dry condition at monthly scale 3 results 3 1 spatiotemporal patterns of heatwaves we counted the median start date ending date of the first last heatwave events for each year at all stations over eastern china we found that the start date of the heatwaves tended to be earlier while the ending date tended to be prolonged fig 3 a implying lengthening heatwave events over the past decades we calculated the average frequency of daily heatwaves total number of heatwaves occurring at all stations during 1970 2019 divided by the total number of stations fig 3b heatwave events occurred mainly in late july and early august the frequency of daily heatwaves gradually increased from may and fewer heatwaves can be detected in september according to the spatial distribution of the onset date of the first heatwaves the ending date of the last heatwaves and the average total heatwave duration within a year fig 4 the first heatwave event occurred in may from yunnan guizhou plateau to hainan island with a relatively long duration fig 4c the first heatwave in large regions of southern china began in mid july and usually ended in late august in the north china plain the first heatwave event started earlier in june but the total duration was shorter and the last heatwave ended in late july the onset of heatwaves in northern china was earlier than that in most parts of southern china the end of the last heatwave in southern china was significantly later than that in northern china in the yunnan guizhou plateau the onset of heatwaves was the earliest with the longest total duration fig 5 shows the distribution of each heatwave indicator in most of the eastern region there are no large differences in hwf and heatwaves occur slightly more frequently in the south than in the north heatwaves affected most parts of eastern china every year except for central inner mongolia and northern heilongjiang region the hwf and the hwd of a single heatwave event were highly consistent in their spatial distributions the high values of hwi and hwd were concentrated in the plains along the middle and lower yangtze river basin sichuan basin and the western inner mongolia the mean hwi was approximately 200 c long duration heatwaves generally lasting for approximately 4 6 days were more concentrated along the coastal regions of eastern china although the hwf in northern and northeastern china was not distinctly different from that in the yangtze huai river basin the intensity and duration of the heatwaves were evidently lower than those in the yangtze huai river basin fig 5b c after 2000 the annual frequency and intensity of heatwaves were evidently higher than those prior to 2000 for stations in anrs lrs and hrs as identified in heatwave indicators fig 6 the variation in the hwd was not evident for most regions of the study area the hwd was shorter at the stations with less heat waves the average frequency of heatwaves from 1970 to 1980 was 1 39 and it increased to 1 93 in 1981 2019 after 1980 all heatwave metrics exhibited significant upward trends at significance level 3 2 correlation between heatwaves and meteorological droughts here we quantified the correlation coefficients between drought intensity and heatwave duration and intensity at stations with different heatwave grades in various months given the occurrence of droughts with nspei 0 generally the correlation coefficients between drought intensity and heatwave duration and intensity are regionally varying figs 7 and 8 collectively illustrate the spatial distribution of correlation coefficients between drought intensity and hwd and intensity for each month the stations marked in figs 7 and 8 are characterized by significant correlations between drought intensity and hwd and intensity at 0 05 significance level and the negative correlations between drought intensity and the duration and intensity of heatwaves rarely passing the significance test in may and september no significant correlations between drought and heatwave were detected in most parts of eastern china significant correlations between drought and heatwave were detected mainly in the yunnan guizhou plateau in may and in some areas of southern china in september in july positive correlations between heatwave and drought were found in the northeast china plain but correlations between drought and heatwave were not significant in eastern parts of northeast china plain high correlations between drought and heatwave from july to september were found mainly in northeast china and the yangtze huai river basin droughts from july to september exhibited significant correlations with heatwave duration and intensity in northeast china and the yangtze huai river basin 3 3 spatiotemporal characteristics of cdh it can be seen in fig 9 that high cdhf was found mainly across the northeast china plain to the middle and lower yangtze river basin most regions of eastern china were characterized by one cdh per year fig 9a besides the cdhf was also of 0 12 10a in increasing magnitude meanwhile an upward trend of 0 2 10a in cdh was also detected from 1990 to 2019 after 2000 cdh events were subject to persistent a high frequency fig 9c the cdhmi and cdhf shows the same spatial distribution and is more concentrated in the northern part of china in particular the rising trend of cdni became significant after 2000 fig 9b 9d fig 10 shows the spatial distribution of the maximum duration and cdhmi of the cdh event for the 20 50 and 100 year recurrence period the spatial distribution of maximum duration and cdhmi is basically the same however cdhmi is more concentrated in the area north of the huaihe river where high values of maximum duration reaching around 15 20 and 23 days for the 20 50 and 100 year events and high values of cdhmi above 0 3 0 4 and 0 5 respectively most areas in eastern china have a high risk of heat waves cdh events can cause greater loss and harm as the recurrence period increases 3 4 effects of drought on heatwaves we now proceed to evaluate the probability of heatwave events under the occurrence of droughts the peak value of the kernel density estimation can reflect the central tendency in the sample dataset as indicated in fig 11 the peak probabilities of heatwave with drought in may and september were approximately 0 was 0 14 and 0 59 in june 0 67 in july and 0 53 in august the probability of heatwaves under the occurrence of droughts in may and september was low while heatwaves and drought are frequent from june to august such that cdh events were frequent fig 11a shows the spatial distribution of the heatwave probabilities under droughts from may to september in may higher probability can be mainly identified in the yunnan guizhou plateau and low probability approximately 0 appears in most parts of eastern china in june higher probability can be identified in most areas of the north china plain and the loess plateau and low probability is mainly seen in the yangtze huai river basin in july the center with higher probability of heatwaves with drought shifted to the yangtze huai river basin and the inner mongolia plateau in most portions of eastern china drought events were highly likely to trigger heatwaves in august higher probability are seen in the southern yangtze huai river basin the probability in most regions of eastern china was higher than 0 5 in september the range of high probabilities was small and high probability can be found only kin the pearl river basin and the ganjiang river basin it can also be seen in fig 11 that the impacts of droughts on heatwaves vary across both space and time droughts in july were sensitive to heatwaves in most parts of eastern china based on fig 3b and 11 there were few heatwaves in september and the heatwave duration and intensity were significantly correlated with droughts therefore the heatwave process in southern china in september was closely related to drought fig 12 shows the proportions of droughts with different intensities and the probability of heatwaves under different drought conditions i e with different intensities although the proportion of extreme drought 0 02 was significantly lower than that of mild drought 0 68 the probability of a heatwave given extreme drought was the highest reaching 0 49 the higher the drought level the lower the occurrence proportion of droughts but the higher the probability of heatwaves implying that higher drought intensity can potentially trigger occurrence of heatwaves drought has a significant influence on heatwave duration and intensity fig 13 shows the probability densities for the duration and intensity of cdh and ghw see methods events in different clustered subregions of eastern china the duration and intensity of the cdh events under the influence of drought generally shifted to the right side where the peak value position of the probability density curve was higher than that of the ghw events this indicates that the intensity of cdh events was larger the duration was longer and these events tend to cause more serious damage the cdh duration intensity was 0 27 8 84 0 25 10 37 and 0 34 d 14 20 longer than that of ghw events in the regions of low medium and high risk of heatwaves respectively the differences in the duration and intensity of the cdh and ghw events are compared in fig 14 in most parts of eastern china the duration and intensity of the cdh events were greater than those of heatwaves with lower intensity and shorter duration this evident difference was found across the yunnan guizhou plateau qinghai tibet plateau and northeast china where the heatwave frequency was low the difference in the largest duration intensity was up to 3 0 d 95 2 between the cdh and ghw events but a negative average difference is shown in the southern region such as guangdong and guangxi provinces with frequent heatwaves the duration intensity of heatwaves is longer stronger under a drought background in areas with few heatwaves implying that the effects of drought on heatwave is more significant in areas with less frequent heatwave 4 discussions indices based on different temperature thresholds often have certain uncertainties in definition of heatwave regimes which may be due to differences in the spatial and temporal distribution of various temperature thresholds you et al 2016 absolute temperature thresholds have been often used in studies at regional scales whereas relative thresholds have been widely used in studies at larger temporal or spatial scales luo et al 2020 trancoso et al 2020 eastern china is a vast territory with significant climate differences where the inhabitants of different subregions show different adaptations to high temperatures therefore selecting a unified index to measure changes in heatwaves across all of eastern china is complex in this study a combination of relative and absolute thresholds was selected to identify heatwaves to avoid the occurrence of an excessively low threshold in high latitude and high altitude areas when applying a relative threshold to analyze heatwaves across the entire study area demonstrating a certain rationality and applicability wu et al 2020 ye et al 2013 studies based on different thresholds have reported the increases in the heatwave frequency duration and intensity at regional and global scales kong et al 2020 manning et al 2019 mazdiyasni and aghakouchak 2015 which is similar to the observations obtained in this study in eastern china the upward trend in the heatwave frequency duration and intensity was more significant since 2000 there is a connection between heatwave events and global climate change although studies have shown that there is a current slowing of global warming extreme high temperature events occur with higher frequency in china li et al 2021b wang et al 2016 additionally many studies have discussed the causes behind heatwaves in china from an atmospheric circulation perspective the el niño phenomenon strengthens the anticyclone and subtropical high in the western pacific thus providing favorable conditions for the occurrence and maintenance of heatwaves luo and lau 2018 also pointed out that heatwave activity increases in the summer after the el niño phenomenon moreover the wpsh exerts significant impacts on heatwaves in eastern china with a wide range of air subsidence frequent high temperatures and negligible precipitation in the control area of the wpsh ridge liu et al 2019 ma et al 2020 fig 15 shows the interannual variation in hwi cdhmi and wpsh intensity index wpshi in may september in most years the hwi and wpshi change synergistically and their correlation coefficient between the heatwave intensity and wpsh intensity reached 0 55 passing the 0 05 significance test in contrast the direct correlation between cdhmi and wpshi was not significant but the correlation between hwi and cdhmi showed a high correlation passing the 0 05 significance test it can be seen that to some extent the wpsh have a greater influence on the general heat wave than cdh event fig 16 shows the change in the 500 hpa geopotential height field in july and august i e the hottest summer months before and after 2000 mutation year the average position of the wpsh after 2000 was more westward than that before 2000 the changes in the intensity and position of the wpsh should be one of the reasons for the frequent heatwave occurrence in eastern china after 2000 it is noted that the abnormal westward movement of the wpsh resulted in an abnormally high pressure and high temperature evolution such that heatwaves in southern china were often accompanied by an abnormal high pressure center and near surface anticyclonic while simultaneously reducing the water vapor transport between the land and sea luo and lau 2017b cdh events in eastern china have been widely discussed some scholars have established the standardized compound drought and heat index scdhi for the evaluation of cdh events in china they found the occurrence frequency of cdh events is high in south china li et al 2021a the dry hot magnitude index also has a wide range of applications in the analysis of composite events wang et al 2021 wu et al 2019 the researchers found that high magnitude levels of composite dry hot events occurred mainly in northeast and southwest china and mainly in recent decades since the 1990 s based on the nspei index we analyzed the frequency and trend of cdh events based on the identification of concurrent drought and heatwave events and found that cdh events generally occurred in the northeast plain north china plain and yangtze huai river basin there is a connection between compound events and large scale climate change mukherjee and mishra 2020 based on poisson generalized linear model the occurrence of compound events and el nino southern oscillation enso show a strong correlation in the southern hemisphere then we further analyzed the degree of correlation between enso east central tropical pacific temperature and cdhmi and made the following spatial distribution of correlation fig 17 considering that the development of niño 3 4 is most obvious in winter zambrano mera et al 2018 we performed a correlation analysis using niño 3 4 values of previous winter it can be seen that the correlation coefficients of niño 34 and cdhf cdhmi are basically consistent in spatial distribution showing mainly positive correlation in coastal areas but negative correlation in most regions of the country especially in inner mongolia and the middle and lower reaches of the yangtze river the probability of concurrent heatwaves in different summer months under a drought background varied with space heatwave events occurred less in most parts of eastern china in may owing to the influence of large scale climate circulation plum rain is annually concentrated in areas between the yangtze river and huai from early june to july zhou et al 2021 and drought events rarely occur which explains the low cdh event probability in the yangtze huai river basin under a drought background in may and june however droughts in july and august are often accompanied by heatwaves which pose human and ecological health threats the response of droughts to heatwaves may be closely related to the water vapor transport and circulation background which requires further investigations additionally studies have found that urbanization and other anthropogenic influences have significantly increased the occurrence of extremely high temperatures in summer in china since the beginning of the 21st century wang et al 2018 zhang et al 2021b such that we cannot underestimate the influence that human factors have on heatwaves and droughts 5 conclusions based on daily meteorological data at 1 784 meteorological stations in eastern china from 1960 to 2019 this study analyzed the temporal and spatial distribution of various heatwave metrics the frequency of cdh events and their relationships with meteorological droughts in eastern china the main conclusions are as follows 1 the heatwaves from may to september in eastern china tended to start earlier and end later with a prolonging trend in the duration the frequency duration and intensity of heatwaves and the frequency of cdh events significantly increase after 2000 the heatwave events were mainly distributed from the plains along the middle and lower reaches of the yangtze river to the sichuan basin whereas the cdh events were mainly distributed from the northeastern plains to the middle and lower reaches of the yangtze river 2 there was a significant correlation between the drought intensity and heatwave duration and intensity in northeastern china and the yangtze huai river basin from july to september the effect that droughts had on the heatwave intensity was more significant under the influence of drought the heatwave intensity was greater and the heatwave duration was longer the promoting effect of drought was more significant in the northern and some southern regions where heatwave occurrence is less frequent 3 heatwaves in eastern china were influenced by the wpsh the heatwave intensity and wpsh intensity index tended to exhibit coordinated variation after 2000 the mean position and intensity of the wpsh were west and strong respectively which were closely related to heatwave occurrences in eastern china credit authorship contribution statement yaojin bian conceptualization methodology software peng sun data curation writing original draft visualization investigation qiang zhang data curation writing original draft ming luo writing review editing ruilin liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is partially funded by national natural science foundation of china 42041006 national key r d program of china 2019yfa0606900 nature science foundation for excellent young scholars of anhui 2108085y13 key research and development program project of anhui province china 2022m07020011 anhui major science and technology projects 202003a06020002 the university synergy innovation program of anhui province gxxt 2021 048 university outstanding young talents support project of anhui gxyqzd2021094 
3071,amplifying the frequency and loss of weather and hydrological extremes under climate warming have aroused increasing human concerns in recent decades and it is particularly the case for compound drought heatwave cdh events the drought index based on the hypothesis of non stationarity is of great significance for the study of cdh events here we presented spatiotemporal patterns of cdh general heatwaves ghw he heatwave that does not occur in dry months and relevant circulation backgrounds in eastern china we found that heatwaves are starting earlier and ending later and later while the termination date of heatwaves in southern china is late than those in northern china significant increases since the 1980 s were detected in the frequency duration and intensity of heatwaves and the frequency of cdh events in eastern china besides heatwaves were observed mainly in the middle and lower yangtze river basin and in the sichuan basin as well most areas of eastern china were dominated by higher occurrence probability of cdhs in july and the probability was as high as 0 49 the duration and intensity of the cdhs were 0 28 days longer and 11 14 higher than ghws further examinations show that the western pacific subtropical high wpsh has a significant influence on the occurrence of heatwaves the average position of the wpsh is shifted westward and its intensity is relatively stronger thus favoring the occurrence of heatwave events the occurrence of compound events in eastern china cannot be separated from the influence of large scale circulation and atmospheric changes keywords heatwaves meteorological drought compound drought heatwave events nspei data availability the authors do not have permission to share data 1 introduction global warming will amplify extreme meteorological events and will have profound impacts on socioeconomic development gao et al 2019 tegegne et al 2020 zscheischler et al 2018 compared with single extreme event the impact of compound drought heatwave cdh events is more severe leonard et al 2014 zhang et al 2021b the cdh disasters in eastern europe and russia in 2003 2010 and 2018 caused considerable mortalities and socioeconomic losses liu et al 2020 cdh events in europe have resulted in two fold increase in crop losses over the past 50 years bras et al 2021 therefore a thorough understanding of cdh is highly significant for human mitigation to natural hazards in the backdrop of global warming a heatwave event is defined as a period with air temperature higher than a certain threshold and synchronous occurrence of drought and heatwave is defined as a cdh event kong et al 2020 shi et al 2021 mukherjee and mishra 2020 drought is usually accompanied by high air temperature and sometimes heatwave lu et al 2018 luo et al 2017a compared with weather and climate isolated events compound events can have severe socio economic effects even if the individual events that make up the compound event are not all extreme events ridder et al 2020 chapman et al 2019 the occurrence and effects of cdh events have been studied extensively increased frequency and severity of cdh events were reported across china kong et al 2020 luo et al 2022 india sharma and mujumdar 2017 the united states mazdiyasni and aghakouchak 2015 and europe manning et al 2019 further studies include the application of combined distribution and magnitude index to grade assessment wang et al 2018 zhang et al 2022 previous studies are generally based on stationarity hypothesis to calculate drought index however in the context of frequent human activities and global warming stationary hypothesis has been gradually questioned gu et al 2019 rashid and beecham 2019 recent studies in different parts of the world have showed that stationarity assumption has been difficult to apply to change of climate song et al 2020 zhang et al 2021a therefore it is necessary to study drought index based on non stationary hypothesis moreover it seems that drought promotes heat waves shi et al 2021 the temporal and spatial differences of such promoting effect still need further research so as to explore the mechanism behind drought triggering and amplifying the heat waves and provide a basis for possible further research in the future eastern china east of 100 e is mainly characterized by a monsoon climate and the western north pacific subtropical high wnpsh and it is also heavily populated and highly economically developed liu et al 2019 zheng et al 2019 located in the east part of eurasia continent eastern and neighbored to the pacific ocean eastern china hence is highly sensitive to climate changes and weather extremes there have aroused considered concerns from academic community zhang et al 2017 chen and zhai 2017 however the spatiotemporal behaviors of chd in eastern china remain unclear and warrant further examinations by using both relative and absolute air temperature thresholds to identify heatwaves and using the non stationary standardized precipitation evapotranspiration index nspei to identify drought events here we analyzed spatiotemporal patterns of cdh across eastern china from 1970 to 2019 and quantified the relations of heatwaves with droughts and the changes of cdh events 2 data and methods 2 1 data the meteorological data during 1970 2019 used in this study were sourced from the national climate center of the china meteorological administration cma https data cma cn specific variables include precipitation and temperature wind speed barometric pressure sunshine hours relative humidity and other variables needed in the calculation of potential evapotranspiration considering the length of the data and excluding the stations with 1 missing record we selected 1784 meteorological stations covering most of eastern china fig 1 and the meteorological stations were classified into four groups with different grades of duration and intensity of the heatwaves by hierarchical clustering method stations with almost no risk of heatwaves anr stations with low risk of heatwaves lr stations with medium risk of heatwaves mr and stations with high risk of heatwaves hr the missing data were processed based on cubic convolution zhang et al 2011 and the wpsh intensity index was obtained from the climate monitoring center of cma the geopotential height and other reanalysis data were obtained from theera5 reanalysis datasets with 0 25 spatial resolution and month time resolution https www ecmwf int 2 2 methods 2 2 1 definition of heatwaves heatwave event has been defined by cma as a period with daily maximum temperature of 35 c for at least 3 consecutive days e g shen et al 2018 however the heatwave indicators by absolute thresholds tend to underestimate the damage or losses caused by heatwaves at high latitudes and are not appropriate for analysis of heatwaves in various regions xie et al 2020 luo and lau 2021 the relative threshold by percentile of temperature can reflect the adaptation of inhabitants to high air temperature in different climate regimes however it is difficult to differentiate the high temperature based on the index and the actual high temperature ye et al 2013 in this case we took the relative and absolute temperature thresholds to define heatwaves when t 90 i e 90th quantile temperature of the maximum daily summer temperature 30 c t 0 t 90 otherwise when t 90 30 c t 0 30 c a heatwave process occurs if the daily maximum temperature i e t max t 0 lasts for 3 days for the sake of spatiotemporal analysis of the heatwaves we analyzed the heat wave frequency hwf the yearly number of heat waves heat wave duration hwd the duration of a heatwave event and heat wave intensity hwi the sum of the daily maximum temperatures during throughout a heatwave event luo et al 2020 ye et al 2013 2 2 2 non stationary standardized precipitation evapotranspiration index the standardized precipitation evapotranspiration index spei has been widely used in studies of meteorological drought beguería et al 2014 vicente serrano et al 2010 however spei assumes stationarity of the meteorological processes and may potentially overestimate the responses of meteorological droughts to warming climate here we proposed a non stationary standardized precipitation evapotranspiration index nspei to monitor meteorological droughts across eastern china wen et al 2020 it is to use time varying position parameters to fit log logistic distributions the nspei was computed as follows 1 calculate the difference d t between monthly precipitation p t and monthly pet t 1 d t p t pet t the smooth spline function was then used to fit d t 2 s s dt h t 1 n d t f d t 2 h d t min dt max f d t 2 d t where f is a linear fitting function of d t h is a smoothing parameter t is the time series t 1 n and pet t is the potential evapotranspiration based on the penman monteith evapotranspiration formula so ss dt is a data series calculated by local polynomial regression fitting of d t according to eq 1 and eq 2 the time varying position parameters γ d t can be obtained as follows γ d t t s s dt in eq 3 the position parameter γ d t is equal to s s dt at time t 2 calculate the log logistic probability distribution d t 4 f d t α β γ d t a β d t γ d t α β 1 1 d t γ d t α β 2 5 f x 0 x f d t α β γ d t d t 1 α d t γ d t β 1 where α β and γ d t are the scale shape and position parameters respectively 3 estimate the parameters using probability weighting methods pwms vicente serrano et al 2010 based on the empirical frequency to compute nspei 6 w s 1 n i 1 n 1 f i s d i f i i 0 35 n 7 nspei w c 0 c 2 c 3 w s 2 1 d 1 w s d 2 w s 2 d 3 w s 3 w 2 ln p in eq 6 n is the number of data series and f i is the frequency estimation ws is the s order of pwm in eq 7 when p 0 5 p is the cumulative probability and p 1 f x when p 0 5 p 1 p the other parameters are as follows c 0 2 515517 c 1 0 802853 c 2 0 010328 d 1 1 432788 d 2 0 189269 and d 3 0 001308 table 1 presents the classification table for the nspei 2 2 3 cdh events and compound event magnitude index a cdh event refers to the synchronous occurrence of meteorological drought and heatwave we identified the monthly drought conditions based on the nspei index heatwave events that occur in dry months according to the starting date of the heatwave process are considered as cdh events kong et al 2020 the cdh frequency was calculated based on the dry months in which the heatwave occurred no matter how many heatwaves occurred in that month besides we also analyzed the occurrence probability of heatwave events in a backdrop of atmospheric drying conditions where the number of dry months with heatwave events regardless of the number of heatwave processes were subdivided by the total number of dry months we have analyzed the annual frequency of cdh events cdhf months with cdh events per year and the variations in the compound drought heatwave magnitude index cdhmi and the maximum duration of cdh events reflects the maximum duration of heatwave days in a drought context the cdhmi is calculated based on the probability of heat wave and drought events exceeding normal thresholds and reflects the intensity of the composite event to some extent wang et al 2021 wu et al 2019 zhang et al 2021c the cdhmi is calculated as follows fig 2 c d h m i p d δ d p t i 1 n δ t n δd indicated the magnitude of drought which is the difference between monthly drought indicator nspei and the drought threshold the threshold was 0 according to the nspei calculation and δd 0 if no drought occurs in the month δt indicated the magnitude of heatwaves which is the difference between the maximum temperature and the temperature threshold t0 during all heatwave occurrences and the temperature threshold was determined in a similar way to 2 2 2 and n is the number of days in the month on which the cdh event occurred number of all heatwave days in the month pd δd and pt δt are the probabilities of δd and δt obtained from empirical distributions based on non parametric distributions 2 2 4 statistical methods here we used correlations by the kendall τ test ribeiro et al 2020 to analyze the spatiotemporal distributions of heatwave events the generalized pareto gp distribution was used to fit the duration and intensity of composite heatwave events huang et al 2021 we calculated the spatiotemporal variation in the return periods and the probability density distributions of the heatwave duration and intensity for each station kernel density estimation is a non parametric test method that can examine the distribution characteristics of data from the data itself okabe et al 2009 and it was used to analyze the characteristics of the probability of heatwaves under a dry condition at monthly scale 3 results 3 1 spatiotemporal patterns of heatwaves we counted the median start date ending date of the first last heatwave events for each year at all stations over eastern china we found that the start date of the heatwaves tended to be earlier while the ending date tended to be prolonged fig 3 a implying lengthening heatwave events over the past decades we calculated the average frequency of daily heatwaves total number of heatwaves occurring at all stations during 1970 2019 divided by the total number of stations fig 3b heatwave events occurred mainly in late july and early august the frequency of daily heatwaves gradually increased from may and fewer heatwaves can be detected in september according to the spatial distribution of the onset date of the first heatwaves the ending date of the last heatwaves and the average total heatwave duration within a year fig 4 the first heatwave event occurred in may from yunnan guizhou plateau to hainan island with a relatively long duration fig 4c the first heatwave in large regions of southern china began in mid july and usually ended in late august in the north china plain the first heatwave event started earlier in june but the total duration was shorter and the last heatwave ended in late july the onset of heatwaves in northern china was earlier than that in most parts of southern china the end of the last heatwave in southern china was significantly later than that in northern china in the yunnan guizhou plateau the onset of heatwaves was the earliest with the longest total duration fig 5 shows the distribution of each heatwave indicator in most of the eastern region there are no large differences in hwf and heatwaves occur slightly more frequently in the south than in the north heatwaves affected most parts of eastern china every year except for central inner mongolia and northern heilongjiang region the hwf and the hwd of a single heatwave event were highly consistent in their spatial distributions the high values of hwi and hwd were concentrated in the plains along the middle and lower yangtze river basin sichuan basin and the western inner mongolia the mean hwi was approximately 200 c long duration heatwaves generally lasting for approximately 4 6 days were more concentrated along the coastal regions of eastern china although the hwf in northern and northeastern china was not distinctly different from that in the yangtze huai river basin the intensity and duration of the heatwaves were evidently lower than those in the yangtze huai river basin fig 5b c after 2000 the annual frequency and intensity of heatwaves were evidently higher than those prior to 2000 for stations in anrs lrs and hrs as identified in heatwave indicators fig 6 the variation in the hwd was not evident for most regions of the study area the hwd was shorter at the stations with less heat waves the average frequency of heatwaves from 1970 to 1980 was 1 39 and it increased to 1 93 in 1981 2019 after 1980 all heatwave metrics exhibited significant upward trends at significance level 3 2 correlation between heatwaves and meteorological droughts here we quantified the correlation coefficients between drought intensity and heatwave duration and intensity at stations with different heatwave grades in various months given the occurrence of droughts with nspei 0 generally the correlation coefficients between drought intensity and heatwave duration and intensity are regionally varying figs 7 and 8 collectively illustrate the spatial distribution of correlation coefficients between drought intensity and hwd and intensity for each month the stations marked in figs 7 and 8 are characterized by significant correlations between drought intensity and hwd and intensity at 0 05 significance level and the negative correlations between drought intensity and the duration and intensity of heatwaves rarely passing the significance test in may and september no significant correlations between drought and heatwave were detected in most parts of eastern china significant correlations between drought and heatwave were detected mainly in the yunnan guizhou plateau in may and in some areas of southern china in september in july positive correlations between heatwave and drought were found in the northeast china plain but correlations between drought and heatwave were not significant in eastern parts of northeast china plain high correlations between drought and heatwave from july to september were found mainly in northeast china and the yangtze huai river basin droughts from july to september exhibited significant correlations with heatwave duration and intensity in northeast china and the yangtze huai river basin 3 3 spatiotemporal characteristics of cdh it can be seen in fig 9 that high cdhf was found mainly across the northeast china plain to the middle and lower yangtze river basin most regions of eastern china were characterized by one cdh per year fig 9a besides the cdhf was also of 0 12 10a in increasing magnitude meanwhile an upward trend of 0 2 10a in cdh was also detected from 1990 to 2019 after 2000 cdh events were subject to persistent a high frequency fig 9c the cdhmi and cdhf shows the same spatial distribution and is more concentrated in the northern part of china in particular the rising trend of cdni became significant after 2000 fig 9b 9d fig 10 shows the spatial distribution of the maximum duration and cdhmi of the cdh event for the 20 50 and 100 year recurrence period the spatial distribution of maximum duration and cdhmi is basically the same however cdhmi is more concentrated in the area north of the huaihe river where high values of maximum duration reaching around 15 20 and 23 days for the 20 50 and 100 year events and high values of cdhmi above 0 3 0 4 and 0 5 respectively most areas in eastern china have a high risk of heat waves cdh events can cause greater loss and harm as the recurrence period increases 3 4 effects of drought on heatwaves we now proceed to evaluate the probability of heatwave events under the occurrence of droughts the peak value of the kernel density estimation can reflect the central tendency in the sample dataset as indicated in fig 11 the peak probabilities of heatwave with drought in may and september were approximately 0 was 0 14 and 0 59 in june 0 67 in july and 0 53 in august the probability of heatwaves under the occurrence of droughts in may and september was low while heatwaves and drought are frequent from june to august such that cdh events were frequent fig 11a shows the spatial distribution of the heatwave probabilities under droughts from may to september in may higher probability can be mainly identified in the yunnan guizhou plateau and low probability approximately 0 appears in most parts of eastern china in june higher probability can be identified in most areas of the north china plain and the loess plateau and low probability is mainly seen in the yangtze huai river basin in july the center with higher probability of heatwaves with drought shifted to the yangtze huai river basin and the inner mongolia plateau in most portions of eastern china drought events were highly likely to trigger heatwaves in august higher probability are seen in the southern yangtze huai river basin the probability in most regions of eastern china was higher than 0 5 in september the range of high probabilities was small and high probability can be found only kin the pearl river basin and the ganjiang river basin it can also be seen in fig 11 that the impacts of droughts on heatwaves vary across both space and time droughts in july were sensitive to heatwaves in most parts of eastern china based on fig 3b and 11 there were few heatwaves in september and the heatwave duration and intensity were significantly correlated with droughts therefore the heatwave process in southern china in september was closely related to drought fig 12 shows the proportions of droughts with different intensities and the probability of heatwaves under different drought conditions i e with different intensities although the proportion of extreme drought 0 02 was significantly lower than that of mild drought 0 68 the probability of a heatwave given extreme drought was the highest reaching 0 49 the higher the drought level the lower the occurrence proportion of droughts but the higher the probability of heatwaves implying that higher drought intensity can potentially trigger occurrence of heatwaves drought has a significant influence on heatwave duration and intensity fig 13 shows the probability densities for the duration and intensity of cdh and ghw see methods events in different clustered subregions of eastern china the duration and intensity of the cdh events under the influence of drought generally shifted to the right side where the peak value position of the probability density curve was higher than that of the ghw events this indicates that the intensity of cdh events was larger the duration was longer and these events tend to cause more serious damage the cdh duration intensity was 0 27 8 84 0 25 10 37 and 0 34 d 14 20 longer than that of ghw events in the regions of low medium and high risk of heatwaves respectively the differences in the duration and intensity of the cdh and ghw events are compared in fig 14 in most parts of eastern china the duration and intensity of the cdh events were greater than those of heatwaves with lower intensity and shorter duration this evident difference was found across the yunnan guizhou plateau qinghai tibet plateau and northeast china where the heatwave frequency was low the difference in the largest duration intensity was up to 3 0 d 95 2 between the cdh and ghw events but a negative average difference is shown in the southern region such as guangdong and guangxi provinces with frequent heatwaves the duration intensity of heatwaves is longer stronger under a drought background in areas with few heatwaves implying that the effects of drought on heatwave is more significant in areas with less frequent heatwave 4 discussions indices based on different temperature thresholds often have certain uncertainties in definition of heatwave regimes which may be due to differences in the spatial and temporal distribution of various temperature thresholds you et al 2016 absolute temperature thresholds have been often used in studies at regional scales whereas relative thresholds have been widely used in studies at larger temporal or spatial scales luo et al 2020 trancoso et al 2020 eastern china is a vast territory with significant climate differences where the inhabitants of different subregions show different adaptations to high temperatures therefore selecting a unified index to measure changes in heatwaves across all of eastern china is complex in this study a combination of relative and absolute thresholds was selected to identify heatwaves to avoid the occurrence of an excessively low threshold in high latitude and high altitude areas when applying a relative threshold to analyze heatwaves across the entire study area demonstrating a certain rationality and applicability wu et al 2020 ye et al 2013 studies based on different thresholds have reported the increases in the heatwave frequency duration and intensity at regional and global scales kong et al 2020 manning et al 2019 mazdiyasni and aghakouchak 2015 which is similar to the observations obtained in this study in eastern china the upward trend in the heatwave frequency duration and intensity was more significant since 2000 there is a connection between heatwave events and global climate change although studies have shown that there is a current slowing of global warming extreme high temperature events occur with higher frequency in china li et al 2021b wang et al 2016 additionally many studies have discussed the causes behind heatwaves in china from an atmospheric circulation perspective the el niño phenomenon strengthens the anticyclone and subtropical high in the western pacific thus providing favorable conditions for the occurrence and maintenance of heatwaves luo and lau 2018 also pointed out that heatwave activity increases in the summer after the el niño phenomenon moreover the wpsh exerts significant impacts on heatwaves in eastern china with a wide range of air subsidence frequent high temperatures and negligible precipitation in the control area of the wpsh ridge liu et al 2019 ma et al 2020 fig 15 shows the interannual variation in hwi cdhmi and wpsh intensity index wpshi in may september in most years the hwi and wpshi change synergistically and their correlation coefficient between the heatwave intensity and wpsh intensity reached 0 55 passing the 0 05 significance test in contrast the direct correlation between cdhmi and wpshi was not significant but the correlation between hwi and cdhmi showed a high correlation passing the 0 05 significance test it can be seen that to some extent the wpsh have a greater influence on the general heat wave than cdh event fig 16 shows the change in the 500 hpa geopotential height field in july and august i e the hottest summer months before and after 2000 mutation year the average position of the wpsh after 2000 was more westward than that before 2000 the changes in the intensity and position of the wpsh should be one of the reasons for the frequent heatwave occurrence in eastern china after 2000 it is noted that the abnormal westward movement of the wpsh resulted in an abnormally high pressure and high temperature evolution such that heatwaves in southern china were often accompanied by an abnormal high pressure center and near surface anticyclonic while simultaneously reducing the water vapor transport between the land and sea luo and lau 2017b cdh events in eastern china have been widely discussed some scholars have established the standardized compound drought and heat index scdhi for the evaluation of cdh events in china they found the occurrence frequency of cdh events is high in south china li et al 2021a the dry hot magnitude index also has a wide range of applications in the analysis of composite events wang et al 2021 wu et al 2019 the researchers found that high magnitude levels of composite dry hot events occurred mainly in northeast and southwest china and mainly in recent decades since the 1990 s based on the nspei index we analyzed the frequency and trend of cdh events based on the identification of concurrent drought and heatwave events and found that cdh events generally occurred in the northeast plain north china plain and yangtze huai river basin there is a connection between compound events and large scale climate change mukherjee and mishra 2020 based on poisson generalized linear model the occurrence of compound events and el nino southern oscillation enso show a strong correlation in the southern hemisphere then we further analyzed the degree of correlation between enso east central tropical pacific temperature and cdhmi and made the following spatial distribution of correlation fig 17 considering that the development of niño 3 4 is most obvious in winter zambrano mera et al 2018 we performed a correlation analysis using niño 3 4 values of previous winter it can be seen that the correlation coefficients of niño 34 and cdhf cdhmi are basically consistent in spatial distribution showing mainly positive correlation in coastal areas but negative correlation in most regions of the country especially in inner mongolia and the middle and lower reaches of the yangtze river the probability of concurrent heatwaves in different summer months under a drought background varied with space heatwave events occurred less in most parts of eastern china in may owing to the influence of large scale climate circulation plum rain is annually concentrated in areas between the yangtze river and huai from early june to july zhou et al 2021 and drought events rarely occur which explains the low cdh event probability in the yangtze huai river basin under a drought background in may and june however droughts in july and august are often accompanied by heatwaves which pose human and ecological health threats the response of droughts to heatwaves may be closely related to the water vapor transport and circulation background which requires further investigations additionally studies have found that urbanization and other anthropogenic influences have significantly increased the occurrence of extremely high temperatures in summer in china since the beginning of the 21st century wang et al 2018 zhang et al 2021b such that we cannot underestimate the influence that human factors have on heatwaves and droughts 5 conclusions based on daily meteorological data at 1 784 meteorological stations in eastern china from 1960 to 2019 this study analyzed the temporal and spatial distribution of various heatwave metrics the frequency of cdh events and their relationships with meteorological droughts in eastern china the main conclusions are as follows 1 the heatwaves from may to september in eastern china tended to start earlier and end later with a prolonging trend in the duration the frequency duration and intensity of heatwaves and the frequency of cdh events significantly increase after 2000 the heatwave events were mainly distributed from the plains along the middle and lower reaches of the yangtze river to the sichuan basin whereas the cdh events were mainly distributed from the northeastern plains to the middle and lower reaches of the yangtze river 2 there was a significant correlation between the drought intensity and heatwave duration and intensity in northeastern china and the yangtze huai river basin from july to september the effect that droughts had on the heatwave intensity was more significant under the influence of drought the heatwave intensity was greater and the heatwave duration was longer the promoting effect of drought was more significant in the northern and some southern regions where heatwave occurrence is less frequent 3 heatwaves in eastern china were influenced by the wpsh the heatwave intensity and wpsh intensity index tended to exhibit coordinated variation after 2000 the mean position and intensity of the wpsh were west and strong respectively which were closely related to heatwave occurrences in eastern china credit authorship contribution statement yaojin bian conceptualization methodology software peng sun data curation writing original draft visualization investigation qiang zhang data curation writing original draft ming luo writing review editing ruilin liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is partially funded by national natural science foundation of china 42041006 national key r d program of china 2019yfa0606900 nature science foundation for excellent young scholars of anhui 2108085y13 key research and development program project of anhui province china 2022m07020011 anhui major science and technology projects 202003a06020002 the university synergy innovation program of anhui province gxxt 2021 048 university outstanding young talents support project of anhui gxyqzd2021094 
3072,while many modeling techniques have been developed to derive forecasts frequency estimates and projection of droughts and floods approaches that can inform how likely the two opposite extreme events could transit or propagate as cascades in time are still lacking here we proposed a probabilistic framework to serve the purpose specifically the framework allows to 1 identify successive occurrence of hydrological droughts and fluvials 2 estimate the probability of transition from a prior hydrological drought to a succeeding fluvial and 3 make predictions of fluvials given a preceding dry spell we applied this framework to predict the following fluvial severity based on the characteristics of hydrological drought at two runoff stations as an illustration they are located in the doingjiang basin of southern china station i and the eel river of united states station ii respectively our results show that the proposed framework can capture the observed fluvials based on the prior drought information at both stations attesting to its skillful predictability the transition probability estimate indicates that appreciable changes in the joint distribution of hydrological droughts and fluvials over time at station i where the increased drought severity tends to enhance the occurrence likelihood of the fluvial happening in close succession while station ii is subject to the opposite effect collectively this study is expected to broaden the understanding of unusual shifts between droughts and floods while providing useful information to help policy makers and infrastructure operators develop integrated approach to drought and flood management in the future keywords probabilistic framework droughts fluvials prediction runoff 1 introduction over the past 40 years the weather pattern reveals that wet areas have become wetter and dry areas have become drier putnam and broecker 2017 behind this weather pattern is its impacts on droughts and floods various regions of the world are seeing strong evidence toward more frequent floods and droughts both with increasing severity as a result of the adjustment in the rainfall distribution madsen et al 2014 shao and kam 2020 some areas in particular have experienced wild swings between the two for instance the summer of 2002 in europe brought widespread floods but was followed a year later in 2003 by drought droughts were back to feature the news headlines of chennai india just a few years after the 100 year rainfall of 2015 more dramatically a persistent and intense drought baked california u s between 2012 and 2016 yet it was replaced by record breaking torrentialprecipitation which resulted in statewide flooding during the succeeding winter of 2016 2017 in china drought to flood alternation events have also been reported in many parts of the country including the middle and lower reaches of the yangtze river basin huai river basin pearl river basin and shandong province etc bi et al 2020 shi et al 2021 yang et al 2013 it s a cycle that is becoming more common around the globe the media has dubbed the phenomenon as climate whiplash indicating wild weather patterns that swing from one extreme to another while a certain amount of the swing is part of the natural climate variability what calls attention is the synchronicity of droughts and floods droughts can cause severe food shortages damage the environment for animal lives lead to poor biodiversity for aquatic lives bank erosion salinity intrusion and health problems for household communities due to contaminated water quality each year floods can cause in varying degree of damage to agriculture rural infrastructure residential areas and essential services the consecutive occurrence of such reversed extreme events can cost nations billions of dollars in damages and threaten very lives of millions of people by challenging the resilience of critical infrastructures in much quicker cycles than one would typically plan for winsemius et al 2018 according to the national oceanic and atmospheric administration assessment of severe weather and climate events on average droughts and floods cost the united states about 9 5 billion and 4 3 billion per event respectively in terms of the number of people affected by climate related disasters extreme rainfall and the extreme lack of it dominate the picture since the 21st century floods have affected the largest number of people at more than two billion followed by drought which affected a further 1 5 billion people in 1998 2017 as reported by the united nation office for disaster risk reduction wallemacq 2018 in 2019 a total of 47 67 million people were affected by floods in china with 658 people dead or missing the direct economic loss amounted to 192 27 billion rmb accounting for 0 19 of gdp that year based on the china flood and drought disaster bulletin just in 2021 summer henan province in central china received more than its annual average rainfall in four days and recorded a year s worth of rain in just a few days with a record 201 9 mm of rainfall within an hour more than 300 people died and 50 people are missing moreover a swing from droughts to floods and back can become ever more severe since a growing global population increasing urbanization and pressures from agriculture and industry scarce water resources put more people at risk rapid drought flood transitions further challenge water management and reservoir operation because of trade offs between long term water storage and short term flood control he and sheffield 2020 though floods and droughts are different from a process perspective similar methods and modeling techniques are often used to derive both types of extremes for example the common approach for drought and flood forecasting applies hydrological models to simulate continuous streamflow time series with inputs from numerical weather models alfieri et al 2013 cloke and pappenberger 2009 emerton et al 2016 pagano et al 2014 xu et al 2020 yuan et al 2013 to yield future predictions and projections of droughts and floods one can drive a hydrological model with meteorological data from a global or regional circulation model e g addor et al 2014 mendoza et al 2015 mizukami et al 2016 or employ hybrid statistical dynamical techniques which incorporate time or physically based variables into a statistical framework e g madadgar et al 2016 slater and villarini 2018 furthermore a wide range of parametric distribution free non parametric semi parametric or kernel based methods have been developed in the literature to describe the occurrence probability or return period of droughts and floods rao and hamed 2019 todorovic and zelenhasic 1970 most of these modeling techniques focus on one type of the two extreme events either droughts or floods therefore having limited skill to provide a joint picture of how droughts and floods evolve together e g jongman et al 2014 shahid and behrawan 2008 growing evidence indicates that the abrupt shifts in climate droughts followed by floods are intensifying with the tendency toward shorter term reversal casson et al 2019 prein et al 2017 swain et al 2018 the more frequent and the more connected drought flood seesaws can change the storage of nutrients in the agricultural landscape while degrading a region s quality of water supplies additionally greater year to year volatility in the natural supply of water to the reservoirs would exert added stress on water management and potentially lead to an increase in wildfires since wet years promote the growth of vegetation that could become fuel for fires during dry years it became apparent that droughts and floods occurring in close succession pose a potential threat which cannot be eradicated but has to be managed as a result approaches that can quantify how likely the two opposing extremes could transit or propagate as cascades in time are increasingly needed such information would be beneficial for policymakers and infrastructure operators to prioritize actions that affect water resources objectives of flood control drought mitigation and water quality protection this study responds to the need by introducing a probabilistic framework specifically the framework proposed here allows to 1 identify sequential hydrological drought and fluvial events 2 estimate the probability of transition from a prior hydrological drought to a succeeding fluvial and 3 make predictions of fluvials given a preceding dry spell in the following section 2 demonstrates the proposed method section 3 presents the results and findings and section 4 dedicates to further discussions 2 project data it has been noted that a single unique definition of drought does not exist due to its multi discipline characters for this reason droughts have been classified into different types consisting of meteorological hydrological agricultural ecological or socioeconomic factors likewise floods can appear in a variety of forms ranging from small flash floods to large coastal and urban floods although this study focused on the hydrological droughts and fluvials characterized by shortfalls or surplus in surface runoff it is worth noting that the proposed framework can be adapted to other types of droughts and floods we illustrate the proposed method with monthly runoff data from 1960 to 2012 at two stations fig 1 shows the location of these two stations as shown station i on the left of fig 1 is within the doingjiang basin of southern china provided by the guangdong hydrological bureau china liu et al 2015 station ii is from the us geological survey usgs usgs id 03328500 on the right of fig 1 located in the eel river close to logansport of indiana united states maity et al 2013 3 methodology fig 2 gives a schematic diagram of the proposed framework it involves three major components 1 calculating the joint runoff drought index for identifying the sequential hydrological drought fluvial events 2 estimating the probability of transition from hydrological drought to fluvial and 3 predicting fluvials based on the preceding drought conditions below is the description of each component 3 1 identify hydrological drought to fluvial events based on the joint runoff drought index standardized indices such as the standardized runoff index sri have been often applied to identify hydrological droughts and fluvials but the use of such a univariate index can lead to inconsistent results for event characterization at different temporal scales e g 1 month 3 month etc to address this limitation the joint runoff drought index also known as jrdi has been developed liu et al 2016 the jrdi characterizes an overall drought condition by integrating runoff information of sri over multiple temporal scales therefore combining the strength of short term sri in detecting drought onset and long term sri in representing drought persistence kao and govindaraju 2010 liu et al 2016 herein jrdi which combines 1 month 3 month and 6 month sri was used to facilitate the identification of sequential drought fluvial events derivation of the jrdi includes the following steps 1 compute the sri at three time windows i e 1 month 3 month and 6 month sri 2 fit appropriate marginal distributions to each of the three sri based indicators i e u 1 u 2 u 3 3 build the joint distribution of the three margins i e c u 1 u 2 u 3 where c denotes the c vine copula function 4 employ kendall distribution transformation to generate the cumulative probability function cdf that measures the probability of the 3 dimensional copula values less than or equal to a given quantile q 1 k c q p c u 1 u 2 u 3 u 1 u 2 u 3 q 5 obtain the jrdi by inversing the normal function ϕ 1 2 j r d i ϕ 1 k c q the jrdi combines the strengths of the short term drought indicator in tracking the drought onset and long term drought indicator in capturing the drought durations and it thus may provide a more overall drought assessment as compared to the sris the drought severity categories characterized by the jrdi are consistent with the original standardized drought indices more details about the application of c vine copula bedford and cooke 2002 klein et al 2016 li et al 2014 and the jrdi can be found in liu et al 2016 the r package i e vinecopula was applied to estimate the joint distributions aas et al 2009 brechmann et al 2013 with the jrdi time series we sampled hydrological drought to fluvial cases as the occurrence of two consecutive events during which jrdi falls below 0 and subsequently exceeds 0 at each station when the runoff deficit persists we computed the sum of the jrdi over those consecutive months to represent the drought severity and the mean severity is drought severity divided by drought duration if a drought is immediately followed by the jrdi with a magnitude greater than 0 one sequential drought fluvial event occurs the sampled cases were subsequently fitted to the conditional copula for estimating the occurrence probability of drought to fluvial scenarios as explained in section 3 2 3 2 estimate hydrological drought to fluvial transition probability to obtain the occurrence probability of one variable under the given conditions we followed the procedure outlined by yue and rasmussen 2002 briefly let f x y be the joint probability density function pdf of two continuous random variables x herein the magnitude or severity of fluvial in the next month and y herein the drought characteristics e g the mean severity of drought severity duration f x x and f y y be the marginal pdfs of x and y respectively and f x x f y y and f x y be the corresponding cumulative distribution functions cdfs for their univariate and bivariate variables the conditional pdf of x given y y can be expressed as 3 f x y x y f x y f y y based on the pdf the conditional cdf of x given y y is derived as 4 f x y x f x y u y d u x f u y d u f y y similarly the conditional cdf of x x given y y has the following expression 5 f x y x y f x y y f x y f y y the exceeding probability of equation 5 is a measure of the likelihood associated with the event x x given y y which is formulated as 6 p x x y y 1 f x y y 1 f x y f y y if a drought has occurred in the first place the interest is to estimate how likely the following month would be subject to the opposite scenario i e fluvial essentially that is the probability of x conditioned upon y i e p x x y y where x and y represent the thresholds for defining the wet and dry states respectively this conditional probability conveys the likelihood of a subsequent fluvial occurring given that a prior hydrological drought has occurred it can also be interpreted as the probability of transitioning from one state to another herein drought to fluvial in a single step broadly known as the one step transition probability the key to solving equation 6 replies on the construction of the joint distribution between x and y in this study we employed the bivariate copula which allows for joining the margins and modeling the joint dependence structure between extreme wet and dry states of surface runoff 3 3 probabilistic prediction of fluvials based on the preceding drought conditions the proposed framework considered drought characteristics including severity x 1 mean severity x 2 i e drought severity divided by drought duration and duration x 3 of the prior drought to predict the fluvial x 4 in succession in other words the fluvial in the following month is predicted based on the three indicators of the drought that has already occurred this can be realized by building a 3 dimensional or 4 dimensional conditional prediction model via the vine copula and sequentially applying the inverse form of the h conditional function also known as conditional probability function which could be expressed as follows 7 f u 3 u 1 u 2 u 3 h h u 3 u 1 θ 13 h u 2 u 1 θ 12 θ 32 1 8 f u 4 u 1 u 2 u 3 h h h u 3 u 1 θ 13 h u 2 u 1 θ 12 θ 32 1 h h u 4 u 1 θ 14 h u 2 u 1 θ 12 θ 42 1 θ 34 12 where θ 12 θ 13 θ 14 θ 32 1 θ 42 1 and θ 34 12 denote the parameters of different conditional copulas in the 3 or 4 dimensional c vine and the vinecopula of the r package schepsmeier et al 2015 was applied to facilitate the estimation of the conditional functions a schematic illustration of the drought characteristics and the hydrological drought to fluvial events identified with the jrdi is given in fig 3 with the conditional expression in eq 8 we further derived its inverse form to estimate the fluvial severity as given below 9 x 4 q x 4 τ x 1 x 2 x 3 f 1 u 4 f 1 h 1 h 1 h 1 τ h h u 3 u 1 h u 2 u 1 h u 2 u 1 u 1 therefore we can estimate x 4 based on the given variables x 1 x 1 and x 3 ren et al 2014 in this study we produced 200 uniformly distributed random numbers over the interval 0 1 i e the τ values using the monte carlo simulations then we used eq 9 to generate 200 realizations of x 4 the mean values of these realizations are considered the best forecast or estimate to represent the fluvial status 4 results 4 1 derive sequential drought fluvial characteristics based on the jrdi we start with calculating the dry and wet conditions based on the jrdi as introduced in section 3 1 fig 4 shows the jrdi time series calculated at each station green bars are positive jrdi values representing wet conditions in terms of the surface runoff while red bars suggest the opposite events based on the jrdi values we derived the duration severity and mean severity of drought as shown in fig 3 drought duration is the number of consecutive red bars drought severity is the sum of the jrdi values over those consecutive red bars and the mean drought severity is drought severity divided by drought duration the same concept can be applied to fluvials a sequential hydrological drought fluvial event is when a drought event is immediately followed by a fluvial event 4 2 changes in the joint dependence structure of hydrological droughts and fluvials between different periods to examine whether there are appreciable changes in the dependence structure of sequential drought fluvial events over time at these two stations we divided the data into two periods i e 1960 1985 vs 1986 2012 for each period appropriate marginal distributions were fitted to the mean severity of the prior drought and the following fluvial the margins for each variable were fitted by a variety of theoretical distributions e g normal lognormal weibull gamma and the chi square goodness of fit test was applied to determine the most appropriate one then their joint dependence structure was established with the bivariate copulas the aic goodness of fit test was employed to determine the most suitable bivariate copula table 1 presents the aic values in the two study periods at each station and the best one was selected with the smallest aic values fig 5 shows the joint dependence structure of hydrological drought and the following fluvial at station i a and station ii b using contour maps where the curves present different levels of the joint probabilities during the two study periods as shown the level curves are not identical between the two study periods station i is subject to a strong variation which reflects an appreciable change in the dependence relationship between hydrological dryness and wetness conditions at station i over time the substantial changes in dependence structure between the two periods could be partially related to the strong human intervention e g agricultural irrigation systems power generation and other water demands from rivers over this basin during the second period the variation between the two periods is not so substantial at station ii in the united states as compared to statin i yet there is also detectable difference between the level curves indicating possible changes in the dependence relationship between hydrological dry and wet conditions 4 3 changes in the hydrological drought to fluvial transition probability with the joint distributions we can estimate the transition probability from hydrological drought to fluvial using the approach introduced in section 3 2 here we considered two mean drought severities and two fluvial magnitudes severities in the following month after that drought that is 0 5 as the less severe drought solid blue line 1 5 as the severe drought solid red line 0 5 as the less severe fluvial and 1 as the severe fluvial dash purple lines it should be mentioned that one can investigate the drought and fluvial events for any thresholds of interest not limited to the cases in the current study once the joint dependence structure has been constructed as demonstrated in fig 5 it is also possible to obtain the transition probability represented by the intersections between the dashed line and two solid curves of fluvial events given certain mean hydrological drought severity at station i the likelihood of experiencing the less severe and severe fluvial events in the first period is 0 41 and 0 07 respectively after the occurrence of the less severe drought an increase in drought severity will lead to an increase in the likelihood of expecting both the less severe from 0 41 to 0 57 and severe from 0 07 to 0 12 fluvial events also shown in fig 6 the green areas indicate a positive relationship between the two characteristics i e severe drought may lead to a higher probability of strong fluvial event while blue areas indicate a negative relationship therefore the results suggest a positive effect of the preceding drought severity on the following fluvial in terms of its occurrence likelihood during the second period 1986 2012 the likelihood of all the events significantly increased specifically an increase in drought severity will cause a significant increase in the likelihood of expecting both the less severe from 0 35 to 0 79 and severe from 0 04 to 0 47 fluvial events at station ii the likelihood with the less severe and severe fluvial events in the first period is 0 31 and 0 007 given the prior occurrence of a less severe drought the increase in drought severity however reduces the likelihood of the less severe from 0 31 to 0 26 and severe from 0 007 to 0 005 fluvial events revealing a negative relationship between the drought severity and the following fluvial events at this location during the second period the effect of the preceding drought on the following fluvial shifts to be positive and the likelihood seems to be slightly changed an increase in drought severity will cause a slight increase in the likelihood of expecting both the less severe from 0 37 to 0 48 and severe from 0 04 to 0 07 fluvial events 4 4 probabilistic prediction of fluvial based on the preceding drought conditions the final component of the proposed framework is the probabilistic prediction of fluvial given the preceding drought conditions including drought duration severity and mean severity identified with the jrdi time series 80 of these data were applied to train the proposed framework and the remaining data were used for validating its predictive skill as described in section 3 3 we compared two prediction models one is a 3 dimensional model which depends on two factors i e the severity and mean severity of the prior drought event for predicting the subsequent fluvial magnitude severity the other is a 4 dimensional model involving the duration of the prior drought event as the third predictor to seek further improvement for the fluvial prediction predictions from the 3 and 4 dimensional frameworks were summarized using box whisker plots and validated against the observed fluvials fig 7 is the results at station i and fig 8 is at station ii it can be seen that the observations are generally encompassed by the 75 uncertainty interval of the statistical predictions at station i while the uncertainty range increases at station ii nonetheless the results confirm the predictability of the proposed framework which allows to capture the observed fluvials based on the prior drought information but the predictability is better at station i probably due to a stronger correlation between the fluvials and the preceding drought conditions at this station in addition we notice the 4 dimensional framework does not show a significant difference or improvement from the 3 dimensional framework indicating that this additional predictor i e drought duration may not be a key factor in enhancing the forecast skill of fluvials when a hydrological drought has already occurred at both stations despite that the inclusion of more predictors e g the duration of the prior drought event does not generate an additional gain in forest skill for the used data in this study this may not the case for other runoff stations over other areas one may need test the sensitivity of the number of predictors on the prediction performance with different model structures in order to achieve higher accuracy 4 5 effect of different drought fluvial thresholds on joint dependence structure the above approach identifies the hydrological drought to fluvial cases as the occurrence of two consecutive events during which jrdi falls below 0 and subsequently exceeds 0 in other words one sequential drought fluvial event was determinized by a drought is immediately followed by the jrdi with a magnitude greater than 0 in fact the proposed framework is flexible for considering any jrdi thresholds of interest to characterize the hydrological drought to fluvial events for instance we further collected the hydrological drought to fluvial events during which jrdi falls below 0 5 and subsequently exceeds 0 5 and the following fluvials were determined as the jrdi value exceeding 0 5 within three months after the droughts also we further examined the joint dependence structure of such drought to fluvial events and the potential changes in the dependence between two periods 1960 1985 and1986 2012 as shown in fig 9 the shapes of contour maps are substantially apart from those in fig 5 indicating the difference in the dependence structures this is understandable because of the different hydrological drought to fluvial cases involved not limited to this application one can investigate the drought and fluvial events for any jrdi thresholds if necessary 5 discussion and conclusions of all water related disasters floods and droughts stand out as two sides of the same coin lack of water and heavy downpours cause disasters of different types ranging from extreme drought to unprecedented floods what is more frightening is that some areas have experienced wild swings between droughts and floods the abrupt shifts transitions between floods and droughts could be more intensifying under accelerated global warming one theory supported by the model simulations and observations is that as the oceans warm up more water will evaporate from them enter the atmosphere and be held by the warmer air these changes are likely to alter global patterns of how water vapor moves through the atmosphere leading to an enhanced hydrologic cycle with regional shifts in drought and flood patterns as well as increased seasonal variability with a tendency toward greater extremes houghton et al 2001 droughts can make the subsurface less suitable for storing floodwater for example due to subsidence and compaction and by increasing surface runoff since subsidence permanently reduces storage space it also increases flood risks as has been demonstrated in san jose california and the houston galveston area of texas among other places this situation can be even worse if exceptional droughts and fluvials follow each other over a short period of time which can magnify the impact of individual drought or fluvial events and puts more pressure on emergency preparedness and disaster response yet information on how likely the two opposing extreme events could transit or propagate as cascades in time are lacking as traditional methods focus on either drought or flood hazard this study proposed a probabilistic framework for sequential drought fluvial identification probability estimation and prediction we applied this framework to two stations located in the doingjiang basin of southern china station i and in the eel river of united states station ii respectively and both results show that the proposed framework allows capturing the observed fluvials based on the characteristics of the preceding drought between the two stations the transition probability estimate indicates that distinguishable changes in the joint distribution of hydrological droughts and fluvials over time at station i where the increased drought severity tends to enhance the occurrence likelihood of the fluvial happening in close succession while station ii is subject to the opposite effect in addition we examined the sensitivity of fluvial prediction to the severity of hydrological droughts this study used the aic test to determine the best bivariate copula families when modeling the joint dependence structures between the mean severity of drought and the following fluvial to evaluate the effect of different goodness of fit tests we further considered the statistics of the bayesian information criterion bic test and the log likelihood value of the maximum likelihood estimator approach table 2 it can be found that the most appropriate copula families selected by both approaches are close to the ones closed by the aic test table 1 for the two stations used in this study however it should also be pointed out that there are many other goodness of fit tests which may result in changes in selecting the most appropriate copula fermanian 2005 genest et al 2009 despite the strength in sequential drought fluvial identification probability estimation and prediction the proposed probabilistic framework has limitations which can be further improved for instance we used the c vine copula as the baseline technique to establish the proposed framework that is developing the drought index and the conditional prediction approach the vine copulas have a variety of vine types e g c and d vines with diverse mathematical structures e g different ordering of the nodes in the tree structures a possible improvement of the prediction skill is to compare different vine types and structures and evaluate the prediction uncertainty due to discrepancy in vine structures we also found the proposed approach may underestimate the fluvial events based on the preceding drought especially for some strong fluvials this could be partially attributed to theoretical marginal distributions e g gamma weibull distributions applied in this study which are not sufficient to represent the extreme behavior of these events employing extreme value distributions e g generalized extreme value distribution or generalized pareto distribution as the marginal distributions of drought and fluvial events may increase the prediction accuracy moreover it is possible to involve more relevant variables e g precipitation temperature larger scale climate indices etc as potential predictors in the prediction approach and assess whether these variables could provide any additional improvement in the accuracy of forecasts although the proposed framework is mainly applied to evaluate the fluctuations from hydrological droughts to fluvials we would like to mention that the framework is broadly transferable and also offers to address the opposite cases i e the fluvial to drought events apart from the hydrological droughts the framework can also be extended to tackle other hydro climatic events by employing relevant drought indicators e g meteorological agricultural or soil moisture drought indicators while reservoirs theoretically alleviate both flood and drought events reservoir operation rules mitigating drought are different from the ones mitigating flood mateo et al 2014 for instance to cope with drought reservoirs are typically kept as full as possible working as a buffer during low flow conditions whereas to cope with flood reservoirs are often kept as empty as possible allowing the storage of a large quantity of water from extreme rainfall or rapid snowmelt conditions these reservoir operation rules can change over time depending on various factors including whether the most recently experienced disaster was caused by a drought or a flood event as a result the negative impact of flood events occurring immediately after a long period of drought conditions can be exacerbated the inclusion of reservoir information in the proposed framework may further improve the evaluation of sequential drought fluvial events overall by introducing a probabilistic framework that can assess unusual shifts between droughts and floods this study is expected to broaden the understanding of climate whiplash while providing useful information to help policy makers and infrastructure operators develop integrated approach to drought and flood management in the future credit authorship contribution statement zhiyong liu conceptualization methodology investigation visualization writing original draft writing review editing linyin cheng methodology writing review editing xiaojun wang methodology kairong lin investigation xiaohong chen investigation supervision tongtiegang zhao investigation xinjun tu visualization ping zhou supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors except the second author acknowledge the national key r d program of china 2021yfc3001000 the national natural science foundation of china 52179031 and guangdong provincial department of science and technology 2019zt08g090 for the financial support we appreciate the constructive comments and suggestions from the editor associate editor and anonymous reviewers we appreciate the constructive comments and suggestions from the editor associate editor and anonymous reviewers 
3072,while many modeling techniques have been developed to derive forecasts frequency estimates and projection of droughts and floods approaches that can inform how likely the two opposite extreme events could transit or propagate as cascades in time are still lacking here we proposed a probabilistic framework to serve the purpose specifically the framework allows to 1 identify successive occurrence of hydrological droughts and fluvials 2 estimate the probability of transition from a prior hydrological drought to a succeeding fluvial and 3 make predictions of fluvials given a preceding dry spell we applied this framework to predict the following fluvial severity based on the characteristics of hydrological drought at two runoff stations as an illustration they are located in the doingjiang basin of southern china station i and the eel river of united states station ii respectively our results show that the proposed framework can capture the observed fluvials based on the prior drought information at both stations attesting to its skillful predictability the transition probability estimate indicates that appreciable changes in the joint distribution of hydrological droughts and fluvials over time at station i where the increased drought severity tends to enhance the occurrence likelihood of the fluvial happening in close succession while station ii is subject to the opposite effect collectively this study is expected to broaden the understanding of unusual shifts between droughts and floods while providing useful information to help policy makers and infrastructure operators develop integrated approach to drought and flood management in the future keywords probabilistic framework droughts fluvials prediction runoff 1 introduction over the past 40 years the weather pattern reveals that wet areas have become wetter and dry areas have become drier putnam and broecker 2017 behind this weather pattern is its impacts on droughts and floods various regions of the world are seeing strong evidence toward more frequent floods and droughts both with increasing severity as a result of the adjustment in the rainfall distribution madsen et al 2014 shao and kam 2020 some areas in particular have experienced wild swings between the two for instance the summer of 2002 in europe brought widespread floods but was followed a year later in 2003 by drought droughts were back to feature the news headlines of chennai india just a few years after the 100 year rainfall of 2015 more dramatically a persistent and intense drought baked california u s between 2012 and 2016 yet it was replaced by record breaking torrentialprecipitation which resulted in statewide flooding during the succeeding winter of 2016 2017 in china drought to flood alternation events have also been reported in many parts of the country including the middle and lower reaches of the yangtze river basin huai river basin pearl river basin and shandong province etc bi et al 2020 shi et al 2021 yang et al 2013 it s a cycle that is becoming more common around the globe the media has dubbed the phenomenon as climate whiplash indicating wild weather patterns that swing from one extreme to another while a certain amount of the swing is part of the natural climate variability what calls attention is the synchronicity of droughts and floods droughts can cause severe food shortages damage the environment for animal lives lead to poor biodiversity for aquatic lives bank erosion salinity intrusion and health problems for household communities due to contaminated water quality each year floods can cause in varying degree of damage to agriculture rural infrastructure residential areas and essential services the consecutive occurrence of such reversed extreme events can cost nations billions of dollars in damages and threaten very lives of millions of people by challenging the resilience of critical infrastructures in much quicker cycles than one would typically plan for winsemius et al 2018 according to the national oceanic and atmospheric administration assessment of severe weather and climate events on average droughts and floods cost the united states about 9 5 billion and 4 3 billion per event respectively in terms of the number of people affected by climate related disasters extreme rainfall and the extreme lack of it dominate the picture since the 21st century floods have affected the largest number of people at more than two billion followed by drought which affected a further 1 5 billion people in 1998 2017 as reported by the united nation office for disaster risk reduction wallemacq 2018 in 2019 a total of 47 67 million people were affected by floods in china with 658 people dead or missing the direct economic loss amounted to 192 27 billion rmb accounting for 0 19 of gdp that year based on the china flood and drought disaster bulletin just in 2021 summer henan province in central china received more than its annual average rainfall in four days and recorded a year s worth of rain in just a few days with a record 201 9 mm of rainfall within an hour more than 300 people died and 50 people are missing moreover a swing from droughts to floods and back can become ever more severe since a growing global population increasing urbanization and pressures from agriculture and industry scarce water resources put more people at risk rapid drought flood transitions further challenge water management and reservoir operation because of trade offs between long term water storage and short term flood control he and sheffield 2020 though floods and droughts are different from a process perspective similar methods and modeling techniques are often used to derive both types of extremes for example the common approach for drought and flood forecasting applies hydrological models to simulate continuous streamflow time series with inputs from numerical weather models alfieri et al 2013 cloke and pappenberger 2009 emerton et al 2016 pagano et al 2014 xu et al 2020 yuan et al 2013 to yield future predictions and projections of droughts and floods one can drive a hydrological model with meteorological data from a global or regional circulation model e g addor et al 2014 mendoza et al 2015 mizukami et al 2016 or employ hybrid statistical dynamical techniques which incorporate time or physically based variables into a statistical framework e g madadgar et al 2016 slater and villarini 2018 furthermore a wide range of parametric distribution free non parametric semi parametric or kernel based methods have been developed in the literature to describe the occurrence probability or return period of droughts and floods rao and hamed 2019 todorovic and zelenhasic 1970 most of these modeling techniques focus on one type of the two extreme events either droughts or floods therefore having limited skill to provide a joint picture of how droughts and floods evolve together e g jongman et al 2014 shahid and behrawan 2008 growing evidence indicates that the abrupt shifts in climate droughts followed by floods are intensifying with the tendency toward shorter term reversal casson et al 2019 prein et al 2017 swain et al 2018 the more frequent and the more connected drought flood seesaws can change the storage of nutrients in the agricultural landscape while degrading a region s quality of water supplies additionally greater year to year volatility in the natural supply of water to the reservoirs would exert added stress on water management and potentially lead to an increase in wildfires since wet years promote the growth of vegetation that could become fuel for fires during dry years it became apparent that droughts and floods occurring in close succession pose a potential threat which cannot be eradicated but has to be managed as a result approaches that can quantify how likely the two opposing extremes could transit or propagate as cascades in time are increasingly needed such information would be beneficial for policymakers and infrastructure operators to prioritize actions that affect water resources objectives of flood control drought mitigation and water quality protection this study responds to the need by introducing a probabilistic framework specifically the framework proposed here allows to 1 identify sequential hydrological drought and fluvial events 2 estimate the probability of transition from a prior hydrological drought to a succeeding fluvial and 3 make predictions of fluvials given a preceding dry spell in the following section 2 demonstrates the proposed method section 3 presents the results and findings and section 4 dedicates to further discussions 2 project data it has been noted that a single unique definition of drought does not exist due to its multi discipline characters for this reason droughts have been classified into different types consisting of meteorological hydrological agricultural ecological or socioeconomic factors likewise floods can appear in a variety of forms ranging from small flash floods to large coastal and urban floods although this study focused on the hydrological droughts and fluvials characterized by shortfalls or surplus in surface runoff it is worth noting that the proposed framework can be adapted to other types of droughts and floods we illustrate the proposed method with monthly runoff data from 1960 to 2012 at two stations fig 1 shows the location of these two stations as shown station i on the left of fig 1 is within the doingjiang basin of southern china provided by the guangdong hydrological bureau china liu et al 2015 station ii is from the us geological survey usgs usgs id 03328500 on the right of fig 1 located in the eel river close to logansport of indiana united states maity et al 2013 3 methodology fig 2 gives a schematic diagram of the proposed framework it involves three major components 1 calculating the joint runoff drought index for identifying the sequential hydrological drought fluvial events 2 estimating the probability of transition from hydrological drought to fluvial and 3 predicting fluvials based on the preceding drought conditions below is the description of each component 3 1 identify hydrological drought to fluvial events based on the joint runoff drought index standardized indices such as the standardized runoff index sri have been often applied to identify hydrological droughts and fluvials but the use of such a univariate index can lead to inconsistent results for event characterization at different temporal scales e g 1 month 3 month etc to address this limitation the joint runoff drought index also known as jrdi has been developed liu et al 2016 the jrdi characterizes an overall drought condition by integrating runoff information of sri over multiple temporal scales therefore combining the strength of short term sri in detecting drought onset and long term sri in representing drought persistence kao and govindaraju 2010 liu et al 2016 herein jrdi which combines 1 month 3 month and 6 month sri was used to facilitate the identification of sequential drought fluvial events derivation of the jrdi includes the following steps 1 compute the sri at three time windows i e 1 month 3 month and 6 month sri 2 fit appropriate marginal distributions to each of the three sri based indicators i e u 1 u 2 u 3 3 build the joint distribution of the three margins i e c u 1 u 2 u 3 where c denotes the c vine copula function 4 employ kendall distribution transformation to generate the cumulative probability function cdf that measures the probability of the 3 dimensional copula values less than or equal to a given quantile q 1 k c q p c u 1 u 2 u 3 u 1 u 2 u 3 q 5 obtain the jrdi by inversing the normal function ϕ 1 2 j r d i ϕ 1 k c q the jrdi combines the strengths of the short term drought indicator in tracking the drought onset and long term drought indicator in capturing the drought durations and it thus may provide a more overall drought assessment as compared to the sris the drought severity categories characterized by the jrdi are consistent with the original standardized drought indices more details about the application of c vine copula bedford and cooke 2002 klein et al 2016 li et al 2014 and the jrdi can be found in liu et al 2016 the r package i e vinecopula was applied to estimate the joint distributions aas et al 2009 brechmann et al 2013 with the jrdi time series we sampled hydrological drought to fluvial cases as the occurrence of two consecutive events during which jrdi falls below 0 and subsequently exceeds 0 at each station when the runoff deficit persists we computed the sum of the jrdi over those consecutive months to represent the drought severity and the mean severity is drought severity divided by drought duration if a drought is immediately followed by the jrdi with a magnitude greater than 0 one sequential drought fluvial event occurs the sampled cases were subsequently fitted to the conditional copula for estimating the occurrence probability of drought to fluvial scenarios as explained in section 3 2 3 2 estimate hydrological drought to fluvial transition probability to obtain the occurrence probability of one variable under the given conditions we followed the procedure outlined by yue and rasmussen 2002 briefly let f x y be the joint probability density function pdf of two continuous random variables x herein the magnitude or severity of fluvial in the next month and y herein the drought characteristics e g the mean severity of drought severity duration f x x and f y y be the marginal pdfs of x and y respectively and f x x f y y and f x y be the corresponding cumulative distribution functions cdfs for their univariate and bivariate variables the conditional pdf of x given y y can be expressed as 3 f x y x y f x y f y y based on the pdf the conditional cdf of x given y y is derived as 4 f x y x f x y u y d u x f u y d u f y y similarly the conditional cdf of x x given y y has the following expression 5 f x y x y f x y y f x y f y y the exceeding probability of equation 5 is a measure of the likelihood associated with the event x x given y y which is formulated as 6 p x x y y 1 f x y y 1 f x y f y y if a drought has occurred in the first place the interest is to estimate how likely the following month would be subject to the opposite scenario i e fluvial essentially that is the probability of x conditioned upon y i e p x x y y where x and y represent the thresholds for defining the wet and dry states respectively this conditional probability conveys the likelihood of a subsequent fluvial occurring given that a prior hydrological drought has occurred it can also be interpreted as the probability of transitioning from one state to another herein drought to fluvial in a single step broadly known as the one step transition probability the key to solving equation 6 replies on the construction of the joint distribution between x and y in this study we employed the bivariate copula which allows for joining the margins and modeling the joint dependence structure between extreme wet and dry states of surface runoff 3 3 probabilistic prediction of fluvials based on the preceding drought conditions the proposed framework considered drought characteristics including severity x 1 mean severity x 2 i e drought severity divided by drought duration and duration x 3 of the prior drought to predict the fluvial x 4 in succession in other words the fluvial in the following month is predicted based on the three indicators of the drought that has already occurred this can be realized by building a 3 dimensional or 4 dimensional conditional prediction model via the vine copula and sequentially applying the inverse form of the h conditional function also known as conditional probability function which could be expressed as follows 7 f u 3 u 1 u 2 u 3 h h u 3 u 1 θ 13 h u 2 u 1 θ 12 θ 32 1 8 f u 4 u 1 u 2 u 3 h h h u 3 u 1 θ 13 h u 2 u 1 θ 12 θ 32 1 h h u 4 u 1 θ 14 h u 2 u 1 θ 12 θ 42 1 θ 34 12 where θ 12 θ 13 θ 14 θ 32 1 θ 42 1 and θ 34 12 denote the parameters of different conditional copulas in the 3 or 4 dimensional c vine and the vinecopula of the r package schepsmeier et al 2015 was applied to facilitate the estimation of the conditional functions a schematic illustration of the drought characteristics and the hydrological drought to fluvial events identified with the jrdi is given in fig 3 with the conditional expression in eq 8 we further derived its inverse form to estimate the fluvial severity as given below 9 x 4 q x 4 τ x 1 x 2 x 3 f 1 u 4 f 1 h 1 h 1 h 1 τ h h u 3 u 1 h u 2 u 1 h u 2 u 1 u 1 therefore we can estimate x 4 based on the given variables x 1 x 1 and x 3 ren et al 2014 in this study we produced 200 uniformly distributed random numbers over the interval 0 1 i e the τ values using the monte carlo simulations then we used eq 9 to generate 200 realizations of x 4 the mean values of these realizations are considered the best forecast or estimate to represent the fluvial status 4 results 4 1 derive sequential drought fluvial characteristics based on the jrdi we start with calculating the dry and wet conditions based on the jrdi as introduced in section 3 1 fig 4 shows the jrdi time series calculated at each station green bars are positive jrdi values representing wet conditions in terms of the surface runoff while red bars suggest the opposite events based on the jrdi values we derived the duration severity and mean severity of drought as shown in fig 3 drought duration is the number of consecutive red bars drought severity is the sum of the jrdi values over those consecutive red bars and the mean drought severity is drought severity divided by drought duration the same concept can be applied to fluvials a sequential hydrological drought fluvial event is when a drought event is immediately followed by a fluvial event 4 2 changes in the joint dependence structure of hydrological droughts and fluvials between different periods to examine whether there are appreciable changes in the dependence structure of sequential drought fluvial events over time at these two stations we divided the data into two periods i e 1960 1985 vs 1986 2012 for each period appropriate marginal distributions were fitted to the mean severity of the prior drought and the following fluvial the margins for each variable were fitted by a variety of theoretical distributions e g normal lognormal weibull gamma and the chi square goodness of fit test was applied to determine the most appropriate one then their joint dependence structure was established with the bivariate copulas the aic goodness of fit test was employed to determine the most suitable bivariate copula table 1 presents the aic values in the two study periods at each station and the best one was selected with the smallest aic values fig 5 shows the joint dependence structure of hydrological drought and the following fluvial at station i a and station ii b using contour maps where the curves present different levels of the joint probabilities during the two study periods as shown the level curves are not identical between the two study periods station i is subject to a strong variation which reflects an appreciable change in the dependence relationship between hydrological dryness and wetness conditions at station i over time the substantial changes in dependence structure between the two periods could be partially related to the strong human intervention e g agricultural irrigation systems power generation and other water demands from rivers over this basin during the second period the variation between the two periods is not so substantial at station ii in the united states as compared to statin i yet there is also detectable difference between the level curves indicating possible changes in the dependence relationship between hydrological dry and wet conditions 4 3 changes in the hydrological drought to fluvial transition probability with the joint distributions we can estimate the transition probability from hydrological drought to fluvial using the approach introduced in section 3 2 here we considered two mean drought severities and two fluvial magnitudes severities in the following month after that drought that is 0 5 as the less severe drought solid blue line 1 5 as the severe drought solid red line 0 5 as the less severe fluvial and 1 as the severe fluvial dash purple lines it should be mentioned that one can investigate the drought and fluvial events for any thresholds of interest not limited to the cases in the current study once the joint dependence structure has been constructed as demonstrated in fig 5 it is also possible to obtain the transition probability represented by the intersections between the dashed line and two solid curves of fluvial events given certain mean hydrological drought severity at station i the likelihood of experiencing the less severe and severe fluvial events in the first period is 0 41 and 0 07 respectively after the occurrence of the less severe drought an increase in drought severity will lead to an increase in the likelihood of expecting both the less severe from 0 41 to 0 57 and severe from 0 07 to 0 12 fluvial events also shown in fig 6 the green areas indicate a positive relationship between the two characteristics i e severe drought may lead to a higher probability of strong fluvial event while blue areas indicate a negative relationship therefore the results suggest a positive effect of the preceding drought severity on the following fluvial in terms of its occurrence likelihood during the second period 1986 2012 the likelihood of all the events significantly increased specifically an increase in drought severity will cause a significant increase in the likelihood of expecting both the less severe from 0 35 to 0 79 and severe from 0 04 to 0 47 fluvial events at station ii the likelihood with the less severe and severe fluvial events in the first period is 0 31 and 0 007 given the prior occurrence of a less severe drought the increase in drought severity however reduces the likelihood of the less severe from 0 31 to 0 26 and severe from 0 007 to 0 005 fluvial events revealing a negative relationship between the drought severity and the following fluvial events at this location during the second period the effect of the preceding drought on the following fluvial shifts to be positive and the likelihood seems to be slightly changed an increase in drought severity will cause a slight increase in the likelihood of expecting both the less severe from 0 37 to 0 48 and severe from 0 04 to 0 07 fluvial events 4 4 probabilistic prediction of fluvial based on the preceding drought conditions the final component of the proposed framework is the probabilistic prediction of fluvial given the preceding drought conditions including drought duration severity and mean severity identified with the jrdi time series 80 of these data were applied to train the proposed framework and the remaining data were used for validating its predictive skill as described in section 3 3 we compared two prediction models one is a 3 dimensional model which depends on two factors i e the severity and mean severity of the prior drought event for predicting the subsequent fluvial magnitude severity the other is a 4 dimensional model involving the duration of the prior drought event as the third predictor to seek further improvement for the fluvial prediction predictions from the 3 and 4 dimensional frameworks were summarized using box whisker plots and validated against the observed fluvials fig 7 is the results at station i and fig 8 is at station ii it can be seen that the observations are generally encompassed by the 75 uncertainty interval of the statistical predictions at station i while the uncertainty range increases at station ii nonetheless the results confirm the predictability of the proposed framework which allows to capture the observed fluvials based on the prior drought information but the predictability is better at station i probably due to a stronger correlation between the fluvials and the preceding drought conditions at this station in addition we notice the 4 dimensional framework does not show a significant difference or improvement from the 3 dimensional framework indicating that this additional predictor i e drought duration may not be a key factor in enhancing the forecast skill of fluvials when a hydrological drought has already occurred at both stations despite that the inclusion of more predictors e g the duration of the prior drought event does not generate an additional gain in forest skill for the used data in this study this may not the case for other runoff stations over other areas one may need test the sensitivity of the number of predictors on the prediction performance with different model structures in order to achieve higher accuracy 4 5 effect of different drought fluvial thresholds on joint dependence structure the above approach identifies the hydrological drought to fluvial cases as the occurrence of two consecutive events during which jrdi falls below 0 and subsequently exceeds 0 in other words one sequential drought fluvial event was determinized by a drought is immediately followed by the jrdi with a magnitude greater than 0 in fact the proposed framework is flexible for considering any jrdi thresholds of interest to characterize the hydrological drought to fluvial events for instance we further collected the hydrological drought to fluvial events during which jrdi falls below 0 5 and subsequently exceeds 0 5 and the following fluvials were determined as the jrdi value exceeding 0 5 within three months after the droughts also we further examined the joint dependence structure of such drought to fluvial events and the potential changes in the dependence between two periods 1960 1985 and1986 2012 as shown in fig 9 the shapes of contour maps are substantially apart from those in fig 5 indicating the difference in the dependence structures this is understandable because of the different hydrological drought to fluvial cases involved not limited to this application one can investigate the drought and fluvial events for any jrdi thresholds if necessary 5 discussion and conclusions of all water related disasters floods and droughts stand out as two sides of the same coin lack of water and heavy downpours cause disasters of different types ranging from extreme drought to unprecedented floods what is more frightening is that some areas have experienced wild swings between droughts and floods the abrupt shifts transitions between floods and droughts could be more intensifying under accelerated global warming one theory supported by the model simulations and observations is that as the oceans warm up more water will evaporate from them enter the atmosphere and be held by the warmer air these changes are likely to alter global patterns of how water vapor moves through the atmosphere leading to an enhanced hydrologic cycle with regional shifts in drought and flood patterns as well as increased seasonal variability with a tendency toward greater extremes houghton et al 2001 droughts can make the subsurface less suitable for storing floodwater for example due to subsidence and compaction and by increasing surface runoff since subsidence permanently reduces storage space it also increases flood risks as has been demonstrated in san jose california and the houston galveston area of texas among other places this situation can be even worse if exceptional droughts and fluvials follow each other over a short period of time which can magnify the impact of individual drought or fluvial events and puts more pressure on emergency preparedness and disaster response yet information on how likely the two opposing extreme events could transit or propagate as cascades in time are lacking as traditional methods focus on either drought or flood hazard this study proposed a probabilistic framework for sequential drought fluvial identification probability estimation and prediction we applied this framework to two stations located in the doingjiang basin of southern china station i and in the eel river of united states station ii respectively and both results show that the proposed framework allows capturing the observed fluvials based on the characteristics of the preceding drought between the two stations the transition probability estimate indicates that distinguishable changes in the joint distribution of hydrological droughts and fluvials over time at station i where the increased drought severity tends to enhance the occurrence likelihood of the fluvial happening in close succession while station ii is subject to the opposite effect in addition we examined the sensitivity of fluvial prediction to the severity of hydrological droughts this study used the aic test to determine the best bivariate copula families when modeling the joint dependence structures between the mean severity of drought and the following fluvial to evaluate the effect of different goodness of fit tests we further considered the statistics of the bayesian information criterion bic test and the log likelihood value of the maximum likelihood estimator approach table 2 it can be found that the most appropriate copula families selected by both approaches are close to the ones closed by the aic test table 1 for the two stations used in this study however it should also be pointed out that there are many other goodness of fit tests which may result in changes in selecting the most appropriate copula fermanian 2005 genest et al 2009 despite the strength in sequential drought fluvial identification probability estimation and prediction the proposed probabilistic framework has limitations which can be further improved for instance we used the c vine copula as the baseline technique to establish the proposed framework that is developing the drought index and the conditional prediction approach the vine copulas have a variety of vine types e g c and d vines with diverse mathematical structures e g different ordering of the nodes in the tree structures a possible improvement of the prediction skill is to compare different vine types and structures and evaluate the prediction uncertainty due to discrepancy in vine structures we also found the proposed approach may underestimate the fluvial events based on the preceding drought especially for some strong fluvials this could be partially attributed to theoretical marginal distributions e g gamma weibull distributions applied in this study which are not sufficient to represent the extreme behavior of these events employing extreme value distributions e g generalized extreme value distribution or generalized pareto distribution as the marginal distributions of drought and fluvial events may increase the prediction accuracy moreover it is possible to involve more relevant variables e g precipitation temperature larger scale climate indices etc as potential predictors in the prediction approach and assess whether these variables could provide any additional improvement in the accuracy of forecasts although the proposed framework is mainly applied to evaluate the fluctuations from hydrological droughts to fluvials we would like to mention that the framework is broadly transferable and also offers to address the opposite cases i e the fluvial to drought events apart from the hydrological droughts the framework can also be extended to tackle other hydro climatic events by employing relevant drought indicators e g meteorological agricultural or soil moisture drought indicators while reservoirs theoretically alleviate both flood and drought events reservoir operation rules mitigating drought are different from the ones mitigating flood mateo et al 2014 for instance to cope with drought reservoirs are typically kept as full as possible working as a buffer during low flow conditions whereas to cope with flood reservoirs are often kept as empty as possible allowing the storage of a large quantity of water from extreme rainfall or rapid snowmelt conditions these reservoir operation rules can change over time depending on various factors including whether the most recently experienced disaster was caused by a drought or a flood event as a result the negative impact of flood events occurring immediately after a long period of drought conditions can be exacerbated the inclusion of reservoir information in the proposed framework may further improve the evaluation of sequential drought fluvial events overall by introducing a probabilistic framework that can assess unusual shifts between droughts and floods this study is expected to broaden the understanding of climate whiplash while providing useful information to help policy makers and infrastructure operators develop integrated approach to drought and flood management in the future credit authorship contribution statement zhiyong liu conceptualization methodology investigation visualization writing original draft writing review editing linyin cheng methodology writing review editing xiaojun wang methodology kairong lin investigation xiaohong chen investigation supervision tongtiegang zhao investigation xinjun tu visualization ping zhou supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors except the second author acknowledge the national key r d program of china 2021yfc3001000 the national natural science foundation of china 52179031 and guangdong provincial department of science and technology 2019zt08g090 for the financial support we appreciate the constructive comments and suggestions from the editor associate editor and anonymous reviewers we appreciate the constructive comments and suggestions from the editor associate editor and anonymous reviewers 
3073,a flood is one of the most hazardous natural disasters and it commonly causes fatalities and socioeconomic damages the advances of modeling techniques and observation data in flood prediction have found success in field operations this paper presents a comprehensive flood prediction of hurricane harvey in 1 hour lead time that is not limited to 1d streamflow forecast but also 2d flood extent and 3d inundation depth it uses high resolution quantitative precipitation forecasts qpfs from operational rapid refresh rap and high resolution rapid refresh hrrr models and deep learning nowcasts ai nowcasts the results show that the qpfs have a well known displacement issue and the ai nowcast cannot predict the precipitation intensity and an attempt to combine the two methods ai hybrid failed to improve the overall accuracy however the 2d flood extent predictions with the hrrr and ai hybrid forcings can provide information indicating the future flooded area with about 50 accuracy hit rate and stream flow prediction showed that the hrrr qpf can provide relatively accurate flood peak prediction 8 in contrast the ai nowcast reveals minimal displacement errors but underpredicts precipitation intensity the deep learning method also indicates that the binary tests with low threshold which are commonly employed in the deep learning field neglect the importance of precipitation intensity errors for extreme event studies keywords quantitative precipitation forecast flood deep learning hydrologic hydraulic model forecasts hurricane harvey data availability data will be made available on request 1 introduction the increase of frequency and magnitude of extreme weather and precipitation caused by climate change has received much attention meehl et al 2000 usgcrp 2017 van oldenborgh et al 2018 further tropicalization a global trend towards a heavier precipitation climate has been modeled in europe gobiet et al 2014 consequentially this change would lead to more flood events in the future which is the second deadliest and most common natural hazard in the united states and world ashley and ashley 2008 barredo 2007 benito et al 2004 smith and ward 1998 according to brauer et al 2020 the rate and duration of precipitation land use and soil moisture content as well as topography all have impacts on the severity of flooding moreover tropicalization combining with rising sea levels and ocean temperatures will only intensify flooding especially along coastal areas wing et al 2019 to quantify and mitigate flood risks many tools have been developed to simulate flooding at post event bates et al 2010 bates and de roo 2000 de almeida and bates 2013 srinivasan and arnold 1994 wang et al 2011 wood et al 1992 xue et al 2016 and in real time cohen et al 2018 gochis et al 2017 sampson et al 2015 wing et al 2019 2017 instead of post event hydrological reanalysis or real time streamflow simulation this study explores the options for forecasting flood events which could potentially provide a longer lead time for emergency response officials or even the general public to proactively respond to possible future flood risks almost 40 years ago georgakakos and hudlow 1984 discuss the use of quantitative precipitation forecasts qpfs from the numerical weather prediction nwp models for hydrological forecasting the operational limited area fine mesh lfm model newell and deaver 1981 from the national weather service nws at the time had a horizontal grid spacing of 127 km and the on demand movable fine mesh mfm model had an improved grid spacing up to 60 km while promising the lack of spatial specificity needed for hydrological forecasting and the relatively low accuracy of qpf limited the application of model based qpf to drive hydrological models with the advancement of computing and climate observation technologies the nwp models have improved dramatically in recent decades in terms of their spatial and temporal resolutions accuracy and coverage trenberth 2010 the current operational high resolution rapid refresh hrrr benjamin et al 2016 lee et al 2019 has a horizontal grid spacing of 3 km with hourly updated forecasts over the contiguous united states conus convection allowing cloud resolving nwp models have been run at 1 km grid spacing loken et al 2017 xue et al 2013 however accurate qpf remains a challenge because of many complex factors involved in precipitation processes ebert and mcbride 2000 golding 2000 major errors of nwp qpfs include spatial displacement errors ebert and mcbride 2000 and errors in intensity especially for extreme events cuo et al 2011 for short range precipitation forecasting the proper initialization of existing precipitation fields for the forecasting model is also an important issue kain et al 2010 sun et al 2014 precipitation nowcasting typically refers to very short range 1 6 hr forecasting of precipitation and the traditional nowcasting is mostly done by extrapolating observed radar reflectivity fields ligda 1953 demonstrated the possibility of providing reasonable forecasts based on the persistence and movement of radar echoes this technology has a recent technological improvement with the combination of high performance computing hpc and artificial intelligence ai resulting in successful applications in real world problems including precipitation nowcasting agrawal et al 2019 lecun et al 2015 in 2019 google research published a study showing the advantage of using deep learning nowcasts to predict 1 hour lead time precipitation over the conus outperforming traditional optical flow extrapolation method persistence and 1 hour hrrr forecasts agrawal et al 2019 moreover many recent studies also show successes in deep learning precipitation nowcasting franch et al 2020 introduce a new deep learning model taasrad19 to forecast 1 hour lead time radar reflectivity which is then converted to precipitation rate yielding a critical success index csi of 0 5 over a 9 year sample while most ai nowcast studies evaluate binary coverage as the performance test kumar et al 2020 demonstrate their deep learning model reduces the root mean square error rmse between forecast and satellite precipitation estimates to 0 8 mm hr on 30 min lead time and up to 1 4 mm hr on 150 min lead time using global precipitation mission gpm integrated multi satellite retrievals imerg datasets they identify the most significant error source being underestimation with extreme events however the hydrological performance of ai nowcasts is generally underexplored flood prediction has a history of different methods from upstream level exceedance thresholding and level to level correlations to hydrological and hydrodynamic models adams and pagano 2016 for modern operational flood forecasting systems it is common to use quantitative precipitation estimates qpes precipitation nowcasts and nwp qpfs to drive hydrological models cuo et al 2011 golding 2000 hapuarachchi et al 2011 since there is a lag time between the precipitation peak and the streamflow peak bedient et al 1988 some operational systems are capable of predicting the flood by using the real time observed precipitation products as the forcing dataset for example the scottish environment protection agency uses radar and in situ precipitation data to provide streamflow forecasts werner and cranston 2009 the national center of environmental prediction ncep adapts the national water model nwm cohen et al 2018 gochis et al 2017 while the national severe storm laboratory nssl utilizes the ensemble framework for flash flood forecasting ef5 as part of the flash project flamig et al 2020 gourley et al 2017 both nwm and ef5 use the multi radar multi sensor mrms qpes to drive streamflow forecasts for the entire conus and outer territories to provide longer range more than a few hours and more comprehensive flood predictions it is necessary to utilize nowcasts or qpfs and the flood predictions can be extended beyond streamflow prediction to also include two dimensional 2d flood extent and flood depth forecasting however due to the accuracy issues of qpf the skill of longer flood range prediction is still limited especially at the scales of urban watersheds hapuarachchi et al 2011 more recent hydrological evaluation of operational hrrr qpf indicates that even though this advanced product is capable of forecasting mesoscale convective systems well qpfs associated with smaller scale precipitation systems often contain significant errors making hydrological prediction errors to become too large lee et al 2019 seo et al 2018 this study is an attempt to utilize advanced nwp qpfs and ai precipitation nowcasting for the prediction of flooding triggered by the landfalling hurricane harvey in 2017 the comprehensive predictions include 1d stream discharge 2d flood extent and 3d flood depth using the coupled routing and excessive storage inundation mapping and prediction crest imap model this work evaluates the ability of state of art operational qpfs to predict not only streamflow but also flood extents and flood depths and it presents one of the first studies to evaluate the hydrological performance of ai precipitation nowcast techniques the precipitation forecasts and flood prediction results are compared with mrms qpe us geological survey usgs stream gauge data mrms qpe simulated flood extent federal emergency management agency fema flood insurance claims and usgs high water mark post event survey data the rest of this paper is organized as follows section 2 describes the qpf datasets study area crest imap model and the deep learning architecture for ai nowcasting section 3 demonstrates the results of the predicted streamflow hydrographs flood extent and inundation depth compared to the benchmark and other ground observations section 4 discusses the major findings from the results section 5 concludes and proposes future studies 2 methodology 2 1 forecast rainfall this study relies on the applications of operational nwp models that provide the qpf products which are archived in noaa s national operational model archive and distribution system the rapid refresh rap was first developed in may 2012 built upon the first hourly updated operational nwp system in the world rapid update cycle ruc back in 1998 benjamin et al 2016 2004 after two major improvements in 2014 and 2016 rap now consists of multiple meteorological data and models to increase accuracy such as the noaa gridpoint statistical interpolation gsi a version of weather research and forecasting wrf regional model and the national center of environmental prediction ncep unified post processor upp the current rap qpf product can provide hourly updated precipitation forecasts out to 18 h at 13 km spatial resolution over the entire north america in this study the 1 hour lead time data was obtained from the noaa s national center for environmental information ncei website https www ncdc noaa gov data access model data model datasets rapid refresh rap the hrrr was first released in september 2014 and finished its first upgrade in 2016 then was deployed as a new operational model in july 2018 lee et al 2019 hrrr is a nested model that heavily relies on rap data assimilation which covers the continental united states conus and provides hourly forecasts up to 18 h in the future at 3 km spatial resolution benjamin et al 2016 in this study the 1 hour lead time hrrr v2 forecast data obtained from the university of utah hrrr data archive https home chpc utah edu u0553130 brian blaylock cgi bin hrrr download cgi all forecast products are 1 hour lead time since the deep learning precipitation nowcasting method in this study can only produce a 1 hour forecast due to the limitation of computational resources the basic statistics of precipitation forecast datasets are listed in table 1 2 2 deep learning precipitation nowcasting the advancement in machine learning deep learning recently has been claimed to be successful when applied to the short range nowcasting of precipitation shi et al 2015 ai precipitation nowcasting as a data driven and localized method is adapted to the local environment and requires no prior knowledge about weather systems from the model developer which predicts next step precipitation distribution by a series of previous frames from a well trained model structure in this study we select the u net model structure for the following reasons first it is a widely adopted structure for precipitation estimation and prediction li et al 2020b sadeghi et al 2020 second the lightweight framework necessitates a fewer number of parameters compared to other models and requires less system memory to train the model before the model training some preprocessing steps are conducted for unifying precipitation estimates from multiple events due to the nature of the non gaussian distribution of precipitation per frame one way to normalize precipitation data is via logarithmic transformation similar to sønderby et al 2020 precipitation data is transformed and normalized based on the following equation r log x 0 01 4 where is the input rainfall rate and r is the normalized rainfall rates subsequently rainfall data is grouped every 10 frames at 6 min increments to target next hour precipitation forecasts the mean square error mse and adam a deep learning optimizer kingma and ba 2017 are chosen as the objective function and optimizer in this setting the initial learning rate α 1 1 learning rate is a hyperparameter that controls how much change the deep learning model in response to estimated error each time the model weights are updated some considers the learning rate is the most important hyperparameter for neural network configuring is set at 0 001 but is scheduled to decrease exponentially with training process to avoid blowing up due to the limitation of the graphics processing unit gpu memory capacity 2 gb this study can only predict a 1 hour lead time given the size of the study area which is 4 time steps ahead 15 min resolution in this study the u net structured deep learning model is trained by the mrms qpes for 16 precipitation events listed in noaa storm report table 2 that caused flooding in the houston area from 2015 to 2019 except hurricane harvey with a total of over 30 000 images the intensive precipitation focused deep learning model is then used to forecast 1 hour lead time from 24 08 2017 to 02 09 2017 10 days the experiment is conducted using a single nvidia gtx 960 m gpu card the training process took 48 h and the forecasting process took around 300 s for 1 hour lead time 4 time steps ai based nowcasting can effectively capture the spatiotemporal correlation with observations yet it may misrepresent the event magnitude which is a common weakness of ai nowcast kumar et al 2020 on the other hand the physical simulations are apt at identifying storm cores and thus the event rainfall magnitude it is presumably advantageous to take the respective advantages of both to produce a hybrid product in this study a conventional non parametric probability matching scheme is taken at each nowcast time step to increase the rainfall magnitude of the ai produced product close to the hrrr forecasts the basic idea is to conserve the ranks of the initial rainfall rate for a given frame and its empirical cumulative density function cdf is modified to match the target cdf 2 3 observed rainfall flood benchmark and data the observed precipitation product is chosen to be the mrms radar only 2 min qpe which showed high correlations and small error compared to the harris county flood control district rain gauge network in previous studies chen et al 2020 li et al 2020a this data is obtained from the iowa environmental mesonet nws data archive https mesonet agron iastate edu nws the benchmark flood map is simulated by crest imap using mrms 2 min qpe as the forcing data to create the benchmark flood map the crest imap goes through a warmup period from 01 04 2017 to 24 08 2017 using the mrms 1 hour gauge corrected qpe and then simulates the hurricane harvey induced flood from 24 08 2017 to 02 09 2017 10 days driven by the mrms 2 min qpe the 10 meter resolution manning s roughness coefficient field is derived from the landcover data from multi resolution land characteristics consortium mrlc https www mrlc gov using a look up table from the literature liu et al 2019 mccuen 2005 other benchmark data include the two usgs stream gauge fig 1 data downstream of spring 08068500 and cypress creek 0809000 which are obtained from the usgs water information system usgs wis https waterdata usgs gov the usgs high water marks hwm data are manually surveyed post event water depths by measuring the residual water stain or mudlines left on buildings and other infrastructure which is considered as the true ground observations of flood depth feaster and koenig 2017 2 4 the crest imap model crest imap is a hydrological and hydraulic coupled model developed by the hydrometeorology and remote sensing laboratory at the university of oklahoma and is designed to operate in near real time it is the newly added member of a well documented crest modeling family which has been widely applied to multiple operations and applications around the world clark et al 2017 flamig et al 2020 gourley et al 2017 wang et al 2011 the crest imap coupled the water balance component of crest and the 2d hydraulic routing using a fully solved shallow water equation with a finite volume method the model can be nested with the crest ef5 framework for near real time operation or as a standalone operation the model receives precipitation data as the driving input over topographical datasets and the crest water balance component generates excessive rainfall which is then routed through the unstructured triangular mesh to generate channel flow rate flood extent and flood depth the model calibration is conducted for the period from 01 04 2017 to 24 08 2017 using the dream algorithm vrugt 2016 vrugt et al 2009 to optimize all water balance parameters by targeting five different usgs stream gauges at midstream 08068275 and downstream 08068500 of spring creek as well as upperstream 08068720 midstream 08068800 and downstream 08069000 of cypress creek after the model is set and warmed up the different qpfs and ai nowcasting products were applied to crest imap as the forcing data to produce 1d streamflow 2d flood extent and the 3d flood depth the simulation results were saved in the model native netcdf format and are available through hydroshare https www hydroshare org resource fae24734d6fc47be8bf0b54d6a175d86 2 5 study area harris county tx was the most impacted area during hurricane harvey with 103 casualties over 40 000 people evacuated and over 30 000 water rescues conducted murphy 2018 fig 1 shows the impacted area of hurricane harvey the hurricane track and the study area of this research the statistical analysis of different qpfs is conducted throughout the entire harris county area and the flood analysis is conducted at the spring basin which is located at the northern part of harris county the hydrologic and flood inundation analysis is focused on the spring basin because the two rivers are connected the lake houston which is not directly entering the trinity bay and gulf of mexico therefore this focusing basin is less impacted by wind induced storm surges and this study can focus on the precipitation differences and its corresponding pluvial and fluvial flood 2 6 statistical metrics to compare each forecasting product and evaluate the flood predictability four levels of statistical tests are conducted in this study first the benchmark precipitation in 2 3 is used to compare qpfs and ai based nowcasts using statistical measures second the crest imap simulated hydrographs are analyzed using not only standard statistic metrics but also hydrological modeling efficiency measures third the crest imap simulated flood extents are analyzed using standard binary pattern measures fourth the crest imap simulated flood depth is analyzed against the usgs hwm all four levels of statistical metrics are listed in table 3 the correlation coefficient cc over a time series measures the strength of an estimate to capture the temporal pattern of the observation traditionally the relative bias is commonly used to measure the errors of the estimate as a fraction of the observation value however for precipitation and streamflow data the values are either positive or zero so the relative bias value can range from 1 to especially when the predicted value is much higher than the benchmark value which could causes confusion during aggregation when few large positive relative bias value offset most negative values to avoid the confusion the normalized bias nb fraction is introduced to normalize the bias from 1 to 1 the root mean square error rmse mm hr for precipitation and m3 s for streamflow measures the distance between the estimates and the observation the probability of detection pod measures the ability to predict the benchmark flood extent the false alarm rate far reflects the tendency to overpredict the benchmark flood extent the critical success index csi measures the overall performance of the flood predictions compared to the benchmark the nash sutcliffe coefficient of efficiency nsce unitless measures the effectiveness of the model prediction compared to the stream gauge observation the peak flow error pe m3 s calculates the difference between predicted and observed peak flow the peak time error pte hour calculates the arriving time difference between predicted and observed peak flow 3 results 3 1 precipitation analysis to observe the first level differences of all the precipitation forecast products the accumulated precipitation from 25 08 2017 to 31 08 2017 is plotted in fig 2 the first clear observation appears to be the spatial resolution differences as rap and hrrr show coarser resolution grid cells across the map compared to mrms and the ai nowcasts due to the low spatial resolution rap can only provide a basic depiction of the precipitation core and has a smooth transition from the high precipitation southeast to the lower precipitating amounts northwest as listed in table 1 rap s highest mean precipitation rate 7 45 mm hr the highest mean accumulated precipitation 1081 mm but low maximum precipitation rate 49 83 mm hr means that it does not simulate extremes like mrms the second clear observation is the underprediction of the ai nowcasts the average precipitation rate of ai nowcast during hurricane harvey is 3 18 mm hr and its mean accumulated precipitation is only 190 mm which is much less than the values of mrms qpe which are 6 16 mm hr and 830 mm respectively google shows the u net framework providing well performed nowcasting precipitation prediction from july 2017 to july 2019 agrawal et al 2019 however for an extreme event like hurricane harvey the result indicates there are difficulties for machine learning methods to predict the precipitation intensity magnitude wise hrrr qpf is comparable with mrms qpe with the mean precipitation rate of 6 65 and 6 16 mm hr respectively table 1 however the spatial displacement of large precipitation amounts from the hrrr is visually clear where the red circles fig 2 provide simple examples where mrms has low accumulated precipitation but the hrrr has a large amount of total precipitation forecast and vice versa the ai hybrid method shows improved precipitation magnitude from 3 18 mm hr to 7 10 mm hr and the mean accumulated precipitation increases from 190 to 930 mm the cdf matching method to hybrid machine learning and numerical modeling causes multiple problems first the high values of accumulated precipitation appeared to be concentrated at the east and northeast pixels at the edge second the horizontal belt shaped high precipitation artifacts appear at the northern part of harris county to quantify the difference between the benchmark precipitation and the precipitation forecasts the first level statistics are applied to the county wide averages as well as to each pixel from 25 08 2017 to 31 08 2017 the statistical results are listed in table 4 both county averaged and pixel level statistics agree that the ai nowcast precipitation forecast has the highest correlation coefficient 0 98 and 0 8 the large negative normalized bias 52 84 and 22 96 and the least rmse 5 18 mm hr and 11 87 mm hr among all precipitation forecasts ai nowcast can capture the temporal pattern very well despite that there is a large deficit in precipitation magnitude hrrr qpfs show a very low correlation with benchmark precipitation both at county average 0 55 and pixel level 0 13 the hrrr qpfs also have the largest rmse among all other precipitation forecasts despite having the clostest to optimal bias nb is 8 45 and 1 03 for county averaged and pixel level analysis rap qpfs have a good correlation with the benchmark when averaged over harris county 0 76 but poor correlation at each pixel 0 31 which might be caused by its coarse spatial resolution the ai hybrid method is proved to be less correlated with the benchmark compared to ai nowcasts and has higher rmse the attempt to combine ai nowcast and hrrr provides worse statistical results which can be caused by the artifacts found in fig 2 to visualize the differences the county averaged precipitation estimates and forecasts are plotted in fig 3 the ai nowcast green appears to follow all the peaks as the benchmark black and match well when the precipitation is light however the magnitude of the peaks are only equivalent to a fraction of the benchmark data and the accumulated rainfall amount indicates a severe underprediction all other precipitation forecasts rap hrrr and ai hybrid overpredict most of the precipitation peaks before 27 08 2017 and after 29 08 2017 while underpredicting during 28 08 2019 which explains the poor statistical results displayed in table 4 as shown in fig 3 the hrrr qpf blue and ai hybrid plum forecasts are overlapped in most days which indicates that the cdf matching method not only increases the magnitude of ai nowcasts but also picks up a lot of information from the hrrr since the hrrr has the spatial displacement problem this property also passes along to ai nowcast causing the reduced predictability the pixel level statistical results are plotted in fig 4 as shown in the plot and table 4 rap and hrrr have a low temporal correlation with benchmark data throughout the area and ai nowcasts and ai hybrid predictions have a higher correlation deep learning predictions appear to create minor artifacts in multiple radial circle patterns on the temporal correlation with the benchmark data for bias the numerical modeling forecasts rap and hrrr have most of the high bias concentrated at the southeastern corner which is towards the storm core this indicates overprediction of precipitation at the highest intensity cores for the numerical modeling forecasts the artifact of the ai hybrid found in fig 2 is magnified in the bias analysis where the horizontal stripes of high bias values concentrate at the northern half of the map in this study rap has lower rmse than hrrr despite the fact that the hrrr is a newer and higher resolution version of rap and the large rmse values are concentrated towards the storm core based on the statistical analysis the results indicate that there are differences between the precipitation forecasts and the benchmark where the rap qpf is too coarse to represent the details of the storm the hrrr qpf has displacement error the ai nowcast fails to predict the precipitation intensity and the ai hybrid forecast has boundary and artificial noise issue yet a complete agreement between the weather forecast and the weather radar observation is not expected it would be worth to explore the potentially useful information from the qpf driven flood prediction as the forecast technology improves in the future the flood prediction improvement will hence to be examined based on the presented results in section 3 2 3 2 hydrological analysis the crest imap yields simulated hydrographs using forcing from the mrms benchmark and all the precipitation forecasts from 15 08 2017 to 03 09 2017 at two usgs gauge locations at cypress creek and spring creek spring creek is located at the northern part of the spring basin which includes an underdeveloped area and did not show too much overbank flow during hurricane harvey while cypress creek is located at the southern part of the basin across multiple developed urban areas and had obvious overbank flow during hurricane harvey chen et al 2020 the simulation results are plotted and listed in fig 5 and table 5 in fig 5 with the exception of the ai nowcasts all precipitation forecasts generate a second flood peak at both cypress and spring creek which was not observed by usgs stream gauges as ai nowcast underpredicts the total precipitation amounts and rates it generates a smaller flood peak consequentially but it has a high score on nsce 0 71 and cc 0 9 compared with the usgs gauge data as shown in table 4 the ai hybrid provides an undesirable flood forecast with nsce less than 0 7 and positive pte which means the forecasted flood peak is later than the observed flood peak the ai hybrid plum line in fig 5 carries some features from the hrrr which causes a non existent second flood peak the nwp modeled qpfs produce lower nsce scores on flood prediction comparing to the deep learning methods in general however hrrr provides relatively more accurate predictions on flood peak and less flood peak time error which are significant for the emergency responses and nws field operations as the flood peak and flood time is the most important factors to mitigate the damage and protect properties overall the precipitation forecasts cannot match the performance of the benchmark as expected and hrrr qpf provides a relatively better flood magnitude prediction among four precipitation forecasts in this study the benchmark precipitation data mrms is utilized in the flash project as the forcing data for the crest ef5 model to produce the near real time streamflow flamig et al 2020 gourley et al 2017 the flash project has shown its benefit as a supporting tool during hurricane harvey according to the nws service assessment report murphy 2018 therefore with the consideration of the error propagated from the precipitation forecasts the 1 hour lead time flood prediction can be a very useful tool the ai nowcast predicts the flood timing better than others so if the first responders know the semi accurate flood time with hours of lead time it is a successful step for flood prediction only if the method could improve in the precipitation intensity forecast as shown in the hydrological analysis the current structure of using precipitation forecasts to drive crest imap has considerable value for the automated real time flood prediction operation even though no forecast data can provide a comparable flood prediction as mrms benchmark observation but the errors from the precipitation forecasts are expected and the prediction results do provide flood information with much longer lead time as mrms is a real time weather radar precipitation product it can provide very short to no lead time for flood prediction depending on the lag time of the individual flood event therefore the weather forecast based flood prediction has the advantage of lead time over the benchmark but the disadvantage on accuracy which can be potentially balanced in flood warning operations 3 3 flood extent analysis the crest imap can not only simulate the streamflow but also the 2d flood extent and flood depth we take the maximum flood depth at every pixel through all the time steps to construct the maximum flood extent map for all precipitation forecasts and benchmark forced simulations which is shown in fig 6 the binary statistical results are listed in table 6 although previous statistical and hydrological analysis shows drastic differences between the different precipitation forecasts the maximum flood extent maps are very similar and the binary statistics in table 6 are numerically close too the ai nowcast is the only one that has a lower pod 0 48 and a lower csi 0 35 which is likely due to its underestimation of precipitation amount as shown in table 1 and fig 3 based on the results in fig 6 the crest imap appeared to neutralize most of the differences between different precipitation forecasts to produce similar maximum flood maps since the maximum flood extent has positive correlation with the total precipitation amount during the flood events o hara et al 2019 there are no successful predictions for the upper cypress creek southwestern part of the map all flood predictions other than the ai nowcasts can achieve a csi of about 0 4 and pod about 0 6 which can still provide limited information and guidelines for future flooding however the over 45 false alarming could mislead preparatory action to the flood the analysis of the initial inundation water depth 5 cm time is listed in fig 7 where the color ramp represents the unified time steps which is equivalent to 30 mins for easier display due to high temporal resolution of 2d flood simulation 10 s the dark blue color represents the first day of the study period 25 08 2017 00 00 and the dark red color represents the end of the last day of the study period 29 08 2017 24 00 for example in the figure all maps show dark blue color as the center of the main streamlines which represent the river channels that have water running at the beginning of the period the bar plot on the right column of fig 7 represents the distribution of the flood time difference between the flood prediction and the benchmark flood extent where the red dashed line is the 0 difference line and the black dashed line represents the mean differences negative values indicate the predicted flood comes earlier than the benchmark and the positive value means the predicted flood comes later than the benchmark for the benchmark flood map most of the inundation occurs around 88 150 time steps which are late in the 26th to the morning of the 28th of august 2017 this result corresponds with the county average precipitation results in fig 3 where the benchmark black line shows the first peak of precipitation about 20 mm hr around 1200 utc on the 26th and two large rainfall peaks 30 mm hr on the 27th and early on the 28th of august the flow dynamic analysis also picks up the overbank flow of the rivers where the color ramp changes from the center outward from dark blue had water in channel on 25th to light green overbank flooded on 27th then to dark red over bank flooded on 29th which represents the river experiencing multiple overbank flows throughout the study period the flood prediction from the rap and hrrr qpf show much more blue earlier inundation compared to the benchmark which corresponds to the time when the rap red and hrrr blue have their largest peak precipitation rates 46 mm hr and 34 mm hr respectively on the 26th of august in fig 3 these simulated artifitial extreme precipitation rates can cause flood inundation immediately which leads to an earlier inundation than the benchmark since the hrrr has higher spatial resolution and greater peak precipitation rates than the rap presented in table 1 the initial inundation time map of the hrrr has more late red inundation along the river channels than the rap predicted inundation time which indicates that there is more overbank flood with reasonable time lags represented in the hrrr than the rap due to the spatial resolution differences low resolution rap provides uniform precipitation on river channel upper and downer portion of a reach segment as well as the basin catchment on the other hand the higher resolution hrrr could provide higher precipitation rate at catchment but lower rate at channel at the same time step as the rap but water routing from land to channel could take longer time so the higher resolution forecast hrrr showed more delayed flood than the lower resolution forecast rap a more comprehensive study will be needed to provide explicit understanding of this relationship and the aforementioned hypothetical scenario is provided to help understanding the possible causes of the flood time differences the ai nowcast predicted inundation time map shows more light blue 32 hr and green 48 hr compared to other predictions which is caused by the low precipitation intensity that led the delayed water accumulation on the surface the ai hybrid prediction shows earlier inundation than the benchmark which is very similar to the hrrr prediction overall ai hybrid and hrrr predictions have over 70 of wet pixels 74 and 72 respectively that are flooded earlier than the benchmark and rap prediction has 66 of wet pixels flooded earlier than the benchmark even with the significant underprediction of precipitation rate from ai nowcast its flood prediction has about 50 of wet pixels flooded earlier than the benchmark the predicted flood extent provides more useful information than the hydrograph predictions the flood map predicted by the hrrr and rap qpfs can provide information about the location of possible fluvial and pluvial floods however the flood prediction times are not reliable machine learning prediction methods show little to no value in the flood extent analysis due the underprediction of the precipitation intensity 3 4 flood depth analysis 50 usgs high water mark hwm sites are located in the spring basin fig 1 where the water depth values are extracted from all flood maps including the benchmark and predicted flood maps in fig 8 the scatter plot of the benchmark flood depth and predicted flood depth against the hwm data is presented as the previous study indicates the error of simulated harvey flood depth is up to 1 m wing et al 2019 it is no surprise that the benchmark black dots cannot align perfectly along the diagonal and the predicted flood depths only perform worse as shown in fig 8 almost all predicted flood depths are below the diagonal except one location that is predicted by hrrr qpf with crest imap blue dots since ai nowcast underpredicts the precipitation and associated flood there are 38 out of 50 hwm sites that are predicted to be not inundated under this scenario other above the diagonal dots are the ones that hwm data shows 0 but the flood predictions indicate positive values overall all the flood predictions underpredict the inundation depth and provide little value for flooding emergency responses the error distributions of inundation depths are plotted in fig 9 the plots show that no flood prediction error is as centered to 0 as the benchmark estimation mrms second to the benchmark the rap qpf can lead to a predicted flood depth that is slightly better than hrrr qpfs and the ai hybrid method predicted flood depths this result again demonstrates the similarity of hrrr qpf and ai hybrid forecasting where their flood depth prediction errors are almost identical it raises the speculation that using cdf matching technique to hybrid machine learning and numerical modeling might pick up too much unnecessary information from the target dataset hrrr in this study in general using rap qpf hrrr qpf ai nowcast and ai hybrid forecast can only provide limited information about the upcoming flood inundation depths for an extreme event however the flood depth estimation is a common insufficiency of many popular flood models which has been shown in previous studies chen et al 2021 wing et al 2019 therefore the error from the precipitation forecasts combines the hydraulic model error that deviate the predicted flood depth further away from the hwm measurements at the current state of improvement for hydrologic modeling and weather prediction the overarching goal of higher accuracy on flood depth predictions is yet to be reached 4 discussion the nwp based qpfs show poor predictability in precipitation spatial and temporal distribution even though their predicted total quantity is relatively accurate one possible cause could be the selection of the forecasted rain fields which we select the 1 hour lead time forecasts while rap and hrrr can forecast up to 18 h the study of seo et al 2018 suggests that the rap and hrrr qpfs perform better with 4 6 h lead time indicating that the 1 hour forecasts are not necessarily the most reliable qpf product another recent study yue and gebremichael 2020 indicated that all the hrrr forecast including 1 hr lead time has strong agreement with the observation while slightly over prediction the magnitude for a half of the hurricane event however due to the limited computational resources the requirement of hyperresolution precipitation for hydrological forecast and the heavy gpu memory requirements the ai methods will not likely forecast 3 h of lead time only limited to 1 hour lead time in this study for any machine at current time therefore certain amount of error from numerical modeling forecasts are expected and the predictability study over different lead times will be conducted in the future however the well known qpf issues still exist such as the underforecasting the convective system rainfall rap and spatial displacement errors hrrr which are likely to present in the other forecast periods the hrrr ensemble hrrre project was proven to mitigate those errors carlberg et al 2020 which will lead to a better flood forecast once the hrrre being an operational product the ai nowcast method lacks the ability to forecast the extreme precipitation event such as hurricane harvey the ai model is trained by all precipitation events in the houston area from 2015 to 2019 that are listed in noaa storm report and have caused urban flooding except hurricane harvey which means it is trained specifically for high intensity precipitation scenarios but the results indicate the method cannot reproduce the precipitation intensity of hurricane harvey and provides no useful information for local flood prediction based on the study done by google research the u net machine learning method outperforms hrrr qpf and the optical flow method using precision recall curve analysis agrawal et al 2019 this statement still holds in this case study however as a binary analysis conducted in the aforementioned study the lack of predicted precipitation intensity is not revealed in the precision recall curve analysis although the precision recall curve is a common and powerful scoring tool for machine learning this test is not sufficient for hydrological and hydrometeorological studies since the precipitation intensity is as important if not more as its spatial temporal placement therefore deep learning methods for hydrological prediction still require much effort from the scientific community to improve the technology as a preliminary attempt to combine the results of ai nowcasts and numerical model outputs the cdf matching technique is used in this study to produce the ai hybrid forecasts but failed to perform well in this case study it has been shown in the previous section that the technique creates artifacts and border effects but it also shows that the technique alters the spatial temporal distribution of the ai nowcast towards the hrrr which leads to the similarities between the hrrr and the ai hybrid in section 3 3 and 3 4 since the ai nowcast is able to capture the spatial temporal pattern of the mrms estimation improving the precipitation intensity forecast but not changing its pattern could be a future direction for deep learning nowcasting approaches given that the ai nowcast model could produce high resolution 3 km 15 mins forecast within minutes for the 10 days period for 276 by 216 cells using a single gpu unit this method still has the advantage on computational efficiency compared to hrrre experiment that has used 144 parallel nodes to power wrf arw to simulate 1580 by 1000 meshes over the full conus dowell et al 2018 with improvement on its forecast performance ai nowcasting method could potentially be a computationally efficient forecast method in the future lastly the maximum flood map analysis using crest imap neutralizes or smooths much of the differences between precipitation forecasts as the total accumulated precipitation dictates the maximum flood extent the results indicate the qpf with a higher spatial resolution would potentially improve the flood timing forecast yet a more comprehensive study is needed to examine the importance and impacts of spatial resolution to flood extent forecast since the rap and hrrr qpfs have a reasonable forecast of total precipitation amount over the region the flood extent analysis results for numerical modeling are acceptable and provide indications for flood forecasts therefore even with certain missing inundation scenarios the qpf crest imap could still potentially provide preliminary information about the final outcome of a future flood event 5 conclusion the ability of precipitation forecasts to predict flood discharges inundation extents and flood depth has been tested using numerically modeled qpfs rap and hrrr and deep learning nowcasts ai nowcast and ai hybrid with 1 hour lead time none of the precipitation forecasts can provide comparable flood information as the radar based benchmark mrms which neither the nwp models nor any nowcasting method is expected to be as accurate as weather radar observation the benchmark in this study is an ultimate and overarching goal for the weather forecasting community when the real forecasting is needed for the future and the observation is not available the numerical weather prediction model qpfs can provide general information about flood return period and inundation outcomes where the hrrr slightly outperforms the rap the ai nowcast is incapable to capture the precipitation intensity of hurricane harvey which indicates the potential inability of such method as well as the inability of common machine learning performance tests to reveal such information the ai nowcast method can forecast the spatial temporal pattern in high resolution and extent of the precipitation in a very short amount of time it will be the future objective to combine the ai nowcasts and qpfs using different methods as the cdf matching technique fails to improve the performance of the hybrid approach evaluated in this study the nwp qpfs have spatial displacement errors underlying most of the qpf total error but the ensembled weather forecasting products e g hrrr ensemble should reduce such errors by theory which should be further studied to provide improved flood severity prediction further flood predictability analysis with longer lead time is needed to study the possible best combination of qpf crest imap to provide the best possible flood forecast for local emergency response agencies credit authorship contribution statement mengye chen conceptualization methodology software visualization zhi li software shang gao writing review editing ming xue supervision jonathan j gourley writing review editing randall l kolar supervision yang hong conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to thank the support from oklahoma university hydrology and water security program 
3073,a flood is one of the most hazardous natural disasters and it commonly causes fatalities and socioeconomic damages the advances of modeling techniques and observation data in flood prediction have found success in field operations this paper presents a comprehensive flood prediction of hurricane harvey in 1 hour lead time that is not limited to 1d streamflow forecast but also 2d flood extent and 3d inundation depth it uses high resolution quantitative precipitation forecasts qpfs from operational rapid refresh rap and high resolution rapid refresh hrrr models and deep learning nowcasts ai nowcasts the results show that the qpfs have a well known displacement issue and the ai nowcast cannot predict the precipitation intensity and an attempt to combine the two methods ai hybrid failed to improve the overall accuracy however the 2d flood extent predictions with the hrrr and ai hybrid forcings can provide information indicating the future flooded area with about 50 accuracy hit rate and stream flow prediction showed that the hrrr qpf can provide relatively accurate flood peak prediction 8 in contrast the ai nowcast reveals minimal displacement errors but underpredicts precipitation intensity the deep learning method also indicates that the binary tests with low threshold which are commonly employed in the deep learning field neglect the importance of precipitation intensity errors for extreme event studies keywords quantitative precipitation forecast flood deep learning hydrologic hydraulic model forecasts hurricane harvey data availability data will be made available on request 1 introduction the increase of frequency and magnitude of extreme weather and precipitation caused by climate change has received much attention meehl et al 2000 usgcrp 2017 van oldenborgh et al 2018 further tropicalization a global trend towards a heavier precipitation climate has been modeled in europe gobiet et al 2014 consequentially this change would lead to more flood events in the future which is the second deadliest and most common natural hazard in the united states and world ashley and ashley 2008 barredo 2007 benito et al 2004 smith and ward 1998 according to brauer et al 2020 the rate and duration of precipitation land use and soil moisture content as well as topography all have impacts on the severity of flooding moreover tropicalization combining with rising sea levels and ocean temperatures will only intensify flooding especially along coastal areas wing et al 2019 to quantify and mitigate flood risks many tools have been developed to simulate flooding at post event bates et al 2010 bates and de roo 2000 de almeida and bates 2013 srinivasan and arnold 1994 wang et al 2011 wood et al 1992 xue et al 2016 and in real time cohen et al 2018 gochis et al 2017 sampson et al 2015 wing et al 2019 2017 instead of post event hydrological reanalysis or real time streamflow simulation this study explores the options for forecasting flood events which could potentially provide a longer lead time for emergency response officials or even the general public to proactively respond to possible future flood risks almost 40 years ago georgakakos and hudlow 1984 discuss the use of quantitative precipitation forecasts qpfs from the numerical weather prediction nwp models for hydrological forecasting the operational limited area fine mesh lfm model newell and deaver 1981 from the national weather service nws at the time had a horizontal grid spacing of 127 km and the on demand movable fine mesh mfm model had an improved grid spacing up to 60 km while promising the lack of spatial specificity needed for hydrological forecasting and the relatively low accuracy of qpf limited the application of model based qpf to drive hydrological models with the advancement of computing and climate observation technologies the nwp models have improved dramatically in recent decades in terms of their spatial and temporal resolutions accuracy and coverage trenberth 2010 the current operational high resolution rapid refresh hrrr benjamin et al 2016 lee et al 2019 has a horizontal grid spacing of 3 km with hourly updated forecasts over the contiguous united states conus convection allowing cloud resolving nwp models have been run at 1 km grid spacing loken et al 2017 xue et al 2013 however accurate qpf remains a challenge because of many complex factors involved in precipitation processes ebert and mcbride 2000 golding 2000 major errors of nwp qpfs include spatial displacement errors ebert and mcbride 2000 and errors in intensity especially for extreme events cuo et al 2011 for short range precipitation forecasting the proper initialization of existing precipitation fields for the forecasting model is also an important issue kain et al 2010 sun et al 2014 precipitation nowcasting typically refers to very short range 1 6 hr forecasting of precipitation and the traditional nowcasting is mostly done by extrapolating observed radar reflectivity fields ligda 1953 demonstrated the possibility of providing reasonable forecasts based on the persistence and movement of radar echoes this technology has a recent technological improvement with the combination of high performance computing hpc and artificial intelligence ai resulting in successful applications in real world problems including precipitation nowcasting agrawal et al 2019 lecun et al 2015 in 2019 google research published a study showing the advantage of using deep learning nowcasts to predict 1 hour lead time precipitation over the conus outperforming traditional optical flow extrapolation method persistence and 1 hour hrrr forecasts agrawal et al 2019 moreover many recent studies also show successes in deep learning precipitation nowcasting franch et al 2020 introduce a new deep learning model taasrad19 to forecast 1 hour lead time radar reflectivity which is then converted to precipitation rate yielding a critical success index csi of 0 5 over a 9 year sample while most ai nowcast studies evaluate binary coverage as the performance test kumar et al 2020 demonstrate their deep learning model reduces the root mean square error rmse between forecast and satellite precipitation estimates to 0 8 mm hr on 30 min lead time and up to 1 4 mm hr on 150 min lead time using global precipitation mission gpm integrated multi satellite retrievals imerg datasets they identify the most significant error source being underestimation with extreme events however the hydrological performance of ai nowcasts is generally underexplored flood prediction has a history of different methods from upstream level exceedance thresholding and level to level correlations to hydrological and hydrodynamic models adams and pagano 2016 for modern operational flood forecasting systems it is common to use quantitative precipitation estimates qpes precipitation nowcasts and nwp qpfs to drive hydrological models cuo et al 2011 golding 2000 hapuarachchi et al 2011 since there is a lag time between the precipitation peak and the streamflow peak bedient et al 1988 some operational systems are capable of predicting the flood by using the real time observed precipitation products as the forcing dataset for example the scottish environment protection agency uses radar and in situ precipitation data to provide streamflow forecasts werner and cranston 2009 the national center of environmental prediction ncep adapts the national water model nwm cohen et al 2018 gochis et al 2017 while the national severe storm laboratory nssl utilizes the ensemble framework for flash flood forecasting ef5 as part of the flash project flamig et al 2020 gourley et al 2017 both nwm and ef5 use the multi radar multi sensor mrms qpes to drive streamflow forecasts for the entire conus and outer territories to provide longer range more than a few hours and more comprehensive flood predictions it is necessary to utilize nowcasts or qpfs and the flood predictions can be extended beyond streamflow prediction to also include two dimensional 2d flood extent and flood depth forecasting however due to the accuracy issues of qpf the skill of longer flood range prediction is still limited especially at the scales of urban watersheds hapuarachchi et al 2011 more recent hydrological evaluation of operational hrrr qpf indicates that even though this advanced product is capable of forecasting mesoscale convective systems well qpfs associated with smaller scale precipitation systems often contain significant errors making hydrological prediction errors to become too large lee et al 2019 seo et al 2018 this study is an attempt to utilize advanced nwp qpfs and ai precipitation nowcasting for the prediction of flooding triggered by the landfalling hurricane harvey in 2017 the comprehensive predictions include 1d stream discharge 2d flood extent and 3d flood depth using the coupled routing and excessive storage inundation mapping and prediction crest imap model this work evaluates the ability of state of art operational qpfs to predict not only streamflow but also flood extents and flood depths and it presents one of the first studies to evaluate the hydrological performance of ai precipitation nowcast techniques the precipitation forecasts and flood prediction results are compared with mrms qpe us geological survey usgs stream gauge data mrms qpe simulated flood extent federal emergency management agency fema flood insurance claims and usgs high water mark post event survey data the rest of this paper is organized as follows section 2 describes the qpf datasets study area crest imap model and the deep learning architecture for ai nowcasting section 3 demonstrates the results of the predicted streamflow hydrographs flood extent and inundation depth compared to the benchmark and other ground observations section 4 discusses the major findings from the results section 5 concludes and proposes future studies 2 methodology 2 1 forecast rainfall this study relies on the applications of operational nwp models that provide the qpf products which are archived in noaa s national operational model archive and distribution system the rapid refresh rap was first developed in may 2012 built upon the first hourly updated operational nwp system in the world rapid update cycle ruc back in 1998 benjamin et al 2016 2004 after two major improvements in 2014 and 2016 rap now consists of multiple meteorological data and models to increase accuracy such as the noaa gridpoint statistical interpolation gsi a version of weather research and forecasting wrf regional model and the national center of environmental prediction ncep unified post processor upp the current rap qpf product can provide hourly updated precipitation forecasts out to 18 h at 13 km spatial resolution over the entire north america in this study the 1 hour lead time data was obtained from the noaa s national center for environmental information ncei website https www ncdc noaa gov data access model data model datasets rapid refresh rap the hrrr was first released in september 2014 and finished its first upgrade in 2016 then was deployed as a new operational model in july 2018 lee et al 2019 hrrr is a nested model that heavily relies on rap data assimilation which covers the continental united states conus and provides hourly forecasts up to 18 h in the future at 3 km spatial resolution benjamin et al 2016 in this study the 1 hour lead time hrrr v2 forecast data obtained from the university of utah hrrr data archive https home chpc utah edu u0553130 brian blaylock cgi bin hrrr download cgi all forecast products are 1 hour lead time since the deep learning precipitation nowcasting method in this study can only produce a 1 hour forecast due to the limitation of computational resources the basic statistics of precipitation forecast datasets are listed in table 1 2 2 deep learning precipitation nowcasting the advancement in machine learning deep learning recently has been claimed to be successful when applied to the short range nowcasting of precipitation shi et al 2015 ai precipitation nowcasting as a data driven and localized method is adapted to the local environment and requires no prior knowledge about weather systems from the model developer which predicts next step precipitation distribution by a series of previous frames from a well trained model structure in this study we select the u net model structure for the following reasons first it is a widely adopted structure for precipitation estimation and prediction li et al 2020b sadeghi et al 2020 second the lightweight framework necessitates a fewer number of parameters compared to other models and requires less system memory to train the model before the model training some preprocessing steps are conducted for unifying precipitation estimates from multiple events due to the nature of the non gaussian distribution of precipitation per frame one way to normalize precipitation data is via logarithmic transformation similar to sønderby et al 2020 precipitation data is transformed and normalized based on the following equation r log x 0 01 4 where is the input rainfall rate and r is the normalized rainfall rates subsequently rainfall data is grouped every 10 frames at 6 min increments to target next hour precipitation forecasts the mean square error mse and adam a deep learning optimizer kingma and ba 2017 are chosen as the objective function and optimizer in this setting the initial learning rate α 1 1 learning rate is a hyperparameter that controls how much change the deep learning model in response to estimated error each time the model weights are updated some considers the learning rate is the most important hyperparameter for neural network configuring is set at 0 001 but is scheduled to decrease exponentially with training process to avoid blowing up due to the limitation of the graphics processing unit gpu memory capacity 2 gb this study can only predict a 1 hour lead time given the size of the study area which is 4 time steps ahead 15 min resolution in this study the u net structured deep learning model is trained by the mrms qpes for 16 precipitation events listed in noaa storm report table 2 that caused flooding in the houston area from 2015 to 2019 except hurricane harvey with a total of over 30 000 images the intensive precipitation focused deep learning model is then used to forecast 1 hour lead time from 24 08 2017 to 02 09 2017 10 days the experiment is conducted using a single nvidia gtx 960 m gpu card the training process took 48 h and the forecasting process took around 300 s for 1 hour lead time 4 time steps ai based nowcasting can effectively capture the spatiotemporal correlation with observations yet it may misrepresent the event magnitude which is a common weakness of ai nowcast kumar et al 2020 on the other hand the physical simulations are apt at identifying storm cores and thus the event rainfall magnitude it is presumably advantageous to take the respective advantages of both to produce a hybrid product in this study a conventional non parametric probability matching scheme is taken at each nowcast time step to increase the rainfall magnitude of the ai produced product close to the hrrr forecasts the basic idea is to conserve the ranks of the initial rainfall rate for a given frame and its empirical cumulative density function cdf is modified to match the target cdf 2 3 observed rainfall flood benchmark and data the observed precipitation product is chosen to be the mrms radar only 2 min qpe which showed high correlations and small error compared to the harris county flood control district rain gauge network in previous studies chen et al 2020 li et al 2020a this data is obtained from the iowa environmental mesonet nws data archive https mesonet agron iastate edu nws the benchmark flood map is simulated by crest imap using mrms 2 min qpe as the forcing data to create the benchmark flood map the crest imap goes through a warmup period from 01 04 2017 to 24 08 2017 using the mrms 1 hour gauge corrected qpe and then simulates the hurricane harvey induced flood from 24 08 2017 to 02 09 2017 10 days driven by the mrms 2 min qpe the 10 meter resolution manning s roughness coefficient field is derived from the landcover data from multi resolution land characteristics consortium mrlc https www mrlc gov using a look up table from the literature liu et al 2019 mccuen 2005 other benchmark data include the two usgs stream gauge fig 1 data downstream of spring 08068500 and cypress creek 0809000 which are obtained from the usgs water information system usgs wis https waterdata usgs gov the usgs high water marks hwm data are manually surveyed post event water depths by measuring the residual water stain or mudlines left on buildings and other infrastructure which is considered as the true ground observations of flood depth feaster and koenig 2017 2 4 the crest imap model crest imap is a hydrological and hydraulic coupled model developed by the hydrometeorology and remote sensing laboratory at the university of oklahoma and is designed to operate in near real time it is the newly added member of a well documented crest modeling family which has been widely applied to multiple operations and applications around the world clark et al 2017 flamig et al 2020 gourley et al 2017 wang et al 2011 the crest imap coupled the water balance component of crest and the 2d hydraulic routing using a fully solved shallow water equation with a finite volume method the model can be nested with the crest ef5 framework for near real time operation or as a standalone operation the model receives precipitation data as the driving input over topographical datasets and the crest water balance component generates excessive rainfall which is then routed through the unstructured triangular mesh to generate channel flow rate flood extent and flood depth the model calibration is conducted for the period from 01 04 2017 to 24 08 2017 using the dream algorithm vrugt 2016 vrugt et al 2009 to optimize all water balance parameters by targeting five different usgs stream gauges at midstream 08068275 and downstream 08068500 of spring creek as well as upperstream 08068720 midstream 08068800 and downstream 08069000 of cypress creek after the model is set and warmed up the different qpfs and ai nowcasting products were applied to crest imap as the forcing data to produce 1d streamflow 2d flood extent and the 3d flood depth the simulation results were saved in the model native netcdf format and are available through hydroshare https www hydroshare org resource fae24734d6fc47be8bf0b54d6a175d86 2 5 study area harris county tx was the most impacted area during hurricane harvey with 103 casualties over 40 000 people evacuated and over 30 000 water rescues conducted murphy 2018 fig 1 shows the impacted area of hurricane harvey the hurricane track and the study area of this research the statistical analysis of different qpfs is conducted throughout the entire harris county area and the flood analysis is conducted at the spring basin which is located at the northern part of harris county the hydrologic and flood inundation analysis is focused on the spring basin because the two rivers are connected the lake houston which is not directly entering the trinity bay and gulf of mexico therefore this focusing basin is less impacted by wind induced storm surges and this study can focus on the precipitation differences and its corresponding pluvial and fluvial flood 2 6 statistical metrics to compare each forecasting product and evaluate the flood predictability four levels of statistical tests are conducted in this study first the benchmark precipitation in 2 3 is used to compare qpfs and ai based nowcasts using statistical measures second the crest imap simulated hydrographs are analyzed using not only standard statistic metrics but also hydrological modeling efficiency measures third the crest imap simulated flood extents are analyzed using standard binary pattern measures fourth the crest imap simulated flood depth is analyzed against the usgs hwm all four levels of statistical metrics are listed in table 3 the correlation coefficient cc over a time series measures the strength of an estimate to capture the temporal pattern of the observation traditionally the relative bias is commonly used to measure the errors of the estimate as a fraction of the observation value however for precipitation and streamflow data the values are either positive or zero so the relative bias value can range from 1 to especially when the predicted value is much higher than the benchmark value which could causes confusion during aggregation when few large positive relative bias value offset most negative values to avoid the confusion the normalized bias nb fraction is introduced to normalize the bias from 1 to 1 the root mean square error rmse mm hr for precipitation and m3 s for streamflow measures the distance between the estimates and the observation the probability of detection pod measures the ability to predict the benchmark flood extent the false alarm rate far reflects the tendency to overpredict the benchmark flood extent the critical success index csi measures the overall performance of the flood predictions compared to the benchmark the nash sutcliffe coefficient of efficiency nsce unitless measures the effectiveness of the model prediction compared to the stream gauge observation the peak flow error pe m3 s calculates the difference between predicted and observed peak flow the peak time error pte hour calculates the arriving time difference between predicted and observed peak flow 3 results 3 1 precipitation analysis to observe the first level differences of all the precipitation forecast products the accumulated precipitation from 25 08 2017 to 31 08 2017 is plotted in fig 2 the first clear observation appears to be the spatial resolution differences as rap and hrrr show coarser resolution grid cells across the map compared to mrms and the ai nowcasts due to the low spatial resolution rap can only provide a basic depiction of the precipitation core and has a smooth transition from the high precipitation southeast to the lower precipitating amounts northwest as listed in table 1 rap s highest mean precipitation rate 7 45 mm hr the highest mean accumulated precipitation 1081 mm but low maximum precipitation rate 49 83 mm hr means that it does not simulate extremes like mrms the second clear observation is the underprediction of the ai nowcasts the average precipitation rate of ai nowcast during hurricane harvey is 3 18 mm hr and its mean accumulated precipitation is only 190 mm which is much less than the values of mrms qpe which are 6 16 mm hr and 830 mm respectively google shows the u net framework providing well performed nowcasting precipitation prediction from july 2017 to july 2019 agrawal et al 2019 however for an extreme event like hurricane harvey the result indicates there are difficulties for machine learning methods to predict the precipitation intensity magnitude wise hrrr qpf is comparable with mrms qpe with the mean precipitation rate of 6 65 and 6 16 mm hr respectively table 1 however the spatial displacement of large precipitation amounts from the hrrr is visually clear where the red circles fig 2 provide simple examples where mrms has low accumulated precipitation but the hrrr has a large amount of total precipitation forecast and vice versa the ai hybrid method shows improved precipitation magnitude from 3 18 mm hr to 7 10 mm hr and the mean accumulated precipitation increases from 190 to 930 mm the cdf matching method to hybrid machine learning and numerical modeling causes multiple problems first the high values of accumulated precipitation appeared to be concentrated at the east and northeast pixels at the edge second the horizontal belt shaped high precipitation artifacts appear at the northern part of harris county to quantify the difference between the benchmark precipitation and the precipitation forecasts the first level statistics are applied to the county wide averages as well as to each pixel from 25 08 2017 to 31 08 2017 the statistical results are listed in table 4 both county averaged and pixel level statistics agree that the ai nowcast precipitation forecast has the highest correlation coefficient 0 98 and 0 8 the large negative normalized bias 52 84 and 22 96 and the least rmse 5 18 mm hr and 11 87 mm hr among all precipitation forecasts ai nowcast can capture the temporal pattern very well despite that there is a large deficit in precipitation magnitude hrrr qpfs show a very low correlation with benchmark precipitation both at county average 0 55 and pixel level 0 13 the hrrr qpfs also have the largest rmse among all other precipitation forecasts despite having the clostest to optimal bias nb is 8 45 and 1 03 for county averaged and pixel level analysis rap qpfs have a good correlation with the benchmark when averaged over harris county 0 76 but poor correlation at each pixel 0 31 which might be caused by its coarse spatial resolution the ai hybrid method is proved to be less correlated with the benchmark compared to ai nowcasts and has higher rmse the attempt to combine ai nowcast and hrrr provides worse statistical results which can be caused by the artifacts found in fig 2 to visualize the differences the county averaged precipitation estimates and forecasts are plotted in fig 3 the ai nowcast green appears to follow all the peaks as the benchmark black and match well when the precipitation is light however the magnitude of the peaks are only equivalent to a fraction of the benchmark data and the accumulated rainfall amount indicates a severe underprediction all other precipitation forecasts rap hrrr and ai hybrid overpredict most of the precipitation peaks before 27 08 2017 and after 29 08 2017 while underpredicting during 28 08 2019 which explains the poor statistical results displayed in table 4 as shown in fig 3 the hrrr qpf blue and ai hybrid plum forecasts are overlapped in most days which indicates that the cdf matching method not only increases the magnitude of ai nowcasts but also picks up a lot of information from the hrrr since the hrrr has the spatial displacement problem this property also passes along to ai nowcast causing the reduced predictability the pixel level statistical results are plotted in fig 4 as shown in the plot and table 4 rap and hrrr have a low temporal correlation with benchmark data throughout the area and ai nowcasts and ai hybrid predictions have a higher correlation deep learning predictions appear to create minor artifacts in multiple radial circle patterns on the temporal correlation with the benchmark data for bias the numerical modeling forecasts rap and hrrr have most of the high bias concentrated at the southeastern corner which is towards the storm core this indicates overprediction of precipitation at the highest intensity cores for the numerical modeling forecasts the artifact of the ai hybrid found in fig 2 is magnified in the bias analysis where the horizontal stripes of high bias values concentrate at the northern half of the map in this study rap has lower rmse than hrrr despite the fact that the hrrr is a newer and higher resolution version of rap and the large rmse values are concentrated towards the storm core based on the statistical analysis the results indicate that there are differences between the precipitation forecasts and the benchmark where the rap qpf is too coarse to represent the details of the storm the hrrr qpf has displacement error the ai nowcast fails to predict the precipitation intensity and the ai hybrid forecast has boundary and artificial noise issue yet a complete agreement between the weather forecast and the weather radar observation is not expected it would be worth to explore the potentially useful information from the qpf driven flood prediction as the forecast technology improves in the future the flood prediction improvement will hence to be examined based on the presented results in section 3 2 3 2 hydrological analysis the crest imap yields simulated hydrographs using forcing from the mrms benchmark and all the precipitation forecasts from 15 08 2017 to 03 09 2017 at two usgs gauge locations at cypress creek and spring creek spring creek is located at the northern part of the spring basin which includes an underdeveloped area and did not show too much overbank flow during hurricane harvey while cypress creek is located at the southern part of the basin across multiple developed urban areas and had obvious overbank flow during hurricane harvey chen et al 2020 the simulation results are plotted and listed in fig 5 and table 5 in fig 5 with the exception of the ai nowcasts all precipitation forecasts generate a second flood peak at both cypress and spring creek which was not observed by usgs stream gauges as ai nowcast underpredicts the total precipitation amounts and rates it generates a smaller flood peak consequentially but it has a high score on nsce 0 71 and cc 0 9 compared with the usgs gauge data as shown in table 4 the ai hybrid provides an undesirable flood forecast with nsce less than 0 7 and positive pte which means the forecasted flood peak is later than the observed flood peak the ai hybrid plum line in fig 5 carries some features from the hrrr which causes a non existent second flood peak the nwp modeled qpfs produce lower nsce scores on flood prediction comparing to the deep learning methods in general however hrrr provides relatively more accurate predictions on flood peak and less flood peak time error which are significant for the emergency responses and nws field operations as the flood peak and flood time is the most important factors to mitigate the damage and protect properties overall the precipitation forecasts cannot match the performance of the benchmark as expected and hrrr qpf provides a relatively better flood magnitude prediction among four precipitation forecasts in this study the benchmark precipitation data mrms is utilized in the flash project as the forcing data for the crest ef5 model to produce the near real time streamflow flamig et al 2020 gourley et al 2017 the flash project has shown its benefit as a supporting tool during hurricane harvey according to the nws service assessment report murphy 2018 therefore with the consideration of the error propagated from the precipitation forecasts the 1 hour lead time flood prediction can be a very useful tool the ai nowcast predicts the flood timing better than others so if the first responders know the semi accurate flood time with hours of lead time it is a successful step for flood prediction only if the method could improve in the precipitation intensity forecast as shown in the hydrological analysis the current structure of using precipitation forecasts to drive crest imap has considerable value for the automated real time flood prediction operation even though no forecast data can provide a comparable flood prediction as mrms benchmark observation but the errors from the precipitation forecasts are expected and the prediction results do provide flood information with much longer lead time as mrms is a real time weather radar precipitation product it can provide very short to no lead time for flood prediction depending on the lag time of the individual flood event therefore the weather forecast based flood prediction has the advantage of lead time over the benchmark but the disadvantage on accuracy which can be potentially balanced in flood warning operations 3 3 flood extent analysis the crest imap can not only simulate the streamflow but also the 2d flood extent and flood depth we take the maximum flood depth at every pixel through all the time steps to construct the maximum flood extent map for all precipitation forecasts and benchmark forced simulations which is shown in fig 6 the binary statistical results are listed in table 6 although previous statistical and hydrological analysis shows drastic differences between the different precipitation forecasts the maximum flood extent maps are very similar and the binary statistics in table 6 are numerically close too the ai nowcast is the only one that has a lower pod 0 48 and a lower csi 0 35 which is likely due to its underestimation of precipitation amount as shown in table 1 and fig 3 based on the results in fig 6 the crest imap appeared to neutralize most of the differences between different precipitation forecasts to produce similar maximum flood maps since the maximum flood extent has positive correlation with the total precipitation amount during the flood events o hara et al 2019 there are no successful predictions for the upper cypress creek southwestern part of the map all flood predictions other than the ai nowcasts can achieve a csi of about 0 4 and pod about 0 6 which can still provide limited information and guidelines for future flooding however the over 45 false alarming could mislead preparatory action to the flood the analysis of the initial inundation water depth 5 cm time is listed in fig 7 where the color ramp represents the unified time steps which is equivalent to 30 mins for easier display due to high temporal resolution of 2d flood simulation 10 s the dark blue color represents the first day of the study period 25 08 2017 00 00 and the dark red color represents the end of the last day of the study period 29 08 2017 24 00 for example in the figure all maps show dark blue color as the center of the main streamlines which represent the river channels that have water running at the beginning of the period the bar plot on the right column of fig 7 represents the distribution of the flood time difference between the flood prediction and the benchmark flood extent where the red dashed line is the 0 difference line and the black dashed line represents the mean differences negative values indicate the predicted flood comes earlier than the benchmark and the positive value means the predicted flood comes later than the benchmark for the benchmark flood map most of the inundation occurs around 88 150 time steps which are late in the 26th to the morning of the 28th of august 2017 this result corresponds with the county average precipitation results in fig 3 where the benchmark black line shows the first peak of precipitation about 20 mm hr around 1200 utc on the 26th and two large rainfall peaks 30 mm hr on the 27th and early on the 28th of august the flow dynamic analysis also picks up the overbank flow of the rivers where the color ramp changes from the center outward from dark blue had water in channel on 25th to light green overbank flooded on 27th then to dark red over bank flooded on 29th which represents the river experiencing multiple overbank flows throughout the study period the flood prediction from the rap and hrrr qpf show much more blue earlier inundation compared to the benchmark which corresponds to the time when the rap red and hrrr blue have their largest peak precipitation rates 46 mm hr and 34 mm hr respectively on the 26th of august in fig 3 these simulated artifitial extreme precipitation rates can cause flood inundation immediately which leads to an earlier inundation than the benchmark since the hrrr has higher spatial resolution and greater peak precipitation rates than the rap presented in table 1 the initial inundation time map of the hrrr has more late red inundation along the river channels than the rap predicted inundation time which indicates that there is more overbank flood with reasonable time lags represented in the hrrr than the rap due to the spatial resolution differences low resolution rap provides uniform precipitation on river channel upper and downer portion of a reach segment as well as the basin catchment on the other hand the higher resolution hrrr could provide higher precipitation rate at catchment but lower rate at channel at the same time step as the rap but water routing from land to channel could take longer time so the higher resolution forecast hrrr showed more delayed flood than the lower resolution forecast rap a more comprehensive study will be needed to provide explicit understanding of this relationship and the aforementioned hypothetical scenario is provided to help understanding the possible causes of the flood time differences the ai nowcast predicted inundation time map shows more light blue 32 hr and green 48 hr compared to other predictions which is caused by the low precipitation intensity that led the delayed water accumulation on the surface the ai hybrid prediction shows earlier inundation than the benchmark which is very similar to the hrrr prediction overall ai hybrid and hrrr predictions have over 70 of wet pixels 74 and 72 respectively that are flooded earlier than the benchmark and rap prediction has 66 of wet pixels flooded earlier than the benchmark even with the significant underprediction of precipitation rate from ai nowcast its flood prediction has about 50 of wet pixels flooded earlier than the benchmark the predicted flood extent provides more useful information than the hydrograph predictions the flood map predicted by the hrrr and rap qpfs can provide information about the location of possible fluvial and pluvial floods however the flood prediction times are not reliable machine learning prediction methods show little to no value in the flood extent analysis due the underprediction of the precipitation intensity 3 4 flood depth analysis 50 usgs high water mark hwm sites are located in the spring basin fig 1 where the water depth values are extracted from all flood maps including the benchmark and predicted flood maps in fig 8 the scatter plot of the benchmark flood depth and predicted flood depth against the hwm data is presented as the previous study indicates the error of simulated harvey flood depth is up to 1 m wing et al 2019 it is no surprise that the benchmark black dots cannot align perfectly along the diagonal and the predicted flood depths only perform worse as shown in fig 8 almost all predicted flood depths are below the diagonal except one location that is predicted by hrrr qpf with crest imap blue dots since ai nowcast underpredicts the precipitation and associated flood there are 38 out of 50 hwm sites that are predicted to be not inundated under this scenario other above the diagonal dots are the ones that hwm data shows 0 but the flood predictions indicate positive values overall all the flood predictions underpredict the inundation depth and provide little value for flooding emergency responses the error distributions of inundation depths are plotted in fig 9 the plots show that no flood prediction error is as centered to 0 as the benchmark estimation mrms second to the benchmark the rap qpf can lead to a predicted flood depth that is slightly better than hrrr qpfs and the ai hybrid method predicted flood depths this result again demonstrates the similarity of hrrr qpf and ai hybrid forecasting where their flood depth prediction errors are almost identical it raises the speculation that using cdf matching technique to hybrid machine learning and numerical modeling might pick up too much unnecessary information from the target dataset hrrr in this study in general using rap qpf hrrr qpf ai nowcast and ai hybrid forecast can only provide limited information about the upcoming flood inundation depths for an extreme event however the flood depth estimation is a common insufficiency of many popular flood models which has been shown in previous studies chen et al 2021 wing et al 2019 therefore the error from the precipitation forecasts combines the hydraulic model error that deviate the predicted flood depth further away from the hwm measurements at the current state of improvement for hydrologic modeling and weather prediction the overarching goal of higher accuracy on flood depth predictions is yet to be reached 4 discussion the nwp based qpfs show poor predictability in precipitation spatial and temporal distribution even though their predicted total quantity is relatively accurate one possible cause could be the selection of the forecasted rain fields which we select the 1 hour lead time forecasts while rap and hrrr can forecast up to 18 h the study of seo et al 2018 suggests that the rap and hrrr qpfs perform better with 4 6 h lead time indicating that the 1 hour forecasts are not necessarily the most reliable qpf product another recent study yue and gebremichael 2020 indicated that all the hrrr forecast including 1 hr lead time has strong agreement with the observation while slightly over prediction the magnitude for a half of the hurricane event however due to the limited computational resources the requirement of hyperresolution precipitation for hydrological forecast and the heavy gpu memory requirements the ai methods will not likely forecast 3 h of lead time only limited to 1 hour lead time in this study for any machine at current time therefore certain amount of error from numerical modeling forecasts are expected and the predictability study over different lead times will be conducted in the future however the well known qpf issues still exist such as the underforecasting the convective system rainfall rap and spatial displacement errors hrrr which are likely to present in the other forecast periods the hrrr ensemble hrrre project was proven to mitigate those errors carlberg et al 2020 which will lead to a better flood forecast once the hrrre being an operational product the ai nowcast method lacks the ability to forecast the extreme precipitation event such as hurricane harvey the ai model is trained by all precipitation events in the houston area from 2015 to 2019 that are listed in noaa storm report and have caused urban flooding except hurricane harvey which means it is trained specifically for high intensity precipitation scenarios but the results indicate the method cannot reproduce the precipitation intensity of hurricane harvey and provides no useful information for local flood prediction based on the study done by google research the u net machine learning method outperforms hrrr qpf and the optical flow method using precision recall curve analysis agrawal et al 2019 this statement still holds in this case study however as a binary analysis conducted in the aforementioned study the lack of predicted precipitation intensity is not revealed in the precision recall curve analysis although the precision recall curve is a common and powerful scoring tool for machine learning this test is not sufficient for hydrological and hydrometeorological studies since the precipitation intensity is as important if not more as its spatial temporal placement therefore deep learning methods for hydrological prediction still require much effort from the scientific community to improve the technology as a preliminary attempt to combine the results of ai nowcasts and numerical model outputs the cdf matching technique is used in this study to produce the ai hybrid forecasts but failed to perform well in this case study it has been shown in the previous section that the technique creates artifacts and border effects but it also shows that the technique alters the spatial temporal distribution of the ai nowcast towards the hrrr which leads to the similarities between the hrrr and the ai hybrid in section 3 3 and 3 4 since the ai nowcast is able to capture the spatial temporal pattern of the mrms estimation improving the precipitation intensity forecast but not changing its pattern could be a future direction for deep learning nowcasting approaches given that the ai nowcast model could produce high resolution 3 km 15 mins forecast within minutes for the 10 days period for 276 by 216 cells using a single gpu unit this method still has the advantage on computational efficiency compared to hrrre experiment that has used 144 parallel nodes to power wrf arw to simulate 1580 by 1000 meshes over the full conus dowell et al 2018 with improvement on its forecast performance ai nowcasting method could potentially be a computationally efficient forecast method in the future lastly the maximum flood map analysis using crest imap neutralizes or smooths much of the differences between precipitation forecasts as the total accumulated precipitation dictates the maximum flood extent the results indicate the qpf with a higher spatial resolution would potentially improve the flood timing forecast yet a more comprehensive study is needed to examine the importance and impacts of spatial resolution to flood extent forecast since the rap and hrrr qpfs have a reasonable forecast of total precipitation amount over the region the flood extent analysis results for numerical modeling are acceptable and provide indications for flood forecasts therefore even with certain missing inundation scenarios the qpf crest imap could still potentially provide preliminary information about the final outcome of a future flood event 5 conclusion the ability of precipitation forecasts to predict flood discharges inundation extents and flood depth has been tested using numerically modeled qpfs rap and hrrr and deep learning nowcasts ai nowcast and ai hybrid with 1 hour lead time none of the precipitation forecasts can provide comparable flood information as the radar based benchmark mrms which neither the nwp models nor any nowcasting method is expected to be as accurate as weather radar observation the benchmark in this study is an ultimate and overarching goal for the weather forecasting community when the real forecasting is needed for the future and the observation is not available the numerical weather prediction model qpfs can provide general information about flood return period and inundation outcomes where the hrrr slightly outperforms the rap the ai nowcast is incapable to capture the precipitation intensity of hurricane harvey which indicates the potential inability of such method as well as the inability of common machine learning performance tests to reveal such information the ai nowcast method can forecast the spatial temporal pattern in high resolution and extent of the precipitation in a very short amount of time it will be the future objective to combine the ai nowcasts and qpfs using different methods as the cdf matching technique fails to improve the performance of the hybrid approach evaluated in this study the nwp qpfs have spatial displacement errors underlying most of the qpf total error but the ensembled weather forecasting products e g hrrr ensemble should reduce such errors by theory which should be further studied to provide improved flood severity prediction further flood predictability analysis with longer lead time is needed to study the possible best combination of qpf crest imap to provide the best possible flood forecast for local emergency response agencies credit authorship contribution statement mengye chen conceptualization methodology software visualization zhi li software shang gao writing review editing ming xue supervision jonathan j gourley writing review editing randall l kolar supervision yang hong conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to thank the support from oklahoma university hydrology and water security program 
3074,short and long range reservoir inflow forecast is essential for efficient real time operational planning scheduling of hydroelectric power system and management of water resources large scale climate phenomenon indices have a strong influence on hydrological processes under complex weather conditions and it should be considered to forecast reservoir inflow for efficient dam operation strategies this study aims to explore the relevance of large scale climate phenomenon indices in improving the reservoir inflow prediction at short term time scales this paper presents a simple and effective framework to combine various data driven machine learning ml algorithms for short range reservoir inflow forecasting random forest rf gradient boosting regressor gbr k nearest neighbors regressor knn and long short term memory lstm were employed for predicting daily reservoir inflows considering various climate phenomenon indices e g arctic oscillation north atlantic oscillation and southern oscillation index and hydroclimatic variables precipitation accounting for time lag effects after training the individual ml algorithm a framework was developed to create an ensemble model using a robust weighted voting ensemble method to quantify forecasting uncertainty and to improve the model performance by combining the inflow results of the single ml model and the highest vote is chosen based on the weights assigned to the single ml model the developed framework was examined in two distinct reservoirs located in india and california usa the ensemble model consistently outperformed the standalone rf gbr knn and lstm in predicting high flood control and monsoon seasons and low flows runoff and non monsoon seasons of both study reservoirs the demonstrated short term reservoir forecasting model allows reservoir operators to adapt and add regional hydrological and large scale climate indices in real time decision making the presented framework can be applied for any reservoir inflow forecasting keywords el niño southern oscillation enso gradient boosting long short term memory lstm machine learning reservoir inflow forecasting reservoir operation uncertainty 1 introduction reservoirs are important hydraulic structures in terms of collection storage and diversion of freshwater for purposes such as drinking irrigation hydropower flood management operations and drought relief simonovic 2020 many developing countries such as india have made efforts towards sustainable reservoir operations to account for the adverse effects of dams for regional water resources management bhadoriya et al 2020 goel et al 2020 rehana mujumdar 2014 reservoir inflows play a major role in water allocations fulfilling various water demands and balancing the flows from upstream catchments to downstream regions during floods rehana et al 2020 the operation of reservoir is complex involving multiple time scales multi flow regimes and unpredictable emergencies zhang et al 2018 forecasting reservoir inflows is a preliminary steps in reservoir operation providing guidelines and rule curves for optimal water allocations to satisfy water supply irrigation industrial hydropower and environmental conservation requirements kasiviswanathan et al 2020 in this context long and short term reservoir inflow forecasts are vital for sustainable water resources planning and management rehana et al 2020 short term seasonal and monthly operations are relevant for optimal economic benefits water supply and downstream augmentation operations zhang et al 2018 daily time scale operations also relate to controlling floods power grid loads and emergency operations noorbeh et al 2020 in this context the prediction of daily reservoir inflows is prominent for real time reservoir operation under hydroclimatic extremes such as low and high flows conventionally real time reservoir operations are associated with high variability and rapid changes often deviating from the operation rule curves developed based on physical models oliveira loucks 1997 further physically based models are subject to various uncertainties and need to account for complex natural and human influenced hydrological conditions and water demands although hydrological models are best tools for predicting inflows and providing details of precipitation evapotranspiration soil and land use characteristics of the upstream catchment area these models require a rigorous amount of landscape information at various spatiotemporal scales and several pre processing efforts awol et al 2019 alternatively data driven algorithms based on machine learning ml models have gained much interest in recent years in predicting stream flows reservoir inflows and operation and management of hydraulic structures yang et al 2017 zhang et al 2018 ml models have become highly attractive for solving non linear predictions of various hydro climatic variables under complex features in recent years artificial neural network ann decision tree dt and support vector regression svr are algorithms that are well accepted and implemented for predicting rainfall streamflow and river water temperatures ghosh 2010 rehana 2019 zhang et al 2018 there have been many advancements in implementing and comparing ann and svr models for reservoir inflow predictions e g kasiviswanathan et al 2020 kumar et al 2015 li et al 2016 noorbeh et al 2020 used bayesian networks to predict the zayandehrud reservoir inflows in iran and concluded that bayesian networks could simulate systems that use insufficient probabilistic information li et al 2016 used deep neural network dnn to predict two daily inflow series of the three gorges and the gezhouba reservoirs china they concluded that dnn models overwhelm the feed forward neural networks in recent years wavelet analysis has become a popular approach for studying extremely irregular complex spatial and temporal variability and intermittent time series that are frequently encountered in hydrology agarwal et al 2016 niu 2013 niu et al 2014 kumar et al 2015 used wavelet based ann wann to forecast daily reservoir inflows of panchut dam in india using daily rainfall as an input variable and concluded that wavelet analyses bootstrap resampling and neural networks models are beneficial for operational inflow forecasting kasiviswanathan et al 2020 forecasted weekly reservoir inflows of adavinainar kovil reservoir in india and suggested that the information on the uncertainty quantification helps in effective decision making yang et al 2017 predicted monthly inflows for clair engle lake cle reservoir trinity lake in california usa and danjiangkou reservoir china by comparing ann svr and random forest rf models and concluded that the rf outperform the other models babaei et al 2019 compared ann and svr models in predicting monthly inflows of zayandehroud reservoir in iran and demonstrated that the svr model outperforms the ann model in addition to ann and svr a few attempts were made using classification and regression tree and dt in the prediction of reservoir inflows yang et al 2016 as a summary of past ml algorithms use the ann and svr have been proven to be robust tools for reservoir inflow predictions a few ml algorithms such as recurrent neural network rnn and rf have also recently gained attention in reservoir inflow predictions implementing long short term memory lstm rf and gradient boosting regression gbr k nearest neighbors knn and regression based ml algorithms for the reservoir inflow prediction the state of the art ml models corresponding investigation on various parameterization and comparison have been rarely reported due to the availability of real time hydroclimatic data the use of ml tools is promising for short term reservoir operation and management this study explores the relevance of large scale climate phenomenon indices in improving the reservoir inflow prediction at short term time scales the novelty of this paper is to present a simple and effective framework to combine data driven ml algorithms rf gbr knn and lstm using the weighted voting ensemble method wvem for short range reservoir inflow forecasting large scale coupled circulation phenomena from the pacific ocean such as el niño southern oscillation enso indian ocean dipole iod etc can dominate the local hydrology thus considering potential information in regional water resources management and forecasting is valuable several studies accounted for such hydroclimatic teleconnections in streamflow and precipitation predictions e g chandimala and zubair 2007 kalra et al 2013 maity and kumar 2008 only a few efforts were made to consider climate indices in the reservoir inflow prediction based on ml algorithms at a monthly time scale or shorter adarsh janga reddy 2019 lee et al 2020 yang et al 2017 for example adarsh and janga reddy 2019 related two climate indices of enso and equatorial indian ocean oscillation with monthly inflows of hirakud reservoir in india using multivariate empirical mode decomposition and stepwise linear regression however predicting short term real time reservoir inflows using various hydrological variables precipitation and inflows and large scale climate indices e g ao nao and soi at a daily time scale has been rarely reported therefore the present study emphasizes accounting for the hydrological and large scale coupled ocean atmospheric climatic information in the daily reservoir inflow forecasting however the relationship between these large scale climate indices and reservoir operation hydrological variables e g reservoir inflows are complex and linear regression models fail to account for the nonlinearity robust ml tools can be promising in capturing complex non linear relationships between the hydrological variables and climate indices at present predicting reservoir inflows at monthly time scales performing analysis and comparing different ml models based on hydrologic variables are common to study the robustness and to compare experiments with various parameterization of ml algorithms using hydrological and climate indices information we selected two headwater reservoirs in california usa and bhadra reservoir india to predict daily reservoir inflows in summary the study aims to 1 explore the relevance of large scale climate phenomenon indices in improving the short range reservoir inflow forecasting 2 develop a framework that combines various data driven ml models using the wvem method to quantify forecasting uncertainty of reservoir inflows originating from each ml based model 3 demonstrate the application of these models on two headwater reservoirs and 4 compare the forecasted short range reservoir inflows by the four ml models with the framework developed in this study our modeling framework is applicable universally for short term real time reservoir operation and management at a daily time scale 2 study area and data setting 2 1 reservoir data in this study we selected two headwater reservoirs in california usa and bhadra reservoir india to predict daily reservoir inflows both of which have substantial water supply implications in their regions in the usa the cle reservoir was considered which is a major source of water supply in california the cle reservoir plays a vital role in diverting water from north california to central and southern parts of this water scarce state yang et al 2017 cle reservoir is an artificial lake on trinity lake in trinity county in california fig 4 the source of inflow to this reservoir is the trinity river the total volume of the reservoir is 3 billion m3 we collected daily inflow evaporation and daily precipitation data of the reservoir for the period of november 1962 to august 2020 from the california department of water resources https cdec4gov water ca gov dynamicapp wssensordata in india we selected the bhadra reservoir along bhadra river and tributary of tunga bhadra river a major tributary of the krishna river one of the main rivers of peninsular india fig 4 the bhadra reservoir located on the bhadra river is a multipurpose reservoir providing irrigation hydropower and low flow augmentation requirement rehana mujumdar 2014 the total capacity of the reservoir is 2 0 km3 the daily inflow and evaporation data of the bhadra reservoir for june 2004 to may 2018 were considered for our analyses precipitation data from six rain gauge stations attigundi balehonnur basarikatte kalasapur mallanduru and narasimharajapura were collected on a request basis from june 2004 to may 2018 from the advanced centre for integrated water resources management aciwrm india the evaporation data we got from sources are in cfs cubic feet per second for cle and mcft million cubic feet for bhadra reservoir as part of the data processing we have transformed the evaporation data into m3 sec for both reservoirs 2 2 climate phenomenon indices the 10 climate indices considered in the study were arctic oscillation ao east pacific north pacific oscillation epo north atlantic oscillation nao nino1 2 extreme eastern tropical pacific sst nino3 eastern tropical pacific sst nino4 central tropical pacific sst nino34 east central tropical pacific sst pna pacific north american index soi southern oscillation index wp western pacific index ao epo nao wp pna https psl noaa gov data timeseries daily nino1 2 nino3 nino4 nino34 https climexp knmi nl selectdailyindex cgi id someone somewhere and soi https www longpaddock qld gov au soi soi data files along with these climate indices seasonality is considered indicating the year s month as one of ml models features based on the timeframe of the climate phenomenon indices and hydrological data available for the study reservoirs a common time frame was considered to evaluate the performance of the proposed modeling framework the timeframe for cle reservoir analysis was considered from may 1991 to december 2006 and from june 2004 to december 2006 for bhadra reservoir 2 3 data preprocessing various climate indices and hydrological variables have gone through data preprocessing involving data gap handling using linear interpolation time lag of input variables using auto and partial autocorrelation coefficients in this study a decision variable sensitivity study is conducted using the gini diversity index for feature extraction which was inspired by recent studies by yang et al 2016 2017 in which many decision variables of operating reservoirs were automatically ranked and selected as features the reservoir inflows are resultant of hydrological and climatological processes with a strong influence of previous periods on the current period under seasonality and water balance continuities yang et al 2016 hydroclimatic series tend to depend on earlier data which introduces time lag effects we estimated the autocorrelation and partial autocorrelation coefficients for climate and hydrological variables to account for the time lag impact on the reservoir inflow prediction the lag values were decided based on the autocorrelation and partial autocorrelation of climate phenomenon indices evaporation and precipitation for the study reservoirs for the present study 179 and 7 day time lag of various hydroclimatic variables were considered for the cle reservoir and bhadra reservoir respectively fig 5 after preparing the dataset with lag values of inflow evaporation precipitation and climate phenomenon indices for the cle reservoir the dataset includes 1 179 days lag values of inflow 2 current and 179 days lag values of evaporation 3 current and 179 days lag values of precipitation and 4 current and 179 days lag values of the 10 climate phenomenon indices and seasonality for bhadra reservoir the dataset includes 1 7 day lag values of inflow 2 current and 7 days lag values of evaporation 3 current value and 7 days lag values of precipitation and 4 current value and 7 days lag values of the 10 climate phenomenon indices and seasonality in predicting reservoir inflows via ml models the total input variables for the cle and bhadra reservoirs were 2519 and 111 respectively such a high dimensionality in the dataset tends to yield model overfitting and not all the input variables are essential rf classifier was used to select only the essential features that have more influence on the output rf tree based strategies are naturally ranked by how well they increase node purity this is the average reduction in impurity for all trees called gini impurity nodes with the highest decrease in impurity are found at the beginning of the trees while the nodes with the smallest decrease in impurity are found at the edge we can construct a subset of the essential features by pruning trees below a certain node for cle and bhadra reservoirs the threshold for the feature importance was set to 0 01 if the feature importance was equal to or greater than 0 01 those features were selected the important features of cle and bhadra reservoir can be observed in fig 5a and 5b 3 model development the proposed framework is an ml based reservoir inflow model using climate phenomenon indices and hydrological variables fig 1 in the proposed model data preprocessing methods feature extraction using the gini index scaling of data autocorrelation and partial autocorrelation models and four ml models rf gbr knn and lstm are combined with sufficient tests of performance measures of models and developed an ensemble model by combining four ml models using wvem to study the performance of the ml models in the prediction of high and low flows during monsoon june september and non monsoon october may periods for the bhadra reservoir we compared the performance statistics of each ml model with the best hyperparameters fig 10 for the cle reservoir the performance statistics of each ml model with the best hyperparameters were compared for two seasons flood control october to march and runoff or water supply april to september fig 11 3 1 random forest regressor rf collects many dts and a supervised ml model a dt is easy to build interpret and use but it suffers from the high variance if the dt grows very deep it is more specific to an output for a specific input set small changes in the input sets may lead to changes in the resulting output the dt performs well with data used to create them but it finds it difficult to classify new samples however the rf approach handles bias and variance in the decision making as rf is made of low bias and high trees which combine to generate a low bias low variance forest since the data is distributed across various trees and each tree sees a different collection of data rfs do not generally overfit underfitting is often avoided since they are constructed of low bias trees many dts are combined to build an rf for accuracy improvement to create rfs a bootstrapped dataset needs to be created which involves selecting samples randomly from the original dataset with replacement now at each step the bootstrapped dataset from the subset of input variables builds a dt such steps will be repeated by creating bootstrapped datasets and creating another dt using the original dataset in this way many dts are built under one rf at each step using only the subset of variables the bootstrapped sample results in a wide range and variety of trees which improves the effectiveness of the rf while making a decision on rf for classification the most voted output from all dts is considered as the desired output for regression all the results from the dts have been aggregated to output the regression value typically one third of the original dataset is not included in the bootstrapped dataset this dataset is called the out of bag which is used as a validation set of the rf model to check if it correctly classifies the dataset the incorrectly classified out of bag samples are called out of bag errors ultimately the rf tree is built and then estimates the accuracy of the rf if the accuracy is not satisfactory the above mentioned steps are repeated until the model performance is satisfactory fig 2 3 2 gradient boosting regressor a gbr takes small steps towards the direction that yields better predictions i e a lower variance friedman 2001 a gradient boosting starts by building a single leaf that represents the initial guess for the weights in contrast to adaptive boosting which starts by building a very short tree building called stump freund schapire 1997 at the early stage the predicted continuous value will be the average value the gradient boosting then builds the tree based on the previous tree error which is usually larger than a stump this limits the size of the tree and scales the tree but the scale is equal for all the trees gradient boosting stops building the trees if the number of trees is reached which is determined by the user or the additional trees do not improve the fit gradient boosting through learning rate scales the contribution from a new tree the error is calculated using pseudo residual the difference between observed and predicted weights when gradient boosting is used for the regression we start with a leaf an average value of the variable that needs to be predicted the gbr includes minimization of the loss function which makes the prediction and the additive model this model uses a forward stage wise approach to build the additive model this model optimizes the arbitrary differentiable loss function the regression fits on the negative gradient of the loss function for every stage regression trees choose the best split node based on the purity score like gini impurity or minimize the loss breiman 2017 the short dt in the gbr has a single split the weak learners in the additive model are not changed after calculating the loss a new tree is added to the gradient descent procedure to reduce the loss the new tree is parameterized and moves in the correct direction by lowering the residual loss parameters f model xi input set yi output set of f xi l loss function hm base learner function at stage m γm step length rim pseudo residual n the number of samples γ pseudo regularization parameter inputs inputs to the gbr are the number of iterations m a differentiable loss function l y f x and training dataset for xi yi for i 1 to n to the model algorithm an output variable y and a vector of input variables x in this supervised learning problem is compared to each other using a probabilistic distribution the aim is to find a function that better approximates the output based on the input variable 1 it accomplishes this by beginning with a model consisting of a constant function f0 x 1 f 0 x a r g m i n y i 1 n l y i γ 2 a loop model then repeats the following steps for m 1 to m a models compute the pseudo residuals r im using the following formula 2 r im δ l y i f x i δ f x i f o r i 1 n f x f m 1 x b fit a base learner or weak learner hm x is pseudo residuals and is trained using the training set xi rim for i 1 to n c compute the multiplier γm by solving the following one dimensional problem 3 γ m a r g m i n y i 1 n l y i f m 1 x i γ h m x i d after computing the multiplier the model is updated as follows 4 f m x f m 1 x γ m h m x 3 the final model output is f m x 3 3 k nearest neighbors regressor knn considers all the sample points and in the case of classification it takes the majority vote from the neighbors and produces the output but in the case of regression it takes the average of nearest samples values and produces the output modaresi et al 2018 in the knn algorithm it is possible to select the number of neighbors to consider before producing the output khazaee poul et al 2019 the knn considered the closest n nearest data points by calculating the distance using the euclidean distance method and taking the mean of the target value of closest n points and making the result value of the current data point the euclidean distance on a feature space with multidimensional attributes as follows 5 e u c l i d e a n d i s t a n c e i 1 k x i y i 2 3 4 long short term memory lstm is a recurrent neural network rnn that was originally introduced by hochreiter and schmidhuber 1997 lstm is designed to remove the struggle of remembering long term dependency lstm has a chain like structure and every module has four neural networks connecting in a special way fig 3 the sigmoid layer in lstm called forget gate layer fig 3a decides on keeping or discarding the information parameters ht output at state t xt input at state t ct cell state ft forget gate state it input gate state čt cell state gate ot output gate wf i c corresponding weight matrix bf i c corresponding bias forget gate layer observes the ht 1 and xt and outputs one value in the range of 0 and 1 both included for each number in the cell state ct 1 where ht 1 is produced from t 1 state and xt is input to t state of lstm if the value is 0 then discard the information and if the value is 1 keep the formation 6 f t δ w f h t 1 x t b f next the tanh layer and sigmoid layer called input gate layer fig 3 b are combined together which create a newly updated vector of candidate values čt and a new cell state ct is achieved 7 i t δ w i h t 1 x t b f 8 c ˇ t t a n h w c h t 1 x t b c now it is decided how much the new candidate value should be scaled to update each state to get the updated value fig 3c the following equation is followed 9 c t f t c t 1 i t c ˇ t to output the desired value and decide which part of the cell state is to output the cell state is run through the tanh and multiplied by the sigmoid gate fig 3 d 10 o t δ w o h t 1 x t b f 11 h t o t t a n h c t 3 5 weighted voting ensemble method the wvem is the most widely used method for combining model outputs for better prediction winkler makridakis 1983 the first step is calculating the error metrics e g root mean squared error rmse mean absolute error mae etc of each ml model then converting the metrics into rankings in this study the rmse is used to rank each ensemble member as it is a standard way to measure theerrorof a model let us consider an inflow prediction of n models for time step t the combined flow estimates f c of n models are given by the equation 12 f c i 1 n f i t r i i 1 n r i where f i t is the prediction from ml model i for time step t r i is the rank of the ith model and f c is the combined flow estimate of n models ranking indicates each ensemble s number of votes in the weighted average for example the worst performing model has one vote the second worst two votes and the best model 4 votes in the case of four ensemble members 3 6 parameterization and settings the ml models rf knn gbr and lstm were applied on both cle reservoirs and bhadra reservoirs with different parameters to develop the best performance in the model training phase table 1 for the lstm parameter setting three layered lstm were developed for the cle reservoir with the first input layer with 1024 neurons a second hidden layer with 1024 neurons and a third output layer as a single neuron for the bhadra reservoir three layered lstm included the first input layer with 512 neurons a second hidden layer with 1024 neurons and the third output layer with a single neuron every layer has relu activation so that an undesired result is not produced the adam optimizer and mean squared error loss function were considered to prevent an overfit k fold cross validation was used where the entire dataset is divided into k sets for the cle reservoir 15 folds and for bhadra 3 folds were used for the cross validation where each fold has almost one year of data samples the model evaluation metrics are given in the appendix 4 results 4 1 cle reservoir inflow prediction fig 6 shows the bar plots of inflows precipitation and evaporation for the cle reservoir during the period of may 1991 to december 2006 with annual average daily inflow and a standard deviation of 68 7 and 83 0 m3 s respectively the cle reservoir runoff and flood control seasons are from april to september and october to march with variabilities in the reservoir releases and inflow volumes yang et al 2016 the ml models were trained to find the best hyper parameters for each model table 1 provides statistical performance measures of the ml models with the best parameter settings for the cle reservoir fig 7 illustrates the scatter plot of observed and predicted inflows using gbr rf knn and lstm models for the cle reservoir 4 2 bhadra reservoir inflow prediction fig 8 shows the bar plots of inflows precipitation and evaporation of the bhadra reservoir for june 2004 to december 2006 with an annual average daily inflow of 100 2 m3 s standard deviation of 182 0 m3 s in the bhadra reservoir area the runoff seasons are from june to september as monsoon and october to may to the following year as non monsoon seasons for bhadra reservoir inflow predictions various hyper parameter setting experiments were carried out for all the ml models table 1 fig 9 illustrates the scatter plot of observed and predicted inflows using gbr rf knn and lstm models for the bhadra reservoir 4 3 ml model performance the next step in the prediction of inflow is to use the appropriate ml which can work satisfactorily in terms of performance measures fig 1 the results of the four ml models for the prediction of inflow were evaluated using several goodnesses of fit statistics table 1 and visual comparisons figs 10 and 11 our results showed an acceptable trade off between training and validation performance confirming the stable generalization capacity of ml approaches the developed models were able to predict inflows successfully at a daily time scale for both reservoirs the models performance with the best parameter set for the cle and bhadra reservoirs are provided in table 1 and figs 7 and 9 our results showed that the seasonal variations of predicted inflow are almost synchronous and comparable with the observed values figs 7 and 9 lstm had the best performance among the four ml models for both the cle and bhadra reservoirs figs 7 and 9 while knn had the least desirable performance for both reservoirs during the monsoon season of bhadra reservoir the best performance belonged to lstm while rf showed a poor performance fig 10a a similar finding was found for the non monsoon season but the model performances was generally more satisfactory compared to monsoon season fig 10b the better performance of the ml models during non monsoon seasons for the bhadra reservoir is critical in the low flow augmentation of the reservoir operation the best model for predicting daily inflows in the cle reservoir was the same as bhadra lstm during both flood control and runoff seasons fig 11 for both these seasons knn was the least effective model fig 11 this suggested that among the four ml models the best model was not sensitive to the study reservoir based on rmse according to figs 10 and 11 only lstm provides satisfactory performance and provides different season performances 4 4 ensemble model performance and uncertainty estimation the results of the ensemble model prediction performance are in table 1 the ensemble model metrics were then evaluated and compared to the performance of each standalone ml model our results showed that the ensemble model performed better than standalone rf gbr and knn and lstm models in inflow forecasting for the bhadra reservoir in the case of the cle the results showed that the ensemble model outperformed all the standalone models except for lstm fig 12 a and b depict the uncertainties showing the maximum and minimum monthly average inflows among the four ml models along with ensemble model inflows based on these ml models and current inflow for both study reservoirs the spread of the maximum and minimum monthly average inflow values among the four ml models implies the predictive uncertainty the spread in the predicted inflow hydrograph varies from one event to another fig 12 a and b also depict the low and high flow events in 2005 as subplots for the cle and bhadra reservoirs 5 discussion the present study used various state of the art ml models of rf regressor gbr knn regressor lstm techniques to model the complex non linear relationship of various large scale climate indices and hydrological variables for short term daily inflows forecasting of a reservoir including time lag effects of various hydro climatic indices for the two study reservoir systems with distinct climatological and hydrological conditions for both cle and bhadra reservoirs the lstm model performed much better than the other models with the aid of hydrological variables and climate phenomenon indices along with time lagged information lstm model has strong extracting capabilities considering the number of input nodes hidden nodes and layers our reservoir inflow prediction algorithm using rf knn gbr and lstm models rmse 13 62 to 93 31 m3 s was in good agreement compared with earlier models of rnn by nagesh kumar et al 2004 rmse 160 180 rf by yang et al 2017 rmse 34 38 and support vector regression by mehrparvar and asghari 2018 rmse 57 83 all at monthly timescales for different reservoirs our rf based daily inflow predictions for the cle reservoir with an rmse range of 43 50 to 43 71 m3 s is comparable to yang et al 2017 for the cle reservoir with an rmse range of 34 to 38 m3 s with monthly time scale predictions in the study of yang et al 2017 the time lagged information was for the short duration of about two months in the cle reservoir monthly inflows predictions the present study made efforts to overcome such a limitation of the inclusion of a shorter period of time lagging information of hydrological and climate phenomenon indices by the inclusion of 179 days using autocorrelation and partial autocorrelation models at a daily time scale for the cle reservoir the superiority of lstm rnn in the prediction of daily inflows as revealed in the present study was in agreement with the study of nagesh kumar et al 2004 for monthly time scales using rnn for indian river systems our predictions on the bhadra reservoir inflows rmse range 58 37 to 93 91 m3 s is also comparable with the monthly predictions by rehana and mujumdar 2014 using canonical correlation analysis as a multiple regression algorithm overall in figs 10 and 11 the lstm model was shown to be the best model for improved predictions compared to the other models in predicting high flood control and monsoon seasons and low runoff and non monsoon seasons reservoir inflows of both cle and bhadra reservoirs from table 1 the overall performance of lstm model rmse 13 62 m3 sec r2 0 94 kge 0 93 is improved when compared to other ml models rmse 42 55 49 81 m3 sec r2 0 67 0 77 kge 0 59 0 74 for cle reservoir from table 1 the overall performance of lstm model rmse 58 37 m3 sec r2 0 89 kge 0 86 is improved when compared to other ml models rmse 65 18 68 51 m3 sec r2 0 85 0 86 kge 0 77 0 89 for bhadra reservoir to check the performance of two reservoirs with the same climatological phenomenon indices and different climatological conditions we have considered the common time period from june 2004 to december 2006 for bhadra reservoir which resulted in moderate performances compared to cle we showed that an ensemble prediction is needed to integrate the strengths of different ml models this also permits the estimation of forecasting uncertainty in this study the ensemble model which was developed using four ml models using wvem performed better than individual ml models in most cases in the case of cle reservoir the lstm model performed better than the ensemble model though the wvem used in the ensemble model reduced the uncertainty of various ml models by leveraging the strengths of each ml model overall predictive uncertainty was significantly less for both cle and bhadra reservoirs as the four ml models rf gbr knn and lstm used in this study have an excellent ability to handle uncertainty in this study all four ml models were developed with the best set of hyperparameters in the training phase which could be another reason for significantly less uncertainty overall the data driven framework presented in the study indicated that ml models were proven to be effective in reservoir inflow prediction with the aid of hydrological variables and climate phenomenon indices along with the time lagged information the current study outcomes significant inferences for research on reservoir inflow predictions especially from the viewpoint of climate phenomenon indices as demonstrated in the present study short term reservoir daily inflow forecasting using ml models can be promising in reservoir management and operations under hydroclimatic extremes floods and droughts and in addressing the possible vulnerabilities and risks to the population in real time nanditha mishra 2021 improved forecasts of the hydroclimatic phenomenon which serve as inputs to the demonstrated reservoir inflow forecasting models can aid the water resources management authorities under severe pressure due to targets of sustainable water supply environmental stability and fulfilling the rising water demands with limited water availabilities the traditional reservoir inflow prediction models rely solely on rainfall and historical inflows and may not be enough under intensified hydroclimatic extreme scenarios fischer knutti 2015 once the real time reservoir inflows at short term forecasts are available optimal releases to meet the downstream reservoir water user demands and possible releases during floods can be defined a holistic approach for real time reservoir operation models integrating hydrological and large scale climate phenomena along with operating rule curves can be a potential area of research for developing decision support systems for downstream water utilities rehana et al 2020 given the advantages of the proposed modeling framework caveats are still there which need attention for future research the reservoir inflows are burdened with uncertainty due to randomness which was not accounted for in our predictions the present study assumed that precipitation and evaporation are the only predictor variables that directly affect reservoir inflows however there are several variables that directly affect inflow predictions such as soil land use characteristics of the upstream catchment area landscape information at various spatiotemporal scales awol et al 2019 which are not considered in the present study furthermore the present study did not account for the unprecedented hydrologic extremes that may occur under climate change signals in the reservoir inflow predictions kusunoki et al 2020 the study stresses the improvement of ml models to account for various uncertainties and unprecedented hydroclimatic extremes in reservoir inflow prediction models which can be a potential area of research furthermore advanced ensemble algorithms and bayesian optimization approaches to optimize the hyperparameters of the models can be possible future work for better predictions the prediction of reservoir inflow should be able to handle multi scale effects by linking the local hydrological variables and climate indices however teleconnections among different hydrological and other phenomena are so complex that it may not hold the relationship at all scales and therefore training the model at each time scale forms potential area of research 6 conclusions the purpose of this study was to assess the performance of state of the art ml techniques rf gbr knn and lstm in forecasting the short term daily inflows of bhadra reservoir in india and cle reservoir in california usa using historical hydrological data and large scale climate phenomenon indices along with time lagged information we compared various ml methods as robust models to extract complex non linear relationships among various hydroclimatic variables in forecasting the daily reservoir inflows considering hyper parameter structural settings we also developed an ensemble model by combining four ml models using the wvem to calculate forecasting uncertainty and improve model performance the presented modeling framework can be applied to other reservoirs due to its versatility the notable conclusions were 1 ml techniques are robust and helpful in simulating the reservoir inflow considering the influences of evaporation precipitation and large scale climate phenomenon indices the climate phenomenon indices that influence the inflow were ao epo nao nino1 2 nino3 nino4 nino34 pna and soi wp seasonality and the time lagged information 2 the lstm was capable of providing good performance and was recommended for reservoir inflow short term forecasting due to its robust prediction capability over rf gbr and knn in capturing the peak inflows knn generally showed the lowest performance for both reservoir cases with the increase in iterations the statistical performance of the lstm model improved for both study reservoirs 3 lstm model was shown to be a better model for predictions compared to other examined models in predicting high flood control and monsoon seasons and low runoff and non monsoon seasons reservoir inflows of both study reservoirs 4 the ensemble model performed better than the standalone models for most of the cases prediction uncertainty was significantly less for both reservoirs as all four ml models that we used in this study have an excellent ability to handle uncertainty in the training phase all four ml models are developed with the best set of hyperparameters overall the demonstrated short term reservoir forecasting model allows reservoir operators to monitor adapt and add various hydrological and climate phenomenon indices per regional hydrology and decision making operators credit authorship contribution statement rajesh maddu data curation investigation indranil pradhan software data curation visualization ebrahim ahmadisharaf writing review editing supervision shailesh kumar singh writing review editing supervision rehana shaik conceptualization methodology writing original draft supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented in this study was funded by the ministry of science technology department of science technology tmd energy water others water technology initiative project no dst tmd ewo wti 2k19 ewfh 2019 306 the cle reservoir data for this paper is available at the california data exchange center http cdec water ca gov index html and various climate indices data from noaa earth system research laboratory http www esrl noaa gov psd data climateindices list the authors sincerely thank dr p somasekhar rao technical director at the advanced centre for integrated water resources management aciwrm bengaluru karnataka india for providing bhadra reservoir data appendix model evaluation metrics the metrics used to measure each ml model s performance are root mean squared error rmse mean absolute error mae absolute percentage bias apb the coefficient of determination r2 correlation coefficient corr nash sutcliffe efficiency nse and kling gupta efficiency kge rmse i 1 n y i y i 2 n m a e i 1 n y i y i n apb i 1 n y i y i i 1 n y i 100 r 2 1 rss tss corr x i x u 2 y i y u 2 x i x u 2 y i y u 2 nse 1 i 1 n y i y i 2 i 1 n y i y u 2 kge 1 1 r 2 γ 1 2 β 1 2 β μ s μ 0 γ σ s μ s σ 0 μ 0 where n number of non missing data points yi observation time series ŷi prediction time series rss sum of squares of residuals tss total sum of squares xi values of variable in the sample xu mean of the values of variable yi values of the y variable in the sample and yu mean of the values of y variable r is the correlation coefficient between simulated and observed time series β is the bias ratio the ratio between simulated mean and observed mean γ is the variability ratio the ratio between simulated variance and observed variance μ is the mean σ is the standard deviation and n is the number of data pairs in comparison 
3074,short and long range reservoir inflow forecast is essential for efficient real time operational planning scheduling of hydroelectric power system and management of water resources large scale climate phenomenon indices have a strong influence on hydrological processes under complex weather conditions and it should be considered to forecast reservoir inflow for efficient dam operation strategies this study aims to explore the relevance of large scale climate phenomenon indices in improving the reservoir inflow prediction at short term time scales this paper presents a simple and effective framework to combine various data driven machine learning ml algorithms for short range reservoir inflow forecasting random forest rf gradient boosting regressor gbr k nearest neighbors regressor knn and long short term memory lstm were employed for predicting daily reservoir inflows considering various climate phenomenon indices e g arctic oscillation north atlantic oscillation and southern oscillation index and hydroclimatic variables precipitation accounting for time lag effects after training the individual ml algorithm a framework was developed to create an ensemble model using a robust weighted voting ensemble method to quantify forecasting uncertainty and to improve the model performance by combining the inflow results of the single ml model and the highest vote is chosen based on the weights assigned to the single ml model the developed framework was examined in two distinct reservoirs located in india and california usa the ensemble model consistently outperformed the standalone rf gbr knn and lstm in predicting high flood control and monsoon seasons and low flows runoff and non monsoon seasons of both study reservoirs the demonstrated short term reservoir forecasting model allows reservoir operators to adapt and add regional hydrological and large scale climate indices in real time decision making the presented framework can be applied for any reservoir inflow forecasting keywords el niño southern oscillation enso gradient boosting long short term memory lstm machine learning reservoir inflow forecasting reservoir operation uncertainty 1 introduction reservoirs are important hydraulic structures in terms of collection storage and diversion of freshwater for purposes such as drinking irrigation hydropower flood management operations and drought relief simonovic 2020 many developing countries such as india have made efforts towards sustainable reservoir operations to account for the adverse effects of dams for regional water resources management bhadoriya et al 2020 goel et al 2020 rehana mujumdar 2014 reservoir inflows play a major role in water allocations fulfilling various water demands and balancing the flows from upstream catchments to downstream regions during floods rehana et al 2020 the operation of reservoir is complex involving multiple time scales multi flow regimes and unpredictable emergencies zhang et al 2018 forecasting reservoir inflows is a preliminary steps in reservoir operation providing guidelines and rule curves for optimal water allocations to satisfy water supply irrigation industrial hydropower and environmental conservation requirements kasiviswanathan et al 2020 in this context long and short term reservoir inflow forecasts are vital for sustainable water resources planning and management rehana et al 2020 short term seasonal and monthly operations are relevant for optimal economic benefits water supply and downstream augmentation operations zhang et al 2018 daily time scale operations also relate to controlling floods power grid loads and emergency operations noorbeh et al 2020 in this context the prediction of daily reservoir inflows is prominent for real time reservoir operation under hydroclimatic extremes such as low and high flows conventionally real time reservoir operations are associated with high variability and rapid changes often deviating from the operation rule curves developed based on physical models oliveira loucks 1997 further physically based models are subject to various uncertainties and need to account for complex natural and human influenced hydrological conditions and water demands although hydrological models are best tools for predicting inflows and providing details of precipitation evapotranspiration soil and land use characteristics of the upstream catchment area these models require a rigorous amount of landscape information at various spatiotemporal scales and several pre processing efforts awol et al 2019 alternatively data driven algorithms based on machine learning ml models have gained much interest in recent years in predicting stream flows reservoir inflows and operation and management of hydraulic structures yang et al 2017 zhang et al 2018 ml models have become highly attractive for solving non linear predictions of various hydro climatic variables under complex features in recent years artificial neural network ann decision tree dt and support vector regression svr are algorithms that are well accepted and implemented for predicting rainfall streamflow and river water temperatures ghosh 2010 rehana 2019 zhang et al 2018 there have been many advancements in implementing and comparing ann and svr models for reservoir inflow predictions e g kasiviswanathan et al 2020 kumar et al 2015 li et al 2016 noorbeh et al 2020 used bayesian networks to predict the zayandehrud reservoir inflows in iran and concluded that bayesian networks could simulate systems that use insufficient probabilistic information li et al 2016 used deep neural network dnn to predict two daily inflow series of the three gorges and the gezhouba reservoirs china they concluded that dnn models overwhelm the feed forward neural networks in recent years wavelet analysis has become a popular approach for studying extremely irregular complex spatial and temporal variability and intermittent time series that are frequently encountered in hydrology agarwal et al 2016 niu 2013 niu et al 2014 kumar et al 2015 used wavelet based ann wann to forecast daily reservoir inflows of panchut dam in india using daily rainfall as an input variable and concluded that wavelet analyses bootstrap resampling and neural networks models are beneficial for operational inflow forecasting kasiviswanathan et al 2020 forecasted weekly reservoir inflows of adavinainar kovil reservoir in india and suggested that the information on the uncertainty quantification helps in effective decision making yang et al 2017 predicted monthly inflows for clair engle lake cle reservoir trinity lake in california usa and danjiangkou reservoir china by comparing ann svr and random forest rf models and concluded that the rf outperform the other models babaei et al 2019 compared ann and svr models in predicting monthly inflows of zayandehroud reservoir in iran and demonstrated that the svr model outperforms the ann model in addition to ann and svr a few attempts were made using classification and regression tree and dt in the prediction of reservoir inflows yang et al 2016 as a summary of past ml algorithms use the ann and svr have been proven to be robust tools for reservoir inflow predictions a few ml algorithms such as recurrent neural network rnn and rf have also recently gained attention in reservoir inflow predictions implementing long short term memory lstm rf and gradient boosting regression gbr k nearest neighbors knn and regression based ml algorithms for the reservoir inflow prediction the state of the art ml models corresponding investigation on various parameterization and comparison have been rarely reported due to the availability of real time hydroclimatic data the use of ml tools is promising for short term reservoir operation and management this study explores the relevance of large scale climate phenomenon indices in improving the reservoir inflow prediction at short term time scales the novelty of this paper is to present a simple and effective framework to combine data driven ml algorithms rf gbr knn and lstm using the weighted voting ensemble method wvem for short range reservoir inflow forecasting large scale coupled circulation phenomena from the pacific ocean such as el niño southern oscillation enso indian ocean dipole iod etc can dominate the local hydrology thus considering potential information in regional water resources management and forecasting is valuable several studies accounted for such hydroclimatic teleconnections in streamflow and precipitation predictions e g chandimala and zubair 2007 kalra et al 2013 maity and kumar 2008 only a few efforts were made to consider climate indices in the reservoir inflow prediction based on ml algorithms at a monthly time scale or shorter adarsh janga reddy 2019 lee et al 2020 yang et al 2017 for example adarsh and janga reddy 2019 related two climate indices of enso and equatorial indian ocean oscillation with monthly inflows of hirakud reservoir in india using multivariate empirical mode decomposition and stepwise linear regression however predicting short term real time reservoir inflows using various hydrological variables precipitation and inflows and large scale climate indices e g ao nao and soi at a daily time scale has been rarely reported therefore the present study emphasizes accounting for the hydrological and large scale coupled ocean atmospheric climatic information in the daily reservoir inflow forecasting however the relationship between these large scale climate indices and reservoir operation hydrological variables e g reservoir inflows are complex and linear regression models fail to account for the nonlinearity robust ml tools can be promising in capturing complex non linear relationships between the hydrological variables and climate indices at present predicting reservoir inflows at monthly time scales performing analysis and comparing different ml models based on hydrologic variables are common to study the robustness and to compare experiments with various parameterization of ml algorithms using hydrological and climate indices information we selected two headwater reservoirs in california usa and bhadra reservoir india to predict daily reservoir inflows in summary the study aims to 1 explore the relevance of large scale climate phenomenon indices in improving the short range reservoir inflow forecasting 2 develop a framework that combines various data driven ml models using the wvem method to quantify forecasting uncertainty of reservoir inflows originating from each ml based model 3 demonstrate the application of these models on two headwater reservoirs and 4 compare the forecasted short range reservoir inflows by the four ml models with the framework developed in this study our modeling framework is applicable universally for short term real time reservoir operation and management at a daily time scale 2 study area and data setting 2 1 reservoir data in this study we selected two headwater reservoirs in california usa and bhadra reservoir india to predict daily reservoir inflows both of which have substantial water supply implications in their regions in the usa the cle reservoir was considered which is a major source of water supply in california the cle reservoir plays a vital role in diverting water from north california to central and southern parts of this water scarce state yang et al 2017 cle reservoir is an artificial lake on trinity lake in trinity county in california fig 4 the source of inflow to this reservoir is the trinity river the total volume of the reservoir is 3 billion m3 we collected daily inflow evaporation and daily precipitation data of the reservoir for the period of november 1962 to august 2020 from the california department of water resources https cdec4gov water ca gov dynamicapp wssensordata in india we selected the bhadra reservoir along bhadra river and tributary of tunga bhadra river a major tributary of the krishna river one of the main rivers of peninsular india fig 4 the bhadra reservoir located on the bhadra river is a multipurpose reservoir providing irrigation hydropower and low flow augmentation requirement rehana mujumdar 2014 the total capacity of the reservoir is 2 0 km3 the daily inflow and evaporation data of the bhadra reservoir for june 2004 to may 2018 were considered for our analyses precipitation data from six rain gauge stations attigundi balehonnur basarikatte kalasapur mallanduru and narasimharajapura were collected on a request basis from june 2004 to may 2018 from the advanced centre for integrated water resources management aciwrm india the evaporation data we got from sources are in cfs cubic feet per second for cle and mcft million cubic feet for bhadra reservoir as part of the data processing we have transformed the evaporation data into m3 sec for both reservoirs 2 2 climate phenomenon indices the 10 climate indices considered in the study were arctic oscillation ao east pacific north pacific oscillation epo north atlantic oscillation nao nino1 2 extreme eastern tropical pacific sst nino3 eastern tropical pacific sst nino4 central tropical pacific sst nino34 east central tropical pacific sst pna pacific north american index soi southern oscillation index wp western pacific index ao epo nao wp pna https psl noaa gov data timeseries daily nino1 2 nino3 nino4 nino34 https climexp knmi nl selectdailyindex cgi id someone somewhere and soi https www longpaddock qld gov au soi soi data files along with these climate indices seasonality is considered indicating the year s month as one of ml models features based on the timeframe of the climate phenomenon indices and hydrological data available for the study reservoirs a common time frame was considered to evaluate the performance of the proposed modeling framework the timeframe for cle reservoir analysis was considered from may 1991 to december 2006 and from june 2004 to december 2006 for bhadra reservoir 2 3 data preprocessing various climate indices and hydrological variables have gone through data preprocessing involving data gap handling using linear interpolation time lag of input variables using auto and partial autocorrelation coefficients in this study a decision variable sensitivity study is conducted using the gini diversity index for feature extraction which was inspired by recent studies by yang et al 2016 2017 in which many decision variables of operating reservoirs were automatically ranked and selected as features the reservoir inflows are resultant of hydrological and climatological processes with a strong influence of previous periods on the current period under seasonality and water balance continuities yang et al 2016 hydroclimatic series tend to depend on earlier data which introduces time lag effects we estimated the autocorrelation and partial autocorrelation coefficients for climate and hydrological variables to account for the time lag impact on the reservoir inflow prediction the lag values were decided based on the autocorrelation and partial autocorrelation of climate phenomenon indices evaporation and precipitation for the study reservoirs for the present study 179 and 7 day time lag of various hydroclimatic variables were considered for the cle reservoir and bhadra reservoir respectively fig 5 after preparing the dataset with lag values of inflow evaporation precipitation and climate phenomenon indices for the cle reservoir the dataset includes 1 179 days lag values of inflow 2 current and 179 days lag values of evaporation 3 current and 179 days lag values of precipitation and 4 current and 179 days lag values of the 10 climate phenomenon indices and seasonality for bhadra reservoir the dataset includes 1 7 day lag values of inflow 2 current and 7 days lag values of evaporation 3 current value and 7 days lag values of precipitation and 4 current value and 7 days lag values of the 10 climate phenomenon indices and seasonality in predicting reservoir inflows via ml models the total input variables for the cle and bhadra reservoirs were 2519 and 111 respectively such a high dimensionality in the dataset tends to yield model overfitting and not all the input variables are essential rf classifier was used to select only the essential features that have more influence on the output rf tree based strategies are naturally ranked by how well they increase node purity this is the average reduction in impurity for all trees called gini impurity nodes with the highest decrease in impurity are found at the beginning of the trees while the nodes with the smallest decrease in impurity are found at the edge we can construct a subset of the essential features by pruning trees below a certain node for cle and bhadra reservoirs the threshold for the feature importance was set to 0 01 if the feature importance was equal to or greater than 0 01 those features were selected the important features of cle and bhadra reservoir can be observed in fig 5a and 5b 3 model development the proposed framework is an ml based reservoir inflow model using climate phenomenon indices and hydrological variables fig 1 in the proposed model data preprocessing methods feature extraction using the gini index scaling of data autocorrelation and partial autocorrelation models and four ml models rf gbr knn and lstm are combined with sufficient tests of performance measures of models and developed an ensemble model by combining four ml models using wvem to study the performance of the ml models in the prediction of high and low flows during monsoon june september and non monsoon october may periods for the bhadra reservoir we compared the performance statistics of each ml model with the best hyperparameters fig 10 for the cle reservoir the performance statistics of each ml model with the best hyperparameters were compared for two seasons flood control october to march and runoff or water supply april to september fig 11 3 1 random forest regressor rf collects many dts and a supervised ml model a dt is easy to build interpret and use but it suffers from the high variance if the dt grows very deep it is more specific to an output for a specific input set small changes in the input sets may lead to changes in the resulting output the dt performs well with data used to create them but it finds it difficult to classify new samples however the rf approach handles bias and variance in the decision making as rf is made of low bias and high trees which combine to generate a low bias low variance forest since the data is distributed across various trees and each tree sees a different collection of data rfs do not generally overfit underfitting is often avoided since they are constructed of low bias trees many dts are combined to build an rf for accuracy improvement to create rfs a bootstrapped dataset needs to be created which involves selecting samples randomly from the original dataset with replacement now at each step the bootstrapped dataset from the subset of input variables builds a dt such steps will be repeated by creating bootstrapped datasets and creating another dt using the original dataset in this way many dts are built under one rf at each step using only the subset of variables the bootstrapped sample results in a wide range and variety of trees which improves the effectiveness of the rf while making a decision on rf for classification the most voted output from all dts is considered as the desired output for regression all the results from the dts have been aggregated to output the regression value typically one third of the original dataset is not included in the bootstrapped dataset this dataset is called the out of bag which is used as a validation set of the rf model to check if it correctly classifies the dataset the incorrectly classified out of bag samples are called out of bag errors ultimately the rf tree is built and then estimates the accuracy of the rf if the accuracy is not satisfactory the above mentioned steps are repeated until the model performance is satisfactory fig 2 3 2 gradient boosting regressor a gbr takes small steps towards the direction that yields better predictions i e a lower variance friedman 2001 a gradient boosting starts by building a single leaf that represents the initial guess for the weights in contrast to adaptive boosting which starts by building a very short tree building called stump freund schapire 1997 at the early stage the predicted continuous value will be the average value the gradient boosting then builds the tree based on the previous tree error which is usually larger than a stump this limits the size of the tree and scales the tree but the scale is equal for all the trees gradient boosting stops building the trees if the number of trees is reached which is determined by the user or the additional trees do not improve the fit gradient boosting through learning rate scales the contribution from a new tree the error is calculated using pseudo residual the difference between observed and predicted weights when gradient boosting is used for the regression we start with a leaf an average value of the variable that needs to be predicted the gbr includes minimization of the loss function which makes the prediction and the additive model this model uses a forward stage wise approach to build the additive model this model optimizes the arbitrary differentiable loss function the regression fits on the negative gradient of the loss function for every stage regression trees choose the best split node based on the purity score like gini impurity or minimize the loss breiman 2017 the short dt in the gbr has a single split the weak learners in the additive model are not changed after calculating the loss a new tree is added to the gradient descent procedure to reduce the loss the new tree is parameterized and moves in the correct direction by lowering the residual loss parameters f model xi input set yi output set of f xi l loss function hm base learner function at stage m γm step length rim pseudo residual n the number of samples γ pseudo regularization parameter inputs inputs to the gbr are the number of iterations m a differentiable loss function l y f x and training dataset for xi yi for i 1 to n to the model algorithm an output variable y and a vector of input variables x in this supervised learning problem is compared to each other using a probabilistic distribution the aim is to find a function that better approximates the output based on the input variable 1 it accomplishes this by beginning with a model consisting of a constant function f0 x 1 f 0 x a r g m i n y i 1 n l y i γ 2 a loop model then repeats the following steps for m 1 to m a models compute the pseudo residuals r im using the following formula 2 r im δ l y i f x i δ f x i f o r i 1 n f x f m 1 x b fit a base learner or weak learner hm x is pseudo residuals and is trained using the training set xi rim for i 1 to n c compute the multiplier γm by solving the following one dimensional problem 3 γ m a r g m i n y i 1 n l y i f m 1 x i γ h m x i d after computing the multiplier the model is updated as follows 4 f m x f m 1 x γ m h m x 3 the final model output is f m x 3 3 k nearest neighbors regressor knn considers all the sample points and in the case of classification it takes the majority vote from the neighbors and produces the output but in the case of regression it takes the average of nearest samples values and produces the output modaresi et al 2018 in the knn algorithm it is possible to select the number of neighbors to consider before producing the output khazaee poul et al 2019 the knn considered the closest n nearest data points by calculating the distance using the euclidean distance method and taking the mean of the target value of closest n points and making the result value of the current data point the euclidean distance on a feature space with multidimensional attributes as follows 5 e u c l i d e a n d i s t a n c e i 1 k x i y i 2 3 4 long short term memory lstm is a recurrent neural network rnn that was originally introduced by hochreiter and schmidhuber 1997 lstm is designed to remove the struggle of remembering long term dependency lstm has a chain like structure and every module has four neural networks connecting in a special way fig 3 the sigmoid layer in lstm called forget gate layer fig 3a decides on keeping or discarding the information parameters ht output at state t xt input at state t ct cell state ft forget gate state it input gate state čt cell state gate ot output gate wf i c corresponding weight matrix bf i c corresponding bias forget gate layer observes the ht 1 and xt and outputs one value in the range of 0 and 1 both included for each number in the cell state ct 1 where ht 1 is produced from t 1 state and xt is input to t state of lstm if the value is 0 then discard the information and if the value is 1 keep the formation 6 f t δ w f h t 1 x t b f next the tanh layer and sigmoid layer called input gate layer fig 3 b are combined together which create a newly updated vector of candidate values čt and a new cell state ct is achieved 7 i t δ w i h t 1 x t b f 8 c ˇ t t a n h w c h t 1 x t b c now it is decided how much the new candidate value should be scaled to update each state to get the updated value fig 3c the following equation is followed 9 c t f t c t 1 i t c ˇ t to output the desired value and decide which part of the cell state is to output the cell state is run through the tanh and multiplied by the sigmoid gate fig 3 d 10 o t δ w o h t 1 x t b f 11 h t o t t a n h c t 3 5 weighted voting ensemble method the wvem is the most widely used method for combining model outputs for better prediction winkler makridakis 1983 the first step is calculating the error metrics e g root mean squared error rmse mean absolute error mae etc of each ml model then converting the metrics into rankings in this study the rmse is used to rank each ensemble member as it is a standard way to measure theerrorof a model let us consider an inflow prediction of n models for time step t the combined flow estimates f c of n models are given by the equation 12 f c i 1 n f i t r i i 1 n r i where f i t is the prediction from ml model i for time step t r i is the rank of the ith model and f c is the combined flow estimate of n models ranking indicates each ensemble s number of votes in the weighted average for example the worst performing model has one vote the second worst two votes and the best model 4 votes in the case of four ensemble members 3 6 parameterization and settings the ml models rf knn gbr and lstm were applied on both cle reservoirs and bhadra reservoirs with different parameters to develop the best performance in the model training phase table 1 for the lstm parameter setting three layered lstm were developed for the cle reservoir with the first input layer with 1024 neurons a second hidden layer with 1024 neurons and a third output layer as a single neuron for the bhadra reservoir three layered lstm included the first input layer with 512 neurons a second hidden layer with 1024 neurons and the third output layer with a single neuron every layer has relu activation so that an undesired result is not produced the adam optimizer and mean squared error loss function were considered to prevent an overfit k fold cross validation was used where the entire dataset is divided into k sets for the cle reservoir 15 folds and for bhadra 3 folds were used for the cross validation where each fold has almost one year of data samples the model evaluation metrics are given in the appendix 4 results 4 1 cle reservoir inflow prediction fig 6 shows the bar plots of inflows precipitation and evaporation for the cle reservoir during the period of may 1991 to december 2006 with annual average daily inflow and a standard deviation of 68 7 and 83 0 m3 s respectively the cle reservoir runoff and flood control seasons are from april to september and october to march with variabilities in the reservoir releases and inflow volumes yang et al 2016 the ml models were trained to find the best hyper parameters for each model table 1 provides statistical performance measures of the ml models with the best parameter settings for the cle reservoir fig 7 illustrates the scatter plot of observed and predicted inflows using gbr rf knn and lstm models for the cle reservoir 4 2 bhadra reservoir inflow prediction fig 8 shows the bar plots of inflows precipitation and evaporation of the bhadra reservoir for june 2004 to december 2006 with an annual average daily inflow of 100 2 m3 s standard deviation of 182 0 m3 s in the bhadra reservoir area the runoff seasons are from june to september as monsoon and october to may to the following year as non monsoon seasons for bhadra reservoir inflow predictions various hyper parameter setting experiments were carried out for all the ml models table 1 fig 9 illustrates the scatter plot of observed and predicted inflows using gbr rf knn and lstm models for the bhadra reservoir 4 3 ml model performance the next step in the prediction of inflow is to use the appropriate ml which can work satisfactorily in terms of performance measures fig 1 the results of the four ml models for the prediction of inflow were evaluated using several goodnesses of fit statistics table 1 and visual comparisons figs 10 and 11 our results showed an acceptable trade off between training and validation performance confirming the stable generalization capacity of ml approaches the developed models were able to predict inflows successfully at a daily time scale for both reservoirs the models performance with the best parameter set for the cle and bhadra reservoirs are provided in table 1 and figs 7 and 9 our results showed that the seasonal variations of predicted inflow are almost synchronous and comparable with the observed values figs 7 and 9 lstm had the best performance among the four ml models for both the cle and bhadra reservoirs figs 7 and 9 while knn had the least desirable performance for both reservoirs during the monsoon season of bhadra reservoir the best performance belonged to lstm while rf showed a poor performance fig 10a a similar finding was found for the non monsoon season but the model performances was generally more satisfactory compared to monsoon season fig 10b the better performance of the ml models during non monsoon seasons for the bhadra reservoir is critical in the low flow augmentation of the reservoir operation the best model for predicting daily inflows in the cle reservoir was the same as bhadra lstm during both flood control and runoff seasons fig 11 for both these seasons knn was the least effective model fig 11 this suggested that among the four ml models the best model was not sensitive to the study reservoir based on rmse according to figs 10 and 11 only lstm provides satisfactory performance and provides different season performances 4 4 ensemble model performance and uncertainty estimation the results of the ensemble model prediction performance are in table 1 the ensemble model metrics were then evaluated and compared to the performance of each standalone ml model our results showed that the ensemble model performed better than standalone rf gbr and knn and lstm models in inflow forecasting for the bhadra reservoir in the case of the cle the results showed that the ensemble model outperformed all the standalone models except for lstm fig 12 a and b depict the uncertainties showing the maximum and minimum monthly average inflows among the four ml models along with ensemble model inflows based on these ml models and current inflow for both study reservoirs the spread of the maximum and minimum monthly average inflow values among the four ml models implies the predictive uncertainty the spread in the predicted inflow hydrograph varies from one event to another fig 12 a and b also depict the low and high flow events in 2005 as subplots for the cle and bhadra reservoirs 5 discussion the present study used various state of the art ml models of rf regressor gbr knn regressor lstm techniques to model the complex non linear relationship of various large scale climate indices and hydrological variables for short term daily inflows forecasting of a reservoir including time lag effects of various hydro climatic indices for the two study reservoir systems with distinct climatological and hydrological conditions for both cle and bhadra reservoirs the lstm model performed much better than the other models with the aid of hydrological variables and climate phenomenon indices along with time lagged information lstm model has strong extracting capabilities considering the number of input nodes hidden nodes and layers our reservoir inflow prediction algorithm using rf knn gbr and lstm models rmse 13 62 to 93 31 m3 s was in good agreement compared with earlier models of rnn by nagesh kumar et al 2004 rmse 160 180 rf by yang et al 2017 rmse 34 38 and support vector regression by mehrparvar and asghari 2018 rmse 57 83 all at monthly timescales for different reservoirs our rf based daily inflow predictions for the cle reservoir with an rmse range of 43 50 to 43 71 m3 s is comparable to yang et al 2017 for the cle reservoir with an rmse range of 34 to 38 m3 s with monthly time scale predictions in the study of yang et al 2017 the time lagged information was for the short duration of about two months in the cle reservoir monthly inflows predictions the present study made efforts to overcome such a limitation of the inclusion of a shorter period of time lagging information of hydrological and climate phenomenon indices by the inclusion of 179 days using autocorrelation and partial autocorrelation models at a daily time scale for the cle reservoir the superiority of lstm rnn in the prediction of daily inflows as revealed in the present study was in agreement with the study of nagesh kumar et al 2004 for monthly time scales using rnn for indian river systems our predictions on the bhadra reservoir inflows rmse range 58 37 to 93 91 m3 s is also comparable with the monthly predictions by rehana and mujumdar 2014 using canonical correlation analysis as a multiple regression algorithm overall in figs 10 and 11 the lstm model was shown to be the best model for improved predictions compared to the other models in predicting high flood control and monsoon seasons and low runoff and non monsoon seasons reservoir inflows of both cle and bhadra reservoirs from table 1 the overall performance of lstm model rmse 13 62 m3 sec r2 0 94 kge 0 93 is improved when compared to other ml models rmse 42 55 49 81 m3 sec r2 0 67 0 77 kge 0 59 0 74 for cle reservoir from table 1 the overall performance of lstm model rmse 58 37 m3 sec r2 0 89 kge 0 86 is improved when compared to other ml models rmse 65 18 68 51 m3 sec r2 0 85 0 86 kge 0 77 0 89 for bhadra reservoir to check the performance of two reservoirs with the same climatological phenomenon indices and different climatological conditions we have considered the common time period from june 2004 to december 2006 for bhadra reservoir which resulted in moderate performances compared to cle we showed that an ensemble prediction is needed to integrate the strengths of different ml models this also permits the estimation of forecasting uncertainty in this study the ensemble model which was developed using four ml models using wvem performed better than individual ml models in most cases in the case of cle reservoir the lstm model performed better than the ensemble model though the wvem used in the ensemble model reduced the uncertainty of various ml models by leveraging the strengths of each ml model overall predictive uncertainty was significantly less for both cle and bhadra reservoirs as the four ml models rf gbr knn and lstm used in this study have an excellent ability to handle uncertainty in this study all four ml models were developed with the best set of hyperparameters in the training phase which could be another reason for significantly less uncertainty overall the data driven framework presented in the study indicated that ml models were proven to be effective in reservoir inflow prediction with the aid of hydrological variables and climate phenomenon indices along with the time lagged information the current study outcomes significant inferences for research on reservoir inflow predictions especially from the viewpoint of climate phenomenon indices as demonstrated in the present study short term reservoir daily inflow forecasting using ml models can be promising in reservoir management and operations under hydroclimatic extremes floods and droughts and in addressing the possible vulnerabilities and risks to the population in real time nanditha mishra 2021 improved forecasts of the hydroclimatic phenomenon which serve as inputs to the demonstrated reservoir inflow forecasting models can aid the water resources management authorities under severe pressure due to targets of sustainable water supply environmental stability and fulfilling the rising water demands with limited water availabilities the traditional reservoir inflow prediction models rely solely on rainfall and historical inflows and may not be enough under intensified hydroclimatic extreme scenarios fischer knutti 2015 once the real time reservoir inflows at short term forecasts are available optimal releases to meet the downstream reservoir water user demands and possible releases during floods can be defined a holistic approach for real time reservoir operation models integrating hydrological and large scale climate phenomena along with operating rule curves can be a potential area of research for developing decision support systems for downstream water utilities rehana et al 2020 given the advantages of the proposed modeling framework caveats are still there which need attention for future research the reservoir inflows are burdened with uncertainty due to randomness which was not accounted for in our predictions the present study assumed that precipitation and evaporation are the only predictor variables that directly affect reservoir inflows however there are several variables that directly affect inflow predictions such as soil land use characteristics of the upstream catchment area landscape information at various spatiotemporal scales awol et al 2019 which are not considered in the present study furthermore the present study did not account for the unprecedented hydrologic extremes that may occur under climate change signals in the reservoir inflow predictions kusunoki et al 2020 the study stresses the improvement of ml models to account for various uncertainties and unprecedented hydroclimatic extremes in reservoir inflow prediction models which can be a potential area of research furthermore advanced ensemble algorithms and bayesian optimization approaches to optimize the hyperparameters of the models can be possible future work for better predictions the prediction of reservoir inflow should be able to handle multi scale effects by linking the local hydrological variables and climate indices however teleconnections among different hydrological and other phenomena are so complex that it may not hold the relationship at all scales and therefore training the model at each time scale forms potential area of research 6 conclusions the purpose of this study was to assess the performance of state of the art ml techniques rf gbr knn and lstm in forecasting the short term daily inflows of bhadra reservoir in india and cle reservoir in california usa using historical hydrological data and large scale climate phenomenon indices along with time lagged information we compared various ml methods as robust models to extract complex non linear relationships among various hydroclimatic variables in forecasting the daily reservoir inflows considering hyper parameter structural settings we also developed an ensemble model by combining four ml models using the wvem to calculate forecasting uncertainty and improve model performance the presented modeling framework can be applied to other reservoirs due to its versatility the notable conclusions were 1 ml techniques are robust and helpful in simulating the reservoir inflow considering the influences of evaporation precipitation and large scale climate phenomenon indices the climate phenomenon indices that influence the inflow were ao epo nao nino1 2 nino3 nino4 nino34 pna and soi wp seasonality and the time lagged information 2 the lstm was capable of providing good performance and was recommended for reservoir inflow short term forecasting due to its robust prediction capability over rf gbr and knn in capturing the peak inflows knn generally showed the lowest performance for both reservoir cases with the increase in iterations the statistical performance of the lstm model improved for both study reservoirs 3 lstm model was shown to be a better model for predictions compared to other examined models in predicting high flood control and monsoon seasons and low runoff and non monsoon seasons reservoir inflows of both study reservoirs 4 the ensemble model performed better than the standalone models for most of the cases prediction uncertainty was significantly less for both reservoirs as all four ml models that we used in this study have an excellent ability to handle uncertainty in the training phase all four ml models are developed with the best set of hyperparameters overall the demonstrated short term reservoir forecasting model allows reservoir operators to monitor adapt and add various hydrological and climate phenomenon indices per regional hydrology and decision making operators credit authorship contribution statement rajesh maddu data curation investigation indranil pradhan software data curation visualization ebrahim ahmadisharaf writing review editing supervision shailesh kumar singh writing review editing supervision rehana shaik conceptualization methodology writing original draft supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented in this study was funded by the ministry of science technology department of science technology tmd energy water others water technology initiative project no dst tmd ewo wti 2k19 ewfh 2019 306 the cle reservoir data for this paper is available at the california data exchange center http cdec water ca gov index html and various climate indices data from noaa earth system research laboratory http www esrl noaa gov psd data climateindices list the authors sincerely thank dr p somasekhar rao technical director at the advanced centre for integrated water resources management aciwrm bengaluru karnataka india for providing bhadra reservoir data appendix model evaluation metrics the metrics used to measure each ml model s performance are root mean squared error rmse mean absolute error mae absolute percentage bias apb the coefficient of determination r2 correlation coefficient corr nash sutcliffe efficiency nse and kling gupta efficiency kge rmse i 1 n y i y i 2 n m a e i 1 n y i y i n apb i 1 n y i y i i 1 n y i 100 r 2 1 rss tss corr x i x u 2 y i y u 2 x i x u 2 y i y u 2 nse 1 i 1 n y i y i 2 i 1 n y i y u 2 kge 1 1 r 2 γ 1 2 β 1 2 β μ s μ 0 γ σ s μ s σ 0 μ 0 where n number of non missing data points yi observation time series ŷi prediction time series rss sum of squares of residuals tss total sum of squares xi values of variable in the sample xu mean of the values of variable yi values of the y variable in the sample and yu mean of the values of y variable r is the correlation coefficient between simulated and observed time series β is the bias ratio the ratio between simulated mean and observed mean γ is the variability ratio the ratio between simulated variance and observed variance μ is the mean σ is the standard deviation and n is the number of data pairs in comparison 
