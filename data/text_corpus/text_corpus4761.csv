index,text
23805,model states are often validated against observations to establish the veracity of the model however when a model state is compared with multiple in situ observations scattered in space no single diagram exists that can showcase the statistical measure of correlation root mean square error and the standard deviations of the concerned variables across all the locations we present a simple but efficient representation of correlation root mean square error and standard deviation of the model and the observation across multiple in situ locations in a single diagram and name it as the performance across space pas diagram we also present a diagram that showcases the comparison of model state and observation at a single location across multiple time windows in a single diagram and call it performance across time pat diagram we highlight the effectiveness of these diagrams through realistic ocean models and realistic in situ observations we show using a pat diagram that the ocean model nemo fares better in simulating ocean sea surface temperature during boreal winters compared to boreal summers we also illustrate how the pas diagrams can be used in assessing the efficacy of data assimilation though the examples shown here are from the field of oceanography the display mechanism can be extended to any field keywords model validation root mean square error correlation standard deviation data availability data will be made available on request 1 introduction most of the dynamical models stochastic or deterministic are designed to replicate some aspect of reality if not all the veracity of these models is often assessed by comparing the time evolution of the model states against the observations in simulating complex realistic phenomena like weather and ocean conditions dynamical models are prone to accumulate errors during its evolution due to a multitude of reasons like inaccurate initial conditions and boundary if it is a regional model inaccurate representation of imposed forces absence of true knowledge of model parameters empirical parameterization of small scale phenomena and many others in such cases observations are often assigned greater reliability in the absence of the knowledge of absolute truth the observed time series of a variable therefore assumes the role of the reference time series against which the performance of model states often called test time series are evaluated evaluating three statistical measures correlation root mean squared error rmse and standard deviation are the three basic steps of these assessments before delving deeper into higher orders of statistical measures correlation is a statistical measure that estimates the degree of similarity in pattern between two datasets the pearson correlation coefficient r between two time series a and b is defined as 1 r n 1 n a n a b n b n σ a σ b where n is the sample size σ a and σ b are the standard deviation of the datasets a and b respectively a n 1 n a n and b n 1 n b n represents the time mean of the two datasets respectively the standard deviation in a on the other hand is defined as σ a n 1 n a n a 2 n 1 the expression for the standard deviation in b is similar the standard deviation signifies the measure of variability of each dataset the presence of standard deviations in the denominator in eq 1 constrains the correlation coefficient r to vary between 1 and 1 if the two time series are perfectly in out of phase r assumes the value 1 1 the correlation coefficient does not however indicate the degree of departure in amplitude between the two datasets the degree of departure is reflected in the rmse between the two datasets the total rmse between the two time series a and b is defined as r m s e n 1 n a n b n 2 n the total rmse can reflect discrepancies between datasets of three major types 1 the model dataset may suffer from a bias for example this is often encountered while interpreting the time series of sea surface height at a location from models and altimeters in most cases the altimeter and the model assume different geiods leading to a bias in the model sea surface height sometimes it is meaningful to ignore the contribution of biases to the total rmse in such circumstances centered rmse is used the centered rmse is related to the total rmse through the following expression centered rmse 2 r m s e 2 a b 2 2 there may be a phase lag lead in the model dataset compared to the observation dataset one example of this is the cooling of observed and modeled sea surface temperature sst during the passage of a cyclone often the atmospheric models used to force ocean dynamics delay the genesis and subsequent evolution of the cyclone thereby leading to a phase lag in the sst estimation by ocean models compared to the observed sst cooling 3 the inability of the model to reproduce the magnitude of a physical process for example a numerical ocean model may reproduce the directions of the ocean currents but underestimate the amplitude likely because of a use of inferior wind speed to force the model compared to reality it is important to look at these three statistical measures in a holistic manner to gauge the degree of correspondence between two datasets a taylor diagram taylor 2001 is a convenient way to depict all three of these statistical measures from two time series data typically from an observation and a model at some specific location or averaged over a domain in a single diagram it is to be noted that the taylor diagram in its normal form displays centered rmse however if a model performance has to be assessed across multiple locations for instance there is not a single diagram in use to the best of our knowledge that suits the purpose the scientific community usually resorts to multiple diagrams one for each location to arrive at the effectiveness of the model a taylor diagram is sometimes used to carry out such an exercise wherein the model data at each location is normalized with respect to the corresponding observation the statistics for each such location is labeled in the taylor diagram to distinguish one from the other this makes the visual inspection of location versus statistics inconvenient and consequently may hinder region specific interpretations the resultant diagram also loses the information about the absolute variability of the observation due to normalization a single taylor diagram can also be plotted without normalization but for each point on the diagram a corresponding point would need to appear along the x axis labeled in the same way indicating the observed dimensional standard deviation in this paper a new representation is described that eases the analysis of model performance across multiple locations in addition if the performance of a model has to be assessed across multiple time windows against an in situ observation at some particular location researchers often use separate plots for each such time window to depict the model performance in terms of correlation rmse and standard deviation it is inconvenient to arrive at any holistic conclusion about the efficacy of the model from multiple diagrams a recent illustration called spectral diagram has been proposed that exhibits the coherence function power amplitude phase and skill score of discrete frequencies of two time series in a single plot calim costa et al 2022 this diagram is devised to identify synchronous patterns across different frequency bands one may also resort to a taylor diagram wherein the different time series can be normalized with respect to the corresponding observations and thereby the statistics across various time windows can be represented in a single taylor diagram the process of normalization however comes with its usual cost of losing the information of the magnitude of the variability in the observation we have devised a single diagram that assesses the model performance across multiple time windows in a single plot without sacrificing the information about the magnitude of standard deviation of the observations we have also provided sample programs for these plots so that it can be easily customized and used in section 2 we describe these plots using generic examples in section 3 we show the merits of the diagrams using a real example from the field of oceanography we also plot the corresponding taylor diagrams for these realistic examples and draw comparison between the two approaches finally in section 4 we summarize and discuss the benefits and drawbacks of these plots 2 overview of the new diagrams we have developed a simple elegant and effective way to illustrate model performance across various in situ locations in a single diagram in fig 1 we demonstrate the salient features of this illustration through a schematic diagram fig 1 depicts the model performance for an arbitrary variable at various locations in the world ocean needless to mention that the reference time series of the token variable or observation considered here are different from each other at all the locations the same stands true for the time series of the same token variable estimated from the model at each location we estimate the correlation and the root mean squared error between the observed and the modeled variable as well as the standard deviation of the observed and the modeled variable the performance of the model against these observations at all the locations are depicted using ellipses the two axes of the ellipse denote the standard deviation of the modeled and the observed variable with all dimensional quantities given in whatever units apply the zonal east west axis of the ellipse represents the standard deviation of the model while the meridional north south axis denotes the standard deviation of the observed data if the ellipse is stretched in the north south east west direction the model underestimates overestimates the standard deviation of the observation in essence if the model manages to reproduce the standard deviation of the observation both the axis length will be identical and the ellipse will reduce to a circle the standard deviation scale can be represented using a circle whose radius presents the scale of the standard deviation in appropriate units one can therefore deduce the standard deviation of the observation and the model from the size of the ellipse the color within the ellipses represent the correlation the total or centered rmse is depicted in numbers beside each ellipse we call this representation the performance across space pas diagram in fig 1 we would like to draw your attention to three distinct locations marked as a eastern indian ocean b central pacific ocean and c western atlantic ocean to illustrate how to interpret the pas diagram we observe that the correlation between the modeled and the observed variable is greater than 0 5 maroon color at the location marked a it also depicts that the model correctly estimates the standard deviation of the token variable compared to the observed standard deviation and consequently the ellipse is reduced to a circle the rmse at this location is depicted in numbers 1 25 beside the ellipse at location b the model overestimates the standard deviation of the token variable compared to the observed standard deviation as a result the ellipse is stretched in the east west direction the correlation between the modeled and the observed variable is around 0 3 red color whereas the rmse of the modeled variable with respect to the observation is depicted in numbers 0 42 beside the ellipse at location b at location c the model underestimates the standard deviation of the observed variable consequently the ellipse is stretched in the north south direction at location c the rmse is 0 56 and the correlation at c is greater than 0 5 maroon color the representation of the model performance through this type of diagrams offers the following advantages 1 a single diagram can illustrate the model performance at various locations scattered across the domain instead of looking at the model performance at multiple locations through multiple single diagrams it is however possible to represent the statistics of several locations in a single taylor diagram using labels for each location in such a diagram the model data at each location is normalized with the corresponding observed data i e one can extract the ratio of the variability of the observed and modeled data but the information about the absolute amplitude of variability in the observation is lost due to normalization one can also choose not to normalize the model data at each location this shall result in multiple points on the x axis denoting the standard deviations at each location and compromises but possible the interpretability of the diagram the pas diagram suffers from no such drawback 2 it clearly illustrates the locations at which the model underperforms and the locations at which the model performs satisfactorily a visual representation like pas is likely to highlight specific regions where the model needs improvement which may be otherwise tedious to discern for example if there are ellipses oriented along the north south direction confined within a specific region or basin one can safely conclude that the model underestimates the observed variability within that region basin and therefore offers opportunity for trouble shooting such a possibility may exist in reality most of the parameterization schemes in use in the state of the art general ocean circulation models were formulated from observational campaigns carried out mostly in the pacific ocean large and gent 1999 li et al 2001 and the atlantic ocean halliwell 2004 because of which the indian ocean remains under represented in the formulation of the parameterization schemes pas diagram makes it easier to evaluate model performance at various in situ locations in a single diagram however it cannot be used if the model performance has to be evaluated at a specific location but for different time windows or if multiple variables from a model at a particular location or averaged over a domain are to be validated one way to represent such statistics is to rely on a taylor diagram in such cases each of the model datasets needs to be normalized with respect to the corresponding observed dataset and plotted in a single taylor diagram it will however not be possible to extract the absolute variability of the data from such a diagram since the data has been normalized also each different dataset needs to be labeled to differentiate it from the other and it may be inconvenient to draw correspondence between the statistics and the labels another option is to note down these three statistical measures at one place in tabular form for all the time windows it however remains difficult but possible to discern meaningful inferences from such a tabular representation it is easier to draw inferences from a pictorial diagram than from a tabular representation because diagrams present unambiguous clarity we have therefore developed a performance across time pat diagram to represent the model performance across multiple datasets pat diagram also resorts to labeling the datasets but it is designed to be self explanatory in fig 2 we schematically illustrate the efficacy of this diagram and explain how to interpret this diagram in fig 2 we evaluate the performance of an hypothetical model against an hypothetical observation at a specific location for an arbitrary variable for each month of a year and schematically represent the statistics of twelve months using a circular clock like diagram for example a daily arbitrary model variable is compared with a daily observation for each month of a year i e 30 samples of model variable are compared with 30 observation samples for a month the statistics are estimated from these 30 samples for a month and this exercise is repeated for all the months of the year each hand of this clock embodies the statistical measure of correlation between the model variable and observation and standard deviation of the model and observation corresponding to the month it is pointing towards in the diagram the color of the hand represents the correlation if the standard deviation of the observation model exceeds the standard deviation of the model observation the hand of the clock is represented as a solid dotted line this allows the user to immediately interpret if the model underestimates when the hand is solid or overestimates when the hand is dotted the observed variability we also normalize the length of the hand such that it is always unity if the standard deviation of the observation is larger smaller the length of the hand represents the standard deviation of the observation model this ensures that the length of the hand always remains unity and the user does not need to tune the radius of the clock if the hand is a solid dotted line the distance of the solid black circle on the hand from the origin of the clock represents the standard deviation of the model observation normalized with the standard deviation of the observation model the size of the radius of the solid black circle always reveals the standard deviation of the observation the scale of this standard deviation is represented by the radius of the solid black circle on the top right corner of the plot the numbers on the outer periphery of the clock depicts the ratio of the total rmse and the observation standard deviation i e normalized rmse corresponding to each time window this kind of representation depicts the correlation the normalized rmse the ratio of standard deviation of the observation and the model and the standard deviation of the observation across various time windows in a single diagram for example in this hypothetical schematic diagram the model performs reasonably well in the months of december to march the correlation is high the rmse is low and the model reasonably manages to simulate the standard deviation of the observation during december to march the model however overestimates the observed variability during february and march in contrast the correlation is negative rmse is high and the model largely underestimates the standard deviation of the observation during the months of october and november in short the model performs quite poorly during the months of october and november but reasonably well during december to march the pat diagram displays statistical measures gauging agreement between two datasets in several ways helpful to users 1 the users can quickly identify the time windows during which the model behavior is satisfactory and the time windows during which the model needs additional fine tuning 2 this diagram also allows the user to immediately identify the time window during which observation dataset exhibit extreme variabilities for example there is largest smallest variability in observation during january september 3 the inclusion of absolute magnitude of the standard deviation of observation in the pat diagram ensures that the readers can estimate the absolute values of the standard deviation of the model and the total rmse between the two datasets if required 4 the pat diagram may also be easily adapted to compare the performance of various models against an observed time series data the labels depicting different months in fig 2 needs to be replaced by different models and the statistics between the models and the observation can be similarly displayed it can also be easily adapted to compare multiple variables in a model in the next section we will use real observation data and a realistic ocean model to showcase the applicability of these diagrams in the field of oceanography we will also compare these diagrams with the corresponding taylor diagrams to highlight the advantages and drawbacks of these diagrams 3 realistic example for pas and pat there are 26 in situ rama moorings mcphaden et al 2009 in the indian ocean for the period 2010 2019 that record daily temperature data up to a maximum depth of 750 m we choose 16 moorings out of 26 moorings to showcase the efficacy of pas diagram we did not choose all the 26 moorings for comparison to avoid clustering and overlapping of the ellipses all the observations presented here in this study have gone through the same quality control procedures as mentioned in freitag et al 1999 we compare the daily surface temperature recorded by these 16 moorings with the daily surface temperature estimated by the ocean model nucleus for european modeling of the ocean nemo version 3 6 stable madec et al 2014 lellouche et al 2018 the choice of variable in this study i e sst is arbitrary and is solely meant to illustrate the pas diagram the annual cycle of sst which is the most dominating period rai and pandey 2008 rao and goswami 1988 has been removed from both the model data and the observations before comparing in fig 3a this model is coupled to the louvain la neuve lim3 sea ice model rousset et al 2015 this model spans the global domain at a nominal resolution of 1 12 the resolution is 9km at the equator 7km at mid latitudes and 2km near the poles the model consists of 75 vertical levels the initial condition of the model is obtained from a 30 year spin up using the european centre for medium range weather forecasts ecmwf forcings dee et al 2011 subsequently the model is forced with six hourly national centre for medium range weather forecasting fluxes prasad et al 2014 from january 2009 and is run till august 2019 the model is forced with the following fluxes wind radiative fluxes air temperature rain and specific humidity more details about the model configuration can be found in afroosa et al 2021 most of the ellipses show small eccentricity except at 100 e 8 s 65 e 15 n and 55 e 12 s thereby implying that nemo manages to capture the sea surface temperature sst variability reasonably well across most of the locations at the northernmost station in the arabian sea the model variability exceeds the observed variability whereas at the easternmost station in the equatorial indian ocean the model fails to reasonably reproduce the observed variability as a result the ellipse is oriented along the north south direction at the northernmost station in the arabian sea and elongated along the east west direction at the easternmost station in the equatorial indian ocean the correlation between the two sst time series is always greater than 0 8 99 significant across all the stations except at 100 e 8 s i e the model manages to reproduce the phases of the observed sst reasonably well the total rmse is always below 1 c except at the easternmost station in the equatorial indian ocean viz 100 e 8 s where it is almost close to 2 c the correlation also is the lowest at this location and the model largely underestimates the standard deviation of the observation pas diagram clearly demonstrates that the model is least effective at this location compared to other locations and therefore offers opportunity for the future development of the model also the sst variability both observed and model is modest in the equatorial indian ocean and gradually increases poleward in fig 3b we replot the same statistics as in fig 3a but using a taylor diagram the model data at each location labeled using distinct colors is now normalized with respect to their corresponding observations the model standard deviation at all locations is in close proximity to the observation standard deviation except at 100 e 8 s and 65 e 15 n as expected i e this inference is identical to the one we arrived at from the pas diagram the taylor diagram with normalization however fails to indicate that the largest variabilities in both observations and model are seen away from the equator even though all the statistics are tagged to a location it remains difficult to assess the spatial variability of the statistics from a taylor diagram in contrast it is easy to identify from taylor diagrams all locations which show similar variability compared to a pas diagram for example it appeared through visual inspection from the pas diagram that the model falls short by some significant margin in reproducing the observed variability at 55 e 12 s which is misleading as can be seen in the taylor diagram blue square in fig 3b the mooring at 95 e 5 s is highlighted in fig 3a using a black arrow the standard deviation of the model in sst over the period of 9 years appears to reasonably represent the standard deviation of the observation the ellipse looks close to a circle how well does the model manage to reproduce the observed variability in sst if we analyze it over monthly durations instead of analyzing the entire time series of 9 years in fig 4a we plot the pat diagram highlighting model nemo performance in sst estimation annual cycle removed with respect to a rama mooring stationed at 95 e 5 s we collate daily sst data from the model and the rama mooring for each month during the 9 year period for example we collate the daily sst data during all the january months for the period 2010 19 from both the model and the rama mooring this will result in two time series with 31 9 279 model sst data and 279 observed sst data corresponding to the month of january the same exercise is repeated for the rest of the eleven months of a year we then compute the statistics of the performance of the model for each month and plot the pat diagram the correlation is positive for all the months it is particularly promising for the months of december march the normalized rmse total rmse divided by observation standard deviation remains less than 1 3 across all the months the normalized rmse exceeds unity during june october and november signifying that the rmse in the model is larger than the variability in the observation the largest variability in sst is observed during the months of january and february whereas the least variability is observed in the month of may which is about 3 4 times smaller than the observed largest variability the model underestimates the variability by a small margin in the observation during november and february to april but overestimates during the rest of the months in terms of estimating the sst variability the model performs best worst during february november september the correlation in may and june is rather weak we can infer that the model is good to simulate the observed sst at 95 e 5 s during november to april in contrast the performance of the model degrades during may to october in terms of correlation in particular during september the pat diagram exhibits the worst estimation of standard deviation and a reasonably large rmse the relative inaptitude of the model during the boreal summer months can be because of a variety of reasons ranging from possible errors in the atmospheric fluxes during boreal summer or because the parameterization schemes employed in the model are less accurate during summer in short the pat diagram highlights the degree of efficiency of nemo across various months and calls for corrective measures during the boreal summer months in fig 4b we replot the above statistics using a taylor diagram each of the 12 model datasets is normalized with the corresponding observation dataset this is to remind the readers that the taylor diagram in its normal form displays the centered rmse normalized with the standard deviation of the observation in contrast pat diagram fig 4a displays the total rmse normalized with the standard deviation of the observation as a result there are differences in the rmse values depicted in fig 4a and b the taylor diagram reiterates that the correlation between the two time series is best worst during the months of december march may june the model underestimates the variability by a small margin in the observation during november and february to april but overestimates during the rest of the months in terms of estimating the sst variability the model performs best worst during february november september in short the taylor diagram can also indicate these salient features in the statistics across the months however unlike the pat diagram it is not obvious but discernible that the model is underperforming during the boreal summer months it is also not apparent from the taylor diagram that the observation displays largest variability during the month of january and february and smallest variability during may it is nevertheless possible to introduce such a feature in the taylor diagram for example linking the size of the squares with the observation standard deviation shall serve this purpose but unlike the pat diagram this runs the greater risk of squares overlapping each other because the display of a typical taylor diagram is constrained in a quadrant provided all correlations are positive in contrast to the availability of all the four quadrants to display the pat diagram however the clustering of the data in the taylor diagram immediately indicates that the model displays similar behavior across months such an interpretation is not obvious immediately but discernible from a pat diagram in short the taylor diagram can exhibit all the features that are present in the pat diagram but may be inconvenient while interpreting certain statistics 4 summary and discussion this paper presents two simple but easy to interpret diagrams about comparing time series data from two different sources one diagram which we call the performance across space pas diagram represents the performance of a model time series against an observation time series for any particular variable across multiple in situ locations using ellipses around the locations of the observations pas diagrams highlight the strengths and drawbacks of the veracity of the model across space though we have used examples from the field of oceanography it can be easily extended to other fields there exist similar diagrams using ellipses that depict errors in the global positioning system gps community these ellipses represent the error in velocities measured by the gps stations in a similar way as the one mentioned here along with an arrow that showcases the velocity magnitude and direction a 2 2 covariance matrix is also often represented using an ellipse with the eigenvectors of the covariance matrix pointing towards the two axes another representation named as sailor diagrams has been devised to compare vector quantities like ocean currents and winds from multiple models with respect to an observation dataset sáenz et al 2020 it is based on the two dimensional structure of the mean error squared matrix derived from the models and the observation the mismatch in terms of the eccentricity and the orientation of the model ellipse with respect to the observation ellipse indicates the degree the departure between the two datasets the evolution of tidal currents over one time period is also often depicted using an ellipse called tidal ellipses in such a representation the velocity vector of the corresponding tidal constituent trace the perimeter of the ellipse during one time period in contrast the ellipses in the pas diagram are meant to represent the statistics of any two dimensional scalar variable unlike the vector velocity errors in the gps community to represent velocity conformity using a pas diagram one needs to plot separate pas diagrams for each component of the velocity the pas diagram illustrated here is two dimensional in nature it is technically possible to extend it to three dimensions for example one can represent the performance of a model across depths at various in situ locations using ellipses at each depth there are platforms like matlab that allow a 3d representation of a diagram however it will be aesthetically challenging to cleanly represent the model performance across multiple depths for many in situ locations in a single diagram unless it allows the reader user to interactively alter the orientation of the diagram such an interactive possibility is very much on the cards in the near future this diagram will also be of little use if the in situ observations are very densely located for example if dense satellite derived products like sst sea level anomaly sea surface salinity etc are to be compared with models at each observation location pas will be ineffective in such a scenario the ellipses around these locations will overlap thereby rendering the interpretation of this diagram difficult in short the two adjacent locations at which the time series are compared should be sufficiently wide apart to avert overlapping of the ellipses we have shown using the pas diagram how the ocean model nemo fares in reproducing the observed sst variability across multiple different mooring stations in the indian ocean whereas nemo fares reasonably well in reproducing the observation in terms of correlation variability and rmse across most of the locations it appears to fare below par in the eastern indian ocean pas diagram thereby highlights the eastern indian ocean to be a region of concern for modelers working with nemo for researchers it highlights that any process studies at the eastern indian ocean using ocean states simulated by nemo needs to be judiciously performed pas diagrams can also be used to compare the performance of two different models against the same observation the two axes of the ellipse can then be the normalized standard deviation of the two models with respect to the standard deviation of the observation the unit normalized standard deviation of the observation can be represented as circles superimposed on the ellipses if any of the axis length of the ellipse is more less than the radius of the circle the corresponding model overestimates underestimates the observed variability the color of the ellipse can be the difference in correlation between the two models whereas the difference in total or centered rmse between the two models can be highlighted as text beside each ellipse instead of comparing two models one can also choose to compare the background also called prior or a free run and analysis also known as posterior during data assimilation exercises in such a scenario pas can highlight if the process of assimilation has indeed resulted in improvements in terms of variability correlation and rmse in the background state of the model or the free run and at what regions it has improved or deteriorated thereby enabling the modeler to further fine tune the model or assimilation in fig 5 we demonstrate such a possibility using an assimilated product using 1 12 regional ocean modeling system roms baduru et al 2019 francis et al 2020 and a free run of 1 12 roms for the indian ocean we look at the improvements or degradations in sst annual cycle removed after assimilation at 18 different in situ locations wherein sst is observed through moorings at each of these locations in the indian ocean all the sst observations from these 18 moorings are assimilated the purpose of this exercise is to highlight the efficacy of the pas diagram and not to highlight the effectiveness of the assimilation we estimate the difference in correlation and total rmse between the analysis and the free run across all these locations for the period september 2016 september 2018 two years δ corr corr analy sis corr free δ rmse rmse analy sis rmse free a positive negative δ corr and a negative positive δ rmse represents improvement degradation the standard deviations from these two products at each location are normalized with the standard deviation of the observation a elongated ellipse in the east west north south direction represents a larger standard deviation in the free run analysis the variability in the free run and the analysis at each location is compared with the circle superimposed over the ellipse for example consider the buoy located at 95 e 8 s the east west axis of the ellipse exceeds the radius of the superimposed circle signifying that the free run overestimates the observed variability the north south axis of the ellipse however is the same as the radius of the circle i e the assimilation has managed to restore the standard deviation of the analysis the reverse occurs at 67 e 4 s where the analysis overestimates the standard deviation however assimilation improves the variability in the model across most of the locations pas diagram also reveals that assimilation has improved the correlation across most of the mooring stations except at 67 e 12 s the δ rmse in sst is negative across the majority of the stations indicating that assimilation has improved the sst amplitude except at 90 e 12 n and 95 e 5 s the reason behind small improvements in amplitude and correlation across multiple stations is that the free model 1 12 roms is reasonably skilled at estimating sst over the indian ocean thereby leaving little scope of improvement baduru et al 2019 relevant skill score differences murphy 1988 murphy and epstein 1989 taylor 2001 can also be used instead of rmse differences which skill scores to choose depend on the problem to be resolved and in most cases chosen subjectively in short the pas diagram presents a comprehensive picture of comparison between two products across multiple spatial locations the other diagram named as the performance across time pat diagram highlights the performance of the model across multiple time windows against reference time series like observations this diagram aids in easily interpreting the performance of the model across multiple time windows the user does not need to necessarily choose twelve time windows like the one depicted in fig 2 but can choose as many as it suits the purpose for example one can choose to compare the prediction of a model for the four seasons spring summer fall and winter of a year however if the number of such time windows are too large it may clutter the diagram thereby defeating the purpose of easy interpretation it is designed for we compare the sst at a single mooring station at the eastern equatorial indian ocean with the sst estimated from nemo using a pat diagram a very interesting feature emerges nemo performs reasonably well in reproducing sst during the boreal winter months but its performance drops during the summer months in terms of correlation normalized rmse and standard deviation this clear demarcation in model performance across seasons is realistic as is the case here and easy to interpret through pat diagrams these kinds of analyses aid the modeler in identifying the drawbacks in the model and offer an opportunity to improve the model the purpose of representation of model performance through pat is quite similar to that of the taylor diagram using the taylor diagram multiple datasets like multiple variables or a single variable at multiple locations can be evaluated by normalizing the model data with respective observation data however after normalization it is impossible to infer the variability in the observation because it provides the ratio of the variability of the observation and the model as a result it is not possible for the user to identify observation datasets representing very different variabilities in contrast the size of the solid circle on each hand of the pat diagram represents the variability of observation for the corresponding dataset such a representation would immediately enable the user to identify the datasets representing extreme variabilities in addition it allows the user to estimate all the three statistics during each time window nonetheless similar features can also be introduced in taylor diagrams also a pat diagram which has been designed to illustrate validation statistics across multiple time windows can be easily adapted to display performance statistics of a variable across multiple models with respect to an observation dataset like a taylor diagram in fig 6 we illustrate such a possibility we compare sst during 2017 from six different models products viz nemo roms ecco2 ecco4 hycom and ncep with the sst from rama mooring at 95 e 5 s it shows that the roms hycom performs best worst in simulating the observed sst pattern whereas nemo ecco2 is best worst at replicating the observed variability ecco4 nemo on the other hand best worst reproduces the amplitude of observed sst this simple exercise also highlights the need for use of skill scores to arrive at a holistic conclusion on which model best represents the observation the rmse or the observed standard deviation in the pat diagram can be replaced by the skill score which may better aid the user in concluding about the veracity of the models the pat diagram can be of use for researchers involved in the sixth phase of the coupled model intercomparison project cmip6 wherein the performance of various models is assessed one of the major drawbacks of the pat diagram is to estimate the statistics from visual inspection the user can only approximately estimate the standard deviation of the observations from the size of the circles on the hand of the clock consequently the estimation of the model standard deviation and the rmse are also approximate however the visual representation in pat enables the user to quickly compare the statistics across multiple time windows or multiple models also if the statistics across the time windows or the models exhibit little difference it would be difficult to decipher the difference since a part of the interpretation lies on visual inspection in contrast the taylor diagram will be more apt to highlight the little differences the examples presented in this study belong to the field of oceanography however both pas and pat diagrams can be extended to other fields both for scientific research and market research the sample codes in python and matlab for pas diagram and python and matlab code for pat diagram are presented in the supplementary material we encourage the research community across all fields to make use of these codes and customize them according to their own requirements credit authorship contribution statement arya paul conceptualization methodology writing original draft investigation afroosa m data curation software python validation visualization writing review editing balaji baduru data curation software matlab validation visualization writing review editing biswamoy paul data curation software python validation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are grateful to incois and the ministry of earth sciences moes for providing facilities the data assimilation system is configured as a part of the ocean modeling data assimilation and process specific observations o mascot programme coordinated by the indian national centre for ocean information services incois and funded by the ministry of earth sciences moes govt of india ref moes 36 oois o mascot 2017 all the experiments were conducted on the high performance computer aaditya iitm pune india and mihir ncmrwf delhi india m a is grateful to the council of scientific and industrial research csir for providing a research fellowship grant this is incois contribution number 479 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 102150 appendix a supplementary data the following is the supplementary material related to this article mmc s1 sample codes for pas and pat diagrams mmc s2 
23805,model states are often validated against observations to establish the veracity of the model however when a model state is compared with multiple in situ observations scattered in space no single diagram exists that can showcase the statistical measure of correlation root mean square error and the standard deviations of the concerned variables across all the locations we present a simple but efficient representation of correlation root mean square error and standard deviation of the model and the observation across multiple in situ locations in a single diagram and name it as the performance across space pas diagram we also present a diagram that showcases the comparison of model state and observation at a single location across multiple time windows in a single diagram and call it performance across time pat diagram we highlight the effectiveness of these diagrams through realistic ocean models and realistic in situ observations we show using a pat diagram that the ocean model nemo fares better in simulating ocean sea surface temperature during boreal winters compared to boreal summers we also illustrate how the pas diagrams can be used in assessing the efficacy of data assimilation though the examples shown here are from the field of oceanography the display mechanism can be extended to any field keywords model validation root mean square error correlation standard deviation data availability data will be made available on request 1 introduction most of the dynamical models stochastic or deterministic are designed to replicate some aspect of reality if not all the veracity of these models is often assessed by comparing the time evolution of the model states against the observations in simulating complex realistic phenomena like weather and ocean conditions dynamical models are prone to accumulate errors during its evolution due to a multitude of reasons like inaccurate initial conditions and boundary if it is a regional model inaccurate representation of imposed forces absence of true knowledge of model parameters empirical parameterization of small scale phenomena and many others in such cases observations are often assigned greater reliability in the absence of the knowledge of absolute truth the observed time series of a variable therefore assumes the role of the reference time series against which the performance of model states often called test time series are evaluated evaluating three statistical measures correlation root mean squared error rmse and standard deviation are the three basic steps of these assessments before delving deeper into higher orders of statistical measures correlation is a statistical measure that estimates the degree of similarity in pattern between two datasets the pearson correlation coefficient r between two time series a and b is defined as 1 r n 1 n a n a b n b n σ a σ b where n is the sample size σ a and σ b are the standard deviation of the datasets a and b respectively a n 1 n a n and b n 1 n b n represents the time mean of the two datasets respectively the standard deviation in a on the other hand is defined as σ a n 1 n a n a 2 n 1 the expression for the standard deviation in b is similar the standard deviation signifies the measure of variability of each dataset the presence of standard deviations in the denominator in eq 1 constrains the correlation coefficient r to vary between 1 and 1 if the two time series are perfectly in out of phase r assumes the value 1 1 the correlation coefficient does not however indicate the degree of departure in amplitude between the two datasets the degree of departure is reflected in the rmse between the two datasets the total rmse between the two time series a and b is defined as r m s e n 1 n a n b n 2 n the total rmse can reflect discrepancies between datasets of three major types 1 the model dataset may suffer from a bias for example this is often encountered while interpreting the time series of sea surface height at a location from models and altimeters in most cases the altimeter and the model assume different geiods leading to a bias in the model sea surface height sometimes it is meaningful to ignore the contribution of biases to the total rmse in such circumstances centered rmse is used the centered rmse is related to the total rmse through the following expression centered rmse 2 r m s e 2 a b 2 2 there may be a phase lag lead in the model dataset compared to the observation dataset one example of this is the cooling of observed and modeled sea surface temperature sst during the passage of a cyclone often the atmospheric models used to force ocean dynamics delay the genesis and subsequent evolution of the cyclone thereby leading to a phase lag in the sst estimation by ocean models compared to the observed sst cooling 3 the inability of the model to reproduce the magnitude of a physical process for example a numerical ocean model may reproduce the directions of the ocean currents but underestimate the amplitude likely because of a use of inferior wind speed to force the model compared to reality it is important to look at these three statistical measures in a holistic manner to gauge the degree of correspondence between two datasets a taylor diagram taylor 2001 is a convenient way to depict all three of these statistical measures from two time series data typically from an observation and a model at some specific location or averaged over a domain in a single diagram it is to be noted that the taylor diagram in its normal form displays centered rmse however if a model performance has to be assessed across multiple locations for instance there is not a single diagram in use to the best of our knowledge that suits the purpose the scientific community usually resorts to multiple diagrams one for each location to arrive at the effectiveness of the model a taylor diagram is sometimes used to carry out such an exercise wherein the model data at each location is normalized with respect to the corresponding observation the statistics for each such location is labeled in the taylor diagram to distinguish one from the other this makes the visual inspection of location versus statistics inconvenient and consequently may hinder region specific interpretations the resultant diagram also loses the information about the absolute variability of the observation due to normalization a single taylor diagram can also be plotted without normalization but for each point on the diagram a corresponding point would need to appear along the x axis labeled in the same way indicating the observed dimensional standard deviation in this paper a new representation is described that eases the analysis of model performance across multiple locations in addition if the performance of a model has to be assessed across multiple time windows against an in situ observation at some particular location researchers often use separate plots for each such time window to depict the model performance in terms of correlation rmse and standard deviation it is inconvenient to arrive at any holistic conclusion about the efficacy of the model from multiple diagrams a recent illustration called spectral diagram has been proposed that exhibits the coherence function power amplitude phase and skill score of discrete frequencies of two time series in a single plot calim costa et al 2022 this diagram is devised to identify synchronous patterns across different frequency bands one may also resort to a taylor diagram wherein the different time series can be normalized with respect to the corresponding observations and thereby the statistics across various time windows can be represented in a single taylor diagram the process of normalization however comes with its usual cost of losing the information of the magnitude of the variability in the observation we have devised a single diagram that assesses the model performance across multiple time windows in a single plot without sacrificing the information about the magnitude of standard deviation of the observations we have also provided sample programs for these plots so that it can be easily customized and used in section 2 we describe these plots using generic examples in section 3 we show the merits of the diagrams using a real example from the field of oceanography we also plot the corresponding taylor diagrams for these realistic examples and draw comparison between the two approaches finally in section 4 we summarize and discuss the benefits and drawbacks of these plots 2 overview of the new diagrams we have developed a simple elegant and effective way to illustrate model performance across various in situ locations in a single diagram in fig 1 we demonstrate the salient features of this illustration through a schematic diagram fig 1 depicts the model performance for an arbitrary variable at various locations in the world ocean needless to mention that the reference time series of the token variable or observation considered here are different from each other at all the locations the same stands true for the time series of the same token variable estimated from the model at each location we estimate the correlation and the root mean squared error between the observed and the modeled variable as well as the standard deviation of the observed and the modeled variable the performance of the model against these observations at all the locations are depicted using ellipses the two axes of the ellipse denote the standard deviation of the modeled and the observed variable with all dimensional quantities given in whatever units apply the zonal east west axis of the ellipse represents the standard deviation of the model while the meridional north south axis denotes the standard deviation of the observed data if the ellipse is stretched in the north south east west direction the model underestimates overestimates the standard deviation of the observation in essence if the model manages to reproduce the standard deviation of the observation both the axis length will be identical and the ellipse will reduce to a circle the standard deviation scale can be represented using a circle whose radius presents the scale of the standard deviation in appropriate units one can therefore deduce the standard deviation of the observation and the model from the size of the ellipse the color within the ellipses represent the correlation the total or centered rmse is depicted in numbers beside each ellipse we call this representation the performance across space pas diagram in fig 1 we would like to draw your attention to three distinct locations marked as a eastern indian ocean b central pacific ocean and c western atlantic ocean to illustrate how to interpret the pas diagram we observe that the correlation between the modeled and the observed variable is greater than 0 5 maroon color at the location marked a it also depicts that the model correctly estimates the standard deviation of the token variable compared to the observed standard deviation and consequently the ellipse is reduced to a circle the rmse at this location is depicted in numbers 1 25 beside the ellipse at location b the model overestimates the standard deviation of the token variable compared to the observed standard deviation as a result the ellipse is stretched in the east west direction the correlation between the modeled and the observed variable is around 0 3 red color whereas the rmse of the modeled variable with respect to the observation is depicted in numbers 0 42 beside the ellipse at location b at location c the model underestimates the standard deviation of the observed variable consequently the ellipse is stretched in the north south direction at location c the rmse is 0 56 and the correlation at c is greater than 0 5 maroon color the representation of the model performance through this type of diagrams offers the following advantages 1 a single diagram can illustrate the model performance at various locations scattered across the domain instead of looking at the model performance at multiple locations through multiple single diagrams it is however possible to represent the statistics of several locations in a single taylor diagram using labels for each location in such a diagram the model data at each location is normalized with the corresponding observed data i e one can extract the ratio of the variability of the observed and modeled data but the information about the absolute amplitude of variability in the observation is lost due to normalization one can also choose not to normalize the model data at each location this shall result in multiple points on the x axis denoting the standard deviations at each location and compromises but possible the interpretability of the diagram the pas diagram suffers from no such drawback 2 it clearly illustrates the locations at which the model underperforms and the locations at which the model performs satisfactorily a visual representation like pas is likely to highlight specific regions where the model needs improvement which may be otherwise tedious to discern for example if there are ellipses oriented along the north south direction confined within a specific region or basin one can safely conclude that the model underestimates the observed variability within that region basin and therefore offers opportunity for trouble shooting such a possibility may exist in reality most of the parameterization schemes in use in the state of the art general ocean circulation models were formulated from observational campaigns carried out mostly in the pacific ocean large and gent 1999 li et al 2001 and the atlantic ocean halliwell 2004 because of which the indian ocean remains under represented in the formulation of the parameterization schemes pas diagram makes it easier to evaluate model performance at various in situ locations in a single diagram however it cannot be used if the model performance has to be evaluated at a specific location but for different time windows or if multiple variables from a model at a particular location or averaged over a domain are to be validated one way to represent such statistics is to rely on a taylor diagram in such cases each of the model datasets needs to be normalized with respect to the corresponding observed dataset and plotted in a single taylor diagram it will however not be possible to extract the absolute variability of the data from such a diagram since the data has been normalized also each different dataset needs to be labeled to differentiate it from the other and it may be inconvenient to draw correspondence between the statistics and the labels another option is to note down these three statistical measures at one place in tabular form for all the time windows it however remains difficult but possible to discern meaningful inferences from such a tabular representation it is easier to draw inferences from a pictorial diagram than from a tabular representation because diagrams present unambiguous clarity we have therefore developed a performance across time pat diagram to represent the model performance across multiple datasets pat diagram also resorts to labeling the datasets but it is designed to be self explanatory in fig 2 we schematically illustrate the efficacy of this diagram and explain how to interpret this diagram in fig 2 we evaluate the performance of an hypothetical model against an hypothetical observation at a specific location for an arbitrary variable for each month of a year and schematically represent the statistics of twelve months using a circular clock like diagram for example a daily arbitrary model variable is compared with a daily observation for each month of a year i e 30 samples of model variable are compared with 30 observation samples for a month the statistics are estimated from these 30 samples for a month and this exercise is repeated for all the months of the year each hand of this clock embodies the statistical measure of correlation between the model variable and observation and standard deviation of the model and observation corresponding to the month it is pointing towards in the diagram the color of the hand represents the correlation if the standard deviation of the observation model exceeds the standard deviation of the model observation the hand of the clock is represented as a solid dotted line this allows the user to immediately interpret if the model underestimates when the hand is solid or overestimates when the hand is dotted the observed variability we also normalize the length of the hand such that it is always unity if the standard deviation of the observation is larger smaller the length of the hand represents the standard deviation of the observation model this ensures that the length of the hand always remains unity and the user does not need to tune the radius of the clock if the hand is a solid dotted line the distance of the solid black circle on the hand from the origin of the clock represents the standard deviation of the model observation normalized with the standard deviation of the observation model the size of the radius of the solid black circle always reveals the standard deviation of the observation the scale of this standard deviation is represented by the radius of the solid black circle on the top right corner of the plot the numbers on the outer periphery of the clock depicts the ratio of the total rmse and the observation standard deviation i e normalized rmse corresponding to each time window this kind of representation depicts the correlation the normalized rmse the ratio of standard deviation of the observation and the model and the standard deviation of the observation across various time windows in a single diagram for example in this hypothetical schematic diagram the model performs reasonably well in the months of december to march the correlation is high the rmse is low and the model reasonably manages to simulate the standard deviation of the observation during december to march the model however overestimates the observed variability during february and march in contrast the correlation is negative rmse is high and the model largely underestimates the standard deviation of the observation during the months of october and november in short the model performs quite poorly during the months of october and november but reasonably well during december to march the pat diagram displays statistical measures gauging agreement between two datasets in several ways helpful to users 1 the users can quickly identify the time windows during which the model behavior is satisfactory and the time windows during which the model needs additional fine tuning 2 this diagram also allows the user to immediately identify the time window during which observation dataset exhibit extreme variabilities for example there is largest smallest variability in observation during january september 3 the inclusion of absolute magnitude of the standard deviation of observation in the pat diagram ensures that the readers can estimate the absolute values of the standard deviation of the model and the total rmse between the two datasets if required 4 the pat diagram may also be easily adapted to compare the performance of various models against an observed time series data the labels depicting different months in fig 2 needs to be replaced by different models and the statistics between the models and the observation can be similarly displayed it can also be easily adapted to compare multiple variables in a model in the next section we will use real observation data and a realistic ocean model to showcase the applicability of these diagrams in the field of oceanography we will also compare these diagrams with the corresponding taylor diagrams to highlight the advantages and drawbacks of these diagrams 3 realistic example for pas and pat there are 26 in situ rama moorings mcphaden et al 2009 in the indian ocean for the period 2010 2019 that record daily temperature data up to a maximum depth of 750 m we choose 16 moorings out of 26 moorings to showcase the efficacy of pas diagram we did not choose all the 26 moorings for comparison to avoid clustering and overlapping of the ellipses all the observations presented here in this study have gone through the same quality control procedures as mentioned in freitag et al 1999 we compare the daily surface temperature recorded by these 16 moorings with the daily surface temperature estimated by the ocean model nucleus for european modeling of the ocean nemo version 3 6 stable madec et al 2014 lellouche et al 2018 the choice of variable in this study i e sst is arbitrary and is solely meant to illustrate the pas diagram the annual cycle of sst which is the most dominating period rai and pandey 2008 rao and goswami 1988 has been removed from both the model data and the observations before comparing in fig 3a this model is coupled to the louvain la neuve lim3 sea ice model rousset et al 2015 this model spans the global domain at a nominal resolution of 1 12 the resolution is 9km at the equator 7km at mid latitudes and 2km near the poles the model consists of 75 vertical levels the initial condition of the model is obtained from a 30 year spin up using the european centre for medium range weather forecasts ecmwf forcings dee et al 2011 subsequently the model is forced with six hourly national centre for medium range weather forecasting fluxes prasad et al 2014 from january 2009 and is run till august 2019 the model is forced with the following fluxes wind radiative fluxes air temperature rain and specific humidity more details about the model configuration can be found in afroosa et al 2021 most of the ellipses show small eccentricity except at 100 e 8 s 65 e 15 n and 55 e 12 s thereby implying that nemo manages to capture the sea surface temperature sst variability reasonably well across most of the locations at the northernmost station in the arabian sea the model variability exceeds the observed variability whereas at the easternmost station in the equatorial indian ocean the model fails to reasonably reproduce the observed variability as a result the ellipse is oriented along the north south direction at the northernmost station in the arabian sea and elongated along the east west direction at the easternmost station in the equatorial indian ocean the correlation between the two sst time series is always greater than 0 8 99 significant across all the stations except at 100 e 8 s i e the model manages to reproduce the phases of the observed sst reasonably well the total rmse is always below 1 c except at the easternmost station in the equatorial indian ocean viz 100 e 8 s where it is almost close to 2 c the correlation also is the lowest at this location and the model largely underestimates the standard deviation of the observation pas diagram clearly demonstrates that the model is least effective at this location compared to other locations and therefore offers opportunity for the future development of the model also the sst variability both observed and model is modest in the equatorial indian ocean and gradually increases poleward in fig 3b we replot the same statistics as in fig 3a but using a taylor diagram the model data at each location labeled using distinct colors is now normalized with respect to their corresponding observations the model standard deviation at all locations is in close proximity to the observation standard deviation except at 100 e 8 s and 65 e 15 n as expected i e this inference is identical to the one we arrived at from the pas diagram the taylor diagram with normalization however fails to indicate that the largest variabilities in both observations and model are seen away from the equator even though all the statistics are tagged to a location it remains difficult to assess the spatial variability of the statistics from a taylor diagram in contrast it is easy to identify from taylor diagrams all locations which show similar variability compared to a pas diagram for example it appeared through visual inspection from the pas diagram that the model falls short by some significant margin in reproducing the observed variability at 55 e 12 s which is misleading as can be seen in the taylor diagram blue square in fig 3b the mooring at 95 e 5 s is highlighted in fig 3a using a black arrow the standard deviation of the model in sst over the period of 9 years appears to reasonably represent the standard deviation of the observation the ellipse looks close to a circle how well does the model manage to reproduce the observed variability in sst if we analyze it over monthly durations instead of analyzing the entire time series of 9 years in fig 4a we plot the pat diagram highlighting model nemo performance in sst estimation annual cycle removed with respect to a rama mooring stationed at 95 e 5 s we collate daily sst data from the model and the rama mooring for each month during the 9 year period for example we collate the daily sst data during all the january months for the period 2010 19 from both the model and the rama mooring this will result in two time series with 31 9 279 model sst data and 279 observed sst data corresponding to the month of january the same exercise is repeated for the rest of the eleven months of a year we then compute the statistics of the performance of the model for each month and plot the pat diagram the correlation is positive for all the months it is particularly promising for the months of december march the normalized rmse total rmse divided by observation standard deviation remains less than 1 3 across all the months the normalized rmse exceeds unity during june october and november signifying that the rmse in the model is larger than the variability in the observation the largest variability in sst is observed during the months of january and february whereas the least variability is observed in the month of may which is about 3 4 times smaller than the observed largest variability the model underestimates the variability by a small margin in the observation during november and february to april but overestimates during the rest of the months in terms of estimating the sst variability the model performs best worst during february november september the correlation in may and june is rather weak we can infer that the model is good to simulate the observed sst at 95 e 5 s during november to april in contrast the performance of the model degrades during may to october in terms of correlation in particular during september the pat diagram exhibits the worst estimation of standard deviation and a reasonably large rmse the relative inaptitude of the model during the boreal summer months can be because of a variety of reasons ranging from possible errors in the atmospheric fluxes during boreal summer or because the parameterization schemes employed in the model are less accurate during summer in short the pat diagram highlights the degree of efficiency of nemo across various months and calls for corrective measures during the boreal summer months in fig 4b we replot the above statistics using a taylor diagram each of the 12 model datasets is normalized with the corresponding observation dataset this is to remind the readers that the taylor diagram in its normal form displays the centered rmse normalized with the standard deviation of the observation in contrast pat diagram fig 4a displays the total rmse normalized with the standard deviation of the observation as a result there are differences in the rmse values depicted in fig 4a and b the taylor diagram reiterates that the correlation between the two time series is best worst during the months of december march may june the model underestimates the variability by a small margin in the observation during november and february to april but overestimates during the rest of the months in terms of estimating the sst variability the model performs best worst during february november september in short the taylor diagram can also indicate these salient features in the statistics across the months however unlike the pat diagram it is not obvious but discernible that the model is underperforming during the boreal summer months it is also not apparent from the taylor diagram that the observation displays largest variability during the month of january and february and smallest variability during may it is nevertheless possible to introduce such a feature in the taylor diagram for example linking the size of the squares with the observation standard deviation shall serve this purpose but unlike the pat diagram this runs the greater risk of squares overlapping each other because the display of a typical taylor diagram is constrained in a quadrant provided all correlations are positive in contrast to the availability of all the four quadrants to display the pat diagram however the clustering of the data in the taylor diagram immediately indicates that the model displays similar behavior across months such an interpretation is not obvious immediately but discernible from a pat diagram in short the taylor diagram can exhibit all the features that are present in the pat diagram but may be inconvenient while interpreting certain statistics 4 summary and discussion this paper presents two simple but easy to interpret diagrams about comparing time series data from two different sources one diagram which we call the performance across space pas diagram represents the performance of a model time series against an observation time series for any particular variable across multiple in situ locations using ellipses around the locations of the observations pas diagrams highlight the strengths and drawbacks of the veracity of the model across space though we have used examples from the field of oceanography it can be easily extended to other fields there exist similar diagrams using ellipses that depict errors in the global positioning system gps community these ellipses represent the error in velocities measured by the gps stations in a similar way as the one mentioned here along with an arrow that showcases the velocity magnitude and direction a 2 2 covariance matrix is also often represented using an ellipse with the eigenvectors of the covariance matrix pointing towards the two axes another representation named as sailor diagrams has been devised to compare vector quantities like ocean currents and winds from multiple models with respect to an observation dataset sáenz et al 2020 it is based on the two dimensional structure of the mean error squared matrix derived from the models and the observation the mismatch in terms of the eccentricity and the orientation of the model ellipse with respect to the observation ellipse indicates the degree the departure between the two datasets the evolution of tidal currents over one time period is also often depicted using an ellipse called tidal ellipses in such a representation the velocity vector of the corresponding tidal constituent trace the perimeter of the ellipse during one time period in contrast the ellipses in the pas diagram are meant to represent the statistics of any two dimensional scalar variable unlike the vector velocity errors in the gps community to represent velocity conformity using a pas diagram one needs to plot separate pas diagrams for each component of the velocity the pas diagram illustrated here is two dimensional in nature it is technically possible to extend it to three dimensions for example one can represent the performance of a model across depths at various in situ locations using ellipses at each depth there are platforms like matlab that allow a 3d representation of a diagram however it will be aesthetically challenging to cleanly represent the model performance across multiple depths for many in situ locations in a single diagram unless it allows the reader user to interactively alter the orientation of the diagram such an interactive possibility is very much on the cards in the near future this diagram will also be of little use if the in situ observations are very densely located for example if dense satellite derived products like sst sea level anomaly sea surface salinity etc are to be compared with models at each observation location pas will be ineffective in such a scenario the ellipses around these locations will overlap thereby rendering the interpretation of this diagram difficult in short the two adjacent locations at which the time series are compared should be sufficiently wide apart to avert overlapping of the ellipses we have shown using the pas diagram how the ocean model nemo fares in reproducing the observed sst variability across multiple different mooring stations in the indian ocean whereas nemo fares reasonably well in reproducing the observation in terms of correlation variability and rmse across most of the locations it appears to fare below par in the eastern indian ocean pas diagram thereby highlights the eastern indian ocean to be a region of concern for modelers working with nemo for researchers it highlights that any process studies at the eastern indian ocean using ocean states simulated by nemo needs to be judiciously performed pas diagrams can also be used to compare the performance of two different models against the same observation the two axes of the ellipse can then be the normalized standard deviation of the two models with respect to the standard deviation of the observation the unit normalized standard deviation of the observation can be represented as circles superimposed on the ellipses if any of the axis length of the ellipse is more less than the radius of the circle the corresponding model overestimates underestimates the observed variability the color of the ellipse can be the difference in correlation between the two models whereas the difference in total or centered rmse between the two models can be highlighted as text beside each ellipse instead of comparing two models one can also choose to compare the background also called prior or a free run and analysis also known as posterior during data assimilation exercises in such a scenario pas can highlight if the process of assimilation has indeed resulted in improvements in terms of variability correlation and rmse in the background state of the model or the free run and at what regions it has improved or deteriorated thereby enabling the modeler to further fine tune the model or assimilation in fig 5 we demonstrate such a possibility using an assimilated product using 1 12 regional ocean modeling system roms baduru et al 2019 francis et al 2020 and a free run of 1 12 roms for the indian ocean we look at the improvements or degradations in sst annual cycle removed after assimilation at 18 different in situ locations wherein sst is observed through moorings at each of these locations in the indian ocean all the sst observations from these 18 moorings are assimilated the purpose of this exercise is to highlight the efficacy of the pas diagram and not to highlight the effectiveness of the assimilation we estimate the difference in correlation and total rmse between the analysis and the free run across all these locations for the period september 2016 september 2018 two years δ corr corr analy sis corr free δ rmse rmse analy sis rmse free a positive negative δ corr and a negative positive δ rmse represents improvement degradation the standard deviations from these two products at each location are normalized with the standard deviation of the observation a elongated ellipse in the east west north south direction represents a larger standard deviation in the free run analysis the variability in the free run and the analysis at each location is compared with the circle superimposed over the ellipse for example consider the buoy located at 95 e 8 s the east west axis of the ellipse exceeds the radius of the superimposed circle signifying that the free run overestimates the observed variability the north south axis of the ellipse however is the same as the radius of the circle i e the assimilation has managed to restore the standard deviation of the analysis the reverse occurs at 67 e 4 s where the analysis overestimates the standard deviation however assimilation improves the variability in the model across most of the locations pas diagram also reveals that assimilation has improved the correlation across most of the mooring stations except at 67 e 12 s the δ rmse in sst is negative across the majority of the stations indicating that assimilation has improved the sst amplitude except at 90 e 12 n and 95 e 5 s the reason behind small improvements in amplitude and correlation across multiple stations is that the free model 1 12 roms is reasonably skilled at estimating sst over the indian ocean thereby leaving little scope of improvement baduru et al 2019 relevant skill score differences murphy 1988 murphy and epstein 1989 taylor 2001 can also be used instead of rmse differences which skill scores to choose depend on the problem to be resolved and in most cases chosen subjectively in short the pas diagram presents a comprehensive picture of comparison between two products across multiple spatial locations the other diagram named as the performance across time pat diagram highlights the performance of the model across multiple time windows against reference time series like observations this diagram aids in easily interpreting the performance of the model across multiple time windows the user does not need to necessarily choose twelve time windows like the one depicted in fig 2 but can choose as many as it suits the purpose for example one can choose to compare the prediction of a model for the four seasons spring summer fall and winter of a year however if the number of such time windows are too large it may clutter the diagram thereby defeating the purpose of easy interpretation it is designed for we compare the sst at a single mooring station at the eastern equatorial indian ocean with the sst estimated from nemo using a pat diagram a very interesting feature emerges nemo performs reasonably well in reproducing sst during the boreal winter months but its performance drops during the summer months in terms of correlation normalized rmse and standard deviation this clear demarcation in model performance across seasons is realistic as is the case here and easy to interpret through pat diagrams these kinds of analyses aid the modeler in identifying the drawbacks in the model and offer an opportunity to improve the model the purpose of representation of model performance through pat is quite similar to that of the taylor diagram using the taylor diagram multiple datasets like multiple variables or a single variable at multiple locations can be evaluated by normalizing the model data with respective observation data however after normalization it is impossible to infer the variability in the observation because it provides the ratio of the variability of the observation and the model as a result it is not possible for the user to identify observation datasets representing very different variabilities in contrast the size of the solid circle on each hand of the pat diagram represents the variability of observation for the corresponding dataset such a representation would immediately enable the user to identify the datasets representing extreme variabilities in addition it allows the user to estimate all the three statistics during each time window nonetheless similar features can also be introduced in taylor diagrams also a pat diagram which has been designed to illustrate validation statistics across multiple time windows can be easily adapted to display performance statistics of a variable across multiple models with respect to an observation dataset like a taylor diagram in fig 6 we illustrate such a possibility we compare sst during 2017 from six different models products viz nemo roms ecco2 ecco4 hycom and ncep with the sst from rama mooring at 95 e 5 s it shows that the roms hycom performs best worst in simulating the observed sst pattern whereas nemo ecco2 is best worst at replicating the observed variability ecco4 nemo on the other hand best worst reproduces the amplitude of observed sst this simple exercise also highlights the need for use of skill scores to arrive at a holistic conclusion on which model best represents the observation the rmse or the observed standard deviation in the pat diagram can be replaced by the skill score which may better aid the user in concluding about the veracity of the models the pat diagram can be of use for researchers involved in the sixth phase of the coupled model intercomparison project cmip6 wherein the performance of various models is assessed one of the major drawbacks of the pat diagram is to estimate the statistics from visual inspection the user can only approximately estimate the standard deviation of the observations from the size of the circles on the hand of the clock consequently the estimation of the model standard deviation and the rmse are also approximate however the visual representation in pat enables the user to quickly compare the statistics across multiple time windows or multiple models also if the statistics across the time windows or the models exhibit little difference it would be difficult to decipher the difference since a part of the interpretation lies on visual inspection in contrast the taylor diagram will be more apt to highlight the little differences the examples presented in this study belong to the field of oceanography however both pas and pat diagrams can be extended to other fields both for scientific research and market research the sample codes in python and matlab for pas diagram and python and matlab code for pat diagram are presented in the supplementary material we encourage the research community across all fields to make use of these codes and customize them according to their own requirements credit authorship contribution statement arya paul conceptualization methodology writing original draft investigation afroosa m data curation software python validation visualization writing review editing balaji baduru data curation software matlab validation visualization writing review editing biswamoy paul data curation software python validation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are grateful to incois and the ministry of earth sciences moes for providing facilities the data assimilation system is configured as a part of the ocean modeling data assimilation and process specific observations o mascot programme coordinated by the indian national centre for ocean information services incois and funded by the ministry of earth sciences moes govt of india ref moes 36 oois o mascot 2017 all the experiments were conducted on the high performance computer aaditya iitm pune india and mihir ncmrwf delhi india m a is grateful to the council of scientific and industrial research csir for providing a research fellowship grant this is incois contribution number 479 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 102150 appendix a supplementary data the following is the supplementary material related to this article mmc s1 sample codes for pas and pat diagrams mmc s2 
23806,the coast of central chile has multiple rivers with a marked seasonal discharge variability few studies have addressed primarily the seasonal variability of river plume extension and vertical structure here we have analyzed the effects of multiple river outflows on the hydrography salinity and density and meridional transports off central chile this study is focused on synoptic and intraseasonal scales of variability using eight years of semi realistic model outputs our results reveal that the plume spreading is much broader during winter than spring wind driven changes in plume shapes modulate the geostrophic component of the flow field off biobío and itata rivers in winter spring after downwelling upwelling favorable winds the geostrophic flow was important off mataquito and maule rivers after upwelling favorable winds primarily in spring the stratification in winter was mostly associated with the freshwater content in all coastal regions and showed a rapid response to the wind stress forcing the mixing through wind stress decreased in spring modifying the stratification and uncoupling the wintertime variability between stratification and freshwater keywords river plumes wind driven flows freshwater transport continental shelves eastern boundary systems data availability data will be made available on request 1 introduction rivers contribute about 95 of sediment input into the oceans syvitski et al 2003 influencing coastal processes due to the downward particle fluxes and the accumulation of river borne constituents rivers also deliver freshwater with organic and inorganic constituents syvitski et al 2003 goñi et al 2013 vargas et al 2016 curra sánchez et al 2022 with significant biogeochemical implications on coastal ecosystems hickey et al 2010 typical biogeochemical characteristics of river outflows are to be acidic relative to the receiving coastal ocean waters salisbury et al 2008 tend to have higher levels of intrinsic growth rates of phytoplankton hickey et al 2010 liu and dagg 2003 and higher chlorophyll concentrations relative to other coastal regions hickey et al 2010 grez et al 2020 among others moreover river outflows are constantly mixed over the continental shelf which modifies the dynamics of coastal ecosystems horner devine et al 2015 coastal systems with significant input of freshwater discharges are known as region of freshwater influence rofi simpson 1997 in these regions a river discharge forms a buoyant plume hetland 2005 horner devine et al 2015 that spreads in response to the wind wave forcing coastal currents bathymetry and coriolis horner devine et al 2015 studies of coastal river plumes have investigated the influence of topography and ambient flow on plume dispersal chapman and lentz 1994 simpson 1997 warrick and stevens 2011 the plume trapping to the surface bottom fong and geyer 2002 garvine 1995 the influence of wind forcing on plume spreading and cross shore transport lentz and largier 2006 hickey et al 1998 the influence of tides on plume structure and variability chen 2014 isobe 2005 rijnsburger et al 2018 and mixing transport processes associated with river plumes horner devine et al 2015 ivey et al 2008 observational studies have mainly focused on large river plumes such as the columbia i e hickey et al 1998 2005 mississippi i e walker 1996 liu and dagg 2003 or amazonas i e geyer and beardsley 1995 trowbridge and kineke 1994 aguiar et al 2022 small mountainous rivers smr produce smaller local plumes however their combined area cover with watershed sizes ranging from 10 to 10 000 km 2 is larger than the plume area from a large river with the same watershed size warrick and fong 2004 studies evaluating the impact of smr in the coastal ocean have increased lately including biogeochemical aspects such as the input of sediments and terrestrial materials milliman and farnsworth 2011 goñi et al 2013 warrick and farnsworth 2017 wheatcroft et al 2010 and the coalescence of plumes from several smr in eastern boundaries warrick and farnsworth 2017 saldías et al 2012 saldías et al 2016 mendes et al 2017 saldías et al 2020 in general coastal oceanography studies along central southern chile have mainly focused on aspects of coastal upwelling strub 1998 escribano and schneider 2007 sobarzo and djurfeldt 2004 rutllant et al 2004 the influence of climate variability saldías et al 2016 grez et al 2020 and lately on freshwater outflows and plumes on seasonal and interannual scales saldías et al 2012 saldías et al 2016 masotti et al 2018 salcedo castro et al 2020 studies evaluating the variability on shorter scales are scarce and centered on individual river plumes e g piñones et al 2005 studies assessing the seasonal and interannual variability of plume spreading have primarily used observations from field surveys and satellite imagery saldías et al 2012 saldías et al 2016 which limits the vertical and horizontal scales of impact to be evaluated using a threshold value in modis moderate resolution imaging spectroradiometer imagery to detect turbid river plumes saldías et al 2012 resolved the seasonal variability of several river plumes off central chile larger smaller plumes are formed during winter summer which correlates with high low river discharges the major cape of the region punta lavapié pl fig 1 seems to be an inflection point on the role that the wind plays in the surface circulation the wind stress is nearly northward year round north of pl based on seasonal averages whereas it has a seasonal variability with a northward southward direction in austral summer winter south of pl letelier et al 2009 only one modeling study has addressed the river influence on the circulation and hydrographic conditions off central chile and has clarified the seasonal variability of the maipo and rapel river plumes salcedo castro et al 2020 nonetheless that study was not focused on a large latitudinal extension with multiple river outflows only two of them and focused solely on seasonal averages the present work seeks to improve our knowledge of the intraseasonal hydrographic and flow variability along central chile considering the region influenced by four smr emphasizing the influence of the wind forcing on the freshwater content stratification and meridional transport we assess the freshwater conditions and transports in the coastal system using a numerical model that considers the main river outflows between 34 30 s and 38 00 s for this purpose eight years of semi realistic modeling outputs were analyzed the study region and methods are described in section 2 section 3 contains the main results in section 4 the discussion is presented whereas the summary is finally highlighted in section 5 2 study area and methods 2 1 study area the study area covers the coastal ocean off central chile between 34 30 s and 38 00 s and 75 00 w and 72 30 w fig 1 four smr influence the hydrography and circulation of the coastal ocean the mataquito maule itata and biobío river with watershed sizes ranging from 6 300 km 2 mataquito to 24 000 km 2 biobío these rivers are influenced by rainfall and snow melting and have a strong seasonal variability with maximum minimum discharges during austral winter summer saldías et al 2012 saldías et al 2012 showed that the plumes from these rivers merge during high rainfall events and southward winds during winter spring furthermore this region is affected by the south pacific anticyclone spa which influences the wind field and affects the evolution of the plumes and the mixing of the water column sobarzo et al 2007 2 2 implementation of the regional ocean modeling system the hydrodynamic model employed in this study was a configuration of the regional ocean modeling system roms shchepetkin and mcwilliams 2003 2005 roms is a three dimensional free surface terrain following numerical model that solves the navier stokes equations using reynolds mean hydrostatic and boussinesq approximation haidvogel et al 2008 the model grid forcing boundary and initial conditions were built using the romstools package penven et al 2008 the rectangular domain covers from 30 s to 40 s in latitude and from 70 w to 81 w in longitude with three lateral open boundaries to the north south and west the horizontal resolution is approximately 3 km the model has 32 terrain following vertical levels s coordinates that are stretched to obtain a higher resolution at the surface the s coordinates are well adapted to study shelf dynamics lemarié et al 2012 mcgrath et al 2020 the model was configured with an split and rotated 3rd order upstream biased advection scheme recommended for realistic applications with variable bottom topography the bathymetry was taken from the gebco 2020 topography data gebco 2019 which has a resolution of approximately 500 m and was smoothed using a smoothing parameter r 0 25 controlling the slope of the sigma layers haidvogel et al 2000 the minimum depth h m i n of the model bathymetry was set to 20 m taking in account the horizontal resolution of our model the extension of the study area and the complexity of bottom topography since the main objective of our study was to analyze the response of several buoyant rivers plumes to wind forcing the configuration of the model aimed to have a higher vertical resolution on the surface by using a vertical transformation design with surface and bottom stretching parameters θ b 0 θ s 6 and vtransform 2 the baroclinic time step of the model was set to 100 s the initial and lateral boundary conditions for the model were derived from the interannual fields from the estimating the circulation and climate of the ocean ecco consortium which has a temporal resolution of 10 days and a 1 1 horizontal resolution stammer et al 1999 the forcing fields containing wind stress air temperature air density relative humidity specific humidity air sea fluxes evaporation and precipitation fluxes were extracted from the 6 h national centers for environmental prediction ncep2 reanalysis kalnay et al 1996 with a horizontal resolution of 1 9 1 9 the original grid was linearly interpolated to the model grid the forcing fields were computed by using the bulk formula of fairall et al 1996 the k profile parameterization kpp scheme large et al 1994 was used to compute the vertical mixing in the model finally the simulated period was 2001 2010 with one year of spin up after which our analyses suggested numerical stability 2 3 incorporation of river runoff into the model monthly river discharge data were obtained from the dirección general de aguas dga http www dga cl database for the period 2001 2010 monthly river runoff was introduced in the model as a volume of freshwater in the continuity equation according to the spatial resolution of the model 3 km each river was represented by a single grid point source at the location of the river mouth fig 1 for all rivers the salinity of the freshwater flow was 0 1 psu to ensure roms stability and considering that this value is close to the salinity of riverine waters the temperature was set constant throughout the year but variable between rivers according to the meridional pattern of average temperatures reported in ministerio del medio ambiente 2010 the rationale to use monthly river data is that having smoothly changing monthly river discharges helps to clarify the response of coastal ocean circulation to the synoptic wind forcing by filtering the high frequency pulses of river discharges we refer to our model as semi realistic due to the lack of high frequency river discharges 2 4 remote sensing data daily remote sensing data from the modis aqua mission were used to compare our model outputs with the surface reflectance associated with the turbid river plumes high resolution 1 km l2 files were obtained from the nasa website https oceancolor gsfc nasa gov with swaths containing at least 75 of the area inside the box 34 5 38 s 68 78 w during 2002 2010 which accounts for 2898 files these files were used to generate fields of remote sensing reflectance at 645 nm rsr 645 sr 1 because of its capability to detect and delineate river plumes e g saldías et al 2016 mendes et al 2017 salcedo castro et al 2020 flores et al 2022 2 5 freshwater content transport and potential energy anomaly the freshwater content fwc m was computed following blanton and atkinson 1983 1 fwc d 0 r s s z r s d z where s z is the salinity as a function of depth z r s is the reference salinity and d is the depth at which the reference salinity is located this magnitude represents how many meters of purely freshwater are in the water column according to silva et al 2009 the antarctic circumpolar current acc reaches the chilean coast around 42 48 s where it splits into a northern humboldt current hc and southern cape horn current chc branches in particular the hc transports surface sub antarctic waters saaw northward and affects the upper ocean up to 30 s hence our study region is highly affected by waters of low temperature 11 5 c and relatively low salinity 33 8 silva et al 2009 since the saaw impinges our study region from the south freshwater conditions imposed by saaw and river plumes can overlap in the quantification of fwc when the reference salinity is considered as rs 33 8 the depth of the isohaline is greater supplementary material figure s1 than when using rs 33 6 e g fig 5 thus the amount of freshwater increases with rs 33 8 due to the depth of the isohaline we take r s 33 6 as reference salinity to quantify only freshwater from rivers and to filter out the contribution from the saaw to assess the meridional freshwater transport mft m 2 s 1 the product of the fwc and the meridional velocity v x z is integrated 2 mft d 0 v x z r s s z r s d z the total meridional transport mtt m 2 s 1 was computed by integrating the velocity field through the entire water column 3 mtt z 0 v x z d z where z is the depth of the water column we use the potential energy anomaly pea j m 3 simpson 1981 to investigate the vertical stratification due to the freshwater input from rivers in the area pea is the amount of energy required to homogenize the entire water column vertically and its given by simpson 1981 4 pea 1 h h 0 g z ρ ρ d z where ρ 1 h h 0 ρ d z is the depth averaged density ρ is the density profile g is the gravitational acceleration and h is the water column depth zonal transects and time series of pea and fwc were analyzed together to evaluate the impact of the fwc on the stratification when these curves have the same zonal shape i e they are highly correlated it suggests that freshwater plays a key role stratifying the water column e g saldías et al 2019 a linear regression model for curve fitting with least squares was implemented between curves of fwc and pea emery and thomson 2004 3 results 3 1 satellite data validation fig 2 shows the monthly mean rrs 645 fields from modis sea surface salinity sss and the freshwater content fwc from our model satellite data shows that plumes are relatively small during austral summer fall jan mar may fig 2a b c our model agrees with the general seasonal variability evidenced in the satellite data there are small plumes next to the river mouths in january and march fig 2a b versus fig 2d e whereas larger plumes develop in may fig 2c f the fwc shows that the plume s impact is limited to the nearshore area fig 2g h i during the austral winter fall jul sep nov both modis and our model show larger plume signals the river plumes spread over most of the continental shelf in winter 0 200 m isobath especially in july and september fig 2j k m n p q despite the higher discharge of the four rivers during july august see fig 3c the model shows larger plume spreading in the gulf of arauco goa fig 1 during september and november which is not well supported by the satellite data fig 2k l n o q r this lack of agreement could be the result of 1 the lack of daily variability in the river forcing 2 the use of daily satellite images partially biased towards cloud free days in which the river discharge should be lower due to the lack of rain and or 3 the low resolution of the wind forcing 1 9 1 9 affecting the dynamics of the coastal ocean 3 2 seasonal variability of meridional wind stress and river discharges on average the zonal wind stress component is low on the study region throughout the year fig 3a and an inversion from positive to negative zonal wind component occurs around april principally north of pl the meridional wind stress is on average upwelling favorable along the entire coastal band in summer and the maximum stress occurs around pl at the beginning of summer fig 3b a transition to downwelling favorable winds occurs in early fall apr may jun along the entire study region on average downwelling favorable winds occur along the entire coastal ocean in winter jul aug sep downwelling winds are maximum towards the southern region and are slightly reduced in the central area during winter a transition to upwelling favorable winds occurs at the beginning of spring oct nov dec which increase in magnitude towards the end of the year consequently both the fall and spring are transition seasons for the meridional wind stress forcing fig 3b fig 3c shows the seasonal variability of river discharge the lowest river discharge occurs for all rivers in summer whereas maximum discharges occur in july august fig 3c d following the period of high discharge the outflow decreases progressively during spring fig 3c d the biobío river has the largest discharge in the study region it is the third largest watershed in chile reaching a maximum average discharge of almost 2000 m 3 s 1 on average the maximum values of maule and itata rivers reach the 1000 m 3 s 1 whereas mataquito only reaches 250 m 3 s 1 3 3 synoptic plume variability winter versus spring conditions we consider the response of the water column to different wind forcing conditions next to the river mouths two events with contrasting wind forcing were selected to assess the response of the river plumes water column stratification and freshwater content in winter and spring fig 4 in winter the meridional wind started to blow southward on august 20 and the maximum magnitude 0 5 n m 2 occurred on august 23 fig 4a the plumes rotated southward within this period fig 4c d the maule itata and biobío plumes were attached to the coast one or two days after the maximum meridional wind stress fig 4d e the plumes detached from the coast by august 29 in response to the change of wind stress conditions which became upwelling favorable on august 28 fig 4f low salinity waters were advected north northwestward in spring fig 4g i the meridional wind blew northward during october 26 30 and the maximum magnitude 0 1 n m 2 occurred on october 28 fig 4b the plumes extended northward off maule and itata river mouths while the biobío plume spread northwestward until october 29 one day after the maximum meridional wind stress fig 4i the plume was attached to the coast with northward advection off maule meanwhile the biobío plume showed a southward rotated branch offshore and a coastal branch advected into the gulf of arauco by october 31 fig 4j fig 5 shows cross shore salinity sections on august 25 and october 30 1 2 days after the maximum wind stress to evaluate the response of the water column the frontal position of the buoyant plume was delimited by the position of the 1025 kg m 3 isopycnal a wedge of low salinity was observed adjacent to the coast and confined in a small cross shore section off all rivers after a period of downwelling favorable winds in winter fig 5c g k o the cross shore extension of the wedge was 9 km for mataquito 15 km for maule 12 km for itata and 24 km for biobío salinities lower than 31 5 psu were found in a thin surface layer less than 10 20 m depth the depth of the freshwater layer showed latitudinal variability according with the river discharge with a much thinner layer off the mataquito than the biobío river left panels fig 5 the position of the 1025 kg m 3 isopycnal reached depths 10 15 m near the coast confining buoyant waters to the surface off mataquito and maule the 33 6 isohaline black contour fig 5 outcropped nearshore 0 1 0 2 from the river mouths and reached depths of 15 m off these rivers fig 5c g in contrast the impact of the freshwater was larger off the itata and biobío rivers the 1025 kg m 3 isopycnal and the 33 6 isohaline were steeper and reached depths of 50 60 m as evidenced in the cross shore sections of fig 5k o the influence of freshwater was larger in the cross shore direction in spring the 1025 kg m 3 isopycnal indicate an extension of 27 km for mataquito 9 km for maule and 74 km for itata and biobío fig 5d h l p there was a separated parcel of low salinity water off the maule that extended from 72 8 to the end of the cross shore section fig 5h the depth of the 1025 kg m 3 isopycnal and the 33 6 isohaline indicates that the plumes were deep farther offshore 20 40 m and shallower near the coastline 5 10 m off the mataquito and maule after upwelling favorable winds in spring fig 5d h conversely the 33 6 isohaline was flattened and was found between 20 40 m depth offshore and between 5 22 m depth near the coast for the itata and biobío rivers showing that the buoyant plume was shallower and broader in spring than during winter conditions fig 5l p to evaluate the role of freshwater on stratification cross shore sections of pea and fwc are also included in fig 5 stratification and freshwater content was higher near the coast where the low salinity wedge was evident in winter left panels fig 5 the pea and the fwc were practically zero farther offshore in the sections off mataquito maule and biobío and a high correlation skill 0 96 between fwc and pea was found in the cross shore sections off these rivers in winter fig 5a e m higher offshore variability was found in the cross shore section off itata only this section showed stratification around the mid shelf far from the low salinity wedge found next to the coast skill 0 71 fig 5i k in general a higher offshore variability in fwc was found during spring indicating the presence of freshwater farther offshore right panels fig 5 we found the same integrated fwc during winter and spring off the mataquito fwc 0 8 m indicating that a similar amount of low salinity waters during both seasons but spreading over a much wider area during spring fig 5b d stratification varied offshore in all sections showing a remarkable difference between spring and winter fig 5b f j n during winter the pea curves showed a maximum near the coast off maule itata and biobío rivers whereas the pea off mataquito decreased nearshore where the fwc was lower than 0 2 m in spring fig 5b f j n the correlation between pea and fwc curves was lower off mataquito maule and itata during spring in comparison with winter and was of a similar value in biobío the changes in the distribution of the isopycnals suggest differences in the geostrophic dynamics during winter and spring because of the plumes geometric changes we also evaluated the meridional geostrophic response through the thermal wind relation v z g ρ f ρ x fig 6 to compute this response we integrated the zonal density gradient 5 v h v z 0 g ρ 0 f z 0 h ρ x d z where v z 0 0 g is the gravitational acceleration ρ 0 is the average density 1025 kg m 3 and f is the coriolis parameter at the corresponding latitude the depth z 0 was set as 60 m nonetheless if the depth of the water column was lower than this value the maximum depth was used according to the thermal wind relation the along shelf transport would be southward northward after downwelling favorable upwelling favorable winds because of the zonal density gradient promoting geostrophic currents this baroclinic response is also important in regions with freshwater presence since they complement the wind forcing on the circulation and dispersion of river plumes i e marta almeida et al 2021 in all four cross shore sections a southward flow was characteristic in august fig 6a e i m but with some differences between the northern mataquito and maule and southern rivers itata and biobío a southward flow offshore and a strong inversion near the coast affecting the whole water column was observed off mataquito fig 6a while a marked geostrophic southward component occurred at the frontal region fig 6c off maule the situation was similar but the geostrophic component where the isopycnals merge at the front does not appear to be intense and a strong northward flow was evident in the total current in the nearshore region which was not appreciable in the geostrophic component fig 6e g the total flow off biobío showed a more complex circulation there was a slight northward flow at the coast which evolved to a southward flow at the front and then again unfolds into a northward current farther offshore fig 6m similarly the coastal ocean off itata also exhibited a complex flow field fig 6i the geostrophic flow showed a southward component just inshore of the front in both itata and biobío coastal regions fig 6k o the geostrophic component seemed to be in better agreement with the total flow field in the southern rivers than in their northern counterparts during winter on the contrary this agreement was better in all regions during spring a northward flow near the coast that evolved into a southward current farther offshore was found in both the total flow field and the geostrophic component right panels fig 6 a strong southward geostrophic component occurred near the coast off biobío that did not correlate with the total flow in general the total flow was mostly northward during spring in response to the surface upwelling circulation fig 6 3 4 daily time series of 2006 daily time series of meridional wind stress τ y the freshwater content fwc the potential energy anomaly pea the meridional total transport mtt and the meridional freshwater transport mft were computed next to each river mouth for year 2006 to assess the variability on intraseasonal to synoptic scales figs 7 and 8 this year presented elevated freshwater discharges fig 3d and hence is a good period to evaluate the response of freshwater plumes to synoptic wind pulses the variability of the wind stress was similar among the coastal regions figs 7a b and 8a b however this could be unrealistic near the coast due to the low resolution of the wind forcing upwelling favorable winds northward were predominant in summer while downwelling favorable winds southward dominated in winter with some weaker upwelling favorable events noticeably the maximum wind stress of the year occurred in winter reaching values 0 5 n m 2 to evaluate the influence of the freshwater content on stratification the skill between fwc and pea curves were also computed considering the entire year and winter spring as described previously in section 2 5 high stratification with negligible freshwater conditions were found during summer off mataquito maule and itata rivers whereas both stratification and freshwater content were minimum during may mid fall figs 7c d and 8c d the freshwater was non negligible off biobío during summer fall varying between 1 2 m 2 on synoptical events the stratification off biobío reached similar values to those observed in the coastal ocean next to the other rivers 500 600 j m 2 fig 8d the freshwater content varied greatly between rivers the mataquito plume reached a maximum of 2 5 m 2 the maule and itata plumes reached a maximum between 3 5 m 2 whereas the biobío plume reached 9 m 2 the stratification also varied greatly on a synoptic scale during winter in all regions figs 7c d and 8c d similar variability of pea and fwc curves was found in winter spring especially during synoptic events a higher skill was found in these seasons compared to the entire year gray regions figs 7c d and 8c d several pulses of strong southward winds occurred in winter figs 7a b and 8a b and at the same time the stratification was reduced and coastal waters were transported southward decreasing the freshwater content figs 7c d e f and 8c d e f the lowest southward transport of freshwater 0 1 m 3 s 1 occurred in the coastal ocean off mataquito during these events the pea curve was higher in relative terms than the fwc curve in spring oct nov dec but they still showed similar variability and this trend lasted until the end of the year figs 7c d and 8c d synoptic northward wind stress pulses occurred in coherence with a northward transport figs 7e f and 8e f and the stratification was not fully destroyed unlike wintertime figs 7c d and 8c d in general there was a connection in the variability seasonal and synoptic between the meridional total transport and the wind stress figs 7a b e f and 8a b e f the meridional freshwater transport was practically zero off mataquito maule and itata during the first half of the year due to the lack of freshwater during this season figs 7e f and 8e an elevated southward transport occurred in all coastal regions in winter whereas northward transport occurred in spring in agreement with the meridional wind stress variability both the mft and mtt showed correlated variability and a quick response to synoptic wind pulses during both winter and spring as expected from the magnitude of river discharges the averaged meridional transport was higher in the coastal ocean off biobío 4 4 m 3 s 1 to the north followed by the region off itata 3 m 3 s 1 southward the average freshwater transport followed the same pattern 61 10 3 m 3 s 1 northward and 4 10 2 m 3 s 1 southward off biobío and itata respectively note that the average values of meridional freshwater transport off mataquito and maule were very small 72 10 4 and 66 10 4 m 3 s 1 respectively 4 discussion 4 1 seasonal cycle of freshwater availability the south pacific anticyclone spa centered at 28 31 s is the more important atmospheric system driving the circulation and rainfall regime in central chile quintana and aceituno 2012 strub 1998 the spa moves southward during summer and fall seasons reducing rainfall on the contrary the spa moves northward during winter allowing the entrance of low pressure atmospheric systems that increase precipitation and freshwater discharges strub 1998 hence the river discharge in our study region shows a minimum during the first half of the year summer and fall fig 3c d and reaches a maximum in winter due to tropical storm events that typically cause an increase in rainfall in spring the storm events decrease but the discharges of the rivers are also affected by snow melting from the andes due to an increase in solar radiation the impacts of atmospheric rivers on the amount of anomalous freshwater discharges stratification circulation and plume extensions are still unclear in our model monthly river discharge data were used whereas the wind variability had a time interval of 6 h this condition allowed us to evaluate the role of the wind variability on the coastal circulation at synoptic to intraseasonal scales and considering the general seasonal pattern of the river discharges furthermore the results of the wind variability in our model are in good agreement with previous studies e g sobarzo et al 2007 letelier et al 2009 4 2 river plume variability winter versus spring conditions observations and model results have shown the response of the coastal ocean to upwelling or downwelling favorable winds forming an upwelling or downwelling front i e letelier et al 2009 austin and lentz 2002 mazzini et al 2014 offshore of the front the response is similar after upwelling and downwelling favorable winds austin and lentz 2002 in contrast the coastal response is different nearshore due to the stratification which modifies the wind driven cross shelf transport after downwelling favorable winds the stratification is not strong allowing vertical mixing whereas after upwelling favorable winds the cross shelf circulation is more important austin and lentz 2002 the formation of a river plume involves its anticyclonic rotation and propagation in the downstream direction in the direction of propagation of a kelvin wave a bulge forms next to the river mouth horner devine 2009 chant et al 2008 and the coastal buoyancy driven current propagates downstream under the effect of the earth s rotation which in absence of external forcing is in geostrophic balance chao and boicourt 1986 lemagie and lerczak 2020 this coastal current can be affected by upwelling or downwelling favorable winds because of the associated ekman transport lentz and largier 2006 after a period of downwelling favorable southward winds a plume attaches to the coast because of ekman transport which advects waters onshore fig 4c e promoting the development of a cross shore plume front fig 5k o lentz and largier 2006 mazzini et al 2014 in our winter study case a quick response occurred at the surface the plume was quickly advected southward when a strong synoptic pulse of southward wind stress occurred fig 4c e the ekman transport and the tilting of the isopycnals promoted a geostrophic balance through the thermal wind relation generating alongshore currents fig 6c g k o the zonal density gradient was larger in the upper part of the water column in all cross shore sections fig 5c g k o and thus the geostrophic flow was more important in the uppermost layer especially off itata and biobío rivers fig 6c g k o the plumes are transported farther offshore after upwelling favorable winds in spring fig 4g i it is worth noting that the mataquito plume was very small in spring in agreement with the observations of saldías et al 2012 in general the upwelling and onshore flow near the bottom promote the offshore transport of the plumes with isopycnals distributed more horizontally in comparison with winter after a synoptic pulse of northward winds fig 5d h l p this agrees well with ekman theory in which upwelling favorable winds promote the detachment of the coastal buoyancy driven plume or even reverse its dominant direction lentz and largier 2006 mazzini et al 2014 pimenta et al 2011 our model showed that a wind stress lower than 0 1 n m 2 but greater than 0 05 n m 2 was capable of detaching the plumes off central chile from the coast fig 4f the geostrophic balance caused a northward flow which appears as the most important factor in the meridional flow in all four regions after synoptic pulses of upwelling favorable winds right panels fig 6 despite the good agreement between the flow field and the geostrophic component there were some discrepancies the geostrophic currents showed a strong slight southward component near the coast off biobío itata that did not appear in the total flow hence other factors as anticyclonic rotation due to coriolis may have also an important role forcing the flow next to the river mouths the advection that occurs under upwelling favorable winds modifies the shape of the plume as seen in figs 4 and 5 these changes are essential because they drive mixing processes in the plume fong and geyer 2001 austin and lentz 2002 our results suggest that stratification increases in the coastal region right panels fig 5 after pulses of strong synoptic northward wind stress the changes in plume orientation between winter and spring due to the wind forcing figs 4 and 5 agree with the contrast in plume structure under upwelling downwelling forcing off itata river e g saldías et al 2012 saldías et al 2012 discussed the coalescence of plumes in central chile and indicated that these events occur under conditions of high discharge and after a period of downwelling favorable winds however our model did not show the merging of large plumes despite having those wind conditions in a coastal margin with several small mountainous river warrick and farnsworth 2017 we refer to our model as a semi realistic since it was forced with monthly river discharge and 6 h wind data this lack of high resolution daily pulses of river discharges could be crucial in the lack of large plumes merged along the coast another important factor is the low resolution of the ncep wind forcing resolution of almost 2 which would not reproduce the cross shore land sea interface properly and thus it would not promote a realistic nearshore dynamics associated with the effect of wind dropoff next to the coast capet et al 2004 astudillo et al 2019 note that fig 1c shows the coalescence of large river plumes however these events did not occurred as frequent as expected from previous observational studies e g saldías et al 2012 4 3 stratification versus wind mixing a minimum of stratification occurred in all coastal regions in may when the freshwater content was low figs 7c d and 8c d to evaluate the role of the wind on the observed stratification patterns the mechanical wind energy available to generate mixing was computed for each coastal region as the cube of the wind speed magnitude for the years 2002 2010 fig 9 the high mechanical wind energy during may promote mixing decreasing the stratification in these coastal regions fig 9 the mechanical wind energy reaches a maximum during austral winter when the riverine outflows reach the coastal oceans stratification increases which explains the skill between fwc and pea curves during winter and spring gray regions figs 7c d and 8c d sobarzo et al 2007 found that the winds are low in magnitude to destroy the buoyancy stratification in the proximity of the itata and biobío river mouths throughout the year the competition between mixing and stratification depends on the cross shore location the direction of plume spreading and the magnitude of freshwater content in the zonal direction the time series shown in figs 7 and 8 considered a zonal extension of 0 2 offshore the river mouths 1 4 of the sections shown in figs 5 and 6 it is expected that large mixing dominates farther north off mataquito where the fwc is relatively low whereas the regions off itata and biobio should be more stratified due to the large fwc and a fairly similar to the northern region mechanical wind energy fig 9 additionally the mechanical energy available to generate mixing is lower in spring i e october in all coastal regions which suggests that the reduction of stratification by wind mixing is lower than during winter fig 9 nevertheless the variability of fwc and pea were still similar figs 7c d and 8c d 4 4 wind relaxation events wind relaxation events are common on continental shelves gan and allen 2002b a under upwelling favorable winds shelf water is transported and pile up farther downstream this generates a meridional pressure gradient force in the opposite direction gan and allen 2002b a for our coastal domain the cease of the wind stress causes that the meridional pressure gradient would force a southward transport using an idealized model austin and lentz 2002 showed that after the wind has ceased the bottom stress which dissipates energy would balance the pressure gradient force examples of relaxation events can be observed in figs 7a b and 8a b northward wind stress upwelling favorable lasted around a month from mid january to mid february off all rivers upward arrow in both figures with values that exceeded 0 1 0 2 n m 2 in the northern southern rivers just after the wind stress ceased a strong southward transport developed off mataquito maule and itata which were not correlated with the wind stress upward arrows figs 7e f and 8e 4 5 biogeochemical implications river plumes play a significant role linking silicon and carbon cycles between the continent and the coastal ocean cole et al 2007 conley 1997 the suspended sediments and nutrients discharged from itata and biobío rivers into the gulf of arauco might have significant biological and biogeochemical implications for instance the biobío river can transport significant amounts of inorganic nutrients particularly during winter when the river can export 150 and 1500 tons d 1 of dissolved inorganic nitrogen and silicic acid respectively into the adjacent coastal ocean léniz et al 2012 the influence of riverine silicon on diatom production at sea might also have important implications for annual variations in the accumulation of biomass in the gulf sánchez et al 2008 playing a significant role during non upwelling conditions in winter léniz et al 2012 previous studies have also evidenced that terrestrial carbon exported from the biobío river can support more than 40 of the dissolved organic carbon doc pool in the adjacent continental shelf then contributing substantially to carbon fluxes in this productive coastal upwelling area vargas et al 2013 thus the combined effect of coastal upwelling in summer and maximum riverine export of organic matter along the biobío river plume during winter months can both drive co2 outgassing and low ph conditions in the river plume vargas et al 2016 pérez et al 2015 also evidenced that both maule and biobío rivers can export significant amounts of dissolved inorganic carbon dic in the adjacent coastal area influenced by river plumes during winter and spring months 500 mol s 1 and then constituting not only a co2 source to the atmosphere but also driving calcium carbonate caco3 undersaturation conditions on those areas influenced by river discharges these results are highly relevant for marine invertebrates such as bivalves and gastropods since most of them correspond to marine calcifiers which require high caco3 concentration for proper development salisbury et al 2008 pérez et al 2015 saavedra et al 2018 these biogeochemical effects have implications for coastal ecosystem services considering this coastal area supports a highly relevant artisanal fishery and aquaculture of benthic resources such as mussels and clams hernández et al 2011 saavedra et al 2018 in this respect it would be highly relevant to evaluate not only the biogeochemical but also the biological implications in the context of recent initiatives of freshwater diversion transfer from the river mouths across 2000 km up to desert areas of northern chile vargas et al 2020 5 summary using a semi realistic model we have studied the influence of the wind in the hydrography and the flow variability in the coastal ocean off central chile influenced by river outflows our results indicate that on a synoptic scale the meridional flow could be explained to a large extent by the geostrophic balance off biobío and itata rivers during winter the ageostrophic component of the circulation is larger in the coastal ocean off mataquito and maule during winter and hence other factors appear to have a major role the wind driven circulation is expected to dominate over the shelf since the buoyancy driven flows are reduced off mataquito the meridional transport followed the same pattern of the wind stress on a seasonal scale the high mechanical energy available during winter causes mixing and decreases the stratification when the riverine freshwater reaches the coastal ocean the stratification increases consequently the stratification was mostly influenced by the freshwater content in winter synoptic pulses of wind stress promoted the advection of these coastal low salinity waters in the same direction as the wind stress and affecting primarily the upper layers on average the meridional transport off mataquito was northward throughout the year with some synoptic southward events during winter related to events of high discharge in contrast the average meridional transport was southward in the coastal ocean off maule river the average freshwater transport followed the same direction of the total transport off these rivers both itata and biobío areas showed a transport correlated with the wind forcing but the region off itata had an average southward transport 3 m 3 s 1 whereas an average northward transport was found off biobío 4 4 m 3 s 3 future studies considering a high resolution bottom bathymetry resolving the fine scale of bathymetric features such as submarine canyons and wind forcing are needed to further understand the physics of the coastal ocean off central chile the fact that our model did not show frequent large coalescence events in winter such as the one shown in fig 1 suggests that 1 the resolution of the wind forcing could be too coarse to properly reproduce a dropoff effect nearshore to promote less wind mixing eroding the plumes and or 2 short scale pulses of high river discharges could be essential in the process they are missed when considering monthly river discharges future studies should address this higher frequency variability considering daily river discharges and a finer spatial wind resolution credit authorship contribution statement cristian m rojas conceptualization methodology analyses writing original draft data curation writing review editing gonzalo s saldías conceptualization writing original draft writing review editing supervision funding raúl p flores writing original draft writing review editing sebastián i vásquez data curation writing review editing cristian salas data curation software cristian a vargas writing original draft funding declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments cr gss and cav have been funded by millennium institute coastal social ecological millennium institute secos chile icn2019 015 during the analysis and the preparation of the manuscript sv was partially supported by the chilean national research and development agency anid with the doctoral grant 21221020 cav was partially supported by fondecyt chile grant n 1210171 gss has been partially supported by fondecyt chile grant n 1190805 and copas coastal anid chile fb210021 rpf was supported by anid chile through fondecyt grant 11190378 and fondap chile grant 15110017 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 102155 appendix a supplementary data the following is the supplementary material related to this article mmc s1 cross shore salinity sections off each river one two days after the maximum wind stress as in figure 5 but using a reference salinity of 33 8 
23806,the coast of central chile has multiple rivers with a marked seasonal discharge variability few studies have addressed primarily the seasonal variability of river plume extension and vertical structure here we have analyzed the effects of multiple river outflows on the hydrography salinity and density and meridional transports off central chile this study is focused on synoptic and intraseasonal scales of variability using eight years of semi realistic model outputs our results reveal that the plume spreading is much broader during winter than spring wind driven changes in plume shapes modulate the geostrophic component of the flow field off biobío and itata rivers in winter spring after downwelling upwelling favorable winds the geostrophic flow was important off mataquito and maule rivers after upwelling favorable winds primarily in spring the stratification in winter was mostly associated with the freshwater content in all coastal regions and showed a rapid response to the wind stress forcing the mixing through wind stress decreased in spring modifying the stratification and uncoupling the wintertime variability between stratification and freshwater keywords river plumes wind driven flows freshwater transport continental shelves eastern boundary systems data availability data will be made available on request 1 introduction rivers contribute about 95 of sediment input into the oceans syvitski et al 2003 influencing coastal processes due to the downward particle fluxes and the accumulation of river borne constituents rivers also deliver freshwater with organic and inorganic constituents syvitski et al 2003 goñi et al 2013 vargas et al 2016 curra sánchez et al 2022 with significant biogeochemical implications on coastal ecosystems hickey et al 2010 typical biogeochemical characteristics of river outflows are to be acidic relative to the receiving coastal ocean waters salisbury et al 2008 tend to have higher levels of intrinsic growth rates of phytoplankton hickey et al 2010 liu and dagg 2003 and higher chlorophyll concentrations relative to other coastal regions hickey et al 2010 grez et al 2020 among others moreover river outflows are constantly mixed over the continental shelf which modifies the dynamics of coastal ecosystems horner devine et al 2015 coastal systems with significant input of freshwater discharges are known as region of freshwater influence rofi simpson 1997 in these regions a river discharge forms a buoyant plume hetland 2005 horner devine et al 2015 that spreads in response to the wind wave forcing coastal currents bathymetry and coriolis horner devine et al 2015 studies of coastal river plumes have investigated the influence of topography and ambient flow on plume dispersal chapman and lentz 1994 simpson 1997 warrick and stevens 2011 the plume trapping to the surface bottom fong and geyer 2002 garvine 1995 the influence of wind forcing on plume spreading and cross shore transport lentz and largier 2006 hickey et al 1998 the influence of tides on plume structure and variability chen 2014 isobe 2005 rijnsburger et al 2018 and mixing transport processes associated with river plumes horner devine et al 2015 ivey et al 2008 observational studies have mainly focused on large river plumes such as the columbia i e hickey et al 1998 2005 mississippi i e walker 1996 liu and dagg 2003 or amazonas i e geyer and beardsley 1995 trowbridge and kineke 1994 aguiar et al 2022 small mountainous rivers smr produce smaller local plumes however their combined area cover with watershed sizes ranging from 10 to 10 000 km 2 is larger than the plume area from a large river with the same watershed size warrick and fong 2004 studies evaluating the impact of smr in the coastal ocean have increased lately including biogeochemical aspects such as the input of sediments and terrestrial materials milliman and farnsworth 2011 goñi et al 2013 warrick and farnsworth 2017 wheatcroft et al 2010 and the coalescence of plumes from several smr in eastern boundaries warrick and farnsworth 2017 saldías et al 2012 saldías et al 2016 mendes et al 2017 saldías et al 2020 in general coastal oceanography studies along central southern chile have mainly focused on aspects of coastal upwelling strub 1998 escribano and schneider 2007 sobarzo and djurfeldt 2004 rutllant et al 2004 the influence of climate variability saldías et al 2016 grez et al 2020 and lately on freshwater outflows and plumes on seasonal and interannual scales saldías et al 2012 saldías et al 2016 masotti et al 2018 salcedo castro et al 2020 studies evaluating the variability on shorter scales are scarce and centered on individual river plumes e g piñones et al 2005 studies assessing the seasonal and interannual variability of plume spreading have primarily used observations from field surveys and satellite imagery saldías et al 2012 saldías et al 2016 which limits the vertical and horizontal scales of impact to be evaluated using a threshold value in modis moderate resolution imaging spectroradiometer imagery to detect turbid river plumes saldías et al 2012 resolved the seasonal variability of several river plumes off central chile larger smaller plumes are formed during winter summer which correlates with high low river discharges the major cape of the region punta lavapié pl fig 1 seems to be an inflection point on the role that the wind plays in the surface circulation the wind stress is nearly northward year round north of pl based on seasonal averages whereas it has a seasonal variability with a northward southward direction in austral summer winter south of pl letelier et al 2009 only one modeling study has addressed the river influence on the circulation and hydrographic conditions off central chile and has clarified the seasonal variability of the maipo and rapel river plumes salcedo castro et al 2020 nonetheless that study was not focused on a large latitudinal extension with multiple river outflows only two of them and focused solely on seasonal averages the present work seeks to improve our knowledge of the intraseasonal hydrographic and flow variability along central chile considering the region influenced by four smr emphasizing the influence of the wind forcing on the freshwater content stratification and meridional transport we assess the freshwater conditions and transports in the coastal system using a numerical model that considers the main river outflows between 34 30 s and 38 00 s for this purpose eight years of semi realistic modeling outputs were analyzed the study region and methods are described in section 2 section 3 contains the main results in section 4 the discussion is presented whereas the summary is finally highlighted in section 5 2 study area and methods 2 1 study area the study area covers the coastal ocean off central chile between 34 30 s and 38 00 s and 75 00 w and 72 30 w fig 1 four smr influence the hydrography and circulation of the coastal ocean the mataquito maule itata and biobío river with watershed sizes ranging from 6 300 km 2 mataquito to 24 000 km 2 biobío these rivers are influenced by rainfall and snow melting and have a strong seasonal variability with maximum minimum discharges during austral winter summer saldías et al 2012 saldías et al 2012 showed that the plumes from these rivers merge during high rainfall events and southward winds during winter spring furthermore this region is affected by the south pacific anticyclone spa which influences the wind field and affects the evolution of the plumes and the mixing of the water column sobarzo et al 2007 2 2 implementation of the regional ocean modeling system the hydrodynamic model employed in this study was a configuration of the regional ocean modeling system roms shchepetkin and mcwilliams 2003 2005 roms is a three dimensional free surface terrain following numerical model that solves the navier stokes equations using reynolds mean hydrostatic and boussinesq approximation haidvogel et al 2008 the model grid forcing boundary and initial conditions were built using the romstools package penven et al 2008 the rectangular domain covers from 30 s to 40 s in latitude and from 70 w to 81 w in longitude with three lateral open boundaries to the north south and west the horizontal resolution is approximately 3 km the model has 32 terrain following vertical levels s coordinates that are stretched to obtain a higher resolution at the surface the s coordinates are well adapted to study shelf dynamics lemarié et al 2012 mcgrath et al 2020 the model was configured with an split and rotated 3rd order upstream biased advection scheme recommended for realistic applications with variable bottom topography the bathymetry was taken from the gebco 2020 topography data gebco 2019 which has a resolution of approximately 500 m and was smoothed using a smoothing parameter r 0 25 controlling the slope of the sigma layers haidvogel et al 2000 the minimum depth h m i n of the model bathymetry was set to 20 m taking in account the horizontal resolution of our model the extension of the study area and the complexity of bottom topography since the main objective of our study was to analyze the response of several buoyant rivers plumes to wind forcing the configuration of the model aimed to have a higher vertical resolution on the surface by using a vertical transformation design with surface and bottom stretching parameters θ b 0 θ s 6 and vtransform 2 the baroclinic time step of the model was set to 100 s the initial and lateral boundary conditions for the model were derived from the interannual fields from the estimating the circulation and climate of the ocean ecco consortium which has a temporal resolution of 10 days and a 1 1 horizontal resolution stammer et al 1999 the forcing fields containing wind stress air temperature air density relative humidity specific humidity air sea fluxes evaporation and precipitation fluxes were extracted from the 6 h national centers for environmental prediction ncep2 reanalysis kalnay et al 1996 with a horizontal resolution of 1 9 1 9 the original grid was linearly interpolated to the model grid the forcing fields were computed by using the bulk formula of fairall et al 1996 the k profile parameterization kpp scheme large et al 1994 was used to compute the vertical mixing in the model finally the simulated period was 2001 2010 with one year of spin up after which our analyses suggested numerical stability 2 3 incorporation of river runoff into the model monthly river discharge data were obtained from the dirección general de aguas dga http www dga cl database for the period 2001 2010 monthly river runoff was introduced in the model as a volume of freshwater in the continuity equation according to the spatial resolution of the model 3 km each river was represented by a single grid point source at the location of the river mouth fig 1 for all rivers the salinity of the freshwater flow was 0 1 psu to ensure roms stability and considering that this value is close to the salinity of riverine waters the temperature was set constant throughout the year but variable between rivers according to the meridional pattern of average temperatures reported in ministerio del medio ambiente 2010 the rationale to use monthly river data is that having smoothly changing monthly river discharges helps to clarify the response of coastal ocean circulation to the synoptic wind forcing by filtering the high frequency pulses of river discharges we refer to our model as semi realistic due to the lack of high frequency river discharges 2 4 remote sensing data daily remote sensing data from the modis aqua mission were used to compare our model outputs with the surface reflectance associated with the turbid river plumes high resolution 1 km l2 files were obtained from the nasa website https oceancolor gsfc nasa gov with swaths containing at least 75 of the area inside the box 34 5 38 s 68 78 w during 2002 2010 which accounts for 2898 files these files were used to generate fields of remote sensing reflectance at 645 nm rsr 645 sr 1 because of its capability to detect and delineate river plumes e g saldías et al 2016 mendes et al 2017 salcedo castro et al 2020 flores et al 2022 2 5 freshwater content transport and potential energy anomaly the freshwater content fwc m was computed following blanton and atkinson 1983 1 fwc d 0 r s s z r s d z where s z is the salinity as a function of depth z r s is the reference salinity and d is the depth at which the reference salinity is located this magnitude represents how many meters of purely freshwater are in the water column according to silva et al 2009 the antarctic circumpolar current acc reaches the chilean coast around 42 48 s where it splits into a northern humboldt current hc and southern cape horn current chc branches in particular the hc transports surface sub antarctic waters saaw northward and affects the upper ocean up to 30 s hence our study region is highly affected by waters of low temperature 11 5 c and relatively low salinity 33 8 silva et al 2009 since the saaw impinges our study region from the south freshwater conditions imposed by saaw and river plumes can overlap in the quantification of fwc when the reference salinity is considered as rs 33 8 the depth of the isohaline is greater supplementary material figure s1 than when using rs 33 6 e g fig 5 thus the amount of freshwater increases with rs 33 8 due to the depth of the isohaline we take r s 33 6 as reference salinity to quantify only freshwater from rivers and to filter out the contribution from the saaw to assess the meridional freshwater transport mft m 2 s 1 the product of the fwc and the meridional velocity v x z is integrated 2 mft d 0 v x z r s s z r s d z the total meridional transport mtt m 2 s 1 was computed by integrating the velocity field through the entire water column 3 mtt z 0 v x z d z where z is the depth of the water column we use the potential energy anomaly pea j m 3 simpson 1981 to investigate the vertical stratification due to the freshwater input from rivers in the area pea is the amount of energy required to homogenize the entire water column vertically and its given by simpson 1981 4 pea 1 h h 0 g z ρ ρ d z where ρ 1 h h 0 ρ d z is the depth averaged density ρ is the density profile g is the gravitational acceleration and h is the water column depth zonal transects and time series of pea and fwc were analyzed together to evaluate the impact of the fwc on the stratification when these curves have the same zonal shape i e they are highly correlated it suggests that freshwater plays a key role stratifying the water column e g saldías et al 2019 a linear regression model for curve fitting with least squares was implemented between curves of fwc and pea emery and thomson 2004 3 results 3 1 satellite data validation fig 2 shows the monthly mean rrs 645 fields from modis sea surface salinity sss and the freshwater content fwc from our model satellite data shows that plumes are relatively small during austral summer fall jan mar may fig 2a b c our model agrees with the general seasonal variability evidenced in the satellite data there are small plumes next to the river mouths in january and march fig 2a b versus fig 2d e whereas larger plumes develop in may fig 2c f the fwc shows that the plume s impact is limited to the nearshore area fig 2g h i during the austral winter fall jul sep nov both modis and our model show larger plume signals the river plumes spread over most of the continental shelf in winter 0 200 m isobath especially in july and september fig 2j k m n p q despite the higher discharge of the four rivers during july august see fig 3c the model shows larger plume spreading in the gulf of arauco goa fig 1 during september and november which is not well supported by the satellite data fig 2k l n o q r this lack of agreement could be the result of 1 the lack of daily variability in the river forcing 2 the use of daily satellite images partially biased towards cloud free days in which the river discharge should be lower due to the lack of rain and or 3 the low resolution of the wind forcing 1 9 1 9 affecting the dynamics of the coastal ocean 3 2 seasonal variability of meridional wind stress and river discharges on average the zonal wind stress component is low on the study region throughout the year fig 3a and an inversion from positive to negative zonal wind component occurs around april principally north of pl the meridional wind stress is on average upwelling favorable along the entire coastal band in summer and the maximum stress occurs around pl at the beginning of summer fig 3b a transition to downwelling favorable winds occurs in early fall apr may jun along the entire study region on average downwelling favorable winds occur along the entire coastal ocean in winter jul aug sep downwelling winds are maximum towards the southern region and are slightly reduced in the central area during winter a transition to upwelling favorable winds occurs at the beginning of spring oct nov dec which increase in magnitude towards the end of the year consequently both the fall and spring are transition seasons for the meridional wind stress forcing fig 3b fig 3c shows the seasonal variability of river discharge the lowest river discharge occurs for all rivers in summer whereas maximum discharges occur in july august fig 3c d following the period of high discharge the outflow decreases progressively during spring fig 3c d the biobío river has the largest discharge in the study region it is the third largest watershed in chile reaching a maximum average discharge of almost 2000 m 3 s 1 on average the maximum values of maule and itata rivers reach the 1000 m 3 s 1 whereas mataquito only reaches 250 m 3 s 1 3 3 synoptic plume variability winter versus spring conditions we consider the response of the water column to different wind forcing conditions next to the river mouths two events with contrasting wind forcing were selected to assess the response of the river plumes water column stratification and freshwater content in winter and spring fig 4 in winter the meridional wind started to blow southward on august 20 and the maximum magnitude 0 5 n m 2 occurred on august 23 fig 4a the plumes rotated southward within this period fig 4c d the maule itata and biobío plumes were attached to the coast one or two days after the maximum meridional wind stress fig 4d e the plumes detached from the coast by august 29 in response to the change of wind stress conditions which became upwelling favorable on august 28 fig 4f low salinity waters were advected north northwestward in spring fig 4g i the meridional wind blew northward during october 26 30 and the maximum magnitude 0 1 n m 2 occurred on october 28 fig 4b the plumes extended northward off maule and itata river mouths while the biobío plume spread northwestward until october 29 one day after the maximum meridional wind stress fig 4i the plume was attached to the coast with northward advection off maule meanwhile the biobío plume showed a southward rotated branch offshore and a coastal branch advected into the gulf of arauco by october 31 fig 4j fig 5 shows cross shore salinity sections on august 25 and october 30 1 2 days after the maximum wind stress to evaluate the response of the water column the frontal position of the buoyant plume was delimited by the position of the 1025 kg m 3 isopycnal a wedge of low salinity was observed adjacent to the coast and confined in a small cross shore section off all rivers after a period of downwelling favorable winds in winter fig 5c g k o the cross shore extension of the wedge was 9 km for mataquito 15 km for maule 12 km for itata and 24 km for biobío salinities lower than 31 5 psu were found in a thin surface layer less than 10 20 m depth the depth of the freshwater layer showed latitudinal variability according with the river discharge with a much thinner layer off the mataquito than the biobío river left panels fig 5 the position of the 1025 kg m 3 isopycnal reached depths 10 15 m near the coast confining buoyant waters to the surface off mataquito and maule the 33 6 isohaline black contour fig 5 outcropped nearshore 0 1 0 2 from the river mouths and reached depths of 15 m off these rivers fig 5c g in contrast the impact of the freshwater was larger off the itata and biobío rivers the 1025 kg m 3 isopycnal and the 33 6 isohaline were steeper and reached depths of 50 60 m as evidenced in the cross shore sections of fig 5k o the influence of freshwater was larger in the cross shore direction in spring the 1025 kg m 3 isopycnal indicate an extension of 27 km for mataquito 9 km for maule and 74 km for itata and biobío fig 5d h l p there was a separated parcel of low salinity water off the maule that extended from 72 8 to the end of the cross shore section fig 5h the depth of the 1025 kg m 3 isopycnal and the 33 6 isohaline indicates that the plumes were deep farther offshore 20 40 m and shallower near the coastline 5 10 m off the mataquito and maule after upwelling favorable winds in spring fig 5d h conversely the 33 6 isohaline was flattened and was found between 20 40 m depth offshore and between 5 22 m depth near the coast for the itata and biobío rivers showing that the buoyant plume was shallower and broader in spring than during winter conditions fig 5l p to evaluate the role of freshwater on stratification cross shore sections of pea and fwc are also included in fig 5 stratification and freshwater content was higher near the coast where the low salinity wedge was evident in winter left panels fig 5 the pea and the fwc were practically zero farther offshore in the sections off mataquito maule and biobío and a high correlation skill 0 96 between fwc and pea was found in the cross shore sections off these rivers in winter fig 5a e m higher offshore variability was found in the cross shore section off itata only this section showed stratification around the mid shelf far from the low salinity wedge found next to the coast skill 0 71 fig 5i k in general a higher offshore variability in fwc was found during spring indicating the presence of freshwater farther offshore right panels fig 5 we found the same integrated fwc during winter and spring off the mataquito fwc 0 8 m indicating that a similar amount of low salinity waters during both seasons but spreading over a much wider area during spring fig 5b d stratification varied offshore in all sections showing a remarkable difference between spring and winter fig 5b f j n during winter the pea curves showed a maximum near the coast off maule itata and biobío rivers whereas the pea off mataquito decreased nearshore where the fwc was lower than 0 2 m in spring fig 5b f j n the correlation between pea and fwc curves was lower off mataquito maule and itata during spring in comparison with winter and was of a similar value in biobío the changes in the distribution of the isopycnals suggest differences in the geostrophic dynamics during winter and spring because of the plumes geometric changes we also evaluated the meridional geostrophic response through the thermal wind relation v z g ρ f ρ x fig 6 to compute this response we integrated the zonal density gradient 5 v h v z 0 g ρ 0 f z 0 h ρ x d z where v z 0 0 g is the gravitational acceleration ρ 0 is the average density 1025 kg m 3 and f is the coriolis parameter at the corresponding latitude the depth z 0 was set as 60 m nonetheless if the depth of the water column was lower than this value the maximum depth was used according to the thermal wind relation the along shelf transport would be southward northward after downwelling favorable upwelling favorable winds because of the zonal density gradient promoting geostrophic currents this baroclinic response is also important in regions with freshwater presence since they complement the wind forcing on the circulation and dispersion of river plumes i e marta almeida et al 2021 in all four cross shore sections a southward flow was characteristic in august fig 6a e i m but with some differences between the northern mataquito and maule and southern rivers itata and biobío a southward flow offshore and a strong inversion near the coast affecting the whole water column was observed off mataquito fig 6a while a marked geostrophic southward component occurred at the frontal region fig 6c off maule the situation was similar but the geostrophic component where the isopycnals merge at the front does not appear to be intense and a strong northward flow was evident in the total current in the nearshore region which was not appreciable in the geostrophic component fig 6e g the total flow off biobío showed a more complex circulation there was a slight northward flow at the coast which evolved to a southward flow at the front and then again unfolds into a northward current farther offshore fig 6m similarly the coastal ocean off itata also exhibited a complex flow field fig 6i the geostrophic flow showed a southward component just inshore of the front in both itata and biobío coastal regions fig 6k o the geostrophic component seemed to be in better agreement with the total flow field in the southern rivers than in their northern counterparts during winter on the contrary this agreement was better in all regions during spring a northward flow near the coast that evolved into a southward current farther offshore was found in both the total flow field and the geostrophic component right panels fig 6 a strong southward geostrophic component occurred near the coast off biobío that did not correlate with the total flow in general the total flow was mostly northward during spring in response to the surface upwelling circulation fig 6 3 4 daily time series of 2006 daily time series of meridional wind stress τ y the freshwater content fwc the potential energy anomaly pea the meridional total transport mtt and the meridional freshwater transport mft were computed next to each river mouth for year 2006 to assess the variability on intraseasonal to synoptic scales figs 7 and 8 this year presented elevated freshwater discharges fig 3d and hence is a good period to evaluate the response of freshwater plumes to synoptic wind pulses the variability of the wind stress was similar among the coastal regions figs 7a b and 8a b however this could be unrealistic near the coast due to the low resolution of the wind forcing upwelling favorable winds northward were predominant in summer while downwelling favorable winds southward dominated in winter with some weaker upwelling favorable events noticeably the maximum wind stress of the year occurred in winter reaching values 0 5 n m 2 to evaluate the influence of the freshwater content on stratification the skill between fwc and pea curves were also computed considering the entire year and winter spring as described previously in section 2 5 high stratification with negligible freshwater conditions were found during summer off mataquito maule and itata rivers whereas both stratification and freshwater content were minimum during may mid fall figs 7c d and 8c d the freshwater was non negligible off biobío during summer fall varying between 1 2 m 2 on synoptical events the stratification off biobío reached similar values to those observed in the coastal ocean next to the other rivers 500 600 j m 2 fig 8d the freshwater content varied greatly between rivers the mataquito plume reached a maximum of 2 5 m 2 the maule and itata plumes reached a maximum between 3 5 m 2 whereas the biobío plume reached 9 m 2 the stratification also varied greatly on a synoptic scale during winter in all regions figs 7c d and 8c d similar variability of pea and fwc curves was found in winter spring especially during synoptic events a higher skill was found in these seasons compared to the entire year gray regions figs 7c d and 8c d several pulses of strong southward winds occurred in winter figs 7a b and 8a b and at the same time the stratification was reduced and coastal waters were transported southward decreasing the freshwater content figs 7c d e f and 8c d e f the lowest southward transport of freshwater 0 1 m 3 s 1 occurred in the coastal ocean off mataquito during these events the pea curve was higher in relative terms than the fwc curve in spring oct nov dec but they still showed similar variability and this trend lasted until the end of the year figs 7c d and 8c d synoptic northward wind stress pulses occurred in coherence with a northward transport figs 7e f and 8e f and the stratification was not fully destroyed unlike wintertime figs 7c d and 8c d in general there was a connection in the variability seasonal and synoptic between the meridional total transport and the wind stress figs 7a b e f and 8a b e f the meridional freshwater transport was practically zero off mataquito maule and itata during the first half of the year due to the lack of freshwater during this season figs 7e f and 8e an elevated southward transport occurred in all coastal regions in winter whereas northward transport occurred in spring in agreement with the meridional wind stress variability both the mft and mtt showed correlated variability and a quick response to synoptic wind pulses during both winter and spring as expected from the magnitude of river discharges the averaged meridional transport was higher in the coastal ocean off biobío 4 4 m 3 s 1 to the north followed by the region off itata 3 m 3 s 1 southward the average freshwater transport followed the same pattern 61 10 3 m 3 s 1 northward and 4 10 2 m 3 s 1 southward off biobío and itata respectively note that the average values of meridional freshwater transport off mataquito and maule were very small 72 10 4 and 66 10 4 m 3 s 1 respectively 4 discussion 4 1 seasonal cycle of freshwater availability the south pacific anticyclone spa centered at 28 31 s is the more important atmospheric system driving the circulation and rainfall regime in central chile quintana and aceituno 2012 strub 1998 the spa moves southward during summer and fall seasons reducing rainfall on the contrary the spa moves northward during winter allowing the entrance of low pressure atmospheric systems that increase precipitation and freshwater discharges strub 1998 hence the river discharge in our study region shows a minimum during the first half of the year summer and fall fig 3c d and reaches a maximum in winter due to tropical storm events that typically cause an increase in rainfall in spring the storm events decrease but the discharges of the rivers are also affected by snow melting from the andes due to an increase in solar radiation the impacts of atmospheric rivers on the amount of anomalous freshwater discharges stratification circulation and plume extensions are still unclear in our model monthly river discharge data were used whereas the wind variability had a time interval of 6 h this condition allowed us to evaluate the role of the wind variability on the coastal circulation at synoptic to intraseasonal scales and considering the general seasonal pattern of the river discharges furthermore the results of the wind variability in our model are in good agreement with previous studies e g sobarzo et al 2007 letelier et al 2009 4 2 river plume variability winter versus spring conditions observations and model results have shown the response of the coastal ocean to upwelling or downwelling favorable winds forming an upwelling or downwelling front i e letelier et al 2009 austin and lentz 2002 mazzini et al 2014 offshore of the front the response is similar after upwelling and downwelling favorable winds austin and lentz 2002 in contrast the coastal response is different nearshore due to the stratification which modifies the wind driven cross shelf transport after downwelling favorable winds the stratification is not strong allowing vertical mixing whereas after upwelling favorable winds the cross shelf circulation is more important austin and lentz 2002 the formation of a river plume involves its anticyclonic rotation and propagation in the downstream direction in the direction of propagation of a kelvin wave a bulge forms next to the river mouth horner devine 2009 chant et al 2008 and the coastal buoyancy driven current propagates downstream under the effect of the earth s rotation which in absence of external forcing is in geostrophic balance chao and boicourt 1986 lemagie and lerczak 2020 this coastal current can be affected by upwelling or downwelling favorable winds because of the associated ekman transport lentz and largier 2006 after a period of downwelling favorable southward winds a plume attaches to the coast because of ekman transport which advects waters onshore fig 4c e promoting the development of a cross shore plume front fig 5k o lentz and largier 2006 mazzini et al 2014 in our winter study case a quick response occurred at the surface the plume was quickly advected southward when a strong synoptic pulse of southward wind stress occurred fig 4c e the ekman transport and the tilting of the isopycnals promoted a geostrophic balance through the thermal wind relation generating alongshore currents fig 6c g k o the zonal density gradient was larger in the upper part of the water column in all cross shore sections fig 5c g k o and thus the geostrophic flow was more important in the uppermost layer especially off itata and biobío rivers fig 6c g k o the plumes are transported farther offshore after upwelling favorable winds in spring fig 4g i it is worth noting that the mataquito plume was very small in spring in agreement with the observations of saldías et al 2012 in general the upwelling and onshore flow near the bottom promote the offshore transport of the plumes with isopycnals distributed more horizontally in comparison with winter after a synoptic pulse of northward winds fig 5d h l p this agrees well with ekman theory in which upwelling favorable winds promote the detachment of the coastal buoyancy driven plume or even reverse its dominant direction lentz and largier 2006 mazzini et al 2014 pimenta et al 2011 our model showed that a wind stress lower than 0 1 n m 2 but greater than 0 05 n m 2 was capable of detaching the plumes off central chile from the coast fig 4f the geostrophic balance caused a northward flow which appears as the most important factor in the meridional flow in all four regions after synoptic pulses of upwelling favorable winds right panels fig 6 despite the good agreement between the flow field and the geostrophic component there were some discrepancies the geostrophic currents showed a strong slight southward component near the coast off biobío itata that did not appear in the total flow hence other factors as anticyclonic rotation due to coriolis may have also an important role forcing the flow next to the river mouths the advection that occurs under upwelling favorable winds modifies the shape of the plume as seen in figs 4 and 5 these changes are essential because they drive mixing processes in the plume fong and geyer 2001 austin and lentz 2002 our results suggest that stratification increases in the coastal region right panels fig 5 after pulses of strong synoptic northward wind stress the changes in plume orientation between winter and spring due to the wind forcing figs 4 and 5 agree with the contrast in plume structure under upwelling downwelling forcing off itata river e g saldías et al 2012 saldías et al 2012 discussed the coalescence of plumes in central chile and indicated that these events occur under conditions of high discharge and after a period of downwelling favorable winds however our model did not show the merging of large plumes despite having those wind conditions in a coastal margin with several small mountainous river warrick and farnsworth 2017 we refer to our model as a semi realistic since it was forced with monthly river discharge and 6 h wind data this lack of high resolution daily pulses of river discharges could be crucial in the lack of large plumes merged along the coast another important factor is the low resolution of the ncep wind forcing resolution of almost 2 which would not reproduce the cross shore land sea interface properly and thus it would not promote a realistic nearshore dynamics associated with the effect of wind dropoff next to the coast capet et al 2004 astudillo et al 2019 note that fig 1c shows the coalescence of large river plumes however these events did not occurred as frequent as expected from previous observational studies e g saldías et al 2012 4 3 stratification versus wind mixing a minimum of stratification occurred in all coastal regions in may when the freshwater content was low figs 7c d and 8c d to evaluate the role of the wind on the observed stratification patterns the mechanical wind energy available to generate mixing was computed for each coastal region as the cube of the wind speed magnitude for the years 2002 2010 fig 9 the high mechanical wind energy during may promote mixing decreasing the stratification in these coastal regions fig 9 the mechanical wind energy reaches a maximum during austral winter when the riverine outflows reach the coastal oceans stratification increases which explains the skill between fwc and pea curves during winter and spring gray regions figs 7c d and 8c d sobarzo et al 2007 found that the winds are low in magnitude to destroy the buoyancy stratification in the proximity of the itata and biobío river mouths throughout the year the competition between mixing and stratification depends on the cross shore location the direction of plume spreading and the magnitude of freshwater content in the zonal direction the time series shown in figs 7 and 8 considered a zonal extension of 0 2 offshore the river mouths 1 4 of the sections shown in figs 5 and 6 it is expected that large mixing dominates farther north off mataquito where the fwc is relatively low whereas the regions off itata and biobio should be more stratified due to the large fwc and a fairly similar to the northern region mechanical wind energy fig 9 additionally the mechanical energy available to generate mixing is lower in spring i e october in all coastal regions which suggests that the reduction of stratification by wind mixing is lower than during winter fig 9 nevertheless the variability of fwc and pea were still similar figs 7c d and 8c d 4 4 wind relaxation events wind relaxation events are common on continental shelves gan and allen 2002b a under upwelling favorable winds shelf water is transported and pile up farther downstream this generates a meridional pressure gradient force in the opposite direction gan and allen 2002b a for our coastal domain the cease of the wind stress causes that the meridional pressure gradient would force a southward transport using an idealized model austin and lentz 2002 showed that after the wind has ceased the bottom stress which dissipates energy would balance the pressure gradient force examples of relaxation events can be observed in figs 7a b and 8a b northward wind stress upwelling favorable lasted around a month from mid january to mid february off all rivers upward arrow in both figures with values that exceeded 0 1 0 2 n m 2 in the northern southern rivers just after the wind stress ceased a strong southward transport developed off mataquito maule and itata which were not correlated with the wind stress upward arrows figs 7e f and 8e 4 5 biogeochemical implications river plumes play a significant role linking silicon and carbon cycles between the continent and the coastal ocean cole et al 2007 conley 1997 the suspended sediments and nutrients discharged from itata and biobío rivers into the gulf of arauco might have significant biological and biogeochemical implications for instance the biobío river can transport significant amounts of inorganic nutrients particularly during winter when the river can export 150 and 1500 tons d 1 of dissolved inorganic nitrogen and silicic acid respectively into the adjacent coastal ocean léniz et al 2012 the influence of riverine silicon on diatom production at sea might also have important implications for annual variations in the accumulation of biomass in the gulf sánchez et al 2008 playing a significant role during non upwelling conditions in winter léniz et al 2012 previous studies have also evidenced that terrestrial carbon exported from the biobío river can support more than 40 of the dissolved organic carbon doc pool in the adjacent continental shelf then contributing substantially to carbon fluxes in this productive coastal upwelling area vargas et al 2013 thus the combined effect of coastal upwelling in summer and maximum riverine export of organic matter along the biobío river plume during winter months can both drive co2 outgassing and low ph conditions in the river plume vargas et al 2016 pérez et al 2015 also evidenced that both maule and biobío rivers can export significant amounts of dissolved inorganic carbon dic in the adjacent coastal area influenced by river plumes during winter and spring months 500 mol s 1 and then constituting not only a co2 source to the atmosphere but also driving calcium carbonate caco3 undersaturation conditions on those areas influenced by river discharges these results are highly relevant for marine invertebrates such as bivalves and gastropods since most of them correspond to marine calcifiers which require high caco3 concentration for proper development salisbury et al 2008 pérez et al 2015 saavedra et al 2018 these biogeochemical effects have implications for coastal ecosystem services considering this coastal area supports a highly relevant artisanal fishery and aquaculture of benthic resources such as mussels and clams hernández et al 2011 saavedra et al 2018 in this respect it would be highly relevant to evaluate not only the biogeochemical but also the biological implications in the context of recent initiatives of freshwater diversion transfer from the river mouths across 2000 km up to desert areas of northern chile vargas et al 2020 5 summary using a semi realistic model we have studied the influence of the wind in the hydrography and the flow variability in the coastal ocean off central chile influenced by river outflows our results indicate that on a synoptic scale the meridional flow could be explained to a large extent by the geostrophic balance off biobío and itata rivers during winter the ageostrophic component of the circulation is larger in the coastal ocean off mataquito and maule during winter and hence other factors appear to have a major role the wind driven circulation is expected to dominate over the shelf since the buoyancy driven flows are reduced off mataquito the meridional transport followed the same pattern of the wind stress on a seasonal scale the high mechanical energy available during winter causes mixing and decreases the stratification when the riverine freshwater reaches the coastal ocean the stratification increases consequently the stratification was mostly influenced by the freshwater content in winter synoptic pulses of wind stress promoted the advection of these coastal low salinity waters in the same direction as the wind stress and affecting primarily the upper layers on average the meridional transport off mataquito was northward throughout the year with some synoptic southward events during winter related to events of high discharge in contrast the average meridional transport was southward in the coastal ocean off maule river the average freshwater transport followed the same direction of the total transport off these rivers both itata and biobío areas showed a transport correlated with the wind forcing but the region off itata had an average southward transport 3 m 3 s 1 whereas an average northward transport was found off biobío 4 4 m 3 s 3 future studies considering a high resolution bottom bathymetry resolving the fine scale of bathymetric features such as submarine canyons and wind forcing are needed to further understand the physics of the coastal ocean off central chile the fact that our model did not show frequent large coalescence events in winter such as the one shown in fig 1 suggests that 1 the resolution of the wind forcing could be too coarse to properly reproduce a dropoff effect nearshore to promote less wind mixing eroding the plumes and or 2 short scale pulses of high river discharges could be essential in the process they are missed when considering monthly river discharges future studies should address this higher frequency variability considering daily river discharges and a finer spatial wind resolution credit authorship contribution statement cristian m rojas conceptualization methodology analyses writing original draft data curation writing review editing gonzalo s saldías conceptualization writing original draft writing review editing supervision funding raúl p flores writing original draft writing review editing sebastián i vásquez data curation writing review editing cristian salas data curation software cristian a vargas writing original draft funding declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments cr gss and cav have been funded by millennium institute coastal social ecological millennium institute secos chile icn2019 015 during the analysis and the preparation of the manuscript sv was partially supported by the chilean national research and development agency anid with the doctoral grant 21221020 cav was partially supported by fondecyt chile grant n 1210171 gss has been partially supported by fondecyt chile grant n 1190805 and copas coastal anid chile fb210021 rpf was supported by anid chile through fondecyt grant 11190378 and fondap chile grant 15110017 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 102155 appendix a supplementary data the following is the supplementary material related to this article mmc s1 cross shore salinity sections off each river one two days after the maximum wind stress as in figure 5 but using a reference salinity of 33 8 
23807,sea surface temperature sst is an essential physical parameter and plays a vital role in ocean atmosphere interactions accurate sst prediction relies on numerical model methods which require the understanding of complex dynamical and thermal processes data driven sst prediction methods based on deep learning have been studied to obtain quick results however recent deep learning models can hardly accurately capture and simulate complex sst patterns and thus give only lower resolution predictions here sst map prediction is regarded as a spatiotemporal sequence prediction task the memory in memory mim model and variational mode decomposition vmd are combined vmd mim to accurately detect variations in sst patterns the original sst data is firstly decomposed into different modes with different frequencies using vmd for each mode extracted by vmd mim is then applied to obtain the corresponding prediction maps separately sst data from the south china sea are used to estimate the vmd mim method in which we enter the ten day sst maps and predict the next seven days the results show that vmd mim can noticeably improve prediction skills by accurately presenting the fine structures 1 10 of sst maps which provides a valuable pathway for fast and lightweight short term spatiotemporal sst predictions graphical abstract keywords sea surface temperature prediction deep learning variational mode decomposition data availability data will be made available on request 1 introduction sea surface temperature sst is one of the basic and vitally important variables that regulates both oceanic and atmospheric processes sst can largely modulate air sea fluxes in heat momentum and freshwater which are major forces of upper ocean motions due to the impacts on the climate system sst is also considered a monitoring indicator of climate change leo et al 2006 sst has been routinely measured by satellites with high accuracy and wide coverage however as a result of complex dynamical and thermal processes over the air sea interface such as ocean waves qiao et al 2004 turbulence and radiation fluxes huang et al 2019 it is still a challenge to predict the sst accurately generally methods for predicting ocean variables can be summarized into two categories one is numerical models based on dynamical and thermal equations krishnamurti et al 2006 li et al 2008 2010 wu 2016 li et al 2018 2019 the numerical model is established based on physical chemical and biological parameters as well as their complex relations and thus quite sophisticated with relatively low resolution the other is data driven approach based on large amounts of observational data the abundance of satellite derived products has offered unprecedented opportunities for data driven approaches zheng et al 2020 as one of the important branches of data driven methods deep learning has received much attention in geographical and oceanic research in recent years it promotes the development of marine science and technology in many aspects such as classification identification data fusion and prediction liu et al 2019 stofa et al 2020 feng et al 2021 liu et al 2021 marin et al 2021 zhang et al 2022 compared to physics based numerical models data driven forecasting method can automatically learn the mapping relationships in data and require no or much less oceanic and atmospheric domain knowledge and corresponding equations besides a trained deep learning model can provide prediction results in a very short time with fewer computing resources which greatly extends the applications of prediction models deep learning methods for sst prediction can be grouped into two main categories based on the dimension of the processing data single value prediction and regional map prediction respectively we classify the methods in this way because rather than focusing on the physical mechanism inside the data the characteristics of the data itself can be used to determine the general structure and function of a deep learning model for single value prediction jahanbakht et al 2022 presented an ensemble of stacked deep neural networks and xie et al 2020 presented a prediction method based on deep learning with an attention mechanism however the spatial feature of sst data is not considered in this type of method for regional map prediction with spatial information yang et al 2018 uses a fully connected long short term memory fc lstm layer and a convolutional layer to extract the temporal and spatial features of sst data respectively and named its model as cfcc lstm combined fc lstm and convolution neural network zheng et al 2020 presented a dl deep learning model to predict sst maps of the next time step by cascading and stacking convolutional layers it used the iterative forward prediction method for future multistep forecasting and further analyzed the prediction results of complicated tropical instability waves to add some physical meaning to the data driven approach shao et al 2021 presented a prediction model for multiple oceanic variable predictions it combines multivariate empirical orthogonal function meof analysis with a conv1d lstm long short term memory combined with one dimensional convolution operation neural network meof is used to establish the spatial correlation in grid data and the relationship between sst and sea surface height anomaly ssha in fact this method converts the two dimensional problem into a one dimensional problem and uses lstm for sequence prediction although previous research results have shown that deep learning methods can effectively predict variations in sst the complex spatiotemporal structure of sst is hardly to be captured especially for high resolution predictions the continuous sst map data have strong spatiotemporal correlations neither the spatial relationship of sst data at a certain time or the temporal change in data at a particular location can be viewed in isolation in this regard sst as well as other marine variables such as sea surface height and ocean salinity etc map prediction is similar to existing spatiotemporal sequence prediction problems therefore sst map prediction can be regarded as a spatiotemporal sequence prediction task in recent years the deep integration of convolutional neural network cnn and recurrent neural network rnn has brought better solutions to the spatiotemporal dependence prediction problem shi et al 2015 firstly integrated the convolution operation into lstm so that the deep learning model can simultaneously extract the spatiotemporal features of the data for prediction on this basis several improved models with their corresponding spatiotemporal memory flow were proposed and have achieved satisfactory results wang et al 2017a 2018a b the spatiotemporal memory flow enables the model to memorize both spatial appearances and temporal variations in a unified memory pool the improved model such as predrnn recurrent neural networks for predictive learning and predrnn provides alternative quick routes for the gradient flows from outputs back to long range previous inputs wang et al 2017a 2018a it alleviates the gradient propagation difficulties in deep predictive models and enables their model to capture the short term and long term video dependencies adaptively however the simulation ability of the above models to the natural spatiotemporal process is relatively limited when predicting the natural spatiotemporal process like sst the difficulty is how to effectively capture the high order trend of each pixel and its neighboring area comparatively memory in memory mim networks which is inspired by autoregressive integrated moving average arima and the corresponding recurrent blocks focus on improving memory transition functions in rnn to effectively capture differential signals in input data wang et al 2018b therefore mim is more suitable for simulate highly nonstationary natural spatiotemporal variable like sst as deep learning methods are completely data driven that means it only depends on data which does not need physical mechanisms and external forces as model input therefore the information complexity contained in the data will directly affect the performance of the model xiao et al 2019 when the complexity of the data exceeds the modeling ability of the model the model will fail to some extent when the modeling ability of a model cannot be greatly improved measures should be taken to make the data processable by the model high resolution sst data show multiscale spatiotemporal variabilities that induced by distinct physical processes therefore a prediction method that considers the spatiotemporal context in each scale that can predict the daily sst maps holistically is needed to this end we introduce the variational mode decomposition vmd dragomiretskiy and zosso 2014 method to complex spatiotemporal predicting tasks vmd was recently proposed for the separation of composite real signal into respectively modes it has been widely applied to non stationary and nonlinear time series analysis for its powerful ability gan et al 2021 liu et al 2018 in this paper we propose a hybrid data driven approach based on signal processing method vmd and deep learning mim for the 2 dimensional daily sst field prediction task this proposed method could simultaneously model both the spatial and temporal features and then make multistep predictions accurately and holistically for the near future the combination of vmd and the spatiotemporal sequence prediction model can solve the problem of the blurred prediction results the rest of this paper is organized as follows section 2 presents data we used and study area the formulation definition of the spatiotemporal sequence prediction problem the brief introduction of vmd and mim as well as the detailed workflow of our proposed vmd mim method section 3 provides the method performance analysis finally conclusion is given in section 4 2 data and methods 2 1 data and study area in this study we aim to propose a vmd mim method to capture both the spatial and temporal dependencies of climate variables to this end we take sst predictions in the south china sea for example the study area locates in the south china sea 12 325 n 18 775 n 111 125 e 117 575 e fig 1 the south china sea is the world s largest marginal sea which is unique for investigating the influence of typhoons and the east asia monsoon haghroosta and ismail 2017 on sst since sst plays a fundamental role in air sea interactions the accurate prediction of sst is essential for estimate of air sea heat momentum and freshwater fluxes and then the prediction of typhoon in the south china sea the spatial and temporal variability characteristics of the sst in the south china sea makes it suitable to be used for testing the prediction performance of our proposed vmd mim method the data used is the daily sea surface temperature product ostia l4 produced by the european space agency esa climate change initiative cci http www esa sst cci org with a spatial resolution of 1 20 good et al 2019 it is an analysis dataset using observations from multiple platforms such as the advanced very high resolution radiometer avhrr and along track scanning radiometer atsr sst cci climate data records covering temporal range from september 1 1981 to present continuously here the subset of the sst from january 1 1993 to december 31 2018 for the study area contains 9495 daily images are selected due to limited computing resources the original 1 20 data are pre processed into the resolution of 1 10 by averaging spatial grids to expand the study area and minimize the influence of boundaries thus there are 64 64 pixels in each image 2 2 formulation of the prediction problem as the goal of this study is to forecast the next 7 days sst fields using the past 10 days sst fields we formulate the spatiotemporal sequence prediction problem as follows observations in the study area can be represented by m n grid with m being the number of rows and n being the number of columns at each grid point there are time varying measurements of p since sst is only used here as predicting variable the value of p is 1 then at any time the observational data can be represented by a tensor x r p m n where r is the domain of the observed variable data at successive time steps during a period of time j form a series of tensors x ˆ t j 1 x ˆ t j 2 x ˆ t the problem of k day ahead spatiotemporal sequence prediction is to predict the most likely spatiotemporal sequence based on the previous j days observations which can be formulated in eq 1 1 x t 1 x t k argmax x t 1 x t k p x t 1 x t k x ˆ t j 1 x ˆ t j 2 x ˆ t where p represents a conditional probability and x t 1 x t k are the predicted field of climate variables at time t 1 to t k 2 3 variational mode decomposition compared with the previous predictions for moving mnist modified national institute of standards and technology database traffic flow and videos that have been successfully applied with deep learning models climate variables such as sst owns more complex information observational sst fields are superimposed by multiple processes with different timescales in different amplitudes each grid in sst map includes both low frequency components e g annual cycle and intra seasonal variations and high frequency components days weeks meanwhile extreme events such as typhoons marine heat waves and low frequency processes could modulate the daily variations of sst thus it is difficult to identify and distinguish them with recent deep learning prediction models directly even if the deep learning model succeeds in capturing and predicting large trends the lack of detail features blurs prediction results the question is how to predict the sst structures more accurately on high resolution data therefore we introduce an adaptive data analysis method name as vmd to pre process sst sequence for modes decomposition before the deep learning prediction vmd is a non recursive and adaptive decomposition model that generalizes the traditional wiener filter to multiple adaptive frequency bands dragomiretskiy and zosso 2014 it provides a new theoretically well founded solution for mode decomposition it assumes that the original input signal sequence f is composed of a finite number of subsequences with different center frequencies and limited bandwidth and decomposes the signal by solving the following constrained variational problem 2 min u k ω k k t δ t j π t u k t e j ω k t 2 2 3 s t k u k f where j is an imaginary number f is the original signal δ t is the dirac distribution t is the time script k is the total number of modes u k is the k th mode ω k is the center frequency and is the convolution operator the lagrange multiplication operator and the quadratic penalty factor are introduced into the above formula to turn it into an unconstrained variational model 4 l u k ω k λ α k t δ t j π t u k t e j ω k t 2 2 f t k u k t 2 2 λ t f t k u k t where f t k u k t 2 2 is the quadratic penalty term and α is the balancing parameter of the needed data fidelity constraint the update formula for the mode variable is 5 u ˆ k n 1 f ˆ w i k u ˆ i ω λ ˆ ω 2 1 2 α ω ω k 2 where n is the number of iterations and f ˆ w u ˆ i ω u ˆ i ω and u ˆ k n 1 are the fourier transforms of f u i t λ t and u k n 1 respectively the center frequency can be expressed as 6 ω k n 1 0 ω u ˆ k ω 2 d ω 0 u ˆ k ω 2 d ω it should be noted that the number of modes in vmd k is defined manually depending on the signal characteristics when too many or too few modes are decomposed excessive decomposition or mode aliasing will occur we continuously tried different numbers of modes from 5 to 15 and finally 7 modes are chosen by considering the prediction performance and computational expenses numbers of decomposed modes linearly correlates with the computational resource consumption of the deep learning model for training therefore the number of the mode selection of other areas and climatic parameters depends on the complexity of the data vmd results of a random data point in the study area are given in fig 2 from low to high frequency mode 1 to 3 represent the long term trend the annual cycle intra seasonal oscillation respectively and mode 4 7 represent signals with cycles of less than 30 days fig 2a all the modes show distinct power spectra it means that vmd is an effective method that can decompose the original signal into different modes with distinctive frequencies after all the time series of sst in the study area are decomposed into 7 modes at all spatial grids all individual spatial locations at each mode are projected onto their original spatiotemporal locations to form the spatiotemporal mode at that specific frequency as the data difference between the neighboring grids is usually small and the corresponding mode at each grid contain almost identical time scales the combination process for each mode shows coherent structure as for how long the sequence is selected for decomposition we tried two feasible schemes see the appendix for the specific scheme and results scheme 2 is adopted in this paper 2 4 memory in memory model for fields of each mode extracted by vmd we further trained and predicted them by mim model separately mim is firstly proposed by wang et al 2018b it can learn complex spatiotemporal changes by effectively exploiting the differential signals between adjacent hidden layers which is suitable for predictions of climate variables an mim block is designed to capture higher order non stationarity information from spatiotemporal data then a diagonal state connected rnn structure is constructed to model the interframe difference features of the input data the two cascaded temporal memory recurrent modules in the mim block are used to replace the temporal forget gate f t in spatiotemporal lstm st lstm wang et al 2017a the first is the non stationary module mim n which additionally takes hidden states h t 1 l 1 as input and is used to capture non stationary changes based on the differencing h t l 1 h t 1 l 1 between two consecutive hidden states the second is the stationary module mim s which takes the output of the previous module and another external temporal memory c t 1 l as input and is used to capture the approximately stationary changes in the spatiotemporal sequences the main formulas of the mim block are as follows 7 g t tanh w x g h t l 1 w h g h t 1 l b g 8 i t σ w x i h t l 1 w h i h t 1 l b i 9 d t l mim n d t l h t 1 l 1 n t 1 l 10 t t l mim s d t l c t 1 l s t 1 l 11 g t tanh w x g h t l 1 w m g h t l 1 b g 12 i t σ w x i h t l 1 w m i h t l 1 b i 13 f t σ w x f h t l 1 w m f h t l 1 b f 14 m t l f t m t l 1 i t g t 15 o t σ w x o h t l 1 w h o h t 1 l w c o c t l w m o m t l b o 16 h t l o t tanh w 1 1 c t l m t l where n and s denote the horizontally transmitted memory cells in the non stationary module mim n and stationary module mim s respectively d is the differential feature learned by mim n and it is fed into mim s t is the memory passing the virtual forget gate and denotes the convolution operator the diagonal loop architecture corresponding to the mim block delivers the hidden states h t 1 l 1 and h t l 1 to the mim block to generate the difference features for further use since the first layer does not have any previous layers this step is only performed at timestamp t 1 and layer l 1 in the first layer of the model st lstm is used directly that is calculations of the entire model with one st lstm module and l 1 mim blocks can be presented as follows for 2 l l 17 h t 1 c t 1 m t 1 st lstm 1 x t h t 1 1 c t 1 1 m t 1 l 18 h t l c t l m t l n t l s t l mim l h t 1 1 h t 1 1 c t 1 1 m t l 1 n t 1 l s t 1 l in addition the data of each mode input to mim is normalized to the range of 1 1 before feeding each mode of sst maps for training and testing by mim due to the complexity of the sst data same normalization parameters are required for the entire dataset during the training and testing processes to avoid the information loss the normalization can make the data more centered which helps to train the model more easily quickly and accurately the following parameters are used in this experiment the input length is 10 the output length is 7 the size of the research area is 64 64 the filter size is 5 and the batch size is 4 in addition we used the scheduled sampling with a change rate of 0 0005 2 5 vmd mim by combining vmd data analysis method and mim deep learning model here we proposed this vmd mim method for complex natural spatiotemporal process predictions the proposed vmd mim workflow is developed as follows as shown in fig 3 our proposed method consists of three parts vmd mode decomposition mim model prediction and sst map reconstruction the detailed procedures for each step are described below 1 assume that there is an m n area with a total of l consecutive sst observations they form a spatiotemporal sequence which is a three dimensional matrix x r l m n the observed sst values at each grid point are taken out to form a one dimensional time sequence t of length l then vmd is applied to the time sequences t to obtain q modes i e q intrinsic mode functions imfs each mode decomposition result at each grid is reassembled spatially to obtain its spatiotemporal mode at that specific frequency for example all the first modes decomposed from each grid can form a spatiotemporal sequence y r l m n and then q modes will make up q spatiotemporal sequences y 2 the spatiotemporal sequences y on the q modes decomposed from the original spatiotemporal sequence x are sent to mim for training separately we obtain q sets of model parameters for q spatiotemporal sequences y based on these obtained model parameters the prediction results of each mode can be obtained when the test data or real time data are input into the trained mim model 3 the obtained prediction results of each mode are added to reconstruct the whole sst fields which are the final prediction result 3 results and discussion in this study we compare our proposed vmd mim method with three different deep learning models including g dl abbreviation of deep learning model that proposed by zheng et al 2020 mim vmd g dl combination vmd and g dl with same settings it means all these four models adopt same input and output labels we select the first 80 of the data as the training set and the remaining 20 as held out testing set all of the following prediction results are from the test set the training and testing samples are not randomly chosen but in the order of time with sst maps of 10 consecutive days are input and the next 7 days are output to maximize the use of data we slide over the dataset to select the input and output windows 3 1 evaluation of the model performance here three indexes are selected to measure and compare the performance of the four models for sst map predictions including the root mean square error rmse mean absolute error mae and correlation coefficient cc with their formulas are as follows 19 r m s e i 1 n y i p y i g t 2 n 20 m a e i 1 n y i p y i g t n 21 c c c o v y n p y n g t v a r y n p v a r y n g t where y i g t is the ground truth and y i p denotes the results predicted by the model i represents the i th position in the area and n represents the number of grid points in the study area c o v is covariance and v a r is variance rmse mae and cc are all defined on a single sst map to present the error trend for the future k days rmse mae and cc are averaged over the k th day over all test results to obtain r m s e a v e k m a e a v e k and c c a v e k where k represents the k th day in a prediction we conduct experiments for 1 7 days ahead predictions and compare the prediction performance of these four methods table 1 gives the evaluation results for the performance of each method for comparison we list the results of the persistence model in the table the model assumes that the predicted future is unchanged from the current that is p t 1 p t it can be seen that model g dl and mim shows similar prediction errors from 1 to 7 days ahead predictions with g dl performs slightly better this is because the mim model emphasizes temporal flow information which makes it difficult to accurately capture complex sst patterns at high resolutions especially when the trend of input data is different from that of output data although g dl has weaker information modeling capability than mim in temporal flow in many cases where the sst pattern does not change drastically the prediction results given by the g dl model may be closer to the real situation however both the g dl and mim models do not work at different levels on high resolution data which can be obviously observed in following fig 7 the comparison with the persistence model in table 1 can also confirm this point their prediction performance is worse than that of the persistence model in many cases which indicates that the prediction in these cases is meaningless then we add the vmd method for data preprocessing and then do the g dl and mim model predictions based on the decomposed modes to compare their performance the performance of the vmd g dl method deteriorates dramatically much worse than that of the g dl method its rmse is many times higher than other methods due to its failure performance of vmd g dl it is not used as a comparison any more below comparatively the vmd mim method gives predictions with minimal rmse values as shown in the last line of table 1 it also has the smallest error growth rate over time the increasing rate of the rmse value of the prediction from the first day to the seventh day decreased approximately from 168 3 mim and 155 0 g dl to 94 5 vmd mim it shows the feasibility of vmd mim in predicting the time flow information it is noteworthy that the error of vmd mim actually consists of two parts in addition to the prediction error caused by the mim mode decomposition also introduces some errors which is the noise discarded by vmd and this part of the residual already exists in the data before training the mim in this section only rmse is described in detail here while the other two indicators mae and cc show the similar patterns the table shows that our proposed vmd mim method consistently outperforms all the other three methods which means that it can better capture the patterns hidden in the sst maps and make more accurate predictions based on capture patterns fig 4 a b and c shows the 2d histograms of predictions for all the data grids on test set by g dl mim and vmd mim although all the three models show a strong positive linear correlation between the predicted sst and the reference sst observed our proposed method presents obviously better performance its rmse is 0 194 which is about a half of errors of other two methods and are centrally distributed with a correlation coefficient r of 0 99 the temporal distribution of area averaged rmse for sst predictions for 7 day lead time for whole test set period is presented in fig 4 d it can be seen that the error from the first day to the seventh day in each prediction is gradually increasing but it is far less than the other comparison methods figures not shown secondly the prediction error has seasonal difference the monthly distribution of area averaged rmse is shown in table 2 and we further counted the number of rmse greater than 0 4 nor0 4 on the seventh predicted day in every month which is shown in the second row of table 2 there are 72 nor0 4 in the whole test set which accounts for 3 9 of the total test predictions it can be seen from table 2 that the errors from april to july is larger than other months while the errors from september to december is smaller we believe that this is due to the low seawater temperature in winter less rapid process and easier prediction from april when the sea water temperature rises it can provide more energy for the rapid process resulting in more unpredictable extreme weather for example a marine heat wave occurred in may and june 2018 has caused 22 days 16 days in may and 6 days in june of inaccurate predictions black box in fig 4 d and figures in brackets in the second row of table 2 we have to clarify that almost all sst prediction methods cannot avoid this problem that caused by extreme situations however in comparison our model has significantly improved the prediction performance such as typhoons impact on sst details can be found in the following fig 7 3 2 visualization of prediction results on each mode in this section the prediction of sst map on each mode is visually shown to further verify the prediction performance from the spatial perspective by our proposed vmd mim method we compare the decomposed modes from the original observational maps and predicted results from low frequency to high frequency respectively fig 5 we can see that for each prediction lead p and for each decomposed mode as well as the sum of the modes the predicted results are generally consistent with the decomposed modes from the original data t because the rapid changes of high frequency modes are more difficult to capture and predict some local spatiotemporal features have not been accurately predicted however the higher the frequency is the smaller the data variance is so the final prediction result will not be affected normally mode 1 decomposed by vmd belongs to the trend part with negligible change during the 7 days lead time which is not showed in fig 5 when calculated the combined predicting results the bottom row in fig 5 the value of m1 on the last day of the input data is directly chosen as the predicted m1 for the next consecutive 7 days 3 3 model prediction performance in this section we show the performance of our proposed method and compare the differences among the three models in detail note that the vmd mim model in this section shows the final prediction results after all modes are combined firstly in order to compare the performance differences among the g dl mim and vmd mim methods more intuitively we selected three cases with different spatial and temporal distribution characteristics for detailed discussion fig 6 for output window that is relatively stable with slightly changes fig 6a g dl and mim models can capture the general spatial pattern but lack of detail features as our model are the combined prediction results for 7 decomposed modes that extracted by vmd it can capture the detail features both in high and low frequencies while for situation with obvious decreasing trend for output window fig 6b g dl fails to seize this decreasing trend with the spatial pattern maintains as that present on the first lead day comparatively mim shows better performance for predicting the decreasing trend that shown in the output window but loses its detail features gradually from 1 to 7 lead days the predicted results from vmd mim present exactly the similar pattern with the observed data true furthermore for complex spatiotemporal pattern with nonlinear changes increasing and then decreasing pattern in fig 6c g dl and mim models are totally lost in predicting both the nonlinear trend changes and the spatiotemporal structures the predicted results from vmd mim still shows strong modeling capability in terms of overall trend changes and local details it can be seen that the obtained prediction results are seriously affected by the complexity of the input information g dl and mim are sensitive to the complex changes and thus show their shortcomings in predicting the detail patterns and even the general pattern for complex situations since the vmd mim method predicts the sst map separately in each decomposed mode it can capture the detail and fast changes and thus avoid the large impact of the complexity of the input data on the model performance to further demonstrate the performance of the vmd mim we selected three typhoon cases from the test results for detailed discussion significant sst cooling is generally observed on the right side of the typhoon track in the north hemisphere the slower the moving speed of the typhoon is the closer the cooling area of sst is to the moving track the maximum sst cooling generally lags 1 2 days after typhoons arrival wang et al 2017b we have checked all the typhoon events in the study area during the test period and found that our model can basically succeed to capture the detail of sst changes event in this extreme condition in addition typhoon pathway may not always be accompanied by obvious sst cooling in order to demonstrate the ability of vmd mim model to deal with typhoon impact on sst as much as possible we selected three consecutive typhoons rai aere and nock ten ying et al 2014 in the study area with obvious sst changes when typhoons passed in 2016 for discussion fig 7 typhoon tracks in fig 1b we chose the time when the typhoon center entered the study area as the first day of prediction it can be seen that the g dl and mim models are completely failure to predict the sst reductions induced by rai and aere for nock ten the sst cooling phenomena appeared before the typhoon s arrival so the g dl and mim models could predict the sst decreasing to a certain degree although the amplitude was lower than the true value the vmd mim method offers excellent predictions in these three typhoon cases both the temporal and spatial of sst cooling are predicted accurately the rmse of the seven day sst prediction is 0 17 for typhoon rai 0 13 for aere and 0 14 for nock ten which falls in the averaged level of that for normal conditions 4 conclusions in this paper we proposed a model named as vmd mim which is appropriate for predicting detail natural spatiotemporal processes of climate variables the vmd mim method can not only predict the process of specific frequency but also further accurately predict the overall spatiotemporal field therefore the main contributions of this method are it is a new pure data driven method that is feasible for natural spatiotemporal process predictions this hybrid method successfully combines deep learning with signal processing which greatly increases the ability of deep learning prediction models to analyze complex data thus gives more accurate predictions results and significantly improves the problem of blurred results obtained by traditional deep learning sst prediction models however in some extreme weather such as typhoon and ocean heat wave conditions the error of this model is higher than the normal situation the prediction results can be further improved by following methods by stacking multiple mim blocks the model has a chance to gradually stationary the spatiotemporal process and make it more predictable wang et al 2018b by increasing the number of the decomposed modes extracted by vmd we can obtain more detail information the current model parameters are chosen here mainly due to the consideration of the limit of current computing resources thus it is believed that our propose method still has greater potential in the future moreover as we combined the data decomposing model in our method the vmd mim can also be used for field predictions of one single mode at certain specific frequency which cannot achieve by other methods because of its advantages in dealing with natural spatiotemporal processes vmd mim could be widely applied in predictions of climatic variables for sst signal used in this study the spatiotemporal variations of sst fields reflect the combined effect of the thermodynamic processes within the ocean system and surface forcing thus even without the external input and physical explanations the data itself includes these processes and it is one most probable reason that we can predict the sst pattern accurately only depend on the data it should be noted that only sst data from a certain area in the south china sea are used to test the vmd mim method further verification of this method by expanding the size of the study area and using different climatic variables are still necessary credit authorship contribution statement shuang xu investigation conceptualization methodology formal analysis writing original draft software validation dejun dai funding acquisition investigation data curation formal analysis supervision validation writing review editing xuerong cui funding acquisition supervision xunqiang yin investigation conceptualization methodology shumin jiang methodology writing review editing haidong pan methodology writing review editing guansuo wang formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank esa for providing the sst products http www esa sst cci org cma for providing the typhoon data http tcdata typhoon org cn and google for providing the open source machine learning framework tensorflow https www tensorflow org this work was supported by the national program on global change and air sea interaction phase ii and the national natural science foundation of china 41821004 52171341 appendix as shown in fig a 1 we have tried two mode decomposition using vmd schemes on data set scheme 1 decompose training set and test set respectively scheme 2 decompose training set separately then decompose the entire data set and extract the last 20 as the decomposition result of the test set as described we decompose the data into seven modes with different frequencies when scheme 1 is adopted the frequencies of the different modes of training set can but not exactly correspond to those of test set when scheme 2 is adopted the frequency correspondence of the decomposition results of training set and test set on each mode is better than scheme 1 the comparison of the two decomposition schemes on the results is shown in table a 1 it can be seen that the prediction result of scheme 2 is indeed more accurate which is also the result shown in this paper it is obvious that scheme 2 will take more time compared with scheme 1 therefore in practical applications how much data to decompose depends on the balance between time cost and prediction accuracy if the maximum performance of vmd mim is required someone can adopt scheme 2 it is worth noting that both of two decomposition schemes of training set are decomposed separately and do not involve future data 
23807,sea surface temperature sst is an essential physical parameter and plays a vital role in ocean atmosphere interactions accurate sst prediction relies on numerical model methods which require the understanding of complex dynamical and thermal processes data driven sst prediction methods based on deep learning have been studied to obtain quick results however recent deep learning models can hardly accurately capture and simulate complex sst patterns and thus give only lower resolution predictions here sst map prediction is regarded as a spatiotemporal sequence prediction task the memory in memory mim model and variational mode decomposition vmd are combined vmd mim to accurately detect variations in sst patterns the original sst data is firstly decomposed into different modes with different frequencies using vmd for each mode extracted by vmd mim is then applied to obtain the corresponding prediction maps separately sst data from the south china sea are used to estimate the vmd mim method in which we enter the ten day sst maps and predict the next seven days the results show that vmd mim can noticeably improve prediction skills by accurately presenting the fine structures 1 10 of sst maps which provides a valuable pathway for fast and lightweight short term spatiotemporal sst predictions graphical abstract keywords sea surface temperature prediction deep learning variational mode decomposition data availability data will be made available on request 1 introduction sea surface temperature sst is one of the basic and vitally important variables that regulates both oceanic and atmospheric processes sst can largely modulate air sea fluxes in heat momentum and freshwater which are major forces of upper ocean motions due to the impacts on the climate system sst is also considered a monitoring indicator of climate change leo et al 2006 sst has been routinely measured by satellites with high accuracy and wide coverage however as a result of complex dynamical and thermal processes over the air sea interface such as ocean waves qiao et al 2004 turbulence and radiation fluxes huang et al 2019 it is still a challenge to predict the sst accurately generally methods for predicting ocean variables can be summarized into two categories one is numerical models based on dynamical and thermal equations krishnamurti et al 2006 li et al 2008 2010 wu 2016 li et al 2018 2019 the numerical model is established based on physical chemical and biological parameters as well as their complex relations and thus quite sophisticated with relatively low resolution the other is data driven approach based on large amounts of observational data the abundance of satellite derived products has offered unprecedented opportunities for data driven approaches zheng et al 2020 as one of the important branches of data driven methods deep learning has received much attention in geographical and oceanic research in recent years it promotes the development of marine science and technology in many aspects such as classification identification data fusion and prediction liu et al 2019 stofa et al 2020 feng et al 2021 liu et al 2021 marin et al 2021 zhang et al 2022 compared to physics based numerical models data driven forecasting method can automatically learn the mapping relationships in data and require no or much less oceanic and atmospheric domain knowledge and corresponding equations besides a trained deep learning model can provide prediction results in a very short time with fewer computing resources which greatly extends the applications of prediction models deep learning methods for sst prediction can be grouped into two main categories based on the dimension of the processing data single value prediction and regional map prediction respectively we classify the methods in this way because rather than focusing on the physical mechanism inside the data the characteristics of the data itself can be used to determine the general structure and function of a deep learning model for single value prediction jahanbakht et al 2022 presented an ensemble of stacked deep neural networks and xie et al 2020 presented a prediction method based on deep learning with an attention mechanism however the spatial feature of sst data is not considered in this type of method for regional map prediction with spatial information yang et al 2018 uses a fully connected long short term memory fc lstm layer and a convolutional layer to extract the temporal and spatial features of sst data respectively and named its model as cfcc lstm combined fc lstm and convolution neural network zheng et al 2020 presented a dl deep learning model to predict sst maps of the next time step by cascading and stacking convolutional layers it used the iterative forward prediction method for future multistep forecasting and further analyzed the prediction results of complicated tropical instability waves to add some physical meaning to the data driven approach shao et al 2021 presented a prediction model for multiple oceanic variable predictions it combines multivariate empirical orthogonal function meof analysis with a conv1d lstm long short term memory combined with one dimensional convolution operation neural network meof is used to establish the spatial correlation in grid data and the relationship between sst and sea surface height anomaly ssha in fact this method converts the two dimensional problem into a one dimensional problem and uses lstm for sequence prediction although previous research results have shown that deep learning methods can effectively predict variations in sst the complex spatiotemporal structure of sst is hardly to be captured especially for high resolution predictions the continuous sst map data have strong spatiotemporal correlations neither the spatial relationship of sst data at a certain time or the temporal change in data at a particular location can be viewed in isolation in this regard sst as well as other marine variables such as sea surface height and ocean salinity etc map prediction is similar to existing spatiotemporal sequence prediction problems therefore sst map prediction can be regarded as a spatiotemporal sequence prediction task in recent years the deep integration of convolutional neural network cnn and recurrent neural network rnn has brought better solutions to the spatiotemporal dependence prediction problem shi et al 2015 firstly integrated the convolution operation into lstm so that the deep learning model can simultaneously extract the spatiotemporal features of the data for prediction on this basis several improved models with their corresponding spatiotemporal memory flow were proposed and have achieved satisfactory results wang et al 2017a 2018a b the spatiotemporal memory flow enables the model to memorize both spatial appearances and temporal variations in a unified memory pool the improved model such as predrnn recurrent neural networks for predictive learning and predrnn provides alternative quick routes for the gradient flows from outputs back to long range previous inputs wang et al 2017a 2018a it alleviates the gradient propagation difficulties in deep predictive models and enables their model to capture the short term and long term video dependencies adaptively however the simulation ability of the above models to the natural spatiotemporal process is relatively limited when predicting the natural spatiotemporal process like sst the difficulty is how to effectively capture the high order trend of each pixel and its neighboring area comparatively memory in memory mim networks which is inspired by autoregressive integrated moving average arima and the corresponding recurrent blocks focus on improving memory transition functions in rnn to effectively capture differential signals in input data wang et al 2018b therefore mim is more suitable for simulate highly nonstationary natural spatiotemporal variable like sst as deep learning methods are completely data driven that means it only depends on data which does not need physical mechanisms and external forces as model input therefore the information complexity contained in the data will directly affect the performance of the model xiao et al 2019 when the complexity of the data exceeds the modeling ability of the model the model will fail to some extent when the modeling ability of a model cannot be greatly improved measures should be taken to make the data processable by the model high resolution sst data show multiscale spatiotemporal variabilities that induced by distinct physical processes therefore a prediction method that considers the spatiotemporal context in each scale that can predict the daily sst maps holistically is needed to this end we introduce the variational mode decomposition vmd dragomiretskiy and zosso 2014 method to complex spatiotemporal predicting tasks vmd was recently proposed for the separation of composite real signal into respectively modes it has been widely applied to non stationary and nonlinear time series analysis for its powerful ability gan et al 2021 liu et al 2018 in this paper we propose a hybrid data driven approach based on signal processing method vmd and deep learning mim for the 2 dimensional daily sst field prediction task this proposed method could simultaneously model both the spatial and temporal features and then make multistep predictions accurately and holistically for the near future the combination of vmd and the spatiotemporal sequence prediction model can solve the problem of the blurred prediction results the rest of this paper is organized as follows section 2 presents data we used and study area the formulation definition of the spatiotemporal sequence prediction problem the brief introduction of vmd and mim as well as the detailed workflow of our proposed vmd mim method section 3 provides the method performance analysis finally conclusion is given in section 4 2 data and methods 2 1 data and study area in this study we aim to propose a vmd mim method to capture both the spatial and temporal dependencies of climate variables to this end we take sst predictions in the south china sea for example the study area locates in the south china sea 12 325 n 18 775 n 111 125 e 117 575 e fig 1 the south china sea is the world s largest marginal sea which is unique for investigating the influence of typhoons and the east asia monsoon haghroosta and ismail 2017 on sst since sst plays a fundamental role in air sea interactions the accurate prediction of sst is essential for estimate of air sea heat momentum and freshwater fluxes and then the prediction of typhoon in the south china sea the spatial and temporal variability characteristics of the sst in the south china sea makes it suitable to be used for testing the prediction performance of our proposed vmd mim method the data used is the daily sea surface temperature product ostia l4 produced by the european space agency esa climate change initiative cci http www esa sst cci org with a spatial resolution of 1 20 good et al 2019 it is an analysis dataset using observations from multiple platforms such as the advanced very high resolution radiometer avhrr and along track scanning radiometer atsr sst cci climate data records covering temporal range from september 1 1981 to present continuously here the subset of the sst from january 1 1993 to december 31 2018 for the study area contains 9495 daily images are selected due to limited computing resources the original 1 20 data are pre processed into the resolution of 1 10 by averaging spatial grids to expand the study area and minimize the influence of boundaries thus there are 64 64 pixels in each image 2 2 formulation of the prediction problem as the goal of this study is to forecast the next 7 days sst fields using the past 10 days sst fields we formulate the spatiotemporal sequence prediction problem as follows observations in the study area can be represented by m n grid with m being the number of rows and n being the number of columns at each grid point there are time varying measurements of p since sst is only used here as predicting variable the value of p is 1 then at any time the observational data can be represented by a tensor x r p m n where r is the domain of the observed variable data at successive time steps during a period of time j form a series of tensors x ˆ t j 1 x ˆ t j 2 x ˆ t the problem of k day ahead spatiotemporal sequence prediction is to predict the most likely spatiotemporal sequence based on the previous j days observations which can be formulated in eq 1 1 x t 1 x t k argmax x t 1 x t k p x t 1 x t k x ˆ t j 1 x ˆ t j 2 x ˆ t where p represents a conditional probability and x t 1 x t k are the predicted field of climate variables at time t 1 to t k 2 3 variational mode decomposition compared with the previous predictions for moving mnist modified national institute of standards and technology database traffic flow and videos that have been successfully applied with deep learning models climate variables such as sst owns more complex information observational sst fields are superimposed by multiple processes with different timescales in different amplitudes each grid in sst map includes both low frequency components e g annual cycle and intra seasonal variations and high frequency components days weeks meanwhile extreme events such as typhoons marine heat waves and low frequency processes could modulate the daily variations of sst thus it is difficult to identify and distinguish them with recent deep learning prediction models directly even if the deep learning model succeeds in capturing and predicting large trends the lack of detail features blurs prediction results the question is how to predict the sst structures more accurately on high resolution data therefore we introduce an adaptive data analysis method name as vmd to pre process sst sequence for modes decomposition before the deep learning prediction vmd is a non recursive and adaptive decomposition model that generalizes the traditional wiener filter to multiple adaptive frequency bands dragomiretskiy and zosso 2014 it provides a new theoretically well founded solution for mode decomposition it assumes that the original input signal sequence f is composed of a finite number of subsequences with different center frequencies and limited bandwidth and decomposes the signal by solving the following constrained variational problem 2 min u k ω k k t δ t j π t u k t e j ω k t 2 2 3 s t k u k f where j is an imaginary number f is the original signal δ t is the dirac distribution t is the time script k is the total number of modes u k is the k th mode ω k is the center frequency and is the convolution operator the lagrange multiplication operator and the quadratic penalty factor are introduced into the above formula to turn it into an unconstrained variational model 4 l u k ω k λ α k t δ t j π t u k t e j ω k t 2 2 f t k u k t 2 2 λ t f t k u k t where f t k u k t 2 2 is the quadratic penalty term and α is the balancing parameter of the needed data fidelity constraint the update formula for the mode variable is 5 u ˆ k n 1 f ˆ w i k u ˆ i ω λ ˆ ω 2 1 2 α ω ω k 2 where n is the number of iterations and f ˆ w u ˆ i ω u ˆ i ω and u ˆ k n 1 are the fourier transforms of f u i t λ t and u k n 1 respectively the center frequency can be expressed as 6 ω k n 1 0 ω u ˆ k ω 2 d ω 0 u ˆ k ω 2 d ω it should be noted that the number of modes in vmd k is defined manually depending on the signal characteristics when too many or too few modes are decomposed excessive decomposition or mode aliasing will occur we continuously tried different numbers of modes from 5 to 15 and finally 7 modes are chosen by considering the prediction performance and computational expenses numbers of decomposed modes linearly correlates with the computational resource consumption of the deep learning model for training therefore the number of the mode selection of other areas and climatic parameters depends on the complexity of the data vmd results of a random data point in the study area are given in fig 2 from low to high frequency mode 1 to 3 represent the long term trend the annual cycle intra seasonal oscillation respectively and mode 4 7 represent signals with cycles of less than 30 days fig 2a all the modes show distinct power spectra it means that vmd is an effective method that can decompose the original signal into different modes with distinctive frequencies after all the time series of sst in the study area are decomposed into 7 modes at all spatial grids all individual spatial locations at each mode are projected onto their original spatiotemporal locations to form the spatiotemporal mode at that specific frequency as the data difference between the neighboring grids is usually small and the corresponding mode at each grid contain almost identical time scales the combination process for each mode shows coherent structure as for how long the sequence is selected for decomposition we tried two feasible schemes see the appendix for the specific scheme and results scheme 2 is adopted in this paper 2 4 memory in memory model for fields of each mode extracted by vmd we further trained and predicted them by mim model separately mim is firstly proposed by wang et al 2018b it can learn complex spatiotemporal changes by effectively exploiting the differential signals between adjacent hidden layers which is suitable for predictions of climate variables an mim block is designed to capture higher order non stationarity information from spatiotemporal data then a diagonal state connected rnn structure is constructed to model the interframe difference features of the input data the two cascaded temporal memory recurrent modules in the mim block are used to replace the temporal forget gate f t in spatiotemporal lstm st lstm wang et al 2017a the first is the non stationary module mim n which additionally takes hidden states h t 1 l 1 as input and is used to capture non stationary changes based on the differencing h t l 1 h t 1 l 1 between two consecutive hidden states the second is the stationary module mim s which takes the output of the previous module and another external temporal memory c t 1 l as input and is used to capture the approximately stationary changes in the spatiotemporal sequences the main formulas of the mim block are as follows 7 g t tanh w x g h t l 1 w h g h t 1 l b g 8 i t σ w x i h t l 1 w h i h t 1 l b i 9 d t l mim n d t l h t 1 l 1 n t 1 l 10 t t l mim s d t l c t 1 l s t 1 l 11 g t tanh w x g h t l 1 w m g h t l 1 b g 12 i t σ w x i h t l 1 w m i h t l 1 b i 13 f t σ w x f h t l 1 w m f h t l 1 b f 14 m t l f t m t l 1 i t g t 15 o t σ w x o h t l 1 w h o h t 1 l w c o c t l w m o m t l b o 16 h t l o t tanh w 1 1 c t l m t l where n and s denote the horizontally transmitted memory cells in the non stationary module mim n and stationary module mim s respectively d is the differential feature learned by mim n and it is fed into mim s t is the memory passing the virtual forget gate and denotes the convolution operator the diagonal loop architecture corresponding to the mim block delivers the hidden states h t 1 l 1 and h t l 1 to the mim block to generate the difference features for further use since the first layer does not have any previous layers this step is only performed at timestamp t 1 and layer l 1 in the first layer of the model st lstm is used directly that is calculations of the entire model with one st lstm module and l 1 mim blocks can be presented as follows for 2 l l 17 h t 1 c t 1 m t 1 st lstm 1 x t h t 1 1 c t 1 1 m t 1 l 18 h t l c t l m t l n t l s t l mim l h t 1 1 h t 1 1 c t 1 1 m t l 1 n t 1 l s t 1 l in addition the data of each mode input to mim is normalized to the range of 1 1 before feeding each mode of sst maps for training and testing by mim due to the complexity of the sst data same normalization parameters are required for the entire dataset during the training and testing processes to avoid the information loss the normalization can make the data more centered which helps to train the model more easily quickly and accurately the following parameters are used in this experiment the input length is 10 the output length is 7 the size of the research area is 64 64 the filter size is 5 and the batch size is 4 in addition we used the scheduled sampling with a change rate of 0 0005 2 5 vmd mim by combining vmd data analysis method and mim deep learning model here we proposed this vmd mim method for complex natural spatiotemporal process predictions the proposed vmd mim workflow is developed as follows as shown in fig 3 our proposed method consists of three parts vmd mode decomposition mim model prediction and sst map reconstruction the detailed procedures for each step are described below 1 assume that there is an m n area with a total of l consecutive sst observations they form a spatiotemporal sequence which is a three dimensional matrix x r l m n the observed sst values at each grid point are taken out to form a one dimensional time sequence t of length l then vmd is applied to the time sequences t to obtain q modes i e q intrinsic mode functions imfs each mode decomposition result at each grid is reassembled spatially to obtain its spatiotemporal mode at that specific frequency for example all the first modes decomposed from each grid can form a spatiotemporal sequence y r l m n and then q modes will make up q spatiotemporal sequences y 2 the spatiotemporal sequences y on the q modes decomposed from the original spatiotemporal sequence x are sent to mim for training separately we obtain q sets of model parameters for q spatiotemporal sequences y based on these obtained model parameters the prediction results of each mode can be obtained when the test data or real time data are input into the trained mim model 3 the obtained prediction results of each mode are added to reconstruct the whole sst fields which are the final prediction result 3 results and discussion in this study we compare our proposed vmd mim method with three different deep learning models including g dl abbreviation of deep learning model that proposed by zheng et al 2020 mim vmd g dl combination vmd and g dl with same settings it means all these four models adopt same input and output labels we select the first 80 of the data as the training set and the remaining 20 as held out testing set all of the following prediction results are from the test set the training and testing samples are not randomly chosen but in the order of time with sst maps of 10 consecutive days are input and the next 7 days are output to maximize the use of data we slide over the dataset to select the input and output windows 3 1 evaluation of the model performance here three indexes are selected to measure and compare the performance of the four models for sst map predictions including the root mean square error rmse mean absolute error mae and correlation coefficient cc with their formulas are as follows 19 r m s e i 1 n y i p y i g t 2 n 20 m a e i 1 n y i p y i g t n 21 c c c o v y n p y n g t v a r y n p v a r y n g t where y i g t is the ground truth and y i p denotes the results predicted by the model i represents the i th position in the area and n represents the number of grid points in the study area c o v is covariance and v a r is variance rmse mae and cc are all defined on a single sst map to present the error trend for the future k days rmse mae and cc are averaged over the k th day over all test results to obtain r m s e a v e k m a e a v e k and c c a v e k where k represents the k th day in a prediction we conduct experiments for 1 7 days ahead predictions and compare the prediction performance of these four methods table 1 gives the evaluation results for the performance of each method for comparison we list the results of the persistence model in the table the model assumes that the predicted future is unchanged from the current that is p t 1 p t it can be seen that model g dl and mim shows similar prediction errors from 1 to 7 days ahead predictions with g dl performs slightly better this is because the mim model emphasizes temporal flow information which makes it difficult to accurately capture complex sst patterns at high resolutions especially when the trend of input data is different from that of output data although g dl has weaker information modeling capability than mim in temporal flow in many cases where the sst pattern does not change drastically the prediction results given by the g dl model may be closer to the real situation however both the g dl and mim models do not work at different levels on high resolution data which can be obviously observed in following fig 7 the comparison with the persistence model in table 1 can also confirm this point their prediction performance is worse than that of the persistence model in many cases which indicates that the prediction in these cases is meaningless then we add the vmd method for data preprocessing and then do the g dl and mim model predictions based on the decomposed modes to compare their performance the performance of the vmd g dl method deteriorates dramatically much worse than that of the g dl method its rmse is many times higher than other methods due to its failure performance of vmd g dl it is not used as a comparison any more below comparatively the vmd mim method gives predictions with minimal rmse values as shown in the last line of table 1 it also has the smallest error growth rate over time the increasing rate of the rmse value of the prediction from the first day to the seventh day decreased approximately from 168 3 mim and 155 0 g dl to 94 5 vmd mim it shows the feasibility of vmd mim in predicting the time flow information it is noteworthy that the error of vmd mim actually consists of two parts in addition to the prediction error caused by the mim mode decomposition also introduces some errors which is the noise discarded by vmd and this part of the residual already exists in the data before training the mim in this section only rmse is described in detail here while the other two indicators mae and cc show the similar patterns the table shows that our proposed vmd mim method consistently outperforms all the other three methods which means that it can better capture the patterns hidden in the sst maps and make more accurate predictions based on capture patterns fig 4 a b and c shows the 2d histograms of predictions for all the data grids on test set by g dl mim and vmd mim although all the three models show a strong positive linear correlation between the predicted sst and the reference sst observed our proposed method presents obviously better performance its rmse is 0 194 which is about a half of errors of other two methods and are centrally distributed with a correlation coefficient r of 0 99 the temporal distribution of area averaged rmse for sst predictions for 7 day lead time for whole test set period is presented in fig 4 d it can be seen that the error from the first day to the seventh day in each prediction is gradually increasing but it is far less than the other comparison methods figures not shown secondly the prediction error has seasonal difference the monthly distribution of area averaged rmse is shown in table 2 and we further counted the number of rmse greater than 0 4 nor0 4 on the seventh predicted day in every month which is shown in the second row of table 2 there are 72 nor0 4 in the whole test set which accounts for 3 9 of the total test predictions it can be seen from table 2 that the errors from april to july is larger than other months while the errors from september to december is smaller we believe that this is due to the low seawater temperature in winter less rapid process and easier prediction from april when the sea water temperature rises it can provide more energy for the rapid process resulting in more unpredictable extreme weather for example a marine heat wave occurred in may and june 2018 has caused 22 days 16 days in may and 6 days in june of inaccurate predictions black box in fig 4 d and figures in brackets in the second row of table 2 we have to clarify that almost all sst prediction methods cannot avoid this problem that caused by extreme situations however in comparison our model has significantly improved the prediction performance such as typhoons impact on sst details can be found in the following fig 7 3 2 visualization of prediction results on each mode in this section the prediction of sst map on each mode is visually shown to further verify the prediction performance from the spatial perspective by our proposed vmd mim method we compare the decomposed modes from the original observational maps and predicted results from low frequency to high frequency respectively fig 5 we can see that for each prediction lead p and for each decomposed mode as well as the sum of the modes the predicted results are generally consistent with the decomposed modes from the original data t because the rapid changes of high frequency modes are more difficult to capture and predict some local spatiotemporal features have not been accurately predicted however the higher the frequency is the smaller the data variance is so the final prediction result will not be affected normally mode 1 decomposed by vmd belongs to the trend part with negligible change during the 7 days lead time which is not showed in fig 5 when calculated the combined predicting results the bottom row in fig 5 the value of m1 on the last day of the input data is directly chosen as the predicted m1 for the next consecutive 7 days 3 3 model prediction performance in this section we show the performance of our proposed method and compare the differences among the three models in detail note that the vmd mim model in this section shows the final prediction results after all modes are combined firstly in order to compare the performance differences among the g dl mim and vmd mim methods more intuitively we selected three cases with different spatial and temporal distribution characteristics for detailed discussion fig 6 for output window that is relatively stable with slightly changes fig 6a g dl and mim models can capture the general spatial pattern but lack of detail features as our model are the combined prediction results for 7 decomposed modes that extracted by vmd it can capture the detail features both in high and low frequencies while for situation with obvious decreasing trend for output window fig 6b g dl fails to seize this decreasing trend with the spatial pattern maintains as that present on the first lead day comparatively mim shows better performance for predicting the decreasing trend that shown in the output window but loses its detail features gradually from 1 to 7 lead days the predicted results from vmd mim present exactly the similar pattern with the observed data true furthermore for complex spatiotemporal pattern with nonlinear changes increasing and then decreasing pattern in fig 6c g dl and mim models are totally lost in predicting both the nonlinear trend changes and the spatiotemporal structures the predicted results from vmd mim still shows strong modeling capability in terms of overall trend changes and local details it can be seen that the obtained prediction results are seriously affected by the complexity of the input information g dl and mim are sensitive to the complex changes and thus show their shortcomings in predicting the detail patterns and even the general pattern for complex situations since the vmd mim method predicts the sst map separately in each decomposed mode it can capture the detail and fast changes and thus avoid the large impact of the complexity of the input data on the model performance to further demonstrate the performance of the vmd mim we selected three typhoon cases from the test results for detailed discussion significant sst cooling is generally observed on the right side of the typhoon track in the north hemisphere the slower the moving speed of the typhoon is the closer the cooling area of sst is to the moving track the maximum sst cooling generally lags 1 2 days after typhoons arrival wang et al 2017b we have checked all the typhoon events in the study area during the test period and found that our model can basically succeed to capture the detail of sst changes event in this extreme condition in addition typhoon pathway may not always be accompanied by obvious sst cooling in order to demonstrate the ability of vmd mim model to deal with typhoon impact on sst as much as possible we selected three consecutive typhoons rai aere and nock ten ying et al 2014 in the study area with obvious sst changes when typhoons passed in 2016 for discussion fig 7 typhoon tracks in fig 1b we chose the time when the typhoon center entered the study area as the first day of prediction it can be seen that the g dl and mim models are completely failure to predict the sst reductions induced by rai and aere for nock ten the sst cooling phenomena appeared before the typhoon s arrival so the g dl and mim models could predict the sst decreasing to a certain degree although the amplitude was lower than the true value the vmd mim method offers excellent predictions in these three typhoon cases both the temporal and spatial of sst cooling are predicted accurately the rmse of the seven day sst prediction is 0 17 for typhoon rai 0 13 for aere and 0 14 for nock ten which falls in the averaged level of that for normal conditions 4 conclusions in this paper we proposed a model named as vmd mim which is appropriate for predicting detail natural spatiotemporal processes of climate variables the vmd mim method can not only predict the process of specific frequency but also further accurately predict the overall spatiotemporal field therefore the main contributions of this method are it is a new pure data driven method that is feasible for natural spatiotemporal process predictions this hybrid method successfully combines deep learning with signal processing which greatly increases the ability of deep learning prediction models to analyze complex data thus gives more accurate predictions results and significantly improves the problem of blurred results obtained by traditional deep learning sst prediction models however in some extreme weather such as typhoon and ocean heat wave conditions the error of this model is higher than the normal situation the prediction results can be further improved by following methods by stacking multiple mim blocks the model has a chance to gradually stationary the spatiotemporal process and make it more predictable wang et al 2018b by increasing the number of the decomposed modes extracted by vmd we can obtain more detail information the current model parameters are chosen here mainly due to the consideration of the limit of current computing resources thus it is believed that our propose method still has greater potential in the future moreover as we combined the data decomposing model in our method the vmd mim can also be used for field predictions of one single mode at certain specific frequency which cannot achieve by other methods because of its advantages in dealing with natural spatiotemporal processes vmd mim could be widely applied in predictions of climatic variables for sst signal used in this study the spatiotemporal variations of sst fields reflect the combined effect of the thermodynamic processes within the ocean system and surface forcing thus even without the external input and physical explanations the data itself includes these processes and it is one most probable reason that we can predict the sst pattern accurately only depend on the data it should be noted that only sst data from a certain area in the south china sea are used to test the vmd mim method further verification of this method by expanding the size of the study area and using different climatic variables are still necessary credit authorship contribution statement shuang xu investigation conceptualization methodology formal analysis writing original draft software validation dejun dai funding acquisition investigation data curation formal analysis supervision validation writing review editing xuerong cui funding acquisition supervision xunqiang yin investigation conceptualization methodology shumin jiang methodology writing review editing haidong pan methodology writing review editing guansuo wang formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank esa for providing the sst products http www esa sst cci org cma for providing the typhoon data http tcdata typhoon org cn and google for providing the open source machine learning framework tensorflow https www tensorflow org this work was supported by the national program on global change and air sea interaction phase ii and the national natural science foundation of china 41821004 52171341 appendix as shown in fig a 1 we have tried two mode decomposition using vmd schemes on data set scheme 1 decompose training set and test set respectively scheme 2 decompose training set separately then decompose the entire data set and extract the last 20 as the decomposition result of the test set as described we decompose the data into seven modes with different frequencies when scheme 1 is adopted the frequencies of the different modes of training set can but not exactly correspond to those of test set when scheme 2 is adopted the frequency correspondence of the decomposition results of training set and test set on each mode is better than scheme 1 the comparison of the two decomposition schemes on the results is shown in table a 1 it can be seen that the prediction result of scheme 2 is indeed more accurate which is also the result shown in this paper it is obvious that scheme 2 will take more time compared with scheme 1 therefore in practical applications how much data to decompose depends on the balance between time cost and prediction accuracy if the maximum performance of vmd mim is required someone can adopt scheme 2 it is worth noting that both of two decomposition schemes of training set are decomposed separately and do not involve future data 
23808,submesoscale processes with spatiotemporal scales of 0 1 10 km and hours to 1 day play an important role in the ocean energy cascade and material transport up to now most studies focusing on submesoscales are based on high resolution numerical simulations since observations are scarce due to a limitation of their small scales however numerical studies on submesoscales deeply depend on the choice of sub grid turbulence closures that are of significance in determining the simulation performance here submesoscale processes generated at an idealized mesoscale eddy are investigated based on a 1 km resolution regional ocean modeling system roms model and the model performance in terms of submesoscales is analyzed and emphasized with three popular turbulence closure schemes k profile parameterization kpp mellor yamada my and general length scale closure schemes gls the analysis shows that the magnitude of the submesoscale kinetic and potential energy follows gls my kpp despite a general consistent variation by the three closures to figure out the dominant factors controlling the submesoscale energy budget three terms including the baroclinic term bc the barotropic term bt and the background to submesoscale potential energy conversion term bsp are analyzed the results show that the bc is the source of submesoscale kinetic energy while the bt tends to transfer submesoscale kinetic energy to mesoscales inversely and the bsp is the submesoscale potential energy source in comparison the gls simulates the largest bc bt and bsp overall the order of the bc and bsp is gls kpp my and the order of the bt is gls my kpp keywords submesoscale numerical simulation turbulence closure energy cascade 1 introduction the ocean contains multi scale dynamic processes such as large scale circulation mesoscale eddies submesoscale processes and microscale mixing these processes are closely related and tend to interact across scales in the past few decades lots of studies have been carried out focusing on large meso and micro scale processes e g chelton et al 2011 kevin et al 2020 zhu et al 2021 based on in situ observations satellite retrievals and numerical simulations however submesoscales have been not noticed until the last decade benefiting from the development of physical oceanography and the improvement of model resolution submesoscale processes have rossby and richardson numbers of unity with intermediate spatiotemporal scales i e o 0 1 10 km and hours to 1 day mcwilliams 2016 submesoscale processes are of great significance for mesoscale energy budget and micro scale mixing and play an important role in ocean energy cascades capet et al 2008c d asaro et al 2011 zhang et al 2016 sasaki et al 2017 yang et al 2017 2019 dong et al 2020b a bidirectional energy transfer by submesoscales has been demonstrated on one hand submesoscales promote the forward energy cascade elevating local mixing e g capet et al 2008c yang et al 2017 cao et al 2021 on the other hand submesoscales also transfer the energy inversely to larger scales modulating the mesoscale variability deeply e g sasaki et al 2017 dong et al 2020b at the same time submesoscales are strong non geostrophic processes because of ro o 1 the strong vertical velocity 10 100 m day caused by them has a great contribution to the vertical heat and material transport taylor and ferrari 2011 lévy et al 2012 fox kemper and ferrari 2008 fox kemper et al 2008 2011 used an overturning streamfunction to parameterize vertical buoyancy fluxes induced by the submesoscale baroclinic instability or mixed layer instability mli and optimized the simulation results of climate models to some extent the small spatiotemporal scale is the main reason for limiting observational research on submesoscale processes nevertheless some works have studied submesoscale processes using observations which deepens our understanding of them for example pollard and regier 1992 found strong ageostrophic submesoscale flow with vertical velocities up to 40 m day 1 by solving the omega equation based on in situ observations in the western atlantic ocean hosegood et al 2006 also reported submesoscale induced high frequency layered structure in the surface mixed layer in the north pacific subtropical front most of these results are based on instantaneous observations and the temporal variability of submesoscales is hard to tell recently high resolution mooring arrays make it possible to investigate the temporal feature of submesoscales using subsurface mooring arrays in the north atlantic and the northwest pacific buckingham et al 2016 and zhang et al 2021 both revealed strong seasonality of submesoscales in the surface mixed layer and further mechanisms were discussed although mooring observations can describe the temporal variability of submesoscales their limited spatial coverage most of the calculated results are single point time series obviously cannot satisfy the study of the spatial distribution of submesoscale processes therefore the development of numerical simulation as an important method for ocean research has played an irreplaceable role in promoting the study of submesoscale processes given the limitations of observational methods high resolution numerical models make it possible to understand the basic dynamics and spatiotemporal distribution characteristics of submesoscale processes globally su et al 2018 the state of the art knowledge of submesoscales such as their seasonality more active in winter e g mensa et al 2013 dong and zhong 2018 generation submesoscale baroclinic instability and frontogenesis e g boccaletti et al 2007 capet et al 2008b fox kemper and ferrari 2008 and inverse cascade e g sasaki et al 2017 dong et al 2020a b schubert et al 2020 mostly stem from high resolution simulations one should admit that biases always exist between the numerical simulation and the real ocean and the sub grid turbulence closure exerts a great effect on the simulation performance however there is no best turbulence scheme as the ocean dynamics is complicated and varies from one region to another so far three parameterization schemes k profile parameterization kpp large et al 1994 mellor yamada 2 5 my mellor and yamada 1982 and generic length scale gls umlauf and burchard 2003 have been verified by experiments which are relatively mature and widely accepted the kpp parameterizes the turbulent stress which is not limited by the time step and parameterizes it based on the background mean flow parameters without considering the change of the turbulent potential energy due to turbulent mixing the my and gls schemes parameterize the turbulent kinetic energy ke and consider the turbulent ke conservation the main difference between the my and gls schemes is the determination of the length scale for solving the turbulent ke equation reichl and hallberg 2018 however the time step for these two schemes should be no longer than the order of minutes the time scale of the turbulence evolution and the parameterization results for the low reynolds number and the near wall region are not in line with expectations reichl and hallberg 2018 the simulation of submesoscale processes requires high spatial resolution and short time steps of high resolution models are prone to satisfy the time step requirement of the my and gls parameterizations while the kpp works well in larger scale simulations whether it is still applicable to high resolution models and simulations of submesoscale processes as the resolution increases is still a question for example the kpp fails to capture the dissipation by submesoscale symmetric instability bachman et al 2017 dong et al 2021b this paper analyzes submesoscale processes simulated by different parameterization schemes kpp my and gls from various perspectives including the rossby number frontal density gradient and energy budget to clarify the dependence of submesoscale simulation on the turbulent closure schemes the structure of this paper is organized as follows section 2 introduces the model and the configurations section 3 shows the results of the submesoscale dependence on the three parameterization schemes finally the summary and discussion are presented in section 4 2 model configuration the simulation is conducted based on the regional ocean modeling system roms shchepetkin and mcwilliams 2005 roms is a free surface terrain following primitive equations ocean model which is widely used in regional ocean simulations especially for submesoscales e g capet et al 2008a zhong and bracco 2013 taking the climatological temperature profile over the kuroshio extension region as the background state to simplify the problem the salinity in the model is taken as a constant this work constructs an idealized anticyclonic mesoscale eddy to generate submesoscales fig 1 previous studies have shown that anticyclonic eddies tend to favor more submesoscales than cyclonic ones as a result of more easily outcropping of the isopycnals e g brannigan et al 2017 according to the universal structure of mesoscale eddies by zhang et al 2013 the following expression is used to construct the temperature anomaly field associated with the eddy 1 t t 0 r r h z where t 0 2 o c is the amplitude of the temperature anomaly caused by the eddy r r 1 r r 0 2 2 e r r 0 2 2 is the horizontal structure of the eddy r 0 60 km is the vortex radius derived from the local hydrographic profile and water depth h z is the eddy vertical structure which is a sine function in the new coordinate z s 0 z n f d z n is the buoyancy frequency f is the coriolis parameter refer to zhang et al 2013 the simulation domain is 600 km 600 km with a spatial resolution of 1 km the model has 60 layers with a constant water depth of 1000 m with a finer resolution up to 1 m near the surface layer the lateral boundary is periodic and no atmospheric forcing is added the coriolis parameter of the model is taken as a constant f 1 1 0 4 s 1 to ensure that the eddy does not move due to the β effect in this paper three experiments are carried out using different turbulence closure schemes including the kpp my and gls the model starts from a quiescent state i e no ocean flow with no sea surface height and is simulated for 180 days as the eddy evolves an analysis of the surface rossby number indicates that the mesoscale currents become favorable in generating submesoscales after 50 days and the submesoscale activity reaches a relatively steady stage after 90 days not shown here 3 results as the eddy evolves the eddy induced currents and the associated shear and strain favor submesoscales at the eddy in this section the submesoscales are analyzed in terms of the rossby number frontal density gradient and submesoscale energy budget to highlight the differences among the three turbulence closures 3 1 rossby number the normalized relative vorticity ξ f the vertical relative vorticity ξ v x u y hereinafter referred to as the rossby number is an important parameter to characterize the activity of submesoscale processes with the rossby number ro 1 fig 2 shows the surface rossby number from different vertical mixing parameterization schemes on day 91 130 and 180 after the adjustment of the eddy current large ro values around 1 are ubiquitous at the eddy as the eddy evolves and loses its stability indicating active submesoscale processes due to instabilities on day 91 the eddy still has a coherent structure with active submesoscale eddies and filaments within it the three closures simulate similar spatial patterns despite differences in the details of the submesoscale structures and locations however as the submesoscales continue to grow with time on day 130 the structure of the eddy is destroyed and the submesoscales begin to spread out the submesoscales concentrate at the eddy periphery and the eddy core tends to restore the geostrophic balance with small negative ro values at the same time the structure of eddy and the spatial distribution of submesoscales from the parameterization schemes begin to differ compared with the results on day 130 the rossby number intensity from the three cases consistently weakened on day 180 despite of the differences of the spatial patterns the evolution of the submesoscales shows a statistical consistency during the simulation period indicating the robustness of the capability of these three closures in simulating submesoscale dynamics it is noteworthy that there is an asymmetry in the distribution of submesoscale relative vorticity during the evolution that is the cyclonic i e positive vorticity is generally more and stronger than the anticyclonic i e negative one this asymmetry can be explained by several mechanisms including inertial instability capet et al 2008a strain induced frontogenesis mcwilliams 2016 and the effect of the flow curvature buckingham et al 2020 to quantify the difference between these three closures the submesoscale activity is measured by the percentage of the number of grid points with rossby numbers greater than 0 5 i e ξ f 0 5 over the domain fig 3a during the simulation period the trend of submesoscale activity generally varies consistently from the three closures despite the strong variabilities the magnitude of the submesoscale activity is generally stable before day 140 from the three schemes but begins to decrease after quantitative differences are observed during the simulation period during day 91 140 the gls has more active submesoscales than the kpp and my but the my simulates the most active submesoscales in day 141 161 with the percentage peaking on day 153 after day 161 the submesoscales from the gls become the most active again quantitatively the gls simulates the most active submesoscale processes 1 26 and 1 13 times stronger than the kpp and my schemes respectively the kpp simulates the moderate submesoscale activity while the my weakest 3 2 frontal density gradient the magnitude of the rossby number is believed to be the key measurement of the submesoscale activity nevertheless as an important form of the submesoscale processes submesoscale fronts associated with frontogenesis mcwilliams 2016 2021 are noticeable in the simulation result which can also be characterized by strong horizontal density gradient here the horizontal density gradient at the surface from the different closures is calculated on day 91 130 and 180 fig 4 as shown in fig 4 strong submesoscale fronts characterized by strong density gradients are found in regions around the eddy where the rossby numbers are large according to the density fronts one can also observe a similar eddy evolution to the rossby number the submesoscale feature of the density fronts suggests that the horizontal density gradient is another good indicator of the submesoscale activity as a result like the rossby number the percentage of grid points with strong density gradients 4 1 0 5 kg m 4 sensitivity tests show that a change of the threshold value does not change the temporal variability trend despite a quantitative difference at the surface over the domain is calculated fig 3b from day 91 to 126 the simulation results of the three schemes show similar trends and magnitudes and all of them gradually increase over time after day 127 the percentage from the gls simulation begins to decrease with time while the kpp and my results continue to increase and then decrease around day 150 quantitatively the magnitude of the simulated frontal strength percentage over the simulation period from the my is the largest and the peak can reach 0 75 and its average value is 1 18 and 1 34 times larger than that from the kpp and gls parameterization respectively different from the rossby number the gls simulates the weakest submesoscale fronts compared to the other schemes the inconsistency may be explained by the following aspects on one hand according to the relative vorticity equation the vorticity intensity is not only determined by the baroclinic effect from the horizontal density gradient related to fronts but also by the horizontal divergence convergence for the submesoscale processes here the ageostrophy becomes important and makes a non negligible contribution to the vorticity on the other hand it has been reported that mli and frontogenesis are the two dominant mechanisms for submesoscale activity in the surface mixed layer in the open ocean boccaletti et al 2007 capet et al 2008b mcwilliams 2016 however mli only requires a weak horizontal density gradient to generate submesoscales since the stratification is negligible in the mixed layer the strong fronts are more likely a result of frontogenesis as a result the intensity differences between the rossby number and the density gradient may be rational considering that the three closures scale different sub grid parameters 3 3 submesoscale energy budget ke in three dimensional turbulence tends to be transferred to small scales which eventually dissipate kolmogorov 1991 by contrast the two dimensional quasi geostrophic theory holds that an inverse cascade occurs in the inertial range above the scale where baroclinic instability converts the available potential energy ape to ke while an entropy cascade to small scales occurs at scales below charney 1971 kraichnan 1967 however submesoscale processes are neither isotropic three dimensional turbulence nor two dimensional quasi geostrophic turbulence implying a complicated energy transfer in the submesoscale the activity difference of the submesoscale from the different closures indicates differences in the submesoscale energy budget in this section the submesoscale kinetic energy smke potential energy smpe and the corresponding energy sources sinks including baroclinic transformation term bc barotropic transformation term bt and pe transfer from the background to submesoscale bsp are diagnosed and differences of these terms from the different turbulence closures are highlighted through the reynolds decomposition of three dimensional fluid the current is decomposed into the background component u mainly mesoscale currents here and submesoscale component u namely u u u here u is obtained by a high pass filter with a cutoff scale of 80 km this scale is about two times the local fastest growing mode of the mli l m l i 6 n m l h m l f dong et al 2020a where n ml is the buoyancy frequency averaged in the mixed layer and h m l is the mixed layer depth de boyer montégut et al 2004 here the mixed layer depth is defined as the depth at which the difference between the potential temperature at 10 m is equal to 0 2 o c the smke and smpe are then calculated as 2 s m k e 1 2 u 2 v 2 and 3 s m p e g 2 ρ 2 2 ρ 0 2 n 2 here g is the gravity acceleration ρ 0 is the seawater density constant ρ is the submesoscale density perturbation n is the buoyancy frequency eq 3 is derived from the linear definition of ape gill and adrian 1982 kang and fringer 2010 based on the submesoscale energy budget equation the smke and smpe budgets are determined by several terms appendix a cao et al 2021 in addition to energy conversions such as the bc bt and bsp terms the leakage at the boundary also makes a great contribution to the energy budget cao et al 2021 however the boundary leakage should be zero in this model here first the mesoscale eddy and the associated submesoscales are completely concentrated at the center of the model domain and the ocean is always in a motionless state near the boundaries all terms that contribute through the boundary will be eliminated after integrating the energy budget equation over the domain second the periodic boundary condition also ensures zero net boundary fluxes during the simulation meanwhile the sub grid dissipation of the smke and smpe by mixing is not discussed here the dissipation due to the vertical mixing is estimated to be at least two orders of magnitude smaller compared to the three terms while the horizontal mixing is not outputted in the model so the energy budget after the integration mainly depends on the following three items see appendix the bc term 4 b c 1 ρ 0 g ρ w and the bt term 5 b t u u u x u v u y v v v y v u v x in the submesoscale ke equation and the potential energy transferred from the background field to the submesoscale bsp in the submesoscale potential energy equation is defined as 6 b s p g 2 ρ 0 2 n 2 ρ u ρ x ρ v ρ y b c the overbar denotes spatial average 3 3 1 submesoscale kinetic and potential energy here the domain averaged smke and smpe in the upper 80 m the mean mixed layer depth of these three cases over the domain in the last 90 days are calculated as the submesoscale processes are mainly concentrated in the upper mixed layer fig 5 shows the time series of the averaged smke and smpe from the three parameterization schemes the smke simulated by the gls is stronger than the results of the kpp and my from day 105 to 140 and can reach 6 0 1 0 4 j kg 1 during day 141 153 the smke simulated by the my is the strongest reaching a peak value of 5 9 1 0 4 j kg 1 after day 153 the gls smke generally becomes the largest again quantitatively the mean values of the smke simulated by the three parameterization schemes are as follows gls 5 2 1 0 4 j kg 1 my 4 7 1 0 4 j kg 1 kpp 4 5 1 0 4 j kg 1 for the smpe its trend simulated by the schemes is generally consistent the averaged smpe simulated by the three parameterization schemes are sorted as follows gls 1 738 1 0 4 j kg 1 my 1 651 1 0 4 j kg 1 kpp 1 570 1 0 4 j kg 1 it is noteworthy that the smpe is comparable to the smke which implies a less important role of stratification in submesoscales compared to large and mesoscales overall both the smke and smpe have generally increasing trends from all these turbulence closures indicating a dynamic consistency between these closures from an energy evolution perspective this increasing trend is quite different from the variation of the rossby number or the density gradient shown in fig 3 it should be claimed that the rossby number and the density gradient in fig 4 are the results at the surface but the smke and smpe here are averaged values within the mixed layer nevertheless the comparisons above indicate that the gls tends to simulate the strongest submesoscales while the my simulates moderate ones and the kpp weakest as discussed at the beginning of this section the differences in the smke and smpe from the closures should be tightly related to the energy sources sinks bc bt and bsp respectively in the following sections these three terms are calculated and analyzed 3 3 2 baroclinic conversion bc dynamically the bc term is equivalent to the vertical buoyancy flux for submesoscale processes which has been demonstrated to be a dominant contributor to the submesoscale energy budget boccaletti et al 2007 mensa et al 2013 the baroclinic instability leads to the transfer of the mesoscale ape to the smpe when the bc is positive the bc is calculated based on eq 4 and the bc on day 130 is shown in fig 6 large values of the bc averaged in the mixed layer are mainly concentrated in the eddy region and have consistent spatial patterns with the rossby number fig 6a b c the bc is dominated by positive values from the three schemes despite negative values implying overall a positive contribution of the bc to the smke through the release of the ape boccaletti et al 2007 capet et al 2008a b c the lateral section of the bc averaged in the zonal direction indicates that large bc values are mainly constrained in the mixed layer and sharply decreased as depth increases below the mixed layer fig 6d e f nevertheless the bc stripes can also penetrate the mixed layer base and into the ocean interior the penetration of mixed layer submesoscales has been reported based on mooring observations and zhang et al 2021 suggested calling it mixed transitional layer instability despite that a constant mixed layer depth is used for the bc calculation shoaling of the mixed layer at the eddy is observed black dash line in fig 6d e f which should be a result of restratifying by the submesoscales boccaletti et al 2007 thomas et al 2008 yu et al 2019 in addition to the consistency of the bc between these three schemes differences are observed in fig 6 on day 130 shown here the large values of the bc averaged in the mixed layer mainly concentrate at the eddy periphery and the bc is generally weak at the core from the kpp and gls cases while strong bc values are still observed at the eddy core from the my case their quantitative differences are highlighted by the vertical profiles averaged over the domain fig 6g it can be seen that the variation of the bc simulated by three parameterization schemes with depth is generally similar first increase and then decrease as depth increases with maximums at about 30 m the kpp and my have close maximum bc values but the bc from the gls is about 1 5 times larger up to 6 3 1 0 10 w kg 1 a similar conclusion is drawn from the time series of the bc averaged within the mixed layer over the domain fig 7a the bc from the kpp and my is close in magnitude but the gls simulates stronger bc again all three schemes show a consistent decreasing trend of the bc during the simulation time another interesting point that is noteworthy is that the mixed layer depths exhibit differences between these three cases even at the regions away from the eddy the differences may be tightly related to the different determination methods of the boundary layer depth from the three closures 3 3 3 barotropic conversion bt the bt term here represents the ke transfer rate between submesoscales and mesoscales through their nonlinear interactions note that the vertical shear related terms in the bt have been omitted eq 5 because of the relatively small magnitudes zhang et al 2021 the bt averaged in the mixed layer shows alternating patterns of negative and positive values horizontally fig 8a b c obviously the magnitudes of the bt simulated by the my and gls are stronger than that by the kpp the negative and positive values indicate that the submesoscales can not only extract ke from the mesoscales i e forward cascade but also transfer ke upward to the mesoscales i e inverse cascade the zonally averaged bt also alternates between positive and negative stripes but the negative values are obviously stronger than the positive ones fig 8d e f the dominance of the negative values is highlighted by the vertical profiles averaged over the domain fig 8g the bt profiles from the three cases peak at the surface and decay sharply with depth beneath the mixed layer the bt is negligible compared to the surface maximums overall the submesoscale tends to inversely transfer its ke to large and meso scales this inverse cascade is believed to be a significant contributor to the mesoscale ke variability sasaki et al 2017 schubert et al 2020 and submesoscale seasonality dong et al 2020b similar to the bc the kpp and my have similar intensities and variations of the bt magnitude while the bt from the gls is much larger and the difference is mainly near the surface at the surface the bt from the gls is 1 41 and 1 35 times larger compared to that from the kpp and my respectively as depth reaches below 20 m the bt differences from the three closures become smaller and smaller different from the bc the time series of the bt within the mixed layer over the domain show no variation trend during the simulation period although remarkable variabilities of the bt are observed at certain times fig 7b 3 3 4 background to submesoscale potential energy bsp the release of the background pe is transferred to smpe and part of this energy is finally converted to smke 6 cao et al 2021 the bsp represents the conversion of the pe to the remaining smpe according to the smpe budget equation appendix the bsp is the main source for the smpe since there is no energy input through the sea surface and lateral boundaries if the bsp is positive it indicates a transfer of the background pe to the smpe while it is a transfer from the smpe to the background pe for the negative bsp fig 9 shows the bsp on day 130 positive and negative bsp values are observed from the average in the mixed layer fig 9a b c the bsp patterns are also modulated by the eddy and strong bsp values are concentrated at the eddy periphery from all the closures the lateral sections of the zonally averaged bsp also indicate that the bsp is mainly distributed in the mixed layer fig 9d e f despite alternating bsp values the positive value generally dominates over the negative one indicating a downscale transfer of the potential energy to the submesoscale similar to the bt the maximal bsp appears at the surface and gradually weakens with depth increase fig 9g the my has the weakest bsp and the kpp simulates a close one to the my in comparison the bsp from the gls is the largest 1 33 times and 1 67 times larger than that from the kpp and my respectively during the simulation period the bsp has a decreasing trend which is observed from all three closures fig 7c nevertheless the bsp from the kpp and my schemes are closer in intensity and significantly weaker than those of the gls accounting for 70 38 and 57 30 of the bsp intensity from the gls respectively 4 discussion and conclusions 4 1 discussion based on the results above a direct comparison between these three closures is conducted by averaging the smke smpe bc bt and bsp in the mixed layer over the domain during the simulation period to make the energy contents smke smpe and the conversion rates bc bt bsp comparable the energy contents are directly averaged over the domain during the simulation period while the conversion rates are integrated over the simulation period and then averaged over the domain the calculated magnitudes of these terms are shown in fig 10 which can be concluded as follows the order of the smke magnitudes is gls 0 52 10 3 j kg 1 my 0 47 10 3 j kg 1 kpp 0 45 10 3 j kg 1 the bc is the main source for the smke following gls 3 7 10 3 j kg 1 kpp 2 8 10 3 j kg 1 my 2 7 10 3 j kg 1 the bt is negative and tends to transfer smke upscale to larger scales with an order of gls 4 3 10 3 j kg 1 my 4 0 10 3 j kg 1 kpp 3 7 10 3 j kg 1 for smpe the magnitudes are gls 0 174 10 3 j kg 1 my 0 165 10 3 j kg 1 kpp 0 157 10 3 j kg 1 as the main source for the smpe the bsp follows gls 1 1 10 3 j kg 1 kpp 0 81 10 3 j kg 1 my 0 73 10 3 j kg 1 in conclusion the magnitudes from the gls are always the strongest compared to the other two the kpp is relatively stronger than the my for the most terms except the bt in this work an idealized mesoscale eddy is constructed to investigate the submesoscale dependence on turbulence closures however several limitations need to be noted first the dynamics is simplified in this idealized model and there is only an anticyclonic eddy in the background state one can presume that the situation will become much more complicated in a realistic model due to multiscale interactions such as the generation of mesoscale eddies and interaction between mesoscale eddies and other scales processes cao et al 2021 second the air sea fluxes are turned off in the model which are believed to exert significant effects on the mixed layer dynamics and the submesoscale for example the ekman transport associated with the surface momentum flux potentially modulates front intensity thomas and lee 2005 the mixed layer restratification by submesoscales is potentially counteracted by the destabilization from the surface buoyancy flux yu et al 2019 lastly the results here are also subject to the model resolution despite that the model with 1 km is believed to resolve mli and relatively large scale frontogenesis smaller scale frontogenesis processes and symmetric instability are not included dong et al 2021a 4 2 conclusions based on simulating submesoscales generated by an idealized mesoscale eddy using different turbulence parameterization schemes this paper analyzes some measurements associated with submesoscales including the rossby number frontal density gradient and submesoscale energy budget to investigate the submesoscale dependence on three turbulence closures kpp my and gls the following conclusions are drawn 1 the mesoscale eddy generates active submesoscales confined in the surface mixed layer the rossby number horizontal gradient smke and smpe are believed to well reflect the submesoscale activity which shows that all the three cases simulate similar variation trends of the submesoscale activity however the gls tends to simulate the most active submesoscales according to the energy contents smke and smpe the submesoscale intensity from the three turbulent follows the order gls my kpp 2 three terms bc bt and bsp in the submesoscale energy budget are analyzed based on the simulation results from the different turbulence closures according to the analysis all the closures simulate the same qualitative contribution from these terms the bc is demonstrated to be the main source the smke while the bt is an energy sink transferring smke to larger scales the magnitudes of the bc and bt from these three closures are gls kpp my for the bc gls my kpp for the bt the bsp is an energy source for the smpe whose intensity is gls kpp my in this paper we focus on the submesoscale simulation from different turbulent closure schemes despite that all these schemes simulate a similar trend of submesoscales their quantitative differences of submesoscales are highlighted as stated in the introduction these three closures parameterize the turbulent mixing using different methods which should be the reason for these differences however the underlying mechanism how these closures dynamically generate the submesoscale differences is unknown here it is impossible to argue which closure is the best in terms of submesoscale simulation until observation with high spatiotemporal resolution and enough spatiotemporal coverage focusing on submesoscales is conducted meanwhile the conclusions here are applicable for larger scale submesoscale processes that are generated by mli or frontogenesis more submesoscales generated by other mechanisms such as symmetric instability are expected to be resolved as the model resolution increases and more works should be made in the future to address the closure dependence under higher resolution simulations nevertheless the results here are meaningful to remind people that due care should be taken for quantitative studies of submesoscales based on simulations despite the turbulence closures showing a dynamic consistency credit authorship contribution statement yifan wang formal analysis validation writing original draft writing review editing jihai dong conceptualization data curation methodology writing review editing funding acquisition chengzhen ji writing original draft writing review editing funding acquisition changming dong supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china 42176023 and shandong provincial key laboratory of marine ecology and environment disaster prevention and mitigation 201903 our deepest gratitude goes to the anonymous reviewers for their careful work and thoughtful suggestions that have helped improve this paper substantially appendix submesoscale energy budget equations the momentum equation for the east west velocity u is a 1 u t u u x v u y w u z f v 1 ρ 0 p x h a h h u z a v u z here u is decomposed into the time averaged component and turbulence component u u u other external forces are neglected in the equation in this work the mean quantity u represents the mesoscale circulation and the turbulence quantity u represents the submesoscale process substituting them into eq a 1 yields a 2 t u u u u x u u v v y u u w w z u u f v v 1 ρ 0 x p p h a h h u h u z a v z u u taking the reynolds average for a 2 one can get a 3 u t u u x v u y w u z u u x v u y w u z f v 1 ρ 0 p x h a h h u z a v u z then the momentum equation for submesoscale velocity is obtained by combining a 2 and a 3 a 4 u t u u x u u x u u x v u y v u y v u y w u z w u z w u z f v 1 ρ 0 p x h a h h u z a v u z u u x v u y w u z multiplying a 4 by u and taking the reynolds average the submesoscale kinetic energy equation is derived as a 5 k t u 2 u x u k x u v u y v k y u w u z w k z f u v 1 ρ 0 u p x u h a h h u u z a v u z where k u 2 2 is the submesoscale kinetic energy in the u direction in the same way the submesoscale kinetic energy in the north south direction m v 2 2 is obtained as follows a 6 m t u v v x u m x v 2 v y v m y v w v z w m z f u v 1 ρ 0 v p y v h a h h v v z a v v z a 7 l t u w w x u l x v w w y v l y w 2 w z w l z 1 ρ 0 w p z 1 ρ 0 g ρ w w h a h h w w z a v w z define s m k e k m l u u i v j w k and ignore the higher order terms related to w finally a 8 s m k e t 1 2 u u 2 v 2 a d k 1 ρ 0 u p p w 1 ρ 0 g ρ w b c u u u u u v b t d k here d k represents the kinetic energy dissipation from sub grid processes which will not be discussed in this work integrating the equation over the whole domain one can find that the adk advection of submesoscale kinetic energy and pw pressure work in eq a 8 are determined by the lateral boundary fluxes given the ocean is always quiescent near the model boundaries away from the eddy the two terms are believed to negligible and not calculated for analysis similarly the submesoscale potential energy equation is integrated and written as a 9 s m p e t u g 2 ρ 2 2 ρ 0 2 n 2 a d p g 2 ρ 0 2 n 2 ρ u ρ g ρ 0 ρ w b s p d p here the adp is the advection of the submesoscale potential energy which is also determined by the boundary fluxes and is supposed to be zero in the model d p is the dissipation of the potential energy 
23808,submesoscale processes with spatiotemporal scales of 0 1 10 km and hours to 1 day play an important role in the ocean energy cascade and material transport up to now most studies focusing on submesoscales are based on high resolution numerical simulations since observations are scarce due to a limitation of their small scales however numerical studies on submesoscales deeply depend on the choice of sub grid turbulence closures that are of significance in determining the simulation performance here submesoscale processes generated at an idealized mesoscale eddy are investigated based on a 1 km resolution regional ocean modeling system roms model and the model performance in terms of submesoscales is analyzed and emphasized with three popular turbulence closure schemes k profile parameterization kpp mellor yamada my and general length scale closure schemes gls the analysis shows that the magnitude of the submesoscale kinetic and potential energy follows gls my kpp despite a general consistent variation by the three closures to figure out the dominant factors controlling the submesoscale energy budget three terms including the baroclinic term bc the barotropic term bt and the background to submesoscale potential energy conversion term bsp are analyzed the results show that the bc is the source of submesoscale kinetic energy while the bt tends to transfer submesoscale kinetic energy to mesoscales inversely and the bsp is the submesoscale potential energy source in comparison the gls simulates the largest bc bt and bsp overall the order of the bc and bsp is gls kpp my and the order of the bt is gls my kpp keywords submesoscale numerical simulation turbulence closure energy cascade 1 introduction the ocean contains multi scale dynamic processes such as large scale circulation mesoscale eddies submesoscale processes and microscale mixing these processes are closely related and tend to interact across scales in the past few decades lots of studies have been carried out focusing on large meso and micro scale processes e g chelton et al 2011 kevin et al 2020 zhu et al 2021 based on in situ observations satellite retrievals and numerical simulations however submesoscales have been not noticed until the last decade benefiting from the development of physical oceanography and the improvement of model resolution submesoscale processes have rossby and richardson numbers of unity with intermediate spatiotemporal scales i e o 0 1 10 km and hours to 1 day mcwilliams 2016 submesoscale processes are of great significance for mesoscale energy budget and micro scale mixing and play an important role in ocean energy cascades capet et al 2008c d asaro et al 2011 zhang et al 2016 sasaki et al 2017 yang et al 2017 2019 dong et al 2020b a bidirectional energy transfer by submesoscales has been demonstrated on one hand submesoscales promote the forward energy cascade elevating local mixing e g capet et al 2008c yang et al 2017 cao et al 2021 on the other hand submesoscales also transfer the energy inversely to larger scales modulating the mesoscale variability deeply e g sasaki et al 2017 dong et al 2020b at the same time submesoscales are strong non geostrophic processes because of ro o 1 the strong vertical velocity 10 100 m day caused by them has a great contribution to the vertical heat and material transport taylor and ferrari 2011 lévy et al 2012 fox kemper and ferrari 2008 fox kemper et al 2008 2011 used an overturning streamfunction to parameterize vertical buoyancy fluxes induced by the submesoscale baroclinic instability or mixed layer instability mli and optimized the simulation results of climate models to some extent the small spatiotemporal scale is the main reason for limiting observational research on submesoscale processes nevertheless some works have studied submesoscale processes using observations which deepens our understanding of them for example pollard and regier 1992 found strong ageostrophic submesoscale flow with vertical velocities up to 40 m day 1 by solving the omega equation based on in situ observations in the western atlantic ocean hosegood et al 2006 also reported submesoscale induced high frequency layered structure in the surface mixed layer in the north pacific subtropical front most of these results are based on instantaneous observations and the temporal variability of submesoscales is hard to tell recently high resolution mooring arrays make it possible to investigate the temporal feature of submesoscales using subsurface mooring arrays in the north atlantic and the northwest pacific buckingham et al 2016 and zhang et al 2021 both revealed strong seasonality of submesoscales in the surface mixed layer and further mechanisms were discussed although mooring observations can describe the temporal variability of submesoscales their limited spatial coverage most of the calculated results are single point time series obviously cannot satisfy the study of the spatial distribution of submesoscale processes therefore the development of numerical simulation as an important method for ocean research has played an irreplaceable role in promoting the study of submesoscale processes given the limitations of observational methods high resolution numerical models make it possible to understand the basic dynamics and spatiotemporal distribution characteristics of submesoscale processes globally su et al 2018 the state of the art knowledge of submesoscales such as their seasonality more active in winter e g mensa et al 2013 dong and zhong 2018 generation submesoscale baroclinic instability and frontogenesis e g boccaletti et al 2007 capet et al 2008b fox kemper and ferrari 2008 and inverse cascade e g sasaki et al 2017 dong et al 2020a b schubert et al 2020 mostly stem from high resolution simulations one should admit that biases always exist between the numerical simulation and the real ocean and the sub grid turbulence closure exerts a great effect on the simulation performance however there is no best turbulence scheme as the ocean dynamics is complicated and varies from one region to another so far three parameterization schemes k profile parameterization kpp large et al 1994 mellor yamada 2 5 my mellor and yamada 1982 and generic length scale gls umlauf and burchard 2003 have been verified by experiments which are relatively mature and widely accepted the kpp parameterizes the turbulent stress which is not limited by the time step and parameterizes it based on the background mean flow parameters without considering the change of the turbulent potential energy due to turbulent mixing the my and gls schemes parameterize the turbulent kinetic energy ke and consider the turbulent ke conservation the main difference between the my and gls schemes is the determination of the length scale for solving the turbulent ke equation reichl and hallberg 2018 however the time step for these two schemes should be no longer than the order of minutes the time scale of the turbulence evolution and the parameterization results for the low reynolds number and the near wall region are not in line with expectations reichl and hallberg 2018 the simulation of submesoscale processes requires high spatial resolution and short time steps of high resolution models are prone to satisfy the time step requirement of the my and gls parameterizations while the kpp works well in larger scale simulations whether it is still applicable to high resolution models and simulations of submesoscale processes as the resolution increases is still a question for example the kpp fails to capture the dissipation by submesoscale symmetric instability bachman et al 2017 dong et al 2021b this paper analyzes submesoscale processes simulated by different parameterization schemes kpp my and gls from various perspectives including the rossby number frontal density gradient and energy budget to clarify the dependence of submesoscale simulation on the turbulent closure schemes the structure of this paper is organized as follows section 2 introduces the model and the configurations section 3 shows the results of the submesoscale dependence on the three parameterization schemes finally the summary and discussion are presented in section 4 2 model configuration the simulation is conducted based on the regional ocean modeling system roms shchepetkin and mcwilliams 2005 roms is a free surface terrain following primitive equations ocean model which is widely used in regional ocean simulations especially for submesoscales e g capet et al 2008a zhong and bracco 2013 taking the climatological temperature profile over the kuroshio extension region as the background state to simplify the problem the salinity in the model is taken as a constant this work constructs an idealized anticyclonic mesoscale eddy to generate submesoscales fig 1 previous studies have shown that anticyclonic eddies tend to favor more submesoscales than cyclonic ones as a result of more easily outcropping of the isopycnals e g brannigan et al 2017 according to the universal structure of mesoscale eddies by zhang et al 2013 the following expression is used to construct the temperature anomaly field associated with the eddy 1 t t 0 r r h z where t 0 2 o c is the amplitude of the temperature anomaly caused by the eddy r r 1 r r 0 2 2 e r r 0 2 2 is the horizontal structure of the eddy r 0 60 km is the vortex radius derived from the local hydrographic profile and water depth h z is the eddy vertical structure which is a sine function in the new coordinate z s 0 z n f d z n is the buoyancy frequency f is the coriolis parameter refer to zhang et al 2013 the simulation domain is 600 km 600 km with a spatial resolution of 1 km the model has 60 layers with a constant water depth of 1000 m with a finer resolution up to 1 m near the surface layer the lateral boundary is periodic and no atmospheric forcing is added the coriolis parameter of the model is taken as a constant f 1 1 0 4 s 1 to ensure that the eddy does not move due to the β effect in this paper three experiments are carried out using different turbulence closure schemes including the kpp my and gls the model starts from a quiescent state i e no ocean flow with no sea surface height and is simulated for 180 days as the eddy evolves an analysis of the surface rossby number indicates that the mesoscale currents become favorable in generating submesoscales after 50 days and the submesoscale activity reaches a relatively steady stage after 90 days not shown here 3 results as the eddy evolves the eddy induced currents and the associated shear and strain favor submesoscales at the eddy in this section the submesoscales are analyzed in terms of the rossby number frontal density gradient and submesoscale energy budget to highlight the differences among the three turbulence closures 3 1 rossby number the normalized relative vorticity ξ f the vertical relative vorticity ξ v x u y hereinafter referred to as the rossby number is an important parameter to characterize the activity of submesoscale processes with the rossby number ro 1 fig 2 shows the surface rossby number from different vertical mixing parameterization schemes on day 91 130 and 180 after the adjustment of the eddy current large ro values around 1 are ubiquitous at the eddy as the eddy evolves and loses its stability indicating active submesoscale processes due to instabilities on day 91 the eddy still has a coherent structure with active submesoscale eddies and filaments within it the three closures simulate similar spatial patterns despite differences in the details of the submesoscale structures and locations however as the submesoscales continue to grow with time on day 130 the structure of the eddy is destroyed and the submesoscales begin to spread out the submesoscales concentrate at the eddy periphery and the eddy core tends to restore the geostrophic balance with small negative ro values at the same time the structure of eddy and the spatial distribution of submesoscales from the parameterization schemes begin to differ compared with the results on day 130 the rossby number intensity from the three cases consistently weakened on day 180 despite of the differences of the spatial patterns the evolution of the submesoscales shows a statistical consistency during the simulation period indicating the robustness of the capability of these three closures in simulating submesoscale dynamics it is noteworthy that there is an asymmetry in the distribution of submesoscale relative vorticity during the evolution that is the cyclonic i e positive vorticity is generally more and stronger than the anticyclonic i e negative one this asymmetry can be explained by several mechanisms including inertial instability capet et al 2008a strain induced frontogenesis mcwilliams 2016 and the effect of the flow curvature buckingham et al 2020 to quantify the difference between these three closures the submesoscale activity is measured by the percentage of the number of grid points with rossby numbers greater than 0 5 i e ξ f 0 5 over the domain fig 3a during the simulation period the trend of submesoscale activity generally varies consistently from the three closures despite the strong variabilities the magnitude of the submesoscale activity is generally stable before day 140 from the three schemes but begins to decrease after quantitative differences are observed during the simulation period during day 91 140 the gls has more active submesoscales than the kpp and my but the my simulates the most active submesoscales in day 141 161 with the percentage peaking on day 153 after day 161 the submesoscales from the gls become the most active again quantitatively the gls simulates the most active submesoscale processes 1 26 and 1 13 times stronger than the kpp and my schemes respectively the kpp simulates the moderate submesoscale activity while the my weakest 3 2 frontal density gradient the magnitude of the rossby number is believed to be the key measurement of the submesoscale activity nevertheless as an important form of the submesoscale processes submesoscale fronts associated with frontogenesis mcwilliams 2016 2021 are noticeable in the simulation result which can also be characterized by strong horizontal density gradient here the horizontal density gradient at the surface from the different closures is calculated on day 91 130 and 180 fig 4 as shown in fig 4 strong submesoscale fronts characterized by strong density gradients are found in regions around the eddy where the rossby numbers are large according to the density fronts one can also observe a similar eddy evolution to the rossby number the submesoscale feature of the density fronts suggests that the horizontal density gradient is another good indicator of the submesoscale activity as a result like the rossby number the percentage of grid points with strong density gradients 4 1 0 5 kg m 4 sensitivity tests show that a change of the threshold value does not change the temporal variability trend despite a quantitative difference at the surface over the domain is calculated fig 3b from day 91 to 126 the simulation results of the three schemes show similar trends and magnitudes and all of them gradually increase over time after day 127 the percentage from the gls simulation begins to decrease with time while the kpp and my results continue to increase and then decrease around day 150 quantitatively the magnitude of the simulated frontal strength percentage over the simulation period from the my is the largest and the peak can reach 0 75 and its average value is 1 18 and 1 34 times larger than that from the kpp and gls parameterization respectively different from the rossby number the gls simulates the weakest submesoscale fronts compared to the other schemes the inconsistency may be explained by the following aspects on one hand according to the relative vorticity equation the vorticity intensity is not only determined by the baroclinic effect from the horizontal density gradient related to fronts but also by the horizontal divergence convergence for the submesoscale processes here the ageostrophy becomes important and makes a non negligible contribution to the vorticity on the other hand it has been reported that mli and frontogenesis are the two dominant mechanisms for submesoscale activity in the surface mixed layer in the open ocean boccaletti et al 2007 capet et al 2008b mcwilliams 2016 however mli only requires a weak horizontal density gradient to generate submesoscales since the stratification is negligible in the mixed layer the strong fronts are more likely a result of frontogenesis as a result the intensity differences between the rossby number and the density gradient may be rational considering that the three closures scale different sub grid parameters 3 3 submesoscale energy budget ke in three dimensional turbulence tends to be transferred to small scales which eventually dissipate kolmogorov 1991 by contrast the two dimensional quasi geostrophic theory holds that an inverse cascade occurs in the inertial range above the scale where baroclinic instability converts the available potential energy ape to ke while an entropy cascade to small scales occurs at scales below charney 1971 kraichnan 1967 however submesoscale processes are neither isotropic three dimensional turbulence nor two dimensional quasi geostrophic turbulence implying a complicated energy transfer in the submesoscale the activity difference of the submesoscale from the different closures indicates differences in the submesoscale energy budget in this section the submesoscale kinetic energy smke potential energy smpe and the corresponding energy sources sinks including baroclinic transformation term bc barotropic transformation term bt and pe transfer from the background to submesoscale bsp are diagnosed and differences of these terms from the different turbulence closures are highlighted through the reynolds decomposition of three dimensional fluid the current is decomposed into the background component u mainly mesoscale currents here and submesoscale component u namely u u u here u is obtained by a high pass filter with a cutoff scale of 80 km this scale is about two times the local fastest growing mode of the mli l m l i 6 n m l h m l f dong et al 2020a where n ml is the buoyancy frequency averaged in the mixed layer and h m l is the mixed layer depth de boyer montégut et al 2004 here the mixed layer depth is defined as the depth at which the difference between the potential temperature at 10 m is equal to 0 2 o c the smke and smpe are then calculated as 2 s m k e 1 2 u 2 v 2 and 3 s m p e g 2 ρ 2 2 ρ 0 2 n 2 here g is the gravity acceleration ρ 0 is the seawater density constant ρ is the submesoscale density perturbation n is the buoyancy frequency eq 3 is derived from the linear definition of ape gill and adrian 1982 kang and fringer 2010 based on the submesoscale energy budget equation the smke and smpe budgets are determined by several terms appendix a cao et al 2021 in addition to energy conversions such as the bc bt and bsp terms the leakage at the boundary also makes a great contribution to the energy budget cao et al 2021 however the boundary leakage should be zero in this model here first the mesoscale eddy and the associated submesoscales are completely concentrated at the center of the model domain and the ocean is always in a motionless state near the boundaries all terms that contribute through the boundary will be eliminated after integrating the energy budget equation over the domain second the periodic boundary condition also ensures zero net boundary fluxes during the simulation meanwhile the sub grid dissipation of the smke and smpe by mixing is not discussed here the dissipation due to the vertical mixing is estimated to be at least two orders of magnitude smaller compared to the three terms while the horizontal mixing is not outputted in the model so the energy budget after the integration mainly depends on the following three items see appendix the bc term 4 b c 1 ρ 0 g ρ w and the bt term 5 b t u u u x u v u y v v v y v u v x in the submesoscale ke equation and the potential energy transferred from the background field to the submesoscale bsp in the submesoscale potential energy equation is defined as 6 b s p g 2 ρ 0 2 n 2 ρ u ρ x ρ v ρ y b c the overbar denotes spatial average 3 3 1 submesoscale kinetic and potential energy here the domain averaged smke and smpe in the upper 80 m the mean mixed layer depth of these three cases over the domain in the last 90 days are calculated as the submesoscale processes are mainly concentrated in the upper mixed layer fig 5 shows the time series of the averaged smke and smpe from the three parameterization schemes the smke simulated by the gls is stronger than the results of the kpp and my from day 105 to 140 and can reach 6 0 1 0 4 j kg 1 during day 141 153 the smke simulated by the my is the strongest reaching a peak value of 5 9 1 0 4 j kg 1 after day 153 the gls smke generally becomes the largest again quantitatively the mean values of the smke simulated by the three parameterization schemes are as follows gls 5 2 1 0 4 j kg 1 my 4 7 1 0 4 j kg 1 kpp 4 5 1 0 4 j kg 1 for the smpe its trend simulated by the schemes is generally consistent the averaged smpe simulated by the three parameterization schemes are sorted as follows gls 1 738 1 0 4 j kg 1 my 1 651 1 0 4 j kg 1 kpp 1 570 1 0 4 j kg 1 it is noteworthy that the smpe is comparable to the smke which implies a less important role of stratification in submesoscales compared to large and mesoscales overall both the smke and smpe have generally increasing trends from all these turbulence closures indicating a dynamic consistency between these closures from an energy evolution perspective this increasing trend is quite different from the variation of the rossby number or the density gradient shown in fig 3 it should be claimed that the rossby number and the density gradient in fig 4 are the results at the surface but the smke and smpe here are averaged values within the mixed layer nevertheless the comparisons above indicate that the gls tends to simulate the strongest submesoscales while the my simulates moderate ones and the kpp weakest as discussed at the beginning of this section the differences in the smke and smpe from the closures should be tightly related to the energy sources sinks bc bt and bsp respectively in the following sections these three terms are calculated and analyzed 3 3 2 baroclinic conversion bc dynamically the bc term is equivalent to the vertical buoyancy flux for submesoscale processes which has been demonstrated to be a dominant contributor to the submesoscale energy budget boccaletti et al 2007 mensa et al 2013 the baroclinic instability leads to the transfer of the mesoscale ape to the smpe when the bc is positive the bc is calculated based on eq 4 and the bc on day 130 is shown in fig 6 large values of the bc averaged in the mixed layer are mainly concentrated in the eddy region and have consistent spatial patterns with the rossby number fig 6a b c the bc is dominated by positive values from the three schemes despite negative values implying overall a positive contribution of the bc to the smke through the release of the ape boccaletti et al 2007 capet et al 2008a b c the lateral section of the bc averaged in the zonal direction indicates that large bc values are mainly constrained in the mixed layer and sharply decreased as depth increases below the mixed layer fig 6d e f nevertheless the bc stripes can also penetrate the mixed layer base and into the ocean interior the penetration of mixed layer submesoscales has been reported based on mooring observations and zhang et al 2021 suggested calling it mixed transitional layer instability despite that a constant mixed layer depth is used for the bc calculation shoaling of the mixed layer at the eddy is observed black dash line in fig 6d e f which should be a result of restratifying by the submesoscales boccaletti et al 2007 thomas et al 2008 yu et al 2019 in addition to the consistency of the bc between these three schemes differences are observed in fig 6 on day 130 shown here the large values of the bc averaged in the mixed layer mainly concentrate at the eddy periphery and the bc is generally weak at the core from the kpp and gls cases while strong bc values are still observed at the eddy core from the my case their quantitative differences are highlighted by the vertical profiles averaged over the domain fig 6g it can be seen that the variation of the bc simulated by three parameterization schemes with depth is generally similar first increase and then decrease as depth increases with maximums at about 30 m the kpp and my have close maximum bc values but the bc from the gls is about 1 5 times larger up to 6 3 1 0 10 w kg 1 a similar conclusion is drawn from the time series of the bc averaged within the mixed layer over the domain fig 7a the bc from the kpp and my is close in magnitude but the gls simulates stronger bc again all three schemes show a consistent decreasing trend of the bc during the simulation time another interesting point that is noteworthy is that the mixed layer depths exhibit differences between these three cases even at the regions away from the eddy the differences may be tightly related to the different determination methods of the boundary layer depth from the three closures 3 3 3 barotropic conversion bt the bt term here represents the ke transfer rate between submesoscales and mesoscales through their nonlinear interactions note that the vertical shear related terms in the bt have been omitted eq 5 because of the relatively small magnitudes zhang et al 2021 the bt averaged in the mixed layer shows alternating patterns of negative and positive values horizontally fig 8a b c obviously the magnitudes of the bt simulated by the my and gls are stronger than that by the kpp the negative and positive values indicate that the submesoscales can not only extract ke from the mesoscales i e forward cascade but also transfer ke upward to the mesoscales i e inverse cascade the zonally averaged bt also alternates between positive and negative stripes but the negative values are obviously stronger than the positive ones fig 8d e f the dominance of the negative values is highlighted by the vertical profiles averaged over the domain fig 8g the bt profiles from the three cases peak at the surface and decay sharply with depth beneath the mixed layer the bt is negligible compared to the surface maximums overall the submesoscale tends to inversely transfer its ke to large and meso scales this inverse cascade is believed to be a significant contributor to the mesoscale ke variability sasaki et al 2017 schubert et al 2020 and submesoscale seasonality dong et al 2020b similar to the bc the kpp and my have similar intensities and variations of the bt magnitude while the bt from the gls is much larger and the difference is mainly near the surface at the surface the bt from the gls is 1 41 and 1 35 times larger compared to that from the kpp and my respectively as depth reaches below 20 m the bt differences from the three closures become smaller and smaller different from the bc the time series of the bt within the mixed layer over the domain show no variation trend during the simulation period although remarkable variabilities of the bt are observed at certain times fig 7b 3 3 4 background to submesoscale potential energy bsp the release of the background pe is transferred to smpe and part of this energy is finally converted to smke 6 cao et al 2021 the bsp represents the conversion of the pe to the remaining smpe according to the smpe budget equation appendix the bsp is the main source for the smpe since there is no energy input through the sea surface and lateral boundaries if the bsp is positive it indicates a transfer of the background pe to the smpe while it is a transfer from the smpe to the background pe for the negative bsp fig 9 shows the bsp on day 130 positive and negative bsp values are observed from the average in the mixed layer fig 9a b c the bsp patterns are also modulated by the eddy and strong bsp values are concentrated at the eddy periphery from all the closures the lateral sections of the zonally averaged bsp also indicate that the bsp is mainly distributed in the mixed layer fig 9d e f despite alternating bsp values the positive value generally dominates over the negative one indicating a downscale transfer of the potential energy to the submesoscale similar to the bt the maximal bsp appears at the surface and gradually weakens with depth increase fig 9g the my has the weakest bsp and the kpp simulates a close one to the my in comparison the bsp from the gls is the largest 1 33 times and 1 67 times larger than that from the kpp and my respectively during the simulation period the bsp has a decreasing trend which is observed from all three closures fig 7c nevertheless the bsp from the kpp and my schemes are closer in intensity and significantly weaker than those of the gls accounting for 70 38 and 57 30 of the bsp intensity from the gls respectively 4 discussion and conclusions 4 1 discussion based on the results above a direct comparison between these three closures is conducted by averaging the smke smpe bc bt and bsp in the mixed layer over the domain during the simulation period to make the energy contents smke smpe and the conversion rates bc bt bsp comparable the energy contents are directly averaged over the domain during the simulation period while the conversion rates are integrated over the simulation period and then averaged over the domain the calculated magnitudes of these terms are shown in fig 10 which can be concluded as follows the order of the smke magnitudes is gls 0 52 10 3 j kg 1 my 0 47 10 3 j kg 1 kpp 0 45 10 3 j kg 1 the bc is the main source for the smke following gls 3 7 10 3 j kg 1 kpp 2 8 10 3 j kg 1 my 2 7 10 3 j kg 1 the bt is negative and tends to transfer smke upscale to larger scales with an order of gls 4 3 10 3 j kg 1 my 4 0 10 3 j kg 1 kpp 3 7 10 3 j kg 1 for smpe the magnitudes are gls 0 174 10 3 j kg 1 my 0 165 10 3 j kg 1 kpp 0 157 10 3 j kg 1 as the main source for the smpe the bsp follows gls 1 1 10 3 j kg 1 kpp 0 81 10 3 j kg 1 my 0 73 10 3 j kg 1 in conclusion the magnitudes from the gls are always the strongest compared to the other two the kpp is relatively stronger than the my for the most terms except the bt in this work an idealized mesoscale eddy is constructed to investigate the submesoscale dependence on turbulence closures however several limitations need to be noted first the dynamics is simplified in this idealized model and there is only an anticyclonic eddy in the background state one can presume that the situation will become much more complicated in a realistic model due to multiscale interactions such as the generation of mesoscale eddies and interaction between mesoscale eddies and other scales processes cao et al 2021 second the air sea fluxes are turned off in the model which are believed to exert significant effects on the mixed layer dynamics and the submesoscale for example the ekman transport associated with the surface momentum flux potentially modulates front intensity thomas and lee 2005 the mixed layer restratification by submesoscales is potentially counteracted by the destabilization from the surface buoyancy flux yu et al 2019 lastly the results here are also subject to the model resolution despite that the model with 1 km is believed to resolve mli and relatively large scale frontogenesis smaller scale frontogenesis processes and symmetric instability are not included dong et al 2021a 4 2 conclusions based on simulating submesoscales generated by an idealized mesoscale eddy using different turbulence parameterization schemes this paper analyzes some measurements associated with submesoscales including the rossby number frontal density gradient and submesoscale energy budget to investigate the submesoscale dependence on three turbulence closures kpp my and gls the following conclusions are drawn 1 the mesoscale eddy generates active submesoscales confined in the surface mixed layer the rossby number horizontal gradient smke and smpe are believed to well reflect the submesoscale activity which shows that all the three cases simulate similar variation trends of the submesoscale activity however the gls tends to simulate the most active submesoscales according to the energy contents smke and smpe the submesoscale intensity from the three turbulent follows the order gls my kpp 2 three terms bc bt and bsp in the submesoscale energy budget are analyzed based on the simulation results from the different turbulence closures according to the analysis all the closures simulate the same qualitative contribution from these terms the bc is demonstrated to be the main source the smke while the bt is an energy sink transferring smke to larger scales the magnitudes of the bc and bt from these three closures are gls kpp my for the bc gls my kpp for the bt the bsp is an energy source for the smpe whose intensity is gls kpp my in this paper we focus on the submesoscale simulation from different turbulent closure schemes despite that all these schemes simulate a similar trend of submesoscales their quantitative differences of submesoscales are highlighted as stated in the introduction these three closures parameterize the turbulent mixing using different methods which should be the reason for these differences however the underlying mechanism how these closures dynamically generate the submesoscale differences is unknown here it is impossible to argue which closure is the best in terms of submesoscale simulation until observation with high spatiotemporal resolution and enough spatiotemporal coverage focusing on submesoscales is conducted meanwhile the conclusions here are applicable for larger scale submesoscale processes that are generated by mli or frontogenesis more submesoscales generated by other mechanisms such as symmetric instability are expected to be resolved as the model resolution increases and more works should be made in the future to address the closure dependence under higher resolution simulations nevertheless the results here are meaningful to remind people that due care should be taken for quantitative studies of submesoscales based on simulations despite the turbulence closures showing a dynamic consistency credit authorship contribution statement yifan wang formal analysis validation writing original draft writing review editing jihai dong conceptualization data curation methodology writing review editing funding acquisition chengzhen ji writing original draft writing review editing funding acquisition changming dong supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china 42176023 and shandong provincial key laboratory of marine ecology and environment disaster prevention and mitigation 201903 our deepest gratitude goes to the anonymous reviewers for their careful work and thoughtful suggestions that have helped improve this paper substantially appendix submesoscale energy budget equations the momentum equation for the east west velocity u is a 1 u t u u x v u y w u z f v 1 ρ 0 p x h a h h u z a v u z here u is decomposed into the time averaged component and turbulence component u u u other external forces are neglected in the equation in this work the mean quantity u represents the mesoscale circulation and the turbulence quantity u represents the submesoscale process substituting them into eq a 1 yields a 2 t u u u u x u u v v y u u w w z u u f v v 1 ρ 0 x p p h a h h u h u z a v z u u taking the reynolds average for a 2 one can get a 3 u t u u x v u y w u z u u x v u y w u z f v 1 ρ 0 p x h a h h u z a v u z then the momentum equation for submesoscale velocity is obtained by combining a 2 and a 3 a 4 u t u u x u u x u u x v u y v u y v u y w u z w u z w u z f v 1 ρ 0 p x h a h h u z a v u z u u x v u y w u z multiplying a 4 by u and taking the reynolds average the submesoscale kinetic energy equation is derived as a 5 k t u 2 u x u k x u v u y v k y u w u z w k z f u v 1 ρ 0 u p x u h a h h u u z a v u z where k u 2 2 is the submesoscale kinetic energy in the u direction in the same way the submesoscale kinetic energy in the north south direction m v 2 2 is obtained as follows a 6 m t u v v x u m x v 2 v y v m y v w v z w m z f u v 1 ρ 0 v p y v h a h h v v z a v v z a 7 l t u w w x u l x v w w y v l y w 2 w z w l z 1 ρ 0 w p z 1 ρ 0 g ρ w w h a h h w w z a v w z define s m k e k m l u u i v j w k and ignore the higher order terms related to w finally a 8 s m k e t 1 2 u u 2 v 2 a d k 1 ρ 0 u p p w 1 ρ 0 g ρ w b c u u u u u v b t d k here d k represents the kinetic energy dissipation from sub grid processes which will not be discussed in this work integrating the equation over the whole domain one can find that the adk advection of submesoscale kinetic energy and pw pressure work in eq a 8 are determined by the lateral boundary fluxes given the ocean is always quiescent near the model boundaries away from the eddy the two terms are believed to negligible and not calculated for analysis similarly the submesoscale potential energy equation is integrated and written as a 9 s m p e t u g 2 ρ 2 2 ρ 0 2 n 2 a d p g 2 ρ 0 2 n 2 ρ u ρ g ρ 0 ρ w b s p d p here the adp is the advection of the submesoscale potential energy which is also determined by the boundary fluxes and is supposed to be zero in the model d p is the dissipation of the potential energy 
23809,one of the major factors preventing utilization of realistic sea level data is that various sources are referred to inconsistent vertical reference datum vrd this study presents a methodology for deriving instantaneous and realistic sea level data from the coastal to offshore areas of the baltic sea by synergizing different sources of sea level data tide gauge tg hydrodynamic model hdm and satellite altimetry sa the key component being the geoid that links the vrd of these different sources hdms are known to be a representable source of sea level data however their vrd is often undisclosed therefore they are often spatially and temporally biased with respect to in situ data this study demonstrates that by using geoid referenced tg data that represents realistic sea level it is possible to correct hdm by deriving and applying a spatial bias correction three interpolation methods linear thin plate spline regression and inverse distance weighted are examined to derive the corrected hdm the results showed an improvement with respect to tg data and the annual mean dynamic topography of corrected hdm was improved by a factor of almost 1 5 examination of the sentinel 3a satellite along track data also confirms the corrected hdm data to be more accurate the methodology applied also identified problematic locations of hdm sa and geoid data along with unreliable tg this accuracy and conformity in sea level data are urgently required for a comprehensive understanding of climate change marine engineering and navigation applications which can be achieved by adapting the uniquely defined geoid for the vertical reference datum keywords sea level geoid hydrodynamic modelling vertical reference datum hydrogeodesy baltic sea 1 introduction a continuous model of accurate sea level from the coast to the offshore area with pre defined uncertainty bounds becomes imperative for many applications such as navigation marine engineering and climate studies with better than sub decimetre accuracy now required the challenges of obtaining such an accurate model are hindered not only by the spatial and temporal resolution of the various sea level sources e g tide gauges tg hydrodynamic model hdm shipborne and airborne global navigation satellite systems gnss profiles and satellite altimetry sa but also foremost by inconsistencies in the vertical reference datums used amongst these sources slobbe et al 2014 jahanmard et al 2021 hydrodynamic models whilst capable of successfully simulating a continuous model of relative sea level are often flawed by two major factors the first and most relevant to this study is that in many hydrodynamic models there is insufficient knowledge of the vertical reference datum used afrasteh et al 2021 slobbe et al 2014 secondly the hdms are driven by mathematical equations with input sources from other models e g atmospheric river discharge sea ice dynamics etc moreover models contain underlying assumptions and approximations in the relevant model set up e g boundary conditions parametrization and discretization techniques etc kärnä et al 2021 khanarmuei et al 2021 hieronymus et al 2017 zhang et al 2016 these factors often result in many hdms being systematically biased both spatially and temporally relative to observations previous studies have examined the bias correction of hdm with respect to salinity and temperature chang et al 2021 as well as climate models aung et al 2016 giorgi 2019 however the spatial and temporal bias correction related to the sea level parameter has often been overlooked although the hdm derived sea level does not correspond to the in situ observations its simulations still represent an acceptable trend of sea level a simple and reasonable approach that has been utilized by many studies is by calculating the correlation and standard deviation between hdm sea level and land bounded tgs i e assuming the tgs refer to some defined datum to demonstrate model assessment hordoir et al 2019 kärnä et al 2021 some applications also derived a bias correction by computing the difference of hdm with the tg records that refer to a desired vertical reference varbla et al 2020a mostafavi et al 2021 the problem becomes complex for numerous applications e g determining realistic absolute sea level rise climate studies engineering design etc now require accurate sea level not only in the coastal domain i e within the vicinity of tg but also in the offshore domain considering that the hdm sea level bias varies both spatially and temporally with high and low frequency components jahanmard et al 2021 this makes it challenging to obtain accurate and consistent sea level data from the coast to offshore in jahanmard et al 2021 biases of the model with respect to a dense network of geoid referenced tgs were hourly extended to the offshore using a linear interpolation method nevertheless the performance of the bias correction in the offshore area remained unclear this signals the need for a solution that also corrects the hdm data in the offshore zone so that a consistent and realistic vertical datum is utilized motivated by these challenges the focus of this study is to demonstrate a novel method that corrects the hdm bias both in the coastal and offshore area using a consistent and realistic vertical datum and to demonstrate the applicability of this towards improving other related studies hydrodynamic models are however not the only source of sea level data and as mentioned above there are other sea level sources such as tide gauges with defined vertical datum tide gauges are known historically for being one of the most reliable and accurate sources of sea level data due to the long time span of data collection along the earth s coastline as a result tg data are often considered as representative of the true sea level jahanmard et al 2021 cipollini et al 2017 nevertheless there are three important limitations in using this source i as mentioned above the spatial coverage of tg tends to be constricted to the coastal boundary and thus not ideally representable for the offshore areas ii as tgs usually measure relative sea level i e relative to the land where the tg stations are stationary positioned they are influenced by the vertical land movement that may occur e g glacial isostatic adjustment this signifies that in areas affected by any land deformation there is a need for relevant corrections to be applied in order to derive the true sea level variation moreover iii the vertical reference datum of marine areas is commonly referred to a chart datum which is based on either a tidal observation e g some historic mean sea level msl lowest astronomic tide lat etc theoretical mean sea level models e g as it was used in finland recently or a physical model such as the geoid schwabe et al 2020 whilst sufficient to a certain degree based on the application most of these chart datums may vary over different time periods also depending on the country community the sea level data may be referred to differently defined vertical datums for instance the baltic sea countries utilize several different vertical reference datum definitions table a 1 and in such a dynamic marine area where integration is essential this can create inconsistency and incompatibility as a result this study proposes utilizing a common and static vertical reference such as the geoid as a more reasonable approach the geoid is a shape of the equipotential ocean surface under the influence of the gravity and rotation of earth alone therefore it would be more or less a static vertical datum unlike msl which wavers over time and represents the natural zero note that the geoid can vary due to mass redistribution however this variation is usually negligible the maximum value for the geoid rise in the baltic sea is around 0 6 mm year due to postglacial rebound kakkuri and poutanen 1997 thanks to precise gnss levelling it is possible to transfer a network of tg stations to a common geoid based vertical datum thus it is more applicable to validate the different data and model sources against the geoid referenced tg data rather than using various and msl based chart datums liebsch et al 2002 varbla et al 2020a b this validation should identify any bias between sources with respect to the vertical datum in addition to other systematic and random errors thus it seems pragmatic to use the reliable tg records that are referred to some stable and realistic vertical datum to fit the hdm associated sea level data to a common vertical datum nordman et al 2018 jahanmard et al 2021 the geoid referenced sea level data now allows us to derive automatically dynamic topography dt which is physically meaningful and better quantification of a more realistic sea level jahanmard et al 2021 as a result the mean dynamic topography mdt can be calculated which is the difference between the mean sea surface and the geoid fig 1 note that there are basically two approaches to calculate the mdt first and foremost by a geodetic approach whereby knowledge of the mean sea surface mss is derived from sa or tg records referred to a precise geoid model idžanović et al 2017 the oceanographic approach second utilizes solely hdm derived sea level data ophaug et al 2015 in this study we shall utilize a combined approach that employs both geodetic and oceanography methods since we are interested in the dt not only in the coastal area but also continuing into the offshore this is to our knowledge the first attempt of such a synergized exploration in the entire baltic sea and it is expected that similar forthcoming developments can be adapted in other marine areas worldwide based on the challenges problems outlined above we examine the baltic sea region to demonstrate an innovative and improved method that incorporates various sea level sources along with a high resolution geoid to obtain a more realistic and accurate dt this study area is ideal for such a demonstration due to the presence of a dense network of tgs with a common geoid based vertical reference datum baltic sea is a semi enclosed sea which is also fortunate to have an accurate geoid model a realistic postglacial land uplift model sa data that have been specially corrected for the area specific marine conditions a three dimensional hdm and an agreement between nine coastal countries towards having a common marine chart datum i e the baltic sea chart datum ågren et al 2016 ellmann et al 2019 vestøl et al 2019 schwabe et al 2020 therefore a synergy of hdms and tg records along with other data sources such as satellite altimetry and marine geoid model is expected to yield high resolution realistic dt both temporally and spatially in addition we shall demonstrate that the method applied can also reveal the accuracy or deficiencies of the different data sources utilized thus the core component of this study is the development of a methodology that reduces the fluctuating zero level of hdm to a geoid based vertical reference for this purpose the bias of the hdm is corrected by utilizing a tg network comprising 73 stations such an approach was first utilized in jahanmard et al 2021 using a simple linear approach to distribute the bias spatially this approach however may be flawed because of a lack of validation in the offshore area and an insufficient assessment of the bias interpolation sensitivity this study reduces these flaws by now including a wider sea area and denser tg network that allows the examination of three different interpolation approaches i triangulation based linear interpolation ii thin plate spline regression and iii inverse distance weighted the best derived results are then evaluated and validated by utilizing the sa data sentinel 3a with respect to the nkg2015 geoid model this validation becomes most relevant in the offshore areas where the largest uncertainty is present one of the most pertinent advantages of using an identical and stable vertical datum amongst the various data sources is that accurate dt can now be determined the method applied also significantly contributes to identifying i aspects of hdm modelling that require improvement ii sa problematic issues and iii aspects locations of the geoid modelling that require improvements the organization of the present paper is as follows first the developed and general methodology is outlined next the data sources are highlighted i geoid referenced tide gauge network ii nemo nordic hdm model iii nkg2015 geoid model and iv sentinel 3a satellite altimetry data the hdm bias correction method is described in both time and spatial domains then the difference between corrected models and sa data as well as the results are presented finally a discussion on the results and method is described followed by a summary that concludes the paper 2 general methodology in this study different techniques and approaches are employed to derive the sea level from the coast and offshore as mentioned above one of the major challenges in obtaining accurate dt is that various data sources refer to various vertical reference datums apart from making it difficult to compare datasets this inconsistency also leads to errors particularly when inter country community issues arise thus this section now describes an overall view of the method used to refer the vertical datum of the various sources to that of a static and common vertical datum such as the geoid i e the equipotential surface of the earth three principal sources of data that shall be utilized are tg sa and hdm data fig 1 illustrates the inter relations between these data sources and the hydrodynamic parameters of interest in both the spatial and time domain recall that the tg data can be referenced to different chart datums e g msl lat etc in the study area the baltic sea chart datum 2000 bscd2000 is adopted as a geodetic reference system to unify chart datum between the surrounding countries the chart datum is based on the common geodetic standards for height system european vertical reference system evrs and spatial reference system european terrestrial reference system etrs89 in europe the zero level of bscd2000 is in agreement with the normaal amsterdams peil nap and the chart datum coincides with the geoid surface schwabe et al 2020 as previously discussed the sea level variations with respect to the geoid surface yield dynamic topography dt which is more physically meaningful than sea level relative to other vertical datums e g msl lat which may vary depending on definitions tide gauge records however reflect the nearshore dt from a relative perspective i e sea level variations relative to land on the other hand satellite altimetry sa measures the absolute sea level that is without regard to vertical land motion in both coastal and offshore areas the satellite derived sea surface height s s h s a is relative to a geodetic reference ellipsoid e g grs 80 which can be converted to d t s a as follows 1 d t s a φ λ s s h s a φ λ n φ λ where n is the static geoid height a separation from the reference ellipsoid in this study nkg2015 as the most recent official geoid model over the baltic countries is employed ågren et al 2016 hydrodynamic models typically lack a well defined vertical reference as such it is not straightforward to express the model derived sea levels in a 3d coordinate system since the model dynamics assume zero horizontal gravity components we denote the original raw hdm derived sea level as d t h d m despite knowing that the raw hdm is not exactly expressed relative to a geoid because the bathymetry used and prescribed sea levels along the open boundaries have not been referred to the geoid slobbe et al 2013 therefore since the vertical reference of the hdm is still unknown the study focuses on determining accurate hdm derived dt particularly in the offshore area in this regard the primary objective of this study is the development of a method to correct the d t h d m utilizing a stable height system reference surface a geoid in doing so a geoid referenced tg network is employed to determine and correct the bias of d t h d m with respect to d t t g at the location of tgs the hdm biases are distributed to the offshore using an interpolation technique and then the corrected hdm is examined through the d t s a as mentioned above due to dissimilarity in the vertical reference datums used by the d t h d m and d t t g it is expected that a difference exists this difference however changes both temporally and spatially and it is quantified in this study as a bias due to the characteristics of this bias it was necessary to first derive a time domain bias tdbias followed by a spatial domain bias sdbias note that firstly the tdbias is determined by identifying the closest hdm grid point to that of the tg location the difference is then calculated between the time mean value of hdm at the tg location d t h d m t g and d t t g within a certain time interval the backward moving average method is commonly used to correct the temporal bias of models jahanmard et al 2021 lagemaa et al 2011 2 tdbias m k i 1 k 1 j k 0 d t h d m t g m i j d t t g m i j i k where m denotes a specific tg station and k is the window length of the moving average in this formulation i is the index of time vector ordinal number that according to the temporal resolution of hdm and tg records is increasing hourly obviously the small amount of k yields the high frequency error between the model and tg and the k 0 represents the instantaneous bias which is applicable for extreme cases in this study we require an uncertainty of less than 5 cm in order to obtain accurate sea level data thus from previous studies a window length of less than 6 h is recommended jahanmard et al 2021 to obtain the uncertainty of tdbias in each tg station the root mean square of errors is obtained from residuals ɛ which is the difference between the corrected model and raw model at the location of tg due to including the moving average filter in eq 2 as follows 3 r m s e m k h d m t g j k 1 n ɛ m j ɛ m 2 n k where n is the number of observations at the m th station and k as before is the window length of the backward moving average which should be removed from the beginning of records for determining rmse the tdbias is valid only near the coast in the vicinity of the tg location to achieve the bias through the offshore area i e sdbias an interpolation between the dense network of tg stations is employed 4 sdbias x φ λ t interp x φ t g λ t g tdbias t φ λ where interp x is the interpolation operator whereas x indicates the type of implemented interpolation technique the φ t g and λ t g are the vector of latitude and longitude of the employed tg stations respectively the sdbias is computed on the grid nodes of the model with vectors of latitude φ and longitude λ therefore the corrected hdm is calculated accordingly 5 d t h d m c φ λ t d t h d m φ λ t sdbias φ λ t the d t h d m c represents coastal and offshore values with respect to the geoid model the various interpolation techniques such as linear inverse distance weighted and thin plate spline will be performed to determine the sdbias see section 4 2 and the corrected model will be assessed using d t s a note that the d t s a values are often accompanied by outliers and another bias related to the tg records is also calculated see section 3 4 the schematic roadmap of the implemented methodology to correct the model and compare the various correction methods is shown in fig 2 3 data sets 3 1 tide gauge dynamic topography in this study the tg data serves as the foundation of accurate sea level data particularly with respect to deriving the time domain bias i e tdbias eq 3 the tg data were compiled from various sources around the baltic sea countries see table a 1 after performing quality and reliability checks a robust network of 73 stations from nine countries along the coastline of the baltic sea was chosen this tg dataset consists of hourly in situ sea level data for the period december 2016 april 2020 see fig 3 and table a 1 since different baltic countries use different vertical datums it is essential to transfer all tg records to an identical common vertical datum i e the baltic sea chart datum the estonian danish and swedish tgs are available with respect to their own national reference frames that are eh2000 dvr90 and rh2000 respectively the remaining countries tg records are referred to the tgz except finnish tgs that are referred to the theoretical mean sea level that have been transferred by adding the individual conversion values the value and reference of these conversion values and national reference frame that comply with bscd2000 are listed in table a 1 by these conversions all stations are set down on a common european vertical reference system with an identical zero level of nap the permanent tide system of tg readings is the zero tide system except for germany russia and denmark which are in the mean tide and tide free system cf table a 1 since the russian national height system bhs77 baltic height system 1977 has not changed to the european vertical reference system the zero level is shifted by adding 19 cm to this tg station sacher 2019 this offset value is an approximate difference between the kronstadt i e former zero level and nap to harmonize the permanent tide system of the tg records specified in table a 1 with the hdm and sa data tg data are transferred to the mean tide system by conversion algorithms provided by ekman 1989 tide gauge readings originally are relative to the tg zero mark and then the records are reduced to the national height datums by near benchmark e g bscd2000 conversions in the baltic sea tgs benchmark refers to nap evrf2000 zero permanent tide system in order to transform the records to the mean permanent tide system the separation between the benchmarks and nap height δ h need to be transferred from the zero tide to the mean tide system thus ekman 1989 6 δ h m δ h z 29 6 sin 2 φ b sin 2 φ n a p δ h z c z 2 m cm also for non tide national datums e g denmark γ 0 7 7 δ h m δ h n 29 6 γ sin 2 φ b sin 2 φ n a p δ h n c n 2 m cm where φ b is the geodetic latitude of tgs benchmark and φ n a p is the latitude of nap 52 22 53 in the european terrestrial reference system 1989 therefore the conversion to the mean permanent tide system c z 2 m will be added to the bscd2000 correction and finally tg records are corrected as follows and the same for c n 2 m 8 d t t g m e a n t i d e d t t g z e r 0 t i d e c z 2 m in addition tgs measure relative sea level and since in the study the absolute sea level is required the vertical land motion vlm must be taken into account especially in the baltic sea where the stations are strongly affected by vlm due to the glacial isostatic adjustment accordingly the land uplift increases from near zero in the southern part of the baltic sea to about 10 mm year in the northern part vestøl et al 2019 fig 4 shows the difference between long term trends of relative and absolute sea level in an example station spikarna station tg id 52 in the north of the bothnia sea in this station the relative with respect to the land mounted tgz sea level trend is strongly negative 6 7 mm year while the absolute with respect to the centre of the earth sea level trend is positive 2 2 mm year in this area madsen et al 2019 it should be noted that whilst the tg measurements are one of the most reliable sources of sea level data they may contain gross errors or temporal gaps since these data deficiencies can disturb or decrease the quality of each analysis especially for obtaining hourly tdbias see eq 2 it was necessary to identify and fill the gaps in the time series the missing tg data have been simulated by k nearest stations using a linear least square regression method which results in the estimated dt with an uncertainty of 3 5 cm on average also tg data screening was performed by removing spikes with residuals larger than three standard deviations 3 2 hydrodynamic model nemo nordic is a three dimensional coupled ocean sea ice model of the baltic and north sea hordoir et al 2019 that was developed by the swedish meteorological and hydrological institute smhi and originally based on the nemo 3 6 ocean engine nucleus for european modelling of the ocean in this study we utilize a data assimilated version of the nemo nordic model with an hourly temporal resolution and a horizontal resolution of 1 nautical mile for the period 3 december 2016 15 april 2020 the data were obtained from smhi smhi 2021 and are expected to provide sea level predictions at a higher level of quality than previous models used in the study area due to model setup settings and data assimilation techniques employed hordoir et al 2019 kärnä et al 2021 a major feature of nemo nordic compared to other hdm models used in the baltic sea is that two open boundaries are utilized a meridional one in the western part of the english channel and a zonal one located between scotland and norway the sea level temperature and salinity boundary conditions are obtained from ecmwf the european centre for medium range weather forecasts data in the operational mode hordoir et al 2019 the model also uses a nonlinear explicit free surface method with a time splitting approach that computes a barotropic and a baroclinic mode as well as the interaction between them nemo nordic uses a buoyancy extended k ɛ turbulence model and nemo 3 6 is two way coupled with the ice model lim3 6 the atmospheric forcing is sourced from hirlam c11 high resolution limited area model in operational mode present model the river discharge data are derived as daily means from hydrological predictions for the environment e hype bathymetry data utilized in the model was sourced from the general bathymetric chart of the oceans gebco 2014 hordoir et al 2019 in hordoir et al 2019 a statistical comparison between measured and modelled sea level at different tide gauges in the baltic and north seas was performed this however was restricted to only a few stations located in the baltic sea for an 18 month period from july 2011 to 31 december 2012 their results showed a high correlation between model and observations and a negative bias in terms of the representation of the low frequencies in the north sea for the rest of the baltic sea however no major bias was identified this study now considers a greater number of stations and from fig 5 which displays the sea level of the hdm at a specific time instant it is quite noticeable that a difference exists in hdm denoted by red colour map at the location of tgs therefore the objective of this study is to evaluate and correct the nemo nordic sea level by using a geoid referenced tide gauge network that now consists of 73 tide gauge stations note however that the nemo nordic vertical datum is not explicitly specified as a result we shall show in this study why the utilization of the geoid is a better approach 3 3 geoid model the nkg2015 the most recent high resolution 0 01 0 02 degrees geoid model over the baltic countries was developed by the nordic geodetic commission in a long term project that began in 2011 ågren et al 2016 this model is based on the least squares modification of stokes formula with additive corrections lsmsa in the framework of a remove restore procedure the standard deviation of this model in the 1 parameter fit to gnss levelling is 2 85 cm 1 5 2 0 cm on land the coverage of the nkg2015 is from the latitude of 23n to 73n and the longitude of 0e to 34e the geoid model refers to the grs80 ellipsoid etrf2000 frame epoch 2000 0 note that the official nkg2015 model that is released online contains a hybrid permanent tide system i e a non tide conversion has been added to the model to be able to use it directly for gnss measurement therefore in this study we used the original one nkg2015 zt which is a pure zero tidal model in order to be able to use the nkg2015 for determining dt with sa data the geoid model is transferred to mean tide system as follows varbla et al 2022 9 n n k g 2015 z t 0 29541 sin 2 φ sin 2 φ n a p 0 00042 sin 4 φ sin 4 φ n a p where φ n a p is the latitude of nap and this equation is expressed in units of the metre 3 4 satellite altimetry data satellite altimetry sa is a well known space technique used for measuring sea level data both in the offshore and coastal areas one of the major advantages of sa that shall be employed in this study is that it tends to be a major source of data capture in the offshore areas compared to the tg data that are limited to coastal areas in this study we employed the sentinel 3a s3a high frequency 20 hz along track sea level measurements that operates in sar mode and is based on ales sar an adapted retracking algorithm from baltic seal datasets passaro et al 2021 the data are captured at an across track resolution of 1 64 km and an along track resolution of 300 m desjonquères et al 2010 this dataset has been specially corrected for the coastal and sea ice conditions of the baltic sea and was obtained from http balticseal eu data access the time period from january 2017 to june 2019 33 cycles with a repeat period of 27 days which covers 39 passes over the baltic sea see fig 3 is examined 3 4 1 satellite altimetry corrections from the precise knowledge of the satellite orbit height h orbit and the sa range r determination using retracking waveforms several other corrections atmospheric and geophysical are applied to derive the sea surface height ssh eq 10 displays the algorithm that was implemented by default to the baltic seal products passaro et al 2021 10 s s h b s h orbit r w t c d t c i o n o s s b d a c s e t p t r o c where s s h b s is obtained by default from the s3a data baltic seal project which referred to topex poseidon reference ellipsoid the wet tropospheric wtc dry tropospheric dtc and ionospheric iono are atmospheric propagation corrections due to radar pulse passing through earth s atmosphere sea state bias ssb dynamic atmospheric correction dac solid earth tide set along with pole tide pt are classified in the geophysical corrections which refer to the systematic geophysical effects that can be modelled and corrected the radial orbit error roc is a new correction that was derived and is based on multi mission cross calibration to ensure a consistent combination of all different altimetry missions bosch et al 2014 since we will compare the sa data reduced for dac with hdm data that does not the default dac correction must be cancelled by adding it back to the s s h b s similar approach was also performed in other studies madsen et al 2019 rautiainen et al 2020 passaro et al 2021 note that the ocean tide corrections ot are not included in the s s h b s eq 10 since the tides in the baltic sea are generally small less than 10 cm samuelsson and stigebrandt 1996 all other geophysical corrections i e set and pt remain to obtain identical measurements with tg records and hdm the dt sa is formed by referencing the ssh bs to a geoid model i e nkg2015 the sa data are referred to the topex poseidon reference ellipsoid itrf2008 mean permanent tide system hence in the case that the geoid height n eq 9 is to be used together with sa data the ssh bs and n must be referred to the same reference ellipsoid and coordinate system for this purpose the sa data were transformed to the grs80 and etrf2000 through three steps i conversion of the sa data to geocentric coordinates x y z ii transformation of the data from itrf2008 to etrf2000 altamimi 2018 and iii converting back the data to the geodetic coordinate according to the grs80 reference ellipsoid finally the dt sa is computed accordingly 11 d t s a φ λ t s s h b s φ λ t d a c φ λ t h offset φ λ t n φ λ where h offset is the conversion values from topex poseidon reference ellipsoid itrf2008 to the grs80 etrf2000 3 4 2 satellite altimetry outlier removal outliers may be present in the sa data due to land contamination presence of industrial infrastructure wind turbines platforms etc turbulent waters etc especially near the coast as a result a three step data screening procedure was applied for the outlier removal i obvious outliers that are outside of the 3 m range were removed according to time history of other sources d t s a larger than 3 m is physically impossible and distorts the sa statistical parameters this is followed by ii a moving median with a window length of 1 nm was applied along the tracks and the sa data more than four local scaled mad median absolute deviation away from the local median within the sliding windows have been deleted as the coarse random errors shown in red marker in fig 6a and finally iii the d t s a of each track was filtered by 3 standard deviation i e outside of the 99 7 confidence interval from the least square ls spline approximation shown in red marker in fig 6b to determine the ls spline curves for each track a piecewise quadratic polynomial with q knots was applied accordingly 12 d t s a j x a 0 j a 1 j φ a 2 j φ 2 j 1 2 q where j denotes the index of knots and q is the number of polynomial pieces neitzel et al 2019 this approximation allows the d t s a to approach the coast fairly as much as the sa data is available note that the value of q varies for each pass and cycle depending on the ground track length and instantaneous sea surface shape therefore the number of polynomial pieces q was calculated using an optimization method to minimize residual standard deviation residsd for each pass cycle for this purpose the residsd is determined accordingly 13 residsd i 1 n ɛ i ɛ 2 n 1 where ɛ and ɛ are the residual between the sa data and ls spline curve and mean of residuals respectively the residsd is obtained over the n data points along track blue dots in fig 6b fig 7 shows all residsds according to eq 13 based on compilation of all the passes fig 7a and all the cycles fig 7b according to fig 7a the large residsd amounts belong to short ground tracks that are within the vicinity of land i e pass no 44 1 158 2 425 1 500 1 625 2 and 756 it also can be observed that bothnia bay i e pass no 197 2 311 2 386 1 425 2 and 739 2 has a large dispersion in the residsd which can be due to sea ice conditions in the winter months the median of residsd for all passes and cycles is 3 6 cm this examination of the sa data proves that the sa data are reasonably consistent and can be used for validation of d t h d m c it also hints and identifies possible problematic time wise cycles for instance periodic pattern is evident with an increase in the late winter and early spring cycles 14 28 29 41 which indicates a greater dispersion of sa observations in theses seasons see fig 7b 3 4 3 cycle mean dynamic topography to give a better assessment of the model s performance in the offshore the cycle mean of dt cyclemdt was obtained along the sa tracks since the cycle period of s3a is 27 days the cyclemdt can make a contrast with hourly mdt of the hdm and tgs moreover it is possible to reduce the contribution of low quality cycles i e cycles with high residsd according to fig 7 by using weighted mean 14 cyclemdt φ λ cycle i 1 c d t φ λ i w i p a s s i 1 c w i p a s s with 15 w i p a s s 1 residsd p a s s i where c is the number of sa cycles i e c 33 for the period january 2017 june 2019 and residsd is the residual standard deviation according to fig 7 the cyclemdt was also determined for the hdm and tg data similar to sa that is at the time of sa cycles using a linear interpolation and similar weight eq 15 used for sa the hdm data were extracted at the coordinates of the sa data points via bilinear interpolation 4 method for examining time and spatial domain biases 4 1 time domain bias approach as mentioned above a difference in various sources of sea level is expected at similar locations due to i the dissimilarity in the vertical reference datum utilized and ii the limitations of the methods employed in capturing sea level given that we have taken the perspective of the tg data represents the truth within the coastal area then to obtain the difference between dt of the hdm and tg records the closest grid point of hdm to the tg locations less than 4 km in most stations are selected and extracted to produce the d t h d m t g time series for all 73 used stations thus this difference referred to as tdbias is determined according to eq 2 by using a 6 h moving average filter that gives an uncertainty of less than 6 cm with respect to the tg records cf fig 8b for instance tdbias time series for three tg stations are shown in fig 8a as can be observed the bias is not constant in time and it varies from around 20 to 30 cm it is also apparent that the tdbias behaves periodic and the seasonality of bias is obvious with crest and trough in the spring and autumn seasons respectively the peaks in spring may be due to problems with river runoff or atmospheric forcings which may serve as significant indicators of possible improvements for modellers the statistic parameter of tdbias for all stations during the period december 2016 april 2020 along with the correlation of raw nemo nordic data with tg records in the course of time are illustrated in fig 9 it is evident that the mean of tdbias at tg stations varies spatially between 5 and 16 cm with the highest values mostly occurring in the western side of the gulf of bothnia fig 9a and also at some distinct locations along the coast of the baltic sea e g tg ids 16 28 29 and 45 or due to their locations e g mouth of river etc that causes them to be in disharmony with adjacent stations observe however that in these areas of higher bias the hdm and tg data are highly correlated fig 9c this hints that the hdm simulates similar dynamics as tg thus the issues with the vertical datum or possibly even tg corrections are the major component contributing to the higher bias also observe in fig 9 that the model has larger standard deviation 10 cm with respect to individual tgs in the gulf of riga tg id 14 and in the eastern part of gulf of finland tg id 73 see fig 9b since the surrounding tg are lower in standard deviation this could indicate also possible issues with the tg data e g insufficient corrections applied 4 2 spatial domain bias approach since the d t t g are only valid near the coast in the vicinity of the stations computing the bias of all hdm grid points directly by eq 2 is not an ideal approach instead given a set of tdbias for a given time instant a spatial interpolation can be employed to distribute hdm bias over the study area this aims to fit a surface i e sdbias that will best represent the spatial hdm bias to obtain sdbias the interpolation method and distance between the tg stations play key roles the spatial interpolation is calculated based on the bias calculated between hdm and tg data at the location of stations however a valid d t h d m c in the open sea is indeed strongly dependent on the hdm s performance in terms of high correlation between model and observations i e truth in this study the nemo nordic model was corrected using three interpolation methods i linear lin ii thin plate spline regression tps and iii inverse distance weighted idw however other methods e g kriging and least squares collocation are also commonly used in similar studies here three selected interpolations with different interpolating approaches were used to demonstrate the sensitivity of the hdm correction method to the sdbias and we will show that the methods provide less than a few centimetres variations in sdbias to exclude possible instantaneous errors such as spikes in the tg records a 6 h filtering window was applied as mentioned in section 4 1 as a result the tdbias k 6 h r yields a rmse of 2 7 cm on average see fig 8 which are suitable for interpolation process the exception is for thin plate spline regression method where the instantaneous tdbias was used the linear interpolation lin can serve as a first approximation of the offshore bias assuming the bias changes linearly over space jahanmard et al 2021 the second approach tps is a spline based technique that arises from consideration of the integral of the square of the second derivative regarding this method it is expected that the possible tg reading defect between stations relative to nearby stations is moderately relaxed the tps regression yielded an rmse of 2 5 cm on average over time and at the location of the tgs after comparing corrected hdm and tg records the third used interpolation method is inverse distance weighted idw whereby data points stations closer to the grid points have more effect than those which are further away in this regard the weighted mean is employed accordingly 16 sdbias i d w φ λ i 1 m w i φ λ tdbias i i 1 m w i φ λ φ λ φ i λ i with 17 w i 1 d φ λ φ i λ i 2 the subscript i denotes the tg stations m is the number of stations i e m 73 and d is a distance measurement operator which is used to measure distances on a sphere as an example fig 10a shows the computed sdbias using the above methods for a particular time instant 31 january 2018 21 00 utc see fig 5 for d t h d m in this figure a spatial variation of model bias has been illustrated all three methods show a more or less similar trend and range 11 26 cm and as expected the trace of triangles edges are visible in the lin interpolation method generally speaking in all three interpolation methods the largest bias is associated to the western section of the baltic sea and also at some localized areas due to certain tg quality issues to evaluate the similarity and difference of those methods in the course of time fig 10b represents standard deviation of range of three methods during december 2016 april 2020 observe that in most areas the variation of the difference between methods is less than 2 cm the largest difference occurs in the gulf of riga tg id 14 where the range of three methods has the highest standard deviation of 4 2 cm in the course of time see fig 10b this also coincides with fig 9b that showed the same tg station also having a higher standard deviation and lower correlation than others surrounding it by correcting all grid data for the bias the corrected hdm d t h d m c is obtained eq 5 in the following the methods were compared with sa data and as a result although corrected hdms show more or less similar results and rmse with respect to the d t s a we selected the idw method as a preferred method to be used for correcting the model following this the idw method for hdm correction is shown in all the calculations however we will also show in section 5 2 that the differences between methods with respect to sa data are barely noticeable in the offshore area the d t h d m c and raw hdm for the time instant see fig 10a for sdbias are presented in fig 11 after correction the pattern of dynamic topography has not changed noticeably but the range of d t h d m c has been shifted and narrowed to 5 78 cm while the range of raw hdm was 20 100 cm at this time instant to verify if the corrected hdm data are reliable and accurate enough validation in the offshore areas was necessary and this was performed in this study by utilizing sa along track data to illustrate the model changes in the time period of interest the time mean and temporal standard deviation of sdbias are shown in fig 12 the mean of sdbias for 41 months demonstrates that the hdm bias is roughly 10 cm with a higher value in the western baltic sea this bias varies by more than 7 cm in the course of time fig 12 right which implies that long term bias corrections e g the mean of a year are incapable to improve the model accuracy with respect to the tg data fig 8a illustrates the same point the spatial standard deviation of the mean sdbias fig 12a is roughly 1 3 cm this unnoticeable amount of the spatial bias variation could indicate that the hdm uses more or less an equipotential surface of the earth s gravity field as its reference and using the term d t h d m is an acceptable assumption it is also noticeable in this figure that some stations may have zero level problems or the hdm may not be able to simulate regional effects such as river runoff 5 results 5 1 mean dynamic topography by utilizing a network of geoid referenced tg data along the baltic sea coastline it was possible to derive a corrected hydrodynamic model dynamic topography d t h d m c this variable now represents sea level variations with respect to a more realistic zero level being that of the geoid as a result of this it is possible to obtain a realistic mean dynamic topography mdt over different time scales seasonal annual etc that can reveal the persistent or semi persistent dynamical patterns note that the hdm s high temporal and spatial resolution is its advantage for this purpose compared to other datasets the mdt is determined for different time period fig 13 illustrates the annual mdt for the raw and corrected hdm along with the mdt of used tgs that are shown in circles with the same colour bar at the location of stations particular characteristics are observed for instance i the raw hdm over estimates the tg records thus the actual values are lower ii in general similar patterns of mdt is observed however there exist at particular areas a difference in patterns and trends and iii localized areas shows slight inconsistency in a few stations e g tg id 16 as also mentioned in section 4 1 and fig 9 where the tdbias of each station is compared to the adjacent stations that had a higher standard deviation but lower correlation in general the corrected mdt like raw hdm exhibits a spatial pattern with the largest mdt in the north of the gulf of bothnia and eastern section of the gulf of finland this is the expected trend in the baltic sea madsen et al 2019 which are due to freshwater accumulation and wind forces soomere and quak 2013 the annual mdt however shows much more variation in the corrected mdt than the original model for instance in 2019 the range of mdt is reduced almost from 37 0 55 0 18 0 to 29 0 46 0 17 0 cm and the difference between the north north of bothnia bay and south north of poland of the baltic sea has been reduced roughly 25 percent this difference is especially noticeable in the gulf of bothnia in all three years recall that in the gulf of bothnia the highest bias was applied whether this application of a higher bias is suitable requires further examination for it is possible that i in gulf of bothnia especially in its northernmost part bay of bothnia many of the tg are not exactly located at the coast but may be located more inland in riverways so even though they may reflect the trend of sea level their actual value may not reflect that of the coastal sea area as was captured by the models and ii issues with tg corrections that are unknown at the time of this study e g offsets vertical land movement corrections etc to verify however if the corrected hdm data are reliable and accurate enough especially in the offshore areas and in the areas of higher variation in trends a validation with sa data is performed section 5 2 5 2 validation in the offshore areas the sa data provide an independent source of validation of the corrected hdm especially in the offshore thus we validated the raw corrected hdms in order to show and compare the performance of the developed methods in the offshore however several studies have shown that sa data may still be biased even after corrections are applied e g mostafavi et al 2021 and an accuracy of 2 5 cm is achievable with the sa sentinel 3a data we utilize the sa along track sea level profiles that are compared with similar profiles extracted from the hdm the corrected model was evaluated using sa data via two approaches in the offshore areas i calculation comparison of the along track sa bias with respect to the raw corrected hdm data fig 14 and ii comparison of the cyclemdt of various datasets as defined in section 3 4 see eq 14 in both approaches we are going to show the variation of inconsistency between hdm and sa data for the first approach the sa bias with respect to each hdm data is determined accordingly 18 b i a s s a i 1 n d t s a i d t h d m i c n where n is the number of sa data along the track and d t h d m i c is the corrected model for obtaining the d t h d m along each pass in the desired cycle the hdm data have coincided temporally and spatially with the sa data points with linear interpolation fig 14 shows the bias of s3a with respect to the raw hdm in black and corrected hdm in green blue and red for lin tps and idw method respectively versus the sa passes fig 14a and cycles fig 14b the comparison using all passes and cycles shows that i with all three interpolation method the differences are almost negligible that is the model correction is insensitive to the interpolation method ii the sa data agrees better with the corrected hdm median of sa bias is roughly 1 5 cm compared to the uncorrected median of sa bias 13 2 cm iii the scatter plot of the bias fig 14c which shows the median of the bias for the corrected hdm identifies some passes with large biases such as the eastern part of the gulf of finland with a bias of over 5 cm these passes are however similar to the areas of higher standard deviation of sdbias fig 12 right moreover iv a seasonal trend is evident in the bias of the raw hdm relative to sa as also observed in fig 8a relative to tg records whereas it disappears for the corrected hdm fig 14b the regions with a large bias require further examination and this was performed using the cyclemdt approach thus for the second approach of validation a comparison with cyclemdt see eq 14 of all available data sources the term cyclemdt is selected to make a contrast with mdt cyclemdt is the average of n cycles of instantaneous sa observations which is expected to be very close approximation to mdt fig 15 demonstrates cyclemdt along the three sa passes pass no 272 55 and 414 according to this figure a comparison of raw corrected hdm tg records and sa data reveals that i before examining the corrected hdm the tg records and sa profiles have mostly coincided whereas the raw hdm does not ii compared to raw hdm corrected hdm is more consistent in magnitude as well as spatial trend with sa profiles and tg records and iii the corrected hdm for pass no 414 located in the eastern section of the gulf of finland displays a more stable dt compared to sa results in this area indicate that utilizing sa data along with the geoid model i e nkg2015 leads to an unrealistic dt value that fluctuates widely this strongly suggests problems with the geoid model due to insufficient coverage of marine gravity data and validation in such locations ågren et al 2016 5 3 identifying areas of large discrepancy a comparison of point to point sa data and hdm for the entire baltic sea allows a broader overview for identifying problematic areas especially in the offshore areas fig 16 this figure shows a point to point difference between cyclemdt of the sa data and raw fig 16a or corrected nemo nordic model fig 16b this reveals possible inconsistencies between various data sources and also highlights regions with problems especially offshore in this study different datasets are used tg hdm sa geoid model and land uplift model each of which has its own uncertainty in different conditions and regions for instance the sa data may contain artificial bias even after applying geophysical and atmospheric corrections fig 16a top clearly demonstrates the differences between hdm and sa data with an average of 11 1 cm with the highest bias occurring in the northern and eastern sections of the baltic sea approx 30 0 cm the sa data confirm the corrected hdm with a bias of 0 1 cm however a large difference greater than 7 0 cm between the corrected model and sa data is noticeable in the gulf of finland as observed in fig 15 and pass no 414 the reasons for this bias requires further evaluation for future studies the centred root mean square error crmse of the hdm before and after correction are 2 2 and 2 4 cm respectively basically the spatial comparison of differences between hdm and sa results shows the method decreases the hdm bias by roughly 11 0 cm in the offshore area fig 16 also highlights problematic areas amongst the different sources of data for instance there is a high discrepancy between sa and hdm in both the raw and corrected models shown in black in the eastern part of the gulf of finland possibly because of the geoid model deficiencies nearshore contaminated sa data are mostly observed in the north and centre of the baltic sea 6 discussion the methodology employed in this study demonstrated that by utilizing a dense network of tg data that are referred to the geoid it is possible to correct the hdm bias both temporally and spatially applying this bias correction allowed computation of a corrected hdm whose sea level data are now referred to the geoid and thus more or less realistic both at the coast and in the offshore domain to evaluate whether the corrected hdm mdt results were reliable and accurate enough the validation using sa data played an essential role in assessing this especially in the offshore domain the method employed entailed initially identifying the temporal bias and then using this temporal bias along with three interpolation techniques to obtain the spatial bias in the hdm examination of the temporal bias hdm tg which considers data points mainly at the coast revealed a mean bias with a range of 5 3 to 15 9 cm that is the hdm tended to overestimate the results along the baltic sea coast fig 9 the largest bias values occur in the gulf of bothnia especially the western side and in some other localized areas that appear to be tg location dependent interestingly the correlation between hdm and tg was high in these areas i e 0 92 in addition the standard deviation of the temporal bias also revealed that in most tg locations a value that varied from 7 9 cm there were however a few tg locations with a standard deviation of 10 cm and these were located of at the easternmost section of the gulf of finland at the russian tg of kronstadt tg id 73 cf fig 3 and also in the estonian tg station in the gulf of riga at the ruhnu station tg id 14 cf fig 3 this higher standard deviation may indicate issues with the vertical datum at these stations these results however strongly suggest that the bias calculated between the hdm and tg consists of a combination of vertical reference issues between the hdm and tg in addition possible problems with tg perhaps corrections applied or location of tg and hdm modelling errors may be present as was observed in jahanmard et al 2021 most pertinent is that these results highlight spatially the critical areas locations that require further examination improvements both with the hdm and tg data to obtain the spatial bias three different interpolations methods were employed linear idw and tps and in general results of all methods displayed similar patterns especially in the southwestern baltic sea fig 10 as expected three methods provide a stable sdbias with standard deviation of less than 2 cm in the vast majority of areas fig 10b the idw method however displayed a more realistic trend than others fig 10 in jahanmard et al 2021 a linear interpolation method was utilized for the gulf of finland however this showed peakiness at the edges as was seen in the results of this study instead now for this study the idw method displays an improvement that can be applied the idw method can further be improved for it also showed some localized discrepancy that were most likely influenced by the problems with tg data fig 10 this is so for in this study the assumption was made of the tg data being the truth most realistic whilst this assumption seems to perform reasonably well the results have revealed that some tg may have some problems e g location not ideal corrections applied thus the interpolation methods applied should be applied with care and checks performed with other datasets on the validity of results in general the corrected hdm mdt showed an improvement compared to uncorrected mdt in that the high and low frequency biases e g difference between reference level seasonal bias etc are eliminated by this correction and the hdm is corrected on the scale factor of almost 1 5 in many parts of the bs whereby the uncorrected mdt tended to overestimate the results given that the original hdm at the location of stations and tg records are more or less highly correlated fig 9c it was to some degree expected that a comparison of the raw and corrected hdm would show similar patterns in general this was the case for most areas of the baltic sea showed similar patterns as calculated in other studies e g madsen et al 2019 however the western side of the gulf of bothnia showed an unexpected variation compared to the raw hdm with a difference of 5 cm from western to eastern side this displayed that correcting the model for the bias may also change the overall pattern of the mdt to access whether the corrected hdm results were accurate or reliable a validation was performed using the sentinel 3a along track satellite data this validation on whether the corrected hdm was accurate or realistic especially in the offshore areas was employed by comparing sa along track data with that of the raw and corrected hdm this comparison showed that the corrected hdm was more compatible with sa than the uncorrected hdm figs 14 15 with a bias of 0 1 cm for corrected now existing versus that of 11 1 cm for uncorrected hdm whilst the sa agreed better with corrected hdm the higher differences still existed in the gulf of finland region previous sa studies suggested that in the baltic sea a rmse of 4 7 cm can be expected rautiainen et al 2020 mostafavi et al 2021 thus to ascertain exactly what may be occurring in the gulf of finland requires further examination for it could be a combination of hdm errors sa and tg related problems further examination of the sa along track profiles in this region revealed possible problems in geoid modelling due to sparseness of gravity data that may have affected results fig 15 pass no 414 fig 16 in varbla et al 2020a this specific location was also found to have possible geoid modelling issues in this study we employed the use of sa for validation but it is possible for future studies to employ use of gnss applications varbla et al 2020a or airborne laser scanning can be employed varbla et al 2020b thus the applied methodology appears to perform reasonably well in deriving a more realistic mdt the method however can be improved for comparison with hdm and sa data identified several key areas that require further investigation such as gulf of finland that may be affected by tg sa hdm or geoid modelling issues this study assumed that tg as representative of the truth the results however have shown that some tg may not be ideally located e g installed at the mouth of rivers or that may have had wrongly applied corrections and this require further examination for obtaining tg data from different countries authorities with different protocol of measurements and instrumentation may also have errors that may be unknowingly introduced since the results of this study were highly dependent on the bias calculated it is essential that i tg data are consistent and accurate as can be and ii the computed bias needs to be valid in the offshore areas this study was possible due to the dense network of tg in the baltic sea and the agreement on employing the geoid based baltic sea chart datum hence it is expected that similar approach can be applied in other marine areas utilization of the geoid as a vertical datum allows more realistic dynamic topography calculations and it is also more compatible with other sources of data to some degree it is expected that deriving a corrected hdm may also lead to changes in the dynamics of the marine area e g salinity temperature circulation the focus of this study however has been on achieving a realistic sea level component that is comparable with other sources of data for future studies it is possible to examine in an iterative approach the corrected hdm results with other components of the hdm model e g currents salinity etc consequently the results of this study demonstrate progress toward the utilization of a more realistic dt that has a valuable contribution to marine engineering and climate studies 7 concluding remarks this study has demonstrated a methodology that allows derivation of realistic dynamic topography both in the coastal and offshore areas of the baltic sea this was possible by the synergizing of tide gauge hydrodynamic and satellite altimetry data with the geoid being the key component that linked the vertical reference datum amongst them in most areas of the baltic sea the trend of the corrected dt agreed reasonably well with the general dynamics of the study area and also that of other studies the annual mean dynamic topography of corrected hdm was improved by a factor of almost 1 5 for example 2019 the uncorrected mdt was 50 cm and after correction was 35 cm in the gulf of bothnia in such a busy and dynamic marine environment of the baltic sea realistic dt allows better application on quantification for marine engineering e g pipeline construction offshore infrastructure etc and climate studies application incidentally however the methodology allowed identification of i potential problematic areas and seasons of hdm models that requires improvement ii tide gauges that may not be reliable for various reasons e g location not ideal for representing the coastal environment or questionable corrections that may have been applied iii areas of satellite altimetry along track passes that may be challenging even after outlier removal and iv areas that geoid model were not adequately represented thus the methodology shows an advancement and improvement towards our understanding of the marine environment and also the data sources being utilized in addition the assimilation of observed sea levels from tide gauge satellite altimetry etc into a hydrodynamic model requires that the model refers to the same vertical reference datum as the observed sea levels hence this vertical reference unification between model and observations enables possibilities to have a more effective implementation of the data assimilation technique for modelled dynamic topography and enhances hdm performance the method however can be improved for the satellite altimetry to confirm particular questionable areas e g eastern part of the gulf of finland the validation in the offshore areas using satellite altimetry showed promising results thus in future studies the utilization of other sources of offshore sea level data such as gnss surveys and buoys and airborne laser scanners can also be explored in addition it is possible for future studies to use the results of the corrected hdm to improve on other data components of the hdm e g currents salinity etc in an iterative approach credit authorship contribution statement vahidreza jahanmard conceptualization methodology validation formal analysis writing original draft visualization nicole delpeche ellmann conceptualization validation supervision writing review editing project administration artu ellmann conceptualization validation supervision writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is supported by the estonian research council grants prg330 development of an iterative approach for near coast marine geoid modelling by using re tracked satellite altimetry in situ and modelled data and prg1129 the authors are extremely grateful to the swedish meteorological and hydrological institute smhi for providing access to the model data the baltic seal project team for granting access to the sentinel 3a dataset and tide gauge data providers the estonian environment agency eea finnish meteorological institute fmi latvian environment geology and meteorology centre lvgmcl institute of meteorology and water management imgw pib federal maritime and hydrographic agency bsh and smhi we are also thankful for the constructive comments made by the anonymous reviewers appendix see table a 1 
23809,one of the major factors preventing utilization of realistic sea level data is that various sources are referred to inconsistent vertical reference datum vrd this study presents a methodology for deriving instantaneous and realistic sea level data from the coastal to offshore areas of the baltic sea by synergizing different sources of sea level data tide gauge tg hydrodynamic model hdm and satellite altimetry sa the key component being the geoid that links the vrd of these different sources hdms are known to be a representable source of sea level data however their vrd is often undisclosed therefore they are often spatially and temporally biased with respect to in situ data this study demonstrates that by using geoid referenced tg data that represents realistic sea level it is possible to correct hdm by deriving and applying a spatial bias correction three interpolation methods linear thin plate spline regression and inverse distance weighted are examined to derive the corrected hdm the results showed an improvement with respect to tg data and the annual mean dynamic topography of corrected hdm was improved by a factor of almost 1 5 examination of the sentinel 3a satellite along track data also confirms the corrected hdm data to be more accurate the methodology applied also identified problematic locations of hdm sa and geoid data along with unreliable tg this accuracy and conformity in sea level data are urgently required for a comprehensive understanding of climate change marine engineering and navigation applications which can be achieved by adapting the uniquely defined geoid for the vertical reference datum keywords sea level geoid hydrodynamic modelling vertical reference datum hydrogeodesy baltic sea 1 introduction a continuous model of accurate sea level from the coast to the offshore area with pre defined uncertainty bounds becomes imperative for many applications such as navigation marine engineering and climate studies with better than sub decimetre accuracy now required the challenges of obtaining such an accurate model are hindered not only by the spatial and temporal resolution of the various sea level sources e g tide gauges tg hydrodynamic model hdm shipborne and airborne global navigation satellite systems gnss profiles and satellite altimetry sa but also foremost by inconsistencies in the vertical reference datums used amongst these sources slobbe et al 2014 jahanmard et al 2021 hydrodynamic models whilst capable of successfully simulating a continuous model of relative sea level are often flawed by two major factors the first and most relevant to this study is that in many hydrodynamic models there is insufficient knowledge of the vertical reference datum used afrasteh et al 2021 slobbe et al 2014 secondly the hdms are driven by mathematical equations with input sources from other models e g atmospheric river discharge sea ice dynamics etc moreover models contain underlying assumptions and approximations in the relevant model set up e g boundary conditions parametrization and discretization techniques etc kärnä et al 2021 khanarmuei et al 2021 hieronymus et al 2017 zhang et al 2016 these factors often result in many hdms being systematically biased both spatially and temporally relative to observations previous studies have examined the bias correction of hdm with respect to salinity and temperature chang et al 2021 as well as climate models aung et al 2016 giorgi 2019 however the spatial and temporal bias correction related to the sea level parameter has often been overlooked although the hdm derived sea level does not correspond to the in situ observations its simulations still represent an acceptable trend of sea level a simple and reasonable approach that has been utilized by many studies is by calculating the correlation and standard deviation between hdm sea level and land bounded tgs i e assuming the tgs refer to some defined datum to demonstrate model assessment hordoir et al 2019 kärnä et al 2021 some applications also derived a bias correction by computing the difference of hdm with the tg records that refer to a desired vertical reference varbla et al 2020a mostafavi et al 2021 the problem becomes complex for numerous applications e g determining realistic absolute sea level rise climate studies engineering design etc now require accurate sea level not only in the coastal domain i e within the vicinity of tg but also in the offshore domain considering that the hdm sea level bias varies both spatially and temporally with high and low frequency components jahanmard et al 2021 this makes it challenging to obtain accurate and consistent sea level data from the coast to offshore in jahanmard et al 2021 biases of the model with respect to a dense network of geoid referenced tgs were hourly extended to the offshore using a linear interpolation method nevertheless the performance of the bias correction in the offshore area remained unclear this signals the need for a solution that also corrects the hdm data in the offshore zone so that a consistent and realistic vertical datum is utilized motivated by these challenges the focus of this study is to demonstrate a novel method that corrects the hdm bias both in the coastal and offshore area using a consistent and realistic vertical datum and to demonstrate the applicability of this towards improving other related studies hydrodynamic models are however not the only source of sea level data and as mentioned above there are other sea level sources such as tide gauges with defined vertical datum tide gauges are known historically for being one of the most reliable and accurate sources of sea level data due to the long time span of data collection along the earth s coastline as a result tg data are often considered as representative of the true sea level jahanmard et al 2021 cipollini et al 2017 nevertheless there are three important limitations in using this source i as mentioned above the spatial coverage of tg tends to be constricted to the coastal boundary and thus not ideally representable for the offshore areas ii as tgs usually measure relative sea level i e relative to the land where the tg stations are stationary positioned they are influenced by the vertical land movement that may occur e g glacial isostatic adjustment this signifies that in areas affected by any land deformation there is a need for relevant corrections to be applied in order to derive the true sea level variation moreover iii the vertical reference datum of marine areas is commonly referred to a chart datum which is based on either a tidal observation e g some historic mean sea level msl lowest astronomic tide lat etc theoretical mean sea level models e g as it was used in finland recently or a physical model such as the geoid schwabe et al 2020 whilst sufficient to a certain degree based on the application most of these chart datums may vary over different time periods also depending on the country community the sea level data may be referred to differently defined vertical datums for instance the baltic sea countries utilize several different vertical reference datum definitions table a 1 and in such a dynamic marine area where integration is essential this can create inconsistency and incompatibility as a result this study proposes utilizing a common and static vertical reference such as the geoid as a more reasonable approach the geoid is a shape of the equipotential ocean surface under the influence of the gravity and rotation of earth alone therefore it would be more or less a static vertical datum unlike msl which wavers over time and represents the natural zero note that the geoid can vary due to mass redistribution however this variation is usually negligible the maximum value for the geoid rise in the baltic sea is around 0 6 mm year due to postglacial rebound kakkuri and poutanen 1997 thanks to precise gnss levelling it is possible to transfer a network of tg stations to a common geoid based vertical datum thus it is more applicable to validate the different data and model sources against the geoid referenced tg data rather than using various and msl based chart datums liebsch et al 2002 varbla et al 2020a b this validation should identify any bias between sources with respect to the vertical datum in addition to other systematic and random errors thus it seems pragmatic to use the reliable tg records that are referred to some stable and realistic vertical datum to fit the hdm associated sea level data to a common vertical datum nordman et al 2018 jahanmard et al 2021 the geoid referenced sea level data now allows us to derive automatically dynamic topography dt which is physically meaningful and better quantification of a more realistic sea level jahanmard et al 2021 as a result the mean dynamic topography mdt can be calculated which is the difference between the mean sea surface and the geoid fig 1 note that there are basically two approaches to calculate the mdt first and foremost by a geodetic approach whereby knowledge of the mean sea surface mss is derived from sa or tg records referred to a precise geoid model idžanović et al 2017 the oceanographic approach second utilizes solely hdm derived sea level data ophaug et al 2015 in this study we shall utilize a combined approach that employs both geodetic and oceanography methods since we are interested in the dt not only in the coastal area but also continuing into the offshore this is to our knowledge the first attempt of such a synergized exploration in the entire baltic sea and it is expected that similar forthcoming developments can be adapted in other marine areas worldwide based on the challenges problems outlined above we examine the baltic sea region to demonstrate an innovative and improved method that incorporates various sea level sources along with a high resolution geoid to obtain a more realistic and accurate dt this study area is ideal for such a demonstration due to the presence of a dense network of tgs with a common geoid based vertical reference datum baltic sea is a semi enclosed sea which is also fortunate to have an accurate geoid model a realistic postglacial land uplift model sa data that have been specially corrected for the area specific marine conditions a three dimensional hdm and an agreement between nine coastal countries towards having a common marine chart datum i e the baltic sea chart datum ågren et al 2016 ellmann et al 2019 vestøl et al 2019 schwabe et al 2020 therefore a synergy of hdms and tg records along with other data sources such as satellite altimetry and marine geoid model is expected to yield high resolution realistic dt both temporally and spatially in addition we shall demonstrate that the method applied can also reveal the accuracy or deficiencies of the different data sources utilized thus the core component of this study is the development of a methodology that reduces the fluctuating zero level of hdm to a geoid based vertical reference for this purpose the bias of the hdm is corrected by utilizing a tg network comprising 73 stations such an approach was first utilized in jahanmard et al 2021 using a simple linear approach to distribute the bias spatially this approach however may be flawed because of a lack of validation in the offshore area and an insufficient assessment of the bias interpolation sensitivity this study reduces these flaws by now including a wider sea area and denser tg network that allows the examination of three different interpolation approaches i triangulation based linear interpolation ii thin plate spline regression and iii inverse distance weighted the best derived results are then evaluated and validated by utilizing the sa data sentinel 3a with respect to the nkg2015 geoid model this validation becomes most relevant in the offshore areas where the largest uncertainty is present one of the most pertinent advantages of using an identical and stable vertical datum amongst the various data sources is that accurate dt can now be determined the method applied also significantly contributes to identifying i aspects of hdm modelling that require improvement ii sa problematic issues and iii aspects locations of the geoid modelling that require improvements the organization of the present paper is as follows first the developed and general methodology is outlined next the data sources are highlighted i geoid referenced tide gauge network ii nemo nordic hdm model iii nkg2015 geoid model and iv sentinel 3a satellite altimetry data the hdm bias correction method is described in both time and spatial domains then the difference between corrected models and sa data as well as the results are presented finally a discussion on the results and method is described followed by a summary that concludes the paper 2 general methodology in this study different techniques and approaches are employed to derive the sea level from the coast and offshore as mentioned above one of the major challenges in obtaining accurate dt is that various data sources refer to various vertical reference datums apart from making it difficult to compare datasets this inconsistency also leads to errors particularly when inter country community issues arise thus this section now describes an overall view of the method used to refer the vertical datum of the various sources to that of a static and common vertical datum such as the geoid i e the equipotential surface of the earth three principal sources of data that shall be utilized are tg sa and hdm data fig 1 illustrates the inter relations between these data sources and the hydrodynamic parameters of interest in both the spatial and time domain recall that the tg data can be referenced to different chart datums e g msl lat etc in the study area the baltic sea chart datum 2000 bscd2000 is adopted as a geodetic reference system to unify chart datum between the surrounding countries the chart datum is based on the common geodetic standards for height system european vertical reference system evrs and spatial reference system european terrestrial reference system etrs89 in europe the zero level of bscd2000 is in agreement with the normaal amsterdams peil nap and the chart datum coincides with the geoid surface schwabe et al 2020 as previously discussed the sea level variations with respect to the geoid surface yield dynamic topography dt which is more physically meaningful than sea level relative to other vertical datums e g msl lat which may vary depending on definitions tide gauge records however reflect the nearshore dt from a relative perspective i e sea level variations relative to land on the other hand satellite altimetry sa measures the absolute sea level that is without regard to vertical land motion in both coastal and offshore areas the satellite derived sea surface height s s h s a is relative to a geodetic reference ellipsoid e g grs 80 which can be converted to d t s a as follows 1 d t s a φ λ s s h s a φ λ n φ λ where n is the static geoid height a separation from the reference ellipsoid in this study nkg2015 as the most recent official geoid model over the baltic countries is employed ågren et al 2016 hydrodynamic models typically lack a well defined vertical reference as such it is not straightforward to express the model derived sea levels in a 3d coordinate system since the model dynamics assume zero horizontal gravity components we denote the original raw hdm derived sea level as d t h d m despite knowing that the raw hdm is not exactly expressed relative to a geoid because the bathymetry used and prescribed sea levels along the open boundaries have not been referred to the geoid slobbe et al 2013 therefore since the vertical reference of the hdm is still unknown the study focuses on determining accurate hdm derived dt particularly in the offshore area in this regard the primary objective of this study is the development of a method to correct the d t h d m utilizing a stable height system reference surface a geoid in doing so a geoid referenced tg network is employed to determine and correct the bias of d t h d m with respect to d t t g at the location of tgs the hdm biases are distributed to the offshore using an interpolation technique and then the corrected hdm is examined through the d t s a as mentioned above due to dissimilarity in the vertical reference datums used by the d t h d m and d t t g it is expected that a difference exists this difference however changes both temporally and spatially and it is quantified in this study as a bias due to the characteristics of this bias it was necessary to first derive a time domain bias tdbias followed by a spatial domain bias sdbias note that firstly the tdbias is determined by identifying the closest hdm grid point to that of the tg location the difference is then calculated between the time mean value of hdm at the tg location d t h d m t g and d t t g within a certain time interval the backward moving average method is commonly used to correct the temporal bias of models jahanmard et al 2021 lagemaa et al 2011 2 tdbias m k i 1 k 1 j k 0 d t h d m t g m i j d t t g m i j i k where m denotes a specific tg station and k is the window length of the moving average in this formulation i is the index of time vector ordinal number that according to the temporal resolution of hdm and tg records is increasing hourly obviously the small amount of k yields the high frequency error between the model and tg and the k 0 represents the instantaneous bias which is applicable for extreme cases in this study we require an uncertainty of less than 5 cm in order to obtain accurate sea level data thus from previous studies a window length of less than 6 h is recommended jahanmard et al 2021 to obtain the uncertainty of tdbias in each tg station the root mean square of errors is obtained from residuals ɛ which is the difference between the corrected model and raw model at the location of tg due to including the moving average filter in eq 2 as follows 3 r m s e m k h d m t g j k 1 n ɛ m j ɛ m 2 n k where n is the number of observations at the m th station and k as before is the window length of the backward moving average which should be removed from the beginning of records for determining rmse the tdbias is valid only near the coast in the vicinity of the tg location to achieve the bias through the offshore area i e sdbias an interpolation between the dense network of tg stations is employed 4 sdbias x φ λ t interp x φ t g λ t g tdbias t φ λ where interp x is the interpolation operator whereas x indicates the type of implemented interpolation technique the φ t g and λ t g are the vector of latitude and longitude of the employed tg stations respectively the sdbias is computed on the grid nodes of the model with vectors of latitude φ and longitude λ therefore the corrected hdm is calculated accordingly 5 d t h d m c φ λ t d t h d m φ λ t sdbias φ λ t the d t h d m c represents coastal and offshore values with respect to the geoid model the various interpolation techniques such as linear inverse distance weighted and thin plate spline will be performed to determine the sdbias see section 4 2 and the corrected model will be assessed using d t s a note that the d t s a values are often accompanied by outliers and another bias related to the tg records is also calculated see section 3 4 the schematic roadmap of the implemented methodology to correct the model and compare the various correction methods is shown in fig 2 3 data sets 3 1 tide gauge dynamic topography in this study the tg data serves as the foundation of accurate sea level data particularly with respect to deriving the time domain bias i e tdbias eq 3 the tg data were compiled from various sources around the baltic sea countries see table a 1 after performing quality and reliability checks a robust network of 73 stations from nine countries along the coastline of the baltic sea was chosen this tg dataset consists of hourly in situ sea level data for the period december 2016 april 2020 see fig 3 and table a 1 since different baltic countries use different vertical datums it is essential to transfer all tg records to an identical common vertical datum i e the baltic sea chart datum the estonian danish and swedish tgs are available with respect to their own national reference frames that are eh2000 dvr90 and rh2000 respectively the remaining countries tg records are referred to the tgz except finnish tgs that are referred to the theoretical mean sea level that have been transferred by adding the individual conversion values the value and reference of these conversion values and national reference frame that comply with bscd2000 are listed in table a 1 by these conversions all stations are set down on a common european vertical reference system with an identical zero level of nap the permanent tide system of tg readings is the zero tide system except for germany russia and denmark which are in the mean tide and tide free system cf table a 1 since the russian national height system bhs77 baltic height system 1977 has not changed to the european vertical reference system the zero level is shifted by adding 19 cm to this tg station sacher 2019 this offset value is an approximate difference between the kronstadt i e former zero level and nap to harmonize the permanent tide system of the tg records specified in table a 1 with the hdm and sa data tg data are transferred to the mean tide system by conversion algorithms provided by ekman 1989 tide gauge readings originally are relative to the tg zero mark and then the records are reduced to the national height datums by near benchmark e g bscd2000 conversions in the baltic sea tgs benchmark refers to nap evrf2000 zero permanent tide system in order to transform the records to the mean permanent tide system the separation between the benchmarks and nap height δ h need to be transferred from the zero tide to the mean tide system thus ekman 1989 6 δ h m δ h z 29 6 sin 2 φ b sin 2 φ n a p δ h z c z 2 m cm also for non tide national datums e g denmark γ 0 7 7 δ h m δ h n 29 6 γ sin 2 φ b sin 2 φ n a p δ h n c n 2 m cm where φ b is the geodetic latitude of tgs benchmark and φ n a p is the latitude of nap 52 22 53 in the european terrestrial reference system 1989 therefore the conversion to the mean permanent tide system c z 2 m will be added to the bscd2000 correction and finally tg records are corrected as follows and the same for c n 2 m 8 d t t g m e a n t i d e d t t g z e r 0 t i d e c z 2 m in addition tgs measure relative sea level and since in the study the absolute sea level is required the vertical land motion vlm must be taken into account especially in the baltic sea where the stations are strongly affected by vlm due to the glacial isostatic adjustment accordingly the land uplift increases from near zero in the southern part of the baltic sea to about 10 mm year in the northern part vestøl et al 2019 fig 4 shows the difference between long term trends of relative and absolute sea level in an example station spikarna station tg id 52 in the north of the bothnia sea in this station the relative with respect to the land mounted tgz sea level trend is strongly negative 6 7 mm year while the absolute with respect to the centre of the earth sea level trend is positive 2 2 mm year in this area madsen et al 2019 it should be noted that whilst the tg measurements are one of the most reliable sources of sea level data they may contain gross errors or temporal gaps since these data deficiencies can disturb or decrease the quality of each analysis especially for obtaining hourly tdbias see eq 2 it was necessary to identify and fill the gaps in the time series the missing tg data have been simulated by k nearest stations using a linear least square regression method which results in the estimated dt with an uncertainty of 3 5 cm on average also tg data screening was performed by removing spikes with residuals larger than three standard deviations 3 2 hydrodynamic model nemo nordic is a three dimensional coupled ocean sea ice model of the baltic and north sea hordoir et al 2019 that was developed by the swedish meteorological and hydrological institute smhi and originally based on the nemo 3 6 ocean engine nucleus for european modelling of the ocean in this study we utilize a data assimilated version of the nemo nordic model with an hourly temporal resolution and a horizontal resolution of 1 nautical mile for the period 3 december 2016 15 april 2020 the data were obtained from smhi smhi 2021 and are expected to provide sea level predictions at a higher level of quality than previous models used in the study area due to model setup settings and data assimilation techniques employed hordoir et al 2019 kärnä et al 2021 a major feature of nemo nordic compared to other hdm models used in the baltic sea is that two open boundaries are utilized a meridional one in the western part of the english channel and a zonal one located between scotland and norway the sea level temperature and salinity boundary conditions are obtained from ecmwf the european centre for medium range weather forecasts data in the operational mode hordoir et al 2019 the model also uses a nonlinear explicit free surface method with a time splitting approach that computes a barotropic and a baroclinic mode as well as the interaction between them nemo nordic uses a buoyancy extended k ɛ turbulence model and nemo 3 6 is two way coupled with the ice model lim3 6 the atmospheric forcing is sourced from hirlam c11 high resolution limited area model in operational mode present model the river discharge data are derived as daily means from hydrological predictions for the environment e hype bathymetry data utilized in the model was sourced from the general bathymetric chart of the oceans gebco 2014 hordoir et al 2019 in hordoir et al 2019 a statistical comparison between measured and modelled sea level at different tide gauges in the baltic and north seas was performed this however was restricted to only a few stations located in the baltic sea for an 18 month period from july 2011 to 31 december 2012 their results showed a high correlation between model and observations and a negative bias in terms of the representation of the low frequencies in the north sea for the rest of the baltic sea however no major bias was identified this study now considers a greater number of stations and from fig 5 which displays the sea level of the hdm at a specific time instant it is quite noticeable that a difference exists in hdm denoted by red colour map at the location of tgs therefore the objective of this study is to evaluate and correct the nemo nordic sea level by using a geoid referenced tide gauge network that now consists of 73 tide gauge stations note however that the nemo nordic vertical datum is not explicitly specified as a result we shall show in this study why the utilization of the geoid is a better approach 3 3 geoid model the nkg2015 the most recent high resolution 0 01 0 02 degrees geoid model over the baltic countries was developed by the nordic geodetic commission in a long term project that began in 2011 ågren et al 2016 this model is based on the least squares modification of stokes formula with additive corrections lsmsa in the framework of a remove restore procedure the standard deviation of this model in the 1 parameter fit to gnss levelling is 2 85 cm 1 5 2 0 cm on land the coverage of the nkg2015 is from the latitude of 23n to 73n and the longitude of 0e to 34e the geoid model refers to the grs80 ellipsoid etrf2000 frame epoch 2000 0 note that the official nkg2015 model that is released online contains a hybrid permanent tide system i e a non tide conversion has been added to the model to be able to use it directly for gnss measurement therefore in this study we used the original one nkg2015 zt which is a pure zero tidal model in order to be able to use the nkg2015 for determining dt with sa data the geoid model is transferred to mean tide system as follows varbla et al 2022 9 n n k g 2015 z t 0 29541 sin 2 φ sin 2 φ n a p 0 00042 sin 4 φ sin 4 φ n a p where φ n a p is the latitude of nap and this equation is expressed in units of the metre 3 4 satellite altimetry data satellite altimetry sa is a well known space technique used for measuring sea level data both in the offshore and coastal areas one of the major advantages of sa that shall be employed in this study is that it tends to be a major source of data capture in the offshore areas compared to the tg data that are limited to coastal areas in this study we employed the sentinel 3a s3a high frequency 20 hz along track sea level measurements that operates in sar mode and is based on ales sar an adapted retracking algorithm from baltic seal datasets passaro et al 2021 the data are captured at an across track resolution of 1 64 km and an along track resolution of 300 m desjonquères et al 2010 this dataset has been specially corrected for the coastal and sea ice conditions of the baltic sea and was obtained from http balticseal eu data access the time period from january 2017 to june 2019 33 cycles with a repeat period of 27 days which covers 39 passes over the baltic sea see fig 3 is examined 3 4 1 satellite altimetry corrections from the precise knowledge of the satellite orbit height h orbit and the sa range r determination using retracking waveforms several other corrections atmospheric and geophysical are applied to derive the sea surface height ssh eq 10 displays the algorithm that was implemented by default to the baltic seal products passaro et al 2021 10 s s h b s h orbit r w t c d t c i o n o s s b d a c s e t p t r o c where s s h b s is obtained by default from the s3a data baltic seal project which referred to topex poseidon reference ellipsoid the wet tropospheric wtc dry tropospheric dtc and ionospheric iono are atmospheric propagation corrections due to radar pulse passing through earth s atmosphere sea state bias ssb dynamic atmospheric correction dac solid earth tide set along with pole tide pt are classified in the geophysical corrections which refer to the systematic geophysical effects that can be modelled and corrected the radial orbit error roc is a new correction that was derived and is based on multi mission cross calibration to ensure a consistent combination of all different altimetry missions bosch et al 2014 since we will compare the sa data reduced for dac with hdm data that does not the default dac correction must be cancelled by adding it back to the s s h b s similar approach was also performed in other studies madsen et al 2019 rautiainen et al 2020 passaro et al 2021 note that the ocean tide corrections ot are not included in the s s h b s eq 10 since the tides in the baltic sea are generally small less than 10 cm samuelsson and stigebrandt 1996 all other geophysical corrections i e set and pt remain to obtain identical measurements with tg records and hdm the dt sa is formed by referencing the ssh bs to a geoid model i e nkg2015 the sa data are referred to the topex poseidon reference ellipsoid itrf2008 mean permanent tide system hence in the case that the geoid height n eq 9 is to be used together with sa data the ssh bs and n must be referred to the same reference ellipsoid and coordinate system for this purpose the sa data were transformed to the grs80 and etrf2000 through three steps i conversion of the sa data to geocentric coordinates x y z ii transformation of the data from itrf2008 to etrf2000 altamimi 2018 and iii converting back the data to the geodetic coordinate according to the grs80 reference ellipsoid finally the dt sa is computed accordingly 11 d t s a φ λ t s s h b s φ λ t d a c φ λ t h offset φ λ t n φ λ where h offset is the conversion values from topex poseidon reference ellipsoid itrf2008 to the grs80 etrf2000 3 4 2 satellite altimetry outlier removal outliers may be present in the sa data due to land contamination presence of industrial infrastructure wind turbines platforms etc turbulent waters etc especially near the coast as a result a three step data screening procedure was applied for the outlier removal i obvious outliers that are outside of the 3 m range were removed according to time history of other sources d t s a larger than 3 m is physically impossible and distorts the sa statistical parameters this is followed by ii a moving median with a window length of 1 nm was applied along the tracks and the sa data more than four local scaled mad median absolute deviation away from the local median within the sliding windows have been deleted as the coarse random errors shown in red marker in fig 6a and finally iii the d t s a of each track was filtered by 3 standard deviation i e outside of the 99 7 confidence interval from the least square ls spline approximation shown in red marker in fig 6b to determine the ls spline curves for each track a piecewise quadratic polynomial with q knots was applied accordingly 12 d t s a j x a 0 j a 1 j φ a 2 j φ 2 j 1 2 q where j denotes the index of knots and q is the number of polynomial pieces neitzel et al 2019 this approximation allows the d t s a to approach the coast fairly as much as the sa data is available note that the value of q varies for each pass and cycle depending on the ground track length and instantaneous sea surface shape therefore the number of polynomial pieces q was calculated using an optimization method to minimize residual standard deviation residsd for each pass cycle for this purpose the residsd is determined accordingly 13 residsd i 1 n ɛ i ɛ 2 n 1 where ɛ and ɛ are the residual between the sa data and ls spline curve and mean of residuals respectively the residsd is obtained over the n data points along track blue dots in fig 6b fig 7 shows all residsds according to eq 13 based on compilation of all the passes fig 7a and all the cycles fig 7b according to fig 7a the large residsd amounts belong to short ground tracks that are within the vicinity of land i e pass no 44 1 158 2 425 1 500 1 625 2 and 756 it also can be observed that bothnia bay i e pass no 197 2 311 2 386 1 425 2 and 739 2 has a large dispersion in the residsd which can be due to sea ice conditions in the winter months the median of residsd for all passes and cycles is 3 6 cm this examination of the sa data proves that the sa data are reasonably consistent and can be used for validation of d t h d m c it also hints and identifies possible problematic time wise cycles for instance periodic pattern is evident with an increase in the late winter and early spring cycles 14 28 29 41 which indicates a greater dispersion of sa observations in theses seasons see fig 7b 3 4 3 cycle mean dynamic topography to give a better assessment of the model s performance in the offshore the cycle mean of dt cyclemdt was obtained along the sa tracks since the cycle period of s3a is 27 days the cyclemdt can make a contrast with hourly mdt of the hdm and tgs moreover it is possible to reduce the contribution of low quality cycles i e cycles with high residsd according to fig 7 by using weighted mean 14 cyclemdt φ λ cycle i 1 c d t φ λ i w i p a s s i 1 c w i p a s s with 15 w i p a s s 1 residsd p a s s i where c is the number of sa cycles i e c 33 for the period january 2017 june 2019 and residsd is the residual standard deviation according to fig 7 the cyclemdt was also determined for the hdm and tg data similar to sa that is at the time of sa cycles using a linear interpolation and similar weight eq 15 used for sa the hdm data were extracted at the coordinates of the sa data points via bilinear interpolation 4 method for examining time and spatial domain biases 4 1 time domain bias approach as mentioned above a difference in various sources of sea level is expected at similar locations due to i the dissimilarity in the vertical reference datum utilized and ii the limitations of the methods employed in capturing sea level given that we have taken the perspective of the tg data represents the truth within the coastal area then to obtain the difference between dt of the hdm and tg records the closest grid point of hdm to the tg locations less than 4 km in most stations are selected and extracted to produce the d t h d m t g time series for all 73 used stations thus this difference referred to as tdbias is determined according to eq 2 by using a 6 h moving average filter that gives an uncertainty of less than 6 cm with respect to the tg records cf fig 8b for instance tdbias time series for three tg stations are shown in fig 8a as can be observed the bias is not constant in time and it varies from around 20 to 30 cm it is also apparent that the tdbias behaves periodic and the seasonality of bias is obvious with crest and trough in the spring and autumn seasons respectively the peaks in spring may be due to problems with river runoff or atmospheric forcings which may serve as significant indicators of possible improvements for modellers the statistic parameter of tdbias for all stations during the period december 2016 april 2020 along with the correlation of raw nemo nordic data with tg records in the course of time are illustrated in fig 9 it is evident that the mean of tdbias at tg stations varies spatially between 5 and 16 cm with the highest values mostly occurring in the western side of the gulf of bothnia fig 9a and also at some distinct locations along the coast of the baltic sea e g tg ids 16 28 29 and 45 or due to their locations e g mouth of river etc that causes them to be in disharmony with adjacent stations observe however that in these areas of higher bias the hdm and tg data are highly correlated fig 9c this hints that the hdm simulates similar dynamics as tg thus the issues with the vertical datum or possibly even tg corrections are the major component contributing to the higher bias also observe in fig 9 that the model has larger standard deviation 10 cm with respect to individual tgs in the gulf of riga tg id 14 and in the eastern part of gulf of finland tg id 73 see fig 9b since the surrounding tg are lower in standard deviation this could indicate also possible issues with the tg data e g insufficient corrections applied 4 2 spatial domain bias approach since the d t t g are only valid near the coast in the vicinity of the stations computing the bias of all hdm grid points directly by eq 2 is not an ideal approach instead given a set of tdbias for a given time instant a spatial interpolation can be employed to distribute hdm bias over the study area this aims to fit a surface i e sdbias that will best represent the spatial hdm bias to obtain sdbias the interpolation method and distance between the tg stations play key roles the spatial interpolation is calculated based on the bias calculated between hdm and tg data at the location of stations however a valid d t h d m c in the open sea is indeed strongly dependent on the hdm s performance in terms of high correlation between model and observations i e truth in this study the nemo nordic model was corrected using three interpolation methods i linear lin ii thin plate spline regression tps and iii inverse distance weighted idw however other methods e g kriging and least squares collocation are also commonly used in similar studies here three selected interpolations with different interpolating approaches were used to demonstrate the sensitivity of the hdm correction method to the sdbias and we will show that the methods provide less than a few centimetres variations in sdbias to exclude possible instantaneous errors such as spikes in the tg records a 6 h filtering window was applied as mentioned in section 4 1 as a result the tdbias k 6 h r yields a rmse of 2 7 cm on average see fig 8 which are suitable for interpolation process the exception is for thin plate spline regression method where the instantaneous tdbias was used the linear interpolation lin can serve as a first approximation of the offshore bias assuming the bias changes linearly over space jahanmard et al 2021 the second approach tps is a spline based technique that arises from consideration of the integral of the square of the second derivative regarding this method it is expected that the possible tg reading defect between stations relative to nearby stations is moderately relaxed the tps regression yielded an rmse of 2 5 cm on average over time and at the location of the tgs after comparing corrected hdm and tg records the third used interpolation method is inverse distance weighted idw whereby data points stations closer to the grid points have more effect than those which are further away in this regard the weighted mean is employed accordingly 16 sdbias i d w φ λ i 1 m w i φ λ tdbias i i 1 m w i φ λ φ λ φ i λ i with 17 w i 1 d φ λ φ i λ i 2 the subscript i denotes the tg stations m is the number of stations i e m 73 and d is a distance measurement operator which is used to measure distances on a sphere as an example fig 10a shows the computed sdbias using the above methods for a particular time instant 31 january 2018 21 00 utc see fig 5 for d t h d m in this figure a spatial variation of model bias has been illustrated all three methods show a more or less similar trend and range 11 26 cm and as expected the trace of triangles edges are visible in the lin interpolation method generally speaking in all three interpolation methods the largest bias is associated to the western section of the baltic sea and also at some localized areas due to certain tg quality issues to evaluate the similarity and difference of those methods in the course of time fig 10b represents standard deviation of range of three methods during december 2016 april 2020 observe that in most areas the variation of the difference between methods is less than 2 cm the largest difference occurs in the gulf of riga tg id 14 where the range of three methods has the highest standard deviation of 4 2 cm in the course of time see fig 10b this also coincides with fig 9b that showed the same tg station also having a higher standard deviation and lower correlation than others surrounding it by correcting all grid data for the bias the corrected hdm d t h d m c is obtained eq 5 in the following the methods were compared with sa data and as a result although corrected hdms show more or less similar results and rmse with respect to the d t s a we selected the idw method as a preferred method to be used for correcting the model following this the idw method for hdm correction is shown in all the calculations however we will also show in section 5 2 that the differences between methods with respect to sa data are barely noticeable in the offshore area the d t h d m c and raw hdm for the time instant see fig 10a for sdbias are presented in fig 11 after correction the pattern of dynamic topography has not changed noticeably but the range of d t h d m c has been shifted and narrowed to 5 78 cm while the range of raw hdm was 20 100 cm at this time instant to verify if the corrected hdm data are reliable and accurate enough validation in the offshore areas was necessary and this was performed in this study by utilizing sa along track data to illustrate the model changes in the time period of interest the time mean and temporal standard deviation of sdbias are shown in fig 12 the mean of sdbias for 41 months demonstrates that the hdm bias is roughly 10 cm with a higher value in the western baltic sea this bias varies by more than 7 cm in the course of time fig 12 right which implies that long term bias corrections e g the mean of a year are incapable to improve the model accuracy with respect to the tg data fig 8a illustrates the same point the spatial standard deviation of the mean sdbias fig 12a is roughly 1 3 cm this unnoticeable amount of the spatial bias variation could indicate that the hdm uses more or less an equipotential surface of the earth s gravity field as its reference and using the term d t h d m is an acceptable assumption it is also noticeable in this figure that some stations may have zero level problems or the hdm may not be able to simulate regional effects such as river runoff 5 results 5 1 mean dynamic topography by utilizing a network of geoid referenced tg data along the baltic sea coastline it was possible to derive a corrected hydrodynamic model dynamic topography d t h d m c this variable now represents sea level variations with respect to a more realistic zero level being that of the geoid as a result of this it is possible to obtain a realistic mean dynamic topography mdt over different time scales seasonal annual etc that can reveal the persistent or semi persistent dynamical patterns note that the hdm s high temporal and spatial resolution is its advantage for this purpose compared to other datasets the mdt is determined for different time period fig 13 illustrates the annual mdt for the raw and corrected hdm along with the mdt of used tgs that are shown in circles with the same colour bar at the location of stations particular characteristics are observed for instance i the raw hdm over estimates the tg records thus the actual values are lower ii in general similar patterns of mdt is observed however there exist at particular areas a difference in patterns and trends and iii localized areas shows slight inconsistency in a few stations e g tg id 16 as also mentioned in section 4 1 and fig 9 where the tdbias of each station is compared to the adjacent stations that had a higher standard deviation but lower correlation in general the corrected mdt like raw hdm exhibits a spatial pattern with the largest mdt in the north of the gulf of bothnia and eastern section of the gulf of finland this is the expected trend in the baltic sea madsen et al 2019 which are due to freshwater accumulation and wind forces soomere and quak 2013 the annual mdt however shows much more variation in the corrected mdt than the original model for instance in 2019 the range of mdt is reduced almost from 37 0 55 0 18 0 to 29 0 46 0 17 0 cm and the difference between the north north of bothnia bay and south north of poland of the baltic sea has been reduced roughly 25 percent this difference is especially noticeable in the gulf of bothnia in all three years recall that in the gulf of bothnia the highest bias was applied whether this application of a higher bias is suitable requires further examination for it is possible that i in gulf of bothnia especially in its northernmost part bay of bothnia many of the tg are not exactly located at the coast but may be located more inland in riverways so even though they may reflect the trend of sea level their actual value may not reflect that of the coastal sea area as was captured by the models and ii issues with tg corrections that are unknown at the time of this study e g offsets vertical land movement corrections etc to verify however if the corrected hdm data are reliable and accurate enough especially in the offshore areas and in the areas of higher variation in trends a validation with sa data is performed section 5 2 5 2 validation in the offshore areas the sa data provide an independent source of validation of the corrected hdm especially in the offshore thus we validated the raw corrected hdms in order to show and compare the performance of the developed methods in the offshore however several studies have shown that sa data may still be biased even after corrections are applied e g mostafavi et al 2021 and an accuracy of 2 5 cm is achievable with the sa sentinel 3a data we utilize the sa along track sea level profiles that are compared with similar profiles extracted from the hdm the corrected model was evaluated using sa data via two approaches in the offshore areas i calculation comparison of the along track sa bias with respect to the raw corrected hdm data fig 14 and ii comparison of the cyclemdt of various datasets as defined in section 3 4 see eq 14 in both approaches we are going to show the variation of inconsistency between hdm and sa data for the first approach the sa bias with respect to each hdm data is determined accordingly 18 b i a s s a i 1 n d t s a i d t h d m i c n where n is the number of sa data along the track and d t h d m i c is the corrected model for obtaining the d t h d m along each pass in the desired cycle the hdm data have coincided temporally and spatially with the sa data points with linear interpolation fig 14 shows the bias of s3a with respect to the raw hdm in black and corrected hdm in green blue and red for lin tps and idw method respectively versus the sa passes fig 14a and cycles fig 14b the comparison using all passes and cycles shows that i with all three interpolation method the differences are almost negligible that is the model correction is insensitive to the interpolation method ii the sa data agrees better with the corrected hdm median of sa bias is roughly 1 5 cm compared to the uncorrected median of sa bias 13 2 cm iii the scatter plot of the bias fig 14c which shows the median of the bias for the corrected hdm identifies some passes with large biases such as the eastern part of the gulf of finland with a bias of over 5 cm these passes are however similar to the areas of higher standard deviation of sdbias fig 12 right moreover iv a seasonal trend is evident in the bias of the raw hdm relative to sa as also observed in fig 8a relative to tg records whereas it disappears for the corrected hdm fig 14b the regions with a large bias require further examination and this was performed using the cyclemdt approach thus for the second approach of validation a comparison with cyclemdt see eq 14 of all available data sources the term cyclemdt is selected to make a contrast with mdt cyclemdt is the average of n cycles of instantaneous sa observations which is expected to be very close approximation to mdt fig 15 demonstrates cyclemdt along the three sa passes pass no 272 55 and 414 according to this figure a comparison of raw corrected hdm tg records and sa data reveals that i before examining the corrected hdm the tg records and sa profiles have mostly coincided whereas the raw hdm does not ii compared to raw hdm corrected hdm is more consistent in magnitude as well as spatial trend with sa profiles and tg records and iii the corrected hdm for pass no 414 located in the eastern section of the gulf of finland displays a more stable dt compared to sa results in this area indicate that utilizing sa data along with the geoid model i e nkg2015 leads to an unrealistic dt value that fluctuates widely this strongly suggests problems with the geoid model due to insufficient coverage of marine gravity data and validation in such locations ågren et al 2016 5 3 identifying areas of large discrepancy a comparison of point to point sa data and hdm for the entire baltic sea allows a broader overview for identifying problematic areas especially in the offshore areas fig 16 this figure shows a point to point difference between cyclemdt of the sa data and raw fig 16a or corrected nemo nordic model fig 16b this reveals possible inconsistencies between various data sources and also highlights regions with problems especially offshore in this study different datasets are used tg hdm sa geoid model and land uplift model each of which has its own uncertainty in different conditions and regions for instance the sa data may contain artificial bias even after applying geophysical and atmospheric corrections fig 16a top clearly demonstrates the differences between hdm and sa data with an average of 11 1 cm with the highest bias occurring in the northern and eastern sections of the baltic sea approx 30 0 cm the sa data confirm the corrected hdm with a bias of 0 1 cm however a large difference greater than 7 0 cm between the corrected model and sa data is noticeable in the gulf of finland as observed in fig 15 and pass no 414 the reasons for this bias requires further evaluation for future studies the centred root mean square error crmse of the hdm before and after correction are 2 2 and 2 4 cm respectively basically the spatial comparison of differences between hdm and sa results shows the method decreases the hdm bias by roughly 11 0 cm in the offshore area fig 16 also highlights problematic areas amongst the different sources of data for instance there is a high discrepancy between sa and hdm in both the raw and corrected models shown in black in the eastern part of the gulf of finland possibly because of the geoid model deficiencies nearshore contaminated sa data are mostly observed in the north and centre of the baltic sea 6 discussion the methodology employed in this study demonstrated that by utilizing a dense network of tg data that are referred to the geoid it is possible to correct the hdm bias both temporally and spatially applying this bias correction allowed computation of a corrected hdm whose sea level data are now referred to the geoid and thus more or less realistic both at the coast and in the offshore domain to evaluate whether the corrected hdm mdt results were reliable and accurate enough the validation using sa data played an essential role in assessing this especially in the offshore domain the method employed entailed initially identifying the temporal bias and then using this temporal bias along with three interpolation techniques to obtain the spatial bias in the hdm examination of the temporal bias hdm tg which considers data points mainly at the coast revealed a mean bias with a range of 5 3 to 15 9 cm that is the hdm tended to overestimate the results along the baltic sea coast fig 9 the largest bias values occur in the gulf of bothnia especially the western side and in some other localized areas that appear to be tg location dependent interestingly the correlation between hdm and tg was high in these areas i e 0 92 in addition the standard deviation of the temporal bias also revealed that in most tg locations a value that varied from 7 9 cm there were however a few tg locations with a standard deviation of 10 cm and these were located of at the easternmost section of the gulf of finland at the russian tg of kronstadt tg id 73 cf fig 3 and also in the estonian tg station in the gulf of riga at the ruhnu station tg id 14 cf fig 3 this higher standard deviation may indicate issues with the vertical datum at these stations these results however strongly suggest that the bias calculated between the hdm and tg consists of a combination of vertical reference issues between the hdm and tg in addition possible problems with tg perhaps corrections applied or location of tg and hdm modelling errors may be present as was observed in jahanmard et al 2021 most pertinent is that these results highlight spatially the critical areas locations that require further examination improvements both with the hdm and tg data to obtain the spatial bias three different interpolations methods were employed linear idw and tps and in general results of all methods displayed similar patterns especially in the southwestern baltic sea fig 10 as expected three methods provide a stable sdbias with standard deviation of less than 2 cm in the vast majority of areas fig 10b the idw method however displayed a more realistic trend than others fig 10 in jahanmard et al 2021 a linear interpolation method was utilized for the gulf of finland however this showed peakiness at the edges as was seen in the results of this study instead now for this study the idw method displays an improvement that can be applied the idw method can further be improved for it also showed some localized discrepancy that were most likely influenced by the problems with tg data fig 10 this is so for in this study the assumption was made of the tg data being the truth most realistic whilst this assumption seems to perform reasonably well the results have revealed that some tg may have some problems e g location not ideal corrections applied thus the interpolation methods applied should be applied with care and checks performed with other datasets on the validity of results in general the corrected hdm mdt showed an improvement compared to uncorrected mdt in that the high and low frequency biases e g difference between reference level seasonal bias etc are eliminated by this correction and the hdm is corrected on the scale factor of almost 1 5 in many parts of the bs whereby the uncorrected mdt tended to overestimate the results given that the original hdm at the location of stations and tg records are more or less highly correlated fig 9c it was to some degree expected that a comparison of the raw and corrected hdm would show similar patterns in general this was the case for most areas of the baltic sea showed similar patterns as calculated in other studies e g madsen et al 2019 however the western side of the gulf of bothnia showed an unexpected variation compared to the raw hdm with a difference of 5 cm from western to eastern side this displayed that correcting the model for the bias may also change the overall pattern of the mdt to access whether the corrected hdm results were accurate or reliable a validation was performed using the sentinel 3a along track satellite data this validation on whether the corrected hdm was accurate or realistic especially in the offshore areas was employed by comparing sa along track data with that of the raw and corrected hdm this comparison showed that the corrected hdm was more compatible with sa than the uncorrected hdm figs 14 15 with a bias of 0 1 cm for corrected now existing versus that of 11 1 cm for uncorrected hdm whilst the sa agreed better with corrected hdm the higher differences still existed in the gulf of finland region previous sa studies suggested that in the baltic sea a rmse of 4 7 cm can be expected rautiainen et al 2020 mostafavi et al 2021 thus to ascertain exactly what may be occurring in the gulf of finland requires further examination for it could be a combination of hdm errors sa and tg related problems further examination of the sa along track profiles in this region revealed possible problems in geoid modelling due to sparseness of gravity data that may have affected results fig 15 pass no 414 fig 16 in varbla et al 2020a this specific location was also found to have possible geoid modelling issues in this study we employed the use of sa for validation but it is possible for future studies to employ use of gnss applications varbla et al 2020a or airborne laser scanning can be employed varbla et al 2020b thus the applied methodology appears to perform reasonably well in deriving a more realistic mdt the method however can be improved for comparison with hdm and sa data identified several key areas that require further investigation such as gulf of finland that may be affected by tg sa hdm or geoid modelling issues this study assumed that tg as representative of the truth the results however have shown that some tg may not be ideally located e g installed at the mouth of rivers or that may have had wrongly applied corrections and this require further examination for obtaining tg data from different countries authorities with different protocol of measurements and instrumentation may also have errors that may be unknowingly introduced since the results of this study were highly dependent on the bias calculated it is essential that i tg data are consistent and accurate as can be and ii the computed bias needs to be valid in the offshore areas this study was possible due to the dense network of tg in the baltic sea and the agreement on employing the geoid based baltic sea chart datum hence it is expected that similar approach can be applied in other marine areas utilization of the geoid as a vertical datum allows more realistic dynamic topography calculations and it is also more compatible with other sources of data to some degree it is expected that deriving a corrected hdm may also lead to changes in the dynamics of the marine area e g salinity temperature circulation the focus of this study however has been on achieving a realistic sea level component that is comparable with other sources of data for future studies it is possible to examine in an iterative approach the corrected hdm results with other components of the hdm model e g currents salinity etc consequently the results of this study demonstrate progress toward the utilization of a more realistic dt that has a valuable contribution to marine engineering and climate studies 7 concluding remarks this study has demonstrated a methodology that allows derivation of realistic dynamic topography both in the coastal and offshore areas of the baltic sea this was possible by the synergizing of tide gauge hydrodynamic and satellite altimetry data with the geoid being the key component that linked the vertical reference datum amongst them in most areas of the baltic sea the trend of the corrected dt agreed reasonably well with the general dynamics of the study area and also that of other studies the annual mean dynamic topography of corrected hdm was improved by a factor of almost 1 5 for example 2019 the uncorrected mdt was 50 cm and after correction was 35 cm in the gulf of bothnia in such a busy and dynamic marine environment of the baltic sea realistic dt allows better application on quantification for marine engineering e g pipeline construction offshore infrastructure etc and climate studies application incidentally however the methodology allowed identification of i potential problematic areas and seasons of hdm models that requires improvement ii tide gauges that may not be reliable for various reasons e g location not ideal for representing the coastal environment or questionable corrections that may have been applied iii areas of satellite altimetry along track passes that may be challenging even after outlier removal and iv areas that geoid model were not adequately represented thus the methodology shows an advancement and improvement towards our understanding of the marine environment and also the data sources being utilized in addition the assimilation of observed sea levels from tide gauge satellite altimetry etc into a hydrodynamic model requires that the model refers to the same vertical reference datum as the observed sea levels hence this vertical reference unification between model and observations enables possibilities to have a more effective implementation of the data assimilation technique for modelled dynamic topography and enhances hdm performance the method however can be improved for the satellite altimetry to confirm particular questionable areas e g eastern part of the gulf of finland the validation in the offshore areas using satellite altimetry showed promising results thus in future studies the utilization of other sources of offshore sea level data such as gnss surveys and buoys and airborne laser scanners can also be explored in addition it is possible for future studies to use the results of the corrected hdm to improve on other data components of the hdm e g currents salinity etc in an iterative approach credit authorship contribution statement vahidreza jahanmard conceptualization methodology validation formal analysis writing original draft visualization nicole delpeche ellmann conceptualization validation supervision writing review editing project administration artu ellmann conceptualization validation supervision writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is supported by the estonian research council grants prg330 development of an iterative approach for near coast marine geoid modelling by using re tracked satellite altimetry in situ and modelled data and prg1129 the authors are extremely grateful to the swedish meteorological and hydrological institute smhi for providing access to the model data the baltic seal project team for granting access to the sentinel 3a dataset and tide gauge data providers the estonian environment agency eea finnish meteorological institute fmi latvian environment geology and meteorology centre lvgmcl institute of meteorology and water management imgw pib federal maritime and hydrographic agency bsh and smhi we are also thankful for the constructive comments made by the anonymous reviewers appendix see table a 1 
