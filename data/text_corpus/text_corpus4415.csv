index,text
22075,the increasing use of maritime transport has led to an increase in ship size however the dimensions of channels and harbours cannot follow the expansion rate of ships large ships will experience shallow water effects such as the bottom effect more severely which plays an important role in the manoeuvrability and the stability of ships to reduce navigational restriction in estuary environment and close to ports the world association for waterborne transport infrastructure pianc established the concept of the nautical bottom using this concept ships can navigate with both small and negative under keel clearance ukc relative to the water mud interface hence the aim of this work is to conduct a numerical investigation in order to study the influence of the muddy seabed on the ship s manoeuvrability especially on the ship s resistance and squat accordingly a 3d computational fluid dynamics cfd model based on the volume of fluid vof method was used to simulate the multiphase flow for various setups four parameters were tested the mud properties the ship s speed the mud thickness and the ukc value relative to the water mud interface the numerical results of this investigation were in reasonable agreement with experimental data through this investigation it was also shown the performances of the cfd method to simulate setups difficult to achieve in towing tank keywords mud layer cfd method ship resistance ship squat mud layer undulation free surface effect nomenclature α p volume fraction b ship s beam m cb ship s block coefficient fr froude number fri internal froude number h total depth m water mud hw water depth m hm mud thickness m k consistency factor kg s n 2 m loa ship s length over all m lpp ship s length between perpendiculars m n power law exponent t ship s draft m t time s p fluid pressure pa p fluctuation of the fluid pressure pa ukc under keel clearance m u fluid velocity vector m s u fluctuation of the fluid velocity vector m s vs ship speed m s η dynamic viscosity pa s ρ w water density kg m3 ρ m mud density kg m3 γ shear rate 1 s γ c critical shear rate 1 s τ shear stress pa τ 0 yield stress pa 1 introduction any ship navigating through confined and shallow waters is strongly affected by hydrodynamic effects as opposed to in open seas fig 1 major effects of the limited navigating width and water depth h are the squat effect and the increase in the ship s resistance water in front of the bow is pushed away and flows down to the sides and under the hull of the ship with an increased velocity see fig 2 due to the reduced section according to bernoulli s principle increasing velocity under the hull indicates a vertical pressure drop and consequently the ship s sinkage increases in addition the ship generally trims forward or aft as the bow or stern may experience more or less pressure drop depending on the ship type the effects of sinkage and trim are known as the ship s squat this has a significant influence on the ship s resistance and can lead to serious safety issues such as grounding loss of steering or collision in estuaries the presence of the mud layer can significantly modify the ship s behaviour especially when the ship is navigating in negative ukc relative to the mud water interface note that the concept of the nautical bottom was established by the pianc marcom working group 30 in their 2014 report this concept enables ships with larger drafts whose physical properties do not exceed the critical limit whereby contact with the ship s keel causes damage or unacceptable effects on controllability and manoeuvrability to navigate in the mud layer the same report also noted that it is difficult to give the critical limit value hence different density limits were set for different ports that said a critical limit was still provided based only on the mud density where the nautical bottom is the level from where the mud density is more than 1200 kg m3 the viscosity of the mud could not be used as a parameter to define the nautical bottom because it changes under shear rates change in some ports such as the port of emden germany the critical limit is given as a yield point that has been fixed to 100 pa wurpts 2005 using this criterion it was observed that the corresponding bottom density approximately 1300 kg m3 considerably exceeded the limit given by pianc in the gironde estuary the squat is an essential parameter for the traffic management of ships where the water level in the estuary depends on the tide accordingly to accommodate larger ships it is necessary to wait until the tide is high ships have to sail at the same speed as the propagation of the tide wave which is in the order of 10 kn however this is not always the case because in some situations ships can no longer keep up with the speed of the tidal wave for various reasons mainly related to the significant increase in the ship s resistance caused by the ship s squat in the mud which slows its speed considerably in other situations ships are equipped with a power limiter that stops the operation of the propulsive system if the ship meets a strong resistance in such a situation ships will be moored to wait for the next tide to manage the estuarine network better and to ensure safe navigation it is thus essential to study the phenomenon of ship s resistance its origins and any consequences for navigation to predict a ship s squat several empirical formulas have previously been proposed barrass and derrett 1999 concluded some important factors of the squat effect as follows the main factor is the ship speed relative to the water and the squat is approximately proportional to the square of this velocity the decrease of water depth will increase the ship s squat the block coefficient of the ship that is the ratio of the ship s underwater volume to the volume of box surrounding it is proportional to the squat similarly the blockage factor a ratio of the ship s immersed cross section to that of the canal has a direct impact on the squat over time numerical efforts have been focused on estimating ship s resistance and squat the slender body method assumes that a ship s beam free surface wave amplitude and water depth are small compared to its length this allows the simplification of the flow simulation in two dimensions using the slender body theory gourlay 2008 tuck 1964 to take into account the dynamic coupling of a ship s motion with flow the potential flow theory can be applied which only assumes the flow to be irrotational this has been widely used for squat prediction and very good results have been obtained debaillon 2010 ma et al 2016 sergent et al 2015 whereas it is difficult to apply the potential flow model to resistance prediction because it neglects the viscous stresses crucial for evaluating the ship s resistance modern cfd techniques based on solving the fully viscous navier stokes equations have been extensively applied to ship hydrodynamics with fruitful results as they consider the important features of the actual flow such as viscous effects and turbulence hence they are more reliable for predicting ship s resistance and motions stern 2013 summarised the achievements made regarding ship hydrodynamics using cfd in the last decade further recent progress in modern computational ship hydrodynamics with respect to shallow and confined water has been made eloot et al 2015 performed a turning circle and a zigzag test on a kvlcc2 hull model to determine the manoeuvring performance in a shallow water zone to study the scale effect tezdogan et al 2016 performed unsteady reynolds averaged navier stokes rans simulations at full scale for the squat in shallow water with star ccm commercial software they compared the results to the 3d potential flow theory and the experimental data of mucha et al 2014 they reported an underestimation of the ship squat and pointed indicated that the ship s resistance is sensitive to sinkage linde et al 2016 validated this observation with fluent by simulating the ship s resistance both with and without consideration of ship sinkage the predicted value of resistance with sinkage was closer to the experimental data kaidi et al 2017 further studied the ship manoeuvring with fluent under the effect of bank propeller hull interaction in shallow water in ports flow stratification might occur as the non saline light river water flows into the colder and heavier saline seawater leading to large horizontal or vertical fluid density variations highly density stratified waters are known to pose particular challenges to navigating ships when a ship s keel bottom is travelling just above the interface of the water layers the ship experiences large wave resistance this resistance occurs particularly if the ship is travelling close to the speed of the fastest internal waves due to the generation of large internal waves this phenomenon known as dead water affects the ability of ships to move through stratified water accurately assessing the effects of stratified flow on ship navigation requires a detailed knowledge of the flow field including turbulent mixing and in particular the generation of internal waves on the interface between the two layers of water zhao et al 2006 crapper 1967 and hudimac 1961 presented analytical approaches to study the internal wave modes caused by a moving body in a two layered ocean it follows from their work that just as for surface waves at ship speeds sufficiently larger than the internal wave speed only divergent waves travel downstream from the ship while both divergent and transverse waves are present for slower ships tulin et al 2000 suggested a nonlinear theory to capture internal wave behaviour at high froude number fr in weakly stratified flow which compared satisfactorily with available experimental results for a semi submerged spheroid delefortrie et al 2004 delefortrie and vantorre 2005 conducted a large number of experiments on towing tanks they studied the mud layer effect on the ship manoeuvring by considering several parameters they also developed a mathematical model to take into account the mud effect alchang et al 2006 presented one of the few available examples of the use of cfd for a ship in a stratified medium esmaeilpour et al 2016 studied the evolution of the stratified flow in the near field of a surface ship in detail they demonstrated that the generation of internal waves requires energy which results in an increase in resistance in this paper we present an overview of a numerical study of the mud layer effect on ship s resistance and sinkage by using a multi phased cfd method note that the mud is supposed stratified hence the water and the mud were modelled as separate layers with average values of density and viscosity the main objective of this work is to test the ability of the cfd method to simulate and assess the influence of the mud on the hydrodynamic forces acting on the ship s hull four parameters were tested the mud properties the ship speed vs the mud thickness and the ukc a preliminary study was conducted to first show the influence of the non newtonian behaviour of mud on the ship s resistance and the internal waves at the mud water interface based on this preliminary study the newtonian model was selected for this investigation the ukc level was referenced to the water mud interface hence it can take both positive and negative values the limits of the cfd method are discussed in section 5 2 mathematical formulation and numerical methods the fluid flow is governed by the incompressible viscous navier stokes equations completed with the continuity equation as follows 1 u 0 2 u t u u 1 ρ p η ρ ² u where u and p represent the velocity vector and pressure respectively and ρ and ν are the fluid properties of density and kinematic viscosity 2 1 turbulence modelling to model the turbulence effect the reynolds averaging was computed on the flow variable in time which gave rise to 3 u 0 4 u t u u 1 ρ p η ρ 2 u u u where u u u and p p p the last term in the rans momentum equation is the reynolds stress which is often approximated by turbulence models in this research we employed the sst k ω turbulence model which is actually a combination of the k ω and k ε models while a shifting function is used to switch one from another 2 2 multiphase approach the volume of fluid vof method was used to simulate three phase interactions the interface of air water and water mud using this approach both interfaces can be captured in a fixed grid by solving the continuity equation of the volume fraction eq 5 as follows 5 α p t u α p 0 p 1 2 α p denotes the volume fraction of the pth fluid and 6 p 1 n α p 1 n 2 or 3 equations presented thus far eqs 1 6 are solved using the commercial code ansys fluent 13 0 based on the finite volume method the pressure velocity coupling was ensured by using a steady pressure based coupled algorithm and the interpolation method selected to compute the cell face pressure was the pressure staggering option presto the second order was set for the vof s special discretisation 2 3 non newtonian behaviour law for mud it should be noted that mud behaviour is often considered non newtonian which means the viscosity depends on the shear rate hence the herschel bulkley model was selected to reproduce this behaviour the herschel bulkley model is represented by the following equations 7 τ τ 0 k γ n i f τ τ 0 8 τ 0 i f τ τ 0 where τ and τ 0 are shear and yield stress respectively k is the consistency factor n is the power law exponent and γ is the shear rate the non newtonian viscosity η is computed using one of the following formulas 9 η τ 0 γ k γ n 1 f o r γ γ c 10 η τ 0 2 γ γ c γ k γ c n 1 2 n n 1 γ γ c f o r γ γ c γ c is the critical shear rate fig 3 shows the variation of the shear stress with shear rate according to the herschel bulkley model 2 4 verification and validation of the cfd model the procedures for verification and validation of the cfd model have been discussed and performed in several previous works kaidi et al 2017 2018a b razgallah et al 2018 ali et al 2018 and were carried out in accordance with the ittc recommendations verification consisted of tests and analysis of the results of several mesh qualities whilst validation was performed by taking the numerical results of the ship s resistance the profile of generated waves and the ship s squat and comparing them to the measurements carried out in a towing tank of the university of liège and the central school of nantes note that no mud layer was considered in these works only the water air interface was modelled and validated based on the obtained results it was concluded that the cfd model provided a good estimate of the hydrodynamic forces around the ship s hull and correctly captured the air water interface it was also concluded that the cfd model could simulate the sediment suspension and transport accurately kaidi et al 2018a b 3 studied ship channel configuration boundary conditions and mud properties to conduct this investigation we used a container cargo hull form see fig 4 this kind of ship was selected because it is one of the most common ships to sail in the gironde estuary table 1 provides the main characteristics of the hull where lpp is the length between perpendicular loa is the length over all b is the ship beam t is the ship draft and cb is the block coefficient note that the same reference frame is used in this investigation the origin of this reference is fixed on the ship where the x 0 corresponds to the ship s bow plane while the z 0 corresponds to the ship s keel plane the x axis is oriented right while the z axis is oriented up as is shown in fig 4 in the present study we considered only the confinement effect using the ukc to prevent large body motions the reference frame was fixed on the ship hence the fluid and other parts moved relative to the hull the computational domain was chosen with a rectangular section large enough such that there was little influence of the position of the inlet and outlet 1 2 lpp for the inlet and 3 5 lpp for the outlet are recommended by ittc ittc 2011 half of the computational domain was used to reduce computational time for the boundary conditions at the inlet the flow velocity was imposed and at the outlet the outflow condition was used a symmetrical condition was applied at the top at the mid plane and at the side boundaries at atmosphere total pressure was applied at the bottom moving wall condition was employed to take into account the relative motion and at the hull s surface no slip wall condition was used four combinations of mud properties were selected to conduct this investigation these properties represent the average values measured at different zones in the gironde estuary and some ports table 2 presents the combination of the density and viscosity of the mud 4 results and discussion 4 1 comparison between the newtonian and non newtonian models the effect of the use of non newtonian viscosity to simulate the mud behaviour is discussed in this section using the cfd method the mud layer could be modelled in different ways the first was to suppose that the mud properties were constant and slightly influenced by the shear stress induced by the ship s passage hence we used average values for the density and the viscosity the second was to consider that the mud was significantly affected by the shear stress from where a non newtonian model was used to estimate the dynamic viscosity it should be highlighted that in the estuary environment the flow was modelled using hydraulic models which estimate the average turbulent viscosity at the channel bottom that can be used by manoeuvring simulators this provides indispensable results for assessing the difference between the results obtained by both approaches to carry out this study the ship s draft was set to 10 m 0 125 m in the model and the ship s speed was set to 10 kn 0 575 m s the mud thickness used was 3 m in full scale 0 0375 m in the scaled model which corresponds to the average thickness in the estuaries the ukc value was set to 10 t with respect to the mud water interface which corresponded in our case to 1 m in full scale 0 0125 m in the scaled model figs 5 and 6 present a comparison between the undulations of the mud water interface obtained using both methods for mud types a and c at two different plans see fig 7 the first plane is located at y b of 0 621 while the second is located at y b 1 243 where y is the lateral distance from the ship s mid plan and b is the ship s beam the x axis of these figures represented the dimensionless distance x lpp where x is the longitudinal distance from the ship s bow and lpp is the length of the ship and the z axis represented the undulation elevation generally we remark that the non newtonian model tends to underestimate the mud layer crests as is evident the difference between both models shows that mud a has a smaller viscosity and density compared to mud c the height difference at the crest and trough is almost similar approximately 11 at plane 1 and 18 at plane 2 for mud a and approximately 16 at plane 1 and 30 at plane 2 for mud c the difference is larger at plane 2 because the area affected by the ship s passage is reduced when the mud is considered non newtonian especially at high density and viscosity as shown in fig 7 to assess the ship s resistance two ukcs were tested 10 and 10 for the two types of mud the difference between the newtonian and non newtonian models was small as presented in table 3 approximately 2 for both mud a and mud c at positive ukc and less than 5 at negative ukc note that the verification and validation procedure shows that the uncertainty of the total resistance was about 7 in very confined water this uncertainty corresponds to a monotonic convergence condition with an order of accuracy of 1 86 based on these values the only conclusion that can be drawn from this comparative analysis is that the newtonian model gives an acceptable estimation of the ship s resistance despite the overestimation of the mud water undulation hence the newtonian model can be used to carry out this investigation 4 2 influence of mud properties on seabed undulation and free surface attenuation here the mud layer thickness was set to 3 m 0 0375 m in the scaled model the ship s draft and speed were set to 10 m 0 125 m in the scaled model and 10 kn 0 575 m s in the scaled model respectively the value chosen for the ukc with respect to the mud water interface was 10 t fig 8 illustrates the profile of the mud layer deformation caused by the ship s passage as can be seen the deformation is composed of a principal undulation and secondary undulations the principal undulation is similar to the free surface deformation with a small shift where a stern divergent wave is observed fig 9 the divergence angle the wave height and the wavelength of this wave depend on the mud properties as shown in fig 10 in this study we only focused on the principal undulation which had an impact on the ship manoeuvring principally on the ship s resistance and squat this undulation was characterised by a maximum trough and crest where generally the trough is located at the mid hull whilst the crest is located at the hull s stern for all tested mud properties the mud layer trough started from the same position the ship s bow however compared to the initial mud setup the trough level and length increased by decreasing the mud viscosity we note that the origin of this trough was principally the pressure variation along the ship hull caused by the return flow which was influenced by the mud properties see fig 11 from the same figure it can be seen that the relative increase of the mud trough shows a linear variation for viscosities varying between 0 025 and 0 12 pa s it can also be observed that the physical properties of the mud played an important role on the mud crest the location of this crest and in some situations the hull mud contact area when the density and viscosity of the mud were smaller the mud was considered more fluid hence the later behaved as a denser fluid and followed the water flow when the viscosity of the mud was greater the mud layer was more solid and its behaviour was more rigid from this we noted a maximum uprising value for the mud d 20 less than for mud b whilst an insignificant variation was noted between mud samples b and a for all tested properties the mud uprising position varied as the mud properties varied from simulated cases it was noted that the lower the viscosity the more the mud uprising moved backwards the same observations were also noted by delefortrie and vantorre 2005 contact between the hull and the mud was also observed for mud a and b and the contact area was slightly larger in the case of mud a to assess the separate effect of the viscosity and the density on the internal waves pattern an additional series of simulations were performed for a better visibility of this undulation the mud thickness of 3 m in full scale was used 1 m corresponds to the ukc and 2 m to the distance between the ship s keel and the solid seabed for a negative ukc of 10 t five values of viscosity and density were tested the ship s speed was set to 10 kn as in the previous simulations first the viscosity was varied as follows 0 005 0 01 0 05 0 1 0 2 pa s while the density of the mud was set to 1100 k m3 and second the viscosity of the mud was set to 0 1 pa s which corresponds approximately to the transition limit defined by delefortrie 2016 basing on experiments while the density was varied as following 1050 1100 1150 1200 and 1250 kg m3 the internal waves corresponding to the viscosity and the density variation were plotted in fig 12 as it can be seen at the left of this figure the viscosity has a very important influence on the internal waves pattern and for the used ship s speed the internal bow waves length is longer than the ship s length which is a characteristic of shallow water navigation for the smallest viscosity a stern waves pattern was observed where the first is convergent while the second is divergent which resembles to the free surface behaviour in a shallow water reflected waves were also observed far behind the ship s stern by increasing the viscosity value to 0 01 pa s the same waves pattern were observed however transverses waves appeared behind the ship s stern for viscosity value of 0 05 pa s the waves pattern becomes more apparent while the angle of the diverging waves increases and tends to be perpendicular to the ship s heading direction the same observations were noted for the viscosity value of 0 1 pa s the converging waves remains unchanged and apparent whereas the diverging waves becomes completely transversal and slightly less apparent for the highest mud viscosity 0 2 pa s only the transverses waves pattern were affected and becomes even less apparent and tend to disappear this behaviour is in accordance with experimental findings however viscosity limits defining waves patterns were slightly different the density variation effect on the internal waves pattern is shown at the right of fig 12 the only observation noted from this figure is that the density has any effect on the transverses waves while the converging waves increase slowly by increasing the mud density basing on these results it can be concluded that the internal froude number f r i f n i f n ρ w ρ m δ ρ often used to describe multiphasic flow cannot be used to define the internal waves patterns it can also be concluded that the internal waves pattern evolution should be set as a function of mud viscosity and mud layer thickness fig 13 shows the free surface attenuation caused by the mud layer for this we compared the free surface deformation of a channel with a muddy layer to the free surface deformation of a channel without a muddy layer rigid bottom the same total depth was maintained for both tests note that for the present study the total depth of the channel is the sum of the ship s draft the ukc and the mud thickness it may be observed that the free surface elevations closely resemble the mud layer undulation it was also observed that the trough and crest of the free surface was approximately the same between the rigid seabed and mud samples a b and c however for mud d we noted a lowering of the free surface this lowering was essentially caused by the effect of shallow water as mentioned above the higher the viscosity the more solid the mud hence the seabed can be considered solid the shear stress due to the high viscosity of the mud slowed down the flow velocity of the mud water interface under the ship s hull inducing an acceleration of the water flow and consequently a pressure drop 4 3 ship s speed and mud thickness effect on the seabed undulation internal waves pattern the study of the influence of the ship s speed and the mud s thickness on the seabed undulation is presented in this section the influence of the ship s speed was performed by setting the mud layer thickness to 3 m in full scale and the ukc to 10 t mud a was selected for this simulation the ship speeds that were tested were 6 8 and 10 kn in full scale 0 345 0 46 and 0 575 m s in the scaled model it can be seen from fig 14 that for the selected mud the ship s speed has an influence on the position of the maximum rise of the undulation the higher the speed the more the undulation crest moved backwards it was also seen that the crest width increased as the ship s speed increased this behaviour was due first to the mud type here the mud density was small and it was thus was more fluid than solid second the return current amplification caused by the increase in the ship s speed affected the behaviour a slight influence of the ship s speed on the trough depth and the crest height of the mud water interface undulation was noted in the second part of this section the influence of the mud thickness on the internal waves pattern was studied three thicknesses of the mud a were tested 1 m 2 m and 3 m in full scale note that the mud thickness effect on the internal waves patterns can be tested using a constant ukc 10 t and variable total depth as is depicted in fig 15 a or using a variable ukc 10 t 0 t and 10 t and constant total depth as is depicted in fig 15 b the ship s speed was set to 10 kn 0 575 m s in the scaled model the frh values were the same for both type of test 1 64 1 16 and 0 94 using the mud thickness as a characteristic length for mud thickness of 1 m 2 m and 3 m respectively these values correspond to critical and supercritical regimes the numerical results of the waves patterns were shown in fig 16 fig 16 a shows the influence of the mud thickness on the internal waves patterns for a constant ukc and variable total depth from this figure it can be shown three different waves patterns of the seabed where for the smaller mud thickness 1 m in full scale the internal waves appear behind the ship s stern and its pattern is very divergent and nearly transversal to the ship s heading direction for the medium thickness 2 m in full scale the undulation is principally transversal however a small kelvin pattern appears at the ship s stern which leads us to consider this thickness as a transition thickness for the larger mud thickness 3 m in full scale the internal waves have a kelvin pattern form these patterns were also noted in the experimental work done by delefortrie 2016 see fig 17 the authors of this work related these patterns only to the mud viscosity and the ship s speed according to their findings the kelvin pattern appeared for larger ship s speed and lower viscosities 0 12 pa s and the transversal pattern appeared in the case of lower ship s speed it was also noted that the transversal pattern were observed for larger ship s speed and larger mud viscosities 0 12 pa s in the present work the both undulation patterns transversal and kelvin pattern were observed by varying only the mud thickness where the ship s speed can be considered larger however the mud viscosity is lower 0 025 pa s to separate the effect of the mud thickness and the effect of the confinement the total depth was considered constant and the mud thickness was varied the obtained results were depicted in fig 16 b the simulation setup for the smaller mud thickness 1 m in full scale is the same as in the case of variable total depth hence the results of the previous simulation were kept for the medium mud thickness 2 m in full scale the ukc is 0 t the similar wave pattern as for the mud thickness of 1 m was observed however the undulation amplitude was amplified for larger mud thickness ukc 10 t the waves change pattern and convergent and divergent waves appear transversal waves were also observed far behind the ship from these observations it can be concluded that the mud thickness has a significant influence on the internal waves pattern which change as a function of the total depth and the ukc however it is difficult to specify exactly the influence of the mud thickness in fact the mud thickness effect is always coupled with another parameter either the total depth or the ukc from this study it can also be concluded that the internal waves pattern are independent of the frh contrary to the generated waves pattern at the water air interface basing on the results obtained in this section the pattern of internal waves are not only depends on the mud viscosity and ship s speed as is given in the literature but by the combined effect of the viscosity the ship s speed the mud thickness the water depth and the ukc 4 4 ship s resistance variation due to mud properties ship s speed and mud thickness it is known that ship s resistance is greatly affected by channel configuration such as confinement and restrictions in shallow water the ship s resistance increases significantly due to the accelerated water around the hull as explained previously the presence of the mud layer in turn affects the flow under the ship s hull inducing a variation in the ship s resistance the effect of the latter can be considerably amplified if the ukc is negative in this section findings are presented from studying the impact of the mud layer first by testing the mud properties effect for a given mud thickness 3 m in full scale hence the four mud properties were tested for an ukc of 10 t with respect to the mud water interface the ship s speed was set to 10 kn 0 575 m s no squat was considered in these simulations fig 18 shows the ship s resistance variation caused by variations in the mud properties from this figure it is evident that the ship s resistance increased with mud viscosity although there was no contact between the hull and the mud with mud samples c and d this leads us to conclude that this increase essentially concerns the frictional component of the resistance in fact when the mud is consolidated it seems as though the total depth of the water is reduced which makes the navigation environment more confined and consequently the return current velocity increases to understand better the confinement phenomenon due to the mud layer and its influence on the ship s resistance we carried out simulations by varying the mud thickness three thicknesses were tested 1 m 2 m and 3 m in full scale for each thickness we used two speeds 6 and 10 kn and two types of mud mud a and mud c the water depth remains unchanged for all simulations 10 m in full scale first a positive ukc of 10 t was considered the results of these simulations were shown in fig 19 from these figures it can be seen that the ship s resistance increases with increasing ship s speed however this increase is different according to the mud layer thickness as well as the type of the mud in fact by decreasing the mud layer thickness the ship s resistance increases considerably this increase concerns both types of forces pressure and friction however the wave making resistance remains the most dominant and the most impacted by this decrease in thickness the wave making resistance is amplified about 9 times when the ship is sailing at a speed of 10 kn on a mud thickness of 1 m than 3 m and about 4 times when the ship s speed is 6 kn while the amplification of the friction resistance is of the order of 2 times for the two ship s speeds it was also observed that the wave making resistance was the most dominant compared to the friction resistance except in the case of the largest thickness 3 m where both types of forces were approximately in the same range note that for navigation in channels with solid seabed the confinement is often defined by the ratio of water depth to ship s draft hw t this ratio is an essential element for the calculation of the ship s resistance in the case of navigation in turbid water with a muddy bottom this ratio may be valid however the definition of the depth hw must be modified by including the thickness of the mud layer a proposal has already been made by delefortrie 2016 proposing the use of the hydraulic depth h given by the following formula 11 h h w h m where is the fluidization parameter which represents the mud type so far all works studying the influence of the mud quality on the ship s resistance were performed by varying both values of viscosity and density in order to distinguish the influence of each physical property we varied separately the viscosity and the density of the mud the same process as in the sub section 4 3 was used first the density is fixed at 1100 kg m and the viscosity is varied then the viscosity is fixed at 0 1 pa s and the density is varied for a better presentation of the influence of these properties on the ship s resistance we considered the highest speed of navigation 10 kn and assume that the ship s ukc is 10 t three mud layer thicknesses were tested 2 m 3 m and 4 m corresponding to a distance between the ship s keel and the solid seabed of 1 m 2 m and 3 m as is presented in fig 20 the computed ship s resistances as a function of the mud viscosity and density were presented in fig 21 by its two components wave making and friction basing on these results it was noted that for smaller and medium mud thicknesses the wave making resistance is dominant compared to the friction resistance however for the larger mud thickness the friction resistance is dominant this behaviour is physical because it depends on the depth froude number where for high values of depth froude number the wave making resistance is dominant while the friction resistance is dominant for very lower values by analyzing the numerical results of the ship s resistance under the variation of the viscosity it can be seen that the effect of the later begins to be visible when the viscosity is more than 0 01 pa s in smaller and medium mud thicknesses for the larger mud thickness the effect is visible only when the viscosity of the mud is greater than 0 05 pa s it can also be seen that despite the dominance of the wave making resistance its variation at a given mud thickness is insignificant compared to the variation of the friction resistance where the maximum variation of the wave making resistance is about 30 computed between the largest and the smallest value of the viscosity at the larger mud thickness while the friction resistance was amplified by 2 8 1 9 and 1 3 times at smaller medium and larger mud thickness respectively these behaviour is completely realistic for both types of resistances the friction resistance depends principally on the shear stress on the ship s hull which increases with confinement however the wave making resistance depends on the length and the amplitude of the generated waves which are important when the mud thickness is larger see fig 16 through fig 21 b it can be noted that the effect of the density on the ship s resistance is unimportant for the tested thicknesses the wave making resistance variation is insignificant at a given mud thickness whereas the friction resistance is slightly affected by mud density where an increase of 23 was computed between the largest and smallest density at the larger mud thickness this insensitivity to density is related on one side to the non variation of the generated waves as is illustrated in fig 12 and on the other hand to the phenomenon of fluidization of the interface of the mud layer caused by the ship passage especially at high speed this point will be discussed in the next paragraph the second part of this section presents the results for the ship s resistance studied as a function of the ukc mud a was used for 6 values of ukc as follows 10 5 0 5 10 and 15 of the ship s draft the ship s draft here was 10 m the mud thickness was 3 m and the speed of the ship was 10 kn from fig 22 we observe an increase of the total resistance with the decrease of the ukc the pressure resistance dominates for ukc varying between 10 and 5 t less than that the frictional force dominates considerably we also observe that ship s resistance increase is very slight for ukc values between 5 and 5 and less than 10 the ship s resistance increase is significant only between 10 and 5 and between 5 and 10 by analysing fig 23 a plotting the area of contact between the hull and the mud we note that for ukc range of 10 5 the contact area is almost the same and the total resistance increase is principally due to the shallow water effect for the ukc range 5 10 the resistance increase is principally due to the hull mud contact as is shown in fig 22 the frictional resistance dominates while the pressure resistance increases slightly it can also be observed from fig 23 a that when the ship is sailing inside the mud layer negative ukc the keel of the hull is not fully covered by the mud this is one of the relevant phenomena observed in this work in fact when the ship is sailing in the mud we observe two different behaviours when the ship s speed is low the ship s keel is fully covered by the mud however when the ship s speed increases the top boundary of the mud layer tends to be more liquefied especially at the ship s bow and a film of very liquefied mud or turbid water is created between the mud and the hull fig 23 b shows the evolution of the hull mud contact area as a function of the ship s speed to illustrate bitter the contact area the legend of this figure was limited to a volume of fraction of 0 8 4 5 effect of the muddy seabed on the ship s squat one of the aims of this work was the numerical study of the influence of the muddy layer on the ship s squat sinkage and trim the fluid structure interaction is treated by a modified newton algorithm coupled to a steady rans linde et al 2016 the standard dynamic newton algorithm was not used because of several numerical complications encountered the origin of these complications is essentially the bad estimation of the added mass due to the high blockage coefficient which considerably affects the stability and convergence of the numerical solution because of the large computation time only one mud layer thickness was considered 2 m for an ukc of 10 t the effect of the mud properties on the squat was simulated for the four types of mud and for three ship speeds 6 8 and 10 kn which correspond to a froude depth number frh of 0 297 0 396 and 0 495 respectively the ship s sinkage as a function of the mud type was plotted in fig 24 and compared to the experimental and numerical sinkage for a rigid bottom concerning the ship s sinkage similar observations given by delefortrie 2016 were noted first we observed that the sinkage obtained numerically for a rigid seabed was in accordance with measurements we also observed that the sinkage increased by increasing the ship s speed in all configurations with or without the mud layer however the sinkage values decreased slightly with the change in mud properties for larger viscosities mud c and mud d we observed an insignificant decrease whilst a moderate decrease was observed for mud a and mud b this decrease augmented in turn with the increase in the ship s speed in fact this increase was due to the added buoyancy generated by the contact between the hull and the mud this contact as mentioned previously was located at the ship s stern when the undulation crest was larger as for mud a and mud b the ship s trim was plotted in fig 25 for the selected ukc the trim has positive values which correspond to a trim by the stern the plotted results show that the numerical results are in the same range as measurements without mud it can also be seen that the mud had an insignificant effect on the trim at low ship speed 6 kn in the case of mud b c and d except in the case of the mud a a significant deviation compared to the rigid bottom case was observed for a ship speed of 10 kn this deviation decreased due to the mud hull contact located at the stern of the ship which created an asymmetry in the ship s buoyancy however the trim behaved differently in the case of mud d where the trim deviation compared to the rigid bottom case increased with the ship s speed this increase can be explained by the confinement that this type of mud generates note that some of these observations are not in agreement with observations made by delefortrie 2016 based on measurements carried out in the towing tank for manoeuvres in confined water at flanders hydraulics research antwerp in co operation with ghent university 5 conclusions in this paper an overview of a numerical investigations on the impact of muddy seabed on a ship s resistance and squat was presented a multi phase cfd model was used to estimate the ship s resistance and squat as a function of several parameters different configurations based on observations noted in the present work it was concluded the following the obtained numerical results are in agreement with physical models results the internal waves crests depend strongly on the mud properties the internal waves patterns depend strongly on several parameters the viscosity the total depth the ukc and the thickness of the mud layer and the frh is not suitable to characterize the wave patterns the internal waves influence the ship s resistance and squat especially when the ukc is negative the effect of the mud layer on the ship s sinkage is significant only when the ukc is negative the effect of the mud on the ship s resistance can be felt even when the ukc is positive and this depends on the mud properties the ship s speed tends to move the mud water interface undulation in the backwards the ability of the cfd method to simulate multiphasic flow and interaction between the fluid flow and the structure has been demonstrated some difficulties were encountered in the modelling of the depth dependent density and viscosity of the mud some difficulties were also encountered in the simulation of the dynamic ship squat especially when the mud contacted the ship s hull an improvement can be made in future works by integrating a new numerical algorithm that stabilises calculations and takes into account the real vertical profile of the density credit authorship contribution statement sami kaidi writing original draft emmanuel lefrançois investigation hassan smaoui writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work presented in this paper was performed within the project gironde xl funded by le grand port maritime de bordeaux france and the european commission 
22075,the increasing use of maritime transport has led to an increase in ship size however the dimensions of channels and harbours cannot follow the expansion rate of ships large ships will experience shallow water effects such as the bottom effect more severely which plays an important role in the manoeuvrability and the stability of ships to reduce navigational restriction in estuary environment and close to ports the world association for waterborne transport infrastructure pianc established the concept of the nautical bottom using this concept ships can navigate with both small and negative under keel clearance ukc relative to the water mud interface hence the aim of this work is to conduct a numerical investigation in order to study the influence of the muddy seabed on the ship s manoeuvrability especially on the ship s resistance and squat accordingly a 3d computational fluid dynamics cfd model based on the volume of fluid vof method was used to simulate the multiphase flow for various setups four parameters were tested the mud properties the ship s speed the mud thickness and the ukc value relative to the water mud interface the numerical results of this investigation were in reasonable agreement with experimental data through this investigation it was also shown the performances of the cfd method to simulate setups difficult to achieve in towing tank keywords mud layer cfd method ship resistance ship squat mud layer undulation free surface effect nomenclature α p volume fraction b ship s beam m cb ship s block coefficient fr froude number fri internal froude number h total depth m water mud hw water depth m hm mud thickness m k consistency factor kg s n 2 m loa ship s length over all m lpp ship s length between perpendiculars m n power law exponent t ship s draft m t time s p fluid pressure pa p fluctuation of the fluid pressure pa ukc under keel clearance m u fluid velocity vector m s u fluctuation of the fluid velocity vector m s vs ship speed m s η dynamic viscosity pa s ρ w water density kg m3 ρ m mud density kg m3 γ shear rate 1 s γ c critical shear rate 1 s τ shear stress pa τ 0 yield stress pa 1 introduction any ship navigating through confined and shallow waters is strongly affected by hydrodynamic effects as opposed to in open seas fig 1 major effects of the limited navigating width and water depth h are the squat effect and the increase in the ship s resistance water in front of the bow is pushed away and flows down to the sides and under the hull of the ship with an increased velocity see fig 2 due to the reduced section according to bernoulli s principle increasing velocity under the hull indicates a vertical pressure drop and consequently the ship s sinkage increases in addition the ship generally trims forward or aft as the bow or stern may experience more or less pressure drop depending on the ship type the effects of sinkage and trim are known as the ship s squat this has a significant influence on the ship s resistance and can lead to serious safety issues such as grounding loss of steering or collision in estuaries the presence of the mud layer can significantly modify the ship s behaviour especially when the ship is navigating in negative ukc relative to the mud water interface note that the concept of the nautical bottom was established by the pianc marcom working group 30 in their 2014 report this concept enables ships with larger drafts whose physical properties do not exceed the critical limit whereby contact with the ship s keel causes damage or unacceptable effects on controllability and manoeuvrability to navigate in the mud layer the same report also noted that it is difficult to give the critical limit value hence different density limits were set for different ports that said a critical limit was still provided based only on the mud density where the nautical bottom is the level from where the mud density is more than 1200 kg m3 the viscosity of the mud could not be used as a parameter to define the nautical bottom because it changes under shear rates change in some ports such as the port of emden germany the critical limit is given as a yield point that has been fixed to 100 pa wurpts 2005 using this criterion it was observed that the corresponding bottom density approximately 1300 kg m3 considerably exceeded the limit given by pianc in the gironde estuary the squat is an essential parameter for the traffic management of ships where the water level in the estuary depends on the tide accordingly to accommodate larger ships it is necessary to wait until the tide is high ships have to sail at the same speed as the propagation of the tide wave which is in the order of 10 kn however this is not always the case because in some situations ships can no longer keep up with the speed of the tidal wave for various reasons mainly related to the significant increase in the ship s resistance caused by the ship s squat in the mud which slows its speed considerably in other situations ships are equipped with a power limiter that stops the operation of the propulsive system if the ship meets a strong resistance in such a situation ships will be moored to wait for the next tide to manage the estuarine network better and to ensure safe navigation it is thus essential to study the phenomenon of ship s resistance its origins and any consequences for navigation to predict a ship s squat several empirical formulas have previously been proposed barrass and derrett 1999 concluded some important factors of the squat effect as follows the main factor is the ship speed relative to the water and the squat is approximately proportional to the square of this velocity the decrease of water depth will increase the ship s squat the block coefficient of the ship that is the ratio of the ship s underwater volume to the volume of box surrounding it is proportional to the squat similarly the blockage factor a ratio of the ship s immersed cross section to that of the canal has a direct impact on the squat over time numerical efforts have been focused on estimating ship s resistance and squat the slender body method assumes that a ship s beam free surface wave amplitude and water depth are small compared to its length this allows the simplification of the flow simulation in two dimensions using the slender body theory gourlay 2008 tuck 1964 to take into account the dynamic coupling of a ship s motion with flow the potential flow theory can be applied which only assumes the flow to be irrotational this has been widely used for squat prediction and very good results have been obtained debaillon 2010 ma et al 2016 sergent et al 2015 whereas it is difficult to apply the potential flow model to resistance prediction because it neglects the viscous stresses crucial for evaluating the ship s resistance modern cfd techniques based on solving the fully viscous navier stokes equations have been extensively applied to ship hydrodynamics with fruitful results as they consider the important features of the actual flow such as viscous effects and turbulence hence they are more reliable for predicting ship s resistance and motions stern 2013 summarised the achievements made regarding ship hydrodynamics using cfd in the last decade further recent progress in modern computational ship hydrodynamics with respect to shallow and confined water has been made eloot et al 2015 performed a turning circle and a zigzag test on a kvlcc2 hull model to determine the manoeuvring performance in a shallow water zone to study the scale effect tezdogan et al 2016 performed unsteady reynolds averaged navier stokes rans simulations at full scale for the squat in shallow water with star ccm commercial software they compared the results to the 3d potential flow theory and the experimental data of mucha et al 2014 they reported an underestimation of the ship squat and pointed indicated that the ship s resistance is sensitive to sinkage linde et al 2016 validated this observation with fluent by simulating the ship s resistance both with and without consideration of ship sinkage the predicted value of resistance with sinkage was closer to the experimental data kaidi et al 2017 further studied the ship manoeuvring with fluent under the effect of bank propeller hull interaction in shallow water in ports flow stratification might occur as the non saline light river water flows into the colder and heavier saline seawater leading to large horizontal or vertical fluid density variations highly density stratified waters are known to pose particular challenges to navigating ships when a ship s keel bottom is travelling just above the interface of the water layers the ship experiences large wave resistance this resistance occurs particularly if the ship is travelling close to the speed of the fastest internal waves due to the generation of large internal waves this phenomenon known as dead water affects the ability of ships to move through stratified water accurately assessing the effects of stratified flow on ship navigation requires a detailed knowledge of the flow field including turbulent mixing and in particular the generation of internal waves on the interface between the two layers of water zhao et al 2006 crapper 1967 and hudimac 1961 presented analytical approaches to study the internal wave modes caused by a moving body in a two layered ocean it follows from their work that just as for surface waves at ship speeds sufficiently larger than the internal wave speed only divergent waves travel downstream from the ship while both divergent and transverse waves are present for slower ships tulin et al 2000 suggested a nonlinear theory to capture internal wave behaviour at high froude number fr in weakly stratified flow which compared satisfactorily with available experimental results for a semi submerged spheroid delefortrie et al 2004 delefortrie and vantorre 2005 conducted a large number of experiments on towing tanks they studied the mud layer effect on the ship manoeuvring by considering several parameters they also developed a mathematical model to take into account the mud effect alchang et al 2006 presented one of the few available examples of the use of cfd for a ship in a stratified medium esmaeilpour et al 2016 studied the evolution of the stratified flow in the near field of a surface ship in detail they demonstrated that the generation of internal waves requires energy which results in an increase in resistance in this paper we present an overview of a numerical study of the mud layer effect on ship s resistance and sinkage by using a multi phased cfd method note that the mud is supposed stratified hence the water and the mud were modelled as separate layers with average values of density and viscosity the main objective of this work is to test the ability of the cfd method to simulate and assess the influence of the mud on the hydrodynamic forces acting on the ship s hull four parameters were tested the mud properties the ship speed vs the mud thickness and the ukc a preliminary study was conducted to first show the influence of the non newtonian behaviour of mud on the ship s resistance and the internal waves at the mud water interface based on this preliminary study the newtonian model was selected for this investigation the ukc level was referenced to the water mud interface hence it can take both positive and negative values the limits of the cfd method are discussed in section 5 2 mathematical formulation and numerical methods the fluid flow is governed by the incompressible viscous navier stokes equations completed with the continuity equation as follows 1 u 0 2 u t u u 1 ρ p η ρ ² u where u and p represent the velocity vector and pressure respectively and ρ and ν are the fluid properties of density and kinematic viscosity 2 1 turbulence modelling to model the turbulence effect the reynolds averaging was computed on the flow variable in time which gave rise to 3 u 0 4 u t u u 1 ρ p η ρ 2 u u u where u u u and p p p the last term in the rans momentum equation is the reynolds stress which is often approximated by turbulence models in this research we employed the sst k ω turbulence model which is actually a combination of the k ω and k ε models while a shifting function is used to switch one from another 2 2 multiphase approach the volume of fluid vof method was used to simulate three phase interactions the interface of air water and water mud using this approach both interfaces can be captured in a fixed grid by solving the continuity equation of the volume fraction eq 5 as follows 5 α p t u α p 0 p 1 2 α p denotes the volume fraction of the pth fluid and 6 p 1 n α p 1 n 2 or 3 equations presented thus far eqs 1 6 are solved using the commercial code ansys fluent 13 0 based on the finite volume method the pressure velocity coupling was ensured by using a steady pressure based coupled algorithm and the interpolation method selected to compute the cell face pressure was the pressure staggering option presto the second order was set for the vof s special discretisation 2 3 non newtonian behaviour law for mud it should be noted that mud behaviour is often considered non newtonian which means the viscosity depends on the shear rate hence the herschel bulkley model was selected to reproduce this behaviour the herschel bulkley model is represented by the following equations 7 τ τ 0 k γ n i f τ τ 0 8 τ 0 i f τ τ 0 where τ and τ 0 are shear and yield stress respectively k is the consistency factor n is the power law exponent and γ is the shear rate the non newtonian viscosity η is computed using one of the following formulas 9 η τ 0 γ k γ n 1 f o r γ γ c 10 η τ 0 2 γ γ c γ k γ c n 1 2 n n 1 γ γ c f o r γ γ c γ c is the critical shear rate fig 3 shows the variation of the shear stress with shear rate according to the herschel bulkley model 2 4 verification and validation of the cfd model the procedures for verification and validation of the cfd model have been discussed and performed in several previous works kaidi et al 2017 2018a b razgallah et al 2018 ali et al 2018 and were carried out in accordance with the ittc recommendations verification consisted of tests and analysis of the results of several mesh qualities whilst validation was performed by taking the numerical results of the ship s resistance the profile of generated waves and the ship s squat and comparing them to the measurements carried out in a towing tank of the university of liège and the central school of nantes note that no mud layer was considered in these works only the water air interface was modelled and validated based on the obtained results it was concluded that the cfd model provided a good estimate of the hydrodynamic forces around the ship s hull and correctly captured the air water interface it was also concluded that the cfd model could simulate the sediment suspension and transport accurately kaidi et al 2018a b 3 studied ship channel configuration boundary conditions and mud properties to conduct this investigation we used a container cargo hull form see fig 4 this kind of ship was selected because it is one of the most common ships to sail in the gironde estuary table 1 provides the main characteristics of the hull where lpp is the length between perpendicular loa is the length over all b is the ship beam t is the ship draft and cb is the block coefficient note that the same reference frame is used in this investigation the origin of this reference is fixed on the ship where the x 0 corresponds to the ship s bow plane while the z 0 corresponds to the ship s keel plane the x axis is oriented right while the z axis is oriented up as is shown in fig 4 in the present study we considered only the confinement effect using the ukc to prevent large body motions the reference frame was fixed on the ship hence the fluid and other parts moved relative to the hull the computational domain was chosen with a rectangular section large enough such that there was little influence of the position of the inlet and outlet 1 2 lpp for the inlet and 3 5 lpp for the outlet are recommended by ittc ittc 2011 half of the computational domain was used to reduce computational time for the boundary conditions at the inlet the flow velocity was imposed and at the outlet the outflow condition was used a symmetrical condition was applied at the top at the mid plane and at the side boundaries at atmosphere total pressure was applied at the bottom moving wall condition was employed to take into account the relative motion and at the hull s surface no slip wall condition was used four combinations of mud properties were selected to conduct this investigation these properties represent the average values measured at different zones in the gironde estuary and some ports table 2 presents the combination of the density and viscosity of the mud 4 results and discussion 4 1 comparison between the newtonian and non newtonian models the effect of the use of non newtonian viscosity to simulate the mud behaviour is discussed in this section using the cfd method the mud layer could be modelled in different ways the first was to suppose that the mud properties were constant and slightly influenced by the shear stress induced by the ship s passage hence we used average values for the density and the viscosity the second was to consider that the mud was significantly affected by the shear stress from where a non newtonian model was used to estimate the dynamic viscosity it should be highlighted that in the estuary environment the flow was modelled using hydraulic models which estimate the average turbulent viscosity at the channel bottom that can be used by manoeuvring simulators this provides indispensable results for assessing the difference between the results obtained by both approaches to carry out this study the ship s draft was set to 10 m 0 125 m in the model and the ship s speed was set to 10 kn 0 575 m s the mud thickness used was 3 m in full scale 0 0375 m in the scaled model which corresponds to the average thickness in the estuaries the ukc value was set to 10 t with respect to the mud water interface which corresponded in our case to 1 m in full scale 0 0125 m in the scaled model figs 5 and 6 present a comparison between the undulations of the mud water interface obtained using both methods for mud types a and c at two different plans see fig 7 the first plane is located at y b of 0 621 while the second is located at y b 1 243 where y is the lateral distance from the ship s mid plan and b is the ship s beam the x axis of these figures represented the dimensionless distance x lpp where x is the longitudinal distance from the ship s bow and lpp is the length of the ship and the z axis represented the undulation elevation generally we remark that the non newtonian model tends to underestimate the mud layer crests as is evident the difference between both models shows that mud a has a smaller viscosity and density compared to mud c the height difference at the crest and trough is almost similar approximately 11 at plane 1 and 18 at plane 2 for mud a and approximately 16 at plane 1 and 30 at plane 2 for mud c the difference is larger at plane 2 because the area affected by the ship s passage is reduced when the mud is considered non newtonian especially at high density and viscosity as shown in fig 7 to assess the ship s resistance two ukcs were tested 10 and 10 for the two types of mud the difference between the newtonian and non newtonian models was small as presented in table 3 approximately 2 for both mud a and mud c at positive ukc and less than 5 at negative ukc note that the verification and validation procedure shows that the uncertainty of the total resistance was about 7 in very confined water this uncertainty corresponds to a monotonic convergence condition with an order of accuracy of 1 86 based on these values the only conclusion that can be drawn from this comparative analysis is that the newtonian model gives an acceptable estimation of the ship s resistance despite the overestimation of the mud water undulation hence the newtonian model can be used to carry out this investigation 4 2 influence of mud properties on seabed undulation and free surface attenuation here the mud layer thickness was set to 3 m 0 0375 m in the scaled model the ship s draft and speed were set to 10 m 0 125 m in the scaled model and 10 kn 0 575 m s in the scaled model respectively the value chosen for the ukc with respect to the mud water interface was 10 t fig 8 illustrates the profile of the mud layer deformation caused by the ship s passage as can be seen the deformation is composed of a principal undulation and secondary undulations the principal undulation is similar to the free surface deformation with a small shift where a stern divergent wave is observed fig 9 the divergence angle the wave height and the wavelength of this wave depend on the mud properties as shown in fig 10 in this study we only focused on the principal undulation which had an impact on the ship manoeuvring principally on the ship s resistance and squat this undulation was characterised by a maximum trough and crest where generally the trough is located at the mid hull whilst the crest is located at the hull s stern for all tested mud properties the mud layer trough started from the same position the ship s bow however compared to the initial mud setup the trough level and length increased by decreasing the mud viscosity we note that the origin of this trough was principally the pressure variation along the ship hull caused by the return flow which was influenced by the mud properties see fig 11 from the same figure it can be seen that the relative increase of the mud trough shows a linear variation for viscosities varying between 0 025 and 0 12 pa s it can also be observed that the physical properties of the mud played an important role on the mud crest the location of this crest and in some situations the hull mud contact area when the density and viscosity of the mud were smaller the mud was considered more fluid hence the later behaved as a denser fluid and followed the water flow when the viscosity of the mud was greater the mud layer was more solid and its behaviour was more rigid from this we noted a maximum uprising value for the mud d 20 less than for mud b whilst an insignificant variation was noted between mud samples b and a for all tested properties the mud uprising position varied as the mud properties varied from simulated cases it was noted that the lower the viscosity the more the mud uprising moved backwards the same observations were also noted by delefortrie and vantorre 2005 contact between the hull and the mud was also observed for mud a and b and the contact area was slightly larger in the case of mud a to assess the separate effect of the viscosity and the density on the internal waves pattern an additional series of simulations were performed for a better visibility of this undulation the mud thickness of 3 m in full scale was used 1 m corresponds to the ukc and 2 m to the distance between the ship s keel and the solid seabed for a negative ukc of 10 t five values of viscosity and density were tested the ship s speed was set to 10 kn as in the previous simulations first the viscosity was varied as follows 0 005 0 01 0 05 0 1 0 2 pa s while the density of the mud was set to 1100 k m3 and second the viscosity of the mud was set to 0 1 pa s which corresponds approximately to the transition limit defined by delefortrie 2016 basing on experiments while the density was varied as following 1050 1100 1150 1200 and 1250 kg m3 the internal waves corresponding to the viscosity and the density variation were plotted in fig 12 as it can be seen at the left of this figure the viscosity has a very important influence on the internal waves pattern and for the used ship s speed the internal bow waves length is longer than the ship s length which is a characteristic of shallow water navigation for the smallest viscosity a stern waves pattern was observed where the first is convergent while the second is divergent which resembles to the free surface behaviour in a shallow water reflected waves were also observed far behind the ship s stern by increasing the viscosity value to 0 01 pa s the same waves pattern were observed however transverses waves appeared behind the ship s stern for viscosity value of 0 05 pa s the waves pattern becomes more apparent while the angle of the diverging waves increases and tends to be perpendicular to the ship s heading direction the same observations were noted for the viscosity value of 0 1 pa s the converging waves remains unchanged and apparent whereas the diverging waves becomes completely transversal and slightly less apparent for the highest mud viscosity 0 2 pa s only the transverses waves pattern were affected and becomes even less apparent and tend to disappear this behaviour is in accordance with experimental findings however viscosity limits defining waves patterns were slightly different the density variation effect on the internal waves pattern is shown at the right of fig 12 the only observation noted from this figure is that the density has any effect on the transverses waves while the converging waves increase slowly by increasing the mud density basing on these results it can be concluded that the internal froude number f r i f n i f n ρ w ρ m δ ρ often used to describe multiphasic flow cannot be used to define the internal waves patterns it can also be concluded that the internal waves pattern evolution should be set as a function of mud viscosity and mud layer thickness fig 13 shows the free surface attenuation caused by the mud layer for this we compared the free surface deformation of a channel with a muddy layer to the free surface deformation of a channel without a muddy layer rigid bottom the same total depth was maintained for both tests note that for the present study the total depth of the channel is the sum of the ship s draft the ukc and the mud thickness it may be observed that the free surface elevations closely resemble the mud layer undulation it was also observed that the trough and crest of the free surface was approximately the same between the rigid seabed and mud samples a b and c however for mud d we noted a lowering of the free surface this lowering was essentially caused by the effect of shallow water as mentioned above the higher the viscosity the more solid the mud hence the seabed can be considered solid the shear stress due to the high viscosity of the mud slowed down the flow velocity of the mud water interface under the ship s hull inducing an acceleration of the water flow and consequently a pressure drop 4 3 ship s speed and mud thickness effect on the seabed undulation internal waves pattern the study of the influence of the ship s speed and the mud s thickness on the seabed undulation is presented in this section the influence of the ship s speed was performed by setting the mud layer thickness to 3 m in full scale and the ukc to 10 t mud a was selected for this simulation the ship speeds that were tested were 6 8 and 10 kn in full scale 0 345 0 46 and 0 575 m s in the scaled model it can be seen from fig 14 that for the selected mud the ship s speed has an influence on the position of the maximum rise of the undulation the higher the speed the more the undulation crest moved backwards it was also seen that the crest width increased as the ship s speed increased this behaviour was due first to the mud type here the mud density was small and it was thus was more fluid than solid second the return current amplification caused by the increase in the ship s speed affected the behaviour a slight influence of the ship s speed on the trough depth and the crest height of the mud water interface undulation was noted in the second part of this section the influence of the mud thickness on the internal waves pattern was studied three thicknesses of the mud a were tested 1 m 2 m and 3 m in full scale note that the mud thickness effect on the internal waves patterns can be tested using a constant ukc 10 t and variable total depth as is depicted in fig 15 a or using a variable ukc 10 t 0 t and 10 t and constant total depth as is depicted in fig 15 b the ship s speed was set to 10 kn 0 575 m s in the scaled model the frh values were the same for both type of test 1 64 1 16 and 0 94 using the mud thickness as a characteristic length for mud thickness of 1 m 2 m and 3 m respectively these values correspond to critical and supercritical regimes the numerical results of the waves patterns were shown in fig 16 fig 16 a shows the influence of the mud thickness on the internal waves patterns for a constant ukc and variable total depth from this figure it can be shown three different waves patterns of the seabed where for the smaller mud thickness 1 m in full scale the internal waves appear behind the ship s stern and its pattern is very divergent and nearly transversal to the ship s heading direction for the medium thickness 2 m in full scale the undulation is principally transversal however a small kelvin pattern appears at the ship s stern which leads us to consider this thickness as a transition thickness for the larger mud thickness 3 m in full scale the internal waves have a kelvin pattern form these patterns were also noted in the experimental work done by delefortrie 2016 see fig 17 the authors of this work related these patterns only to the mud viscosity and the ship s speed according to their findings the kelvin pattern appeared for larger ship s speed and lower viscosities 0 12 pa s and the transversal pattern appeared in the case of lower ship s speed it was also noted that the transversal pattern were observed for larger ship s speed and larger mud viscosities 0 12 pa s in the present work the both undulation patterns transversal and kelvin pattern were observed by varying only the mud thickness where the ship s speed can be considered larger however the mud viscosity is lower 0 025 pa s to separate the effect of the mud thickness and the effect of the confinement the total depth was considered constant and the mud thickness was varied the obtained results were depicted in fig 16 b the simulation setup for the smaller mud thickness 1 m in full scale is the same as in the case of variable total depth hence the results of the previous simulation were kept for the medium mud thickness 2 m in full scale the ukc is 0 t the similar wave pattern as for the mud thickness of 1 m was observed however the undulation amplitude was amplified for larger mud thickness ukc 10 t the waves change pattern and convergent and divergent waves appear transversal waves were also observed far behind the ship from these observations it can be concluded that the mud thickness has a significant influence on the internal waves pattern which change as a function of the total depth and the ukc however it is difficult to specify exactly the influence of the mud thickness in fact the mud thickness effect is always coupled with another parameter either the total depth or the ukc from this study it can also be concluded that the internal waves pattern are independent of the frh contrary to the generated waves pattern at the water air interface basing on the results obtained in this section the pattern of internal waves are not only depends on the mud viscosity and ship s speed as is given in the literature but by the combined effect of the viscosity the ship s speed the mud thickness the water depth and the ukc 4 4 ship s resistance variation due to mud properties ship s speed and mud thickness it is known that ship s resistance is greatly affected by channel configuration such as confinement and restrictions in shallow water the ship s resistance increases significantly due to the accelerated water around the hull as explained previously the presence of the mud layer in turn affects the flow under the ship s hull inducing a variation in the ship s resistance the effect of the latter can be considerably amplified if the ukc is negative in this section findings are presented from studying the impact of the mud layer first by testing the mud properties effect for a given mud thickness 3 m in full scale hence the four mud properties were tested for an ukc of 10 t with respect to the mud water interface the ship s speed was set to 10 kn 0 575 m s no squat was considered in these simulations fig 18 shows the ship s resistance variation caused by variations in the mud properties from this figure it is evident that the ship s resistance increased with mud viscosity although there was no contact between the hull and the mud with mud samples c and d this leads us to conclude that this increase essentially concerns the frictional component of the resistance in fact when the mud is consolidated it seems as though the total depth of the water is reduced which makes the navigation environment more confined and consequently the return current velocity increases to understand better the confinement phenomenon due to the mud layer and its influence on the ship s resistance we carried out simulations by varying the mud thickness three thicknesses were tested 1 m 2 m and 3 m in full scale for each thickness we used two speeds 6 and 10 kn and two types of mud mud a and mud c the water depth remains unchanged for all simulations 10 m in full scale first a positive ukc of 10 t was considered the results of these simulations were shown in fig 19 from these figures it can be seen that the ship s resistance increases with increasing ship s speed however this increase is different according to the mud layer thickness as well as the type of the mud in fact by decreasing the mud layer thickness the ship s resistance increases considerably this increase concerns both types of forces pressure and friction however the wave making resistance remains the most dominant and the most impacted by this decrease in thickness the wave making resistance is amplified about 9 times when the ship is sailing at a speed of 10 kn on a mud thickness of 1 m than 3 m and about 4 times when the ship s speed is 6 kn while the amplification of the friction resistance is of the order of 2 times for the two ship s speeds it was also observed that the wave making resistance was the most dominant compared to the friction resistance except in the case of the largest thickness 3 m where both types of forces were approximately in the same range note that for navigation in channels with solid seabed the confinement is often defined by the ratio of water depth to ship s draft hw t this ratio is an essential element for the calculation of the ship s resistance in the case of navigation in turbid water with a muddy bottom this ratio may be valid however the definition of the depth hw must be modified by including the thickness of the mud layer a proposal has already been made by delefortrie 2016 proposing the use of the hydraulic depth h given by the following formula 11 h h w h m where is the fluidization parameter which represents the mud type so far all works studying the influence of the mud quality on the ship s resistance were performed by varying both values of viscosity and density in order to distinguish the influence of each physical property we varied separately the viscosity and the density of the mud the same process as in the sub section 4 3 was used first the density is fixed at 1100 kg m and the viscosity is varied then the viscosity is fixed at 0 1 pa s and the density is varied for a better presentation of the influence of these properties on the ship s resistance we considered the highest speed of navigation 10 kn and assume that the ship s ukc is 10 t three mud layer thicknesses were tested 2 m 3 m and 4 m corresponding to a distance between the ship s keel and the solid seabed of 1 m 2 m and 3 m as is presented in fig 20 the computed ship s resistances as a function of the mud viscosity and density were presented in fig 21 by its two components wave making and friction basing on these results it was noted that for smaller and medium mud thicknesses the wave making resistance is dominant compared to the friction resistance however for the larger mud thickness the friction resistance is dominant this behaviour is physical because it depends on the depth froude number where for high values of depth froude number the wave making resistance is dominant while the friction resistance is dominant for very lower values by analyzing the numerical results of the ship s resistance under the variation of the viscosity it can be seen that the effect of the later begins to be visible when the viscosity is more than 0 01 pa s in smaller and medium mud thicknesses for the larger mud thickness the effect is visible only when the viscosity of the mud is greater than 0 05 pa s it can also be seen that despite the dominance of the wave making resistance its variation at a given mud thickness is insignificant compared to the variation of the friction resistance where the maximum variation of the wave making resistance is about 30 computed between the largest and the smallest value of the viscosity at the larger mud thickness while the friction resistance was amplified by 2 8 1 9 and 1 3 times at smaller medium and larger mud thickness respectively these behaviour is completely realistic for both types of resistances the friction resistance depends principally on the shear stress on the ship s hull which increases with confinement however the wave making resistance depends on the length and the amplitude of the generated waves which are important when the mud thickness is larger see fig 16 through fig 21 b it can be noted that the effect of the density on the ship s resistance is unimportant for the tested thicknesses the wave making resistance variation is insignificant at a given mud thickness whereas the friction resistance is slightly affected by mud density where an increase of 23 was computed between the largest and smallest density at the larger mud thickness this insensitivity to density is related on one side to the non variation of the generated waves as is illustrated in fig 12 and on the other hand to the phenomenon of fluidization of the interface of the mud layer caused by the ship passage especially at high speed this point will be discussed in the next paragraph the second part of this section presents the results for the ship s resistance studied as a function of the ukc mud a was used for 6 values of ukc as follows 10 5 0 5 10 and 15 of the ship s draft the ship s draft here was 10 m the mud thickness was 3 m and the speed of the ship was 10 kn from fig 22 we observe an increase of the total resistance with the decrease of the ukc the pressure resistance dominates for ukc varying between 10 and 5 t less than that the frictional force dominates considerably we also observe that ship s resistance increase is very slight for ukc values between 5 and 5 and less than 10 the ship s resistance increase is significant only between 10 and 5 and between 5 and 10 by analysing fig 23 a plotting the area of contact between the hull and the mud we note that for ukc range of 10 5 the contact area is almost the same and the total resistance increase is principally due to the shallow water effect for the ukc range 5 10 the resistance increase is principally due to the hull mud contact as is shown in fig 22 the frictional resistance dominates while the pressure resistance increases slightly it can also be observed from fig 23 a that when the ship is sailing inside the mud layer negative ukc the keel of the hull is not fully covered by the mud this is one of the relevant phenomena observed in this work in fact when the ship is sailing in the mud we observe two different behaviours when the ship s speed is low the ship s keel is fully covered by the mud however when the ship s speed increases the top boundary of the mud layer tends to be more liquefied especially at the ship s bow and a film of very liquefied mud or turbid water is created between the mud and the hull fig 23 b shows the evolution of the hull mud contact area as a function of the ship s speed to illustrate bitter the contact area the legend of this figure was limited to a volume of fraction of 0 8 4 5 effect of the muddy seabed on the ship s squat one of the aims of this work was the numerical study of the influence of the muddy layer on the ship s squat sinkage and trim the fluid structure interaction is treated by a modified newton algorithm coupled to a steady rans linde et al 2016 the standard dynamic newton algorithm was not used because of several numerical complications encountered the origin of these complications is essentially the bad estimation of the added mass due to the high blockage coefficient which considerably affects the stability and convergence of the numerical solution because of the large computation time only one mud layer thickness was considered 2 m for an ukc of 10 t the effect of the mud properties on the squat was simulated for the four types of mud and for three ship speeds 6 8 and 10 kn which correspond to a froude depth number frh of 0 297 0 396 and 0 495 respectively the ship s sinkage as a function of the mud type was plotted in fig 24 and compared to the experimental and numerical sinkage for a rigid bottom concerning the ship s sinkage similar observations given by delefortrie 2016 were noted first we observed that the sinkage obtained numerically for a rigid seabed was in accordance with measurements we also observed that the sinkage increased by increasing the ship s speed in all configurations with or without the mud layer however the sinkage values decreased slightly with the change in mud properties for larger viscosities mud c and mud d we observed an insignificant decrease whilst a moderate decrease was observed for mud a and mud b this decrease augmented in turn with the increase in the ship s speed in fact this increase was due to the added buoyancy generated by the contact between the hull and the mud this contact as mentioned previously was located at the ship s stern when the undulation crest was larger as for mud a and mud b the ship s trim was plotted in fig 25 for the selected ukc the trim has positive values which correspond to a trim by the stern the plotted results show that the numerical results are in the same range as measurements without mud it can also be seen that the mud had an insignificant effect on the trim at low ship speed 6 kn in the case of mud b c and d except in the case of the mud a a significant deviation compared to the rigid bottom case was observed for a ship speed of 10 kn this deviation decreased due to the mud hull contact located at the stern of the ship which created an asymmetry in the ship s buoyancy however the trim behaved differently in the case of mud d where the trim deviation compared to the rigid bottom case increased with the ship s speed this increase can be explained by the confinement that this type of mud generates note that some of these observations are not in agreement with observations made by delefortrie 2016 based on measurements carried out in the towing tank for manoeuvres in confined water at flanders hydraulics research antwerp in co operation with ghent university 5 conclusions in this paper an overview of a numerical investigations on the impact of muddy seabed on a ship s resistance and squat was presented a multi phase cfd model was used to estimate the ship s resistance and squat as a function of several parameters different configurations based on observations noted in the present work it was concluded the following the obtained numerical results are in agreement with physical models results the internal waves crests depend strongly on the mud properties the internal waves patterns depend strongly on several parameters the viscosity the total depth the ukc and the thickness of the mud layer and the frh is not suitable to characterize the wave patterns the internal waves influence the ship s resistance and squat especially when the ukc is negative the effect of the mud layer on the ship s sinkage is significant only when the ukc is negative the effect of the mud on the ship s resistance can be felt even when the ukc is positive and this depends on the mud properties the ship s speed tends to move the mud water interface undulation in the backwards the ability of the cfd method to simulate multiphasic flow and interaction between the fluid flow and the structure has been demonstrated some difficulties were encountered in the modelling of the depth dependent density and viscosity of the mud some difficulties were also encountered in the simulation of the dynamic ship squat especially when the mud contacted the ship s hull an improvement can be made in future works by integrating a new numerical algorithm that stabilises calculations and takes into account the real vertical profile of the density credit authorship contribution statement sami kaidi writing original draft emmanuel lefrançois investigation hassan smaoui writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work presented in this paper was performed within the project gironde xl funded by le grand port maritime de bordeaux france and the european commission 
22076,this paper investigates the motion planning problem for an unmanned surface vehicle usv in which the goal is to find the shortest search time the shortest path in navigational waters all subject to collision avoidance and usv dynamics constraints a new motion planning method is proposed based on topological position relationships tpr to achieve this solution firstly the tpr of the obstacles and the usv are constructed based on the spatial distribution of the obstacles this gives an overall topological navigation map which is different from the usual grid based map secondly a numerical model of unit decomposition is built to constrain the dynamics of the usv so that the motion of the usv better fits the exact situation motion planning in this study is achieved by combining the topological navigation map and a numerical model of the usv finally numerical simulations and field tests verify the effectiveness of our formulated model and proposed algorithm keywords unmanned surface vehicle usv motion planning topological position relationships tpr motion model 1 introduction unmanned surface vehicles usvs have received increasing attention in the last few years due to the development of relevant technologies heo et al 2017 campbell et al 2012 usvs are not subject to anthropic factors such as overwork or emotional change svec et al 2012 they can be used in dangerous environments such as in water quality monitoring and measurement yang et al 2018 in rescues shafer et al 2008 wilde and murphy 2018 nadj et al 2015 in target tracking norgren et al 2015 cong et al 2019 and in surveillance junglak 2014 they are widely used in commercial and military applications liu et al 2016 path planning for a usv is key to usv development as it determines the efficiency and stability of the usv janis and bade 2016 singh et al 2018 bibuli et al 2018 ma et al 2018 path planning can be split into three stages route planning trajectory planning and motion planning du et al 2018a song et al 2019 the first route planning regards the usv as a point in this stage speed and dynamical constraints are not considered shiozawa 2016 the second stage trajectory planning consider the shape and part dynamic constraints of the usv lekkas 2014 the third stage motion planning considers the overall dynamic constraints of the usv liang 2010 in the route planning stage chen 2013 combined the ant colony algorithm with the dijkstra algorithm to obtain an optimal search path for a rescue ship in a search and rescue operation xie et al 2015 solved for the path in the usv cruising problem in very complex situations based on a combination of the dijkstra algorithm dijkstra 1959 and the artificial potential field algorithm and found a safe path for the usv in a dynamic environment thanapong et al 2014 combined the grid based a algorithm hart et al 1968 and multi beam forward looking sonar technology to search for the optimal usv path in real time du et al 2018b used a complexity map combined with the a algorithm for obstacle avoidance route planning under condition awareness of the usv however the time complexity of the above methods increased with an increase in the search range and if the dynamical constraints of the usv had been considered in path planning the results may have come closer to the actual optimal trajectory of the usv in the trajectory planning stage lazarowska 2015 devised a trajectory plan that avoided obstacles during navigation using the ant colony optimization algorithm in a dynamic environment they also developed an obstacle detection and avoidance system based on this method however sometimes uncertainty in the ant colony algorithm path search interferes with exploration of the optimal path thakur et al 2011 simulated a trajectory plan for a usv using a gpu based state transition model in complex sea conditions wang 2016 studied dynamic and kinematic models of usvs then simplified them according to the characteristics of the usv path and proposed the usv three degrees of freedom motion model on a water surface and verified the path using simulation kularatne et al 2018 aimed at path planning for saving usv energy in time varying flows and proposed an adaptive planning algorithm in which they designed a adaptive graph by considering the velocity of time varying flows however the fully dynamical constraints of the usv could have been ignored the results would have been more convincing had this been taken into account in the motion planning stage du et al du et al 2018a carried out usv motion planning by establishing a trajectory unit and considering the dynamical requirements of the usv combined the a algorithm with the dynamic constraint trajectory unit they considered the dynamical constraints of the usv and based on literature du et al 2018a they improved the trajectory unit and search method and proposed a better method for usv motion planning du et al 2019 however the path from their search method was not optimal in the case of more than one obstacle and their algorithm search time would become very large as the search range expanded the results would be better if he could give further consideration to the optimal path and search time zhuang et al 2011 achieved usv motion planning that avoided obstacles under sea navigation rules by using a relative coordinates method however the method mainly focused on the navigation rules and the collision avoidance path may not be optimal escario et al 2012 proposed a motion planning method for ship manoeuvers based on the ant colony algorithm and obtained optimal trajectories however the results may remain uncertain and the results would be more reasonable if the search time had been considered path planning methods for other vehicles such as the space maneuver vehicles smvs unmanned aerial vehicles uavs and the ground vehicles have also been proposed in recent years for example in term of smv trajectory planning chai et al 2017 proposed a method for smv trajectory planning by harnessing a three layer hybrid algorithm firstly they presented an initial guess generator to evaluate the reference trajectory via v based adaptive differential evolution algorithm secondly they came up with a new gradient based algorithm which was regarded as the inner solver including a gradient based optimizer and mesh tolerance to optimize the trajectory and enhance the trajectory more smooth furthermore chai et al 2018 designed an ms based multiple shooting nsga iii non dominated sorting genetic algorithm iii in order to deal with the smv multi objective trajectory optimization problem in addition chai et al 2019 proposed a convergent approximation approach to address nonlinear trajectory optimization problems in the presence of probabilistic constraints in term of uav path planning chakrabarty and langelaan 2013 constructed a kinematic tree path planner to cope with the uav path planning in a complex environment with varying space and time as for the ground vehicle jinghui et al 2019 proposed a dynamic vehicle specific routing model that can be used in on board navigation systems the model is created through a novel link cost function which integrates the conventional and electric vehicles model and it is well adaptive to ground vehicle eco routing planning however the navigational environment of the usvs is far more complex compared with the smvs the uavs and the ground vehicles apart from the interference of wind wave and current the usv s inertia the resistance and the response time on waters are also more complex than those in the air and on the ground to some extent fossen et al 2017 zhang et al 2015 the control and path planning of the usvs is harder than the smvs the uavs and the ground vehicles in some environments in the above literature usvs had either a partial optimum problem or a long search time problem or the problem of not considering usv dynamics constraints the combination of usv path planning and constraints of dynamics will be very important in future research in this study usv motion planning is developed based on topological position relationships to solve the above problems the topological position relationship tpr method is a method in geographic information space which is mainly used for the analysis of spatial information and simplified search space by topological relationship however at present there is no usv motion planning related to tpr in the literature this paper proposes a method of motion planning for usvs based on tpr and usv dynamics according to the process of planning the motion planning can be divided into three steps environment model search algorithm and dynamic model firstly based on tpr we construct an environmental model to assist the search algorithm secondly to make our method easier and more practical and to prove our method s search performance we choose the dijsktra algorithm as the search algorithm which is a classical and practical algorithm finally we combine the environmental model search algorithm and usv dynamics to achieve better motion planning for an usv this paper is organized as follows section 2 outlines the map expression based on tpr and describes in detail the map element expression spatial relationships and tpr tpr terminology and the topology path reachable definition the structure and implementation of the tpr algorithm are discussed in section 3 section 4 briefly introduces the mathematical model for usv motion the structure and implementation of the motion planning algorithm are discussed in section 5 simulation and experimental results are presented in section 6 section 7 is the conclusion 2 map expression based on topological position relationships the usv path search is conducted in navigable waters with obstacles the objective is to plan and optimize a navigable path from the starting point to the end point in order to speed up the search the search space is simplified in this study using topological position maps the main parts of the topology map are the map representation the topological position relationships and the map construction 2 1 map element expression the open geospatial consortium ogc defines a simple feature model for storing and accessing geographic features in relational databases in its simple element access specification open geospatial consortium simple feature access part 2 sql option open gis implementation specification for geographic information open geospatial consortium ogc 2010 points lines and surfaces are the three elements that make up a space map point elements do not have spatial features such as shape and size line elements are composed of a series of points and their spatial features include shape and length surface elements are represented by polygons consisting of closed linear rings and their spatial features includes shape and area in this paper the starting and end positions of the usv are points the planned path is a line and the navigable waters and the obstacles are polygons as shown in table 1 2 2 spatial relationship and topological position relationship spatial relationships between geographic entities consisting of topological relationships directional relationships and metric relationships are the basis of spatial data organization query analysis and reasoning topological position relationship tpr refers to the mutual relationship between spatial objects that satisfies the principles of topological geometry points lines and polygons represent the adjacency association inclusion and connectivity relationships between geographic entities such as point to point adjacenct relationships point to polygon inclusion relationships line to polygon separation relationships and polygon to polygon coincidence relationships tprs can be used to reduce spatial computational complexity accelerate spatial query speed and improve spatial analysis accuracy many researchers have proposed a number of tpr expression models for example chen et al 2015 proposed an expression model of the tpr of composite planar objects which expressed the detailed tpr between composite planar objects and improved and expanded the expression ability of the classical nine intersection model cao et al 2016 proposed an integrated representation model of a linear relationship based on the concept of meta topology in which an analysis and classification of simple topological relations of lines and polygons and a composite topology integration expression method with complex faces was studied ouyang et al 2009 used an extended nine intersection model to extend the elements of the nine intersection matrix into binary codes and proposed a d nine intersection model long and li 2013 used a boolean matrix to completely classify spatial relationships using voronoi s 9 cross model relationship between any two spatial entities in order to further this research people are constantly seeking better tpr expression models ogc recommends the four intersection and nine intersection models the boundary of the defined object is represented as the inside of the object is represented as the outside of the object is represented as and the intersection of two objects is represented as the four intersection model considers tpr of the boundary and the inside of the point set the nine intersection model considers the outside of the point set on the basis of the four intersection model and its expression ability is stronger the nine intersection model expresses the tpr m as the matrix 1 m a b a b a b a b a b a b a b a b a b for the spatial tpr of lines and polygons the nine intersection model can theoretically express 512 possible cases but only 19 cases are actually available in fact spatial relationships between lines and polygons are infinite because the number of points involved in the intersection of lines and polygons is uncertain and can be any positive integer 2 3 tpr terminology based on the nine intersection model ogc defines eight common relational terminologies in its simple element access specification including crosses disjoint within contains equals touches intersects and overlaps the tprs used to construct topological position maps in this paper are mainly intersects disjoint touches and contains meanings are shown in table 2 in the case of two objects a and b in space when the point set of their intersection is null ϕ then denoted as f when it is non empty ϕ then denoted as t further when the intersection is a point then denoted as 0 when a line denoted as 1 wheb an area denoted as 2 denoted as means the value could be f 0 1 or 2 2 4 topology path reachable definition in the path searching whether two points any two points in free space two points of connection between obstacles or two points of connection between obstacle and usv are reachable practicable topology path is a key issue and needs to be clearly expressed in the map whether a path is reachable is determined by the tpr between the path and the obstacles based on the nine intersection model the relationship terminologies are divided into five relationship sets they are crosses within contains equals touches overlaps and disjoint zhu et al 2011 in this paper considering the tpr between a path and an obstacle relationship sets touches and disjoint are generally defined as reachable and the relationship sets crosses within contains equals and overlaps are defined as unreachable representative cases of the reachable or not conditions are shown in table 3 3 topological position map construction map feature representation tpr terminologies and topological path reachability are the core components of building a final topology map building a topological position map based on section 2 is the basis of usv motion planning algorithm 1 shows the topology map construction set the euclidean distance between any two points u x u y u and v x v y v to d u v where 2 d u v x u x v 2 y u y v 2 firstly the position data for the starting point s and end point e the number of obstacles n and the position of each obstacle side point set np are read in the initial state it is assumed that there is only one path segment candidate se on the topology map secondly the obstacles are selected one by one according to the topology path reachable definition in section 2 4 the positional relationship between each obstacle and the path segment candidate is determined consider the i th obstacle if the line segment se is separated from the obstacle then the line is a reachable path and the path distance is calculated according to eq 2 if the line segment se does not intersect internally with the obstacle it is a reachable path and the path distance is again calculated according to eq 2 otherwise it is an unreachable path and the path distance is set to ach edge of the i th obstacle each line between the point s e and the obstacle edge point set are put into the path candidate set finally the reachability of each path candidate is determined and the map construction is done image 8 the starting point the end point and the obstacle map are shown in fig 1 b1 b15 are obstacles the starting point is s and the end point is e first the positional relationship between the starting point s and the end point e is determined fig 2 the connection between s and e intersects the inside of obstacle b7 which means e is unreachable the connection distance between points s and e is set to infinity second the positional relationship between the boundary point of obstacle b7 and e is determined and the connection between them found to pass through obstacles b8 and b9 the point connection between the boundary point of obstacle b7 and e is unreachable and the distance between the two points is again set to infinity the positional relationships of the boundary points of obstacles b7 b8 and b9 are determined next and the path distances between pairs of points calculated according to eq 2 the path distance between unreachable points is set to infinity finally the positional relationships between e and the boundary points of obstacles b8 and b9 is determined e is directly reachable from these boundary points after the above steps paths from the starting point s to the end point e are found it is not necessary to make other regional positional relationship judgments according to algorithm 1 fig 3 shows the paths found between the starting point and the end point a reachable path blue and an unreachable path yellow table 4 gives the distances of the reachable paths between pairs of points in the environment based on the tprs fig 4 shows the reachable path topology map obtained according to table 4 4 establishing the mathematical model for usv motion after the topological position map has been constructed the trajectory unit is used to dynamically constrain the trajectory of the usv trajectory unit is constructed based on maneuvering mathematical group mmg model ogawa 1977 du et al 2018a it is a series of track segments generated by mmg model which contains the characteristic elements of ship navigation such as rudder angle etc the usv motion model is the core part of the trajectory unit ship motion models are mainly categorized into the mmg model and the nomoto model jia and yang 1998 because the adaptation scheme of the mmg model is wide flexible and easy to modify locally for specific ship types it can succinctly express the interference effects of the hull paddle rudder the trajectory unit here is based on the mmg model and the hydrodynamic force torque is decomposed into hull paddle and rudder contributions the force on the hull is decomposed into the viscous hydrodynamic force torque and the inertial hydrodynamics torque 4 1 construction of a usv motion model based on the mmg model to simplify the problem the following hypotheses need to be made before modeling 1 during movement of the usv heave roll and pitch are ignored 2 the influence of the natural environment wind waves and current on the movement of the usv is temporarily ignored 3 only the forward rotation of the ship s main engine is considered when the usv moves stably the propeller speed remains unchanged from hypothesis 3 when the ship is moving the hull will be subject to the resistance of the water flow the load on the propeller is then increased resulting in a decrease in the rotational speed n at this point the speed controller will increase the host power to offset this increased load and maintain the original speed in the above process under regulation of the speed controller the control model can be expressed as 3 t d i e n i e n k p k n 2 π k p k n r 2 π 1 2 π t d q p q p where t d is the time constant i e the moment of inertia of the entire system k p the gain of the speed controller n r the command speed k the gain from the main drive rod to the torque output and q p the propeller absorption torque therefore the three degrees of freedom motion model of the usv under surging x swaying y and yawing n can be expressed as 4 x y n x i x h x p x r y i y h y p y r n i n h n p n r where i h p and r are the forces torques generated respectively by inertia the viscosity the propeller and the rudder 4 1 1 inertia model the ship will cause disturbance of the surrounding fluid during its motion so that the fluid acquires additional momentum momentum moment the inertia model is given by eq 5 where m x and m y are additional masses in the x and y directions α x is the x coordinate of m y relative to the center of gravity and j zz is the inertia acting in the z direction k x and k y are the additional momenta u and v the speeds in the x and y directions respectively and r is the yaw rate the differential force in the corresponding direction is the inertial force of the fluid 5 x i y i n i d k x d t x d k y d t y d i z d t y m x u m y v r m y α x r 2 m y v m x u r m y α x r j z z r m y α x v u r m y m x u v 4 1 2 viscosity model the viscous fluid dynamic forces and moments experienced by the ship are related to the hull geometry the motion of the ship and the physical properties of the fluid when the ship s shape and the fluid are stable the viscous power and torque on the hull depend mainly on the current motion state of the ship u v r equation 6 is the viscous model x u is the direct resistance of the ship x vv v 2 x vr vr x rr r are the viscous drag caused by the movement of the ship in the fluid medium y v v y r r and n v v n r r are the linear transverse hydrodynamic forces and torque respectively generally when a ship moves in a fluid medium the magnitude of the drift angle has a great influence on the viscous forces and moments on the hull since this paper does not consider the influence of wind waves and current on the ship no drift angle will be considered during the motion 6 x h y h n h x u x v v v 2 x v r v r x r r r y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 4 1 3 propeller model the propeller is the main driving force of the ship while providing thrust the propeller also produces lateral forces torque however the effect of the lateral forces is negligible compared to the effect of the rudder the propeller model is given by eq 7 t p the thrust derating factor thrust deduction j p the forward speed coefficient a i i 0 1 2 are regression coefficients and w p is the corresponding flow coefficient the thrust generated by the propeller is related to the diameter of the propeller disk surface d p the rotational speed n and the fluid density ρ the propeller model can be expressed as 7 x p y p n p 1 t p ρ n 2 d p 2 a 0 a 1 j p a 2 j p 2 a 3 j p 3 a 4 j p 4 1 w p u n d p 0 0 4 1 4 rudder model the rudder model is the most important part of the overall model it determines the direction of the ship s motion and further determines the ship s trajectory generally the positive pressure of the water flow on the rudder is decomposed into longitudinal resistance a lateral transverse force and a steering torque according to three degrees of freedom as shown in the rudder model eq 8 with δ the rudder angle t r the resistance reduction coefficient a h a correction factor x h the longitudinal distance from the force point of the rudder to the center of gravity of the ship u r the effective speed of the fluid at the rudder a r the effective rudder area α r the effective angle of attack and f a the gradient of lift force the rudder model can be expressed as 8 x r y r n r 1 t r 1 2 ρ a r f a u r 2 sin α r sin δ 1 a h 1 2 ρ a r f a u r 2 sin α r cos δ x r a h x h 1 2 ρ a r f a u r 2 sin α r cos δ in order to facilitate control of the ship to obtain the required trajectory it is also necessary to establish a control model of the rudder equation 9 gives the rudder control model with δ e the command rudder angle and t e the time constant which is about 2 5 s 9 t e δ δ e δ δ 35 δ 3 s 4 2 usv trajectory discretization rules discretization rules are the key to generating trajectory elements appropriate rules can not only reasonably discretize the planning space but also facilitate the path search and enable the discrete trajectories to maintain the continuity of the final trajectory after splicing based on the above considerations and literature du et al 2019 this paper proposes three rules rule 1 at the beginning and end of the trajectory the usv s motion state is stable and consistent at the beginning and end of the trajectory segment in order to maintain continuity after the discrete track segments are spliced it is feasible to make the usv s motion state stable and consistent at the beginning and end of the trajectory segment rule 2 there should be only one rudder per trajectory a unit is an indivisible quantity so the track segment in a unit should be as simple as possible the criteria for judging the complexity of the trajectory are the number of turns of the usv and the number of rudders the number of rudders of a track segment should be small otherwise the spliced track will generate a large number of turning points which is obviously not appropriate in practical applications this rule requires only one rudder during generation of a trajectory segment rule 3 the straight line length of each track is equal in order to standardize the trajectory unit and to solve the optimized path more easily each track or segment in a trajectory should have the same length r trajectory segments are shown in fig 5 oa ob r 4 3 unit decomposition library the unit decomposition library is composed of trajectory units different trajectory units are generated by changing the heading and rudder angle of the trajectory unit in fig 6 the initial heading is 0 the rudder angle generates a family of curves of the trajectory unit in steps of 6 from 35 to 31 in fig 7 as the rudder angle is changed in steps of 6 from 35 to 31 the heading changes from the initial angle of 0 360 in steps of 30 in fig 8 the heading is changed in steps of 20 from 0 to 360 and in fig 9 from 0 to 360 in steps of 10 figs 7 9 show a unit decomposition library consisting of an initial heading from 0 to 360 with a 30 heading a 20 heading and a 10 heading the rudder angle and heading intervals can be smaller down to 1 or 2 the complete unit decomposition library can now completely cover any angle heading search from 0 to 360 5 planning algorithm the planning algorithm is divided into two steps the first step is to solve for the optimal path the second step is to determine the specific motion planning solution for the path according to the optimal path in the first step of the solution process this paper differs from the traditional grid map path planning xie et al 2019 mohanty and parhi 2013 in that it is based on the spatial distribution characteristics of obstacles it analyzes the spatial tprs between obstacles and the usv and it constructs a global spatial topological navigation map using the dijkstra algorithm thus it finds the optimal path and effectively avoids a path selection that is trapped at a local optimum the second step mainly solves the problem how to operate the usv to reach the end position and considers the usv dynamic constraints on the optimal path so as to carry out more precise motion planning for the usv information such as heading position and rudder angle is used to make the usv reach the end position more accurately 5 1 usv optimal route planning algorithm algorithm 2 is an algorithm for path selection using the dijsktra algorithm to calculate reachable paths based on tprs first the reachable path point list ps as a set ps list includes p points determined from the tprs is read and the positional relationship data of the starting point s and the end point e are set the distances du j between all the points in the reachable point set v and all the points in the unreachable point set u are calculated choose the smallest distance du i and denote the corresponding point in u as p i add the p i position data to v continue until num p to end the search and calculate the path from the above calculation the shortest path from the starting point s to the end point e fig 5 is obtained fig 10 shows the shortest path map based on the topological map solution the green line in fig 10 shows the shortest path s b74 b73 b91 e with length 3 100 2 100 3 100 4 100 m 1200 m image 9 5 2 safety margin and ship turning radius in most cases usvs are under actuated systems that cannot move exactly as planned considering that there need to be small deviations from the optimal ship s path a margin of safety should be built into the path it is also necessary to consider the turning radius of the ship a safety margin is achieved by expanding the boundaries of obstacles used in the calculations beyond the actual boundaries leaving some water as a safety buffer for the ship and the safety margin can be adjusted according to different requirements in the spatial analysis this operation is called a buffer operation buffer the buffer radius for the usv is chosen and a larger turning radius of the ship than the actual radius used to ensure safe navigation after the buffer operation for an obstacle it is still a simple element as described in section 2 1 and hence does not affect the implementation of the topology map construction and the efficient path search given a certain safety margin and the ship s turning radius the usv cannot safely sail between the obstacles b9 and b8 that is it cannot sail past the point b91 the shortest path found in section 5 1 then does not meet navigation requirements and the next shortest navigable path must be found the green line in fig 11 shows this path the new path is s b74 b73 b92 e with length 3 100 2 100 3 100 4 3 100 1230 m according to table 4 in order to simplify the calculation in this example the safety margin and the ship s turning radius are not considered in the length calculation of the shortest path 5 3 motion planning for the usv in order to determine specifically how to steer the ship from the starting point to the end point along the shortest path the dynamic constraints are taken into account based on the tprs by the trajectory unit it determines the headings rudder angles and position of each point on the path to achieve accurate motion planning for the usv algorithm 3 shows the usv motion planning algorithm image 10 1 from the unit decomposition library analysis the relationship f1 between the heading angle ψ to the next node and the rudder angle δ is given by f1 ψ a 1δ3 b 1δ2 c 1δ d 1 2 the relationship f2 between the central angle α and the rudder angle δ obtained from the unit decomposition library analysis in section 4 3 is given by f2 α a 2δ3 b 2δ2 c 2δ d 2 3 as shown in fig 12 the relationships f3 between the position coordinates of points c x c y c d x d y d and the central angles y o c y o d are f3a x c x o r sin y o c y c y o r cos y o c f3b x d x o r sin y o d y d y o r cos y o d the other cases are analogous fig 13 shows the heading angle ψ central angle α and path point coordinates combined with the above analysis the problem of usv motion planning is divided into two cases case a one transformation trajectory unit fig 14 shows a schematic diagram of the one transformation trajectory unit with s the starting point coordinates x s y s and e the end point coordinates x e y e when the absolute value of the angle c between s and e is less than 90 only one trajectory unit transformation is needed the heading angle is calculated at s assuming the initial heading angle at s is true north 0 point n is a node and the path reaches e after passing through n the coordinates of n x n y n are given in terms of the central angle a by 15 x n x s r sin a y n y s r cos a the point n heading angle b can be calculated from the coordinates of e and n as 16 b arctan x e x n y e y n from the relationships f1 and f2 find the relationship f4 between the central angle a and the heading angle b to node n b f a where f4 f a arctan x e x s r sin a y e y s r cos a the central angle a value of the angle c between s and e is known the rudder angle δ and other values and the heading angle b can be obtained from the relationships f1 f2 f3 and f4 at this point the heading angle from point n to point e has been obtained the rudder angle corresponding to point n is obtained from relationship f1 between the rudder angle and the heading angle point e can be directly reached with the rudder angle calculated at point n case b two transformation trajectory unit when the angle between the current point and the end point is greater than 90 or less than 90 the rudder angle is at its maximum value of 35 or its minimum value of 31 respectively then the actual heading to the next node is obtained from the relationship f1 between the rudder angle and the heading angle when the absolute value of the angle between the current point and the end point is eventually less than 90 the solution is continued according to case a fig 15 shows a schematic diagram of the two transformation trajectory unit it is assumed that respectively s1 and e1 are the starting point and end point and n1 and m1 are intermediate nodes when the value of the angle c1 between the starting point and the end point is less than 90 two trajectory unit transformations are needed the first trajectory transformation uses minimum rudder angle 31 when the value of the angle c1 between the starting point and the end point is more than 90 two trajectory unit transformations are needed the first trajectory transformation uses maximum rudder angle 35 and then calculating point n1 the central angle rudder angle and position according to f1 f2 f3 as shown in fig 15 when the absolute angle e1 between n1 and the end point is less than 90 fig 15 and then turn to case a finally the two trajectory unit transformation is complete to be specific the next calculation is also shown in fig 15 and refers to the situation of case a the specific calculation process is as follow 18 c 1 arctan x e 1 x s 1 y e 1 y s 1 if c1 90 the trajectory unit needs to transform twice turn the maximum rudder angle 31 from s1 to n1 the coordinates of n1 heading angle and central angle a1 can then be obtained from f1 f2 f3 according to the central angle a1 between point s1 and point n1 the position coordinates of n1 is obtained as follow 19 x n 1 x s 1 r sin a 1 y n 1 y s 1 r cos a 1 then the angle e1 between n1 and e1 is 20 e 1 arctan x e 1 x n 1 y e 1 y n 1 if 90 e1 90 the trajectory unit needs to transform only once similar to the situation of a one transformation trajectory unit case a according to case a the heading angle d1 rudder angle and the next position point m1 are obtained and finally the end point e1 is reached fig 16 is a schematic diagram of the situation of one transformation trajectory unit and two transformation trajectory unit at this time it is assumed that the heading is true north upward 0 the black line indicates the case of one transformation trajectory unit at an angle between 90 and 0 at the current point and the target point the red line indicates the case of one transformation trajectory unit at an angle between 0 and 90 at the current point and the target point the blue line indicates the case of two transformation trajectory unit at an angle between 90 and 180 at the current point and the target point the light green line indicates the case of two transformation trajectory unit at an angle between 90 and 180 at the current point and the target point after determining the path points according to the tprs the dynamic constraints of the relevant path points and the corresponding headings rudder angles and path point position coordinates are given the dynamic constraint between each line segment is carried out by the trajectory unit finally after given the starting point and heading angle the corresponding rudder angle etc the problem of how to steer to the target point can be solved an example of usv motion planning based on above methods is illustrated in fig 17 firstly the map and route points such as point a point i and point j are obtained by algorithm 1 and algorithm 2 and then how to steer the usv is calculated by algorithm 3 in the calculation process of algorithm 3 how to navigate from point a to i is calculated firstly and then i to j the following describes how to steer the usv from a to i how to navigate from i to j is analogous assuming that point a is the starting point and i is the end point at point a the heading is 0 and the angle between the heading direction of point a and the line connecting point a to point i is calculated to be more than 90 which indicates case b needs to be conducted at point a and the rudder angle is 35 at point a passing through the trajectory unit from point a to point b the position and heading of point b through f1 f2 f3 and f4 is calculated when the usv reaches point b the angle between the heading direction of point b and the line connecting point b to point i is calculated to be less than 90 at this time case a needs to be conducted and the trajectory unit information from point b to point c is calculated by f1 f2 f3 etc the remaining points d e f g h and i are analogous when the distance from point h to i is shorter than a certain error distance r dc it is considered that the usv has reached the point i 5 4 complexity of algorithm analysis the search time of the usv motion planning method based on topological relationship depends only on the number and shape of obstacles related to the search assuming that there are n obstacles on the map the number of total vertexes of the n obstacles is m if all obstacles are calculated the complexity is o n at this time according to algorithm 1 however on the map only m1 points of n1 obstacles are related to the path search from the starting point to the end point in which the numbers of n1 and m1 are far smaller than those of n and m respectively this filtering operation can be implemented through an envelope query based on a spatial index structure meanwhile the algorithm complexity of constructing the map is o n1 in the process of constructing the shortest path the map constructed by algorithm 1 is combined with dijsktra algorithm to search the shortest path the complexity of dijsktra algorithm is o m12 in the stage of motion planning assuming that there are m2 points in the path the complexity of the algorithm 3 is only o m2 when there are only case a or case b if case a and case b exist at the same time then the path points are m21 and m22 respectively and the algorithm complexity is o m21 o m22 which is equal to o m2 so the final algorithm complexity is o n1 o m12 o m2 o m12 compared with zhe s method du et al 2019 which is based on grid a algorithm the algorithm time complexity will increase with the increase of the search scope to be specific the search space will increase exponentially with the search area expanding xie et al 2019 and the algorithm time constructed in this paper is mainly shown by the spatial characteristics that is as long as the spatial characteristics do not change the algorithm search time will not change no matter whether the search scope changes or not it remains unchanged within a certain range of errors 6 experimental environment and analysis in order to verify the topology map construction and the usv motion planning method proposed in this paper experiments were designed to compare the method of this paper with a algorithm and the latest method for usv motion planning du et al 2019 the method of literature is named zhe s method here respectively in this section the experimental environment and tools are firstly introduced the buffer operator is then explored because it determines the feasibility of this method cases study comparing the a algorithm zhe s method and the method here is conducted to demonstrate the advantages of the method of this paper 6 1 experimental environment and tools the simulated experiments were run in an operating environment with an i5 8400 6 core 2 80 ghz gpu 8 0g ram and operating system 64 bit win10 the java language topology toolkit jts was used to determine the topological position relationships jts is the core topological program for gis the jts program included geometry topology diagram basic algorithm index method input output linear relation intersection geometry operations floor plans polygons precision and tools in the jts geometry operation there were eight sub packets buffer distance linemerge overlap polygonize predicate relate and validate which respectively corresponded to the buffer distance line segment fusion graphic overlay polygonization assertion association of the calculated graphics and effectiveness all operations were for topological map objects defined in the geometry the buffer class in jts was used in this study to calculate the buffers the geometry entered by the buffer operation can be any category including any geometry collection the result of a buffering operation is usually an area type in addition aimed for the same experimental areas zhe s method is conducted with matlab this paper s method is conducted with java jts and matlab for route planning and motion planning respectively 6 2 parameter determination for the buffer operator the buffer operation on obstacles is important for the navigational safety and steering operation of the usv in the simulation experiments the parameters of the buffer were determined using a 4 15 m long 1 6 m wide usv normally the turning radius of the usv is 1 5 3 times the boat length lu 2006 here it is taken to be twice the boat length 8 3 m considering the safety requirements of the usv a safety margin for usv navigation is a distance of twice turning radius 11 m therefore the buffer parameter here is set to 11 m fig 18 shows details of the steering point of the usv path after the obstacle buffer operation 6 3 simulated comparison experiment in general the shape of obstacles is either concave or convex this section gives details of the path search experiments based on a free surface no obstacles convex obstacles and concave obstacles the a algorithm was used to carry out the route planning while zhe s method was used to carry out the motion planning and the results from using our methods here are compared with the results from using a algorithm and zhe s method respectively in fig 19 the yellow box shows the simulated waters about 1 3 km 1 km in wuhan east lake the grid map resolution is 20 m in zhe s method if the distance between the grid lines is too large such as 100 m many obstacles will not be shown and an accurate path search cannot be performed on the other hand a small distance between the grid lines such as 5 m will lead to no rotation of the rudder and no movement of the usv in this experiment the 20 m resolution is appropriate for the specific conditions of the experiment 6 3 1 route planning comparison 6 3 1 1 experiment a convex obstacle fig 20 shows the path from the a algorithm in a convex obstacle environment the red area represents the obstacle the path in this case was 499 m long fig 21 shows the path from the tpr search method the path was 471 m long fig 22 shows a comparison of the paths the green line is the tpr path the blue line the path from the a algorithm 6 3 1 2 experiment b concave obstacle fig 23 shows the usv path from the a algorithm in a concave obstacle environment the path length was 573 m fig 24 shows the tpr path the path length was 535 m fig 25 shows a comparison of the paths the tpr method for usv route planning was clearly better in both experiments than the a algorithm the path was shorter and smoother route planning without considering the dynamics constraints of the usv is unlikely to be realistic therefore we next include the actual rudder effects headings and obstacle avoidance in the process of usv motion planning for a more realistic result 6 3 2 motion planning comparison in figs 26 34 the initial headings are the same 0 6 3 2 1 experiment a free water fig 26 shows the usv path from zhe s method in free water the path length was 629 m fig 27 shows the tpr motion planning path the path distance was 480 m fig 28 show a comparison of the two paths in free water 6 3 2 2 experiment b convex obstacle fig 29 shows the usv path from the zhe s method in a convex obstacle environment the path length was 722 m fig 30 shows the tpr motion planning path the path length was 505 m fig 31 shows a comparison of the paths 6 3 2 3 experiment c concave obstacle fig 32 shows the usv path from zhe s method in a convex obstacle environment the path length was 796 m fig 33 shows the tpr motion planning path the path length was 563 m fig 34 shows a comparison of the paths the usv route planning path based on a algorithm and motion planning path based on zhe s method included many twists for the following reasons firstly the path had only definite directions rather than total probability of searching and it may not be the shortest and smoothest path secondly the a algorithm and zhe s method have a problem with partial optima which may lead to a non optimal result the usv motion planning path based on tprs did not have such problems although it also considered the steering restraint at the motion planning stage but did not have a grid restraint therefore it can search the path for objectives directly this method also simplified the searching space avoided the problem of partial optima and reduced the searching time it also gave shorter and smoother paths 6 4 analysis of simulated experiments 6 4 1 comparison of search time a comparison of zhe s method motion planning search times and the tpr motion planning search times in certain same search areas certain same obstscle environments is shown in table 5 fig 35 shows the search time as a function of search range when the search range was less than 1200 m the search time for zhe s method was shorterthan that for the tpr method this was reversed when the search range was more than 1200 m moreover with an increase in the search range the search time of zhe s method gradually increased but the tpr search time remained almost unchanged the tpr search time depends only on the number and shape of the obstacles in the search range in summary the search time of the tpr method does not change if the number and shape of the obstacles in the search range do not changed however the search time of zhe s method will gradually increase as the search range increases 6 4 2 comparison of search distance fig 36 shows the motion planning path distances in the free water environment the convex obstacle water environment and the concave obstacle water environment for the two methods in all cases the tpr path distance was shorter than that from zhe s method the tpr method avoids the search path falling into local optima a problem with zhe s method 6 5 practical experiments here an actual usv was used to test the tpr method against zhe s method 6 5 1 the usv environment fig 37 shows the inav iii usv used in the experiment its parameters are shown in table 6 the distance between the twin propellers was 0 4 m during the experiment the wind speed was 3 5 5 8 m s since wind and waves were not considered in the motion planning the path lengths obtained from the actual usv experiment and from the simulation experiment differed by about 1 m during the experiment the speed of the usv was about 1 m s the obstacle buffer in the experimental environment was set to 5 57 m the pd control mode was used in controlling the usv navigation in the practical experiments the pd speed control command parameters were p 3 0 and i 1 5 6 5 2 practical experiment fig 38 shows the site of the practical experiments fig 39 the environment fig 40 shows the experimental trajectories obtained using the tpr method proposed in this paper and zhe s method the tpr method was again better in motion planning for the usv 7 conclusion in this paper a novel usv motion planning method based on topological position relationships tpr is proposed with this method a topological position map is constructed which simplifies the search space and overcomes the problems of falling into local optima and long search time furthermore a dynamic model of the usv is introduced to establish the trajectory unit model thus the trajectory planning problem is discretized a two step search strategy is proposed in this work first the graph search dijsktra algorithm is used for the path search through which a global optimal path is obtained then an ingenious motion search algorithm is designed based on the global path and the trajectory units and thus a comprehensive and accurate motion plan is achieved in which the rudder angle and heading angle of each trajectory unit and path points are listed simulation results show that the tpr algorithm search time depends only on the number and shape of obstacles in the search area through numerical simulations and field tests the effectiveness of the formulated model and algorithm is verified the search speed is faster and the resulting path is shorter smoother and hence more conducive to ship navigation therefore the usv tpr motion planning method is suitable for usv motion planning and is of good prospects in practical application however the influence of wind waves and current in usv motion planning and the posture control of the usv is temporarily put aside which could be studied further in future work acknowledgements the authors wish to sincerely thank the editors and three anonymous reviewers for their constructive comments and suggestions this work is supported by the national key r d program of china no 2018yfc1407405 2018yfc0213904 the national natural science foundation of china no 51679180 51579204 41801375 51709218 funding of the state key laboratory of surveying mapping remote sensing and information engineering of wuhan university no 17i03 natural science foundation of hubei province no 2016cfb362 
22076,this paper investigates the motion planning problem for an unmanned surface vehicle usv in which the goal is to find the shortest search time the shortest path in navigational waters all subject to collision avoidance and usv dynamics constraints a new motion planning method is proposed based on topological position relationships tpr to achieve this solution firstly the tpr of the obstacles and the usv are constructed based on the spatial distribution of the obstacles this gives an overall topological navigation map which is different from the usual grid based map secondly a numerical model of unit decomposition is built to constrain the dynamics of the usv so that the motion of the usv better fits the exact situation motion planning in this study is achieved by combining the topological navigation map and a numerical model of the usv finally numerical simulations and field tests verify the effectiveness of our formulated model and proposed algorithm keywords unmanned surface vehicle usv motion planning topological position relationships tpr motion model 1 introduction unmanned surface vehicles usvs have received increasing attention in the last few years due to the development of relevant technologies heo et al 2017 campbell et al 2012 usvs are not subject to anthropic factors such as overwork or emotional change svec et al 2012 they can be used in dangerous environments such as in water quality monitoring and measurement yang et al 2018 in rescues shafer et al 2008 wilde and murphy 2018 nadj et al 2015 in target tracking norgren et al 2015 cong et al 2019 and in surveillance junglak 2014 they are widely used in commercial and military applications liu et al 2016 path planning for a usv is key to usv development as it determines the efficiency and stability of the usv janis and bade 2016 singh et al 2018 bibuli et al 2018 ma et al 2018 path planning can be split into three stages route planning trajectory planning and motion planning du et al 2018a song et al 2019 the first route planning regards the usv as a point in this stage speed and dynamical constraints are not considered shiozawa 2016 the second stage trajectory planning consider the shape and part dynamic constraints of the usv lekkas 2014 the third stage motion planning considers the overall dynamic constraints of the usv liang 2010 in the route planning stage chen 2013 combined the ant colony algorithm with the dijkstra algorithm to obtain an optimal search path for a rescue ship in a search and rescue operation xie et al 2015 solved for the path in the usv cruising problem in very complex situations based on a combination of the dijkstra algorithm dijkstra 1959 and the artificial potential field algorithm and found a safe path for the usv in a dynamic environment thanapong et al 2014 combined the grid based a algorithm hart et al 1968 and multi beam forward looking sonar technology to search for the optimal usv path in real time du et al 2018b used a complexity map combined with the a algorithm for obstacle avoidance route planning under condition awareness of the usv however the time complexity of the above methods increased with an increase in the search range and if the dynamical constraints of the usv had been considered in path planning the results may have come closer to the actual optimal trajectory of the usv in the trajectory planning stage lazarowska 2015 devised a trajectory plan that avoided obstacles during navigation using the ant colony optimization algorithm in a dynamic environment they also developed an obstacle detection and avoidance system based on this method however sometimes uncertainty in the ant colony algorithm path search interferes with exploration of the optimal path thakur et al 2011 simulated a trajectory plan for a usv using a gpu based state transition model in complex sea conditions wang 2016 studied dynamic and kinematic models of usvs then simplified them according to the characteristics of the usv path and proposed the usv three degrees of freedom motion model on a water surface and verified the path using simulation kularatne et al 2018 aimed at path planning for saving usv energy in time varying flows and proposed an adaptive planning algorithm in which they designed a adaptive graph by considering the velocity of time varying flows however the fully dynamical constraints of the usv could have been ignored the results would have been more convincing had this been taken into account in the motion planning stage du et al du et al 2018a carried out usv motion planning by establishing a trajectory unit and considering the dynamical requirements of the usv combined the a algorithm with the dynamic constraint trajectory unit they considered the dynamical constraints of the usv and based on literature du et al 2018a they improved the trajectory unit and search method and proposed a better method for usv motion planning du et al 2019 however the path from their search method was not optimal in the case of more than one obstacle and their algorithm search time would become very large as the search range expanded the results would be better if he could give further consideration to the optimal path and search time zhuang et al 2011 achieved usv motion planning that avoided obstacles under sea navigation rules by using a relative coordinates method however the method mainly focused on the navigation rules and the collision avoidance path may not be optimal escario et al 2012 proposed a motion planning method for ship manoeuvers based on the ant colony algorithm and obtained optimal trajectories however the results may remain uncertain and the results would be more reasonable if the search time had been considered path planning methods for other vehicles such as the space maneuver vehicles smvs unmanned aerial vehicles uavs and the ground vehicles have also been proposed in recent years for example in term of smv trajectory planning chai et al 2017 proposed a method for smv trajectory planning by harnessing a three layer hybrid algorithm firstly they presented an initial guess generator to evaluate the reference trajectory via v based adaptive differential evolution algorithm secondly they came up with a new gradient based algorithm which was regarded as the inner solver including a gradient based optimizer and mesh tolerance to optimize the trajectory and enhance the trajectory more smooth furthermore chai et al 2018 designed an ms based multiple shooting nsga iii non dominated sorting genetic algorithm iii in order to deal with the smv multi objective trajectory optimization problem in addition chai et al 2019 proposed a convergent approximation approach to address nonlinear trajectory optimization problems in the presence of probabilistic constraints in term of uav path planning chakrabarty and langelaan 2013 constructed a kinematic tree path planner to cope with the uav path planning in a complex environment with varying space and time as for the ground vehicle jinghui et al 2019 proposed a dynamic vehicle specific routing model that can be used in on board navigation systems the model is created through a novel link cost function which integrates the conventional and electric vehicles model and it is well adaptive to ground vehicle eco routing planning however the navigational environment of the usvs is far more complex compared with the smvs the uavs and the ground vehicles apart from the interference of wind wave and current the usv s inertia the resistance and the response time on waters are also more complex than those in the air and on the ground to some extent fossen et al 2017 zhang et al 2015 the control and path planning of the usvs is harder than the smvs the uavs and the ground vehicles in some environments in the above literature usvs had either a partial optimum problem or a long search time problem or the problem of not considering usv dynamics constraints the combination of usv path planning and constraints of dynamics will be very important in future research in this study usv motion planning is developed based on topological position relationships to solve the above problems the topological position relationship tpr method is a method in geographic information space which is mainly used for the analysis of spatial information and simplified search space by topological relationship however at present there is no usv motion planning related to tpr in the literature this paper proposes a method of motion planning for usvs based on tpr and usv dynamics according to the process of planning the motion planning can be divided into three steps environment model search algorithm and dynamic model firstly based on tpr we construct an environmental model to assist the search algorithm secondly to make our method easier and more practical and to prove our method s search performance we choose the dijsktra algorithm as the search algorithm which is a classical and practical algorithm finally we combine the environmental model search algorithm and usv dynamics to achieve better motion planning for an usv this paper is organized as follows section 2 outlines the map expression based on tpr and describes in detail the map element expression spatial relationships and tpr tpr terminology and the topology path reachable definition the structure and implementation of the tpr algorithm are discussed in section 3 section 4 briefly introduces the mathematical model for usv motion the structure and implementation of the motion planning algorithm are discussed in section 5 simulation and experimental results are presented in section 6 section 7 is the conclusion 2 map expression based on topological position relationships the usv path search is conducted in navigable waters with obstacles the objective is to plan and optimize a navigable path from the starting point to the end point in order to speed up the search the search space is simplified in this study using topological position maps the main parts of the topology map are the map representation the topological position relationships and the map construction 2 1 map element expression the open geospatial consortium ogc defines a simple feature model for storing and accessing geographic features in relational databases in its simple element access specification open geospatial consortium simple feature access part 2 sql option open gis implementation specification for geographic information open geospatial consortium ogc 2010 points lines and surfaces are the three elements that make up a space map point elements do not have spatial features such as shape and size line elements are composed of a series of points and their spatial features include shape and length surface elements are represented by polygons consisting of closed linear rings and their spatial features includes shape and area in this paper the starting and end positions of the usv are points the planned path is a line and the navigable waters and the obstacles are polygons as shown in table 1 2 2 spatial relationship and topological position relationship spatial relationships between geographic entities consisting of topological relationships directional relationships and metric relationships are the basis of spatial data organization query analysis and reasoning topological position relationship tpr refers to the mutual relationship between spatial objects that satisfies the principles of topological geometry points lines and polygons represent the adjacency association inclusion and connectivity relationships between geographic entities such as point to point adjacenct relationships point to polygon inclusion relationships line to polygon separation relationships and polygon to polygon coincidence relationships tprs can be used to reduce spatial computational complexity accelerate spatial query speed and improve spatial analysis accuracy many researchers have proposed a number of tpr expression models for example chen et al 2015 proposed an expression model of the tpr of composite planar objects which expressed the detailed tpr between composite planar objects and improved and expanded the expression ability of the classical nine intersection model cao et al 2016 proposed an integrated representation model of a linear relationship based on the concept of meta topology in which an analysis and classification of simple topological relations of lines and polygons and a composite topology integration expression method with complex faces was studied ouyang et al 2009 used an extended nine intersection model to extend the elements of the nine intersection matrix into binary codes and proposed a d nine intersection model long and li 2013 used a boolean matrix to completely classify spatial relationships using voronoi s 9 cross model relationship between any two spatial entities in order to further this research people are constantly seeking better tpr expression models ogc recommends the four intersection and nine intersection models the boundary of the defined object is represented as the inside of the object is represented as the outside of the object is represented as and the intersection of two objects is represented as the four intersection model considers tpr of the boundary and the inside of the point set the nine intersection model considers the outside of the point set on the basis of the four intersection model and its expression ability is stronger the nine intersection model expresses the tpr m as the matrix 1 m a b a b a b a b a b a b a b a b a b for the spatial tpr of lines and polygons the nine intersection model can theoretically express 512 possible cases but only 19 cases are actually available in fact spatial relationships between lines and polygons are infinite because the number of points involved in the intersection of lines and polygons is uncertain and can be any positive integer 2 3 tpr terminology based on the nine intersection model ogc defines eight common relational terminologies in its simple element access specification including crosses disjoint within contains equals touches intersects and overlaps the tprs used to construct topological position maps in this paper are mainly intersects disjoint touches and contains meanings are shown in table 2 in the case of two objects a and b in space when the point set of their intersection is null ϕ then denoted as f when it is non empty ϕ then denoted as t further when the intersection is a point then denoted as 0 when a line denoted as 1 wheb an area denoted as 2 denoted as means the value could be f 0 1 or 2 2 4 topology path reachable definition in the path searching whether two points any two points in free space two points of connection between obstacles or two points of connection between obstacle and usv are reachable practicable topology path is a key issue and needs to be clearly expressed in the map whether a path is reachable is determined by the tpr between the path and the obstacles based on the nine intersection model the relationship terminologies are divided into five relationship sets they are crosses within contains equals touches overlaps and disjoint zhu et al 2011 in this paper considering the tpr between a path and an obstacle relationship sets touches and disjoint are generally defined as reachable and the relationship sets crosses within contains equals and overlaps are defined as unreachable representative cases of the reachable or not conditions are shown in table 3 3 topological position map construction map feature representation tpr terminologies and topological path reachability are the core components of building a final topology map building a topological position map based on section 2 is the basis of usv motion planning algorithm 1 shows the topology map construction set the euclidean distance between any two points u x u y u and v x v y v to d u v where 2 d u v x u x v 2 y u y v 2 firstly the position data for the starting point s and end point e the number of obstacles n and the position of each obstacle side point set np are read in the initial state it is assumed that there is only one path segment candidate se on the topology map secondly the obstacles are selected one by one according to the topology path reachable definition in section 2 4 the positional relationship between each obstacle and the path segment candidate is determined consider the i th obstacle if the line segment se is separated from the obstacle then the line is a reachable path and the path distance is calculated according to eq 2 if the line segment se does not intersect internally with the obstacle it is a reachable path and the path distance is again calculated according to eq 2 otherwise it is an unreachable path and the path distance is set to ach edge of the i th obstacle each line between the point s e and the obstacle edge point set are put into the path candidate set finally the reachability of each path candidate is determined and the map construction is done image 8 the starting point the end point and the obstacle map are shown in fig 1 b1 b15 are obstacles the starting point is s and the end point is e first the positional relationship between the starting point s and the end point e is determined fig 2 the connection between s and e intersects the inside of obstacle b7 which means e is unreachable the connection distance between points s and e is set to infinity second the positional relationship between the boundary point of obstacle b7 and e is determined and the connection between them found to pass through obstacles b8 and b9 the point connection between the boundary point of obstacle b7 and e is unreachable and the distance between the two points is again set to infinity the positional relationships of the boundary points of obstacles b7 b8 and b9 are determined next and the path distances between pairs of points calculated according to eq 2 the path distance between unreachable points is set to infinity finally the positional relationships between e and the boundary points of obstacles b8 and b9 is determined e is directly reachable from these boundary points after the above steps paths from the starting point s to the end point e are found it is not necessary to make other regional positional relationship judgments according to algorithm 1 fig 3 shows the paths found between the starting point and the end point a reachable path blue and an unreachable path yellow table 4 gives the distances of the reachable paths between pairs of points in the environment based on the tprs fig 4 shows the reachable path topology map obtained according to table 4 4 establishing the mathematical model for usv motion after the topological position map has been constructed the trajectory unit is used to dynamically constrain the trajectory of the usv trajectory unit is constructed based on maneuvering mathematical group mmg model ogawa 1977 du et al 2018a it is a series of track segments generated by mmg model which contains the characteristic elements of ship navigation such as rudder angle etc the usv motion model is the core part of the trajectory unit ship motion models are mainly categorized into the mmg model and the nomoto model jia and yang 1998 because the adaptation scheme of the mmg model is wide flexible and easy to modify locally for specific ship types it can succinctly express the interference effects of the hull paddle rudder the trajectory unit here is based on the mmg model and the hydrodynamic force torque is decomposed into hull paddle and rudder contributions the force on the hull is decomposed into the viscous hydrodynamic force torque and the inertial hydrodynamics torque 4 1 construction of a usv motion model based on the mmg model to simplify the problem the following hypotheses need to be made before modeling 1 during movement of the usv heave roll and pitch are ignored 2 the influence of the natural environment wind waves and current on the movement of the usv is temporarily ignored 3 only the forward rotation of the ship s main engine is considered when the usv moves stably the propeller speed remains unchanged from hypothesis 3 when the ship is moving the hull will be subject to the resistance of the water flow the load on the propeller is then increased resulting in a decrease in the rotational speed n at this point the speed controller will increase the host power to offset this increased load and maintain the original speed in the above process under regulation of the speed controller the control model can be expressed as 3 t d i e n i e n k p k n 2 π k p k n r 2 π 1 2 π t d q p q p where t d is the time constant i e the moment of inertia of the entire system k p the gain of the speed controller n r the command speed k the gain from the main drive rod to the torque output and q p the propeller absorption torque therefore the three degrees of freedom motion model of the usv under surging x swaying y and yawing n can be expressed as 4 x y n x i x h x p x r y i y h y p y r n i n h n p n r where i h p and r are the forces torques generated respectively by inertia the viscosity the propeller and the rudder 4 1 1 inertia model the ship will cause disturbance of the surrounding fluid during its motion so that the fluid acquires additional momentum momentum moment the inertia model is given by eq 5 where m x and m y are additional masses in the x and y directions α x is the x coordinate of m y relative to the center of gravity and j zz is the inertia acting in the z direction k x and k y are the additional momenta u and v the speeds in the x and y directions respectively and r is the yaw rate the differential force in the corresponding direction is the inertial force of the fluid 5 x i y i n i d k x d t x d k y d t y d i z d t y m x u m y v r m y α x r 2 m y v m x u r m y α x r j z z r m y α x v u r m y m x u v 4 1 2 viscosity model the viscous fluid dynamic forces and moments experienced by the ship are related to the hull geometry the motion of the ship and the physical properties of the fluid when the ship s shape and the fluid are stable the viscous power and torque on the hull depend mainly on the current motion state of the ship u v r equation 6 is the viscous model x u is the direct resistance of the ship x vv v 2 x vr vr x rr r are the viscous drag caused by the movement of the ship in the fluid medium y v v y r r and n v v n r r are the linear transverse hydrodynamic forces and torque respectively generally when a ship moves in a fluid medium the magnitude of the drift angle has a great influence on the viscous forces and moments on the hull since this paper does not consider the influence of wind waves and current on the ship no drift angle will be considered during the motion 6 x h y h n h x u x v v v 2 x v r v r x r r r y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 4 1 3 propeller model the propeller is the main driving force of the ship while providing thrust the propeller also produces lateral forces torque however the effect of the lateral forces is negligible compared to the effect of the rudder the propeller model is given by eq 7 t p the thrust derating factor thrust deduction j p the forward speed coefficient a i i 0 1 2 are regression coefficients and w p is the corresponding flow coefficient the thrust generated by the propeller is related to the diameter of the propeller disk surface d p the rotational speed n and the fluid density ρ the propeller model can be expressed as 7 x p y p n p 1 t p ρ n 2 d p 2 a 0 a 1 j p a 2 j p 2 a 3 j p 3 a 4 j p 4 1 w p u n d p 0 0 4 1 4 rudder model the rudder model is the most important part of the overall model it determines the direction of the ship s motion and further determines the ship s trajectory generally the positive pressure of the water flow on the rudder is decomposed into longitudinal resistance a lateral transverse force and a steering torque according to three degrees of freedom as shown in the rudder model eq 8 with δ the rudder angle t r the resistance reduction coefficient a h a correction factor x h the longitudinal distance from the force point of the rudder to the center of gravity of the ship u r the effective speed of the fluid at the rudder a r the effective rudder area α r the effective angle of attack and f a the gradient of lift force the rudder model can be expressed as 8 x r y r n r 1 t r 1 2 ρ a r f a u r 2 sin α r sin δ 1 a h 1 2 ρ a r f a u r 2 sin α r cos δ x r a h x h 1 2 ρ a r f a u r 2 sin α r cos δ in order to facilitate control of the ship to obtain the required trajectory it is also necessary to establish a control model of the rudder equation 9 gives the rudder control model with δ e the command rudder angle and t e the time constant which is about 2 5 s 9 t e δ δ e δ δ 35 δ 3 s 4 2 usv trajectory discretization rules discretization rules are the key to generating trajectory elements appropriate rules can not only reasonably discretize the planning space but also facilitate the path search and enable the discrete trajectories to maintain the continuity of the final trajectory after splicing based on the above considerations and literature du et al 2019 this paper proposes three rules rule 1 at the beginning and end of the trajectory the usv s motion state is stable and consistent at the beginning and end of the trajectory segment in order to maintain continuity after the discrete track segments are spliced it is feasible to make the usv s motion state stable and consistent at the beginning and end of the trajectory segment rule 2 there should be only one rudder per trajectory a unit is an indivisible quantity so the track segment in a unit should be as simple as possible the criteria for judging the complexity of the trajectory are the number of turns of the usv and the number of rudders the number of rudders of a track segment should be small otherwise the spliced track will generate a large number of turning points which is obviously not appropriate in practical applications this rule requires only one rudder during generation of a trajectory segment rule 3 the straight line length of each track is equal in order to standardize the trajectory unit and to solve the optimized path more easily each track or segment in a trajectory should have the same length r trajectory segments are shown in fig 5 oa ob r 4 3 unit decomposition library the unit decomposition library is composed of trajectory units different trajectory units are generated by changing the heading and rudder angle of the trajectory unit in fig 6 the initial heading is 0 the rudder angle generates a family of curves of the trajectory unit in steps of 6 from 35 to 31 in fig 7 as the rudder angle is changed in steps of 6 from 35 to 31 the heading changes from the initial angle of 0 360 in steps of 30 in fig 8 the heading is changed in steps of 20 from 0 to 360 and in fig 9 from 0 to 360 in steps of 10 figs 7 9 show a unit decomposition library consisting of an initial heading from 0 to 360 with a 30 heading a 20 heading and a 10 heading the rudder angle and heading intervals can be smaller down to 1 or 2 the complete unit decomposition library can now completely cover any angle heading search from 0 to 360 5 planning algorithm the planning algorithm is divided into two steps the first step is to solve for the optimal path the second step is to determine the specific motion planning solution for the path according to the optimal path in the first step of the solution process this paper differs from the traditional grid map path planning xie et al 2019 mohanty and parhi 2013 in that it is based on the spatial distribution characteristics of obstacles it analyzes the spatial tprs between obstacles and the usv and it constructs a global spatial topological navigation map using the dijkstra algorithm thus it finds the optimal path and effectively avoids a path selection that is trapped at a local optimum the second step mainly solves the problem how to operate the usv to reach the end position and considers the usv dynamic constraints on the optimal path so as to carry out more precise motion planning for the usv information such as heading position and rudder angle is used to make the usv reach the end position more accurately 5 1 usv optimal route planning algorithm algorithm 2 is an algorithm for path selection using the dijsktra algorithm to calculate reachable paths based on tprs first the reachable path point list ps as a set ps list includes p points determined from the tprs is read and the positional relationship data of the starting point s and the end point e are set the distances du j between all the points in the reachable point set v and all the points in the unreachable point set u are calculated choose the smallest distance du i and denote the corresponding point in u as p i add the p i position data to v continue until num p to end the search and calculate the path from the above calculation the shortest path from the starting point s to the end point e fig 5 is obtained fig 10 shows the shortest path map based on the topological map solution the green line in fig 10 shows the shortest path s b74 b73 b91 e with length 3 100 2 100 3 100 4 100 m 1200 m image 9 5 2 safety margin and ship turning radius in most cases usvs are under actuated systems that cannot move exactly as planned considering that there need to be small deviations from the optimal ship s path a margin of safety should be built into the path it is also necessary to consider the turning radius of the ship a safety margin is achieved by expanding the boundaries of obstacles used in the calculations beyond the actual boundaries leaving some water as a safety buffer for the ship and the safety margin can be adjusted according to different requirements in the spatial analysis this operation is called a buffer operation buffer the buffer radius for the usv is chosen and a larger turning radius of the ship than the actual radius used to ensure safe navigation after the buffer operation for an obstacle it is still a simple element as described in section 2 1 and hence does not affect the implementation of the topology map construction and the efficient path search given a certain safety margin and the ship s turning radius the usv cannot safely sail between the obstacles b9 and b8 that is it cannot sail past the point b91 the shortest path found in section 5 1 then does not meet navigation requirements and the next shortest navigable path must be found the green line in fig 11 shows this path the new path is s b74 b73 b92 e with length 3 100 2 100 3 100 4 3 100 1230 m according to table 4 in order to simplify the calculation in this example the safety margin and the ship s turning radius are not considered in the length calculation of the shortest path 5 3 motion planning for the usv in order to determine specifically how to steer the ship from the starting point to the end point along the shortest path the dynamic constraints are taken into account based on the tprs by the trajectory unit it determines the headings rudder angles and position of each point on the path to achieve accurate motion planning for the usv algorithm 3 shows the usv motion planning algorithm image 10 1 from the unit decomposition library analysis the relationship f1 between the heading angle ψ to the next node and the rudder angle δ is given by f1 ψ a 1δ3 b 1δ2 c 1δ d 1 2 the relationship f2 between the central angle α and the rudder angle δ obtained from the unit decomposition library analysis in section 4 3 is given by f2 α a 2δ3 b 2δ2 c 2δ d 2 3 as shown in fig 12 the relationships f3 between the position coordinates of points c x c y c d x d y d and the central angles y o c y o d are f3a x c x o r sin y o c y c y o r cos y o c f3b x d x o r sin y o d y d y o r cos y o d the other cases are analogous fig 13 shows the heading angle ψ central angle α and path point coordinates combined with the above analysis the problem of usv motion planning is divided into two cases case a one transformation trajectory unit fig 14 shows a schematic diagram of the one transformation trajectory unit with s the starting point coordinates x s y s and e the end point coordinates x e y e when the absolute value of the angle c between s and e is less than 90 only one trajectory unit transformation is needed the heading angle is calculated at s assuming the initial heading angle at s is true north 0 point n is a node and the path reaches e after passing through n the coordinates of n x n y n are given in terms of the central angle a by 15 x n x s r sin a y n y s r cos a the point n heading angle b can be calculated from the coordinates of e and n as 16 b arctan x e x n y e y n from the relationships f1 and f2 find the relationship f4 between the central angle a and the heading angle b to node n b f a where f4 f a arctan x e x s r sin a y e y s r cos a the central angle a value of the angle c between s and e is known the rudder angle δ and other values and the heading angle b can be obtained from the relationships f1 f2 f3 and f4 at this point the heading angle from point n to point e has been obtained the rudder angle corresponding to point n is obtained from relationship f1 between the rudder angle and the heading angle point e can be directly reached with the rudder angle calculated at point n case b two transformation trajectory unit when the angle between the current point and the end point is greater than 90 or less than 90 the rudder angle is at its maximum value of 35 or its minimum value of 31 respectively then the actual heading to the next node is obtained from the relationship f1 between the rudder angle and the heading angle when the absolute value of the angle between the current point and the end point is eventually less than 90 the solution is continued according to case a fig 15 shows a schematic diagram of the two transformation trajectory unit it is assumed that respectively s1 and e1 are the starting point and end point and n1 and m1 are intermediate nodes when the value of the angle c1 between the starting point and the end point is less than 90 two trajectory unit transformations are needed the first trajectory transformation uses minimum rudder angle 31 when the value of the angle c1 between the starting point and the end point is more than 90 two trajectory unit transformations are needed the first trajectory transformation uses maximum rudder angle 35 and then calculating point n1 the central angle rudder angle and position according to f1 f2 f3 as shown in fig 15 when the absolute angle e1 between n1 and the end point is less than 90 fig 15 and then turn to case a finally the two trajectory unit transformation is complete to be specific the next calculation is also shown in fig 15 and refers to the situation of case a the specific calculation process is as follow 18 c 1 arctan x e 1 x s 1 y e 1 y s 1 if c1 90 the trajectory unit needs to transform twice turn the maximum rudder angle 31 from s1 to n1 the coordinates of n1 heading angle and central angle a1 can then be obtained from f1 f2 f3 according to the central angle a1 between point s1 and point n1 the position coordinates of n1 is obtained as follow 19 x n 1 x s 1 r sin a 1 y n 1 y s 1 r cos a 1 then the angle e1 between n1 and e1 is 20 e 1 arctan x e 1 x n 1 y e 1 y n 1 if 90 e1 90 the trajectory unit needs to transform only once similar to the situation of a one transformation trajectory unit case a according to case a the heading angle d1 rudder angle and the next position point m1 are obtained and finally the end point e1 is reached fig 16 is a schematic diagram of the situation of one transformation trajectory unit and two transformation trajectory unit at this time it is assumed that the heading is true north upward 0 the black line indicates the case of one transformation trajectory unit at an angle between 90 and 0 at the current point and the target point the red line indicates the case of one transformation trajectory unit at an angle between 0 and 90 at the current point and the target point the blue line indicates the case of two transformation trajectory unit at an angle between 90 and 180 at the current point and the target point the light green line indicates the case of two transformation trajectory unit at an angle between 90 and 180 at the current point and the target point after determining the path points according to the tprs the dynamic constraints of the relevant path points and the corresponding headings rudder angles and path point position coordinates are given the dynamic constraint between each line segment is carried out by the trajectory unit finally after given the starting point and heading angle the corresponding rudder angle etc the problem of how to steer to the target point can be solved an example of usv motion planning based on above methods is illustrated in fig 17 firstly the map and route points such as point a point i and point j are obtained by algorithm 1 and algorithm 2 and then how to steer the usv is calculated by algorithm 3 in the calculation process of algorithm 3 how to navigate from point a to i is calculated firstly and then i to j the following describes how to steer the usv from a to i how to navigate from i to j is analogous assuming that point a is the starting point and i is the end point at point a the heading is 0 and the angle between the heading direction of point a and the line connecting point a to point i is calculated to be more than 90 which indicates case b needs to be conducted at point a and the rudder angle is 35 at point a passing through the trajectory unit from point a to point b the position and heading of point b through f1 f2 f3 and f4 is calculated when the usv reaches point b the angle between the heading direction of point b and the line connecting point b to point i is calculated to be less than 90 at this time case a needs to be conducted and the trajectory unit information from point b to point c is calculated by f1 f2 f3 etc the remaining points d e f g h and i are analogous when the distance from point h to i is shorter than a certain error distance r dc it is considered that the usv has reached the point i 5 4 complexity of algorithm analysis the search time of the usv motion planning method based on topological relationship depends only on the number and shape of obstacles related to the search assuming that there are n obstacles on the map the number of total vertexes of the n obstacles is m if all obstacles are calculated the complexity is o n at this time according to algorithm 1 however on the map only m1 points of n1 obstacles are related to the path search from the starting point to the end point in which the numbers of n1 and m1 are far smaller than those of n and m respectively this filtering operation can be implemented through an envelope query based on a spatial index structure meanwhile the algorithm complexity of constructing the map is o n1 in the process of constructing the shortest path the map constructed by algorithm 1 is combined with dijsktra algorithm to search the shortest path the complexity of dijsktra algorithm is o m12 in the stage of motion planning assuming that there are m2 points in the path the complexity of the algorithm 3 is only o m2 when there are only case a or case b if case a and case b exist at the same time then the path points are m21 and m22 respectively and the algorithm complexity is o m21 o m22 which is equal to o m2 so the final algorithm complexity is o n1 o m12 o m2 o m12 compared with zhe s method du et al 2019 which is based on grid a algorithm the algorithm time complexity will increase with the increase of the search scope to be specific the search space will increase exponentially with the search area expanding xie et al 2019 and the algorithm time constructed in this paper is mainly shown by the spatial characteristics that is as long as the spatial characteristics do not change the algorithm search time will not change no matter whether the search scope changes or not it remains unchanged within a certain range of errors 6 experimental environment and analysis in order to verify the topology map construction and the usv motion planning method proposed in this paper experiments were designed to compare the method of this paper with a algorithm and the latest method for usv motion planning du et al 2019 the method of literature is named zhe s method here respectively in this section the experimental environment and tools are firstly introduced the buffer operator is then explored because it determines the feasibility of this method cases study comparing the a algorithm zhe s method and the method here is conducted to demonstrate the advantages of the method of this paper 6 1 experimental environment and tools the simulated experiments were run in an operating environment with an i5 8400 6 core 2 80 ghz gpu 8 0g ram and operating system 64 bit win10 the java language topology toolkit jts was used to determine the topological position relationships jts is the core topological program for gis the jts program included geometry topology diagram basic algorithm index method input output linear relation intersection geometry operations floor plans polygons precision and tools in the jts geometry operation there were eight sub packets buffer distance linemerge overlap polygonize predicate relate and validate which respectively corresponded to the buffer distance line segment fusion graphic overlay polygonization assertion association of the calculated graphics and effectiveness all operations were for topological map objects defined in the geometry the buffer class in jts was used in this study to calculate the buffers the geometry entered by the buffer operation can be any category including any geometry collection the result of a buffering operation is usually an area type in addition aimed for the same experimental areas zhe s method is conducted with matlab this paper s method is conducted with java jts and matlab for route planning and motion planning respectively 6 2 parameter determination for the buffer operator the buffer operation on obstacles is important for the navigational safety and steering operation of the usv in the simulation experiments the parameters of the buffer were determined using a 4 15 m long 1 6 m wide usv normally the turning radius of the usv is 1 5 3 times the boat length lu 2006 here it is taken to be twice the boat length 8 3 m considering the safety requirements of the usv a safety margin for usv navigation is a distance of twice turning radius 11 m therefore the buffer parameter here is set to 11 m fig 18 shows details of the steering point of the usv path after the obstacle buffer operation 6 3 simulated comparison experiment in general the shape of obstacles is either concave or convex this section gives details of the path search experiments based on a free surface no obstacles convex obstacles and concave obstacles the a algorithm was used to carry out the route planning while zhe s method was used to carry out the motion planning and the results from using our methods here are compared with the results from using a algorithm and zhe s method respectively in fig 19 the yellow box shows the simulated waters about 1 3 km 1 km in wuhan east lake the grid map resolution is 20 m in zhe s method if the distance between the grid lines is too large such as 100 m many obstacles will not be shown and an accurate path search cannot be performed on the other hand a small distance between the grid lines such as 5 m will lead to no rotation of the rudder and no movement of the usv in this experiment the 20 m resolution is appropriate for the specific conditions of the experiment 6 3 1 route planning comparison 6 3 1 1 experiment a convex obstacle fig 20 shows the path from the a algorithm in a convex obstacle environment the red area represents the obstacle the path in this case was 499 m long fig 21 shows the path from the tpr search method the path was 471 m long fig 22 shows a comparison of the paths the green line is the tpr path the blue line the path from the a algorithm 6 3 1 2 experiment b concave obstacle fig 23 shows the usv path from the a algorithm in a concave obstacle environment the path length was 573 m fig 24 shows the tpr path the path length was 535 m fig 25 shows a comparison of the paths the tpr method for usv route planning was clearly better in both experiments than the a algorithm the path was shorter and smoother route planning without considering the dynamics constraints of the usv is unlikely to be realistic therefore we next include the actual rudder effects headings and obstacle avoidance in the process of usv motion planning for a more realistic result 6 3 2 motion planning comparison in figs 26 34 the initial headings are the same 0 6 3 2 1 experiment a free water fig 26 shows the usv path from zhe s method in free water the path length was 629 m fig 27 shows the tpr motion planning path the path distance was 480 m fig 28 show a comparison of the two paths in free water 6 3 2 2 experiment b convex obstacle fig 29 shows the usv path from the zhe s method in a convex obstacle environment the path length was 722 m fig 30 shows the tpr motion planning path the path length was 505 m fig 31 shows a comparison of the paths 6 3 2 3 experiment c concave obstacle fig 32 shows the usv path from zhe s method in a convex obstacle environment the path length was 796 m fig 33 shows the tpr motion planning path the path length was 563 m fig 34 shows a comparison of the paths the usv route planning path based on a algorithm and motion planning path based on zhe s method included many twists for the following reasons firstly the path had only definite directions rather than total probability of searching and it may not be the shortest and smoothest path secondly the a algorithm and zhe s method have a problem with partial optima which may lead to a non optimal result the usv motion planning path based on tprs did not have such problems although it also considered the steering restraint at the motion planning stage but did not have a grid restraint therefore it can search the path for objectives directly this method also simplified the searching space avoided the problem of partial optima and reduced the searching time it also gave shorter and smoother paths 6 4 analysis of simulated experiments 6 4 1 comparison of search time a comparison of zhe s method motion planning search times and the tpr motion planning search times in certain same search areas certain same obstscle environments is shown in table 5 fig 35 shows the search time as a function of search range when the search range was less than 1200 m the search time for zhe s method was shorterthan that for the tpr method this was reversed when the search range was more than 1200 m moreover with an increase in the search range the search time of zhe s method gradually increased but the tpr search time remained almost unchanged the tpr search time depends only on the number and shape of the obstacles in the search range in summary the search time of the tpr method does not change if the number and shape of the obstacles in the search range do not changed however the search time of zhe s method will gradually increase as the search range increases 6 4 2 comparison of search distance fig 36 shows the motion planning path distances in the free water environment the convex obstacle water environment and the concave obstacle water environment for the two methods in all cases the tpr path distance was shorter than that from zhe s method the tpr method avoids the search path falling into local optima a problem with zhe s method 6 5 practical experiments here an actual usv was used to test the tpr method against zhe s method 6 5 1 the usv environment fig 37 shows the inav iii usv used in the experiment its parameters are shown in table 6 the distance between the twin propellers was 0 4 m during the experiment the wind speed was 3 5 5 8 m s since wind and waves were not considered in the motion planning the path lengths obtained from the actual usv experiment and from the simulation experiment differed by about 1 m during the experiment the speed of the usv was about 1 m s the obstacle buffer in the experimental environment was set to 5 57 m the pd control mode was used in controlling the usv navigation in the practical experiments the pd speed control command parameters were p 3 0 and i 1 5 6 5 2 practical experiment fig 38 shows the site of the practical experiments fig 39 the environment fig 40 shows the experimental trajectories obtained using the tpr method proposed in this paper and zhe s method the tpr method was again better in motion planning for the usv 7 conclusion in this paper a novel usv motion planning method based on topological position relationships tpr is proposed with this method a topological position map is constructed which simplifies the search space and overcomes the problems of falling into local optima and long search time furthermore a dynamic model of the usv is introduced to establish the trajectory unit model thus the trajectory planning problem is discretized a two step search strategy is proposed in this work first the graph search dijsktra algorithm is used for the path search through which a global optimal path is obtained then an ingenious motion search algorithm is designed based on the global path and the trajectory units and thus a comprehensive and accurate motion plan is achieved in which the rudder angle and heading angle of each trajectory unit and path points are listed simulation results show that the tpr algorithm search time depends only on the number and shape of obstacles in the search area through numerical simulations and field tests the effectiveness of the formulated model and algorithm is verified the search speed is faster and the resulting path is shorter smoother and hence more conducive to ship navigation therefore the usv tpr motion planning method is suitable for usv motion planning and is of good prospects in practical application however the influence of wind waves and current in usv motion planning and the posture control of the usv is temporarily put aside which could be studied further in future work acknowledgements the authors wish to sincerely thank the editors and three anonymous reviewers for their constructive comments and suggestions this work is supported by the national key r d program of china no 2018yfc1407405 2018yfc0213904 the national natural science foundation of china no 51679180 51579204 41801375 51709218 funding of the state key laboratory of surveying mapping remote sensing and information engineering of wuhan university no 17i03 natural science foundation of hubei province no 2016cfb362 
22077,this paper presents an optimal robust control method for trajectory tracking of a x rudder autonomous underwater vehicle auv subjects to velocity sensor failures and uncertainties two reduced order extended state observers esos are designed to estimate the surge and heave velocities and the estimated values are used to replace all the linear velocity related parameters in controller design which helps releasing the requirements of linear velocities measurement and makes the controller robust against linear velocity sensor failures in kinematics control loop line of sight los guidance law and lyapunov based control are employed and the unknown attack angle is calculated based on the estimated linear velocities in dynamics control loop a robust disturbance rejection control law is constructed using disturbance observers and modified terminal sliding mode control moreover a multi objective optimization method is proposed to achieve x rudder allocation which is not only energy efficient but also robust against rudder failures and helps tackling the rudder input saturation problem at the same time finally comparative numerical simulations are provided to demonstrate the robustness and effectiveness of the proposed approach keywords x rudder auv trajectory tracking control velocity sensor failures robust disturbance rejection control multi objective optimal rudder allocation 1 introduction due to the depletion of land resources marine development has received more and more attention and various underwater equipment have been developed in the past few decades autonomous underwater vehicle is one of the most widely used underwater equipment which has played an increasingly important role in all kinds of submerged applications such as underwater intervention zhang et al 2015 monitoring and inspection zhang et al 2018a target tracking shojaei and dolatshahi 2017 and oceanographic surveys wynn et al 2014 etc to better accomplish the afore mentioned submerged tasks the following two basic ideas have been applied to improve the vehicle s performance 1 design effective control systems to steer the auvs accurately and reliably in the harsh marine environment 2 design new actuators such as rudders thrusters etc to improve the vehicle s capability with the thought of second kind various kinds of rudders have been applied to auv to improve the maneuverability such as cross rudder h type rudder and x type rudder zhang et al 2017 etc compared with traditional cross rudder auv the x rudder auv has much better maneuverability and flexibility since the four rudders can be operated independently however the control of the x rudder auv is more complicated than cross rudder auv and is not often studied in the existing literatures for this reason trajectory tracking control of a x rudder auv will be discussed in this paper trajectory tracking control of marine vehicles has been widely studied in recent years xia et al 2019a yu et al 2019a shen et al 2018 zhang et al 2019 al makdah et al 2019 in qiao et al 2017 three exponentially convergent robust controllers namely the min max type controller the saturation type controller and the smooth transition type controller were proposed to drive an auv to track a predefined trajectory in von ellenrieder 2019 an n degree of freedom nonlinear control law was proposed for the trajectory tracking of marine vehicles that operate in the presence of unknown time varying disturbances input saturation and actuator rate limits using a disturbance observer and nonlinear dynamic surface control an adaptive ilos guidance law was proposed for unmanned msvs in zheng and sun 2016 which introduced rbfnn to deal with the time varying ocean currents in yu et al 2018 line of sight los guidance was built for the robust magnetic tracking of subsea cable by an auv in the presence of sensor noise and ocean currents in miao et al 2017 an improved compound line of sight clos guidance law was proposed for path following control of auv which can estimate the unknown sideslip angle and compensate for the effects of time varying ocean currents in chen et al 2019 an adaptive trajectory tracking control algorithm was proposed with guaranteed transient performance which employed neural networks to approximate the unknown external disturbances and uncertain hydrodynamics most of the above studies are based on the assumption that all the motion states of auv are measurable however sensor failures may occur to auv considering the complex underwater environment in these cases the conventional control methods may not work state observer based control methods can provide effective solutions for such conditions yu et al 2019b proposed an improved extended state observer based line of sight elos guidance law which estimated the surge and sway linear velocities and compensated for the unmeasured side slip angle but the estimated velocities were only utilized in kinematics control and not applied in dynamics control an output feedback path following control method was proposed in peng and wang 2018 for under actuated autonomous underwater vehicles moving in a vertical plane without using surge heave and pitch velocities in li et al 2019 a finite time extended state observer based fault tolerant output feedback control was proposed for the rigid spacecraft attitude control system without the angular velocity measurements in the presence of external disturbances and actuator failures in liu et al 2019 the state recovery and disturbance estimation problems of unmanned surface vehicles were addressed in the presence of unknown disturbances as well as unmeasured surge sway and yaw velocities motivated by the existing methods extended state observers esos are proposed to estimate the surge and heave velocities in this paper and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed without requirements of linear velocity measurement complex unknown external disturbance is an important issue of trajectory tracking which could affect the model accuracy and degrade the closed loop system performance wang et al 2013 2018 to solve this problem the control system should have good robustness the commonly used robust control methods include but not limited to sliding mode control guo et al 2019 h infinity control zhang et al 2018b model predictive control li and yan 2017 neural network control xia et al 2019b optimal control li et al 2018 multi agent xiao et al 2018 etc of all the robust control methods sliding mode control is a widely used robust control technique which has shown excellent tracking performance due to its robustness against the uncertainties and disturbances van 2019 in qiao and zhang 2017 an adaptive non singular integral terminal sliding mode control anitsmc scheme was proposed for trajectory tracking of autonomous underwater vehicles auvs with dynamics uncertainties and time varying external disturbances in xu et al 2015 sliding mode control and backstepping technique were combined to design a robust trajectory tracking controller for an auv with parameter uncertainties and external disturbances qiao and zhang 2019 proposed an adaptive second order fast nonsingular terminal sliding mode control asofntsmc scheme for the trajectory tracking of fully actuated autonomous underwater vehicles auvs in the presence of dynamic uncertainties and time varying external disturbances however chattering problems are often encountered for sliding mode control to guarantee control robustness and avoid chattering a robust disturbance rejection control law is constructed in this paper based on disturbance observers and modified terminal sliding mode control actuator dynamics is another technical challenge for trajectory tracking control the commonly considered actuator dynamics include input saturation input delay etc which may influence the stability of the control system and even make the entire system unstable many efforts have been made to tackle these problems in recent years an anti windup compensator was proposed in cui et al 2016 to solve the problem of attitude control subjected to actuator saturation novel auxiliary systems were proposed in chu et al 2018 to deal with the input saturation based on which an adaptive fuzzy sliding mode controller was developed for the diving control of auv to eliminate the control input nonlinearities adaptive neural network control was proposed in cui et al 2017 for auvs using reinforcement learning in peng et al 2019 a reference governor was used for generating the optimal reference signals within the state and input constraints based on which the guidance loop and the control loop were bridged in sarhadi et al 2016 an adaptive autopilot was presented for the pitch and yaw channels of an auv in presence of input saturations which employed model reference adaptive control with integral state feedback and anti windup compensator however most of the above studies are designed for the cross rudder auv which cannot solve the single input and multi output simo rudder angle distribution problem faced by the x rudder auv to solve this problem a multi objective optimization method is proposed in this paper which considers the problem of torque distribution energy consumption input saturation and can handle rudder failures motivated by the afore mentioned considerations this paper proposes an optimal robust trajectory tracking controller for a x rudder auv in the presence of velocity sensor failure and uncertainties the main contributions are summarized as follows 1 two reduced order extended state observers esos are proposed to estimate the surge and heave velocities and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed in presence of velocity sensor failures compared with conventional trajectory tracking controller the proposed method can achieve trajectory tracking missions without using the measured linear velocities 2 an optimal robust disturbance rejection control law is designed for dynamics control which solves the problem of unknown compound disturbances by disturbance observers improves the system robustness and asymptotic convergence by employing modified terminal sliding mode control and achieves rudder allocation by multi objective optimization method compared with conventional disturbance observer method the proposed method utilizes the estimated velocities rather than the measured values besides the proposed multi objective optimization method is not only energy efficient but also robust against rudder failures the remainder of this paper is organized as follows section 2 presents the x rudder auv models trajectory tracking mission and control problem formulation section 3 proposes the optimal robust trajectory tracking control scheme and presents the detailed deriving process of kinematics and dynamics controller section 4 validates the previous analysis and design through simulation cases and discussions section 5 demonstrates the conclusions of this work 2 problem formulation 2 1 x rudder auv model in this paper a x rudder auv will be studied which has a special control surface layout as shown in fig 1 compared with traditional cross rudder auv x rudder auv has following advantages 1 higher safety the x rudder can be arranged within the vehicle s baseline thus avoiding unexpected collisions between the rudders and underwater obstacles 2 better maneuverability the x rudder auv has better hydrodynamic performance and stability in both horizontal and vertical planes and the rolling motion can be controlled 3 better rudder efficiency the x rudder adopts a diagonal arrangement to obtain the maximum extension length which helps achieving large aspect ratio and high rudder efficiency 4 stronger anti sinking ability due to the independent control property and diagonal arrangement the x rudder auv has better ability to resist the rudder stuck and also reduces the serious damage caused by rudder stuck 5 lower noise the layout of x rudder helps reduce interference between the rudder and propeller thus reducing the noise however the control of the x rudder auv is more complicated than cross rudder auv since the direction of control surface of x rudder is inconsistent with the moving direction of auv which increases the cross coupling and the auv can t be intuitively controlled usually the rudder force and torque of the desired direction are calculated first then simo rudder angle distribution problem will be solved to obtain the rudder angles to tackle the above problem the x rudder dynamics model will be studied in this section following standard practice the kinematic and dynamic model of the auv in vertical plane can be described by the motion components in surge heave and pitch degrees of freedom the kinematics model of auv take the following form 1 x u cos θ w sin θ z u sin θ w cos θ θ q where x z θ t denote the position and orientation vectors of the auv in inertial reference frame u w and q are the surge heave and pitch angular velocities neglecting the motions in sway yaw and roll directions the 3 dof dynamics model of auv in vertical plane is simplified as 2 m x u u w b sin θ m w q m x g q 2 x u u u u x w q w q x q q q 2 x t d u m z w w w b cos θ m u q m z g q 2 z w w w w z q q q q z u q u q z u w u w τ w d w i y y m q q z g w z b b sin θ x g w x b b cos θ m z g w q m x g u q m w w w w m q q q q m u q u q m u w u w τ q d q where m is the mass of vehicle w is the vehicle s weight b is the vehicle s buoyancy x g z g is the position of vehicle s gravity center in the body fixed frame x b z b is the position of vehicle s buoyancy center in the body fixed frame i y y is the moment of inertia of the vehicle about y axis of the body fixed frame x z and m are the vehicle s hydrodynamics coefficients x t is the propeller thrust force along the vehicle s surge motion τ w and τ q are the rudder force and torque along the vehicle s heave motion and pitch motion respectively d u d w and d q denote unknown compound environmental disturbances with unknown upper bounds to facilitate the controller design the dynamics model of auv in vertical plane is rewritten as 3 u f u u w q g u x t d u w f w u w q g w τ w d w q f q u w q g q τ q d q where f u u w q w b sin θ m w q m x g q 2 x u u u u x w q w q x q q q 2 m x u g u 1 m x u d u d u m x u f w u w q w b cos θ m u q m z g q 2 z w w w w z q q q q z u q u q z u w u w m z w g w 1 m z w d w d w m z w f q u w q z g w z b b sin θ x g w x b b cos θ m z g w q m x g u q m w w w w m q q q q m u q u q m u w u w i y y m q g q 1 i y y m q d q d q i y y m q moreover the rudder force and torque of the x rudder auv can be expressed as 4 τ w z u u δ 1 u 2 δ 1 z u u δ 2 u 2 δ 2 z u u δ 3 u 2 δ 3 z u u δ 4 u 2 δ 4 τ q m u u δ 1 u 2 δ 1 m u u δ 2 u 2 δ 2 m u u δ 3 u 2 δ 3 m u u δ 4 u 2 δ 4 where z and m are the hydrodynamics coefficients δ 1 δ 2 δ 3 and δ 4 are the four rudder angles of the x rudder auv remark 1 for marine vehicles there exists inherent actuator saturation naik and singh 2007 zheng et al 2017 therefore the propeller thrust and rudder angles of the auv discussed here should be bounded viz x t x t and δ δ where x t is a known positive constant δ represent δ 1 δ 2 δ 3 and δ 4 δ is a known positive constant remark 2 due to the actuator saturation and energy limitation the velocities and their time derivatives should be bounded viz u u w w u u w w 2 2 trajectory tracking mission as shown in fig 2 the vehicle is required to track a desired trajectory in the vertical plane where i b and f designate the inertial reference frame the body fixed frame and the frenet serret frame respectively p is a moving point on the trajectory to be tracked associated with p on the desired trajectory f is built and the axes of which are tangent and normal to the trajectory let x z t and x d z d t be the auv position and target position in i respectively then the trajectory tracking errors built in i can be described as 5 x e i x x d z e i z z d υ e i υ υ d where υ θ α α arctan w u υ d arctan z d x d subsequently the trajectory tracking error vector built in f is derived as 6 x e z e υ e cos υ d sin υ d 0 sin υ d cos υ d 0 0 0 1 x e i z e i υ e i differentiating 6 and utilizing 1 yields 7 x e x x d cos υ d x x d υ d sin υ d z z d sin υ d z z d υ d cos υ d u cos θ w sin θ x d cos υ d υ d x x d sin υ d u sin θ w cos θ z d sin υ d υ d z z d cos υ d u cos θ υ d w sin θ υ d u d 1 κ z e 8 z e x x d sin υ d x x d υ d cos υ d z z d cos υ d z z d υ d sin υ d u cos θ w sin θ x d sin υ d υ d x x d cos υ d u sin θ w cos θ z d cos υ d υ d z z d sin υ d u sin θ υ d w cos θ υ d κ u d x e where u d x d 2 z d 2 is the velocity of the point p on the desired trajectory κ is the curvature of the point p on the desired trajectory and κ υ d u d hence the trajectory tracking error dynamics can be expressed as 9 x e z e υ e u cos θ υ d w sin θ υ d u d 1 κ z e u sin θ υ d w cos θ υ d κ u d x e q α υ d 2 3 problem formulation our objective is to develop a controller to regulate the auv to track the desired trajectory in the vertical plane regardless of velocity sensor failures unknown external disturbances and complex actuator dynamics the objective can be divided into two control problems as shown below 1 kinematics control given a desired trajectory and the trajectory tracking error model 7 8 derive an effective kinematics control law to generate the required surge velocity u d and pitch angular velocity q d so that the trajectory tracking error vectors can converge to zero as t goes to 2 dynamics control given the desired surge velocity u d and pitch angular velocity q d and the dynamics model 3 4 derive effective dynamics control laws to generate the control input x t δ 1 δ 2 δ 3 δ 4 so that the tracking errors u u d and q q d can converge to zero as t goes to to facilitate the trajectory tracking controller design following assumptions are required assumption 1 the predefined trajectory are finite such that x d y d x d and y d are bounded assumption 2 the unknown environmental disturbances and their time derivatives are assumed to be bounded viz d u d u d u d u d w d w d w d w d q d q and d q d q where d u d w d q d u d w and d q are positive constants assumption 3 the position vector x z and the pitch angle θ are measurable whereas the linear velocities u and w are unmeasurable due to the linear velocity sensor failures 3 controller design as analyzed before the x rudder auv discussed in this paper subjects to coupled nonlinearities uncertainties complex actuator dynamics and velocity sensor failures in order to achieve satisfying trajectory tracking in vertical plane the proposed controller needs to achieve not only good kinematics guidance without linear velocities measurements but also accurate and robust dynamics control against the highly coupled nonlinearities unknown disturbances and complex x rudder dynamics considering the aforementioned problems an optimal robust trajectory tracking controller is proposed in this section the control architecture of which is shown in fig 3 the proposed trajectory tracking control law is divided into two parts kinematics loop and dynamics loop esos are designed to estimate the linear velocities and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed without using the measured linear velocities los guidance law and backstepping kinematics control law are utilized in kinematics loop to address the system robustness against unknown uncertainties disturbance observer based terminal sliding mode control is utilized in dynamics loop with modified sliding mode surfaces and reaching laws the input saturation problem of propeller thrust is tackled by an anti windup compensator moreover a multi objective optimization method is proposed to achieve rudder allocation which is not only energy efficient but also robust against rudder failures and helps tackling the rudder input saturation problem at the same time compared with conventional trajectory tracking controller the proposed controller has better engineering application value since it is not only robust against velocity sensor failures but also energy efficient and robust against rudder failures helps tackling the practical problems encountered in actual working environment besides it is more suitable for x rudder auv control owing to the multi objective optimization method utilized for rudder allocation 3 1 kinematics controller design 3 1 1 linear velocity observer design as illustrated in assumption 3 the linear velocities u and w are unmeasurable to facilitate the design of proposed controller following two reduced order extended state observers are utilized to estimate the surge and heave velocities yu et al 2019b 10 u ˆ p u k 1 x e p u k 1 u ˆ cos θ υ d w ˆ sin θ υ d u d 1 κ z e 11 w ˆ p w k 1 z e p w k 1 u ˆ sin θ υ d w ˆ cos θ υ d κ u d x e where u ˆ and w ˆ are the estimated values of u and w p u and p w are the designed auxiliary variables k 1 is the observer gain note that the two observers have the same observer gain 3 1 2 los based kinematics controller design to achieve kinematics guidance and control following los guidance law is utilized 12 υ l o s arctan z e δ where δ is a positive constant in addition the desired surge velocity u d and desired pitch angular velocity q d are designed as 13 u d k 2 x e u d cos α cos υ e q d α κ u d υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α where k 2 and k 3 are positive constants and the function f υ e υ l o s takes the following form 14 f υ e υ l o s sin υ e υ e υ l o s υ e υ l o s 0 0 υ e υ l o s 0 it is seen that 13 involves a computation of α and α due to the failures of linear velocity sensors the velocities u and w are unmeasurable hence α and α are calculated using the observed values as follows 15 α arctan w ˆ u ˆ α α t δ t α t δ t note that δ t of the second equation in 15 can be chosen as the step size in simulation 3 1 3 stability analyses of the kinematics subsystem theorem 1 consider the trajectory tracking error dynamics 9 suppose a desired trajectory is given that the assumption 1 is satisfied then under the velocity observers 10 11 los guidance law 12 kinematics control law 13 15 the trajectory tracking error vectors are guaranteed to converge to a specified compact set proof consider the following lyapunov function candidate for kinematics control 16 v 1 1 2 x e 2 1 2 z e 2 1 2 υ e υ l o s 2 1 2 u 2 1 2 w 2 where u u ˆ u w w ˆ w differentiating 16 yields 17 v 1 x e x e z e z e υ e υ l o s υ e υ l o s u u w w x e u cos υ e cos α u d 1 κ z e z e u sin υ e cos α κ u d x e υ e υ l o s q α υ d υ l o s u u ˆ u w w ˆ w x e u cos υ e cos α x e u d z e u sin υ e cos α υ e υ l o s q α υ d υ l o s u u ˆ u w w ˆ w based on 9 11 one can obtain 18 u ˆ p u k 1 x e k 1 u cos θ υ d w sin θ υ d 19 w ˆ p w k 1 z e k 1 u sin θ υ d w cos θ υ d substituting 12 13 and 18 19 into 17 one can obtain 20 v 1 k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 u u cos θ υ d w sin θ υ d u k 1 w u sin θ υ d w cos θ υ d w k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 u 2 cos θ υ d k 1 w 2 cos θ υ d k 1 u u k 1 w w k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 cos θ υ d k 1 2 ε 1 u 2 k 1 cos θ υ d k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k 2 x e 2 z e u sin υ e cos α k 3 υ e υ l o s 2 z e f υ e υ l o s cos α υ e υ l o s k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 where ε 1 0 ε 2 0 according to 14 the further derivations of 20 can be divided into following two cases 1 when υ e υ l o s 0 one can obtain 21 v 1 k 2 x e 2 k 3 υ e υ l o s 2 k 1 δ δ 2 z e 2 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 2 when υ e υ l o s 0 20 can be further derived as 22 v 1 k 2 x e 2 u z e 2 δ 2 z e 2 k 1 δ δ 2 z e 2 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 since it is always possible to choose the parameters ε 1 and ε 2 to guarantee δ δ 2 z e 2 1 2 ε 1 0 and δ δ 2 z e 2 1 2 ε 2 0 and considering the fact that u and w are bounded remark 2 it can be concluded from 21 and 22 that under the velocity observers 10 11 los guidance law 12 kinematics control law 13 15 the trajectory tracking error vectors are guaranteed to converge to a specified compact set 3 2 dynamics controller design 3 2 1 disturbance observer design since the velocities u and w are unmeasurable utilizing the velocity observers 10 11 the dynamics model 3 is rewritten as 23 u ˆ f u u ˆ w ˆ q g u x t d u w ˆ f w u ˆ w ˆ q g w τ w d w q f q u ˆ w ˆ q g q τ q d q to estimate the unknown compound environmental disturbances following disturbance observers are designed 24 d ˆ u m u k 4 u ˆ m u k 4 f u u ˆ w ˆ q g u x t d ˆ u 25 d ˆ w m w k 5 w ˆ m w k 5 f w u ˆ w ˆ q g w τ w d ˆ w 26 d ˆ q m q k 6 q m q k 6 f q u ˆ w ˆ q g q τ q d ˆ q where m u m w and m q are the designed auxiliary variables k 4 k 5 and k 6 are positive observer gains note that compared with conventional disturbance observer method the proposed method utilizes the estimated velocities rather than the measured values 3 2 2 surge velocity tracking controller design in this subsection the control input x t is derived so that the surge velocity u ˆ can converge to the desired surge velocity u d as t goes to define the surge velocity tracking error as 27 z u u ˆ u d in order to achieve surge velocity tracking sliding mode control method will be utilized and a modified integral sliding mode surface is chosen as 28 s u z u c u 0 t tanh z u d t s u 0 e λ u t where c u 0 λ u 0 s u 0 represents the initial value of the sliding mode surface note that compared with conventional integral sliding mode surface s u 0 e λ u t is considered in the proposed sliding mode surface which helps avoiding excessive initial deviation besides the t a n h function is utilized to help avoiding integral explosion problem caused by excessive surge velocity tracking error differentiating 28 yields 29 s u z u c u tanh z u λ u s u 0 e λ u t f u u ˆ w ˆ q g u x t d u u d c u tanh z u λ u s u 0 e λ u t to improve the convergence efficiency and force the system states toward the given sliding manifold following modified terminal approaching law is employed 30 s u μ u s u σ u s u r u tanh s u where μ u 0 σ u 0 0 r u 1 note that the t a n h function is utilized to replace the s i g n function to weaken the chattering problem based on 29 and 30 the control input x t is designed as 31 x t 1 g u μ u s u σ u s u r u tanh s u f u u ˆ w ˆ q u d c u tanh z u λ u s u 0 e λ u t d ˆ u however considering the actuator saturation problem the actual control input will be s a t x t where s a t denotes the nonlinear saturation characteristic which can be written as 32 s a t x t x t x t x t x t x t x t x t x t x t to solve the problem of actuator saturation following anti windup compensator is employed cui et al 2016 33 ς k ς g u s u δ x t 1 2 δ x t 2 ς 2 ς δ x t ς ϑ 0 ς ϑ where δ x t s a t x t x t ς is the designed auxiliary state k 0 is a designed parameter and ϑ is a small positive constant 3 2 3 pitch angular velocity tracking controller design in this subsection the control inputs δ 1 δ 2 δ 3 δ 4 will be derived so that the pitch angular velocity q can converge to the desired pitch angular velocity q d as t goes to the pitch angular velocity tracking controller will be derived in following two steps step 1 calculation of desired rudder torque τ q d define the pitch angular velocity tracking error as 34 z q q q d similar with surge velocity tracking terminal sliding mode control method is utilized and the sliding mode surface is chosen as 35 s q z q c q 0 t tanh z q d t s q 0 e λ q t where c q 0 λ q 0 differentiating 35 yields 36 s q z q c q tanh z q λ q s q 0 e λ q t f q u ˆ w ˆ q g q τ q d q q d c q tanh z q λ q s q 0 e λ q t to obtain desired rudder torque τ q d following terminal approaching law is employed 37 s q μ q s q σ q s q r q tanh s q based on 36 and 37 the desired rudder torque τ q d is derived as 38 τ q d 1 g q μ q s q σ q s q r q tanh s q f q u ˆ w ˆ q q d c q tanh z q λ q s q 0 e λ q t d ˆ q step 2 calculation of control inputs δ 1 δ 2 δ 3 δ 4 solving the rudder angles from the rudder torque is a simo problem the solution is not unique to obtain the optimal solution a multi objective optimization method is utilized for rudder angle calculation the performance index for the optimal rudder angle calculation block is constructed with following two objectives 1 minimum rudder torque error the actual rudder torque generated by the four rudder angles can approximate the desired torque in 38 with minimum error 2 minimum control effect the control effect of the rudders is the smallest the cost function j is defined as 39 min j ξ τ q τ q d 2 r u d d e r t o r q u e a l l o c a t i o n e r r o r 1 ξ δ t δ c o n t r o l e f f e c t s t 0 ξ 1 τ q m u u δ 1 u 2 δ 1 m u u δ 2 u 2 δ 2 m u u δ 3 u 2 δ 3 m u u δ 4 u 2 δ 4 δ δ 1 δ 2 δ 3 δ 4 t δ δ where ξ is the weight coefficient utilized to balance the two optimization objectives besides the limitations of rudder angle are considered during the multi objective optimization note that the selection of parameter ξ will affect the optimization objective for instance a larger ξ means more concentration on trajectory tracking performance whereas a smaller ξ means more attention is paid to energy consumption generally when the devices of the underwater vehicle are all normal the energy consumption problem will be considered but when sensor or actuator failures occur the trajectory tracking mission will be a priority and the energy consumption problem will be less considered or even ignored the effect of parameter ξ on the control performance will be verified in section 4 moreover sequential quadratic programming sqp algorithm is applied in this paper to solve the multi objective optimization problem sqp is an effective method for constraint optimization problem which is implemented in following three subsections 1 updating of the hessian matrix of the lagrangian function 2 quadratic programming problem solution 3 line search and merit function calculation domain iterative calculation process of sqp is presented as follows 1 choose initial state of optimization variable δ 0 and hessian matrix h 0 2 solve qp sub problem get search direction d k 3 update optimization variable δ k and hessian matrix h k based on search direction d k 4 calculate the objective function in the form of lagrangian function l k 5 determine whether the objective function j k is convergent if yes jump to step 6 otherwise repeat step 2 5 6 end iteration remark 3 the proposed optimal rudder angle calculation method is not only energy efficient but also robust against rudder failures helps tackle the rudder torque error convergence problem and input saturation problem 3 2 4 stability analyses of the dynamics subsystem theorem 2 consider the dynamics model 23 the desired surge velocity u d and desired pitch angular velocity q d derived in 13 15 utilizing the disturbance observers 24 26 propeller input 31 33 and rudder input 38 39 the surge velocity tracking error 27 and pitch angular velocity tracking error 34 are guaranteed to converge to a specified compact set proof consider the following lyapunov function candidate for dynamics control 40 v 2 1 2 s u 2 1 2 s q 2 1 2 d u 2 1 2 d q 2 1 2 u 2 1 2 w 2 1 2 ς 2 where d u d ˆ u d u d q d ˆ q d q u u ˆ u w w ˆ w differentiating 40 yields 41 v 2 s u s u s q s q d u d u d q d q u u w w ς ς s u s u s q s q d u d ˆ u d u d q d ˆ q d q u u ˆ u w w ˆ w ς ς based on 29 33 and 36 39 one can obtain 42 s u μ u s u σ u s u r u tanh s u d u g u δ x t g u ς s q μ q s q σ q s q r q tanh s q d q g q τ q τ q d based on 23 24 and 26 one can obtain 43 d ˆ u k 4 d u d ˆ q k 6 d q substituting 18 19 33 and 42 43 into 41 yields 44 v 2 s u μ u s u σ u s u r u tanh s u d u g u δ x t g u ς s q μ q s q σ q s q r q tanh s q d q g q τ q τ q d d u k 4 d u d u d q k 6 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 ς k ς g u s u δ x t 1 2 δ x t 2 ς 2 ς δ x t μ u s u 2 σ u s u r u s u tanh s u s u d u s u g u δ x t s u g u ς μ q s q 2 σ q s q r q s q tanh s q s q d q s q g q τ q τ q d k 4 d u 2 d u d u k 6 d q 2 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k ς 2 g u s u δ x t 1 2 δ x t 2 ς δ x t μ u s u 2 σ u s u r u s u tanh s u s u d u s u g u ς μ q s q 2 σ q s q r q s q tanh s q s q d q s q g q τ q τ q d k 4 d u 2 d u d u k 6 d q 2 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k ς 2 1 2 δ x t 2 ς δ x t since there exists 45 s u d u 1 2 ε 3 s u 2 ε 3 2 d u 2 s q d q 1 2 ε 4 s q 2 ε 4 2 d q 2 d u d u 1 2 ε 5 d u 2 ε 5 2 d u 2 d q d q 1 2 ε 6 d q 2 ε 6 2 d q 2 s u g u ς g u 2 2 ε 7 s u 2 ε 7 2 ς 2 s q g q τ q τ q d g q 2 2 ε 8 s q 2 ε 8 2 τ q τ q d 2 ς δ x t 1 2 ε 9 ς 2 ε 9 2 δ x t 2 where ε 3 0 ε 4 0 ε 5 0 ε 6 0 ε 7 0 ε 8 0 ε 9 0 the time derivative of v 2 can be further derived as 46 v 2 μ u 1 2 ε 3 g u 2 2 ε 7 s u 2 σ u s u r u s u tanh s u μ q 1 2 ε 4 g q 2 2 ε 8 s q 2 σ q s q r q s q tanh s q k 4 ε 3 2 1 2 ε 5 d u 2 k 6 ε 4 2 1 2 ε 6 d q 2 k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 k ε 7 2 1 2 ε 9 ς 2 1 ε 9 2 δ x t 2 ε 1 2 u 2 ε 2 2 w 2 ε 5 2 d u 2 ε 6 2 d q 2 ε 8 2 τ q τ q d 2 since it is always possible to choose the parameters to guarantee μ u 1 2 ε 3 g u 2 2 ε 7 0 μ q 1 2 ε 4 g q 2 2 ε 8 0 k 4 ε 3 2 1 2 ε 5 0 k 6 ε 4 2 1 2 ε 6 0 k 1 δ δ 2 z e 2 k 1 2 ε 1 0 k 1 δ δ 2 z e 2 k 1 2 ε 2 0 k ε 7 2 1 2 ε 9 0 1 ε 9 2 0 considering the fact that u w d u and d q are bounded see remark 2 and assumption 2 and τ q τ q d 2 is bounded thanks to the optimal rudder angle calculation method see remark 3 it can be concluded from 46 that the dynamics control subsystem is stable and the surge velocity tracking error and pitch angular velocity tracking error are guaranteed to converge to a specified compact set remark 4 based on theorem 1 and theorem 2 the convergence of the whole trajectory tracking system can be guaranteed 4 simulation results in this section comparative numerical simulations are carried out to verify the effectiveness and robustness of proposed control method the simulation parameters are introduced in subsection 4 1 and the simulation results are presented in subsections 4 2 4 4 4 1 parameter selection numerical simulations are carried out with a x rudder auv and the parameters of auv model are given in table 1 the parameters of the proposed controller are designed as follows the gain of linear velocity observer is selected as k 1 1 75 the look ahead distance is δ 2 772 the gains of kinematics controller are selected as k 2 0 5 k 3 2 the gains of disturbance observers are chosen as k 4 k 5 k 6 2 5 the gains of surge velocity tracking controller are c u 1 5 λ u 1 μ u 0 0001 σ u 0 0001 r u 0 9 the gains of pitch angular velocity tracking controller are c q 0 15 λ q 0 5 μ q 10 σ q 10 r q 0 9 and the weight coefficient utilized in optimal rudder allocation is selected as ξ 0 5 for comparison purpose the other two control methods are utilized which employ the same kinematics control and optimal rudder allocation method as proposed controller whereas apply conventional pid controller and smc sliding mode control for dynamics control for pid control the parameters for surge velocity tracking are selected as k p 25 k i 0 01 k d 0 and the parameters for pitch angular velocity tracking are selected as k p 250 k i 0 01 k d 0 for smc the sliding mode surfaces and controllers are designed as s u z u c u 0 t z u d t s u 0 e λ u t s q z q c q 0 t z q d t s q 0 e λ q t x t 1 g u μ u s u σ u s i g n s u f u u ˆ w ˆ q u d c u z u λ u s u 0 e λ u t d ˆ u τ q d 1 g q μ q s q σ q s i g n s q f q u ˆ w ˆ q q d c q z q λ q s q 0 e λ q t d ˆ q and the parameters of smc for surge velocity tracking are selected as c u 1 5 λ u 1 μ u 0 0001 σ u 0 0001 the parameters of smc for pitch angular velocity tracking are selected as c q 0 15 λ q 0 5 μ q 8 σ q 1 4 2 trajectory tracking performance without disturbances in this subsection the trajectory tracking performance of proposed controller is verified through comparison with pid control and smc a sinusoidal curve is chosen as the desired trajectory which is parameterized by x d 1 0 t m and z d 10 sin 0 1 t m the initial conditions are selected as x 0 z 0 θ 0 0 m 7 m 0 rad and u 0 w 0 q 0 0 1 m s 0 m s 0 rad s the trajectory tracking performance and tracking errors are shown in fig 4 and fig 5 it is easily observed that all the three controllers can regulate the auv to the desired trajectory but the proposed controller shows the best transient performance compared with pid control the proposed controller exhibits better tracking accuracy while compared with smc the proposed controller exhibits higher stability without chattering to further distinguish tracking performance of the three controllers data analyses of steady state tracking errors are shown in fig 6 where ave represents the average value max represents the maximum value and stdev denotes the standard deviation value it is clearly seen that proposed controller has the smallest tracking error in steady state the control inputs of proposed controller are demonstrated in fig 7 which indicates that the proposed method can limit the control inputs into a valid range the estimations of linear velocities are presented in fig 8 and fig 9 it is seen that the unmeasured linear velocities u and w can be well estimated by the proposed velocity observers with small estimation errors according to the above analyses the proposed control scheme is proved to be effective for sinusoidal trajectory tracking and has better transient performance than pid control and smc method 4 3 robust test against different disturbances to further verify the robust performance of the proposed controller against disturbance three simulation cases are carried out with different disturbances in this subsection in case 1 time varying disturbances are introduced to the system in case 2 the disturbances are not only time varying but also state dependent in case 3 more complex segmented disturbances are applied the specific disturbance settings are designed as follows c a s e 1 d u 0 01 sin 0 1 t 0 01 d w 0 01 cos 0 1 t 0 01 d q 0 01 sin 0 2 t 0 01 c a s e 2 d u 0 03 sin 0 1 t 0 03 cos 0 2 t 0 03 u 2 0 01 d w 0 03 sin 0 1 t 0 03 cos 0 2 t 0 03 w 2 0 01 d q 0 03 cos 0 1 t 0 03 sin 0 2 t 0 03 q 2 0 01 c a s e 3 d u 0 03 sin 0 1 t 0 1 t 75 s 0 03 u cos 0 1 t 0 04 sin 0 2 t 0 03 u 2 0 03 t 75 s d w 0 03 sin 0 1 t 0 2 t 75 s 0 04 w sin 0 1 t 0 03 cos 0 1 t 0 03 w 2 0 03 t 75 s d q 0 03 cos 0 1 t 0 1 t 75 s 0 03 q cos 0 1 t 0 04 sin 0 2 t 0 03 q 2 0 03 t 75 s the desired trajectory and initial conditions of the system are the same as subsection 4 2 the trajectory tracking performance and tracking errors are shown in fig 10 and fig 11 it can be seen that under the three different kinds of disturbances the proposed controller can still show good trajectory tracking performance thus demonstrating good robustness against disturbances meanwhile some fluctuations are observed as the disturbances suddenly changed in case 3 which is normal since the system states have changed and the controller needs some time to adjust to further distinguish the system robustness against three different kinds of disturbances data analyses of steady state tracking errors are shown in fig 12 where ave represents the average value max represents the maximum value and stdev denotes the standard deviation value it is clearly seen that the tracking errors can all maintain at a low level in cases 1 3 however as the disturbance becomes more complicated the tracking accuracy is degraded the estimations of d u d w and d q in three simulation cases are shown in fig 13 14 and 15 the results indicate that the proposed disturbance observer can achieve good estimation with small errors besides since the linear velocities are unmeasured the disturbance observer has to be designed based on the estimate value of linear velocities rather than the actual values when there is a deviation between the velocity estimation value and the actual value in the initial adjustment phase some errors appear in the disturbance observation this phenomenon is normal and will not affect the overall disturbance observation based on the above analyses it can be concluded that the proposed method has good disturbance observation ability thus leading to good robustness against disturbances 4 4 robust test against rudder failures rudder stuck is a common type of rudder failure which directly affect maneuverability and may bring great danger to the auv the x rudder auv discussed in this paper has multi rudder independent control capability so it still has certain maneuverability when some rudders are stuck moreover the proposed multi objective optimization method can still achieve rudder allocation when some rudders are stuck therefore the proposed controller has certain robustness against rudder failures in this section the robustness of proposed controller will be tested against rudder failures and the adjusting function of parameter ξ will also be verified the rudder stuck settings are shown in table 2 in cases 4 7 the condition of one rudder stuck is considered whereas the condition of two rudders stuck is considered in case 8 the desired trajectory initial conditions and disturbance settings of the system are the same as subsection 4 2 the simulations of this section are implemented in following two stages first the trajectory tracking performance of proposed controller is verified with one rudder stuck in cases 4 7 the weight coefficient of optimization objective function is selected as ξ 0 5 which means both the trajectory tracking and energy consumption problem are considered in optimization objective the tracking trajectories and tracking errors of cases 4 7 are shown in fig 16 and fig 17 it is seen that the proposed controller can still achieve good trajectory tracking with one rudder stuck although the trajectory tracking errors are different under different rudder stuck angles they are all maintained at a lower level to further analyze the tracking performance of proposed controller more stuck angles are considered across the entire rudder range 30 30 and the simulation results are shown in fig 18 it is observed that the proposed controller can achieve satisfactory trajectory tracking with small errors under all the rudder stuck samples the rudder allocation performances of cases 4 7 are shown in fig 19 compared with section 4 2 the rudder angles exhibit more dramatic changes therefore it is proved that the proposed controller can achieve good trajectory tracking with one rudder stuck but other rudders have to be controlled more intensely to make up for the impact of stuck rudder second the trajectory tracking performance of proposed controller is verified under the condition of two rudders stuck when ξ 0 5 the tracking trajectory and rudder allocation of case 8 are shown in fig 20 and fig 21 compared with cases 4 7 it is easily observed that the trajectory tracking performance of case 8 is degraded when trajectory tracking and energy consumption problem are both considered in optimization objective besides as shown in fig 21 since the two rudders have been stuck the rudder angles of the other two rudders show dramatic changes in order to achieve the control target to further verify the adjusting function of parameter ξ the energy consumption problem is ignored and the value of ξ is changed to ξ 1 the simulation results are shown in fig 22 and fig 23 it is clearly seen that the tracking performance of case 8 is greatly improved when energy consumption problem is ignored but as shown in fig 23 this also has some negative effects that is the rudder angles change more drastically thus consuming too much energy from the above simulation results following conclusions can be drawn 1 the proposed multi objective optimization method has certain robustness against rudder failures and can achieve good trajectory tracking with one rudder stuck however when facing with serious failures the maneuverability and trajectory tracking capability will be degraded 2 when facing with two rudders stuck the tracking performance can be improved by adjusting the optimization target but it brings huge energy consumption moreover too aggressive rudder angle control may not be realized under real working conditions 3 when facing with most serious rudder failures such as three rudders stuck the maneuverability will be degraded more seriously which may cause failed tracking missions in this case the trajectory tracking mission needs to be adjusted or even the vehicle should be recycled based on the above analysis we believe that in the presence of rudder failures it is better to have a failure analyzer to classify the failures and then take corresponding methods based on the result of the failure quantification for example when facing with low level failure the optimization target or control parameters can be adjusted to help complete the mission whereas when facing with high level failure it is preferred to change the tracking target or perform emergency recycling the simulation results of this paper will provide a good basis for the design of the rudder failure analyzer in addition this paper only analyzes the tracking control in the vertical plane in fact the impact of the rudder failure on the vehicle is multi faceted even if the tracking control can be completed in the vertical plane the control of the horizontal plane may suffer from other negative effects this will be addressed in our future works 5 conclusions this paper addresses the trajectory tracking problem of a x rudder auv in vertical plane subjects to velocity sensor failure and uncertainties an optimal robust trajectory tracking controller is developed based on linear velocity observers los based backstepping kinematics controller robust disturbance rejection dynamics controller and multi objective optimal rudder allocator the salient features of the proposed control method are as follows first the unmeasured linear velocities can be well estimated by esos which helps releasing the requirements of linear velocity measurement second the system robustness is addressed by the proposed robust disturbance rejection dynamics controller third the multi objective optimal rudder allocator can achieve satisfactory rudder angle calculation with rudder input saturation and it is not only energy efficient but also robust against rudder failures lyapunov analysis is performed to prove the stability and performance of the proposed controller moreover the robustness and effectiveness of the controller are tested and validated through comparative numerical simulations for future research it is of interest to extend the current work to 3d space and incorporate more state constraints and fault tolerant methods in the trajectory tracking controller design author contribution statement 1 yingkai xia conceptualization methodology software validation writing original draft visualization 2 kan xu investigation data curation software 3 wenjin wang data curation validation 4 guohua xu conceptualization supervision 5 xianbo xiang writing reviewing and editing 6 ye li writing reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported in part by national natural science foundation of china grant numbers 51479114 51579111 51761135012 and the post doctoral foundation of china grant number 2018m632117 
22077,this paper presents an optimal robust control method for trajectory tracking of a x rudder autonomous underwater vehicle auv subjects to velocity sensor failures and uncertainties two reduced order extended state observers esos are designed to estimate the surge and heave velocities and the estimated values are used to replace all the linear velocity related parameters in controller design which helps releasing the requirements of linear velocities measurement and makes the controller robust against linear velocity sensor failures in kinematics control loop line of sight los guidance law and lyapunov based control are employed and the unknown attack angle is calculated based on the estimated linear velocities in dynamics control loop a robust disturbance rejection control law is constructed using disturbance observers and modified terminal sliding mode control moreover a multi objective optimization method is proposed to achieve x rudder allocation which is not only energy efficient but also robust against rudder failures and helps tackling the rudder input saturation problem at the same time finally comparative numerical simulations are provided to demonstrate the robustness and effectiveness of the proposed approach keywords x rudder auv trajectory tracking control velocity sensor failures robust disturbance rejection control multi objective optimal rudder allocation 1 introduction due to the depletion of land resources marine development has received more and more attention and various underwater equipment have been developed in the past few decades autonomous underwater vehicle is one of the most widely used underwater equipment which has played an increasingly important role in all kinds of submerged applications such as underwater intervention zhang et al 2015 monitoring and inspection zhang et al 2018a target tracking shojaei and dolatshahi 2017 and oceanographic surveys wynn et al 2014 etc to better accomplish the afore mentioned submerged tasks the following two basic ideas have been applied to improve the vehicle s performance 1 design effective control systems to steer the auvs accurately and reliably in the harsh marine environment 2 design new actuators such as rudders thrusters etc to improve the vehicle s capability with the thought of second kind various kinds of rudders have been applied to auv to improve the maneuverability such as cross rudder h type rudder and x type rudder zhang et al 2017 etc compared with traditional cross rudder auv the x rudder auv has much better maneuverability and flexibility since the four rudders can be operated independently however the control of the x rudder auv is more complicated than cross rudder auv and is not often studied in the existing literatures for this reason trajectory tracking control of a x rudder auv will be discussed in this paper trajectory tracking control of marine vehicles has been widely studied in recent years xia et al 2019a yu et al 2019a shen et al 2018 zhang et al 2019 al makdah et al 2019 in qiao et al 2017 three exponentially convergent robust controllers namely the min max type controller the saturation type controller and the smooth transition type controller were proposed to drive an auv to track a predefined trajectory in von ellenrieder 2019 an n degree of freedom nonlinear control law was proposed for the trajectory tracking of marine vehicles that operate in the presence of unknown time varying disturbances input saturation and actuator rate limits using a disturbance observer and nonlinear dynamic surface control an adaptive ilos guidance law was proposed for unmanned msvs in zheng and sun 2016 which introduced rbfnn to deal with the time varying ocean currents in yu et al 2018 line of sight los guidance was built for the robust magnetic tracking of subsea cable by an auv in the presence of sensor noise and ocean currents in miao et al 2017 an improved compound line of sight clos guidance law was proposed for path following control of auv which can estimate the unknown sideslip angle and compensate for the effects of time varying ocean currents in chen et al 2019 an adaptive trajectory tracking control algorithm was proposed with guaranteed transient performance which employed neural networks to approximate the unknown external disturbances and uncertain hydrodynamics most of the above studies are based on the assumption that all the motion states of auv are measurable however sensor failures may occur to auv considering the complex underwater environment in these cases the conventional control methods may not work state observer based control methods can provide effective solutions for such conditions yu et al 2019b proposed an improved extended state observer based line of sight elos guidance law which estimated the surge and sway linear velocities and compensated for the unmeasured side slip angle but the estimated velocities were only utilized in kinematics control and not applied in dynamics control an output feedback path following control method was proposed in peng and wang 2018 for under actuated autonomous underwater vehicles moving in a vertical plane without using surge heave and pitch velocities in li et al 2019 a finite time extended state observer based fault tolerant output feedback control was proposed for the rigid spacecraft attitude control system without the angular velocity measurements in the presence of external disturbances and actuator failures in liu et al 2019 the state recovery and disturbance estimation problems of unmanned surface vehicles were addressed in the presence of unknown disturbances as well as unmeasured surge sway and yaw velocities motivated by the existing methods extended state observers esos are proposed to estimate the surge and heave velocities in this paper and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed without requirements of linear velocity measurement complex unknown external disturbance is an important issue of trajectory tracking which could affect the model accuracy and degrade the closed loop system performance wang et al 2013 2018 to solve this problem the control system should have good robustness the commonly used robust control methods include but not limited to sliding mode control guo et al 2019 h infinity control zhang et al 2018b model predictive control li and yan 2017 neural network control xia et al 2019b optimal control li et al 2018 multi agent xiao et al 2018 etc of all the robust control methods sliding mode control is a widely used robust control technique which has shown excellent tracking performance due to its robustness against the uncertainties and disturbances van 2019 in qiao and zhang 2017 an adaptive non singular integral terminal sliding mode control anitsmc scheme was proposed for trajectory tracking of autonomous underwater vehicles auvs with dynamics uncertainties and time varying external disturbances in xu et al 2015 sliding mode control and backstepping technique were combined to design a robust trajectory tracking controller for an auv with parameter uncertainties and external disturbances qiao and zhang 2019 proposed an adaptive second order fast nonsingular terminal sliding mode control asofntsmc scheme for the trajectory tracking of fully actuated autonomous underwater vehicles auvs in the presence of dynamic uncertainties and time varying external disturbances however chattering problems are often encountered for sliding mode control to guarantee control robustness and avoid chattering a robust disturbance rejection control law is constructed in this paper based on disturbance observers and modified terminal sliding mode control actuator dynamics is another technical challenge for trajectory tracking control the commonly considered actuator dynamics include input saturation input delay etc which may influence the stability of the control system and even make the entire system unstable many efforts have been made to tackle these problems in recent years an anti windup compensator was proposed in cui et al 2016 to solve the problem of attitude control subjected to actuator saturation novel auxiliary systems were proposed in chu et al 2018 to deal with the input saturation based on which an adaptive fuzzy sliding mode controller was developed for the diving control of auv to eliminate the control input nonlinearities adaptive neural network control was proposed in cui et al 2017 for auvs using reinforcement learning in peng et al 2019 a reference governor was used for generating the optimal reference signals within the state and input constraints based on which the guidance loop and the control loop were bridged in sarhadi et al 2016 an adaptive autopilot was presented for the pitch and yaw channels of an auv in presence of input saturations which employed model reference adaptive control with integral state feedback and anti windup compensator however most of the above studies are designed for the cross rudder auv which cannot solve the single input and multi output simo rudder angle distribution problem faced by the x rudder auv to solve this problem a multi objective optimization method is proposed in this paper which considers the problem of torque distribution energy consumption input saturation and can handle rudder failures motivated by the afore mentioned considerations this paper proposes an optimal robust trajectory tracking controller for a x rudder auv in the presence of velocity sensor failure and uncertainties the main contributions are summarized as follows 1 two reduced order extended state observers esos are proposed to estimate the surge and heave velocities and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed in presence of velocity sensor failures compared with conventional trajectory tracking controller the proposed method can achieve trajectory tracking missions without using the measured linear velocities 2 an optimal robust disturbance rejection control law is designed for dynamics control which solves the problem of unknown compound disturbances by disturbance observers improves the system robustness and asymptotic convergence by employing modified terminal sliding mode control and achieves rudder allocation by multi objective optimization method compared with conventional disturbance observer method the proposed method utilizes the estimated velocities rather than the measured values besides the proposed multi objective optimization method is not only energy efficient but also robust against rudder failures the remainder of this paper is organized as follows section 2 presents the x rudder auv models trajectory tracking mission and control problem formulation section 3 proposes the optimal robust trajectory tracking control scheme and presents the detailed deriving process of kinematics and dynamics controller section 4 validates the previous analysis and design through simulation cases and discussions section 5 demonstrates the conclusions of this work 2 problem formulation 2 1 x rudder auv model in this paper a x rudder auv will be studied which has a special control surface layout as shown in fig 1 compared with traditional cross rudder auv x rudder auv has following advantages 1 higher safety the x rudder can be arranged within the vehicle s baseline thus avoiding unexpected collisions between the rudders and underwater obstacles 2 better maneuverability the x rudder auv has better hydrodynamic performance and stability in both horizontal and vertical planes and the rolling motion can be controlled 3 better rudder efficiency the x rudder adopts a diagonal arrangement to obtain the maximum extension length which helps achieving large aspect ratio and high rudder efficiency 4 stronger anti sinking ability due to the independent control property and diagonal arrangement the x rudder auv has better ability to resist the rudder stuck and also reduces the serious damage caused by rudder stuck 5 lower noise the layout of x rudder helps reduce interference between the rudder and propeller thus reducing the noise however the control of the x rudder auv is more complicated than cross rudder auv since the direction of control surface of x rudder is inconsistent with the moving direction of auv which increases the cross coupling and the auv can t be intuitively controlled usually the rudder force and torque of the desired direction are calculated first then simo rudder angle distribution problem will be solved to obtain the rudder angles to tackle the above problem the x rudder dynamics model will be studied in this section following standard practice the kinematic and dynamic model of the auv in vertical plane can be described by the motion components in surge heave and pitch degrees of freedom the kinematics model of auv take the following form 1 x u cos θ w sin θ z u sin θ w cos θ θ q where x z θ t denote the position and orientation vectors of the auv in inertial reference frame u w and q are the surge heave and pitch angular velocities neglecting the motions in sway yaw and roll directions the 3 dof dynamics model of auv in vertical plane is simplified as 2 m x u u w b sin θ m w q m x g q 2 x u u u u x w q w q x q q q 2 x t d u m z w w w b cos θ m u q m z g q 2 z w w w w z q q q q z u q u q z u w u w τ w d w i y y m q q z g w z b b sin θ x g w x b b cos θ m z g w q m x g u q m w w w w m q q q q m u q u q m u w u w τ q d q where m is the mass of vehicle w is the vehicle s weight b is the vehicle s buoyancy x g z g is the position of vehicle s gravity center in the body fixed frame x b z b is the position of vehicle s buoyancy center in the body fixed frame i y y is the moment of inertia of the vehicle about y axis of the body fixed frame x z and m are the vehicle s hydrodynamics coefficients x t is the propeller thrust force along the vehicle s surge motion τ w and τ q are the rudder force and torque along the vehicle s heave motion and pitch motion respectively d u d w and d q denote unknown compound environmental disturbances with unknown upper bounds to facilitate the controller design the dynamics model of auv in vertical plane is rewritten as 3 u f u u w q g u x t d u w f w u w q g w τ w d w q f q u w q g q τ q d q where f u u w q w b sin θ m w q m x g q 2 x u u u u x w q w q x q q q 2 m x u g u 1 m x u d u d u m x u f w u w q w b cos θ m u q m z g q 2 z w w w w z q q q q z u q u q z u w u w m z w g w 1 m z w d w d w m z w f q u w q z g w z b b sin θ x g w x b b cos θ m z g w q m x g u q m w w w w m q q q q m u q u q m u w u w i y y m q g q 1 i y y m q d q d q i y y m q moreover the rudder force and torque of the x rudder auv can be expressed as 4 τ w z u u δ 1 u 2 δ 1 z u u δ 2 u 2 δ 2 z u u δ 3 u 2 δ 3 z u u δ 4 u 2 δ 4 τ q m u u δ 1 u 2 δ 1 m u u δ 2 u 2 δ 2 m u u δ 3 u 2 δ 3 m u u δ 4 u 2 δ 4 where z and m are the hydrodynamics coefficients δ 1 δ 2 δ 3 and δ 4 are the four rudder angles of the x rudder auv remark 1 for marine vehicles there exists inherent actuator saturation naik and singh 2007 zheng et al 2017 therefore the propeller thrust and rudder angles of the auv discussed here should be bounded viz x t x t and δ δ where x t is a known positive constant δ represent δ 1 δ 2 δ 3 and δ 4 δ is a known positive constant remark 2 due to the actuator saturation and energy limitation the velocities and their time derivatives should be bounded viz u u w w u u w w 2 2 trajectory tracking mission as shown in fig 2 the vehicle is required to track a desired trajectory in the vertical plane where i b and f designate the inertial reference frame the body fixed frame and the frenet serret frame respectively p is a moving point on the trajectory to be tracked associated with p on the desired trajectory f is built and the axes of which are tangent and normal to the trajectory let x z t and x d z d t be the auv position and target position in i respectively then the trajectory tracking errors built in i can be described as 5 x e i x x d z e i z z d υ e i υ υ d where υ θ α α arctan w u υ d arctan z d x d subsequently the trajectory tracking error vector built in f is derived as 6 x e z e υ e cos υ d sin υ d 0 sin υ d cos υ d 0 0 0 1 x e i z e i υ e i differentiating 6 and utilizing 1 yields 7 x e x x d cos υ d x x d υ d sin υ d z z d sin υ d z z d υ d cos υ d u cos θ w sin θ x d cos υ d υ d x x d sin υ d u sin θ w cos θ z d sin υ d υ d z z d cos υ d u cos θ υ d w sin θ υ d u d 1 κ z e 8 z e x x d sin υ d x x d υ d cos υ d z z d cos υ d z z d υ d sin υ d u cos θ w sin θ x d sin υ d υ d x x d cos υ d u sin θ w cos θ z d cos υ d υ d z z d sin υ d u sin θ υ d w cos θ υ d κ u d x e where u d x d 2 z d 2 is the velocity of the point p on the desired trajectory κ is the curvature of the point p on the desired trajectory and κ υ d u d hence the trajectory tracking error dynamics can be expressed as 9 x e z e υ e u cos θ υ d w sin θ υ d u d 1 κ z e u sin θ υ d w cos θ υ d κ u d x e q α υ d 2 3 problem formulation our objective is to develop a controller to regulate the auv to track the desired trajectory in the vertical plane regardless of velocity sensor failures unknown external disturbances and complex actuator dynamics the objective can be divided into two control problems as shown below 1 kinematics control given a desired trajectory and the trajectory tracking error model 7 8 derive an effective kinematics control law to generate the required surge velocity u d and pitch angular velocity q d so that the trajectory tracking error vectors can converge to zero as t goes to 2 dynamics control given the desired surge velocity u d and pitch angular velocity q d and the dynamics model 3 4 derive effective dynamics control laws to generate the control input x t δ 1 δ 2 δ 3 δ 4 so that the tracking errors u u d and q q d can converge to zero as t goes to to facilitate the trajectory tracking controller design following assumptions are required assumption 1 the predefined trajectory are finite such that x d y d x d and y d are bounded assumption 2 the unknown environmental disturbances and their time derivatives are assumed to be bounded viz d u d u d u d u d w d w d w d w d q d q and d q d q where d u d w d q d u d w and d q are positive constants assumption 3 the position vector x z and the pitch angle θ are measurable whereas the linear velocities u and w are unmeasurable due to the linear velocity sensor failures 3 controller design as analyzed before the x rudder auv discussed in this paper subjects to coupled nonlinearities uncertainties complex actuator dynamics and velocity sensor failures in order to achieve satisfying trajectory tracking in vertical plane the proposed controller needs to achieve not only good kinematics guidance without linear velocities measurements but also accurate and robust dynamics control against the highly coupled nonlinearities unknown disturbances and complex x rudder dynamics considering the aforementioned problems an optimal robust trajectory tracking controller is proposed in this section the control architecture of which is shown in fig 3 the proposed trajectory tracking control law is divided into two parts kinematics loop and dynamics loop esos are designed to estimate the linear velocities and the estimated values are used to replace all the velocity related parameters in controller design hence the trajectory tracking missions can be completed without using the measured linear velocities los guidance law and backstepping kinematics control law are utilized in kinematics loop to address the system robustness against unknown uncertainties disturbance observer based terminal sliding mode control is utilized in dynamics loop with modified sliding mode surfaces and reaching laws the input saturation problem of propeller thrust is tackled by an anti windup compensator moreover a multi objective optimization method is proposed to achieve rudder allocation which is not only energy efficient but also robust against rudder failures and helps tackling the rudder input saturation problem at the same time compared with conventional trajectory tracking controller the proposed controller has better engineering application value since it is not only robust against velocity sensor failures but also energy efficient and robust against rudder failures helps tackling the practical problems encountered in actual working environment besides it is more suitable for x rudder auv control owing to the multi objective optimization method utilized for rudder allocation 3 1 kinematics controller design 3 1 1 linear velocity observer design as illustrated in assumption 3 the linear velocities u and w are unmeasurable to facilitate the design of proposed controller following two reduced order extended state observers are utilized to estimate the surge and heave velocities yu et al 2019b 10 u ˆ p u k 1 x e p u k 1 u ˆ cos θ υ d w ˆ sin θ υ d u d 1 κ z e 11 w ˆ p w k 1 z e p w k 1 u ˆ sin θ υ d w ˆ cos θ υ d κ u d x e where u ˆ and w ˆ are the estimated values of u and w p u and p w are the designed auxiliary variables k 1 is the observer gain note that the two observers have the same observer gain 3 1 2 los based kinematics controller design to achieve kinematics guidance and control following los guidance law is utilized 12 υ l o s arctan z e δ where δ is a positive constant in addition the desired surge velocity u d and desired pitch angular velocity q d are designed as 13 u d k 2 x e u d cos α cos υ e q d α κ u d υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α where k 2 and k 3 are positive constants and the function f υ e υ l o s takes the following form 14 f υ e υ l o s sin υ e υ e υ l o s υ e υ l o s 0 0 υ e υ l o s 0 it is seen that 13 involves a computation of α and α due to the failures of linear velocity sensors the velocities u and w are unmeasurable hence α and α are calculated using the observed values as follows 15 α arctan w ˆ u ˆ α α t δ t α t δ t note that δ t of the second equation in 15 can be chosen as the step size in simulation 3 1 3 stability analyses of the kinematics subsystem theorem 1 consider the trajectory tracking error dynamics 9 suppose a desired trajectory is given that the assumption 1 is satisfied then under the velocity observers 10 11 los guidance law 12 kinematics control law 13 15 the trajectory tracking error vectors are guaranteed to converge to a specified compact set proof consider the following lyapunov function candidate for kinematics control 16 v 1 1 2 x e 2 1 2 z e 2 1 2 υ e υ l o s 2 1 2 u 2 1 2 w 2 where u u ˆ u w w ˆ w differentiating 16 yields 17 v 1 x e x e z e z e υ e υ l o s υ e υ l o s u u w w x e u cos υ e cos α u d 1 κ z e z e u sin υ e cos α κ u d x e υ e υ l o s q α υ d υ l o s u u ˆ u w w ˆ w x e u cos υ e cos α x e u d z e u sin υ e cos α υ e υ l o s q α υ d υ l o s u u ˆ u w w ˆ w based on 9 11 one can obtain 18 u ˆ p u k 1 x e k 1 u cos θ υ d w sin θ υ d 19 w ˆ p w k 1 z e k 1 u sin θ υ d w cos θ υ d substituting 12 13 and 18 19 into 17 one can obtain 20 v 1 k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 u u cos θ υ d w sin θ υ d u k 1 w u sin θ υ d w cos θ υ d w k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 u 2 cos θ υ d k 1 w 2 cos θ υ d k 1 u u k 1 w w k 2 x e 2 z e u sin υ e cos α υ e υ l o s k 3 υ e υ l o s z e f υ e υ l o s cos α k 1 cos θ υ d k 1 2 ε 1 u 2 k 1 cos θ υ d k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k 2 x e 2 z e u sin υ e cos α k 3 υ e υ l o s 2 z e f υ e υ l o s cos α υ e υ l o s k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 where ε 1 0 ε 2 0 according to 14 the further derivations of 20 can be divided into following two cases 1 when υ e υ l o s 0 one can obtain 21 v 1 k 2 x e 2 k 3 υ e υ l o s 2 k 1 δ δ 2 z e 2 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 2 when υ e υ l o s 0 20 can be further derived as 22 v 1 k 2 x e 2 u z e 2 δ 2 z e 2 k 1 δ δ 2 z e 2 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 since it is always possible to choose the parameters ε 1 and ε 2 to guarantee δ δ 2 z e 2 1 2 ε 1 0 and δ δ 2 z e 2 1 2 ε 2 0 and considering the fact that u and w are bounded remark 2 it can be concluded from 21 and 22 that under the velocity observers 10 11 los guidance law 12 kinematics control law 13 15 the trajectory tracking error vectors are guaranteed to converge to a specified compact set 3 2 dynamics controller design 3 2 1 disturbance observer design since the velocities u and w are unmeasurable utilizing the velocity observers 10 11 the dynamics model 3 is rewritten as 23 u ˆ f u u ˆ w ˆ q g u x t d u w ˆ f w u ˆ w ˆ q g w τ w d w q f q u ˆ w ˆ q g q τ q d q to estimate the unknown compound environmental disturbances following disturbance observers are designed 24 d ˆ u m u k 4 u ˆ m u k 4 f u u ˆ w ˆ q g u x t d ˆ u 25 d ˆ w m w k 5 w ˆ m w k 5 f w u ˆ w ˆ q g w τ w d ˆ w 26 d ˆ q m q k 6 q m q k 6 f q u ˆ w ˆ q g q τ q d ˆ q where m u m w and m q are the designed auxiliary variables k 4 k 5 and k 6 are positive observer gains note that compared with conventional disturbance observer method the proposed method utilizes the estimated velocities rather than the measured values 3 2 2 surge velocity tracking controller design in this subsection the control input x t is derived so that the surge velocity u ˆ can converge to the desired surge velocity u d as t goes to define the surge velocity tracking error as 27 z u u ˆ u d in order to achieve surge velocity tracking sliding mode control method will be utilized and a modified integral sliding mode surface is chosen as 28 s u z u c u 0 t tanh z u d t s u 0 e λ u t where c u 0 λ u 0 s u 0 represents the initial value of the sliding mode surface note that compared with conventional integral sliding mode surface s u 0 e λ u t is considered in the proposed sliding mode surface which helps avoiding excessive initial deviation besides the t a n h function is utilized to help avoiding integral explosion problem caused by excessive surge velocity tracking error differentiating 28 yields 29 s u z u c u tanh z u λ u s u 0 e λ u t f u u ˆ w ˆ q g u x t d u u d c u tanh z u λ u s u 0 e λ u t to improve the convergence efficiency and force the system states toward the given sliding manifold following modified terminal approaching law is employed 30 s u μ u s u σ u s u r u tanh s u where μ u 0 σ u 0 0 r u 1 note that the t a n h function is utilized to replace the s i g n function to weaken the chattering problem based on 29 and 30 the control input x t is designed as 31 x t 1 g u μ u s u σ u s u r u tanh s u f u u ˆ w ˆ q u d c u tanh z u λ u s u 0 e λ u t d ˆ u however considering the actuator saturation problem the actual control input will be s a t x t where s a t denotes the nonlinear saturation characteristic which can be written as 32 s a t x t x t x t x t x t x t x t x t x t x t to solve the problem of actuator saturation following anti windup compensator is employed cui et al 2016 33 ς k ς g u s u δ x t 1 2 δ x t 2 ς 2 ς δ x t ς ϑ 0 ς ϑ where δ x t s a t x t x t ς is the designed auxiliary state k 0 is a designed parameter and ϑ is a small positive constant 3 2 3 pitch angular velocity tracking controller design in this subsection the control inputs δ 1 δ 2 δ 3 δ 4 will be derived so that the pitch angular velocity q can converge to the desired pitch angular velocity q d as t goes to the pitch angular velocity tracking controller will be derived in following two steps step 1 calculation of desired rudder torque τ q d define the pitch angular velocity tracking error as 34 z q q q d similar with surge velocity tracking terminal sliding mode control method is utilized and the sliding mode surface is chosen as 35 s q z q c q 0 t tanh z q d t s q 0 e λ q t where c q 0 λ q 0 differentiating 35 yields 36 s q z q c q tanh z q λ q s q 0 e λ q t f q u ˆ w ˆ q g q τ q d q q d c q tanh z q λ q s q 0 e λ q t to obtain desired rudder torque τ q d following terminal approaching law is employed 37 s q μ q s q σ q s q r q tanh s q based on 36 and 37 the desired rudder torque τ q d is derived as 38 τ q d 1 g q μ q s q σ q s q r q tanh s q f q u ˆ w ˆ q q d c q tanh z q λ q s q 0 e λ q t d ˆ q step 2 calculation of control inputs δ 1 δ 2 δ 3 δ 4 solving the rudder angles from the rudder torque is a simo problem the solution is not unique to obtain the optimal solution a multi objective optimization method is utilized for rudder angle calculation the performance index for the optimal rudder angle calculation block is constructed with following two objectives 1 minimum rudder torque error the actual rudder torque generated by the four rudder angles can approximate the desired torque in 38 with minimum error 2 minimum control effect the control effect of the rudders is the smallest the cost function j is defined as 39 min j ξ τ q τ q d 2 r u d d e r t o r q u e a l l o c a t i o n e r r o r 1 ξ δ t δ c o n t r o l e f f e c t s t 0 ξ 1 τ q m u u δ 1 u 2 δ 1 m u u δ 2 u 2 δ 2 m u u δ 3 u 2 δ 3 m u u δ 4 u 2 δ 4 δ δ 1 δ 2 δ 3 δ 4 t δ δ where ξ is the weight coefficient utilized to balance the two optimization objectives besides the limitations of rudder angle are considered during the multi objective optimization note that the selection of parameter ξ will affect the optimization objective for instance a larger ξ means more concentration on trajectory tracking performance whereas a smaller ξ means more attention is paid to energy consumption generally when the devices of the underwater vehicle are all normal the energy consumption problem will be considered but when sensor or actuator failures occur the trajectory tracking mission will be a priority and the energy consumption problem will be less considered or even ignored the effect of parameter ξ on the control performance will be verified in section 4 moreover sequential quadratic programming sqp algorithm is applied in this paper to solve the multi objective optimization problem sqp is an effective method for constraint optimization problem which is implemented in following three subsections 1 updating of the hessian matrix of the lagrangian function 2 quadratic programming problem solution 3 line search and merit function calculation domain iterative calculation process of sqp is presented as follows 1 choose initial state of optimization variable δ 0 and hessian matrix h 0 2 solve qp sub problem get search direction d k 3 update optimization variable δ k and hessian matrix h k based on search direction d k 4 calculate the objective function in the form of lagrangian function l k 5 determine whether the objective function j k is convergent if yes jump to step 6 otherwise repeat step 2 5 6 end iteration remark 3 the proposed optimal rudder angle calculation method is not only energy efficient but also robust against rudder failures helps tackle the rudder torque error convergence problem and input saturation problem 3 2 4 stability analyses of the dynamics subsystem theorem 2 consider the dynamics model 23 the desired surge velocity u d and desired pitch angular velocity q d derived in 13 15 utilizing the disturbance observers 24 26 propeller input 31 33 and rudder input 38 39 the surge velocity tracking error 27 and pitch angular velocity tracking error 34 are guaranteed to converge to a specified compact set proof consider the following lyapunov function candidate for dynamics control 40 v 2 1 2 s u 2 1 2 s q 2 1 2 d u 2 1 2 d q 2 1 2 u 2 1 2 w 2 1 2 ς 2 where d u d ˆ u d u d q d ˆ q d q u u ˆ u w w ˆ w differentiating 40 yields 41 v 2 s u s u s q s q d u d u d q d q u u w w ς ς s u s u s q s q d u d ˆ u d u d q d ˆ q d q u u ˆ u w w ˆ w ς ς based on 29 33 and 36 39 one can obtain 42 s u μ u s u σ u s u r u tanh s u d u g u δ x t g u ς s q μ q s q σ q s q r q tanh s q d q g q τ q τ q d based on 23 24 and 26 one can obtain 43 d ˆ u k 4 d u d ˆ q k 6 d q substituting 18 19 33 and 42 43 into 41 yields 44 v 2 s u μ u s u σ u s u r u tanh s u d u g u δ x t g u ς s q μ q s q σ q s q r q tanh s q d q g q τ q τ q d d u k 4 d u d u d q k 6 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 ς k ς g u s u δ x t 1 2 δ x t 2 ς 2 ς δ x t μ u s u 2 σ u s u r u s u tanh s u s u d u s u g u δ x t s u g u ς μ q s q 2 σ q s q r q s q tanh s q s q d q s q g q τ q τ q d k 4 d u 2 d u d u k 6 d q 2 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k ς 2 g u s u δ x t 1 2 δ x t 2 ς δ x t μ u s u 2 σ u s u r u s u tanh s u s u d u s u g u ς μ q s q 2 σ q s q r q s q tanh s q s q d q s q g q τ q τ q d k 4 d u 2 d u d u k 6 d q 2 d q d q k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 ε 1 2 u 2 ε 2 2 w 2 k ς 2 1 2 δ x t 2 ς δ x t since there exists 45 s u d u 1 2 ε 3 s u 2 ε 3 2 d u 2 s q d q 1 2 ε 4 s q 2 ε 4 2 d q 2 d u d u 1 2 ε 5 d u 2 ε 5 2 d u 2 d q d q 1 2 ε 6 d q 2 ε 6 2 d q 2 s u g u ς g u 2 2 ε 7 s u 2 ε 7 2 ς 2 s q g q τ q τ q d g q 2 2 ε 8 s q 2 ε 8 2 τ q τ q d 2 ς δ x t 1 2 ε 9 ς 2 ε 9 2 δ x t 2 where ε 3 0 ε 4 0 ε 5 0 ε 6 0 ε 7 0 ε 8 0 ε 9 0 the time derivative of v 2 can be further derived as 46 v 2 μ u 1 2 ε 3 g u 2 2 ε 7 s u 2 σ u s u r u s u tanh s u μ q 1 2 ε 4 g q 2 2 ε 8 s q 2 σ q s q r q s q tanh s q k 4 ε 3 2 1 2 ε 5 d u 2 k 6 ε 4 2 1 2 ε 6 d q 2 k 1 δ δ 2 z e 2 k 1 2 ε 1 u 2 k 1 δ δ 2 z e 2 k 1 2 ε 2 w 2 k ε 7 2 1 2 ε 9 ς 2 1 ε 9 2 δ x t 2 ε 1 2 u 2 ε 2 2 w 2 ε 5 2 d u 2 ε 6 2 d q 2 ε 8 2 τ q τ q d 2 since it is always possible to choose the parameters to guarantee μ u 1 2 ε 3 g u 2 2 ε 7 0 μ q 1 2 ε 4 g q 2 2 ε 8 0 k 4 ε 3 2 1 2 ε 5 0 k 6 ε 4 2 1 2 ε 6 0 k 1 δ δ 2 z e 2 k 1 2 ε 1 0 k 1 δ δ 2 z e 2 k 1 2 ε 2 0 k ε 7 2 1 2 ε 9 0 1 ε 9 2 0 considering the fact that u w d u and d q are bounded see remark 2 and assumption 2 and τ q τ q d 2 is bounded thanks to the optimal rudder angle calculation method see remark 3 it can be concluded from 46 that the dynamics control subsystem is stable and the surge velocity tracking error and pitch angular velocity tracking error are guaranteed to converge to a specified compact set remark 4 based on theorem 1 and theorem 2 the convergence of the whole trajectory tracking system can be guaranteed 4 simulation results in this section comparative numerical simulations are carried out to verify the effectiveness and robustness of proposed control method the simulation parameters are introduced in subsection 4 1 and the simulation results are presented in subsections 4 2 4 4 4 1 parameter selection numerical simulations are carried out with a x rudder auv and the parameters of auv model are given in table 1 the parameters of the proposed controller are designed as follows the gain of linear velocity observer is selected as k 1 1 75 the look ahead distance is δ 2 772 the gains of kinematics controller are selected as k 2 0 5 k 3 2 the gains of disturbance observers are chosen as k 4 k 5 k 6 2 5 the gains of surge velocity tracking controller are c u 1 5 λ u 1 μ u 0 0001 σ u 0 0001 r u 0 9 the gains of pitch angular velocity tracking controller are c q 0 15 λ q 0 5 μ q 10 σ q 10 r q 0 9 and the weight coefficient utilized in optimal rudder allocation is selected as ξ 0 5 for comparison purpose the other two control methods are utilized which employ the same kinematics control and optimal rudder allocation method as proposed controller whereas apply conventional pid controller and smc sliding mode control for dynamics control for pid control the parameters for surge velocity tracking are selected as k p 25 k i 0 01 k d 0 and the parameters for pitch angular velocity tracking are selected as k p 250 k i 0 01 k d 0 for smc the sliding mode surfaces and controllers are designed as s u z u c u 0 t z u d t s u 0 e λ u t s q z q c q 0 t z q d t s q 0 e λ q t x t 1 g u μ u s u σ u s i g n s u f u u ˆ w ˆ q u d c u z u λ u s u 0 e λ u t d ˆ u τ q d 1 g q μ q s q σ q s i g n s q f q u ˆ w ˆ q q d c q z q λ q s q 0 e λ q t d ˆ q and the parameters of smc for surge velocity tracking are selected as c u 1 5 λ u 1 μ u 0 0001 σ u 0 0001 the parameters of smc for pitch angular velocity tracking are selected as c q 0 15 λ q 0 5 μ q 8 σ q 1 4 2 trajectory tracking performance without disturbances in this subsection the trajectory tracking performance of proposed controller is verified through comparison with pid control and smc a sinusoidal curve is chosen as the desired trajectory which is parameterized by x d 1 0 t m and z d 10 sin 0 1 t m the initial conditions are selected as x 0 z 0 θ 0 0 m 7 m 0 rad and u 0 w 0 q 0 0 1 m s 0 m s 0 rad s the trajectory tracking performance and tracking errors are shown in fig 4 and fig 5 it is easily observed that all the three controllers can regulate the auv to the desired trajectory but the proposed controller shows the best transient performance compared with pid control the proposed controller exhibits better tracking accuracy while compared with smc the proposed controller exhibits higher stability without chattering to further distinguish tracking performance of the three controllers data analyses of steady state tracking errors are shown in fig 6 where ave represents the average value max represents the maximum value and stdev denotes the standard deviation value it is clearly seen that proposed controller has the smallest tracking error in steady state the control inputs of proposed controller are demonstrated in fig 7 which indicates that the proposed method can limit the control inputs into a valid range the estimations of linear velocities are presented in fig 8 and fig 9 it is seen that the unmeasured linear velocities u and w can be well estimated by the proposed velocity observers with small estimation errors according to the above analyses the proposed control scheme is proved to be effective for sinusoidal trajectory tracking and has better transient performance than pid control and smc method 4 3 robust test against different disturbances to further verify the robust performance of the proposed controller against disturbance three simulation cases are carried out with different disturbances in this subsection in case 1 time varying disturbances are introduced to the system in case 2 the disturbances are not only time varying but also state dependent in case 3 more complex segmented disturbances are applied the specific disturbance settings are designed as follows c a s e 1 d u 0 01 sin 0 1 t 0 01 d w 0 01 cos 0 1 t 0 01 d q 0 01 sin 0 2 t 0 01 c a s e 2 d u 0 03 sin 0 1 t 0 03 cos 0 2 t 0 03 u 2 0 01 d w 0 03 sin 0 1 t 0 03 cos 0 2 t 0 03 w 2 0 01 d q 0 03 cos 0 1 t 0 03 sin 0 2 t 0 03 q 2 0 01 c a s e 3 d u 0 03 sin 0 1 t 0 1 t 75 s 0 03 u cos 0 1 t 0 04 sin 0 2 t 0 03 u 2 0 03 t 75 s d w 0 03 sin 0 1 t 0 2 t 75 s 0 04 w sin 0 1 t 0 03 cos 0 1 t 0 03 w 2 0 03 t 75 s d q 0 03 cos 0 1 t 0 1 t 75 s 0 03 q cos 0 1 t 0 04 sin 0 2 t 0 03 q 2 0 03 t 75 s the desired trajectory and initial conditions of the system are the same as subsection 4 2 the trajectory tracking performance and tracking errors are shown in fig 10 and fig 11 it can be seen that under the three different kinds of disturbances the proposed controller can still show good trajectory tracking performance thus demonstrating good robustness against disturbances meanwhile some fluctuations are observed as the disturbances suddenly changed in case 3 which is normal since the system states have changed and the controller needs some time to adjust to further distinguish the system robustness against three different kinds of disturbances data analyses of steady state tracking errors are shown in fig 12 where ave represents the average value max represents the maximum value and stdev denotes the standard deviation value it is clearly seen that the tracking errors can all maintain at a low level in cases 1 3 however as the disturbance becomes more complicated the tracking accuracy is degraded the estimations of d u d w and d q in three simulation cases are shown in fig 13 14 and 15 the results indicate that the proposed disturbance observer can achieve good estimation with small errors besides since the linear velocities are unmeasured the disturbance observer has to be designed based on the estimate value of linear velocities rather than the actual values when there is a deviation between the velocity estimation value and the actual value in the initial adjustment phase some errors appear in the disturbance observation this phenomenon is normal and will not affect the overall disturbance observation based on the above analyses it can be concluded that the proposed method has good disturbance observation ability thus leading to good robustness against disturbances 4 4 robust test against rudder failures rudder stuck is a common type of rudder failure which directly affect maneuverability and may bring great danger to the auv the x rudder auv discussed in this paper has multi rudder independent control capability so it still has certain maneuverability when some rudders are stuck moreover the proposed multi objective optimization method can still achieve rudder allocation when some rudders are stuck therefore the proposed controller has certain robustness against rudder failures in this section the robustness of proposed controller will be tested against rudder failures and the adjusting function of parameter ξ will also be verified the rudder stuck settings are shown in table 2 in cases 4 7 the condition of one rudder stuck is considered whereas the condition of two rudders stuck is considered in case 8 the desired trajectory initial conditions and disturbance settings of the system are the same as subsection 4 2 the simulations of this section are implemented in following two stages first the trajectory tracking performance of proposed controller is verified with one rudder stuck in cases 4 7 the weight coefficient of optimization objective function is selected as ξ 0 5 which means both the trajectory tracking and energy consumption problem are considered in optimization objective the tracking trajectories and tracking errors of cases 4 7 are shown in fig 16 and fig 17 it is seen that the proposed controller can still achieve good trajectory tracking with one rudder stuck although the trajectory tracking errors are different under different rudder stuck angles they are all maintained at a lower level to further analyze the tracking performance of proposed controller more stuck angles are considered across the entire rudder range 30 30 and the simulation results are shown in fig 18 it is observed that the proposed controller can achieve satisfactory trajectory tracking with small errors under all the rudder stuck samples the rudder allocation performances of cases 4 7 are shown in fig 19 compared with section 4 2 the rudder angles exhibit more dramatic changes therefore it is proved that the proposed controller can achieve good trajectory tracking with one rudder stuck but other rudders have to be controlled more intensely to make up for the impact of stuck rudder second the trajectory tracking performance of proposed controller is verified under the condition of two rudders stuck when ξ 0 5 the tracking trajectory and rudder allocation of case 8 are shown in fig 20 and fig 21 compared with cases 4 7 it is easily observed that the trajectory tracking performance of case 8 is degraded when trajectory tracking and energy consumption problem are both considered in optimization objective besides as shown in fig 21 since the two rudders have been stuck the rudder angles of the other two rudders show dramatic changes in order to achieve the control target to further verify the adjusting function of parameter ξ the energy consumption problem is ignored and the value of ξ is changed to ξ 1 the simulation results are shown in fig 22 and fig 23 it is clearly seen that the tracking performance of case 8 is greatly improved when energy consumption problem is ignored but as shown in fig 23 this also has some negative effects that is the rudder angles change more drastically thus consuming too much energy from the above simulation results following conclusions can be drawn 1 the proposed multi objective optimization method has certain robustness against rudder failures and can achieve good trajectory tracking with one rudder stuck however when facing with serious failures the maneuverability and trajectory tracking capability will be degraded 2 when facing with two rudders stuck the tracking performance can be improved by adjusting the optimization target but it brings huge energy consumption moreover too aggressive rudder angle control may not be realized under real working conditions 3 when facing with most serious rudder failures such as three rudders stuck the maneuverability will be degraded more seriously which may cause failed tracking missions in this case the trajectory tracking mission needs to be adjusted or even the vehicle should be recycled based on the above analysis we believe that in the presence of rudder failures it is better to have a failure analyzer to classify the failures and then take corresponding methods based on the result of the failure quantification for example when facing with low level failure the optimization target or control parameters can be adjusted to help complete the mission whereas when facing with high level failure it is preferred to change the tracking target or perform emergency recycling the simulation results of this paper will provide a good basis for the design of the rudder failure analyzer in addition this paper only analyzes the tracking control in the vertical plane in fact the impact of the rudder failure on the vehicle is multi faceted even if the tracking control can be completed in the vertical plane the control of the horizontal plane may suffer from other negative effects this will be addressed in our future works 5 conclusions this paper addresses the trajectory tracking problem of a x rudder auv in vertical plane subjects to velocity sensor failure and uncertainties an optimal robust trajectory tracking controller is developed based on linear velocity observers los based backstepping kinematics controller robust disturbance rejection dynamics controller and multi objective optimal rudder allocator the salient features of the proposed control method are as follows first the unmeasured linear velocities can be well estimated by esos which helps releasing the requirements of linear velocity measurement second the system robustness is addressed by the proposed robust disturbance rejection dynamics controller third the multi objective optimal rudder allocator can achieve satisfactory rudder angle calculation with rudder input saturation and it is not only energy efficient but also robust against rudder failures lyapunov analysis is performed to prove the stability and performance of the proposed controller moreover the robustness and effectiveness of the controller are tested and validated through comparative numerical simulations for future research it is of interest to extend the current work to 3d space and incorporate more state constraints and fault tolerant methods in the trajectory tracking controller design author contribution statement 1 yingkai xia conceptualization methodology software validation writing original draft visualization 2 kan xu investigation data curation software 3 wenjin wang data curation validation 4 guohua xu conceptualization supervision 5 xianbo xiang writing reviewing and editing 6 ye li writing reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported in part by national natural science foundation of china grant numbers 51479114 51579111 51761135012 and the post doctoral foundation of china grant number 2018m632117 
22078,in this paper a finite time adaptive tracking control fatc scheme based on nonsingular terminal sliding mode ntsm is proposed for trajectory tracking of a marine vehicle with complex unknowns and input saturation first a finite time tracking differentiator ftd is designed to acquire the smooth position signal and its derivative besides an adaptive assistant system is introduced to overcome the adverse effects caused by the nonlinear saturation factors and then the non singular terminal sliding surface is constructed to achieve finite time stability considering the position error and velocity error of the marine vehicle subsequently to attenuate unknown uncertainties the radial basis function neural network rbfnn is adopted to approximate the model uncertainties moreover the adaptive law is introduced to estimate the boundary value of neural network approximation error and external disturbances it can be proved that the proposed fatc scheme can make the trajectory tracking errors converge to a tiny neighborhood near zero in a finite time simulation studies and comprehensive comparisons based on a 76 2m supply vessel are exhaustively provided to confirm the effectiveness and superiority of the proposed fatc scheme keywords full actuated marine vehicle finite time stability finite time tracking differentiator nonsingular terminal sliding mode rbf neural network 1 introduction due to increasingly important roles in various marine applications including deep ocean exploration subsea pipelines construction offshore oil drilling and supply a great deal of attentions have been paid to the three degree of freedom 3 dof fully actuated marine vehicle with high autonomy in this case in order to achieve these complex tasks designing highly advanced control system for marine vehicle has attracted more and more research enthusiasms because of its excellent convergence speed strong robustness and high precision terminal sliding mode tsm is designed to achieve finite time convergence these features of tsm have attracted the attention of many scholars and a large number of research results have arised hong et al 2004 yu et al 2005 feng et al 2009 li et al 2013a b for example a finite time control scheme hong et al 2004 based on improved tsm is proposed for single input systems a new continuous finite time controller is designed in the work of ref yu et al 2005 using tsm for the manipulators trajectory tracking system with parameter uncertainties although these methods have good effects on the tracking and stabilization the uncertainties of control system is not considered in hong et al 2004 and uncertain upper boundary in yu et al 2005 needs to be known strictly speaking the above methods have not solved the controller design problem of control system with complex uncertainties in practice a marine vehicle inevitably suffers from various unknowns induced by unmodeled dynamics winds waves and currents etc which is a great challenge for marine vehicle trajectory tracking control fossen 2002 therefore it is urgent to enhance the robustness and anti interference ability so as to provide a reliable marine vehicle control system the existing methods estimate uncertainties by means of adaptive control lu and xia 2013 neural network seshagiri and khalil 2000 shen et al 2020 fuzzy control wang et al 2016 observer hu et al 2014 wang et al 2017 wavelet network lin 2006 and other methods and use the estimated values to form real time feedback among them because of its good approximation ability and fast learning speed rbfnn is introduced in shen et al 2020 to estimate the internal uncertainties and good fitting effect is obtained system uncertainties in hu et al 2014 wang et al 2017 must be derivable which makes the applicable scope of the observer severely limited besides fuzzy wavelet network is used to estimate the unknown uncertain function in lin 2006 but the computational complexity increases significantly moreover only asymptotic stability can be obtained in seshagiri and khalil 2000 and wang et al 2016 obviously the finite time convergence of the system states can be completely realized by tsm however the tsm dynamics would inevitably suffer from the singularity problem fortunately the ntsm technique in feng et al 2002 can effectively overcome the singularity problem encountered in tsm in addition to finite time strategies based on tsm strategies wang et al 2018 sun et al 2018 based on backstepping and neural network fuzzy adaptive control combined with non strict feedback can also achieve finite time stability also a globally finite time tracking control scheme yu et al 2019 using proportional integral derivative sliding mode is addressed for trajectory tracking of underactuated uuvs with model parameter perturbation and unknown ocean currents it can be clearly seen from wang et al 2018 sun et al 2018 and yu et al 2019 that both the convergence speed and the control accuracy have been significantly improved compared to the infinite time control methods nevertheless finite time control problem of a marine vehicle in the presence of complex unknowns is still largely open furthermore the input saturation problem in existing finite time control methods is rarely considered up to now there are many feasible anti saturation control methods specific saturation functions are combined such as hyperbolic tangent function to ensure that the control torque is within the limits in hu and zhang 2015 and zou et al 2016 but this method can only guarantee that the system is progressively convergent and the response speed is slow backstepping controllers are designed in wen et al 2011 and li et al 2013a b by processing the saturation function with hyperbolic tangent function and nussbaum function considering the nonlinear system with unknown dynamics the nonlinear disturbance observer in chen et al 2015 is designed to estimate the saturation error finally a control strategy combining neural network and dynamic surface is proposed an aided system in xiao et al 2013 is designed to directly offset the saturation effect but the upper boundary of the uncertainties is still known the above studies have achieved great progress in solving the problem of control system design with input saturation but control systems are not finite time stable a novel non singular terminal sliding mode surface is proposed by ding and zheng 2014 by using the saturation function the global stability is guaranteed and the system states converge to the origin in finite time even so controller performance will be affected due to the direct limitation of parameters apparently the velocity of marine vehicle is often unmeasurable in practice by chance nonlinear tracking differentiator td is proposed by han and wang 1994 to filter for a given signal and get its differential yet chattering phenomena is easy to occur because of sign function the td proposed in bu et al 2015 is simple in structure and has no chattering phenomenon but it is impossible to prove that the estimation error is bounded the estimation errors of the td in gao et al 2001 and han 2009 can converge quickly but it is not finite time stable fortunately a ftd with simple structure and no chattering is proposed in wang et al 2007 which is able to accurately track differential signals in this paper inspired by above observations we will intensively solve finite time adaptive tracking control fatc problem for both location and velocity tracking of a marine vehicle with complex unknowns and input saturation to this end on the basis of ntsm a fatc scheme based on ftd adaptive assistant system rbfnn and adaptive technique is addressed to realize finite time trajectory tracking control of a marine vehicle in the case of existing complex unknowns and input saturation the adaptive assist system is used to overcome the adverse effects of nonlinear saturation factors inspired by wang et al 2007 the ftd is designed to acquire real time position and velocity signals to improve the anti jamming performance effectively the rbfnn is used to approximate the model uncertainties and the adaptive law is designed to estimate the boundary value of neural network approximation error and external disturbances obviously the proposed fatc scheme is superior to asymptotically exponentially convergent approach since tiny error tracking can be achieved within a finite time main contributions are as follows 1 a ftd combining the dynamic characteristics of a marine vehicle is designed to accurately estimate the real time position and velocity signals not only that a strict finite time stability proof is given 2 to effectively weaken complex unknowns the rbfnn and adaptive control is introduced which therefore produces strong disturbance rejection in addition to tiny error trajectory tracking 3 aiming to conquer the harmful influences caused by actuator saturation an adaptive assist system is addressed which eventually achieves finite time trajectory tracking of a marine vehicle with input saturation the rest of this paper is organized as follows in section 2 problem formulation and preliminaries are addressed the fatc approach together with theoretical analyses on finite time stability are given in section 3 simulation results and discussions are presented in section 4 conclusions are drawn in section 5 2 problem formulation and preliminaries 2 1 problem formulation assume that a marine vehicle has a bilaterally symmetric structure and only the 3 dof of forward drift and yaw are considered the kinematics and dynamics of the marine vehicle moving in the planar space can be expressed as follows 1 η j ψ υ m υ n η υ τ d δ f where 2 n η υ c υ υ d υ here η x y ψ t is the 3 dof position x y and heading angle ψ of the marine vehicle in the earth fixed frame υ u v r t is the corresponding linear velocities i e forward velocities drift velocities and yaw angular rate in the body fixed frame τ τ 1 τ 2 τ 3 t is control input and is limited by actuator saturation j ψ is a rotation matrix given by 3 j ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 with the following natures 4a j ψ j ψ s r 4b j t ψ s r j ψ j ψ s r j t ψ s r where s r 0 r 0 r 0 0 0 0 0 m is the positive inertia matrix c υ and d are coriolis centripetal matrix and damping matrix respectively d m j t δ t with δ t δ 1 t δ 2 t δ 3 t t and δ f m j t ϑ t with ϑ t ϑ 1 t ϑ 2 t ϑ 3 t t are unmodeled dynamics and mixed external disturbances respectively consider the desired trajectory generated by 5 η d j ψ d υ d m υ d n d η d υ d τ d where 6 n d η d υ d c υ d υ d d υ d here η d x d y d ψ d t and υ d u d v d r d t represent the desired position and velocity vectors respectively assumption 1 the desired position η d is smooth and bounded and its first and second order derivatives are available and bounded assumption 2 the matrices m c υ and d are known besides the uncertainties ϑ t and the disturbances δ t are unknown and bounded in this paper the control target to be achieved is to design a reasonable control law τ such that the trajectory tracking errors η η d and velocity tracking errors υ υ d can converge to a tiny neighborhood of the origin in a finite time in what follows finite time trajectory tracking strategy will be designed for a marine vehicle to achieve the foregoing target 2 2 preliminaries for simplicity key lemmas commonly used in this paper are collected as follows lemma 1 bhat and bernstein 1997 consider a nonlinear system as follows 7 x t f x t x 0 0 f 0 0 x u 0 r n where f is continuous and u 0 is an open neighborhood of the origin suppose there is a positive definite function v x which satisfies v x λ v α x 0 where λ 0 and 0 α 1 then the origin of system 7 is finite time stable and the time to reach v x 0 satisfies t v 1 α 0 λ 1 α lemma 2 zhang et al 2015 for any real number x i i 1 n and 0 b 1 the following inequalities are satisfied 8 x 1 x 2 x n b x 1 b x 2 b x n b 3 controller design and stability analysis 3 1 model transformation consider the following coordinate transformation on υ and υ d 9a w j ψ υ 9b w d j ψ d υ d where w w 1 w 2 w 3 t and w d w d 1 w d 2 w d 3 t let j j ψ j j ψ d s s w 3 s d s w d 3 combining 1 and 2 with 9a and considering natures in 4 we can get 10 η w w j m 1 τ h η w δ t ϑ t where 11 h η w s w j m 1 n η j t w similarly by 5 6 and 9b we can obtain 12 η d w d w d j d m 1 τ d h d η d w d where 13 h d η d w d s d w d j d m 1 n d η d j d t w d combining 10 11 with 12 13 we obtain 14 η e w e w e j m 1 τ h e η w η d w d δ t ϑ t where 15 h e s w s d w d j m 1 n η j t w j d m 1 n d j d m 1 τ d here η e η η d η e 1 η e 2 η e 3 t w e w w d w e 1 w e 2 w e 3 t 3 2 finite time tracking differentiator design inspired by wang et al 2007 a ftd combining the dynamic characteristics of the control system is designed to solve the problem of unmeasurable velocity 16 ζ 1 ζ 2 ζ 2 χ 2 a 1 arctan ζ 1 η a 2 arctan ζ 2 χ h ζ 1 ζ 2 j ζ 1 3 m 1 τ here χ and a i i 1 2 are positive definite design parameter matrices ζ 1 ζ 1 1 ζ 1 2 ζ 1 3 t and ζ 2 ζ 2 1 ζ 2 2 ζ 2 3 t are estimates of η and w respectively we can get the estimate of the velocity vector 17 υ ˆ j t ψ ζ 2 define the tracking errors of the ftd 16 18a e η ζ 1 η 18b e w ζ 2 η where e η e η 1 e η 2 e η 3 t e w e w 1 e w 2 e w 3 t differentiating 18 with respect to time yields 19a e η ζ 1 w e w 19b e w ζ 2 w χ 2 a 1 arctan e η a 2 arctan ζ 2 χ h ζ 1 ζ 2 j ζ 1 3 m 1 τ w design a sufficiently large parameter matrix χ so that arctan ζ 2 χ ζ 2 χ o ζ 2 χ here o ζ 2 χ is the high order infinitesimal of ζ 2 χ then 19b is rewritten as 20 e w χ 2 a 1 arctan e η a 2 χ 1 e w h ζ 1 ζ 2 j ζ 1 3 m 1 τ w a 2 χ w let φ t h ζ 1 ζ 2 j ζ 1 3 m 1 τ w a 2 χ w and assume φ θ here θ 0 is a constant theorem 1 consider the marine vehicle system 14 and 15 the ftd 16 is designed if the parameter matrix χ is large enough and the parameter matrix a i is properly chosen the actual signals ζ 1 and ζ 2 can track exactly the desired signals η and w in a finite time proof consider the lyapunov function as follows 21 v 0 1 2 arctan e η t e w t p arctan e η e w where p a 2 a 1 1 0 χ since χ and a i are positive definite matrices p is a positive definite matrix the time derivation of 21 is 22 v 0 arctan e η t e w t a 2 a 1 1 0 χ i n i n d i a g e η 2 e w a 1 χ 2 arctan e η a 2 χ e w φ arctan e η t a 2 i n d i a g e η 2 e w arctan e η t χ 2 arctan e η arctan e η t a 1 1 a 2 χ e w arctan e η t a 1 1 arctan 1 e η φ t arctan e η e w t a 1 χ 3 arctan e η e w t a 2 χ 2 e w e w t χ e w 1 φ t e w arctan e η t e w t q arctan e η e w where q χ 2 φ t a 1 arctan e η a 1 χ 3 a 2 a 1 χ a 2 i n d i a g e η 2 a 2 χ 2 χ e w φ t by choosing a larger χ and a reasonable a i it is easy to make q a positive definite matrix as can be seen from 21 23 arctan e η v 0 1 2 χ min p hence 24 v 0 χ max p arctan e η 2 e w 2 arctan e η χ max p arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w v 0 1 2 χ min p χ max p arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w from 24 we can obtain 25 χ min p χ max p v 0 1 2 arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w let γ q d i a g arctan e η 1 i 2 substituting 22 into 25 yields 26 v 0 χ min γ χ min p χ max p v 0 1 2 thus it can be seen from lemma 1 that ftd 16 can estimate η and w in a finite time 27 t 0 2 χ max p χ min γ χ min p v 0 1 2 0 further we can get from 26 that v 0 is a monotonically decreasing function when 0 t t 0 we have v 0 v 0 0 therefore e η and e w are bounded in 0 t 0 and there are 28a arctan e η v 0 1 2 0 χ min p 28b e w v 0 1 2 0 χ min p this completes the proof remark 1 for ftd 16 it is easy to know that by reasonably designing parameters χ and a i the system 16 can be stabilized so that the signals ζ 1 and ζ 2 are bounded combined with the proof of controller stability in section 3 3 it is not difficult to know that the hypothesis φ θ is rational remark 2 because of its obvious advantages including fewer parameters easy conditioning and no chattering the ftd proposed in this paper is superior to other ftds 3 3 finite time adaptive tracking controller design in practice excessive control law values are often difficult to operate because of actuator saturation in order to solve the problem of input saturation a stable adaptive auxiliary system is designed as follows 29 λ 1 c 1 λ 1 λ 2 λ 2 c 2 λ 2 j ζ 1 3 m 1 δ u where λ 1 λ 1 1 λ 1 2 λ 1 3 t and λ 2 λ 2 1 λ 2 2 λ 2 3 t are auxiliary vectors c 1 and c 2 are positive definite parameter vectors and in order to prevent the instability caused by too large δ u it is necessary to assure that c 1 and c 2 are large enough δ u τ a τ b τ b and τ a are the control inputs before and after the restriction respectively actually τ a is τ in 1 assuming that the maximum value of control input is τ max then τ a can be described as 30 τ a s a t τ b τ b τ b τ max τ max sgn τ b τ b τ max consider the following ntsm manifold 31 σ e 1 1 β e 2 p q where σ σ 1 σ 2 σ 3 t is the defined sliding variable β 0 1 p q γ 2 p and q are both positive old integers e 1 ζ 1 η d λ 1 e 1 1 e 1 2 e 1 3 t e 2 ζ 2 η d λ 1 e 2 1 e 2 2 e 2 3 t the derivative of 31 is 32 σ e 1 γ β d i a g e 2 γ 1 e 2 introduce rbfnn to approximate the internal uncertainties ϑ t 33 ϑ t w t h z ε z where z υ ˆ is the input vector ε z ε 1 z ε 2 z ε 3 z t is the approximation error of rbfnn w ω 1 t 0 1 l 0 1 l 0 1 l ω 2 t 0 1 l 0 1 l 0 1 l ω 3 t r 3 l 3 is a matrix of ideal weight vectors for all z ω z ε i z is the smallest then ω i is ω i i 1 2 3 l is the number of neurons h z h 1 t z h 2 t z h 3 t z t r 3 l is a vector of radial basis functions h i z h i 1 z h i l z t r l h i j is constructed as follows 34 h i j exp z c j t z c j 2 b i j 2 here j 1 l b i j 0 is the width of the gaussian function c j c j 1 c j 2 c j 3 t r 3 is the center of the gaussian function assumption 3 as for all z ω z the ideal constant weight vector ω i and the approximation error ε i z are bounded that is there exists positive constants ω i m and ε i m z which satisfy ω i ω i m ε i z ε i m z under assumption 2 we can get there exists a positive unknown constant bounded vector θ θ 1 θ 2 θ 3 t which ε i z δ i θ i i 1 2 3 consider the marine vehicle trajectory tracking system 14 and 15 and the sliding functions 31 and 32 the fatc law τ f a t c can be designed accordingly 35 τ f a t c m j 1 ζ 1 3 ϑ ˆ k σ ξ θ ˆ β γ 1 e 2 2 γ h e ζ 1 ζ 2 η d w d c 1 λ 1 c 2 λ 2 here k is a positive definite parameter matrix ϑ ˆ w ˆ t h z is the estimate of ϑ t ξ d i a g tanh σ 1 κ 1 tanh σ 2 κ 2 tanh σ 3 κ 3 r 3 3 κ i is a positive constant w ˆ and θ ˆ are the estimate vectors of w and θ respectively the update law for ω ˆ i and the adaptive law for θ ˆ can be designed as 36 ω ˆ i k 1 i μ i σ i h i z 37 θ ˆ k 2 μ ξ σ where both k 1 i r l l and k 2 r 3 3 are positive definite parameter matrices μ d i a g μ 1 μ 2 μ 3 γ β 1 d i a g e 2 γ 1 remark 3 the hyperbolic tangent function ξ is introduced to replace the sign function sgn σ which can effectively eliminate chattering phenomenon theorem 2 consider the closed loop system composed of 31 37 tracking errors η e and w e will converge to a small neighborhood near zero in a finite time proof the proof of theorem 2 is divided into two steps the global stability is analyzed at first then it will be proven that the sliding variable σ can converge to σ 0 in a finite time this part is divided into two stages i e the reaching and sliding phases consider the candidate lyapunov function as follows 38 v 1 1 2 σ t σ 1 2 i 1 3 ω i t k 1 i 1 ω i 1 2 θ t k 2 1 θ v 0 where ω i is the approximation error for ω i such that ω i ω ˆ i ω i θ is the estimation error for θ such that θ θ ˆ θ let 39 v 2 1 2 σ t σ 1 2 i 1 3 ω i t k 1 i 1 ω i 1 2 θ t k 2 1 θ differentiating 38 with respect to time yields 40 v 1 σ t σ i 1 3 ω i t k 1 i 1 ω ˆ i θ t k 2 1 θ ˆ v 0 differentiating v 1 along 32 16 and 35 we have 41 σ t σ σ t e 1 γ β d i a g e 2 γ 1 e 2 σ t e 2 γ β d i a g e 2 γ 1 ζ 2 η d λ 1 σ t μ β γ e 2 2 γ ζ 2 η d λ 1 σ t μ β γ e 2 2 γ h ζ 1 ζ 2 j ζ 1 3 m 1 τ f a t c χ 2 a 1 arctan e η a 2 arctan ζ 2 χ η d c 1 λ 1 c 2 λ 2 σ t μ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ ϑ ˆ k σ ξ θ ˆ according to 40 combining 41 with 36 37 we obtain 42 v 2 σ t μ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ ϑ ε z k σ ξ θ on the basis of assumption 3 we can acquire σ t μ ε z ξ θ 0 let φ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ clearly ϑ φ is bounded the parameter matrix k is designed to make σ t μ ϑ φ k σ 0 thus v 2 0 can be received also v 0 0 can be obtained in the light of inequality 26 consequently v 1 0 is gained easily to sum up the system 14 and 15 is stable according to the lyapunov theory and σ ω i θ are bounded next the finite time stability of σ will be confirmed 1 reaching phase since θ is bounded it can be assumed that θ 0 so that for t 0 there is θ ˆ θ consider the lyapunov function as follows 43 v 3 1 2 σ t σ 1 2 ϕ θ θ ˆ t θ θ ˆ where ϕ 0 is arbitrary constant in the light of 41 the time derivation of 43 is 44 v 3 σ t σ 1 ϕ θ θ ˆ θ ˆ σ t μ ϑ ˆ k σ ξ θ ˆ φ 1 ϕ θ θ ˆ θ ˆ apparently ϑ ˆ is bounded and we assume 45 ϑ ˆ φ ϖ here ϖ r 3 1 is arbitrary positive definite vector substituting 37 45 into 44 yields 46 v 3 σ t μ k σ σ t μ ξ θ ˆ σ t μ ϖ k 2 ϕ μ θ θ ˆ t σ by reasonably designing the parameter k we can make 47 v 3 μ θ ˆ ϖ σ k 2 ϕ μ θ θ ˆ σ ρ 1 σ ρ 2 θ θ ˆ where ρ 1 and ρ 2 are the minimum of μ θ ˆ ϖ and k 2 ϕ μ σ respectively on the basis of lemma 2 47 can be deduced as follows 48 v 3 2 ρ 1 σ 2 2 ρ 2 θ θ ˆ 2 min 2 ρ 1 2 ρ 2 σ 2 θ θ ˆ 2 ρ σ 2 2 θ θ ˆ 2 2 1 2 ρ v 3 1 2 where ρ min 2 ρ 1 2 ρ 2 0 is a constant according to lemma 1 the fatc strategy designed in this paper can reach v 3 0 in a finite time t 3 2 v 3 1 2 0 ρ 2 sliding phase followed that we will prove that once the manifold is reached tracking errors η e and w e will converge to a tiny neighborhood of the origin along the manifold in a finite time when σ 0 by 31 we can gain 49 e 1 1 β e 2 p q 0 i e 50 e 1 j 1 β e 2 j p q 0 j 1 2 3 hence errors e 1 j and e 2 j can be stabilized to zero along σ j 0 at time t p β q p e 1 j 1 q p t 3 p q t 3 according to theorem 1 e η j and e w j will converge to zero in a finite time besides when t λ 1 j 0 λ 1 j 0 in fact we have e 1 j e η j η e j λ 1 j e 2 j e w j w e j λ 1 j stated thus η e j and w e j will naturally converge to a small neighborhood near the origin in a finite time this concludes the proof remark 4 if the power index p q 1 the fatc controller in 35 degenerates into the following conventional sliding mode controller smc 51 τ s m c m j 1 ζ 1 3 ϑ ˆ k σ ξ θ ˆ β e 2 h e ζ 1 ζ 2 η d w d c 1 λ 1 c 2 λ 2 from 50 we can acquire that system states e 1 and e 2 will converge to zero exponentially remark 5 theorem 2 shows that tracking errors η e and w e can converge to a tiny neighborhood near the origin in a finite time so that the desired trajectory can be tracked with high precision in a short time in contrast it can be obtained that only exponential stability can be achieved under the smc strategy in this case the raised fatc scheme in this context has obvious advantages remark 6 in wang et al 2017 the finite time observer is created to estimate complex unknowns although the complex unknowns can be exactly attenuated the uncertainties are required to be second order differentiable which makes the application scope of the observer severely limited by comparison the rbfnn and adaptive techniques introduced in this paper do not require excessive conditional constraints in addition input saturation and velocity unavailability are not considered in wang et al 2017 adaptive assist system and ftd are designed to solve the above problems in this content actually the content of this paper is more in line with the actual conditions of marine vehicle navigation 4 simulation results and discussions in order to verify the effectiveness and superiority of the proposed fatc scheme simulation will be conducted on a 76 2 m supply vessel fossen et al 1996 the target is to track the desired signals η d 500 sin 0 02 t 500 1 cos 0 02 t 0 02 t t in 5 and 6 the initial conditions are η 0 100 200 π 8 t υ 0 0 0 0 t other parameters are given as follows the positive inertia matrix m coriolis centripetal matrix c υ and damping matrix d are as follows m 1 0 6 5 3122 0 0 0 8 2831 0 0 0 3745 4 c υ 1 0 6 0 0 8 2831 v 0 0 5 3122 u 8 2831 v 5 3122 u 0 d 1 0 4 5 0242 0 0 0 27 229 439 33 0 439 33 41894 the unmodeled dynamics and the external disturbances are assumed to be as follows respectively δ f 1 0 4 0 2 5 0242 u 2 0 1 5 0242 u 3 0 2 27 299 v 2 0 1 27 299 v 3 0 2 41894 r 2 0 1 41894 r 3 d 10 5 sin 0 2 t cos 0 5 t 10 5 sin 0 1 t cos 0 4 t 10 6 sin 0 5 t cos 0 3 t the magnitudes of the actuated forces and moments are specified in the ranges given by τ 1 8 10 3 1 10 4 kn τ 2 1 1 0 5 2 5 1 0 4 kn τ 3 4 10 5 1 5 10 5 kn m parameters of adaptive assist system are designed as c 1 d i a g 10 10 10 c 2 d i a g 20 20 20 parameters of ftd χ d i a g 10 10 10 a 1 a 2 d i a g 2 2 6 the number of neurons are chosen as 61 c j 1 and c j 2 are evenly distributed between 18 18 c j 3 is evenly distributed between 0 3 0 3 b 1 j b 2 j 3 b 3 j 1 the remaining parameters are chosen as p 23 q 21 β 0 08 k d i a g 0 09 0 01 0 3 k 1 d i a g 1 10 3 2 10 3 1 10 3 k 2 3 5 10 5 6 1 0 5 2 5 10 3 in the same sea conditions the comparison with the smc strategy 51 also confirms the superiority of the proposed fatc scheme 35 correspondingly the simulation results are shown in figs 2 6 and it can be received that the proposed fatc scheme is superior to the smc strategy in convergence speed and accuracy fig 1 demonstrates the comparison between the actual trajectory and the expected trajectory under the two strategies this indicates both smc strategy and fatc scheme can track the target trajectory even though the fatc scheme can achieve a faster and more accurate response better transient performance figs 2 3 visually denote that the smc can only roughly track the desired trajectory and there are large errors while the fatc approach can completely track the desired trajectory in about 25 s as shown in figs 4 5 fatc scheme can track the desired speed more quickly about 35 s and correctly the enlarged parts in fig 6 prove that the proposed adaptive assist system 29 can still make the system run stably under the input saturation figs 7 8 reveal that the ftd 16 has a excellent tracking performance for both η and w fig 9 testifies that rbfnn can basically track the internal uncertainties and the design of adaptive law 36 is smooth and reasonable fig 10 shows that the adaptive law 37 can estimate the upper bound of the external disturbance and the approximation error of rbfnn when parameters are reasonably chosen in conclusion compared with smc plan fatc scheme has obvious advantages in fast and accurate trajectory tracking because of its finite time convergence the adaptive aided system designed in this paper can well overcome the adverse effects caused by nonlinear saturation factors in addition the tracking effect of the ftd on target position and velocity is extremely good unknown uncertainties and their bounds can be generally estimated by rbfnn and adaptive technique which improves the anti interference ability of the whole control system 5 conclusion in this paper finite time trajectory tracking control of a marine vehicle with completely unknown dynamics and external disturbances has been solved by combining ntsm rbfnn with adaptive technique considering that the input constraint often occur due to the limitation of actuator in practice an adaptive aided system is designed to effectively solve the problem of control system instability caused by input saturation in order to address the problem that the position signal contains noise and the velocity is difficult to measure in practice a ftd is designed in this paper which can converge the position and velocity errors to zero in finite time pursuing stronger disturbance rejection ability the rbfnn is adopted to approximate the model uncertainties moreover the adaptive law is introduced to estimate the boundary value of neural network approximation error and compound disturbances and thereby leading to a fatc scheme which achieves not only finite time tracking but also general disturbance attenuation as a consequence a complex marine vehicle system suffering from input saturation completely unknown dynamics and disturbances can be tracked within a finite time in terms of both position and velocity comprehensive simulation studies and comparisons on a marine vehicle have been carried out to intensively demonstrate the effectiveness and superiority of the proposed scheme credit authorship contribution statement zhipeng shen conceptualization writing review editing supervision project administration yu wang conceptualization software writing original draft writing review editing visualization haomiao yu conceptualization writing review editing supervision project administration funding acquisition chen guo conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the editor in chief the associate editor and anonymous referees for their invaluable comments and suggestions this work is supported by the national natural science foundation of china under grants 51879027 51809028 and 51579024 the fundamental research funds for the central universities china under grants 3132019109 and 3132019318 and the doctoral start up foundation of liaoning province china under grant 2019 bs 022 
22078,in this paper a finite time adaptive tracking control fatc scheme based on nonsingular terminal sliding mode ntsm is proposed for trajectory tracking of a marine vehicle with complex unknowns and input saturation first a finite time tracking differentiator ftd is designed to acquire the smooth position signal and its derivative besides an adaptive assistant system is introduced to overcome the adverse effects caused by the nonlinear saturation factors and then the non singular terminal sliding surface is constructed to achieve finite time stability considering the position error and velocity error of the marine vehicle subsequently to attenuate unknown uncertainties the radial basis function neural network rbfnn is adopted to approximate the model uncertainties moreover the adaptive law is introduced to estimate the boundary value of neural network approximation error and external disturbances it can be proved that the proposed fatc scheme can make the trajectory tracking errors converge to a tiny neighborhood near zero in a finite time simulation studies and comprehensive comparisons based on a 76 2m supply vessel are exhaustively provided to confirm the effectiveness and superiority of the proposed fatc scheme keywords full actuated marine vehicle finite time stability finite time tracking differentiator nonsingular terminal sliding mode rbf neural network 1 introduction due to increasingly important roles in various marine applications including deep ocean exploration subsea pipelines construction offshore oil drilling and supply a great deal of attentions have been paid to the three degree of freedom 3 dof fully actuated marine vehicle with high autonomy in this case in order to achieve these complex tasks designing highly advanced control system for marine vehicle has attracted more and more research enthusiasms because of its excellent convergence speed strong robustness and high precision terminal sliding mode tsm is designed to achieve finite time convergence these features of tsm have attracted the attention of many scholars and a large number of research results have arised hong et al 2004 yu et al 2005 feng et al 2009 li et al 2013a b for example a finite time control scheme hong et al 2004 based on improved tsm is proposed for single input systems a new continuous finite time controller is designed in the work of ref yu et al 2005 using tsm for the manipulators trajectory tracking system with parameter uncertainties although these methods have good effects on the tracking and stabilization the uncertainties of control system is not considered in hong et al 2004 and uncertain upper boundary in yu et al 2005 needs to be known strictly speaking the above methods have not solved the controller design problem of control system with complex uncertainties in practice a marine vehicle inevitably suffers from various unknowns induced by unmodeled dynamics winds waves and currents etc which is a great challenge for marine vehicle trajectory tracking control fossen 2002 therefore it is urgent to enhance the robustness and anti interference ability so as to provide a reliable marine vehicle control system the existing methods estimate uncertainties by means of adaptive control lu and xia 2013 neural network seshagiri and khalil 2000 shen et al 2020 fuzzy control wang et al 2016 observer hu et al 2014 wang et al 2017 wavelet network lin 2006 and other methods and use the estimated values to form real time feedback among them because of its good approximation ability and fast learning speed rbfnn is introduced in shen et al 2020 to estimate the internal uncertainties and good fitting effect is obtained system uncertainties in hu et al 2014 wang et al 2017 must be derivable which makes the applicable scope of the observer severely limited besides fuzzy wavelet network is used to estimate the unknown uncertain function in lin 2006 but the computational complexity increases significantly moreover only asymptotic stability can be obtained in seshagiri and khalil 2000 and wang et al 2016 obviously the finite time convergence of the system states can be completely realized by tsm however the tsm dynamics would inevitably suffer from the singularity problem fortunately the ntsm technique in feng et al 2002 can effectively overcome the singularity problem encountered in tsm in addition to finite time strategies based on tsm strategies wang et al 2018 sun et al 2018 based on backstepping and neural network fuzzy adaptive control combined with non strict feedback can also achieve finite time stability also a globally finite time tracking control scheme yu et al 2019 using proportional integral derivative sliding mode is addressed for trajectory tracking of underactuated uuvs with model parameter perturbation and unknown ocean currents it can be clearly seen from wang et al 2018 sun et al 2018 and yu et al 2019 that both the convergence speed and the control accuracy have been significantly improved compared to the infinite time control methods nevertheless finite time control problem of a marine vehicle in the presence of complex unknowns is still largely open furthermore the input saturation problem in existing finite time control methods is rarely considered up to now there are many feasible anti saturation control methods specific saturation functions are combined such as hyperbolic tangent function to ensure that the control torque is within the limits in hu and zhang 2015 and zou et al 2016 but this method can only guarantee that the system is progressively convergent and the response speed is slow backstepping controllers are designed in wen et al 2011 and li et al 2013a b by processing the saturation function with hyperbolic tangent function and nussbaum function considering the nonlinear system with unknown dynamics the nonlinear disturbance observer in chen et al 2015 is designed to estimate the saturation error finally a control strategy combining neural network and dynamic surface is proposed an aided system in xiao et al 2013 is designed to directly offset the saturation effect but the upper boundary of the uncertainties is still known the above studies have achieved great progress in solving the problem of control system design with input saturation but control systems are not finite time stable a novel non singular terminal sliding mode surface is proposed by ding and zheng 2014 by using the saturation function the global stability is guaranteed and the system states converge to the origin in finite time even so controller performance will be affected due to the direct limitation of parameters apparently the velocity of marine vehicle is often unmeasurable in practice by chance nonlinear tracking differentiator td is proposed by han and wang 1994 to filter for a given signal and get its differential yet chattering phenomena is easy to occur because of sign function the td proposed in bu et al 2015 is simple in structure and has no chattering phenomenon but it is impossible to prove that the estimation error is bounded the estimation errors of the td in gao et al 2001 and han 2009 can converge quickly but it is not finite time stable fortunately a ftd with simple structure and no chattering is proposed in wang et al 2007 which is able to accurately track differential signals in this paper inspired by above observations we will intensively solve finite time adaptive tracking control fatc problem for both location and velocity tracking of a marine vehicle with complex unknowns and input saturation to this end on the basis of ntsm a fatc scheme based on ftd adaptive assistant system rbfnn and adaptive technique is addressed to realize finite time trajectory tracking control of a marine vehicle in the case of existing complex unknowns and input saturation the adaptive assist system is used to overcome the adverse effects of nonlinear saturation factors inspired by wang et al 2007 the ftd is designed to acquire real time position and velocity signals to improve the anti jamming performance effectively the rbfnn is used to approximate the model uncertainties and the adaptive law is designed to estimate the boundary value of neural network approximation error and external disturbances obviously the proposed fatc scheme is superior to asymptotically exponentially convergent approach since tiny error tracking can be achieved within a finite time main contributions are as follows 1 a ftd combining the dynamic characteristics of a marine vehicle is designed to accurately estimate the real time position and velocity signals not only that a strict finite time stability proof is given 2 to effectively weaken complex unknowns the rbfnn and adaptive control is introduced which therefore produces strong disturbance rejection in addition to tiny error trajectory tracking 3 aiming to conquer the harmful influences caused by actuator saturation an adaptive assist system is addressed which eventually achieves finite time trajectory tracking of a marine vehicle with input saturation the rest of this paper is organized as follows in section 2 problem formulation and preliminaries are addressed the fatc approach together with theoretical analyses on finite time stability are given in section 3 simulation results and discussions are presented in section 4 conclusions are drawn in section 5 2 problem formulation and preliminaries 2 1 problem formulation assume that a marine vehicle has a bilaterally symmetric structure and only the 3 dof of forward drift and yaw are considered the kinematics and dynamics of the marine vehicle moving in the planar space can be expressed as follows 1 η j ψ υ m υ n η υ τ d δ f where 2 n η υ c υ υ d υ here η x y ψ t is the 3 dof position x y and heading angle ψ of the marine vehicle in the earth fixed frame υ u v r t is the corresponding linear velocities i e forward velocities drift velocities and yaw angular rate in the body fixed frame τ τ 1 τ 2 τ 3 t is control input and is limited by actuator saturation j ψ is a rotation matrix given by 3 j ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 with the following natures 4a j ψ j ψ s r 4b j t ψ s r j ψ j ψ s r j t ψ s r where s r 0 r 0 r 0 0 0 0 0 m is the positive inertia matrix c υ and d are coriolis centripetal matrix and damping matrix respectively d m j t δ t with δ t δ 1 t δ 2 t δ 3 t t and δ f m j t ϑ t with ϑ t ϑ 1 t ϑ 2 t ϑ 3 t t are unmodeled dynamics and mixed external disturbances respectively consider the desired trajectory generated by 5 η d j ψ d υ d m υ d n d η d υ d τ d where 6 n d η d υ d c υ d υ d d υ d here η d x d y d ψ d t and υ d u d v d r d t represent the desired position and velocity vectors respectively assumption 1 the desired position η d is smooth and bounded and its first and second order derivatives are available and bounded assumption 2 the matrices m c υ and d are known besides the uncertainties ϑ t and the disturbances δ t are unknown and bounded in this paper the control target to be achieved is to design a reasonable control law τ such that the trajectory tracking errors η η d and velocity tracking errors υ υ d can converge to a tiny neighborhood of the origin in a finite time in what follows finite time trajectory tracking strategy will be designed for a marine vehicle to achieve the foregoing target 2 2 preliminaries for simplicity key lemmas commonly used in this paper are collected as follows lemma 1 bhat and bernstein 1997 consider a nonlinear system as follows 7 x t f x t x 0 0 f 0 0 x u 0 r n where f is continuous and u 0 is an open neighborhood of the origin suppose there is a positive definite function v x which satisfies v x λ v α x 0 where λ 0 and 0 α 1 then the origin of system 7 is finite time stable and the time to reach v x 0 satisfies t v 1 α 0 λ 1 α lemma 2 zhang et al 2015 for any real number x i i 1 n and 0 b 1 the following inequalities are satisfied 8 x 1 x 2 x n b x 1 b x 2 b x n b 3 controller design and stability analysis 3 1 model transformation consider the following coordinate transformation on υ and υ d 9a w j ψ υ 9b w d j ψ d υ d where w w 1 w 2 w 3 t and w d w d 1 w d 2 w d 3 t let j j ψ j j ψ d s s w 3 s d s w d 3 combining 1 and 2 with 9a and considering natures in 4 we can get 10 η w w j m 1 τ h η w δ t ϑ t where 11 h η w s w j m 1 n η j t w similarly by 5 6 and 9b we can obtain 12 η d w d w d j d m 1 τ d h d η d w d where 13 h d η d w d s d w d j d m 1 n d η d j d t w d combining 10 11 with 12 13 we obtain 14 η e w e w e j m 1 τ h e η w η d w d δ t ϑ t where 15 h e s w s d w d j m 1 n η j t w j d m 1 n d j d m 1 τ d here η e η η d η e 1 η e 2 η e 3 t w e w w d w e 1 w e 2 w e 3 t 3 2 finite time tracking differentiator design inspired by wang et al 2007 a ftd combining the dynamic characteristics of the control system is designed to solve the problem of unmeasurable velocity 16 ζ 1 ζ 2 ζ 2 χ 2 a 1 arctan ζ 1 η a 2 arctan ζ 2 χ h ζ 1 ζ 2 j ζ 1 3 m 1 τ here χ and a i i 1 2 are positive definite design parameter matrices ζ 1 ζ 1 1 ζ 1 2 ζ 1 3 t and ζ 2 ζ 2 1 ζ 2 2 ζ 2 3 t are estimates of η and w respectively we can get the estimate of the velocity vector 17 υ ˆ j t ψ ζ 2 define the tracking errors of the ftd 16 18a e η ζ 1 η 18b e w ζ 2 η where e η e η 1 e η 2 e η 3 t e w e w 1 e w 2 e w 3 t differentiating 18 with respect to time yields 19a e η ζ 1 w e w 19b e w ζ 2 w χ 2 a 1 arctan e η a 2 arctan ζ 2 χ h ζ 1 ζ 2 j ζ 1 3 m 1 τ w design a sufficiently large parameter matrix χ so that arctan ζ 2 χ ζ 2 χ o ζ 2 χ here o ζ 2 χ is the high order infinitesimal of ζ 2 χ then 19b is rewritten as 20 e w χ 2 a 1 arctan e η a 2 χ 1 e w h ζ 1 ζ 2 j ζ 1 3 m 1 τ w a 2 χ w let φ t h ζ 1 ζ 2 j ζ 1 3 m 1 τ w a 2 χ w and assume φ θ here θ 0 is a constant theorem 1 consider the marine vehicle system 14 and 15 the ftd 16 is designed if the parameter matrix χ is large enough and the parameter matrix a i is properly chosen the actual signals ζ 1 and ζ 2 can track exactly the desired signals η and w in a finite time proof consider the lyapunov function as follows 21 v 0 1 2 arctan e η t e w t p arctan e η e w where p a 2 a 1 1 0 χ since χ and a i are positive definite matrices p is a positive definite matrix the time derivation of 21 is 22 v 0 arctan e η t e w t a 2 a 1 1 0 χ i n i n d i a g e η 2 e w a 1 χ 2 arctan e η a 2 χ e w φ arctan e η t a 2 i n d i a g e η 2 e w arctan e η t χ 2 arctan e η arctan e η t a 1 1 a 2 χ e w arctan e η t a 1 1 arctan 1 e η φ t arctan e η e w t a 1 χ 3 arctan e η e w t a 2 χ 2 e w e w t χ e w 1 φ t e w arctan e η t e w t q arctan e η e w where q χ 2 φ t a 1 arctan e η a 1 χ 3 a 2 a 1 χ a 2 i n d i a g e η 2 a 2 χ 2 χ e w φ t by choosing a larger χ and a reasonable a i it is easy to make q a positive definite matrix as can be seen from 21 23 arctan e η v 0 1 2 χ min p hence 24 v 0 χ max p arctan e η 2 e w 2 arctan e η χ max p arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w v 0 1 2 χ min p χ max p arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w from 24 we can obtain 25 χ min p χ max p v 0 1 2 arctan e η t e w t d i a g arctan e η 1 i 2 arctan e η e w let γ q d i a g arctan e η 1 i 2 substituting 22 into 25 yields 26 v 0 χ min γ χ min p χ max p v 0 1 2 thus it can be seen from lemma 1 that ftd 16 can estimate η and w in a finite time 27 t 0 2 χ max p χ min γ χ min p v 0 1 2 0 further we can get from 26 that v 0 is a monotonically decreasing function when 0 t t 0 we have v 0 v 0 0 therefore e η and e w are bounded in 0 t 0 and there are 28a arctan e η v 0 1 2 0 χ min p 28b e w v 0 1 2 0 χ min p this completes the proof remark 1 for ftd 16 it is easy to know that by reasonably designing parameters χ and a i the system 16 can be stabilized so that the signals ζ 1 and ζ 2 are bounded combined with the proof of controller stability in section 3 3 it is not difficult to know that the hypothesis φ θ is rational remark 2 because of its obvious advantages including fewer parameters easy conditioning and no chattering the ftd proposed in this paper is superior to other ftds 3 3 finite time adaptive tracking controller design in practice excessive control law values are often difficult to operate because of actuator saturation in order to solve the problem of input saturation a stable adaptive auxiliary system is designed as follows 29 λ 1 c 1 λ 1 λ 2 λ 2 c 2 λ 2 j ζ 1 3 m 1 δ u where λ 1 λ 1 1 λ 1 2 λ 1 3 t and λ 2 λ 2 1 λ 2 2 λ 2 3 t are auxiliary vectors c 1 and c 2 are positive definite parameter vectors and in order to prevent the instability caused by too large δ u it is necessary to assure that c 1 and c 2 are large enough δ u τ a τ b τ b and τ a are the control inputs before and after the restriction respectively actually τ a is τ in 1 assuming that the maximum value of control input is τ max then τ a can be described as 30 τ a s a t τ b τ b τ b τ max τ max sgn τ b τ b τ max consider the following ntsm manifold 31 σ e 1 1 β e 2 p q where σ σ 1 σ 2 σ 3 t is the defined sliding variable β 0 1 p q γ 2 p and q are both positive old integers e 1 ζ 1 η d λ 1 e 1 1 e 1 2 e 1 3 t e 2 ζ 2 η d λ 1 e 2 1 e 2 2 e 2 3 t the derivative of 31 is 32 σ e 1 γ β d i a g e 2 γ 1 e 2 introduce rbfnn to approximate the internal uncertainties ϑ t 33 ϑ t w t h z ε z where z υ ˆ is the input vector ε z ε 1 z ε 2 z ε 3 z t is the approximation error of rbfnn w ω 1 t 0 1 l 0 1 l 0 1 l ω 2 t 0 1 l 0 1 l 0 1 l ω 3 t r 3 l 3 is a matrix of ideal weight vectors for all z ω z ε i z is the smallest then ω i is ω i i 1 2 3 l is the number of neurons h z h 1 t z h 2 t z h 3 t z t r 3 l is a vector of radial basis functions h i z h i 1 z h i l z t r l h i j is constructed as follows 34 h i j exp z c j t z c j 2 b i j 2 here j 1 l b i j 0 is the width of the gaussian function c j c j 1 c j 2 c j 3 t r 3 is the center of the gaussian function assumption 3 as for all z ω z the ideal constant weight vector ω i and the approximation error ε i z are bounded that is there exists positive constants ω i m and ε i m z which satisfy ω i ω i m ε i z ε i m z under assumption 2 we can get there exists a positive unknown constant bounded vector θ θ 1 θ 2 θ 3 t which ε i z δ i θ i i 1 2 3 consider the marine vehicle trajectory tracking system 14 and 15 and the sliding functions 31 and 32 the fatc law τ f a t c can be designed accordingly 35 τ f a t c m j 1 ζ 1 3 ϑ ˆ k σ ξ θ ˆ β γ 1 e 2 2 γ h e ζ 1 ζ 2 η d w d c 1 λ 1 c 2 λ 2 here k is a positive definite parameter matrix ϑ ˆ w ˆ t h z is the estimate of ϑ t ξ d i a g tanh σ 1 κ 1 tanh σ 2 κ 2 tanh σ 3 κ 3 r 3 3 κ i is a positive constant w ˆ and θ ˆ are the estimate vectors of w and θ respectively the update law for ω ˆ i and the adaptive law for θ ˆ can be designed as 36 ω ˆ i k 1 i μ i σ i h i z 37 θ ˆ k 2 μ ξ σ where both k 1 i r l l and k 2 r 3 3 are positive definite parameter matrices μ d i a g μ 1 μ 2 μ 3 γ β 1 d i a g e 2 γ 1 remark 3 the hyperbolic tangent function ξ is introduced to replace the sign function sgn σ which can effectively eliminate chattering phenomenon theorem 2 consider the closed loop system composed of 31 37 tracking errors η e and w e will converge to a small neighborhood near zero in a finite time proof the proof of theorem 2 is divided into two steps the global stability is analyzed at first then it will be proven that the sliding variable σ can converge to σ 0 in a finite time this part is divided into two stages i e the reaching and sliding phases consider the candidate lyapunov function as follows 38 v 1 1 2 σ t σ 1 2 i 1 3 ω i t k 1 i 1 ω i 1 2 θ t k 2 1 θ v 0 where ω i is the approximation error for ω i such that ω i ω ˆ i ω i θ is the estimation error for θ such that θ θ ˆ θ let 39 v 2 1 2 σ t σ 1 2 i 1 3 ω i t k 1 i 1 ω i 1 2 θ t k 2 1 θ differentiating 38 with respect to time yields 40 v 1 σ t σ i 1 3 ω i t k 1 i 1 ω ˆ i θ t k 2 1 θ ˆ v 0 differentiating v 1 along 32 16 and 35 we have 41 σ t σ σ t e 1 γ β d i a g e 2 γ 1 e 2 σ t e 2 γ β d i a g e 2 γ 1 ζ 2 η d λ 1 σ t μ β γ e 2 2 γ ζ 2 η d λ 1 σ t μ β γ e 2 2 γ h ζ 1 ζ 2 j ζ 1 3 m 1 τ f a t c χ 2 a 1 arctan e η a 2 arctan ζ 2 χ η d c 1 λ 1 c 2 λ 2 σ t μ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ ϑ ˆ k σ ξ θ ˆ according to 40 combining 41 with 36 37 we obtain 42 v 2 σ t μ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ ϑ ε z k σ ξ θ on the basis of assumption 3 we can acquire σ t μ ε z ξ θ 0 let φ χ 2 a 1 arctan e η a 2 arctan ζ 2 χ clearly ϑ φ is bounded the parameter matrix k is designed to make σ t μ ϑ φ k σ 0 thus v 2 0 can be received also v 0 0 can be obtained in the light of inequality 26 consequently v 1 0 is gained easily to sum up the system 14 and 15 is stable according to the lyapunov theory and σ ω i θ are bounded next the finite time stability of σ will be confirmed 1 reaching phase since θ is bounded it can be assumed that θ 0 so that for t 0 there is θ ˆ θ consider the lyapunov function as follows 43 v 3 1 2 σ t σ 1 2 ϕ θ θ ˆ t θ θ ˆ where ϕ 0 is arbitrary constant in the light of 41 the time derivation of 43 is 44 v 3 σ t σ 1 ϕ θ θ ˆ θ ˆ σ t μ ϑ ˆ k σ ξ θ ˆ φ 1 ϕ θ θ ˆ θ ˆ apparently ϑ ˆ is bounded and we assume 45 ϑ ˆ φ ϖ here ϖ r 3 1 is arbitrary positive definite vector substituting 37 45 into 44 yields 46 v 3 σ t μ k σ σ t μ ξ θ ˆ σ t μ ϖ k 2 ϕ μ θ θ ˆ t σ by reasonably designing the parameter k we can make 47 v 3 μ θ ˆ ϖ σ k 2 ϕ μ θ θ ˆ σ ρ 1 σ ρ 2 θ θ ˆ where ρ 1 and ρ 2 are the minimum of μ θ ˆ ϖ and k 2 ϕ μ σ respectively on the basis of lemma 2 47 can be deduced as follows 48 v 3 2 ρ 1 σ 2 2 ρ 2 θ θ ˆ 2 min 2 ρ 1 2 ρ 2 σ 2 θ θ ˆ 2 ρ σ 2 2 θ θ ˆ 2 2 1 2 ρ v 3 1 2 where ρ min 2 ρ 1 2 ρ 2 0 is a constant according to lemma 1 the fatc strategy designed in this paper can reach v 3 0 in a finite time t 3 2 v 3 1 2 0 ρ 2 sliding phase followed that we will prove that once the manifold is reached tracking errors η e and w e will converge to a tiny neighborhood of the origin along the manifold in a finite time when σ 0 by 31 we can gain 49 e 1 1 β e 2 p q 0 i e 50 e 1 j 1 β e 2 j p q 0 j 1 2 3 hence errors e 1 j and e 2 j can be stabilized to zero along σ j 0 at time t p β q p e 1 j 1 q p t 3 p q t 3 according to theorem 1 e η j and e w j will converge to zero in a finite time besides when t λ 1 j 0 λ 1 j 0 in fact we have e 1 j e η j η e j λ 1 j e 2 j e w j w e j λ 1 j stated thus η e j and w e j will naturally converge to a small neighborhood near the origin in a finite time this concludes the proof remark 4 if the power index p q 1 the fatc controller in 35 degenerates into the following conventional sliding mode controller smc 51 τ s m c m j 1 ζ 1 3 ϑ ˆ k σ ξ θ ˆ β e 2 h e ζ 1 ζ 2 η d w d c 1 λ 1 c 2 λ 2 from 50 we can acquire that system states e 1 and e 2 will converge to zero exponentially remark 5 theorem 2 shows that tracking errors η e and w e can converge to a tiny neighborhood near the origin in a finite time so that the desired trajectory can be tracked with high precision in a short time in contrast it can be obtained that only exponential stability can be achieved under the smc strategy in this case the raised fatc scheme in this context has obvious advantages remark 6 in wang et al 2017 the finite time observer is created to estimate complex unknowns although the complex unknowns can be exactly attenuated the uncertainties are required to be second order differentiable which makes the application scope of the observer severely limited by comparison the rbfnn and adaptive techniques introduced in this paper do not require excessive conditional constraints in addition input saturation and velocity unavailability are not considered in wang et al 2017 adaptive assist system and ftd are designed to solve the above problems in this content actually the content of this paper is more in line with the actual conditions of marine vehicle navigation 4 simulation results and discussions in order to verify the effectiveness and superiority of the proposed fatc scheme simulation will be conducted on a 76 2 m supply vessel fossen et al 1996 the target is to track the desired signals η d 500 sin 0 02 t 500 1 cos 0 02 t 0 02 t t in 5 and 6 the initial conditions are η 0 100 200 π 8 t υ 0 0 0 0 t other parameters are given as follows the positive inertia matrix m coriolis centripetal matrix c υ and damping matrix d are as follows m 1 0 6 5 3122 0 0 0 8 2831 0 0 0 3745 4 c υ 1 0 6 0 0 8 2831 v 0 0 5 3122 u 8 2831 v 5 3122 u 0 d 1 0 4 5 0242 0 0 0 27 229 439 33 0 439 33 41894 the unmodeled dynamics and the external disturbances are assumed to be as follows respectively δ f 1 0 4 0 2 5 0242 u 2 0 1 5 0242 u 3 0 2 27 299 v 2 0 1 27 299 v 3 0 2 41894 r 2 0 1 41894 r 3 d 10 5 sin 0 2 t cos 0 5 t 10 5 sin 0 1 t cos 0 4 t 10 6 sin 0 5 t cos 0 3 t the magnitudes of the actuated forces and moments are specified in the ranges given by τ 1 8 10 3 1 10 4 kn τ 2 1 1 0 5 2 5 1 0 4 kn τ 3 4 10 5 1 5 10 5 kn m parameters of adaptive assist system are designed as c 1 d i a g 10 10 10 c 2 d i a g 20 20 20 parameters of ftd χ d i a g 10 10 10 a 1 a 2 d i a g 2 2 6 the number of neurons are chosen as 61 c j 1 and c j 2 are evenly distributed between 18 18 c j 3 is evenly distributed between 0 3 0 3 b 1 j b 2 j 3 b 3 j 1 the remaining parameters are chosen as p 23 q 21 β 0 08 k d i a g 0 09 0 01 0 3 k 1 d i a g 1 10 3 2 10 3 1 10 3 k 2 3 5 10 5 6 1 0 5 2 5 10 3 in the same sea conditions the comparison with the smc strategy 51 also confirms the superiority of the proposed fatc scheme 35 correspondingly the simulation results are shown in figs 2 6 and it can be received that the proposed fatc scheme is superior to the smc strategy in convergence speed and accuracy fig 1 demonstrates the comparison between the actual trajectory and the expected trajectory under the two strategies this indicates both smc strategy and fatc scheme can track the target trajectory even though the fatc scheme can achieve a faster and more accurate response better transient performance figs 2 3 visually denote that the smc can only roughly track the desired trajectory and there are large errors while the fatc approach can completely track the desired trajectory in about 25 s as shown in figs 4 5 fatc scheme can track the desired speed more quickly about 35 s and correctly the enlarged parts in fig 6 prove that the proposed adaptive assist system 29 can still make the system run stably under the input saturation figs 7 8 reveal that the ftd 16 has a excellent tracking performance for both η and w fig 9 testifies that rbfnn can basically track the internal uncertainties and the design of adaptive law 36 is smooth and reasonable fig 10 shows that the adaptive law 37 can estimate the upper bound of the external disturbance and the approximation error of rbfnn when parameters are reasonably chosen in conclusion compared with smc plan fatc scheme has obvious advantages in fast and accurate trajectory tracking because of its finite time convergence the adaptive aided system designed in this paper can well overcome the adverse effects caused by nonlinear saturation factors in addition the tracking effect of the ftd on target position and velocity is extremely good unknown uncertainties and their bounds can be generally estimated by rbfnn and adaptive technique which improves the anti interference ability of the whole control system 5 conclusion in this paper finite time trajectory tracking control of a marine vehicle with completely unknown dynamics and external disturbances has been solved by combining ntsm rbfnn with adaptive technique considering that the input constraint often occur due to the limitation of actuator in practice an adaptive aided system is designed to effectively solve the problem of control system instability caused by input saturation in order to address the problem that the position signal contains noise and the velocity is difficult to measure in practice a ftd is designed in this paper which can converge the position and velocity errors to zero in finite time pursuing stronger disturbance rejection ability the rbfnn is adopted to approximate the model uncertainties moreover the adaptive law is introduced to estimate the boundary value of neural network approximation error and compound disturbances and thereby leading to a fatc scheme which achieves not only finite time tracking but also general disturbance attenuation as a consequence a complex marine vehicle system suffering from input saturation completely unknown dynamics and disturbances can be tracked within a finite time in terms of both position and velocity comprehensive simulation studies and comparisons on a marine vehicle have been carried out to intensively demonstrate the effectiveness and superiority of the proposed scheme credit authorship contribution statement zhipeng shen conceptualization writing review editing supervision project administration yu wang conceptualization software writing original draft writing review editing visualization haomiao yu conceptualization writing review editing supervision project administration funding acquisition chen guo conceptualization writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the editor in chief the associate editor and anonymous referees for their invaluable comments and suggestions this work is supported by the national natural science foundation of china under grants 51879027 51809028 and 51579024 the fundamental research funds for the central universities china under grants 3132019109 and 3132019318 and the doctoral start up foundation of liaoning province china under grant 2019 bs 022 
22079,this paper proposes an improved sequential sampling approach for meta modeling to surrogate computationally expensive simulations during the swath design optimization starting from an initial training set a series of new samples are sequentially selected in important voronoi cells based on the voronoi diagram the method is applied on an eight variable total resistance optimization of a 32 m swath in calm water at 16kn the meta model of total resistance with required accuracy is generated by the proposed method and applied on the optimization process the sampling results have shown the effectiveness of the proposed sampling method and the advantage of the meta model that achieve the required accuracy with relatively small samples which are meaningful for high dimensional swath shape optimization keywords sequential sampling meta modeling swath design optimization numerical simulation 1 introduction with the increasing accuracy of the simulation tools and availability of computational resources advanced simulation analysis methods have been proposed during the ship design optimization for ship hydrodynamic performance a series of cfd solvers have been developed to give accurate flow predictions however a common limitation of the high fidelity cfd solvers is that numerical simulation takes enormous computational time which makes it impractical to rely exclusively on simulation for the purpose of design optimization jin et al 2001 for ship flow systems it can take up to several days for a single cfd calculation moreover several hundred calculations are required for reliable optimization to address this challenge the so called meta models known as surrogate models or approximation models are widely used as surrogates for computationally expensive simulations wang et al 2006 luo et al 2015 liu et al 2017 guerrero et al 2018 lin et al 2019 the application of meta models in optimization helps achieve efficient and effective designs as they provide rapid tools for design space exploration and facilitate the integration of discipline dependent analysis codes into the overall design optimization lin et al 2004 sayli et al 2010 the basic idea of constructing a meta model is building an approximation of the response of interest with a limited number of expensive simulations viana et al 2010 the meta modeling technique the properties of a problem and the types of sampling approaches all have direct influences on the performance of a meta model jin et al 2002 although the surrogate accuracy can be improved by using more simulations limited computational resources often make us face the problem that gaining a meta model with the desired accuracy requires more simulations than we can afford viana et al 2010 hence how to achieve a good accuracy of a meta model with a reasonable number of sample points remains an important research issue many effective and efficient sampling approaches have been developed and different sampling approaches have been compared in terms of their capability to generate accurate surrogates of complex engineering analyses timothy et al 2001 at present there is no theoretical conclusion giving the type of sampling which leads to the best fitted meta model conventionally the space filling designs e g latin hypercube sampling lhs mckay et al 2000 orthogonal array owen 1992 minimax and maximin design johnson et al 1990 etc are widely used for meta model fitting iooss et al 2010 the advantage of the abovementioned approaches is that they determine the total number of samples in advance and generate all the sample points at once however in engineering practice little information about the real model can be used to predetermine the proper sample size liu et al 2015 for this reason sequential sampling also called adaptive sampling techniques have been developed which improves the meta model accuracy by iteratively selecting samples over the entire design space a large variety of sequential sampling methods have been proposed and applied in engineering fields xu et al 2014 our objective in this study is to explore a proper sequential sampling method for meta model in the context of ship design optimization which contains multiple highly non linear design variables engineering constraints and expensive simulations for a complicated output function it is expected to sample more points in the highly nonlinear regions and fewer points in the relatively flat regions in order to capture the behavior of this function with smaller sample size hence some sequential sampling approaches have been employed such as simulated annealing approach cross validation based sequential sampling approaches novel hybrid sequential strategy etc xu et al 2014 in our study an improved sequential sampling method based on the vonoroi diagram is implemented and discussed the vonoroi diagram is a technique of computational geometry hirokawa et al 2002 which has been widely adopted in astronomy geography etc because of its efficiency in the allocation and partition of space besides the voronoi diagram has been used for sampling and dealing with optimization models fujita et al 2000 proposed a voronoi diagram based blending method of local response surfaces for cumulative global optimization and a design problem of a welded beam structure with 4 design variables was solved through the method based on fujita s research hirokawa et al 2002 enhanced the developments by further considering the meaning of tradeoffs in the response surface two numerical examples including 2 dimensional and four dimensional functions were given to validate the proposed method xu et al 2014 presented a cross validation voronoi sampling approach for global meta modeling and eight mathematical function test cases with dimensions ranging from 2 to 10 were used to demonstrate the applicability of the approach however the application of the voronoi diagram for high dimensional problems especially for complex engineering problems remains to further investigate in our study the proposed voronoi diagram based sequential sampling method is applied on meta modeling of the objective with 8 variables during the shape optimization of a small waterplane area twin hull swath the present work is structured as follows first the improved sequential sampling method is introduced in section 2 and a two dimension function example is demonstrated to show the basic procedure of sampling second the shape optimization of a 32m swath problem is given and solved in section 3 the meta modeling of total resistance is described in detail including obtaining the responses by cfd analysis sampling for meta model by the proposed method building and validating the final meta model and showing the final optimization result then the accuracy of the meta model of the example is further shown and discussed in section 4 finally section 5 draws the conclusion 2 improved sequential sampling method usually for a complicated engineering problem the fundamental framework of sequential sampling is 1 simulation analysis is executed at a certain number of sample points within design space 2 an initial metal model is generated based on the information given from analysis results at sample points the accuracy of the initial metal model always does not meet the requirement of optimization 3 additional sample points are produced and selected the core issue of sequential sampling is how to select new samples to improve the accuracy of the metal model as mentioned above for a complicated output function we expect to sample more points in the highly nonlinear regions and fewer points in the relatively flat regions in order to capture the behavior of this function with smaller sample size hence we focus on dealing with the following problems after the initial sample points exist how to decide the important regions where more samples should be added in once the important regions are selected how to find the desired samples in the region as it is impractical to add all the samples in the regions 2 1 important voronoi cell decision based on voronoi diagram the important regions as stated above are decided the essence of the voronoi diagram is after a set of points called as seeds are given in a design space the design space is partitioned into regions based on the distance to points in a specific subset of the space for each seed there is a corresponding region which is called voronoi cell consisting of all points closer to that seed than to any other a two dimensional example of the voronoi diagram is illustrated in fig 1 the unique topological structure makes the voronoi diagram owning two advanced mathematical natures one is that any operation can be performed based on the topological structure of graphs among seeds rather than analytical data the other is that various operations such as addition deletion and small movement of a seed can be executed locally within a small subset of surrounding the voronoi regions these two characteristics of the voronoi diagram result in that each addition of a sample point can be locally handled with less cost even against a large number of sample points fujita et al 2000 shown as fig 1 after an initial set of sample points seeds is given based on the voronoi diagram the design space is partitioned into voronoi cells and each seed dominates a companying voronoi region against other seeds on the basis of the initial sample set an initial meta model is built and validated by the leave one out cross validation method loocv arlot and celisse 2010 the relative prediction error of an initial sample point x i is calculated as 1 e i f x i f ˆ i x i f x i where f x i is the real response of x i which is usually obtained by numerical simulation f ˆ i x i is the predicted response of x i by the meta model built on existing points without x i because of the properties of the voronoi diagram it is reasonable to represent the behavior of the voronoi cell by the corresponding seed in other words if the relative prediction error of a point is big then it is assumed that the relative prediction errors of all points in the corresponding voronoi cell are similarly big which means that the constructed meta model deviates from the real model largely in the voronoi cell hence more points should be added in that voronoi cell in our study the voronoi cell with the biggest relative prediction error of seed is chosen as the so called important voronoi cell where a new point is selected then the new sample is adjusted locally in the important voronoi cell the criteria for adjusting a new sample is like to adjust the location of a new facility in a specific region over a map with a set of existing facilities so as to maximize the average accessibility to the closest facility from all points since all the points falling in the important voronoi cell are farthest away from the important seed the adjustment of a new sample is simplified as finding a point that is farthest away from the important seed in the important voronoi cell 2 2 voronoi diagram based sequential sampling as the voronoi cells are actually a set of polygons polyhedral in the case of higher dimensional space shown in fig 1 the adjustment of a new sample can be turned into solving a nonlinear programming problem which is mathematically formulated as maximum x x i m p o r t a n t 2 s t h j x 0 j 1 q where x s e n s i t i v e is the corresponding seed of the important voronoi cell h j x 0 constitute the boundaries of the important voronoi cell this selected point is added as the next sample to be evaluated and the meta model is updated the detailed process of sampling is described as follows 1 a set of initial sample points is generated and analyzed by engineering simulation tools in order to satisfy the basic space fill property of the sample lhs method is applied to build the initial sample 2 based on the current sample the entire design space is partitioned into a set of voronoi cells by voronoi diagram a meta model based on the initial sample is constructed the important voronoi cell is selected by using loocv 3 a new sample is chosen from the important voronoi cell by solving equation 2 a large class of algorithms may be adopted for this kind of optimization problem in our study the interior point method is applied 4 calculate the response of the new sample and then add it to the sample set the meta model is updated 5 return to step 2 until the stopping criterion is satisfied in our study the determination coefficient r2 is employed to evaluate the meta model accuracy raymond h myers 2009 which is expressed as 3 r 2 1 i 1 n f x i f ˆ x i 2 i 1 n f x i f x i 2 where n is the number of validation points f x i is the actual value obtained by simulation at the ith validation point f ˆ x i is the predicted value calculated from the surrogate model at the ith validation point f x i is the mean of actual values of validation points a bigger r 2 implies a more accurate meta model generally in complex engineering problem a meta model is concluded to satisfy the requirement of accuracy when r 2 is above 0 9 2 3 two dimensional example in this section a two dimensional example is presented to demonstrate the improved approach the mathematical function of the example is 4 f x 1 x 2 30 x 1 s i n x 1 4 e x 2 2 x 1 4 10 x 2 3 3 fig 2 shows the perspective view and contour plot of the function the quartic polynomial expression is chosen as the meta model type in this example the initial sample set of 11 points shown as fig 3 a is generated by the lhs approach another set of 200 points is randomly produced to validate the meta model then additional samples are generated by the improved sequential sampling method and the meta model is updated as the meta modeling of function is relatively simple the stopping criterion is set as r 2 0 95 fig 3 shows the convergence history of sampling r2 with respect to the total number of samples it is observed that r2 reaches to 0 9 after 3 more samples total 14 samples are added and to 0 95 until 70 more samples total 81 samples are added fig 4 shows the sampling history of the proposed sampling method it is found that the proposed method samples more points on the peak region where the value of the function varies greatly while fewer points on the flat region 3 application of approach on minimizing total resistance of swath in this section the shape optimization of the swath is used to demonstrate the applicability and efficiency of the improved sampling approach and the corresponding built meta model as an import part of optimization the meta model of total resistance is built with a relatively small number of samples to surrogate the cfd simulation results by applying the improved sampling approach 3 1 the optimization problem and framework the optimization is performed to reduce the total resistance of a 32m swath in calm water at 16kn the main particulars of the prototype are summarized in table 1 total 8 variables that marked in fig 5 are chosen as design variables while the changing ranges of 168 54 m 3 are limited within 1 the corresponding changing ranges of design variables are listed in table 2 it is known that shape optimization typically needs three necessary elements a geometry modeling method to provide geometry model linked with the design variables a nonlinear optimization algorithm to search the optimal case the use of simulation tool to evaluate the current design and obtain the constraint information campana et al 2006 in our study caeses software caeses 2020 which has been worldwide used in the field of turbomachinery automotive aerospace marine and offshore etc is applied to achieve 3d parametric modeling the evolutionary strategy evol algorithm beyer and schwefel 2002 in isight lai et al 2012 is proposed during the optimization as it has been proved well suited for non linear and discontinuous design space which is suitable for the design parameters of a hull for numerical simulation the high fidelity cfd solver starccm is applied however the use of such an expensive analysis tool in iterative procedures results in a major problem to face is the computational expense hence we propose the meta model with the improved sequential sampling method to reduce the overall computational effort during the sequential sampling for meta model isight platform integrated with matlab caeses and starccm is employed for the initial sample generation voronoi diagram based new sample creation meta model update and error analysis the optimization process illustrating how meta model is built and applied on swath shape optimization is shown in fig 6 3 2 hydrodynamic numerical simulation as the twin underwater hulls of swath are symmetric about xz plane simulations are conducted for the right demi underwater hull using the computational fluid dynamic cfd code star ccm the computational domain is defined within 1 0 l h upstream 3 0 l h downstream and 1 5 l h aside the associated grids of the model are shown in fig 7 the incompressible reynolds averaged navier stokes rans equations blazek 2005 are taken as the control equation while the r n g k ε model is chosen as the turbulence model table 3 lists the main settings of simulation it takes approximately 2 h performing a single simulation on 10 core 3 3 meta model of total resistance with the proposed method the construction of the meta model for total resistance starts with meta model type selection because of the complicated non linear relationship between the resistance and design variables the quartic polynomial form written as equation 5 is selected as the meta model type all the 8 design variables are taken as input variables according to the polynomial property and number of design variables at least 61 samples are needed to initialize the meta model lin et al 2019 hence an initial sample set of 61 data is prepared by sobol sampling sobol et al 1967 to maintain the space filling property of the sample joe et al 2003 in order to make maximum use of available samples the loocv method is used for error analysis during the application of the proposed sampling method all sample points are removed from the sample set one at a time for each of the removed points the approximation coefficients are re calculated and the exact and approximate output values are compared an initial meta model is established based on 61 samples with r 2 equals to 0 878 as the amount of the polynomial terms total 61 items in the model is large for 8 input variables the stepwise term selection method first proposed by efroymson 1960 is chosen to remove some polynomial terms 5 f x β 0 i 1 n β i x i i 1 n β n i x i 2 i 1 n β 2 n i x i 3 i 1 n β 3 n i x i 4 i j β i j x i x j with the preparations completed the training samples are generated one by one using the improved sequential sampling method as the values of different input variables are measured on different scales min max normalization is performed to rescale the ranges of all input variables in 0 1 the general formula for the normalization is given as formula 6 the sampling process stops when 25 new samples are added with the r 2 of the meta model reaches 0 9 fig 8 shows the history of r 2 during the sampling process fig 9 shows 8 input variable variations of additional samples it can be seen from fig 8 that the overall accuracy of the meta model r 2 increases with iteration also r 2 fluctuates during the iteration when new samples are generated in the same important voronoi cell r 2 continues to decrease when the previous important voronoi cell contains enough samples and the sample searching moves to another cell r 2 suddenly increases to some extent 6 x n o r x x l o w e r b o u n d x u p p e r b o u n d x l o w e r b o u n d where x n o r is the normalized value x is original value x l o w e r b o u n d is the lower bound of the corresponding variable x u p p e r b o u n d is the upper bound of the corresponding variable 3 4 the optimization process with the meta model the optimization is performed with the meta model using the evolutionary algorithm simon 2013 the optimization process is shown in fig 10 note that only improved feasible designs are presented the total resistance reduction reaches to 6 367 after 97 iterations table 4 lists the optimized design results with respect to the original design fig 11 compares the normalized values of design variables between the initial design and the optimal design 4 validation and discussion 4 1 validation of optimal design in order to certify the accuracy of the meta model adopted in the optimization process as well as check the estimated improvements of optimized design the numerical simulation on the optimal design is performed as a result the predicted value of the total resistance by numerical simulation reported in table 5 is 104001 9n which is very close to the value estimated by the meta model giving variation on 0 135 4 2 further error analysis of meta model the accuracy of the proposed sampling method is further checked besides loocv method adopted on error analysis of sampling results another 200 sample data are randomly generated as the error analysis sample set for adequacy checking and the actual values of total resistance obtained by numerical simulation are compared with the values predicted by the meta model stated in section 3 3 the r2 of the error analysis sample set is 0 902 0 9 which satisfies the accuracy of the meta model for engineering optimization the points in the residual plot shown as fig 12 are randomly dispersed around the horizontal axis implying the metal model is appropriate for the data 5 conclusion an improved sequential sampling method based on the voronoi diagram is proposed to accomplish meta modeling for the purpose of design optimization by applying the voronoi diagram the proposed method samples more points in the highly nonlinear regions and fewer points in the relatively flat regions based on geometric information of the sample the shape optimization of a 32m swath is taken as an example the sampling and meta modeling of the total resistance are automatically performed through isight platform integrating caeses starccm and matlab as an important part of optimization the meta model of total resistance is built with a relatively small number of samples to surrogate the cfd simulation results the results have shown the effectiveness of the proposed sampling method and the advantage of the meta model that achieve the required accuracy with relatively small samples which is meaningful for high dimensional swath shape optimization future developments include the application of the proposed sampling method on other types of hull forms credit authorship contribution statement qu yang investigation software data curation writing original draft visualization validation yan lin supervision formal analysis writing review editing guan guan conceptualization methodology project administration funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to express their sincere thanks to the institute of ship and marine engineering design dalian university of technology for providing support for the research the authors are grateful to the national natural science foundation of china 51609036 and the fundamental research funds for the central universities dut18jc05 for its financial support 
22079,this paper proposes an improved sequential sampling approach for meta modeling to surrogate computationally expensive simulations during the swath design optimization starting from an initial training set a series of new samples are sequentially selected in important voronoi cells based on the voronoi diagram the method is applied on an eight variable total resistance optimization of a 32 m swath in calm water at 16kn the meta model of total resistance with required accuracy is generated by the proposed method and applied on the optimization process the sampling results have shown the effectiveness of the proposed sampling method and the advantage of the meta model that achieve the required accuracy with relatively small samples which are meaningful for high dimensional swath shape optimization keywords sequential sampling meta modeling swath design optimization numerical simulation 1 introduction with the increasing accuracy of the simulation tools and availability of computational resources advanced simulation analysis methods have been proposed during the ship design optimization for ship hydrodynamic performance a series of cfd solvers have been developed to give accurate flow predictions however a common limitation of the high fidelity cfd solvers is that numerical simulation takes enormous computational time which makes it impractical to rely exclusively on simulation for the purpose of design optimization jin et al 2001 for ship flow systems it can take up to several days for a single cfd calculation moreover several hundred calculations are required for reliable optimization to address this challenge the so called meta models known as surrogate models or approximation models are widely used as surrogates for computationally expensive simulations wang et al 2006 luo et al 2015 liu et al 2017 guerrero et al 2018 lin et al 2019 the application of meta models in optimization helps achieve efficient and effective designs as they provide rapid tools for design space exploration and facilitate the integration of discipline dependent analysis codes into the overall design optimization lin et al 2004 sayli et al 2010 the basic idea of constructing a meta model is building an approximation of the response of interest with a limited number of expensive simulations viana et al 2010 the meta modeling technique the properties of a problem and the types of sampling approaches all have direct influences on the performance of a meta model jin et al 2002 although the surrogate accuracy can be improved by using more simulations limited computational resources often make us face the problem that gaining a meta model with the desired accuracy requires more simulations than we can afford viana et al 2010 hence how to achieve a good accuracy of a meta model with a reasonable number of sample points remains an important research issue many effective and efficient sampling approaches have been developed and different sampling approaches have been compared in terms of their capability to generate accurate surrogates of complex engineering analyses timothy et al 2001 at present there is no theoretical conclusion giving the type of sampling which leads to the best fitted meta model conventionally the space filling designs e g latin hypercube sampling lhs mckay et al 2000 orthogonal array owen 1992 minimax and maximin design johnson et al 1990 etc are widely used for meta model fitting iooss et al 2010 the advantage of the abovementioned approaches is that they determine the total number of samples in advance and generate all the sample points at once however in engineering practice little information about the real model can be used to predetermine the proper sample size liu et al 2015 for this reason sequential sampling also called adaptive sampling techniques have been developed which improves the meta model accuracy by iteratively selecting samples over the entire design space a large variety of sequential sampling methods have been proposed and applied in engineering fields xu et al 2014 our objective in this study is to explore a proper sequential sampling method for meta model in the context of ship design optimization which contains multiple highly non linear design variables engineering constraints and expensive simulations for a complicated output function it is expected to sample more points in the highly nonlinear regions and fewer points in the relatively flat regions in order to capture the behavior of this function with smaller sample size hence some sequential sampling approaches have been employed such as simulated annealing approach cross validation based sequential sampling approaches novel hybrid sequential strategy etc xu et al 2014 in our study an improved sequential sampling method based on the vonoroi diagram is implemented and discussed the vonoroi diagram is a technique of computational geometry hirokawa et al 2002 which has been widely adopted in astronomy geography etc because of its efficiency in the allocation and partition of space besides the voronoi diagram has been used for sampling and dealing with optimization models fujita et al 2000 proposed a voronoi diagram based blending method of local response surfaces for cumulative global optimization and a design problem of a welded beam structure with 4 design variables was solved through the method based on fujita s research hirokawa et al 2002 enhanced the developments by further considering the meaning of tradeoffs in the response surface two numerical examples including 2 dimensional and four dimensional functions were given to validate the proposed method xu et al 2014 presented a cross validation voronoi sampling approach for global meta modeling and eight mathematical function test cases with dimensions ranging from 2 to 10 were used to demonstrate the applicability of the approach however the application of the voronoi diagram for high dimensional problems especially for complex engineering problems remains to further investigate in our study the proposed voronoi diagram based sequential sampling method is applied on meta modeling of the objective with 8 variables during the shape optimization of a small waterplane area twin hull swath the present work is structured as follows first the improved sequential sampling method is introduced in section 2 and a two dimension function example is demonstrated to show the basic procedure of sampling second the shape optimization of a 32m swath problem is given and solved in section 3 the meta modeling of total resistance is described in detail including obtaining the responses by cfd analysis sampling for meta model by the proposed method building and validating the final meta model and showing the final optimization result then the accuracy of the meta model of the example is further shown and discussed in section 4 finally section 5 draws the conclusion 2 improved sequential sampling method usually for a complicated engineering problem the fundamental framework of sequential sampling is 1 simulation analysis is executed at a certain number of sample points within design space 2 an initial metal model is generated based on the information given from analysis results at sample points the accuracy of the initial metal model always does not meet the requirement of optimization 3 additional sample points are produced and selected the core issue of sequential sampling is how to select new samples to improve the accuracy of the metal model as mentioned above for a complicated output function we expect to sample more points in the highly nonlinear regions and fewer points in the relatively flat regions in order to capture the behavior of this function with smaller sample size hence we focus on dealing with the following problems after the initial sample points exist how to decide the important regions where more samples should be added in once the important regions are selected how to find the desired samples in the region as it is impractical to add all the samples in the regions 2 1 important voronoi cell decision based on voronoi diagram the important regions as stated above are decided the essence of the voronoi diagram is after a set of points called as seeds are given in a design space the design space is partitioned into regions based on the distance to points in a specific subset of the space for each seed there is a corresponding region which is called voronoi cell consisting of all points closer to that seed than to any other a two dimensional example of the voronoi diagram is illustrated in fig 1 the unique topological structure makes the voronoi diagram owning two advanced mathematical natures one is that any operation can be performed based on the topological structure of graphs among seeds rather than analytical data the other is that various operations such as addition deletion and small movement of a seed can be executed locally within a small subset of surrounding the voronoi regions these two characteristics of the voronoi diagram result in that each addition of a sample point can be locally handled with less cost even against a large number of sample points fujita et al 2000 shown as fig 1 after an initial set of sample points seeds is given based on the voronoi diagram the design space is partitioned into voronoi cells and each seed dominates a companying voronoi region against other seeds on the basis of the initial sample set an initial meta model is built and validated by the leave one out cross validation method loocv arlot and celisse 2010 the relative prediction error of an initial sample point x i is calculated as 1 e i f x i f ˆ i x i f x i where f x i is the real response of x i which is usually obtained by numerical simulation f ˆ i x i is the predicted response of x i by the meta model built on existing points without x i because of the properties of the voronoi diagram it is reasonable to represent the behavior of the voronoi cell by the corresponding seed in other words if the relative prediction error of a point is big then it is assumed that the relative prediction errors of all points in the corresponding voronoi cell are similarly big which means that the constructed meta model deviates from the real model largely in the voronoi cell hence more points should be added in that voronoi cell in our study the voronoi cell with the biggest relative prediction error of seed is chosen as the so called important voronoi cell where a new point is selected then the new sample is adjusted locally in the important voronoi cell the criteria for adjusting a new sample is like to adjust the location of a new facility in a specific region over a map with a set of existing facilities so as to maximize the average accessibility to the closest facility from all points since all the points falling in the important voronoi cell are farthest away from the important seed the adjustment of a new sample is simplified as finding a point that is farthest away from the important seed in the important voronoi cell 2 2 voronoi diagram based sequential sampling as the voronoi cells are actually a set of polygons polyhedral in the case of higher dimensional space shown in fig 1 the adjustment of a new sample can be turned into solving a nonlinear programming problem which is mathematically formulated as maximum x x i m p o r t a n t 2 s t h j x 0 j 1 q where x s e n s i t i v e is the corresponding seed of the important voronoi cell h j x 0 constitute the boundaries of the important voronoi cell this selected point is added as the next sample to be evaluated and the meta model is updated the detailed process of sampling is described as follows 1 a set of initial sample points is generated and analyzed by engineering simulation tools in order to satisfy the basic space fill property of the sample lhs method is applied to build the initial sample 2 based on the current sample the entire design space is partitioned into a set of voronoi cells by voronoi diagram a meta model based on the initial sample is constructed the important voronoi cell is selected by using loocv 3 a new sample is chosen from the important voronoi cell by solving equation 2 a large class of algorithms may be adopted for this kind of optimization problem in our study the interior point method is applied 4 calculate the response of the new sample and then add it to the sample set the meta model is updated 5 return to step 2 until the stopping criterion is satisfied in our study the determination coefficient r2 is employed to evaluate the meta model accuracy raymond h myers 2009 which is expressed as 3 r 2 1 i 1 n f x i f ˆ x i 2 i 1 n f x i f x i 2 where n is the number of validation points f x i is the actual value obtained by simulation at the ith validation point f ˆ x i is the predicted value calculated from the surrogate model at the ith validation point f x i is the mean of actual values of validation points a bigger r 2 implies a more accurate meta model generally in complex engineering problem a meta model is concluded to satisfy the requirement of accuracy when r 2 is above 0 9 2 3 two dimensional example in this section a two dimensional example is presented to demonstrate the improved approach the mathematical function of the example is 4 f x 1 x 2 30 x 1 s i n x 1 4 e x 2 2 x 1 4 10 x 2 3 3 fig 2 shows the perspective view and contour plot of the function the quartic polynomial expression is chosen as the meta model type in this example the initial sample set of 11 points shown as fig 3 a is generated by the lhs approach another set of 200 points is randomly produced to validate the meta model then additional samples are generated by the improved sequential sampling method and the meta model is updated as the meta modeling of function is relatively simple the stopping criterion is set as r 2 0 95 fig 3 shows the convergence history of sampling r2 with respect to the total number of samples it is observed that r2 reaches to 0 9 after 3 more samples total 14 samples are added and to 0 95 until 70 more samples total 81 samples are added fig 4 shows the sampling history of the proposed sampling method it is found that the proposed method samples more points on the peak region where the value of the function varies greatly while fewer points on the flat region 3 application of approach on minimizing total resistance of swath in this section the shape optimization of the swath is used to demonstrate the applicability and efficiency of the improved sampling approach and the corresponding built meta model as an import part of optimization the meta model of total resistance is built with a relatively small number of samples to surrogate the cfd simulation results by applying the improved sampling approach 3 1 the optimization problem and framework the optimization is performed to reduce the total resistance of a 32m swath in calm water at 16kn the main particulars of the prototype are summarized in table 1 total 8 variables that marked in fig 5 are chosen as design variables while the changing ranges of 168 54 m 3 are limited within 1 the corresponding changing ranges of design variables are listed in table 2 it is known that shape optimization typically needs three necessary elements a geometry modeling method to provide geometry model linked with the design variables a nonlinear optimization algorithm to search the optimal case the use of simulation tool to evaluate the current design and obtain the constraint information campana et al 2006 in our study caeses software caeses 2020 which has been worldwide used in the field of turbomachinery automotive aerospace marine and offshore etc is applied to achieve 3d parametric modeling the evolutionary strategy evol algorithm beyer and schwefel 2002 in isight lai et al 2012 is proposed during the optimization as it has been proved well suited for non linear and discontinuous design space which is suitable for the design parameters of a hull for numerical simulation the high fidelity cfd solver starccm is applied however the use of such an expensive analysis tool in iterative procedures results in a major problem to face is the computational expense hence we propose the meta model with the improved sequential sampling method to reduce the overall computational effort during the sequential sampling for meta model isight platform integrated with matlab caeses and starccm is employed for the initial sample generation voronoi diagram based new sample creation meta model update and error analysis the optimization process illustrating how meta model is built and applied on swath shape optimization is shown in fig 6 3 2 hydrodynamic numerical simulation as the twin underwater hulls of swath are symmetric about xz plane simulations are conducted for the right demi underwater hull using the computational fluid dynamic cfd code star ccm the computational domain is defined within 1 0 l h upstream 3 0 l h downstream and 1 5 l h aside the associated grids of the model are shown in fig 7 the incompressible reynolds averaged navier stokes rans equations blazek 2005 are taken as the control equation while the r n g k ε model is chosen as the turbulence model table 3 lists the main settings of simulation it takes approximately 2 h performing a single simulation on 10 core 3 3 meta model of total resistance with the proposed method the construction of the meta model for total resistance starts with meta model type selection because of the complicated non linear relationship between the resistance and design variables the quartic polynomial form written as equation 5 is selected as the meta model type all the 8 design variables are taken as input variables according to the polynomial property and number of design variables at least 61 samples are needed to initialize the meta model lin et al 2019 hence an initial sample set of 61 data is prepared by sobol sampling sobol et al 1967 to maintain the space filling property of the sample joe et al 2003 in order to make maximum use of available samples the loocv method is used for error analysis during the application of the proposed sampling method all sample points are removed from the sample set one at a time for each of the removed points the approximation coefficients are re calculated and the exact and approximate output values are compared an initial meta model is established based on 61 samples with r 2 equals to 0 878 as the amount of the polynomial terms total 61 items in the model is large for 8 input variables the stepwise term selection method first proposed by efroymson 1960 is chosen to remove some polynomial terms 5 f x β 0 i 1 n β i x i i 1 n β n i x i 2 i 1 n β 2 n i x i 3 i 1 n β 3 n i x i 4 i j β i j x i x j with the preparations completed the training samples are generated one by one using the improved sequential sampling method as the values of different input variables are measured on different scales min max normalization is performed to rescale the ranges of all input variables in 0 1 the general formula for the normalization is given as formula 6 the sampling process stops when 25 new samples are added with the r 2 of the meta model reaches 0 9 fig 8 shows the history of r 2 during the sampling process fig 9 shows 8 input variable variations of additional samples it can be seen from fig 8 that the overall accuracy of the meta model r 2 increases with iteration also r 2 fluctuates during the iteration when new samples are generated in the same important voronoi cell r 2 continues to decrease when the previous important voronoi cell contains enough samples and the sample searching moves to another cell r 2 suddenly increases to some extent 6 x n o r x x l o w e r b o u n d x u p p e r b o u n d x l o w e r b o u n d where x n o r is the normalized value x is original value x l o w e r b o u n d is the lower bound of the corresponding variable x u p p e r b o u n d is the upper bound of the corresponding variable 3 4 the optimization process with the meta model the optimization is performed with the meta model using the evolutionary algorithm simon 2013 the optimization process is shown in fig 10 note that only improved feasible designs are presented the total resistance reduction reaches to 6 367 after 97 iterations table 4 lists the optimized design results with respect to the original design fig 11 compares the normalized values of design variables between the initial design and the optimal design 4 validation and discussion 4 1 validation of optimal design in order to certify the accuracy of the meta model adopted in the optimization process as well as check the estimated improvements of optimized design the numerical simulation on the optimal design is performed as a result the predicted value of the total resistance by numerical simulation reported in table 5 is 104001 9n which is very close to the value estimated by the meta model giving variation on 0 135 4 2 further error analysis of meta model the accuracy of the proposed sampling method is further checked besides loocv method adopted on error analysis of sampling results another 200 sample data are randomly generated as the error analysis sample set for adequacy checking and the actual values of total resistance obtained by numerical simulation are compared with the values predicted by the meta model stated in section 3 3 the r2 of the error analysis sample set is 0 902 0 9 which satisfies the accuracy of the meta model for engineering optimization the points in the residual plot shown as fig 12 are randomly dispersed around the horizontal axis implying the metal model is appropriate for the data 5 conclusion an improved sequential sampling method based on the voronoi diagram is proposed to accomplish meta modeling for the purpose of design optimization by applying the voronoi diagram the proposed method samples more points in the highly nonlinear regions and fewer points in the relatively flat regions based on geometric information of the sample the shape optimization of a 32m swath is taken as an example the sampling and meta modeling of the total resistance are automatically performed through isight platform integrating caeses starccm and matlab as an important part of optimization the meta model of total resistance is built with a relatively small number of samples to surrogate the cfd simulation results the results have shown the effectiveness of the proposed sampling method and the advantage of the meta model that achieve the required accuracy with relatively small samples which is meaningful for high dimensional swath shape optimization future developments include the application of the proposed sampling method on other types of hull forms credit authorship contribution statement qu yang investigation software data curation writing original draft visualization validation yan lin supervision formal analysis writing review editing guan guan conceptualization methodology project administration funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to express their sincere thanks to the institute of ship and marine engineering design dalian university of technology for providing support for the research the authors are grateful to the national natural science foundation of china 51609036 and the fundamental research funds for the central universities dut18jc05 for its financial support 
