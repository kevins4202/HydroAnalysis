index,text
1705,the successful utilization of hot dry rock is contingent upon the implementation of the development of the enhanced geothermal system egs to create a complex fracture network however the fracture is affected by thermal stress which results from the temperature difference between low temperature fluid and high temperature rock to address this issue a dynamic model of fracture width that takes thermal stress into account has been proposed this model is based on the modified three dimensional embedded discrete fracture model edfm method and is solved by finite volume method coupling local boundary element this model is based on the modified three dimensional edfm method and is solved by finite volume method coupling local boundary element the proposed method has been validated through comparing with results obtained from commercial finite element software furthermore the method is applied to the simulation of egs to analyze the parameter sensitivity of the mass and heat transfer process the results indicate that neglecting the impact of thermal stress on fracture width leads to an underestimation of produced energy the shape and inclination angle of fractures significantly affect the mass and heat transfer in the reservoir moreover the shape and inclination angle of fractures significantly affect the mass and heat transfer in the reservoir a larger heat exchange area results in faster temperature decreases and increased heat energy production high thermal diffusion coefficients improve the performance of egs while an increase in the thermal expansion coefficient of rock accelerates thermal breakthrough and enhances heat energy production it has been found that maintaining a small pressure difference between injection and production and using low temperature injection water can prolong the system lifetime and increase the final heat energy produced this study presents an efficient numerical simulation method for mass and heat transfer in fractured reservoirs expands the original edfm method s application range and enhances calculation accuracy keywords embedded discrete fracture model enhanced geothermal system fracture width change model numerical simulation data availability no data was used for the research described in the article nomenclature k permeability m2 t time s μ w water viscosity mpa s ρ w water density kg m3 p w water pressure pa ϕ porosity b w water volume factor m3 m3 q w mf water rate between matrix and fracture m3 s q w mw water rate between matrix and well pa 1 g gravity acceleration m s2 a area of mesh contact surface m2 d distance from the fracture grid to the intersection m l ij common boundary length of ith and jth fracture grids m w fracture widthy m zi number of boundary of the ith polygon fracture grid n total number of fracture grids in the matrix grid dim distance from the center of the ith facture grid to the mth edge m lim length of the mth boundary of the ith fracture grid m r w well radius m r e equivalent outer boundary radius nf number of fracture units h matrix grid thickness m θ angle between the straight line of the fractured horizontal well near the fracture grid and the normal vector of the fracture grid plane t temperature λ c thermal conductivity w m c specific heat capacity j kg d f mechanical stiffness of rock n m δ b change of fracture width m b 0 initial fracture width m k f 0 initial fracture permeability superscripts m matrix f fracture w well subscripts r rock w water 1 introduction with the acceleration of global carbon neutrality efforts the importance of clean and renewable energy has been on the rise kurramovich et al 2022 the global energy consumption is transitioning away from oil as the primary energy source towards a multi energy structure zhang et al 2018 geothermal energy is one of the most promising clean and renewable energy resources bataille et al 2006 lund and boyd 2016 wei et al 2015 hot dry rock hdr is a type of geothermal energy with abundant reserves wide distribution and deep burial anderson and rezaie 2019 wang et al 2015 hdr typically requires the enhanced geothermal system egs through artificial fracturing due to its low permeability olasolo et al 2016 an efficient numerical simulation method can use limited resources to simulate and optimize egs production strategies and evaluate egs performance o sullivan et al 2001 although global geothermal projects have been extensively studied feng et al 2014 lu 2018 the complex underground reservoir environment and heat transfer mechanisms still require further analysis xu et al 2015 the temperature difference between the injected fluid and the reservoir rock generates thermal stress chen et al 2019 while changes in pore pressure alter the in situ stress field yao et al 2018 these variations in temperature and stress impact key seepage parameters including permeability and porosity guo et al 2020 as a result simulating egs is a complex multi factor coupling problem that presents significant challenges to the accuracy and efficiency of numerical simulations zhao et al 2020 the efficient development of egs requires the complex fracture network which poses a challenge to accurate characterization of the factors involved in the fracture morphology and the mutual contact relationship between fractures cao et al 2022 li and lior 2015 the embedded discrete fracture model edfm avoids the division of unstructured meshes by embedding the fracture meshes into the structured meshes of the matrix the edfm has good application prospects in mass and heat transfer problems in the three dimensional discrete fractures with complex geometry and spatial distribution rao et al 2019a rao et al 2019b however the edfm method assumes that the matrix pressure is linearly distributed along the vertical fracture direction leading to low accuracy in early production to improve calculation accuracy shi et al 2021 proposed a modified edfm method using a boundary element method to calculate mass and heat transfer between matrix and fractures the mechanism and quantification method of matrix shrinkage caused by reservoir temperature reduction leading to fracture width and permeability changes are critical cao et al 2022 anyim and gan 2020 most characterization methods considering the change of fracture width are empirical expressions of uniaxial mechanical test results based on specific fitting parameters bandis et al 1983 evans et al 1999 jabbari et al 2017 the limitations of the aforementioned methods are that laboratory scale experiments cannot fully capture the complexity of reservoir scale and the thermal stress is often neglected additionally accurately measuring normal effective stress can be challenging wang et al 2016 wang et al 2016 found that cold water injection can increase fracture permeability by up to 700 by a semi analytical formula however the model does not account for thermal convection in order to simplify the governing equations ghassemi et al 2008 gave the analytical solution of fracture width change caused by thermal and pore elasticity under non isothermal flow conditions they obtained the relationship between fracture width rock characteristics and temperature at different times but it does not extend to the existence of multiple fractures another method is to deal with the thermal hydrodynamic mechanical thm multi field coupling to calculate the change in fracture conductivity in egs numerical simulation chen et al 2019 wang et al 2020 zhao et al 2020 hicks et al 1996 established a thm coupling model under regular fracture networks and considered that the output temperature would be overestimated without considering the mechanical effect ghassemi and zhou 2011 based the finite element method to study the flow heat transfer and fracture width changes of cold working fluid injected into artificial thermal storage they believe that the pore elasticity effect is evident at the initial stage of the change of injection pressure and fracture width after long term injection the thermoelasticity effect became the leading role yu et al 2019 coupled the tough2 csm parallel edfm framework with the geomechanical model to study the effects of geomechanical factors sun et al 2017 established a 2d geothermal model based on comsol multiphysics software and showed the importance of considering the thm coupling effect yao et al 2018 also simulated the three dimensional egs multi field coupling process and analyzed the utilization efficiency and production performance of egs liao et al 2020 studied a three dimensional anisotropic geothermal reservoir with tough2mp flac3d and the damage permeability model considering the increased fracture permeability extended finite element method xfem edfm can accurately consider the effects of geological mechanics factors on each fracture by combining the advantages of the structured grid of edfm li et al 2021 however due to the computational efficiency it is difficult to be apply to the simulation of complex fracture networks ren et al 2016 zeng et al 2019 to sum up there are few reports on the efficient fracture width model considering thermal stress for the three dimensional edfm method although there have been many numerical simulation studies on the multi field coupling of egs there are still deficiencies in the computational efficiency of the model the main problem is that the unstructured grid in dfm is challenging to meshing when dealing with complex fractures resulting in poor computational convergence the existing edfm method is not capable of efficiently solving the thm coupling problem when considering thermal stress accurate and rapid egs thermal extraction process simulation using a large scale three dimensional fracture network is still challenging zhao et al 2020 this paper proposes a three dimensional complex fracture model considering fracture width variation with thermal stress based on the edfm method it can better adapt to the three dimensional fracture width change of various fracture forms the validity of method proposed is verified by comparing the calculation results with comsol multiphysics software and field data moreover the method is applied to analyze the sensitivity of reservoir parameters and optimize the injection and production parameters which demonstrates its effectiveness in practical engineering applications 2 methodology 2 1 mathematical model the research is realized by matlab version 2020b programming in this study the following assumptions are made to simplify the practical problems in water egs reasonably 1 darcy s law is satisfied for fluid flow in matrix and fracture 2 the single phase water flow is assumed in this work and the phase changes are not considered in this study 3 the heat exchange between water and rock only considers the processes of heat conduction and heat convection and it assumes local thermal equilibrium 4 heat loss in the vertical wellbore is not considered and the rock is linearly elastic 5 the effect of the wellbore on the fluid temperature is negligible 6 since this paper mainly considers shear type fractures the presence of proppants is not considered 1 mass conservation equations the edfm method divides the matrix and fracture into two systems with independent properties the three dimensional mass conservation equations of the matrix and fracture considering the effects of gravity are shown in eqs 1 and 2 1 ω t ρ w ϕ b w d ω ω ρ w k μ w b w p w ρ w g d d ω m ρ w q w mf ρ w q w mw 2 ω t ρ w ϕ b w d ω ω ρ w k μ w b w p w ρ w g d d ω f ρ w q w fm ρ w q w fw the viscosity and density of water depending on the temperature especially for high temperature and high pressure conditions the empirical relational equations proposed by rabinowicz et al 1998 can be expressed as follows 3 μ w 2 414 10 2 10 247 8 t 133 15 4 ρ w 838 4661 1 4005 t 273 15 0 0030 t 273 15 2 3 7182 10 7 t 273 15 3 the following gives the discrete form of eq 2 based on the finite volume method 5 j 1 n ρ w i j t i ij p w j p w i ρ w j g d j ρ w i g d i t δ t ρ w q w mf ρ w q w mw t δ t δ v i δ t ρ w ϕ b w i t δ t ρ w ϕ b w i t where 6 ρ w i j ρ w i ρ w j 2 7 t i ij g ij μ w i μ w j 2 b w i b w j 2 table 1 lists the calculation formulas of geometric coefficients under different grid connection types the mass transfer calculaion between matrix and fracture based the boundary element method eq 8 can improves the calculation accuracy shi et al 2021 cao et al 2019 8 ρ α q α n f 1 mf ρ α kh μ a b a gf n f 4 g 4 4 1 g fm 4 n f g ff n f n f 1 gf n n f 4 gf n f 4 g 4 4 1 g n 4 4 g conv 4 5 p a 5 1 m p a n f 1 f where g ff gf g g fm g n can be found in appendix a the source and sink terms related to well can be expressed as 9 ρ w q w mw ρ w k m μ w b w 2 π h ln r e r w p w m p w w 10 ρ w q w fw ρ w k f μ w b w 2 π w f cos θ ln r e r w p w f p w w where r e is solved by peaceman formulation peaceman and d w 1978 2 energy conservation equations the local thermal equilibrium assumption is used to simulate the heat exchange between rock and fluid the equation of conservation of energy in matrix and fracture is described 11 ω ρ c c pc t t ρ w c pw k μ u b w p ρ w g d t λ c t d ω m q c mf q h mf q h mw 12 ω ρ c c pc t t ρ w c pw k μ u b w p ρ w g d t λ c t d ω f q c fm q h fm q h fw 13 ρ c c pc ϕ ρ w c pw 1 ϕ ρ r c pr 14 λ c ϕ λ w 1 ϕ λ r the matrix fracture heat coupling is divided into conduction q c mf and convection q h mf and q h mw in the high pressure and high temperature environment of underground storage the thermal conductivity and specific heat capacity of the fluid are no longer constant which will dramatically change the mass and energy transfer process of the fluid for the variation of heat capacity and thermal conductivity of water with temperature from 273 k to 553 k the following equation is used for this study zhang et al 2019 15 λ w 0 8691 0 0089 t 273 15 1 5837 10 5 t 273 15 2 7 9754 10 9 t 273 15 3 16 c pw 12010 1471 80 4073 t 273 15 0 3099 t 273 15 2 5 3819 10 4 t 273 15 3 3 6254 10 7 t 273 15 4 the finite volume discrete form of the above equation is given 17 j 1 n t i ij h t j t i t δ t j 1 n t i ij t ij p w j p w i ρ w j g d j ρ w i g d i ρ w i c pw i t δ t q c mf q h mf q h mw t δ t δ v i δ t ρ c c pc t i t δ t ρ c c pc t i t similarly the expression of the energy conduction coefficient t i ij h of adjacent grids were given in table 1 the heat source between matrix and fracture can be expressed as 18 q h fm c pv ρ w q w t fm 19 q c n f 1 mf λ a h g ff n f n f gf n f 4 g 4 4 1 g fm 4 n f 1 gf n n f 4 gf n f 4 g 4 4 1 g n 4 4 g conv 4 5 t 5 1 t f n f 1 eq 19 is derived by the boundary element method shi et al 2021 the fully implicit coupling solution is considered here that is solving the entire nonlinear equations simultaneously in a newton raphson iteration 2 2 the fracture width change model with thermal stress fig 1 illustrates the schematic diagram of the equivalent change in fracture width in the edfm when the pressure difference between matrix and fracture is assumed to be constant during each time step the matrix displacement equation is simplified to 20 u x 2 x 2 1 v 1 v β t t m 0 x the displacement boundary condition is imposed on the center of the fracture grid eslami et al 2013 21 u x x 0 t 0 in the outer boundary of the whole region the normal displacement is assumed as zero then the general solution of the above equations can be obtained 22 u x 1 v 1 v β 0 x t t m 0 d x c x the change in normal stress in the matrix can be calculated based on displacement 23 δ σ xx e m 1 v 1 2 v 1 v u x x 1 v β t t m 0 meanwhile the interface between the fracture and the matrix will achieve a state of mechanical equilibrium that is 24 δ σ xx v 1 s f d f u x v 1 s f δ p f where v 1 and v 2 is a part of the volume of the matrix block by the fracture surface s f is the area of the fracture surface the integral term in eq 20 can be calculated by the following equation 25 0 x t t m 0 d x 1 3 v 1 s f t t m 0 eq 27 30 is solved simultaneously to obtain the expression of c 26 c p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 1 s f e m 1 v 1 2 v 1 v d f v 1 s f when the d f is constant the displacement at the matrix fracture interface can be expressed as 27 u v 1 s f 1 3 β 1 v 1 v t t m 0 p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 1 s f e m 1 v 1 2 v 1 v d f v 1 s f v 1 s f 28 u v 2 s f 1 3 β 1 v 1 v t t m 0 p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 2 s f e m 1 v 1 2 v 1 v d f v 2 s f v 2 s f the displacement on both sides of the fracture can be calculated by eq 27 and eq 28 the equations of fracture width variation and fracture permeability are as follows 29 δ b u v 1 s f u v 2 s f 30 k fi k f i 0 b i 0 δ b i 3 b i 0 3 it is postulated that the alteration in width of the fracture element is exclusively influenced by the distortion of the corresponding two matrix grids positioned at perpendicular to the fracture direction in this way the width variation of each fracture element in the edfm method is solved fig 2 it should be noted that if the fracture unit and the matrix mesh only intersect at one point while calculating the width change the matrix block will be divided into two parts along the fracture direction such as ⑥ in fig 2 however it should be emphasized that the model presented in this paper is mainly suitable for the case of matrix non permeability or low permeability and the higher matrix permeability may cause some errors 3 results and discussion 3 1 verification of fracture width change model the opening and closing of fractures will change their permeability affecting the heat transfer efficiency therefore it is essential to accurately characterize fracture width and permeability changes in the egs process the method is validated at a grid scale based on three cases further the model with artificial fractures in the reservoir was tested the reference solution of this part is solved based on the comsol multiphysics software massachusetts and burlington 2018 the software uses the finite element method to develop a fully coupled solution considering solid deformation seepage and heat transfer and the results are accurate and reliable 3 1 1 case1 single vertical fracture the fracture unit is parallel to one edge of the matrix grid fig 3 a the initial matrix and fracture temperature are assumed as 100 c the boundary conditions around the matrix block are roller support fig 3 b is the diagram of triangular mesh division in comsol multiphysics software fig 3 c is the diagram of rectangular mesh 25 25 division in the edfm method the physical properties of water and rock are considered as constant the other physical parameters required for the simulation can be found in table 2 the simulation results show that the low temperature zone spreads from the fracture to the matrix on both sides and the right side of the fracture is first completely cooled to 20 c fig 4 a shows the matrix fracture temperature distribution results calculated by comsol multiphysics software at t 8000 s fig 4 b shows the results of the edfm method the normalized mean absolute error nmae between the calculated solution and the reference solution is characterized by eq 31 when the number of matrix grids is increased from 625 to 2500 the nmae from 2 92 decreases to 1 34 an essential point for the model proposed here is to focus on the change of fracture width fig 4 c is the displacement distribution results in the x direction by comsol multiphysics software when t 10000 s in order to more intuitively show that the displacement change at both sides of the fracture in fig 4 c is amplified by 50 times it can be seen that the increase in the fracture width is caused by cold water injection fig 4 d shows the change of the average fracture width change with time calculated by the edfm method and comsol multiphysics software it can be seen that the two results have good consistency 31 nmae i 1 n x i x i ref n max x i ref min x i ref where n is grid numbers x i is modeling results x i ref is reference results 3 1 2 case 2 single inclined fracture from fig 5 a case2 shows a certain angle not 0 or 90 with a single fracture and the edge of the matrix grid fig 5 b and fig 5 c are the grid division results of comsol multiphysics software and edfm method respectively compared with case1 the inclined fracture is more common in the edfm method except that the fracture location is different from case1 the other model parameters are the same as those of case1 table 1 after injection for 10000 s the temperature field distribution results calculated by the two methods are compared fig 6 a and fig 6 b and the corresponding nmae value is 3 15 after increasing the number of grids from 625 to 2500 the value decreases to 1 81 it shows the accuracy of temperature field calculation when calculating this kind of problem fig 6 c is the displacement field diagram in the x direction by comsol multiphysics software when t 10000 s unlike case 1 the displacement changes of the matrix on both sides of different fracture joints are not the same so it is often impractical to simplify the change value of the whole fracture width to one value reflecting the advantage of the edfm method to divide the whole fracture into multiple elements to calculate the width change fig 6 d shows that the calculated results of the model proposed here are accurate for the time varying process of inclined fracture width 3 1 3 case 3 complex cross fractures one of the advantages of the edfm method is to deal with complex fracture network systems so there are usually fractures crossing like fig 7 a fig 7 b and fig 7 c are the grid division results of comsol software and the edfm method respectively the parameters of the model are consistent with table 1 from fig 8 a and fig 8 b the temperature field distribution simulated by the two methods after injection of 6000 s showed high consistency and the calculated nmae value was 3 87 when the number of grids increased from 625 to 2500 the value decreased to 2 12 in fig 8 d and fig 8 e the calculation results of the fracture width change between comsol multiphysics and the edfm method were compared which are consistent the results show that proposed method is suitable for edfm and can ensure high calculation accuracy 3 1 4 case 4 natural fractures in order to further eliminate the effects of scale on boundary conditions a 50 m 50 m 5 m model fig 9 a is given in this example which contains three natural fractures the left boundary of the model simulates constant pressure 40 mpa injection into the cold fluid in horizontal wells and the right boundary simulates constant pressure 10 mpa recovery in horizontal wells in the simulation the matrix permeability is 0 01md the initial fracture width of fracture is 0 05 m fig 9 b and fig 9 c are the grid division results of comsol multiphysics software and the edfm method respectively the remaining parameters of the model are consistent with table 1 comparing fig 10 a with fig 10 b it can be seen that after 1200 days of implementation the two methods temperature fields still maintain good consistency the nmae is 5 29 which drops to 3 85 when the grid number of edfm is increased from 625 to 2500 fig 10 c shows the variation of the average width of three fractures with time and the calculation results of the two methods also show good consistency however compared with the previous three examples there are two reasons for the increased error one is that the permeability of the matrix is considered as mentioned earlier the model derived is mainly for the case that the matrix has no or low permeability the second is that the natural fracture model of comsol considering the thm coupling effect presents a shape with narrow sides and wide middle and the grid divided by comsol is finer overall however the model proposed has good calculation accuracy for mass transfer and heat transfer with low matrix permeability 3 1 5 field data verification desert peak geothermal field is located in the eastern edge of the great basin segment of the basin and range province 130 km northeast of reno kelkar et al 2014 the buried depth of the formation is 1610 2606 m and the average temperature is 210 c this part selects the well group as shown in the fig 11 for research the fracture permeability and porosity are obtained by inverting the temperature of the early production wells other data can be found in the reference chabora et al 2012 hickman and davatzes 2010 and the specific parameters are shown in the table through simulation it is found that if the change of fracture width is not considered the injection rate of the injection well will slowly decrease due to energy depletion after considering the change of fracture width caused by thermal stress the width of the fracture gradually increases which is reflected in the gradual increase of the injection rate to remain stable the simulation results are in good agreement with the field data which shows the accuracy and reliability of the numerical simulation method in this paper see fig 12 3 2 single fracture conceptual case this section provides two cases for analyzing the applicability of the method and the sensitivities of the key mechanisms and key parameters of egs the first case is a single fracture conceptual model while the egs system is often composed of complex fracture networks the single fracture model can more accurately and fully reflect the change of heat transfer mechanism and fracture width therefore this study mainly concerns the mass and heat transfer mechanism in the egs system through the single fracture model shown in fig 13 a model of 100 m 100 m 10 m was established in the middle of the reservoir there is a rectangular fracture cold water is injected at 35 mpa on one side of the fracture and produced at 25 mpa on the other side the parameters are in table 4 3 2 1 process and mechanism analysis the injected low temperature water flows along the fracture to the production well under pressure difference from the simulation results fig 14 the pressure system of the whole model is gradually stable with time the low temperature zone continues to expand and close to the production well due to the high flow rate in the fracture and the strong thermal convection next the mass and heat transfer mechanisms related to this process are analyzed the critical analysis indicators are production temperature and total heat energy produced eq 38 the unit of heat energy is usually j however mw h or kw h was used as the unit considering that the energy produced by deep geothermal energy is mainly used for power generation the temperature of production wells is one of the critical factors affecting the production efficiency of the egs system and it is an essential indicator for evaluating the production performance and lifetime of the egs in general geothermal energy is renewable energy when the average heat storage temperature decreases to a certain extent or the production temperature decreases to a certain proportion the egs will stop running baria et al 1999 tester et al 2006 the total heat energy produced can be used for power generation or heating determining the system s heat production capacity and economic benefits yu et al 2021 38 q u 0 t ρ q c p f t out t in d t one of the main characteristics of this model is to consider that the fluid s flow and heat transfer properties are a function of temperature rather than a constant value because the egs system is often buried deep the temperature difference between the injected fluid and the reservoir temperature is large thus ignoring the change of fluid physical properties with temperature is unrealistic this will be demonstrated here and the effects of fluid parameters changing with temperature on the egs production index is quantified the parameter value is a constant value under the initial reservoir temperature or a function of temperature in order to be more intuitive the temperature field distribution diagram is displayed in a two dimensional view of the actual three dimensional model as fig 15 a and fig 15 b shows the swept area of the low temperature region is smaller when considering the temperature effect of fluid properties because the decrease in temperature leads to a deterioration of fluid flow and weakens the effects of thermal convection comparing the production temperature and heat energy produced in these two cases fig 15 d and fig 15 e the thermal breakthrough rate considering the temperature effect of fluid properties is slower due to poor fluidity caused by the temperature decrease ignoring the temperature effect of fluid properties underestimates the system s production temperature and lifetime and overestimates the heat energy produced with differences of 32 54 and 43 95 respectively after 1000 days fracture is the primary energy transfer channel and plays a vital role in heat extraction the general reservoir modeling often ignores the effects of temperature change on fractures however it is necessary to correctly understand the role of thermal stress caused by temperature change comparing the temperature field diagram of fig 15 b and fig 15 c it can be seen that if the change of fracture width is not considered the thermal breakthrough speed will slow down by comparing fig 15 d and fig 15 e if the change effect of fracture width is ignored the production temperature will be overestimated and the heat energy produced will be overestimated the degree after 1000 days was 11 75 and 27 06 respectively the fracture width and permeability change in the process were analyzed fig 16 a it can be seen that the width and permeability of fractures gradually increase with time and the amplitude of early change is large and the speed of late change gradually slows down the reason is that the temperature field in fracture gradually tends to be stable with the advancement of the low temperature zone after 1000 days the average width of the fracture increases from 5 mm to 6 36 mm the fracture morphology is shown in fig 16 b and the average permeability is also 2 12 times that of the original it explains the phenomenon that the fluid flow change and the thermal breakthrough accelerates after the cold water injection it reflects that it is necessary to consider the change in fracture width caused by thermal stress during the simulation of the egs 3 2 2 geologic parameters sensitivity analysis 1 fracture shape in the actual egs reservoir fractures often have various shapes and distribution patterns in this section the distribution forms of four single fractures are extracted and analyzed as shown in fig 17 a mode a is a horizontal transverse fracture and the initial size is 10 m 100 m 0 005 m mode b is an inclined fracture with a horizontal angle of 45 and the initial size is 14 41 m 100 m 0 005 m mode c is a vertical rectangular fracture and the initial size is 10 m 100 m 0 005 m mode d is a vertical longitudinal elliptical fracture and the initial size is 10 m short axis 100 m long axis 0 005 m it can be seen from fig 17 b that the shape and distribution of fractures significantly effects temperature transfer which also shows that this model has good applicability for the mass transfer and heat transfer problems of arbitrary three dimensional fractures this has not been discussed in most previous studies fig 18 a and fig 18 b compare the production temperature and heat energy produced it can be seen that the heat transfer area and inclination angle of the fracture are essential factors affecting the mass and heat transfer in the reservoir the larger the heat exchange area the faster the temperature of the production decreases and the higher the amount of heat energy produced compared with the elliptical fracture the rectangular fracture has faster thermal breakthrough speed and more heat energy produced therefore it is necessary to accurately characterize the shape and distribution of fractures in the three dimensional model 2 thermal diffusion coefficient of rock the thermal diffusion coefficient is a measure of the rate at which the temperature perturbation at one point passes to another in an object usually defined as the following 32 α λ c ρ the rock density rock thermal conductivity rock specific heat capacity and rock thermal expansion coefficient are usually heterogeneous here we analyze the effect of different thermal diffusion coefficients 1 60 10 6 m2 s 1 1 10 6 m2 s 1 and 5 10 7 m2 s 1 fig 19 a fig 19 b and fig 19 c show the temperature fields after 1000 days of injection with different thermal diffusion coefficients more significant thermal diffusion coefficients result in improved areas affected by low temperatures fig 19 d and fig 19 e show that the increase in the thermal diffusion coefficient of rocks slows down the thermal breakthrough speed and increases the heat energy produced the results indicate that reservoirs with large thermal rock conductivity small rock density and small rock heat capacity are conducive to the heat recovery of the egs 3 thermal expansion coefficient the thermal expansion coefficient reflects the ability of thermal expansion and contraction of the object the effects of different thermal expansion coefficients 4 10 6 c 1 8 10 6 c 1 1 6 10 5 c 1 on the change of fracture width is analyzed it can be seen from fig 20 a and fig 20 b that larger thermal diffusion coefficients result in an improved change in fracture width and corresponding permeability accordingly the thermal breakthrough speed and heat energy produced will also be larger fig 20 c and fig 20 d 3 3 multi layer water egs case the second case is an actual multi fracture three dimensional egs system this case is a model that combines actual reservoir parameters in this paper in fact the region has not entered the actual dry hot rock development stage but through the previous geological survey it is believed that the block junggar basin china does have the potential of egs as shown in fig 21 a the effective fracturing area on the horizontal plane after hydraulic fracturing is 500 m 300 m divided into three layers vertically and the cumulative thickness is 150 m the distribution of a complex fracture network can be seen more clearly in fig 21 b the initial permeability of fractures is 15000md it should be noted that some fractures do not entirely run through the three layers vertically and there are some inclined fractures the geothermal gradient of the reservoir is considered to be 4 c 100 m fig 21 c after the preliminary investigation it is considered that this area has the potential for the development of hdr other parameters of the model can be found in table 5 3 3 1 simulation result analysis the change of temperature field is the first object to be concerned in egs fig 22 shows the low temperature zone spreads from the injection well to the production well as time goes on fig 23 shows the temperature distribution of each layer after 40 years of system operation the effects of fracture distribution on the temperature field morphology can be seen the change in fracture width and permeability during the operation of the egs was analyzed fig 24 a shows the change in average fracture permeability with time it is seen that the average fracture width after 40 years changed from 0 008 m to 0 0136 m and the average fracture permeability increased from 15000md to about 80000md which expanded by 4 33 times the results reflect the importance of considering the change in fracture width fig 24 b shows the simulation results of the system for 40 years it is seen that the early thermal breakthrough speed was slow and the thermal breakthrough speed became faster after about ten years meanwhile heat production increases almost linearly over time however it is almost impossible in the field to allow the reservoir temperature to decline too fast therefore the corresponding injection production parameters must be optimized 3 3 2 injection production system sensitivity analysis the stable operation of the egs requires that the temperature drop of the production well should be as small as possible throughout the design cycle to maximize the efficiency of the ground power generation equipment it is necessary to slow down thermal breakthrough time and prolong the system s lifetime the physical parameters are fixed for a specific reservoir here three parameters are analyzed injection production pressure difference injection temperature and well pattern as a renewable energy geothermal energy needs to consider sustainable exploitation therefore it is necessary to define the mining life to extract heat from the heat source for as long as possible in this study the system will stop running when the production temperature decreases by 10 in the original state wong et al 2018 the final heat energy produced can be obtained at this time in this case the produced temperature reaching 160 c is selected as the critical temperature for the system to stop operation 1 injection production pressure difference the effects of the injection production pressure difference were first studied in this research six different injection production pressure differences 8 mpa 10 mpa 12 mpa 14 mpa 16 mpa and 18 mpa were investigated with the injection temperature set to 40 c it was observed from fig 25 a and fig 25 b that a small injection production pressure difference slowed down the speed of thermal breakthrough increased the lifetime of the system and increased the final heat energy produced however it also resulted in a slower rate of thermal energy recovery as shown in fig 25 c a decrease in the injection production pressure difference resulted in an increase in the operational life while the average annual heat energy produced and energy output per unit time decreased therefore the determination of the injection production pressure difference should consider both the heat recovery rate and the final heat recovery a 10 mpa injection production pressure difference can ensure a high final heat energy produced while maintaining a high recovery rate as a lower injection production pressure difference of 8 mpa resulted in a slow heat production rate 2 injection temperature the previous analysis has shown that the lower the temperature is the worse the fluid flow is thus limiting the thermal breakthrough speed however the larger temperature difference with the original reservoir temperature will also lead to a more significant variation of the fracture width thereby is beneficial to the fluid flow and accelerates the speed of thermal breakthrough the injection temperatures are 20 c 30 c 40 c 50 c and 60 c the injection production pressure difference is 10 mpa it is seen from fig 26 a that the low injection temperature does not lead to a faster thermal breakthrough speed but has a longer lifetime the results indicate that the mechanism of low temperature on the fluid flow properties plays a leading role it is seen from fig 26 b that low injection temperature produces higher heat energy but the heat produced rate at 20 c is lower than that at 30 c however when the injection temperature is 40 c 50 c 60 c there is little difference in the rate of heat energy production the injection of the high temperature fluid itself will increase heating costs so the optimal injection temperature is 20 c 3 well patterns three distinct well configuration plans depicted in fig 27 are put into practice based on the fracture distribution of the model these schemes comprise of a single injection well with one production well a single injection well with two production wells and a single injection well with three production wells to ascertain the service life of the system the mean production temperature from multiple wells is capped at 160 c while the injection temperature is set at 20 c and the injection production pressure differential is sustained at 10 mpa fig 28 a 28 b and 28 c depict the temperature distribution after 60 years for three different well configurations the extent of the low temperature zone does not differ significantly among the cases as observed from the figures however the third case has a longer lifetime and generates more heat energy in the end the spread of the low temperature zone can be expanded by wells wp1 and wp3 and the thermal breakthrough at wp2 is slowed down although the third case has better production results when considering the cost of well construction and the slight difference in early and middle stages of production fig 28 e the optimal well pattern is still one injection well and one production well 4 conclusions the mechanism of mass and heat transfer in complex fractures with arbitrary geometry is embedded in the edfm framework in this work to accurately characterize the complex fracture morphology a three dimensional model and numerical method were established based on the edfm method which is capable of describing widely and accurately the mass and heat transfer process in the enhanced geothermal system the accuracy of the proposed model and method is verified by comparing the results with the comsol multiphysics software and field data furthermore a single fracture conceptual model is used to analyze the process of mass and heat transfer finally the method is applied to an actual egs system and the injection production pressure difference injection temperature and well pattern were optimized the main conclusions are as follows 1 the proposed model can describe the complex mass and heat transfer process between fractures of arbitrary distribution and morphology and matrix in three dimensional reservoirs the change of fluid properties with temperature and the change of fracture width caused by thermal stress is considered 2 ignoring the temperature effect of fluid properties underestimates the production temperature and lifetime of the system while overestimating the produced energy of the system ignoring the effect of fracture width variation overestimates the production temperature and lifetime of the system while underestimates the produced energy 3 the heat transfer area and dip angle of fractures are essential factors affecting the mass and heat transfer in the formation 4 the larger the thermal diffusion coefficient of rock is the better the performance of the egs is increasing the thermal expansion coefficient of rock increases the width and permeability of fractures and the corresponding thermal breakthrough speed and heat energy produced increase 5 in the case of egs it is found that small injection production pressure difference and low injection temperature are beneficial to extend the system lifetime and improve the final energy produced in the model of this paper the influence of the chemical effect caused by the water rock reaction was ignored we did not consider the multiphase flow problem caused by higher temperature in egs reservoirs which is our further work credit authorship contribution statement renyi cao conceptualization writing review editing junjie shi methodology writing original draft software zhihao jia writing review editing chong cao investigation linsong cheng project administration supervision gaoling liu visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would further like to thank the financial support of the national natural science foundation of china nos 51774297 52174038 u1762210 we also acknowledge that this study was partially funded by the china petroleum technology project no zlzx2020 02 04 appendix a expression represented by the main symbol a1 g c m 1 1 c m 1 2 c m 1 3 c m 1 4 c m 2 1 c m 2 2 c m 2 3 c m 2 4 c m 3 1 c m 3 2 c m 3 3 c m 3 4 c m 4 1 c m 4 2 c m 4 3 c m 4 4 c mi j s jj g h x mi y mi x y d s x y a2 g n d c m 1 1 d c m 1 2 d c m 1 3 d c m 1 4 d c m 2 1 d c m 2 2 d c m 2 3 d c m 2 4 d c m 3 1 d c m 3 2 d c m 3 3 d c m 3 4 d c m 4 1 d c m 4 2 d c m 4 3 d c m 4 4 d c mi j s bj g h x mi y mi x y n d s x y λ x mi y mi i j s bj g h x mi y mi x y n d s x y i j a3 g fm c f m 1 1 c f m 1 2 c f m 1 n f c f m 2 1 c f m 2 2 c f m 2 n f c f m 4 1 c f m 4 2 c f m 4 n f c fmi j s f g h x mi y mi x y d s x y a4 gf c m f 1 1 c m f 1 2 c m f 1 4 c m f 2 1 c m f 2 2 c m f 2 4 c mf n f 1 c mf n f 2 c mf n f 4 c mfi j s bj g h x fi y fi x y d s x y a5 gf n d c m f 1 1 d c m f 1 2 d c m f 1 4 d c m f 2 1 d c m f 2 2 d c m f 2 4 d c mfnf 1 d c mfnf 2 d c mfnf 4 d c mfi j s bj g h x fi y fi x y n d s x y a6 g ff c f f 1 1 c f f 1 2 c f f 1 n f c f f 2 1 c f f 2 2 c f f 2 n f c ffnf 1 c ff n f 2 c ff n f n f c ffi j s fj g h x fi y fi x y d s x y where s b represents the boundary of a local grid s f represents the fracture boundary of the local grid x mi y mi represents the midpoint of the matrix grid boundary x fi y fi represents the center of the fracture unit 
1705,the successful utilization of hot dry rock is contingent upon the implementation of the development of the enhanced geothermal system egs to create a complex fracture network however the fracture is affected by thermal stress which results from the temperature difference between low temperature fluid and high temperature rock to address this issue a dynamic model of fracture width that takes thermal stress into account has been proposed this model is based on the modified three dimensional embedded discrete fracture model edfm method and is solved by finite volume method coupling local boundary element this model is based on the modified three dimensional edfm method and is solved by finite volume method coupling local boundary element the proposed method has been validated through comparing with results obtained from commercial finite element software furthermore the method is applied to the simulation of egs to analyze the parameter sensitivity of the mass and heat transfer process the results indicate that neglecting the impact of thermal stress on fracture width leads to an underestimation of produced energy the shape and inclination angle of fractures significantly affect the mass and heat transfer in the reservoir moreover the shape and inclination angle of fractures significantly affect the mass and heat transfer in the reservoir a larger heat exchange area results in faster temperature decreases and increased heat energy production high thermal diffusion coefficients improve the performance of egs while an increase in the thermal expansion coefficient of rock accelerates thermal breakthrough and enhances heat energy production it has been found that maintaining a small pressure difference between injection and production and using low temperature injection water can prolong the system lifetime and increase the final heat energy produced this study presents an efficient numerical simulation method for mass and heat transfer in fractured reservoirs expands the original edfm method s application range and enhances calculation accuracy keywords embedded discrete fracture model enhanced geothermal system fracture width change model numerical simulation data availability no data was used for the research described in the article nomenclature k permeability m2 t time s μ w water viscosity mpa s ρ w water density kg m3 p w water pressure pa ϕ porosity b w water volume factor m3 m3 q w mf water rate between matrix and fracture m3 s q w mw water rate between matrix and well pa 1 g gravity acceleration m s2 a area of mesh contact surface m2 d distance from the fracture grid to the intersection m l ij common boundary length of ith and jth fracture grids m w fracture widthy m zi number of boundary of the ith polygon fracture grid n total number of fracture grids in the matrix grid dim distance from the center of the ith facture grid to the mth edge m lim length of the mth boundary of the ith fracture grid m r w well radius m r e equivalent outer boundary radius nf number of fracture units h matrix grid thickness m θ angle between the straight line of the fractured horizontal well near the fracture grid and the normal vector of the fracture grid plane t temperature λ c thermal conductivity w m c specific heat capacity j kg d f mechanical stiffness of rock n m δ b change of fracture width m b 0 initial fracture width m k f 0 initial fracture permeability superscripts m matrix f fracture w well subscripts r rock w water 1 introduction with the acceleration of global carbon neutrality efforts the importance of clean and renewable energy has been on the rise kurramovich et al 2022 the global energy consumption is transitioning away from oil as the primary energy source towards a multi energy structure zhang et al 2018 geothermal energy is one of the most promising clean and renewable energy resources bataille et al 2006 lund and boyd 2016 wei et al 2015 hot dry rock hdr is a type of geothermal energy with abundant reserves wide distribution and deep burial anderson and rezaie 2019 wang et al 2015 hdr typically requires the enhanced geothermal system egs through artificial fracturing due to its low permeability olasolo et al 2016 an efficient numerical simulation method can use limited resources to simulate and optimize egs production strategies and evaluate egs performance o sullivan et al 2001 although global geothermal projects have been extensively studied feng et al 2014 lu 2018 the complex underground reservoir environment and heat transfer mechanisms still require further analysis xu et al 2015 the temperature difference between the injected fluid and the reservoir rock generates thermal stress chen et al 2019 while changes in pore pressure alter the in situ stress field yao et al 2018 these variations in temperature and stress impact key seepage parameters including permeability and porosity guo et al 2020 as a result simulating egs is a complex multi factor coupling problem that presents significant challenges to the accuracy and efficiency of numerical simulations zhao et al 2020 the efficient development of egs requires the complex fracture network which poses a challenge to accurate characterization of the factors involved in the fracture morphology and the mutual contact relationship between fractures cao et al 2022 li and lior 2015 the embedded discrete fracture model edfm avoids the division of unstructured meshes by embedding the fracture meshes into the structured meshes of the matrix the edfm has good application prospects in mass and heat transfer problems in the three dimensional discrete fractures with complex geometry and spatial distribution rao et al 2019a rao et al 2019b however the edfm method assumes that the matrix pressure is linearly distributed along the vertical fracture direction leading to low accuracy in early production to improve calculation accuracy shi et al 2021 proposed a modified edfm method using a boundary element method to calculate mass and heat transfer between matrix and fractures the mechanism and quantification method of matrix shrinkage caused by reservoir temperature reduction leading to fracture width and permeability changes are critical cao et al 2022 anyim and gan 2020 most characterization methods considering the change of fracture width are empirical expressions of uniaxial mechanical test results based on specific fitting parameters bandis et al 1983 evans et al 1999 jabbari et al 2017 the limitations of the aforementioned methods are that laboratory scale experiments cannot fully capture the complexity of reservoir scale and the thermal stress is often neglected additionally accurately measuring normal effective stress can be challenging wang et al 2016 wang et al 2016 found that cold water injection can increase fracture permeability by up to 700 by a semi analytical formula however the model does not account for thermal convection in order to simplify the governing equations ghassemi et al 2008 gave the analytical solution of fracture width change caused by thermal and pore elasticity under non isothermal flow conditions they obtained the relationship between fracture width rock characteristics and temperature at different times but it does not extend to the existence of multiple fractures another method is to deal with the thermal hydrodynamic mechanical thm multi field coupling to calculate the change in fracture conductivity in egs numerical simulation chen et al 2019 wang et al 2020 zhao et al 2020 hicks et al 1996 established a thm coupling model under regular fracture networks and considered that the output temperature would be overestimated without considering the mechanical effect ghassemi and zhou 2011 based the finite element method to study the flow heat transfer and fracture width changes of cold working fluid injected into artificial thermal storage they believe that the pore elasticity effect is evident at the initial stage of the change of injection pressure and fracture width after long term injection the thermoelasticity effect became the leading role yu et al 2019 coupled the tough2 csm parallel edfm framework with the geomechanical model to study the effects of geomechanical factors sun et al 2017 established a 2d geothermal model based on comsol multiphysics software and showed the importance of considering the thm coupling effect yao et al 2018 also simulated the three dimensional egs multi field coupling process and analyzed the utilization efficiency and production performance of egs liao et al 2020 studied a three dimensional anisotropic geothermal reservoir with tough2mp flac3d and the damage permeability model considering the increased fracture permeability extended finite element method xfem edfm can accurately consider the effects of geological mechanics factors on each fracture by combining the advantages of the structured grid of edfm li et al 2021 however due to the computational efficiency it is difficult to be apply to the simulation of complex fracture networks ren et al 2016 zeng et al 2019 to sum up there are few reports on the efficient fracture width model considering thermal stress for the three dimensional edfm method although there have been many numerical simulation studies on the multi field coupling of egs there are still deficiencies in the computational efficiency of the model the main problem is that the unstructured grid in dfm is challenging to meshing when dealing with complex fractures resulting in poor computational convergence the existing edfm method is not capable of efficiently solving the thm coupling problem when considering thermal stress accurate and rapid egs thermal extraction process simulation using a large scale three dimensional fracture network is still challenging zhao et al 2020 this paper proposes a three dimensional complex fracture model considering fracture width variation with thermal stress based on the edfm method it can better adapt to the three dimensional fracture width change of various fracture forms the validity of method proposed is verified by comparing the calculation results with comsol multiphysics software and field data moreover the method is applied to analyze the sensitivity of reservoir parameters and optimize the injection and production parameters which demonstrates its effectiveness in practical engineering applications 2 methodology 2 1 mathematical model the research is realized by matlab version 2020b programming in this study the following assumptions are made to simplify the practical problems in water egs reasonably 1 darcy s law is satisfied for fluid flow in matrix and fracture 2 the single phase water flow is assumed in this work and the phase changes are not considered in this study 3 the heat exchange between water and rock only considers the processes of heat conduction and heat convection and it assumes local thermal equilibrium 4 heat loss in the vertical wellbore is not considered and the rock is linearly elastic 5 the effect of the wellbore on the fluid temperature is negligible 6 since this paper mainly considers shear type fractures the presence of proppants is not considered 1 mass conservation equations the edfm method divides the matrix and fracture into two systems with independent properties the three dimensional mass conservation equations of the matrix and fracture considering the effects of gravity are shown in eqs 1 and 2 1 ω t ρ w ϕ b w d ω ω ρ w k μ w b w p w ρ w g d d ω m ρ w q w mf ρ w q w mw 2 ω t ρ w ϕ b w d ω ω ρ w k μ w b w p w ρ w g d d ω f ρ w q w fm ρ w q w fw the viscosity and density of water depending on the temperature especially for high temperature and high pressure conditions the empirical relational equations proposed by rabinowicz et al 1998 can be expressed as follows 3 μ w 2 414 10 2 10 247 8 t 133 15 4 ρ w 838 4661 1 4005 t 273 15 0 0030 t 273 15 2 3 7182 10 7 t 273 15 3 the following gives the discrete form of eq 2 based on the finite volume method 5 j 1 n ρ w i j t i ij p w j p w i ρ w j g d j ρ w i g d i t δ t ρ w q w mf ρ w q w mw t δ t δ v i δ t ρ w ϕ b w i t δ t ρ w ϕ b w i t where 6 ρ w i j ρ w i ρ w j 2 7 t i ij g ij μ w i μ w j 2 b w i b w j 2 table 1 lists the calculation formulas of geometric coefficients under different grid connection types the mass transfer calculaion between matrix and fracture based the boundary element method eq 8 can improves the calculation accuracy shi et al 2021 cao et al 2019 8 ρ α q α n f 1 mf ρ α kh μ a b a gf n f 4 g 4 4 1 g fm 4 n f g ff n f n f 1 gf n n f 4 gf n f 4 g 4 4 1 g n 4 4 g conv 4 5 p a 5 1 m p a n f 1 f where g ff gf g g fm g n can be found in appendix a the source and sink terms related to well can be expressed as 9 ρ w q w mw ρ w k m μ w b w 2 π h ln r e r w p w m p w w 10 ρ w q w fw ρ w k f μ w b w 2 π w f cos θ ln r e r w p w f p w w where r e is solved by peaceman formulation peaceman and d w 1978 2 energy conservation equations the local thermal equilibrium assumption is used to simulate the heat exchange between rock and fluid the equation of conservation of energy in matrix and fracture is described 11 ω ρ c c pc t t ρ w c pw k μ u b w p ρ w g d t λ c t d ω m q c mf q h mf q h mw 12 ω ρ c c pc t t ρ w c pw k μ u b w p ρ w g d t λ c t d ω f q c fm q h fm q h fw 13 ρ c c pc ϕ ρ w c pw 1 ϕ ρ r c pr 14 λ c ϕ λ w 1 ϕ λ r the matrix fracture heat coupling is divided into conduction q c mf and convection q h mf and q h mw in the high pressure and high temperature environment of underground storage the thermal conductivity and specific heat capacity of the fluid are no longer constant which will dramatically change the mass and energy transfer process of the fluid for the variation of heat capacity and thermal conductivity of water with temperature from 273 k to 553 k the following equation is used for this study zhang et al 2019 15 λ w 0 8691 0 0089 t 273 15 1 5837 10 5 t 273 15 2 7 9754 10 9 t 273 15 3 16 c pw 12010 1471 80 4073 t 273 15 0 3099 t 273 15 2 5 3819 10 4 t 273 15 3 3 6254 10 7 t 273 15 4 the finite volume discrete form of the above equation is given 17 j 1 n t i ij h t j t i t δ t j 1 n t i ij t ij p w j p w i ρ w j g d j ρ w i g d i ρ w i c pw i t δ t q c mf q h mf q h mw t δ t δ v i δ t ρ c c pc t i t δ t ρ c c pc t i t similarly the expression of the energy conduction coefficient t i ij h of adjacent grids were given in table 1 the heat source between matrix and fracture can be expressed as 18 q h fm c pv ρ w q w t fm 19 q c n f 1 mf λ a h g ff n f n f gf n f 4 g 4 4 1 g fm 4 n f 1 gf n n f 4 gf n f 4 g 4 4 1 g n 4 4 g conv 4 5 t 5 1 t f n f 1 eq 19 is derived by the boundary element method shi et al 2021 the fully implicit coupling solution is considered here that is solving the entire nonlinear equations simultaneously in a newton raphson iteration 2 2 the fracture width change model with thermal stress fig 1 illustrates the schematic diagram of the equivalent change in fracture width in the edfm when the pressure difference between matrix and fracture is assumed to be constant during each time step the matrix displacement equation is simplified to 20 u x 2 x 2 1 v 1 v β t t m 0 x the displacement boundary condition is imposed on the center of the fracture grid eslami et al 2013 21 u x x 0 t 0 in the outer boundary of the whole region the normal displacement is assumed as zero then the general solution of the above equations can be obtained 22 u x 1 v 1 v β 0 x t t m 0 d x c x the change in normal stress in the matrix can be calculated based on displacement 23 δ σ xx e m 1 v 1 2 v 1 v u x x 1 v β t t m 0 meanwhile the interface between the fracture and the matrix will achieve a state of mechanical equilibrium that is 24 δ σ xx v 1 s f d f u x v 1 s f δ p f where v 1 and v 2 is a part of the volume of the matrix block by the fracture surface s f is the area of the fracture surface the integral term in eq 20 can be calculated by the following equation 25 0 x t t m 0 d x 1 3 v 1 s f t t m 0 eq 27 30 is solved simultaneously to obtain the expression of c 26 c p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 1 s f e m 1 v 1 2 v 1 v d f v 1 s f when the d f is constant the displacement at the matrix fracture interface can be expressed as 27 u v 1 s f 1 3 β 1 v 1 v t t m 0 p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 1 s f e m 1 v 1 2 v 1 v d f v 1 s f v 1 s f 28 u v 2 s f 1 3 β 1 v 1 v t t m 0 p f p f 0 1 3 β t m t m 0 2 e m 1 2 v 1 3 β d f 1 v 1 v t m t m 0 v 2 s f e m 1 v 1 2 v 1 v d f v 2 s f v 2 s f the displacement on both sides of the fracture can be calculated by eq 27 and eq 28 the equations of fracture width variation and fracture permeability are as follows 29 δ b u v 1 s f u v 2 s f 30 k fi k f i 0 b i 0 δ b i 3 b i 0 3 it is postulated that the alteration in width of the fracture element is exclusively influenced by the distortion of the corresponding two matrix grids positioned at perpendicular to the fracture direction in this way the width variation of each fracture element in the edfm method is solved fig 2 it should be noted that if the fracture unit and the matrix mesh only intersect at one point while calculating the width change the matrix block will be divided into two parts along the fracture direction such as ⑥ in fig 2 however it should be emphasized that the model presented in this paper is mainly suitable for the case of matrix non permeability or low permeability and the higher matrix permeability may cause some errors 3 results and discussion 3 1 verification of fracture width change model the opening and closing of fractures will change their permeability affecting the heat transfer efficiency therefore it is essential to accurately characterize fracture width and permeability changes in the egs process the method is validated at a grid scale based on three cases further the model with artificial fractures in the reservoir was tested the reference solution of this part is solved based on the comsol multiphysics software massachusetts and burlington 2018 the software uses the finite element method to develop a fully coupled solution considering solid deformation seepage and heat transfer and the results are accurate and reliable 3 1 1 case1 single vertical fracture the fracture unit is parallel to one edge of the matrix grid fig 3 a the initial matrix and fracture temperature are assumed as 100 c the boundary conditions around the matrix block are roller support fig 3 b is the diagram of triangular mesh division in comsol multiphysics software fig 3 c is the diagram of rectangular mesh 25 25 division in the edfm method the physical properties of water and rock are considered as constant the other physical parameters required for the simulation can be found in table 2 the simulation results show that the low temperature zone spreads from the fracture to the matrix on both sides and the right side of the fracture is first completely cooled to 20 c fig 4 a shows the matrix fracture temperature distribution results calculated by comsol multiphysics software at t 8000 s fig 4 b shows the results of the edfm method the normalized mean absolute error nmae between the calculated solution and the reference solution is characterized by eq 31 when the number of matrix grids is increased from 625 to 2500 the nmae from 2 92 decreases to 1 34 an essential point for the model proposed here is to focus on the change of fracture width fig 4 c is the displacement distribution results in the x direction by comsol multiphysics software when t 10000 s in order to more intuitively show that the displacement change at both sides of the fracture in fig 4 c is amplified by 50 times it can be seen that the increase in the fracture width is caused by cold water injection fig 4 d shows the change of the average fracture width change with time calculated by the edfm method and comsol multiphysics software it can be seen that the two results have good consistency 31 nmae i 1 n x i x i ref n max x i ref min x i ref where n is grid numbers x i is modeling results x i ref is reference results 3 1 2 case 2 single inclined fracture from fig 5 a case2 shows a certain angle not 0 or 90 with a single fracture and the edge of the matrix grid fig 5 b and fig 5 c are the grid division results of comsol multiphysics software and edfm method respectively compared with case1 the inclined fracture is more common in the edfm method except that the fracture location is different from case1 the other model parameters are the same as those of case1 table 1 after injection for 10000 s the temperature field distribution results calculated by the two methods are compared fig 6 a and fig 6 b and the corresponding nmae value is 3 15 after increasing the number of grids from 625 to 2500 the value decreases to 1 81 it shows the accuracy of temperature field calculation when calculating this kind of problem fig 6 c is the displacement field diagram in the x direction by comsol multiphysics software when t 10000 s unlike case 1 the displacement changes of the matrix on both sides of different fracture joints are not the same so it is often impractical to simplify the change value of the whole fracture width to one value reflecting the advantage of the edfm method to divide the whole fracture into multiple elements to calculate the width change fig 6 d shows that the calculated results of the model proposed here are accurate for the time varying process of inclined fracture width 3 1 3 case 3 complex cross fractures one of the advantages of the edfm method is to deal with complex fracture network systems so there are usually fractures crossing like fig 7 a fig 7 b and fig 7 c are the grid division results of comsol software and the edfm method respectively the parameters of the model are consistent with table 1 from fig 8 a and fig 8 b the temperature field distribution simulated by the two methods after injection of 6000 s showed high consistency and the calculated nmae value was 3 87 when the number of grids increased from 625 to 2500 the value decreased to 2 12 in fig 8 d and fig 8 e the calculation results of the fracture width change between comsol multiphysics and the edfm method were compared which are consistent the results show that proposed method is suitable for edfm and can ensure high calculation accuracy 3 1 4 case 4 natural fractures in order to further eliminate the effects of scale on boundary conditions a 50 m 50 m 5 m model fig 9 a is given in this example which contains three natural fractures the left boundary of the model simulates constant pressure 40 mpa injection into the cold fluid in horizontal wells and the right boundary simulates constant pressure 10 mpa recovery in horizontal wells in the simulation the matrix permeability is 0 01md the initial fracture width of fracture is 0 05 m fig 9 b and fig 9 c are the grid division results of comsol multiphysics software and the edfm method respectively the remaining parameters of the model are consistent with table 1 comparing fig 10 a with fig 10 b it can be seen that after 1200 days of implementation the two methods temperature fields still maintain good consistency the nmae is 5 29 which drops to 3 85 when the grid number of edfm is increased from 625 to 2500 fig 10 c shows the variation of the average width of three fractures with time and the calculation results of the two methods also show good consistency however compared with the previous three examples there are two reasons for the increased error one is that the permeability of the matrix is considered as mentioned earlier the model derived is mainly for the case that the matrix has no or low permeability the second is that the natural fracture model of comsol considering the thm coupling effect presents a shape with narrow sides and wide middle and the grid divided by comsol is finer overall however the model proposed has good calculation accuracy for mass transfer and heat transfer with low matrix permeability 3 1 5 field data verification desert peak geothermal field is located in the eastern edge of the great basin segment of the basin and range province 130 km northeast of reno kelkar et al 2014 the buried depth of the formation is 1610 2606 m and the average temperature is 210 c this part selects the well group as shown in the fig 11 for research the fracture permeability and porosity are obtained by inverting the temperature of the early production wells other data can be found in the reference chabora et al 2012 hickman and davatzes 2010 and the specific parameters are shown in the table through simulation it is found that if the change of fracture width is not considered the injection rate of the injection well will slowly decrease due to energy depletion after considering the change of fracture width caused by thermal stress the width of the fracture gradually increases which is reflected in the gradual increase of the injection rate to remain stable the simulation results are in good agreement with the field data which shows the accuracy and reliability of the numerical simulation method in this paper see fig 12 3 2 single fracture conceptual case this section provides two cases for analyzing the applicability of the method and the sensitivities of the key mechanisms and key parameters of egs the first case is a single fracture conceptual model while the egs system is often composed of complex fracture networks the single fracture model can more accurately and fully reflect the change of heat transfer mechanism and fracture width therefore this study mainly concerns the mass and heat transfer mechanism in the egs system through the single fracture model shown in fig 13 a model of 100 m 100 m 10 m was established in the middle of the reservoir there is a rectangular fracture cold water is injected at 35 mpa on one side of the fracture and produced at 25 mpa on the other side the parameters are in table 4 3 2 1 process and mechanism analysis the injected low temperature water flows along the fracture to the production well under pressure difference from the simulation results fig 14 the pressure system of the whole model is gradually stable with time the low temperature zone continues to expand and close to the production well due to the high flow rate in the fracture and the strong thermal convection next the mass and heat transfer mechanisms related to this process are analyzed the critical analysis indicators are production temperature and total heat energy produced eq 38 the unit of heat energy is usually j however mw h or kw h was used as the unit considering that the energy produced by deep geothermal energy is mainly used for power generation the temperature of production wells is one of the critical factors affecting the production efficiency of the egs system and it is an essential indicator for evaluating the production performance and lifetime of the egs in general geothermal energy is renewable energy when the average heat storage temperature decreases to a certain extent or the production temperature decreases to a certain proportion the egs will stop running baria et al 1999 tester et al 2006 the total heat energy produced can be used for power generation or heating determining the system s heat production capacity and economic benefits yu et al 2021 38 q u 0 t ρ q c p f t out t in d t one of the main characteristics of this model is to consider that the fluid s flow and heat transfer properties are a function of temperature rather than a constant value because the egs system is often buried deep the temperature difference between the injected fluid and the reservoir temperature is large thus ignoring the change of fluid physical properties with temperature is unrealistic this will be demonstrated here and the effects of fluid parameters changing with temperature on the egs production index is quantified the parameter value is a constant value under the initial reservoir temperature or a function of temperature in order to be more intuitive the temperature field distribution diagram is displayed in a two dimensional view of the actual three dimensional model as fig 15 a and fig 15 b shows the swept area of the low temperature region is smaller when considering the temperature effect of fluid properties because the decrease in temperature leads to a deterioration of fluid flow and weakens the effects of thermal convection comparing the production temperature and heat energy produced in these two cases fig 15 d and fig 15 e the thermal breakthrough rate considering the temperature effect of fluid properties is slower due to poor fluidity caused by the temperature decrease ignoring the temperature effect of fluid properties underestimates the system s production temperature and lifetime and overestimates the heat energy produced with differences of 32 54 and 43 95 respectively after 1000 days fracture is the primary energy transfer channel and plays a vital role in heat extraction the general reservoir modeling often ignores the effects of temperature change on fractures however it is necessary to correctly understand the role of thermal stress caused by temperature change comparing the temperature field diagram of fig 15 b and fig 15 c it can be seen that if the change of fracture width is not considered the thermal breakthrough speed will slow down by comparing fig 15 d and fig 15 e if the change effect of fracture width is ignored the production temperature will be overestimated and the heat energy produced will be overestimated the degree after 1000 days was 11 75 and 27 06 respectively the fracture width and permeability change in the process were analyzed fig 16 a it can be seen that the width and permeability of fractures gradually increase with time and the amplitude of early change is large and the speed of late change gradually slows down the reason is that the temperature field in fracture gradually tends to be stable with the advancement of the low temperature zone after 1000 days the average width of the fracture increases from 5 mm to 6 36 mm the fracture morphology is shown in fig 16 b and the average permeability is also 2 12 times that of the original it explains the phenomenon that the fluid flow change and the thermal breakthrough accelerates after the cold water injection it reflects that it is necessary to consider the change in fracture width caused by thermal stress during the simulation of the egs 3 2 2 geologic parameters sensitivity analysis 1 fracture shape in the actual egs reservoir fractures often have various shapes and distribution patterns in this section the distribution forms of four single fractures are extracted and analyzed as shown in fig 17 a mode a is a horizontal transverse fracture and the initial size is 10 m 100 m 0 005 m mode b is an inclined fracture with a horizontal angle of 45 and the initial size is 14 41 m 100 m 0 005 m mode c is a vertical rectangular fracture and the initial size is 10 m 100 m 0 005 m mode d is a vertical longitudinal elliptical fracture and the initial size is 10 m short axis 100 m long axis 0 005 m it can be seen from fig 17 b that the shape and distribution of fractures significantly effects temperature transfer which also shows that this model has good applicability for the mass transfer and heat transfer problems of arbitrary three dimensional fractures this has not been discussed in most previous studies fig 18 a and fig 18 b compare the production temperature and heat energy produced it can be seen that the heat transfer area and inclination angle of the fracture are essential factors affecting the mass and heat transfer in the reservoir the larger the heat exchange area the faster the temperature of the production decreases and the higher the amount of heat energy produced compared with the elliptical fracture the rectangular fracture has faster thermal breakthrough speed and more heat energy produced therefore it is necessary to accurately characterize the shape and distribution of fractures in the three dimensional model 2 thermal diffusion coefficient of rock the thermal diffusion coefficient is a measure of the rate at which the temperature perturbation at one point passes to another in an object usually defined as the following 32 α λ c ρ the rock density rock thermal conductivity rock specific heat capacity and rock thermal expansion coefficient are usually heterogeneous here we analyze the effect of different thermal diffusion coefficients 1 60 10 6 m2 s 1 1 10 6 m2 s 1 and 5 10 7 m2 s 1 fig 19 a fig 19 b and fig 19 c show the temperature fields after 1000 days of injection with different thermal diffusion coefficients more significant thermal diffusion coefficients result in improved areas affected by low temperatures fig 19 d and fig 19 e show that the increase in the thermal diffusion coefficient of rocks slows down the thermal breakthrough speed and increases the heat energy produced the results indicate that reservoirs with large thermal rock conductivity small rock density and small rock heat capacity are conducive to the heat recovery of the egs 3 thermal expansion coefficient the thermal expansion coefficient reflects the ability of thermal expansion and contraction of the object the effects of different thermal expansion coefficients 4 10 6 c 1 8 10 6 c 1 1 6 10 5 c 1 on the change of fracture width is analyzed it can be seen from fig 20 a and fig 20 b that larger thermal diffusion coefficients result in an improved change in fracture width and corresponding permeability accordingly the thermal breakthrough speed and heat energy produced will also be larger fig 20 c and fig 20 d 3 3 multi layer water egs case the second case is an actual multi fracture three dimensional egs system this case is a model that combines actual reservoir parameters in this paper in fact the region has not entered the actual dry hot rock development stage but through the previous geological survey it is believed that the block junggar basin china does have the potential of egs as shown in fig 21 a the effective fracturing area on the horizontal plane after hydraulic fracturing is 500 m 300 m divided into three layers vertically and the cumulative thickness is 150 m the distribution of a complex fracture network can be seen more clearly in fig 21 b the initial permeability of fractures is 15000md it should be noted that some fractures do not entirely run through the three layers vertically and there are some inclined fractures the geothermal gradient of the reservoir is considered to be 4 c 100 m fig 21 c after the preliminary investigation it is considered that this area has the potential for the development of hdr other parameters of the model can be found in table 5 3 3 1 simulation result analysis the change of temperature field is the first object to be concerned in egs fig 22 shows the low temperature zone spreads from the injection well to the production well as time goes on fig 23 shows the temperature distribution of each layer after 40 years of system operation the effects of fracture distribution on the temperature field morphology can be seen the change in fracture width and permeability during the operation of the egs was analyzed fig 24 a shows the change in average fracture permeability with time it is seen that the average fracture width after 40 years changed from 0 008 m to 0 0136 m and the average fracture permeability increased from 15000md to about 80000md which expanded by 4 33 times the results reflect the importance of considering the change in fracture width fig 24 b shows the simulation results of the system for 40 years it is seen that the early thermal breakthrough speed was slow and the thermal breakthrough speed became faster after about ten years meanwhile heat production increases almost linearly over time however it is almost impossible in the field to allow the reservoir temperature to decline too fast therefore the corresponding injection production parameters must be optimized 3 3 2 injection production system sensitivity analysis the stable operation of the egs requires that the temperature drop of the production well should be as small as possible throughout the design cycle to maximize the efficiency of the ground power generation equipment it is necessary to slow down thermal breakthrough time and prolong the system s lifetime the physical parameters are fixed for a specific reservoir here three parameters are analyzed injection production pressure difference injection temperature and well pattern as a renewable energy geothermal energy needs to consider sustainable exploitation therefore it is necessary to define the mining life to extract heat from the heat source for as long as possible in this study the system will stop running when the production temperature decreases by 10 in the original state wong et al 2018 the final heat energy produced can be obtained at this time in this case the produced temperature reaching 160 c is selected as the critical temperature for the system to stop operation 1 injection production pressure difference the effects of the injection production pressure difference were first studied in this research six different injection production pressure differences 8 mpa 10 mpa 12 mpa 14 mpa 16 mpa and 18 mpa were investigated with the injection temperature set to 40 c it was observed from fig 25 a and fig 25 b that a small injection production pressure difference slowed down the speed of thermal breakthrough increased the lifetime of the system and increased the final heat energy produced however it also resulted in a slower rate of thermal energy recovery as shown in fig 25 c a decrease in the injection production pressure difference resulted in an increase in the operational life while the average annual heat energy produced and energy output per unit time decreased therefore the determination of the injection production pressure difference should consider both the heat recovery rate and the final heat recovery a 10 mpa injection production pressure difference can ensure a high final heat energy produced while maintaining a high recovery rate as a lower injection production pressure difference of 8 mpa resulted in a slow heat production rate 2 injection temperature the previous analysis has shown that the lower the temperature is the worse the fluid flow is thus limiting the thermal breakthrough speed however the larger temperature difference with the original reservoir temperature will also lead to a more significant variation of the fracture width thereby is beneficial to the fluid flow and accelerates the speed of thermal breakthrough the injection temperatures are 20 c 30 c 40 c 50 c and 60 c the injection production pressure difference is 10 mpa it is seen from fig 26 a that the low injection temperature does not lead to a faster thermal breakthrough speed but has a longer lifetime the results indicate that the mechanism of low temperature on the fluid flow properties plays a leading role it is seen from fig 26 b that low injection temperature produces higher heat energy but the heat produced rate at 20 c is lower than that at 30 c however when the injection temperature is 40 c 50 c 60 c there is little difference in the rate of heat energy production the injection of the high temperature fluid itself will increase heating costs so the optimal injection temperature is 20 c 3 well patterns three distinct well configuration plans depicted in fig 27 are put into practice based on the fracture distribution of the model these schemes comprise of a single injection well with one production well a single injection well with two production wells and a single injection well with three production wells to ascertain the service life of the system the mean production temperature from multiple wells is capped at 160 c while the injection temperature is set at 20 c and the injection production pressure differential is sustained at 10 mpa fig 28 a 28 b and 28 c depict the temperature distribution after 60 years for three different well configurations the extent of the low temperature zone does not differ significantly among the cases as observed from the figures however the third case has a longer lifetime and generates more heat energy in the end the spread of the low temperature zone can be expanded by wells wp1 and wp3 and the thermal breakthrough at wp2 is slowed down although the third case has better production results when considering the cost of well construction and the slight difference in early and middle stages of production fig 28 e the optimal well pattern is still one injection well and one production well 4 conclusions the mechanism of mass and heat transfer in complex fractures with arbitrary geometry is embedded in the edfm framework in this work to accurately characterize the complex fracture morphology a three dimensional model and numerical method were established based on the edfm method which is capable of describing widely and accurately the mass and heat transfer process in the enhanced geothermal system the accuracy of the proposed model and method is verified by comparing the results with the comsol multiphysics software and field data furthermore a single fracture conceptual model is used to analyze the process of mass and heat transfer finally the method is applied to an actual egs system and the injection production pressure difference injection temperature and well pattern were optimized the main conclusions are as follows 1 the proposed model can describe the complex mass and heat transfer process between fractures of arbitrary distribution and morphology and matrix in three dimensional reservoirs the change of fluid properties with temperature and the change of fracture width caused by thermal stress is considered 2 ignoring the temperature effect of fluid properties underestimates the production temperature and lifetime of the system while overestimating the produced energy of the system ignoring the effect of fracture width variation overestimates the production temperature and lifetime of the system while underestimates the produced energy 3 the heat transfer area and dip angle of fractures are essential factors affecting the mass and heat transfer in the formation 4 the larger the thermal diffusion coefficient of rock is the better the performance of the egs is increasing the thermal expansion coefficient of rock increases the width and permeability of fractures and the corresponding thermal breakthrough speed and heat energy produced increase 5 in the case of egs it is found that small injection production pressure difference and low injection temperature are beneficial to extend the system lifetime and improve the final energy produced in the model of this paper the influence of the chemical effect caused by the water rock reaction was ignored we did not consider the multiphase flow problem caused by higher temperature in egs reservoirs which is our further work credit authorship contribution statement renyi cao conceptualization writing review editing junjie shi methodology writing original draft software zhihao jia writing review editing chong cao investigation linsong cheng project administration supervision gaoling liu visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would further like to thank the financial support of the national natural science foundation of china nos 51774297 52174038 u1762210 we also acknowledge that this study was partially funded by the china petroleum technology project no zlzx2020 02 04 appendix a expression represented by the main symbol a1 g c m 1 1 c m 1 2 c m 1 3 c m 1 4 c m 2 1 c m 2 2 c m 2 3 c m 2 4 c m 3 1 c m 3 2 c m 3 3 c m 3 4 c m 4 1 c m 4 2 c m 4 3 c m 4 4 c mi j s jj g h x mi y mi x y d s x y a2 g n d c m 1 1 d c m 1 2 d c m 1 3 d c m 1 4 d c m 2 1 d c m 2 2 d c m 2 3 d c m 2 4 d c m 3 1 d c m 3 2 d c m 3 3 d c m 3 4 d c m 4 1 d c m 4 2 d c m 4 3 d c m 4 4 d c mi j s bj g h x mi y mi x y n d s x y λ x mi y mi i j s bj g h x mi y mi x y n d s x y i j a3 g fm c f m 1 1 c f m 1 2 c f m 1 n f c f m 2 1 c f m 2 2 c f m 2 n f c f m 4 1 c f m 4 2 c f m 4 n f c fmi j s f g h x mi y mi x y d s x y a4 gf c m f 1 1 c m f 1 2 c m f 1 4 c m f 2 1 c m f 2 2 c m f 2 4 c mf n f 1 c mf n f 2 c mf n f 4 c mfi j s bj g h x fi y fi x y d s x y a5 gf n d c m f 1 1 d c m f 1 2 d c m f 1 4 d c m f 2 1 d c m f 2 2 d c m f 2 4 d c mfnf 1 d c mfnf 2 d c mfnf 4 d c mfi j s bj g h x fi y fi x y n d s x y a6 g ff c f f 1 1 c f f 1 2 c f f 1 n f c f f 2 1 c f f 2 2 c f f 2 n f c ffnf 1 c ff n f 2 c ff n f n f c ffi j s fj g h x fi y fi x y d s x y where s b represents the boundary of a local grid s f represents the fracture boundary of the local grid x mi y mi represents the midpoint of the matrix grid boundary x fi y fi represents the center of the fracture unit 
1706,plant roots potentially contribute to slope instability by causing infiltrating water to be spatially and temporally redistributed in the soil unevenly following rainfall but the root system s macro scale impact on water infiltration and the formation and dynamics of pore scale preferential flow induced by roots are still ambiguous a field dye infiltration experiment was used to simulate rainwater infiltrating into the soil to quantify the relationship between preferential flow pathways and root characteristics such as root density and root number a two dimensional phase field model was used to describe quantificationally and visually the influence of fluid pressure difference wall contact angle and pore throat size on vapor liquid interface movement in the root particle and interparticle pores water flows more freely along an extension direction of shallow coarse root diameter 5 mm facilitating water transfer between adjacent profiles the dye coverage and preferential flow fraction are found to be significantly positively correlated with the fine root diameter 5 mm density and the coarse root quantity at the pore scale a low difference of fluid pressure exerts more control from the root system over preferential flow especially the vapor liquid interface in the root particle pore lowers to the pore outlet about 50 faster than the inter particle pore for no pressure difference the larger wall contact angle of the particle causes a more pronounced lowering rate of the vapor liquid interface with smaller pores the flow rate accelerates smaller pores make it harder for water to flow from the interparticle pores than root particle pores our findings can help to more accurately determine the depth of water infiltration in the slope and deeply understand the physical mechanism of the effect of the root system on rainwater redistribution keywords root soil water system preferential flow root density dye tracer phase field method data availability data will be made available on request 1 introduction shallow landslides caused by rainfall usually occur in mountainous areas such as southern china and parts of south central and south western china after intensive or prolonged rainy seasons chen and lee 2003 numerous investigations have demonstrated that plant covered slopes differ mechanically and hydrologically from bare slopes and hydrological processes have a more significant impact on vegetation slope stability wu et al 1979 the roots as a key component linking the plant to the soil have a profound impact on hydrological processes in forested environments in addition to the soil structure sidle and bogaard 2016 the primary root systems can extend deep into the soil or bedrock where they can transport water and create a dangerous sliding surface due to an increase in pore water pressure balzano et al 2019 mulyono et al 2018 besides the interface between a soil slope s root rich and rootless zones is another possible location for the development of a sliding surface baker et al 2021 liu et al 2016a plant roots usually have a significant impact on water infiltration due to the inhomogeneity of pore space caused by root vital activities and root system interactions bodner et al 2014 weiler and naef 2003 wu et al 2022 roots generally improve soil permeability by wedging into weathered rocks and soils or decaying to form channels which increases infiltration rates and fluxes during rainfall infiltration cui et al 2022 freer 1991 luo et al 2019 on the other hand roots can reduce soil permeability a process that is most prevalent in the earliest stages of root growth and under conditions of high soil porosity markart et al 2011 singh et al 2018 previous statistical results indicated that the percentage change in soil saturation infiltration rate caused by tree and shrub roots ranged from 140 to 109 and that the corresponding value for herbaceous roots ranged from 90 to 650 lu et al 2020 therefore broad statements about the effect of plant roots on permeability are inappropriate because it depends greatly on soil and root type one of the main reasons roots promote water infiltration is the preferential flow formed by the root system levia and frost 2003 schwärzel et al 2012 preferential flow in contrast to matrix flow always describes the irregular and frequently rapid movement of water and solutes around the soil matrix via the macro pores network allaire et al 2009 hendrickx and flury 2001 pore continuity booltink and bouma 1991 and pore density smettem 1986 are all factors that affect preferential flow while the distinctive structural features of the root system and the interactions between roots lead to the formation of pore channels with widespread distribution stability and continuity and are therefore particularly important in preferential flow study therefore water may preferentially move through soil profiles that have a lot of roots luo et al 2019 many roots make a network of channels that facilitate rapid lateral water movement through the soil levia and frost 2003 schwärzel et al 2012 devitt and smith 2002 found that macro pore channels created by shrub roots in dry areas improved water flow downwards in desert soils and the more roots there are the stronger the preferential flow similarly song et al 2017 found that the formation of preferential flow routes by vetiver grasses with main root systems may have improved unsaturated infiltration rates the influence of root systems on preferential flow is significantly related to the root diameter d r and its arrangement there is some evidence that fine d r 5 mm and coarse roots d r 5 mm all aid water movement but their mechanisms of action are distinct bodner et al 2014 together with surface microorganisms fine roots release polysaccharides and other chemicals that aggregate clay particles that contribute to enhancing the stability of soil aggregates which increases the soil s permeability and infiltration rate paterson et al 2007 tisdall and oades 2006 erktan et al 2015 vannoppen et al 2015 many fine roots can grow close together and even tangle with one another to form a complex root network that promotes water flow löbmann et al 2020 while the coarse roots may be more efficient at transporting water between soil layers because of their longer length compared to fine roots martinez et al 2021 furthermore some root shrinks during growth to create a circular gap that makes it easier for water to flow ghestem et al 2011 to date the phenomenon of preferential flow induced by root systems has been observed frequently and the relative macro contributing factors and the mechanism of triggering landslides have been elucidated however the physical process of pore scale root induced preferential flow is not clear which limits us to the understanding of the action mechanism of macro factors on preferential flow insight into hydrological processes under the control of plant roots can be gained by analyzing the root soil moisture distribution both spatially and temporally dye tracing is the most widely used technique for visualizing water flow because it allows observation of the water flow route without disturbing the soil analyzing the image after dyeing provides a semi quantitative assessment of the flow state flury and flühler 1995 dyed areas have traditionally been evaluated quantitatively using parameters like preferential flow fraction pr fr and length index bargues tobella et al 2014 van schaik 2009 we use the dye tracing method to visualize the preferential flow pattern of soil analyze the dyeing ratio of roots regional root density and dyeing parameters to conclude the relationship between root characteristics and preferential flow and thus gain a better understanding of the temporal and spatial distribution of water in the root soil system root induced preferential flow is a process involving the transport of vapor liquid interface along the solid pore walls and is related closely to the multiphase flow motion process our in depth analysis of root induced preferential flow is limited by the dye experiment s ability to only produce the results of the final spatial distribution and not to track the progress of the fluid movement in the pore space over time as a result we simulate the multiphase flow transport mechanism within the pore medium and the pore space between the roots and soil using the phase field method the phase field method can more naturally follow the evolution of a complicated free surface and it is more accurate in terms of pressure gradients and velocity profiles than other interface trackings methods like the level set method and the volume of fluid method xiao et al 2019 to better understand the mechanism of macroscopic root action on preferential flow at the microscopic level we use the phase field method to obtain the interfacial variation patterns of water air two phase flow under different simplified models pore throat sizes and inlet pressure conditions thus explaining the observed phenomena in the field in this study we chose a typical distribution of coniferous forests in the hilly region of southwest china as the study area to quantitatively describe the influence of the root system on preferential flow we conducted an experiment using the brilliant blue fcf tracer to investigate the characteristics of root soil water flow affected by the root system the results of numerical simulations are further combined with the results of the field scale to explain why the root system promotes preferential flow finally the mechanism of the root induced preferential flow is explained together at the pore scale and the field scale 2 materials and method 2 1 field experiment 2 1 1 experimental site a field experiment was performed in the longchi national forest park 31 8 10 w 103 34 32 e located northwest of chengdu in sichuan province china the climate in the study area is humid subtropical monsoon with four distinct seasons zhang et al 2021 the average annual temperature is 15 2 and the average annual rainfall is roughly 1300 1450 mm jiang et al 2022 rainfall occurs frequently and heavily during summer with 70 of it falling between june and september the bedrock in the study area mainly consists of granite amphibolite and triassic rocks with a general thickness of 50 130 cm of soil over bedrock and a humic layer thickness of about 1 1 3 cm mehtab et al 2020 stokes et al 2007 coniferous and broad leaved mixed forest is the main vegetation type in the longxi river basin no precipitation fell during our experiment in june we choose a well developed root system and gently sloping site surrounded by four firs with an average height of 20 m three ring knives were used to measure the dry density and natural moisture content at different depths in the ranges of 0 20 cm 2 0 40 cm and 4 0 60 cm the physical parameters of the soils are shown in table 1 the soil is found to be sandy loam in the depth range of 0 60 cm indicating a large sand content at the sample site usda nrcs 1997 the dry density in the range of 0 20 cm soil layer is the largest and the initial moisture content of the soil is also the largest reaching 36 86 2 1 2 dye experiment a square steel frame 120 cm 120 cm was vertically pushed into the soil at a depth of 10 cm and the steel wall s 10 cm high aboveground section served as a barrier to prevent the dye tracers from escaping the frame fig 1 the ground was compacted both on the inside and the outside of the steel wall near the edge and fresh litter was removed from within the frame without damaging the humus layer on the surface we picked brilliant blue fcf for this experiment due to its great visibility and low toxicity and set the dye solution concentration to 4 g l flury and flühler 1995 the 87 l of dye solution equal to 6 cm rainfall was sprayed uniformly to avoid rain and evaporation the whole frame was then covered with a piece of canvas after 24 h the canvas and steel frame were gently removed after that the profiles were dug to a depth of 60 cm depending on the depth of soil dyeing and the position of bedrock to avoid boundary effect we collected the soil profiles starting at 10 cm from one steel frame s edge with a lateral increment of 10 cm in the horizon d y and width d x direction and eventually produced a sample plot of 100 cm 100 cm then each vertical portion was trimmed with a soil cutter after excavation following that a vertical plane of d x 100 cm and d z 60 cm was shot and geometric distortion was adjusted using the ruler s edge points because the tracer experiment lasted 24 h root absorption also had an impact on water redistribution in the soil wang et al 2015 according to the data in the famine early warning systems network land data assimilation system none of the daily average transpiration during the experiment surpassed 3 mm which was considerably less than infiltration amy mcnally nasa gsfc hsl 2018 so we ignored the influence of transpiration here 2 1 3 image analysis perform geometric correction on the obtained dyed image to distinguish more precisely between dyed and undyed areas of the soil profile we used the trainable weka segmentation module of the software image j to classify the soil within the obtained photographs lormand et al 2018 the same post training categorization rules were then applied to all profile photographs the obtained image was binarized and the dye region was represented by black to characterize the dye path in the soil vertical profile dye coverage dc and pr fr introduced by van schaik 2009 and bargues tobella et al 2014 were used dc is the proportion of the dyed area to the sum of the dyed and undyed areas 1 dc d d n d 100 where d cm 2 and nd cm 2 are the dyed area and the undyed area respectively the dc is calculated according to the percentage of black pixels in each horizontal line in the binary images for each vertical profile pr fr is the fraction of the total infiltration that flows along preferential flow pathways 2 p r f r 1 unifr w tsa 100 where unifr is the uniform infiltration depth cm that is defined as the depth at which the dc decreases below 80 w is the width of the vertical profile 100 cm and tsa is the total dyed area cm 2 2 1 4 root sample collection and quantification the brilliant blue dyes the root surface after the dye tracer runs through the root channel therefore it is reasonable to conclude that root dyeing is caused mostly by the preferential flow path a total of ten soil blocks 100 cm 10 cm 60 cm between two vertical profiles d y 10 cm was brought back intact in cling bags all roots picked from the soil and brought back to the lab were examined under natural light to determine whether they had been dyed or left undyed luo et al 2018 in contrast to undyed roots most dyed roots have 80 90 or more of their total root surface area dyed then using a vernier caliper we measured all of the collected roots and divided them into six groups with dyed and undyed roots based on their diameters soak the roots in water to remove attached soil particles without destroying their structure then the root was put in an oven at 65 zhang et al 2012 after 24 h the root was taken out and weighed which was the dry weight of the roots w d root area density rad and root mass density rmd are used to quantify the root density of different soil layers mehtab et al 2020 zhang et al 2012 rad is defined as the ratio of the total cross sectional area s r of plant roots to the total cross sectional area s s of the soil 3 rad s r s s 100 also rmd is the dry weight w d of roots per unit volume of soil v s 4 rmd w d v s 100 we utilized the measurement tool of software image j to get the root coordinates and d r of each piece only live roots were considered in the statistics finally we obtained the root distribution and each layer s rad of 11 profiles the total rad at different locations required for the calculation is the sum of the rad extracted within the area of the region 2 2 numerical analysis the phase field method is used to track the interface of a two phase flow bai et al 2017 a cahn hilliard equation cahn and hilliard 1958 governs the dynamics of a two phase flow the diffuse interface is defined as the region where the dimensionless phase field variable ϕ goes from 1 to 1 the cahn hilliard equation is expressed as follows 5 ϕ t u ϕ γ λ ε 2 ψ 6 ψ ε 2 ϕ ϕ 2 1 ϕ ε 2 λ f ext ϕ where u is the fluid velocity field t is time γ is the mobility parameter ψ is an auxiliary variable qin and bhadeshia 2013 λ is the mixing energy density and ε is a control parameter for the interface thickness that scales with a thickness of the interface qian et al 2005 we set ε h c 2 where h c is the characteristic mesh size in the region passed by the interface the parameters λ and ε are related to interfacial tension σ f ext is an external force due to the free energy and f ext 0 in this work we define air as fluid 1 ϕ 1 and water as fluid 2 ϕ 1 while it changes in 1 1 at the air water mixing zone the volume fraction of both is expressed as follows 7 v f 1 1 ϕ 2 8 v f 2 1 ϕ 2 the multi physics coupling feature defines the density ρ and the viscosity μ of the mixture to vary smoothly over the interface by letting 9 ρ ρ w ρ air ρ w v f 2 10 μ μ w μ air μ w v f 2 where the water and air properties are denoted w and air respectively the mass and momentum transfer of the fluid is modeled based on the navier stokes equation for incompressible fluids jacqmin 1999 also the effect of surface tension is considered in the model thus the n s equation is expressed as 11 ρ u t ρ u u p i μ u u t f st ρ g 12 u 0 where p denotes the pressure i is the unit tensor and g is the gravity vector f st is the surface tension force acting at the air water interface 13 f st g ϕ where ϕ is the phase field parameter g is the chemical potential 14 g λ 2 ϕ ϕ ϕ 2 1 ε 2 scanlan 2009 assumed that the geometry of roots within pore space can be represented by concentric cylinders to study root induced changes to soil hydraulic properties however the pores between particles and roots are undulated lei et al 2021 they control the flow of water directing it to go through pores in whichever direction has the lowest capillary pressure threshold lu et al 2019 therefore as shown in fig 2 b we used a simplified model of the root soil system in which the root is represented by cylinders and the soil particles by balls in this simulation the pores can be simplified to the root to particle rp model fig 2 a and the particle to particle pp model fig 2 c in the two dimensional 2d cross section of the root soil system in this simulation we assume that water and air are incompressible and the gravity direction is set to coincide with the water flow direction to simulate the vertical infiltration process both inlet and outlet are pressure boundaries the density and viscosity of air and water are the standard values at 24 table 2 as we consider the comparison of different situations higher mobility is used in this study to obtain the correct pressure change at the interface other parameter values are shown in table 2 the particle radius is set to 0 1 mm because the size of the particle with high content is 0 02 2 mm in the experimental sample site table 1 the contact angle measures the ability of a liquid to wet a solid surface jang et al 2016 therefore the contact angle must take into account the difference between the root wall and the particle wall the corresponding contact angles of 87 for subgrade soil and 58 for silica sand are obtained based on the curve of contact angle versus particle size obtained experimentally by liu et al 2016b in the pp model the contact angle of the particle wall θ p is the same on both sides and θ p 87 or 58 in the rp model θ p 87 or 58 and the contact angle θ r of the root wall is 67 5 according to the measured value ahmed et al 2016b hauber et al 2020 since the pore diameter is 0 155 times the particle size when the particles are closely packed and 0 414 times the particle size when they are loosely packed říha et al 2018 the pore diameters of the two corresponding packing states in the experiment should be less than 0 31 and 0 82 mm respectively for this we choose pore throat sizes d c of 0 02 0 05 0 08 and 0 1 mm to run independent simulations finally the water depth ρ w and g can be used to figure out the pressure per unit area for the dye infiltration experiment the head height was 6 cm so the pressure at the surface was 600 pa as the depth of the soil layer increased the head pressure at the entry gradually decreased until 0 pa therefore the pressure difference δ p of 0 200 400 and 600 pa equal to the height of the water head of 0 2 4 and 6 cm are set to characterize the infiltration conditions for different soil depths after the outlet pressure is set to 0 pa table 3 displays the specific settings for each of the 28 sets of simulation experiments 3 results 3 1 dye infiltration experiment 3 1 1 features of roots in soil layers the rad of fine roots in the 11 profiles tends to fall with depth while the rad of coarse roots is largest at d z 10 20 cm and tends to fall with depth fig 3 a as shown in fig 3 b the rad of fine roots is the largest at d y 70 cm which corresponds to the vegetation distribution of the sample site meanwhile the fine root density is larger at d y 0 70 cm and the coarse root density is higher at d y 80 110 cm suggesting that there is a dividing line of root density of coarse and fine root located at d y 70 80 cm we use the ratio rmd d rmd n rmdd the rmd of dyed roots rmdn the rmd of undyed roots to determine the degree of root dyeing it can indicate the degree of water flow along roots of varying diameters as shown in fig 4 this ratio between 0 and 1 suggests a greater mass of undyed roots whereas a ratio greater than 1 indicates a larger mass of dyed roots according to the results of rmd d rmd n versus d r for 10 root soil blocks the ratio of dyed to undyed roots drops as d r increases fig 4 for d r 5 mm more mass of undyed roots exists in 75 of 10 root soil blocks than dyed roots for roots with 2 mm d r 5 mm 70 to 75 of 10 root soil blocks have more dyed roots than undyed roots while in all zones of the area the mass of dyed roots is larger than the mass of undyed roots for roots with d r 2 mm from the experiments finer roots appear to influence water infiltration more than coarser roots 3 1 2 dyeing indexes for soil profiles it is discovered that dc increases to 100 in the depth range of 0 5 cm then decreases with the increase of d z shown from the photographs in fig 5 d f we classify the 11 datasets into three types each showing a distinct pattern of dyeing between 0 20 cm and 20 40 cm in the d z direction the first type is characterized by uniformly shallow infiltration for d y 30 40 60 cm fig 5 a and d at d z 0 20 cm the dc for this type has an exponentially decreasing trend and it is already less than 20 with essentially no dc at d z 20 60 cm the second type is non uniformly shallow infiltration for d y 50 80 90 100 110 cm fig 5 b and e this type of dc displays a linear decrease from d z 5 40 cm no dc from d z 40 60 cm and non uniform localized dyeing deep infiltration is the third type for d y 10 20 70 cm fig 5 c and f at d z 0 60 cm the dc of this type shows a linearly decreasing trend and at d z 20 cm it might still approach 50 table 4 displays the additional parameters for the 11 profiles at 10 110 cm in the d y direction including total dc maximum dye depth dd max dc per layer and pr fr it can be seen that the change in dc every 10 cm is consistent at d z 20 60 cm the trend of dc fluctuation in every 10 cm depth range was the same for the 11 profiles however when d y 10 20 50 70 100 110 cm the fluctuation trend of dc is opposite at d z 0 10 cm and d z 10 20 cm 3 1 3 root soil and dyeing indexes of soil profiles the uniformly shallow infiltration d y 40 cm displays the highest decrease in fine roots and coarse roots density at d z 0 20 cm which leads to the lowest rad of coarse roots at d z 20 cm fig 5 g correspondingly it has the largest dc drop of 40 indicating an inadequate hydrological connection in shallow soil layers with consistently weak infiltration while non uniformly shallow infiltration fig 5 h and deep infiltration fig 5 i contain high rad of both coarse and fine roots even the root density is increasing leading to less amount of dc decline in the shallow layer at d z 20 40 cm the rad of coarse and fine roots is larger for deep infiltration while the dc is higher and the dye solution is easy to enter fig 5 i while for both uniformly and non uniformly shallow infiltration the rad of the roots is reduced by 60 at d z 20 40 cm and dc drops to 0 this indicates that the larger the root density the greater the soil hydrological connectivity the correlation between root parameters and dc is proved based on the relationship between root density and dc in the above typical profiles we use the dc per 10 cm soil layer in the d y direction for each profile as the dependent variable and the root system indicators such as rad and root number n r as the independent variables table 5 the correlation coefficients for fine roots are 0 834 between rad and dc and 0 816 between n r and dc it is significant at the 0 01 level indicating a strong positive correlation between the density of fine roots and dc similarly there is a positive correlation between the density of coarse roots and dc while the n r of coarse roots is more strongly associated with dc it indicates that the dc in each layer decreases as the rad or n r of the plant roots decrease to investigate the association between preferential flow parameters and root parameters a statistical analysis of the pr fr and the n r rad of each diameter in 11 profiles is conducted according to table 6 the root indexes with 2 mm d r 3 mm has correlation coefficient values greater than 0 7 with pr fr p 0 01 and the root indexes with d r 2 mm has correlation coefficient values greater than 0 6 with pr fr p 0 05 indicating a strong positive correlation between fine roots and pr fr while the root indexes with 4 mm d r 5 mm shows a strong negative correlation with pr fr p 0 05 and the root indexes with d r 5 mm has a weak negative correlation with pr fr it indicates that the pr fr could increase as the rad or n r of the roots increases for d r 3 mm or the roots decrease for d r 4 mm it means that numerous fine roots enable better water flow than the coarse roots of the same rad 3 2 movement of pore fluid for the rp and pp model 3 2 1 fluid movement process there are a total of 28 sets of simulation results for three parameters the wall contact angle the pressure difference and the size of the d c the fluid movement of 28 simulations is discussed to reveal the physical micro mechanism of the root induced preferential flow that lies behind the experimental phenomenon of dye infiltration only 17 of the 28 outcomes enable fluid to pass through to the outlet the results of two models with θ p 87 d c 0 1 mm and δ p 200 pa are presented to illustrate two different overall infiltration processes seen in fig 6 a and b clearly water can flow out of the rp model in the same amount of time quicker in the rp model the liquid surface lowers along the root wall into the pore because θ r θ p and it continues to lower along the root wall to the outlet fig 6 a in contrast the pp model shows a convex liquid surface and then falls back the particles on either side of the wall condition are identical hence the lowering of the liquid surface is axisymmetric fig 6 b in both models the surface tension of the liquid before the water reaches the pore throat is down and after water flows through the pore throat it is up in fig 6 a the total δ p and gravitational force of the liquid are greater than the capillary force allowing water to flow to the outlet however the capillary force is bigger than the sum of the other two forces so the liquid surface moves back toward the pore throat in fig 6 b based on this we obtain the relationship between the ratio of the downward flow height of the liquid surface d z and the total height of the model d h and the ratio of time used for the downward flow of the liquid surface t and the time step δt 1 10 5 s at the two walls of the rp and pp models fig 6 c it shows that the height of the root wall of the rp model is higher than that of the particle wall during the water motion also water eventually reaches the outlet along the particle wall of the rp model but it takes twice as long as at the root wall in contrast the liquid surface at the wall of the pp model cannot reach the pore outlet meanwhile the liquid surface lowering rate of the particle wall in the rp model is higher than that in the pp model due to the pulling of the root wall on the liquid this shows that the root can help direct water flow 3 2 2 effect of parameters the d max identifies the point of the highest velocity of movement during the downward flow of the liquid surface it can most obviously represent the contribution of root presence to the transport of water we use the time taken for the fluid to reach d max as the vertical coordinate to quantify the effect of different factors on the preferential flow as shown in fig 7 δ p is used to describe the water head pressure on infiltration for θ r θ p with the same d c the larger δ p is the faster the rate of liquid surface lowering of rp and pp models fig 7 a for δ p 400 pa the time required to reach the pore outlet is comparable for both models this indicates that the flow velocity of water in the root soil pores and soil pores are similar for shallow soil with high surface accumulated water amounts and the roots show less advantage and do not reflect a preferential flow tendency by decreasing δ p from 400 pa to 200 pa the rp model shows an 18 increase in the time required to reach the pore outlet while the pp model shows a 25 increase as δ p decreases to 0 pa the time to reach the pore outlet h max increased by 46 for the rp model and 153 for the pp model this indicates that as the water infiltrates deeper into the soil water flows more easily and more rapidly through the root soil pore than through the interparticle pore so creating a preferential flow path moreover d c is used to explore the rate of d max lowering under different pore sizes under no head pressure conditions when θ r θ p it shows that the rate of d max lowering decreases as d c increases shown in fig 7 b at water reaches the pore inlet stage and water flows within the pore the time required for d max to reach the pore inlet in the pp model is three times that of the rp model and the time required to reach the pore outlet for the pp model is about twice that of the rp model moreover the rp model has a higher d max after liquid surface stabilization than the pp model this indicates that the water moves faster along the root under capillary force and gravity and it is easier to enter the next pore since the liquid surface can reach a higher height for θ r θ p the overall influence of δ p and d c on d max of the two models is similar as θ r θ p during the water flows from the model inlet to the pore outlet fig 7 c and d the difference is that for θ r θ p the fluid reaches the pore outlet more easily for both rp and pp models due to the smaller contact angle of the particle wall with the same d max increase trend it is found that the lowering rate of d max for θ r θ p is faster compared to θ r θ p the time consumed for d max to reach the pore outlet is essentially the same for the rp and pp models under different δ p and d c but the lowering rate of the liquid surface out of the pore is faster for the rp model 3 2 3 analysis of root soil pore it shows that the liquid surface enters the pore along the wall with the smaller contact angle in fig 6 to investigate the role played by the root wall in the inflow of water into the pore we calculate the liquid surface lowering rate v of the root wall and particle wall of the rp model shown in fig 8 15 v d in d out t in t out where d in denotes the height of the pore inlet d z d h 0 2 d out denotes the height of the pore outlet d z d h 0 6 t in is the time for water to reach the pore inlet and t out is the time for water to reach the pore outlet there is a linear increase relationship between v and δ p at both borders with a larger velocity increment at the root wall fig 8 a the v of the root wall is near twice that of the particle wall and the maximum v can reach 2 2 times when the θ p is larger δ p 200 pa d c 0 1 mm moreover the v of the root wall is almost over twice that of the particle wall when the θ r is larger as low as 2 3 times at δ p 400 pa and d c 0 1 mm the liquid lowering rate at both walls tends to increase exponentially with decreasing d c and the trend is more obvious on the root wall fig 8 b as d c decreases the v of both the root wall and particle wall converge to the same for larger θ p while the v of both the root wall grows at a faster rate than the particle wall as d c decreases for larger θ r the maximum v at the root wall can be as high as three times the particle wall δ p 0 pa d c 0 05 mm it showed that water moves more rapidly via the root soil pore gap facilitating faster entry of water to deeper soil layers along the roots 4 discussion 4 1 effects of root density and diameter on preferential flow at the field scale under similar particle size distribution of the soil in each profile the dyeing patterns of each profile differ table 1 table 4 suggesting that the root system plays a different role in infiltration wang et al 2018 consistent with the findings of nobles et al 2010 and luo et al 2019 the dc of the soil tends to decrease with depth table 4 the uniformity of the dc in the 0 5 cm deep range may correspond with the regional humus layer thickness mehtab et al 2020 as the herbaceous vegetation on the surface layer has grown the fine root development in the soil has become more homogeneous the larger density and number of roots as well as the complex root structure interspersed in the soil to generate numerous big pores with enhanced pore connection are the key causes of the higher dc in shallow soil layers newman et al 2004 noguchi et al 1997 sidle et al 2001 jiang et al 2021 another explanation might be that biological activity decreases as soil depth increases but exudates from microbes and plant roots can produce organic matter in the soil and a larger organic matter concentration can aid vertical water transport ali et al 2018 root degradation also creates huge holes that function as preferential flow routes fageria and stone 2006 ghestem et al 2011 therefore as soil depth increases the root density decreases and so do hydrological connectivity and dc there is a positive correlation between coarse roots and dyeing indexes table 5 coarse roots raised macro porosity by 30 according to bodner et al 2014 some scholars also point out that the comparatively coarse and well developed horizontal roots can aid in the lateral flow of water in the shallow layer while the coarse roots that have grown vertically and the connected lateral roots can increase the longitudinal flow of water along the taproots cui et al 2019 fan et al 2017 ghestem et al 2011 consequently it is also essential to consider how nearby soil profiles interact with one another when water cannot infiltrate a profile below a deeper depth it flows along the horizontal roots to the neighboring profiles by comparing the dyeing results by combining the results in fig 3 with table 4 the root density decreased with soil depth the less influence on the dyeing results of adjacent profiles with high root density in the shallow layer there was some mutual water feedback from adjacent profiles however the preferential flow index we obtained is not well related to the coarse root density unlike the results of dai et al 2021 it may be since the characteristics of coarse roots cannot be fully characterized by two dimensional cross sectional area because coarse roots are longer have a smaller specific surface area and the rad only weakly characterizes their conductivity due to the hot and humid climate of the study area plant roots are shallowly developed and coarse roots are mostly distributed laterally jiang et al 2022 which may also explain the weak correlation between coarse root density and preferential flow index moreover there is a significant correlation between fine roots and dyeing profile indexes table 5 table 6 according to bodner et al 2014 fine roots cause pore space inhomogeneity and larger micropores volumes they are easily twisted to form a complex root network which increases the hydrological connectivity of the soil some study shows that fine roots affect aggregate stability hao et al 2020 fine roots have substantially higher root length densities and decomposability than coarse roots freschet et al 2017 these enhance aggregate stabilization while improving soil porosity and reducing the clogging of loose clay particles in water channels bronick and lal 2005 galloway et al 2018 ghestem et al 2011 meanwhile under these climate and soil conditions fine roots are shorter more numerous and have a large specific surface area as a result their rad reflects their proportional contribution to preferential flow furthermore there are many results on the effect of root density parameters on infiltration freschet et al 2021 more indoor modeling studies are needed to confirm the precise effect of different root densities on infiltration combining the previous analyses it is possible to classify the infiltration patterns of the root soil system when there are more fine roots and the coarse roots are primarily developed horizontally uniformly shallow infiltration will occur the typical example is the water infiltration process in grassland and cropland where the fibrous root system is abundant and evenly distributed within the shallow soil wahren et al 2009 alaoui et al 2011 it will result in non uniformly shallow infiltration if the fine roots are developed shallowly and the coarse roots are inclined but not deeply rooted it is more common in areas with mixed grass and shrub growth or some trees such as deciduous forests where shallow fine roots develop and thick roots grow variably luo et al 2019 zuo et al 2021 when the coarse roots are deeply rooted and the fine roots that accompany them are well developed the result is deep infiltration this occurs frequently in areas where large trees such as forests have a well developed primary root system that generates excellent preferential flow channels in the deeper soil layers luo et al 2019 alaoui et al 2011 of course the soil in southwest china is not homogenous the water can also flow from the soil matrix due to the existence of bigger pores around the root soil system we also discover undyed roots in the shallow layer proving that not all roots are preferred water channels similar findings are reached by luo et al 2018 who find that specific existing roots do not help soil water transport however the majority of coarse roots are more undyed and the smaller the diameter the more dyed the roots are this may be due to the distinct roles that coarse and fine roots play in water infiltration as well as potential connections to the physiological properties of coarse and fine roots the roots with smaller diameters are mostly absorbent roots which are dyed during water flow as a result of water absorption by plant life activities wang et al 2015 zhao et al 2014 coarse roots on the other hand can only be dyed for a brief time by water infiltration 4 2 root promotes water flow at the pore scale the process of liquid surface lowering which is also called the two phase flow of water driven air is mainly influenced by the viscosity ratio interfacial tension wettability of the two phase fluid and the pore structure characteristics cejas et al 2014 de anna et al 2020 in regular capillary tubes the liquid surface always lowers along the side walls with smaller contact angles jang et al 2016 but once within the pore the particle morphology causes the flow route to growing narrower which in turn causes the liquid surface velocity at the particle wall to increase and the liquid surface lowering this illustrates the need to create pore throats to explore the change in the fluid surface under different conditions as this can affect the overall flow path of water due to the contact angle and particle morphology limitations the liquid surface lowers along the root wall the water potential conditions within the infiltration zone are the basic factors affecting the change in infiltration rate and the rate of soil infiltration shows a decreasing trend with time bodman and colman 1944 the dyeing in shallow soil is more uniform in the dye experiment because the water flow in both the root soil pores and soil pores is mainly influenced by the total potential gradient within the upper part of the wet soil fig 7 while in deep soil layers the fluid is primarily affected by gravity and capillary forces the root serves as a conduit to move water from one pore to the next whereas water between soil particles can only remain close to the pore throat a preferential flow path similar to that in fig 9 eventually forms in the root soil pore as a result of the roots from a single pore channel of the rp model the rate of liquid surface flow along the root side of the root soil pore is greater than that along the particle side fig 8 the rate of liquid surface flow along the root wall of the root soil pore is greater than that along the particle wall fig 8 the root side liquid surface movement pulls the liquid surface downward causing water to lower on the particle wall and even throughout the entire pore space additionally it is found that soil porosity away from the root axis reduces with increasing distance and lowers with increasing d r and root density utilizing ct scans helliwell et al 2017 helliwell et al 2019 therefore even in the absence of pressure conditions water is more likely to flow across the soil matrix along the root axis under the influence of gravity and capillary forces mair et al 2022 the roots show various structural forms such as spongy or fibrous resulting in roughness on the root surface hauber et al 2020 according to the derivation of the wenzel equation it can be found that rough surfaces can increase the hydrophilicity of the hydrophilic materials for smooth surfaces wenzel 1936 it also suggests that the simulated wall itself is hydrophilic and the actual root system has a rougher surface which results in a smaller contact angle and easier fluid flow also in the simulation we assume that the fluid is water but in reality there are root secretions consisting of polysaccharides and small amounts of lipids around the root tip carminati et al 2017 read et al 2003 ahmed et al 2016a explored the contact angle of dry mucilage collected from maize plants and found that the contact angle decreased for lower mucilage concentrations therefore the effect of root biochemistry on the inter root fluid contact angle also needs to be considered in future investigations moreover the d r determines the number of pores between root and soil particles in the cross section for a single root the larger the diameter the more soil particles come into touch with the root cross section the specific surface area of fine roots is larger than that of coarse roots at the same rad because there are more fine roots than coarse roots as a result locations with a higher density of fine roots are more likely to increase water flow because they have fine roots in contact with more soil particles at the same rad 5 conclusion the water infiltration at the field scale and the pore scale are investigated to clarify why roots promote preferential water movement the conclusions are as follows 1 both fine and coarse roots promote water infiltration the rad of fine roots is strongly correlated with dc while the number of coarse roots is more strongly correlated with dc and the density of fine roots shows a significant positive correlation with the pr fr 2 we propose three infiltration patterns in the root soil zone based on the root density and the depth obtained from the experiment grass and cultivated areas are more likely to develop uniformly shallow infiltration whereas mixed grass and irrigation or shallow rooted tree areas are more likely to form non uniformly shallow infiltration and tree areas are more likely to generate deep infiltration in addition the infiltration pattern can also be evaluated based on the results of the field root profile 3 on the pore scale there is a small difference in infiltration capacity between the root soil pore and interparticle pore under high pressure difference resulting in uniform infiltration in shallow soils while in the deep soil layer water flows more easily along the roots and at a faster rate than the water flow within the soil pores thus creating a preferential flow the present study can be considered an advancement in explaining the preferential flow of water induced by the root system from multi scale aspects credit authorship contribution statement jiaying li conceptualization methodology investigation formal analysis writing review editing peng cui conceptualization funding acquisition supervision yanzhou yin conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was funded by the second tibetan plateau scientific expedition and research no 2019qzkk0903 02 the strategic priority research program of chinese academy of sciences no xda23090303 the national key research and development program of china 2022yfc3002902 
1706,plant roots potentially contribute to slope instability by causing infiltrating water to be spatially and temporally redistributed in the soil unevenly following rainfall but the root system s macro scale impact on water infiltration and the formation and dynamics of pore scale preferential flow induced by roots are still ambiguous a field dye infiltration experiment was used to simulate rainwater infiltrating into the soil to quantify the relationship between preferential flow pathways and root characteristics such as root density and root number a two dimensional phase field model was used to describe quantificationally and visually the influence of fluid pressure difference wall contact angle and pore throat size on vapor liquid interface movement in the root particle and interparticle pores water flows more freely along an extension direction of shallow coarse root diameter 5 mm facilitating water transfer between adjacent profiles the dye coverage and preferential flow fraction are found to be significantly positively correlated with the fine root diameter 5 mm density and the coarse root quantity at the pore scale a low difference of fluid pressure exerts more control from the root system over preferential flow especially the vapor liquid interface in the root particle pore lowers to the pore outlet about 50 faster than the inter particle pore for no pressure difference the larger wall contact angle of the particle causes a more pronounced lowering rate of the vapor liquid interface with smaller pores the flow rate accelerates smaller pores make it harder for water to flow from the interparticle pores than root particle pores our findings can help to more accurately determine the depth of water infiltration in the slope and deeply understand the physical mechanism of the effect of the root system on rainwater redistribution keywords root soil water system preferential flow root density dye tracer phase field method data availability data will be made available on request 1 introduction shallow landslides caused by rainfall usually occur in mountainous areas such as southern china and parts of south central and south western china after intensive or prolonged rainy seasons chen and lee 2003 numerous investigations have demonstrated that plant covered slopes differ mechanically and hydrologically from bare slopes and hydrological processes have a more significant impact on vegetation slope stability wu et al 1979 the roots as a key component linking the plant to the soil have a profound impact on hydrological processes in forested environments in addition to the soil structure sidle and bogaard 2016 the primary root systems can extend deep into the soil or bedrock where they can transport water and create a dangerous sliding surface due to an increase in pore water pressure balzano et al 2019 mulyono et al 2018 besides the interface between a soil slope s root rich and rootless zones is another possible location for the development of a sliding surface baker et al 2021 liu et al 2016a plant roots usually have a significant impact on water infiltration due to the inhomogeneity of pore space caused by root vital activities and root system interactions bodner et al 2014 weiler and naef 2003 wu et al 2022 roots generally improve soil permeability by wedging into weathered rocks and soils or decaying to form channels which increases infiltration rates and fluxes during rainfall infiltration cui et al 2022 freer 1991 luo et al 2019 on the other hand roots can reduce soil permeability a process that is most prevalent in the earliest stages of root growth and under conditions of high soil porosity markart et al 2011 singh et al 2018 previous statistical results indicated that the percentage change in soil saturation infiltration rate caused by tree and shrub roots ranged from 140 to 109 and that the corresponding value for herbaceous roots ranged from 90 to 650 lu et al 2020 therefore broad statements about the effect of plant roots on permeability are inappropriate because it depends greatly on soil and root type one of the main reasons roots promote water infiltration is the preferential flow formed by the root system levia and frost 2003 schwärzel et al 2012 preferential flow in contrast to matrix flow always describes the irregular and frequently rapid movement of water and solutes around the soil matrix via the macro pores network allaire et al 2009 hendrickx and flury 2001 pore continuity booltink and bouma 1991 and pore density smettem 1986 are all factors that affect preferential flow while the distinctive structural features of the root system and the interactions between roots lead to the formation of pore channels with widespread distribution stability and continuity and are therefore particularly important in preferential flow study therefore water may preferentially move through soil profiles that have a lot of roots luo et al 2019 many roots make a network of channels that facilitate rapid lateral water movement through the soil levia and frost 2003 schwärzel et al 2012 devitt and smith 2002 found that macro pore channels created by shrub roots in dry areas improved water flow downwards in desert soils and the more roots there are the stronger the preferential flow similarly song et al 2017 found that the formation of preferential flow routes by vetiver grasses with main root systems may have improved unsaturated infiltration rates the influence of root systems on preferential flow is significantly related to the root diameter d r and its arrangement there is some evidence that fine d r 5 mm and coarse roots d r 5 mm all aid water movement but their mechanisms of action are distinct bodner et al 2014 together with surface microorganisms fine roots release polysaccharides and other chemicals that aggregate clay particles that contribute to enhancing the stability of soil aggregates which increases the soil s permeability and infiltration rate paterson et al 2007 tisdall and oades 2006 erktan et al 2015 vannoppen et al 2015 many fine roots can grow close together and even tangle with one another to form a complex root network that promotes water flow löbmann et al 2020 while the coarse roots may be more efficient at transporting water between soil layers because of their longer length compared to fine roots martinez et al 2021 furthermore some root shrinks during growth to create a circular gap that makes it easier for water to flow ghestem et al 2011 to date the phenomenon of preferential flow induced by root systems has been observed frequently and the relative macro contributing factors and the mechanism of triggering landslides have been elucidated however the physical process of pore scale root induced preferential flow is not clear which limits us to the understanding of the action mechanism of macro factors on preferential flow insight into hydrological processes under the control of plant roots can be gained by analyzing the root soil moisture distribution both spatially and temporally dye tracing is the most widely used technique for visualizing water flow because it allows observation of the water flow route without disturbing the soil analyzing the image after dyeing provides a semi quantitative assessment of the flow state flury and flühler 1995 dyed areas have traditionally been evaluated quantitatively using parameters like preferential flow fraction pr fr and length index bargues tobella et al 2014 van schaik 2009 we use the dye tracing method to visualize the preferential flow pattern of soil analyze the dyeing ratio of roots regional root density and dyeing parameters to conclude the relationship between root characteristics and preferential flow and thus gain a better understanding of the temporal and spatial distribution of water in the root soil system root induced preferential flow is a process involving the transport of vapor liquid interface along the solid pore walls and is related closely to the multiphase flow motion process our in depth analysis of root induced preferential flow is limited by the dye experiment s ability to only produce the results of the final spatial distribution and not to track the progress of the fluid movement in the pore space over time as a result we simulate the multiphase flow transport mechanism within the pore medium and the pore space between the roots and soil using the phase field method the phase field method can more naturally follow the evolution of a complicated free surface and it is more accurate in terms of pressure gradients and velocity profiles than other interface trackings methods like the level set method and the volume of fluid method xiao et al 2019 to better understand the mechanism of macroscopic root action on preferential flow at the microscopic level we use the phase field method to obtain the interfacial variation patterns of water air two phase flow under different simplified models pore throat sizes and inlet pressure conditions thus explaining the observed phenomena in the field in this study we chose a typical distribution of coniferous forests in the hilly region of southwest china as the study area to quantitatively describe the influence of the root system on preferential flow we conducted an experiment using the brilliant blue fcf tracer to investigate the characteristics of root soil water flow affected by the root system the results of numerical simulations are further combined with the results of the field scale to explain why the root system promotes preferential flow finally the mechanism of the root induced preferential flow is explained together at the pore scale and the field scale 2 materials and method 2 1 field experiment 2 1 1 experimental site a field experiment was performed in the longchi national forest park 31 8 10 w 103 34 32 e located northwest of chengdu in sichuan province china the climate in the study area is humid subtropical monsoon with four distinct seasons zhang et al 2021 the average annual temperature is 15 2 and the average annual rainfall is roughly 1300 1450 mm jiang et al 2022 rainfall occurs frequently and heavily during summer with 70 of it falling between june and september the bedrock in the study area mainly consists of granite amphibolite and triassic rocks with a general thickness of 50 130 cm of soil over bedrock and a humic layer thickness of about 1 1 3 cm mehtab et al 2020 stokes et al 2007 coniferous and broad leaved mixed forest is the main vegetation type in the longxi river basin no precipitation fell during our experiment in june we choose a well developed root system and gently sloping site surrounded by four firs with an average height of 20 m three ring knives were used to measure the dry density and natural moisture content at different depths in the ranges of 0 20 cm 2 0 40 cm and 4 0 60 cm the physical parameters of the soils are shown in table 1 the soil is found to be sandy loam in the depth range of 0 60 cm indicating a large sand content at the sample site usda nrcs 1997 the dry density in the range of 0 20 cm soil layer is the largest and the initial moisture content of the soil is also the largest reaching 36 86 2 1 2 dye experiment a square steel frame 120 cm 120 cm was vertically pushed into the soil at a depth of 10 cm and the steel wall s 10 cm high aboveground section served as a barrier to prevent the dye tracers from escaping the frame fig 1 the ground was compacted both on the inside and the outside of the steel wall near the edge and fresh litter was removed from within the frame without damaging the humus layer on the surface we picked brilliant blue fcf for this experiment due to its great visibility and low toxicity and set the dye solution concentration to 4 g l flury and flühler 1995 the 87 l of dye solution equal to 6 cm rainfall was sprayed uniformly to avoid rain and evaporation the whole frame was then covered with a piece of canvas after 24 h the canvas and steel frame were gently removed after that the profiles were dug to a depth of 60 cm depending on the depth of soil dyeing and the position of bedrock to avoid boundary effect we collected the soil profiles starting at 10 cm from one steel frame s edge with a lateral increment of 10 cm in the horizon d y and width d x direction and eventually produced a sample plot of 100 cm 100 cm then each vertical portion was trimmed with a soil cutter after excavation following that a vertical plane of d x 100 cm and d z 60 cm was shot and geometric distortion was adjusted using the ruler s edge points because the tracer experiment lasted 24 h root absorption also had an impact on water redistribution in the soil wang et al 2015 according to the data in the famine early warning systems network land data assimilation system none of the daily average transpiration during the experiment surpassed 3 mm which was considerably less than infiltration amy mcnally nasa gsfc hsl 2018 so we ignored the influence of transpiration here 2 1 3 image analysis perform geometric correction on the obtained dyed image to distinguish more precisely between dyed and undyed areas of the soil profile we used the trainable weka segmentation module of the software image j to classify the soil within the obtained photographs lormand et al 2018 the same post training categorization rules were then applied to all profile photographs the obtained image was binarized and the dye region was represented by black to characterize the dye path in the soil vertical profile dye coverage dc and pr fr introduced by van schaik 2009 and bargues tobella et al 2014 were used dc is the proportion of the dyed area to the sum of the dyed and undyed areas 1 dc d d n d 100 where d cm 2 and nd cm 2 are the dyed area and the undyed area respectively the dc is calculated according to the percentage of black pixels in each horizontal line in the binary images for each vertical profile pr fr is the fraction of the total infiltration that flows along preferential flow pathways 2 p r f r 1 unifr w tsa 100 where unifr is the uniform infiltration depth cm that is defined as the depth at which the dc decreases below 80 w is the width of the vertical profile 100 cm and tsa is the total dyed area cm 2 2 1 4 root sample collection and quantification the brilliant blue dyes the root surface after the dye tracer runs through the root channel therefore it is reasonable to conclude that root dyeing is caused mostly by the preferential flow path a total of ten soil blocks 100 cm 10 cm 60 cm between two vertical profiles d y 10 cm was brought back intact in cling bags all roots picked from the soil and brought back to the lab were examined under natural light to determine whether they had been dyed or left undyed luo et al 2018 in contrast to undyed roots most dyed roots have 80 90 or more of their total root surface area dyed then using a vernier caliper we measured all of the collected roots and divided them into six groups with dyed and undyed roots based on their diameters soak the roots in water to remove attached soil particles without destroying their structure then the root was put in an oven at 65 zhang et al 2012 after 24 h the root was taken out and weighed which was the dry weight of the roots w d root area density rad and root mass density rmd are used to quantify the root density of different soil layers mehtab et al 2020 zhang et al 2012 rad is defined as the ratio of the total cross sectional area s r of plant roots to the total cross sectional area s s of the soil 3 rad s r s s 100 also rmd is the dry weight w d of roots per unit volume of soil v s 4 rmd w d v s 100 we utilized the measurement tool of software image j to get the root coordinates and d r of each piece only live roots were considered in the statistics finally we obtained the root distribution and each layer s rad of 11 profiles the total rad at different locations required for the calculation is the sum of the rad extracted within the area of the region 2 2 numerical analysis the phase field method is used to track the interface of a two phase flow bai et al 2017 a cahn hilliard equation cahn and hilliard 1958 governs the dynamics of a two phase flow the diffuse interface is defined as the region where the dimensionless phase field variable ϕ goes from 1 to 1 the cahn hilliard equation is expressed as follows 5 ϕ t u ϕ γ λ ε 2 ψ 6 ψ ε 2 ϕ ϕ 2 1 ϕ ε 2 λ f ext ϕ where u is the fluid velocity field t is time γ is the mobility parameter ψ is an auxiliary variable qin and bhadeshia 2013 λ is the mixing energy density and ε is a control parameter for the interface thickness that scales with a thickness of the interface qian et al 2005 we set ε h c 2 where h c is the characteristic mesh size in the region passed by the interface the parameters λ and ε are related to interfacial tension σ f ext is an external force due to the free energy and f ext 0 in this work we define air as fluid 1 ϕ 1 and water as fluid 2 ϕ 1 while it changes in 1 1 at the air water mixing zone the volume fraction of both is expressed as follows 7 v f 1 1 ϕ 2 8 v f 2 1 ϕ 2 the multi physics coupling feature defines the density ρ and the viscosity μ of the mixture to vary smoothly over the interface by letting 9 ρ ρ w ρ air ρ w v f 2 10 μ μ w μ air μ w v f 2 where the water and air properties are denoted w and air respectively the mass and momentum transfer of the fluid is modeled based on the navier stokes equation for incompressible fluids jacqmin 1999 also the effect of surface tension is considered in the model thus the n s equation is expressed as 11 ρ u t ρ u u p i μ u u t f st ρ g 12 u 0 where p denotes the pressure i is the unit tensor and g is the gravity vector f st is the surface tension force acting at the air water interface 13 f st g ϕ where ϕ is the phase field parameter g is the chemical potential 14 g λ 2 ϕ ϕ ϕ 2 1 ε 2 scanlan 2009 assumed that the geometry of roots within pore space can be represented by concentric cylinders to study root induced changes to soil hydraulic properties however the pores between particles and roots are undulated lei et al 2021 they control the flow of water directing it to go through pores in whichever direction has the lowest capillary pressure threshold lu et al 2019 therefore as shown in fig 2 b we used a simplified model of the root soil system in which the root is represented by cylinders and the soil particles by balls in this simulation the pores can be simplified to the root to particle rp model fig 2 a and the particle to particle pp model fig 2 c in the two dimensional 2d cross section of the root soil system in this simulation we assume that water and air are incompressible and the gravity direction is set to coincide with the water flow direction to simulate the vertical infiltration process both inlet and outlet are pressure boundaries the density and viscosity of air and water are the standard values at 24 table 2 as we consider the comparison of different situations higher mobility is used in this study to obtain the correct pressure change at the interface other parameter values are shown in table 2 the particle radius is set to 0 1 mm because the size of the particle with high content is 0 02 2 mm in the experimental sample site table 1 the contact angle measures the ability of a liquid to wet a solid surface jang et al 2016 therefore the contact angle must take into account the difference between the root wall and the particle wall the corresponding contact angles of 87 for subgrade soil and 58 for silica sand are obtained based on the curve of contact angle versus particle size obtained experimentally by liu et al 2016b in the pp model the contact angle of the particle wall θ p is the same on both sides and θ p 87 or 58 in the rp model θ p 87 or 58 and the contact angle θ r of the root wall is 67 5 according to the measured value ahmed et al 2016b hauber et al 2020 since the pore diameter is 0 155 times the particle size when the particles are closely packed and 0 414 times the particle size when they are loosely packed říha et al 2018 the pore diameters of the two corresponding packing states in the experiment should be less than 0 31 and 0 82 mm respectively for this we choose pore throat sizes d c of 0 02 0 05 0 08 and 0 1 mm to run independent simulations finally the water depth ρ w and g can be used to figure out the pressure per unit area for the dye infiltration experiment the head height was 6 cm so the pressure at the surface was 600 pa as the depth of the soil layer increased the head pressure at the entry gradually decreased until 0 pa therefore the pressure difference δ p of 0 200 400 and 600 pa equal to the height of the water head of 0 2 4 and 6 cm are set to characterize the infiltration conditions for different soil depths after the outlet pressure is set to 0 pa table 3 displays the specific settings for each of the 28 sets of simulation experiments 3 results 3 1 dye infiltration experiment 3 1 1 features of roots in soil layers the rad of fine roots in the 11 profiles tends to fall with depth while the rad of coarse roots is largest at d z 10 20 cm and tends to fall with depth fig 3 a as shown in fig 3 b the rad of fine roots is the largest at d y 70 cm which corresponds to the vegetation distribution of the sample site meanwhile the fine root density is larger at d y 0 70 cm and the coarse root density is higher at d y 80 110 cm suggesting that there is a dividing line of root density of coarse and fine root located at d y 70 80 cm we use the ratio rmd d rmd n rmdd the rmd of dyed roots rmdn the rmd of undyed roots to determine the degree of root dyeing it can indicate the degree of water flow along roots of varying diameters as shown in fig 4 this ratio between 0 and 1 suggests a greater mass of undyed roots whereas a ratio greater than 1 indicates a larger mass of dyed roots according to the results of rmd d rmd n versus d r for 10 root soil blocks the ratio of dyed to undyed roots drops as d r increases fig 4 for d r 5 mm more mass of undyed roots exists in 75 of 10 root soil blocks than dyed roots for roots with 2 mm d r 5 mm 70 to 75 of 10 root soil blocks have more dyed roots than undyed roots while in all zones of the area the mass of dyed roots is larger than the mass of undyed roots for roots with d r 2 mm from the experiments finer roots appear to influence water infiltration more than coarser roots 3 1 2 dyeing indexes for soil profiles it is discovered that dc increases to 100 in the depth range of 0 5 cm then decreases with the increase of d z shown from the photographs in fig 5 d f we classify the 11 datasets into three types each showing a distinct pattern of dyeing between 0 20 cm and 20 40 cm in the d z direction the first type is characterized by uniformly shallow infiltration for d y 30 40 60 cm fig 5 a and d at d z 0 20 cm the dc for this type has an exponentially decreasing trend and it is already less than 20 with essentially no dc at d z 20 60 cm the second type is non uniformly shallow infiltration for d y 50 80 90 100 110 cm fig 5 b and e this type of dc displays a linear decrease from d z 5 40 cm no dc from d z 40 60 cm and non uniform localized dyeing deep infiltration is the third type for d y 10 20 70 cm fig 5 c and f at d z 0 60 cm the dc of this type shows a linearly decreasing trend and at d z 20 cm it might still approach 50 table 4 displays the additional parameters for the 11 profiles at 10 110 cm in the d y direction including total dc maximum dye depth dd max dc per layer and pr fr it can be seen that the change in dc every 10 cm is consistent at d z 20 60 cm the trend of dc fluctuation in every 10 cm depth range was the same for the 11 profiles however when d y 10 20 50 70 100 110 cm the fluctuation trend of dc is opposite at d z 0 10 cm and d z 10 20 cm 3 1 3 root soil and dyeing indexes of soil profiles the uniformly shallow infiltration d y 40 cm displays the highest decrease in fine roots and coarse roots density at d z 0 20 cm which leads to the lowest rad of coarse roots at d z 20 cm fig 5 g correspondingly it has the largest dc drop of 40 indicating an inadequate hydrological connection in shallow soil layers with consistently weak infiltration while non uniformly shallow infiltration fig 5 h and deep infiltration fig 5 i contain high rad of both coarse and fine roots even the root density is increasing leading to less amount of dc decline in the shallow layer at d z 20 40 cm the rad of coarse and fine roots is larger for deep infiltration while the dc is higher and the dye solution is easy to enter fig 5 i while for both uniformly and non uniformly shallow infiltration the rad of the roots is reduced by 60 at d z 20 40 cm and dc drops to 0 this indicates that the larger the root density the greater the soil hydrological connectivity the correlation between root parameters and dc is proved based on the relationship between root density and dc in the above typical profiles we use the dc per 10 cm soil layer in the d y direction for each profile as the dependent variable and the root system indicators such as rad and root number n r as the independent variables table 5 the correlation coefficients for fine roots are 0 834 between rad and dc and 0 816 between n r and dc it is significant at the 0 01 level indicating a strong positive correlation between the density of fine roots and dc similarly there is a positive correlation between the density of coarse roots and dc while the n r of coarse roots is more strongly associated with dc it indicates that the dc in each layer decreases as the rad or n r of the plant roots decrease to investigate the association between preferential flow parameters and root parameters a statistical analysis of the pr fr and the n r rad of each diameter in 11 profiles is conducted according to table 6 the root indexes with 2 mm d r 3 mm has correlation coefficient values greater than 0 7 with pr fr p 0 01 and the root indexes with d r 2 mm has correlation coefficient values greater than 0 6 with pr fr p 0 05 indicating a strong positive correlation between fine roots and pr fr while the root indexes with 4 mm d r 5 mm shows a strong negative correlation with pr fr p 0 05 and the root indexes with d r 5 mm has a weak negative correlation with pr fr it indicates that the pr fr could increase as the rad or n r of the roots increases for d r 3 mm or the roots decrease for d r 4 mm it means that numerous fine roots enable better water flow than the coarse roots of the same rad 3 2 movement of pore fluid for the rp and pp model 3 2 1 fluid movement process there are a total of 28 sets of simulation results for three parameters the wall contact angle the pressure difference and the size of the d c the fluid movement of 28 simulations is discussed to reveal the physical micro mechanism of the root induced preferential flow that lies behind the experimental phenomenon of dye infiltration only 17 of the 28 outcomes enable fluid to pass through to the outlet the results of two models with θ p 87 d c 0 1 mm and δ p 200 pa are presented to illustrate two different overall infiltration processes seen in fig 6 a and b clearly water can flow out of the rp model in the same amount of time quicker in the rp model the liquid surface lowers along the root wall into the pore because θ r θ p and it continues to lower along the root wall to the outlet fig 6 a in contrast the pp model shows a convex liquid surface and then falls back the particles on either side of the wall condition are identical hence the lowering of the liquid surface is axisymmetric fig 6 b in both models the surface tension of the liquid before the water reaches the pore throat is down and after water flows through the pore throat it is up in fig 6 a the total δ p and gravitational force of the liquid are greater than the capillary force allowing water to flow to the outlet however the capillary force is bigger than the sum of the other two forces so the liquid surface moves back toward the pore throat in fig 6 b based on this we obtain the relationship between the ratio of the downward flow height of the liquid surface d z and the total height of the model d h and the ratio of time used for the downward flow of the liquid surface t and the time step δt 1 10 5 s at the two walls of the rp and pp models fig 6 c it shows that the height of the root wall of the rp model is higher than that of the particle wall during the water motion also water eventually reaches the outlet along the particle wall of the rp model but it takes twice as long as at the root wall in contrast the liquid surface at the wall of the pp model cannot reach the pore outlet meanwhile the liquid surface lowering rate of the particle wall in the rp model is higher than that in the pp model due to the pulling of the root wall on the liquid this shows that the root can help direct water flow 3 2 2 effect of parameters the d max identifies the point of the highest velocity of movement during the downward flow of the liquid surface it can most obviously represent the contribution of root presence to the transport of water we use the time taken for the fluid to reach d max as the vertical coordinate to quantify the effect of different factors on the preferential flow as shown in fig 7 δ p is used to describe the water head pressure on infiltration for θ r θ p with the same d c the larger δ p is the faster the rate of liquid surface lowering of rp and pp models fig 7 a for δ p 400 pa the time required to reach the pore outlet is comparable for both models this indicates that the flow velocity of water in the root soil pores and soil pores are similar for shallow soil with high surface accumulated water amounts and the roots show less advantage and do not reflect a preferential flow tendency by decreasing δ p from 400 pa to 200 pa the rp model shows an 18 increase in the time required to reach the pore outlet while the pp model shows a 25 increase as δ p decreases to 0 pa the time to reach the pore outlet h max increased by 46 for the rp model and 153 for the pp model this indicates that as the water infiltrates deeper into the soil water flows more easily and more rapidly through the root soil pore than through the interparticle pore so creating a preferential flow path moreover d c is used to explore the rate of d max lowering under different pore sizes under no head pressure conditions when θ r θ p it shows that the rate of d max lowering decreases as d c increases shown in fig 7 b at water reaches the pore inlet stage and water flows within the pore the time required for d max to reach the pore inlet in the pp model is three times that of the rp model and the time required to reach the pore outlet for the pp model is about twice that of the rp model moreover the rp model has a higher d max after liquid surface stabilization than the pp model this indicates that the water moves faster along the root under capillary force and gravity and it is easier to enter the next pore since the liquid surface can reach a higher height for θ r θ p the overall influence of δ p and d c on d max of the two models is similar as θ r θ p during the water flows from the model inlet to the pore outlet fig 7 c and d the difference is that for θ r θ p the fluid reaches the pore outlet more easily for both rp and pp models due to the smaller contact angle of the particle wall with the same d max increase trend it is found that the lowering rate of d max for θ r θ p is faster compared to θ r θ p the time consumed for d max to reach the pore outlet is essentially the same for the rp and pp models under different δ p and d c but the lowering rate of the liquid surface out of the pore is faster for the rp model 3 2 3 analysis of root soil pore it shows that the liquid surface enters the pore along the wall with the smaller contact angle in fig 6 to investigate the role played by the root wall in the inflow of water into the pore we calculate the liquid surface lowering rate v of the root wall and particle wall of the rp model shown in fig 8 15 v d in d out t in t out where d in denotes the height of the pore inlet d z d h 0 2 d out denotes the height of the pore outlet d z d h 0 6 t in is the time for water to reach the pore inlet and t out is the time for water to reach the pore outlet there is a linear increase relationship between v and δ p at both borders with a larger velocity increment at the root wall fig 8 a the v of the root wall is near twice that of the particle wall and the maximum v can reach 2 2 times when the θ p is larger δ p 200 pa d c 0 1 mm moreover the v of the root wall is almost over twice that of the particle wall when the θ r is larger as low as 2 3 times at δ p 400 pa and d c 0 1 mm the liquid lowering rate at both walls tends to increase exponentially with decreasing d c and the trend is more obvious on the root wall fig 8 b as d c decreases the v of both the root wall and particle wall converge to the same for larger θ p while the v of both the root wall grows at a faster rate than the particle wall as d c decreases for larger θ r the maximum v at the root wall can be as high as three times the particle wall δ p 0 pa d c 0 05 mm it showed that water moves more rapidly via the root soil pore gap facilitating faster entry of water to deeper soil layers along the roots 4 discussion 4 1 effects of root density and diameter on preferential flow at the field scale under similar particle size distribution of the soil in each profile the dyeing patterns of each profile differ table 1 table 4 suggesting that the root system plays a different role in infiltration wang et al 2018 consistent with the findings of nobles et al 2010 and luo et al 2019 the dc of the soil tends to decrease with depth table 4 the uniformity of the dc in the 0 5 cm deep range may correspond with the regional humus layer thickness mehtab et al 2020 as the herbaceous vegetation on the surface layer has grown the fine root development in the soil has become more homogeneous the larger density and number of roots as well as the complex root structure interspersed in the soil to generate numerous big pores with enhanced pore connection are the key causes of the higher dc in shallow soil layers newman et al 2004 noguchi et al 1997 sidle et al 2001 jiang et al 2021 another explanation might be that biological activity decreases as soil depth increases but exudates from microbes and plant roots can produce organic matter in the soil and a larger organic matter concentration can aid vertical water transport ali et al 2018 root degradation also creates huge holes that function as preferential flow routes fageria and stone 2006 ghestem et al 2011 therefore as soil depth increases the root density decreases and so do hydrological connectivity and dc there is a positive correlation between coarse roots and dyeing indexes table 5 coarse roots raised macro porosity by 30 according to bodner et al 2014 some scholars also point out that the comparatively coarse and well developed horizontal roots can aid in the lateral flow of water in the shallow layer while the coarse roots that have grown vertically and the connected lateral roots can increase the longitudinal flow of water along the taproots cui et al 2019 fan et al 2017 ghestem et al 2011 consequently it is also essential to consider how nearby soil profiles interact with one another when water cannot infiltrate a profile below a deeper depth it flows along the horizontal roots to the neighboring profiles by comparing the dyeing results by combining the results in fig 3 with table 4 the root density decreased with soil depth the less influence on the dyeing results of adjacent profiles with high root density in the shallow layer there was some mutual water feedback from adjacent profiles however the preferential flow index we obtained is not well related to the coarse root density unlike the results of dai et al 2021 it may be since the characteristics of coarse roots cannot be fully characterized by two dimensional cross sectional area because coarse roots are longer have a smaller specific surface area and the rad only weakly characterizes their conductivity due to the hot and humid climate of the study area plant roots are shallowly developed and coarse roots are mostly distributed laterally jiang et al 2022 which may also explain the weak correlation between coarse root density and preferential flow index moreover there is a significant correlation between fine roots and dyeing profile indexes table 5 table 6 according to bodner et al 2014 fine roots cause pore space inhomogeneity and larger micropores volumes they are easily twisted to form a complex root network which increases the hydrological connectivity of the soil some study shows that fine roots affect aggregate stability hao et al 2020 fine roots have substantially higher root length densities and decomposability than coarse roots freschet et al 2017 these enhance aggregate stabilization while improving soil porosity and reducing the clogging of loose clay particles in water channels bronick and lal 2005 galloway et al 2018 ghestem et al 2011 meanwhile under these climate and soil conditions fine roots are shorter more numerous and have a large specific surface area as a result their rad reflects their proportional contribution to preferential flow furthermore there are many results on the effect of root density parameters on infiltration freschet et al 2021 more indoor modeling studies are needed to confirm the precise effect of different root densities on infiltration combining the previous analyses it is possible to classify the infiltration patterns of the root soil system when there are more fine roots and the coarse roots are primarily developed horizontally uniformly shallow infiltration will occur the typical example is the water infiltration process in grassland and cropland where the fibrous root system is abundant and evenly distributed within the shallow soil wahren et al 2009 alaoui et al 2011 it will result in non uniformly shallow infiltration if the fine roots are developed shallowly and the coarse roots are inclined but not deeply rooted it is more common in areas with mixed grass and shrub growth or some trees such as deciduous forests where shallow fine roots develop and thick roots grow variably luo et al 2019 zuo et al 2021 when the coarse roots are deeply rooted and the fine roots that accompany them are well developed the result is deep infiltration this occurs frequently in areas where large trees such as forests have a well developed primary root system that generates excellent preferential flow channels in the deeper soil layers luo et al 2019 alaoui et al 2011 of course the soil in southwest china is not homogenous the water can also flow from the soil matrix due to the existence of bigger pores around the root soil system we also discover undyed roots in the shallow layer proving that not all roots are preferred water channels similar findings are reached by luo et al 2018 who find that specific existing roots do not help soil water transport however the majority of coarse roots are more undyed and the smaller the diameter the more dyed the roots are this may be due to the distinct roles that coarse and fine roots play in water infiltration as well as potential connections to the physiological properties of coarse and fine roots the roots with smaller diameters are mostly absorbent roots which are dyed during water flow as a result of water absorption by plant life activities wang et al 2015 zhao et al 2014 coarse roots on the other hand can only be dyed for a brief time by water infiltration 4 2 root promotes water flow at the pore scale the process of liquid surface lowering which is also called the two phase flow of water driven air is mainly influenced by the viscosity ratio interfacial tension wettability of the two phase fluid and the pore structure characteristics cejas et al 2014 de anna et al 2020 in regular capillary tubes the liquid surface always lowers along the side walls with smaller contact angles jang et al 2016 but once within the pore the particle morphology causes the flow route to growing narrower which in turn causes the liquid surface velocity at the particle wall to increase and the liquid surface lowering this illustrates the need to create pore throats to explore the change in the fluid surface under different conditions as this can affect the overall flow path of water due to the contact angle and particle morphology limitations the liquid surface lowers along the root wall the water potential conditions within the infiltration zone are the basic factors affecting the change in infiltration rate and the rate of soil infiltration shows a decreasing trend with time bodman and colman 1944 the dyeing in shallow soil is more uniform in the dye experiment because the water flow in both the root soil pores and soil pores is mainly influenced by the total potential gradient within the upper part of the wet soil fig 7 while in deep soil layers the fluid is primarily affected by gravity and capillary forces the root serves as a conduit to move water from one pore to the next whereas water between soil particles can only remain close to the pore throat a preferential flow path similar to that in fig 9 eventually forms in the root soil pore as a result of the roots from a single pore channel of the rp model the rate of liquid surface flow along the root side of the root soil pore is greater than that along the particle side fig 8 the rate of liquid surface flow along the root wall of the root soil pore is greater than that along the particle wall fig 8 the root side liquid surface movement pulls the liquid surface downward causing water to lower on the particle wall and even throughout the entire pore space additionally it is found that soil porosity away from the root axis reduces with increasing distance and lowers with increasing d r and root density utilizing ct scans helliwell et al 2017 helliwell et al 2019 therefore even in the absence of pressure conditions water is more likely to flow across the soil matrix along the root axis under the influence of gravity and capillary forces mair et al 2022 the roots show various structural forms such as spongy or fibrous resulting in roughness on the root surface hauber et al 2020 according to the derivation of the wenzel equation it can be found that rough surfaces can increase the hydrophilicity of the hydrophilic materials for smooth surfaces wenzel 1936 it also suggests that the simulated wall itself is hydrophilic and the actual root system has a rougher surface which results in a smaller contact angle and easier fluid flow also in the simulation we assume that the fluid is water but in reality there are root secretions consisting of polysaccharides and small amounts of lipids around the root tip carminati et al 2017 read et al 2003 ahmed et al 2016a explored the contact angle of dry mucilage collected from maize plants and found that the contact angle decreased for lower mucilage concentrations therefore the effect of root biochemistry on the inter root fluid contact angle also needs to be considered in future investigations moreover the d r determines the number of pores between root and soil particles in the cross section for a single root the larger the diameter the more soil particles come into touch with the root cross section the specific surface area of fine roots is larger than that of coarse roots at the same rad because there are more fine roots than coarse roots as a result locations with a higher density of fine roots are more likely to increase water flow because they have fine roots in contact with more soil particles at the same rad 5 conclusion the water infiltration at the field scale and the pore scale are investigated to clarify why roots promote preferential water movement the conclusions are as follows 1 both fine and coarse roots promote water infiltration the rad of fine roots is strongly correlated with dc while the number of coarse roots is more strongly correlated with dc and the density of fine roots shows a significant positive correlation with the pr fr 2 we propose three infiltration patterns in the root soil zone based on the root density and the depth obtained from the experiment grass and cultivated areas are more likely to develop uniformly shallow infiltration whereas mixed grass and irrigation or shallow rooted tree areas are more likely to form non uniformly shallow infiltration and tree areas are more likely to generate deep infiltration in addition the infiltration pattern can also be evaluated based on the results of the field root profile 3 on the pore scale there is a small difference in infiltration capacity between the root soil pore and interparticle pore under high pressure difference resulting in uniform infiltration in shallow soils while in the deep soil layer water flows more easily along the roots and at a faster rate than the water flow within the soil pores thus creating a preferential flow the present study can be considered an advancement in explaining the preferential flow of water induced by the root system from multi scale aspects credit authorship contribution statement jiaying li conceptualization methodology investigation formal analysis writing review editing peng cui conceptualization funding acquisition supervision yanzhou yin conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was funded by the second tibetan plateau scientific expedition and research no 2019qzkk0903 02 the strategic priority research program of chinese academy of sciences no xda23090303 the national key research and development program of china 2022yfc3002902 
1707,geothermal springs are controlled by deep faults which are the major causes of earthquakes a series of geochemical indicators of hot springs such as carbon dioxide content co2 carbon isotope and noble gas isotope etc have been used for earthquake monitoring and early warning at home and abroad given that previous studies have failed to establish an inevitable link between the carbon isotopic variations of hot springs and seismic activities in this study mass spectrometry techniques were used to analyze the carbon isotopes of gaseous co2 and noble gas isotope in hot springs thermal water and newly formed travertines from western sichuan before and after an ms4 8 earthquake i e 7 14 earthquake the results showed that the carbon isotope level of the hot spring system increased significantly before the earthquake i e δ13cco2 2 to 3 3 δ13cdic 2 2 to 6 6 dic dissolved inorganic carbon in geothermal water r ra 0 90 1 83 and δ13ctravertine 1 76 to 5 75 these indicators decreased markedly 1 week after the earthquake whereas the helium isotope ratio of r ra did not exhibit a noticeable change δ13cco2 3 9 to 0 4 δ13cdic 1 6 to 4 1 r ra 0 68 1 87 combined with previous thermodynamic calculation and experimental results on carbon isotope fractionation of the co2 calcium carbonate system we suggest that the high carbon isotope characteristics of hot springs are caused by carbon isotope fractionation following the release of co2 from fault carbonate decomposition owing to tectonic activity not by a mixture of different carbon sources a high carbon isotopic delivery path in geothermal water from released co2 to dic and then to travertine was observed the new mechanism proposed in this paper reveals the intrinsic relations between the changes of the hot spring geochemical properties and deep tectonic activities and the variations of these geochemical parameters before and after earthquakes may assist in capturing seismic precursors a post peak earthquake warning model has thus been preliminarily proposed however long term monitoring data are required to reduce some uncertainties keywords geothermal springs geochemical parameter variations seismic precursors post peak earthquake warning western sichuan abbreviations xshf xianshuihe fault lmsf longmenshan fault anhf anninghe fault ylgs yulingong hot spring swarm edqs erdaoqiao hot spring swarm zgs zhonggu hot spring swarm dic dissolved inorganic carbon in hot springs lcogr lanzhou center of oil and gas resources vpdb vienna pee dee belemnite gc gas chromatograph asw air saturated water ms mass spectrometer ms4 8 earthquake occurred on july 14 2021 in western sichuan china 7 14 earthquake ms6 8 earthquake on september 05 2022 in luding western sichuan china 9 05 main shock percentage content of co2 in the gas components of hot springs x co2 data availability the authors are unable or have chosen not to specify which data has been used 1 introduction the distribution of geothermal springs is spatially closely associated with faults and earthquakes which is a notable geological phenomenon chiodini et al 2004 tiwari et al 2020 toutain and baubron 1999 most geothermal springs are controlled by deep faults which are the major causes of tectonic earthquakes examples of widely known geothermal and seismically active regions include the north anatolian fault zone in northern turkey de leeuw et al 2010 san andreas fault in california usa wiersberg and erzinger 2008 matsushiro and nojima faults in japan cappa et al 2009 famin et al 2008 and central italy chiodini et al 2004 2020 chiocchini et al 2010 franchini et al 2021 the spatially close relationship between geothermal springs and earthquakes is owing to their connection through tectonic activity in recent decades theoretical research sulem et al 2009 laboratory experiments boschetti et al 2022 chen et al 2019 de paola et al 2011 han et al 2007 hu et al 2019 kim et al 2021 rempe et al 2020 and geological observations chiodini et al 2004 franchini et al 2021 perrier et al 2009 tedesco and scarsi 1999 yan et al 2015 have shown that degassing caused by fault friction heating can weaken carbonate faults trigger earthquakes and accelerate their propagation franchini et al 2021 boschetti et al 2022 causing numerous aftershocks famin et al 2008 miller et al 2004 during the earthquake process gases such as hg rn he and its isotope ratios co2 and h2 are released into geothermal springs groundwater and soil along active fault zones carrying a wealth of deep tectonic and seismic precursor information li et al 2022 and references therein perrier et al 2009 ramola et al 2008 toutain and baubron 1999 tsunogai and wakita 1995 walia et al 2005 walia et al 2009 seismic activities can be recorded in hot springs via mechanothermal isotope effects kim et al 2021 which serve as an indicator for monitoring and forecasting earthquakes some earthquakes have been successfully predicted using geochemical indicators of geothermal springs or monitoring wells bapwщaл 1989 liu et al 2006 tedesco and scarsi 1999 however the multi carbon source mixing model commonly used in previous studies tian et al 2018 zhou 2011 zhou et al 2015 zhou et al 2017 zhang et al 2021 cannot reasonably explain the carbon isotope characteristics of hot springs thus failing to establish an inevitable link between the carbon isotopic variations and seismic activities the suggestion of preferential release of 12co2 to the atmosphere also cannot explain the high carbon isotope characteristics of co2 mohammadzadeh and daneshvar 2020 based on observations of the high carbon isotope of the paleo travertine of the hot springs in western sichuan we preliminarily proposed the connection between hot spring carbon isotope characteristics and deep tectonic activity shi et al 2014 the specific carbon isotopic formation mechanism and transmission paths are yet to be explored in fact researchers who unconsciously use co2 and its isotopic variations as seismic monitoring indicators do not fully understand the internal link to address the issues mentioned above we acquired gas thermal water and newly formed travertine samples from the kangding geothermal spring swarm in west sichuan and obtained chemical and isotopic datasets before and after the 7 14 earthquake the observation results were then used to discuss the formation mechanism of carbon isotopes in hot springs their variation during pre syn and post seismicity and their potential implications as geochemical proxies in earthquake monitoring and early warning 2 geological setting the geology of western sichuan which is located in southwestern china between the tibetan plateau and the sichuan basin is the product of episodic uplift and growth of the tibetan plateau caused by the india asian collision from the neogene to the present wang and burchfiel 2000 wang et al 2008 and references therein wang et al 2017 comprising a y shaped fault system consisting of three regional deep faults the longmenshan fault lmsf xianshuihe fault xshf and anninghe fault anhf the region represents the boundary between the two geological units fig 1 a the typical kangding geothermal field located at the joint of the three faults is primarily controlled by the xshf fig 1b the xshf an approximately 300 km long left lateral strike slip fault that dips abruptly by 70 80 to the northeast is a major structural boundary that accommodates the clockwise rotation of crustal rocks between the eastern himalayan syntaxis and south china block and has a total displacement of approximately 60 km wang and burchfiel 2000 xu and kamp 2000 zhang et al 2017 its development was accompanied by rapid exhumation of the gongga batholith in the southeastern tibetan plateau from approximately 9 ma to the early pliocene approximately 4 ma zhang et al 2017 since 1700 there have been 17 earthquakes of magnitudes above 7 as well as 29 earthquakes of magnitudes above 6 5 along the xshf zone bai et al 2022 the epicenter of the devastating ms8 0 wenchuan earthquake in the lmsf in 2008 was 300 km away from kangding approximately 50 km north of moxi which is known for its geothermal springs and being the location where the three fault zones intersect the sampling sites in this study are shown in fig 1b seismicity relocation and interferometric synthetic aperture radar monitoring recorded over 1000 earthquakes in the northwest xshf from november 22 to 29 2014 indicating that the xshf is still active allen et al 1991 bai et al 2018 2022 deng et al 2003 jiang et al 2015 wen et al 2008 zhang 2013 the geothermal springs in western sichuan are distributed linearly from the east to west along three large roughly nw se trending strike slip fault zones xshf garze litang and jinshajiang liu et al 2022 tang et al 2017a tang et al 2017b tian et al 2018 the geothermal springs in kangding are concentrated in three locations along the xshf the yulingong hot spring swarm ylgs approximately 10 km south of the old city of kangding the erdaoqiao hot spring swarm edqs in the north of the old city and the zhonggu hot spring swarm zgs approximately 30 km north of the old city fig 2 a along the xshf 200 300 km north of kangding are the bamei daofu and luhuo hot spring swarms and the moxi hot spring swarm is 50 km south of kangding luo et al 2017 the abundance of geothermal springs along the fault zone renders it a natural laboratory for studying the relationship between hot springs and earthquakes zhou et al 2015 the xshf in kangding is composed of a few triassic lower metamorphic clastic rock deposits and late cenozoic granite and migmatite in the western portion of the f2 fault fig 2a the lithologic composition to the east of the f2 fault is relatively complex mainly including a small amount of neoproterozoic diorite some early paleozoic clastic rocks limestone marble and permian basalt fig 2a xu et al 2021 f1 and f2 are the branch faults of xshf in kangding that control the exposure of hot springs and cut through the carbonate formations in the deep where the geothermal reservoir host rocks of the kangding hot springs are located fig 2b these soluble carbonate formations are the source of massive surface travertine deposits 3 samples and analytical methods gases within hot springs thermal water and fresh travertine samples were collected from the surface geothermal spring vents of ylgs edqs and zgs fig 1b the gas samples were collected using the water displacement method and following previous procedures hilton et al 2002 sano and fischer 2013 zhang et al 2021 fresh travertine samples were collected from the exterior of hot spring pipes or the walls of warm spring swimming pools of the nearby inns to rule out the paleo travertine contamination the chemical compositions helium isotope ratios and δ13cco2 dic values of the gas and water samples were analyzed at the lanzhou center of oil and gas resources lcogr chinese academy of science china the 3he 4he values r were reported relative to air 3he 4he ra 1 39 10 6 ozima and podosek 2002 the carbon isotopes of co2 were reported as δ13c values relative to the international standard vienna pee dee belemnite vpdb the components of the geothermal spring gas samples were analyzed at the lcogr using a finnigan mat 271 mass spectrometer ms thermo finnigan bremen germany repeated analysis of the air standard yielded an analytical error of less than 2 for major species such as co2 n2 and o2 the noble gas isotopic ratios were analyzed using a noblesse noble gas ms nu instruments uk equipped with a two stage gas separation line and purification system air from the top of the local gaolan hill in lanzhou was used as the laboratory standard 3he 4he 1 39 10 6 the detailed analytical conditions and procedures were in accordance with those described by zhang et al 2021 the carbon isotopes of co2 were analyzed using a gas chromatograph gc trace 1310 gas chromatograph coupled with a thermo delta v advantage ms the chromatographic column was plot q 30 m 0 53 mm 40 µm with an inlet temperature of 200 c a start temperature of 40 c for 3 min a heating rate of 15 c min to 230 c that was maintained for 20 min a flow rate of 3 0 ml min and a split rate of 1 6 a mixture of ch4 c2h6 and c3h9 gbw04480 or ng3 was used as the standard material for each cycle of sample analysis dai et al 2012 the average reproducibility of the gc ms analysis was better than 0 5 for natural gas standards li et al 2014 the fresh travertine carbon isotopes were determined at the geochemical laboratory at the chengdu university of technology using a mat 253 ms thermo fisher us equipped with a gasbench ii and gc pal automatic injection system the travertine sample powders were submerged in 100 phosphoric acid at 25 c for 48 h for co2 release calcite gbw04405 a national standard material was used to calibrate the results the results were reported with a precision of 0 02 relative to the vpdb standard carbon isotope analysis of dissolved inorganic carbon dic in geothermal spring water was performed at the beijing research institute of uranium geology the analytical instrument is the same as the mat 253 at the geochemical laboratory of the chengdu university of technology in each cycle five drops of pure phosphoric acid were added to a 12 ml headspace bottle before blowing 99 999 he gas into the bottle for 300 s at a flow rate of 300 ml min with a syringe of gc pal to remove air subsequently 0 4 ml of spring water was added to the bottle and ultrasonic vibration was applied for 10 min to thoroughly mix the acid and sample the released co2 was purified using an h2o molecular sieve and the mixture of co2 and he was loaded into the ms using a 70 c gc column to ensure that all the dic in the water was completely converted into co2 the final glass bottle was kept in an acidic environment to calibrate the results lithium carbonate reference material of international atomic energy agency iaea lsvec lico3 iaea 603 caco3 and gbw04416 china s national standard material caco3 were used as standard materials the repeated analytical error was approximately 0 2 4 results 4 1 gas geochemistry of geothermal springs the hot spring gas samples from ylgs edqs and zgs were analyzed for their major gas components including co2 n2 and o2 and their percentages in vol are listed in table 1 4 1 1 percentage content of co2 in the gas components of hot springs x co2 as shown in table 1 the main components of geothermal gases are co2 n2 and o2 the x co2 at each spring site increased significantly after the earthquake compared to pre earthquake values fig 3 4 1 2 carbon isotopes of co2 the carbon isotopes of gaseous co2 reported as δ13cco2 versus vpdb of nine samples before the earthquake ranged from 2 to 3 3 with an average of 0 61 and the corresponding values after the earthquake varied from 3 9 to 5 8 with an average of 1 48 table 1 the findings show two significant characteristics 1 when compared with the isotopic features of atmospheric co2 7 to 10 mantle carbon 5 to 7 marine carbonate approximately 0 with a fluctuation range of 3 and organic carbon 20 hoefs 2018 gaseous co2 from the geothermal springs of kangding had considerably high carbon isotope values and 2 with the exception of one sample from zgs with high carbon isotopes after the earthquake the gaseous co2 isotopic values before the earthquake were higher than that after the earthquake fig 4 4 2 carbon isotopes of dissolved inorganic carbon dic in geothermal springs the temperature and ph of the geothermal springs were measured in the field table 2 thermal water samples from the three geothermal spring swarms of kangding were collected thrice in august and november 2020 and july 2021 the carbon isotope values of dic are listed in table 2 before the earthquake the δ13cdic ranged from 2 5 to 6 6 with an average of 3 91 in august 2020 from 2 2 to 5 5 with an average of 3 65 in november 2020 and from 1 6 to 4 1 with an average of 2 88 in july 2021 after the earthquake likewise the δ13cdic values were elevated before the earthquake ranging from 2 2 to 6 6 table 2 the δ13cdic of the hot springs before the earthquake was higher than that after the earthquake fig 5 4 3 carbon isotopes of fresh travertine fresh travertine differs from paleo travertine in geologic history because it forms in a matter of weeks to months and is commonly deposited near hot spring vents swimming pools of inns and pipe walls we collected and analyzed 17 fresh travertine samples from seven spring vents and nearby areas the results showed high carbon isotope characteristics ranging from 1 76 to 5 75 with a majority exceeding 3 table 3 as is well known the carbon isotope of marine carbonate generally does not exceed 3 similar to the carbon isotopes of the hot springs the travertine formed recently also showed high carbon isotope characteristics 4 4 helium isotopes the measured 3he 4he values of geothermal gases were corrected in terms of air saturated water asw and pure air according to methods used in previous studies craig et al 1978 hilton 1996 table 1 shows the relative ratios of the measured sample values r to air values ra the r ra values ranging from 0 86 to 1 94 indicate the involvement of mantle he anderson 2000 there was no significant change in the r ra ratio before and after the 7 14 earthquake fig 6 5 discussion 5 1 genesis of high carbon isotopic geothermal spring systems the heavy carbon isotope characteristics of gaseous co2 dic and travertine in the kangding geothermal spring system are typical of hot springs along the xshf and lmsf zones in western sichuan du et al 2006 guo et al 2017 shi et al 2014 zhou et al 2015 as well as other tectonically active regions worldwide bräuer et al 2008 de leeuw et al 2010 perrier et al 2009 shi et al 2014 tiwari et al 2020 zhou et al 2015 mohammadzadeh and daneshvar 2020 reported considerably high carbon isotopic values in the warm springs from northeastern iran and southwestern turkey with δ13cdic 10 4 and 7 2 and δ13cco2 1 5 and 1 8 respectively iran and turkey are both typical regions prone to earthquake and rich in hot spring resources located on the eurasian seismic belt and turkey recently experienced an ms7 8 earthquake that killed over 40 000 people on february 6 2023 firuzi et al 2020 hall 2023 komut and baysal 2022 therefore it is necessary to understand the reason for the high carbon isotope characteristics of the hot springs in seismically active regions understanding the correlation is highly relevant for monitoring tectonic activity using hot springs some researchers have claimed that hot spring inorganic carbon reservoirs represent a mixture of a variety of carbon inventories such as the mantle magma atmosphere and surface organic or inorganic carbon du et al 2006 tian et al 2018 xu et al 2021 zhang et al 2021 zhou et al 2015 zhou et al 2016 zhou et al 2017 however the carbon isotope levels of these reservoirs are much lower than that of geothermal water fig 7 and irrespective of the mixing the high carbon isotope feature in hot springs cannot be generated the high carbon isotope characteristics of hot springs may result from the preferential release of 12co2 during carbonate decomposition mohammadzadeh and daneshvar 2020 however this does not explain the high carbon isotope characteristics of the released co2 itself we previously investigated 106 paleo travertine samples from the lmsf and xshf zones in western sichuan and found abnormally high carbon isotopes δ13c 4 to 8 which suggested that these travertines with a heavy carbon isotope were geochemical signals of paleo tectonic activity or paleo seismicity shi et al 2014 however in our previous study we did not identify the path and formation mechanism of this travertine in the present study after systematically collecting and analyzing carbon isotopes of co2 dic and newly formed travertine in geothermal water we finally determined the origin of high carbon isotope signals and the transmission path from co2 to dic and then to travertine which can be expressed using the following chemical equations 1 cac o 3 δ c a o c o 2 t h e r m a l d e c o m p o s i t i o n c a c o 3 13 c 12 c c o 2 2 c o 2 h 2 o h 2 c o 3 h y d r a t i o n c o 2 13 c 12 c h 2 c o 3 3 h2co3 h hco3 h co3 2 4 ca2 co3 2 caco3 travertine precipitation eq 1 shows the first substantial carbon isotope fractionation procedure that increases the carbon isotopic ratios of co2 in the geothermal water during the tectonically thermal decomposition of carbonate fig 8 the high temperature required for the thermal decomposition of carbonate originates from the frictional heating of the fault planes during the earthquake gestation phase hirono et al 2014 hu et al 2019 kuo et al 2011 thermodynamic calculations have long demonstrated that the emission co2 is enriched in 13c during the high temperature greater than200 c water rock reaction process between co2 and the host carbonate bottinga 1969 a related laboratory experiment also showed that the equilibrium fractionation of co2 and caco3 reached its maximum at temperatures ranging from 425 to 550 c with δ co2 caco3 showing the largest value of 3 7 chacko et al 1991 experimental studies and geological observations over the last decade have repeatedly confirmed that co2 produced by the thermal decomposition of carbonate caused by fault frictional heating has extremely heavy carbon isotope characteristics chiodini et al 2020 and references therein de paola et al 2011 other studies have proven that a large amount of co2 generated by carbonate decomposition and stored underground commonly trigger numerous aftershocks famin et al 2008 kim et al 2021 miller et al 2004 eq 2 represents the second significant carbon isotope fractionation procedure as co2 dissolves in geothermal water which increases the carbon isotopic ratios of hot spring dic to between 7 and 9 deuser and degens 1967 emrich et al 1970 wendt 1968 therefore the carbon isotope level of the hot spring dic was higher than that of gaseous co2 in the present study fig 7 no evident carbon isotope fractionation is indicated in eqs 3 and 4 deuser and degens 1967 emrich et al 1970 wendt 1968 the above path and mechanism thoroughly explain the observation results of this study and why the carbon isotope values of gaseous co2 in the hot spring are much higher than that of atmospheric co2 but evidently lower than that of inorganic carbon of the hot spring water fig 7 therefore the high carbon isotopic characteristics of the geothermal spring are not the result of a simple mixing of a variety of carbon reservoirs instead they are derived from the mechanothermal decomposition of the fault carbonate and subsequent carbon isotope fractionation during water rock reaction processes which is closely related to deep tectonic activity thus forming the basis of using hot springs to monitor seismic activity 5 2 remarkable variations of x co2 r ra and δ13cco2 dic before and after earthquakes we identified a high carbon isotopic signature from the gaseous co2 dic and fresh travertine in kangding in august and november 2020 before the 7 14 earthquake tables 1 3 the carbon isotope values of the gaseous co2 dic and travertine samples were significantly lower 3 days after the 7 14 earthquake figs 4 and 5 whereas the noble isotopes showed no significant change fig 6 and the x co2 showed an increasing rather than a decreasing trend fig 3 previous monitoring of hot springs in western sichuan following the wenchuan ms8 0 earthquake revealed that the change patterns of these geochemical indicators after the earthquake were similar to that of the current earthquake more specifically the values of δ13cco2 dic and r ra gradually decreased but the x co2 increased 4 months later zhou et al 2015 this trend has also been reported by the national academy of sciences of the former soviet union which continuously monitored hot spring and deep well geochemistry in central asia from the 1960 s onward bapwщaл 1989 gao et al 2018 moreover they successfully predicted several earthquakes using regular changes in geochemical parameters before and after earthquakes bapwщaл 1989 however for practical early earthquake warning in western sichuan subsequent long term monitoring is needed to summarize the regularity of changes of the parameters before and after earthquakes and thereby reduce uncertainties of the warning model 5 3 noble gas isotopes in geothermal springs an indication of deep tectonic activity the noble gas isotopic ratio of 3he 4he of hot springs is considered a reliable geochemical indicator for determining origin depth of tectonic activity in the earth o nions and oxburgh 1988 ozima and podosek 2002 it is also one of the most widely used geochemical indicators for earthquake monitoring and prediction worldwide bapwщaл 1989 doğan et al 2009 gao et al 2018 tedesco and scarsi 1999 the r ra parameter was greater than 1 in most spring sites in kangding indicating the presence of mantle materials table 1 based on the method of duchkov et al 2010 the contribution of mantle derived helium was estimated to be between 10 and 20 fig 6 the results show that the helium index did not differ significantly before and after the 7 14 earthquake fig 6 previous monitoring results for hot springs in western sichuan at 1 month 5 months and 1 year after the devastating ms8 0 wenchuan earthquake revealed that when compared to that of the lmsf and anhf zones the xshf zone had a higher contribution rate of mantle derived helium comprising up to 40 and gradually decreasing after the earthquake zhou 2011 r ra appears to be related to the fault depth earthquake magnitude focal depth and other factors that must be considered when using this parameter as a precursor indicator for earthquake warning 5 4 temporal variations of geothermal spring geochemical parameters during earthquakes and their implications for seismic monitoring and warning the hydrochemistry and isotope geochemistry of geothermal springs have been used to monitor and forecast earthquakes worldwide for decades chiodini et al 2004 2020 de leeuw et al 2010 farmin et al 2008 perrier et al 2009 su et al 2022 tedesco and scarsi 1999 toutain and baubron 1999 zheng et al 2013 zhou et al 2015 geothermal fluid monitoring is superior to soil and groundwater systems because hot spring gases are considerably more enriched in deep gases but slightly contaminated by atmospheric gases toutain and baubron 1999 notably carbon isotope proxies of hot springs are more sensitive to tectonic activity and earthquakes than other geochemical indicators two successful earthquake predictions in central asia by the national academy of sciences of the former soviet union were based on co2 isotope measurements of local geothermal springs and monitoring wells bapwщaл 1989 gao et al 2018 the x co2 in hot spring gas is also an important geochemical indicator for example the national academy of sciences of the former soviet union noted in the 1970 s that low co2 concentrations in deep well gases strongly correlated with the occurrence of large earthquakes using x co2 and he as indicators they successfully predicted the ms7 0 alai earthquake 6 h in advance fig 9 a similarly based on the observation of low co2 content relative to the baseline in the longtougou and erdaoqiao hot springs in kangding for decades the kangding seismic observation station of the sichuan seismological bureau concluded that when co2 emission gas in hot springs is less than 90 vol moderate or strong earthquakes are likely to occur within 1 month and a 300 km radius around the hot spring location based on these observations they successfully predicted the ms5 5 baiyu batang earthquake on december 21 2006 liu et al 2006 however more sensitive carbon isotope indicators such as δ13cco2 dic have not been used for local earthquake prediction in western sichuan scholars have paid minimal attention to the patterns of geothermal spring geochemical parameter responses to earthquake propagation while monitoring the 7 14 earthquake we focused on the changes in the geochemical parameters of the hot spring before and after the earthquake as well as the temporal variation of the parameters as the earthquake progressed the results show that earthquakes occurred when the parameter values were at their lowest rather than at the highest earthquakes commonly occurred when δ13cco2 dic falls from the peak to a low value near the baseline whereas x co2 increased from the lowest value to its baseline values here referred to as the post peak seismic pattern fig 9 our findings for kangding combined with other successful monitoring records worldwide bapwщaл 1989 gao et al 2018 tedesco and scarsi 1999 confirm the universality of post peak patterns in earthquake processes fig 9 long term monitoring of major anions and cations such as na ca2 mg2 cl and so4 2 in hot springs in china shows that their concentrations follow similar pre earthquake high anomaly patterns du et al 2010 and references therein yan et al 2015 as carbon isotopes however there was a post earthquake peak anomaly of cl after the 1995 kobe earthquake tsunogai and wakita 1995 when considering the corresponding carbon isotope levels of hot springs at the moment of earthquake occurrence as shown in fig 9b and 9c respectively the carbon isotope level of the kangding hot spring was still elevated δ13cco2 dic 0 704 1 week after the 7 14 earthquake but was not approaching the local baseline approximately 3 to 5 during the quiescence period fig 9c this may imply that the 7 14 earthquake was only a small scale energy release and that larger scale energy releases could occur in the future as expected an ms6 1 earthquake in yaan and an ms6 0 earthquake in maerkang occurred along the xshf in june 2022 at the time of writing this paper three months later the ms6 8 luding earthquake struck moxi 50 km south of kangding on september 5 2022 9 05 main shock fig 1b causing severe damage from this perspective the 7 14 earthquake in 2021 can be seen as a prelude and warning to the series of earthquakes in western sichuan during the past two years although the post peak seismic pattern has been repeatedly observed in past earthquake monitoring and the 7 14 earthquake essentially warned of the 9 05 series of earthquakes these findings do not necessarily indicate that the pattern can be directly used as an earthquake warning signal in daily earthquake monitoring this is because the abrupt elevations of carbon isotopes in hot springs may not consistently be followed by earthquake seismic readings in addition the durations of earthquake precursors are related to multiple factors such as magnitude focal depth and epicenter distance the interval between the pre earthquake 7 14 earthquake and the 9 05 main shock was approximately 1 year whereas the intervals in other regions of the world ranged from a few days to several months bapwщaл 1989 tedesco and scarsi 1999 our carbon isotope monitoring of the hot springs in western sichuan after the 9 05 earthquake unpublished data showed that when two earthquakes with similar magnitudes were separated for a short interval within 1 month the carbon isotope peak before the subsequent earthquake was not significant these parameter changes were associated with many uncertainties including magnitude focal depth epicenter distance and earthquake occurrence mode bapwщaл 1989 toutain and baubron 1999 bräuer et al 2008 moreover multiple factors related to carbon isotope fractionation such as temperature pressure and water rock ratio may also be affecting the type of imminent patterns of hot spring carbon isotopes that we are currently observing therefore multi parameter and long term monitoring should aid us in obtaining statistical regularity and reduce the interference of contingency on earthquake early warning the he co2 system of geothermal springs is a geochemical proxy currently used to trace deep tectonic activity de leeuw et al 2010 du et al 2006 italiano et al 2009 and references therein li et al 2022 tian et al 2021 zhou et al 2015 however the monitoring results of this study show that the r ra indicator is insensitive to small and medium earthquakes which may be due to focal depth in western sichuan the combination of x co2 and δ13cco2 dic is more suitable for small and medium sized earthquakes than noble gas owing to the economic and time costs of earthquake monitoring another noteworthy observation is that in contrast to δ13cco2 dic x co2 and δ18oco2 exhibit anti phase changes during earthquakes fig 9a b which may be related to the amount of co2 released during the process shi et al 2014 as well as the different fractionation mechanism of oxygen isotopes as co2 is dissolved into water vogel et al 1970 6 conclusions the high carbon isotope characteristics of the hot spring system in western sichuan result from the decomposition of fault carbonate induced by deep tectonic activity and fractionation of carbon isotopes during the water rock reactions rather than the mixing of different carbon reservoirs the sudden elevation of the carbon isotope level δ13cco2 dic before the earthquake is a response to the enhanced deep tectonic activity other geochemical parameters such as x co2 also showed marked variations but r ra had no marked variations before and after the earthquake the post peak seismic pattern is currently not a practical tool that can be directly applied to earthquake warning multi parameter and long term monitoring to reduce contingency impacts on the post peak warning model is an effective strategy based on the geochemical observations of hot springs future studies on thermodynamic calculation and experimental simulation are needed to enhance our understanding of the details of water rock reaction and carbon isotopes fractionation credit authorship contribution statement jinlong liang conceptualization formal analysis investigation methodology visualization writing original draft yi yu data curation visualization resources software zeming shi funding acquisition resources validation supervision writing review editing zhipeng li resources validation yi huang software project administration hao song supervision funding acquisition jinyong xu software visualization validation xinyu wang supervision funding acquisition xiaocheng zhou investigation validation luyu huang software visualization zebin luo software visualization jue tong funding acquisition investigation wei zhai supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the jiangxi province key research and development project no 20203bbg72w011 the science and technology research project of jiangxi geological bureau no 2021aa07 and the everest scientific research program of chengdu university of technology no 80000 2022zf11419 we thank dr xun huang and yunhui zhang for their field assistance and dr chunhui cao and lantian xing of the lanzhou center of oil and gas resources chinese academy of science china for their help with analytical techniques of helium isotopes we also thank master student xinyi he of key laboratory of applied nuclear techniques in geoscience sichuan for her help in completing the carbon isotope analysis of some gas and spring water samples 
1707,geothermal springs are controlled by deep faults which are the major causes of earthquakes a series of geochemical indicators of hot springs such as carbon dioxide content co2 carbon isotope and noble gas isotope etc have been used for earthquake monitoring and early warning at home and abroad given that previous studies have failed to establish an inevitable link between the carbon isotopic variations of hot springs and seismic activities in this study mass spectrometry techniques were used to analyze the carbon isotopes of gaseous co2 and noble gas isotope in hot springs thermal water and newly formed travertines from western sichuan before and after an ms4 8 earthquake i e 7 14 earthquake the results showed that the carbon isotope level of the hot spring system increased significantly before the earthquake i e δ13cco2 2 to 3 3 δ13cdic 2 2 to 6 6 dic dissolved inorganic carbon in geothermal water r ra 0 90 1 83 and δ13ctravertine 1 76 to 5 75 these indicators decreased markedly 1 week after the earthquake whereas the helium isotope ratio of r ra did not exhibit a noticeable change δ13cco2 3 9 to 0 4 δ13cdic 1 6 to 4 1 r ra 0 68 1 87 combined with previous thermodynamic calculation and experimental results on carbon isotope fractionation of the co2 calcium carbonate system we suggest that the high carbon isotope characteristics of hot springs are caused by carbon isotope fractionation following the release of co2 from fault carbonate decomposition owing to tectonic activity not by a mixture of different carbon sources a high carbon isotopic delivery path in geothermal water from released co2 to dic and then to travertine was observed the new mechanism proposed in this paper reveals the intrinsic relations between the changes of the hot spring geochemical properties and deep tectonic activities and the variations of these geochemical parameters before and after earthquakes may assist in capturing seismic precursors a post peak earthquake warning model has thus been preliminarily proposed however long term monitoring data are required to reduce some uncertainties keywords geothermal springs geochemical parameter variations seismic precursors post peak earthquake warning western sichuan abbreviations xshf xianshuihe fault lmsf longmenshan fault anhf anninghe fault ylgs yulingong hot spring swarm edqs erdaoqiao hot spring swarm zgs zhonggu hot spring swarm dic dissolved inorganic carbon in hot springs lcogr lanzhou center of oil and gas resources vpdb vienna pee dee belemnite gc gas chromatograph asw air saturated water ms mass spectrometer ms4 8 earthquake occurred on july 14 2021 in western sichuan china 7 14 earthquake ms6 8 earthquake on september 05 2022 in luding western sichuan china 9 05 main shock percentage content of co2 in the gas components of hot springs x co2 data availability the authors are unable or have chosen not to specify which data has been used 1 introduction the distribution of geothermal springs is spatially closely associated with faults and earthquakes which is a notable geological phenomenon chiodini et al 2004 tiwari et al 2020 toutain and baubron 1999 most geothermal springs are controlled by deep faults which are the major causes of tectonic earthquakes examples of widely known geothermal and seismically active regions include the north anatolian fault zone in northern turkey de leeuw et al 2010 san andreas fault in california usa wiersberg and erzinger 2008 matsushiro and nojima faults in japan cappa et al 2009 famin et al 2008 and central italy chiodini et al 2004 2020 chiocchini et al 2010 franchini et al 2021 the spatially close relationship between geothermal springs and earthquakes is owing to their connection through tectonic activity in recent decades theoretical research sulem et al 2009 laboratory experiments boschetti et al 2022 chen et al 2019 de paola et al 2011 han et al 2007 hu et al 2019 kim et al 2021 rempe et al 2020 and geological observations chiodini et al 2004 franchini et al 2021 perrier et al 2009 tedesco and scarsi 1999 yan et al 2015 have shown that degassing caused by fault friction heating can weaken carbonate faults trigger earthquakes and accelerate their propagation franchini et al 2021 boschetti et al 2022 causing numerous aftershocks famin et al 2008 miller et al 2004 during the earthquake process gases such as hg rn he and its isotope ratios co2 and h2 are released into geothermal springs groundwater and soil along active fault zones carrying a wealth of deep tectonic and seismic precursor information li et al 2022 and references therein perrier et al 2009 ramola et al 2008 toutain and baubron 1999 tsunogai and wakita 1995 walia et al 2005 walia et al 2009 seismic activities can be recorded in hot springs via mechanothermal isotope effects kim et al 2021 which serve as an indicator for monitoring and forecasting earthquakes some earthquakes have been successfully predicted using geochemical indicators of geothermal springs or monitoring wells bapwщaл 1989 liu et al 2006 tedesco and scarsi 1999 however the multi carbon source mixing model commonly used in previous studies tian et al 2018 zhou 2011 zhou et al 2015 zhou et al 2017 zhang et al 2021 cannot reasonably explain the carbon isotope characteristics of hot springs thus failing to establish an inevitable link between the carbon isotopic variations and seismic activities the suggestion of preferential release of 12co2 to the atmosphere also cannot explain the high carbon isotope characteristics of co2 mohammadzadeh and daneshvar 2020 based on observations of the high carbon isotope of the paleo travertine of the hot springs in western sichuan we preliminarily proposed the connection between hot spring carbon isotope characteristics and deep tectonic activity shi et al 2014 the specific carbon isotopic formation mechanism and transmission paths are yet to be explored in fact researchers who unconsciously use co2 and its isotopic variations as seismic monitoring indicators do not fully understand the internal link to address the issues mentioned above we acquired gas thermal water and newly formed travertine samples from the kangding geothermal spring swarm in west sichuan and obtained chemical and isotopic datasets before and after the 7 14 earthquake the observation results were then used to discuss the formation mechanism of carbon isotopes in hot springs their variation during pre syn and post seismicity and their potential implications as geochemical proxies in earthquake monitoring and early warning 2 geological setting the geology of western sichuan which is located in southwestern china between the tibetan plateau and the sichuan basin is the product of episodic uplift and growth of the tibetan plateau caused by the india asian collision from the neogene to the present wang and burchfiel 2000 wang et al 2008 and references therein wang et al 2017 comprising a y shaped fault system consisting of three regional deep faults the longmenshan fault lmsf xianshuihe fault xshf and anninghe fault anhf the region represents the boundary between the two geological units fig 1 a the typical kangding geothermal field located at the joint of the three faults is primarily controlled by the xshf fig 1b the xshf an approximately 300 km long left lateral strike slip fault that dips abruptly by 70 80 to the northeast is a major structural boundary that accommodates the clockwise rotation of crustal rocks between the eastern himalayan syntaxis and south china block and has a total displacement of approximately 60 km wang and burchfiel 2000 xu and kamp 2000 zhang et al 2017 its development was accompanied by rapid exhumation of the gongga batholith in the southeastern tibetan plateau from approximately 9 ma to the early pliocene approximately 4 ma zhang et al 2017 since 1700 there have been 17 earthquakes of magnitudes above 7 as well as 29 earthquakes of magnitudes above 6 5 along the xshf zone bai et al 2022 the epicenter of the devastating ms8 0 wenchuan earthquake in the lmsf in 2008 was 300 km away from kangding approximately 50 km north of moxi which is known for its geothermal springs and being the location where the three fault zones intersect the sampling sites in this study are shown in fig 1b seismicity relocation and interferometric synthetic aperture radar monitoring recorded over 1000 earthquakes in the northwest xshf from november 22 to 29 2014 indicating that the xshf is still active allen et al 1991 bai et al 2018 2022 deng et al 2003 jiang et al 2015 wen et al 2008 zhang 2013 the geothermal springs in western sichuan are distributed linearly from the east to west along three large roughly nw se trending strike slip fault zones xshf garze litang and jinshajiang liu et al 2022 tang et al 2017a tang et al 2017b tian et al 2018 the geothermal springs in kangding are concentrated in three locations along the xshf the yulingong hot spring swarm ylgs approximately 10 km south of the old city of kangding the erdaoqiao hot spring swarm edqs in the north of the old city and the zhonggu hot spring swarm zgs approximately 30 km north of the old city fig 2 a along the xshf 200 300 km north of kangding are the bamei daofu and luhuo hot spring swarms and the moxi hot spring swarm is 50 km south of kangding luo et al 2017 the abundance of geothermal springs along the fault zone renders it a natural laboratory for studying the relationship between hot springs and earthquakes zhou et al 2015 the xshf in kangding is composed of a few triassic lower metamorphic clastic rock deposits and late cenozoic granite and migmatite in the western portion of the f2 fault fig 2a the lithologic composition to the east of the f2 fault is relatively complex mainly including a small amount of neoproterozoic diorite some early paleozoic clastic rocks limestone marble and permian basalt fig 2a xu et al 2021 f1 and f2 are the branch faults of xshf in kangding that control the exposure of hot springs and cut through the carbonate formations in the deep where the geothermal reservoir host rocks of the kangding hot springs are located fig 2b these soluble carbonate formations are the source of massive surface travertine deposits 3 samples and analytical methods gases within hot springs thermal water and fresh travertine samples were collected from the surface geothermal spring vents of ylgs edqs and zgs fig 1b the gas samples were collected using the water displacement method and following previous procedures hilton et al 2002 sano and fischer 2013 zhang et al 2021 fresh travertine samples were collected from the exterior of hot spring pipes or the walls of warm spring swimming pools of the nearby inns to rule out the paleo travertine contamination the chemical compositions helium isotope ratios and δ13cco2 dic values of the gas and water samples were analyzed at the lanzhou center of oil and gas resources lcogr chinese academy of science china the 3he 4he values r were reported relative to air 3he 4he ra 1 39 10 6 ozima and podosek 2002 the carbon isotopes of co2 were reported as δ13c values relative to the international standard vienna pee dee belemnite vpdb the components of the geothermal spring gas samples were analyzed at the lcogr using a finnigan mat 271 mass spectrometer ms thermo finnigan bremen germany repeated analysis of the air standard yielded an analytical error of less than 2 for major species such as co2 n2 and o2 the noble gas isotopic ratios were analyzed using a noblesse noble gas ms nu instruments uk equipped with a two stage gas separation line and purification system air from the top of the local gaolan hill in lanzhou was used as the laboratory standard 3he 4he 1 39 10 6 the detailed analytical conditions and procedures were in accordance with those described by zhang et al 2021 the carbon isotopes of co2 were analyzed using a gas chromatograph gc trace 1310 gas chromatograph coupled with a thermo delta v advantage ms the chromatographic column was plot q 30 m 0 53 mm 40 µm with an inlet temperature of 200 c a start temperature of 40 c for 3 min a heating rate of 15 c min to 230 c that was maintained for 20 min a flow rate of 3 0 ml min and a split rate of 1 6 a mixture of ch4 c2h6 and c3h9 gbw04480 or ng3 was used as the standard material for each cycle of sample analysis dai et al 2012 the average reproducibility of the gc ms analysis was better than 0 5 for natural gas standards li et al 2014 the fresh travertine carbon isotopes were determined at the geochemical laboratory at the chengdu university of technology using a mat 253 ms thermo fisher us equipped with a gasbench ii and gc pal automatic injection system the travertine sample powders were submerged in 100 phosphoric acid at 25 c for 48 h for co2 release calcite gbw04405 a national standard material was used to calibrate the results the results were reported with a precision of 0 02 relative to the vpdb standard carbon isotope analysis of dissolved inorganic carbon dic in geothermal spring water was performed at the beijing research institute of uranium geology the analytical instrument is the same as the mat 253 at the geochemical laboratory of the chengdu university of technology in each cycle five drops of pure phosphoric acid were added to a 12 ml headspace bottle before blowing 99 999 he gas into the bottle for 300 s at a flow rate of 300 ml min with a syringe of gc pal to remove air subsequently 0 4 ml of spring water was added to the bottle and ultrasonic vibration was applied for 10 min to thoroughly mix the acid and sample the released co2 was purified using an h2o molecular sieve and the mixture of co2 and he was loaded into the ms using a 70 c gc column to ensure that all the dic in the water was completely converted into co2 the final glass bottle was kept in an acidic environment to calibrate the results lithium carbonate reference material of international atomic energy agency iaea lsvec lico3 iaea 603 caco3 and gbw04416 china s national standard material caco3 were used as standard materials the repeated analytical error was approximately 0 2 4 results 4 1 gas geochemistry of geothermal springs the hot spring gas samples from ylgs edqs and zgs were analyzed for their major gas components including co2 n2 and o2 and their percentages in vol are listed in table 1 4 1 1 percentage content of co2 in the gas components of hot springs x co2 as shown in table 1 the main components of geothermal gases are co2 n2 and o2 the x co2 at each spring site increased significantly after the earthquake compared to pre earthquake values fig 3 4 1 2 carbon isotopes of co2 the carbon isotopes of gaseous co2 reported as δ13cco2 versus vpdb of nine samples before the earthquake ranged from 2 to 3 3 with an average of 0 61 and the corresponding values after the earthquake varied from 3 9 to 5 8 with an average of 1 48 table 1 the findings show two significant characteristics 1 when compared with the isotopic features of atmospheric co2 7 to 10 mantle carbon 5 to 7 marine carbonate approximately 0 with a fluctuation range of 3 and organic carbon 20 hoefs 2018 gaseous co2 from the geothermal springs of kangding had considerably high carbon isotope values and 2 with the exception of one sample from zgs with high carbon isotopes after the earthquake the gaseous co2 isotopic values before the earthquake were higher than that after the earthquake fig 4 4 2 carbon isotopes of dissolved inorganic carbon dic in geothermal springs the temperature and ph of the geothermal springs were measured in the field table 2 thermal water samples from the three geothermal spring swarms of kangding were collected thrice in august and november 2020 and july 2021 the carbon isotope values of dic are listed in table 2 before the earthquake the δ13cdic ranged from 2 5 to 6 6 with an average of 3 91 in august 2020 from 2 2 to 5 5 with an average of 3 65 in november 2020 and from 1 6 to 4 1 with an average of 2 88 in july 2021 after the earthquake likewise the δ13cdic values were elevated before the earthquake ranging from 2 2 to 6 6 table 2 the δ13cdic of the hot springs before the earthquake was higher than that after the earthquake fig 5 4 3 carbon isotopes of fresh travertine fresh travertine differs from paleo travertine in geologic history because it forms in a matter of weeks to months and is commonly deposited near hot spring vents swimming pools of inns and pipe walls we collected and analyzed 17 fresh travertine samples from seven spring vents and nearby areas the results showed high carbon isotope characteristics ranging from 1 76 to 5 75 with a majority exceeding 3 table 3 as is well known the carbon isotope of marine carbonate generally does not exceed 3 similar to the carbon isotopes of the hot springs the travertine formed recently also showed high carbon isotope characteristics 4 4 helium isotopes the measured 3he 4he values of geothermal gases were corrected in terms of air saturated water asw and pure air according to methods used in previous studies craig et al 1978 hilton 1996 table 1 shows the relative ratios of the measured sample values r to air values ra the r ra values ranging from 0 86 to 1 94 indicate the involvement of mantle he anderson 2000 there was no significant change in the r ra ratio before and after the 7 14 earthquake fig 6 5 discussion 5 1 genesis of high carbon isotopic geothermal spring systems the heavy carbon isotope characteristics of gaseous co2 dic and travertine in the kangding geothermal spring system are typical of hot springs along the xshf and lmsf zones in western sichuan du et al 2006 guo et al 2017 shi et al 2014 zhou et al 2015 as well as other tectonically active regions worldwide bräuer et al 2008 de leeuw et al 2010 perrier et al 2009 shi et al 2014 tiwari et al 2020 zhou et al 2015 mohammadzadeh and daneshvar 2020 reported considerably high carbon isotopic values in the warm springs from northeastern iran and southwestern turkey with δ13cdic 10 4 and 7 2 and δ13cco2 1 5 and 1 8 respectively iran and turkey are both typical regions prone to earthquake and rich in hot spring resources located on the eurasian seismic belt and turkey recently experienced an ms7 8 earthquake that killed over 40 000 people on february 6 2023 firuzi et al 2020 hall 2023 komut and baysal 2022 therefore it is necessary to understand the reason for the high carbon isotope characteristics of the hot springs in seismically active regions understanding the correlation is highly relevant for monitoring tectonic activity using hot springs some researchers have claimed that hot spring inorganic carbon reservoirs represent a mixture of a variety of carbon inventories such as the mantle magma atmosphere and surface organic or inorganic carbon du et al 2006 tian et al 2018 xu et al 2021 zhang et al 2021 zhou et al 2015 zhou et al 2016 zhou et al 2017 however the carbon isotope levels of these reservoirs are much lower than that of geothermal water fig 7 and irrespective of the mixing the high carbon isotope feature in hot springs cannot be generated the high carbon isotope characteristics of hot springs may result from the preferential release of 12co2 during carbonate decomposition mohammadzadeh and daneshvar 2020 however this does not explain the high carbon isotope characteristics of the released co2 itself we previously investigated 106 paleo travertine samples from the lmsf and xshf zones in western sichuan and found abnormally high carbon isotopes δ13c 4 to 8 which suggested that these travertines with a heavy carbon isotope were geochemical signals of paleo tectonic activity or paleo seismicity shi et al 2014 however in our previous study we did not identify the path and formation mechanism of this travertine in the present study after systematically collecting and analyzing carbon isotopes of co2 dic and newly formed travertine in geothermal water we finally determined the origin of high carbon isotope signals and the transmission path from co2 to dic and then to travertine which can be expressed using the following chemical equations 1 cac o 3 δ c a o c o 2 t h e r m a l d e c o m p o s i t i o n c a c o 3 13 c 12 c c o 2 2 c o 2 h 2 o h 2 c o 3 h y d r a t i o n c o 2 13 c 12 c h 2 c o 3 3 h2co3 h hco3 h co3 2 4 ca2 co3 2 caco3 travertine precipitation eq 1 shows the first substantial carbon isotope fractionation procedure that increases the carbon isotopic ratios of co2 in the geothermal water during the tectonically thermal decomposition of carbonate fig 8 the high temperature required for the thermal decomposition of carbonate originates from the frictional heating of the fault planes during the earthquake gestation phase hirono et al 2014 hu et al 2019 kuo et al 2011 thermodynamic calculations have long demonstrated that the emission co2 is enriched in 13c during the high temperature greater than200 c water rock reaction process between co2 and the host carbonate bottinga 1969 a related laboratory experiment also showed that the equilibrium fractionation of co2 and caco3 reached its maximum at temperatures ranging from 425 to 550 c with δ co2 caco3 showing the largest value of 3 7 chacko et al 1991 experimental studies and geological observations over the last decade have repeatedly confirmed that co2 produced by the thermal decomposition of carbonate caused by fault frictional heating has extremely heavy carbon isotope characteristics chiodini et al 2020 and references therein de paola et al 2011 other studies have proven that a large amount of co2 generated by carbonate decomposition and stored underground commonly trigger numerous aftershocks famin et al 2008 kim et al 2021 miller et al 2004 eq 2 represents the second significant carbon isotope fractionation procedure as co2 dissolves in geothermal water which increases the carbon isotopic ratios of hot spring dic to between 7 and 9 deuser and degens 1967 emrich et al 1970 wendt 1968 therefore the carbon isotope level of the hot spring dic was higher than that of gaseous co2 in the present study fig 7 no evident carbon isotope fractionation is indicated in eqs 3 and 4 deuser and degens 1967 emrich et al 1970 wendt 1968 the above path and mechanism thoroughly explain the observation results of this study and why the carbon isotope values of gaseous co2 in the hot spring are much higher than that of atmospheric co2 but evidently lower than that of inorganic carbon of the hot spring water fig 7 therefore the high carbon isotopic characteristics of the geothermal spring are not the result of a simple mixing of a variety of carbon reservoirs instead they are derived from the mechanothermal decomposition of the fault carbonate and subsequent carbon isotope fractionation during water rock reaction processes which is closely related to deep tectonic activity thus forming the basis of using hot springs to monitor seismic activity 5 2 remarkable variations of x co2 r ra and δ13cco2 dic before and after earthquakes we identified a high carbon isotopic signature from the gaseous co2 dic and fresh travertine in kangding in august and november 2020 before the 7 14 earthquake tables 1 3 the carbon isotope values of the gaseous co2 dic and travertine samples were significantly lower 3 days after the 7 14 earthquake figs 4 and 5 whereas the noble isotopes showed no significant change fig 6 and the x co2 showed an increasing rather than a decreasing trend fig 3 previous monitoring of hot springs in western sichuan following the wenchuan ms8 0 earthquake revealed that the change patterns of these geochemical indicators after the earthquake were similar to that of the current earthquake more specifically the values of δ13cco2 dic and r ra gradually decreased but the x co2 increased 4 months later zhou et al 2015 this trend has also been reported by the national academy of sciences of the former soviet union which continuously monitored hot spring and deep well geochemistry in central asia from the 1960 s onward bapwщaл 1989 gao et al 2018 moreover they successfully predicted several earthquakes using regular changes in geochemical parameters before and after earthquakes bapwщaл 1989 however for practical early earthquake warning in western sichuan subsequent long term monitoring is needed to summarize the regularity of changes of the parameters before and after earthquakes and thereby reduce uncertainties of the warning model 5 3 noble gas isotopes in geothermal springs an indication of deep tectonic activity the noble gas isotopic ratio of 3he 4he of hot springs is considered a reliable geochemical indicator for determining origin depth of tectonic activity in the earth o nions and oxburgh 1988 ozima and podosek 2002 it is also one of the most widely used geochemical indicators for earthquake monitoring and prediction worldwide bapwщaл 1989 doğan et al 2009 gao et al 2018 tedesco and scarsi 1999 the r ra parameter was greater than 1 in most spring sites in kangding indicating the presence of mantle materials table 1 based on the method of duchkov et al 2010 the contribution of mantle derived helium was estimated to be between 10 and 20 fig 6 the results show that the helium index did not differ significantly before and after the 7 14 earthquake fig 6 previous monitoring results for hot springs in western sichuan at 1 month 5 months and 1 year after the devastating ms8 0 wenchuan earthquake revealed that when compared to that of the lmsf and anhf zones the xshf zone had a higher contribution rate of mantle derived helium comprising up to 40 and gradually decreasing after the earthquake zhou 2011 r ra appears to be related to the fault depth earthquake magnitude focal depth and other factors that must be considered when using this parameter as a precursor indicator for earthquake warning 5 4 temporal variations of geothermal spring geochemical parameters during earthquakes and their implications for seismic monitoring and warning the hydrochemistry and isotope geochemistry of geothermal springs have been used to monitor and forecast earthquakes worldwide for decades chiodini et al 2004 2020 de leeuw et al 2010 farmin et al 2008 perrier et al 2009 su et al 2022 tedesco and scarsi 1999 toutain and baubron 1999 zheng et al 2013 zhou et al 2015 geothermal fluid monitoring is superior to soil and groundwater systems because hot spring gases are considerably more enriched in deep gases but slightly contaminated by atmospheric gases toutain and baubron 1999 notably carbon isotope proxies of hot springs are more sensitive to tectonic activity and earthquakes than other geochemical indicators two successful earthquake predictions in central asia by the national academy of sciences of the former soviet union were based on co2 isotope measurements of local geothermal springs and monitoring wells bapwщaл 1989 gao et al 2018 the x co2 in hot spring gas is also an important geochemical indicator for example the national academy of sciences of the former soviet union noted in the 1970 s that low co2 concentrations in deep well gases strongly correlated with the occurrence of large earthquakes using x co2 and he as indicators they successfully predicted the ms7 0 alai earthquake 6 h in advance fig 9 a similarly based on the observation of low co2 content relative to the baseline in the longtougou and erdaoqiao hot springs in kangding for decades the kangding seismic observation station of the sichuan seismological bureau concluded that when co2 emission gas in hot springs is less than 90 vol moderate or strong earthquakes are likely to occur within 1 month and a 300 km radius around the hot spring location based on these observations they successfully predicted the ms5 5 baiyu batang earthquake on december 21 2006 liu et al 2006 however more sensitive carbon isotope indicators such as δ13cco2 dic have not been used for local earthquake prediction in western sichuan scholars have paid minimal attention to the patterns of geothermal spring geochemical parameter responses to earthquake propagation while monitoring the 7 14 earthquake we focused on the changes in the geochemical parameters of the hot spring before and after the earthquake as well as the temporal variation of the parameters as the earthquake progressed the results show that earthquakes occurred when the parameter values were at their lowest rather than at the highest earthquakes commonly occurred when δ13cco2 dic falls from the peak to a low value near the baseline whereas x co2 increased from the lowest value to its baseline values here referred to as the post peak seismic pattern fig 9 our findings for kangding combined with other successful monitoring records worldwide bapwщaл 1989 gao et al 2018 tedesco and scarsi 1999 confirm the universality of post peak patterns in earthquake processes fig 9 long term monitoring of major anions and cations such as na ca2 mg2 cl and so4 2 in hot springs in china shows that their concentrations follow similar pre earthquake high anomaly patterns du et al 2010 and references therein yan et al 2015 as carbon isotopes however there was a post earthquake peak anomaly of cl after the 1995 kobe earthquake tsunogai and wakita 1995 when considering the corresponding carbon isotope levels of hot springs at the moment of earthquake occurrence as shown in fig 9b and 9c respectively the carbon isotope level of the kangding hot spring was still elevated δ13cco2 dic 0 704 1 week after the 7 14 earthquake but was not approaching the local baseline approximately 3 to 5 during the quiescence period fig 9c this may imply that the 7 14 earthquake was only a small scale energy release and that larger scale energy releases could occur in the future as expected an ms6 1 earthquake in yaan and an ms6 0 earthquake in maerkang occurred along the xshf in june 2022 at the time of writing this paper three months later the ms6 8 luding earthquake struck moxi 50 km south of kangding on september 5 2022 9 05 main shock fig 1b causing severe damage from this perspective the 7 14 earthquake in 2021 can be seen as a prelude and warning to the series of earthquakes in western sichuan during the past two years although the post peak seismic pattern has been repeatedly observed in past earthquake monitoring and the 7 14 earthquake essentially warned of the 9 05 series of earthquakes these findings do not necessarily indicate that the pattern can be directly used as an earthquake warning signal in daily earthquake monitoring this is because the abrupt elevations of carbon isotopes in hot springs may not consistently be followed by earthquake seismic readings in addition the durations of earthquake precursors are related to multiple factors such as magnitude focal depth and epicenter distance the interval between the pre earthquake 7 14 earthquake and the 9 05 main shock was approximately 1 year whereas the intervals in other regions of the world ranged from a few days to several months bapwщaл 1989 tedesco and scarsi 1999 our carbon isotope monitoring of the hot springs in western sichuan after the 9 05 earthquake unpublished data showed that when two earthquakes with similar magnitudes were separated for a short interval within 1 month the carbon isotope peak before the subsequent earthquake was not significant these parameter changes were associated with many uncertainties including magnitude focal depth epicenter distance and earthquake occurrence mode bapwщaл 1989 toutain and baubron 1999 bräuer et al 2008 moreover multiple factors related to carbon isotope fractionation such as temperature pressure and water rock ratio may also be affecting the type of imminent patterns of hot spring carbon isotopes that we are currently observing therefore multi parameter and long term monitoring should aid us in obtaining statistical regularity and reduce the interference of contingency on earthquake early warning the he co2 system of geothermal springs is a geochemical proxy currently used to trace deep tectonic activity de leeuw et al 2010 du et al 2006 italiano et al 2009 and references therein li et al 2022 tian et al 2021 zhou et al 2015 however the monitoring results of this study show that the r ra indicator is insensitive to small and medium earthquakes which may be due to focal depth in western sichuan the combination of x co2 and δ13cco2 dic is more suitable for small and medium sized earthquakes than noble gas owing to the economic and time costs of earthquake monitoring another noteworthy observation is that in contrast to δ13cco2 dic x co2 and δ18oco2 exhibit anti phase changes during earthquakes fig 9a b which may be related to the amount of co2 released during the process shi et al 2014 as well as the different fractionation mechanism of oxygen isotopes as co2 is dissolved into water vogel et al 1970 6 conclusions the high carbon isotope characteristics of the hot spring system in western sichuan result from the decomposition of fault carbonate induced by deep tectonic activity and fractionation of carbon isotopes during the water rock reactions rather than the mixing of different carbon reservoirs the sudden elevation of the carbon isotope level δ13cco2 dic before the earthquake is a response to the enhanced deep tectonic activity other geochemical parameters such as x co2 also showed marked variations but r ra had no marked variations before and after the earthquake the post peak seismic pattern is currently not a practical tool that can be directly applied to earthquake warning multi parameter and long term monitoring to reduce contingency impacts on the post peak warning model is an effective strategy based on the geochemical observations of hot springs future studies on thermodynamic calculation and experimental simulation are needed to enhance our understanding of the details of water rock reaction and carbon isotopes fractionation credit authorship contribution statement jinlong liang conceptualization formal analysis investigation methodology visualization writing original draft yi yu data curation visualization resources software zeming shi funding acquisition resources validation supervision writing review editing zhipeng li resources validation yi huang software project administration hao song supervision funding acquisition jinyong xu software visualization validation xinyu wang supervision funding acquisition xiaocheng zhou investigation validation luyu huang software visualization zebin luo software visualization jue tong funding acquisition investigation wei zhai supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the jiangxi province key research and development project no 20203bbg72w011 the science and technology research project of jiangxi geological bureau no 2021aa07 and the everest scientific research program of chengdu university of technology no 80000 2022zf11419 we thank dr xun huang and yunhui zhang for their field assistance and dr chunhui cao and lantian xing of the lanzhou center of oil and gas resources chinese academy of science china for their help with analytical techniques of helium isotopes we also thank master student xinyi he of key laboratory of applied nuclear techniques in geoscience sichuan for her help in completing the carbon isotope analysis of some gas and spring water samples 
1708,in the past decades human activities including hydraulic structure construction and operation and groundwater overexploitation have largely changed the land surface conditions and correspondingly altered the natural rainfall runoff processes these changes make the traditional operational flood forecasting models without considering these anthropogenic impacts fail to capture these changes leading to a downgraded forecasting capability to improve the accuracy of flood forecasting in semi humid watersheds under strong aboveground and underground anthropogenic impacts the widely used operational flood forecasting model the xin anjiang model was chosen as a basis to build a new distributed hydrological model accounting for these anthropogenic impacts to characterize the runoff generation process under the condition of a thick unsaturated zone caused by groundwater overexploitation this study developed a runoff generation algorithm based on an idea that conceptualizes the soil free water storage into two virtual reservoirs to characterize the impacts of manmade reservoirs on the runoff concentration process we modified the muskingum method in addition we further developed a priori estimation method for deriving the spatial distribution of the tension water storage capacity by considering the anthropogenic impacts and geographical conditions based on the above work a grid xin anjiang haihe model gxh was developed in this study the qingshui river which is a tributary of the haihe river basin and a typical semi humid medium sized watershed in china with poor flood forecasting accuracy was selected as the study area to test the effectiveness of the model the results show that the gxh model can simulate the flood peak flow and peak time with higher accuracy than the current operational flood forecasting models and several other models in addition the parameter estimation method developed in this study has also proven to be superior in theory and practice keywords xin anjiang model flood forecasting parameter estimation runoff generation haihe river basin thick unsaturated zone data availability data will be made available on request 1 introduction flood control is related to the safety of people s lives and property and the development of the social economy chen et al 2023 nofal and van de lindt 2021 with the rapid socio economic development human activities have continuously altered the nature such as urbanization which increases the impervious surfaces and correspondingly alters the runoff partition and hydraulic structure operation which disturbs the flood discharge processes making flood control and forecasting more complicated and challenging meanwhile extreme precipitation events have been more frequent in the context of global climate change which seriously threatens the flood control security chen et al 2021a hirabayashi et al 2021 li et al 2021a liu et al 2017 zhang et al 2021b therefore practical and effective engineering measures such as building reservoirs and levees and non engineering measures such as flood forecasting and joint multi reservoir operation are necessary flood forecasting is regarded as the most important basic non engineering measure and its accuracy is the key to scientific flood control and regulation liu and cheng 2014 xia and chen 2021 in most humid areas the accuracy of flood forecasting is generally high meeting the requirements of flood control and early warning xia and chen 2021 yang et al 2020 in arid areas the probability of heavy flooding is relatively low because of the low precipitation and floods are relatively easy to control which relaxes the requirement for accurate flood forecasting cools et al 2012 yang et al 2017 zhang et al 2018 by comparison in many densely populated semi arid and semi humid regions the importance of flood protection is great but the accuracy of flood forecasting is relatively poor zhang 2010 zhang et al 2021a moreover human activities have largely changed the underlying land surface conditions and correspondingly altered the processes of runoff generation and concentration however many operational flood forecasting models lack the ability to account for these changes so their forecasting accuracy has been downgraded in the context of human induced environmental changes han and yang 2020 yair and kossovsky 2002 besides more frequent extreme precipitation events caused by climate change make things worse therefore there is an urgent need to improve the accuracy of flood forecasting in semi humid areas the haihe river basin is a typical semi humid watershed in china that spans eight provinces autonomous regions or municipalities bao et al 2012 this basin is densely populated yang et al 2021 and has a relatively poor operational flood forecasting accuracy with a tendency to worsen in recent years han and yang 2020 zhi et al 2005 in 2018 statistics on the flood forecasting scheme in the haihe river basin show that the channel cross sections with a prediction accuracy of level b a qualified ratio falling between 70 and 85 or a a qualified ratio equal to or more than 85 account for only 38 of the total while 10 of the total has a prediction accuracy of level c a qualified ratio falling between 60 and 70 or below the prediction accuracy of the remaining 52 of the total is poor and cannot even be rated han and yang 2020 by contrast in the humid watersheds of china the operational flood forecasting in the majority of channel cross sections have a prediction accuracy of level a the haihe river water conservancy commission ministry of water resources pointed out that the deteriorating flood forecasting accuracy of the haihe river basin is mainly due to the largely altered runoff generation and concentration processes resulted from human induced underlying surface changes which can not be captured by the traditional operational flood forecasting models han and yang 2020 besides studies on the mechanisms of runoff generation and concentration in the semi humid areas under changing and complex land surface conditions are still inadequate they also pointed out that the current dramatic changes in the underlying surface are mainly attributed to the thickening unsaturated zone increasing number of reservoirs and expanding urban area the progressive increase in the unsaturated zone thickness is due to the groundwater overexploitation chen 2016 yang et al 2021 yu et al 2020 as the water table becomes lower the unsaturated zone becomes thicker this phenomenon exists in the haihe river basin and most of the semi humid regions that experiences groundwater overexploitation li et al 2021b in the semi humid regions of china hydrological models that are currently used for operational flood forecasting include the xin anjiang xaj model zhao 1992 antecedent precipitation index api model hebei storm flood model tian et al 2020 among the others han and yang 2020 liu 2020 among these models the xaj model and its derivatives are adopted as the most commonly used operational flood forecasting models in china bao and li 2012 hao et al 2015 yao et al 2014 zhao 1992 whose flood simulation ability has withstood the test of practice liu 2016 zhang 2010 although there are both infiltration excess and saturation excess phenomena in semi humid areas the flood simulation performance of the combined models for infiltration excess and saturation excess do not appear to be better than the xaj model solely based on the saturation excess mechanism huang et al 2016 this can essentially boil down to two points 1 the locations of the infiltration excess runoff generation and saturation excess runoff generation are dynamic in space and time which makes it hard to accurately identify the locations and timings of the two runoff generation phenomena liang et al 2012 liu et al 2020b 2 the spatial density and temporal observing frequency of the present rainfall monitoring network cannot meet the requirements of the infiltration excess models han and yang 2020 huang et al 2019 compared with the other hydrological or land surface models that are mostly based on physical formulas abbott et al 1986 beven 2004 silver et al 2017 the xaj model uses a conceptual framework to model the rainfall runoff processes instead of conducting numerical solution to the physical partial differential equations therefore a very small time span for the step by step calculation of the physical process is not required to run the xaj model which means that the xaj model has low requirements for the temporal resolution of the precipitation observation data therefore the xaj model is widely used in the semi humid areas because of its good flexibility the xaj model and its derivatives are developed based on the characterization of the hydrological processes within a thin unsaturated zone of the humid watersheds however the unsaturated zone is much thicker in the semi humid watersheds particularly these semi humid watersheds experiencing groundwater overexploitation than in the humid watersheds as a result the xaj model generally performs poorly in these semi humid watersheds especially those with groundwater overexploitation since this model is not tailored to represent the thick unsaturated zone and associated hydrological processes in these regions therefore the original structure of the xaj model is no longer applicable in these semi humid watershed and some studies used some abnormal model parameter values to compensate this limitation han and yang 2020 li et al 2013 to date considerable experience has been accumulated in the application of the xaj model in operational flood forecasting which makes it a mature tool in china liu 2016 therefore the models derived from the xaj model have a significant potential for operational flood forecasting han and yang 2020 zang et al 2021 to improve the flood prediction accuracy of the haihe river basin under strong anthropogenic impacts this study aims to build a new model based on the framework of the grid xin anjiang gxaj model yao et al 2009 which can characterize the runoff generation process under the condition of a thick unsaturated zone represented by conceptualized dual free water reservoirs and simulate the runoff concentration process affected by reservoirs in the channel by introducing a streamflow impounding structure into the muskingum routing method in terms of parameter estimation we developed a priori parameter estimation method for deriving the spatial distribution of tension water storage capacity considering anthropogenic impacts on natural geographical conditions based on the above studies we developed the grid xin anjiang haihe model gxh and selected the qingshui river which is a tributary of the haihe river basin and a typical semi humid medium sized watershed in china with poor flood forecasting accuracy to test the simulation performance of the model 2 gxh model in the xaj model the characterization of the hydrological process in the unsaturated zone is embodied in its runoff generation module which can be divided into two parts zhao 1992 the first part involves one tension water reservoir which converts the net precipitation into the total runoff the second part involves one free water reservoir that partitions the total runoff into three components surface runoff interflow and groundwater runoff in the first part the tension water storage capacity is an essential parameter that refers to the maximum amount of water that the aeration zone can absorb without generating runoff in the algorithm of saturation excess runoff generation zhao and wang 1988 when the net precipitation is larger than the tension water storage capacity the excess net precipitation is converted into the total runoff in the xaj model the tension water storage capacity is proportional to the thickness of the unsaturated zone yao et al 2012 rui 2004 the tension water storage capacity increases as the unsaturated zone thickness increases in groundwater overexploitation areas such as the haihe river basin the unsaturated zone thickness has increased to 3 5 times the initial thickness after groundwater overexploitation which is much larger than under the natural conditions chen et al 2021b zhang et al 2007 when the xaj model is applied to these areas determining the tension water storage capacity becomes a difficult problem to be reasonably solved if it is still considered that the tension water storage capacity increases linearly with the thickness of the unsaturated zone an overly large tension water storage capacity will be obtained which makes the runoff yield abnormal this means that the original one tension water reservoir concept has a difficulty in characterizing the runoff yield in these watersheds with a thick unsaturated zone in addition the original one free water reservoir concept also shows some limitations in simulating the runoff generation in a thick unsaturated zone condon and maxwell 2019 assessed the impact of water table decline in the continental united states on watershed hydrological modeling over the last 100 years they found that the loss of groundwater was compensated by the response of the water circulation system in some plain areas with groundwater overexploitation exploitation reduces soil moisture and increases the soil infiltration rate thus promoting the conversion of runoff from above the surface to beneath the surface at the same time evapotranspiration would be curbed to compensate for the exploited groundwater jiang et al 2016 the original one free water reservoir concept is based on the characteristics of runoff division in the humid zone with a thin unsaturated zone to divide the total runoff into three components which ignores the phenomena of the increasing infiltration rate and water diversion from above the surface to beneath the surface caused by increased unsaturated zone thickness he et al 2001 lin et al 2018 therefore the original one free water reservoir concept is not suitable for a semi humid area with a thick unsaturated zone either in addition to the insufficiencies of the runoff generation module there are also insufficiencies in the runoff concentration module the impact of reservoir operation on runoff concentration is not considered in the xaj model to solve these problems we developed the gxh in terms of the model structure the gxh model follows the framework of the gxaj model fig 1 as a distributed hydrological model the gxh model uses identical square dem grid cells as the primary computational elements for modeling the rainfall runoff processes within each grid cell the inputs parameters and topography are treated spatially uniform most inputs and parameters are different among the different grid cells five major hydrologic processes are simulated within every grid cell canopy interception direct channel precipitation evapotranspiration runoff generation and runoff concentration first we calculate the canopy interception evapotranspiration and direct channel precipitation for each grid cell second the total yielded runoff of each grid cell is calculated based on the concept of saturation excess runoff and divided into three runoff components surface runoff interflow and groundwater runoff finally the runoff concentration is calculated based on the flow direction for each cell which is assigned based on the deterministic eight neighbor method d8 using a depressionless dem jenson and domingue 1988 compared with the gxaj model the gxh model sets up a runoff generation algorithm based on the dual free water reservoirs concept and a runoff concentration algorithm that considers the impoundment of reservoirs by modifying the muskingum routing method fig 1 in china hydrometeorological data for flood forecasting and water resource management are usually reported on a sub daily time scale during the flooding periods and on a daily time scale during the rest periods yao et al 2012 according to the availability of observed hydrometeorological data as well as practical requirements there are two modes for the gxh model to meet different demands hourly simulation for flood forecasting and daily simulation for water resource management there are different time steps and runoff concentration methods between the hourly and daily simulations the hourly simulation for flood forecasting requires the soil moisture data of each grid cell in the watershed which are provided by the daily simulation fig 1 therefore a daily simulation must be performed prior an hourly simulation the beginning time of daily simulation is usually set to several months earlier than the beginning time of hourly simulation the time difference between them is called the spin up warming up period during this period the simulated soil moisture in the daily simulation driven by the measured hydrometeorological data can gradually approaches the real soil moisture kim et al 2018 the initial soil moisture has little influence on the simulated soil moisture at the end of spin up period as long as the spin up period is sufficient long so the initial soil moisture for daily simulation could be preset to a first guess yao et al 2012 the algorithm of the daily simulation of the gxh model is the same as the gxaj model therefore only the algorithm for the hourly simulation of the gxh model is presented in this study 2 1 runoff generation based on dual free water reservoir tension water is the soil water between the wilting point and field capacity givi et al 2004 yao et al 2012 from the perspective of the saturation excess runoff generation the precipitation needs to fill up the tension water storage first and then the excess precipitation becomes runoff this type of runoff is called free water which is the soil water above the field capacity yao et al 2012 from the perspective of hydrological simulation the maximum amount of tension water that can be replenished by precipitation in the unsaturated zone is the tension water storage capacity of the unsaturated zone on a certain time scale some of the tension water can hardly be replenished by precipitation therefore determining the distribution characteristics of tension water that cannot be replenished is the key to solving the problem of calculating the tension water storage capacity in semi humid areas with a thick unsaturated zone tension water is mainly recharged by vertical precipitation and lateral flow and is only consumed by evapotranspiration chen et al 2021b kutílek and nielsen 1994 relevant studies have proposed the concept of extinction depth of evaporation chen et al 2021b shah et al 2007 shah et al 2007 believed that extinction depth is determined by soil type and vegetation type and that soil below the extinction depth is nearly unaffected by evapotranspiration this means that the tension water in this part of the soil cannot be consumed therefore the soil water content must always be greater than or equal to the field capacity and the water flowing into this part will be converted to free water as a whole therefore the tension water storage capacity of the unsaturated zone below the extinction depth is zero based on the above conclusions we proposed a runoff generation algorithm based on the dual free water reservoirs structure fig 2 based on the three layer structure of unsaturated zone of the xin anjiang model the gxh model sets a full tension water layer under the deeper layer forming a four layer structure of unsaturated zone including the upper layer the lower layer the deeper layer and the full tension water layer fig 2 the space occupied by free water in the unsaturated zone is divided into an upper free water reservoir and a lower free water reservoir the upper lower and deeper layers match the upper free water reservoir and the full tension water layer matches the lower free water reservoir when the tension water reservoir in the unsaturated zone is filled to its full capacity free water is generated in the upper free water reservoir and is divided into surface runoff interflow and lower free water reservoir inflow the lower free water reservoir inflow then flows into the lower free water reservoir when lower free water reservoir is full the excess lower free water reservoir inflow will turn into groundwater runoff the runoff generation algorithm based on the dual free water reservoirs concept is step 1 obtain the net precipitation after deducting evapotranspiration loss and canopy interception and use the saturation excess algorithm to calculate the runoff yield 1 r t 0 p ε t 0 o r p ε t w t w m p ε t w t w m p ε t w t w m where r t is the runoff yield at the tth time interval mm w t is the stored tension water amount at the beginning of the tth time interval mm w m is the tension water storage capacity mm p ε t is the net precipitation amount at the tth time interval mm step 2 according to the runoff generation structure of the dual free water reservoirs divide the yielded runoff into three runoff components surface runoff r s interflow r i and groundwater runoff r g 2 r s t 0 r t s t s m r t s t s m r t s t s m where r s t is the surface runoff at the tth time interval mm s t is the stored free water in the upper free water reservoir at the beginning of the tth time interval mm s m is the upper free water storage capacity mm 3 r i t k i r t s t r s t f d t 4 s t s t 1 r t 1 r i t 1 r s t 1 f d t 1 t 1 s 0 t 1 where r i t refers to the interflow at the tth time interval mm k i is the outflow coefficient of the free water storage to the interflow f d t is the lower free water reservoir inflow at the tth time interval mm s 0 is the initially stored free water in the upper free water reservoir mm based on the observed or estimated initial state of the unsaturated zone the f d t is determined using the green ampt infiltration model huo et al 2020 5 f d t min r t s t r s t k 1 ψ δ θ f t where k is the saturated hydraulic conductivity of the soil m m h 1 ψ is the wetting front capillary pressure head mm δ θ is the difference between the saturation soil moisture content and field capacity f t is the cumulative infiltration amount at the beginning of the tth time interval mm 6 f t i t 300 t 1 f d i f 0 t 300 i 1 t 1 f d i f 0 1 t 300 f 0 t 1 where f 0 is the initial infiltration amount at the beginning of the runoff generation process mm and is negatively correlated with the lower free water storage capacity s lm mm 7 s lm z r z g μ z r z g z i z r z i μ z r z i z g 0 z g z r where z r is the elevation of the river water level at the initial moment mm z g is the elevation of the water table at the initial moment mm z i is the elevation of the bottom boundary of the aquifer under the channel mm μ is the specific yield of the water table fluctuation zone the variables are set according to the observed or estimated initial state values of the watershed as the s lm getting smaller the water table becomes relatively higher and from the perspective of the algorithm f 0 also increases and vice versa 8 f 0 1 χ s lm ρ where χ is the conversion coefficient between the water table and infiltration amount and ρ is the minimum value which can take a value of 0 001 therefore this equation describes the negative correlation between the water table depth and the initial infiltration amount with other variables unchanged the infiltration rate increases as the initial infiltration amount decreases which reflects the objective phenomenon in the semi humid watershed where the infiltration rate increases as the water table decreases 9 r g t 0 f d t s l t s lm k g f d t s l t s lm f d t s l t s lm where r g t is the groundwater runoff at the tth time interval mm s l t is the stored free water in the lower free water reservoir at the beginning of the tth time interval mm s lm is the capacity of the lower free water reservoir mm 10 s l t s l t 1 f d t 1 r g t 1 t 1 s l 0 t 1 where s l 0 is the stored free water in the lower free water reservoir at the initial time mm 2 2 runoff concentration influenced by reservoirs in the hourly simulation we set up a simulation scheme in the gxh model for the impoundment of reservoirs in the runoff concentration process depending on whether there is a river grid cells can be classified into two classes channel cells and non channel cells for the channel cell the runoff concentration is calculated from one channel cell to another until it reaches the watershed outlet for the non channel cell the runoff concentration is calculated from one non channel cell to another non channel cell until it reaches a channel cell and then the runoff concentration is calculated from one channel cell to another channel cell until it reaches the outlet of the watershed as reservoirs are built on rivers and impound streamflow the runoff concentration in the channel cell is influenced by reservoirs therefore the runoff concentration algorithm for a non channel cell does not need to be modified whereas that for a channel cell needs to be modified in this study we use the initial muskingum method to calculate the runoff concentration from one non channel cell to another non channel cell or channel cell and the modified muskingum method to calculate the runoff concentration from one channel cell to another channel cell the algorithm for the runoff concentration of surface runoff interflow and groundwater runoff is as follows taking the surface runoff r s as an example the other runoff components use the same method with different parameters fig 3 the surface runoff of cells a b and c at time t are written as q a t q b t and q c t m3 s respectively the surface outflow from the three cells to cell d are q a t q b t and q c t m3 s after a time interval of δ t that is at time t δ t the surface runoff in cells a b and c are q a t δ t q b t δ t and q c t δ t m3 s respectively at time t δ t the surface outflow from the three cells to cell d are q a t δ t q b t δ t and q c t δ t m3 s respectively 11 q i t δ t c 0 q i t δ t c 1 q i t c 2 q i t i a b c 12 c 0 0 5 δ t k s x s 0 5 δ t k s k s x s c 1 0 5 δ t k s x s 0 5 δ t k s k s x s c 2 0 5 δ t k s k s x s 0 5 δ t k s k s x s where k s and x s are the muskingum parameters of the surface runoff concentration the counterparts of k s and x s for the interflow groundwater runoff and streamflow are k i and x i k g and x g and k ch and x ch respectively if cell d accepts only the outflow of cells a b and c then the surface runoff of cell d at time t is as follows 13 q d t q a t q b t q c t α r s d t where r s d t refers to the surface runoff in cell d at the unit time interval including time t mm α is the unit conversion factor which converts r s d t to the surface runoff yield rate m3 s after the surface runoff interflow and groundwater runoff flow from the non channel cell into the channel cell the channel flow routing is calculated using a modified muskingum method that considers the impoundment of reservoirs in this study we simplify the impoundment of reservoirs by considering them as tanks which means that these reservoirs will completely impound the flood until they are filled to their capacities once they are full they stop impounding the streamflow the storage capacity location and controlled area of reservoirs can be obtained by using remote sensing technology to extract spatial information and referring to the water conservation census we define the channel capacity of impoundment i chm m3 on each channel cell to simulate the impoundment of the reservoir among every channel cell in the controlled area of one reservoir i chm is shared which means that the runoff flowing into any channel cell occupies the i chm of every channel cell of the reservoir when the accumulated inflow is greater than i chm excess inflow flows downstream the channel flow routing process is calculated using the modified muskingum method and the equations are as follows 14 q ch i t δ t c ch 0 q ch i t δ t β i ch i t δ t c ch 1 q ch i t β i ch i t c ch 2 q ch i t 15 c c h 0 0 5 δ t k ch x ch 0 5 δ t k ch k ch x ch c c h 1 0 5 δ t k ch x ch 0 5 δ t k ch k ch x ch c c h 2 0 5 δ t k ch k ch x ch 0 5 δ t k ch k ch x ch where q ch i t refers to the streamflow in cell i at time t m3 s which is the sum of surface runoff interflow groundwater runoff and streamflow flowing into cell i and the runoff yielded in cell i q ch i t is the streamflow flowing out of cell i and flowing downstream into the next cell at time t m3 s i ch i t is the channel impoundment amount of grid i at the unit time interval including time t m3 β is the unit conversion factor that converts the channel impoundment amount m3 into the channel impoundment amount per second m3 s 16 i ch i t q ch i t β q ch i t β i chm i cha i chm i cha q ch i t β i chm i cha 17 i cha t i ch i t i c h 0 where i cha is the cumulative channel impoundment amount m3 and i c h 0 is the initial channel impoundment amount m3 in this study we assume that i c h 0 is positively correlated to the initial soil moisture that is i c h 0 decreases as the initial soil moisture decreases and vice versa the i c h 0 is calculated as follows 18 i c h 0 i 1 n w 0 i i 1 n w m i i chm where i 1 n w 0 i is the sum of the initial stored tension water amount of all the cells within the controlled area of the reservoir mm i 1 n w m i is the sum of the tension water storage capacity of all the cells within the controlled area of the reservoir mm 2 3 canopy interception direct channel precipitation and evapotranspiration canopy interception direct channel precipitation and evapotranspiration in the gxh model are calculated using the same algorithms as those in the gxaj model yao et al 2012 canopy interception refers to the water intercepted by the vegetation canopy in a precipitation event the canopy interception is calculated as follows 19 i cum f lc s cmax 1 e c vd p cum s cmax where i cum is the cumulative canopy interception mm f lc is the fraction of the soil surface covered by vegetation s cmax is the canopy storage capacity mm c vd is the correction factor for vegetation density p cum is the cumulative precipitation mm f lc is calculated according to the following equation 20 f lc k cb k cmin k cmax k cmin 1 0 5 h lc where k cb is the base crop coefficient k cmin is the minimum crop coefficient after precipitation or irrigation usually ranging from 0 15 to 0 20 with an average of 0 175 k cmax is the maximum crop coefficient after precipitation or irrigation h lc is the height of crops m k cb and k cmax are calculated as follows 21 k cb 1 07 1 e 0 84 l a i 22 k cmax 1 07 1 e 0 84 lai max 0 05 where lai is the leaf area index and lai max is the maximum lai in a year based on the above algorithms the f lc is calculated as follows 23 f lc 1 07 1 e 0 84 l a i 0 175 1 07 1 e 0 84 lai max 0 125 1 0 5 h lc moreover s cmax and c vd can be regarded as functions of lai 24 c vd 0 046 l a i 25 s cmax 0 935 0 498 l a i 0 00575 lai 2 the canopy interception at the tth time interval i ca t mm is calculated according to the cumulative canopy interception at the ending time of the tth time interval i cum t mm 26 i ca t i cum t i cum t δ t direct channel precipitation refers to the precipitation that falls directly into the drainage channel which is directly converted to streamflow and participates in channel flow routing the occurrence of direct channel precipitation increases the peak discharge in areas with dense river networks encountering highly intense precipitation direct channel precipitation has a significant influence on the discharge process at the watershed outlet it is assumed that in the channel cell precipitation has a uniform spatial distribution and the channel is unchanged in this case direct channel precipitation i ch mm is calculated as follows 27 i ch l ch w ch a gr p where l ch is the channel length within the cell km w ch is the channel width within the cell km a gr is the area of grid cell km2 p is the precipitation amount mm although the gxh model divides the unsaturated zone into four layers as the full tension water storage layer does not participate in the evapotranspiration the three layer evapotranspiration algorithm of the xaj model is still adopted in the evapotranspiration calculation of the gxh model for further details please refer to zhao 1992 3 a priori parameter estimation in addition to the runoff generation and concentration modules a priori estimation method that was originally developed in the humid areas and is currently used for deriving the spatial distribution of the tension water storage capacity is not suitable in watersheds with thick unsaturated zone either the spatial distribution of the tension water storage capacity is one of the most important parameters in the xaj model at present the most commonly used parameter estimation method is to draw on the natural land surface characteristics of the watershed such as topographic index soil type and vegetation cover to calculate the spatial distribution of the tension water storage capacity bandaragoda et al 2004 beven and kirkby 1979 yao et al 2012 a typical example of these methods is a priori parameter estimation based on the topographic index hereafter referred to as pe ti it is assumed that the unsaturated zone thickness is negatively related to the topographic index beven and kirkby 1979 yao et al 2012 believed that the unsaturated zone is thin where the topographic index is large and where the topographic index is small the unsaturated zone is thick this result is consistent with the actual situation in most humid regions generally in humid areas the areas with large topographic index are mostly near river channels and the water table in these places is relatively shallow which means that the unsaturated zone is relatively thin in contrast areas with small topographic index are mostly located on the upper hillside of the watershed which are far away from river channels and usually have thick unsaturated zones however the situation is completely different in semi humid areas with a human induced thick unsaturated zone in the plain area owing to the influence of groundwater exploitation a large and deep cone of depression has been formed around the extraction well chen et al 2016 regardless of the topographic index the unsaturated zone within and near the cone is relatively thicker than in other areas far from the cone under this circumstance the assumption that the unsaturated zone thickness is related to the topographic index is no longer applicable in addition the impact of impervious surfaces such as urbanization on the tension water storage capacity has not yet been considered either the accuracy of parameter estimation in a hydrological model is vital because it directly affects its flood simulation accuracy duan et al 1994 gupta et al 1999 a priori parameter estimation is an important method for estimating the parameters of distributed hydrological models which minimizes obstacles to model implementation by producing spatially consistent and physically reasonable parameter values yao et al 2012 table 1 lists all parameters of the gxh model and the corresponding literatures some of them belong to the distributed parameter category whose value in each cell is determined according to the attributes of the corresponding cell and varies with the attributes among cells the others belong to the lumped parameter category whose value is identical in every cell some parameters can be directly used for flood simulation after a priori parameter estimation whereas the remaining parameters need to be calibrated according to the measured discharge records on the basis of a priori parameter estimation before being used for flood simulation in this study we developed a priori parameter estimation method for the tension water storage capacity at the grid cell scale based on the evaporable unsaturated zone thickness hereafter it is called pe euzt for the other parameters we used the existing methods to estimate them 3 1 tension water storage capacity in the pe euzt method we consider the thick unsaturated zone caused by anthropogenic impacts and natural geographical conditions and the impervious surface caused by urbanization we introduce a new term the evaporable unsaturated zone thickness hereinafter shortened as euzt which refers to the thickness of the unsaturated zone in which evapotranspiration occurs as mentioned in section 2 1 the soil water beneath the evaporable unsaturated zone remains field capacity or above and thus zone beneath the evaporable unsaturated zone can be treated as a full tension water layer the tension water storage capacity of evaporable unsaturated zone equals the tension water storage capacity of the unsaturated zone therefore euzt can be used to estimate the tension water storage capacity the euzt in the grid cell is derived from the extinction depth and water table depth which is calculated as follows fig 4 a in cells with groundwater observation data fig 4a 28 d h max d wt h max d wt d wt h max where d is the euzt mm h max is the extinction depth mm which can be obtained according to land cover and soil properties shah et al 2007 d wt is the water table depth mm defined as follows 29 d wt e l z g where z g is the annual average elevation of the water table mm and el is the surface elevation mm b in cells without groundwater observation data fig 4b d can be estimated using the topographic index ti beven and kirkby 1979 in the gxh model we assume that ti is negatively correlated with d in the areas where the groundwater exploitation is weak in addition we assume that at least 5 of the areas with groundwater observation data are weakly affected by groundwater overexploitation based on the above two assumptions we get the following estimation method calculate the ti of all cells sort the ti values of all cells with groundwater observation data in ascending order calculate the mean ti value and d value of first 0 2 and 2 4 grid cells and separately name them as ti 2 ti 4 d 2 and d 4 respectively then substitute them into the following equation to derive two undetermined coefficients γ and δ 30 d γ t i δ after deriving the undetermined coefficients we can substitute the ti of cell without groundwater observation data into equation 30 to calculate the d if d is greater than the h max d will be set the same as h max if d is smaller than 0 it will be set to 0 the calculation of ti is as follows 31 ti ln α tan β where α is the catchment area per unit width representing the trend and amount of runoff accumulation and tan β is the local surface slope after the d value is obtained the tension water storage capacity w m can be obtained according to the soil properties including field capacity θ fc and wilting point θ wp and the ratio of impervious surface to the whole surface σ 32 w m ξ a d θ fc θ wp 1 σ ξ b where ξ a and ξ b are the undetermined coefficients these undetermined coefficients are determined as follows 33 ξ a d θ fc θ wp 1 σ max ξ b w mmax ξ a d θ fc θ wp 1 σ min ξ b w mmin where d θ fc θ wp 1 σ max is the maximum of all the cells d θ fc θ wp 1 σ and d θ fc θ wp 1 σ min is the minimum w mmax and w mmin are the maximum and minimum values of the tension water storage capacities of all the cells respectively the initial values of w mmax and w mmin can be determined empirically zhao and wang 1988 then we adjust the values by means of parameter calibration 3 2 interception and evapotranspiration parameters after the tension water storage capacity is determined the upper free water storage capacity s m can be derived as follows 34 s m θ s θ fc ζ ξ a d 1 σ where θ s is saturated moisture content ζ is the adjustment coefficient which is determined according to the distribution curve of free water storage capacity in xaj model for more details about ζ please refer to yao et al 2012 except for s m and w m other runoff generation parameters such as μ k i k ψ and δ θ are determined according to the soil type of the cell at present as there are no a priori parameter estimation methods for z i and χ we perform parameter calibration according to the measured discharge records to determine these values the runoff concentration parameters k s k i k g k ch x s x i x g x ch are lumped which can be estimated from the relevant literature table 1 for instance x g typically takes the value of 0 k reflects the runoff concentration duration of different runoff components and usually follows the rule k ch k s k i k g in the hourly simulation k g is relatively insensitive the channel width within a cell w ch is estimated from the channel cross section information as well as topographic attributes see yao et al 2012 for details when estimating k e we ignore the impact of the elevation difference between each grid cell and the evaporation station on k e and estimate k e according to the type of evaporation pan in china e 601 is set as the standard evaporation pan therefore k e 1 has been widely used other evapotranspiration parameters of each cell are obtained from empirical relations including w um 0 167 w m w lm 0 5 w m and c 0 18 f lc yao et al 2012 4 study area and data 4 1 study area the qingshui river is a tributary of the daqing river in the haihe river basin the qingshui river basin whose outlet lies at the beixindian hydrological station is selected as the study area to evaluate the flood simulation performance of the gxh model fig 5 located in hebei province the qingshui river basin covers an area of 1650 km2 and is a typical semi humid transition zone with mountainous and plain areas in north china there is a large scale and intense groundwater overexploitation in the qingshui river basin since 2010 the water table depth in its plain area has exceeded 15 m moreover many hydraulic structures have been built in recent decades therefore the qingshui river basin is a typical groundwater overexploited area under strong anthropogenic impacts there are two major landforms mountainous and plain which can comprehensively reflect the response of runoff generation and concentration to human induced environmental changes such as groundwater over exploitation hydraulic structure construction and urbanization in two different landforms the qingshui river basin belongs to the piedmont alluvial plain of the taihang mountains with high west and low east in the western mountain area secondary forests or secondary warm temperate shrub tussocks are lush the eastern plain area is flat and open with thick and loose soil reclaimed for farmland the soil types are mainly sandy loam but occasionally cinnamon soil there are seven rain gauges huanglongsi lingxi sicang shunping wangdu fujiaying and beixindian fig 5 and three long term groundwater monitoring wells i e nanwangzhuang xibailou and langzhuang in addition there are nine reservoirs including one medium sized and eight small reservoirs among them the longtan reservoir is the most important reservoir in the qingshui river basin with flood control aquaculture and tourism functions it controls an area of approximately 50 km2 with a total storage capacity of 12 78 million m3 which is four times the total capacity of the other eight reservoirs the main channel length is 108 6 km with a slope of 3 0 average annual precipitation is 457 1 mm from 1966 to 2010 and the maximum annual precipitation is 833 7 mm in 2008 the average annual runoff observed by beixindian station is 29 million m3 1966 2010 with the highest measured flood peak level of 19 70 m the maximum measured flood peak discharge is 710 m3 s 1966 followed by 686 m3 s 1989 in other years the maximum flood peak discharges are all below 200 m3 s however it should be noted that the flood in 1989 is an overbank flood so the observed peak discharge of 686 m3 s is not the real peak value later according to the survey of the administrative departments of water resources the actual maximum flood peak discharge is 1500 m3 s which is actually the biggest flood in the qingshui river basin since 1966 at present there are two major problems in operational flood forecasting in the qingshui river basin one is the lack of appropriate and sufficient observed flood events for the parameter calibration of hydrological models and the other is that the applicability of existing hydrological models is questionable the hydrology and water resources survey bureau of hebei province hereinafter referred to as the hebei bureau provides flood forecasting data for the qingshu river basin considering the great changes of the runoff generation and concentration processes since 1980 the hebei bureau used flood data after 1980 for the parameter calibration of the flood forecasting scheme for the qingshu river basin according to a report by the hebei bureau the simulations of peak flow and its time are focused on in operational flood forecasting for medium sized river basins such as the qingshui river basin from the perspective of flood control however the qualified ratio of the flood peak flow simulation during the calibration period was only approximately 40 4 2 data in this study the global land one km base elevation globe at 30 arc second 1 km is used fig 5 which is downloaded from https www ngdc noaa gov mgg topo gltiles html in terms of soil database the harmonized world soil database hwsd at 30 arc second spatial resolution is used fig 6 a which is downloaded from https www fao org soils portal data hub soil maps and databases harmonized world soil database v12 en the land cover data used in this study are from the global esa cci land cover classification map at a spatial resolution of 300 m esacci lc l4 lccs map 300 m p1y 2015 v2 0 7 fig 6b which is downloaded from https www esa landcover cci org the monthly lai value used in this study is obtained directly from the vegetation parameter information of the land data assimilation system ldas https ldas gsfc nasa gov gldas lai greenness we use the global 30 m impervious surface map at a resolution of 30 m for 2015 generated by the chinese academy of sciences fig 6c which is downloaded from https zenodo org record 3505079 zcbxfmj7rpy zhang et al 2020 the spatial distribution and storage capacity of reservoirs the spatial distribution of water table depth from 2010 to 2018 and hydrometeorological data including precipitation measured pan evaporation discharge surface water level and water table depth from 1980 to 2018 are provided by the hebei bureau the channel capacity of impoundment i chm of one channel cell is the same as the flood storage capacity of the reservoir to which the cell belongs fig 6d the water table depth in the mountainous areas is not measured in the qingshui river basin so there is only water table depth data in the plain areas in fig 6e the discharge and surface water levels of beixindian and the measured pan evaporation at the baoding station are used in this study fig 5 the grid precipitation at 30 arc second 1 km is interpolated from seven rain gauges as shown in fig 5 using the inverse distance weighted technique the water table depths of the three monitoring wells in fig 5 from 1980 to 2018 are used in this study the flood event data for the haihe river basin are very limited han and yang 2020 and the qingshui river basin is no exception considering the few flood events in the qingshui river basin especially after 2000 to meet the demand for flood forecasting and control flood events with peak flow greater than 25 m3 s before 2000 and flood events whose peak flow is greater than 10 m3 s after 2000 are selected 12 flood events from 1980 to 2018 are selected table2 there are not enough flood events to divide them into two parts that is some for model calibration and others for model validation for example eight events for model calibration and four events for model validation are hardly convincing therefore we used 12 flood events for model calibration and no flood events for validation the hebei bureau also used all flood events for model calibration without model validation in addition the flood events used for model calibration are the same as those used by the hebei bureau based on this a reasonable comparison can be made between existing flood forecasting models and new models 5 results and discussion 5 1 comparison of a priori parameter estimation methods there are three long term monitoring wells in the qingshui river basin the observation data of the three long term monitoring wells show that the water table depth in the qingshui river basin is greater than 8 m after 1980 which is greater than the extinction depth over the entire river basin fig 7 though the water table depth is getting greater over time the euzt does not get greater correspondingly because it has reached its maximum the euzt has been constant since 1980 that is the time when the flood simulation starts as shown in fig 8 b therefore the spatial distribution of the normalized tension water storage capacity obtained from pe euzt is also constant during the time span for flood simulation as shown in fig 8d the spatial distribution of the normalized tension water storage capacity obtained from parameter estimation based on the topographic index pe ti has the same spatial pattern as the spatial distribution of the topographic index fig 8a and c in fig 8a and c the tension water storage capacity topographic index is generally larger smaller in locations far from the channel in pe ti the topographic index is the main factor determining the water storage capacity of tension the topographic index is a relatively static index that reflects the natural topography without considering the dynamic anthropogenic impacts on the underlying surface therefore pe ti failed to consider dynamic anthropogenic impacts compared with pe ti pe euzt considers the impacts of soil type land cover impervious surface and water table on the tension water storage capacity as the water table depth is greater than the extinction depth euzt is equal to the extinction depth which is determined by the soil type and land cover therefore the spatial distribution of euzt is generally in the same spatial pattern as the spatial distribution of soil type while some differences exist between them which are due to land cover fig 6a b and 8b the spatial distribution of the tension water storage capacity from pe euzt is roughly consistent with euzt fig 8b and d which indicates that the spatial distribution of the tension water storage capacity reflects that of euzt in other words it reflects the influence of groundwater over exploitation on the tension water storage capacity there are differences in some areas between the spatial distributions of the tension water storage capacity and euzt which is due to the existence of impervious surface fig 6c in fig 8d there are three noticeable areas with low values that do not exist in fig 8b the reason is that the land cover there is urban area fig 6b with a large area of impervious surface fig 6c actually most of the precipitation falling in these areas is directly converted into runoff without loss indicating that the tension water storage capacity in these areas is relatively low thus pe euzt can accurately reflect the impacts of impervious areas on the tension water storage capacity too fig 9 shows the distribution curve of the tension water storage capacity hereinafter referred to as the distribution curve obtained using the three different methods in fig 9 the distribution curve obtained by empirical equations shows the distribution curve in the xaj model with an exponent parameter equal to 0 4 zhao 1992 when the maximum tension water storage capacity of the grid cells is set to 1 it can be seen that the total water storage capacity of the river basin obtained from the pe ti distribution curve is the minimum that from empirical equations is medium and that corresponding to pe euzt is the maximum the distribution curve obtained from empirical equations is the most common and widely used in china it represents widely applicable spatial distribution characteristics of the tension water storage capacity in the most humid and semi humid areas of china however the unsaturated zone is thick in the qingshui river basin so the tension water storage capacity is generally large in addition the spatial variation of the water table depth is enormous which is beyond the descriptive ability of empirical equations compared to the empirical equations the pe euzt has a relatively solid physical foundation and can describe the enormous spatial variation of the water table depth as well as the generally thick unsaturated zone which makes pe euzt more capable of estimating the tension water storage capacity to verify the superiority of the pe euzt method we applied the tension water storage capacity obtained from pe euzt and pe ti to the gxaj and gxh models the tension water storage capacity is an important parameter for the two models to evaluate the simulation performance the relative peak flow error peak flow time error nash sutcliffe efficiency coefficient and runoff depth error are used as the evaluation indicators according to the standard for hydrological information and hydrological forecasting gb t 22482 2008 hereinafter referred to as the standard a national normative document for flood forecasting in china these indicators are used to evaluate the simulation accuracy of peak flow peak time flood hydrograph and runoff depth evaluation standards in the standard that determine whether the calculated indicators are qualified are used in this study fig 10 shows comparisons between the flood simulations of the gxaj model with pe ti and pe euzt in terms of the peak flow there is no significant difference between the two parameter estimation methods fig 10a d however with regard to the simulations of peak time flood hydrograph and runoff depth the simulation accuracy of the gxaj with pe euzt hereinafter abbreviated as pe euzt gxaj is significantly higher than the gxaj with pe ti hereafter referred to as pe ti gxaj fig 10b c and d among these indicators the pass rate of the peak time of pe euzt gxaj is 75 while that of pe ti gxaj is only 58 the pass rate of the nash sutcliffe efficiency coefficient of pe euzt gxaj is 33 whereas that of pe ti gxaj is only 25 the runoff depth pass rate of the former is 75 whereas that of the latter is 67 thus it can be found that the tension water storage capacity obtained from the pe euzt method can significantly improve the simulation performance of the gxaj model compared to the initial method used in the gxaj model i e the pe ti method it is not only for the gxaj model that the pe euzt is superior to the pe ti for gxh model the pe euzt also has a better performance than the pe ti fig 11 shows comparisons between the flood simulations of the gxh model with pe ti and pe euzt in terms of the peak time the simulation performance of the gxh model with pe euzt hereafter referred to as pe euzt gxh is roughly the same as that of the gxh model with pe ti hereafter referred to as pe ti gxh with a qualified ratio of 83 fig 11b d in terms of peak flow flood hydrograph and runoff depth the simulation performance of pe euzt gxh is significantly better than that of pe ti gxh specifically the qualified ratio of the pe euzt gxh peak flow is 75 which is significantly higher than that of pe ti gxh 50 fig 11a d the qualified ratio of the nash sutcliffe efficiency coefficient of pe euzt gxh is 50 whereas that of pe ti gxh is only 33 fig 11c d as for the runoff depth the qualified ratio of pe euzt gxh reaches 100 whereas that of pe ti gxh is 83 fig 11d from the above results we conclude that pe euzt is better than pe ti and empirical equations for estimating the spatial distribution of tension water storage capacity which can be used for both theoretical analysis and practical application besides it can be seen that no matter which tension water storage capacity is used the simulation performance of the gxh model is always better than that of the gxaj model which preliminarily proves that the gxh model has a better simulation capacity in qingshui river basin than the gxaj model 5 2 comparison of the gxh model and other models in the qingshui river basin the administrative departments of water resources mainly adopt the xaj model hebei storm flood model hydrology and water resources survey bureau of hebei province 2017 tian et al 2020 and rainfall runoff correlation method to perform operational flood forecasting han and yang 2020 to verify the flood simulation performance of the gxh model in the qingshui river basin three hydrological models are selected for comparison table 3 the gxaj model with pe ti the xin anjiang haihe xaj hh model li et al 2013 zhang et al 2014 zhong et al 2015 spatial combination computing models sccms for runoff generation li et al 2015 liu et al 2020a liu et al 2020b as a derivative model of the xaj model the xaj hh model has more reasonable parameters when applied on semi humid river basins with a thick unsaturated zone compared to xaj model the sccms combines the infiltration excess algorithm of the hebei storm flood model and saturation excess algorithm its simulation performance is not inferior to the hebei storm flood model in semi humid river basins and even exceeds in some areas in general these models exhibit good flood simulation performance in semi humid river basins and are being promoted as operational flood forecasting models for administrative departments of water resources in this study we performed parameter calibration that combined automatic parameter calibration based on the sce ua algorithm duan et al 1994 with manual parameter calibration based on experience to ensure that the best simulation performances of the four models were obtained the relative peak flow error peak flow time error nash sutcliffe efficiency coefficient and runoff depth error were selected as the evaluation indicators fig 12 shows comparisons between the flood simulations of the gxaj xaj hh sccms and gxh models in terms of peak flow the pass rate of the gxh model reaches 75 which is better than the 33 pass rate of the xaj hh model and sccms and the 25 pass rate of the gxaj model fig 12a d with respect to the peak time the pass rate of the gxh model reaches 83 exceeding the 67 pass rate of the xaj hh model and sccms and the 58 pass rate of the gxaj model fig 12b d for the flood hydrograph the pass rate of the nash sutcliffe efficiency coefficient of the gxh model is 50 which is better than the 42 pass rate of the xaj hh model the 33 pass rate of the sccms and the 25 pass rate of the gxaj model fig 12c d with regard to the runoff depth the pass rate of both the gxh and xaj hh models reaches 100 which is better than the 83 pass rate of sccms and the 67 pass rate of the gxaj model fig 12d the pass rates of the peak flow and peak time of the gxh model are significantly higher than those of the other models which proves that the gxh model has better flood simulation ability in the qingshui river basin fig 13 shows the simulated hydrographs by the four models versus the observations for 12 flood events listed in table 2 in the qingshui river basin the gxh model can well simulate the peak flow values with errors falling within the allowable relative error of 20 for all flood events except flood events 1 fig 13a 3 fig 13c and 10 fig 13j while the other models show an overestimation or underestimation that is out of allowable relative error for example the other models all underestimate the values for flood events 5 fig 13e 6 fig 13f and 11 fig 13k while all the other models overestimate the values for flood events 8 fig 13h and 12 fig 13l there are three flood events that the gxh model has a poor performance and so do the other models the three poor flood simulations may be attributed to the lack of adequate observations on rainfall and reservoir regulation information for instance the precipitation of flood 1 is very small but produces a very large peak flow fig 13a which is possibly caused by extreme regional precipitation that has not been observed or reservoir regulation that leads to an abnormally large flow as to the simulation of peak time it can be found that the gxh model is significantly better than other models in the simulation of peak time for flood 2 fig 13b flood 5 fig 13e flood 10 fig 13j flood 11 fig 13k and flood 12 fig 13l to analyze the reasons why the gxh model is superior to the other models we chose flood 3 and 9 as cases to perform the analysis in this study two flood events with relatively poor simulation performance of the gxh model are selected instead of flood events with good simulation performance to ensure that the advantages and disadvantages of the gxh model could be objectively evaluated as the gxh model is based on the framework of the gxaj model the gxaj model is selected for comparison to control the variables the tension water storage capacity from the pe euzt method is adopted in both the gxaj and gxh models for flood 3 the total flow simulated by the gxaj model shows a significant overestimation even to another order of magnitude fig 14 b in contrast the gxh model also fails to simulate the total flow within the allowable error however it does not show a striking misestimation in order of magnitude with the simulated total flow even smaller than the measured value fig 14c by analyzing the precipitation that caused flood 3 we find that the spatial distribution of precipitation is uneven and concentrated fig 14a most of the precipitation occurs in the northwest corner of the river basin which is under the control of the longtan reservoir the most important reservoir in the qingshui river basin longtan reservoir has a strong ability to impound runoff within its control area therefore most of the runoff from precipitation is impounded by the longtan reservoir this explains why the gxaj model has a tremendous overestimation that is it ignores the interception of the longtan reservoir by comparison as the gxh model considers the effect of the longtan reservoir it can simulate a flood with better performance for the simulation of flood 9 the simulated peak times of the gxh and gxaj models do not qualify fig 14e f as for the peak flow the gxh model is qualified whereas the gxaj model is not qualified overall the gxh model shows better performance than the gxaj model in the simulation of flood 9 although the spatial distribution of precipitation of flood 9 is not as uneven and concentrated as that of flood 3 fig 14a d partial precipitation is still impounded by the reservoir according to the above logic the peak flow simulated by the gxh model should be smaller than that simulated by the gxaj model however the peak flow simulated by the gxh model is actually larger than by the gxaj model fig 14e f additionally the peak flow of the gxh model is still closer to the actual peak flow this demonstrates that the gxh model has a strong theoretical foundation and wide applicability there is no systematic bias in the gxh model although it considers the impoundment of reservoirs after the decomposition of the runoff it is found that the simulated total flow of the gxaj model mainly consist of surface flow and interflow and the proportion of interflow is relatively high fig 14e the hydrograph of interflow rises and recedes slowly and gently therefore the peak flow is not sufficiently large and the recession is not quick enough in contrast because of the dual free water reservoir of the gxh model the proportion of interflow and groundwater flow simulated by the gxh model are very small while the simulated surface flow is completely dominant fig 14f the hydrograph of the surface flow rises and recedes quickly therefore the simulated total flow shows a large peak flow and quick recession as for the peak time the peak time simulated by both the gxaj and gxh models is earlier than the measured peak time fig 14e f if we perform a translation of 6 h on the hydrograph along the increasing direction of the horizontal axis the hydrograph simulated by the gxh model is close to that measured fig 14f whereas the hydrograph simulated by the gxaj model is still different from that measured fig 14e according to the results above flood 9 mainly consists of surface runoff and the dual free water reservoir structure of the gxh model is capable of simulating each runoff component more reasonably 6 conclusions in this paper we developed a distributed hydrological model for the semi humid watersheds with a thick unsaturated zone under strong aboveground and underground anthropogenic impacts the grid xin anjianghaihe model gxh we also proposed a priori parameter estimation method for deriving the spatial distribution of tension water storage capacity based on the evaporable unsaturated zone thickness pe euzt to verify pe euzt s superiority we applied the tension water storage capacity obtained from pe euzt and the parameter estimation method based on the topographic index pe ti to the grid xin anjiang model gxaj and gxh model the results indicate that the model with the pe euzt method has better flood simulation ability than that with the pe ti method in addition the tension water storage capacity obtained from pe ti is almost constant with time because the topographic conditions can hardly change on a short time scale for this reason it cannot reflect the influence of human activities such as groundwater exploitation and urbanization on the underlying surface and the influence of the underlying surface change on the tension water storage capacity in contrast pe euzt can sensitively capture changes in the underlying surface and reflect the impacts of changing underlying surface on the tension water storage capacity therefore for both theoretical analysis and practical application the pe euzt method shows a better performance than the pe ti method in estimating the spatial distribution of the tension water storage capacity to verify the flood simulation performance of the gxh model this study selected the xaj xin anjiang haihe xaj hh and spatial combination computing models sccms for runoff generation for comparison the results show that the simulation accuracy of the gxh model is higher than or equal to the simulation accuracy of the other three models in terms of the peak flow peak time flood hydrograph and runoff depth in medium sized river basins such as the qingshui river basin the qualified ratios of peak flow and peak time are mostly focused on by administrative departments of water resources for flood control the pass rates of the peak flow and peak time of the gxh model are significantly higher than those of the other models and the qualified ratio of peak flow reaches 75 which proves that the gxh model has good flood simulation ability in the qingshui river basin the good flood simulation performance of the gxh is attributed to two main factors first the runoff generation algorithm of a dual free water reservoir has strong applicability in semi humid basins with a thick unsaturated zone second the streamflow impounding structure can simulate the effect of reservoirs on the runoff concentration process well for operational flood forecasting in the operational water system management hydrologic model is one of the most important components that determine the accuracy of operational flood forecasting a more effective hydrologic model will improve the accuracy of operational flood forecasting the gxh model adopts the model framework in the current operational flood forecasting system to guarantee that it is not only user friendly but also easy to be implemented in the current operational flood forecasting system moreover we have proved the superiority of gxh model relative to the other hydrological models used for operational flood forecasting in the typical semi humid watershed therefore the gxh model has the potential to improve the accuracy of operational flood forecasting in these watersheds credit authorship contribution statement xinyu chen conceptualization methodology writing original draft visualization ke zhang conceptualization methodology writing review editing supervision funding acquisition yuning luo writing review editing validation qinuo zhang validation jiaqi zhou writing review editing validation yazhou fan writing review editing validation pengnian huang writing review editing validation cheng yao writing review editing lijun chao writing review editing honghun bao writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by national natural science foundation of china 51879067 fundamental research funds for the central universities of china b220203051 b220204014 natural science foundation of jiangsu province bk20180022 and six talent peaks project in jiangsu province ny 004 
1708,in the past decades human activities including hydraulic structure construction and operation and groundwater overexploitation have largely changed the land surface conditions and correspondingly altered the natural rainfall runoff processes these changes make the traditional operational flood forecasting models without considering these anthropogenic impacts fail to capture these changes leading to a downgraded forecasting capability to improve the accuracy of flood forecasting in semi humid watersheds under strong aboveground and underground anthropogenic impacts the widely used operational flood forecasting model the xin anjiang model was chosen as a basis to build a new distributed hydrological model accounting for these anthropogenic impacts to characterize the runoff generation process under the condition of a thick unsaturated zone caused by groundwater overexploitation this study developed a runoff generation algorithm based on an idea that conceptualizes the soil free water storage into two virtual reservoirs to characterize the impacts of manmade reservoirs on the runoff concentration process we modified the muskingum method in addition we further developed a priori estimation method for deriving the spatial distribution of the tension water storage capacity by considering the anthropogenic impacts and geographical conditions based on the above work a grid xin anjiang haihe model gxh was developed in this study the qingshui river which is a tributary of the haihe river basin and a typical semi humid medium sized watershed in china with poor flood forecasting accuracy was selected as the study area to test the effectiveness of the model the results show that the gxh model can simulate the flood peak flow and peak time with higher accuracy than the current operational flood forecasting models and several other models in addition the parameter estimation method developed in this study has also proven to be superior in theory and practice keywords xin anjiang model flood forecasting parameter estimation runoff generation haihe river basin thick unsaturated zone data availability data will be made available on request 1 introduction flood control is related to the safety of people s lives and property and the development of the social economy chen et al 2023 nofal and van de lindt 2021 with the rapid socio economic development human activities have continuously altered the nature such as urbanization which increases the impervious surfaces and correspondingly alters the runoff partition and hydraulic structure operation which disturbs the flood discharge processes making flood control and forecasting more complicated and challenging meanwhile extreme precipitation events have been more frequent in the context of global climate change which seriously threatens the flood control security chen et al 2021a hirabayashi et al 2021 li et al 2021a liu et al 2017 zhang et al 2021b therefore practical and effective engineering measures such as building reservoirs and levees and non engineering measures such as flood forecasting and joint multi reservoir operation are necessary flood forecasting is regarded as the most important basic non engineering measure and its accuracy is the key to scientific flood control and regulation liu and cheng 2014 xia and chen 2021 in most humid areas the accuracy of flood forecasting is generally high meeting the requirements of flood control and early warning xia and chen 2021 yang et al 2020 in arid areas the probability of heavy flooding is relatively low because of the low precipitation and floods are relatively easy to control which relaxes the requirement for accurate flood forecasting cools et al 2012 yang et al 2017 zhang et al 2018 by comparison in many densely populated semi arid and semi humid regions the importance of flood protection is great but the accuracy of flood forecasting is relatively poor zhang 2010 zhang et al 2021a moreover human activities have largely changed the underlying land surface conditions and correspondingly altered the processes of runoff generation and concentration however many operational flood forecasting models lack the ability to account for these changes so their forecasting accuracy has been downgraded in the context of human induced environmental changes han and yang 2020 yair and kossovsky 2002 besides more frequent extreme precipitation events caused by climate change make things worse therefore there is an urgent need to improve the accuracy of flood forecasting in semi humid areas the haihe river basin is a typical semi humid watershed in china that spans eight provinces autonomous regions or municipalities bao et al 2012 this basin is densely populated yang et al 2021 and has a relatively poor operational flood forecasting accuracy with a tendency to worsen in recent years han and yang 2020 zhi et al 2005 in 2018 statistics on the flood forecasting scheme in the haihe river basin show that the channel cross sections with a prediction accuracy of level b a qualified ratio falling between 70 and 85 or a a qualified ratio equal to or more than 85 account for only 38 of the total while 10 of the total has a prediction accuracy of level c a qualified ratio falling between 60 and 70 or below the prediction accuracy of the remaining 52 of the total is poor and cannot even be rated han and yang 2020 by contrast in the humid watersheds of china the operational flood forecasting in the majority of channel cross sections have a prediction accuracy of level a the haihe river water conservancy commission ministry of water resources pointed out that the deteriorating flood forecasting accuracy of the haihe river basin is mainly due to the largely altered runoff generation and concentration processes resulted from human induced underlying surface changes which can not be captured by the traditional operational flood forecasting models han and yang 2020 besides studies on the mechanisms of runoff generation and concentration in the semi humid areas under changing and complex land surface conditions are still inadequate they also pointed out that the current dramatic changes in the underlying surface are mainly attributed to the thickening unsaturated zone increasing number of reservoirs and expanding urban area the progressive increase in the unsaturated zone thickness is due to the groundwater overexploitation chen 2016 yang et al 2021 yu et al 2020 as the water table becomes lower the unsaturated zone becomes thicker this phenomenon exists in the haihe river basin and most of the semi humid regions that experiences groundwater overexploitation li et al 2021b in the semi humid regions of china hydrological models that are currently used for operational flood forecasting include the xin anjiang xaj model zhao 1992 antecedent precipitation index api model hebei storm flood model tian et al 2020 among the others han and yang 2020 liu 2020 among these models the xaj model and its derivatives are adopted as the most commonly used operational flood forecasting models in china bao and li 2012 hao et al 2015 yao et al 2014 zhao 1992 whose flood simulation ability has withstood the test of practice liu 2016 zhang 2010 although there are both infiltration excess and saturation excess phenomena in semi humid areas the flood simulation performance of the combined models for infiltration excess and saturation excess do not appear to be better than the xaj model solely based on the saturation excess mechanism huang et al 2016 this can essentially boil down to two points 1 the locations of the infiltration excess runoff generation and saturation excess runoff generation are dynamic in space and time which makes it hard to accurately identify the locations and timings of the two runoff generation phenomena liang et al 2012 liu et al 2020b 2 the spatial density and temporal observing frequency of the present rainfall monitoring network cannot meet the requirements of the infiltration excess models han and yang 2020 huang et al 2019 compared with the other hydrological or land surface models that are mostly based on physical formulas abbott et al 1986 beven 2004 silver et al 2017 the xaj model uses a conceptual framework to model the rainfall runoff processes instead of conducting numerical solution to the physical partial differential equations therefore a very small time span for the step by step calculation of the physical process is not required to run the xaj model which means that the xaj model has low requirements for the temporal resolution of the precipitation observation data therefore the xaj model is widely used in the semi humid areas because of its good flexibility the xaj model and its derivatives are developed based on the characterization of the hydrological processes within a thin unsaturated zone of the humid watersheds however the unsaturated zone is much thicker in the semi humid watersheds particularly these semi humid watersheds experiencing groundwater overexploitation than in the humid watersheds as a result the xaj model generally performs poorly in these semi humid watersheds especially those with groundwater overexploitation since this model is not tailored to represent the thick unsaturated zone and associated hydrological processes in these regions therefore the original structure of the xaj model is no longer applicable in these semi humid watershed and some studies used some abnormal model parameter values to compensate this limitation han and yang 2020 li et al 2013 to date considerable experience has been accumulated in the application of the xaj model in operational flood forecasting which makes it a mature tool in china liu 2016 therefore the models derived from the xaj model have a significant potential for operational flood forecasting han and yang 2020 zang et al 2021 to improve the flood prediction accuracy of the haihe river basin under strong anthropogenic impacts this study aims to build a new model based on the framework of the grid xin anjiang gxaj model yao et al 2009 which can characterize the runoff generation process under the condition of a thick unsaturated zone represented by conceptualized dual free water reservoirs and simulate the runoff concentration process affected by reservoirs in the channel by introducing a streamflow impounding structure into the muskingum routing method in terms of parameter estimation we developed a priori parameter estimation method for deriving the spatial distribution of tension water storage capacity considering anthropogenic impacts on natural geographical conditions based on the above studies we developed the grid xin anjiang haihe model gxh and selected the qingshui river which is a tributary of the haihe river basin and a typical semi humid medium sized watershed in china with poor flood forecasting accuracy to test the simulation performance of the model 2 gxh model in the xaj model the characterization of the hydrological process in the unsaturated zone is embodied in its runoff generation module which can be divided into two parts zhao 1992 the first part involves one tension water reservoir which converts the net precipitation into the total runoff the second part involves one free water reservoir that partitions the total runoff into three components surface runoff interflow and groundwater runoff in the first part the tension water storage capacity is an essential parameter that refers to the maximum amount of water that the aeration zone can absorb without generating runoff in the algorithm of saturation excess runoff generation zhao and wang 1988 when the net precipitation is larger than the tension water storage capacity the excess net precipitation is converted into the total runoff in the xaj model the tension water storage capacity is proportional to the thickness of the unsaturated zone yao et al 2012 rui 2004 the tension water storage capacity increases as the unsaturated zone thickness increases in groundwater overexploitation areas such as the haihe river basin the unsaturated zone thickness has increased to 3 5 times the initial thickness after groundwater overexploitation which is much larger than under the natural conditions chen et al 2021b zhang et al 2007 when the xaj model is applied to these areas determining the tension water storage capacity becomes a difficult problem to be reasonably solved if it is still considered that the tension water storage capacity increases linearly with the thickness of the unsaturated zone an overly large tension water storage capacity will be obtained which makes the runoff yield abnormal this means that the original one tension water reservoir concept has a difficulty in characterizing the runoff yield in these watersheds with a thick unsaturated zone in addition the original one free water reservoir concept also shows some limitations in simulating the runoff generation in a thick unsaturated zone condon and maxwell 2019 assessed the impact of water table decline in the continental united states on watershed hydrological modeling over the last 100 years they found that the loss of groundwater was compensated by the response of the water circulation system in some plain areas with groundwater overexploitation exploitation reduces soil moisture and increases the soil infiltration rate thus promoting the conversion of runoff from above the surface to beneath the surface at the same time evapotranspiration would be curbed to compensate for the exploited groundwater jiang et al 2016 the original one free water reservoir concept is based on the characteristics of runoff division in the humid zone with a thin unsaturated zone to divide the total runoff into three components which ignores the phenomena of the increasing infiltration rate and water diversion from above the surface to beneath the surface caused by increased unsaturated zone thickness he et al 2001 lin et al 2018 therefore the original one free water reservoir concept is not suitable for a semi humid area with a thick unsaturated zone either in addition to the insufficiencies of the runoff generation module there are also insufficiencies in the runoff concentration module the impact of reservoir operation on runoff concentration is not considered in the xaj model to solve these problems we developed the gxh in terms of the model structure the gxh model follows the framework of the gxaj model fig 1 as a distributed hydrological model the gxh model uses identical square dem grid cells as the primary computational elements for modeling the rainfall runoff processes within each grid cell the inputs parameters and topography are treated spatially uniform most inputs and parameters are different among the different grid cells five major hydrologic processes are simulated within every grid cell canopy interception direct channel precipitation evapotranspiration runoff generation and runoff concentration first we calculate the canopy interception evapotranspiration and direct channel precipitation for each grid cell second the total yielded runoff of each grid cell is calculated based on the concept of saturation excess runoff and divided into three runoff components surface runoff interflow and groundwater runoff finally the runoff concentration is calculated based on the flow direction for each cell which is assigned based on the deterministic eight neighbor method d8 using a depressionless dem jenson and domingue 1988 compared with the gxaj model the gxh model sets up a runoff generation algorithm based on the dual free water reservoirs concept and a runoff concentration algorithm that considers the impoundment of reservoirs by modifying the muskingum routing method fig 1 in china hydrometeorological data for flood forecasting and water resource management are usually reported on a sub daily time scale during the flooding periods and on a daily time scale during the rest periods yao et al 2012 according to the availability of observed hydrometeorological data as well as practical requirements there are two modes for the gxh model to meet different demands hourly simulation for flood forecasting and daily simulation for water resource management there are different time steps and runoff concentration methods between the hourly and daily simulations the hourly simulation for flood forecasting requires the soil moisture data of each grid cell in the watershed which are provided by the daily simulation fig 1 therefore a daily simulation must be performed prior an hourly simulation the beginning time of daily simulation is usually set to several months earlier than the beginning time of hourly simulation the time difference between them is called the spin up warming up period during this period the simulated soil moisture in the daily simulation driven by the measured hydrometeorological data can gradually approaches the real soil moisture kim et al 2018 the initial soil moisture has little influence on the simulated soil moisture at the end of spin up period as long as the spin up period is sufficient long so the initial soil moisture for daily simulation could be preset to a first guess yao et al 2012 the algorithm of the daily simulation of the gxh model is the same as the gxaj model therefore only the algorithm for the hourly simulation of the gxh model is presented in this study 2 1 runoff generation based on dual free water reservoir tension water is the soil water between the wilting point and field capacity givi et al 2004 yao et al 2012 from the perspective of the saturation excess runoff generation the precipitation needs to fill up the tension water storage first and then the excess precipitation becomes runoff this type of runoff is called free water which is the soil water above the field capacity yao et al 2012 from the perspective of hydrological simulation the maximum amount of tension water that can be replenished by precipitation in the unsaturated zone is the tension water storage capacity of the unsaturated zone on a certain time scale some of the tension water can hardly be replenished by precipitation therefore determining the distribution characteristics of tension water that cannot be replenished is the key to solving the problem of calculating the tension water storage capacity in semi humid areas with a thick unsaturated zone tension water is mainly recharged by vertical precipitation and lateral flow and is only consumed by evapotranspiration chen et al 2021b kutílek and nielsen 1994 relevant studies have proposed the concept of extinction depth of evaporation chen et al 2021b shah et al 2007 shah et al 2007 believed that extinction depth is determined by soil type and vegetation type and that soil below the extinction depth is nearly unaffected by evapotranspiration this means that the tension water in this part of the soil cannot be consumed therefore the soil water content must always be greater than or equal to the field capacity and the water flowing into this part will be converted to free water as a whole therefore the tension water storage capacity of the unsaturated zone below the extinction depth is zero based on the above conclusions we proposed a runoff generation algorithm based on the dual free water reservoirs structure fig 2 based on the three layer structure of unsaturated zone of the xin anjiang model the gxh model sets a full tension water layer under the deeper layer forming a four layer structure of unsaturated zone including the upper layer the lower layer the deeper layer and the full tension water layer fig 2 the space occupied by free water in the unsaturated zone is divided into an upper free water reservoir and a lower free water reservoir the upper lower and deeper layers match the upper free water reservoir and the full tension water layer matches the lower free water reservoir when the tension water reservoir in the unsaturated zone is filled to its full capacity free water is generated in the upper free water reservoir and is divided into surface runoff interflow and lower free water reservoir inflow the lower free water reservoir inflow then flows into the lower free water reservoir when lower free water reservoir is full the excess lower free water reservoir inflow will turn into groundwater runoff the runoff generation algorithm based on the dual free water reservoirs concept is step 1 obtain the net precipitation after deducting evapotranspiration loss and canopy interception and use the saturation excess algorithm to calculate the runoff yield 1 r t 0 p ε t 0 o r p ε t w t w m p ε t w t w m p ε t w t w m where r t is the runoff yield at the tth time interval mm w t is the stored tension water amount at the beginning of the tth time interval mm w m is the tension water storage capacity mm p ε t is the net precipitation amount at the tth time interval mm step 2 according to the runoff generation structure of the dual free water reservoirs divide the yielded runoff into three runoff components surface runoff r s interflow r i and groundwater runoff r g 2 r s t 0 r t s t s m r t s t s m r t s t s m where r s t is the surface runoff at the tth time interval mm s t is the stored free water in the upper free water reservoir at the beginning of the tth time interval mm s m is the upper free water storage capacity mm 3 r i t k i r t s t r s t f d t 4 s t s t 1 r t 1 r i t 1 r s t 1 f d t 1 t 1 s 0 t 1 where r i t refers to the interflow at the tth time interval mm k i is the outflow coefficient of the free water storage to the interflow f d t is the lower free water reservoir inflow at the tth time interval mm s 0 is the initially stored free water in the upper free water reservoir mm based on the observed or estimated initial state of the unsaturated zone the f d t is determined using the green ampt infiltration model huo et al 2020 5 f d t min r t s t r s t k 1 ψ δ θ f t where k is the saturated hydraulic conductivity of the soil m m h 1 ψ is the wetting front capillary pressure head mm δ θ is the difference between the saturation soil moisture content and field capacity f t is the cumulative infiltration amount at the beginning of the tth time interval mm 6 f t i t 300 t 1 f d i f 0 t 300 i 1 t 1 f d i f 0 1 t 300 f 0 t 1 where f 0 is the initial infiltration amount at the beginning of the runoff generation process mm and is negatively correlated with the lower free water storage capacity s lm mm 7 s lm z r z g μ z r z g z i z r z i μ z r z i z g 0 z g z r where z r is the elevation of the river water level at the initial moment mm z g is the elevation of the water table at the initial moment mm z i is the elevation of the bottom boundary of the aquifer under the channel mm μ is the specific yield of the water table fluctuation zone the variables are set according to the observed or estimated initial state values of the watershed as the s lm getting smaller the water table becomes relatively higher and from the perspective of the algorithm f 0 also increases and vice versa 8 f 0 1 χ s lm ρ where χ is the conversion coefficient between the water table and infiltration amount and ρ is the minimum value which can take a value of 0 001 therefore this equation describes the negative correlation between the water table depth and the initial infiltration amount with other variables unchanged the infiltration rate increases as the initial infiltration amount decreases which reflects the objective phenomenon in the semi humid watershed where the infiltration rate increases as the water table decreases 9 r g t 0 f d t s l t s lm k g f d t s l t s lm f d t s l t s lm where r g t is the groundwater runoff at the tth time interval mm s l t is the stored free water in the lower free water reservoir at the beginning of the tth time interval mm s lm is the capacity of the lower free water reservoir mm 10 s l t s l t 1 f d t 1 r g t 1 t 1 s l 0 t 1 where s l 0 is the stored free water in the lower free water reservoir at the initial time mm 2 2 runoff concentration influenced by reservoirs in the hourly simulation we set up a simulation scheme in the gxh model for the impoundment of reservoirs in the runoff concentration process depending on whether there is a river grid cells can be classified into two classes channel cells and non channel cells for the channel cell the runoff concentration is calculated from one channel cell to another until it reaches the watershed outlet for the non channel cell the runoff concentration is calculated from one non channel cell to another non channel cell until it reaches a channel cell and then the runoff concentration is calculated from one channel cell to another channel cell until it reaches the outlet of the watershed as reservoirs are built on rivers and impound streamflow the runoff concentration in the channel cell is influenced by reservoirs therefore the runoff concentration algorithm for a non channel cell does not need to be modified whereas that for a channel cell needs to be modified in this study we use the initial muskingum method to calculate the runoff concentration from one non channel cell to another non channel cell or channel cell and the modified muskingum method to calculate the runoff concentration from one channel cell to another channel cell the algorithm for the runoff concentration of surface runoff interflow and groundwater runoff is as follows taking the surface runoff r s as an example the other runoff components use the same method with different parameters fig 3 the surface runoff of cells a b and c at time t are written as q a t q b t and q c t m3 s respectively the surface outflow from the three cells to cell d are q a t q b t and q c t m3 s after a time interval of δ t that is at time t δ t the surface runoff in cells a b and c are q a t δ t q b t δ t and q c t δ t m3 s respectively at time t δ t the surface outflow from the three cells to cell d are q a t δ t q b t δ t and q c t δ t m3 s respectively 11 q i t δ t c 0 q i t δ t c 1 q i t c 2 q i t i a b c 12 c 0 0 5 δ t k s x s 0 5 δ t k s k s x s c 1 0 5 δ t k s x s 0 5 δ t k s k s x s c 2 0 5 δ t k s k s x s 0 5 δ t k s k s x s where k s and x s are the muskingum parameters of the surface runoff concentration the counterparts of k s and x s for the interflow groundwater runoff and streamflow are k i and x i k g and x g and k ch and x ch respectively if cell d accepts only the outflow of cells a b and c then the surface runoff of cell d at time t is as follows 13 q d t q a t q b t q c t α r s d t where r s d t refers to the surface runoff in cell d at the unit time interval including time t mm α is the unit conversion factor which converts r s d t to the surface runoff yield rate m3 s after the surface runoff interflow and groundwater runoff flow from the non channel cell into the channel cell the channel flow routing is calculated using a modified muskingum method that considers the impoundment of reservoirs in this study we simplify the impoundment of reservoirs by considering them as tanks which means that these reservoirs will completely impound the flood until they are filled to their capacities once they are full they stop impounding the streamflow the storage capacity location and controlled area of reservoirs can be obtained by using remote sensing technology to extract spatial information and referring to the water conservation census we define the channel capacity of impoundment i chm m3 on each channel cell to simulate the impoundment of the reservoir among every channel cell in the controlled area of one reservoir i chm is shared which means that the runoff flowing into any channel cell occupies the i chm of every channel cell of the reservoir when the accumulated inflow is greater than i chm excess inflow flows downstream the channel flow routing process is calculated using the modified muskingum method and the equations are as follows 14 q ch i t δ t c ch 0 q ch i t δ t β i ch i t δ t c ch 1 q ch i t β i ch i t c ch 2 q ch i t 15 c c h 0 0 5 δ t k ch x ch 0 5 δ t k ch k ch x ch c c h 1 0 5 δ t k ch x ch 0 5 δ t k ch k ch x ch c c h 2 0 5 δ t k ch k ch x ch 0 5 δ t k ch k ch x ch where q ch i t refers to the streamflow in cell i at time t m3 s which is the sum of surface runoff interflow groundwater runoff and streamflow flowing into cell i and the runoff yielded in cell i q ch i t is the streamflow flowing out of cell i and flowing downstream into the next cell at time t m3 s i ch i t is the channel impoundment amount of grid i at the unit time interval including time t m3 β is the unit conversion factor that converts the channel impoundment amount m3 into the channel impoundment amount per second m3 s 16 i ch i t q ch i t β q ch i t β i chm i cha i chm i cha q ch i t β i chm i cha 17 i cha t i ch i t i c h 0 where i cha is the cumulative channel impoundment amount m3 and i c h 0 is the initial channel impoundment amount m3 in this study we assume that i c h 0 is positively correlated to the initial soil moisture that is i c h 0 decreases as the initial soil moisture decreases and vice versa the i c h 0 is calculated as follows 18 i c h 0 i 1 n w 0 i i 1 n w m i i chm where i 1 n w 0 i is the sum of the initial stored tension water amount of all the cells within the controlled area of the reservoir mm i 1 n w m i is the sum of the tension water storage capacity of all the cells within the controlled area of the reservoir mm 2 3 canopy interception direct channel precipitation and evapotranspiration canopy interception direct channel precipitation and evapotranspiration in the gxh model are calculated using the same algorithms as those in the gxaj model yao et al 2012 canopy interception refers to the water intercepted by the vegetation canopy in a precipitation event the canopy interception is calculated as follows 19 i cum f lc s cmax 1 e c vd p cum s cmax where i cum is the cumulative canopy interception mm f lc is the fraction of the soil surface covered by vegetation s cmax is the canopy storage capacity mm c vd is the correction factor for vegetation density p cum is the cumulative precipitation mm f lc is calculated according to the following equation 20 f lc k cb k cmin k cmax k cmin 1 0 5 h lc where k cb is the base crop coefficient k cmin is the minimum crop coefficient after precipitation or irrigation usually ranging from 0 15 to 0 20 with an average of 0 175 k cmax is the maximum crop coefficient after precipitation or irrigation h lc is the height of crops m k cb and k cmax are calculated as follows 21 k cb 1 07 1 e 0 84 l a i 22 k cmax 1 07 1 e 0 84 lai max 0 05 where lai is the leaf area index and lai max is the maximum lai in a year based on the above algorithms the f lc is calculated as follows 23 f lc 1 07 1 e 0 84 l a i 0 175 1 07 1 e 0 84 lai max 0 125 1 0 5 h lc moreover s cmax and c vd can be regarded as functions of lai 24 c vd 0 046 l a i 25 s cmax 0 935 0 498 l a i 0 00575 lai 2 the canopy interception at the tth time interval i ca t mm is calculated according to the cumulative canopy interception at the ending time of the tth time interval i cum t mm 26 i ca t i cum t i cum t δ t direct channel precipitation refers to the precipitation that falls directly into the drainage channel which is directly converted to streamflow and participates in channel flow routing the occurrence of direct channel precipitation increases the peak discharge in areas with dense river networks encountering highly intense precipitation direct channel precipitation has a significant influence on the discharge process at the watershed outlet it is assumed that in the channel cell precipitation has a uniform spatial distribution and the channel is unchanged in this case direct channel precipitation i ch mm is calculated as follows 27 i ch l ch w ch a gr p where l ch is the channel length within the cell km w ch is the channel width within the cell km a gr is the area of grid cell km2 p is the precipitation amount mm although the gxh model divides the unsaturated zone into four layers as the full tension water storage layer does not participate in the evapotranspiration the three layer evapotranspiration algorithm of the xaj model is still adopted in the evapotranspiration calculation of the gxh model for further details please refer to zhao 1992 3 a priori parameter estimation in addition to the runoff generation and concentration modules a priori estimation method that was originally developed in the humid areas and is currently used for deriving the spatial distribution of the tension water storage capacity is not suitable in watersheds with thick unsaturated zone either the spatial distribution of the tension water storage capacity is one of the most important parameters in the xaj model at present the most commonly used parameter estimation method is to draw on the natural land surface characteristics of the watershed such as topographic index soil type and vegetation cover to calculate the spatial distribution of the tension water storage capacity bandaragoda et al 2004 beven and kirkby 1979 yao et al 2012 a typical example of these methods is a priori parameter estimation based on the topographic index hereafter referred to as pe ti it is assumed that the unsaturated zone thickness is negatively related to the topographic index beven and kirkby 1979 yao et al 2012 believed that the unsaturated zone is thin where the topographic index is large and where the topographic index is small the unsaturated zone is thick this result is consistent with the actual situation in most humid regions generally in humid areas the areas with large topographic index are mostly near river channels and the water table in these places is relatively shallow which means that the unsaturated zone is relatively thin in contrast areas with small topographic index are mostly located on the upper hillside of the watershed which are far away from river channels and usually have thick unsaturated zones however the situation is completely different in semi humid areas with a human induced thick unsaturated zone in the plain area owing to the influence of groundwater exploitation a large and deep cone of depression has been formed around the extraction well chen et al 2016 regardless of the topographic index the unsaturated zone within and near the cone is relatively thicker than in other areas far from the cone under this circumstance the assumption that the unsaturated zone thickness is related to the topographic index is no longer applicable in addition the impact of impervious surfaces such as urbanization on the tension water storage capacity has not yet been considered either the accuracy of parameter estimation in a hydrological model is vital because it directly affects its flood simulation accuracy duan et al 1994 gupta et al 1999 a priori parameter estimation is an important method for estimating the parameters of distributed hydrological models which minimizes obstacles to model implementation by producing spatially consistent and physically reasonable parameter values yao et al 2012 table 1 lists all parameters of the gxh model and the corresponding literatures some of them belong to the distributed parameter category whose value in each cell is determined according to the attributes of the corresponding cell and varies with the attributes among cells the others belong to the lumped parameter category whose value is identical in every cell some parameters can be directly used for flood simulation after a priori parameter estimation whereas the remaining parameters need to be calibrated according to the measured discharge records on the basis of a priori parameter estimation before being used for flood simulation in this study we developed a priori parameter estimation method for the tension water storage capacity at the grid cell scale based on the evaporable unsaturated zone thickness hereafter it is called pe euzt for the other parameters we used the existing methods to estimate them 3 1 tension water storage capacity in the pe euzt method we consider the thick unsaturated zone caused by anthropogenic impacts and natural geographical conditions and the impervious surface caused by urbanization we introduce a new term the evaporable unsaturated zone thickness hereinafter shortened as euzt which refers to the thickness of the unsaturated zone in which evapotranspiration occurs as mentioned in section 2 1 the soil water beneath the evaporable unsaturated zone remains field capacity or above and thus zone beneath the evaporable unsaturated zone can be treated as a full tension water layer the tension water storage capacity of evaporable unsaturated zone equals the tension water storage capacity of the unsaturated zone therefore euzt can be used to estimate the tension water storage capacity the euzt in the grid cell is derived from the extinction depth and water table depth which is calculated as follows fig 4 a in cells with groundwater observation data fig 4a 28 d h max d wt h max d wt d wt h max where d is the euzt mm h max is the extinction depth mm which can be obtained according to land cover and soil properties shah et al 2007 d wt is the water table depth mm defined as follows 29 d wt e l z g where z g is the annual average elevation of the water table mm and el is the surface elevation mm b in cells without groundwater observation data fig 4b d can be estimated using the topographic index ti beven and kirkby 1979 in the gxh model we assume that ti is negatively correlated with d in the areas where the groundwater exploitation is weak in addition we assume that at least 5 of the areas with groundwater observation data are weakly affected by groundwater overexploitation based on the above two assumptions we get the following estimation method calculate the ti of all cells sort the ti values of all cells with groundwater observation data in ascending order calculate the mean ti value and d value of first 0 2 and 2 4 grid cells and separately name them as ti 2 ti 4 d 2 and d 4 respectively then substitute them into the following equation to derive two undetermined coefficients γ and δ 30 d γ t i δ after deriving the undetermined coefficients we can substitute the ti of cell without groundwater observation data into equation 30 to calculate the d if d is greater than the h max d will be set the same as h max if d is smaller than 0 it will be set to 0 the calculation of ti is as follows 31 ti ln α tan β where α is the catchment area per unit width representing the trend and amount of runoff accumulation and tan β is the local surface slope after the d value is obtained the tension water storage capacity w m can be obtained according to the soil properties including field capacity θ fc and wilting point θ wp and the ratio of impervious surface to the whole surface σ 32 w m ξ a d θ fc θ wp 1 σ ξ b where ξ a and ξ b are the undetermined coefficients these undetermined coefficients are determined as follows 33 ξ a d θ fc θ wp 1 σ max ξ b w mmax ξ a d θ fc θ wp 1 σ min ξ b w mmin where d θ fc θ wp 1 σ max is the maximum of all the cells d θ fc θ wp 1 σ and d θ fc θ wp 1 σ min is the minimum w mmax and w mmin are the maximum and minimum values of the tension water storage capacities of all the cells respectively the initial values of w mmax and w mmin can be determined empirically zhao and wang 1988 then we adjust the values by means of parameter calibration 3 2 interception and evapotranspiration parameters after the tension water storage capacity is determined the upper free water storage capacity s m can be derived as follows 34 s m θ s θ fc ζ ξ a d 1 σ where θ s is saturated moisture content ζ is the adjustment coefficient which is determined according to the distribution curve of free water storage capacity in xaj model for more details about ζ please refer to yao et al 2012 except for s m and w m other runoff generation parameters such as μ k i k ψ and δ θ are determined according to the soil type of the cell at present as there are no a priori parameter estimation methods for z i and χ we perform parameter calibration according to the measured discharge records to determine these values the runoff concentration parameters k s k i k g k ch x s x i x g x ch are lumped which can be estimated from the relevant literature table 1 for instance x g typically takes the value of 0 k reflects the runoff concentration duration of different runoff components and usually follows the rule k ch k s k i k g in the hourly simulation k g is relatively insensitive the channel width within a cell w ch is estimated from the channel cross section information as well as topographic attributes see yao et al 2012 for details when estimating k e we ignore the impact of the elevation difference between each grid cell and the evaporation station on k e and estimate k e according to the type of evaporation pan in china e 601 is set as the standard evaporation pan therefore k e 1 has been widely used other evapotranspiration parameters of each cell are obtained from empirical relations including w um 0 167 w m w lm 0 5 w m and c 0 18 f lc yao et al 2012 4 study area and data 4 1 study area the qingshui river is a tributary of the daqing river in the haihe river basin the qingshui river basin whose outlet lies at the beixindian hydrological station is selected as the study area to evaluate the flood simulation performance of the gxh model fig 5 located in hebei province the qingshui river basin covers an area of 1650 km2 and is a typical semi humid transition zone with mountainous and plain areas in north china there is a large scale and intense groundwater overexploitation in the qingshui river basin since 2010 the water table depth in its plain area has exceeded 15 m moreover many hydraulic structures have been built in recent decades therefore the qingshui river basin is a typical groundwater overexploited area under strong anthropogenic impacts there are two major landforms mountainous and plain which can comprehensively reflect the response of runoff generation and concentration to human induced environmental changes such as groundwater over exploitation hydraulic structure construction and urbanization in two different landforms the qingshui river basin belongs to the piedmont alluvial plain of the taihang mountains with high west and low east in the western mountain area secondary forests or secondary warm temperate shrub tussocks are lush the eastern plain area is flat and open with thick and loose soil reclaimed for farmland the soil types are mainly sandy loam but occasionally cinnamon soil there are seven rain gauges huanglongsi lingxi sicang shunping wangdu fujiaying and beixindian fig 5 and three long term groundwater monitoring wells i e nanwangzhuang xibailou and langzhuang in addition there are nine reservoirs including one medium sized and eight small reservoirs among them the longtan reservoir is the most important reservoir in the qingshui river basin with flood control aquaculture and tourism functions it controls an area of approximately 50 km2 with a total storage capacity of 12 78 million m3 which is four times the total capacity of the other eight reservoirs the main channel length is 108 6 km with a slope of 3 0 average annual precipitation is 457 1 mm from 1966 to 2010 and the maximum annual precipitation is 833 7 mm in 2008 the average annual runoff observed by beixindian station is 29 million m3 1966 2010 with the highest measured flood peak level of 19 70 m the maximum measured flood peak discharge is 710 m3 s 1966 followed by 686 m3 s 1989 in other years the maximum flood peak discharges are all below 200 m3 s however it should be noted that the flood in 1989 is an overbank flood so the observed peak discharge of 686 m3 s is not the real peak value later according to the survey of the administrative departments of water resources the actual maximum flood peak discharge is 1500 m3 s which is actually the biggest flood in the qingshui river basin since 1966 at present there are two major problems in operational flood forecasting in the qingshui river basin one is the lack of appropriate and sufficient observed flood events for the parameter calibration of hydrological models and the other is that the applicability of existing hydrological models is questionable the hydrology and water resources survey bureau of hebei province hereinafter referred to as the hebei bureau provides flood forecasting data for the qingshu river basin considering the great changes of the runoff generation and concentration processes since 1980 the hebei bureau used flood data after 1980 for the parameter calibration of the flood forecasting scheme for the qingshu river basin according to a report by the hebei bureau the simulations of peak flow and its time are focused on in operational flood forecasting for medium sized river basins such as the qingshui river basin from the perspective of flood control however the qualified ratio of the flood peak flow simulation during the calibration period was only approximately 40 4 2 data in this study the global land one km base elevation globe at 30 arc second 1 km is used fig 5 which is downloaded from https www ngdc noaa gov mgg topo gltiles html in terms of soil database the harmonized world soil database hwsd at 30 arc second spatial resolution is used fig 6 a which is downloaded from https www fao org soils portal data hub soil maps and databases harmonized world soil database v12 en the land cover data used in this study are from the global esa cci land cover classification map at a spatial resolution of 300 m esacci lc l4 lccs map 300 m p1y 2015 v2 0 7 fig 6b which is downloaded from https www esa landcover cci org the monthly lai value used in this study is obtained directly from the vegetation parameter information of the land data assimilation system ldas https ldas gsfc nasa gov gldas lai greenness we use the global 30 m impervious surface map at a resolution of 30 m for 2015 generated by the chinese academy of sciences fig 6c which is downloaded from https zenodo org record 3505079 zcbxfmj7rpy zhang et al 2020 the spatial distribution and storage capacity of reservoirs the spatial distribution of water table depth from 2010 to 2018 and hydrometeorological data including precipitation measured pan evaporation discharge surface water level and water table depth from 1980 to 2018 are provided by the hebei bureau the channel capacity of impoundment i chm of one channel cell is the same as the flood storage capacity of the reservoir to which the cell belongs fig 6d the water table depth in the mountainous areas is not measured in the qingshui river basin so there is only water table depth data in the plain areas in fig 6e the discharge and surface water levels of beixindian and the measured pan evaporation at the baoding station are used in this study fig 5 the grid precipitation at 30 arc second 1 km is interpolated from seven rain gauges as shown in fig 5 using the inverse distance weighted technique the water table depths of the three monitoring wells in fig 5 from 1980 to 2018 are used in this study the flood event data for the haihe river basin are very limited han and yang 2020 and the qingshui river basin is no exception considering the few flood events in the qingshui river basin especially after 2000 to meet the demand for flood forecasting and control flood events with peak flow greater than 25 m3 s before 2000 and flood events whose peak flow is greater than 10 m3 s after 2000 are selected 12 flood events from 1980 to 2018 are selected table2 there are not enough flood events to divide them into two parts that is some for model calibration and others for model validation for example eight events for model calibration and four events for model validation are hardly convincing therefore we used 12 flood events for model calibration and no flood events for validation the hebei bureau also used all flood events for model calibration without model validation in addition the flood events used for model calibration are the same as those used by the hebei bureau based on this a reasonable comparison can be made between existing flood forecasting models and new models 5 results and discussion 5 1 comparison of a priori parameter estimation methods there are three long term monitoring wells in the qingshui river basin the observation data of the three long term monitoring wells show that the water table depth in the qingshui river basin is greater than 8 m after 1980 which is greater than the extinction depth over the entire river basin fig 7 though the water table depth is getting greater over time the euzt does not get greater correspondingly because it has reached its maximum the euzt has been constant since 1980 that is the time when the flood simulation starts as shown in fig 8 b therefore the spatial distribution of the normalized tension water storage capacity obtained from pe euzt is also constant during the time span for flood simulation as shown in fig 8d the spatial distribution of the normalized tension water storage capacity obtained from parameter estimation based on the topographic index pe ti has the same spatial pattern as the spatial distribution of the topographic index fig 8a and c in fig 8a and c the tension water storage capacity topographic index is generally larger smaller in locations far from the channel in pe ti the topographic index is the main factor determining the water storage capacity of tension the topographic index is a relatively static index that reflects the natural topography without considering the dynamic anthropogenic impacts on the underlying surface therefore pe ti failed to consider dynamic anthropogenic impacts compared with pe ti pe euzt considers the impacts of soil type land cover impervious surface and water table on the tension water storage capacity as the water table depth is greater than the extinction depth euzt is equal to the extinction depth which is determined by the soil type and land cover therefore the spatial distribution of euzt is generally in the same spatial pattern as the spatial distribution of soil type while some differences exist between them which are due to land cover fig 6a b and 8b the spatial distribution of the tension water storage capacity from pe euzt is roughly consistent with euzt fig 8b and d which indicates that the spatial distribution of the tension water storage capacity reflects that of euzt in other words it reflects the influence of groundwater over exploitation on the tension water storage capacity there are differences in some areas between the spatial distributions of the tension water storage capacity and euzt which is due to the existence of impervious surface fig 6c in fig 8d there are three noticeable areas with low values that do not exist in fig 8b the reason is that the land cover there is urban area fig 6b with a large area of impervious surface fig 6c actually most of the precipitation falling in these areas is directly converted into runoff without loss indicating that the tension water storage capacity in these areas is relatively low thus pe euzt can accurately reflect the impacts of impervious areas on the tension water storage capacity too fig 9 shows the distribution curve of the tension water storage capacity hereinafter referred to as the distribution curve obtained using the three different methods in fig 9 the distribution curve obtained by empirical equations shows the distribution curve in the xaj model with an exponent parameter equal to 0 4 zhao 1992 when the maximum tension water storage capacity of the grid cells is set to 1 it can be seen that the total water storage capacity of the river basin obtained from the pe ti distribution curve is the minimum that from empirical equations is medium and that corresponding to pe euzt is the maximum the distribution curve obtained from empirical equations is the most common and widely used in china it represents widely applicable spatial distribution characteristics of the tension water storage capacity in the most humid and semi humid areas of china however the unsaturated zone is thick in the qingshui river basin so the tension water storage capacity is generally large in addition the spatial variation of the water table depth is enormous which is beyond the descriptive ability of empirical equations compared to the empirical equations the pe euzt has a relatively solid physical foundation and can describe the enormous spatial variation of the water table depth as well as the generally thick unsaturated zone which makes pe euzt more capable of estimating the tension water storage capacity to verify the superiority of the pe euzt method we applied the tension water storage capacity obtained from pe euzt and pe ti to the gxaj and gxh models the tension water storage capacity is an important parameter for the two models to evaluate the simulation performance the relative peak flow error peak flow time error nash sutcliffe efficiency coefficient and runoff depth error are used as the evaluation indicators according to the standard for hydrological information and hydrological forecasting gb t 22482 2008 hereinafter referred to as the standard a national normative document for flood forecasting in china these indicators are used to evaluate the simulation accuracy of peak flow peak time flood hydrograph and runoff depth evaluation standards in the standard that determine whether the calculated indicators are qualified are used in this study fig 10 shows comparisons between the flood simulations of the gxaj model with pe ti and pe euzt in terms of the peak flow there is no significant difference between the two parameter estimation methods fig 10a d however with regard to the simulations of peak time flood hydrograph and runoff depth the simulation accuracy of the gxaj with pe euzt hereinafter abbreviated as pe euzt gxaj is significantly higher than the gxaj with pe ti hereafter referred to as pe ti gxaj fig 10b c and d among these indicators the pass rate of the peak time of pe euzt gxaj is 75 while that of pe ti gxaj is only 58 the pass rate of the nash sutcliffe efficiency coefficient of pe euzt gxaj is 33 whereas that of pe ti gxaj is only 25 the runoff depth pass rate of the former is 75 whereas that of the latter is 67 thus it can be found that the tension water storage capacity obtained from the pe euzt method can significantly improve the simulation performance of the gxaj model compared to the initial method used in the gxaj model i e the pe ti method it is not only for the gxaj model that the pe euzt is superior to the pe ti for gxh model the pe euzt also has a better performance than the pe ti fig 11 shows comparisons between the flood simulations of the gxh model with pe ti and pe euzt in terms of the peak time the simulation performance of the gxh model with pe euzt hereafter referred to as pe euzt gxh is roughly the same as that of the gxh model with pe ti hereafter referred to as pe ti gxh with a qualified ratio of 83 fig 11b d in terms of peak flow flood hydrograph and runoff depth the simulation performance of pe euzt gxh is significantly better than that of pe ti gxh specifically the qualified ratio of the pe euzt gxh peak flow is 75 which is significantly higher than that of pe ti gxh 50 fig 11a d the qualified ratio of the nash sutcliffe efficiency coefficient of pe euzt gxh is 50 whereas that of pe ti gxh is only 33 fig 11c d as for the runoff depth the qualified ratio of pe euzt gxh reaches 100 whereas that of pe ti gxh is 83 fig 11d from the above results we conclude that pe euzt is better than pe ti and empirical equations for estimating the spatial distribution of tension water storage capacity which can be used for both theoretical analysis and practical application besides it can be seen that no matter which tension water storage capacity is used the simulation performance of the gxh model is always better than that of the gxaj model which preliminarily proves that the gxh model has a better simulation capacity in qingshui river basin than the gxaj model 5 2 comparison of the gxh model and other models in the qingshui river basin the administrative departments of water resources mainly adopt the xaj model hebei storm flood model hydrology and water resources survey bureau of hebei province 2017 tian et al 2020 and rainfall runoff correlation method to perform operational flood forecasting han and yang 2020 to verify the flood simulation performance of the gxh model in the qingshui river basin three hydrological models are selected for comparison table 3 the gxaj model with pe ti the xin anjiang haihe xaj hh model li et al 2013 zhang et al 2014 zhong et al 2015 spatial combination computing models sccms for runoff generation li et al 2015 liu et al 2020a liu et al 2020b as a derivative model of the xaj model the xaj hh model has more reasonable parameters when applied on semi humid river basins with a thick unsaturated zone compared to xaj model the sccms combines the infiltration excess algorithm of the hebei storm flood model and saturation excess algorithm its simulation performance is not inferior to the hebei storm flood model in semi humid river basins and even exceeds in some areas in general these models exhibit good flood simulation performance in semi humid river basins and are being promoted as operational flood forecasting models for administrative departments of water resources in this study we performed parameter calibration that combined automatic parameter calibration based on the sce ua algorithm duan et al 1994 with manual parameter calibration based on experience to ensure that the best simulation performances of the four models were obtained the relative peak flow error peak flow time error nash sutcliffe efficiency coefficient and runoff depth error were selected as the evaluation indicators fig 12 shows comparisons between the flood simulations of the gxaj xaj hh sccms and gxh models in terms of peak flow the pass rate of the gxh model reaches 75 which is better than the 33 pass rate of the xaj hh model and sccms and the 25 pass rate of the gxaj model fig 12a d with respect to the peak time the pass rate of the gxh model reaches 83 exceeding the 67 pass rate of the xaj hh model and sccms and the 58 pass rate of the gxaj model fig 12b d for the flood hydrograph the pass rate of the nash sutcliffe efficiency coefficient of the gxh model is 50 which is better than the 42 pass rate of the xaj hh model the 33 pass rate of the sccms and the 25 pass rate of the gxaj model fig 12c d with regard to the runoff depth the pass rate of both the gxh and xaj hh models reaches 100 which is better than the 83 pass rate of sccms and the 67 pass rate of the gxaj model fig 12d the pass rates of the peak flow and peak time of the gxh model are significantly higher than those of the other models which proves that the gxh model has better flood simulation ability in the qingshui river basin fig 13 shows the simulated hydrographs by the four models versus the observations for 12 flood events listed in table 2 in the qingshui river basin the gxh model can well simulate the peak flow values with errors falling within the allowable relative error of 20 for all flood events except flood events 1 fig 13a 3 fig 13c and 10 fig 13j while the other models show an overestimation or underestimation that is out of allowable relative error for example the other models all underestimate the values for flood events 5 fig 13e 6 fig 13f and 11 fig 13k while all the other models overestimate the values for flood events 8 fig 13h and 12 fig 13l there are three flood events that the gxh model has a poor performance and so do the other models the three poor flood simulations may be attributed to the lack of adequate observations on rainfall and reservoir regulation information for instance the precipitation of flood 1 is very small but produces a very large peak flow fig 13a which is possibly caused by extreme regional precipitation that has not been observed or reservoir regulation that leads to an abnormally large flow as to the simulation of peak time it can be found that the gxh model is significantly better than other models in the simulation of peak time for flood 2 fig 13b flood 5 fig 13e flood 10 fig 13j flood 11 fig 13k and flood 12 fig 13l to analyze the reasons why the gxh model is superior to the other models we chose flood 3 and 9 as cases to perform the analysis in this study two flood events with relatively poor simulation performance of the gxh model are selected instead of flood events with good simulation performance to ensure that the advantages and disadvantages of the gxh model could be objectively evaluated as the gxh model is based on the framework of the gxaj model the gxaj model is selected for comparison to control the variables the tension water storage capacity from the pe euzt method is adopted in both the gxaj and gxh models for flood 3 the total flow simulated by the gxaj model shows a significant overestimation even to another order of magnitude fig 14 b in contrast the gxh model also fails to simulate the total flow within the allowable error however it does not show a striking misestimation in order of magnitude with the simulated total flow even smaller than the measured value fig 14c by analyzing the precipitation that caused flood 3 we find that the spatial distribution of precipitation is uneven and concentrated fig 14a most of the precipitation occurs in the northwest corner of the river basin which is under the control of the longtan reservoir the most important reservoir in the qingshui river basin longtan reservoir has a strong ability to impound runoff within its control area therefore most of the runoff from precipitation is impounded by the longtan reservoir this explains why the gxaj model has a tremendous overestimation that is it ignores the interception of the longtan reservoir by comparison as the gxh model considers the effect of the longtan reservoir it can simulate a flood with better performance for the simulation of flood 9 the simulated peak times of the gxh and gxaj models do not qualify fig 14e f as for the peak flow the gxh model is qualified whereas the gxaj model is not qualified overall the gxh model shows better performance than the gxaj model in the simulation of flood 9 although the spatial distribution of precipitation of flood 9 is not as uneven and concentrated as that of flood 3 fig 14a d partial precipitation is still impounded by the reservoir according to the above logic the peak flow simulated by the gxh model should be smaller than that simulated by the gxaj model however the peak flow simulated by the gxh model is actually larger than by the gxaj model fig 14e f additionally the peak flow of the gxh model is still closer to the actual peak flow this demonstrates that the gxh model has a strong theoretical foundation and wide applicability there is no systematic bias in the gxh model although it considers the impoundment of reservoirs after the decomposition of the runoff it is found that the simulated total flow of the gxaj model mainly consist of surface flow and interflow and the proportion of interflow is relatively high fig 14e the hydrograph of interflow rises and recedes slowly and gently therefore the peak flow is not sufficiently large and the recession is not quick enough in contrast because of the dual free water reservoir of the gxh model the proportion of interflow and groundwater flow simulated by the gxh model are very small while the simulated surface flow is completely dominant fig 14f the hydrograph of the surface flow rises and recedes quickly therefore the simulated total flow shows a large peak flow and quick recession as for the peak time the peak time simulated by both the gxaj and gxh models is earlier than the measured peak time fig 14e f if we perform a translation of 6 h on the hydrograph along the increasing direction of the horizontal axis the hydrograph simulated by the gxh model is close to that measured fig 14f whereas the hydrograph simulated by the gxaj model is still different from that measured fig 14e according to the results above flood 9 mainly consists of surface runoff and the dual free water reservoir structure of the gxh model is capable of simulating each runoff component more reasonably 6 conclusions in this paper we developed a distributed hydrological model for the semi humid watersheds with a thick unsaturated zone under strong aboveground and underground anthropogenic impacts the grid xin anjianghaihe model gxh we also proposed a priori parameter estimation method for deriving the spatial distribution of tension water storage capacity based on the evaporable unsaturated zone thickness pe euzt to verify pe euzt s superiority we applied the tension water storage capacity obtained from pe euzt and the parameter estimation method based on the topographic index pe ti to the grid xin anjiang model gxaj and gxh model the results indicate that the model with the pe euzt method has better flood simulation ability than that with the pe ti method in addition the tension water storage capacity obtained from pe ti is almost constant with time because the topographic conditions can hardly change on a short time scale for this reason it cannot reflect the influence of human activities such as groundwater exploitation and urbanization on the underlying surface and the influence of the underlying surface change on the tension water storage capacity in contrast pe euzt can sensitively capture changes in the underlying surface and reflect the impacts of changing underlying surface on the tension water storage capacity therefore for both theoretical analysis and practical application the pe euzt method shows a better performance than the pe ti method in estimating the spatial distribution of the tension water storage capacity to verify the flood simulation performance of the gxh model this study selected the xaj xin anjiang haihe xaj hh and spatial combination computing models sccms for runoff generation for comparison the results show that the simulation accuracy of the gxh model is higher than or equal to the simulation accuracy of the other three models in terms of the peak flow peak time flood hydrograph and runoff depth in medium sized river basins such as the qingshui river basin the qualified ratios of peak flow and peak time are mostly focused on by administrative departments of water resources for flood control the pass rates of the peak flow and peak time of the gxh model are significantly higher than those of the other models and the qualified ratio of peak flow reaches 75 which proves that the gxh model has good flood simulation ability in the qingshui river basin the good flood simulation performance of the gxh is attributed to two main factors first the runoff generation algorithm of a dual free water reservoir has strong applicability in semi humid basins with a thick unsaturated zone second the streamflow impounding structure can simulate the effect of reservoirs on the runoff concentration process well for operational flood forecasting in the operational water system management hydrologic model is one of the most important components that determine the accuracy of operational flood forecasting a more effective hydrologic model will improve the accuracy of operational flood forecasting the gxh model adopts the model framework in the current operational flood forecasting system to guarantee that it is not only user friendly but also easy to be implemented in the current operational flood forecasting system moreover we have proved the superiority of gxh model relative to the other hydrological models used for operational flood forecasting in the typical semi humid watershed therefore the gxh model has the potential to improve the accuracy of operational flood forecasting in these watersheds credit authorship contribution statement xinyu chen conceptualization methodology writing original draft visualization ke zhang conceptualization methodology writing review editing supervision funding acquisition yuning luo writing review editing validation qinuo zhang validation jiaqi zhou writing review editing validation yazhou fan writing review editing validation pengnian huang writing review editing validation cheng yao writing review editing lijun chao writing review editing honghun bao writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by national natural science foundation of china 51879067 fundamental research funds for the central universities of china b220203051 b220204014 natural science foundation of jiangsu province bk20180022 and six talent peaks project in jiangsu province ny 004 
1709,reliable hydrodynamic modeling of rainfall runoff processes in basins requires simulations with high resolution or locally refined meshes which leads to a great increase in the computational costs in traditional gpu accelerated gpu graphics processing unit hydrodynamic models here a gpu accelerated and lts based lts local time step finite volume shallow water model is extended for rainfall runoff simulations by coupling with the green ampt model the model performance is demonstrated by simulating four experimental and one field rainfall runoff scenarios a satisfactory agreement is obtained between simulation results and the available measured data for four experimental scenarios indicating that the model can well simulate rainfall runoff processes when applied to the hexi basin of zhejiang province china the model also captures the main patterns of rainfall induced flooding though model parameters cannot be well specified inter comparisons of the computational efficiency indicate that implementing the lts method brings considerable additional improvements over the gpu acceleration for simulations with uniform or nonuniform meshes specifically the maximum speed up ratio can be as high as over 10x for the present simulations keywords rainfall runoff hydrodynamic model local time step gpu locally refined mesh data availability no data was used for the research described in the article 1 introduction rainfall runoff related flood is one of the world s most serious natural disasters numerical modeling is an effective tool for decision making and risk management the last several decades have witnessed the development of both hydrological and hydrodynamic models for rainfall runoff processes singh et al 2015 in hydrological models a simplified version of the mass or momentum equation is used to avoid directly solving the non linear hydrodynamic processes costabile et al 2013 mcmillan and brasington 2008 hydrodynamic models in contrast solve the fully nonlinear systems of shallow water equations huang et al 2019 paiva et al 2011 by hydrodynamic modeling detailed hydrodynamic characteristics can be captured such as the flood arrival time the inundation area water depth and velocity barbero et al 2022 bellos et al 2020 bernard et al 2022 caviedes voullieme et al 2012 liang et al 2016 rong et al 2020 schubert et al 2008 smith and liang 2013 xia et al 2019 xia et al 2017 however a high computational cost is required for hydrodynamic modeling in particular when a basin scale rainfall runoff process is simulated in this regard graphic processing units gpus have been widely used buttinger kreuzhuber et al 2022 caviedes voullième et al 2023 echeverribar et al 2019 fernandez pato and garcia navarro 2021 fernandez pato et al 2020 kesserwani and sharifian 2023 lacasta et al 2015 meurice and soares frazao 2020 morales hernandez et al 2021 sharifian et al 2022 vacondio et al 2017 vacondio et al 2014 wang et al 2014 for instance liang and smith 2015 developed a gpu based high performance integrated hydrodynamic modeling system hi pims in conjunction with 2 m accuracy topography to simulate uniform rainfall runoff processes on 0 39 km2 of cockenzie street glasgow aureli et al 2020 simulated a flood event in the western emilia romagna apennine region topographic accuracy 1 m dem of the river valley inlaid through gis in the dem available of the region with a square mesh of size 20 m while the gpu acceleration can greatly improve the computational efficiency of rainfall runoff simulations another potential constraint for the computational efficiency lies in the following specifically most of these hydrodynamic models have adopted the globally minimum value of the locally allowable maximum time step for solution updating of all computational cells given that the time step for solution updating with explicit schemes is based on courant friedrichs lewy cfl constraint the locally allowable maximum time step for each cell must be different except the simulation of uniform flow over uniform computational size therefore using the globally minimum time step gts must be very time demanding this is particularly true when locally refinement of the computational cell is necessary caviedes voullieme et al 2012 costabile and costanzo 2021 garcía alén et al 2022 which is common for rainfall runoff simulations in this regard many efforts have been devoted to designing smarter methods for solution updating of hydrodynamic models examples include the implicit dual time stepping method yu et al 2015 the exponential time integration method gaudreault and pudykiewicz 2016 as well as the graded local time step lts method hu et al 2020 hu et al 2019a hu et al 2019b li et al 2020 trahan and dawson 2012 among these methods the lts method appears very promising because it avoids the extra computational cost by using graded time steps that are comparable to the locally allowable maximum time step of every cell dazzi et al 2016 dazzi et al 2018 kesserwani and liang 2015 sanders 2008 using the lts method hu et al 2022 simulated tidal flows in yangtze estuary and hangzhou bay in this application an order of magnitude faster in computational efficiency is noted as compared to a traditional model however the lts method has not been used in flood simulation based on the rainfall runoff process in this work the finite volume shallow water model hu et al 2022 is further extended to rainfall runoff simulations it is achieved by treating the rainfall intensity and infiltration rate as source terms in the governing equations in particular the model is implemented on gpu using the nvidia cuda framework for parallelized computation and the lts method is used for solution updating the model accuracy is demonstrated by simulating rainfall runoff processes through the experiments in the laboratory and outdoors as well as conducted in the hexi basin in jingning county china section 2 briefly describes the mathematical formulations including the governing equations empirical relations for the rainfall and infiltration treatments as well as the numerical methods the finite volume discretization using the lts method and the gpu acceleration section 3 presents simulation results and discussions particular attention is paid to the additional reduction of the computational cost induced by the lts method over the gpu acceleration section 4 further discusses the factors influencing the lts benefits as well as the effects of the lts method on the numerical accuracy section 5 gives the conclusions 2 mathematical formulations 2 1 governing equations and empirical relations the governing equations are written in vector form as follows 1 u t f x g y s s s b s f 2 u h hu hv f hu h u 2 g h 2 2 huv g hv huv h v 2 g h 2 2 s s r i 0 0 s b 0 gh s bx gh s by s f 0 g h s fx g h s fy where u is the vector for the conserved physical variables f g are flux term vectors containing the advective terms and hydrostatic pressures s s s b and s f are the source term vectors containing rainfall infiltration bed slope and friction terms t is time x y are horizontal directions h is water depth u v are depth averaged velocities in the x and y directions respectively g 9 8 m s2 s bx z b x and s by z b y are the bed slopes where z b is the bed elevation s fx n 2 u u 2 v 2 h 4 3 and s fy n 2 v u 2 v 2 h 4 3 are the friction slopes where n is the manning roughness r is the rainfall intensity which is specified according to specific case conditions i is the soil infiltration rate the soil infiltration rate was determined using the revised green ampt model liu and singh 2004 mein and larson 1973 according to the green ampt model there is a downward extending wetting front in the soil which acts as a demarcation the soil is considered saturated above the wetting front and unsaturated below the wetting front the model assumes that the wetting front can extend downwards indefinitely and ignores the horizontal diffusion and flow of infiltrated water the infiltration rate can be calculated as follows 3 i di dt k s 1 θ s θ i ψ i where i is the infiltration rate i is the cumulative infiltration quantity k s is the saturated hydraulic conductivity of soil ψ is the suction of wetting frontal θ s is the saturated volumetric water content cm3 cm3 θ i is the initial volumetric water content cm3 cm3 when rainfall intensity r is greater than the infiltration capacity the water begins to pond on the ground when the infiltration rate i r ponding occurs the cumulative infiltration i r can be obtained by the green ampt model as follows 4 i r θ s θ i ψ r k s 1 and the pond time is 5 t r i r r in total the infiltration rate throughout the entire overland flow process can be expressed as 6 i r for t t r k s 1 θ s θ i ψ i r for t t r where t r is the time to reach the ponding time 2 2 numerical methods 2 2 1 finite volume discretization on unstructured triangular cells the governing equations are solved by the finite volume method on unstructured triangular cells fig 1 shows a sketch of the unstructured triangular meshes a an internal triangular cell id i and its three neighboring cells id i 1 i 2 i 3 b a face id j and its neighboring left and right cells id jl jr cell id varies from 1 to nc face id varies from 1 to nf a i is the area of the cell i r ij is the distance from the centroid of the cell i to its jth face where the subscript i represents the cell id and the subscript j 1 2 3 n ij n x n y ij are the normal outward direction of the jth face of the cell i δ l ij is the jth face length of the cell i finite volume discretization of the governing equations on cell i is as follows 7 u i u i δ t i a i j 1 3 e nij δ l ij δ t i s si s bi s fi i 1 2 3 n c where u i and u i are the conserved physical variables of the cell i at the time level t indicated by superscript and the time level t δ t i indicated by superscript δ t i is the local time step see section 2 3 e nij f n x g n y ij is the numerical flux across the jth face of the cell i s si s bi and s fi are the cell averaged source terms specifically the vector s si of the source term for rainfall infiltration is evaluated directly using the rainfall data and empirical formulae with infiltration value at the time level as input the bed slope source term s bi is evaluated using the slope flux method hou et al 2013 with flow variables at the time level as input the bed friction terms are estimated using the splitting point implicit method liang and marche 2009 for the numerical fluxes the hllc harten lax van leer contact approximate riemann solver toro 2001 is adopted for reconstruction of the left and right riemann variables of the interface which are inputs of the hllc solver there are numerous choices including first order ming et al 2020 xia et al 2019 zhao and liang 2022 second order hou et al 2018 liang and marche 2009 wittmann et al 2017 or higher order methods hu et al 2021 here the first order method is used by settling the left and right riemann variables of the interface directly equal to the conserved variables of the two neighboring cells hu et al 2019a hu et al 2019b hu et al 2022 moreover to ensure non negative water depth reconstruction the modification treatment proposed by audusse et al 2004 is implemented before calling the hllc solver the numerical fluxes at external faces that coincide with the boundary of the computational domain are estimated by definition using boundary values water depth flow velocity of the physical parameters yoon and kang 2004 2 2 2 time step estimations this section presents details on how to estimate local time steps it is based on the extended lts method to 2d shallow water modeling based on unstructured triangular meshes proposed by sanders 2008 the first step is to compute the locally allowable maximum time step δ t ami for cell i 8a δ t ami c r r mi u i 2 v i 2 g h i for cells with h i h thr 8b δ t ami an arbitrarily large value e g 100 s here for cells with h i h thr where c r is the courant number which is set to 0 9 h i u i v i are the water depth and flow velocities of the cell i r mi min r i 1 r i 2 r i 3 is the minimum distance from the centroid of cell i to its three faces h thr is a threshold water depth which is specified as 10 6 m the second step is to compute the global minimum value of the time step δ t min 9 δ t min min δ t ami i 1 2 n c the third step is to compute the potential grade exponent m i for all cells 10 m i min int lg δ t ami δ t min lg 2 m user i 1 2 3 n c where int is the rounding function m user is a user defined value to limit the grade exponent and it is set to 5 in this paper the fourth step modifies the potential grade exponent of neighboring cells that are characterized by abrupt flow condition changes i e the wet dry front the static dynamic front following hu et al 2019b specifically the potential grade exponents of the first and second layer cells around a dynamic static front are modified to the locally minimum value the fifth step is to compute the grade exponent m fj for faces 11 m fj min m jl m jr j 1 2 3 n f where the symbols m jl and m jr represent the potential grade exponents of the two neighboring cells around the face j see fig 1b the sixth step is to compute the actual grade exponent m i for cells 12 m i min m i m i 1 m i 2 m i 3 i 1 2 3 n c where the symbols m i 1 m i 2 m i 3 indicate the potential grade exponents of the three neighboring cells of the cell i see fig 1a finally one can find the maximum value m max of the actual grade exponents and the globally maximum time step δ t 13 m max max m i i 1 2 n c 14 δ t 2 m max δ t min 2 3 numerical structures and gpu acceleration fig 2 presents the numerical structures of the present gpu accelerated and lts based hydrodynamic model fig 2a and a traditional gpu accelerated model that does not use the lts method fig 2b in fig 2 blue boxes mean the cpu host tasks whereas green boxes mean the gpu device tasks and grey boxes indicate data transfer between the host and the device from fig 2 the model is initiated on the cpu host by reading data e g mesh information basic parameters boundary conditions such as time series of water level or discharge if any setting initial conditions and computing basic parameters afterwards necessary data are transferred from the host to the device to facilitate gpu acceleration mesh information basic parameters l s s c m user h thr c r boundary conditions for the gpu lts version mesh information basic parameters h thr c r boundary conditions for the gpu version this data transfer occurs once per numerical case of which the overhead is negligible afterwards the time steps are estimated for which the gpu lts version has five kernels kernel cell time step cts computes the locally allowable maximum time step kernel cell potential exponent cpe computes the potential grade exponent kernel cell modified exponent cme modifies the potential grade exponents around dynamic static fronts kernel face final exponent ffe computes the grade exponent of each face kernel cell final exponent cfe computes the actual grade exponent of cells and twice implementations of the reduction algorithm find the globally minimum time step δ t min and the maximum grade exponent of lts m max respectively whereas the gpu version only has one kernel kernel cell time step cts computes the locally allowable maximum time step and one implementation of the reduction algorithm find the globally minimum time step δ t min from above the number of the adopted kernels and reduction algorithms are different due to the use of the lts method using the lts i e the gpu lts model requires 5 kernels and 2 reduction algorithms whereas using the gts the standard gpu model only needs 1 kernel and 1 reduction algorithm after the time step estimation in the device data transfer from the device to the host occurs the maximum grade exponent of lts m max and the globally minimum time step δ t min for the gpu lts version only the globally minimum time step δ t min for the gpu version for the gpu version time levels of flow variables are at the same synchronized time every interval of the globally minimum time step δ t min this results in a very simple numerical structure two kernels are invoked one after the other kernel face flux ff computes numerical fluxes for all faces kernel cell variable cv updates the conserved variables of cells by firstly estimating the rainfall infiltration bed slope and frictions and secondly implement eq 7 in contrast for the gpu lts version time levels of flow variables are at the same synchronized time every interval of δ t δ t 2 m max δ t min in this regard the time interval δ t can be further divided into 2 m max sub cycles with s c 1 2 2 m max indicating the sequence of sub cycles for each sub cycle the parameter s c is firstly transferred from the host to the device afterwards two kernels face flux ff cell variable cv are invoked at each cycle in sub cycles whether or not the numerical flux of a specific face needs to be estimated depends on the property of the ratio s c 1 2 m fj if this ratio is an integer the numerical flux of face j at the s c th sub cycle will be refreshed whether or not the flow variables of a specific cell need to be updated depends on the inequality m i l s s c if this inequality is satisfied flow variables of cell i at the s c th will be updated note that the function l s s c can be seen in hu et al 2019b for variable storage three types of gpu memory are involved variables and big vectors that vary with time are stored in global memory on the device variables that do not vary with time are stored in the constant memory on the device big vectors that do not vary with time mostly vectors about mesh information are stored in texture memory 3 numerical case studies in this section five rainfall runoff scenarios are simulated scenario 1 four events of natural rainfall processes in a small field site with infiltration scenario 2 three events of nonuniform rainfall processes over a 1d impermeable three slope channel scenario 3 nine events of uniform rainfall processes in three physical urban models in total 27 sub scenarios scenario 4 a uniform rainfall process in a 2d slope with infiltration scenario 5 a basin scale rainstorm event these five scenarios cover a wide range of rainfall runoff conditions from small scale experimental rainfall runoff scenarios 1 4 to field scale basin rainstorm scenario 5 from regular terrain scenarios 2 4 to complex terrain scenarios 1 3 5 from uniform rainfall scenarios 3 4 to nonuniform rainfall scenarios 1 2 5 each scenario is simulated by both the gpu version and the gpu lts version over one scenarios 2 4 or several scenarios 1 5 sets of computational meshes in this regard it has been confirmed that differences in numerical solutions between the two versions are negligible accordingly comparisons of the two models are focused on their relative computational efficiency and whether the model can well simulate rainfall runoff processes the computational efficiency of the gpu lts version is quantified by the speedup ratio s defined as follows 15 s t gpu t gpu l t s t gpu and t gpu l t s are the run times of the gpu version and the gpu lts version respectively the ratio s quantifies the effect of the lts approach on gpu acceleration s 1 indicates that the lts has no effect and both versions are equally efficient s 1 indicates that the lts damages the model efficiency and accordingly the gpu version is more efficient s greater than 1 indicates that the lts improves the model efficiency and thus the gpu lts version is more efficient the nash sutcliffe efficiency nse coefficient is introduced to quantify the quantitative accuracy of the model 16 nse 1 k 1 n f k com f k mea 2 k 1 n f k com f 2 where n is the number of the measured variables f k mea is the measured data and f k com is the corresponding computed data the subscript k 1 2 3 n f is the mean of the measured data the symbol f represents physical variables such as water level discharge the nse ranges between minus infinity poor fitted and one perfect fitted following da silva et al 2015 an nse value over 0 75 indicates an excellent performance of the model while an nse value between 0 4 and 0 75 indicates a satisfactoryfit and an nse value smaller than 0 4 suggests anunsatisfactory fit for description convenience table 1 summarizes the mesh information total number of cells nonuniformity of the meshes for all simulations the computational costs for the gpu version and gpu lts version the speedup ratios of the gpu lts version and the model accuracy statistics the nonuniformity of the meshes has three parameters the mean equivalent face lengths l the geometric standard deviation σ and the gradient coefficient g the equivalent face length is firstly computed for each cell as the square root of the cell area based on this the mean equivalent face length l 50 the gradient coefficient g 1 2 l 84 1 l 50 l 50 l 15 9 and the geometric standard deviation σ l 84 1 l 15 9 can be computed where l 50 l 84 1 and l 15 9 are 50 84 1 and 15 9 shorter face lengths respectively 3 1 scenario 1 natural rainfall processes in a small field site with infiltration the first testing scenario is from esteves et al 2000 where four rainfall events see fig 3 a occurred on a 14 25 m long and 5 m wide field site see fig 3b as shown in fig 3b three sides of the site are concrete walls and the lowest side is a free outlet where the runoff discharge was measured before each rainfall the initial soil volumetric water content θ i was measured θ i 0 100 0 106 0 085 and 0 082 for the four rainfall events the saturated water content θ s 0 296 and the suction of wetting frontal ψ 1 2495 were also measured esteves et al 2000 the manning roughness is set to 0 2 s m1 3 following singh et al 2015 the saturated hydraulic conductivity of soil k s is set to 3 5 10 6 m s to test the grid convergence of the model and also investigate the lts performance on different meshes the four rainfall events are simulated by 12 sets of meshes including six uniform meshes uni 1 uni 6 and six non uniform nonuni 1 nonuni 6 meshes see table 1 the total number of cells for both uniform and nonuniform meshes ranges from about 104 to about 32 104 correspondingly the ranges of the mean equivalent lengths for both the uniform and nonuniform meshes are also similar from about 0 1 m to about 0 01 m however the geometric standard deviation σ and the gradient coefficient g differ greatly for the six uniform meshes σ 1 and g 1 whereas for the six nonuniform meshes σ 1 36 6 64 and g 1 36 19 60 for illustrative purposes the nse results and computational efficiency for all simulations of rainfall 1 and one simulation using the nonuniform but coarsest mesh of rainfall 2 4 are summarized in table 1 the following can be observed from these statistics first the nse values for the 12 simulations are about 0 90 0 91 with negligible differences this indicates that the numerical solutions are independent of the mesh sizes and thus the adopted mesh sizes are adequate for numerical simulations second the lts brings significant additional reductions in computational cost and such reductions are much more obvious over nonuniform meshes than reductions over uniform meshes specifically the ratios s for simulations over uniform meshes range from 1 68x to 8 60x with m max 4 whereas those over nonuniform meshes range from 4 20x to 11 72x with m max 5 this is understandable because nonuniform meshes result in more nonuniform distribution of the locally allowable maximum time step generally a larger muser value leads to higher computational efficiency nevertheless when the muser value is sufficiently large its further increase leads to mild reduction in the computational cost it is understandable because the maximum extent of reduction in the computational cost depends on the nonuniformities of both the cell sizes and the flow conditions if either the flow intensity or the mesh is more nonuniform it can be expected that a further increase in muser can lead to further reduction of the computational cost fig 4 shows the measured and computed discharge hydrographs at the outlet for four rainfall events from fig 4 the computed discharge hydrographs agree satisfactorily with the measured data specifically the nse coefficients are about 0 91 0 58 0 51 and 0 87 for rainfall 1 4 see table 1 respectively from fig 4 the discharge hydrograph is single peak in rainfall 2 and multi peak in rainfall 1 3 and 4 the shape of the discharge hydrographs at the outlet depends on topography characteristics and rainfall processes the field site is almost plain with mild slopes so the hydrograph is mainly influenced by the rainfall process only the rainfall process of rainfall 2 is single peak and therefore the discharge hydrograph of rainfall 2 also shows the shape of single peak in addition despite the satisfactory level of nse in rainfall 2 there are some differences in the computed and measured time of runoff peaks such errors should be attributed to uncertainties of empirical parameters overall the variations of the computed hydrographs agree with the respective measured hydrographs this demonstrates the ability of the model to capture the infiltration behavior of the soil 3 2 scenario 2 nonuniform rainfall processes over a 1d impermeable three slope channel the laboratory investigation of nonuniform rainfall over an impermeable three slope channel proposed by iwagaki 1955 is used as the second testing scenario in this experiment a series of artificial rainfall is applied on an aluminum laboratory flume with a three plane cascade surface the flume is 24 m long and divided into three equal 8 m slope sections equally with slopes of 0 2 0 15 and 0 1 respectively from upstream to downstream the rainfall intensities are 3890 2300 and 2880 mm h applied to the up middle and downstream of the flume respectively three rainfall durations of 10 s 20 s and 30 s are considered resulting in three sub scenarios solid slip conditions are imposed at the flume s upstream and lateral walls and the downstream is a free outlet the bed is initially dry a total of 107 417 cells are used with l50 0 005 m σ 1 31 g 1 36 the speedup ratios of the gpu lts version are 3 60x 3 54x and 3 48x with m max 5 for the three sub scenarios fig 5 shows the unit discharge hydrographs at the outlet for the three sub scenarios each hydrograph at the outlet peaks at approximately t 30 s when upstream flows with larger momentum catch up with downstream flows with smaller momentum the magnitude of the peak increases as the duration of rainfall increases the simulated results agree satisfactorily with the measured data in both the ascending and recession parts with the nse coefficient of 0 44 0 95 and 0 97 for the three sub scenarios for the first sub scenario rainfall duration of 10 s in the numerical simulation the peak occurs slightly later than the observed value whereas for the second and third sub scenarios rainfall durations of 20 s and 30 s respectively the simulated results agree very well with the measured results throughout the rise and fall of the discharge hydrographs at the outlet section this is important as in real conditions the rainfall duration is mostly not short these demonstrate the ability of the model to simulate nonuniform rainfall processes with different durations over irregular topography 3 3 scenario 3 uniform rainfall processes in physical urban models the third testing scenario is the laboratory experiment in a rectangular pool measuring 2 m 2 5 m conducted by cea et al 2010 the topography of the rainfall simulator basin is irregular and the accurate topographic elevation is determined by interpolating the measured contour lines in addition different urban configurations are built in the simulator basin including three placements of buildings x20 y20 and s20 see fig 6 a geometrical representation of buildings is used following schubert and sanders 2012 by manipulating the heights assigned to vertices of the computational mesh rainfall is produced with 100 nozzles evenly distributed in a basin the infiltration process does not need to be considered since the bed is impermeable experimental conditions include three rainfall discharges of 7 q7 15 q15 and 25 q25 l min uniformly distributed in space these three rainfall discharges and the three building placements result in nine sub scenarios which are named x20q7 x20q15 x20q25 y20q7 y20q15 y20q25 s20q7 s20q15 s20q25 take the first name as an example it means a rainfall discharge of 7 l min over the bed topography of x20 placement moreover three different rainfall durations 20 s 40 s and 60 s respectively are implemented on each of these nine sub scenarios and thus there are in total 27 simulations a total of 86 832 triangular cells are used with l50 0 004 m σ 1 47 g 1 53 the speedup ratios of the gpu lts version are 3 08x 3 49x for the 27 simulations with m max 5 fig 7 shows the measured and computed discharge hydrographs at the outlet of the simulator basin the computed values agree excellently with the measured data with the nse coefficient of at least 0 86 for all the 27 simulations despite the large bed slopes involved in the simulations the algorithm remains stable and the global accuracy of the model is unaffected this is of great importance for extreme flow conditions fig 8 shows the computed water depth distribution at different transients for the sub scenario s20q25 with a duration of 60 s from the three placements of buildings x20 y20 s20 tested s20 requires the finest mesh resolution because the buildings are the closest to each other it can be observed that the fine mesh resolution used in the simulation allows the shapes of the buildings to be well described it is important because if the shapes are not well resolved artificial barriers through which the runoff cannot flow are formed this effect hampers the runoff among the buildings and thus affects the discharge hydrographs at the outlet from fig 8 the buildings act to hamper the runoff leading to the ponding around them based on the low bed topography of the downstream medial axis in the simulator basin the simulations capture well the obstructive effect of buildings on runoff in physical urban models 3 4 scenario 4 a uniform rainfall process in a 2d slope with infiltration the rainfall runoff experiment in a 1 0 m 0 5 m laboratory soil flume with a slope of 0 1 proposed by de lima 1992 is used as the forth testing scenario the upstream and sides are impermeable and the downstream is free to flow out a uniform rain intensity of 3 741 10 5 m s is applied for 900 s the parameters of the green ampt model are set according to de lima 1992 as follows k s 1 67 10 6 m s ψ 0 02 m θ i 0 506 and θ s 0 0107 initially the slope is dry the model simulation time is 1200 s a total of 25 526 cells are used with l50 0 004 m σ 1 69 g 1 69 the speedup ratio of the gpu lts version is 5 83x with m max 5 fig 9 compares the computed and measured unit discharge hydrographs at the downstream outlet the simulation includes two situations with infiltration red line in fig 9 and without infiltration black line in fig 9 from fig 9 whether or not infiltration is included in the simulation has a significant impact on the discharge hydrographs of the outlet and the scenario can be accurately simulated when infiltration is included quantitatively the computed values agree excellently with the measured data with the nse coefficient of 0 82 note that the computed discharge hydrograph shows a more rapid rise at the beginning compared to the measured data this is because the surface of the slope always has to some extent ponding capability liu and singh 2004 which is neglected in the current model 3 5 scenario 5 a basin scale rainstorm event in this section a rainfall induced flood in the hexi basin of zhejiang province see fig 10 for the rainfall process the specific location of the basin and the bed topography and the land use type distributions is numerically simulated the hexi basin has a watershed area of 51 1 km2 and a complex topography sloping from southeast to northwest the hexi river runs through the basin with a total length of 15 32 km and a river slope of 34 5 there are four river water level stations in the basin the xikou the hexi the hanta and the sanzhishu stations see fig 10b water level series measured at these four river stations are available for model validation the rainfall occurred from 18 00 on july 8th to 5 00 on july 10th in 2020 see fig 10a the maximum rainfall intensity is about 38 mm h and the total precipitation is 235 8 mm the rainfall process is given in fig 10a as hourly averaged rainfall intensity and uniform rainfall over the catchment is considered in the model the manning roughness is assigned based on land use types 0 15 for the roughness of the mixed forest area 0 025 for the artificial surface area 0 03 for the river region 0 035 for the agriculture area and 0 05 for other land areas the manning roughness is from the suggested value in hydraulic textbooks e g chow 1959 the infiltration parameters are set as follows θ s 0 4 θ i 0 15 k s 3 10 6 m s ψ 1 5 m the downstream boundary is set by the stage discharge relationship z 0 064 q 0 543 148 85 where z and q is the water level and the discharge at the river cross section coinciding with the downstream boundary before the simulation pre run the model on a dry bed during the pre rainfall process to produce an initial flow discharge of 75 m3 s for subsequent simulations with the similar method in huang et al 2015 and xia et al 2019 to compare the computational efficiency of the gpu version and the gpu lts version on different meshes three sets of meshes are tested for this scenario with the total number of cells equal to 148 406 mesh a 209 923 mesh b 338 283 mesh c respectively the three sets of meshes are all refined at river regions with l50 19 660 m 16 278 m and 7 381 m respectively fig 11 compares the documented from the local administration office and digitalized by the three meshes bed elevation transects at the four stations from fig 11 it is shown the finer the mesh the closer digitalized bed elevation transects are to documented values the comparison of the computational efficiency of the two versions is shown in table 1 the speedup ratios of the gpu lts version are 13 25x 16 41x and 18 95x for mesh a b and c respectively the speedup ratios of the gpu lts version are higher than the previous four scenarios it is because the degree of run time reductions depends on the nonuniformities of both the cell sizes and the flow conditions for rainfall and runoff simulations in real basins with complex topography the flow conditions are very non uniform fig 12 shows the water depth distribution at 7 8 18 00 7 9 4 00 7 9 9 00 and 7 10 0 00 during the rainstorm stormwater flows across the basin land into the river and the water levels in the river rise as a response to the rainfall as the intensity of rainfall increases the runoff intensity increases and the water level in the river shows a significant rise in the later stages of the rainfall the rainfall intensity decreases and the water level in the river gradually drops accordingly fig 13 compares the measured and computed water level hydrographs with three sets of meshes at four stations computed results for different meshes vary due to the different accuracy of the topography description overall the computed hydrographs by the finer meshes are closer to the measured values the nse coefficients for the xikou the hexi the hanta and the sanzhishu stations are 0 15 0 78 0 89 and 0 45 respectively with mesh c the simulation results show satisfactory agreement with the measured data for all stations except for the xikou station this is understandable because the xikou station is close to the outlet boundary of the calculation domain and thus subject to high sensitivity to outlet boundary conditions also the quantity of the measured data is not satisfactory for basin scale scenarios nevertheless the present numerical scenario studies of the rainstorm event in the hexi basin indicate that with the present data availability it is likely to have these main patterns of the flood e g the arrival time the magnitudes of flood peak captured by the current models 4 discussion this section is devoted to discussions on 1 to what extent the additional lts codes may affect the computational efficiency i e the lts overhead 2 the attractiveness of the lts benefits to the simulation of rainfall runoff processes by discussing the relative contributions of nonuniformities of cell sizes and flow conditions and finally 3 the effects of the lts scheme on the numerical accuracy with regards to the lts overhead on computational cost we have compared the computational costs of two gpu models one is obtained from the present gpu lts model by setting muser 0 the other is the standard gpu model that does not include the lts codes at all numerical tests show that the lts overhead only accounts for 1 2 of the total computational cost which is negligible compared to the benefits of the lts method since one focus of the present paper is to apply the lts method to the simulation of rainfall runoff processes it is interesting to check the attractiveness of the lts benefits for such flows it is completed by discussing the relative contributions of the nonuniformities of cell sizes and flow conditions to the lts benefits the motivation is twofold first both the cell size and the flow condition affect the locally allowable maximum time step see eq 8 second rainfall runoff flows may be particularly nonuniform because when water flows from hillsides to main channels it may be subject to great variation in the water depth and flow velocity in this regard we have re simulated scenario 5 using four sets of uniform meshes mesh d mesh g total number of cells 334 638 for mesh d 656 470 for mesh e 972 587 for mesh f and 1 539 839 for mesh g and compared their lts benefits against the lts benefits for the simulation with the nonuniform mesh c total number of cells 338283 locally refined at river regions see table 1 note that there may be slight differences in the computed flow conditions for the uniform meshes because the uniform cell sizes are coarse than the finest cell size of the nonuniform mesh c nevertheless by increasing the total number of cells of the uniform mesh the differences would be diminished for the nonuniform mesh c the computational costs of the gpu model and the gpu lts model are 50219 26 s and 2650 42 s respectively and the speedup of the gpu lts model is 18 95x for the uniform mesh d the computational costs of the gpu model and the gpu lts model are 4137 05 s and 351 79 s respectively and the speedup ratio of the gpu lts model is 11 76x similarly the speedup ratios are 11 45x for mesh e 12 81x for mesh f and 11 20x for mesh g obviously with the nonuniform mesh c the increase in efficiency is more pronounced than with the uniform meshes it is understandable because the finest resolution is used for the main channel however it should be noted that the lts benefit over the uniform mesh is also significant this can be explained by fig 14 and fig 15 which demonstrate the spatial distributions of the computed flow conditions fig 14 a b and fig 15 a b water depth fig 14 c d and fig 15 c d velocity and the grade exponents fig 14 e f and fig 15 e f at two instants for the nonuniform mesh c fig 14 and the uniform mesh d fig 15 respectively from fig 14 and fig 15 the overall spatial distribution of the grade exponent exhibits a similar pattern as the overall spatial distribution of the flow conditions for both the nonuniform mesh c and the uniform mesh d for the regions i e the main channels with relatively large water depth and flow velocity about 10 1 100 m and 10 1 100 m s the grade exponent is relatively small equal to zero or unity whereas for the regions i e the hillsides with negligible water depth and flow velocity about 10 3 10 2 m and 10 3 10 2 m s the grade exponent is relatively large equal to four or five this indicates that the spatial distribution of the flow conditions has a significant effect on the spatial distribution of the grade exponent for simulations of rainfall runoff processes note that such a large difference in water depth in the order of millimeters on the hillsides and in the order of meters in the river and velocity in the order of millimeters per second on the hillsides and in the order of meters per second in the river is a typical feature of rainfall runoff flows such peculiar features make these phenomena an ideal application of the lts model with regards to the effects of the lts scheme on the numerical accuracy taking an experimental scenario i e scenario 1 with nonuni 1 and a field scenario i e scenario 5 with mesh c as examples we have compared the numerical solutions between the gpu lts model using the lts and the gpu model without using the lts by the l2 norm 17 l 2 f 1 n n 1 n f gpu lts n f gpu n 2 where n is the number of numerical solution data at a given time f gpu lts and f gpu represent numerical solutions from the gpu lts model and the gpu model respectively the symbol f represents physical variables such as discharge and water level for scenario 1 the l2 norm between computed discharge at the outlet for rainfall 1 of the two models about 10 7 10 5 m3 s when m max 5 and about 10 9 10 7 m3 s when m max 1 is much smaller than the l2 norm between the gpu model and the measured data about 10 5 10 3 m3 s by about two orders of magnitude fig 16 a also for scenario 5 the l2 norm between the computed water level at the four stations of the two models about 10 5 10 3 m when m max 5 and about 10 6 10 4 m when m max 1 is much smaller than the l2 norm between the gpu model and the measured data about 10 1 100 m by about two orders of magnitude fig 16b thus integrating the lts method in the gpu lts model has a negligible effect on the numerical accuracy of the present rainfall runoff simulations 5 conclusion in this work a gpu accelerated and lts based finite volume shallow water model is extended for simulations of rainfall induced flood processes satisfactory quantitative accuracy is obtained for simulating four experimental scenarios when applied to the hexi basin of zhejiang province china the model also captures the main patterns of rainfall induced flooding although the model parameters could not be well specified for computational efficiency the coupled lts method and gpu acceleration gpu lts version significantly improve the computational efficiency when compared with gpu acceleration only gpu version applying the lts method can bring considerable computational efficiency improvements for both uniform and nonuniform meshes specifically the lts method brings speedup ratios of over 2 93x up to 18 95x with nonuniform meshes and over 1 68x and up to 12 81x with uniform meshes in the scenarios simulated here meanwhile the computational overhead of lts implementation only accounts for 1 2 of the total computational cost which is negligible as compared to the benefits of the lts scheme in addition the present rainfall runoff simulations indicate that integrating the lts method in the gpu lts model has a negligible effect on the numerical accuracy thus the tradeoff between numerical accuracy and computational efficiency can be further relaxed by gpu acceleration coupled with the lts method in rainfall runoff simulations credit authorship contribution statement jingxiao wu methodology formal analysis peng hu supervision software writing review editing zixiong zhao software data curation ying tien lin project administration zhiguo he resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was supported by the key project of changjiang waterway bureau project no k16 529112 016 changjiang waterway institute of planning and design the national natural science foundation of china grant no 12172331 the zhejiang natural science foundation grant no lr19e090002 the hpc center of zju zhoushan campus and hangzhou zhiyun water technology company limited 2021 kyy 529112 0026 
1709,reliable hydrodynamic modeling of rainfall runoff processes in basins requires simulations with high resolution or locally refined meshes which leads to a great increase in the computational costs in traditional gpu accelerated gpu graphics processing unit hydrodynamic models here a gpu accelerated and lts based lts local time step finite volume shallow water model is extended for rainfall runoff simulations by coupling with the green ampt model the model performance is demonstrated by simulating four experimental and one field rainfall runoff scenarios a satisfactory agreement is obtained between simulation results and the available measured data for four experimental scenarios indicating that the model can well simulate rainfall runoff processes when applied to the hexi basin of zhejiang province china the model also captures the main patterns of rainfall induced flooding though model parameters cannot be well specified inter comparisons of the computational efficiency indicate that implementing the lts method brings considerable additional improvements over the gpu acceleration for simulations with uniform or nonuniform meshes specifically the maximum speed up ratio can be as high as over 10x for the present simulations keywords rainfall runoff hydrodynamic model local time step gpu locally refined mesh data availability no data was used for the research described in the article 1 introduction rainfall runoff related flood is one of the world s most serious natural disasters numerical modeling is an effective tool for decision making and risk management the last several decades have witnessed the development of both hydrological and hydrodynamic models for rainfall runoff processes singh et al 2015 in hydrological models a simplified version of the mass or momentum equation is used to avoid directly solving the non linear hydrodynamic processes costabile et al 2013 mcmillan and brasington 2008 hydrodynamic models in contrast solve the fully nonlinear systems of shallow water equations huang et al 2019 paiva et al 2011 by hydrodynamic modeling detailed hydrodynamic characteristics can be captured such as the flood arrival time the inundation area water depth and velocity barbero et al 2022 bellos et al 2020 bernard et al 2022 caviedes voullieme et al 2012 liang et al 2016 rong et al 2020 schubert et al 2008 smith and liang 2013 xia et al 2019 xia et al 2017 however a high computational cost is required for hydrodynamic modeling in particular when a basin scale rainfall runoff process is simulated in this regard graphic processing units gpus have been widely used buttinger kreuzhuber et al 2022 caviedes voullième et al 2023 echeverribar et al 2019 fernandez pato and garcia navarro 2021 fernandez pato et al 2020 kesserwani and sharifian 2023 lacasta et al 2015 meurice and soares frazao 2020 morales hernandez et al 2021 sharifian et al 2022 vacondio et al 2017 vacondio et al 2014 wang et al 2014 for instance liang and smith 2015 developed a gpu based high performance integrated hydrodynamic modeling system hi pims in conjunction with 2 m accuracy topography to simulate uniform rainfall runoff processes on 0 39 km2 of cockenzie street glasgow aureli et al 2020 simulated a flood event in the western emilia romagna apennine region topographic accuracy 1 m dem of the river valley inlaid through gis in the dem available of the region with a square mesh of size 20 m while the gpu acceleration can greatly improve the computational efficiency of rainfall runoff simulations another potential constraint for the computational efficiency lies in the following specifically most of these hydrodynamic models have adopted the globally minimum value of the locally allowable maximum time step for solution updating of all computational cells given that the time step for solution updating with explicit schemes is based on courant friedrichs lewy cfl constraint the locally allowable maximum time step for each cell must be different except the simulation of uniform flow over uniform computational size therefore using the globally minimum time step gts must be very time demanding this is particularly true when locally refinement of the computational cell is necessary caviedes voullieme et al 2012 costabile and costanzo 2021 garcía alén et al 2022 which is common for rainfall runoff simulations in this regard many efforts have been devoted to designing smarter methods for solution updating of hydrodynamic models examples include the implicit dual time stepping method yu et al 2015 the exponential time integration method gaudreault and pudykiewicz 2016 as well as the graded local time step lts method hu et al 2020 hu et al 2019a hu et al 2019b li et al 2020 trahan and dawson 2012 among these methods the lts method appears very promising because it avoids the extra computational cost by using graded time steps that are comparable to the locally allowable maximum time step of every cell dazzi et al 2016 dazzi et al 2018 kesserwani and liang 2015 sanders 2008 using the lts method hu et al 2022 simulated tidal flows in yangtze estuary and hangzhou bay in this application an order of magnitude faster in computational efficiency is noted as compared to a traditional model however the lts method has not been used in flood simulation based on the rainfall runoff process in this work the finite volume shallow water model hu et al 2022 is further extended to rainfall runoff simulations it is achieved by treating the rainfall intensity and infiltration rate as source terms in the governing equations in particular the model is implemented on gpu using the nvidia cuda framework for parallelized computation and the lts method is used for solution updating the model accuracy is demonstrated by simulating rainfall runoff processes through the experiments in the laboratory and outdoors as well as conducted in the hexi basin in jingning county china section 2 briefly describes the mathematical formulations including the governing equations empirical relations for the rainfall and infiltration treatments as well as the numerical methods the finite volume discretization using the lts method and the gpu acceleration section 3 presents simulation results and discussions particular attention is paid to the additional reduction of the computational cost induced by the lts method over the gpu acceleration section 4 further discusses the factors influencing the lts benefits as well as the effects of the lts method on the numerical accuracy section 5 gives the conclusions 2 mathematical formulations 2 1 governing equations and empirical relations the governing equations are written in vector form as follows 1 u t f x g y s s s b s f 2 u h hu hv f hu h u 2 g h 2 2 huv g hv huv h v 2 g h 2 2 s s r i 0 0 s b 0 gh s bx gh s by s f 0 g h s fx g h s fy where u is the vector for the conserved physical variables f g are flux term vectors containing the advective terms and hydrostatic pressures s s s b and s f are the source term vectors containing rainfall infiltration bed slope and friction terms t is time x y are horizontal directions h is water depth u v are depth averaged velocities in the x and y directions respectively g 9 8 m s2 s bx z b x and s by z b y are the bed slopes where z b is the bed elevation s fx n 2 u u 2 v 2 h 4 3 and s fy n 2 v u 2 v 2 h 4 3 are the friction slopes where n is the manning roughness r is the rainfall intensity which is specified according to specific case conditions i is the soil infiltration rate the soil infiltration rate was determined using the revised green ampt model liu and singh 2004 mein and larson 1973 according to the green ampt model there is a downward extending wetting front in the soil which acts as a demarcation the soil is considered saturated above the wetting front and unsaturated below the wetting front the model assumes that the wetting front can extend downwards indefinitely and ignores the horizontal diffusion and flow of infiltrated water the infiltration rate can be calculated as follows 3 i di dt k s 1 θ s θ i ψ i where i is the infiltration rate i is the cumulative infiltration quantity k s is the saturated hydraulic conductivity of soil ψ is the suction of wetting frontal θ s is the saturated volumetric water content cm3 cm3 θ i is the initial volumetric water content cm3 cm3 when rainfall intensity r is greater than the infiltration capacity the water begins to pond on the ground when the infiltration rate i r ponding occurs the cumulative infiltration i r can be obtained by the green ampt model as follows 4 i r θ s θ i ψ r k s 1 and the pond time is 5 t r i r r in total the infiltration rate throughout the entire overland flow process can be expressed as 6 i r for t t r k s 1 θ s θ i ψ i r for t t r where t r is the time to reach the ponding time 2 2 numerical methods 2 2 1 finite volume discretization on unstructured triangular cells the governing equations are solved by the finite volume method on unstructured triangular cells fig 1 shows a sketch of the unstructured triangular meshes a an internal triangular cell id i and its three neighboring cells id i 1 i 2 i 3 b a face id j and its neighboring left and right cells id jl jr cell id varies from 1 to nc face id varies from 1 to nf a i is the area of the cell i r ij is the distance from the centroid of the cell i to its jth face where the subscript i represents the cell id and the subscript j 1 2 3 n ij n x n y ij are the normal outward direction of the jth face of the cell i δ l ij is the jth face length of the cell i finite volume discretization of the governing equations on cell i is as follows 7 u i u i δ t i a i j 1 3 e nij δ l ij δ t i s si s bi s fi i 1 2 3 n c where u i and u i are the conserved physical variables of the cell i at the time level t indicated by superscript and the time level t δ t i indicated by superscript δ t i is the local time step see section 2 3 e nij f n x g n y ij is the numerical flux across the jth face of the cell i s si s bi and s fi are the cell averaged source terms specifically the vector s si of the source term for rainfall infiltration is evaluated directly using the rainfall data and empirical formulae with infiltration value at the time level as input the bed slope source term s bi is evaluated using the slope flux method hou et al 2013 with flow variables at the time level as input the bed friction terms are estimated using the splitting point implicit method liang and marche 2009 for the numerical fluxes the hllc harten lax van leer contact approximate riemann solver toro 2001 is adopted for reconstruction of the left and right riemann variables of the interface which are inputs of the hllc solver there are numerous choices including first order ming et al 2020 xia et al 2019 zhao and liang 2022 second order hou et al 2018 liang and marche 2009 wittmann et al 2017 or higher order methods hu et al 2021 here the first order method is used by settling the left and right riemann variables of the interface directly equal to the conserved variables of the two neighboring cells hu et al 2019a hu et al 2019b hu et al 2022 moreover to ensure non negative water depth reconstruction the modification treatment proposed by audusse et al 2004 is implemented before calling the hllc solver the numerical fluxes at external faces that coincide with the boundary of the computational domain are estimated by definition using boundary values water depth flow velocity of the physical parameters yoon and kang 2004 2 2 2 time step estimations this section presents details on how to estimate local time steps it is based on the extended lts method to 2d shallow water modeling based on unstructured triangular meshes proposed by sanders 2008 the first step is to compute the locally allowable maximum time step δ t ami for cell i 8a δ t ami c r r mi u i 2 v i 2 g h i for cells with h i h thr 8b δ t ami an arbitrarily large value e g 100 s here for cells with h i h thr where c r is the courant number which is set to 0 9 h i u i v i are the water depth and flow velocities of the cell i r mi min r i 1 r i 2 r i 3 is the minimum distance from the centroid of cell i to its three faces h thr is a threshold water depth which is specified as 10 6 m the second step is to compute the global minimum value of the time step δ t min 9 δ t min min δ t ami i 1 2 n c the third step is to compute the potential grade exponent m i for all cells 10 m i min int lg δ t ami δ t min lg 2 m user i 1 2 3 n c where int is the rounding function m user is a user defined value to limit the grade exponent and it is set to 5 in this paper the fourth step modifies the potential grade exponent of neighboring cells that are characterized by abrupt flow condition changes i e the wet dry front the static dynamic front following hu et al 2019b specifically the potential grade exponents of the first and second layer cells around a dynamic static front are modified to the locally minimum value the fifth step is to compute the grade exponent m fj for faces 11 m fj min m jl m jr j 1 2 3 n f where the symbols m jl and m jr represent the potential grade exponents of the two neighboring cells around the face j see fig 1b the sixth step is to compute the actual grade exponent m i for cells 12 m i min m i m i 1 m i 2 m i 3 i 1 2 3 n c where the symbols m i 1 m i 2 m i 3 indicate the potential grade exponents of the three neighboring cells of the cell i see fig 1a finally one can find the maximum value m max of the actual grade exponents and the globally maximum time step δ t 13 m max max m i i 1 2 n c 14 δ t 2 m max δ t min 2 3 numerical structures and gpu acceleration fig 2 presents the numerical structures of the present gpu accelerated and lts based hydrodynamic model fig 2a and a traditional gpu accelerated model that does not use the lts method fig 2b in fig 2 blue boxes mean the cpu host tasks whereas green boxes mean the gpu device tasks and grey boxes indicate data transfer between the host and the device from fig 2 the model is initiated on the cpu host by reading data e g mesh information basic parameters boundary conditions such as time series of water level or discharge if any setting initial conditions and computing basic parameters afterwards necessary data are transferred from the host to the device to facilitate gpu acceleration mesh information basic parameters l s s c m user h thr c r boundary conditions for the gpu lts version mesh information basic parameters h thr c r boundary conditions for the gpu version this data transfer occurs once per numerical case of which the overhead is negligible afterwards the time steps are estimated for which the gpu lts version has five kernels kernel cell time step cts computes the locally allowable maximum time step kernel cell potential exponent cpe computes the potential grade exponent kernel cell modified exponent cme modifies the potential grade exponents around dynamic static fronts kernel face final exponent ffe computes the grade exponent of each face kernel cell final exponent cfe computes the actual grade exponent of cells and twice implementations of the reduction algorithm find the globally minimum time step δ t min and the maximum grade exponent of lts m max respectively whereas the gpu version only has one kernel kernel cell time step cts computes the locally allowable maximum time step and one implementation of the reduction algorithm find the globally minimum time step δ t min from above the number of the adopted kernels and reduction algorithms are different due to the use of the lts method using the lts i e the gpu lts model requires 5 kernels and 2 reduction algorithms whereas using the gts the standard gpu model only needs 1 kernel and 1 reduction algorithm after the time step estimation in the device data transfer from the device to the host occurs the maximum grade exponent of lts m max and the globally minimum time step δ t min for the gpu lts version only the globally minimum time step δ t min for the gpu version for the gpu version time levels of flow variables are at the same synchronized time every interval of the globally minimum time step δ t min this results in a very simple numerical structure two kernels are invoked one after the other kernel face flux ff computes numerical fluxes for all faces kernel cell variable cv updates the conserved variables of cells by firstly estimating the rainfall infiltration bed slope and frictions and secondly implement eq 7 in contrast for the gpu lts version time levels of flow variables are at the same synchronized time every interval of δ t δ t 2 m max δ t min in this regard the time interval δ t can be further divided into 2 m max sub cycles with s c 1 2 2 m max indicating the sequence of sub cycles for each sub cycle the parameter s c is firstly transferred from the host to the device afterwards two kernels face flux ff cell variable cv are invoked at each cycle in sub cycles whether or not the numerical flux of a specific face needs to be estimated depends on the property of the ratio s c 1 2 m fj if this ratio is an integer the numerical flux of face j at the s c th sub cycle will be refreshed whether or not the flow variables of a specific cell need to be updated depends on the inequality m i l s s c if this inequality is satisfied flow variables of cell i at the s c th will be updated note that the function l s s c can be seen in hu et al 2019b for variable storage three types of gpu memory are involved variables and big vectors that vary with time are stored in global memory on the device variables that do not vary with time are stored in the constant memory on the device big vectors that do not vary with time mostly vectors about mesh information are stored in texture memory 3 numerical case studies in this section five rainfall runoff scenarios are simulated scenario 1 four events of natural rainfall processes in a small field site with infiltration scenario 2 three events of nonuniform rainfall processes over a 1d impermeable three slope channel scenario 3 nine events of uniform rainfall processes in three physical urban models in total 27 sub scenarios scenario 4 a uniform rainfall process in a 2d slope with infiltration scenario 5 a basin scale rainstorm event these five scenarios cover a wide range of rainfall runoff conditions from small scale experimental rainfall runoff scenarios 1 4 to field scale basin rainstorm scenario 5 from regular terrain scenarios 2 4 to complex terrain scenarios 1 3 5 from uniform rainfall scenarios 3 4 to nonuniform rainfall scenarios 1 2 5 each scenario is simulated by both the gpu version and the gpu lts version over one scenarios 2 4 or several scenarios 1 5 sets of computational meshes in this regard it has been confirmed that differences in numerical solutions between the two versions are negligible accordingly comparisons of the two models are focused on their relative computational efficiency and whether the model can well simulate rainfall runoff processes the computational efficiency of the gpu lts version is quantified by the speedup ratio s defined as follows 15 s t gpu t gpu l t s t gpu and t gpu l t s are the run times of the gpu version and the gpu lts version respectively the ratio s quantifies the effect of the lts approach on gpu acceleration s 1 indicates that the lts has no effect and both versions are equally efficient s 1 indicates that the lts damages the model efficiency and accordingly the gpu version is more efficient s greater than 1 indicates that the lts improves the model efficiency and thus the gpu lts version is more efficient the nash sutcliffe efficiency nse coefficient is introduced to quantify the quantitative accuracy of the model 16 nse 1 k 1 n f k com f k mea 2 k 1 n f k com f 2 where n is the number of the measured variables f k mea is the measured data and f k com is the corresponding computed data the subscript k 1 2 3 n f is the mean of the measured data the symbol f represents physical variables such as water level discharge the nse ranges between minus infinity poor fitted and one perfect fitted following da silva et al 2015 an nse value over 0 75 indicates an excellent performance of the model while an nse value between 0 4 and 0 75 indicates a satisfactoryfit and an nse value smaller than 0 4 suggests anunsatisfactory fit for description convenience table 1 summarizes the mesh information total number of cells nonuniformity of the meshes for all simulations the computational costs for the gpu version and gpu lts version the speedup ratios of the gpu lts version and the model accuracy statistics the nonuniformity of the meshes has three parameters the mean equivalent face lengths l the geometric standard deviation σ and the gradient coefficient g the equivalent face length is firstly computed for each cell as the square root of the cell area based on this the mean equivalent face length l 50 the gradient coefficient g 1 2 l 84 1 l 50 l 50 l 15 9 and the geometric standard deviation σ l 84 1 l 15 9 can be computed where l 50 l 84 1 and l 15 9 are 50 84 1 and 15 9 shorter face lengths respectively 3 1 scenario 1 natural rainfall processes in a small field site with infiltration the first testing scenario is from esteves et al 2000 where four rainfall events see fig 3 a occurred on a 14 25 m long and 5 m wide field site see fig 3b as shown in fig 3b three sides of the site are concrete walls and the lowest side is a free outlet where the runoff discharge was measured before each rainfall the initial soil volumetric water content θ i was measured θ i 0 100 0 106 0 085 and 0 082 for the four rainfall events the saturated water content θ s 0 296 and the suction of wetting frontal ψ 1 2495 were also measured esteves et al 2000 the manning roughness is set to 0 2 s m1 3 following singh et al 2015 the saturated hydraulic conductivity of soil k s is set to 3 5 10 6 m s to test the grid convergence of the model and also investigate the lts performance on different meshes the four rainfall events are simulated by 12 sets of meshes including six uniform meshes uni 1 uni 6 and six non uniform nonuni 1 nonuni 6 meshes see table 1 the total number of cells for both uniform and nonuniform meshes ranges from about 104 to about 32 104 correspondingly the ranges of the mean equivalent lengths for both the uniform and nonuniform meshes are also similar from about 0 1 m to about 0 01 m however the geometric standard deviation σ and the gradient coefficient g differ greatly for the six uniform meshes σ 1 and g 1 whereas for the six nonuniform meshes σ 1 36 6 64 and g 1 36 19 60 for illustrative purposes the nse results and computational efficiency for all simulations of rainfall 1 and one simulation using the nonuniform but coarsest mesh of rainfall 2 4 are summarized in table 1 the following can be observed from these statistics first the nse values for the 12 simulations are about 0 90 0 91 with negligible differences this indicates that the numerical solutions are independent of the mesh sizes and thus the adopted mesh sizes are adequate for numerical simulations second the lts brings significant additional reductions in computational cost and such reductions are much more obvious over nonuniform meshes than reductions over uniform meshes specifically the ratios s for simulations over uniform meshes range from 1 68x to 8 60x with m max 4 whereas those over nonuniform meshes range from 4 20x to 11 72x with m max 5 this is understandable because nonuniform meshes result in more nonuniform distribution of the locally allowable maximum time step generally a larger muser value leads to higher computational efficiency nevertheless when the muser value is sufficiently large its further increase leads to mild reduction in the computational cost it is understandable because the maximum extent of reduction in the computational cost depends on the nonuniformities of both the cell sizes and the flow conditions if either the flow intensity or the mesh is more nonuniform it can be expected that a further increase in muser can lead to further reduction of the computational cost fig 4 shows the measured and computed discharge hydrographs at the outlet for four rainfall events from fig 4 the computed discharge hydrographs agree satisfactorily with the measured data specifically the nse coefficients are about 0 91 0 58 0 51 and 0 87 for rainfall 1 4 see table 1 respectively from fig 4 the discharge hydrograph is single peak in rainfall 2 and multi peak in rainfall 1 3 and 4 the shape of the discharge hydrographs at the outlet depends on topography characteristics and rainfall processes the field site is almost plain with mild slopes so the hydrograph is mainly influenced by the rainfall process only the rainfall process of rainfall 2 is single peak and therefore the discharge hydrograph of rainfall 2 also shows the shape of single peak in addition despite the satisfactory level of nse in rainfall 2 there are some differences in the computed and measured time of runoff peaks such errors should be attributed to uncertainties of empirical parameters overall the variations of the computed hydrographs agree with the respective measured hydrographs this demonstrates the ability of the model to capture the infiltration behavior of the soil 3 2 scenario 2 nonuniform rainfall processes over a 1d impermeable three slope channel the laboratory investigation of nonuniform rainfall over an impermeable three slope channel proposed by iwagaki 1955 is used as the second testing scenario in this experiment a series of artificial rainfall is applied on an aluminum laboratory flume with a three plane cascade surface the flume is 24 m long and divided into three equal 8 m slope sections equally with slopes of 0 2 0 15 and 0 1 respectively from upstream to downstream the rainfall intensities are 3890 2300 and 2880 mm h applied to the up middle and downstream of the flume respectively three rainfall durations of 10 s 20 s and 30 s are considered resulting in three sub scenarios solid slip conditions are imposed at the flume s upstream and lateral walls and the downstream is a free outlet the bed is initially dry a total of 107 417 cells are used with l50 0 005 m σ 1 31 g 1 36 the speedup ratios of the gpu lts version are 3 60x 3 54x and 3 48x with m max 5 for the three sub scenarios fig 5 shows the unit discharge hydrographs at the outlet for the three sub scenarios each hydrograph at the outlet peaks at approximately t 30 s when upstream flows with larger momentum catch up with downstream flows with smaller momentum the magnitude of the peak increases as the duration of rainfall increases the simulated results agree satisfactorily with the measured data in both the ascending and recession parts with the nse coefficient of 0 44 0 95 and 0 97 for the three sub scenarios for the first sub scenario rainfall duration of 10 s in the numerical simulation the peak occurs slightly later than the observed value whereas for the second and third sub scenarios rainfall durations of 20 s and 30 s respectively the simulated results agree very well with the measured results throughout the rise and fall of the discharge hydrographs at the outlet section this is important as in real conditions the rainfall duration is mostly not short these demonstrate the ability of the model to simulate nonuniform rainfall processes with different durations over irregular topography 3 3 scenario 3 uniform rainfall processes in physical urban models the third testing scenario is the laboratory experiment in a rectangular pool measuring 2 m 2 5 m conducted by cea et al 2010 the topography of the rainfall simulator basin is irregular and the accurate topographic elevation is determined by interpolating the measured contour lines in addition different urban configurations are built in the simulator basin including three placements of buildings x20 y20 and s20 see fig 6 a geometrical representation of buildings is used following schubert and sanders 2012 by manipulating the heights assigned to vertices of the computational mesh rainfall is produced with 100 nozzles evenly distributed in a basin the infiltration process does not need to be considered since the bed is impermeable experimental conditions include three rainfall discharges of 7 q7 15 q15 and 25 q25 l min uniformly distributed in space these three rainfall discharges and the three building placements result in nine sub scenarios which are named x20q7 x20q15 x20q25 y20q7 y20q15 y20q25 s20q7 s20q15 s20q25 take the first name as an example it means a rainfall discharge of 7 l min over the bed topography of x20 placement moreover three different rainfall durations 20 s 40 s and 60 s respectively are implemented on each of these nine sub scenarios and thus there are in total 27 simulations a total of 86 832 triangular cells are used with l50 0 004 m σ 1 47 g 1 53 the speedup ratios of the gpu lts version are 3 08x 3 49x for the 27 simulations with m max 5 fig 7 shows the measured and computed discharge hydrographs at the outlet of the simulator basin the computed values agree excellently with the measured data with the nse coefficient of at least 0 86 for all the 27 simulations despite the large bed slopes involved in the simulations the algorithm remains stable and the global accuracy of the model is unaffected this is of great importance for extreme flow conditions fig 8 shows the computed water depth distribution at different transients for the sub scenario s20q25 with a duration of 60 s from the three placements of buildings x20 y20 s20 tested s20 requires the finest mesh resolution because the buildings are the closest to each other it can be observed that the fine mesh resolution used in the simulation allows the shapes of the buildings to be well described it is important because if the shapes are not well resolved artificial barriers through which the runoff cannot flow are formed this effect hampers the runoff among the buildings and thus affects the discharge hydrographs at the outlet from fig 8 the buildings act to hamper the runoff leading to the ponding around them based on the low bed topography of the downstream medial axis in the simulator basin the simulations capture well the obstructive effect of buildings on runoff in physical urban models 3 4 scenario 4 a uniform rainfall process in a 2d slope with infiltration the rainfall runoff experiment in a 1 0 m 0 5 m laboratory soil flume with a slope of 0 1 proposed by de lima 1992 is used as the forth testing scenario the upstream and sides are impermeable and the downstream is free to flow out a uniform rain intensity of 3 741 10 5 m s is applied for 900 s the parameters of the green ampt model are set according to de lima 1992 as follows k s 1 67 10 6 m s ψ 0 02 m θ i 0 506 and θ s 0 0107 initially the slope is dry the model simulation time is 1200 s a total of 25 526 cells are used with l50 0 004 m σ 1 69 g 1 69 the speedup ratio of the gpu lts version is 5 83x with m max 5 fig 9 compares the computed and measured unit discharge hydrographs at the downstream outlet the simulation includes two situations with infiltration red line in fig 9 and without infiltration black line in fig 9 from fig 9 whether or not infiltration is included in the simulation has a significant impact on the discharge hydrographs of the outlet and the scenario can be accurately simulated when infiltration is included quantitatively the computed values agree excellently with the measured data with the nse coefficient of 0 82 note that the computed discharge hydrograph shows a more rapid rise at the beginning compared to the measured data this is because the surface of the slope always has to some extent ponding capability liu and singh 2004 which is neglected in the current model 3 5 scenario 5 a basin scale rainstorm event in this section a rainfall induced flood in the hexi basin of zhejiang province see fig 10 for the rainfall process the specific location of the basin and the bed topography and the land use type distributions is numerically simulated the hexi basin has a watershed area of 51 1 km2 and a complex topography sloping from southeast to northwest the hexi river runs through the basin with a total length of 15 32 km and a river slope of 34 5 there are four river water level stations in the basin the xikou the hexi the hanta and the sanzhishu stations see fig 10b water level series measured at these four river stations are available for model validation the rainfall occurred from 18 00 on july 8th to 5 00 on july 10th in 2020 see fig 10a the maximum rainfall intensity is about 38 mm h and the total precipitation is 235 8 mm the rainfall process is given in fig 10a as hourly averaged rainfall intensity and uniform rainfall over the catchment is considered in the model the manning roughness is assigned based on land use types 0 15 for the roughness of the mixed forest area 0 025 for the artificial surface area 0 03 for the river region 0 035 for the agriculture area and 0 05 for other land areas the manning roughness is from the suggested value in hydraulic textbooks e g chow 1959 the infiltration parameters are set as follows θ s 0 4 θ i 0 15 k s 3 10 6 m s ψ 1 5 m the downstream boundary is set by the stage discharge relationship z 0 064 q 0 543 148 85 where z and q is the water level and the discharge at the river cross section coinciding with the downstream boundary before the simulation pre run the model on a dry bed during the pre rainfall process to produce an initial flow discharge of 75 m3 s for subsequent simulations with the similar method in huang et al 2015 and xia et al 2019 to compare the computational efficiency of the gpu version and the gpu lts version on different meshes three sets of meshes are tested for this scenario with the total number of cells equal to 148 406 mesh a 209 923 mesh b 338 283 mesh c respectively the three sets of meshes are all refined at river regions with l50 19 660 m 16 278 m and 7 381 m respectively fig 11 compares the documented from the local administration office and digitalized by the three meshes bed elevation transects at the four stations from fig 11 it is shown the finer the mesh the closer digitalized bed elevation transects are to documented values the comparison of the computational efficiency of the two versions is shown in table 1 the speedup ratios of the gpu lts version are 13 25x 16 41x and 18 95x for mesh a b and c respectively the speedup ratios of the gpu lts version are higher than the previous four scenarios it is because the degree of run time reductions depends on the nonuniformities of both the cell sizes and the flow conditions for rainfall and runoff simulations in real basins with complex topography the flow conditions are very non uniform fig 12 shows the water depth distribution at 7 8 18 00 7 9 4 00 7 9 9 00 and 7 10 0 00 during the rainstorm stormwater flows across the basin land into the river and the water levels in the river rise as a response to the rainfall as the intensity of rainfall increases the runoff intensity increases and the water level in the river shows a significant rise in the later stages of the rainfall the rainfall intensity decreases and the water level in the river gradually drops accordingly fig 13 compares the measured and computed water level hydrographs with three sets of meshes at four stations computed results for different meshes vary due to the different accuracy of the topography description overall the computed hydrographs by the finer meshes are closer to the measured values the nse coefficients for the xikou the hexi the hanta and the sanzhishu stations are 0 15 0 78 0 89 and 0 45 respectively with mesh c the simulation results show satisfactory agreement with the measured data for all stations except for the xikou station this is understandable because the xikou station is close to the outlet boundary of the calculation domain and thus subject to high sensitivity to outlet boundary conditions also the quantity of the measured data is not satisfactory for basin scale scenarios nevertheless the present numerical scenario studies of the rainstorm event in the hexi basin indicate that with the present data availability it is likely to have these main patterns of the flood e g the arrival time the magnitudes of flood peak captured by the current models 4 discussion this section is devoted to discussions on 1 to what extent the additional lts codes may affect the computational efficiency i e the lts overhead 2 the attractiveness of the lts benefits to the simulation of rainfall runoff processes by discussing the relative contributions of nonuniformities of cell sizes and flow conditions and finally 3 the effects of the lts scheme on the numerical accuracy with regards to the lts overhead on computational cost we have compared the computational costs of two gpu models one is obtained from the present gpu lts model by setting muser 0 the other is the standard gpu model that does not include the lts codes at all numerical tests show that the lts overhead only accounts for 1 2 of the total computational cost which is negligible compared to the benefits of the lts method since one focus of the present paper is to apply the lts method to the simulation of rainfall runoff processes it is interesting to check the attractiveness of the lts benefits for such flows it is completed by discussing the relative contributions of the nonuniformities of cell sizes and flow conditions to the lts benefits the motivation is twofold first both the cell size and the flow condition affect the locally allowable maximum time step see eq 8 second rainfall runoff flows may be particularly nonuniform because when water flows from hillsides to main channels it may be subject to great variation in the water depth and flow velocity in this regard we have re simulated scenario 5 using four sets of uniform meshes mesh d mesh g total number of cells 334 638 for mesh d 656 470 for mesh e 972 587 for mesh f and 1 539 839 for mesh g and compared their lts benefits against the lts benefits for the simulation with the nonuniform mesh c total number of cells 338283 locally refined at river regions see table 1 note that there may be slight differences in the computed flow conditions for the uniform meshes because the uniform cell sizes are coarse than the finest cell size of the nonuniform mesh c nevertheless by increasing the total number of cells of the uniform mesh the differences would be diminished for the nonuniform mesh c the computational costs of the gpu model and the gpu lts model are 50219 26 s and 2650 42 s respectively and the speedup of the gpu lts model is 18 95x for the uniform mesh d the computational costs of the gpu model and the gpu lts model are 4137 05 s and 351 79 s respectively and the speedup ratio of the gpu lts model is 11 76x similarly the speedup ratios are 11 45x for mesh e 12 81x for mesh f and 11 20x for mesh g obviously with the nonuniform mesh c the increase in efficiency is more pronounced than with the uniform meshes it is understandable because the finest resolution is used for the main channel however it should be noted that the lts benefit over the uniform mesh is also significant this can be explained by fig 14 and fig 15 which demonstrate the spatial distributions of the computed flow conditions fig 14 a b and fig 15 a b water depth fig 14 c d and fig 15 c d velocity and the grade exponents fig 14 e f and fig 15 e f at two instants for the nonuniform mesh c fig 14 and the uniform mesh d fig 15 respectively from fig 14 and fig 15 the overall spatial distribution of the grade exponent exhibits a similar pattern as the overall spatial distribution of the flow conditions for both the nonuniform mesh c and the uniform mesh d for the regions i e the main channels with relatively large water depth and flow velocity about 10 1 100 m and 10 1 100 m s the grade exponent is relatively small equal to zero or unity whereas for the regions i e the hillsides with negligible water depth and flow velocity about 10 3 10 2 m and 10 3 10 2 m s the grade exponent is relatively large equal to four or five this indicates that the spatial distribution of the flow conditions has a significant effect on the spatial distribution of the grade exponent for simulations of rainfall runoff processes note that such a large difference in water depth in the order of millimeters on the hillsides and in the order of meters in the river and velocity in the order of millimeters per second on the hillsides and in the order of meters per second in the river is a typical feature of rainfall runoff flows such peculiar features make these phenomena an ideal application of the lts model with regards to the effects of the lts scheme on the numerical accuracy taking an experimental scenario i e scenario 1 with nonuni 1 and a field scenario i e scenario 5 with mesh c as examples we have compared the numerical solutions between the gpu lts model using the lts and the gpu model without using the lts by the l2 norm 17 l 2 f 1 n n 1 n f gpu lts n f gpu n 2 where n is the number of numerical solution data at a given time f gpu lts and f gpu represent numerical solutions from the gpu lts model and the gpu model respectively the symbol f represents physical variables such as discharge and water level for scenario 1 the l2 norm between computed discharge at the outlet for rainfall 1 of the two models about 10 7 10 5 m3 s when m max 5 and about 10 9 10 7 m3 s when m max 1 is much smaller than the l2 norm between the gpu model and the measured data about 10 5 10 3 m3 s by about two orders of magnitude fig 16 a also for scenario 5 the l2 norm between the computed water level at the four stations of the two models about 10 5 10 3 m when m max 5 and about 10 6 10 4 m when m max 1 is much smaller than the l2 norm between the gpu model and the measured data about 10 1 100 m by about two orders of magnitude fig 16b thus integrating the lts method in the gpu lts model has a negligible effect on the numerical accuracy of the present rainfall runoff simulations 5 conclusion in this work a gpu accelerated and lts based finite volume shallow water model is extended for simulations of rainfall induced flood processes satisfactory quantitative accuracy is obtained for simulating four experimental scenarios when applied to the hexi basin of zhejiang province china the model also captures the main patterns of rainfall induced flooding although the model parameters could not be well specified for computational efficiency the coupled lts method and gpu acceleration gpu lts version significantly improve the computational efficiency when compared with gpu acceleration only gpu version applying the lts method can bring considerable computational efficiency improvements for both uniform and nonuniform meshes specifically the lts method brings speedup ratios of over 2 93x up to 18 95x with nonuniform meshes and over 1 68x and up to 12 81x with uniform meshes in the scenarios simulated here meanwhile the computational overhead of lts implementation only accounts for 1 2 of the total computational cost which is negligible as compared to the benefits of the lts scheme in addition the present rainfall runoff simulations indicate that integrating the lts method in the gpu lts model has a negligible effect on the numerical accuracy thus the tradeoff between numerical accuracy and computational efficiency can be further relaxed by gpu acceleration coupled with the lts method in rainfall runoff simulations credit authorship contribution statement jingxiao wu methodology formal analysis peng hu supervision software writing review editing zixiong zhao software data curation ying tien lin project administration zhiguo he resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was supported by the key project of changjiang waterway bureau project no k16 529112 016 changjiang waterway institute of planning and design the national natural science foundation of china grant no 12172331 the zhejiang natural science foundation grant no lr19e090002 the hpc center of zju zhoushan campus and hangzhou zhiyun water technology company limited 2021 kyy 529112 0026 
