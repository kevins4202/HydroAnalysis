index,text
21705,in this paper the event triggered composite adaptive fuzzy control laws are developed to control both the surge speed and the heading angle of the sailboat the fuzzy logic systems flss are employed to approximate the nonlinearities in the model of the sailboat to enhance the approximating accuracy a serial parallel estimation model is established at first and the composite adaptive laws of the fls weights are then derived by combining the tracking errors with the prediction errors between the estimation model and the dynamic loop of the sailboat to prevent the sailboat from capsizing we consider the heeling constraint in the roll motion during the voyage by using the backstepping method the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are fabricated to offset the input saturation of the sail and the rudder which are incorporated into the control laws to reduce the acting frequencies of the actuators the control laws for the sail and the rudder are designed in the event triggered form and the triggering conditions are constructed separately the uncertain gain of the rudder is estimated by the adaptive laws the proposed control scheme can guarantee the semi global uniformly ultimate boundedness sguub of all the errors through the numerical path following test the effectiveness of the proposed scheme is verified keywords sailboat event triggered control etc composite adaptive fuzzy control heeling constraint input saturation 1 introduction the navigational cybernetics have been rapidly developing since the human society entered the third industrial revolution nowadays the ship tends to be more versatile and intelligent than its past throughout the development of navigational cybernetics much experience was drawn from the advanced control techniques for generic nonlinear systems such as jiang 2002 do 2010 and deng et al 2019a and the references therein in the background of energy crisis the saving of energy becomes one of the keynote development themes of navigational cybernetics for this theme the wind assisted ship is more competitive than the common powered ship especially in the long term and wide range task however in contrast to numerous researches on the control of the common powered ship it lacks experience to control the sailboat which is pretty challenging due to the variability and uncontrollability of the wind following the separate principle the control of the sailboat can be divided into two aspects of the sail and the rudder regardless of coupling the surge motion of the sailboat is mainly controlled by the sail and the yaw motion by the rudder for the sail the control input boils down to the sheeting angle of the sail the existing researches mostly concentrated on maximizing the surge speed of the sailboat and some optimization algorithms of the sheeting angle were proposed such as the quantified set inversion in herrero et al 2010 the extremum seeking in xiao et al 2012 corno et al 2016 deng et al 2019c and shen et al 2019 nevertheless the surge speed cannot be controlled to a specific value in these researches as the strong maneuverability is required for a sailboat in the busy water zhang et al 2018 this control objective is pretty realistic and can be achieved based on the known aerodynamics of the sail in deng et al 2019e an event triggered robust fuzzy control scheme was proposed to control the surge speed of the wing sailed catamaran where the fls was employed to approximate the nonlinearity in the surge motion because the roll motion was exempted for the wing sailed catamaran this approach cannot extend to the mono hull sailboat the roll motion of the mono hull sailboat is strongly influenced by the regulation of the sail for which the constraint of the heeling angle should be considered thus the previous optimization and control algorithms are not practical for the sailboat and may result in capsizing sometimes as we have learnt stelzer et al 2007 used the fls to describe the tuning principle for the sail which chose the heeling angle as the input although the heeling constraint was addressed in this scheme it was based on artificial expertise and may degrade the propulsion efficiency of the sail for the rudder the control input boils down to the rudder angle without the model of the sailboat elkaim and kelbley 2006 cruz and alves 2010 and jaulin and bars 2013 designed the pid controller for the rudder stelzer et al 2007 designed the fls based rudder controller with the deterministic model herrero et al 2010 referred to the feedback linearization method to design the controller xiao and jouffroy 2011 and he et al 2012 designed the backstepping based controllers for the rudder and the weight balancing system respectively to deal with the uncertainties xiao and jouffroy 2014 developed a robust control scheme by tuning the parameters and deng et al 2019e resorted to the robust fuzzy damping technique nevertheless these schemes were conservative and may result in the unnecessarily large control inputs in deng et al 2019d the adaptive neural rudder controller was designed with the minimum learning parameters where the control performance was strongly concerned with the approximating accuracy of the neural networks nns however the adaptive law therein can only guarantee the closed loop stability rather than the identification of the model uncertainties and the interpretability of the nns this problem has been discussed for the strict feedback nonlinear systems in xu et al 2014 li and tong 2015 and li et al 2016 where the composite learning was proposed as a solution because the model of the sailboat does not belong to the strict feedback system these approaches cannot be directly applied to the control of the sailboat to our knowledge there is no such attempt at present another problem of the above researches consists in the uncertainty of the rudder in xiao and jouffroy 2014 the nonlinearity of the rudder was simplified as a sine function deng et al 2019d assumed that the fitting error between the sine function and the lift coefficient of the rudder was upper bounded by a known constant deng et al 2019e assumed that both the upper and lower bounds of the gain of the rudder were known these schemes utilized the robust design to offset the uncertainty of the rudder in compliance with the nautical practice the input saturation should be considered in the above control schemes although he et al 2012 jaulin and bars 2013 xiao and jouffroy 2014 saoud et al 2015 and deng et al 2019c d constrained the operating range of the rudder these schemes did not analyze the influence of the input saturation on the stability in ma et al 2019 and deng et al 2019a e the sigmoid functions were introduced to approximate the saturation nonlinearities of the actuators through the mean value theorem the saturation nonlinearity was transformed to the formula with the bounded gain and the approximating error in zheng et al 2018 the uncertainty observer was fabricated to offset the lumped uncertainties including the control error through the input saturation yan and wang 2012 and peng et al 2019 studied the model predictive control for surface and underwater marine crafts where the tracking control was transformed to the neurodynamic optimization with a series of constraints including the input saturation nevertheless the above methods cannot be applied to the adaptive control of the sailboat another practical issue consists in the acting frequency of the actuator the lower acting frequency will reduce the mechanical wear and elongate the service life of the actuator the event triggered control provides a solution to this problem this method functions in an intelligent manner where the control happens only when the triggering condition is violated and it was introduced to the navigational cybernetics in jiao and wang 2016a b deng et al 2019a and guo et al 2019 due to the variability of the wind the acting of the actuators in the sailboat is more frequent than that in the common powered ship thus the etc is more significant for the sailboat deng et al 2019e first investigated the etc for the wing sailed catamaran and combined the etc with the robust fuzzy damping although li and yang 2018 and cao et al 2018 have combined the etc with the adaptive nns or flss for the pure feedback and strict feedback systems this issue is left to be considered for the sailboat motivated by the above challenges this paper develops a unified event triggered adaptive fuzzy control scheme for the sailboat a serial parallel estimation model is established for the dynamic loop of the sailboat on this basis we derive the composite adaptive laws of the fls weights in this paper the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are constructed to offset the control error through the input saturation the adaptive laws are fabricated to estimate the uncertain gain of the rudder the contribution of this paper is mainly threefold 1 compared with the existing adaptive neural and fuzzy control schemes for marine crafts the composite learning of the flss can ensure both the closed loop stability and the identification of the uncertainties such that the tracking performance is improved compared with deng et al 2019e the adaptive design circumvents the conservatism of the robust design 2 compared with the existing control schemes for the sailboat this scheme addresses the heeling constraint of the sailboat and strictly proves the boundedness of its heeling angle which can prevent the sailboat from capsizing and is more secure 3 this scheme synthesizes several practical issues including the input saturation the acting frequency of the actuator and the uncertain gain of the rudder thus it is more versatile and credible than the existing control schemes for the sailboat notations uniformly in this paper sign s denotes the sign function of the element of s s denotes the 2 norm inf s denotes the infimum and s ˆ denotes the estimation of s where s s s ˆ implies the estimating error 2 preliminaries 2 1 mathematical model of sailboat according to deng et al 2019d the mathematical model of a sailboat can be described in two frames with 4 degrees of freedom the position and attitudes of the sailboat can be described in the earth frame seeing the differential equations in eq 1 which is also called the kinematic loop the kinematic states of the sailboat can be described in the body frame seeing eq 2 which is also called the dynamic loop 1 x u cos ψ v cos ϕ sin ψ y u sin ψ v cos ϕ cos ψ ϕ p ψ r cos ϕ 2 m u u f x s f x r m v v r f x h f w u m v v f y s f y r m u u r f y h f w v m p p m x s m x r a p p b ϕ 2 c ϕ m x h m w p m r r m z r m z s m u m v u v d r r cos ϕ m z h m w r where all the variables are defined in table 1 and illustrated in fig 1 in eq 2 m i with i u v p r can be calculated by empirical equations and the other parameters are deemed to be unknown denote the simplified disturbances as d w u f w u m u d w v f w v m v d w p m w p m p and d w r m w r m r and they are assumed to be bounded with d w i d w i where d w i is a positive constant following the separate principle we can deem that f x s dominates the surge motion in eq 2 m x s the roll motion and m z r the yaw motion it should be noted that the sway motion satisfies the passive boundedness li et al 2008 that means v is self constrained while the other motions are bounded the relationship between f x s and m x s are shown in eq 3 3 f x s l s sin α a w d s cos α a w m x s z s l s cos α a w d s sin α a w where l s and d s are further expressed as 4 l s 1 2 ρ a a s u a w 2 c l s d s 1 2 ρ a a s u a w 2 c d s where a s is the unilateral surface area of the sail because the speed of the sailboat is relatively slow the lift and the drag coefficients of c l s and c d s are irrelevant to u a w and depicted as the functions of α s stevens et al 2016 through the aerodynamic calculation or the wind tunnel test the numerical relationship between these coefficients and α s can be known thus both f x s and m x s can be obtained through calculation from fig 1 it has δ s α a w α s for any δ s in the selecting range of ω s one can always find its one to one mapping to f x s the selecting range of ω s will be discussed in the next section because u a w is finite in eq 4 the input of f x s satisfies the saturation constraint of eq 5 5 f ˆ x s f x s f x s c f x s f x s c 0 f x s c f x s 0 f x s c 0 where f x s c is the desired value of f x s denote the value of f x s c through the saturation as f ˆ x s the relationship between f x s and f ˆ x s will be discussed later in the etc design f x s 0 is the upper bound of f ˆ x s at the current time which relates to the constraint of m x s and is designed later if the sail starts luffing and flapping downwind namely α s 0 both f x s and m x s equate to 0 thus the lower bound of f ˆ x s is set to be 0 for the turning torque of m z r it can be expressed as m z r c r δ r 2 where δ r 2 δ r δ r and c r is the unknown gain the input of δ r 2 satisfies the saturation constraint of eq 6 6 δ ˆ r 2 δ r 2 δ r 2 c δ r 2 δ r 2 c δ r 2 δ r 2 c δ r 2 δ r 2 δ r 2 c δ r 2 where δ r 2 c is the desired value of δ r 2 and δ r 2 0 is the upper bound of δ ˆ r 2 then the control objective of this paper can be concluded as follows control objective for the desired surge speed u d and the desired heading angle ψ d of the sailboat the etc laws of δ s and δ r 2 can ensure the convergence of u and ψ to u d and ψ d namely the tracking errors of u e u u d and ψ e ψ ψ d are ultimately bounded besides the heeling angle ϕ of the sailboat should be constrained in a preset range without the risk of capsizing during the voyage 2 2 fls approximation according to li and tong 2015 and deng et al 2019e the fls is comprised of four parts i e the base of fuzzy rules the fuzzier the fuzzy reasoning machine and the defuzzier for a multiple inputs single output system the fls can be transformed to eq 7 7 y f x i 1 n w i s i x i 1 n s i x where y f is the output x is the input vector n is the number of fuzzy rules w i is the weight of the i th fuzzy rule and s i x denotes the product of all the membership functions in the i th fuzzy rule define φ i s i x i 1 n s i x φ φ 1 φ n t and w w 1 w n t eq 7 can be simplified as y f w t φ then the universal approximation theorem of the fls can be described as the following lemma lemma 1 wang 1994 for any continuous function of f x defined in a compact set there always exists a fls satisfying f x w t φ ε where ε is the approximating error and can be bounded by an arbitrarily small positive constant namely ε ε 3 control design 3 1 heeling constraint to prevent the sailboat from capsizing the heeling constraint of ϕ is addressed in this part a preset threshold of ϕ was denoted by ϕ where 0 ϕ π 2 this threshold should be determined by assessing the capsizing risk our goal is to keep the varying range of ϕ to approach the ideal range of ϕ ϕ as close as possible it can be inferred from eq 1 that ϕ is determined by the roll rate of p through the backstepping method we can design the thresholds of p as 8 p k p ϕ ϕ p k p ϕ ϕ where k p 0 is the tuning parameter in eq 8 p p always exists by differentiating p and p it renders p p k p p it is clear that ϕ ϕ ϕ while p p p from eq 2 we know that p is mainly dominated by m x s according to lemma 1 the nonlinearity of the roll motion in eq 2 can be expressed as the fls of eq 9 9 w p t φ p υ ε p m x r a p p b ϕ 2 c ϕ m x h m p where υ ϕ u v p r u a w α a w t ideally to make p p p the thresholds of m x s are designed as 10 m x s m p k p p k p k p p w ˆ p t φ p m x s m p k p p k p k p p w ˆ p t φ p where k p 0 is the tuning parameter in eq 10 m x s m x s always holds the constrained varying range of m x s is determined as m x s m x s m x s while m x s is constrained f x s can be determined regardless of the heeling constraint both f x s and m x s will rise from 0 to their maximums while increasing α s from 0 linearly however the maximums of them are inconsistent in α s denote the α s corresponding to the maximum of f x s as α s u and the α s corresponding to the maximum of m x s as α s p if α a w 0 and m x s is bigger than the maximum of m x s or α a w 0 and m x s is smaller than the minimum of m x s we denote a threshold of α s as α s l α s p otherwise it is derived from eq 3 that α s l satisfies 11 m x s z s l s α s l cos α a w d s α s l sin α a w α a w 0 m x s z s l s α s l cos α a w d s α s l sin α a w α a w 0 then f x s is set to be the value of f x s corresponding to min α s u α s p α s l and the selecting range of ω s can be determined as a connected set corresponding to f x s 0 f x s seeing fig 2 because the sailboat is symmetric fig 2 only delineates the condition that wind comes from the port side in the upwind case we assume that m x s is bigger than the maximum of m x s because c l s and c d s are not formulaic ω s cannot be described with an analytical form nevertheless it can be obtained through the numerical calculation this is verified in the section of the numerical experiment thus the heeling constraint is transformed to the input saturation of f x s through the above design 3 2 sail according to lemma 1 the nonlinearity of the surge motion in eq 2 can be expressed as the fls of eq 12 12 w u t φ u υ ε u f x s m v v r f x h m u following the backstepping approach f x s c is first designed as 13 f x s c m u k u u e w ˆ u t φ u u d where k u 0 is a tuning parameter invoking eq 5 the control error through the input saturation is denoted as δ u f ˆ x s f x s c according to the above analysis we denote the value of δ s corresponding to f ˆ x s as δ ˆ s define t j u as the triggering instant with j 0 1 and t 0 u is selected as the initial time t 0 of the voyage following the etc we set δ s t δ ˆ s t j u in t t j u t j 1 u and denote the control error as e u f x s f ˆ x s then it yields f x s f x s c δ u e u by differentiating u e along eqs 2 12 and 13 it renders 14 u e e u m u δ u m u k u u e w u t φ u s u where s u ε u d w u and s u ε u d w u to offset the control error of δ u in eq 14 we design the auxiliary system as 15 ξ u δ u m u k u ξ u where ξ u is the auxiliary signal and β u ξ u u e implies the compensated tracking error by synthesizing eqs 14 and 15 it yields 16 β u e u m u k u β u w u t φ u s u then the next triggering instant t j 1 u of δ s is determined by the following triggering condition 17 t j 1 u inf t r t t j u e u 2 m u 2 k u 1 2 1 γ u β u 2 β u 2 η u or t j 1 u inf t r t t j u δ s t ω s where 0 γ u 1 and η u 0 are tuning parameters remark 1 similar with deng et al 2019e the triggering condition of eq 17 cannot guarantee the existence of the minimum inter event time due to the time varying ω s this is reflected in the second equation of eq 17 nevertheless the etc design herein is to reduce the acting frequency of the sail compared with the continuous scheme the saving of acting frequency is still remarkable 3 3 rudder following the backstepping approach the virtual control law for r is designed as 18 α r 1 cos ϕ k ψ ψ e ψ d where k ψ 0 is a tuning parameter denote the tracking error as r e r α r differentiating ψ e along eqs 18 and 1 it renders 19 ψ e k ψ ψ e r e cos ϕ design the auxiliary system as 20 ξ ψ k ψ ξ ψ ξ r cos ϕ where ξ ψ and ξ r are auxiliary signals β ψ ξ ψ ψ e and β r ξ r r e are compensated tracking errors by synthesizing eqs 19 and 20 it renders 21 β ψ k ψ β ψ β r cos ϕ according to lemma 1 the nonlinearity of the yaw motion in eq 2 can be expressed as the following fls 22 w r t φ r υ ε r m z s m u m v u v d r r cos ϕ m z h m r then δ r 2 c is designed as 23 δ r 2 c m r θ ˆ φ r and let φ r k r r e w ˆ r t φ r β ψ cos ϕ α r where k r 0 is a tuning parameter and θ 1 c r from eq 18 it renders α r cos ϕ k ψ ψ d k ψ r ψ d sin ϕ p k ψ ψ e ψ d cos 2 ϕ thus there is no difficulty in differentiating the virtual control law similarly the control error through the input saturation is denoted as δ r δ ˆ r 2 δ r 2 c the triggering instant is denoted as t j r and t 0 r is assigned as t 0 we set δ r 2 t δ ˆ r 2 t j r in t t j r t j 1 r and let e r δ r 2 δ ˆ r 2 then it has δ r 2 e r δ r δ r 2 c by differentiating r e along eqs 2 22 and 23 it yields 24 r e c r δ r m r c r e r m r k r r e w r t φ r β ψ cos ϕ c r θ φ r s r where s r ε r d w r and s r ε r d w r to offset the control error of δ r in eq 24 design the auxiliary system as 25 ξ r k r ξ r c ˆ r δ r m r synthesizing eqs 24 and 25 it renders 26 β r c r δ r m r c r e r m r k r β r w r t φ r β ψ cos ϕ c r θ φ r s r then the next triggering instant t j 1 r of δ r 2 is determined by the following triggering condition 27 t j 1 r inf t r t t j r c ˆ r 2 e r 2 m r 2 k r 1 2 1 γ r β r 2 β r 2 η r where 0 γ r 1 and η r 0 are tuning parameters 3 4 serial parallel estimation model and adaptive laws because only the surge roll and yaw motions in eq 2 are concerned the serial parallel estimation model is established only for these motions and as 28 u ˆ f x s m u w ˆ u t φ u υ k f u u p ˆ m x s m p w ˆ p t φ p υ k f p p r ˆ c ˆ r δ r 2 m r w ˆ r t φ r υ k f r r where k f i 0 with i u p r is the tuning parameter by subtracting eq 28 from eq 2 we can obtain the differential equations of the prediction errors as 29 u w u t φ u υ k f u u s u p w p t φ p υ k f p p s p r c r δ r 2 m r w r t φ r υ k f r r s r where s p ε p d w p and s p ε p d w p to be orchestrated with eqs 16 26 and 29 the adaptive laws of w u w p and w r are devised as 30 w ˆ u γ u φ u u β u σ u w ˆ u w ˆ p γ p φ p p σ p w ˆ p w ˆ r γ r φ r r β r σ r w ˆ r where γ i is a positive definite matrix and σ i 0 is the tuning parameter with i u p r to ensure the closed loop stability in the following step the uncertain gain of the rudder is estimated by the adaptive laws and we devise 31 θ ˆ γ θ φ r β r σ θ θ ˆ c ˆ r γ c e r β r m r δ r β r m r r δ r 2 m r σ c c ˆ r where γ θ γ c σ θ and σ c are positive tuning parameters remark 2 it can be observed from eq 30 that the prediction errors of u p and r are involved in the adaptive laws of the fls weights and combined with the compensated tracking errors of β u and β r it can be observed from eq 29 that the prediction errors directly relate to the approximating accuracy of the flss thus the terms of prediction errors in eq 30 function as the gradient descent algorithm for minimizing the prediction errors and the proposed composite adaptive laws can reconcile the tracking performance with the approximating accuracy xu et al 2014 li and tong 2015 li et al 2016 compared with the classic adaptive laws in deng et al 2019d which belongs to the direct adaptive control dac in ioannou and sun 1996 it leads to the smaller w i with i u p r nevertheless σ i should be bigger enough to prevent the parameter drifting 4 stability analysis the result of this paper can be concluded as the following theorem theorem 1 assume υ is defined in a compact set namely the approximating capability of the flss is always guaranteed for the sailboat described by eqs 1 and 2 and under the input saturation of eqs 5 and 6 if we adopt the control laws of eqs 13 and 23 the adaptive laws of eqs 30 and 31 and the triggering condition of eqs 17 and 27 all the tracking the prediction and the estimating errors are ensured to be sguub besides the heeling angle of ϕ is constrained in the interval of ϕ μ k p k p ϕ μ k p k p where μ is a positive variable concerning the disturbance of d w p and the estimating error of w p proof of sguub choose the lyapunov function as v β ψ 2 β u 2 β r 2 u 2 p 2 r 2 w u t γ u 1 w u w p t γ p 1 w p w r t γ r 1 w r 2 c r θ 2 2 γ θ c r 2 2 γ c consider β u 2 η u and β r 2 η r by differentiating v along eqs 16 17 21 26 27 29 30 and 31 it yields 32 v β ψ β ψ β u β u β r β r u u p p r r w u t γ u 1 w u w p t γ p 1 w p w r t γ r 1 w r c r γ θ θ θ 1 γ c c r c r k ψ β ψ 2 γ u k u 1 2 β u 2 γ r k r 1 2 β r 2 c r σ θ 2 θ 2 k f u 1 4 u 2 k f p 1 4 p 2 k f r 1 4 r 2 σ c 2 c r 2 σ u 2 w u t w u σ p 2 w p t w p σ r 2 w r t w r σ u 2 w u t w u σ p 2 w p t w p σ r 2 w r t w r c r σ θ 2 θ 2 σ c 2 c r 2 s p 2 2 s r 2 2 s u 2 select k ψ k u 1 2 k r 1 and k f u k f p k f r 1 4 define ζ min 2 k f u 1 2 2 k f p 1 2 2 k f r 1 2 2 γ u k u γ u 2 γ r k r γ r 2 k ψ σ θ γ θ σ c γ c σ u λ m i n γ u σ p λ m i n γ p σ r λ m i n γ r where λ m i n denotes the minimum eigenvalue of the matrix let ϱ σ u w u t w u 2 σ p w p t w p 2 σ r w r t w r 2 c r σ θ θ 2 2 σ c c r 2 2 s p 2 2 s r 2 2 s u 2 then eq 32 is transformed to 33 v ζ v ϱ through the comparison theorem it can be inferred from eq 33 that v t v t 0 ϱ ζ exp ζ t t 0 ϱ ζ holds thus all the errors in v are sguub and β i 2 is ultimately bounded by max η i 2 ϱ ζ with i u r further the sguub of the tracking errors namely ψ e u e and r e can be proven choose the lyapunov candidate as v ξ ξ ψ 2 ξ u 2 ξ r 2 2 differentiating v ξ along eqs 15 20 and 25 it renders 34 v ξ ξ ψ ξ ψ ξ u ξ u ξ r ξ r k ψ 1 2 ξ ψ 2 k u 1 2 ξ u 2 k r 1 ξ r 2 δ u 2 2 m u 2 c ˆ r 2 δ r 2 2 m r 2 define ζ ξ min 2 k ψ 1 2 k u 1 2 k r 2 and ϱ ξ δ u 2 2 m u 2 c ˆ r 2 δ r 2 2 m r 2 then eq 34 can be transformed to 35 v ξ ζ ξ v ξ ϱ ξ through the comparison theorem it can be inferred from eq 35 that v ξ t v ξ t 0 ϱ ξ ζ ξ exp ζ ξ t t 0 ϱ ξ ζ ξ according to the composition of ϱ ξ we can conclude that v ξ is asymptotically stable if δ u δ r 0 and is sguub if δ u and δ r keep bounded choose the lyapunov candidate of the tracking errors as v t ψ e 2 u e 2 r e 2 2 by using the inequalities of ψ e 2 2 β ψ 2 2 ξ ψ 2 u e 2 2 β u 2 2 ξ u 2 and r e 2 2 β r 2 2 ξ r 2 it further yields v t 2 v 2 v ξ according to the above analysis of v and v ξ it is clear that ψ e u e and r e in v t are sguub remark 3 because υ is defined in a compact set the control laws in eqs 13 and 23 are bounded from the definitions of δ u and δ r it is reasonable to assume that δ u and δ r keep bounded in the above analysis while the input saturation does not work namely δ u δ r 0 we have ψ e β ψ u e β u and r e β r because the input saturation will limit the control energies it is not practical to stabilize ψ e u e and r e directly for example the closed loop stability is degraded in the existing literature of ma et al 2019 deng et al 2019a and zheng et al 2018 the auxiliary systems in this paper can successfully circumvent this problem they were widely used to deal with the input saturation in li and tong 2015 and du et al 2016 and eliminate the analytical differentiation of the virtual control laws in dong et al 2012 and zhu et al 2018 remark 4 it can be inferred from eq 33 that by choosing k f u k f p k f r k u k r k ψ γ u γ r γ θ γ c λ m i n γ u λ m i n γ p and λ m i n γ r largely enough the compensated tracking errors and the prediction errors can be regulated into any small bound with a fast convergent rate nevertheless this setting may lead to an undesired transient and the waste of control energy as is mentioned in remark 3 the saturation constraint will also affect the convergence of the tracking errors besides it can be inferred from eqs 17 and 27 that the growth of γ u and γ r will increase the acting frequencies of the actuators thus the selection of these parameters should be devoted to the desired closed loop response and practical needs remark 5 one can follow jiao and wang 2016a b and deng et al 2019a e to prove the existence of the minimum inter event time of the sail in the first equation of eq 17 and that of the rudder in eq 27 in brief the control errors of e u and e r are reset to 0 at the triggering instants and the growth rates of e u 2 and c ˆ r e r 2 are bounded in the compact set while the triggering thresholds are ensured to be bigger than m u 2 k u 1 2 1 γ u η u and m r 2 k r 1 2 1 γ r η r a minimum time is always ensured for e u 2 and c ˆ r e r 2 to rise from 0 to the triggering thresholds remark 6 according to krstić et al 1995 the smoothness of control inputs is one of sufficient conditions to ensure the feasibility of the backstepping method whereas the control inputs of δ s and δ r 2 are unsmooth at the triggering instant in this paper nevertheless the unsmooth control inputs herein will not damage the application of backstepping for this purpose we can refer to the tool of impulsive dynamical system in haddad et al 2006 while it denotes the jumps of v and v t at the triggering instant as δ v and δ v t it is clear from eq 2 that δ v δ v t 0 because δ s and δ r 2 keep unchanged and smooth during the inter event time the convergence of v and v t is guaranteed in the entire time domain which illustrates the feasibility of backstepping in this paper for the case of δ v 0 a more complex analysis is required seeing deng et al 2019b proof of heeling constraint while f x s is bounded by the derived f x s it holds m x s m x s m x s during the voyage by substituting eqs 10 to 2 it yields 36 p k p p p p w p t φ p d w p p k p p p p w p t φ p d w p define μ w p 2 2 1 2 d w p by solving eq 36 through the comparison theorem one can obtain 37 p t p t μ k p p t 0 p t 0 μ k p exp k p t t 0 p t p t μ k p p t 0 p t 0 μ k p exp k p t t 0 it can be inferred from eq 37 that if p t 0 p t 0 p t 0 holds p t μ k p p t p t μ k p always holds by substituting eqs 8 to 1 it yields 38 ϕ k p ϕ ϕ μ k p ϕ k p ϕ ϕ μ k p by solving eq 38 through the comparison theorem one can obtain 39 ϕ t ϕ μ k p k p ϕ t 0 ϕ μ k p k p exp k p t t 0 ϕ t ϕ μ k p k p ϕ t 0 ϕ μ k p k p exp k p t t 0 it can be inferred from eq 39 that if ϕ ϕ t 0 ϕ initially holds ϕ μ k p k p ϕ t ϕ μ k p k p always holds because w p in μ is bounded according to the above analysis it is known that the varying range of ϕ μ k p k p ϕ μ k p k p will converge to ϕ ϕ by increasing k p and k p the proof is completed 5 numerical experiment a 12 m sailing yacht is chosen to be the experimental objective it was also adopted in xiao and jouffroy 2014 and deng et al 2019d the author can refer to these literature for the detailed parameters the lift and drag coefficients of the sail are provided in fig 3 corresponding to the attacking angle of α s here the path following task is carried out to verify the effectiveness of the proposed scheme the curved reference path is described by the sinusoidal function of x d 150 sin π y d 100 50 with y d 0 m 500 m where x d and y d are the positional coordinates of the reference path the parallel guidance principle in deng et al 2019e is adopted to generate the desired heading angle of ψ d and the desired surge speed of u d is selected as 2 m s the true wind is set with the speed of 6 m s which points to the south and revolves anticlockwise with the constant rate of 0 01 s the simplified disturbances are described by the first order markov process as eq 40 40 d w u 0 1 d w u 0 05 ω u d w v 0 1 d w v 0 05 ω v d w p 0 1 d w p 0 02 ω p d w r 0 1 d w r 0 02 ω r where ω i with i u v p v is the gauss white noise with the variance of 1 the initial positional coordinates attitudes and kinematic states of the sailboat are set as x t 0 y t 0 0 m ψ t 0 45 ϕ t 0 0 u t 0 v t 0 0 m s and p t 0 r t 0 0 s to outstand the advantages of the proposed scheme the event triggered robust fuzzy damping control scheme in deng et al 2019e is selected for comparison the heeling constraint is not considered in that scheme and the parameters are regulated to preserve the best control performances the sailboat with that scheme is marked as no 1 to demonstrate the advantages of the composite learning we set another comparison of the customary direct adaptive control different with eq 30 the adaptive laws of fls weights in this scheme are devised as 41 w ˆ u γ u φ u β u σ u w ˆ u w ˆ p γ p φ p p σ p w ˆ p w ˆ r γ r φ r β r σ r w ˆ r where the prediction errors are exempted and the serial parallel estimation model of eq 28 is not required the sailboat with this scheme is marked as no 2 finally the sailboat with the proposed composite adaptive scheme in this paper is marked as no 3 it should be noted that all the parameters of the no 2 and the no 3 sailboats keep the same and are presented as eq 42 42 k ψ 0 5 k u 0 1 k r 0 2 k p k p 1 γ u 0 6 γ r 0 8 k f u k f p k f r 0 1 η u η r 0 5 γ u γ p γ r 0 1 i 5 5 σ u σ p σ r 0 1 γ θ γ c 0 1 σ θ σ c 1 the threshold of the heeling angle is set as ϕ 30 then the numerical experiment is carried out in the environment of matlab the results are shown in figs 4 13 and the quantified control performances are provided in table 2 fig 4 exhibits the trajectories of the three sailboats the parallel guidance principle works well and all the three sailboats can track the reference path in a satisfactory accuracy in this figure the no 1 and the no 3 sailboats behave better than the no 2 define the average tracking errors as eq 43 43 ψ e m t 0 t e n d ψ e τ d τ u e m t 0 t e n d u e τ d τ where t e n d is the total voyage time it can be found in table 2 that ψ e m u e m and t e n d of the no 2 are bigger than those of the no 1 and the no 3 this suggests the tracking performance of the no 2 is degraded due to the inaccurate approximation of the flss fig 5 shows the evolution of the disturbances within 1700 s the first order markov process can embodies the features of the waves in a normal sea condition with fidelity fig 6 exhibits the evolution of the kinematic states according to the analysis in remark 3 it is reasonable that u cannot always reach the desired value of u d the speed loss of u inevitably happens at the tacking maneuver v is passively bounded and its overshoots occur at the tacking maneuver p oscillates drastically but keeps bounded during the voyage the overshoots of r occur while the sailboats turn the above speed responses are reasonable for the sailboat fig 7 exhibits the evolution of the heeling angles it can be observed that ϕ of the no 2 and the no 3 sailboats are nearly bounded by the red dashed lines of ϕ during the voyage whereas the no 1 often breaks through the threshold while the sailboat turns the maximum heeling angles of ϕ m a x are provided in table 2 the ϕ m a x of the no 2 is a little bigger than ϕ which is caused by μ k p k p according to the above proof it should be noted that the proposed scheme sacrifices the thrust of the sail for satisfying the heeling constraint thus the average of u in the no 2 and the no 3 sailboats is slower than that in the no 1 such that t e n d of them is also longer than that of the no 1 in table 2 fig 8 demonstrates the control inputs of δ s and δ r affected by the disturbances both of them oscillate drastically during the voyage the saturation of δ r occurs while the sailboat turns it can be observed from the local enlarged view at 650 680 s of fig 8 b that the control inputs hold during the inter event time and the event triggered mechanism works fig 9 shows the accumulation of triggering times within 1700 s compared with the continuous scheme the saving of acting frequencies is remarkable in three sailboats it can be observed that the accumulation in the no 1 grows faster than that in the others due to the conservatism of the robust control the total accumulation at 1700 s of the sail and the rudder are denoted as n s and n r respectively which are provided in table 2 fig 10 provides the α s of the no 3 sailboat corresponding to α s p α s u and α s l respectively during the voyage the varying range of α s is determined from 0 to the minimum of these three curves fig 11 compares the approximating errors of the flss in the no 2 and the no 3 sailboats it can be observed that the approximating error of the no 3 is significantly smaller than that of the no 2 the composite learning of the flss is effective in identifying the uncertainties fig 12 demonstrates the evolution of w ˆ u w ˆ p and w ˆ r while fig 13 demonstrates the evolution of θ ˆ and c ˆ r in the no 3 sailboat according to the stability analysis all of them tend to be bounded it should be noted that the design in eq 31 belongs to dac such that θ ˆ c ˆ r 1 is not achievable in fig 13 the computational simplicity of three control schemes is also compared in this simulation through the profile function in matlab we record the memory occupation of the three programs during their running time from table 2 it is found that the robust damping in deng et al 2019e is the most succinct one this is because the adaptive laws are not required in that scheme however the proposed control scheme can outperform the robust damping one in less conservatism 6 conclusion this paper investigates the event triggered composite adaptive fuzzy control of the sailboat in the surge speed and the heading angle in addition the heeling constraint is considered during the voyage the serial parallel estimation model is constructed to evaluate the approximating accuracy of the flss and the prediction errors are involved in the composite adaptive laws with the known aerodynamics of the sail the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are fabricated to offset the input saturation the etc laws are separately built for the sail and the rudder with the triggering conditions the uncertain gain of the rudder is estimated by the adaptive laws finally the proposed control scheme is matched with the path following guidance principle in deng et al 2019e and the fine control performances are observed in the simulation this paper is deemed as a phase summary of our work in the control of the sailboat in the future we can improve this scheme with output feedback and get enlightened from li and tong 2015 and li et al 2016 credit authorship contribution statement yingjie deng writing orignial draft writing review editing xianku zhang conceptualization supervision qiang zhang software validation yancai hu investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially supported by national science foundation of china no 51679024 fundamental research funds for the central university china no 3132019501 university 111 project of china no b08046 national science foundation of shandong jiaotong university china no z201631 key research and development plan of shandong province china no 2019jzzy020712 and shandong jiaotong university phd startup foundation of scientific research china 
21705,in this paper the event triggered composite adaptive fuzzy control laws are developed to control both the surge speed and the heading angle of the sailboat the fuzzy logic systems flss are employed to approximate the nonlinearities in the model of the sailboat to enhance the approximating accuracy a serial parallel estimation model is established at first and the composite adaptive laws of the fls weights are then derived by combining the tracking errors with the prediction errors between the estimation model and the dynamic loop of the sailboat to prevent the sailboat from capsizing we consider the heeling constraint in the roll motion during the voyage by using the backstepping method the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are fabricated to offset the input saturation of the sail and the rudder which are incorporated into the control laws to reduce the acting frequencies of the actuators the control laws for the sail and the rudder are designed in the event triggered form and the triggering conditions are constructed separately the uncertain gain of the rudder is estimated by the adaptive laws the proposed control scheme can guarantee the semi global uniformly ultimate boundedness sguub of all the errors through the numerical path following test the effectiveness of the proposed scheme is verified keywords sailboat event triggered control etc composite adaptive fuzzy control heeling constraint input saturation 1 introduction the navigational cybernetics have been rapidly developing since the human society entered the third industrial revolution nowadays the ship tends to be more versatile and intelligent than its past throughout the development of navigational cybernetics much experience was drawn from the advanced control techniques for generic nonlinear systems such as jiang 2002 do 2010 and deng et al 2019a and the references therein in the background of energy crisis the saving of energy becomes one of the keynote development themes of navigational cybernetics for this theme the wind assisted ship is more competitive than the common powered ship especially in the long term and wide range task however in contrast to numerous researches on the control of the common powered ship it lacks experience to control the sailboat which is pretty challenging due to the variability and uncontrollability of the wind following the separate principle the control of the sailboat can be divided into two aspects of the sail and the rudder regardless of coupling the surge motion of the sailboat is mainly controlled by the sail and the yaw motion by the rudder for the sail the control input boils down to the sheeting angle of the sail the existing researches mostly concentrated on maximizing the surge speed of the sailboat and some optimization algorithms of the sheeting angle were proposed such as the quantified set inversion in herrero et al 2010 the extremum seeking in xiao et al 2012 corno et al 2016 deng et al 2019c and shen et al 2019 nevertheless the surge speed cannot be controlled to a specific value in these researches as the strong maneuverability is required for a sailboat in the busy water zhang et al 2018 this control objective is pretty realistic and can be achieved based on the known aerodynamics of the sail in deng et al 2019e an event triggered robust fuzzy control scheme was proposed to control the surge speed of the wing sailed catamaran where the fls was employed to approximate the nonlinearity in the surge motion because the roll motion was exempted for the wing sailed catamaran this approach cannot extend to the mono hull sailboat the roll motion of the mono hull sailboat is strongly influenced by the regulation of the sail for which the constraint of the heeling angle should be considered thus the previous optimization and control algorithms are not practical for the sailboat and may result in capsizing sometimes as we have learnt stelzer et al 2007 used the fls to describe the tuning principle for the sail which chose the heeling angle as the input although the heeling constraint was addressed in this scheme it was based on artificial expertise and may degrade the propulsion efficiency of the sail for the rudder the control input boils down to the rudder angle without the model of the sailboat elkaim and kelbley 2006 cruz and alves 2010 and jaulin and bars 2013 designed the pid controller for the rudder stelzer et al 2007 designed the fls based rudder controller with the deterministic model herrero et al 2010 referred to the feedback linearization method to design the controller xiao and jouffroy 2011 and he et al 2012 designed the backstepping based controllers for the rudder and the weight balancing system respectively to deal with the uncertainties xiao and jouffroy 2014 developed a robust control scheme by tuning the parameters and deng et al 2019e resorted to the robust fuzzy damping technique nevertheless these schemes were conservative and may result in the unnecessarily large control inputs in deng et al 2019d the adaptive neural rudder controller was designed with the minimum learning parameters where the control performance was strongly concerned with the approximating accuracy of the neural networks nns however the adaptive law therein can only guarantee the closed loop stability rather than the identification of the model uncertainties and the interpretability of the nns this problem has been discussed for the strict feedback nonlinear systems in xu et al 2014 li and tong 2015 and li et al 2016 where the composite learning was proposed as a solution because the model of the sailboat does not belong to the strict feedback system these approaches cannot be directly applied to the control of the sailboat to our knowledge there is no such attempt at present another problem of the above researches consists in the uncertainty of the rudder in xiao and jouffroy 2014 the nonlinearity of the rudder was simplified as a sine function deng et al 2019d assumed that the fitting error between the sine function and the lift coefficient of the rudder was upper bounded by a known constant deng et al 2019e assumed that both the upper and lower bounds of the gain of the rudder were known these schemes utilized the robust design to offset the uncertainty of the rudder in compliance with the nautical practice the input saturation should be considered in the above control schemes although he et al 2012 jaulin and bars 2013 xiao and jouffroy 2014 saoud et al 2015 and deng et al 2019c d constrained the operating range of the rudder these schemes did not analyze the influence of the input saturation on the stability in ma et al 2019 and deng et al 2019a e the sigmoid functions were introduced to approximate the saturation nonlinearities of the actuators through the mean value theorem the saturation nonlinearity was transformed to the formula with the bounded gain and the approximating error in zheng et al 2018 the uncertainty observer was fabricated to offset the lumped uncertainties including the control error through the input saturation yan and wang 2012 and peng et al 2019 studied the model predictive control for surface and underwater marine crafts where the tracking control was transformed to the neurodynamic optimization with a series of constraints including the input saturation nevertheless the above methods cannot be applied to the adaptive control of the sailboat another practical issue consists in the acting frequency of the actuator the lower acting frequency will reduce the mechanical wear and elongate the service life of the actuator the event triggered control provides a solution to this problem this method functions in an intelligent manner where the control happens only when the triggering condition is violated and it was introduced to the navigational cybernetics in jiao and wang 2016a b deng et al 2019a and guo et al 2019 due to the variability of the wind the acting of the actuators in the sailboat is more frequent than that in the common powered ship thus the etc is more significant for the sailboat deng et al 2019e first investigated the etc for the wing sailed catamaran and combined the etc with the robust fuzzy damping although li and yang 2018 and cao et al 2018 have combined the etc with the adaptive nns or flss for the pure feedback and strict feedback systems this issue is left to be considered for the sailboat motivated by the above challenges this paper develops a unified event triggered adaptive fuzzy control scheme for the sailboat a serial parallel estimation model is established for the dynamic loop of the sailboat on this basis we derive the composite adaptive laws of the fls weights in this paper the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are constructed to offset the control error through the input saturation the adaptive laws are fabricated to estimate the uncertain gain of the rudder the contribution of this paper is mainly threefold 1 compared with the existing adaptive neural and fuzzy control schemes for marine crafts the composite learning of the flss can ensure both the closed loop stability and the identification of the uncertainties such that the tracking performance is improved compared with deng et al 2019e the adaptive design circumvents the conservatism of the robust design 2 compared with the existing control schemes for the sailboat this scheme addresses the heeling constraint of the sailboat and strictly proves the boundedness of its heeling angle which can prevent the sailboat from capsizing and is more secure 3 this scheme synthesizes several practical issues including the input saturation the acting frequency of the actuator and the uncertain gain of the rudder thus it is more versatile and credible than the existing control schemes for the sailboat notations uniformly in this paper sign s denotes the sign function of the element of s s denotes the 2 norm inf s denotes the infimum and s ˆ denotes the estimation of s where s s s ˆ implies the estimating error 2 preliminaries 2 1 mathematical model of sailboat according to deng et al 2019d the mathematical model of a sailboat can be described in two frames with 4 degrees of freedom the position and attitudes of the sailboat can be described in the earth frame seeing the differential equations in eq 1 which is also called the kinematic loop the kinematic states of the sailboat can be described in the body frame seeing eq 2 which is also called the dynamic loop 1 x u cos ψ v cos ϕ sin ψ y u sin ψ v cos ϕ cos ψ ϕ p ψ r cos ϕ 2 m u u f x s f x r m v v r f x h f w u m v v f y s f y r m u u r f y h f w v m p p m x s m x r a p p b ϕ 2 c ϕ m x h m w p m r r m z r m z s m u m v u v d r r cos ϕ m z h m w r where all the variables are defined in table 1 and illustrated in fig 1 in eq 2 m i with i u v p r can be calculated by empirical equations and the other parameters are deemed to be unknown denote the simplified disturbances as d w u f w u m u d w v f w v m v d w p m w p m p and d w r m w r m r and they are assumed to be bounded with d w i d w i where d w i is a positive constant following the separate principle we can deem that f x s dominates the surge motion in eq 2 m x s the roll motion and m z r the yaw motion it should be noted that the sway motion satisfies the passive boundedness li et al 2008 that means v is self constrained while the other motions are bounded the relationship between f x s and m x s are shown in eq 3 3 f x s l s sin α a w d s cos α a w m x s z s l s cos α a w d s sin α a w where l s and d s are further expressed as 4 l s 1 2 ρ a a s u a w 2 c l s d s 1 2 ρ a a s u a w 2 c d s where a s is the unilateral surface area of the sail because the speed of the sailboat is relatively slow the lift and the drag coefficients of c l s and c d s are irrelevant to u a w and depicted as the functions of α s stevens et al 2016 through the aerodynamic calculation or the wind tunnel test the numerical relationship between these coefficients and α s can be known thus both f x s and m x s can be obtained through calculation from fig 1 it has δ s α a w α s for any δ s in the selecting range of ω s one can always find its one to one mapping to f x s the selecting range of ω s will be discussed in the next section because u a w is finite in eq 4 the input of f x s satisfies the saturation constraint of eq 5 5 f ˆ x s f x s f x s c f x s f x s c 0 f x s c f x s 0 f x s c 0 where f x s c is the desired value of f x s denote the value of f x s c through the saturation as f ˆ x s the relationship between f x s and f ˆ x s will be discussed later in the etc design f x s 0 is the upper bound of f ˆ x s at the current time which relates to the constraint of m x s and is designed later if the sail starts luffing and flapping downwind namely α s 0 both f x s and m x s equate to 0 thus the lower bound of f ˆ x s is set to be 0 for the turning torque of m z r it can be expressed as m z r c r δ r 2 where δ r 2 δ r δ r and c r is the unknown gain the input of δ r 2 satisfies the saturation constraint of eq 6 6 δ ˆ r 2 δ r 2 δ r 2 c δ r 2 δ r 2 c δ r 2 δ r 2 c δ r 2 δ r 2 δ r 2 c δ r 2 where δ r 2 c is the desired value of δ r 2 and δ r 2 0 is the upper bound of δ ˆ r 2 then the control objective of this paper can be concluded as follows control objective for the desired surge speed u d and the desired heading angle ψ d of the sailboat the etc laws of δ s and δ r 2 can ensure the convergence of u and ψ to u d and ψ d namely the tracking errors of u e u u d and ψ e ψ ψ d are ultimately bounded besides the heeling angle ϕ of the sailboat should be constrained in a preset range without the risk of capsizing during the voyage 2 2 fls approximation according to li and tong 2015 and deng et al 2019e the fls is comprised of four parts i e the base of fuzzy rules the fuzzier the fuzzy reasoning machine and the defuzzier for a multiple inputs single output system the fls can be transformed to eq 7 7 y f x i 1 n w i s i x i 1 n s i x where y f is the output x is the input vector n is the number of fuzzy rules w i is the weight of the i th fuzzy rule and s i x denotes the product of all the membership functions in the i th fuzzy rule define φ i s i x i 1 n s i x φ φ 1 φ n t and w w 1 w n t eq 7 can be simplified as y f w t φ then the universal approximation theorem of the fls can be described as the following lemma lemma 1 wang 1994 for any continuous function of f x defined in a compact set there always exists a fls satisfying f x w t φ ε where ε is the approximating error and can be bounded by an arbitrarily small positive constant namely ε ε 3 control design 3 1 heeling constraint to prevent the sailboat from capsizing the heeling constraint of ϕ is addressed in this part a preset threshold of ϕ was denoted by ϕ where 0 ϕ π 2 this threshold should be determined by assessing the capsizing risk our goal is to keep the varying range of ϕ to approach the ideal range of ϕ ϕ as close as possible it can be inferred from eq 1 that ϕ is determined by the roll rate of p through the backstepping method we can design the thresholds of p as 8 p k p ϕ ϕ p k p ϕ ϕ where k p 0 is the tuning parameter in eq 8 p p always exists by differentiating p and p it renders p p k p p it is clear that ϕ ϕ ϕ while p p p from eq 2 we know that p is mainly dominated by m x s according to lemma 1 the nonlinearity of the roll motion in eq 2 can be expressed as the fls of eq 9 9 w p t φ p υ ε p m x r a p p b ϕ 2 c ϕ m x h m p where υ ϕ u v p r u a w α a w t ideally to make p p p the thresholds of m x s are designed as 10 m x s m p k p p k p k p p w ˆ p t φ p m x s m p k p p k p k p p w ˆ p t φ p where k p 0 is the tuning parameter in eq 10 m x s m x s always holds the constrained varying range of m x s is determined as m x s m x s m x s while m x s is constrained f x s can be determined regardless of the heeling constraint both f x s and m x s will rise from 0 to their maximums while increasing α s from 0 linearly however the maximums of them are inconsistent in α s denote the α s corresponding to the maximum of f x s as α s u and the α s corresponding to the maximum of m x s as α s p if α a w 0 and m x s is bigger than the maximum of m x s or α a w 0 and m x s is smaller than the minimum of m x s we denote a threshold of α s as α s l α s p otherwise it is derived from eq 3 that α s l satisfies 11 m x s z s l s α s l cos α a w d s α s l sin α a w α a w 0 m x s z s l s α s l cos α a w d s α s l sin α a w α a w 0 then f x s is set to be the value of f x s corresponding to min α s u α s p α s l and the selecting range of ω s can be determined as a connected set corresponding to f x s 0 f x s seeing fig 2 because the sailboat is symmetric fig 2 only delineates the condition that wind comes from the port side in the upwind case we assume that m x s is bigger than the maximum of m x s because c l s and c d s are not formulaic ω s cannot be described with an analytical form nevertheless it can be obtained through the numerical calculation this is verified in the section of the numerical experiment thus the heeling constraint is transformed to the input saturation of f x s through the above design 3 2 sail according to lemma 1 the nonlinearity of the surge motion in eq 2 can be expressed as the fls of eq 12 12 w u t φ u υ ε u f x s m v v r f x h m u following the backstepping approach f x s c is first designed as 13 f x s c m u k u u e w ˆ u t φ u u d where k u 0 is a tuning parameter invoking eq 5 the control error through the input saturation is denoted as δ u f ˆ x s f x s c according to the above analysis we denote the value of δ s corresponding to f ˆ x s as δ ˆ s define t j u as the triggering instant with j 0 1 and t 0 u is selected as the initial time t 0 of the voyage following the etc we set δ s t δ ˆ s t j u in t t j u t j 1 u and denote the control error as e u f x s f ˆ x s then it yields f x s f x s c δ u e u by differentiating u e along eqs 2 12 and 13 it renders 14 u e e u m u δ u m u k u u e w u t φ u s u where s u ε u d w u and s u ε u d w u to offset the control error of δ u in eq 14 we design the auxiliary system as 15 ξ u δ u m u k u ξ u where ξ u is the auxiliary signal and β u ξ u u e implies the compensated tracking error by synthesizing eqs 14 and 15 it yields 16 β u e u m u k u β u w u t φ u s u then the next triggering instant t j 1 u of δ s is determined by the following triggering condition 17 t j 1 u inf t r t t j u e u 2 m u 2 k u 1 2 1 γ u β u 2 β u 2 η u or t j 1 u inf t r t t j u δ s t ω s where 0 γ u 1 and η u 0 are tuning parameters remark 1 similar with deng et al 2019e the triggering condition of eq 17 cannot guarantee the existence of the minimum inter event time due to the time varying ω s this is reflected in the second equation of eq 17 nevertheless the etc design herein is to reduce the acting frequency of the sail compared with the continuous scheme the saving of acting frequency is still remarkable 3 3 rudder following the backstepping approach the virtual control law for r is designed as 18 α r 1 cos ϕ k ψ ψ e ψ d where k ψ 0 is a tuning parameter denote the tracking error as r e r α r differentiating ψ e along eqs 18 and 1 it renders 19 ψ e k ψ ψ e r e cos ϕ design the auxiliary system as 20 ξ ψ k ψ ξ ψ ξ r cos ϕ where ξ ψ and ξ r are auxiliary signals β ψ ξ ψ ψ e and β r ξ r r e are compensated tracking errors by synthesizing eqs 19 and 20 it renders 21 β ψ k ψ β ψ β r cos ϕ according to lemma 1 the nonlinearity of the yaw motion in eq 2 can be expressed as the following fls 22 w r t φ r υ ε r m z s m u m v u v d r r cos ϕ m z h m r then δ r 2 c is designed as 23 δ r 2 c m r θ ˆ φ r and let φ r k r r e w ˆ r t φ r β ψ cos ϕ α r where k r 0 is a tuning parameter and θ 1 c r from eq 18 it renders α r cos ϕ k ψ ψ d k ψ r ψ d sin ϕ p k ψ ψ e ψ d cos 2 ϕ thus there is no difficulty in differentiating the virtual control law similarly the control error through the input saturation is denoted as δ r δ ˆ r 2 δ r 2 c the triggering instant is denoted as t j r and t 0 r is assigned as t 0 we set δ r 2 t δ ˆ r 2 t j r in t t j r t j 1 r and let e r δ r 2 δ ˆ r 2 then it has δ r 2 e r δ r δ r 2 c by differentiating r e along eqs 2 22 and 23 it yields 24 r e c r δ r m r c r e r m r k r r e w r t φ r β ψ cos ϕ c r θ φ r s r where s r ε r d w r and s r ε r d w r to offset the control error of δ r in eq 24 design the auxiliary system as 25 ξ r k r ξ r c ˆ r δ r m r synthesizing eqs 24 and 25 it renders 26 β r c r δ r m r c r e r m r k r β r w r t φ r β ψ cos ϕ c r θ φ r s r then the next triggering instant t j 1 r of δ r 2 is determined by the following triggering condition 27 t j 1 r inf t r t t j r c ˆ r 2 e r 2 m r 2 k r 1 2 1 γ r β r 2 β r 2 η r where 0 γ r 1 and η r 0 are tuning parameters 3 4 serial parallel estimation model and adaptive laws because only the surge roll and yaw motions in eq 2 are concerned the serial parallel estimation model is established only for these motions and as 28 u ˆ f x s m u w ˆ u t φ u υ k f u u p ˆ m x s m p w ˆ p t φ p υ k f p p r ˆ c ˆ r δ r 2 m r w ˆ r t φ r υ k f r r where k f i 0 with i u p r is the tuning parameter by subtracting eq 28 from eq 2 we can obtain the differential equations of the prediction errors as 29 u w u t φ u υ k f u u s u p w p t φ p υ k f p p s p r c r δ r 2 m r w r t φ r υ k f r r s r where s p ε p d w p and s p ε p d w p to be orchestrated with eqs 16 26 and 29 the adaptive laws of w u w p and w r are devised as 30 w ˆ u γ u φ u u β u σ u w ˆ u w ˆ p γ p φ p p σ p w ˆ p w ˆ r γ r φ r r β r σ r w ˆ r where γ i is a positive definite matrix and σ i 0 is the tuning parameter with i u p r to ensure the closed loop stability in the following step the uncertain gain of the rudder is estimated by the adaptive laws and we devise 31 θ ˆ γ θ φ r β r σ θ θ ˆ c ˆ r γ c e r β r m r δ r β r m r r δ r 2 m r σ c c ˆ r where γ θ γ c σ θ and σ c are positive tuning parameters remark 2 it can be observed from eq 30 that the prediction errors of u p and r are involved in the adaptive laws of the fls weights and combined with the compensated tracking errors of β u and β r it can be observed from eq 29 that the prediction errors directly relate to the approximating accuracy of the flss thus the terms of prediction errors in eq 30 function as the gradient descent algorithm for minimizing the prediction errors and the proposed composite adaptive laws can reconcile the tracking performance with the approximating accuracy xu et al 2014 li and tong 2015 li et al 2016 compared with the classic adaptive laws in deng et al 2019d which belongs to the direct adaptive control dac in ioannou and sun 1996 it leads to the smaller w i with i u p r nevertheless σ i should be bigger enough to prevent the parameter drifting 4 stability analysis the result of this paper can be concluded as the following theorem theorem 1 assume υ is defined in a compact set namely the approximating capability of the flss is always guaranteed for the sailboat described by eqs 1 and 2 and under the input saturation of eqs 5 and 6 if we adopt the control laws of eqs 13 and 23 the adaptive laws of eqs 30 and 31 and the triggering condition of eqs 17 and 27 all the tracking the prediction and the estimating errors are ensured to be sguub besides the heeling angle of ϕ is constrained in the interval of ϕ μ k p k p ϕ μ k p k p where μ is a positive variable concerning the disturbance of d w p and the estimating error of w p proof of sguub choose the lyapunov function as v β ψ 2 β u 2 β r 2 u 2 p 2 r 2 w u t γ u 1 w u w p t γ p 1 w p w r t γ r 1 w r 2 c r θ 2 2 γ θ c r 2 2 γ c consider β u 2 η u and β r 2 η r by differentiating v along eqs 16 17 21 26 27 29 30 and 31 it yields 32 v β ψ β ψ β u β u β r β r u u p p r r w u t γ u 1 w u w p t γ p 1 w p w r t γ r 1 w r c r γ θ θ θ 1 γ c c r c r k ψ β ψ 2 γ u k u 1 2 β u 2 γ r k r 1 2 β r 2 c r σ θ 2 θ 2 k f u 1 4 u 2 k f p 1 4 p 2 k f r 1 4 r 2 σ c 2 c r 2 σ u 2 w u t w u σ p 2 w p t w p σ r 2 w r t w r σ u 2 w u t w u σ p 2 w p t w p σ r 2 w r t w r c r σ θ 2 θ 2 σ c 2 c r 2 s p 2 2 s r 2 2 s u 2 select k ψ k u 1 2 k r 1 and k f u k f p k f r 1 4 define ζ min 2 k f u 1 2 2 k f p 1 2 2 k f r 1 2 2 γ u k u γ u 2 γ r k r γ r 2 k ψ σ θ γ θ σ c γ c σ u λ m i n γ u σ p λ m i n γ p σ r λ m i n γ r where λ m i n denotes the minimum eigenvalue of the matrix let ϱ σ u w u t w u 2 σ p w p t w p 2 σ r w r t w r 2 c r σ θ θ 2 2 σ c c r 2 2 s p 2 2 s r 2 2 s u 2 then eq 32 is transformed to 33 v ζ v ϱ through the comparison theorem it can be inferred from eq 33 that v t v t 0 ϱ ζ exp ζ t t 0 ϱ ζ holds thus all the errors in v are sguub and β i 2 is ultimately bounded by max η i 2 ϱ ζ with i u r further the sguub of the tracking errors namely ψ e u e and r e can be proven choose the lyapunov candidate as v ξ ξ ψ 2 ξ u 2 ξ r 2 2 differentiating v ξ along eqs 15 20 and 25 it renders 34 v ξ ξ ψ ξ ψ ξ u ξ u ξ r ξ r k ψ 1 2 ξ ψ 2 k u 1 2 ξ u 2 k r 1 ξ r 2 δ u 2 2 m u 2 c ˆ r 2 δ r 2 2 m r 2 define ζ ξ min 2 k ψ 1 2 k u 1 2 k r 2 and ϱ ξ δ u 2 2 m u 2 c ˆ r 2 δ r 2 2 m r 2 then eq 34 can be transformed to 35 v ξ ζ ξ v ξ ϱ ξ through the comparison theorem it can be inferred from eq 35 that v ξ t v ξ t 0 ϱ ξ ζ ξ exp ζ ξ t t 0 ϱ ξ ζ ξ according to the composition of ϱ ξ we can conclude that v ξ is asymptotically stable if δ u δ r 0 and is sguub if δ u and δ r keep bounded choose the lyapunov candidate of the tracking errors as v t ψ e 2 u e 2 r e 2 2 by using the inequalities of ψ e 2 2 β ψ 2 2 ξ ψ 2 u e 2 2 β u 2 2 ξ u 2 and r e 2 2 β r 2 2 ξ r 2 it further yields v t 2 v 2 v ξ according to the above analysis of v and v ξ it is clear that ψ e u e and r e in v t are sguub remark 3 because υ is defined in a compact set the control laws in eqs 13 and 23 are bounded from the definitions of δ u and δ r it is reasonable to assume that δ u and δ r keep bounded in the above analysis while the input saturation does not work namely δ u δ r 0 we have ψ e β ψ u e β u and r e β r because the input saturation will limit the control energies it is not practical to stabilize ψ e u e and r e directly for example the closed loop stability is degraded in the existing literature of ma et al 2019 deng et al 2019a and zheng et al 2018 the auxiliary systems in this paper can successfully circumvent this problem they were widely used to deal with the input saturation in li and tong 2015 and du et al 2016 and eliminate the analytical differentiation of the virtual control laws in dong et al 2012 and zhu et al 2018 remark 4 it can be inferred from eq 33 that by choosing k f u k f p k f r k u k r k ψ γ u γ r γ θ γ c λ m i n γ u λ m i n γ p and λ m i n γ r largely enough the compensated tracking errors and the prediction errors can be regulated into any small bound with a fast convergent rate nevertheless this setting may lead to an undesired transient and the waste of control energy as is mentioned in remark 3 the saturation constraint will also affect the convergence of the tracking errors besides it can be inferred from eqs 17 and 27 that the growth of γ u and γ r will increase the acting frequencies of the actuators thus the selection of these parameters should be devoted to the desired closed loop response and practical needs remark 5 one can follow jiao and wang 2016a b and deng et al 2019a e to prove the existence of the minimum inter event time of the sail in the first equation of eq 17 and that of the rudder in eq 27 in brief the control errors of e u and e r are reset to 0 at the triggering instants and the growth rates of e u 2 and c ˆ r e r 2 are bounded in the compact set while the triggering thresholds are ensured to be bigger than m u 2 k u 1 2 1 γ u η u and m r 2 k r 1 2 1 γ r η r a minimum time is always ensured for e u 2 and c ˆ r e r 2 to rise from 0 to the triggering thresholds remark 6 according to krstić et al 1995 the smoothness of control inputs is one of sufficient conditions to ensure the feasibility of the backstepping method whereas the control inputs of δ s and δ r 2 are unsmooth at the triggering instant in this paper nevertheless the unsmooth control inputs herein will not damage the application of backstepping for this purpose we can refer to the tool of impulsive dynamical system in haddad et al 2006 while it denotes the jumps of v and v t at the triggering instant as δ v and δ v t it is clear from eq 2 that δ v δ v t 0 because δ s and δ r 2 keep unchanged and smooth during the inter event time the convergence of v and v t is guaranteed in the entire time domain which illustrates the feasibility of backstepping in this paper for the case of δ v 0 a more complex analysis is required seeing deng et al 2019b proof of heeling constraint while f x s is bounded by the derived f x s it holds m x s m x s m x s during the voyage by substituting eqs 10 to 2 it yields 36 p k p p p p w p t φ p d w p p k p p p p w p t φ p d w p define μ w p 2 2 1 2 d w p by solving eq 36 through the comparison theorem one can obtain 37 p t p t μ k p p t 0 p t 0 μ k p exp k p t t 0 p t p t μ k p p t 0 p t 0 μ k p exp k p t t 0 it can be inferred from eq 37 that if p t 0 p t 0 p t 0 holds p t μ k p p t p t μ k p always holds by substituting eqs 8 to 1 it yields 38 ϕ k p ϕ ϕ μ k p ϕ k p ϕ ϕ μ k p by solving eq 38 through the comparison theorem one can obtain 39 ϕ t ϕ μ k p k p ϕ t 0 ϕ μ k p k p exp k p t t 0 ϕ t ϕ μ k p k p ϕ t 0 ϕ μ k p k p exp k p t t 0 it can be inferred from eq 39 that if ϕ ϕ t 0 ϕ initially holds ϕ μ k p k p ϕ t ϕ μ k p k p always holds because w p in μ is bounded according to the above analysis it is known that the varying range of ϕ μ k p k p ϕ μ k p k p will converge to ϕ ϕ by increasing k p and k p the proof is completed 5 numerical experiment a 12 m sailing yacht is chosen to be the experimental objective it was also adopted in xiao and jouffroy 2014 and deng et al 2019d the author can refer to these literature for the detailed parameters the lift and drag coefficients of the sail are provided in fig 3 corresponding to the attacking angle of α s here the path following task is carried out to verify the effectiveness of the proposed scheme the curved reference path is described by the sinusoidal function of x d 150 sin π y d 100 50 with y d 0 m 500 m where x d and y d are the positional coordinates of the reference path the parallel guidance principle in deng et al 2019e is adopted to generate the desired heading angle of ψ d and the desired surge speed of u d is selected as 2 m s the true wind is set with the speed of 6 m s which points to the south and revolves anticlockwise with the constant rate of 0 01 s the simplified disturbances are described by the first order markov process as eq 40 40 d w u 0 1 d w u 0 05 ω u d w v 0 1 d w v 0 05 ω v d w p 0 1 d w p 0 02 ω p d w r 0 1 d w r 0 02 ω r where ω i with i u v p v is the gauss white noise with the variance of 1 the initial positional coordinates attitudes and kinematic states of the sailboat are set as x t 0 y t 0 0 m ψ t 0 45 ϕ t 0 0 u t 0 v t 0 0 m s and p t 0 r t 0 0 s to outstand the advantages of the proposed scheme the event triggered robust fuzzy damping control scheme in deng et al 2019e is selected for comparison the heeling constraint is not considered in that scheme and the parameters are regulated to preserve the best control performances the sailboat with that scheme is marked as no 1 to demonstrate the advantages of the composite learning we set another comparison of the customary direct adaptive control different with eq 30 the adaptive laws of fls weights in this scheme are devised as 41 w ˆ u γ u φ u β u σ u w ˆ u w ˆ p γ p φ p p σ p w ˆ p w ˆ r γ r φ r β r σ r w ˆ r where the prediction errors are exempted and the serial parallel estimation model of eq 28 is not required the sailboat with this scheme is marked as no 2 finally the sailboat with the proposed composite adaptive scheme in this paper is marked as no 3 it should be noted that all the parameters of the no 2 and the no 3 sailboats keep the same and are presented as eq 42 42 k ψ 0 5 k u 0 1 k r 0 2 k p k p 1 γ u 0 6 γ r 0 8 k f u k f p k f r 0 1 η u η r 0 5 γ u γ p γ r 0 1 i 5 5 σ u σ p σ r 0 1 γ θ γ c 0 1 σ θ σ c 1 the threshold of the heeling angle is set as ϕ 30 then the numerical experiment is carried out in the environment of matlab the results are shown in figs 4 13 and the quantified control performances are provided in table 2 fig 4 exhibits the trajectories of the three sailboats the parallel guidance principle works well and all the three sailboats can track the reference path in a satisfactory accuracy in this figure the no 1 and the no 3 sailboats behave better than the no 2 define the average tracking errors as eq 43 43 ψ e m t 0 t e n d ψ e τ d τ u e m t 0 t e n d u e τ d τ where t e n d is the total voyage time it can be found in table 2 that ψ e m u e m and t e n d of the no 2 are bigger than those of the no 1 and the no 3 this suggests the tracking performance of the no 2 is degraded due to the inaccurate approximation of the flss fig 5 shows the evolution of the disturbances within 1700 s the first order markov process can embodies the features of the waves in a normal sea condition with fidelity fig 6 exhibits the evolution of the kinematic states according to the analysis in remark 3 it is reasonable that u cannot always reach the desired value of u d the speed loss of u inevitably happens at the tacking maneuver v is passively bounded and its overshoots occur at the tacking maneuver p oscillates drastically but keeps bounded during the voyage the overshoots of r occur while the sailboats turn the above speed responses are reasonable for the sailboat fig 7 exhibits the evolution of the heeling angles it can be observed that ϕ of the no 2 and the no 3 sailboats are nearly bounded by the red dashed lines of ϕ during the voyage whereas the no 1 often breaks through the threshold while the sailboat turns the maximum heeling angles of ϕ m a x are provided in table 2 the ϕ m a x of the no 2 is a little bigger than ϕ which is caused by μ k p k p according to the above proof it should be noted that the proposed scheme sacrifices the thrust of the sail for satisfying the heeling constraint thus the average of u in the no 2 and the no 3 sailboats is slower than that in the no 1 such that t e n d of them is also longer than that of the no 1 in table 2 fig 8 demonstrates the control inputs of δ s and δ r affected by the disturbances both of them oscillate drastically during the voyage the saturation of δ r occurs while the sailboat turns it can be observed from the local enlarged view at 650 680 s of fig 8 b that the control inputs hold during the inter event time and the event triggered mechanism works fig 9 shows the accumulation of triggering times within 1700 s compared with the continuous scheme the saving of acting frequencies is remarkable in three sailboats it can be observed that the accumulation in the no 1 grows faster than that in the others due to the conservatism of the robust control the total accumulation at 1700 s of the sail and the rudder are denoted as n s and n r respectively which are provided in table 2 fig 10 provides the α s of the no 3 sailboat corresponding to α s p α s u and α s l respectively during the voyage the varying range of α s is determined from 0 to the minimum of these three curves fig 11 compares the approximating errors of the flss in the no 2 and the no 3 sailboats it can be observed that the approximating error of the no 3 is significantly smaller than that of the no 2 the composite learning of the flss is effective in identifying the uncertainties fig 12 demonstrates the evolution of w ˆ u w ˆ p and w ˆ r while fig 13 demonstrates the evolution of θ ˆ and c ˆ r in the no 3 sailboat according to the stability analysis all of them tend to be bounded it should be noted that the design in eq 31 belongs to dac such that θ ˆ c ˆ r 1 is not achievable in fig 13 the computational simplicity of three control schemes is also compared in this simulation through the profile function in matlab we record the memory occupation of the three programs during their running time from table 2 it is found that the robust damping in deng et al 2019e is the most succinct one this is because the adaptive laws are not required in that scheme however the proposed control scheme can outperform the robust damping one in less conservatism 6 conclusion this paper investigates the event triggered composite adaptive fuzzy control of the sailboat in the surge speed and the heading angle in addition the heeling constraint is considered during the voyage the serial parallel estimation model is constructed to evaluate the approximating accuracy of the flss and the prediction errors are involved in the composite adaptive laws with the known aerodynamics of the sail the heeling constraint is transformed to the input saturation of the sail the auxiliary systems are fabricated to offset the input saturation the etc laws are separately built for the sail and the rudder with the triggering conditions the uncertain gain of the rudder is estimated by the adaptive laws finally the proposed control scheme is matched with the path following guidance principle in deng et al 2019e and the fine control performances are observed in the simulation this paper is deemed as a phase summary of our work in the control of the sailboat in the future we can improve this scheme with output feedback and get enlightened from li and tong 2015 and li et al 2016 credit authorship contribution statement yingjie deng writing orignial draft writing review editing xianku zhang conceptualization supervision qiang zhang software validation yancai hu investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially supported by national science foundation of china no 51679024 fundamental research funds for the central university china no 3132019501 university 111 project of china no b08046 national science foundation of shandong jiaotong university china no z201631 key research and development plan of shandong province china no 2019jzzy020712 and shandong jiaotong university phd startup foundation of scientific research china 
21706,this numerical study aims to examine the viability of energy harvesting by three rigidly coupled cylinders in an equilateral triangular pattern as well as reveal the flow induced vibration responses of such a system first a wide range of reduced velocity u r 1 30 is selected to examine the effects of gap ratios g 0 01 to 1 then based on these results various damping ratios ζ 0 013 0 7 are tested to further improve the efficiency the results show that with a decrease in the gap the energy converter generates a higher amplitude and a lower oscillation frequency in the high flow speed region the fully developed galloping branch can be found in g 0 01 and 0 2 for g 0 5 a new branch appears in which the vortex induced vibration and galloping vibrate in combination way and reach a stable state the amplitude in the new branch is higher than that of the upper branch whereas the oscillation frequency still locks into the natural frequency furthermore a new vortex shedding mode of 4p can be detected in this branch at small gaps the harnessed power increases without an upper limit owing to the galloping as expected the maximum efficiency point is located on the upper branch in terms of damping ratio variation the three cylinder energy converter has high sensitivity and ζ 0 5 is the critical damping ratio for amplitude and frequency responses the novel energy converter exhibits potential for power collection and g 0 2 ζ 0 2 respectively is the most suitable arrangement and damping parameter for energy harvesting in all tests keywords vortex induced vibration galloping energy harvesting gap and damping effects fluid structure interaction three cylinders 1 introduction flow induced vibration fiv a typical fluid structure interaction phenomenon may occur in many bluff bodies under flow forces or vortices such as deep sea risers ocean platforms mooring lines and even buildings sarpkaya 2004 blevins 1977 when the oscillation frequency and the vortex shedding frequency are close to the natural frequency lock in or lock on will occur and then cause high amplitude vibration of the structure fiv is usually treated as a high energy and harmful phenomenon which will cause structural and fatigue failures particularly in the lock in range low and srinil 2016 rashidi et al 2016 as a result extensive studies on fiv have been carried out in recent decades because of its significance in structural design it was found that the mass ratio and damping ratio are crucial parameters for fiv responses which affect the lock in significantly bahmani and akbari 2010 khalak and williamson 1997 williamson and govardhan 2004 khalak and willamson 1999 classified the fiv responses of a low mass damping cylinder into three distinct regions the initial upper and lower branches the cylinder not only presents different variations of amplitude and frequency according to the different branches but also produces a variety of wake patterns mainly involving 2s 2p and p s modes where s and p stand for a single vortex and a pair of vortices respectively williamson and govardhan 2004 for more details about fiv see reviews by sarpkaya 2004 and williamson and govardhan 2004 2008 in some cases however fiv may not be a harmful phenomenon it has recently been found that under the influence of fiv a structure will absorb most of the fluid kinetic energy in the process of vibrating this characteristic can be used effectively in energy harvesting bernitsas et al 2008 ma et al 2016 there are two main forms of fiv vortex induced vibration viv and galloping bernitsas et al 2008 developed the vortex induced vibration aquatic clean energy vivace converter which consists of an oscillator transmission mechanism and power take off system the viv energy converter worked successfully at a low speed current 0 4m s and generated considerable hydrokinetic power lee and bernitsas 2011 viv is a type of aerodynamic stable vibration phenomenon whereas galloping is a high amplitude and low frequency oscillation caused by unstable flow force parkinson and smith 1964 parkinson 1989 galloping will lead to intense vibration of the structure improving the performance and robustness of the fiv energy converter chang et al 2011 zhang et al 2018c obviously to harvest more energy from fiv it is necessary to promote vibration responses and generate galloping however galloping will not occur in a single smooth cylinder with circular shape because it has a highly symmetric cross section to the flow parkinson 1989 for this reason first a passive turbulence control ptc cylinder is tested for energy harvesting experimental chang et al 2011 and numerical studies ding et al 2015 2016 show that increasing the surface roughness of the smooth cylinder will not only extend the lock in range but also lead to galloping and increase the harnessed power in the high flow speed range second galloping instability may occur in some non circular cylinders because of their asymmetry with respect to the flow therefore an fiv energy converter with different cross sections has been developed and investigated ding et al 2015 barrero gil et al 2010 in addition to the above cases galloping will also occur in a multi cylinder system because of the interaction between the upstream and downstream cylinders when a fiv cylinder is located in the wake of another cylinder the vortex shedding mode and structural response are significantly different from those of an isolated cylinder assi et al 2010 because of the complexity of flow fields and oscillation responses of multiple cylinders studies on this are far scarcer than those on an isolated cylinder sumner 2010 reviewed different flow situations of two cylinders and classified them according to whether the cylinders are staggered arranged in tandem or side by side it was found that regardless of the arrangement the effects of spacings and reynolds numbers on flow field are strong and significant the fiv responses of two tandem cylinders have been measured by experimental tests assi et al 2010 and numerical simulations griffith et al 2017 wang et al 2017 the studies showed that at a small spacing viv would transit into galloping as the flow velocity increased for two cylinders in a side by side arrangement the cylinders interact intensely with each other particularly at a small spacing which causes notably higher amplitudes compared with the single cylinder case huera huarte and gharib 2011 through numerical simulation zhao 2013 2016 investigated the fiv responses of two rigidly coupled cylinders at low reynolds numbers in both side by side and tandem arrangements the results showed that there were considerable differences between rigidly coupled cases and free vibrations and galloping was observed at small gaps regarding energy harvesting of two cylinders by fiv ding et al 2013 successfully simulated two ptc cylinders in tandem arrangement using a two dimensional unsteady reynolds averaged navier stokes urans method the numerical results were well matched with experimental data research on fiv of a multi cylinder system more than two cylinders has broad significance in engineering design and applications however capturing the fiv characteristics of cylinder groups has been a challenging problem that cannot be inferred from the simplified situations of one or two cylinders and existing studies on it are far from sufficient kim and bernitsas 2016 have experimentally tested a group of fiv energy converters in a tandem arrangement in their work experiments with two three and four cylinders with the spacing ratio varying from 2 5 to 5 0 were conducted the results showed that multiple cylinders at proximity could convert more power than the same number of isolated cylinders ding et al 2018 reached a similar conclusion by simulating three in line ptc cylinders chen et al 2018 as well as yu et al 2016 focused on the fiv responses of three cylinders in a tandem pattern at low reynolds numbers the numerical results indicated that the dynamic responses of three cylinders differed from those of two tandem cylinders in addition compared with an isolated cylinder the amplitudes of the three cylinders were increased a group of cylinders can be arranged in a variety of ways an equilateral triangle arrangement with three cylinders is one of the typical configurations this pattern often occurs in ocean engineering such as oil and gas riser pipes strapped together with the legs arranged as a tension leg platform or jack up system however very few studies focus on this field kubo et al 1995 experimentally investigated the vibration responses of 2 4 cylinders in various arrangements in a wind tunnel our previous studies focused on the effects of incidence angles on fiv of three rigidly coupled cylinders in an equilateral triangle arrangement han et al 2018b a it was found that the interference among the cylinders at a small spacing ratio with incidence angle of 0 was much more intense than that of other cases and galloping occurred in this situation causing the maximum amplitude to increase with flow velocity without an upper limit based on the above conclusions we consider the fiv responses of three rigidly coupled cylinders to be beneficial for energy conversion due to their high amplitude therefore in this study numerical simulations are performed to determine the fiv responses and energy harvesting ability of three rigidly coupled cylinders arranged in an equilateral triangular pattern which have not yet been investigated the paper is organized as follows first section 2 presents the design and physical model of the energy converter second in sections 3 and 4 we introduce the mathematical and numerical models for simulating fiv responses and analyzing energy conversion characteristics in section 5 1 the effects of the gap ratio on fiv dynamics and energy harvesting including amplitude and frequency response hydrodynamic characteristics vortex shedding mode energy conversion efficiency and harnessed power are simulated and discussed in detail a suitable arrangement for energy harvesting can therefore be obtained based on the results in section 5 2 to find ways to further improve the energy efficiency a series of numerical tests are conducted at the optimal arrangement with various damping ratios the damping effects are also analyzed in this section finally the main conclusions are summarized 2 physical model fig 1 displays a simplified energy converter which consists of three cylinders springs and a generator the three cylinder oscillator vibrates under the flow and drives the generator using the fluid energy with the rigid connection the individual cylinders form a whole so they vibrate at the same frequency and amplitude the right figure shows the definition of incidence angle α in previous work han et al 2018b we have already investigated incidence angle effects and found that galloping and intense vibration occur in the condition of α 0 to better harvest energy from fiv therefore 0 is selected in this paper the effects of the gap ratio g on energy harvesting and fiv responses are studied here g is defined as g l d where l is the distance between cylinders as shown in fig 1 and d represents the diameter of a single cylinder once the spacing between each cylinder is over 1 d the amplitude of the three cylinder oscillator notably decreases hence we select four groups of gap ratios g 0 01 0 2 0 5 and 1 in addition the energy converter is only allowed to vibrate in the y direction on the one hand this is because the lateral displacement is often much larger than the displacement of the flow direction on the other hand it is more conducive for the transmission mechanism to harvest energy from the vibration with one dof of motion table 1 lists the main parameters of the physical model the mass ratio m m 4 m π ρ d 2 is calculated as the total mass of the three cylinder oscillator m divided by its displaced volume multiplied by the fluid density ρ to further improve the converted efficiency we test different damping ratios ζ in section 5 2 where the minimum damping ratio is 0 013 and the maximum is selected as 0 7 the damping ratio is defined as ζ c 2 m k where c and k represent the total damping coefficient and the stiffness respectively here the terms m c and k are defined per unit length to develop a 2d model galloping usually occurs after viv at high flow speed particularly in the case of hydroelastic oscillations because of the high fluid density parkinson 1989 thus a sufficiently wide range of incoming flow velocity from u 0 1 m s to u 3 m s is analyzed to capture galloping more clearly the corresponding reynolds number r e defined as r e u d l ν therefore varies from 8000 to 240000 here ν is the kinematic viscosity coefficient of the flow and d l represents the characteristic length of the oscillator the reduced velocity u r can also be calculated as between 1 and 30 in this paper u r is defined as u r u f n d l where f n represents the natural frequency of the three cylinders and can be expressed as f n k m 2 π the corresponding structural angular frequency ω s can be obtained by ω s 2 π f n note that i u r is defined based on the structural natural frequency f n as in some numerical studies zhao 2013 cui et al 2015 however in many experimental studies khalak and williamson 1997 williamson and govardhan 2004 it is defined based on the natural frequency in still water f n w a t e r f n w a t e r k m m a 2 π where m a is the added mass and this point will be discussed later in section 4 3 ii for the three rigidly coupled cylinders the characteristic length d l may change as the gap ratio g changes particularly within a small gap range however we use d l d here to define the reynolds number r e and the reduced velocity u r for a better comparison of gap ratio effects as in zhao 2013 iii it can be found that the ratio of r e to u r is a constant of 8000 which means the natural frequency f n in this study stays fixed 3 mathematical model 3 1 equations of the flow at present the flow over the three rigidly coupled cylinders is solved by the two dimensional incompressible form of the unsteady reynolds averaged navier stokes rans equations which include the continuity equation and momentum equation it can be expressed as 1 u i x i 0 u i t u j u i x j 1 ρ p x i ν 2 u i u i u j x j where i represents the direction x represents the cartesian coordinate and t denotes the time here u and p represent the time averaged values of velocity and pressure u i u j is the reynolds stress tensor which can be expressed as 2 u i u j ν t u i x j u j x i 2 3 k δ i j where ν t represents the turbulent viscosity which is given by the turbulence model the turbulent kinetic energy k can be expressed as k u i u i 2 here δ i j is the kronecker delta function in this paper the shear stress transport sst k ω model is selected to solve the turbulent flow because of its apparent advantages of prediction in both adverse pressure and gradient flow this model includes two transport equations from which the k and the specific dissipation rate ω can be obtained the two equations read 3 k t x i k u i x j ν ν t σ k k x j u i u j u j x i β k k ω ω t x i ω u i x j ν ν t σ ω 1 ω x j α s 2 β ω ω 2 2 1 f 1 1 σ ω 2 1 ω k x j ω x j where f 1 and s represent the blending function and strain rate respectively for other constant values and more details see menter 1994 the segregated pressure implicit with splitting of operators piso algorithm is adopted in this paper to solve the momentum and continuity equations together and the implicit first order scheme is employed for the unsteady terms the two transport equations for the turbulent energy k and the dissipation rate ω are solved by a second order upwind scheme for the diffusion terms and the convection terms a second order scheme is used these numerical tools are now widely used ding et al 2015 2013 guilmineau and queutey 2004 han et al 2018b khan et al 2017 and lin and wang 2013 compared different turbulence models in predicting the fiv of a single cylinder the results show that in a relatively long time simulation the two dimensional rans case in conjunction with the sst k ω turbulence model provide a balance of efficiency and accuracy which is credible and reasonable for analyzing the fiv phenomenon a similar method has been used in many published papers zhang et al 2018c ding et al 2015 2016 han et al 2018b guilmineau and queutey 2004 khan et al 2017 pan et al 2007 chae et al 2016 3 2 equations of the motion a typical mass damper oscillator model is introduced here to describe the vibration responses of the three cylinder energy converter the motion in the y direction for the oscillator can be modeled by 4 m a y c a y k a y f y where a y represent the transverse displacement and f y is the resultant force in the y direction acting on the cylinders based on williamson and govardhan 2004 and bernitsas et al 2008 this fluid force f y can be separated into two components viscous force f v i s c o u s and inviscid force f i n v i s c i d here f i n v i s c i d can be considered as the added mass effects we now introduce some dimensionless terms defined as in eq 5 including the structural based timescale t ˆ the dimensionless displacement y and the total lift coefficient c l t o t 5 t ˆ t ω s y a y d c l t o t 2 f y ρ u 2 d substituting the t ˆ y c l damping ratio ζ reduced velocity u r and structural angular frequency ω s into eq 4 gives the dimensionless form of the mck equation which reads 6 y 2 ζ y y c l t o t u r 2 2 π 3 m note that the in eq 6 stands for derivation of dimensionless time t ˆ in this study user defined functions udf written in the c programming language and incorporating the newmark beta algorithm are used to solve the motion equation eq 6 newmark beta an implicit time integration method is widely accepted in the numerical estimation of structural dynamic responses and has been successfully applied in predicting vibration characteristics zhang et al 2018c han et al 2018b deü and matignon 2010 in newmark beta programming by extending the extended mean value theorem to the first and second time derivatives the corresponding lateral displacement y t ˆ velocity y t ˆ and acceleration y t ˆ can be obtained the equations for this algorithm are written as 7 y t ˆ δ t ˆ y t ˆ 1 β n y t ˆ β n y t ˆ δ t ˆ δ t ˆ 8 y t ˆ δ t ˆ y t ˆ y t ˆ δ t ˆ 0 5 α n y t ˆ α n y t ˆ δ t ˆ δ t ˆ 2 where δ t ˆ represents the time step the subscripts represent the variables at different time both parameters α n and β n are constants of which α n is limited to 0 5 because of the requirement of the second order scheme the parameter β n can be set in various values between 0 and 0 5 and in this paper we use β n 0 25 which yields the constant average acceleration method and is known to be a reasonable value deü and matignon 2010 finally using these second order accurate and unconditionally stable parameters α n and β n the motion of the three cylinder oscillator can be solved for more details of this method see the authors previous studies zhang et al 2018c han et al 2018b zhang et al 2018a b 3 3 equations of energy harvesting in one vibration cycle t v i b of the three cylinder energy conversion device the total energy acquired power p e n e r g y can be calculated by 9 p e n e r g y 1 t v i b 0 t v i b f y d a y d t d t 1 t v i b 0 t v i b m d 2 a y d t 2 c d a y d t k a y d a y d t d t based on the numerical simulation method the displacement velocity and acceleration of three rigidly coupled cylinders can be extracted at each time step using the udf program in fact the force terms related to the mass m and stiffness k do not contribute to energy harvesting because they are always out of phase with the velocity thus the only non zero term in eq 9 is produced by the total damping coefficient c and the power p e n e r g y can be rewritten as 10 p e n e r g y 1 t v i b 0 t v i b c d a y d t 2 d t c d a y d t 2 where stands for the time averaged quantities the power p e n e r g y cannot be completely used to generate electricity in engineering applications because there is always the dissipated power p d i s s caused by the transmission mechanism for instance the gear the sliding guide etc thus the effective conversion power p h a r n e s s should be equal to the total conversion power p e n e r g y minus the dissipated power however it is difficult to accurately estimate the corresponding dissipative damping coefficient c d i s s of the system in addition c d i s s does not affect the numerical results it is only related to the data post processing for this reason we use the total damping coefficient and total power to describe the performance of the energy harvesting characteristics as in zhang et al 2018c barrero gil et al 2010 and grouthier et al 2014 furthermore the total power from fluid over the area swept by the three cylinders can be obtained as 11 p f l u i d p k q where p k is the kinetic pressure head and can be calculated by the bernoulli s equation which reads p k ρ u 2 2 here q represents the volumetric flow rate defined as q s f l o w u where s f l o w is the flow area note that i because several gap ratios 0 01 0 2 0 5 and 1 are selected for testing the corresponding flow area therefore varies between 2 01 d 2 2 d 2 5 d and 3 d ii there are in fact several criteria to define p f l u i d see zhang et al 2018a and sun et al 2016 presently we use the same definition for the fluid power as in bernitsas et al 2008 ding et al 2015 and grouthier et al 2014 finally the energy conversion efficiency η can be obtained as the ratio of total energy acquired power p e n e r g y to power available in the fluid p f l u i d 12 η 2 c d a y d t 2 ρ u 3 s f l o w b e t z l i m i t the betz limit which gives the theoretical maximum efficiency that can be extracted from the flow is also considered as in ma et al 2016 and zhang et al 2018c the value of the betz limit is known to be 59 26 16 27 now substituting the terms including t ˆ u r g ζ y and m into eq 12 gives the dimensionless form of the efficiency with a structural based timescale in this paper eq 12 can be directly solved by the compound simpson method 13 η 27 π 4 m ζ y y 2 u r 3 g 2 4 numerical method validation 4 1 computational domain and boundary conditions the effects of gap ratio g and damping ratio ζ are studied in this paper an example of the computational domain for the three cylinder energy converter is plotted in fig 2 the size of which is 45 d 40 d once the ratio w d w represents the width of the computational domain exceeds 10 the effects of the side boundaries on simulation results are negligible zhao et al 2012 therefore the distance from the inlet boundary to the central point of the three cylinder oscillator is 15 d because galloping and high amplitude oscillation will occur in the three cylinder system we set both ranges from the upper and lower boundaries to the centerline at 20 d in addition we split the entire computational domain into seven sub regions consisting of a motion domain 1 that can oscillate up and down a vortex shedding domain 2 for capturing more details of vortices two deformation domains 3 4 for updating the grid using the layering method and three far field domains 5 6 7 the velocity inlet condition is used in the inlet boundary with uniform and steady flow the outflow boundary is applied in the outlet where the gradient of fluid velocity and turbulence in the normal direction of the boundary is zero the surfaces of the cylinders are specified non slip boundaries along which the fluid velocity is the same as the vibrating velocity slip walls on both the upper and lower sides are assigned where the normal velocity component is set to zero the seven sub domains are set as interface boundaries to exchange the flow information at present the whole computational domain is fully filled with quadrilateral cells figs 2 b and 2 c show the grid details of the motion domain where the sizes along the x and y directions of this domain are both 11d the highest velocity gradient exists in this region therefore the grids of the domain 1 are further enhanced with high grid resolution in particular around the near wall areas of the cylinders according to the requirement of the sst k ω model for the near wall mesh the y 1 is used to determine the height of the first layer grid for different reynolds numbers here y is a non dimensional distance from the cylinder s surface to the first mesh node and it needs to be considered in any cfd simulations see schlichting and gersten 2016 when fluid induced vibration occurs the motion domain 1 where a block dynamic mesh technique is used will oscillate along with the three cylinders in a layering manner to ensure the grids at the region are not updated or changed this method can effectively avoid stretching and distortion of the grids furthermore compared with the overlapping grid it can reduce the amount of information exchange additionally to a certain extent this approach can lower the cpu time while ensuring calculation accuracy the procedure of numerical simulations is as follows a start simulation and initialize the flow field velocity pressure etc b solve the unsteady rans equations with the sst k ω turbulence model at time t using the software fluent c extract the flow information for instance the transverse force of the three cylinder oscillator from the previous step b using the udf program d use the newmark β algorithm to solve the mck equation with the current flow information and then output the position information for the next time t δ t e update the mesh with the obtained position and return the new mesh to step b to start another loop of calculation f finally finish the simulation if the required time has been reached 4 2 mesh independence and time step validation the grid resolution will significantly affect the numerical results and computing time so grid sensitivity needs to be examined before starting the calculation at present four groups of grids with different densities are selected to simulate the flow over a fixed three cylinder system at r e 56000 the results are listed in table 2 once the grid exceeds 95000 elements both the root mean square of lift coefficient c l t o t and average drag coefficient c d t o t maintain a good consistency here c d t o t is defined as c d t o t 2 f x ρ u 2 d where f x is the resultant force in the x direction acting on the cylinders considering the computational efficiency against the need for accuracy mesh 3 is used in the following simulations specifically in mesh 3 18 layers of grids with a growth rate of 1 2 are arranged from the surface of each cylinder to cover the boundary area in each layer 360 uniformly distributed nodes are set to determine an appropriate time step to achieve a convergent and accurate solution in a reasonable computational time we predict the fiv of three rigidly coupled cylinders at r e 112 000 and g 0 2 with different time steps from t ˆ 0 007 to 0 7 t 0 001 s to 0 1 s the variations of amplitude y and drag coefficient c d t o t of cylinders under various time steps are compared in figs 3 a and 3 b respectively it can be seen that the differences in both the maximum amplitude and drag coefficient between t ˆ 0 021 and t ˆ 0 007 are negligible thus t ˆ 0 021 that is t 0 003 s is a suitable time step with a balance between solution accuracy and efficiency additionally to better observe the fiv characteristics of the cylinders and capture the limit cycle oscillations we set a sufficient calculation time 50000 time steps 20 iterations step in each case 4 3 model verification the reliability of the numerical method developed in this study needs to be verified prior to the calculations in this section we simulate the fiv of a single cylinder and then compare the results with the published data the main parameters used in this validated simulation are taken from the experiment of which m 2 4 ζ 0 0045 and u r varies from 1 to 16 khalak and williamson 1997 note that the reduced velocity u r used in this section is defined as u r u f n w a t e r d as in the experiment khalak and williamson 1997 as mentioned before f n w a t e r is the natural frequency in still water f n w a t e r k m m a 2 π here the added mass m a can be derived from the potential flow theory which reads m a ρ π d 2 4 blevins 1977 at present the definition of the natural frequency f n f n w a t e r on the reduced velocity is still disputable however the setting does not affect the numerical results and it is only related to the data post processing the comparison of the present results and the published data is plotted in fig 4 where fig 4 a is the amplitude response and fig 4 b is the frequency response besides experimental data khalak and williamson 1997 other numerical results are also graphed in the same figure for comparison including 2d lin and wang 2013 pan et al 2007 and 3d data lucor et al 2005 the maximum dimensionless amplitude d is obtained by averaging the absolute values of peak displacements y in the limit cycle regime the oscillation frequency f o s c is calculated by fast fourier transform fft based on the displacement y it can be seen from fig 4 a basically that the present amplitude curve shows a consistent trend with the published data including an initial branch u r 5 closely followed by upper and lower branches the amplitude increases in the initial branch and gradually disappears after the lower branch in the upper branch high amplitude oscillation occurs however there are some differences in maximum amplitude between the present and published data these are probably due to some different settings between the numerical model and the experiment for instance the initial conditions as well as random behavior of vibrations enhanced by low values of m and ζ guilmineau and queutey 2004 pan et al 2007 in fact as reported by williamson and govardhan 2004 2008 the maximum attainable amplitude in the upper branch is not fully understood other cfd simulations even the 3d approach with zero damping rarely make a complete estimate of the upper branch regarding fig 4 b curve a denotes the natural frequency effects while curve b denotes the effects of the vortex shedding frequency f v or strouhal shedding frequency here f v is defined as f v 2 π s t u d where s t is the strouhal number the two curves describe the characteristics of frequencies when fiv occurs and it can be found that the present model gives reasonable predictions for the frequency response overall the most important features were captured by the proposed model 5 results and discussion 5 1 effects of gap ratio and flow velocity in this section we predict the fiv of the three cylinder energy converter at g 0 01 0 2 0 5 and 1 the effects of g on fiv responses as well as energy conversion characteristics are analyzed 5 1 1 fiv responses fig 5 shows the variations of the dimensionless amplitude with the reduced velocity u r for different gap ratios g of the three cylinder oscillator the amplitude response of a single cylinder is also included in the figure for comparison khalak and williamson 1997 in general the amplitude presents an increasing trend as the g decreases particularly in the high reduced velocity region in addition the vibration of the energy converter is obviously more intense than that of a single cylinder when the gap ratio is 1 the amplitude of the three cylinder energy converter experiences a significant drop around u r 24 and then stabilizes at a low value which is similar to the curve of a single cylinder however in the case of a relatively low gap the vibration amplitude keeps increasing with the growth of flow speed without limit for instance when u r 30 and g 0 01 the amplitude reaches as high as 9 13 d whereas the maximum amplitude of a single cylinder is just approximately 1 d the reason for this phenomenon is that galloping occurs in the three cylinder oscillator at a small gap ratio to further understand the fiv characteristics under a small spacing we classify the different vibration responses into various branches including the initial branch upper branch transition branch galloping branch desynchronized branch and a new branch named the combined branch all of these will be discussed in detail in the subsequent analysis based on the fft method the frequency responses of the energy converter varying with u r at various gap ratios are plotted in fig 5 b here f is defined as f o s c f n where the oscillation frequency f o s c is obtained by the most dominant peak frequency extracted from the displacement spectrum at the gap ratio of 1 lock in can be observed from the frequency response curve in which f o s c always stabilizes near the natural frequency f n as the flow velocity increases the energy converter is outside the lock in area and its vibration frequency is controlled by the vortex shedding frequency f v instead of the natural frequency at this time f o s c at g 1 is almost a linear function of u r which indicates it follows strouhal s law and it is similar to the frequency response of a single cylinder as reported by khalak and williamson 1997 and williamson and govardhan 2004 however at a gap ratio less than 1 the vibration frequency is almost unaffected by the vortex shedding frequency furthermore its effects on oscillation frequency become weaker as the gap decreases in g 0 5 0 2 and 0 01 the oscillation frequencies remain stable at a low value when the flow velocity increases enough with the lowest value occurring in g 0 01 followed by 0 2 and 0 5 in combination with the amplitude responses shown in fig 5 a it can be seen that although the frequency drops to a low value the amplitude continues to increase which indicates that the three cylinder oscillator transitions from viv into galloping more details of this will be discussed later note that in the case of g 0 01 the energy converter exhibits a very low frequency response which is not only out of the control of the vortex shedding frequency but also of the natural frequency the amplitude of the limit cycle for galloping always increases with the flow velocity in contrast to viv the galloping instability can be understood by considering the variations of the instantaneous incidence angle α ˆ parkinson 1989 parkinson and smith 1964 successfully predict the transverse galloping of a square cylinder using the quasi steady theory their model has also been applied successfully in simulating galloping of multiple cylinders and other irregular shapes of cylinders barrero gil et al 2010 charreton et al 2015 according to the quasi steady theory the force related to galloping is mainly determined by the incoming flow reynolds number turbulence intensity etc and the structural shape in this paper the three cylinders are rigidly coupled with small gaps and they have the same vibration amplitude as well as oscillation frequency thus they can be assumed as a single body with a non circular cross section for a given flow the galloping characteristics of the present oscillator therefore only depend on the shape that is the gap ratio g from fig 5 we can conclude that due to galloping or body shape effects lower oscillation frequency and higher amplitude will be generated in the high flow speed range if the spacing between cylinders decreases thus at least for the tested flow velocities in this study a larger body i e a wider g is suggested for the multi cylinder design to avoid high amplitude vibration as this will delay or even suppress the onset of galloping 5 1 2 displacement fluid force and frequency characteristics g 0 01 for each gap ratio we select several flow velocity points based on fig 5 a to further reveal the effects of u r on fiv responses for instance for g 0 01 velocities of u r 3 8 13 and 30 are chosen and the time history curves of instantaneous displacement y at these velocities are plotted in figs 6 a d the total lift coefficient c l t o t is also shown in these figures to estimate the relationship between fluid force and displacement based on the data of y and c l t o t the corresponding frequency spectra are plotted in fig 6 a d using the fft method here a c l t o t and a y represent the amplitude of the frequency spectra for c l t o t and y respectively the values of peak frequencies in the displacement spectra are marked in the figures it can be seen that during the initial branch and the transition process to the lock in area the displacement of the three cylinder oscillator is small and irregular in the corresponding frequency spectrum several peak frequencies with noise can be observed near the main frequency the condition of such energy at multiple peak frequencies leads to irregularity of oscillation when the reduced velocity exceeds 8 the vibration responses become regular and periodic as fig 6 b indicates in the frequency spectrum only one peak frequency occurs in the displacement spectrum whereas multiple obvious peaks can be found in the lift spectrum this suggests that the lift frequency is not significantly in control of the motion of the three cylinder oscillator the energy converter enters the transition region from vortex induced vibration into galloping when the reduced velocity exceeds 12 at this time the displacement curve fluctuates irregularly and phase difference occurs between the lift and displacement curves as the energy converter in the transition branch not only exhibits characteristics of viv but also has the unstable force related to galloping burrs can be found in the frequency curve of fig 6 c with the increase in flow speed finally the entire system enters the fully developed galloping branch when the reduced velocity is more than 20 in this process the vibration displacement increases significantly and regularity is simultaneously restored furthermore it can be found that the lift curve shows multi period fluctuation in one cycle oscillation of the displacement as shown in the frequency spectrum in fig 6 d in the fully developed galloping branch the value of the peak frequency in the displacement spectrum is 0 256 hz and there is an obvious decline compared with 0 568 hz in fig 6 c which is a typical sign of finishing the transition from viv into galloping g 0 2 figs 7 a c show the time history curves of the instantaneous lift coefficient and oscillation displacement in the gap ratio of 0 2 while the frequency spectra are plotted in figs 7 a c when the reduced velocity u r 8 the oscillation frequency locks into natural frequency at g 0 2 the three cylinder energy converter has a wide lock in range which ends when u r 17 as shown in fig 7 a the displacement curve presents sinusoidal fluctuations however the curve of lift coefficient vibrates irregularly and phase difference can be observed in the corresponding frequency spectrum it can be found that multiple peak frequencies in the lift spectrum only produce a single peak frequency in the displacement spectrum for instance in fig 7 a the frequency extracted from displacement keeps fluctuating near the natural frequency although the fluid force is controlled by several frequencies as the flow speed increases when u r 17 the energy converter enters the transition branch from viv into galloping the range within which chaotic vibration occurs and both the displacement and lift coefficient are affected by multiple peak frequencies when u r 19 as shown in figs 7 b and b the vibration responses are strongly controlled by both viv and galloping with the frequency of viv approximately three times that of galloping as a result regular oscillation with several different amplitude periods occurs at this time if the oscillator enters the fully developed galloping branch it recovers to regular vibration in addition as shown in fig 7 c the frequency related to galloping 0 488 hz plays a more dominant role in the displacement spectrum when compared with that frequency 0 275 hz in the transition branch see fig 7 b this is also evidence for the occurrence of fully developed galloping g 0 5 we plot the time history curves of instantaneous total lift coefficient and displacement of the three cylinder energy converter at g 0 5 in figs 8 a c while figs 8 a c give the frequency responses in the initial branch range both the lift and displacement curves fluctuate regularly when u r exceeds 8 as can be seen from figs 8 b and b the lift coefficient fluctuates unstably and its dominant frequency starts to locate at a higher frequency rather than the natural frequency which presents a sign of the beginning of galloping however note that at this time the frequency in the displacement spectrum has been locked into natural frequency and it gradually begins to get out of control by the frequency of the lift oscillation this indicates that viv also exists in the vibration responses as the flow speed increases further on the one hand the lift curve still remains irregular but periodicity can be found in each oscillation cycle in fig 8 c on the other hand the displacement curve fluctuates as a regular sinusoidal function and its oscillation frequency 1 136 hz does not experience a noticeable drop to a lower value when compared with the frequency in fig 8 b therefore the three cylinder energy converter at g 0 5 does not exhibit typical characteristics of fully developed galloping as the growth of reduced velocity and we consider it to enter a new branch the combined branch instead of the transition or galloping branch in the new branch viv and galloping vibrate in coexistence and reach a stable state as shown in fig 8 c the peak frequency in the displacement spectrum is 1 136 hz while the amplitude in the lift spectrum a c l t o t under this frequency is very low which indicates that its control over the displacement spectrum becomes negligible overall we can conclude that during the combined branch the amplitude is higher than that of the upper branch whereas the vibration frequency still locks into natural frequency and shows low correlation with the lift frequency g 1 time history curves of the instantaneous c l t o t and displacement y of the three cylinder energy converter under g 1 are shown in figs 9 a d while the corresponding frequency responses are plotted in figs 9 a d there are some similarities in fiv responses between g 0 5 and g 1 for instance as shown in figs 9 b c when the phase difference between the two curves occurs and the lift fluctuates unsteadily it can be observed that the high frequency occupies a dominant position in the lift spectrum while the primary frequency of the displacement spectrum still fluctuates around the natural frequency at this time from the amplitudes of peak frequencies in figs 9 b and c it can be found that the vibration frequency is out of control from the lift frequency thus we consider galloping to begin to occur in the energy converter and the system vibrates in the form of combination of viv and galloping however with the increase in u r as shown in fig 9 d note that the phase difference becomes stable and is maintained at 180 which means a typical phase shift phenomenon occurs in this situation as the fiv response of a single cylinder lucor et al 2005 furthermore the displacement decreases to a low value and almost disappears regarding corresponding frequency responses as shown in fig 9 d we can see that the frequencies in the lift and displacement spectra are in good agreement and both are strongly controlled by the vortex shedding frequency the above phenomena regardless of vibration response or frequency response present distinct characteristics of a desynchronized branch therefore the three cylinder energy converter in g 1 experiences the initial branch and upper branch firstly and then exhibits characteristics of the combined branch finally the energy converter enters the desynchronized branch where the vibration becomes negligible 5 1 3 vortex structure to better understand the characteristics of the fiv of the three rigidly coupled cylinders we plot the vortex shedding structure for the initial branch at different gap ratios g in fig 10 the vortex shedding structure is studied by observing the instantaneous vorticity contours around the three cylinders in the initial branch the fluid force and the displacement exhibit high consistency and no apparent phase difference can be observed in any gaps this means in each oscillation cycle there are just two vortices shed by bluff bodies and a one shot alternating lift occurs thus typical 2s mode and karman vortex street should be found in the wake and far fields of cylinders however due to the interactions between cylinders and the influence caused by the gap in some cases the vortex shedding mode of the three cylinder oscillator is not exactly the same as the standard 2s mode of a single cylinder for instance at g 0 01 vortices are shed as a similar p mode in the wake of flow and the intensity of the negative vortex is much weaker than that of the positive vortex this is because when the positive vortex is formed from cylinder 3 cylinders 1 and 2 shed their negative vortices at the same time as a result the positive vortex shed by cylinder 3 is swallowed by the negative vortices and then the remaining negative vortices shed together with the previous positive vortices forming a vortex shedding structure similar to p mode in the case of g 1 there is a certain gap allowing each cylinder to shed complete vortices independently as shown in fig 10 d the vortices generated by cylinder 2 will fuse and counteract with those shed by cylinders 1 and 3 leading to two vortex streets that can be observed in flow wake fig 11 shows the vorticity contours along the upper branch with different gap ratios g at present by changing the reduced velocity u r along the upper branch typical 2s 2p and p s modes can be found in the wake structures thus to better observe different vortex shedding modes we do not choose the same u r for different g in g 0 01 the three cylinder oscillator sheds six vortices per oscillation cycle in the near field which is similar to 2t mode however due to the desynchronization of the three cylinders when shedding vortices the two vortices are fused by others in the far field therefore it is in 2p mode for g 0 01 as shown in fig 11 b in g 0 2 the oscillator sheds vortices as a 2p 2s mode where two pairs of vortices are shed at the upper and lower extreme positions a single positive vortex is formed in the rising process of the displacement curve and a single negative vortex is generated in the falling process at g 0 5 the 2s mode can be found this is because although it is in the upper branch the displacement and lift curves still show good consistency in u r 8 when the gap alters to 1 d the vortices generated by cylinders 1 and 3 will strongly impact cylinder 2 in the oscillation process resulting in a complicated vortex structure near the cylinders however an obvious 2p mode can be found in the far field with the increase in flow speed the three cylinder energy converter shows different vibration modes for various gap ratios at u r 28 the three cylinder oscillator with gap ratios of both 0 01 and 0 2 is in a fully developed galloping branch the vortex structure of galloping is significantly different from that of viv as shown in figs 12 a and b a vortex shedding mode of np 2s can be observed in the galloping region which is a similar result to previous studies zhang et al 2018c a more specifically in g 0 01 ten pairs of vortices and two single vortices making 22 vortices in total as a 10p 2s mode are shed by cylinders in one oscillation period whereas there is an 8p 2s vortex shedding mode for g 0 2 to gain a better view of the vortex structure in the galloping branch a simplified vorticity diagram based on vorticity contours is also plotted in fig 13 which includes more details firstly five pair of vortices negative positive are formed in the rising journey and then a single negative vortex is shed at the extreme upper position in another half cycle the same vortex shedding sequence of 5p positive negative s is generated in the falling journey of which a single positive vortex is formed in the lower extreme position as mentioned in section 5 1 2 in g 0 5 viv and galloping reach an equilibrium state and co exist at high u r note that as shown in fig 12 c a new mode of 4p is observed which is differs from that of both viv and the galloping branch a more detailed vortex structure diagram is also plotted fig 14 in which two pairs of opposite vortices are shed per half cycle in addition a video for the vortex pattern has been uploaded online see https youtu be hjw4ysc7lca when the gap is changed to 1d at a high reduced velocity the three cylinder energy converter no longer generates galloping but forms very low amplitude vibration with desynchronization during the desynchronized branch high frequency vortex shedding can be detected 5 1 4 energy conversion characteristics in this section the harnessed power p e n e r g y and efficiency η are used to describe the performance of the three cylinder energy converter although a small damping ratio will not provide enough power we choose the same parameters as in the above simulations to gain a better understanding of the relationship between energy conversion characteristics and fiv responses the harnessed power here is a dimensional term and the corresponding dimensional values of ρ and d are given as 1025 kg m 3 and 0 0889 m respectively as shown in fig 15 in the initial branch both efficiency and power are very low due to the low amplitude and frequency however when the energy converter enters the upper branch it can be found that its energy conversion ability improves significantly the efficiency reaches its maximum and the harnessed power continues to increase in the upper branch more specifically the efficiency peak occurs at u r 9 when the gap ratio is 0 01 followed by 0 2 at u r 7 0 5 at u r 3 and 1 at u r 3 which indicates that the higher gap ratio may be more suitable for energy conversion in the low flow velocity range as u r increases further overall the harnessed power also continues to rise however the fluid energy p f l u i d experiences faster growth than the converted power p e n e r g y leading to a decrease in efficiency with the increase in flow velocity combining the energy characteristics with fiv responses analyzed in figs 5 a and b some phenomena can be observed 1 the harnessed power increases slowly or even undergoes a slight drop in the viv galloping transition region for instance see u r 12 g 0 01 and u r 17 g 0 2 in fig 15 the reason for this phenomenon is the decrease in oscillation frequency during the viv galloping transition process 2 in the high flow speed region compared with viv galloping is more conducive to harvesting energy at present a fully developed galloping branch can be found in g 0 01 and g 0 2 for which the converted power grows significantly and the efficiency mainly remains stable the same phenomenon also occurs in the new branch of g 0 5 where galloping and viv coexist in contrast in g 1 the energy converter enters the desynchronized branch when u r 24 it can be found that the harnessed power decreases dramatically and the conversion efficiency can be ignored this is because of the negligible amplitude response although it has a relatively high frequency 3 galloping is a kind of non self limiting phenomenon as a result there are no upper limits in either the amplitude response or the converted power as the flow speed increases for g 0 01 0 2 and 0 5 this proves that a small gap ratio will harvest more energy for the three cylinder energy converter particularly in the high flow velocity region the average conversion efficiency and average harnessed power are calculated in the caption below fig 15 to determine the most suitable arrangement for energy harvesting from fiv in general g 0 2 is considered the optimal arrangement as it has the highest average efficiency and converted power although its maximum efficiency is lower than that of g 1 and its energy harvesting ability in the galloping branch is slightly weaker than that of g 0 01 5 2 effects of damping ratio according to eqs 12 and 13 the energy conversion efficiency η is highly dependent on the damping ratio ζ in this section the multi cylinder energy converter is tested with different damping ratios to further improve the efficiency to cover the feasible values of practical engineering applications a wide range of damping ratios from 0 013 to 0 7 is selected a value less than 0 013 is of little engineering significance and a higher ζ than 0 7 will significantly suppress the vibration as mentioned before the gap of 0 2 d is considered the optimal arrangement for energy harvesting the reduced velocity here is selected from u r 6 to u r 13 which covers the high energy region as shown in fig 15 fiv responses in the high energy region with different damping ratios are plotted in fig 16 where fig 16 a is the amplitude response d and fig 16 b shows the frequency response f as expected a higher damping ratio will improve the dissipation of energy in the motion process under this circumstance the amplitude decreases with an increase in damping ratio which is consistent with the results found by zhou et al 1999 when the damping ratio ζ is less than 0 5 it can be found that the amplitudes are much more sensitive to the damping however if ζ 0 5 the d and ζ show low correlation as for the frequency response f is not significantly affected by the damping ratio f decreases as the damping ratio increases when ζ 0 5 for ζ 0 5 its effects on frequency response are negligible particularly in the range u r 9 furthermore it can be found that f will experience growth in u r 9 ζ 0 5 which indicates that the lock in phenomenon is delayed for a high damping ratio all the above evidence leads us to conclude that ζ 0 5 is the critical damping ratio for both the amplitude and frequency responses the energy efficiency with the betz limit and the converted power in the high energy region with different damping ratios are plotted in fig 17 we also listed the average data of energy harvesting characteristics and fiv responses in table 3 to better illustrate the damping ratio effects regarding the efficiency the maximum η 46 76 occurs at u r 8 ζ 0 2 followed by u r 7 ζ 0 3 39 83 the effects of damping ratio on energy harvesting are significant for instance both efficiency and power improve significantly with the increase in damping when ζ 0 2 if the damping ratio increases further the curves in figs 17 a and b begin to overlap and intersect which means the sensitivity of energy conversion ability to damping is reduced in addition it can be found that the maximum point of efficiency is located at a later reduced velocity as the damping ratio increases according to table 3 ζ 0 2 represents the highest average efficiency and harnessed power and therefore a suitable parameter for the three cylinder energy converter 6 conclusions this numerical study has discussed the fiv responses and energy harvesting characteristics of a three cylinder energy converter under different gap ratios reduced velocities and damping ratios one of its main contributions is to reveal the fiv responses of the multi cylinder system and to provide a reference for engineering design in addition we aimed to inquire into the possibility of harvesting energy using this novel device as well as finding a suitable arrangement and damping the conclusions can be summarized as follows the effects of gap ratio and reduced velocity on the fiv responses are significant as the of gap between the cylinders decreases the energy converter is prone to generating a higher amplitude and a lower oscillation frequency for g 0 01 and 0 2 viv will transition into galloping and then a fully developed galloping branch appears resulting in high amplitude and low frequency vibration in this situation vortices shed as an np 2s mode in the case of g 0 5 a new branch named combined can be detected after the upper branch in which the oscillator vibrates in combined viv and galloping and reaches a stable state more specifically the amplitude is higher than that of the upper branch whereas the oscillation frequency still locks into the natural frequency and shows low correlation with the lift frequency additionally a new vortex shedding mode of 4p can be found for g 1 the three cylinder oscillator enters the desynchronized branch at high reduced velocity accompanied by the disappearance of galloping and occurrence of phase shift as well as negligible amplitude therefore in consideration of the structural safety a large gap is suggested to avoid high amplitudes and delay or suppress the onset of galloping with a smaller gap the present energy converter exhibits better performance for energy harvesting in the high flow speed region whereas a large gap leads to early occurrence of the maximum efficiency point due to the action of galloping there are no upper limits in either the amplitude or harnessed power for g 0 01 0 2 and 0 5 overall g 0 2 is considered a suitable arrangement for energy conversion from fiv as expected the three cylinder energy converter shows high sensitivity to the damping ratio ζ 0 5 is the critical damping for both the amplitude and frequency responses when the damping ratio is relatively small the harnessed efficiency and power can be dramatically improved by increasing the damping however if ζ exceeds 0 2 it no longer has a significant influence on the energy harvesting ζ 0 2 is considered the optimal parameter for energy harvesting from fiv in all the tests in general the three mechanically coupled cylinders show good performance in energy harvesting from fiv and they have advantages in converting power in the high flow speed region owing to the galloping in future work parameters like roughness and cross section are recommended to be optimized to enhance the conversion efficiency credit authorship contribution statement peng han conceptualization methodology software validation writing original draft guang pan project administration supervision baoshou zhang software validation wei wang data curation visualization wenlong tian writing review editing acknowledgments this work is supported by national natural science foundation of china grant no 51809214 national key research and development program of china grant no 2016yfc0301300 scholarship from china scholarship council csc grant no 201906290110 we are grateful to prof emmanuel de langre from école polytechnique for some useful advice we are grateful to jiaxin zeng in durham university for some advice in english writing 
21706,this numerical study aims to examine the viability of energy harvesting by three rigidly coupled cylinders in an equilateral triangular pattern as well as reveal the flow induced vibration responses of such a system first a wide range of reduced velocity u r 1 30 is selected to examine the effects of gap ratios g 0 01 to 1 then based on these results various damping ratios ζ 0 013 0 7 are tested to further improve the efficiency the results show that with a decrease in the gap the energy converter generates a higher amplitude and a lower oscillation frequency in the high flow speed region the fully developed galloping branch can be found in g 0 01 and 0 2 for g 0 5 a new branch appears in which the vortex induced vibration and galloping vibrate in combination way and reach a stable state the amplitude in the new branch is higher than that of the upper branch whereas the oscillation frequency still locks into the natural frequency furthermore a new vortex shedding mode of 4p can be detected in this branch at small gaps the harnessed power increases without an upper limit owing to the galloping as expected the maximum efficiency point is located on the upper branch in terms of damping ratio variation the three cylinder energy converter has high sensitivity and ζ 0 5 is the critical damping ratio for amplitude and frequency responses the novel energy converter exhibits potential for power collection and g 0 2 ζ 0 2 respectively is the most suitable arrangement and damping parameter for energy harvesting in all tests keywords vortex induced vibration galloping energy harvesting gap and damping effects fluid structure interaction three cylinders 1 introduction flow induced vibration fiv a typical fluid structure interaction phenomenon may occur in many bluff bodies under flow forces or vortices such as deep sea risers ocean platforms mooring lines and even buildings sarpkaya 2004 blevins 1977 when the oscillation frequency and the vortex shedding frequency are close to the natural frequency lock in or lock on will occur and then cause high amplitude vibration of the structure fiv is usually treated as a high energy and harmful phenomenon which will cause structural and fatigue failures particularly in the lock in range low and srinil 2016 rashidi et al 2016 as a result extensive studies on fiv have been carried out in recent decades because of its significance in structural design it was found that the mass ratio and damping ratio are crucial parameters for fiv responses which affect the lock in significantly bahmani and akbari 2010 khalak and williamson 1997 williamson and govardhan 2004 khalak and willamson 1999 classified the fiv responses of a low mass damping cylinder into three distinct regions the initial upper and lower branches the cylinder not only presents different variations of amplitude and frequency according to the different branches but also produces a variety of wake patterns mainly involving 2s 2p and p s modes where s and p stand for a single vortex and a pair of vortices respectively williamson and govardhan 2004 for more details about fiv see reviews by sarpkaya 2004 and williamson and govardhan 2004 2008 in some cases however fiv may not be a harmful phenomenon it has recently been found that under the influence of fiv a structure will absorb most of the fluid kinetic energy in the process of vibrating this characteristic can be used effectively in energy harvesting bernitsas et al 2008 ma et al 2016 there are two main forms of fiv vortex induced vibration viv and galloping bernitsas et al 2008 developed the vortex induced vibration aquatic clean energy vivace converter which consists of an oscillator transmission mechanism and power take off system the viv energy converter worked successfully at a low speed current 0 4m s and generated considerable hydrokinetic power lee and bernitsas 2011 viv is a type of aerodynamic stable vibration phenomenon whereas galloping is a high amplitude and low frequency oscillation caused by unstable flow force parkinson and smith 1964 parkinson 1989 galloping will lead to intense vibration of the structure improving the performance and robustness of the fiv energy converter chang et al 2011 zhang et al 2018c obviously to harvest more energy from fiv it is necessary to promote vibration responses and generate galloping however galloping will not occur in a single smooth cylinder with circular shape because it has a highly symmetric cross section to the flow parkinson 1989 for this reason first a passive turbulence control ptc cylinder is tested for energy harvesting experimental chang et al 2011 and numerical studies ding et al 2015 2016 show that increasing the surface roughness of the smooth cylinder will not only extend the lock in range but also lead to galloping and increase the harnessed power in the high flow speed range second galloping instability may occur in some non circular cylinders because of their asymmetry with respect to the flow therefore an fiv energy converter with different cross sections has been developed and investigated ding et al 2015 barrero gil et al 2010 in addition to the above cases galloping will also occur in a multi cylinder system because of the interaction between the upstream and downstream cylinders when a fiv cylinder is located in the wake of another cylinder the vortex shedding mode and structural response are significantly different from those of an isolated cylinder assi et al 2010 because of the complexity of flow fields and oscillation responses of multiple cylinders studies on this are far scarcer than those on an isolated cylinder sumner 2010 reviewed different flow situations of two cylinders and classified them according to whether the cylinders are staggered arranged in tandem or side by side it was found that regardless of the arrangement the effects of spacings and reynolds numbers on flow field are strong and significant the fiv responses of two tandem cylinders have been measured by experimental tests assi et al 2010 and numerical simulations griffith et al 2017 wang et al 2017 the studies showed that at a small spacing viv would transit into galloping as the flow velocity increased for two cylinders in a side by side arrangement the cylinders interact intensely with each other particularly at a small spacing which causes notably higher amplitudes compared with the single cylinder case huera huarte and gharib 2011 through numerical simulation zhao 2013 2016 investigated the fiv responses of two rigidly coupled cylinders at low reynolds numbers in both side by side and tandem arrangements the results showed that there were considerable differences between rigidly coupled cases and free vibrations and galloping was observed at small gaps regarding energy harvesting of two cylinders by fiv ding et al 2013 successfully simulated two ptc cylinders in tandem arrangement using a two dimensional unsteady reynolds averaged navier stokes urans method the numerical results were well matched with experimental data research on fiv of a multi cylinder system more than two cylinders has broad significance in engineering design and applications however capturing the fiv characteristics of cylinder groups has been a challenging problem that cannot be inferred from the simplified situations of one or two cylinders and existing studies on it are far from sufficient kim and bernitsas 2016 have experimentally tested a group of fiv energy converters in a tandem arrangement in their work experiments with two three and four cylinders with the spacing ratio varying from 2 5 to 5 0 were conducted the results showed that multiple cylinders at proximity could convert more power than the same number of isolated cylinders ding et al 2018 reached a similar conclusion by simulating three in line ptc cylinders chen et al 2018 as well as yu et al 2016 focused on the fiv responses of three cylinders in a tandem pattern at low reynolds numbers the numerical results indicated that the dynamic responses of three cylinders differed from those of two tandem cylinders in addition compared with an isolated cylinder the amplitudes of the three cylinders were increased a group of cylinders can be arranged in a variety of ways an equilateral triangle arrangement with three cylinders is one of the typical configurations this pattern often occurs in ocean engineering such as oil and gas riser pipes strapped together with the legs arranged as a tension leg platform or jack up system however very few studies focus on this field kubo et al 1995 experimentally investigated the vibration responses of 2 4 cylinders in various arrangements in a wind tunnel our previous studies focused on the effects of incidence angles on fiv of three rigidly coupled cylinders in an equilateral triangle arrangement han et al 2018b a it was found that the interference among the cylinders at a small spacing ratio with incidence angle of 0 was much more intense than that of other cases and galloping occurred in this situation causing the maximum amplitude to increase with flow velocity without an upper limit based on the above conclusions we consider the fiv responses of three rigidly coupled cylinders to be beneficial for energy conversion due to their high amplitude therefore in this study numerical simulations are performed to determine the fiv responses and energy harvesting ability of three rigidly coupled cylinders arranged in an equilateral triangular pattern which have not yet been investigated the paper is organized as follows first section 2 presents the design and physical model of the energy converter second in sections 3 and 4 we introduce the mathematical and numerical models for simulating fiv responses and analyzing energy conversion characteristics in section 5 1 the effects of the gap ratio on fiv dynamics and energy harvesting including amplitude and frequency response hydrodynamic characteristics vortex shedding mode energy conversion efficiency and harnessed power are simulated and discussed in detail a suitable arrangement for energy harvesting can therefore be obtained based on the results in section 5 2 to find ways to further improve the energy efficiency a series of numerical tests are conducted at the optimal arrangement with various damping ratios the damping effects are also analyzed in this section finally the main conclusions are summarized 2 physical model fig 1 displays a simplified energy converter which consists of three cylinders springs and a generator the three cylinder oscillator vibrates under the flow and drives the generator using the fluid energy with the rigid connection the individual cylinders form a whole so they vibrate at the same frequency and amplitude the right figure shows the definition of incidence angle α in previous work han et al 2018b we have already investigated incidence angle effects and found that galloping and intense vibration occur in the condition of α 0 to better harvest energy from fiv therefore 0 is selected in this paper the effects of the gap ratio g on energy harvesting and fiv responses are studied here g is defined as g l d where l is the distance between cylinders as shown in fig 1 and d represents the diameter of a single cylinder once the spacing between each cylinder is over 1 d the amplitude of the three cylinder oscillator notably decreases hence we select four groups of gap ratios g 0 01 0 2 0 5 and 1 in addition the energy converter is only allowed to vibrate in the y direction on the one hand this is because the lateral displacement is often much larger than the displacement of the flow direction on the other hand it is more conducive for the transmission mechanism to harvest energy from the vibration with one dof of motion table 1 lists the main parameters of the physical model the mass ratio m m 4 m π ρ d 2 is calculated as the total mass of the three cylinder oscillator m divided by its displaced volume multiplied by the fluid density ρ to further improve the converted efficiency we test different damping ratios ζ in section 5 2 where the minimum damping ratio is 0 013 and the maximum is selected as 0 7 the damping ratio is defined as ζ c 2 m k where c and k represent the total damping coefficient and the stiffness respectively here the terms m c and k are defined per unit length to develop a 2d model galloping usually occurs after viv at high flow speed particularly in the case of hydroelastic oscillations because of the high fluid density parkinson 1989 thus a sufficiently wide range of incoming flow velocity from u 0 1 m s to u 3 m s is analyzed to capture galloping more clearly the corresponding reynolds number r e defined as r e u d l ν therefore varies from 8000 to 240000 here ν is the kinematic viscosity coefficient of the flow and d l represents the characteristic length of the oscillator the reduced velocity u r can also be calculated as between 1 and 30 in this paper u r is defined as u r u f n d l where f n represents the natural frequency of the three cylinders and can be expressed as f n k m 2 π the corresponding structural angular frequency ω s can be obtained by ω s 2 π f n note that i u r is defined based on the structural natural frequency f n as in some numerical studies zhao 2013 cui et al 2015 however in many experimental studies khalak and williamson 1997 williamson and govardhan 2004 it is defined based on the natural frequency in still water f n w a t e r f n w a t e r k m m a 2 π where m a is the added mass and this point will be discussed later in section 4 3 ii for the three rigidly coupled cylinders the characteristic length d l may change as the gap ratio g changes particularly within a small gap range however we use d l d here to define the reynolds number r e and the reduced velocity u r for a better comparison of gap ratio effects as in zhao 2013 iii it can be found that the ratio of r e to u r is a constant of 8000 which means the natural frequency f n in this study stays fixed 3 mathematical model 3 1 equations of the flow at present the flow over the three rigidly coupled cylinders is solved by the two dimensional incompressible form of the unsteady reynolds averaged navier stokes rans equations which include the continuity equation and momentum equation it can be expressed as 1 u i x i 0 u i t u j u i x j 1 ρ p x i ν 2 u i u i u j x j where i represents the direction x represents the cartesian coordinate and t denotes the time here u and p represent the time averaged values of velocity and pressure u i u j is the reynolds stress tensor which can be expressed as 2 u i u j ν t u i x j u j x i 2 3 k δ i j where ν t represents the turbulent viscosity which is given by the turbulence model the turbulent kinetic energy k can be expressed as k u i u i 2 here δ i j is the kronecker delta function in this paper the shear stress transport sst k ω model is selected to solve the turbulent flow because of its apparent advantages of prediction in both adverse pressure and gradient flow this model includes two transport equations from which the k and the specific dissipation rate ω can be obtained the two equations read 3 k t x i k u i x j ν ν t σ k k x j u i u j u j x i β k k ω ω t x i ω u i x j ν ν t σ ω 1 ω x j α s 2 β ω ω 2 2 1 f 1 1 σ ω 2 1 ω k x j ω x j where f 1 and s represent the blending function and strain rate respectively for other constant values and more details see menter 1994 the segregated pressure implicit with splitting of operators piso algorithm is adopted in this paper to solve the momentum and continuity equations together and the implicit first order scheme is employed for the unsteady terms the two transport equations for the turbulent energy k and the dissipation rate ω are solved by a second order upwind scheme for the diffusion terms and the convection terms a second order scheme is used these numerical tools are now widely used ding et al 2015 2013 guilmineau and queutey 2004 han et al 2018b khan et al 2017 and lin and wang 2013 compared different turbulence models in predicting the fiv of a single cylinder the results show that in a relatively long time simulation the two dimensional rans case in conjunction with the sst k ω turbulence model provide a balance of efficiency and accuracy which is credible and reasonable for analyzing the fiv phenomenon a similar method has been used in many published papers zhang et al 2018c ding et al 2015 2016 han et al 2018b guilmineau and queutey 2004 khan et al 2017 pan et al 2007 chae et al 2016 3 2 equations of the motion a typical mass damper oscillator model is introduced here to describe the vibration responses of the three cylinder energy converter the motion in the y direction for the oscillator can be modeled by 4 m a y c a y k a y f y where a y represent the transverse displacement and f y is the resultant force in the y direction acting on the cylinders based on williamson and govardhan 2004 and bernitsas et al 2008 this fluid force f y can be separated into two components viscous force f v i s c o u s and inviscid force f i n v i s c i d here f i n v i s c i d can be considered as the added mass effects we now introduce some dimensionless terms defined as in eq 5 including the structural based timescale t ˆ the dimensionless displacement y and the total lift coefficient c l t o t 5 t ˆ t ω s y a y d c l t o t 2 f y ρ u 2 d substituting the t ˆ y c l damping ratio ζ reduced velocity u r and structural angular frequency ω s into eq 4 gives the dimensionless form of the mck equation which reads 6 y 2 ζ y y c l t o t u r 2 2 π 3 m note that the in eq 6 stands for derivation of dimensionless time t ˆ in this study user defined functions udf written in the c programming language and incorporating the newmark beta algorithm are used to solve the motion equation eq 6 newmark beta an implicit time integration method is widely accepted in the numerical estimation of structural dynamic responses and has been successfully applied in predicting vibration characteristics zhang et al 2018c han et al 2018b deü and matignon 2010 in newmark beta programming by extending the extended mean value theorem to the first and second time derivatives the corresponding lateral displacement y t ˆ velocity y t ˆ and acceleration y t ˆ can be obtained the equations for this algorithm are written as 7 y t ˆ δ t ˆ y t ˆ 1 β n y t ˆ β n y t ˆ δ t ˆ δ t ˆ 8 y t ˆ δ t ˆ y t ˆ y t ˆ δ t ˆ 0 5 α n y t ˆ α n y t ˆ δ t ˆ δ t ˆ 2 where δ t ˆ represents the time step the subscripts represent the variables at different time both parameters α n and β n are constants of which α n is limited to 0 5 because of the requirement of the second order scheme the parameter β n can be set in various values between 0 and 0 5 and in this paper we use β n 0 25 which yields the constant average acceleration method and is known to be a reasonable value deü and matignon 2010 finally using these second order accurate and unconditionally stable parameters α n and β n the motion of the three cylinder oscillator can be solved for more details of this method see the authors previous studies zhang et al 2018c han et al 2018b zhang et al 2018a b 3 3 equations of energy harvesting in one vibration cycle t v i b of the three cylinder energy conversion device the total energy acquired power p e n e r g y can be calculated by 9 p e n e r g y 1 t v i b 0 t v i b f y d a y d t d t 1 t v i b 0 t v i b m d 2 a y d t 2 c d a y d t k a y d a y d t d t based on the numerical simulation method the displacement velocity and acceleration of three rigidly coupled cylinders can be extracted at each time step using the udf program in fact the force terms related to the mass m and stiffness k do not contribute to energy harvesting because they are always out of phase with the velocity thus the only non zero term in eq 9 is produced by the total damping coefficient c and the power p e n e r g y can be rewritten as 10 p e n e r g y 1 t v i b 0 t v i b c d a y d t 2 d t c d a y d t 2 where stands for the time averaged quantities the power p e n e r g y cannot be completely used to generate electricity in engineering applications because there is always the dissipated power p d i s s caused by the transmission mechanism for instance the gear the sliding guide etc thus the effective conversion power p h a r n e s s should be equal to the total conversion power p e n e r g y minus the dissipated power however it is difficult to accurately estimate the corresponding dissipative damping coefficient c d i s s of the system in addition c d i s s does not affect the numerical results it is only related to the data post processing for this reason we use the total damping coefficient and total power to describe the performance of the energy harvesting characteristics as in zhang et al 2018c barrero gil et al 2010 and grouthier et al 2014 furthermore the total power from fluid over the area swept by the three cylinders can be obtained as 11 p f l u i d p k q where p k is the kinetic pressure head and can be calculated by the bernoulli s equation which reads p k ρ u 2 2 here q represents the volumetric flow rate defined as q s f l o w u where s f l o w is the flow area note that i because several gap ratios 0 01 0 2 0 5 and 1 are selected for testing the corresponding flow area therefore varies between 2 01 d 2 2 d 2 5 d and 3 d ii there are in fact several criteria to define p f l u i d see zhang et al 2018a and sun et al 2016 presently we use the same definition for the fluid power as in bernitsas et al 2008 ding et al 2015 and grouthier et al 2014 finally the energy conversion efficiency η can be obtained as the ratio of total energy acquired power p e n e r g y to power available in the fluid p f l u i d 12 η 2 c d a y d t 2 ρ u 3 s f l o w b e t z l i m i t the betz limit which gives the theoretical maximum efficiency that can be extracted from the flow is also considered as in ma et al 2016 and zhang et al 2018c the value of the betz limit is known to be 59 26 16 27 now substituting the terms including t ˆ u r g ζ y and m into eq 12 gives the dimensionless form of the efficiency with a structural based timescale in this paper eq 12 can be directly solved by the compound simpson method 13 η 27 π 4 m ζ y y 2 u r 3 g 2 4 numerical method validation 4 1 computational domain and boundary conditions the effects of gap ratio g and damping ratio ζ are studied in this paper an example of the computational domain for the three cylinder energy converter is plotted in fig 2 the size of which is 45 d 40 d once the ratio w d w represents the width of the computational domain exceeds 10 the effects of the side boundaries on simulation results are negligible zhao et al 2012 therefore the distance from the inlet boundary to the central point of the three cylinder oscillator is 15 d because galloping and high amplitude oscillation will occur in the three cylinder system we set both ranges from the upper and lower boundaries to the centerline at 20 d in addition we split the entire computational domain into seven sub regions consisting of a motion domain 1 that can oscillate up and down a vortex shedding domain 2 for capturing more details of vortices two deformation domains 3 4 for updating the grid using the layering method and three far field domains 5 6 7 the velocity inlet condition is used in the inlet boundary with uniform and steady flow the outflow boundary is applied in the outlet where the gradient of fluid velocity and turbulence in the normal direction of the boundary is zero the surfaces of the cylinders are specified non slip boundaries along which the fluid velocity is the same as the vibrating velocity slip walls on both the upper and lower sides are assigned where the normal velocity component is set to zero the seven sub domains are set as interface boundaries to exchange the flow information at present the whole computational domain is fully filled with quadrilateral cells figs 2 b and 2 c show the grid details of the motion domain where the sizes along the x and y directions of this domain are both 11d the highest velocity gradient exists in this region therefore the grids of the domain 1 are further enhanced with high grid resolution in particular around the near wall areas of the cylinders according to the requirement of the sst k ω model for the near wall mesh the y 1 is used to determine the height of the first layer grid for different reynolds numbers here y is a non dimensional distance from the cylinder s surface to the first mesh node and it needs to be considered in any cfd simulations see schlichting and gersten 2016 when fluid induced vibration occurs the motion domain 1 where a block dynamic mesh technique is used will oscillate along with the three cylinders in a layering manner to ensure the grids at the region are not updated or changed this method can effectively avoid stretching and distortion of the grids furthermore compared with the overlapping grid it can reduce the amount of information exchange additionally to a certain extent this approach can lower the cpu time while ensuring calculation accuracy the procedure of numerical simulations is as follows a start simulation and initialize the flow field velocity pressure etc b solve the unsteady rans equations with the sst k ω turbulence model at time t using the software fluent c extract the flow information for instance the transverse force of the three cylinder oscillator from the previous step b using the udf program d use the newmark β algorithm to solve the mck equation with the current flow information and then output the position information for the next time t δ t e update the mesh with the obtained position and return the new mesh to step b to start another loop of calculation f finally finish the simulation if the required time has been reached 4 2 mesh independence and time step validation the grid resolution will significantly affect the numerical results and computing time so grid sensitivity needs to be examined before starting the calculation at present four groups of grids with different densities are selected to simulate the flow over a fixed three cylinder system at r e 56000 the results are listed in table 2 once the grid exceeds 95000 elements both the root mean square of lift coefficient c l t o t and average drag coefficient c d t o t maintain a good consistency here c d t o t is defined as c d t o t 2 f x ρ u 2 d where f x is the resultant force in the x direction acting on the cylinders considering the computational efficiency against the need for accuracy mesh 3 is used in the following simulations specifically in mesh 3 18 layers of grids with a growth rate of 1 2 are arranged from the surface of each cylinder to cover the boundary area in each layer 360 uniformly distributed nodes are set to determine an appropriate time step to achieve a convergent and accurate solution in a reasonable computational time we predict the fiv of three rigidly coupled cylinders at r e 112 000 and g 0 2 with different time steps from t ˆ 0 007 to 0 7 t 0 001 s to 0 1 s the variations of amplitude y and drag coefficient c d t o t of cylinders under various time steps are compared in figs 3 a and 3 b respectively it can be seen that the differences in both the maximum amplitude and drag coefficient between t ˆ 0 021 and t ˆ 0 007 are negligible thus t ˆ 0 021 that is t 0 003 s is a suitable time step with a balance between solution accuracy and efficiency additionally to better observe the fiv characteristics of the cylinders and capture the limit cycle oscillations we set a sufficient calculation time 50000 time steps 20 iterations step in each case 4 3 model verification the reliability of the numerical method developed in this study needs to be verified prior to the calculations in this section we simulate the fiv of a single cylinder and then compare the results with the published data the main parameters used in this validated simulation are taken from the experiment of which m 2 4 ζ 0 0045 and u r varies from 1 to 16 khalak and williamson 1997 note that the reduced velocity u r used in this section is defined as u r u f n w a t e r d as in the experiment khalak and williamson 1997 as mentioned before f n w a t e r is the natural frequency in still water f n w a t e r k m m a 2 π here the added mass m a can be derived from the potential flow theory which reads m a ρ π d 2 4 blevins 1977 at present the definition of the natural frequency f n f n w a t e r on the reduced velocity is still disputable however the setting does not affect the numerical results and it is only related to the data post processing the comparison of the present results and the published data is plotted in fig 4 where fig 4 a is the amplitude response and fig 4 b is the frequency response besides experimental data khalak and williamson 1997 other numerical results are also graphed in the same figure for comparison including 2d lin and wang 2013 pan et al 2007 and 3d data lucor et al 2005 the maximum dimensionless amplitude d is obtained by averaging the absolute values of peak displacements y in the limit cycle regime the oscillation frequency f o s c is calculated by fast fourier transform fft based on the displacement y it can be seen from fig 4 a basically that the present amplitude curve shows a consistent trend with the published data including an initial branch u r 5 closely followed by upper and lower branches the amplitude increases in the initial branch and gradually disappears after the lower branch in the upper branch high amplitude oscillation occurs however there are some differences in maximum amplitude between the present and published data these are probably due to some different settings between the numerical model and the experiment for instance the initial conditions as well as random behavior of vibrations enhanced by low values of m and ζ guilmineau and queutey 2004 pan et al 2007 in fact as reported by williamson and govardhan 2004 2008 the maximum attainable amplitude in the upper branch is not fully understood other cfd simulations even the 3d approach with zero damping rarely make a complete estimate of the upper branch regarding fig 4 b curve a denotes the natural frequency effects while curve b denotes the effects of the vortex shedding frequency f v or strouhal shedding frequency here f v is defined as f v 2 π s t u d where s t is the strouhal number the two curves describe the characteristics of frequencies when fiv occurs and it can be found that the present model gives reasonable predictions for the frequency response overall the most important features were captured by the proposed model 5 results and discussion 5 1 effects of gap ratio and flow velocity in this section we predict the fiv of the three cylinder energy converter at g 0 01 0 2 0 5 and 1 the effects of g on fiv responses as well as energy conversion characteristics are analyzed 5 1 1 fiv responses fig 5 shows the variations of the dimensionless amplitude with the reduced velocity u r for different gap ratios g of the three cylinder oscillator the amplitude response of a single cylinder is also included in the figure for comparison khalak and williamson 1997 in general the amplitude presents an increasing trend as the g decreases particularly in the high reduced velocity region in addition the vibration of the energy converter is obviously more intense than that of a single cylinder when the gap ratio is 1 the amplitude of the three cylinder energy converter experiences a significant drop around u r 24 and then stabilizes at a low value which is similar to the curve of a single cylinder however in the case of a relatively low gap the vibration amplitude keeps increasing with the growth of flow speed without limit for instance when u r 30 and g 0 01 the amplitude reaches as high as 9 13 d whereas the maximum amplitude of a single cylinder is just approximately 1 d the reason for this phenomenon is that galloping occurs in the three cylinder oscillator at a small gap ratio to further understand the fiv characteristics under a small spacing we classify the different vibration responses into various branches including the initial branch upper branch transition branch galloping branch desynchronized branch and a new branch named the combined branch all of these will be discussed in detail in the subsequent analysis based on the fft method the frequency responses of the energy converter varying with u r at various gap ratios are plotted in fig 5 b here f is defined as f o s c f n where the oscillation frequency f o s c is obtained by the most dominant peak frequency extracted from the displacement spectrum at the gap ratio of 1 lock in can be observed from the frequency response curve in which f o s c always stabilizes near the natural frequency f n as the flow velocity increases the energy converter is outside the lock in area and its vibration frequency is controlled by the vortex shedding frequency f v instead of the natural frequency at this time f o s c at g 1 is almost a linear function of u r which indicates it follows strouhal s law and it is similar to the frequency response of a single cylinder as reported by khalak and williamson 1997 and williamson and govardhan 2004 however at a gap ratio less than 1 the vibration frequency is almost unaffected by the vortex shedding frequency furthermore its effects on oscillation frequency become weaker as the gap decreases in g 0 5 0 2 and 0 01 the oscillation frequencies remain stable at a low value when the flow velocity increases enough with the lowest value occurring in g 0 01 followed by 0 2 and 0 5 in combination with the amplitude responses shown in fig 5 a it can be seen that although the frequency drops to a low value the amplitude continues to increase which indicates that the three cylinder oscillator transitions from viv into galloping more details of this will be discussed later note that in the case of g 0 01 the energy converter exhibits a very low frequency response which is not only out of the control of the vortex shedding frequency but also of the natural frequency the amplitude of the limit cycle for galloping always increases with the flow velocity in contrast to viv the galloping instability can be understood by considering the variations of the instantaneous incidence angle α ˆ parkinson 1989 parkinson and smith 1964 successfully predict the transverse galloping of a square cylinder using the quasi steady theory their model has also been applied successfully in simulating galloping of multiple cylinders and other irregular shapes of cylinders barrero gil et al 2010 charreton et al 2015 according to the quasi steady theory the force related to galloping is mainly determined by the incoming flow reynolds number turbulence intensity etc and the structural shape in this paper the three cylinders are rigidly coupled with small gaps and they have the same vibration amplitude as well as oscillation frequency thus they can be assumed as a single body with a non circular cross section for a given flow the galloping characteristics of the present oscillator therefore only depend on the shape that is the gap ratio g from fig 5 we can conclude that due to galloping or body shape effects lower oscillation frequency and higher amplitude will be generated in the high flow speed range if the spacing between cylinders decreases thus at least for the tested flow velocities in this study a larger body i e a wider g is suggested for the multi cylinder design to avoid high amplitude vibration as this will delay or even suppress the onset of galloping 5 1 2 displacement fluid force and frequency characteristics g 0 01 for each gap ratio we select several flow velocity points based on fig 5 a to further reveal the effects of u r on fiv responses for instance for g 0 01 velocities of u r 3 8 13 and 30 are chosen and the time history curves of instantaneous displacement y at these velocities are plotted in figs 6 a d the total lift coefficient c l t o t is also shown in these figures to estimate the relationship between fluid force and displacement based on the data of y and c l t o t the corresponding frequency spectra are plotted in fig 6 a d using the fft method here a c l t o t and a y represent the amplitude of the frequency spectra for c l t o t and y respectively the values of peak frequencies in the displacement spectra are marked in the figures it can be seen that during the initial branch and the transition process to the lock in area the displacement of the three cylinder oscillator is small and irregular in the corresponding frequency spectrum several peak frequencies with noise can be observed near the main frequency the condition of such energy at multiple peak frequencies leads to irregularity of oscillation when the reduced velocity exceeds 8 the vibration responses become regular and periodic as fig 6 b indicates in the frequency spectrum only one peak frequency occurs in the displacement spectrum whereas multiple obvious peaks can be found in the lift spectrum this suggests that the lift frequency is not significantly in control of the motion of the three cylinder oscillator the energy converter enters the transition region from vortex induced vibration into galloping when the reduced velocity exceeds 12 at this time the displacement curve fluctuates irregularly and phase difference occurs between the lift and displacement curves as the energy converter in the transition branch not only exhibits characteristics of viv but also has the unstable force related to galloping burrs can be found in the frequency curve of fig 6 c with the increase in flow speed finally the entire system enters the fully developed galloping branch when the reduced velocity is more than 20 in this process the vibration displacement increases significantly and regularity is simultaneously restored furthermore it can be found that the lift curve shows multi period fluctuation in one cycle oscillation of the displacement as shown in the frequency spectrum in fig 6 d in the fully developed galloping branch the value of the peak frequency in the displacement spectrum is 0 256 hz and there is an obvious decline compared with 0 568 hz in fig 6 c which is a typical sign of finishing the transition from viv into galloping g 0 2 figs 7 a c show the time history curves of the instantaneous lift coefficient and oscillation displacement in the gap ratio of 0 2 while the frequency spectra are plotted in figs 7 a c when the reduced velocity u r 8 the oscillation frequency locks into natural frequency at g 0 2 the three cylinder energy converter has a wide lock in range which ends when u r 17 as shown in fig 7 a the displacement curve presents sinusoidal fluctuations however the curve of lift coefficient vibrates irregularly and phase difference can be observed in the corresponding frequency spectrum it can be found that multiple peak frequencies in the lift spectrum only produce a single peak frequency in the displacement spectrum for instance in fig 7 a the frequency extracted from displacement keeps fluctuating near the natural frequency although the fluid force is controlled by several frequencies as the flow speed increases when u r 17 the energy converter enters the transition branch from viv into galloping the range within which chaotic vibration occurs and both the displacement and lift coefficient are affected by multiple peak frequencies when u r 19 as shown in figs 7 b and b the vibration responses are strongly controlled by both viv and galloping with the frequency of viv approximately three times that of galloping as a result regular oscillation with several different amplitude periods occurs at this time if the oscillator enters the fully developed galloping branch it recovers to regular vibration in addition as shown in fig 7 c the frequency related to galloping 0 488 hz plays a more dominant role in the displacement spectrum when compared with that frequency 0 275 hz in the transition branch see fig 7 b this is also evidence for the occurrence of fully developed galloping g 0 5 we plot the time history curves of instantaneous total lift coefficient and displacement of the three cylinder energy converter at g 0 5 in figs 8 a c while figs 8 a c give the frequency responses in the initial branch range both the lift and displacement curves fluctuate regularly when u r exceeds 8 as can be seen from figs 8 b and b the lift coefficient fluctuates unstably and its dominant frequency starts to locate at a higher frequency rather than the natural frequency which presents a sign of the beginning of galloping however note that at this time the frequency in the displacement spectrum has been locked into natural frequency and it gradually begins to get out of control by the frequency of the lift oscillation this indicates that viv also exists in the vibration responses as the flow speed increases further on the one hand the lift curve still remains irregular but periodicity can be found in each oscillation cycle in fig 8 c on the other hand the displacement curve fluctuates as a regular sinusoidal function and its oscillation frequency 1 136 hz does not experience a noticeable drop to a lower value when compared with the frequency in fig 8 b therefore the three cylinder energy converter at g 0 5 does not exhibit typical characteristics of fully developed galloping as the growth of reduced velocity and we consider it to enter a new branch the combined branch instead of the transition or galloping branch in the new branch viv and galloping vibrate in coexistence and reach a stable state as shown in fig 8 c the peak frequency in the displacement spectrum is 1 136 hz while the amplitude in the lift spectrum a c l t o t under this frequency is very low which indicates that its control over the displacement spectrum becomes negligible overall we can conclude that during the combined branch the amplitude is higher than that of the upper branch whereas the vibration frequency still locks into natural frequency and shows low correlation with the lift frequency g 1 time history curves of the instantaneous c l t o t and displacement y of the three cylinder energy converter under g 1 are shown in figs 9 a d while the corresponding frequency responses are plotted in figs 9 a d there are some similarities in fiv responses between g 0 5 and g 1 for instance as shown in figs 9 b c when the phase difference between the two curves occurs and the lift fluctuates unsteadily it can be observed that the high frequency occupies a dominant position in the lift spectrum while the primary frequency of the displacement spectrum still fluctuates around the natural frequency at this time from the amplitudes of peak frequencies in figs 9 b and c it can be found that the vibration frequency is out of control from the lift frequency thus we consider galloping to begin to occur in the energy converter and the system vibrates in the form of combination of viv and galloping however with the increase in u r as shown in fig 9 d note that the phase difference becomes stable and is maintained at 180 which means a typical phase shift phenomenon occurs in this situation as the fiv response of a single cylinder lucor et al 2005 furthermore the displacement decreases to a low value and almost disappears regarding corresponding frequency responses as shown in fig 9 d we can see that the frequencies in the lift and displacement spectra are in good agreement and both are strongly controlled by the vortex shedding frequency the above phenomena regardless of vibration response or frequency response present distinct characteristics of a desynchronized branch therefore the three cylinder energy converter in g 1 experiences the initial branch and upper branch firstly and then exhibits characteristics of the combined branch finally the energy converter enters the desynchronized branch where the vibration becomes negligible 5 1 3 vortex structure to better understand the characteristics of the fiv of the three rigidly coupled cylinders we plot the vortex shedding structure for the initial branch at different gap ratios g in fig 10 the vortex shedding structure is studied by observing the instantaneous vorticity contours around the three cylinders in the initial branch the fluid force and the displacement exhibit high consistency and no apparent phase difference can be observed in any gaps this means in each oscillation cycle there are just two vortices shed by bluff bodies and a one shot alternating lift occurs thus typical 2s mode and karman vortex street should be found in the wake and far fields of cylinders however due to the interactions between cylinders and the influence caused by the gap in some cases the vortex shedding mode of the three cylinder oscillator is not exactly the same as the standard 2s mode of a single cylinder for instance at g 0 01 vortices are shed as a similar p mode in the wake of flow and the intensity of the negative vortex is much weaker than that of the positive vortex this is because when the positive vortex is formed from cylinder 3 cylinders 1 and 2 shed their negative vortices at the same time as a result the positive vortex shed by cylinder 3 is swallowed by the negative vortices and then the remaining negative vortices shed together with the previous positive vortices forming a vortex shedding structure similar to p mode in the case of g 1 there is a certain gap allowing each cylinder to shed complete vortices independently as shown in fig 10 d the vortices generated by cylinder 2 will fuse and counteract with those shed by cylinders 1 and 3 leading to two vortex streets that can be observed in flow wake fig 11 shows the vorticity contours along the upper branch with different gap ratios g at present by changing the reduced velocity u r along the upper branch typical 2s 2p and p s modes can be found in the wake structures thus to better observe different vortex shedding modes we do not choose the same u r for different g in g 0 01 the three cylinder oscillator sheds six vortices per oscillation cycle in the near field which is similar to 2t mode however due to the desynchronization of the three cylinders when shedding vortices the two vortices are fused by others in the far field therefore it is in 2p mode for g 0 01 as shown in fig 11 b in g 0 2 the oscillator sheds vortices as a 2p 2s mode where two pairs of vortices are shed at the upper and lower extreme positions a single positive vortex is formed in the rising process of the displacement curve and a single negative vortex is generated in the falling process at g 0 5 the 2s mode can be found this is because although it is in the upper branch the displacement and lift curves still show good consistency in u r 8 when the gap alters to 1 d the vortices generated by cylinders 1 and 3 will strongly impact cylinder 2 in the oscillation process resulting in a complicated vortex structure near the cylinders however an obvious 2p mode can be found in the far field with the increase in flow speed the three cylinder energy converter shows different vibration modes for various gap ratios at u r 28 the three cylinder oscillator with gap ratios of both 0 01 and 0 2 is in a fully developed galloping branch the vortex structure of galloping is significantly different from that of viv as shown in figs 12 a and b a vortex shedding mode of np 2s can be observed in the galloping region which is a similar result to previous studies zhang et al 2018c a more specifically in g 0 01 ten pairs of vortices and two single vortices making 22 vortices in total as a 10p 2s mode are shed by cylinders in one oscillation period whereas there is an 8p 2s vortex shedding mode for g 0 2 to gain a better view of the vortex structure in the galloping branch a simplified vorticity diagram based on vorticity contours is also plotted in fig 13 which includes more details firstly five pair of vortices negative positive are formed in the rising journey and then a single negative vortex is shed at the extreme upper position in another half cycle the same vortex shedding sequence of 5p positive negative s is generated in the falling journey of which a single positive vortex is formed in the lower extreme position as mentioned in section 5 1 2 in g 0 5 viv and galloping reach an equilibrium state and co exist at high u r note that as shown in fig 12 c a new mode of 4p is observed which is differs from that of both viv and the galloping branch a more detailed vortex structure diagram is also plotted fig 14 in which two pairs of opposite vortices are shed per half cycle in addition a video for the vortex pattern has been uploaded online see https youtu be hjw4ysc7lca when the gap is changed to 1d at a high reduced velocity the three cylinder energy converter no longer generates galloping but forms very low amplitude vibration with desynchronization during the desynchronized branch high frequency vortex shedding can be detected 5 1 4 energy conversion characteristics in this section the harnessed power p e n e r g y and efficiency η are used to describe the performance of the three cylinder energy converter although a small damping ratio will not provide enough power we choose the same parameters as in the above simulations to gain a better understanding of the relationship between energy conversion characteristics and fiv responses the harnessed power here is a dimensional term and the corresponding dimensional values of ρ and d are given as 1025 kg m 3 and 0 0889 m respectively as shown in fig 15 in the initial branch both efficiency and power are very low due to the low amplitude and frequency however when the energy converter enters the upper branch it can be found that its energy conversion ability improves significantly the efficiency reaches its maximum and the harnessed power continues to increase in the upper branch more specifically the efficiency peak occurs at u r 9 when the gap ratio is 0 01 followed by 0 2 at u r 7 0 5 at u r 3 and 1 at u r 3 which indicates that the higher gap ratio may be more suitable for energy conversion in the low flow velocity range as u r increases further overall the harnessed power also continues to rise however the fluid energy p f l u i d experiences faster growth than the converted power p e n e r g y leading to a decrease in efficiency with the increase in flow velocity combining the energy characteristics with fiv responses analyzed in figs 5 a and b some phenomena can be observed 1 the harnessed power increases slowly or even undergoes a slight drop in the viv galloping transition region for instance see u r 12 g 0 01 and u r 17 g 0 2 in fig 15 the reason for this phenomenon is the decrease in oscillation frequency during the viv galloping transition process 2 in the high flow speed region compared with viv galloping is more conducive to harvesting energy at present a fully developed galloping branch can be found in g 0 01 and g 0 2 for which the converted power grows significantly and the efficiency mainly remains stable the same phenomenon also occurs in the new branch of g 0 5 where galloping and viv coexist in contrast in g 1 the energy converter enters the desynchronized branch when u r 24 it can be found that the harnessed power decreases dramatically and the conversion efficiency can be ignored this is because of the negligible amplitude response although it has a relatively high frequency 3 galloping is a kind of non self limiting phenomenon as a result there are no upper limits in either the amplitude response or the converted power as the flow speed increases for g 0 01 0 2 and 0 5 this proves that a small gap ratio will harvest more energy for the three cylinder energy converter particularly in the high flow velocity region the average conversion efficiency and average harnessed power are calculated in the caption below fig 15 to determine the most suitable arrangement for energy harvesting from fiv in general g 0 2 is considered the optimal arrangement as it has the highest average efficiency and converted power although its maximum efficiency is lower than that of g 1 and its energy harvesting ability in the galloping branch is slightly weaker than that of g 0 01 5 2 effects of damping ratio according to eqs 12 and 13 the energy conversion efficiency η is highly dependent on the damping ratio ζ in this section the multi cylinder energy converter is tested with different damping ratios to further improve the efficiency to cover the feasible values of practical engineering applications a wide range of damping ratios from 0 013 to 0 7 is selected a value less than 0 013 is of little engineering significance and a higher ζ than 0 7 will significantly suppress the vibration as mentioned before the gap of 0 2 d is considered the optimal arrangement for energy harvesting the reduced velocity here is selected from u r 6 to u r 13 which covers the high energy region as shown in fig 15 fiv responses in the high energy region with different damping ratios are plotted in fig 16 where fig 16 a is the amplitude response d and fig 16 b shows the frequency response f as expected a higher damping ratio will improve the dissipation of energy in the motion process under this circumstance the amplitude decreases with an increase in damping ratio which is consistent with the results found by zhou et al 1999 when the damping ratio ζ is less than 0 5 it can be found that the amplitudes are much more sensitive to the damping however if ζ 0 5 the d and ζ show low correlation as for the frequency response f is not significantly affected by the damping ratio f decreases as the damping ratio increases when ζ 0 5 for ζ 0 5 its effects on frequency response are negligible particularly in the range u r 9 furthermore it can be found that f will experience growth in u r 9 ζ 0 5 which indicates that the lock in phenomenon is delayed for a high damping ratio all the above evidence leads us to conclude that ζ 0 5 is the critical damping ratio for both the amplitude and frequency responses the energy efficiency with the betz limit and the converted power in the high energy region with different damping ratios are plotted in fig 17 we also listed the average data of energy harvesting characteristics and fiv responses in table 3 to better illustrate the damping ratio effects regarding the efficiency the maximum η 46 76 occurs at u r 8 ζ 0 2 followed by u r 7 ζ 0 3 39 83 the effects of damping ratio on energy harvesting are significant for instance both efficiency and power improve significantly with the increase in damping when ζ 0 2 if the damping ratio increases further the curves in figs 17 a and b begin to overlap and intersect which means the sensitivity of energy conversion ability to damping is reduced in addition it can be found that the maximum point of efficiency is located at a later reduced velocity as the damping ratio increases according to table 3 ζ 0 2 represents the highest average efficiency and harnessed power and therefore a suitable parameter for the three cylinder energy converter 6 conclusions this numerical study has discussed the fiv responses and energy harvesting characteristics of a three cylinder energy converter under different gap ratios reduced velocities and damping ratios one of its main contributions is to reveal the fiv responses of the multi cylinder system and to provide a reference for engineering design in addition we aimed to inquire into the possibility of harvesting energy using this novel device as well as finding a suitable arrangement and damping the conclusions can be summarized as follows the effects of gap ratio and reduced velocity on the fiv responses are significant as the of gap between the cylinders decreases the energy converter is prone to generating a higher amplitude and a lower oscillation frequency for g 0 01 and 0 2 viv will transition into galloping and then a fully developed galloping branch appears resulting in high amplitude and low frequency vibration in this situation vortices shed as an np 2s mode in the case of g 0 5 a new branch named combined can be detected after the upper branch in which the oscillator vibrates in combined viv and galloping and reaches a stable state more specifically the amplitude is higher than that of the upper branch whereas the oscillation frequency still locks into the natural frequency and shows low correlation with the lift frequency additionally a new vortex shedding mode of 4p can be found for g 1 the three cylinder oscillator enters the desynchronized branch at high reduced velocity accompanied by the disappearance of galloping and occurrence of phase shift as well as negligible amplitude therefore in consideration of the structural safety a large gap is suggested to avoid high amplitudes and delay or suppress the onset of galloping with a smaller gap the present energy converter exhibits better performance for energy harvesting in the high flow speed region whereas a large gap leads to early occurrence of the maximum efficiency point due to the action of galloping there are no upper limits in either the amplitude or harnessed power for g 0 01 0 2 and 0 5 overall g 0 2 is considered a suitable arrangement for energy conversion from fiv as expected the three cylinder energy converter shows high sensitivity to the damping ratio ζ 0 5 is the critical damping for both the amplitude and frequency responses when the damping ratio is relatively small the harnessed efficiency and power can be dramatically improved by increasing the damping however if ζ exceeds 0 2 it no longer has a significant influence on the energy harvesting ζ 0 2 is considered the optimal parameter for energy harvesting from fiv in all the tests in general the three mechanically coupled cylinders show good performance in energy harvesting from fiv and they have advantages in converting power in the high flow speed region owing to the galloping in future work parameters like roughness and cross section are recommended to be optimized to enhance the conversion efficiency credit authorship contribution statement peng han conceptualization methodology software validation writing original draft guang pan project administration supervision baoshou zhang software validation wei wang data curation visualization wenlong tian writing review editing acknowledgments this work is supported by national natural science foundation of china grant no 51809214 national key research and development program of china grant no 2016yfc0301300 scholarship from china scholarship council csc grant no 201906290110 we are grateful to prof emmanuel de langre from école polytechnique for some useful advice we are grateful to jiaxin zeng in durham university for some advice in english writing 
21707,a machine learning framework based on a multi layer perceptron mlp algorithm was established and applied to wave forecasting in lake michigan the mlp model showed desirable performance in forecasting wave characteristics including significant wave heights and peak wave periods considering both wind and ice cover on wave generation the structure of the mlp regressor was optimized by a cross validated parameter search technique and consisted of two hidden layers with 300 neurons in each hidden layer the mlp model was trained and validated using the wave simulations from a physics based swan wave model for the period 2005 2014 and tested for wave prediction by using noaa buoy data from 2015 sensitivity tests on hyperparameters and regularization techniques were conducted to demonstrate the robustness of the model the mlp model was computationally efficient and capable of predicting characteristic wave conditions with accuracy comparable to that of the swan model it was demonstrated that this machine learning approach could forecast wave conditions in 1 20 000th to 1 10 000th of the computational time necessary to run the physics based model this magnitude of acceleration could enable efficient wave predictions of extremely large scales in time and space keywords lake michigan machine learning multi layer perceptron wave forecasting 1 introduction surface waves are an important hydrodynamic component in coastal and ocean engineering designs a general approach for determining design wave conditions is to estimate high quantiles given certain probabilities of exceedance in the distributions of long term wave data using extreme value analysis or peak over threshold analysis soares and scotto 2007 however these analyses often suffer from a scarcity of data because field observations of characteristic wave conditions e g wave height and period are usually conducted at few buoy stations for a short period of time as such wave hindcasting and forecasting become fundamentally important as they provide engineers and scientists with necessary long term wave information to make planning decisions design coastal structures and assess coastal hazards in addition long term wind wave databases are extremely valuable for assessing changing trends of the ocean wave climate chawla et al 2013 erikson et al 2015 which can be obtained from wave hindcasting and forecasting using reliable wave models wave hindcasting and forecasting essentially predict characteristic wave heights and periods using readily available weather conditions i e wind speed storm duration fetch length and ice cover historically parametric models known as smb methods are developed for wave forecasting these models include a set of empirical formulae that relate wave characteristics to wind conditions and water depth in the generating area they can provide efficient but rough estimates of characteristic wave heights as well as wave periods for structural design purposes goda 2010 the current practice of wave forecasting usually employs a numerical model for the computation of directional wave spectrum the most popular ocean wave models are the third generation spectral wave model wavewatch iii tolman et al 2002 and the nearshore wave spectral model swan booij et al 1999 wavewatch iii incorporates formulations for the deep water wave processes such as wave generation by wind energy dissipation by whitecapping and the quadruplet wave wave interactions and is applicable for deep ocean wave simulations at a global scale on the other hand the swan wave model is focused on wave transformation and deformation in shallow water it incorporates shallow water wave processes such as wave energy dissipation due to bottom friction and breaking triad wave wave interactions and interactions between waves and ambient currents these models were used for wave hindcasting and forecasting in studies including mori et al 2010 chawla et al 2013 erikson et al 2015 kukulka et al 2017 niroomandi et al 2018 and allahdadi et al 2019 to list a few although wave spectral models are capable of accurately simulating wave fields they are computationally expensive the machine learning ml approach was found capable of efficiently mapping large datasets to quantities of interest and have been widely used for forecasting in geosciences lary et al 2016 devries et al 2017 hydrology hong 2008 ahmad et al 2010 rasouli et al 2012 and engineering lee 2006 etemad shahidi and bonakdar 2009 etemad shahidi et al 2011 for wave forecasting due to a lack of large datasets for training ml is used to forecast characteristic wave conditions at a few specific locations deo et al 2001 tsai et al 2002 gunaydin 2008 malekmohamadi et al 2011 recently james et al 2018 developed an ml framework for wave forecasting at a large domain in monterey bay the ml algorithms were trained on a large dataset produced by the physics based wave model swan they found that the ml models yielded wave heights and wave periods consistent with the swan model in addition the ml models could dramatically accelerate wave simulations by more than 4000 times o donncha et al 2018 2019 presented a framework that integrated physics based models with an ml algorithm and combines forecasts from multiple independent models into a single best estimate prediction of wave conditions they showed that the framework which integrated data driven and physics based approaches could outperform either technique in isolation these studies demonstrated that ml is a promising tool for improving wave forecasting at large spatial and temporal scales this paper describes an ml framework based on a multi layer perceptron mlp learning algorithm to hindcast and forecast characteristic wave conditions in lake michigan where wave dynamics are significantly affected by ice coverage during the winter season the mlp algorithm was selected for both wave height and period forecasting which is a nonlinear regression problem that relates wave characteristics to weather conditions the mlp algorithm was trained and validated using data hindcasted from a physics based wave model swan for the period 2005 2014 wave forecasting was performed for the year 2015 to examine the model performance this study shows that the mlp approach can radically accelerate wave hindcasting and forecasting while retaining predictive accuracy comparable to physics based wave modeling the paper is organized as follows section 2 presents the physics based wave modeling and the quality of swan model results the mlp algorithm is introduced in section 3 training and validation of the algorithm as well as its performance on wave forecasting in lake michigan are also presented in this section section 4 discusses the performance of the mlp model on wave prediction considering multiple factors e g length of training dataset hyperparameters and etc the paper is concluded in section 5 2 physics based wave modeling 2 1 swan model to obtain training and validation datasets for supervised mlp wave simulations for lake michigan using the physics based nearshore wave model swan v41 20 were completed swan is a third generation spectral wave model developed at delft university of technology that computes random irregular shore crested wind generated waves in coastal regions and inland waters booij et al 1999 it solves the evolution equation of action density n x t σ θ in space x and time t as well as wave energy distribution over frequencies σ and propagation directions θ the action density is defined as n e σ where e is the wave energy density the evolution of wave action density is governed by komen et al 1994 1 n t x c g u n c σ n σ c θ n θ s tot σ where u is the current velocity vector c g θ k is the group velocity k is the wave number vector c σ and c θ are the propagation velocities in spectral space σ θ respectively s tot accounts for wave energy sources and sinks including wave generation by wind wave decay due to whitecapping bottom friction and depth induced wave breaking and energy redistribution through nonlinear wave wave interactions 2 2 wind data in the swan wave model high quality wind inputs are critically important for wave simulations in this study the wind data climate forecast system reanalysis cfsr saha et al 2010 2014 from the national centers for environmental prediction were employed the cfsr uses a coupled atmosphere ocean land surface sea ice system with advanced data assimilation techniques and an extensive database of meteorological observations to create its products the original cfsr dataset spans from 1979 to 2010 and the second version of the climate forecast system cfsrv2 provides products from 2011 to present with several improvements over cfsr such as a higher spatial resolution saha et al 2014 the temporal resolution of cfsr wind is 6 h withmore detailed information available in saha et al 2010 2014 at each time step the swan modeling system automatically interpolated the cfsr dataset in time and space and interpolates the cfsr wind field of one time snapshot spatially on the swan grid domain for resolving equ 1 the cfsr wind data were also taken into the mlp for data training validation and prediction in the mlp the cfsr wind data were interpolated spatially onto a coarser grid 78 grid resolution and are temporally assembled into one matrix the detailed mlp algorithm is described in section 3 1 fig 1 is the schematic plot that illustrates the technical route of the ml framework in fig 1 a swan model system of lake michigan was set up at first the swan model was driven by the cfsr reanalysis wind fields and incorporated ice coverage information these features along with swan outputs of spatial variables wave characteristics were aggregated into training and validating datasets which were supplied to machine learning models 2 3 ice data wind driven waves in lake michigan can be significantly impacted by ice to include the effect of ice historical ice fields were incorporated into wave simulations by employing a technique that eliminated wave dynamics when ice coverage was higher than a threshold value previous studies implemented threshold values varying from 30 to 50 hubertz et al 1991 bennington et al 2010 anderson et al 2015 in this study a threshold of 30 was selected as suggested by anderson et al 2015 meaning that wave dynamics were not considered and the water depth is manually set to zero when ice coverage exceeded 30 historical ice data for the lake are accessible via noaa great lakes ice atlas and great lakes environmental research laboratory the data have a horizontal resolution of 2 5 km prior to 2007 and are upgraded to a resolution of 1 8 km in 2007 more details regarding the ice datasets are available assel et al 2003 2013 assel 2005 2 4 model configuration and validation wave simulations in lake michigan were performed from 1979 to 2015 the 37 years when wind and ice data are available fig 2 shows the computational domain of the swan model along with the locations of two noaa buoy stations measurements of significant wave height h s and peak wave period t p at these two buoys were used to validate the swan model and the mlp framework the bathymetric data in fig 2 were obtained from the noaa national geophysical data center and interpolated on the computational mesh grid the computational mesh in fig 2 is curvilinear and comprised of 180 40 grid cells and 181 41 grid points including both overwater and overland grid points in all simulations wave energy dissipation mechanisms including whitecapping depth induced wave breaking and bottom friction were activated the spectral domain was discretized into 12 directions and 31 frequency bands to develop reliable training data for the mlp model it is important to demonstrate that swan can accurately replicate wave conditions in lake michigan long term wave measurements at two noaa buoy stations 45002 and 45007 were used for swan model validation spanning the entire 37 years of available data for demonstration the simulated and measured h s and t p at buoy stations 45002 and 45007 were compared in fig 3 to quantify model performance the bias 1 n i 1 n m i s i where m i is the measurement and s i is the simulation the root mean square error rmse and the coefficient of determination r 2 at both buoy stations were evaluated for 2014 as demonstrated in fig 3 the model predicted the h s quite well with r 2 scores above 0 6 and small biases and rmses which are comparable to similar studies e g niroomandi et al 2018 james et al 2018 allahdadi et al 2019 shi et al 2019 kutupoğlu et al 2018 kukulka et al 2017 akpinar et al 2016 the model performance on t p is relatively weak with low r 2 scores considering small temporal variations in t p these scores are reasonable since the correlation coefficient measures the predicted proportion of the variance in the data additionally the biases and rmses of the predicted t p are acceptable e g a bias of 0 006s for 45002 and 0 267s for 45007 when compared to a swan simulation and comparable to similar studies from the aforementioned evaluations it could be argued that the swan model is capable of reasonably simulating temporal variations of h s and t p in addition the swan model has a lower utilization rate of computational resources when compared to a wave resolving model discrepancies between the measurements and modelling results could arise from a variety of systematic errors including measurement instruments modelling systems and wind data for instance some large wave events were underestimated by the swan model this underestimation could possibly be caused by the coarse 6 h temporal resolution of the cfsr wind dataset saha et al 2010 2014 it is likely that certain large wind events are not captured by the data e g li et al 2016 shi et al 2019 allahdadi et al 2019 as a result the wave heights during these events were underestimated additionally the spatial resolution 0 3 for 1979 2010 and 0 2 for 2011 present day would also cause underestimation of local wind waves particularly for locations close to the land boundary previous studies also reported the mismatches in h s and t p even after calibration of the physics based wave models e g allahdadi et al 2019 shi et al 2019 kutupoğlu et al 2018 kukulka et al 2017 akpinar et al 2016 compared to other datasets such as the era intrim reanalysis data from ecmwf cfsr shows better performance in wave modeling at north atlantic and european shelves e g allahdadi et al 2019 kukulka et al 2017 james et al 2018 the distributions of swan simulated yearly averaged h s and t p are shown in figs 7a and 8a which provide global portraits of the wave field over the lake the yearly averaged wave height is generally larger in the northern lake than that in the southern lake and higher in the deep water the yearly averaged t p has low variations with around 4 0 s in most deep water regions the wave period is also longer in the northern lake and shorter in shallow water 2 5 machine learning for wave forecasting the ml approach involves a set of statistical tools and algorithms for data modeling algorithms include linear and logistic regression decision trees and support vector machines boosting multi layer perceptrons etc depending on whether there are targeted outputs ml problems generally fall into two broad categories supervised learning in which the model is presented with inputs and targeted outputs where it learns to map inputs often called features in ml terms to outputs often called labels in ml terms and unsupervised learning where no outputs are given to the learning algorithm and the goal is to find the structure in the inputs supervised ml applications can be further classified into regression problems which have a quantitative response or output and classification problems which typically have a qualitative or categorical response it is obvious that wave forecasting is a supervised regression problem which maps inputs such as wind field and ice coverage to output bulk wave parameters such as h s and t p in this section an ml framework is developed to act as an efficient surrogate for the physics based swan wave model fig 1 the framework is based on the popular python library scikit learn version 0 19 2 several regression algorithms are available in scikit learn including linear regression tree based regressors i e decision tree regressor random forest regressor and an mlp regressor wave forecasting is a nonlinear problem thus linear regression is not appropriate for this application in tree based models the predictor space is first divided into a number of distinct and non overlapping regions for every observation that falls into a certain region a corresponding prediction is made which is simply the mean of the response values for the observation therefore the mlp regressor is selected for the current application 2 6 multi layer perceptron mlp is a supervised learning algorithm that learns a nonlinear function and maps inputs to outputs by training on a dataset given a set of inputs x x 1 x 2 x r and outputs y y 1 y 2 y s where r is the number of inputs and s is the number of outputs the mlp learns a nonlinear function approximator f x y for either classification or regression the mlp consists of three or more layers an input layer an output layer and one or more hidden layers each node in one layer connects with a certain weight to every node in the following layer the inserted box with blue edgecolor on the upper right corner of fig 1 shows the structure of an mlp regressor the input layer consists of a set of neurons with x representing the inputs the rightmost layer is the output layer that receives information from the last hidden layer and transforms it into output values each neuron in the hidden layer accumulates the values from the previous layer as a weighted linear summation with a bias followed by a nonlinear activation function for example the output at the j th node of the first hidden layer is given by 2 out g i 1 r w j i x i b j where g is the nonlinear activation function w j i is the weight and b j is the bias there are various activity functions in the mlp regressor including identity sigmoid tanh and relu this study selected the rectified linear unit relu or so called relu nair and hinton 2010 as the activation function which ensured no negative outputs as tested during calibration relu outperformed the other activity functions due to less training and validating time although the accurate score was not significantly improved 3 g z m a x 0 z the mlp is trained by adjusting connection weights and biases based on the amount of error in the output compared to the expected result encapsulated in the loss function this learning process is carried out through forward and back propagation and solved by the adam optimizer which is an algorithm for optimization of stochastic objective functions proposed by kingma and ba 2014 the method is straightforward to implement and computationally efficient with little memory requirements moreover it is also invariant to diagonal rescaling of the gradients and well suited for problems that are large in terms of data and or parameters the method is also appropriate for non stationary objectives and problems with very noisy and or sparse gradients which makes it suitable for wave forecasting 2 7 data preprocessing input datasets features of the mlp included wind field water depth and ice coverage of the lake area the sources of wind from cfsr bathymetric and ice coverage data were presented in section 2 to improve training and validation efficiency the size of x for the mlp regressor was reduced in the mlp regressor x was assembled by 10 year long wind and ice coverage data from 2005 to 2014 the reconstructed wave condition h s and t p from swan for 2005 2014 were used for training and validating the mlp regressor outputs y fig 1 x u v m where u v stand for the sub matrices of wind component in the cartesian coordinates and m stands for the sub matrix of ice mask which combines ice coverage and bathymetry information x had 14 600 rows the number of rows stand the number of snapshots for the 10 years which is exactly the number the swan timesnap outputs 4 times day x 365 days year x 10 years it was determined that a 10 year dataset is sufficient to create an efficient and an accurate mlp regressor for wave forecasting refer to section 4 to further reduce the size of the input matrix the wind data u w and v w are interpolated into a coarser grid resulting in 78 wet grid points in lake michigan thus the wind vectors are assembled into two sub matrices u and v each one has a size of 14 600 x 78 this treatment could still obtain a good representation of the wind field in lake michigan because the spatial variation of wind was insignificant the ice coverage sub matrix m which determines whether the wave dynamics are taken into account was generated as follows first bathymetric and ice coverage data were interpolated into the swan grid as shown in fig 2 in the mlp the overland grid points are not considered which could dramatically reduce the input dataset size as a result a total of 3893 overwater grid points in lake michigan are considered in fig 1 naming s as the total number of overwater grid points s 7421 second an ice mask matrix was created the size of the resulting ice mask matrix m is 14 600 3 893 given an overwater grid point the mask equals 1 if the ice coverage on the grid point is above 30 the mask is set to 0 thus x had 4049 columns 78 for u 78 for v 3893 for m in practice the input dataset must be preprocessed specifically the wind speeds u w and v w were normalized and scaled using their means and standard deviations the resulting wind inputs have zero means and unit deviations no preprocessing of the ice mask matrix and target vector y is required the preprocessed x and y were randomly shuffled into two subsets training and validation selection of a portion of the matrices of x and y for validation was based on model performance the portion was determined to be 0 2 for the model s best performance refer to section 4 thus the training dataset x 80 is composed of 11 680 rows of x and the validation dataset x 20 is composed of the remaining 2920 rows in this study the wave height and wave period models were constructed and trained separately the wave height model outputs significant wave height h s and the wave period model outputs peak wave period t p following the swan outputs the two bulk parameters are independent of each other physically and by setting up two separate models ensured both h s and t p could obtain better predictions for both models the target vector y has dimensions of 14 600 rows swan model runs and 3893 columns the number of wet grid points where y is composed of either h s or t p accordingly y is divided into two sub matrices y 80 and y 20 the training dataset y 80 has 11 680 rows corresponding to x 80 the mlp algorithm was trained using the training dataset and then applied to the validation dataset to evaluate its performance 2 8 training and validation 2 8 1 significant wave height the constructed mlp regressor for h s was trained using the training dataset as proposed in section 3 1 the stochastic gradient based optimizer adam proposed by kingma and ba 2014 was used after calibration in the following results the parameters of the mlp regressor were optimized by a cross validated grid search over a parameter grid which is implemented by the gridsearchcv function in scikit learn these parameters evaluated by gridsearchcv and their optimized values are concluded in table 1 the number of hidden layers one two or three and the number of neurons in each layer ranging from 100 to 500 in increments of 50 are interrogated results were evaluated by the r 2 score and showed that two layers with 300 neurons per layer produced the best fitting results the sensitivity tests on the important parameters of the mlp regressor are shown in section 4 such as early stopping learning rate size of minibatch stepsize α exponential decay rates for the first and the second momentum estimates β 1 β 2 etc after training the model performance was further evaluated using the validation dataset in this procedure the targeted wave height data in the validation dataset were not used instead they were only used to calculate the error of the predicted h s the x 20 were input into the trained mlp regressor to predict the wave heights for the entire lake michigan fig 4 a shows the cross plot of spatially averaged h s from the swan wave model and the mlp model on the validation dataset over the entire lake clearly the mlp model could reasonably replicate swan simulations the rmse bias and r 2 score are 0 10 m 45 e 04 m and 0 94 respectively fig 4a indicates that the mlp model slightly overestimates wave heights under calm conditions when h s is small yet the current mlp model overall is not over fitted as dots are scattered in line with y x 2 8 2 peak wave period the reconstruction of the t p mlp model is similar to that of the h s mlp model using the gridsearchcv it is determined that two layers with 300 neurons per layer still produced the best validation accuracy the cross plot of spatially averaged t p from the swan wave model and the mlp model for the validation dataset is presented in fig 4b compared to the swan results the mlp model produces slightly higher estimations for small waves 1 s and lower estimations for large waves 6 s further zoom in analysis on a single node shows that swan overestimates t p for long period waves while mlp produces results closer to the observations on average predictions of t p from the mlp model are consistent with those from the swan model as the bias between the two is nearly zero the rmse bias and r 2 score for spatially averaged t p are 0 48 s 0 004 s and 0 75 respectively 2 9 wave forecasting although the mlp models have been tested against characteristic wave conditions in the validation dataset section 3 3 it is important to examine the performance of the model on wave forecasting in this section the constructed mlp models are applied to forecast wave conditions for 2015 the wind and ice coverage data were preprocessed in the same way as detailed in section 3 2 the measurements at two noaa buoy stations and the swan hindcasted wave conditions were used to examine the performance of the mlp models fig 5 shows the comparisons of h s and t p from the mlp model and the swan model to the measurements for year 2015 the measurement data are missing beyond around day 325 for buoy 45002 and day 335 for buoy 45007 the mlp model reasonably predicts the temporal variations of h s observed at both 45002 and 45007 for example the biases between mlp and observations of h s are 0 11 m at 45002 and 0 13 m at 45007 and the biases of t p are 0 17 s at 45002 and 0 18 s at 45007 respectively in addition the performance of the mlp model for wave forecasting is comparable to that of the swan model at both buoys fig 5 the spatially averaged mlp model predictions are also compared with wave forecasting by the swan model for the entire lake the correlations between the spatially averaged mlp model and the swan predictions are presented in fig 6 which indicates that the forecasted wave conditions by the mlp and swan models are closely correlated and fairly similar the bias and r 2 scores between two predictions were 0 014 m and 0 92 for h s and 0 010 s and 0 79 for t p respectively the comparisons of yearly averaged h s and t p from the swan wave model and the mlp model are demonstrated in figs 7 and 8 the predicted yearly averaged h s and t p from the swan and mlp models have similar spatial distributions except that the swan predictions appear more evenly distributed in space the mlp predictions on wave height in the northern and eastern lake are slightly smaller than the swan simulations while wave height predictions by the mlp model are larger in the southern lake the differences between these two model predictions are generally less than 0 1 m in terms of t p the swan predictions are slightly longer in the northern lake near the islands in most deep water regions the differences of the yearly averaged t p between the two models are less than 0 5 s generally the mlp model has better predictions in open deep water and poor predictions in shallow water this is because the mlp model could not capture the wave processes around islands and shoreline in the shallow water such as wave shoaling refraction and diffraction 3 discussions the mlp approach was proved to be a promising tool for wave forecasting in lake michigan as explained in the previous section in this section we present the sensitivity tests on the factors and hyperparameters that are important in the mlp regressor including the length of the input dataset x features the fraction of x necessary for training validation the early stopping option the mini batch size the learning rate and other hyperparameters α β 1 β 2 one challenge to applying such ml approaches to other water bodies is their enormous appetite for data james et al 2018 thus the effect of data length for training and validation on the mlp model was first assessed fig 9 shows the accuracy scores versus data length for the total training and validation data in years the hindcasted dataset from the swan model for the period 2005 2014 was used here and the training and validation dataset are randomly picked from the entire 10 year long dataset for example in fig 9 the 1 year long dataset stands for 1 10 of the 10 year long dataset in these tests the mlp model had the same structure with two hidden layers and 300 neurons in each hidden layer the accuracy score was evaluated by r 2 calculated on the validation dataset which accounts for 20 of the total training and validation data it was shown that if the training and validation data length was less than 6 years the accuracy score fluctuated between 0 79 and 0 81 if the training and validation data length was more than 7 years the accuracy score was improved to between 0 85 and 0 87 therefore a sufficiently long dataset should be needed for training of the mlp model second we assessed the accurate score and computational efficiency with and without early stopping fig 10 the computational efficiency was quantified by the ratio of t total t load t load where t load represents the time for loading data and t total represents the total time for training and validation in the mlp model the computational efficiency increased as the ratio decreased a series of tests were conducted with a set of fractions of x for validation right panel of fig 10 and with varied sizes of mini batch left panel of fig 10 while keeping other parameters fixed for the joint tests on fractions of x for validation fractions were tested at 0 1 0 2 0 3 0 4 and 0 5 while the mini batch size was kept as 200 for the joint test on mini batch sizes the mini batch sizes were 100 200 300 400 and 500 the fraction was set to 0 1 in the joint tests on mini batch sizes for the other parameters activation relu α 0 001 β 1 0 9 β 2 0 999 epsilon 1e 08 hidden layer sizes 300 300 learning rate constant learning rate init 0 001 max iter 400 power t 0 5 random state none shuffle true solver adam tol 0 0001 as shown in fig 10 for both fraction tests and mini batch tests when the early stopping was false the accurate score was larger above 0 85 however the computational efficiency showed no suggestive results judging from the fact that the total time for training and validation are short in the range of 50 90 s it was highly suspected that the processing and memory of the computers cast bigger impacts on the computational time ratio than that caused by the early stopping option in the mlp regressor within the fraction tests when the fraction of x for validation equaled 0 2 the accurate score was the highest although neither the accurate score nor the computational efficiency was very sensitive to the fraction using multi year data in 6 h time resolution for composing x the model was well trained even when the fraction reached 0 5 within the tests on sizes of mini batch it was determined that the accurate score was not sensitive to sizes of mini batch whereas the computational time dropped when the size of the mini batch was over 300 it was found that a mini batch size of 200 produced higher accurate scores third we tested the sensitivity from different learning rates of the mlp regressor on the accurate score and computational efficiency fig 11 there are three options constant adaptive and invscaling the constant is a constant learning rate given by the initial value and adaptive keeps the rating rate constant to the initial value as long as the training loss keeps decreasing the invscaling represents gradually decreasing the learning rate at each time step using an inverse scaling exponent of a certain value defined by power t results show that adaptive and invscaling perform slightly better in terms of a higher accurate score and less computational time however the differences among the results of the three learning rates are not significant as all the accurate scores are above 0 8 and the total training time of the mlp models are within minutes of one another lastly we test the stepsize α and exponential decay rates for momentum estimates β 1 β 2 of the mlp regressor on the models performance figs 11 and 12 following kingma and ba 2014 we set α 0 1 0 01 0 001 0 0001 and 0 00001 β 1 0 0 5 and 0 9 β 2 0 99 0 999 and 0 9999 the accurate score is sensitive to α as α decreases the accurate score increases when α is larger than 0 01 the accurate score drops greatly below 0 8 and the computational time drops as well with small β 1 values the accurate score could also be affected it is found that models with α 0 01 and β 1 0 9 give higher accurate scores above 0 85 the modeling results are not sensitive to β 2 as long as β 2 0 99 1 except for the intense data requirement and multiple hyperparameters for calibration the mlp model is found superior to a physics based wave model on wave forecasting in a number of ways first with the trained mlp model wave forecasting can be greatly accelerated for example wave forecasting of h s and t p in year 2015 using the mlp model took less than 1 s on a mac desktop with one single processor while the physics based swan model took about 4 5 h with the same outputs on an equivalent number of processors in an hpc cluster the mlp model could forecast wave conditions in a fraction of the time 1 10 000th to 1 20 000th to run the physics based swan model with the trained mlp model massive wave calculations across extremely large spatial and temporal scales could be done in a matter of minutes second the mlp model is easy to use for future wave simulations to run forward predictions using the trained mlp model only the matrices of weights biases and activation functions are required devries et al 2017 which can be saved in a small data file with fewer than 20 lines of python script and a small data file time dependent wave prediction at any location and time in lake michigan can be performed on any computer or device it is possible to integrate the trained lake michigan mlp model into an app for use in a smart phone 4 conclusions a machine learning framework based on an mlp regressor was established for wave forecasting in lake michigan a systematic analysis on the performance of the mlp regressor for a long term wave characteristics hindcast forecast was conducted in this study different to previous work focusing on ocean wave conditions the present study utilized the ml tool in a lacustrine environment and ice cover was for the first time considered in the application of an mlp regressor on wind generated wave modeling in an enclosed and deep lake the ml tool used wind field and ice coverage as inputs features in ml terms and output wave characteristics labels in ml terms including significant wave height and peak wave period in the entire lake the model was trained using the simulated h s and t p data from a physics based swan wave model for the period 2005 2014 the trained mlp model was computationally efficient and capable of predicting characteristic wave conditions h s and t p with accuracy comparable to that of the swan wave model in the validation dataset wave forecasting in 2015 showed that the correlations between the mlp model and the swan model were 0 92 for h s and 0 79 for t p respectively this study also showed that the mlp regressor had the ability to model wave period e g t p with results comparable to swan modelling this study provided guidance for wave forecast hindcast in high latitudes utilizing an mlp regressor sensitivity tests on hyperparameters and regularization techniques were performed for the development and validation of the mlp model the robustness of the mlp model was extensively demonstrated and a suggestive table for selection of the mlp model parameters was provided the adam solver was suggested for case studies with intense data similar to the work presented in this paper once the training and validation dataset is sufficiently long 7 years the mlp model was quite robust in terms of prediction accuracy for 1 year forecasting results showed that learning rate set as adaptive and invscaling performed slightly better in terms of higher accuracy scores and computational efficiency than when set as constant it was suggested that activity function be set as relu for faster computation the option early stopping in certain circumstances could save computational time when set to true but it was determined that higher accuracy scores were achieved when it was set to false it was also shown that the mlp regressor gave higher prediction scores above 0 85 with mini batch 200 stepsize 0 01 and an exponential decay rate for the first momentum 0 9 along with an exponential decay rate for the second momentum within the range of 0 99 1 the trained mlp model could act as an efficient wave forecasting system for lake michigan wave forecasting of characteristic wave conditions for one year took less than 1 s using the mlp model by comparing the computational efficiency of the mlp model and the swan model for wave forecasting it was determined that the computational time of the trained mlp model is a fraction 1 20 000th to 1 10 000th of that of the physics based wave model swan credit authorship contribution statement xi feng writing original draft conceptualization visualization investigation gangfeng ma methodology software supervision shih feng su conceptualization methodology chenfu huang data curation maura k boswell writing review editing pengfei xue writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to give our acknowledgement to the national natural science foundation of china no 51709091 the natural science foundation of jiangsu province no bk20170874 and the fundamental research funds for the central universities no 2017b005 for the funding support this work was also supported by the michigan sea grant college program project number r cglh 7 under na18oar4170102 from noaa national sea grant u s department of commerce and funds from the state of michigan this is contribution no 73 of the great lakes research center at michigan tech 
21707,a machine learning framework based on a multi layer perceptron mlp algorithm was established and applied to wave forecasting in lake michigan the mlp model showed desirable performance in forecasting wave characteristics including significant wave heights and peak wave periods considering both wind and ice cover on wave generation the structure of the mlp regressor was optimized by a cross validated parameter search technique and consisted of two hidden layers with 300 neurons in each hidden layer the mlp model was trained and validated using the wave simulations from a physics based swan wave model for the period 2005 2014 and tested for wave prediction by using noaa buoy data from 2015 sensitivity tests on hyperparameters and regularization techniques were conducted to demonstrate the robustness of the model the mlp model was computationally efficient and capable of predicting characteristic wave conditions with accuracy comparable to that of the swan model it was demonstrated that this machine learning approach could forecast wave conditions in 1 20 000th to 1 10 000th of the computational time necessary to run the physics based model this magnitude of acceleration could enable efficient wave predictions of extremely large scales in time and space keywords lake michigan machine learning multi layer perceptron wave forecasting 1 introduction surface waves are an important hydrodynamic component in coastal and ocean engineering designs a general approach for determining design wave conditions is to estimate high quantiles given certain probabilities of exceedance in the distributions of long term wave data using extreme value analysis or peak over threshold analysis soares and scotto 2007 however these analyses often suffer from a scarcity of data because field observations of characteristic wave conditions e g wave height and period are usually conducted at few buoy stations for a short period of time as such wave hindcasting and forecasting become fundamentally important as they provide engineers and scientists with necessary long term wave information to make planning decisions design coastal structures and assess coastal hazards in addition long term wind wave databases are extremely valuable for assessing changing trends of the ocean wave climate chawla et al 2013 erikson et al 2015 which can be obtained from wave hindcasting and forecasting using reliable wave models wave hindcasting and forecasting essentially predict characteristic wave heights and periods using readily available weather conditions i e wind speed storm duration fetch length and ice cover historically parametric models known as smb methods are developed for wave forecasting these models include a set of empirical formulae that relate wave characteristics to wind conditions and water depth in the generating area they can provide efficient but rough estimates of characteristic wave heights as well as wave periods for structural design purposes goda 2010 the current practice of wave forecasting usually employs a numerical model for the computation of directional wave spectrum the most popular ocean wave models are the third generation spectral wave model wavewatch iii tolman et al 2002 and the nearshore wave spectral model swan booij et al 1999 wavewatch iii incorporates formulations for the deep water wave processes such as wave generation by wind energy dissipation by whitecapping and the quadruplet wave wave interactions and is applicable for deep ocean wave simulations at a global scale on the other hand the swan wave model is focused on wave transformation and deformation in shallow water it incorporates shallow water wave processes such as wave energy dissipation due to bottom friction and breaking triad wave wave interactions and interactions between waves and ambient currents these models were used for wave hindcasting and forecasting in studies including mori et al 2010 chawla et al 2013 erikson et al 2015 kukulka et al 2017 niroomandi et al 2018 and allahdadi et al 2019 to list a few although wave spectral models are capable of accurately simulating wave fields they are computationally expensive the machine learning ml approach was found capable of efficiently mapping large datasets to quantities of interest and have been widely used for forecasting in geosciences lary et al 2016 devries et al 2017 hydrology hong 2008 ahmad et al 2010 rasouli et al 2012 and engineering lee 2006 etemad shahidi and bonakdar 2009 etemad shahidi et al 2011 for wave forecasting due to a lack of large datasets for training ml is used to forecast characteristic wave conditions at a few specific locations deo et al 2001 tsai et al 2002 gunaydin 2008 malekmohamadi et al 2011 recently james et al 2018 developed an ml framework for wave forecasting at a large domain in monterey bay the ml algorithms were trained on a large dataset produced by the physics based wave model swan they found that the ml models yielded wave heights and wave periods consistent with the swan model in addition the ml models could dramatically accelerate wave simulations by more than 4000 times o donncha et al 2018 2019 presented a framework that integrated physics based models with an ml algorithm and combines forecasts from multiple independent models into a single best estimate prediction of wave conditions they showed that the framework which integrated data driven and physics based approaches could outperform either technique in isolation these studies demonstrated that ml is a promising tool for improving wave forecasting at large spatial and temporal scales this paper describes an ml framework based on a multi layer perceptron mlp learning algorithm to hindcast and forecast characteristic wave conditions in lake michigan where wave dynamics are significantly affected by ice coverage during the winter season the mlp algorithm was selected for both wave height and period forecasting which is a nonlinear regression problem that relates wave characteristics to weather conditions the mlp algorithm was trained and validated using data hindcasted from a physics based wave model swan for the period 2005 2014 wave forecasting was performed for the year 2015 to examine the model performance this study shows that the mlp approach can radically accelerate wave hindcasting and forecasting while retaining predictive accuracy comparable to physics based wave modeling the paper is organized as follows section 2 presents the physics based wave modeling and the quality of swan model results the mlp algorithm is introduced in section 3 training and validation of the algorithm as well as its performance on wave forecasting in lake michigan are also presented in this section section 4 discusses the performance of the mlp model on wave prediction considering multiple factors e g length of training dataset hyperparameters and etc the paper is concluded in section 5 2 physics based wave modeling 2 1 swan model to obtain training and validation datasets for supervised mlp wave simulations for lake michigan using the physics based nearshore wave model swan v41 20 were completed swan is a third generation spectral wave model developed at delft university of technology that computes random irregular shore crested wind generated waves in coastal regions and inland waters booij et al 1999 it solves the evolution equation of action density n x t σ θ in space x and time t as well as wave energy distribution over frequencies σ and propagation directions θ the action density is defined as n e σ where e is the wave energy density the evolution of wave action density is governed by komen et al 1994 1 n t x c g u n c σ n σ c θ n θ s tot σ where u is the current velocity vector c g θ k is the group velocity k is the wave number vector c σ and c θ are the propagation velocities in spectral space σ θ respectively s tot accounts for wave energy sources and sinks including wave generation by wind wave decay due to whitecapping bottom friction and depth induced wave breaking and energy redistribution through nonlinear wave wave interactions 2 2 wind data in the swan wave model high quality wind inputs are critically important for wave simulations in this study the wind data climate forecast system reanalysis cfsr saha et al 2010 2014 from the national centers for environmental prediction were employed the cfsr uses a coupled atmosphere ocean land surface sea ice system with advanced data assimilation techniques and an extensive database of meteorological observations to create its products the original cfsr dataset spans from 1979 to 2010 and the second version of the climate forecast system cfsrv2 provides products from 2011 to present with several improvements over cfsr such as a higher spatial resolution saha et al 2014 the temporal resolution of cfsr wind is 6 h withmore detailed information available in saha et al 2010 2014 at each time step the swan modeling system automatically interpolated the cfsr dataset in time and space and interpolates the cfsr wind field of one time snapshot spatially on the swan grid domain for resolving equ 1 the cfsr wind data were also taken into the mlp for data training validation and prediction in the mlp the cfsr wind data were interpolated spatially onto a coarser grid 78 grid resolution and are temporally assembled into one matrix the detailed mlp algorithm is described in section 3 1 fig 1 is the schematic plot that illustrates the technical route of the ml framework in fig 1 a swan model system of lake michigan was set up at first the swan model was driven by the cfsr reanalysis wind fields and incorporated ice coverage information these features along with swan outputs of spatial variables wave characteristics were aggregated into training and validating datasets which were supplied to machine learning models 2 3 ice data wind driven waves in lake michigan can be significantly impacted by ice to include the effect of ice historical ice fields were incorporated into wave simulations by employing a technique that eliminated wave dynamics when ice coverage was higher than a threshold value previous studies implemented threshold values varying from 30 to 50 hubertz et al 1991 bennington et al 2010 anderson et al 2015 in this study a threshold of 30 was selected as suggested by anderson et al 2015 meaning that wave dynamics were not considered and the water depth is manually set to zero when ice coverage exceeded 30 historical ice data for the lake are accessible via noaa great lakes ice atlas and great lakes environmental research laboratory the data have a horizontal resolution of 2 5 km prior to 2007 and are upgraded to a resolution of 1 8 km in 2007 more details regarding the ice datasets are available assel et al 2003 2013 assel 2005 2 4 model configuration and validation wave simulations in lake michigan were performed from 1979 to 2015 the 37 years when wind and ice data are available fig 2 shows the computational domain of the swan model along with the locations of two noaa buoy stations measurements of significant wave height h s and peak wave period t p at these two buoys were used to validate the swan model and the mlp framework the bathymetric data in fig 2 were obtained from the noaa national geophysical data center and interpolated on the computational mesh grid the computational mesh in fig 2 is curvilinear and comprised of 180 40 grid cells and 181 41 grid points including both overwater and overland grid points in all simulations wave energy dissipation mechanisms including whitecapping depth induced wave breaking and bottom friction were activated the spectral domain was discretized into 12 directions and 31 frequency bands to develop reliable training data for the mlp model it is important to demonstrate that swan can accurately replicate wave conditions in lake michigan long term wave measurements at two noaa buoy stations 45002 and 45007 were used for swan model validation spanning the entire 37 years of available data for demonstration the simulated and measured h s and t p at buoy stations 45002 and 45007 were compared in fig 3 to quantify model performance the bias 1 n i 1 n m i s i where m i is the measurement and s i is the simulation the root mean square error rmse and the coefficient of determination r 2 at both buoy stations were evaluated for 2014 as demonstrated in fig 3 the model predicted the h s quite well with r 2 scores above 0 6 and small biases and rmses which are comparable to similar studies e g niroomandi et al 2018 james et al 2018 allahdadi et al 2019 shi et al 2019 kutupoğlu et al 2018 kukulka et al 2017 akpinar et al 2016 the model performance on t p is relatively weak with low r 2 scores considering small temporal variations in t p these scores are reasonable since the correlation coefficient measures the predicted proportion of the variance in the data additionally the biases and rmses of the predicted t p are acceptable e g a bias of 0 006s for 45002 and 0 267s for 45007 when compared to a swan simulation and comparable to similar studies from the aforementioned evaluations it could be argued that the swan model is capable of reasonably simulating temporal variations of h s and t p in addition the swan model has a lower utilization rate of computational resources when compared to a wave resolving model discrepancies between the measurements and modelling results could arise from a variety of systematic errors including measurement instruments modelling systems and wind data for instance some large wave events were underestimated by the swan model this underestimation could possibly be caused by the coarse 6 h temporal resolution of the cfsr wind dataset saha et al 2010 2014 it is likely that certain large wind events are not captured by the data e g li et al 2016 shi et al 2019 allahdadi et al 2019 as a result the wave heights during these events were underestimated additionally the spatial resolution 0 3 for 1979 2010 and 0 2 for 2011 present day would also cause underestimation of local wind waves particularly for locations close to the land boundary previous studies also reported the mismatches in h s and t p even after calibration of the physics based wave models e g allahdadi et al 2019 shi et al 2019 kutupoğlu et al 2018 kukulka et al 2017 akpinar et al 2016 compared to other datasets such as the era intrim reanalysis data from ecmwf cfsr shows better performance in wave modeling at north atlantic and european shelves e g allahdadi et al 2019 kukulka et al 2017 james et al 2018 the distributions of swan simulated yearly averaged h s and t p are shown in figs 7a and 8a which provide global portraits of the wave field over the lake the yearly averaged wave height is generally larger in the northern lake than that in the southern lake and higher in the deep water the yearly averaged t p has low variations with around 4 0 s in most deep water regions the wave period is also longer in the northern lake and shorter in shallow water 2 5 machine learning for wave forecasting the ml approach involves a set of statistical tools and algorithms for data modeling algorithms include linear and logistic regression decision trees and support vector machines boosting multi layer perceptrons etc depending on whether there are targeted outputs ml problems generally fall into two broad categories supervised learning in which the model is presented with inputs and targeted outputs where it learns to map inputs often called features in ml terms to outputs often called labels in ml terms and unsupervised learning where no outputs are given to the learning algorithm and the goal is to find the structure in the inputs supervised ml applications can be further classified into regression problems which have a quantitative response or output and classification problems which typically have a qualitative or categorical response it is obvious that wave forecasting is a supervised regression problem which maps inputs such as wind field and ice coverage to output bulk wave parameters such as h s and t p in this section an ml framework is developed to act as an efficient surrogate for the physics based swan wave model fig 1 the framework is based on the popular python library scikit learn version 0 19 2 several regression algorithms are available in scikit learn including linear regression tree based regressors i e decision tree regressor random forest regressor and an mlp regressor wave forecasting is a nonlinear problem thus linear regression is not appropriate for this application in tree based models the predictor space is first divided into a number of distinct and non overlapping regions for every observation that falls into a certain region a corresponding prediction is made which is simply the mean of the response values for the observation therefore the mlp regressor is selected for the current application 2 6 multi layer perceptron mlp is a supervised learning algorithm that learns a nonlinear function and maps inputs to outputs by training on a dataset given a set of inputs x x 1 x 2 x r and outputs y y 1 y 2 y s where r is the number of inputs and s is the number of outputs the mlp learns a nonlinear function approximator f x y for either classification or regression the mlp consists of three or more layers an input layer an output layer and one or more hidden layers each node in one layer connects with a certain weight to every node in the following layer the inserted box with blue edgecolor on the upper right corner of fig 1 shows the structure of an mlp regressor the input layer consists of a set of neurons with x representing the inputs the rightmost layer is the output layer that receives information from the last hidden layer and transforms it into output values each neuron in the hidden layer accumulates the values from the previous layer as a weighted linear summation with a bias followed by a nonlinear activation function for example the output at the j th node of the first hidden layer is given by 2 out g i 1 r w j i x i b j where g is the nonlinear activation function w j i is the weight and b j is the bias there are various activity functions in the mlp regressor including identity sigmoid tanh and relu this study selected the rectified linear unit relu or so called relu nair and hinton 2010 as the activation function which ensured no negative outputs as tested during calibration relu outperformed the other activity functions due to less training and validating time although the accurate score was not significantly improved 3 g z m a x 0 z the mlp is trained by adjusting connection weights and biases based on the amount of error in the output compared to the expected result encapsulated in the loss function this learning process is carried out through forward and back propagation and solved by the adam optimizer which is an algorithm for optimization of stochastic objective functions proposed by kingma and ba 2014 the method is straightforward to implement and computationally efficient with little memory requirements moreover it is also invariant to diagonal rescaling of the gradients and well suited for problems that are large in terms of data and or parameters the method is also appropriate for non stationary objectives and problems with very noisy and or sparse gradients which makes it suitable for wave forecasting 2 7 data preprocessing input datasets features of the mlp included wind field water depth and ice coverage of the lake area the sources of wind from cfsr bathymetric and ice coverage data were presented in section 2 to improve training and validation efficiency the size of x for the mlp regressor was reduced in the mlp regressor x was assembled by 10 year long wind and ice coverage data from 2005 to 2014 the reconstructed wave condition h s and t p from swan for 2005 2014 were used for training and validating the mlp regressor outputs y fig 1 x u v m where u v stand for the sub matrices of wind component in the cartesian coordinates and m stands for the sub matrix of ice mask which combines ice coverage and bathymetry information x had 14 600 rows the number of rows stand the number of snapshots for the 10 years which is exactly the number the swan timesnap outputs 4 times day x 365 days year x 10 years it was determined that a 10 year dataset is sufficient to create an efficient and an accurate mlp regressor for wave forecasting refer to section 4 to further reduce the size of the input matrix the wind data u w and v w are interpolated into a coarser grid resulting in 78 wet grid points in lake michigan thus the wind vectors are assembled into two sub matrices u and v each one has a size of 14 600 x 78 this treatment could still obtain a good representation of the wind field in lake michigan because the spatial variation of wind was insignificant the ice coverage sub matrix m which determines whether the wave dynamics are taken into account was generated as follows first bathymetric and ice coverage data were interpolated into the swan grid as shown in fig 2 in the mlp the overland grid points are not considered which could dramatically reduce the input dataset size as a result a total of 3893 overwater grid points in lake michigan are considered in fig 1 naming s as the total number of overwater grid points s 7421 second an ice mask matrix was created the size of the resulting ice mask matrix m is 14 600 3 893 given an overwater grid point the mask equals 1 if the ice coverage on the grid point is above 30 the mask is set to 0 thus x had 4049 columns 78 for u 78 for v 3893 for m in practice the input dataset must be preprocessed specifically the wind speeds u w and v w were normalized and scaled using their means and standard deviations the resulting wind inputs have zero means and unit deviations no preprocessing of the ice mask matrix and target vector y is required the preprocessed x and y were randomly shuffled into two subsets training and validation selection of a portion of the matrices of x and y for validation was based on model performance the portion was determined to be 0 2 for the model s best performance refer to section 4 thus the training dataset x 80 is composed of 11 680 rows of x and the validation dataset x 20 is composed of the remaining 2920 rows in this study the wave height and wave period models were constructed and trained separately the wave height model outputs significant wave height h s and the wave period model outputs peak wave period t p following the swan outputs the two bulk parameters are independent of each other physically and by setting up two separate models ensured both h s and t p could obtain better predictions for both models the target vector y has dimensions of 14 600 rows swan model runs and 3893 columns the number of wet grid points where y is composed of either h s or t p accordingly y is divided into two sub matrices y 80 and y 20 the training dataset y 80 has 11 680 rows corresponding to x 80 the mlp algorithm was trained using the training dataset and then applied to the validation dataset to evaluate its performance 2 8 training and validation 2 8 1 significant wave height the constructed mlp regressor for h s was trained using the training dataset as proposed in section 3 1 the stochastic gradient based optimizer adam proposed by kingma and ba 2014 was used after calibration in the following results the parameters of the mlp regressor were optimized by a cross validated grid search over a parameter grid which is implemented by the gridsearchcv function in scikit learn these parameters evaluated by gridsearchcv and their optimized values are concluded in table 1 the number of hidden layers one two or three and the number of neurons in each layer ranging from 100 to 500 in increments of 50 are interrogated results were evaluated by the r 2 score and showed that two layers with 300 neurons per layer produced the best fitting results the sensitivity tests on the important parameters of the mlp regressor are shown in section 4 such as early stopping learning rate size of minibatch stepsize α exponential decay rates for the first and the second momentum estimates β 1 β 2 etc after training the model performance was further evaluated using the validation dataset in this procedure the targeted wave height data in the validation dataset were not used instead they were only used to calculate the error of the predicted h s the x 20 were input into the trained mlp regressor to predict the wave heights for the entire lake michigan fig 4 a shows the cross plot of spatially averaged h s from the swan wave model and the mlp model on the validation dataset over the entire lake clearly the mlp model could reasonably replicate swan simulations the rmse bias and r 2 score are 0 10 m 45 e 04 m and 0 94 respectively fig 4a indicates that the mlp model slightly overestimates wave heights under calm conditions when h s is small yet the current mlp model overall is not over fitted as dots are scattered in line with y x 2 8 2 peak wave period the reconstruction of the t p mlp model is similar to that of the h s mlp model using the gridsearchcv it is determined that two layers with 300 neurons per layer still produced the best validation accuracy the cross plot of spatially averaged t p from the swan wave model and the mlp model for the validation dataset is presented in fig 4b compared to the swan results the mlp model produces slightly higher estimations for small waves 1 s and lower estimations for large waves 6 s further zoom in analysis on a single node shows that swan overestimates t p for long period waves while mlp produces results closer to the observations on average predictions of t p from the mlp model are consistent with those from the swan model as the bias between the two is nearly zero the rmse bias and r 2 score for spatially averaged t p are 0 48 s 0 004 s and 0 75 respectively 2 9 wave forecasting although the mlp models have been tested against characteristic wave conditions in the validation dataset section 3 3 it is important to examine the performance of the model on wave forecasting in this section the constructed mlp models are applied to forecast wave conditions for 2015 the wind and ice coverage data were preprocessed in the same way as detailed in section 3 2 the measurements at two noaa buoy stations and the swan hindcasted wave conditions were used to examine the performance of the mlp models fig 5 shows the comparisons of h s and t p from the mlp model and the swan model to the measurements for year 2015 the measurement data are missing beyond around day 325 for buoy 45002 and day 335 for buoy 45007 the mlp model reasonably predicts the temporal variations of h s observed at both 45002 and 45007 for example the biases between mlp and observations of h s are 0 11 m at 45002 and 0 13 m at 45007 and the biases of t p are 0 17 s at 45002 and 0 18 s at 45007 respectively in addition the performance of the mlp model for wave forecasting is comparable to that of the swan model at both buoys fig 5 the spatially averaged mlp model predictions are also compared with wave forecasting by the swan model for the entire lake the correlations between the spatially averaged mlp model and the swan predictions are presented in fig 6 which indicates that the forecasted wave conditions by the mlp and swan models are closely correlated and fairly similar the bias and r 2 scores between two predictions were 0 014 m and 0 92 for h s and 0 010 s and 0 79 for t p respectively the comparisons of yearly averaged h s and t p from the swan wave model and the mlp model are demonstrated in figs 7 and 8 the predicted yearly averaged h s and t p from the swan and mlp models have similar spatial distributions except that the swan predictions appear more evenly distributed in space the mlp predictions on wave height in the northern and eastern lake are slightly smaller than the swan simulations while wave height predictions by the mlp model are larger in the southern lake the differences between these two model predictions are generally less than 0 1 m in terms of t p the swan predictions are slightly longer in the northern lake near the islands in most deep water regions the differences of the yearly averaged t p between the two models are less than 0 5 s generally the mlp model has better predictions in open deep water and poor predictions in shallow water this is because the mlp model could not capture the wave processes around islands and shoreline in the shallow water such as wave shoaling refraction and diffraction 3 discussions the mlp approach was proved to be a promising tool for wave forecasting in lake michigan as explained in the previous section in this section we present the sensitivity tests on the factors and hyperparameters that are important in the mlp regressor including the length of the input dataset x features the fraction of x necessary for training validation the early stopping option the mini batch size the learning rate and other hyperparameters α β 1 β 2 one challenge to applying such ml approaches to other water bodies is their enormous appetite for data james et al 2018 thus the effect of data length for training and validation on the mlp model was first assessed fig 9 shows the accuracy scores versus data length for the total training and validation data in years the hindcasted dataset from the swan model for the period 2005 2014 was used here and the training and validation dataset are randomly picked from the entire 10 year long dataset for example in fig 9 the 1 year long dataset stands for 1 10 of the 10 year long dataset in these tests the mlp model had the same structure with two hidden layers and 300 neurons in each hidden layer the accuracy score was evaluated by r 2 calculated on the validation dataset which accounts for 20 of the total training and validation data it was shown that if the training and validation data length was less than 6 years the accuracy score fluctuated between 0 79 and 0 81 if the training and validation data length was more than 7 years the accuracy score was improved to between 0 85 and 0 87 therefore a sufficiently long dataset should be needed for training of the mlp model second we assessed the accurate score and computational efficiency with and without early stopping fig 10 the computational efficiency was quantified by the ratio of t total t load t load where t load represents the time for loading data and t total represents the total time for training and validation in the mlp model the computational efficiency increased as the ratio decreased a series of tests were conducted with a set of fractions of x for validation right panel of fig 10 and with varied sizes of mini batch left panel of fig 10 while keeping other parameters fixed for the joint tests on fractions of x for validation fractions were tested at 0 1 0 2 0 3 0 4 and 0 5 while the mini batch size was kept as 200 for the joint test on mini batch sizes the mini batch sizes were 100 200 300 400 and 500 the fraction was set to 0 1 in the joint tests on mini batch sizes for the other parameters activation relu α 0 001 β 1 0 9 β 2 0 999 epsilon 1e 08 hidden layer sizes 300 300 learning rate constant learning rate init 0 001 max iter 400 power t 0 5 random state none shuffle true solver adam tol 0 0001 as shown in fig 10 for both fraction tests and mini batch tests when the early stopping was false the accurate score was larger above 0 85 however the computational efficiency showed no suggestive results judging from the fact that the total time for training and validation are short in the range of 50 90 s it was highly suspected that the processing and memory of the computers cast bigger impacts on the computational time ratio than that caused by the early stopping option in the mlp regressor within the fraction tests when the fraction of x for validation equaled 0 2 the accurate score was the highest although neither the accurate score nor the computational efficiency was very sensitive to the fraction using multi year data in 6 h time resolution for composing x the model was well trained even when the fraction reached 0 5 within the tests on sizes of mini batch it was determined that the accurate score was not sensitive to sizes of mini batch whereas the computational time dropped when the size of the mini batch was over 300 it was found that a mini batch size of 200 produced higher accurate scores third we tested the sensitivity from different learning rates of the mlp regressor on the accurate score and computational efficiency fig 11 there are three options constant adaptive and invscaling the constant is a constant learning rate given by the initial value and adaptive keeps the rating rate constant to the initial value as long as the training loss keeps decreasing the invscaling represents gradually decreasing the learning rate at each time step using an inverse scaling exponent of a certain value defined by power t results show that adaptive and invscaling perform slightly better in terms of a higher accurate score and less computational time however the differences among the results of the three learning rates are not significant as all the accurate scores are above 0 8 and the total training time of the mlp models are within minutes of one another lastly we test the stepsize α and exponential decay rates for momentum estimates β 1 β 2 of the mlp regressor on the models performance figs 11 and 12 following kingma and ba 2014 we set α 0 1 0 01 0 001 0 0001 and 0 00001 β 1 0 0 5 and 0 9 β 2 0 99 0 999 and 0 9999 the accurate score is sensitive to α as α decreases the accurate score increases when α is larger than 0 01 the accurate score drops greatly below 0 8 and the computational time drops as well with small β 1 values the accurate score could also be affected it is found that models with α 0 01 and β 1 0 9 give higher accurate scores above 0 85 the modeling results are not sensitive to β 2 as long as β 2 0 99 1 except for the intense data requirement and multiple hyperparameters for calibration the mlp model is found superior to a physics based wave model on wave forecasting in a number of ways first with the trained mlp model wave forecasting can be greatly accelerated for example wave forecasting of h s and t p in year 2015 using the mlp model took less than 1 s on a mac desktop with one single processor while the physics based swan model took about 4 5 h with the same outputs on an equivalent number of processors in an hpc cluster the mlp model could forecast wave conditions in a fraction of the time 1 10 000th to 1 20 000th to run the physics based swan model with the trained mlp model massive wave calculations across extremely large spatial and temporal scales could be done in a matter of minutes second the mlp model is easy to use for future wave simulations to run forward predictions using the trained mlp model only the matrices of weights biases and activation functions are required devries et al 2017 which can be saved in a small data file with fewer than 20 lines of python script and a small data file time dependent wave prediction at any location and time in lake michigan can be performed on any computer or device it is possible to integrate the trained lake michigan mlp model into an app for use in a smart phone 4 conclusions a machine learning framework based on an mlp regressor was established for wave forecasting in lake michigan a systematic analysis on the performance of the mlp regressor for a long term wave characteristics hindcast forecast was conducted in this study different to previous work focusing on ocean wave conditions the present study utilized the ml tool in a lacustrine environment and ice cover was for the first time considered in the application of an mlp regressor on wind generated wave modeling in an enclosed and deep lake the ml tool used wind field and ice coverage as inputs features in ml terms and output wave characteristics labels in ml terms including significant wave height and peak wave period in the entire lake the model was trained using the simulated h s and t p data from a physics based swan wave model for the period 2005 2014 the trained mlp model was computationally efficient and capable of predicting characteristic wave conditions h s and t p with accuracy comparable to that of the swan wave model in the validation dataset wave forecasting in 2015 showed that the correlations between the mlp model and the swan model were 0 92 for h s and 0 79 for t p respectively this study also showed that the mlp regressor had the ability to model wave period e g t p with results comparable to swan modelling this study provided guidance for wave forecast hindcast in high latitudes utilizing an mlp regressor sensitivity tests on hyperparameters and regularization techniques were performed for the development and validation of the mlp model the robustness of the mlp model was extensively demonstrated and a suggestive table for selection of the mlp model parameters was provided the adam solver was suggested for case studies with intense data similar to the work presented in this paper once the training and validation dataset is sufficiently long 7 years the mlp model was quite robust in terms of prediction accuracy for 1 year forecasting results showed that learning rate set as adaptive and invscaling performed slightly better in terms of higher accuracy scores and computational efficiency than when set as constant it was suggested that activity function be set as relu for faster computation the option early stopping in certain circumstances could save computational time when set to true but it was determined that higher accuracy scores were achieved when it was set to false it was also shown that the mlp regressor gave higher prediction scores above 0 85 with mini batch 200 stepsize 0 01 and an exponential decay rate for the first momentum 0 9 along with an exponential decay rate for the second momentum within the range of 0 99 1 the trained mlp model could act as an efficient wave forecasting system for lake michigan wave forecasting of characteristic wave conditions for one year took less than 1 s using the mlp model by comparing the computational efficiency of the mlp model and the swan model for wave forecasting it was determined that the computational time of the trained mlp model is a fraction 1 20 000th to 1 10 000th of that of the physics based wave model swan credit authorship contribution statement xi feng writing original draft conceptualization visualization investigation gangfeng ma methodology software supervision shih feng su conceptualization methodology chenfu huang data curation maura k boswell writing review editing pengfei xue writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to give our acknowledgement to the national natural science foundation of china no 51709091 the natural science foundation of jiangsu province no bk20170874 and the fundamental research funds for the central universities no 2017b005 for the funding support this work was also supported by the michigan sea grant college program project number r cglh 7 under na18oar4170102 from noaa national sea grant u s department of commerce and funds from the state of michigan this is contribution no 73 of the great lakes research center at michigan tech 
21708,this work uses the weighted residual method to simulate non hydrostatic flows in ocean and coastal areas in a vertically averaged framework a vertically averaged and moment equations set is developed the system is solved through a hybrid finite volume finite difference numerical scheme to tackle the hyperbolic and elliptic parts of the equations data of seven challenging tests are used to evaluate the model ability to reproduce non linearity dispersion wave breaking bore propagation sheet flow and wave reflection the tests comprise propagation of sinusoidal waves over a submerged bar convergence of the numerical scheme solitary wave transformation over a dry reef flat a wet reef flat and an exposed reef crest collision of two solitary waves and solitary wave reflection on a vertical wall under non breaking and breaking conditions the results highlight the accuracy of the model without prescribing any treatment for wave breaking the conjunction of long and short waves with wave shoaling run up and receding flows is accurately reproduced the model is considered an alternative tool to boussinesq type models to solve non linear flows in the nearshore region with the advantage of having an automatic mimic of wave breaking due to the field variables used to produce the weighted residual depth averaged equations keywords depth integrated modelling weighted residuals method nearshore flow wave breaking run up reflection 1 introduction wave processes in the nearshore region play a key role in coastal dynamics envisaging wave breaking and run up flows these hydraulic processes are responsible for sediment transport inducing morphological changes of the shoreline and beach profile in coasts around the world zijlema and stelling 2008 stelling and zijlema 2009 coastal flooding issues at populated areas and natural overloads over marine infrastructures are also among their consequences ai and jin 2012 ma et al 2012 2014 tissier et al 2010 2012 wei and jia 2014a b a comprehensive understanding of wave transformation and hydrodynamic processes in the nearshore region is essential to characterize investigate and manage ocean and coastal areas which has been the focus of numerous ocean engineering studies in the past decades brocchini and peregrine 1996 yamazaki et al 2009 wei and jia 2014a raoult et al 2016 in essence the flows associated with these coastal hydraulic processes are non hydrostatic and highly non linear with strong frequency dispersion eventually a special treatment is often required while mathematical modelling is applied this mathematical modelling is especially relevant for the design of harbours coastal protection structures and marine renewable energy facilities among other applications in this regard many of the in use models in ocean engineering rely on the solution of the three dimensional 3d reynolds averaged navier stokes rans equations young and wu 2010 wu et al 2010 ai et al 2011 zijlema et al 2011 choi and yuan 2012 ma et al 2012 smit et al 2014 bradford 2011 2014 lu et al 2016 however there is a clear trend in the state of art that suggests the use of vertically averaged non hydrostatic models to avoid unnecessary computational cost by removing the vertical coordinate from the model equations hibberd and peregrine 1979 kobayashi et al 1987 titov and synolakis 1995 brocchini and peregrine 1996 hu et al 2000 zijlema and stelling 2008 yamazaki et al 2009 bai and cheung 2013 wei and jia 2013 over the past few decades continuous research efforts on vertically averaged non hydrostatic models for simulating nearshore wave processes have derived on the development of three related families of models a widely acknowledged family of vertically averaged non hydrostatic models in ocean engineering is the so called boussinesq type models which use extra terms in the momentum balance to account for the non hydrostaticity of the nearshore flow peregrine 1966 brocchini 2013 castro orgaz and hager 2017 peregrine 1966 applied a weakly dispersive and weakly non linear boussinesq model to describe the hydrodynamics of undular bores in coastal engineering setting the origin of this approach in maritime hydraulics however weakly dispersive and weakly non linear boussinesq models fall short to approximate high amplitude waves in intermediate waters the developments of serre 1953 and green and naghdi 1976 permit to overcome this limitation by providing with a weakly dispersive fully non linear mathematical system as a result the serre green naghdi equations are vastly in use currently by the ocean engineering community due to their versatility a second family of vertically averaged non hydrostatic models describes and solves the flow as a compendium of layers stansby and zhou 1998 casulli 1999 zijlema and stelling 2005 lynett and liu 2004 derived a wave propagation model by integrating the euler equations across two arbitrary layers resulting in two velocity profiles matched at the layer interface they optimized the free parameters of the model and obtained good dispersive properties bai and cheung 2012 applied a two layer extension of the shallow water equations swe formulation to coastal processes that enhanced the frequency dispersion of the classical nwogu s 1993 boussinesq model as concluded by castro orgaz et al 2015 the multilayer extended swe models for the single layer case closely resemble the boussinesq models if an appropriate vertical distribution of pressure is prescribed which highlights their close relation a third family of vertically averaged non hydrostatic models albeit almost unexplored in coastal and ocean engineering is formed by those models developed using the weighted residual method steffler and jin 1993 khan and steffler 1996a b this method can be used to derive moment equations from the rans governing equations steffler and jin 1993 in addition to the standard vertically averaged rans equations the additional vertically averaged equations produced are mathematical relations to be satisfied by the solution these relations are necessary if the field variables are defined by using polynomials with undetermined perturbation parameters over the uniform velocity and hydrostatic pressure state typical of the non linear shallow water equations or saint venant equations basically the moment equations are used to treat the perturbation parameters as flow variables and part of the depth averaged rans solution itself therefore the system of equations is commonly named as vertically averaged and moment vam equations and has been shortly tested in open channel flow problems and some isolated coastal applications in both cases showing promising results cantero chinchilla et al 2018 a particular class of boussinesq type models are the so called serre green naghdi equations which are fully non linear phase resolving models barthémely 2004 the development of the equations using irrotational flow methods produces parabolic predictors for the horizontal velocity and pressure fields the original equations barthémely 2004 can be recasted stating additional extra equations in a similar fashion to that used in the vam formulation castro orgaz et al 2015 escalante and morales de luna 2019 have pursued this idea and reformulated the serre green naghdi equations in an equivalent form as a non hydrostatic pressure shallow water system which in turn is structurally similar to the vam model as far as the assessment of nearshore flows in coastal and ocean engineering is concerned an accurate description of the wave breaking mechanism is crucial wave setup long shore currents undertow and coastal morphological changes are dominated by the high energy dissipation associated to the wave breaking phenomena vertically averaged non hydrostatic shallow water models like the boussinesq type equations often require the inclusion of an empirical condition to model the onset of wave breaking which indeed poses a challenging task in modelling fang et al 2015 b kazolea and ricchiuto 2018 vertically integrated models use height function methods to determine the position of the free surface which must be single valued therefore the precise determination of the shape of a breaking wave is thus outside the capabilities of these methods wave breaking is then mimicked in the depth integrated framework as a discontinuity in the solution therefore once detected wave breaking in a cell the accepted procedure is to switch off dispersive terms and solve in the breaking cells the resulting model which is equivalent to the saint venant equations shi et al 2012 cantero chinchilla et al 2016 serre 1953 proposed a wave breaking condition based on the acceleration of a particle at the free surface hager and hutter 1984 used an extended boussinesq type energy equation to establish a wave breaking condition hosoda and tada 1994 proposed an exponential damping function to attenuate the dispersive terms once the onset of wave breaking is reaching in a cell schäffer et al 1993 assumed a two layer approach for the horizontal velocity field in the boussinesq equations comprising a potential main stream near the seabed and a turbulent roller near the free surface madsen 1981 obtaining agreeable results the weighted residual method used in this work permits to avoid the use of an empirical wave breaking condition the model equations mimic wave breaking physically with good accuracy as it is demonstrated in ensuing comparison with experiments further details of the method are found in very few and isolated works steffler and jin 1993 khan and steffler 1996a b cantero chinchilla et al 2018 the main objective of this paper is investigating the potential of the weighted residual method to develop a robust fully non linear depth averaged non hydrostatic model with intrinsic wave breaking for nearshore flows in the surf and swash zones the wave breaking process is mimicked automatically by the proposed model this is initiated when the physics of the wave propagation dictates it and not by any empirical condition tuned to deactivate dispersive effects at some cells in the vam model dispersive effects are never deactivated the vam model khan and steffler 1996a b cantero chinchilla et al 2018 which was initially developed for flow in hydraulic structures and riverine applications is tested in this work using seven challenging tests related to maritime hydraulics to that end a high resolution shock capturing semi implicit hybrid finite volume finite difference method is adopted the laboratory experimental data for wave shoaling breaking run up overland flow and reflection by beji and battjes 1993 briggs et al 1996 craig et al 2006 and roeber 2010 are employed the following sections detail the vam equations the numerical scheme used the results of the validation tests and the conclusions derived from these results 2 vam governing equations consider a one dimensional 1d flow with negligible sediment transport over a fixed beach profile morphology as depicted in fig 1 to accurately describe the wave propagation in the nearshore region using depth averaged models the vertical flow structure must be adequately characterized in the vam model the approximate predictors for the velocity components u w and the pressure distribution p are defined using polynomials with undetermined coefficients khan and steffler 1996a b cantero chinchilla et al 2018 following steffler and jin 1993 the predictors adopted for u w and p are respectively 1 u x z t u 0 u 1 2 z z b h 1 2 w x z t w b w 2 4 z z b h 1 z z b h w s z z b h 3 p x z t ρ g h p 1 p 2 4 z z b h 1 z z b h where x is the horizontal cartesian coordinate z is the vertical cartesian coordinate t is the time ρ is the fluid density g is the gravitational acceleration u 0 is the depth averaged horizontal velocity u 1 is the x velocity at the free surface in excess of u 0 z b is the bed topography level h is the flow depth w b is the vertical velocity at the bed w 2 is the mid depth z velocity in excess of the average of the vertical velocities at the bed and surface w s is the vertical velocity at the free surface p 1 is the bed pressure in excess of hydrostatic and p 2 is the mid depth deviation from the linear non hydrostatic law fig 1 the parameters u 1 w 2 p 1 p 2 are in general functions of x t the predictors for the field variables u w p given by eq 1 3 are used into the vertically integrated rans continuity and momentum equations resulting three evolution equations for the water depth h the discharge q hu 0 and hw respectively steffler and jin 1993 however the perturbation parameters u 1 w 2 p 1 p 2 are additional flow variables to be determined and require mathematical closure therefore to that end moment equations are derived from the rans equations using the weighted residual method steffler and jin 1993 in the following section a brief but concise introduction to the vam model is presented while an extensive description of all the mathematical developments is available in steffler and jin 1993 khan and steffler 1996a b and cantero chinchilla et al 2018 2 1 vertically averaged continuity and momentum equations for a viscous incompressible flow the rans continuity and momentum equations are wu 2008 cantero chinchilla et al 2018 4 u x w z 0 5 u t u 2 x u w z 1 ρ p x 1 ρ σ x x τ z x z 6 w t u w x w 2 z 1 ρ p z 1 ρ τ z x x σ z z g whereτ and σ are the reynolds turbulent shear and normal stresses assuming slip velocity at the bed level the kinematic boundary conditions at the fixed bed and free surface levels are respectively 7 w b u b z b x 8 w s h t u s z s x where u b and u s are the u velocity component at the bed and free surface respectively using the leibniz s rule eq 1 3 and eq 7 8 the vertical integration of eq 4 6 between z b and z s produces 9 h t q x 0 10 q t x g h 2 2 q 2 h x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ h σ x ρ g h z b x p 1 ρ z b x τ b ρ 11 h w t q w x 1 6 h u 1 w x p 1 ρ τ b ρ z b x 1 ρ h τ x z x where q is the discharge hu 0 w is the mean vertical velocity w b 2 2w 2 3 w s 2 w is the vertical velocity difference between bed and free surface w b w s τ b is the bed shear stress and σ x and τ x z are the depth averaged normal and shear stresses a detailed derivation of eq 9 11 can be consulted in steffler and jin 1993 and cantero chinchilla et al 2018 the system of eq 9 11 is indeterminate where only three partial differential equations pdes are available for six flow variables h u 0 u 1 w 2 p 1 and p 2 note that w b and w s are not independent flow variables given that by using the kinematic boundary conditions in eq 7 8 they can be expressed as functions of h u b u s and z b therefore three additional pdes are required to provide mathematical closure to eq 9 11 2 2 weighted averaged moment equations the method of weighted residuals is used in the vam model to produce the mathematical closure to eq 9 11 steffler and jin 1993 the basic idea is to produce the additional pdes needed to simulate the variation in time and space of the perturbation parameters u 1 w 2 p 1 p 2 by multiplying the rans equations by a test function and then performing a vertical integration following steffler and jin 1993 the test function φ 2 z z h is used to weight eq 4 6 where z is the elevation of the centroid of a section z b h 2 the process albeit algebraically tedious entails no difficulty and it is straightforward the resulting moment of continuity x momentum and z momentum equations are respectively khan and steffler 1996a 12 h 2 h t q z x 1 6 h 2 u 1 x h w 13 u 1 t x q u 1 h 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x 6 h ρ τ b 2 σ x z x τ x z 14 t h 2 w 12 x h q w 12 h w 2 h t q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 h ρ τ x z z x σ z h τ b 2 ρ z b x 2 h p 2 3 ρ equation 12 14 provide mathematical closure to eq 9 11 allowing to solve the three extra degrees of freedom namely u 1 w 2 and p 2 introduced by the approximate predictors in eq 1 3 2 3 reactive equations equation 9 11 and 13 14 are mathematically transport equations whereas eq 12 is a reactive equation determining the value of w 15 h w h 2 q x q z x 1 6 h 2 u 1 x e g there is not an unsteady term of the type h w t for the variable modelled by this equation using the continuity eq 9 and the definition of w the kinematic boundary condition at the free surface namely eq 8 is rewritten as the reactive equation cantero chinchilla et al 2018 16 h 2 w 12 h 2 12 q h u 1 z b x h 2 12 q x h 2 12 q h u 1 z b h x mathematically eq 15 16 are statements to be satisfied during the solution procedure their inclusion into the numerical scheme is discussed in the next section 2 4 turbulence closure turbulence closure for the stress tensor terms in eq 10 11 and 13 14 is required according to khan and steffler 1996a the turbulent normal stresses can be neglected as the lowest order of approximation e g 17 σ x σ z 0 the turbulent shear stress is considered to vary linearly between its value at the bed τ b and zero at the free surface cantero chinchilla et al 2018 resulting 18 τ x z τ b 2 the bed shear stress τ b is modelled using the manning s equation as follows 19 τ b ρ g n 2 u b 2 w b 2 h 1 3 where n is the manning s roughness parameter note that the vertical velocity component w b is accounted for in the estimation of the bed shear as required to model flows in steep slopes castro orgaz and hager 2017 2 5 rationale in the development of weighted averaged equations in principle the modeller is free to specify any function for the field variables instead of using eq 1 3 however there are some guiding principles first the vam model is designed as an improvement of the standard non linear swe by introducing perturbation parameters to deviate the flow from hydrostatic pressure conditions with a horizontal kinematic field with depth independent velocity therefore 4 perturbations parameters were introduced into the predictors for u w p namely u 1 w 2 p 1 p 2 the main rule is that the number of perturbation parameters must be compatible with the number of pdes available on inspecting eq 11 namely the z momentum equation it can be observed that the perturbation parameter p 1 is basically determined by this law appendix 1 therefore with 3 moment equations available moment of continuity x momentum and z momentum 3 degrees of freedom can be defined by the modeller in our case these were used by defining the perturbation parameters u 1 w 2 p 2 in the vam model the water depth h is determined by the continuity eq 9 the discharge q by the x momentum eq 10 the perturbation parameter p 1 by the z momentum eq 11 the depth averaged vertical velocity which includes the effect of w 2 is subjected to the statement given by eq 12 in addition to the kinematic boundary conditions eq 7 8 the velocity perturbation u 1 is determined by the moment of x momentum eq 13 and the pressure perturbation parameter p 2 by the moment of z momentum eq 14 another aspect to consider is that the perturbation parameters should appear in the corresponding transport equations as explicitly as possible to facilitate numerical implementation the polynomials used in eq 1 3 preserve this feature as described above if additional degrees of freedom were needed it would be possible to generate additional moment equations using supplementary weighting functions connected to this point the specific weighting function that we used is linear e g φ 2 z z h equivalent to taking moments with respect to the centroid of the flow section the test function to be used is another feature to be decided by the modeller here following steffler and jin 1993 we selected a linear test function guided by basic galerkin ideas as follows let us consider our test function written as φ 2 y h 1 where y is the vertical distance above the channel bed it can be easily observed that φ y h 1 1 φ y h 0 1 and φ y h 1 2 0 in the standard galerkin method the shape functions used to approximate the field variables are taken equal to the test functions in our case this rule was adopted as a guiding principle while defining the perturbation of the u velocity profile eq 1 the perturbed component for the velocity profile is therefore δu u 1 2 y h 1 u 1φ the specific polynomials and test functions used to produce a weighted averaged model are degrees of freedom available for the modeller there is not a rigid or unique choice in our vam model the simplest improvement of the u velocity profile over the swe was adopted namely a linear predictor and a closely related test function was therefore selected the remaining field variables were defined by using polynomials with several perturbation parameters it is known from the boussinesq equations that a linear vertical velocity profile is compatible with a depth independent u velocity u 0 q h castro orgaz and hager 2017 therefore to improve its modelling the linear law was deviated to a quadratic law by introducing the perturbation parameter w 2 a quadratic predictor was also defined for the pressure profile using the two remaining parameters p 1 and p 2 while p 1 is a parameter appearing in the reduced boussinesq type version of the vam model appendix 1 p 2 is not which is thereby closed by the moment of z momentum equation the total number of perturbation parameters was ensured to be identical to the available equations for model closure 2 6 vam relation to boussinesq and single layer non hydrostatic models in this section the vam model is compared to boussinesq and single layer non hydrostatic models note that if u 1 w 2 p 1 p 2 0 eq 9 10 reduce to the swe therefore the moment equations and the vertical momentum equation are not needed for model closure e g only h and q are computed now consider the case where u 1 w 2 p 2 0 that is the only perturbation parameter retained is p 1 this special case of the vam model is called va vertically averaged model the reduced governing eq 9 11 are stated and suitably manipulated in appendix 1 in this case it can be observed that the remaining perturbation parameter p 1 is mathematically determined by the vertical momentum balance i e the moment equations are not needed manipulation of p 1 in appendix 1 indicated that it can be expressed as a function of the horizontal velocity field derivatives u 0 x 2 u 0 x 2 2 u 0 x t and topography terms accounting for the spatial variations of the bed therefore p 1 is determined by a boussinesq type mathematical relation when the expression of p 1 is inserted into the x momentum balance the vam model is reduced to two pdes the continuity and x momentum balances the latter being a boussinesq type equation setting p 2 0 and retaining p 1 amount to assume that the vertical distribution of fluid pressure is non hydrostatic and linear see eq 3 therefore for u 1 w 2 p 2 0 the vam model reduces to a boussinesq type model based on a linear non hydrostatic vertical pressure distribution this type of boussinesq type model was used by khan and steffler 1996a and cantero chinchilla et al 2016 boussinesq type models based on serre 1953 however are from a parabolic pressure distribution castro orgaz et al 2015 compared boussinesq type models based on linear and parabolic pressure distributions and concluded that both approximations produce models that are structurally identical having identical non hydrostatic terms albeit with a different constant in the dispersive term affected by u 0 x 2 u 0 x 2 and 2 u 0 x t this factor affects the dispersion features of the ensuing boussinesq type model for a linear non hydrostatic pressure distribution the linear dispersion relation corresponding to the equations stated in appendix 1 is castro orgaz and hager 2017 c g h 0 1 2 1 1 1 4 k h 0 2 1 2 where c is the celerity h 0 the still water depth and k the wave number for the parabolic pressure distribution of the serre green naghdi equations the linear dispersion relation reads castro orgaz and hager 2017 c g h 0 1 2 1 1 1 3 k h 0 2 1 2 therefore the va model a reduced version of the vam model is a boussinesq type model with a different dispersion relation to that of the serre green naghdi equations now let us consider multilayer models in the single layer case in these models the pressure is split in hydrostatic and non hydrostatic components for a single layer the discrete vertical momentum balance produces an equation for the non hydrostatic bottom pressure zijleman and stelling 2005 e g p 1 in our nomenclature the contribution of this non hydrostatic pressure into the x momentum balance is discretized by using a trapezoidal rule thereby resulting a discrete equation which is identical to that derived for our vam model when u 1 w 2 p 2 0 that is the discretization used in non hydrostatic single layer model amounts to assume that the distribution of fluid pressure across this layer is basically linear this procedure is used in swash zijlema et al 2011 further in the single layer models of yamazaki et al 2008 swash zijlema et al 2011 or fang et al 2015a b the convective vertical acceleration is neglected for the computation of p 1 whereas our vam and reduced va models fully account for both local and convective vertical accelerations thereby resulting in an improvement therefore the va model a special case of the vam model is equivalent to a single layer non hydrostatic depth averaged model then the question is why using vam equations instead of boussinesq equations either in the serre green naghdi or single layer non hydrostatic frameworks the vam model is considered here an alternative no substitute to boussinesq equations however the reasons for considering the vam model as viable alternative are twofold i the vam equations can model dispersive effects up to the quite large value kh 0 8 see appendix 2 for demonstration without introducing any tuning into the governing equations to improve the modelling of short waves by comparison with the standard serre green naghdi equations serre 1953 and the dispersion optimized nwogu equations nwogu 1993 it was concluded that the limits of validity for these two boussinesq systems are kh 0 1 85 serre green naghdi and kh 0 4 75 nwogu dispersion optimized appendix 2 therefore the vam model improves the dispersive modelling of short waves as compared to optimized boussinesq equations without any empirical tuning ii wave breaking criteria is not needed in the vam model given that the vertical profile of horizontal velocity u is modelled the wave breaking mimicking ability of the vam model is due to the modelled velocity profile which introduces differential advection of momentum 1 3 u 1 2 h x thus in waves approaching breaking this horizontal momentum partially balances the effects of the dynamic component of fluid pressure accounted for in the vam model by the perturbation parameters p 1 and p 2 the result is that the model simulates broken waves as shocks in boussinesq type models it is necessary a wave breaking criteria to define the onset of wave breaking and a wave breaking model the wave breaking criteria is usually conducted with simultaneous applications of several empirical conditions checking the wave steepness and the vertical celerity of displacement kazolea and ricchiuto 2018 an accepted manner to mimic breaking once the onset of breaking is detected in a portion of the wave is to switch off dispersive terms and solve the non linear shallow water equations in the flagged cells brocchini 2013 castro orgaz and hager 2017 boussinesq type equations are valuable numerical tools by improving the linear dispersion relation and implementing a wave breaking criterion and breaking module the vam model can simulate the same flows without tuning the dispersion relation introducing empirical conditions to detect wave breaking and implementing a wave breaking model the governing equations of the vam model permit a reasonable reproduction of these features automatically boussinesq type models formulated in terms of the depth averaged velocity are limited to the modelling of long waves barthélemy 2004 two of the most used approaches for improving these models are i adding to the x momentum balance a correction term with a free parameter to be optimized madsen et al 1991 and ii formulate the boussinesq equations in terms of the horizontal velocity at an arbitrary elevation to be optimized nwogu 1993 following either of the two methods the dispersive features of the boussinesq type equations are greatly improved once the free parameters are optimized herein we retained the formulation of the vam equations in terms of the depth averaged velocity given that the dispersive properties were satisfactory at least from intermediate to shallow water depths as shown in the results section however should the vam equations be optimized the dispersive characteristics could be improved further in principle any of the techniques already used for boussinesq type equations can also be applied to optimize the vam system note that the weighting function used in this work namely φ 2 z z h is not the only possible choice and thus not necessarily the best for modelling short waves given the development of the vam equations under the umbrella of galerkin methods a possible additional path is choosing the weighting function for the vertical integration to optimize dispersive properties 2 7 vam governing equations matrix form using eq 9 and accounting for the turbulence closure by eq 17 18 the system of conservation laws given by eq 9 11 and 12 14 can be written in conservative form as follows 20 u t f x s o s τ where u f and s are respectively the vector of flow conservative variables fluxes and source terms which read 21 u u 1 u 2 u 3 u 4 u 5 h q h w u 1 h 2 w 12 f q q 2 h g h 2 2 q w q u 1 h h q w 12 u 2 u 2 2 u 1 g u 1 2 2 u 2 u 3 u 1 u 2 u 4 u 1 u 2 u 5 u 1 22 s o 0 x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ g h z b x p 1 ρ z b x 1 6 h u 1 w x p 1 ρ 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x h w 2 q x q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 2 h p 2 3 ρ s τ 0 τ b ρ τ b ρ z b x 1 2 ρ h τ b x 0 h τ b 2 ρ z x z b x where u 1 u 5 are the conservative flow variables the subscripts o and τ refer respectively to the inviscid and the turbulent stress source terms the system of eq 15 16 and 20 conforms the vam model khan and steffler 1996a b cantero chinchilla et al 2018 3 numerical scheme a semi implicit hybrid finite volume finite difference scheme developed by cantero chinchilla et al 2018 is used to solve the vam system of pdes the numerical scheme is summarized below 3 1 solution strategy the vam model can be solved using a splitting approach first the homogeneous solution of eq 20 is determined using the finite volume method then the homogeneous solution is updated introducing the effects of the inviscid and turbulent source terms in two subsequent steps using a centred finite difference scheme the steps are detailed below finite volume step the homogeneous part of eq 20 23 u t f x 0 is solved explicitly using as initial condition the known value of u at k where k is the current time level index the solution obtained by the finite volume method is called u ˆ note that since the mass conservative eq 9 lacks from source terms the solution of h at k 1 is directly gained from eq 23 yielding h k 1 h ˆ inviscid finite difference step the homogeneous solution u ˆ is updated using a finite difference centred scheme designed to incorporate implicitly the non hydrostatic pressure effects into the velocity field the equation solved is 24 u t s o u in this step the reactive eq 15 16 shall be accounted for while solving eq 24 the implicitly updated solution in this step is called u details in section 3 3 turbulent finite difference step the turbulent reynolds source terms s τ are used explicitly to update the intermediate solution u the equation modelled is 25 u t s τ u and the solution is the final value of u at time k 1 details in section 3 4 in the following sections the numerical techniques used for the solution of eq 23 25 are briefly described further details are available in cantero chinchilla et al 2018 3 2 finite volume step the numerical method in this step is based on a godunov type finite volume scheme dividing the x t plane into quadrilateral finite volume cells of dimensions x i 1 2 x i 1 2 t k t k 1 the integral form of eq 23 is toro 2001 2009 26 u ˆ i u i k δ t δ x f i 1 2 f i 1 2 where u and f are space and time averaged vectors respectively i is the cell index δx is the x dimension of the control volume δt is the t dimension of the control volume the indexes i 1 2 refer to the control volume interfaces between cells i and i 1 the main ingredient of a godunov type scheme is the evaluation of the numerical flux f i 1 2 solving a number of local riemann problems formed at each cell interface after the reconstruction of the vector u within the cells a special feature of depth averaged non hydrostatic modelling of water waves is that the mathematical form of the dispersive terms is similar to that of the truncation errors from saint venant type hydrostatic leading terms castro orgaz and hager 2017 as previously highlighted the vam model contains embedded boussinesq type terms through the effect of p 1 appendix 1 consider finite differencing to second order accuracy of the first order derivative in the shallow water components of the vam model e g u 0 x u 0 i 1 u 0 i 1 2δx o δx 2 this discretization produces in the saint venant terms truncation errors proportional to u 0xxx the mathematical form of these truncation errors is the same as that of the boussinesq type term h 3 u 0 u 0xx 4 x in the x momentum balance appendix 1 if expanded truncation errors introduce numerical dispersion that may mask the true physical dispersion of the vam model therefore higher order differencing of leading order hydrostatic saint venant terms is required it is typical in ocean modelling while solving boussinesq type equations to adopt a high order reconstruction of u within the cells a fourth order total variation diminishing monotone upstream centred scheme for conservation laws is considered in this work muscl tvd 4th yamamoto and daiguji 1993 kim et al 2009 kim and lynett 2011 cantero chinchilla et al 2016 for the vam equations besides for the cell reconstruction the minmod limiter is applied a second order muscl can also be implemented in the vam model but a finer mesh would be needed to control truncation errors during the reconstruction of the flow depth over topography unphysical numerical flux may be generated if it is not controlled the main point is the choice of either the water depth or the free surface as variable to reconstruct in this work the weighted surface depth gradient method wsdgm aureli et al 2008 is adopted which provides a weighted reconstruction of the flow depth using the surface and depth gradient methods sgm and dgm respectively while the sgm performs a reconstruction of the free surface level z s at the cell interfaces the dgm reconstructs the flow depth h the wsdgm is simple to implement and produce robust and stable reconstructions to reduce computational time the approximate riemann solver hllc toro 2001 2009 is implemented which accounts for contact waves in the solution in our case physically representing the propagation of the conservative variables u 3 u 4 u 5 in the riemann problems formed at each cell interface 3 3 inviscid finite difference step using a backward euler formula for the time derivative eq 24 is implicitly approximated as follows 27 u i u ˆ i δ t s 0 u i equations 10 11 13 and 14 are discretized with the formula developed in eq 27 the reactive eqs 15 and 16 are individual mathematical statements to be satisfied during the implicit newton raphson scheme and hence not accounted for in eq 27 the spatial derivatives are approximated using second order central finite differences setting initial values for q u 1 p 1 p 2 w and w the vector of errors is 28 e u i m u ˆ i δ t s 0 u i m where m is a recursion index an analytical jacobian matrix j is determined to progressively reduce the errors using the newton raphson method unknown values for the variables q u 1 p 1 p 2 w and w are determined in the cells i 1 i and i 1 resulting in a 6n 6n diagonal matrix j with 108 analytical terms per cell where n is the number of finite volumes in each iteration the matrix equation to solve is 29 e j d u i where d u i is the vector of corrections once the matrix inversion is accomplished in eq 29 the update of the solution is given by 30 u i m 1 u i m d u i where u i m 1 is the updated solution the process depicted with eq 28 30 is repeated until convergence the j matrix is frozen during the iterations for each time step this permits to save up to 30 of the computational cost cantero chinchilla et al 2018 here the convergence criterion by khan and steffler 1996a is adopted e g the iterations stop if the mean relative error is below a prescribed tolerance in this work 10 6 is considered as the tolerance 3 4 turbulent finite difference step eq 25 is explicitly solved using a forward euler formula as 31 u i k 1 u i δ t s τ u i where the spatial gradients are discretized using central finite differences the time step δt is subjected to the courant friedrich lewy cfl condition to ensure numerical stability it is 32 δ t c f l δ x u 0 c where c gh 1 2 is the long wave celerity by numerical experimentation it was found that the scheme is stable for cfl 0 5 3 5 numerical sequence the numerical sequence is depicted in the flow chart presented in fig 2 and is summarized as follows i the initial conditions are set for h u 0 and z b whilst u 1 w 2 p 1 and p 2 are initiated as zero vectors cfl δx and the computational time are also fixed ii the vector solution of u at k is formed using the previous values for the flow variables iii the cfl condition is checked and δt is computed from eq 32 iv the muscl tvd 4th scheme is applied to reconstruct the flow variables at the cell interfaces the term gh z b x in eq 10 is discretized using a well balanced scheme to avoid numerical instabilities v the hllc approximate riemann solver is used to compute the numerical fluxes at the cell interfaces vi the explicit homogeneous time step in eq 26 is solved to obtain u ˆ and h k 1 vii the implicit inviscid step in eq 27 is computed using u ˆ as initial vector resulting the implicitly updated solution u after the application of the newton raphson method viii the explicit turbulent time step in eq 31 is solved to update u and obtain the final solution of u at k 1 ix steps ii vii are repeated until the target computational time is reached 4 model validation tests the ability of the vam model to approximate nearshore flows involving wave breaking and transformation processes is tested in this section the vam model capabilities to handle non linearity dispersion wave breaking bore propagation and sheet flow are studied using challenging test cases first the propagation of sinusoidal waves over submerged bars is modelled to assess the frequency dispersion features of the vam model analytically discussed in appendix 2 then the same data set is used to conduct a convergence test to the numerical scheme given the lack of known analytical solutions to the vam model even in the simple case of solitary wave propagation later the wave transformation and overland flow phenomena over reef environments are analyzed including dry flat reef wet flat reef and exposed reef crest cases finally wave collision and reflection are explored all the results of the vam model are compared with those obtained through a boussinesq type version of the vam model see appendix 1 and with laboratory measurements 4 1 wave propagation over submerged bars to test the capability of the vam model to simulate short waves experimental data related to the transformation of sinusoidal waves over submerged bars by beji and battjes 1993 were used these tests were conducted in a 37 7 m long 0 8 m wide and 0 75 m high wave flume at the delft university of technology the experiments consisted on the propagation of sinusoidal waves over a submerged bar with a 1 20 upward slope a 2 m long flat crest and a 1 10 downward slope the height of the horizontal crest was 0 3 m the water depth varied from 0 4 m in the deeper region to 0 1 m over the crest fig 3 the sinusoidal waves were generated by a piston type random wave generator at the beginning left boundary fig 3 of the channel and a 1 25 slope plane beach was used as wave absorber at the end right boundary fig 3 of the channel the free surface levels were measured by means of 12 gauges located at the positions indicated in fig 3 the test analyzed in this work consisted of waves with amplitude of 0 01 m and period of 2 02 s the numerical parameters used for both the vam model and the boussinesq type version of the vam model were δx 0 02 m and cfl 0 1 details of the numerical flume for this test including wave generation and boundary conditions are detailed in appendix 3 the time series of free surface elevations obtained with both models at the gauge positions along with the measured data are shown in fig 4 as these relatively long waves propagate over the submerged bar they lose their symmetry significantly and super harmonics are generated thus the regular long waves generated by the paddle are transformed into irregular short waves induced by the presence of the submerged bar as can be observed in fig 4 the computational results generated with the vam model are in very good agreement with experiments including the reproduction of the super harmonics measured by gauges 9 to 11 only some overestimations of the wave peaks over the submerged bar were obtained with the vam model gauges 5 to 8 notable differences are observed between the vam model and the boussinesq type version of the vam model in this test especially at the locations of gauges 8 to 11 where the effect of the frequency dispersion is significant at these positions the predictions by the vam model are considerably more accurate fig 4g j indicating that the vam model reproduces the combined effects of frequency dispersion and non linearity in a more successful way using the experimental data by beji and battjes 1993 at gauges 1 4 7 and 9 a convergence test to the numerical scheme was conducted fig 5 taking the accurate vam simulation of fig 4 with δx 0 02 m and cfl 0 1 as reference the numerical parameters were varied as follows i the cfl was raised to 0 3 while maintaining δx 0 02 m to investigate the time step effect on the numerical scheme and ii the δx was raised to 0 05 m while maintaining cfl 0 1 to investigate the grid spacing effect as it can be observed in fig 5 and table 1 the numerical results tend to collapse with the experimental data when both δx and cfl are reduced thereby demonstrating that the qualitative solution is mesh sized independent 4 2 wave transformation over reef environments fringing reef environments are common in tropical and sub tropical regions across the globe in these coastal areas wave energy dissipation occurs due to both the wave breaking at the reef front and the inshore rough reef flat extending toward the coastline lugo fernández et al 1998 brander et al 2004 wei and jia 2014a in this region the wave trains become highly non linear and frequency dispersive and discontinuous flows eventually emerge after breaking roeber et al 2012 since the complexity of flow is high in this context it poses a proper test to evaluate the robustness of the vam model thus in this section the experimental data by roeber 2010 generated in three different flume setups fig 6 are used to evaluate the ability of the vam model to describe non linear dispersive waves and bore propagation over fringing reefs involving wave breaking 4 2 1 solitary wave transformation on a dry reef flat the experimental data for solitary wave transformation over a steep fore reef and a dry flat inland shore by roeber 2010 is selected for this test referred as test 1 the experiment was conducted in a 48 8 m long 2 16 m wide and 2 1 m high flume at the tsunami wave basin of the oregon state university the experimental flume was divided into three zones i flat reach for the first 17 m ii flat ramp of slope 1 5 for the next 5 m until 1 m height and iii flat reach at 1 m height for the next 23 m ending in a rigid vertical wall fig 6a the solitary wave was generated in the non elevated horizontal reach by a piston type wave maker installed at the end of the flume to maintain dry bed conditions in the offshore flat reef 1 m water depth was prescribed h 0 then a solitary wave of amplitude a 0 5 m was generated and propagated towards the reef leading to a h 0 0 5 during the computations δx 0 1 m cfl 0 1 and n 0 014 sm 1 3 were maintained higher values of cfl were feasible but it was kept small to reduce truncation errors for the initial conditions a solitary wave solution was located at x 10 m at t g h 0 0 5 44 79 according to roeber 2010 where h 0 is the still flow depth to generate the initial solitary wave solution due to the lack of analytical solutions for the vam model the serre green naghdi sgn analytical solution by carter and cienfuegos 2011 was used to initialize the transient solitary wave solution by the vam model cantero chinchilla et al 2018 during this process the initial wave deforms and is progressively adapted to a stable profile the solitary wave amplitude in the sgn solution was then iterated until reaching the desired amplitude for the test the technique to generate the solitary wave solution of the vam model is therefore numerical and iterative but the resulting solution is more accurate than those obtained from the sgn equations cantero chinchilla et al 2018 this process was repeated for the tests of this study which involve solitary waves fig 7 shows the free surface levels predicted by the vam model as compared to the experimental data by roeber 2010 for dry offshore reef flat at different non dimensional times t g h 0 0 5 52 79 figs 7a 54 79 fig 7b 56 79 figs 7c 58 99 fig 7d 59 79 figs 7e 61 69 fig 7f 63 09 figs 7g 65 44 fig 7h 69 44 figs 7i and 74 79 fig 7j note that no wave reflection at the rigid wall end was produced for the computational time tested the solitary wave deforms as it approaches to the fore reef leading to a notable wave skewness increase before collapsing this skewness is successfully reproduced by both the vam model and the boussinesq type version of the vam model fig 7a b the agreement with the experimental data is excellent overall where the advancing bore over the offshore reef and the receding flow in the vicinity of the reef vertex are particularly well approximated fig 8 depicts the evolution of the main perturbation parameters of the vam model p 1 p 2 and u 1 as well as u s and u b at three consecutive times for the dry offshore bed the instants are selected to analyse the nearshore features while approximating the shoreline fig 8a yielding a wave breaking in the surf zone fig 8b and leading to a propagating bore once the wave is broken fig 8c while the solitary wave is approaching to the surf zone the non hydrostaticity prevails over the non uniformity of the horizontal velocity field yielding greater p 1 values fig 8c and lower u 1 values fig 8b this behaviour reverts as the wave breaks on the surf zone then u 1 grows leading a difference between u s and u b enough to produce wave breaking fig 8e triggering the dissipation energy mechanism that ultimately reduces the non hydrostaticity of flow fig 8i for a more detailed evaluation of the vam model the time series of the free surface level at six gauges are approximated as shown in fig 9 the six gauges were located at x 17 m fig 9a x 19 m fig 9b x 21 m fig 9c x 23 m fig 9d x 25 m fig 9e and x 29 m fig 9f where x is measured from the left end of the flume again both the vam model and the boussinesq type version of the vam model provide an excellent approximation of the experimental data in the time series where only the fluctuating position near the reef vertex is misplotted fig 9d 4 2 2 solitary wave transformation on a wet reef flat in this section the experimental test for solitary wave transformation over a fore reef and a wet flat inland shore by roeber 2010 is analyzed the experiment was conducted in a 104 m long 3 66 m wide and 4 57 m high flume at the tsunami wave basin of the oregon state university a solitary wave with a 1 23 m was generated at the horizontal deep zone by a piston type wave maker at x 0 m this zone extends until x 25 9 m fig 6b then the solitary wave propagates over a fore reef with a relatively gentle slope 1 12 until x 54 15 m and a wet offshore reef flat until x 83 7 m where a rigid vertical wall was placed the deepest flow depth was h 0 2 46 m while the flow depth over the offshore reef flat remained equal to 0 1 m δx 0 2 m cfl 0 1 and n 0 014 sm 1 3 were prescribed for the computations the initial conditions consisted of a solitary wave solution located at x 17 6 m at t g h 0 0 5 54 3 roeber 2010 fig 10 shows the vam model results as compared with the experimental data by roeber 2010 at eight different non dimensional times t g h 0 0 5 62 3 figs 10a 64 3 fig 10b 65 8 figs 10c 67 1 fig 10d 69 8 figs 10e 73 fig 10f 76 3 figs 10g and 93 2 fig 10h it is worth noting that wave breaking is prominent for this test which occurred around t g h 0 5 64 roeber 2010 the jet from the plunging breaking wave then hits the water surface and generates a bore that propagated over the wet reef and was reflected by the landward boundary in this case the wave breaking is successfully reproduced by the vam model whereas the boussinesq type version of the vam model overestimates the free surface level and wave height at breaking in addition the free surface time series are evaluated by the vam model at six different gauge positions x 35 9 m fig 11 a x 44 3 m fig 11b x 48 2 m fig 11c x 50 4 m fig 11d x 57 9 m fig 11e and x 65 2 m fig 11f without any explicit criterion for wave breaking the vam model shows its capability to approximate the unsteady transient flow providing an accurate description of the wave breaking bore front and dispersive waves after reflection these results are relevant since they show that the dependency of depth averaged models on any wave breaking prescription can be dropped note that the results of the boussinesq type version of the vam model without prescribing any explicit criterion for wave breaking overestimate the experimental free surface elevations at the breaking zone as can be observed in fig 11d 4 2 3 solitary wave transformation on an exposed reef crest the experimental data of wave transformation on an exposed reef crest by roeber 2010 are selected here for comparison purposes exposed reef crests located between the fore reef and the reef flat are typical in fringing reef environments roeber 2010 the experiment was conducted in the wave flume described in the previous section the geometrical configuration consisted of an offshore flat a fore reef with a slope of 1 12 and a reef crest with a height of 0 2 m fig 6c the reef crest was initially emerged 6 cm with a 14 cm depth lagoon located from the crest toward the landward boundary of the flume the experiment consisted of the propagation of a solitary wave generated at the deep horizontal left boundary of the flume the amplitude of the solitary wave was a 1 25 m and the still water depth h 0 2 5 m leading to a h 0 0 5 although lower a h 0 ratios are available in roeber et al 2010 and wei and jia 2014a for this test case a h 0 0 5 is selected here to represent the most highly non linear challenging test among the roeber s setups the computations were conducted by maintaining δx 0 2 m cfl 0 1 and n 0 014 sm 1 3 following the same procedure as described in previous sections the initial solution corresponded to a solitary wave solution located at x 17 6 m at t g h 0 0 5 47 11 roeber 2010 fig 12 shows the vam model results in comparison with the measured free surface levels at ten different non dimensional times t g h 0 0 5 54 91 figs 12a 57 61 fig 12b 59 31 figs 12c 60 86 fig 12d 62 21 figs 12e 65 41 fig 12f 68 61 figs 12g 80 11 fig 12h 91 26 figs 12i and 100 61 fig 12j wave shoaling occurs over the fore reef the profile of the solitary wave adopts a near vertical form and then the wave breaks near the top of the crest around t g h 0 5 59 after breaking wave overtopping occurs and the generated bore wave advances over the wet offshore reef flat the bore is then reflected by the rigid vertical flume end and the reflected wave ultimately overtops the reef crest leading to dispersive waves all these hydraulic processes which are illustrated by the experimental data shown in fig 12 are accurately mimicked by the vam model the model detects the wave breaking that would not be otherwise accounted by conventional depth averaged models the backward flow and the dispersive wave zone beyond the crest are also well simulated by the numerical model importantly the vam model results shown in fig 12 are in agreement with the results of the boussinesq type model by roeber 2010 and the cddhe2d nhwave boussinesq type model by wei and jia 2014b whilst roeber 2010 used an empirical wave breaking criterion based on the averaged momentum flux to deactivate the dispersion terms wei and jia 2014b applied an especial finite volume discretization of the advection terms to account for the wave breaking phenomena with eddy viscosity however the vam model is able to reproduce the advection dominated processes that define the wave breaking phenomena at the free surface of advancing waves without using any empirical condition to detect breaking or especial numerical treatments the ability to reproduce breaking waves is therefore inherent to the vam model if boussinesq type models are applied without implementing wave breaking they provide results that overestimate the free surface and wave height at the breaking zone figs 10 and 12 the capability of the vam model to simulate the free surface levels in this test is also assessed using the free surface time series by roeber 2010 at six gauges located at x 44 3 m fig 13 a x 48 2 m fig 13b x 50 4 m fig 13c x 57 9 m fig 13d x 65 2 m fig 13e and x 80 m fig 13f in this figure it is observed that the boussinesq type version of the vam model not only overestimates the free surface at the breaking zone but also at the reef flat fig 13e the greater differences occur after the reflection of the wave at the right boundary fig 13f 4 3 wave reflection a key hydraulic process for numerical coastal model validation is wave reflection which involves wave superposition and gains importance near marine infrastructures determining design criteria these hydraulic processes are challenging tests for numerical models highly non linear and accurate frequency dispersive models are required to prescribe an accurate description of these processes while using the depth averaging technique cea et al 2007 in this section the vam model is validated against wave superposition and wave reflection in coastal environments using the experimental data by craig et al 2006 and briggs et al 1996 respectively 4 3 1 collision of solitary waves the experimental data for two solitary waves propagating in opposite directions by craig et al 2006 are selected here to test the capability of the vam model to approximate wave superposition the experiment was conducted in a 13 165 m long 25 4 m wide flume at the w b prichard fluid mechanics laboratory of penn state university the water depth for the experiments was 5 cm and the solitary waves were generated by a piston like paddle water surface values were collected by a bottom mounted pressure transducer and four non contacting wave gauges to reproduce the asymmetric head on collision of solitary waves a first solitary wave was generated this wave was propagated towards the end of the channel and reflected then the reflected wave with amplitude equal to 1 217 cm collided with a second solitary wave generated by the paddle with amplitude of 1 063 cm for a detailed description of the experiments the reader is referred to hammack et al 2005 and craig et al 2006 the numerical simulation was accomplished by maintaining δx 0 01 m and cfl 0 1 while the roughness was kept to n 0 005 sm 1 3 to represent the glass material of the flume following the procedure to generate solitary wave solutions by the vam model described in previous sections the initial conditions for this test consisted of two opposing solitary waves with a 1 063 cm and a 1 217 cm at x 1 255 m and x 2 349 m respectively fig 14 compares the vam model results with the experimental data by craig et al 2006 at t 18 299 s fig 14a t 18 800 s fig 14b t 19 052 s fig 14c t 19 101 s fig 14d t 19 150 s fig 14e t 19 193 s fig 14f t 19 329 s fig 14g and t 19 501 s fig 14h the agreement between the vam model simulation and the experimental data is excellent only small discrepancies are found in the predicted maximum amplitude of the superposed waves in fig 14c and the solitary wave to the right in fig 14g the main differences between the vam model results and those obtained with the boussinesq type version of the vam model occur after the collision of the incident and reflected waves fig 14e and f 4 3 2 solitary wave reflection on a vertical wall to evaluate the capability of the vam model to approximate tsunami like reflection waves the experimental data by briggs et al 1996 are used in this section the experiments were conducted in a wave flume with a length of 23 23 m and a width of 0 45 m the flume bed configuration simulated the bottom profile of the revere beach in massachusetts comprising i a flat section in the seaward boundary ii three sections with different slope values from left to right 1 53 1 150 and 1 13 and iii a vertical wall at the landward boundary of the flume the water depth for the experiments was h 0 0 218 m two different tests were carried out with relative wave heights a h of 0 039 and 0 246 fig 15 representing a small wave that does not break and a larger wave that breaks before the wall respectively a detailed description of the experiments can be found in briggs et al 1996 different numerical conditions are prescribed for the two tests by numerical experimentation the test with a h 0 039 was observed to be less sensitive to the numerical parameters while the test with a h 0 246 showed a high dependency on these parameters thereby δx 0 05 m cfl 0 1 and n 0 014 sm 1 3 were prescribed for the test with a h 0 039 whereas δx 0 02 m cfl 0 1 and n 0 005 sm 1 3 were used for the test with a h 0 246 fig 16 shows the time series of the measured and modelled free surface elevations at different positions across the flume for the test with a h 0 039 namely x 15 04 m fig 16a x 17 22 m fig 16b x 19 4 m fig 16c x 20 86 m fig 16d and x 22 23 m fig 16e at the same locations the comparison for the test with a h 0 246 is depicted in fig 17 in the first case the numerical results fit the experimental measurements of the free surface for both the incident and the reflected waves fig 16 a small lag is observed for the reflected wave at x 15 04 m but the differences between measured and modelled elevations are lower than 0 004 m as highlighted by wei at al 2014b the slight differences after the passage of the reflected wave at x 19 4 m x 20 86 m and x 22 23 m are influenced by the experimental setup the main differences between the predictions of the vam and the bousinessq type models were obtained for the peaks of the reflected wave fig 16 on the other hand in the test with a h 0 246 fig 17 wave breaking occurs near the wall despite this fact the model predictions generally reproduce the temporal evolution of the measured water surface at the different positions however the model underestimates the peaks of both the incident and reflected waves for the incident waves a high dependency on the roughness parameter was observed by numerical experimentation which produced a progressive deterioration of the solution in the case of the reflected wave a phase lag is observed between experimental data and model predictions fig 17a d which is however corrected in fig 17e it is worth noting that the phase lag observed in the reflected wave with regards to the experimental data is also observed by wei and jia 2014a via application of a boussinesq type model these authors concluded that the phase lag could be due to an over prediction of the wave peak yielding a faster wave which may be the case in the present simulation near the vertical wall in this case significant differences are observed between the results of the vam model and those obtained with the boussinesq type version of the vam model for both the incident and reflected waves the differences not only consist of variations in the magnitude of the wave peaks but there is also a phase lag between the waves predicted by both models especially notable in the reflected wave 5 conclusions in this study the vertically averaged and moment equations vam method is used to model non hydrostatic flows in coastal areas this approach which has been almost unexplored in this area as compared to boussinesq type models is applied to reproduce flows and wave processes in the nearshore region envisaging wave breaking and superposition phenomena to that end a semi implicit finite volume finite difference numerical scheme is used to solve the vam model showing robustness in all the tests conducted the capability of the vam model to approximate nearshore flows and intermediate water processes is validated through comparison with laboratory measurements the tests involved propagation of sinusoidal waves over a submerged bar convergence of the numerical scheme of the model propagation of solitary waves over fringing reef environments superposition of two counter propagating solitary waves and tsunami like reflection waves on a dike like wall the results showed mesh size independency and excellent agreements with the experimental data overall for weakly and highly non linear solitary waves the vam model produces a precise linear frequency dispersion relation very close to the exact solution castro orgaz and hager 2017 cantero chinchilla et al 2018 this permits an accurate description of both long and short waves the advection dominated wave breaking phenomena in the tests conducted are accurately reproduced by the vam model without using empirical wave breaking conditions or especial numerical treatments which is a common feature in non hydrostatic boussinesq type models used in ocean research these new findings of this work suggest the vam model as an interesting high resolution depth averaged non hydrostatic model with automatic wave breaking for coastal engineering applications the vam model is a suitable alternative to boussinesq type models which are widely used for design studies in harbours and other marine structures credit authorship contribution statement francisco n cantero chinchilla conceptualization methodology software validation formal analysis writing original draft writing review editing rafael j bergillos conceptualization methodology software validation formal analysis writing original draft writing review editing oscar castro orgaz conceptualization methodology software validation formal analysis writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the spanish research project ctm2017 85171 c2 1 r fncc and rb were partly funded by the spanish ministry of science innovation and universities through programa juan de la cierva 2016 fjci 2016 28009 and programa juan de la cierva 2017 fjci 2017 31781 respectively we thank the two anonymous reviewers of this work for the comments offered to improve it appendix 1 boussinesq type model as simplified case of the vam system consider the case where u 1 w 2 p 2 0 and the only perturbation parameter retained is p 1 the momentum balances eqs 10 and 11 are in this case 33 q t x g h 2 2 q 2 h x h p 1 2 ρ g h z b x p 1 ρ z b x τ b ρ 34 h w t q w x p 1 ρ τ b ρ z b x 1 2 ρ h τ b x with the depth averaged vertical velocity given by note that w 2 0 and thus the vertical velocity is linearly distributed to this degree of approximation 35 w w s w b 2 moreover the free surface and bed kinematic boundary conditions are respectively 36 w s h t u 0 x h z b 37 w b u 0 z b x using eq 35 37 and neglecting τ b for simplicity s sake eq 34 is rewritten as 38 p 1 ρ u 0 x 2 u 0 x t u 0 u 0 x x h 2 2 h d w b d t where it is observed that the perturbation parameter p 1 is determined by boussinesq type terms e g by u 0 x 2 u 0 x 2 and 2 u 0 x t serre 1953 and the topography term dw b dt where d dt t u 0 x is the depth averaged material derivative operator inserting eq 38 into eq 33 produces 39 q t x g h 2 2 q 2 h x u 0 x 2 u 0 x t u 0 u 0 x x h 3 4 h 2 2 d w b d t g h z b x u 0 x 2 u 0 x t u 0 u 0 x x h 2 2 h d w b d t z b x τ b ρ which is a boussinesq type momentum equation the continuity eq 9 and eq 39 form a reduced vam model of boussinesq type called here va model it is solved in this work using the same numerical scheme developed for the vam model appendix 2 frequency dispersion of the vam model for small amplitude waves propagating over a horizontal and frictionless channel with still water the flow depth can be split as h h 0 h where h is a perturbation from the static level the linearized equations for the vam model are steffler and jin 1993 40 h t h 0 u 0 x 0 41 u 0 t g h x 1 2 ρ p 1 x 2 3 ρ p 2 x 0 42 u 1 t 1 2 ρ p 1 x 0 43 p 1 ρ h 0 2 2 h t 2 h 0 2 6 2 u 1 x t 44 p 2 ρ h 0 8 2 h t 2 combining eqs 40 44 is quite tedious algebraically but entails no difficulty the resulting linearized vam equation for the free surface deflections is 45 2 h t 2 g h 0 2 h x 2 5 h 0 2 12 4 h t 2 x 2 g h 0 3 12 4 h x 4 h 0 4 144 6 h t 2 x 4 0 if a perturbation of the water surface of harmonic shape is assumed eq 45 produces the dispersion relation steffler and jin 1993 46 c 2 g h 0 1 1 12 k h 0 2 1 5 12 k h 0 2 1 144 k h 0 4 where c is the celerity and k the wave number the exact dispersion relation of the problem is castro orgaz and hager 2017 47 c 2 g h 0 tanh k h 0 k h 0 for further comparative purposes consider the 1d boussinesq equations of nwogu 1993 48 h t h u α x α 1 3 h 0 3 3 u α x 3 0 49 u α t g h x u α u α x α h 0 2 3 u α 2 x t 0 where u α is the velocity at an undetermined elevation z α and α is a calibration parameter the arbitrary elevation z α and the coefficient α in nwogu s theory are related by nwogu 1993 50 α 1 2 z α h 0 2 z α h 0 the dispersion relation for eqs 48 49 is nwogu 1993 51 c 2 g h 0 1 α 1 3 k h 0 2 1 α k h 0 2 the optimized value of α 0 39 by nwogu is used in the computations presented below the dispersion relation of the serre green naghdi equations is recovered for α 1 3 resulting 52 c 2 g h 0 1 1 1 3 k h 0 2 equations 46 51 and 52 are compared with eq 47 in fig 18 where the error of each approximation with respect to the exact result is depicted considering an error band of 5 the vam model is within the accuracy interval up to kh 0 8 whereas these limits are kh 0 1 85 and kh 0 4 75 for the serre green naghdi and nwogu dispersion optimized equations respectively therefore the vam model improves the dispersive modelling of short waves as compared to optimized nwogu s boussinesq equations without any empirical tuning allowing modelling of dispersive effects up to a quite large value fig 18 small amplitude waves comparison of vam with boussinesq type approximations fig 18 appendix 3 numerical flume for the submerged bar test for the test of wave propagation over a submerged bar by beji and battjees 1993 implemented in section 4 1 the generation of piston type sinusoidal waves was accomplished by inserting a source term s w to the mass conservation equation eq 9 the source term used for wave generation is cantero chinchilla et al 2018 53 s w x t d exp ξ x x s 2 sin ω t in which 54 ξ 80 δ 2 l 2 55 d 2 ξ h 0 ω 2 α 1 g k 4 h 0 3 ω k π exp k 2 4 ξ 1 α k h 0 2 here ω is the wave frequency x s is the location of the center of the wave making mechanism δ is a parameter influencing the width of the wave generator function d is the source function for the amplitude h 0 is the wave amplitude α 0 39 and α 1 α 1 3 following kazolea et al 2014 x s 0 m δ 0 8 and h 0 l 0 11 were used in this numerical test to avoid numerically generated wave reflections at the boundaries and thus the contamination of the numerical solution sponge layers were implemented at both boundaries of the numerical flume for the free surface the damping function used in the work is kazolea et al 2014 56 m x 1 x x 1 l s where l s is the sponge layer width and x 1 is the initial coordinate of the sponge layer following kazolea et al 2014 the sponge layer width should satisfy l l s 1 5l where l is the wavelength hence l s 6 5 m was adopted a sketch of the numerical flume for the test conducted in section 4 1 is shown in fig 19 the sponge layer at the left hand side of the wavemaker permits to absorb the portion of the symmetrically generated sinusoidal waves travelling backwards thus this implementation ensures no wave reflection from the left boundary and therefore the gauges closer to the wavemaker i e gauge 1 2 and 3 are not subject to numerical noise fig 19 definition sketch of the numerical flume for the sinusoidal wave propagation over a submerged bar test by beji and battjes 1993 fig 19 
21708,this work uses the weighted residual method to simulate non hydrostatic flows in ocean and coastal areas in a vertically averaged framework a vertically averaged and moment equations set is developed the system is solved through a hybrid finite volume finite difference numerical scheme to tackle the hyperbolic and elliptic parts of the equations data of seven challenging tests are used to evaluate the model ability to reproduce non linearity dispersion wave breaking bore propagation sheet flow and wave reflection the tests comprise propagation of sinusoidal waves over a submerged bar convergence of the numerical scheme solitary wave transformation over a dry reef flat a wet reef flat and an exposed reef crest collision of two solitary waves and solitary wave reflection on a vertical wall under non breaking and breaking conditions the results highlight the accuracy of the model without prescribing any treatment for wave breaking the conjunction of long and short waves with wave shoaling run up and receding flows is accurately reproduced the model is considered an alternative tool to boussinesq type models to solve non linear flows in the nearshore region with the advantage of having an automatic mimic of wave breaking due to the field variables used to produce the weighted residual depth averaged equations keywords depth integrated modelling weighted residuals method nearshore flow wave breaking run up reflection 1 introduction wave processes in the nearshore region play a key role in coastal dynamics envisaging wave breaking and run up flows these hydraulic processes are responsible for sediment transport inducing morphological changes of the shoreline and beach profile in coasts around the world zijlema and stelling 2008 stelling and zijlema 2009 coastal flooding issues at populated areas and natural overloads over marine infrastructures are also among their consequences ai and jin 2012 ma et al 2012 2014 tissier et al 2010 2012 wei and jia 2014a b a comprehensive understanding of wave transformation and hydrodynamic processes in the nearshore region is essential to characterize investigate and manage ocean and coastal areas which has been the focus of numerous ocean engineering studies in the past decades brocchini and peregrine 1996 yamazaki et al 2009 wei and jia 2014a raoult et al 2016 in essence the flows associated with these coastal hydraulic processes are non hydrostatic and highly non linear with strong frequency dispersion eventually a special treatment is often required while mathematical modelling is applied this mathematical modelling is especially relevant for the design of harbours coastal protection structures and marine renewable energy facilities among other applications in this regard many of the in use models in ocean engineering rely on the solution of the three dimensional 3d reynolds averaged navier stokes rans equations young and wu 2010 wu et al 2010 ai et al 2011 zijlema et al 2011 choi and yuan 2012 ma et al 2012 smit et al 2014 bradford 2011 2014 lu et al 2016 however there is a clear trend in the state of art that suggests the use of vertically averaged non hydrostatic models to avoid unnecessary computational cost by removing the vertical coordinate from the model equations hibberd and peregrine 1979 kobayashi et al 1987 titov and synolakis 1995 brocchini and peregrine 1996 hu et al 2000 zijlema and stelling 2008 yamazaki et al 2009 bai and cheung 2013 wei and jia 2013 over the past few decades continuous research efforts on vertically averaged non hydrostatic models for simulating nearshore wave processes have derived on the development of three related families of models a widely acknowledged family of vertically averaged non hydrostatic models in ocean engineering is the so called boussinesq type models which use extra terms in the momentum balance to account for the non hydrostaticity of the nearshore flow peregrine 1966 brocchini 2013 castro orgaz and hager 2017 peregrine 1966 applied a weakly dispersive and weakly non linear boussinesq model to describe the hydrodynamics of undular bores in coastal engineering setting the origin of this approach in maritime hydraulics however weakly dispersive and weakly non linear boussinesq models fall short to approximate high amplitude waves in intermediate waters the developments of serre 1953 and green and naghdi 1976 permit to overcome this limitation by providing with a weakly dispersive fully non linear mathematical system as a result the serre green naghdi equations are vastly in use currently by the ocean engineering community due to their versatility a second family of vertically averaged non hydrostatic models describes and solves the flow as a compendium of layers stansby and zhou 1998 casulli 1999 zijlema and stelling 2005 lynett and liu 2004 derived a wave propagation model by integrating the euler equations across two arbitrary layers resulting in two velocity profiles matched at the layer interface they optimized the free parameters of the model and obtained good dispersive properties bai and cheung 2012 applied a two layer extension of the shallow water equations swe formulation to coastal processes that enhanced the frequency dispersion of the classical nwogu s 1993 boussinesq model as concluded by castro orgaz et al 2015 the multilayer extended swe models for the single layer case closely resemble the boussinesq models if an appropriate vertical distribution of pressure is prescribed which highlights their close relation a third family of vertically averaged non hydrostatic models albeit almost unexplored in coastal and ocean engineering is formed by those models developed using the weighted residual method steffler and jin 1993 khan and steffler 1996a b this method can be used to derive moment equations from the rans governing equations steffler and jin 1993 in addition to the standard vertically averaged rans equations the additional vertically averaged equations produced are mathematical relations to be satisfied by the solution these relations are necessary if the field variables are defined by using polynomials with undetermined perturbation parameters over the uniform velocity and hydrostatic pressure state typical of the non linear shallow water equations or saint venant equations basically the moment equations are used to treat the perturbation parameters as flow variables and part of the depth averaged rans solution itself therefore the system of equations is commonly named as vertically averaged and moment vam equations and has been shortly tested in open channel flow problems and some isolated coastal applications in both cases showing promising results cantero chinchilla et al 2018 a particular class of boussinesq type models are the so called serre green naghdi equations which are fully non linear phase resolving models barthémely 2004 the development of the equations using irrotational flow methods produces parabolic predictors for the horizontal velocity and pressure fields the original equations barthémely 2004 can be recasted stating additional extra equations in a similar fashion to that used in the vam formulation castro orgaz et al 2015 escalante and morales de luna 2019 have pursued this idea and reformulated the serre green naghdi equations in an equivalent form as a non hydrostatic pressure shallow water system which in turn is structurally similar to the vam model as far as the assessment of nearshore flows in coastal and ocean engineering is concerned an accurate description of the wave breaking mechanism is crucial wave setup long shore currents undertow and coastal morphological changes are dominated by the high energy dissipation associated to the wave breaking phenomena vertically averaged non hydrostatic shallow water models like the boussinesq type equations often require the inclusion of an empirical condition to model the onset of wave breaking which indeed poses a challenging task in modelling fang et al 2015 b kazolea and ricchiuto 2018 vertically integrated models use height function methods to determine the position of the free surface which must be single valued therefore the precise determination of the shape of a breaking wave is thus outside the capabilities of these methods wave breaking is then mimicked in the depth integrated framework as a discontinuity in the solution therefore once detected wave breaking in a cell the accepted procedure is to switch off dispersive terms and solve in the breaking cells the resulting model which is equivalent to the saint venant equations shi et al 2012 cantero chinchilla et al 2016 serre 1953 proposed a wave breaking condition based on the acceleration of a particle at the free surface hager and hutter 1984 used an extended boussinesq type energy equation to establish a wave breaking condition hosoda and tada 1994 proposed an exponential damping function to attenuate the dispersive terms once the onset of wave breaking is reaching in a cell schäffer et al 1993 assumed a two layer approach for the horizontal velocity field in the boussinesq equations comprising a potential main stream near the seabed and a turbulent roller near the free surface madsen 1981 obtaining agreeable results the weighted residual method used in this work permits to avoid the use of an empirical wave breaking condition the model equations mimic wave breaking physically with good accuracy as it is demonstrated in ensuing comparison with experiments further details of the method are found in very few and isolated works steffler and jin 1993 khan and steffler 1996a b cantero chinchilla et al 2018 the main objective of this paper is investigating the potential of the weighted residual method to develop a robust fully non linear depth averaged non hydrostatic model with intrinsic wave breaking for nearshore flows in the surf and swash zones the wave breaking process is mimicked automatically by the proposed model this is initiated when the physics of the wave propagation dictates it and not by any empirical condition tuned to deactivate dispersive effects at some cells in the vam model dispersive effects are never deactivated the vam model khan and steffler 1996a b cantero chinchilla et al 2018 which was initially developed for flow in hydraulic structures and riverine applications is tested in this work using seven challenging tests related to maritime hydraulics to that end a high resolution shock capturing semi implicit hybrid finite volume finite difference method is adopted the laboratory experimental data for wave shoaling breaking run up overland flow and reflection by beji and battjes 1993 briggs et al 1996 craig et al 2006 and roeber 2010 are employed the following sections detail the vam equations the numerical scheme used the results of the validation tests and the conclusions derived from these results 2 vam governing equations consider a one dimensional 1d flow with negligible sediment transport over a fixed beach profile morphology as depicted in fig 1 to accurately describe the wave propagation in the nearshore region using depth averaged models the vertical flow structure must be adequately characterized in the vam model the approximate predictors for the velocity components u w and the pressure distribution p are defined using polynomials with undetermined coefficients khan and steffler 1996a b cantero chinchilla et al 2018 following steffler and jin 1993 the predictors adopted for u w and p are respectively 1 u x z t u 0 u 1 2 z z b h 1 2 w x z t w b w 2 4 z z b h 1 z z b h w s z z b h 3 p x z t ρ g h p 1 p 2 4 z z b h 1 z z b h where x is the horizontal cartesian coordinate z is the vertical cartesian coordinate t is the time ρ is the fluid density g is the gravitational acceleration u 0 is the depth averaged horizontal velocity u 1 is the x velocity at the free surface in excess of u 0 z b is the bed topography level h is the flow depth w b is the vertical velocity at the bed w 2 is the mid depth z velocity in excess of the average of the vertical velocities at the bed and surface w s is the vertical velocity at the free surface p 1 is the bed pressure in excess of hydrostatic and p 2 is the mid depth deviation from the linear non hydrostatic law fig 1 the parameters u 1 w 2 p 1 p 2 are in general functions of x t the predictors for the field variables u w p given by eq 1 3 are used into the vertically integrated rans continuity and momentum equations resulting three evolution equations for the water depth h the discharge q hu 0 and hw respectively steffler and jin 1993 however the perturbation parameters u 1 w 2 p 1 p 2 are additional flow variables to be determined and require mathematical closure therefore to that end moment equations are derived from the rans equations using the weighted residual method steffler and jin 1993 in the following section a brief but concise introduction to the vam model is presented while an extensive description of all the mathematical developments is available in steffler and jin 1993 khan and steffler 1996a b and cantero chinchilla et al 2018 2 1 vertically averaged continuity and momentum equations for a viscous incompressible flow the rans continuity and momentum equations are wu 2008 cantero chinchilla et al 2018 4 u x w z 0 5 u t u 2 x u w z 1 ρ p x 1 ρ σ x x τ z x z 6 w t u w x w 2 z 1 ρ p z 1 ρ τ z x x σ z z g whereτ and σ are the reynolds turbulent shear and normal stresses assuming slip velocity at the bed level the kinematic boundary conditions at the fixed bed and free surface levels are respectively 7 w b u b z b x 8 w s h t u s z s x where u b and u s are the u velocity component at the bed and free surface respectively using the leibniz s rule eq 1 3 and eq 7 8 the vertical integration of eq 4 6 between z b and z s produces 9 h t q x 0 10 q t x g h 2 2 q 2 h x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ h σ x ρ g h z b x p 1 ρ z b x τ b ρ 11 h w t q w x 1 6 h u 1 w x p 1 ρ τ b ρ z b x 1 ρ h τ x z x where q is the discharge hu 0 w is the mean vertical velocity w b 2 2w 2 3 w s 2 w is the vertical velocity difference between bed and free surface w b w s τ b is the bed shear stress and σ x and τ x z are the depth averaged normal and shear stresses a detailed derivation of eq 9 11 can be consulted in steffler and jin 1993 and cantero chinchilla et al 2018 the system of eq 9 11 is indeterminate where only three partial differential equations pdes are available for six flow variables h u 0 u 1 w 2 p 1 and p 2 note that w b and w s are not independent flow variables given that by using the kinematic boundary conditions in eq 7 8 they can be expressed as functions of h u b u s and z b therefore three additional pdes are required to provide mathematical closure to eq 9 11 2 2 weighted averaged moment equations the method of weighted residuals is used in the vam model to produce the mathematical closure to eq 9 11 steffler and jin 1993 the basic idea is to produce the additional pdes needed to simulate the variation in time and space of the perturbation parameters u 1 w 2 p 1 p 2 by multiplying the rans equations by a test function and then performing a vertical integration following steffler and jin 1993 the test function φ 2 z z h is used to weight eq 4 6 where z is the elevation of the centroid of a section z b h 2 the process albeit algebraically tedious entails no difficulty and it is straightforward the resulting moment of continuity x momentum and z momentum equations are respectively khan and steffler 1996a 12 h 2 h t q z x 1 6 h 2 u 1 x h w 13 u 1 t x q u 1 h 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x 6 h ρ τ b 2 σ x z x τ x z 14 t h 2 w 12 x h q w 12 h w 2 h t q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 h ρ τ x z z x σ z h τ b 2 ρ z b x 2 h p 2 3 ρ equation 12 14 provide mathematical closure to eq 9 11 allowing to solve the three extra degrees of freedom namely u 1 w 2 and p 2 introduced by the approximate predictors in eq 1 3 2 3 reactive equations equation 9 11 and 13 14 are mathematically transport equations whereas eq 12 is a reactive equation determining the value of w 15 h w h 2 q x q z x 1 6 h 2 u 1 x e g there is not an unsteady term of the type h w t for the variable modelled by this equation using the continuity eq 9 and the definition of w the kinematic boundary condition at the free surface namely eq 8 is rewritten as the reactive equation cantero chinchilla et al 2018 16 h 2 w 12 h 2 12 q h u 1 z b x h 2 12 q x h 2 12 q h u 1 z b h x mathematically eq 15 16 are statements to be satisfied during the solution procedure their inclusion into the numerical scheme is discussed in the next section 2 4 turbulence closure turbulence closure for the stress tensor terms in eq 10 11 and 13 14 is required according to khan and steffler 1996a the turbulent normal stresses can be neglected as the lowest order of approximation e g 17 σ x σ z 0 the turbulent shear stress is considered to vary linearly between its value at the bed τ b and zero at the free surface cantero chinchilla et al 2018 resulting 18 τ x z τ b 2 the bed shear stress τ b is modelled using the manning s equation as follows 19 τ b ρ g n 2 u b 2 w b 2 h 1 3 where n is the manning s roughness parameter note that the vertical velocity component w b is accounted for in the estimation of the bed shear as required to model flows in steep slopes castro orgaz and hager 2017 2 5 rationale in the development of weighted averaged equations in principle the modeller is free to specify any function for the field variables instead of using eq 1 3 however there are some guiding principles first the vam model is designed as an improvement of the standard non linear swe by introducing perturbation parameters to deviate the flow from hydrostatic pressure conditions with a horizontal kinematic field with depth independent velocity therefore 4 perturbations parameters were introduced into the predictors for u w p namely u 1 w 2 p 1 p 2 the main rule is that the number of perturbation parameters must be compatible with the number of pdes available on inspecting eq 11 namely the z momentum equation it can be observed that the perturbation parameter p 1 is basically determined by this law appendix 1 therefore with 3 moment equations available moment of continuity x momentum and z momentum 3 degrees of freedom can be defined by the modeller in our case these were used by defining the perturbation parameters u 1 w 2 p 2 in the vam model the water depth h is determined by the continuity eq 9 the discharge q by the x momentum eq 10 the perturbation parameter p 1 by the z momentum eq 11 the depth averaged vertical velocity which includes the effect of w 2 is subjected to the statement given by eq 12 in addition to the kinematic boundary conditions eq 7 8 the velocity perturbation u 1 is determined by the moment of x momentum eq 13 and the pressure perturbation parameter p 2 by the moment of z momentum eq 14 another aspect to consider is that the perturbation parameters should appear in the corresponding transport equations as explicitly as possible to facilitate numerical implementation the polynomials used in eq 1 3 preserve this feature as described above if additional degrees of freedom were needed it would be possible to generate additional moment equations using supplementary weighting functions connected to this point the specific weighting function that we used is linear e g φ 2 z z h equivalent to taking moments with respect to the centroid of the flow section the test function to be used is another feature to be decided by the modeller here following steffler and jin 1993 we selected a linear test function guided by basic galerkin ideas as follows let us consider our test function written as φ 2 y h 1 where y is the vertical distance above the channel bed it can be easily observed that φ y h 1 1 φ y h 0 1 and φ y h 1 2 0 in the standard galerkin method the shape functions used to approximate the field variables are taken equal to the test functions in our case this rule was adopted as a guiding principle while defining the perturbation of the u velocity profile eq 1 the perturbed component for the velocity profile is therefore δu u 1 2 y h 1 u 1φ the specific polynomials and test functions used to produce a weighted averaged model are degrees of freedom available for the modeller there is not a rigid or unique choice in our vam model the simplest improvement of the u velocity profile over the swe was adopted namely a linear predictor and a closely related test function was therefore selected the remaining field variables were defined by using polynomials with several perturbation parameters it is known from the boussinesq equations that a linear vertical velocity profile is compatible with a depth independent u velocity u 0 q h castro orgaz and hager 2017 therefore to improve its modelling the linear law was deviated to a quadratic law by introducing the perturbation parameter w 2 a quadratic predictor was also defined for the pressure profile using the two remaining parameters p 1 and p 2 while p 1 is a parameter appearing in the reduced boussinesq type version of the vam model appendix 1 p 2 is not which is thereby closed by the moment of z momentum equation the total number of perturbation parameters was ensured to be identical to the available equations for model closure 2 6 vam relation to boussinesq and single layer non hydrostatic models in this section the vam model is compared to boussinesq and single layer non hydrostatic models note that if u 1 w 2 p 1 p 2 0 eq 9 10 reduce to the swe therefore the moment equations and the vertical momentum equation are not needed for model closure e g only h and q are computed now consider the case where u 1 w 2 p 2 0 that is the only perturbation parameter retained is p 1 this special case of the vam model is called va vertically averaged model the reduced governing eq 9 11 are stated and suitably manipulated in appendix 1 in this case it can be observed that the remaining perturbation parameter p 1 is mathematically determined by the vertical momentum balance i e the moment equations are not needed manipulation of p 1 in appendix 1 indicated that it can be expressed as a function of the horizontal velocity field derivatives u 0 x 2 u 0 x 2 2 u 0 x t and topography terms accounting for the spatial variations of the bed therefore p 1 is determined by a boussinesq type mathematical relation when the expression of p 1 is inserted into the x momentum balance the vam model is reduced to two pdes the continuity and x momentum balances the latter being a boussinesq type equation setting p 2 0 and retaining p 1 amount to assume that the vertical distribution of fluid pressure is non hydrostatic and linear see eq 3 therefore for u 1 w 2 p 2 0 the vam model reduces to a boussinesq type model based on a linear non hydrostatic vertical pressure distribution this type of boussinesq type model was used by khan and steffler 1996a and cantero chinchilla et al 2016 boussinesq type models based on serre 1953 however are from a parabolic pressure distribution castro orgaz et al 2015 compared boussinesq type models based on linear and parabolic pressure distributions and concluded that both approximations produce models that are structurally identical having identical non hydrostatic terms albeit with a different constant in the dispersive term affected by u 0 x 2 u 0 x 2 and 2 u 0 x t this factor affects the dispersion features of the ensuing boussinesq type model for a linear non hydrostatic pressure distribution the linear dispersion relation corresponding to the equations stated in appendix 1 is castro orgaz and hager 2017 c g h 0 1 2 1 1 1 4 k h 0 2 1 2 where c is the celerity h 0 the still water depth and k the wave number for the parabolic pressure distribution of the serre green naghdi equations the linear dispersion relation reads castro orgaz and hager 2017 c g h 0 1 2 1 1 1 3 k h 0 2 1 2 therefore the va model a reduced version of the vam model is a boussinesq type model with a different dispersion relation to that of the serre green naghdi equations now let us consider multilayer models in the single layer case in these models the pressure is split in hydrostatic and non hydrostatic components for a single layer the discrete vertical momentum balance produces an equation for the non hydrostatic bottom pressure zijleman and stelling 2005 e g p 1 in our nomenclature the contribution of this non hydrostatic pressure into the x momentum balance is discretized by using a trapezoidal rule thereby resulting a discrete equation which is identical to that derived for our vam model when u 1 w 2 p 2 0 that is the discretization used in non hydrostatic single layer model amounts to assume that the distribution of fluid pressure across this layer is basically linear this procedure is used in swash zijlema et al 2011 further in the single layer models of yamazaki et al 2008 swash zijlema et al 2011 or fang et al 2015a b the convective vertical acceleration is neglected for the computation of p 1 whereas our vam and reduced va models fully account for both local and convective vertical accelerations thereby resulting in an improvement therefore the va model a special case of the vam model is equivalent to a single layer non hydrostatic depth averaged model then the question is why using vam equations instead of boussinesq equations either in the serre green naghdi or single layer non hydrostatic frameworks the vam model is considered here an alternative no substitute to boussinesq equations however the reasons for considering the vam model as viable alternative are twofold i the vam equations can model dispersive effects up to the quite large value kh 0 8 see appendix 2 for demonstration without introducing any tuning into the governing equations to improve the modelling of short waves by comparison with the standard serre green naghdi equations serre 1953 and the dispersion optimized nwogu equations nwogu 1993 it was concluded that the limits of validity for these two boussinesq systems are kh 0 1 85 serre green naghdi and kh 0 4 75 nwogu dispersion optimized appendix 2 therefore the vam model improves the dispersive modelling of short waves as compared to optimized boussinesq equations without any empirical tuning ii wave breaking criteria is not needed in the vam model given that the vertical profile of horizontal velocity u is modelled the wave breaking mimicking ability of the vam model is due to the modelled velocity profile which introduces differential advection of momentum 1 3 u 1 2 h x thus in waves approaching breaking this horizontal momentum partially balances the effects of the dynamic component of fluid pressure accounted for in the vam model by the perturbation parameters p 1 and p 2 the result is that the model simulates broken waves as shocks in boussinesq type models it is necessary a wave breaking criteria to define the onset of wave breaking and a wave breaking model the wave breaking criteria is usually conducted with simultaneous applications of several empirical conditions checking the wave steepness and the vertical celerity of displacement kazolea and ricchiuto 2018 an accepted manner to mimic breaking once the onset of breaking is detected in a portion of the wave is to switch off dispersive terms and solve the non linear shallow water equations in the flagged cells brocchini 2013 castro orgaz and hager 2017 boussinesq type equations are valuable numerical tools by improving the linear dispersion relation and implementing a wave breaking criterion and breaking module the vam model can simulate the same flows without tuning the dispersion relation introducing empirical conditions to detect wave breaking and implementing a wave breaking model the governing equations of the vam model permit a reasonable reproduction of these features automatically boussinesq type models formulated in terms of the depth averaged velocity are limited to the modelling of long waves barthélemy 2004 two of the most used approaches for improving these models are i adding to the x momentum balance a correction term with a free parameter to be optimized madsen et al 1991 and ii formulate the boussinesq equations in terms of the horizontal velocity at an arbitrary elevation to be optimized nwogu 1993 following either of the two methods the dispersive features of the boussinesq type equations are greatly improved once the free parameters are optimized herein we retained the formulation of the vam equations in terms of the depth averaged velocity given that the dispersive properties were satisfactory at least from intermediate to shallow water depths as shown in the results section however should the vam equations be optimized the dispersive characteristics could be improved further in principle any of the techniques already used for boussinesq type equations can also be applied to optimize the vam system note that the weighting function used in this work namely φ 2 z z h is not the only possible choice and thus not necessarily the best for modelling short waves given the development of the vam equations under the umbrella of galerkin methods a possible additional path is choosing the weighting function for the vertical integration to optimize dispersive properties 2 7 vam governing equations matrix form using eq 9 and accounting for the turbulence closure by eq 17 18 the system of conservation laws given by eq 9 11 and 12 14 can be written in conservative form as follows 20 u t f x s o s τ where u f and s are respectively the vector of flow conservative variables fluxes and source terms which read 21 u u 1 u 2 u 3 u 4 u 5 h q h w u 1 h 2 w 12 f q q 2 h g h 2 2 q w q u 1 h h q w 12 u 2 u 2 2 u 1 g u 1 2 2 u 2 u 3 u 1 u 2 u 4 u 1 u 2 u 5 u 1 22 s o 0 x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ g h z b x p 1 ρ z b x 1 6 h u 1 w x p 1 ρ 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x h w 2 q x q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 2 h p 2 3 ρ s τ 0 τ b ρ τ b ρ z b x 1 2 ρ h τ b x 0 h τ b 2 ρ z x z b x where u 1 u 5 are the conservative flow variables the subscripts o and τ refer respectively to the inviscid and the turbulent stress source terms the system of eq 15 16 and 20 conforms the vam model khan and steffler 1996a b cantero chinchilla et al 2018 3 numerical scheme a semi implicit hybrid finite volume finite difference scheme developed by cantero chinchilla et al 2018 is used to solve the vam system of pdes the numerical scheme is summarized below 3 1 solution strategy the vam model can be solved using a splitting approach first the homogeneous solution of eq 20 is determined using the finite volume method then the homogeneous solution is updated introducing the effects of the inviscid and turbulent source terms in two subsequent steps using a centred finite difference scheme the steps are detailed below finite volume step the homogeneous part of eq 20 23 u t f x 0 is solved explicitly using as initial condition the known value of u at k where k is the current time level index the solution obtained by the finite volume method is called u ˆ note that since the mass conservative eq 9 lacks from source terms the solution of h at k 1 is directly gained from eq 23 yielding h k 1 h ˆ inviscid finite difference step the homogeneous solution u ˆ is updated using a finite difference centred scheme designed to incorporate implicitly the non hydrostatic pressure effects into the velocity field the equation solved is 24 u t s o u in this step the reactive eq 15 16 shall be accounted for while solving eq 24 the implicitly updated solution in this step is called u details in section 3 3 turbulent finite difference step the turbulent reynolds source terms s τ are used explicitly to update the intermediate solution u the equation modelled is 25 u t s τ u and the solution is the final value of u at time k 1 details in section 3 4 in the following sections the numerical techniques used for the solution of eq 23 25 are briefly described further details are available in cantero chinchilla et al 2018 3 2 finite volume step the numerical method in this step is based on a godunov type finite volume scheme dividing the x t plane into quadrilateral finite volume cells of dimensions x i 1 2 x i 1 2 t k t k 1 the integral form of eq 23 is toro 2001 2009 26 u ˆ i u i k δ t δ x f i 1 2 f i 1 2 where u and f are space and time averaged vectors respectively i is the cell index δx is the x dimension of the control volume δt is the t dimension of the control volume the indexes i 1 2 refer to the control volume interfaces between cells i and i 1 the main ingredient of a godunov type scheme is the evaluation of the numerical flux f i 1 2 solving a number of local riemann problems formed at each cell interface after the reconstruction of the vector u within the cells a special feature of depth averaged non hydrostatic modelling of water waves is that the mathematical form of the dispersive terms is similar to that of the truncation errors from saint venant type hydrostatic leading terms castro orgaz and hager 2017 as previously highlighted the vam model contains embedded boussinesq type terms through the effect of p 1 appendix 1 consider finite differencing to second order accuracy of the first order derivative in the shallow water components of the vam model e g u 0 x u 0 i 1 u 0 i 1 2δx o δx 2 this discretization produces in the saint venant terms truncation errors proportional to u 0xxx the mathematical form of these truncation errors is the same as that of the boussinesq type term h 3 u 0 u 0xx 4 x in the x momentum balance appendix 1 if expanded truncation errors introduce numerical dispersion that may mask the true physical dispersion of the vam model therefore higher order differencing of leading order hydrostatic saint venant terms is required it is typical in ocean modelling while solving boussinesq type equations to adopt a high order reconstruction of u within the cells a fourth order total variation diminishing monotone upstream centred scheme for conservation laws is considered in this work muscl tvd 4th yamamoto and daiguji 1993 kim et al 2009 kim and lynett 2011 cantero chinchilla et al 2016 for the vam equations besides for the cell reconstruction the minmod limiter is applied a second order muscl can also be implemented in the vam model but a finer mesh would be needed to control truncation errors during the reconstruction of the flow depth over topography unphysical numerical flux may be generated if it is not controlled the main point is the choice of either the water depth or the free surface as variable to reconstruct in this work the weighted surface depth gradient method wsdgm aureli et al 2008 is adopted which provides a weighted reconstruction of the flow depth using the surface and depth gradient methods sgm and dgm respectively while the sgm performs a reconstruction of the free surface level z s at the cell interfaces the dgm reconstructs the flow depth h the wsdgm is simple to implement and produce robust and stable reconstructions to reduce computational time the approximate riemann solver hllc toro 2001 2009 is implemented which accounts for contact waves in the solution in our case physically representing the propagation of the conservative variables u 3 u 4 u 5 in the riemann problems formed at each cell interface 3 3 inviscid finite difference step using a backward euler formula for the time derivative eq 24 is implicitly approximated as follows 27 u i u ˆ i δ t s 0 u i equations 10 11 13 and 14 are discretized with the formula developed in eq 27 the reactive eqs 15 and 16 are individual mathematical statements to be satisfied during the implicit newton raphson scheme and hence not accounted for in eq 27 the spatial derivatives are approximated using second order central finite differences setting initial values for q u 1 p 1 p 2 w and w the vector of errors is 28 e u i m u ˆ i δ t s 0 u i m where m is a recursion index an analytical jacobian matrix j is determined to progressively reduce the errors using the newton raphson method unknown values for the variables q u 1 p 1 p 2 w and w are determined in the cells i 1 i and i 1 resulting in a 6n 6n diagonal matrix j with 108 analytical terms per cell where n is the number of finite volumes in each iteration the matrix equation to solve is 29 e j d u i where d u i is the vector of corrections once the matrix inversion is accomplished in eq 29 the update of the solution is given by 30 u i m 1 u i m d u i where u i m 1 is the updated solution the process depicted with eq 28 30 is repeated until convergence the j matrix is frozen during the iterations for each time step this permits to save up to 30 of the computational cost cantero chinchilla et al 2018 here the convergence criterion by khan and steffler 1996a is adopted e g the iterations stop if the mean relative error is below a prescribed tolerance in this work 10 6 is considered as the tolerance 3 4 turbulent finite difference step eq 25 is explicitly solved using a forward euler formula as 31 u i k 1 u i δ t s τ u i where the spatial gradients are discretized using central finite differences the time step δt is subjected to the courant friedrich lewy cfl condition to ensure numerical stability it is 32 δ t c f l δ x u 0 c where c gh 1 2 is the long wave celerity by numerical experimentation it was found that the scheme is stable for cfl 0 5 3 5 numerical sequence the numerical sequence is depicted in the flow chart presented in fig 2 and is summarized as follows i the initial conditions are set for h u 0 and z b whilst u 1 w 2 p 1 and p 2 are initiated as zero vectors cfl δx and the computational time are also fixed ii the vector solution of u at k is formed using the previous values for the flow variables iii the cfl condition is checked and δt is computed from eq 32 iv the muscl tvd 4th scheme is applied to reconstruct the flow variables at the cell interfaces the term gh z b x in eq 10 is discretized using a well balanced scheme to avoid numerical instabilities v the hllc approximate riemann solver is used to compute the numerical fluxes at the cell interfaces vi the explicit homogeneous time step in eq 26 is solved to obtain u ˆ and h k 1 vii the implicit inviscid step in eq 27 is computed using u ˆ as initial vector resulting the implicitly updated solution u after the application of the newton raphson method viii the explicit turbulent time step in eq 31 is solved to update u and obtain the final solution of u at k 1 ix steps ii vii are repeated until the target computational time is reached 4 model validation tests the ability of the vam model to approximate nearshore flows involving wave breaking and transformation processes is tested in this section the vam model capabilities to handle non linearity dispersion wave breaking bore propagation and sheet flow are studied using challenging test cases first the propagation of sinusoidal waves over submerged bars is modelled to assess the frequency dispersion features of the vam model analytically discussed in appendix 2 then the same data set is used to conduct a convergence test to the numerical scheme given the lack of known analytical solutions to the vam model even in the simple case of solitary wave propagation later the wave transformation and overland flow phenomena over reef environments are analyzed including dry flat reef wet flat reef and exposed reef crest cases finally wave collision and reflection are explored all the results of the vam model are compared with those obtained through a boussinesq type version of the vam model see appendix 1 and with laboratory measurements 4 1 wave propagation over submerged bars to test the capability of the vam model to simulate short waves experimental data related to the transformation of sinusoidal waves over submerged bars by beji and battjes 1993 were used these tests were conducted in a 37 7 m long 0 8 m wide and 0 75 m high wave flume at the delft university of technology the experiments consisted on the propagation of sinusoidal waves over a submerged bar with a 1 20 upward slope a 2 m long flat crest and a 1 10 downward slope the height of the horizontal crest was 0 3 m the water depth varied from 0 4 m in the deeper region to 0 1 m over the crest fig 3 the sinusoidal waves were generated by a piston type random wave generator at the beginning left boundary fig 3 of the channel and a 1 25 slope plane beach was used as wave absorber at the end right boundary fig 3 of the channel the free surface levels were measured by means of 12 gauges located at the positions indicated in fig 3 the test analyzed in this work consisted of waves with amplitude of 0 01 m and period of 2 02 s the numerical parameters used for both the vam model and the boussinesq type version of the vam model were δx 0 02 m and cfl 0 1 details of the numerical flume for this test including wave generation and boundary conditions are detailed in appendix 3 the time series of free surface elevations obtained with both models at the gauge positions along with the measured data are shown in fig 4 as these relatively long waves propagate over the submerged bar they lose their symmetry significantly and super harmonics are generated thus the regular long waves generated by the paddle are transformed into irregular short waves induced by the presence of the submerged bar as can be observed in fig 4 the computational results generated with the vam model are in very good agreement with experiments including the reproduction of the super harmonics measured by gauges 9 to 11 only some overestimations of the wave peaks over the submerged bar were obtained with the vam model gauges 5 to 8 notable differences are observed between the vam model and the boussinesq type version of the vam model in this test especially at the locations of gauges 8 to 11 where the effect of the frequency dispersion is significant at these positions the predictions by the vam model are considerably more accurate fig 4g j indicating that the vam model reproduces the combined effects of frequency dispersion and non linearity in a more successful way using the experimental data by beji and battjes 1993 at gauges 1 4 7 and 9 a convergence test to the numerical scheme was conducted fig 5 taking the accurate vam simulation of fig 4 with δx 0 02 m and cfl 0 1 as reference the numerical parameters were varied as follows i the cfl was raised to 0 3 while maintaining δx 0 02 m to investigate the time step effect on the numerical scheme and ii the δx was raised to 0 05 m while maintaining cfl 0 1 to investigate the grid spacing effect as it can be observed in fig 5 and table 1 the numerical results tend to collapse with the experimental data when both δx and cfl are reduced thereby demonstrating that the qualitative solution is mesh sized independent 4 2 wave transformation over reef environments fringing reef environments are common in tropical and sub tropical regions across the globe in these coastal areas wave energy dissipation occurs due to both the wave breaking at the reef front and the inshore rough reef flat extending toward the coastline lugo fernández et al 1998 brander et al 2004 wei and jia 2014a in this region the wave trains become highly non linear and frequency dispersive and discontinuous flows eventually emerge after breaking roeber et al 2012 since the complexity of flow is high in this context it poses a proper test to evaluate the robustness of the vam model thus in this section the experimental data by roeber 2010 generated in three different flume setups fig 6 are used to evaluate the ability of the vam model to describe non linear dispersive waves and bore propagation over fringing reefs involving wave breaking 4 2 1 solitary wave transformation on a dry reef flat the experimental data for solitary wave transformation over a steep fore reef and a dry flat inland shore by roeber 2010 is selected for this test referred as test 1 the experiment was conducted in a 48 8 m long 2 16 m wide and 2 1 m high flume at the tsunami wave basin of the oregon state university the experimental flume was divided into three zones i flat reach for the first 17 m ii flat ramp of slope 1 5 for the next 5 m until 1 m height and iii flat reach at 1 m height for the next 23 m ending in a rigid vertical wall fig 6a the solitary wave was generated in the non elevated horizontal reach by a piston type wave maker installed at the end of the flume to maintain dry bed conditions in the offshore flat reef 1 m water depth was prescribed h 0 then a solitary wave of amplitude a 0 5 m was generated and propagated towards the reef leading to a h 0 0 5 during the computations δx 0 1 m cfl 0 1 and n 0 014 sm 1 3 were maintained higher values of cfl were feasible but it was kept small to reduce truncation errors for the initial conditions a solitary wave solution was located at x 10 m at t g h 0 0 5 44 79 according to roeber 2010 where h 0 is the still flow depth to generate the initial solitary wave solution due to the lack of analytical solutions for the vam model the serre green naghdi sgn analytical solution by carter and cienfuegos 2011 was used to initialize the transient solitary wave solution by the vam model cantero chinchilla et al 2018 during this process the initial wave deforms and is progressively adapted to a stable profile the solitary wave amplitude in the sgn solution was then iterated until reaching the desired amplitude for the test the technique to generate the solitary wave solution of the vam model is therefore numerical and iterative but the resulting solution is more accurate than those obtained from the sgn equations cantero chinchilla et al 2018 this process was repeated for the tests of this study which involve solitary waves fig 7 shows the free surface levels predicted by the vam model as compared to the experimental data by roeber 2010 for dry offshore reef flat at different non dimensional times t g h 0 0 5 52 79 figs 7a 54 79 fig 7b 56 79 figs 7c 58 99 fig 7d 59 79 figs 7e 61 69 fig 7f 63 09 figs 7g 65 44 fig 7h 69 44 figs 7i and 74 79 fig 7j note that no wave reflection at the rigid wall end was produced for the computational time tested the solitary wave deforms as it approaches to the fore reef leading to a notable wave skewness increase before collapsing this skewness is successfully reproduced by both the vam model and the boussinesq type version of the vam model fig 7a b the agreement with the experimental data is excellent overall where the advancing bore over the offshore reef and the receding flow in the vicinity of the reef vertex are particularly well approximated fig 8 depicts the evolution of the main perturbation parameters of the vam model p 1 p 2 and u 1 as well as u s and u b at three consecutive times for the dry offshore bed the instants are selected to analyse the nearshore features while approximating the shoreline fig 8a yielding a wave breaking in the surf zone fig 8b and leading to a propagating bore once the wave is broken fig 8c while the solitary wave is approaching to the surf zone the non hydrostaticity prevails over the non uniformity of the horizontal velocity field yielding greater p 1 values fig 8c and lower u 1 values fig 8b this behaviour reverts as the wave breaks on the surf zone then u 1 grows leading a difference between u s and u b enough to produce wave breaking fig 8e triggering the dissipation energy mechanism that ultimately reduces the non hydrostaticity of flow fig 8i for a more detailed evaluation of the vam model the time series of the free surface level at six gauges are approximated as shown in fig 9 the six gauges were located at x 17 m fig 9a x 19 m fig 9b x 21 m fig 9c x 23 m fig 9d x 25 m fig 9e and x 29 m fig 9f where x is measured from the left end of the flume again both the vam model and the boussinesq type version of the vam model provide an excellent approximation of the experimental data in the time series where only the fluctuating position near the reef vertex is misplotted fig 9d 4 2 2 solitary wave transformation on a wet reef flat in this section the experimental test for solitary wave transformation over a fore reef and a wet flat inland shore by roeber 2010 is analyzed the experiment was conducted in a 104 m long 3 66 m wide and 4 57 m high flume at the tsunami wave basin of the oregon state university a solitary wave with a 1 23 m was generated at the horizontal deep zone by a piston type wave maker at x 0 m this zone extends until x 25 9 m fig 6b then the solitary wave propagates over a fore reef with a relatively gentle slope 1 12 until x 54 15 m and a wet offshore reef flat until x 83 7 m where a rigid vertical wall was placed the deepest flow depth was h 0 2 46 m while the flow depth over the offshore reef flat remained equal to 0 1 m δx 0 2 m cfl 0 1 and n 0 014 sm 1 3 were prescribed for the computations the initial conditions consisted of a solitary wave solution located at x 17 6 m at t g h 0 0 5 54 3 roeber 2010 fig 10 shows the vam model results as compared with the experimental data by roeber 2010 at eight different non dimensional times t g h 0 0 5 62 3 figs 10a 64 3 fig 10b 65 8 figs 10c 67 1 fig 10d 69 8 figs 10e 73 fig 10f 76 3 figs 10g and 93 2 fig 10h it is worth noting that wave breaking is prominent for this test which occurred around t g h 0 5 64 roeber 2010 the jet from the plunging breaking wave then hits the water surface and generates a bore that propagated over the wet reef and was reflected by the landward boundary in this case the wave breaking is successfully reproduced by the vam model whereas the boussinesq type version of the vam model overestimates the free surface level and wave height at breaking in addition the free surface time series are evaluated by the vam model at six different gauge positions x 35 9 m fig 11 a x 44 3 m fig 11b x 48 2 m fig 11c x 50 4 m fig 11d x 57 9 m fig 11e and x 65 2 m fig 11f without any explicit criterion for wave breaking the vam model shows its capability to approximate the unsteady transient flow providing an accurate description of the wave breaking bore front and dispersive waves after reflection these results are relevant since they show that the dependency of depth averaged models on any wave breaking prescription can be dropped note that the results of the boussinesq type version of the vam model without prescribing any explicit criterion for wave breaking overestimate the experimental free surface elevations at the breaking zone as can be observed in fig 11d 4 2 3 solitary wave transformation on an exposed reef crest the experimental data of wave transformation on an exposed reef crest by roeber 2010 are selected here for comparison purposes exposed reef crests located between the fore reef and the reef flat are typical in fringing reef environments roeber 2010 the experiment was conducted in the wave flume described in the previous section the geometrical configuration consisted of an offshore flat a fore reef with a slope of 1 12 and a reef crest with a height of 0 2 m fig 6c the reef crest was initially emerged 6 cm with a 14 cm depth lagoon located from the crest toward the landward boundary of the flume the experiment consisted of the propagation of a solitary wave generated at the deep horizontal left boundary of the flume the amplitude of the solitary wave was a 1 25 m and the still water depth h 0 2 5 m leading to a h 0 0 5 although lower a h 0 ratios are available in roeber et al 2010 and wei and jia 2014a for this test case a h 0 0 5 is selected here to represent the most highly non linear challenging test among the roeber s setups the computations were conducted by maintaining δx 0 2 m cfl 0 1 and n 0 014 sm 1 3 following the same procedure as described in previous sections the initial solution corresponded to a solitary wave solution located at x 17 6 m at t g h 0 0 5 47 11 roeber 2010 fig 12 shows the vam model results in comparison with the measured free surface levels at ten different non dimensional times t g h 0 0 5 54 91 figs 12a 57 61 fig 12b 59 31 figs 12c 60 86 fig 12d 62 21 figs 12e 65 41 fig 12f 68 61 figs 12g 80 11 fig 12h 91 26 figs 12i and 100 61 fig 12j wave shoaling occurs over the fore reef the profile of the solitary wave adopts a near vertical form and then the wave breaks near the top of the crest around t g h 0 5 59 after breaking wave overtopping occurs and the generated bore wave advances over the wet offshore reef flat the bore is then reflected by the rigid vertical flume end and the reflected wave ultimately overtops the reef crest leading to dispersive waves all these hydraulic processes which are illustrated by the experimental data shown in fig 12 are accurately mimicked by the vam model the model detects the wave breaking that would not be otherwise accounted by conventional depth averaged models the backward flow and the dispersive wave zone beyond the crest are also well simulated by the numerical model importantly the vam model results shown in fig 12 are in agreement with the results of the boussinesq type model by roeber 2010 and the cddhe2d nhwave boussinesq type model by wei and jia 2014b whilst roeber 2010 used an empirical wave breaking criterion based on the averaged momentum flux to deactivate the dispersion terms wei and jia 2014b applied an especial finite volume discretization of the advection terms to account for the wave breaking phenomena with eddy viscosity however the vam model is able to reproduce the advection dominated processes that define the wave breaking phenomena at the free surface of advancing waves without using any empirical condition to detect breaking or especial numerical treatments the ability to reproduce breaking waves is therefore inherent to the vam model if boussinesq type models are applied without implementing wave breaking they provide results that overestimate the free surface and wave height at the breaking zone figs 10 and 12 the capability of the vam model to simulate the free surface levels in this test is also assessed using the free surface time series by roeber 2010 at six gauges located at x 44 3 m fig 13 a x 48 2 m fig 13b x 50 4 m fig 13c x 57 9 m fig 13d x 65 2 m fig 13e and x 80 m fig 13f in this figure it is observed that the boussinesq type version of the vam model not only overestimates the free surface at the breaking zone but also at the reef flat fig 13e the greater differences occur after the reflection of the wave at the right boundary fig 13f 4 3 wave reflection a key hydraulic process for numerical coastal model validation is wave reflection which involves wave superposition and gains importance near marine infrastructures determining design criteria these hydraulic processes are challenging tests for numerical models highly non linear and accurate frequency dispersive models are required to prescribe an accurate description of these processes while using the depth averaging technique cea et al 2007 in this section the vam model is validated against wave superposition and wave reflection in coastal environments using the experimental data by craig et al 2006 and briggs et al 1996 respectively 4 3 1 collision of solitary waves the experimental data for two solitary waves propagating in opposite directions by craig et al 2006 are selected here to test the capability of the vam model to approximate wave superposition the experiment was conducted in a 13 165 m long 25 4 m wide flume at the w b prichard fluid mechanics laboratory of penn state university the water depth for the experiments was 5 cm and the solitary waves were generated by a piston like paddle water surface values were collected by a bottom mounted pressure transducer and four non contacting wave gauges to reproduce the asymmetric head on collision of solitary waves a first solitary wave was generated this wave was propagated towards the end of the channel and reflected then the reflected wave with amplitude equal to 1 217 cm collided with a second solitary wave generated by the paddle with amplitude of 1 063 cm for a detailed description of the experiments the reader is referred to hammack et al 2005 and craig et al 2006 the numerical simulation was accomplished by maintaining δx 0 01 m and cfl 0 1 while the roughness was kept to n 0 005 sm 1 3 to represent the glass material of the flume following the procedure to generate solitary wave solutions by the vam model described in previous sections the initial conditions for this test consisted of two opposing solitary waves with a 1 063 cm and a 1 217 cm at x 1 255 m and x 2 349 m respectively fig 14 compares the vam model results with the experimental data by craig et al 2006 at t 18 299 s fig 14a t 18 800 s fig 14b t 19 052 s fig 14c t 19 101 s fig 14d t 19 150 s fig 14e t 19 193 s fig 14f t 19 329 s fig 14g and t 19 501 s fig 14h the agreement between the vam model simulation and the experimental data is excellent only small discrepancies are found in the predicted maximum amplitude of the superposed waves in fig 14c and the solitary wave to the right in fig 14g the main differences between the vam model results and those obtained with the boussinesq type version of the vam model occur after the collision of the incident and reflected waves fig 14e and f 4 3 2 solitary wave reflection on a vertical wall to evaluate the capability of the vam model to approximate tsunami like reflection waves the experimental data by briggs et al 1996 are used in this section the experiments were conducted in a wave flume with a length of 23 23 m and a width of 0 45 m the flume bed configuration simulated the bottom profile of the revere beach in massachusetts comprising i a flat section in the seaward boundary ii three sections with different slope values from left to right 1 53 1 150 and 1 13 and iii a vertical wall at the landward boundary of the flume the water depth for the experiments was h 0 0 218 m two different tests were carried out with relative wave heights a h of 0 039 and 0 246 fig 15 representing a small wave that does not break and a larger wave that breaks before the wall respectively a detailed description of the experiments can be found in briggs et al 1996 different numerical conditions are prescribed for the two tests by numerical experimentation the test with a h 0 039 was observed to be less sensitive to the numerical parameters while the test with a h 0 246 showed a high dependency on these parameters thereby δx 0 05 m cfl 0 1 and n 0 014 sm 1 3 were prescribed for the test with a h 0 039 whereas δx 0 02 m cfl 0 1 and n 0 005 sm 1 3 were used for the test with a h 0 246 fig 16 shows the time series of the measured and modelled free surface elevations at different positions across the flume for the test with a h 0 039 namely x 15 04 m fig 16a x 17 22 m fig 16b x 19 4 m fig 16c x 20 86 m fig 16d and x 22 23 m fig 16e at the same locations the comparison for the test with a h 0 246 is depicted in fig 17 in the first case the numerical results fit the experimental measurements of the free surface for both the incident and the reflected waves fig 16 a small lag is observed for the reflected wave at x 15 04 m but the differences between measured and modelled elevations are lower than 0 004 m as highlighted by wei at al 2014b the slight differences after the passage of the reflected wave at x 19 4 m x 20 86 m and x 22 23 m are influenced by the experimental setup the main differences between the predictions of the vam and the bousinessq type models were obtained for the peaks of the reflected wave fig 16 on the other hand in the test with a h 0 246 fig 17 wave breaking occurs near the wall despite this fact the model predictions generally reproduce the temporal evolution of the measured water surface at the different positions however the model underestimates the peaks of both the incident and reflected waves for the incident waves a high dependency on the roughness parameter was observed by numerical experimentation which produced a progressive deterioration of the solution in the case of the reflected wave a phase lag is observed between experimental data and model predictions fig 17a d which is however corrected in fig 17e it is worth noting that the phase lag observed in the reflected wave with regards to the experimental data is also observed by wei and jia 2014a via application of a boussinesq type model these authors concluded that the phase lag could be due to an over prediction of the wave peak yielding a faster wave which may be the case in the present simulation near the vertical wall in this case significant differences are observed between the results of the vam model and those obtained with the boussinesq type version of the vam model for both the incident and reflected waves the differences not only consist of variations in the magnitude of the wave peaks but there is also a phase lag between the waves predicted by both models especially notable in the reflected wave 5 conclusions in this study the vertically averaged and moment equations vam method is used to model non hydrostatic flows in coastal areas this approach which has been almost unexplored in this area as compared to boussinesq type models is applied to reproduce flows and wave processes in the nearshore region envisaging wave breaking and superposition phenomena to that end a semi implicit finite volume finite difference numerical scheme is used to solve the vam model showing robustness in all the tests conducted the capability of the vam model to approximate nearshore flows and intermediate water processes is validated through comparison with laboratory measurements the tests involved propagation of sinusoidal waves over a submerged bar convergence of the numerical scheme of the model propagation of solitary waves over fringing reef environments superposition of two counter propagating solitary waves and tsunami like reflection waves on a dike like wall the results showed mesh size independency and excellent agreements with the experimental data overall for weakly and highly non linear solitary waves the vam model produces a precise linear frequency dispersion relation very close to the exact solution castro orgaz and hager 2017 cantero chinchilla et al 2018 this permits an accurate description of both long and short waves the advection dominated wave breaking phenomena in the tests conducted are accurately reproduced by the vam model without using empirical wave breaking conditions or especial numerical treatments which is a common feature in non hydrostatic boussinesq type models used in ocean research these new findings of this work suggest the vam model as an interesting high resolution depth averaged non hydrostatic model with automatic wave breaking for coastal engineering applications the vam model is a suitable alternative to boussinesq type models which are widely used for design studies in harbours and other marine structures credit authorship contribution statement francisco n cantero chinchilla conceptualization methodology software validation formal analysis writing original draft writing review editing rafael j bergillos conceptualization methodology software validation formal analysis writing original draft writing review editing oscar castro orgaz conceptualization methodology software validation formal analysis writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the spanish research project ctm2017 85171 c2 1 r fncc and rb were partly funded by the spanish ministry of science innovation and universities through programa juan de la cierva 2016 fjci 2016 28009 and programa juan de la cierva 2017 fjci 2017 31781 respectively we thank the two anonymous reviewers of this work for the comments offered to improve it appendix 1 boussinesq type model as simplified case of the vam system consider the case where u 1 w 2 p 2 0 and the only perturbation parameter retained is p 1 the momentum balances eqs 10 and 11 are in this case 33 q t x g h 2 2 q 2 h x h p 1 2 ρ g h z b x p 1 ρ z b x τ b ρ 34 h w t q w x p 1 ρ τ b ρ z b x 1 2 ρ h τ b x with the depth averaged vertical velocity given by note that w 2 0 and thus the vertical velocity is linearly distributed to this degree of approximation 35 w w s w b 2 moreover the free surface and bed kinematic boundary conditions are respectively 36 w s h t u 0 x h z b 37 w b u 0 z b x using eq 35 37 and neglecting τ b for simplicity s sake eq 34 is rewritten as 38 p 1 ρ u 0 x 2 u 0 x t u 0 u 0 x x h 2 2 h d w b d t where it is observed that the perturbation parameter p 1 is determined by boussinesq type terms e g by u 0 x 2 u 0 x 2 and 2 u 0 x t serre 1953 and the topography term dw b dt where d dt t u 0 x is the depth averaged material derivative operator inserting eq 38 into eq 33 produces 39 q t x g h 2 2 q 2 h x u 0 x 2 u 0 x t u 0 u 0 x x h 3 4 h 2 2 d w b d t g h z b x u 0 x 2 u 0 x t u 0 u 0 x x h 2 2 h d w b d t z b x τ b ρ which is a boussinesq type momentum equation the continuity eq 9 and eq 39 form a reduced vam model of boussinesq type called here va model it is solved in this work using the same numerical scheme developed for the vam model appendix 2 frequency dispersion of the vam model for small amplitude waves propagating over a horizontal and frictionless channel with still water the flow depth can be split as h h 0 h where h is a perturbation from the static level the linearized equations for the vam model are steffler and jin 1993 40 h t h 0 u 0 x 0 41 u 0 t g h x 1 2 ρ p 1 x 2 3 ρ p 2 x 0 42 u 1 t 1 2 ρ p 1 x 0 43 p 1 ρ h 0 2 2 h t 2 h 0 2 6 2 u 1 x t 44 p 2 ρ h 0 8 2 h t 2 combining eqs 40 44 is quite tedious algebraically but entails no difficulty the resulting linearized vam equation for the free surface deflections is 45 2 h t 2 g h 0 2 h x 2 5 h 0 2 12 4 h t 2 x 2 g h 0 3 12 4 h x 4 h 0 4 144 6 h t 2 x 4 0 if a perturbation of the water surface of harmonic shape is assumed eq 45 produces the dispersion relation steffler and jin 1993 46 c 2 g h 0 1 1 12 k h 0 2 1 5 12 k h 0 2 1 144 k h 0 4 where c is the celerity and k the wave number the exact dispersion relation of the problem is castro orgaz and hager 2017 47 c 2 g h 0 tanh k h 0 k h 0 for further comparative purposes consider the 1d boussinesq equations of nwogu 1993 48 h t h u α x α 1 3 h 0 3 3 u α x 3 0 49 u α t g h x u α u α x α h 0 2 3 u α 2 x t 0 where u α is the velocity at an undetermined elevation z α and α is a calibration parameter the arbitrary elevation z α and the coefficient α in nwogu s theory are related by nwogu 1993 50 α 1 2 z α h 0 2 z α h 0 the dispersion relation for eqs 48 49 is nwogu 1993 51 c 2 g h 0 1 α 1 3 k h 0 2 1 α k h 0 2 the optimized value of α 0 39 by nwogu is used in the computations presented below the dispersion relation of the serre green naghdi equations is recovered for α 1 3 resulting 52 c 2 g h 0 1 1 1 3 k h 0 2 equations 46 51 and 52 are compared with eq 47 in fig 18 where the error of each approximation with respect to the exact result is depicted considering an error band of 5 the vam model is within the accuracy interval up to kh 0 8 whereas these limits are kh 0 1 85 and kh 0 4 75 for the serre green naghdi and nwogu dispersion optimized equations respectively therefore the vam model improves the dispersive modelling of short waves as compared to optimized nwogu s boussinesq equations without any empirical tuning allowing modelling of dispersive effects up to a quite large value fig 18 small amplitude waves comparison of vam with boussinesq type approximations fig 18 appendix 3 numerical flume for the submerged bar test for the test of wave propagation over a submerged bar by beji and battjees 1993 implemented in section 4 1 the generation of piston type sinusoidal waves was accomplished by inserting a source term s w to the mass conservation equation eq 9 the source term used for wave generation is cantero chinchilla et al 2018 53 s w x t d exp ξ x x s 2 sin ω t in which 54 ξ 80 δ 2 l 2 55 d 2 ξ h 0 ω 2 α 1 g k 4 h 0 3 ω k π exp k 2 4 ξ 1 α k h 0 2 here ω is the wave frequency x s is the location of the center of the wave making mechanism δ is a parameter influencing the width of the wave generator function d is the source function for the amplitude h 0 is the wave amplitude α 0 39 and α 1 α 1 3 following kazolea et al 2014 x s 0 m δ 0 8 and h 0 l 0 11 were used in this numerical test to avoid numerically generated wave reflections at the boundaries and thus the contamination of the numerical solution sponge layers were implemented at both boundaries of the numerical flume for the free surface the damping function used in the work is kazolea et al 2014 56 m x 1 x x 1 l s where l s is the sponge layer width and x 1 is the initial coordinate of the sponge layer following kazolea et al 2014 the sponge layer width should satisfy l l s 1 5l where l is the wavelength hence l s 6 5 m was adopted a sketch of the numerical flume for the test conducted in section 4 1 is shown in fig 19 the sponge layer at the left hand side of the wavemaker permits to absorb the portion of the symmetrically generated sinusoidal waves travelling backwards thus this implementation ensures no wave reflection from the left boundary and therefore the gauges closer to the wavemaker i e gauge 1 2 and 3 are not subject to numerical noise fig 19 definition sketch of the numerical flume for the sinusoidal wave propagation over a submerged bar test by beji and battjes 1993 fig 19 
21709,in an array system of wave energy converters wecs hydrodynamic interactions between the wecs occur through the absorption radiation and diffraction of waves the main objective of this study was to analyse the hydrodynamic interactions between floating point absorbing wecs and the influence of this interaction on the power performance and fatigue life of the wecs mooring lines the hydrodynamic and structural response of the wec systems were analysed primarily using potential flow theory the morison equation and continuum mechanics theory four 2 wec models and two 10 wec models among which different separating distances and mooring configurations were considered were investigated the models were simulated for various environmental loading conditions the results from each simulation were evaluated in terms of the power performance of each wec accumulated fatigue damage in each mooring line and the levelised cost of energy lcoe the hydrodynamic interactions show a larger impact on the 10 wec simulation models to account for the hydrodynamic interactions in the simulations using the 10 wec models the fatigue damage in the mooring lines is varied at an average of 15 and a maximum of an order of magnitude difference a similar comparison of power performance showed an approximate difference in the results of 10 the lcoe calculation of the 10 wec array system showed lcoe values that range from 40 to 200 relative to the simulations that did not consider the hydrodynamic interaction effects comparatively the lcoe calculation of the 2 wec model either decreased by 17 or increased by 23 when the hydrodynamic interaction was included in the simulation model keywords fatigue analysis interaction effect levelised cost of energy mooring system power absorption wave energy converter 1 introduction an upscaling of the deployment of wave energy converters wecs by grouping multiple wecs into array farms is necessary to achieve cost efficient solutions for the commercial wave energy market ocean energy forum 2016 si ocean 2014 in array farms with oscillating bodies the wecs influence each other by mechanical coupling e g mooring or power cable interconnections and hydrodynamic interactions via the absorption radiation and diffraction of waves these interactions influence the overall energy production of the array farm the mechanical life of array components such as the mooring lines and the scheduled maintenance intervals investigations of the tuning of the power take off pto system with the smart grouping of wecs into arrays for maximising the energy production have been reported borgarino et al 2012 folley and whittaker 2009 sinha et al 2016 wang et al 2016 in bozzi et al 2017 chen et al 2016 kara 2016 and singh and babarit 2014 interaction effects such as the influence of the distance between the wecs and the energy production were investigated furthermore göteman 2017 studied how the dimensions of each wec unit in a wave farm affect the energy in bozzi et al 2017 and kara 2016 the incident wave direction in relation to the orientation of the wave farm was explored to maximise the energy production an experimental approach was employed in stallard et al 2008 and stratigaki et al 2014 to demonstrate that the net power capture of a single heaving point absorber in a wave farm can be amplified by a suitable choice of the array size and its configuration in several examples in the literature array systems have been optimised for maximum energy production for different types of wec technologies for example in child and venugopal 2010 göteman et al 2015 mcguinness and thomas 2016 moarefdoost et al 2017 and ruiz et al 2017 the assessment of the overall feasibility of the wec array system can be performed by estimating the levelised cost of energy lcoe iea oes 2015 si ocean 2013 the calculation of the lcoe of a particular wec system requires evaluation of the total project cost and total energy produced over its lifetime which are both discounted to present values costello and pecher 2017 this measure is used to assess and compare different wave energy technologies iea oes 2015 and wave farm configurations astariz et al 2015 the measure is also used to analyse the impact of the change in the design of a technology and potential sites of operations gray et al 2017 and serve as a guide for the further development of this technology or its operational conditions to increase profitability when integrated in a wave farm however most studies for example most of the previously mentioned references of the design and assessment of wecs in wave farms focus on the hydrodynamics and energy performance according to nava et al 2016 the obtained results can be misleading unless additional details such as the detailed design of moorings and foundations electrical connections issues related to installation maintenance and operations and an lcoe of the studied wave farm are included in the analyses with a focus on the mooring configuration in a wave farm vicente et al 2009a 2009b present examples in which analyses that included the mooring system yielded less energy production than the analyses in which this component was omitted in konispoliatis and mavrakos 2014 the effect of the design of a mooring system for an array configuration on the total energy production was demonstrated in gao and moan 2009 the individual mooring configuration was determined to be more feasible than the integrated mooring configuration for the wec farm due to the significantly larger tension force responses in horizontal mooring lines observed in the latter configuration in survival conditions however an understanding of the long term fatigue lives of moorings in a wave array farm has remained largely unknown this study has two objectives related to the recommendations obtained from the numerical modelling simulation and assessment of interaction effects between wecs and their components in wave farms first the study aims to quantify how the power performance and fatigue lives of the mooring lines are affected due to the interaction effects between two wecs in a wave farm i e to estimate the magnitude of the difference from the results obtained by a simplified analysis where the hydrodynamic interactions are not considered second we present lcoe calculations that quantify the magnitude of the contribution that the interaction effects may make to the lcoe value per installed wec unit which provides valuable information for the design of wave farms throughout the study the prototype concept waveel which was developed by the swedish company waves4power waves4power 2018 was used as the reference wec system refer to fig 1 for a schematic layout a full scale installation of waveel was carried out in runde in norway refer to fig 2 where it was tested in fully operational conditions and delivered power to the grid from june to november 2017 this wec system is a floating point absorbing wec with a three leg two segment taut mooring system it has a free hanging submerged power cable that is connected to a power gathering hub refer to table a1 and fig a1 for the main properties of the system the remainder of the paper is structured as follows the methodology including the simulation platform and the different analysis methods applied in the study is outlined in section 2 in section 3 the motivation and definition of the simulation models and cases are presented for the four 2 wec array and two 10 wec array simulation models the results of the simulations and the analyses of the hydrodynamics effects are presented in section 4 followed by a discussion in section 5 the major findings of the study are presented in section 6 2 methodology 2 1 hydrodynamic and structural response analyses the commercial dnv gl sesam software package dnv gl 2019 was adopted to simulate the hydrodynamic and structural response analyses fig 3 illustrates the two analysis approaches in this study the distinction between the two approaches follows the definition in gao and moan 2009 if the equation of motions of the wec and the mooring lines are solved simultaneously using the time domain analysis and if the motion and force of the mooring structures implicitly influence the instantaneous dynamics of the wec and vice versa then the analysis is referred to as a coupled analysis approach otherwise the analysis is referred to as a de coupled analysis approach the entire analysis approach employs six sub level models whose simulation purpose and usage in relation to the analysis workflow c f fig 3 are summarised in table 1 irrespective of the system configurations namely single unit systems or array farms the coupled analysis approach left track in fig 3 was employed in this study the application of the sesam package and coupled analysis approaches for simulating single unit wec systems were extensively investigated in yang 2018 in which a detailed description of the modelling and theoretical backgrounds is also provided as shown in the cited reference the coupled analysis approach captured the coupling between the wec and the mooring lines connected to it these coupling effects had great importance in performing realistic and reliable simulations of dynamic motions and force responses of the wec system and in yielding a reliable estimate of the fatigue service life of the systems moorings the coupled analysis approach has been validated against model tests of a single unit wec system performed in a laboratory ocean basin refer to yang et al 2018 regarding wec motions and yang et al 2019 regarding mooring forces for an array system with more than one wec the hydrodynamic responses of the wecs are additionally influenced by each wec in the system via radiation and diffraction of the waves which are referred to as hydrodynamic interactions due to the limitation of the sesam package sintef ocean 2017a 2017b only the diffraction induced hydrodynamic interaction was considered in the simulation nevertheless folley et al 2013 determined that the radiation induced hydrodynamic interaction is minor relative to the diffraction induced hydrodynamic interaction and hence the impact of excluding the radiation induced effect was deemed acceptable the de coupled approach as presented in the right track of fig 3 is the only approach available in sesam that can include both radiation and diffraction induced effects further investigation of the sensitivity with regards to the radiation induced hydrodynamics is presented and discussed in section 5 1 the hydrodynamics and structural response analysis using either the coupled approach or the de coupled approach provides results of the motion responses of the wec for six degrees of freedom dofs and the force responses in the mooring lines these results are used to calculate the power performance and fatigue damage of the mooring lines as described in sections 2 2 and 2 3 2 2 power performance analysis the pto system in waveel was simplified in the simulation models to a linear pto system represented by a linear damper that acts in the heave direction of the wec the power performance of the wec p was evaluated in terms of the time averaged power absorption calculated as 1 p 1 t 0 t b pto ξ t 2 d t unit kw where ξ is the heave motion of the wec unit m calculated in the coupled analysis procedure section 2 1 t denotes the time of simulation the dot notation represents the derivative with respect to time and b pto is the pto damping coefficient unit kns m b pto was selected to be equal to the radiation damping coefficient at the resonance in the heave dof of the waveel wec without its moorings in this context b pto was calculated as 40 180 kn m at the wave period of 5 s the value calculated from eq 1 corresponds to the mean power consumed by the mechanical damper of the pto during the time of simulation t this value is applied in this study to represent the power performance of the wec in specific operational conditions 2 3 fatigue analysis rn approach the reference wec system has elastic mooring lines made of polyester refer to appendix a for their mechanical properties a stress based fatigue approach in which the stress history in the mooring lines from the hydrodynamic and structural response analysis was applied in the fatigue calculation was employed the rainflow counting rfc method was used to define the stress cycles and ranges from the stress history data rychlik 1987 the accumulation of fatigue damage was calculated using the palmgren miner cumulative rule endo and morrow 1969 according to dnv gl 2015 the tension fatigue life for fibre ropes such as polyester mooring lines should be calculated using the relative tension instead of the stress therefore the rn relative tension number of cycles to failure curve approach was employed for the mooring lines and their fatigue damage f was calculated as 2 f i r i m α γ f where the index i represents the i th stress cycle identified using the rfc method the ratio of the corresponding identified tension range to the characteristic strength of the polyester material is designated r i this calculation was carried out in the integration point of the beam elements that represent the mooring lines furthermore the parameters α and m represent the fatigue material properties of the polyester mooring lines and were set to 0 259 and 13 46 respectively according to dnv gl 2015 as recommended in this reference a safety factor γ f of 60 should be used for the polyester ropes due to the large variability in the fatigue test results around the fitted rn curve in the guidelines 2 4 lcoe analysis for a wave farm that consists of j wecs the lcoe eur kwh can be calculated as castro santos et al 2016a 2016b 3 l c o e n 0 n n c o s t n 1 r n n 0 n n e 1 r n unit eur kwh where n is the target design operational life of the farm in years c o s t is the total cost in eur of the wave energy farm in the n period from year 1 to year n e is the annual energy production in kwh from all j wec units and r is the discount rate of the energy system defined according to costello and pecher 2017 in this study n was set to 25 years and r was set to 0 09 according to pecher and kofoed 2017 the annual energy production e of a wave farm depends on the number of wecs and the power performance of each individual wec e was calculated as 4 e k 1 k j p k 24 365 η availability η transmission where the index k represents the k th wec in the wave farm p k is the installed power performance of the k th wec in the array farm at a particular operational site η availability is the fraction of time that a particular operational site is available and η transmission is the transmission efficiency of the energy generated by each wec to the final electricity output to the end user the values of η availability and η transmission were determined according to pecher and kofoed 2017 and were set to 0 95 and 0 2 respectively according to waves4power 2018 which is the waveel installation in runde norway the reference wec system in fig 1 shows the installed power performance p ref of 125 kw irrespective of the configuration of the wecs in this study this value was always used to represent p k in eq 4 and therefore was employed in the initial lcoe calculations of the variants of the wec array systems this study followed the calculation model suggested in castro santos et al 2016a 2016b to calculate the life cycle cost of a wec farm lcc the lcc considers the various cost aspects including the cost of concept definition c 1 design and development c 2 manufacturing c 3 installation c 4 exploitation c 5 and dismantling c 6 in this study all cost items except for the costs related to the system and farm design were estimated depending on the configuration and quantity and number of components employed in each wec farm the design costs were assumed identical for all wec farms to reflect the fact that the design and selection process of various wec farms had been performed as one integrated step refer to details in ringsberg et al 2020 the design related costs cover all of cost c 2 and part of cost c 1 cost c 1 includes the cost of land usage which was adjusted according to each individual wec system table 2 summarises the cost estimation from the waveel wec system the readers are referred to ringsberg et al 2020 for the unit cost of various components in the system and to yang 2018 for the complete list of assumptions for the lcoe calculations 2 5 assessment of the interaction effect one of the important aims of this study was to quantify the effects of the hydrodynamic interaction between the wecs in an array system all simulation cases were therefore simulated twice using two sets of hydrodynamic properties of the wecs such as added mass damping and excitation forces in the first simulation the hydrodynamic properties of all of the wecs in an array were identical to the single unit wec i e hydrodynamic interaction effects were not included in the second simulation the hydrodynamic properties of all of the wecs in the array were simultaneously solved using the bem to obtain unique hydrodynamic properties of each wec to capture their hydrodynamic interactions by comparing the results from the two simulations the effect from the hydrodynamic interaction between two wecs could be determined two interaction measures were defined for each wec k the interaction ratio with regard to power performance i p k and the interaction ratio for the accumulated fatigue damage of the mooring lines i f k as 5 i p k p k interact p k 6 i f k f k interact f k where the denominators p k and f k represent the estimated power performance and the accumulated mooring fatigue damage respectively of the k th wec in an array without considering the interaction effect in the simulation model p k interact and f k interact represent the estimated power performance and the accumulated mooring fatigue damage respectively of the k th wec of the same array when the hydrodynamic interaction was considered in the simulation model 3 simulation models with the wec buoy identical to the wec buoy utilised in the waveel system fig 4 illustrates the two mooring configurations considered in this study the first configuration the 3 moor wec system was proposed with a reference to the installed mooring configuration at runde c f fig 1 and the second configuration the 2 moor wec system was proposed in ringsberg et al 2020 as a possible design candidate with a better economic viability by virtue of the reduced number of mooring components the 3 moor wec system was designed for a water depth of 75 m whereas the 2 moor wec was designed for a water depth of 200 m the two systems presented in fig 4 are hereafter referred to as the reference single unit wec systems their geometric configurations are detailed in table a2 and table a3 each reference system was further analysed with three simulation models two 2 wec models with different separation distances and one 10 wec model of a candidate to an array system sections 3 1 and 3 2 motivate the configuration of the simulation models and present their descriptions the description of the simulated environmental load conditions is presented in section 3 3 3 1 two wec simulation models the 2 wec simulation models are defined by two identical single unit wec systems which are similar to either of the reference wec systems c f fig 4 no mechanical coupling occurs between the two wecs e g the mooring systems do not share mooring lines or floaters thus the only interaction between the two wecs is derived from the hydrodynamic interaction effects fig 5 shows the four 2 wec model configurations 2 single unit systems 2 separation distances for each system that were considered for every two 2 wec models with the same mooring configuration the separation distance between the wecs is the only difference between the simulation models the influence of the separation distance on the interaction effect between the wecs has been investigated by bozzi et al 2017 chen et al 2016 kara 2016 and singh and babarit 2014 among others the recommendations and findings from these publications were partly employed when the separating distances were determined but additional criteria and requirements were also considered the distances of 250 m and 50 m were justified by a criterion in which the footprint should be kept as small as possible to reduce its cost factor in the lcoe calculation these two distances also represented the shortest distance possible for each respective mooring configuration and anchor positions that ensured that no clashing would occur between the wecs and their mooring lines the longer separation distance was determined using the q factor concept babarit 2013 budal 1977 evans 1979 falnes 1980 which gives a value for the interaction effect between two wecs a q factor calculation requires a large number of systematic simulations where all incident load directions are considered at different separation distances between the wecs in this study the incident wave load was represented by a regular wave where its direction varied from 0 to 345 at an interval of 15 note that wind and current loads were not considered for each wave load direction d i r wave the power performance i p in eq 5 was calculated according to the procedure presented in sections 2 2 and 2 5 the q factor was then obtained as the average value of the calculated i p values for each wave load direction a large number of separation distances between the two un moored wecs ranged from 25 m to 10 km the bem was applied in the frequency domain analyses where the b pto for the two wecs was set to 40 180 kn m using the wave period of 5 s which is the resonance period of a single unit wec without its mooring system fig 6 a shows the calculated average i p values of the two un moored wecs for various d i r wave the results are shown for a 180 degree circumference as the remaining half results are symmetric against the d i r wave of 0 and 180 fig 6 b shows the mean i p values of all simulated d i r wave namely from 0 to 345 the assessment of the simulation results showed that separation distances of 200 m and 600 m yield q factor values of 1 088 and 1 075 respectively which were the two largest calculated values among all 2 wec cases consequently 200 m was chosen as the second separation distance for the 2 wec 2 moor model and 600 m was selected as the second separation distance for the 2 wec 3 moor model the q factors for separation distances of 50 m and 250 m were 1 063 and 1 062 respectively 3 2 ten wec array simulation model in ringsberg et al 2020 tens of designs of array patterns and mooring configurations were evaluated by several criteria including the perspective of operation and maintenance lcc lcoe and risk from their investigations the startbuoy and lessismoor systems emerged as the top two candidates they are shown in fig 7 both systems adopt a shared mooring system between the two wecs that was found to be a solution for the reduction in the lcoe of the waveel concept waves4power 2018 the shared mooring system enables the use of a short separation distance between two individual wec units however due to the small separation distance between the wecs and the shared mooring components with mechanical couplings both the mechanical coupling and the wave interaction effects are expected to affect the fatigue lives of the mooring lines power performance of the array system and lcoe value hence these two configurations were selected for a detailed analysis since they are considered the most promising candidates for future installation as large scale array farms hereafter a sub unit system is defined as one wec and multiple mooring legs that are connected to it section 4 presents the results from the simulations and analyses and the discussion of each 10 wec array consists of ten sub unit wec systems the starbuoy system consists of multiple wecs mooring lines floaters and anchors every sub unit in the starbuoy system is grouped with three mooring legs the number k marks the identity of each wec as shown in fig 7 a and was utilised to distinguish the mooring lines the moorings in the systems were named w k moor l where the index k shows to which wec they are connected and index l marks the identity of each mooring leg 1 3 the mooring segments that connect a floater to a gravity anchor are defined as w k moor out and w k moor in which specify the segments that connect a floater to the hub anchor in the centre one exception exists in this naming convention namely the mooring segment w 11 moor out is a line segment connected to the sub unit wec system number 10 the identity of each wec in lessismoor is presented in fig 7 b the lessismoor system has two mooring legs in each sub unit system each mooring leg has only one segment which moors the wec directly to the sea floor 3 3 environmental load conditions irregular environmental loads which consist of waves winds and ocean currents were simulated the modelling of different loadings followed the recommendation in dnv gl 2017 and the duration of each sea state was taken as 3 h to provide sufficient statistics for the fatigue analysis of the mooring lines dnv gl 2015 the sea state was defined by the peak wave period significant wave height and spectral peak parameter and followed the jonswap spectrum an ocean current was modelled the current load was time and depth independent and defined solely by the current velocity magnitude the wind load was defined by the wind velocity at the reference height of 10 m above the sea water level this configuration followed the recommendations in dnv gl 2017 that the wind load should be modelled by the npd wind spectrum with the profile exponent and friction defined as 0 12 and 0 002 respectively in our previous work a large number of simulations were presented for the installed wec system at runde using a scatter diagram yang 2018 in the current study the three sea states with the highest probabilities of occurrence in the scatter diagram were prioritised for a detailed analysis these states are presented in table 3 and are referred to as the environmental conditions ecs these three ecs approximately correspond to mild moderate and harsh operating conditions for the reference waveel wec furthermore ec1 and ec2 were the two most frequently observed sea states during the measurement period on waveel during the period of june 2017 to november 2017 the wave wind and current loads were assumed to align in the same incidence load direction namely d i r wave d i r wind d i r curr d i r load figs 5 and 7 each ec was simulated with d i r load and covers a broad range of possible scenarios for each array with a 15 degree interval all of the models were simulated for a range of 90 except for the startbuoy model the latter was simulated for a 180 degree range this condition generated 21 load cases for each 2 wec simulation model and the lessismoor model 3 ecs 7 d i r load and 39 load cases for the starbuoy simulation model 3 ecs 13 d i r load 4 results this section presents the results obtained from the numerical simulations and the assessment of the interaction effects section 4 1 presents the power performance section 4 2 presents the fatigue analysis of the mooring lines and the lcoe calculations are presented in section 4 3 following the methodology described in section 2 5 the results are presented as fractions i e normalised against the results obtained without the consideration of the hydrodynamic interaction the absolute values of the time averaged absorbed power p and 3 h accumulated fatigue damage f of the two considered single unit wec systems are presented in fig 8 a and fig 8 b respectively as the reference for the following discussion 4 1 power performance fig 9 presents the power interaction factor i p values calculated from the simulations using the 2 wec simulation models while the denominator in eq 5 was calculated according to section 2 5 due to the lack of mechanical coupling between the wecs the value of the denominator should be the same as the value obtained from the simulations using a single unit wec system c f fig 8 a both alternatives were compared for numerous load cases and yielded a difference of less than 0 01 the small difference is attributed to the realisation of the wave field which differs in the two locations where the wecs are positioned the average and standard deviations of the data points in fig 9 are calculated in table 4 and table 5 respectively the results show that most of the power interaction factor values are near unity 1 these results indicate that the hydrodynamic interactions between the two wecs have only a minor effect on the simulated load cases thus this energy will neither be lost nor gained for the investigated wec system note that the predicted magnitude of i p in fig 9 is at a level similar to the level of the data reviewed in babarit 2013 in which the power performance either increased or decreased by a maximum of 10 when the separating distance was between 10 and 20 radii of the wec buoy for an array of less than 10 wecs using the results from table 4 namely the results from the coupled time domain simulations the q factors were always smaller than those calculated from the frequency domain simulations c f fig 6 these observations imply that the frequency domain simulations may cause an overprediction of the overall energy harvest of wec array systems note that these coupled time domain simulations included the full mooring system and that the simulations were carried out for irregular sea state conditions with the current and wind loads included these simulations are considered more realistic than the frequency domain simulations the latter did not include the mooring system and were limited to a regular wave at the resonant wave period of the un moored wec irrespective of the mooring configuration the interaction effect is more pronounced at shorter separating distances and decays with longer separating distances this effect is observed by larger standard deviations of i p values c f table 5 for both wecs at a shorter separation distance the trend was deemed reasonable as theoretically the diffraction wave field decays as the distance increases mei et al 2018 the hydrodynamic interactions between the wecs tend to yield a destructive effect on the wecs power performance i e i p 1 when the separation distance is small the difference in the i p values between the two wecs decreases as the ec becomes more energetic ec1 ec2 ec3 this observation was attributed to two factors the corresponding wave period increases from ec1 to ec3 as shown in e g borgarino et al 2012 the interaction factor tends to converge to 1 as the wave period increases the second factor was attributed to the restraint from the mooring system when the sea states become more energetic the restraint from the moorings dominates the dynamics of each sub unit system therefore the impact of the hydrodynamic interactions decreases the results in fig 9 show that the incident load direction d i r load has some influence on the power interaction factors when the environmental loads are aligned with the two wecs i e d i r load 0 the i p value for the wec on the leeward side i e wec2 is less than that for the wec on the windward side the predicted power performance of wec1 is mostly smaller than that for wec2 when d i r load is between 0 and 30 for a d i r load of 75 a converse relationship appears however the effect of the incident load direction also shows some dependence on the separation distance the relation of the i p values between the two wecs exhibits more similarity between the 250 m 2 wec 3 moor model and the 200 m 2 wec 2 moor model than the other 2 models by taking the average of all values from each d i r load the results revealed that wec1 always exhibits a better power performance than wec2 irrespective of the mooring configuration and the ec fig 10 presents the i p of the lessismoor and starbuoy systems regarding the lessismoor system one observation from the ec1 results is that a person can achieve a positive maximum gain of 5 if the array system is oriented in a smart way while a poor orientation can yield a maximum loss of 7 the influence of the direction dependence of the incident load direction is larger for lessismoor relative to the 2 wec 2 moor simulation models for instance the wecs located on the leeward side of the array always show a worse power performance than other wecs on the windward side however similar to the observation made in the 2 wec simulation models the relative difference in i p between the two wecs is smaller for the ec2 results and almost insignificant for the ec3 results this observation reconfirms the importance of including the mooring effect when investigating the hydrodynamic interaction effect among the three considered ecs the i p values are always less than unity 1 if a person calculates the average value of all simulated load cases for each ec namely average of the first column in each sub figure of fig 10 this finding implies that a destructive effect on the power performance is more likely to occur in a large array system the observations made for the starbuoy system follow the same pattern as employed for the lessismoor system except that the former shows an even greater scatter in the i p results between the wecs and the different load cases for two reasons first the separation distances between the wecs in starbuoy is shorter which yields a stronger influence of the hydrodynamic interactions and second starbouy has a shared mooring component with the mechanical couplings which also affects the response for the full system in addition to the hydrodynamic interactions the result highlights the importance of performing coupled time domain simulations for the analysis of wave energy array farms where complex responses due to hydrodynamic interactions and mechanical couplings must be understood refer to the fatigue analysis in section 4 2 4 2 fatigue analysis of mooring lines this section presents the results of the calculations of the fatigue interaction factor i f the results are presented for the mooring line that showed the largest accumulated fatigue damage during a 3 h sea state simulation for the two single unit reference wec systems and the ecs in table 3 this location was always located at the fairlead point of the mooring line that faced the windward side of d i r load refer to the prediction of f in fig 8 b an assessment of all fatigue damage results for the array systems confirmed this finding independent of whether the hydrodynamic interactions were considered in the simulation models consequently the presented values of the fatigue interaction factor i f were obtained in the fairlead point of the mooring line that faced the windward side of d i r load most fig 11 presents the i f results for the 2 wec simulation models the corresponding average and standard deviation are presented in table 6 and table 7 respectively for every two wecs in a 2 wec model the wec that shows the larger i p value usually also shows the larger i f value the variation in the i f values of each sub unit wec system with regard to the incident load direction follows the same pattern of the i p results discussed in section 4 1 however no clear correlation is observed between the change rate of the i p values and the change rate of the i f values the hydrodynamic interaction shows a larger impact on the mooring fatigue than the power performance i e the calculated i p values are closer to unity note however that the large variation in the i f results should be analysed with care due to the large value of the fatigue exponent m which was used to calculate the mooring fatigue the value of the fatigue exponent m in eq 2 is large hence small variations in fatigue stress ranges between the individual mooring lines produce large differences in their accumulated fatigue damage results fig 12 exemplifies the potential uncertainty in the fatigue calculation in fig 12 a the stress range components at the most fatigue critical points of the two wecs with a separation distance of 600 m are presented the presented load case is ec3 with a d i r load of 30 one of the load cases that shows a large difference in the calculated i f values by a factor of 4 between the wecs but less than 1 difference in the i p values as shown in fig 12 a the stress components of the moorings at the two wecs are similar with a relative difference at an average of 3 in terms of the number of stress cycles in the same stress range these identified stress cycles generate a large difference in the calculated fatigue damage f as shown in fig 12 b at the m value of 13 46 the difference in the calculated f values for the two wecs decreases as the m value decreases for instance the common fatigue exponent m for steel mooring chains is 3 dnv gl 2015 the large fatigue exponent m also makes the mooring fatigue prediction more sensitive to the realisation of the wave and wind loads which were sampled by the software using pseudo random numbers sintef ocean 2017a 2017b one example is shown in fig 13 each load case was simulated using three different wave and wind realisations after extracting the stress responses over the 3 h simulations the mooring fatigue was calculated using 2 different values of the fatigue exponent the results show that the predicted f and i f values are less sensitive namely less scattered to the differences in load realisation when a smaller m value is utilised nonetheless the results also showed that the overall trend in the calculated accumulated fatigue damage f and fatigue interaction factor i f can be well captured even using a single load realisation to confine the overall computational effort below an acceptable limit the majority of the results presented in this study is based on one load generation and only a few random chosen cases were simulated for three load realisations to ensure the overall prediction credibility note that the calculation of the absorbed power p and the power interaction factor i p are insensitive to the variation in the load generations the parametric sensitivity study showed that the relative differences in the p and i p values between various load realisations never exceeded 0 1 the fatigue value is the accumulated fatigue damage after 3 h of simulation and the power value is based on the mean power value calculated after 3 h of simulation the former presents a cumulative value that is affected directly by the small and large stress ranges in the fatigue damage calculation while the latter saturates to a value that becomes less sensitive to fluctuations during long simulation times based on the overall positive correlations between the i p fig 9 and i f fig 11 results we highlight the need to consider factors other than the power performance when evaluating the interaction effects of a wec array farm further investigations however remain to be completed to confirm the mooring fatigue properties and hence a more accurate fatigue prediction can be achieved the fatigue assessment of the mooring lines of the lessismoor and starbuoy systems is presented in fig 14 note that the results for the d i r load of 150 and 330 for starbuoy are both symmetric as expected but the slight asymmetry shown in fig 14 d and 14 e was due to the asymmetric grouping of mooring segments into sub unit systems refer to fig 7 irrespective of the array system configuration the results show that the majority of the moorings have an i f value less than one for all load cases which indicates that the hydrodynamic interaction affects the current mooring design positively by decreasing the fatigue damage of the moorings and increasing their fatigue lives however the results also show that the scatter of i f values in the 10 wec systems is significantly larger than that obtained in the 2 wec simulation models the observations indicate that when a large array system is being considered evaluation of the entire system as a whole is crucial to achieve a comprehensive understanding of the system performance an additional note is made regarding the absolute value of the fatigue damage for the starbuoy system refer to fig 15 the results are shown for the model run in a 3 h simulation without considering the hydrodynamic interactions thus the mechanical coupling in the mooring design was the only interaction effect considered in the model the results in fig 15 showed that many of the sub unit wec systems in starbuoy have significantly larger f values than the single unit 3 moor system in a similar load case moreover a few moorings that achieve relatively high f results always exist and present as a fatigue critical point in the system the phenomenon was even more evident in ec1 when the moorings have not reached their full restraining functionality refer to the discussion related to fig 9 this observed trend of damage increase was similar to the observation in gao and moan 2009 who discovered that the horizontal lines in a shared mooring system may suffer from exceptionally large horizontal motion and thus larger stress response and fatigue damage caused by two adjacent wecs moving with a phase difference or in opposite directions the simulation results confirmed that these mooring lines are the weak links of the mooring system and must be addressed in the design of the mooring system or maintenance planning a comparison of the results between the single unit wec case and the starbuoy array system without considering the hydrodynamic interaction in the simulation model shows that the power performance is similar this result was deemed reasonable and expected as the mooring systems for every sub unit in starbuoy has been designed to provide a similar stiffness as shown in the reference single unit system 4 3 lcoe analysis the results presented in sections 4 2 and 4 3 show that when the hydrodynamic interaction between the wecs was considered in the simulation models the wecs power performance was relatively unaffected i p 1 and the fatigue life of most of their mooring lines increased i f 1 even though some exceptions appeared in this section lcoe calculations are presented the results discussed in the previous sections are used to quantify the influence of the hydrodynamic interaction on the lcoe value initial calculations denoted as lcoeinitial were carried out as the reference for all simulation models and the waveel reference wec system they are hereafter referred to as case study systems the installed power of each wec was assumed to be 125 kw i e p k p ref 125 kw refer to section 2 4 and all other costs were calculated according to their configurations and the number of components in their respective systems the mooring lines in the reference wec system were originally designed to be replaced two times during the 25 year design target life n change original 2 and the corresponding cost was included in c 5 note that n change denotes the total replacement namely replacing every single mooring attached to one wec table 8 summarises the initial cost estimation for all of the case study systems in the lcoe calculation two primary factors are directly connected to the influence from the hydrodynamic interaction effects the power performance p k and the expected replacement of the entire mooring system for one wec n change p k in eq 4 was replaced by the product between p k and the calculated value of the interaction factor i p k and n change was calculated as the rounded off value of the product between the original value of n change original and the calculated value of i f k each wec in the respective array systems was treated individually where its i p and i f values were determined based on the simulation results presented in sections 4 1 and 4 2 the calculation of lcoe including the interaction effect was hereafter referred to as lcoeinteract fig 16 presents a summary of the results obtained from the lcoe calculations for the 2 wec case study systems since the lcoe value is directly affected by the values of i p and i f a large number of lcoe calculations are carried out using the results discussed in sections 4 1 and 4 2 the x axis range corresponds to the lower and upper values of i f and the y axis range corresponds to the lower and upper values of i p refer to figs 9 and 11 the fraction lcoeinteract lcoeinitial is calculated for a large number of combinations and plotted as contours a value less than one is favourable for all of the investigated two wec arrays the interaction effect could possibly contribute to a reduction in lcoe of 12 or to an increase of 30 where the largest variation in the lcoe results occurred in the case of the 50 m 2 wec 2 moor system a similar estimation of lcoeinteract was made for the lessismoor and starbuoy systems fig 17 owing to the large range of variation in i p and i f between the ten sub units from the numerical simulations a concentrated area surrounded by a dotted line was highlighted in the figure this region covers the exact maximum and minimum of ten wec averaged interaction factors calculated from the respective loading cases the hydrodynamic interaction between the wecs shows a much larger impact on the lcoe of the 10 wec system the lcoe of the system can be reduced by at most a factor of 2 or increased by a factor of 7 focusing on the concentrated area the interaction effect can possibly contribute to a reduction in lcoe of 50 or an increase in lcoe of 85 for the starbuoy system comparatively the interaction effect contributes to a reduction in lcoe of 40 or an increase in lcoe by a factor of three within the concentrated area for the lessismoor system the results presented in fig 17 highlight the need to investigate the effect of the interaction among the wecs for a realistic economic estimation of the large array systems 5 discussion 5 1 effect of the radiated wave on the interaction effect the numerical simulations in this study were performed using a coupled analysis approach however this choice limits us to the study of the diffraction induced hydrodynamic interaction only if the mooring lines are simulated in a quasi static manner the complete hydrodynamic interactions including both the radiated wave and diffracted wave can be simulated in the dnv gl sesam package this approach is often referred to as the de coupled analysis approach gao and moan 2009 davidson and ringwood 2017 it is presented in the right track of fig 3 fig 18 presents example results for the i p of the 2 wec simulation models calculated using a de coupled simulation procedure a comparison between the results in figs 9 and 18 shows only a minor difference in the calculated i p therefore we conclude that the lack of radiation induced hydrodynamic interaction in the coupled analysis procedure has a negligible impact on the results presented in section 4 1 i e the diffraction induced hydrodynamic interaction governs the hydrodynamic interaction for the current case study system fig 19 presents one example of the time histories of the simulated force response using the two approaches the results show a large difference in the axial force response where the de coupled approach does not capture the dynamics of the mooring lines since the de coupled analysis approach cannot be employed to simulate a complex mooring system such as the design in the starbuoy array system model the coupled analysis approach is considered superior and is the recommended option in numerical simulations and investigations that require modelling of the hydrodynamic interaction effects and their impact on e g the fatigue of moorings and cables in wec systems note however that the presented sensitivity study is deemed valid in this study with a confined study set and sesam simulation framework further investigation is needed in the future to verify whether the conclusion is generally applicable for other array configurations or loading conditions 5 2 effect of incident load directions on the interaction effect the load conditions tested in this study assumed that all of the incident directions of wave wind and current are aligned in the same direction this assumption was made as it presents the most fatigue critical condition to the mooring lines yang 2018 dnv gl 2015 in reality however environmental loads may act from different directions and verification of whether the observations made in the previous sections remain valid if the incident directions of various loads differ is important fig 20 presents some i p and i f results for the 2 wec 3 moor simulation model the load case was defined similarly to ec2 except that the incident directions of different loads are varied in addition to the d i r wave defined according to the values presented in fig 20 d i r wind and d i r curr are defined as 30 and 45 relative to the waves respectively the chosen non collinear condition follows the recommendation in dnv gl 2015 comparing the results between figs 20 a and fig 9 e the change in the incident load directions in the wind and currents in relation to the waves shows no influence on the power interaction factor i p the interaction effect on the power performance is governed by the incident direction of the waves the effect of variation in the incident load directions is however more evident for the fatigue interaction factor i f irrespective of the combination of incident load directions all of the results in terms of overall trend and magnitude presented in fig 20 b were similar to the results for the load case with a d i r load of 60 as shown in fig 11 e the similarity was attributed to the fact that for all of these cases they can be categorised as the same condition where the incident load directions have inclination angles to the alignment of the 2 wec model and hence the observation made with regard to the hydrodynamic effect on the mooring fatigue was similar the observations made for the 2 wec model are also valid for the 10 wec system with one addition refer to the example results for the starbuoy system in fig 21 due to the presence of mechanical couplings different moorings exhibit a larger or smaller influence from the hydrodynamic interactions overall the results presented in figs 20 and 21 with other results presented in sections 4 1 and 4 2 confirmed that the hydrodynamic interaction must be considered in a system analysis of a full wec system and wave farm furthermore the structural integrity of moorings and the power performance of a wec should always be considered concurrently for a realistic assessment of the wec array system this study shows that the design of wave energy array systems is a complex task simple and easy to use tools and models are necessary this investigation highlights the necessity of the initial development and use of relatively detailed and complex simulation models which can be further simplified as we learn which parameters and effects are important to consider depending on the purpose of the model and study 5 3 q factor for the two wec four 2 wec models with various separation distances were investigated in this study the shorter separation distances namely 50 m for 2 wec 2 moor model and 250 m for 2 wec 3 moor model were determined by the clearance needed for the mooring configuration and the other two longer separation distances were determined using the q factor concept fig 6 presents the calculated q factor for a large number of combinations of separation distance and load direction for the two un moored wecs the results in fig 6 a are similar to the classical results presented in babarit 2013 note however that the q factor is a measure influenced by the array layout wave characteristic load directions and seabed bathymetry among others moreover various ways to quantify the total interaction effect by using the q factor exist but are not considered in this study the chosen distance of 200 m or 600 m in this study should not be interpreted as the optimum distance for the two wecs with regard to the power performance rather this distance is worthy of further investigation by time domain analysis refer to babarit 2013 for a detailed review of the application and limitations of the q factor concept 6 conclusions this study investigated the hydrodynamic interactions among the wecs in an array system with regard to the power performance and fatigue damage of mooring lines this study also examined how these interactions may affect the lcoe value obtained from an lcoe calculation a specific point absorbing floating wec concept was employed as a reference configuration to create four 2 wec simulation models and two 10 wec simulation models two types of mooring configurations were considered the simulation models were utilised for three different ecs in which the incident wave wind and ocean current load directions were varied the results obtained from the 2 wec simulation models showed that the hydrodynamic interaction has only a weak influence on the calculated power interaction factor i p which on average was close to unity 1 while minor deviations were observed among the three ecs and incident load directions the influence of the hydrodynamic interaction on the power was generally weak for the studied wec system and separation distances for the accumulated fatigue the results showed a clear influence of the hydrodynamic interaction using the 2 wec simulation models and a larger variation in the results among the simulated ecs the inclusion of the hydrodynamic interaction in all of the simulated load cases caused an impact on the fatigue interaction factor which ranged from an 80 reduction to an increase in the accumulated fatigue damage by a factor of 4 the 10 wec array systems showed that the effect of the hydrodynamic interaction on the average power absorption of the 10 wecs ranges from 17 to 23 depending on the incident load direction for the simulated ecs fatigue analyses showed a stronger influence of the hydrodynamic interaction in which the predicted fatigue damage can be varied by more than tenfold the study showed that the lcoe calculations were most affected by the cost terms which included the costs related to the mooring lines since the hydrodynamic interaction influenced the fatigue life of the moorings more than the time averaged power absorption in the case study with the 2 wec simulation models with different separation distances the lcoe value was either reduced by a maximum of 12 or increased by a maximum of 30 when the hydrodynamic interaction was included in the simulation models for the 10 wec models the interaction effect contributed to a reduction in the lcoe value of 40 or an increase in the lcoe value by a factor of three here the absorbed power also contributed to this effect among different wec models the close proximity between the wecs and the mechanical coupling between the wecs and the moorings were sources for the stronger effect of the hydrodynamic interaction furthermore numerical simulations of multi wec array farms showed that hydrodynamic interactions among wecs in an array farm strongly affect the fatigue damage of moorings which influence the related cost assessment of a wec system the results concluded that the hydrodynamic interaction effect between two wecs must be considered for a realistic economic estimation of the wec array system and that the fatigue damage of moorings should also be included as one evaluation criterion of the array performance in the early design stage credit authorship contribution statement shun han yang conceptualization methodology software investigation writing original draft writing review editing visualization jonas w ringsberg conceptualization writing original draft writing review editing supervision funding acquisition erland johnson conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial support provided by the swedish energy agency for the project entitled simulation model for operation and maintenance strategy of floating wave energy converters analysis of fatigue wear and influence of biofouling for effective and profitable energy harvesting through contract no p36357 2 we also thank the swedish company waves4power https www waves4power com for providing the wec system configuration and information about the runde test site professor lars bergdahl at chalmers university of technology is acknowledged for the valuable advice and discussions appendix a main properties of the case study wec systems table a 1 hydrodynamic and mechanical properties of the reference waveel system waves4power 2018 table a 1 wec mass m wec metric tonnes 268 42 draft d wec m 15 265 pto damping in heave dof b pto kns m 40 180 installed power performance at runde test site p kw 125 mooring system cross sectional outer diameter d m m 0 080 mass of each mooring segment m m kg m 4 9 axial stiffness e a m mn non linear as expressed in fig a2 breaking load of the polyester mooring material n b mn 1 176 fig a 1 profile view and geometrical dimension of the wec buoy unit metres fig a 1 fig a 2 axial stiffness of the polyester mooring described in terms of the load elongation diagram fig a 2 table a 2 geometric configuration of the 3 moor wec systems table a 2 water depth h m 75 length of mooring segments of the two wec pair l seg 1 and l seg 2 m 96 0 64 3 length of mooring segments of the starbuoy system l moor 1 l moor 2 l moor 3 l moor in and l moor out m 78 4 85 2 85 2 63 0 63 0 table a 3 geometric configuration of the 2 moor wec systems table a 3 water depth h m 200 length of mooring segments of the two wec pair l seg 1 m 194 5 length of mooring segments of the lessismoor system l moor 1 and l moor 2 m 194 5 
21709,in an array system of wave energy converters wecs hydrodynamic interactions between the wecs occur through the absorption radiation and diffraction of waves the main objective of this study was to analyse the hydrodynamic interactions between floating point absorbing wecs and the influence of this interaction on the power performance and fatigue life of the wecs mooring lines the hydrodynamic and structural response of the wec systems were analysed primarily using potential flow theory the morison equation and continuum mechanics theory four 2 wec models and two 10 wec models among which different separating distances and mooring configurations were considered were investigated the models were simulated for various environmental loading conditions the results from each simulation were evaluated in terms of the power performance of each wec accumulated fatigue damage in each mooring line and the levelised cost of energy lcoe the hydrodynamic interactions show a larger impact on the 10 wec simulation models to account for the hydrodynamic interactions in the simulations using the 10 wec models the fatigue damage in the mooring lines is varied at an average of 15 and a maximum of an order of magnitude difference a similar comparison of power performance showed an approximate difference in the results of 10 the lcoe calculation of the 10 wec array system showed lcoe values that range from 40 to 200 relative to the simulations that did not consider the hydrodynamic interaction effects comparatively the lcoe calculation of the 2 wec model either decreased by 17 or increased by 23 when the hydrodynamic interaction was included in the simulation model keywords fatigue analysis interaction effect levelised cost of energy mooring system power absorption wave energy converter 1 introduction an upscaling of the deployment of wave energy converters wecs by grouping multiple wecs into array farms is necessary to achieve cost efficient solutions for the commercial wave energy market ocean energy forum 2016 si ocean 2014 in array farms with oscillating bodies the wecs influence each other by mechanical coupling e g mooring or power cable interconnections and hydrodynamic interactions via the absorption radiation and diffraction of waves these interactions influence the overall energy production of the array farm the mechanical life of array components such as the mooring lines and the scheduled maintenance intervals investigations of the tuning of the power take off pto system with the smart grouping of wecs into arrays for maximising the energy production have been reported borgarino et al 2012 folley and whittaker 2009 sinha et al 2016 wang et al 2016 in bozzi et al 2017 chen et al 2016 kara 2016 and singh and babarit 2014 interaction effects such as the influence of the distance between the wecs and the energy production were investigated furthermore göteman 2017 studied how the dimensions of each wec unit in a wave farm affect the energy in bozzi et al 2017 and kara 2016 the incident wave direction in relation to the orientation of the wave farm was explored to maximise the energy production an experimental approach was employed in stallard et al 2008 and stratigaki et al 2014 to demonstrate that the net power capture of a single heaving point absorber in a wave farm can be amplified by a suitable choice of the array size and its configuration in several examples in the literature array systems have been optimised for maximum energy production for different types of wec technologies for example in child and venugopal 2010 göteman et al 2015 mcguinness and thomas 2016 moarefdoost et al 2017 and ruiz et al 2017 the assessment of the overall feasibility of the wec array system can be performed by estimating the levelised cost of energy lcoe iea oes 2015 si ocean 2013 the calculation of the lcoe of a particular wec system requires evaluation of the total project cost and total energy produced over its lifetime which are both discounted to present values costello and pecher 2017 this measure is used to assess and compare different wave energy technologies iea oes 2015 and wave farm configurations astariz et al 2015 the measure is also used to analyse the impact of the change in the design of a technology and potential sites of operations gray et al 2017 and serve as a guide for the further development of this technology or its operational conditions to increase profitability when integrated in a wave farm however most studies for example most of the previously mentioned references of the design and assessment of wecs in wave farms focus on the hydrodynamics and energy performance according to nava et al 2016 the obtained results can be misleading unless additional details such as the detailed design of moorings and foundations electrical connections issues related to installation maintenance and operations and an lcoe of the studied wave farm are included in the analyses with a focus on the mooring configuration in a wave farm vicente et al 2009a 2009b present examples in which analyses that included the mooring system yielded less energy production than the analyses in which this component was omitted in konispoliatis and mavrakos 2014 the effect of the design of a mooring system for an array configuration on the total energy production was demonstrated in gao and moan 2009 the individual mooring configuration was determined to be more feasible than the integrated mooring configuration for the wec farm due to the significantly larger tension force responses in horizontal mooring lines observed in the latter configuration in survival conditions however an understanding of the long term fatigue lives of moorings in a wave array farm has remained largely unknown this study has two objectives related to the recommendations obtained from the numerical modelling simulation and assessment of interaction effects between wecs and their components in wave farms first the study aims to quantify how the power performance and fatigue lives of the mooring lines are affected due to the interaction effects between two wecs in a wave farm i e to estimate the magnitude of the difference from the results obtained by a simplified analysis where the hydrodynamic interactions are not considered second we present lcoe calculations that quantify the magnitude of the contribution that the interaction effects may make to the lcoe value per installed wec unit which provides valuable information for the design of wave farms throughout the study the prototype concept waveel which was developed by the swedish company waves4power waves4power 2018 was used as the reference wec system refer to fig 1 for a schematic layout a full scale installation of waveel was carried out in runde in norway refer to fig 2 where it was tested in fully operational conditions and delivered power to the grid from june to november 2017 this wec system is a floating point absorbing wec with a three leg two segment taut mooring system it has a free hanging submerged power cable that is connected to a power gathering hub refer to table a1 and fig a1 for the main properties of the system the remainder of the paper is structured as follows the methodology including the simulation platform and the different analysis methods applied in the study is outlined in section 2 in section 3 the motivation and definition of the simulation models and cases are presented for the four 2 wec array and two 10 wec array simulation models the results of the simulations and the analyses of the hydrodynamics effects are presented in section 4 followed by a discussion in section 5 the major findings of the study are presented in section 6 2 methodology 2 1 hydrodynamic and structural response analyses the commercial dnv gl sesam software package dnv gl 2019 was adopted to simulate the hydrodynamic and structural response analyses fig 3 illustrates the two analysis approaches in this study the distinction between the two approaches follows the definition in gao and moan 2009 if the equation of motions of the wec and the mooring lines are solved simultaneously using the time domain analysis and if the motion and force of the mooring structures implicitly influence the instantaneous dynamics of the wec and vice versa then the analysis is referred to as a coupled analysis approach otherwise the analysis is referred to as a de coupled analysis approach the entire analysis approach employs six sub level models whose simulation purpose and usage in relation to the analysis workflow c f fig 3 are summarised in table 1 irrespective of the system configurations namely single unit systems or array farms the coupled analysis approach left track in fig 3 was employed in this study the application of the sesam package and coupled analysis approaches for simulating single unit wec systems were extensively investigated in yang 2018 in which a detailed description of the modelling and theoretical backgrounds is also provided as shown in the cited reference the coupled analysis approach captured the coupling between the wec and the mooring lines connected to it these coupling effects had great importance in performing realistic and reliable simulations of dynamic motions and force responses of the wec system and in yielding a reliable estimate of the fatigue service life of the systems moorings the coupled analysis approach has been validated against model tests of a single unit wec system performed in a laboratory ocean basin refer to yang et al 2018 regarding wec motions and yang et al 2019 regarding mooring forces for an array system with more than one wec the hydrodynamic responses of the wecs are additionally influenced by each wec in the system via radiation and diffraction of the waves which are referred to as hydrodynamic interactions due to the limitation of the sesam package sintef ocean 2017a 2017b only the diffraction induced hydrodynamic interaction was considered in the simulation nevertheless folley et al 2013 determined that the radiation induced hydrodynamic interaction is minor relative to the diffraction induced hydrodynamic interaction and hence the impact of excluding the radiation induced effect was deemed acceptable the de coupled approach as presented in the right track of fig 3 is the only approach available in sesam that can include both radiation and diffraction induced effects further investigation of the sensitivity with regards to the radiation induced hydrodynamics is presented and discussed in section 5 1 the hydrodynamics and structural response analysis using either the coupled approach or the de coupled approach provides results of the motion responses of the wec for six degrees of freedom dofs and the force responses in the mooring lines these results are used to calculate the power performance and fatigue damage of the mooring lines as described in sections 2 2 and 2 3 2 2 power performance analysis the pto system in waveel was simplified in the simulation models to a linear pto system represented by a linear damper that acts in the heave direction of the wec the power performance of the wec p was evaluated in terms of the time averaged power absorption calculated as 1 p 1 t 0 t b pto ξ t 2 d t unit kw where ξ is the heave motion of the wec unit m calculated in the coupled analysis procedure section 2 1 t denotes the time of simulation the dot notation represents the derivative with respect to time and b pto is the pto damping coefficient unit kns m b pto was selected to be equal to the radiation damping coefficient at the resonance in the heave dof of the waveel wec without its moorings in this context b pto was calculated as 40 180 kn m at the wave period of 5 s the value calculated from eq 1 corresponds to the mean power consumed by the mechanical damper of the pto during the time of simulation t this value is applied in this study to represent the power performance of the wec in specific operational conditions 2 3 fatigue analysis rn approach the reference wec system has elastic mooring lines made of polyester refer to appendix a for their mechanical properties a stress based fatigue approach in which the stress history in the mooring lines from the hydrodynamic and structural response analysis was applied in the fatigue calculation was employed the rainflow counting rfc method was used to define the stress cycles and ranges from the stress history data rychlik 1987 the accumulation of fatigue damage was calculated using the palmgren miner cumulative rule endo and morrow 1969 according to dnv gl 2015 the tension fatigue life for fibre ropes such as polyester mooring lines should be calculated using the relative tension instead of the stress therefore the rn relative tension number of cycles to failure curve approach was employed for the mooring lines and their fatigue damage f was calculated as 2 f i r i m α γ f where the index i represents the i th stress cycle identified using the rfc method the ratio of the corresponding identified tension range to the characteristic strength of the polyester material is designated r i this calculation was carried out in the integration point of the beam elements that represent the mooring lines furthermore the parameters α and m represent the fatigue material properties of the polyester mooring lines and were set to 0 259 and 13 46 respectively according to dnv gl 2015 as recommended in this reference a safety factor γ f of 60 should be used for the polyester ropes due to the large variability in the fatigue test results around the fitted rn curve in the guidelines 2 4 lcoe analysis for a wave farm that consists of j wecs the lcoe eur kwh can be calculated as castro santos et al 2016a 2016b 3 l c o e n 0 n n c o s t n 1 r n n 0 n n e 1 r n unit eur kwh where n is the target design operational life of the farm in years c o s t is the total cost in eur of the wave energy farm in the n period from year 1 to year n e is the annual energy production in kwh from all j wec units and r is the discount rate of the energy system defined according to costello and pecher 2017 in this study n was set to 25 years and r was set to 0 09 according to pecher and kofoed 2017 the annual energy production e of a wave farm depends on the number of wecs and the power performance of each individual wec e was calculated as 4 e k 1 k j p k 24 365 η availability η transmission where the index k represents the k th wec in the wave farm p k is the installed power performance of the k th wec in the array farm at a particular operational site η availability is the fraction of time that a particular operational site is available and η transmission is the transmission efficiency of the energy generated by each wec to the final electricity output to the end user the values of η availability and η transmission were determined according to pecher and kofoed 2017 and were set to 0 95 and 0 2 respectively according to waves4power 2018 which is the waveel installation in runde norway the reference wec system in fig 1 shows the installed power performance p ref of 125 kw irrespective of the configuration of the wecs in this study this value was always used to represent p k in eq 4 and therefore was employed in the initial lcoe calculations of the variants of the wec array systems this study followed the calculation model suggested in castro santos et al 2016a 2016b to calculate the life cycle cost of a wec farm lcc the lcc considers the various cost aspects including the cost of concept definition c 1 design and development c 2 manufacturing c 3 installation c 4 exploitation c 5 and dismantling c 6 in this study all cost items except for the costs related to the system and farm design were estimated depending on the configuration and quantity and number of components employed in each wec farm the design costs were assumed identical for all wec farms to reflect the fact that the design and selection process of various wec farms had been performed as one integrated step refer to details in ringsberg et al 2020 the design related costs cover all of cost c 2 and part of cost c 1 cost c 1 includes the cost of land usage which was adjusted according to each individual wec system table 2 summarises the cost estimation from the waveel wec system the readers are referred to ringsberg et al 2020 for the unit cost of various components in the system and to yang 2018 for the complete list of assumptions for the lcoe calculations 2 5 assessment of the interaction effect one of the important aims of this study was to quantify the effects of the hydrodynamic interaction between the wecs in an array system all simulation cases were therefore simulated twice using two sets of hydrodynamic properties of the wecs such as added mass damping and excitation forces in the first simulation the hydrodynamic properties of all of the wecs in an array were identical to the single unit wec i e hydrodynamic interaction effects were not included in the second simulation the hydrodynamic properties of all of the wecs in the array were simultaneously solved using the bem to obtain unique hydrodynamic properties of each wec to capture their hydrodynamic interactions by comparing the results from the two simulations the effect from the hydrodynamic interaction between two wecs could be determined two interaction measures were defined for each wec k the interaction ratio with regard to power performance i p k and the interaction ratio for the accumulated fatigue damage of the mooring lines i f k as 5 i p k p k interact p k 6 i f k f k interact f k where the denominators p k and f k represent the estimated power performance and the accumulated mooring fatigue damage respectively of the k th wec in an array without considering the interaction effect in the simulation model p k interact and f k interact represent the estimated power performance and the accumulated mooring fatigue damage respectively of the k th wec of the same array when the hydrodynamic interaction was considered in the simulation model 3 simulation models with the wec buoy identical to the wec buoy utilised in the waveel system fig 4 illustrates the two mooring configurations considered in this study the first configuration the 3 moor wec system was proposed with a reference to the installed mooring configuration at runde c f fig 1 and the second configuration the 2 moor wec system was proposed in ringsberg et al 2020 as a possible design candidate with a better economic viability by virtue of the reduced number of mooring components the 3 moor wec system was designed for a water depth of 75 m whereas the 2 moor wec was designed for a water depth of 200 m the two systems presented in fig 4 are hereafter referred to as the reference single unit wec systems their geometric configurations are detailed in table a2 and table a3 each reference system was further analysed with three simulation models two 2 wec models with different separation distances and one 10 wec model of a candidate to an array system sections 3 1 and 3 2 motivate the configuration of the simulation models and present their descriptions the description of the simulated environmental load conditions is presented in section 3 3 3 1 two wec simulation models the 2 wec simulation models are defined by two identical single unit wec systems which are similar to either of the reference wec systems c f fig 4 no mechanical coupling occurs between the two wecs e g the mooring systems do not share mooring lines or floaters thus the only interaction between the two wecs is derived from the hydrodynamic interaction effects fig 5 shows the four 2 wec model configurations 2 single unit systems 2 separation distances for each system that were considered for every two 2 wec models with the same mooring configuration the separation distance between the wecs is the only difference between the simulation models the influence of the separation distance on the interaction effect between the wecs has been investigated by bozzi et al 2017 chen et al 2016 kara 2016 and singh and babarit 2014 among others the recommendations and findings from these publications were partly employed when the separating distances were determined but additional criteria and requirements were also considered the distances of 250 m and 50 m were justified by a criterion in which the footprint should be kept as small as possible to reduce its cost factor in the lcoe calculation these two distances also represented the shortest distance possible for each respective mooring configuration and anchor positions that ensured that no clashing would occur between the wecs and their mooring lines the longer separation distance was determined using the q factor concept babarit 2013 budal 1977 evans 1979 falnes 1980 which gives a value for the interaction effect between two wecs a q factor calculation requires a large number of systematic simulations where all incident load directions are considered at different separation distances between the wecs in this study the incident wave load was represented by a regular wave where its direction varied from 0 to 345 at an interval of 15 note that wind and current loads were not considered for each wave load direction d i r wave the power performance i p in eq 5 was calculated according to the procedure presented in sections 2 2 and 2 5 the q factor was then obtained as the average value of the calculated i p values for each wave load direction a large number of separation distances between the two un moored wecs ranged from 25 m to 10 km the bem was applied in the frequency domain analyses where the b pto for the two wecs was set to 40 180 kn m using the wave period of 5 s which is the resonance period of a single unit wec without its mooring system fig 6 a shows the calculated average i p values of the two un moored wecs for various d i r wave the results are shown for a 180 degree circumference as the remaining half results are symmetric against the d i r wave of 0 and 180 fig 6 b shows the mean i p values of all simulated d i r wave namely from 0 to 345 the assessment of the simulation results showed that separation distances of 200 m and 600 m yield q factor values of 1 088 and 1 075 respectively which were the two largest calculated values among all 2 wec cases consequently 200 m was chosen as the second separation distance for the 2 wec 2 moor model and 600 m was selected as the second separation distance for the 2 wec 3 moor model the q factors for separation distances of 50 m and 250 m were 1 063 and 1 062 respectively 3 2 ten wec array simulation model in ringsberg et al 2020 tens of designs of array patterns and mooring configurations were evaluated by several criteria including the perspective of operation and maintenance lcc lcoe and risk from their investigations the startbuoy and lessismoor systems emerged as the top two candidates they are shown in fig 7 both systems adopt a shared mooring system between the two wecs that was found to be a solution for the reduction in the lcoe of the waveel concept waves4power 2018 the shared mooring system enables the use of a short separation distance between two individual wec units however due to the small separation distance between the wecs and the shared mooring components with mechanical couplings both the mechanical coupling and the wave interaction effects are expected to affect the fatigue lives of the mooring lines power performance of the array system and lcoe value hence these two configurations were selected for a detailed analysis since they are considered the most promising candidates for future installation as large scale array farms hereafter a sub unit system is defined as one wec and multiple mooring legs that are connected to it section 4 presents the results from the simulations and analyses and the discussion of each 10 wec array consists of ten sub unit wec systems the starbuoy system consists of multiple wecs mooring lines floaters and anchors every sub unit in the starbuoy system is grouped with three mooring legs the number k marks the identity of each wec as shown in fig 7 a and was utilised to distinguish the mooring lines the moorings in the systems were named w k moor l where the index k shows to which wec they are connected and index l marks the identity of each mooring leg 1 3 the mooring segments that connect a floater to a gravity anchor are defined as w k moor out and w k moor in which specify the segments that connect a floater to the hub anchor in the centre one exception exists in this naming convention namely the mooring segment w 11 moor out is a line segment connected to the sub unit wec system number 10 the identity of each wec in lessismoor is presented in fig 7 b the lessismoor system has two mooring legs in each sub unit system each mooring leg has only one segment which moors the wec directly to the sea floor 3 3 environmental load conditions irregular environmental loads which consist of waves winds and ocean currents were simulated the modelling of different loadings followed the recommendation in dnv gl 2017 and the duration of each sea state was taken as 3 h to provide sufficient statistics for the fatigue analysis of the mooring lines dnv gl 2015 the sea state was defined by the peak wave period significant wave height and spectral peak parameter and followed the jonswap spectrum an ocean current was modelled the current load was time and depth independent and defined solely by the current velocity magnitude the wind load was defined by the wind velocity at the reference height of 10 m above the sea water level this configuration followed the recommendations in dnv gl 2017 that the wind load should be modelled by the npd wind spectrum with the profile exponent and friction defined as 0 12 and 0 002 respectively in our previous work a large number of simulations were presented for the installed wec system at runde using a scatter diagram yang 2018 in the current study the three sea states with the highest probabilities of occurrence in the scatter diagram were prioritised for a detailed analysis these states are presented in table 3 and are referred to as the environmental conditions ecs these three ecs approximately correspond to mild moderate and harsh operating conditions for the reference waveel wec furthermore ec1 and ec2 were the two most frequently observed sea states during the measurement period on waveel during the period of june 2017 to november 2017 the wave wind and current loads were assumed to align in the same incidence load direction namely d i r wave d i r wind d i r curr d i r load figs 5 and 7 each ec was simulated with d i r load and covers a broad range of possible scenarios for each array with a 15 degree interval all of the models were simulated for a range of 90 except for the startbuoy model the latter was simulated for a 180 degree range this condition generated 21 load cases for each 2 wec simulation model and the lessismoor model 3 ecs 7 d i r load and 39 load cases for the starbuoy simulation model 3 ecs 13 d i r load 4 results this section presents the results obtained from the numerical simulations and the assessment of the interaction effects section 4 1 presents the power performance section 4 2 presents the fatigue analysis of the mooring lines and the lcoe calculations are presented in section 4 3 following the methodology described in section 2 5 the results are presented as fractions i e normalised against the results obtained without the consideration of the hydrodynamic interaction the absolute values of the time averaged absorbed power p and 3 h accumulated fatigue damage f of the two considered single unit wec systems are presented in fig 8 a and fig 8 b respectively as the reference for the following discussion 4 1 power performance fig 9 presents the power interaction factor i p values calculated from the simulations using the 2 wec simulation models while the denominator in eq 5 was calculated according to section 2 5 due to the lack of mechanical coupling between the wecs the value of the denominator should be the same as the value obtained from the simulations using a single unit wec system c f fig 8 a both alternatives were compared for numerous load cases and yielded a difference of less than 0 01 the small difference is attributed to the realisation of the wave field which differs in the two locations where the wecs are positioned the average and standard deviations of the data points in fig 9 are calculated in table 4 and table 5 respectively the results show that most of the power interaction factor values are near unity 1 these results indicate that the hydrodynamic interactions between the two wecs have only a minor effect on the simulated load cases thus this energy will neither be lost nor gained for the investigated wec system note that the predicted magnitude of i p in fig 9 is at a level similar to the level of the data reviewed in babarit 2013 in which the power performance either increased or decreased by a maximum of 10 when the separating distance was between 10 and 20 radii of the wec buoy for an array of less than 10 wecs using the results from table 4 namely the results from the coupled time domain simulations the q factors were always smaller than those calculated from the frequency domain simulations c f fig 6 these observations imply that the frequency domain simulations may cause an overprediction of the overall energy harvest of wec array systems note that these coupled time domain simulations included the full mooring system and that the simulations were carried out for irregular sea state conditions with the current and wind loads included these simulations are considered more realistic than the frequency domain simulations the latter did not include the mooring system and were limited to a regular wave at the resonant wave period of the un moored wec irrespective of the mooring configuration the interaction effect is more pronounced at shorter separating distances and decays with longer separating distances this effect is observed by larger standard deviations of i p values c f table 5 for both wecs at a shorter separation distance the trend was deemed reasonable as theoretically the diffraction wave field decays as the distance increases mei et al 2018 the hydrodynamic interactions between the wecs tend to yield a destructive effect on the wecs power performance i e i p 1 when the separation distance is small the difference in the i p values between the two wecs decreases as the ec becomes more energetic ec1 ec2 ec3 this observation was attributed to two factors the corresponding wave period increases from ec1 to ec3 as shown in e g borgarino et al 2012 the interaction factor tends to converge to 1 as the wave period increases the second factor was attributed to the restraint from the mooring system when the sea states become more energetic the restraint from the moorings dominates the dynamics of each sub unit system therefore the impact of the hydrodynamic interactions decreases the results in fig 9 show that the incident load direction d i r load has some influence on the power interaction factors when the environmental loads are aligned with the two wecs i e d i r load 0 the i p value for the wec on the leeward side i e wec2 is less than that for the wec on the windward side the predicted power performance of wec1 is mostly smaller than that for wec2 when d i r load is between 0 and 30 for a d i r load of 75 a converse relationship appears however the effect of the incident load direction also shows some dependence on the separation distance the relation of the i p values between the two wecs exhibits more similarity between the 250 m 2 wec 3 moor model and the 200 m 2 wec 2 moor model than the other 2 models by taking the average of all values from each d i r load the results revealed that wec1 always exhibits a better power performance than wec2 irrespective of the mooring configuration and the ec fig 10 presents the i p of the lessismoor and starbuoy systems regarding the lessismoor system one observation from the ec1 results is that a person can achieve a positive maximum gain of 5 if the array system is oriented in a smart way while a poor orientation can yield a maximum loss of 7 the influence of the direction dependence of the incident load direction is larger for lessismoor relative to the 2 wec 2 moor simulation models for instance the wecs located on the leeward side of the array always show a worse power performance than other wecs on the windward side however similar to the observation made in the 2 wec simulation models the relative difference in i p between the two wecs is smaller for the ec2 results and almost insignificant for the ec3 results this observation reconfirms the importance of including the mooring effect when investigating the hydrodynamic interaction effect among the three considered ecs the i p values are always less than unity 1 if a person calculates the average value of all simulated load cases for each ec namely average of the first column in each sub figure of fig 10 this finding implies that a destructive effect on the power performance is more likely to occur in a large array system the observations made for the starbuoy system follow the same pattern as employed for the lessismoor system except that the former shows an even greater scatter in the i p results between the wecs and the different load cases for two reasons first the separation distances between the wecs in starbuoy is shorter which yields a stronger influence of the hydrodynamic interactions and second starbouy has a shared mooring component with the mechanical couplings which also affects the response for the full system in addition to the hydrodynamic interactions the result highlights the importance of performing coupled time domain simulations for the analysis of wave energy array farms where complex responses due to hydrodynamic interactions and mechanical couplings must be understood refer to the fatigue analysis in section 4 2 4 2 fatigue analysis of mooring lines this section presents the results of the calculations of the fatigue interaction factor i f the results are presented for the mooring line that showed the largest accumulated fatigue damage during a 3 h sea state simulation for the two single unit reference wec systems and the ecs in table 3 this location was always located at the fairlead point of the mooring line that faced the windward side of d i r load refer to the prediction of f in fig 8 b an assessment of all fatigue damage results for the array systems confirmed this finding independent of whether the hydrodynamic interactions were considered in the simulation models consequently the presented values of the fatigue interaction factor i f were obtained in the fairlead point of the mooring line that faced the windward side of d i r load most fig 11 presents the i f results for the 2 wec simulation models the corresponding average and standard deviation are presented in table 6 and table 7 respectively for every two wecs in a 2 wec model the wec that shows the larger i p value usually also shows the larger i f value the variation in the i f values of each sub unit wec system with regard to the incident load direction follows the same pattern of the i p results discussed in section 4 1 however no clear correlation is observed between the change rate of the i p values and the change rate of the i f values the hydrodynamic interaction shows a larger impact on the mooring fatigue than the power performance i e the calculated i p values are closer to unity note however that the large variation in the i f results should be analysed with care due to the large value of the fatigue exponent m which was used to calculate the mooring fatigue the value of the fatigue exponent m in eq 2 is large hence small variations in fatigue stress ranges between the individual mooring lines produce large differences in their accumulated fatigue damage results fig 12 exemplifies the potential uncertainty in the fatigue calculation in fig 12 a the stress range components at the most fatigue critical points of the two wecs with a separation distance of 600 m are presented the presented load case is ec3 with a d i r load of 30 one of the load cases that shows a large difference in the calculated i f values by a factor of 4 between the wecs but less than 1 difference in the i p values as shown in fig 12 a the stress components of the moorings at the two wecs are similar with a relative difference at an average of 3 in terms of the number of stress cycles in the same stress range these identified stress cycles generate a large difference in the calculated fatigue damage f as shown in fig 12 b at the m value of 13 46 the difference in the calculated f values for the two wecs decreases as the m value decreases for instance the common fatigue exponent m for steel mooring chains is 3 dnv gl 2015 the large fatigue exponent m also makes the mooring fatigue prediction more sensitive to the realisation of the wave and wind loads which were sampled by the software using pseudo random numbers sintef ocean 2017a 2017b one example is shown in fig 13 each load case was simulated using three different wave and wind realisations after extracting the stress responses over the 3 h simulations the mooring fatigue was calculated using 2 different values of the fatigue exponent the results show that the predicted f and i f values are less sensitive namely less scattered to the differences in load realisation when a smaller m value is utilised nonetheless the results also showed that the overall trend in the calculated accumulated fatigue damage f and fatigue interaction factor i f can be well captured even using a single load realisation to confine the overall computational effort below an acceptable limit the majority of the results presented in this study is based on one load generation and only a few random chosen cases were simulated for three load realisations to ensure the overall prediction credibility note that the calculation of the absorbed power p and the power interaction factor i p are insensitive to the variation in the load generations the parametric sensitivity study showed that the relative differences in the p and i p values between various load realisations never exceeded 0 1 the fatigue value is the accumulated fatigue damage after 3 h of simulation and the power value is based on the mean power value calculated after 3 h of simulation the former presents a cumulative value that is affected directly by the small and large stress ranges in the fatigue damage calculation while the latter saturates to a value that becomes less sensitive to fluctuations during long simulation times based on the overall positive correlations between the i p fig 9 and i f fig 11 results we highlight the need to consider factors other than the power performance when evaluating the interaction effects of a wec array farm further investigations however remain to be completed to confirm the mooring fatigue properties and hence a more accurate fatigue prediction can be achieved the fatigue assessment of the mooring lines of the lessismoor and starbuoy systems is presented in fig 14 note that the results for the d i r load of 150 and 330 for starbuoy are both symmetric as expected but the slight asymmetry shown in fig 14 d and 14 e was due to the asymmetric grouping of mooring segments into sub unit systems refer to fig 7 irrespective of the array system configuration the results show that the majority of the moorings have an i f value less than one for all load cases which indicates that the hydrodynamic interaction affects the current mooring design positively by decreasing the fatigue damage of the moorings and increasing their fatigue lives however the results also show that the scatter of i f values in the 10 wec systems is significantly larger than that obtained in the 2 wec simulation models the observations indicate that when a large array system is being considered evaluation of the entire system as a whole is crucial to achieve a comprehensive understanding of the system performance an additional note is made regarding the absolute value of the fatigue damage for the starbuoy system refer to fig 15 the results are shown for the model run in a 3 h simulation without considering the hydrodynamic interactions thus the mechanical coupling in the mooring design was the only interaction effect considered in the model the results in fig 15 showed that many of the sub unit wec systems in starbuoy have significantly larger f values than the single unit 3 moor system in a similar load case moreover a few moorings that achieve relatively high f results always exist and present as a fatigue critical point in the system the phenomenon was even more evident in ec1 when the moorings have not reached their full restraining functionality refer to the discussion related to fig 9 this observed trend of damage increase was similar to the observation in gao and moan 2009 who discovered that the horizontal lines in a shared mooring system may suffer from exceptionally large horizontal motion and thus larger stress response and fatigue damage caused by two adjacent wecs moving with a phase difference or in opposite directions the simulation results confirmed that these mooring lines are the weak links of the mooring system and must be addressed in the design of the mooring system or maintenance planning a comparison of the results between the single unit wec case and the starbuoy array system without considering the hydrodynamic interaction in the simulation model shows that the power performance is similar this result was deemed reasonable and expected as the mooring systems for every sub unit in starbuoy has been designed to provide a similar stiffness as shown in the reference single unit system 4 3 lcoe analysis the results presented in sections 4 2 and 4 3 show that when the hydrodynamic interaction between the wecs was considered in the simulation models the wecs power performance was relatively unaffected i p 1 and the fatigue life of most of their mooring lines increased i f 1 even though some exceptions appeared in this section lcoe calculations are presented the results discussed in the previous sections are used to quantify the influence of the hydrodynamic interaction on the lcoe value initial calculations denoted as lcoeinitial were carried out as the reference for all simulation models and the waveel reference wec system they are hereafter referred to as case study systems the installed power of each wec was assumed to be 125 kw i e p k p ref 125 kw refer to section 2 4 and all other costs were calculated according to their configurations and the number of components in their respective systems the mooring lines in the reference wec system were originally designed to be replaced two times during the 25 year design target life n change original 2 and the corresponding cost was included in c 5 note that n change denotes the total replacement namely replacing every single mooring attached to one wec table 8 summarises the initial cost estimation for all of the case study systems in the lcoe calculation two primary factors are directly connected to the influence from the hydrodynamic interaction effects the power performance p k and the expected replacement of the entire mooring system for one wec n change p k in eq 4 was replaced by the product between p k and the calculated value of the interaction factor i p k and n change was calculated as the rounded off value of the product between the original value of n change original and the calculated value of i f k each wec in the respective array systems was treated individually where its i p and i f values were determined based on the simulation results presented in sections 4 1 and 4 2 the calculation of lcoe including the interaction effect was hereafter referred to as lcoeinteract fig 16 presents a summary of the results obtained from the lcoe calculations for the 2 wec case study systems since the lcoe value is directly affected by the values of i p and i f a large number of lcoe calculations are carried out using the results discussed in sections 4 1 and 4 2 the x axis range corresponds to the lower and upper values of i f and the y axis range corresponds to the lower and upper values of i p refer to figs 9 and 11 the fraction lcoeinteract lcoeinitial is calculated for a large number of combinations and plotted as contours a value less than one is favourable for all of the investigated two wec arrays the interaction effect could possibly contribute to a reduction in lcoe of 12 or to an increase of 30 where the largest variation in the lcoe results occurred in the case of the 50 m 2 wec 2 moor system a similar estimation of lcoeinteract was made for the lessismoor and starbuoy systems fig 17 owing to the large range of variation in i p and i f between the ten sub units from the numerical simulations a concentrated area surrounded by a dotted line was highlighted in the figure this region covers the exact maximum and minimum of ten wec averaged interaction factors calculated from the respective loading cases the hydrodynamic interaction between the wecs shows a much larger impact on the lcoe of the 10 wec system the lcoe of the system can be reduced by at most a factor of 2 or increased by a factor of 7 focusing on the concentrated area the interaction effect can possibly contribute to a reduction in lcoe of 50 or an increase in lcoe of 85 for the starbuoy system comparatively the interaction effect contributes to a reduction in lcoe of 40 or an increase in lcoe by a factor of three within the concentrated area for the lessismoor system the results presented in fig 17 highlight the need to investigate the effect of the interaction among the wecs for a realistic economic estimation of the large array systems 5 discussion 5 1 effect of the radiated wave on the interaction effect the numerical simulations in this study were performed using a coupled analysis approach however this choice limits us to the study of the diffraction induced hydrodynamic interaction only if the mooring lines are simulated in a quasi static manner the complete hydrodynamic interactions including both the radiated wave and diffracted wave can be simulated in the dnv gl sesam package this approach is often referred to as the de coupled analysis approach gao and moan 2009 davidson and ringwood 2017 it is presented in the right track of fig 3 fig 18 presents example results for the i p of the 2 wec simulation models calculated using a de coupled simulation procedure a comparison between the results in figs 9 and 18 shows only a minor difference in the calculated i p therefore we conclude that the lack of radiation induced hydrodynamic interaction in the coupled analysis procedure has a negligible impact on the results presented in section 4 1 i e the diffraction induced hydrodynamic interaction governs the hydrodynamic interaction for the current case study system fig 19 presents one example of the time histories of the simulated force response using the two approaches the results show a large difference in the axial force response where the de coupled approach does not capture the dynamics of the mooring lines since the de coupled analysis approach cannot be employed to simulate a complex mooring system such as the design in the starbuoy array system model the coupled analysis approach is considered superior and is the recommended option in numerical simulations and investigations that require modelling of the hydrodynamic interaction effects and their impact on e g the fatigue of moorings and cables in wec systems note however that the presented sensitivity study is deemed valid in this study with a confined study set and sesam simulation framework further investigation is needed in the future to verify whether the conclusion is generally applicable for other array configurations or loading conditions 5 2 effect of incident load directions on the interaction effect the load conditions tested in this study assumed that all of the incident directions of wave wind and current are aligned in the same direction this assumption was made as it presents the most fatigue critical condition to the mooring lines yang 2018 dnv gl 2015 in reality however environmental loads may act from different directions and verification of whether the observations made in the previous sections remain valid if the incident directions of various loads differ is important fig 20 presents some i p and i f results for the 2 wec 3 moor simulation model the load case was defined similarly to ec2 except that the incident directions of different loads are varied in addition to the d i r wave defined according to the values presented in fig 20 d i r wind and d i r curr are defined as 30 and 45 relative to the waves respectively the chosen non collinear condition follows the recommendation in dnv gl 2015 comparing the results between figs 20 a and fig 9 e the change in the incident load directions in the wind and currents in relation to the waves shows no influence on the power interaction factor i p the interaction effect on the power performance is governed by the incident direction of the waves the effect of variation in the incident load directions is however more evident for the fatigue interaction factor i f irrespective of the combination of incident load directions all of the results in terms of overall trend and magnitude presented in fig 20 b were similar to the results for the load case with a d i r load of 60 as shown in fig 11 e the similarity was attributed to the fact that for all of these cases they can be categorised as the same condition where the incident load directions have inclination angles to the alignment of the 2 wec model and hence the observation made with regard to the hydrodynamic effect on the mooring fatigue was similar the observations made for the 2 wec model are also valid for the 10 wec system with one addition refer to the example results for the starbuoy system in fig 21 due to the presence of mechanical couplings different moorings exhibit a larger or smaller influence from the hydrodynamic interactions overall the results presented in figs 20 and 21 with other results presented in sections 4 1 and 4 2 confirmed that the hydrodynamic interaction must be considered in a system analysis of a full wec system and wave farm furthermore the structural integrity of moorings and the power performance of a wec should always be considered concurrently for a realistic assessment of the wec array system this study shows that the design of wave energy array systems is a complex task simple and easy to use tools and models are necessary this investigation highlights the necessity of the initial development and use of relatively detailed and complex simulation models which can be further simplified as we learn which parameters and effects are important to consider depending on the purpose of the model and study 5 3 q factor for the two wec four 2 wec models with various separation distances were investigated in this study the shorter separation distances namely 50 m for 2 wec 2 moor model and 250 m for 2 wec 3 moor model were determined by the clearance needed for the mooring configuration and the other two longer separation distances were determined using the q factor concept fig 6 presents the calculated q factor for a large number of combinations of separation distance and load direction for the two un moored wecs the results in fig 6 a are similar to the classical results presented in babarit 2013 note however that the q factor is a measure influenced by the array layout wave characteristic load directions and seabed bathymetry among others moreover various ways to quantify the total interaction effect by using the q factor exist but are not considered in this study the chosen distance of 200 m or 600 m in this study should not be interpreted as the optimum distance for the two wecs with regard to the power performance rather this distance is worthy of further investigation by time domain analysis refer to babarit 2013 for a detailed review of the application and limitations of the q factor concept 6 conclusions this study investigated the hydrodynamic interactions among the wecs in an array system with regard to the power performance and fatigue damage of mooring lines this study also examined how these interactions may affect the lcoe value obtained from an lcoe calculation a specific point absorbing floating wec concept was employed as a reference configuration to create four 2 wec simulation models and two 10 wec simulation models two types of mooring configurations were considered the simulation models were utilised for three different ecs in which the incident wave wind and ocean current load directions were varied the results obtained from the 2 wec simulation models showed that the hydrodynamic interaction has only a weak influence on the calculated power interaction factor i p which on average was close to unity 1 while minor deviations were observed among the three ecs and incident load directions the influence of the hydrodynamic interaction on the power was generally weak for the studied wec system and separation distances for the accumulated fatigue the results showed a clear influence of the hydrodynamic interaction using the 2 wec simulation models and a larger variation in the results among the simulated ecs the inclusion of the hydrodynamic interaction in all of the simulated load cases caused an impact on the fatigue interaction factor which ranged from an 80 reduction to an increase in the accumulated fatigue damage by a factor of 4 the 10 wec array systems showed that the effect of the hydrodynamic interaction on the average power absorption of the 10 wecs ranges from 17 to 23 depending on the incident load direction for the simulated ecs fatigue analyses showed a stronger influence of the hydrodynamic interaction in which the predicted fatigue damage can be varied by more than tenfold the study showed that the lcoe calculations were most affected by the cost terms which included the costs related to the mooring lines since the hydrodynamic interaction influenced the fatigue life of the moorings more than the time averaged power absorption in the case study with the 2 wec simulation models with different separation distances the lcoe value was either reduced by a maximum of 12 or increased by a maximum of 30 when the hydrodynamic interaction was included in the simulation models for the 10 wec models the interaction effect contributed to a reduction in the lcoe value of 40 or an increase in the lcoe value by a factor of three here the absorbed power also contributed to this effect among different wec models the close proximity between the wecs and the mechanical coupling between the wecs and the moorings were sources for the stronger effect of the hydrodynamic interaction furthermore numerical simulations of multi wec array farms showed that hydrodynamic interactions among wecs in an array farm strongly affect the fatigue damage of moorings which influence the related cost assessment of a wec system the results concluded that the hydrodynamic interaction effect between two wecs must be considered for a realistic economic estimation of the wec array system and that the fatigue damage of moorings should also be included as one evaluation criterion of the array performance in the early design stage credit authorship contribution statement shun han yang conceptualization methodology software investigation writing original draft writing review editing visualization jonas w ringsberg conceptualization writing original draft writing review editing supervision funding acquisition erland johnson conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial support provided by the swedish energy agency for the project entitled simulation model for operation and maintenance strategy of floating wave energy converters analysis of fatigue wear and influence of biofouling for effective and profitable energy harvesting through contract no p36357 2 we also thank the swedish company waves4power https www waves4power com for providing the wec system configuration and information about the runde test site professor lars bergdahl at chalmers university of technology is acknowledged for the valuable advice and discussions appendix a main properties of the case study wec systems table a 1 hydrodynamic and mechanical properties of the reference waveel system waves4power 2018 table a 1 wec mass m wec metric tonnes 268 42 draft d wec m 15 265 pto damping in heave dof b pto kns m 40 180 installed power performance at runde test site p kw 125 mooring system cross sectional outer diameter d m m 0 080 mass of each mooring segment m m kg m 4 9 axial stiffness e a m mn non linear as expressed in fig a2 breaking load of the polyester mooring material n b mn 1 176 fig a 1 profile view and geometrical dimension of the wec buoy unit metres fig a 1 fig a 2 axial stiffness of the polyester mooring described in terms of the load elongation diagram fig a 2 table a 2 geometric configuration of the 3 moor wec systems table a 2 water depth h m 75 length of mooring segments of the two wec pair l seg 1 and l seg 2 m 96 0 64 3 length of mooring segments of the starbuoy system l moor 1 l moor 2 l moor 3 l moor in and l moor out m 78 4 85 2 85 2 63 0 63 0 table a 3 geometric configuration of the 2 moor wec systems table a 3 water depth h m 200 length of mooring segments of the two wec pair l seg 1 m 194 5 length of mooring segments of the lessismoor system l moor 1 and l moor 2 m 194 5 
