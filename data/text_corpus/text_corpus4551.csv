index,text
22755,the influence of surface waves on the hydrodynamic performance of an autonomous underwater vehicle auv could be significant when the auv sails near the water surface in this paper the hydrodynamic performance of an axisymmetric auv in coupled wave current flows is numerically studied using a two phase computational fluid dynamics cfd method the cfd method is validated with existing experimental data the influences of waves are quantitatively analyzed for different wave heights reynolds numbers and submerged depths of the auv the flow structures are characterized to better understand the interaction mechanism between the auv and the waves it is found that the variation of the lift of the auv is significantly affected by the wave and that the average drag increases with the increased wave height and decreased submerged depth keywords autonomous underwater vehicle auv wave computational fluid dynamics cfd hydrodynamics drag underwater vehicle 1 introduction autonomous underwater vehicles auvs are a kind of self sailing self executing underwater robots which play an important role in expanding our knowledge of the ocean and are capable of a wide range of applications such as pipeline inspection wang et al 2017 underwater search and rescue mine sweeping edwards et al 2007 and oceanographic exploration botelho et al 2005 when performing tasks auvs need to periodically ascend to the water surface for gps positioning and data communication the hydrodynamic performance of the auv is highly susceptible to free surface and waves when the auv is approaching the surface the hydrodynamic performance of the auv is critical to its attitude control and has therefore received the attention of many researchers when evaluating the hydrodynamic performance of an auv it is generally considered that the auv is far away from the water surface and the influence of the free surface is ignored there have been a number of experimental investigations on the hydrodynamic tests of auvs choi et al 2015 gertler 1950 granville 1953 hackett et al 2000 huang et al 1978 molland and utama 1997 nakayama and patel 1973 palmer et al 2009 saeidinezhad et al 2015 techy et al 2000 zedan and dalton 1979 zedan and dalton 1979 made a critical comparison between the drag characteristics based on volume surface area and frontal area for different axisymmetric bodies molland and utama 1997 investigated the components of viscous drag and viscous interaction effects of two axisymmetric bodies in close proximity saeidinezhad et al 2015 carried out wind tunnel experiments to study the behavior of a submarine model with a non axisymmetric nose at a range of pitch angle palmer et al 2009 studied the forces and moments of an auv with rim driven thrusters mounted in through body tunnells techy et al 2000 performed full scale wind tunnel tests of the seaglider underwater vehicle to identify the force and moment coefficients of the glider in recent years the computational fluid dynamics cfd technology has made great progress and is favoured by many researchers to predict the hydrodynamic performance of underwater vehicles lee et al 2011 qi et al 2018 randeni et al 2015 tang et al 2009 tian et al 2017 wang et al 2013 wu et al 2014 randeni et al randeni et al 2015 presented numerical simulations to obtain the hydrodynamic coefficients of an auv when operating close to a larger underwater body using the steady state interaction forces tang et al 2009 used the cfd method to estimate the hydrodynamic coefficients of the auv tuna sand that had a complex block like structure tian et al 2017 combined cfd simulations and a genetic algorithm to optimize the layout of an auv fleet to minimize the drag wu et al 2014 performed transient simulations of an auv docking with a dock based on the dynamic mesh method it should be noted that the reynolds averaged navier stokes rans model was commonly applied to compute the hydrodynamic forces on underwater vehicles in addition the above numerical studies used single phase flow methods that did not consider the effects of gravity and free surface it is known that the water surface has significant effect on the hydrodynamics of auvs which traverses near the free surface some researchers have used experimental or cfd methods to study the influence of free surface on the hydrodynamic performance of an auv jagadeesh et al 2009 mansoorzadeh and javanmard 2014 nematollahi et al 2015 shariati and mousavizadegan 2017 jagadeesh et al 2009 presented a towing tank based experimental study on hydrodynamic forces and moment on an auv hull near free surface they also used a cfd method using the rans equations together with the volume of fluid vof model for the force predictions and compared the numerical results with the corresponding experimental results nematollahi et al 2015 numerically investigated the hydrodynamic characteristics of an auv model and its interaction with the free surface using cfd software ansys cfx the numerical results were validated with experimental results presented by jagadeesh et al 2009 and good agreements were observed shariati and mousavizadegan 2017 studied the effect of appendages on the hydrodynamic characteristics of the darppa suboff underwater vehicle near the free surface the above literature review shows that studies on the hydrodynamics of auvs are extensive although some researchers have studied the effects of free surface on the hydrodynamic forces of auvs these studies assumed a flat water surface and did not considered the influences of surface waves to the authors knowledge there have been no cfd studies on auvs operating in waves this paper aims at investigating the hydrodynamic performance of an auv in wave current coupled flows with a cfd method the influences of the wave height the submerged depth and the reynolds number will be quantitatively analyzed 2 problem description 2 1 the auv geometry the auv considered in this paper is a conventional torpedo like body with a length of l a 2 00 m a maximum diameter of d a 0 20 m and a mass of m a 51 75 kg the two dimensional sketch of the auv is shown in fig 1 the auv body can be generally divided into three sections the nose section the middle section and the tail section the length of the three sections are 0 30 m 1 20 m and 0 50 m respectively in order to obtain a low drag shape the nose shape of the auv is designed based on the myring equation myring 2016 which is widely used in the design of auv hulls joung et al 2012 the expression for the nose shape is determined by 1 r x 1 2 d a 1 x l h x 2 1 1 8 where x is the position along the rotation axis r is the radius at a specific x l h is the length of the nose section the tail section is smoothly transited from the mid section to a circular cone which has a cone angle of 20 the diameter of the rear surface is 0 05 m the specific values of the geometrical parameters are listed in table 1 2 2 parameters definition in order to more clearly describe the parameters of the wave and the auv a coordinate system oxy is set at the center of buoyancy of the auv the dimensional parameters of the wave are shown in fig 2 where l is the wave length h is the wave height s is the submerged depth of the auv and h is the depth of the water the waves are scaled to a length of 2l a 4 m using the steepness h l the wave steepness varies from 0 to 0 05 which are close to the characteristics of natural surface waves the relative depth h l of the waves is h l 1 and classifies the waves as deep waves dean and dalrymple 2000 the upstream flow velocity u varies from 0 5 m s to 4 m s and the corresponding length based reynolds number varies from re 1 106 to 8 106 three non dimensional coefficients are used to describe the hydrodynamic forces of the auv 2 c d f x 1 2 ρ s a u 2 3 c l f y 1 2 ρ s a u 2 4 c m f z 1 2 ρ s a u 2 l a where c d c l and c m are the coefficients of drag lift and pitch torque of the auv respectively f x is the drag f y is the lift m z is the pitch torque ρ is the water density and is equal to 998 kg m3 s a is the maximum cross sectional area of the auv this study focuses on investigating the hydrodynamic characteristics of the auv subjected to surface waves with three key factors taken into consideration the wave height h the submerged depth s and the reynolds number re therefore the simulation cases are classified into three groups as listed in table 2 both the wave height and the submerged depth are normalized using the auv diameter to eliminate the dimensional effect 3 numerical method taking into account the effects of gravity and waves a series of transient three dimensional cfd simulations were carried out to evaluate the performance of the auv for each simulation case listed in table 2 the cfd code ansys fluent v15 0 is used to solve the rans equations using a second order accurate finite volume discretization scheme 3 1 governing equations the governing equations are given by the reynolds average navier stokes rans equations including the continuity equation and momentum equation as shown below ansys 2011 5 ρ t ρ v i x i 0 6 t ρ v i x i ρ v i v j p x i x j μ v i x j v j x i 2 3 δ ij v l x l x j ρ v i v j f i where v i are the velocity components p is the total pressure f i are the external body force components μ is the dynamic viscosity the velocity v i is the sum of the time averaged value v i and the fluctuation v i the shear stress transport sst k ω turbulence model was selected to model the turbulence terms of the rans equations the sst k ω turbulence model is able to model the transport of turbulent shear stress and gives accurate predictions on the onset and amount of flow separation under adverse pressure gradients yu et al 2008 compared the standard k ε the rng k ε and the sst k ω turbulence models in predicting the drag of an auv and found that the sst k ω turbulence model was the most accurate the turbulent kinetic energy k and special dissipation rate ω are computed from the equations below ansys 2011 7 t ρ k x i ρ k v i x j γ k k x j g k y k s k 8 t ρ ω x j ρ ω v j x j γ ω ω x j g ω y ω d ω s ω where g k and g ω represents the generation of k and ω due to turbulent mean velocity gradients respectively γ k and γ ω are the effective diffusivity y k and y ω represent the dissipation of k and ω due to turbulence d ω is the cross diffusion term s k and s ω are user defined source terms the vof method is used to determine the shape and location of the water surface due to wave propagation this method is based on the concept of air water mixture velocity hirt and nichols 1981 9 v i σ v i a 1 σ v i w where σ is the volume fraction and is equal to 1 when an element is fully occupied by air v i a and v i w are the velocities for the air phase and the water phase respectively the third order stokes wave theory is used for the nonlinear wave generation in deep depth range the generalized expression for wave profiles is 10 ζ x t a cos α a 2 k b 22 a 2 k 2 b 24 cos 2 α a 3 k 2 b 33 a 2 k 2 b 35 cos 3 α the generalized expression for the associated velocity potential is 11 φ x t c a a 11 a 2 k 2 a 13 a 4 k 4 a 15 cosh k h sin α a 2 k a 22 a 2 k 2 a 24 cosh 2 k h sin 2 α a 3 k 2 a 33 a 2 k 2 a 35 cosh 3 k h sin 3 α the wave frequency ω w is defined as 12 ω w g k 1 a 2 k 2 c 3 a 4 k 4 c 5 tanh k h 1 2 where c is the wave speed g is the gravity magnitude a mn b mn and c mn are functions of wave length and liquid height for shallow intermediate waves velocity components for surface gravity waves are derived from the velocity potential function 13 v x w a v e φ x cos θ w v y w a v e φ x sin θ w the details on the numerical expressions can be found in ansys 2011 3 2 computational domain and boundary conditions the computational domain is sized to allow for full development of the upstream wave and the downstream wake fig 3 shows the dimensions of the computational domain the domain is a rectangle with a length of 10 l a allowing 5 waves to propagate in the domain the upper part of the domain is filled with air and the lower part is filled with water the initial heights of the air and water are 10 d a and 20 d a respectively the auv is placed at a distance of 4l a to the left boundary and submerged at a specific depth below the free surface the blockage ratio of the water domain is 0 0013 which is small enough so that the blockage effect of the auv can be ignored the boundary conditions include 1 inlet open channel wave boundary with uniform inflow velocity 2 outlet open channel pressure outlet with relative atmospheric pressure of 0 pa set in the air region 3 no slip wall no slip wall conditions are imposed at the surfaces of the auv 5 smooth wall smooth wall conditions zero shear are imposed at both the top and the bottom boundaries 6 symmetry symmetry conditions are imposed at the two sides of the domain the propagation of waves is simulated by applying the open channel wave boundary to the left side of the domain shallow intermediate wave expressions are chosen for the finite water depth the height and length of the waves are set according to table 2 for different simulation cases the wave heading angle and phase difference are set as zero so that the wave has the same propagation direction with the inflow 3 3 mesh generation a high quality structured mesh is generated for the cfd simulations using the ansys icem tool the detailed grid elements for the mesh are shown in fig 4 grids density is higher within the wave elevation where both air and water exist with 50 nodes in the wave height range and 100 nodes in the wavelength range as shown in fig 4 b the grids density is also higher near the auv so that the control volumes are finer near the walls prism layer grid elements are extruded from the surfaces of the auv to improve the grid quality and to provide sufficient precision to describe the boundary layer flow fig 4 c the height of the first prism layer above the solid surfaces is set so that the y value for the first layer of elements from the wall is around 1 this y value is suggested for the use of the sst k ω turbulence model ansys 2011 the numerical results can be considered precise and valid if its solution is independent of the grid size therefore a mesh verification study is performed to evaluate the influence of grid resolution on the auv drag three sets of meshes are generated for the grid resolution verification which have approximately 8 4 million fine mesh 5 6 million intermediate mesh and 3 2 million coarse mesh cells respectively the verification simulations are performed at a submerged depth of s 4d a and an inflow velocity of u 1 m s without waves table 3 summarizes the results with different grid resolutions it can be seen that grids with approximately 8 4 million and 5 6 million elements give approximately the same results this indicates that further increasing the grid resolution would not significantly affect the cfd results therefore the grid with 5 6 million elements is chosen for the following simulations it should be noted that in order to accurately capture the wave surface the grid resolution in this paper is much higher than previous studies jagadeesh et al 2009 nematollahi et al 2015 shariati and mousavizadegan 2017 where the number of cells were less than 1 million 3 4 numerical method validation considering that no similar experiments were previously carried out validation of the numerical model is separated into two steps first the cfd model is validated using the experimentally measured drag of an auv operating at no wave conditions then it is validated with the wave elevation obtained from the stokes wave theory if the numerical method can predict the no wave drag and the wave shape accurately it can predict the performance of the auv in waves with accuracy the experiment conducted by jagadeesh et al 2009 is used for the validation of the numerical model at no wave conditions the experimental auv is an axisymmetric bare hull with a diameter of 0 14 m and a length of 1 4 m the coefficients of drag were measured for operating speeds ranging from 0 4 m s to 1 4 m s with an increment of 0 2 m s it should be noted that the coefficients of drag and reynolds numbers presented by jagadeesh et al 2009 were obtained according to the volume of the auv c d f x 0 5ρu 2 v 2 3 re ρuv 1 3 ρ where v is the volume of the auv but in this paper the hydrodynamic coefficients are calculated according to the cross sectional area equation 2 4 and the reynolds number is obtained according to the length of the auv re ρul a μ therefore the experimental data are reproduced according to the above equations and shown in fig 5 a it can be seen that the coefficient of drag decreases as the reynolds number increases the numerical results are in good agreement with the experimental values with a maximum relative error of 5 9 at re 0 56 106 and a minimum relative error of 1 9 at re 1 96 106 to verify the accuracy of wave surface the wave with a height of 0 4d a and a length of 2 l a is simulated using the presented cfd model the inflow velocity is set as zero fig 5 b shows the comparison of the wave elevation of the point just above the auv between the analytical solution and the cfd simulation good agreement is seen between the cfd and the analytical results it should be noted that due to the effect of viscosity the wave height predicted by the cfd method is slightly smaller than the analytical result 4 results and discussion 4 1 general flow characteristics in order to clearly explain the effect of waves on the hydrodynamic performance of the auv it is necessary to first analyze the flow structures of the entire wave flow field fig 6 shows the flow structures at t 10s for the case of s 6d a h 0 4 d a several typical features can be observed in the figure 1 wave surface the wave propagates from left to right within the flow field the iso surface of the volume fraction σ 0 5 is defined as the wave surface the air phase is above the wave surface and the water phase is below the wave surface 2 crests and troughs the crests and troughs are alternately arranged on the wave surface resulting in periodic high velocity and low velocity flow regions in the domain 3 high velocity and low velocity regions from the velocity contours in the vertical plane it is observed that the high velocity region is located below the crest while the low velocity region is located below the trough 4 periodic horizontal flows from the velocity contours in the horizontal plane it can be seen that the auv undergoes periodic horizontal flows which are caused by the high velocity and low velocity regions 5 auv wake the auv wake is in a continuously expanding band distributed downstream of the auv there is an interaction between auv wake and the external wave flow 6 the velocity distributions of the air are opposite to that of the water the air velocity is higher near the trough and lower near the crest in general the flow in the entire domain changes periodically along the flow direction due to the influence of waves this periodic flow will inevitably affect the hydrodynamic characteristics of the auv 4 2 effect of wave height on the hydrodynamic characteristics of the auv in order to study the effect of wave height on the hydrodynamic characteristics of the auv simulations are performed at different wave heights group 1 in table 2 the selected wave height range is h 0 0 8d a and the case of h 0 no wave is used as a reference for the comparison of the auv hydrodynamic characteristics under waves fig 7 shows the instantaneous coefficients of drag lift and pitch torque of the auv for five different wave heights according to the trend of the forces the curves can be divided into three main stages initial stable stage t 2s unstable oscillation stage 2s t 4 5 and stable oscillation stage t 4 5s such variation of the auv hydrodynamic forces are caused by the propagation of waves in the computational domain which can be explained by the distribution of the phases in the center plane in fig 8 in the initial stable stage the wave starts to propagate from the left boundary and is far from the auv so the auv has not been affected by the wave in this stage the auv can be considered to travel in approximate uniform flow and its forces tend to be stable in the unstable oscillation stage the wave head has arrived near the auv but the wave shape has not yet reached a steady state so the amplitudes of the forces are unstable in the stable oscillation stage the auv is affected by fully developed waves and its forces oscillate with nearly constant amplitudes it can also be found from fig 7 that for the no wave case h 0 the drag lift and torque get converged after t 4 s under wave conditions the forces oscillate with respect to the converged forces of the no wave case the oscillation amplitude increases with the wave height the drag lift and torque have the same oscillation period which is about 1 15 s and is very close to the theoretical period of the wave 1 14 s in order to quantitative evaluate the effect of wave height on the drag lift and torque the average value and the amplitude of the forces are provided in table 4 and the corresponding coefficients are plotted in fig 9 the average coefficients are obtained by averaging the instantaneous coefficients over a wave period as can be seen from fig 9 a the average drag coefficient increases slowly with the wave height the average drag coefficient for the case of h 0 8d a is 9 6 higher than that for the case without wave the amplitude of the drag coefficient increases approximately linearly with the wave height the amplitude of drag coefficient for the case of h 0 8d a is 0 8457 which is 451 3 higher than the average although the coefficients of lift and torque are zero for the case without wave both the mean and amplitude of them increases with the wave height for a specific wave height the amplitude of the lift is the highest meaning that the lift is more severely influenced by the wave height in short the average value and amplitude of the auv hydrodynamic forces increase with the increase of wave height and the lift is more sensitive to the change of wave height although the variation of the hydrodynamic forces is clear the reasons behind the phenomenon need to be explained here the case of h 0 6d a is chosen as an example to explain the reasons from the aspect of flow structures fig 10 a shows the variation of the hydrodynamic force coefficients in the time period of t 8 10s the curves are similar to sinusoidal curves but the phase of the drag curve lags behind the lift curve by about 1 4 cycle that is the lift coefficient is near the average value when the drag coefficient reaches its peaks considering this feature four peak points on the curve are selected which are t 8 26s 8 55s 8 84s and 9 13s respectively fig 10 b and c present the contours of velocity and pressure at the four points at t 8 26s the nose and tail of the auv are located below the trough and crest of the wave respectively the pressure is lower on the nose and higher on the tail resulting in a decrease in the pressure drag and a minimum of the auv drag the flow structures and pressure distributions at t 8 84s are opposite to the point of t 8 26s with higher pressure on the nose and lower pressure on the tail therefore the auv obtains a maximum drag at t 8 84s at t 8 55s the wave trough moves to the middle of the auv since the surface level at the wave trough is low the static pressure on the upper surface of the auv is lower and the lift coefficient reaches a maximum value at t 9 13s the wave crest moves to the middle of the auv resulting with an increase in the pressure on the upper surface of the auv therefore the auv lift coefficient reaches a minimum in addition the pitching torque is caused by the lift so its trend is consistent with the lift however due to the variable lift arm there is a phase difference between the torque and the lift in short the main reason for the periodic variation of the auv forces is the propagation of the crests and troughs along the auv axis in order to further explain the effect of wave height on the amplitude of the auv forces the velocity contours for different wave heights are compared in fig 11 the contours are plotted in the middle plane and at t 9 s by comparing the three contour figures the following reasons can be drawn firstly the increase in wave height exacerbates the velocity distribution of the flow field the greater the wave height the higher the velocity near the crest and the lower the velocity near the trough the increase in velocity fluctuations leads to a greater oscillation in the auv forces secondly the wave height has an important contribution to the pressure on the upper surface of the auv so the increase in wave height directly leads to an increase in lift amplitude in addition changes in the surface pressure will also affect the pressure drag of the auv thirdly the wave disrupts the symmetry of the flow around the auv and the increase in the vertical velocity of the particles is another reason for the increase in the auv hydrodynamic amplitude there are two main reasons for the increase of the average forces the first reason is the net forward velocity due to the stokes drift lust et al 2013 to verify this interpretation several velocity monitors at different water depths are set upstream of the auv as shown in fig 11 b the lengths of these monitors are equal to the wave length therefore the distribution of the stokes drift velocity can be approximated by averaging the water velocity on the monitors fig 12 a presents the velocity profiles for different wave heights and at a water depth of 4d a it can be found that at the same depth the amplitude of the water velocity increases with the wave height fig 12 b shows the depth average velocity for different wave heights in the cases with waves the greater the wave height the greater the velocity of the water near the wave surface which is an important reason for the increase in the average hydrodynamic forces it is also observed in fig 12 b that in the case without wave the average velocity gradually increases with the water depth which is contrary to the findings in the wave cases an possible reason is that flow turbulence causes friction between the phases near the free surface leading to a decrease of water velocity the second reason for the increase of the average forces is the fluctuation of the upstream velocity the velocity fluctuations upstream of the auv are greater at larger wave heights here velocities near the crest and the trough are respectively denoted as u u delt and u u delt where u delt is the fluctuation of the velocity according to equations 2 4 the hydrodynamic forces are proportional to the square of the incoming flow velocity ie f u 2 therefore the forces and the wave flows have the following relationship f 0 5 u u d e l t 2 u u d e l t 2 u 2 u d e l t 2 this equation proves that even if the mean upstream velocity is constant the average forces increase with the velocity fluctuation 4 3 effect of submerged depth on the hydrodynamic characteristics of the auv in order to study the effect of submerged depth on the hydrodynamic characteristics of the auv simulations are performed for different submerged depth conditions group 2 in table 2 the evaluated depth range is s 2 8d a fig 13 shows the instantaneous coefficients of drag lift and pitch torque of the auv for four different depths the hydrodynamic coefficients reach stable oscillation after t 4 5s the oscillation amplitudes of the forces decrease with the increase of the submerged depth the drag lift and torque have the same oscillation period the average value and the amplitude of the drag lift and torque are provided in table 5 and the corresponding coefficients are plotted in fig 14 as can be seen from fig 14 a the average drag coefficient decreases slowly with increasing submerged depth the average drag coefficient for the case of s 8d a is 10 6 lower than that for the case of s 2d a as the submerged depth increases the amplitude of the drag coefficient gradually decreases and the slope of the curve becomes smaller which means that the greater the water depth the less influence the wave has on the auv drag the performance of the lift and torque shows similar trends with that of the drag both the amplitude and the average value decrease with the increased submerged depth however the lift is more sensitive to the change of submerged depth fig 15 compares the velocity contours in the middle plane for four different depths at t 9s the velocity distributions of the four cases are similar except for the submerged depth of the auv when the auv is close to the water surface the fluctuation of the upstream flow velocity is greater which is the main reason for the change of the auv hydrodynamic amplitude to quantitatively evaluate the velocity distributions at different depths a velocity monitor is set directly upstream of the auv the length of the monitor is equal to the wave length therefore the average upstream velocity can be approximated by averaging the water velocity on the monitor fig 16 a presents the velocity profiles on the velocity monitors it is found that the amplitude of the water velocity decreases with the increased submerged depth fig 16 b shows the variation of the average upstream velocity at different submerged depths it is clear that the average upstream velocity decreases as the water depth increases which contributes to the decrease in the average forces of the auv 4 4 effect of reynolds number on the hydrodynamic characteristics of the auv in order to study the effect of reynolds number on the hydrodynamic characteristics of the auv simulations are performed at four different reynolds numbers re 1 10 6 8 10 6 group 3 in table 2 fig 17 shows the instantaneous coefficients of drag lift and pitch torque of the auv for the four cases it is clear that the amplitude of the force coefficients decreases as the reynolds number increases in fact the values of the lift and pitch torque of the auv are not much different at different reynolds numbers as shown in table 6 since high reynolds numbers correspond to larger upstream velocities the coefficients of the hydrodynamic forces are significantly reduced according to equation 2 4 in addition the oscillation period of the auv forces decreases as the reynolds number increases with the reynolds number increasing from 1 10 6 to 8 10 6 the oscillation period is reduced from 1 34 s to 0 62 s the propagation periods of waves can be theoretically obtained by dividing the wavelength by the sum of the uniform flow velocity and the wave speed i e t l u c the wave speed c can be approximately calculated based on the linear wave assumption 14 c l g 2 π tan h 2 π h l the theoretical periods of the waves at the four reynolds numbers are 1 33s 1 14s 0 89s and 0 62s respectively which are in good agreement with the cfd results the coefficients of the mean and amplitude of the hydrodynamic forces on the auv at different reynolds numbers are shown in fig 18 as described above since higher reynolds numbers correspond to larger inflow velocities the amplitude of the drag lift and the torque decreases as the reynolds number increases it is also found that the average value of the hydrodynamic forces also decreases with the increase of reynolds number in particular the law that the coefficient of drag decreases with increasing reynolds number is consistent with previous experimental results jagadeesh et al 2009 this is because that the inflow velocity increases the pressure drag without significant change in the frictional resistance therefore the coefficient of drag decreases with increase in reynolds number the decrease in the average lift and torque may be attributed to the fact that the wave is blocked by auv causing the water surface above the auv to rise the inflow velocity increases the height of the water surface and reduces the average lift and torque fig 19 compares the velocity contours in the middle plane for different reynolds numbers at t 9s the most obvious difference is the flow speed in the whole domain except this the flow structures at the four reynolds numbers are similar such as the wave surface and auv wake table 6 suggests that the amplitudes of the hydrodynamic forces have no big differences at different reynolds numbers this implies that amplitudes are dominated by the wave the increase in the inflow velocity leads to an increase in the auv drag 5 conclusions the hydrodynamic performance of an auv under the influence of waves is evaluated by a two phase transient cfd method the influences of the wave height the submerged depth and the reynolds number are quantitatively analyzed through the analysis of the transient performance mean performance and flow structures of the auv the following conclusions can be drawn 1 the hydrodynamic forces of the auv show regularly periodic fluctuations under the influence of waves and the fluctuation period coincides with the wave propagation period the period of the forces decreases as the reynolds number increases the phase of the drag lags behind the lift by about 1 4 wave period the main reason for the variation of the drag and lift is the propagation of the crests and troughs along the auv axis 2 both the mean and the amplitude of the hydrodynamic forces increase with the wave height due to the effects of the stokes drift and upstream velocity variation 3 both the mean and the amplitude of the hydrodynamic forces decrease with the increased submerged depth and reynolds number 4 the amplitudes of the hydrodynamic forces are much larger than the mean at higher wave heights and smaller submerged depth the variation of the lift is more sensitive to the change of wave height this means that the auv may encounter difficult control problems under the influence of surface waves especially the stable control of dive depth and attitude this paper carried out simulations on a captive auv which is fixed in water and the motion characteristics is not considered the auv is a bare hull without propellers according to the analysis of the wave flow field it is certain that the propulsion performance of the propeller will also be affected by the waves therefore future work needs to study the performance of the auv with propellers under the influence of waves acknowledgment this research was supported by the national natural science foundation of china program no 51809214 and natural science basic research plan in shaanxi province of china program no 2018jq5042 appendix a supplementary data the following is the supplementary data to this article tianwenlong mail nwpu edu cn tianwenlong mail nwpu edu cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 007 
22755,the influence of surface waves on the hydrodynamic performance of an autonomous underwater vehicle auv could be significant when the auv sails near the water surface in this paper the hydrodynamic performance of an axisymmetric auv in coupled wave current flows is numerically studied using a two phase computational fluid dynamics cfd method the cfd method is validated with existing experimental data the influences of waves are quantitatively analyzed for different wave heights reynolds numbers and submerged depths of the auv the flow structures are characterized to better understand the interaction mechanism between the auv and the waves it is found that the variation of the lift of the auv is significantly affected by the wave and that the average drag increases with the increased wave height and decreased submerged depth keywords autonomous underwater vehicle auv wave computational fluid dynamics cfd hydrodynamics drag underwater vehicle 1 introduction autonomous underwater vehicles auvs are a kind of self sailing self executing underwater robots which play an important role in expanding our knowledge of the ocean and are capable of a wide range of applications such as pipeline inspection wang et al 2017 underwater search and rescue mine sweeping edwards et al 2007 and oceanographic exploration botelho et al 2005 when performing tasks auvs need to periodically ascend to the water surface for gps positioning and data communication the hydrodynamic performance of the auv is highly susceptible to free surface and waves when the auv is approaching the surface the hydrodynamic performance of the auv is critical to its attitude control and has therefore received the attention of many researchers when evaluating the hydrodynamic performance of an auv it is generally considered that the auv is far away from the water surface and the influence of the free surface is ignored there have been a number of experimental investigations on the hydrodynamic tests of auvs choi et al 2015 gertler 1950 granville 1953 hackett et al 2000 huang et al 1978 molland and utama 1997 nakayama and patel 1973 palmer et al 2009 saeidinezhad et al 2015 techy et al 2000 zedan and dalton 1979 zedan and dalton 1979 made a critical comparison between the drag characteristics based on volume surface area and frontal area for different axisymmetric bodies molland and utama 1997 investigated the components of viscous drag and viscous interaction effects of two axisymmetric bodies in close proximity saeidinezhad et al 2015 carried out wind tunnel experiments to study the behavior of a submarine model with a non axisymmetric nose at a range of pitch angle palmer et al 2009 studied the forces and moments of an auv with rim driven thrusters mounted in through body tunnells techy et al 2000 performed full scale wind tunnel tests of the seaglider underwater vehicle to identify the force and moment coefficients of the glider in recent years the computational fluid dynamics cfd technology has made great progress and is favoured by many researchers to predict the hydrodynamic performance of underwater vehicles lee et al 2011 qi et al 2018 randeni et al 2015 tang et al 2009 tian et al 2017 wang et al 2013 wu et al 2014 randeni et al randeni et al 2015 presented numerical simulations to obtain the hydrodynamic coefficients of an auv when operating close to a larger underwater body using the steady state interaction forces tang et al 2009 used the cfd method to estimate the hydrodynamic coefficients of the auv tuna sand that had a complex block like structure tian et al 2017 combined cfd simulations and a genetic algorithm to optimize the layout of an auv fleet to minimize the drag wu et al 2014 performed transient simulations of an auv docking with a dock based on the dynamic mesh method it should be noted that the reynolds averaged navier stokes rans model was commonly applied to compute the hydrodynamic forces on underwater vehicles in addition the above numerical studies used single phase flow methods that did not consider the effects of gravity and free surface it is known that the water surface has significant effect on the hydrodynamics of auvs which traverses near the free surface some researchers have used experimental or cfd methods to study the influence of free surface on the hydrodynamic performance of an auv jagadeesh et al 2009 mansoorzadeh and javanmard 2014 nematollahi et al 2015 shariati and mousavizadegan 2017 jagadeesh et al 2009 presented a towing tank based experimental study on hydrodynamic forces and moment on an auv hull near free surface they also used a cfd method using the rans equations together with the volume of fluid vof model for the force predictions and compared the numerical results with the corresponding experimental results nematollahi et al 2015 numerically investigated the hydrodynamic characteristics of an auv model and its interaction with the free surface using cfd software ansys cfx the numerical results were validated with experimental results presented by jagadeesh et al 2009 and good agreements were observed shariati and mousavizadegan 2017 studied the effect of appendages on the hydrodynamic characteristics of the darppa suboff underwater vehicle near the free surface the above literature review shows that studies on the hydrodynamics of auvs are extensive although some researchers have studied the effects of free surface on the hydrodynamic forces of auvs these studies assumed a flat water surface and did not considered the influences of surface waves to the authors knowledge there have been no cfd studies on auvs operating in waves this paper aims at investigating the hydrodynamic performance of an auv in wave current coupled flows with a cfd method the influences of the wave height the submerged depth and the reynolds number will be quantitatively analyzed 2 problem description 2 1 the auv geometry the auv considered in this paper is a conventional torpedo like body with a length of l a 2 00 m a maximum diameter of d a 0 20 m and a mass of m a 51 75 kg the two dimensional sketch of the auv is shown in fig 1 the auv body can be generally divided into three sections the nose section the middle section and the tail section the length of the three sections are 0 30 m 1 20 m and 0 50 m respectively in order to obtain a low drag shape the nose shape of the auv is designed based on the myring equation myring 2016 which is widely used in the design of auv hulls joung et al 2012 the expression for the nose shape is determined by 1 r x 1 2 d a 1 x l h x 2 1 1 8 where x is the position along the rotation axis r is the radius at a specific x l h is the length of the nose section the tail section is smoothly transited from the mid section to a circular cone which has a cone angle of 20 the diameter of the rear surface is 0 05 m the specific values of the geometrical parameters are listed in table 1 2 2 parameters definition in order to more clearly describe the parameters of the wave and the auv a coordinate system oxy is set at the center of buoyancy of the auv the dimensional parameters of the wave are shown in fig 2 where l is the wave length h is the wave height s is the submerged depth of the auv and h is the depth of the water the waves are scaled to a length of 2l a 4 m using the steepness h l the wave steepness varies from 0 to 0 05 which are close to the characteristics of natural surface waves the relative depth h l of the waves is h l 1 and classifies the waves as deep waves dean and dalrymple 2000 the upstream flow velocity u varies from 0 5 m s to 4 m s and the corresponding length based reynolds number varies from re 1 106 to 8 106 three non dimensional coefficients are used to describe the hydrodynamic forces of the auv 2 c d f x 1 2 ρ s a u 2 3 c l f y 1 2 ρ s a u 2 4 c m f z 1 2 ρ s a u 2 l a where c d c l and c m are the coefficients of drag lift and pitch torque of the auv respectively f x is the drag f y is the lift m z is the pitch torque ρ is the water density and is equal to 998 kg m3 s a is the maximum cross sectional area of the auv this study focuses on investigating the hydrodynamic characteristics of the auv subjected to surface waves with three key factors taken into consideration the wave height h the submerged depth s and the reynolds number re therefore the simulation cases are classified into three groups as listed in table 2 both the wave height and the submerged depth are normalized using the auv diameter to eliminate the dimensional effect 3 numerical method taking into account the effects of gravity and waves a series of transient three dimensional cfd simulations were carried out to evaluate the performance of the auv for each simulation case listed in table 2 the cfd code ansys fluent v15 0 is used to solve the rans equations using a second order accurate finite volume discretization scheme 3 1 governing equations the governing equations are given by the reynolds average navier stokes rans equations including the continuity equation and momentum equation as shown below ansys 2011 5 ρ t ρ v i x i 0 6 t ρ v i x i ρ v i v j p x i x j μ v i x j v j x i 2 3 δ ij v l x l x j ρ v i v j f i where v i are the velocity components p is the total pressure f i are the external body force components μ is the dynamic viscosity the velocity v i is the sum of the time averaged value v i and the fluctuation v i the shear stress transport sst k ω turbulence model was selected to model the turbulence terms of the rans equations the sst k ω turbulence model is able to model the transport of turbulent shear stress and gives accurate predictions on the onset and amount of flow separation under adverse pressure gradients yu et al 2008 compared the standard k ε the rng k ε and the sst k ω turbulence models in predicting the drag of an auv and found that the sst k ω turbulence model was the most accurate the turbulent kinetic energy k and special dissipation rate ω are computed from the equations below ansys 2011 7 t ρ k x i ρ k v i x j γ k k x j g k y k s k 8 t ρ ω x j ρ ω v j x j γ ω ω x j g ω y ω d ω s ω where g k and g ω represents the generation of k and ω due to turbulent mean velocity gradients respectively γ k and γ ω are the effective diffusivity y k and y ω represent the dissipation of k and ω due to turbulence d ω is the cross diffusion term s k and s ω are user defined source terms the vof method is used to determine the shape and location of the water surface due to wave propagation this method is based on the concept of air water mixture velocity hirt and nichols 1981 9 v i σ v i a 1 σ v i w where σ is the volume fraction and is equal to 1 when an element is fully occupied by air v i a and v i w are the velocities for the air phase and the water phase respectively the third order stokes wave theory is used for the nonlinear wave generation in deep depth range the generalized expression for wave profiles is 10 ζ x t a cos α a 2 k b 22 a 2 k 2 b 24 cos 2 α a 3 k 2 b 33 a 2 k 2 b 35 cos 3 α the generalized expression for the associated velocity potential is 11 φ x t c a a 11 a 2 k 2 a 13 a 4 k 4 a 15 cosh k h sin α a 2 k a 22 a 2 k 2 a 24 cosh 2 k h sin 2 α a 3 k 2 a 33 a 2 k 2 a 35 cosh 3 k h sin 3 α the wave frequency ω w is defined as 12 ω w g k 1 a 2 k 2 c 3 a 4 k 4 c 5 tanh k h 1 2 where c is the wave speed g is the gravity magnitude a mn b mn and c mn are functions of wave length and liquid height for shallow intermediate waves velocity components for surface gravity waves are derived from the velocity potential function 13 v x w a v e φ x cos θ w v y w a v e φ x sin θ w the details on the numerical expressions can be found in ansys 2011 3 2 computational domain and boundary conditions the computational domain is sized to allow for full development of the upstream wave and the downstream wake fig 3 shows the dimensions of the computational domain the domain is a rectangle with a length of 10 l a allowing 5 waves to propagate in the domain the upper part of the domain is filled with air and the lower part is filled with water the initial heights of the air and water are 10 d a and 20 d a respectively the auv is placed at a distance of 4l a to the left boundary and submerged at a specific depth below the free surface the blockage ratio of the water domain is 0 0013 which is small enough so that the blockage effect of the auv can be ignored the boundary conditions include 1 inlet open channel wave boundary with uniform inflow velocity 2 outlet open channel pressure outlet with relative atmospheric pressure of 0 pa set in the air region 3 no slip wall no slip wall conditions are imposed at the surfaces of the auv 5 smooth wall smooth wall conditions zero shear are imposed at both the top and the bottom boundaries 6 symmetry symmetry conditions are imposed at the two sides of the domain the propagation of waves is simulated by applying the open channel wave boundary to the left side of the domain shallow intermediate wave expressions are chosen for the finite water depth the height and length of the waves are set according to table 2 for different simulation cases the wave heading angle and phase difference are set as zero so that the wave has the same propagation direction with the inflow 3 3 mesh generation a high quality structured mesh is generated for the cfd simulations using the ansys icem tool the detailed grid elements for the mesh are shown in fig 4 grids density is higher within the wave elevation where both air and water exist with 50 nodes in the wave height range and 100 nodes in the wavelength range as shown in fig 4 b the grids density is also higher near the auv so that the control volumes are finer near the walls prism layer grid elements are extruded from the surfaces of the auv to improve the grid quality and to provide sufficient precision to describe the boundary layer flow fig 4 c the height of the first prism layer above the solid surfaces is set so that the y value for the first layer of elements from the wall is around 1 this y value is suggested for the use of the sst k ω turbulence model ansys 2011 the numerical results can be considered precise and valid if its solution is independent of the grid size therefore a mesh verification study is performed to evaluate the influence of grid resolution on the auv drag three sets of meshes are generated for the grid resolution verification which have approximately 8 4 million fine mesh 5 6 million intermediate mesh and 3 2 million coarse mesh cells respectively the verification simulations are performed at a submerged depth of s 4d a and an inflow velocity of u 1 m s without waves table 3 summarizes the results with different grid resolutions it can be seen that grids with approximately 8 4 million and 5 6 million elements give approximately the same results this indicates that further increasing the grid resolution would not significantly affect the cfd results therefore the grid with 5 6 million elements is chosen for the following simulations it should be noted that in order to accurately capture the wave surface the grid resolution in this paper is much higher than previous studies jagadeesh et al 2009 nematollahi et al 2015 shariati and mousavizadegan 2017 where the number of cells were less than 1 million 3 4 numerical method validation considering that no similar experiments were previously carried out validation of the numerical model is separated into two steps first the cfd model is validated using the experimentally measured drag of an auv operating at no wave conditions then it is validated with the wave elevation obtained from the stokes wave theory if the numerical method can predict the no wave drag and the wave shape accurately it can predict the performance of the auv in waves with accuracy the experiment conducted by jagadeesh et al 2009 is used for the validation of the numerical model at no wave conditions the experimental auv is an axisymmetric bare hull with a diameter of 0 14 m and a length of 1 4 m the coefficients of drag were measured for operating speeds ranging from 0 4 m s to 1 4 m s with an increment of 0 2 m s it should be noted that the coefficients of drag and reynolds numbers presented by jagadeesh et al 2009 were obtained according to the volume of the auv c d f x 0 5ρu 2 v 2 3 re ρuv 1 3 ρ where v is the volume of the auv but in this paper the hydrodynamic coefficients are calculated according to the cross sectional area equation 2 4 and the reynolds number is obtained according to the length of the auv re ρul a μ therefore the experimental data are reproduced according to the above equations and shown in fig 5 a it can be seen that the coefficient of drag decreases as the reynolds number increases the numerical results are in good agreement with the experimental values with a maximum relative error of 5 9 at re 0 56 106 and a minimum relative error of 1 9 at re 1 96 106 to verify the accuracy of wave surface the wave with a height of 0 4d a and a length of 2 l a is simulated using the presented cfd model the inflow velocity is set as zero fig 5 b shows the comparison of the wave elevation of the point just above the auv between the analytical solution and the cfd simulation good agreement is seen between the cfd and the analytical results it should be noted that due to the effect of viscosity the wave height predicted by the cfd method is slightly smaller than the analytical result 4 results and discussion 4 1 general flow characteristics in order to clearly explain the effect of waves on the hydrodynamic performance of the auv it is necessary to first analyze the flow structures of the entire wave flow field fig 6 shows the flow structures at t 10s for the case of s 6d a h 0 4 d a several typical features can be observed in the figure 1 wave surface the wave propagates from left to right within the flow field the iso surface of the volume fraction σ 0 5 is defined as the wave surface the air phase is above the wave surface and the water phase is below the wave surface 2 crests and troughs the crests and troughs are alternately arranged on the wave surface resulting in periodic high velocity and low velocity flow regions in the domain 3 high velocity and low velocity regions from the velocity contours in the vertical plane it is observed that the high velocity region is located below the crest while the low velocity region is located below the trough 4 periodic horizontal flows from the velocity contours in the horizontal plane it can be seen that the auv undergoes periodic horizontal flows which are caused by the high velocity and low velocity regions 5 auv wake the auv wake is in a continuously expanding band distributed downstream of the auv there is an interaction between auv wake and the external wave flow 6 the velocity distributions of the air are opposite to that of the water the air velocity is higher near the trough and lower near the crest in general the flow in the entire domain changes periodically along the flow direction due to the influence of waves this periodic flow will inevitably affect the hydrodynamic characteristics of the auv 4 2 effect of wave height on the hydrodynamic characteristics of the auv in order to study the effect of wave height on the hydrodynamic characteristics of the auv simulations are performed at different wave heights group 1 in table 2 the selected wave height range is h 0 0 8d a and the case of h 0 no wave is used as a reference for the comparison of the auv hydrodynamic characteristics under waves fig 7 shows the instantaneous coefficients of drag lift and pitch torque of the auv for five different wave heights according to the trend of the forces the curves can be divided into three main stages initial stable stage t 2s unstable oscillation stage 2s t 4 5 and stable oscillation stage t 4 5s such variation of the auv hydrodynamic forces are caused by the propagation of waves in the computational domain which can be explained by the distribution of the phases in the center plane in fig 8 in the initial stable stage the wave starts to propagate from the left boundary and is far from the auv so the auv has not been affected by the wave in this stage the auv can be considered to travel in approximate uniform flow and its forces tend to be stable in the unstable oscillation stage the wave head has arrived near the auv but the wave shape has not yet reached a steady state so the amplitudes of the forces are unstable in the stable oscillation stage the auv is affected by fully developed waves and its forces oscillate with nearly constant amplitudes it can also be found from fig 7 that for the no wave case h 0 the drag lift and torque get converged after t 4 s under wave conditions the forces oscillate with respect to the converged forces of the no wave case the oscillation amplitude increases with the wave height the drag lift and torque have the same oscillation period which is about 1 15 s and is very close to the theoretical period of the wave 1 14 s in order to quantitative evaluate the effect of wave height on the drag lift and torque the average value and the amplitude of the forces are provided in table 4 and the corresponding coefficients are plotted in fig 9 the average coefficients are obtained by averaging the instantaneous coefficients over a wave period as can be seen from fig 9 a the average drag coefficient increases slowly with the wave height the average drag coefficient for the case of h 0 8d a is 9 6 higher than that for the case without wave the amplitude of the drag coefficient increases approximately linearly with the wave height the amplitude of drag coefficient for the case of h 0 8d a is 0 8457 which is 451 3 higher than the average although the coefficients of lift and torque are zero for the case without wave both the mean and amplitude of them increases with the wave height for a specific wave height the amplitude of the lift is the highest meaning that the lift is more severely influenced by the wave height in short the average value and amplitude of the auv hydrodynamic forces increase with the increase of wave height and the lift is more sensitive to the change of wave height although the variation of the hydrodynamic forces is clear the reasons behind the phenomenon need to be explained here the case of h 0 6d a is chosen as an example to explain the reasons from the aspect of flow structures fig 10 a shows the variation of the hydrodynamic force coefficients in the time period of t 8 10s the curves are similar to sinusoidal curves but the phase of the drag curve lags behind the lift curve by about 1 4 cycle that is the lift coefficient is near the average value when the drag coefficient reaches its peaks considering this feature four peak points on the curve are selected which are t 8 26s 8 55s 8 84s and 9 13s respectively fig 10 b and c present the contours of velocity and pressure at the four points at t 8 26s the nose and tail of the auv are located below the trough and crest of the wave respectively the pressure is lower on the nose and higher on the tail resulting in a decrease in the pressure drag and a minimum of the auv drag the flow structures and pressure distributions at t 8 84s are opposite to the point of t 8 26s with higher pressure on the nose and lower pressure on the tail therefore the auv obtains a maximum drag at t 8 84s at t 8 55s the wave trough moves to the middle of the auv since the surface level at the wave trough is low the static pressure on the upper surface of the auv is lower and the lift coefficient reaches a maximum value at t 9 13s the wave crest moves to the middle of the auv resulting with an increase in the pressure on the upper surface of the auv therefore the auv lift coefficient reaches a minimum in addition the pitching torque is caused by the lift so its trend is consistent with the lift however due to the variable lift arm there is a phase difference between the torque and the lift in short the main reason for the periodic variation of the auv forces is the propagation of the crests and troughs along the auv axis in order to further explain the effect of wave height on the amplitude of the auv forces the velocity contours for different wave heights are compared in fig 11 the contours are plotted in the middle plane and at t 9 s by comparing the three contour figures the following reasons can be drawn firstly the increase in wave height exacerbates the velocity distribution of the flow field the greater the wave height the higher the velocity near the crest and the lower the velocity near the trough the increase in velocity fluctuations leads to a greater oscillation in the auv forces secondly the wave height has an important contribution to the pressure on the upper surface of the auv so the increase in wave height directly leads to an increase in lift amplitude in addition changes in the surface pressure will also affect the pressure drag of the auv thirdly the wave disrupts the symmetry of the flow around the auv and the increase in the vertical velocity of the particles is another reason for the increase in the auv hydrodynamic amplitude there are two main reasons for the increase of the average forces the first reason is the net forward velocity due to the stokes drift lust et al 2013 to verify this interpretation several velocity monitors at different water depths are set upstream of the auv as shown in fig 11 b the lengths of these monitors are equal to the wave length therefore the distribution of the stokes drift velocity can be approximated by averaging the water velocity on the monitors fig 12 a presents the velocity profiles for different wave heights and at a water depth of 4d a it can be found that at the same depth the amplitude of the water velocity increases with the wave height fig 12 b shows the depth average velocity for different wave heights in the cases with waves the greater the wave height the greater the velocity of the water near the wave surface which is an important reason for the increase in the average hydrodynamic forces it is also observed in fig 12 b that in the case without wave the average velocity gradually increases with the water depth which is contrary to the findings in the wave cases an possible reason is that flow turbulence causes friction between the phases near the free surface leading to a decrease of water velocity the second reason for the increase of the average forces is the fluctuation of the upstream velocity the velocity fluctuations upstream of the auv are greater at larger wave heights here velocities near the crest and the trough are respectively denoted as u u delt and u u delt where u delt is the fluctuation of the velocity according to equations 2 4 the hydrodynamic forces are proportional to the square of the incoming flow velocity ie f u 2 therefore the forces and the wave flows have the following relationship f 0 5 u u d e l t 2 u u d e l t 2 u 2 u d e l t 2 this equation proves that even if the mean upstream velocity is constant the average forces increase with the velocity fluctuation 4 3 effect of submerged depth on the hydrodynamic characteristics of the auv in order to study the effect of submerged depth on the hydrodynamic characteristics of the auv simulations are performed for different submerged depth conditions group 2 in table 2 the evaluated depth range is s 2 8d a fig 13 shows the instantaneous coefficients of drag lift and pitch torque of the auv for four different depths the hydrodynamic coefficients reach stable oscillation after t 4 5s the oscillation amplitudes of the forces decrease with the increase of the submerged depth the drag lift and torque have the same oscillation period the average value and the amplitude of the drag lift and torque are provided in table 5 and the corresponding coefficients are plotted in fig 14 as can be seen from fig 14 a the average drag coefficient decreases slowly with increasing submerged depth the average drag coefficient for the case of s 8d a is 10 6 lower than that for the case of s 2d a as the submerged depth increases the amplitude of the drag coefficient gradually decreases and the slope of the curve becomes smaller which means that the greater the water depth the less influence the wave has on the auv drag the performance of the lift and torque shows similar trends with that of the drag both the amplitude and the average value decrease with the increased submerged depth however the lift is more sensitive to the change of submerged depth fig 15 compares the velocity contours in the middle plane for four different depths at t 9s the velocity distributions of the four cases are similar except for the submerged depth of the auv when the auv is close to the water surface the fluctuation of the upstream flow velocity is greater which is the main reason for the change of the auv hydrodynamic amplitude to quantitatively evaluate the velocity distributions at different depths a velocity monitor is set directly upstream of the auv the length of the monitor is equal to the wave length therefore the average upstream velocity can be approximated by averaging the water velocity on the monitor fig 16 a presents the velocity profiles on the velocity monitors it is found that the amplitude of the water velocity decreases with the increased submerged depth fig 16 b shows the variation of the average upstream velocity at different submerged depths it is clear that the average upstream velocity decreases as the water depth increases which contributes to the decrease in the average forces of the auv 4 4 effect of reynolds number on the hydrodynamic characteristics of the auv in order to study the effect of reynolds number on the hydrodynamic characteristics of the auv simulations are performed at four different reynolds numbers re 1 10 6 8 10 6 group 3 in table 2 fig 17 shows the instantaneous coefficients of drag lift and pitch torque of the auv for the four cases it is clear that the amplitude of the force coefficients decreases as the reynolds number increases in fact the values of the lift and pitch torque of the auv are not much different at different reynolds numbers as shown in table 6 since high reynolds numbers correspond to larger upstream velocities the coefficients of the hydrodynamic forces are significantly reduced according to equation 2 4 in addition the oscillation period of the auv forces decreases as the reynolds number increases with the reynolds number increasing from 1 10 6 to 8 10 6 the oscillation period is reduced from 1 34 s to 0 62 s the propagation periods of waves can be theoretically obtained by dividing the wavelength by the sum of the uniform flow velocity and the wave speed i e t l u c the wave speed c can be approximately calculated based on the linear wave assumption 14 c l g 2 π tan h 2 π h l the theoretical periods of the waves at the four reynolds numbers are 1 33s 1 14s 0 89s and 0 62s respectively which are in good agreement with the cfd results the coefficients of the mean and amplitude of the hydrodynamic forces on the auv at different reynolds numbers are shown in fig 18 as described above since higher reynolds numbers correspond to larger inflow velocities the amplitude of the drag lift and the torque decreases as the reynolds number increases it is also found that the average value of the hydrodynamic forces also decreases with the increase of reynolds number in particular the law that the coefficient of drag decreases with increasing reynolds number is consistent with previous experimental results jagadeesh et al 2009 this is because that the inflow velocity increases the pressure drag without significant change in the frictional resistance therefore the coefficient of drag decreases with increase in reynolds number the decrease in the average lift and torque may be attributed to the fact that the wave is blocked by auv causing the water surface above the auv to rise the inflow velocity increases the height of the water surface and reduces the average lift and torque fig 19 compares the velocity contours in the middle plane for different reynolds numbers at t 9s the most obvious difference is the flow speed in the whole domain except this the flow structures at the four reynolds numbers are similar such as the wave surface and auv wake table 6 suggests that the amplitudes of the hydrodynamic forces have no big differences at different reynolds numbers this implies that amplitudes are dominated by the wave the increase in the inflow velocity leads to an increase in the auv drag 5 conclusions the hydrodynamic performance of an auv under the influence of waves is evaluated by a two phase transient cfd method the influences of the wave height the submerged depth and the reynolds number are quantitatively analyzed through the analysis of the transient performance mean performance and flow structures of the auv the following conclusions can be drawn 1 the hydrodynamic forces of the auv show regularly periodic fluctuations under the influence of waves and the fluctuation period coincides with the wave propagation period the period of the forces decreases as the reynolds number increases the phase of the drag lags behind the lift by about 1 4 wave period the main reason for the variation of the drag and lift is the propagation of the crests and troughs along the auv axis 2 both the mean and the amplitude of the hydrodynamic forces increase with the wave height due to the effects of the stokes drift and upstream velocity variation 3 both the mean and the amplitude of the hydrodynamic forces decrease with the increased submerged depth and reynolds number 4 the amplitudes of the hydrodynamic forces are much larger than the mean at higher wave heights and smaller submerged depth the variation of the lift is more sensitive to the change of wave height this means that the auv may encounter difficult control problems under the influence of surface waves especially the stable control of dive depth and attitude this paper carried out simulations on a captive auv which is fixed in water and the motion characteristics is not considered the auv is a bare hull without propellers according to the analysis of the wave flow field it is certain that the propulsion performance of the propeller will also be affected by the waves therefore future work needs to study the performance of the auv with propellers under the influence of waves acknowledgment this research was supported by the national natural science foundation of china program no 51809214 and natural science basic research plan in shaanxi province of china program no 2018jq5042 appendix a supplementary data the following is the supplementary data to this article tianwenlong mail nwpu edu cn tianwenlong mail nwpu edu cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 007 
22756,this study experimentally investigates the mean and turbulent flow fields of a propeller jet impinging on a vertical quay wall four impingement distances namely wall clearances longitudinal distance between the propeller and vertical wall were used to examine their influence on the flow behaviors in order to investigate the characteristics of the three dimensional impinging jet both the streamwise jet central plane and transverse impingement plane flow fields were measured for each impingement distance using the particle image velocimetry piv technique based on the wall clearance three regions are identified namely free impingement and wall jet regions additionally the results show that the evolution of the impinging jet is governed by two mechanisms jet diffusion and wall obstruction their relative importance under varying wall clearances was interpreted in terms of the mean flow patterns and energy dissipation moreover the proper orthogonal decomposition pod method is employed to identify the dominant flow structures associated with these two mechanisms in terms of the pod modes and their corresponding dominant frequency which in turn provides a quantitative means to single out the individual flow mechanism keywords propeller jet impinging jet turbulent flow field piv pod 1 introduction ever since the age of discovery marine transport has been undergoing continuous development to satisfy the ever changing demands of the world trade permanent international association of navigation congresses pianc 2015 reported that during the last decade the shipping industry development was mainly portrayed by an increase in vessel capacity which inevitably is accompanied by the increase in engine power as the most widely used device for ships propulsions wang et al 2018 propellers produce a discharge of water with high kinetic energy which is referred to as the propeller jet wei et al 2017 due to its complex flow characteristics the swirling propeller jet has attracted extensive attention of many researchers a careful review of published literature reveals that most past studies are focused on free expanding propeller jet i e an unconfined jet in the absence of boundary effects induced by seabed or quay structures albertson et al 1950 berger et al 1981 blaauw and kaa 1978 felli et al 2006 2011 felli and falchi 2018 hamill and kee 2016 hamill et al 2015 hamill 1987 hsieh et al 2013 lam et al 2010 verhey 1983 moreover lam et al 2011 provided a thorough review of the empirical equations used to predict the velocity distribution within an unconfined propeller jet on the other hand the flow behaviors of a confined propeller jet which is more common in navigation channel and harbor basin i e in close proximity to the seabed or quay walls has not received the same kind of attention as its unconfined counterpart thus far limited studies on this issue are those by johnston et al 2013 and wei et al 2017 who examined plane bed boundary effects on the evolution of the propeller jet during vessel berthing and deberthing the jet from the rotating propeller blades directly impinges onto the quay structures either in the form of a vertical closed quay or slope wall open quay producing an impinging swirling jet consequently a quay structure near a ship propeller often undergoes scouring which is a growing concern as it may result in structural instability or even failure pianc 2015 documented that ship propeller induced jet flow is the main cause of local scour that forms around quay structures in harbor basins de gijt and broeken 2005 stated that the propeller induced scour hole might reach several meters in depth if the bed material is sand or non cohesive soils with low undrained shear strength hamill et al 1999 experimentally investigated the propeller induced scour hole around a vertical quay wall and found that due to wall confinement the maximum scour depth was significantly increased compared to that of an unconfined propeller scour especially for small wall clearances wei and chiew 2017 2018 studied propeller scour around an open quay with a slope and reported that the maximum scour depth can be either increased or decreased depending on the varying toe clearance longitudinal distance between propeller face and slope toe it may therefore be inferred from these studies that both the quay type and clearance have a close relationship with the impinging propeller jet and resulting scour depth however the underlying scouring mechanisms still have not been fully understood due to the lack of a detailed measurement of the impinging flow field although impinging jets have been widely studied due to its extensive industrial applications such as cooling heating and drying surfaces nozaki et al 2003 most of them were focused on turbulent heat transfer felli et al 2010 conducted an experimental study on swirling jet impingement by using a ducted propeller which is often used in the jetting industry however for ships especially those equipped with large propellers it is the non ducted propeller that is commonly used to gain higher speeds for a non ducted propeller jet its slipstream is without the confinement of a shroud and likely will feature different characteristics from a ducted one to the authors best knowledge studies on a ship propeller jet impingement upon a quay structure and its contributions to the associated scouring action have not been previously addressed since the impinging jet flow is the actual driving force to the potential scouring action this study is focused on examining the three dimensional flow behaviors of an impinging swirling jet generated by a non ducted ship propeller with a simple configuration of a vertical quay wall on a plane bed the mean and turbulent characteristics of the flow fields in both the streamwise and transverse planes are presented and discussed in terms of the observed flow patterns based on which a brief discussion of its implications on the related scouring mechanism is given furthermore the proper orthogonal decomposition pod method is applied to extract the dominant flow structure in the streamwise plane with a full picture of the development of the impinging propeller jet the results of this study are expected to provide an improved insight into the associated scouring mechanisms in future studies and to facilitate related numerical modelings 2 experimental setup the tests in this study were conducted in a recirculating flume with dimensions of 11 m length 0 6 m width and 0 7 m depth in the hydraulic modeling laboratory nanyang technological university the propeller model used is a five bladed wageningen b series propeller with an overall diameter d p of 7 5 cm and a hub diameter d h of 1 0 cm the geometrical properties of the propeller are given in table 1 although nearly all commercial vessels have a central rudder behind the propeller which can split the flow into an upper and lower jet robakiewicz 1966 fuehrer et al 1981 etc this study for the sake of simplicity as per many recently published articles in this area hamill and kee 2016 wei and chiew 2017 2018 etc has not included a rudder its inclusion clearly would have provided a more realistic behavior of the flow field of the propeller wash and should be included in future researches consequently in this study the final design of the propeller rig simply consists of a single screw propeller model the propeller rig was mounted on an appropriately designed movable carriage that spans transversely across the flume and could be moved along the longitudinal rail located on the sidewalls of the flume in such a way the propeller was able to operate at different clearances from the model quay wall namely the wall clearance x w which is defined as the longitudinal distance between the propeller face and vertical wall the quay model was built using an acrylic plate with a dimension of 60 cm height water level 60 cm width flume width 2cm thickness a photo of the experimental model setup is shown in fig 1 with the primary objective of examining the wall impingement effect on the development of a propeller jet the tests were performed at a constant propeller rotational speed of n 545 rpm revolution per minute with four wall clearances i e x w d p 2d p 3d p and 4d p each test was carried out under the bollard pull condition in still water with a depth of 0 6 m and the propeller axis was located at 0 3 m depth hsieh et al 2013 investigated a free expanding propeller jet in the same flume and suggested that the boundary effects of such a set up free surface bottom and sidewalls have negligible influence on the development of the jet the glass bottom and sidewalls of the flume enable optical observations through the use of the particle image velocimetry piv technique the piv system comprises a 5 w air cooling laser with a wavelength of 532 nm as the light source and a high speed camera the high speed camera used phantom miro m 120 with a nikkor 60 mm f 2 8 prime lens has a maximum resolution of 1920 1200 px2 12 bit depth and over 1200 maximum fps frame per second at 1152 1152 px2 aluminum particles with d 50 of 10 μm and specific density of 2 7 were used as seeding particles whose settling velocity is estimated to be 92 6 μm s using stoke s law and is negligible compared with the propeller jet velocity the beam emitted from the laser source passed through the optics resulting in a laser light fan of 1 5 mm thickness to avoid the undesirable effect due to possible free surface fluctuation the laser sheet was cast upward through the glass bottom of the flume a right handed coordinate system o xyz is adopted in this paper in which the origin is located at the center of the propeller disk the x axis is streamwise oriented along the bottom centerline the y axis along the spanwise oriented towards the starboard and the z axis along the upward vertical accordingly the velocity components u w and v w correspond to the x z and y z planes respectively to obtain the three dimensional characteristics of an impinging swirling jet both the streamwise central plane y 0 and the transverse impingement plane x x w were measured using the planar piv for the streamwise measurement the laser sheet was set to align with the propeller rotation axis as shown in fig 2 a for the transverse measurement the laser sheet was set to be immediately upstream of the vertical quay wall and perpendicular to the propeller axis and the field of view fov was captured through a 45 mirror located downstream of the transparent vertical wall as shown in fig 2 b the streamwise and transverse planes were measured at 300 fps and 1000 fps respectively and over 18 000 and 25 000 frames were recorded for each case in these two planes accordingly the total measuring time for the streamwise and transverse planes are over 60 s and 25 s respectively which are long enough for capturing sufficient cycles 2725 and 1135 of the periodic flow generated by the 5 bladed propeller rotating at 545 rpm for image post processing the laplacian filter function is used to reduce light reflection scattering by virtue of its ability to filter out low frequency signals and enhancing high frequency signals consequently time series vector calculations were performed in davis 8 4 0 in which a multi pass iteration with window sizes from 64 64 px2 to 32 32 px2 was adopted in the cross correlation analysis the size of the measured field of view and corresponding spatial resolution are tabulated together with the test conditions in table 2 the efflux velocity u o is defined as the maximum velocity taken from the mean velocity distribution across the initial efflux plane ryan 2002 it must be stated that since the propeller blades periodically pass through the efflux plane it is difficult to extract any meaningful data there as a result the efflux velocity values given in table 2 are taken as the maximum axial velocity in the vicinity of the actual efflux plane following blaauw and kaa 1978 the reynolds numbers of the jet flow r e f l o w u 0 d p ν and propeller r e p r o p n d p l m ν also are calculated and included in table 2 in which ν is kinematic viscosity of water and l m is the characteristic length dependent on the propeller geometry defined as l m β d p π 2 n 1 d h d p 1 3 time averaged mean flow patterns 3 1 streamwise flow field fig 3 shows the comparison of the time averaged mean streamwise velocity fields at the streamwise central plane y 0 under varying wall clearances for better understanding the results are presented in two ways 1 the upper row presents the contour map of the in plane mean velocity with the superimposed streamlines 2 the lower row shows the vector plot where the magnitude and direction of the velocity vector are u 2 w 2 and arctan w u respectively for easy comparison between different sub plots the same scaling of color bar and vector length are used for plots of contour and vectors respectively in addition the loci of the local maximum velocity in the upper and lower jet streams are also depicted in the vector plot by a red solid line representing the trajectory of each stream the recirculating region associated with the reverse flow u 0 is enveloped by a red dash line i e the contour line of u 0 furthermore since the horizontal and vertical axes have the same scale the figure is undistorted and the true shape of the jet is preserved the spread angle of the jet is thereby illustrated by two blue dash lines which will be discussed later the contour map in fig 3 shows that the wall effect on the flow structure is clearly discernible as the propeller jet is placed near a vertical wall and impinges onto it at a right angle consequently the measured efflux velocity and the associated r e f l o w are significantly reduced in the near clearance cases of x w d p and 2d p although r e p r o p was kept constant at the same rational speed see table 2 beltaos and rajaratnam 1974 studied the impingement of a turbulent jet from a nozzle onto a solid surface and identified three regions namely free jet impingement and wall jet regions the free jet region exists at some distance from the wall where wall perturbation is negligible and the impingement region possesses a relative high pressure gradient that deflects the flow direction to be parallel to the wall in the resulting wall jet region beltaos 1976 similarly as a propeller jet impinges onto a vertical wall it is expected that two mechanisms would govern the evolution of the jet i e jet diffusion dominant in the free jet region and wall obstruction dominant in the impingement region due to the presence of the hub at the center of the propeller disk the free expanding i e unconfined propeller jet is characterized by a double peak off center profile in the zone of flow establishment zfe and a single peak at the center in the zone of established flow zef at the small wall clearance of x w d p fig 3 a exhibits a noticeable spread out feature of the double peak profile hereinafter referred to as the upper and lower jet streams at the immediate near wake region downstream of the propeller face it may be inferred that the influence of the wall obstruction has extended to the propeller face leaving no space for the free jet region to form following the classification of beltaos 1976 the impingement region under the current context could be further divided into a pair of spread out jet streams and a triangle like recirculating zone denoted by the red dot line in the lower row of fig 3 between the spread out streams in which two recirculating eddies with opposite directions form on both sides of the centerline of propeller axis z d p 0 as is clearly illustrated by the streamlines in fig 3 a it should be noted that these two eddies are not perfectly symmetrical about the centerline which may be attributed to the instability of the hub vortex this will be further discussed in a later section by means of the transverse flow results when the two spread out jet streams impinge and attach onto the vertical wall at z d p 0 7 they resemble two wall jets one moving upward away from and the other downward towards the bed see fig 3 a similarly as the wall clearance increases to x w 2d p fig 3 b shows that wall obstruction still dominates the jet evolution since the upper and lower jet streams immediately spread out from the outset and no sign of the free jet region is present due to the larger wall clearance fig 3 b reveals a larger triangular recirculating zone that pushes the wall jet region farther upward downward toward z d p 1 when the wall clearance is increased to x w 3d p fig 3 c shows that jet diffusion appears to dominate wall obstruction because the double stream configuration red contour is able to take on a free jet pattern as those presented in hsieh et al 2013 and wei et al 2017 moreover unlike the development observed in figs 3 a and b fig 3 c shows that the size of the recirculating zone decreases with increasing wall clearance this possibly is attributed to the fact that most jet energy has been dissipated due to jet diffusion before it impinges onto the wall thus resulting in a less intense recirculating flow this is further confirmed in fig 3 d where the recirculating eddies have evidently diminished and replaced by a moderate flow deflection as inferred by the streamlines in fig 3 d additionally at x w 4d p the double stream configuration shows no obvious spread out feature until the jet approaches the near wall region around x d p 3 in order to quantify the development of the spread out feature the trajectories of the upper and lower jet streams are more explicitly illustrated in the lower row of fig 3 by a pair of curves red line representing the loci of the local maximum velocity by doing so one can identify the angle between the spread out potions of the loci curves in general figs 3 e and f show that after the initial spread out at the outset the two streams undergo a further deflection causing them to be parallel to the wall when the jet approaches the near wall region within 0 5d p upstream of the wall figs 3 g and h on the other hand show that the loci curves exhibit a quasi parallel to each other feature in the near wake i e the free jet region before spreading out in the near wall region within 1d p upstream of the wall it may therefore be concluded that in all the wall clearance cases a common wall enforced spread out is present in the near wall region which is directly related to the wall obstruction the spread out angle is also shown by drawing the tangential lines to the deflected curves at their inflection points the so obtained wall enforced spread angle is found to be reduced from 156 0 at x w d p to 98 5 at x w 4d p which quantitatively signifies a decreasing wall obstruction mechanism in summary based on the results of the streamwise measurement three regions with distinctive flow behaviors can be identified under varying wall clearances namely free jet impingement consists of spread out streams and recirculating eddies and wall jet regions it must be stated that a quantified demarcation between each region which likely is dependent on the wall clearances as well as the propeller type and rotational speed etc is beyond the scope of this study 3 2 transverse flow field the transverse mean velocity fields at the impingement plane under different wall clearance cases are depicted in fig 4 in which the left and central columns represent the mean lateral v and vertical w velocity components respectively the right column represents the in plane resultant velocity v 2 w 2 additionally the vectors and streamlines are also superimposed in the contour maps of the individual and resultant velocity plots respectively in the figure it is not hard to imagine that a horizontal circular jet without swirl will spread out radially in the form of concentric circles when it impinges onto a vertical wall and the decomposed velocity components will be axial symmetric about the centerline however this is not the case for a swirling impinging jet it is interesting to note that as the swirling jet impinges on the vertical wall with a small clearance the contour maps of the individual velocity components exhibit two interlocking spirals in the central core region as shown in figs 4 a and b in this study a left hand propeller was used which means that it rotates counterclockwise to provide the forward thrust as such inside the central swirling region the data in fig 4 a expectedly shows that the lateral velocity v is mainly positive and negative in the third lower left and first upper right quadrants respectively the same interlocking spirals feature is present in the vertical velocity component although fig 4 b is a 90 offset of fig 4 a outside the central swirling region the data reveal that the velocity distribution resembles that of the circular jet without swirl as a result the streamlines form a ring that divides the flow field into two distinctive portions an attracting spiral pattern hub vortex inside the ring and a repelling spiral pattern wall jet outside the ring see fig 4 c in particular the attracting spiral streamlines are consistent with the counterclockwise swirling rotation and their sink overlaps with the lowest velocity deduced from the background contour these two patterns are maintained until x w 3d p see figs 4 c f and 4 i it should be stated that neither the streamline ring is perfectly circular as compared to that of an unconfined jet shown in wei 2018 nor the sink point located at the symcenter this is possibly attributed to the instability of the hub vortex as it impinges onto the wall as suggested by felli et al 2010 who reported that the intensity of the hub vortex spiral decreases with increasing wall clearance which is also confirmed by the results of this study in that the two interlocking spirals progressively diminish as shown in figs 4 d e g and h when x w 4d p figs 4 j and k show no sign of the swirling spiral and the streamlines in fig 4 l exhibit a source flow pattern which reflects a wall jet flow prevailing along the wall as was also observed in the streamwise velocity results see fig 3 moreover the right column of fig 4 also presents the impinging flow field from the viewpoint of the in plane resultant velocity in which the central low velocity circle that represents the slow moving stagnation region is in reasonable agreement with the projection of the recirculating zone that is observed in the streamwise flow field 3 3 depth velocity profiles in order to further examine impingement effects on the individual velocity components the vertical profiles of u v and w at selected longitudinal locations x d p 2d p 3d p and 4d p are extracted from figs 3 and 4 and shown in fig 5 it should be noted that the v profiles are only available at the impingement plane of x x w since the transverse flow fields were only measured there for x w d p fig 5 a reveals that when the swirling jet impinges onto the wall both the v and w profiles exhibit the characteristic of an undulating type s curve specifically for the v profile the data exhibits a zero crossing point that dividing the profile into a negative upper and a positive lower half which signifies a counterclockwise swirling that complies with the propeller rotation one may therefore infer that the zero crossing point of v profile represents the center of the hub vortex whose location persists around z d p 0 on the other hand the undulating s shape curve associated with the w profile comprises three zero crossing points with two turning points the three points s1 s2 and s3 along the line of w 0 form at z d p 0 6 and 0 in which s1 s3 are zero up crossing and s2 is zero down crossing the zero up crossing is defined as the point where the sign of w changes from negative downward flow to positive upward flow with increasing z d p and vice versa therefore the former and latter points signify diverging and converging flow motions respectively specifically looking at the upper half profile for example as the upper jet stream impinges onto the wall it leads to a flow divergence thereby producing an upward flow and a downward flow at the upper zero up crossing point s1 this downward flow meets with the other upward flow that is affected by the lower jet stream at the middle zero down crossing point s2 consequently creating two recirculating eddies with opposite directions see fig 3 a it may therefore be surmised that the two zero up crossing points s1 and s3 pinpoint the locations where the spread out jet streams impinge onto the wall thereby causing the formation of recirculation eddies at the impingement plane for x w 2d p fig 5 b shows that at x d p the u profile indicates a symmetrical curve about the propeller axis i e z d p 0 with a pair of positive double peaks representing the upper and lower jet streams and a negative central zone that signifies the reverse recirculating flow similar to that in fig 5 a the w profile at x d p also features three zero crossing points however the direction of the flow reverses in that the zero down crossing points form on the upper and lower sides and the zero up crossing in the middle of the vertical axis beyond the upper and lower zero down crossing points the negative and positive vertical velocities reflect entrainment of the ambient stationary fluid into the jet streams conversely the w profile between them present a centrosymmetric form with a positive peak on the upper half and a negative peak on the lower half whose locations coincide with the double peak of the u profile indicating the spread out trend of the jet streams upon impingement fig 5 b shows that at x 2d p the w profile reverts to a curve that is similar to that of fig 5 a while the v profile shows an off center zero crossing point indicating that the swirling center has drifted due to the instability of the hub vortex a comparison of figs 5 c and d at x d p reveals that both the u and w profiles show reasonable agreement between these two wall clearance cases x w 3d p and 4d p indicating negligible interference from the wall and thus the free jet region persists there in particular the u profile shows the iconic double peak feature as that of a free propeller jet at the same time it is worth noting that the w profile features two zero down crossing points in the upper and lower sides and one zero up crossing point in the middle similar to that in fig 5 b as discussed earlier the zero up crossing point s2 reflects a diverging flow motion with upward w positive on its upper and downward w negative on its lower sides this profile could be a reflection of the self expansion of the jet in the absence of wall effects as the jet moves to x 2d p fig 5 c shows that the u profile exhibits a wider double peak and a very small axial velocity at the center when compared to those of fig 5 d which are respectively due to the spread out effect and the intrusion of the recircuiting zone induced by wall obstruction as for the w profile fig 5 c shows that it has a similar shape as that observed in the free jet region at x d p however it should be noted based on its u profile that the jet has already entered the impingement region where the wall obstruction would have dominated jet development therefore the diverging flow here could more likely be attributed to the influence of the wall rather than self expansion farther downstream fig 5 c shows that when the jet impinges onto the wall at x 3d p the w profile is found to revert to the s curve resembling those at x x w in figs 5 a and b albeit with reduced magnitude due to energy dissipation during the jet diffusion phase meanwhile the v profile shows that the lateral velocity has been significantly decreased compared to its counterparts in figs 5 a and b whereas the marginal native positive value in the upper lower halves still demonstrate a trace of the swirling rotation for x w 4d p fig 5 d shows that the w profile essentially loses all the undulating pattern at x 2d p indicating the cessation of free jet expansion afterwards the three zero crossing points which signifies the spread out motion of the jet streams reappear at x 3d p one may therefore deduce that the jet undergoes a further expansion which however is unlikely to be attributed to jet diffusion but rather wall effects at this juncture the wall obstruction also exerts a flattening effect on the double peak feature of the u profile eventually causing it to attach to the u 0 line at x x w in addition upon impingement at x x w 4d p the w profile shows an overlapped segment with w 0 within z d p 0 42 instead of three zero crossing points as shown in figs 5 a 5 c this is because the magnitude of the jet streams has been significantly reduced before they impinge onto the wall the absence of a vertical flow here explains why a recirculating flow region is not formed between the deflected upward downward wall jets see fig 3 d furthermore one may infer that if the jet was given more space to expand the two jet streams would have eventually merged into a single peak before x 4d p this is consistent with the suggestion of stewart 1992 who stated that an unconfined propeller jet would enter the zone of established flow at x d p 3 25 4 momentum exchange and energy dissipation 4 1 reynolds shear stress and vorticity field in streamwise plane fig 6 shows the distributions of non dimensional vorticity ω y d p u o and reynolds shear stress u w u o 2 in the upper and lower rows respectively and both of them are superimposed with the mean velocity vectors the out of plane vorticity is calculated by ω y w x u z and u o 0 60 m s is taken as the efflux velocity of the case of x w 4d p see table 2 which is assumed to be free of the wall effect as a propeller jet enters an open quiescent water body a shear layer referred to as the outer shear layer hereafter forms at the interface between the high velocity jet and the surrounding stagnant fluid in the case of an impinging jet due to the presence of the recirculating zone that forms between the spread out jet streams discussed earlier a secondary shear layer referred to as the inner shear layer hereafter develops at the interface of the spread out peaks and the inner reverse flow in the recirculating zone fig 6 clearly shows the formation of intense vorticities both along the outer and inner shear layers comparing the vorticity contour and the superimposed vectors it can be observed that the interface white color between the positive red color and negative blue color vorticities coincides with the loci of the peak velocity vector due to the dominant effect of wall obstruction when the wall clearance is small figs 6 a and b show that the intense vorticity occurs immediately in the near wake region of the propeller since the recirculating zone has extended there see figs 3 e and f however fig 6 c shows that the vorticity along the inner shear layer only appears to be pronounced beyond x d p 1 as the double streams start to spread out there which signifies the beginning of the impingement region as the wall clearance further increases fig 6 d shows that both the inner and outer vorticity tend to fade out due to increasing jet diffusion and decreasing wall obstruction effects a comparison of the distributions of reynolds shear stress and vorticity fields reveals that the regions of intense reynolds stress are at the same location as those with pronounced vortices this reinforces the fact that the magnitude of the reynolds shear stress is highly correlated with the presence of the vortices moreover the superimposed vectors show that the positive reynolds shear stress generally overlaps with a positive horizontal velocity gradient u z which in turn denotes a clockwise rotation of the vortex in other words a negative vorticity value and vice versa however a closer examination reveals that around the near wall region where the jet streams impinge onto the wall circled by red dash lines in figs 6 e f and g the sign of reynolds shear stress seems to be opposite to the velocity gradient that can be deduced from the superimposed vector plot this possibly is attributed to the fact that it is the higher vertical velocity gradient w x that dominates the shear layer there as its horizontal counterpart has been dampened by the vertical wall a similar phenomenon was also observed in the near wake region of a circular cylinder hsieh 2008 4 2 ake and tke distributions in streamwise and transverse planes the streamwise distributions of non dimensional average kinetic energy ake and turbulent kinetic energy tke superimposed with the mean vector plot are presented in fig 7 where a k e 1 2 u 2 w 2 u o 2 and t k e 3 4 u 2 w 2 u o 2 it must be stated that only the in plane velocity components are used here due to the two dimensional nature of the planar piv measurement as a result the tke calculation is based on the assumption of isotropic turbulence where v 2 1 2 u 2 w 2 chandrsuda and bradshaw 1981 sciacchitano and wieneke 2016 as its mathematical expression implies the ake distribution shown in fig 7 is inherently consistent with that of mean velocity distribution in fig 3 whereas the square operator further distinguishes the jet streams which contains most of the average kinetic energy from the relatively stagnant surrounding fluid a closer observation of the ake contour and the superimposed velocity vectors reveals that high ake region mainly concentrates in a narrow band along the loci of peak velocity vectors conversely the lower row of fig 7 shows that the high tke region is prominent in a wider band along the outer and inner shear layers as identified in fig 4 specifically at x w d p and x w 2d p where the wall obstruction is dominant figs 7 e and f show that the higher tke zone basically resides in the inner shear layer due to the higher velocity gradient between the jet stream and the inner recirculating flow as the relative importance of jet diffusion and wall obstruction changes at x w 3d p fig 7 g reveals that the higher tke zone migrates to the outer shear layer with the spreading jet streams meanwhile a pair of secondary tke regions circled by the red dash curves associated with the inner shear layer departs from its outer counterpart to be attached to the shrinking recirculating zone close to the wall at the same time a low turbulent core can be observed immediately downstream of the propeller hub which again resembles a free propeller jet thus confirming the presence of the free jet region there as the wall clearance further increases to x w 4d p fig 7 h shows that the secondary tke region has diminished due to the absence of the recirculating flow and the major tke is found to be concentrated along the outer shear layer in the free jet region furthermore according to the sign of reynolds shear stress and the vector gradient shown in fig 4 one can deduce that the tke production term is positive ρ u w d u d z 0 along the shear layer confirming an energy transfer from the mean ake to the turbulent field tke bailly and comte bellot 2015 it must be stated that a rigorous interpretation of turbulent energy flux should be based on a complete calculation of tke budget terms which require concurrent measurement data of all three fluctuating components u v w therefore it should be noted that the present discussion only considers the in plane components and further efforts are needed in future studies similarly fig 8 depicts the distributions of non dimensional ake and tke at the impingement plane i e x x w in which a k e 1 2 v 2 w 2 u o 2 and t k e 3 4 v 2 w 2 u o 2 unlike that observed in the streamwise plane in figs 7 and 8 reveals that the overall ake magnitude in the transverse plane shows a decreasing trend with increasing wall clearance specifically due to the confined jet diffusion at a small wall clearance at x w d p fig 8 a shows that upon impingement significant ake has been converted to the wall jet region in red which could contribute significantly to the formation of a local scour hole if an erodible bed is present meanwhile the quasi circular region with low ake in the center represents a stagnation region as the wall clearance increases figs 8 b 8 d depict a larger stagnation region while the ake magnitude in the surrounding wall jet region has been significantly reduced in general one may surmise that the intensity of ake within the wall jet region is inversely proportional to the dominance of jet diffusion this finding explains the results of hamill et al 1999 in which they measured the local scour depth around a vertical quay wall in a closed quay and reported that the maximum scour depth monotonically decreases with increasing wall clearances however in the case of an open quay wei and chiew 2017 stated that the maximum scour depth exhibits a sine wave trend with increasing toe clearances this possibly is due to the fact that jet impingement on a slope surface is a more complex phenomenon and needs further investigations the lower row of fig 8 on the other hand depicts the overall tke in the transverse plane it shows a consistent correlation with its counterpart in the streamwise plane in other words both are highly dependent on the wall obstruction whose dominance decreases with increasing wall clearances a noticeable feature of fig 8 e is that the distribution of high tke exhibits a circular dot in which the quasi circular ring represents the shear layer that divides the transverse flow into two parts see fig 5 c the dot in the center overlaps with the core of the hub vortex as it clearly can be observed from the superimposed vectors as the wall clearance increases the ring like tke distribution progressively diminishes while the vortex core remains until x w 2d p at the same time it can be observed that in general the stagnation region appears to contain a higher tke magnitude than its surrounding wall jet region this indicates that the main source of tke is the instability of the hub vortex while the wall jet possesses the major ake 5 proper orthogonal decomposition pod analysis as discussed in the preceding sections the flow field of the impinging swirling jet is governed by the jet diffusion and wall obstruction mechanisms under varying wall clearances meyer et al 2007 suggested that using piv snapshots are insufficient to fully identify the dominant dynamic flow structures since it contains random fluctuations and thus may be a superposition of several structures for this reason in order to detect and distinguish the flow structures in complex flows the proper orthogonal decomposition pod method often is applied to piv data due to its ability to extract the dominant flow structure from the less coherent fluctuations yang et al 2016 a detailed introduction of this method can be found in sirovich 1987 meyer et al 2007 yang et al 2016 etc in this study the snapshot pod analysis proposed by sirovich 1987 is applied in the streamwise flow field based on 1000 snapshots in the following discussion the terms of pod modes and coefficients are used in brief pod modes are the eigenfunctions of the velocity auto correlation operator and form an orthogonal set feng et al 2011 and pod coefficients are determined by projecting the fluctuating part of the velocity filed onto the pod modes meyer et al 2007 therefore the coefficient indicates a correlation between the corresponding pod spatial mode and the instantaneous flow field yang et al 2016 meyer et al 2007 reported that the first few modes capture the most energetic and hence largest structures of the flow in terms of energy considerations fig 9 shows the equivalent vorticity fields of the first four modes in which the annotated percentage value represents the energy fraction of the associated pod mode compared to the total kinetic energy of velocity fluctuations it should be noted that the superimposed vectors are only meant for revealing the equivalent vorticity pattern and their length does not have physical meaning until they are combined with their corresponding pod coefficients used in the reconstruction of snapshots meyer et al 2007 corresponding to fig 9 the power spectra of the pod coefficients for each mode are shown in fig 10 in addition the energy fraction and cumulative energy percentage also are included in the last row in fig 10 the former represents the percentage of the total kinetic energy of velocity fluctuations associated with each pod mode and the latter clearly shows that the first few modes represent significantly more energy than the rest the following discussion will be mainly focused on the first four modes starting with the right column of fig 9 it can be seen that at a large wall clearance of x w 4d p the vorticity fields of the first four pod modes reveal almost the same structure of a series of isolated tip vortices in a coherent pattern with alternating sign in the near wake region of the propeller within 0 x d p 2 farther downstream random flow variations with less coherence are observed in the near wall region 2 x d p 4 which likely is due to the random nature of the turbulent wake and the effect of wall perturbation meanwhile all the first four modes at x w 4d p represent a comparable energy fraction of 5 indicating that they provide an equivalent contribution in constructing the flow field it may therefore be inferred that these four modes together can be interpreted as different phases of the same phenomenon in addition it is interesting to note that the abovementioned coherent tip vortices pattern resembles those found in a free propeller jet di felice et al 2004 one therefore may infer that modes 1 4 at x w 4d p describe a dominant structure that is associated with the jet diffusion mechanism this structure is then found to diminish in the fifth mode and beyond not shown in the figure which seem to represent the random variation of the flow structure associated with the wall obstruction mechanism referring to the power spectrum plots the right column x w 4d p in fig 10 reveals a dominant pulse frequency of 9 hz in all the first four modes it is interesting to note that this frequency is exactly the same as the propeller rotating frequency 545 rpm 9 hz corroborating the inference that jet diffusion dominates the flow field at x w 4d p consequently it may be inferred that the coherent vortices pattern shown in fig 9 which corresponds to the dominant frequency of 9 hz is closely related to the flow structure associated with the free jet diffusion based on this hypothesis one may surmise that at small wall clearance cases where the jet diffusion mechanism is less dominant the coherent vortices pattern that signifying free jet diffusion would appear in the higher order modes which is associated with lower relative energy as the wall clearance decreases to x w 3d p the third column of fig 9 shows that the coherent vortices pattern which signifies free jet diffusion only can be observed in mode 3 fig 9 k and becomes conspicuous in mode 4 fig 9 o accordingly modes 3 and 4 are in reasonable agreement with a secondary peak frequency of 9 hz that stands out in their corresponding power spectrum plots in fig 10 suggesting that they are associated with the free jet diffusion mechanism on the contrary the first two modes shown in figs 9 c and g exhibit a relative random variation in the vorticity field indicating a strong effect of wall obstruction on the unstable flow structure not surprisingly their corresponding power spectrum plot shows a single peak frequency close to zero indicating that the periodic characteristic of the swirling flow has been totally pinned down in the dominant flow structure this may suggest that the first two modes primarily describe the flow structure associated with the wall obstruction mechanism similarly when the wall clearance is reduced to x w 2d p a comparison between the second column of figs 9 and 10 reveals that the first two modes correspond to a single peak frequency close to zero without showing any sign of the coherent vortices pattern in fact they are hardly recognizable even in modes 3 and 4 although their corresponding power spectrum plots do exhibit a secondary peak frequency of 9 3 hz which is reasonably close to that of the free jet turning to the first column of fig 9 where the wall clearance of x w d p is small it is interesting to note that the frequency of 9 hz associated with the free jet diffusion is shown as a secondary peak in all the first four modes while the dominant frequency is found to be 3 9 hz modes 1 3 and 5 1 hz mode 4 which may be considered as the response frequency of the wall impingement a possible explanation of this dual peak phenomenon is that within a small distance of x d p 1 both the jet diffusion and wall obstruction influences are significant thus their impacts are concurrently present in each mode creating a strong coupling however since the free jet frequency holds the lower peak in all the modes its corresponding flow structure i e coherent vortices pattern is still hardly identifiable in the pod spatial modes which is similar as that of modes 3 and 4 at x w 2d p 6 conclusions this paper presents an experimental study of a swirling propeller jet impinging onto a vertical quay wall using piv techniques under varying wall clearances the jet development was found to be governed by two mechanisms namely jet diffusion and wall obstruction as a result of the trade off interaction between them three flow regions can be identified in the streamwise flow field namely free jet impingement and wall jet regions in which the impingement region consists of two flow patterns spread out streams and recirculating eddies which serve as a transition between the free and wall jet regions for the small clearance cases such as x w d p and 2d p in this study the results show that the jet immediately enters the impingement region as the upper and lower streams spread out at the outset to create a recirculating zone between them as the wall clearance increases the free jet has more space to develop and tend to squeeze the recirculating eddies which eventually diminish at x w 4d p the decreasing dominance of the wall obstruction is parametrized by the spread angle identified from the trajectories of the spread out jet streams results of the mean velocity and turbulence measurements at the impingement plane show that the recirculating zone of the streamwise flow field corresponds to a central swirling core dominated by the hub vortex inside the swirling core the contour of the individual velocity component shows two interlocking spirals while the corresponding streamlines exhibit a pattern of attracting spiral on the other hand outside the core the streamlines present a pattern of repelling spiral that represents the wall jet region the impingement effect on all the three velocity components is further examined with the help of their depth profiles at selected locations particularly the vertical velocity w profiles vividly illustrate the diverging motion of the upper and lower jet streams which elucidates the underlying mechanism as either self expanding jet diffusion or forced spreading wall obstruction a point by point comparison of the reynolds shear stress and vorticity distributions in the streamwise plane highlights the correlation between them the major momentum exchange switches from the inner shear layer between jet streams and recirculating eddies to the outer shear layer between jet streams with surrounding water body with increasing wall clearance as the former and latter are respectively dominated by the wall obstruction and jet diffusion as for the energy dissipation the streamwise ake was found to increase with increasing wall clearance while its transverse counterpart exhibits an opposite trend which implies a reducing scouring capacity of the impinging jet at the base of the wall moreover the streamwise tke distribution reveals that turbulence production mainly takes place around the shear layer identified from the reynolds stress and vorticity fields whereas the transverse tke is primarily associated with the instability of the hub vortex the pod method was employed to identify the coherent flow structures in the streamwise plane the data related to the first four pod modes of all the wall clearance cases reveal that the relative dominance between the jet diffusion and wall obstruction mechanisms may be quantitatively interpreted by the pod analysis in terms of the decomposed flow structures pod mode and the peak frequency obtained from the power spectrum of their corresponding pod coefficients the dominant flow structure associated with jet diffusion is identified by a series of coherent tip vortices regularly distributed in the near wake region of the propeller whose corresponding peak frequency is consistent with that of the propeller rotation while the wall obstruction appears as randomly distributed small scale vortices without a dominant periodic characteristic originated from the swirling of the propeller rotation acknowledgments the authors acknowledge the financial support provided by nanyang technological university for this research appendix a supplementary data the following is the supplementary data to this article dataprofile dataprofile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 071 
22756,this study experimentally investigates the mean and turbulent flow fields of a propeller jet impinging on a vertical quay wall four impingement distances namely wall clearances longitudinal distance between the propeller and vertical wall were used to examine their influence on the flow behaviors in order to investigate the characteristics of the three dimensional impinging jet both the streamwise jet central plane and transverse impingement plane flow fields were measured for each impingement distance using the particle image velocimetry piv technique based on the wall clearance three regions are identified namely free impingement and wall jet regions additionally the results show that the evolution of the impinging jet is governed by two mechanisms jet diffusion and wall obstruction their relative importance under varying wall clearances was interpreted in terms of the mean flow patterns and energy dissipation moreover the proper orthogonal decomposition pod method is employed to identify the dominant flow structures associated with these two mechanisms in terms of the pod modes and their corresponding dominant frequency which in turn provides a quantitative means to single out the individual flow mechanism keywords propeller jet impinging jet turbulent flow field piv pod 1 introduction ever since the age of discovery marine transport has been undergoing continuous development to satisfy the ever changing demands of the world trade permanent international association of navigation congresses pianc 2015 reported that during the last decade the shipping industry development was mainly portrayed by an increase in vessel capacity which inevitably is accompanied by the increase in engine power as the most widely used device for ships propulsions wang et al 2018 propellers produce a discharge of water with high kinetic energy which is referred to as the propeller jet wei et al 2017 due to its complex flow characteristics the swirling propeller jet has attracted extensive attention of many researchers a careful review of published literature reveals that most past studies are focused on free expanding propeller jet i e an unconfined jet in the absence of boundary effects induced by seabed or quay structures albertson et al 1950 berger et al 1981 blaauw and kaa 1978 felli et al 2006 2011 felli and falchi 2018 hamill and kee 2016 hamill et al 2015 hamill 1987 hsieh et al 2013 lam et al 2010 verhey 1983 moreover lam et al 2011 provided a thorough review of the empirical equations used to predict the velocity distribution within an unconfined propeller jet on the other hand the flow behaviors of a confined propeller jet which is more common in navigation channel and harbor basin i e in close proximity to the seabed or quay walls has not received the same kind of attention as its unconfined counterpart thus far limited studies on this issue are those by johnston et al 2013 and wei et al 2017 who examined plane bed boundary effects on the evolution of the propeller jet during vessel berthing and deberthing the jet from the rotating propeller blades directly impinges onto the quay structures either in the form of a vertical closed quay or slope wall open quay producing an impinging swirling jet consequently a quay structure near a ship propeller often undergoes scouring which is a growing concern as it may result in structural instability or even failure pianc 2015 documented that ship propeller induced jet flow is the main cause of local scour that forms around quay structures in harbor basins de gijt and broeken 2005 stated that the propeller induced scour hole might reach several meters in depth if the bed material is sand or non cohesive soils with low undrained shear strength hamill et al 1999 experimentally investigated the propeller induced scour hole around a vertical quay wall and found that due to wall confinement the maximum scour depth was significantly increased compared to that of an unconfined propeller scour especially for small wall clearances wei and chiew 2017 2018 studied propeller scour around an open quay with a slope and reported that the maximum scour depth can be either increased or decreased depending on the varying toe clearance longitudinal distance between propeller face and slope toe it may therefore be inferred from these studies that both the quay type and clearance have a close relationship with the impinging propeller jet and resulting scour depth however the underlying scouring mechanisms still have not been fully understood due to the lack of a detailed measurement of the impinging flow field although impinging jets have been widely studied due to its extensive industrial applications such as cooling heating and drying surfaces nozaki et al 2003 most of them were focused on turbulent heat transfer felli et al 2010 conducted an experimental study on swirling jet impingement by using a ducted propeller which is often used in the jetting industry however for ships especially those equipped with large propellers it is the non ducted propeller that is commonly used to gain higher speeds for a non ducted propeller jet its slipstream is without the confinement of a shroud and likely will feature different characteristics from a ducted one to the authors best knowledge studies on a ship propeller jet impingement upon a quay structure and its contributions to the associated scouring action have not been previously addressed since the impinging jet flow is the actual driving force to the potential scouring action this study is focused on examining the three dimensional flow behaviors of an impinging swirling jet generated by a non ducted ship propeller with a simple configuration of a vertical quay wall on a plane bed the mean and turbulent characteristics of the flow fields in both the streamwise and transverse planes are presented and discussed in terms of the observed flow patterns based on which a brief discussion of its implications on the related scouring mechanism is given furthermore the proper orthogonal decomposition pod method is applied to extract the dominant flow structure in the streamwise plane with a full picture of the development of the impinging propeller jet the results of this study are expected to provide an improved insight into the associated scouring mechanisms in future studies and to facilitate related numerical modelings 2 experimental setup the tests in this study were conducted in a recirculating flume with dimensions of 11 m length 0 6 m width and 0 7 m depth in the hydraulic modeling laboratory nanyang technological university the propeller model used is a five bladed wageningen b series propeller with an overall diameter d p of 7 5 cm and a hub diameter d h of 1 0 cm the geometrical properties of the propeller are given in table 1 although nearly all commercial vessels have a central rudder behind the propeller which can split the flow into an upper and lower jet robakiewicz 1966 fuehrer et al 1981 etc this study for the sake of simplicity as per many recently published articles in this area hamill and kee 2016 wei and chiew 2017 2018 etc has not included a rudder its inclusion clearly would have provided a more realistic behavior of the flow field of the propeller wash and should be included in future researches consequently in this study the final design of the propeller rig simply consists of a single screw propeller model the propeller rig was mounted on an appropriately designed movable carriage that spans transversely across the flume and could be moved along the longitudinal rail located on the sidewalls of the flume in such a way the propeller was able to operate at different clearances from the model quay wall namely the wall clearance x w which is defined as the longitudinal distance between the propeller face and vertical wall the quay model was built using an acrylic plate with a dimension of 60 cm height water level 60 cm width flume width 2cm thickness a photo of the experimental model setup is shown in fig 1 with the primary objective of examining the wall impingement effect on the development of a propeller jet the tests were performed at a constant propeller rotational speed of n 545 rpm revolution per minute with four wall clearances i e x w d p 2d p 3d p and 4d p each test was carried out under the bollard pull condition in still water with a depth of 0 6 m and the propeller axis was located at 0 3 m depth hsieh et al 2013 investigated a free expanding propeller jet in the same flume and suggested that the boundary effects of such a set up free surface bottom and sidewalls have negligible influence on the development of the jet the glass bottom and sidewalls of the flume enable optical observations through the use of the particle image velocimetry piv technique the piv system comprises a 5 w air cooling laser with a wavelength of 532 nm as the light source and a high speed camera the high speed camera used phantom miro m 120 with a nikkor 60 mm f 2 8 prime lens has a maximum resolution of 1920 1200 px2 12 bit depth and over 1200 maximum fps frame per second at 1152 1152 px2 aluminum particles with d 50 of 10 μm and specific density of 2 7 were used as seeding particles whose settling velocity is estimated to be 92 6 μm s using stoke s law and is negligible compared with the propeller jet velocity the beam emitted from the laser source passed through the optics resulting in a laser light fan of 1 5 mm thickness to avoid the undesirable effect due to possible free surface fluctuation the laser sheet was cast upward through the glass bottom of the flume a right handed coordinate system o xyz is adopted in this paper in which the origin is located at the center of the propeller disk the x axis is streamwise oriented along the bottom centerline the y axis along the spanwise oriented towards the starboard and the z axis along the upward vertical accordingly the velocity components u w and v w correspond to the x z and y z planes respectively to obtain the three dimensional characteristics of an impinging swirling jet both the streamwise central plane y 0 and the transverse impingement plane x x w were measured using the planar piv for the streamwise measurement the laser sheet was set to align with the propeller rotation axis as shown in fig 2 a for the transverse measurement the laser sheet was set to be immediately upstream of the vertical quay wall and perpendicular to the propeller axis and the field of view fov was captured through a 45 mirror located downstream of the transparent vertical wall as shown in fig 2 b the streamwise and transverse planes were measured at 300 fps and 1000 fps respectively and over 18 000 and 25 000 frames were recorded for each case in these two planes accordingly the total measuring time for the streamwise and transverse planes are over 60 s and 25 s respectively which are long enough for capturing sufficient cycles 2725 and 1135 of the periodic flow generated by the 5 bladed propeller rotating at 545 rpm for image post processing the laplacian filter function is used to reduce light reflection scattering by virtue of its ability to filter out low frequency signals and enhancing high frequency signals consequently time series vector calculations were performed in davis 8 4 0 in which a multi pass iteration with window sizes from 64 64 px2 to 32 32 px2 was adopted in the cross correlation analysis the size of the measured field of view and corresponding spatial resolution are tabulated together with the test conditions in table 2 the efflux velocity u o is defined as the maximum velocity taken from the mean velocity distribution across the initial efflux plane ryan 2002 it must be stated that since the propeller blades periodically pass through the efflux plane it is difficult to extract any meaningful data there as a result the efflux velocity values given in table 2 are taken as the maximum axial velocity in the vicinity of the actual efflux plane following blaauw and kaa 1978 the reynolds numbers of the jet flow r e f l o w u 0 d p ν and propeller r e p r o p n d p l m ν also are calculated and included in table 2 in which ν is kinematic viscosity of water and l m is the characteristic length dependent on the propeller geometry defined as l m β d p π 2 n 1 d h d p 1 3 time averaged mean flow patterns 3 1 streamwise flow field fig 3 shows the comparison of the time averaged mean streamwise velocity fields at the streamwise central plane y 0 under varying wall clearances for better understanding the results are presented in two ways 1 the upper row presents the contour map of the in plane mean velocity with the superimposed streamlines 2 the lower row shows the vector plot where the magnitude and direction of the velocity vector are u 2 w 2 and arctan w u respectively for easy comparison between different sub plots the same scaling of color bar and vector length are used for plots of contour and vectors respectively in addition the loci of the local maximum velocity in the upper and lower jet streams are also depicted in the vector plot by a red solid line representing the trajectory of each stream the recirculating region associated with the reverse flow u 0 is enveloped by a red dash line i e the contour line of u 0 furthermore since the horizontal and vertical axes have the same scale the figure is undistorted and the true shape of the jet is preserved the spread angle of the jet is thereby illustrated by two blue dash lines which will be discussed later the contour map in fig 3 shows that the wall effect on the flow structure is clearly discernible as the propeller jet is placed near a vertical wall and impinges onto it at a right angle consequently the measured efflux velocity and the associated r e f l o w are significantly reduced in the near clearance cases of x w d p and 2d p although r e p r o p was kept constant at the same rational speed see table 2 beltaos and rajaratnam 1974 studied the impingement of a turbulent jet from a nozzle onto a solid surface and identified three regions namely free jet impingement and wall jet regions the free jet region exists at some distance from the wall where wall perturbation is negligible and the impingement region possesses a relative high pressure gradient that deflects the flow direction to be parallel to the wall in the resulting wall jet region beltaos 1976 similarly as a propeller jet impinges onto a vertical wall it is expected that two mechanisms would govern the evolution of the jet i e jet diffusion dominant in the free jet region and wall obstruction dominant in the impingement region due to the presence of the hub at the center of the propeller disk the free expanding i e unconfined propeller jet is characterized by a double peak off center profile in the zone of flow establishment zfe and a single peak at the center in the zone of established flow zef at the small wall clearance of x w d p fig 3 a exhibits a noticeable spread out feature of the double peak profile hereinafter referred to as the upper and lower jet streams at the immediate near wake region downstream of the propeller face it may be inferred that the influence of the wall obstruction has extended to the propeller face leaving no space for the free jet region to form following the classification of beltaos 1976 the impingement region under the current context could be further divided into a pair of spread out jet streams and a triangle like recirculating zone denoted by the red dot line in the lower row of fig 3 between the spread out streams in which two recirculating eddies with opposite directions form on both sides of the centerline of propeller axis z d p 0 as is clearly illustrated by the streamlines in fig 3 a it should be noted that these two eddies are not perfectly symmetrical about the centerline which may be attributed to the instability of the hub vortex this will be further discussed in a later section by means of the transverse flow results when the two spread out jet streams impinge and attach onto the vertical wall at z d p 0 7 they resemble two wall jets one moving upward away from and the other downward towards the bed see fig 3 a similarly as the wall clearance increases to x w 2d p fig 3 b shows that wall obstruction still dominates the jet evolution since the upper and lower jet streams immediately spread out from the outset and no sign of the free jet region is present due to the larger wall clearance fig 3 b reveals a larger triangular recirculating zone that pushes the wall jet region farther upward downward toward z d p 1 when the wall clearance is increased to x w 3d p fig 3 c shows that jet diffusion appears to dominate wall obstruction because the double stream configuration red contour is able to take on a free jet pattern as those presented in hsieh et al 2013 and wei et al 2017 moreover unlike the development observed in figs 3 a and b fig 3 c shows that the size of the recirculating zone decreases with increasing wall clearance this possibly is attributed to the fact that most jet energy has been dissipated due to jet diffusion before it impinges onto the wall thus resulting in a less intense recirculating flow this is further confirmed in fig 3 d where the recirculating eddies have evidently diminished and replaced by a moderate flow deflection as inferred by the streamlines in fig 3 d additionally at x w 4d p the double stream configuration shows no obvious spread out feature until the jet approaches the near wall region around x d p 3 in order to quantify the development of the spread out feature the trajectories of the upper and lower jet streams are more explicitly illustrated in the lower row of fig 3 by a pair of curves red line representing the loci of the local maximum velocity by doing so one can identify the angle between the spread out potions of the loci curves in general figs 3 e and f show that after the initial spread out at the outset the two streams undergo a further deflection causing them to be parallel to the wall when the jet approaches the near wall region within 0 5d p upstream of the wall figs 3 g and h on the other hand show that the loci curves exhibit a quasi parallel to each other feature in the near wake i e the free jet region before spreading out in the near wall region within 1d p upstream of the wall it may therefore be concluded that in all the wall clearance cases a common wall enforced spread out is present in the near wall region which is directly related to the wall obstruction the spread out angle is also shown by drawing the tangential lines to the deflected curves at their inflection points the so obtained wall enforced spread angle is found to be reduced from 156 0 at x w d p to 98 5 at x w 4d p which quantitatively signifies a decreasing wall obstruction mechanism in summary based on the results of the streamwise measurement three regions with distinctive flow behaviors can be identified under varying wall clearances namely free jet impingement consists of spread out streams and recirculating eddies and wall jet regions it must be stated that a quantified demarcation between each region which likely is dependent on the wall clearances as well as the propeller type and rotational speed etc is beyond the scope of this study 3 2 transverse flow field the transverse mean velocity fields at the impingement plane under different wall clearance cases are depicted in fig 4 in which the left and central columns represent the mean lateral v and vertical w velocity components respectively the right column represents the in plane resultant velocity v 2 w 2 additionally the vectors and streamlines are also superimposed in the contour maps of the individual and resultant velocity plots respectively in the figure it is not hard to imagine that a horizontal circular jet without swirl will spread out radially in the form of concentric circles when it impinges onto a vertical wall and the decomposed velocity components will be axial symmetric about the centerline however this is not the case for a swirling impinging jet it is interesting to note that as the swirling jet impinges on the vertical wall with a small clearance the contour maps of the individual velocity components exhibit two interlocking spirals in the central core region as shown in figs 4 a and b in this study a left hand propeller was used which means that it rotates counterclockwise to provide the forward thrust as such inside the central swirling region the data in fig 4 a expectedly shows that the lateral velocity v is mainly positive and negative in the third lower left and first upper right quadrants respectively the same interlocking spirals feature is present in the vertical velocity component although fig 4 b is a 90 offset of fig 4 a outside the central swirling region the data reveal that the velocity distribution resembles that of the circular jet without swirl as a result the streamlines form a ring that divides the flow field into two distinctive portions an attracting spiral pattern hub vortex inside the ring and a repelling spiral pattern wall jet outside the ring see fig 4 c in particular the attracting spiral streamlines are consistent with the counterclockwise swirling rotation and their sink overlaps with the lowest velocity deduced from the background contour these two patterns are maintained until x w 3d p see figs 4 c f and 4 i it should be stated that neither the streamline ring is perfectly circular as compared to that of an unconfined jet shown in wei 2018 nor the sink point located at the symcenter this is possibly attributed to the instability of the hub vortex as it impinges onto the wall as suggested by felli et al 2010 who reported that the intensity of the hub vortex spiral decreases with increasing wall clearance which is also confirmed by the results of this study in that the two interlocking spirals progressively diminish as shown in figs 4 d e g and h when x w 4d p figs 4 j and k show no sign of the swirling spiral and the streamlines in fig 4 l exhibit a source flow pattern which reflects a wall jet flow prevailing along the wall as was also observed in the streamwise velocity results see fig 3 moreover the right column of fig 4 also presents the impinging flow field from the viewpoint of the in plane resultant velocity in which the central low velocity circle that represents the slow moving stagnation region is in reasonable agreement with the projection of the recirculating zone that is observed in the streamwise flow field 3 3 depth velocity profiles in order to further examine impingement effects on the individual velocity components the vertical profiles of u v and w at selected longitudinal locations x d p 2d p 3d p and 4d p are extracted from figs 3 and 4 and shown in fig 5 it should be noted that the v profiles are only available at the impingement plane of x x w since the transverse flow fields were only measured there for x w d p fig 5 a reveals that when the swirling jet impinges onto the wall both the v and w profiles exhibit the characteristic of an undulating type s curve specifically for the v profile the data exhibits a zero crossing point that dividing the profile into a negative upper and a positive lower half which signifies a counterclockwise swirling that complies with the propeller rotation one may therefore infer that the zero crossing point of v profile represents the center of the hub vortex whose location persists around z d p 0 on the other hand the undulating s shape curve associated with the w profile comprises three zero crossing points with two turning points the three points s1 s2 and s3 along the line of w 0 form at z d p 0 6 and 0 in which s1 s3 are zero up crossing and s2 is zero down crossing the zero up crossing is defined as the point where the sign of w changes from negative downward flow to positive upward flow with increasing z d p and vice versa therefore the former and latter points signify diverging and converging flow motions respectively specifically looking at the upper half profile for example as the upper jet stream impinges onto the wall it leads to a flow divergence thereby producing an upward flow and a downward flow at the upper zero up crossing point s1 this downward flow meets with the other upward flow that is affected by the lower jet stream at the middle zero down crossing point s2 consequently creating two recirculating eddies with opposite directions see fig 3 a it may therefore be surmised that the two zero up crossing points s1 and s3 pinpoint the locations where the spread out jet streams impinge onto the wall thereby causing the formation of recirculation eddies at the impingement plane for x w 2d p fig 5 b shows that at x d p the u profile indicates a symmetrical curve about the propeller axis i e z d p 0 with a pair of positive double peaks representing the upper and lower jet streams and a negative central zone that signifies the reverse recirculating flow similar to that in fig 5 a the w profile at x d p also features three zero crossing points however the direction of the flow reverses in that the zero down crossing points form on the upper and lower sides and the zero up crossing in the middle of the vertical axis beyond the upper and lower zero down crossing points the negative and positive vertical velocities reflect entrainment of the ambient stationary fluid into the jet streams conversely the w profile between them present a centrosymmetric form with a positive peak on the upper half and a negative peak on the lower half whose locations coincide with the double peak of the u profile indicating the spread out trend of the jet streams upon impingement fig 5 b shows that at x 2d p the w profile reverts to a curve that is similar to that of fig 5 a while the v profile shows an off center zero crossing point indicating that the swirling center has drifted due to the instability of the hub vortex a comparison of figs 5 c and d at x d p reveals that both the u and w profiles show reasonable agreement between these two wall clearance cases x w 3d p and 4d p indicating negligible interference from the wall and thus the free jet region persists there in particular the u profile shows the iconic double peak feature as that of a free propeller jet at the same time it is worth noting that the w profile features two zero down crossing points in the upper and lower sides and one zero up crossing point in the middle similar to that in fig 5 b as discussed earlier the zero up crossing point s2 reflects a diverging flow motion with upward w positive on its upper and downward w negative on its lower sides this profile could be a reflection of the self expansion of the jet in the absence of wall effects as the jet moves to x 2d p fig 5 c shows that the u profile exhibits a wider double peak and a very small axial velocity at the center when compared to those of fig 5 d which are respectively due to the spread out effect and the intrusion of the recircuiting zone induced by wall obstruction as for the w profile fig 5 c shows that it has a similar shape as that observed in the free jet region at x d p however it should be noted based on its u profile that the jet has already entered the impingement region where the wall obstruction would have dominated jet development therefore the diverging flow here could more likely be attributed to the influence of the wall rather than self expansion farther downstream fig 5 c shows that when the jet impinges onto the wall at x 3d p the w profile is found to revert to the s curve resembling those at x x w in figs 5 a and b albeit with reduced magnitude due to energy dissipation during the jet diffusion phase meanwhile the v profile shows that the lateral velocity has been significantly decreased compared to its counterparts in figs 5 a and b whereas the marginal native positive value in the upper lower halves still demonstrate a trace of the swirling rotation for x w 4d p fig 5 d shows that the w profile essentially loses all the undulating pattern at x 2d p indicating the cessation of free jet expansion afterwards the three zero crossing points which signifies the spread out motion of the jet streams reappear at x 3d p one may therefore deduce that the jet undergoes a further expansion which however is unlikely to be attributed to jet diffusion but rather wall effects at this juncture the wall obstruction also exerts a flattening effect on the double peak feature of the u profile eventually causing it to attach to the u 0 line at x x w in addition upon impingement at x x w 4d p the w profile shows an overlapped segment with w 0 within z d p 0 42 instead of three zero crossing points as shown in figs 5 a 5 c this is because the magnitude of the jet streams has been significantly reduced before they impinge onto the wall the absence of a vertical flow here explains why a recirculating flow region is not formed between the deflected upward downward wall jets see fig 3 d furthermore one may infer that if the jet was given more space to expand the two jet streams would have eventually merged into a single peak before x 4d p this is consistent with the suggestion of stewart 1992 who stated that an unconfined propeller jet would enter the zone of established flow at x d p 3 25 4 momentum exchange and energy dissipation 4 1 reynolds shear stress and vorticity field in streamwise plane fig 6 shows the distributions of non dimensional vorticity ω y d p u o and reynolds shear stress u w u o 2 in the upper and lower rows respectively and both of them are superimposed with the mean velocity vectors the out of plane vorticity is calculated by ω y w x u z and u o 0 60 m s is taken as the efflux velocity of the case of x w 4d p see table 2 which is assumed to be free of the wall effect as a propeller jet enters an open quiescent water body a shear layer referred to as the outer shear layer hereafter forms at the interface between the high velocity jet and the surrounding stagnant fluid in the case of an impinging jet due to the presence of the recirculating zone that forms between the spread out jet streams discussed earlier a secondary shear layer referred to as the inner shear layer hereafter develops at the interface of the spread out peaks and the inner reverse flow in the recirculating zone fig 6 clearly shows the formation of intense vorticities both along the outer and inner shear layers comparing the vorticity contour and the superimposed vectors it can be observed that the interface white color between the positive red color and negative blue color vorticities coincides with the loci of the peak velocity vector due to the dominant effect of wall obstruction when the wall clearance is small figs 6 a and b show that the intense vorticity occurs immediately in the near wake region of the propeller since the recirculating zone has extended there see figs 3 e and f however fig 6 c shows that the vorticity along the inner shear layer only appears to be pronounced beyond x d p 1 as the double streams start to spread out there which signifies the beginning of the impingement region as the wall clearance further increases fig 6 d shows that both the inner and outer vorticity tend to fade out due to increasing jet diffusion and decreasing wall obstruction effects a comparison of the distributions of reynolds shear stress and vorticity fields reveals that the regions of intense reynolds stress are at the same location as those with pronounced vortices this reinforces the fact that the magnitude of the reynolds shear stress is highly correlated with the presence of the vortices moreover the superimposed vectors show that the positive reynolds shear stress generally overlaps with a positive horizontal velocity gradient u z which in turn denotes a clockwise rotation of the vortex in other words a negative vorticity value and vice versa however a closer examination reveals that around the near wall region where the jet streams impinge onto the wall circled by red dash lines in figs 6 e f and g the sign of reynolds shear stress seems to be opposite to the velocity gradient that can be deduced from the superimposed vector plot this possibly is attributed to the fact that it is the higher vertical velocity gradient w x that dominates the shear layer there as its horizontal counterpart has been dampened by the vertical wall a similar phenomenon was also observed in the near wake region of a circular cylinder hsieh 2008 4 2 ake and tke distributions in streamwise and transverse planes the streamwise distributions of non dimensional average kinetic energy ake and turbulent kinetic energy tke superimposed with the mean vector plot are presented in fig 7 where a k e 1 2 u 2 w 2 u o 2 and t k e 3 4 u 2 w 2 u o 2 it must be stated that only the in plane velocity components are used here due to the two dimensional nature of the planar piv measurement as a result the tke calculation is based on the assumption of isotropic turbulence where v 2 1 2 u 2 w 2 chandrsuda and bradshaw 1981 sciacchitano and wieneke 2016 as its mathematical expression implies the ake distribution shown in fig 7 is inherently consistent with that of mean velocity distribution in fig 3 whereas the square operator further distinguishes the jet streams which contains most of the average kinetic energy from the relatively stagnant surrounding fluid a closer observation of the ake contour and the superimposed velocity vectors reveals that high ake region mainly concentrates in a narrow band along the loci of peak velocity vectors conversely the lower row of fig 7 shows that the high tke region is prominent in a wider band along the outer and inner shear layers as identified in fig 4 specifically at x w d p and x w 2d p where the wall obstruction is dominant figs 7 e and f show that the higher tke zone basically resides in the inner shear layer due to the higher velocity gradient between the jet stream and the inner recirculating flow as the relative importance of jet diffusion and wall obstruction changes at x w 3d p fig 7 g reveals that the higher tke zone migrates to the outer shear layer with the spreading jet streams meanwhile a pair of secondary tke regions circled by the red dash curves associated with the inner shear layer departs from its outer counterpart to be attached to the shrinking recirculating zone close to the wall at the same time a low turbulent core can be observed immediately downstream of the propeller hub which again resembles a free propeller jet thus confirming the presence of the free jet region there as the wall clearance further increases to x w 4d p fig 7 h shows that the secondary tke region has diminished due to the absence of the recirculating flow and the major tke is found to be concentrated along the outer shear layer in the free jet region furthermore according to the sign of reynolds shear stress and the vector gradient shown in fig 4 one can deduce that the tke production term is positive ρ u w d u d z 0 along the shear layer confirming an energy transfer from the mean ake to the turbulent field tke bailly and comte bellot 2015 it must be stated that a rigorous interpretation of turbulent energy flux should be based on a complete calculation of tke budget terms which require concurrent measurement data of all three fluctuating components u v w therefore it should be noted that the present discussion only considers the in plane components and further efforts are needed in future studies similarly fig 8 depicts the distributions of non dimensional ake and tke at the impingement plane i e x x w in which a k e 1 2 v 2 w 2 u o 2 and t k e 3 4 v 2 w 2 u o 2 unlike that observed in the streamwise plane in figs 7 and 8 reveals that the overall ake magnitude in the transverse plane shows a decreasing trend with increasing wall clearance specifically due to the confined jet diffusion at a small wall clearance at x w d p fig 8 a shows that upon impingement significant ake has been converted to the wall jet region in red which could contribute significantly to the formation of a local scour hole if an erodible bed is present meanwhile the quasi circular region with low ake in the center represents a stagnation region as the wall clearance increases figs 8 b 8 d depict a larger stagnation region while the ake magnitude in the surrounding wall jet region has been significantly reduced in general one may surmise that the intensity of ake within the wall jet region is inversely proportional to the dominance of jet diffusion this finding explains the results of hamill et al 1999 in which they measured the local scour depth around a vertical quay wall in a closed quay and reported that the maximum scour depth monotonically decreases with increasing wall clearances however in the case of an open quay wei and chiew 2017 stated that the maximum scour depth exhibits a sine wave trend with increasing toe clearances this possibly is due to the fact that jet impingement on a slope surface is a more complex phenomenon and needs further investigations the lower row of fig 8 on the other hand depicts the overall tke in the transverse plane it shows a consistent correlation with its counterpart in the streamwise plane in other words both are highly dependent on the wall obstruction whose dominance decreases with increasing wall clearances a noticeable feature of fig 8 e is that the distribution of high tke exhibits a circular dot in which the quasi circular ring represents the shear layer that divides the transverse flow into two parts see fig 5 c the dot in the center overlaps with the core of the hub vortex as it clearly can be observed from the superimposed vectors as the wall clearance increases the ring like tke distribution progressively diminishes while the vortex core remains until x w 2d p at the same time it can be observed that in general the stagnation region appears to contain a higher tke magnitude than its surrounding wall jet region this indicates that the main source of tke is the instability of the hub vortex while the wall jet possesses the major ake 5 proper orthogonal decomposition pod analysis as discussed in the preceding sections the flow field of the impinging swirling jet is governed by the jet diffusion and wall obstruction mechanisms under varying wall clearances meyer et al 2007 suggested that using piv snapshots are insufficient to fully identify the dominant dynamic flow structures since it contains random fluctuations and thus may be a superposition of several structures for this reason in order to detect and distinguish the flow structures in complex flows the proper orthogonal decomposition pod method often is applied to piv data due to its ability to extract the dominant flow structure from the less coherent fluctuations yang et al 2016 a detailed introduction of this method can be found in sirovich 1987 meyer et al 2007 yang et al 2016 etc in this study the snapshot pod analysis proposed by sirovich 1987 is applied in the streamwise flow field based on 1000 snapshots in the following discussion the terms of pod modes and coefficients are used in brief pod modes are the eigenfunctions of the velocity auto correlation operator and form an orthogonal set feng et al 2011 and pod coefficients are determined by projecting the fluctuating part of the velocity filed onto the pod modes meyer et al 2007 therefore the coefficient indicates a correlation between the corresponding pod spatial mode and the instantaneous flow field yang et al 2016 meyer et al 2007 reported that the first few modes capture the most energetic and hence largest structures of the flow in terms of energy considerations fig 9 shows the equivalent vorticity fields of the first four modes in which the annotated percentage value represents the energy fraction of the associated pod mode compared to the total kinetic energy of velocity fluctuations it should be noted that the superimposed vectors are only meant for revealing the equivalent vorticity pattern and their length does not have physical meaning until they are combined with their corresponding pod coefficients used in the reconstruction of snapshots meyer et al 2007 corresponding to fig 9 the power spectra of the pod coefficients for each mode are shown in fig 10 in addition the energy fraction and cumulative energy percentage also are included in the last row in fig 10 the former represents the percentage of the total kinetic energy of velocity fluctuations associated with each pod mode and the latter clearly shows that the first few modes represent significantly more energy than the rest the following discussion will be mainly focused on the first four modes starting with the right column of fig 9 it can be seen that at a large wall clearance of x w 4d p the vorticity fields of the first four pod modes reveal almost the same structure of a series of isolated tip vortices in a coherent pattern with alternating sign in the near wake region of the propeller within 0 x d p 2 farther downstream random flow variations with less coherence are observed in the near wall region 2 x d p 4 which likely is due to the random nature of the turbulent wake and the effect of wall perturbation meanwhile all the first four modes at x w 4d p represent a comparable energy fraction of 5 indicating that they provide an equivalent contribution in constructing the flow field it may therefore be inferred that these four modes together can be interpreted as different phases of the same phenomenon in addition it is interesting to note that the abovementioned coherent tip vortices pattern resembles those found in a free propeller jet di felice et al 2004 one therefore may infer that modes 1 4 at x w 4d p describe a dominant structure that is associated with the jet diffusion mechanism this structure is then found to diminish in the fifth mode and beyond not shown in the figure which seem to represent the random variation of the flow structure associated with the wall obstruction mechanism referring to the power spectrum plots the right column x w 4d p in fig 10 reveals a dominant pulse frequency of 9 hz in all the first four modes it is interesting to note that this frequency is exactly the same as the propeller rotating frequency 545 rpm 9 hz corroborating the inference that jet diffusion dominates the flow field at x w 4d p consequently it may be inferred that the coherent vortices pattern shown in fig 9 which corresponds to the dominant frequency of 9 hz is closely related to the flow structure associated with the free jet diffusion based on this hypothesis one may surmise that at small wall clearance cases where the jet diffusion mechanism is less dominant the coherent vortices pattern that signifying free jet diffusion would appear in the higher order modes which is associated with lower relative energy as the wall clearance decreases to x w 3d p the third column of fig 9 shows that the coherent vortices pattern which signifies free jet diffusion only can be observed in mode 3 fig 9 k and becomes conspicuous in mode 4 fig 9 o accordingly modes 3 and 4 are in reasonable agreement with a secondary peak frequency of 9 hz that stands out in their corresponding power spectrum plots in fig 10 suggesting that they are associated with the free jet diffusion mechanism on the contrary the first two modes shown in figs 9 c and g exhibit a relative random variation in the vorticity field indicating a strong effect of wall obstruction on the unstable flow structure not surprisingly their corresponding power spectrum plot shows a single peak frequency close to zero indicating that the periodic characteristic of the swirling flow has been totally pinned down in the dominant flow structure this may suggest that the first two modes primarily describe the flow structure associated with the wall obstruction mechanism similarly when the wall clearance is reduced to x w 2d p a comparison between the second column of figs 9 and 10 reveals that the first two modes correspond to a single peak frequency close to zero without showing any sign of the coherent vortices pattern in fact they are hardly recognizable even in modes 3 and 4 although their corresponding power spectrum plots do exhibit a secondary peak frequency of 9 3 hz which is reasonably close to that of the free jet turning to the first column of fig 9 where the wall clearance of x w d p is small it is interesting to note that the frequency of 9 hz associated with the free jet diffusion is shown as a secondary peak in all the first four modes while the dominant frequency is found to be 3 9 hz modes 1 3 and 5 1 hz mode 4 which may be considered as the response frequency of the wall impingement a possible explanation of this dual peak phenomenon is that within a small distance of x d p 1 both the jet diffusion and wall obstruction influences are significant thus their impacts are concurrently present in each mode creating a strong coupling however since the free jet frequency holds the lower peak in all the modes its corresponding flow structure i e coherent vortices pattern is still hardly identifiable in the pod spatial modes which is similar as that of modes 3 and 4 at x w 2d p 6 conclusions this paper presents an experimental study of a swirling propeller jet impinging onto a vertical quay wall using piv techniques under varying wall clearances the jet development was found to be governed by two mechanisms namely jet diffusion and wall obstruction as a result of the trade off interaction between them three flow regions can be identified in the streamwise flow field namely free jet impingement and wall jet regions in which the impingement region consists of two flow patterns spread out streams and recirculating eddies which serve as a transition between the free and wall jet regions for the small clearance cases such as x w d p and 2d p in this study the results show that the jet immediately enters the impingement region as the upper and lower streams spread out at the outset to create a recirculating zone between them as the wall clearance increases the free jet has more space to develop and tend to squeeze the recirculating eddies which eventually diminish at x w 4d p the decreasing dominance of the wall obstruction is parametrized by the spread angle identified from the trajectories of the spread out jet streams results of the mean velocity and turbulence measurements at the impingement plane show that the recirculating zone of the streamwise flow field corresponds to a central swirling core dominated by the hub vortex inside the swirling core the contour of the individual velocity component shows two interlocking spirals while the corresponding streamlines exhibit a pattern of attracting spiral on the other hand outside the core the streamlines present a pattern of repelling spiral that represents the wall jet region the impingement effect on all the three velocity components is further examined with the help of their depth profiles at selected locations particularly the vertical velocity w profiles vividly illustrate the diverging motion of the upper and lower jet streams which elucidates the underlying mechanism as either self expanding jet diffusion or forced spreading wall obstruction a point by point comparison of the reynolds shear stress and vorticity distributions in the streamwise plane highlights the correlation between them the major momentum exchange switches from the inner shear layer between jet streams and recirculating eddies to the outer shear layer between jet streams with surrounding water body with increasing wall clearance as the former and latter are respectively dominated by the wall obstruction and jet diffusion as for the energy dissipation the streamwise ake was found to increase with increasing wall clearance while its transverse counterpart exhibits an opposite trend which implies a reducing scouring capacity of the impinging jet at the base of the wall moreover the streamwise tke distribution reveals that turbulence production mainly takes place around the shear layer identified from the reynolds stress and vorticity fields whereas the transverse tke is primarily associated with the instability of the hub vortex the pod method was employed to identify the coherent flow structures in the streamwise plane the data related to the first four pod modes of all the wall clearance cases reveal that the relative dominance between the jet diffusion and wall obstruction mechanisms may be quantitatively interpreted by the pod analysis in terms of the decomposed flow structures pod mode and the peak frequency obtained from the power spectrum of their corresponding pod coefficients the dominant flow structure associated with jet diffusion is identified by a series of coherent tip vortices regularly distributed in the near wake region of the propeller whose corresponding peak frequency is consistent with that of the propeller rotation while the wall obstruction appears as randomly distributed small scale vortices without a dominant periodic characteristic originated from the swirling of the propeller rotation acknowledgments the authors acknowledge the financial support provided by nanyang technological university for this research appendix a supplementary data the following is the supplementary data to this article dataprofile dataprofile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 071 
22757,we present a study of the response of the generic joubert bb2 geometry self propelled near the free surface using a dynamic overset methodology with discretized propeller and control surfaces a grid study was performed for sail top depth 0 702 m even keel simulations at depths ranging from 6 9 m to 40 m were conducted in calm water and regular waves representative of sea state 2 to 7 an autopilot acting on sail and tail planes ballast and trim tanks was used to simulate controlled self propulsion at several depths in calm water and waves the even keel study shows that near surface operation causes considerable vertical forces and pitching moments and an increase in required propeller thrust to achieve self propulsion decreasing efficiency the boat responds to waves mainly through the added mass forces produced by the wave induced velocity field causing an exponential decay of the wave influence with depth and with decreasing wave amplitude in controlled free running simulations very near the surface the boat responds to the forces observed in even keel requiring compensation through the trim tanks to prevent high bow down pitch hull free surface interaction causes fluctuations in the wake resulting in a broadband response of propeller thrust keywords submarine self propulsion autopilot free surface 1 introduction near surface operation of underwater vehicles is affected by hydrodynamic effects caused by the presence of the air water interface one well known effect is the tail suction that results in a bow down attitude unless corrective measures are taken tolliver 1996 the pressure field caused by the hull produces a free surface deflection which in turn affects the flow field around the vehicle in a two way coupling mode the resulting hydrodynamic forces and decrease of authority of the upper control surfaces test the ability of the control systems to maintain the boat trimmed and at constant depth less uniform flow fields into the propeller and consequent vibrations and noise are also a result of the interaction with the free surface earlier work on boat propulsion was performed on the generic darpa suboff and onr body 1 geometries self propulsion studies of darpa suboff appended with the insean e1619 propeller were presented by liefvendahl and tröeng 2011 chase and carrica 2013 and sezen et al 2018 resulting in good comparisons among different authors chase et al 2013 performed a horizontal overshoot maneuver with a rotating propeller technique and also coupling the mit propeller code puf 14 warren et al 2000 with computational fluid dynamics cfd showing that the coupling with a lower fidelity propeller code yielded similar results to the more accurate but expensive rotating propeller approach at the cost of decreased resolution in the wake flow field submarine maneuvers are relevant to propulsion simulation since they are preceded by a self propulsion stage that typically shares the same numerical techniques simulations of maneuvering for the onr body 1 were first reported by pankajakshan et al 2002 using rans with active control surfaces and a resolved rotating propeller demonstrating the capability of their approach though the authors did not complete a full maneuver black and michael 2003 performed overshoot maneuvers using a coupled puf14 rans approach showing good match with experimental data in a later work venkatesan and clark 2007 performed horizontal overshoot maneuvers using a moving propeller also with good results compared to experiments dubbioso et al 2015 performed 3 degree of freedom 3dof horizontal turn maneuver simulation using an actuator disc model near free surface and at infinite depth in all these cases the maneuvers did not have depth or pitch control in a more recent work with both discretized propeller and cfd puf 14 coupling approaches martin et al 2015 studied self propulsion and horizontal and vertical overshoot maneuvers focusing on the propeller flow and performance through the maneuvers providing a complete comparison with experimental data for motions forces and velocities also in self propulsion they concluded that while the discretized propeller approach is more accurate the results are also good with a coupled cfd potential flow propeller model approach at a fifth of the computational cost in this paper we study near surface self propulsion performance of the generic submarine joubert bb2 designed by joubert 2004 2006 and modified by marin in the netherlands overpelt et al 2015 the primary objective of the investigation is to assess the effect of the free surface on propulsion performance and forces moments and motions of an underwater vehicle self propulsion and controlled turn and zigzag maneuvers experiments are reported in overpelt et al 2015 self propulsion and free running cfd simulations of joubert bb2 at depth are presented by carrica et al 2016a carrica et al 2018 and kim et al 2018 in all cases comparing favorably against experiments by overpelt et al 2015 effects of the presence of the free surface on propeller performance and joubert bb2 self propulsion were studied for the first time by li et al 2015a a numerical and experimental study of self propulsion using the codes refresco and rex was presented by carrica et al 2016a the study included self propulsion at depth and near the surface using a coupled cfd propeller code or discretized propeller and direct simulation of controlled 20 turn and horizontal 20 20 zigzag maneuvers a max q surfacing maneuver was studied including a propeller crashback maneuver to stop the vehicle in all cases results compared well with experiments though forces and moments on appendages deviated moderately from experiments this deviation could possibly be attributed to transition from laminar to turbulent boundary layer an effect neglected in cfd unless transition models langtry and menter 2009 menter et al 2015 are included in the simulations which has been done only as preliminary study for complex geometries like joubert bb2 martin et al 2018 while limited self propulsion of underwater vehicles near the free surface has been investigated and reported studies of self propulsion in waves are not available in the literature in this paper we present cfd simulations of self propulsion near the surface in calm water and waves discuss challenges to perform these simulations and analyze the effects of the free surface on forces and moments and stability this investigation focuses further on effects of underwater vehicle operation near the surface in self propulsion conditions include partial submergence sail above the free surface and top of sail at different depths in calm water and in regular head waves fixed even keel and autopiloted free body conditions are studied 2 self propulsion and autopilot experimental propulsion tests as recommended by the international towing tank conference ittc 2008 are typically performed with captive models in a towing tank for a given vehicle target speed runs at different propeller rotational speeds in revolutions per second or rps are performed until the towing force is zeroed such that self propulsion is achieved by balancing propeller thrust with total resistance a similar approach can be applied in cfd though cost is usually high since several runs at different rps are needed to obtain the self propulsion point a second approach more appropriate for cfd applies a speed controller to achieve the target speed resulting in self propulsion in a single run carrica et al 2010a chase and carrica 2013 a generic linear proportional integral derivative pid controller can be expressed as 1 p i d ξ γ p ξ e γ d ξ d e γ d t i ξ 0 t e γ d t where ξ is the actuated command propeller rps in the case of the speed controller and e γ γ t γ the error on any variable γ the boat speed in this case with respect to its target value γ t for the cases in calm water the convergence can be accelerated using a non linear integral term of the form 2 p i d ξ γ p ξ e γ d ξ d e γ d t i ξ 0 t e γ 1 n d t where n is larger than one fig 1 shows the integrand in eq 2 for n 3 as well as the effect of this term in the convergence rate of a self propulsion computation of bb2 in even keel condition near the surface as the boat speed approaches the target value the error decreases and the integrand decreases requiring longer times to converge to the desired speed applying a cubic root function results in a larger integrand for smaller errors speeding up convergence the faster settling to the target speed can be seen in the right panel of fig 1 which shows that acceleration of the boat and formation of the boundary layer and free surface waves takes approximately 3 dimensionless seconds or the time to advance three boat lengths the controller with the non linear integral term can achieve the target speed in approximately one ship length by heavily loading the propeller as shown by the propeller rps however the self propulsion condition takes longer to be established as the rps accommodates to the changing resistance due to boundary layer and free surface wave field development operation near the surface requires additional control to maintain depth and compensate tail suction which results in excessive pitch that may cause the propeller to surface or boat to dive the autopilot system is based on the original bb2 proportional derivative pd controller presented in overpelt et al 2015 and carrica et al 2016a with improvements described in this section it is important to note that changes in the autopilot will result in different responses to transients in particular waves a better designed autopilot will be able to control the desired attitude of the submarine under more violent or complex operational situations in this paper we present an autopilot that performs adequately under the operational conditions presented herein but no efforts have been made to optimize it one of the limitations of a pd controller is that it cannot zero the error thus being generally unable to achieve the targets fossen 1994 a pid controller as in eq 1 removes this limitation by adding an integral component the autopilot control system in overpelt et al 2015 calculates horizontal and vertical commands δ h and δ v respectively to impose deflections on the sail and tail planes linking the horizontal command to errors in sway and yaw and the horizontal command with errors in pitch and depth this pid approach has two problems the first is that in near surface operation the tail suction causes a consistent upward force and a nose down pitching moment which stress sail and tail plane deflection to maintain the target depth and pitch increasing resistance the second problem is that pitch and depth are coupled into the vertical command and thus zeroing both errors results in coupled pitch depth motions to prevent these issues a depth controller actuating on the mass m through the ballast tanks and a pitch controller actuating on the axial location of the center of gravity x c g through the trim tanks are also added this control strategy effectively decouples pitch and depth control which caused problems with the simpler pd controller used in carrica et al 2016a the horizontal vertical mass and x c g control commands are 3 δ h p i d h y p i d h ψ 4 δ v p i d v z p i d v θ 5 δ m p i d m z 6 δ x c g p i d x c g θ as in overpelt et al 2015 the deflection imposed on the sail planes is δ v and each stern plane is deflected such that 7 δ s b d n δ v δ h 8 δ s b u p δ v δ h 9 δ p t u p δ v δ h 10 δ p t d n δ v δ h where plane rotations are positive using the right hand rule about the outward pointing rotation axis and the tail planes are named with subscripts indicating startboard sb port pt up up or down dn the rate of change of the stern planes is limited to 7 11 deg s at full scale and similarly mass and center of gravity location change rates are also limited 3 simulation tools the general purpose cfd code rex developed at iihr engineering and hydroscience at the university of iowa is used in this study rex incorporates elements of previously supported codes cfdship iowa v4 5 carrica et al 2007a and magnus rex is an unsteady reynolds averaged navier stokes detached eddy simulation urans des overset solver that uses a blended k ε k ω model for turbulence a single phase level set approach to model the free surface and dynamic overset grids to resolve large amplitude motions carrica et al 2007b local correlation langtry and menter 2009 menter et al 2015 and amplification factor transport coder and maughmer 2014 approaches are available in rex to compute boundary layer transition the air side is treated with a semi coupled approach in which the water ignores the presence of the air but the air is computed using the water free surface as an immersed boundary providing an excellent approximation to the air flow and forces on large scale objects like ships huang et al 2008 overset domain connectivity information is computed at run time using the code suggar noack 2005 or suggar noack et al 2009 while the surface weights to compute forces and moments are obtained using usurp boger and dreyer 2006 full six degrees of freedom 6dof rigid body motion computations with moving control surfaces and resolved or modeled propulsors are possible multibody dynamics capabilities are also available via magnusdyn libraries and allow simulation of connecting structures such as cables between the different discretized bodies included in the domain castro et al 2017 other capabilities include incoming regular and irregular waves fluid structure interaction paik et al 2009 li et al 2017 polydisperse bubble entrainment and transport models castro et al 2016 and density stratification esmaeilpour et al 2018 the equations are discretized using finite differences in space second order central for diffusion terms and fourth order upwind biased for convection terms time discretization is performed using a second order backwards scheme pressure velocity coupling is achieved using a complete reformulation of the projection algorithm used for coupling the velocity pressure and void fraction fields in hybrid collocated staggered curvilinear overset grids resulting in improved mass conservation compared to the standard projection method li et al 2015b li and carrica 2018 self propulsion of surface ships at model carrica et al 2010a 2012 and at full scale castro et al 2011 have been performed with excellent comparison with data maneuvering of a surface combatant in turn and zig zag with and without waves carrica et al 2013 and in broaching carrica et al 2012 demonstrated the capability of the code to handle complex situations with free surface flows recent simulations of kcs maneuvering in deep mofidi and carrica 2014 and shallow water carrica et al 2016b further validated complex maneuvering simulation capabilities high performance computations have been previously performed with grids of up to 300 million grid points for the surface combatant model dtmb 5512 in straight ahead static drift forward speed diffraction and pitching and heaving in waves carrica et al 2010b bhushan et al 2011 and for the crude carrier kvlcc2 on up to 305 million grid points xing et al 2010 new dynamic overset approaches martin et al 2016 have allowed the calculation of similarly large cases for the fully appended geometry of r v athena including a rotating discretized propeller with excellent scalability of the overset technology simulations specific capabilities related to underwater vehicle self propulsion include lower fidelity propeller models using a prescribed hough and ordway load distribution or a more complex approach coupling rex with the vortex lattice mit code puf 14 martin et al 2015 mofidi et al 2018 rex has a built in parallel architecture that facilitates access to variables and moving body components control surfaces rotating propellers to implement open loop and feedback controllers to compose autopilots as the one described in 2 further details of the code modeling numerical approaches and capabilities can be found in the provided references and literature therein variable mass and center of gravity location were implemented in the 6dof solver specifically to handle the depth and pitch controllers in eqs 5 and 6 in particular as the center of gravity changes so does the center of rotation of the boat requiring additional data transfer to suggar which needs this information to perform relative rotations between grids to compute the domain connectivity 4 geometry conditions and grids the joubert hull form is becoming an international benchmark for underwater vehicle hydrodynamics marin in the netherlands overpelt et al 2015 modified the original joubert geometry to add x tail planes and sail planes and replaced the sail by a square shape with rounded top based on naca 0022 hydrofoil see fig 2 the location and size of the sail and planes were optimized for maneuvering stability purposes in the model scale version used for free running experiments a 6 bladed stock propeller marin 7371r is employed for propulsion main particulars of joubert bb2 are shown in table 1 the simulation conditions are listed in table 2 the depth d 0 is measured from the top of the sail to the calm water surface such that positive d 0 is used for submerged sail and negative for exposed sail any condition with d 0 5 6 m has the deck exposed conditions with submergence of up to 40 m in full scale are considered with an emphasis on situations with the vehicle near the surface even keel cases were setup and computed allowing only forward motion with the speed controller used to achieve self propulsion as discussed in 2 controlled cases were computed in 6dof with the autopilot enabled at 5 selected depths d 0 6 9 3 9 2 5 4 and 23 69 m simulations were performed in calm water ss0 and regular head waves with properties similar to a nominal sea state 5 ss5 for all depths while at d 0 4 m submergence also head waves in nominal sea states 2 3 4 6 and 7 were studied note that the term sea state applies strictly only to irregular waves but is used in this paper to name the regular waves to easily identify the cases under study and the magnitudes of the waves regular waves for these nominal sea states are defined as having the same mean height and most probable wave period as waves in the north atlantic lewis 1989 detailed wave properties are listed in table 3 regular waves are imposed from exact solutions of surface elevation and velocity for linear waves as described in carrica et al 2007a but diffusion some wave reflection and deviations from linear wave solutions cause some changes in wave height and wavelength as the waves evolve into the domain the differences between nominal and actual wavelength at the location of the submarine cg were less than 0 4 for ss5 and lower reaching 6 for ss7 wave height errors were limited to 3 for larger waves and increased to about 7 for ss2 and ss3 as the waves are smaller and thus the grid becomes coarser to resolve them more accurately grid generation for a structured code like rex is challenging and requires considerable time but should be less of an issue in unstructured solvers used more commonly these days the overset grid system shown in fig 3 and detailed in table 4 is designed to allow 6dof computations near the surface and for self propulsion and autopilot control grids are organized in a parent children hierarchy assigned to bodies that follow either rigid body equations of motion or commands of a controller the grid system can be categorized into three sub groups hull of the boat moving appendages and background and refinements the boat body is the parent and comprises all grids moving with the submersible subject to the rigid body equations listed in carrica et al 2007b children bodies are also part of the parent but add their own motion around a fixed axis of rotation the propeller obeys the speed controller while sail and tail planes follow commands from the autopilot all independently the free surface refinement and background grids are restricted from heave roll or pitch motions thus always following the boat in the horizontal plane of the free surface thus maintaining grid quality to resolve incoming waves and boat induced waves the background grid was designed according to ittc recommendations ittc 2014 to handle waves and is coarsened half a boat length behind the boat to reduce wave reflections from the exit four systematically refined grids were generated starting with the fine grid and coarsening by a factor of 2 in each direction for each coarsening step the fine grid dimensions are shown in table 4 while medium coarse and very coarse grids total 48 6 17 4 and 6 21 million grid points respectively far field boundary conditions are imposed in the background grid and are defined as follows a regular waves at the inlet one boat length upstream as discussed in carrica et al 2007a b zero derivative of all quantities in the side bottom and exit boundaries also one boat length away from the boat with the exception of the exit conditions for velocity which are set to no traction zero second derivatives no boundary conditions are needed above the free surface in the air for a single phase level set approach as used by rex the dimensionless time step is set to 0 0003 which corresponds 1 9 degrees of propeller rotation in the worst case but more typically 1 65 per time step this short time step is a limiting factor in these simulations as 3333 time steps are required to advance one boat length at the reference speed typical submarine maneuvers with a body force propeller model can run successfully with time steps one order of magnitude larger martin et al 2015 all simulations in this paper were performed with the sst based delayed des turbulence model xing et al 2012 5 results and discussion in this section we present results initially for even keel conditions and then for the free running vehicle in all cases results are shown in dimensionless form unless explicitly showing dimensions in full scale though computations were performed at model scale at 1 2 m s 2 33 knots corresponding to 5 14 m s 10 knots in full scale 5 1 grid study though very satisfactory comparisons with experiments in self propulsion at depth and near the surface in calm water for joubert bb2 were reported in carrica et al 2016a no data is available for any other conditions and thus simulations in this paper are entirely blind to gain confidence in the simulations presented herein a limited grid convergence study was performed using the set of four grids described in 4 while a complete verification study would be desirable the cost was deemed too high and is therefore not performed in this paper instead only one even keel condition with d 0 0 702 m was chosen and run for all grids first a self propulsion run was performed with the coarse grid yielding a dimensionless propeller rotational speed of 16 3 r p s though self propulsion computations could have been performed for all grids we chose to maintain the r p s obtained for the coarse grids and impose constant speed to evaluate the difference in thrust and vertical and side propeller forces for each grid as shown in fig 4 results indicate that all propeller forces tend to converge in grid though the lateral force shows oscillatory convergence as shown on the left panel in fig 4 thrust fluctuations shown in fig 4 increase as the refinement increases as the free surface and vortical structures are better resolved and present more transient response the very coarse grid results are within 5 and 11 of the fine grid the coarse grid results are between 3 and 4 lower than the fine grid solutions and the medium grid are less than 2 off compared to the fine grid solutions the grid convergence of the boat vertical hydrodynamic force and the pitching moment are also shown in fig 4 in the right panel exhibiting oscillatory convergence and again differences between the coarse and the fine grid are limited to about 5 the cpu costs for the very coarse coarse and medium grids are approximately 22 5 8 and 2 8 times lower than the fine grid considering cost and resolution the coarse grid was selected for the simulations reported in the rest of the paper notice that the coarse grid still has a respectable 17 4 million grid points 5 2 even keel simulations were performed at even keel with the boat restricted to only forward motion with the objective of studying the forces and moments caused by the presence of the free surface and waves these forces are primarily responsible for free surface induced motions and environment inputs to the control algorithm two sets of cases were simulated simulations varying the sail top depth from 6 9 m negative depth indicates that the sail top is 6 9 m above the calm water line to 40 m sail top 40 m below the calm water line were performed for calm water sea state 0 abbreviated ss0 and ss5 to quantify depth influence on free surface effects the second set of cases is designed to study the influence of waves on the hydrodynamics of the vessel simulations were performed by imposing regular head waves representing sea states from 0 to 7 at sail top depth of d 0 4 0 m as discussed in 4 5 2 1 effects of depth self propulsion is achieved as discussed in 2 for each depth in calm water only and the obtained propeller rps was used for the simulations with waves the constant forward velocity of 10 knots is imposed for all cases and since the mean thrust and resistance in waves differ from the calm water simulations the vehicle does not reach a perfect balance of axial forces fig 5 shows the results of propeller r p s as a function of depth in calm water with depth expressed as s i g n d 0 d 0 l 0 that results in fairly evenly distributed points in the plots the propeller r p s is maximum for a sail top emergence of 6 9 m d 0 6 9 m where the static waterline is barely below the deck for d 0 3 9 m the r p s decreases then increases for d 0 0 9 m showing monotonically decreasing r p s with depth for all submerged cases the decrease in r p s from the trend at d 0 3 9 m is due to a decrease in resistance as the sail and sail planes are out of the water but the hull submerged see right panel in fig 5 showing the decomposition of forces for hull sail propeller thrust and sail and upper and lower tail planes even though the sail planes exert zero force as they go out of the water thrust and hull sail resistance dominate the force balance we speculate that the decrease in resistance at d 0 3 9 m is caused by a favorable depth of the hull that reduces wave making resistance and a decrease in sail resistance as half of it is out of the water but more analysis is needed to prove this hypothesis in the presence of waves wave induced velocities will interact with the boat induced flow the velocities can be expressed for linear small amplitude waves as 11 u 2 π a 0 t 0 e 2 π z λ 0 sin 2 π t t 0 2 π x λ 0 12 w 2 π a 0 t 0 e 2 π z λ 0 cos 2 π t t 0 2 π x λ 0 notice in eqs 11 and 12 that the streamwise and vertical amplitudes for ss7 with the parameters shown in table 3 are 30 5 of the boat forward speed at z 0 and 25 5 at 10 m submergence for ss5 these values decrease to 20 9 at the surface and 13 6 10 m below the surface still considerably large fluctuations thrust and torque coefficients depicted in fig 6 are consistent with r p s behavior showing a monotonic decrease as depth increases with the exception noted at d 0 3 9 m this trends are observed both for calm water and ss5 waves interestingly the mean thrust and torque coefficients in waves are lower than the calm water cases at the same depth especially for the cases near the surface and with emergence this can be interpreted as an increase of the average local velocity near the propeller resulting from the combined effect of the waves and the towed vessel hydrodynamics in reality other effects such as flow non uniformity are also important and possibly dominant and can be illustrated using the propeller performance curve k t j and k q j where j v a n d p is the advance coefficient and v a is the advance velocity over the wave cycle large variations of v a occur and instantaneously thrust and torque can be larger or smaller than the calm water value faltinsen et al 1980 analyzed the effective thrust coefficient for ships in waves attributing the decrease in thrust to the larger induced velocity by the propeller when in proximity to the surface which happens periodically in the presence of waves and results in a decrease in average thrust coefficient as the propeller approaches the surface or wave amplitudes increase this model also applies to our results it is important to remember that the simulation is conducted towed and the propeller thrust is not necessarily equivalent to the resistance and whether the thrust generated by the propeller rotating at a constant speed is larger or smaller than the calm water case is only a reflection of the flow conditions at the disk rather than a dynamic response of the system the first harmonics of the thrust and torque coefficients are shown in the right panel in fig 6 wave induced thrust and torque fluctuations are considerable for the two conditions with the propeller very close to the surface notice that for submerged cases the first harmonic of the thrust and torque coefficients peak for d 0 4 0 m and then decrease with depth to about 5 of their average value the vertical force shown in the top left panel of fig 7 is positive for all submerged conditions even for the deepest submergence which shows f z 0 025 w 0 with w 0 the weight of the boat this hydrodynamic force shows that with no control action on the planes or in the ballast tanks the vehicle would slowly rise the peak of suction force in submergence occurs for d 0 2 5 m but higher values occur when portions of the boat are exposed the zeroth harmonic of the suction force increases in the presence of waves we speculate that this phenomenon occurs because of two reasons that break the symmetry of the problem 1 the distortion of the free surface is different when the free surface elevation is decreasing or increasing resulting in different downward and upward forces and 2 the hull is not symmetric due to the presence of the deck causing different virtual mass and drag forces as the wave induced velocity field interacts with the hull in emerged conditions the vertical force is positive for d 0 3 9 m but becomes negative for d 0 6 9 m as the deck is exposed and water runs up the nose creating a net force down the top right panel in fig 7 displays the pitching moment with respect to the center of gravity as a function of depth as is the case with the vertical force the pitching moment at depth is not zero without control surface action or trim tank correction as forces on the sail and hull produce a pitch up moment in prototype scale of m y 0 400 k n m or about 0 013 of l 0 w 0 which can be interpreted as the effect of shifting the center of gravity by this percentage of the total length the figure shows that as the boat approaches the surface it quickly develops a more negative pitching moment sending the boat nose down this is mainly due to the tail suction described by tolliver 1996 the effect increases in the presence of waves sailing with the deck exposed results in massive bow down moment as the surface runs up the nose the first harmonic amplitudes of the vertical force and pitching moment for the cases in ss5 waves are shown in the bottom panel in fig 7 both decrease monotonically with sail depth except for the case of highest emergence the first harmonic amplitude of the vertical force at d 0 0 m is very large at f z 6 4 w 0 or approximately 282 tons in full scale and still very large at submergence d 0 15 m at 146 tons this level of vertical forces cannot be reasonably compensated by a control system and will thus cause vertical boat motions the decay trend with depth is consistent with the virtual mass force obtained from eq 12 considering only the vertical velocity fluctuations which amplitude can be approximated as 13 f z 1 v m c v m w 0 2 π t 0 2 a 0 e 2 π z λ 0 f c f w 0 e 2 π z λ 0 where f is a function that accounts for the different velocities at axial locations along the vehicle and c v m is the virtual mass coefficient at each axial location these and the other constants in eq 12 can be collapsed into a single constant c f to fit the vertical force resulting in an exponential decay a similar treatment yields a constant c m for the pitching moment the exponential decay trend lines are added in red to fig 7 showing that the vertical force and pitching moment fluctuations effectively decay exponentially with depth with the same rate as the wave induced velocities decay it is interesting to note that an upper limit for the drag force assuming the boat is a cylinder yields a vertical force f z 1 v m 0 5 c d w 2 l 0 b 20 tons at d 0 0 m assuming c d 0 5 and the maximum vertical velocity in eq 12 2 π a 0 t 0 this number is only 7 of the observed amplitude of the vertical force fluctuations and would decay with depth as e 4 π z λ 0 which does not fit the data supporting the view that virtual mass force dominates the problem the wake of the propeller at x l 0 1 05 presented in fig 8 for depths d 0 6 9 m 3 9 m 2 5 m and 4 0 m shows that for the cases with the sail exposed d 0 6 9 m 3 9 m the propeller is close enough to the surface for the wake to be strongly affected by the waves creating a highly fluctuating inflow to the propeller due to the strong wave induced streamwise velocity but also modifying the boundary layer of the hull and wakes of sail and appendages the submerged cases at d 0 2 5 m and 4 0 m even though very close to the surface have the shaft deep enough that the propeller inflow is mainly affected by the streamwise wave induced velocity 5 2 2 effects of wave amplitude sea states from 2 to 7 were simulated to study effect of wave amplitude in self propulsion for a single depth of d 0 4 0 m this depth was selected as a representative value of operation very close to the surface for which the sail structure remains marginally wet during the computation for all wave amplitudes the wavelength also varies with sea state but amplitude is the dominant parameter and results are analyzed with respect to this variable only fig 9 shows the mean thrust and torque coefficients and the first harmonic amplitude of the thrust and torque normalized with their means as a function of wave amplitude with each point representing waves of ss2 to ss7 and calm water added at zero amplitude both thrust and torque decrease as the wave amplitude increases consistent with the observations for ss5 discussed in 5 2 1 the thrust and torque fluctuations are strongly correlated with the wave encounter frequency with the first harmonic vastly dominating the response the amplitude of the fluctuations is moderate for ss4 limited to 10 of the thrust or torque and less than 3 for ss3 and below but can reach extreme vales in ss7 over 50 of the mean thrust and 30 of the mean torque fig 10 shows the vertical force and pitching moment as a function of the wave amplitude the vertical force increases with wave amplitude consistent with the results shown in fig 7 reaching 0 21 of the weight in suction the first harmonic amplitude increases monotonically with wave amplitude exceeding 10 of the weight for ss7 the right panel in fig 10 shows that the zeroth harmonic of the pitching moment remains negative respect to the deep condition decreasing for sea states lower than 3 then increasing up to ss6 to decrease dramatically for ss7 the first harmonic amplitude of the pitching moment increases up to ss5 and then decreases for higher amplitude waves the trend of the virtual mass with wave amplitude and length from eq 13 is given by c 2 2 π t 0 2 a 0 e 2 π z λ 0 with c 2 accounting for all constants and factors in the equations as fig 10 shows this trend matches extremely well the trends observed in the simulations for pitching moments but not for vertical forces fig 11 shows vortical structures as isosurfaces of the second invariant of the velocity tensor q 50 as well as the free surface for the four quarter phases of one wave encounter period and for waves corresponding to ss5 and ss7 note that the q criterion shows spurious vortical structures near but at different distances from the hull giving it the appearance of a painted hull with different colors depending on the distance to the solid surfaces these artifacts should be ignored and attention focused on separated structures the zero phase ε 0 o is defined as the instant in which the undisturbed incoming wave crest is located at the sail top position in ss7 the free surface lightly touches the sail but it mainly affects the flow with the induced velocities shown in eqs 11 and 12 in addition to the propeller tip and hub vortices the strongest structures present in the flow are tip vortices generated periodically in the sail and tail planes as the wave induced velocity changes the angles of attack the necklace vortex on the sail hull and the tail plane roots hull junctures and at the tip of the sail all these vortices are transported by the flow and many of them are periodically ingested by the propeller cross sections downstream of the sail x l 0 0 67 and upstream of the propeller x l 0 0 95 for sail top depth d 0 4 0 m in calm water and ss5 and ss7 waves colored with dimensionless streamwise velocity are shown in fig 12 the change in far field wave induced streamwise velocity as the wave passes can be clearly observed as well as the slight decay of velocity with depth the vertical velocity fluctuations produce a thickening of the boundary layer on the bottom of the hull at ε 90 and 180 clearly observable in ss7 at x l 0 0 67 and considerable signature of the sail and sail plane vortices these result in considerable fluctuations in the inflow to the propeller also affected by the wake and tip vortices of the tail planes 5 2 3 propeller performance the propeller performance was studied for the case operating at depth d 0 40 m for emerged condition with the propeller closest to the surface d 0 6 9 m and submerged near the surface d 0 4 m for ss0 and ss5 performance curves for propeller marin 7371r previously computed by pontarelli et al 2017 were used as reference for the analysis fig 13 shows propeller performance curves obtained using the thrust identity method ittc 2008 to obtain the advance coefficient from equating the open water propeller thrust with the propeller thrust obtained from the cfd computations then the torque coefficient and propeller efficiency can be obtained at every time step of the simulation since the inflow to the propeller is transient and not uniform due to the wake of the appendages turbulence and the wave induced velocity fluctuations see figs 8 and 12 the procedure results in a cloud of points in torque and efficiency in calm water the propeller operates close to the maximum efficiency point at depth and as resistance and load increase near the surface the efficiency decreases notice that the propeller installed in the boat exhibits a maximum efficiency of approximately 60 below the maximum open water efficiency of approximately 70 the fluctuations in advance coefficient increase as the propeller approaches the free surface resulting in larger torque and efficiency variations in waves the inflow velocity fluctuations become considerably more marked decreasing quickly at deeper depths when the propeller is closest to the free surface the torque coefficient shows variations of 30 see also fig 6 and the efficiency shows a much wider variation for the same advance coefficient than in calm water notice also that the average efficiency decreases slightly when operating in waves as the propeller experiences larger inflow non uniformities that cause strong transient changes in angles of attack in the blades and different operational points at different radii the spectral response of the thrust coefficient is shown in fig 14 a clear peak at the wave encounter frequency is observed for the cases in waves along with a second harmonic peak the case at d 0 6 9 m exhibits strong broadband noise caused by interaction of the propeller with vortices induced by hull free surface interaction decreasing with frequency up to a clear peak at the blade passage frequency or six times the rotational frequency shown in fig 5 the width of the peak is related to the interaction of the blades with passing vortices which changes the period between thrust peaks and troughs a second harmonic can be observed caused by the interaction of the blades with the wakes of the stern planes which occurs every 30 degrees of propeller rotation a fourth weaker but clear harmonic is also present generated as one blade passes the wake of the sail and the next passes the starboard top stern plane after 15 degrees of rotation as the propeller rotates slower this pattern is repeated at higher depths with considerably less broadband noise and with much lower low frequency content for the deep case with no waves 5 3 controlled self propulsion controlled self propulsion simulations were performed for calm water and nominal ss5 regular head waves at sail top depths d 0 6 9 3 9 2 5 4 and 23 69 m the control algorithm described in 2 attempts to maintain the target depth and speed while zeroing pitch sway and yaw the vertical and ballast tank controllers are deactivated for the cases with the sail exposed as enough buoyancy is present to keep the boat floating but the trim tanks compensate for tail suction for the submerged cases the ballast tanks are used to compensate for surface suction but the trim tanks are deactivated leaving the vertical control able to mostly compensate for pitch 5 3 1 controller commands and motions fig 15 shows the commands for change in mass for the submerged cases and change in longitudinal location of the center of gravity for the cases with the sail exposed for the submerged cases the mass is compensated through the ballast tanks to help balance the vertical force and reduce deflection of the control planes an operation unnecessary in emerged mode since buoyancy is positive electronic annex i shows a video of the original bb2 controller presented by overpelt et al 2015 performing in self propulsion in ss5 waves at d 0 2 5 m and 10 knots the pd controller couples depth and pitch control into a single vertical command thus as the tail suction decreases depth and pitches the boat bow down the controller has a competing command to send the bow down to increase depth with a bow up command to increase pitch this depth pitch coupling prevents properly achieving both controller targets in addition the lack of an integral term results in permanent errors in pitch and depth an improvement to this controller for operation near the surface was discussed in 2 and a video is shown in electronic annex ii in this case the ballast tanks are used to independently control depth by compensating the suction force with additional weight this decouples depth and pitch commands and together with the addition of an integral component in the controller results in zero error on the mean pitch and depth fig 15 shows the change in mass for the submerged cases and the change in longitudinal location of the center of gravity for the cases with the sail exposed as expected the mass correction decreases with depth as the influence of the free surface decreases with a maximum of approximately 0 3 of the displacement 13 tons in full scale the correction is higher in waves and the decay in correction with depth is faster as wave influence also decays with depth these mass increases mostly compensate for the suction forces shown in figs 7 and 10 but also for vertical forces resulting from the geometry asymmetries caused by the sail sail planes and deck the cases with the sail exposed require trim tank correction of the longitudinal location of the center of gravity to prevent excessive bow down attitude this occurs because of the strong tail suction with the hull very close to the free surface while the vertical correction is hampered by loss of the sail planes out of the water and loss of authority by the tail planes operating too close to the surface resulting in inability to compensate for the large pitching down moments shown in fig 7 an example of the response without trim tank correction and with vertical control disabled is shown in electronic annex iii which shows a video of joubert bb2 operating initially at d 0 3 9 m tail suction is strong and sends the bow down which then produces a bow down pitching moment the boat then tends to sink to depth but tail suction pitch down moment and sail buoyancy eventually reach an equilibrium point with a considerable bow down attitude an attempt to use the tail planes to control depth results in unstable porpoising as the bow down portion of the period produces a large bow down moment that requires large tail deflection to compensate thus overshooting as the boat attitude recovers the process is shown in the video in electronic annex iv the best solution found to control the cases with sail exposed is to disable the vertical controller and use the trim tanks to compensate for the tail suction this is shown in electronic annex v for d 0 3 9 m in calm water and in electronic annex vi in sea state 5 waves this control strategy was used for all simulations at both emerged depths with and without waves the center of gravity is displaced to stern within 10 of δ x c g 0 0027 l 0 see fig 15 with more correction needed in waves for d 0 6 9 m and more in calm water for d 0 3 9 m for trim tanks located at x c g 0 4 l 0 a displacement in center of gravity δ x c g 0 0027 l 0 requires transferring almost 15 tons of water from the bow to the stern tanks it is interesting that the correction is larger for d 0 3 9 m than for d 0 6 9 m while even keel runs showed a much stronger bow down moment at d 0 6 9 m see fig 7 this is a consequence of the response to the heave force also shown in fig 7 as discussed below which essentially positions the boat at the same distance from the free surface the horizontal and vertical commands are shown in fig 16 the first harmonic amplitude of the horizontal command maintains heading and prevents sway and stays below 0 8 for all depths with less response in calm water at depth the correction needed is approximately 0 6 to starboard compensating a small turning moment to port created by the propeller side force the horizontal command shifts to port when very near the surface as the propeller blades are less efficient on top near the surface and the side force reverses with the effect slightly amplified by the presence of waves the first harmonic amplitude in waves is limited to 0 15 showing again that head waves affect little the turning moments or side forces vertical commands used only for the submerged cases are larger than the horizontal commands at depth the vertical command to the control surfaces compensates the positive pitching moments shown in fig 7 while closer to the surface the correction needed decreases but is always higher in waves as expected the first harmonic amplitudes are highest near the surface reaching almost 7 deflection and decrease quickly with depth the zeroth harmonic amplitudes of the vertical motions shown in fig 17 are small for the submerged cases as depth is well controlled by the ballast tank controller which fluctuates slowly to maintain the mean depth emerged cases are subject to surface suction that is compensated by buoyancy of the sail which is relatively small as a result mean equilibrium positions shift considerably in the vertical direction at d 0 3 9 m the suction dominates and the hull translates up approximately 1 2 m resulting in an effective depth d 5 1 m at d 0 6 9 m the deck is slightly exposed and the vertical force reverses see fig 7 causing sinkage of about 1 5 m leaving the boat at d 5 4 m slightly higher than the case with d 0 3 9 m and with the deck slightly submerged waves affect little the zeroth harmonic amplitude the first harmonic amplitude of the vertical motions also shown in fig 17 increases as the boat operates closer to the surface as expected with amplitude approaching 40 of the wave amplitude at the surface and still about 10 amplitude at d 0 23 69 m notice that the amplitude of the vertical motion of a passive particle which decays as e 2 π z λ 0 is 34 of the wave amplitude at d 0 23 69 m implying that the depth controller is effectively reducing vertical motions in a single screw boat the roll righting moment has to balance the propeller torque fig 17 shows that the mean roll angle increases as the boat approaches the surface this is due to an increase in torque as the boat approaches the surface and for the cases with the sail exposed by the lower center of buoyancy as partial emergence occurs the maximum mean roll angle is moderate at 1 2 and the presence of waves has almost no effect the first harmonic amplitude of the roll motions in waves is also very small at a maximum of about 0 24 the zeroth harmonic of the pitch motions is essentially zero for all cases in calm water or waves as the controller has integral terms that zero the mean pitch and thus are not shown in fig 17 the same occurs with the boat speed the first harmonic amplitude of pitch in waves follows a similar trend as the vertical motions reaching about 40 of the wave slope and dropping to approximately 10 at depth the speed controller cannot maintain a constant 10 knot velocity as surge forces cannot be overcome by the propeller with reasonable thrust and torque fluctuations of 7 5 amplitude are observed for the emerged cases that decrease to 1 5 at d 0 23 69 m note that pitch and heave first harmonic amplitudes in waves are very similar but slightly milder at d 0 6 9 m than at d 0 3 9 m 5 3 2 propeller performance and flow field fig 18 shows the propeller response in calm water and ss5 waves the deepest controlled case exhibits an increase of 1 5 in propeller r p s with respect to the even keel case shown in fig 5 due to additional resistance caused by the deflected appendages submerged near the surface this effect is amplified with the r p s increasing about 3 with respect to the even keel results the emerged cases exhibit wider variations with respect to the even keel cases as the boat accommodates in sinkage and trim to the presence of the free surface without vertical control this results in an increase in r p s at d 0 3 9 m and a decrease at d 0 6 9 m the presence of waves requires higher r p s to overcome the added resistance as expected with the notable exception of d 0 6 9 m possibly due to the higher net buoyancy that reduces the motion effects of waves as shown in fig 17 the first harmonic amplitude of the propeller r p s when operating in waves shown in fig 18 is entirely dependent on the controller used to maintain speed a moderate gain controller as used in this paper results in changes in r p s in the order of 13 of the mean r p s at depth and up to 28 near the surface in an attempt to maintain boat speed this controller is able to maintain speed within 7 5 of the target speed at the surface and 2 at depth the analysis could have been performed at constant r p s corresponding to the calm water values at each depth as done for the even keel conditions but results in stronger fluctuations in velocity and additional feedback with the motion controllers complicating the analysis zeroth and first harmonic amplitudes of thrust and torque coefficients are shown in fig 19 consistent with the propeller r p s the average thrust and torque coefficients peak for d 0 3 9 m and decreases for d 0 6 9 m and also with depth k t and k q are slightly higher than corresponding values in even keel conditions again consistent with the r p s results note that as opposed to the even keel cases the presence of waves consistently increase k t and k q as the propeller r p s increases in waves and thus the advance coefficient decreases increasing load the first harmonic amplitudes of thrust and torque follow similar trends observed in even keel conditions but the magnitudes are considerably larger as the controller attempts to maintain speed in a fluctuating inflow fig 20 shows the free surface and vortical structures as isosurfaces of q 50 for the four quarter phases of one wave encounter period for depths d 0 3 9 m and 4 0 m in ss5 the interaction of the hull with the wave induced pressure field causes adverse and favorable pressure gradients that result in separation in the deck for the case with the exposed sail in addition vertical wave velocities cause cross flow that results in generation of streamwise vortices as the waves move water up and down across the hull these strong primary hull free surface interaction mechanisms and consequent secondary flows result in massive generation of vortical structures that are transported downstream into the propeller this also results in large disturbances to the top half of the nominal wake causing a broadband frequency response from the propeller and widening considerably the main peak at the blade passage frequency as discussed later in reference to figs 24 and 25 in addition the top tail planes penetrate the surface reducing their effectiveness results for d 0 4 0 m in fig 20 can be compared to the even keel condition shown in fig 11 the vortical structures are in general weaker and more streamlined as the boat accommodates to some extent to the wave contour the wake of the propeller tends to be fairly well aligned to the boat as opposed to the even keel case where the wake was strongly deflected by the wave induced vertical velocity fig 21 provides a direct comparison of controlled vs even keel conditions for the streamwise velocity at the centerplane even keel constant rotational speed conditions effectively decouple the dynamics of the system from the varying flow conditions affecting the propeller performance this is particularly evident at ε 180 for which the propeller wake follows vertically the wave velocity profile when controlled but opposes its direction for even keel conditions as a result of changes to the ingested hull boundary layer and wake at this condition due to the interaction of the wave and the hull which has a slightly downward attitude when controlled i e it follows the wave the flow into the propeller is more uniform and slower when controlled resulting in higher propeller load while for even keel conditions the flow is highly non uniform and overall containing higher speed regions at the top instantaneous views of cross sections downstream of the sail x l 0 0 67 and upstream of the propeller x l 0 0 95 for sail top depths d 0 3 9 m and 4 0 m in calm water and ss5 colored with dimensionless streamwise velocity are shown in fig 22 these cross sections are in the earth system of coordinates following the ship resulting in vertical planes not necessarily perpendicular to the boat shaft axis the case for d 0 4 0 m can be compared with the results in even keel condition shown in fig 12 differences between free running and even keel results at this depth are small with variations in the strength of the vortices generated by the sail and sail planes as they are deflected in free running as well as less evidence of boundary layer thickness fluctuations caused by cross flow for the controlled case as it allows some motions following the wave induced velocities the case at d 0 3 9 m on the other hand exhibits effects of the strong hull free surface interaction discussed in reference to fig 20 in calm water the unsteady vortices produce a wandering wake that is clearly visible at x l 0 0 95 with velocity defect exceeding 50 of the forward velocity in the case with ss5 waves the streamwise vortices discussed previously leave a signature in the boundary layer clearly visible at ε 0 and 180 for x l 0 0 67 the velocity fluctuations in the flow upstream of the propeller at x l 0 0 95 show a low velocity wake in the top quarter of the propeller disk reacting with the wave encounter frequency the propeller inflow is almost uniform at ε 90 resulting in the least propeller load fluctuations the local advance coefficient is maximum at ε 180 resulting in minimum average propeller load while the average propeller load and load fluctuations peak at ε 270 fig 23 shows cross sections at downstream of the propeller at x l 0 1 05 for d 0 6 9 m 3 9 m 2 5 m and 4 0 m and the quarter phases ε 0 90 180 and 270 in ss5 colored with streamwise velocity notice that solutions for d 0 6 9 m and 3 9 m are closer to each other than in the even keel results shown in fig 8 as in free running these two cases stabilize at approximately similar mean depths it is also evident that the propeller thrust varies more strongly with the wave phase in the controlled cases as the speed controller attempts to maintain speed at 10 knots in the emerged cases d 0 6 9 and 3 9 m the wake of the top tail planes is weaker than for the even keel simulations the propeller wake exhibits azimuthal non uniformity as the incoming wake into the propeller shown in fig 23 is strongly non axisymmetric the results for the submerged cases are more similar to those in even keel conditions though the propeller load varies strongly as the propeller rotational speed is controlled to maintain the vehicle speed the spectral response of the thrust coefficient is shown in fig 24 for depths d 0 3 9 m and 4 0 m while trends are qualitatively similar to those shown in fig 14 for even keel conditions the widening of the blade passage frequency response is clear mainly obeying to the fluctuations on propeller rotational speed caused by the controller at d 0 4 0 m for d 0 3 9 m the blade passage frequency peak widens considerably more and its amplitude decreases due to inflow of large scale turbulence structures produced as a result of interaction between the free surface and the deck as discussed in reference to figs 21 23 fluctuations in propeller thrust due to variations in boat speed and propeller r p s are reflected in the performance curves shown in fig 25 for self propulsion in calm water in emergence d 0 3 9 m the propeller operates at a higher load range than for the even keel case shown in fig 13 for d 0 6 9 m as the strong turbulence caused by interaction with the free surface affects the propeller inflow and therefore its instantaneous advance coefficient at d 0 4 0 m the even keel and controlled results are similar with a slightly wider range of loads for the controlled case in waves the propeller operating point fluctuates from highly loaded with advance coefficient reaching j 0 25 for d 0 3 9 m and j 0 37 for d 0 4 0 m at wave phase ε 270 the minimum thrust condition the propeller acts as a brake for the emerged condition and produces almost zero thrust for d 0 4 0 m as reflected by the low propeller wake velocity shown in fig 23 for ε 270 6 conclusions a cfd study of self propulsion near the free surface in calm water and head waves was presented computations were performed in even keel and constant depth conditions with no actuation on the control surfaces and also in controlled mode in which the vehicle is free in 6dof and the control surfaces ballast and trim tanks are actuated to maintain course depth and zero pitch the effects of depth and regular waves for nominal sea states from 2 to 7 were analyzed even keel runs in calm water reveal an expected increase in propeller rotational speed and thrust as the boat gets closer to the free surface the thrust and torque coefficients also increase slightly with proximity to the surface indicating an increase in propeller load when operating near the free surface the mean thrust and torque coefficients are slightly lower in waves than in calm water due to higher inflow velocities into the propeller plane the first harmonic amplitudes of the thrust and torque coefficients in waves also show an increase as the boat approaches the free surface though a slight decrease occurs very near the surface tail suction causes upward vertical force and bow down pitching moment increasing as the boat approaches the surface with very large values for the cases with the sail exposed the vertical forces reverses dramatically as the nose approaches the surface d 0 6 9 m as pressure forces on the nose overcome vanishing tail suction as the deck is exposed in waves all these effects are amplified with changes with depth of the first harmonic amplitudes of vertical force and pitching moment responding well to a virtual mass dominated model vertical forces and pitching moments and their fluctuations are very large when the vehicle is approaching the free surface complicating control of the vehicle simulations in even keel for various wave amplitudes at d 0 4 0 m show that the mean thrust and torque coefficients decrease with wave amplitude while the first harmonic amplitude of the thrust fluctuations increase roughly linearly with wave amplitude the same effect is observed for vertical forces the first harmonic amplitude of the pitching moment as a function of wave amplitude also follows well the trend predicted by a virtual mass dominated process free running simulations with controllers expose the difficulty of controlling vertical motions and pitch when subject to the large forces and moments created by interaction with the free surface ballast tank mass corrections of 0 2 0 3 of the displacement are needed to balance vertical suction forces when submerged near the surface while trim tank actuation for longitudinal center of gravity displacements of over 0 25 of the boat length are needed in the emerged cases to maintain the boat horizontal in waves the amplitude of displacement of the sail and tail planes can reach 7 for the vertical control the depth and pitch first harmonic amplitudes are limited to z 1 a 0 4 and θ 1 k a 0 4 when very close to the surface demonstrating that considerable pitch and heave oscillations are still present even under depth and pitch control operation this is expected given the very large forces and moments induced by the waves near the free surface changes in propulsion characteristics between even keel and controlled conditions show the importance of considering the coupling between the boat dynamics and the ambient flow when operating in waves operation in controlled mode in waves results in propeller fluctuations in r p s of about 25 when very close to the surface which results in first harmonic amplitude of the thrust fluctuations of up to 90 these fluctuations in propeller rotational speed and large inflow velocity oscillations caused by the wave induced velocity and the wake of the boat result in a wide frequency response of the propeller thrust with a peak centered at the blade passage frequency the local advance coefficient can experience considerable fluctuations ranging from high propeller loads to brake operation the turbulence induced fluctuations into the propeller plane are very large for the cases with the sail exposed where hull free surface interaction result in massive flow separation that reaches the propeller future work will focus on free surface effects on maneuvers with and without waves acknowledgements this work was supported the us office of naval research under grant n00014 17 1 2293 with dr ki han kim as program manager appendix a supplementary data the following are the supplementary data to this article electronicannexi electronicannexi electronicannexii electronicannexii electronicannexiii electronicannexiii electronicannexvi electronicannexvi electronicannexv electronicannexv electronicannexvi electronicannexvi appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 082 
22757,we present a study of the response of the generic joubert bb2 geometry self propelled near the free surface using a dynamic overset methodology with discretized propeller and control surfaces a grid study was performed for sail top depth 0 702 m even keel simulations at depths ranging from 6 9 m to 40 m were conducted in calm water and regular waves representative of sea state 2 to 7 an autopilot acting on sail and tail planes ballast and trim tanks was used to simulate controlled self propulsion at several depths in calm water and waves the even keel study shows that near surface operation causes considerable vertical forces and pitching moments and an increase in required propeller thrust to achieve self propulsion decreasing efficiency the boat responds to waves mainly through the added mass forces produced by the wave induced velocity field causing an exponential decay of the wave influence with depth and with decreasing wave amplitude in controlled free running simulations very near the surface the boat responds to the forces observed in even keel requiring compensation through the trim tanks to prevent high bow down pitch hull free surface interaction causes fluctuations in the wake resulting in a broadband response of propeller thrust keywords submarine self propulsion autopilot free surface 1 introduction near surface operation of underwater vehicles is affected by hydrodynamic effects caused by the presence of the air water interface one well known effect is the tail suction that results in a bow down attitude unless corrective measures are taken tolliver 1996 the pressure field caused by the hull produces a free surface deflection which in turn affects the flow field around the vehicle in a two way coupling mode the resulting hydrodynamic forces and decrease of authority of the upper control surfaces test the ability of the control systems to maintain the boat trimmed and at constant depth less uniform flow fields into the propeller and consequent vibrations and noise are also a result of the interaction with the free surface earlier work on boat propulsion was performed on the generic darpa suboff and onr body 1 geometries self propulsion studies of darpa suboff appended with the insean e1619 propeller were presented by liefvendahl and tröeng 2011 chase and carrica 2013 and sezen et al 2018 resulting in good comparisons among different authors chase et al 2013 performed a horizontal overshoot maneuver with a rotating propeller technique and also coupling the mit propeller code puf 14 warren et al 2000 with computational fluid dynamics cfd showing that the coupling with a lower fidelity propeller code yielded similar results to the more accurate but expensive rotating propeller approach at the cost of decreased resolution in the wake flow field submarine maneuvers are relevant to propulsion simulation since they are preceded by a self propulsion stage that typically shares the same numerical techniques simulations of maneuvering for the onr body 1 were first reported by pankajakshan et al 2002 using rans with active control surfaces and a resolved rotating propeller demonstrating the capability of their approach though the authors did not complete a full maneuver black and michael 2003 performed overshoot maneuvers using a coupled puf14 rans approach showing good match with experimental data in a later work venkatesan and clark 2007 performed horizontal overshoot maneuvers using a moving propeller also with good results compared to experiments dubbioso et al 2015 performed 3 degree of freedom 3dof horizontal turn maneuver simulation using an actuator disc model near free surface and at infinite depth in all these cases the maneuvers did not have depth or pitch control in a more recent work with both discretized propeller and cfd puf 14 coupling approaches martin et al 2015 studied self propulsion and horizontal and vertical overshoot maneuvers focusing on the propeller flow and performance through the maneuvers providing a complete comparison with experimental data for motions forces and velocities also in self propulsion they concluded that while the discretized propeller approach is more accurate the results are also good with a coupled cfd potential flow propeller model approach at a fifth of the computational cost in this paper we study near surface self propulsion performance of the generic submarine joubert bb2 designed by joubert 2004 2006 and modified by marin in the netherlands overpelt et al 2015 the primary objective of the investigation is to assess the effect of the free surface on propulsion performance and forces moments and motions of an underwater vehicle self propulsion and controlled turn and zigzag maneuvers experiments are reported in overpelt et al 2015 self propulsion and free running cfd simulations of joubert bb2 at depth are presented by carrica et al 2016a carrica et al 2018 and kim et al 2018 in all cases comparing favorably against experiments by overpelt et al 2015 effects of the presence of the free surface on propeller performance and joubert bb2 self propulsion were studied for the first time by li et al 2015a a numerical and experimental study of self propulsion using the codes refresco and rex was presented by carrica et al 2016a the study included self propulsion at depth and near the surface using a coupled cfd propeller code or discretized propeller and direct simulation of controlled 20 turn and horizontal 20 20 zigzag maneuvers a max q surfacing maneuver was studied including a propeller crashback maneuver to stop the vehicle in all cases results compared well with experiments though forces and moments on appendages deviated moderately from experiments this deviation could possibly be attributed to transition from laminar to turbulent boundary layer an effect neglected in cfd unless transition models langtry and menter 2009 menter et al 2015 are included in the simulations which has been done only as preliminary study for complex geometries like joubert bb2 martin et al 2018 while limited self propulsion of underwater vehicles near the free surface has been investigated and reported studies of self propulsion in waves are not available in the literature in this paper we present cfd simulations of self propulsion near the surface in calm water and waves discuss challenges to perform these simulations and analyze the effects of the free surface on forces and moments and stability this investigation focuses further on effects of underwater vehicle operation near the surface in self propulsion conditions include partial submergence sail above the free surface and top of sail at different depths in calm water and in regular head waves fixed even keel and autopiloted free body conditions are studied 2 self propulsion and autopilot experimental propulsion tests as recommended by the international towing tank conference ittc 2008 are typically performed with captive models in a towing tank for a given vehicle target speed runs at different propeller rotational speeds in revolutions per second or rps are performed until the towing force is zeroed such that self propulsion is achieved by balancing propeller thrust with total resistance a similar approach can be applied in cfd though cost is usually high since several runs at different rps are needed to obtain the self propulsion point a second approach more appropriate for cfd applies a speed controller to achieve the target speed resulting in self propulsion in a single run carrica et al 2010a chase and carrica 2013 a generic linear proportional integral derivative pid controller can be expressed as 1 p i d ξ γ p ξ e γ d ξ d e γ d t i ξ 0 t e γ d t where ξ is the actuated command propeller rps in the case of the speed controller and e γ γ t γ the error on any variable γ the boat speed in this case with respect to its target value γ t for the cases in calm water the convergence can be accelerated using a non linear integral term of the form 2 p i d ξ γ p ξ e γ d ξ d e γ d t i ξ 0 t e γ 1 n d t where n is larger than one fig 1 shows the integrand in eq 2 for n 3 as well as the effect of this term in the convergence rate of a self propulsion computation of bb2 in even keel condition near the surface as the boat speed approaches the target value the error decreases and the integrand decreases requiring longer times to converge to the desired speed applying a cubic root function results in a larger integrand for smaller errors speeding up convergence the faster settling to the target speed can be seen in the right panel of fig 1 which shows that acceleration of the boat and formation of the boundary layer and free surface waves takes approximately 3 dimensionless seconds or the time to advance three boat lengths the controller with the non linear integral term can achieve the target speed in approximately one ship length by heavily loading the propeller as shown by the propeller rps however the self propulsion condition takes longer to be established as the rps accommodates to the changing resistance due to boundary layer and free surface wave field development operation near the surface requires additional control to maintain depth and compensate tail suction which results in excessive pitch that may cause the propeller to surface or boat to dive the autopilot system is based on the original bb2 proportional derivative pd controller presented in overpelt et al 2015 and carrica et al 2016a with improvements described in this section it is important to note that changes in the autopilot will result in different responses to transients in particular waves a better designed autopilot will be able to control the desired attitude of the submarine under more violent or complex operational situations in this paper we present an autopilot that performs adequately under the operational conditions presented herein but no efforts have been made to optimize it one of the limitations of a pd controller is that it cannot zero the error thus being generally unable to achieve the targets fossen 1994 a pid controller as in eq 1 removes this limitation by adding an integral component the autopilot control system in overpelt et al 2015 calculates horizontal and vertical commands δ h and δ v respectively to impose deflections on the sail and tail planes linking the horizontal command to errors in sway and yaw and the horizontal command with errors in pitch and depth this pid approach has two problems the first is that in near surface operation the tail suction causes a consistent upward force and a nose down pitching moment which stress sail and tail plane deflection to maintain the target depth and pitch increasing resistance the second problem is that pitch and depth are coupled into the vertical command and thus zeroing both errors results in coupled pitch depth motions to prevent these issues a depth controller actuating on the mass m through the ballast tanks and a pitch controller actuating on the axial location of the center of gravity x c g through the trim tanks are also added this control strategy effectively decouples pitch and depth control which caused problems with the simpler pd controller used in carrica et al 2016a the horizontal vertical mass and x c g control commands are 3 δ h p i d h y p i d h ψ 4 δ v p i d v z p i d v θ 5 δ m p i d m z 6 δ x c g p i d x c g θ as in overpelt et al 2015 the deflection imposed on the sail planes is δ v and each stern plane is deflected such that 7 δ s b d n δ v δ h 8 δ s b u p δ v δ h 9 δ p t u p δ v δ h 10 δ p t d n δ v δ h where plane rotations are positive using the right hand rule about the outward pointing rotation axis and the tail planes are named with subscripts indicating startboard sb port pt up up or down dn the rate of change of the stern planes is limited to 7 11 deg s at full scale and similarly mass and center of gravity location change rates are also limited 3 simulation tools the general purpose cfd code rex developed at iihr engineering and hydroscience at the university of iowa is used in this study rex incorporates elements of previously supported codes cfdship iowa v4 5 carrica et al 2007a and magnus rex is an unsteady reynolds averaged navier stokes detached eddy simulation urans des overset solver that uses a blended k ε k ω model for turbulence a single phase level set approach to model the free surface and dynamic overset grids to resolve large amplitude motions carrica et al 2007b local correlation langtry and menter 2009 menter et al 2015 and amplification factor transport coder and maughmer 2014 approaches are available in rex to compute boundary layer transition the air side is treated with a semi coupled approach in which the water ignores the presence of the air but the air is computed using the water free surface as an immersed boundary providing an excellent approximation to the air flow and forces on large scale objects like ships huang et al 2008 overset domain connectivity information is computed at run time using the code suggar noack 2005 or suggar noack et al 2009 while the surface weights to compute forces and moments are obtained using usurp boger and dreyer 2006 full six degrees of freedom 6dof rigid body motion computations with moving control surfaces and resolved or modeled propulsors are possible multibody dynamics capabilities are also available via magnusdyn libraries and allow simulation of connecting structures such as cables between the different discretized bodies included in the domain castro et al 2017 other capabilities include incoming regular and irregular waves fluid structure interaction paik et al 2009 li et al 2017 polydisperse bubble entrainment and transport models castro et al 2016 and density stratification esmaeilpour et al 2018 the equations are discretized using finite differences in space second order central for diffusion terms and fourth order upwind biased for convection terms time discretization is performed using a second order backwards scheme pressure velocity coupling is achieved using a complete reformulation of the projection algorithm used for coupling the velocity pressure and void fraction fields in hybrid collocated staggered curvilinear overset grids resulting in improved mass conservation compared to the standard projection method li et al 2015b li and carrica 2018 self propulsion of surface ships at model carrica et al 2010a 2012 and at full scale castro et al 2011 have been performed with excellent comparison with data maneuvering of a surface combatant in turn and zig zag with and without waves carrica et al 2013 and in broaching carrica et al 2012 demonstrated the capability of the code to handle complex situations with free surface flows recent simulations of kcs maneuvering in deep mofidi and carrica 2014 and shallow water carrica et al 2016b further validated complex maneuvering simulation capabilities high performance computations have been previously performed with grids of up to 300 million grid points for the surface combatant model dtmb 5512 in straight ahead static drift forward speed diffraction and pitching and heaving in waves carrica et al 2010b bhushan et al 2011 and for the crude carrier kvlcc2 on up to 305 million grid points xing et al 2010 new dynamic overset approaches martin et al 2016 have allowed the calculation of similarly large cases for the fully appended geometry of r v athena including a rotating discretized propeller with excellent scalability of the overset technology simulations specific capabilities related to underwater vehicle self propulsion include lower fidelity propeller models using a prescribed hough and ordway load distribution or a more complex approach coupling rex with the vortex lattice mit code puf 14 martin et al 2015 mofidi et al 2018 rex has a built in parallel architecture that facilitates access to variables and moving body components control surfaces rotating propellers to implement open loop and feedback controllers to compose autopilots as the one described in 2 further details of the code modeling numerical approaches and capabilities can be found in the provided references and literature therein variable mass and center of gravity location were implemented in the 6dof solver specifically to handle the depth and pitch controllers in eqs 5 and 6 in particular as the center of gravity changes so does the center of rotation of the boat requiring additional data transfer to suggar which needs this information to perform relative rotations between grids to compute the domain connectivity 4 geometry conditions and grids the joubert hull form is becoming an international benchmark for underwater vehicle hydrodynamics marin in the netherlands overpelt et al 2015 modified the original joubert geometry to add x tail planes and sail planes and replaced the sail by a square shape with rounded top based on naca 0022 hydrofoil see fig 2 the location and size of the sail and planes were optimized for maneuvering stability purposes in the model scale version used for free running experiments a 6 bladed stock propeller marin 7371r is employed for propulsion main particulars of joubert bb2 are shown in table 1 the simulation conditions are listed in table 2 the depth d 0 is measured from the top of the sail to the calm water surface such that positive d 0 is used for submerged sail and negative for exposed sail any condition with d 0 5 6 m has the deck exposed conditions with submergence of up to 40 m in full scale are considered with an emphasis on situations with the vehicle near the surface even keel cases were setup and computed allowing only forward motion with the speed controller used to achieve self propulsion as discussed in 2 controlled cases were computed in 6dof with the autopilot enabled at 5 selected depths d 0 6 9 3 9 2 5 4 and 23 69 m simulations were performed in calm water ss0 and regular head waves with properties similar to a nominal sea state 5 ss5 for all depths while at d 0 4 m submergence also head waves in nominal sea states 2 3 4 6 and 7 were studied note that the term sea state applies strictly only to irregular waves but is used in this paper to name the regular waves to easily identify the cases under study and the magnitudes of the waves regular waves for these nominal sea states are defined as having the same mean height and most probable wave period as waves in the north atlantic lewis 1989 detailed wave properties are listed in table 3 regular waves are imposed from exact solutions of surface elevation and velocity for linear waves as described in carrica et al 2007a but diffusion some wave reflection and deviations from linear wave solutions cause some changes in wave height and wavelength as the waves evolve into the domain the differences between nominal and actual wavelength at the location of the submarine cg were less than 0 4 for ss5 and lower reaching 6 for ss7 wave height errors were limited to 3 for larger waves and increased to about 7 for ss2 and ss3 as the waves are smaller and thus the grid becomes coarser to resolve them more accurately grid generation for a structured code like rex is challenging and requires considerable time but should be less of an issue in unstructured solvers used more commonly these days the overset grid system shown in fig 3 and detailed in table 4 is designed to allow 6dof computations near the surface and for self propulsion and autopilot control grids are organized in a parent children hierarchy assigned to bodies that follow either rigid body equations of motion or commands of a controller the grid system can be categorized into three sub groups hull of the boat moving appendages and background and refinements the boat body is the parent and comprises all grids moving with the submersible subject to the rigid body equations listed in carrica et al 2007b children bodies are also part of the parent but add their own motion around a fixed axis of rotation the propeller obeys the speed controller while sail and tail planes follow commands from the autopilot all independently the free surface refinement and background grids are restricted from heave roll or pitch motions thus always following the boat in the horizontal plane of the free surface thus maintaining grid quality to resolve incoming waves and boat induced waves the background grid was designed according to ittc recommendations ittc 2014 to handle waves and is coarsened half a boat length behind the boat to reduce wave reflections from the exit four systematically refined grids were generated starting with the fine grid and coarsening by a factor of 2 in each direction for each coarsening step the fine grid dimensions are shown in table 4 while medium coarse and very coarse grids total 48 6 17 4 and 6 21 million grid points respectively far field boundary conditions are imposed in the background grid and are defined as follows a regular waves at the inlet one boat length upstream as discussed in carrica et al 2007a b zero derivative of all quantities in the side bottom and exit boundaries also one boat length away from the boat with the exception of the exit conditions for velocity which are set to no traction zero second derivatives no boundary conditions are needed above the free surface in the air for a single phase level set approach as used by rex the dimensionless time step is set to 0 0003 which corresponds 1 9 degrees of propeller rotation in the worst case but more typically 1 65 per time step this short time step is a limiting factor in these simulations as 3333 time steps are required to advance one boat length at the reference speed typical submarine maneuvers with a body force propeller model can run successfully with time steps one order of magnitude larger martin et al 2015 all simulations in this paper were performed with the sst based delayed des turbulence model xing et al 2012 5 results and discussion in this section we present results initially for even keel conditions and then for the free running vehicle in all cases results are shown in dimensionless form unless explicitly showing dimensions in full scale though computations were performed at model scale at 1 2 m s 2 33 knots corresponding to 5 14 m s 10 knots in full scale 5 1 grid study though very satisfactory comparisons with experiments in self propulsion at depth and near the surface in calm water for joubert bb2 were reported in carrica et al 2016a no data is available for any other conditions and thus simulations in this paper are entirely blind to gain confidence in the simulations presented herein a limited grid convergence study was performed using the set of four grids described in 4 while a complete verification study would be desirable the cost was deemed too high and is therefore not performed in this paper instead only one even keel condition with d 0 0 702 m was chosen and run for all grids first a self propulsion run was performed with the coarse grid yielding a dimensionless propeller rotational speed of 16 3 r p s though self propulsion computations could have been performed for all grids we chose to maintain the r p s obtained for the coarse grids and impose constant speed to evaluate the difference in thrust and vertical and side propeller forces for each grid as shown in fig 4 results indicate that all propeller forces tend to converge in grid though the lateral force shows oscillatory convergence as shown on the left panel in fig 4 thrust fluctuations shown in fig 4 increase as the refinement increases as the free surface and vortical structures are better resolved and present more transient response the very coarse grid results are within 5 and 11 of the fine grid the coarse grid results are between 3 and 4 lower than the fine grid solutions and the medium grid are less than 2 off compared to the fine grid solutions the grid convergence of the boat vertical hydrodynamic force and the pitching moment are also shown in fig 4 in the right panel exhibiting oscillatory convergence and again differences between the coarse and the fine grid are limited to about 5 the cpu costs for the very coarse coarse and medium grids are approximately 22 5 8 and 2 8 times lower than the fine grid considering cost and resolution the coarse grid was selected for the simulations reported in the rest of the paper notice that the coarse grid still has a respectable 17 4 million grid points 5 2 even keel simulations were performed at even keel with the boat restricted to only forward motion with the objective of studying the forces and moments caused by the presence of the free surface and waves these forces are primarily responsible for free surface induced motions and environment inputs to the control algorithm two sets of cases were simulated simulations varying the sail top depth from 6 9 m negative depth indicates that the sail top is 6 9 m above the calm water line to 40 m sail top 40 m below the calm water line were performed for calm water sea state 0 abbreviated ss0 and ss5 to quantify depth influence on free surface effects the second set of cases is designed to study the influence of waves on the hydrodynamics of the vessel simulations were performed by imposing regular head waves representing sea states from 0 to 7 at sail top depth of d 0 4 0 m as discussed in 4 5 2 1 effects of depth self propulsion is achieved as discussed in 2 for each depth in calm water only and the obtained propeller rps was used for the simulations with waves the constant forward velocity of 10 knots is imposed for all cases and since the mean thrust and resistance in waves differ from the calm water simulations the vehicle does not reach a perfect balance of axial forces fig 5 shows the results of propeller r p s as a function of depth in calm water with depth expressed as s i g n d 0 d 0 l 0 that results in fairly evenly distributed points in the plots the propeller r p s is maximum for a sail top emergence of 6 9 m d 0 6 9 m where the static waterline is barely below the deck for d 0 3 9 m the r p s decreases then increases for d 0 0 9 m showing monotonically decreasing r p s with depth for all submerged cases the decrease in r p s from the trend at d 0 3 9 m is due to a decrease in resistance as the sail and sail planes are out of the water but the hull submerged see right panel in fig 5 showing the decomposition of forces for hull sail propeller thrust and sail and upper and lower tail planes even though the sail planes exert zero force as they go out of the water thrust and hull sail resistance dominate the force balance we speculate that the decrease in resistance at d 0 3 9 m is caused by a favorable depth of the hull that reduces wave making resistance and a decrease in sail resistance as half of it is out of the water but more analysis is needed to prove this hypothesis in the presence of waves wave induced velocities will interact with the boat induced flow the velocities can be expressed for linear small amplitude waves as 11 u 2 π a 0 t 0 e 2 π z λ 0 sin 2 π t t 0 2 π x λ 0 12 w 2 π a 0 t 0 e 2 π z λ 0 cos 2 π t t 0 2 π x λ 0 notice in eqs 11 and 12 that the streamwise and vertical amplitudes for ss7 with the parameters shown in table 3 are 30 5 of the boat forward speed at z 0 and 25 5 at 10 m submergence for ss5 these values decrease to 20 9 at the surface and 13 6 10 m below the surface still considerably large fluctuations thrust and torque coefficients depicted in fig 6 are consistent with r p s behavior showing a monotonic decrease as depth increases with the exception noted at d 0 3 9 m this trends are observed both for calm water and ss5 waves interestingly the mean thrust and torque coefficients in waves are lower than the calm water cases at the same depth especially for the cases near the surface and with emergence this can be interpreted as an increase of the average local velocity near the propeller resulting from the combined effect of the waves and the towed vessel hydrodynamics in reality other effects such as flow non uniformity are also important and possibly dominant and can be illustrated using the propeller performance curve k t j and k q j where j v a n d p is the advance coefficient and v a is the advance velocity over the wave cycle large variations of v a occur and instantaneously thrust and torque can be larger or smaller than the calm water value faltinsen et al 1980 analyzed the effective thrust coefficient for ships in waves attributing the decrease in thrust to the larger induced velocity by the propeller when in proximity to the surface which happens periodically in the presence of waves and results in a decrease in average thrust coefficient as the propeller approaches the surface or wave amplitudes increase this model also applies to our results it is important to remember that the simulation is conducted towed and the propeller thrust is not necessarily equivalent to the resistance and whether the thrust generated by the propeller rotating at a constant speed is larger or smaller than the calm water case is only a reflection of the flow conditions at the disk rather than a dynamic response of the system the first harmonics of the thrust and torque coefficients are shown in the right panel in fig 6 wave induced thrust and torque fluctuations are considerable for the two conditions with the propeller very close to the surface notice that for submerged cases the first harmonic of the thrust and torque coefficients peak for d 0 4 0 m and then decrease with depth to about 5 of their average value the vertical force shown in the top left panel of fig 7 is positive for all submerged conditions even for the deepest submergence which shows f z 0 025 w 0 with w 0 the weight of the boat this hydrodynamic force shows that with no control action on the planes or in the ballast tanks the vehicle would slowly rise the peak of suction force in submergence occurs for d 0 2 5 m but higher values occur when portions of the boat are exposed the zeroth harmonic of the suction force increases in the presence of waves we speculate that this phenomenon occurs because of two reasons that break the symmetry of the problem 1 the distortion of the free surface is different when the free surface elevation is decreasing or increasing resulting in different downward and upward forces and 2 the hull is not symmetric due to the presence of the deck causing different virtual mass and drag forces as the wave induced velocity field interacts with the hull in emerged conditions the vertical force is positive for d 0 3 9 m but becomes negative for d 0 6 9 m as the deck is exposed and water runs up the nose creating a net force down the top right panel in fig 7 displays the pitching moment with respect to the center of gravity as a function of depth as is the case with the vertical force the pitching moment at depth is not zero without control surface action or trim tank correction as forces on the sail and hull produce a pitch up moment in prototype scale of m y 0 400 k n m or about 0 013 of l 0 w 0 which can be interpreted as the effect of shifting the center of gravity by this percentage of the total length the figure shows that as the boat approaches the surface it quickly develops a more negative pitching moment sending the boat nose down this is mainly due to the tail suction described by tolliver 1996 the effect increases in the presence of waves sailing with the deck exposed results in massive bow down moment as the surface runs up the nose the first harmonic amplitudes of the vertical force and pitching moment for the cases in ss5 waves are shown in the bottom panel in fig 7 both decrease monotonically with sail depth except for the case of highest emergence the first harmonic amplitude of the vertical force at d 0 0 m is very large at f z 6 4 w 0 or approximately 282 tons in full scale and still very large at submergence d 0 15 m at 146 tons this level of vertical forces cannot be reasonably compensated by a control system and will thus cause vertical boat motions the decay trend with depth is consistent with the virtual mass force obtained from eq 12 considering only the vertical velocity fluctuations which amplitude can be approximated as 13 f z 1 v m c v m w 0 2 π t 0 2 a 0 e 2 π z λ 0 f c f w 0 e 2 π z λ 0 where f is a function that accounts for the different velocities at axial locations along the vehicle and c v m is the virtual mass coefficient at each axial location these and the other constants in eq 12 can be collapsed into a single constant c f to fit the vertical force resulting in an exponential decay a similar treatment yields a constant c m for the pitching moment the exponential decay trend lines are added in red to fig 7 showing that the vertical force and pitching moment fluctuations effectively decay exponentially with depth with the same rate as the wave induced velocities decay it is interesting to note that an upper limit for the drag force assuming the boat is a cylinder yields a vertical force f z 1 v m 0 5 c d w 2 l 0 b 20 tons at d 0 0 m assuming c d 0 5 and the maximum vertical velocity in eq 12 2 π a 0 t 0 this number is only 7 of the observed amplitude of the vertical force fluctuations and would decay with depth as e 4 π z λ 0 which does not fit the data supporting the view that virtual mass force dominates the problem the wake of the propeller at x l 0 1 05 presented in fig 8 for depths d 0 6 9 m 3 9 m 2 5 m and 4 0 m shows that for the cases with the sail exposed d 0 6 9 m 3 9 m the propeller is close enough to the surface for the wake to be strongly affected by the waves creating a highly fluctuating inflow to the propeller due to the strong wave induced streamwise velocity but also modifying the boundary layer of the hull and wakes of sail and appendages the submerged cases at d 0 2 5 m and 4 0 m even though very close to the surface have the shaft deep enough that the propeller inflow is mainly affected by the streamwise wave induced velocity 5 2 2 effects of wave amplitude sea states from 2 to 7 were simulated to study effect of wave amplitude in self propulsion for a single depth of d 0 4 0 m this depth was selected as a representative value of operation very close to the surface for which the sail structure remains marginally wet during the computation for all wave amplitudes the wavelength also varies with sea state but amplitude is the dominant parameter and results are analyzed with respect to this variable only fig 9 shows the mean thrust and torque coefficients and the first harmonic amplitude of the thrust and torque normalized with their means as a function of wave amplitude with each point representing waves of ss2 to ss7 and calm water added at zero amplitude both thrust and torque decrease as the wave amplitude increases consistent with the observations for ss5 discussed in 5 2 1 the thrust and torque fluctuations are strongly correlated with the wave encounter frequency with the first harmonic vastly dominating the response the amplitude of the fluctuations is moderate for ss4 limited to 10 of the thrust or torque and less than 3 for ss3 and below but can reach extreme vales in ss7 over 50 of the mean thrust and 30 of the mean torque fig 10 shows the vertical force and pitching moment as a function of the wave amplitude the vertical force increases with wave amplitude consistent with the results shown in fig 7 reaching 0 21 of the weight in suction the first harmonic amplitude increases monotonically with wave amplitude exceeding 10 of the weight for ss7 the right panel in fig 10 shows that the zeroth harmonic of the pitching moment remains negative respect to the deep condition decreasing for sea states lower than 3 then increasing up to ss6 to decrease dramatically for ss7 the first harmonic amplitude of the pitching moment increases up to ss5 and then decreases for higher amplitude waves the trend of the virtual mass with wave amplitude and length from eq 13 is given by c 2 2 π t 0 2 a 0 e 2 π z λ 0 with c 2 accounting for all constants and factors in the equations as fig 10 shows this trend matches extremely well the trends observed in the simulations for pitching moments but not for vertical forces fig 11 shows vortical structures as isosurfaces of the second invariant of the velocity tensor q 50 as well as the free surface for the four quarter phases of one wave encounter period and for waves corresponding to ss5 and ss7 note that the q criterion shows spurious vortical structures near but at different distances from the hull giving it the appearance of a painted hull with different colors depending on the distance to the solid surfaces these artifacts should be ignored and attention focused on separated structures the zero phase ε 0 o is defined as the instant in which the undisturbed incoming wave crest is located at the sail top position in ss7 the free surface lightly touches the sail but it mainly affects the flow with the induced velocities shown in eqs 11 and 12 in addition to the propeller tip and hub vortices the strongest structures present in the flow are tip vortices generated periodically in the sail and tail planes as the wave induced velocity changes the angles of attack the necklace vortex on the sail hull and the tail plane roots hull junctures and at the tip of the sail all these vortices are transported by the flow and many of them are periodically ingested by the propeller cross sections downstream of the sail x l 0 0 67 and upstream of the propeller x l 0 0 95 for sail top depth d 0 4 0 m in calm water and ss5 and ss7 waves colored with dimensionless streamwise velocity are shown in fig 12 the change in far field wave induced streamwise velocity as the wave passes can be clearly observed as well as the slight decay of velocity with depth the vertical velocity fluctuations produce a thickening of the boundary layer on the bottom of the hull at ε 90 and 180 clearly observable in ss7 at x l 0 0 67 and considerable signature of the sail and sail plane vortices these result in considerable fluctuations in the inflow to the propeller also affected by the wake and tip vortices of the tail planes 5 2 3 propeller performance the propeller performance was studied for the case operating at depth d 0 40 m for emerged condition with the propeller closest to the surface d 0 6 9 m and submerged near the surface d 0 4 m for ss0 and ss5 performance curves for propeller marin 7371r previously computed by pontarelli et al 2017 were used as reference for the analysis fig 13 shows propeller performance curves obtained using the thrust identity method ittc 2008 to obtain the advance coefficient from equating the open water propeller thrust with the propeller thrust obtained from the cfd computations then the torque coefficient and propeller efficiency can be obtained at every time step of the simulation since the inflow to the propeller is transient and not uniform due to the wake of the appendages turbulence and the wave induced velocity fluctuations see figs 8 and 12 the procedure results in a cloud of points in torque and efficiency in calm water the propeller operates close to the maximum efficiency point at depth and as resistance and load increase near the surface the efficiency decreases notice that the propeller installed in the boat exhibits a maximum efficiency of approximately 60 below the maximum open water efficiency of approximately 70 the fluctuations in advance coefficient increase as the propeller approaches the free surface resulting in larger torque and efficiency variations in waves the inflow velocity fluctuations become considerably more marked decreasing quickly at deeper depths when the propeller is closest to the free surface the torque coefficient shows variations of 30 see also fig 6 and the efficiency shows a much wider variation for the same advance coefficient than in calm water notice also that the average efficiency decreases slightly when operating in waves as the propeller experiences larger inflow non uniformities that cause strong transient changes in angles of attack in the blades and different operational points at different radii the spectral response of the thrust coefficient is shown in fig 14 a clear peak at the wave encounter frequency is observed for the cases in waves along with a second harmonic peak the case at d 0 6 9 m exhibits strong broadband noise caused by interaction of the propeller with vortices induced by hull free surface interaction decreasing with frequency up to a clear peak at the blade passage frequency or six times the rotational frequency shown in fig 5 the width of the peak is related to the interaction of the blades with passing vortices which changes the period between thrust peaks and troughs a second harmonic can be observed caused by the interaction of the blades with the wakes of the stern planes which occurs every 30 degrees of propeller rotation a fourth weaker but clear harmonic is also present generated as one blade passes the wake of the sail and the next passes the starboard top stern plane after 15 degrees of rotation as the propeller rotates slower this pattern is repeated at higher depths with considerably less broadband noise and with much lower low frequency content for the deep case with no waves 5 3 controlled self propulsion controlled self propulsion simulations were performed for calm water and nominal ss5 regular head waves at sail top depths d 0 6 9 3 9 2 5 4 and 23 69 m the control algorithm described in 2 attempts to maintain the target depth and speed while zeroing pitch sway and yaw the vertical and ballast tank controllers are deactivated for the cases with the sail exposed as enough buoyancy is present to keep the boat floating but the trim tanks compensate for tail suction for the submerged cases the ballast tanks are used to compensate for surface suction but the trim tanks are deactivated leaving the vertical control able to mostly compensate for pitch 5 3 1 controller commands and motions fig 15 shows the commands for change in mass for the submerged cases and change in longitudinal location of the center of gravity for the cases with the sail exposed for the submerged cases the mass is compensated through the ballast tanks to help balance the vertical force and reduce deflection of the control planes an operation unnecessary in emerged mode since buoyancy is positive electronic annex i shows a video of the original bb2 controller presented by overpelt et al 2015 performing in self propulsion in ss5 waves at d 0 2 5 m and 10 knots the pd controller couples depth and pitch control into a single vertical command thus as the tail suction decreases depth and pitches the boat bow down the controller has a competing command to send the bow down to increase depth with a bow up command to increase pitch this depth pitch coupling prevents properly achieving both controller targets in addition the lack of an integral term results in permanent errors in pitch and depth an improvement to this controller for operation near the surface was discussed in 2 and a video is shown in electronic annex ii in this case the ballast tanks are used to independently control depth by compensating the suction force with additional weight this decouples depth and pitch commands and together with the addition of an integral component in the controller results in zero error on the mean pitch and depth fig 15 shows the change in mass for the submerged cases and the change in longitudinal location of the center of gravity for the cases with the sail exposed as expected the mass correction decreases with depth as the influence of the free surface decreases with a maximum of approximately 0 3 of the displacement 13 tons in full scale the correction is higher in waves and the decay in correction with depth is faster as wave influence also decays with depth these mass increases mostly compensate for the suction forces shown in figs 7 and 10 but also for vertical forces resulting from the geometry asymmetries caused by the sail sail planes and deck the cases with the sail exposed require trim tank correction of the longitudinal location of the center of gravity to prevent excessive bow down attitude this occurs because of the strong tail suction with the hull very close to the free surface while the vertical correction is hampered by loss of the sail planes out of the water and loss of authority by the tail planes operating too close to the surface resulting in inability to compensate for the large pitching down moments shown in fig 7 an example of the response without trim tank correction and with vertical control disabled is shown in electronic annex iii which shows a video of joubert bb2 operating initially at d 0 3 9 m tail suction is strong and sends the bow down which then produces a bow down pitching moment the boat then tends to sink to depth but tail suction pitch down moment and sail buoyancy eventually reach an equilibrium point with a considerable bow down attitude an attempt to use the tail planes to control depth results in unstable porpoising as the bow down portion of the period produces a large bow down moment that requires large tail deflection to compensate thus overshooting as the boat attitude recovers the process is shown in the video in electronic annex iv the best solution found to control the cases with sail exposed is to disable the vertical controller and use the trim tanks to compensate for the tail suction this is shown in electronic annex v for d 0 3 9 m in calm water and in electronic annex vi in sea state 5 waves this control strategy was used for all simulations at both emerged depths with and without waves the center of gravity is displaced to stern within 10 of δ x c g 0 0027 l 0 see fig 15 with more correction needed in waves for d 0 6 9 m and more in calm water for d 0 3 9 m for trim tanks located at x c g 0 4 l 0 a displacement in center of gravity δ x c g 0 0027 l 0 requires transferring almost 15 tons of water from the bow to the stern tanks it is interesting that the correction is larger for d 0 3 9 m than for d 0 6 9 m while even keel runs showed a much stronger bow down moment at d 0 6 9 m see fig 7 this is a consequence of the response to the heave force also shown in fig 7 as discussed below which essentially positions the boat at the same distance from the free surface the horizontal and vertical commands are shown in fig 16 the first harmonic amplitude of the horizontal command maintains heading and prevents sway and stays below 0 8 for all depths with less response in calm water at depth the correction needed is approximately 0 6 to starboard compensating a small turning moment to port created by the propeller side force the horizontal command shifts to port when very near the surface as the propeller blades are less efficient on top near the surface and the side force reverses with the effect slightly amplified by the presence of waves the first harmonic amplitude in waves is limited to 0 15 showing again that head waves affect little the turning moments or side forces vertical commands used only for the submerged cases are larger than the horizontal commands at depth the vertical command to the control surfaces compensates the positive pitching moments shown in fig 7 while closer to the surface the correction needed decreases but is always higher in waves as expected the first harmonic amplitudes are highest near the surface reaching almost 7 deflection and decrease quickly with depth the zeroth harmonic amplitudes of the vertical motions shown in fig 17 are small for the submerged cases as depth is well controlled by the ballast tank controller which fluctuates slowly to maintain the mean depth emerged cases are subject to surface suction that is compensated by buoyancy of the sail which is relatively small as a result mean equilibrium positions shift considerably in the vertical direction at d 0 3 9 m the suction dominates and the hull translates up approximately 1 2 m resulting in an effective depth d 5 1 m at d 0 6 9 m the deck is slightly exposed and the vertical force reverses see fig 7 causing sinkage of about 1 5 m leaving the boat at d 5 4 m slightly higher than the case with d 0 3 9 m and with the deck slightly submerged waves affect little the zeroth harmonic amplitude the first harmonic amplitude of the vertical motions also shown in fig 17 increases as the boat operates closer to the surface as expected with amplitude approaching 40 of the wave amplitude at the surface and still about 10 amplitude at d 0 23 69 m notice that the amplitude of the vertical motion of a passive particle which decays as e 2 π z λ 0 is 34 of the wave amplitude at d 0 23 69 m implying that the depth controller is effectively reducing vertical motions in a single screw boat the roll righting moment has to balance the propeller torque fig 17 shows that the mean roll angle increases as the boat approaches the surface this is due to an increase in torque as the boat approaches the surface and for the cases with the sail exposed by the lower center of buoyancy as partial emergence occurs the maximum mean roll angle is moderate at 1 2 and the presence of waves has almost no effect the first harmonic amplitude of the roll motions in waves is also very small at a maximum of about 0 24 the zeroth harmonic of the pitch motions is essentially zero for all cases in calm water or waves as the controller has integral terms that zero the mean pitch and thus are not shown in fig 17 the same occurs with the boat speed the first harmonic amplitude of pitch in waves follows a similar trend as the vertical motions reaching about 40 of the wave slope and dropping to approximately 10 at depth the speed controller cannot maintain a constant 10 knot velocity as surge forces cannot be overcome by the propeller with reasonable thrust and torque fluctuations of 7 5 amplitude are observed for the emerged cases that decrease to 1 5 at d 0 23 69 m note that pitch and heave first harmonic amplitudes in waves are very similar but slightly milder at d 0 6 9 m than at d 0 3 9 m 5 3 2 propeller performance and flow field fig 18 shows the propeller response in calm water and ss5 waves the deepest controlled case exhibits an increase of 1 5 in propeller r p s with respect to the even keel case shown in fig 5 due to additional resistance caused by the deflected appendages submerged near the surface this effect is amplified with the r p s increasing about 3 with respect to the even keel results the emerged cases exhibit wider variations with respect to the even keel cases as the boat accommodates in sinkage and trim to the presence of the free surface without vertical control this results in an increase in r p s at d 0 3 9 m and a decrease at d 0 6 9 m the presence of waves requires higher r p s to overcome the added resistance as expected with the notable exception of d 0 6 9 m possibly due to the higher net buoyancy that reduces the motion effects of waves as shown in fig 17 the first harmonic amplitude of the propeller r p s when operating in waves shown in fig 18 is entirely dependent on the controller used to maintain speed a moderate gain controller as used in this paper results in changes in r p s in the order of 13 of the mean r p s at depth and up to 28 near the surface in an attempt to maintain boat speed this controller is able to maintain speed within 7 5 of the target speed at the surface and 2 at depth the analysis could have been performed at constant r p s corresponding to the calm water values at each depth as done for the even keel conditions but results in stronger fluctuations in velocity and additional feedback with the motion controllers complicating the analysis zeroth and first harmonic amplitudes of thrust and torque coefficients are shown in fig 19 consistent with the propeller r p s the average thrust and torque coefficients peak for d 0 3 9 m and decreases for d 0 6 9 m and also with depth k t and k q are slightly higher than corresponding values in even keel conditions again consistent with the r p s results note that as opposed to the even keel cases the presence of waves consistently increase k t and k q as the propeller r p s increases in waves and thus the advance coefficient decreases increasing load the first harmonic amplitudes of thrust and torque follow similar trends observed in even keel conditions but the magnitudes are considerably larger as the controller attempts to maintain speed in a fluctuating inflow fig 20 shows the free surface and vortical structures as isosurfaces of q 50 for the four quarter phases of one wave encounter period for depths d 0 3 9 m and 4 0 m in ss5 the interaction of the hull with the wave induced pressure field causes adverse and favorable pressure gradients that result in separation in the deck for the case with the exposed sail in addition vertical wave velocities cause cross flow that results in generation of streamwise vortices as the waves move water up and down across the hull these strong primary hull free surface interaction mechanisms and consequent secondary flows result in massive generation of vortical structures that are transported downstream into the propeller this also results in large disturbances to the top half of the nominal wake causing a broadband frequency response from the propeller and widening considerably the main peak at the blade passage frequency as discussed later in reference to figs 24 and 25 in addition the top tail planes penetrate the surface reducing their effectiveness results for d 0 4 0 m in fig 20 can be compared to the even keel condition shown in fig 11 the vortical structures are in general weaker and more streamlined as the boat accommodates to some extent to the wave contour the wake of the propeller tends to be fairly well aligned to the boat as opposed to the even keel case where the wake was strongly deflected by the wave induced vertical velocity fig 21 provides a direct comparison of controlled vs even keel conditions for the streamwise velocity at the centerplane even keel constant rotational speed conditions effectively decouple the dynamics of the system from the varying flow conditions affecting the propeller performance this is particularly evident at ε 180 for which the propeller wake follows vertically the wave velocity profile when controlled but opposes its direction for even keel conditions as a result of changes to the ingested hull boundary layer and wake at this condition due to the interaction of the wave and the hull which has a slightly downward attitude when controlled i e it follows the wave the flow into the propeller is more uniform and slower when controlled resulting in higher propeller load while for even keel conditions the flow is highly non uniform and overall containing higher speed regions at the top instantaneous views of cross sections downstream of the sail x l 0 0 67 and upstream of the propeller x l 0 0 95 for sail top depths d 0 3 9 m and 4 0 m in calm water and ss5 colored with dimensionless streamwise velocity are shown in fig 22 these cross sections are in the earth system of coordinates following the ship resulting in vertical planes not necessarily perpendicular to the boat shaft axis the case for d 0 4 0 m can be compared with the results in even keel condition shown in fig 12 differences between free running and even keel results at this depth are small with variations in the strength of the vortices generated by the sail and sail planes as they are deflected in free running as well as less evidence of boundary layer thickness fluctuations caused by cross flow for the controlled case as it allows some motions following the wave induced velocities the case at d 0 3 9 m on the other hand exhibits effects of the strong hull free surface interaction discussed in reference to fig 20 in calm water the unsteady vortices produce a wandering wake that is clearly visible at x l 0 0 95 with velocity defect exceeding 50 of the forward velocity in the case with ss5 waves the streamwise vortices discussed previously leave a signature in the boundary layer clearly visible at ε 0 and 180 for x l 0 0 67 the velocity fluctuations in the flow upstream of the propeller at x l 0 0 95 show a low velocity wake in the top quarter of the propeller disk reacting with the wave encounter frequency the propeller inflow is almost uniform at ε 90 resulting in the least propeller load fluctuations the local advance coefficient is maximum at ε 180 resulting in minimum average propeller load while the average propeller load and load fluctuations peak at ε 270 fig 23 shows cross sections at downstream of the propeller at x l 0 1 05 for d 0 6 9 m 3 9 m 2 5 m and 4 0 m and the quarter phases ε 0 90 180 and 270 in ss5 colored with streamwise velocity notice that solutions for d 0 6 9 m and 3 9 m are closer to each other than in the even keel results shown in fig 8 as in free running these two cases stabilize at approximately similar mean depths it is also evident that the propeller thrust varies more strongly with the wave phase in the controlled cases as the speed controller attempts to maintain speed at 10 knots in the emerged cases d 0 6 9 and 3 9 m the wake of the top tail planes is weaker than for the even keel simulations the propeller wake exhibits azimuthal non uniformity as the incoming wake into the propeller shown in fig 23 is strongly non axisymmetric the results for the submerged cases are more similar to those in even keel conditions though the propeller load varies strongly as the propeller rotational speed is controlled to maintain the vehicle speed the spectral response of the thrust coefficient is shown in fig 24 for depths d 0 3 9 m and 4 0 m while trends are qualitatively similar to those shown in fig 14 for even keel conditions the widening of the blade passage frequency response is clear mainly obeying to the fluctuations on propeller rotational speed caused by the controller at d 0 4 0 m for d 0 3 9 m the blade passage frequency peak widens considerably more and its amplitude decreases due to inflow of large scale turbulence structures produced as a result of interaction between the free surface and the deck as discussed in reference to figs 21 23 fluctuations in propeller thrust due to variations in boat speed and propeller r p s are reflected in the performance curves shown in fig 25 for self propulsion in calm water in emergence d 0 3 9 m the propeller operates at a higher load range than for the even keel case shown in fig 13 for d 0 6 9 m as the strong turbulence caused by interaction with the free surface affects the propeller inflow and therefore its instantaneous advance coefficient at d 0 4 0 m the even keel and controlled results are similar with a slightly wider range of loads for the controlled case in waves the propeller operating point fluctuates from highly loaded with advance coefficient reaching j 0 25 for d 0 3 9 m and j 0 37 for d 0 4 0 m at wave phase ε 270 the minimum thrust condition the propeller acts as a brake for the emerged condition and produces almost zero thrust for d 0 4 0 m as reflected by the low propeller wake velocity shown in fig 23 for ε 270 6 conclusions a cfd study of self propulsion near the free surface in calm water and head waves was presented computations were performed in even keel and constant depth conditions with no actuation on the control surfaces and also in controlled mode in which the vehicle is free in 6dof and the control surfaces ballast and trim tanks are actuated to maintain course depth and zero pitch the effects of depth and regular waves for nominal sea states from 2 to 7 were analyzed even keel runs in calm water reveal an expected increase in propeller rotational speed and thrust as the boat gets closer to the free surface the thrust and torque coefficients also increase slightly with proximity to the surface indicating an increase in propeller load when operating near the free surface the mean thrust and torque coefficients are slightly lower in waves than in calm water due to higher inflow velocities into the propeller plane the first harmonic amplitudes of the thrust and torque coefficients in waves also show an increase as the boat approaches the free surface though a slight decrease occurs very near the surface tail suction causes upward vertical force and bow down pitching moment increasing as the boat approaches the surface with very large values for the cases with the sail exposed the vertical forces reverses dramatically as the nose approaches the surface d 0 6 9 m as pressure forces on the nose overcome vanishing tail suction as the deck is exposed in waves all these effects are amplified with changes with depth of the first harmonic amplitudes of vertical force and pitching moment responding well to a virtual mass dominated model vertical forces and pitching moments and their fluctuations are very large when the vehicle is approaching the free surface complicating control of the vehicle simulations in even keel for various wave amplitudes at d 0 4 0 m show that the mean thrust and torque coefficients decrease with wave amplitude while the first harmonic amplitude of the thrust fluctuations increase roughly linearly with wave amplitude the same effect is observed for vertical forces the first harmonic amplitude of the pitching moment as a function of wave amplitude also follows well the trend predicted by a virtual mass dominated process free running simulations with controllers expose the difficulty of controlling vertical motions and pitch when subject to the large forces and moments created by interaction with the free surface ballast tank mass corrections of 0 2 0 3 of the displacement are needed to balance vertical suction forces when submerged near the surface while trim tank actuation for longitudinal center of gravity displacements of over 0 25 of the boat length are needed in the emerged cases to maintain the boat horizontal in waves the amplitude of displacement of the sail and tail planes can reach 7 for the vertical control the depth and pitch first harmonic amplitudes are limited to z 1 a 0 4 and θ 1 k a 0 4 when very close to the surface demonstrating that considerable pitch and heave oscillations are still present even under depth and pitch control operation this is expected given the very large forces and moments induced by the waves near the free surface changes in propulsion characteristics between even keel and controlled conditions show the importance of considering the coupling between the boat dynamics and the ambient flow when operating in waves operation in controlled mode in waves results in propeller fluctuations in r p s of about 25 when very close to the surface which results in first harmonic amplitude of the thrust fluctuations of up to 90 these fluctuations in propeller rotational speed and large inflow velocity oscillations caused by the wave induced velocity and the wake of the boat result in a wide frequency response of the propeller thrust with a peak centered at the blade passage frequency the local advance coefficient can experience considerable fluctuations ranging from high propeller loads to brake operation the turbulence induced fluctuations into the propeller plane are very large for the cases with the sail exposed where hull free surface interaction result in massive flow separation that reaches the propeller future work will focus on free surface effects on maneuvers with and without waves acknowledgements this work was supported the us office of naval research under grant n00014 17 1 2293 with dr ki han kim as program manager appendix a supplementary data the following are the supplementary data to this article electronicannexi electronicannexi electronicannexii electronicannexii electronicannexiii electronicannexiii electronicannexvi electronicannexvi electronicannexv electronicannexv electronicannexvi electronicannexvi appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 082 
22758,the resistance of a container ship at three different froude numbers and drafts is predicted using rans simulations demonstrating that the optimum trim angle varies with ship speed and draft first the zero trim condition results were validated with experimental data and later trim optimization was performed it is concluded that optimum trim condition for container ships vary with forward speed and draft condition and the variation does not appear to follow any particular trend trim optimization at different speeds and drafts can be a convenient and effective way for vessels to improve efficiency reduce fuel consumption and limit harmful emissions operational optimization including trim is the most practical way of improvement of efficient and environmental friendliness for existing vessels and in that way complement the choices during design so as to fulfil environmental concerns and related regulations keywords trim optimization kcs rans ship draft ship speed trim angle effect 1 introduction it is estimated that almost 90 of global trade is mobilized by shipping in the process of carrying such an immense amount of goods ships produce roughly 3 of global co2 emissions 14 15 nox emissions and 16 of sox emissions sherbaz and duan 2014 increasing environmental concerns and adoption of different emission related regulations have motivated both shipbuilders and owners to opt for more efficient and environment friendly vessels as a result optimization of hull forms and proper power prediction have been receiving more attention however for existing ships design related modifications are not feasible thus for improving their efficiency dependency is more on operational improvements like improvement in voyage execution reduction of auxiliary power consumption weather routing optimized hull and propeller polishing schedule slow steaming and trim optimization some of these aspects have been discussed by prpic oršic et al 2016 vettor and guedes soares 2016 and papanikolaou et al 2016 trim optimization is a relatively new concept recommended by the international maritime organization which requires no ship structural modification and can be attained simply by ballast water management and load distribution ship trim optimization principles are based on the fact that ships experience different resistance through water for the same speed and draft depending on their trim thus trim optimization simply advocates the selection of minimum resistance condition for that particular voyage condition it is well known from hydrodynamic principles that the trim of a vessel can significantly influence its fuel consumption altosole et al 2014 trim optimization study is generally performed based either on model tests or on computational fluid dynamics cfd simulations being among the early researchers to show the trim effect on ship resistance bertram et al 2010 showed that for each draft and speed there is a resistance optimum trim energy saving as a result of trim optimization was also reported by hansen and freund 2010 larsen et al 2012 performed an analysis on resistance and propulsion origin factors and their influence on power requirement and concluded that power gains are mainly dependent on resistance however change in propulsive coefficients also influences the performance hochkirch and mollol 2013 used both cfd and experimental fluid dynamics efd in model scale and full scale for investigating the change in power requirements by trim adjustment and found good agreement between the methods lv et al 2013 used a 3d panel method to investigate the wave making resistance of wigley ship model with different trims and determined optimum trim for low wave making resistance iakovatos et al 2014 performed calm water towing tank tests for six ship models to investigate different trim angle effects on their resistance prediction sherbaz and duan 2014 performed cfd simulation for a container ship model using a hybrid commercial code and determined optimum trim for minimum resistance at a specific ship speed or froude number sun et al 2016 took the study to a further level by applying the trim optimization simulation results obtained using commercial rans code to the real vessel and showed significant fuel savings deng et al 2015 performed experimental and numerical analysis on a trimaran to investigate the effects of shrinkage and trim on resistance apart from efd and cfd studies the data analytics perspective has also been investigated by researchers like coraddu et al 2017 for vessel fuel consumption forecast and trim optimization overall trim optimization is still a relatively new field of study and limited research have been performed on it in the commercial side force technology is one of the consultants in the field of trim optimization they performed trim optimization study on almost 300 vessels including tankers container vessels lng carriers ro ro vessels and ferries with the majority being container vessels their study revealed that fuel savings of up to 15 can be achieved in specific conditions by adjusting trim and up to 2 3 in overall fleet operations reichel et al 2014 sspa also showed that large crude and bulk carriers have the potential to decrease the required driving power for the standard operating range of trims by as much as 10 15 in ballast and 5 8 in full load condition merrit 2009 the global maritime energy efficiency partnerships glomeep estimates that optimization of trim and draft can reduce fuel consumption by 0 5 3 on main engine fuel consumption for most vessel types whereas for ships with partial loads like container or ro ro it can be up to 5 glomeep 2017 in general experimental study for trim optimization might be one of the best ways to understand the optimum operating conditions for a vessel however for that it is essential to have the ship model already built and a proper test facility to replicate the intended sea states furthermore it is difficult to obtain flow field details from experimental work potential flow based methods ignore the viscous effect and are mostly limited to added resistance prediction thus cfd has been primarily used for studying such calm water cases for many years now although cfd models were first introduced back in the 1980s it picked popularity in early 2000 with the development in computational resources especially in the last decade a lot of researchers have proven the efficiency of cfd models for studying such cases since the introduction of the kcs kvlcc and dtmb models in the gothenburg 2000 workshop larsson et al 2003 a significant gain in the accuracy of cfd predictions have been observed over the years larsson et al 2013 tokyo 2015 among recent works el moctar et al 2010 presented simulation results for the three ship models using openfoam and comet zhang 2010 presented rans simulation for kcs model with and without a propeller islam et al 2017 presented kcs simulation results using rans code ship motion jasak et al 2018 performed validation and grid sensitivity studies for full scale self propulsion ship using naval hydro based on openfoam duet al 2018 also used openfoam to simulate ship hydrodynamics and confirmed that the cfd method is extremely suitable for ship dynamics problems thus openfoam was selected for the presented study in this paper this paper discusses the trim analysis outcomes for a container ship model kcs using an open source rans solver openfoam the paper shows how resistance prediction varies for the ship model with changing trim conditions at different ship speeds and drafts the study shows that a significant reduction in encountered resistance can be attained by adjusting trim conditions depending on ship operational conditions and ship response for the same trim angle varies with ship speed and draft conditions 2 method 2 1 simulation solver 2 1 1 mathematical model openfoam open field operation and manipulation is an open source library written in c language following the object oriented paradigm the code is available under gnu general public license gpl it can be used to numerically solve a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it can solve both structured and unstructured polyhedral meshes including h refinement or hanging nodes and contains an extensive range of solvers to perform different types of cfd simulations it has several packages to perform multiphase turbulent flow simulation for floating objects openfoam also allows relatively easy customization and modification of solvers because of its modular design the solver has been elaborately described by jasak 2009 the openfoam solver used to perform ship hydrodynamic simulations for this paper simulates incompressible two phase flow the governing equation is based on continuity and reynolds averaged navier stokes equation the volume of fluid vof method is used to model fluid as one continuum of mixed properties the unstructured collocated finite volume method fvm using gauss theorem together with user defined and implemented solution algorithm and time integration schemes drikakis et al 2007 is used to discretize the governing equations time integration is performed by a semi implicit second order two point backwards differencing scheme pressure velocity coupling is obtained through a simple algorithm ferziger and peric 2002 openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference 2 1 2 turbulence parameters turbulence was modelled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated using the common guidelines labanti et al 2016 as follows 1 i 0 16 r 1 8 2 k m 2 s 2 3 2 u i 2 3 δ m l r 4 l m 0 4 δ 5 c μ 0 09 6 ω 1 s k c μ 1 4 l 7 ν t m 2 s 3 2 u i l 2 1 3 boundary conditions the control volume represented a deep water condition so the two lateral sides and the bottom were symmetry plane type faces no additional information was required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions are as shown in table 1 here fv is fixed value specified by the user opmv is outlet phase mean velocity piov is pressure inlet outlet velocity that applies zero gradient for outflow whilst inflow velocity is the patch face normal component of the internal cell value and mwv is moving wall velocity ffp is fixed flux pressure that adjusts the pressure gradient such that the flux on the boundary is that one specified by the velocity boundary condition zg is zero gradient tp is total pressure calculated as static pressure reference plus the dynamic component due to velocity io is inlet outlet that provides a zero gradient outflow condition for a fixed value inflow kqrwf is the wall function for the turbulence kinetic energy nutkrwf is rough wall function for kinetic eddy viscosity and omegawf is the wall function for frequency 2 2 ship model the kriso container ship kcs model used in this paper is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose tokyo 2015 the ship is a very popular test model as many experimental and cfd test results are open to public and have been discussed in many workshops and conferences like gothenburg tokyo and simman fig 1 shows the body plan of kcs model and the ship specifications are provided in table 2 2 3 simulation mesh with the increase in the computational resources the mesh resolution used for ship simulations has also increased from 700k in 2000 gothenburg 2000 to 3 million in 2005 tokyo 2005 and to around 5 million in 2008 simman 2008 the required mesh resolution for getting detailed contours for propeller inflow is even higher nevertheless for openfoam model scale simulations for calm water cases generally generates a reliable solution with a mesh resolution of around 3 million gatin et al 2015 or less du et al 2017 2018 the domain size blockmesh for simulations was set following ittc 2011 guidelines the inlet was placed two ship lengths windward the bow the outlet three ship lengths downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which created a body fitted hexahedral mesh around the hull surface from the specified stl file the trim angles for simulations were applied at stl files and then snappyhexmesh was executed near hull regions in the blockmesh was refined five times using toposet and snappyhexmesh was configured to perform one refinement near free surface and hull full hull simulations were performed for all cases using a mesh resolution of 2 7 million a grid sensitivity analysis was also performed to analyze the grid uncertainty in the results the resolution varied slightly for different trim angles however the variation was limited to a few thousand cells all the simulations were performed using the model scale ship a general assembly of the mesh is shown in fig 2 2 4 computational resource the simulations were performed in a single node intel r core i5 cpu with 4 cores clock speed of 2 27 ghz and 8 gb of physical memory the average time step used was 0 001 s and for simulating each case with stable output the required physical time was about 36 h per case all simulations were run up to 20 s simulation time for attaining stable results 3 results calm water resistance prediction is the estimation of drag force for a ship while moving forward in the calm water ship s drag resistance is a summation of frictional resistance and pressure resistance frictional resistance arises from the hull surface friction and pressure resistance is mainly the wave making resistance encountered by ship during its forward motion when the ship moves forward the bulbous bow creates waves on the free surface thus energy is transferred from ship to free surface and this loss is termed as wave making resistance most of the turbulence is formed at the stern section of the ship and is influenced by the stern section in contact with the water thus changes in water encounter area at bow or stern influences the total encountered resistance when a ship s trim and draft is adjusted three major changes happen first the underwater area of the vessel changes which varies the encountered frictional resistance or skin friction next the inflow to the propeller changes which might affect the propulsion efficiency thus the fuel consumption finally due to the change of underwater volume and position the manoeuvring capability of the vessel also changes however this paper particularly aims at the study of the changes in frictional and viscous resistance due to changing trim and draft conditions naturally the other two elements are also of high importance for gaining an overall understanding of the trim effect on the vessel however considering that none of the simulated cases would have propeller emergence the propeller interaction is ignored for this initial study furthermore since the paper highlights on seakeeping study the manoeuvring part is also ignored 3 1 verification and validation study for calm water simulations initially a grid uncertainty analysis was performed using three different mesh resolutions for two froude number cases simulations were performed with mesh resolution of 0 67 million 1 08 million and 2 4 million cells maintaining a mesh refinement ratio of 1 41 the selected cases were the design froude number 0 26 and a lower one of 0 195 with related reynolds number the uncertainty analysis was performed using the ittc 2017 guidelines following the factor of safety based method celik et al 2008 although several cases showed oscillatory convergence the average corrected uncertainty was 2 except for the trim cases where the uncertainty was higher overall the analysis results indicate that the simulation setup and the used mesh resolution is stable following the trend the results should improve with improved mesh resolution however considering the large number of cases to be simulated for the trim study the 2 4 million mesh resolution was selected to keep the computational cost limited details on the uncertainty analysis are provided in appendix a to validate the results calm water simulations were performed for kcs model at different froude and reynold numbers and compared with experimental data simulations were performed with the mesh resolution of 2 4 million and with heave and pitch free motion a total of six cases were simulated for validation and results were compared with experimental data presented in the tokyo 2015 workshop tokyo 2015 the simulation data was processed to predict the total drag coefficient sinkage and trim values of the ship the results are shown in table 3 the results are also graphically represented in fig 3 and fig 4 as can be seen from total drag prediction the results were in very good agreement with experimental data the sinkage results were well predicted as well as for the trim result although the deviation was high in terms of percentage the trend was well followed considering the small value of the trim angle the required mesh resolution for capturing such deviation was very high thus it was avoided to maintain the economy furthermore the exact position for the vertical centre of gravity was not mentioned for the experimental study which might have affected the results overall the prediction results are in good agreement for lower froude number cases and the deviation increases with increasing froude number the most probable reason for that is the insufficient mesh resolution near the hull surface for high speed cases where smaller cells are needed for properly capturing the pressure fluctuations however for validation the same mesh resolution was used for all cases and the mesh resolution was kept limited considering the large number of cases simulated for the trim study 3 2 simulation at even keel condition in order to analyze the trim effect on ship s resistance first even keel simulations were performed at three froude numbers using the solvers of openfoam and compared with experimental data openfoam has three solvers to perform multiphase turbulent flow simulation interfoam interdymfoam and ltsinterfoam initially simulations were performed using all three solvers for even keel condition for performance comparison despite performing the validation study this was done since simulations for trim analysis were performed with restricted motions static mesh all motions restricted this motion restriction compromises the accuracy of the solver the resistance prediction results with restricted motions for three different froude numbers using the three openfoam solvers are shown in table 4 the table also shows a comparison of simulations results with experimental data tokyo 2015 as can be seen from the table interfoam predicts resistance better for higher froude numbers and interdymfoam does so for the low froude number however in all three cases a significant deviation from the experimental data is observed as shown in the above section interdymfoam solver predicts best calm water resistance since it takes ship heave and pitch motion into consideration however since in these cases motions have been restricted deviations have increased significantly although in the above cases interfoam showed better agreement with experimental data interfoam simulations showed high oscillation in resistance prediction and simulations were to be run for a long period to reach steady state it was similar for interdymfoam simulations considering the large number of simulations needed for performing trim effect analysis a long convergence time was not favourable thus for analyzing the trim effect on resistance ltsinterfoam was used ltsinterfoam solver is relatively quick in reaching a steady state and it also allows fixation of simulation time step size which ensures even convergence condition for all simulations since trim effect observations are based on the relative difference in encountered resistance the deviation with experimental data is not an issue here 3 3 trim effect at different ship speeds to investigate the trim angle effect on ship resistance at different ship speeds three different ship speeds were investigated simulations were performed for ship trim angles ranging from 0 5 to 0 5 with 0 1 degree interval positive trim angle represented bow position downward trim at bow ship speed was varied by changing the simulation froude number 0 26 0 195 and 0 108 the simulation results are presented in table 5 furthermore fig 5 gives a graphical representation of the relative difference in results for different ship speeds and trim angles in the figure positive deviation from even keel condition 0 trim indicates less encountered resistance the encountered resistance is negative since it is against the flow direction as can be observed in fig 5 the ship in general shows a reduction in encountered resistance with positive trim angles in general results vary significantly for different trim angles at different speeds it also shows that the relative difference in encountered resistance with even keel condition varies as well at different ship speeds overall the ship does not follow a general trend for encountered resistance for varying the trim angle at different ship speeds the result shows that significant improvement can be attained in ship efficiency by changing ship trim angles however the required angle varies with ship speed and sea conditions to further explain the results pressure distributions are shown in fig 6 for each froude number at zero trim and at the optimum trim condition the figure shows pressure distribution for 0 and 0 5 trim condition for froude 0 26 0 and 0 2 for froude 0 195 and 0 and 0 1 for froude 0 108 in the figure on the top a comparison is provided for pressure distribution on the free surface and hull form for trim angles 0 and 0 5 for froude number 0 26 as can be seen for the trim angle of 0 5 the hull form encounters higher resistance at the bow front however pressure decreases at the stern section thus the overall encountered resistance is decreased a similar observation can be made for the middle images showing trim angles of 0 and 0 2 for froude number 0 195 here the bow with trim angle shows less pressure comparing to zero trim condition finally in the bottom pictures pressure distribution is shown for 0 and 0 1 at froude 0 108 at a negative trim angle the hull form encounters lower pressure at the stern section 3 4 trim effect at different ship drafts to investigate trim effect at different ship draft simulations were performed at ship design speed froude number 0 26 for design draft 0 02 m and 0 04 m draft at model scale simulations were performed for ship trim angles ranging from 0 5 to 0 5 with 0 2 degree interval positive trim angle represented bow position downward trim by the bow simulation results are shown in table 6 the result is graphically represented in fig 7 as can be observed from fig 7 the trim effect in ship resistance varies significantly with varying ship draft however as like the previous case a general relation cannot be established among resistances at different trim angles and at different drafts the result shows that trim angle can significantly influence ship encountered resistance at different ship drafts pressure distribution on free surface and hull form is shown in fig 8 for a draft 0 02m and 0 04 m at froude number 0 26 the top images show pressure distribution for 0 02 draft at trim angles 0 and 0 1 the bottom images show pressure distribution for 0 04 draft at trim angles 0 and 0 3 it is visible from the figure that as the trailing area at the stern becomes sharper the pressure due to turbulence decreases at the stern section however if the stern is lifted too much it will cause propeller emergence on the contrary if the bow side is lifted too much the bulbous bow would surface which will reduce propulsion efficiency as well thus adjustment of trim angle for optimal performance has to be done within a particular range depending on the vehicle type shape and speed in general the influence of draft and trim on resistance is well known however the knowledge is mostly qualitative and this paper presents quantitative values to that as mentioned in the literature review several researchers previously have worked on ship trim optimization however the optimization study is different for different vessels furthermore most of the academic work has been limited to trim study for even keel and the same speed the results here show that optimum trim condition varies depending on the ship speed and draft condition this highlights that for harnessing the benefits of trim optimization a dynamic system is essential which can predict the optimal trim condition considering the ship condition and sea state the cfd model has been used here to represent this scenario with sufficient accuracy and confidence however for practical application of dynamic trim optimization system for an ocean going vessel at different sea states pf based solver may be a more practical solution 4 conclusion the paper presented resistance prediction results for a kcs model at varying trim conditions simulations were performed at three different ship speeds and drafts with varying trim angles and the ship s encountered resistance was calculated the study revealed that a significant reduction in ship encountered resistance can be attained by selecting an optimum trim angle for that particular voyage condition the optimum trim angle for minimum resistance varies significantly with ship speed and draft so selection of optimal trim angle is a dynamic process and if done properly it can significantly increase voyage efficiency and reduce fuel cost however the present study is limited to calm water conditions and does not discuss trim effect in real sea condition with waves the effect of changing wake on propeller efficiency was also not discussed the changing trim angle also affects ship manoeuvrability park et al 2015 so this aspect needs consideration as well overall despite the limitations of the study it well validates that trim optimization can significantly improve ship operational efficiency and reduce harmful emissions maintaining regular operational preference it also validates that the solver openfoam is well capable of realizing trim effect studies and it does so with good reliability efficiency and economy acknowledgements this work was performed within the project shopera energy efficient safe ship operation which was partially funded by the eu under contract 605221 appendix a total drag coefficient ct e 3 sinkage mm trim deg fr number 0 2600 0 1950 0 2600 0 1950 0 2600 0 1950 output values ø 1 fine 4 040 3 6 15 8 0 27 0 21 ø 2 mid 4 1660 3 6280 15 3000 8 0800 0 2780 0 2200 ø 3 coarse 3 2000 3 0000 15 4500 8 3700 0 2670 0 2120 refinement ratio r12 h2 h1 1 4140 1 4140 1 4140 1 4140 1 4140 1 4140 r32 h3 h2 1 4140 1 4140 1 4140 1 4140 1 4140 1 4140 difference of estimation ε21 ø 2 ø 1 0 1260 0 0280 0 3000 0 0800 0 0080 0 0100 ε32 ø 3 ø 2 0 9660 0 6280 0 1500 0 2900 0 0110 0 0080 convergence ε 21 ε 32 0 1304 0 0446 2 0000 0 2759 0 7273 1 2500 s 1 sgn ε21 ε32 1 0000 1 0000 1 0000 1 0000 1 0000 1 0000 order of accuracy p 5 8800 9 0000 2 0000 3 7200 1 0000 0 6400 extrapolated values ø 21 ext 4 0211 3 5987 14 6998 7 9696 0 2507 0 1697 ø 32 ext 4 3109 3 6571 15 1499 7 9697 0 3046 0 2522 approximate relative error e21 a 0 0312 0 0078 0 0200 0 0100 0 0296 0 0476 e32 a 0 2319 0 1731 0 0098 0 0359 0 0396 0 0364 extrapolated relative error e21 ext 0 0047 0 0004 0 0204 0 0038 0 0771 0 2374 e32 ext 0 0336 0 0080 0 0099 0 0138 0 0872 0 1278 grid convergence index gci gci 21 fine 0 0058 0 0005 0 0250 0 0048 0 0895 0 2398 gci 32 fine 0 0435 0 0100 0 0123 0 0171 0 1195 0 1831 corrected uncertainty u 1c 0 0012 0 0001 0 0050 0 0010 0 0179 0 0480 u 2c 0 0192 0 0175 0 0000 0 0006 0 1090 0 1501 
22758,the resistance of a container ship at three different froude numbers and drafts is predicted using rans simulations demonstrating that the optimum trim angle varies with ship speed and draft first the zero trim condition results were validated with experimental data and later trim optimization was performed it is concluded that optimum trim condition for container ships vary with forward speed and draft condition and the variation does not appear to follow any particular trend trim optimization at different speeds and drafts can be a convenient and effective way for vessels to improve efficiency reduce fuel consumption and limit harmful emissions operational optimization including trim is the most practical way of improvement of efficient and environmental friendliness for existing vessels and in that way complement the choices during design so as to fulfil environmental concerns and related regulations keywords trim optimization kcs rans ship draft ship speed trim angle effect 1 introduction it is estimated that almost 90 of global trade is mobilized by shipping in the process of carrying such an immense amount of goods ships produce roughly 3 of global co2 emissions 14 15 nox emissions and 16 of sox emissions sherbaz and duan 2014 increasing environmental concerns and adoption of different emission related regulations have motivated both shipbuilders and owners to opt for more efficient and environment friendly vessels as a result optimization of hull forms and proper power prediction have been receiving more attention however for existing ships design related modifications are not feasible thus for improving their efficiency dependency is more on operational improvements like improvement in voyage execution reduction of auxiliary power consumption weather routing optimized hull and propeller polishing schedule slow steaming and trim optimization some of these aspects have been discussed by prpic oršic et al 2016 vettor and guedes soares 2016 and papanikolaou et al 2016 trim optimization is a relatively new concept recommended by the international maritime organization which requires no ship structural modification and can be attained simply by ballast water management and load distribution ship trim optimization principles are based on the fact that ships experience different resistance through water for the same speed and draft depending on their trim thus trim optimization simply advocates the selection of minimum resistance condition for that particular voyage condition it is well known from hydrodynamic principles that the trim of a vessel can significantly influence its fuel consumption altosole et al 2014 trim optimization study is generally performed based either on model tests or on computational fluid dynamics cfd simulations being among the early researchers to show the trim effect on ship resistance bertram et al 2010 showed that for each draft and speed there is a resistance optimum trim energy saving as a result of trim optimization was also reported by hansen and freund 2010 larsen et al 2012 performed an analysis on resistance and propulsion origin factors and their influence on power requirement and concluded that power gains are mainly dependent on resistance however change in propulsive coefficients also influences the performance hochkirch and mollol 2013 used both cfd and experimental fluid dynamics efd in model scale and full scale for investigating the change in power requirements by trim adjustment and found good agreement between the methods lv et al 2013 used a 3d panel method to investigate the wave making resistance of wigley ship model with different trims and determined optimum trim for low wave making resistance iakovatos et al 2014 performed calm water towing tank tests for six ship models to investigate different trim angle effects on their resistance prediction sherbaz and duan 2014 performed cfd simulation for a container ship model using a hybrid commercial code and determined optimum trim for minimum resistance at a specific ship speed or froude number sun et al 2016 took the study to a further level by applying the trim optimization simulation results obtained using commercial rans code to the real vessel and showed significant fuel savings deng et al 2015 performed experimental and numerical analysis on a trimaran to investigate the effects of shrinkage and trim on resistance apart from efd and cfd studies the data analytics perspective has also been investigated by researchers like coraddu et al 2017 for vessel fuel consumption forecast and trim optimization overall trim optimization is still a relatively new field of study and limited research have been performed on it in the commercial side force technology is one of the consultants in the field of trim optimization they performed trim optimization study on almost 300 vessels including tankers container vessels lng carriers ro ro vessels and ferries with the majority being container vessels their study revealed that fuel savings of up to 15 can be achieved in specific conditions by adjusting trim and up to 2 3 in overall fleet operations reichel et al 2014 sspa also showed that large crude and bulk carriers have the potential to decrease the required driving power for the standard operating range of trims by as much as 10 15 in ballast and 5 8 in full load condition merrit 2009 the global maritime energy efficiency partnerships glomeep estimates that optimization of trim and draft can reduce fuel consumption by 0 5 3 on main engine fuel consumption for most vessel types whereas for ships with partial loads like container or ro ro it can be up to 5 glomeep 2017 in general experimental study for trim optimization might be one of the best ways to understand the optimum operating conditions for a vessel however for that it is essential to have the ship model already built and a proper test facility to replicate the intended sea states furthermore it is difficult to obtain flow field details from experimental work potential flow based methods ignore the viscous effect and are mostly limited to added resistance prediction thus cfd has been primarily used for studying such calm water cases for many years now although cfd models were first introduced back in the 1980s it picked popularity in early 2000 with the development in computational resources especially in the last decade a lot of researchers have proven the efficiency of cfd models for studying such cases since the introduction of the kcs kvlcc and dtmb models in the gothenburg 2000 workshop larsson et al 2003 a significant gain in the accuracy of cfd predictions have been observed over the years larsson et al 2013 tokyo 2015 among recent works el moctar et al 2010 presented simulation results for the three ship models using openfoam and comet zhang 2010 presented rans simulation for kcs model with and without a propeller islam et al 2017 presented kcs simulation results using rans code ship motion jasak et al 2018 performed validation and grid sensitivity studies for full scale self propulsion ship using naval hydro based on openfoam duet al 2018 also used openfoam to simulate ship hydrodynamics and confirmed that the cfd method is extremely suitable for ship dynamics problems thus openfoam was selected for the presented study in this paper this paper discusses the trim analysis outcomes for a container ship model kcs using an open source rans solver openfoam the paper shows how resistance prediction varies for the ship model with changing trim conditions at different ship speeds and drafts the study shows that a significant reduction in encountered resistance can be attained by adjusting trim conditions depending on ship operational conditions and ship response for the same trim angle varies with ship speed and draft conditions 2 method 2 1 simulation solver 2 1 1 mathematical model openfoam open field operation and manipulation is an open source library written in c language following the object oriented paradigm the code is available under gnu general public license gpl it can be used to numerically solve a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it can solve both structured and unstructured polyhedral meshes including h refinement or hanging nodes and contains an extensive range of solvers to perform different types of cfd simulations it has several packages to perform multiphase turbulent flow simulation for floating objects openfoam also allows relatively easy customization and modification of solvers because of its modular design the solver has been elaborately described by jasak 2009 the openfoam solver used to perform ship hydrodynamic simulations for this paper simulates incompressible two phase flow the governing equation is based on continuity and reynolds averaged navier stokes equation the volume of fluid vof method is used to model fluid as one continuum of mixed properties the unstructured collocated finite volume method fvm using gauss theorem together with user defined and implemented solution algorithm and time integration schemes drikakis et al 2007 is used to discretize the governing equations time integration is performed by a semi implicit second order two point backwards differencing scheme pressure velocity coupling is obtained through a simple algorithm ferziger and peric 2002 openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference 2 1 2 turbulence parameters turbulence was modelled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated using the common guidelines labanti et al 2016 as follows 1 i 0 16 r 1 8 2 k m 2 s 2 3 2 u i 2 3 δ m l r 4 l m 0 4 δ 5 c μ 0 09 6 ω 1 s k c μ 1 4 l 7 ν t m 2 s 3 2 u i l 2 1 3 boundary conditions the control volume represented a deep water condition so the two lateral sides and the bottom were symmetry plane type faces no additional information was required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions are as shown in table 1 here fv is fixed value specified by the user opmv is outlet phase mean velocity piov is pressure inlet outlet velocity that applies zero gradient for outflow whilst inflow velocity is the patch face normal component of the internal cell value and mwv is moving wall velocity ffp is fixed flux pressure that adjusts the pressure gradient such that the flux on the boundary is that one specified by the velocity boundary condition zg is zero gradient tp is total pressure calculated as static pressure reference plus the dynamic component due to velocity io is inlet outlet that provides a zero gradient outflow condition for a fixed value inflow kqrwf is the wall function for the turbulence kinetic energy nutkrwf is rough wall function for kinetic eddy viscosity and omegawf is the wall function for frequency 2 2 ship model the kriso container ship kcs model used in this paper is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose tokyo 2015 the ship is a very popular test model as many experimental and cfd test results are open to public and have been discussed in many workshops and conferences like gothenburg tokyo and simman fig 1 shows the body plan of kcs model and the ship specifications are provided in table 2 2 3 simulation mesh with the increase in the computational resources the mesh resolution used for ship simulations has also increased from 700k in 2000 gothenburg 2000 to 3 million in 2005 tokyo 2005 and to around 5 million in 2008 simman 2008 the required mesh resolution for getting detailed contours for propeller inflow is even higher nevertheless for openfoam model scale simulations for calm water cases generally generates a reliable solution with a mesh resolution of around 3 million gatin et al 2015 or less du et al 2017 2018 the domain size blockmesh for simulations was set following ittc 2011 guidelines the inlet was placed two ship lengths windward the bow the outlet three ship lengths downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which created a body fitted hexahedral mesh around the hull surface from the specified stl file the trim angles for simulations were applied at stl files and then snappyhexmesh was executed near hull regions in the blockmesh was refined five times using toposet and snappyhexmesh was configured to perform one refinement near free surface and hull full hull simulations were performed for all cases using a mesh resolution of 2 7 million a grid sensitivity analysis was also performed to analyze the grid uncertainty in the results the resolution varied slightly for different trim angles however the variation was limited to a few thousand cells all the simulations were performed using the model scale ship a general assembly of the mesh is shown in fig 2 2 4 computational resource the simulations were performed in a single node intel r core i5 cpu with 4 cores clock speed of 2 27 ghz and 8 gb of physical memory the average time step used was 0 001 s and for simulating each case with stable output the required physical time was about 36 h per case all simulations were run up to 20 s simulation time for attaining stable results 3 results calm water resistance prediction is the estimation of drag force for a ship while moving forward in the calm water ship s drag resistance is a summation of frictional resistance and pressure resistance frictional resistance arises from the hull surface friction and pressure resistance is mainly the wave making resistance encountered by ship during its forward motion when the ship moves forward the bulbous bow creates waves on the free surface thus energy is transferred from ship to free surface and this loss is termed as wave making resistance most of the turbulence is formed at the stern section of the ship and is influenced by the stern section in contact with the water thus changes in water encounter area at bow or stern influences the total encountered resistance when a ship s trim and draft is adjusted three major changes happen first the underwater area of the vessel changes which varies the encountered frictional resistance or skin friction next the inflow to the propeller changes which might affect the propulsion efficiency thus the fuel consumption finally due to the change of underwater volume and position the manoeuvring capability of the vessel also changes however this paper particularly aims at the study of the changes in frictional and viscous resistance due to changing trim and draft conditions naturally the other two elements are also of high importance for gaining an overall understanding of the trim effect on the vessel however considering that none of the simulated cases would have propeller emergence the propeller interaction is ignored for this initial study furthermore since the paper highlights on seakeeping study the manoeuvring part is also ignored 3 1 verification and validation study for calm water simulations initially a grid uncertainty analysis was performed using three different mesh resolutions for two froude number cases simulations were performed with mesh resolution of 0 67 million 1 08 million and 2 4 million cells maintaining a mesh refinement ratio of 1 41 the selected cases were the design froude number 0 26 and a lower one of 0 195 with related reynolds number the uncertainty analysis was performed using the ittc 2017 guidelines following the factor of safety based method celik et al 2008 although several cases showed oscillatory convergence the average corrected uncertainty was 2 except for the trim cases where the uncertainty was higher overall the analysis results indicate that the simulation setup and the used mesh resolution is stable following the trend the results should improve with improved mesh resolution however considering the large number of cases to be simulated for the trim study the 2 4 million mesh resolution was selected to keep the computational cost limited details on the uncertainty analysis are provided in appendix a to validate the results calm water simulations were performed for kcs model at different froude and reynold numbers and compared with experimental data simulations were performed with the mesh resolution of 2 4 million and with heave and pitch free motion a total of six cases were simulated for validation and results were compared with experimental data presented in the tokyo 2015 workshop tokyo 2015 the simulation data was processed to predict the total drag coefficient sinkage and trim values of the ship the results are shown in table 3 the results are also graphically represented in fig 3 and fig 4 as can be seen from total drag prediction the results were in very good agreement with experimental data the sinkage results were well predicted as well as for the trim result although the deviation was high in terms of percentage the trend was well followed considering the small value of the trim angle the required mesh resolution for capturing such deviation was very high thus it was avoided to maintain the economy furthermore the exact position for the vertical centre of gravity was not mentioned for the experimental study which might have affected the results overall the prediction results are in good agreement for lower froude number cases and the deviation increases with increasing froude number the most probable reason for that is the insufficient mesh resolution near the hull surface for high speed cases where smaller cells are needed for properly capturing the pressure fluctuations however for validation the same mesh resolution was used for all cases and the mesh resolution was kept limited considering the large number of cases simulated for the trim study 3 2 simulation at even keel condition in order to analyze the trim effect on ship s resistance first even keel simulations were performed at three froude numbers using the solvers of openfoam and compared with experimental data openfoam has three solvers to perform multiphase turbulent flow simulation interfoam interdymfoam and ltsinterfoam initially simulations were performed using all three solvers for even keel condition for performance comparison despite performing the validation study this was done since simulations for trim analysis were performed with restricted motions static mesh all motions restricted this motion restriction compromises the accuracy of the solver the resistance prediction results with restricted motions for three different froude numbers using the three openfoam solvers are shown in table 4 the table also shows a comparison of simulations results with experimental data tokyo 2015 as can be seen from the table interfoam predicts resistance better for higher froude numbers and interdymfoam does so for the low froude number however in all three cases a significant deviation from the experimental data is observed as shown in the above section interdymfoam solver predicts best calm water resistance since it takes ship heave and pitch motion into consideration however since in these cases motions have been restricted deviations have increased significantly although in the above cases interfoam showed better agreement with experimental data interfoam simulations showed high oscillation in resistance prediction and simulations were to be run for a long period to reach steady state it was similar for interdymfoam simulations considering the large number of simulations needed for performing trim effect analysis a long convergence time was not favourable thus for analyzing the trim effect on resistance ltsinterfoam was used ltsinterfoam solver is relatively quick in reaching a steady state and it also allows fixation of simulation time step size which ensures even convergence condition for all simulations since trim effect observations are based on the relative difference in encountered resistance the deviation with experimental data is not an issue here 3 3 trim effect at different ship speeds to investigate the trim angle effect on ship resistance at different ship speeds three different ship speeds were investigated simulations were performed for ship trim angles ranging from 0 5 to 0 5 with 0 1 degree interval positive trim angle represented bow position downward trim at bow ship speed was varied by changing the simulation froude number 0 26 0 195 and 0 108 the simulation results are presented in table 5 furthermore fig 5 gives a graphical representation of the relative difference in results for different ship speeds and trim angles in the figure positive deviation from even keel condition 0 trim indicates less encountered resistance the encountered resistance is negative since it is against the flow direction as can be observed in fig 5 the ship in general shows a reduction in encountered resistance with positive trim angles in general results vary significantly for different trim angles at different speeds it also shows that the relative difference in encountered resistance with even keel condition varies as well at different ship speeds overall the ship does not follow a general trend for encountered resistance for varying the trim angle at different ship speeds the result shows that significant improvement can be attained in ship efficiency by changing ship trim angles however the required angle varies with ship speed and sea conditions to further explain the results pressure distributions are shown in fig 6 for each froude number at zero trim and at the optimum trim condition the figure shows pressure distribution for 0 and 0 5 trim condition for froude 0 26 0 and 0 2 for froude 0 195 and 0 and 0 1 for froude 0 108 in the figure on the top a comparison is provided for pressure distribution on the free surface and hull form for trim angles 0 and 0 5 for froude number 0 26 as can be seen for the trim angle of 0 5 the hull form encounters higher resistance at the bow front however pressure decreases at the stern section thus the overall encountered resistance is decreased a similar observation can be made for the middle images showing trim angles of 0 and 0 2 for froude number 0 195 here the bow with trim angle shows less pressure comparing to zero trim condition finally in the bottom pictures pressure distribution is shown for 0 and 0 1 at froude 0 108 at a negative trim angle the hull form encounters lower pressure at the stern section 3 4 trim effect at different ship drafts to investigate trim effect at different ship draft simulations were performed at ship design speed froude number 0 26 for design draft 0 02 m and 0 04 m draft at model scale simulations were performed for ship trim angles ranging from 0 5 to 0 5 with 0 2 degree interval positive trim angle represented bow position downward trim by the bow simulation results are shown in table 6 the result is graphically represented in fig 7 as can be observed from fig 7 the trim effect in ship resistance varies significantly with varying ship draft however as like the previous case a general relation cannot be established among resistances at different trim angles and at different drafts the result shows that trim angle can significantly influence ship encountered resistance at different ship drafts pressure distribution on free surface and hull form is shown in fig 8 for a draft 0 02m and 0 04 m at froude number 0 26 the top images show pressure distribution for 0 02 draft at trim angles 0 and 0 1 the bottom images show pressure distribution for 0 04 draft at trim angles 0 and 0 3 it is visible from the figure that as the trailing area at the stern becomes sharper the pressure due to turbulence decreases at the stern section however if the stern is lifted too much it will cause propeller emergence on the contrary if the bow side is lifted too much the bulbous bow would surface which will reduce propulsion efficiency as well thus adjustment of trim angle for optimal performance has to be done within a particular range depending on the vehicle type shape and speed in general the influence of draft and trim on resistance is well known however the knowledge is mostly qualitative and this paper presents quantitative values to that as mentioned in the literature review several researchers previously have worked on ship trim optimization however the optimization study is different for different vessels furthermore most of the academic work has been limited to trim study for even keel and the same speed the results here show that optimum trim condition varies depending on the ship speed and draft condition this highlights that for harnessing the benefits of trim optimization a dynamic system is essential which can predict the optimal trim condition considering the ship condition and sea state the cfd model has been used here to represent this scenario with sufficient accuracy and confidence however for practical application of dynamic trim optimization system for an ocean going vessel at different sea states pf based solver may be a more practical solution 4 conclusion the paper presented resistance prediction results for a kcs model at varying trim conditions simulations were performed at three different ship speeds and drafts with varying trim angles and the ship s encountered resistance was calculated the study revealed that a significant reduction in ship encountered resistance can be attained by selecting an optimum trim angle for that particular voyage condition the optimum trim angle for minimum resistance varies significantly with ship speed and draft so selection of optimal trim angle is a dynamic process and if done properly it can significantly increase voyage efficiency and reduce fuel cost however the present study is limited to calm water conditions and does not discuss trim effect in real sea condition with waves the effect of changing wake on propeller efficiency was also not discussed the changing trim angle also affects ship manoeuvrability park et al 2015 so this aspect needs consideration as well overall despite the limitations of the study it well validates that trim optimization can significantly improve ship operational efficiency and reduce harmful emissions maintaining regular operational preference it also validates that the solver openfoam is well capable of realizing trim effect studies and it does so with good reliability efficiency and economy acknowledgements this work was performed within the project shopera energy efficient safe ship operation which was partially funded by the eu under contract 605221 appendix a total drag coefficient ct e 3 sinkage mm trim deg fr number 0 2600 0 1950 0 2600 0 1950 0 2600 0 1950 output values ø 1 fine 4 040 3 6 15 8 0 27 0 21 ø 2 mid 4 1660 3 6280 15 3000 8 0800 0 2780 0 2200 ø 3 coarse 3 2000 3 0000 15 4500 8 3700 0 2670 0 2120 refinement ratio r12 h2 h1 1 4140 1 4140 1 4140 1 4140 1 4140 1 4140 r32 h3 h2 1 4140 1 4140 1 4140 1 4140 1 4140 1 4140 difference of estimation ε21 ø 2 ø 1 0 1260 0 0280 0 3000 0 0800 0 0080 0 0100 ε32 ø 3 ø 2 0 9660 0 6280 0 1500 0 2900 0 0110 0 0080 convergence ε 21 ε 32 0 1304 0 0446 2 0000 0 2759 0 7273 1 2500 s 1 sgn ε21 ε32 1 0000 1 0000 1 0000 1 0000 1 0000 1 0000 order of accuracy p 5 8800 9 0000 2 0000 3 7200 1 0000 0 6400 extrapolated values ø 21 ext 4 0211 3 5987 14 6998 7 9696 0 2507 0 1697 ø 32 ext 4 3109 3 6571 15 1499 7 9697 0 3046 0 2522 approximate relative error e21 a 0 0312 0 0078 0 0200 0 0100 0 0296 0 0476 e32 a 0 2319 0 1731 0 0098 0 0359 0 0396 0 0364 extrapolated relative error e21 ext 0 0047 0 0004 0 0204 0 0038 0 0771 0 2374 e32 ext 0 0336 0 0080 0 0099 0 0138 0 0872 0 1278 grid convergence index gci gci 21 fine 0 0058 0 0005 0 0250 0 0048 0 0895 0 2398 gci 32 fine 0 0435 0 0100 0 0123 0 0171 0 1195 0 1831 corrected uncertainty u 1c 0 0012 0 0001 0 0050 0 0010 0 0179 0 0480 u 2c 0 0192 0 0175 0 0000 0 0006 0 1090 0 1501 
22759,algal blooms pose severe ecological and economical threats to estuaries and marine systems in this study a three dimensional model coupling nonhydrostatic free surface flow with algae transport and its biological behaviors is presented the hydrodynamic model solves the reynolds averaged navier stokes equations using a semi implicit fractional time step finite difference method on a staggered cartesian grid the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the scheme is verified and validated by comparing simulation results with analytical solutions and measurements the hydrodynamic model is coupled with an algae transport and biological model the biological model simulates the buoyancy vertical migration and biological behaviors of blue green algae based on different environmental factors such as nutrients irradiance temperature and salinity the model is used to analyze transport of blue green algae in milford lake which is the largest man made lake in kansas suffering from algal blooms the results of this study provide useful guidance for water quality management and predicting algal blooms in milford lake for the first time nonhydrostatic free surface flow algae transport buoyancy migration and biological production are included in one three dimensional computational model which can be used to study other estuaries and marine systems efficiently keywords algal blooms algae transport computational fluid dynamics nonhydrostatic free surface flow 3d hydrodynamic ecological modeling 1 introduction algal blooms happen in both estuaries and marine systems doscher and davies 2015 oh et al 2012 zhang et al 2015 shows harmful toxins released by blue green algae can cause liver damage and cancer to humans as well as other fatal disease to pets livestock and aquatic animals that live in or drink from the algae contaminated water it is important to understand not only the physical transport but also biological behaviors of algae in surface water systems studies blottière et al 2014 cao et al 2006 ishikawa et al 2002 moreno ostos et al 2009 show that physical transport of algae is dominated by water circulation and wind induced waves have strong impacts affecting the vertical motions of algae in the water column experiments kromkamp and walsby 1990 walsby 1987 show that the density of algae colony changes subjected to diurnal light cycle based on the previous studies ma et al 2014 paerl et al 2011 xu et al 2010 different environmental factors including nutrients irradiance temperature and salinity vary in the water column and need to be considered for the biological process of algal blooms therefore a comprehensive three dimensional 3d model is required to include all the covariant influencing factors to simulate the physical transport and biological behaviors of algae in surface water bodies in the literature tetra tech 2007 the environmental fluid dynamic code efdc has been used which is a multifunctional computational modeling system capable of simulating hydrodynamics sediment transport algal transport and production as well as other water quality constituent transport in one two and three dimensions during the past two decades efdc has been applied to over 100 surface water bodies including rivers lakes reservoirs wetlands estuaries and coastal regions for water quality assessments ji et al 2001 kim et al 1998 kuo et al 1996 luo and li 2009 park et al 2005 1995 shen et al 1999 wu and xu 2011 the hydrostatic primitive equations are solved in efdc and other hydrostatic models blumberg and mellor 1987 casulli and cattani 1994 casulli and cheng 1992 leendertse 1989 stelling and leendertse 1992 however 3d hydrostatic models can be ill posed when dealing with open boundaries shown in studies mahadevan et al 1996 oliger and sundström 1978 casulli 1999 mentions that the hydrostatic assumption is not valid when fluid flows over rapidly varying slopes and short waves where the ratio of the vertical to horizontal scales is not sufficiently small therefore a 3d computational model including nonhydrostatic free surface flow algae transport and its biological behaviors is needed in this study based on the previous experience of our research group in 2d numerical simulations han and zhang 2016 zhang et al 2011 2013 2014 of constituent transport in surface water bodies a 3d model for nonhydrostatic free surface flow is developed and further improved the hydrodynamic model solves the reynolds averaged navier stokes equations by a semi implicit fractional time step finite difference method on a staggered cartesian grid where the hydrostatic components are determined first and the nonhydrostatic pressure and other components are determined in a subsequent step based on casulli 1999 casulli and stelling 1998 liu et al 2017 the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the above scheme is further developed by including a mixing length turbulence model rodi 1984 which is widely used in hydraulic turbulent flows lesser et al 2004 reichert et al 2001 rodi 1987 1984 the convective terms are discretized by using an explicit second order upwind scheme zhang et al 2011 in space which is more efficient and can reach higher order accuracy comparing to the eulerian lagrangian method casulli and cheng 1992 cheng et al 1984 used in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 the resultant algorithm is second order accurate in both time and space after the hydrodynamic model is developed it is coupled with an algae model which not only simulates the physical transport but also biological behaviors of algae in surface water systems numerical simulations of algae transport are typically predicted by solving the convection diffusion equation for algae concentration hedger et al 2004 some studies kromkamp and walsby 1990 walsby 1987 emphasize the impacts of temporal and spatial light intensity on the rate of change of colony density however the biological production subjected to different environmental factors is missing efdc tetra tech 2007 can simulate the biological behaviors of algae but the vertical algae velocity is assumed to be constant which fails to track the density changes in colony subjected to diurnal light cycle this study is the first 3d nonhydrostatic free surface flow computational model that includes algae transport buoyancy vertical migration and biological production the vertical migration of algae is calculated based on buoyancy density changes of a colony at a given depth and time based on irradiance kromkamp and walsby 1990 the algae production rates at different water depths are calculated based on the effects of different environmental factors including nutrients irradiance temperature and salinity according to efdc tetra tech 2007 while the simulation method is robust it requires large amounts of computational time when applied to fully nonhydrostatic flows in this study the performance of the model is substantially improved by implementing parallel computing techniques into the program as an example the model is used to analyze transport of algae in milford lake which is the largest man made lake in kansas suffering from algal blooms first the effects of wind on algae transport in milford lake are studied then the vertical migration and biological behaviors of algae are simulated and analyzed the findings of this study provide useful guidance for water quality management and predicting algal blooms in milford lake the current model is a robust and efficient way to model algae transport and its biological behaviors and can be applied to studies of other surface water systems effectively 2 numerical methods 2 1 hydrodynamic model the hydrodynamic model solves the reynolds averaged navier stokes equations for incompressible flow which can have the following form pedlosky 1992 1 u t u u x v u y w u z p x x a h u x y a h u y z a v u z f v 2 v t u v x v v y w v z p y x a h v x y a h v y z a v v z f u 3 w t u w x v w y w w z p z x a h w x y a h w y z a v w z g where x y and z are the cartesian coordinates x from west to east y from south to north and z vertical pointing upward t is the time u v and w are the velocities in the x y and z directions respectively p is the normalized pressure defined as the pressure divided by a constant reference density a h and a v are the horizontal and vertical eddy viscosity coefficients respectively f is the coriolis frequency and g is the gravitational acceleration the mass conservation is expressed by the continuity equation for incompressible flows 4 u x v y w z 0 integrating eq 4 over depth and using the kinematic boundary conditions at the free surface and bottom yields the following free surface elevation equation casulli 1999 5 η t x h η u d z y h η v d z 0 where η is the free surface elevation and h is the water depth measured from the undisturbed water surface similarly casulli and cheng 1992 and wu et al 2000 used free surface kinematic condition to determine the free surface volume of fluid vof method liu and garcia 2008 is another popular way to track the free surface however the method above cannot capture the water surface of sharp interfaces and are limited to courant number less than unity then sattar et al 2017 developed a finite area method fam which tracks free surface by interface tracking that addresses the issues the normalized pressure p in eqs 1 3 includes both the hydrostatic and nonhydrostatic pressure terms which can be expressed as casulli 1999 6 p x y z t g η x y t z q x y z t where q is the nonhydrostatic pressure component substituting eq 6 into eqs 1 3 and neglecting the coriolis frequency yields 7 u t u u x v u y w u z g η x q x x a h u x y a h u y z a v u z 8 v t u v x v v y w v z g η y q y x a h v x y a h v y z a v v z 9 w t u w x v w y w w z q z x a h w x y a h w y z a v w z g where the hydrostatic approximation is made eq 9 is neglected and q 0 is assumed throughout in applications to large shallow water bodies such as lakes and reservoirs the ratio of horizontal length scale to vertical length scale is very large as a result the horizontal eddy viscosity terms are typically orders of magnitude smaller than the vertical eddy viscosity terms and their effects are usually small therefore the horizontal eddy viscosity is neglected in this study as in other studies casulli and cheng 1992 casulli and stelling 1998 casulli 1999 liu et al 2017 the vertical eddy viscosity coefficient is determined using the mixing length model rodi 1984 10 a v l m 2 u z 2 v z 2 1 2 where l m is the mixing length defined as 11 l m κ z for κ z 0 1 h 12 l m 0 1 h for κ z 0 1 h where κ is the von kármán constant and h is the total water depth defined as 13 h η h in applications to other water bodies where the ratio of horizontal and vertical length scale is small other turbulence models liu et al 2016 zhou et al 2017 should be considered the boundary conditions at the free surface are specified by prescribing the wind stresses as smith 2006 14 a v u z τ w i n d x ρ w a v v z τ w i n d y ρ w where τ w i n d x and τ w i n d y are the surface wind shear stresses in the x and y directions respectively and ρ w is the water density the boundary conditions at the bottom are specified by expressing the bottom shear stresses as smith 2006 15 a v u z τ b e d x ρ w a v v z τ b e d y ρ w where τ b e d x and τ b e d y are the bed shear stresses in the x and y directions respectively the wind shear stress is determined as teeter et al 2001 16 τ w ρ a c d u a 2 where τ w is the wind stress ρ a is the air density u a is the wind speed and c d is the atmosphere drag coefficient appropriate for wind referenced to a height of 10 m which is determined based on the empirical formula as teeter et al 2001 17 c d 0 4 16 11 0 5 ln h 2 48 ln u a 2 then wind shear stresses in the x and y directions can be determined as 18 τ w i n d x τ w cos θ τ w i n d y τ w sin θ where θ is the wind direction measured counter clockwise from east the bed shear stresses are determined as chen 2003 smith 2006 19 τ b e d x ρ w c b u b 2 v b 2 1 2 u b 20 τ b e d y ρ w c b u b 2 v b 2 1 2 v b where u b v b are horizontal velocity components at a level z b near the bottom and c b is the bed friction coefficient determined as smith 2006 21 c b κ 2 ln z b z 0 2 where z 0 is the characteristic length 2 2 algae transport and biological model the algae transport is governed by a convection diffusion equation including the buoyancy effect hedger et al 2004 and the algae biological model is developed based on efdc tetra tech 2007 the combined algae transport and biological model can be expressed as 22 c t u c x v c y w c z v a c z x a h s c t c x y a h s c t c y z a v s c t c z p b m p r c where c is the algae concentration v a is the stokes velocity s c t is the turbulent schmidt number p is the production rate b m is the basal metabolism rate and p r is the predation rate the stokes velocity is determined using a modification of the stokes equation given as kromkamp and walsby 1990 23 v a 2 g r 2 ρ c ρ w 9 φ n where r is the colony radius ρ c is the algae density φ is the algae form resistance factor and n is the dynamic viscosity of water the algae density is calculated as kromkamp and walsby 1990 24 ρ c t 2 ρ c t 1 δ t c 1 i z i z k i c 2 i a c 3 where ρ c t 2 is the buoyancy density at the current time step ρ c t 1 is the buoyancy density at the previous time step δ t is the time step size c 1 is the rate constant of density increase c 2 is the rate constant of density decrease c 3 is the minimum rate of density decrease i d is the irradiance at local depth d i a is the average irradiance experienced in the previous day and k i is the half saturation irradiance for a maximum rate of density increase the irradiance at local depth d is determined as kromkamp and walsby 1990 25 i d i 0 e ε d where i 0 is the surface irradiance and ε is the extinction coefficient the surface irradiance at time t is expressed as kromkamp and walsby 1990 26 i 0 i m sin π t d l where i m is the irradiance at noon and d l is the day length from dawn to dusk the algae production rate p is calculated based on nutrient availability ambient light temperature and salinity which can be expressed based on efdc tetra tech 2007 as 27 p p m f 1 n f 2 i f 3 t f 4 s where p m is the maximum growth rate under optimal conditions f 1 n is the effect of suboptimal nutrient concentration 0 f 1 1 f 2 i is the effect of suboptimal light intensity 0 f 2 1 f 3 t is the effect of suboptimal temperature 0 f 3 1 and f 4 s is the effect of salinity 0 f 4 1 the details for the effects of different environmental factors are listed in the literature tetra tech 2007 the 3d heat transport equation is wu 2007 28 t t u t x v t y w t z x a h p r t t x y a h p r t t y z a v p r t t z q t ρ w c p where t is the local temperature p r t is the turbulent prandtl number q t is the heat source rate per unit volume and c p is the specific heat the salinity transport equation is wu 2007 29 s t u s x v s y w s z x a h s c t s x y a h s c t s y z a v s c t s z where s is the local salinity 2 3 numerical scheme a staggered cartesian grid is used for the simulations the physical domain is divided into n x n y n z rectangular cells of length δ x width δ y and height δ z each cell is numbered at its center with indices i j and k the discrete u velocity is defined at half integer i and integers j k v is defined at integers i k and half integer j w is defined at integers i j and half integer k q is defined at integers i j and k η is defined at integers i j finally the undisturbed water depth h x y is specified at u and v horizontal grid points 2 3 1 second order upwind scheme in space for transport equations here we discuss the transport equations related to algae transport first and then discuss the hydrodynamic model in the next section as mentioned earlier the horizontal eddy viscosity terms are neglected in this study as in casulli and cheng 1992 then the 3d convection diffusion equation is in the form 30 c t u c x v c y w c z z d c z where c is the variable of interest which can be algae concentration c temperature t and salinity s d is the diffusivity where d a v s c t for c and s where s c t is the turbulent schmidt number d a v p r t for t where p r t is the turbulent prandtl number the vertical velocity and source terms production rate basal metabolism rate and predation rate need to be added into eq 30 when c represents algae concentration and heat source term needs to be included when c represents temperature an explicit blended first and second order upwind scheme zhang et al 2011 in space used in the 2d simulations han and zhang 2016 zhang et al 2014 2013 is applied and further improved to discretize the convective terms in eq 30 where the first order upwind scheme in space is used for the cells next to the boundaries and second order upwind scheme in space is used for interior cells the vertical eddy viscosity terms are discretized by an implicit second order central difference approach for positive u v and w the discretized form of eq 30 can be expressed using the second order upwind scheme in space as 31 c i j k n 1 c i j k n δ t u 3 c i j k n 4 c i 1 j k n c i 2 j k n δ x v 3 c i j k n 4 c i j 1 k n c i j 2 k n δ y w 3 c i j k n 4 c i j k 1 n c i j k 2 n δ z d k 1 2 c i j k 1 n 1 c i j k n 1 δ z i j k 1 2 n d k 1 2 c i j k n 1 c i j k 1 n 1 δ z i j k 1 2 n δ z i j k n eq 31 can be rearranged as 32 c i j k n 1 f δ t d k 1 2 c i j k 1 n 1 c i j k n 1 δ z i j k 1 2 n d k 1 2 c i j k n 1 c i j k 1 n 1 δ z i j k 1 2 n δ z i j k n where f is the finite difference operator expressed as 33 f c i j k n δ t u 3 c i j k n 4 c i 1 j k n c i 2 j k n δ x i j k n v 3 c i j k n 4 c i j 1 k n c i j 2 k n δ y i j k n w 3 c i j k n 4 c i j k 1 n c i j k 2 n δ z i j k n where the vertical space increment δ z i j k is usually equal to the vertical grid size δ z except near the bottom and free surface where δ z i j k is the distance between a horizontal cell surface and bottom or free surface respectively in general δ z i j k depends on the spatial location and the time step and δ z i j k can vanish to account for complex geometries and wetting and drying purpose for each i j the set of eq 32 forms a linear tridiagonal system with unknowns c i j k n 1 in the same water column which can be solved by direct methods efficiently the above method is used to solve the convection diffusion equations for constituent transport the resultant scheme is second order accurate in space and first order accurate in time where the stability condition does not depend on the vertical eddy viscosity when an explicit first order upwind scheme in space is used casulli and cheng 1992 gives the stability condition of the scheme as 34 δ t u δ x v δ y w δ z 1 in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 the eulerian lagrangian method casulli and cheng 1992 cheng et al 1984 is used to compute the finite difference operator f the values of c at and around i j k at time t n 1 are related to the c values at and around i a j b k d at time t n furthermore i a j b k d denotes a point on the same streak line that passes through i j k at time t n 1 an interpolation formula is needed to define c i a j b k d n since a b and d are not integers in general cases the accuracy and stability of the scheme depend on the chosen interpolation formula casulli and cheng 1992 shows that the trilinear interpolation over the eight surrounding mesh points is the simplest methods to calculate c i a j b k d n even though the trilinear interpolation is the simplest interpolation method that can be used it is obviously more complicated and harder to apply comparing to the explicit second order upwind scheme in space even being extra complex the trilinear interpolation method can only reach first order accuracy in space since the upwind scheme is easier to apply and can reach higher order accuracy than the eulerian lagrangian method the upwind scheme is used in this study 2 3 2 semi implicit fractional time step finite difference method for hydrodynamic model the hydrodynamic model solves the reynolds averaged navier stokes equations with a semi implicit fractional time step finite difference method casulli 1999 casulli and stelling 1998 liu et al 2017 on a staggered cartesian grid whose stability is independent from the free surface wave speed wind stress bottom friction and vertical eddy viscosity in the first step the implicit contribution of the nonhydrostatic pressure is neglected the provisional results of velocity field and free surface elevation at the new time level are denoted by u v w and η respectively by using the θ method casulli and cattani 1994 a semi implicit discretization for the momentum eqs 7 9 are given as casulli 1999 35 u i 1 2 j k n 1 f u i 1 2 j k n 1 θ δ t δ x g η i 1 j n η i j n q i 1 j k n q i j k n θ g δ t δ x η i 1 j n 1 η i j n 1 a v δ t u i 1 2 j k 1 n 1 u i 1 2 j k n 1 δ z i 1 2 j k 1 2 n u i 1 2 j k n 1 u i 1 2 j k 1 n 1 δ z i 1 2 j k 1 2 n δ z i 1 2 j k n 36 v i j 1 2 k n 1 f v i j 1 2 k n 1 θ δ t δ y g η i j 1 n η i j n q i j 1 k n q i j k n θ g δ t δ y η i j 1 n 1 η i j n 1 a v δ t v i j 1 2 k 1 n 1 v i j 1 2 k n 1 δ z i j 1 2 k 1 2 n v i j 1 2 k n 1 v i j 1 2 k 1 n 1 δ z i j 1 2 k 1 2 n δ z i j 1 2 k n 37 w i j k 1 2 n 1 f w i j k 1 2 n 1 θ δ t δ z i j k 1 2 n q i j k 1 n q i j k n a v δ t w i j k 3 2 n 1 w i j k 1 2 n 1 δ z i j k 1 n w i j k 1 2 n 1 w i j k 1 2 n 1 δ z i j k n δ z i j k 1 2 n the finite difference operator f includes the explicit discretization of the convective terms which are discretized by the second order upwind scheme in space eq 33 in the current model instead of the eulerian lagrangian method casulli and cheng 1992 used in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 eqs 35 and 36 constitute two sets of linear tridiagonal systems by substituting u and v into the discretized free surface elevation eq 5 a penta diagonal system of equations for the unknown η can be formed the details of the procedure are similar to those in casulli 1999 and therefore omitted here the resultant matrix is diagonally dominant symmetric and positive definite and can be solved by the preconditioned conjugate gradient method hestenes and stiefel 1952 after the provisional free surface elevation η is determined provisional velocity components u v w can be solved using eqs 35 37 in the second step the new velocity and free surface elevation are corrected by including the nonhydrostatic pressure terms and the discrete momentum equations are expressed as 38 u i 1 2 j k n 1 u i 1 2 j k n 1 θ δ t δ x q i 1 j k n 1 q i j k n 1 39 v i j 1 2 k n 1 v i j 1 2 k n 1 θ δ t δ y q i j 1 k n 1 q i j k n 1 40 w i j k 1 2 n 1 w i j k 1 2 n 1 θ δ t δ z i j k 1 2 n q i j k 1 n 1 q i j k n 1 two sets of equations are formed by substituting eqs 38 40 into the discretized continuity equation eq 4 and free surface equation eq 5 and the equations form two hepta diagonal systems which are diagonally dominant symmetric and positive definite thus the equations can be solved by the preconditioned conjugate gradient method hestenes and stiefel 1952 finally the new velocity and free surface elevation are corrected by including nonhydrostatic pressure the detailed procedure is also addressed in casulli 1999 the final velocity field is locally and globally mass conservative in addition the unsolved terms in casulli 1999 such as vertical eddy viscosity wind and bed stress coefficients are determined using eqs 14 21 the resultant algorithm is second order accurate in both space and time it may require large amounts of computational time when the scheme is applied to fully nonhydrostatic flow especially under wind conditions to improve the computational efficiency the program is parallelized using the message passing interface mpi by domain decompositions instead of using the preconditioned conjugate gradient method hestenes and stiefel 1952 the matrices of free surface elevation and nonhydrostatic pressure in the hydrodynamic model casulli 1999 are solved using the ksp solver in portable extensible toolkit for scientific computation petsc balay et al 2014 the parallel scalability of the current model is compared with the theoretical speedups based on amdahl 1967 shown in fig 1 3 verification and validation 3 1 verification case the numerical method presented above is validated by comparing simulation results with analytical solutions and measurement data the verification case is to test a two dimensional standing wave in a square basin whose length l and depth h are 10 m the flow is driven by the following initial sinusoidal free surface elevations along the x axis at t 0 41 η 0 1 cos π l x based on the dispersion relation lamb 1945 the analytical solution for this standing wave is 42 η x t 0 1 cos k x cos σ t where the wavenumber k 2 π λ the wave length λ 2 l the angular frequency σ 2 π f the frequency f c λ and c is the wave celerity approximately by the following dispersion relation for sufficiently small wave amplitude casulli 1999 as 43 c g λ 2 π tanh 2 π h λ a grid size of 0 0625 m in both the horizontal and vertical directions and a time step of 0 0001 s are used to simulate the oscillations of the standing wave for 5 s the bottom friction and vertical eddy viscosity terms are neglected fig 2 shows the free surface elevation histories over the 5 s period at x 7 5 m 8 m and 10 m obtained with the current hydrostatic nonhydrostatic simulations and the analytical solutions the nonhydrostatic simulation results agree with the analytical solutions very well which verifies the current hydrodynamic model when dealing with waves with small amplitudes with flat bottom geometries in addition four levels of grid sizes are tested to verify the order of accuracy of the current scheme the grid sizes are 0 0625 m 0 125 m 0 25 m and 0 5 m and the time step is 0 0001 s the free surface elevations at t 5 s along the x axis are used to calculate the l 2 norm errors using the analytical solution as the exact solution the l 2 norm error for mesh level l is defined as 44 e l i 1 n g r i d η i l η i e x a c t 2 n g r i d where n g r i d is the total number of nodes of given grid fig 3 shows the l 2 norm errors and the first and second order slopes on log log scale and the norms are shown to be in a second order manner when grid is refined which assures the second order accuracy in space of the current algorithm 3 2 validation case the validation case is to test the spatial evolution of steep waves propagating over a longshore bar the simulation results are compared to the scheldt flume experimental data collected by delft hydraulics beji and battjes 1994 the flume has an overall length of 30 m and the flume geometry is shown in fig 4 a starting with zero initial velocity the water level over the horizontal bottom is 0 4 m and reduced to 0 1 m over a submerged trapezoidal bar a plane beach with a slope of 1 25 is located at the end of the flume serving as a wave absorber a grid size of δ x δ z 2 5 cm and a time step of 0 001 s are used in the simulation a sinusoidal wave of amplitude 1 cm and period of 2 02 s is specified at the left open boundary the simulated free surface elevations histories at 2 m and 13 5 m from the left open boundary are compared with the measurements shown in fig 4 b and c respectively the simulation results agree with the measurement data which validates the hydrodynamic simulation when dealing with complex geometries 4 application milford lake with a surface area of 64 km 2 milford lake is the largest man made lake in kansas which is a favorite getaway for outdoor loving visitors for activities such as hunting fishing boating hiking and swimming algal blooms pose severe environmental problems in milford lake and toxins released by algae are dangerous to people and animals within the areas kansas department of health and environment kdhe monitors the concentrations of algae at multiple locations in the lake and issues public health protection notifications when the algae concentration is over the limit to better understand algal transport and blooms the current model is used to study the circulation algae transport and its biological behaviors in milford lake the spatial assessments foster et al 2017 of harmful algal blooms in milford lake which is performed by us geological survey usgs kansas department of health and environment kdhe and us army corps of engineers usace in july and august 2015 show that the algae concentration is highest in zone c among all the areas shown in fig 5 kansas hab viewer 2017 based on the measurements the inflow and outflow discharge rates are set to be 56 63 m 3 s and the initial free surface elevation is 348 81 m a time step of 2 s is used in the simulations fig 6 shows the land elevations of the computational domain using the bathymetric survey data provided by the kansas water office kwo the size of the computational domain is 18 5 km by 13 km by 22 m which is covered by a 186 131 90 finite difference mesh with the grid sizes to be δ x δ y 100 m and δ z 0 25 m based on grid independence studies first the gird sizes in the horizontal directions are fixed at 100 m and four levels of grid size in the vertical direction 1 m 0 5 m 0 25 m 0 125 m are tested the velocity component u at two locations a 4 km 9 2 km and b 10 km 10 km at different elevations at t 3600 s are plotted in fig 7 where the difference between the first two finest meshes is very small which indicates that the grid convergence has been reached therefore the vertical grid size δ z is set to be 0 25 m then four levels of grid sizes 400 m 200 m 100 m 50 m in the horizontal directions are tested the velocity component u at a and b at deferent elevations at t 3600 s are plotted in fig 8 where the difference between the first two finest meshes is very small which indicates that the grid convergence has been reached therefore the horizontal grid sizes δ x and δ y are set to be 100 m another four levels of grid sizes are tested and the grid sizes of each level are δ x δ y 400 m δ z 2 m δ x δ y 200 m δ z 1 m δ x δ y 100 m δ z 0 5 m δ x δ y 50 m δ z 0 25 m the velocity components u v and w at t 3600 s are used to calculate the l 2 norm errors using the solution on the finest grid as the reference solution the errors are computed for the solutions of the coarser grids in section 3 1 the l 2 norm errors are calculated on a simple geometry where the bottom is flat and the norms drop in second order manner however the norms do not change in a second order manner when dealing with complex geometries in this case this behavior is due to the different land elevations on various grid resolutions when a finer gird is used more details of the geometry are obtained and the land elevations are more accurate and closer to the measurement data however the coarser the grid is the fewer details of the geometry can be captured fig 9 shows the land elevation contours of different horizontal grid sizes 100 m and 200 m where many details of the land elevations are lost on the coarser grid since the land elevation does not change in a second order manner as the grid is refined the l 2 norm errors do not change in a second order manner either a horizontal grid size 100 m and b horizontal grid size 200 m due to lack of the measurement data the initial algae concentration is assumed to be 1000 g m 3 near the inlet boundary shown in fig 10 the simulation time is 5 days the purpose of the following simulations is to investigate the effects of different environmental factors on the circulation physical transport and biological behaviors of algae in milford lake 4 1 wind effects wind velocity on the water surface is accounted for the effect of wind stress on the flow velocity which is important since wind stress has substantial impacts on the circulation and algae transport in surface water systems to study the effects of wind the cases are simulated with and without wind effects the wind speed is set to 5 36 m s from north to south in fig 5 the algae biological model is neglected in the following simulations and will be discussed later fig 11 shows the velocity fields with and without wind effects after 5 days without wind effects the flow is driven by the inflow and outflow discharges and influenced by the topography of the lake as fig 11 a shows the velocity magnitude is larger near the inlet and outlet boundaries as well as in the area where the lake channel is narrower when wind is accounted flow patterns are more complex which is dominated by the wind effects and influenced by the topography of the reservoir more severely as fig 11 b shows the flow is dominated by wind effects and flow velocities are mostly towards south on the free surface which is in the same direction as the wind without wind effects the flow is relatively uniform in the vertical direction fig 11 c shows the velocity contours at z 347 m which is approximately 2 m below the free surface without wind effects which are close to the velocity contours on the free surface shown in fig 11 a the flow is not uniform in the vertical direction and more complex when wind is accounted the velocity contours at z 347 m in fig 11 d shows that the subsurface return flows make a substantial contribution to flows when wind is accounted fig 12 shows the algae concentration distribution with and without wind effects after 1 and 5 days fig 12 a shows that the algae are transported from the upstream uniformly to the downstream due to the uniform velocity field in the vertical direction without wind effects after 1 day since the overall velocity magnitude is much larger when wind is accounted the algae are transported much further to the downstream than without wind effects after 1 day as shown in fig 12 b furthermore the algae distribution is more complex due to the subsurface flows when wind is accounted fig 12 c shows that the algae concentration is still relatively uniform without wind effects after 5 days as fig 12 d shows the algae are well distributed in the entire zone c due to the complex flow patterns and larger velocity magnitude when wind is accounted after 5 days 4 2 biological behaviors of blue green algae blue green algae can grow very quickly in lakes and reservoirs when the water is warm and enriched with nutrients like phosphorus or nitrogen effects of different environmental factors such as nutrient irradiance temperature and salinity on algae biological behaviors are included in the model however the measurements of nutrient and salinity are not available at the current phase therefore their transports and corresponding effects on algae production are not included in the simulations the parameters used in the simulations are from the literature kromkamp and walsby 1990 tetra tech 2007 the dirichlet type boundary condition is used for the temperature at the surface and the surface temperature at time t is expressed as t s u r f a c e 20 5 sin π t d l and the day length d l 12 h the heat source is assumed to be zero the neumann type boundary condition is used for temperature at the bottom as well as the inlet and outlet boundaries the dirichlet type boundary condition is used for the algae concentration at the inlet boundary and the inflow algae concentration is zero the neumann type boundary condition is used for algae concentration at the other boundaries fig 13 a and b show the algae concentration contours with and without the biological model after 12 h at z 347 m under wind effects as the irradiance and temperature rise during the first 12 h the algae production rate increases the resultant algal bloom can be observed where the algae concentration in fig 13 b is much higher than in fig 13 a fig 13 c and d show the algae concentration contours with and without the biological model after 24 h at z 347 m as the irradiance and temperature drop during the next 12 h the algae production rate decreases and the basal metabolism rate becomes dominate which causes the algae concentration to decrease the resultant algae concentration with biological effects shown in fig 13 d is much less than the algae concentration without biological effects shown in fig 13 c 4 3 comparison of simulated and measured data in milford lake another test was simulated to compare the simulated and measured data in milford lake from 6 00 p m july 26 2015 to 2 p m july 27 2015 the test period was limited to 20 h due to the available measurement data the initial algal concentration distribution fig 14 was estimated based on the measurement data foster et al 2017 at 6 p m on july 26 2015 wind speed fig 15 and direction fig 16 were set based on the measurement data national oceanic and atmospheric administration 2018 the surface irradiance and temperature were estimated for using sinusoidal functions figs 17 and 18 where sunrise was assumed to occur 12 h after test starts the nutrient and salinity were assumed to not affect algal population dynamics in milford lake and used a value of 1 for f 1 n and f 4 s in eq 27 because algal blooms mainly form in freshwater eutrophic and hypereutrophic systems like milford lake which is filled with growth limiting nutrients wang et al 2017 overall the algal concentration distribution at 2 p m july 27 2015 fig 19 did not change too much comparing to the initial condition fig 14 during the 20 h test as the test period is relatively short for both physical transport and algal population dynamics to process the simulated surface algal concentration history near point a in fig 5 was compared to measurement data foster et al 2017 in fig 20 the trends of simulated results did not always agree with the trends of measurement data a substantial increase was shown between 11 p m and 4 a m by the simulated results meanwhile a decrease was shown by the measured data on the other hand the increase of surface algal concentration was shown by both simulated and observed data considering that the fasting changing wind speed and direction figs 15 and 16 were only measured every hour about 20 kms from milford lake the differences were probably due to uncounted and inaccurate wind data in reality variable wind gusts could bring wind mixing causing algal colonies to sink below 0 31 m where the comparisons were made the overall wind speeds decreased in the last 10 h of the simulation and the differences between the simulated and observed data diminished the initial algal concentration distributions were estimated due to the lack of vertical and horizontal measurement data in the entire lake which unavoidably led to the differences in the comparison the parameters used in the algal biological model were from the literature tetra tech 2007 which could also make simulation results different from measurement data and they should be calibrated in the future study when more observed data are available 5 conclusions a three dimensional computational model for nonhydrostatic free surface flow and blue green algae transport is investigated in this study the hydrodynamic model solves the reynolds averaged navier stokes equations using a semi implicit fractional time step finite difference method on a staggered cartesian grid the hydrodynamic model is further improved by including a mixing length turbulence model to determine vertical eddy viscosity the convective terms are discretized by an explicit second order upwind scheme in space which is more efficient and can reach higher order accuracy comparing to the eulerian lagrangian method used in the previous studies furthermore the effects of wind and bed shear stresses are addressed the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the hydrodynamic model is verified and validated by comparing the simulation results with analytical solutions and measurements the resultant scheme is second order accurate in both time and space the nonhydrostatic free surface model is coupled with an algae model that simulates both the physical transport and biological behaviors of blue green algae the algae model determines the physical transport buoyancy vertical migration and biological behaviors of algae based on environmental factors including water depth flow velocity irradiance nutrients temperature and salinity the performance of the scheme is substantially improved by implementing parallel computing techniques into the program as an example the model is used to study the transport and biological behaviors of blue green algae in milford lake the effects of wind on algae transport and the biological behaviors of algae due to different environmental factors are simulated and analyzed the simulation results show that most algae stay in zone c in milford lake due to the substantial impacts of subsurface return flows under wind conditions the results of this study including the water circulation physical transport and biological behaviors of algae under different environmental conditions provide useful guidance for water quality management and predicting algal blooms in milford lake as the first three dimensional computational model coupling nonhydrostatic free surface flow and blue green algae the current model is a unique robust and efficient way to study not only the physical transport but also the biological behaviors of blue green algae in lakes and reservoirs and can be applied to other surface water systems efficiently the current model neglects horizontal eddy viscosity terms for large shallow water bodies as the horizontal eddy viscosity terms are typically orders of magnitude smaller than the vertical eddy viscosity terms due to the large ratio of horizontal length scale to vertical length scale for different types of water bodies other turbulence models shall be used cartesian mesh is used in the current model which may not work well for very complex geometry and possibly waste computational resources for unnecessary cells future studies should consider the limitations of the current model acknowledgements the authors would like to thank kansas department of health and environment kdhe for providing financial support grant number 2017 mil2 and kansas water office kwo as well as us army corps of engineers for providing measurement data for the study 
22759,algal blooms pose severe ecological and economical threats to estuaries and marine systems in this study a three dimensional model coupling nonhydrostatic free surface flow with algae transport and its biological behaviors is presented the hydrodynamic model solves the reynolds averaged navier stokes equations using a semi implicit fractional time step finite difference method on a staggered cartesian grid the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the scheme is verified and validated by comparing simulation results with analytical solutions and measurements the hydrodynamic model is coupled with an algae transport and biological model the biological model simulates the buoyancy vertical migration and biological behaviors of blue green algae based on different environmental factors such as nutrients irradiance temperature and salinity the model is used to analyze transport of blue green algae in milford lake which is the largest man made lake in kansas suffering from algal blooms the results of this study provide useful guidance for water quality management and predicting algal blooms in milford lake for the first time nonhydrostatic free surface flow algae transport buoyancy migration and biological production are included in one three dimensional computational model which can be used to study other estuaries and marine systems efficiently keywords algal blooms algae transport computational fluid dynamics nonhydrostatic free surface flow 3d hydrodynamic ecological modeling 1 introduction algal blooms happen in both estuaries and marine systems doscher and davies 2015 oh et al 2012 zhang et al 2015 shows harmful toxins released by blue green algae can cause liver damage and cancer to humans as well as other fatal disease to pets livestock and aquatic animals that live in or drink from the algae contaminated water it is important to understand not only the physical transport but also biological behaviors of algae in surface water systems studies blottière et al 2014 cao et al 2006 ishikawa et al 2002 moreno ostos et al 2009 show that physical transport of algae is dominated by water circulation and wind induced waves have strong impacts affecting the vertical motions of algae in the water column experiments kromkamp and walsby 1990 walsby 1987 show that the density of algae colony changes subjected to diurnal light cycle based on the previous studies ma et al 2014 paerl et al 2011 xu et al 2010 different environmental factors including nutrients irradiance temperature and salinity vary in the water column and need to be considered for the biological process of algal blooms therefore a comprehensive three dimensional 3d model is required to include all the covariant influencing factors to simulate the physical transport and biological behaviors of algae in surface water bodies in the literature tetra tech 2007 the environmental fluid dynamic code efdc has been used which is a multifunctional computational modeling system capable of simulating hydrodynamics sediment transport algal transport and production as well as other water quality constituent transport in one two and three dimensions during the past two decades efdc has been applied to over 100 surface water bodies including rivers lakes reservoirs wetlands estuaries and coastal regions for water quality assessments ji et al 2001 kim et al 1998 kuo et al 1996 luo and li 2009 park et al 2005 1995 shen et al 1999 wu and xu 2011 the hydrostatic primitive equations are solved in efdc and other hydrostatic models blumberg and mellor 1987 casulli and cattani 1994 casulli and cheng 1992 leendertse 1989 stelling and leendertse 1992 however 3d hydrostatic models can be ill posed when dealing with open boundaries shown in studies mahadevan et al 1996 oliger and sundström 1978 casulli 1999 mentions that the hydrostatic assumption is not valid when fluid flows over rapidly varying slopes and short waves where the ratio of the vertical to horizontal scales is not sufficiently small therefore a 3d computational model including nonhydrostatic free surface flow algae transport and its biological behaviors is needed in this study based on the previous experience of our research group in 2d numerical simulations han and zhang 2016 zhang et al 2011 2013 2014 of constituent transport in surface water bodies a 3d model for nonhydrostatic free surface flow is developed and further improved the hydrodynamic model solves the reynolds averaged navier stokes equations by a semi implicit fractional time step finite difference method on a staggered cartesian grid where the hydrostatic components are determined first and the nonhydrostatic pressure and other components are determined in a subsequent step based on casulli 1999 casulli and stelling 1998 liu et al 2017 the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the above scheme is further developed by including a mixing length turbulence model rodi 1984 which is widely used in hydraulic turbulent flows lesser et al 2004 reichert et al 2001 rodi 1987 1984 the convective terms are discretized by using an explicit second order upwind scheme zhang et al 2011 in space which is more efficient and can reach higher order accuracy comparing to the eulerian lagrangian method casulli and cheng 1992 cheng et al 1984 used in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 the resultant algorithm is second order accurate in both time and space after the hydrodynamic model is developed it is coupled with an algae model which not only simulates the physical transport but also biological behaviors of algae in surface water systems numerical simulations of algae transport are typically predicted by solving the convection diffusion equation for algae concentration hedger et al 2004 some studies kromkamp and walsby 1990 walsby 1987 emphasize the impacts of temporal and spatial light intensity on the rate of change of colony density however the biological production subjected to different environmental factors is missing efdc tetra tech 2007 can simulate the biological behaviors of algae but the vertical algae velocity is assumed to be constant which fails to track the density changes in colony subjected to diurnal light cycle this study is the first 3d nonhydrostatic free surface flow computational model that includes algae transport buoyancy vertical migration and biological production the vertical migration of algae is calculated based on buoyancy density changes of a colony at a given depth and time based on irradiance kromkamp and walsby 1990 the algae production rates at different water depths are calculated based on the effects of different environmental factors including nutrients irradiance temperature and salinity according to efdc tetra tech 2007 while the simulation method is robust it requires large amounts of computational time when applied to fully nonhydrostatic flows in this study the performance of the model is substantially improved by implementing parallel computing techniques into the program as an example the model is used to analyze transport of algae in milford lake which is the largest man made lake in kansas suffering from algal blooms first the effects of wind on algae transport in milford lake are studied then the vertical migration and biological behaviors of algae are simulated and analyzed the findings of this study provide useful guidance for water quality management and predicting algal blooms in milford lake the current model is a robust and efficient way to model algae transport and its biological behaviors and can be applied to studies of other surface water systems effectively 2 numerical methods 2 1 hydrodynamic model the hydrodynamic model solves the reynolds averaged navier stokes equations for incompressible flow which can have the following form pedlosky 1992 1 u t u u x v u y w u z p x x a h u x y a h u y z a v u z f v 2 v t u v x v v y w v z p y x a h v x y a h v y z a v v z f u 3 w t u w x v w y w w z p z x a h w x y a h w y z a v w z g where x y and z are the cartesian coordinates x from west to east y from south to north and z vertical pointing upward t is the time u v and w are the velocities in the x y and z directions respectively p is the normalized pressure defined as the pressure divided by a constant reference density a h and a v are the horizontal and vertical eddy viscosity coefficients respectively f is the coriolis frequency and g is the gravitational acceleration the mass conservation is expressed by the continuity equation for incompressible flows 4 u x v y w z 0 integrating eq 4 over depth and using the kinematic boundary conditions at the free surface and bottom yields the following free surface elevation equation casulli 1999 5 η t x h η u d z y h η v d z 0 where η is the free surface elevation and h is the water depth measured from the undisturbed water surface similarly casulli and cheng 1992 and wu et al 2000 used free surface kinematic condition to determine the free surface volume of fluid vof method liu and garcia 2008 is another popular way to track the free surface however the method above cannot capture the water surface of sharp interfaces and are limited to courant number less than unity then sattar et al 2017 developed a finite area method fam which tracks free surface by interface tracking that addresses the issues the normalized pressure p in eqs 1 3 includes both the hydrostatic and nonhydrostatic pressure terms which can be expressed as casulli 1999 6 p x y z t g η x y t z q x y z t where q is the nonhydrostatic pressure component substituting eq 6 into eqs 1 3 and neglecting the coriolis frequency yields 7 u t u u x v u y w u z g η x q x x a h u x y a h u y z a v u z 8 v t u v x v v y w v z g η y q y x a h v x y a h v y z a v v z 9 w t u w x v w y w w z q z x a h w x y a h w y z a v w z g where the hydrostatic approximation is made eq 9 is neglected and q 0 is assumed throughout in applications to large shallow water bodies such as lakes and reservoirs the ratio of horizontal length scale to vertical length scale is very large as a result the horizontal eddy viscosity terms are typically orders of magnitude smaller than the vertical eddy viscosity terms and their effects are usually small therefore the horizontal eddy viscosity is neglected in this study as in other studies casulli and cheng 1992 casulli and stelling 1998 casulli 1999 liu et al 2017 the vertical eddy viscosity coefficient is determined using the mixing length model rodi 1984 10 a v l m 2 u z 2 v z 2 1 2 where l m is the mixing length defined as 11 l m κ z for κ z 0 1 h 12 l m 0 1 h for κ z 0 1 h where κ is the von kármán constant and h is the total water depth defined as 13 h η h in applications to other water bodies where the ratio of horizontal and vertical length scale is small other turbulence models liu et al 2016 zhou et al 2017 should be considered the boundary conditions at the free surface are specified by prescribing the wind stresses as smith 2006 14 a v u z τ w i n d x ρ w a v v z τ w i n d y ρ w where τ w i n d x and τ w i n d y are the surface wind shear stresses in the x and y directions respectively and ρ w is the water density the boundary conditions at the bottom are specified by expressing the bottom shear stresses as smith 2006 15 a v u z τ b e d x ρ w a v v z τ b e d y ρ w where τ b e d x and τ b e d y are the bed shear stresses in the x and y directions respectively the wind shear stress is determined as teeter et al 2001 16 τ w ρ a c d u a 2 where τ w is the wind stress ρ a is the air density u a is the wind speed and c d is the atmosphere drag coefficient appropriate for wind referenced to a height of 10 m which is determined based on the empirical formula as teeter et al 2001 17 c d 0 4 16 11 0 5 ln h 2 48 ln u a 2 then wind shear stresses in the x and y directions can be determined as 18 τ w i n d x τ w cos θ τ w i n d y τ w sin θ where θ is the wind direction measured counter clockwise from east the bed shear stresses are determined as chen 2003 smith 2006 19 τ b e d x ρ w c b u b 2 v b 2 1 2 u b 20 τ b e d y ρ w c b u b 2 v b 2 1 2 v b where u b v b are horizontal velocity components at a level z b near the bottom and c b is the bed friction coefficient determined as smith 2006 21 c b κ 2 ln z b z 0 2 where z 0 is the characteristic length 2 2 algae transport and biological model the algae transport is governed by a convection diffusion equation including the buoyancy effect hedger et al 2004 and the algae biological model is developed based on efdc tetra tech 2007 the combined algae transport and biological model can be expressed as 22 c t u c x v c y w c z v a c z x a h s c t c x y a h s c t c y z a v s c t c z p b m p r c where c is the algae concentration v a is the stokes velocity s c t is the turbulent schmidt number p is the production rate b m is the basal metabolism rate and p r is the predation rate the stokes velocity is determined using a modification of the stokes equation given as kromkamp and walsby 1990 23 v a 2 g r 2 ρ c ρ w 9 φ n where r is the colony radius ρ c is the algae density φ is the algae form resistance factor and n is the dynamic viscosity of water the algae density is calculated as kromkamp and walsby 1990 24 ρ c t 2 ρ c t 1 δ t c 1 i z i z k i c 2 i a c 3 where ρ c t 2 is the buoyancy density at the current time step ρ c t 1 is the buoyancy density at the previous time step δ t is the time step size c 1 is the rate constant of density increase c 2 is the rate constant of density decrease c 3 is the minimum rate of density decrease i d is the irradiance at local depth d i a is the average irradiance experienced in the previous day and k i is the half saturation irradiance for a maximum rate of density increase the irradiance at local depth d is determined as kromkamp and walsby 1990 25 i d i 0 e ε d where i 0 is the surface irradiance and ε is the extinction coefficient the surface irradiance at time t is expressed as kromkamp and walsby 1990 26 i 0 i m sin π t d l where i m is the irradiance at noon and d l is the day length from dawn to dusk the algae production rate p is calculated based on nutrient availability ambient light temperature and salinity which can be expressed based on efdc tetra tech 2007 as 27 p p m f 1 n f 2 i f 3 t f 4 s where p m is the maximum growth rate under optimal conditions f 1 n is the effect of suboptimal nutrient concentration 0 f 1 1 f 2 i is the effect of suboptimal light intensity 0 f 2 1 f 3 t is the effect of suboptimal temperature 0 f 3 1 and f 4 s is the effect of salinity 0 f 4 1 the details for the effects of different environmental factors are listed in the literature tetra tech 2007 the 3d heat transport equation is wu 2007 28 t t u t x v t y w t z x a h p r t t x y a h p r t t y z a v p r t t z q t ρ w c p where t is the local temperature p r t is the turbulent prandtl number q t is the heat source rate per unit volume and c p is the specific heat the salinity transport equation is wu 2007 29 s t u s x v s y w s z x a h s c t s x y a h s c t s y z a v s c t s z where s is the local salinity 2 3 numerical scheme a staggered cartesian grid is used for the simulations the physical domain is divided into n x n y n z rectangular cells of length δ x width δ y and height δ z each cell is numbered at its center with indices i j and k the discrete u velocity is defined at half integer i and integers j k v is defined at integers i k and half integer j w is defined at integers i j and half integer k q is defined at integers i j and k η is defined at integers i j finally the undisturbed water depth h x y is specified at u and v horizontal grid points 2 3 1 second order upwind scheme in space for transport equations here we discuss the transport equations related to algae transport first and then discuss the hydrodynamic model in the next section as mentioned earlier the horizontal eddy viscosity terms are neglected in this study as in casulli and cheng 1992 then the 3d convection diffusion equation is in the form 30 c t u c x v c y w c z z d c z where c is the variable of interest which can be algae concentration c temperature t and salinity s d is the diffusivity where d a v s c t for c and s where s c t is the turbulent schmidt number d a v p r t for t where p r t is the turbulent prandtl number the vertical velocity and source terms production rate basal metabolism rate and predation rate need to be added into eq 30 when c represents algae concentration and heat source term needs to be included when c represents temperature an explicit blended first and second order upwind scheme zhang et al 2011 in space used in the 2d simulations han and zhang 2016 zhang et al 2014 2013 is applied and further improved to discretize the convective terms in eq 30 where the first order upwind scheme in space is used for the cells next to the boundaries and second order upwind scheme in space is used for interior cells the vertical eddy viscosity terms are discretized by an implicit second order central difference approach for positive u v and w the discretized form of eq 30 can be expressed using the second order upwind scheme in space as 31 c i j k n 1 c i j k n δ t u 3 c i j k n 4 c i 1 j k n c i 2 j k n δ x v 3 c i j k n 4 c i j 1 k n c i j 2 k n δ y w 3 c i j k n 4 c i j k 1 n c i j k 2 n δ z d k 1 2 c i j k 1 n 1 c i j k n 1 δ z i j k 1 2 n d k 1 2 c i j k n 1 c i j k 1 n 1 δ z i j k 1 2 n δ z i j k n eq 31 can be rearranged as 32 c i j k n 1 f δ t d k 1 2 c i j k 1 n 1 c i j k n 1 δ z i j k 1 2 n d k 1 2 c i j k n 1 c i j k 1 n 1 δ z i j k 1 2 n δ z i j k n where f is the finite difference operator expressed as 33 f c i j k n δ t u 3 c i j k n 4 c i 1 j k n c i 2 j k n δ x i j k n v 3 c i j k n 4 c i j 1 k n c i j 2 k n δ y i j k n w 3 c i j k n 4 c i j k 1 n c i j k 2 n δ z i j k n where the vertical space increment δ z i j k is usually equal to the vertical grid size δ z except near the bottom and free surface where δ z i j k is the distance between a horizontal cell surface and bottom or free surface respectively in general δ z i j k depends on the spatial location and the time step and δ z i j k can vanish to account for complex geometries and wetting and drying purpose for each i j the set of eq 32 forms a linear tridiagonal system with unknowns c i j k n 1 in the same water column which can be solved by direct methods efficiently the above method is used to solve the convection diffusion equations for constituent transport the resultant scheme is second order accurate in space and first order accurate in time where the stability condition does not depend on the vertical eddy viscosity when an explicit first order upwind scheme in space is used casulli and cheng 1992 gives the stability condition of the scheme as 34 δ t u δ x v δ y w δ z 1 in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 the eulerian lagrangian method casulli and cheng 1992 cheng et al 1984 is used to compute the finite difference operator f the values of c at and around i j k at time t n 1 are related to the c values at and around i a j b k d at time t n furthermore i a j b k d denotes a point on the same streak line that passes through i j k at time t n 1 an interpolation formula is needed to define c i a j b k d n since a b and d are not integers in general cases the accuracy and stability of the scheme depend on the chosen interpolation formula casulli and cheng 1992 shows that the trilinear interpolation over the eight surrounding mesh points is the simplest methods to calculate c i a j b k d n even though the trilinear interpolation is the simplest interpolation method that can be used it is obviously more complicated and harder to apply comparing to the explicit second order upwind scheme in space even being extra complex the trilinear interpolation method can only reach first order accuracy in space since the upwind scheme is easier to apply and can reach higher order accuracy than the eulerian lagrangian method the upwind scheme is used in this study 2 3 2 semi implicit fractional time step finite difference method for hydrodynamic model the hydrodynamic model solves the reynolds averaged navier stokes equations with a semi implicit fractional time step finite difference method casulli 1999 casulli and stelling 1998 liu et al 2017 on a staggered cartesian grid whose stability is independent from the free surface wave speed wind stress bottom friction and vertical eddy viscosity in the first step the implicit contribution of the nonhydrostatic pressure is neglected the provisional results of velocity field and free surface elevation at the new time level are denoted by u v w and η respectively by using the θ method casulli and cattani 1994 a semi implicit discretization for the momentum eqs 7 9 are given as casulli 1999 35 u i 1 2 j k n 1 f u i 1 2 j k n 1 θ δ t δ x g η i 1 j n η i j n q i 1 j k n q i j k n θ g δ t δ x η i 1 j n 1 η i j n 1 a v δ t u i 1 2 j k 1 n 1 u i 1 2 j k n 1 δ z i 1 2 j k 1 2 n u i 1 2 j k n 1 u i 1 2 j k 1 n 1 δ z i 1 2 j k 1 2 n δ z i 1 2 j k n 36 v i j 1 2 k n 1 f v i j 1 2 k n 1 θ δ t δ y g η i j 1 n η i j n q i j 1 k n q i j k n θ g δ t δ y η i j 1 n 1 η i j n 1 a v δ t v i j 1 2 k 1 n 1 v i j 1 2 k n 1 δ z i j 1 2 k 1 2 n v i j 1 2 k n 1 v i j 1 2 k 1 n 1 δ z i j 1 2 k 1 2 n δ z i j 1 2 k n 37 w i j k 1 2 n 1 f w i j k 1 2 n 1 θ δ t δ z i j k 1 2 n q i j k 1 n q i j k n a v δ t w i j k 3 2 n 1 w i j k 1 2 n 1 δ z i j k 1 n w i j k 1 2 n 1 w i j k 1 2 n 1 δ z i j k n δ z i j k 1 2 n the finite difference operator f includes the explicit discretization of the convective terms which are discretized by the second order upwind scheme in space eq 33 in the current model instead of the eulerian lagrangian method casulli and cheng 1992 used in the previous studies casulli 1999 casulli and stelling 1998 liu et al 2017 eqs 35 and 36 constitute two sets of linear tridiagonal systems by substituting u and v into the discretized free surface elevation eq 5 a penta diagonal system of equations for the unknown η can be formed the details of the procedure are similar to those in casulli 1999 and therefore omitted here the resultant matrix is diagonally dominant symmetric and positive definite and can be solved by the preconditioned conjugate gradient method hestenes and stiefel 1952 after the provisional free surface elevation η is determined provisional velocity components u v w can be solved using eqs 35 37 in the second step the new velocity and free surface elevation are corrected by including the nonhydrostatic pressure terms and the discrete momentum equations are expressed as 38 u i 1 2 j k n 1 u i 1 2 j k n 1 θ δ t δ x q i 1 j k n 1 q i j k n 1 39 v i j 1 2 k n 1 v i j 1 2 k n 1 θ δ t δ y q i j 1 k n 1 q i j k n 1 40 w i j k 1 2 n 1 w i j k 1 2 n 1 θ δ t δ z i j k 1 2 n q i j k 1 n 1 q i j k n 1 two sets of equations are formed by substituting eqs 38 40 into the discretized continuity equation eq 4 and free surface equation eq 5 and the equations form two hepta diagonal systems which are diagonally dominant symmetric and positive definite thus the equations can be solved by the preconditioned conjugate gradient method hestenes and stiefel 1952 finally the new velocity and free surface elevation are corrected by including nonhydrostatic pressure the detailed procedure is also addressed in casulli 1999 the final velocity field is locally and globally mass conservative in addition the unsolved terms in casulli 1999 such as vertical eddy viscosity wind and bed stress coefficients are determined using eqs 14 21 the resultant algorithm is second order accurate in both space and time it may require large amounts of computational time when the scheme is applied to fully nonhydrostatic flow especially under wind conditions to improve the computational efficiency the program is parallelized using the message passing interface mpi by domain decompositions instead of using the preconditioned conjugate gradient method hestenes and stiefel 1952 the matrices of free surface elevation and nonhydrostatic pressure in the hydrodynamic model casulli 1999 are solved using the ksp solver in portable extensible toolkit for scientific computation petsc balay et al 2014 the parallel scalability of the current model is compared with the theoretical speedups based on amdahl 1967 shown in fig 1 3 verification and validation 3 1 verification case the numerical method presented above is validated by comparing simulation results with analytical solutions and measurement data the verification case is to test a two dimensional standing wave in a square basin whose length l and depth h are 10 m the flow is driven by the following initial sinusoidal free surface elevations along the x axis at t 0 41 η 0 1 cos π l x based on the dispersion relation lamb 1945 the analytical solution for this standing wave is 42 η x t 0 1 cos k x cos σ t where the wavenumber k 2 π λ the wave length λ 2 l the angular frequency σ 2 π f the frequency f c λ and c is the wave celerity approximately by the following dispersion relation for sufficiently small wave amplitude casulli 1999 as 43 c g λ 2 π tanh 2 π h λ a grid size of 0 0625 m in both the horizontal and vertical directions and a time step of 0 0001 s are used to simulate the oscillations of the standing wave for 5 s the bottom friction and vertical eddy viscosity terms are neglected fig 2 shows the free surface elevation histories over the 5 s period at x 7 5 m 8 m and 10 m obtained with the current hydrostatic nonhydrostatic simulations and the analytical solutions the nonhydrostatic simulation results agree with the analytical solutions very well which verifies the current hydrodynamic model when dealing with waves with small amplitudes with flat bottom geometries in addition four levels of grid sizes are tested to verify the order of accuracy of the current scheme the grid sizes are 0 0625 m 0 125 m 0 25 m and 0 5 m and the time step is 0 0001 s the free surface elevations at t 5 s along the x axis are used to calculate the l 2 norm errors using the analytical solution as the exact solution the l 2 norm error for mesh level l is defined as 44 e l i 1 n g r i d η i l η i e x a c t 2 n g r i d where n g r i d is the total number of nodes of given grid fig 3 shows the l 2 norm errors and the first and second order slopes on log log scale and the norms are shown to be in a second order manner when grid is refined which assures the second order accuracy in space of the current algorithm 3 2 validation case the validation case is to test the spatial evolution of steep waves propagating over a longshore bar the simulation results are compared to the scheldt flume experimental data collected by delft hydraulics beji and battjes 1994 the flume has an overall length of 30 m and the flume geometry is shown in fig 4 a starting with zero initial velocity the water level over the horizontal bottom is 0 4 m and reduced to 0 1 m over a submerged trapezoidal bar a plane beach with a slope of 1 25 is located at the end of the flume serving as a wave absorber a grid size of δ x δ z 2 5 cm and a time step of 0 001 s are used in the simulation a sinusoidal wave of amplitude 1 cm and period of 2 02 s is specified at the left open boundary the simulated free surface elevations histories at 2 m and 13 5 m from the left open boundary are compared with the measurements shown in fig 4 b and c respectively the simulation results agree with the measurement data which validates the hydrodynamic simulation when dealing with complex geometries 4 application milford lake with a surface area of 64 km 2 milford lake is the largest man made lake in kansas which is a favorite getaway for outdoor loving visitors for activities such as hunting fishing boating hiking and swimming algal blooms pose severe environmental problems in milford lake and toxins released by algae are dangerous to people and animals within the areas kansas department of health and environment kdhe monitors the concentrations of algae at multiple locations in the lake and issues public health protection notifications when the algae concentration is over the limit to better understand algal transport and blooms the current model is used to study the circulation algae transport and its biological behaviors in milford lake the spatial assessments foster et al 2017 of harmful algal blooms in milford lake which is performed by us geological survey usgs kansas department of health and environment kdhe and us army corps of engineers usace in july and august 2015 show that the algae concentration is highest in zone c among all the areas shown in fig 5 kansas hab viewer 2017 based on the measurements the inflow and outflow discharge rates are set to be 56 63 m 3 s and the initial free surface elevation is 348 81 m a time step of 2 s is used in the simulations fig 6 shows the land elevations of the computational domain using the bathymetric survey data provided by the kansas water office kwo the size of the computational domain is 18 5 km by 13 km by 22 m which is covered by a 186 131 90 finite difference mesh with the grid sizes to be δ x δ y 100 m and δ z 0 25 m based on grid independence studies first the gird sizes in the horizontal directions are fixed at 100 m and four levels of grid size in the vertical direction 1 m 0 5 m 0 25 m 0 125 m are tested the velocity component u at two locations a 4 km 9 2 km and b 10 km 10 km at different elevations at t 3600 s are plotted in fig 7 where the difference between the first two finest meshes is very small which indicates that the grid convergence has been reached therefore the vertical grid size δ z is set to be 0 25 m then four levels of grid sizes 400 m 200 m 100 m 50 m in the horizontal directions are tested the velocity component u at a and b at deferent elevations at t 3600 s are plotted in fig 8 where the difference between the first two finest meshes is very small which indicates that the grid convergence has been reached therefore the horizontal grid sizes δ x and δ y are set to be 100 m another four levels of grid sizes are tested and the grid sizes of each level are δ x δ y 400 m δ z 2 m δ x δ y 200 m δ z 1 m δ x δ y 100 m δ z 0 5 m δ x δ y 50 m δ z 0 25 m the velocity components u v and w at t 3600 s are used to calculate the l 2 norm errors using the solution on the finest grid as the reference solution the errors are computed for the solutions of the coarser grids in section 3 1 the l 2 norm errors are calculated on a simple geometry where the bottom is flat and the norms drop in second order manner however the norms do not change in a second order manner when dealing with complex geometries in this case this behavior is due to the different land elevations on various grid resolutions when a finer gird is used more details of the geometry are obtained and the land elevations are more accurate and closer to the measurement data however the coarser the grid is the fewer details of the geometry can be captured fig 9 shows the land elevation contours of different horizontal grid sizes 100 m and 200 m where many details of the land elevations are lost on the coarser grid since the land elevation does not change in a second order manner as the grid is refined the l 2 norm errors do not change in a second order manner either a horizontal grid size 100 m and b horizontal grid size 200 m due to lack of the measurement data the initial algae concentration is assumed to be 1000 g m 3 near the inlet boundary shown in fig 10 the simulation time is 5 days the purpose of the following simulations is to investigate the effects of different environmental factors on the circulation physical transport and biological behaviors of algae in milford lake 4 1 wind effects wind velocity on the water surface is accounted for the effect of wind stress on the flow velocity which is important since wind stress has substantial impacts on the circulation and algae transport in surface water systems to study the effects of wind the cases are simulated with and without wind effects the wind speed is set to 5 36 m s from north to south in fig 5 the algae biological model is neglected in the following simulations and will be discussed later fig 11 shows the velocity fields with and without wind effects after 5 days without wind effects the flow is driven by the inflow and outflow discharges and influenced by the topography of the lake as fig 11 a shows the velocity magnitude is larger near the inlet and outlet boundaries as well as in the area where the lake channel is narrower when wind is accounted flow patterns are more complex which is dominated by the wind effects and influenced by the topography of the reservoir more severely as fig 11 b shows the flow is dominated by wind effects and flow velocities are mostly towards south on the free surface which is in the same direction as the wind without wind effects the flow is relatively uniform in the vertical direction fig 11 c shows the velocity contours at z 347 m which is approximately 2 m below the free surface without wind effects which are close to the velocity contours on the free surface shown in fig 11 a the flow is not uniform in the vertical direction and more complex when wind is accounted the velocity contours at z 347 m in fig 11 d shows that the subsurface return flows make a substantial contribution to flows when wind is accounted fig 12 shows the algae concentration distribution with and without wind effects after 1 and 5 days fig 12 a shows that the algae are transported from the upstream uniformly to the downstream due to the uniform velocity field in the vertical direction without wind effects after 1 day since the overall velocity magnitude is much larger when wind is accounted the algae are transported much further to the downstream than without wind effects after 1 day as shown in fig 12 b furthermore the algae distribution is more complex due to the subsurface flows when wind is accounted fig 12 c shows that the algae concentration is still relatively uniform without wind effects after 5 days as fig 12 d shows the algae are well distributed in the entire zone c due to the complex flow patterns and larger velocity magnitude when wind is accounted after 5 days 4 2 biological behaviors of blue green algae blue green algae can grow very quickly in lakes and reservoirs when the water is warm and enriched with nutrients like phosphorus or nitrogen effects of different environmental factors such as nutrient irradiance temperature and salinity on algae biological behaviors are included in the model however the measurements of nutrient and salinity are not available at the current phase therefore their transports and corresponding effects on algae production are not included in the simulations the parameters used in the simulations are from the literature kromkamp and walsby 1990 tetra tech 2007 the dirichlet type boundary condition is used for the temperature at the surface and the surface temperature at time t is expressed as t s u r f a c e 20 5 sin π t d l and the day length d l 12 h the heat source is assumed to be zero the neumann type boundary condition is used for temperature at the bottom as well as the inlet and outlet boundaries the dirichlet type boundary condition is used for the algae concentration at the inlet boundary and the inflow algae concentration is zero the neumann type boundary condition is used for algae concentration at the other boundaries fig 13 a and b show the algae concentration contours with and without the biological model after 12 h at z 347 m under wind effects as the irradiance and temperature rise during the first 12 h the algae production rate increases the resultant algal bloom can be observed where the algae concentration in fig 13 b is much higher than in fig 13 a fig 13 c and d show the algae concentration contours with and without the biological model after 24 h at z 347 m as the irradiance and temperature drop during the next 12 h the algae production rate decreases and the basal metabolism rate becomes dominate which causes the algae concentration to decrease the resultant algae concentration with biological effects shown in fig 13 d is much less than the algae concentration without biological effects shown in fig 13 c 4 3 comparison of simulated and measured data in milford lake another test was simulated to compare the simulated and measured data in milford lake from 6 00 p m july 26 2015 to 2 p m july 27 2015 the test period was limited to 20 h due to the available measurement data the initial algal concentration distribution fig 14 was estimated based on the measurement data foster et al 2017 at 6 p m on july 26 2015 wind speed fig 15 and direction fig 16 were set based on the measurement data national oceanic and atmospheric administration 2018 the surface irradiance and temperature were estimated for using sinusoidal functions figs 17 and 18 where sunrise was assumed to occur 12 h after test starts the nutrient and salinity were assumed to not affect algal population dynamics in milford lake and used a value of 1 for f 1 n and f 4 s in eq 27 because algal blooms mainly form in freshwater eutrophic and hypereutrophic systems like milford lake which is filled with growth limiting nutrients wang et al 2017 overall the algal concentration distribution at 2 p m july 27 2015 fig 19 did not change too much comparing to the initial condition fig 14 during the 20 h test as the test period is relatively short for both physical transport and algal population dynamics to process the simulated surface algal concentration history near point a in fig 5 was compared to measurement data foster et al 2017 in fig 20 the trends of simulated results did not always agree with the trends of measurement data a substantial increase was shown between 11 p m and 4 a m by the simulated results meanwhile a decrease was shown by the measured data on the other hand the increase of surface algal concentration was shown by both simulated and observed data considering that the fasting changing wind speed and direction figs 15 and 16 were only measured every hour about 20 kms from milford lake the differences were probably due to uncounted and inaccurate wind data in reality variable wind gusts could bring wind mixing causing algal colonies to sink below 0 31 m where the comparisons were made the overall wind speeds decreased in the last 10 h of the simulation and the differences between the simulated and observed data diminished the initial algal concentration distributions were estimated due to the lack of vertical and horizontal measurement data in the entire lake which unavoidably led to the differences in the comparison the parameters used in the algal biological model were from the literature tetra tech 2007 which could also make simulation results different from measurement data and they should be calibrated in the future study when more observed data are available 5 conclusions a three dimensional computational model for nonhydrostatic free surface flow and blue green algae transport is investigated in this study the hydrodynamic model solves the reynolds averaged navier stokes equations using a semi implicit fractional time step finite difference method on a staggered cartesian grid the hydrodynamic model is further improved by including a mixing length turbulence model to determine vertical eddy viscosity the convective terms are discretized by an explicit second order upwind scheme in space which is more efficient and can reach higher order accuracy comparing to the eulerian lagrangian method used in the previous studies furthermore the effects of wind and bed shear stresses are addressed the algorithm is locally and globally mass conservative and can be applied to different free surface problems ranging from hydrostatic to fully nonhydrostatic the hydrodynamic model is verified and validated by comparing the simulation results with analytical solutions and measurements the resultant scheme is second order accurate in both time and space the nonhydrostatic free surface model is coupled with an algae model that simulates both the physical transport and biological behaviors of blue green algae the algae model determines the physical transport buoyancy vertical migration and biological behaviors of algae based on environmental factors including water depth flow velocity irradiance nutrients temperature and salinity the performance of the scheme is substantially improved by implementing parallel computing techniques into the program as an example the model is used to study the transport and biological behaviors of blue green algae in milford lake the effects of wind on algae transport and the biological behaviors of algae due to different environmental factors are simulated and analyzed the simulation results show that most algae stay in zone c in milford lake due to the substantial impacts of subsurface return flows under wind conditions the results of this study including the water circulation physical transport and biological behaviors of algae under different environmental conditions provide useful guidance for water quality management and predicting algal blooms in milford lake as the first three dimensional computational model coupling nonhydrostatic free surface flow and blue green algae the current model is a unique robust and efficient way to study not only the physical transport but also the biological behaviors of blue green algae in lakes and reservoirs and can be applied to other surface water systems efficiently the current model neglects horizontal eddy viscosity terms for large shallow water bodies as the horizontal eddy viscosity terms are typically orders of magnitude smaller than the vertical eddy viscosity terms due to the large ratio of horizontal length scale to vertical length scale for different types of water bodies other turbulence models shall be used cartesian mesh is used in the current model which may not work well for very complex geometry and possibly waste computational resources for unnecessary cells future studies should consider the limitations of the current model acknowledgements the authors would like to thank kansas department of health and environment kdhe for providing financial support grant number 2017 mil2 and kansas water office kwo as well as us army corps of engineers for providing measurement data for the study 
