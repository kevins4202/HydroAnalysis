index,text
4130,large scale hydrological and water resource models lhms require water storage and release schemes to represent flow regulation by reservoirs owing to a lack of observed reservoir operations state of the art lhms deploy a generic reservoir scheme that may fail to represent local operating behaviors here we introduce a new dataset of bespoke water storage and release policies for 1 930 reservoirs of conterminous united states the inferred storage targets and release functions istarf conus dataset relies on a new inventory of observed daily reservoir operations resopsus to generate reservoir operating rules for 595 data rich reservoirs these functions are developed in a standardized form that allows for extrapolation of operating schemes to 1 335 data scarce reservoirs leading to the first inventory of empirically derived reservoir operating policies for all large conus reservoirs documented in the global reservoir and dams grand database evaluation of the new scheme in daily simulations forced with observed inflow demonstrates substantial and robust improvement for both release and storage relative to the popular hanasaki method performance of the extrapolation approach for data scarce reservoirs is evaluated with leave one out validation and is shown to also offer modest gains on average over hanasaki istarf conus may be readily adopted in any lhm featuring large reservoirs of the conterminous united states keywords large scale hydrology reservoir operations data driven water management dams 1 introduction reservoir operations must be represented in large scale hydrological and water resource models lhms for reasonable estimation of the spatial and temporal distribution of water resources nazemi and wheater 2015 wada et al 2017 lack of widespread data on water release decision making has necessitated generic models of reservoir operations such generic schemes are broadly representative of reservoirs that fulfil a specific purpose rather than being tailored to each reservoir s actual operations masaki et al 2017 these generic schemes include the seminal methods of haddeland et al 2006 and hanasaki et al 2006 herein han 06 which have been adapted for a variety of lhm settings e g biemans et al 2011 voisin et al 2013 wada et al 2014 equipped with these schemes lhms have been applied successfully to a range of water research topics at global and continental scales including analyses of water scarcity veldkamp et al 2017 terrestrial water storage pokhrel et al 2021 power grid reliability voisin et al 2020 and the global value of services provided by dams boulange et al 2021 although generic schemes capture the general river regulating effects of reservoirs they remain insufficient for emerging applications that require accurate storage and release simulation at sub monthly resolution including analysis of flood and drought impacts masaki et al 2018 veldkamp et al 2018 empirically derived reservoir operations informed by local data can address these shortcomings but have thus far been confined to isolated river basins for which a complete set of observed reservoir operations records can be obtained yassin et al 2019 turner et al 2020a coerver et al 2018 macian sorribes and pulido velazquez 2017 fleischmann et al 2021 universal coverage of bespoke reservoir simulation at a large multi basin spatial scale is an aspiration that has remained unfulfilled due to the lack of a national scale reservoir operations inventory here we leverage a new dataset of observed daily reservoir operations in conterminous united states conus to develop the first national scale inventory of empirically derived reservoir operations for application in lhms we infer operating policies using a novel algorithm starfit storage targets and release function inference tool that provides a standardized and parsimonious formulation of each reservoir s inferred operating policy we apply starfit to 595 large data rich reservoirs located in conus and in canadian river basins that drain into conus herein conus the standardized formulation allows for extrapolation to data scarce reservoirs and thus the creation of a complete dataset of operations for all 1 930 large reservoirs of conus included in the global reservoir and dams grand database lehner et al 2011 we evaluate the performances of both data rich reservoirs and the extrapolation scheme relative to han 06 for release and storage simulation accuracy with observed inflow forcing the new weekly reservoir policy parameters dataset is named istarf conus inferred storage targets and release functions for conus and is accompanied by an open source software package that can be used to generate reservoir policies directly from daily reservoir operations time series github com immm sfa starfit these policies may be applied down to a daily temporal resolution in lhms 2 method 2 1 policy inference rationale and overview the starfit algorithm generates a 19 parameter reservoir operating policy comprising weekly water storage targets and release functions table 1 the algorithm is designed to provide realistic simulation of water release decisions throughout year and under varying water availability conditions starfit policies are relatively parsimonious compared to the data driven methods of yassin et al 2019 with 72 parameters six parameters defined independently for each month of the year or turner et al 2020b with 208 parameters four parameters defined independently for 52 weeks of the year unlike models that are fitted separately for individual seasons months or weeks of the year starfit employs harmonic regression to give smooth continuity across periods with relatively few degrees of freedom the parameters of these harmonics may be easily interpreted for seasonal timing and relative importance of key operating features such the use of a seasonal flood or conservation pool a robust and parsimonious model is particularly important for reservoir operations inference given data challenges which preclude traditional split sample or leave one out validation these techniques are inhibited by the relatively short records available perhaps featuring only one or two extreme events and by possible undocumented changes in actual operations occurring over period of record in other words a model may perform poorly in a validation period not because it is overfitted but because actual objectives and constraints on operations can shift at unknown points in the historical record discussion on these challenges is offered in turner et al 2020a starfit is developed to be flexible to deal with varying length quality and completeness of observational data the policy inference algorithm requires neither gap free time series nor a complete set of input variables starfit is also designed to generate policies that are transferrable to data scarce reservoirs weekly varying storage targets are specified as percent of storage capacity release functions return release decisions as percent deviation from long term mean inflow since both reservoir storage capacity and mean annual inflow are available for all large conus reservoirs via grand starfit s standardized policy formulation allows one to copy a reservoir s fitted policy and impose it on a similarly purposed neighboring reservoir by updating these two specifications this use of mean annual inflow also gives the user the ability to adjust the operations to account for inflow bias common to lhms a key feature of han 06 that is retained in our data driven approach further detail in section 4 reservoirs with storage data only i e no inflow or release records can be fitted with storage targets and then have the release functions added by copying from similarly purposed nearby reservoirs this leads to three types of reservoir policy in istarf conus fully fitted storage and release functions generated from data 449 reservoirs partially fitted storage fitted from data release functions extrapolated from similarly purposed neighboring reservoirs 146 reservoirs and extrapolated 1 335 reservoirs the key parameters of a reservoir policy in istarf conus are conveyed in fig 1 and elaborated in the following subsections following turner et al 2020b observed reservoir operations data namely daily records of storage inflow and release are first converted to a weekly resolution allowing for reasonable back calculation of inflow or release if either is missing using change in storage from start to end of each week this expands the number of reservoirs available for policy inference for each reservoir the algorithm first fits two 5 parameter harmonic functions that define the upper and lower bounds of a seasonally varying normal operating range nor of storage section 2 1 1 this range provides three operating settings normal operations below range operations and above range operations if storage levels are within the nor normal operations water release is defined using a seasonal release pattern 4 parameter harmonic function and with a single linear adjustment to account for water availability 3 parameters section 2 1 2 if storage levels drop below the nor the reservoir is assumed to be at risk of being depleted and so release is curtailed to a minimum outflow rate determined from observations if storage levels rise above the nor the operator seeks to draw the reservoir back down within a pre defined time period by increasing the release subject to a below spill crest maximum also defined using release observations minimum and maximum release constitute the final two parameters of the 19 parameter scheme all parameters associated with this model are derived solely from observations of daily storage inflow and release the actual operating purposes of each reservoir emerge from this process rather than being an input to the algorithm 2 1 1 normal operating range nor the nor for a given reservoir is a set of weekly varying maximum and minimum storage values these values are given as of reservoir capacity and they dictate when normal release operations are applied the nor is defined by first aggregating storage to weekly average values and then standardizing as a function of maximum storage capacity the general model adopted to define the nor is 1 s t μ α sin 2 π ω t β cos 2 π ω t s min μ α sin 2 π ω t β cos 2 π ω t s max s min μ α sin 2 π ω t β cos 2 π ω t s min s max μ α sin 2 π ω t β cos 2 π ω t s max for the upper bound and 2 s t μ α sin 2 π ω t β cos 2 π ω t s min μ α sin 2 π ω t β cos 2 π ω t s max s min μ α sin 2 π ω t β cos 2 π ω t s min s max μ α sin 2 π ω t β cos 2 π ω t s max for the lower bound s t and s t are fitted upper and lower bounds of the nor in week t ω is the frequency set as 1 52 to reflect the weekly resolution of the model and μ α and β are fitted parameters controlling the baseline amplitude and phase of two harmonics that define the upper and lower bounds of the nor these upper and lower bounds of the nor are fitted to the three highest storage values blue points fig 1 upper left panel and three lowest storage values pink points same figure for each week across all years respectively the use of three years protects against a nor that envelops one off extreme years while also providing a sufficiently wide nor for reservoirs that have short records of perhaps just ten years observed data resulting harmonics characterize observed storage behavior with a cyclic component to represent seasonal flood and conservation pools each harmonic is fitted with constraining parameters s min and s max s min and s max for the lower harmonic which provide flexibility to capture deep sharp peaks and troughs in the nor with possible multi week periods during which the bounds remain fixed see the lower bound of the nor at the start of the hydrological year in fig 1 for example these bounding constraints mean the function cannot be fitted using standard multiple linear regression we instead use a local gradient free optimization algorithm powell 1994 to identify the five parameters of each harmonic the optimization searches for the constrained harmonic that minimizes root mean squared error between the harmonic and the selected storage observations i e the three highest or lowest depending on whether the upper or lower harmonic is sought to guide the algorithm to a successful solution the harmonic parameters μ α β μ α β are first initialized using multiple linear regression assuming no constraints each constraint is then initialized to lie just within the amplitude of that harmonic ensuring that the objective function is sensitive to its adjustment the optimization algorithm is then run to find all parameters of the harmonics examples of fitted operating ranges defined by the upper and lower bound harmonics are given in fig 2 2 1 2 release function the nor is used to identify the reservoir s release operation mode on each time step of simulation the state of the reservoir may be normal within nor above normal or below normal operations are designed to guide storage levels back into the nor should they deviate outside it this can happen if there is a flood causing storage to breach the upper bound of the normal operating range or a prolonged dry spell causing reservoir drawdown below the nor if storage exceeds the nor the starfit algorithm sets a desired release to draw storage back into range within one week if this desired release exceeds a pre determined maximum release it will be constrained to the maximum release meaning flood conditions can still cause the reservoir to fill to capacity causing uncontrolled spill if storage drops below nor the operator has limited ability to refill the reservoir negative release is impossible in this instance starfit applies a predefined minimum release value also determined from observed records which for many reservoirs represents an environmental release requirement in simulation all releases are also constrained by basic mass balance for example release cannot exceed water available in storage plus inflow for most time periods of a reservoir simulation storage will lie within the normal operating range during such periods we assume the operator schedules the release based on three sources of information 1 week of year defined using the epidemiological week epi week beginning sunday herein referred to as the operating week 2 reservoir inflow volume during the operating week and 3 existing state of storage at the start of the operating week which we define here as the position of current storage within the normal operating range i e storage at lower bound of nor means storage state 0 storage at upper bound of nor means storage state 100 other sources of information such as known releases from upstream reservoirs operated in coordination or accurate inflow forecasts are often important in reality rouge et al 2021 but are not considered in the present approach which focuses on a method that may be readily adopted within existing lhms discussion on challenges of forecast implementation in lhms is offered in turner et al 2020a one can use data to determine a simple relation that defines release as a function of storage and inflow this release relationship should vary by time of year since releases will be adjusted depending on various seasonally varying objectives e g irrigation season snowmelt season etc to avoid reconstructing this release relationship for multiple periods leading to a heavily parameterized model we adopt the following two step approach first average weekly release is modeled using a four parameter harmonic function see example in lower left panel of fig 1 second the residuals from this average release pattern are fitted with single linear relationship that provides release adjustment from seasonal average as a function of current inflow and storage state to fit these release function parameters weekly release volume time series are first standardized around 0 by presenting as fractional deviation from long term mean inflow 3 r t r t i i where r t is the time series of weekly release volumes and i is the long term mean of inflow same units since i r i e long term mean inflow approximates long term mean release the harmonic used to model a typical seasonal release pattern may be fitted without an intercept parameter i e centered on zero 4 r t α 1 sin 2 π ω t α 2 sin 4 π ω t β 1 cos 2 π ω t β 2 cos 4 π ω t where α 1 α 2 β 1 and β 2 are the four parameters unlike for the constrained harmonics that define the nor these harmonics may be identified with multiple linear regression the residuals of this harmonic ε t r t r t are then used to fit the following linear model which allows for an adjustment to the seasonal release depending on available water in storage and inflow 5 ε t c p 1 a t p 2 i t 6 i t i t i i where a t is the availability status equal to the fractional position of the storage within the normal operating range at the start of the operating week 0 a t 1 i t is standardized inflow and c p 1 and p 2 are regression coefficients by separating inflow and storage as separate inputs rather than a single water availability value the model has flexibility to account for operations driven by either variable the model is discarded i e all three parameters set to zero if it performs with an r squared value less than 0 3 suggesting poor fit or if the p 1 or p 2 coefficients are negative which is illogical since it would suggest lower release with greater water available if the linear model is discarded the release will be a function time of year only following the harmonic function without further adjustment for water availability with the parameters of the release harmonic and adjustment function set the implementation of the release decision making is 7 r t min i r t ε t i r max s t s t s t m i n s c a p s t s t i t r m a x s t s t r min s t s t where r t is the targeted release and s t is the storage volume s t as a percentage of storage capacity s cap parameters r max and r min are the final two parameters of the 19 parameter model these parameters are determined using the 95th and 5th percentile values of the release observations the software that supports this study allows this setting to be adjusted easily actual release implemented in simulation is then equal to the targeted release r t subject to mass balance constraints if the reservoir exceeds capacity all excess water must be spilled if the targeted release cannot be met with existing water available it is constrained to physical water available in storage plus inflow 8 r t max min r t i t s t i t s t s cap 2 2 application of starfit to resopsus the resopsus inventory of observed reservoir operations includes daily storage release and inflow records with varying levels of length and completeness for 678 large conus reservoirs some records include lengthy gap free time series of daily storage release and inflow while others feature significant gaps or may lack observations for a key variable although the starfit algorithm can glean a policy from incomplete records or cases with a missing inflow or release variable not all records in 678 are suitable for policy inference after removing pre 1995 data to avoid fitting policies to out of date operations we discard records that have less than at least ten full years of daily storage values for nor identification and five full years of either inflow or release for release function identification some reservoirs benefit from storage data sufficient to fit nor but lack release or inflow data sufficient for release function identification these cases may be fitted with a nor and can then adopt a neighboring similarly purposed reservoir s standardized release function as described in 2 3 resopsus provides adequate data for 449 reservoirs with storage targets and release functions and 146 reservoirs with storage targets only a total of 595 reservoir policies in istarf conus may be considered fitted with data while the remaining 1 335 reservoir policies are extrapolated of the 449 fully fitted reservoirs 111 25 have release adjustment parameters c p 1 p 2 discarded due to weak performance in model fitting see 2 1 2 discarding of the release adjustment parameters indicates that releases during normal operating conditions are driven more by seasonal timing modeled using the harmonic than by prevailing water availability this does not necessarily indicate problematic data or weaker reservoir policy in general reservoirs with a discarded release adjustment function remain in the sample as candidates for extrapolation to data scare reservoirs 2 3 extrapolation of rules to data scarce reservoirs for 1 335 data scarce reservoirs for which we lack observed operations sufficient to employ the starfit algorithm we extrapolate inferred policies from the 595 data rich reservoirs the premise for the extrapolation procedure is that reservoirs with similar operating purposes and which face similar seasonal hydrological conditions will be operated in a similar manner for instance many reservoirs in the pacific northwest draw down storage levels to capture flood waters coming from the spring freshet while no two reservoirs will be operated in exactly the same way this feature results in a reliable winter downshift in the normal operating range for flood control reservoirs of the columbia river basin illustrated by the example of libby dam in fig 2 since the storage targets are defined in terms of capacity and release functions as deviation from long term inflow rate such rules can be simply copied from one reservoir to be imposed on another with storage capacity and long term inflow updated for the new reservoir the validity of this procedure may be examined using the data rich reservoirs one can test the performance of the extrapolation scheme by assuming that each data rich reservoir is data scarce copying its policy from a neighboring similarly purposed reservoir and simulating its storage and release behavior with observed inflow forcing see section 2 5 3 extrapolation to data scarce reservoirs is conducted using the united states geological survey s standardized river basins these basins are known as hydrologic units and are defined using hydrologic unit codes hucs conterminous united states is divided into 18 major hydrological regions known as huc2s e g california pacific northwest great lakes etc which are further subdivided into approximately 200 river basins known as huc4s for a given data scarce reservoir data rich reservoirs within the same huc4 are first identified these reservoirs are then ranked according to the degree to which their operating purposes align based on four objectives recorded as a boolean variable in grand namely flood hydropower irrigation and water supply to compute the operating alignment between reservoirs we sum the number of matches four matches would represent a perfectly aligned reservoir and 0 matches would mean that the reservoirs share no operating objectives if the huc4 features no reservoirs with operating alignment 1 match the larger huc2 basin is searched for a better match if there are multiple reservoirs with an equal number of matches the closest dam distance wise is selected one exception is in the great lakes huc2 basin where resopsus has no suitable records for policy inference reservoirs in this region copy from best aligned reservoirs from the closest neighboring huc2 region depending on reservoir on the periphery of the great lakes region data scarce reservoirs located regions where data are limited in general such as the great lakes new england mid atlantic and south atlantic gulf tend to rely heavily on small number of data rich reservoirs within the same huc2 in contrast data scarce reservoirs located in data rich regions may copy rules from a much larger sample of nearby similarly purposed reservoirs fig 3 2 4 performance testing 2 4 1 daily simulation of reservoir policies with observed inflow the performance of the starfit scheme is tested at a daily time step which is a common temporal resolution adopted in lhms we use daily observed inflow to force each reservoir model allowing for evaluation of simulated release and storage relative to observations weekly resolution policies can be simulated and tested at daily resolution following an approach similar to turner et al 2020a on each day of simulation the normal operating range is determined based on the current operating week storage level then determines the mode of operation for that day normal above normal below normal as described above during normal operations the fitted release function provides weekly release as a function of current period weekly inflow and water in storage in daily simulation the full week s inflow is unknown but can be forecasted we simulate with a week ahead persistence forecast meaning the current day s total mean inflow rate is assumed constant over the following seven days to give a weekly flow volume the weekly release volume may then be determined and a day s worth of that release volume weekly release divided by seven is implemented in simulation as the simulation steps forward to the next day a new weekly flow forecast and associated release are generated two daily simulations are evaluated first daily release is simulated with storage fixed to observed values this simulation isolates the performance of the storage targets and release functions independent of storage simulation performance second daily release and storage are simulated together this simulation and resulting release and storage behaviors indicate the performance of the model with error in release allowed to accumulate through storage errors thus affecting the next day s release decision this latter simulation provides a more accurate indication of model performance when exposed to an actual lhm simulation in which storages are simulated although starfit can fit policies to reservoirs with gaps in the observational record or with either inflow or release missing the performance test requires reservoirs replete with lengthy 5 years continuous observed inflow to drive the simulation results are reported for 273 reservoirs with sufficient inflow data to conduct daily performance evaluation 2 4 2 benchmark simulation performances are benchmarked against han 06 which is conceptually similar to a variety of other generic reservoir schemes e g biemans et al 2011 voisin et al 2013 and is considered the benchmark to improve upon for reservoir operations in lhms boulange et al 2021 han 06 sets provisional annual and monthly release targets to represent interannual and seasonal release patterns for each reservoir provisional annual release is modeled as a linear adjustment to mean annual inflow depending on the volume of water in storage at the beginning of the operational year specifically the provisional annual release is equal to mean annual flow multiplied by the fractional deviation of storage from a predefined alpha constant monthly provisional release depends on reservoir purpose han 06 categorizes a reservoir as either irrigation or non irrigation for the irrigation reservoirs within year variation in the release is determined by seasonality in downstream irrigation water demand allocated to that reservoir downstream demand is allocated among multiple upstream reservoirs proportional to their mean annual inflow for non irrigation reservoirs the monthly provisional release is set to the mean annual flow rate finally han 06 adjusts the provisional monthly release to obtain actual monthly release the mode of adjustment depends on the ratio of reservoir storage volume to annual inflow volume termed c for reservoirs with c 0 5 monthly release is assumed to be independent of monthly inflow and for reservoirs with c 0 5 monthly inflow is factored into the release to avoid over frequent fill and spill cycles daily releases are updated for minimum and maximum storage as well as a minimum flow release in this study we simulate han 06 with alpha storage constant parameter set to 85 of capacity as recommended in hanasaki et al 2006 we set downstream demand using the mosart wm large scale hydrological and water management model as configured in voisin et al 2017 2 4 3 metrics we compute three metrics to compare performances of starfit to han 06 these are 1 normalized rmse nrmse where the rmse is normalized by dividing by standard deviation of the observations 2 normalized rmse of above standard operating level periods nrmse meaning the data are filtered for periods in which the observed reservoir storage is above the normal operating range this is test of operations performance during high inflow periods and spill 3 normalized transformed rmse ntrmse where the simulated and observed releases are first transformed using a box cox transform with lamba 0 3 van werkhoven et al 2009 this transformation puts greater weight on low flow periods the nrmse is closely related to the commonly used nash sutcliffe efficiency nse while providing strictly non negative error values useful in our assessment for log scale plotting that are interpretable and easily compared to the other nrmse metrics all three metrics are computed for each of the two release variables namely daily release simulated with observed storage rs obs indicating performance of the the release decisions independent of storage error daily release simulated with simulated storage rs sim indicating performance of combined storage and release simulation we also compute these metrics on daily simulated storage s versus observed storage for each reservoir 2 4 4 leave one out test for extrapolation approach reservoirs with extrapolated rules cannot be evaluated using the approach described above since they lack observed data to drive the simulation and benchmark outputs however the general extrapolation approach may be evaluated with a leave one out method wherein a data rich reservoir is assumed to be data scarce the target reservoir copies the standardized nor and release function from a neighboring similarly purposed reservoir as described in 2 3 and is then evaluated using the performance evaluation approach described above results derived from this extrapolation test are reported separately with the label starfitx we also evaluate two alternative extrapolation settings which are designed to reveal the relative importance of reservoir purpose and distance to the performance of the extrapolation the first of these alternatives setting x1 targets similarly purposed reservoirs within the same river basin but choses the farthest reservoir rather than the closest in cases where multiple reservoirs of equally good operational alignment are found this setting reveals the importance of physical distance to extrapolation performance setting x2 disregards the reservoir purpose entirely and instead copies the closest reservoir by distance this setting reveals the importance of reservoir purpose in the extrapolation scheme 3 results 3 1 performance of starfit and starfitx starfit provides robust performance improvements relative to han 06 across all variables and metrics examined fig 4 for data rich reservoirs starfit reduces error of simulated daily storage s release rs sim and release assuming observed storage rs obs for 87 and 71 78 and 85 91 of reservoirs respectively depending on performance metric assessed average magnitude of improvement with starfit is significant with 64 67 reduction in median nrmse for simulated storage s and 15 20 reduction in median nrmse for release both rs obs and rs sim relative to han 06 table 2 reservoirs that adopt policies from similarly purposed neighboring reservoirs are also improved on average over han 06 starfitx reduces storage error relative to han 06 for 61 of reservoirs while associated simulated releases rs sim are improved for 65 71 of reservoirs unsurprisingly starfitx underperforms starfit we find no obvious common features leading to greatest losses in performance in the starfitx relative to starfit neither reservoir specifications storage size purpose etc nor reservoir parameter values are correlated with performance deterioration in extrapolation mode starfitx requires both storage targets and release functions to be copied from neighboring similarly purposed reservoirs results for rs obs storage set of observed rather than simulated with starfitx show decreased performance relative to han 06 on average as well as decreased performance relative to rs sim this occurs because observed storage values often deviate outside an over narrow nor copied from another reservoir causing frequent use of maximum and minimum release constraints at inappropriate times the issue is less prominent for nrmse flood performance because the upper bound of nor is often close to reservoir capacity making it more amenable to successful copying overuse of minimum release is avoided if storage is simulated rs sim and guided back inside the normal operating range simulated storage in turn suffers a performance reduction when the copied nor is unrepresentative of actual typical storages although these finding highlight fallibility in copying the nor from another reservoir performance of s and rs sim storage suggest that this is still preferable to han 06 in most cases performances of starfit and starfitx vary widely across reservoirs we observe some very substantial gains in performance over han 06 in some cases fig 5 see supplementary materials for similar plot with absolute values instead of performance relative to benchmark for storage simulation reductions in nrmse of 75 are observed for 35 of reservoirs with starfit and 15 of reservoirs with starfitx we find no particular category of reservoir for which performance improvements are greatest or most robust in general for example improvements for reservoirs with large storage capacity 3 000 mcm are distributed similarly the whole sample as highlighted in fig 5 reservoirs that lack the release adjustment parameters which are discarded in one quarter of reservoirs due to poor fit of release with respect to water availability do not perform significantly better or worse than those fitted with these functions either starfit underperforms relative to han 06 in 13 of dams and 25 of dams for simulated storage and release respectively this is usually caused by over constrained maximum or minimum release operations that are difficult to guide with data e g release decisions outside of the nor often underperform han 06 other instances of relative underperformance arise in cases with short periods of continuous release data less than1 year to perform the daily evaluation we require five years inflow data to drive the simulations but for a small number of cases the observations of release or storage are incomplete during this period in many of these cases we would expect starfit to exceed han 06 performance with a lengthier sample in general stronger performance gains could be harnessed with further data extensions and refinements to resopsus as well a more nuanced approach to defining maximum and minimum release constraints which is out of scope for the present study starfitx is evaluated by assuming that each data rich reservoir is data scarce and then copying from a similarly purposed neighboring reservoir assessing starfitx using data rich reservoirs raises the possibility of bias in overall performance since most of these reservoirs are located in regions where other reservoirs are situated in other words a data scarce reservoir in california is more likely to find a similarly purposed nearby reservoir to copy than a data scarce reservoir in new england where reservoirs with data are less prevalent to demonstrate that this potential bias is absent we show distributions of performance improvement in both starfit and starfitx relative to han 06 across individual huc2 regions of conus fig 6 see supplementary materials for similar plot with absolute values instead of performance relative to benchmark robust improvement of starfit and starfitx relative to han 06 in both simulated release and storage is found for all almost all regions there is no apparent correlation between deterioration of performance in starfitx relative to starfit and data prevalence of region one region where starfitx performances drop dramatically relative to starfit is the pacific northwest a region with excellent reservoir operations data coverage complex or highly tailored operating arrangements for environmental flows hydropower production and flood control may make operating rules for these reservoirs less amenable for transfer to other reservoirs despite this effect starfitx still offers improvements for this region relative to han 06 for storage simulations on average 3 2 alternative extrapolation settings evaluation of alternative extrapolation settings x1 farthest similarly purposed reservoir within basin and x2 closest reservoir by distance disregarding operational purpose show that the chosen extrapolation strategy x is prudent both settings x1 and x2 result in a modest increase the median error score and decrease in number of reservoirs improved relative to han 06 table 3 these reported impacts are nullified somewhat by the fact that many reservoirs are copying from the same target reservoirs irrespective of the extrapolation scheme for example often there is only one reservoir in a huc4 basin that has close operational alignment to the target in those cases x and x1 will be result in the same target reservoir in some cases the best aligned reservoir operationally will also be the closest by distance and in those cases settings x and x2 will copy from the same reservoir for setting x1 approximately 37 of evaluated reservoirs change the target reservoir and approximately 60 of these underperform starfitx for setting x2 about half of reservoirs change the target and of these 65 underperform starfitx these results show indicate that copying the operating policy from a remote reservoir within good operational alignment and within the same hydrological unit can be a legitimate strategy in many cases 4 discussion the performance enhancements in both simulated storage and release reported above indicate that use to istarf conus would markedly improve on han 06 for reservoirs where sufficient training data are available n 595 and would in most cases also outperform han 06 when operating rules are copied from a similarly purposed reservoir in the same river basin n 1 335 these results indicate that istarf conus can be readily adopted in conus scale lhms or global hydrological models that simulate large conus reservoirs performance improvements in an lhm simulation may differ to what we found in this study in which observed inflow forcing was applied lhms may feature significant inflow bias due to error in climatic forcing as well as representation of physical catchment processes flow routing and upstream water consumption and regulation however istarf conus will retain strong advantages over generic schemes irrespective of inflow conditions particularly storage representation guided by the targeted operating range and by extension a reservoir s ability to buffer extreme floods or sustain supply during prolonged drought the significant difference in performance between starfit and starfitx highlights what could be gained with increased access to reservoir operations records of storage inflow and release our operations are trained using resopsus the most comprehensive multi agency inventory of multi decadal reservoir operations available for the united states many of the reservoirs we label data scarce are in fact measured at regular intervals and have documented records that could perhaps be collected through further agency outreach and survey although only covering a few years of operations new satellite based reconstructions of reservoir storage levels may also be introduced to extend and supplement reservoir observational records cooley et al 2021 these data could be used to estimate the normal operating range for each reservoir combined with reanalysis climate to drive historical river flow simulations they could also be used to back calculate weekly release and thus develop storage and release schemes for the united states or globally by computing all release decisions relative to mean long term inflow istarf conus gives the user the ability to adjust operations for reservoirs subject to inflow bias this may be achieved without redefining the release model parameters but instead by substituting mean inflow i applied in eq 7 with average long term inflow determined in a prior simulation of the lhm accounting for inflow bias in this way would result in reservoir release propagating the bias downstream while maintaining realistic storage levels to accommodate flood or drought this feature also provides the capability to adjust operations for a changing climate dynamically within the simulation for example by updating the mean annual inflow every ten years of simulation as climate conditions evolve starfit is one of many possible approaches one could follow to infer reservoir operating policies one alternative is to identify the operating objectives of the reservoir describe those objectives in a single mathematical function and optimize a policy using stochastic dynamic programming castelletti et al 2008 this approach could allow for more realistic operations under changing conditions giudici et al 2021 although determining representative operating objectives across a large sample of reservoirs presents a significant challenge machine learning methods aimed reproducing historical decisions could be another avenue to explore although these models require much longer sequences of data than are available for the problem of identifying a reservoir policy irrespective of the method employed there is a limit to how well actual reservoir operations can be represented in a typical large scale hydrological simulation in which reservoir operations lack forecast information and are uncoordinated actual reservoir operators often use medium to long range forecasts to guide operations with varying lead times throughout the typical operating year and realistic representation of such forecasts in an lhm simulation remains a significant challenge even if forecast use is well described in the operating policy turner et al 2020a coordination of reservoir releases within a river basin is another important driver of decision making not well accommodated in lhms rouge et al 2021 a dataset of observations like resopsus could be applied to study the important effects of reservoir system coordination and develop models to represent this within an lhm this would impose a significant computational burden that may make such advances impractical at this time 5 conclusions this study presents istarf conus a new dataset of water storage and release policies for all 1 930 large reservoirs of conus and its associated policy inference algorithm starfit performance evaluation of this scheme shows that it offers substantial and robust simulation improvement over a state of the art approach adopted in many lhms performance enhancements are most significant for simulated storage which is guided by a normal operating range identified by the inference algorithm improved storage representation also benefits release since release is a function of storage even though most conus reservoirs lack data sufficient to train these operating schemes we show that a simple extrapolation of policies from similarly purposed neighboring reservoirs that are replete with operating data will still yield modest enhancements over conventional practice on average the overall performance of the scheme will improve as and when more observational data are added istarf conus can be readily adopted into any lhm that represents large conus reservoirs or may be analyzed for insight into the diverse range of operating strategies employed in united states dam and reservoir operations 6 data statement links to data and code used to perform this experiment are available via a supporting meta repository https immm sfa github io turner etal 2021 joh this includes a link to the inventory of observed reservoir operations resopsus the istarf conus dataset of inferred reservoir operating policies is freely available at https doi org 10 5281 zenodo 4602277 and includes an implementation demo using starfit the starfit algorithm is available as an open source r library available at github https github com immm sfa starfit declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the u s department of energy office of science as part of research in the multisector dynamics earth and environmental system modeling program appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126843 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4130,large scale hydrological and water resource models lhms require water storage and release schemes to represent flow regulation by reservoirs owing to a lack of observed reservoir operations state of the art lhms deploy a generic reservoir scheme that may fail to represent local operating behaviors here we introduce a new dataset of bespoke water storage and release policies for 1 930 reservoirs of conterminous united states the inferred storage targets and release functions istarf conus dataset relies on a new inventory of observed daily reservoir operations resopsus to generate reservoir operating rules for 595 data rich reservoirs these functions are developed in a standardized form that allows for extrapolation of operating schemes to 1 335 data scarce reservoirs leading to the first inventory of empirically derived reservoir operating policies for all large conus reservoirs documented in the global reservoir and dams grand database evaluation of the new scheme in daily simulations forced with observed inflow demonstrates substantial and robust improvement for both release and storage relative to the popular hanasaki method performance of the extrapolation approach for data scarce reservoirs is evaluated with leave one out validation and is shown to also offer modest gains on average over hanasaki istarf conus may be readily adopted in any lhm featuring large reservoirs of the conterminous united states keywords large scale hydrology reservoir operations data driven water management dams 1 introduction reservoir operations must be represented in large scale hydrological and water resource models lhms for reasonable estimation of the spatial and temporal distribution of water resources nazemi and wheater 2015 wada et al 2017 lack of widespread data on water release decision making has necessitated generic models of reservoir operations such generic schemes are broadly representative of reservoirs that fulfil a specific purpose rather than being tailored to each reservoir s actual operations masaki et al 2017 these generic schemes include the seminal methods of haddeland et al 2006 and hanasaki et al 2006 herein han 06 which have been adapted for a variety of lhm settings e g biemans et al 2011 voisin et al 2013 wada et al 2014 equipped with these schemes lhms have been applied successfully to a range of water research topics at global and continental scales including analyses of water scarcity veldkamp et al 2017 terrestrial water storage pokhrel et al 2021 power grid reliability voisin et al 2020 and the global value of services provided by dams boulange et al 2021 although generic schemes capture the general river regulating effects of reservoirs they remain insufficient for emerging applications that require accurate storage and release simulation at sub monthly resolution including analysis of flood and drought impacts masaki et al 2018 veldkamp et al 2018 empirically derived reservoir operations informed by local data can address these shortcomings but have thus far been confined to isolated river basins for which a complete set of observed reservoir operations records can be obtained yassin et al 2019 turner et al 2020a coerver et al 2018 macian sorribes and pulido velazquez 2017 fleischmann et al 2021 universal coverage of bespoke reservoir simulation at a large multi basin spatial scale is an aspiration that has remained unfulfilled due to the lack of a national scale reservoir operations inventory here we leverage a new dataset of observed daily reservoir operations in conterminous united states conus to develop the first national scale inventory of empirically derived reservoir operations for application in lhms we infer operating policies using a novel algorithm starfit storage targets and release function inference tool that provides a standardized and parsimonious formulation of each reservoir s inferred operating policy we apply starfit to 595 large data rich reservoirs located in conus and in canadian river basins that drain into conus herein conus the standardized formulation allows for extrapolation to data scarce reservoirs and thus the creation of a complete dataset of operations for all 1 930 large reservoirs of conus included in the global reservoir and dams grand database lehner et al 2011 we evaluate the performances of both data rich reservoirs and the extrapolation scheme relative to han 06 for release and storage simulation accuracy with observed inflow forcing the new weekly reservoir policy parameters dataset is named istarf conus inferred storage targets and release functions for conus and is accompanied by an open source software package that can be used to generate reservoir policies directly from daily reservoir operations time series github com immm sfa starfit these policies may be applied down to a daily temporal resolution in lhms 2 method 2 1 policy inference rationale and overview the starfit algorithm generates a 19 parameter reservoir operating policy comprising weekly water storage targets and release functions table 1 the algorithm is designed to provide realistic simulation of water release decisions throughout year and under varying water availability conditions starfit policies are relatively parsimonious compared to the data driven methods of yassin et al 2019 with 72 parameters six parameters defined independently for each month of the year or turner et al 2020b with 208 parameters four parameters defined independently for 52 weeks of the year unlike models that are fitted separately for individual seasons months or weeks of the year starfit employs harmonic regression to give smooth continuity across periods with relatively few degrees of freedom the parameters of these harmonics may be easily interpreted for seasonal timing and relative importance of key operating features such the use of a seasonal flood or conservation pool a robust and parsimonious model is particularly important for reservoir operations inference given data challenges which preclude traditional split sample or leave one out validation these techniques are inhibited by the relatively short records available perhaps featuring only one or two extreme events and by possible undocumented changes in actual operations occurring over period of record in other words a model may perform poorly in a validation period not because it is overfitted but because actual objectives and constraints on operations can shift at unknown points in the historical record discussion on these challenges is offered in turner et al 2020a starfit is developed to be flexible to deal with varying length quality and completeness of observational data the policy inference algorithm requires neither gap free time series nor a complete set of input variables starfit is also designed to generate policies that are transferrable to data scarce reservoirs weekly varying storage targets are specified as percent of storage capacity release functions return release decisions as percent deviation from long term mean inflow since both reservoir storage capacity and mean annual inflow are available for all large conus reservoirs via grand starfit s standardized policy formulation allows one to copy a reservoir s fitted policy and impose it on a similarly purposed neighboring reservoir by updating these two specifications this use of mean annual inflow also gives the user the ability to adjust the operations to account for inflow bias common to lhms a key feature of han 06 that is retained in our data driven approach further detail in section 4 reservoirs with storage data only i e no inflow or release records can be fitted with storage targets and then have the release functions added by copying from similarly purposed nearby reservoirs this leads to three types of reservoir policy in istarf conus fully fitted storage and release functions generated from data 449 reservoirs partially fitted storage fitted from data release functions extrapolated from similarly purposed neighboring reservoirs 146 reservoirs and extrapolated 1 335 reservoirs the key parameters of a reservoir policy in istarf conus are conveyed in fig 1 and elaborated in the following subsections following turner et al 2020b observed reservoir operations data namely daily records of storage inflow and release are first converted to a weekly resolution allowing for reasonable back calculation of inflow or release if either is missing using change in storage from start to end of each week this expands the number of reservoirs available for policy inference for each reservoir the algorithm first fits two 5 parameter harmonic functions that define the upper and lower bounds of a seasonally varying normal operating range nor of storage section 2 1 1 this range provides three operating settings normal operations below range operations and above range operations if storage levels are within the nor normal operations water release is defined using a seasonal release pattern 4 parameter harmonic function and with a single linear adjustment to account for water availability 3 parameters section 2 1 2 if storage levels drop below the nor the reservoir is assumed to be at risk of being depleted and so release is curtailed to a minimum outflow rate determined from observations if storage levels rise above the nor the operator seeks to draw the reservoir back down within a pre defined time period by increasing the release subject to a below spill crest maximum also defined using release observations minimum and maximum release constitute the final two parameters of the 19 parameter scheme all parameters associated with this model are derived solely from observations of daily storage inflow and release the actual operating purposes of each reservoir emerge from this process rather than being an input to the algorithm 2 1 1 normal operating range nor the nor for a given reservoir is a set of weekly varying maximum and minimum storage values these values are given as of reservoir capacity and they dictate when normal release operations are applied the nor is defined by first aggregating storage to weekly average values and then standardizing as a function of maximum storage capacity the general model adopted to define the nor is 1 s t μ α sin 2 π ω t β cos 2 π ω t s min μ α sin 2 π ω t β cos 2 π ω t s max s min μ α sin 2 π ω t β cos 2 π ω t s min s max μ α sin 2 π ω t β cos 2 π ω t s max for the upper bound and 2 s t μ α sin 2 π ω t β cos 2 π ω t s min μ α sin 2 π ω t β cos 2 π ω t s max s min μ α sin 2 π ω t β cos 2 π ω t s min s max μ α sin 2 π ω t β cos 2 π ω t s max for the lower bound s t and s t are fitted upper and lower bounds of the nor in week t ω is the frequency set as 1 52 to reflect the weekly resolution of the model and μ α and β are fitted parameters controlling the baseline amplitude and phase of two harmonics that define the upper and lower bounds of the nor these upper and lower bounds of the nor are fitted to the three highest storage values blue points fig 1 upper left panel and three lowest storage values pink points same figure for each week across all years respectively the use of three years protects against a nor that envelops one off extreme years while also providing a sufficiently wide nor for reservoirs that have short records of perhaps just ten years observed data resulting harmonics characterize observed storage behavior with a cyclic component to represent seasonal flood and conservation pools each harmonic is fitted with constraining parameters s min and s max s min and s max for the lower harmonic which provide flexibility to capture deep sharp peaks and troughs in the nor with possible multi week periods during which the bounds remain fixed see the lower bound of the nor at the start of the hydrological year in fig 1 for example these bounding constraints mean the function cannot be fitted using standard multiple linear regression we instead use a local gradient free optimization algorithm powell 1994 to identify the five parameters of each harmonic the optimization searches for the constrained harmonic that minimizes root mean squared error between the harmonic and the selected storage observations i e the three highest or lowest depending on whether the upper or lower harmonic is sought to guide the algorithm to a successful solution the harmonic parameters μ α β μ α β are first initialized using multiple linear regression assuming no constraints each constraint is then initialized to lie just within the amplitude of that harmonic ensuring that the objective function is sensitive to its adjustment the optimization algorithm is then run to find all parameters of the harmonics examples of fitted operating ranges defined by the upper and lower bound harmonics are given in fig 2 2 1 2 release function the nor is used to identify the reservoir s release operation mode on each time step of simulation the state of the reservoir may be normal within nor above normal or below normal operations are designed to guide storage levels back into the nor should they deviate outside it this can happen if there is a flood causing storage to breach the upper bound of the normal operating range or a prolonged dry spell causing reservoir drawdown below the nor if storage exceeds the nor the starfit algorithm sets a desired release to draw storage back into range within one week if this desired release exceeds a pre determined maximum release it will be constrained to the maximum release meaning flood conditions can still cause the reservoir to fill to capacity causing uncontrolled spill if storage drops below nor the operator has limited ability to refill the reservoir negative release is impossible in this instance starfit applies a predefined minimum release value also determined from observed records which for many reservoirs represents an environmental release requirement in simulation all releases are also constrained by basic mass balance for example release cannot exceed water available in storage plus inflow for most time periods of a reservoir simulation storage will lie within the normal operating range during such periods we assume the operator schedules the release based on three sources of information 1 week of year defined using the epidemiological week epi week beginning sunday herein referred to as the operating week 2 reservoir inflow volume during the operating week and 3 existing state of storage at the start of the operating week which we define here as the position of current storage within the normal operating range i e storage at lower bound of nor means storage state 0 storage at upper bound of nor means storage state 100 other sources of information such as known releases from upstream reservoirs operated in coordination or accurate inflow forecasts are often important in reality rouge et al 2021 but are not considered in the present approach which focuses on a method that may be readily adopted within existing lhms discussion on challenges of forecast implementation in lhms is offered in turner et al 2020a one can use data to determine a simple relation that defines release as a function of storage and inflow this release relationship should vary by time of year since releases will be adjusted depending on various seasonally varying objectives e g irrigation season snowmelt season etc to avoid reconstructing this release relationship for multiple periods leading to a heavily parameterized model we adopt the following two step approach first average weekly release is modeled using a four parameter harmonic function see example in lower left panel of fig 1 second the residuals from this average release pattern are fitted with single linear relationship that provides release adjustment from seasonal average as a function of current inflow and storage state to fit these release function parameters weekly release volume time series are first standardized around 0 by presenting as fractional deviation from long term mean inflow 3 r t r t i i where r t is the time series of weekly release volumes and i is the long term mean of inflow same units since i r i e long term mean inflow approximates long term mean release the harmonic used to model a typical seasonal release pattern may be fitted without an intercept parameter i e centered on zero 4 r t α 1 sin 2 π ω t α 2 sin 4 π ω t β 1 cos 2 π ω t β 2 cos 4 π ω t where α 1 α 2 β 1 and β 2 are the four parameters unlike for the constrained harmonics that define the nor these harmonics may be identified with multiple linear regression the residuals of this harmonic ε t r t r t are then used to fit the following linear model which allows for an adjustment to the seasonal release depending on available water in storage and inflow 5 ε t c p 1 a t p 2 i t 6 i t i t i i where a t is the availability status equal to the fractional position of the storage within the normal operating range at the start of the operating week 0 a t 1 i t is standardized inflow and c p 1 and p 2 are regression coefficients by separating inflow and storage as separate inputs rather than a single water availability value the model has flexibility to account for operations driven by either variable the model is discarded i e all three parameters set to zero if it performs with an r squared value less than 0 3 suggesting poor fit or if the p 1 or p 2 coefficients are negative which is illogical since it would suggest lower release with greater water available if the linear model is discarded the release will be a function time of year only following the harmonic function without further adjustment for water availability with the parameters of the release harmonic and adjustment function set the implementation of the release decision making is 7 r t min i r t ε t i r max s t s t s t m i n s c a p s t s t i t r m a x s t s t r min s t s t where r t is the targeted release and s t is the storage volume s t as a percentage of storage capacity s cap parameters r max and r min are the final two parameters of the 19 parameter model these parameters are determined using the 95th and 5th percentile values of the release observations the software that supports this study allows this setting to be adjusted easily actual release implemented in simulation is then equal to the targeted release r t subject to mass balance constraints if the reservoir exceeds capacity all excess water must be spilled if the targeted release cannot be met with existing water available it is constrained to physical water available in storage plus inflow 8 r t max min r t i t s t i t s t s cap 2 2 application of starfit to resopsus the resopsus inventory of observed reservoir operations includes daily storage release and inflow records with varying levels of length and completeness for 678 large conus reservoirs some records include lengthy gap free time series of daily storage release and inflow while others feature significant gaps or may lack observations for a key variable although the starfit algorithm can glean a policy from incomplete records or cases with a missing inflow or release variable not all records in 678 are suitable for policy inference after removing pre 1995 data to avoid fitting policies to out of date operations we discard records that have less than at least ten full years of daily storage values for nor identification and five full years of either inflow or release for release function identification some reservoirs benefit from storage data sufficient to fit nor but lack release or inflow data sufficient for release function identification these cases may be fitted with a nor and can then adopt a neighboring similarly purposed reservoir s standardized release function as described in 2 3 resopsus provides adequate data for 449 reservoirs with storage targets and release functions and 146 reservoirs with storage targets only a total of 595 reservoir policies in istarf conus may be considered fitted with data while the remaining 1 335 reservoir policies are extrapolated of the 449 fully fitted reservoirs 111 25 have release adjustment parameters c p 1 p 2 discarded due to weak performance in model fitting see 2 1 2 discarding of the release adjustment parameters indicates that releases during normal operating conditions are driven more by seasonal timing modeled using the harmonic than by prevailing water availability this does not necessarily indicate problematic data or weaker reservoir policy in general reservoirs with a discarded release adjustment function remain in the sample as candidates for extrapolation to data scare reservoirs 2 3 extrapolation of rules to data scarce reservoirs for 1 335 data scarce reservoirs for which we lack observed operations sufficient to employ the starfit algorithm we extrapolate inferred policies from the 595 data rich reservoirs the premise for the extrapolation procedure is that reservoirs with similar operating purposes and which face similar seasonal hydrological conditions will be operated in a similar manner for instance many reservoirs in the pacific northwest draw down storage levels to capture flood waters coming from the spring freshet while no two reservoirs will be operated in exactly the same way this feature results in a reliable winter downshift in the normal operating range for flood control reservoirs of the columbia river basin illustrated by the example of libby dam in fig 2 since the storage targets are defined in terms of capacity and release functions as deviation from long term inflow rate such rules can be simply copied from one reservoir to be imposed on another with storage capacity and long term inflow updated for the new reservoir the validity of this procedure may be examined using the data rich reservoirs one can test the performance of the extrapolation scheme by assuming that each data rich reservoir is data scarce copying its policy from a neighboring similarly purposed reservoir and simulating its storage and release behavior with observed inflow forcing see section 2 5 3 extrapolation to data scarce reservoirs is conducted using the united states geological survey s standardized river basins these basins are known as hydrologic units and are defined using hydrologic unit codes hucs conterminous united states is divided into 18 major hydrological regions known as huc2s e g california pacific northwest great lakes etc which are further subdivided into approximately 200 river basins known as huc4s for a given data scarce reservoir data rich reservoirs within the same huc4 are first identified these reservoirs are then ranked according to the degree to which their operating purposes align based on four objectives recorded as a boolean variable in grand namely flood hydropower irrigation and water supply to compute the operating alignment between reservoirs we sum the number of matches four matches would represent a perfectly aligned reservoir and 0 matches would mean that the reservoirs share no operating objectives if the huc4 features no reservoirs with operating alignment 1 match the larger huc2 basin is searched for a better match if there are multiple reservoirs with an equal number of matches the closest dam distance wise is selected one exception is in the great lakes huc2 basin where resopsus has no suitable records for policy inference reservoirs in this region copy from best aligned reservoirs from the closest neighboring huc2 region depending on reservoir on the periphery of the great lakes region data scarce reservoirs located regions where data are limited in general such as the great lakes new england mid atlantic and south atlantic gulf tend to rely heavily on small number of data rich reservoirs within the same huc2 in contrast data scarce reservoirs located in data rich regions may copy rules from a much larger sample of nearby similarly purposed reservoirs fig 3 2 4 performance testing 2 4 1 daily simulation of reservoir policies with observed inflow the performance of the starfit scheme is tested at a daily time step which is a common temporal resolution adopted in lhms we use daily observed inflow to force each reservoir model allowing for evaluation of simulated release and storage relative to observations weekly resolution policies can be simulated and tested at daily resolution following an approach similar to turner et al 2020a on each day of simulation the normal operating range is determined based on the current operating week storage level then determines the mode of operation for that day normal above normal below normal as described above during normal operations the fitted release function provides weekly release as a function of current period weekly inflow and water in storage in daily simulation the full week s inflow is unknown but can be forecasted we simulate with a week ahead persistence forecast meaning the current day s total mean inflow rate is assumed constant over the following seven days to give a weekly flow volume the weekly release volume may then be determined and a day s worth of that release volume weekly release divided by seven is implemented in simulation as the simulation steps forward to the next day a new weekly flow forecast and associated release are generated two daily simulations are evaluated first daily release is simulated with storage fixed to observed values this simulation isolates the performance of the storage targets and release functions independent of storage simulation performance second daily release and storage are simulated together this simulation and resulting release and storage behaviors indicate the performance of the model with error in release allowed to accumulate through storage errors thus affecting the next day s release decision this latter simulation provides a more accurate indication of model performance when exposed to an actual lhm simulation in which storages are simulated although starfit can fit policies to reservoirs with gaps in the observational record or with either inflow or release missing the performance test requires reservoirs replete with lengthy 5 years continuous observed inflow to drive the simulation results are reported for 273 reservoirs with sufficient inflow data to conduct daily performance evaluation 2 4 2 benchmark simulation performances are benchmarked against han 06 which is conceptually similar to a variety of other generic reservoir schemes e g biemans et al 2011 voisin et al 2013 and is considered the benchmark to improve upon for reservoir operations in lhms boulange et al 2021 han 06 sets provisional annual and monthly release targets to represent interannual and seasonal release patterns for each reservoir provisional annual release is modeled as a linear adjustment to mean annual inflow depending on the volume of water in storage at the beginning of the operational year specifically the provisional annual release is equal to mean annual flow multiplied by the fractional deviation of storage from a predefined alpha constant monthly provisional release depends on reservoir purpose han 06 categorizes a reservoir as either irrigation or non irrigation for the irrigation reservoirs within year variation in the release is determined by seasonality in downstream irrigation water demand allocated to that reservoir downstream demand is allocated among multiple upstream reservoirs proportional to their mean annual inflow for non irrigation reservoirs the monthly provisional release is set to the mean annual flow rate finally han 06 adjusts the provisional monthly release to obtain actual monthly release the mode of adjustment depends on the ratio of reservoir storage volume to annual inflow volume termed c for reservoirs with c 0 5 monthly release is assumed to be independent of monthly inflow and for reservoirs with c 0 5 monthly inflow is factored into the release to avoid over frequent fill and spill cycles daily releases are updated for minimum and maximum storage as well as a minimum flow release in this study we simulate han 06 with alpha storage constant parameter set to 85 of capacity as recommended in hanasaki et al 2006 we set downstream demand using the mosart wm large scale hydrological and water management model as configured in voisin et al 2017 2 4 3 metrics we compute three metrics to compare performances of starfit to han 06 these are 1 normalized rmse nrmse where the rmse is normalized by dividing by standard deviation of the observations 2 normalized rmse of above standard operating level periods nrmse meaning the data are filtered for periods in which the observed reservoir storage is above the normal operating range this is test of operations performance during high inflow periods and spill 3 normalized transformed rmse ntrmse where the simulated and observed releases are first transformed using a box cox transform with lamba 0 3 van werkhoven et al 2009 this transformation puts greater weight on low flow periods the nrmse is closely related to the commonly used nash sutcliffe efficiency nse while providing strictly non negative error values useful in our assessment for log scale plotting that are interpretable and easily compared to the other nrmse metrics all three metrics are computed for each of the two release variables namely daily release simulated with observed storage rs obs indicating performance of the the release decisions independent of storage error daily release simulated with simulated storage rs sim indicating performance of combined storage and release simulation we also compute these metrics on daily simulated storage s versus observed storage for each reservoir 2 4 4 leave one out test for extrapolation approach reservoirs with extrapolated rules cannot be evaluated using the approach described above since they lack observed data to drive the simulation and benchmark outputs however the general extrapolation approach may be evaluated with a leave one out method wherein a data rich reservoir is assumed to be data scarce the target reservoir copies the standardized nor and release function from a neighboring similarly purposed reservoir as described in 2 3 and is then evaluated using the performance evaluation approach described above results derived from this extrapolation test are reported separately with the label starfitx we also evaluate two alternative extrapolation settings which are designed to reveal the relative importance of reservoir purpose and distance to the performance of the extrapolation the first of these alternatives setting x1 targets similarly purposed reservoirs within the same river basin but choses the farthest reservoir rather than the closest in cases where multiple reservoirs of equally good operational alignment are found this setting reveals the importance of physical distance to extrapolation performance setting x2 disregards the reservoir purpose entirely and instead copies the closest reservoir by distance this setting reveals the importance of reservoir purpose in the extrapolation scheme 3 results 3 1 performance of starfit and starfitx starfit provides robust performance improvements relative to han 06 across all variables and metrics examined fig 4 for data rich reservoirs starfit reduces error of simulated daily storage s release rs sim and release assuming observed storage rs obs for 87 and 71 78 and 85 91 of reservoirs respectively depending on performance metric assessed average magnitude of improvement with starfit is significant with 64 67 reduction in median nrmse for simulated storage s and 15 20 reduction in median nrmse for release both rs obs and rs sim relative to han 06 table 2 reservoirs that adopt policies from similarly purposed neighboring reservoirs are also improved on average over han 06 starfitx reduces storage error relative to han 06 for 61 of reservoirs while associated simulated releases rs sim are improved for 65 71 of reservoirs unsurprisingly starfitx underperforms starfit we find no obvious common features leading to greatest losses in performance in the starfitx relative to starfit neither reservoir specifications storage size purpose etc nor reservoir parameter values are correlated with performance deterioration in extrapolation mode starfitx requires both storage targets and release functions to be copied from neighboring similarly purposed reservoirs results for rs obs storage set of observed rather than simulated with starfitx show decreased performance relative to han 06 on average as well as decreased performance relative to rs sim this occurs because observed storage values often deviate outside an over narrow nor copied from another reservoir causing frequent use of maximum and minimum release constraints at inappropriate times the issue is less prominent for nrmse flood performance because the upper bound of nor is often close to reservoir capacity making it more amenable to successful copying overuse of minimum release is avoided if storage is simulated rs sim and guided back inside the normal operating range simulated storage in turn suffers a performance reduction when the copied nor is unrepresentative of actual typical storages although these finding highlight fallibility in copying the nor from another reservoir performance of s and rs sim storage suggest that this is still preferable to han 06 in most cases performances of starfit and starfitx vary widely across reservoirs we observe some very substantial gains in performance over han 06 in some cases fig 5 see supplementary materials for similar plot with absolute values instead of performance relative to benchmark for storage simulation reductions in nrmse of 75 are observed for 35 of reservoirs with starfit and 15 of reservoirs with starfitx we find no particular category of reservoir for which performance improvements are greatest or most robust in general for example improvements for reservoirs with large storage capacity 3 000 mcm are distributed similarly the whole sample as highlighted in fig 5 reservoirs that lack the release adjustment parameters which are discarded in one quarter of reservoirs due to poor fit of release with respect to water availability do not perform significantly better or worse than those fitted with these functions either starfit underperforms relative to han 06 in 13 of dams and 25 of dams for simulated storage and release respectively this is usually caused by over constrained maximum or minimum release operations that are difficult to guide with data e g release decisions outside of the nor often underperform han 06 other instances of relative underperformance arise in cases with short periods of continuous release data less than1 year to perform the daily evaluation we require five years inflow data to drive the simulations but for a small number of cases the observations of release or storage are incomplete during this period in many of these cases we would expect starfit to exceed han 06 performance with a lengthier sample in general stronger performance gains could be harnessed with further data extensions and refinements to resopsus as well a more nuanced approach to defining maximum and minimum release constraints which is out of scope for the present study starfitx is evaluated by assuming that each data rich reservoir is data scarce and then copying from a similarly purposed neighboring reservoir assessing starfitx using data rich reservoirs raises the possibility of bias in overall performance since most of these reservoirs are located in regions where other reservoirs are situated in other words a data scarce reservoir in california is more likely to find a similarly purposed nearby reservoir to copy than a data scarce reservoir in new england where reservoirs with data are less prevalent to demonstrate that this potential bias is absent we show distributions of performance improvement in both starfit and starfitx relative to han 06 across individual huc2 regions of conus fig 6 see supplementary materials for similar plot with absolute values instead of performance relative to benchmark robust improvement of starfit and starfitx relative to han 06 in both simulated release and storage is found for all almost all regions there is no apparent correlation between deterioration of performance in starfitx relative to starfit and data prevalence of region one region where starfitx performances drop dramatically relative to starfit is the pacific northwest a region with excellent reservoir operations data coverage complex or highly tailored operating arrangements for environmental flows hydropower production and flood control may make operating rules for these reservoirs less amenable for transfer to other reservoirs despite this effect starfitx still offers improvements for this region relative to han 06 for storage simulations on average 3 2 alternative extrapolation settings evaluation of alternative extrapolation settings x1 farthest similarly purposed reservoir within basin and x2 closest reservoir by distance disregarding operational purpose show that the chosen extrapolation strategy x is prudent both settings x1 and x2 result in a modest increase the median error score and decrease in number of reservoirs improved relative to han 06 table 3 these reported impacts are nullified somewhat by the fact that many reservoirs are copying from the same target reservoirs irrespective of the extrapolation scheme for example often there is only one reservoir in a huc4 basin that has close operational alignment to the target in those cases x and x1 will be result in the same target reservoir in some cases the best aligned reservoir operationally will also be the closest by distance and in those cases settings x and x2 will copy from the same reservoir for setting x1 approximately 37 of evaluated reservoirs change the target reservoir and approximately 60 of these underperform starfitx for setting x2 about half of reservoirs change the target and of these 65 underperform starfitx these results show indicate that copying the operating policy from a remote reservoir within good operational alignment and within the same hydrological unit can be a legitimate strategy in many cases 4 discussion the performance enhancements in both simulated storage and release reported above indicate that use to istarf conus would markedly improve on han 06 for reservoirs where sufficient training data are available n 595 and would in most cases also outperform han 06 when operating rules are copied from a similarly purposed reservoir in the same river basin n 1 335 these results indicate that istarf conus can be readily adopted in conus scale lhms or global hydrological models that simulate large conus reservoirs performance improvements in an lhm simulation may differ to what we found in this study in which observed inflow forcing was applied lhms may feature significant inflow bias due to error in climatic forcing as well as representation of physical catchment processes flow routing and upstream water consumption and regulation however istarf conus will retain strong advantages over generic schemes irrespective of inflow conditions particularly storage representation guided by the targeted operating range and by extension a reservoir s ability to buffer extreme floods or sustain supply during prolonged drought the significant difference in performance between starfit and starfitx highlights what could be gained with increased access to reservoir operations records of storage inflow and release our operations are trained using resopsus the most comprehensive multi agency inventory of multi decadal reservoir operations available for the united states many of the reservoirs we label data scarce are in fact measured at regular intervals and have documented records that could perhaps be collected through further agency outreach and survey although only covering a few years of operations new satellite based reconstructions of reservoir storage levels may also be introduced to extend and supplement reservoir observational records cooley et al 2021 these data could be used to estimate the normal operating range for each reservoir combined with reanalysis climate to drive historical river flow simulations they could also be used to back calculate weekly release and thus develop storage and release schemes for the united states or globally by computing all release decisions relative to mean long term inflow istarf conus gives the user the ability to adjust operations for reservoirs subject to inflow bias this may be achieved without redefining the release model parameters but instead by substituting mean inflow i applied in eq 7 with average long term inflow determined in a prior simulation of the lhm accounting for inflow bias in this way would result in reservoir release propagating the bias downstream while maintaining realistic storage levels to accommodate flood or drought this feature also provides the capability to adjust operations for a changing climate dynamically within the simulation for example by updating the mean annual inflow every ten years of simulation as climate conditions evolve starfit is one of many possible approaches one could follow to infer reservoir operating policies one alternative is to identify the operating objectives of the reservoir describe those objectives in a single mathematical function and optimize a policy using stochastic dynamic programming castelletti et al 2008 this approach could allow for more realistic operations under changing conditions giudici et al 2021 although determining representative operating objectives across a large sample of reservoirs presents a significant challenge machine learning methods aimed reproducing historical decisions could be another avenue to explore although these models require much longer sequences of data than are available for the problem of identifying a reservoir policy irrespective of the method employed there is a limit to how well actual reservoir operations can be represented in a typical large scale hydrological simulation in which reservoir operations lack forecast information and are uncoordinated actual reservoir operators often use medium to long range forecasts to guide operations with varying lead times throughout the typical operating year and realistic representation of such forecasts in an lhm simulation remains a significant challenge even if forecast use is well described in the operating policy turner et al 2020a coordination of reservoir releases within a river basin is another important driver of decision making not well accommodated in lhms rouge et al 2021 a dataset of observations like resopsus could be applied to study the important effects of reservoir system coordination and develop models to represent this within an lhm this would impose a significant computational burden that may make such advances impractical at this time 5 conclusions this study presents istarf conus a new dataset of water storage and release policies for all 1 930 large reservoirs of conus and its associated policy inference algorithm starfit performance evaluation of this scheme shows that it offers substantial and robust simulation improvement over a state of the art approach adopted in many lhms performance enhancements are most significant for simulated storage which is guided by a normal operating range identified by the inference algorithm improved storage representation also benefits release since release is a function of storage even though most conus reservoirs lack data sufficient to train these operating schemes we show that a simple extrapolation of policies from similarly purposed neighboring reservoirs that are replete with operating data will still yield modest enhancements over conventional practice on average the overall performance of the scheme will improve as and when more observational data are added istarf conus can be readily adopted into any lhm that represents large conus reservoirs or may be analyzed for insight into the diverse range of operating strategies employed in united states dam and reservoir operations 6 data statement links to data and code used to perform this experiment are available via a supporting meta repository https immm sfa github io turner etal 2021 joh this includes a link to the inventory of observed reservoir operations resopsus the istarf conus dataset of inferred reservoir operating policies is freely available at https doi org 10 5281 zenodo 4602277 and includes an implementation demo using starfit the starfit algorithm is available as an open source r library available at github https github com immm sfa starfit declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the u s department of energy office of science as part of research in the multisector dynamics earth and environmental system modeling program appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126843 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4131,road authorities in cold climates regularly apply salt on roads during winter to ensure public safety pavement surface temperature is a significant parameter affecting snow and ice melting at the onset of a storm road temperature below the freezing point of the applied brine causes ice to form on the road surface excessive application of salt on the road can have adverse environmental impacts especially to soil and water quality therefore forecasting pavement temperature can optimize road salt application while reducing costs improving public safety and reducing environmental impacts this research aims to develop a reliable and accurate pavement surface temperature prediction tool using machine learning techniques this study employs advanced deep neural network dnn learning techniques to predict pavement surface temperature for road salt management purposes to validate the proposed methodology this work used hourly solar radiation and air temperature data from environment canada and pavement surface temperature data collected from the road weather information system rwis for sites around the city of toronto ontario the performance of the proposed dnn model that integrates a convolutional neural network cnn with a long short term memory lstm on pavement surface temperature forecasting was evaluated against four other comparative machine learning methods lstm convolutional lstm convlstm sequence to sequence seq2seq and wavelet neural network wavenet models a dataset of 10 895 samples was collected as an hourly pavement surface temperature record in three timeframes from november 2009 to march 2014 on highway 401 in southern ontario canada experiments included predictions for 1 2 4 and 6 hours ahead using as input features air temperature solar radiation and present pavement temperature the proposed pavement temperature forecasting approach resulting from this investigation suggests our new approach is more accurate than previous models these results reveal that the cnn lstm outperforms the four other models and creates predictions closer to the true pavement surface temperature keywords machine learning pavement surface temperature deep learning cnn lstm convlstm lstm seq2seq wavenet 1 introduction driving conditions can be compromised in northern climates due to the accumulation of snow and ice on the road surface and the associated reduction in vehicle traction on roads road salt has been widely used since the middle of the twentieth century to improve road safety by helping melt ice and snow fay and shi 2012 winter road salt use has escalated steadily over the past several decades with annual usage exceeding 5 and 15 million tons in canada and the united states respectively environment canada 2020 however environmental and health and safety concerns are progressively important in the provision of road salt application plans this study aims to help in the development of advanced machine learning models for precision salt application on roadways based on the real time weather forecasts and associated pavement temperatures to achieve road safety while minimizing harm to the salt vulnerable areas pavement temperature is an effective factor on snow and ice control operations on highways blackburn et al 2004 fu et al 2012 previous studies have been developed based on heat transfer principles using regression and numerical methods regression models have predicted the daily maximum and minimum pavement surface temperatures based on solar radiation and air temperature using random long term pavement performance and seasonal monitoring program data bosscher et al 1998 diefenderfer et al 2006 marshall et al 2001 zeynoddin et al 2019 numerical methods have predicted pavement temperature based on input values of hourly air temperature hourly solar radiation and mean daily wind speed in different bituminous pavement layers using the finite element models minhoto et al 2005 the majority of the existing studies have presented models for determining maximum and minimum pavement temperature based on daily and annual values due to thermal balance the pavement temperature follows the air temperature with a lag time of a few hours therefore the daily pavement temperature forecasting is not an accurate factor for managing the optimum salt applications on icy highways furthermore numerical solutions are difficult and complex for performing the required multivariate nonlinear equations for operational purposes one of the most advanced winter road maintenance activities is operating of the road weather information system rwis stations by the ontario ministry of transportation mto the rwis is a network of automatic weather stations with sensors installed on the side of the road and in the pavement and display the current weather and pavement temperature information the number of rwis stations are too sparsely distributed particularly in northern ontario the installation and operating costs are over 80 000 for each station buchanan and gwartz 2005 the rwis forecasts are produced by the enhanced integrated climatic model that can simulate pavement temperatures using the thermal transfer between road and weather mto 2007 wood a global leader in engineering projects has developed a method based on virtual rwis creation and has designed the virtual rwis observations along highway 401 between kingston and brockville tac 2019 the virtual rwis is interpolated between two or several existing rwis stations then the rwis forecasts are simulated for pavement temperatures based on mobile data monitoring tac 2019 even though the rwis has been providing true weather forecasting in north america the purchase and maintenance costs of an rwis system are barriers to entry for many municipalities in ontario mto 2007 salek et al 2018 furthermore majority of roads in ontario lack local rwis data for pavement temperature and the rwis stations only accurately reflect localized pavement temperatures not highway network wide because the stations are approximately 50 km apart and in some cases much further apart e g in northern ontario despite the importance of pavement temperature in the estimation of accurate road salt application rates that can reduce chloride concentration impacts in salt vulnerable areas betts et al 2014 betts et al 2015 ccme 1999 d angelo and palmieri 2021 ebtehaj et al 2015 environment canada 2010 fu et al 2012 gharabaghi et al 2015 perera et al 2009 2013 sattar and gharabaghi 2015 sattar et al 2016 sattar et al 2017 stajkowski et al 2020 stajkowski et al 2021 trenouth et al 2018 trenouth and gharabaghi 2016 there are no studies predicting accurate pavement surface temperatures during winter storms using deep neural network dnn models one advantage of these models is that they can be integrated with other models such as multi layer perceptron and recurrent neural networks rnn these networks can be combined with different networks such as long short term memory lstm networks and genetic algorithm optimized long short term memory ga lstm networks which can be used to forecast natural systems gers and schmidhuber 2000 gers et al 2002 schmidhuber 2015 stajkowski et al 2020 the primary goal of this study is to assess the accuracy of the lstm convlstm cnn lstm seq2seq and wavenet deep learning models for prediction of pavement surface temperatures using simple climatic features the major limitation of the rwis is the prohibitive cost of maintenance and operation of an rwis station hence the network is very sparse and the limitation in capturing the spatial variability of pavement temperatures within a vast network of roads in a large city that are influenced by complex wind patterns and microclimates our proposed machine learning models provide a viable economic option to amend the rwis data supporting the smaller municipalities and road authorities and refine the rwis forecasts for the larger municipalities with higher spatial resolution of pavement surface temperatures within the road network taking into account the microclimates 2 methodology 2 1 thermal transfer of pavement snow melting the key factors of pavement surface temperature air temperature and precipitation are the most significant factors for predicting the amount of salt that will be needed at a given time for a winter storm event fig 1 shows a diagram of heat transfer from solar water ice and salt interactions on a pavement surface based on mass balance the pavement surface receives the biggest amount of energy by the incident solar radiation however the pavement surface can gain less heat from solar radiation in winter than in summer particularly in cold or snowy climates such as canada nonetheless the pavement surface can absorb the ambient heat when the air temperature is greater than the pavement surface temperature the moisture of the salt allows the salt to effectively adhere to the surface of the pavement the sensible heat flux is defined based on the sum of heat fluxes due to climatic factors and pavement surface conditions fujimoto et al 2014 the heat flux q between air temperature ta and layers of water ice and salt on the pavement surface tpv is derived according to newton s law of cooling as fujimoto et al 2014 1 q α t pv t a 2 α 10 4 v w 0 7 2 2 where vw is the wind velocity the factor of pavement temperature immediately after salt application is more important than air temperature for converting snow or ice into a liquid solution keyser 1973 pavement surface temperature depends on the thermal transfers of the air temperature the amount of solar radiation salt water ice layers and wind speed and its direction typically the pavement surface temperature is higher than the air temperature based on the energy balance between climatic factors and the characteristics of the pavement surface according to thermal balance the air temperature changes with time due to atmospheric changes there is always a lag between air temperature and pavement surface temperature changes due to heat transfer from salt induced melting after salt application on the road surfaces during winter storm events 2 2 theoretical background of the model 2 2 1 long short term memory lstm artificial neural networks anns usually simply called neural networks nns are computing systems originally inspired by the biological neural networks that constitute animal brains dreyfus 1990 ann is based on a collection of connected units or nodes called artificial neurons which loosely model the neurons in a biological brain the basic example is the perceptron schmidhuber 2015 each connection like the axons in a biological brain can transmit signals to other neurons an artificial neuron that receives signals then processes the information and send signals to other neurons connected to it dreyfus 1990 rnns are a class of neural networks that allow previous outputs to be used as inputs while having hidden states schmidhuber 2015 the major advantage of rnns over anns is that rnns are capable of modeling sequence of data so that each sample can be assumed to be dependent on previous ones as a result the occurrence or effect to the result of one data point depends on the ones that preceded it rnns is normally the desired option for time series data for each timestep t the activation st and the output value ot are respectively expressed as kumar et al 2019 3 s t w s t 1 u x t 4 o t φ v s t where u w and v are weight matrix and σ and φ are activation functions rnn is normally a desired tool for data in a sequence or time series data since the occurrence or effect to the result of one data point depends on the ones that preceded it stanford university 2020 vanishing and exploding gradient may occur in the standard rnns stanford university 2020 two modified version of rnns gated recurrent unit gru and lstm deal with the vanishing gradient problem encountered by standard rnns fig 2 the lstm model is composed of input gate i forget gate f input modulation gate g and output gate o kumar et al 2019 they are usually noted and expressed as stanford university 2020 5 i σ w i h t 1 u i x t 6 f σ w f h t 1 u f x t 7 o σ w o h t 1 u o x t 8 g φ w g h t 1 u g x t 9 c t φ c t 1 f g i 10 h t c t o where x t and c t are the input and carry state at time step t respectively and h t 1 is the previous hidden state the forgotten gate f controls the amount of information which should be passed through the current cell and should be removed from previous memory cell h t 1 the transferred information is written to next memory cell h t via the carry state c t stajkowski et al 2020 the lstm code with and without attention model using python language are presented in the supplementary boxes s1a and s1b 2 2 2 convlstm and cnn lstm models the convolutional lstm convlstm model is a lstm model capable of maintaining input features as a three dimensions 3d instead of one dimensional 1d input feature in the lstm structure matrix transition of input to hidden state and hidden state to hidden state are defined based on convolution operations d angelo and palmieri 2021 the convlstm layer not only preserves the advantages of fully connected lstm but is also suitable for spatiotemporal data due to its inherent convolutional structure shi et al 2015 the cnn lstm model is an integration of a cnn with a lstm model which is able to process the data set in cnn which is constituted of two layers of convolution and pooling the one dimensional result is extracted from cnn into lstm sequences afterwards he et al 2019 the architecture of a convlstm and a cnn lstm is shown in figs 3 a b the convlstm and the cnn lstm codes with and without attention model employing the pytorch machine learning framework https pytorch org are presented in the supplementary boxes s2a s2b s3a and s3b 2 2 3 seq2seq and wavenet models the sequence to sequence seq2seq is kind of rnn which has been constituted from input sequences encoder and output sequences decoder with same length which has been introduced in 2014 for time series prediction du et al 2017 the deep neural network of seq2seq has been depicted in fig 4 a the wavelet neural network wavenet is a dilated casual convolutional dcc based on cnn which computes the sequential data faster than rnn oord et al 2016 oord et al 2018 fig 4 b shows the architecture of dcc with dilations 1 2 4 and 8 oord et al 2016 the wavenet model can grow in deeper layers vertically due to its flexible layers overall the wavenet model is a probabilistic and autoregressive model that can be used to calculate input sample in present timestep xt based on the sequences of samples in previous times x1 x2 xt 1 using conditional probability distribution as oord et al 2016 12 p x t 1 t p x t x 1 x 2 x t 1 the seq2seq and the wavenet models codes with and without attention model are presented in the supplementary boxes s4a s4b s5a and s5b 3 validation of the proposed methodology 3 1 description of validation case highway 401 is one of the major highways with the largest traffic volumes in southern ontario canada fig 5 the meteorological data will be collected from the toronto city station climate id 6158355 from environment and climate change canada eccc the defined weather station is located at approximately 43 40 00 000 n 79 24 00 000 w a sum of 10 895 dataset was analyzed based on input features of hourly average air temperature c and solar radiation kj m2 data sets and output feature of hourly pavement surface temperature for this route wind speed and its direction dataset were ignored in this research due to lack of dataset the dataset includes three chunk timesteps from november 2009 to march 2010 november 2011 to march 2012 and november 2013 to march 2014 the observed pavement surface temperature dataset was collected from rwis the pavement surface temperature dataset was acquired from cr 11 etobicoke station due to lack of hourly dataset in this station cr 23 highway 404 401 station was selected to be near to climatic toronto city station on highway 401 3 2 discussion of results a positive correlation of 1 and a negative correlation of 1 have been indicated as the strongest correlation coefficients between two variables the statistical correlation is visualized using a correlation matrix plot and heatmap in fig 6 to determine the measurement variables relationship to one another these plots represent a strong linear relationship between pavement temperature and air temperature while there is a poor correlation between pavement temperature and the five variables of year month day hour and solar radiation moreover the distribution of pavement temperature and air temperature is normal a symmetrical correlation matrix in fig 6 shows the correlation coefficient values between all observed variables typically the correlation of each variable with itself is 1 and lies on the diagonal line of the matrix the results show that the maximum positive correlation coefficient of 0 87 was observed between pavement temperature and air temperature the variables of month and year have correlations with observed pavement temperature of less than 0 3 the variables of day and solar radiation have negligible negative correlations of 0 0084 and 0 0025 with pavement temperature respectively the lstm convlstm cnn lstm seq2seq and wavenet models were implemented in tensorflow using keras library in python and were presented in two cases of with and without attention layer for pavement surface temperature prediction the attention layer is able to improve the memory performance in deep learning models via input data extraction and storing in memory cell ran et al 2019 the performance of the proposed models for predicting the pavement surface temperature as hourly based were evaluated using statistical and graphical methods the mean square error mse based on the variance of the errors measure the differences between the observed and predicted values fig 7 shows the performance of 6 hours ahead forecasting in training and validation states for all models without and with attention in terms of epoch numbers versus the mse these plots can evaluate the models performance on the training and validation data to obtain the best fitting learning curve using the optimal epochs and to prevent the model from overfitting or underfitting the mse values and epoch numbers have an inverse relationship the mse was reduced with a slight slope while the number of epochs increased in terms of training and validation data for all models the validation loss is lower than the training loss in all models and there is a good fit between training loss and validation loss roughly at 200 epochs the plots show that the best validation performance happened roughly in epoch 200 for all models the best validation error is the mse of 7 5e 4 in the optimal epoch 200 for the cnn lstm model with attention this study adopted different deep learning models to predict pavement surface temperature 1 2 4 and 6 h ahead the adam optimizer was applied with learning rate of 1 0e 4 which is more robust than the conventional stochastic gradient descent sgd diederik and jimmy 2014 a batch size of 32 and 200 epochs have been used in this research the relu activation function and the mse loss function as an objective function were used to train the models the proposed models performance statistic results are presented in table 1 the results demonstrate that all five proposed models predicted the measured pavement surface temperatures with a root mean square error rmse of less than 3 6 c a mean absolute error mae of less than 2 6 c however the three lstm based models i e lstm cnn lstm convlstm slightly outperformed the other two non lstm methods i e seq2seq wavenet the reason for the long short term memory lstm based models outperforming the non lstm methods relates to the pavement s thermal inertia which acts as a memory of the stored and released heat the lstm model can better learn the heat energy storage release characteristics of the pavement surface material and use this knowledge to more accurately forecasting pavement temperature time series of the three lstm based methods the cnn lstm has slightly smaller mean absolute percent error due to its architecture that allows for the learning of multiple variable within the convolutional neural network and temporal pavement responses to air temperature through the lstm this way the cnn lstm can discover more correlations between the variables and future pavement temperature responses this allows deep learning of the complex non linear relationships of various input parameters influencing the pavement temperature the cnn lstm model with attention has superior performance and smaller error values than the other proposed models the lowest value with the rmse of less than 2 c and the mae of less than 1 4 c are found for the cnn lstm model in the short range of 1 2 and 3 h ahead compared to the other models of the three lstm based methods the cnn lstm has slightly smaller mean absolute percent error likely due to it s architecture allowing deep learning of the complex non linear relationships of various input parameters influencing the pavement temperature as shown in fig 8 the observed pavement surface temperature was compared to rwis and cnn lstm models in range of 2 hours ahead forecasting the cnn lstm forecasting accuracy is better than the rwis forecasts in sudden changes of pavement surface temperature the prediction accuracy of the hybrid cnn lstm model is improved through the integration of the cnn layers with the lstm model the entire dataset which consists of 10 895 in three chunk timesteps was split 80 for training and 20 for testing figs 9 a b demonstrates that the cnn lstm and lstm models are well trained on the training and validation dataset and the cnn lstm model robustly forecasts hourly pavement temperatures this research shows that the prediction performance of hourly road pavement surface temperatures can be boosted using the cnn lstm model 4 conclusions each year road maintenance authorities in canada spend over one billion dollars on winter maintenance operations to keep roads open and safe to drive from late november to april mto 2007 driving conditions in winter months is compromised in northern climates due to the accumulation of snow and ice on the road surface and the associated reduction in vehicle traction on roads therefore the snow and ice control materials or deicers such as salts have a key role to keep roadways clear of ice snow and to ensure traffic safety and mobility during cold weather periods and snow storms while to mitigate road salt impacts on environment pavement surface temperature is a significant factor for modelling snowmelt it enhances prediction accuracy for precise salt application during a winter storm event on roadways in real time using advanced machine learning models the proposed cnn lstm with attention model predicts local pavement surface temperature based on small number of climate variables with high accuracy this new method optimizes road salt application rates for winter de icing operations and decrease adverse effects on both surface and groundwater resources in the salt vulnerable areas this study provides an assessment of the relationship between input features using correlation matrix it was shown that air temperature contributes to more accurate pavement surface temperature forecasts than solar radiation the evaluation of mse statistical metric shows that the proposed cnn lstm model as an advanced dnn model has better performance against four other proposed machine learning methods moreover the robustness of the proposed five deep learning models was extracted for 1 2 4 and 6 hours ahead using a mse loss function and a mae statistical metric the proposed cnn lstm with attention model forecasts pavement surface temperature with higher accuracy for the short times of 1 and 2 h ahead compared to previous forecasting methods it also demands less human and computational resources since pavement temperatures are able to absorb ambient heat for a short time based on thermal balance there are a few hours lag between pavement temperature and weather changes therefore the proposed cnn lstm models presented in this research are applicable due to their capability to maintain necessary information from previous time steps however the proposed model was assessed according to limited dataset of the most significant climatic variables that are available through the network of environment canada climate monitoring stations for future research the proposed methodology will be investigated for the development of the next generation of the smart salt trucks for precision salt application on roadways based on the real time weather forecasts and associated pavement temperatures to achieve road safety while minimizing harm to the salt vulnerable areas credit authorship contribution statement sepideh emami tabrizi conceptualization methodology writing original draft writing review editing visualization kai xiao methodology writing original draft jesse van griensven methodology resources writing original draft writing review editing supervision funding acquisition muhammad saad methodology hani farghaly conceptualization methodology writing original draft writing review editing supervision funding acquisition simon x yang methodology resources writing original draft supervision funding acquisition bahram gharabaghi conceptualization methodology resources writing original draft writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank generous funding from the ministry of transportation of ontario mto and the national sciences and engineering research council of canada nserc and support from the environment and climate change canada eccc appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126877 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4131,road authorities in cold climates regularly apply salt on roads during winter to ensure public safety pavement surface temperature is a significant parameter affecting snow and ice melting at the onset of a storm road temperature below the freezing point of the applied brine causes ice to form on the road surface excessive application of salt on the road can have adverse environmental impacts especially to soil and water quality therefore forecasting pavement temperature can optimize road salt application while reducing costs improving public safety and reducing environmental impacts this research aims to develop a reliable and accurate pavement surface temperature prediction tool using machine learning techniques this study employs advanced deep neural network dnn learning techniques to predict pavement surface temperature for road salt management purposes to validate the proposed methodology this work used hourly solar radiation and air temperature data from environment canada and pavement surface temperature data collected from the road weather information system rwis for sites around the city of toronto ontario the performance of the proposed dnn model that integrates a convolutional neural network cnn with a long short term memory lstm on pavement surface temperature forecasting was evaluated against four other comparative machine learning methods lstm convolutional lstm convlstm sequence to sequence seq2seq and wavelet neural network wavenet models a dataset of 10 895 samples was collected as an hourly pavement surface temperature record in three timeframes from november 2009 to march 2014 on highway 401 in southern ontario canada experiments included predictions for 1 2 4 and 6 hours ahead using as input features air temperature solar radiation and present pavement temperature the proposed pavement temperature forecasting approach resulting from this investigation suggests our new approach is more accurate than previous models these results reveal that the cnn lstm outperforms the four other models and creates predictions closer to the true pavement surface temperature keywords machine learning pavement surface temperature deep learning cnn lstm convlstm lstm seq2seq wavenet 1 introduction driving conditions can be compromised in northern climates due to the accumulation of snow and ice on the road surface and the associated reduction in vehicle traction on roads road salt has been widely used since the middle of the twentieth century to improve road safety by helping melt ice and snow fay and shi 2012 winter road salt use has escalated steadily over the past several decades with annual usage exceeding 5 and 15 million tons in canada and the united states respectively environment canada 2020 however environmental and health and safety concerns are progressively important in the provision of road salt application plans this study aims to help in the development of advanced machine learning models for precision salt application on roadways based on the real time weather forecasts and associated pavement temperatures to achieve road safety while minimizing harm to the salt vulnerable areas pavement temperature is an effective factor on snow and ice control operations on highways blackburn et al 2004 fu et al 2012 previous studies have been developed based on heat transfer principles using regression and numerical methods regression models have predicted the daily maximum and minimum pavement surface temperatures based on solar radiation and air temperature using random long term pavement performance and seasonal monitoring program data bosscher et al 1998 diefenderfer et al 2006 marshall et al 2001 zeynoddin et al 2019 numerical methods have predicted pavement temperature based on input values of hourly air temperature hourly solar radiation and mean daily wind speed in different bituminous pavement layers using the finite element models minhoto et al 2005 the majority of the existing studies have presented models for determining maximum and minimum pavement temperature based on daily and annual values due to thermal balance the pavement temperature follows the air temperature with a lag time of a few hours therefore the daily pavement temperature forecasting is not an accurate factor for managing the optimum salt applications on icy highways furthermore numerical solutions are difficult and complex for performing the required multivariate nonlinear equations for operational purposes one of the most advanced winter road maintenance activities is operating of the road weather information system rwis stations by the ontario ministry of transportation mto the rwis is a network of automatic weather stations with sensors installed on the side of the road and in the pavement and display the current weather and pavement temperature information the number of rwis stations are too sparsely distributed particularly in northern ontario the installation and operating costs are over 80 000 for each station buchanan and gwartz 2005 the rwis forecasts are produced by the enhanced integrated climatic model that can simulate pavement temperatures using the thermal transfer between road and weather mto 2007 wood a global leader in engineering projects has developed a method based on virtual rwis creation and has designed the virtual rwis observations along highway 401 between kingston and brockville tac 2019 the virtual rwis is interpolated between two or several existing rwis stations then the rwis forecasts are simulated for pavement temperatures based on mobile data monitoring tac 2019 even though the rwis has been providing true weather forecasting in north america the purchase and maintenance costs of an rwis system are barriers to entry for many municipalities in ontario mto 2007 salek et al 2018 furthermore majority of roads in ontario lack local rwis data for pavement temperature and the rwis stations only accurately reflect localized pavement temperatures not highway network wide because the stations are approximately 50 km apart and in some cases much further apart e g in northern ontario despite the importance of pavement temperature in the estimation of accurate road salt application rates that can reduce chloride concentration impacts in salt vulnerable areas betts et al 2014 betts et al 2015 ccme 1999 d angelo and palmieri 2021 ebtehaj et al 2015 environment canada 2010 fu et al 2012 gharabaghi et al 2015 perera et al 2009 2013 sattar and gharabaghi 2015 sattar et al 2016 sattar et al 2017 stajkowski et al 2020 stajkowski et al 2021 trenouth et al 2018 trenouth and gharabaghi 2016 there are no studies predicting accurate pavement surface temperatures during winter storms using deep neural network dnn models one advantage of these models is that they can be integrated with other models such as multi layer perceptron and recurrent neural networks rnn these networks can be combined with different networks such as long short term memory lstm networks and genetic algorithm optimized long short term memory ga lstm networks which can be used to forecast natural systems gers and schmidhuber 2000 gers et al 2002 schmidhuber 2015 stajkowski et al 2020 the primary goal of this study is to assess the accuracy of the lstm convlstm cnn lstm seq2seq and wavenet deep learning models for prediction of pavement surface temperatures using simple climatic features the major limitation of the rwis is the prohibitive cost of maintenance and operation of an rwis station hence the network is very sparse and the limitation in capturing the spatial variability of pavement temperatures within a vast network of roads in a large city that are influenced by complex wind patterns and microclimates our proposed machine learning models provide a viable economic option to amend the rwis data supporting the smaller municipalities and road authorities and refine the rwis forecasts for the larger municipalities with higher spatial resolution of pavement surface temperatures within the road network taking into account the microclimates 2 methodology 2 1 thermal transfer of pavement snow melting the key factors of pavement surface temperature air temperature and precipitation are the most significant factors for predicting the amount of salt that will be needed at a given time for a winter storm event fig 1 shows a diagram of heat transfer from solar water ice and salt interactions on a pavement surface based on mass balance the pavement surface receives the biggest amount of energy by the incident solar radiation however the pavement surface can gain less heat from solar radiation in winter than in summer particularly in cold or snowy climates such as canada nonetheless the pavement surface can absorb the ambient heat when the air temperature is greater than the pavement surface temperature the moisture of the salt allows the salt to effectively adhere to the surface of the pavement the sensible heat flux is defined based on the sum of heat fluxes due to climatic factors and pavement surface conditions fujimoto et al 2014 the heat flux q between air temperature ta and layers of water ice and salt on the pavement surface tpv is derived according to newton s law of cooling as fujimoto et al 2014 1 q α t pv t a 2 α 10 4 v w 0 7 2 2 where vw is the wind velocity the factor of pavement temperature immediately after salt application is more important than air temperature for converting snow or ice into a liquid solution keyser 1973 pavement surface temperature depends on the thermal transfers of the air temperature the amount of solar radiation salt water ice layers and wind speed and its direction typically the pavement surface temperature is higher than the air temperature based on the energy balance between climatic factors and the characteristics of the pavement surface according to thermal balance the air temperature changes with time due to atmospheric changes there is always a lag between air temperature and pavement surface temperature changes due to heat transfer from salt induced melting after salt application on the road surfaces during winter storm events 2 2 theoretical background of the model 2 2 1 long short term memory lstm artificial neural networks anns usually simply called neural networks nns are computing systems originally inspired by the biological neural networks that constitute animal brains dreyfus 1990 ann is based on a collection of connected units or nodes called artificial neurons which loosely model the neurons in a biological brain the basic example is the perceptron schmidhuber 2015 each connection like the axons in a biological brain can transmit signals to other neurons an artificial neuron that receives signals then processes the information and send signals to other neurons connected to it dreyfus 1990 rnns are a class of neural networks that allow previous outputs to be used as inputs while having hidden states schmidhuber 2015 the major advantage of rnns over anns is that rnns are capable of modeling sequence of data so that each sample can be assumed to be dependent on previous ones as a result the occurrence or effect to the result of one data point depends on the ones that preceded it rnns is normally the desired option for time series data for each timestep t the activation st and the output value ot are respectively expressed as kumar et al 2019 3 s t w s t 1 u x t 4 o t φ v s t where u w and v are weight matrix and σ and φ are activation functions rnn is normally a desired tool for data in a sequence or time series data since the occurrence or effect to the result of one data point depends on the ones that preceded it stanford university 2020 vanishing and exploding gradient may occur in the standard rnns stanford university 2020 two modified version of rnns gated recurrent unit gru and lstm deal with the vanishing gradient problem encountered by standard rnns fig 2 the lstm model is composed of input gate i forget gate f input modulation gate g and output gate o kumar et al 2019 they are usually noted and expressed as stanford university 2020 5 i σ w i h t 1 u i x t 6 f σ w f h t 1 u f x t 7 o σ w o h t 1 u o x t 8 g φ w g h t 1 u g x t 9 c t φ c t 1 f g i 10 h t c t o where x t and c t are the input and carry state at time step t respectively and h t 1 is the previous hidden state the forgotten gate f controls the amount of information which should be passed through the current cell and should be removed from previous memory cell h t 1 the transferred information is written to next memory cell h t via the carry state c t stajkowski et al 2020 the lstm code with and without attention model using python language are presented in the supplementary boxes s1a and s1b 2 2 2 convlstm and cnn lstm models the convolutional lstm convlstm model is a lstm model capable of maintaining input features as a three dimensions 3d instead of one dimensional 1d input feature in the lstm structure matrix transition of input to hidden state and hidden state to hidden state are defined based on convolution operations d angelo and palmieri 2021 the convlstm layer not only preserves the advantages of fully connected lstm but is also suitable for spatiotemporal data due to its inherent convolutional structure shi et al 2015 the cnn lstm model is an integration of a cnn with a lstm model which is able to process the data set in cnn which is constituted of two layers of convolution and pooling the one dimensional result is extracted from cnn into lstm sequences afterwards he et al 2019 the architecture of a convlstm and a cnn lstm is shown in figs 3 a b the convlstm and the cnn lstm codes with and without attention model employing the pytorch machine learning framework https pytorch org are presented in the supplementary boxes s2a s2b s3a and s3b 2 2 3 seq2seq and wavenet models the sequence to sequence seq2seq is kind of rnn which has been constituted from input sequences encoder and output sequences decoder with same length which has been introduced in 2014 for time series prediction du et al 2017 the deep neural network of seq2seq has been depicted in fig 4 a the wavelet neural network wavenet is a dilated casual convolutional dcc based on cnn which computes the sequential data faster than rnn oord et al 2016 oord et al 2018 fig 4 b shows the architecture of dcc with dilations 1 2 4 and 8 oord et al 2016 the wavenet model can grow in deeper layers vertically due to its flexible layers overall the wavenet model is a probabilistic and autoregressive model that can be used to calculate input sample in present timestep xt based on the sequences of samples in previous times x1 x2 xt 1 using conditional probability distribution as oord et al 2016 12 p x t 1 t p x t x 1 x 2 x t 1 the seq2seq and the wavenet models codes with and without attention model are presented in the supplementary boxes s4a s4b s5a and s5b 3 validation of the proposed methodology 3 1 description of validation case highway 401 is one of the major highways with the largest traffic volumes in southern ontario canada fig 5 the meteorological data will be collected from the toronto city station climate id 6158355 from environment and climate change canada eccc the defined weather station is located at approximately 43 40 00 000 n 79 24 00 000 w a sum of 10 895 dataset was analyzed based on input features of hourly average air temperature c and solar radiation kj m2 data sets and output feature of hourly pavement surface temperature for this route wind speed and its direction dataset were ignored in this research due to lack of dataset the dataset includes three chunk timesteps from november 2009 to march 2010 november 2011 to march 2012 and november 2013 to march 2014 the observed pavement surface temperature dataset was collected from rwis the pavement surface temperature dataset was acquired from cr 11 etobicoke station due to lack of hourly dataset in this station cr 23 highway 404 401 station was selected to be near to climatic toronto city station on highway 401 3 2 discussion of results a positive correlation of 1 and a negative correlation of 1 have been indicated as the strongest correlation coefficients between two variables the statistical correlation is visualized using a correlation matrix plot and heatmap in fig 6 to determine the measurement variables relationship to one another these plots represent a strong linear relationship between pavement temperature and air temperature while there is a poor correlation between pavement temperature and the five variables of year month day hour and solar radiation moreover the distribution of pavement temperature and air temperature is normal a symmetrical correlation matrix in fig 6 shows the correlation coefficient values between all observed variables typically the correlation of each variable with itself is 1 and lies on the diagonal line of the matrix the results show that the maximum positive correlation coefficient of 0 87 was observed between pavement temperature and air temperature the variables of month and year have correlations with observed pavement temperature of less than 0 3 the variables of day and solar radiation have negligible negative correlations of 0 0084 and 0 0025 with pavement temperature respectively the lstm convlstm cnn lstm seq2seq and wavenet models were implemented in tensorflow using keras library in python and were presented in two cases of with and without attention layer for pavement surface temperature prediction the attention layer is able to improve the memory performance in deep learning models via input data extraction and storing in memory cell ran et al 2019 the performance of the proposed models for predicting the pavement surface temperature as hourly based were evaluated using statistical and graphical methods the mean square error mse based on the variance of the errors measure the differences between the observed and predicted values fig 7 shows the performance of 6 hours ahead forecasting in training and validation states for all models without and with attention in terms of epoch numbers versus the mse these plots can evaluate the models performance on the training and validation data to obtain the best fitting learning curve using the optimal epochs and to prevent the model from overfitting or underfitting the mse values and epoch numbers have an inverse relationship the mse was reduced with a slight slope while the number of epochs increased in terms of training and validation data for all models the validation loss is lower than the training loss in all models and there is a good fit between training loss and validation loss roughly at 200 epochs the plots show that the best validation performance happened roughly in epoch 200 for all models the best validation error is the mse of 7 5e 4 in the optimal epoch 200 for the cnn lstm model with attention this study adopted different deep learning models to predict pavement surface temperature 1 2 4 and 6 h ahead the adam optimizer was applied with learning rate of 1 0e 4 which is more robust than the conventional stochastic gradient descent sgd diederik and jimmy 2014 a batch size of 32 and 200 epochs have been used in this research the relu activation function and the mse loss function as an objective function were used to train the models the proposed models performance statistic results are presented in table 1 the results demonstrate that all five proposed models predicted the measured pavement surface temperatures with a root mean square error rmse of less than 3 6 c a mean absolute error mae of less than 2 6 c however the three lstm based models i e lstm cnn lstm convlstm slightly outperformed the other two non lstm methods i e seq2seq wavenet the reason for the long short term memory lstm based models outperforming the non lstm methods relates to the pavement s thermal inertia which acts as a memory of the stored and released heat the lstm model can better learn the heat energy storage release characteristics of the pavement surface material and use this knowledge to more accurately forecasting pavement temperature time series of the three lstm based methods the cnn lstm has slightly smaller mean absolute percent error due to its architecture that allows for the learning of multiple variable within the convolutional neural network and temporal pavement responses to air temperature through the lstm this way the cnn lstm can discover more correlations between the variables and future pavement temperature responses this allows deep learning of the complex non linear relationships of various input parameters influencing the pavement temperature the cnn lstm model with attention has superior performance and smaller error values than the other proposed models the lowest value with the rmse of less than 2 c and the mae of less than 1 4 c are found for the cnn lstm model in the short range of 1 2 and 3 h ahead compared to the other models of the three lstm based methods the cnn lstm has slightly smaller mean absolute percent error likely due to it s architecture allowing deep learning of the complex non linear relationships of various input parameters influencing the pavement temperature as shown in fig 8 the observed pavement surface temperature was compared to rwis and cnn lstm models in range of 2 hours ahead forecasting the cnn lstm forecasting accuracy is better than the rwis forecasts in sudden changes of pavement surface temperature the prediction accuracy of the hybrid cnn lstm model is improved through the integration of the cnn layers with the lstm model the entire dataset which consists of 10 895 in three chunk timesteps was split 80 for training and 20 for testing figs 9 a b demonstrates that the cnn lstm and lstm models are well trained on the training and validation dataset and the cnn lstm model robustly forecasts hourly pavement temperatures this research shows that the prediction performance of hourly road pavement surface temperatures can be boosted using the cnn lstm model 4 conclusions each year road maintenance authorities in canada spend over one billion dollars on winter maintenance operations to keep roads open and safe to drive from late november to april mto 2007 driving conditions in winter months is compromised in northern climates due to the accumulation of snow and ice on the road surface and the associated reduction in vehicle traction on roads therefore the snow and ice control materials or deicers such as salts have a key role to keep roadways clear of ice snow and to ensure traffic safety and mobility during cold weather periods and snow storms while to mitigate road salt impacts on environment pavement surface temperature is a significant factor for modelling snowmelt it enhances prediction accuracy for precise salt application during a winter storm event on roadways in real time using advanced machine learning models the proposed cnn lstm with attention model predicts local pavement surface temperature based on small number of climate variables with high accuracy this new method optimizes road salt application rates for winter de icing operations and decrease adverse effects on both surface and groundwater resources in the salt vulnerable areas this study provides an assessment of the relationship between input features using correlation matrix it was shown that air temperature contributes to more accurate pavement surface temperature forecasts than solar radiation the evaluation of mse statistical metric shows that the proposed cnn lstm model as an advanced dnn model has better performance against four other proposed machine learning methods moreover the robustness of the proposed five deep learning models was extracted for 1 2 4 and 6 hours ahead using a mse loss function and a mae statistical metric the proposed cnn lstm with attention model forecasts pavement surface temperature with higher accuracy for the short times of 1 and 2 h ahead compared to previous forecasting methods it also demands less human and computational resources since pavement temperatures are able to absorb ambient heat for a short time based on thermal balance there are a few hours lag between pavement temperature and weather changes therefore the proposed cnn lstm models presented in this research are applicable due to their capability to maintain necessary information from previous time steps however the proposed model was assessed according to limited dataset of the most significant climatic variables that are available through the network of environment canada climate monitoring stations for future research the proposed methodology will be investigated for the development of the next generation of the smart salt trucks for precision salt application on roadways based on the real time weather forecasts and associated pavement temperatures to achieve road safety while minimizing harm to the salt vulnerable areas credit authorship contribution statement sepideh emami tabrizi conceptualization methodology writing original draft writing review editing visualization kai xiao methodology writing original draft jesse van griensven methodology resources writing original draft writing review editing supervision funding acquisition muhammad saad methodology hani farghaly conceptualization methodology writing original draft writing review editing supervision funding acquisition simon x yang methodology resources writing original draft supervision funding acquisition bahram gharabaghi conceptualization methodology resources writing original draft writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank generous funding from the ministry of transportation of ontario mto and the national sciences and engineering research council of canada nserc and support from the environment and climate change canada eccc appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126877 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4132,polycyclic aromatic hydrocarbons pahs are one of the most important pollution factors in the marine environment it is significant to expound their distribution in the complex marine environment for pollution prevention and control in our previous research we found that water exchange of pahs has an important influence on their concentration distribution in sediments with the help of delft3d technology a multi process coupled dynamic model of pahs was constructed being based on the survey data of liaodong bay from may to june 2015 the water exchange rate of pahs was calculated and studied by using mathematical statistics and numerical simulation the results showed that the half water exchange time of pahs in liaodong bay is about 57 580 days the water exchange rate of pahs has a significant influence on their concentration distribution of pahs in sediments where there is a high water exchange rate there the concentration of pahs in sediment was relatively low the closer areas are to bay head the lower the water exchange rate and the easier leading to the formation of high concentration areas of pahs in the sediments keywords pahs water exchange numerical simulation mathematical statistics 1 introduction the use of fossil fuels not only brings development dividends to human society but also introduces a kind of persistent toxic substances pahs to the environment erik et al 2020 wu et al 2011 timoszczuk et al 2021 khiari et al 2021 due to its strong toxicity to organisms carcinogenicity teratogenicity and mutagenicity pahs have attracted extensive attention of scholars james et al 1996 yang 2000a marko et al 2001 liao and yu 2020 due to the highly lipophilicity and strong hydrophobicity pahs are easily adsorbed on the suspended matter and moving with it which finally settle in the marine sediment zhang et al 2015 because of their stable chemical properties and not easy to degrade they can exist in the sediment for a long time and become the sink of pahs brion and pelletier 2005 qin et al 2011 zheng et al 2016 however pahs will be released to the marine environment again through the resuspension resulting in secondary pollution once the sediment environment changes such as seabed disturbance ph and salinity change therefore the study on the distribution characteristics and influencing factors of pahs concentration in sediment can effectively reveal the potential environmental pollution risk according to our previous research we found that the distribution of pollutants in the marine environment will be significantly affected by their water exchange rate zhang et al 2016 zhang et al 2021b in addition numerical simulation and mathematical statistics are effective means to reveal the dynamic mechanism of the pollutants such as pahs marinov et al 2009 javier et al 2012 at present scholars from various countries have carried out a lot of research on the water exchange of pollutants in the marine and achieved relatively mature research results parker first proposed the concept of using water exchange rate to characterize water exchange in 1972 and defined it as the ratio of inflow to outflow parker et al 1972 in 1984 prandle introduced the diffusion coefficient into the calculation equation which improved the accuracy of the model prandle 1984 since then many scholars have introduced some concepts and parameters into the calculation model such as tracer material turn over time half life time and residence time marking the maturity of water exchange rate calculation theory dale et al 2004 zhang et al 2009 lin et al 2019 half exchange time is the time required for the pollutants to complete 1 2 exchange in seawater which is the most effective index to express the rate of water exchange it is widely used in the study of water exchange in the bohai sea luo et al 2021 the baltic sea chubarenko and zakirov 2021 chesapeake bay xiong et al 2021 and many other places in the traditional research of water exchange the pollutant was regarded as a conservative substance i e assuming that the substance itself did not change with environmental conditions this is a general assumption for general pollutants theo et al 2020 however there are obvious defects in this way of model construction although the migration and transformation process of pollutants such as heavy metals and nutrients in the marine environment can be regarded as conservative substances this is because the physicochemical reactions of heavy metals in the marine environment are very slow due to the high concentration of nutrients in environment the effect of physicochemical reaction is not marked anggara et al 2004 pintilie et al 2007 chao et al 2010 however the physical and chemical changes of pahs in the process of migration and transformation cannot be ignored pahs are a kind of micro pollutants which physicochemical process is complex still regarding pahs as a conservative material to simulate will obviously lead to large errors in the simulation results marinov et al 2009 therefore the multi process coupled dynamic model based on the characteristic physical and chemical parameters of pahs is an important means to explore the water exchange rate of pahs in the marine environment and reveal the influence of hydrodynamic on its distribution liaodong bay has been taken as an example where oil and gas activities are the most frequent in china cheng et al 2021 in order to establish a multi process coupled pahs dynamic model the seawater atmosphere seawater sediment exchange equations and decomposition process were embedded into the pahs dynamic model by using delft3d technology accordingly the migration and transformation process of pahs in seawater was simulated in a more real form and the water exchange characteristic was studied the correlation between pahs concentration distribution and its water exchange rate in sediment was studied by using mathematical statistical regression analysis method and the influence of water exchange on pahs distribution was explained the purpose of this paper is to provide scientific reference for marine ecological environment protection precise pollution prevention and treatment and effective pahs pollution assessment 2 materials and methods 2 1 collection of field data 2 1 1 sample collection and processing the investigation and sampling of hydrology water quality and sediment in liaodong bay through field survey were carried out from may to june 2015 in two cruises there was total 61 sediment sampling sites at the same time in order to verify the accuracy of the numerical model three continuous water quality and hydrological observation stations were set up in the west a north b and south c of liaodong bay respectively grab sampler iron was used to get the surface sediment about 0 10 cm samples each seawater sampling stainless steel layered water sampler 5l station needed continuous sampling for 25 h every 2 h hydrologic observation flow velocity and flow direction was collected every 5 min by acoustic doppler current profiler adcp model whs600 depth unit size 600 khz the tidal data were verified for 25 h each hour by bayuquan tidal station t1 and suizhong tidal station t2 to learn more information please see the fig 1 all sediment samples from each station were freeze dried vacuum freeze dryer 24 h and ground 80 mesh sieve stored in brown glass bottles and then brought back to the laboratory for analysis seawater samples were enriched on site by envi c18 solid phase membrane disk flow rate 12 ml min 30 ml min vacuum filtration extraction wrapped in aluminum foil sealed and stored before testing spe samples zhang et al 2021b 2 1 2 sample purification about 15 0 g of the sediment samples was weighed and added with 15 0 g of anhydrous sodium sulfate 3 0 g of copper powder 100 ml of extraction solution acetone n hexane v v 1 1 and recovery indicators d8 p p ddt cb155 cb65 and tbb the samples were reflux extracted for 24 h through soxhlet apparatus the extract was evaporated to about 2 ml by rotary evaporation and stored in a collection bottle simultaneously the spe samples were extracted with dichloromethane 3 times 5 ml time and n hexane 2 times 5 ml time respectively and the extract was concentrated to about 2 0 ml by rotary evaporation for further purification all samples awaiting purification were separated and purified by chromatography on a silica gel alumina column using firstly n hexane 80 ml and then 7 3 v v dichloromethane n hexane 100 ml the eluate was concentrated to 200 μl by high purity nitrogen and spiked with terphenyl d14 10 μl 10 0 μg ml as the internal standard the spiked sample was then stored at 20 c until analysis zhang et al 2021a zhang et al 2021b pouch et al 2021 2 1 3 instrumental analysis the following 16 pahs that are listed as priority chemicals by the us epa were analyzed nap naphthalene ace acenaphthene any acenaphthylene flu fluorene phe phenanthrene ant anthracene flt fluoranthene pyr pyrene baa benzo a anthracene chr chrysene bbf benzo b fluoranthene bkf benzo k fluoranthene bap benzo a pyrene dba dibenzo a h anthracene bpy benzo g h i perylene idp indeno 1 2 3 cd pyrene the pahs were analyzed by gas chromatography mass spectrometry gc6890n msd5975b agilent co usa on a db 5 ms capillary column 30 m 0 25 mm 0 25 μm agilent co usa using the temperature gradient as follows start at 50 c and then increase to 220 c at 4 c min hold at 220 c for 3 min then increase to 300 c at 10 c min and hold at 300 c for 9 min other chromatography parameters were as follows 1 0 μl splitless injection injection temperature 280 c carrier gas helium constant flow at 1 0 ml min flow rate the electron impact ei ionization source was set to 230 c and the temperature of the quadrupole and transmission line was 150 c and 290 c selected ion monitoring sim was used and the scanning range was m z 0 500 amu khan et al 2020 sun et al 2021 zhang et al 2021b 2 1 4 quality assurance and quality control in the analysis of all samples and blanks the recovery rates of d8 p p ddt cb155 cb65 and tbb were 46 7 80 1 59 4 60 7 90 1 71 4 69 9 93 5 81 4 85 4 102 9 91 6 and 88 3 117 1 92 0 respectively analysis results of the blank showed that only the concentration of nap and phe were above limit of quantification less than 15 of the minimum concentration of the sample of the method all reported data have already subtracted the blank the limit of detection lod was set as 10 times the standard deviation of the spiked minimum concentration blank 10 sd han et al 2021 cao et al 2020 for the concentration volume was 200 μl the lod was 0 02 ng l for seawater and 0 05 ng g dry weight dw the same as below for sediment 2 2 numerical simulation method 2 2 1 construction of the pahs dynamics model through delft3d technology the multi process coupling dynamic model of pahs in liaodong bay was constructed fig 2 the dynamic equation was solved by using explicit and implicit alternating numerical integration method to simulate the migration and transformation process of pahs in marine environment cañizares et al 2001 lu and he 2012 liu et al 2013 theo et al 2020 the model equations are as follows hydrodynamic equations 1 ζ t h u x h u y 0 2 u t u u x v u y f v g ζ x u u 2 v 2 h ψ 2 0 3 v t u v x v v y f u g ζ y v u 2 v 2 h ψ 2 0 pahs kinetic diffusion 4 c i t x v e c i σ tx x y v e c i σ ty y u c i x v c i y q exchange dynamics of pahs between seawater and atmosphere 5 r vol k vol c i c equ h 6 k vol 1 1 k l r g t e m 273 15 n g p k g e a 1 a 2 t e m 273 15 exchange dynamics of pahs between seawater and seabed 7 r p v p c i 8 c i c sed c par c d if v p 0 0 c w c par c d if v p 0 0 9 r d φ d sw c sed c w l sw comprehensive decomposition degradation process 10 r k 0 k 1 k t c i stokes formula 11 v 0 ω ρ t ρ 0 v e g d 2 where t is time u v are the velocity components in the x y directions ζ is the water level h is the water depth f is the coriolis parameter ψ is the chézy coefficient ve is the seawater viscosity coefficient ci cequ csed cw cpar and cd are the total concentration equilibrium concentration sediment concentration concentration in upper overlying water particle adsorption state concentration and free dissolved state concentration of pahs respectively σtx and σty are the turbulent diffusion coefficient in x and y direction q is the pollutant discharge intensity rvol is the seawater air exchange rate h is the water depth kvol is the seawater air exchange coefficient kl is the transfer coefficient for the liquid film kg is the transfer coefficient for the gas film a 1 is the temperature coefficient for volatization entropy a 2 is the temperature coefficient for volatilization enthalpy tem is the ambient temperature p is the atmospheric pressure rg is the gas constant ng is the number of moles in a m3 gas rp is the permeation flux vp seepage velocity rd is the diffusion flux φ is the sediment porosity dsw is the diffusion coefficient lsw is the thickness of the overlying water layer r is the decomposition rate of pahs k0 is the zero order reaction constant k1 is the first order reaction constant kt is the thermodynamic constant v 0 is the pahs sedimentation rate ω is the concentration of adsorbed pahs ρt is the density of suspended particles ρ 0 is the density of sea water g is the acceleration of gravity and d is the size of suspended particles 2 2 2 initial conditions and model parameter initial conditions in the ocean numerical calculation the initial flow field is difficult to determine so the cold boot method is generally adopted to start the calculation kent et al 2001 lee et al 2006 in addition the initial conditions have nothing to do with the final calculation results wang et al 2017 consequently the initial conditions were set as follow 12 u x y t 0 u 0 x y v x y t 0 u 0 x y v x y t 0 u 0 x y where u and v are the initial velocity components in x and y directions respectively and ζ is the initial tidal level in this study the initial velocity and tidal level were both zero the pollution source intensity in the model took the equivalent average value of 120 μg l wang et al 2011 the location of the discharge sources of pahs is shown in fig 1 parameter setting the boundary of the liaodong bay sea area was extracted from the satellite remote sensing image arcgis 10 3 esri was applied to vectorize the terrain water depth and boundary and determine the open and closed boundary as well as the calculation domain the calculation domain was transformed into 24 578 192 128 orthogonal curved grids the orthogonal value of all curved grids was greater than 96 0 and the grid orthogonal rate was more than 99 6 the calculation domain calculation grid and boundary conditions are shown in the fig 3 the watershed of liaodong bay with a resident population of more than 8 million is located in the heavy industrial region in northeast china which has a large number of petrochemical industries and ports liaodong bay has a vast territory with an area of more than 10 thousand square kilometers the water depth is shallow here ranging from 5 to 25 m where the topographic relief varies smooth the world bank 1990 hu et al 2013 two dimensional ocean hydrodynamics model is very suitable to be adopted here deltares 2007 according to the ratio of the total area of the study area to the spatial grid step size the time step size was set as 5 0 min in the study area the main driving forces of current include gravity geostrophic deflection force tide and tide the gravity acceleration g is 9 81 m s2 the seawater density is 1024 2 kg m3 the diffusion and viscosity coefficients are 10 1 m2 s and 1 0 10 6 m2 s the tidal harmonic constants were obtained from the harmonic analysis of 2015 tidal data k1 o1 p1 q1 m2 s2 n2 k2 the calibration parameters of pahs model are shown in table 1 parameters of pahs dynamics model are shown in table 2 2 3 numerical calculation of the half exchange time of pahs in the seawater initial conditions in order to facilitate the assessment of water exchange capacity of pahs the initial concentration of pahs in liaodong bay was set as ϛ0 ϛ0 300 μg l and the initial concentration of pahs outside the bay was set as 0 with the start of numerical simulation the seawater in the calculation domain would be exchanged with the outside seawater to complete the material transportation and migration of pahs the specific method was when the rising tide occurred the external seawater clean water flowed into the bay and mixed with the initial seawater so as to reduce the concentration of pahs in the bay with the continuous process of rising tide the water exchange would be further completed towards the inner area of the bay when the falling tide occurred the higher concentration of pahs in the bay would diffuse out of the bay and interact with fresh seawater and accomplish the transport and transfer of pahs from the bay to the outside finally when the next tidal cycled the last cycle would be repeated until the exchange of pahs in liaodong bay were completed in order to improve the accuracy of numerical simulation results three trial calculations were carried out before the formal calculation the results showed that when the simulation time was about 575 592 days the half exchange of pahs was completed in 98 5 of liaodong bay area therefore the total calculation time of the model was set as 600 days i e 1200 tidal cycles in order to study the diffusion of pahs in different areas in detail seven simulation prediction points s1 s7 were set up from north to south in liaodong bay fig 3 3 results and discussion 3 1 pollution and distribution characteristics of pahs 3 1 1 pollution level of pahs the total concentrations of 16 pahs σpahs in the surface sediments of liaodong bay ranged from 83 2 to 296 4 ng g according to the σpahs pollution level classification method yang et al 2020b proposed by baumard et al 1998 which divided the pahs pollution in sediments into four levels according to their concentration 0 100 ng g for mild pollution 100 1000 ng g for moderate pollution 1000 5000 ng g for high pollution and more than 5000 ng g for severe pollution the sediment in liaodong bay was in the moderate pollution level of pahs 3 1 2 spatial distribution characteristics of pahs in order to study the spatial distribution characteristics of pahs in liaodong bay lagrange interpolation polynomial method was used to interpolate the monitoring results of pahs in liaodong bay fig 4 the results showed that the pahs in liaodong bay sediments had an obvious and variant characteristic of spatial distribution among them the concentration of pahs in the northern region was relatively the highest where the concentration of σpahs was higher than 180 ng g showing an east west coastal distribution especially in jinzhou bay σpahs greater than 260 ng g the concentration of pahs in the sediments of the middle east and middle west was relatively low where the concentration of σpahs was basically in the range of 90 120 ng g in addition more than 50 of the area was less than 100 ng g which was in the low pollution level of pahs the concentration of pahs in the sediments of the south sea area was the lowest which was in the range of 90 130 ng g where most of the sea areas were in the low pollution level of pahs in general the concentration of σpahs in liaodong bay was higher in the north than in the south simultaneously higher in the west than in the east 3 2 model accuracy verification in order to ensure the accuracy of the numerical simulation the numerical simulation model was verified according to the measured data of tide level flow velocity flow direction and σpahs concentration in water phase continuously observed for 25 h at quality control stations a b and c the results of model accuracy verification are shown in fig 5 and fig 6 the statistical method proposed by willmott 1981 was used to evaluate the proposed model by calculating a skill score as follows skill 1 i 1 n m i d i 2 i 1 n m i d d i d 2 where m i represents the simulated value d i represents the observed value d represents the observed average value n represents the number of water samples i 1 2 n skill represents the degree of correlation between the deviation of the observed value and the observed average value and the deviation of the simulated value and the observed average value the model s performance is rated according to the skill value as follows less than0 2 poor 0 21 0 5 good 0 51 0 65 very good 0 66 0 99 excellent 1 complete agreement with observed data willmott 1981 zhang et al 2021b fig 5 and fig 6 show the model accuracy verification results the skill values of the proposed model were all excellent attaining 0 89 0 98 for tide level 0 82 0 94 for flow velocity 0 89 0 96 for flow direction and 0 85 0 95 for pahs concentration in seawater respectively the results of verification were excellent which indicated that the hydrodynamic model was reliable 3 3 analysis of the water exchange of pahs 3 3 1 temporal and spatial distribution characteristics of half exchange time in order to explore the spatial and temporal distribution of water exchange capacity in liaodong bay the migration and transformation of pahs in a certain time span were simulated based on the numerical calculation model with the help of arcgis spatial vector analysis technology the water exchange of pahs in liaodong bay was analyzed fig 7 shows the concentration distribution of pahs on the 150th 300th 450th and 600th days of the numerical simulation it shows the temporal and spatial evolution of pahs migration and diffusion in liaodong bay spatially the exchange of pahs in liaodong bay was completed from outside to inside under the force of hydrodynamic where the diffusion rate of pahs varied with the distance from the bay mouth generally the exchange rate gradually increased from bay head to the bay mouth at the same time the diffusion rate of pahs was not the same in the area with the same distance from the bay mouth showing the distributing characteristic that the area in the east was higher than the west while in the view of time line 0 150 days the half exchange of pahs in outer bay was first completed with a rapid diffusion rate while the inner bay was not complete even more the simulated concentration of pahs not changing 150 300 days the half exchange of pahs in liaodong bay was basically completed except for the waters north of the central part 300 450 days the half exchange of pahs was almost 70 completed except in the coastal waters of jinzhou and panjin 450 600 days the results showed that the half exchange of pahs in liaodong bay was basically completed but the half exchange of pahs in some estuaries such as shuangtaizi river daling river and xiaoling river was still incomplete which indicated that the hydrodynamic force and water exchange capacity here were weak and the pahs pollutants being able to stay for a long time in order to study the migration and diffusion characteristic of pahs in different areas of liaodong bay meticulously being based on the numerical calculation model this paper simulated and extracted the change process of pahs concentration with time at 7 simulation prediction points the simulation time was set as 600 days the change curve of pahs concentration with time at each station was drawn as shown in fig 8 according to the simulation results fig 8 pahs gradually diffused from the inside of the bay to the outside of the bay under the hydrodynamic effect and the pollutant concentration decreased together among them the diffusion rate of pahs in s1 and s2 stations in the bay was slow and the half exchange time of pahs was about 600 days from the change trend of pahs concentration curve the change of pahs exchange rate in the whole process was small which indicated that the diffusion effect of seawater here was weak the diffusion rate of pahs in s3 s4 and s5 was faster than that in s1 and s2 in terms of time when the simulation time reached 100 days the concentration of pahs began to decrease sharply which indicated that the clean seawater outside the bay was mixing with the continuous simulation when the simulation time reached about 450 days the concentration of pahs at these three stations reached about 1 2 of the initial value and the half exchange of pahs was basically completed the diffusion rate of pahs in s6 and s7 at liaodong bay entrance was obviously higher than that of each station in the bay taking s7 station as an example when the simulation time was about 10 days the half exchange of pahs had basically completed with the simulation process due to the influence of the diffusion of high concentration pahs in the inner bay the concentration of pahs increased slightly but after the 100th day of the simulation time the concentration of pahs stabilized below 1 2 in order to intuitively analyze the change of pahs diffusion rate in inner and outer liaodong bay this paper made regression analysis and comparative study on the process curve of simulated results of pahs at s1 and s7 stations see fig 8 it could be seen that in the first 100 days of the simulation the diffusion rate of pahs at s7 station was much higher than that at s1 station while the diffusion rate of pahs at s1 station was always relatively stable and the exchange of pahs was completed slowly 3 3 2 characteristics of water exchange of pahs in liaodong bay taking the half exchange time of pahs in each grid in the computational domain as a unit the half exchange time distribution map of liaodong bay pahs was drawn after all grid units were superimposed by using the space vector computing function of arcgis generally the half exchange time of pahs in liaodong bay was between 57 and 580 days compared with other sea areas in china the water exchange capacity of liaodong bay was moderate at the same time the temporal and spatial distribution of pahs half exchange in liaodong bay presented two characteristics firstly the closer the area next to the bay mouth the less the half exchange time costed secondly when the distance was the same to the bay mouth the half exchange time in the east was obviously shorter than that in the west in order to analyze the distribution characteristics of the water half exchange capacity of pahs in liaodong bay the sea area of liaodong bay was divided into five areas east south west north and central see fig 9 among them the southern region was closest to the bay mouth with the strongest water exchange capacity and the half exchange time of pahs ranged from 57 to 180 days the central region was closed to the bay mouth where the offshore distance was far away which may be less affected by the nearshore human activities compared with other regions with a strong water exchange capacity and the half exchange time of water ranging from 180 to 300 days the distance between the eastern region and the bay mouth was basically the same but the water depth and flow velocity in the eastern region was higher than that in the western region and the half exchange time of pahs was 120 300 days eastern 180 480 days western based on the calculation results the northern region was the farthest from the bay mouth and the water exchange capacity was the worst that the half exchange time of pahs in jinzhou and yingkou coastal area was about 360 days even more than 500 days in shuangtaizi estuary where the water depth was shallow the hydrodynamic force was weak and the retention effect of pahs pollutants was obvious 3 4 relationship between pahs water exchange capacity and distribution in sediment in order to explore the correlation between pahs water exchange capacity and theirs distribution characteristics in the sediment of liaodong bay the half exchange time of pahs in 61 sediment sampling sites was extracted by delft3d the regression analysis was carried out with the measured pahs concentration in the sediment as dependent variable y axis and the inverse of half exchange time i e water exchange rate as the independent variable x axis the correlation analysis diagram of pahs concentration and water exchange rate was drawn fig 10 it could be seen from the fig 10 that the water exchange rate had a significant impact on the material distribution of pahs in sediments from the trend analysis results with the increase of water exchange rate the concentration of pahs in sediments showed an obvious downward trend on the contrary when the water exchange rate was low it could be seen that the concentration of pahs in sediments was basically higher from the respective characteristics of each region five regions the northern region had the lowest water exchange rate poor hydrodynamic conditions and the farthest migration distance from the sea area outside the bay where there were many estuaries in the northern region and the interaction between sea and land was strong which may further extended the retention time of pahs in this region and increased the difficulty of pollutant migration and diffusion outside the bay therefore the diffusion rate of pahs in the northern region was the lowest in addition there was a negative correlation between the water exchange rate and pahs concentration in the northern region which was characterized by high pollutant concentration and low water exchange rate the results showed that the water exchange rate in the central and western regions was slightly higher than that in the northern regions the hydrodynamic conditions were better and the diffusion distance to the outside of the bay was relatively close although the pahs in the regional seawater would subside to a certain extent on the way out of the bay the sedimentation effect was obviously lower than that in the northern regions from the distribution of pahs in the sediments in general the water exchange rate was negatively correlated with the pahs concentration in sediments the results showed that the hydrodynamic conditions in the south and the east were better where the distance between the south and the sea area outside the bay was the nearest so that the pollutant diffusion rate was the fastest therefore the concentration of pahs in the sediments of this area was the lowest which had a negative correlation with water exchange rate moreover it could also be seen from fig 9 that some stations in the southern region had a phenomenon that both of the water exchange rate and pollutant concentration were high which might be closely related to the intensive distribution of offshore oil and gas production activities in the central bohai sea southern liaodong bay in conclusion the distribution of pahs in the sediments with high effluent exchange rate was low which indicated that the water exchange rate had a significant effect on the material distribution of pahs in the sediments and was one of the important reasons for the difference of material distribution of pahs in the sediments 4 conclusions the total concentrations of 16 pahs σpahs ranged from 83 2 ng g to 296 4 ng g in liaodong bay where was in the moderate pollution level of pahs according to the spatial distribution of pahs the concentration in the north was higher than that in the south and that in the west was higher than that in the east the half exchange time of pahs in liaodong bay was about 57 580 days where there were two main distribution characteristics one was that the closer the area was to the bay mouth the higher the water exchange rate of pahs the other was that the water exchange rate of pahs in the east was higher than the west of liaodong bay the results of mathematical statistics regression analysis showed that the water exchange rate had a significant effect on the distribution of pahs in sediments if where there was a high water exchange rate it would be not easy for pollutants pahs deposition and enrichment and vice versa credit authorship contribution statement jiayi cheng conceptualization methodology data curation writing original draft jianbo han project administration investigation formal analysis methodology supervision binghui zheng investigation formal analysis writing review editing xiaomeng wang investigation formal analysis zhengxian yang investigation formal analysis xiaoxia zhang conceptualization methodology data curation investigation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china no 2017yfa0604904 the authors sincerely thank professor shao tao and wu for assistance in sampling and analysis 
4132,polycyclic aromatic hydrocarbons pahs are one of the most important pollution factors in the marine environment it is significant to expound their distribution in the complex marine environment for pollution prevention and control in our previous research we found that water exchange of pahs has an important influence on their concentration distribution in sediments with the help of delft3d technology a multi process coupled dynamic model of pahs was constructed being based on the survey data of liaodong bay from may to june 2015 the water exchange rate of pahs was calculated and studied by using mathematical statistics and numerical simulation the results showed that the half water exchange time of pahs in liaodong bay is about 57 580 days the water exchange rate of pahs has a significant influence on their concentration distribution of pahs in sediments where there is a high water exchange rate there the concentration of pahs in sediment was relatively low the closer areas are to bay head the lower the water exchange rate and the easier leading to the formation of high concentration areas of pahs in the sediments keywords pahs water exchange numerical simulation mathematical statistics 1 introduction the use of fossil fuels not only brings development dividends to human society but also introduces a kind of persistent toxic substances pahs to the environment erik et al 2020 wu et al 2011 timoszczuk et al 2021 khiari et al 2021 due to its strong toxicity to organisms carcinogenicity teratogenicity and mutagenicity pahs have attracted extensive attention of scholars james et al 1996 yang 2000a marko et al 2001 liao and yu 2020 due to the highly lipophilicity and strong hydrophobicity pahs are easily adsorbed on the suspended matter and moving with it which finally settle in the marine sediment zhang et al 2015 because of their stable chemical properties and not easy to degrade they can exist in the sediment for a long time and become the sink of pahs brion and pelletier 2005 qin et al 2011 zheng et al 2016 however pahs will be released to the marine environment again through the resuspension resulting in secondary pollution once the sediment environment changes such as seabed disturbance ph and salinity change therefore the study on the distribution characteristics and influencing factors of pahs concentration in sediment can effectively reveal the potential environmental pollution risk according to our previous research we found that the distribution of pollutants in the marine environment will be significantly affected by their water exchange rate zhang et al 2016 zhang et al 2021b in addition numerical simulation and mathematical statistics are effective means to reveal the dynamic mechanism of the pollutants such as pahs marinov et al 2009 javier et al 2012 at present scholars from various countries have carried out a lot of research on the water exchange of pollutants in the marine and achieved relatively mature research results parker first proposed the concept of using water exchange rate to characterize water exchange in 1972 and defined it as the ratio of inflow to outflow parker et al 1972 in 1984 prandle introduced the diffusion coefficient into the calculation equation which improved the accuracy of the model prandle 1984 since then many scholars have introduced some concepts and parameters into the calculation model such as tracer material turn over time half life time and residence time marking the maturity of water exchange rate calculation theory dale et al 2004 zhang et al 2009 lin et al 2019 half exchange time is the time required for the pollutants to complete 1 2 exchange in seawater which is the most effective index to express the rate of water exchange it is widely used in the study of water exchange in the bohai sea luo et al 2021 the baltic sea chubarenko and zakirov 2021 chesapeake bay xiong et al 2021 and many other places in the traditional research of water exchange the pollutant was regarded as a conservative substance i e assuming that the substance itself did not change with environmental conditions this is a general assumption for general pollutants theo et al 2020 however there are obvious defects in this way of model construction although the migration and transformation process of pollutants such as heavy metals and nutrients in the marine environment can be regarded as conservative substances this is because the physicochemical reactions of heavy metals in the marine environment are very slow due to the high concentration of nutrients in environment the effect of physicochemical reaction is not marked anggara et al 2004 pintilie et al 2007 chao et al 2010 however the physical and chemical changes of pahs in the process of migration and transformation cannot be ignored pahs are a kind of micro pollutants which physicochemical process is complex still regarding pahs as a conservative material to simulate will obviously lead to large errors in the simulation results marinov et al 2009 therefore the multi process coupled dynamic model based on the characteristic physical and chemical parameters of pahs is an important means to explore the water exchange rate of pahs in the marine environment and reveal the influence of hydrodynamic on its distribution liaodong bay has been taken as an example where oil and gas activities are the most frequent in china cheng et al 2021 in order to establish a multi process coupled pahs dynamic model the seawater atmosphere seawater sediment exchange equations and decomposition process were embedded into the pahs dynamic model by using delft3d technology accordingly the migration and transformation process of pahs in seawater was simulated in a more real form and the water exchange characteristic was studied the correlation between pahs concentration distribution and its water exchange rate in sediment was studied by using mathematical statistical regression analysis method and the influence of water exchange on pahs distribution was explained the purpose of this paper is to provide scientific reference for marine ecological environment protection precise pollution prevention and treatment and effective pahs pollution assessment 2 materials and methods 2 1 collection of field data 2 1 1 sample collection and processing the investigation and sampling of hydrology water quality and sediment in liaodong bay through field survey were carried out from may to june 2015 in two cruises there was total 61 sediment sampling sites at the same time in order to verify the accuracy of the numerical model three continuous water quality and hydrological observation stations were set up in the west a north b and south c of liaodong bay respectively grab sampler iron was used to get the surface sediment about 0 10 cm samples each seawater sampling stainless steel layered water sampler 5l station needed continuous sampling for 25 h every 2 h hydrologic observation flow velocity and flow direction was collected every 5 min by acoustic doppler current profiler adcp model whs600 depth unit size 600 khz the tidal data were verified for 25 h each hour by bayuquan tidal station t1 and suizhong tidal station t2 to learn more information please see the fig 1 all sediment samples from each station were freeze dried vacuum freeze dryer 24 h and ground 80 mesh sieve stored in brown glass bottles and then brought back to the laboratory for analysis seawater samples were enriched on site by envi c18 solid phase membrane disk flow rate 12 ml min 30 ml min vacuum filtration extraction wrapped in aluminum foil sealed and stored before testing spe samples zhang et al 2021b 2 1 2 sample purification about 15 0 g of the sediment samples was weighed and added with 15 0 g of anhydrous sodium sulfate 3 0 g of copper powder 100 ml of extraction solution acetone n hexane v v 1 1 and recovery indicators d8 p p ddt cb155 cb65 and tbb the samples were reflux extracted for 24 h through soxhlet apparatus the extract was evaporated to about 2 ml by rotary evaporation and stored in a collection bottle simultaneously the spe samples were extracted with dichloromethane 3 times 5 ml time and n hexane 2 times 5 ml time respectively and the extract was concentrated to about 2 0 ml by rotary evaporation for further purification all samples awaiting purification were separated and purified by chromatography on a silica gel alumina column using firstly n hexane 80 ml and then 7 3 v v dichloromethane n hexane 100 ml the eluate was concentrated to 200 μl by high purity nitrogen and spiked with terphenyl d14 10 μl 10 0 μg ml as the internal standard the spiked sample was then stored at 20 c until analysis zhang et al 2021a zhang et al 2021b pouch et al 2021 2 1 3 instrumental analysis the following 16 pahs that are listed as priority chemicals by the us epa were analyzed nap naphthalene ace acenaphthene any acenaphthylene flu fluorene phe phenanthrene ant anthracene flt fluoranthene pyr pyrene baa benzo a anthracene chr chrysene bbf benzo b fluoranthene bkf benzo k fluoranthene bap benzo a pyrene dba dibenzo a h anthracene bpy benzo g h i perylene idp indeno 1 2 3 cd pyrene the pahs were analyzed by gas chromatography mass spectrometry gc6890n msd5975b agilent co usa on a db 5 ms capillary column 30 m 0 25 mm 0 25 μm agilent co usa using the temperature gradient as follows start at 50 c and then increase to 220 c at 4 c min hold at 220 c for 3 min then increase to 300 c at 10 c min and hold at 300 c for 9 min other chromatography parameters were as follows 1 0 μl splitless injection injection temperature 280 c carrier gas helium constant flow at 1 0 ml min flow rate the electron impact ei ionization source was set to 230 c and the temperature of the quadrupole and transmission line was 150 c and 290 c selected ion monitoring sim was used and the scanning range was m z 0 500 amu khan et al 2020 sun et al 2021 zhang et al 2021b 2 1 4 quality assurance and quality control in the analysis of all samples and blanks the recovery rates of d8 p p ddt cb155 cb65 and tbb were 46 7 80 1 59 4 60 7 90 1 71 4 69 9 93 5 81 4 85 4 102 9 91 6 and 88 3 117 1 92 0 respectively analysis results of the blank showed that only the concentration of nap and phe were above limit of quantification less than 15 of the minimum concentration of the sample of the method all reported data have already subtracted the blank the limit of detection lod was set as 10 times the standard deviation of the spiked minimum concentration blank 10 sd han et al 2021 cao et al 2020 for the concentration volume was 200 μl the lod was 0 02 ng l for seawater and 0 05 ng g dry weight dw the same as below for sediment 2 2 numerical simulation method 2 2 1 construction of the pahs dynamics model through delft3d technology the multi process coupling dynamic model of pahs in liaodong bay was constructed fig 2 the dynamic equation was solved by using explicit and implicit alternating numerical integration method to simulate the migration and transformation process of pahs in marine environment cañizares et al 2001 lu and he 2012 liu et al 2013 theo et al 2020 the model equations are as follows hydrodynamic equations 1 ζ t h u x h u y 0 2 u t u u x v u y f v g ζ x u u 2 v 2 h ψ 2 0 3 v t u v x v v y f u g ζ y v u 2 v 2 h ψ 2 0 pahs kinetic diffusion 4 c i t x v e c i σ tx x y v e c i σ ty y u c i x v c i y q exchange dynamics of pahs between seawater and atmosphere 5 r vol k vol c i c equ h 6 k vol 1 1 k l r g t e m 273 15 n g p k g e a 1 a 2 t e m 273 15 exchange dynamics of pahs between seawater and seabed 7 r p v p c i 8 c i c sed c par c d if v p 0 0 c w c par c d if v p 0 0 9 r d φ d sw c sed c w l sw comprehensive decomposition degradation process 10 r k 0 k 1 k t c i stokes formula 11 v 0 ω ρ t ρ 0 v e g d 2 where t is time u v are the velocity components in the x y directions ζ is the water level h is the water depth f is the coriolis parameter ψ is the chézy coefficient ve is the seawater viscosity coefficient ci cequ csed cw cpar and cd are the total concentration equilibrium concentration sediment concentration concentration in upper overlying water particle adsorption state concentration and free dissolved state concentration of pahs respectively σtx and σty are the turbulent diffusion coefficient in x and y direction q is the pollutant discharge intensity rvol is the seawater air exchange rate h is the water depth kvol is the seawater air exchange coefficient kl is the transfer coefficient for the liquid film kg is the transfer coefficient for the gas film a 1 is the temperature coefficient for volatization entropy a 2 is the temperature coefficient for volatilization enthalpy tem is the ambient temperature p is the atmospheric pressure rg is the gas constant ng is the number of moles in a m3 gas rp is the permeation flux vp seepage velocity rd is the diffusion flux φ is the sediment porosity dsw is the diffusion coefficient lsw is the thickness of the overlying water layer r is the decomposition rate of pahs k0 is the zero order reaction constant k1 is the first order reaction constant kt is the thermodynamic constant v 0 is the pahs sedimentation rate ω is the concentration of adsorbed pahs ρt is the density of suspended particles ρ 0 is the density of sea water g is the acceleration of gravity and d is the size of suspended particles 2 2 2 initial conditions and model parameter initial conditions in the ocean numerical calculation the initial flow field is difficult to determine so the cold boot method is generally adopted to start the calculation kent et al 2001 lee et al 2006 in addition the initial conditions have nothing to do with the final calculation results wang et al 2017 consequently the initial conditions were set as follow 12 u x y t 0 u 0 x y v x y t 0 u 0 x y v x y t 0 u 0 x y where u and v are the initial velocity components in x and y directions respectively and ζ is the initial tidal level in this study the initial velocity and tidal level were both zero the pollution source intensity in the model took the equivalent average value of 120 μg l wang et al 2011 the location of the discharge sources of pahs is shown in fig 1 parameter setting the boundary of the liaodong bay sea area was extracted from the satellite remote sensing image arcgis 10 3 esri was applied to vectorize the terrain water depth and boundary and determine the open and closed boundary as well as the calculation domain the calculation domain was transformed into 24 578 192 128 orthogonal curved grids the orthogonal value of all curved grids was greater than 96 0 and the grid orthogonal rate was more than 99 6 the calculation domain calculation grid and boundary conditions are shown in the fig 3 the watershed of liaodong bay with a resident population of more than 8 million is located in the heavy industrial region in northeast china which has a large number of petrochemical industries and ports liaodong bay has a vast territory with an area of more than 10 thousand square kilometers the water depth is shallow here ranging from 5 to 25 m where the topographic relief varies smooth the world bank 1990 hu et al 2013 two dimensional ocean hydrodynamics model is very suitable to be adopted here deltares 2007 according to the ratio of the total area of the study area to the spatial grid step size the time step size was set as 5 0 min in the study area the main driving forces of current include gravity geostrophic deflection force tide and tide the gravity acceleration g is 9 81 m s2 the seawater density is 1024 2 kg m3 the diffusion and viscosity coefficients are 10 1 m2 s and 1 0 10 6 m2 s the tidal harmonic constants were obtained from the harmonic analysis of 2015 tidal data k1 o1 p1 q1 m2 s2 n2 k2 the calibration parameters of pahs model are shown in table 1 parameters of pahs dynamics model are shown in table 2 2 3 numerical calculation of the half exchange time of pahs in the seawater initial conditions in order to facilitate the assessment of water exchange capacity of pahs the initial concentration of pahs in liaodong bay was set as ϛ0 ϛ0 300 μg l and the initial concentration of pahs outside the bay was set as 0 with the start of numerical simulation the seawater in the calculation domain would be exchanged with the outside seawater to complete the material transportation and migration of pahs the specific method was when the rising tide occurred the external seawater clean water flowed into the bay and mixed with the initial seawater so as to reduce the concentration of pahs in the bay with the continuous process of rising tide the water exchange would be further completed towards the inner area of the bay when the falling tide occurred the higher concentration of pahs in the bay would diffuse out of the bay and interact with fresh seawater and accomplish the transport and transfer of pahs from the bay to the outside finally when the next tidal cycled the last cycle would be repeated until the exchange of pahs in liaodong bay were completed in order to improve the accuracy of numerical simulation results three trial calculations were carried out before the formal calculation the results showed that when the simulation time was about 575 592 days the half exchange of pahs was completed in 98 5 of liaodong bay area therefore the total calculation time of the model was set as 600 days i e 1200 tidal cycles in order to study the diffusion of pahs in different areas in detail seven simulation prediction points s1 s7 were set up from north to south in liaodong bay fig 3 3 results and discussion 3 1 pollution and distribution characteristics of pahs 3 1 1 pollution level of pahs the total concentrations of 16 pahs σpahs in the surface sediments of liaodong bay ranged from 83 2 to 296 4 ng g according to the σpahs pollution level classification method yang et al 2020b proposed by baumard et al 1998 which divided the pahs pollution in sediments into four levels according to their concentration 0 100 ng g for mild pollution 100 1000 ng g for moderate pollution 1000 5000 ng g for high pollution and more than 5000 ng g for severe pollution the sediment in liaodong bay was in the moderate pollution level of pahs 3 1 2 spatial distribution characteristics of pahs in order to study the spatial distribution characteristics of pahs in liaodong bay lagrange interpolation polynomial method was used to interpolate the monitoring results of pahs in liaodong bay fig 4 the results showed that the pahs in liaodong bay sediments had an obvious and variant characteristic of spatial distribution among them the concentration of pahs in the northern region was relatively the highest where the concentration of σpahs was higher than 180 ng g showing an east west coastal distribution especially in jinzhou bay σpahs greater than 260 ng g the concentration of pahs in the sediments of the middle east and middle west was relatively low where the concentration of σpahs was basically in the range of 90 120 ng g in addition more than 50 of the area was less than 100 ng g which was in the low pollution level of pahs the concentration of pahs in the sediments of the south sea area was the lowest which was in the range of 90 130 ng g where most of the sea areas were in the low pollution level of pahs in general the concentration of σpahs in liaodong bay was higher in the north than in the south simultaneously higher in the west than in the east 3 2 model accuracy verification in order to ensure the accuracy of the numerical simulation the numerical simulation model was verified according to the measured data of tide level flow velocity flow direction and σpahs concentration in water phase continuously observed for 25 h at quality control stations a b and c the results of model accuracy verification are shown in fig 5 and fig 6 the statistical method proposed by willmott 1981 was used to evaluate the proposed model by calculating a skill score as follows skill 1 i 1 n m i d i 2 i 1 n m i d d i d 2 where m i represents the simulated value d i represents the observed value d represents the observed average value n represents the number of water samples i 1 2 n skill represents the degree of correlation between the deviation of the observed value and the observed average value and the deviation of the simulated value and the observed average value the model s performance is rated according to the skill value as follows less than0 2 poor 0 21 0 5 good 0 51 0 65 very good 0 66 0 99 excellent 1 complete agreement with observed data willmott 1981 zhang et al 2021b fig 5 and fig 6 show the model accuracy verification results the skill values of the proposed model were all excellent attaining 0 89 0 98 for tide level 0 82 0 94 for flow velocity 0 89 0 96 for flow direction and 0 85 0 95 for pahs concentration in seawater respectively the results of verification were excellent which indicated that the hydrodynamic model was reliable 3 3 analysis of the water exchange of pahs 3 3 1 temporal and spatial distribution characteristics of half exchange time in order to explore the spatial and temporal distribution of water exchange capacity in liaodong bay the migration and transformation of pahs in a certain time span were simulated based on the numerical calculation model with the help of arcgis spatial vector analysis technology the water exchange of pahs in liaodong bay was analyzed fig 7 shows the concentration distribution of pahs on the 150th 300th 450th and 600th days of the numerical simulation it shows the temporal and spatial evolution of pahs migration and diffusion in liaodong bay spatially the exchange of pahs in liaodong bay was completed from outside to inside under the force of hydrodynamic where the diffusion rate of pahs varied with the distance from the bay mouth generally the exchange rate gradually increased from bay head to the bay mouth at the same time the diffusion rate of pahs was not the same in the area with the same distance from the bay mouth showing the distributing characteristic that the area in the east was higher than the west while in the view of time line 0 150 days the half exchange of pahs in outer bay was first completed with a rapid diffusion rate while the inner bay was not complete even more the simulated concentration of pahs not changing 150 300 days the half exchange of pahs in liaodong bay was basically completed except for the waters north of the central part 300 450 days the half exchange of pahs was almost 70 completed except in the coastal waters of jinzhou and panjin 450 600 days the results showed that the half exchange of pahs in liaodong bay was basically completed but the half exchange of pahs in some estuaries such as shuangtaizi river daling river and xiaoling river was still incomplete which indicated that the hydrodynamic force and water exchange capacity here were weak and the pahs pollutants being able to stay for a long time in order to study the migration and diffusion characteristic of pahs in different areas of liaodong bay meticulously being based on the numerical calculation model this paper simulated and extracted the change process of pahs concentration with time at 7 simulation prediction points the simulation time was set as 600 days the change curve of pahs concentration with time at each station was drawn as shown in fig 8 according to the simulation results fig 8 pahs gradually diffused from the inside of the bay to the outside of the bay under the hydrodynamic effect and the pollutant concentration decreased together among them the diffusion rate of pahs in s1 and s2 stations in the bay was slow and the half exchange time of pahs was about 600 days from the change trend of pahs concentration curve the change of pahs exchange rate in the whole process was small which indicated that the diffusion effect of seawater here was weak the diffusion rate of pahs in s3 s4 and s5 was faster than that in s1 and s2 in terms of time when the simulation time reached 100 days the concentration of pahs began to decrease sharply which indicated that the clean seawater outside the bay was mixing with the continuous simulation when the simulation time reached about 450 days the concentration of pahs at these three stations reached about 1 2 of the initial value and the half exchange of pahs was basically completed the diffusion rate of pahs in s6 and s7 at liaodong bay entrance was obviously higher than that of each station in the bay taking s7 station as an example when the simulation time was about 10 days the half exchange of pahs had basically completed with the simulation process due to the influence of the diffusion of high concentration pahs in the inner bay the concentration of pahs increased slightly but after the 100th day of the simulation time the concentration of pahs stabilized below 1 2 in order to intuitively analyze the change of pahs diffusion rate in inner and outer liaodong bay this paper made regression analysis and comparative study on the process curve of simulated results of pahs at s1 and s7 stations see fig 8 it could be seen that in the first 100 days of the simulation the diffusion rate of pahs at s7 station was much higher than that at s1 station while the diffusion rate of pahs at s1 station was always relatively stable and the exchange of pahs was completed slowly 3 3 2 characteristics of water exchange of pahs in liaodong bay taking the half exchange time of pahs in each grid in the computational domain as a unit the half exchange time distribution map of liaodong bay pahs was drawn after all grid units were superimposed by using the space vector computing function of arcgis generally the half exchange time of pahs in liaodong bay was between 57 and 580 days compared with other sea areas in china the water exchange capacity of liaodong bay was moderate at the same time the temporal and spatial distribution of pahs half exchange in liaodong bay presented two characteristics firstly the closer the area next to the bay mouth the less the half exchange time costed secondly when the distance was the same to the bay mouth the half exchange time in the east was obviously shorter than that in the west in order to analyze the distribution characteristics of the water half exchange capacity of pahs in liaodong bay the sea area of liaodong bay was divided into five areas east south west north and central see fig 9 among them the southern region was closest to the bay mouth with the strongest water exchange capacity and the half exchange time of pahs ranged from 57 to 180 days the central region was closed to the bay mouth where the offshore distance was far away which may be less affected by the nearshore human activities compared with other regions with a strong water exchange capacity and the half exchange time of water ranging from 180 to 300 days the distance between the eastern region and the bay mouth was basically the same but the water depth and flow velocity in the eastern region was higher than that in the western region and the half exchange time of pahs was 120 300 days eastern 180 480 days western based on the calculation results the northern region was the farthest from the bay mouth and the water exchange capacity was the worst that the half exchange time of pahs in jinzhou and yingkou coastal area was about 360 days even more than 500 days in shuangtaizi estuary where the water depth was shallow the hydrodynamic force was weak and the retention effect of pahs pollutants was obvious 3 4 relationship between pahs water exchange capacity and distribution in sediment in order to explore the correlation between pahs water exchange capacity and theirs distribution characteristics in the sediment of liaodong bay the half exchange time of pahs in 61 sediment sampling sites was extracted by delft3d the regression analysis was carried out with the measured pahs concentration in the sediment as dependent variable y axis and the inverse of half exchange time i e water exchange rate as the independent variable x axis the correlation analysis diagram of pahs concentration and water exchange rate was drawn fig 10 it could be seen from the fig 10 that the water exchange rate had a significant impact on the material distribution of pahs in sediments from the trend analysis results with the increase of water exchange rate the concentration of pahs in sediments showed an obvious downward trend on the contrary when the water exchange rate was low it could be seen that the concentration of pahs in sediments was basically higher from the respective characteristics of each region five regions the northern region had the lowest water exchange rate poor hydrodynamic conditions and the farthest migration distance from the sea area outside the bay where there were many estuaries in the northern region and the interaction between sea and land was strong which may further extended the retention time of pahs in this region and increased the difficulty of pollutant migration and diffusion outside the bay therefore the diffusion rate of pahs in the northern region was the lowest in addition there was a negative correlation between the water exchange rate and pahs concentration in the northern region which was characterized by high pollutant concentration and low water exchange rate the results showed that the water exchange rate in the central and western regions was slightly higher than that in the northern regions the hydrodynamic conditions were better and the diffusion distance to the outside of the bay was relatively close although the pahs in the regional seawater would subside to a certain extent on the way out of the bay the sedimentation effect was obviously lower than that in the northern regions from the distribution of pahs in the sediments in general the water exchange rate was negatively correlated with the pahs concentration in sediments the results showed that the hydrodynamic conditions in the south and the east were better where the distance between the south and the sea area outside the bay was the nearest so that the pollutant diffusion rate was the fastest therefore the concentration of pahs in the sediments of this area was the lowest which had a negative correlation with water exchange rate moreover it could also be seen from fig 9 that some stations in the southern region had a phenomenon that both of the water exchange rate and pollutant concentration were high which might be closely related to the intensive distribution of offshore oil and gas production activities in the central bohai sea southern liaodong bay in conclusion the distribution of pahs in the sediments with high effluent exchange rate was low which indicated that the water exchange rate had a significant effect on the material distribution of pahs in the sediments and was one of the important reasons for the difference of material distribution of pahs in the sediments 4 conclusions the total concentrations of 16 pahs σpahs ranged from 83 2 ng g to 296 4 ng g in liaodong bay where was in the moderate pollution level of pahs according to the spatial distribution of pahs the concentration in the north was higher than that in the south and that in the west was higher than that in the east the half exchange time of pahs in liaodong bay was about 57 580 days where there were two main distribution characteristics one was that the closer the area was to the bay mouth the higher the water exchange rate of pahs the other was that the water exchange rate of pahs in the east was higher than the west of liaodong bay the results of mathematical statistics regression analysis showed that the water exchange rate had a significant effect on the distribution of pahs in sediments if where there was a high water exchange rate it would be not easy for pollutants pahs deposition and enrichment and vice versa credit authorship contribution statement jiayi cheng conceptualization methodology data curation writing original draft jianbo han project administration investigation formal analysis methodology supervision binghui zheng investigation formal analysis writing review editing xiaomeng wang investigation formal analysis zhengxian yang investigation formal analysis xiaoxia zhang conceptualization methodology data curation investigation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china no 2017yfa0604904 the authors sincerely thank professor shao tao and wu for assistance in sampling and analysis 
4133,aquatic habitats are essential for aquaculture agriculture and municipal water supply the geographical location and quantitative information about the aquatic habitats are critical for inventorying monitoring and managing these valuable resources this paper presents a novel method that integrates the object oriented image analysis and dem based stream network analysis to map and quantify lentic aquatic habitats using freely available esa sentinel 2 multispectral imagery and usgs dems this integrated method has been applied to the entire mobile river basin usa and lentic habitats at the basin scale have been delineated and inventoried at the 10 m spatial resolution the surface water pixels of aquatic habitats are extracted through the iterative self organizing data analysis technique isodata unsupervised classification of the sentinel 2 multispectral images an object oriented image analysis approach is then used to group contiguous water pixels to form and map discrete aquatic habitat objects the stream network in the basin has been hydrologically derived from the usgs dems at the 10 m spatial resolution the combination of the geometric and shape information from the object oriented image analysis and hydrological information from the dem based stream network analysis enables the separation of lotic and lentic habitats a set of planimetric geometric and shape attributes has been numerically derived for each lentic habitat object the abundance pattern shape pattern and spatial distribution pattern of the lentic habitats in the basin have been analyzed the vast majority of the aquatic habitat objects identified in the mobile river basin are lentic habitats the most striking spatial pattern of lentic habitats is that small oblong lakes and fish ponds are densely distributed along the black prairie belt in the basin laying the foundation for the catfish aquacultural industry in the regions of mid west alabama and east mississippi this research demonstrates that the integration of the recently emerged sentinel 2a b satellite multispectral imagery with usgs dems represents an effective approach to the inventory and environmental investigation of lentic habitats at a basin scale keywords aquatic habitat delineation object oriented image analysis lentic habitat sentinel 2 imagery mobile river basin 1 introduction aquatic habitat is an area that is permanently or seasonally covered by water where aquatic organisms population or communities live bain and stevenson 1999 there are two types of freshwater habitats lentic standing water e g lakes reservoirs ponds and lotic flowing water e g creeks streams rivers fisher et al 2012 aquatic habitats are often formed by the interactions of local environmental factors including topography hydrology groundwater potential and stream morphology bain and stevenson 1999 aquatic habitats affect the surrounding environments through solar energy absorption harris 2002 local temperature adjustment saaroni and ziv 2003 food supply nakano and murakami 2001 and water supply brikké et al 2003 lentic and lotic habitats have totally different properties and play various roles in the local and global biogeochemical and hydrological dynamics for instance the abundance and size distribution of lentic habitats are critical to quantifying the contributions of freshwater to the global carbon cycle verpoorter et al 2014 the stream order and connectivity of lotic habitats are correlated to sediment yields and nutrient dynamics bouwman et al 2016 lentic habitats are densely distributed in the mobile river basin in the southeastern united states aquatic habitats constitute precious freshwater resources in the basin for human consumption agriculture aquaculture industry fishing and recreation and other economic activities more than three quarters of the total water used in the mobile river basin is from the surface water of aquatic habitats atkins 2004 numerous fish ponds in mid west alabama and east mississippi along the black prairie belt in the basin contribute to the formation of the second leading farm raised channel catfish production in the usa schrader and dennis 2005 despite these great economic benefits of the catfish aquacultural industry the effluents of the catfish farming have drawn increasing public concerns on the overloading nutrients in water bodies possible downstream water pollutions boyd 2003 boyd et al 2008 and their contribution to harmful algal blooms habs in the mobile bay macintyre et al 2011 to manage the lentic habitats for aquaculture and to monitor water quality and aquatic environment basic geospatial information about the lentic habitats is required the geographical location size shape spatial distribution and adjacent land use and land cover of the lentic habitats are particularly useful in evaluating aquacultural productivity of these lentic habitats the risk of eutrophication and hab occurrences and ecological effects on the surrounding areas however the baseline inventory and detailed maps and quantitative information for most freshwater habitats are not available or outdated the development of baseline aquatic habitat inventory and maps through conventional field surveys is time consuming labor intensive and expensive particularly at regional and basin scales remote sensing technology provides a more efficient alternative approach to mapping aquatic habitats numerous automatic or semi automatic algorithms have been developed to delineate aquatic habitats by using various remote sensing data including optical images e g landsat spot aster ikonos quickbird and worldview liu 2009 synthetic aperture radar sar images e g radarsat ers envisat sentinel 1 liu and jezek 2004a liu and jezek 2004b mason and davenport 1996 or lidar point clouds liu 2009 liu et al 2007 most of the previous aquatic habitat delineation algorithms are pixel based through detecting the surface water boundaries of aquatic habitats with edge detection techniques or identifying water pixels of aquatic habitats with image segmentation or classification techniques liu and jezek 2004a since pixels are uniform and contain insufficient geometric and hydrologic attributes pixel based representation is not suitable for identifying individual aquatic habitats separating lentic and lotic habitats and deriving their geospatial attributes to support the aquacultural and environmental planning and management activities this paper presents a novel method of mapping and inventorying lentic habitats with the baseline information at a large basin scale using the recently emerged esa sentinel 2 satellite images and usgs digital elevation models dems using the new method we delineate as individual discrete objects all the lentic habitats with a water surface area larger than 10 000 m2 1 0 ha in the mobile river basin the accuracy of their geographical position and geometry has been assessed using high resolution planetscope cubesat imagery the method is based on object oriented approach to represent lentic habitats as discrete objects and deriving baseline geospatial attributes for each lentic habitat object using geospatial analysis through hydrologic analysis of the stream network with basin wide usgs dems lotic habitats have been automatically separated from lentic habitats and are excluded from analysis since lotic habitats are totally different types of habitats and beyond the scope of this paper in the following sections we introduce the study area and the data sets present the methods for lentic habitat delineation and geospatial attribute derivation evaluate the accuracy of the mapped lentic habitats derive a set of geospatial attributes for lentic habitats examine areal size pattern spatial distribution and surrounding land use types of lentic habitats and also discuss the methodology and results 2 study area and data sets 2 1 study area the mobile river basin located in the southeast of the united states is the sixth largest basin in the united states mcpherson et al 2003 the total area of the basin is over 113 960 km2 the basin encompasses parts of alabama mississippi georgia and tennessee fig 1 two thirds of the basin is located in the state of alabama mcpherson et al 2003 fig 1 the mobile river basin comprises approximately 70 of forested land 26 of agriculture land and 3 of urbanized land atkins 2004 mcpherson et al 2003 its population is about 8 3 million in 2018 u s census bureau 2018 most concentrated in birmingham montgomery tuscaloosa and mobile rugged mountains and plateaus are located in the northeast of the basin including piedmont the valley and ridge and the appalachian plateaus the south and west of the basin are dominated by broad flat plains and rolling hills fig 1 and 56 of the basin lies within the east gulf section of the coastal plain the black prairie belt is part of the coastal plain and extends through central alabama curving upward into northeastern mississippi the black prairie belt is characterized by the prairie like vegetation and dark colored soils formed from clayey laid over a soft limestone the climate of the basin is warm and humid ranging from temperate at higher elevations to subtropical near the coast although precipitation is quite evenly distributed throughout the year a wet season with more rainfall usually occurs during the winter and spring months and a distinct dry season from midsummer to late fall liu et al 2005 the mobile river is formed by the confluence of two large rivers the tombigbee and alabama rivers fig 1 following the regional precipitation patterns the river discharge peaks in march while the minimum flow occurs during the late summer when evapotranspiration is the highest schroeder et al 1990 the stream flows in the basin are highly regulated by upstream reservoirs for water supplies flood control and navigational locks and dams and hydroelectric plants downstream from the confluence the mobile river flows south into the mobile bay contributing approximately 95 of the freshwater inflow to the bay the mean annual streamflow in the basin is approximately 1800 m3 s 64 000 ft3 s the fourth largest river basin in the united states in terms of streamflow mcpherson et al 2003 usgs 2019 besides thousands of kilometers of stream and river channels tens of thousands of lakes reservoirs and ponds are distributed in the basin 2 2 data sets in this study 21 sentinel 2 multispectral images are used as the primary data sources for detecting and delineating aquatic habitats at the basin scale twenty three dem tiles usgs national elevation dataset ned are used to extract the stream network at the basin scale which provides valuable hydrologic information for separating lentic and lotic habitats the high resolution four band planetscope images from planet labs are used to evaluate the accuracy of the sentinel 2 image derived lentic habitats in addition several ancillary data sets for the basin have been used to support the data analysis and result interpretation the sentinel 2 satellite system from the european space agency esa provides global multispectral high spatial resolution observations drusch et al 2012 which are especially suitable for the delineation of aquatic habitats at a large spatial scale the multispectral instrument msi sensors onboard sentinel 2a b satellites acquire multispectral imagery with 13 spectral bands at various spatial resolutions 10 m spatial resolution for blue green red and near infrared nir bands 20 m for three red edge bands a narrow nir band and two short wave infrared swir bands and 60 m for a coastal aerosol band a water vapor band and a cirrus swir band drusch et al 2012 frampton et al 2013 to determine the maximum spatial extents of lentic habitats for their baseline information the multispectral images acquired by sentinel 2a and sentinel 2b satellites during the wet season from january 28 2019 to april 26 2019 are selected in total 21 sentinel 2 msi level 1c image tiles are used in this study and these images are obtained at no cost from esa copernicus open access hub https scihub copernicus eu dhus home these selected images are nearly cloud free each with a cloud coverage of less than 1 the level 1c image products are the top of atmosphere toa reflectance they have been orthorectified and georeferenced to utm zone 16 n coordinate system with reference to the wgs84 ellipsoid a high resolution planetscope image from planet labs inc planet application program interface 2017 is used to visually interpret and extract lentic habitats as the ground truth to evaluate the accuracy of the sentinel 2 image derived lentic habitats the planetscope image has a spatial resolution of 3 m with four spectral bands blue green red and nir this planetscope image was collected by the planetscope constellation on january 28 2019 the exact same day when sentinel 2 satellite acquired the corresponding multispectral image used in this study we combined 23 ned tiles at 10 m spatial resolution https viewer nationalmap gov basic to derive the stream network system in the mobile river basin which is used to assist the separation of lotic habitat objects from lentic habitat objects the 30 m spatial resolution national land cover database 2016 nlcd 2016 from usgs multi resolution land characteristics consortium mrlc https www mrlc gov wickham et al 2014 is used to assist the interpretation of the land cover and land use types surrounding the aquatic habitats the hydrologic units hu at the level of 4 from the united states geological survey usgs watershed boundary dataset wbd are used to define the boundary of the mobile river basin and all aquatic habitats within or cross the basin boundary are delineated and mapped 3 methods we use the open water surface at the wet season to represent and map aquatic habitats each aquatic habitat is numerically defined as a surface water patch object consisting of a set of spatially connected water pixels the object oriented image analysis method and the dem based stream network analysis method have been combined to classify aquatic habitats first the isodata unsupervised classification method is applied to sentinel 2 multispectral images to identify and map water pixels in the basin then an object oriented method is used to identify and form discrete aquatic habitat patches objects we delineate the basin s stream network from the ned which is then overlaid with the image derived aquatic habitat objects to classify them into lotic and lentic habitats a set of geospatial and shape attributes centroid location area perimeter circularity has been numerically derived with an object oriented approach for each lentic habitat the pattern of lentic aquatic habitats in the mobile river basin is then analyzed 3 1 identification of water pixels by an unsupervised image classification sentinel 2 multispectral images were processed to identify water pixels first a median filter is applied to sentinel 2 multispectral images in order to reduce image noise while preserving the sharp edges of surface water features bovik et al 1987 then the iterative self organizing data analysis technique isodata dubes and jain 1976 tou and gonzalez 1974 unsupervised classification method is applied to the sentinel 2 multispectral images to map water pixels in the isodata unsupervised classification only four spectral bands blue green red and nir of sentinel 2 images with a 10 m spatial resolution are utilized the use of these spectral bands ensures the best spatial resolution of the detected aquatic habitats while keeping sufficient spectral information to identify water pixels the isodata unsupervised classification performs an iterative optimization clustering of the image pixels in terms of their multispectral values to ensure a sensitive and accurate extraction of aquatic habitats the unsupervised classification through isodata generates 12 to 15 clusters the clusters of pixels resulted from the isodata unsupervised classification are grouped into two categories through interpretation water pixels and non water pixels water pixels are recoded with a value of 1 and non water pixels with 0 to form a binary image for further processing to form aquatic habitat objects 3 2 object based representation of aquatic habitats our object oriented image analysis method uses a region growing algorithm sonka et al 2014 to form and identify discrete aquatic habitats as image objects based on the water pixels classified from the sentinel 2 multispectral images a discrete aquatic habitat object is a spatially continuous surface water patch consisting of a set of connected water pixels the region growing algorithm scans the binary image in a row wise manner and the first water pixel encountered is marked as a seed of an aquatic habitat object then the aquatic habitat object is expanded from the seed by searching and including its adjacent water pixels the newly marked adjacent pixels are used as new seeds for further expansion by searching and including their neighboring water pixels the region growing and expansion process stops when there are no adjacent water pixels to all the marked water pixels all the marked water pixels form a discrete aquatic habitat object and are coded with a unique identification number these marked pixels are excluded from the following scan by recoding as non water pixels the above region growing process is repeated to the next aquatic habitat object until all the image pixels are scanned and marked from the region growing algorithm we obtain a raster representation of discrete aquatic habitats as image objects for this study a minimum mapping unit of 10 000 m2 1 0 ha is used to map the aquatic habitats in the basin namely only aquatic habitat objects with an area of more than 100 water pixels are kept for further processing and those aquatic habitat objects with water pixels fewer than 100 water pixels are removed as noisy and unreliable objects a shoreline tracing algorithm liu et al 2011 is used to numerically delineate the boundary of each aquatic habitat object from the previous image processing steps in this way the polygons enclosed by the shorelines of the water body image objects are appended to a pre built polygon shapefile to form the vector representation of aquatic habitats the douglas peucker algorithm liu et al 2011 is then used to simplify the polygon of aquatic habitat objects the simplification tolerance is set to 10 m 1 pixel width on sentinel 2 image to smooth saw toothed edges while maximizing the natural shape of the aquatic habitat objects each of the 21 sentinel 2 image tiles is individually processed in the environment of envi 5 3 and idl 8 5 the outputs are merged and dissolved into a single data file for the entire basin the delineated aquatic habitat objects have been visually inspected for quality control by overlaying them on sentinel 2 natural color image composition erroneous aquatic objects mainly caused by cloud shadows and building shadows were removed 3 3 separation of lentic and lotic habitat objects freshwater aquatic habitats can be classified into two broad categories lentic and lotic habitats bain et al 1999 and they play different roles in local environments lotic habitats are linear stream like features with significant water flux including creeks streams and rivers the lentic habitats include natural or artificial ponds lakes and reservoirs and they have still standing water and may be isolated from the streams in comparison the water in lentic habitats has much longer residence time than that in the lotic habitats automated classification of aquatic habitats into lotic and lentic types is challenging by solely using image analysis methods because of insufficient separability in this study we synergistically combine the hydrologic information about the stream network from the ned dems and the geospatial information of aquatic habitats from the esa sentinel 2 multispectral images to realize the automated separation of lotic habitats from lentic habitats we derive the digital stream network from the ned dems for the mobile river basin using the arcgis 10 5 hydrology toolbox bachelot et al 2016 a total of 23 dem tiles are merged to fully cover the entire basin after filling the sinks and pits the flow direction layer is calculated from the hydrologically enforced dem using the d8 algorithm o callaghan and mark 1984 the flow accumulation is then calculated from the flow direction layer the dem cells with flow accumulation area larger than 1000 km2 are marked as stream channel cells this threshold value is selected to optimize the correspondence of digitally derived stream channels to the lotic aquatic habitats derived from the sentinel 2 images next the raster representation of stream channels is converted to a topologically structured vector representation of the stream network in the basin with reference to the hydrologically derived stream network we numerically examine all aquatic habitat objects derived from the object oriented image analysis method the aquatic habitat objects that are intersected by the hydrologically derived stream network are considered to have flowing water and designated as lotic habitat objects the remaining aquatic habitats without the interaction with the stream network are considered to have standing water and hence classified as lentic habitat objects this spatial intersection operation is realized by using the spatial query function in arcgis 10 5 select by location tool the spatial selection is set to intersect the polyline features of the stream links with the polygon features of all aquatic habitat objects all the selected aquatic habitat objects are saved as a new polygon shapefile that contains only the lotic habitats the remaining aquatic habitat objects after the selection are saved as a new polygon shapefile that contains only the lentic habitats 3 4 geospatial attributes of lentic habitat objects spatial accuracy assessment and pattern analysis a set of geospatial properties of these lentic habitat objects has been computed including x y coordinates of the centroid point surface water area perimeter and circularity index ci ci shows the compactness of a lentic habitat casas et al 2012 schmadel et al 2018 the value of 1 for the circularity index shows that the habitat has the most compact shape a circle an elongated linear habitat like a channel formed reservoir has the least compact shape with a circularity index close to 0 theoretically the lotic habitat in a watershed is a continuous entity and it has perfect connectivity from the headwaters to the pour point the derived lotic habitat objects through remote sensing approaches have rich geometric and shape attributes but they are inevitable fragmentary segments of the entire lotic habitat entity though multiple approaches are applicable to correct the connectivity of the lotic habitat and to derive proper hydrologic attributes the discussion of these issues is excluded since it is beyond the scope of this paper we visually interpreted a high resolution planetscope image from planet labs inc on the same day as the sentinel 2 multispectral image this planetscope image has four spectral bands with 3 m spatial resolution covering an area of 224 km2 centered on 87 32 w 32 28 n due to its high spatial resolution and multiple spectral bands we are able to manually digitize the boundaries of aquatic habitats with high confidence and fidelity as the ground truth for the accuracy assessment fig 2 a total of 309 lentic habitat objects mostly fish ponds has been delineated from the planetscope image the mapping accuracy assessment is performed by comparing the aquatic habitats numerically derived from the sentinel 2 image with the corresponding manually digitized aquatic habitats first the centroid points of the ponds derived from planetscope image are compared with those derived from the sentinel 2 image to evaluate the overall geographic location accuracy for aquatic habitat objects the absolute centroid location displacement along the x axis and y axis and the distance of the displacement are derived as the location accuracy indicators for aquatic habitats second the boundaries digitized from the planetscope image are compared against those derived from the sentinel 2 image to evaluate the boundary displacement the boundary displacement of a pond is the total erroneous area divided by the perimeter of the pond third the area of the ponds manually digitized from planetscope image are compared with those derived from the sentinel 2 image and the ratio of correctly mapped area intersection divided by the ground truth area is calculated as the areal accuracy indicator for aquatic habitats the accuracy assessment measures are computed for each aquatic habitat object individually using the spatial analysis tools in arcgis 10 5 the abundance pattern shape pattern and spatial distribution pattern are then analyzed based on the derived geospatial properties of these lentic habitat objects the lentic habitat abundance according to the areal size is generally considered to confirm the power law downing et al 2006 according to the power law the lentic habitats are dominated by the small size in total number and the number of lentic habitats decreases rapidly with the increase in the habitat areal size though this law is challenged based on a recently derived global inventory of lakes verpoorter et al 2014 seekell et al show the validation of this law particularly in flat regions using a fractal based approach seekell et al 2013 since the vast majority of the lentic habitats in the mobile river basin are distributed in the downstream flat prairie it is considered appropriate to examine the abundance of lentic habitats in the mobile river basin with the power law for the mobile river basin we have fitted a power function with the number of lentic habitat objects as the dependent variable and the areal size of the lentic habitats as the independent variable using the least squared adjustment approach as follows n a a n 0 a ρ where n a a is the number of lentic aquatic habitats whose areas are equal to or larger than a threshold area a the constant power parameter ρ is the logarithmic decreasing rate in the number of lentic habitats corresponding to their sizes and n 0 is the estimated total number of lentic aquatic habitats whose areas are equal to or larger than the minimum mapping unit of the analysis 10 000 m2 1 0 ha the fitting of the power function is based on 31 samples with an equal interval at the logarithmic scale of lentic habitat size the coefficient of determination r2 is used to determine the goodness of fitness the shape pattern of the lentic habitats is visualized and analyzed through a histogram plot of their ci values in addition the spatial distribution pattern of the lentic aquatic habitats is visualized by a kernel density map generated in arcgis 10 5 the kernel density estimation uses the centroid points of these lentic habitat objects as their locations and the areal sizes of these lentic habitat objects as the weights silverman 2018 4 results and discussion 4 1 basin scale aquatic habitat map and accuracy assessment we have identified and delineated 19 158 aquatic habitat objects in the mobile river basin fig 3 675 3 5 were classified as lotic habitat objects while 18 483 96 5 were classified as isolated lentic habitat objects most lotic habitat objects are wide river channels fig 3 a the lentic habitat objects are mainly compact fish ponds fig 3 d and numerous natural lakes and reservoirs that connect narrow streams the accuracy assessment of the delineated lentic habitats is summarized in table 1 the mean location displacement of centroids is 2 77 m along x axis east west and 3 46 m along y axis north south the mean distance of location displacement is 5 50 m the mean boundary displacement of lentic habitats is 6 40 m the positional error of the habitat centroid point and the boundary is well below the resolution 10 m of the sentinel 2 image indicating that the sentinel 2 derived aquatic habitat map is accurate the areal accuracy of lentic habitat objects derived from the sentinel 2 image ranges from 78 36 to 99 24 with a median value of 93 56 the smaller lentic habitats tend to have lower areal accuracy than larger ones besides the high accuracy the fine resolution of the sentinel 2 imagery also enables us to truly investigate every single lentic habitat artificial fish ponds are always assembled together with about 15 m pond dikes between them fig 2 the assemble pattern makes it difficult to delineate each lentic habitat from coarse spatial resolution for instance 30 m spatial resolution on landsat image the inventory of the lentic habitats derived from this study while accurate represents only a short period the sentinel 2 image tiles are collected from the wet season of the mobile river basin between january 28 and april 26 in 2019 the short period of data collection means that the results are most useful as a baseline inventory for future studies of seasonal and annual changes as well as retrospective spatiotemporal evolution of lentic habitats in this basin despite its temporal limitations the derived dataset is a considerable advancement for the study site as only limited lentic habitat inventory data are available for the mobile river basin the national hydrology dataset plus nhdplus https www epa gov waterdata nhdplus national hydrography dataset plus has a water body layer but it was derived from a combined investigation in the past two decades the nhdplus water body inventory is derived from image sources of different seasons and years over the decades thus it is not possible to be used as a baseline inventory for spatiotemporal analysis our proposed method consists of two technical steps the first step is to extract water pixels using the pixel based unsupervised classification and the second step is to derive useful quantitative attributes for aquatic habitats and to separate aquatic habitats into lotic and lentic habitats using object oriented approach in the previous studies many classification methods have been used to identify the water bodies for instance random forest support vector machine svm and k nearest neighbors knn since the water body has a strong spectral signature ngoc et al 2019 water pixels can be identified with multispectral image data at a high accuracy no matter pixel based supervised unsupervised or object based classification method is used phiri et al 2020 note that the available software tools like ecognition developer are powerful for the high resolution image classification of multiple land cover types however the purpose of our first step is only to identify water pixels without considering the accuracy of other land cover types for the sake of the application easiness of our method we adopt the simple pixel based unsupervised classification method for the first step which is easy but adequate the more challenging and critical part of our method is the second step namely numerically deriving useful quantitative attributes for these habitat objects and automatically separating them into lotic and lentic habitat objects aquatic habitats are complicated systems at a large basin scale and they have diversified functions bain et al 1999 a detailed quantitative description and further classification of aquatic habitats brings more meaningful and useful information for aquatic habitat monitoring and management the available object oriented software tools including ecognition developer do not have the required functions for us to derive the critical attributes for our aquatic habitat objects nor to separate lotic and lentic habitat objects therefore we develop our object oriented approach for the second step the application of our proposed method in the mobile river basin has successfully separated the aquatic habitats into lotic and lentic habitats the aquatic habitats in the mobile river basin are dominated by the lentic habitat objects their spatial pattern and geospatial properties are quantified and analyzed our object oriented method is particularly suitable for the automatic separation of lentic and lotic habitats and the derivation of their quantitative information for aquatic habitat management at a large basin scale our method is fundamentally different from the commonly used object oriented image classification method like ecognition developer the ecognition method comprises image segmentation feature space optimization classifier training and classification and post classification operations the image objects are formed before classification by aggregating similar pixels into larger image patches objects baatz and schape 2000 lewiński 2006 the scale parameter or other similar functional parameters is used to control the size of image objects in the segmentation stage in the ecognition method a small value of the scale parameter benefits the accurate identification and formation of small lentic habitats but may result in serious over segmentation of large and complicated lotic habitats for instance the downstream mobile river is a braided river network along with multiple small ponds fig 4 a and the width of rivers ranges from approximately 50 m to 650 m to form proper image objects of these small ponds a scale parameter of 100 is optimal since water pixels have a unique spectral signature it is relatively easy to generate similar water body image objects using other methods such as a support vector machine svm with spectral information alone fig 4 c however the large single well connected lotic habitat object formed from our method fig 4 b is over segmented into numerous image objects the over segmented image objects make the separation of lotic from lentic habitat objects very difficult or impossible fig 4 c even the use of additional shape information like circularity index ci for further classification does not improve the quality of the resulting image objects fig 4 d in contrast our method is able to accurately form the complete aquatic habitat objects using a region growing algorithm the formation of image objects with our method is scale free aquatic image objects with variable size can be precisely formed and quantified the complete and well connected habitat objects created in our method make it possible to separate lotic objects from lentic objects in a simple but reliable manner our method is appliable to other high resolution remote sensing data sources the accuracy and minimum size of the detected aquatic habitats largely depend on the spatial resolution of source images in the mobile river basin many small lentic habitats fish ponds are located very close to lotic habitats narrow rivers and many lentic habitats fish ponds are also very close to each other in location the sentinel 2 images employed in this study are only adequate to confidently identify individual aquatic habitats with a minimum size of 1 0 ha 100 pixels on sentinel 2 image they are not adequate for the precise delineation of small and narrow aquatic habitats to precisely detect and map individual aquatic habitats smaller than 1 0 ha other remote sensing image data with a finer spatial resolution than sentinel 2 images are required such as spot 6 7 multispectral image 6 m pleiades 1a b multispectral image 2 m and worldview 2 3 4 multispectral image 1 84 m 1 24 m and 1 24 m at a much higher cost multispectral remote sensing data with the moderate spatial resolution are not adequate for the precise delineation of small and narrow aquatic habitats for instance the conventionally used landsat data since the narrow dikes between aquatic habitats may be within a mixed pixel on landsat image and the mixed pixels have a weak spectral signature for classification these neighboring aquatic habitats are not separable image fusion techniques are helpful to enhance the spatial resolution of landsat data song et al 2014 which would be necessary before employing our method to map small aquatic habitats the size of image tiles also influences the image object formation in our method large image tiles i e sentinel 2 100 km 100 km allow for the formation of large well connected lotic habitat objects and consequentially result in adequate separation of lotic and lentic habitat objects for our method planetscope image in contrast has a high spatial resolution but a small image tile size 8 km 26 km the lotic habitat objects formed from a single tile of the planetscope image have a similar fragmentation problem and result in a poor separability of lotic habitat objects from lentic habitat objects in such a case mosaicking several image tiles to a large one before applying our method is helpful 4 2 the size shape and spatial distribution of lentic habitats in the mobile river basin we have identified 18 483 lentic habitats which are mainly lakes and fish ponds the total water surface area of lentic habitats is 793 69 km2 which is 0 69 of the entire mobile river basin area the centroid location coordinates water surface area perimeter and circularity index are derived for all lentic habitats fig 5 and table 2 and the statistical summaries about the area perimeter and circularity index of lentic habitats in the basin are shown in table 3 the median size of lentic habitats is 2 09 104 m2 2 09 ha and the largest lentic habitat the inland lake in blount county al has a water surface area of 6 57 106 m2 657 30 ha the power law is evaluated for the lentic habitat abundance in the mobil river basin for this large basin we have fitted the power function as follows n a a 18597 a 0 8908 where n a a is the number of lentic aquatic habitats whose areas are equal to or larger than a threshold area a the constant power parameter 0 8908 is the logarithmic decreasing rate in the number of lentic habitats corresponding to their sizes the coefficient of determination r2 is 0 99 one way to interpret the power law is through the power parameter a strongly negative power parameter indicates that the smaller lentic habitats comprise more surface area than the larger ones and vice versa downing et al 2006 the fitted power parameter in the mobile river basin 0 8908 is weakly negative and it indicates the water surface area of lentic habitats is dominated by larger lentic habitats which is consistent with the global pattern verpoorter et al 2014 as the lentic habitats are dominated by fish ponds particularly in the black prairie belt region the shape is relatively compact with an apparent artificial geometry the median circularity index ci is 0 6143 table 3 and most lentic habitats in the mobile river basin have an oblong shape fig 6 the median value of circularity corresponds to an ellipse whose semi major semi minor axes ratio is 2 7571 1 the ratio is about 21 between the largest curvatures at the ends of major axes and the smallest curvatures at the ends of minor axes the fine resolution of sentinel 2 imagery enables the accurate estimation of the shape attributes for each lentic habitat especially for small ones in comparison the lentic habitat close to the minimum mapping unit 1 0 ha comprises much fewer image pixels for instance about 10 pixels on landsat imagery at a 30 m spatial resolution in such a case it is difficult to maintain the proper oblong shape of the lentic habitats and the precise curvature of the shorelines in one word the fine spatial resolution of the newly emerged sentinel 2 imagery is critical for the accurate shape delineation of lentic habitats to reveal the spatial distribution pattern of lentic habitats at the basin scale we have also calculated the kernel density of lentic habitats with their centroid points as their locations and their areal sizes as the weights silverman 2018 as revealed by the kernel density map fig 7 the lentic habitats are densely distributed along the black prairie belt in the middle of the mobile river basin the black prairie belt has a layer of rich and black topsoil on the chalk of the selma group which enabled agriculture development the black prairie belt is an intensive agriculture region in alabama and mississippi barone 2005 and its land use is dominated by planted and cultivated agriculture numerous natural or artificial lakes are precious resources for aquaculture and irrigation cleland 1920 webster and samson 1992 the concentration of lentic habitats also makes the black prairie belt the second leading production base of farm raised channel catfish in the usa schrader and dennis 2005 a recent boom in the inland farming of shrimp is also reported for the black prairie belt davis et al 2005 the striking spatial consistency between the black prairie belt and the blue lentic belt suggests a strong interaction between agriculture and aquaculture in mid west alabama and east mississippi and possible water quality issues resulted from this interaction are vague but open for investigation 4 3 environmental implications of aquatic habitats aquatic habitats perform many important environmental functions for example they recycle nutrients attenuate floods recharge groundwater and modify the local climate they constitute precious freshwater resources for human consumption agriculture aquaculture industry fishing and recreation and other economic activities in the mobile river basin more than three quarters of the total water use is from the surface water of aquatic habitats atkins 2004 the densely distributed lentic habitats in the black prairie belt support the productive inland farming of catfish and shrimp healthy aquatic habitats are vital for sustaining productive and diverse ecosystems in the basin however aquatic habitats have been increasingly threatened by various environmental stresses land use changes human activities and climate changes the baseline information about aquatic habitats derived from this study is critical for resource managers to protect conserve and restore lentic habitats lakes ponds and reservoirs in the mobile river basin the detailed map and various geometric attributes of lentic habitats provide the scientific basis for planning the aquaculture agriculture best management practices bmps managing agricultural aquacultural activities investigating aquatic environment and ecology and estimating the productivity for instance the information about lentic habitats is important in estimating the effluent discharge volume and tracking and modeling the transport of the effluents into the lotic habitats hence helpful to evaluate downstream water safety to understand the impacts of human economic activities on aquatic habitats we examined the land cover and land use types surrounding aquatic habitats based on the national land cover database 2016 nlcd 2016 from usgs multi resolution land characteristics consortium mrlc fig 8 we numerically summarized land use types along the shoreline of each aquatic habitat object in this way we obtained statistical information about land cover and land use structure around lotic and lentic habitats fig 9 about 28 3 of the adjacent land covers surrounding lentic habitats are planted cultivated agriculture land use in contrast only 8 9 of the adjacent land covers surrounding lotic habitats and in river reservoirs are planted cultivated most of the lotic habitats streams and rivers provide water for surrounding forests 42 7 and wetlands 35 2 the intensive agricultural activities may have negative effects on the water quality of aquatic habitats boyd 2017 given the surrounding intensive agricultural activities and long water residence time lentic habitats have a higher risk of eutrophication and habs than lotic habitats meanwhile toxic materials associated with the pesticides may pollute adjacent lentic habitats it has been reported that the use of fertilizers in agriculture may cause excessive nitrogen and phosphorus dissolved into the surface runoff and accumulated in lakes and ponds resulting in elevated risks to aquaculture in alabama boyd 2017 and frequent occurrences of habs the effluents of overloaded nutrients from the aquaculture are periodically discharged to their adjacent drainage systems and affect the water quality of the downstream lotic habitats 5 conclusions this paper presents a novel method for lentic aquatic habitat mapping and inventory at a large basin scale this method integrates the object oriented image analysis of freely available esa sentinel 2 multispectral imagery and hydrologic stream network analysis using usgs dems to map and quantify lentic habitats the combination of shape information from the object oriented image analysis and hydrologic information from the stream network analysis enables us to classify aquatic habitats into lotic and lentic types a set of planimetric and geometric attributes has been numerically derived for each lentic habitat the abundance pattern shape pattern and spatial distribution pattern of the lentic habitats in the basin have been reported our integrated method has been successfully applied to the entire mobile river basin usa and lentic habitats at the basin scale have been delineated and inventoried at a 10 m spatial resolution 96 5 of the aquatic habitat objects identified in the mobile river basin are lentic habitats the number of lentic habitats decreases exponentially with the increase of areal size following the power law the most striking spatial pattern of lentic habitats is that small oblong lakes and fish ponds are densely distributed along the black prairie belt in the basin laying the foundation for the catfish aquacultural industry in the regions of mid west alabama and east mississippi approximately one third of the adjacent land cover to lentic habitats is agriculture land imposing strong stress and impacts on the water quality of lentic habitats aquatic habitats are essential for aquaculture agriculture and municipal water supply this study demonstrates that the integration of the recently emerged sentinel 2a b satellite multispectral imagery with dems represents an effective approach to the inventory and environmental investigation of lentic habitats at a basin scale the new generation of sentinel 2 satellite sensors can provide freely available multispectral imagery with sufficient spatial resolution and proper spectral configuration for inventorying and monitoring the lentic habitats at a large basin scale the detailed map of lentic habitats and their associated geometric attributes derived from this study are essential for planning the aquaculture agriculture best management practices bmps supporting the operations of water supply and irrigation system and monitoring and assessing the water quality and aquatic health condition in the mobile river basin our integrated method and associated sentinel 2 image source are transferable and applicable to the detailed lentic habitat inventory and mapping for other drainage basins in our future research we would apply our method to historical satellite images to derive time series aquatic habitat maps we would use our 2019 aquatic habitat map as the baseline inventory to conduct a retrospective investigation on the spatiotemporal evolution of the blue lentic belt and the inland fishery industry in alabama and mississippi this detailed aquatic habitat map will also be used as high resolution water masks to derive the water quality parameters for spatially distributed aquatic habitats in the mobile river basin from the multispectral sentinel 2 images credit authorship contribution statement yang liu conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization hongxing liu conceptualization methodology formal analysis investigation resources writing original draft writing review editing visualization supervision lei wang software writing original draft writing review editing min xu resources writing original draft writing review editing sagy cohen writing original draft writing review editing kai liu writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
4133,aquatic habitats are essential for aquaculture agriculture and municipal water supply the geographical location and quantitative information about the aquatic habitats are critical for inventorying monitoring and managing these valuable resources this paper presents a novel method that integrates the object oriented image analysis and dem based stream network analysis to map and quantify lentic aquatic habitats using freely available esa sentinel 2 multispectral imagery and usgs dems this integrated method has been applied to the entire mobile river basin usa and lentic habitats at the basin scale have been delineated and inventoried at the 10 m spatial resolution the surface water pixels of aquatic habitats are extracted through the iterative self organizing data analysis technique isodata unsupervised classification of the sentinel 2 multispectral images an object oriented image analysis approach is then used to group contiguous water pixels to form and map discrete aquatic habitat objects the stream network in the basin has been hydrologically derived from the usgs dems at the 10 m spatial resolution the combination of the geometric and shape information from the object oriented image analysis and hydrological information from the dem based stream network analysis enables the separation of lotic and lentic habitats a set of planimetric geometric and shape attributes has been numerically derived for each lentic habitat object the abundance pattern shape pattern and spatial distribution pattern of the lentic habitats in the basin have been analyzed the vast majority of the aquatic habitat objects identified in the mobile river basin are lentic habitats the most striking spatial pattern of lentic habitats is that small oblong lakes and fish ponds are densely distributed along the black prairie belt in the basin laying the foundation for the catfish aquacultural industry in the regions of mid west alabama and east mississippi this research demonstrates that the integration of the recently emerged sentinel 2a b satellite multispectral imagery with usgs dems represents an effective approach to the inventory and environmental investigation of lentic habitats at a basin scale keywords aquatic habitat delineation object oriented image analysis lentic habitat sentinel 2 imagery mobile river basin 1 introduction aquatic habitat is an area that is permanently or seasonally covered by water where aquatic organisms population or communities live bain and stevenson 1999 there are two types of freshwater habitats lentic standing water e g lakes reservoirs ponds and lotic flowing water e g creeks streams rivers fisher et al 2012 aquatic habitats are often formed by the interactions of local environmental factors including topography hydrology groundwater potential and stream morphology bain and stevenson 1999 aquatic habitats affect the surrounding environments through solar energy absorption harris 2002 local temperature adjustment saaroni and ziv 2003 food supply nakano and murakami 2001 and water supply brikké et al 2003 lentic and lotic habitats have totally different properties and play various roles in the local and global biogeochemical and hydrological dynamics for instance the abundance and size distribution of lentic habitats are critical to quantifying the contributions of freshwater to the global carbon cycle verpoorter et al 2014 the stream order and connectivity of lotic habitats are correlated to sediment yields and nutrient dynamics bouwman et al 2016 lentic habitats are densely distributed in the mobile river basin in the southeastern united states aquatic habitats constitute precious freshwater resources in the basin for human consumption agriculture aquaculture industry fishing and recreation and other economic activities more than three quarters of the total water used in the mobile river basin is from the surface water of aquatic habitats atkins 2004 numerous fish ponds in mid west alabama and east mississippi along the black prairie belt in the basin contribute to the formation of the second leading farm raised channel catfish production in the usa schrader and dennis 2005 despite these great economic benefits of the catfish aquacultural industry the effluents of the catfish farming have drawn increasing public concerns on the overloading nutrients in water bodies possible downstream water pollutions boyd 2003 boyd et al 2008 and their contribution to harmful algal blooms habs in the mobile bay macintyre et al 2011 to manage the lentic habitats for aquaculture and to monitor water quality and aquatic environment basic geospatial information about the lentic habitats is required the geographical location size shape spatial distribution and adjacent land use and land cover of the lentic habitats are particularly useful in evaluating aquacultural productivity of these lentic habitats the risk of eutrophication and hab occurrences and ecological effects on the surrounding areas however the baseline inventory and detailed maps and quantitative information for most freshwater habitats are not available or outdated the development of baseline aquatic habitat inventory and maps through conventional field surveys is time consuming labor intensive and expensive particularly at regional and basin scales remote sensing technology provides a more efficient alternative approach to mapping aquatic habitats numerous automatic or semi automatic algorithms have been developed to delineate aquatic habitats by using various remote sensing data including optical images e g landsat spot aster ikonos quickbird and worldview liu 2009 synthetic aperture radar sar images e g radarsat ers envisat sentinel 1 liu and jezek 2004a liu and jezek 2004b mason and davenport 1996 or lidar point clouds liu 2009 liu et al 2007 most of the previous aquatic habitat delineation algorithms are pixel based through detecting the surface water boundaries of aquatic habitats with edge detection techniques or identifying water pixels of aquatic habitats with image segmentation or classification techniques liu and jezek 2004a since pixels are uniform and contain insufficient geometric and hydrologic attributes pixel based representation is not suitable for identifying individual aquatic habitats separating lentic and lotic habitats and deriving their geospatial attributes to support the aquacultural and environmental planning and management activities this paper presents a novel method of mapping and inventorying lentic habitats with the baseline information at a large basin scale using the recently emerged esa sentinel 2 satellite images and usgs digital elevation models dems using the new method we delineate as individual discrete objects all the lentic habitats with a water surface area larger than 10 000 m2 1 0 ha in the mobile river basin the accuracy of their geographical position and geometry has been assessed using high resolution planetscope cubesat imagery the method is based on object oriented approach to represent lentic habitats as discrete objects and deriving baseline geospatial attributes for each lentic habitat object using geospatial analysis through hydrologic analysis of the stream network with basin wide usgs dems lotic habitats have been automatically separated from lentic habitats and are excluded from analysis since lotic habitats are totally different types of habitats and beyond the scope of this paper in the following sections we introduce the study area and the data sets present the methods for lentic habitat delineation and geospatial attribute derivation evaluate the accuracy of the mapped lentic habitats derive a set of geospatial attributes for lentic habitats examine areal size pattern spatial distribution and surrounding land use types of lentic habitats and also discuss the methodology and results 2 study area and data sets 2 1 study area the mobile river basin located in the southeast of the united states is the sixth largest basin in the united states mcpherson et al 2003 the total area of the basin is over 113 960 km2 the basin encompasses parts of alabama mississippi georgia and tennessee fig 1 two thirds of the basin is located in the state of alabama mcpherson et al 2003 fig 1 the mobile river basin comprises approximately 70 of forested land 26 of agriculture land and 3 of urbanized land atkins 2004 mcpherson et al 2003 its population is about 8 3 million in 2018 u s census bureau 2018 most concentrated in birmingham montgomery tuscaloosa and mobile rugged mountains and plateaus are located in the northeast of the basin including piedmont the valley and ridge and the appalachian plateaus the south and west of the basin are dominated by broad flat plains and rolling hills fig 1 and 56 of the basin lies within the east gulf section of the coastal plain the black prairie belt is part of the coastal plain and extends through central alabama curving upward into northeastern mississippi the black prairie belt is characterized by the prairie like vegetation and dark colored soils formed from clayey laid over a soft limestone the climate of the basin is warm and humid ranging from temperate at higher elevations to subtropical near the coast although precipitation is quite evenly distributed throughout the year a wet season with more rainfall usually occurs during the winter and spring months and a distinct dry season from midsummer to late fall liu et al 2005 the mobile river is formed by the confluence of two large rivers the tombigbee and alabama rivers fig 1 following the regional precipitation patterns the river discharge peaks in march while the minimum flow occurs during the late summer when evapotranspiration is the highest schroeder et al 1990 the stream flows in the basin are highly regulated by upstream reservoirs for water supplies flood control and navigational locks and dams and hydroelectric plants downstream from the confluence the mobile river flows south into the mobile bay contributing approximately 95 of the freshwater inflow to the bay the mean annual streamflow in the basin is approximately 1800 m3 s 64 000 ft3 s the fourth largest river basin in the united states in terms of streamflow mcpherson et al 2003 usgs 2019 besides thousands of kilometers of stream and river channels tens of thousands of lakes reservoirs and ponds are distributed in the basin 2 2 data sets in this study 21 sentinel 2 multispectral images are used as the primary data sources for detecting and delineating aquatic habitats at the basin scale twenty three dem tiles usgs national elevation dataset ned are used to extract the stream network at the basin scale which provides valuable hydrologic information for separating lentic and lotic habitats the high resolution four band planetscope images from planet labs are used to evaluate the accuracy of the sentinel 2 image derived lentic habitats in addition several ancillary data sets for the basin have been used to support the data analysis and result interpretation the sentinel 2 satellite system from the european space agency esa provides global multispectral high spatial resolution observations drusch et al 2012 which are especially suitable for the delineation of aquatic habitats at a large spatial scale the multispectral instrument msi sensors onboard sentinel 2a b satellites acquire multispectral imagery with 13 spectral bands at various spatial resolutions 10 m spatial resolution for blue green red and near infrared nir bands 20 m for three red edge bands a narrow nir band and two short wave infrared swir bands and 60 m for a coastal aerosol band a water vapor band and a cirrus swir band drusch et al 2012 frampton et al 2013 to determine the maximum spatial extents of lentic habitats for their baseline information the multispectral images acquired by sentinel 2a and sentinel 2b satellites during the wet season from january 28 2019 to april 26 2019 are selected in total 21 sentinel 2 msi level 1c image tiles are used in this study and these images are obtained at no cost from esa copernicus open access hub https scihub copernicus eu dhus home these selected images are nearly cloud free each with a cloud coverage of less than 1 the level 1c image products are the top of atmosphere toa reflectance they have been orthorectified and georeferenced to utm zone 16 n coordinate system with reference to the wgs84 ellipsoid a high resolution planetscope image from planet labs inc planet application program interface 2017 is used to visually interpret and extract lentic habitats as the ground truth to evaluate the accuracy of the sentinel 2 image derived lentic habitats the planetscope image has a spatial resolution of 3 m with four spectral bands blue green red and nir this planetscope image was collected by the planetscope constellation on january 28 2019 the exact same day when sentinel 2 satellite acquired the corresponding multispectral image used in this study we combined 23 ned tiles at 10 m spatial resolution https viewer nationalmap gov basic to derive the stream network system in the mobile river basin which is used to assist the separation of lotic habitat objects from lentic habitat objects the 30 m spatial resolution national land cover database 2016 nlcd 2016 from usgs multi resolution land characteristics consortium mrlc https www mrlc gov wickham et al 2014 is used to assist the interpretation of the land cover and land use types surrounding the aquatic habitats the hydrologic units hu at the level of 4 from the united states geological survey usgs watershed boundary dataset wbd are used to define the boundary of the mobile river basin and all aquatic habitats within or cross the basin boundary are delineated and mapped 3 methods we use the open water surface at the wet season to represent and map aquatic habitats each aquatic habitat is numerically defined as a surface water patch object consisting of a set of spatially connected water pixels the object oriented image analysis method and the dem based stream network analysis method have been combined to classify aquatic habitats first the isodata unsupervised classification method is applied to sentinel 2 multispectral images to identify and map water pixels in the basin then an object oriented method is used to identify and form discrete aquatic habitat patches objects we delineate the basin s stream network from the ned which is then overlaid with the image derived aquatic habitat objects to classify them into lotic and lentic habitats a set of geospatial and shape attributes centroid location area perimeter circularity has been numerically derived with an object oriented approach for each lentic habitat the pattern of lentic aquatic habitats in the mobile river basin is then analyzed 3 1 identification of water pixels by an unsupervised image classification sentinel 2 multispectral images were processed to identify water pixels first a median filter is applied to sentinel 2 multispectral images in order to reduce image noise while preserving the sharp edges of surface water features bovik et al 1987 then the iterative self organizing data analysis technique isodata dubes and jain 1976 tou and gonzalez 1974 unsupervised classification method is applied to the sentinel 2 multispectral images to map water pixels in the isodata unsupervised classification only four spectral bands blue green red and nir of sentinel 2 images with a 10 m spatial resolution are utilized the use of these spectral bands ensures the best spatial resolution of the detected aquatic habitats while keeping sufficient spectral information to identify water pixels the isodata unsupervised classification performs an iterative optimization clustering of the image pixels in terms of their multispectral values to ensure a sensitive and accurate extraction of aquatic habitats the unsupervised classification through isodata generates 12 to 15 clusters the clusters of pixels resulted from the isodata unsupervised classification are grouped into two categories through interpretation water pixels and non water pixels water pixels are recoded with a value of 1 and non water pixels with 0 to form a binary image for further processing to form aquatic habitat objects 3 2 object based representation of aquatic habitats our object oriented image analysis method uses a region growing algorithm sonka et al 2014 to form and identify discrete aquatic habitats as image objects based on the water pixels classified from the sentinel 2 multispectral images a discrete aquatic habitat object is a spatially continuous surface water patch consisting of a set of connected water pixels the region growing algorithm scans the binary image in a row wise manner and the first water pixel encountered is marked as a seed of an aquatic habitat object then the aquatic habitat object is expanded from the seed by searching and including its adjacent water pixels the newly marked adjacent pixels are used as new seeds for further expansion by searching and including their neighboring water pixels the region growing and expansion process stops when there are no adjacent water pixels to all the marked water pixels all the marked water pixels form a discrete aquatic habitat object and are coded with a unique identification number these marked pixels are excluded from the following scan by recoding as non water pixels the above region growing process is repeated to the next aquatic habitat object until all the image pixels are scanned and marked from the region growing algorithm we obtain a raster representation of discrete aquatic habitats as image objects for this study a minimum mapping unit of 10 000 m2 1 0 ha is used to map the aquatic habitats in the basin namely only aquatic habitat objects with an area of more than 100 water pixels are kept for further processing and those aquatic habitat objects with water pixels fewer than 100 water pixels are removed as noisy and unreliable objects a shoreline tracing algorithm liu et al 2011 is used to numerically delineate the boundary of each aquatic habitat object from the previous image processing steps in this way the polygons enclosed by the shorelines of the water body image objects are appended to a pre built polygon shapefile to form the vector representation of aquatic habitats the douglas peucker algorithm liu et al 2011 is then used to simplify the polygon of aquatic habitat objects the simplification tolerance is set to 10 m 1 pixel width on sentinel 2 image to smooth saw toothed edges while maximizing the natural shape of the aquatic habitat objects each of the 21 sentinel 2 image tiles is individually processed in the environment of envi 5 3 and idl 8 5 the outputs are merged and dissolved into a single data file for the entire basin the delineated aquatic habitat objects have been visually inspected for quality control by overlaying them on sentinel 2 natural color image composition erroneous aquatic objects mainly caused by cloud shadows and building shadows were removed 3 3 separation of lentic and lotic habitat objects freshwater aquatic habitats can be classified into two broad categories lentic and lotic habitats bain et al 1999 and they play different roles in local environments lotic habitats are linear stream like features with significant water flux including creeks streams and rivers the lentic habitats include natural or artificial ponds lakes and reservoirs and they have still standing water and may be isolated from the streams in comparison the water in lentic habitats has much longer residence time than that in the lotic habitats automated classification of aquatic habitats into lotic and lentic types is challenging by solely using image analysis methods because of insufficient separability in this study we synergistically combine the hydrologic information about the stream network from the ned dems and the geospatial information of aquatic habitats from the esa sentinel 2 multispectral images to realize the automated separation of lotic habitats from lentic habitats we derive the digital stream network from the ned dems for the mobile river basin using the arcgis 10 5 hydrology toolbox bachelot et al 2016 a total of 23 dem tiles are merged to fully cover the entire basin after filling the sinks and pits the flow direction layer is calculated from the hydrologically enforced dem using the d8 algorithm o callaghan and mark 1984 the flow accumulation is then calculated from the flow direction layer the dem cells with flow accumulation area larger than 1000 km2 are marked as stream channel cells this threshold value is selected to optimize the correspondence of digitally derived stream channels to the lotic aquatic habitats derived from the sentinel 2 images next the raster representation of stream channels is converted to a topologically structured vector representation of the stream network in the basin with reference to the hydrologically derived stream network we numerically examine all aquatic habitat objects derived from the object oriented image analysis method the aquatic habitat objects that are intersected by the hydrologically derived stream network are considered to have flowing water and designated as lotic habitat objects the remaining aquatic habitats without the interaction with the stream network are considered to have standing water and hence classified as lentic habitat objects this spatial intersection operation is realized by using the spatial query function in arcgis 10 5 select by location tool the spatial selection is set to intersect the polyline features of the stream links with the polygon features of all aquatic habitat objects all the selected aquatic habitat objects are saved as a new polygon shapefile that contains only the lotic habitats the remaining aquatic habitat objects after the selection are saved as a new polygon shapefile that contains only the lentic habitats 3 4 geospatial attributes of lentic habitat objects spatial accuracy assessment and pattern analysis a set of geospatial properties of these lentic habitat objects has been computed including x y coordinates of the centroid point surface water area perimeter and circularity index ci ci shows the compactness of a lentic habitat casas et al 2012 schmadel et al 2018 the value of 1 for the circularity index shows that the habitat has the most compact shape a circle an elongated linear habitat like a channel formed reservoir has the least compact shape with a circularity index close to 0 theoretically the lotic habitat in a watershed is a continuous entity and it has perfect connectivity from the headwaters to the pour point the derived lotic habitat objects through remote sensing approaches have rich geometric and shape attributes but they are inevitable fragmentary segments of the entire lotic habitat entity though multiple approaches are applicable to correct the connectivity of the lotic habitat and to derive proper hydrologic attributes the discussion of these issues is excluded since it is beyond the scope of this paper we visually interpreted a high resolution planetscope image from planet labs inc on the same day as the sentinel 2 multispectral image this planetscope image has four spectral bands with 3 m spatial resolution covering an area of 224 km2 centered on 87 32 w 32 28 n due to its high spatial resolution and multiple spectral bands we are able to manually digitize the boundaries of aquatic habitats with high confidence and fidelity as the ground truth for the accuracy assessment fig 2 a total of 309 lentic habitat objects mostly fish ponds has been delineated from the planetscope image the mapping accuracy assessment is performed by comparing the aquatic habitats numerically derived from the sentinel 2 image with the corresponding manually digitized aquatic habitats first the centroid points of the ponds derived from planetscope image are compared with those derived from the sentinel 2 image to evaluate the overall geographic location accuracy for aquatic habitat objects the absolute centroid location displacement along the x axis and y axis and the distance of the displacement are derived as the location accuracy indicators for aquatic habitats second the boundaries digitized from the planetscope image are compared against those derived from the sentinel 2 image to evaluate the boundary displacement the boundary displacement of a pond is the total erroneous area divided by the perimeter of the pond third the area of the ponds manually digitized from planetscope image are compared with those derived from the sentinel 2 image and the ratio of correctly mapped area intersection divided by the ground truth area is calculated as the areal accuracy indicator for aquatic habitats the accuracy assessment measures are computed for each aquatic habitat object individually using the spatial analysis tools in arcgis 10 5 the abundance pattern shape pattern and spatial distribution pattern are then analyzed based on the derived geospatial properties of these lentic habitat objects the lentic habitat abundance according to the areal size is generally considered to confirm the power law downing et al 2006 according to the power law the lentic habitats are dominated by the small size in total number and the number of lentic habitats decreases rapidly with the increase in the habitat areal size though this law is challenged based on a recently derived global inventory of lakes verpoorter et al 2014 seekell et al show the validation of this law particularly in flat regions using a fractal based approach seekell et al 2013 since the vast majority of the lentic habitats in the mobile river basin are distributed in the downstream flat prairie it is considered appropriate to examine the abundance of lentic habitats in the mobile river basin with the power law for the mobile river basin we have fitted a power function with the number of lentic habitat objects as the dependent variable and the areal size of the lentic habitats as the independent variable using the least squared adjustment approach as follows n a a n 0 a ρ where n a a is the number of lentic aquatic habitats whose areas are equal to or larger than a threshold area a the constant power parameter ρ is the logarithmic decreasing rate in the number of lentic habitats corresponding to their sizes and n 0 is the estimated total number of lentic aquatic habitats whose areas are equal to or larger than the minimum mapping unit of the analysis 10 000 m2 1 0 ha the fitting of the power function is based on 31 samples with an equal interval at the logarithmic scale of lentic habitat size the coefficient of determination r2 is used to determine the goodness of fitness the shape pattern of the lentic habitats is visualized and analyzed through a histogram plot of their ci values in addition the spatial distribution pattern of the lentic aquatic habitats is visualized by a kernel density map generated in arcgis 10 5 the kernel density estimation uses the centroid points of these lentic habitat objects as their locations and the areal sizes of these lentic habitat objects as the weights silverman 2018 4 results and discussion 4 1 basin scale aquatic habitat map and accuracy assessment we have identified and delineated 19 158 aquatic habitat objects in the mobile river basin fig 3 675 3 5 were classified as lotic habitat objects while 18 483 96 5 were classified as isolated lentic habitat objects most lotic habitat objects are wide river channels fig 3 a the lentic habitat objects are mainly compact fish ponds fig 3 d and numerous natural lakes and reservoirs that connect narrow streams the accuracy assessment of the delineated lentic habitats is summarized in table 1 the mean location displacement of centroids is 2 77 m along x axis east west and 3 46 m along y axis north south the mean distance of location displacement is 5 50 m the mean boundary displacement of lentic habitats is 6 40 m the positional error of the habitat centroid point and the boundary is well below the resolution 10 m of the sentinel 2 image indicating that the sentinel 2 derived aquatic habitat map is accurate the areal accuracy of lentic habitat objects derived from the sentinel 2 image ranges from 78 36 to 99 24 with a median value of 93 56 the smaller lentic habitats tend to have lower areal accuracy than larger ones besides the high accuracy the fine resolution of the sentinel 2 imagery also enables us to truly investigate every single lentic habitat artificial fish ponds are always assembled together with about 15 m pond dikes between them fig 2 the assemble pattern makes it difficult to delineate each lentic habitat from coarse spatial resolution for instance 30 m spatial resolution on landsat image the inventory of the lentic habitats derived from this study while accurate represents only a short period the sentinel 2 image tiles are collected from the wet season of the mobile river basin between january 28 and april 26 in 2019 the short period of data collection means that the results are most useful as a baseline inventory for future studies of seasonal and annual changes as well as retrospective spatiotemporal evolution of lentic habitats in this basin despite its temporal limitations the derived dataset is a considerable advancement for the study site as only limited lentic habitat inventory data are available for the mobile river basin the national hydrology dataset plus nhdplus https www epa gov waterdata nhdplus national hydrography dataset plus has a water body layer but it was derived from a combined investigation in the past two decades the nhdplus water body inventory is derived from image sources of different seasons and years over the decades thus it is not possible to be used as a baseline inventory for spatiotemporal analysis our proposed method consists of two technical steps the first step is to extract water pixels using the pixel based unsupervised classification and the second step is to derive useful quantitative attributes for aquatic habitats and to separate aquatic habitats into lotic and lentic habitats using object oriented approach in the previous studies many classification methods have been used to identify the water bodies for instance random forest support vector machine svm and k nearest neighbors knn since the water body has a strong spectral signature ngoc et al 2019 water pixels can be identified with multispectral image data at a high accuracy no matter pixel based supervised unsupervised or object based classification method is used phiri et al 2020 note that the available software tools like ecognition developer are powerful for the high resolution image classification of multiple land cover types however the purpose of our first step is only to identify water pixels without considering the accuracy of other land cover types for the sake of the application easiness of our method we adopt the simple pixel based unsupervised classification method for the first step which is easy but adequate the more challenging and critical part of our method is the second step namely numerically deriving useful quantitative attributes for these habitat objects and automatically separating them into lotic and lentic habitat objects aquatic habitats are complicated systems at a large basin scale and they have diversified functions bain et al 1999 a detailed quantitative description and further classification of aquatic habitats brings more meaningful and useful information for aquatic habitat monitoring and management the available object oriented software tools including ecognition developer do not have the required functions for us to derive the critical attributes for our aquatic habitat objects nor to separate lotic and lentic habitat objects therefore we develop our object oriented approach for the second step the application of our proposed method in the mobile river basin has successfully separated the aquatic habitats into lotic and lentic habitats the aquatic habitats in the mobile river basin are dominated by the lentic habitat objects their spatial pattern and geospatial properties are quantified and analyzed our object oriented method is particularly suitable for the automatic separation of lentic and lotic habitats and the derivation of their quantitative information for aquatic habitat management at a large basin scale our method is fundamentally different from the commonly used object oriented image classification method like ecognition developer the ecognition method comprises image segmentation feature space optimization classifier training and classification and post classification operations the image objects are formed before classification by aggregating similar pixels into larger image patches objects baatz and schape 2000 lewiński 2006 the scale parameter or other similar functional parameters is used to control the size of image objects in the segmentation stage in the ecognition method a small value of the scale parameter benefits the accurate identification and formation of small lentic habitats but may result in serious over segmentation of large and complicated lotic habitats for instance the downstream mobile river is a braided river network along with multiple small ponds fig 4 a and the width of rivers ranges from approximately 50 m to 650 m to form proper image objects of these small ponds a scale parameter of 100 is optimal since water pixels have a unique spectral signature it is relatively easy to generate similar water body image objects using other methods such as a support vector machine svm with spectral information alone fig 4 c however the large single well connected lotic habitat object formed from our method fig 4 b is over segmented into numerous image objects the over segmented image objects make the separation of lotic from lentic habitat objects very difficult or impossible fig 4 c even the use of additional shape information like circularity index ci for further classification does not improve the quality of the resulting image objects fig 4 d in contrast our method is able to accurately form the complete aquatic habitat objects using a region growing algorithm the formation of image objects with our method is scale free aquatic image objects with variable size can be precisely formed and quantified the complete and well connected habitat objects created in our method make it possible to separate lotic objects from lentic objects in a simple but reliable manner our method is appliable to other high resolution remote sensing data sources the accuracy and minimum size of the detected aquatic habitats largely depend on the spatial resolution of source images in the mobile river basin many small lentic habitats fish ponds are located very close to lotic habitats narrow rivers and many lentic habitats fish ponds are also very close to each other in location the sentinel 2 images employed in this study are only adequate to confidently identify individual aquatic habitats with a minimum size of 1 0 ha 100 pixels on sentinel 2 image they are not adequate for the precise delineation of small and narrow aquatic habitats to precisely detect and map individual aquatic habitats smaller than 1 0 ha other remote sensing image data with a finer spatial resolution than sentinel 2 images are required such as spot 6 7 multispectral image 6 m pleiades 1a b multispectral image 2 m and worldview 2 3 4 multispectral image 1 84 m 1 24 m and 1 24 m at a much higher cost multispectral remote sensing data with the moderate spatial resolution are not adequate for the precise delineation of small and narrow aquatic habitats for instance the conventionally used landsat data since the narrow dikes between aquatic habitats may be within a mixed pixel on landsat image and the mixed pixels have a weak spectral signature for classification these neighboring aquatic habitats are not separable image fusion techniques are helpful to enhance the spatial resolution of landsat data song et al 2014 which would be necessary before employing our method to map small aquatic habitats the size of image tiles also influences the image object formation in our method large image tiles i e sentinel 2 100 km 100 km allow for the formation of large well connected lotic habitat objects and consequentially result in adequate separation of lotic and lentic habitat objects for our method planetscope image in contrast has a high spatial resolution but a small image tile size 8 km 26 km the lotic habitat objects formed from a single tile of the planetscope image have a similar fragmentation problem and result in a poor separability of lotic habitat objects from lentic habitat objects in such a case mosaicking several image tiles to a large one before applying our method is helpful 4 2 the size shape and spatial distribution of lentic habitats in the mobile river basin we have identified 18 483 lentic habitats which are mainly lakes and fish ponds the total water surface area of lentic habitats is 793 69 km2 which is 0 69 of the entire mobile river basin area the centroid location coordinates water surface area perimeter and circularity index are derived for all lentic habitats fig 5 and table 2 and the statistical summaries about the area perimeter and circularity index of lentic habitats in the basin are shown in table 3 the median size of lentic habitats is 2 09 104 m2 2 09 ha and the largest lentic habitat the inland lake in blount county al has a water surface area of 6 57 106 m2 657 30 ha the power law is evaluated for the lentic habitat abundance in the mobil river basin for this large basin we have fitted the power function as follows n a a 18597 a 0 8908 where n a a is the number of lentic aquatic habitats whose areas are equal to or larger than a threshold area a the constant power parameter 0 8908 is the logarithmic decreasing rate in the number of lentic habitats corresponding to their sizes the coefficient of determination r2 is 0 99 one way to interpret the power law is through the power parameter a strongly negative power parameter indicates that the smaller lentic habitats comprise more surface area than the larger ones and vice versa downing et al 2006 the fitted power parameter in the mobile river basin 0 8908 is weakly negative and it indicates the water surface area of lentic habitats is dominated by larger lentic habitats which is consistent with the global pattern verpoorter et al 2014 as the lentic habitats are dominated by fish ponds particularly in the black prairie belt region the shape is relatively compact with an apparent artificial geometry the median circularity index ci is 0 6143 table 3 and most lentic habitats in the mobile river basin have an oblong shape fig 6 the median value of circularity corresponds to an ellipse whose semi major semi minor axes ratio is 2 7571 1 the ratio is about 21 between the largest curvatures at the ends of major axes and the smallest curvatures at the ends of minor axes the fine resolution of sentinel 2 imagery enables the accurate estimation of the shape attributes for each lentic habitat especially for small ones in comparison the lentic habitat close to the minimum mapping unit 1 0 ha comprises much fewer image pixels for instance about 10 pixels on landsat imagery at a 30 m spatial resolution in such a case it is difficult to maintain the proper oblong shape of the lentic habitats and the precise curvature of the shorelines in one word the fine spatial resolution of the newly emerged sentinel 2 imagery is critical for the accurate shape delineation of lentic habitats to reveal the spatial distribution pattern of lentic habitats at the basin scale we have also calculated the kernel density of lentic habitats with their centroid points as their locations and their areal sizes as the weights silverman 2018 as revealed by the kernel density map fig 7 the lentic habitats are densely distributed along the black prairie belt in the middle of the mobile river basin the black prairie belt has a layer of rich and black topsoil on the chalk of the selma group which enabled agriculture development the black prairie belt is an intensive agriculture region in alabama and mississippi barone 2005 and its land use is dominated by planted and cultivated agriculture numerous natural or artificial lakes are precious resources for aquaculture and irrigation cleland 1920 webster and samson 1992 the concentration of lentic habitats also makes the black prairie belt the second leading production base of farm raised channel catfish in the usa schrader and dennis 2005 a recent boom in the inland farming of shrimp is also reported for the black prairie belt davis et al 2005 the striking spatial consistency between the black prairie belt and the blue lentic belt suggests a strong interaction between agriculture and aquaculture in mid west alabama and east mississippi and possible water quality issues resulted from this interaction are vague but open for investigation 4 3 environmental implications of aquatic habitats aquatic habitats perform many important environmental functions for example they recycle nutrients attenuate floods recharge groundwater and modify the local climate they constitute precious freshwater resources for human consumption agriculture aquaculture industry fishing and recreation and other economic activities in the mobile river basin more than three quarters of the total water use is from the surface water of aquatic habitats atkins 2004 the densely distributed lentic habitats in the black prairie belt support the productive inland farming of catfish and shrimp healthy aquatic habitats are vital for sustaining productive and diverse ecosystems in the basin however aquatic habitats have been increasingly threatened by various environmental stresses land use changes human activities and climate changes the baseline information about aquatic habitats derived from this study is critical for resource managers to protect conserve and restore lentic habitats lakes ponds and reservoirs in the mobile river basin the detailed map and various geometric attributes of lentic habitats provide the scientific basis for planning the aquaculture agriculture best management practices bmps managing agricultural aquacultural activities investigating aquatic environment and ecology and estimating the productivity for instance the information about lentic habitats is important in estimating the effluent discharge volume and tracking and modeling the transport of the effluents into the lotic habitats hence helpful to evaluate downstream water safety to understand the impacts of human economic activities on aquatic habitats we examined the land cover and land use types surrounding aquatic habitats based on the national land cover database 2016 nlcd 2016 from usgs multi resolution land characteristics consortium mrlc fig 8 we numerically summarized land use types along the shoreline of each aquatic habitat object in this way we obtained statistical information about land cover and land use structure around lotic and lentic habitats fig 9 about 28 3 of the adjacent land covers surrounding lentic habitats are planted cultivated agriculture land use in contrast only 8 9 of the adjacent land covers surrounding lotic habitats and in river reservoirs are planted cultivated most of the lotic habitats streams and rivers provide water for surrounding forests 42 7 and wetlands 35 2 the intensive agricultural activities may have negative effects on the water quality of aquatic habitats boyd 2017 given the surrounding intensive agricultural activities and long water residence time lentic habitats have a higher risk of eutrophication and habs than lotic habitats meanwhile toxic materials associated with the pesticides may pollute adjacent lentic habitats it has been reported that the use of fertilizers in agriculture may cause excessive nitrogen and phosphorus dissolved into the surface runoff and accumulated in lakes and ponds resulting in elevated risks to aquaculture in alabama boyd 2017 and frequent occurrences of habs the effluents of overloaded nutrients from the aquaculture are periodically discharged to their adjacent drainage systems and affect the water quality of the downstream lotic habitats 5 conclusions this paper presents a novel method for lentic aquatic habitat mapping and inventory at a large basin scale this method integrates the object oriented image analysis of freely available esa sentinel 2 multispectral imagery and hydrologic stream network analysis using usgs dems to map and quantify lentic habitats the combination of shape information from the object oriented image analysis and hydrologic information from the stream network analysis enables us to classify aquatic habitats into lotic and lentic types a set of planimetric and geometric attributes has been numerically derived for each lentic habitat the abundance pattern shape pattern and spatial distribution pattern of the lentic habitats in the basin have been reported our integrated method has been successfully applied to the entire mobile river basin usa and lentic habitats at the basin scale have been delineated and inventoried at a 10 m spatial resolution 96 5 of the aquatic habitat objects identified in the mobile river basin are lentic habitats the number of lentic habitats decreases exponentially with the increase of areal size following the power law the most striking spatial pattern of lentic habitats is that small oblong lakes and fish ponds are densely distributed along the black prairie belt in the basin laying the foundation for the catfish aquacultural industry in the regions of mid west alabama and east mississippi approximately one third of the adjacent land cover to lentic habitats is agriculture land imposing strong stress and impacts on the water quality of lentic habitats aquatic habitats are essential for aquaculture agriculture and municipal water supply this study demonstrates that the integration of the recently emerged sentinel 2a b satellite multispectral imagery with dems represents an effective approach to the inventory and environmental investigation of lentic habitats at a basin scale the new generation of sentinel 2 satellite sensors can provide freely available multispectral imagery with sufficient spatial resolution and proper spectral configuration for inventorying and monitoring the lentic habitats at a large basin scale the detailed map of lentic habitats and their associated geometric attributes derived from this study are essential for planning the aquaculture agriculture best management practices bmps supporting the operations of water supply and irrigation system and monitoring and assessing the water quality and aquatic health condition in the mobile river basin our integrated method and associated sentinel 2 image source are transferable and applicable to the detailed lentic habitat inventory and mapping for other drainage basins in our future research we would apply our method to historical satellite images to derive time series aquatic habitat maps we would use our 2019 aquatic habitat map as the baseline inventory to conduct a retrospective investigation on the spatiotemporal evolution of the blue lentic belt and the inland fishery industry in alabama and mississippi this detailed aquatic habitat map will also be used as high resolution water masks to derive the water quality parameters for spatially distributed aquatic habitats in the mobile river basin from the multispectral sentinel 2 images credit authorship contribution statement yang liu conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization hongxing liu conceptualization methodology formal analysis investigation resources writing original draft writing review editing visualization supervision lei wang software writing original draft writing review editing min xu resources writing original draft writing review editing sagy cohen writing original draft writing review editing kai liu writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
4134,predicting water quality accurately is of utmost importance in water resource management this study focuses on the prediction of water quality parameters such as the dissolved oxygen do in the watershed system the traditional recurrent neural networks rnns suffer from gradient disappearance or explosion and inability to solve the problem of long time dependence and their practical applications are limited to overcome this drawback an improved long short term memory lstm model was proposed to improve the model s performance in addition to overcome nonstationarity randomness and nonlinearity of the water quality parameters data a hybrid model that recruits synchrosqueezed wavelet transform swt to denoise the original data was adopted a novel metaheuristic optimization algorithm the improved sparrow search algorithm issa combining cauchy mutation and opposition based learning obl was also implemented to compute the optimal parameter values for the lstm model the proposed hybrid model was evaluated using an original weekly water quality parameters series from 1 2010 12 2016 measured at the yongding river and gangnan gauging stations in the haihe river basin china the standalone lstm issa lstm swt lstm support vector regression svr and back propagation neural network bpnn were adopted as comparative forecast models using the same dataset the results demonstrate that the addressed model combining the strong noise resistant robustness of the swt and the nonlinear mapping of the lstm has the best prediction performance among the peer models at two gauging stations the proposed hybrid model can be used as an alternative framework for water quality prediction which can provide decision making basis for comprehensive water quality management and pollutant control in the basin keywords swt issa water quality prediction ensemble learning hybrid model 1 introduction water is the material basis for human beings and all other living things to survive grow and develop as a large developing country the current situation of water resources in china is not optimistic although china s total water resources are relatively abundant the per capita water resources are very low only 2075 m3 which is about 25 of the global per capita level and 20 of that of the united states ranking 121st in the world liang et al 2020 zou and cong 2021 basin water resources are an important part of water resources however due to the gradual intensification of human production and exponentially growing population in recent years the quality of the ecological environment of many basins has been declining year by year liu and xia 2004 gao et al 2019 and their carrying capacities are heavily loaded the ecological resources and regulatory functions of some river basins have been destroyed on a large scale due to environmental pollution which affects the healthy sustainable and coordinated development of the basin area therefore it is urgent to carry out scientific and comprehensive water quality prediction and provide insights for subsequent pollution control due to the influence of uncertain factors such as time climate industrial development and crowd flow monitoring data has a non linear characteristic traditional prediction methods are based on experimental judgments empirical formulas and numerical simulations and it is difficult to strip out relatively independent influencing factors from multiple indicators with correlation so that a universally applicable mathematical model cannot be established rajaee et al 2020 since the 21st century machine learning methods have developed rapidly with the development of artificial intelligence xu and liu 2013 scholars have attempted to use a data driven approach to circumvent the multifaceted modeling requirements and complex parameter correction process of traditional hydraulics models and instead directly explore the potential law among the data since artificial neural networks ann have strong nonlinear ability and can infinitely approximate any function it is widely used in water quality prediction however ann has a simple structure and cannot learn time series data by preserving prior time information khan and chai 2017 the recurrent neural networks rnns are also used for water quality prediction because of their embedded feedback recurrent structure zhang et al 2020 which allows them to preserve information from previous moments and use previous information to predict current information however rnns have shortcomings in gradient transfer and cannot solve the long time dependence problem liu et al 2019a liu et al 2019b as a variant of rnn the long short term memory lstm can effectively portray the long time dependence property among temporal data by introducing memory units in the network structure li et al 2018 and has powerful time series processing capability which has been widely extensively developed designed for solving various environmental engineering and water quality problems in case of lstm it is essential to determine approximate values of optimal hyper parameters barzegar et al 2020 in fact there is no formal or mathematical method for determining the appropriate optimal set of the key parameters of lstm and it is the improper selection of key parameters that causes the accuracy of many current prediction models to be low baek et al 2020 nowadays to overcome this drawback a more effective and feasible method is to optimize the target parameters through metaheuristic optimization algorithms including the sparrow search algorithm ssa particle swarm optimization algorithm afshar et al 2013 bat algorithm ehteram et al 2018 grey wolf optimization algorithm tikhamarine et al 2020 whale optimization algorithm yan et al 2018 etc li et al 2020 showed that the performance of the ssa proposed in 2020 is far superior in all aspects to that of other biological based group optimization algorithms and has great application potential despite the superior performance of the ssa algorithm the basic ssa is prone to fall into local extremes as the population diversity decreases in the late iterations few studies have been conducted to improve the ssa algorithm among which it is worth mentioning that mao and zhang 2020 proposed an improved sparrow search algorithm issa combining cauchy mutation and opposition based learning obl which successfully solves the problem of weak resistance to local optima of ssa so far there is no research on applying issa to the parameter optimization of lstm due to the influence of temperature hydrometeorology and human activities and other factors water quality parameters time series data show non linear non stationary and random characteristics wang et al 2020 and due to the impact of monitoring equipment monitoring methods water quality parameters time series bear certain complex noise interference kang and lin 2007 in order to improve the accuracy of water quality prediction the noise reduction pretreatment of non stationary original water quality time series based on signal decomposition technology is widely studied lu and ma 2020 which can deeply excavate all the characteristics of water quality series and reduce the interference of noise on water quality series at present wavelet transform wt empirical mode decomposition emd and hilbert huang transform hht are commonly used signal decomposition techniques he and chen 2010 but these traditional methods have some defects such as the wt requires the selection of an appropriate wavelet base to achieve a better noise reduction effect as different wavelet bases have different noise reduction effects zhang et al 2016 although emd and hht are capable of adaptively analyzing nonsmooth signals they suffer from the problems of modal confounding and serious endpoint effects yan et al 2021 even the later improved ensemble empirical mode decomposition eemd complete ensemble empirical mode decomposition with adaptive noise ceemdan and variational mode decomposition vmd are also limited by their respective characteristics and have certain drawbacks eemd effectively suppresses the occurrence of modal aliasing in emd by using the white noise property but there may be noise residues in the reconstructed signal yu et al 2018 ceemdan reduces the error caused by white noise but there will be spurious modes after decomposition which affects the accuracy of the algorithm liu et al 2021a liu et al 2021b the vmd decomposition technique usually discards the rich information carried by the remaining residual terms after decomposition directly which leads to the limitation of model prediction accuracy rezaie balf et al 2019 in recent years wavelet threshold denoising methods based on time frequency analysis have been widely used because of their simple calculation and good denoising effect this type of method takes advantage of the low frequency nature of chaotic signals starting from the spectral characteristics of the signal and noise and performs low pass filtering based on the differences in the spectral characteristics of chaotic and noisy signals while preserving the non periodic quality as much as possible to achieve noise cancellation of chaotic signals dong and ding 2016 however the wavelet threshold noise reduction method only considers the amplitude of the coefficients after the chaotic signal is decomposed yu et al 2020 the literature wei et al 2015 shows that considering only the coefficient amplitudes will inevitably make some useful signal coefficients with smaller amplitudes be removed while some noise coefficients with larger amplitudes be retained which affects the effectiveness of chaotic signal noise reduction the synchrosqueezed wavelet transform swt can obtain higher precision time frequency curves by squeezing the continuous wavelet transform time frequency map in the frequency direction herrera et al 2014 which effectively improves the spectral overlap phenomenon in the time frequency analysis of nonlinear complex signals swt also has better robustness to noise and when the signal is contaminated by strong noise swt can still obtain clear time frequency curves and basically invariant decomposition results tian et al 2020 based on the above the main objective of this paper was are 1 to apply the swt approach to the raw data with simultaneous squeeze output and bandpass filtering to achieve data noise reduction 2 to introduce the issa into lstm compute the optimal parameter values for the lstm model and construct the issa lstm model 3 to propose a swt issa lstm hybrid method as an alternative framework for water quality prediction test and verify its effectiveness the outline of this paper is as follows section 2 introduces the swt issa and lstm and then describes the formulation process of the proposed methodology section 3 describes the study area data sources parameter specification and evaluation criteria for forecasting performance section 4 presents experimental results which compare the performance of the algorithm with other similar algorithms section 5 discusses the results of the case study in section 6 the conclusion of the paper and the scope for future research works are outlined 2 material and methods 2 1 swt generally a non stationary signal s t can be expressed by the sum of a series of harmonics with different frequencies as follows 1 s t k 1 k a k t cos ϕ k t r t where ak t represents the instantaneous amplitude of the kth harmonic ϕ k t represents the instantaneous phase of the kth harmonic and r t represents the noise the instantaneous frequency fk t can be obtained by deriving the instantaneous phase in time 2 f k t 1 2 π d d t ϕ k t the principle of swt algorithm is divided into three main steps yue et al 2018 1 continuous wavelet transform cwt of the signal s t the cwt results of the signal in the time domain are as follows 3 w s a b s t a 1 2 ψ t b a d t where ws a b is the complex wavelet coefficient spectrum of the signal a is the scale factor b is the time shift factor and ψ t is the mother wavelet function the common mother wavelet functions are morlet wavelet bump wavelet gauss wavelet meyer wavelet etc fourier transform is performed on eq 3 which is transformed into frequency domain and the formula is 4 w s a b 1 2 π a 1 2 s ξ ψ a ξ e i b ξ d ξ where ξ is the angular frequency for a single frequency component harmonic signal s t acos wt the results of cwt in frequency domain are 5 w s a b a 4 π δ ξ w δ ξ w a 1 2 ψ a ξ e i b ξ d ξ a 4 π a 1 2 ψ a ξ e i b ξ 2 calculate the instantaneous frequency ws a b of the signal s t according to eq 5 if the wavelet basis function has a principal frequency ξ w 0 the energy of wavelet coefficients ws a b should theoretically be focused at the scale a w 0 w however the wavelet coefficients ws a b obtained in the analysis of the actual signal are distributed around the scale domain a w 0 w resulting in the signal time frequency curve becoming unclear and low resolution which appears more obvious especially in the analysis of signals with complex components daubechies et al 2011 found that although the wavelet coefficients ws a b diffuse in the scale direction their signal phase is constant then by deriving the wavelet coefficients in phase in the time domain the instantaneous frequency of the signal s t can be derived as 6 w s a b i b w s a b w s a b w s a b 0 w s a b 0 3 the swt value ts w b is obtained by compression and reorganization according to eq 6 the wavelet coefficients ws a b can be transformed from the time scale domain to the time frequency domain i e ws a b ws ws a b b on this basis the wavelet coefficients ws ws a b b are compressed and restructured in the frequency direction namely the scale direction so that their energy is focused thereby improving the fuzzy phenomenon in the scale direction in the discrete case of variables it is assumed that δak ak ak 1 δw w l w l 1 and swt squeezes the value of wavelet coefficient ws ws a b b within w l 1 2δw w l 1 2δw at any central frequency w l so as to obtain the swt value ts w l b whose mathematical expression is 7 t s wib δ w 1 a k w a k b w l δ w 2 w s a k b a k 3 2 δ a k similarly in the case of continuous variables then eq 7 can be changed to 8 t s w b a b w s a b a 3 2 δ w a b w d a 2 2 lstm as a deep neural network deep learning is a new research area in machine learning rnn as one of the deep learning methods is mainly used for sequential data processing rnn has a self connected hidden layer and its t moment hidden layer state relies on the t 1 moment hidden layer state for updating so it can solve the problem of long term dependence of time series rnns can theoretically perform effective processing of nonlinear time series but there are problems of gradient disappearance and gradient explosion in practical modeling applications for longer time series to solve the problem of gradient disappearance and gradient explosion of rnns hochreiter and schmidhuber 1997 proposed the lstm lstm is a variant of rnn and like rnn lstm hidden layer has repeating nodes with time sequences lstm nodes are more complex compared to rnns which replace neurons in the hidden layer of rnns with mnemonics as a way to achieve sequence information retention and long term memory liu et al 2019a liu et al 2019b the structure of a standard lstm memory is shown in fig 1 where c is the cell state of the lstm memory and h is the hidden layer state of the node each memory contains one or more memory cells and three types of gates the lstm stores the cell state information through the memory cells and the gate structure is responsible for the update and maintenance of the cell state the three gates include forgetting gate input gate and output gate the forgetting gate controls the effect of historical information on the current cell state ft determines the degree of passage of the cell state ct 1 at the previous moment 9 f t σ w f h t 1 x t b f where ct 1 is the cell state at moment t 1 ht 1 is the hidden layer state at moment t 1 σ is the sigmoid activation function w f is the input loop weight xt is the input value of the node at the current moment bf is the bias term the input gate determines what information enters the memory cell and the combination of the forgetting gate and the input gate allows for the updating of the cell state ct 10 i t σ w i h t 1 x t b i 11 ct tanh w c h t 1 x t b c 12 c t f t c t 1 i t c t where it is the input gate vector value c t is the new information c t is the cell state at moment t bi bc are bias terms w c is the input weight the output gate controls the output of cell state values which are processed by the tanh activation function and then multiplied with the memory cell state values to obtain the output information 13 o t σ w o h t 1 x t b o 14 h t o t tanh c t where ht is the hidden layer state at moment t w o is the input weight o t is the output value and b o is the bias term from the above equation it can be seen that the lstm node linearly modifies the information on the cell state through the gate structure thus ensuring that the temporal correlation does not decay even if the time series becomes longer 2 3 issa for the lstm model selected in this paper there are four parameters that have an important impact on the performance of the algorithm which are the number of neurons in the lstm hidden layer l 1 l 2 l 1 and l 2 refer to the number of lstm units in the first layer and the number of lstm units in the second layer the learning rate lr and the number of training iterations k these four key parameters are used as features for particle search and the lstm model is tuned and optimized using the issa algorithm 2 3 1 ssa the ssa originated from the theory of foraging behaviour and anti predation behaviour of sparrows the ssa was proposed by xue and shen 2020 this algorithm is novel and has the advantages of a strong optimization ability and a fast convergence speed the ssa mainly simulates the process of sparrow foraging the sparrow foraging process is a producer scrounger model and it superimposes the detection and early warning mechanism individual sparrows who easily find food are producers and other individuals are scroungers at the same time a certain proportion of individuals in the population are selected for investigation and early warning if danger is found food is abandoned as safety comes first there are producers scroungers and alerters in the ssa algorithm which updates their locations according to their respective rules as follows 15 x i j t 1 x i j t exp i α i t e r max if r 2 s t x i j t q l if r 2 s t where t represents the current iteration number j 1 2 3 and itermax is a constant that represents the maximum number of iterations xij represents the position information of the i th sparrow in the j th dimension α 0 1 is a random number r2 r2 0 1 and st st 0 5 1 represent the warning value and the safety value respectively q is a random number following a normal distribution l represents an l d matrix where each element in the matrix is 1 16 x i j t 1 q exp x worst x i j t i 2 i f i n 2 x p t 1 x i j t x p t 1 a l o t h e r w i s e where xp is the current best position occupied by the producer and xworst represents the current worst position globally a represents an l d matrix in which each element is randomly assigned a value of 1 or 1 and a at aat 1 when i n 2 this indicates that the i th scrounger with a lower fitness value has not received food and is in a very hungry state as a result the scrounger needs to fly to other places to find food to obtain more energy 17 x i j t 1 x best t β x i j t x best t if f i f g x i j t k x i j t x worst t f i f w ε if f i f g where xbest is the current global optimal position as a step length control parameter β is a random number that obeys a normal distribution with a mean of 0 and a variance of 1 k 1 1 is a random number and fi is the fitness value of the current individual sparrow fg and fw are the current global best and worst fitness values respectively ε is the smallest constant to avoid zero in the denominator the algorithm implementation is as follows step 1 initialize the number of sparrows and define the relevant parameters step 2 sort by fitness to find the current best fitness individual and the worst fitness individual step 3 use formula 15 to update the position of the front sparrow producers in terms of fitness step 4 use formula 16 to update the position of the late sparrow scrounger in terms of fitness step 5 use formula 17 to randomly update the positions of some sparrows alerters step 6 obtain the current updated position step 7 if the new position is better than the old position update the old position step 8 repeat steps 3 to 7 step 9 output the best fitness value and individual sparrows 2 3 2 issa to address the shortcomings of the ssa algorithm encountered in dealing with complex function optimization problems with low convergence accuracy and easy to fall into local optimum mao and zhang 2020 proposed an improved sparrow search algorithm incorporating cauchy mutation and obl it focuses on improving the global optimization performance of the ssa algorithm through the following three strategies 1 sin chaotic initialization the population initialization method of swarm intelligence optimization algorithm affects the convergence speed and the accuracy of the algorithm bajer et al 2016 in the conventional swarm optimization algorithm the initialization process is random and the random process can mostly ensure the initial population is evenly distributed but the quality of individuals cannot be guaranteed and some individuals in the population are far from the optimal ones which is not conducive to the accuracy improvement of the algorithm ssa algorithm does not guarantee the uniform distribution of sparrows in the entire solution space by randomly initializing the population without prior information chaotic mapping is a random motion state obtained by deterministic equations which has the characteristics of randomness ergodicity and initial value sensitivity the quality of the initial population can be improved by adding chaotic mapping sequences during population initialization enhancing population diversity and preventing premature population convergence sin chaos and logistic chaos are the most conventional population chaos initialization methods among which sin chaos initialization population can make the initial population of the sparrows traverse the whole search space and increase the probability of the algorithm to find the optimal solution liu et al 2018 the literature yang 2009 verified that sin chaos has more obvious chaotic characteristics than logistic chaos so sin chaos is used as the population initialization method of ssa algorithm the expression for the 1 dimensional self map of sin chaos is as follows 18 x n 1 sin 2 x n n 0 1 n 1 x n 1 x n 0 the initial value in the formula cannot be 0 to avoid the immobility and zero point within 1 1 2 dynamic adaptive weights the discoverer approaches the global optimal solution from the beginning of the iteration which leads to insufficient search range and easily falls into the local extreme value space resulting in insufficient search accuracy in this paper the global optimal solution of the previous generation is introduced in the discoverer location update formula which makes the discoverer location not only affected by the location of the previous generation but also affected by the global optimal solution of the previous generation which can effectively prevent the algorithm from falling into local optimum in addition referring to the idea of inertia weight the dynamic weight factor ω continues to be introduced into the location update formula of the discoverer so that it has a large value at the beginning of the iteration which can better conduct global exploration and reduce adaptively at the end of the iteration so as to better conduct local search and improve the convergence rate the formula for calculating the weight factor ω and the improved formula for updating the discoverer position are as follows 19 ω e 2 1 t i t e r max e 2 1 t i t e r max e 2 1 t i t e r max e 2 1 t i t e r max 20 x i j t 1 x i j t ω f j g t x i j t r a n d r 2 s t x i j t q r 2 s t where f j g t is the global optimal solution in the jth dimension in the previous generation the updated equation for the improved alerters is 21 x i j t 1 x best t β x i j t x best t f i f g x best t β x worst t x best t f i f g the improved formula indicates that if the sparrow is in the optimal position it will escape to a random position between the optimal and worst positions otherwise it will escape to a random position between itself and the optimal position 3 integration of cauchy mutation and obl mutation strategy is often used to improve the convergence accuracy of swarm intelligence algorithms among them gaussian mutation and cauchy mutation are two common disturbance strategies the literature lan and lan 2008 showed that the peak of the standard cauchy distribution near the zero point was lower than that of the standard gaussian distribution but the speed of the two sides reaching zero was slower than that of the gaussian distribution it can be seen that the disturbance ability of the cauchy mutation was stronger than that of the gaussian mutation the variation range was wider and it was easier to jump out of the local optimum therefore to address the characteristics of the sparrow search algorithm which is prone to fall into local optimum cauchy mutation is used to increase the diversity of the population improve the global search ability of the algorithm and increase the search space the cauchy mutation is introduced into the target position update formula and the perturbation ability of the cauchy operator is exerted to improve the global optimization performance of the algorithm 22 x i j t 1 x best t x best t c a u c h y 0 1 in 22 cauchy 0 1 is a standard cauchy mutation random value the random variable generating function of cauchy distribution is η tan ξ 0 5 π obl is a new method proposed by tizhoosh 2005 its purpose is to find the corresponding reverse solution through the obl mechanism based on the current solution and then save better solutions after evaluation in order to enable individuals to better find the optimal solution the obl strategy is integrated into the sparrow algorithm the mathematical representation is as follows 23 x best t u b r lb x best t 24 x i j t 1 x best t b 1 x best t x best t where x best t is the reverse solution of the optimal solution of the tth generation ub and lb are the upper and lower bounds respectively r is the random number matrix of 1 d d is the spatial dimension subject to the standard uniform distribution of 0 1 and b 1 is the information exchange control parameter the formula is as follows 25 b 1 i t e r max t i t e r max t in order to further improve the optimization performance of the algorithm mao and zhang 2020 also adopts a dynamic selection strategy to update the target position the obl strategy and the cauchy mutation operator perturbation strategy are alternately executed under a certain probability to dynamically update the target position in the obl strategy the reverse solution is obtained through the obl mechanism and the search field of the algorithm is expanded in the cauchy mutation strategy the cauchy mutation operator is used to perturbation and mutation at the optimal solution position to obtain a new solution which improves the defect that the algorithm falls into local optimum as for which strategy to adopt for target location update it is determined by the selection probability ps which is calculated as follows 26 p s exp 1 t i t e r max 20 θ the value of θ in eq 16 is the adjustment parameter and its value can be taken as 0 05 the specific selection strategy approach is as follows if rand ps the obl strategy of eqs 23 25 is selected for position updating otherwise the cauchy mutation strategy of eq 22 is selected for target position updating although the ability of the algorithm to leap out of the local space is enhanced by the above two perturbation strategies it is not possible to determine whether the new position obtained after the perturbation variation is better than the fitness value of the original position so after the perturbation variation update a greedy rule is introduced to determine whether the position should be updated by comparing the fitness values of the old and new positions the greedy rule is shown in eq 27 and f x denotes the location adaptation value of x 27 x best x i j t 1 f x i j t 1 f x best x best x best f x i j t 1 f x best the steps of the improved sparrow algorithm incorporating cauchy mutation and obl are as follows 1 define parameters such as population size n maximum number of iterations proportion of discoverers proportion of scouts alert threshold r 2 etc and initialize the sparrow population using the sin chaos mapping of eq 18 2 calculate the fitness value of each sparrow and find out the current optimal fitness value and the worst fitness value as well as the corresponding position 3 among the sparrows with better fitness values some of them are selected as finders and the positions are updated according to eq 20 4 the remaining sparrows are used as followers and the positions are updated according to eq 16 5 randomly select some sparrows from the sparrows as alerters and update the positions according to eq 21 6 select the cauchy mutation and the obl strategy to perturb the current optimal solution according to the probability ps to generate a new solution 7 based on the greedy rule formula 27 determine whether to perform the position update 8 determine whether the end condition is reached if yes proceed to the next step otherwise skip to step 2 9 the program ends and output the optimal result 2 4 the design of the water quality forecasting model based on swt issa lstm the flow chart of water quality parameter prediction model based on swt issa lstm is shown in fig 2 and the implementation process of the algorithm is mainly divided into the following steps 1 the swt method is used for noise reduction of water quality parameter time series data which mainly includes three sub steps of continuous wavelet transform instantaneous frequency acquisition and compression and recombination 2 based on the lstm model optimized by issa the hybrid prediction model issa lstm is constructed 3 input the data after swt denoising into issa lstm model for rolling prediction and compare the error evaluation index with other methods to analyze the prediction performance of the model 3 case study 3 1 data source the haihe river basin spans eight provinces and cities in beijing tianjin hebei shanxi henan shandong inner mongolia and liaoning and is densely populated with many cities with its superior geographical location rich natural resources developed talents and technological advantages the haihe river basin has become an important industrial and agricultural production base and high tech industrial base in china occupying an extremely important strategic position in the political economic and cultural development of china coupled with the support of national policy driven by beijing tianjin hebei urban agglomeration central plains urban agglomeration shandong peninsula urban agglomeration and so on in recent years the regional urban development is rapid and the regional water quality is strongly disturbed by human activities therefore it is of great practical significance to predict the water quality parameters of haihe river basin the data used were from the weekly automatic water quality monitoring report obtained at the yongding river and gangnan gauging station in the haihe river basin china 1 2010 12 2016 http www cnemc cn sssj szzdjczb index shtml with a total of 365 weeks of data the yangtze river basin lies between 35 n 43 n and 112 e 120 e covering a total area of 3 18 105 km2 the location map of the study area is shown in fig 3 fig 4 shows the weekly dissolved oxygen do monitoring data at yongding river and gangnan gauging station respectively 3 2 parameter specification in this paper the strategy that was used to address water quality series with missing values is the lagrange interpolation technique manembu et al 2015 these data were classified into two separate datasets which included 258 datasets for simulation purposes and 107 datasets for the purpose of testing the models to better extract the features on the time series as well as to generate more training samples the sliding time window technique is used for the generation of input samples and forecasting samples the sliding window width is set to 10 weeks i e the data used for forecasting use the data from the previous 10 weeks to predict the data of the next week for rolling forecasting in order to reduce the influence of the prediction performance due to the different dimensions of water quality data the sample data after swt denoising were normalized to improve the prediction accuracy according to the following formula 28 x x x max x max x min where xmin and xmax are the maximum and minimum values of the raw data respectively x is the data before normalization and x is the data after normalization the initial parameters of the standalone lstm algorithm are l 1 20 l 2 20 lr 0 005 and k 20 after a series of trial calculations the ssa parameters used to optimize lstm are set as follows the initial number of sparrows is 10 the maximum number of iterations is 20 and the number of producers accounts for 20 of the total number of sparrows while the number of alerters accounted for 10 of the total number of sparrows zhu and yousefi 2021 liu et al 2021a liu et al 2021b the warning threshold r 2 was 0 8 the parameter setting of issa is just adding the part of cauchy mutation and obl on the basis of ssa algorithm and the rest of the settings are the same as ssa the ssa and issa are used for the hyperparameter search of lstm where the values of l 1 are taken in the range 1 100 l 2 in the range 1 100 k in the range 1 50 and lr in the range 0 001 0 01 to verify the effectiveness and superiority of issa the gray wolf optimization algorithm gwo and the whale optimization algorithm woa are also used to optimize lstm the number of initial wolves and whales is 5 and the maximum number of iterations is 10 the value range of the above four hyperparameters is kept consistent with issa all the algorithms and models involved in this paper were implemented by in house coding on the platform of matlab r2018a and excel 2016 and illustrations were made by using software such as origin 2019b arcmap 10 7 and visio 2016 3 3 error evaluation criteria in this study nine different statistical performance evaluation criteria are used for comparing the model output results to actual values they included the maximum absolute error aemax mean absolute error mae mean relative error mape root mean square error rmse coefficient of determination r 2 correlation coefficient cc nash sutcliffe efficiency coefficient nsc index of agreement ia and the width of uncertainty band for the 95 confidence level 1 96se these metrics are calculated as follows 29 a e max max y i y i 30 mae 1 n i 1 n y i y i 31 mape 1 n i 1 n y i y i y i 100 32 rmse 1 n i 1 n y i y i 2 33 r 2 i 1 n y i y 2 i 1 n y i y i 2 34 cc i 1 n y i y i y i y i i 1 n y i y i 2 i 1 n y i y i 2 35 nsc 1 i 1 n y i y i 2 i 1 n y i y i 2 36 ia 1 i 1 n y i y i 2 i 1 n y i y y i y 2 37 e 1 n i 1 n y i y i s e i 1 n y i y i e 2 n 1 where n is the number of test samples y i and y i are the predicted and actual values of water quality at time i and y is the mean value of the actual values among them the smaller the value of aemax mae mape and rmse the higher the prediction accuracy the r 2 measures the degree of correlation between the observed and predicted values the larger the value of r 2 the better the prediction quality generally a model with cc closer to 1 is considered to have a better positive correlation the nsc is often used to evaluate the model performance introduced by nash and sutcliffe 1970 the nsc ranges from to 1 an efficiency of one nsc 1 corresponds to a perfect match of predicted data to the observed data an efficiency of zero nsc 0 indicates that the model predictions are as accurate as the mean of the observed data whereas an efficiency less than zero nsc 0 occurs when the observed mean is a better predictor than the model barzegar et al 2016 the range of ia is between 0 and 1 and the larger the value of ia the higher the prediction accuracy and the smaller the value of se the better the prediction quality 4 results limited to space and to avoid redundancy the main body of the paper focuses on the analysis of the monitoring data of yongding river gauging station and the detailed calculation results of gangnan gauging station are listed in table 3 4 1 comparison of different noise reduction methods fig 5 shows the fast fourier transform fft spectrum before and after swt noise reduction the two spectral curves are basically similar in morphology but it can be found through the local magnified observation that the data processed by swt are greatly attenuated in the high frequency component and the noise above 12 hz is no longer present so the noise reduction effect is obvious fig 6 shows the comparison of the time frequency plots of the original data before and after noise reduction visualization by local zooming shows that the noise reduction results in smoother data which is consistent with the findings in fig 5 in order to illustrate the effectiveness of swt in noise reduction of water quality parameter data time series three evaluation indexes cc signal to noise ratio rsn and residual energy percentage esn are used to evaluate the noise reduction effect quantitatively and the results were compared with emd eemd and vmd the signal to noise ratio rsn is calculated as follows 38 r sn 10 log n 0 n 1 s n 2 n 0 n 1 s n s n 2 where sn is the original sequence s n is the signal after noise reduction and n is the number of sampling points if the signal s n has a high signal to noise ratio after noise reduction it means that the noise reduction effect is good the sequence energy is calculated as 39 e t x t 2 d t t 1 m x t 2 the energy percentage esn of the noise reduced sequence to the original sequence is defined as 40 e sn e 0 e where e is the energy of the original sequence e 0 is the energy of the noise reduced sequence the larger esn is the closer the noise reduced sequence is to the original sequence fig 7 shows the decomposition results of emd and eemd fig 8 shows the vmd results of the original sequence the statistical results of cc rsn and esn for each decomposition method are given in table 1 according to table 1 in terms of cc the denoised sequences obtained by all four noise reduction methods correlate well with the original sequences after denoising and the cc of emd and swt are more significant than those of eemd and vmd however in terms of rsn and esn swt is significantly better than emd and eemd compared with emd eemd and vmd swt algorithm better preserves the potential information of the original sequence and eliminates the high frequency component i e noise therefore swt algorithm is more suitable for water quality parameter prediction 4 2 swt issa lstm results the goal of issa to optimize lstm hyperparameters is to maximize the accuracy of lstm so the best mean square error mse obtained by lstm in the training process is used as the fitness function of issa the error convergent curve during training process is shown in fig 9 a where x axis is the iteration of training y axis is model error as the iteration number became larger and larger the error of swt issa lstm converged quickly the fitness evolution curve of swt issa lstm reached the required accuracy within 5 iterations and then maintained the optimal fitness value showing strong learning ability and good performance fig 9 b shows the calculated results of lstm hyperparameters optimized by issa i e l 1 88 l 2 52 k 47 and lr 0 0090 4 3 comparison of different metaheuristic optimization algorithms to test and verify the effectiveness and superiority of the proposed issa algorithm gwo woa and ssa are used as the benchmark meta optimization algorithm models in this paper table 2 shows the results of lstm hyperparameters obtained by applying different meta optimization algorithms the lstm hyperparameters optimized by different meta optimization algorithms are used for prediction and the results are shown in fig 10 the meta optimization algorithms play an important role in improving the prediction accuracy of lstm algorithm compared with lstm ssa lstm issa lstm gwo lstm and woa lstm decrease by 30 47 36 22 21 34 and 19 08 in mae 34 98 37 27 19 53 and 17 88 in rmse and 29 52 35 23 21 81 and 19 45 in mape respectively results show that issa lstm outperforms other models in terms of three error evaluation criteria in addition the pattern of the error statistics applied at gangnan were consistent with those at yongding river station except that ssa lstm slightly outperforms issa lstm in terms of mae 4 4 comparison of the results of various prediction models fig 11 shows the comparison of the prediction results of various models according to fig 11 a the error distribution of the prediction results obtained by each method is mainly concentrated on the positive error side and the error is more concentrated between 0 5 0 5 for lstm swt lstm issa lstm swt ssa lstm swt issa lstm back propagation neural network bpnn and support vector regression svr the frequencies in this interval are 61 68 67 29 76 64 81 31 85 05 61 68 and 67 29 respectively among them the probability distribution density of swt issa lstm in this interval is far higher than that of the other models indicating that the prediction error of the model is the smallest fig 11 b shows the prediction curves of different models through detailed local observation it can be found that the swt issa lstm prediction curve is the closest to the actual value curve the prediction curve basically fall within the 95 confidence interval of the actual value curve and the prediction results are more accurate and reliable than other models for the gangnan monitoring station according to the frequency distribution histogram the model with the best prediction performance is swt ssa lstm followed by issa lstm and then swt issa lstm to some extent this is related to the serious nonlinearity and non smoothness of the monitoring data in the gangnan monitoring station taylor diagrams were used to check the precision of the proposed model and empirical models taylor 2001 in these diagrams the cc and standard deviation are specified by the azimuth angle and radial distances from the base point respectively kargar et al 2020 fig 12 shows the taylor diagram for the prediction results of applied algorithms according to fig 12 the rmse could be ranked from the lowest to the highest as follows swt issa lstm swt ssa lstm issa lstm swt lstm svr lstm bpnn and the correlation coefficient with the actual value from the highest to the lowest are swt issa lstm swt ssa lstm issa lstm swt lstm svr lstm bpnn the swt issa lstm model has the best performance and the highest accuracy among the peer models and it is suitable for the prediction of water quality parameters for the haihe river basin the performance of the evaluation indicators of the predicted results of the monitoring site in gangnan is inferior to that of the yongding river but the general pattern presented by the two sites remains consistent table 3 shows the performance comparison of applied algorithms according to table 3 the swt issa lstm model exhibited the best forecasting performance among all the peer models at yongding river station compared with the standalone lstm the swt issa lstm model reduce by 24 92 48 86 47 43 47 07 and 47 11 in aemax mae mape rmse and width of uncertainty band respectively and increase by 178 43 66 88 298 77 and 32 40 in r 2 cc nsc and ia respectively the performance improvement of swt issa lstm for the lstm model is significantly higher than that of the other models furthermore the model forecasting results applied at gangnan are basically consistent with those at yongding river station which also verifies the effectiveness and stability of the proposed model in terms of the model s performance in predicting extremes aemax ia width of uncertainty band and other indicators are selected for evaluation in this paper it is worth noting that the aemax of swt issa lstm is not the smallest among similar models at gangnan station this is because the sudden change of water quality monitoring data involves many complex influencing factors which may be caused by instantaneous point source pollution or the dilution of rainfall within the range of non point sources it is difficult to accurately predict similar extreme situations in practical projects therefore this model treats extreme values as outliers under certain circumstances i e noise components before carrying out predictions the issa lstm model is based on the denoised data i e the prediction target is the time series data with reduced extremes which causes the prediction results processed by swt to be sometimes inferior to those without swt in terms of aemax therefore the evaluation of model prediction performance should not be based on only one indicator but on the combined performance of multiple indicators ye et al 2019 proposed a new water quality parameter prediction model of lstm rnn network based on improved rnn network structure the rmse and mape of the model prediction results were 1 174 and 0 594 respectively to improve the efficiency of model execution and the predictive accuracy of the lstm networks yan et al 2019 realized a parallel model based on particle swarm optimization and lstm based on a microservices architecture the mape of the prediction results for chemical oxygen demand cod total nitrogen tn total phosphorus tp and ph were 5 3845 7 0321 5 9364 and 6 3451 respectively and the prediction accuracy is basically consistent with the swt issa lstm model proposed in this paper zhang and jin 2020 proposed a prediction method of spatiotemporal correlation water quality parameters based on automatic encoder ae dimensionality reduction and lstm neural network the r 2 of the model improved by 3 70 over that of the lstm model alone which is not as much as the improvement in this paper through a series of comparisons it can be found that the swt issa lstm model proposed in this paper has high accuracy and good prediction quality which is worthy of promotion and application 5 discussion in this research we verified the ability of the swt issa lstm model to address the temporal problem of water quality parameters the error statistics of the two gauging stations demonstrate that the addressed model combining the strong noise resistant robustness of the swt and the nonlinear mapping of the lstm has the best prediction performance among the peer models by averaging the error statistics of the two monitoring stations it can be found that compared with the standalone lstm the swt issa lstm model reduce by 21 99 40 33 39 84 36 37 and 36 25 in aemax mae mape rmse and width of uncertainty band respectively and increase by 105 73 41 11 177 23 and 20 08 in r 2 cc nsc and ia respectively the performance improvement of swt issa lstm for the lstm model is significantly higher than that of the other models in practical engineering application the hydrological monitoring station can make auxiliary decision based on the data processing platform embedded with swt issa lstm water quality prediction model by inputting daily or higher time frequency automatic water quality monitoring data to the model extrapolate the water quality data of the next day or a few days and formulate corresponding preventive measures according to the prediction results the research work has the following limitations swt is mostly used for signal noise reduction of seismic wave signal wind power bearing vibration signal and so on the noise reduction effect is more significant in the case of large amount of data in this paper the sampling frequency of water quality monitoring index is once a week although the water quality monitoring data in this paper covers seven years the amount of data is still not an order of magnitude for seismic wave signals in future research we recommend large data samples based on daily or hourly timescales in addition more effective pre processing methods for water quality data will be explored in the next research work in order to further improve the accuracy of the model in this paper the prediction sliding time window length is 10 and the water quality is predicted one step ahead these two indicators have a certain impact on the accuracy of prediction however the values of these two indicators are based on long term experience and trial calculation in the future research we should strengthen the research on the length of prediction sliding time window and advance prediction step the base algorithm lstm in the paper can be chosen from improved lstm or other base algorithms including bidirectional long short term memory bi lstm gated recurrent unit gru adaptive neuro fuzzy inference system anfis etc in addition the issa is only compared with several individual meta optimization algorithms it is worth mentioning that meta optimization algorithms can also be combined with each other so we will hybridize issa algorithm with other meta heuristics such as artificial bee colony abc firefly algorithm fa and artificial fish swarm optimization afso and then test for its optimization performance 6 conclusion water quality series analysis and prediction are prerequisites for managing regional water resources to solve the problem of gradient disappearance or explosion of traditional rnn and inability to solve the problem of long time dependence a novel hybrid model swt issa lstm was proposed in this paper for water quality parameter prediction the swt lstm issa lstm swt ssa lstm svr bpnn and the single lstm were adopted as comparative forecast models six different statistical performance evaluation criteria were used for comparing the model output results to actual values the results demonstrate that the addressed meta optimization algorithm issa combining cauchy mutation and obl effectively solves the problem of weak resistance to local optima of ssa the results in this study suggested that the swt issa lstm model exhibited the best forecasting performance among all the peer models the swt issa lstm model has a fast convergence speed and global convergence and can obtain more reliable and reasonable water quality prediction results therefore the proposed hybrid model can be used as effective and simple tools for water pollution warnings and management although the model proposed in this paper can already achieve high prediction accuracy the following aspects can be considered in future research 1 more effective pre processing methods for water quality data should be considered in order to further improve the accuracy of the model 2 explore the influence of the length of prediction sliding time window and advance prediction step on the prediction results 3 consider other factors affecting water quality in the model rather than purely time series issues credit authorship contribution statement chenguang song conceptualization methodology investigation writing original draft writing review editing leihua yao methodology writing review editing supervision chengya hua software data curation qihang ni software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the editors and anonymous reviewers for their constructive comments that greatly contributed to improving the manuscript this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
4134,predicting water quality accurately is of utmost importance in water resource management this study focuses on the prediction of water quality parameters such as the dissolved oxygen do in the watershed system the traditional recurrent neural networks rnns suffer from gradient disappearance or explosion and inability to solve the problem of long time dependence and their practical applications are limited to overcome this drawback an improved long short term memory lstm model was proposed to improve the model s performance in addition to overcome nonstationarity randomness and nonlinearity of the water quality parameters data a hybrid model that recruits synchrosqueezed wavelet transform swt to denoise the original data was adopted a novel metaheuristic optimization algorithm the improved sparrow search algorithm issa combining cauchy mutation and opposition based learning obl was also implemented to compute the optimal parameter values for the lstm model the proposed hybrid model was evaluated using an original weekly water quality parameters series from 1 2010 12 2016 measured at the yongding river and gangnan gauging stations in the haihe river basin china the standalone lstm issa lstm swt lstm support vector regression svr and back propagation neural network bpnn were adopted as comparative forecast models using the same dataset the results demonstrate that the addressed model combining the strong noise resistant robustness of the swt and the nonlinear mapping of the lstm has the best prediction performance among the peer models at two gauging stations the proposed hybrid model can be used as an alternative framework for water quality prediction which can provide decision making basis for comprehensive water quality management and pollutant control in the basin keywords swt issa water quality prediction ensemble learning hybrid model 1 introduction water is the material basis for human beings and all other living things to survive grow and develop as a large developing country the current situation of water resources in china is not optimistic although china s total water resources are relatively abundant the per capita water resources are very low only 2075 m3 which is about 25 of the global per capita level and 20 of that of the united states ranking 121st in the world liang et al 2020 zou and cong 2021 basin water resources are an important part of water resources however due to the gradual intensification of human production and exponentially growing population in recent years the quality of the ecological environment of many basins has been declining year by year liu and xia 2004 gao et al 2019 and their carrying capacities are heavily loaded the ecological resources and regulatory functions of some river basins have been destroyed on a large scale due to environmental pollution which affects the healthy sustainable and coordinated development of the basin area therefore it is urgent to carry out scientific and comprehensive water quality prediction and provide insights for subsequent pollution control due to the influence of uncertain factors such as time climate industrial development and crowd flow monitoring data has a non linear characteristic traditional prediction methods are based on experimental judgments empirical formulas and numerical simulations and it is difficult to strip out relatively independent influencing factors from multiple indicators with correlation so that a universally applicable mathematical model cannot be established rajaee et al 2020 since the 21st century machine learning methods have developed rapidly with the development of artificial intelligence xu and liu 2013 scholars have attempted to use a data driven approach to circumvent the multifaceted modeling requirements and complex parameter correction process of traditional hydraulics models and instead directly explore the potential law among the data since artificial neural networks ann have strong nonlinear ability and can infinitely approximate any function it is widely used in water quality prediction however ann has a simple structure and cannot learn time series data by preserving prior time information khan and chai 2017 the recurrent neural networks rnns are also used for water quality prediction because of their embedded feedback recurrent structure zhang et al 2020 which allows them to preserve information from previous moments and use previous information to predict current information however rnns have shortcomings in gradient transfer and cannot solve the long time dependence problem liu et al 2019a liu et al 2019b as a variant of rnn the long short term memory lstm can effectively portray the long time dependence property among temporal data by introducing memory units in the network structure li et al 2018 and has powerful time series processing capability which has been widely extensively developed designed for solving various environmental engineering and water quality problems in case of lstm it is essential to determine approximate values of optimal hyper parameters barzegar et al 2020 in fact there is no formal or mathematical method for determining the appropriate optimal set of the key parameters of lstm and it is the improper selection of key parameters that causes the accuracy of many current prediction models to be low baek et al 2020 nowadays to overcome this drawback a more effective and feasible method is to optimize the target parameters through metaheuristic optimization algorithms including the sparrow search algorithm ssa particle swarm optimization algorithm afshar et al 2013 bat algorithm ehteram et al 2018 grey wolf optimization algorithm tikhamarine et al 2020 whale optimization algorithm yan et al 2018 etc li et al 2020 showed that the performance of the ssa proposed in 2020 is far superior in all aspects to that of other biological based group optimization algorithms and has great application potential despite the superior performance of the ssa algorithm the basic ssa is prone to fall into local extremes as the population diversity decreases in the late iterations few studies have been conducted to improve the ssa algorithm among which it is worth mentioning that mao and zhang 2020 proposed an improved sparrow search algorithm issa combining cauchy mutation and opposition based learning obl which successfully solves the problem of weak resistance to local optima of ssa so far there is no research on applying issa to the parameter optimization of lstm due to the influence of temperature hydrometeorology and human activities and other factors water quality parameters time series data show non linear non stationary and random characteristics wang et al 2020 and due to the impact of monitoring equipment monitoring methods water quality parameters time series bear certain complex noise interference kang and lin 2007 in order to improve the accuracy of water quality prediction the noise reduction pretreatment of non stationary original water quality time series based on signal decomposition technology is widely studied lu and ma 2020 which can deeply excavate all the characteristics of water quality series and reduce the interference of noise on water quality series at present wavelet transform wt empirical mode decomposition emd and hilbert huang transform hht are commonly used signal decomposition techniques he and chen 2010 but these traditional methods have some defects such as the wt requires the selection of an appropriate wavelet base to achieve a better noise reduction effect as different wavelet bases have different noise reduction effects zhang et al 2016 although emd and hht are capable of adaptively analyzing nonsmooth signals they suffer from the problems of modal confounding and serious endpoint effects yan et al 2021 even the later improved ensemble empirical mode decomposition eemd complete ensemble empirical mode decomposition with adaptive noise ceemdan and variational mode decomposition vmd are also limited by their respective characteristics and have certain drawbacks eemd effectively suppresses the occurrence of modal aliasing in emd by using the white noise property but there may be noise residues in the reconstructed signal yu et al 2018 ceemdan reduces the error caused by white noise but there will be spurious modes after decomposition which affects the accuracy of the algorithm liu et al 2021a liu et al 2021b the vmd decomposition technique usually discards the rich information carried by the remaining residual terms after decomposition directly which leads to the limitation of model prediction accuracy rezaie balf et al 2019 in recent years wavelet threshold denoising methods based on time frequency analysis have been widely used because of their simple calculation and good denoising effect this type of method takes advantage of the low frequency nature of chaotic signals starting from the spectral characteristics of the signal and noise and performs low pass filtering based on the differences in the spectral characteristics of chaotic and noisy signals while preserving the non periodic quality as much as possible to achieve noise cancellation of chaotic signals dong and ding 2016 however the wavelet threshold noise reduction method only considers the amplitude of the coefficients after the chaotic signal is decomposed yu et al 2020 the literature wei et al 2015 shows that considering only the coefficient amplitudes will inevitably make some useful signal coefficients with smaller amplitudes be removed while some noise coefficients with larger amplitudes be retained which affects the effectiveness of chaotic signal noise reduction the synchrosqueezed wavelet transform swt can obtain higher precision time frequency curves by squeezing the continuous wavelet transform time frequency map in the frequency direction herrera et al 2014 which effectively improves the spectral overlap phenomenon in the time frequency analysis of nonlinear complex signals swt also has better robustness to noise and when the signal is contaminated by strong noise swt can still obtain clear time frequency curves and basically invariant decomposition results tian et al 2020 based on the above the main objective of this paper was are 1 to apply the swt approach to the raw data with simultaneous squeeze output and bandpass filtering to achieve data noise reduction 2 to introduce the issa into lstm compute the optimal parameter values for the lstm model and construct the issa lstm model 3 to propose a swt issa lstm hybrid method as an alternative framework for water quality prediction test and verify its effectiveness the outline of this paper is as follows section 2 introduces the swt issa and lstm and then describes the formulation process of the proposed methodology section 3 describes the study area data sources parameter specification and evaluation criteria for forecasting performance section 4 presents experimental results which compare the performance of the algorithm with other similar algorithms section 5 discusses the results of the case study in section 6 the conclusion of the paper and the scope for future research works are outlined 2 material and methods 2 1 swt generally a non stationary signal s t can be expressed by the sum of a series of harmonics with different frequencies as follows 1 s t k 1 k a k t cos ϕ k t r t where ak t represents the instantaneous amplitude of the kth harmonic ϕ k t represents the instantaneous phase of the kth harmonic and r t represents the noise the instantaneous frequency fk t can be obtained by deriving the instantaneous phase in time 2 f k t 1 2 π d d t ϕ k t the principle of swt algorithm is divided into three main steps yue et al 2018 1 continuous wavelet transform cwt of the signal s t the cwt results of the signal in the time domain are as follows 3 w s a b s t a 1 2 ψ t b a d t where ws a b is the complex wavelet coefficient spectrum of the signal a is the scale factor b is the time shift factor and ψ t is the mother wavelet function the common mother wavelet functions are morlet wavelet bump wavelet gauss wavelet meyer wavelet etc fourier transform is performed on eq 3 which is transformed into frequency domain and the formula is 4 w s a b 1 2 π a 1 2 s ξ ψ a ξ e i b ξ d ξ where ξ is the angular frequency for a single frequency component harmonic signal s t acos wt the results of cwt in frequency domain are 5 w s a b a 4 π δ ξ w δ ξ w a 1 2 ψ a ξ e i b ξ d ξ a 4 π a 1 2 ψ a ξ e i b ξ 2 calculate the instantaneous frequency ws a b of the signal s t according to eq 5 if the wavelet basis function has a principal frequency ξ w 0 the energy of wavelet coefficients ws a b should theoretically be focused at the scale a w 0 w however the wavelet coefficients ws a b obtained in the analysis of the actual signal are distributed around the scale domain a w 0 w resulting in the signal time frequency curve becoming unclear and low resolution which appears more obvious especially in the analysis of signals with complex components daubechies et al 2011 found that although the wavelet coefficients ws a b diffuse in the scale direction their signal phase is constant then by deriving the wavelet coefficients in phase in the time domain the instantaneous frequency of the signal s t can be derived as 6 w s a b i b w s a b w s a b w s a b 0 w s a b 0 3 the swt value ts w b is obtained by compression and reorganization according to eq 6 the wavelet coefficients ws a b can be transformed from the time scale domain to the time frequency domain i e ws a b ws ws a b b on this basis the wavelet coefficients ws ws a b b are compressed and restructured in the frequency direction namely the scale direction so that their energy is focused thereby improving the fuzzy phenomenon in the scale direction in the discrete case of variables it is assumed that δak ak ak 1 δw w l w l 1 and swt squeezes the value of wavelet coefficient ws ws a b b within w l 1 2δw w l 1 2δw at any central frequency w l so as to obtain the swt value ts w l b whose mathematical expression is 7 t s wib δ w 1 a k w a k b w l δ w 2 w s a k b a k 3 2 δ a k similarly in the case of continuous variables then eq 7 can be changed to 8 t s w b a b w s a b a 3 2 δ w a b w d a 2 2 lstm as a deep neural network deep learning is a new research area in machine learning rnn as one of the deep learning methods is mainly used for sequential data processing rnn has a self connected hidden layer and its t moment hidden layer state relies on the t 1 moment hidden layer state for updating so it can solve the problem of long term dependence of time series rnns can theoretically perform effective processing of nonlinear time series but there are problems of gradient disappearance and gradient explosion in practical modeling applications for longer time series to solve the problem of gradient disappearance and gradient explosion of rnns hochreiter and schmidhuber 1997 proposed the lstm lstm is a variant of rnn and like rnn lstm hidden layer has repeating nodes with time sequences lstm nodes are more complex compared to rnns which replace neurons in the hidden layer of rnns with mnemonics as a way to achieve sequence information retention and long term memory liu et al 2019a liu et al 2019b the structure of a standard lstm memory is shown in fig 1 where c is the cell state of the lstm memory and h is the hidden layer state of the node each memory contains one or more memory cells and three types of gates the lstm stores the cell state information through the memory cells and the gate structure is responsible for the update and maintenance of the cell state the three gates include forgetting gate input gate and output gate the forgetting gate controls the effect of historical information on the current cell state ft determines the degree of passage of the cell state ct 1 at the previous moment 9 f t σ w f h t 1 x t b f where ct 1 is the cell state at moment t 1 ht 1 is the hidden layer state at moment t 1 σ is the sigmoid activation function w f is the input loop weight xt is the input value of the node at the current moment bf is the bias term the input gate determines what information enters the memory cell and the combination of the forgetting gate and the input gate allows for the updating of the cell state ct 10 i t σ w i h t 1 x t b i 11 ct tanh w c h t 1 x t b c 12 c t f t c t 1 i t c t where it is the input gate vector value c t is the new information c t is the cell state at moment t bi bc are bias terms w c is the input weight the output gate controls the output of cell state values which are processed by the tanh activation function and then multiplied with the memory cell state values to obtain the output information 13 o t σ w o h t 1 x t b o 14 h t o t tanh c t where ht is the hidden layer state at moment t w o is the input weight o t is the output value and b o is the bias term from the above equation it can be seen that the lstm node linearly modifies the information on the cell state through the gate structure thus ensuring that the temporal correlation does not decay even if the time series becomes longer 2 3 issa for the lstm model selected in this paper there are four parameters that have an important impact on the performance of the algorithm which are the number of neurons in the lstm hidden layer l 1 l 2 l 1 and l 2 refer to the number of lstm units in the first layer and the number of lstm units in the second layer the learning rate lr and the number of training iterations k these four key parameters are used as features for particle search and the lstm model is tuned and optimized using the issa algorithm 2 3 1 ssa the ssa originated from the theory of foraging behaviour and anti predation behaviour of sparrows the ssa was proposed by xue and shen 2020 this algorithm is novel and has the advantages of a strong optimization ability and a fast convergence speed the ssa mainly simulates the process of sparrow foraging the sparrow foraging process is a producer scrounger model and it superimposes the detection and early warning mechanism individual sparrows who easily find food are producers and other individuals are scroungers at the same time a certain proportion of individuals in the population are selected for investigation and early warning if danger is found food is abandoned as safety comes first there are producers scroungers and alerters in the ssa algorithm which updates their locations according to their respective rules as follows 15 x i j t 1 x i j t exp i α i t e r max if r 2 s t x i j t q l if r 2 s t where t represents the current iteration number j 1 2 3 and itermax is a constant that represents the maximum number of iterations xij represents the position information of the i th sparrow in the j th dimension α 0 1 is a random number r2 r2 0 1 and st st 0 5 1 represent the warning value and the safety value respectively q is a random number following a normal distribution l represents an l d matrix where each element in the matrix is 1 16 x i j t 1 q exp x worst x i j t i 2 i f i n 2 x p t 1 x i j t x p t 1 a l o t h e r w i s e where xp is the current best position occupied by the producer and xworst represents the current worst position globally a represents an l d matrix in which each element is randomly assigned a value of 1 or 1 and a at aat 1 when i n 2 this indicates that the i th scrounger with a lower fitness value has not received food and is in a very hungry state as a result the scrounger needs to fly to other places to find food to obtain more energy 17 x i j t 1 x best t β x i j t x best t if f i f g x i j t k x i j t x worst t f i f w ε if f i f g where xbest is the current global optimal position as a step length control parameter β is a random number that obeys a normal distribution with a mean of 0 and a variance of 1 k 1 1 is a random number and fi is the fitness value of the current individual sparrow fg and fw are the current global best and worst fitness values respectively ε is the smallest constant to avoid zero in the denominator the algorithm implementation is as follows step 1 initialize the number of sparrows and define the relevant parameters step 2 sort by fitness to find the current best fitness individual and the worst fitness individual step 3 use formula 15 to update the position of the front sparrow producers in terms of fitness step 4 use formula 16 to update the position of the late sparrow scrounger in terms of fitness step 5 use formula 17 to randomly update the positions of some sparrows alerters step 6 obtain the current updated position step 7 if the new position is better than the old position update the old position step 8 repeat steps 3 to 7 step 9 output the best fitness value and individual sparrows 2 3 2 issa to address the shortcomings of the ssa algorithm encountered in dealing with complex function optimization problems with low convergence accuracy and easy to fall into local optimum mao and zhang 2020 proposed an improved sparrow search algorithm incorporating cauchy mutation and obl it focuses on improving the global optimization performance of the ssa algorithm through the following three strategies 1 sin chaotic initialization the population initialization method of swarm intelligence optimization algorithm affects the convergence speed and the accuracy of the algorithm bajer et al 2016 in the conventional swarm optimization algorithm the initialization process is random and the random process can mostly ensure the initial population is evenly distributed but the quality of individuals cannot be guaranteed and some individuals in the population are far from the optimal ones which is not conducive to the accuracy improvement of the algorithm ssa algorithm does not guarantee the uniform distribution of sparrows in the entire solution space by randomly initializing the population without prior information chaotic mapping is a random motion state obtained by deterministic equations which has the characteristics of randomness ergodicity and initial value sensitivity the quality of the initial population can be improved by adding chaotic mapping sequences during population initialization enhancing population diversity and preventing premature population convergence sin chaos and logistic chaos are the most conventional population chaos initialization methods among which sin chaos initialization population can make the initial population of the sparrows traverse the whole search space and increase the probability of the algorithm to find the optimal solution liu et al 2018 the literature yang 2009 verified that sin chaos has more obvious chaotic characteristics than logistic chaos so sin chaos is used as the population initialization method of ssa algorithm the expression for the 1 dimensional self map of sin chaos is as follows 18 x n 1 sin 2 x n n 0 1 n 1 x n 1 x n 0 the initial value in the formula cannot be 0 to avoid the immobility and zero point within 1 1 2 dynamic adaptive weights the discoverer approaches the global optimal solution from the beginning of the iteration which leads to insufficient search range and easily falls into the local extreme value space resulting in insufficient search accuracy in this paper the global optimal solution of the previous generation is introduced in the discoverer location update formula which makes the discoverer location not only affected by the location of the previous generation but also affected by the global optimal solution of the previous generation which can effectively prevent the algorithm from falling into local optimum in addition referring to the idea of inertia weight the dynamic weight factor ω continues to be introduced into the location update formula of the discoverer so that it has a large value at the beginning of the iteration which can better conduct global exploration and reduce adaptively at the end of the iteration so as to better conduct local search and improve the convergence rate the formula for calculating the weight factor ω and the improved formula for updating the discoverer position are as follows 19 ω e 2 1 t i t e r max e 2 1 t i t e r max e 2 1 t i t e r max e 2 1 t i t e r max 20 x i j t 1 x i j t ω f j g t x i j t r a n d r 2 s t x i j t q r 2 s t where f j g t is the global optimal solution in the jth dimension in the previous generation the updated equation for the improved alerters is 21 x i j t 1 x best t β x i j t x best t f i f g x best t β x worst t x best t f i f g the improved formula indicates that if the sparrow is in the optimal position it will escape to a random position between the optimal and worst positions otherwise it will escape to a random position between itself and the optimal position 3 integration of cauchy mutation and obl mutation strategy is often used to improve the convergence accuracy of swarm intelligence algorithms among them gaussian mutation and cauchy mutation are two common disturbance strategies the literature lan and lan 2008 showed that the peak of the standard cauchy distribution near the zero point was lower than that of the standard gaussian distribution but the speed of the two sides reaching zero was slower than that of the gaussian distribution it can be seen that the disturbance ability of the cauchy mutation was stronger than that of the gaussian mutation the variation range was wider and it was easier to jump out of the local optimum therefore to address the characteristics of the sparrow search algorithm which is prone to fall into local optimum cauchy mutation is used to increase the diversity of the population improve the global search ability of the algorithm and increase the search space the cauchy mutation is introduced into the target position update formula and the perturbation ability of the cauchy operator is exerted to improve the global optimization performance of the algorithm 22 x i j t 1 x best t x best t c a u c h y 0 1 in 22 cauchy 0 1 is a standard cauchy mutation random value the random variable generating function of cauchy distribution is η tan ξ 0 5 π obl is a new method proposed by tizhoosh 2005 its purpose is to find the corresponding reverse solution through the obl mechanism based on the current solution and then save better solutions after evaluation in order to enable individuals to better find the optimal solution the obl strategy is integrated into the sparrow algorithm the mathematical representation is as follows 23 x best t u b r lb x best t 24 x i j t 1 x best t b 1 x best t x best t where x best t is the reverse solution of the optimal solution of the tth generation ub and lb are the upper and lower bounds respectively r is the random number matrix of 1 d d is the spatial dimension subject to the standard uniform distribution of 0 1 and b 1 is the information exchange control parameter the formula is as follows 25 b 1 i t e r max t i t e r max t in order to further improve the optimization performance of the algorithm mao and zhang 2020 also adopts a dynamic selection strategy to update the target position the obl strategy and the cauchy mutation operator perturbation strategy are alternately executed under a certain probability to dynamically update the target position in the obl strategy the reverse solution is obtained through the obl mechanism and the search field of the algorithm is expanded in the cauchy mutation strategy the cauchy mutation operator is used to perturbation and mutation at the optimal solution position to obtain a new solution which improves the defect that the algorithm falls into local optimum as for which strategy to adopt for target location update it is determined by the selection probability ps which is calculated as follows 26 p s exp 1 t i t e r max 20 θ the value of θ in eq 16 is the adjustment parameter and its value can be taken as 0 05 the specific selection strategy approach is as follows if rand ps the obl strategy of eqs 23 25 is selected for position updating otherwise the cauchy mutation strategy of eq 22 is selected for target position updating although the ability of the algorithm to leap out of the local space is enhanced by the above two perturbation strategies it is not possible to determine whether the new position obtained after the perturbation variation is better than the fitness value of the original position so after the perturbation variation update a greedy rule is introduced to determine whether the position should be updated by comparing the fitness values of the old and new positions the greedy rule is shown in eq 27 and f x denotes the location adaptation value of x 27 x best x i j t 1 f x i j t 1 f x best x best x best f x i j t 1 f x best the steps of the improved sparrow algorithm incorporating cauchy mutation and obl are as follows 1 define parameters such as population size n maximum number of iterations proportion of discoverers proportion of scouts alert threshold r 2 etc and initialize the sparrow population using the sin chaos mapping of eq 18 2 calculate the fitness value of each sparrow and find out the current optimal fitness value and the worst fitness value as well as the corresponding position 3 among the sparrows with better fitness values some of them are selected as finders and the positions are updated according to eq 20 4 the remaining sparrows are used as followers and the positions are updated according to eq 16 5 randomly select some sparrows from the sparrows as alerters and update the positions according to eq 21 6 select the cauchy mutation and the obl strategy to perturb the current optimal solution according to the probability ps to generate a new solution 7 based on the greedy rule formula 27 determine whether to perform the position update 8 determine whether the end condition is reached if yes proceed to the next step otherwise skip to step 2 9 the program ends and output the optimal result 2 4 the design of the water quality forecasting model based on swt issa lstm the flow chart of water quality parameter prediction model based on swt issa lstm is shown in fig 2 and the implementation process of the algorithm is mainly divided into the following steps 1 the swt method is used for noise reduction of water quality parameter time series data which mainly includes three sub steps of continuous wavelet transform instantaneous frequency acquisition and compression and recombination 2 based on the lstm model optimized by issa the hybrid prediction model issa lstm is constructed 3 input the data after swt denoising into issa lstm model for rolling prediction and compare the error evaluation index with other methods to analyze the prediction performance of the model 3 case study 3 1 data source the haihe river basin spans eight provinces and cities in beijing tianjin hebei shanxi henan shandong inner mongolia and liaoning and is densely populated with many cities with its superior geographical location rich natural resources developed talents and technological advantages the haihe river basin has become an important industrial and agricultural production base and high tech industrial base in china occupying an extremely important strategic position in the political economic and cultural development of china coupled with the support of national policy driven by beijing tianjin hebei urban agglomeration central plains urban agglomeration shandong peninsula urban agglomeration and so on in recent years the regional urban development is rapid and the regional water quality is strongly disturbed by human activities therefore it is of great practical significance to predict the water quality parameters of haihe river basin the data used were from the weekly automatic water quality monitoring report obtained at the yongding river and gangnan gauging station in the haihe river basin china 1 2010 12 2016 http www cnemc cn sssj szzdjczb index shtml with a total of 365 weeks of data the yangtze river basin lies between 35 n 43 n and 112 e 120 e covering a total area of 3 18 105 km2 the location map of the study area is shown in fig 3 fig 4 shows the weekly dissolved oxygen do monitoring data at yongding river and gangnan gauging station respectively 3 2 parameter specification in this paper the strategy that was used to address water quality series with missing values is the lagrange interpolation technique manembu et al 2015 these data were classified into two separate datasets which included 258 datasets for simulation purposes and 107 datasets for the purpose of testing the models to better extract the features on the time series as well as to generate more training samples the sliding time window technique is used for the generation of input samples and forecasting samples the sliding window width is set to 10 weeks i e the data used for forecasting use the data from the previous 10 weeks to predict the data of the next week for rolling forecasting in order to reduce the influence of the prediction performance due to the different dimensions of water quality data the sample data after swt denoising were normalized to improve the prediction accuracy according to the following formula 28 x x x max x max x min where xmin and xmax are the maximum and minimum values of the raw data respectively x is the data before normalization and x is the data after normalization the initial parameters of the standalone lstm algorithm are l 1 20 l 2 20 lr 0 005 and k 20 after a series of trial calculations the ssa parameters used to optimize lstm are set as follows the initial number of sparrows is 10 the maximum number of iterations is 20 and the number of producers accounts for 20 of the total number of sparrows while the number of alerters accounted for 10 of the total number of sparrows zhu and yousefi 2021 liu et al 2021a liu et al 2021b the warning threshold r 2 was 0 8 the parameter setting of issa is just adding the part of cauchy mutation and obl on the basis of ssa algorithm and the rest of the settings are the same as ssa the ssa and issa are used for the hyperparameter search of lstm where the values of l 1 are taken in the range 1 100 l 2 in the range 1 100 k in the range 1 50 and lr in the range 0 001 0 01 to verify the effectiveness and superiority of issa the gray wolf optimization algorithm gwo and the whale optimization algorithm woa are also used to optimize lstm the number of initial wolves and whales is 5 and the maximum number of iterations is 10 the value range of the above four hyperparameters is kept consistent with issa all the algorithms and models involved in this paper were implemented by in house coding on the platform of matlab r2018a and excel 2016 and illustrations were made by using software such as origin 2019b arcmap 10 7 and visio 2016 3 3 error evaluation criteria in this study nine different statistical performance evaluation criteria are used for comparing the model output results to actual values they included the maximum absolute error aemax mean absolute error mae mean relative error mape root mean square error rmse coefficient of determination r 2 correlation coefficient cc nash sutcliffe efficiency coefficient nsc index of agreement ia and the width of uncertainty band for the 95 confidence level 1 96se these metrics are calculated as follows 29 a e max max y i y i 30 mae 1 n i 1 n y i y i 31 mape 1 n i 1 n y i y i y i 100 32 rmse 1 n i 1 n y i y i 2 33 r 2 i 1 n y i y 2 i 1 n y i y i 2 34 cc i 1 n y i y i y i y i i 1 n y i y i 2 i 1 n y i y i 2 35 nsc 1 i 1 n y i y i 2 i 1 n y i y i 2 36 ia 1 i 1 n y i y i 2 i 1 n y i y y i y 2 37 e 1 n i 1 n y i y i s e i 1 n y i y i e 2 n 1 where n is the number of test samples y i and y i are the predicted and actual values of water quality at time i and y is the mean value of the actual values among them the smaller the value of aemax mae mape and rmse the higher the prediction accuracy the r 2 measures the degree of correlation between the observed and predicted values the larger the value of r 2 the better the prediction quality generally a model with cc closer to 1 is considered to have a better positive correlation the nsc is often used to evaluate the model performance introduced by nash and sutcliffe 1970 the nsc ranges from to 1 an efficiency of one nsc 1 corresponds to a perfect match of predicted data to the observed data an efficiency of zero nsc 0 indicates that the model predictions are as accurate as the mean of the observed data whereas an efficiency less than zero nsc 0 occurs when the observed mean is a better predictor than the model barzegar et al 2016 the range of ia is between 0 and 1 and the larger the value of ia the higher the prediction accuracy and the smaller the value of se the better the prediction quality 4 results limited to space and to avoid redundancy the main body of the paper focuses on the analysis of the monitoring data of yongding river gauging station and the detailed calculation results of gangnan gauging station are listed in table 3 4 1 comparison of different noise reduction methods fig 5 shows the fast fourier transform fft spectrum before and after swt noise reduction the two spectral curves are basically similar in morphology but it can be found through the local magnified observation that the data processed by swt are greatly attenuated in the high frequency component and the noise above 12 hz is no longer present so the noise reduction effect is obvious fig 6 shows the comparison of the time frequency plots of the original data before and after noise reduction visualization by local zooming shows that the noise reduction results in smoother data which is consistent with the findings in fig 5 in order to illustrate the effectiveness of swt in noise reduction of water quality parameter data time series three evaluation indexes cc signal to noise ratio rsn and residual energy percentage esn are used to evaluate the noise reduction effect quantitatively and the results were compared with emd eemd and vmd the signal to noise ratio rsn is calculated as follows 38 r sn 10 log n 0 n 1 s n 2 n 0 n 1 s n s n 2 where sn is the original sequence s n is the signal after noise reduction and n is the number of sampling points if the signal s n has a high signal to noise ratio after noise reduction it means that the noise reduction effect is good the sequence energy is calculated as 39 e t x t 2 d t t 1 m x t 2 the energy percentage esn of the noise reduced sequence to the original sequence is defined as 40 e sn e 0 e where e is the energy of the original sequence e 0 is the energy of the noise reduced sequence the larger esn is the closer the noise reduced sequence is to the original sequence fig 7 shows the decomposition results of emd and eemd fig 8 shows the vmd results of the original sequence the statistical results of cc rsn and esn for each decomposition method are given in table 1 according to table 1 in terms of cc the denoised sequences obtained by all four noise reduction methods correlate well with the original sequences after denoising and the cc of emd and swt are more significant than those of eemd and vmd however in terms of rsn and esn swt is significantly better than emd and eemd compared with emd eemd and vmd swt algorithm better preserves the potential information of the original sequence and eliminates the high frequency component i e noise therefore swt algorithm is more suitable for water quality parameter prediction 4 2 swt issa lstm results the goal of issa to optimize lstm hyperparameters is to maximize the accuracy of lstm so the best mean square error mse obtained by lstm in the training process is used as the fitness function of issa the error convergent curve during training process is shown in fig 9 a where x axis is the iteration of training y axis is model error as the iteration number became larger and larger the error of swt issa lstm converged quickly the fitness evolution curve of swt issa lstm reached the required accuracy within 5 iterations and then maintained the optimal fitness value showing strong learning ability and good performance fig 9 b shows the calculated results of lstm hyperparameters optimized by issa i e l 1 88 l 2 52 k 47 and lr 0 0090 4 3 comparison of different metaheuristic optimization algorithms to test and verify the effectiveness and superiority of the proposed issa algorithm gwo woa and ssa are used as the benchmark meta optimization algorithm models in this paper table 2 shows the results of lstm hyperparameters obtained by applying different meta optimization algorithms the lstm hyperparameters optimized by different meta optimization algorithms are used for prediction and the results are shown in fig 10 the meta optimization algorithms play an important role in improving the prediction accuracy of lstm algorithm compared with lstm ssa lstm issa lstm gwo lstm and woa lstm decrease by 30 47 36 22 21 34 and 19 08 in mae 34 98 37 27 19 53 and 17 88 in rmse and 29 52 35 23 21 81 and 19 45 in mape respectively results show that issa lstm outperforms other models in terms of three error evaluation criteria in addition the pattern of the error statistics applied at gangnan were consistent with those at yongding river station except that ssa lstm slightly outperforms issa lstm in terms of mae 4 4 comparison of the results of various prediction models fig 11 shows the comparison of the prediction results of various models according to fig 11 a the error distribution of the prediction results obtained by each method is mainly concentrated on the positive error side and the error is more concentrated between 0 5 0 5 for lstm swt lstm issa lstm swt ssa lstm swt issa lstm back propagation neural network bpnn and support vector regression svr the frequencies in this interval are 61 68 67 29 76 64 81 31 85 05 61 68 and 67 29 respectively among them the probability distribution density of swt issa lstm in this interval is far higher than that of the other models indicating that the prediction error of the model is the smallest fig 11 b shows the prediction curves of different models through detailed local observation it can be found that the swt issa lstm prediction curve is the closest to the actual value curve the prediction curve basically fall within the 95 confidence interval of the actual value curve and the prediction results are more accurate and reliable than other models for the gangnan monitoring station according to the frequency distribution histogram the model with the best prediction performance is swt ssa lstm followed by issa lstm and then swt issa lstm to some extent this is related to the serious nonlinearity and non smoothness of the monitoring data in the gangnan monitoring station taylor diagrams were used to check the precision of the proposed model and empirical models taylor 2001 in these diagrams the cc and standard deviation are specified by the azimuth angle and radial distances from the base point respectively kargar et al 2020 fig 12 shows the taylor diagram for the prediction results of applied algorithms according to fig 12 the rmse could be ranked from the lowest to the highest as follows swt issa lstm swt ssa lstm issa lstm swt lstm svr lstm bpnn and the correlation coefficient with the actual value from the highest to the lowest are swt issa lstm swt ssa lstm issa lstm swt lstm svr lstm bpnn the swt issa lstm model has the best performance and the highest accuracy among the peer models and it is suitable for the prediction of water quality parameters for the haihe river basin the performance of the evaluation indicators of the predicted results of the monitoring site in gangnan is inferior to that of the yongding river but the general pattern presented by the two sites remains consistent table 3 shows the performance comparison of applied algorithms according to table 3 the swt issa lstm model exhibited the best forecasting performance among all the peer models at yongding river station compared with the standalone lstm the swt issa lstm model reduce by 24 92 48 86 47 43 47 07 and 47 11 in aemax mae mape rmse and width of uncertainty band respectively and increase by 178 43 66 88 298 77 and 32 40 in r 2 cc nsc and ia respectively the performance improvement of swt issa lstm for the lstm model is significantly higher than that of the other models furthermore the model forecasting results applied at gangnan are basically consistent with those at yongding river station which also verifies the effectiveness and stability of the proposed model in terms of the model s performance in predicting extremes aemax ia width of uncertainty band and other indicators are selected for evaluation in this paper it is worth noting that the aemax of swt issa lstm is not the smallest among similar models at gangnan station this is because the sudden change of water quality monitoring data involves many complex influencing factors which may be caused by instantaneous point source pollution or the dilution of rainfall within the range of non point sources it is difficult to accurately predict similar extreme situations in practical projects therefore this model treats extreme values as outliers under certain circumstances i e noise components before carrying out predictions the issa lstm model is based on the denoised data i e the prediction target is the time series data with reduced extremes which causes the prediction results processed by swt to be sometimes inferior to those without swt in terms of aemax therefore the evaluation of model prediction performance should not be based on only one indicator but on the combined performance of multiple indicators ye et al 2019 proposed a new water quality parameter prediction model of lstm rnn network based on improved rnn network structure the rmse and mape of the model prediction results were 1 174 and 0 594 respectively to improve the efficiency of model execution and the predictive accuracy of the lstm networks yan et al 2019 realized a parallel model based on particle swarm optimization and lstm based on a microservices architecture the mape of the prediction results for chemical oxygen demand cod total nitrogen tn total phosphorus tp and ph were 5 3845 7 0321 5 9364 and 6 3451 respectively and the prediction accuracy is basically consistent with the swt issa lstm model proposed in this paper zhang and jin 2020 proposed a prediction method of spatiotemporal correlation water quality parameters based on automatic encoder ae dimensionality reduction and lstm neural network the r 2 of the model improved by 3 70 over that of the lstm model alone which is not as much as the improvement in this paper through a series of comparisons it can be found that the swt issa lstm model proposed in this paper has high accuracy and good prediction quality which is worthy of promotion and application 5 discussion in this research we verified the ability of the swt issa lstm model to address the temporal problem of water quality parameters the error statistics of the two gauging stations demonstrate that the addressed model combining the strong noise resistant robustness of the swt and the nonlinear mapping of the lstm has the best prediction performance among the peer models by averaging the error statistics of the two monitoring stations it can be found that compared with the standalone lstm the swt issa lstm model reduce by 21 99 40 33 39 84 36 37 and 36 25 in aemax mae mape rmse and width of uncertainty band respectively and increase by 105 73 41 11 177 23 and 20 08 in r 2 cc nsc and ia respectively the performance improvement of swt issa lstm for the lstm model is significantly higher than that of the other models in practical engineering application the hydrological monitoring station can make auxiliary decision based on the data processing platform embedded with swt issa lstm water quality prediction model by inputting daily or higher time frequency automatic water quality monitoring data to the model extrapolate the water quality data of the next day or a few days and formulate corresponding preventive measures according to the prediction results the research work has the following limitations swt is mostly used for signal noise reduction of seismic wave signal wind power bearing vibration signal and so on the noise reduction effect is more significant in the case of large amount of data in this paper the sampling frequency of water quality monitoring index is once a week although the water quality monitoring data in this paper covers seven years the amount of data is still not an order of magnitude for seismic wave signals in future research we recommend large data samples based on daily or hourly timescales in addition more effective pre processing methods for water quality data will be explored in the next research work in order to further improve the accuracy of the model in this paper the prediction sliding time window length is 10 and the water quality is predicted one step ahead these two indicators have a certain impact on the accuracy of prediction however the values of these two indicators are based on long term experience and trial calculation in the future research we should strengthen the research on the length of prediction sliding time window and advance prediction step the base algorithm lstm in the paper can be chosen from improved lstm or other base algorithms including bidirectional long short term memory bi lstm gated recurrent unit gru adaptive neuro fuzzy inference system anfis etc in addition the issa is only compared with several individual meta optimization algorithms it is worth mentioning that meta optimization algorithms can also be combined with each other so we will hybridize issa algorithm with other meta heuristics such as artificial bee colony abc firefly algorithm fa and artificial fish swarm optimization afso and then test for its optimization performance 6 conclusion water quality series analysis and prediction are prerequisites for managing regional water resources to solve the problem of gradient disappearance or explosion of traditional rnn and inability to solve the problem of long time dependence a novel hybrid model swt issa lstm was proposed in this paper for water quality parameter prediction the swt lstm issa lstm swt ssa lstm svr bpnn and the single lstm were adopted as comparative forecast models six different statistical performance evaluation criteria were used for comparing the model output results to actual values the results demonstrate that the addressed meta optimization algorithm issa combining cauchy mutation and obl effectively solves the problem of weak resistance to local optima of ssa the results in this study suggested that the swt issa lstm model exhibited the best forecasting performance among all the peer models the swt issa lstm model has a fast convergence speed and global convergence and can obtain more reliable and reasonable water quality prediction results therefore the proposed hybrid model can be used as effective and simple tools for water pollution warnings and management although the model proposed in this paper can already achieve high prediction accuracy the following aspects can be considered in future research 1 more effective pre processing methods for water quality data should be considered in order to further improve the accuracy of the model 2 explore the influence of the length of prediction sliding time window and advance prediction step on the prediction results 3 consider other factors affecting water quality in the model rather than purely time series issues credit authorship contribution statement chenguang song conceptualization methodology investigation writing original draft writing review editing leihua yao methodology writing review editing supervision chengya hua software data curation qihang ni software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the editors and anonymous reviewers for their constructive comments that greatly contributed to improving the manuscript this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
