index,text
20705,as one of the renewable and clean energy sources wave energy has high density and all day availability characteristics however the development of wave energy converters has been hampered mainly because of the low efficiency induced high levelized energy costs the present study introduces an improved bistable mechanism composed of three linear springs aiming to enhance the performance of a point absorber employed as a wave energy converter the improved bistable mechanism features an asymmetric configuration of three linear stiffness springs one horizontal and two obliques on a vertical plane numerical simulations based on cummins equations in the time domain describe the point absorber dynamic behavior in regular and irregular waves the improved bistable wave energy converter featured a wider low equivalent stiffness range than linear and conventional bistable counterparts improving its ability to frequency shifting its lower potential barrier greatly improves the capture width ratio and frequency bandwidth at low excitations such characteristics facilitate the improved bistable wave energy converter to achieve higher efficiency than its linear and conventional bistable counterparts at low frequencies and enhance its robustness against power take off damping detuning and sea state changes these features altogether make the improved bistable mechanism an efficient alternative to explore the benefits of the bistable dynamics applied to wave energy converters keywords wave energy converter point absorber improved bistable mechanism nonlinear stiffness broadband energy harvesting 1 introduction renewable and clean energy sources have been receiving increasing attention to address the growing global demand for energy consumption and reduce greenhouse gas emissions in such a context wave energy benefited from its high energy density and all day availability estimated as high as 146 twh yr edenhofer et al 2011 has emerged as a promising alternative to become a competitive clean renewable energy source since the early 1980s different concepts of wave energy converters wecs have been proposed and tested to find competitive candidates for wave energy harvesting devices czech and bauer 2012 falcão 2010 shadman et al 2019 the mainstream idea behind all concepts prioritizes reducing the levelized cost of energy lcoe and high survivability performance in the case of point absorber pa type of wec it works efficiently only if acted by waves within the very narrow bandwidth close to its resonant frequency as a result the point absorber will extract a large amount of energy only from wave components located within a relatively narrow wave frequency band in the real sea different alternative approaches have been proposed to improve its performance the most obvious and straightforward way is to optimize buoy geometry to resonate in the predominant wave frequency for a specific sea state at a given deployment site goggins and finnegan 2014 shadman et al 2018 but due to the changeable nature of the real sea it still leads to quite limited efficiency gains to push up potential gains of efficiency to more adequate levels different active control strategies such as complex conjugate control maria arenas et al 2019 damping control jin et al 2019 rodríguez et al 2019 latching control falcão 2008 henriques et al 2016 j wu et al 2018 and model predictive control mpc faedo et al 2017 li and belmont 2014 zhan et al 2018 have been proposed and proved to be of some effectiveness however to work properly active control strategies require accurate and in some cases a priori prediction of the wave excitation force acting on the pa wec these requirements impose heavy burdens on its costs and can become a significant obstacle for the implementation of pa active controllers in light of such practical difficulties passive target approaches have alternatively attracted the attention of researchers and much progress has been reported wu et al 2018 2019 z wu et al 2018 younesian and alam 2017 zhang and yang 2015 as one of the possible performance boosting mechanisms the bistable mechanism also known as snap through or nonlinear stiffness mechanism is widely adopted in the vibration energy harvesting realm ramlan et al 2010 it is a classical nonlinear stiffness system that provides nonlinear restoring force through a particular configuration of some mechanical component e g springs pneumatic actuators buckling beams or magnets harne 2017 in this scope the traditional linear stiffness mechanism can be considered monostable working with one single potential well the bistable mechanism presents two potential wells two stable equilibria and one unstable equilibrium position zhang et al 2019a b therefore the bistable dynamic behavior may exhibit two main characteristic patterns of motion intra well oscillations within one of its potential wells low energy orbit and inter well oscillations between its two potential wells high energy orbit the latter pattern is preferred for energy harvesting as it features a larger displacement amplitude leading to possible higher energy captures zhao et al 2020 zhang et al 2014 2015 have applied the classical two spring bistable mechanism on a pa the authors have developed an extensive analysis and comparison of performance for both regular and irregular waves they succeeded in demonstrating that nonlinear wec would capture relatively more wave energy in a broader range of wave frequency in the same period todalshaug 2015 patented a wec working with negative stiffness mechanisms the device may use either mechanical springs or pneumatic cylinders the pneumatic configuration was then patented under the commercial name of wavespring and installed in the corpower buoy prototype corpower 2021 to validate such an innovative concept wavespring was successfully tested for the 1 16 scale model todalshaug et al 2016 the experimental results have shown that the bistable wec responds quite efficiently if tuned to work close to its resonant frequency exploring the benefits from its much broader response bandwidth in continuation they complemented the prior dry testing and ocean deployment using a 1 2 scale wec to confirm the promising characteristics of the wavespring industrial prototype performance in addition to their bistable mechanism consisting of springs and pneumatic cylinders zhang et al 2019a b proposed a magnetic bistable mechanism composed of two coaxial permanent magnet rings numerical results confirmed its ability to shift the frequency bandwidth to a lower frequency range and increase the power capture efficiency hereafter the aforementioned bistable mechanisms are labeled as the conventional bistable mechanism as a matter of fact compared to the traditional linear stiffness wec in real sea applications the main challenges to be faced by the wec equipped with any performance boosting mechanism would be a increasing capture width ratio at low wave frequencies zhang and yang 2015 b broadening wave energy harvesting frequency bandwidth zhang et al 2018 and c strengthening robustness due to some relevant parameter uncertainties related to both mechanical system and environment for example the wec with a fixed pto damping coefficient needs to maintain good performance in different sea states to cope with the uncertainty of real seas schubert et al 2020 the wec also needs to perform well within a relatively large range of pto damping coefficients considering the pto may not be always working at its optimal condition pto detuning younesian and alam 2017 to better address these challenges xiao et al 2017 studied the performance of a cylindrical point absorber with different bistable potential energy profiles in regular waves by using a magnetic dipole model as the bistable mechanism they concluded that the bistable wec harvest more energy at low frequencies than the linear wec and this advantage becomes more prominent as the stable equilibrium position increases when the energy barrier is surmounted schubert et al 2020 applied the magnetic dipole model to a three degree of freedom submerged point absorber and examined its performance over a range of potential profiles in regular and irregular waves their results showed that bistability may be used to obtain near optimal results for the 3 dof submerged point absorber and was suitably robust to face changes in the ocean conditions several other studies have improved the performance of the conventional bistable mechanisms by incorporating extra new components zhang et al 2018 zhang et al 2019b and song et al 2020 proposed an adaptive bistable mechanism by adopting two additional auxiliary springs that could automatically lower the potential barrier near its unstable equilibrium position the time varying potential behavior helps to avoid low energy absorption which may happen if the conventional bistable wec operates under low wave excitations in addition numerical results in regular and white noise wave conditions show that the adaptive bistable wec leads to a wider frequency bandwidth and pto damping band for the appropriately selected system parameters based on the previous magnetic bistable mechanism as proposed by zhang et al 2019a zhao et al 2020 proposed an improved magnetic bistable mechanism consisting of three pairs of coaxial magnetic rings the main magnetic rings ensure the system is bistable the out and inner magnetic rings for the other two pairs of magnetic rings at the end of the bistable mechanism are arranged in a misaligned configuration in the axis direction which can pull down the potential barrier numerical results in regular waves also have shown that the mechanism improves the power absorption efficiency broadens the frequency bandwidth and pto damping range inspired by the aforementioned works zhang et al 2018 2019a b song et al 2020 zhao et al 2020 the present study explores the nonlinear dynamic behavior of the bistable mechanism and introduces a simple but very effective change of the spring configuration the results demonstrated that such change led to a very significant increase in the bistable wec performance the following text discusses the characteristics of the improved bistable mechanism composed of three specially displayed springs results compare its performance with both linear and conventional bistable counterparts in regular and irregular waves the article structure is organized as follows section 2 presents a brief theoretical review of the bistable dynamics and establishes the improved bistable mathematical model for the wec in section 3 the improved device is evaluated firstly in regular waves to demonstrate its main advantages and explain its internal mechanism the system characteristics are then further revealed through parametric studies in real sea states finally relevant conclusions are drawn in section 4 2 improved bistable pa the mathematical model 2 1 pa general equation of motion by using cummins equation cummins 1962 the heave motion of a spherical pa is given as follows 1 m a z z t 0 t k i t τ z t d τ f r t f w t f p t o t where m 2 3 π r 3 ρ is the buoy physical mass r is the spherical buoy radius ρ is the water density a z is the buoy added mass at infinite wave frequency z t z t and z t are the heave displacement velocity and acceleration at time t respectively k i t is the impulse response function defined in the kernel of the convolution term according to ogilvie 1964 k i t relates to the radiation damping coefficient b z ω 2 k i t 2 π 0 b z ω cos ω t d t the restoring force f r t is composed of two different contributions 3 f r t c w l z t f m t the hydrostatic restoring force c w l z t where c w l ρ g π r 2 is the linear hydrostatic restoring coefficient and the vertical component of the force induced by a given spring arrangement used in the pa wec f m t in the following discussion it could be defined as associated with a conventional bistable or improved bistable mechanism and will be the main focus of the present analysis on the right hand side of eq 1 f w t represents the vertical wave excitation force acting on the spherical buoy in regular waves at any given wave frequency ω and amplitude a the corresponding force at any time t may be expressed as falnes 2002 4 f w t a 2 g 3 ρ b z ω ω 3 sin ω t in irregular waves the vertical wave excitation force may be expressed as a linear superposition of a large finite number n of frequency components from a given sea energy spectrum 5 f w t i 1 n f a i ζ a i sin ω i t ε i ε p i 6 ζ a i 2 s ω i δ ω i where f a i and ε p i are the i th frequency component amplitude and phase shift of the wave excitation force transfer function ζ a i is the i th component of wave amplitude and ε i is the random phase angle between 0 and 2π s ω is the sea spectrum function in the present analysis the results considered the jonswap spectrum dnv rp c205 2010 given by 7 s ω a γ 5 16 h s 2 ω p 4 ω 5 exp 5 4 ω ω p 4 γ exp 1 2 ω ω p σ ω p 2 where a γ 1 0 287 ln γ is the normalizing factor γ is the non dimensional peak shape parameter with average value 3 3 h s is the significant wave height ω p is the peak wave frequency σ is the spectral width parameter for ω ω p σ 0 07 for ω ω p σ 0 09 the jonswap spectrum discretized by n 500 equidistant frequencies ranging from 0 4 ω p to 3 4 ω p was adopted to define the times series representing the irregular wave records the convergence analysis of the generated irregular waves will be considered in section 3 2 by considering a linear damper with damping coefficient c the pto force can be calculated by 8 f p t o t c z t in order to accelerate the computational processing time to solve eq 1 the convolution integral will be solved through the state space model as defined below 9 x a x b z 10 μ c x where x x 1 x 2 x n t is the n th order state vector a b and c are the constant state space matrices calculated through the frequency domain identification method fdi as discussed by pérez and fossen 2008 2009 μ is the convolution term by substituting eqs 9 and 10 into eq 1 the state space model of the complete system is established as 11 x z z a 0 b 0 0 1 c m a z c w l m a z c m a z x z z 0 0 f w f m m a z the capture width ratio reflecting the power capture efficiency of the wave energy converter is defined as falnes 2002 12 ω p m 2 r p w a v e where p m is the average absorbed power 13 p m 1 t 0 t c z t z t d t p wave is the wave energy flux per meter of wave front for regular waves is given by 14 p w a v e r e g u l a r ρ g 2 a 2 4 ω for irregular waves is given by 15 p w a v e i r r e g u l a r ρ g 2 64 π h s 2 t e where t e is the wave energy period h s is the significant wave height the constants ρ g and r are used to define the nondimensional parameters described below 16 a z a z m z z r a a r h s h s 2 r ω ω g r ω p ω p g r t t r g τ τ r g c c m g r b z ω b z ω m ω g r in this study the radius of the spherical buoy is taken as r 5m the hydrodynamic coefficients for the spherical buoy are obtained as discussed by hulme 1982 and given in their non dimensional form in fig 1 the numerical solutions are calculated by applying the fourth order fdi defining the matrices a b and c and the fourth order classical runge kutta method to solve the resultant ordinary differential equations ode expressed by eq 11 2 2 conventional bistable pa the classical two spring bistable mechanism coupled wave energy converter named here as conventional bistable wave energy converter cb wec is illustrated by fig 2 a the spherical buoy is constrained to oscillate in heave motion only and the linear pto is fixed on the seabed the classical bistable mechanism is composed of two springs stiffness k and free length l horizontally placed one end of the springs is connected to a seabed fixed support structure and the other end follows the buoy the horizontal distance between the rigid rod and spring support is l in this case the vertical component of the bistable mechanism force f m is defined by 17 f m 2 k z 1 l z 2 l 2 the mechanism stiffness k m is then obtained from the derivative of the force with respect to the displacement z 18 k m 2 k 1 l l 2 z 2 l 2 3 2 the potential energy of the mechanism u m is given by the integral of the force along the displacement z 19 u m k z 2 l 2 l 2 the normalized parameters of the bistable mechanism are defined as 20 l l l h h l l l r k k c w l u u 0 5 ρ g π r 4 to be able to generate a greater amount of energy output it would be necessary to guarantee a larger separation gap δz between the two potential wells to assure larger pa response amplitudes zhang et al 2019a b zhao et al 2020 to widen up the separation gap it would be necessary either to increase the spring stiffness k or decrease the ratio l however in doing so the potential barrier δu increases at the same time as shown in fig 2 c and d a large potential barrier increases the pa difficulty to escape from the barrier especially if wave excitations are low lan and qin 2017 zhao et al 2020 and reduces the occurrence of inter well oscillation based on such observations and limitations an improvement to the conventional bistable mechanism was introduced in the present study the improved bistable mechanism ib wec introduces an additional spring that could expand the separation gap and increase the potential barrier of the bistable system then by adjusting the vertical distance between the end of the new spring and the original spring to an appropriate range it would be possible to change the shape of the bistable potential energy curve to present a larger separation gap and lower potential barrier than its conventional bistable counterpart 2 3 improved bistable pa the improved bistable mechanism as shown in fig 3 a is composed of three springs with the same physical properties stiffness k and free length l one spring is arranged horizontally and the other two are oblique on a vertical plane the horizontal distance between the rigid rod and spring support is l the same as defined in the conventional bistable mechanism the vertical distance h defines the distance between the two oblique spring ends to understand the kinematics of the proposed mechanism three possible equilibrium positions are schematically illustrated in fig 3 b c and d when the floating buoy stays at its static equilibrium position see fig 3 a the improved bistable mechanism is at the middle unstable equilibrium position fig 3 c at this point the wec has the local maximum potential energy and tends to drop from the local maximum point to the low minimum point any perturbation on the buoy drives the mechanism away from this unstable position ocean waves make the floating buoy oscillate up or downward leading the improved bistable mechanism to reach the upper or lower stable equilibrium position fig 3 b and d where the resultant force generated by the bistable mechanism in the vertical direction balances the hydrostatic restoring force acting on the buoy at these points the wec has the minimum potential energy and tends to trap the wec around them any change around these positions causes the vertical force increment from the mechanism to return the system to these equilibrium positions the vertical force f m stiffness k m and potential energy u m of the improved bistable mechanism are given by 21 f m k z 1 l z 2 l 2 z h 1 l z h 2 l 2 z h 1 l z h 2 l 2 22 k m k 1 l l 2 z 2 l 2 3 2 1 l l 2 z h 2 l 2 3 2 1 l l 2 z h 2 l 2 3 2 23 u m 1 2 k z 2 l 2 l 2 z h 2 l 2 l 2 z h 2 l 2 l 2 the normalization of the above parameters is the same as in eq 20 for better understanding the discussion about the ib wec characteristics will conveniently choose l 0 2 k 0 4 and l 0 5 to emphasize some relevant aspects of its behavior fig 4 a shows the plots of the potential curve of the ib wec with different h it is obvious that if h is equal to zero the wec degenerates into the cb wec by comparing the potential shape of the ib wec and cb wec as shown in fig 1 where δz 0 40 and δu 0 027 the ib wec with h equals zero presents larger stiffness leading to a bistable potential energy shape with relatively wider separation gap δz 0 51 and higher potential barrier δu 0 065 however by adjusting h a larger separation gap could be kept while reducing the potential barrier as shown in fig 4 b when 0 230 h 0 327 the separation gap of the ib wec is larger than the corresponding separation gap of the cb wec δz 0 40 and the potential barrier is smaller than the corresponding potential barrier of the cb wec δu 0 027 the h value of the ib wec used in the following numerical simulations will be chosen from its reasonable range 3 results and discussions this section discusses and compares the performance of a linear wave energy converter ln wec a conventional bistable wave energy converter cb wec and an improved bistable wave energy converter ib wec in regular and irregular waves to generate the comparative results two sets of parameters are selected and listed below representing the cb wec and the ib wec respectively within parentheses are the values of the corresponding separation gap and potential barrier which can be obtained from fig 2 c and d and fig 4 b cb wec l 0 2 k 0 4 and l 0 5 δz 0 40 and δu 0 027 ib wec l 0 2 k 0 4 l 0 5 and h 0 3 δz 0 45 and δu 0 008 3 1 performance in regular waves fig 5 illustrates the power capture width ratio ω for the ln wec in the ω c space domain for the ln wec as the figure shows the maximum capture width ratio ω 0 49 occurs at the resonance frequency ω 1 0 when the pto damping parameter is c 0 25 fig 6 shows the variation of the capture width ratio ω for all three types of wecs ln cb and ib wecs in the wave frequency and wave amplitude space domain here the optimal pto damping of the ln wec c 0 25 was taken to obtain the results for all three wecs it may not be the optimal pto damping for the cb wec and ib wec but it would be a reasonable choice to compare their performance from the results shown in fig 6 a b and c it can be noticed that under large wave amplitudes both cb and ib wec have the ability to shift the resonant frequency to lower values and improve energy capture efficiency if compared with the ln wec however the cb wec presents a very poor performance under low wave amplitude excitations as shown in the region below the white dashed line a 0 09 in fig 6 b in that region the cb wec performs less efficiently than the ln wec and its resonant frequency is shifted to a higher frequency range on the other hand the ib wec performs much better than the ln wec in the entire range of wave amplitudes especially if excited by low amplitude waves the results show that as the wave amplitude increases the peak of the ib wec capture width ratio first approaches the ln wec then achieves its peaks and finally decreases besides the resonant peak frequencies of ib wec are always smaller than the ln wec resonant frequency to help to explain the behavior described above fig 7 a b and c depict the potential energy profile the equivalent stiffness and the equivalent natural frequency of the wecs respectively the wecs equivalent natural frequencies are calculated by 24 ω n c w l k m m a where for the ln wec k m is equal to zero for the cb wec k m is expressed in eq 18 and for the ib wec k m can be obtained from eq 22 to maintain consistency the normalization of the equivalent natural frequency ω n is the same as defined in eq 16 when excited by lower amplitude waves the bistable wec does not have enough energy to cross the potential barrier resulting in the wec being trapped within one of the two potential wells and oscillating around the corresponding stable equilibrium position namely intra well oscillation fig 7 b and c show the equivalent stiffness at the stable equilibrium position of the cb wec is k c b 1 455 and the equivalent natural frequency is ω n c b 1 20 which are both larger than the ln wec k l n 1 0 and ω n l n 1 0 this results in the shifting of the cb wec resonance frequency to higher frequencies as shown in fig 6 b in the region below the white dashed line in that region the local maximum efficiency occurred around ω 1 20 for the ib wec the equivalent stiffness of its stable equilibrium positions is equal to k i b 1 0 and the corresponding equivalent natural frequency is ω n i b 1 0 which is equal to the ln wec the equivalent stiffness around the stable position is also less than that of the cb wec leading the ib wec resonance frequency to start from ω 1 0 and shifts to lower frequencies if excitation increases as shown in the lower region of fig 6 c when the excitation level increased until the bistable wec has sufficient energy to cross the potential barrier the snap through occurs and the wec oscillates between the two potential wells inter well oscillation with high energy output as shown in the low frequency region of fig 6 b and c compared with the cb wec the lower potential barrier see fig 7 a favors the ib wec to start the snap through which greatly improves its capture width ratio and frequency bandwidth under low excitation the larger separation gap ensures a wider low equivalent stiffness or natural frequency than the ln and cb wec see fig 7 b which contributes to the ib wec present a greater frequency shifting ability than the ln and cb wec 3 2 performance in irregular waves 3 2 1 convergence analysis to compare the performance of the three wecs acted by irregular waves the convergence analysis of the simulation time length and number of random waves will be prioritized to ensure the good quality of the results fig 8 a illustrates the variation of capture width ratio solid curves and corresponding standard deviation dashed curves with respect to the simulation time length t for the simulation time length longer than 2000 the standard deviation is less than 1 0 fig 8 b shows the variation of capture width ratio solid curves and corresponding standard deviation dashed curves with respect to the number of random waves the mean capture width ratios have converged well and the standard deviations of the results from 50 waves are all less than 1 0 based on the results from the analysis of convergence the effective simulation time length equals to t 2000 and 50 sets of different random waves were assumed to produce adequate accuracy and affordable computational burden 3 2 2 influence of the pto damping fig 9 a d and g illustrate the ln wec capture width ratio as a function of the peak frequency ω p and pto damping parameter c excited by low energy sea states fig 9 a h s 0 06 moderate sea states fig 9 d h s 0 15 and high energy sea states fig 9 g h s 0 30 respectively as the system is linear the results follow the same pattern for all sea state classes different h s it is worth noting that the maximum capture width ratio of the ln wec in irregular waves decreases from 0 49 to 0 32 compared to the performance in regular waves see fig 5 while the optimal operating conditions move from ω 1 0 and c 0 25 to ω p 0 80 and c 0 64 this indicates that the dynamic regime of the system has changed significantly and a comprehensive study of the performance of these three wecs under irregular waves is necessary for the nonlinear cb wec and ib wec the sea state has a significant effect on their performance and the pto damping effect exhibits different patterns at different significant wave heights fig 9 b and c e and f h and i show the influence of the pto damping on the capture width ratio of the cb and ib wec for low moderate high energy sea states respectively the closed black dashed lines in fig 9 c f h and i depict the regions where the capture width ratio is greater than the maximum value obtained for the ln wec ω 0 32 fig 9 b shows that in low energy sea states the efficiency of the cb wec could be even worse than the ln wec over the entire frequency range however in the case of the ib wec see fig 9 c the resonant frequency range shifts towards lower frequencies and the efficiency well exceeds the maximum efficiency of the ln wec over a wide range of peak wave frequency and pto damping such results show that the ib wec works featuring better efficiency in a much wider and lower frequency bandwidth and stronger robustness to pto damping detuning similar performance can be also observed in moderate sea states see fig 9 d e and f besides the pto damping range of the ib wec in this sea state class see fig 9 f is further expanded if compared with low energy sea state performance see fig 9 c if the sea state rises to a higher energy level see fig 9 g h and i the cb wec efficiency improves within limited wave frequency and pto damping ranges while the ranges of the ib wec are still larger above we have discussed the robustness capability of the three wecs concerning the pto damping detuning by further processing the numerical results the wecs performance will be compared in their respective well tuned conditions the maximum capture width ratios ωmax of the wecs under low moderate high energy sea states are extracted from fig 9 and illustrated in fig 10 a b and c respectively the optimal pto damping c optimal values are shown in fig 10 d e and f in these sub figures the positions corresponding to the same ωmax of the ib wec and ln wec are cross marked and labeled in low energy sea states see fig 10 a the ωmax of the ib wec is greater than the ln wec when the ω p is less than 1 04 t p 4 31s for the ω p higher than 1 04 the efficiency of both optimally tuned wecs is approximately the same in moderate sea states see fig 10 b the ωmax is much higher than the ln wec when ω p is less than 0 84 t p 5 34s when the ω p is larger than 0 84 the efficiency of the optimally tuned ib wec is first slightly lower and then almost equal to the ln wec as frequency increases similar results occur in high energy sea states see fig 10 c the optimally tuned ib wec presents greater efficiency than that of ln wec when the ω p is less than 0 81 t p 5 54s when the ω p is larger than 0 81 the optimally tuned ib wec presents a lower efficiency than the ln wec and then the gap decreases until it overlaps the ln wec as the frequency keeps on increasing besides the optimally tuned cb wec may perform better than the ln and ib wec only in high frequency sea states since most of the ocean energy is concentrated in waves with a period ranging from 5 0s to 15 0s falnes 2002 i e ω p ranging from 0 30 to 0 90 the optimally tuned ib wec with h 0 30 outperforms its optimally tuned linear and conventional bistable counterparts for almost the entire frequency range for moderate sea states h s 0 15 the ln wec can perform better within the narrow frequency range from 0 84 to 0 90 5 00s t p 5 34s in high energy sea states h s 0 30 the ln and cb wec also can perform better within the narrow frequency range from 0 81 to 0 90 5 00s t p 5 54s another interesting phenomenon can be found in the frequency ranges where the well tuned ib wec outperforms the ln wec yellow curve to the left of the cross marked points in fig 10 d e and f only for moderate sea states h s 0 15 with the ω p around 0 84 the optimal pto damping for the ib wec is slightly larger than the ln wec for the rest of the frequency ranges the optimal pto damping of the ib wec is lower than the ln wec especially in the low energy sea states h s 0 06 the optimal pto damping coefficients for the ib wec are much lower than the other two wecs 3 2 3 influence of the sea states fig 11 illustrates the variation of the capture width ratio for each wec type with a fixed pto damping coefficient c 0 64 aiming to analyze their robustness to the sea state uncertainties the black dashed lines indicate the sea states with efficiency greater than the maximum of the ln wec ωmax 0 32 the maximum capture width ratios of the wecs and their corresponding operational conditions are listed in table 1 compared with the ln wec the cb wec exhibits a shifting ability to lower frequencies optimal ω p shifts from 0 80 to 0 53 and an efficiency improvement maximum capture width ratio ωmax increases from 0 32 to 0 45 at moderate and high energy sea states while less efficient in low energy sea states on the other hand the ib wec presents greater frequency shifting ability to the lower frequencies optimal ω p shifts from 0 80 to 0 46 and efficiency enhancement maximum capture width ratio ωmax increases from 0 32 to 0 66 nearly in the entire significant wave height range this means that the ib wec with a fixed pto damping coefficient performs better than the ln wec in a wider peak frequency and significant height ranges indicating a high degree of robustness to face sea state changes such observations were also verified in regular waves see fig 6 the low potential barrier facilitates the occurrence of the snap through improving the efficiency and enlarging frequency bandwidth at low wave excitations the large separation gap corresponding to a wider range of low equivalent stiffness strengthens the frequency shifting ability 3 2 4 influence of the vertical distance between the two oblique spring ends for the ib wec as shown in fig 4 b larger h corresponding to a smaller separation gap δz and lower potential barrier δu and finally the wec tends to be monostable the impact of h is evaluated here by analyzing the performance of the ib wecs with h 0 28 0 30 and 0 32 selected from the reasonable range previously determined in section 2 3 fig 12 illustrates the variation of the capture width ratio for the ib wecs with the selected h in the peak frequency and significant wave height space domain the maximum capture width ratios and corresponding operational conditions for three different ib wecs are listed in table 2 the potential energy profiles are illustrated in fig 13 and the ln and cb wec potential energy curves are also included for the sake of comparison from fig 13 the potential barrier δu decreases from 0 0140 to 0 0026 when h increases from 0 28 to 0 32 by comparing with fig 12 a b and c the maximum efficiency ωmax increases from 0 58 to 0 84 and the corresponding optimal wave frequency ω p shifts from 0 24 to 0 08 at the same time the frequency bandwidth under low wave excitations expands although the separation gap δz of these three ib wecs decreased from 0 47 to 0 42 as h increased it still larger than its conventional bistable counterpart δz 0 40 and the frequency shifting ability are still stronger than the cb wec as shown in fig 11 b in addition the results also show the ib wec performance is sensitive to the parameters of the improved bistable mechanism therefore these parameters require optimization for the specific deployment sea site 4 conclusions the study demonstrated that an improved bistable mechanism composed of three springs can boost the wave energy capture performance of the pa wec the improved bistable mechanism consisting of one horizontal spring and two oblique springs through the proper adjusting of the opening distance of the oblique springs within a certain range can significantly improve the wec performance the dynamic model in the time domain was established based on cummins equations allowing for numerical simulations in regular waves which demonstrated the system capability and explained relevant aspects of its internal mechanism then system characteristics were further revealed through systematic parametric studies under real sea states the main conclusions are drawn and summarized as follows a compared with the cb wec the energy potential profile of the ib wec is characterized by a larger separation gap and lower potential barrier the large separation gap ensures a larger range of the low equivalent stiffness than the cb wec and ln wec contributing to the ib wec stronger frequency shifting ability the low potential barrier favors the ib wec snap through occurrence which greatly improves the capture width ratio and widens the frequency bandwidth under low wave excitations b the ib wec outperforms the ln and cb wec in a broad range of wave frequencies and pto damping coefficients indicating its strong robustness to cope with pto damping detuning c for a fixed pto damping the ib wec outperforms its ln wec counterpart in a large range of sea states and outperforms its cb wec counterpart in low wave excitations this implies that the ib wec presented strong robustness to cope with sea state changes d for the well tuned ln wec cb wec and ib wec in low moderate high sea states the ib wec presented higher efficiency than the others for low frequency waves besides in low frequency sea states the optimal pto damping values required by the ib wec are mostly lower than the ln wec e due to their effects on the potential energy profile the ib wec performance is quite sensitive to the bistable mechanism parameters therefore the ib wec needs to be optimized for each specific deployment sea site it is worth noting that the present study aims at emphasizing the benefits of the improved bistable mechanism on the performance of the wave energy converter future investigations should include the influence of nonlinear hydrodynamics on the ib wec such as the nonlinear restoring force the nonlinear froude krylov and drag forces moreover experimental tests should be considered to validate the numerical modeling simulations credit authorship contribution statement bingqi liu conceptualization methodology validation visualization writing original draft huanggao yi conceptualization visualization writing review editing carlos levi conceptualization writing review editing supervision segen f estefen writing review editing supervision funding acquisition zhijia wu writing review editing software menglan duan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the china scholarship council grant no 201600090258 the national key research and development program of china grant no 2016yfc0303700 and the 111 project b18054 the authors also acknowledge the financial support by the carlos chagas filho foundation faperj brazil grant no e 26 202 600 2019 to the research on ocean renewable energy conducted in the subsea technology lab coppe federal university of rio de janeiro 
20705,as one of the renewable and clean energy sources wave energy has high density and all day availability characteristics however the development of wave energy converters has been hampered mainly because of the low efficiency induced high levelized energy costs the present study introduces an improved bistable mechanism composed of three linear springs aiming to enhance the performance of a point absorber employed as a wave energy converter the improved bistable mechanism features an asymmetric configuration of three linear stiffness springs one horizontal and two obliques on a vertical plane numerical simulations based on cummins equations in the time domain describe the point absorber dynamic behavior in regular and irregular waves the improved bistable wave energy converter featured a wider low equivalent stiffness range than linear and conventional bistable counterparts improving its ability to frequency shifting its lower potential barrier greatly improves the capture width ratio and frequency bandwidth at low excitations such characteristics facilitate the improved bistable wave energy converter to achieve higher efficiency than its linear and conventional bistable counterparts at low frequencies and enhance its robustness against power take off damping detuning and sea state changes these features altogether make the improved bistable mechanism an efficient alternative to explore the benefits of the bistable dynamics applied to wave energy converters keywords wave energy converter point absorber improved bistable mechanism nonlinear stiffness broadband energy harvesting 1 introduction renewable and clean energy sources have been receiving increasing attention to address the growing global demand for energy consumption and reduce greenhouse gas emissions in such a context wave energy benefited from its high energy density and all day availability estimated as high as 146 twh yr edenhofer et al 2011 has emerged as a promising alternative to become a competitive clean renewable energy source since the early 1980s different concepts of wave energy converters wecs have been proposed and tested to find competitive candidates for wave energy harvesting devices czech and bauer 2012 falcão 2010 shadman et al 2019 the mainstream idea behind all concepts prioritizes reducing the levelized cost of energy lcoe and high survivability performance in the case of point absorber pa type of wec it works efficiently only if acted by waves within the very narrow bandwidth close to its resonant frequency as a result the point absorber will extract a large amount of energy only from wave components located within a relatively narrow wave frequency band in the real sea different alternative approaches have been proposed to improve its performance the most obvious and straightforward way is to optimize buoy geometry to resonate in the predominant wave frequency for a specific sea state at a given deployment site goggins and finnegan 2014 shadman et al 2018 but due to the changeable nature of the real sea it still leads to quite limited efficiency gains to push up potential gains of efficiency to more adequate levels different active control strategies such as complex conjugate control maria arenas et al 2019 damping control jin et al 2019 rodríguez et al 2019 latching control falcão 2008 henriques et al 2016 j wu et al 2018 and model predictive control mpc faedo et al 2017 li and belmont 2014 zhan et al 2018 have been proposed and proved to be of some effectiveness however to work properly active control strategies require accurate and in some cases a priori prediction of the wave excitation force acting on the pa wec these requirements impose heavy burdens on its costs and can become a significant obstacle for the implementation of pa active controllers in light of such practical difficulties passive target approaches have alternatively attracted the attention of researchers and much progress has been reported wu et al 2018 2019 z wu et al 2018 younesian and alam 2017 zhang and yang 2015 as one of the possible performance boosting mechanisms the bistable mechanism also known as snap through or nonlinear stiffness mechanism is widely adopted in the vibration energy harvesting realm ramlan et al 2010 it is a classical nonlinear stiffness system that provides nonlinear restoring force through a particular configuration of some mechanical component e g springs pneumatic actuators buckling beams or magnets harne 2017 in this scope the traditional linear stiffness mechanism can be considered monostable working with one single potential well the bistable mechanism presents two potential wells two stable equilibria and one unstable equilibrium position zhang et al 2019a b therefore the bistable dynamic behavior may exhibit two main characteristic patterns of motion intra well oscillations within one of its potential wells low energy orbit and inter well oscillations between its two potential wells high energy orbit the latter pattern is preferred for energy harvesting as it features a larger displacement amplitude leading to possible higher energy captures zhao et al 2020 zhang et al 2014 2015 have applied the classical two spring bistable mechanism on a pa the authors have developed an extensive analysis and comparison of performance for both regular and irregular waves they succeeded in demonstrating that nonlinear wec would capture relatively more wave energy in a broader range of wave frequency in the same period todalshaug 2015 patented a wec working with negative stiffness mechanisms the device may use either mechanical springs or pneumatic cylinders the pneumatic configuration was then patented under the commercial name of wavespring and installed in the corpower buoy prototype corpower 2021 to validate such an innovative concept wavespring was successfully tested for the 1 16 scale model todalshaug et al 2016 the experimental results have shown that the bistable wec responds quite efficiently if tuned to work close to its resonant frequency exploring the benefits from its much broader response bandwidth in continuation they complemented the prior dry testing and ocean deployment using a 1 2 scale wec to confirm the promising characteristics of the wavespring industrial prototype performance in addition to their bistable mechanism consisting of springs and pneumatic cylinders zhang et al 2019a b proposed a magnetic bistable mechanism composed of two coaxial permanent magnet rings numerical results confirmed its ability to shift the frequency bandwidth to a lower frequency range and increase the power capture efficiency hereafter the aforementioned bistable mechanisms are labeled as the conventional bistable mechanism as a matter of fact compared to the traditional linear stiffness wec in real sea applications the main challenges to be faced by the wec equipped with any performance boosting mechanism would be a increasing capture width ratio at low wave frequencies zhang and yang 2015 b broadening wave energy harvesting frequency bandwidth zhang et al 2018 and c strengthening robustness due to some relevant parameter uncertainties related to both mechanical system and environment for example the wec with a fixed pto damping coefficient needs to maintain good performance in different sea states to cope with the uncertainty of real seas schubert et al 2020 the wec also needs to perform well within a relatively large range of pto damping coefficients considering the pto may not be always working at its optimal condition pto detuning younesian and alam 2017 to better address these challenges xiao et al 2017 studied the performance of a cylindrical point absorber with different bistable potential energy profiles in regular waves by using a magnetic dipole model as the bistable mechanism they concluded that the bistable wec harvest more energy at low frequencies than the linear wec and this advantage becomes more prominent as the stable equilibrium position increases when the energy barrier is surmounted schubert et al 2020 applied the magnetic dipole model to a three degree of freedom submerged point absorber and examined its performance over a range of potential profiles in regular and irregular waves their results showed that bistability may be used to obtain near optimal results for the 3 dof submerged point absorber and was suitably robust to face changes in the ocean conditions several other studies have improved the performance of the conventional bistable mechanisms by incorporating extra new components zhang et al 2018 zhang et al 2019b and song et al 2020 proposed an adaptive bistable mechanism by adopting two additional auxiliary springs that could automatically lower the potential barrier near its unstable equilibrium position the time varying potential behavior helps to avoid low energy absorption which may happen if the conventional bistable wec operates under low wave excitations in addition numerical results in regular and white noise wave conditions show that the adaptive bistable wec leads to a wider frequency bandwidth and pto damping band for the appropriately selected system parameters based on the previous magnetic bistable mechanism as proposed by zhang et al 2019a zhao et al 2020 proposed an improved magnetic bistable mechanism consisting of three pairs of coaxial magnetic rings the main magnetic rings ensure the system is bistable the out and inner magnetic rings for the other two pairs of magnetic rings at the end of the bistable mechanism are arranged in a misaligned configuration in the axis direction which can pull down the potential barrier numerical results in regular waves also have shown that the mechanism improves the power absorption efficiency broadens the frequency bandwidth and pto damping range inspired by the aforementioned works zhang et al 2018 2019a b song et al 2020 zhao et al 2020 the present study explores the nonlinear dynamic behavior of the bistable mechanism and introduces a simple but very effective change of the spring configuration the results demonstrated that such change led to a very significant increase in the bistable wec performance the following text discusses the characteristics of the improved bistable mechanism composed of three specially displayed springs results compare its performance with both linear and conventional bistable counterparts in regular and irregular waves the article structure is organized as follows section 2 presents a brief theoretical review of the bistable dynamics and establishes the improved bistable mathematical model for the wec in section 3 the improved device is evaluated firstly in regular waves to demonstrate its main advantages and explain its internal mechanism the system characteristics are then further revealed through parametric studies in real sea states finally relevant conclusions are drawn in section 4 2 improved bistable pa the mathematical model 2 1 pa general equation of motion by using cummins equation cummins 1962 the heave motion of a spherical pa is given as follows 1 m a z z t 0 t k i t τ z t d τ f r t f w t f p t o t where m 2 3 π r 3 ρ is the buoy physical mass r is the spherical buoy radius ρ is the water density a z is the buoy added mass at infinite wave frequency z t z t and z t are the heave displacement velocity and acceleration at time t respectively k i t is the impulse response function defined in the kernel of the convolution term according to ogilvie 1964 k i t relates to the radiation damping coefficient b z ω 2 k i t 2 π 0 b z ω cos ω t d t the restoring force f r t is composed of two different contributions 3 f r t c w l z t f m t the hydrostatic restoring force c w l z t where c w l ρ g π r 2 is the linear hydrostatic restoring coefficient and the vertical component of the force induced by a given spring arrangement used in the pa wec f m t in the following discussion it could be defined as associated with a conventional bistable or improved bistable mechanism and will be the main focus of the present analysis on the right hand side of eq 1 f w t represents the vertical wave excitation force acting on the spherical buoy in regular waves at any given wave frequency ω and amplitude a the corresponding force at any time t may be expressed as falnes 2002 4 f w t a 2 g 3 ρ b z ω ω 3 sin ω t in irregular waves the vertical wave excitation force may be expressed as a linear superposition of a large finite number n of frequency components from a given sea energy spectrum 5 f w t i 1 n f a i ζ a i sin ω i t ε i ε p i 6 ζ a i 2 s ω i δ ω i where f a i and ε p i are the i th frequency component amplitude and phase shift of the wave excitation force transfer function ζ a i is the i th component of wave amplitude and ε i is the random phase angle between 0 and 2π s ω is the sea spectrum function in the present analysis the results considered the jonswap spectrum dnv rp c205 2010 given by 7 s ω a γ 5 16 h s 2 ω p 4 ω 5 exp 5 4 ω ω p 4 γ exp 1 2 ω ω p σ ω p 2 where a γ 1 0 287 ln γ is the normalizing factor γ is the non dimensional peak shape parameter with average value 3 3 h s is the significant wave height ω p is the peak wave frequency σ is the spectral width parameter for ω ω p σ 0 07 for ω ω p σ 0 09 the jonswap spectrum discretized by n 500 equidistant frequencies ranging from 0 4 ω p to 3 4 ω p was adopted to define the times series representing the irregular wave records the convergence analysis of the generated irregular waves will be considered in section 3 2 by considering a linear damper with damping coefficient c the pto force can be calculated by 8 f p t o t c z t in order to accelerate the computational processing time to solve eq 1 the convolution integral will be solved through the state space model as defined below 9 x a x b z 10 μ c x where x x 1 x 2 x n t is the n th order state vector a b and c are the constant state space matrices calculated through the frequency domain identification method fdi as discussed by pérez and fossen 2008 2009 μ is the convolution term by substituting eqs 9 and 10 into eq 1 the state space model of the complete system is established as 11 x z z a 0 b 0 0 1 c m a z c w l m a z c m a z x z z 0 0 f w f m m a z the capture width ratio reflecting the power capture efficiency of the wave energy converter is defined as falnes 2002 12 ω p m 2 r p w a v e where p m is the average absorbed power 13 p m 1 t 0 t c z t z t d t p wave is the wave energy flux per meter of wave front for regular waves is given by 14 p w a v e r e g u l a r ρ g 2 a 2 4 ω for irregular waves is given by 15 p w a v e i r r e g u l a r ρ g 2 64 π h s 2 t e where t e is the wave energy period h s is the significant wave height the constants ρ g and r are used to define the nondimensional parameters described below 16 a z a z m z z r a a r h s h s 2 r ω ω g r ω p ω p g r t t r g τ τ r g c c m g r b z ω b z ω m ω g r in this study the radius of the spherical buoy is taken as r 5m the hydrodynamic coefficients for the spherical buoy are obtained as discussed by hulme 1982 and given in their non dimensional form in fig 1 the numerical solutions are calculated by applying the fourth order fdi defining the matrices a b and c and the fourth order classical runge kutta method to solve the resultant ordinary differential equations ode expressed by eq 11 2 2 conventional bistable pa the classical two spring bistable mechanism coupled wave energy converter named here as conventional bistable wave energy converter cb wec is illustrated by fig 2 a the spherical buoy is constrained to oscillate in heave motion only and the linear pto is fixed on the seabed the classical bistable mechanism is composed of two springs stiffness k and free length l horizontally placed one end of the springs is connected to a seabed fixed support structure and the other end follows the buoy the horizontal distance between the rigid rod and spring support is l in this case the vertical component of the bistable mechanism force f m is defined by 17 f m 2 k z 1 l z 2 l 2 the mechanism stiffness k m is then obtained from the derivative of the force with respect to the displacement z 18 k m 2 k 1 l l 2 z 2 l 2 3 2 the potential energy of the mechanism u m is given by the integral of the force along the displacement z 19 u m k z 2 l 2 l 2 the normalized parameters of the bistable mechanism are defined as 20 l l l h h l l l r k k c w l u u 0 5 ρ g π r 4 to be able to generate a greater amount of energy output it would be necessary to guarantee a larger separation gap δz between the two potential wells to assure larger pa response amplitudes zhang et al 2019a b zhao et al 2020 to widen up the separation gap it would be necessary either to increase the spring stiffness k or decrease the ratio l however in doing so the potential barrier δu increases at the same time as shown in fig 2 c and d a large potential barrier increases the pa difficulty to escape from the barrier especially if wave excitations are low lan and qin 2017 zhao et al 2020 and reduces the occurrence of inter well oscillation based on such observations and limitations an improvement to the conventional bistable mechanism was introduced in the present study the improved bistable mechanism ib wec introduces an additional spring that could expand the separation gap and increase the potential barrier of the bistable system then by adjusting the vertical distance between the end of the new spring and the original spring to an appropriate range it would be possible to change the shape of the bistable potential energy curve to present a larger separation gap and lower potential barrier than its conventional bistable counterpart 2 3 improved bistable pa the improved bistable mechanism as shown in fig 3 a is composed of three springs with the same physical properties stiffness k and free length l one spring is arranged horizontally and the other two are oblique on a vertical plane the horizontal distance between the rigid rod and spring support is l the same as defined in the conventional bistable mechanism the vertical distance h defines the distance between the two oblique spring ends to understand the kinematics of the proposed mechanism three possible equilibrium positions are schematically illustrated in fig 3 b c and d when the floating buoy stays at its static equilibrium position see fig 3 a the improved bistable mechanism is at the middle unstable equilibrium position fig 3 c at this point the wec has the local maximum potential energy and tends to drop from the local maximum point to the low minimum point any perturbation on the buoy drives the mechanism away from this unstable position ocean waves make the floating buoy oscillate up or downward leading the improved bistable mechanism to reach the upper or lower stable equilibrium position fig 3 b and d where the resultant force generated by the bistable mechanism in the vertical direction balances the hydrostatic restoring force acting on the buoy at these points the wec has the minimum potential energy and tends to trap the wec around them any change around these positions causes the vertical force increment from the mechanism to return the system to these equilibrium positions the vertical force f m stiffness k m and potential energy u m of the improved bistable mechanism are given by 21 f m k z 1 l z 2 l 2 z h 1 l z h 2 l 2 z h 1 l z h 2 l 2 22 k m k 1 l l 2 z 2 l 2 3 2 1 l l 2 z h 2 l 2 3 2 1 l l 2 z h 2 l 2 3 2 23 u m 1 2 k z 2 l 2 l 2 z h 2 l 2 l 2 z h 2 l 2 l 2 the normalization of the above parameters is the same as in eq 20 for better understanding the discussion about the ib wec characteristics will conveniently choose l 0 2 k 0 4 and l 0 5 to emphasize some relevant aspects of its behavior fig 4 a shows the plots of the potential curve of the ib wec with different h it is obvious that if h is equal to zero the wec degenerates into the cb wec by comparing the potential shape of the ib wec and cb wec as shown in fig 1 where δz 0 40 and δu 0 027 the ib wec with h equals zero presents larger stiffness leading to a bistable potential energy shape with relatively wider separation gap δz 0 51 and higher potential barrier δu 0 065 however by adjusting h a larger separation gap could be kept while reducing the potential barrier as shown in fig 4 b when 0 230 h 0 327 the separation gap of the ib wec is larger than the corresponding separation gap of the cb wec δz 0 40 and the potential barrier is smaller than the corresponding potential barrier of the cb wec δu 0 027 the h value of the ib wec used in the following numerical simulations will be chosen from its reasonable range 3 results and discussions this section discusses and compares the performance of a linear wave energy converter ln wec a conventional bistable wave energy converter cb wec and an improved bistable wave energy converter ib wec in regular and irregular waves to generate the comparative results two sets of parameters are selected and listed below representing the cb wec and the ib wec respectively within parentheses are the values of the corresponding separation gap and potential barrier which can be obtained from fig 2 c and d and fig 4 b cb wec l 0 2 k 0 4 and l 0 5 δz 0 40 and δu 0 027 ib wec l 0 2 k 0 4 l 0 5 and h 0 3 δz 0 45 and δu 0 008 3 1 performance in regular waves fig 5 illustrates the power capture width ratio ω for the ln wec in the ω c space domain for the ln wec as the figure shows the maximum capture width ratio ω 0 49 occurs at the resonance frequency ω 1 0 when the pto damping parameter is c 0 25 fig 6 shows the variation of the capture width ratio ω for all three types of wecs ln cb and ib wecs in the wave frequency and wave amplitude space domain here the optimal pto damping of the ln wec c 0 25 was taken to obtain the results for all three wecs it may not be the optimal pto damping for the cb wec and ib wec but it would be a reasonable choice to compare their performance from the results shown in fig 6 a b and c it can be noticed that under large wave amplitudes both cb and ib wec have the ability to shift the resonant frequency to lower values and improve energy capture efficiency if compared with the ln wec however the cb wec presents a very poor performance under low wave amplitude excitations as shown in the region below the white dashed line a 0 09 in fig 6 b in that region the cb wec performs less efficiently than the ln wec and its resonant frequency is shifted to a higher frequency range on the other hand the ib wec performs much better than the ln wec in the entire range of wave amplitudes especially if excited by low amplitude waves the results show that as the wave amplitude increases the peak of the ib wec capture width ratio first approaches the ln wec then achieves its peaks and finally decreases besides the resonant peak frequencies of ib wec are always smaller than the ln wec resonant frequency to help to explain the behavior described above fig 7 a b and c depict the potential energy profile the equivalent stiffness and the equivalent natural frequency of the wecs respectively the wecs equivalent natural frequencies are calculated by 24 ω n c w l k m m a where for the ln wec k m is equal to zero for the cb wec k m is expressed in eq 18 and for the ib wec k m can be obtained from eq 22 to maintain consistency the normalization of the equivalent natural frequency ω n is the same as defined in eq 16 when excited by lower amplitude waves the bistable wec does not have enough energy to cross the potential barrier resulting in the wec being trapped within one of the two potential wells and oscillating around the corresponding stable equilibrium position namely intra well oscillation fig 7 b and c show the equivalent stiffness at the stable equilibrium position of the cb wec is k c b 1 455 and the equivalent natural frequency is ω n c b 1 20 which are both larger than the ln wec k l n 1 0 and ω n l n 1 0 this results in the shifting of the cb wec resonance frequency to higher frequencies as shown in fig 6 b in the region below the white dashed line in that region the local maximum efficiency occurred around ω 1 20 for the ib wec the equivalent stiffness of its stable equilibrium positions is equal to k i b 1 0 and the corresponding equivalent natural frequency is ω n i b 1 0 which is equal to the ln wec the equivalent stiffness around the stable position is also less than that of the cb wec leading the ib wec resonance frequency to start from ω 1 0 and shifts to lower frequencies if excitation increases as shown in the lower region of fig 6 c when the excitation level increased until the bistable wec has sufficient energy to cross the potential barrier the snap through occurs and the wec oscillates between the two potential wells inter well oscillation with high energy output as shown in the low frequency region of fig 6 b and c compared with the cb wec the lower potential barrier see fig 7 a favors the ib wec to start the snap through which greatly improves its capture width ratio and frequency bandwidth under low excitation the larger separation gap ensures a wider low equivalent stiffness or natural frequency than the ln and cb wec see fig 7 b which contributes to the ib wec present a greater frequency shifting ability than the ln and cb wec 3 2 performance in irregular waves 3 2 1 convergence analysis to compare the performance of the three wecs acted by irregular waves the convergence analysis of the simulation time length and number of random waves will be prioritized to ensure the good quality of the results fig 8 a illustrates the variation of capture width ratio solid curves and corresponding standard deviation dashed curves with respect to the simulation time length t for the simulation time length longer than 2000 the standard deviation is less than 1 0 fig 8 b shows the variation of capture width ratio solid curves and corresponding standard deviation dashed curves with respect to the number of random waves the mean capture width ratios have converged well and the standard deviations of the results from 50 waves are all less than 1 0 based on the results from the analysis of convergence the effective simulation time length equals to t 2000 and 50 sets of different random waves were assumed to produce adequate accuracy and affordable computational burden 3 2 2 influence of the pto damping fig 9 a d and g illustrate the ln wec capture width ratio as a function of the peak frequency ω p and pto damping parameter c excited by low energy sea states fig 9 a h s 0 06 moderate sea states fig 9 d h s 0 15 and high energy sea states fig 9 g h s 0 30 respectively as the system is linear the results follow the same pattern for all sea state classes different h s it is worth noting that the maximum capture width ratio of the ln wec in irregular waves decreases from 0 49 to 0 32 compared to the performance in regular waves see fig 5 while the optimal operating conditions move from ω 1 0 and c 0 25 to ω p 0 80 and c 0 64 this indicates that the dynamic regime of the system has changed significantly and a comprehensive study of the performance of these three wecs under irregular waves is necessary for the nonlinear cb wec and ib wec the sea state has a significant effect on their performance and the pto damping effect exhibits different patterns at different significant wave heights fig 9 b and c e and f h and i show the influence of the pto damping on the capture width ratio of the cb and ib wec for low moderate high energy sea states respectively the closed black dashed lines in fig 9 c f h and i depict the regions where the capture width ratio is greater than the maximum value obtained for the ln wec ω 0 32 fig 9 b shows that in low energy sea states the efficiency of the cb wec could be even worse than the ln wec over the entire frequency range however in the case of the ib wec see fig 9 c the resonant frequency range shifts towards lower frequencies and the efficiency well exceeds the maximum efficiency of the ln wec over a wide range of peak wave frequency and pto damping such results show that the ib wec works featuring better efficiency in a much wider and lower frequency bandwidth and stronger robustness to pto damping detuning similar performance can be also observed in moderate sea states see fig 9 d e and f besides the pto damping range of the ib wec in this sea state class see fig 9 f is further expanded if compared with low energy sea state performance see fig 9 c if the sea state rises to a higher energy level see fig 9 g h and i the cb wec efficiency improves within limited wave frequency and pto damping ranges while the ranges of the ib wec are still larger above we have discussed the robustness capability of the three wecs concerning the pto damping detuning by further processing the numerical results the wecs performance will be compared in their respective well tuned conditions the maximum capture width ratios ωmax of the wecs under low moderate high energy sea states are extracted from fig 9 and illustrated in fig 10 a b and c respectively the optimal pto damping c optimal values are shown in fig 10 d e and f in these sub figures the positions corresponding to the same ωmax of the ib wec and ln wec are cross marked and labeled in low energy sea states see fig 10 a the ωmax of the ib wec is greater than the ln wec when the ω p is less than 1 04 t p 4 31s for the ω p higher than 1 04 the efficiency of both optimally tuned wecs is approximately the same in moderate sea states see fig 10 b the ωmax is much higher than the ln wec when ω p is less than 0 84 t p 5 34s when the ω p is larger than 0 84 the efficiency of the optimally tuned ib wec is first slightly lower and then almost equal to the ln wec as frequency increases similar results occur in high energy sea states see fig 10 c the optimally tuned ib wec presents greater efficiency than that of ln wec when the ω p is less than 0 81 t p 5 54s when the ω p is larger than 0 81 the optimally tuned ib wec presents a lower efficiency than the ln wec and then the gap decreases until it overlaps the ln wec as the frequency keeps on increasing besides the optimally tuned cb wec may perform better than the ln and ib wec only in high frequency sea states since most of the ocean energy is concentrated in waves with a period ranging from 5 0s to 15 0s falnes 2002 i e ω p ranging from 0 30 to 0 90 the optimally tuned ib wec with h 0 30 outperforms its optimally tuned linear and conventional bistable counterparts for almost the entire frequency range for moderate sea states h s 0 15 the ln wec can perform better within the narrow frequency range from 0 84 to 0 90 5 00s t p 5 34s in high energy sea states h s 0 30 the ln and cb wec also can perform better within the narrow frequency range from 0 81 to 0 90 5 00s t p 5 54s another interesting phenomenon can be found in the frequency ranges where the well tuned ib wec outperforms the ln wec yellow curve to the left of the cross marked points in fig 10 d e and f only for moderate sea states h s 0 15 with the ω p around 0 84 the optimal pto damping for the ib wec is slightly larger than the ln wec for the rest of the frequency ranges the optimal pto damping of the ib wec is lower than the ln wec especially in the low energy sea states h s 0 06 the optimal pto damping coefficients for the ib wec are much lower than the other two wecs 3 2 3 influence of the sea states fig 11 illustrates the variation of the capture width ratio for each wec type with a fixed pto damping coefficient c 0 64 aiming to analyze their robustness to the sea state uncertainties the black dashed lines indicate the sea states with efficiency greater than the maximum of the ln wec ωmax 0 32 the maximum capture width ratios of the wecs and their corresponding operational conditions are listed in table 1 compared with the ln wec the cb wec exhibits a shifting ability to lower frequencies optimal ω p shifts from 0 80 to 0 53 and an efficiency improvement maximum capture width ratio ωmax increases from 0 32 to 0 45 at moderate and high energy sea states while less efficient in low energy sea states on the other hand the ib wec presents greater frequency shifting ability to the lower frequencies optimal ω p shifts from 0 80 to 0 46 and efficiency enhancement maximum capture width ratio ωmax increases from 0 32 to 0 66 nearly in the entire significant wave height range this means that the ib wec with a fixed pto damping coefficient performs better than the ln wec in a wider peak frequency and significant height ranges indicating a high degree of robustness to face sea state changes such observations were also verified in regular waves see fig 6 the low potential barrier facilitates the occurrence of the snap through improving the efficiency and enlarging frequency bandwidth at low wave excitations the large separation gap corresponding to a wider range of low equivalent stiffness strengthens the frequency shifting ability 3 2 4 influence of the vertical distance between the two oblique spring ends for the ib wec as shown in fig 4 b larger h corresponding to a smaller separation gap δz and lower potential barrier δu and finally the wec tends to be monostable the impact of h is evaluated here by analyzing the performance of the ib wecs with h 0 28 0 30 and 0 32 selected from the reasonable range previously determined in section 2 3 fig 12 illustrates the variation of the capture width ratio for the ib wecs with the selected h in the peak frequency and significant wave height space domain the maximum capture width ratios and corresponding operational conditions for three different ib wecs are listed in table 2 the potential energy profiles are illustrated in fig 13 and the ln and cb wec potential energy curves are also included for the sake of comparison from fig 13 the potential barrier δu decreases from 0 0140 to 0 0026 when h increases from 0 28 to 0 32 by comparing with fig 12 a b and c the maximum efficiency ωmax increases from 0 58 to 0 84 and the corresponding optimal wave frequency ω p shifts from 0 24 to 0 08 at the same time the frequency bandwidth under low wave excitations expands although the separation gap δz of these three ib wecs decreased from 0 47 to 0 42 as h increased it still larger than its conventional bistable counterpart δz 0 40 and the frequency shifting ability are still stronger than the cb wec as shown in fig 11 b in addition the results also show the ib wec performance is sensitive to the parameters of the improved bistable mechanism therefore these parameters require optimization for the specific deployment sea site 4 conclusions the study demonstrated that an improved bistable mechanism composed of three springs can boost the wave energy capture performance of the pa wec the improved bistable mechanism consisting of one horizontal spring and two oblique springs through the proper adjusting of the opening distance of the oblique springs within a certain range can significantly improve the wec performance the dynamic model in the time domain was established based on cummins equations allowing for numerical simulations in regular waves which demonstrated the system capability and explained relevant aspects of its internal mechanism then system characteristics were further revealed through systematic parametric studies under real sea states the main conclusions are drawn and summarized as follows a compared with the cb wec the energy potential profile of the ib wec is characterized by a larger separation gap and lower potential barrier the large separation gap ensures a larger range of the low equivalent stiffness than the cb wec and ln wec contributing to the ib wec stronger frequency shifting ability the low potential barrier favors the ib wec snap through occurrence which greatly improves the capture width ratio and widens the frequency bandwidth under low wave excitations b the ib wec outperforms the ln and cb wec in a broad range of wave frequencies and pto damping coefficients indicating its strong robustness to cope with pto damping detuning c for a fixed pto damping the ib wec outperforms its ln wec counterpart in a large range of sea states and outperforms its cb wec counterpart in low wave excitations this implies that the ib wec presented strong robustness to cope with sea state changes d for the well tuned ln wec cb wec and ib wec in low moderate high sea states the ib wec presented higher efficiency than the others for low frequency waves besides in low frequency sea states the optimal pto damping values required by the ib wec are mostly lower than the ln wec e due to their effects on the potential energy profile the ib wec performance is quite sensitive to the bistable mechanism parameters therefore the ib wec needs to be optimized for each specific deployment sea site it is worth noting that the present study aims at emphasizing the benefits of the improved bistable mechanism on the performance of the wave energy converter future investigations should include the influence of nonlinear hydrodynamics on the ib wec such as the nonlinear restoring force the nonlinear froude krylov and drag forces moreover experimental tests should be considered to validate the numerical modeling simulations credit authorship contribution statement bingqi liu conceptualization methodology validation visualization writing original draft huanggao yi conceptualization visualization writing review editing carlos levi conceptualization writing review editing supervision segen f estefen writing review editing supervision funding acquisition zhijia wu writing review editing software menglan duan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the china scholarship council grant no 201600090258 the national key research and development program of china grant no 2016yfc0303700 and the 111 project b18054 the authors also acknowledge the financial support by the carlos chagas filho foundation faperj brazil grant no e 26 202 600 2019 to the research on ocean renewable energy conducted in the subsea technology lab coppe federal university of rio de janeiro 
20706,the situational awareness in intersection waterways should be improved given the numerous accidents occurring in these areas we propose a deep learning model for predicting the sailing intent in the intersection waterway because ship ship collisions in such areas mainly occur by incorrectly interpreting the intents of other vessels we model the continuous motions of vessels before entering an intersection and estimate the most likely intent of the vessel given early observations from a statistical analysis of observed motions we found that vessel motion tends to be highly related to past trajectories over long periods therefore we introduce a recurrent neural network architecture the accumulated long short term memory alstm which overcomes the limitations of the conventional lstm by adopting skip connections and an adaptive memory module using these two extensions the present memory cell interacts with historical data to store and use relevant memory details even after long periods furthermore the strong generalization ability of the proposed accumulated lstm enables a high level representation of the uncertain and diverse motions of individual vessels thus contributing to relate various ship motion patterns and intents for validation the proposed model is trained and tested in a naturalistic data set with exemplary results in addition we compare the proposed accumulated lstm with the conventional lstm and a hidden markov model experimental results demonstrate the improved performance of the proposed accumulated lstm in terms of accuracy and real time response keywords maritime safety intent prediction motion pattern accumulated long short term memory 1 introduction maritime safety has experienced rapid developments due to improvements in sensing and computation technologies although various techniques for preventing collisions have been developed zhen et al 2017 gil et al 2020 according to a survey by the international maritime organization more than 40 of shipwrecks worldwide occur due to ship ship collisions tu et al 2018 the consequences of shipwrecks can be devastating in terms of human and economic losses as well as damage to the marine environment wan and chen 2018 a particularly challenging task in vessel navigation is to safely negotiate a waterway intersection given the frequent interactions and trajectory conflicts between vessels cheng et al 2019 the shanghai maritime administration has reported that 47 37 of ship collisions are intersection related shanghai maritime court of prc 2018 these accidents mainly occur due to the ship crew inability to correctly identify or predict the motion intents of other vessels sailing in the intersection waterway in intersections the origins and destinations of the vessels are more dispersive than those during sea going and inland shipping thus hindering the estimation of the intents of vessels misjudging or misunderstanding the intents often leads to close encounter maneuvers between vessels increasing the risk of collision or leading to near collisions the collision between vessels sanshui 805 and zhesanyu 00046 in 2019 in the yangtze river estuary represents a typical case of collision in the busiest intersection waterway in china the official report indicates that the intent of sanshui 805 to keep a straight route along the current channel was wrongly judged as turning to the north channel impeding zhesanyu 00046 to timely execute avoidance maneuvers although intent prediction has been increasingly studied in road safety lee et al 2020 research on intent prediction of vessels for maritime safety is scarce existing research on driving intent prediction of ground vehicles can provide valuable guidelines to study vessel sailing prediction despite not being directly applicable to vessels for instance a vessel can travel in a relatively wide area without road restrictions in addition no fixed lane exists to separate vessels with different intended maneuvers increasing the uncertainty in vessel trajectories and obscuring the sailing intent moreover the motion of vessels is considerably affected by both environmental conditions e g wind waves and currents and surrounding vessels in a waterway shu et al 2017 thus vessels may express different motion patterns even if they follow the same route further increasing the complexity of intent prediction most importantly a vessel cannot perform maneuvers such as an abrupt stop turn or reverse unlike ground vehicles huang et al 2020 furthermore a vessel needs more time and space to transit from one motion state to another consequently intent prediction methods for ground vehicles fail to correctly describe the long range motion of vessels to solve tasks involving temporal dependencies memory mechanisms such as recurrent neural networks and long short term memory lstm network are applied in many engineering fields song et al 2020 proposed an oil production forecasting model wherein the lstm neural network helps capture the dependencies of the oil rate time sequence data and incorporate the production constraints fjetland et al 2019 proposed a kick detection model during the offshore drilling operation these models maximize the rnn to quantify the subtle patterns in time dependent time series however beyond a given period recurrent neural networks and lstm lose efficiency in learning high level representations and capturing long term dependencies wang et al 2018 nevertheless long term dependencies allow to process non stationary and uncertain sequential data such as vessel trajectories therefore we aimed to represent long term dependencies by devising a novel lstm architecture called accumulated lstm alstm alstm selectively accumulates historical motion information via a novel gate to control the interaction between the present memory state and historical information thus this architecture can maintain and process motion information over a long period even when the motions are not relevant to the immediate present to the best of our knowledge this is the first method to predict the sailing intent of vessels the main contributions of this work are threefold 1 through a statistical analysis of naturalistic trajectory data we identified long term dependencies in vessel motions considering long term historical trajectory data instead of instantaneous data improves the intent prediction robustness thus we developed the novel alstm architecture to overcome the shortcomings of the conventional lstm by capturing long term patterns introducing skip connections and a review gate the skip connections allow the present memory cell to adaptively interact with historical motions from distant periods and the review gate controls the relevant type and extent of memory to use with these two features the stored memory is recalled effectively even after long periods making the proposed model more reasonable in understanding and predicting the potential intents 2 vessels in the intersection waterway may be influenced by environmental conditions and surrounding interactions consequently the vessels may exhibit substantial uncertainty and diversity in their motion patterns even when following the same path which makes the latent intent more obscure by leveraging a recurrent neural network architecture we generalize inconsistent motions by high level representations extracted from raw trajectory data then we analyze and uncover the intent of individual vessels 3 we discuss the impact of different length of early observation on the accuracy of the model the results show that the model achieves high accuracy before entering the precautionary area the corresponding prediction represents a decision basis for ship crews to avoid collisions at different distances from the precautionary area thus the proposed model can provide practical significance for maritime safety and management in intersection waterway 2 related work recently researchers were devoted to developing navigational assistance systems for enhancing situational awareness riveiro m et al 2018 reviewed the state of the art method carried out for the analysis of maritime data for situational awareness baksh et al 2018 proposed a marine transportation risk assessment model by considering different operational and environmental factors that affect shipping operations islam et al 2018 designed a human error probability model which introduced the bayesian network to model the interdependency between performance affecting factors and the seafarers actions misjudging or misunderstanding the intents by humans often results in the close quarters situation increasing the risk of collision or leading to near collisions the correct judgment and prediction of the sailing intents of surrounding vessels are more conducive to enhance the situation perception of navigational assistance systems the intent prediction has been a research hotspot in robotics given its importance to develop autonomous robots that interact with other agents for performing tasks koppula and saxena 2016 proposed a conditional random field model to predict the next action of a user by implementing this model a robot can plan the corresponding response in land transportation the advanced driver assistance system improves the safety and interpretation of driving situations hagl et al 2020 by predicting the motion intent before a maneuver is performed dangerous situations in the relevant traffic region can be identified early xing et al 2020 then drivers and operators can take corresponding actions to mitigate risks although intent prediction is increasingly applied in autonomous robots and ground vehicles its use in waterway traffic has been mostly neglected considering the similarities between vessels and ground vehicles studies on intent prediction of vehicles can provide valuable insights about the intent prediction of vessels pioneering works in driving intent prediction have been focused on dynamical motion models in these models the steering wheel angle and velocity are often considered as directly measurable vehicle parameters schmidt et al 2014 propose a mathematical model of the steering wheel angle to predict lane change intents but the model considers very short term when the intention is correctly detected the corresponding maneuver may already have been performed liebner et al 2013 regard the velocity profile as the indicator of driving intention however speed can vary by several reasons such as car following lane changing and ramp entrance in practice the performance of dynamical motion models based on velocity is not satisfactory and needs further improvement to predict the motion and trajectory of vessels several dynamical motion models have been proposed xiao et al 2020 provide an overview of the recent effort on maritime traffic pattern extraction and the progress on vessels motion perdition for situation awareness best and norton 1997 derive a mathematical formulation for trajectory prediction considering directional accelerations li and jilkov 2003 propose a motion prediction model considering the ship geometry and size these dynamical motion models assume that vehicles or vessels exhibit steady dynamics such as constant velocity or constant acceleration hu et al 2020 however vessels may change their motion dynamics and exhibit uncertain behaviors due to various factors e g waterway environment surrounding vessels goerlandt and montewka 2015 consequently unrealistic assumptions of dynamical motion models hinder the accurate intent prediction of vessels recent studies on big data have used historical information to obtain learning based models which can determine the motion patterns from past observations and predict the motion intent dou et al 2016 combine a support vector machine and an artificial neural network to distinguish intents of lane changing and lane keeping their classifier includes seven inputs that represent instantaneous driving situations however turning or lane changing is a time varying and continuous process gadepally et al 2014 consider historical continuous motions for intent prediction to propose a framework based on a hidden markov model hmm to relate observed continuous motions and the intents that derive in these motions li et al 2016 divide a trace into several segments and build corresponding hmms then the hmm outputs are weighted by bayesian filtering to improve intent prediction however hmms follow the first order markov property and thus assume that the current motion is only related to the immediately preceding motion state this property is unsuitable for vessels which take longer than ground vehicles to transit from one motion state to another hence vessel motion exhibits long term dependencies that cannot be captured by hmms recently deep recurrent neural networks have been used to consider time dependencies nguyen et al 2019 xie et al 2019 use an lstm architecture and a deep belief network to model lane changing and its decision respectively by analyzing and identifying the influence of various factors on intents xing et al 2020 propose an ensemble learning framework to predict lane changing intention inspired by the bagging technique they integrate several lstm networks to improve the prediction accuracy and generalization performance although lstm accurately predicts the intent of ground vehicles effectively capturing the long term dependencies of vessel motions remains challenging owing to the heavy masses and large inertias it requires longer times for vessels to change their motion state li et al 2012 which provides a strong correlation between previous and current motions thus it is reasonable to utilize a series of historical motion data rather than the instantaneous data to improve the accuracy and robustness of the intent prediction model however in lstm the memory cell responds strongly to nearby and on going short term motions but neglects past data resulting in the loss of long term information yang et al 2019 this limitation motivates us to explore an improved network for capturing temporal dependencies over a long term thus we extend the conventional lstm into alstm by introducing a novel control gate that maintains and can recall long term memories 3 problem formulation and motion data analysis 3 1 problem formulation we focus on sailing intent prediction of vessels in intersection waterway in these areas the origins and destinations of vessels are more disperse than in one or two way channels vessels in the intersections often interact with others coming from different origins wu et al 2018 unclear or inaccurate judgment of the sailing intent may result in emergency situations or increase trajectory conflicts therefore accurate intent prediction of vessels coming from different directions becomes extremely important timely intent prediction allows to avoid potential collisions and improve scheduling thus improving the overall navigation safety and efficiency of intersection waterway transit nevertheless waterways do not have a structured infrastructure e g traffic signals turning lanes to guide and restrict vessel motion thus vessels may exhibit diverse motion dynamics when transiting intersections substantially hindering intent prediction we collected a naturalistic trajectory dataset of vessels transiting an intersection waterway trajectory dataset d was obtained from an automatic identification system in the south channel of the yangtze river estuary area shown in fig 1 a the dataset is represented by d t r a i d 1 t r a i d 2 t r a i d m where trajectory t r a i d i represents a time series composed of trace points over time t r a i d i p i d t 0 p i d t 0 δ t p i d t 0 n δ t each trace point p i d i t s contains the observed latitude longitude velocity course over ground cog and heading at time t s the descriptor for p i d i t s is constructed as follows 1 p i d i t s x l a t i t u d e y l o n g i t u d e v v e l o c i t y φ c o g θ h e a d i n g there are some noises in ais data such as missing data messy codes and outlier data and so on before feeding the intent prediction model we have cleaned the raw ais data to form the trajectory data t r a i d i to decrease these errors in the ais data a statistical data cleaning method is employed assuming that these parameters are normally distributed the distribution can be identified by the mean and the variance calculated from the samples according to the 3σ rule the outlier points in the trajectories can be eliminated and replaced with blank placeholders to fill the blank placeholders and missing data at different time points the hermitian cubic interpolation was employed through this method the varying frequency data can be transformed as equal frequency data in which the frequency is 1 hz fig 1 b shows naturalistic vessel trajectories in the intersection waterway the collected trajectories include regions o west to p we can only observe the vessel trajectory before entering region p the intent of vessels in the study area can be divided into three classes 2 i n t 0 w e s t t o e a s t 1 w e s t t o n o r t h 2 w e s t t o s o u t h we aim to predict intent estimate i n t ˆ given early observation trajectory t r a i d i 3 2 motion data analysis we statistically analyzed the distribution and time dependencies of ship trajectory data considering the velocity and cog as the most representative features of vessel motion huang et al 2020 the velocity is the distance traveled per unit time of the vessels cog indicates changes in direction while the vessel adjusts its route we assume that the velocity and cog of a vessel usually exhibit different distributions according to the intent to verify this assumption we used kernel density estimation li et al 2018 to determine the data distributions of velocity v and cog φ for different intents specifically we divided the trajectory data into three sets x 0 x 1 x 2 according to the intent where x i v 1 φ 1 v 2 φ 2 v j φ j the continuous joint density function f ˆ h v φ for each set can be calculated using kernel density estimation as follows 3 f ˆ h v φ 1 n j 1 n 1 h k v v j φ φ j h where h is the bandwidth and k is the kernel function which we set to a gaussian kernel fig 2 shows the joint probability distribution of v and φ according to the intent the joint probability distributions of v and φ in fig 2 differ according to the intent hence the sailing intents of vessels exhibit different behaviors before entering the intersection and features v and φ may have the potential to distinguish the intents however the three distributions have overlapping regions especially around v 12 n m i l e h and φ 110 that means it is difficult to directly distinguish the intent only by the data distribution of v and φ the statistical analysis above only considers vessel motion at discrete points however the vessel motion tends to be highly related to past motions thus more reasonable and reliable intent prediction should consider continuous ship motions trajectory data represent a time series with abundant information of continuous motions and long term dependencies exist in ship motion cheng et al 2019 in this part the autocorrelation function acf is adopted to quantify the temporal dependencies for both velocity v t and cog φ t respectively for each sample t r a i d and a given time lag δ t the autocorrelation function of velocity is defined as 4 a c f i d v δ t g v t 0 v t 1 v t n v t 0 δ t v t 1 δ t v t n δ t where g denotes the pearson correlation coefficient of its argument likewise the autocorrelation function of cog is defined as 5 a c f i d φ δ t g φ t 0 φ t 1 φ t n φ t 0 δ t φ t 1 δ t φ t n δ t we set lag time δ t in 50 550 s with increments of 50 s to evaluate the autocorrelation function fig 3 shows the autocorrelation coefficients of all the trajectories as boxplots a strong autocorrelation occurs in the most of time lags even at 550 s the average autocorrelation coefficient remains above 0 6 in addition the variance of the autocorrelation coefficient increases with lag time δ t suggesting the long term relevance of ship motions for the overall trajectories but the consistency reduces for individual trajectories these motion characteristics motivated us to design a novel learning based intent prediction method that adaptively captures long term dependencies of ship motions for improved performance as detailed in section 4 4 alstm architecture for intent prediction this section first presents the overall framework for predicting the sailing intent of vessels we then describe the proposed alstm architecture which extends the conventional lstm to capture the long term dependencies in motion patterns finally the loss function and the parameter optimization strategy are discussed for intent prediction task 4 1 framework for intent prediction of vessels we achieve intent prediction of vessels based on the model depicted in fig 4 the model involves training and testing phases during training the model learns the complete motion data before a vessel reaches the precautionary area the network parameters are updated and trained offline testing is executed before the vessel approaching the precautionary area unlike training the inputs during testing phase are early motion observations testing provides the probability of each intent class and proceeds until the vessel arrives to the precautionary area establishing an online prediction process thus the vessel intent can be identified as the most likely class obtained from the available motion data the inputs of the model are different for training and testing in addition given the different vessel speeds and inconsistent frequency of the automatic identification system broadcast the corresponding input t r a i d i is a variable length sequence for instance slow vessels take longer to complete a given journey resulting in more samples per motion sequence therefore the model should handle variable length sequences in text classification the recurrent neural network suitably handles variable length inputs camero et al 2020 ma et al 2018 this network consists of a memory cell per time step and each cell may take the input from a cell of a previous time and new observations in the proposed model we adopt a padding technique for trajectory t r a i d i to be properly represented when it is shorter than the maximum length for motion sequences a short sequence is zero padded for its length to reach the preset maximum this architecture is implemented through functions dynamic rnn and sequence length in the tensorflow library however if the number of padded zeros is very large the effective memory i e non zero values retained in the lstm cells is limited and valuable ship motion information may be forgotten over a long term from the data analysis in section 3 3 we found that ship motions exhibit long term dependencies but the conventional lstm cell fails to effectively capture these dependencies in fact the three gates in lstm tend to respond strongly to short term motions easily interrupting long term information flows wang et al 2018 to address this limitation we propose the alstm architecture 4 2 alstm architecture the proposed intent prediction model relies on learning long term dependencies of vessel motions we aim to leverage the recurrent neural network in a novel architecture and extends the conventional lstm to express these dependencies fig 5 illustrates the proposed alstm network in which the skip connections and review gates extend the conventional lstm the black arrows represent the memory transition from lstm and the red arrows represent the added memory flow in alstm there are three inputs xt motion data point p i d i t s from t r a i d i at time t h t 1 the motion hidden states from the previous time step c t 1 the motion memory states from the previous time step we improve the lstm transition function of the memory cells by proposing a new memory review mechanism 6 f t σ w f h t 1 x t b f i t σ w i h t 1 x t b i r t σ w r h t 1 x t b r c t f t c t 1 i t tanh w h t 1 c x t b c o t w o h t 1 x t b o h t o t tanh c t r t tanh c t 1 where σ denotes the sigmoid function denotes the hadamard product x t is the input trace point p i d i t s h t is the output of the alstm network representing the motion state at time t and f t i t and o t represent the forget input and output gates respectively the three gate functions are the same as those of the conventional lstm to remember representative information obtained from historical ship motions and ignore irrelevant data in section 3 we demonstrate the long term dependencies of ship motions established that the conventional lstm fails to effectively capture such dependencies to overcome this limitation we extend the lstm by adding skip connections and a review gate unlike the conventional lstm two terms are involved to compute high level representations of motion state h t in the proposed alstm the first term o t tanh c t encodes the present vessel motions where c t is the current motion memory cell this term can immediately capture short term changes in the conventional lstm the calculation of h t only involves this first term o t tanh c t the present motion state h t can only interact with c t which further emphasizes short term motions however some valuable information may be forgotten especially as f t approaches 0 therefore we introduce a second term in the memory transition function to model long term dependencies of vessel motions as eq zhen et al 2017 stated the second term r t tanh c t 1 represents a skip connection from the previous motion memory cell the review gate function r t is implemented as an attentive module to quantify the interaction between the present motion state and the historical memory cell a set of parameterized gates r t are treated as memory access instructions that control the type and extent of access to memory similar to the original gate r t is learnable and can adaptively filter the valuable past information through a supervised approach the aforementioned terms are respectively used to model short term and long term dependencies 4 3 loss function and parameter optimization we input all variables in t r a i d i regarding the motion data on the study area using the proposed alstm architecture output i ˆ n t is the estimate of the three intents described by eq lee et al 2020 with the mean squared error mse being the loss function for the alstm based intent prediction model 7 l o s s m s e 1 k int i ˆ n t 2 where k is the number of trajectories in the mini batch and int and i ˆ n t are the ground truth and predicted intents respectively model training aims to obtain the optimal parameter set θ such that loss can be minimized 8 min θ ω l o s s θ where θ is the solution space of w b we use error backpropagation to train and update parameter set θ of alstm as we include term r t tanh c t 1 to calculate h t the loss gradient of h t changes compared with the conventional lstm the error transmitted at h t is l h t which can be obtained from the mse like in the conventional lstm as h t o t tanh c t r t tanh c t 1 the loss gradient to r t is given by 9 l r t l h t h t r t l h t tanh c t 1 considering the output gate w o and b o in traditional lstm as an example the gradient is given by 10 l w o l o t o t w t l h t tanh c t h t 1 x t t 11 l b o l o t o t b o l h t tanh c t 1 eqs song et al 2020 and fjetland et al 2019 show that the parameter of output gate tends to interact with the vessel motion current cell if the f t approaches 0 parameter update would neglect the past motion information of vessels to some extent for review gate w r and b r the gradient is given by 12 l w r l r t r t w r l h t tanh c t 1 h t 1 x t t 13 l b r l r t r t b r l h t tanh c t 1 1 eqs wang et al 2019 and riveiro et al 2018 show that the vessel past motion cell c t 1 also contributes to parameter update during error backpropagation this mechanism allows the consideration of short term and long term information directly and adaptively 5 experiments and results we conducted experiments to evaluate the proposed model for intent prediction of vessels in the intersection waterway for comparison we replaced the alstm network with an hmm and the conventional lstm the results validate the effectiveness of the proposed alstm and provide insights on intent prediction of vessels 5 1 dataset and network parameters the trajectory training and test data were collected from july to august 2018 at the south channel of the yangtze river estuary this region covers longitudes 122 457 122 594 e and latitudes 31 41 30 943 n as shown in fig 1 the restricted channel crossing routes and dense traffic flow render the study area a highly sophisticated intersection waterway after data preprocessing and sampling the resulting trajectory dataset comprises 5011 records these trajectory data are divided into training and test datasets containing 70 and 30 of the records respectively as detailed in table 1 the parameters of the alstm network are listed in table 2 the input size is 300 100 6 where 300 is the batch size 100 is the max sequence length and 6 is the number of features the learning rate was adjusted by the adam optimizer according to the convergence speed during the iterative process both the lstm and alstm models were trained with similar parameters for a fair comparison such that the performance gain was attributable to the two proposed improvements rather than to parameter optimization in addition the hmm for comparison was set as detailed in gadepally et al 2014 in which the hmm was originally designed for predicting the turning intention of a ground vehicle 5 2 model evaluation we conducted numerical experiments on the hmm lstm and alstm models to predict the intent class of the 1502 test trajectories the testing process per trajectory was divided into the following three steps fig 6 1 trajectory segmentation the area 0 2 375 km from the precautionary area was divided into 20 trajectory segments with each segment being 0 125 km in length 2 generating early observations we checked whether the currently observed trajectory reached the precautionary area to either terminate the iterative process upon reaching or add a trajectory segment to generate new observed sequences and go to step 3 otherwise 3 predicting intent class the observed sequences were input to the hmm lstm and alstm models and the predicted intent label and probability of each intent class were determined return to step 2 to quantitatively evaluate the prediction performance of the three models we used the accuracy and mse as measures 12 m s e 1 m i 1 m i n t ˆ i int i 2 where m is the number of test set samples i n t is the ground truth intent and i n t ˆ is the estimated intent a smaller mse indicates a higher prediction performance fig 7 shows the accuracy of the three models according to the distance to the precautionary area the bars represent the mean accuracy values over 10 tests and the lines show the trends of mean accuracy the shaded areas around the lines indicate the standard deviation of the accuracy with narrower areas indicating more stability of the corresponding model when the vessel arrives at the precautionary area d 0 km the accuracy values of the alstm lstm models and hmm are 86 2 81 4 and 61 2 respectively indicating the higher performance of the proposed alstm intent prediction model in addition intent prediction should provide meaningful results as early as possible although the hmm achieves the highest prediction accuracy far from the precautionary area d 2 375 1 0 km its accuracy converges to a low value as the distance reduces hence the hmm has limited ability to process long sequences in contrast as the length of the observed sequences increases the accuracy of the proposed alstm model improves therefore the alstm intent prediction model captures long term dependencies of motion data providing a higher prediction performance fig 8 shows the mse of the three models according to the distance to the precautionary area the proposed alstm model has the highest mse far from the precautionary area 2 375 1 75 km reaching 0 7 at 2 375 km between 1 875 and 0 875 km from the precautionary area the mse of the lstm model begins to exceed that of the alstm model and the hmm shows the highest mse closer to the precautionary area overall figs 7 and 8 demonstrate the effectiveness of the alstm for modeling long term motion of vessels and providing accurate intent predictions the mean and variance of the accuracy and mse at different distances to the precautionary area are listed in table 3 we also adopted the receiver operating characteristic roc curves to measure the performance of the intent prediction models based on the ground truth intent the x and y axes of the roc curve indicate the true and false positive rates respectively given by 13 t p r t p t p f n 14 f p r f p f p t n for an intent class tp represents the number of samples correctly identified and fn is the number incorrectly classified samples belonging to the class a higher tpr value indicates a better model performance fp is the number of other intent samples being wrongly detected as belonging to the class and tn is the number of other intent samples correctly identified a smaller fpr value indicates a better model performance the roc curve should be located in the top left region of the plot to indicate a high performance we also consider the area under the roc curve as a performance measure the roc curve generally measures the accuracy of binary classification but we extend it to measure the accuracy of a multi classification model for instance when the samples with west to east intent are regarded as positive samples the others are regarded as negative samples thus the probability of a positive sample is p p w e and the probability of a negative sample is p p w n p w s fig 9 a f show the roc curves for the three models and intent classes each test considered two different distances to the precautionary area 0 and 0 25 km the proposed alstm model outperforms the lstm model and hmm for instance in fig 9 a the alstm model has a roughly 34 and 3 higher area under the roc curve than the hmm and lstm model for d 0 km respectively the insets in each graph of fig 9 show the areas around a false positive rate of 0 2 for instance in fig 9 a the alstm model has a roughly 5 higher true positive rate than the hmm for d 0 km therefore the proposed alstm model provides the highest true positive rate at a given false positive rate as the distance to the precautionary area increases to 0 25 km the area under the roc curve of the alstm model declines by 2 3 this is an expected result because an early prediction is more challenging than a late one the ability to accurately predict intent at a large distance to the precautionary area would be valuable to provide an early warning to vessel crews 5 3 case study vessels sailing in the south channel of yangtze river estuary can exhibit a wide range of motion dynamics when passing through the intersection waterway it is difficult for ship crews to visually identify the intent of surrounding vessels especially according to early observations therefore an automatic online model for intent prediction of vessels during navigation would improve navigation in the experiments reported in section 5 2 we evaluated the overall performance of the proposed alstm intent prediction model to further analyze the proposed alstm we evaluated the corresponding model as well as the lstm model and hmm for six cases the six cases were selected from the test datasets and their characteristics are listed in table 4 the cases were divided into three groups according to the corresponding intent with each group containing two cases fig 10 shows the intent prediction results of two vessels with west north sailing intent as the vessels approach the precautionary area fig 10 a and b the trajectory becomes longer based on this increasing number of observations the proposed model continuously updates the intent prediction the proposed alstm model detects the correct intention earlier than the lstm model and the hmm fails to correctly identify the intent even when the vessels are near the precautionary area fig 10 c and d show the probability distributions of the recognition results from the proposed alstm and comparison models the last layer of the alstm network is a softmax layer that can convert the output neuron variables into the probabilities of the three intents then the intent class with the highest probability is taken as the estimate in fig 10 c and d longer the color bars indicate higher probability and the sum of probabilities is 1 i e i 1 3 p in t ˆ i 1 for short observation sequences the probability of correct intention west to north is relatively small as more observations are available the probability of correct intent prediction increases thus the prediction accuracy increases while approaching the precautionary area as longer observation sequences improve the performance of alstm fig 10 e and f show the estimation results of the three models according to the distance to the precautionary area as given by the highest intent probabilities predictions change at points a l and h the proposed alstm model is the first model to predict the correct intents at 0 125 and 1 5 km from the precautionary area the hmm fails to provide a correct prediction early prediction of the correct intent allows more space and time for ship crews to respond appropriately fig 11 shows the intent prediction results of two vessels with west east sailing intent in fig 11 a the ship shows a 360 turn due to the interactions between surrounding ships and the ship crew has to turn to avoid a possible emergency these abnormal and uncertain motions mask the intent and hinder its prediction fig 11 c shows that the probability of the three intents is almost equal initially and it is difficult for the proposed alstm model to predict the intent as the vessel approaches the precautionary area the probability of the west east intention increases exceeding 90 at d 0 75 km these results confirm that longer observations provide more abundant decision making basis for intent prediction moreover although the probability of the ground truth intent is not high initially the proposed alstm model still predict the correct intent at d 2 5 km for comparison the lstm model correctly identifies the intention at d 1 75 km hence the alstm model can handle the uncertainty caused by external influences and identifies the correct intention earlier fig 12 shows the intent prediction results of two vessels with west south intent for the trajectory of vessel 412760820 although the three prediction models provide the correct prediction the alstm provides the correct result at d 0 875 km being 0 375 and 0 625 km ahead of the lstm model and hmm respectively for vessel 412380190 both the alstm and lstm models predict the intent correctly nevertheless during navigation the initial results may correspond to west east or west north intents and no west south intents were recognized again longer observation sequences improve intent prediction especially for the proposed alstm model that leverages its ability to process such sequences fig 12 f shows that the alstm model correctly predicts the intent 0 125 km earlier than the lstm model overall the experimental results and case study indicate that sailing intent can be predicted correctly and gradually better using the proposed alstm model 6 conclusion negotiating a waterway intersection during navigation substantially affects water traffic efficiency and maritime safety intent prediction of sailing vessels can reduce the occurrence of collisions and potential conflicts in intersections however predicting the sailing intent is challenging because vessel motions are influenced by various factors such as water environment and the position and speed of target and surrounding vessels in the source and target channels by leveraging a deep recurrent neural network we propose a data driven intent prediction model that is trained and tested using real world intersection waterway data the historical trajectories are considered to determine the sailing intent during training continuous observations of vessel motions are considered as input data during testing based on data from automatic identification systems collected in the south channel of yangtze river estuary we conducted a statistical analysis of vessel motions finding that vessel motions tend to be highly related to past motions in long terms to use this information we extend the conventional lstm by introducing skip connections and a new gate to express long term motion dependencies tests based on empirical vessel trajectories demonstrate that the proposed alstm model accurately predicts the intent of vessels before reaching the precautionary area outperforming the conventional lstm model and an hmm furthermore we evaluated the tradeoff between decision timing and accuracy of intent prediction the results based on alstm model show that the accuracy is increased by 3 5 compared to the lstm model at 0 1 km from the precautionary area future works will be carried out to develop a collision early warning model which could estimate the probability of conflict based on the predicted intent credit authorship contribution statement jie ma conceptualization writing review editing supervision chengfeng jia methodology visualization coding writing original draft yaqing shu validation kezhong liu resources writing review editing yu zhang data analysis writing review editing yulong hu data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china under grant 51679182 and grant 71874132 the green intelligent inland ship innovation programme and the fundamental research funds for the central universities under grant 2020 yb 035 
20706,the situational awareness in intersection waterways should be improved given the numerous accidents occurring in these areas we propose a deep learning model for predicting the sailing intent in the intersection waterway because ship ship collisions in such areas mainly occur by incorrectly interpreting the intents of other vessels we model the continuous motions of vessels before entering an intersection and estimate the most likely intent of the vessel given early observations from a statistical analysis of observed motions we found that vessel motion tends to be highly related to past trajectories over long periods therefore we introduce a recurrent neural network architecture the accumulated long short term memory alstm which overcomes the limitations of the conventional lstm by adopting skip connections and an adaptive memory module using these two extensions the present memory cell interacts with historical data to store and use relevant memory details even after long periods furthermore the strong generalization ability of the proposed accumulated lstm enables a high level representation of the uncertain and diverse motions of individual vessels thus contributing to relate various ship motion patterns and intents for validation the proposed model is trained and tested in a naturalistic data set with exemplary results in addition we compare the proposed accumulated lstm with the conventional lstm and a hidden markov model experimental results demonstrate the improved performance of the proposed accumulated lstm in terms of accuracy and real time response keywords maritime safety intent prediction motion pattern accumulated long short term memory 1 introduction maritime safety has experienced rapid developments due to improvements in sensing and computation technologies although various techniques for preventing collisions have been developed zhen et al 2017 gil et al 2020 according to a survey by the international maritime organization more than 40 of shipwrecks worldwide occur due to ship ship collisions tu et al 2018 the consequences of shipwrecks can be devastating in terms of human and economic losses as well as damage to the marine environment wan and chen 2018 a particularly challenging task in vessel navigation is to safely negotiate a waterway intersection given the frequent interactions and trajectory conflicts between vessels cheng et al 2019 the shanghai maritime administration has reported that 47 37 of ship collisions are intersection related shanghai maritime court of prc 2018 these accidents mainly occur due to the ship crew inability to correctly identify or predict the motion intents of other vessels sailing in the intersection waterway in intersections the origins and destinations of the vessels are more dispersive than those during sea going and inland shipping thus hindering the estimation of the intents of vessels misjudging or misunderstanding the intents often leads to close encounter maneuvers between vessels increasing the risk of collision or leading to near collisions the collision between vessels sanshui 805 and zhesanyu 00046 in 2019 in the yangtze river estuary represents a typical case of collision in the busiest intersection waterway in china the official report indicates that the intent of sanshui 805 to keep a straight route along the current channel was wrongly judged as turning to the north channel impeding zhesanyu 00046 to timely execute avoidance maneuvers although intent prediction has been increasingly studied in road safety lee et al 2020 research on intent prediction of vessels for maritime safety is scarce existing research on driving intent prediction of ground vehicles can provide valuable guidelines to study vessel sailing prediction despite not being directly applicable to vessels for instance a vessel can travel in a relatively wide area without road restrictions in addition no fixed lane exists to separate vessels with different intended maneuvers increasing the uncertainty in vessel trajectories and obscuring the sailing intent moreover the motion of vessels is considerably affected by both environmental conditions e g wind waves and currents and surrounding vessels in a waterway shu et al 2017 thus vessels may express different motion patterns even if they follow the same route further increasing the complexity of intent prediction most importantly a vessel cannot perform maneuvers such as an abrupt stop turn or reverse unlike ground vehicles huang et al 2020 furthermore a vessel needs more time and space to transit from one motion state to another consequently intent prediction methods for ground vehicles fail to correctly describe the long range motion of vessels to solve tasks involving temporal dependencies memory mechanisms such as recurrent neural networks and long short term memory lstm network are applied in many engineering fields song et al 2020 proposed an oil production forecasting model wherein the lstm neural network helps capture the dependencies of the oil rate time sequence data and incorporate the production constraints fjetland et al 2019 proposed a kick detection model during the offshore drilling operation these models maximize the rnn to quantify the subtle patterns in time dependent time series however beyond a given period recurrent neural networks and lstm lose efficiency in learning high level representations and capturing long term dependencies wang et al 2018 nevertheless long term dependencies allow to process non stationary and uncertain sequential data such as vessel trajectories therefore we aimed to represent long term dependencies by devising a novel lstm architecture called accumulated lstm alstm alstm selectively accumulates historical motion information via a novel gate to control the interaction between the present memory state and historical information thus this architecture can maintain and process motion information over a long period even when the motions are not relevant to the immediate present to the best of our knowledge this is the first method to predict the sailing intent of vessels the main contributions of this work are threefold 1 through a statistical analysis of naturalistic trajectory data we identified long term dependencies in vessel motions considering long term historical trajectory data instead of instantaneous data improves the intent prediction robustness thus we developed the novel alstm architecture to overcome the shortcomings of the conventional lstm by capturing long term patterns introducing skip connections and a review gate the skip connections allow the present memory cell to adaptively interact with historical motions from distant periods and the review gate controls the relevant type and extent of memory to use with these two features the stored memory is recalled effectively even after long periods making the proposed model more reasonable in understanding and predicting the potential intents 2 vessels in the intersection waterway may be influenced by environmental conditions and surrounding interactions consequently the vessels may exhibit substantial uncertainty and diversity in their motion patterns even when following the same path which makes the latent intent more obscure by leveraging a recurrent neural network architecture we generalize inconsistent motions by high level representations extracted from raw trajectory data then we analyze and uncover the intent of individual vessels 3 we discuss the impact of different length of early observation on the accuracy of the model the results show that the model achieves high accuracy before entering the precautionary area the corresponding prediction represents a decision basis for ship crews to avoid collisions at different distances from the precautionary area thus the proposed model can provide practical significance for maritime safety and management in intersection waterway 2 related work recently researchers were devoted to developing navigational assistance systems for enhancing situational awareness riveiro m et al 2018 reviewed the state of the art method carried out for the analysis of maritime data for situational awareness baksh et al 2018 proposed a marine transportation risk assessment model by considering different operational and environmental factors that affect shipping operations islam et al 2018 designed a human error probability model which introduced the bayesian network to model the interdependency between performance affecting factors and the seafarers actions misjudging or misunderstanding the intents by humans often results in the close quarters situation increasing the risk of collision or leading to near collisions the correct judgment and prediction of the sailing intents of surrounding vessels are more conducive to enhance the situation perception of navigational assistance systems the intent prediction has been a research hotspot in robotics given its importance to develop autonomous robots that interact with other agents for performing tasks koppula and saxena 2016 proposed a conditional random field model to predict the next action of a user by implementing this model a robot can plan the corresponding response in land transportation the advanced driver assistance system improves the safety and interpretation of driving situations hagl et al 2020 by predicting the motion intent before a maneuver is performed dangerous situations in the relevant traffic region can be identified early xing et al 2020 then drivers and operators can take corresponding actions to mitigate risks although intent prediction is increasingly applied in autonomous robots and ground vehicles its use in waterway traffic has been mostly neglected considering the similarities between vessels and ground vehicles studies on intent prediction of vehicles can provide valuable insights about the intent prediction of vessels pioneering works in driving intent prediction have been focused on dynamical motion models in these models the steering wheel angle and velocity are often considered as directly measurable vehicle parameters schmidt et al 2014 propose a mathematical model of the steering wheel angle to predict lane change intents but the model considers very short term when the intention is correctly detected the corresponding maneuver may already have been performed liebner et al 2013 regard the velocity profile as the indicator of driving intention however speed can vary by several reasons such as car following lane changing and ramp entrance in practice the performance of dynamical motion models based on velocity is not satisfactory and needs further improvement to predict the motion and trajectory of vessels several dynamical motion models have been proposed xiao et al 2020 provide an overview of the recent effort on maritime traffic pattern extraction and the progress on vessels motion perdition for situation awareness best and norton 1997 derive a mathematical formulation for trajectory prediction considering directional accelerations li and jilkov 2003 propose a motion prediction model considering the ship geometry and size these dynamical motion models assume that vehicles or vessels exhibit steady dynamics such as constant velocity or constant acceleration hu et al 2020 however vessels may change their motion dynamics and exhibit uncertain behaviors due to various factors e g waterway environment surrounding vessels goerlandt and montewka 2015 consequently unrealistic assumptions of dynamical motion models hinder the accurate intent prediction of vessels recent studies on big data have used historical information to obtain learning based models which can determine the motion patterns from past observations and predict the motion intent dou et al 2016 combine a support vector machine and an artificial neural network to distinguish intents of lane changing and lane keeping their classifier includes seven inputs that represent instantaneous driving situations however turning or lane changing is a time varying and continuous process gadepally et al 2014 consider historical continuous motions for intent prediction to propose a framework based on a hidden markov model hmm to relate observed continuous motions and the intents that derive in these motions li et al 2016 divide a trace into several segments and build corresponding hmms then the hmm outputs are weighted by bayesian filtering to improve intent prediction however hmms follow the first order markov property and thus assume that the current motion is only related to the immediately preceding motion state this property is unsuitable for vessels which take longer than ground vehicles to transit from one motion state to another hence vessel motion exhibits long term dependencies that cannot be captured by hmms recently deep recurrent neural networks have been used to consider time dependencies nguyen et al 2019 xie et al 2019 use an lstm architecture and a deep belief network to model lane changing and its decision respectively by analyzing and identifying the influence of various factors on intents xing et al 2020 propose an ensemble learning framework to predict lane changing intention inspired by the bagging technique they integrate several lstm networks to improve the prediction accuracy and generalization performance although lstm accurately predicts the intent of ground vehicles effectively capturing the long term dependencies of vessel motions remains challenging owing to the heavy masses and large inertias it requires longer times for vessels to change their motion state li et al 2012 which provides a strong correlation between previous and current motions thus it is reasonable to utilize a series of historical motion data rather than the instantaneous data to improve the accuracy and robustness of the intent prediction model however in lstm the memory cell responds strongly to nearby and on going short term motions but neglects past data resulting in the loss of long term information yang et al 2019 this limitation motivates us to explore an improved network for capturing temporal dependencies over a long term thus we extend the conventional lstm into alstm by introducing a novel control gate that maintains and can recall long term memories 3 problem formulation and motion data analysis 3 1 problem formulation we focus on sailing intent prediction of vessels in intersection waterway in these areas the origins and destinations of vessels are more disperse than in one or two way channels vessels in the intersections often interact with others coming from different origins wu et al 2018 unclear or inaccurate judgment of the sailing intent may result in emergency situations or increase trajectory conflicts therefore accurate intent prediction of vessels coming from different directions becomes extremely important timely intent prediction allows to avoid potential collisions and improve scheduling thus improving the overall navigation safety and efficiency of intersection waterway transit nevertheless waterways do not have a structured infrastructure e g traffic signals turning lanes to guide and restrict vessel motion thus vessels may exhibit diverse motion dynamics when transiting intersections substantially hindering intent prediction we collected a naturalistic trajectory dataset of vessels transiting an intersection waterway trajectory dataset d was obtained from an automatic identification system in the south channel of the yangtze river estuary area shown in fig 1 a the dataset is represented by d t r a i d 1 t r a i d 2 t r a i d m where trajectory t r a i d i represents a time series composed of trace points over time t r a i d i p i d t 0 p i d t 0 δ t p i d t 0 n δ t each trace point p i d i t s contains the observed latitude longitude velocity course over ground cog and heading at time t s the descriptor for p i d i t s is constructed as follows 1 p i d i t s x l a t i t u d e y l o n g i t u d e v v e l o c i t y φ c o g θ h e a d i n g there are some noises in ais data such as missing data messy codes and outlier data and so on before feeding the intent prediction model we have cleaned the raw ais data to form the trajectory data t r a i d i to decrease these errors in the ais data a statistical data cleaning method is employed assuming that these parameters are normally distributed the distribution can be identified by the mean and the variance calculated from the samples according to the 3σ rule the outlier points in the trajectories can be eliminated and replaced with blank placeholders to fill the blank placeholders and missing data at different time points the hermitian cubic interpolation was employed through this method the varying frequency data can be transformed as equal frequency data in which the frequency is 1 hz fig 1 b shows naturalistic vessel trajectories in the intersection waterway the collected trajectories include regions o west to p we can only observe the vessel trajectory before entering region p the intent of vessels in the study area can be divided into three classes 2 i n t 0 w e s t t o e a s t 1 w e s t t o n o r t h 2 w e s t t o s o u t h we aim to predict intent estimate i n t ˆ given early observation trajectory t r a i d i 3 2 motion data analysis we statistically analyzed the distribution and time dependencies of ship trajectory data considering the velocity and cog as the most representative features of vessel motion huang et al 2020 the velocity is the distance traveled per unit time of the vessels cog indicates changes in direction while the vessel adjusts its route we assume that the velocity and cog of a vessel usually exhibit different distributions according to the intent to verify this assumption we used kernel density estimation li et al 2018 to determine the data distributions of velocity v and cog φ for different intents specifically we divided the trajectory data into three sets x 0 x 1 x 2 according to the intent where x i v 1 φ 1 v 2 φ 2 v j φ j the continuous joint density function f ˆ h v φ for each set can be calculated using kernel density estimation as follows 3 f ˆ h v φ 1 n j 1 n 1 h k v v j φ φ j h where h is the bandwidth and k is the kernel function which we set to a gaussian kernel fig 2 shows the joint probability distribution of v and φ according to the intent the joint probability distributions of v and φ in fig 2 differ according to the intent hence the sailing intents of vessels exhibit different behaviors before entering the intersection and features v and φ may have the potential to distinguish the intents however the three distributions have overlapping regions especially around v 12 n m i l e h and φ 110 that means it is difficult to directly distinguish the intent only by the data distribution of v and φ the statistical analysis above only considers vessel motion at discrete points however the vessel motion tends to be highly related to past motions thus more reasonable and reliable intent prediction should consider continuous ship motions trajectory data represent a time series with abundant information of continuous motions and long term dependencies exist in ship motion cheng et al 2019 in this part the autocorrelation function acf is adopted to quantify the temporal dependencies for both velocity v t and cog φ t respectively for each sample t r a i d and a given time lag δ t the autocorrelation function of velocity is defined as 4 a c f i d v δ t g v t 0 v t 1 v t n v t 0 δ t v t 1 δ t v t n δ t where g denotes the pearson correlation coefficient of its argument likewise the autocorrelation function of cog is defined as 5 a c f i d φ δ t g φ t 0 φ t 1 φ t n φ t 0 δ t φ t 1 δ t φ t n δ t we set lag time δ t in 50 550 s with increments of 50 s to evaluate the autocorrelation function fig 3 shows the autocorrelation coefficients of all the trajectories as boxplots a strong autocorrelation occurs in the most of time lags even at 550 s the average autocorrelation coefficient remains above 0 6 in addition the variance of the autocorrelation coefficient increases with lag time δ t suggesting the long term relevance of ship motions for the overall trajectories but the consistency reduces for individual trajectories these motion characteristics motivated us to design a novel learning based intent prediction method that adaptively captures long term dependencies of ship motions for improved performance as detailed in section 4 4 alstm architecture for intent prediction this section first presents the overall framework for predicting the sailing intent of vessels we then describe the proposed alstm architecture which extends the conventional lstm to capture the long term dependencies in motion patterns finally the loss function and the parameter optimization strategy are discussed for intent prediction task 4 1 framework for intent prediction of vessels we achieve intent prediction of vessels based on the model depicted in fig 4 the model involves training and testing phases during training the model learns the complete motion data before a vessel reaches the precautionary area the network parameters are updated and trained offline testing is executed before the vessel approaching the precautionary area unlike training the inputs during testing phase are early motion observations testing provides the probability of each intent class and proceeds until the vessel arrives to the precautionary area establishing an online prediction process thus the vessel intent can be identified as the most likely class obtained from the available motion data the inputs of the model are different for training and testing in addition given the different vessel speeds and inconsistent frequency of the automatic identification system broadcast the corresponding input t r a i d i is a variable length sequence for instance slow vessels take longer to complete a given journey resulting in more samples per motion sequence therefore the model should handle variable length sequences in text classification the recurrent neural network suitably handles variable length inputs camero et al 2020 ma et al 2018 this network consists of a memory cell per time step and each cell may take the input from a cell of a previous time and new observations in the proposed model we adopt a padding technique for trajectory t r a i d i to be properly represented when it is shorter than the maximum length for motion sequences a short sequence is zero padded for its length to reach the preset maximum this architecture is implemented through functions dynamic rnn and sequence length in the tensorflow library however if the number of padded zeros is very large the effective memory i e non zero values retained in the lstm cells is limited and valuable ship motion information may be forgotten over a long term from the data analysis in section 3 3 we found that ship motions exhibit long term dependencies but the conventional lstm cell fails to effectively capture these dependencies in fact the three gates in lstm tend to respond strongly to short term motions easily interrupting long term information flows wang et al 2018 to address this limitation we propose the alstm architecture 4 2 alstm architecture the proposed intent prediction model relies on learning long term dependencies of vessel motions we aim to leverage the recurrent neural network in a novel architecture and extends the conventional lstm to express these dependencies fig 5 illustrates the proposed alstm network in which the skip connections and review gates extend the conventional lstm the black arrows represent the memory transition from lstm and the red arrows represent the added memory flow in alstm there are three inputs xt motion data point p i d i t s from t r a i d i at time t h t 1 the motion hidden states from the previous time step c t 1 the motion memory states from the previous time step we improve the lstm transition function of the memory cells by proposing a new memory review mechanism 6 f t σ w f h t 1 x t b f i t σ w i h t 1 x t b i r t σ w r h t 1 x t b r c t f t c t 1 i t tanh w h t 1 c x t b c o t w o h t 1 x t b o h t o t tanh c t r t tanh c t 1 where σ denotes the sigmoid function denotes the hadamard product x t is the input trace point p i d i t s h t is the output of the alstm network representing the motion state at time t and f t i t and o t represent the forget input and output gates respectively the three gate functions are the same as those of the conventional lstm to remember representative information obtained from historical ship motions and ignore irrelevant data in section 3 we demonstrate the long term dependencies of ship motions established that the conventional lstm fails to effectively capture such dependencies to overcome this limitation we extend the lstm by adding skip connections and a review gate unlike the conventional lstm two terms are involved to compute high level representations of motion state h t in the proposed alstm the first term o t tanh c t encodes the present vessel motions where c t is the current motion memory cell this term can immediately capture short term changes in the conventional lstm the calculation of h t only involves this first term o t tanh c t the present motion state h t can only interact with c t which further emphasizes short term motions however some valuable information may be forgotten especially as f t approaches 0 therefore we introduce a second term in the memory transition function to model long term dependencies of vessel motions as eq zhen et al 2017 stated the second term r t tanh c t 1 represents a skip connection from the previous motion memory cell the review gate function r t is implemented as an attentive module to quantify the interaction between the present motion state and the historical memory cell a set of parameterized gates r t are treated as memory access instructions that control the type and extent of access to memory similar to the original gate r t is learnable and can adaptively filter the valuable past information through a supervised approach the aforementioned terms are respectively used to model short term and long term dependencies 4 3 loss function and parameter optimization we input all variables in t r a i d i regarding the motion data on the study area using the proposed alstm architecture output i ˆ n t is the estimate of the three intents described by eq lee et al 2020 with the mean squared error mse being the loss function for the alstm based intent prediction model 7 l o s s m s e 1 k int i ˆ n t 2 where k is the number of trajectories in the mini batch and int and i ˆ n t are the ground truth and predicted intents respectively model training aims to obtain the optimal parameter set θ such that loss can be minimized 8 min θ ω l o s s θ where θ is the solution space of w b we use error backpropagation to train and update parameter set θ of alstm as we include term r t tanh c t 1 to calculate h t the loss gradient of h t changes compared with the conventional lstm the error transmitted at h t is l h t which can be obtained from the mse like in the conventional lstm as h t o t tanh c t r t tanh c t 1 the loss gradient to r t is given by 9 l r t l h t h t r t l h t tanh c t 1 considering the output gate w o and b o in traditional lstm as an example the gradient is given by 10 l w o l o t o t w t l h t tanh c t h t 1 x t t 11 l b o l o t o t b o l h t tanh c t 1 eqs song et al 2020 and fjetland et al 2019 show that the parameter of output gate tends to interact with the vessel motion current cell if the f t approaches 0 parameter update would neglect the past motion information of vessels to some extent for review gate w r and b r the gradient is given by 12 l w r l r t r t w r l h t tanh c t 1 h t 1 x t t 13 l b r l r t r t b r l h t tanh c t 1 1 eqs wang et al 2019 and riveiro et al 2018 show that the vessel past motion cell c t 1 also contributes to parameter update during error backpropagation this mechanism allows the consideration of short term and long term information directly and adaptively 5 experiments and results we conducted experiments to evaluate the proposed model for intent prediction of vessels in the intersection waterway for comparison we replaced the alstm network with an hmm and the conventional lstm the results validate the effectiveness of the proposed alstm and provide insights on intent prediction of vessels 5 1 dataset and network parameters the trajectory training and test data were collected from july to august 2018 at the south channel of the yangtze river estuary this region covers longitudes 122 457 122 594 e and latitudes 31 41 30 943 n as shown in fig 1 the restricted channel crossing routes and dense traffic flow render the study area a highly sophisticated intersection waterway after data preprocessing and sampling the resulting trajectory dataset comprises 5011 records these trajectory data are divided into training and test datasets containing 70 and 30 of the records respectively as detailed in table 1 the parameters of the alstm network are listed in table 2 the input size is 300 100 6 where 300 is the batch size 100 is the max sequence length and 6 is the number of features the learning rate was adjusted by the adam optimizer according to the convergence speed during the iterative process both the lstm and alstm models were trained with similar parameters for a fair comparison such that the performance gain was attributable to the two proposed improvements rather than to parameter optimization in addition the hmm for comparison was set as detailed in gadepally et al 2014 in which the hmm was originally designed for predicting the turning intention of a ground vehicle 5 2 model evaluation we conducted numerical experiments on the hmm lstm and alstm models to predict the intent class of the 1502 test trajectories the testing process per trajectory was divided into the following three steps fig 6 1 trajectory segmentation the area 0 2 375 km from the precautionary area was divided into 20 trajectory segments with each segment being 0 125 km in length 2 generating early observations we checked whether the currently observed trajectory reached the precautionary area to either terminate the iterative process upon reaching or add a trajectory segment to generate new observed sequences and go to step 3 otherwise 3 predicting intent class the observed sequences were input to the hmm lstm and alstm models and the predicted intent label and probability of each intent class were determined return to step 2 to quantitatively evaluate the prediction performance of the three models we used the accuracy and mse as measures 12 m s e 1 m i 1 m i n t ˆ i int i 2 where m is the number of test set samples i n t is the ground truth intent and i n t ˆ is the estimated intent a smaller mse indicates a higher prediction performance fig 7 shows the accuracy of the three models according to the distance to the precautionary area the bars represent the mean accuracy values over 10 tests and the lines show the trends of mean accuracy the shaded areas around the lines indicate the standard deviation of the accuracy with narrower areas indicating more stability of the corresponding model when the vessel arrives at the precautionary area d 0 km the accuracy values of the alstm lstm models and hmm are 86 2 81 4 and 61 2 respectively indicating the higher performance of the proposed alstm intent prediction model in addition intent prediction should provide meaningful results as early as possible although the hmm achieves the highest prediction accuracy far from the precautionary area d 2 375 1 0 km its accuracy converges to a low value as the distance reduces hence the hmm has limited ability to process long sequences in contrast as the length of the observed sequences increases the accuracy of the proposed alstm model improves therefore the alstm intent prediction model captures long term dependencies of motion data providing a higher prediction performance fig 8 shows the mse of the three models according to the distance to the precautionary area the proposed alstm model has the highest mse far from the precautionary area 2 375 1 75 km reaching 0 7 at 2 375 km between 1 875 and 0 875 km from the precautionary area the mse of the lstm model begins to exceed that of the alstm model and the hmm shows the highest mse closer to the precautionary area overall figs 7 and 8 demonstrate the effectiveness of the alstm for modeling long term motion of vessels and providing accurate intent predictions the mean and variance of the accuracy and mse at different distances to the precautionary area are listed in table 3 we also adopted the receiver operating characteristic roc curves to measure the performance of the intent prediction models based on the ground truth intent the x and y axes of the roc curve indicate the true and false positive rates respectively given by 13 t p r t p t p f n 14 f p r f p f p t n for an intent class tp represents the number of samples correctly identified and fn is the number incorrectly classified samples belonging to the class a higher tpr value indicates a better model performance fp is the number of other intent samples being wrongly detected as belonging to the class and tn is the number of other intent samples correctly identified a smaller fpr value indicates a better model performance the roc curve should be located in the top left region of the plot to indicate a high performance we also consider the area under the roc curve as a performance measure the roc curve generally measures the accuracy of binary classification but we extend it to measure the accuracy of a multi classification model for instance when the samples with west to east intent are regarded as positive samples the others are regarded as negative samples thus the probability of a positive sample is p p w e and the probability of a negative sample is p p w n p w s fig 9 a f show the roc curves for the three models and intent classes each test considered two different distances to the precautionary area 0 and 0 25 km the proposed alstm model outperforms the lstm model and hmm for instance in fig 9 a the alstm model has a roughly 34 and 3 higher area under the roc curve than the hmm and lstm model for d 0 km respectively the insets in each graph of fig 9 show the areas around a false positive rate of 0 2 for instance in fig 9 a the alstm model has a roughly 5 higher true positive rate than the hmm for d 0 km therefore the proposed alstm model provides the highest true positive rate at a given false positive rate as the distance to the precautionary area increases to 0 25 km the area under the roc curve of the alstm model declines by 2 3 this is an expected result because an early prediction is more challenging than a late one the ability to accurately predict intent at a large distance to the precautionary area would be valuable to provide an early warning to vessel crews 5 3 case study vessels sailing in the south channel of yangtze river estuary can exhibit a wide range of motion dynamics when passing through the intersection waterway it is difficult for ship crews to visually identify the intent of surrounding vessels especially according to early observations therefore an automatic online model for intent prediction of vessels during navigation would improve navigation in the experiments reported in section 5 2 we evaluated the overall performance of the proposed alstm intent prediction model to further analyze the proposed alstm we evaluated the corresponding model as well as the lstm model and hmm for six cases the six cases were selected from the test datasets and their characteristics are listed in table 4 the cases were divided into three groups according to the corresponding intent with each group containing two cases fig 10 shows the intent prediction results of two vessels with west north sailing intent as the vessels approach the precautionary area fig 10 a and b the trajectory becomes longer based on this increasing number of observations the proposed model continuously updates the intent prediction the proposed alstm model detects the correct intention earlier than the lstm model and the hmm fails to correctly identify the intent even when the vessels are near the precautionary area fig 10 c and d show the probability distributions of the recognition results from the proposed alstm and comparison models the last layer of the alstm network is a softmax layer that can convert the output neuron variables into the probabilities of the three intents then the intent class with the highest probability is taken as the estimate in fig 10 c and d longer the color bars indicate higher probability and the sum of probabilities is 1 i e i 1 3 p in t ˆ i 1 for short observation sequences the probability of correct intention west to north is relatively small as more observations are available the probability of correct intent prediction increases thus the prediction accuracy increases while approaching the precautionary area as longer observation sequences improve the performance of alstm fig 10 e and f show the estimation results of the three models according to the distance to the precautionary area as given by the highest intent probabilities predictions change at points a l and h the proposed alstm model is the first model to predict the correct intents at 0 125 and 1 5 km from the precautionary area the hmm fails to provide a correct prediction early prediction of the correct intent allows more space and time for ship crews to respond appropriately fig 11 shows the intent prediction results of two vessels with west east sailing intent in fig 11 a the ship shows a 360 turn due to the interactions between surrounding ships and the ship crew has to turn to avoid a possible emergency these abnormal and uncertain motions mask the intent and hinder its prediction fig 11 c shows that the probability of the three intents is almost equal initially and it is difficult for the proposed alstm model to predict the intent as the vessel approaches the precautionary area the probability of the west east intention increases exceeding 90 at d 0 75 km these results confirm that longer observations provide more abundant decision making basis for intent prediction moreover although the probability of the ground truth intent is not high initially the proposed alstm model still predict the correct intent at d 2 5 km for comparison the lstm model correctly identifies the intention at d 1 75 km hence the alstm model can handle the uncertainty caused by external influences and identifies the correct intention earlier fig 12 shows the intent prediction results of two vessels with west south intent for the trajectory of vessel 412760820 although the three prediction models provide the correct prediction the alstm provides the correct result at d 0 875 km being 0 375 and 0 625 km ahead of the lstm model and hmm respectively for vessel 412380190 both the alstm and lstm models predict the intent correctly nevertheless during navigation the initial results may correspond to west east or west north intents and no west south intents were recognized again longer observation sequences improve intent prediction especially for the proposed alstm model that leverages its ability to process such sequences fig 12 f shows that the alstm model correctly predicts the intent 0 125 km earlier than the lstm model overall the experimental results and case study indicate that sailing intent can be predicted correctly and gradually better using the proposed alstm model 6 conclusion negotiating a waterway intersection during navigation substantially affects water traffic efficiency and maritime safety intent prediction of sailing vessels can reduce the occurrence of collisions and potential conflicts in intersections however predicting the sailing intent is challenging because vessel motions are influenced by various factors such as water environment and the position and speed of target and surrounding vessels in the source and target channels by leveraging a deep recurrent neural network we propose a data driven intent prediction model that is trained and tested using real world intersection waterway data the historical trajectories are considered to determine the sailing intent during training continuous observations of vessel motions are considered as input data during testing based on data from automatic identification systems collected in the south channel of yangtze river estuary we conducted a statistical analysis of vessel motions finding that vessel motions tend to be highly related to past motions in long terms to use this information we extend the conventional lstm by introducing skip connections and a new gate to express long term motion dependencies tests based on empirical vessel trajectories demonstrate that the proposed alstm model accurately predicts the intent of vessels before reaching the precautionary area outperforming the conventional lstm model and an hmm furthermore we evaluated the tradeoff between decision timing and accuracy of intent prediction the results based on alstm model show that the accuracy is increased by 3 5 compared to the lstm model at 0 1 km from the precautionary area future works will be carried out to develop a collision early warning model which could estimate the probability of conflict based on the predicted intent credit authorship contribution statement jie ma conceptualization writing review editing supervision chengfeng jia methodology visualization coding writing original draft yaqing shu validation kezhong liu resources writing review editing yu zhang data analysis writing review editing yulong hu data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china under grant 51679182 and grant 71874132 the green intelligent inland ship innovation programme and the fundamental research funds for the central universities under grant 2020 yb 035 
20707,this study examines the performance of a numerical method that introduces an artificial sink term to the reynolds averaged navier stokes equations to simulate the flow through an orifice used as a quadratic power takeoff pto for oscillating water columns owcs the method replaces the quadratic pto by an artificial forchheimer flow region referred to as the artificial forchheimer flow method the performance of this method was evaluated by making comparisons with the existing experimental results for two owcs and the numerical results obtained by using air water two phase flow simulations of the air flow through an orifice referred to as the orifice flow method the surface elevations velocity fields and pressure fields obtained by the orifice flow and artificial forchheimer flow methods are compared to use the artificial forchheimer flow method an equation for specifying the forchheimer coefficient is provided and the sensitivity of the pneumatic efficiency to the forchheimer coefficient is discussed it can be concluded that the artificial forchheimer flow method can satisfactorily reproduce the measured pneumatic efficiency pressure field in the air the velocity field in the water and the cross sectional average velocity of the air compared to the orifice flow method the artificial forchheimer flow method can speed up the simulation by at least 25 times keywords wave energy owc pto cfd orifice forchheimer s law 1 introduction renewable energy is of great importance for a sustainable development falcão 2010 lund 2007 among all the renewable energy sources wave energy stands out due to the fact that it is more predictable and has a much higher energy density compared to other renewable energy sources such as wind or solar energy falcão 2010 chen et al 2013 different types of wave energy converters wecs have been proposed in the past to convert the wave energy into other forms of energy such as electrical energy one of the most widely tested and studied wecs is oscillating water columns owcs falcão 2010 aderinto and li 2018 xu and huang 2019 a typical owc device is essentially a partially submerged air chamber which is connected to the atmosphere through a power takeoff pto system aderinto and li 2018 a pto system typically includes a turbine driven by the wave induced oscillatory air flow and an electric generator connected to the turbine for electricity generation one of the key characteristics of a turbine that is relevant to the power extraction efficiency is the pressure drop of the air flow through the turbine two main types of ptos for owcs have been studied in the past scuotto et al 2005 aderinto and li 2018 1 linear ptos characterized by a linear relation between the pressure drop and the mass flow rate of the air flow through a linear turbine such as a wells turbine and 2 quadratic ptos characterized by a quadratic relation between the pressure drop and the mass flow rate of the air flow through a nonlinear turbine such as an impulsive turbine the disadvantages of wells turbines include narrow operational range noisy operations and poor stalling characteristics badhurshah et al 2018 early studies of owcs have focused on wells turbines but some recent studies of owcs focus on impulsive turbines aderinto and li 2018 because of the complexity and high rotation speed of an air turbine it is not practical to model the complex turbine aerodynamics in either small scale model tests or numerical simulations of owc type wecs liu et al 2016 as a result devices other than actual turbines have been used in small scale model tests and numerical simulations in the past to create the required pressure drop of the air flow through a turbine which means the extraction efficiency obtained is just the pneumatic efficiency the final efficiency of an owc type wec is the pneumatic efficiency multiplied by the turbine efficiency and the generator efficiency sharp edged orifices have been widely used to model impulsive turbines in both small scale model tests wang et al 2002 xu et al 2016 ning et al 2016 he and huang 2017 vyzikas et al 2017 and numerical simulations of owcs xu et al 2016 ahmad et al 2018 huang et al 2020 changing the opening ratio i e the ratio of the area of the orifice to the cross sectional area of the air chamber changes the relation between the pressure drop and flow rate therefore the opening ratio can be used as a parameter to describe the relation between the pressure drop and the mass flow rate it has been found that the typical opening ratio should be around 1 to achieve an optimal pneumatic efficiency ning et al 2016 he and huang 2017 several air water two phase flow models have been used to simulate the wave interaction with various owc type wecs where the air flow through an orifice has been used as the pto the small opening ratio can result in an oscillatory jet flow with a very high velocity according to the conservation of mass the velocity of the jet flow is about 100 times faster than the velocity of the free surface fluctuation inside the chamber if the opening ratio is about 1 experimental studies have found that the pressure sensors mounted at different locations on the interior surface of the air chamber gave almost the same time series of the measured pressure he et al 2012 he and huang 2017 since the pressure inside a high speed jet flow is expected to be approximately uniform and equal to the ambient pressures it can be hypothesized that the air pressure inside the air chamber has negligible spatial variation even though the velocity field is not spatially uniform this hypothesis can be easily verified by performing 3d numerical simulations of an owc type wec with an orifice as its pto based on the assumptions that the air pressure is spatially uniform inside the air chamber and the pressure drop across the pto can be parameterized theoretical analyses martins rivas and mei 2009 deng et al 2013 zheng et al 2019 2020 and potential flow based numerical simulations delaurã and lewis 2003 ning et al 2015 have been the two main approaches in the literature to owc problems both approaches are based on potential flow and thus cannot consider viscous effects furthermore theoretical approaches are suitable only for owc wecs with simple geometries air water two phase flow simulations of owc type wecs are getting more attention recently due to the rapid advances in computing technology both in hardware and software these simulations are based on either reynolds averaged navierstokes rans equations huang et al 2019 lópez et al 2014 or large eddy simulation les galera calero et al 2020 simonetti et al 2018 however the requirements of much finer grids and much smaller time steps to simulate the high speed flow through the orifice make the two phase flow simulations computationally very expensive because of the requirement of courant friedrichs lewy condition for numerical stability courant et al 1967 for example huang et al 2019 and huang et al 2020 presented three dimensional 3d two phase flow simulations of a circular owc type wec they reported that about 200 wall clock hours on stampede2 at tacc using 160 cores were typically needed to have about 20 s of real time results this is the reason why most existing two phase flow simulations of owc type wecs in the literature focused mainly on two dimensional 2d problems zhang et al 2012 lópez et al 2014 kamath et al 2015b and only a few 3d simulations shalby et al 2019 xu and huang 2019 are reported in the literature elhanafi et al 2017 performed both 2d and 3d simulations and found 2d simulations could overestimate the pneumatic efficiencies for high wave frequencies because of blockage effects in two phase flow simulations of owc type wecs the bottleneck is the small time step and fine grid required to simulate the air flow through an orifice even for two phase flow simulations of 2d owc type wecs about 30 wall clock hours were needed to produce 20 s of real time results on a workstation with 18 cores huang et al 2020 for the calculation of wave energy extraction efficiency the most important characteristics of a pto system that need to be modeled in a simulation are 1 the difference between the air pressures inside the air chamber and the ambient atmospheric pressure and 2 the cross sectional averaged velocity of the air flow inside the air chamber the pneumatic efficiency is calculated using these two variables martins rivas and mei 2009 deng et al 2013 xu et al 2016 to save on simulation time it is appealing to have a numerical method that can capture the key features of the air flow through an orifice so that the owc s pneumatic efficiency can be computed without the need to simulate the actual jet flow through an orifice attempts have been made in the past to use darcy s law for the flow in a porous medium to simulate the air flow through a linear pto luo et al 2014 kamath et al 2015b a anbarsooz and faramarzi 2016 çelik and altunkaynak 2020 gurnari et al 2020 with the artificial darcy flow coefficient as a tuning parameter to be determined by matching the numerical results with the experimental results for example kamath et al 2015b used the darcy flow through an artificial porous layer in their simulations to represent the linear pto studied theoretically by sarmento and falcão 1985 and experimentally by sarmento 1992 they compared their simulation results with the experimental results of morris thomas et al 2007 who used an orifice plate as the pto in the experiment however some differences between the measured and simulated pressures and surface velocities can be observed most likely because the pressure drop across an orifice is not linearly related to the velocity crane 1957 recently çelik and altunkaynak 2020 used a commercial software to study the resonant frequency and damping ratio of a rectangular owc through free decay tests and compared with physical model tests where the ptos were modeled by either the darcy flow through a porous media or the air flow through an abrupt contraction of a pipe the commercial software they used is the same as that used by mahnamfar and altunkaynak 2017 attempts to use a forchheimer flow to simulate a 3d orifice flow has not been reported in the literature the closest work that can be found in the literature is dimakopoulos et al 2015 who converted a 3d circular orifice opening to a 2d rectangular slot and the 3d circular geometry of the owc chamber to a 2d rectangular one and filled the 2d slot with a porous media to make the slot wider which allowed them to use a larger grid in the vicinity of the slot dimakopoulos et al 2015 hypothesized that the difference between their numerical results and the experimental results for the 1 0 opening ratio was due to the compressibility of the air in the air chamber as pointed out by he and huang 2017 a circular opening may behave differently from a rectangular slot with the same opening ratio therefore it is not clear to what extent converting the 3d geometry to a 2d one may have affected their numerical results because the darcy flow approach to imitate flow through an orifice cannot capture the quadratic pressure drop a key feature of the orifice flow the motivation of this study is to verify a method for speeding up the two phase flow simulations of owc type wecs with a quadratic pto similar to using a darcy flow through a porous media the method examined here adds a sink term to the momentum equation based on forchheimer s law which can give a quadratic pressure loss the method is implemented using the open source cfd tool openfoam weller et al 1998 jacobsen et al 2012 the objectives of this work are to 1 validate the method by comparing with two sets of experimental results and 2 provide detailed comparisons of the results for a circular owc obtained by two methods i the orifice flow method and ii the method using forchheimer s law referred to as the artificial forchheimer flow method to distinguish from the darcy flow method for linear ptos the comparisons focus on the pressure and velocity fields surface elevation and pneumatic efficiency empirical formulas that may be used to estimate the forchheimer coefficient in the absence of experimental data are also discussed 2 methods air water two phase flow simulations of two owc type wecs were performed using the orifice flow method and the artificial forchheimer flow method to model quadratic ptos in both methods both the air and water are treated as in compressible fluids the artificial forchheimer flow method adds a sink term to the momentum equation to produce a pressure drop across the artificial forchheimer flow region which is approximately equal to the pressure drop caused by the air flow through an orifice as a result the forchheimer flow in this method is not the flow in a real porous media because the porosity of real porous medias is not included in the governing equations and thus the flow in this region cannot capture the following features of porous media flows phase saturation relative permeability and the capillary pressure in essence the artificial forchheimer flow region is an artificial damping region designed based on the forchheimer s law 2 1 equations governing in compressible air water two phase flows for completeness the two phase flow models adopted by this study to simulate wave interaction with an owc type wec are summarized here the in compressible reynolds averaged navier stokes equations rans are used to describe the flow of a water air mixture rusche 2003 a vof method is used to track and locate the air water interface by using a volume fraction function s which is the saturation of water s 0 when a cell is occupied by air alone s 1 when a cell is occupied by water alone and 0 s 1 when a cell is occupied by both the air and the water rusche 2003 anywhere in the flow the density ρ and the dynamic viscosity μ f are calculated by 1 ρ s ρ w 1 s ρ a 2 μ f s μ w 1 s μ a where the subscripts w and a stand for water and air respectively the volume fraction function s is governed by the following transport equation 3 s t s u u r s 1 s 0 where u is the velocity of the air water mixture a compression velocity u r is applied in the direction normal to the local air water interface the purpose of using a proper compression velocity is to compress the volume fraction field and maintain a sharp air water interface as a rule the compression velocity is determined by multiplying the maximum velocity magnitude in the computation domain by the normal vector of the air water interface and a constant k c the default value of k c is 1 5 as suggested by rusche 2003 the continuity and momentum equations for the in compressible fluid are 4 u 0 and 5 ρ u t ρ u u t ρ g p μ u where g is the gravitational acceleration p is the total pressure of the air water mixture and 6 μ μ f μ t with μ t being the turbulent eddy viscosity which needs to be closed by a turbulence model the following k ω sst turbulence model larsen and fuhrman 2018 is employed for this purpose 7 ρ k t ρ u k ρ p k ρ β k ω μ f ρ σ k ω k 8 ρ ω t ρ u ω ρ p ω ρ β ω 2 ρ σ d ω k ω t μ f ρ σ k ω ω where k and ω are specific turbulence kinetic energy and specific dissipation rate respectively p k and p ω are production terms for k and ω respectively β β σ σ and σ d are model parameters the turbulent eddy viscosity μ t is then determined by 9 μ t ρ ν t ν t a 1 k m a x a 1 ω f 2 s s a 1 λ 2 β β α s s p ω ω where a 1 and λ 2 are model parameters f 2 is a blending function that is close to 1 in boundary layer region and 0 in free shear layers s is the strain rate tensor defined by s 1 2 u u t and p ω u is 2 times the rotation tensor it is worth noticing that eq 9 is different from the original k ω sst turbulence model in menter 1994 where the last term in m a x is absent the presence of that term can avoid the unphysical generation of turbulence energy in near potential flow regions where p ω s s larsen and fuhrman 2018 the model parameters used in this paper are a 1 0 31 β 0 09 β 0 075 0 0828 σ 0 5 1 0 σ 0 5 0 856 σ d 0 856 λ 2 0 05 the actual values of β σ and σ vary within a range in the computational domain depending on the distance of a grid to the closest wall 2 2 the empty numerical wave tank based on the equations given in section 2 1 a three dimensional 3d numerical wave tank nwt was developed using openfoam v1712 as shown in fig 1 the empty nwt consists of three sections the wave generation section wgs the test section and the wave absorbing section was both the wave generation and wave absorption sections are achieved using a relaxation zone method jacobsen et al 2012 the relaxation zones was implemented using the library waves2foam which is a toolbox used to generate and absorb water waves the length of each relaxation zone is at lest two times the maximum wave length examined in this study as shown in fig 1 the empty nwt is divided into four mesh zones i the air zone ii the free surface zone or the air water interface zone in which the wave crests and wave troughs lie iii the water zone and iv the two relaxation zones the cartesian coordinate system x y z has the x coordinate pointing in the direction of wave propagation the y coordinate pointing vertically upward and the z coordinate pointing out of the paper the origin of this coordinate system is located on the still water surface and at the inlet boundary the information of the grid for each zone is summarized in table 1 referring to fig 1 the height of the nwt is h h a i r with the water depth h 0 29m and h a i r 0 21m and the total length is 14m 6m for the test section and 4m for each relaxation zone the width of the nwt is fixed at 0 5m which was the width of the wave flume in the experiment of xu et al 2016 therefore whatever side effects there might be in the physical model tests will also be present in the two phase flow simulations 1 1 the effects of the sidewalls are expected to be small because 1 the ratio of the flume width to the model dimension is between 4 and 5 and 2 there is no lateral waves excited by the diffraction of fundamental waves the edge of the wave generation zone is at x 4 00m and the edge of the wave absorption zone is at x 10 00m problems of wave interaction with an owc can be studied by integrating into the grids for the test section of the nwt a set of locally nested grids describing the geometry of the owc as described in section 3 1 in a relaxation zone the value of a variable φ e g fluid saturation s or components of velocity u is a blend between the computed value φ c and the targeted value φ t with a relaxation factor β r therefore the value of φ in the relaxation zone can be written as 10 φ β r φ c 1 β r φ t where the relaxation factor β r varies in space and is specified by 11 β r x 1 exp x 3 5 1 exp 1 1 where x x l r with x being the distance relative to the edge of the relaxation zone and l r the length of the relaxation zone jacobsen et al 2012 for wave generation the second order stokes wave theory is used to provide the targeted φ t while for wave absorption φ t 0 is used boundary conditions bcs at the lateral walls the bottom of the wave flume and the owc walls are set to be wall bcs for which the velocity is set to 0 at the boundary ω k and μ t are calculated by applying wall functions and the pressure is taken to be the same as that in the cell next to the wall the methods to specify wall functions used here are described in kalitzin et al 2005 this method does not require the first cell to be in the logarithmic layer therefore y value varies along the boundary depending on the flow field and the mesh used at different boundaries the boundary condition used at the ceiling of the wave flume is the pressure inlet outlet velocity condition provided in openfoam so that the air can get in and out freely through the ceiling 2 3 the circular owc model with an orifice plate as a quadratic pto the circular owc model shown in fig 2 was used to demonstrate the two methods for simulating quadratic ptos the owc model consists of a c shaped support structure a circular owc chamber and a top cover which is a sharp edged orifice plate the owc chamber is partially submerged with a draft d r and the distance between the lower tip of the owc chamber skirt and the bed is d s for a given water depth h the draft of the owc chamber d r h d s the change of quadratic pto s characteristics can be achieved by changing the opening ratio of the orifice plate when the air flows through the orifice there is a pressure drop across the orifice and the pneumatic power extracted from the wave field p o u t is equal to the average work done by the air pressure on the water over n wave periods 12 p o u t 1 n t w t 0 t 0 n t w s p a w a d a d t where p a and w a are the air pressure and vertical velocity respectively s is the cross section of the air chamber on which p a and w a are taken t w is the wave period and t 0 is an arbitrary time reference and n is an integer the pneumatic efficiency of the owc type wec ε is defined by the ratio of the so called capture width λ to the chamber diameter d o w c 13 ε λ d o w c λ p o u t p i where p i is the wave power per unit wave crest in the incident waves for second stokes waves in water of depth h 14 p i e c n 1 k a i 2 ξ 15 e 1 2 ρ w g a i 2 c ω k n 1 2 1 2 k h sinh 2 k h 16 ξ 9 8 n cosh k h sinh 7 k h sinh 4 k h 4 k h 8 sinh 2 k h sinh 2 k h 6 where a i is the amplitude of the first harmonic ω 2 π t w k is the wave number ρ w is the density of water and g is the gravitational acceleration the contribution from the second harmonic wave is small for the present problem less than 1 the model shown in fig 2 has been studied experimentally by xu et al 2016 who also extended the linear potential flow theory of deng et al 2013 by including a quasi linear pto model to calculate the power extraction by an orifice in the experiment of xu et al 2016 the circular orifice had a diameter of 0 014 0 0002m the inner diameter of the owc chamber d was 0 125 0 0005m and the thickness of the wall was 0 003m the uncertainties in the diameter of the opening and the diameter of the owc chamber were estimated based on multiple measurements along different directions from the sizes of the opening and the owc chamber the opening ratio α is in the range of 1 210 and 1 300 with an average value of 1 255 i e α 1 255 0 045 the distance from the lower tip of the owc chamber to the bed d s was 0 25m and the overall height of the owc model was 0 4m two water depths were examined in xu et al 2016 and h 0 29m was used in this study for comparing the results obtained by the two methods for simulating the quadratic pto i e the orifice plate in the experiment 2 4 the orifice flow method in their openfoam based three dimensional 3d two phase flow simulations of the owc shown in fig 2 huang et al 2019 xu and huang 2019 and huang et al 2020 simulated the air flow through the orifice to obtain the characteristics of the quadratic pto because of the small size of the opening and the thin wall in the owc model meshes much finer than the meshes used for the empty flume are needed adjacent to the wall and in the vicinity of the opening for example the smallest mesh generated by using snappyhexmesh to fit the owc model in xu and huang 2019 has the following dimensions 0 001 m 0 001m x 0 001 m which was based on a mesh convergence study see appendix b to achieve a balance between the computational cost and accuracy in this study the smallest mesh generated by using snappyhexmesh to fit the owc model has the following dimensions 0 00125 m 0 0015 m x 0 00125 m for the test conditions examined by xu et al 2016 and xu and huang 2019 the speed of the air flow through the orifice was greater than 10 m s in the experiment for a stable numerical simulation the courant friedrichs lewy cfl condition requires that the following courant number must be smaller than unity 17 c δ t j 1 3 u j δ x j where u j is the magnitude of the j th velocity component δ x j is the grid size of the j th coordinate δ t is the time step xu and huang 2019 and huang et al 2020 found that the courant number must be around 0 4 in general sometimes a value of 0 2 was needed to march the simulation for several time steps to achieve numerical stability 2 2 the computations were performed using multiple nodes on a high performance computing facility the communication between nodes sometimes may cause numerical instability this instability issue is hardware and software dependent when this type of numerical instability occurs our experience is that it may be overcome by marching the simulation for several time steps with a smaller courant number the combination of high speed small mesh size and small courant number results in very small time steps and very long time to run the simulation which makes it impossible to run the simulation on pc or a single workstation the simulations reported in xu and huang 2019 and huang et al 2020 were performed on stampede2 at tacc using 160 cores and 200 wall clock hours were typically needed for about 20 s of numerical results therefore simulating the high speed air flow through a small orifice is the bottleneck in the two phase flow simulations of owcs with an orifice as the pto 2 5 pressure drop across an orifice both physical experiments xu et al 2016 he and huang 2017 and cfd simulations of the air flow through an orifice using the orifice flow method xu and huang 2019 huang et al 2020 have found that the following expression can describe the pressure drop across an orifice plate well 18 p i n p o u t 1 2 c f ρ w w l α ρ w t where p i n and p o u t are the dynamic pressures inside and outside the air chamber respectively w is the cross sectional averaged vertical velocity of the air flow inside the air chamber and c f and l α are two parameters determined by either experiments or numerical simulations the dynamic pressure outside the air chamber p o u t can be set to approximately zero the last term in eq 18 represents the effect of the flow inertia on the pressure drop for the change of hydrodynamic pressure induced by long water waves passing through a perforated plate mei 1992 derived an expression similar to eq 18 unlike in long water waves passing through a perforated plate where the flow pattern for the water moving forward is a mirror image of that for the water moving backward the air inhalation and exhalation processes are slightly different as shown in appendix a this is because the air flow outside the owc chamber is not confined laterally by any boundary while the air flow inside the air chamber is confined by the wall of the air chamber nevertheless both the existing experimental studies xu et al 2016 he and huang 2017 and cfd simulations of the air flow through an orifice using the orifice flow method huang et al 2019 2020 have shown that the inertia term in eq 18 is much smaller than the quadratic loss term for the present problem and eq 18 can provide an adequate description of the air pressure drop across an orifice with a constant c f see appendix a 2 6 parameterization of the orifice flow by an artificial forchheimer flow mathematically the quadratic pto can be represented by the energy loss associated with a quadratic pressure drop between the air chamber and the ambient air which makes it possible to use an artificial forchheimer flow to model a quadratic pto even though the flows during the inhalation and exhalation periods are not exactly the same as shown in appendix a the value of c f for the inhalation period is only slightly different from that for the exhalation period the two values of c f deviate from its mean only by about 7 for the circular owc model shown in fig 2 in the following a constant c f will be assumed 2 6 1 equations for artificial forchheimer flow openfoam allows users to include in eq 5 an empirical sink term s m i e 19 ρ u t ρ u u t ρ g p μ u s m for the sink term s m darcy forchheimer model is one of the models that the user can choose from by setting openfoam s fvoptions file in the system folder for the problem it is stressed that this model employs the porous media analogy but sets the porosity of the porous media to 1 for a homogeneous porous media the following darcy forchheimer equation can be used to model the sink term 20 s m μ f β d 1 2 ρ f u u where β d is a constant darcy s resistance coefficient and f is a constant forchheimer coefficient having a unit of m 1 and both are scalar model parameters for the homogeneous porous media since the porosity is set to unity the model cannot simulate features such as phase saturation relative permeability and the capillary pressure it is because of this reason the method using eq 20 to imitate an orifice plate is referred to an artificial forchheimer flow method in this study to avoid confusion with the real flow in a porous medium it is remarked that dimakopoulos et al 2015 used a different momentum equation which includes the porosity in their momentum equation for the flow in their porous layer but their expression for the sink term is formally the same as eq 20 2 6 2 assumptions behind the artificial forchheimer flow method next we show that using eq 20 can produce the quadratic pressure drop across the orifice plate given by eq 18 by establishing a relationship between the model parameter f in eq 20 and the quadratic loss coefficient of an orifice c f in eq 18 referring to fig 3 the orifice plate is replaced by a region occupied by an artificial forchheimer flow region which is bounded by the owc wall the planes of y y and y y the thickness of this region is h l y r to proceed we assume that i the pressures on the two sides of the orifice plate are almost uniform ii the artificial forchheimer flow is almost parallel to the chamber walls and spatially uniform except in the boundary layer adjacent to the wall iii both the orifice flow method and artificial forchheimer flow method give the same the cross sectional average of the vertical velocity iv the reynolds stress is not important in the artificial forchheimer flow region it will be shown later that the first assumption can be verified by the results obtained by using the orifice flow method the second and third assumptions lead to w w where stands for taking cross sectional average of its argument and make the values of w obtained by the two numerical methods to be approximately the same as a result eq 19 which governs this artificial forchheimer flow can be approximately written as 21 ρ w t p y s m where p p ρ g y is the dynamic pressure w is the velocity in y direction and the source term s m is given by 22 s m μ f β d 1 2 ρ f w w integrating eq 21 from y to y gives 23 h l y r ρ w t p o u t p i n s m h l y r where h l y r is the thickness of this artificial forchheimer flow region comparing eq 23 and eq 18 and taking β d 0 in eq 22 gives 24 f c f h l y r l α h l y r previous studies xu et al 2016 he and huang 2017 huang et al 2019 2020 have shown that the inertia term in eq 18 is not important see also appendix a therefore it is expected that the results should not be sensitive to the thickness of the artificial forchheimer flow region h l y r 2 6 3 summary in order to use the artificial forchheimer flow method to model quadratic ptos the four assumptions listed in section 2 6 2 must be met and the forchheimer coefficient should be determined by f c f h l y r 3 results the performance of the artificial forchheimer flow method is evaluated in this section by comparing with both experimental results and the numerical results obtained by using the orifice flow method in addition to the circular owc shown in fig 2 which has an opening ratio fixed at 1 25 the rectangular owc studied experimentally by he and huang 2017 which has an opening ratio varying in the range of 0 635 and 1 875 is also used to validate the artificial forchheimer flow method all simulations were run on stampede2 at tacc using 160 cores for the circular owc which has a wall thickness of 0 003m simulations using the orifice flow method typically took 200 wall clock hours to obtain about 20s of numerical results while simulations using the artificial forchheimer flow method took only about 8 wall clock hours 3 3 çelik and altunkaynak 2020 reported that a computation time ranging from 24 to 36hrs wall clocktime was needed to obtain about 8s simulation in their simulation of 3d free decay tests it is not clear how many grids what computing facility and how many cores they used in their studies their fig 5 shows the mesh used in their study it seems their mesh is much coarser than ours therefore the artificial forchheimer flow method can speed up the simulation by a factor of about 25 3 1 the circular owc in xu et al 2016 to use the orifice flow method to simulate the air flow through the orifice used as the pto of the circular owc shown in fig 2 a set of nested grids shown in fig 4 are integrated into the grids for the empty nwt to represent the geometry of the owc model the information of the nested grids representing the geometry of the circular owc is summarized in table 2 where b g 1 and b g 2 are the background grids for the empty flume the grid g 1 provides a transition from b g 1 and b g 2 to the inner grid g 2 the integration of the grids g 1 and g 2 into the background grids b g 1 and b g 2 for the empty tank is achieved by using the openfoam s built in mesh utilities refinemesh and snappyhexmesh during the grid refinement an inner most mesh with a multiplayer configuration inside the grid g 2 is automatically generated to capture more geometrical details of the owc model and improve the mesh quality in the present study snappyhexmesh generates a mesh with a two layer configuration the first layer has a thickness of 0 5 times the size of g 2 grid and the second layer has a thickness of 1 2 times the thickness of the first layer to evaluate the performance of the artificial forchheimer flow method the pressure loss coefficient c f obtained by using the orifice flow method was used to determine the forchheimer coefficient f using eq 24 for a given thickness h l y r as will be shown in section 3 5 several thicknesses have been examined and the results have confirmed that the simulated pressure drop and pneumatic efficiency are not sensitive to the thickness of the artificial forchheimer flow region in all examples presented hereinafter h l y r 0 05m was adopted and the grid in the artificial forchheimer flow region is the same as the grid g2 δ x 0 0021m δ y 0 0025m and δ z 0 0031m results presented in section 3 1 are for two wave periods t 1 2s and t 0 8s the c f value used to determine the forchheimer coefficients f by eq 24 is c f 1 40 10 4 which was determined by using the pressure and surface elevation provided by the orifice flow method it is believed that the surface non uniformity inside the owc chamber does not have a significant influence on the determined c f value for this relative long period wave xu and huang 2019 3 1 1 air pressure and surface elevation first we examine the results for the test condition gp1f in xu et al 2016 wave period 1 2s wave height 0 037m and water depth 0 29m the measured and simulated air pressures and surface elevations inside the chamber are compared in fig 5 where the results obtained using the orifice flow method are labeled as orifice the results obtained using the artificial forchheimer flow method are labeled as forchheimer and the results obtained from the physical model test reported in xu et al 2016 are labeled as experiment it can be seen from the comparison that the time series of the air pressures and surface evaluations given by the two numerical methods are nearly identical and both agree well with the experimental results it is remarked that as in the experiment the numerical wave gauges used in the cfd simulations both the orifice flow method and the artificial forchheimer flow method are located at the location 0 037m away from the center axis of the owc chamber in the down wave direction the pressure sensor in the numerical simulation is located at a grid nearest to the location where the pressure sensor was mounted in the experiment on the top of the owc chamber 0 05 m from the orifice center in the up wave direction as will be shown by our numerical results the pressure distribution in the air chamber is almost uniform therefore the exact location of the pressure sensor is immaterial next we examine the results for the test condition gp1b in xu et al 2016 wave period 0 8s wave height 0 037m and water depth 0 29m the measured and simulated air pressures and surface elevations inside the chamber are compared in fig 6 again the numerical results obtained using the artificial forchheimer flow method agree well with the experimental results it can be concluded that the artificial forchheimer flow method and the orifice flow method can produce almost the same surface elevation and air pressure inside the owc chamber it is remarked that in either the orifice flow method or the artificial forchheimer flow method c f is not a turning parameter 3 1 2 velocity field of the air flow it has been assumed in section 2 6 2 that the artificial forchheimer flow is almost uniform spatially which is approximately equal to the cross section average of the velocity obtained by using the orifice flow method these assumptions can be verified by comparing the velocity fields of the air flow obtained by the two numerical methods four snapshots of the velocity fields for the air flow in the plane of symmetry are shown in fig 7 which compares the velocity fields obtained using the artificial forchheimer flow method with those obtained using the orifice flow method the velocity fields obtained by these two methods look very different for the velocity field obtained by using the orifice flow method a jet flow exists during both the air exhalation and inhalation periods the maximum velocity in the jet is as high as 10 m s for velocity field obtained by the artificial forchheimer flow method the air flow indeed is almost uniform spatially in the artificial forchheimer flow region the air flow is also almost uniform spatially in the air chamber except very close to the air water interface where the velocity is determined by the motion of the water surface these results can verify the second assumption made in section 2 6 2 fig 8 shows a comparison between the time series of the velocities averaged over the cross section of the air chamber obtained by the two numerical methods even though the velocity fields obtained by the two numerical methods look very different the velocities averaged over the cross section of the air chamber are almost the same which verifies the third assumption made in section 2 6 2 3 1 3 pressure fields of the air the first assumption in section 2 6 2 is about the pressure on either side of the orifice plate fig 9 shows the pressure fields of the air flow obtained by using both methods it can be seen that the pressure on either side of the orifice plate is approximately uniform even through the velocity field shows the existence of jet flows the pressures on the top and bottom of the artificial forchheimer flow region are also practically uniform instead of a sudden jump in the pressure across the thin orifice plate the pressure in the artificial forchheimer flow is almost uniform on any plane of a constant y and the pressure changes gradually from the pressure inside the air chamber to the atmospheric pressure outside the air chamber in other words the artificial forchheimer flow method only distributes the pressure jump across the orifice plate over the thickness of the artificial forchheimer flow region but keeps the air pressure inside the chamber the same as that for the orifice flow therefore it can be concluded that the first assumption made in section 2 6 2 can be verified by the simulated pressure fields 3 1 4 velocity field around of the skirt of the owc chamber the flow pattern around the skirt of the owc chamber is directly related to the energy loss due to vortex shedding xu et al 2016 huang et al 2020 have shown that the orifice flow method used here can reproduce the velocity fields of the water flow measured by lópez et al 2015 for a 2d owc fig 10 shows four snapshots of the velocity field of the water flow in the plane of symmetry it can be seen by comparing the results obtained by the two methods that the artificial forchheimer flow method can capture the main features of the water flow around the owc chamber skirt well however minor differences do exist especially at the phase a and phase d a discussion of the minor differences in the velocity fields obtained by the two methods is provided in section 4 2 3 1 5 velocity field in horizontal planes the velocity field close to the bed affect the sediment transport and local sour around the owc wec huang et al 2020 fig 11 shows four snapshots of the velocity field of the water flow in the horizontal plane located at 0 1m above the bed the mean flow fields in the last column were calculated by averaging the velocity fields within three wave periods it can be concluded that the artificial forchheimer flow method can capture the key features of the flow fields well in this plane except for some minor differences fig 12 shows four snapshots of the velocity field of the water flow in the horizontal plane located at 0 005m above the bed again the mean flow fields in the last column were calculated by averaging the velocity fields within three wave periods the near bed flow pattern is responsible for local scour around the owc wec huang et al 2020 it can be concluded that the artificial forchheimer flow method can capture the key features of the instantaneous as well as the mean flow field adquately in this plane 3 2 the rectangular owc in he and huang 2017 he and huang 2017 studied the effects of orifice characteristics on the performance of a rectangular owc the owc s pto was modeled using either a circular orifice and a narrow slot three opening ratios were examined 0 625 1 250 and 1 875 six sets of their experimental results for circular orifices were used here to evaluate the performance of the artificial forchheimer flow method the purpose is to demonstrate that the artificial forchheimer flow method can be applied to different opening ratios and different shapes of owcs the demonstration was done under two wave conditions i wave period 1 5s water depth 0 4 m and wave height 0 035m ii wave period 1 0s water depth 0 4m and wave height 0 035m the orifice plate is replaced by an artificial forchheimer flow region which is 0 1m thick and placed at 0 2m above the still water level the value of forchheimer coefficient f for each opening ratio is determined using eq 24 with the values of c f reported in he and huang 2017 since the thickness of the chamber walls used in the experiment was 0 01m it took only about 3 h to obtain 25s of numerical results on the tacc s stampede2 using 160 cores he and huang 2017 reported their results in terms of pneumatic efficiency ε amplification factor c a and pressure coefficient c p the pressure coefficient c p and the amplification factor c a are defined by 25 c p δ p ρ w g h i c a δ η h i where δ p is the difference between the maximum and minimum values of the air pressure inside the air chamber δ η is the difference between the maximum and minimum values of the cross sectional average of the surface elevation inside the chamber h i is the incident wave height and ρ w is the water density the pneumatic efficiency ε has been defined in eq 13 the comparison between the numerical and experimental results c a c p and ε are summarized in table 3 for t 1 5s and in table 4 for t 1 0s in these two tables the first number in the pair n 1 n 2 n 3 is the value reported in he and huang 2017 the second is the value obtained by using the artificial forchheimer flow method and the third number is the relative difference defined by n 3 n 2 n 1 n 1 100 for the case of t 1 5 s the difference between the measured and simulated pneumatic efficiency is less than 0 01 for all three opening ratios with the relative difference being less than 5 less than 2 0 for α 0 625 which provide the best pneumatic efficiency the relative difference between the measured and simulated c p is less than 8 possibly because a constant c f is used for both the inhalation and exhalation processes the relative difference between the measured and simulated c a is about 5 except for the smallest opening ratio which has a relative difference of 16 7 possibly due to the fact that the value of c a for α 0 625 is a bit abnormal in the experiment nevertheless the relative difference between the simulated and measured c a does not significantly affect the pneumatic efficiency because when the cross sectional average of the surface displacement is at either a crest or a trough the average velocity is zero and thus the instantaneous power extraction is also zero at that instant for the case of t 1 0s the simulated c p is always about 9 smaller than the measurement which again is due possibly to the use of a constant c f in the simulation for both the inhalation and exhalation processes the relative difference between the simulated and measured c a is less than 6 for all three opening ratios the relative difference between the simulated and measured efficiency increases with increasing opening ratio even though the largest relative difference between the simulated and measured efficiencies is about 12 for the largest opening ratio which has the lowest pneumatic efficiency but the absolute difference between the simulated and measured efficiencies is less than 0 04 for all three opening ratios the large relative difference for shorter waves might be due to the strong non uniformity of the surface displacement inside the owc chamber which can be caused by sloshing waves or a slight non normal incidence in the experiment sloshing waves can be excited by vortex shedding zhao et al 2014 xu and huang 2019 the effect of non normal incidence for longer waves is expected to be less important compared to shorter waves it is remarked that the difference between the simulated and measured pneumatic efficiencies is not due to the air impressibility in the model tests as argued in section 4 3 it can be concluded that the artificial forchheimer flow method can provide all important key parameters for owcs in reasonable agreement with the measurement for different wave periods and opening ratios 3 3 determination of the quadratic loss coefficient c f for circular orifices to use the artificial forchheimer flow method to speed up the simulation of wave interaction with an owc with an orifice plate as the quadratic pto it is desirable to have a way to provide the value of c f for a given orifice plate without doing either physical model tests or performing simulations using the orifice flow method for the flow of an in compressible fluid through a sharp edged orifice in a pipe the following two empirical formulas can be used to estimate the quadratic loss coefficient c f 1 the formula of crane 1957 which was proposed for steady flow through a sharp edged orifice in a pipe 26 c f 2 72 α 120 r e 1 1 α 1 α 2 1 r e 2500 2 72 α 4000 r e 1 α 1 α 2 1 r e 2500 where α is the opening ratio for a sharp edged circular orifice in a pipe and the reynolds number is defined by r e d w ν where d is the inner diameter of the pipe ν the kinematic viscosity of the air and w the cross sectional average of the air velocity in the chamber 2 the formula of mei 1992 which was derived for the loss of hydrodynamic pressure caused by long water waves through a vertical perforated plate with sharp edged holes 27 c f 1 α c c 1 2 for circular sharp edged orifices the discharge coefficient c c can be determined by the following well known chisholm expression fossa and guglielmini 2002 28 c c 1 0 639 1 α 0 5 1 it is remarked that the expression for c f given by eq 27 together with 28 is a function of the opening ratio only not affected by the reynolds number the reader is referred to xu et al 2016 and xu and huang 2019 for a comparison of the values of c f predicted by eqs 27 and 28 obtained from the experiment and simulated by using the orifice flow method for reynolds number r e 100 and the opening ratio α 10 these two formulas give almost the same result for typical owcs in a laboratory setting r e o 10 3 and α o 1 therefore both formulas can give about the same c f for scaled and full scale models of owc wecs with quadratic ptos the reader is referred to appendix a for details 3 4 sensitivity of the simulated pneumatic efficiency to the forchheimer coefficient f the forchheimer coefficient f is determined by eq 24 therefore the sensitivity to f is basically the sensitivity to the quadratic loss coefficient c f because the numerical results are not sensitive to the thickness of the forchheimer flow region as discussed in section 3 5 when using an empirical formula such as eq 26 or 27 to estimate the quadratic loss coefficient c f for a given opening ratio certain uncertainty in the estimated c f can be expected due to factors such as 1 the treatment of the orifice edges 2 the measurement error in the opening ratio and 3 the suitability of the formula for non standard orifice plates when c f is determined by eq 18 using the measured pressure and surface elevation the determination of cross sectional average velocity becomes a challenge for 3d owcs most existing studied only used one wave gauge to determine the surface elevation inside the owc chamber and obtained the velocity by taking the time derivative of the surface elevation and used this velocity to approximate the cross sectional average velocity this approach may introduce an error to the value of c f determined by using eq 18 especially when the surface non uniformity inside the owc chamber cannot be ignored xu and huang 2019 this means that even the c f values obtained from the scaled model tests on owcs may contain errors xu et al 2016 xu and huang 2019 the sensitivity of an owc s pneumatic efficiency ε to the uncertainty in c f the parameter describing the characteristics of a quadratic pto depends on whether or not the pto has been optimized for the owc to certain extent if the pto has been optimized for the owc then ε c f 0 at the optimal c f in this case the pneumatic efficiency ε is not sensitive to the uncertainty in c f however if the pto has not been optimized then the sensitivity of the owc s pneumatic efficiency ε to c f depends crucially on how far the value of c f is away from the optimal value take the circular owc studied here for example the cross sectional average velocity can be estimated by w o 2 π a i t w where a i is the incident wave amplitude and t w is wave period if we take t w 1 0s a i 0 02m and d 0 125m we have r e 15700 therefore eq 26 or 27 give the same c f the measured opening ratio has an uncertainty introduced when fabricating the model the opening ratio obtained from measuring both the opening and the chamber along several directions is α 0 0125 0 00045 as a result the values of c f estimated by either eq 26 or 27 is in the range of 15 565 and 17 992 with a mean of 16 713 the uncertainty in the c f value obtained using eq 27 is about 7 6 relative to the mean for t 1 2 s xu et al 2016 obtained c f 14 000 based on the surface elevation measured at one location inside the owc chamber the orifice opening was not optimized for the circular owc simulated in this study from our simulation results obtained using c f 14 000 17 000 and 20 000 as inputs to the artificial forchheimer flow method we have ε c f 6 7 10 6 at c f 16 713 the simulated pneumatic efficiency at 17 000 is about 0 19 while the values of c f and ε measured in the experiment are 140 000 and 0 18 respectively meaning that using eq 27 to estimate c f and compute the pneumatic efficiency may give about 7 0 uncertainty in the simulated pneumatic efficiency compared to the measurement in consideration of all possible uncertainties in physical model tests and errors in numerical simulations of orifice flows with very small opening ratios this uncertainty should be acceptable for practical purposes especially for owcs with non rectangular shapes for which accurate measurement of the pneumatic efficiency is difficult due to the non uniformity of the water surface inside the owc chamber for narrow slots he and huang 2017 has found that both the period of the oscillatory flow and the thickness of the orifice plate affect the c f value presently there is no existing expression for c f that can provide a reliable estimation of c f for narrow slots other than those studied by he and huang 2017 it is remarked that the existing expressions for c f discussed here were initially proposed not for orifice plates used in owc model tests the expressions were obtained for either surface waves through perforated slotted barriers or the steady flow through a standard orifice used for flow control in a pipe however the orifices used in the studies of owcs are not standard orifices and involve oscillatory air flows even though several studies in the literature have shown that these expressions for c f can provided a reasonable estimate of c f for a given opening ratio xu et al 2016 he and huang 2017 it is desirable to have a systematic evaluation of the uncertainty in the estimated values of c f for problems that have not been studied in the literature using the orifice flow method to simulate 3d owc problems with orifice plates as ptos can be a very time consuming task if the opening ratio is very small very fine grids are needed in the vicinity of the orifice and very small time steps are needed because the velocity of the air flow through the orifice is very high therefore there is a need to establish an accurate relationship between c f and the opening ratio through laboratory tests of owcs 3 5 effects of the thickness of the artificial forchheimer flow region in numerical simulations h l y r n p δy where n p is the number of the grids in the artificial forchheimer flow region and δ y is the grid size across the region because forchheimer coefficient f is calculated from the value of c f specified by the user 29 f c f n p δ y a larger δ y may result in a larger error in the numerical thickness of the artificial forchheimer flow region which can be translated into a larger error in the forchheimer coefficient f for a given c f as long as δ y is reasonably small relative to the thickness h l y r the numerical results are not sensitive to the thickness of h l y r to demonstrate this two values of h l y r were examined for the circular owc using the same g 2 grid 0 05 and 0 1m the values of the pneumatic efficiency obtained using these two thicknesses are 0 1729 0 1733 respectively 4 discussion 4 1 unimportance of the acceleration and reynolds stress in the artificial forchheimer flow it has been assumed that the acceleration of the artificial forchheimer flow is not important this assumption can be verified by the following order of magnitude estimation the ratio of the inertia force to the forchheimer resistance in eq 23 is 30 ρ w t 0 5 ρ f w w o 2 ω h l y r c f w o 2 h l y r c f a i where the order of magnitude estimation w o ω a i with a i being the amplitude of the incident waves has been used in the experimental study of xu et al 2016 a i o 0 05m α o 0 01 and c f o 1 6 10 4 according to eq 26 therefore as long as the thickness of the artificial forchheimer flow region h l y r a i o 10 4 the local acceleration is not important this means that theoretically speaking the inertia coefficient l α in eq 24 which is equal to the thickness of the artificial forchheimer flow region can be set to any reasonable value it has been assumed that reynolds stress is not important in the artificial forchheimer flow region the ratio of the reynolds stress to the forchheimer resistance can be estimated by 31 β μ μ t u h l y r f u 2 μ t f h l y r u μ t c f ω a i where u ω a i is the scale of u in the artificial forchheimer flow region numerical simulations have found that μ t o 10 4 n s m 2 in the artificial forchheimer flow region take c f 14 000 and a i 0 02m and ω 6 28 rad s eq 31 gives β μ 5 7 10 7 which means that the reynolds stress is not important in the artificial forchheimer flow region 4 2 the minor difference in the flow fields of the water motion obtained by the orifice flow and artificial forchheimer flow methods even though these two methods give very different velocity fields of the air flow they give approximately the same mass flow rate through the pto and the same air pressure inside the air chamber as a result the pneumatic efficiencies obtained by these two methods are close to each other the velocity field inside the air chamber can affect the water flow inside the owc chamber through the kinematic and dynamic boundary conditions at the air water interface inside the owc chamber assuming that the effects of the non linearity and viscosity are small in the problem the flow of the water inside the owc chamber can be theoretically decomposed into i diffracted waves and ii radiated waves the radiated waves are generated by specified conditions on the air water interface in the absence of the incident waves while the diffracted waves are generated by the incident waves in the absence of the mechanisms generating the radiated waves the radiated waves are generated mainly by the fluctuating pressure acting on the air water interface but slightly affected by the shear stress and velocity of the air flow on the air water interface the following two factors have contributed to the difference in the two velocity fields 1 a constant c f is used in the artificial forchheimer flow method the inhalation process of the air flow is not the exactly same as the exhalation process which makes the c f for each process slightly different as argued in appendix a the artificial forchheimer flow method uses the averaged value of c f which may slightly affect the air pressure during both the inhalation and exhalation periods and thus make the radiated waves obtained by these two methods slightly different 2 in addition to the effect of the air pressure which affect directly the radiated waves the differences in the air flow velocity and shear stress at the air water interface may also slight affect the velocity field of the water motion however these effects are expected to be small thanks to the large difference between the densities of the air and water 4 3 unimportance of air compressibility for small owc models the compressibility of the air in the owc chamber and through the pto is not considered by the current two phase flow model 1 when using an orifice as the pto of an owc the air compressibility is neglected and 2 the influence of the compressibility of the air inside the air chamber is negligible when the height of the air chamber is small the compressibility of the air inside the air chamber can cause a difference between the mass flow rate of the air flow close to the air water interface q m and the mass flow rate through the orifice q m as shown in appendix c the amplitude ratio of q m to q m can be estimated by 32 q 0 q 0 1 1 ε c 2 ε c 4 c f c a 3 π ω 2 a i h c h c a 2 where q 0 and q 0 are the complex amplitudes of q m an q m respectively ω is the wave angular frequency h c h is the height of the air chamber c a is the speed of sound in air c a is the amplification factor defined by eq 25 and a i is the amplitude of the incident waves we can take c a 330 m s and c a 1 for a first cut estimation of q 0 q 0 for the circular owc h c h 0 05m c f 1 4 10 4 ω o 5 s 1 and a i o 0 02m eq 32 gives ε c o 10 3 for the rectangular owc h c h 0 30 m ω o 5 s 1 a i o 0 02m and c f 68 275 16 938 and 7470 for α 0 625 1 25 and 1 875 respectively eq 32 gives ε c o 0 05 for all three opening ratios therefore q 0 q 0 1 0 for both owcs studied here which means the influence of the compressibility of the air inside the air chamber can be ignored for both owcs studied here however for very small opening ratios and much higher air chambers it is possible that the air compressibility needs to be considered for a discussion on the scaling of air compressibility the reader is referred to dimakopoulos et al 2017 5 conclusions air water two phase flow simulations of two owc type wecs with quadratic ptos were performed using two methods to model the ptos the orifice flow method and the artificial forchheimer flow method the artificial forchheimer flow method was validated by comparing with experimental results and the numerical results obtained by the orifice flow method the forchheimer coefficient can be determined by a given quadratic loss coefficient of the pto divided by the thickness of the artificial forchheimer flow region for practical purpose a single forchheimer coefficient can be used for both the air inhalation and exhalation processes as long as the thickness of the artificial forchheimer flow region or the thickness of the orifice plate is not a hundred times larger than the amplitude of the waves both the acceleration of the artificial forchheimer flow and the thickness of the region are not important even though the two methods for modeling the quadratic ptos give very different patterns of the air flow the pneumatic efficiencies obtained using these two methods are very close to each other the velocity fields of the water flow obtained by the two methods are approximately the same especially the instantaneous and mean velocity fields near the bed which are important for local scour around bottom sitting owcs the artificial forchheimer flow method can speed up the simulation for at least 25 times as long as the quadratic loss coefficient is accurate the pneumatic efficiency obtained using the artificial forchheimer flow method is as reliable as that obtained using the orifice flow method since the orifice plates used in owc studies are not standard ones there is a need to establish an accurate relationship between the quadratic loss coefficient and the opening ratio for them by laboratory tests of owcs data availability statement the datasets generated and or analysed during the current study are available from the corresponding author on reasonable request credit authorship contribution statement zhenhua huang conceptualization methodology resources writing original draft writing review editing supervision funding acquisition formal analysis shijie huang investigation visualization validation software writing review editing formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the us national science foundation under grant number cbet 1706938 and the extreme science and engineering discovery environment xsede under grant numbers oce170015 and eng180008 xsede is supported by us national science foundation grant number aci 1548562 any opinions findings and conclusions or recommendations expressed in this material are those of the author s and do not necessarily reflect the views of the national science foundation this is soest contribution no 11225 appendix a expression for c f based on drag coefficient as shown in fig 7 the air inhalation and exhalation processes are not exactly the same this is because there is no lateral boundary to bound the air flow on the outflow side of the orifice plate during the air exhalation period implying that the pressure drop during the air exhalation process and the pressure drop during the air inhalation process may not be exactly the same to derive an expression for the quadratic pressure loss coefficient c f let s define three horizontal surfaces located y y y y and y y c as shown in fig a1 the vena contracta is located at y y c the distance between y and y is scaled by the thickness of the orifice plate the actual locations of y y and y y should be defined in consideration of the size of the vertices generated on both sides of the orifice plate fig a 1 oscillatory air flow through an orifice left panel the air exhalation process right panel the air inhalation process fig a 1 due to the high speed and small diameter of the circular jet flow the pressure across the jet flow of the air is approximately uniform as shown in fig 9 the pressure on the inflow side of the orifice plate is also approximately uniform during the exhalation period the vertical velocity of the air flow through the orifice is positive and the air pressure inside the air chamber is larger than the air pressure outside the chamber the force acting on the orifice plate can be parameterized by the following morison equation a 1 δ p d a c d s s o 1 2 ρ w g w g c m ρ s s o l δ w g t where the integration is over the surface of the orifice plate w g is the velocity of the air flow in the opening δ p p i n p o u t with p i n and p o u t being the dynamic pressures inside and outside the air chamber respectively s o is the area of the orifice s is the cross sectional area of the air chamber c d is a drag coefficient and c m is an added mass coefficient both c m and c d can be functions of the opening ratio α and the reynolds number the fact that the air pressure is approximately uniform on either side of the orifice plate allows for the following approximation to eq a 1 a 2 p i n p o u t c d 1 2 ρ w g 2 c m ρ l δ w g t let the cross sectional average velocity of the air inside the air chamber be w the conservation of mass for the in compressible air gives a 3 s w s o w g or w α w g therefore eq a 2 can be further written as a 4 p i n p o u t 1 2 c f ρ w 2 l α ρ w t where a 5 c f c d α 2 l α c m l δ α during the air inhalation period the vertical velocity of the air flow through the orifice is negative and the air pressure in the air chamber is smaller than the air pressure outside the air chamber similar to the exhalation period the pressure drop during the inhalation period can be parameterized by a 6 p o u t p i n 1 2 c f ρ w 2 l α ρ w t because the velocity is negative during the air inhalation period w w it then follows that eq a 6 can be rewritten as a 7 p i n p o u t 1 2 c f ρ w w ρ l α w t since w 0 during the exhalation period eq a 7 is the same as eq a 4 therefore eq a 7 can be used for both the exhalation and inhalation periods with the understanding that the inhalation and exhalation periods should have different values of c f and l α furthermore effects of reynolds number on c f and l α are expected due to their dependence on the drag and inertia coefficients of the orifice plate the relative importance of the inertia term to the drag term can be estimated by the ratio of these two terms a 8 l α ρ w t 0 5 c f ρ w w o 2 l α c f a i o c m c d 2 α l δ a i which w o ω a i and t o ω have been used normally c d o 1 and c m o 1 if we take c d c m o 1 and a i o 2 l δ the ratio of the inertia term to the drag term is on the order of the opening ratio α which is normally about 0 01 for typical owc problems using different values of c f for the air inhalation and exhalation periods to fit the experimental data of xu et al 2016 the following has been found 1 the c f value for the exhalation period is slightly smaller than that for the inhalation period 2 the average of the c f values for the air inhalation and exhalation periods is close to the value obtained by fitting eq 18 to the measured pressure with a single c f and 3 the two values of c f deviate from their mean by about 7 for practical purposes the effects of the air inhalation and exhalation periods on c f can be ignored and a single c f can be used to model the pressure drop across an orifice if the inertia term and the effects of air inhalation and exhalation process can be neglected eq a 7 can be approximated by a 9 p i n p o u t 1 2 c f ρ w w therefore the quadratic loss coefficient c f can be determined by the resistance coefficient for a thin orifice in a pipe as if the flow is steady this makes it possible to estimate c f using the resistance coefficient of crane 1957 for a steady in compressible flow through a thin orifice in a pipe mei 1992 studied the loss of hydrostatic pressure induced by long water waves through a vertical perforated plate and derived an expression for the pressure drop similar to eq a 7 and obtained an expression for c f which is a function of the flow contraction coefficient c c for long water waves through a vertical perforated plate c f is the same for both the forward and backward flows mei 1992 also argued that the inertia term is not important compared to the quadratic loss term for the oscillatory air flow through a circular sharp edged orifice xu et al 2016 and he and huang 2017 have found that the well known chisholm expression for c c fossa and guglielmini 2002 can provide a good estimation of c c for owc problems appendix b mesh convergence study the mesh dependence study has been done in three steps i the mesh configuration for the empty wave flume ii the local mesh configuration for simulating the owc model using the orifice flow method and iii the local mesh configuration for simulating the owc model using the artificial forchheimer flow method i huang et al 2020 has shown that at the location where the owc model to be installed the mesh configuration for the empty flume can produce the surface elevation in a very good agreement with the theoretical result for second order stokes waves ii in simulating owcs using the orifice flow method a finer grid is needed to resolve the flow through the orifice for the mesh configuration in the vicinity of the orifice xu and huang 2019 examined three sets of mesh configurations in the vicinity of the orifice generated by using oepnfoam s built in snappyhexmesh utility a coarser mesh 1 5 mm 1 5 mm x 1 5 mm the a medium mesh 1 0 mm 1 0 mm x 1 0 mm and a finer mesh 0 5 mm 0 5 mm x 0 5 mm the snappyhexmesh utility takes an already existing mesh and automatically generates refined 3 dimensional meshes containing hexahedra and split hexahedra from triangulated surface geometries of a model xu and huang 2019 used two intermediate meshes between the meshes for the empty flume and the meshes generated by snappyhexmesh to provide a smooth transition and showed that the quadratic loss coefficients obtained using the medium mesh had less than 3 difference from those obtained using the finer mesh a mesh of 0 00125m 0 00125m 0 00125m was adopted here to achieve a balance between computational cost and accuracy iii for the local mesh configuration used in the artificial forchheimer flow method another set of simulation was performed for the circular owc with t 1 2s by reducing the current g 2 mesh by 60 the refined mesh only reduces the pneumatic efficiency by 4 75 the present mesh was chosen to achieve a balance between computational cost and accuracy appendix c calculation of mass flux through the orifice we consider a typical owc air chamber the instantaneous volume of this air chamber is v and the mass of the air inside this air chamber is m ρ v where ρ is the instantaneous density of the air inside the air chamber the mass flux through the orifice s 0 is the time rate of change of m c 1 q m d m d t d d t ρ v the instantaneous volume v can be written as the sum of its initial volume of the air chamber v 0 and the change due to the surface displacement η c 2 v v 0 η d a where v 0 s h c h with s and h c h being the cross sectional area and initial height of the air chamber respectively it then follows that c 3 q m v 0 η s d ρ d t ρ s d η d t η 1 s η d a where η is the cross sectional average of η inside the owc chamber physically q m d m d t is the mass flux at the orifice and q m ρ s d η d t is the mass flux at the air water interface the difference between q m and q m is due to the compressibility of the air in the air chamber for compressible air let ρ ρ 0 ρ with ρ being the change of air density due to a change in pressure we have from eq c 3 c 4 d m d t v 0 η s d ρ d t ρ 0 ρ s d η d t for compressible air the mass fluxes through different cross sections are different assuming ρ ρ 0 and s η v 0 eq c 4 can be linearized to give c 5 q m v 0 d ρ d t q m q m ρ 0 s d η d t for ideal gas and an isentropic process c 6 d p d ρ c a 2 where c a is the sound speed in air it then follows from eq c 6 that c 7 d ρ d t 1 c a 2 d p d t using eq c 7 in eq c 5 gives c 8 q m v 0 c a 2 d p d t q m according to eq 18 the pressure drop across the orifice plate is quadratically related to cross sectional average of the velocity w c 9 p 1 2 c f ρ w w xu et al 2016 has showed that the quadratic pressure drop can be linearized as c 10 p ρ 0 c e w c e q m s and the linear coefficient c e is related to the quadratic loss coefficient c f by c 11 c e c f 2 8 3 π u 0 where u 0 is the amplitude of the oscillatory velocity of the air flow in the air chamber in terms of the amplification factor c a u 0 c a ω a i with a i and ω being the amplitude and angular frequency of the incident waves respectively which means that eq c 11 can be rewritten as c 12 c e 4 3 π c f c a ω a i assuming sinusoidal variations of q m and q m and using eqs c 10 c 12 we can obtain from eq c 8 c 13 q 0 q 0 1 1 ε c 2 ε c ω c e h c h c a 2 4 c f c a 3 π ω 2 a i h c h c a 2 where q 0 and q 0 are the complex amplitudes of q m and q m it is remarked that dimakopoulos et al 2015 expressed ε c as c 14 ε c ω k h c h γ p a t m where k is a linear damping coefficient p a t m 10 5 pa is the atmospheric pressure and γ 1 4 for ideal gas eq c 14 can be obtained from eq c 13 if we use c a 2 γ p a t m ρ 0 for perfect gas and take k ρ 0 c e dimakopoulos et al 2015 used eq c 14 to discuss the effect of air compressibility in a long pipe with an orifice which was used as the pto in the experiment they studied 
20707,this study examines the performance of a numerical method that introduces an artificial sink term to the reynolds averaged navier stokes equations to simulate the flow through an orifice used as a quadratic power takeoff pto for oscillating water columns owcs the method replaces the quadratic pto by an artificial forchheimer flow region referred to as the artificial forchheimer flow method the performance of this method was evaluated by making comparisons with the existing experimental results for two owcs and the numerical results obtained by using air water two phase flow simulations of the air flow through an orifice referred to as the orifice flow method the surface elevations velocity fields and pressure fields obtained by the orifice flow and artificial forchheimer flow methods are compared to use the artificial forchheimer flow method an equation for specifying the forchheimer coefficient is provided and the sensitivity of the pneumatic efficiency to the forchheimer coefficient is discussed it can be concluded that the artificial forchheimer flow method can satisfactorily reproduce the measured pneumatic efficiency pressure field in the air the velocity field in the water and the cross sectional average velocity of the air compared to the orifice flow method the artificial forchheimer flow method can speed up the simulation by at least 25 times keywords wave energy owc pto cfd orifice forchheimer s law 1 introduction renewable energy is of great importance for a sustainable development falcão 2010 lund 2007 among all the renewable energy sources wave energy stands out due to the fact that it is more predictable and has a much higher energy density compared to other renewable energy sources such as wind or solar energy falcão 2010 chen et al 2013 different types of wave energy converters wecs have been proposed in the past to convert the wave energy into other forms of energy such as electrical energy one of the most widely tested and studied wecs is oscillating water columns owcs falcão 2010 aderinto and li 2018 xu and huang 2019 a typical owc device is essentially a partially submerged air chamber which is connected to the atmosphere through a power takeoff pto system aderinto and li 2018 a pto system typically includes a turbine driven by the wave induced oscillatory air flow and an electric generator connected to the turbine for electricity generation one of the key characteristics of a turbine that is relevant to the power extraction efficiency is the pressure drop of the air flow through the turbine two main types of ptos for owcs have been studied in the past scuotto et al 2005 aderinto and li 2018 1 linear ptos characterized by a linear relation between the pressure drop and the mass flow rate of the air flow through a linear turbine such as a wells turbine and 2 quadratic ptos characterized by a quadratic relation between the pressure drop and the mass flow rate of the air flow through a nonlinear turbine such as an impulsive turbine the disadvantages of wells turbines include narrow operational range noisy operations and poor stalling characteristics badhurshah et al 2018 early studies of owcs have focused on wells turbines but some recent studies of owcs focus on impulsive turbines aderinto and li 2018 because of the complexity and high rotation speed of an air turbine it is not practical to model the complex turbine aerodynamics in either small scale model tests or numerical simulations of owc type wecs liu et al 2016 as a result devices other than actual turbines have been used in small scale model tests and numerical simulations in the past to create the required pressure drop of the air flow through a turbine which means the extraction efficiency obtained is just the pneumatic efficiency the final efficiency of an owc type wec is the pneumatic efficiency multiplied by the turbine efficiency and the generator efficiency sharp edged orifices have been widely used to model impulsive turbines in both small scale model tests wang et al 2002 xu et al 2016 ning et al 2016 he and huang 2017 vyzikas et al 2017 and numerical simulations of owcs xu et al 2016 ahmad et al 2018 huang et al 2020 changing the opening ratio i e the ratio of the area of the orifice to the cross sectional area of the air chamber changes the relation between the pressure drop and flow rate therefore the opening ratio can be used as a parameter to describe the relation between the pressure drop and the mass flow rate it has been found that the typical opening ratio should be around 1 to achieve an optimal pneumatic efficiency ning et al 2016 he and huang 2017 several air water two phase flow models have been used to simulate the wave interaction with various owc type wecs where the air flow through an orifice has been used as the pto the small opening ratio can result in an oscillatory jet flow with a very high velocity according to the conservation of mass the velocity of the jet flow is about 100 times faster than the velocity of the free surface fluctuation inside the chamber if the opening ratio is about 1 experimental studies have found that the pressure sensors mounted at different locations on the interior surface of the air chamber gave almost the same time series of the measured pressure he et al 2012 he and huang 2017 since the pressure inside a high speed jet flow is expected to be approximately uniform and equal to the ambient pressures it can be hypothesized that the air pressure inside the air chamber has negligible spatial variation even though the velocity field is not spatially uniform this hypothesis can be easily verified by performing 3d numerical simulations of an owc type wec with an orifice as its pto based on the assumptions that the air pressure is spatially uniform inside the air chamber and the pressure drop across the pto can be parameterized theoretical analyses martins rivas and mei 2009 deng et al 2013 zheng et al 2019 2020 and potential flow based numerical simulations delaurã and lewis 2003 ning et al 2015 have been the two main approaches in the literature to owc problems both approaches are based on potential flow and thus cannot consider viscous effects furthermore theoretical approaches are suitable only for owc wecs with simple geometries air water two phase flow simulations of owc type wecs are getting more attention recently due to the rapid advances in computing technology both in hardware and software these simulations are based on either reynolds averaged navierstokes rans equations huang et al 2019 lópez et al 2014 or large eddy simulation les galera calero et al 2020 simonetti et al 2018 however the requirements of much finer grids and much smaller time steps to simulate the high speed flow through the orifice make the two phase flow simulations computationally very expensive because of the requirement of courant friedrichs lewy condition for numerical stability courant et al 1967 for example huang et al 2019 and huang et al 2020 presented three dimensional 3d two phase flow simulations of a circular owc type wec they reported that about 200 wall clock hours on stampede2 at tacc using 160 cores were typically needed to have about 20 s of real time results this is the reason why most existing two phase flow simulations of owc type wecs in the literature focused mainly on two dimensional 2d problems zhang et al 2012 lópez et al 2014 kamath et al 2015b and only a few 3d simulations shalby et al 2019 xu and huang 2019 are reported in the literature elhanafi et al 2017 performed both 2d and 3d simulations and found 2d simulations could overestimate the pneumatic efficiencies for high wave frequencies because of blockage effects in two phase flow simulations of owc type wecs the bottleneck is the small time step and fine grid required to simulate the air flow through an orifice even for two phase flow simulations of 2d owc type wecs about 30 wall clock hours were needed to produce 20 s of real time results on a workstation with 18 cores huang et al 2020 for the calculation of wave energy extraction efficiency the most important characteristics of a pto system that need to be modeled in a simulation are 1 the difference between the air pressures inside the air chamber and the ambient atmospheric pressure and 2 the cross sectional averaged velocity of the air flow inside the air chamber the pneumatic efficiency is calculated using these two variables martins rivas and mei 2009 deng et al 2013 xu et al 2016 to save on simulation time it is appealing to have a numerical method that can capture the key features of the air flow through an orifice so that the owc s pneumatic efficiency can be computed without the need to simulate the actual jet flow through an orifice attempts have been made in the past to use darcy s law for the flow in a porous medium to simulate the air flow through a linear pto luo et al 2014 kamath et al 2015b a anbarsooz and faramarzi 2016 çelik and altunkaynak 2020 gurnari et al 2020 with the artificial darcy flow coefficient as a tuning parameter to be determined by matching the numerical results with the experimental results for example kamath et al 2015b used the darcy flow through an artificial porous layer in their simulations to represent the linear pto studied theoretically by sarmento and falcão 1985 and experimentally by sarmento 1992 they compared their simulation results with the experimental results of morris thomas et al 2007 who used an orifice plate as the pto in the experiment however some differences between the measured and simulated pressures and surface velocities can be observed most likely because the pressure drop across an orifice is not linearly related to the velocity crane 1957 recently çelik and altunkaynak 2020 used a commercial software to study the resonant frequency and damping ratio of a rectangular owc through free decay tests and compared with physical model tests where the ptos were modeled by either the darcy flow through a porous media or the air flow through an abrupt contraction of a pipe the commercial software they used is the same as that used by mahnamfar and altunkaynak 2017 attempts to use a forchheimer flow to simulate a 3d orifice flow has not been reported in the literature the closest work that can be found in the literature is dimakopoulos et al 2015 who converted a 3d circular orifice opening to a 2d rectangular slot and the 3d circular geometry of the owc chamber to a 2d rectangular one and filled the 2d slot with a porous media to make the slot wider which allowed them to use a larger grid in the vicinity of the slot dimakopoulos et al 2015 hypothesized that the difference between their numerical results and the experimental results for the 1 0 opening ratio was due to the compressibility of the air in the air chamber as pointed out by he and huang 2017 a circular opening may behave differently from a rectangular slot with the same opening ratio therefore it is not clear to what extent converting the 3d geometry to a 2d one may have affected their numerical results because the darcy flow approach to imitate flow through an orifice cannot capture the quadratic pressure drop a key feature of the orifice flow the motivation of this study is to verify a method for speeding up the two phase flow simulations of owc type wecs with a quadratic pto similar to using a darcy flow through a porous media the method examined here adds a sink term to the momentum equation based on forchheimer s law which can give a quadratic pressure loss the method is implemented using the open source cfd tool openfoam weller et al 1998 jacobsen et al 2012 the objectives of this work are to 1 validate the method by comparing with two sets of experimental results and 2 provide detailed comparisons of the results for a circular owc obtained by two methods i the orifice flow method and ii the method using forchheimer s law referred to as the artificial forchheimer flow method to distinguish from the darcy flow method for linear ptos the comparisons focus on the pressure and velocity fields surface elevation and pneumatic efficiency empirical formulas that may be used to estimate the forchheimer coefficient in the absence of experimental data are also discussed 2 methods air water two phase flow simulations of two owc type wecs were performed using the orifice flow method and the artificial forchheimer flow method to model quadratic ptos in both methods both the air and water are treated as in compressible fluids the artificial forchheimer flow method adds a sink term to the momentum equation to produce a pressure drop across the artificial forchheimer flow region which is approximately equal to the pressure drop caused by the air flow through an orifice as a result the forchheimer flow in this method is not the flow in a real porous media because the porosity of real porous medias is not included in the governing equations and thus the flow in this region cannot capture the following features of porous media flows phase saturation relative permeability and the capillary pressure in essence the artificial forchheimer flow region is an artificial damping region designed based on the forchheimer s law 2 1 equations governing in compressible air water two phase flows for completeness the two phase flow models adopted by this study to simulate wave interaction with an owc type wec are summarized here the in compressible reynolds averaged navier stokes equations rans are used to describe the flow of a water air mixture rusche 2003 a vof method is used to track and locate the air water interface by using a volume fraction function s which is the saturation of water s 0 when a cell is occupied by air alone s 1 when a cell is occupied by water alone and 0 s 1 when a cell is occupied by both the air and the water rusche 2003 anywhere in the flow the density ρ and the dynamic viscosity μ f are calculated by 1 ρ s ρ w 1 s ρ a 2 μ f s μ w 1 s μ a where the subscripts w and a stand for water and air respectively the volume fraction function s is governed by the following transport equation 3 s t s u u r s 1 s 0 where u is the velocity of the air water mixture a compression velocity u r is applied in the direction normal to the local air water interface the purpose of using a proper compression velocity is to compress the volume fraction field and maintain a sharp air water interface as a rule the compression velocity is determined by multiplying the maximum velocity magnitude in the computation domain by the normal vector of the air water interface and a constant k c the default value of k c is 1 5 as suggested by rusche 2003 the continuity and momentum equations for the in compressible fluid are 4 u 0 and 5 ρ u t ρ u u t ρ g p μ u where g is the gravitational acceleration p is the total pressure of the air water mixture and 6 μ μ f μ t with μ t being the turbulent eddy viscosity which needs to be closed by a turbulence model the following k ω sst turbulence model larsen and fuhrman 2018 is employed for this purpose 7 ρ k t ρ u k ρ p k ρ β k ω μ f ρ σ k ω k 8 ρ ω t ρ u ω ρ p ω ρ β ω 2 ρ σ d ω k ω t μ f ρ σ k ω ω where k and ω are specific turbulence kinetic energy and specific dissipation rate respectively p k and p ω are production terms for k and ω respectively β β σ σ and σ d are model parameters the turbulent eddy viscosity μ t is then determined by 9 μ t ρ ν t ν t a 1 k m a x a 1 ω f 2 s s a 1 λ 2 β β α s s p ω ω where a 1 and λ 2 are model parameters f 2 is a blending function that is close to 1 in boundary layer region and 0 in free shear layers s is the strain rate tensor defined by s 1 2 u u t and p ω u is 2 times the rotation tensor it is worth noticing that eq 9 is different from the original k ω sst turbulence model in menter 1994 where the last term in m a x is absent the presence of that term can avoid the unphysical generation of turbulence energy in near potential flow regions where p ω s s larsen and fuhrman 2018 the model parameters used in this paper are a 1 0 31 β 0 09 β 0 075 0 0828 σ 0 5 1 0 σ 0 5 0 856 σ d 0 856 λ 2 0 05 the actual values of β σ and σ vary within a range in the computational domain depending on the distance of a grid to the closest wall 2 2 the empty numerical wave tank based on the equations given in section 2 1 a three dimensional 3d numerical wave tank nwt was developed using openfoam v1712 as shown in fig 1 the empty nwt consists of three sections the wave generation section wgs the test section and the wave absorbing section was both the wave generation and wave absorption sections are achieved using a relaxation zone method jacobsen et al 2012 the relaxation zones was implemented using the library waves2foam which is a toolbox used to generate and absorb water waves the length of each relaxation zone is at lest two times the maximum wave length examined in this study as shown in fig 1 the empty nwt is divided into four mesh zones i the air zone ii the free surface zone or the air water interface zone in which the wave crests and wave troughs lie iii the water zone and iv the two relaxation zones the cartesian coordinate system x y z has the x coordinate pointing in the direction of wave propagation the y coordinate pointing vertically upward and the z coordinate pointing out of the paper the origin of this coordinate system is located on the still water surface and at the inlet boundary the information of the grid for each zone is summarized in table 1 referring to fig 1 the height of the nwt is h h a i r with the water depth h 0 29m and h a i r 0 21m and the total length is 14m 6m for the test section and 4m for each relaxation zone the width of the nwt is fixed at 0 5m which was the width of the wave flume in the experiment of xu et al 2016 therefore whatever side effects there might be in the physical model tests will also be present in the two phase flow simulations 1 1 the effects of the sidewalls are expected to be small because 1 the ratio of the flume width to the model dimension is between 4 and 5 and 2 there is no lateral waves excited by the diffraction of fundamental waves the edge of the wave generation zone is at x 4 00m and the edge of the wave absorption zone is at x 10 00m problems of wave interaction with an owc can be studied by integrating into the grids for the test section of the nwt a set of locally nested grids describing the geometry of the owc as described in section 3 1 in a relaxation zone the value of a variable φ e g fluid saturation s or components of velocity u is a blend between the computed value φ c and the targeted value φ t with a relaxation factor β r therefore the value of φ in the relaxation zone can be written as 10 φ β r φ c 1 β r φ t where the relaxation factor β r varies in space and is specified by 11 β r x 1 exp x 3 5 1 exp 1 1 where x x l r with x being the distance relative to the edge of the relaxation zone and l r the length of the relaxation zone jacobsen et al 2012 for wave generation the second order stokes wave theory is used to provide the targeted φ t while for wave absorption φ t 0 is used boundary conditions bcs at the lateral walls the bottom of the wave flume and the owc walls are set to be wall bcs for which the velocity is set to 0 at the boundary ω k and μ t are calculated by applying wall functions and the pressure is taken to be the same as that in the cell next to the wall the methods to specify wall functions used here are described in kalitzin et al 2005 this method does not require the first cell to be in the logarithmic layer therefore y value varies along the boundary depending on the flow field and the mesh used at different boundaries the boundary condition used at the ceiling of the wave flume is the pressure inlet outlet velocity condition provided in openfoam so that the air can get in and out freely through the ceiling 2 3 the circular owc model with an orifice plate as a quadratic pto the circular owc model shown in fig 2 was used to demonstrate the two methods for simulating quadratic ptos the owc model consists of a c shaped support structure a circular owc chamber and a top cover which is a sharp edged orifice plate the owc chamber is partially submerged with a draft d r and the distance between the lower tip of the owc chamber skirt and the bed is d s for a given water depth h the draft of the owc chamber d r h d s the change of quadratic pto s characteristics can be achieved by changing the opening ratio of the orifice plate when the air flows through the orifice there is a pressure drop across the orifice and the pneumatic power extracted from the wave field p o u t is equal to the average work done by the air pressure on the water over n wave periods 12 p o u t 1 n t w t 0 t 0 n t w s p a w a d a d t where p a and w a are the air pressure and vertical velocity respectively s is the cross section of the air chamber on which p a and w a are taken t w is the wave period and t 0 is an arbitrary time reference and n is an integer the pneumatic efficiency of the owc type wec ε is defined by the ratio of the so called capture width λ to the chamber diameter d o w c 13 ε λ d o w c λ p o u t p i where p i is the wave power per unit wave crest in the incident waves for second stokes waves in water of depth h 14 p i e c n 1 k a i 2 ξ 15 e 1 2 ρ w g a i 2 c ω k n 1 2 1 2 k h sinh 2 k h 16 ξ 9 8 n cosh k h sinh 7 k h sinh 4 k h 4 k h 8 sinh 2 k h sinh 2 k h 6 where a i is the amplitude of the first harmonic ω 2 π t w k is the wave number ρ w is the density of water and g is the gravitational acceleration the contribution from the second harmonic wave is small for the present problem less than 1 the model shown in fig 2 has been studied experimentally by xu et al 2016 who also extended the linear potential flow theory of deng et al 2013 by including a quasi linear pto model to calculate the power extraction by an orifice in the experiment of xu et al 2016 the circular orifice had a diameter of 0 014 0 0002m the inner diameter of the owc chamber d was 0 125 0 0005m and the thickness of the wall was 0 003m the uncertainties in the diameter of the opening and the diameter of the owc chamber were estimated based on multiple measurements along different directions from the sizes of the opening and the owc chamber the opening ratio α is in the range of 1 210 and 1 300 with an average value of 1 255 i e α 1 255 0 045 the distance from the lower tip of the owc chamber to the bed d s was 0 25m and the overall height of the owc model was 0 4m two water depths were examined in xu et al 2016 and h 0 29m was used in this study for comparing the results obtained by the two methods for simulating the quadratic pto i e the orifice plate in the experiment 2 4 the orifice flow method in their openfoam based three dimensional 3d two phase flow simulations of the owc shown in fig 2 huang et al 2019 xu and huang 2019 and huang et al 2020 simulated the air flow through the orifice to obtain the characteristics of the quadratic pto because of the small size of the opening and the thin wall in the owc model meshes much finer than the meshes used for the empty flume are needed adjacent to the wall and in the vicinity of the opening for example the smallest mesh generated by using snappyhexmesh to fit the owc model in xu and huang 2019 has the following dimensions 0 001 m 0 001m x 0 001 m which was based on a mesh convergence study see appendix b to achieve a balance between the computational cost and accuracy in this study the smallest mesh generated by using snappyhexmesh to fit the owc model has the following dimensions 0 00125 m 0 0015 m x 0 00125 m for the test conditions examined by xu et al 2016 and xu and huang 2019 the speed of the air flow through the orifice was greater than 10 m s in the experiment for a stable numerical simulation the courant friedrichs lewy cfl condition requires that the following courant number must be smaller than unity 17 c δ t j 1 3 u j δ x j where u j is the magnitude of the j th velocity component δ x j is the grid size of the j th coordinate δ t is the time step xu and huang 2019 and huang et al 2020 found that the courant number must be around 0 4 in general sometimes a value of 0 2 was needed to march the simulation for several time steps to achieve numerical stability 2 2 the computations were performed using multiple nodes on a high performance computing facility the communication between nodes sometimes may cause numerical instability this instability issue is hardware and software dependent when this type of numerical instability occurs our experience is that it may be overcome by marching the simulation for several time steps with a smaller courant number the combination of high speed small mesh size and small courant number results in very small time steps and very long time to run the simulation which makes it impossible to run the simulation on pc or a single workstation the simulations reported in xu and huang 2019 and huang et al 2020 were performed on stampede2 at tacc using 160 cores and 200 wall clock hours were typically needed for about 20 s of numerical results therefore simulating the high speed air flow through a small orifice is the bottleneck in the two phase flow simulations of owcs with an orifice as the pto 2 5 pressure drop across an orifice both physical experiments xu et al 2016 he and huang 2017 and cfd simulations of the air flow through an orifice using the orifice flow method xu and huang 2019 huang et al 2020 have found that the following expression can describe the pressure drop across an orifice plate well 18 p i n p o u t 1 2 c f ρ w w l α ρ w t where p i n and p o u t are the dynamic pressures inside and outside the air chamber respectively w is the cross sectional averaged vertical velocity of the air flow inside the air chamber and c f and l α are two parameters determined by either experiments or numerical simulations the dynamic pressure outside the air chamber p o u t can be set to approximately zero the last term in eq 18 represents the effect of the flow inertia on the pressure drop for the change of hydrodynamic pressure induced by long water waves passing through a perforated plate mei 1992 derived an expression similar to eq 18 unlike in long water waves passing through a perforated plate where the flow pattern for the water moving forward is a mirror image of that for the water moving backward the air inhalation and exhalation processes are slightly different as shown in appendix a this is because the air flow outside the owc chamber is not confined laterally by any boundary while the air flow inside the air chamber is confined by the wall of the air chamber nevertheless both the existing experimental studies xu et al 2016 he and huang 2017 and cfd simulations of the air flow through an orifice using the orifice flow method huang et al 2019 2020 have shown that the inertia term in eq 18 is much smaller than the quadratic loss term for the present problem and eq 18 can provide an adequate description of the air pressure drop across an orifice with a constant c f see appendix a 2 6 parameterization of the orifice flow by an artificial forchheimer flow mathematically the quadratic pto can be represented by the energy loss associated with a quadratic pressure drop between the air chamber and the ambient air which makes it possible to use an artificial forchheimer flow to model a quadratic pto even though the flows during the inhalation and exhalation periods are not exactly the same as shown in appendix a the value of c f for the inhalation period is only slightly different from that for the exhalation period the two values of c f deviate from its mean only by about 7 for the circular owc model shown in fig 2 in the following a constant c f will be assumed 2 6 1 equations for artificial forchheimer flow openfoam allows users to include in eq 5 an empirical sink term s m i e 19 ρ u t ρ u u t ρ g p μ u s m for the sink term s m darcy forchheimer model is one of the models that the user can choose from by setting openfoam s fvoptions file in the system folder for the problem it is stressed that this model employs the porous media analogy but sets the porosity of the porous media to 1 for a homogeneous porous media the following darcy forchheimer equation can be used to model the sink term 20 s m μ f β d 1 2 ρ f u u where β d is a constant darcy s resistance coefficient and f is a constant forchheimer coefficient having a unit of m 1 and both are scalar model parameters for the homogeneous porous media since the porosity is set to unity the model cannot simulate features such as phase saturation relative permeability and the capillary pressure it is because of this reason the method using eq 20 to imitate an orifice plate is referred to an artificial forchheimer flow method in this study to avoid confusion with the real flow in a porous medium it is remarked that dimakopoulos et al 2015 used a different momentum equation which includes the porosity in their momentum equation for the flow in their porous layer but their expression for the sink term is formally the same as eq 20 2 6 2 assumptions behind the artificial forchheimer flow method next we show that using eq 20 can produce the quadratic pressure drop across the orifice plate given by eq 18 by establishing a relationship between the model parameter f in eq 20 and the quadratic loss coefficient of an orifice c f in eq 18 referring to fig 3 the orifice plate is replaced by a region occupied by an artificial forchheimer flow region which is bounded by the owc wall the planes of y y and y y the thickness of this region is h l y r to proceed we assume that i the pressures on the two sides of the orifice plate are almost uniform ii the artificial forchheimer flow is almost parallel to the chamber walls and spatially uniform except in the boundary layer adjacent to the wall iii both the orifice flow method and artificial forchheimer flow method give the same the cross sectional average of the vertical velocity iv the reynolds stress is not important in the artificial forchheimer flow region it will be shown later that the first assumption can be verified by the results obtained by using the orifice flow method the second and third assumptions lead to w w where stands for taking cross sectional average of its argument and make the values of w obtained by the two numerical methods to be approximately the same as a result eq 19 which governs this artificial forchheimer flow can be approximately written as 21 ρ w t p y s m where p p ρ g y is the dynamic pressure w is the velocity in y direction and the source term s m is given by 22 s m μ f β d 1 2 ρ f w w integrating eq 21 from y to y gives 23 h l y r ρ w t p o u t p i n s m h l y r where h l y r is the thickness of this artificial forchheimer flow region comparing eq 23 and eq 18 and taking β d 0 in eq 22 gives 24 f c f h l y r l α h l y r previous studies xu et al 2016 he and huang 2017 huang et al 2019 2020 have shown that the inertia term in eq 18 is not important see also appendix a therefore it is expected that the results should not be sensitive to the thickness of the artificial forchheimer flow region h l y r 2 6 3 summary in order to use the artificial forchheimer flow method to model quadratic ptos the four assumptions listed in section 2 6 2 must be met and the forchheimer coefficient should be determined by f c f h l y r 3 results the performance of the artificial forchheimer flow method is evaluated in this section by comparing with both experimental results and the numerical results obtained by using the orifice flow method in addition to the circular owc shown in fig 2 which has an opening ratio fixed at 1 25 the rectangular owc studied experimentally by he and huang 2017 which has an opening ratio varying in the range of 0 635 and 1 875 is also used to validate the artificial forchheimer flow method all simulations were run on stampede2 at tacc using 160 cores for the circular owc which has a wall thickness of 0 003m simulations using the orifice flow method typically took 200 wall clock hours to obtain about 20s of numerical results while simulations using the artificial forchheimer flow method took only about 8 wall clock hours 3 3 çelik and altunkaynak 2020 reported that a computation time ranging from 24 to 36hrs wall clocktime was needed to obtain about 8s simulation in their simulation of 3d free decay tests it is not clear how many grids what computing facility and how many cores they used in their studies their fig 5 shows the mesh used in their study it seems their mesh is much coarser than ours therefore the artificial forchheimer flow method can speed up the simulation by a factor of about 25 3 1 the circular owc in xu et al 2016 to use the orifice flow method to simulate the air flow through the orifice used as the pto of the circular owc shown in fig 2 a set of nested grids shown in fig 4 are integrated into the grids for the empty nwt to represent the geometry of the owc model the information of the nested grids representing the geometry of the circular owc is summarized in table 2 where b g 1 and b g 2 are the background grids for the empty flume the grid g 1 provides a transition from b g 1 and b g 2 to the inner grid g 2 the integration of the grids g 1 and g 2 into the background grids b g 1 and b g 2 for the empty tank is achieved by using the openfoam s built in mesh utilities refinemesh and snappyhexmesh during the grid refinement an inner most mesh with a multiplayer configuration inside the grid g 2 is automatically generated to capture more geometrical details of the owc model and improve the mesh quality in the present study snappyhexmesh generates a mesh with a two layer configuration the first layer has a thickness of 0 5 times the size of g 2 grid and the second layer has a thickness of 1 2 times the thickness of the first layer to evaluate the performance of the artificial forchheimer flow method the pressure loss coefficient c f obtained by using the orifice flow method was used to determine the forchheimer coefficient f using eq 24 for a given thickness h l y r as will be shown in section 3 5 several thicknesses have been examined and the results have confirmed that the simulated pressure drop and pneumatic efficiency are not sensitive to the thickness of the artificial forchheimer flow region in all examples presented hereinafter h l y r 0 05m was adopted and the grid in the artificial forchheimer flow region is the same as the grid g2 δ x 0 0021m δ y 0 0025m and δ z 0 0031m results presented in section 3 1 are for two wave periods t 1 2s and t 0 8s the c f value used to determine the forchheimer coefficients f by eq 24 is c f 1 40 10 4 which was determined by using the pressure and surface elevation provided by the orifice flow method it is believed that the surface non uniformity inside the owc chamber does not have a significant influence on the determined c f value for this relative long period wave xu and huang 2019 3 1 1 air pressure and surface elevation first we examine the results for the test condition gp1f in xu et al 2016 wave period 1 2s wave height 0 037m and water depth 0 29m the measured and simulated air pressures and surface elevations inside the chamber are compared in fig 5 where the results obtained using the orifice flow method are labeled as orifice the results obtained using the artificial forchheimer flow method are labeled as forchheimer and the results obtained from the physical model test reported in xu et al 2016 are labeled as experiment it can be seen from the comparison that the time series of the air pressures and surface evaluations given by the two numerical methods are nearly identical and both agree well with the experimental results it is remarked that as in the experiment the numerical wave gauges used in the cfd simulations both the orifice flow method and the artificial forchheimer flow method are located at the location 0 037m away from the center axis of the owc chamber in the down wave direction the pressure sensor in the numerical simulation is located at a grid nearest to the location where the pressure sensor was mounted in the experiment on the top of the owc chamber 0 05 m from the orifice center in the up wave direction as will be shown by our numerical results the pressure distribution in the air chamber is almost uniform therefore the exact location of the pressure sensor is immaterial next we examine the results for the test condition gp1b in xu et al 2016 wave period 0 8s wave height 0 037m and water depth 0 29m the measured and simulated air pressures and surface elevations inside the chamber are compared in fig 6 again the numerical results obtained using the artificial forchheimer flow method agree well with the experimental results it can be concluded that the artificial forchheimer flow method and the orifice flow method can produce almost the same surface elevation and air pressure inside the owc chamber it is remarked that in either the orifice flow method or the artificial forchheimer flow method c f is not a turning parameter 3 1 2 velocity field of the air flow it has been assumed in section 2 6 2 that the artificial forchheimer flow is almost uniform spatially which is approximately equal to the cross section average of the velocity obtained by using the orifice flow method these assumptions can be verified by comparing the velocity fields of the air flow obtained by the two numerical methods four snapshots of the velocity fields for the air flow in the plane of symmetry are shown in fig 7 which compares the velocity fields obtained using the artificial forchheimer flow method with those obtained using the orifice flow method the velocity fields obtained by these two methods look very different for the velocity field obtained by using the orifice flow method a jet flow exists during both the air exhalation and inhalation periods the maximum velocity in the jet is as high as 10 m s for velocity field obtained by the artificial forchheimer flow method the air flow indeed is almost uniform spatially in the artificial forchheimer flow region the air flow is also almost uniform spatially in the air chamber except very close to the air water interface where the velocity is determined by the motion of the water surface these results can verify the second assumption made in section 2 6 2 fig 8 shows a comparison between the time series of the velocities averaged over the cross section of the air chamber obtained by the two numerical methods even though the velocity fields obtained by the two numerical methods look very different the velocities averaged over the cross section of the air chamber are almost the same which verifies the third assumption made in section 2 6 2 3 1 3 pressure fields of the air the first assumption in section 2 6 2 is about the pressure on either side of the orifice plate fig 9 shows the pressure fields of the air flow obtained by using both methods it can be seen that the pressure on either side of the orifice plate is approximately uniform even through the velocity field shows the existence of jet flows the pressures on the top and bottom of the artificial forchheimer flow region are also practically uniform instead of a sudden jump in the pressure across the thin orifice plate the pressure in the artificial forchheimer flow is almost uniform on any plane of a constant y and the pressure changes gradually from the pressure inside the air chamber to the atmospheric pressure outside the air chamber in other words the artificial forchheimer flow method only distributes the pressure jump across the orifice plate over the thickness of the artificial forchheimer flow region but keeps the air pressure inside the chamber the same as that for the orifice flow therefore it can be concluded that the first assumption made in section 2 6 2 can be verified by the simulated pressure fields 3 1 4 velocity field around of the skirt of the owc chamber the flow pattern around the skirt of the owc chamber is directly related to the energy loss due to vortex shedding xu et al 2016 huang et al 2020 have shown that the orifice flow method used here can reproduce the velocity fields of the water flow measured by lópez et al 2015 for a 2d owc fig 10 shows four snapshots of the velocity field of the water flow in the plane of symmetry it can be seen by comparing the results obtained by the two methods that the artificial forchheimer flow method can capture the main features of the water flow around the owc chamber skirt well however minor differences do exist especially at the phase a and phase d a discussion of the minor differences in the velocity fields obtained by the two methods is provided in section 4 2 3 1 5 velocity field in horizontal planes the velocity field close to the bed affect the sediment transport and local sour around the owc wec huang et al 2020 fig 11 shows four snapshots of the velocity field of the water flow in the horizontal plane located at 0 1m above the bed the mean flow fields in the last column were calculated by averaging the velocity fields within three wave periods it can be concluded that the artificial forchheimer flow method can capture the key features of the flow fields well in this plane except for some minor differences fig 12 shows four snapshots of the velocity field of the water flow in the horizontal plane located at 0 005m above the bed again the mean flow fields in the last column were calculated by averaging the velocity fields within three wave periods the near bed flow pattern is responsible for local scour around the owc wec huang et al 2020 it can be concluded that the artificial forchheimer flow method can capture the key features of the instantaneous as well as the mean flow field adquately in this plane 3 2 the rectangular owc in he and huang 2017 he and huang 2017 studied the effects of orifice characteristics on the performance of a rectangular owc the owc s pto was modeled using either a circular orifice and a narrow slot three opening ratios were examined 0 625 1 250 and 1 875 six sets of their experimental results for circular orifices were used here to evaluate the performance of the artificial forchheimer flow method the purpose is to demonstrate that the artificial forchheimer flow method can be applied to different opening ratios and different shapes of owcs the demonstration was done under two wave conditions i wave period 1 5s water depth 0 4 m and wave height 0 035m ii wave period 1 0s water depth 0 4m and wave height 0 035m the orifice plate is replaced by an artificial forchheimer flow region which is 0 1m thick and placed at 0 2m above the still water level the value of forchheimer coefficient f for each opening ratio is determined using eq 24 with the values of c f reported in he and huang 2017 since the thickness of the chamber walls used in the experiment was 0 01m it took only about 3 h to obtain 25s of numerical results on the tacc s stampede2 using 160 cores he and huang 2017 reported their results in terms of pneumatic efficiency ε amplification factor c a and pressure coefficient c p the pressure coefficient c p and the amplification factor c a are defined by 25 c p δ p ρ w g h i c a δ η h i where δ p is the difference between the maximum and minimum values of the air pressure inside the air chamber δ η is the difference between the maximum and minimum values of the cross sectional average of the surface elevation inside the chamber h i is the incident wave height and ρ w is the water density the pneumatic efficiency ε has been defined in eq 13 the comparison between the numerical and experimental results c a c p and ε are summarized in table 3 for t 1 5s and in table 4 for t 1 0s in these two tables the first number in the pair n 1 n 2 n 3 is the value reported in he and huang 2017 the second is the value obtained by using the artificial forchheimer flow method and the third number is the relative difference defined by n 3 n 2 n 1 n 1 100 for the case of t 1 5 s the difference between the measured and simulated pneumatic efficiency is less than 0 01 for all three opening ratios with the relative difference being less than 5 less than 2 0 for α 0 625 which provide the best pneumatic efficiency the relative difference between the measured and simulated c p is less than 8 possibly because a constant c f is used for both the inhalation and exhalation processes the relative difference between the measured and simulated c a is about 5 except for the smallest opening ratio which has a relative difference of 16 7 possibly due to the fact that the value of c a for α 0 625 is a bit abnormal in the experiment nevertheless the relative difference between the simulated and measured c a does not significantly affect the pneumatic efficiency because when the cross sectional average of the surface displacement is at either a crest or a trough the average velocity is zero and thus the instantaneous power extraction is also zero at that instant for the case of t 1 0s the simulated c p is always about 9 smaller than the measurement which again is due possibly to the use of a constant c f in the simulation for both the inhalation and exhalation processes the relative difference between the simulated and measured c a is less than 6 for all three opening ratios the relative difference between the simulated and measured efficiency increases with increasing opening ratio even though the largest relative difference between the simulated and measured efficiencies is about 12 for the largest opening ratio which has the lowest pneumatic efficiency but the absolute difference between the simulated and measured efficiencies is less than 0 04 for all three opening ratios the large relative difference for shorter waves might be due to the strong non uniformity of the surface displacement inside the owc chamber which can be caused by sloshing waves or a slight non normal incidence in the experiment sloshing waves can be excited by vortex shedding zhao et al 2014 xu and huang 2019 the effect of non normal incidence for longer waves is expected to be less important compared to shorter waves it is remarked that the difference between the simulated and measured pneumatic efficiencies is not due to the air impressibility in the model tests as argued in section 4 3 it can be concluded that the artificial forchheimer flow method can provide all important key parameters for owcs in reasonable agreement with the measurement for different wave periods and opening ratios 3 3 determination of the quadratic loss coefficient c f for circular orifices to use the artificial forchheimer flow method to speed up the simulation of wave interaction with an owc with an orifice plate as the quadratic pto it is desirable to have a way to provide the value of c f for a given orifice plate without doing either physical model tests or performing simulations using the orifice flow method for the flow of an in compressible fluid through a sharp edged orifice in a pipe the following two empirical formulas can be used to estimate the quadratic loss coefficient c f 1 the formula of crane 1957 which was proposed for steady flow through a sharp edged orifice in a pipe 26 c f 2 72 α 120 r e 1 1 α 1 α 2 1 r e 2500 2 72 α 4000 r e 1 α 1 α 2 1 r e 2500 where α is the opening ratio for a sharp edged circular orifice in a pipe and the reynolds number is defined by r e d w ν where d is the inner diameter of the pipe ν the kinematic viscosity of the air and w the cross sectional average of the air velocity in the chamber 2 the formula of mei 1992 which was derived for the loss of hydrodynamic pressure caused by long water waves through a vertical perforated plate with sharp edged holes 27 c f 1 α c c 1 2 for circular sharp edged orifices the discharge coefficient c c can be determined by the following well known chisholm expression fossa and guglielmini 2002 28 c c 1 0 639 1 α 0 5 1 it is remarked that the expression for c f given by eq 27 together with 28 is a function of the opening ratio only not affected by the reynolds number the reader is referred to xu et al 2016 and xu and huang 2019 for a comparison of the values of c f predicted by eqs 27 and 28 obtained from the experiment and simulated by using the orifice flow method for reynolds number r e 100 and the opening ratio α 10 these two formulas give almost the same result for typical owcs in a laboratory setting r e o 10 3 and α o 1 therefore both formulas can give about the same c f for scaled and full scale models of owc wecs with quadratic ptos the reader is referred to appendix a for details 3 4 sensitivity of the simulated pneumatic efficiency to the forchheimer coefficient f the forchheimer coefficient f is determined by eq 24 therefore the sensitivity to f is basically the sensitivity to the quadratic loss coefficient c f because the numerical results are not sensitive to the thickness of the forchheimer flow region as discussed in section 3 5 when using an empirical formula such as eq 26 or 27 to estimate the quadratic loss coefficient c f for a given opening ratio certain uncertainty in the estimated c f can be expected due to factors such as 1 the treatment of the orifice edges 2 the measurement error in the opening ratio and 3 the suitability of the formula for non standard orifice plates when c f is determined by eq 18 using the measured pressure and surface elevation the determination of cross sectional average velocity becomes a challenge for 3d owcs most existing studied only used one wave gauge to determine the surface elevation inside the owc chamber and obtained the velocity by taking the time derivative of the surface elevation and used this velocity to approximate the cross sectional average velocity this approach may introduce an error to the value of c f determined by using eq 18 especially when the surface non uniformity inside the owc chamber cannot be ignored xu and huang 2019 this means that even the c f values obtained from the scaled model tests on owcs may contain errors xu et al 2016 xu and huang 2019 the sensitivity of an owc s pneumatic efficiency ε to the uncertainty in c f the parameter describing the characteristics of a quadratic pto depends on whether or not the pto has been optimized for the owc to certain extent if the pto has been optimized for the owc then ε c f 0 at the optimal c f in this case the pneumatic efficiency ε is not sensitive to the uncertainty in c f however if the pto has not been optimized then the sensitivity of the owc s pneumatic efficiency ε to c f depends crucially on how far the value of c f is away from the optimal value take the circular owc studied here for example the cross sectional average velocity can be estimated by w o 2 π a i t w where a i is the incident wave amplitude and t w is wave period if we take t w 1 0s a i 0 02m and d 0 125m we have r e 15700 therefore eq 26 or 27 give the same c f the measured opening ratio has an uncertainty introduced when fabricating the model the opening ratio obtained from measuring both the opening and the chamber along several directions is α 0 0125 0 00045 as a result the values of c f estimated by either eq 26 or 27 is in the range of 15 565 and 17 992 with a mean of 16 713 the uncertainty in the c f value obtained using eq 27 is about 7 6 relative to the mean for t 1 2 s xu et al 2016 obtained c f 14 000 based on the surface elevation measured at one location inside the owc chamber the orifice opening was not optimized for the circular owc simulated in this study from our simulation results obtained using c f 14 000 17 000 and 20 000 as inputs to the artificial forchheimer flow method we have ε c f 6 7 10 6 at c f 16 713 the simulated pneumatic efficiency at 17 000 is about 0 19 while the values of c f and ε measured in the experiment are 140 000 and 0 18 respectively meaning that using eq 27 to estimate c f and compute the pneumatic efficiency may give about 7 0 uncertainty in the simulated pneumatic efficiency compared to the measurement in consideration of all possible uncertainties in physical model tests and errors in numerical simulations of orifice flows with very small opening ratios this uncertainty should be acceptable for practical purposes especially for owcs with non rectangular shapes for which accurate measurement of the pneumatic efficiency is difficult due to the non uniformity of the water surface inside the owc chamber for narrow slots he and huang 2017 has found that both the period of the oscillatory flow and the thickness of the orifice plate affect the c f value presently there is no existing expression for c f that can provide a reliable estimation of c f for narrow slots other than those studied by he and huang 2017 it is remarked that the existing expressions for c f discussed here were initially proposed not for orifice plates used in owc model tests the expressions were obtained for either surface waves through perforated slotted barriers or the steady flow through a standard orifice used for flow control in a pipe however the orifices used in the studies of owcs are not standard orifices and involve oscillatory air flows even though several studies in the literature have shown that these expressions for c f can provided a reasonable estimate of c f for a given opening ratio xu et al 2016 he and huang 2017 it is desirable to have a systematic evaluation of the uncertainty in the estimated values of c f for problems that have not been studied in the literature using the orifice flow method to simulate 3d owc problems with orifice plates as ptos can be a very time consuming task if the opening ratio is very small very fine grids are needed in the vicinity of the orifice and very small time steps are needed because the velocity of the air flow through the orifice is very high therefore there is a need to establish an accurate relationship between c f and the opening ratio through laboratory tests of owcs 3 5 effects of the thickness of the artificial forchheimer flow region in numerical simulations h l y r n p δy where n p is the number of the grids in the artificial forchheimer flow region and δ y is the grid size across the region because forchheimer coefficient f is calculated from the value of c f specified by the user 29 f c f n p δ y a larger δ y may result in a larger error in the numerical thickness of the artificial forchheimer flow region which can be translated into a larger error in the forchheimer coefficient f for a given c f as long as δ y is reasonably small relative to the thickness h l y r the numerical results are not sensitive to the thickness of h l y r to demonstrate this two values of h l y r were examined for the circular owc using the same g 2 grid 0 05 and 0 1m the values of the pneumatic efficiency obtained using these two thicknesses are 0 1729 0 1733 respectively 4 discussion 4 1 unimportance of the acceleration and reynolds stress in the artificial forchheimer flow it has been assumed that the acceleration of the artificial forchheimer flow is not important this assumption can be verified by the following order of magnitude estimation the ratio of the inertia force to the forchheimer resistance in eq 23 is 30 ρ w t 0 5 ρ f w w o 2 ω h l y r c f w o 2 h l y r c f a i where the order of magnitude estimation w o ω a i with a i being the amplitude of the incident waves has been used in the experimental study of xu et al 2016 a i o 0 05m α o 0 01 and c f o 1 6 10 4 according to eq 26 therefore as long as the thickness of the artificial forchheimer flow region h l y r a i o 10 4 the local acceleration is not important this means that theoretically speaking the inertia coefficient l α in eq 24 which is equal to the thickness of the artificial forchheimer flow region can be set to any reasonable value it has been assumed that reynolds stress is not important in the artificial forchheimer flow region the ratio of the reynolds stress to the forchheimer resistance can be estimated by 31 β μ μ t u h l y r f u 2 μ t f h l y r u μ t c f ω a i where u ω a i is the scale of u in the artificial forchheimer flow region numerical simulations have found that μ t o 10 4 n s m 2 in the artificial forchheimer flow region take c f 14 000 and a i 0 02m and ω 6 28 rad s eq 31 gives β μ 5 7 10 7 which means that the reynolds stress is not important in the artificial forchheimer flow region 4 2 the minor difference in the flow fields of the water motion obtained by the orifice flow and artificial forchheimer flow methods even though these two methods give very different velocity fields of the air flow they give approximately the same mass flow rate through the pto and the same air pressure inside the air chamber as a result the pneumatic efficiencies obtained by these two methods are close to each other the velocity field inside the air chamber can affect the water flow inside the owc chamber through the kinematic and dynamic boundary conditions at the air water interface inside the owc chamber assuming that the effects of the non linearity and viscosity are small in the problem the flow of the water inside the owc chamber can be theoretically decomposed into i diffracted waves and ii radiated waves the radiated waves are generated by specified conditions on the air water interface in the absence of the incident waves while the diffracted waves are generated by the incident waves in the absence of the mechanisms generating the radiated waves the radiated waves are generated mainly by the fluctuating pressure acting on the air water interface but slightly affected by the shear stress and velocity of the air flow on the air water interface the following two factors have contributed to the difference in the two velocity fields 1 a constant c f is used in the artificial forchheimer flow method the inhalation process of the air flow is not the exactly same as the exhalation process which makes the c f for each process slightly different as argued in appendix a the artificial forchheimer flow method uses the averaged value of c f which may slightly affect the air pressure during both the inhalation and exhalation periods and thus make the radiated waves obtained by these two methods slightly different 2 in addition to the effect of the air pressure which affect directly the radiated waves the differences in the air flow velocity and shear stress at the air water interface may also slight affect the velocity field of the water motion however these effects are expected to be small thanks to the large difference between the densities of the air and water 4 3 unimportance of air compressibility for small owc models the compressibility of the air in the owc chamber and through the pto is not considered by the current two phase flow model 1 when using an orifice as the pto of an owc the air compressibility is neglected and 2 the influence of the compressibility of the air inside the air chamber is negligible when the height of the air chamber is small the compressibility of the air inside the air chamber can cause a difference between the mass flow rate of the air flow close to the air water interface q m and the mass flow rate through the orifice q m as shown in appendix c the amplitude ratio of q m to q m can be estimated by 32 q 0 q 0 1 1 ε c 2 ε c 4 c f c a 3 π ω 2 a i h c h c a 2 where q 0 and q 0 are the complex amplitudes of q m an q m respectively ω is the wave angular frequency h c h is the height of the air chamber c a is the speed of sound in air c a is the amplification factor defined by eq 25 and a i is the amplitude of the incident waves we can take c a 330 m s and c a 1 for a first cut estimation of q 0 q 0 for the circular owc h c h 0 05m c f 1 4 10 4 ω o 5 s 1 and a i o 0 02m eq 32 gives ε c o 10 3 for the rectangular owc h c h 0 30 m ω o 5 s 1 a i o 0 02m and c f 68 275 16 938 and 7470 for α 0 625 1 25 and 1 875 respectively eq 32 gives ε c o 0 05 for all three opening ratios therefore q 0 q 0 1 0 for both owcs studied here which means the influence of the compressibility of the air inside the air chamber can be ignored for both owcs studied here however for very small opening ratios and much higher air chambers it is possible that the air compressibility needs to be considered for a discussion on the scaling of air compressibility the reader is referred to dimakopoulos et al 2017 5 conclusions air water two phase flow simulations of two owc type wecs with quadratic ptos were performed using two methods to model the ptos the orifice flow method and the artificial forchheimer flow method the artificial forchheimer flow method was validated by comparing with experimental results and the numerical results obtained by the orifice flow method the forchheimer coefficient can be determined by a given quadratic loss coefficient of the pto divided by the thickness of the artificial forchheimer flow region for practical purpose a single forchheimer coefficient can be used for both the air inhalation and exhalation processes as long as the thickness of the artificial forchheimer flow region or the thickness of the orifice plate is not a hundred times larger than the amplitude of the waves both the acceleration of the artificial forchheimer flow and the thickness of the region are not important even though the two methods for modeling the quadratic ptos give very different patterns of the air flow the pneumatic efficiencies obtained using these two methods are very close to each other the velocity fields of the water flow obtained by the two methods are approximately the same especially the instantaneous and mean velocity fields near the bed which are important for local scour around bottom sitting owcs the artificial forchheimer flow method can speed up the simulation for at least 25 times as long as the quadratic loss coefficient is accurate the pneumatic efficiency obtained using the artificial forchheimer flow method is as reliable as that obtained using the orifice flow method since the orifice plates used in owc studies are not standard ones there is a need to establish an accurate relationship between the quadratic loss coefficient and the opening ratio for them by laboratory tests of owcs data availability statement the datasets generated and or analysed during the current study are available from the corresponding author on reasonable request credit authorship contribution statement zhenhua huang conceptualization methodology resources writing original draft writing review editing supervision funding acquisition formal analysis shijie huang investigation visualization validation software writing review editing formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the us national science foundation under grant number cbet 1706938 and the extreme science and engineering discovery environment xsede under grant numbers oce170015 and eng180008 xsede is supported by us national science foundation grant number aci 1548562 any opinions findings and conclusions or recommendations expressed in this material are those of the author s and do not necessarily reflect the views of the national science foundation this is soest contribution no 11225 appendix a expression for c f based on drag coefficient as shown in fig 7 the air inhalation and exhalation processes are not exactly the same this is because there is no lateral boundary to bound the air flow on the outflow side of the orifice plate during the air exhalation period implying that the pressure drop during the air exhalation process and the pressure drop during the air inhalation process may not be exactly the same to derive an expression for the quadratic pressure loss coefficient c f let s define three horizontal surfaces located y y y y and y y c as shown in fig a1 the vena contracta is located at y y c the distance between y and y is scaled by the thickness of the orifice plate the actual locations of y y and y y should be defined in consideration of the size of the vertices generated on both sides of the orifice plate fig a 1 oscillatory air flow through an orifice left panel the air exhalation process right panel the air inhalation process fig a 1 due to the high speed and small diameter of the circular jet flow the pressure across the jet flow of the air is approximately uniform as shown in fig 9 the pressure on the inflow side of the orifice plate is also approximately uniform during the exhalation period the vertical velocity of the air flow through the orifice is positive and the air pressure inside the air chamber is larger than the air pressure outside the chamber the force acting on the orifice plate can be parameterized by the following morison equation a 1 δ p d a c d s s o 1 2 ρ w g w g c m ρ s s o l δ w g t where the integration is over the surface of the orifice plate w g is the velocity of the air flow in the opening δ p p i n p o u t with p i n and p o u t being the dynamic pressures inside and outside the air chamber respectively s o is the area of the orifice s is the cross sectional area of the air chamber c d is a drag coefficient and c m is an added mass coefficient both c m and c d can be functions of the opening ratio α and the reynolds number the fact that the air pressure is approximately uniform on either side of the orifice plate allows for the following approximation to eq a 1 a 2 p i n p o u t c d 1 2 ρ w g 2 c m ρ l δ w g t let the cross sectional average velocity of the air inside the air chamber be w the conservation of mass for the in compressible air gives a 3 s w s o w g or w α w g therefore eq a 2 can be further written as a 4 p i n p o u t 1 2 c f ρ w 2 l α ρ w t where a 5 c f c d α 2 l α c m l δ α during the air inhalation period the vertical velocity of the air flow through the orifice is negative and the air pressure in the air chamber is smaller than the air pressure outside the air chamber similar to the exhalation period the pressure drop during the inhalation period can be parameterized by a 6 p o u t p i n 1 2 c f ρ w 2 l α ρ w t because the velocity is negative during the air inhalation period w w it then follows that eq a 6 can be rewritten as a 7 p i n p o u t 1 2 c f ρ w w ρ l α w t since w 0 during the exhalation period eq a 7 is the same as eq a 4 therefore eq a 7 can be used for both the exhalation and inhalation periods with the understanding that the inhalation and exhalation periods should have different values of c f and l α furthermore effects of reynolds number on c f and l α are expected due to their dependence on the drag and inertia coefficients of the orifice plate the relative importance of the inertia term to the drag term can be estimated by the ratio of these two terms a 8 l α ρ w t 0 5 c f ρ w w o 2 l α c f a i o c m c d 2 α l δ a i which w o ω a i and t o ω have been used normally c d o 1 and c m o 1 if we take c d c m o 1 and a i o 2 l δ the ratio of the inertia term to the drag term is on the order of the opening ratio α which is normally about 0 01 for typical owc problems using different values of c f for the air inhalation and exhalation periods to fit the experimental data of xu et al 2016 the following has been found 1 the c f value for the exhalation period is slightly smaller than that for the inhalation period 2 the average of the c f values for the air inhalation and exhalation periods is close to the value obtained by fitting eq 18 to the measured pressure with a single c f and 3 the two values of c f deviate from their mean by about 7 for practical purposes the effects of the air inhalation and exhalation periods on c f can be ignored and a single c f can be used to model the pressure drop across an orifice if the inertia term and the effects of air inhalation and exhalation process can be neglected eq a 7 can be approximated by a 9 p i n p o u t 1 2 c f ρ w w therefore the quadratic loss coefficient c f can be determined by the resistance coefficient for a thin orifice in a pipe as if the flow is steady this makes it possible to estimate c f using the resistance coefficient of crane 1957 for a steady in compressible flow through a thin orifice in a pipe mei 1992 studied the loss of hydrostatic pressure induced by long water waves through a vertical perforated plate and derived an expression for the pressure drop similar to eq a 7 and obtained an expression for c f which is a function of the flow contraction coefficient c c for long water waves through a vertical perforated plate c f is the same for both the forward and backward flows mei 1992 also argued that the inertia term is not important compared to the quadratic loss term for the oscillatory air flow through a circular sharp edged orifice xu et al 2016 and he and huang 2017 have found that the well known chisholm expression for c c fossa and guglielmini 2002 can provide a good estimation of c c for owc problems appendix b mesh convergence study the mesh dependence study has been done in three steps i the mesh configuration for the empty wave flume ii the local mesh configuration for simulating the owc model using the orifice flow method and iii the local mesh configuration for simulating the owc model using the artificial forchheimer flow method i huang et al 2020 has shown that at the location where the owc model to be installed the mesh configuration for the empty flume can produce the surface elevation in a very good agreement with the theoretical result for second order stokes waves ii in simulating owcs using the orifice flow method a finer grid is needed to resolve the flow through the orifice for the mesh configuration in the vicinity of the orifice xu and huang 2019 examined three sets of mesh configurations in the vicinity of the orifice generated by using oepnfoam s built in snappyhexmesh utility a coarser mesh 1 5 mm 1 5 mm x 1 5 mm the a medium mesh 1 0 mm 1 0 mm x 1 0 mm and a finer mesh 0 5 mm 0 5 mm x 0 5 mm the snappyhexmesh utility takes an already existing mesh and automatically generates refined 3 dimensional meshes containing hexahedra and split hexahedra from triangulated surface geometries of a model xu and huang 2019 used two intermediate meshes between the meshes for the empty flume and the meshes generated by snappyhexmesh to provide a smooth transition and showed that the quadratic loss coefficients obtained using the medium mesh had less than 3 difference from those obtained using the finer mesh a mesh of 0 00125m 0 00125m 0 00125m was adopted here to achieve a balance between computational cost and accuracy iii for the local mesh configuration used in the artificial forchheimer flow method another set of simulation was performed for the circular owc with t 1 2s by reducing the current g 2 mesh by 60 the refined mesh only reduces the pneumatic efficiency by 4 75 the present mesh was chosen to achieve a balance between computational cost and accuracy appendix c calculation of mass flux through the orifice we consider a typical owc air chamber the instantaneous volume of this air chamber is v and the mass of the air inside this air chamber is m ρ v where ρ is the instantaneous density of the air inside the air chamber the mass flux through the orifice s 0 is the time rate of change of m c 1 q m d m d t d d t ρ v the instantaneous volume v can be written as the sum of its initial volume of the air chamber v 0 and the change due to the surface displacement η c 2 v v 0 η d a where v 0 s h c h with s and h c h being the cross sectional area and initial height of the air chamber respectively it then follows that c 3 q m v 0 η s d ρ d t ρ s d η d t η 1 s η d a where η is the cross sectional average of η inside the owc chamber physically q m d m d t is the mass flux at the orifice and q m ρ s d η d t is the mass flux at the air water interface the difference between q m and q m is due to the compressibility of the air in the air chamber for compressible air let ρ ρ 0 ρ with ρ being the change of air density due to a change in pressure we have from eq c 3 c 4 d m d t v 0 η s d ρ d t ρ 0 ρ s d η d t for compressible air the mass fluxes through different cross sections are different assuming ρ ρ 0 and s η v 0 eq c 4 can be linearized to give c 5 q m v 0 d ρ d t q m q m ρ 0 s d η d t for ideal gas and an isentropic process c 6 d p d ρ c a 2 where c a is the sound speed in air it then follows from eq c 6 that c 7 d ρ d t 1 c a 2 d p d t using eq c 7 in eq c 5 gives c 8 q m v 0 c a 2 d p d t q m according to eq 18 the pressure drop across the orifice plate is quadratically related to cross sectional average of the velocity w c 9 p 1 2 c f ρ w w xu et al 2016 has showed that the quadratic pressure drop can be linearized as c 10 p ρ 0 c e w c e q m s and the linear coefficient c e is related to the quadratic loss coefficient c f by c 11 c e c f 2 8 3 π u 0 where u 0 is the amplitude of the oscillatory velocity of the air flow in the air chamber in terms of the amplification factor c a u 0 c a ω a i with a i and ω being the amplitude and angular frequency of the incident waves respectively which means that eq c 11 can be rewritten as c 12 c e 4 3 π c f c a ω a i assuming sinusoidal variations of q m and q m and using eqs c 10 c 12 we can obtain from eq c 8 c 13 q 0 q 0 1 1 ε c 2 ε c ω c e h c h c a 2 4 c f c a 3 π ω 2 a i h c h c a 2 where q 0 and q 0 are the complex amplitudes of q m and q m it is remarked that dimakopoulos et al 2015 expressed ε c as c 14 ε c ω k h c h γ p a t m where k is a linear damping coefficient p a t m 10 5 pa is the atmospheric pressure and γ 1 4 for ideal gas eq c 14 can be obtained from eq c 13 if we use c a 2 γ p a t m ρ 0 for perfect gas and take k ρ 0 c e dimakopoulos et al 2015 used eq c 14 to discuss the effect of air compressibility in a long pipe with an orifice which was used as the pto in the experiment they studied 
20708,in this study a convergent two dimensional depth integrated non hydrostatic shallow water model is discretized using the discontinuous galerkin dg method this model can account for the dispersive effects by including a non hydrostatic pressure component and can be used for the simulation of weakly dispersive water waves additionally this model is based on the fractional step method in the first step the traditional nonlinear shallow water model plus a transport equation for vertical momentum is discretized by the dg method and the resulting semi discrete system is evolved in time by the explicit third order strong stability preserving runge kutta ssprk3 method to obtain the provisional solution in the second step the provisional solution is corrected by satisfying a divergence constraint for the velocity the latter step is conducted after application of the dg discretization to an elliptic equation regarding the non hydrostatic pressure both theoretical and experimental tests are carried out to validate the proposed model the results indicate that for smooth problems our model can arrive at a given error tolerance by using a mesh with fewer degrees of freedom dofs at the cost of a smaller cpu time when a higher approximation order is adopted and can properly simulate wave run up diffraction refraction and focusing keywords two dimensional non hydrostatic shallow water model discontinuous galerkin method fractional step method 1 introduction the depth integrated non hydrostatic model is effective for the simulation of tsunami like weakly dispersive wave motion wang et al 2018 and is comparable with or slightly better than models based on the classical boussinesq equations wei and jia 2014 as only the first order derivative of the non hydrostatic pressure is included its governing equation is simple and physically apparent bai 2012 the model has been widely used in surface wave simulations for instance walters 2005 investigated the propagation of a tsunami over the continental shelf yamazaki et al 2010 described bore propagation wave breaking and run up aricò and re 2016 cui et al 2012 fang et al 2015 wei and jia 2014 and wu et al 2020 simulated the motion of nearshore waves the abovementioned numerical models are mainly developed based on nonlinear shallow water equations nswes moreover the fraction step method i e the hydrostatic step and the non hydrostatic step is adopted to advance the models in time in the hydrostatic step the classical nswes are solved to obtain the provisional velocity while the poisson equation deduced from the continuity equation is solved to correct the provisional velocity to satisfy the divergence free constraint in the latter step differences among the presented models mainly lie in two aspects one is whether the convective acceleration terms are included in the vertical momentum equation for most of these studies cui et al 2012 fang et al 2015 walters 2005 wei and jia 2014 wu et al 2020 yamazaki et al 2010 the convective terms are neglected while the investigation by aricò and re 2016 indicated that the model could better reflect the nonlinear processes with these terms added the other aspect is the numerical method adopted previous models have mainly used the traditional finite difference method yamazaki et al 2010 finite element methods walters 2005 wei and jia 2014 and finite volume methods aricò and re 2016 cui et al 2012 fang et al 2015 wu et al 2020 there are only a few non hydrostatic models based on the discontinuous galerkin dg method except for the models in jeschke et al 2017 escalante et al 2019 pan et al 2019 and ran et al 2019 in fact the dg method which is taken as a combination of the finite volume method and finite element method cockburn and shu 2001 has been widely applied in free surface flow problems using the nswe model kesserwani and liang 2015 li and zhang 2020 navas montilla et al 2020 engsig karup et al 2006 engsig karup et al 2008 arnaud and fabien 2015 and duran and marche 2017 also solved boussinesq type equations using the dg method due to its local conservation compactness high order of accuracy and good application to unstructured meshes nevertheless there is no two dimensional depth integrated non hydrostatic model with convective acceleration terms included in the vertical momentum equation based on the dg method therefore we will focus on the development of a depth integrated non hydrostatic model with convective acceleration terms in the vertical momentum equation using the dg method and its application to the simulation of weakly dispersive waves this paper is organized as follows in section two we provide the governing equation of the nswes with the non hydrostatic pressure included then we present the numerical discretization of the governing equations through the dg method in section three numerical tests are given in section four finally conclusions are drawn in section five 2 governing equations the governing equations for the depth integrated non hydrostatic model are as follows 1 d t d u x d v y 0 2 d u t d u 2 1 2 g d 2 x d u v y g d b x d p n h x p n h d 2 b x 3 d v t d u v x d v 2 1 2 g d 2 y g d b y d p n h y p n h d 2 b y 4 d w t d u w x d v w y 2 p n h where d denotes the water depth u v and w are the depth averaged velocities in the x y and z directions respectively p n h is the depth integrated non hydrostatic pressure normalized by the density and b is the elevation of the bottom relative to a datum the convective acceleration terms in the vertical momentum equation i e eq 4 which have been omitted in the traditional depth integrated non hydrostatic model cui et al 2012 fang et al 2015 yamazaki et al 2010 are retained the resulting model better represents the strongly nonlinear processes aricò and re 2016 and is energy consistent bristeau et al 2014 the details of the derivation can be found in bristeau et al 2014 with the introduction of both the non hydrostatic pressure and the vertical velocity the governing equation is not closed the divergence constraint by escalante et al 2017 is used to close the governing equation and this constraint is given as 5 2 d w 2 d v b d v d d d v 0 where v u v and is the two dimensional divergence operator this constraint is a rewriting of the incompressibility condition and is expressed in terms of conserved variables d and d v with such a constraint we do not need to divide the flux term d v by d to obtain the velocity term v since this procedure needs special care when d tends to be zero for convenience of description the final governing equation is rewritten as 6 u t f u s u t n h d q b b b u u b w 0 where u d d u d v d w t represents the conservative variables and f u e u g u t and s u are the flux term and source term respectively for the hydrostatic step and are defined as 7 e u d u d u 2 g d 2 2 d u v d u w g u d v d u v d v 2 g d 2 2 d v w s u 0 g d b x g d b y 0 and t n h d p n h b are the non hydrostatic pressure related terms and are given by 8 t n h d p n h b 0 d p n h x p n h d 2 b x d p n h y p n h d 2 b y 2 p n h in addition b u u b w is the divergence constraint given by eq 5 we note that the flux term and source term defined in eq 7 are retained in the hydrostatic step to provide the provisional solution in the non hydrostatic step the poisson equation deduced from the divergence constraint given by eq 5 and t n h d p n h b are solved to obtain the non hydrostatic pressure which are further substituted back into the non hydrostatic pressure related terms given by eq 8 to correct the provisional solution to obtain the final solution 3 numerical implementation in this section we will detail the implementation of our model based on the dg method we first describe the domain partition and the discontinuous polynomial space related to the numerical discretization then we describe the numerical algorithms related to the hydrostatic part finally the non hydrostatic part of our model follows in fig 1 we outline the steps involved in our numerical model 3 1 domain partition and polynomial space suppose the computational domain ω as shown in fig 2 is partitioned by k non overlapping elements and the partition is denoted by t h ω e e 1 k let ω be the boundary of the computational domain and t h ω e ω e t h be the set of interfaces of all elements where ω e is the boundary of element ω e the unique union of the inner edges for this partition is defined as ε i ω t h and that for boundary edges ω ω e e 1 k is defined as ε b for two elements ω e 1 and ω e 2 sharing an edge we define ε ω e 1 ω e 2 as the unique interior interface between ω e 1 and ω e 2 and we use n and n to indicate the outward unit normal for those two elements on ε in addition we also introduce the following finite dimensional space of polynomials 9 v h s l 2 ω ω e t h s p n ω e where l 2 ω is the space of the square integrable functions and p n ω e is the space of polynomials of order n defined over ω e in this study v h is spanned by n p lagrangian functions φ i i 1 n p and the dimension n p depends on the approximation order and cell type in fig 3 we give the nodal distribution for a triangle and a quadrilateral with approximation order n 1 and n 2 respectively for the scalar field c v h and vector field a v h 2 let c ε and a ε be the traces of c and a on the interface ε from the interior of ω e 1 2 we further define the mean value and jumps for quantity c and a on interface ε as 10 c c ε c ε 2 c c ε n c ε n a a ε a ε 2 a a ε n a ε n on the union of the boundary edges ε b they are defined as 11 c c c c n a a a a n where c and a are single values and n is the outward unit normal on the boundary edges 3 2 numerical discretization of the hydrostatic part for the numerical discretization of the hydrostatic part we consider the dg formulations of the form assuming a local approximate vector solution u h e v h 4 for all υ v h and ω e t h we have 12 ω e u h e t e u h e x g u h e y υ d x ω e s u h e υ d x ω e υ f u h e f ˆ n d x because of the discontinuous nature of the solution the flux is double valued at the element boundary and numerical fluxes f ˆ are introduced to specify the unique value at the element boundary here the harten lax van leer with contact hllc riemann solver is adopted for the calculation of the numerical flux for the hydrostatic part the requirement that eq 12 is valid for all υ v h and can be imposed by considering eq 12 for all the basis functions that span the functional space v h i e setting υ φ i i 1 n p for the discretization of both the volume terms and the surface terms in eq 12 the quadrature free manner proposed by hesthaven and warburton 2008 is adopted we assume that these terms also lie in the finite dimensional space v h 4 and can be expressed as 13 e u h e e h i 1 n p e i φ i g u h e g h i 1 n p g i φ i s u h e s h i 1 n p s i φ i f n f h n f 1 n f p f f n f φ f where φ f f 1 n f p are the basis functions on the element boundaries and n f p is the total number of basis functions along all the boundaries according to this approximation we can obtain the following discrete equation in matrix form 14 m e d u e d t s e x e e s e y g e m e f f e f e n m e s e where m e and s e are the mass and stiffness matrices respectively and can be expressed as 15 m e i j ω e φ i φ j d x m e f i f ω e φ i φ f d x s e x i j ω e φ i φ j x d x s e y i j ω e φ i φ j y d x and the basis coefficients are given as 16 u e u i e i 1 n p e e e u i e i 1 n p g e g u i e i 1 n p f e f u f n f p f 1 n f p e u f e g u f e f 1 n f p s e s u i e i 1 n p to reduce the storage required the reference element ω s t is introduced so that the mass matrices m e and m e f can be expressed onto the reference element and vary only by the constant jacobian values this scheme can be simplified further by interpolating the entries of the stiffness matrix with the basis functions i e 17 s e x i j ω e φ i k 1 n p φ k φ j x x k d x ω s t φ i k 1 n p φ k r x x k φ j r r k s x x k φ j s s k d r d s the same approach is used for s e y then the stiffness matrices can be decomposed as 18 s e x m e r e x d r s e x d s s e y m e r e y d r s e y d s where d r and d s are the differentiation matrices defined in the reference element and their entries are expressed as 19 d r i j φ j r r i d s i j φ j s r i this technique is useful for decreasing the computing cost because the multiplication of the inversed mass matrix with the stiffness matrix can be omitted in discrete form finally an ordinary differential equation can be obtained by inverting the mass matrix as 20 d u e d t l h u e where the operator l h u e t is a nonlinear operator given as 21 l h u e t r e x d r s e x d s e e r e y d r s e y d s g e m e 1 m e f f e f e n s e 3 3 numerical discretization of the non hydrostatic part this section describes the development of the non hydrostatic solution from the nonlinear shallow water results as well as t n h d p n h b defined in eq 8 the integration of the non hydrostatic terms in the horizontal momentum equations is conducted with an implicit euler discretization as 22 u e u e δ t t n h d p n h b where hat denotes the variables calculated at the hydrostatic step and δ t denotes the corresponding time step adopted in the nswes we note that the water depth is not corrected during the non hydrostatic part i e d d the non hydrostatic pressure p n h is calculated implicitly using the divergence constraint given in eq 5 the substitution of eq 22 into eq 5 gives a system of algebraic equations regarding the non hydrostatic pressure as 23 δ t p n h d δ d 2 b d 2 b d 2 b 4 δ t d 2 δ p n h δ t d p n h d d d v d v d 2 b 2 d w where δ is the two dimensional laplacian operator we note that both the first and second order derivatives of the non hydrostatic pressure are included in eq 23 for the discretization of these terms and derivatives about d 2 b d and d v we start from the following elliptic problem 24 δ p n h 0 p n h p d on ω d p n h n p n on ω n where ω d is the dirichlet boundary with respect to the non hydrostatic pressure and ω n is the newman boundary in this study the dirichlet boundary condition is imposed at the wet dry interface the newman boundary condition is imposed at the remainder of the boundaries and both p d and p n are set to zero for the discretization of these terms and derivatives about d 2 b d and d v we start from the following elliptic problem 25 σ 0 in ω σ p n h in ω σ n p n on ω n following the philosophy presented in the numerical discretization of the hydrostatic part we find p h σ h v h v h 2 such that for all ω e t h we have 26 ω e σ h v d x ω e p h v d x ω e p ˆ n h v n d x v v h 2 ω e σ h s d x ω e σ ˆ n s d x s v h here the numerical fluxes σ ˆ and p ˆ n h are approximations to σ p n h and p n h on the boundary of the element ω e respectively these fluxes are given as 27 σ p n h τ p n h p ˆ n h p n h for the interior faces at other boundaries these fluxes are given as 28 σ ˆ p n h τ n p n h p d p ˆ n h p d on ω d σ ˆ p n n p ˆ n h p n h on ω n the penalty parameter τ in the numerical flux is added to penalize the jump between adjacent elements such that the approximate solution is stable according to the explicit expression by shahbazi 2005 the parameter is chosen as 29 τ e p 1 p 2 2 a ω e ω 2 a ω e ω v ω e τ max e τ e where a is the length of the studied edge and v is the area of the studied cell to efficiently form the global sparse matrix corresponding to the second order derivative of non hydrostatic pressure we put the flux form eq 26 into the primal form to do so we sum eq 26 over all elements and obtain the following global expressions 30 ω σ h v d x ω p h h v d x ε i p ˆ n h v d x ω p ˆ n h v n d x v v h 2 ω σ h h s d x ε i σ ˆ s d x ω s σ ˆ n d x s v h where h denotes the broken gradient operator the integration by parts formula is used 31 ω p h h v d x ω v h p h d x ε i p h v p h v d x ω p h v n d x the first equation in eq 30 can be written as 32 ω σ h v d x ω v h p h d x ε i p h v p ˆ n h p h v d x ω p ˆ n h p h v n d x v v h 2 setting v h s and taking the numerical fluxes of eq 27 and eq 28 into eq 32 the second equation in eq 30 can be rewritten as 33 ω e h s h p h d x ε i p h h s d x ω d p d p h h s n d x ε i h p h τ p h s d x ω d s n p h d x ω d τ s p h d x ω d τ s p d d x ω n s p n d x with all terms introduced the discretization of the second order derivative about the non hydrostatic pressure is finished additionally the sparse matrix corresponding to this operator can be set up at the initial stage of the simulation by looping over each element and can be corrected with the wet dry interface considered during the computation for the discretization of the first order operator about the non hydrostatic pressure substituting the flux about p ˆ n h in eq 27 and eq 28 into eq 32 we have 34 ω e σ h v d x ω e v h p h d x ε i p h v d x ω d p d v n d x ω d p h v n d x v v h 2 introduce the lifting operators r l 2 ε i 2 v h 2 and r d l 2 ω d v h 2 35 ω r ϕ v d x ε i ϕ v d x v v h 2 ω r d p v d x ω d p v n d x v v h 2 substitute the lifting operators back into eq 34 we have 36 σ h h p h r p h r d p d p h the first order derivatives of d d v and d 2 b and the second order derivative d 2 b included in eq 23 are all calculated in the spirit of that for the first and second order derivative of the non hydrostatic pressure the only difference is that all the first order derivatives are calculated with the flux in an upwind manner to communicate with adjacent cells while the second order derivative is calculated with the flux in an alternating upwind manner finally the products of different terms in eq 23 are evaluated by the direct products of the interpolant functions at interpolating nodes the derivatives of d d v and d 2 b are calculated at each time step during the computation such that the global sparse stiff matrix and the right hand side in eq 23 can be updated after which the non hydrostatic pressure can be calculated by using a suitable sparse matrix solver with the non hydrostatic pressure being calculated it is substituted back into eq 22 to finish the final non hydrostatic correction during this step all the first order partial derivatives of the non hydrostatic pressure contained in eq 22 are also calculated following the same strategy adopted in eq 26 3 4 time stepping during the discretization presented in the last two sections we arrive at an ordinary differential equation eq 20 for the hydrostatic part and an implicit euler discretization equation eq 22 for the non hydrostatic part to advance the former system a third order strong stability preserving runge kutta method ssprk3 is adopted and implicit time stepping is applied to the latter at each time step the whole strategy is given as 37 u h 1 u h n δ t l h u h n u h 1 u h 1 δ t t n h d 1 p n h 1 b u h 2 3 4 u h n 1 4 u h 1 1 4 δ t l h u h 1 u h 2 u h 2 1 4 δ t t n h d 2 p n h 2 b u h 3 1 3 u h 1 2 3 u h 2 2 3 δ t l h u h 2 u h 3 u h 3 2 3 δ t t n h d 3 p n h 3 b u h n 1 u h 3 where u h n is the variable at the last time step δ t is the time step u h m m 1 2 3 is the provisional solution calculated in the hydrostatic step and u h m m 1 2 3 is the divergence free solution at each time step u h n 1 is the variable at the new time step in this study δ t is calculated as 38 δ t min ω e δ e λ max cfl where δ e is the elemental width and λ max is the maximum eigenvalue of the jacobian of the flux term the counter number cfl is taken as 2 1 n 2 n 1 other time stepping methods for example the second order ssprk scheme ssprk2 are also applicable 4 numerical tests and results in this section several numerical tests are conducted to verify the performance of our proposed numerical model for all the simulations the acceleration due to gravity g is set to 9 81 m s 2 in addition all the simulations are conducted on an intel xeon e5 2620 processor with 16 gb internal memory our program is parallelized using openmp to run on 6 cores and a direct solver is used to invert the global stiff matrix 4 1 1d solitary wave propagation in a channel in the first case we consider a solitary wave in a periodical channel with length l 50 m and depth d 0 1 m this test is a benchmark for the dispersion characteristics of non hydrostatic models owing to the balance between nonlinearity and dispersion the computed solitary wave should maintain its initial profile propagating through the channel when both the friction and viscosity are ignored the initial water surface elevation and the velocity components are prescribed according to the analytical solution derived by bristeau et al 2014 and they are given as 39 d d 0 h sech x c 0 t l 2 u c 0 1 d d w h c 0 d l d sech x c 0 t l sech x c 0 t l p n h h c 0 2 d 2 2 l 2 d 2 2 d 0 d sech x c 0 t l 2 d sech x c 0 t l sech x c 0 t l where h is the initial wave height of the solitary wave f is the derivative of function f and 40 l d 0 h d 0 h c 0 l d g d 0 3 l 2 d 0 2 in eq 40 l is a wavelength related parameter and d is the parameter controlling the celerity and is equal to d 0 in this study for this test the mesh cell number in the x direction is 200 the approximation order is n 1 and the final time is t 10 s the cases with the wave height to the water depth ratio ξ h d 0 0 2 are studied in fig 4 we compare the simulated surface elevations η depth averaged horizontal velocity u vertical velocity w and non hydrostatic pressure with their analytical solution at t 0 5 10 s it takes 8 41 s to finish the simulation as shown in fig 4 our simulation well matches the theoretical solution to further measure the performance of our model we also conducted a series of numerical tests with approximation order n 1 2 3 on a series of meshes with diminishing mesh sizes of 2 1 0 5 and 0 25 the l 2 error defined as 41 l 2 e r r o r 1 e ω e d x e ω e q e p x q e e x a c t x 2 d x 1 2 where q e p x is the numerical solution and q e e x a c t x is the exact solution over ω e is used to indicate the quality of the simulation it is indicated in fig 5 that as the mesh size diminishes the l 2 error also diminishes this result suggests that the numerical model is convergent in addition it is noted that for a given mesh simulations with a higher approximation order tend to have a smaller l 2 error than cases with a lower approximation order at the cost of introducing more degrees of freedom dofs to further understand this influence on the simulation we also give the relation between the normalized simulation time and the l 2 error for all the cases in fig 6 as the results show the greater the number of dofs is the more time is needed for all the simulations since a matrix with a size of dofs dofs has to be inverted at each time step however with higher approximation order adopted we can achieve a given error tolerance with fewer dofs on a coarser mesh this finding indicates that we can obtain a better result at the cost of a smaller cpu time by adopting a higher order approximation which is the case at least for smooth problems differences in the l 2 error among simulations running with different approximation orders are subtle if we further refine the mesh because truncation errors from the solution of the algebraic system dominate under such cases for the effect of the convective acceleration terms included in the vertical momentum equation we also give the results with these terms neglected in fig 4 we can find that there is undulation for these results we also calculate the l 2 error for simulations with convective acceleration terms included the l 2 errors for surface elevation depth averaged horizontal velocity depth averaged vertical velocity and non hydrostatic pressure are 1 19 10 5 3 12 10 5 2 04 10 5 and 2 44 10 5 while the l 2 errors for these variables are 6 34 10 4 1 76 10 3 7 67 10 4 and 1 07 10 3 for simulations without convective acceleration terms it is obvious that the l 2 errors for the latter case are generally one or two orders of magnitude larger than those for the former case 4 2 1d standing wave in a closed channel in the second case a standing wave in a closed channel with a length of 20 m is used to conduct the mesh sensitivity study initially all velocities are set to zero and the initial surface elevation is taken as 42 η a cos π x 10 0 x 20 where a is the amplitude of the standing wave and is set to 0 01 m because the amplitude of the wave is sufficiently small the wave celerity c is calculated according to the linear dispersion relation as 43 c ω k g k tanh k d 0 g λ 2 π tanh 2 π d 0 λ with ω the angular velocity k the wavenumber we manually adjust the water depth such that the numerical result is in phase with the analytical solution and the water depth is finally taken as 7 64 m in this case the wave celerity should be 5 54 we conduct numerical experiments with approximation orders n 1 and 2 on a sequence of meshes the simulations last for 500 s after which the wave forms become permanent in fig 7 we compare the time history of the surface elevation at x 17 5 with the corresponding analytical solution the approximation order is taken as 1 and the cells per wavelength are 10 20 and 40 apparently the amplitude attenuates heavily when the number of cells per wavelength is taken as 10 this attenuation weakens when a higher resolution mesh is adopted in fig 8 we give the same comparison with the approximation order set to 2 and cells per wavelength taken as 5 10 and 20 we note that the same phenomenon can be found i e the amplitude attenuates when a low resolution mesh is used and this attenuation weakens when a mesh with higher resolution is adopted in table 1 we give the attenuation ratio ar of the simulated wave amplitude and cpu time for approximation orders n 1 and n 2 on a sequence of meshes here ar is defined as 44 a r a a a s a a 100 where a a is the analytical wave amplitude and a s is the simulated wave amplitude in this study a s is taken to be the average of the amplitude in the last five periods it is clear that ar decreases as the mesh resolution increases and we can obtain a smaller ar at the cost of a smaller cpu time on a coarser mesh when a higher approximation order is adopted for the simulation of regular waves we think 10 to 20 cells per wavelength is sufficient when approximation order 2 is taken and at least 40 cells per wavelength if approximation order 1 is taken 4 3 solitary wave run up on a vertical wall in this case experiments carried out in a wave flume with a length of 23 2 m at the us army engineer waterways experiment station are simulated briggs et al 1996 a schematic sketch of this flume is given in fig 9 the flume consists of a flat region with length 15 04 m and three other beaches with slopes 1 53 1 150 and 1 13 the vertical wall is located at the end of the last slope these experiments were carried out with still water depth d 0 0 218 m in the flat region ten capacitance wave gauges were taken to capture the water surface elevation along the centreline of the flume following wei and jia 2014 cases with relative wave heights h d 0 0 039 and h d 0 0 264 are considered in this study and are denoted as i and ii respectively the grid resolution is determined such that each wave is depicted by at least one hundred cells and they are selected as δ x 0 05 m and 0 02 m respectively and the approximation order is set to 1 it takes 3 59 min and 23 33 min to run cases i and ii respectively the measured data at gauge 5 provide a reference for the adjustment of the timing of the simulated wave height fig 10 shows the comparison of the simulated and measured wave profiles of different wave gauges for the two cases for case i with a relatively small wave height good agreements between the numerical results and measured data for both incoming and reflected waves are obtained however small discrepancies that may be attributed to weak dispersion are also observed at gauge 7 to gauge 9 and these discrepancies become more obvious at gauge 5 and gauge 6 we attribute this to the fact that energy loss is not considered such that the simulated wave height tends to be larger than the gauged data hence the simulated wave travels faster than the gauged data and the longer it travels the more obvious the discrepancy will be for case ii the same pattern can also be found for the reflected wave notably for this case the wave has already broken just before striking the wall briggs et al 1996 and the related energy dissipation is not considered in the simulation which would also contribute to the discrepancy despite this we note that the leading wave shape of both the incoming wave and the reflected wave simulated by our non hydrostatic model match well with the measured data in addition our model can also reproduce the secondary free surface undulations after wave fission 4 4 2d solitary wave run up a canonical island for the fourth case the physical experiment conducted by briggs et al 1995 is simulated for the validation of run up the location of the gauge points and a sketch of the wave basin are given in fig 11 a 0 625 m high canonical island with diameters of 7 2 m at the base and 2 2 m at the top is centred at point 12 96 13 80 solitary waves with different heights travel from right to left during the physical experiments a setup with still water depths d 0 0 32 m and 0 42 m and relative wave heights h d 0 0 045 0 096 and 0 181 is considered while we only consider the more challenging former setup i e d 0 0 32 m in this study the computational domain is partitioned by uniform quadrilateral elements with size δ x δ y 0 1 m the approximation order n is set to 1 and the vertex based slope limiter by li and zhang 2017 is introduced to suppress the numerical oscillations at the hydrostatic step solitary waves centred at x 0 are imposed according to eq 39 at the beginning of the simulation a sponge layer is placed at the other three boundaries to minimize the reflection from the boundaries it takes approximately 8 24 h to finish this simulation fig 12 shows the comparison between the measured surface elevation and the simulated surface elevation at the 5 gauge points for the three relative wave heights in all cases the model can predict the leading wave at gauge 3 quite well which means that the model can well simulate the solitary wave at a constant water depth for all the other gauge points overall good agreement is achieved between the measured data and the simulated result except for a slightly larger wave height at gauge point 9 for cases h d 0 0 096 and 0 181 and a minor phase error at gauge point 22 for case h d 0 0 181 the same phase error has been observed in other studies e g yamazaki et al 2010 in fig 13 we also give local snapshots of the solitary wave running up the studied canonical island from different angles of view as shown the solitary waves reach and inundate the canonical island first then they diffract around it and two edge waves form later these two edge waves collide at the back side of the island after which these waves travel towards the eastern side of the domain in addition we can find that solitary waves with larger heights seem to travel faster than those with smaller heights and this can be found from eq 39 fig 14 shows a comparison of the simulated maximum run up with the measured run up around the island it is noted that the present model can effectively reproduce the inundation process for case h d 0 0 045 while it shows a slightly larger run up for the other two cases this result may be attributed to the fact that the energy dissipation caused by wave breaking is not considered titov and synolakis 1998 4 5 wave propagation over an elliptic shoal for the last case the wave propagation over a submerged elliptic shoal is modelled to validate the capability of the model for the simulation of wave refraction diffraction and focusing the experimental setup of this case is provided by berkhoff et al 1982 and is shown in fig 15 as shown in fig 15 an elliptic shoal is placed on a slope with gradient 2 a slope oriented coordinate system as shown in fig 15 is set at the elliptic shoal centre with a rotation over 20 coordinates x y in this system are related to the computational coordinates x y through the relation 45 x x x 0 cos 20 y y 0 sin 20 y y y 0 cos 20 x x 0 sin 20 where x 0 y 0 0 0 is the centre of the shoal the position of the shoal is given as 46 x 4 2 y 3 2 1 the thickness of the shoal is defined as 47 d 0 0 3 0 5 1 x 5 2 y 3 75 2 the still water depth without the shoal is given by 48 d 0 max 0 1 0 45 0 02 5 84 y y 5 84 m d 0 0 45 y 5 84 m for the numerical simulation linear wave theory based incident waves with height h 0 0464 m and wave period t 1 s are imposed at the southern boundary corresponding to y 10 m to minimize wave reflection a sponge layer of length 4 m is deployed at the end of the computational domain the other two lateral walls are treated as reflective boundaries the approximation order n is taken as 2 and the whole computational domain consists of 26000 cells with sizes in the x and y directions set to be 0 2 m and 0 1 m respectively the whole simulation lasts for 35 s it takes approximately 10 48 h to run this simulation the three dimensional free surface at t 35 s is shown in fig 16 due to the irregular topography wave diffraction refraction and focusing are formed on the leeward side of the shoal the wave amplitude behind the shoal is approximately two times that of the incoming wave amplitude to provide the details of the simulated results in fig 17 we also present a comparison of the measured relative wave height and the simulated relative wave height at eight cross sections the simulated relative wave height is defined as h 1 h with h 1 being the simulated wave height to identify the effect of the convection terms in the governing equation for the vertical velocity we give the result with and without convection terms the simulated wave height by numerical models is obtained by taking the difference between the maximum and the minimum free surface elevation over the last 5 periods during which the wave form is permanent at cross section 1 the relative wave heights are generally well modelled at cross section 2 a minor discrepancy along the x direction which has also been reported by other studies stelling and zijlema 2003 wei and jia 2014 is found at cross sections 3 to 5 the wave focusing takes effect and the peak wave heights at sections 3 and 4 are well captured but slightly under predicted at section 5 generally the focusing effect behind the shoal sections 3 to 5 is well captured for the longitudinal sections sections 6 to 8 despite minor discrepancies the patterns of the simulated wave heights agree with the experimental data for the comparison of the simulated relative wave height by the model with and without convective terms about the vertical velocity we note that the result by the model with convective terms better agrees with the measured data for all sections at cross sections 1 to 5 the differences between these two models are minor while at longitudinal sections 6 to 8 the differences between these two models are obvious this difference is especially evident for section 6 where the model without the convective terms about the vertical velocity tends to overestimate the relative wave height at the wave trough far more than the current one how the convective terms about the vertical velocity affect the model performance for the multilayer model still needs to be checked in general our model can properly simulate wave diffraction refraction and focusing we attribute the minor discrepancies observed at several peaks and troughs to the depth average of the governing equation which makes it suitable for the simulation of weakly dispersive waves when relatively highly dispersive waves are considered more layers in the vertical direction or a better dispersion relation should be considered 5 conclusion in this paper a convergent two dimensional depth integrated non hydrostatic shallow water model based on the dg method is presented this model is an extension of the nswe model the whole simulation strategy consists of two steps the hydrostatic step and the non hydrostatic step in the first step the nonlinear shallow water equation together with a transport equation about the vertical momentum is discretized by the dg method the semi discrete system is evolved in time by the ssprk3 method to obtain the provisional solution in the second step the provisional solution is corrected by satisfying a divergence constraint for the velocity both theoretical and experimental tests are carried out to validate the developed model the theoretical tests of the solitary wave indicate that our model is convergent and can achieve a balance between the dispersion and nonlinearity and can arrive at a smaller error tolerance by using a mesh with fewer dofs at the cost of a smaller cpu time when a higher approximation order is adopted the model can simulate the wave transformation over a slope and can simulate the wave fission phenomena in addition our model can properly simulate the wave run up furthermore the test of wave propagation over the elliptic shoal indicates that our model with convection terms about vertical velocity can properly simulate wave diffraction refraction and focusing and the model with advection terms about vertical velocity tends to simulate wave motion better than that without those convection terms in summary this model can be used for the simulation of weakly dispersive water waves for the simulation of relatively highly dispersive waves more layers in the vertical direction should be considered this work is ongoing credit authorship contribution statement guoquan ran methodology software validation visualization formal analysis writing original draft qinghe zhang conceptualization writing review editing supervision funding acquisition longxiang li software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the national key research and development program of china grant no 2017yfc1404200 and the joint funds of the national natural science foundation of china u1906231 
20708,in this study a convergent two dimensional depth integrated non hydrostatic shallow water model is discretized using the discontinuous galerkin dg method this model can account for the dispersive effects by including a non hydrostatic pressure component and can be used for the simulation of weakly dispersive water waves additionally this model is based on the fractional step method in the first step the traditional nonlinear shallow water model plus a transport equation for vertical momentum is discretized by the dg method and the resulting semi discrete system is evolved in time by the explicit third order strong stability preserving runge kutta ssprk3 method to obtain the provisional solution in the second step the provisional solution is corrected by satisfying a divergence constraint for the velocity the latter step is conducted after application of the dg discretization to an elliptic equation regarding the non hydrostatic pressure both theoretical and experimental tests are carried out to validate the proposed model the results indicate that for smooth problems our model can arrive at a given error tolerance by using a mesh with fewer degrees of freedom dofs at the cost of a smaller cpu time when a higher approximation order is adopted and can properly simulate wave run up diffraction refraction and focusing keywords two dimensional non hydrostatic shallow water model discontinuous galerkin method fractional step method 1 introduction the depth integrated non hydrostatic model is effective for the simulation of tsunami like weakly dispersive wave motion wang et al 2018 and is comparable with or slightly better than models based on the classical boussinesq equations wei and jia 2014 as only the first order derivative of the non hydrostatic pressure is included its governing equation is simple and physically apparent bai 2012 the model has been widely used in surface wave simulations for instance walters 2005 investigated the propagation of a tsunami over the continental shelf yamazaki et al 2010 described bore propagation wave breaking and run up aricò and re 2016 cui et al 2012 fang et al 2015 wei and jia 2014 and wu et al 2020 simulated the motion of nearshore waves the abovementioned numerical models are mainly developed based on nonlinear shallow water equations nswes moreover the fraction step method i e the hydrostatic step and the non hydrostatic step is adopted to advance the models in time in the hydrostatic step the classical nswes are solved to obtain the provisional velocity while the poisson equation deduced from the continuity equation is solved to correct the provisional velocity to satisfy the divergence free constraint in the latter step differences among the presented models mainly lie in two aspects one is whether the convective acceleration terms are included in the vertical momentum equation for most of these studies cui et al 2012 fang et al 2015 walters 2005 wei and jia 2014 wu et al 2020 yamazaki et al 2010 the convective terms are neglected while the investigation by aricò and re 2016 indicated that the model could better reflect the nonlinear processes with these terms added the other aspect is the numerical method adopted previous models have mainly used the traditional finite difference method yamazaki et al 2010 finite element methods walters 2005 wei and jia 2014 and finite volume methods aricò and re 2016 cui et al 2012 fang et al 2015 wu et al 2020 there are only a few non hydrostatic models based on the discontinuous galerkin dg method except for the models in jeschke et al 2017 escalante et al 2019 pan et al 2019 and ran et al 2019 in fact the dg method which is taken as a combination of the finite volume method and finite element method cockburn and shu 2001 has been widely applied in free surface flow problems using the nswe model kesserwani and liang 2015 li and zhang 2020 navas montilla et al 2020 engsig karup et al 2006 engsig karup et al 2008 arnaud and fabien 2015 and duran and marche 2017 also solved boussinesq type equations using the dg method due to its local conservation compactness high order of accuracy and good application to unstructured meshes nevertheless there is no two dimensional depth integrated non hydrostatic model with convective acceleration terms included in the vertical momentum equation based on the dg method therefore we will focus on the development of a depth integrated non hydrostatic model with convective acceleration terms in the vertical momentum equation using the dg method and its application to the simulation of weakly dispersive waves this paper is organized as follows in section two we provide the governing equation of the nswes with the non hydrostatic pressure included then we present the numerical discretization of the governing equations through the dg method in section three numerical tests are given in section four finally conclusions are drawn in section five 2 governing equations the governing equations for the depth integrated non hydrostatic model are as follows 1 d t d u x d v y 0 2 d u t d u 2 1 2 g d 2 x d u v y g d b x d p n h x p n h d 2 b x 3 d v t d u v x d v 2 1 2 g d 2 y g d b y d p n h y p n h d 2 b y 4 d w t d u w x d v w y 2 p n h where d denotes the water depth u v and w are the depth averaged velocities in the x y and z directions respectively p n h is the depth integrated non hydrostatic pressure normalized by the density and b is the elevation of the bottom relative to a datum the convective acceleration terms in the vertical momentum equation i e eq 4 which have been omitted in the traditional depth integrated non hydrostatic model cui et al 2012 fang et al 2015 yamazaki et al 2010 are retained the resulting model better represents the strongly nonlinear processes aricò and re 2016 and is energy consistent bristeau et al 2014 the details of the derivation can be found in bristeau et al 2014 with the introduction of both the non hydrostatic pressure and the vertical velocity the governing equation is not closed the divergence constraint by escalante et al 2017 is used to close the governing equation and this constraint is given as 5 2 d w 2 d v b d v d d d v 0 where v u v and is the two dimensional divergence operator this constraint is a rewriting of the incompressibility condition and is expressed in terms of conserved variables d and d v with such a constraint we do not need to divide the flux term d v by d to obtain the velocity term v since this procedure needs special care when d tends to be zero for convenience of description the final governing equation is rewritten as 6 u t f u s u t n h d q b b b u u b w 0 where u d d u d v d w t represents the conservative variables and f u e u g u t and s u are the flux term and source term respectively for the hydrostatic step and are defined as 7 e u d u d u 2 g d 2 2 d u v d u w g u d v d u v d v 2 g d 2 2 d v w s u 0 g d b x g d b y 0 and t n h d p n h b are the non hydrostatic pressure related terms and are given by 8 t n h d p n h b 0 d p n h x p n h d 2 b x d p n h y p n h d 2 b y 2 p n h in addition b u u b w is the divergence constraint given by eq 5 we note that the flux term and source term defined in eq 7 are retained in the hydrostatic step to provide the provisional solution in the non hydrostatic step the poisson equation deduced from the divergence constraint given by eq 5 and t n h d p n h b are solved to obtain the non hydrostatic pressure which are further substituted back into the non hydrostatic pressure related terms given by eq 8 to correct the provisional solution to obtain the final solution 3 numerical implementation in this section we will detail the implementation of our model based on the dg method we first describe the domain partition and the discontinuous polynomial space related to the numerical discretization then we describe the numerical algorithms related to the hydrostatic part finally the non hydrostatic part of our model follows in fig 1 we outline the steps involved in our numerical model 3 1 domain partition and polynomial space suppose the computational domain ω as shown in fig 2 is partitioned by k non overlapping elements and the partition is denoted by t h ω e e 1 k let ω be the boundary of the computational domain and t h ω e ω e t h be the set of interfaces of all elements where ω e is the boundary of element ω e the unique union of the inner edges for this partition is defined as ε i ω t h and that for boundary edges ω ω e e 1 k is defined as ε b for two elements ω e 1 and ω e 2 sharing an edge we define ε ω e 1 ω e 2 as the unique interior interface between ω e 1 and ω e 2 and we use n and n to indicate the outward unit normal for those two elements on ε in addition we also introduce the following finite dimensional space of polynomials 9 v h s l 2 ω ω e t h s p n ω e where l 2 ω is the space of the square integrable functions and p n ω e is the space of polynomials of order n defined over ω e in this study v h is spanned by n p lagrangian functions φ i i 1 n p and the dimension n p depends on the approximation order and cell type in fig 3 we give the nodal distribution for a triangle and a quadrilateral with approximation order n 1 and n 2 respectively for the scalar field c v h and vector field a v h 2 let c ε and a ε be the traces of c and a on the interface ε from the interior of ω e 1 2 we further define the mean value and jumps for quantity c and a on interface ε as 10 c c ε c ε 2 c c ε n c ε n a a ε a ε 2 a a ε n a ε n on the union of the boundary edges ε b they are defined as 11 c c c c n a a a a n where c and a are single values and n is the outward unit normal on the boundary edges 3 2 numerical discretization of the hydrostatic part for the numerical discretization of the hydrostatic part we consider the dg formulations of the form assuming a local approximate vector solution u h e v h 4 for all υ v h and ω e t h we have 12 ω e u h e t e u h e x g u h e y υ d x ω e s u h e υ d x ω e υ f u h e f ˆ n d x because of the discontinuous nature of the solution the flux is double valued at the element boundary and numerical fluxes f ˆ are introduced to specify the unique value at the element boundary here the harten lax van leer with contact hllc riemann solver is adopted for the calculation of the numerical flux for the hydrostatic part the requirement that eq 12 is valid for all υ v h and can be imposed by considering eq 12 for all the basis functions that span the functional space v h i e setting υ φ i i 1 n p for the discretization of both the volume terms and the surface terms in eq 12 the quadrature free manner proposed by hesthaven and warburton 2008 is adopted we assume that these terms also lie in the finite dimensional space v h 4 and can be expressed as 13 e u h e e h i 1 n p e i φ i g u h e g h i 1 n p g i φ i s u h e s h i 1 n p s i φ i f n f h n f 1 n f p f f n f φ f where φ f f 1 n f p are the basis functions on the element boundaries and n f p is the total number of basis functions along all the boundaries according to this approximation we can obtain the following discrete equation in matrix form 14 m e d u e d t s e x e e s e y g e m e f f e f e n m e s e where m e and s e are the mass and stiffness matrices respectively and can be expressed as 15 m e i j ω e φ i φ j d x m e f i f ω e φ i φ f d x s e x i j ω e φ i φ j x d x s e y i j ω e φ i φ j y d x and the basis coefficients are given as 16 u e u i e i 1 n p e e e u i e i 1 n p g e g u i e i 1 n p f e f u f n f p f 1 n f p e u f e g u f e f 1 n f p s e s u i e i 1 n p to reduce the storage required the reference element ω s t is introduced so that the mass matrices m e and m e f can be expressed onto the reference element and vary only by the constant jacobian values this scheme can be simplified further by interpolating the entries of the stiffness matrix with the basis functions i e 17 s e x i j ω e φ i k 1 n p φ k φ j x x k d x ω s t φ i k 1 n p φ k r x x k φ j r r k s x x k φ j s s k d r d s the same approach is used for s e y then the stiffness matrices can be decomposed as 18 s e x m e r e x d r s e x d s s e y m e r e y d r s e y d s where d r and d s are the differentiation matrices defined in the reference element and their entries are expressed as 19 d r i j φ j r r i d s i j φ j s r i this technique is useful for decreasing the computing cost because the multiplication of the inversed mass matrix with the stiffness matrix can be omitted in discrete form finally an ordinary differential equation can be obtained by inverting the mass matrix as 20 d u e d t l h u e where the operator l h u e t is a nonlinear operator given as 21 l h u e t r e x d r s e x d s e e r e y d r s e y d s g e m e 1 m e f f e f e n s e 3 3 numerical discretization of the non hydrostatic part this section describes the development of the non hydrostatic solution from the nonlinear shallow water results as well as t n h d p n h b defined in eq 8 the integration of the non hydrostatic terms in the horizontal momentum equations is conducted with an implicit euler discretization as 22 u e u e δ t t n h d p n h b where hat denotes the variables calculated at the hydrostatic step and δ t denotes the corresponding time step adopted in the nswes we note that the water depth is not corrected during the non hydrostatic part i e d d the non hydrostatic pressure p n h is calculated implicitly using the divergence constraint given in eq 5 the substitution of eq 22 into eq 5 gives a system of algebraic equations regarding the non hydrostatic pressure as 23 δ t p n h d δ d 2 b d 2 b d 2 b 4 δ t d 2 δ p n h δ t d p n h d d d v d v d 2 b 2 d w where δ is the two dimensional laplacian operator we note that both the first and second order derivatives of the non hydrostatic pressure are included in eq 23 for the discretization of these terms and derivatives about d 2 b d and d v we start from the following elliptic problem 24 δ p n h 0 p n h p d on ω d p n h n p n on ω n where ω d is the dirichlet boundary with respect to the non hydrostatic pressure and ω n is the newman boundary in this study the dirichlet boundary condition is imposed at the wet dry interface the newman boundary condition is imposed at the remainder of the boundaries and both p d and p n are set to zero for the discretization of these terms and derivatives about d 2 b d and d v we start from the following elliptic problem 25 σ 0 in ω σ p n h in ω σ n p n on ω n following the philosophy presented in the numerical discretization of the hydrostatic part we find p h σ h v h v h 2 such that for all ω e t h we have 26 ω e σ h v d x ω e p h v d x ω e p ˆ n h v n d x v v h 2 ω e σ h s d x ω e σ ˆ n s d x s v h here the numerical fluxes σ ˆ and p ˆ n h are approximations to σ p n h and p n h on the boundary of the element ω e respectively these fluxes are given as 27 σ p n h τ p n h p ˆ n h p n h for the interior faces at other boundaries these fluxes are given as 28 σ ˆ p n h τ n p n h p d p ˆ n h p d on ω d σ ˆ p n n p ˆ n h p n h on ω n the penalty parameter τ in the numerical flux is added to penalize the jump between adjacent elements such that the approximate solution is stable according to the explicit expression by shahbazi 2005 the parameter is chosen as 29 τ e p 1 p 2 2 a ω e ω 2 a ω e ω v ω e τ max e τ e where a is the length of the studied edge and v is the area of the studied cell to efficiently form the global sparse matrix corresponding to the second order derivative of non hydrostatic pressure we put the flux form eq 26 into the primal form to do so we sum eq 26 over all elements and obtain the following global expressions 30 ω σ h v d x ω p h h v d x ε i p ˆ n h v d x ω p ˆ n h v n d x v v h 2 ω σ h h s d x ε i σ ˆ s d x ω s σ ˆ n d x s v h where h denotes the broken gradient operator the integration by parts formula is used 31 ω p h h v d x ω v h p h d x ε i p h v p h v d x ω p h v n d x the first equation in eq 30 can be written as 32 ω σ h v d x ω v h p h d x ε i p h v p ˆ n h p h v d x ω p ˆ n h p h v n d x v v h 2 setting v h s and taking the numerical fluxes of eq 27 and eq 28 into eq 32 the second equation in eq 30 can be rewritten as 33 ω e h s h p h d x ε i p h h s d x ω d p d p h h s n d x ε i h p h τ p h s d x ω d s n p h d x ω d τ s p h d x ω d τ s p d d x ω n s p n d x with all terms introduced the discretization of the second order derivative about the non hydrostatic pressure is finished additionally the sparse matrix corresponding to this operator can be set up at the initial stage of the simulation by looping over each element and can be corrected with the wet dry interface considered during the computation for the discretization of the first order operator about the non hydrostatic pressure substituting the flux about p ˆ n h in eq 27 and eq 28 into eq 32 we have 34 ω e σ h v d x ω e v h p h d x ε i p h v d x ω d p d v n d x ω d p h v n d x v v h 2 introduce the lifting operators r l 2 ε i 2 v h 2 and r d l 2 ω d v h 2 35 ω r ϕ v d x ε i ϕ v d x v v h 2 ω r d p v d x ω d p v n d x v v h 2 substitute the lifting operators back into eq 34 we have 36 σ h h p h r p h r d p d p h the first order derivatives of d d v and d 2 b and the second order derivative d 2 b included in eq 23 are all calculated in the spirit of that for the first and second order derivative of the non hydrostatic pressure the only difference is that all the first order derivatives are calculated with the flux in an upwind manner to communicate with adjacent cells while the second order derivative is calculated with the flux in an alternating upwind manner finally the products of different terms in eq 23 are evaluated by the direct products of the interpolant functions at interpolating nodes the derivatives of d d v and d 2 b are calculated at each time step during the computation such that the global sparse stiff matrix and the right hand side in eq 23 can be updated after which the non hydrostatic pressure can be calculated by using a suitable sparse matrix solver with the non hydrostatic pressure being calculated it is substituted back into eq 22 to finish the final non hydrostatic correction during this step all the first order partial derivatives of the non hydrostatic pressure contained in eq 22 are also calculated following the same strategy adopted in eq 26 3 4 time stepping during the discretization presented in the last two sections we arrive at an ordinary differential equation eq 20 for the hydrostatic part and an implicit euler discretization equation eq 22 for the non hydrostatic part to advance the former system a third order strong stability preserving runge kutta method ssprk3 is adopted and implicit time stepping is applied to the latter at each time step the whole strategy is given as 37 u h 1 u h n δ t l h u h n u h 1 u h 1 δ t t n h d 1 p n h 1 b u h 2 3 4 u h n 1 4 u h 1 1 4 δ t l h u h 1 u h 2 u h 2 1 4 δ t t n h d 2 p n h 2 b u h 3 1 3 u h 1 2 3 u h 2 2 3 δ t l h u h 2 u h 3 u h 3 2 3 δ t t n h d 3 p n h 3 b u h n 1 u h 3 where u h n is the variable at the last time step δ t is the time step u h m m 1 2 3 is the provisional solution calculated in the hydrostatic step and u h m m 1 2 3 is the divergence free solution at each time step u h n 1 is the variable at the new time step in this study δ t is calculated as 38 δ t min ω e δ e λ max cfl where δ e is the elemental width and λ max is the maximum eigenvalue of the jacobian of the flux term the counter number cfl is taken as 2 1 n 2 n 1 other time stepping methods for example the second order ssprk scheme ssprk2 are also applicable 4 numerical tests and results in this section several numerical tests are conducted to verify the performance of our proposed numerical model for all the simulations the acceleration due to gravity g is set to 9 81 m s 2 in addition all the simulations are conducted on an intel xeon e5 2620 processor with 16 gb internal memory our program is parallelized using openmp to run on 6 cores and a direct solver is used to invert the global stiff matrix 4 1 1d solitary wave propagation in a channel in the first case we consider a solitary wave in a periodical channel with length l 50 m and depth d 0 1 m this test is a benchmark for the dispersion characteristics of non hydrostatic models owing to the balance between nonlinearity and dispersion the computed solitary wave should maintain its initial profile propagating through the channel when both the friction and viscosity are ignored the initial water surface elevation and the velocity components are prescribed according to the analytical solution derived by bristeau et al 2014 and they are given as 39 d d 0 h sech x c 0 t l 2 u c 0 1 d d w h c 0 d l d sech x c 0 t l sech x c 0 t l p n h h c 0 2 d 2 2 l 2 d 2 2 d 0 d sech x c 0 t l 2 d sech x c 0 t l sech x c 0 t l where h is the initial wave height of the solitary wave f is the derivative of function f and 40 l d 0 h d 0 h c 0 l d g d 0 3 l 2 d 0 2 in eq 40 l is a wavelength related parameter and d is the parameter controlling the celerity and is equal to d 0 in this study for this test the mesh cell number in the x direction is 200 the approximation order is n 1 and the final time is t 10 s the cases with the wave height to the water depth ratio ξ h d 0 0 2 are studied in fig 4 we compare the simulated surface elevations η depth averaged horizontal velocity u vertical velocity w and non hydrostatic pressure with their analytical solution at t 0 5 10 s it takes 8 41 s to finish the simulation as shown in fig 4 our simulation well matches the theoretical solution to further measure the performance of our model we also conducted a series of numerical tests with approximation order n 1 2 3 on a series of meshes with diminishing mesh sizes of 2 1 0 5 and 0 25 the l 2 error defined as 41 l 2 e r r o r 1 e ω e d x e ω e q e p x q e e x a c t x 2 d x 1 2 where q e p x is the numerical solution and q e e x a c t x is the exact solution over ω e is used to indicate the quality of the simulation it is indicated in fig 5 that as the mesh size diminishes the l 2 error also diminishes this result suggests that the numerical model is convergent in addition it is noted that for a given mesh simulations with a higher approximation order tend to have a smaller l 2 error than cases with a lower approximation order at the cost of introducing more degrees of freedom dofs to further understand this influence on the simulation we also give the relation between the normalized simulation time and the l 2 error for all the cases in fig 6 as the results show the greater the number of dofs is the more time is needed for all the simulations since a matrix with a size of dofs dofs has to be inverted at each time step however with higher approximation order adopted we can achieve a given error tolerance with fewer dofs on a coarser mesh this finding indicates that we can obtain a better result at the cost of a smaller cpu time by adopting a higher order approximation which is the case at least for smooth problems differences in the l 2 error among simulations running with different approximation orders are subtle if we further refine the mesh because truncation errors from the solution of the algebraic system dominate under such cases for the effect of the convective acceleration terms included in the vertical momentum equation we also give the results with these terms neglected in fig 4 we can find that there is undulation for these results we also calculate the l 2 error for simulations with convective acceleration terms included the l 2 errors for surface elevation depth averaged horizontal velocity depth averaged vertical velocity and non hydrostatic pressure are 1 19 10 5 3 12 10 5 2 04 10 5 and 2 44 10 5 while the l 2 errors for these variables are 6 34 10 4 1 76 10 3 7 67 10 4 and 1 07 10 3 for simulations without convective acceleration terms it is obvious that the l 2 errors for the latter case are generally one or two orders of magnitude larger than those for the former case 4 2 1d standing wave in a closed channel in the second case a standing wave in a closed channel with a length of 20 m is used to conduct the mesh sensitivity study initially all velocities are set to zero and the initial surface elevation is taken as 42 η a cos π x 10 0 x 20 where a is the amplitude of the standing wave and is set to 0 01 m because the amplitude of the wave is sufficiently small the wave celerity c is calculated according to the linear dispersion relation as 43 c ω k g k tanh k d 0 g λ 2 π tanh 2 π d 0 λ with ω the angular velocity k the wavenumber we manually adjust the water depth such that the numerical result is in phase with the analytical solution and the water depth is finally taken as 7 64 m in this case the wave celerity should be 5 54 we conduct numerical experiments with approximation orders n 1 and 2 on a sequence of meshes the simulations last for 500 s after which the wave forms become permanent in fig 7 we compare the time history of the surface elevation at x 17 5 with the corresponding analytical solution the approximation order is taken as 1 and the cells per wavelength are 10 20 and 40 apparently the amplitude attenuates heavily when the number of cells per wavelength is taken as 10 this attenuation weakens when a higher resolution mesh is adopted in fig 8 we give the same comparison with the approximation order set to 2 and cells per wavelength taken as 5 10 and 20 we note that the same phenomenon can be found i e the amplitude attenuates when a low resolution mesh is used and this attenuation weakens when a mesh with higher resolution is adopted in table 1 we give the attenuation ratio ar of the simulated wave amplitude and cpu time for approximation orders n 1 and n 2 on a sequence of meshes here ar is defined as 44 a r a a a s a a 100 where a a is the analytical wave amplitude and a s is the simulated wave amplitude in this study a s is taken to be the average of the amplitude in the last five periods it is clear that ar decreases as the mesh resolution increases and we can obtain a smaller ar at the cost of a smaller cpu time on a coarser mesh when a higher approximation order is adopted for the simulation of regular waves we think 10 to 20 cells per wavelength is sufficient when approximation order 2 is taken and at least 40 cells per wavelength if approximation order 1 is taken 4 3 solitary wave run up on a vertical wall in this case experiments carried out in a wave flume with a length of 23 2 m at the us army engineer waterways experiment station are simulated briggs et al 1996 a schematic sketch of this flume is given in fig 9 the flume consists of a flat region with length 15 04 m and three other beaches with slopes 1 53 1 150 and 1 13 the vertical wall is located at the end of the last slope these experiments were carried out with still water depth d 0 0 218 m in the flat region ten capacitance wave gauges were taken to capture the water surface elevation along the centreline of the flume following wei and jia 2014 cases with relative wave heights h d 0 0 039 and h d 0 0 264 are considered in this study and are denoted as i and ii respectively the grid resolution is determined such that each wave is depicted by at least one hundred cells and they are selected as δ x 0 05 m and 0 02 m respectively and the approximation order is set to 1 it takes 3 59 min and 23 33 min to run cases i and ii respectively the measured data at gauge 5 provide a reference for the adjustment of the timing of the simulated wave height fig 10 shows the comparison of the simulated and measured wave profiles of different wave gauges for the two cases for case i with a relatively small wave height good agreements between the numerical results and measured data for both incoming and reflected waves are obtained however small discrepancies that may be attributed to weak dispersion are also observed at gauge 7 to gauge 9 and these discrepancies become more obvious at gauge 5 and gauge 6 we attribute this to the fact that energy loss is not considered such that the simulated wave height tends to be larger than the gauged data hence the simulated wave travels faster than the gauged data and the longer it travels the more obvious the discrepancy will be for case ii the same pattern can also be found for the reflected wave notably for this case the wave has already broken just before striking the wall briggs et al 1996 and the related energy dissipation is not considered in the simulation which would also contribute to the discrepancy despite this we note that the leading wave shape of both the incoming wave and the reflected wave simulated by our non hydrostatic model match well with the measured data in addition our model can also reproduce the secondary free surface undulations after wave fission 4 4 2d solitary wave run up a canonical island for the fourth case the physical experiment conducted by briggs et al 1995 is simulated for the validation of run up the location of the gauge points and a sketch of the wave basin are given in fig 11 a 0 625 m high canonical island with diameters of 7 2 m at the base and 2 2 m at the top is centred at point 12 96 13 80 solitary waves with different heights travel from right to left during the physical experiments a setup with still water depths d 0 0 32 m and 0 42 m and relative wave heights h d 0 0 045 0 096 and 0 181 is considered while we only consider the more challenging former setup i e d 0 0 32 m in this study the computational domain is partitioned by uniform quadrilateral elements with size δ x δ y 0 1 m the approximation order n is set to 1 and the vertex based slope limiter by li and zhang 2017 is introduced to suppress the numerical oscillations at the hydrostatic step solitary waves centred at x 0 are imposed according to eq 39 at the beginning of the simulation a sponge layer is placed at the other three boundaries to minimize the reflection from the boundaries it takes approximately 8 24 h to finish this simulation fig 12 shows the comparison between the measured surface elevation and the simulated surface elevation at the 5 gauge points for the three relative wave heights in all cases the model can predict the leading wave at gauge 3 quite well which means that the model can well simulate the solitary wave at a constant water depth for all the other gauge points overall good agreement is achieved between the measured data and the simulated result except for a slightly larger wave height at gauge point 9 for cases h d 0 0 096 and 0 181 and a minor phase error at gauge point 22 for case h d 0 0 181 the same phase error has been observed in other studies e g yamazaki et al 2010 in fig 13 we also give local snapshots of the solitary wave running up the studied canonical island from different angles of view as shown the solitary waves reach and inundate the canonical island first then they diffract around it and two edge waves form later these two edge waves collide at the back side of the island after which these waves travel towards the eastern side of the domain in addition we can find that solitary waves with larger heights seem to travel faster than those with smaller heights and this can be found from eq 39 fig 14 shows a comparison of the simulated maximum run up with the measured run up around the island it is noted that the present model can effectively reproduce the inundation process for case h d 0 0 045 while it shows a slightly larger run up for the other two cases this result may be attributed to the fact that the energy dissipation caused by wave breaking is not considered titov and synolakis 1998 4 5 wave propagation over an elliptic shoal for the last case the wave propagation over a submerged elliptic shoal is modelled to validate the capability of the model for the simulation of wave refraction diffraction and focusing the experimental setup of this case is provided by berkhoff et al 1982 and is shown in fig 15 as shown in fig 15 an elliptic shoal is placed on a slope with gradient 2 a slope oriented coordinate system as shown in fig 15 is set at the elliptic shoal centre with a rotation over 20 coordinates x y in this system are related to the computational coordinates x y through the relation 45 x x x 0 cos 20 y y 0 sin 20 y y y 0 cos 20 x x 0 sin 20 where x 0 y 0 0 0 is the centre of the shoal the position of the shoal is given as 46 x 4 2 y 3 2 1 the thickness of the shoal is defined as 47 d 0 0 3 0 5 1 x 5 2 y 3 75 2 the still water depth without the shoal is given by 48 d 0 max 0 1 0 45 0 02 5 84 y y 5 84 m d 0 0 45 y 5 84 m for the numerical simulation linear wave theory based incident waves with height h 0 0464 m and wave period t 1 s are imposed at the southern boundary corresponding to y 10 m to minimize wave reflection a sponge layer of length 4 m is deployed at the end of the computational domain the other two lateral walls are treated as reflective boundaries the approximation order n is taken as 2 and the whole computational domain consists of 26000 cells with sizes in the x and y directions set to be 0 2 m and 0 1 m respectively the whole simulation lasts for 35 s it takes approximately 10 48 h to run this simulation the three dimensional free surface at t 35 s is shown in fig 16 due to the irregular topography wave diffraction refraction and focusing are formed on the leeward side of the shoal the wave amplitude behind the shoal is approximately two times that of the incoming wave amplitude to provide the details of the simulated results in fig 17 we also present a comparison of the measured relative wave height and the simulated relative wave height at eight cross sections the simulated relative wave height is defined as h 1 h with h 1 being the simulated wave height to identify the effect of the convection terms in the governing equation for the vertical velocity we give the result with and without convection terms the simulated wave height by numerical models is obtained by taking the difference between the maximum and the minimum free surface elevation over the last 5 periods during which the wave form is permanent at cross section 1 the relative wave heights are generally well modelled at cross section 2 a minor discrepancy along the x direction which has also been reported by other studies stelling and zijlema 2003 wei and jia 2014 is found at cross sections 3 to 5 the wave focusing takes effect and the peak wave heights at sections 3 and 4 are well captured but slightly under predicted at section 5 generally the focusing effect behind the shoal sections 3 to 5 is well captured for the longitudinal sections sections 6 to 8 despite minor discrepancies the patterns of the simulated wave heights agree with the experimental data for the comparison of the simulated relative wave height by the model with and without convective terms about the vertical velocity we note that the result by the model with convective terms better agrees with the measured data for all sections at cross sections 1 to 5 the differences between these two models are minor while at longitudinal sections 6 to 8 the differences between these two models are obvious this difference is especially evident for section 6 where the model without the convective terms about the vertical velocity tends to overestimate the relative wave height at the wave trough far more than the current one how the convective terms about the vertical velocity affect the model performance for the multilayer model still needs to be checked in general our model can properly simulate wave diffraction refraction and focusing we attribute the minor discrepancies observed at several peaks and troughs to the depth average of the governing equation which makes it suitable for the simulation of weakly dispersive waves when relatively highly dispersive waves are considered more layers in the vertical direction or a better dispersion relation should be considered 5 conclusion in this paper a convergent two dimensional depth integrated non hydrostatic shallow water model based on the dg method is presented this model is an extension of the nswe model the whole simulation strategy consists of two steps the hydrostatic step and the non hydrostatic step in the first step the nonlinear shallow water equation together with a transport equation about the vertical momentum is discretized by the dg method the semi discrete system is evolved in time by the ssprk3 method to obtain the provisional solution in the second step the provisional solution is corrected by satisfying a divergence constraint for the velocity both theoretical and experimental tests are carried out to validate the developed model the theoretical tests of the solitary wave indicate that our model is convergent and can achieve a balance between the dispersion and nonlinearity and can arrive at a smaller error tolerance by using a mesh with fewer dofs at the cost of a smaller cpu time when a higher approximation order is adopted the model can simulate the wave transformation over a slope and can simulate the wave fission phenomena in addition our model can properly simulate the wave run up furthermore the test of wave propagation over the elliptic shoal indicates that our model with convection terms about vertical velocity can properly simulate wave diffraction refraction and focusing and the model with advection terms about vertical velocity tends to simulate wave motion better than that without those convection terms in summary this model can be used for the simulation of weakly dispersive water waves for the simulation of relatively highly dispersive waves more layers in the vertical direction should be considered this work is ongoing credit authorship contribution statement guoquan ran methodology software validation visualization formal analysis writing original draft qinghe zhang conceptualization writing review editing supervision funding acquisition longxiang li software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the national key research and development program of china grant no 2017yfc1404200 and the joint funds of the national natural science foundation of china u1906231 
20709,the present work investigates the influence of mooring material on the hydrodynamic responses of a point absorber by experimental tests three taut mooring systems are considered with different materials namely wire nylon and polyester in order to study the influence of mooring material on point absorber hydrodynamic responses the other factors that may influence system dynamics are kept as unchanged as possible during the model tests the pretension of the three mooring systems are set to be similar and the parameters of wave conditions are identical decay tests are conducted to determine the system natural periods and linear damping coefficients in different modes totally seventeen regular wave cases and two irregular wave conditions are tested to study the motion responses of the buoy as well as mooring dynamics the response amplitude operators of motion responses and mooring tensions are obtained by the regular wave model tests three wideband spectral methods as well as two simplified spectral methods are applied to study mooring fatigue damage in the random wave conditions and the results are compared with the estimations of rainflow counting approach it is shown that the α0 75 method provides the most precise estimations of fatigue damage in most mooring cases among spectral methods discussed this study keywords experimental study point absorber taut mooring systems mooring material mooring fatigue damage spectral methods nomenclature wec wave energy converter owc oscillating water column pto power take off calm catenary anchor leg mooring salm single anchor leg mooring rfc rainflow counting raos response amplitude operators k intercept parameter of the t n curve m slope of t n curve u ratio of tension range to the breaking strength of mooring rope λ n nth order spectral moment r tension amplitude d fatigue damage taw wec taut wire mooring system tay wec taut nylon mooring system tap wec taut polyester mooring system φ diameter of wec δ draft of wec h height of wec ε strain ζ linear damping coefficient h s significant wave height t p peak period op1 operation random sea condtions h s 2m t p 5 5s op2 operation random sea condtions h s 2m t p 6 01s tb tovo benasciutti method zb zhao baker method wl wirsching light method alpha α0 75 method 1 introduction in the recent decades the global warming and air pollution due to massive use of fossil fuels are attracting great attention and it has become urgent to develop clean and sustainable energy wave energy carries a high energy density clément et al 2002 and long energy capturing time drew et al 2009 being thus an interesting form to explore portugal is recognized as one of the favourable places to exploit wave energy as the annual wave power in portuguese nearshore is estimated between 30 and 40 kw m silva et al 2015 2018 in addition to the nearshore some portuguese islands shows great potential wave energy density such as azores islands rusu and guedes soares 2012 and madeira islands rusu et al 2008 other islands in neighbouring areas such as uk and ireland guedes soares et al 2014 have also high levels of energy in the south direction cape verde bernardino et al 2017 has lower energy but the canary islands still show high wave energy density with average annual energy availability of 25 30 kw m and the north northwest coast of the islands shows greater energy availability gonçalves et al 2020 a variety of wave energy converter wec concepts have been developed for harvesting wave energy and the development of wecs is associated to the characteristics of the deployment site silva et al 2013 the first generation of wecs are the shoreline static devices mainly the oscillating water columns owcs falcão 2015 rezanejad et al 2013 the second generation of wecs are installed at nearshore which are mostly gravity anchored resting directly on the seabed or fixed to the seabed harris et al 2004 some typical devices are found such as archimedes wave swing a fully submerged heave device prado 2008 nowadays the development of wecs are moving offshore due to the larger energy densities in the offshore areas a variety of floating wecs f wecs have been developed for instance a novel dual chamber floating owc was proposed for energy harvesting rezanejad and guedes soares 2015 and the influence of mooring system on its energy capturing performance was studied xu et al 2020b 2020c according to statistics of wave energy converter development in recent years it is found that the point absorber attracts the most concern lópez et al 2013 the mooring system is an essential component of floating systems different from the traditional offshore structures the mooring system of wecs not only acts as the role to keep wecs on station but it may also affect its energy capturing performance the main difference between mooring design for traditional floating offshore structures and wecs have been discussed extensively by xu et al 2019 since the wecs usually operate in the water depth less than 100m both the taut and the catenary systems have obvious drawbacks for the wec mooring system xu et al 2019 the slack mooring system has the risk to give rise to snap events which could affect the system safety xu et al 2018c 2020d xu and guedes soares 2020a therefore the mooring system should be compliant enough to limit the influence of the mooring system on the energy harvesting activities as well as to reduce extreme mooring loads harris et al 2004 recommend the catenary spread mooring system catenary anchor leg mooring calm system and the single anchor leg mooring salm system for wecs due to their safe station keeping and moderate installation costs by comparing the performance and costs of catenary mooring system taut mooring system and salm for a large wave energy converter thomsen et al 2017 conclude that the salm is the best mooring solution among these three designs because it is the cheapest and compliant enough in addition to the single point mooring systems the hybrid mooring systems ji and yuan 2015 xu et al 2018a 2018b yuan et al 2014 showed good performance in wec applications in the experimental study xu et al 2018c 2020d xu and guedes soares 2020a in addition to the mooring concept the mooring material is another important factor that affects mooring system performance the synthetic fibre rope is receiving great attention in the application to marine renewable energy devices due to its high flexibility wang et al 2019 weller et al 2015 it has been pointed out that low modulus materials such as polyester and nylon ropes are recommended for the wecs mooring applications weller et al 2015 however it indicates that even the polyester rope is stiff for most motion dependent large dimensional wecs and the nylon rope is recommended because it shows even more compliance and good fatigue damage performance ridge et al 2010 xu et al 2019 furthermore the taut nylon mooring system is even much more compliance than the chain catenary mooring system in the shallow water application thomsen et al 2016 recently a superflex rope mooring was numerically and experimentally studied for a wec in ultra shallow water condition huang et al 2018 the results indicate that the superflex rope mooring shows good performance in reducing the maximum transient tension furthermore the wave energy capturing activities are not affected by the mooring system which adopts the superflex ropes it is seen that the elastic mooring has great potential in the wecs application however there is still no study to reveal the differences of wec system dynamics caused by mooring materials and to what extent the mooring material can affect the energy capturing performance of wecs part of the reason is that the synthetic fibre ropes show strong nonlinearities due to the viscoelastic and viscoplastic properties huang et al 2015 lian et al 2018 and there is still no numerical tool that can fully capture these characteristics of fibre mooring ropes when they are coupled to floating structures the fatigue limit states fls design is one of the crucial steps in the mooring design spiral as a consequence the mooring fatigue damage needs to be predicted precisely the rainflow counting technique matsuishi and endo 1968 in conjunction with t n or s n curve is the generally used method in mooring fatigue damage analysis because it provides reasonable estimations of mooring fatigue damage and it is easy to implement the applications of the rainflow counting technique in wec mooring fatigue damage prediction can be found in thies et al 2014 xu and guedes soares 2020a yang et al 2016 2017 and xu et al 2020a study the influence of side mooring on mooring fatigue damage by using rainflow counting of the measured data the short term fatigue damage of wire mooring rope for a point absorber was studied by the rainflow counting and spectral methods and the results showed that the fatigue damage predicted by the wideband spectral methods match well with the rainflow counting results xu and guedes soares 2020b however the mooring tension spectra were derived from the measured mooring tension time series compared with the spectral methods the rainflow counting method is considered as a more accurate approach in structural fatigue damage analysis however it is expensive and time consuming to apply rainflow counting method to analysis mooring fatigue damage since the fully coupled dynamic analysis or experimental tests are needed to obtain the mooring tension time series the fully coupled dynamic simulations in long term mooring fatigue damage assessment is extremely time consuming meanwhile conducting the experimental tests is unrealistic due to massive sea conditions as a consequence the efficient and accurate method for mooring fatigue damage analysis needs to be developed after an extensive review it was concluded that the influence of mooring material on wec system dynamics and an accurate and efficient method for mooring fatigue damage estimations are two issues of concern thus in this study three taut mooring systems of wire polyester and nylon are designed for a point absorber a series of model tests namely decay tests regular wave model tests and irregular wave model tests are conducted to study the influence of elastic material on wec hydrodynamic responses and mooring tensions in addition a time domain method in conjunction with spectral methods is proposed to study mooring fatigue damage it adopts the measured mooring tension response amplitude operators raos and wave spectra to obtain the mooring tension spectra then the mooring fatigue damage is estimated by applying spectral methods to the mooring tension spectrum totally three wideband and two simplified spectral methods are discussed and the accuracy of the proposed method is checked by the rainflow counting method 2 mooring fatigue analysis the t n approach is widely applied to study mooring rope fatigue damage under the combined sea environmental loads the relation between normalized tension range u and the number of loading cycles n causes the cumulative fatigue damage under constant u expressed as 1 n k u m where u is the ratio of tension range to the breaking strength of mooring rope k is the intercept parameter of the t n curve m is the slope of t n curve where both of these two parameters are determined by model tests by applying the palmgren miner rule miner 1945 the accumulated fatigue damage on mooring rope due to different tension cycles is given as 2 d i 1 n c n i n i where n i is the number of cycles within the tension range interval i n i is the number of cycles cause to structural failure at normalized tension range i as given by the t n curve which is determined according to eq 1 n c is the total number of load cycles 2 1 time domain analysis according to eq 2 one of the most crucial steps to evaluate mooring fatigue damage is to estimate the number of load cycles precisely the most direct and precise approach is the time domain analysis i e applying suitable cycle counting methods to derive load cycles and its corresponding number from loading time series there are several counting methods available such as rainflow counting matsuishi and endo 1968 range counting peak counting and level cross counting among these various methods the rainflow counting showed the best performance in estimating fatigue damage dowling 1971 in this study the rainflow counting approach is adopted to estimate mooring fatigue damage in time domain 2 2 spectral methods the time domain analysis presents accurate estimations of the mooring rope fatigue damage however the fully coupled time domain analysis of the floating structure is cumbersome and requires countless calculation efforts on the other hand the spectral methods provide another satisfactory solution to structural damage analysis which is more efficient by invoking eq 1 into eq 2 the expected damage rate is then expressed as 3 d 1 k e i 1 n c u i m n 0 k 0 u m f u u d u where d is the expected damage rare n 0 is mean number of stress cycles for an idealized narrowband gaussian process n 0 ν x 0 τ for a concerned time duration τ ν x 0 is the zero mean upcrossing rate for a zero mean gaussian process the zero mean upcrossing rate can be derived as lutes and sarkani 1997 4 v x 0 1 2 π λ 2 λ 0 where λ n is the nth order spectral moment of stationary stochastic process x t which is calculated as 5 λ n 0 ω n s x ω d ω where ω is the frequency unit rad s s x ω is the one side spectrum the variance of signal x t is expressed as 6 λ 0 σ x 2 furthermore the bandwidth parameter can be calculated by lutes and sarkani 1997 7 α n λ n λ 0 λ 2 n for a narrowband random gaussian process the tension amplitude r follows rayleigh distribution 8 f r r r σ x 2 exp r 2 2 σ x 2 then the structural expected damage rate under a narrowband random gaussian process is expressed in closed form 9 d n b v x 0 k 0 2 r m f r r d r v x 0 k 2 2 σ x m γ m 2 1 however the mooring rope is subjected to combined wave frequency and low frequency loads due to first order and second order wave forces as well as low frequency current and wind forces api 2005 gao and moan 2007 xu and guedes soares 2020a as a consequence the simplified narrow band assumption is not satisfied for mooring tension more sophisticated wideband or combined spectral method gao and moan 2008 jiao and moan 1990 low 2010 is needed in this study different wideband spectral methods are introduced and applied to study mooring damage then the performance of these methods are evaluated by comparing to the fatigue damage results from the rainflow counting approach in time domain 2 2 1 dirlik method an empirical formula was proposed to estimate structural fatigue damage under wideband load dirlik 1985 the rainflow amplitude probabilistic density is approximated by hybrid exponential and two rayleigh distributions 10 f r f c d k r 1 σ x h 1 q e z q h 2 z c 2 e z 2 2 c 2 h 3 z e z 2 2 where z r σ x is the normalized amplitude and 11 h 1 2 x m α 2 2 1 α 2 2 h 2 1 α 2 h 1 h 1 2 1 c h 3 1 h 1 h 2 q 1 25 α 2 h 3 h 2 c h 1 x m λ 1 λ 0 λ 2 λ 4 c α 2 x m h 1 2 1 α 2 h 1 h 1 2 subsequently the expected damage rate estimated by dirlik s formula is derived 12 d d r v p k 2 σ x m h 1 q m γ 1 m 2 m 2 γ 1 m 2 h 2 c m h 3 according to eq 9 the exceedance probability of rainflow loading amplitude is expressed as benasciutti and tovo 2006 13 f r f c d k r h 1 e z q h 2 e z 2 2 c 2 h 3 e z 2 2 2 2 2 tovo benasciutti method it has been proven that there are two bounds for the expected fatigue damage rate caused by rainflow load cycle rychlik 1993 consequently the problem of fatigue damage estimation becomes the problem of finding the proper intermediate point between two bounds the marginal probability density of level crossing amplitude is described as tovo 2002 14 f l c c r α 2 r σ x 2 exp 1 2 z 2 then the expected fatigue damage rate caused by level crossing can be obtained 15 d l c c v x p k 0 2 r m f l c c r d r v x p k α 2 2 2 σ x m γ 1 m 2 where ν x p is the expected rate of occurrence of peaks which is calculated as ν x p 1 2 π λ 4 λ 2 the expected fatigue rate of range mean counting is approximated as 16 d r c v x p k 2 2 α 2 σ x m γ 1 m 2 α 2 m 1 d l c c for the marginal probability density of range mean counting amplitude it was derived as tovo 2002 17 f r c r r σ x 2 α 2 2 exp 1 2 z 2 α 2 2 the rainflow fatigue damage can be approximated by using a weighed combination of two bounds tovo 2002 18 d r f c t b b d l c c 1 b d r c an optimized b value was obtained by benasciutti and tovo 2005 from the spectral density of the process which is written as 19 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 e 2 11 α 2 α 1 α 2 α 2 1 2 according to eq 14 the exceedance probability of level crossing can be derived as 20 f l c c r α 2 exp z 2 2 by integrating eq 17 the exceedance probability of range mean counting amplitude can be obtained 21 f r c r exp 1 2 z 2 α 2 2 similar to the rainflow fatigue damage the exceedance probability of rainflow counting load amplitude can also be witted as a linear combination of f lcc r and f rc r due the linearity 22 f r f c t b r b f l c c r 1 b f r c r 2 2 3 zhao baker method zhao and baker 1992 proposed an empirical equation to describe the probability density function of rainflow load cycle amplitude which combines the two parameter weibull distribution and a rayleigh distribution 23 f r f c z b z w α β z β 1 exp α z β 1 w z exp 0 5 z 2 for a stationary gaussian process the weighting parameter w is obtained when m 1 24 w 1 α 2 1 2 π γ 1 1 β α 1 β the parameter β can be derived according to the bandwidth parameters α 2 25 β 1 1 α 2 0 9 1 1 9 α 2 0 9 α 2 0 9 a simple expression for α is given as 26 α 8 7 α 2 zhao and baker 1992 claimed that these parameters defined above are able to estimate damage with considerable accuracy however this method is not applicable when α 2 0 13 which leads to w 1 benasciutti and tovo 2006 furthermore by noticing that the damage correction factor χ is strongly correlated to α 0 75 other than α 2 an improved expression to get α is also given zhao and baker 1992 it was also proved that the improved expression presents much more accurate fatigue damage result than the simplified one mršnik et al 2013 for m 3 the correction factor is approximated as 27 χ d r f c d n b χ m 3 0 28 α 0 75 0 5 0 4154 1 392 α 0 75 α 0 75 0 5 the parameter α is calculated by the expression α d β where d is the solution of 28 γ 1 3 β 1 α 2 d 3 3 γ 1 1 β χ α 2 1 d 3 π 2 α 2 1 χ 0 however it was pointed out that the w 0 may happen when α 2 0 5 and α 0 75 0 65 benasciutti and tovo 2006 following eq 3 the expected damage rate estimated by zhao baker method zhao and baker 1992 is 29 d r f c z b v x p k 2 σ x m w α m β γ 1 m β 1 w 2 m 2 γ 1 m 2 and the exceedance probability of rainflow counting amplitude approximated is 30 f r f c z b r w exp α z β 1 w exp 0 5 z 2 2 2 4 wirsching light method wirsching and light 1980 proposed an empirical coefficient to correct the narrow band fatigue damage the correction factor is derived by applying monto carlo simulations to different power spectral densities the fatigue damage in wirsching light method is defined as 31 d w l ρ w l d n b 32 ρ w l a w l 1 a w l 1 1 α 2 2 b w l 33 a w l 0 926 0 033 m 34 b w l 1 587 m 2 323 2 2 5 α0 75 method benasciutti 2004 introduced an empirical correction factor to the narrow band fatigue damage so that the wideband fatigue damage is then estimated as 35 d α 0 75 α 0 75 2 d n b this approach has been verified to present good estimations to structural fatigue damage benasciutti and tovo 2006 despite lacking any theoretical explanation 3 experimental methods 3 1 point absorber and pto system the point absorber is designed as a cylinder with the bottom cone and the 1 40 model is shown in fig 1 where fig 1 a is the schematic of point absorber model and fig 1 b shows the model of for hydrodynamic tests it is seen that the height of bottom cone is 75 mm and the total height of the wec model is 500 mm the main parameters of the wec are listed in table 1 where φ is the diameter δ is the free draft of wec without mooring lines being installed rxx ryy rzz are the gyration radius about x y and z axis respectively the height of gravity centre is 163 mm where the base line is located on the bottom of model a simple geometry was chosen to this experimental study as the main interest was the behaviour of the mooring system and thus the dynamics of the floating body should be very easy to predict in this study a square heave plate and linear spring are used to simulate the pto system due to the fact that to scale down the real pto system during the model tests is difficult moura paredes et al 2016 the spring and heave plate play the role to simulate the stiffness and damping of pto system as suggested by yang et al 2018 2020 as shown in fig 2 the steel heave plate was rigidly connected to the wec by an extended steel rod which was fixed on the bottom of the cone the length of steel rod is 500 mm to make the heave plate being submerged deep enough in order to limit influence of wave motion on the heave plate the length and width of the heave plate are 100 mm and the thickness is 1 mm a wire is used to connect the heave plate and spring the total length of wire is 928 6 mm including the length of clump at the both ends of wire to connect heave plate and spring the diameter of wire is 3 5 mm and its mass per unit length in air is 0 108 kg with the clumps considered the stiffness of spring is 29 22n m on the bottom of wave flume a load sensor was installed to measure the wire tension 3 2 taut mooring systems as shown in fig 3 the taut mooring system consists of three mooring ropes with an azimuth angle between each mooring line of 120 two clamps were used to connect the mooring rope to the floor and hook connected to load sensor respectively the model of hook is shown in fig 1 b the length of hook is 65 mm and its weight is 53g in this study three different mooring rope materials namely the wire polyester and nylon are experimentally studied the wire mooring rope used different clamps from synthetic fibre mooring ropes during model tests the length of end and top clamp used in wire mooring tests is 65 mm and 75 mm respectively two identical clamps were installed on both ends of the synthetic fibre mooring ropes whose length is 55 mm hereafter the systems with wire nylon and polyester mooring ropes are named as taw tay and tap respectively the main parameters of the mooring ropes are shown in table 2 where da denotes the nominal diameter w is the mass per unit length in air ea is the axial stiffness the axial stiffness of polyester and nylon rope are estimated based on the measured tension strain curve by the scant method mckenna et al 2004 l e is the effective length of mooring rope without the clamps and hook considered the w d is the water depth it is seen the water depth of wire mooring tests was slightly different to the synthetic fibre rope tests the reason is to adjust the pretension of wire ropes to make it as close as to the values used in the fibre rope tests the pretension of each mooring rope is summarized in table 3 where it is found that the pretension of these three mooring ropes are very close however there s still some difference of pretension between each mooring rope which would give rise to the difference of mooring dynamics it is difficult to adjust the pretension of these difficult mooring ropes to be identical part of the reason is that a great pretension was adopted in the model tests and the system was very stiff as a consequence it is not easy to adjust the pretension besides the viscoelastic and viscoplastic characteristics of synthetic ropes also give rise to difficulties in adjusting mooring pretension the tension extension characteristics of synthetic fibre ropes were tested in tianjin university and fig 4 shows the experimental system the loading element the equipment foundation the measurement system and the water cycling system constitute the experimental system for testing fibre ropes the loading system is composed of static and dynamic ones the cyclic loading on the rope is applied by utilizing centric slider crank mechanism as the driving source converting the rotary motion of the eccentric wheel to the reciprocating motion of the big sliding block lian et al 2017 by taking the advantage of the centric slider crank mechanism a standard simple harmonic motion of the sliding can be obtained the amplitude of harmonic motion is set by adjusting the length of crank which can be adjusted between 0 and 0 3m as shown in fig 4 a water cycling system is applied to simulate working environment of mooring rope in order to make sure that the tested sample will be always immersed in the water during the tests two water pumps are utilized to pump water from outer tank into inner tank to maintain a sufficient water level in the inner tank the length of inner tank is 65 cm as seen in fig 4 b an elongation measurement system is designed which consists of the wire transducer axletrees two sliding blocks and two clamps two parallel axletrees are installed above the water tanks on the axletrees there are two sliding blocks one of which is used as the base for the wire transducer and the other is used to fix the wire under sliding blocks two specially designed clamps are installed to calibrate the test region which can be reliably fixed on the gauge marks of the rope during the model tests the gauge length initial length between two clamps is 15 8 cm and 9 5 cm for polyester and nylon respectively the detailed descriptions about working principle of this testing system is found in lian et al 2018 liu et al 2014 the accuracy of the load measurement is 5n and the accuracy of the wire transducer is 0 1 mm fig 4 c shows the termination of rope during the model tests it is seen that the knot is adopted because the diameters of tested fibre ropes are too small to make splice the static tension elongation properties were measured after bedding in procedure and the results are given in fig 5 the bedding in procedure used in this study is described as follows a a cyclic loading with the mean load equal to 30 of the rope mbs minimum breaking strength is applied 100 cycles b unloading then a tension of 50 of the rope mbs is applied and held for 30 min c unloading then a cyclic loading with the mean load equal to 30 of the rope mbs is applied 100 cycles it was pointed out that the rope tests should be performed without interruption iso 2007 however it is difficult to implement due to the limitation of the equipment used in this study after finishing bedding in procedure the cyclic loading tests are applied to obtain the dynamic stiffness of tested rope finally the rope pulled to failure with the help of the static loading equipment and the static tension elongation curve of tested rope is obtained both the nylon and polyester are braided 16 strand constructions and three samples were prepared for each kind of rope i e the tests were repeated three times for each rope case fig 5 shows the static tensile test history of polyester and several sudden drops are found it is caused by the slipping of the knot during the loading process in order to fit the axial stiffness appropriately the measured data before the first dropping are extracted for fitting and the results are given in fig 6 as seen in fig 6 the axial stiffness of synthetic fibre ropes is nonlinear the static tension elongation curve of nylon and polyester are cut off at 1 2 and 0 65 kn respectively which are large enough to include the maximum measured tensions during the hydrodynamic model tests as a consequence the selected data are reasonable for fitting empirical static stiffness the third order polynomial fitting technique is applied to fit the static tension elongation curves and the results are given as 36 t n y l o n 0 025 3 719 ε 60 535 ε 2 58 341 ε 3 37 t p o l y e s t e r 0 019 10 936 ε 17 894 ε 2 883 169 ε 3 where t tay and t tap are the nylon and polyester tension respectively ε is the strain from fig 6 it is observed that the tension elongation curves are well fitted by eqs 36 and 37 and the stiffness of polyester is greater than nylon 3 3 experimental set up the model scale was determined as 1 40 by considering the dimensions of the wave tank and the quality of experimental results a series of hydrodynamic model tests were conducted in the towing tank of etsin universidad politécnica de madrid which has the width and length equal to 3 8m and 96m respectively the model tests were conducted according to the froude similitude rule and all the experimental data are converted to full scale fig 7 shows the sketch of experimental set up the model was installed 35m away from the wave paddle to make enough space between model and wave dissipating beach to reduce the influence of reflection wave on system dynamics as seen in fig 7 three wave probes were arranged around the wec model to measure wave elevation time series the wave gauge wp1 was installed 2 4m in front of the wec wp2 was placed 1 2m to the starboard of wec and the wp3 was installed after wec the distance between them was 1 96m an optical tracking system was used to measure six degree of freedoms motion responses with several optical motion markers arranged on the top deck of wec as shown in fig 1 b three submersible load cells with the capacities 0 50n were installed on the top frame to record mooring tension time series the sampling frequency of all sensors were set to be 50 hz 4 decay tests the decay tests were conducted to obtain the natural period and linear damping coefficient of the corresponding motion mode in this study heave and pitch free decay tests were carried out to obtain essential mode information due to the high stiffness of the mooring system in this study it is difficult to conduct the surge and heave motion decay tests once the mooring lines are installed only the pitch decay tests were performed after the mooring ropes being installed the interval between two successive peaks is defined as the natural period the linear damping coefficient is determined by log decrement ratio of peaks 38 γ ζ 1 n ln x i x i n 39 ζ δ γ 4 π 2 γ 2 where γ is the log decrement ratio ζ is the linear damping coefficient x is the amplitude subscript i and n is the index of motion peaks 4 1 free decay tests the heave and pitch free decay curves are shown in fig 8 by applying eqs 38 and 39 the natural periods and linear damping coefficients can be obtained and the results are shown in table 4 it is seen that the natural periods of heave and pitch are 7 21s and 11 76s respectively in order to calibrate the accuracy of the results of free decay tests the hydrodynamic software aqwa ansys inc 2015 is applied to calculate the motion raos of free floating wec and the results are shown in fig 9 according to fig 9 it is seen that the peak period of heave and pitch rao curves is equal to 7 2s and 11 2s respectively which are the simulated natural period of heave and pitch motions it can be found that the numerical natural period of heave and pitch motions are in good agreement with the measured ones 4 2 decay tests with mooring ropes installed since large pretension design was adopted in the model tests to better study the effects of mooring material on system dynamics the stiffness of mooring systems is very large as a consequence it is not easy to conduct the surge and heave decay tests with mooring installed the pitch decay tests of the wec moored by different mooring systems were carried out and decay curves are compared in fig 10 by comparing the results of wire and polyester systems it is clearly seen that the damping induced by wire mooring is greater than that by polyester mooring ropes the natural pitch period and linear damping coefficients are shown in table 5 it is seen that the nylon system owns the largest pitch period this is because the nylon is much more flexible than wire and polyester besides the pretension of the nylon mooring is slightly smaller than the other two mooring ropes as a result the pitch stiffness of nylon is smaller than that of wire and nylon while the pitch period of the system with polyester is close to the wire system it indicates that the pitch restoring stiffness of polyester mooring system is similar to wire mooring system it is also seen that the wire mooring system induces the greatest damping among these three taut mooring systems 5 regular wave tests seventeen regular wave model tests were conducted to study the system dynamics based on the measurements the motion response and mooring tension the raos can be derived the incident wave period in model tests ranges from 0 7 to 2s 4 43 12 66s in full scale and wave height was equal to 0 05m in model scale 2m in full scale the three main motion response raos of the wec are displayed in fig 11 as seen in fig 11 a the natural surge periods of these three systems vary between 4 9s and 5 4s according to the surge peak periods once the wave period exceeds the corresponding surge peak period the surge motion amplitude reduces significantly especially for the nylon system in most of the tested cases the surge motion of the nylon system is greater than the other two systems due to its high flexibility however the surge raos of the wec moored by wire and polyester moorings start to overtake the results of the nylon system once the wave period is greater than 10s in this study the wec has large draft and the fairleads are installed in a high position furthermore the mooring ropes are connected to the frame on the top of wec through pulleys and hooks check fig 1 b consequently both the wave force and mooring tension would give rise to large pitch moment on wec in other words the device has great pitch motion amplitude especially for the stiff mooring systems polyester and wire and under the wave tests with large period with the increase of incident wave period the pitch amplitude improves significantly which give rise to the increase of heave and surge the explanations made above can be verified in fig 11 b and c where it is observed that the heave and pitch motion raos increase dramatically once the wave periods exceed 8s owing to the high flexibility property of nylon the heave motion response amplitude of the system with nylon is greater than that of the systems with polyester and wire in all tested sea cases however the difference is reduced as the wave period increases due to the large pitch motion responses of the wec moored by polyester and wire ropes the wec moored by nylon shows greater pitch motion response than the other two systems when the wave period is less than 8s however an adverse result is found once wave period is greater than 8s and the reason has been discussed above furthermore the motion responses of the wec moored by polyester are slightly greater than that of the wire system due to the fact that the axial stiffness of wire is much greater than polyester rope overall the wec moored by taut mooring ropes shows large pitch motion responses while the amplitude of surge and heave motion responses is small the mooring tension raos are shown in fig 12 when the wave period is smaller than 8s the variations of mooring tension raos are similar to the surge raos in other words the mooring tension raos first increases with wave period until to the surge peak period then it starts to reduce until to t 8s an obvious peak of the nylon tension rao can be found around the surge peak period it indicates that the mooring tension is closely related to the surge motion response when the wave period is less than 8s if the wave period exceeds 8s the pitch motion has the most significant influence on mooring dynamics and the mooring tension raos increase significantly with incident wave period owing to larger heave and pitch amplitude the 1m polyester rope tension raos are even greater than the wire rope results a comparison between tension raos of different mooring ropes shows that the nylon tension is greater than that of polyester in the surge dominated region t 8s the opposite result is found in pitch dominated region t 8s in most cases of surge dominated region the wire rope has greatest tension amplitude despite the fact that the surge motion response of wire system is the smallest this is because the ea of wire rope is much greater than the fibre ropes and even a small axial motion would cause large tension besides if one checks the tension amplitude of mooring ropes installed in different locations it is seen that the 1m is the most loaded one since it is aligned with the incoming wave direction the tension amplitude of 1m is around double the values of 2m and 3m mooring for all tested wave cases according to the decay tests the pitch period of the wec when it is moored by taut mooring systems is greater than 15s to study the system dynamics under pitch resonance mode the regular wave tests with the incident wave period setting as the natural pitch period are conducted i e 16 61s 19 68s and 15 23s in full scale for the wire nylon and polyester system respectively since the pitch motion amplitude of wec with wire and polyester systems in large wave period is similar only the wire and nylon system were experimentally investigated besides three different wave heights were considered to study their influence on system dynamics the motion response raos in pitch resonance sea condition are shown in fig 13 it is clearly seen that the heave motion amplitude increases significantly compared with the normal regular wave tests in fig 13 c it is seen that the wec shows extremely large pitch motion responses in pitch resonance case no matter which mooring system is adopted the pitch raos are greater than 20deg m in all tested cases especially for the wire system in small wave height condition which is close to 28deg m generally it is found that the motion response raos reduce with the incident wave height furthermore the system with wire moorings shows more significant motion response than the system with nylon moorings since the pitch motion is more prominent for the system with stiffer mooring system and the pitch motion is coupled to the heave and surge responses the mooring tension raos are shown in fig 14 where only the 1m result is presented since it is the most loaded one it is seen that the wire tension raos are greater than the nylon rope in all tested cases due to large motion response of wire and great axial stiffness of the wire rope by comparing the tension raos in pitch resonance mode with the other regular wave tests it is seen that the mooring tension amplitude increases dramatically it implies that the extreme mooring tension analysis in pitch resonance mode needs to be taken great care during the mooring design spiral in accordance with the wec motion raos in different wave height the mooring tension also shows the nonlinearities i e the mooring tension amplitude decreases as the increase of wave height 6 irregular wave tests the floating system operates in random waves in the real sea conditions in this study the hydrodynamic responses of wec moored by different taut mooring systems in irregular wave conditions were experimentally studied in head sea the irregular waves were modelled by the jonswap spectra and the generated random waves were calibrated before conducting model tests totally two operational sea conditions were tested including op1 h s 0 05m t p 0 87s in model scale i e h s 2m t p 5 5s in full scale and op2 h s 0 05m t p 0 95s in model scale i e h s 2m t p 6 01s in full scale where the h s means significant wave height and t p denotes wave peak period the peak enhancement factor of jonswap spectra was set as 3 the motion responses of the wec and mooring tensions will be discussed 6 1 compare the numerical simulations with the experimental data it is necessary to perform the numerical simulations and compare the numerical results with the experimental ones to check the agreement between each other the current software is not able to capture the dynamic responses of synthetic fibre mooring ropes due to the viscoelastic and viscoplastic properties in view of this the numerical simulations focus on the wire system and the fully coupled dynamic simulations are conducted in aqwa ansys inc 2015 the numerical model can be found in fig 15 it is seen that the pulleys and hooks used to connect mooring to the wec as seen in fig 1 b are neglected the simulated motion results of the wec moored by the wire mooring system are compared with the measured ones and the results are shown in fig 16 to compare the results clearly only 100s data within the maximum responses are plotted according to the motion response time series it is observed that the numerical results are close to the experimental ones and the greatest difference is found in the heave motion responses this is explained because the pulleys and hooks are neglected in the numerical model in other words the heave restoring force of mooring system is underestimated by the numerical model consequently the heave motion responses are overestimated by the numerical method which can be validated in fig 16 c furthermore the pitch moment of mooring system on wec is underestimated by the numerical model due to the neglected hook which causes to the underestimation of pitch motion responses it is necessary to perform the spectral analysis to compare the components of experimental and numerical motion responses in the motion spectral curves it is observed that the wave property has significant influence on motion responses the spectral peaks that occur near to the wave peak period are observed in all motion responses in addition to the wave peak period the resonance also plays significant role in the motion responses unfortunately the numerical model cannot simulate the hooks and pulleys well enough which gives rise to the difference of natural periods between numerical and experimental motions for instance the greatest spectral peak of the numerical heave motion occurs around 2 92s which should be the natural heave period however no spectral peak can be found in the experimental heave spectrum under this period since the natural heave period of experimental tests is much smaller than 2 92s in the spectral density curves of pitch motion responses the spectral peak due to pitch resonance can be found in the experimental data however the spectral peak is not found in the same frequency for the numerical pitch motions because the natural period of numerical and experimental pitch motion is different the results of mooring tensions of the most loaded one 1m are plotted in fig 17 it is seen that the numerical results are in good agreement with the experimental ones based on the mooring tension spectral density it is observed that the wave period has the most significant influence on mooring tensions the mooring tensions spectral peak is close to the wave peak period in addition the spectral density curve of numerical mooring tension is similar to the experimental ones the statistics of wec motion responses and wire mooring tensions estimated by numerical and experimental methods are compared in table 6 it is seen that the numerical results are in good agreement with the experimental ones and the greatest difference is found in the heave motion responses overall it is concluded that the model tests were well performed and the experimental results are reasonable 6 2 measured motion responses of three systems since the system dynamics in these two operational wave conditions are similar only the results when wec operates in op1 are plotted the three main motion responses of the wec moored by different taut mooring systems in op1 are shown in figs 18 20 only 100s time series are given in order to compare the results clearly according to the results in fig 18 a it is clearly seen that the surge motion shows the wave frequency characteristic due to the large surge restoring stiffness provided by mooring systems there are no significant differences between surge motion responses of wire and polyester systems the surge motion is confined in small region as a result of large mooring stiffness while thanks to the high flexibility of the nylon mooring rope this system shows greater surge motion responses than the other two systems in fig 18 b it is seen that the major energies of surge spectral densities are concentred in the wave frequency region and the spectral peaks are close to the wave peak period this implies that the surge motion is dominated by wave frequency components a clear indication of surge motion of the wec moored by nylon ropes is much greater than that of other systems is seen in fig 18 b where the spectral peak of the nylon system is much more prominent as for the system with polyester ropes it shows the similar surge motion response to the system with wire mooring as shown in fig 19 the wec behaves much more intensively in heave mode when it is moored by nylon ropes than the other two mooring systems despite the similar pretension was adopted for these mooring ropes the reason is that the axial stiffness of nylon rope is much smaller than the other two materials which can be verified in fig 6 it implies that the nylon rope is the preferable material for wec mooring system which shows better energy capturing performance the comparison of heave spectral density curves of different systems illustrates that the heave motion of polyester system is the dominating one the heave motion of the polyester system consists of three components namely the one caused by the pitch motion the component due to the wave motion and the heave resonance while the component closes to the wave peak period is the most important one and the heave resonance part is inferior to it in the heave spectral density curves of wire and polyester systems there are only two spectral peaks that occur near the corresponding pitch natural period and wave peak period the component that happens in the heave resonance is not found due to large stiffness of the wire and polyester mooring ropes in accordance with the surge and heave motion responses the pitch motion of the nylon system is more significant than that of the other two systems the result agrees well with the regular wave model tests that is the nylon system shows the greatest motion responses among these three systems and the difference between polyester and wire systems is negligible when the incident wave period is small less than 8s according to the spectral analysis it is found that both the natural pitch period and wave peak period have significant influence on pitch motion response while the spectral peak occurs near to the wave peak period is the dominant one to study the influence of mooring material on wec motion response carefully the statistics of the wec motion in these two tested irregular wave conditions are listed in tables 7 and 8 it is clearly seen that the maximum motion amplitudes of the wec moored by nylon ropes in these two testes wave conditions are much greater than that of the other two systems for instance the maximum heave amplitude of nylon system is 2 7 and 3 6 times the wire system results when wec operates in op1 and op2 wave conditions respectively overall the motion responses of wec moored by polyester and wire mooring ropes are similar in these two random wave conditions and they are smaller than the results of the wec moored by nylon 6 3 measured mooring dynamics of three systems the dynamics of different mooring ropes in these two operational sea states are studied and a spectral analysis is carried out similar to the motion analysis only 100s data in op1 wave condition are plotted and the results are shown in figs 21 23 in the mooring tension time series it can be found that the amplitude of polyester mooring rope is the smallest this phenomenon can also be clearly identified in the mooring tension spectral densities the spectral peaks of nylon and wire tensions are close and they are much more significant than the ones of polyester it is understood that because the wire mooring rope has great axial stiffness even small motion response will cause large mooring tension consequently the tension amplitudes of wire rope are comparable to the nylon rope results despite that the motion response of wire is smaller than that of nylon as seen in figs 21 b 23 b not only the spectral peak is found near the wave peak frequency 1 14 rad s but also another one closes to the natural pitch frequency 0 38 rad s 0 32 rad s 0 41 rad s for the wire nylon and polyester system respectively can be observed as well it indicates that the pitch motion has some influence on mooring dynamic tensions however its influence is negligible compared to the wave peak period besides the dynamic tensions of 2m and 3m are similar due to symmetrical arrangement and they are smaller than the values of 1m compared to the upwind mooring line the influence of mooring material on mooring dynamic tensions is smaller for the leeward mooring lines it is found that the difference between tension spectral densities of 2m and 3m of different mooring ropes of are smaller than that of 1m the mooring tension statistics in the tested irregular waves are listed in tables 9 and 10 it is seen that the tension characteristics of the wire and nylon rope are similar in these two operational sea states and the maximum tension of nylon mooring is slightly greater than that of wire rope compared to wire and nylon moorings the variations the tension of polyester rope are more stable especially for the 1m for instance the standard deviation of the tension on 1m nylon rope is almost two times to the value of polyester in these two sea states while the maximum 1m mooring tension of nylon is 21 and 29 greater than the value of polyester in op1 and op2 respectively 6 4 short term mooring fatigue damage analysis the rainflow counting technique is applied to the measured mooring tension time series to obtain tension cycles for fatigue damage analysis fig 24 shows the probability of rainflow counting tension range of 1m under op1 sea condition it is seen that the statistical characteristics of wire and nylon rainflow counting tension range are similar the rainflow counting tension cycles occur frequently in the range of 200 400 kn the most important tension cycle that causes fatigue damage of polyester mooring rope occurs between 150 kn and 250 kn furthermore it is found that greatest load cycle of polyester mooring is around 1000 kn which is smaller than the results of wire and nylon mooring ropes besides it is also found that the rainflow counting tension cycles range from 0 to 30 kn are the most frequent ones for synthetic fibre roes it should be noted that the spectral methods for structural fatigue damage analysis are based on the gaussian assumption as a consequence it is necessary to check the statistical properties of mooring tensions the kurtosis and skewness of mooring tensions in all tested sea conditions are depicted in tables 11 and 12 it is seen that the nylon mooring tensions are the closest ones to the gaussian for the gaussian process the kurtosis 3 skewness 0 among these three materials it implies that the spectral methods may provide precise estimations of the fatigue damage of nylon mooring rope to help understand the implementations of spectral methods for mooring fatigue damage analysis fig 25 presents the flowchart of the assessment where rfc denotes the rainflow counting technique the crucial step in the analysis is to obtain the mooring tension spectral densities by using the measured mooring tension raos the mooring tension spectrum is defined as 40 s t e n ω t r a o 2 s w ω where s ten ω is the estimated mooring tension spectrum in the given wave spectrum s w ω t rao is the measured mooring tension raos eq 40 is a very efficient method to obtain structural response spectrum in any given irregular wave conditions without carrying out the expensive and time consuming experimental tests or numerical simulations in this study the measured wave spectral during the model testes are used to calculate mooring tension spectral once the mooring tension spectral density is obtained the fatigue damage can be assessed by applying the spectral methods introduced in section 2 2 to evaluate the performance of spectral methods in mooring fatigue damage analysis the mooring fatigue damage estimated directly from the measured mooring tension time series by applying rainflow counting technique is also presented as the reference values the parameters k and m of the t n curve is 5 05 for wire rope and 10 3 25 3 43lm for spiral wire rope api 2005 where lm is ratio of mean load to reference breaking strength for the polyester rope the k and m is recommended as 7 5 and 9 respectively api 2014 while the k and m for the nylon rope are 10 6 and 3 5 respectively by fitting the experimental data ridge et al 2010 the minimum breaking strength of polyester and nylon rope in full scale are estimated by empirical equations barltrop 1998 johanning et al 2006 xu et al 2019 and this value of wire rope is estimated according to the equations in orcina the comparisons of the expected mooring fatigue damage rate estimated by different methods in the two tested sea conditions are shown in figs 26 and 27 it is seen that the three sophisticated wideband spectral methods discussed provide very similar estimations to mooring fatigue damage in all cases considered as seen the estimated damages are in good agreement with the rainflow counting damage for the wire ropes however the accuracy of spectral methods for fatigue damage analysis of synthetic fibre ropes is not satisfied in some cases for instance the relative error of estimated damage of the leeward polyester ropes 2m and 3m and the upwind nylon rope 1m in op2 sea state is greater than 20 it illustrates that the wideband spectral methods show better performance in fatigue damage analysis for wire than for the synthetic fibre mooring ropes it is because the nonlinearities of the dynamics of synthetic fibre mooring are greater than that of wire it is also seen that the wideband spectral methods present better estimations to fatigue damage of 1m than the other two leeward moorings in most cases especially for the polyester mooring ropes the fatigue damage of 1m is well estimated by the wideband spectral methods while the errors of 2m and 3m are significant it is explained that during the regular model tests the measured tension raos did not cover the range between 1 4 and 1 6 rad s resulting in the underestimations of mooring spectral moments which is closely related in mooring fatigue damage analysis as seen in fig 25 while the leeward moorings are more sensitive to these missing components compared to the 1m since the tension raos of 1m is greater than the results of 2m and 3m as for the simplified correction factor methods it is seen that the α0 75 method provides even more accurate estimations to mooring fatigue damage than sophisticated wideband methods in most cases as for the wirsching light method the estimated results are acceptable for the wire mooring ropes however the wirsching light method underestimates the nylon mooring fatigue damage significantly it seems that the wirsching light provides very good estimations to the leeward polyester mooring fatigue damage the results match well with the that given by rainflow counting this is because of the missing part of mooring tension spectrum is compensated by the overestimations component caused by wirsching light approach overall the wirsching light method shows the worst performance in fatigue damage analysis for the most loaded moorings 1m by comparing the mooring fatigue damage in op1 and op2 it is found that the results are very close in these two operational sea conditions the reason is that the wave peak period of these two irregular sea cases are very close and the significant wave height is identical 7 conclusions experimental tests on the dynamics of a wec buoy moored by taut mooring systems with different rope material are conducted in regular and irregular waves based on the measurements the effects of the nylon polyester and wire ropes on the performance of the wec are discussed the influence of mooring material on wec motion responses can be identified from the experimental data the heave motion response of the system with nylon moorings is the greatest among these three tested systems for all tested regular wave conditions due to the high flexibility of nylon rope however the difference of heave motion responses between different systems reduce with the increase of incident wave period the heave motion response of the polyester and wire system increases dramatically with the incident wave period when the incident wave period is close to the corresponding natural pitch period the heave motion of these two systems is even greater than that of the nylon system for the test cases with the incident wave period less than 8s the pitch motion amplitude of nylon system is greater than that of the other two systems although an inverse result is found when the incident wave period exceeds 8s in the irregular wave model tests the polyester mooring rope tension is the lowest the discussed three wideband spectral methods show good performance in mooring fatigue damage estimation in the majority of cases the α0 75 method is superior to the other methods in estimating fatigue damage of the moorings discussed in this study the wirsching light method shows the worst performance in estimating mooring fatigue damage in most cases however this conclusion is drawn based on the short term fatigue damage of the specified mooring concepts their performances in fatigue damage analysis of the other mooring concepts and in long term fatigue damage analysis still need to be investigated in general the polyester shows similar dynamic characteristics as the wire and the nylon is much more flexible than these two materials for the wec which prefers compliant mooring system the nylon is the preferred mooring choice among these three materials however it needs to be noticed that the nylon suffers greater fatigue damage than polyester and wire in this study the influence of pretension on hydrodynamic responses of wec and mooring dynamics is not investigated and only the head sea condition is considered in the future study the effects of mooring pretension and wave direction on the dynamic responses of wec system will be studied credit authorship contribution statement sheng xu methodology formal analysis writing original draft shan wang methodology writing review editing c guedes soares writing review editing supervision declaration of competing interest there are no conflicts of interest acknowledgement this work was financially supported by the project elastic mooring systems for wave energy converters which is co funded by european union s horizon 2020 research and innovation programme under the framework of oceanera net http oceaneranet eu and by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract oceanera 0006 2016 the work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by fct under contract uidb uidp 00134 2020 the authors are grateful to prof h x liu and y m zhang from tianjin university for proving the experiment system for testing synthetic fibre ropes as well as meaningful discussion of experimental procedure the authors are also grateful to prof antonio souto iglesias jordi mas soler and antonio medina mánuel from universidad politécnica de madrid for the interesting discussions and several very useful suggestions about the experimental procedures 
20709,the present work investigates the influence of mooring material on the hydrodynamic responses of a point absorber by experimental tests three taut mooring systems are considered with different materials namely wire nylon and polyester in order to study the influence of mooring material on point absorber hydrodynamic responses the other factors that may influence system dynamics are kept as unchanged as possible during the model tests the pretension of the three mooring systems are set to be similar and the parameters of wave conditions are identical decay tests are conducted to determine the system natural periods and linear damping coefficients in different modes totally seventeen regular wave cases and two irregular wave conditions are tested to study the motion responses of the buoy as well as mooring dynamics the response amplitude operators of motion responses and mooring tensions are obtained by the regular wave model tests three wideband spectral methods as well as two simplified spectral methods are applied to study mooring fatigue damage in the random wave conditions and the results are compared with the estimations of rainflow counting approach it is shown that the α0 75 method provides the most precise estimations of fatigue damage in most mooring cases among spectral methods discussed this study keywords experimental study point absorber taut mooring systems mooring material mooring fatigue damage spectral methods nomenclature wec wave energy converter owc oscillating water column pto power take off calm catenary anchor leg mooring salm single anchor leg mooring rfc rainflow counting raos response amplitude operators k intercept parameter of the t n curve m slope of t n curve u ratio of tension range to the breaking strength of mooring rope λ n nth order spectral moment r tension amplitude d fatigue damage taw wec taut wire mooring system tay wec taut nylon mooring system tap wec taut polyester mooring system φ diameter of wec δ draft of wec h height of wec ε strain ζ linear damping coefficient h s significant wave height t p peak period op1 operation random sea condtions h s 2m t p 5 5s op2 operation random sea condtions h s 2m t p 6 01s tb tovo benasciutti method zb zhao baker method wl wirsching light method alpha α0 75 method 1 introduction in the recent decades the global warming and air pollution due to massive use of fossil fuels are attracting great attention and it has become urgent to develop clean and sustainable energy wave energy carries a high energy density clément et al 2002 and long energy capturing time drew et al 2009 being thus an interesting form to explore portugal is recognized as one of the favourable places to exploit wave energy as the annual wave power in portuguese nearshore is estimated between 30 and 40 kw m silva et al 2015 2018 in addition to the nearshore some portuguese islands shows great potential wave energy density such as azores islands rusu and guedes soares 2012 and madeira islands rusu et al 2008 other islands in neighbouring areas such as uk and ireland guedes soares et al 2014 have also high levels of energy in the south direction cape verde bernardino et al 2017 has lower energy but the canary islands still show high wave energy density with average annual energy availability of 25 30 kw m and the north northwest coast of the islands shows greater energy availability gonçalves et al 2020 a variety of wave energy converter wec concepts have been developed for harvesting wave energy and the development of wecs is associated to the characteristics of the deployment site silva et al 2013 the first generation of wecs are the shoreline static devices mainly the oscillating water columns owcs falcão 2015 rezanejad et al 2013 the second generation of wecs are installed at nearshore which are mostly gravity anchored resting directly on the seabed or fixed to the seabed harris et al 2004 some typical devices are found such as archimedes wave swing a fully submerged heave device prado 2008 nowadays the development of wecs are moving offshore due to the larger energy densities in the offshore areas a variety of floating wecs f wecs have been developed for instance a novel dual chamber floating owc was proposed for energy harvesting rezanejad and guedes soares 2015 and the influence of mooring system on its energy capturing performance was studied xu et al 2020b 2020c according to statistics of wave energy converter development in recent years it is found that the point absorber attracts the most concern lópez et al 2013 the mooring system is an essential component of floating systems different from the traditional offshore structures the mooring system of wecs not only acts as the role to keep wecs on station but it may also affect its energy capturing performance the main difference between mooring design for traditional floating offshore structures and wecs have been discussed extensively by xu et al 2019 since the wecs usually operate in the water depth less than 100m both the taut and the catenary systems have obvious drawbacks for the wec mooring system xu et al 2019 the slack mooring system has the risk to give rise to snap events which could affect the system safety xu et al 2018c 2020d xu and guedes soares 2020a therefore the mooring system should be compliant enough to limit the influence of the mooring system on the energy harvesting activities as well as to reduce extreme mooring loads harris et al 2004 recommend the catenary spread mooring system catenary anchor leg mooring calm system and the single anchor leg mooring salm system for wecs due to their safe station keeping and moderate installation costs by comparing the performance and costs of catenary mooring system taut mooring system and salm for a large wave energy converter thomsen et al 2017 conclude that the salm is the best mooring solution among these three designs because it is the cheapest and compliant enough in addition to the single point mooring systems the hybrid mooring systems ji and yuan 2015 xu et al 2018a 2018b yuan et al 2014 showed good performance in wec applications in the experimental study xu et al 2018c 2020d xu and guedes soares 2020a in addition to the mooring concept the mooring material is another important factor that affects mooring system performance the synthetic fibre rope is receiving great attention in the application to marine renewable energy devices due to its high flexibility wang et al 2019 weller et al 2015 it has been pointed out that low modulus materials such as polyester and nylon ropes are recommended for the wecs mooring applications weller et al 2015 however it indicates that even the polyester rope is stiff for most motion dependent large dimensional wecs and the nylon rope is recommended because it shows even more compliance and good fatigue damage performance ridge et al 2010 xu et al 2019 furthermore the taut nylon mooring system is even much more compliance than the chain catenary mooring system in the shallow water application thomsen et al 2016 recently a superflex rope mooring was numerically and experimentally studied for a wec in ultra shallow water condition huang et al 2018 the results indicate that the superflex rope mooring shows good performance in reducing the maximum transient tension furthermore the wave energy capturing activities are not affected by the mooring system which adopts the superflex ropes it is seen that the elastic mooring has great potential in the wecs application however there is still no study to reveal the differences of wec system dynamics caused by mooring materials and to what extent the mooring material can affect the energy capturing performance of wecs part of the reason is that the synthetic fibre ropes show strong nonlinearities due to the viscoelastic and viscoplastic properties huang et al 2015 lian et al 2018 and there is still no numerical tool that can fully capture these characteristics of fibre mooring ropes when they are coupled to floating structures the fatigue limit states fls design is one of the crucial steps in the mooring design spiral as a consequence the mooring fatigue damage needs to be predicted precisely the rainflow counting technique matsuishi and endo 1968 in conjunction with t n or s n curve is the generally used method in mooring fatigue damage analysis because it provides reasonable estimations of mooring fatigue damage and it is easy to implement the applications of the rainflow counting technique in wec mooring fatigue damage prediction can be found in thies et al 2014 xu and guedes soares 2020a yang et al 2016 2017 and xu et al 2020a study the influence of side mooring on mooring fatigue damage by using rainflow counting of the measured data the short term fatigue damage of wire mooring rope for a point absorber was studied by the rainflow counting and spectral methods and the results showed that the fatigue damage predicted by the wideband spectral methods match well with the rainflow counting results xu and guedes soares 2020b however the mooring tension spectra were derived from the measured mooring tension time series compared with the spectral methods the rainflow counting method is considered as a more accurate approach in structural fatigue damage analysis however it is expensive and time consuming to apply rainflow counting method to analysis mooring fatigue damage since the fully coupled dynamic analysis or experimental tests are needed to obtain the mooring tension time series the fully coupled dynamic simulations in long term mooring fatigue damage assessment is extremely time consuming meanwhile conducting the experimental tests is unrealistic due to massive sea conditions as a consequence the efficient and accurate method for mooring fatigue damage analysis needs to be developed after an extensive review it was concluded that the influence of mooring material on wec system dynamics and an accurate and efficient method for mooring fatigue damage estimations are two issues of concern thus in this study three taut mooring systems of wire polyester and nylon are designed for a point absorber a series of model tests namely decay tests regular wave model tests and irregular wave model tests are conducted to study the influence of elastic material on wec hydrodynamic responses and mooring tensions in addition a time domain method in conjunction with spectral methods is proposed to study mooring fatigue damage it adopts the measured mooring tension response amplitude operators raos and wave spectra to obtain the mooring tension spectra then the mooring fatigue damage is estimated by applying spectral methods to the mooring tension spectrum totally three wideband and two simplified spectral methods are discussed and the accuracy of the proposed method is checked by the rainflow counting method 2 mooring fatigue analysis the t n approach is widely applied to study mooring rope fatigue damage under the combined sea environmental loads the relation between normalized tension range u and the number of loading cycles n causes the cumulative fatigue damage under constant u expressed as 1 n k u m where u is the ratio of tension range to the breaking strength of mooring rope k is the intercept parameter of the t n curve m is the slope of t n curve where both of these two parameters are determined by model tests by applying the palmgren miner rule miner 1945 the accumulated fatigue damage on mooring rope due to different tension cycles is given as 2 d i 1 n c n i n i where n i is the number of cycles within the tension range interval i n i is the number of cycles cause to structural failure at normalized tension range i as given by the t n curve which is determined according to eq 1 n c is the total number of load cycles 2 1 time domain analysis according to eq 2 one of the most crucial steps to evaluate mooring fatigue damage is to estimate the number of load cycles precisely the most direct and precise approach is the time domain analysis i e applying suitable cycle counting methods to derive load cycles and its corresponding number from loading time series there are several counting methods available such as rainflow counting matsuishi and endo 1968 range counting peak counting and level cross counting among these various methods the rainflow counting showed the best performance in estimating fatigue damage dowling 1971 in this study the rainflow counting approach is adopted to estimate mooring fatigue damage in time domain 2 2 spectral methods the time domain analysis presents accurate estimations of the mooring rope fatigue damage however the fully coupled time domain analysis of the floating structure is cumbersome and requires countless calculation efforts on the other hand the spectral methods provide another satisfactory solution to structural damage analysis which is more efficient by invoking eq 1 into eq 2 the expected damage rate is then expressed as 3 d 1 k e i 1 n c u i m n 0 k 0 u m f u u d u where d is the expected damage rare n 0 is mean number of stress cycles for an idealized narrowband gaussian process n 0 ν x 0 τ for a concerned time duration τ ν x 0 is the zero mean upcrossing rate for a zero mean gaussian process the zero mean upcrossing rate can be derived as lutes and sarkani 1997 4 v x 0 1 2 π λ 2 λ 0 where λ n is the nth order spectral moment of stationary stochastic process x t which is calculated as 5 λ n 0 ω n s x ω d ω where ω is the frequency unit rad s s x ω is the one side spectrum the variance of signal x t is expressed as 6 λ 0 σ x 2 furthermore the bandwidth parameter can be calculated by lutes and sarkani 1997 7 α n λ n λ 0 λ 2 n for a narrowband random gaussian process the tension amplitude r follows rayleigh distribution 8 f r r r σ x 2 exp r 2 2 σ x 2 then the structural expected damage rate under a narrowband random gaussian process is expressed in closed form 9 d n b v x 0 k 0 2 r m f r r d r v x 0 k 2 2 σ x m γ m 2 1 however the mooring rope is subjected to combined wave frequency and low frequency loads due to first order and second order wave forces as well as low frequency current and wind forces api 2005 gao and moan 2007 xu and guedes soares 2020a as a consequence the simplified narrow band assumption is not satisfied for mooring tension more sophisticated wideband or combined spectral method gao and moan 2008 jiao and moan 1990 low 2010 is needed in this study different wideband spectral methods are introduced and applied to study mooring damage then the performance of these methods are evaluated by comparing to the fatigue damage results from the rainflow counting approach in time domain 2 2 1 dirlik method an empirical formula was proposed to estimate structural fatigue damage under wideband load dirlik 1985 the rainflow amplitude probabilistic density is approximated by hybrid exponential and two rayleigh distributions 10 f r f c d k r 1 σ x h 1 q e z q h 2 z c 2 e z 2 2 c 2 h 3 z e z 2 2 where z r σ x is the normalized amplitude and 11 h 1 2 x m α 2 2 1 α 2 2 h 2 1 α 2 h 1 h 1 2 1 c h 3 1 h 1 h 2 q 1 25 α 2 h 3 h 2 c h 1 x m λ 1 λ 0 λ 2 λ 4 c α 2 x m h 1 2 1 α 2 h 1 h 1 2 subsequently the expected damage rate estimated by dirlik s formula is derived 12 d d r v p k 2 σ x m h 1 q m γ 1 m 2 m 2 γ 1 m 2 h 2 c m h 3 according to eq 9 the exceedance probability of rainflow loading amplitude is expressed as benasciutti and tovo 2006 13 f r f c d k r h 1 e z q h 2 e z 2 2 c 2 h 3 e z 2 2 2 2 2 tovo benasciutti method it has been proven that there are two bounds for the expected fatigue damage rate caused by rainflow load cycle rychlik 1993 consequently the problem of fatigue damage estimation becomes the problem of finding the proper intermediate point between two bounds the marginal probability density of level crossing amplitude is described as tovo 2002 14 f l c c r α 2 r σ x 2 exp 1 2 z 2 then the expected fatigue damage rate caused by level crossing can be obtained 15 d l c c v x p k 0 2 r m f l c c r d r v x p k α 2 2 2 σ x m γ 1 m 2 where ν x p is the expected rate of occurrence of peaks which is calculated as ν x p 1 2 π λ 4 λ 2 the expected fatigue rate of range mean counting is approximated as 16 d r c v x p k 2 2 α 2 σ x m γ 1 m 2 α 2 m 1 d l c c for the marginal probability density of range mean counting amplitude it was derived as tovo 2002 17 f r c r r σ x 2 α 2 2 exp 1 2 z 2 α 2 2 the rainflow fatigue damage can be approximated by using a weighed combination of two bounds tovo 2002 18 d r f c t b b d l c c 1 b d r c an optimized b value was obtained by benasciutti and tovo 2005 from the spectral density of the process which is written as 19 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 e 2 11 α 2 α 1 α 2 α 2 1 2 according to eq 14 the exceedance probability of level crossing can be derived as 20 f l c c r α 2 exp z 2 2 by integrating eq 17 the exceedance probability of range mean counting amplitude can be obtained 21 f r c r exp 1 2 z 2 α 2 2 similar to the rainflow fatigue damage the exceedance probability of rainflow counting load amplitude can also be witted as a linear combination of f lcc r and f rc r due the linearity 22 f r f c t b r b f l c c r 1 b f r c r 2 2 3 zhao baker method zhao and baker 1992 proposed an empirical equation to describe the probability density function of rainflow load cycle amplitude which combines the two parameter weibull distribution and a rayleigh distribution 23 f r f c z b z w α β z β 1 exp α z β 1 w z exp 0 5 z 2 for a stationary gaussian process the weighting parameter w is obtained when m 1 24 w 1 α 2 1 2 π γ 1 1 β α 1 β the parameter β can be derived according to the bandwidth parameters α 2 25 β 1 1 α 2 0 9 1 1 9 α 2 0 9 α 2 0 9 a simple expression for α is given as 26 α 8 7 α 2 zhao and baker 1992 claimed that these parameters defined above are able to estimate damage with considerable accuracy however this method is not applicable when α 2 0 13 which leads to w 1 benasciutti and tovo 2006 furthermore by noticing that the damage correction factor χ is strongly correlated to α 0 75 other than α 2 an improved expression to get α is also given zhao and baker 1992 it was also proved that the improved expression presents much more accurate fatigue damage result than the simplified one mršnik et al 2013 for m 3 the correction factor is approximated as 27 χ d r f c d n b χ m 3 0 28 α 0 75 0 5 0 4154 1 392 α 0 75 α 0 75 0 5 the parameter α is calculated by the expression α d β where d is the solution of 28 γ 1 3 β 1 α 2 d 3 3 γ 1 1 β χ α 2 1 d 3 π 2 α 2 1 χ 0 however it was pointed out that the w 0 may happen when α 2 0 5 and α 0 75 0 65 benasciutti and tovo 2006 following eq 3 the expected damage rate estimated by zhao baker method zhao and baker 1992 is 29 d r f c z b v x p k 2 σ x m w α m β γ 1 m β 1 w 2 m 2 γ 1 m 2 and the exceedance probability of rainflow counting amplitude approximated is 30 f r f c z b r w exp α z β 1 w exp 0 5 z 2 2 2 4 wirsching light method wirsching and light 1980 proposed an empirical coefficient to correct the narrow band fatigue damage the correction factor is derived by applying monto carlo simulations to different power spectral densities the fatigue damage in wirsching light method is defined as 31 d w l ρ w l d n b 32 ρ w l a w l 1 a w l 1 1 α 2 2 b w l 33 a w l 0 926 0 033 m 34 b w l 1 587 m 2 323 2 2 5 α0 75 method benasciutti 2004 introduced an empirical correction factor to the narrow band fatigue damage so that the wideband fatigue damage is then estimated as 35 d α 0 75 α 0 75 2 d n b this approach has been verified to present good estimations to structural fatigue damage benasciutti and tovo 2006 despite lacking any theoretical explanation 3 experimental methods 3 1 point absorber and pto system the point absorber is designed as a cylinder with the bottom cone and the 1 40 model is shown in fig 1 where fig 1 a is the schematic of point absorber model and fig 1 b shows the model of for hydrodynamic tests it is seen that the height of bottom cone is 75 mm and the total height of the wec model is 500 mm the main parameters of the wec are listed in table 1 where φ is the diameter δ is the free draft of wec without mooring lines being installed rxx ryy rzz are the gyration radius about x y and z axis respectively the height of gravity centre is 163 mm where the base line is located on the bottom of model a simple geometry was chosen to this experimental study as the main interest was the behaviour of the mooring system and thus the dynamics of the floating body should be very easy to predict in this study a square heave plate and linear spring are used to simulate the pto system due to the fact that to scale down the real pto system during the model tests is difficult moura paredes et al 2016 the spring and heave plate play the role to simulate the stiffness and damping of pto system as suggested by yang et al 2018 2020 as shown in fig 2 the steel heave plate was rigidly connected to the wec by an extended steel rod which was fixed on the bottom of the cone the length of steel rod is 500 mm to make the heave plate being submerged deep enough in order to limit influence of wave motion on the heave plate the length and width of the heave plate are 100 mm and the thickness is 1 mm a wire is used to connect the heave plate and spring the total length of wire is 928 6 mm including the length of clump at the both ends of wire to connect heave plate and spring the diameter of wire is 3 5 mm and its mass per unit length in air is 0 108 kg with the clumps considered the stiffness of spring is 29 22n m on the bottom of wave flume a load sensor was installed to measure the wire tension 3 2 taut mooring systems as shown in fig 3 the taut mooring system consists of three mooring ropes with an azimuth angle between each mooring line of 120 two clamps were used to connect the mooring rope to the floor and hook connected to load sensor respectively the model of hook is shown in fig 1 b the length of hook is 65 mm and its weight is 53g in this study three different mooring rope materials namely the wire polyester and nylon are experimentally studied the wire mooring rope used different clamps from synthetic fibre mooring ropes during model tests the length of end and top clamp used in wire mooring tests is 65 mm and 75 mm respectively two identical clamps were installed on both ends of the synthetic fibre mooring ropes whose length is 55 mm hereafter the systems with wire nylon and polyester mooring ropes are named as taw tay and tap respectively the main parameters of the mooring ropes are shown in table 2 where da denotes the nominal diameter w is the mass per unit length in air ea is the axial stiffness the axial stiffness of polyester and nylon rope are estimated based on the measured tension strain curve by the scant method mckenna et al 2004 l e is the effective length of mooring rope without the clamps and hook considered the w d is the water depth it is seen the water depth of wire mooring tests was slightly different to the synthetic fibre rope tests the reason is to adjust the pretension of wire ropes to make it as close as to the values used in the fibre rope tests the pretension of each mooring rope is summarized in table 3 where it is found that the pretension of these three mooring ropes are very close however there s still some difference of pretension between each mooring rope which would give rise to the difference of mooring dynamics it is difficult to adjust the pretension of these difficult mooring ropes to be identical part of the reason is that a great pretension was adopted in the model tests and the system was very stiff as a consequence it is not easy to adjust the pretension besides the viscoelastic and viscoplastic characteristics of synthetic ropes also give rise to difficulties in adjusting mooring pretension the tension extension characteristics of synthetic fibre ropes were tested in tianjin university and fig 4 shows the experimental system the loading element the equipment foundation the measurement system and the water cycling system constitute the experimental system for testing fibre ropes the loading system is composed of static and dynamic ones the cyclic loading on the rope is applied by utilizing centric slider crank mechanism as the driving source converting the rotary motion of the eccentric wheel to the reciprocating motion of the big sliding block lian et al 2017 by taking the advantage of the centric slider crank mechanism a standard simple harmonic motion of the sliding can be obtained the amplitude of harmonic motion is set by adjusting the length of crank which can be adjusted between 0 and 0 3m as shown in fig 4 a water cycling system is applied to simulate working environment of mooring rope in order to make sure that the tested sample will be always immersed in the water during the tests two water pumps are utilized to pump water from outer tank into inner tank to maintain a sufficient water level in the inner tank the length of inner tank is 65 cm as seen in fig 4 b an elongation measurement system is designed which consists of the wire transducer axletrees two sliding blocks and two clamps two parallel axletrees are installed above the water tanks on the axletrees there are two sliding blocks one of which is used as the base for the wire transducer and the other is used to fix the wire under sliding blocks two specially designed clamps are installed to calibrate the test region which can be reliably fixed on the gauge marks of the rope during the model tests the gauge length initial length between two clamps is 15 8 cm and 9 5 cm for polyester and nylon respectively the detailed descriptions about working principle of this testing system is found in lian et al 2018 liu et al 2014 the accuracy of the load measurement is 5n and the accuracy of the wire transducer is 0 1 mm fig 4 c shows the termination of rope during the model tests it is seen that the knot is adopted because the diameters of tested fibre ropes are too small to make splice the static tension elongation properties were measured after bedding in procedure and the results are given in fig 5 the bedding in procedure used in this study is described as follows a a cyclic loading with the mean load equal to 30 of the rope mbs minimum breaking strength is applied 100 cycles b unloading then a tension of 50 of the rope mbs is applied and held for 30 min c unloading then a cyclic loading with the mean load equal to 30 of the rope mbs is applied 100 cycles it was pointed out that the rope tests should be performed without interruption iso 2007 however it is difficult to implement due to the limitation of the equipment used in this study after finishing bedding in procedure the cyclic loading tests are applied to obtain the dynamic stiffness of tested rope finally the rope pulled to failure with the help of the static loading equipment and the static tension elongation curve of tested rope is obtained both the nylon and polyester are braided 16 strand constructions and three samples were prepared for each kind of rope i e the tests were repeated three times for each rope case fig 5 shows the static tensile test history of polyester and several sudden drops are found it is caused by the slipping of the knot during the loading process in order to fit the axial stiffness appropriately the measured data before the first dropping are extracted for fitting and the results are given in fig 6 as seen in fig 6 the axial stiffness of synthetic fibre ropes is nonlinear the static tension elongation curve of nylon and polyester are cut off at 1 2 and 0 65 kn respectively which are large enough to include the maximum measured tensions during the hydrodynamic model tests as a consequence the selected data are reasonable for fitting empirical static stiffness the third order polynomial fitting technique is applied to fit the static tension elongation curves and the results are given as 36 t n y l o n 0 025 3 719 ε 60 535 ε 2 58 341 ε 3 37 t p o l y e s t e r 0 019 10 936 ε 17 894 ε 2 883 169 ε 3 where t tay and t tap are the nylon and polyester tension respectively ε is the strain from fig 6 it is observed that the tension elongation curves are well fitted by eqs 36 and 37 and the stiffness of polyester is greater than nylon 3 3 experimental set up the model scale was determined as 1 40 by considering the dimensions of the wave tank and the quality of experimental results a series of hydrodynamic model tests were conducted in the towing tank of etsin universidad politécnica de madrid which has the width and length equal to 3 8m and 96m respectively the model tests were conducted according to the froude similitude rule and all the experimental data are converted to full scale fig 7 shows the sketch of experimental set up the model was installed 35m away from the wave paddle to make enough space between model and wave dissipating beach to reduce the influence of reflection wave on system dynamics as seen in fig 7 three wave probes were arranged around the wec model to measure wave elevation time series the wave gauge wp1 was installed 2 4m in front of the wec wp2 was placed 1 2m to the starboard of wec and the wp3 was installed after wec the distance between them was 1 96m an optical tracking system was used to measure six degree of freedoms motion responses with several optical motion markers arranged on the top deck of wec as shown in fig 1 b three submersible load cells with the capacities 0 50n were installed on the top frame to record mooring tension time series the sampling frequency of all sensors were set to be 50 hz 4 decay tests the decay tests were conducted to obtain the natural period and linear damping coefficient of the corresponding motion mode in this study heave and pitch free decay tests were carried out to obtain essential mode information due to the high stiffness of the mooring system in this study it is difficult to conduct the surge and heave motion decay tests once the mooring lines are installed only the pitch decay tests were performed after the mooring ropes being installed the interval between two successive peaks is defined as the natural period the linear damping coefficient is determined by log decrement ratio of peaks 38 γ ζ 1 n ln x i x i n 39 ζ δ γ 4 π 2 γ 2 where γ is the log decrement ratio ζ is the linear damping coefficient x is the amplitude subscript i and n is the index of motion peaks 4 1 free decay tests the heave and pitch free decay curves are shown in fig 8 by applying eqs 38 and 39 the natural periods and linear damping coefficients can be obtained and the results are shown in table 4 it is seen that the natural periods of heave and pitch are 7 21s and 11 76s respectively in order to calibrate the accuracy of the results of free decay tests the hydrodynamic software aqwa ansys inc 2015 is applied to calculate the motion raos of free floating wec and the results are shown in fig 9 according to fig 9 it is seen that the peak period of heave and pitch rao curves is equal to 7 2s and 11 2s respectively which are the simulated natural period of heave and pitch motions it can be found that the numerical natural period of heave and pitch motions are in good agreement with the measured ones 4 2 decay tests with mooring ropes installed since large pretension design was adopted in the model tests to better study the effects of mooring material on system dynamics the stiffness of mooring systems is very large as a consequence it is not easy to conduct the surge and heave decay tests with mooring installed the pitch decay tests of the wec moored by different mooring systems were carried out and decay curves are compared in fig 10 by comparing the results of wire and polyester systems it is clearly seen that the damping induced by wire mooring is greater than that by polyester mooring ropes the natural pitch period and linear damping coefficients are shown in table 5 it is seen that the nylon system owns the largest pitch period this is because the nylon is much more flexible than wire and polyester besides the pretension of the nylon mooring is slightly smaller than the other two mooring ropes as a result the pitch stiffness of nylon is smaller than that of wire and nylon while the pitch period of the system with polyester is close to the wire system it indicates that the pitch restoring stiffness of polyester mooring system is similar to wire mooring system it is also seen that the wire mooring system induces the greatest damping among these three taut mooring systems 5 regular wave tests seventeen regular wave model tests were conducted to study the system dynamics based on the measurements the motion response and mooring tension the raos can be derived the incident wave period in model tests ranges from 0 7 to 2s 4 43 12 66s in full scale and wave height was equal to 0 05m in model scale 2m in full scale the three main motion response raos of the wec are displayed in fig 11 as seen in fig 11 a the natural surge periods of these three systems vary between 4 9s and 5 4s according to the surge peak periods once the wave period exceeds the corresponding surge peak period the surge motion amplitude reduces significantly especially for the nylon system in most of the tested cases the surge motion of the nylon system is greater than the other two systems due to its high flexibility however the surge raos of the wec moored by wire and polyester moorings start to overtake the results of the nylon system once the wave period is greater than 10s in this study the wec has large draft and the fairleads are installed in a high position furthermore the mooring ropes are connected to the frame on the top of wec through pulleys and hooks check fig 1 b consequently both the wave force and mooring tension would give rise to large pitch moment on wec in other words the device has great pitch motion amplitude especially for the stiff mooring systems polyester and wire and under the wave tests with large period with the increase of incident wave period the pitch amplitude improves significantly which give rise to the increase of heave and surge the explanations made above can be verified in fig 11 b and c where it is observed that the heave and pitch motion raos increase dramatically once the wave periods exceed 8s owing to the high flexibility property of nylon the heave motion response amplitude of the system with nylon is greater than that of the systems with polyester and wire in all tested sea cases however the difference is reduced as the wave period increases due to the large pitch motion responses of the wec moored by polyester and wire ropes the wec moored by nylon shows greater pitch motion response than the other two systems when the wave period is less than 8s however an adverse result is found once wave period is greater than 8s and the reason has been discussed above furthermore the motion responses of the wec moored by polyester are slightly greater than that of the wire system due to the fact that the axial stiffness of wire is much greater than polyester rope overall the wec moored by taut mooring ropes shows large pitch motion responses while the amplitude of surge and heave motion responses is small the mooring tension raos are shown in fig 12 when the wave period is smaller than 8s the variations of mooring tension raos are similar to the surge raos in other words the mooring tension raos first increases with wave period until to the surge peak period then it starts to reduce until to t 8s an obvious peak of the nylon tension rao can be found around the surge peak period it indicates that the mooring tension is closely related to the surge motion response when the wave period is less than 8s if the wave period exceeds 8s the pitch motion has the most significant influence on mooring dynamics and the mooring tension raos increase significantly with incident wave period owing to larger heave and pitch amplitude the 1m polyester rope tension raos are even greater than the wire rope results a comparison between tension raos of different mooring ropes shows that the nylon tension is greater than that of polyester in the surge dominated region t 8s the opposite result is found in pitch dominated region t 8s in most cases of surge dominated region the wire rope has greatest tension amplitude despite the fact that the surge motion response of wire system is the smallest this is because the ea of wire rope is much greater than the fibre ropes and even a small axial motion would cause large tension besides if one checks the tension amplitude of mooring ropes installed in different locations it is seen that the 1m is the most loaded one since it is aligned with the incoming wave direction the tension amplitude of 1m is around double the values of 2m and 3m mooring for all tested wave cases according to the decay tests the pitch period of the wec when it is moored by taut mooring systems is greater than 15s to study the system dynamics under pitch resonance mode the regular wave tests with the incident wave period setting as the natural pitch period are conducted i e 16 61s 19 68s and 15 23s in full scale for the wire nylon and polyester system respectively since the pitch motion amplitude of wec with wire and polyester systems in large wave period is similar only the wire and nylon system were experimentally investigated besides three different wave heights were considered to study their influence on system dynamics the motion response raos in pitch resonance sea condition are shown in fig 13 it is clearly seen that the heave motion amplitude increases significantly compared with the normal regular wave tests in fig 13 c it is seen that the wec shows extremely large pitch motion responses in pitch resonance case no matter which mooring system is adopted the pitch raos are greater than 20deg m in all tested cases especially for the wire system in small wave height condition which is close to 28deg m generally it is found that the motion response raos reduce with the incident wave height furthermore the system with wire moorings shows more significant motion response than the system with nylon moorings since the pitch motion is more prominent for the system with stiffer mooring system and the pitch motion is coupled to the heave and surge responses the mooring tension raos are shown in fig 14 where only the 1m result is presented since it is the most loaded one it is seen that the wire tension raos are greater than the nylon rope in all tested cases due to large motion response of wire and great axial stiffness of the wire rope by comparing the tension raos in pitch resonance mode with the other regular wave tests it is seen that the mooring tension amplitude increases dramatically it implies that the extreme mooring tension analysis in pitch resonance mode needs to be taken great care during the mooring design spiral in accordance with the wec motion raos in different wave height the mooring tension also shows the nonlinearities i e the mooring tension amplitude decreases as the increase of wave height 6 irregular wave tests the floating system operates in random waves in the real sea conditions in this study the hydrodynamic responses of wec moored by different taut mooring systems in irregular wave conditions were experimentally studied in head sea the irregular waves were modelled by the jonswap spectra and the generated random waves were calibrated before conducting model tests totally two operational sea conditions were tested including op1 h s 0 05m t p 0 87s in model scale i e h s 2m t p 5 5s in full scale and op2 h s 0 05m t p 0 95s in model scale i e h s 2m t p 6 01s in full scale where the h s means significant wave height and t p denotes wave peak period the peak enhancement factor of jonswap spectra was set as 3 the motion responses of the wec and mooring tensions will be discussed 6 1 compare the numerical simulations with the experimental data it is necessary to perform the numerical simulations and compare the numerical results with the experimental ones to check the agreement between each other the current software is not able to capture the dynamic responses of synthetic fibre mooring ropes due to the viscoelastic and viscoplastic properties in view of this the numerical simulations focus on the wire system and the fully coupled dynamic simulations are conducted in aqwa ansys inc 2015 the numerical model can be found in fig 15 it is seen that the pulleys and hooks used to connect mooring to the wec as seen in fig 1 b are neglected the simulated motion results of the wec moored by the wire mooring system are compared with the measured ones and the results are shown in fig 16 to compare the results clearly only 100s data within the maximum responses are plotted according to the motion response time series it is observed that the numerical results are close to the experimental ones and the greatest difference is found in the heave motion responses this is explained because the pulleys and hooks are neglected in the numerical model in other words the heave restoring force of mooring system is underestimated by the numerical model consequently the heave motion responses are overestimated by the numerical method which can be validated in fig 16 c furthermore the pitch moment of mooring system on wec is underestimated by the numerical model due to the neglected hook which causes to the underestimation of pitch motion responses it is necessary to perform the spectral analysis to compare the components of experimental and numerical motion responses in the motion spectral curves it is observed that the wave property has significant influence on motion responses the spectral peaks that occur near to the wave peak period are observed in all motion responses in addition to the wave peak period the resonance also plays significant role in the motion responses unfortunately the numerical model cannot simulate the hooks and pulleys well enough which gives rise to the difference of natural periods between numerical and experimental motions for instance the greatest spectral peak of the numerical heave motion occurs around 2 92s which should be the natural heave period however no spectral peak can be found in the experimental heave spectrum under this period since the natural heave period of experimental tests is much smaller than 2 92s in the spectral density curves of pitch motion responses the spectral peak due to pitch resonance can be found in the experimental data however the spectral peak is not found in the same frequency for the numerical pitch motions because the natural period of numerical and experimental pitch motion is different the results of mooring tensions of the most loaded one 1m are plotted in fig 17 it is seen that the numerical results are in good agreement with the experimental ones based on the mooring tension spectral density it is observed that the wave period has the most significant influence on mooring tensions the mooring tensions spectral peak is close to the wave peak period in addition the spectral density curve of numerical mooring tension is similar to the experimental ones the statistics of wec motion responses and wire mooring tensions estimated by numerical and experimental methods are compared in table 6 it is seen that the numerical results are in good agreement with the experimental ones and the greatest difference is found in the heave motion responses overall it is concluded that the model tests were well performed and the experimental results are reasonable 6 2 measured motion responses of three systems since the system dynamics in these two operational wave conditions are similar only the results when wec operates in op1 are plotted the three main motion responses of the wec moored by different taut mooring systems in op1 are shown in figs 18 20 only 100s time series are given in order to compare the results clearly according to the results in fig 18 a it is clearly seen that the surge motion shows the wave frequency characteristic due to the large surge restoring stiffness provided by mooring systems there are no significant differences between surge motion responses of wire and polyester systems the surge motion is confined in small region as a result of large mooring stiffness while thanks to the high flexibility of the nylon mooring rope this system shows greater surge motion responses than the other two systems in fig 18 b it is seen that the major energies of surge spectral densities are concentred in the wave frequency region and the spectral peaks are close to the wave peak period this implies that the surge motion is dominated by wave frequency components a clear indication of surge motion of the wec moored by nylon ropes is much greater than that of other systems is seen in fig 18 b where the spectral peak of the nylon system is much more prominent as for the system with polyester ropes it shows the similar surge motion response to the system with wire mooring as shown in fig 19 the wec behaves much more intensively in heave mode when it is moored by nylon ropes than the other two mooring systems despite the similar pretension was adopted for these mooring ropes the reason is that the axial stiffness of nylon rope is much smaller than the other two materials which can be verified in fig 6 it implies that the nylon rope is the preferable material for wec mooring system which shows better energy capturing performance the comparison of heave spectral density curves of different systems illustrates that the heave motion of polyester system is the dominating one the heave motion of the polyester system consists of three components namely the one caused by the pitch motion the component due to the wave motion and the heave resonance while the component closes to the wave peak period is the most important one and the heave resonance part is inferior to it in the heave spectral density curves of wire and polyester systems there are only two spectral peaks that occur near the corresponding pitch natural period and wave peak period the component that happens in the heave resonance is not found due to large stiffness of the wire and polyester mooring ropes in accordance with the surge and heave motion responses the pitch motion of the nylon system is more significant than that of the other two systems the result agrees well with the regular wave model tests that is the nylon system shows the greatest motion responses among these three systems and the difference between polyester and wire systems is negligible when the incident wave period is small less than 8s according to the spectral analysis it is found that both the natural pitch period and wave peak period have significant influence on pitch motion response while the spectral peak occurs near to the wave peak period is the dominant one to study the influence of mooring material on wec motion response carefully the statistics of the wec motion in these two tested irregular wave conditions are listed in tables 7 and 8 it is clearly seen that the maximum motion amplitudes of the wec moored by nylon ropes in these two testes wave conditions are much greater than that of the other two systems for instance the maximum heave amplitude of nylon system is 2 7 and 3 6 times the wire system results when wec operates in op1 and op2 wave conditions respectively overall the motion responses of wec moored by polyester and wire mooring ropes are similar in these two random wave conditions and they are smaller than the results of the wec moored by nylon 6 3 measured mooring dynamics of three systems the dynamics of different mooring ropes in these two operational sea states are studied and a spectral analysis is carried out similar to the motion analysis only 100s data in op1 wave condition are plotted and the results are shown in figs 21 23 in the mooring tension time series it can be found that the amplitude of polyester mooring rope is the smallest this phenomenon can also be clearly identified in the mooring tension spectral densities the spectral peaks of nylon and wire tensions are close and they are much more significant than the ones of polyester it is understood that because the wire mooring rope has great axial stiffness even small motion response will cause large mooring tension consequently the tension amplitudes of wire rope are comparable to the nylon rope results despite that the motion response of wire is smaller than that of nylon as seen in figs 21 b 23 b not only the spectral peak is found near the wave peak frequency 1 14 rad s but also another one closes to the natural pitch frequency 0 38 rad s 0 32 rad s 0 41 rad s for the wire nylon and polyester system respectively can be observed as well it indicates that the pitch motion has some influence on mooring dynamic tensions however its influence is negligible compared to the wave peak period besides the dynamic tensions of 2m and 3m are similar due to symmetrical arrangement and they are smaller than the values of 1m compared to the upwind mooring line the influence of mooring material on mooring dynamic tensions is smaller for the leeward mooring lines it is found that the difference between tension spectral densities of 2m and 3m of different mooring ropes of are smaller than that of 1m the mooring tension statistics in the tested irregular waves are listed in tables 9 and 10 it is seen that the tension characteristics of the wire and nylon rope are similar in these two operational sea states and the maximum tension of nylon mooring is slightly greater than that of wire rope compared to wire and nylon moorings the variations the tension of polyester rope are more stable especially for the 1m for instance the standard deviation of the tension on 1m nylon rope is almost two times to the value of polyester in these two sea states while the maximum 1m mooring tension of nylon is 21 and 29 greater than the value of polyester in op1 and op2 respectively 6 4 short term mooring fatigue damage analysis the rainflow counting technique is applied to the measured mooring tension time series to obtain tension cycles for fatigue damage analysis fig 24 shows the probability of rainflow counting tension range of 1m under op1 sea condition it is seen that the statistical characteristics of wire and nylon rainflow counting tension range are similar the rainflow counting tension cycles occur frequently in the range of 200 400 kn the most important tension cycle that causes fatigue damage of polyester mooring rope occurs between 150 kn and 250 kn furthermore it is found that greatest load cycle of polyester mooring is around 1000 kn which is smaller than the results of wire and nylon mooring ropes besides it is also found that the rainflow counting tension cycles range from 0 to 30 kn are the most frequent ones for synthetic fibre roes it should be noted that the spectral methods for structural fatigue damage analysis are based on the gaussian assumption as a consequence it is necessary to check the statistical properties of mooring tensions the kurtosis and skewness of mooring tensions in all tested sea conditions are depicted in tables 11 and 12 it is seen that the nylon mooring tensions are the closest ones to the gaussian for the gaussian process the kurtosis 3 skewness 0 among these three materials it implies that the spectral methods may provide precise estimations of the fatigue damage of nylon mooring rope to help understand the implementations of spectral methods for mooring fatigue damage analysis fig 25 presents the flowchart of the assessment where rfc denotes the rainflow counting technique the crucial step in the analysis is to obtain the mooring tension spectral densities by using the measured mooring tension raos the mooring tension spectrum is defined as 40 s t e n ω t r a o 2 s w ω where s ten ω is the estimated mooring tension spectrum in the given wave spectrum s w ω t rao is the measured mooring tension raos eq 40 is a very efficient method to obtain structural response spectrum in any given irregular wave conditions without carrying out the expensive and time consuming experimental tests or numerical simulations in this study the measured wave spectral during the model testes are used to calculate mooring tension spectral once the mooring tension spectral density is obtained the fatigue damage can be assessed by applying the spectral methods introduced in section 2 2 to evaluate the performance of spectral methods in mooring fatigue damage analysis the mooring fatigue damage estimated directly from the measured mooring tension time series by applying rainflow counting technique is also presented as the reference values the parameters k and m of the t n curve is 5 05 for wire rope and 10 3 25 3 43lm for spiral wire rope api 2005 where lm is ratio of mean load to reference breaking strength for the polyester rope the k and m is recommended as 7 5 and 9 respectively api 2014 while the k and m for the nylon rope are 10 6 and 3 5 respectively by fitting the experimental data ridge et al 2010 the minimum breaking strength of polyester and nylon rope in full scale are estimated by empirical equations barltrop 1998 johanning et al 2006 xu et al 2019 and this value of wire rope is estimated according to the equations in orcina the comparisons of the expected mooring fatigue damage rate estimated by different methods in the two tested sea conditions are shown in figs 26 and 27 it is seen that the three sophisticated wideband spectral methods discussed provide very similar estimations to mooring fatigue damage in all cases considered as seen the estimated damages are in good agreement with the rainflow counting damage for the wire ropes however the accuracy of spectral methods for fatigue damage analysis of synthetic fibre ropes is not satisfied in some cases for instance the relative error of estimated damage of the leeward polyester ropes 2m and 3m and the upwind nylon rope 1m in op2 sea state is greater than 20 it illustrates that the wideband spectral methods show better performance in fatigue damage analysis for wire than for the synthetic fibre mooring ropes it is because the nonlinearities of the dynamics of synthetic fibre mooring are greater than that of wire it is also seen that the wideband spectral methods present better estimations to fatigue damage of 1m than the other two leeward moorings in most cases especially for the polyester mooring ropes the fatigue damage of 1m is well estimated by the wideband spectral methods while the errors of 2m and 3m are significant it is explained that during the regular model tests the measured tension raos did not cover the range between 1 4 and 1 6 rad s resulting in the underestimations of mooring spectral moments which is closely related in mooring fatigue damage analysis as seen in fig 25 while the leeward moorings are more sensitive to these missing components compared to the 1m since the tension raos of 1m is greater than the results of 2m and 3m as for the simplified correction factor methods it is seen that the α0 75 method provides even more accurate estimations to mooring fatigue damage than sophisticated wideband methods in most cases as for the wirsching light method the estimated results are acceptable for the wire mooring ropes however the wirsching light method underestimates the nylon mooring fatigue damage significantly it seems that the wirsching light provides very good estimations to the leeward polyester mooring fatigue damage the results match well with the that given by rainflow counting this is because of the missing part of mooring tension spectrum is compensated by the overestimations component caused by wirsching light approach overall the wirsching light method shows the worst performance in fatigue damage analysis for the most loaded moorings 1m by comparing the mooring fatigue damage in op1 and op2 it is found that the results are very close in these two operational sea conditions the reason is that the wave peak period of these two irregular sea cases are very close and the significant wave height is identical 7 conclusions experimental tests on the dynamics of a wec buoy moored by taut mooring systems with different rope material are conducted in regular and irregular waves based on the measurements the effects of the nylon polyester and wire ropes on the performance of the wec are discussed the influence of mooring material on wec motion responses can be identified from the experimental data the heave motion response of the system with nylon moorings is the greatest among these three tested systems for all tested regular wave conditions due to the high flexibility of nylon rope however the difference of heave motion responses between different systems reduce with the increase of incident wave period the heave motion response of the polyester and wire system increases dramatically with the incident wave period when the incident wave period is close to the corresponding natural pitch period the heave motion of these two systems is even greater than that of the nylon system for the test cases with the incident wave period less than 8s the pitch motion amplitude of nylon system is greater than that of the other two systems although an inverse result is found when the incident wave period exceeds 8s in the irregular wave model tests the polyester mooring rope tension is the lowest the discussed three wideband spectral methods show good performance in mooring fatigue damage estimation in the majority of cases the α0 75 method is superior to the other methods in estimating fatigue damage of the moorings discussed in this study the wirsching light method shows the worst performance in estimating mooring fatigue damage in most cases however this conclusion is drawn based on the short term fatigue damage of the specified mooring concepts their performances in fatigue damage analysis of the other mooring concepts and in long term fatigue damage analysis still need to be investigated in general the polyester shows similar dynamic characteristics as the wire and the nylon is much more flexible than these two materials for the wec which prefers compliant mooring system the nylon is the preferred mooring choice among these three materials however it needs to be noticed that the nylon suffers greater fatigue damage than polyester and wire in this study the influence of pretension on hydrodynamic responses of wec and mooring dynamics is not investigated and only the head sea condition is considered in the future study the effects of mooring pretension and wave direction on the dynamic responses of wec system will be studied credit authorship contribution statement sheng xu methodology formal analysis writing original draft shan wang methodology writing review editing c guedes soares writing review editing supervision declaration of competing interest there are no conflicts of interest acknowledgement this work was financially supported by the project elastic mooring systems for wave energy converters which is co funded by european union s horizon 2020 research and innovation programme under the framework of oceanera net http oceaneranet eu and by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract oceanera 0006 2016 the work contributes to the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by fct under contract uidb uidp 00134 2020 the authors are grateful to prof h x liu and y m zhang from tianjin university for proving the experiment system for testing synthetic fibre ropes as well as meaningful discussion of experimental procedure the authors are also grateful to prof antonio souto iglesias jordi mas soler and antonio medina mánuel from universidad politécnica de madrid for the interesting discussions and several very useful suggestions about the experimental procedures 
