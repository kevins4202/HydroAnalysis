index,text
21150,the physical phenomena of liquid bodies with free surface are of wide interest in the fields of ocean engineering and coastal engineering to understand and research the physical mechanisms of free surface the recognition and extraction of free surface are important technological tasks in hydrodynamic experimental investigations due to the complexity of free surfaces ways to accurately capture free surfaces have been a continuing challenge in hydrodynamic mechanic experiments in this paper the watershed algorithm based on the difference of gauss filter wadog and an artificial intelligence segmentation technology based on the u net network unet fs are developed to identify different types of free surfaces wadog method can identify smooth free surfaces efficiently and accurately with a dice accuracy of over 0 99 in addition the unet fs method once applied and trained is an efficient recognition model to capture numerous types of free surfaces the optimal unet fs model has good stability and a high dice accuracy of over 0 94 furthermore the applicability of these two methods is also discussed from a physical point of view the results show that these methods have a good prospect of being used in applications that identify free surfaces in ocean and coastal hydrodynamic experiments keywords capture free surface watershed algorithm based on difference of gauss filter artificial intelligence technology u net network dice accuracy sloshing tank 1 introduction the recognition and extraction of liquid free surfaces are essential tasks in the fields of ocean transportation and aerospace engineering for example there is a great deal of research on wave energy converters chaplin et al 2012 farley et al 2012 in coastal engineering in these researches the conversion efficiency is evaluated by the volume change rate of the free surface thus the results of distilling wave surfaces could directly affect equipment design furthermore in deep sea engineering the design of the large containers of floating liquefied natural gas flng requires estimations of the free surface behavior inside the tanks therefore methods to accurately capture wave surface information are important from an engineering science point of view the traditional method to capture wave surface information is to use surface piercing wave gauges fixed at certain points to measure the wave heights an experimental study was conducted to investigate the hydrodynamic characteristics for nearshore and offshore engineering andersen et al 2011 chiapponi et al 2012 peruzzo et al 2018 tripepi et al 2018 ning et al 2012 2016 used four resistance types of wave gauges to measure the instantaneous surface elevation in order to study the hydrodynamic performance of a fixed oscillating water column owc wave energy device in a wave flume he et al 2013 2017 introduced a two point measurement in order to reduce the measurement bias related to the non uniformity in the surface elevation wei et al 2015 applied two capacitance wave transducers to experimentally investigate the wave elevations during liquid sloshing in a tank if the nonlinearity inside the monitoring area is strong doing two point measurements is not sufficient to obtain the information required however the classical surface piercing method can introduce three measurement biases first the wave gauge transfers the electrical signal to the height signal and the wave gauge is always calibrated before the experiment the calibrated coefficient depends on the test media s quality dielectric constant the ambient temperature and the test conditions second the existence of the wave gauge can disturb the ambient flow field in the wave flume or the sloshing tank when the free surface measure is in a very narrow zone the results are inaccurate in addition due to the nonlinearity of the free surface the free surface characteristics in the closed tank cannot be interpolated just by two to three wave probes the fixed wave gauge can only provide local information the higher the quantity of wave probes the higher the accuracy in capturing the wave surface profile however it is difficult to balance the number of the wave probes and their influence on the ambient flow field third the capacitance and conductivity wave gauges can only measure with uniformity in the test media therefore if the free surface entraps some air or the free surface presents plunging spilling or breaking at the wave gauge location the wave height will be inaccurate with improvements in computing power and camera hardware a nonintrusive measurement of the free surface has rapidly developed it is complementary to the traditional method and is based on the analysis of the time signal delivered by a fixed wave gauge the contactless measurement is not affected by the test media quality and it even works well for more than two test liquids second researchers can set many virtual points of measurement interest as many as the number of pixels in the image without influencing the ambient flow field third it can provide the sequential change of the surface wave profile in space and time through an image analysis because the shape of a steep progressive wave can change rapidly especially during the near breaking phase the measurement of the wave profile using a classical fixed gauge can be inaccurate while visualization techniques on the contrary are highly accurate wanek and wu 2006 the optical measurement method is one of the most widely used nonintrusive measurements in hydrodynamic experiments the required steps include employing optical techniques an illumination distribution and video image post processing the post processing technology to extract liquid free surfaces is one of the key issues for optical measurement methods some researchers applied optical measurement methods to analyze wave elevations for example ibanez et al 2007 applied an artificial vision system to measure the wave levels in a wave flume based on the image processing technology of pattern projection cochard and ancey 2008 extracted the phase from the image and used the expansion method to calculate the wave height and reconstruct the free liquid surface tosun et al 2017 and saatci and yazici 2019 using the image of the wave at the edge processed the liquid surface image using an edge detection algorithm to obtain the free surface vagnoni et al 2018 used an image processing method based on image filtering and developed contrast detection by using a 30 pixel width image section close to the wall to compute the inclination and the elevation of the free surface however these methods are limited to capturing smooth continuous liquid bodies and the processing time is extensive moreover the identification of the free surface for a near breaking or breaking wave is a challenge in hydrodynamic experiments blenkinsopp et al 2010 2012 terzic et al 2010 the concept of deep learning was proposed by hinton et al 2006 it involves a class of machine learning techniques that use large modern neural network models to extract relevant image features automatically this method can be used not only for classification but also for the prediction and fitting of nonlinear functions kamal et al 2013 deep learning is a powerful class of tools for analyzing images of dynamic natural features in poly or monochrome physical imagery maire et al 2015 recently there have been applications of deep learning technology to identify wave surface images for coastal engineering lima et al 2017 developed an ocean front recognition algorithm based on a convolutional neural network this method can identify ocean fronts through sea surface temperature sst images pan et al 2018 introduced a deep learning model to inverse the amplitude of internal waves based on a large number of optical remote sensing images buscombe and carini 2019 applied deep convolutional neural networks cnns to estimate wave breaking types from close range monochrome infrared imagery of surf zones stringari et al 2019 proposed a novel image processing technique that detects wave breaking and tracks the waves in the surf zone using machine learning procedures buscombe et al 2020 developed a remote wave gauging technique using a deep convolutional neural network to estimate wave heights and periods from imagery of waves in the surf zone kagemoto 2020 applied a long short term memory lstm model for forecasting a water surface wave train this method works well on time series data but not for image processing a reasonable deep learning model can be a powerful tool for segmenting free surfaces and obtaining wave elevations at as many desired points as possible however there is no current research on systematically capturing and identifying free surfaces in a sloshing tank with high accuracy furthermore liquid sloshing in a tank means that the whole liquid body participates in the movement which is different from the mechanics of wave evolutions in the open sea in this paper two methods are proposed to extract different types of free surfaces in a sloshing tank first the experimental setup is presented then a watershed algorithm based on a difference of gauss filter method is introduced to identify smooth free surfaces efficiently and accurately with a dice accuracy of over 0 99 however this method is not accurate for a free surface with breaking and bubbles thus based on deep learning techniques and the physical evolution of a free surface of waves near breaking or during breaking an efficient recognition model is trained to capture the free surface of liquid bodies with breaking and splashing with a dice accuracy of over 0 94 the results show that these two methods are effective for identifying free surfaces in a sloshing tank which have a good prospect for future applications to identify free surfaces in ocean and coastal hydrodynamic experiments 2 experimental setup the experimental configuration is schematically shown in fig 1 the experiment was conducted at the institute of marine engineering national research council cnr insean rome italy the length width and height of the rectangular container are 1000 mm 100 mm 477 mm respectively the height of the free surface in the tank is 288 mm the container is attached to a moving platform which moves in a swaying motion the tank is subjected to a horizontal harmonic excitation 1 y t η 2 α cos 2 π f t where η 2 a and f are the amplitude and the excitation frequency of the tank movement respectively the excitation amplitude is 20 mm the excitation frequency range is from 0 62 hz to 1 60 hz in order to detect different patterns of free surfaces t is the experimental time which is at least 200 s the flow visualizations are performed through a high speed digital video camera the free surface of the tank is recorded using falcon 1 4m100 dalsa camera a resolution of 1392 1024 pixels and a frame rate of 100 fps are adopted in this study to analyze the free surface behavior of a liquid steady state oscillation in the sloshing tank the camera is triggered to capture 10 s when the experiment starts to 180 s furthermore one led light is employed in the front of the model the locations of the camera and light are carefully adjusted and calibrated during the experiment s preparation in order to avoid image distortion the experimental model and image acquisition system are all conventional hydrodynamic experimental apparatuses 3 the watershed algorithm based on the difference of gauss filter wadog this section is organized to briefly introduce the theory and application of the difference of gauss and the watershed algorithm in identification of free surface then by comparisons with physical phenomena an accuracy assessment and its limitation are provided 3 1 to identify free surface the theory and application of the difference of gauss the difference of gauss dog utilizes the difference between two gaussian functions birch et al 2010 to highlight a larger gradient edge in the gray values and reduce noise and small gradient edges of nongray values the function can be written as 2 d o g x y σ 1 σ 2 g σ 1 x y g σ 2 x y where σ is the gaussian distribution parameter which determines the smoothness of the dog filter g σ x y is the two dimensional gaussian function σ 1 and σ 2 represent the standard deviation of the gaussian function in this study the value of σ 1 and σ 2 are in the range of 4 6 in order to capture the width of the free liquid surface slit x and y are the coordinates of a point the gaussian function is given by 3 g σ x y 1 2 π σ 2 exp x 2 y 2 2 σ 2 the procedure to apply dog to identify free surface is as follows first the experimental image is grayed then a dark slit appears on the free surface with a certain width second function σ is adjusted in order to capture the slit on the free surface accurately third a new image g 12 is obtained by filtering the image with convolutions which presents a higher response at the slit see eq 4 4 g 12 x y σ 1 σ 2 d o g x y σ 1 σ 2 f x y where f x y is the original image and is the convolution operator consequently the position of the free liquid surface is highlighted by dog filtering the original image and the new image after dog filtering are presented in fig 2 the response of the free surface is significantly high and the gray on both sides of the slit and the residual noise are weakened 3 2 to segment a free surface the theory and application of the watershed algorithm the watershed algorithm is a self adaption multithreshold segmentation algorithm beucher 1994 the image is processed similar to a topographical surface in which the altitude of each point is equal to the gray there are holes pierced at the minimum marks of the local parts then sinking the surface into liquid liquid springs through the holes and progressively immerses the adjacent walls when different basins are filled a dam is built at the junction of the two basins therefore the boundary of the dam is the segmentation line of the watershed the advantages of the watershed algorithm are its continuous boundary its high accuracy and its efficiency in this paper the watershed algorithm is applied to the gray image processed by the dog filter see fig 2 b consequently a ridge line is formed at the middle of the image as shown in fig 3 a then the junction of the two basins is a free surface after the simulation of the flooding process see the red line in fig 3 b to check the effect of the segmentation the watershed is superimposed on to the original image as shown in fig 3 c fig 3 shows that the watershed algorithm based on a dog filter can capture the free surface accurately 3 3 the accuracy test to assess the accuracy of the watershed algorithm based on the difference of gauss filter in identifying free surface an accuracy test is performed as follows 3 3 1 parameters according to the conventional accuracy evaluation the dice similarity coefficient dice coefficient milletari et al 2016 is used to evaluate the accuracy of the watershed algorithm based on a dog filter the definition of a dice coefficient can be written as 5 d i c e 2 v a b v a v b where v a is the area of the liquid body determined by manual segmentation the manual segmentation is defaulted to true v b is the area of the liquid body determined by the wadog method tp v a b refers to the correct segmentation liquid area defined by the algorithm as shown in fig 4 the dice coefficient shows the accuracy of the liquid body area predicted by the wadog method the value of the indicator is in the range of 0 00 1 00 when the value is close to 1 00 it means the extracted free surface is close to the true free surface and therefore the algorithm is reliable in contrast if the value is close to 0 00 the algorithm is unreliable furthermore another three indicators are used to evaluate the performance of the segmentation they are recall precision and f1score respectively the definitions of the three indicators are written as 6 re c a l l t p t p f n 7 pr e c i s i o n t p t p f p 8 f 1 s o r e 2 precision recall precision recall where v a b refers to the total superposition liquid area found by both the algorithm and the manual segmentation fn v a b v b means the wrong segmentation liquid area by the algorithm in the true liquid area fp v a b v a refers to the wrong segmentation liquid area by the algorithm in the segmentation area the parameters to calculate a dice coefficient recall precision f1score are shown in fig 4 recall means the area ratio between the correct segmentation of the liquid part by the algorithm and the real liquid area precision shows the ratio between the correct segmentation of the liquid part and the total segmentation liquid area by the algorithm the f1score is a comprehensive evaluation index to evaluate recall and precision 3 3 2 results and discussion combining the physical phenomena of a wave front the validity of the proposed algorithm in one exaction period is qualitatively verified and quantitatively analyzed the excitation frequency ratio f f 1 is 1 60 with the lowest natural frequency f 1 0 77 hz 81 experimental images for the steady state oscillation in one cycle were chosen for validating the algorithm first the characteristic of the wave front is studied the excitation displacement is recorded by a displacement sensor as show in fig 5 fig 5 frame a to h represents the peculiar excitation velocity subjected to positive and negative directions in one period the corresponding physical phenomena of the wave front subjected to the excitation in fig 5 were illustrated in fig 6 the blue dotted line in fig 6 a refers to the still liquid level swl the swl is considered to be a reference level the white arrows refer to the direction of the excitation furthermore the yellow arrows show the evolution direction of the free surface a smooth free surface occurs at the center side of the tank at frame a and propagates to the right of the tank the increasing velocity of the tank motion to the right increases a run up free surface along the right wall see frames b and c at frame b the propagating wave with a significant liquid head travels to the right side then it impacts the right tank wall frames c and d due to the inertial force the liquid in the tank horizontally climbs to the right wall then due to the existence of the right wall the wave head generates a rotational flow with some splashing on the free surface frame d the same mechanism causes a similar event on the opposite side of the tank at successive half cycles of the oscillation of the tank see frames e to h in fig 6 the red line is the true free surface created manually and the blue line is the free surface extracted by the wadog method the extracted free surface is added on to the true one the free surface is captured satisfactorily when the free surface is smooth frames a to c and frames e to g however there are small errors green dotted box in d and h when the fluid runs up along the wall with some splashing the reason for the errors will be discussed in detail later then an accuracy test for the corresponding test by the four indicators is conducted the corresponding dice coefficients for one period from a to h are shown in fig 7 there are three levels used to assess the dice results millctari et al 2016 level i is excellent which requires a dice value larger than 0 85 level ii is fine which means that the dice value is larger than 0 70 and less than 0 85 level iii is bad which means that the dice value is below 0 70 as shown in fig 7 all the dice values in this study are larger than 0 9880 and the mean value of the dice values is 0 9956 in one period furthermore the standard deviation of the dice values is 0 01 the four indicator parameters for 8 time instants in fig 6 are listed in table 1 all four parameters show that the proposed algorithm has excellent segmentation effects and a high accuracy for smooth free surface 3 4 the limitations of the wadog method there are small errors enclosed by the green box in fig 6 d and h furthermore the accuracy assessment also shows that the dice values for frames d and h are less than those under other conditions the reasons for the errors in frames d fig 8 and h fig 9 are analyzed in detail the watershed algorithm based on the dog filter contains two parts the difference of gauss filter and the watershed algorithm dog is sensitive to the distinct slits when the slit is blurred or discontinuous the sensitivity decreases rapidly furthermore the watershed algorithm has high requirements on the ridge line which should keep its continuity as shown in fig 8 b at the stage of the wave running up along the right wall local protuberances by splashing lead to a free surface discontinuity this local discontinuity leads to the uncontrolled fluctuations in fig 6 d similarly the black slits on the free surface in fig 9 b become blurry due to the violent motion of the free surface near the wall this local blurring results in the error in fig 6 h in addition to verify the segmentation of different free surface types free surfaces with microbubbles and breaking waves are tested respectively the algorithm causes errors in the segmentation of the local position for the free surface with microbubbles and rolling fig 10 a furthermore it does not work for a violent free surface with a breaking wave fig 10 b in conclusion even though it could lead to a slight local segmentation error the algorithm has excellent stability high accuracy and efficiency for smooth free surface segmentations without breaking waves because of the requirement of the algorithm it cannot validate violent free surfaces with breaking waves the recognition of nearly breaking or breaking free surface is a complex technical problem for hydrodynamic experiments there are many uncertain factors used to identify the free surface such as the fuzzy boundary between continuous liquids and the breaking wave the gas liquid mixing phenomena on the free surface the criteria of the free surface during breaking and so on these factors make it difficult to accurately obtain the corresponding free surface by conventional methods this section first introduces the framework of an artificial intelligence segmentation technology based on the u net network then the parameters in the contracting and expanding paths are described in detail in order to build the u net model for tracing the free surface the criteria for different types of breaking free surfaces is given from a free surface mechanism point of view to prepare the dataset for training and testing subsequently the training process for the u net model is proposed finally the accuracy of the u net model for segmentation on a liquid free surface with a breaking wave in a sloshing tank is discussed in detail 3 5 the u net structure the neural network applied in this paper is u net developed by ronneberger et al 2015 which is a fully convolutional network fcn it was proposed earlier for a biomedical image segmentation problem in a typical architecture u net acts as an encoder decoder neural network structure which consists of a contracting path left side encode and an expanding path right side decoder as shown in fig 11 a the contracting path is used to extract the important features from the input image it includes 4 blocks and each block contains four layers see fig 11 b first several convolutions with learnt kernels are performed on the input topology in order to produce feature maps and the weight sharing mechanism helps to handle high dimensional data either 2d images or 3d video second an activation function is applied on the resulting feature maps to ensure that the representation in the input space is mapped to a sparse space hence both data invariance and high computational efficiency are achieved third the output is modified by a pooling layer to extract a summary statistic of the nonoverlapping neighborhoods to reduce the number of parameters in the following layers and to control overfitting therefore the pooling layer helps to achieve a slight translation invariance fourth a dropout function is designed to reduce the overfitting for deep neural networks which makes sure the model is not influenced by specific variances during the training process the expanding path constructs the high resolution feature maps by combining low resolution feature maps and spatial information from the contracting path and includes several repeated layers of transposed convolutions concatenations dropouts and convolution operations see fig 11 c first a deconvolution layer is applied to transfer the feature map information into the image information in order to obtain a pixelwise prediction second the concatenation layer is executed to combine the output from the deconvolution layer and the spatial information from the contracting path this action can determine localization information from the contracting path and help to reconstruct high resolution feature maps in the expanding path then the dropout operation and two convolution layers are applied after the concatenation layer to extract the features from the input images the u net model has two main advantages first the u net model combines the global and local feature information by using a concatenation layer thus it can perform with great efficiency based on small datasets second the u net model processes images with a high segmentation accuracy through the contracting and expanding path here the u net model is applied to trace the free surface behavior in the high resolution images with detailed content 3 6 building the u net model for capturing free surface the architecture of the u net network used in this paper is illustrated in fig 11 the parameters used in the u net model are explained in detail each contracting block has two convolutional layers with 3 3 kernels a 2 2 max pooling layer and a dropout layer with a 25 dropout rate see fig 11 b for the 3 3 convolutional layers each edge of the input image is zero padded by one pixel padding 1 which keeps the output feature map size the same as the input size the weights and the bias are two important learnable parameters from the convolutional layers the weights are the values of the kernels the bias is a parameter added after a convolution output before passing it to the activation function a 2 2 max pooling layer is used as the third layer which takes on the matrix size in order to reduce the number of parameters in this layer for example the original image size is 512 512 and after the first max pooling layer it is reduced to 256 256 after that the dropout layer with a dropout rate of 0 25 is used in this study which means that it randomly drops out 25 of the nodes in this layer after the first contracting block extraction the parameters are sent to the successive contracting block and the process is repeated for each block simultaneously the number of kernels after each block improves so that the architecture can learn the complex image features effectively after the contracting path there are two padded convolutional layers with 3 3 kernels following the fourth contracting block each is followed by an activation function relu and these mediate between the contracting path and the expanding path the expanding path has four blocks and each expanding block has five layers fig 11 c for each block in the expanding block the first layer is a deconvolution layer and is designed to upsample the feature maps from a low resolution to a higher resolution the kernel sizes are 2 2 and the stride is 1 the deconvolution layers with 2 2 kernels are zero padded by one pixel the input size is 32 32 in the first deconvolution layer and the output size is 64 64 the second layer of each expanding block is a concatenate layer which concatenates the feature maps from the contracting path to the expanding path at the same level as shown in fig 11 a the fourth block in the expanding path concatenates with the first block in the contracting path the third layer is a dropout layer in addition the fourth and fifth layers of each expanding block are convolutional layers the kernels are 3 3 and the stride is 1 the activation function for each convolutional layer is a relu after the first block expansion the parameters are sent to the next block and the process is repeated the figure size is 512 512 after four expansion processes which maintains the original image size fig 11 a the last layer after the expanding path is the output layer which is a 1 1 padded convolutional layer with a 1 1 kernel and 1 stride and this makes the feature maps go from 64 to 2 the activation function here is a sigmoid as see in eq 9 the output of the sigmoid function is between 0 and 1 and can be interpreted as a probability if the result of the sigmoid function is 0 it means water otherwise it means liquid 9 s x 1 1 e x where x refers to the output from a 1 1 convolution the specific parameters for building the u net model for segmenting free surfaces are listed in table 2 3 7 data preparation the essential issue for the u net model is the preparation of comprehensive and correct samples to teach the network the desired invariance therefore the definition of the free surface with wave breaking must be given in order to prepare the samples different types of breaking waves were studied to accumulate enough samples here the experimental condition with f f 1 2 00 is shown as an example the corresponding tank displacement is illustrated in fig 12 to explore the free surface mechanics and learn the behavior of the free surface with wave breaking in detail the kinematic free surface during wave breaking is illustrated in fig 13 each frame is separated into two parts which is named the left part lp and the right part rp respectively in addition the swl is indicated by the blue dash dot line the maximum location for the continuity liquid is marked by the gray horizontal dash dot line the direction of the tank motion and the trend of the free surface are shown by the white and yellow arrows respectively the splashing during liquid slamming is illustrated by the yellow dot arrows the liquid body propagates from right to left at the beginning as shown in fig 13 a and b in addition the liquid runs up along the left wall frame a then the tank moves to the maximum positive position and its velocity gradually goes to zero due to the presence of the left wall and the inertial force of the liquid the horizontal velocity of the liquid goes to zero as well the liquid accumulates toward the left wall and runs up along the left wall the potential energy of the flow continuously transforms into the kinetic energy of the liquid moving along the sidewall because of the interaction between the wall and liquid there exists a rolling tongue with gas liquid mixing green box in frame b thus the kinetic energy partially transforms into turbulent kinetic energy and the flow of energy is dissipated by means of turbulence dissipation the free surface near the breaking contains the maximum energy when the dissipation occurs the total energy of the liquid decreases thus the free surface near or just at the start of the breaking should be accurately captured and the successive large splashing caused by the rolling tongue can be ignored the area of the rolling tongue increases and the volume of the continuity liquid body near the left wall increases as well while the free surface in the right part decreases from frames b to c due to gravity the rolling tongue starts to fall into the free surface in the left part of the tank yellow dot arrow in frames b and c at this stage there exists some bubbles around the top level zoom the whole free surface marked by a yellow arrow line is clear and can be captured therefore the free surface without the large splashes can be found when the vertical velocity of the liquid goes to zero the liquid body tends to move from left to right through gravity and excitation frame d the potential energy of the liquid gradually turns into kinematic energy the top level of the liquid body reaches the maximum vertical threshold and the free surface is still clear frame e then the tip of the rolling tongue area propagates to the middle of the tank and its area decreases meanwhile the liquid in the right part begins to run along the right wall slowly frame f then the liquid in the left part falls down to the swl and the one in the right part raises up along the right wall frame g and h furthermore the top level of the liquid body reaches the minimum position in this region the liquid falls and penetrates into the free surface which causes gas liquid mixing in the liquid body frame i the whole liquid body tends to move along the right wall during the mentioned process the free surface is clear a similar phenomena happens in the next half cycle thus according to the physical mechanics of free surface with breaking the free surface is distinguished using the following criterion in fig 14 1 when the wave surface runs up or starts to roll along the wall the edge of the continuous liquid body is the free surface see fig 14 a 2 when the splashing falls freely and the slamming liquid body causes the gas liquid mixing phenomena the edge of liquid body containing a small amount of bubbles is designated as the free surface see fig 14 b we selected at least 1000 pictures of different types of free surfaces as a dataset including wave with rolling tongue crushing slamming bubbles and other types of wave fronts in order to train an accuracy model approximately 80 of the data is used as the training set and the remaining 20 is used as the checking set another 600 pictures are used as the testing dataset 3 8 training the u net model for capturing a free surface the configuration of the laboratory computer is listed in table 3 the operating system installed is ubuntu 14 04 the main software packages consist of python3 7 6 cuda 10 1 tensorflow 2 1 0 etc the loss function measures the average difference between the predicted values and the true model here the cross entropy function is used as the loss function which is defined as 10 e i 1 m k 1 k w x i log p k x i where x i represents the vectored features m represents the number of samples k represents the number of classes p k x i is the probability of that sample w is a weight map that we introduce to give important pixel information during the training the lower the value of the loss function the more correct the prediction is an optimizer optimization algorithm is then applied to estimate the model parameters kernel weights and biases that minimize the loss function in this paper adam is used as the optimizer the training procedures are illustrated in fig 15 1 prepare the grayscale images as training checking and testing datasets then place the training dataset into the u net network on the last layer of the u net network the sigmoid function is applied to normalize the output which detects water and liquid in the results consequently the free surface is found then the loss function is computed and the optimizer is applied to converge the value of the loss function until the loss function reaches a global minimum the preliminary model is saved 2 the segmentation effect of the u net network is verified by using a checking set a more precise model is obtained by adjusting the parameters and retraining the model constantly 3 the accuracy of the model is verified by the testing dataset when the dice coefficients are larger than 0 85 the optimal model for extracting the free surface is saved otherwise the training set is extended and retrains a new model from step1 to increase the accuracy of the model here the optimal model for segmenting free surfaces is named the unet fs model the main parameters used during training of the u net model for segmenting free surfaces are listed in the table 4 3 9 the accuracy test to evaluate the performance of the unet fs model first the segmentation is analyzed qualitatively by a testing dataset from a physical point of view the testing set contains 600 samples here the testing example is excited by the frequency ratio f f 1 1 90 the excitation displacement shown in fig 16 stands for the peculiar moment in one period sixty eight experimental images under steady state oscillation in one cycle are analyzed for estimating the performance of the unet fs model for segmenting the free surface in detail second four indicators are given to quantitatively evaluate the performance of the unet fs model third the reasons for the segmentation errors are given in detail finally the applicability of the unet fs model for free surfaces is discussed the corresponding physical phenomena of a wave front under the specific excitation see fig 16 are illustrated in fig 17 the blue dotted line in fig 17 refers to the swl the white and yellow arrows refer to the direction of the excitation and the evolution direction of the free surface respectively the red line is the true free surface obtained manually and the blue line is the free surface extracted by the unet fs model in addition the green dotted box shows the error and the yellow dotted arrow refers to the direction of the wave splashing the liquid body tends to move from left to right by gravity as shown from frames a to c during the process the potential energy of the liquid tends to gradually transform to kinematic energy the tip of the rolling tongue area propagates to the middle of the tank and its area decreases meanwhile the liquid in the right part begins to run up along the right wall slowly frames a and b the top level of the liquid body reduces and it reaches the minimum position at frame c the free surface without breaking is clear in this process the boundary of the splashing is blurry at the edge between the splashing and the free surface there exist some segmentation errors the liquid falls freely and penetrates into the free surface which causes gas liquid mixing in the liquid body frame c thus this complicated phenomenon causes a slight segmentation error in frame c then the tank moves to the maximum positive position and changes to the negative direction however due to the inertial force the whole liquid body still moves and accumulates toward the right wall frame e from frames d to e the free surface is segmented correctly the free surface runs up along the right wall and rolls with splashing then the rolling tongue falls in the middle of the tank frame f after that the liquid body tends to move to the left wall in the same excitation direction as the tank moves due to the left wall the free surface accumulates along the left wall frames e to h during these processes the free surface is segmented with some errors the accuracy test for the corresponding test by the dice coefficients is conducted to quantitatively evaluate the efficiency see fig 18 the total dice coefficient of the unet fs model is larger than 0 9400 and the mean value of the dice coefficients is 0 9960 in one period furthermore the standard deviation of the dice measure is 0 01 even at the stage of splashing and gas liquid mixing the dice value is fluctuating from 0 94 to 0 96 although the value of dice for splashing and gas liquid mixing is slightly lower than the average value it still maintains relative high accuracy the four indicator parameters for the unet fs model for the 8 time instants in fig 17 are listed in table 5 all the four parameters show that the unet fs model has an excellent segmentation effect and high accuracy for identifying free surfaces according to the physical evolution of the free surface and its corresponding dice coefficient slight segmentation errors are present when large area splashing happens to improve the accuracy at frames b dice coefficient approximately 0 94 and g dice coefficient approximately 0 95 we zoom and analyze the segmentation at these two time instants the main reason for the error in frame b in fig 17 is that the local edge between the continuous liquid body and the splashing tends to be blurred see fig 19 and the unet fs model has difficulty in discerning the free surface even when there exists an error according to the definition of free surface with breaking in section 4 3 it is acceptable additionally when there is a complex liquid shadow the free surface is blurred as in frame g in fig 17 as shown in fig 20 this type of free surface is not considered in the training set therefore this problem could be solved by training a new optimal model since the model training is an online process to find the optimization we extend the shadow samples and retrain a new optimal model in order to obtain the new segmentation case furthermore in comparison with the segmentation of the wadog method on a smooth free surface case fig 6 the unet fs model also has an efficient recognition effect on a smooth free surface see fig 21 furthermore the unet fs model has a higher accuracy than the wadog method to segment free surfaces with discontinuous edge as shown in frames d and h in fig 6 which are compared in fig 22 overall the proposed unet fs model can be used for different types of free surface segmentations and it has an excellent segmentation effect and stability 4 conclusions the nonintrusive measurement of free surfaces has been widely used to record the physical evolution in a tank containing liquid bodies method to capture free surfaces accurately in a sloshing tank by using image technology is an important issue in ocean engineering in this paper we first proposed the watershed algorithm based on a gauss filter to segment the free surface the proposed algorithm is tested by four indicators from a physical point of view the results show that the wadog method has high accuracy for smooth free surfaces however because of the limitation of the algorithm it cannot accurately recognize the characteristics of a free surface when there were bubbles or breaking a deep learning method using a u net network is applied to segment the free surface which has the advantage of considering the kinematic characteristics of free surfaces the u net model is built and trained to segment different types of free surfaces from a physical and mechanical point of view the optimal unet fs model could segment free surfaces with breaking and bubbles with high accuracy therefore artificial intelligence technology can efficiently extract complex free surfaces through proper data preparation and the training of an optimal model it is suggested to prepare high quality dataset in order to obtain accurate unet fs model these two methods have good prospects for use in applications to identify the free surfaces in ocean and coastal hydrodynamic experiments disclosure statement no potential conflict of interest was reported by the authors funding this work was supported by the national natural science foundation of china 11602051 51639004 the national key research and development program of china 2018yfa0605902 the chinese postdoctoral science foundation 2016m591433 the liaoning provincial natural science foundation of china 20170540151 and the fundamental research funds for the central universities dut19rc 3 023 norwegian university of science and technology research council of norway through the centres of excellence funding scheme amos senter for autonome marine operasjoner og systemer 223254 credit authorship contribution statement zhijun wei writing original draft gangjun zhai has made contributions to provide the idea and perform the watershed algorithm based on difference of gauss filter to capture free surface ziming wang has built and trained unet model to capture free surface wenyuan wang has taken part in evaluating the accuracy test shunying ji writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement we appreciate yunlong dong from huazhong university of science and technology for his suggestion on training u net model 
21150,the physical phenomena of liquid bodies with free surface are of wide interest in the fields of ocean engineering and coastal engineering to understand and research the physical mechanisms of free surface the recognition and extraction of free surface are important technological tasks in hydrodynamic experimental investigations due to the complexity of free surfaces ways to accurately capture free surfaces have been a continuing challenge in hydrodynamic mechanic experiments in this paper the watershed algorithm based on the difference of gauss filter wadog and an artificial intelligence segmentation technology based on the u net network unet fs are developed to identify different types of free surfaces wadog method can identify smooth free surfaces efficiently and accurately with a dice accuracy of over 0 99 in addition the unet fs method once applied and trained is an efficient recognition model to capture numerous types of free surfaces the optimal unet fs model has good stability and a high dice accuracy of over 0 94 furthermore the applicability of these two methods is also discussed from a physical point of view the results show that these methods have a good prospect of being used in applications that identify free surfaces in ocean and coastal hydrodynamic experiments keywords capture free surface watershed algorithm based on difference of gauss filter artificial intelligence technology u net network dice accuracy sloshing tank 1 introduction the recognition and extraction of liquid free surfaces are essential tasks in the fields of ocean transportation and aerospace engineering for example there is a great deal of research on wave energy converters chaplin et al 2012 farley et al 2012 in coastal engineering in these researches the conversion efficiency is evaluated by the volume change rate of the free surface thus the results of distilling wave surfaces could directly affect equipment design furthermore in deep sea engineering the design of the large containers of floating liquefied natural gas flng requires estimations of the free surface behavior inside the tanks therefore methods to accurately capture wave surface information are important from an engineering science point of view the traditional method to capture wave surface information is to use surface piercing wave gauges fixed at certain points to measure the wave heights an experimental study was conducted to investigate the hydrodynamic characteristics for nearshore and offshore engineering andersen et al 2011 chiapponi et al 2012 peruzzo et al 2018 tripepi et al 2018 ning et al 2012 2016 used four resistance types of wave gauges to measure the instantaneous surface elevation in order to study the hydrodynamic performance of a fixed oscillating water column owc wave energy device in a wave flume he et al 2013 2017 introduced a two point measurement in order to reduce the measurement bias related to the non uniformity in the surface elevation wei et al 2015 applied two capacitance wave transducers to experimentally investigate the wave elevations during liquid sloshing in a tank if the nonlinearity inside the monitoring area is strong doing two point measurements is not sufficient to obtain the information required however the classical surface piercing method can introduce three measurement biases first the wave gauge transfers the electrical signal to the height signal and the wave gauge is always calibrated before the experiment the calibrated coefficient depends on the test media s quality dielectric constant the ambient temperature and the test conditions second the existence of the wave gauge can disturb the ambient flow field in the wave flume or the sloshing tank when the free surface measure is in a very narrow zone the results are inaccurate in addition due to the nonlinearity of the free surface the free surface characteristics in the closed tank cannot be interpolated just by two to three wave probes the fixed wave gauge can only provide local information the higher the quantity of wave probes the higher the accuracy in capturing the wave surface profile however it is difficult to balance the number of the wave probes and their influence on the ambient flow field third the capacitance and conductivity wave gauges can only measure with uniformity in the test media therefore if the free surface entraps some air or the free surface presents plunging spilling or breaking at the wave gauge location the wave height will be inaccurate with improvements in computing power and camera hardware a nonintrusive measurement of the free surface has rapidly developed it is complementary to the traditional method and is based on the analysis of the time signal delivered by a fixed wave gauge the contactless measurement is not affected by the test media quality and it even works well for more than two test liquids second researchers can set many virtual points of measurement interest as many as the number of pixels in the image without influencing the ambient flow field third it can provide the sequential change of the surface wave profile in space and time through an image analysis because the shape of a steep progressive wave can change rapidly especially during the near breaking phase the measurement of the wave profile using a classical fixed gauge can be inaccurate while visualization techniques on the contrary are highly accurate wanek and wu 2006 the optical measurement method is one of the most widely used nonintrusive measurements in hydrodynamic experiments the required steps include employing optical techniques an illumination distribution and video image post processing the post processing technology to extract liquid free surfaces is one of the key issues for optical measurement methods some researchers applied optical measurement methods to analyze wave elevations for example ibanez et al 2007 applied an artificial vision system to measure the wave levels in a wave flume based on the image processing technology of pattern projection cochard and ancey 2008 extracted the phase from the image and used the expansion method to calculate the wave height and reconstruct the free liquid surface tosun et al 2017 and saatci and yazici 2019 using the image of the wave at the edge processed the liquid surface image using an edge detection algorithm to obtain the free surface vagnoni et al 2018 used an image processing method based on image filtering and developed contrast detection by using a 30 pixel width image section close to the wall to compute the inclination and the elevation of the free surface however these methods are limited to capturing smooth continuous liquid bodies and the processing time is extensive moreover the identification of the free surface for a near breaking or breaking wave is a challenge in hydrodynamic experiments blenkinsopp et al 2010 2012 terzic et al 2010 the concept of deep learning was proposed by hinton et al 2006 it involves a class of machine learning techniques that use large modern neural network models to extract relevant image features automatically this method can be used not only for classification but also for the prediction and fitting of nonlinear functions kamal et al 2013 deep learning is a powerful class of tools for analyzing images of dynamic natural features in poly or monochrome physical imagery maire et al 2015 recently there have been applications of deep learning technology to identify wave surface images for coastal engineering lima et al 2017 developed an ocean front recognition algorithm based on a convolutional neural network this method can identify ocean fronts through sea surface temperature sst images pan et al 2018 introduced a deep learning model to inverse the amplitude of internal waves based on a large number of optical remote sensing images buscombe and carini 2019 applied deep convolutional neural networks cnns to estimate wave breaking types from close range monochrome infrared imagery of surf zones stringari et al 2019 proposed a novel image processing technique that detects wave breaking and tracks the waves in the surf zone using machine learning procedures buscombe et al 2020 developed a remote wave gauging technique using a deep convolutional neural network to estimate wave heights and periods from imagery of waves in the surf zone kagemoto 2020 applied a long short term memory lstm model for forecasting a water surface wave train this method works well on time series data but not for image processing a reasonable deep learning model can be a powerful tool for segmenting free surfaces and obtaining wave elevations at as many desired points as possible however there is no current research on systematically capturing and identifying free surfaces in a sloshing tank with high accuracy furthermore liquid sloshing in a tank means that the whole liquid body participates in the movement which is different from the mechanics of wave evolutions in the open sea in this paper two methods are proposed to extract different types of free surfaces in a sloshing tank first the experimental setup is presented then a watershed algorithm based on a difference of gauss filter method is introduced to identify smooth free surfaces efficiently and accurately with a dice accuracy of over 0 99 however this method is not accurate for a free surface with breaking and bubbles thus based on deep learning techniques and the physical evolution of a free surface of waves near breaking or during breaking an efficient recognition model is trained to capture the free surface of liquid bodies with breaking and splashing with a dice accuracy of over 0 94 the results show that these two methods are effective for identifying free surfaces in a sloshing tank which have a good prospect for future applications to identify free surfaces in ocean and coastal hydrodynamic experiments 2 experimental setup the experimental configuration is schematically shown in fig 1 the experiment was conducted at the institute of marine engineering national research council cnr insean rome italy the length width and height of the rectangular container are 1000 mm 100 mm 477 mm respectively the height of the free surface in the tank is 288 mm the container is attached to a moving platform which moves in a swaying motion the tank is subjected to a horizontal harmonic excitation 1 y t η 2 α cos 2 π f t where η 2 a and f are the amplitude and the excitation frequency of the tank movement respectively the excitation amplitude is 20 mm the excitation frequency range is from 0 62 hz to 1 60 hz in order to detect different patterns of free surfaces t is the experimental time which is at least 200 s the flow visualizations are performed through a high speed digital video camera the free surface of the tank is recorded using falcon 1 4m100 dalsa camera a resolution of 1392 1024 pixels and a frame rate of 100 fps are adopted in this study to analyze the free surface behavior of a liquid steady state oscillation in the sloshing tank the camera is triggered to capture 10 s when the experiment starts to 180 s furthermore one led light is employed in the front of the model the locations of the camera and light are carefully adjusted and calibrated during the experiment s preparation in order to avoid image distortion the experimental model and image acquisition system are all conventional hydrodynamic experimental apparatuses 3 the watershed algorithm based on the difference of gauss filter wadog this section is organized to briefly introduce the theory and application of the difference of gauss and the watershed algorithm in identification of free surface then by comparisons with physical phenomena an accuracy assessment and its limitation are provided 3 1 to identify free surface the theory and application of the difference of gauss the difference of gauss dog utilizes the difference between two gaussian functions birch et al 2010 to highlight a larger gradient edge in the gray values and reduce noise and small gradient edges of nongray values the function can be written as 2 d o g x y σ 1 σ 2 g σ 1 x y g σ 2 x y where σ is the gaussian distribution parameter which determines the smoothness of the dog filter g σ x y is the two dimensional gaussian function σ 1 and σ 2 represent the standard deviation of the gaussian function in this study the value of σ 1 and σ 2 are in the range of 4 6 in order to capture the width of the free liquid surface slit x and y are the coordinates of a point the gaussian function is given by 3 g σ x y 1 2 π σ 2 exp x 2 y 2 2 σ 2 the procedure to apply dog to identify free surface is as follows first the experimental image is grayed then a dark slit appears on the free surface with a certain width second function σ is adjusted in order to capture the slit on the free surface accurately third a new image g 12 is obtained by filtering the image with convolutions which presents a higher response at the slit see eq 4 4 g 12 x y σ 1 σ 2 d o g x y σ 1 σ 2 f x y where f x y is the original image and is the convolution operator consequently the position of the free liquid surface is highlighted by dog filtering the original image and the new image after dog filtering are presented in fig 2 the response of the free surface is significantly high and the gray on both sides of the slit and the residual noise are weakened 3 2 to segment a free surface the theory and application of the watershed algorithm the watershed algorithm is a self adaption multithreshold segmentation algorithm beucher 1994 the image is processed similar to a topographical surface in which the altitude of each point is equal to the gray there are holes pierced at the minimum marks of the local parts then sinking the surface into liquid liquid springs through the holes and progressively immerses the adjacent walls when different basins are filled a dam is built at the junction of the two basins therefore the boundary of the dam is the segmentation line of the watershed the advantages of the watershed algorithm are its continuous boundary its high accuracy and its efficiency in this paper the watershed algorithm is applied to the gray image processed by the dog filter see fig 2 b consequently a ridge line is formed at the middle of the image as shown in fig 3 a then the junction of the two basins is a free surface after the simulation of the flooding process see the red line in fig 3 b to check the effect of the segmentation the watershed is superimposed on to the original image as shown in fig 3 c fig 3 shows that the watershed algorithm based on a dog filter can capture the free surface accurately 3 3 the accuracy test to assess the accuracy of the watershed algorithm based on the difference of gauss filter in identifying free surface an accuracy test is performed as follows 3 3 1 parameters according to the conventional accuracy evaluation the dice similarity coefficient dice coefficient milletari et al 2016 is used to evaluate the accuracy of the watershed algorithm based on a dog filter the definition of a dice coefficient can be written as 5 d i c e 2 v a b v a v b where v a is the area of the liquid body determined by manual segmentation the manual segmentation is defaulted to true v b is the area of the liquid body determined by the wadog method tp v a b refers to the correct segmentation liquid area defined by the algorithm as shown in fig 4 the dice coefficient shows the accuracy of the liquid body area predicted by the wadog method the value of the indicator is in the range of 0 00 1 00 when the value is close to 1 00 it means the extracted free surface is close to the true free surface and therefore the algorithm is reliable in contrast if the value is close to 0 00 the algorithm is unreliable furthermore another three indicators are used to evaluate the performance of the segmentation they are recall precision and f1score respectively the definitions of the three indicators are written as 6 re c a l l t p t p f n 7 pr e c i s i o n t p t p f p 8 f 1 s o r e 2 precision recall precision recall where v a b refers to the total superposition liquid area found by both the algorithm and the manual segmentation fn v a b v b means the wrong segmentation liquid area by the algorithm in the true liquid area fp v a b v a refers to the wrong segmentation liquid area by the algorithm in the segmentation area the parameters to calculate a dice coefficient recall precision f1score are shown in fig 4 recall means the area ratio between the correct segmentation of the liquid part by the algorithm and the real liquid area precision shows the ratio between the correct segmentation of the liquid part and the total segmentation liquid area by the algorithm the f1score is a comprehensive evaluation index to evaluate recall and precision 3 3 2 results and discussion combining the physical phenomena of a wave front the validity of the proposed algorithm in one exaction period is qualitatively verified and quantitatively analyzed the excitation frequency ratio f f 1 is 1 60 with the lowest natural frequency f 1 0 77 hz 81 experimental images for the steady state oscillation in one cycle were chosen for validating the algorithm first the characteristic of the wave front is studied the excitation displacement is recorded by a displacement sensor as show in fig 5 fig 5 frame a to h represents the peculiar excitation velocity subjected to positive and negative directions in one period the corresponding physical phenomena of the wave front subjected to the excitation in fig 5 were illustrated in fig 6 the blue dotted line in fig 6 a refers to the still liquid level swl the swl is considered to be a reference level the white arrows refer to the direction of the excitation furthermore the yellow arrows show the evolution direction of the free surface a smooth free surface occurs at the center side of the tank at frame a and propagates to the right of the tank the increasing velocity of the tank motion to the right increases a run up free surface along the right wall see frames b and c at frame b the propagating wave with a significant liquid head travels to the right side then it impacts the right tank wall frames c and d due to the inertial force the liquid in the tank horizontally climbs to the right wall then due to the existence of the right wall the wave head generates a rotational flow with some splashing on the free surface frame d the same mechanism causes a similar event on the opposite side of the tank at successive half cycles of the oscillation of the tank see frames e to h in fig 6 the red line is the true free surface created manually and the blue line is the free surface extracted by the wadog method the extracted free surface is added on to the true one the free surface is captured satisfactorily when the free surface is smooth frames a to c and frames e to g however there are small errors green dotted box in d and h when the fluid runs up along the wall with some splashing the reason for the errors will be discussed in detail later then an accuracy test for the corresponding test by the four indicators is conducted the corresponding dice coefficients for one period from a to h are shown in fig 7 there are three levels used to assess the dice results millctari et al 2016 level i is excellent which requires a dice value larger than 0 85 level ii is fine which means that the dice value is larger than 0 70 and less than 0 85 level iii is bad which means that the dice value is below 0 70 as shown in fig 7 all the dice values in this study are larger than 0 9880 and the mean value of the dice values is 0 9956 in one period furthermore the standard deviation of the dice values is 0 01 the four indicator parameters for 8 time instants in fig 6 are listed in table 1 all four parameters show that the proposed algorithm has excellent segmentation effects and a high accuracy for smooth free surface 3 4 the limitations of the wadog method there are small errors enclosed by the green box in fig 6 d and h furthermore the accuracy assessment also shows that the dice values for frames d and h are less than those under other conditions the reasons for the errors in frames d fig 8 and h fig 9 are analyzed in detail the watershed algorithm based on the dog filter contains two parts the difference of gauss filter and the watershed algorithm dog is sensitive to the distinct slits when the slit is blurred or discontinuous the sensitivity decreases rapidly furthermore the watershed algorithm has high requirements on the ridge line which should keep its continuity as shown in fig 8 b at the stage of the wave running up along the right wall local protuberances by splashing lead to a free surface discontinuity this local discontinuity leads to the uncontrolled fluctuations in fig 6 d similarly the black slits on the free surface in fig 9 b become blurry due to the violent motion of the free surface near the wall this local blurring results in the error in fig 6 h in addition to verify the segmentation of different free surface types free surfaces with microbubbles and breaking waves are tested respectively the algorithm causes errors in the segmentation of the local position for the free surface with microbubbles and rolling fig 10 a furthermore it does not work for a violent free surface with a breaking wave fig 10 b in conclusion even though it could lead to a slight local segmentation error the algorithm has excellent stability high accuracy and efficiency for smooth free surface segmentations without breaking waves because of the requirement of the algorithm it cannot validate violent free surfaces with breaking waves the recognition of nearly breaking or breaking free surface is a complex technical problem for hydrodynamic experiments there are many uncertain factors used to identify the free surface such as the fuzzy boundary between continuous liquids and the breaking wave the gas liquid mixing phenomena on the free surface the criteria of the free surface during breaking and so on these factors make it difficult to accurately obtain the corresponding free surface by conventional methods this section first introduces the framework of an artificial intelligence segmentation technology based on the u net network then the parameters in the contracting and expanding paths are described in detail in order to build the u net model for tracing the free surface the criteria for different types of breaking free surfaces is given from a free surface mechanism point of view to prepare the dataset for training and testing subsequently the training process for the u net model is proposed finally the accuracy of the u net model for segmentation on a liquid free surface with a breaking wave in a sloshing tank is discussed in detail 3 5 the u net structure the neural network applied in this paper is u net developed by ronneberger et al 2015 which is a fully convolutional network fcn it was proposed earlier for a biomedical image segmentation problem in a typical architecture u net acts as an encoder decoder neural network structure which consists of a contracting path left side encode and an expanding path right side decoder as shown in fig 11 a the contracting path is used to extract the important features from the input image it includes 4 blocks and each block contains four layers see fig 11 b first several convolutions with learnt kernels are performed on the input topology in order to produce feature maps and the weight sharing mechanism helps to handle high dimensional data either 2d images or 3d video second an activation function is applied on the resulting feature maps to ensure that the representation in the input space is mapped to a sparse space hence both data invariance and high computational efficiency are achieved third the output is modified by a pooling layer to extract a summary statistic of the nonoverlapping neighborhoods to reduce the number of parameters in the following layers and to control overfitting therefore the pooling layer helps to achieve a slight translation invariance fourth a dropout function is designed to reduce the overfitting for deep neural networks which makes sure the model is not influenced by specific variances during the training process the expanding path constructs the high resolution feature maps by combining low resolution feature maps and spatial information from the contracting path and includes several repeated layers of transposed convolutions concatenations dropouts and convolution operations see fig 11 c first a deconvolution layer is applied to transfer the feature map information into the image information in order to obtain a pixelwise prediction second the concatenation layer is executed to combine the output from the deconvolution layer and the spatial information from the contracting path this action can determine localization information from the contracting path and help to reconstruct high resolution feature maps in the expanding path then the dropout operation and two convolution layers are applied after the concatenation layer to extract the features from the input images the u net model has two main advantages first the u net model combines the global and local feature information by using a concatenation layer thus it can perform with great efficiency based on small datasets second the u net model processes images with a high segmentation accuracy through the contracting and expanding path here the u net model is applied to trace the free surface behavior in the high resolution images with detailed content 3 6 building the u net model for capturing free surface the architecture of the u net network used in this paper is illustrated in fig 11 the parameters used in the u net model are explained in detail each contracting block has two convolutional layers with 3 3 kernels a 2 2 max pooling layer and a dropout layer with a 25 dropout rate see fig 11 b for the 3 3 convolutional layers each edge of the input image is zero padded by one pixel padding 1 which keeps the output feature map size the same as the input size the weights and the bias are two important learnable parameters from the convolutional layers the weights are the values of the kernels the bias is a parameter added after a convolution output before passing it to the activation function a 2 2 max pooling layer is used as the third layer which takes on the matrix size in order to reduce the number of parameters in this layer for example the original image size is 512 512 and after the first max pooling layer it is reduced to 256 256 after that the dropout layer with a dropout rate of 0 25 is used in this study which means that it randomly drops out 25 of the nodes in this layer after the first contracting block extraction the parameters are sent to the successive contracting block and the process is repeated for each block simultaneously the number of kernels after each block improves so that the architecture can learn the complex image features effectively after the contracting path there are two padded convolutional layers with 3 3 kernels following the fourth contracting block each is followed by an activation function relu and these mediate between the contracting path and the expanding path the expanding path has four blocks and each expanding block has five layers fig 11 c for each block in the expanding block the first layer is a deconvolution layer and is designed to upsample the feature maps from a low resolution to a higher resolution the kernel sizes are 2 2 and the stride is 1 the deconvolution layers with 2 2 kernels are zero padded by one pixel the input size is 32 32 in the first deconvolution layer and the output size is 64 64 the second layer of each expanding block is a concatenate layer which concatenates the feature maps from the contracting path to the expanding path at the same level as shown in fig 11 a the fourth block in the expanding path concatenates with the first block in the contracting path the third layer is a dropout layer in addition the fourth and fifth layers of each expanding block are convolutional layers the kernels are 3 3 and the stride is 1 the activation function for each convolutional layer is a relu after the first block expansion the parameters are sent to the next block and the process is repeated the figure size is 512 512 after four expansion processes which maintains the original image size fig 11 a the last layer after the expanding path is the output layer which is a 1 1 padded convolutional layer with a 1 1 kernel and 1 stride and this makes the feature maps go from 64 to 2 the activation function here is a sigmoid as see in eq 9 the output of the sigmoid function is between 0 and 1 and can be interpreted as a probability if the result of the sigmoid function is 0 it means water otherwise it means liquid 9 s x 1 1 e x where x refers to the output from a 1 1 convolution the specific parameters for building the u net model for segmenting free surfaces are listed in table 2 3 7 data preparation the essential issue for the u net model is the preparation of comprehensive and correct samples to teach the network the desired invariance therefore the definition of the free surface with wave breaking must be given in order to prepare the samples different types of breaking waves were studied to accumulate enough samples here the experimental condition with f f 1 2 00 is shown as an example the corresponding tank displacement is illustrated in fig 12 to explore the free surface mechanics and learn the behavior of the free surface with wave breaking in detail the kinematic free surface during wave breaking is illustrated in fig 13 each frame is separated into two parts which is named the left part lp and the right part rp respectively in addition the swl is indicated by the blue dash dot line the maximum location for the continuity liquid is marked by the gray horizontal dash dot line the direction of the tank motion and the trend of the free surface are shown by the white and yellow arrows respectively the splashing during liquid slamming is illustrated by the yellow dot arrows the liquid body propagates from right to left at the beginning as shown in fig 13 a and b in addition the liquid runs up along the left wall frame a then the tank moves to the maximum positive position and its velocity gradually goes to zero due to the presence of the left wall and the inertial force of the liquid the horizontal velocity of the liquid goes to zero as well the liquid accumulates toward the left wall and runs up along the left wall the potential energy of the flow continuously transforms into the kinetic energy of the liquid moving along the sidewall because of the interaction between the wall and liquid there exists a rolling tongue with gas liquid mixing green box in frame b thus the kinetic energy partially transforms into turbulent kinetic energy and the flow of energy is dissipated by means of turbulence dissipation the free surface near the breaking contains the maximum energy when the dissipation occurs the total energy of the liquid decreases thus the free surface near or just at the start of the breaking should be accurately captured and the successive large splashing caused by the rolling tongue can be ignored the area of the rolling tongue increases and the volume of the continuity liquid body near the left wall increases as well while the free surface in the right part decreases from frames b to c due to gravity the rolling tongue starts to fall into the free surface in the left part of the tank yellow dot arrow in frames b and c at this stage there exists some bubbles around the top level zoom the whole free surface marked by a yellow arrow line is clear and can be captured therefore the free surface without the large splashes can be found when the vertical velocity of the liquid goes to zero the liquid body tends to move from left to right through gravity and excitation frame d the potential energy of the liquid gradually turns into kinematic energy the top level of the liquid body reaches the maximum vertical threshold and the free surface is still clear frame e then the tip of the rolling tongue area propagates to the middle of the tank and its area decreases meanwhile the liquid in the right part begins to run along the right wall slowly frame f then the liquid in the left part falls down to the swl and the one in the right part raises up along the right wall frame g and h furthermore the top level of the liquid body reaches the minimum position in this region the liquid falls and penetrates into the free surface which causes gas liquid mixing in the liquid body frame i the whole liquid body tends to move along the right wall during the mentioned process the free surface is clear a similar phenomena happens in the next half cycle thus according to the physical mechanics of free surface with breaking the free surface is distinguished using the following criterion in fig 14 1 when the wave surface runs up or starts to roll along the wall the edge of the continuous liquid body is the free surface see fig 14 a 2 when the splashing falls freely and the slamming liquid body causes the gas liquid mixing phenomena the edge of liquid body containing a small amount of bubbles is designated as the free surface see fig 14 b we selected at least 1000 pictures of different types of free surfaces as a dataset including wave with rolling tongue crushing slamming bubbles and other types of wave fronts in order to train an accuracy model approximately 80 of the data is used as the training set and the remaining 20 is used as the checking set another 600 pictures are used as the testing dataset 3 8 training the u net model for capturing a free surface the configuration of the laboratory computer is listed in table 3 the operating system installed is ubuntu 14 04 the main software packages consist of python3 7 6 cuda 10 1 tensorflow 2 1 0 etc the loss function measures the average difference between the predicted values and the true model here the cross entropy function is used as the loss function which is defined as 10 e i 1 m k 1 k w x i log p k x i where x i represents the vectored features m represents the number of samples k represents the number of classes p k x i is the probability of that sample w is a weight map that we introduce to give important pixel information during the training the lower the value of the loss function the more correct the prediction is an optimizer optimization algorithm is then applied to estimate the model parameters kernel weights and biases that minimize the loss function in this paper adam is used as the optimizer the training procedures are illustrated in fig 15 1 prepare the grayscale images as training checking and testing datasets then place the training dataset into the u net network on the last layer of the u net network the sigmoid function is applied to normalize the output which detects water and liquid in the results consequently the free surface is found then the loss function is computed and the optimizer is applied to converge the value of the loss function until the loss function reaches a global minimum the preliminary model is saved 2 the segmentation effect of the u net network is verified by using a checking set a more precise model is obtained by adjusting the parameters and retraining the model constantly 3 the accuracy of the model is verified by the testing dataset when the dice coefficients are larger than 0 85 the optimal model for extracting the free surface is saved otherwise the training set is extended and retrains a new model from step1 to increase the accuracy of the model here the optimal model for segmenting free surfaces is named the unet fs model the main parameters used during training of the u net model for segmenting free surfaces are listed in the table 4 3 9 the accuracy test to evaluate the performance of the unet fs model first the segmentation is analyzed qualitatively by a testing dataset from a physical point of view the testing set contains 600 samples here the testing example is excited by the frequency ratio f f 1 1 90 the excitation displacement shown in fig 16 stands for the peculiar moment in one period sixty eight experimental images under steady state oscillation in one cycle are analyzed for estimating the performance of the unet fs model for segmenting the free surface in detail second four indicators are given to quantitatively evaluate the performance of the unet fs model third the reasons for the segmentation errors are given in detail finally the applicability of the unet fs model for free surfaces is discussed the corresponding physical phenomena of a wave front under the specific excitation see fig 16 are illustrated in fig 17 the blue dotted line in fig 17 refers to the swl the white and yellow arrows refer to the direction of the excitation and the evolution direction of the free surface respectively the red line is the true free surface obtained manually and the blue line is the free surface extracted by the unet fs model in addition the green dotted box shows the error and the yellow dotted arrow refers to the direction of the wave splashing the liquid body tends to move from left to right by gravity as shown from frames a to c during the process the potential energy of the liquid tends to gradually transform to kinematic energy the tip of the rolling tongue area propagates to the middle of the tank and its area decreases meanwhile the liquid in the right part begins to run up along the right wall slowly frames a and b the top level of the liquid body reduces and it reaches the minimum position at frame c the free surface without breaking is clear in this process the boundary of the splashing is blurry at the edge between the splashing and the free surface there exist some segmentation errors the liquid falls freely and penetrates into the free surface which causes gas liquid mixing in the liquid body frame c thus this complicated phenomenon causes a slight segmentation error in frame c then the tank moves to the maximum positive position and changes to the negative direction however due to the inertial force the whole liquid body still moves and accumulates toward the right wall frame e from frames d to e the free surface is segmented correctly the free surface runs up along the right wall and rolls with splashing then the rolling tongue falls in the middle of the tank frame f after that the liquid body tends to move to the left wall in the same excitation direction as the tank moves due to the left wall the free surface accumulates along the left wall frames e to h during these processes the free surface is segmented with some errors the accuracy test for the corresponding test by the dice coefficients is conducted to quantitatively evaluate the efficiency see fig 18 the total dice coefficient of the unet fs model is larger than 0 9400 and the mean value of the dice coefficients is 0 9960 in one period furthermore the standard deviation of the dice measure is 0 01 even at the stage of splashing and gas liquid mixing the dice value is fluctuating from 0 94 to 0 96 although the value of dice for splashing and gas liquid mixing is slightly lower than the average value it still maintains relative high accuracy the four indicator parameters for the unet fs model for the 8 time instants in fig 17 are listed in table 5 all the four parameters show that the unet fs model has an excellent segmentation effect and high accuracy for identifying free surfaces according to the physical evolution of the free surface and its corresponding dice coefficient slight segmentation errors are present when large area splashing happens to improve the accuracy at frames b dice coefficient approximately 0 94 and g dice coefficient approximately 0 95 we zoom and analyze the segmentation at these two time instants the main reason for the error in frame b in fig 17 is that the local edge between the continuous liquid body and the splashing tends to be blurred see fig 19 and the unet fs model has difficulty in discerning the free surface even when there exists an error according to the definition of free surface with breaking in section 4 3 it is acceptable additionally when there is a complex liquid shadow the free surface is blurred as in frame g in fig 17 as shown in fig 20 this type of free surface is not considered in the training set therefore this problem could be solved by training a new optimal model since the model training is an online process to find the optimization we extend the shadow samples and retrain a new optimal model in order to obtain the new segmentation case furthermore in comparison with the segmentation of the wadog method on a smooth free surface case fig 6 the unet fs model also has an efficient recognition effect on a smooth free surface see fig 21 furthermore the unet fs model has a higher accuracy than the wadog method to segment free surfaces with discontinuous edge as shown in frames d and h in fig 6 which are compared in fig 22 overall the proposed unet fs model can be used for different types of free surface segmentations and it has an excellent segmentation effect and stability 4 conclusions the nonintrusive measurement of free surfaces has been widely used to record the physical evolution in a tank containing liquid bodies method to capture free surfaces accurately in a sloshing tank by using image technology is an important issue in ocean engineering in this paper we first proposed the watershed algorithm based on a gauss filter to segment the free surface the proposed algorithm is tested by four indicators from a physical point of view the results show that the wadog method has high accuracy for smooth free surfaces however because of the limitation of the algorithm it cannot accurately recognize the characteristics of a free surface when there were bubbles or breaking a deep learning method using a u net network is applied to segment the free surface which has the advantage of considering the kinematic characteristics of free surfaces the u net model is built and trained to segment different types of free surfaces from a physical and mechanical point of view the optimal unet fs model could segment free surfaces with breaking and bubbles with high accuracy therefore artificial intelligence technology can efficiently extract complex free surfaces through proper data preparation and the training of an optimal model it is suggested to prepare high quality dataset in order to obtain accurate unet fs model these two methods have good prospects for use in applications to identify the free surfaces in ocean and coastal hydrodynamic experiments disclosure statement no potential conflict of interest was reported by the authors funding this work was supported by the national natural science foundation of china 11602051 51639004 the national key research and development program of china 2018yfa0605902 the chinese postdoctoral science foundation 2016m591433 the liaoning provincial natural science foundation of china 20170540151 and the fundamental research funds for the central universities dut19rc 3 023 norwegian university of science and technology research council of norway through the centres of excellence funding scheme amos senter for autonome marine operasjoner og systemer 223254 credit authorship contribution statement zhijun wei writing original draft gangjun zhai has made contributions to provide the idea and perform the watershed algorithm based on difference of gauss filter to capture free surface ziming wang has built and trained unet model to capture free surface wenyuan wang has taken part in evaluating the accuracy test shunying ji writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement we appreciate yunlong dong from huazhong university of science and technology for his suggestion on training u net model 
21151,this paper presents a numerical model for analyzing the nonlinear interaction between the moored submerged floating tunnel sft and surface waves the mechanics model of the moored floating body driven by wave forces is built and an efficient mesh update method is employed to dynamically configure the computational meshes solving the navier stokes equations for viscous and incompressible free surface flows with the volume of fluid vof method two laboratory experiments are used for validating the numerical model in terms of surface elevations motion responses and mooring forces of the sft indicating the proposed model is capable of simulating the dynamics of the moored floating body under the wave action this hydrodynamic model is then utilized to simulate the wave structure interaction of the prototype sft designed for funka bay hokkaido located in japan a total of 49 cases are designed for the numerical simulation to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters including wave height wave period immersion depth and buoyancy weight ratio bwr the numerical experiments not only shed light on the mooring forces as well as pitch sway and heave responses of the sft in different wave conditions but also provide guidance for the choice of bwr in engineering design a medium value of bwr is suggested to be suitable which is useful for avoiding the happening of snap forces in mooring chains and preventing sft from experiencing large movement under external forces in severe wave conditions as the correlation between the motion responses and bwr is not merely linear or quadratic but parabolic with a peak value the design of bwr should avoid the case where peak motion responses of sft happen keywords submerged floating tunnel motion response mooring force bwr 1 introduction recently the interest in floating structures such as submerged floating tunnel sft floating breakwater wave energy convertor and aquaculture cage has increased as coastal and ocean engineers search for sustainable solutions to mitigate the impacts of natural hazards and climate change e g rijnsdorp et al 2018 barrera et al 2019 cui et al 2019 hermawan and furukawa 2020 qin et al 2020 among numerous types of floating structures submerged floating tunnel sft which is also named archimedes bridge is an innovative transportation concept for crossing the deep strait lake fjord and other deep and long waterways paik et al 2004 ge et al 2010 where building traditional bridges on pilings or suspensions might not be economical as the name suggests sft is mainly a tube like floating tunnel at a certain water depth supported by its self buoyancy and constrained by the mooring anchoring system anchored to the waterbed compared with traditional bridges sft not only has a lower impact on the local environment but also takes lower cost as the cost of sft per unit length will not increase with the total span making sft an environment friendly and economical option for deep or long waterway crossings long et al 2009 lu et al 2011 although sft has been proposed as an effective traffic solution to cross waterways such as the funka bay in japan south sea of korea hogsfjord in norway the strait of messina in italy lu et al 2011 seo et al 2015 remseth et al 1999 faggiano et al 2001 it has yet to be realized due to a lack of safety assurance for an sft to be safe during its whole life it is important to develop efficient and accurate numerical models to determine the hydrodynamic loads on the sft and its potential motions in response to extreme wave conditions over the years numerous laboratory experiments have been carried out to investigate nonlinear wave structure interaction existing physical experiments can be classified by the degrees of freedom and the constraints that the structure has such as a fixed structures with zero degree of freedom e g sheppard and marin 2009 seiffert et al 2014 b structures with one degree of freedom allowing to move in the horizontal or vertical direction e g li et al 2007 bai and taylor 2009 abdolali et al 2012 c structures with at least two degrees of freedom including sway heave and pitch motions e g bai and taylor 2009 zhao and hu 2012 zhao et al 2012 chen et al 2016a and d structures with multiple degrees of freedom constrained by mooring lines anchored to the bottom of the wave tank e g rahman et al 2006 dong et al 2010 peng et al 2013 bi et al 2014 ji et al 2018 these experiments not only shed light on the wave forces and mooring forces acting on the scaled structures but also provided detailed time series of structure motion with without mooring constraints in response to various waves in the water tanks similar to laboratory experiments numerical models have also been used to understand the nonlinear interaction between waves and floating structures in the past decades the fully nonlinear potential theory fnpt model based on the potential theory has been utilized to investigate wave structure interaction bai and eatock taylor 2009 used the higher order boundary element method in conjunction with the domain decomposition method to investigate nonlinear wave interactions with fixed and freely floating flared structures kunisu 2010 evaluated wave forces on sft by using morison s equation based on potential theory and found drag force and inertia force simultaneously worked on the sft guerber et al 2012 successfully used the fnpt model to simulate the fully nonlinear interaction of waves with a submerged horizontal cylinder seo et al 2015 proposed a theoretical method based on potential theory and morison s equation to estimate the behaviour of sft under wave forces and suggested this method could be used in the initial design stage for sft and the mooring system nevertheless the convection potential flow method assumes an irrotational flow and is unable to handle the complex nonlinear free surface deformation as well as vortex generation and dissipation around the solid body besides this type of model is not capable of predicting the pitch motion of an sft caused by viscous damping in the vicinity of the structure with the rapid development of computing technologies navier stokes n s models are gaining popularity though it may require more computational resources gao et al 2012 presented a 2d numerical flume to investigate regular waves slamming on a fixed open piled structure using the smoothed particle hydrodynamics sph method showing its ability to simulate not only the impacting force of regular waves on the structure but also the fluid velocity and pressure fields near the structure bricker and nakayama 2014 utilized an n s model to predict water flow over a fixed submerged bridge deck based on the volume of fluid vof method to capture the free surface showing contributing factors to the deck failure including deck inclination and air trapped between deck girders these studies listed above only dealt with the interactions between water waves and fixed structures without considering the influence of motion response on wave structure interaction n s model faces difficulty in the treatment of the varying positions of the structure during the interaction therefore the update of computational meshes around the moving boundary of a floating structure is very important mittal and kumar 2001 set a square box of meshes around the structure with the box moving together with the structure for the computational domain outside the box the meshes were fixed therefore the meshes close to the structure did not undergo any deformation and kept a good quality ensuring the accuracy of the solution by preserving the gradients in the boundary layers this method was successfully utilized by han et al 2015 to simulate the in line response of a vertical cylinder by laminar flow with one degree of freedom in regular waves however this method has difficulties in dealing with the motions of multiple degrees of freedom based on the mesh update method mentioned above chen et al 2016a proposed an improved meshing method where the computational domain was separated into several parts and each part was corresponded to a specific type of body motion which had been validated by achieving a good agreement between simulated results and measured data in the investigation of a freely floating body driven by regular waves when large nonlinear waves impinge on moored floating bodies wave breaking and appreciable movements of the floating bodies are inevitable probably leading to the failure of structure in order to protect the structure tensioned mooring systems are often used to restrain the motion of the body ren et al 2017 rahman et al 2006 used a porous body model coupled with vof to predict the wave deformation and dynamics of tension leg sft which suffered from high computational cost of the grid generation and re meshing peng et al 2013 applied the immersed boundary method ibm to deal with the movable sft under waves and the numerical model based on eulerian grid methods had difficulties in treating structures with complex geometries or complex multi degree freedom of motion ren et al 2017 applied an sph model to simulate the nonlinear interaction between waves and sft simulated results agreed well with measured data except for the prediction of the transmitted wave with a maximum under prediction of 40 which was probably correlated with the artificial viscosity used in momentum equations in order to analyze and quantify the performance of moored sft with multiple degrees of freedom a numerical model based on the improved meshing method in chen et al 2016a is proposed in this work the ns equations are used as the governing equations to describe the flow field the mechanics model of sft as well as mooring lines are used taking into account the freedoms of three sft motions sway heave and pitch section 2 presents a description of the methodology used in this paper focusing on the mechanics of the floating body in section 3 two experimental results are used for validating the numerical model in terms of surface elevations motion responses mooring forces free surface profiles and water particle velocity fields of the sft in section 4 the interaction between waves and the prototype sft planed across funka bay japan is simulated finally section 5 summarizes the findings with several conclusions 2 numerical model 2 1 governing equations in this study the employed numerical wave tank used to simulate the interaction between submerged floating body and incident wave is based on the n s solver the flow of an incompressible viscous fluid as shown in fig 1 is governed by the continuity equation and momentum equations 1 ρ u x ρ v y 0 2 ρ u t u ρ u x v ρ u y p y μ 2 u x 2 2 u y 2 s x 3 ρ v t u ρ v x v ρ v y p y ρ g μ 2 v x 2 2 v y 2 s y where ρ is the mass density of the air phase or water phase u and v are the velocity components in the x direction and the y direction respectively g is the gravitational acceleration μ is the fluid viscosity p is the fluid pressure s x and s y are the momentum sources in the x direction and y direction respectively 2 2 mechanics model of the floating body the dynamic motions of the floating body are driven by incident waves in combination with mooring chains thus the correlation between forces acting on the moored body and motions of the moored body should be gained to establish the mechanics model of the floating body instantaneous positions of the floating body during its interaction with wave is shown in fig 2 where the submerged tunnel is moored with mooring lines indicating the floating body has three degrees of freedom driven by regular waves and mooring forces i e the pitch motion the sway motion and the heave motion it is assumed that the weight of the floating body is light compared to the buoyancy forces acting on it vertically resulting in no slack state in the mooring lines with no impulsive force on it the wave forces acting on the surfaces of the submerged tunnel can be calculated by integrating the pressures on its surface based on the above considerations the dynamics of the floating body is calculated using the following equations 4 f x f w a v e f o r c e x t m o o r i n g f o r c e x m a x 5 f y f w a v e f o r c e y t m o o r i n g f o r c e y m g m a y 6 m c g m w a v e f o r c e m m o o r i n g f o r c e i α b o d y where f x f y and m c g represent total horizontal forces vertical forces and moments respectively f w a v e f o r c e x and t m o o r i n g f o r c e x are the horizontal components of wave forces and tensile forces acting on the mooring lines respectively f w a v e f o r c e y and t m o o r i n g f o r c e y are the vertical components of wave forces and tensile forces acting on the mooring lines respectively m w a v e f o r c e and m m o o r i n g f o r c e are the moments induced by wave forces and tensile forces respectively a x a y and α b o d y are the accelerations for sway motion heave motion and pitch motion respectively i is the mass moment of inertia of the floating body and m is the mass of the floating body considering the no slack condition of the rigid mooring lines the geometric feature of the wave structure interaction in fig 2 gives the following additional equations 7 l m 2 x h 2 s i n β 3 cos β 3 α 2 y h 2 s i n β 3 sin β 3 α 2 8 l m 2 l l x h 2 s i n β 3 cos β 3 α 2 y h 2 s i n β 3 sin β 3 α 2 in eqs 5 8 there are five unknown parameters i e a x a y α b o d y t 1 and t 2 which can be calculated from the joint solution of these five equations finally the sway heave and pitch displacements of the moored floating body in a new time step are estimated by using a x a y and α b o d y values the tensile forces can also be obtained based on the elastic deformation of mooring lines to consider the elastic deformation the mooring line system can be taken as a light spring model neglecting the mass and volume of the mooring lines hong et al 2005 ren et al 2017 the floating body is acted by an initial tensile force in the still water and the pre tension of the mooring line is taken into consideration in the following equations 9 t t 0 k l l 0 t 0 k l 0 l 0 t 0 k l 0 l where t 0 is the initial tensile force which is equal to the difference between the buoyancy and the weight of the floating body in the still water k is the elastic coefficient of the mooring line l 0 and l are the initial length and instantaneous length of the mooring line respectively the damping coefficient is assumed to be zero in the light spring model 2 3 mesh update method the cfd package fluent has been successfully utilized to solve the wave structure interaction e g chen et al 2016a chen et al 2016b zhan et al 2017 chen et al 2020 and it is used as a basic solver with incorporated c programming language in this paper in fluent a layering method similar to the idea of mittal and kumar 2001 has been demonstrated useful in simulating wave structure interaction problems with one degree of freedom han et al 2015 however this method has difficulty in dealing with problems of multiple degrees of freedom and it needs to be improved fluent provides a simple method to handle the multi degree motion i e the floating body is directly put into an unstructured mesh domain as the body moves the unstructured meshes around the body deform which often leads to excessive distortion of the meshes in a violent motion what is more the meshes around the body are unable to remain high quality in multiple wave cycles thus reducing the accuracy in predicting body motion under a long duration of wave action to solve the problems in meshing special treatments have to be done and fig 3 displays the diagram of the mesh update method used in this paper the user define function udf written in c programming language in fluent is used by incorporating the udf into the cfd solver we can control the motion types of each mesh component and preserve the mesh quality for the entire computation to retain a good mesh quality when the mesh updates in every time step the computational zone is separated into six zones by interfaces and each zone is designed for a particular motion type or several motion types zone 6 moves together with the moving body so it is free to heave sway and pitch thus the meshes close to the structure will not undergo any deformation and keep good quality ensuring the accuracy of the numerical solution zone 5 also moves together with the moving structure and it is free to heave and sway while the pitch motion is prohibited zone 1 and zone 2 are only allowed to heave and zone 3 and zone 4 keep stationary all the time the meshes inside the moving zone adjacent to its boundaries are updated at every time step by layering method in accordance with the movement of the moving zone the detail is shown in fig 3 a these meshes are split or merged according to the following conditions 10 h j 1 α s p l h 0 11 h j α m e r h 0 where h j is the cell thickness of layer j h 0 is the initial cell thickness a spl and a mer are split and merge factors respectively once eq 10 is satisfied cells in layer j are split on the other hand if eq 11 is met cells in layer j are merged with those of layer i the split factor is 0 4 and the merge factor is 0 2 this methodology provides a simple way to re mesh the moving zone and preserve the mesh quality around the bridge to eliminate any distortion fig 3 also shows the mesh distribution in the total domain at three moments when the bridge moves in an arbitrary direction as shown in fig 3 the coordinates of geometrical centers of zone 1 zone 2 zone 5 and the body varied at t 1 and t 2 compared with the initial state no mesh deformation and excessive distortion is found in the whole simulated period indicating that the mesh update method maintains a fine grid and it is suitable for dealing with the problem of fluid structure interaction with respect to the dynamic meshes the integral form of the conservation equation for a general scalar ɸ on an arbitrary control volume v whose boundary is moving can be written as 12 d d t v ρ φ d v v ρ φ u u g d a v γ φ d a v s φ d v where ρ is the density of fluid u is the flow velocity vector u g is the moving mesh velocity γ is the diffusion coefficient s ɸ is the source term of φ v is utilized to represent the boundary of the control volume v when the general scalar φ equals 1 eq 12 is the mass conservation equation on the left side of eq 12 we can see that the time derivative term of control volume v and the mesh velocity u g are considered in the first and second terms respectively the procedure of mesh update is included in the iterations of mass conservation at each time step so when the iteration finishes the processes of floating body relocation and re mesh are also done according to the convergence criterion thus the mass conservation is preserved 2 4 numerical implementation the governing equations are discretised based on the finite volume method fvm the quadratic upwind interpolation of convective kinematics quick algorithm is used to discretise the momentum convection pressure implicit with splitting of operators piso algorithm is used for the pressure velocity coupling with pressure staggering option presto discretization scheme the volume of fluid vof method is adopted to capture the fluctuating water surface the laminar model is used to simulate the flow of the incompressible viscous fluid in the numerical wave tank two wave absorption zones are distributed in the front and rear of the floating body to absorb reflected wave and transmitted wave making sure the working zone will not be affected by reflected waves relaxation method is used in wave absorption zones and further information about the relaxation method can be found in chen et al 2017 the procedure for the dynamic mesh updating technique in the simulation of the fluid structure interaction is shown in fig 4 firstly at the very beginning of every time step the flow field of the new mesh domain is solved by the main program then the wave forces and moments are obtained by using the user defined functions with incorporated c programming language to integrate the pressure and shear stress over all the surfaces of the floating body for rigid mooring chains five unknown parameters i e a x a y α b o d y t 1 and t 2 can be obtained by the joint solution of eqs 4 8 when the elastic deformations of mooring chains are taken into consideration these five unknown parameters be obtained by the joint solution of eqs 4 6 9 afterwards three motions of the submerged moored body driven by regular waves can be obtained with the motion responses the moored body moves to a new position at the same time the velocities of the body are assigned to the meshes in zones 1 2 5 6 later the zones move in specified motion by mesh update method to preserve the mesh quality when the body moves in each time step if the final time step is reached the program ends otherwise the program is ready for the next time step 3 model verification and discussions the available laboratory tests peng et al 2013 are adopted to validate the capability of the proposed model fig 1 gives the schematic diagram of the numerical set up and fig 2 outlines two instantaneous positions of the submerged floating body constrained by mooring lines during its interaction with incident wave indicating the floating body is free to heave pitch and sway two experimental cases shown in table 1 are utilized to validate the numerical model by comparing water surface elevation mooring forces and motions of the floating body with the experimental data in the numerical model model sensitivity tests have been conducted with different grid resolutions and courant numbers related to time step finally we chose dx wavelength 80 and wavelength 120 and dy wave height 15 and wave height 25 for the near water surface zone and near floating body zone as the mesh resolution respectively the courant number is chosen as 0 1 in the whole computational period for details about the experimental set up the reader is referred to peng et al 2013 3 1 water surface elevations the simulated dimensionless water surface elevations η h i at wave gauges computed by the developed numerical model are compared with two experimental cases and are shown in fig 5 a and b respectively the free surface evolutions are plotted against the dimensionless time for five wave cycles in general the computed results obtained from the numerical model agree favourably with the laboratory measurements at the offshore side the water surface profiles monitored in gauge 3 are symmetry and similar to incident waves as standing waves are forming where wave heights at some gauges are strengthened or weakened by the reflected waves for both cases at the onshore side the transmitted wave heights monitored in gauge 5 decrease attributed to wave energy reflection and dissipation due to wave breaking and wave structure interaction transmitted wave tends to contain free wave components with higher frequency kawasaki 1999 ohyama et al 1995 we can see nonzero values of the average water surface elevations in both two cases where a secondary crest is more clearly seen in case 2 indicating higher harmonics are generated along with the progressive fundamental harmonic component after wave breaking in case 2 fig 5 reveals that the developed numerical model is capable of predicting the wave transmission reflection and dissipation characteristics of the moored floating body compared with immersed boundary method based model in ref peng et al 2013 current model does a bit better in predicting the second crest in the transmitted wave which is probably correlated with a uniform grid spacing in the whole computational domain is adopted by ibm based model in ref wei et al 2013 3 2 dynamics of the moored body the dynamic motions of the floating body as well as mooring forces acting on it are discussed in this section time series of numerical results in the current proposed model are verified with measured results from the experimental data in case 2 and presented in fig 6 and a good agreement of the numerical simulation results compared to measured data is gained revealing that developed numerical model can give an accurate prediction of the fierce interaction between moored floating body with wave compare with ibm based model in ref wei et al 2013 the current proposed model give slightly better results in the prediction of sway motion and tensile forces which is probably correlated with the effective mesh update method with non uniform mesh used in this paper positive sway motion represents the horizontal displacement of the floating body along the wave propagation direction and vice versa for negative sway motion positive pitch motion represents the anticlockwise rotation of the body and vice versa for negative pitch motion negative heave motion represents its displacement along the downward direction and vice versa for positive heave motion in the condition of still water level the floating body is acted by an initial tensile force around 34 51 n on each mooring chain as buoyancy is larger than the weight of the floating body hence the initial forces are removed in fig 6 and the positive force represents a larger force than the initial force and vice versa for negative force as the magnitude of negative tensile forces presented in fig 6 are always smaller than initial forces it indicates no slack state occurs in the mooring lines during the process to distinguish the results more clearly five lines are drawn to mark different time instants in one period namely t 0 t 4 at t0 stage the moored body stays in its initial place and all motion responses including sway motion pitch motion and heave motion equal to zero while the peak values of onshore and offshore tensile forces have slight phases difference with motion responses different from still water condition the floating body at t 0 stage is quickly changing its motion direction and the motion accelerations calculated from motion time series are largest in a wave cycle which means fierce fluid structure interaction occurs at this moment when the body is closest to water surface concentrated by the largest amount of wave energy and external forces acting on the body reach maximum values at t 1 stage three motion responses reach peak values at the same time and no phase difference is found in two tensile forces as they all reach valley values as the body departs from the maximum displacements point the tensile forces increase to the peak value again at an instant close to t 2 stage time series of body motions except for heave motion in second half wave cycle from t 2 to t 4 are similar to that in the first half wave cycle from t 0 to t 2 for tensile force the valley values happen at the stage where the moored body is in largest motion response within first half wave cycle while the peak values appear at the instants close to initial position within second half wave cycle it should be noted that two pairs of peak and valley values for the tensile forces and heave motion are observed in fig 6 while sway and heave motions only have one peak and valley value this phenomenon is correlated with that no positive heave value and inversed tensile force is allowed in the interaction it is also noteworthy that first half wave cycle from t 0 to t 2 is longer than second half wave cycle from t 2 to t 4 which implies the floating body experiences a fiercer and longer onshore movement than offshore movement 3 3 instantaneous water surface profiles and motion responses of the floating body fig 7 shows instantaneous water surface profiles as well as motion responses of the floating body in the spatial domain for different stages within one wave cycle the body motion is driven by the hydrodynamic force caused by water pressure around the body which is significantly affected by the periodical wave surface at t0 stage the moored body is in an initial position with nearly zero motion displacement and water surface around the body is relatively calm at t0 0 15t stage the incident wave arrives and the overtopping of the wave over the breakwater occurs the body starts to rotate counterclockwise and moves to the onshore side under the wave force with constraint by mooring line from t0 0 31t the breakwater gradually moves in the reverse direction and comes back to its initial position at t0 0 53t which means the first half wave cycle of onshore movement is larger than 0 5t and demonstrates once again that the duration of onshore movement is larger than offshore movement after that the breakwater moves to the offshore side at t0 0 64t and begins to return to its initial position from t0 0 82t the phenomena of wave reflection and transmission in nonlinear wave transformations over the floating body are also clearly presented in fig 7 it is found wave crest and trough in front of the floating body does not propagate and the distance between wave crest and trough marked by two dash lines is around half of the wavelength inferring standing wave is taking shape attributed to the superposition of incident wave and reflected wave transmitted wave height decreases sharply and the distance between wave crests is less than one wavelength indicating secondary wave crest forms and keeps moving to the onshore side with the fundamental wave at a different phase velocity the appearance of secondary wave crest agrees well with the monitoring results of gauge 5 in case 2 as shown in fig 5 3 4 velocity field around the floating body numerical simulation of the water particle velocity field around the inclinedly moored body within one wave cycle is shown in fig 8 for the purpose of illustrating the details of the periodic vortex generation around the body arrows with rotate direction are marked in the places around the body where vortices are obvious the arrow at the center of the body points out the instantaneous rotate direction of the body as is evident in fig 8 vortex generation and dissipation around four corners of the body are observed during the entire process which is induced by the combined effect of the development of a boundary layer around the solid surface and the nonlinear interaction of the free wave surface with the obstacle it should be noted that the reason why vortex generates at the corner of the structure is because velocities at the corner are relatively large when the body rotates around its gravity center and flow separation is easily caused by viscous effect at the corner which has been demonstrated in previous research jung et al 2006 it is also noteworthy that the rotation directions of the vortexes do not follow the rotate motion of the body and phase lags exist between them vortex at lower left corner exits in most of the wave cycle while the phenomena of vortex generation and dissipation occasionally happen at other corners overall the proposed model gives a good prediction of the velocity field around the body 3 5 influence of elastic deformation to study the influence of elastic deformation of mooring lines on motion responses a set of cases with different mooring line diameters are conducted the mooring line diameter is in the range of 0 35 mm 7 0 mm and the corresponding elastic coefficient is in the range of 5 0 10 4 n m to 2 0 10 7 n m t m a x is the maximum tensile force acting on the offshore and onshore mooring lines and τ is the corresponding maximum stress on the mooring lines θ m a x and δ x m a x are the maximum pitch angle and sway displacement respectively δ y m a x and δ y m a x represent the maximum heave displacement along the downward and upward directions respectively t m a x θ m a x δ x m a x δ y m a x and δ y m a x are the average peak values within five wave cycles the simulated results are listed in table 2 the results of tensile forces and motion responses in the first case with infinite elastic coefficient are the average values in the rigid case shown in fig 6 the modulus of elasticity of the mooring line is 2 05 10 11 pa when the diameter of mooring line is 7 mm it is shown the maximum motion responses θ m a x δ x m a x and δ y m a x are the same with the rigid case with infinite elastic coefficient indicating the elastic deformation has no influence on the wave structure interaction with a decrease of diameter from 7 mm to 5 mm the simulated results remain the same as the diameter decreases from 5 mm to 0 35 mm the maximum tensile forces and heave motion responses increase gradually while the sway displacement and pitch angle remain almost the same in the rigid case the maximum heave displacement along the upward direction δ y m a x is equal to zero as the deformations of mooring lines are not allowed in the elastic case the magnitudes of δ y m a x and δ y m a x gradually increase with the increase of elastic coefficient inferring the heave displacements are affected by the deformation of mooring lines the stress on the mooring line rises rapidly with the decrease of diameter as it varies inversely to its cross sectional area when the diameter is 0 35 mm the stress increases to 580 mpa which is very large and has the potential to exceed the ultimate tensile strength thus the cases with a diameter smaller than 0 35 mm are not studied for comparison the diameter of the mooring chaines in the experiment is around 7 mm indicating it is suitable to use a rigid model to study the wave structure interaction which has also been demonstrated by the comparison with experimental data in fig 6 in the next section the rigid model is adopted to study the hydrodynamic responses of a submerged floating tunnel under various conditions by the assumption of mooring chains with high elastic coefficient are used 4 hydrodynamic response of a submerged floating tunnel 4 1 numerical model setup fig 9 a shows a typical sft tube cable system in the wave the conceptual design of sft in a water depth of 100 m with a span of 30 km for funka bay hokkaido located in japan maeda et al 1994 is taken as the analysis case in this paper as shown in fig 9 b the designed sft has a main body with two railway lanes and four car lanes the design values of structure parameters and local water parameters specified by the society of submerged floating tunnel technology research in hokkaido are used for reference in the following analysis the shape of the submerged floating tunnel in fig 9 is circular which is different from the rectangular body in the previous section as shown in fig 9 a rectangular shape exists in the inner part of the circular body inferring the mechanics model of the circular body is the same as the rectangular one thus eqs 4 8 are applicable to solve the unknown accelerations and tensile forces in the case of circular sft however a difference exists between these two shapes in the flow chart shown in fig 4 to obtain hydrodynamic wave forces and moments acting on the body we have to integrate the pressure and shear stress on all the surfaces of the body the integrated surfaces in the rectangular body consist of four surfaces while only one circular surface is integrated with the circular body it is known that the wave energy concentrates on the water surface and decreases rapidly with the increase of water depth inferring the submersion depth between the water surface and the submerged floating tunnel has a certain influence on the responses of sft a large submersion depth means less impact on environment and navigation while the construction cost of sft increases a small submersion depth means less construction cost while the sft is subjected to the concentrated wave energy on the water surface in order to satisfy the requirement of navigation space for big vessels and reduce the impact from the water surface wave the clearance depth between the water surface and the submerged floating tunnel is proposed to be 30 m which is also suggested for the design of clearance depth by many other researchers in a shipping way xiang et al 2017 jiang et al 2018 however does the suggested submersion depth for navigation means the fulfilment of safety design to have a better understanding of the effect of submersion depth three water depths are chosen in the following parametric study bwr is defined as the ratio of buoyancy to the self weight of sft and it is a key parameter of sft long et al 2009 lu et al 2011 for it not only reflects the structure mass of sft but also determines the initial tension force of the mooring system thus the influences of fundamental structure parameter bwr on the mooring force as well as three motion responses should be analyzed according to local environmental conditions of funka bay specified by the society of submerged floating tunnel technology research the significant wave height h s and peak wave period are 9 3m and 13s respectively to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters a parametric study is then conducted a total of 49 cases are designed for the numerical simulation as shown in table 3 the relevant parameters in the numerical experiments are set to be within a realistic range under wave conditions the water depth h ranging from 80 to 120 m the corresponding submersion depth d ranging from 10 to 30 m the wave period t i ranging from 8 0 to 13 0 s the wave height h i ranging from 2 0 to 9 3 m and the bwr ranging from 1 1 to 1 8 4 2 results and discussion as all of the following cases involve several parameters abbreviations are used to describe a case for example h9 3 t1 min denotes the minimum offshore mooring force of the case with wave height h i 9 3 m d30 t2 max denotes the maximum onshore mooring force of the case with submersion depth d 30 m bwr1 5 initial force denotes the initial tensile forces on the mooring chains in still water with bwr 1 5 4 2 1 motion responses figs 10 12 show the influences of hydrodynamic parameters on motion responses the effects of bwr and wave height on pitch motion responses are presented in fig 10 a showing the correlation between pitch motion response and bwr is not merely linear or quadratic but parabolic with a peak value similar phenomenon is also found in figs 11 a 12 a in the correlation between bwr and two other motion responses i e sway motion and heave motion which is because the maximum displacements of three motion responses always happen at the same time in this mooring system as shown in fig 6 the initial force at still water is an essential component of constraint mooring forces which play a negative role in the motion response in tensioned mooring systems ren et al 2017 the maximum mooring forces increase quickly with increasing bwr as initial force increase within lighter weight when bwr exceeds 1 6 constraint mooring forces reach a high level and play a more critical role in limiting the motion responses than wave force and the amplitudes of movement begin to decrease as a result it is noteworthy that the decrease of motion displacements is slow in a large wave height of 9 3 m and fast in small wave height of 4 0 m and 2 0 m which is probably because more wave energy is distributed around the sft under a large wave height within the same submersion depth the effects of bwr and submersion depth on motion responses with t 13s and h i 4 0 m are presented in figs 10 b 12 b the curves describing the correlation between motion responses and bwr are all parabolic inferring the phenomenon of peak motion response exist in the hydraulic conditions with different submersion depths the impact of submersion depth on motion responses is noticeable which is attributed to the decrease of wave energy acting on the sft with a large submersion depth as shown in figs 10 c 12 c motion displacements in large wave periods are much larger than that in short wave period due to the differences in wave energy especially when bwr is equal to 1 5 which is close to the corresponding bwr in peak motion responses as shown in figs 10 12 the amplitudes of sway motion are several times larger than heave motion pointing out the displacement along with wave propagation direction is more dangerous than that in the vertical direction besides the sizeable inclined angle of the road surface in tunnel induced by the pitch motion of sft within large values of bwr also seriously affect the safety of the vehicles and raises the possibility of a traffic accident 4 2 2 mooring forces the simulated results of mooring forces with bwr varying in the range of 1 1 1 8 are presented in fig 13 the ordinate value in fig 13 represents the magnitude of the mooring forces acting on sft per unit length the offshore mooring forces t 1 are plotted in dashed lines the onshore mooring forces t 2 are plotted in solid lines fig 13 a shows the influences of bwr and wave height on mooring forces the results show both maximum offshore and onshore mooring forces increase with bwr and the slope becomes deep first and gentle later when bwr is around 1 6 especially in small wave heights as to the minimum mooring forces the mooring forces also increase with bwr except for a trough when bwr is around 1 6 with small wave height the phenomenon of the rapid changing slopes in the curves of both offshore and onshore mooring forces are closely correlated with the fiercest wave tunnel interaction at bwr 1 6 the mooring forces consist of two parts i e initial force at still water and external force induced by motion responses the initial force increase with bwr as the weight of sft decreases which is an essential reason that mooring forces increase with bwr in general thus the rapid changing slopes in the curves of mooring forces compared with initial force are caused by the external force induced by motion responses when bwr exceeds 1 6 the motion responses decrease rapidly at small wave heights i e h i 2 0 m and 4 0 m and relatively slow at large wave heights i e h i 9 3 m which is the reason why slopes in the curves of mooring forces at different wave height exhibits some differences at a large value of bwr fig 13 b shows the influences of bwr and wave height on mooring forces with t 13s and h i 4 0 m the trends of mooring forces varied with bwr within different submersion depths are similar in the same wave height and wave period overall mooring forces decrease with the increase of immersion depth demonstrating the water depth has a certain influence on the mooring forces when the immersion depth increase from 10 m to 30 m and 30 m 50 m the average reduction percentage of maximum mooring forces are 13 2 and 8 9 respectively indicating the measure of increasing the immersion depth by a certain value to protect the sft mooring system is a useful way as what we have expected however the mooring forces are still large when the submersion depths are 30 m and 50 m in extreme wave conditions inferring the suggested submersion depth of 30 m guarantees the save navigation on the water surface but not ensure the safety of sft mooring system fig 13 c shows the influences of wave period on mooring forces the results show maximum mooring forces increase with wave period and minimum mooring forces decrease with wave period as mentioned above the total mooring force can be divided into two parts i e initial force and force induced by motion responses the initial tensile forces keep constant within different wave periods as the amplitudes of motion responses increase with different wave period and the total mooring forces increase as a result the mooring forces change linearly with wave period when bwr is 1 3 while the slopes of curves become deeper with wave period when bwr is 1 5 which is attributed to the corresponding value of bwr in peak motion response is close to 1 5 the external forces caused by wave tunnel interaction are relatively small in the condition of short wave period at bwr 1 5 and increase decrease to extremely large small values in significant wave period of 13 s pointing out mooring systems are at the risk of exceeding ultimate tensile strength and becoming slack at the condition of long period wave as to maximum mooring force onshore mooring forces are larger than offshore mooring force for the most part except when bwr is less than or equal to 1 2 as to minimum mooring force onshore mooring force is smaller than offshore mooring force for the most part except when bwr is very small if minimum mooring force is too small the mooring line has a potential to go slack probably leading to a sudden large increase in the maximum mooring force which may be a maximum of around 20 times as large as normal forces in the mooring lines without slack lu et al 2011 it is seen from fig 13 that if bwr is equal to 1 1 the magnitudes of both minimum offshore and onshore mooring force are close to zero meaning the mooring lines are at the risk of going slack in addition minimum onshore mooring force increases at first and then decreases with bwr indicating the onshore mooring line may also go slack at a large value of bwr under a more severe wave condition figs 10 13 show bwr plays a key role in the interaction of sft and wave and the design of bwr should refer to the conclusions summarized in the numerical experiments if bwr is small the mooring line may suffer from extremely large snap force in the slack state which is much larger than the mooring forces in conditions with large values of bwr meanwhile a small bwr also means the mass of bwr is large and it leads to a rise in construction cost which is not economical if bwr is large the sft may undergo a fierce movement and the large motion displacements are dangerous for vehicles passing through the tunnel in the meantime the onshore mooring line has the potential to go slack at a large value of bwr with severe hydrodynamic conditions where minimum onshore force may be close to zero a large bwr also means constraint forces in mooring systems increase and the high tension force put forward higher requirement for the strengths of mooring chains and anchoring though the economic cost reduces at a large bwr as the weight of sft decreases the structure strength of bwr with lightweight may encounter problem under the joint action of hydrodynamic force and mooring force overall the amplitudes of motion responses and tensile forces increase with wave height and wave period and decrease with submersion depth the influences of wave period on wave tunnel interaction magnify in a large wave period when the value of bwr is around 1 6 the immersion depth has a certain effect on the interaction while the suggested submersion depth of 30 m for the save navigation on the water surface does not ensure the safety of the mooring system the value of bwr should not be too large or too small and a medium value is suitable for a profound consideration when design first a medium value of bwr can effectively avoid the happening of snap forces in mooring lines for the most part even in the situations of larger wave height second the medium tensile stress in mooring lines is beneficial for protecting the mooring system without running the risk of exceeding ultimate tensile strength third the selection criterion of bwr also helps to prevent sft from experiencing large movement under external forces in severe wave condition fourth the construction cost can be relatively economical with a medium value of bwr however it is noteworthy that the selection should avoid the value of bwr with peak motion responses i e 1 6 in this case 5 summary and conclusions in this paper a numerical model for analyzing the performance of moored sft with multiple degrees of freedom under wave forces is proposed the ns equations are used as the governing equations to describe the flow field a description of the methodology focusing on the mechanics of the floating body is presented in this paper to preserve the mesh quality around the tunnel during the entire computation an efficient mesh update method is applied to the numerical simulation where the total domain is divided into 6 zones and each zone is designed for a particular motion type two wave absorption zones are distributed in the front and rear of the sft to absorb reflected waves and transmitted waves in the numerical wave tank making sure the working zone is not affected by reflected waves two laboratory experiments are used for validating the numerical model in terms of surface elevations motion responses and mooring forces of the sft indicating the proposed model is capable of simulating the interactions between surface waves and sft constrained by mooring chains the prototype sft designed for funka bay hokkaido located in japan has been simulated using the verified hydrodynamic model for wave structure interaction a total of 49 cases are designed for the numerical simulation to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters the numerical simulations shed light on the offshore and onshore mooring forces as well as pitch sway and heave responses of the sft under different bwr conditions it is shown both offshore and onshore mooring lines are at the risk of going slack when bwr is small and onshore mooring line also has a potential to go slack when bwr is large under a serious wave condition it is also shown that the correlation between the motion responses and bwr is not merely linear or quadratic but parabolic with a peak value which is closely correlated with the constraint mooring forces reaching a high level and playing a more important role in limiting the motion responses than wave force at a large value of bwr the results also infer the amplitudes of sway motion are several times larger than heave motion pointing out the displacement along with the wave propagation direction is more dangerous than that in the vertical direction in the parametric investigations of prototype sft the amplitudes of motion responses and tensile forces increase with wave height and wave period and decrease with submersion depth when the value of bwr is close to the point where peak motion responses happen the influences of wave period on wave tunnel interaction magnify especially in the long period wave the immersion depth has a certain effect on the wave tunnel interaction while the suggested submersion depth of 30 m for the save navigation on the water surface does not ensure the safety of the mooring system bwr is demonstrated to be a key parameter for the design of sft and a suitable value is desirable and should be given a profound consideration overall the value of bwr should not be too large or too small and a medium value is suggested which is conducive to avoiding the happening of snap forces in mooring chains at small bwr and preventing sft from experiencing large movement under external forces at large bwr in severe wave condition finally it is noted that the value of bwr should not be around the point where peak motion responses happen when selecting a medium value credit authorship contribution statement xuebin chen manuscript preparation conceptualization study concepts literature research data curation formal analysis data analysis figures qin chen manuscript preparation conceptualization study concepts zhiwu chen manuscript preparation manuscript preparation shuqun cai conceptualization study concepts xianrong zhuo literature research data curation formal analysis data analysis jiangen lv formal analysis data analysis figures declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was jointly supported by department of education of guangdong province china 2019kqncx047 ka200190148 key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0304 department of natural resources of guangdong province china 2020 017 state key laboratory of tropical oceanography south china sea institute of oceanology chinese academy of sciences lto2008 department of science and technology of guangdong province 2020b020208002 
21151,this paper presents a numerical model for analyzing the nonlinear interaction between the moored submerged floating tunnel sft and surface waves the mechanics model of the moored floating body driven by wave forces is built and an efficient mesh update method is employed to dynamically configure the computational meshes solving the navier stokes equations for viscous and incompressible free surface flows with the volume of fluid vof method two laboratory experiments are used for validating the numerical model in terms of surface elevations motion responses and mooring forces of the sft indicating the proposed model is capable of simulating the dynamics of the moored floating body under the wave action this hydrodynamic model is then utilized to simulate the wave structure interaction of the prototype sft designed for funka bay hokkaido located in japan a total of 49 cases are designed for the numerical simulation to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters including wave height wave period immersion depth and buoyancy weight ratio bwr the numerical experiments not only shed light on the mooring forces as well as pitch sway and heave responses of the sft in different wave conditions but also provide guidance for the choice of bwr in engineering design a medium value of bwr is suggested to be suitable which is useful for avoiding the happening of snap forces in mooring chains and preventing sft from experiencing large movement under external forces in severe wave conditions as the correlation between the motion responses and bwr is not merely linear or quadratic but parabolic with a peak value the design of bwr should avoid the case where peak motion responses of sft happen keywords submerged floating tunnel motion response mooring force bwr 1 introduction recently the interest in floating structures such as submerged floating tunnel sft floating breakwater wave energy convertor and aquaculture cage has increased as coastal and ocean engineers search for sustainable solutions to mitigate the impacts of natural hazards and climate change e g rijnsdorp et al 2018 barrera et al 2019 cui et al 2019 hermawan and furukawa 2020 qin et al 2020 among numerous types of floating structures submerged floating tunnel sft which is also named archimedes bridge is an innovative transportation concept for crossing the deep strait lake fjord and other deep and long waterways paik et al 2004 ge et al 2010 where building traditional bridges on pilings or suspensions might not be economical as the name suggests sft is mainly a tube like floating tunnel at a certain water depth supported by its self buoyancy and constrained by the mooring anchoring system anchored to the waterbed compared with traditional bridges sft not only has a lower impact on the local environment but also takes lower cost as the cost of sft per unit length will not increase with the total span making sft an environment friendly and economical option for deep or long waterway crossings long et al 2009 lu et al 2011 although sft has been proposed as an effective traffic solution to cross waterways such as the funka bay in japan south sea of korea hogsfjord in norway the strait of messina in italy lu et al 2011 seo et al 2015 remseth et al 1999 faggiano et al 2001 it has yet to be realized due to a lack of safety assurance for an sft to be safe during its whole life it is important to develop efficient and accurate numerical models to determine the hydrodynamic loads on the sft and its potential motions in response to extreme wave conditions over the years numerous laboratory experiments have been carried out to investigate nonlinear wave structure interaction existing physical experiments can be classified by the degrees of freedom and the constraints that the structure has such as a fixed structures with zero degree of freedom e g sheppard and marin 2009 seiffert et al 2014 b structures with one degree of freedom allowing to move in the horizontal or vertical direction e g li et al 2007 bai and taylor 2009 abdolali et al 2012 c structures with at least two degrees of freedom including sway heave and pitch motions e g bai and taylor 2009 zhao and hu 2012 zhao et al 2012 chen et al 2016a and d structures with multiple degrees of freedom constrained by mooring lines anchored to the bottom of the wave tank e g rahman et al 2006 dong et al 2010 peng et al 2013 bi et al 2014 ji et al 2018 these experiments not only shed light on the wave forces and mooring forces acting on the scaled structures but also provided detailed time series of structure motion with without mooring constraints in response to various waves in the water tanks similar to laboratory experiments numerical models have also been used to understand the nonlinear interaction between waves and floating structures in the past decades the fully nonlinear potential theory fnpt model based on the potential theory has been utilized to investigate wave structure interaction bai and eatock taylor 2009 used the higher order boundary element method in conjunction with the domain decomposition method to investigate nonlinear wave interactions with fixed and freely floating flared structures kunisu 2010 evaluated wave forces on sft by using morison s equation based on potential theory and found drag force and inertia force simultaneously worked on the sft guerber et al 2012 successfully used the fnpt model to simulate the fully nonlinear interaction of waves with a submerged horizontal cylinder seo et al 2015 proposed a theoretical method based on potential theory and morison s equation to estimate the behaviour of sft under wave forces and suggested this method could be used in the initial design stage for sft and the mooring system nevertheless the convection potential flow method assumes an irrotational flow and is unable to handle the complex nonlinear free surface deformation as well as vortex generation and dissipation around the solid body besides this type of model is not capable of predicting the pitch motion of an sft caused by viscous damping in the vicinity of the structure with the rapid development of computing technologies navier stokes n s models are gaining popularity though it may require more computational resources gao et al 2012 presented a 2d numerical flume to investigate regular waves slamming on a fixed open piled structure using the smoothed particle hydrodynamics sph method showing its ability to simulate not only the impacting force of regular waves on the structure but also the fluid velocity and pressure fields near the structure bricker and nakayama 2014 utilized an n s model to predict water flow over a fixed submerged bridge deck based on the volume of fluid vof method to capture the free surface showing contributing factors to the deck failure including deck inclination and air trapped between deck girders these studies listed above only dealt with the interactions between water waves and fixed structures without considering the influence of motion response on wave structure interaction n s model faces difficulty in the treatment of the varying positions of the structure during the interaction therefore the update of computational meshes around the moving boundary of a floating structure is very important mittal and kumar 2001 set a square box of meshes around the structure with the box moving together with the structure for the computational domain outside the box the meshes were fixed therefore the meshes close to the structure did not undergo any deformation and kept a good quality ensuring the accuracy of the solution by preserving the gradients in the boundary layers this method was successfully utilized by han et al 2015 to simulate the in line response of a vertical cylinder by laminar flow with one degree of freedom in regular waves however this method has difficulties in dealing with the motions of multiple degrees of freedom based on the mesh update method mentioned above chen et al 2016a proposed an improved meshing method where the computational domain was separated into several parts and each part was corresponded to a specific type of body motion which had been validated by achieving a good agreement between simulated results and measured data in the investigation of a freely floating body driven by regular waves when large nonlinear waves impinge on moored floating bodies wave breaking and appreciable movements of the floating bodies are inevitable probably leading to the failure of structure in order to protect the structure tensioned mooring systems are often used to restrain the motion of the body ren et al 2017 rahman et al 2006 used a porous body model coupled with vof to predict the wave deformation and dynamics of tension leg sft which suffered from high computational cost of the grid generation and re meshing peng et al 2013 applied the immersed boundary method ibm to deal with the movable sft under waves and the numerical model based on eulerian grid methods had difficulties in treating structures with complex geometries or complex multi degree freedom of motion ren et al 2017 applied an sph model to simulate the nonlinear interaction between waves and sft simulated results agreed well with measured data except for the prediction of the transmitted wave with a maximum under prediction of 40 which was probably correlated with the artificial viscosity used in momentum equations in order to analyze and quantify the performance of moored sft with multiple degrees of freedom a numerical model based on the improved meshing method in chen et al 2016a is proposed in this work the ns equations are used as the governing equations to describe the flow field the mechanics model of sft as well as mooring lines are used taking into account the freedoms of three sft motions sway heave and pitch section 2 presents a description of the methodology used in this paper focusing on the mechanics of the floating body in section 3 two experimental results are used for validating the numerical model in terms of surface elevations motion responses mooring forces free surface profiles and water particle velocity fields of the sft in section 4 the interaction between waves and the prototype sft planed across funka bay japan is simulated finally section 5 summarizes the findings with several conclusions 2 numerical model 2 1 governing equations in this study the employed numerical wave tank used to simulate the interaction between submerged floating body and incident wave is based on the n s solver the flow of an incompressible viscous fluid as shown in fig 1 is governed by the continuity equation and momentum equations 1 ρ u x ρ v y 0 2 ρ u t u ρ u x v ρ u y p y μ 2 u x 2 2 u y 2 s x 3 ρ v t u ρ v x v ρ v y p y ρ g μ 2 v x 2 2 v y 2 s y where ρ is the mass density of the air phase or water phase u and v are the velocity components in the x direction and the y direction respectively g is the gravitational acceleration μ is the fluid viscosity p is the fluid pressure s x and s y are the momentum sources in the x direction and y direction respectively 2 2 mechanics model of the floating body the dynamic motions of the floating body are driven by incident waves in combination with mooring chains thus the correlation between forces acting on the moored body and motions of the moored body should be gained to establish the mechanics model of the floating body instantaneous positions of the floating body during its interaction with wave is shown in fig 2 where the submerged tunnel is moored with mooring lines indicating the floating body has three degrees of freedom driven by regular waves and mooring forces i e the pitch motion the sway motion and the heave motion it is assumed that the weight of the floating body is light compared to the buoyancy forces acting on it vertically resulting in no slack state in the mooring lines with no impulsive force on it the wave forces acting on the surfaces of the submerged tunnel can be calculated by integrating the pressures on its surface based on the above considerations the dynamics of the floating body is calculated using the following equations 4 f x f w a v e f o r c e x t m o o r i n g f o r c e x m a x 5 f y f w a v e f o r c e y t m o o r i n g f o r c e y m g m a y 6 m c g m w a v e f o r c e m m o o r i n g f o r c e i α b o d y where f x f y and m c g represent total horizontal forces vertical forces and moments respectively f w a v e f o r c e x and t m o o r i n g f o r c e x are the horizontal components of wave forces and tensile forces acting on the mooring lines respectively f w a v e f o r c e y and t m o o r i n g f o r c e y are the vertical components of wave forces and tensile forces acting on the mooring lines respectively m w a v e f o r c e and m m o o r i n g f o r c e are the moments induced by wave forces and tensile forces respectively a x a y and α b o d y are the accelerations for sway motion heave motion and pitch motion respectively i is the mass moment of inertia of the floating body and m is the mass of the floating body considering the no slack condition of the rigid mooring lines the geometric feature of the wave structure interaction in fig 2 gives the following additional equations 7 l m 2 x h 2 s i n β 3 cos β 3 α 2 y h 2 s i n β 3 sin β 3 α 2 8 l m 2 l l x h 2 s i n β 3 cos β 3 α 2 y h 2 s i n β 3 sin β 3 α 2 in eqs 5 8 there are five unknown parameters i e a x a y α b o d y t 1 and t 2 which can be calculated from the joint solution of these five equations finally the sway heave and pitch displacements of the moored floating body in a new time step are estimated by using a x a y and α b o d y values the tensile forces can also be obtained based on the elastic deformation of mooring lines to consider the elastic deformation the mooring line system can be taken as a light spring model neglecting the mass and volume of the mooring lines hong et al 2005 ren et al 2017 the floating body is acted by an initial tensile force in the still water and the pre tension of the mooring line is taken into consideration in the following equations 9 t t 0 k l l 0 t 0 k l 0 l 0 t 0 k l 0 l where t 0 is the initial tensile force which is equal to the difference between the buoyancy and the weight of the floating body in the still water k is the elastic coefficient of the mooring line l 0 and l are the initial length and instantaneous length of the mooring line respectively the damping coefficient is assumed to be zero in the light spring model 2 3 mesh update method the cfd package fluent has been successfully utilized to solve the wave structure interaction e g chen et al 2016a chen et al 2016b zhan et al 2017 chen et al 2020 and it is used as a basic solver with incorporated c programming language in this paper in fluent a layering method similar to the idea of mittal and kumar 2001 has been demonstrated useful in simulating wave structure interaction problems with one degree of freedom han et al 2015 however this method has difficulty in dealing with problems of multiple degrees of freedom and it needs to be improved fluent provides a simple method to handle the multi degree motion i e the floating body is directly put into an unstructured mesh domain as the body moves the unstructured meshes around the body deform which often leads to excessive distortion of the meshes in a violent motion what is more the meshes around the body are unable to remain high quality in multiple wave cycles thus reducing the accuracy in predicting body motion under a long duration of wave action to solve the problems in meshing special treatments have to be done and fig 3 displays the diagram of the mesh update method used in this paper the user define function udf written in c programming language in fluent is used by incorporating the udf into the cfd solver we can control the motion types of each mesh component and preserve the mesh quality for the entire computation to retain a good mesh quality when the mesh updates in every time step the computational zone is separated into six zones by interfaces and each zone is designed for a particular motion type or several motion types zone 6 moves together with the moving body so it is free to heave sway and pitch thus the meshes close to the structure will not undergo any deformation and keep good quality ensuring the accuracy of the numerical solution zone 5 also moves together with the moving structure and it is free to heave and sway while the pitch motion is prohibited zone 1 and zone 2 are only allowed to heave and zone 3 and zone 4 keep stationary all the time the meshes inside the moving zone adjacent to its boundaries are updated at every time step by layering method in accordance with the movement of the moving zone the detail is shown in fig 3 a these meshes are split or merged according to the following conditions 10 h j 1 α s p l h 0 11 h j α m e r h 0 where h j is the cell thickness of layer j h 0 is the initial cell thickness a spl and a mer are split and merge factors respectively once eq 10 is satisfied cells in layer j are split on the other hand if eq 11 is met cells in layer j are merged with those of layer i the split factor is 0 4 and the merge factor is 0 2 this methodology provides a simple way to re mesh the moving zone and preserve the mesh quality around the bridge to eliminate any distortion fig 3 also shows the mesh distribution in the total domain at three moments when the bridge moves in an arbitrary direction as shown in fig 3 the coordinates of geometrical centers of zone 1 zone 2 zone 5 and the body varied at t 1 and t 2 compared with the initial state no mesh deformation and excessive distortion is found in the whole simulated period indicating that the mesh update method maintains a fine grid and it is suitable for dealing with the problem of fluid structure interaction with respect to the dynamic meshes the integral form of the conservation equation for a general scalar ɸ on an arbitrary control volume v whose boundary is moving can be written as 12 d d t v ρ φ d v v ρ φ u u g d a v γ φ d a v s φ d v where ρ is the density of fluid u is the flow velocity vector u g is the moving mesh velocity γ is the diffusion coefficient s ɸ is the source term of φ v is utilized to represent the boundary of the control volume v when the general scalar φ equals 1 eq 12 is the mass conservation equation on the left side of eq 12 we can see that the time derivative term of control volume v and the mesh velocity u g are considered in the first and second terms respectively the procedure of mesh update is included in the iterations of mass conservation at each time step so when the iteration finishes the processes of floating body relocation and re mesh are also done according to the convergence criterion thus the mass conservation is preserved 2 4 numerical implementation the governing equations are discretised based on the finite volume method fvm the quadratic upwind interpolation of convective kinematics quick algorithm is used to discretise the momentum convection pressure implicit with splitting of operators piso algorithm is used for the pressure velocity coupling with pressure staggering option presto discretization scheme the volume of fluid vof method is adopted to capture the fluctuating water surface the laminar model is used to simulate the flow of the incompressible viscous fluid in the numerical wave tank two wave absorption zones are distributed in the front and rear of the floating body to absorb reflected wave and transmitted wave making sure the working zone will not be affected by reflected waves relaxation method is used in wave absorption zones and further information about the relaxation method can be found in chen et al 2017 the procedure for the dynamic mesh updating technique in the simulation of the fluid structure interaction is shown in fig 4 firstly at the very beginning of every time step the flow field of the new mesh domain is solved by the main program then the wave forces and moments are obtained by using the user defined functions with incorporated c programming language to integrate the pressure and shear stress over all the surfaces of the floating body for rigid mooring chains five unknown parameters i e a x a y α b o d y t 1 and t 2 can be obtained by the joint solution of eqs 4 8 when the elastic deformations of mooring chains are taken into consideration these five unknown parameters be obtained by the joint solution of eqs 4 6 9 afterwards three motions of the submerged moored body driven by regular waves can be obtained with the motion responses the moored body moves to a new position at the same time the velocities of the body are assigned to the meshes in zones 1 2 5 6 later the zones move in specified motion by mesh update method to preserve the mesh quality when the body moves in each time step if the final time step is reached the program ends otherwise the program is ready for the next time step 3 model verification and discussions the available laboratory tests peng et al 2013 are adopted to validate the capability of the proposed model fig 1 gives the schematic diagram of the numerical set up and fig 2 outlines two instantaneous positions of the submerged floating body constrained by mooring lines during its interaction with incident wave indicating the floating body is free to heave pitch and sway two experimental cases shown in table 1 are utilized to validate the numerical model by comparing water surface elevation mooring forces and motions of the floating body with the experimental data in the numerical model model sensitivity tests have been conducted with different grid resolutions and courant numbers related to time step finally we chose dx wavelength 80 and wavelength 120 and dy wave height 15 and wave height 25 for the near water surface zone and near floating body zone as the mesh resolution respectively the courant number is chosen as 0 1 in the whole computational period for details about the experimental set up the reader is referred to peng et al 2013 3 1 water surface elevations the simulated dimensionless water surface elevations η h i at wave gauges computed by the developed numerical model are compared with two experimental cases and are shown in fig 5 a and b respectively the free surface evolutions are plotted against the dimensionless time for five wave cycles in general the computed results obtained from the numerical model agree favourably with the laboratory measurements at the offshore side the water surface profiles monitored in gauge 3 are symmetry and similar to incident waves as standing waves are forming where wave heights at some gauges are strengthened or weakened by the reflected waves for both cases at the onshore side the transmitted wave heights monitored in gauge 5 decrease attributed to wave energy reflection and dissipation due to wave breaking and wave structure interaction transmitted wave tends to contain free wave components with higher frequency kawasaki 1999 ohyama et al 1995 we can see nonzero values of the average water surface elevations in both two cases where a secondary crest is more clearly seen in case 2 indicating higher harmonics are generated along with the progressive fundamental harmonic component after wave breaking in case 2 fig 5 reveals that the developed numerical model is capable of predicting the wave transmission reflection and dissipation characteristics of the moored floating body compared with immersed boundary method based model in ref peng et al 2013 current model does a bit better in predicting the second crest in the transmitted wave which is probably correlated with a uniform grid spacing in the whole computational domain is adopted by ibm based model in ref wei et al 2013 3 2 dynamics of the moored body the dynamic motions of the floating body as well as mooring forces acting on it are discussed in this section time series of numerical results in the current proposed model are verified with measured results from the experimental data in case 2 and presented in fig 6 and a good agreement of the numerical simulation results compared to measured data is gained revealing that developed numerical model can give an accurate prediction of the fierce interaction between moored floating body with wave compare with ibm based model in ref wei et al 2013 the current proposed model give slightly better results in the prediction of sway motion and tensile forces which is probably correlated with the effective mesh update method with non uniform mesh used in this paper positive sway motion represents the horizontal displacement of the floating body along the wave propagation direction and vice versa for negative sway motion positive pitch motion represents the anticlockwise rotation of the body and vice versa for negative pitch motion negative heave motion represents its displacement along the downward direction and vice versa for positive heave motion in the condition of still water level the floating body is acted by an initial tensile force around 34 51 n on each mooring chain as buoyancy is larger than the weight of the floating body hence the initial forces are removed in fig 6 and the positive force represents a larger force than the initial force and vice versa for negative force as the magnitude of negative tensile forces presented in fig 6 are always smaller than initial forces it indicates no slack state occurs in the mooring lines during the process to distinguish the results more clearly five lines are drawn to mark different time instants in one period namely t 0 t 4 at t0 stage the moored body stays in its initial place and all motion responses including sway motion pitch motion and heave motion equal to zero while the peak values of onshore and offshore tensile forces have slight phases difference with motion responses different from still water condition the floating body at t 0 stage is quickly changing its motion direction and the motion accelerations calculated from motion time series are largest in a wave cycle which means fierce fluid structure interaction occurs at this moment when the body is closest to water surface concentrated by the largest amount of wave energy and external forces acting on the body reach maximum values at t 1 stage three motion responses reach peak values at the same time and no phase difference is found in two tensile forces as they all reach valley values as the body departs from the maximum displacements point the tensile forces increase to the peak value again at an instant close to t 2 stage time series of body motions except for heave motion in second half wave cycle from t 2 to t 4 are similar to that in the first half wave cycle from t 0 to t 2 for tensile force the valley values happen at the stage where the moored body is in largest motion response within first half wave cycle while the peak values appear at the instants close to initial position within second half wave cycle it should be noted that two pairs of peak and valley values for the tensile forces and heave motion are observed in fig 6 while sway and heave motions only have one peak and valley value this phenomenon is correlated with that no positive heave value and inversed tensile force is allowed in the interaction it is also noteworthy that first half wave cycle from t 0 to t 2 is longer than second half wave cycle from t 2 to t 4 which implies the floating body experiences a fiercer and longer onshore movement than offshore movement 3 3 instantaneous water surface profiles and motion responses of the floating body fig 7 shows instantaneous water surface profiles as well as motion responses of the floating body in the spatial domain for different stages within one wave cycle the body motion is driven by the hydrodynamic force caused by water pressure around the body which is significantly affected by the periodical wave surface at t0 stage the moored body is in an initial position with nearly zero motion displacement and water surface around the body is relatively calm at t0 0 15t stage the incident wave arrives and the overtopping of the wave over the breakwater occurs the body starts to rotate counterclockwise and moves to the onshore side under the wave force with constraint by mooring line from t0 0 31t the breakwater gradually moves in the reverse direction and comes back to its initial position at t0 0 53t which means the first half wave cycle of onshore movement is larger than 0 5t and demonstrates once again that the duration of onshore movement is larger than offshore movement after that the breakwater moves to the offshore side at t0 0 64t and begins to return to its initial position from t0 0 82t the phenomena of wave reflection and transmission in nonlinear wave transformations over the floating body are also clearly presented in fig 7 it is found wave crest and trough in front of the floating body does not propagate and the distance between wave crest and trough marked by two dash lines is around half of the wavelength inferring standing wave is taking shape attributed to the superposition of incident wave and reflected wave transmitted wave height decreases sharply and the distance between wave crests is less than one wavelength indicating secondary wave crest forms and keeps moving to the onshore side with the fundamental wave at a different phase velocity the appearance of secondary wave crest agrees well with the monitoring results of gauge 5 in case 2 as shown in fig 5 3 4 velocity field around the floating body numerical simulation of the water particle velocity field around the inclinedly moored body within one wave cycle is shown in fig 8 for the purpose of illustrating the details of the periodic vortex generation around the body arrows with rotate direction are marked in the places around the body where vortices are obvious the arrow at the center of the body points out the instantaneous rotate direction of the body as is evident in fig 8 vortex generation and dissipation around four corners of the body are observed during the entire process which is induced by the combined effect of the development of a boundary layer around the solid surface and the nonlinear interaction of the free wave surface with the obstacle it should be noted that the reason why vortex generates at the corner of the structure is because velocities at the corner are relatively large when the body rotates around its gravity center and flow separation is easily caused by viscous effect at the corner which has been demonstrated in previous research jung et al 2006 it is also noteworthy that the rotation directions of the vortexes do not follow the rotate motion of the body and phase lags exist between them vortex at lower left corner exits in most of the wave cycle while the phenomena of vortex generation and dissipation occasionally happen at other corners overall the proposed model gives a good prediction of the velocity field around the body 3 5 influence of elastic deformation to study the influence of elastic deformation of mooring lines on motion responses a set of cases with different mooring line diameters are conducted the mooring line diameter is in the range of 0 35 mm 7 0 mm and the corresponding elastic coefficient is in the range of 5 0 10 4 n m to 2 0 10 7 n m t m a x is the maximum tensile force acting on the offshore and onshore mooring lines and τ is the corresponding maximum stress on the mooring lines θ m a x and δ x m a x are the maximum pitch angle and sway displacement respectively δ y m a x and δ y m a x represent the maximum heave displacement along the downward and upward directions respectively t m a x θ m a x δ x m a x δ y m a x and δ y m a x are the average peak values within five wave cycles the simulated results are listed in table 2 the results of tensile forces and motion responses in the first case with infinite elastic coefficient are the average values in the rigid case shown in fig 6 the modulus of elasticity of the mooring line is 2 05 10 11 pa when the diameter of mooring line is 7 mm it is shown the maximum motion responses θ m a x δ x m a x and δ y m a x are the same with the rigid case with infinite elastic coefficient indicating the elastic deformation has no influence on the wave structure interaction with a decrease of diameter from 7 mm to 5 mm the simulated results remain the same as the diameter decreases from 5 mm to 0 35 mm the maximum tensile forces and heave motion responses increase gradually while the sway displacement and pitch angle remain almost the same in the rigid case the maximum heave displacement along the upward direction δ y m a x is equal to zero as the deformations of mooring lines are not allowed in the elastic case the magnitudes of δ y m a x and δ y m a x gradually increase with the increase of elastic coefficient inferring the heave displacements are affected by the deformation of mooring lines the stress on the mooring line rises rapidly with the decrease of diameter as it varies inversely to its cross sectional area when the diameter is 0 35 mm the stress increases to 580 mpa which is very large and has the potential to exceed the ultimate tensile strength thus the cases with a diameter smaller than 0 35 mm are not studied for comparison the diameter of the mooring chaines in the experiment is around 7 mm indicating it is suitable to use a rigid model to study the wave structure interaction which has also been demonstrated by the comparison with experimental data in fig 6 in the next section the rigid model is adopted to study the hydrodynamic responses of a submerged floating tunnel under various conditions by the assumption of mooring chains with high elastic coefficient are used 4 hydrodynamic response of a submerged floating tunnel 4 1 numerical model setup fig 9 a shows a typical sft tube cable system in the wave the conceptual design of sft in a water depth of 100 m with a span of 30 km for funka bay hokkaido located in japan maeda et al 1994 is taken as the analysis case in this paper as shown in fig 9 b the designed sft has a main body with two railway lanes and four car lanes the design values of structure parameters and local water parameters specified by the society of submerged floating tunnel technology research in hokkaido are used for reference in the following analysis the shape of the submerged floating tunnel in fig 9 is circular which is different from the rectangular body in the previous section as shown in fig 9 a rectangular shape exists in the inner part of the circular body inferring the mechanics model of the circular body is the same as the rectangular one thus eqs 4 8 are applicable to solve the unknown accelerations and tensile forces in the case of circular sft however a difference exists between these two shapes in the flow chart shown in fig 4 to obtain hydrodynamic wave forces and moments acting on the body we have to integrate the pressure and shear stress on all the surfaces of the body the integrated surfaces in the rectangular body consist of four surfaces while only one circular surface is integrated with the circular body it is known that the wave energy concentrates on the water surface and decreases rapidly with the increase of water depth inferring the submersion depth between the water surface and the submerged floating tunnel has a certain influence on the responses of sft a large submersion depth means less impact on environment and navigation while the construction cost of sft increases a small submersion depth means less construction cost while the sft is subjected to the concentrated wave energy on the water surface in order to satisfy the requirement of navigation space for big vessels and reduce the impact from the water surface wave the clearance depth between the water surface and the submerged floating tunnel is proposed to be 30 m which is also suggested for the design of clearance depth by many other researchers in a shipping way xiang et al 2017 jiang et al 2018 however does the suggested submersion depth for navigation means the fulfilment of safety design to have a better understanding of the effect of submersion depth three water depths are chosen in the following parametric study bwr is defined as the ratio of buoyancy to the self weight of sft and it is a key parameter of sft long et al 2009 lu et al 2011 for it not only reflects the structure mass of sft but also determines the initial tension force of the mooring system thus the influences of fundamental structure parameter bwr on the mooring force as well as three motion responses should be analyzed according to local environmental conditions of funka bay specified by the society of submerged floating tunnel technology research the significant wave height h s and peak wave period are 9 3m and 13s respectively to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters a parametric study is then conducted a total of 49 cases are designed for the numerical simulation as shown in table 3 the relevant parameters in the numerical experiments are set to be within a realistic range under wave conditions the water depth h ranging from 80 to 120 m the corresponding submersion depth d ranging from 10 to 30 m the wave period t i ranging from 8 0 to 13 0 s the wave height h i ranging from 2 0 to 9 3 m and the bwr ranging from 1 1 to 1 8 4 2 results and discussion as all of the following cases involve several parameters abbreviations are used to describe a case for example h9 3 t1 min denotes the minimum offshore mooring force of the case with wave height h i 9 3 m d30 t2 max denotes the maximum onshore mooring force of the case with submersion depth d 30 m bwr1 5 initial force denotes the initial tensile forces on the mooring chains in still water with bwr 1 5 4 2 1 motion responses figs 10 12 show the influences of hydrodynamic parameters on motion responses the effects of bwr and wave height on pitch motion responses are presented in fig 10 a showing the correlation between pitch motion response and bwr is not merely linear or quadratic but parabolic with a peak value similar phenomenon is also found in figs 11 a 12 a in the correlation between bwr and two other motion responses i e sway motion and heave motion which is because the maximum displacements of three motion responses always happen at the same time in this mooring system as shown in fig 6 the initial force at still water is an essential component of constraint mooring forces which play a negative role in the motion response in tensioned mooring systems ren et al 2017 the maximum mooring forces increase quickly with increasing bwr as initial force increase within lighter weight when bwr exceeds 1 6 constraint mooring forces reach a high level and play a more critical role in limiting the motion responses than wave force and the amplitudes of movement begin to decrease as a result it is noteworthy that the decrease of motion displacements is slow in a large wave height of 9 3 m and fast in small wave height of 4 0 m and 2 0 m which is probably because more wave energy is distributed around the sft under a large wave height within the same submersion depth the effects of bwr and submersion depth on motion responses with t 13s and h i 4 0 m are presented in figs 10 b 12 b the curves describing the correlation between motion responses and bwr are all parabolic inferring the phenomenon of peak motion response exist in the hydraulic conditions with different submersion depths the impact of submersion depth on motion responses is noticeable which is attributed to the decrease of wave energy acting on the sft with a large submersion depth as shown in figs 10 c 12 c motion displacements in large wave periods are much larger than that in short wave period due to the differences in wave energy especially when bwr is equal to 1 5 which is close to the corresponding bwr in peak motion responses as shown in figs 10 12 the amplitudes of sway motion are several times larger than heave motion pointing out the displacement along with wave propagation direction is more dangerous than that in the vertical direction besides the sizeable inclined angle of the road surface in tunnel induced by the pitch motion of sft within large values of bwr also seriously affect the safety of the vehicles and raises the possibility of a traffic accident 4 2 2 mooring forces the simulated results of mooring forces with bwr varying in the range of 1 1 1 8 are presented in fig 13 the ordinate value in fig 13 represents the magnitude of the mooring forces acting on sft per unit length the offshore mooring forces t 1 are plotted in dashed lines the onshore mooring forces t 2 are plotted in solid lines fig 13 a shows the influences of bwr and wave height on mooring forces the results show both maximum offshore and onshore mooring forces increase with bwr and the slope becomes deep first and gentle later when bwr is around 1 6 especially in small wave heights as to the minimum mooring forces the mooring forces also increase with bwr except for a trough when bwr is around 1 6 with small wave height the phenomenon of the rapid changing slopes in the curves of both offshore and onshore mooring forces are closely correlated with the fiercest wave tunnel interaction at bwr 1 6 the mooring forces consist of two parts i e initial force at still water and external force induced by motion responses the initial force increase with bwr as the weight of sft decreases which is an essential reason that mooring forces increase with bwr in general thus the rapid changing slopes in the curves of mooring forces compared with initial force are caused by the external force induced by motion responses when bwr exceeds 1 6 the motion responses decrease rapidly at small wave heights i e h i 2 0 m and 4 0 m and relatively slow at large wave heights i e h i 9 3 m which is the reason why slopes in the curves of mooring forces at different wave height exhibits some differences at a large value of bwr fig 13 b shows the influences of bwr and wave height on mooring forces with t 13s and h i 4 0 m the trends of mooring forces varied with bwr within different submersion depths are similar in the same wave height and wave period overall mooring forces decrease with the increase of immersion depth demonstrating the water depth has a certain influence on the mooring forces when the immersion depth increase from 10 m to 30 m and 30 m 50 m the average reduction percentage of maximum mooring forces are 13 2 and 8 9 respectively indicating the measure of increasing the immersion depth by a certain value to protect the sft mooring system is a useful way as what we have expected however the mooring forces are still large when the submersion depths are 30 m and 50 m in extreme wave conditions inferring the suggested submersion depth of 30 m guarantees the save navigation on the water surface but not ensure the safety of sft mooring system fig 13 c shows the influences of wave period on mooring forces the results show maximum mooring forces increase with wave period and minimum mooring forces decrease with wave period as mentioned above the total mooring force can be divided into two parts i e initial force and force induced by motion responses the initial tensile forces keep constant within different wave periods as the amplitudes of motion responses increase with different wave period and the total mooring forces increase as a result the mooring forces change linearly with wave period when bwr is 1 3 while the slopes of curves become deeper with wave period when bwr is 1 5 which is attributed to the corresponding value of bwr in peak motion response is close to 1 5 the external forces caused by wave tunnel interaction are relatively small in the condition of short wave period at bwr 1 5 and increase decrease to extremely large small values in significant wave period of 13 s pointing out mooring systems are at the risk of exceeding ultimate tensile strength and becoming slack at the condition of long period wave as to maximum mooring force onshore mooring forces are larger than offshore mooring force for the most part except when bwr is less than or equal to 1 2 as to minimum mooring force onshore mooring force is smaller than offshore mooring force for the most part except when bwr is very small if minimum mooring force is too small the mooring line has a potential to go slack probably leading to a sudden large increase in the maximum mooring force which may be a maximum of around 20 times as large as normal forces in the mooring lines without slack lu et al 2011 it is seen from fig 13 that if bwr is equal to 1 1 the magnitudes of both minimum offshore and onshore mooring force are close to zero meaning the mooring lines are at the risk of going slack in addition minimum onshore mooring force increases at first and then decreases with bwr indicating the onshore mooring line may also go slack at a large value of bwr under a more severe wave condition figs 10 13 show bwr plays a key role in the interaction of sft and wave and the design of bwr should refer to the conclusions summarized in the numerical experiments if bwr is small the mooring line may suffer from extremely large snap force in the slack state which is much larger than the mooring forces in conditions with large values of bwr meanwhile a small bwr also means the mass of bwr is large and it leads to a rise in construction cost which is not economical if bwr is large the sft may undergo a fierce movement and the large motion displacements are dangerous for vehicles passing through the tunnel in the meantime the onshore mooring line has the potential to go slack at a large value of bwr with severe hydrodynamic conditions where minimum onshore force may be close to zero a large bwr also means constraint forces in mooring systems increase and the high tension force put forward higher requirement for the strengths of mooring chains and anchoring though the economic cost reduces at a large bwr as the weight of sft decreases the structure strength of bwr with lightweight may encounter problem under the joint action of hydrodynamic force and mooring force overall the amplitudes of motion responses and tensile forces increase with wave height and wave period and decrease with submersion depth the influences of wave period on wave tunnel interaction magnify in a large wave period when the value of bwr is around 1 6 the immersion depth has a certain effect on the interaction while the suggested submersion depth of 30 m for the save navigation on the water surface does not ensure the safety of the mooring system the value of bwr should not be too large or too small and a medium value is suitable for a profound consideration when design first a medium value of bwr can effectively avoid the happening of snap forces in mooring lines for the most part even in the situations of larger wave height second the medium tensile stress in mooring lines is beneficial for protecting the mooring system without running the risk of exceeding ultimate tensile strength third the selection criterion of bwr also helps to prevent sft from experiencing large movement under external forces in severe wave condition fourth the construction cost can be relatively economical with a medium value of bwr however it is noteworthy that the selection should avoid the value of bwr with peak motion responses i e 1 6 in this case 5 summary and conclusions in this paper a numerical model for analyzing the performance of moored sft with multiple degrees of freedom under wave forces is proposed the ns equations are used as the governing equations to describe the flow field a description of the methodology focusing on the mechanics of the floating body is presented in this paper to preserve the mesh quality around the tunnel during the entire computation an efficient mesh update method is applied to the numerical simulation where the total domain is divided into 6 zones and each zone is designed for a particular motion type two wave absorption zones are distributed in the front and rear of the sft to absorb reflected waves and transmitted waves in the numerical wave tank making sure the working zone is not affected by reflected waves two laboratory experiments are used for validating the numerical model in terms of surface elevations motion responses and mooring forces of the sft indicating the proposed model is capable of simulating the interactions between surface waves and sft constrained by mooring chains the prototype sft designed for funka bay hokkaido located in japan has been simulated using the verified hydrodynamic model for wave structure interaction a total of 49 cases are designed for the numerical simulation to investigate the characteristics of the wave tunnel interaction for different hydrodynamic parameters the numerical simulations shed light on the offshore and onshore mooring forces as well as pitch sway and heave responses of the sft under different bwr conditions it is shown both offshore and onshore mooring lines are at the risk of going slack when bwr is small and onshore mooring line also has a potential to go slack when bwr is large under a serious wave condition it is also shown that the correlation between the motion responses and bwr is not merely linear or quadratic but parabolic with a peak value which is closely correlated with the constraint mooring forces reaching a high level and playing a more important role in limiting the motion responses than wave force at a large value of bwr the results also infer the amplitudes of sway motion are several times larger than heave motion pointing out the displacement along with the wave propagation direction is more dangerous than that in the vertical direction in the parametric investigations of prototype sft the amplitudes of motion responses and tensile forces increase with wave height and wave period and decrease with submersion depth when the value of bwr is close to the point where peak motion responses happen the influences of wave period on wave tunnel interaction magnify especially in the long period wave the immersion depth has a certain effect on the wave tunnel interaction while the suggested submersion depth of 30 m for the save navigation on the water surface does not ensure the safety of the mooring system bwr is demonstrated to be a key parameter for the design of sft and a suitable value is desirable and should be given a profound consideration overall the value of bwr should not be too large or too small and a medium value is suggested which is conducive to avoiding the happening of snap forces in mooring chains at small bwr and preventing sft from experiencing large movement under external forces at large bwr in severe wave condition finally it is noted that the value of bwr should not be around the point where peak motion responses happen when selecting a medium value credit authorship contribution statement xuebin chen manuscript preparation conceptualization study concepts literature research data curation formal analysis data analysis figures qin chen manuscript preparation conceptualization study concepts zhiwu chen manuscript preparation manuscript preparation shuqun cai conceptualization study concepts xianrong zhuo literature research data curation formal analysis data analysis jiangen lv formal analysis data analysis figures declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was jointly supported by department of education of guangdong province china 2019kqncx047 ka200190148 key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0304 department of natural resources of guangdong province china 2020 017 state key laboratory of tropical oceanography south china sea institute of oceanology chinese academy of sciences lto2008 department of science and technology of guangdong province 2020b020208002 
21152,mooring line tension typically involves a bimodal process in which a wave frequency component and a low frequency component are induced by dynamic wave loading the non gaussian characteristics make fast frequency domain estimation inaccurate although the time domain fatigue damage is believed to be the most reliable method it is computationally expensive thus in the present study surrogate models including artificial neural network and kriging models are constructed for fatigue damage prediction of the bimodal tension process to improve the accuracy and efficiency compared with the simple frequency and time domain approaches a parametric study is conducted to investigate the spectrum parameters and correction factor for the bimodal tension process and the fatigue damage under arbitrary wave conditions is evaluated using interpolation techniques for long term fatigue analysis the fatigue failure probability of mooring lines under dynamic environmental loads is calculated using the surrogate models and various spectral fatigue techniques the results indicate that with a finite database of time domain fatigue damage the proposed surrogate models based approach can provide a significantly more accurate assessment of the fatigue failure probability than spectral based approaches keywords mooring system fatigue assessment artificial neural network kriging model bimodal tension process 1 introduction floating structures are crucial for the development of oil and gas resources in deep and ultradeep water mooring systems as critical components of coupled floating systems have been the focus of substantial research involving design and safety evaluations under different operational conditions campanile et al 2018 barrera et al 2020 the fatigue design procedure is essential for mooring systems of floating structures encountering cyclic environmental loads jimenez martinez 2020 performed a review of statistical fatigue damage assessment under stochastic loadings for offshore structures probabilistic and long term fatigue assessment is resource consuming for marine structures because of the complex nonlinearities in both the structural properties and environmental loading needed to achieve accurate and robust designs thies et al 2014 wu et al 2015 hou et al 2018 2020 perez et al 2019 barrera et al 2020 zarandi and skallerud 2020 yang et al 2020 various models have been developed for evaluating structural fatigue damage the direct approach which combines a counting procedure e g level crossing rainflow counting and a proper cumulative damage rule linear miner s rule from stress tension time histories is believed to be the most reliable method it is well known that the fatigue data often exhibits pronounced scatter thus the fatigue p s n curve is a common tool to evaluate the relationship among the fatigue failure probability stress range and fatigue life li et al 2020 a typical s n t n curve that is commonly employed for fatigue analysis has been given in the specification api 2005 however the numerical simulations for time series response with small calculation steps are expensive and time consuming thus frequency spectrum techniques and statistical indices of the stress tension amplitude or damage distributions have been employed gao and moan 2007 park and song 2015 in the frequency domain approach the irregular stress tension response induced by random wave loads is regarded as a stationary gaussian stochastic process the stress tension amplitude can be described by a rayleigh distribution assumption and the fatigue damage is calculated in the frequency domain in terms of narrow banded power spectral parameters a typical mooring tension history consists of the wave frequency wf and low frequency lf drift response which cannot be simplified as a narrow banded gaussian process gao and moan 2007 several spectral correction models have been proposed for estimating the fatigue damage of bimodal processes gao and moan 2007 proposed a simplified but accurate frequency domain approach for fatigue assessment of dynamic bimodal mooring lines on the basis of jiao moan s theory low 2010 examined the reduction of the small cycle amplitudes caused by the lf process and the offset between the hf and lf peaks and accurately estimated the fatigue damage induced by bimodal processes han et al 2016 developed a theoretical method for the combination of the fatigue damage under low and high frequency gaussian random processes gao and zheng 2019 proposed an improved spectral discretisation method for fatigue damage assessment of bimodal gaussian processes based on the single moment method the narrowband condition is not satisfied for the mooring tension process thus the rayleigh amplitude distribution produces an inaccurate and conservative fatigue assessment for fatigue evaluation in wide band processes formulae for correcting the bandwidth were developed by wirsching and light 1980 dirlik 1985 jiao and moan 1990 zhao and baker 1992 fu and cebon 2000 and benasciutti and tovo 2005 additionally new probability density functions pdfs have been proposed as alternatives to the rayleigh distribution for improving the fatigue evaluation in stress range simulations park et al 2014 chang et al 2017 numerous studies involving mooring system fatigue analysis based on time and frequency domain approaches have been performed xu et al 2014 performed a statistical analysis of the stress range of a mooring line based on time domain results and performed a fatigue analysis for random loads wu et al 2015 analysed the lf and wf tension ranges and identified the most critical fatigue damage locations for different mooring systems xue et al 2018 performed a mooring system fatigue analysis for a semi submersible platform using t n and s n curves and fracture mechanics based approaches barrera et al 2020 performed a mooring system fatigue analysis of a floating offshore wind turbine with consideration of the effects of the ocean conditions on the lifecycle and dynamic performance of the platform the frequency spectrum was used to conduct a fatigue analysis on marine structures many challenges must be overcome to improve and correct the damage assessment in this process rainflow approach is time consuming while usually can be regarded as benchmarks for fatigue damage evaluation recently surrogate models have been used for fatigue analysis to reduce the calculation cost while maintaining a high accuracy anns have seen widespread application in marine engineering and have proven to be capable for solving most mapping problems e g health monitoring of mooring systems performance assessment of submarine pipelines and stress amplitude cycle prediction nazari et al 2015 aqdam et al 2018 li et al 2018 zhao et al 2020 a zhao et al 2020 b kim et al 2016 conducted a study on the fatigue damage model for wideband process of two peaks by an ann model li et al 2018 conducted wide banded fatigue damage evaluation of catenary mooring lines using various artificial neural networks models durodola et al 2018 presented ann model for predicting fatigue damage including the effect of mean stress the machine learning method is potential to derive the fatigue analysis and some surrogate models have been adopted in fatigue analysis kim et al 2018 jimenez martinez and alfaro ponce 2019 low 2014 presented a simple surrogate model for the rainflow fatigue damage arising from processes with bimodal spectra teixeira et al 2017 performed fatigue reliability design with kriging surfaces for an offshore wind turbine dimitrov et al 2018 proposed a procedure for quick assessment of site specific lifetime fatigue loads using five surrogate models polynomial chaos expansion quadratic response surface universal kriging importance sampling and nearest neighbour interpolation teixeira et al 2019 used kriging models to perform the complex time domain stress cycle fatigue assessment for offshore wind turbines which expedited the design process li and zhang 2020 conducted long term fatigue damage assessments at critical locations of a floating wind turbine using surrogate models including the kriging model and the artificial neural network ann zhou et al 2020 adopted the kriging model to construct lifetime responses for y shaped semi submersible floating wind turbines based on 1 year full simulation results slot et al 2020 used surrogate models including polynomial chaos expansion and kriging model for fatigue load prediction all studies indicate that surrogate models can provide fatigue damage assessment with high accuracy and efficiency in this study the probabilistic fatigue damage analysis of a bimodal tension process excited by irregular wave loads was conducted a comparison of time domain analysis tda and spectrum techniques employing various wide band correction models and fatigue life distribution assumption was performed surrogate techniques including ann and kriging models are constructed for fatigue prediction and long term assessment a flowchart of this study is presented in fig 1 the remainder of this paper is organised as follows a brief introduction to the existing theories for the fatigue analysis of mooring lines is presented in section 2 the probabilistic fatigue analysis procedure based on the limit state function is introduced in section 3 then the surrogate models for fatigue assessment are presented in section 4 a numerical example is presented and validated in section 5 and conclusions are drawn in section 6 2 background theories for fatigue assessment in this section existing techniques for fatigue assessment including hydrodynamic models time and frequency domain methods and bimodal treatment methods are introduced 2 1 tda the irregular waves and the alternating stress in floating structures induced by dynamic wave loading are both typical random processes the fatigue damage is mainly related to the magnitude of the stress range and its cycle number thus coupled dynamic analysis of the floating system should be conducted for each wave condition to obtain the mooring line tension time series and then the fatigue damage can be evaluated according to the stress cycle counting schemes and damage accumulation rule the coupled analysis in the time domain considers the randomness and nonlinear characteristics of wave structure interactions and the damage assessment is considered to be accurate and reliable low 2011 2 1 1 lf and wf components the potential flow theory is widely used to calculate the hydrodynamic loads on large scale floating structures the hydrodynamic load can be calculated by integrating the linearised pressure over the wet surface of the floating structure the wave excited dynamic tension of the mooring line comprises a combination of the wf tension and the lf tension as shown in fig 2 xue et al 2018 conducted a mooring system fatigue analysis for a semi submersible platform and the tension ranges of mooring lines induced by the wf and lf motions were calculated in xue s study the lf tension of a two dimensional multi material mooring line was evaluated using a quasi static analysis method the variation in the mooring tension induced by wf motions is calculated using a dynamic system numerical software e g ansys aqwa and sesam can accurately solve the dynamic responses of floating structures considering both the wf and lf components 2 1 2 miner s rule for tda in the tda method it is inevitable to evaluate the fatigue damage of mooring lines subjected to complex tension histories by evaluating the stress range and counting the corresponding cycles when the alternating cyclic loads make the stress strain behaviour produce a closed hysteresis loop a complete cycle is generated the rainflow counting rfc procedure can be used to identify the stress tension range and corresponding number of cycles in the fluctuation process the algorithms for rfc were previously presented matsuishi and endo 1968 downing and socie 1982 yeter et al 2015 once the practical stress tension range and number of cycles are identified using the rfc method the s n t n curves should be adopted to determine the limit on the number of cycles n corresponding to a constant amplitude stress tension range s t a typical t n curve that is commonly employed to calculate nominal tension fatigue lives of mooring components can be defined as follows api 2005 1 n r m k lg n lg k m lg r where n represents the number of cycles to fatigue failure at a constant tension range r represents the ratio of the tension range double amplitude to the reference breaking strength rbs and m and k represent the negative inverse slope and the intercept parameter of the fatigue curve depending on the material properties respectively these parameters for various mooring components are determined according to the results of fatigue tests and a regression analysis api 2005 the linear miner s cumulative rule is widely used in engineering which assumes that the total fatigue damage is a linear summation of the individual fatigue damages corresponding to different stress ranges the individual fatigue damage corresponding to a stress tension range s i t i can be estimated as follows 2 d i n i n i where d i represents the fatigue damage of the material under a constant stress tension level n i represents the number of stress tension cycles at amplitude s i t i which is usually obtained via rfc and n i represents the total number of load cycles that the material can resist in the given stress tension range which can be determined using the t n s n curve obtained from fatigue tests by adopting the linear miner s rule the total damage caused by external loads can be calculated as follows 3 d a j i 1 k d i i 1 k n i n i and 4 d t j 1 r p j d a j where d aj represents the cumulative damage in the jth sea condition k represents the number of identified stress tension ranges from the tda d t represents the total fatigue damage in the service sea area generally fatigue failure occurs at d t 1 r represents the total number of discrete sea conditions and p j represents the occurrence probability of the jth sea condition 2 2 frequency domain analysis fda tda has several shortcomings coupled nonlinear dynamic analysis with small steps necessitates complex and time consuming calculations the fda spectral method is also widely used for fatigue analysis in engineering owing to its calculation speed which is higher than that of tda in this method the irregular wave loading is regarded as a stationary gaussian random process the stress tension spectral density can be modelled according to random process theory and the fatigue damage can be estimated by making the following assumption as follows 5 d a j l d n n 0 n l f s s d s k s m n l k 0 s m f s s d s n l k e s m where n l v 0 t represents the total number of stress cycles during a load spectral period t with v 0 being the mean zero up crossing rate f s s represents the pdf of the effective stress range s e s m represents the expectation of s m and k and m are material parameters given by the t n s n curves with miner s cumulative rule the stress parameter ω under discrete or continuous load spectra can be defined as follows 6 ω n l l i 1 k n i n l s i m n l l e s m where l represents the recovery period of the load spectrum the cumulative fatigue damage d in arbitrary period t can be expressed as 7 d t ω k assuming that the cumulative damage of fatigue failure is equal to 1 the fatigue life of the structure can be calculated as follows 8 t f k ω 2 2 1 response spectral parameters considering a stochastic process x t the response spectral density function g ω can be defined according to the fda method as shown in fig 3 whether the stationary stochastic process is narrowband or wideband can be determined according to the bandwidth coefficient ε which can be estimated as follows 9 ε 1 α 2 2 1 m 2 2 m 0 m 4 and 10 α i m i 2 m 0 m 2 i where ε is the bandwidth coefficient ε 0 4 generally corresponds to a random process with a narrow band in engineering α is the irregularity coefficient m 0 m 2 and m 4 represent the 0th 2nd and 4th order spectral moments respectively the nth order spectral moments can be calculated using the spectral density function g ω as follows 11 m i 0 ω n g ω d ω where ω represents the angular frequency in rad s other important spectral parameters used to characterise the alternating stress process such as the expected rates of mean zero up crossings and the occurrence of peaks can be expressed as follows 12 v 0 1 2 π m 2 m 0 and 13 n 0 1 2 π m 4 m 2 2 2 2 rayleigh distribution model for a narrowband stationary normal random process in a sea state the stress amplitude r follows a rayleigh distribution and its pdf is defined as follows 14 f r r r σ x 2 exp r 2 2 σ x 2 where σ x represents the standard deviation of the alternating stress the stress range of the narrow banded process i e s 2r can be estimated as follows 15 f s s s 4 σ x 2 exp s 2 8 σ x 2 0 s according to the narrowband assumption the expected fatigue damage can be calculated as 16 d n b n l k e s m v 0 t k 2 2 σ x m γ m 2 1 where γ denotes the gamma function 2 3 bimodal process 2 3 1 american petroleum institute formulation as mentioned previously the mooring line tension response is a bimodal process involving lf and wf components as shown in fig 4 api 2005 suggests several approaches for estimation of the fatigue damage due to lf and wf tensions the time domain cycle counting method based on coupled dynamic analysis is undoubtedly the most accurate and reliable another method is a simple summation approach in which the lf and wf fatigue damages are calculated independently the individual fatigue damage for each sea state j is estimated according to a rayleigh distribution assumption of the tension peaks as follows 17 d a j n w f j k 2 r w f σ j m γ 1 m 2 n l f i k 2 r l f σ j m γ 1 m 2 where d aj represents the fatigue damage induced by lf and wf tensions in sea state j n wfj and n lfj represent the numbers of wf and lf tension cycles respectively n wfj v wfj0 t n lfj v lfj0 t and r w f σ j and r l f σ j represent the ratios of the standard deviations of the wf and lf tension ranges to the rbs respectively the standard deviation of the tension range is taken as twice the standard deviation of the tension process a combined spectrum the with dual narrow banded correction factor method is suggested considering the two frequency bands the equivalent fatigue damage from the combined spectrum with a correction factor can be expressed as follows jiao and moan 1990 18 d a j ζ j n c j k 2 r c σ j m γ 1 m 2 where n cj represents the number of tension cycles in the combined spectrum which can be calculated using the equivalent mean zero up crossing frequency v cj0 as follows 19 n c j v c j 0 t 20 v c j 0 λ w f j v w f j 0 2 λ l f j v l f j 0 2 21 λ w f j r w f σ j 2 r w f σ j 2 r l f σ j 2 and 22 λ l f j r l f σ j 2 r w f σ j 2 r l f σ j 2 the correction factor ζ j is defined as 23 ζ j v e j 0 v c j 0 λ l f j m 2 2 1 λ w f j λ l f j π λ l f j λ w f j m γ m 1 2 γ m 2 2 v w f j 0 v c j 0 λ w f j m 2 where v ej0 represents the mean up crossing frequency of the envelope in the normalised tension process which is defined as 24 v e j 0 λ l f j 2 v l f j 0 2 λ l f j λ w f j v w f j 0 2 ε w f j 2 where ε represents the bandwidth coefficient for the wf of the normalised tension response which can be determined as 0 1 according to the narrowband assumption 2 3 2 wirsching light method the api recommended formula for mooring line fatigue damage calculation is based on the dual narrowband assumption however many practical measurements have indicated that alternating stresses often have wideband properties the narrowband approximation produces a conservative estimation for the wideband process to estimate the actual fatigue damage due to the wideband process the appropriate correction factor ρ should be defined which is multiplied by the damage based on the narrowband assumption jiao and moan 1990 25 d w b ρ d n b several approximation formulas have been proposed for obtaining the appropriate correction factor wirsching and light 1980 counted a series of wideband alternating stress processes via the rfc method and calculated the cumulative fatigue damage then the results were compared with the rayleigh distribution model and the statistical formula of the correction factor was given as follows 26 ρ w l a m 1 a m 1 ε b m where a and b are related to the slope parameters of the t n curves i e a m 0 926 0 033m and b m 1 587m 2 323 2 3 3 dirlik method dirlik 1985 used the monte carlo technique to simulate two different power spectra in the time domain it is proposed that the linear combination of one exponential and two rayleigh pdfs is approximately the amplitude pdf of the load the corresponding expression is 27 f r 1 m 0 d 1 q e z q d 2 z r 2 e z 2 2 r 2 d 3 z e z 2 2 where z r 2 λ 0 s m 0 represents the normalised amplitude and 28 d 1 2 x m α 2 2 1 α 2 2 d 2 1 α 2 d 1 d 1 2 1 r d 3 1 d 1 d 2 r α 2 x m d 1 2 1 α 2 d 1 d 1 2 x m m 1 m 0 m 2 m 4 q 1 25 α 2 d 3 d 2 r d 1 by substituting eq 27 into eq 5 the fatigue damage based on the dirlik model can be calculated as follows 29 d d k n 0 t k m 0 k 2 d 1 q k γ 1 k 2 k 2 γ 1 k 2 d 2 r k d 3 where n 0 represents the mean peaks rate 2 3 4 tovo benasciutti method rychlik 1993 proved that the expected fatigue damage for a stochastic gaussian process follows one important relationship 30 d r c d d n b where d nb represents the fatigue damage estimation based on the narrow banded rayleigh assumption in accordance with eq 16 d rc represents the damage calculated via the range mean counting procedure tovo 2002 and the stress amplitude pdf is defined as follows 31 f s s m 0 α 2 2 e 1 2 s α 2 m 0 2 and d rc can be calculated by substituting eq 31 into eq 5 32 d r c n 0 k 2 2 m 0 α 2 m γ 1 m 2 benasciutti and tovo 2005 considered the expected fatigue damage as a weighted linear combination of the two bounded damage values in eq 30 33 d t b b d n b 1 b d r c where the weight parameter b can be defined using the spectral parameters as follows 34 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 e 2 11 α 2 α 1 α 1 α 2 1 2 3 probabilistic fatigue analysis 3 1 fatigue limit state function let t d and t f represent the design and fatigue lifetime of the structure respectively then the objective of probabilistic fatigue analysis is to assess the fatigue failure probability in service which is defined as follows 35 p f pr o b t f t d in practical situations the total damage d may not be equal to 1 when fatigue failure occurs by setting d δ f where δ f represents the fatigue damage calculated using miner s rule at failure the fatigue life expression can be modified as follows 36 t f δ f k ω other uncertainties associated with the fatigue life calculation should be considered the uncertainties in the equivalent stress calculation and n s curve definition are modelled as random variables then the time to failure of the structure can be expressed as follows siddiqui and ahmad 2001 37 t f δ f k c m ω where δ f k and c are random variables k represents the uncertainty in the fatigue strength which is reflected by the s n t n curves and is due to the dispersion of the material the uncertainties in the test process and the inadequacy of the test data because assumptions are made in the description of the sea conditions the calculation of the wave force the stress analysis of the structure etc there is an error between the calculated stress range and the real values which is described by the random variable c as follows ω v 0 c s e m c m ω e thus the limit state function can be given as 38 z t f t d δ f k c m ω t d g δ f k c the limit state function is nonlinear and generally the basic random variables δ f k and c may follow arbitrary probability distribution models the reliability of the structural fatigue life can be calculated iteratively using first order second moment or second order reliability methods in practical situations assumptions are typically made for the distribution models of the basic random variables of the fatigue life to simplify the calculation of the reliability 3 2 lognormal distribution format the most common assumption is that the random variables follow a lognormal distribution accordingly the fatigue failure probability can be modified as follows 39 p f pr o b l n t f ln t d additionally the limit state function can be expressed as follows 40 z ln t f ln t d ln δ f k c m ω ln t d ln δ f ln k m ln c ln ω ln t d where ln δ f lnk and lnc are normal random variables thus the reliability index can be calculated as follows 41 β μ z σ z μ ln δ f μ ln k m μ ln c ln ω ln t d σ ln δ f 2 σ ln k 2 m 2 σ ln c 2 ln δ f k c m ω t d ln 1 c δ f 2 1 c k 2 1 c c 2 m 2 where δ f k and c represent the median values of the random variables and c δ f c k and c c are the coefficients of variation covs of the random variables the fatigue failure probability of the structure is given as p f φ β 3 3 weibull distribution format ang et al 2001 performed a reliability based fatigue analysis for floating structures and a weibull distribution model was adopted to formulate the reliability function representing the probability of a failure free life the weibull distribution is versatile for approximating other types of distributions and is widely used to model the fatigue lives of materials sun et al 2014 the pdf is given as 42 f n r u v n w u w r 1 exp n w u w r where u represents the most probable life w represents the minimum life with a conservative assumption of w 0 and r is the shape parameter the mean standard deviation and median of the fatigue life can be expressed as follows 43 μ n u γ 1 1 r 44 σ n u γ 1 2 r γ 2 1 1 r 1 2 and 45 n u ln 2 1 r the shape parameter can be defined in terms of the cov of the fatigue life as follows 46 c n σ n μ n r c n 1 08 thus the failure probability function of the structure can be defined as 47 p f p n n d 1 n d f n d n 1 exp n d n ln 2 c n 1 08 c n 1 08 where n d v 0 t d represents the number of cycles during the design service life and n is given by n k s e m considering the design service life and stress parameter the failure probability function can be expressed as follows 48 p f 1 exp t d ω k ln 2 c n 1 08 c n 1 08 where all the possible uncertainties are described by c n and c n c δ f 2 c k 2 m 2 c c 2 1 2 4 surrogate models for fatigue assessment as mentioned previously the results of the tda often serve as a useful benchmark for fatigue analysis because less arbitrary assumptions exist than fda and all the coupled system nonlinear properties can be considered in the numerical simulations however for probabilistic fatigue analysis or long term fatigue damage assessment coupled dynamic simulations with acceptable accuracy executed for all possible environmental conditions with predefined grid mapping can be complex and computationally expensive the fda method based on random process theory and the narrowband assumption a commonly employed technique is efficient although the results can be unreliable for the common broadband or bimodal loading response of marine structures although a correction factor between the time domain history and the process spectral density has been proposed no exact theoretical framework for frequency domain correction has been established and inherent uncertainties and inaccuracy exist in all the available spectral methods in this section two surrogate models ann prediction and the kriging interpolation technique are employed to evaluate the fatigue damage with high efficiency and accuracy 4 1 computational framework for probabilistic fatigue analysis in this section with the attempt to overcome the disadvantages of traditional tda and fda procedure for probabilistic fatigue damage analysis of mooring system the main work combined with surrogate models was conducted following three levels as depicted in fig 1 in level 1 a finite set of environmental variables such as significant wave height and wave peak period were selected and used as input in finite element model and both frequency and time domain analysis were performed to obtain time series of mooring lines and frequency spectrum parameters then the time domain results combined with rfc method were employed to calculate the fatigue damage under each selected environmental condition additionally the spectral parameters were utilized to calculate the frequency domain results as we all know the fatigue damage obtained from fda is convenient while less adequate than tda finally the correction factor fda tda is utilized as the target output in the surrogate models in level 2 two surrogate models including artificial neural network and kriging model were built using matlab language firstly the artificial neural network was trained validated and tested based on the database generated in level 1 in this model to obtain accurate predicted results both wave data and frequency spectrum parameters bandwidth parameters zero up crossing peaks low and wave frequencies were used as input and the correction factors for tda and fda results are considered as output values secondly another alternative surrogate model kriging model was built using the input data wave data and output data tda results based on a certain interpolation technique similarly the correction factors for tda and fda results can be obtained based on the predicted results because of the different principles of the two surrogate models the parameters of input and output are different but the results can be converted into fatigue damage results close to time consuming tda the actual fatigue damage obtained using kriging model divided by the damage calculated from fast but not accurate fda is the fatigue correction factors obtained by ann model the two surrogate models have the same purpose and efficiency to predict time domain fatigue damage in level 3 the random environmental variables were generated from a joint distribution model of wave data with given service years the constructed surrogate models were applied for fatigue failure probability analysis of mooring systems the main purpose of this section is to provide two alternative reliable and efficient techniques for probabilistic and long term fatigue analysis of bimodal tension process a detailed introduction for the surrogate models is described in section 4 2 and section 4 3 and the application for specific numerical example is conducted in section 5 4 2 ann model anns networks comprising numerous simple interconnected neurons are effective for simulating complex nonlinear or implicit functions for any inputs thus they are adopted to learn the underivable relationship between the input and output data the input variables are usually related to external incentives e g environmental loads or engineering structural parameters that are conducive to statistical observation e g geometric dimensions and the structural response the output data are unknown quantities of interest e g damage level and equivalent stress range in this study a feedforward ann model was utilized to estimate the unspecified relationship between the bimodal response spectrum parameters and the practical fatigue damage of mooring lines the radial basis function neural network rbfnn is a three layer network model that includes an input layer a hidden layer and an output layer and can be used for function approximation or time series analysis frequently owing to its simplicity and fast convergence rate the network training process is known as supervised learning in which the weight parameters are adjusted continuously to achieve the non parametric modelling of the target system by using only the training database until the prediction results satisfy the required accuracy the overall structure of the rbfnn is shown in fig 5 where the main characteristic of this model is taking the euclidean distance between the input and weight vectors as the independent variable in the activation function studies have indicated that rbfnns can precisely approximate nonlinear functions aqdam et al 2018 in the rbfnn model the input layer only acts as the transmission signal the output layer adjusts the linear weight and adopts a linear optimisation strategy thus the learning is fast the hidden layer adjusts the parameters of nonlinear activation function generally according to the gaussian function and the training rate is slow the topology of a single neuron in the rbfnn model is presented in fig 6 the euclidean distance between the weight vector w 1 and the input vector x of each neuron connected to the input layer multiplied by the threshold b are used as the net input to the radial basis transfer function as the distance between the weight and input vectors decreases the net output r increases when the input is 0 the transfer function is equal to 1 maximum value finally the output value y is the weighted summation of the output of each hidden layer taking the ith neuron in the hidden layer as an example the processing and training are described briefly as follows 1 first layer processing for the qth input vector x q x 1 q x 2 q x m q t where m represents the number of neurons in the input layer which is equal to the number of input variables and the weight vector connected to the input layer is w i 1 w 1 i 1 w 2 i 1 w m i 1 t then the input of the ith neuron in the hidden layer can be expressed as 49 k i q j w j i 1 x j q 2 b i 1 where b i i represents the threshold value for the ith neuron which is used to adjust the sensitivity of the neuron 2 hidden layer processing the transfer function of the rbfnn is 50 r a d b a s n exp n 2 therefore the output of the ith neuron in the hidden layer can be expressed as 51 r i q exp k i q 2 exp w i 1 x q b i 1 2 where the values of b i i reflect the width of the response of the output to the input a smaller b i i corresponds to a wider range of the response of the neurons in the hidden layer to the input vector as well as better smoothness between the neurons 3 output layer processing because the excitation function is a purely linear function the output of the network is 52 y q i 1 k r i w i 2 where k represents the number of neurons in the hidden layer in this study the rbfnn is established using the matlab r2016b neural network toolbox the ann model is implemented to predict the fatigue correction factors corresponding to different response spectral parameters under actual sea conditions to obtain good training results a total of seven spectral parameters such as peak frequencies mean zero up crossing rates and bandwidth parameters for lf and wf components and power ratio are used as input variables the true time domain fatigue damage varies greatly under various environmental conditions thus a correction factor which is a parameter calculated from time and frequency domain results is defined and used as the output target therefore there are seven neurons in the input layer and one neuron in the output layer determining the number of neurons in the hidden layer is a key issue a trial and error scheme is typically employed to select the optimal network using a training database neurons are found until the error is minimised additionally as the spread of the radial basis function increases the fitting of the function becomes smoother but owing to the excessive spread numerous neurons are needed to adapt to the rapid change in the function the rbfnn model is trained to minimise the mean square error with a series of candidate spread values and the best spread value is automatically determined 4 3 kriging model the kriging model is a regression algorithm for spatial modelling and prediction interpolation of random process fields based on the covariance function for a particular random process such as an inherent stationary process the kriging model can give the best linear unbiased prediction blup thus it is frequently used to predict target responses that are not obtained by numerical simulations owing to high computational cost arising from numerous observation points there are different variants of the kriging model e g ordinary kriging universal kriging co kriging and disjunctive kriging the ordinary kriging model is employed to predict the fatigue damage under arbitrary sea states because different environmental conditions correspond to different cumulative fatigue damage values and the kriging model is a regression rule for interpolation of random process a database with some wave parameters and fatigue damage can be constructed to train a kriging model thus fatigue damage under arbitrary wave conditions can be predicted directly using the trained kriging model in contrast to the ann model the inputs of the kriging model are wave parameters significant wave height peak zero up crossing period and the output is the actual fatigue damage of the most loaded mooring line the tda results are used as a benchmark in this study we adopt a model d k that expresses the deterministic damage d t for an n dimensional input x as a realisation of a known polynomial and a random deviation process fu et al 2020 teixeira et al 2020 53 d k f α x z x the regression model is expressed by a linear combination of p known functions f j x 54 f α x j 1 p α j f j x α 1 α p f 1 x f p x t where the α parameters are regression coefficients three types of regression models with polynomials of orders 0 1 and 2 were provided in the matlab toolbox details are presented below constant p 1 55 f 1 x 1 linear p n 1 56 f 1 x 1 f 2 x x 1 f n 1 x n quadratic p n 1 n 2 2 57 f 1 x 1 f 2 x x 1 f n 1 x x n f n 2 x x 1 2 f 2 n 1 x x 1 x n f 2 n 2 x x 2 2 f 3 n x x 2 x n f p x x n 2 the statistical process z x is considered to have a mean of zero and the covariance matrix is 58 c o v z x i z x j σ 2 r θ x i x j where σ 2 represents the process variance and r θ x i x j represents the spatial correlation model with parameters θ between the two observation points x i and x j there are various correlation functions such as gaussian exponential exponential general exponential linear spherical cubic and spline models the exponential and gaussian functions are depicted in fig 7 the exponential correlation function is adopted in this study it is given as follows 59 r θ x i x j exp n 1 k θ n x n j x n i where θ n is an unknown correlation parameter that scales the influence of the nth design variable using a kriging surrogate model the blup values y ˆ x at target points x can be approximated as follows 60 y ˆ x f x t α r x t r 1 y f α where α represents a generalised least squares solution 61 α f t r 1 f 1 f t r 1 y where f represents a regression matrix y represents the vector of the observed values r represents a symmetric correlation matrix with entry r ij cov x i x j and r represents a k dimensional vector defined as r x r x 1 x r x k x t the correlation parameters can be estimated by maximising the concentrated likelihood function as follows 62 θ argmax k ln σ ˆ 2 ln r 2 where r represents the determinant of the correlation matrix r and σ ˆ 2 represents the variance of the predicted system which is defined as follows 63 σ ˆ 2 1 k y f α t r 1 y f α the mean squared error between the kriging predictor and actual response is expressed as follows 64 s 2 x σ ˆ 2 1 r t r 1 r 1 f t r 1 r 2 f t r 1 f the unknown parameters in the kriging model can be constructed and calculated using the matlab toolbox dace according to the observation points the kriging predictor can be obtained for any set of input variables in this study it is used to evaluate the short term time domain fatigue of mooring lines under arbitrary wave conditions 5 numerical example a semi submersible platform which operates at a water depth of 500 m was employed in a case study to demonstrate the application of surrogate models for the fatigue analysis of mooring lines because of the complex nonlinear properties of both the coupled floating system and the environmental loads applied to the mooring lines the mooring tension histories had non gaussian and bimodal characteristics in this study comprehensive numerical simulations were performed using the software ansys aqwa for the coupled floating system both time and frequency domain results were obtained to facilitate application of the system and comparisons for probabilistic and long term fatigue analysis based on surrogate models 5 1 semi submersible platform system this semi submersible was a multifunctional platform comprising 2 pontoons 4 columns 4 braces and 12 mooring lines the relevant dimensions of the moored platform are presented in table 1 the mooring system was composed of four groups of lines which were symmetrically arranged the longitudinal angles between each group of three mooring lines and the platform were 37 40 and 45 there are no connected tubes considered in this coupled system a schematic of the floating system is depicted in fig 8 the multi material mooring line in a catenary mooring system was made of chains and polyester ropes the main properties and fairlead points of the mooring lines are presented in table 2 the layout of the mooring lines and the finite element model of the semi submersible platform are presented in fig 8 the wetted surface and braces of the platform are modelled using shell and pipe elements respectively there are 4592 elements after the meshing of the platform with a mesh size 1 m as shown in fig 8 which can be obtained in ansys software the arrangement and properties of mooring lines are defined in aqwa 5 2 metocean condition in this study only the wave induced loads were considered in the coupled hydrodynamic analysis each short term sea state was regarded as a stationary random process and was modelled using the jonswap spectrum with its significant wave height h s and peak period t p defined in aqwa the north atlantic ocean scatter diagram was adopted to account for the environmental effects and the corresponding occurrence frequencies over 1 year are presented in table 3 the wave propagation direction was assumed to be 0 along the x axis in the numerical simulations the most loaded mooring line tension histories and spectral responses were calculated in the tda and fda respectively for all the sea states for calculating the long term fatigue damage of the mooring line a joint distribution model was needed to reflect the wave related variables there are various models for constructing the bivariate joint distribution of the significant wave height h s and zero up crossing period t z such as copula theory and conditional joint models tao et al 2013 bitner gregerson 2015 vanem 2016 in this study a hybrid lognormal gumbel distribution was adopted to model the joint wave variables as follows 65 f h s t z h t f h s h f t z h s t h a marginal pdf for h s is fitted to a gumbel distribution as follows 66 f h s h 1 β exp h α β exp h α β additionally a conditional lognormal distribution for t z given h s with parameters that depend on h s is selected as follows 67 f t z h s t h 1 2 π σ h t exp 1 2 σ 2 h ln t μ h 2 where 68 μ h e ln t z a 1 exp b 1 h c 1 and 69 σ h s t d ln t z a 2 exp b 2 h c 2 thus the joint distribution for the wave related random variables i e f h s t z h t was constructed via a combination of the marginal distribution for h s and a conditional distribution for t z and the distribution parameters α β a i b i and c i for i 1 and 2 can be fitted using the available wave data the fitting results for h s are shown in fig 9 and the location and shape parameters were estimated using moment method as 2 4138 and 1 4114 respectively fig 10 shows the fitting curves of the conditional pdf of t z for different h s values the lognormal distribution provides a good fit to all the sets of wave data the distribution parameters a 1 a 2 b 1 b 2 c 1 and c 2 are estimated as 0 5212 0 03683 0 3333 1 184 2 3180 and 0 1442 respectively 5 3 floating system dynamic response analysis the overall model of the semi submersible platform and the mooring system was established in the hydrodynamic analysis software ansys aqwa the hydrodynamic loads were calculated according to potential flow theory the three dimensional radiation and diffraction technique was adopted to solve the boundary integral equations in the software the frequency and time domain responses considering the lf and wf components under various sea states were simulated using the aqwa fer and aqwa drift modules respectively to provide an intuitive observation of the fatigue damage rule for an arbitrary sea state the additional wave conditions of the scatter diagram were simulated a total of n s 11 9 h s t z 99 simulations were performed in which the significant wave heights ranged from 0 5 to 10 5 m and the zero up crossing periods ranged from 5 5 to 13 5 s 5 3 1 frequency and time domain results for fatigue analysis the spectral density functions of the mooring line tensions were obtained using the aqwa fer module fig 11 illustrates the power spectrum densities of the wave elevation and the most loaded mooring line line 7 tension for a sea state of h s 6 5 m and t z 11 5 s as shown there were well separated wf and lf components approximately 0 07 and 0 37 rad s in the mooring line tension spectrum which were induced by the first and second order wave forces respectively both the wf and lf tensions significantly contributed to the fatigue damage of the mooring lines although individual components are assumed to be narrow banded the combined tension history indicates a wideband process gao and moan 2007 a correction technique is necessary for more accurate fatigue estimation based on the fda procedure ninety nine 3 h hydrodynamic simulations were performed to obtain the mooring line tension response with stable statistical properties the fatigue damage was evaluated accurately according to the total wf and lf time series of the mooring line tension where the mooring line tension amplitudes and their number of cycles were determined via rfc an actual mooring line tension history under the wave condition of h s 6 5 m and t z 11 5 s is presented in fig 12 the tension range from the produced tension process was evaluated and the pdf of the tension range distribution was fitted as shown in fig 13 the mooring line tension range did not follow the rayleigh distribution owing to the complex nonlinearity of mooring system and wave loading and the rayleigh assumption caused a large error for the fatigue damage assessment the three parameter weibull distribution fit the statistical data better than the rayleigh distribution and could be demonstrated for non gaussian fitting in fatigue analysis approximately the results indicate that the non gaussian of the mooring line tension response is feasible and that the correction for the narrowband assumption is significant the fatigue properties of mooring lines were calculated via the approaches described in sections 2 and 3 for common studless link moorings the material parameters k and m in the t n curve were assigned values of 316 and 3 respectively the rbs for this mooring line was taken as the minimum breaking strength of the chain the random variables involved in the probabilistic fatigue analysis based on miner s cumulative rule were the fatigue strength coefficient k numerical calculation error c and cumulative damage index at the fatigue failure stage δ f as defined in eq 37 brief descriptions of these variables are presented in table 4 the reliability indices of the most loaded mooring line calculated using the lognormal and weibull distribution format for various service years are presented in fig 14 as mentioned previously the simple summation of the individual narrowband spectra is inaccurate existing spectral correction models described in section 2 3 were employed for probabilistic fatigue analysis and compared with the time domain fatigue the results were too conservative as shown in fig 14 the large error generated by the spectral models makes it necessary to utilize the accurate surrogate models for fatigue reliability analysis fig 15 shows the fatigue damage results calculated using tda and fda procedures under various sea conditions there was a clear trend between the wave parameters and the target output which ensured that the surrogate models had a high prediction accuracy although this trend or rule could not be explicitly expressed 5 3 2 fatigue correction based on surrogate models in the development of the kriging model all combinations of regression models constant linear and quadratic and correlation functions gaussian exponential exponential linear spherical etc were investigated to obtain an optimal model with high accuracy the regression function did not affect the accuracy of the prediction thus f j x was taken as a constant the exponential correlation function was determined according to the training and test database because the prediction results with other functions were negative under small wave loading the fatigue damage surface obtained from the kriging model is shown in fig 16 the black dots represent the tda results the predicted time domain fatigue damage using kriging model was converted into a correction coefficient because the spectral analysis results were more convenient for probabilistic fatigue analysis to analyse the fatigue damage correction coefficient a parameter based on time and frequency domain results was defined 70 ρ d d t d f where d t represents the fatigue damage calculated using tda and d f represents the result of the simple summation approach based on the rayleigh assumption in the kriging model the correction coefficient can be obtained based on the predicted tda results 71 ρ d d k r i g d f in the ann model when a floating system is determined the fatigue damage has a strong correlation with the spectrum parameters 72 x ω l f ω w f v 0 l f v 0 w f ε l f ε w f γ y ρ d where ω lf and ω wf represent the peak frequencies corresponding to the lf and wf components respectively v 0 lf and v 0 wf represent the mean zero up crossing rates for the lf and wf components respectively ε is a bandwidth parameter and γ ω lf ω wf represents the power ratio these parameters are depicted in fig 3 and defined in section 2 2 y ρ d is the fatigue correction coefficient for bimodal mooring lines that cannot be accurately represented with explicit expressions the predicted tda fatigue damage can be determined as 73 d a n n y ρ d d f once the surrogate models are trained and validated it is used to describe the fatigue limit state function as the response surface can be defined by the surrogate models 74 z δ f k c m ω t d g δ f k c y ρ 0 it is necessary to normalise the training data in the ann model a common data normalisation function is 75 x x x min x max x min where x represents an input variable and x max and x min represent the maximum and minimum values of the input variable respectively the outputs estimated by the anns should be denormalised using a similar expression to evaluate the performance of the surrogate models several statistical errors are employed i e the mean absolute error mae mean absolute relative error mare and standard deviation sd which are defined as follows 76 m a e 1 n i 1 n x a c t u x p r e d i i 1 2 n 77 m a r e 1 n i 1 n x a c t u x p r e d x a c t u i 100 and 78 s d 1 n 1 i 1 n x a c t u x p r e d x a c t u i 2 where x actu and x pred represent actual values and predicted values obtained from the tda and the trained ann model respectively and n represents the number of validation data in this study a total of 199 datasets were divided into two parts 70 of the full database generated by tda and fda was employed for training and validation and 30 was reserved for testing the training process was terminated when the validation error stopped decreasing there were 7 neurons in the input layer 13 neurons in hidden layer and 1 neuron in output layer thus the c parameter of the network was given by a 13 7 matrix and the σ and w parameters were given by 13 1 matrices the test results are displayed in fig 17 in this section we also investigate the effect of activation function on prediction accuracy we applied a multiquadrics function to replace the gauss function in the ann model the trained ann model was used to approximate the limit state function of the mooring line fatigue analysis so that the number of tdas was reduced and the computational efficiency was significantly increased by using fda with a high accuracy the scatter diagrams of the actual and predicted correction factors using the kriging and ann models for the test data are also shown in fig 17 the statistical errors for both kriging and ann models with various activation functions are presented in table 5 the test results agreed well with the tda results as indicated by fig 19 1 1 as a reviewer pointed out the fig 19 was a mistake here the fig 19 should be replaced with fig 17 fig 19 first emerges in the paragraph in front of eq 82 so fig 19 should be placed after eq 82 and table 5 both the kriging model and ann model with a gauss function had a high prediction accuracy the results using a multiquadric activation function show worse than gauss function from the results we can see the surrogate models can be used for probabilistic fatigue analysis of complex and nonlinear mooring systems with high accuracy and efficiency the reliability indices of the most loaded mooring line obtained using tda and the surrogate models are depicted in fig 18 5 4 long term fatigue analysis the mooring system is subjected to cyclic internal tensions induced by external fluctuating wave loads during its service life the long term fatigue damage of the mooring line should represent contributions from all possible sea states it requires the long term probability distribution of wave variables and the short term fatigue damage for different environmental conditions the expected long term fatigue damage can then be obtained by summing the damages corresponding to the sea states as follows 79 d a l h s t z t l d a s h t f h s t z h t d h d t where d a l represents the long term fatigue damage t l represents the total service lifetime at sea in this study it can be expressed as t l t r 365 24 3 where t r represents the service life in years d a s h t represents the short term fatigue damage distribution in the wave condition characterised by significant wave heights h and zero up crossing periods t and f h s t z h t is the long term joint pdf of the wave conditions which is obtained from eq 65 according to observation wave data this straightforward calculation while difficult owing to the nonexplicit short term fatigue damage distribution can be performed using a discrete approach combined with monte carlo simulation as described by li and zhang 2020 80 d a l i 1 n s t l d a i s h i t i f h s t z h i t i where h i t i represents the discrete sample of the random wave variables that follow the specified joint distribution f h s t z h t which can be produced using a random number generation technique and n s represents the total number of generated random variables the random number generation technique used in this study was the inverse cumulative distribution function method this approach involved two steps a n s random samples u 1 u 2 which were uniformly distributed between 0 and 1 were produced via monte carlo simulation b then the random environmental variables were obtained using the inverse transformation method 81 f h s h u 1 f t z h s t h u 2 h f h s 1 u 1 t f t z h s 1 u 2 h the basic principle is that the cumulative distribution function for the random samples h t corresponds to the random samples u 1 u 2 with the established surrogate models the short term fatigue damage for structural system can be efficiently evaluated under any wave conditions and be employed to calculate the long term fatigue damage during service life the kriging model is adopted for mooring line lifetime fatigue damage assessment because the joint lognormal gumbel distribution can provide a perfect simulation of random wave conditions as the input the t r year accumulated fatigue damage for the most loaded line was predicted with different total numbers of environmental conditions n s as shown in fig 19 as expected the cumulative fatigue damage increased with the service life a linear function was used to fit the expected fatigue damage with t r the expected annual fatigue damage can be obtained from the slope of long term fatigue damage in fig 19 as 0 038 year the short term fatigue life can be evaluated by considering all discrete wave conditions in 1 year as 82 d a s i 1 74 γ i d i y e a r 0 032 y e a r where γ i is the annual frequency of wave condition i it is found that the annual fatigue damage obtained from short term analysis is lower than from long term analysis considering long term distribution of sea states 2 2 fig 19 should be placed here after eq 82 because fig 19 just mentioned in the paragraph in front of eq 82 the ann model has similar accuracy to the kriging model but it takes the response spectrum parameters as the inputs fda is significantly faster than tda however a large number of calculation conditions makes long term analysis cumbersome 6 conclusions the objective of this study was to investigate surrogate models for probabilistic fatigue analysis of bimodal mooring lines the time domain rfc method is considered to be the most reliable approach for calculating the fatigue damage however it is time consuming thus the convenient frequency domain fatigue damage based on the narrowband assumption was corrected by various wideband fatigue models the real correction factors from the tda to the fda for different sea states were investigated and ann and kriging models were established for probabilistic and long term fatigue analysis several wideband spectra correction techniques for rainflow damage estimation were reviewed and compared these models provide over conservative results in particular the weibull distribution formulae for the fatigue life is not recommended for the bimodal tension process in the present case we attempted to develop surrogate models capable of fatigue evaluation of mooring lines based on a finite database of rainflow damages in the ann model seven different bimodal spectra parameters are used as input variables and then the correction factors are generated by this model for the frequency domain approach to obtain accurate results the kriging model was also established to make time domain predictions by using wave parameters as independent variables the proposed surrogate models allow efficient prediction and their results are consistent with time domain results i e for rfc and miner s cumulative rule the time domain analysis needs expensive computational effort while the proposed surrogate models greatly improve the efficiency of fatigue analysis with high accuracy the low computational cost made the surrogate models a broad application prospect a fatigue limit state function was constructed based on the lognormal or weibull distribution assumption for random variables or the fatigue life the probability of failure of the most loaded line estimated via the surrogate models was compared those for spectral techniques and the api recommendation the surrogate models provided similar predictions to the tda whereas the other models provided conservative results thus the surrogate models provide efficient alternatives for probabilistic fatigue analysis however the accuracy of the surrogate models is affected by the selection or number of training data for different subjects such as risers or other components of floating structures credit authorship contribution statement yuliang zhao conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization sheng dong conceptualization methodology formal analysis resources writing original draft writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was supported by the national natural science foundation of china shandong joint fund u1706226 and the national natural science foundation of china 51779236 
21152,mooring line tension typically involves a bimodal process in which a wave frequency component and a low frequency component are induced by dynamic wave loading the non gaussian characteristics make fast frequency domain estimation inaccurate although the time domain fatigue damage is believed to be the most reliable method it is computationally expensive thus in the present study surrogate models including artificial neural network and kriging models are constructed for fatigue damage prediction of the bimodal tension process to improve the accuracy and efficiency compared with the simple frequency and time domain approaches a parametric study is conducted to investigate the spectrum parameters and correction factor for the bimodal tension process and the fatigue damage under arbitrary wave conditions is evaluated using interpolation techniques for long term fatigue analysis the fatigue failure probability of mooring lines under dynamic environmental loads is calculated using the surrogate models and various spectral fatigue techniques the results indicate that with a finite database of time domain fatigue damage the proposed surrogate models based approach can provide a significantly more accurate assessment of the fatigue failure probability than spectral based approaches keywords mooring system fatigue assessment artificial neural network kriging model bimodal tension process 1 introduction floating structures are crucial for the development of oil and gas resources in deep and ultradeep water mooring systems as critical components of coupled floating systems have been the focus of substantial research involving design and safety evaluations under different operational conditions campanile et al 2018 barrera et al 2020 the fatigue design procedure is essential for mooring systems of floating structures encountering cyclic environmental loads jimenez martinez 2020 performed a review of statistical fatigue damage assessment under stochastic loadings for offshore structures probabilistic and long term fatigue assessment is resource consuming for marine structures because of the complex nonlinearities in both the structural properties and environmental loading needed to achieve accurate and robust designs thies et al 2014 wu et al 2015 hou et al 2018 2020 perez et al 2019 barrera et al 2020 zarandi and skallerud 2020 yang et al 2020 various models have been developed for evaluating structural fatigue damage the direct approach which combines a counting procedure e g level crossing rainflow counting and a proper cumulative damage rule linear miner s rule from stress tension time histories is believed to be the most reliable method it is well known that the fatigue data often exhibits pronounced scatter thus the fatigue p s n curve is a common tool to evaluate the relationship among the fatigue failure probability stress range and fatigue life li et al 2020 a typical s n t n curve that is commonly employed for fatigue analysis has been given in the specification api 2005 however the numerical simulations for time series response with small calculation steps are expensive and time consuming thus frequency spectrum techniques and statistical indices of the stress tension amplitude or damage distributions have been employed gao and moan 2007 park and song 2015 in the frequency domain approach the irregular stress tension response induced by random wave loads is regarded as a stationary gaussian stochastic process the stress tension amplitude can be described by a rayleigh distribution assumption and the fatigue damage is calculated in the frequency domain in terms of narrow banded power spectral parameters a typical mooring tension history consists of the wave frequency wf and low frequency lf drift response which cannot be simplified as a narrow banded gaussian process gao and moan 2007 several spectral correction models have been proposed for estimating the fatigue damage of bimodal processes gao and moan 2007 proposed a simplified but accurate frequency domain approach for fatigue assessment of dynamic bimodal mooring lines on the basis of jiao moan s theory low 2010 examined the reduction of the small cycle amplitudes caused by the lf process and the offset between the hf and lf peaks and accurately estimated the fatigue damage induced by bimodal processes han et al 2016 developed a theoretical method for the combination of the fatigue damage under low and high frequency gaussian random processes gao and zheng 2019 proposed an improved spectral discretisation method for fatigue damage assessment of bimodal gaussian processes based on the single moment method the narrowband condition is not satisfied for the mooring tension process thus the rayleigh amplitude distribution produces an inaccurate and conservative fatigue assessment for fatigue evaluation in wide band processes formulae for correcting the bandwidth were developed by wirsching and light 1980 dirlik 1985 jiao and moan 1990 zhao and baker 1992 fu and cebon 2000 and benasciutti and tovo 2005 additionally new probability density functions pdfs have been proposed as alternatives to the rayleigh distribution for improving the fatigue evaluation in stress range simulations park et al 2014 chang et al 2017 numerous studies involving mooring system fatigue analysis based on time and frequency domain approaches have been performed xu et al 2014 performed a statistical analysis of the stress range of a mooring line based on time domain results and performed a fatigue analysis for random loads wu et al 2015 analysed the lf and wf tension ranges and identified the most critical fatigue damage locations for different mooring systems xue et al 2018 performed a mooring system fatigue analysis for a semi submersible platform using t n and s n curves and fracture mechanics based approaches barrera et al 2020 performed a mooring system fatigue analysis of a floating offshore wind turbine with consideration of the effects of the ocean conditions on the lifecycle and dynamic performance of the platform the frequency spectrum was used to conduct a fatigue analysis on marine structures many challenges must be overcome to improve and correct the damage assessment in this process rainflow approach is time consuming while usually can be regarded as benchmarks for fatigue damage evaluation recently surrogate models have been used for fatigue analysis to reduce the calculation cost while maintaining a high accuracy anns have seen widespread application in marine engineering and have proven to be capable for solving most mapping problems e g health monitoring of mooring systems performance assessment of submarine pipelines and stress amplitude cycle prediction nazari et al 2015 aqdam et al 2018 li et al 2018 zhao et al 2020 a zhao et al 2020 b kim et al 2016 conducted a study on the fatigue damage model for wideband process of two peaks by an ann model li et al 2018 conducted wide banded fatigue damage evaluation of catenary mooring lines using various artificial neural networks models durodola et al 2018 presented ann model for predicting fatigue damage including the effect of mean stress the machine learning method is potential to derive the fatigue analysis and some surrogate models have been adopted in fatigue analysis kim et al 2018 jimenez martinez and alfaro ponce 2019 low 2014 presented a simple surrogate model for the rainflow fatigue damage arising from processes with bimodal spectra teixeira et al 2017 performed fatigue reliability design with kriging surfaces for an offshore wind turbine dimitrov et al 2018 proposed a procedure for quick assessment of site specific lifetime fatigue loads using five surrogate models polynomial chaos expansion quadratic response surface universal kriging importance sampling and nearest neighbour interpolation teixeira et al 2019 used kriging models to perform the complex time domain stress cycle fatigue assessment for offshore wind turbines which expedited the design process li and zhang 2020 conducted long term fatigue damage assessments at critical locations of a floating wind turbine using surrogate models including the kriging model and the artificial neural network ann zhou et al 2020 adopted the kriging model to construct lifetime responses for y shaped semi submersible floating wind turbines based on 1 year full simulation results slot et al 2020 used surrogate models including polynomial chaos expansion and kriging model for fatigue load prediction all studies indicate that surrogate models can provide fatigue damage assessment with high accuracy and efficiency in this study the probabilistic fatigue damage analysis of a bimodal tension process excited by irregular wave loads was conducted a comparison of time domain analysis tda and spectrum techniques employing various wide band correction models and fatigue life distribution assumption was performed surrogate techniques including ann and kriging models are constructed for fatigue prediction and long term assessment a flowchart of this study is presented in fig 1 the remainder of this paper is organised as follows a brief introduction to the existing theories for the fatigue analysis of mooring lines is presented in section 2 the probabilistic fatigue analysis procedure based on the limit state function is introduced in section 3 then the surrogate models for fatigue assessment are presented in section 4 a numerical example is presented and validated in section 5 and conclusions are drawn in section 6 2 background theories for fatigue assessment in this section existing techniques for fatigue assessment including hydrodynamic models time and frequency domain methods and bimodal treatment methods are introduced 2 1 tda the irregular waves and the alternating stress in floating structures induced by dynamic wave loading are both typical random processes the fatigue damage is mainly related to the magnitude of the stress range and its cycle number thus coupled dynamic analysis of the floating system should be conducted for each wave condition to obtain the mooring line tension time series and then the fatigue damage can be evaluated according to the stress cycle counting schemes and damage accumulation rule the coupled analysis in the time domain considers the randomness and nonlinear characteristics of wave structure interactions and the damage assessment is considered to be accurate and reliable low 2011 2 1 1 lf and wf components the potential flow theory is widely used to calculate the hydrodynamic loads on large scale floating structures the hydrodynamic load can be calculated by integrating the linearised pressure over the wet surface of the floating structure the wave excited dynamic tension of the mooring line comprises a combination of the wf tension and the lf tension as shown in fig 2 xue et al 2018 conducted a mooring system fatigue analysis for a semi submersible platform and the tension ranges of mooring lines induced by the wf and lf motions were calculated in xue s study the lf tension of a two dimensional multi material mooring line was evaluated using a quasi static analysis method the variation in the mooring tension induced by wf motions is calculated using a dynamic system numerical software e g ansys aqwa and sesam can accurately solve the dynamic responses of floating structures considering both the wf and lf components 2 1 2 miner s rule for tda in the tda method it is inevitable to evaluate the fatigue damage of mooring lines subjected to complex tension histories by evaluating the stress range and counting the corresponding cycles when the alternating cyclic loads make the stress strain behaviour produce a closed hysteresis loop a complete cycle is generated the rainflow counting rfc procedure can be used to identify the stress tension range and corresponding number of cycles in the fluctuation process the algorithms for rfc were previously presented matsuishi and endo 1968 downing and socie 1982 yeter et al 2015 once the practical stress tension range and number of cycles are identified using the rfc method the s n t n curves should be adopted to determine the limit on the number of cycles n corresponding to a constant amplitude stress tension range s t a typical t n curve that is commonly employed to calculate nominal tension fatigue lives of mooring components can be defined as follows api 2005 1 n r m k lg n lg k m lg r where n represents the number of cycles to fatigue failure at a constant tension range r represents the ratio of the tension range double amplitude to the reference breaking strength rbs and m and k represent the negative inverse slope and the intercept parameter of the fatigue curve depending on the material properties respectively these parameters for various mooring components are determined according to the results of fatigue tests and a regression analysis api 2005 the linear miner s cumulative rule is widely used in engineering which assumes that the total fatigue damage is a linear summation of the individual fatigue damages corresponding to different stress ranges the individual fatigue damage corresponding to a stress tension range s i t i can be estimated as follows 2 d i n i n i where d i represents the fatigue damage of the material under a constant stress tension level n i represents the number of stress tension cycles at amplitude s i t i which is usually obtained via rfc and n i represents the total number of load cycles that the material can resist in the given stress tension range which can be determined using the t n s n curve obtained from fatigue tests by adopting the linear miner s rule the total damage caused by external loads can be calculated as follows 3 d a j i 1 k d i i 1 k n i n i and 4 d t j 1 r p j d a j where d aj represents the cumulative damage in the jth sea condition k represents the number of identified stress tension ranges from the tda d t represents the total fatigue damage in the service sea area generally fatigue failure occurs at d t 1 r represents the total number of discrete sea conditions and p j represents the occurrence probability of the jth sea condition 2 2 frequency domain analysis fda tda has several shortcomings coupled nonlinear dynamic analysis with small steps necessitates complex and time consuming calculations the fda spectral method is also widely used for fatigue analysis in engineering owing to its calculation speed which is higher than that of tda in this method the irregular wave loading is regarded as a stationary gaussian random process the stress tension spectral density can be modelled according to random process theory and the fatigue damage can be estimated by making the following assumption as follows 5 d a j l d n n 0 n l f s s d s k s m n l k 0 s m f s s d s n l k e s m where n l v 0 t represents the total number of stress cycles during a load spectral period t with v 0 being the mean zero up crossing rate f s s represents the pdf of the effective stress range s e s m represents the expectation of s m and k and m are material parameters given by the t n s n curves with miner s cumulative rule the stress parameter ω under discrete or continuous load spectra can be defined as follows 6 ω n l l i 1 k n i n l s i m n l l e s m where l represents the recovery period of the load spectrum the cumulative fatigue damage d in arbitrary period t can be expressed as 7 d t ω k assuming that the cumulative damage of fatigue failure is equal to 1 the fatigue life of the structure can be calculated as follows 8 t f k ω 2 2 1 response spectral parameters considering a stochastic process x t the response spectral density function g ω can be defined according to the fda method as shown in fig 3 whether the stationary stochastic process is narrowband or wideband can be determined according to the bandwidth coefficient ε which can be estimated as follows 9 ε 1 α 2 2 1 m 2 2 m 0 m 4 and 10 α i m i 2 m 0 m 2 i where ε is the bandwidth coefficient ε 0 4 generally corresponds to a random process with a narrow band in engineering α is the irregularity coefficient m 0 m 2 and m 4 represent the 0th 2nd and 4th order spectral moments respectively the nth order spectral moments can be calculated using the spectral density function g ω as follows 11 m i 0 ω n g ω d ω where ω represents the angular frequency in rad s other important spectral parameters used to characterise the alternating stress process such as the expected rates of mean zero up crossings and the occurrence of peaks can be expressed as follows 12 v 0 1 2 π m 2 m 0 and 13 n 0 1 2 π m 4 m 2 2 2 2 rayleigh distribution model for a narrowband stationary normal random process in a sea state the stress amplitude r follows a rayleigh distribution and its pdf is defined as follows 14 f r r r σ x 2 exp r 2 2 σ x 2 where σ x represents the standard deviation of the alternating stress the stress range of the narrow banded process i e s 2r can be estimated as follows 15 f s s s 4 σ x 2 exp s 2 8 σ x 2 0 s according to the narrowband assumption the expected fatigue damage can be calculated as 16 d n b n l k e s m v 0 t k 2 2 σ x m γ m 2 1 where γ denotes the gamma function 2 3 bimodal process 2 3 1 american petroleum institute formulation as mentioned previously the mooring line tension response is a bimodal process involving lf and wf components as shown in fig 4 api 2005 suggests several approaches for estimation of the fatigue damage due to lf and wf tensions the time domain cycle counting method based on coupled dynamic analysis is undoubtedly the most accurate and reliable another method is a simple summation approach in which the lf and wf fatigue damages are calculated independently the individual fatigue damage for each sea state j is estimated according to a rayleigh distribution assumption of the tension peaks as follows 17 d a j n w f j k 2 r w f σ j m γ 1 m 2 n l f i k 2 r l f σ j m γ 1 m 2 where d aj represents the fatigue damage induced by lf and wf tensions in sea state j n wfj and n lfj represent the numbers of wf and lf tension cycles respectively n wfj v wfj0 t n lfj v lfj0 t and r w f σ j and r l f σ j represent the ratios of the standard deviations of the wf and lf tension ranges to the rbs respectively the standard deviation of the tension range is taken as twice the standard deviation of the tension process a combined spectrum the with dual narrow banded correction factor method is suggested considering the two frequency bands the equivalent fatigue damage from the combined spectrum with a correction factor can be expressed as follows jiao and moan 1990 18 d a j ζ j n c j k 2 r c σ j m γ 1 m 2 where n cj represents the number of tension cycles in the combined spectrum which can be calculated using the equivalent mean zero up crossing frequency v cj0 as follows 19 n c j v c j 0 t 20 v c j 0 λ w f j v w f j 0 2 λ l f j v l f j 0 2 21 λ w f j r w f σ j 2 r w f σ j 2 r l f σ j 2 and 22 λ l f j r l f σ j 2 r w f σ j 2 r l f σ j 2 the correction factor ζ j is defined as 23 ζ j v e j 0 v c j 0 λ l f j m 2 2 1 λ w f j λ l f j π λ l f j λ w f j m γ m 1 2 γ m 2 2 v w f j 0 v c j 0 λ w f j m 2 where v ej0 represents the mean up crossing frequency of the envelope in the normalised tension process which is defined as 24 v e j 0 λ l f j 2 v l f j 0 2 λ l f j λ w f j v w f j 0 2 ε w f j 2 where ε represents the bandwidth coefficient for the wf of the normalised tension response which can be determined as 0 1 according to the narrowband assumption 2 3 2 wirsching light method the api recommended formula for mooring line fatigue damage calculation is based on the dual narrowband assumption however many practical measurements have indicated that alternating stresses often have wideband properties the narrowband approximation produces a conservative estimation for the wideband process to estimate the actual fatigue damage due to the wideband process the appropriate correction factor ρ should be defined which is multiplied by the damage based on the narrowband assumption jiao and moan 1990 25 d w b ρ d n b several approximation formulas have been proposed for obtaining the appropriate correction factor wirsching and light 1980 counted a series of wideband alternating stress processes via the rfc method and calculated the cumulative fatigue damage then the results were compared with the rayleigh distribution model and the statistical formula of the correction factor was given as follows 26 ρ w l a m 1 a m 1 ε b m where a and b are related to the slope parameters of the t n curves i e a m 0 926 0 033m and b m 1 587m 2 323 2 3 3 dirlik method dirlik 1985 used the monte carlo technique to simulate two different power spectra in the time domain it is proposed that the linear combination of one exponential and two rayleigh pdfs is approximately the amplitude pdf of the load the corresponding expression is 27 f r 1 m 0 d 1 q e z q d 2 z r 2 e z 2 2 r 2 d 3 z e z 2 2 where z r 2 λ 0 s m 0 represents the normalised amplitude and 28 d 1 2 x m α 2 2 1 α 2 2 d 2 1 α 2 d 1 d 1 2 1 r d 3 1 d 1 d 2 r α 2 x m d 1 2 1 α 2 d 1 d 1 2 x m m 1 m 0 m 2 m 4 q 1 25 α 2 d 3 d 2 r d 1 by substituting eq 27 into eq 5 the fatigue damage based on the dirlik model can be calculated as follows 29 d d k n 0 t k m 0 k 2 d 1 q k γ 1 k 2 k 2 γ 1 k 2 d 2 r k d 3 where n 0 represents the mean peaks rate 2 3 4 tovo benasciutti method rychlik 1993 proved that the expected fatigue damage for a stochastic gaussian process follows one important relationship 30 d r c d d n b where d nb represents the fatigue damage estimation based on the narrow banded rayleigh assumption in accordance with eq 16 d rc represents the damage calculated via the range mean counting procedure tovo 2002 and the stress amplitude pdf is defined as follows 31 f s s m 0 α 2 2 e 1 2 s α 2 m 0 2 and d rc can be calculated by substituting eq 31 into eq 5 32 d r c n 0 k 2 2 m 0 α 2 m γ 1 m 2 benasciutti and tovo 2005 considered the expected fatigue damage as a weighted linear combination of the two bounded damage values in eq 30 33 d t b b d n b 1 b d r c where the weight parameter b can be defined using the spectral parameters as follows 34 b α 1 α 2 1 112 1 α 1 α 2 α 1 α 2 e 2 11 α 2 α 1 α 1 α 2 1 2 3 probabilistic fatigue analysis 3 1 fatigue limit state function let t d and t f represent the design and fatigue lifetime of the structure respectively then the objective of probabilistic fatigue analysis is to assess the fatigue failure probability in service which is defined as follows 35 p f pr o b t f t d in practical situations the total damage d may not be equal to 1 when fatigue failure occurs by setting d δ f where δ f represents the fatigue damage calculated using miner s rule at failure the fatigue life expression can be modified as follows 36 t f δ f k ω other uncertainties associated with the fatigue life calculation should be considered the uncertainties in the equivalent stress calculation and n s curve definition are modelled as random variables then the time to failure of the structure can be expressed as follows siddiqui and ahmad 2001 37 t f δ f k c m ω where δ f k and c are random variables k represents the uncertainty in the fatigue strength which is reflected by the s n t n curves and is due to the dispersion of the material the uncertainties in the test process and the inadequacy of the test data because assumptions are made in the description of the sea conditions the calculation of the wave force the stress analysis of the structure etc there is an error between the calculated stress range and the real values which is described by the random variable c as follows ω v 0 c s e m c m ω e thus the limit state function can be given as 38 z t f t d δ f k c m ω t d g δ f k c the limit state function is nonlinear and generally the basic random variables δ f k and c may follow arbitrary probability distribution models the reliability of the structural fatigue life can be calculated iteratively using first order second moment or second order reliability methods in practical situations assumptions are typically made for the distribution models of the basic random variables of the fatigue life to simplify the calculation of the reliability 3 2 lognormal distribution format the most common assumption is that the random variables follow a lognormal distribution accordingly the fatigue failure probability can be modified as follows 39 p f pr o b l n t f ln t d additionally the limit state function can be expressed as follows 40 z ln t f ln t d ln δ f k c m ω ln t d ln δ f ln k m ln c ln ω ln t d where ln δ f lnk and lnc are normal random variables thus the reliability index can be calculated as follows 41 β μ z σ z μ ln δ f μ ln k m μ ln c ln ω ln t d σ ln δ f 2 σ ln k 2 m 2 σ ln c 2 ln δ f k c m ω t d ln 1 c δ f 2 1 c k 2 1 c c 2 m 2 where δ f k and c represent the median values of the random variables and c δ f c k and c c are the coefficients of variation covs of the random variables the fatigue failure probability of the structure is given as p f φ β 3 3 weibull distribution format ang et al 2001 performed a reliability based fatigue analysis for floating structures and a weibull distribution model was adopted to formulate the reliability function representing the probability of a failure free life the weibull distribution is versatile for approximating other types of distributions and is widely used to model the fatigue lives of materials sun et al 2014 the pdf is given as 42 f n r u v n w u w r 1 exp n w u w r where u represents the most probable life w represents the minimum life with a conservative assumption of w 0 and r is the shape parameter the mean standard deviation and median of the fatigue life can be expressed as follows 43 μ n u γ 1 1 r 44 σ n u γ 1 2 r γ 2 1 1 r 1 2 and 45 n u ln 2 1 r the shape parameter can be defined in terms of the cov of the fatigue life as follows 46 c n σ n μ n r c n 1 08 thus the failure probability function of the structure can be defined as 47 p f p n n d 1 n d f n d n 1 exp n d n ln 2 c n 1 08 c n 1 08 where n d v 0 t d represents the number of cycles during the design service life and n is given by n k s e m considering the design service life and stress parameter the failure probability function can be expressed as follows 48 p f 1 exp t d ω k ln 2 c n 1 08 c n 1 08 where all the possible uncertainties are described by c n and c n c δ f 2 c k 2 m 2 c c 2 1 2 4 surrogate models for fatigue assessment as mentioned previously the results of the tda often serve as a useful benchmark for fatigue analysis because less arbitrary assumptions exist than fda and all the coupled system nonlinear properties can be considered in the numerical simulations however for probabilistic fatigue analysis or long term fatigue damage assessment coupled dynamic simulations with acceptable accuracy executed for all possible environmental conditions with predefined grid mapping can be complex and computationally expensive the fda method based on random process theory and the narrowband assumption a commonly employed technique is efficient although the results can be unreliable for the common broadband or bimodal loading response of marine structures although a correction factor between the time domain history and the process spectral density has been proposed no exact theoretical framework for frequency domain correction has been established and inherent uncertainties and inaccuracy exist in all the available spectral methods in this section two surrogate models ann prediction and the kriging interpolation technique are employed to evaluate the fatigue damage with high efficiency and accuracy 4 1 computational framework for probabilistic fatigue analysis in this section with the attempt to overcome the disadvantages of traditional tda and fda procedure for probabilistic fatigue damage analysis of mooring system the main work combined with surrogate models was conducted following three levels as depicted in fig 1 in level 1 a finite set of environmental variables such as significant wave height and wave peak period were selected and used as input in finite element model and both frequency and time domain analysis were performed to obtain time series of mooring lines and frequency spectrum parameters then the time domain results combined with rfc method were employed to calculate the fatigue damage under each selected environmental condition additionally the spectral parameters were utilized to calculate the frequency domain results as we all know the fatigue damage obtained from fda is convenient while less adequate than tda finally the correction factor fda tda is utilized as the target output in the surrogate models in level 2 two surrogate models including artificial neural network and kriging model were built using matlab language firstly the artificial neural network was trained validated and tested based on the database generated in level 1 in this model to obtain accurate predicted results both wave data and frequency spectrum parameters bandwidth parameters zero up crossing peaks low and wave frequencies were used as input and the correction factors for tda and fda results are considered as output values secondly another alternative surrogate model kriging model was built using the input data wave data and output data tda results based on a certain interpolation technique similarly the correction factors for tda and fda results can be obtained based on the predicted results because of the different principles of the two surrogate models the parameters of input and output are different but the results can be converted into fatigue damage results close to time consuming tda the actual fatigue damage obtained using kriging model divided by the damage calculated from fast but not accurate fda is the fatigue correction factors obtained by ann model the two surrogate models have the same purpose and efficiency to predict time domain fatigue damage in level 3 the random environmental variables were generated from a joint distribution model of wave data with given service years the constructed surrogate models were applied for fatigue failure probability analysis of mooring systems the main purpose of this section is to provide two alternative reliable and efficient techniques for probabilistic and long term fatigue analysis of bimodal tension process a detailed introduction for the surrogate models is described in section 4 2 and section 4 3 and the application for specific numerical example is conducted in section 5 4 2 ann model anns networks comprising numerous simple interconnected neurons are effective for simulating complex nonlinear or implicit functions for any inputs thus they are adopted to learn the underivable relationship between the input and output data the input variables are usually related to external incentives e g environmental loads or engineering structural parameters that are conducive to statistical observation e g geometric dimensions and the structural response the output data are unknown quantities of interest e g damage level and equivalent stress range in this study a feedforward ann model was utilized to estimate the unspecified relationship between the bimodal response spectrum parameters and the practical fatigue damage of mooring lines the radial basis function neural network rbfnn is a three layer network model that includes an input layer a hidden layer and an output layer and can be used for function approximation or time series analysis frequently owing to its simplicity and fast convergence rate the network training process is known as supervised learning in which the weight parameters are adjusted continuously to achieve the non parametric modelling of the target system by using only the training database until the prediction results satisfy the required accuracy the overall structure of the rbfnn is shown in fig 5 where the main characteristic of this model is taking the euclidean distance between the input and weight vectors as the independent variable in the activation function studies have indicated that rbfnns can precisely approximate nonlinear functions aqdam et al 2018 in the rbfnn model the input layer only acts as the transmission signal the output layer adjusts the linear weight and adopts a linear optimisation strategy thus the learning is fast the hidden layer adjusts the parameters of nonlinear activation function generally according to the gaussian function and the training rate is slow the topology of a single neuron in the rbfnn model is presented in fig 6 the euclidean distance between the weight vector w 1 and the input vector x of each neuron connected to the input layer multiplied by the threshold b are used as the net input to the radial basis transfer function as the distance between the weight and input vectors decreases the net output r increases when the input is 0 the transfer function is equal to 1 maximum value finally the output value y is the weighted summation of the output of each hidden layer taking the ith neuron in the hidden layer as an example the processing and training are described briefly as follows 1 first layer processing for the qth input vector x q x 1 q x 2 q x m q t where m represents the number of neurons in the input layer which is equal to the number of input variables and the weight vector connected to the input layer is w i 1 w 1 i 1 w 2 i 1 w m i 1 t then the input of the ith neuron in the hidden layer can be expressed as 49 k i q j w j i 1 x j q 2 b i 1 where b i i represents the threshold value for the ith neuron which is used to adjust the sensitivity of the neuron 2 hidden layer processing the transfer function of the rbfnn is 50 r a d b a s n exp n 2 therefore the output of the ith neuron in the hidden layer can be expressed as 51 r i q exp k i q 2 exp w i 1 x q b i 1 2 where the values of b i i reflect the width of the response of the output to the input a smaller b i i corresponds to a wider range of the response of the neurons in the hidden layer to the input vector as well as better smoothness between the neurons 3 output layer processing because the excitation function is a purely linear function the output of the network is 52 y q i 1 k r i w i 2 where k represents the number of neurons in the hidden layer in this study the rbfnn is established using the matlab r2016b neural network toolbox the ann model is implemented to predict the fatigue correction factors corresponding to different response spectral parameters under actual sea conditions to obtain good training results a total of seven spectral parameters such as peak frequencies mean zero up crossing rates and bandwidth parameters for lf and wf components and power ratio are used as input variables the true time domain fatigue damage varies greatly under various environmental conditions thus a correction factor which is a parameter calculated from time and frequency domain results is defined and used as the output target therefore there are seven neurons in the input layer and one neuron in the output layer determining the number of neurons in the hidden layer is a key issue a trial and error scheme is typically employed to select the optimal network using a training database neurons are found until the error is minimised additionally as the spread of the radial basis function increases the fitting of the function becomes smoother but owing to the excessive spread numerous neurons are needed to adapt to the rapid change in the function the rbfnn model is trained to minimise the mean square error with a series of candidate spread values and the best spread value is automatically determined 4 3 kriging model the kriging model is a regression algorithm for spatial modelling and prediction interpolation of random process fields based on the covariance function for a particular random process such as an inherent stationary process the kriging model can give the best linear unbiased prediction blup thus it is frequently used to predict target responses that are not obtained by numerical simulations owing to high computational cost arising from numerous observation points there are different variants of the kriging model e g ordinary kriging universal kriging co kriging and disjunctive kriging the ordinary kriging model is employed to predict the fatigue damage under arbitrary sea states because different environmental conditions correspond to different cumulative fatigue damage values and the kriging model is a regression rule for interpolation of random process a database with some wave parameters and fatigue damage can be constructed to train a kriging model thus fatigue damage under arbitrary wave conditions can be predicted directly using the trained kriging model in contrast to the ann model the inputs of the kriging model are wave parameters significant wave height peak zero up crossing period and the output is the actual fatigue damage of the most loaded mooring line the tda results are used as a benchmark in this study we adopt a model d k that expresses the deterministic damage d t for an n dimensional input x as a realisation of a known polynomial and a random deviation process fu et al 2020 teixeira et al 2020 53 d k f α x z x the regression model is expressed by a linear combination of p known functions f j x 54 f α x j 1 p α j f j x α 1 α p f 1 x f p x t where the α parameters are regression coefficients three types of regression models with polynomials of orders 0 1 and 2 were provided in the matlab toolbox details are presented below constant p 1 55 f 1 x 1 linear p n 1 56 f 1 x 1 f 2 x x 1 f n 1 x n quadratic p n 1 n 2 2 57 f 1 x 1 f 2 x x 1 f n 1 x x n f n 2 x x 1 2 f 2 n 1 x x 1 x n f 2 n 2 x x 2 2 f 3 n x x 2 x n f p x x n 2 the statistical process z x is considered to have a mean of zero and the covariance matrix is 58 c o v z x i z x j σ 2 r θ x i x j where σ 2 represents the process variance and r θ x i x j represents the spatial correlation model with parameters θ between the two observation points x i and x j there are various correlation functions such as gaussian exponential exponential general exponential linear spherical cubic and spline models the exponential and gaussian functions are depicted in fig 7 the exponential correlation function is adopted in this study it is given as follows 59 r θ x i x j exp n 1 k θ n x n j x n i where θ n is an unknown correlation parameter that scales the influence of the nth design variable using a kriging surrogate model the blup values y ˆ x at target points x can be approximated as follows 60 y ˆ x f x t α r x t r 1 y f α where α represents a generalised least squares solution 61 α f t r 1 f 1 f t r 1 y where f represents a regression matrix y represents the vector of the observed values r represents a symmetric correlation matrix with entry r ij cov x i x j and r represents a k dimensional vector defined as r x r x 1 x r x k x t the correlation parameters can be estimated by maximising the concentrated likelihood function as follows 62 θ argmax k ln σ ˆ 2 ln r 2 where r represents the determinant of the correlation matrix r and σ ˆ 2 represents the variance of the predicted system which is defined as follows 63 σ ˆ 2 1 k y f α t r 1 y f α the mean squared error between the kriging predictor and actual response is expressed as follows 64 s 2 x σ ˆ 2 1 r t r 1 r 1 f t r 1 r 2 f t r 1 f the unknown parameters in the kriging model can be constructed and calculated using the matlab toolbox dace according to the observation points the kriging predictor can be obtained for any set of input variables in this study it is used to evaluate the short term time domain fatigue of mooring lines under arbitrary wave conditions 5 numerical example a semi submersible platform which operates at a water depth of 500 m was employed in a case study to demonstrate the application of surrogate models for the fatigue analysis of mooring lines because of the complex nonlinear properties of both the coupled floating system and the environmental loads applied to the mooring lines the mooring tension histories had non gaussian and bimodal characteristics in this study comprehensive numerical simulations were performed using the software ansys aqwa for the coupled floating system both time and frequency domain results were obtained to facilitate application of the system and comparisons for probabilistic and long term fatigue analysis based on surrogate models 5 1 semi submersible platform system this semi submersible was a multifunctional platform comprising 2 pontoons 4 columns 4 braces and 12 mooring lines the relevant dimensions of the moored platform are presented in table 1 the mooring system was composed of four groups of lines which were symmetrically arranged the longitudinal angles between each group of three mooring lines and the platform were 37 40 and 45 there are no connected tubes considered in this coupled system a schematic of the floating system is depicted in fig 8 the multi material mooring line in a catenary mooring system was made of chains and polyester ropes the main properties and fairlead points of the mooring lines are presented in table 2 the layout of the mooring lines and the finite element model of the semi submersible platform are presented in fig 8 the wetted surface and braces of the platform are modelled using shell and pipe elements respectively there are 4592 elements after the meshing of the platform with a mesh size 1 m as shown in fig 8 which can be obtained in ansys software the arrangement and properties of mooring lines are defined in aqwa 5 2 metocean condition in this study only the wave induced loads were considered in the coupled hydrodynamic analysis each short term sea state was regarded as a stationary random process and was modelled using the jonswap spectrum with its significant wave height h s and peak period t p defined in aqwa the north atlantic ocean scatter diagram was adopted to account for the environmental effects and the corresponding occurrence frequencies over 1 year are presented in table 3 the wave propagation direction was assumed to be 0 along the x axis in the numerical simulations the most loaded mooring line tension histories and spectral responses were calculated in the tda and fda respectively for all the sea states for calculating the long term fatigue damage of the mooring line a joint distribution model was needed to reflect the wave related variables there are various models for constructing the bivariate joint distribution of the significant wave height h s and zero up crossing period t z such as copula theory and conditional joint models tao et al 2013 bitner gregerson 2015 vanem 2016 in this study a hybrid lognormal gumbel distribution was adopted to model the joint wave variables as follows 65 f h s t z h t f h s h f t z h s t h a marginal pdf for h s is fitted to a gumbel distribution as follows 66 f h s h 1 β exp h α β exp h α β additionally a conditional lognormal distribution for t z given h s with parameters that depend on h s is selected as follows 67 f t z h s t h 1 2 π σ h t exp 1 2 σ 2 h ln t μ h 2 where 68 μ h e ln t z a 1 exp b 1 h c 1 and 69 σ h s t d ln t z a 2 exp b 2 h c 2 thus the joint distribution for the wave related random variables i e f h s t z h t was constructed via a combination of the marginal distribution for h s and a conditional distribution for t z and the distribution parameters α β a i b i and c i for i 1 and 2 can be fitted using the available wave data the fitting results for h s are shown in fig 9 and the location and shape parameters were estimated using moment method as 2 4138 and 1 4114 respectively fig 10 shows the fitting curves of the conditional pdf of t z for different h s values the lognormal distribution provides a good fit to all the sets of wave data the distribution parameters a 1 a 2 b 1 b 2 c 1 and c 2 are estimated as 0 5212 0 03683 0 3333 1 184 2 3180 and 0 1442 respectively 5 3 floating system dynamic response analysis the overall model of the semi submersible platform and the mooring system was established in the hydrodynamic analysis software ansys aqwa the hydrodynamic loads were calculated according to potential flow theory the three dimensional radiation and diffraction technique was adopted to solve the boundary integral equations in the software the frequency and time domain responses considering the lf and wf components under various sea states were simulated using the aqwa fer and aqwa drift modules respectively to provide an intuitive observation of the fatigue damage rule for an arbitrary sea state the additional wave conditions of the scatter diagram were simulated a total of n s 11 9 h s t z 99 simulations were performed in which the significant wave heights ranged from 0 5 to 10 5 m and the zero up crossing periods ranged from 5 5 to 13 5 s 5 3 1 frequency and time domain results for fatigue analysis the spectral density functions of the mooring line tensions were obtained using the aqwa fer module fig 11 illustrates the power spectrum densities of the wave elevation and the most loaded mooring line line 7 tension for a sea state of h s 6 5 m and t z 11 5 s as shown there were well separated wf and lf components approximately 0 07 and 0 37 rad s in the mooring line tension spectrum which were induced by the first and second order wave forces respectively both the wf and lf tensions significantly contributed to the fatigue damage of the mooring lines although individual components are assumed to be narrow banded the combined tension history indicates a wideband process gao and moan 2007 a correction technique is necessary for more accurate fatigue estimation based on the fda procedure ninety nine 3 h hydrodynamic simulations were performed to obtain the mooring line tension response with stable statistical properties the fatigue damage was evaluated accurately according to the total wf and lf time series of the mooring line tension where the mooring line tension amplitudes and their number of cycles were determined via rfc an actual mooring line tension history under the wave condition of h s 6 5 m and t z 11 5 s is presented in fig 12 the tension range from the produced tension process was evaluated and the pdf of the tension range distribution was fitted as shown in fig 13 the mooring line tension range did not follow the rayleigh distribution owing to the complex nonlinearity of mooring system and wave loading and the rayleigh assumption caused a large error for the fatigue damage assessment the three parameter weibull distribution fit the statistical data better than the rayleigh distribution and could be demonstrated for non gaussian fitting in fatigue analysis approximately the results indicate that the non gaussian of the mooring line tension response is feasible and that the correction for the narrowband assumption is significant the fatigue properties of mooring lines were calculated via the approaches described in sections 2 and 3 for common studless link moorings the material parameters k and m in the t n curve were assigned values of 316 and 3 respectively the rbs for this mooring line was taken as the minimum breaking strength of the chain the random variables involved in the probabilistic fatigue analysis based on miner s cumulative rule were the fatigue strength coefficient k numerical calculation error c and cumulative damage index at the fatigue failure stage δ f as defined in eq 37 brief descriptions of these variables are presented in table 4 the reliability indices of the most loaded mooring line calculated using the lognormal and weibull distribution format for various service years are presented in fig 14 as mentioned previously the simple summation of the individual narrowband spectra is inaccurate existing spectral correction models described in section 2 3 were employed for probabilistic fatigue analysis and compared with the time domain fatigue the results were too conservative as shown in fig 14 the large error generated by the spectral models makes it necessary to utilize the accurate surrogate models for fatigue reliability analysis fig 15 shows the fatigue damage results calculated using tda and fda procedures under various sea conditions there was a clear trend between the wave parameters and the target output which ensured that the surrogate models had a high prediction accuracy although this trend or rule could not be explicitly expressed 5 3 2 fatigue correction based on surrogate models in the development of the kriging model all combinations of regression models constant linear and quadratic and correlation functions gaussian exponential exponential linear spherical etc were investigated to obtain an optimal model with high accuracy the regression function did not affect the accuracy of the prediction thus f j x was taken as a constant the exponential correlation function was determined according to the training and test database because the prediction results with other functions were negative under small wave loading the fatigue damage surface obtained from the kriging model is shown in fig 16 the black dots represent the tda results the predicted time domain fatigue damage using kriging model was converted into a correction coefficient because the spectral analysis results were more convenient for probabilistic fatigue analysis to analyse the fatigue damage correction coefficient a parameter based on time and frequency domain results was defined 70 ρ d d t d f where d t represents the fatigue damage calculated using tda and d f represents the result of the simple summation approach based on the rayleigh assumption in the kriging model the correction coefficient can be obtained based on the predicted tda results 71 ρ d d k r i g d f in the ann model when a floating system is determined the fatigue damage has a strong correlation with the spectrum parameters 72 x ω l f ω w f v 0 l f v 0 w f ε l f ε w f γ y ρ d where ω lf and ω wf represent the peak frequencies corresponding to the lf and wf components respectively v 0 lf and v 0 wf represent the mean zero up crossing rates for the lf and wf components respectively ε is a bandwidth parameter and γ ω lf ω wf represents the power ratio these parameters are depicted in fig 3 and defined in section 2 2 y ρ d is the fatigue correction coefficient for bimodal mooring lines that cannot be accurately represented with explicit expressions the predicted tda fatigue damage can be determined as 73 d a n n y ρ d d f once the surrogate models are trained and validated it is used to describe the fatigue limit state function as the response surface can be defined by the surrogate models 74 z δ f k c m ω t d g δ f k c y ρ 0 it is necessary to normalise the training data in the ann model a common data normalisation function is 75 x x x min x max x min where x represents an input variable and x max and x min represent the maximum and minimum values of the input variable respectively the outputs estimated by the anns should be denormalised using a similar expression to evaluate the performance of the surrogate models several statistical errors are employed i e the mean absolute error mae mean absolute relative error mare and standard deviation sd which are defined as follows 76 m a e 1 n i 1 n x a c t u x p r e d i i 1 2 n 77 m a r e 1 n i 1 n x a c t u x p r e d x a c t u i 100 and 78 s d 1 n 1 i 1 n x a c t u x p r e d x a c t u i 2 where x actu and x pred represent actual values and predicted values obtained from the tda and the trained ann model respectively and n represents the number of validation data in this study a total of 199 datasets were divided into two parts 70 of the full database generated by tda and fda was employed for training and validation and 30 was reserved for testing the training process was terminated when the validation error stopped decreasing there were 7 neurons in the input layer 13 neurons in hidden layer and 1 neuron in output layer thus the c parameter of the network was given by a 13 7 matrix and the σ and w parameters were given by 13 1 matrices the test results are displayed in fig 17 in this section we also investigate the effect of activation function on prediction accuracy we applied a multiquadrics function to replace the gauss function in the ann model the trained ann model was used to approximate the limit state function of the mooring line fatigue analysis so that the number of tdas was reduced and the computational efficiency was significantly increased by using fda with a high accuracy the scatter diagrams of the actual and predicted correction factors using the kriging and ann models for the test data are also shown in fig 17 the statistical errors for both kriging and ann models with various activation functions are presented in table 5 the test results agreed well with the tda results as indicated by fig 19 1 1 as a reviewer pointed out the fig 19 was a mistake here the fig 19 should be replaced with fig 17 fig 19 first emerges in the paragraph in front of eq 82 so fig 19 should be placed after eq 82 and table 5 both the kriging model and ann model with a gauss function had a high prediction accuracy the results using a multiquadric activation function show worse than gauss function from the results we can see the surrogate models can be used for probabilistic fatigue analysis of complex and nonlinear mooring systems with high accuracy and efficiency the reliability indices of the most loaded mooring line obtained using tda and the surrogate models are depicted in fig 18 5 4 long term fatigue analysis the mooring system is subjected to cyclic internal tensions induced by external fluctuating wave loads during its service life the long term fatigue damage of the mooring line should represent contributions from all possible sea states it requires the long term probability distribution of wave variables and the short term fatigue damage for different environmental conditions the expected long term fatigue damage can then be obtained by summing the damages corresponding to the sea states as follows 79 d a l h s t z t l d a s h t f h s t z h t d h d t where d a l represents the long term fatigue damage t l represents the total service lifetime at sea in this study it can be expressed as t l t r 365 24 3 where t r represents the service life in years d a s h t represents the short term fatigue damage distribution in the wave condition characterised by significant wave heights h and zero up crossing periods t and f h s t z h t is the long term joint pdf of the wave conditions which is obtained from eq 65 according to observation wave data this straightforward calculation while difficult owing to the nonexplicit short term fatigue damage distribution can be performed using a discrete approach combined with monte carlo simulation as described by li and zhang 2020 80 d a l i 1 n s t l d a i s h i t i f h s t z h i t i where h i t i represents the discrete sample of the random wave variables that follow the specified joint distribution f h s t z h t which can be produced using a random number generation technique and n s represents the total number of generated random variables the random number generation technique used in this study was the inverse cumulative distribution function method this approach involved two steps a n s random samples u 1 u 2 which were uniformly distributed between 0 and 1 were produced via monte carlo simulation b then the random environmental variables were obtained using the inverse transformation method 81 f h s h u 1 f t z h s t h u 2 h f h s 1 u 1 t f t z h s 1 u 2 h the basic principle is that the cumulative distribution function for the random samples h t corresponds to the random samples u 1 u 2 with the established surrogate models the short term fatigue damage for structural system can be efficiently evaluated under any wave conditions and be employed to calculate the long term fatigue damage during service life the kriging model is adopted for mooring line lifetime fatigue damage assessment because the joint lognormal gumbel distribution can provide a perfect simulation of random wave conditions as the input the t r year accumulated fatigue damage for the most loaded line was predicted with different total numbers of environmental conditions n s as shown in fig 19 as expected the cumulative fatigue damage increased with the service life a linear function was used to fit the expected fatigue damage with t r the expected annual fatigue damage can be obtained from the slope of long term fatigue damage in fig 19 as 0 038 year the short term fatigue life can be evaluated by considering all discrete wave conditions in 1 year as 82 d a s i 1 74 γ i d i y e a r 0 032 y e a r where γ i is the annual frequency of wave condition i it is found that the annual fatigue damage obtained from short term analysis is lower than from long term analysis considering long term distribution of sea states 2 2 fig 19 should be placed here after eq 82 because fig 19 just mentioned in the paragraph in front of eq 82 the ann model has similar accuracy to the kriging model but it takes the response spectrum parameters as the inputs fda is significantly faster than tda however a large number of calculation conditions makes long term analysis cumbersome 6 conclusions the objective of this study was to investigate surrogate models for probabilistic fatigue analysis of bimodal mooring lines the time domain rfc method is considered to be the most reliable approach for calculating the fatigue damage however it is time consuming thus the convenient frequency domain fatigue damage based on the narrowband assumption was corrected by various wideband fatigue models the real correction factors from the tda to the fda for different sea states were investigated and ann and kriging models were established for probabilistic and long term fatigue analysis several wideband spectra correction techniques for rainflow damage estimation were reviewed and compared these models provide over conservative results in particular the weibull distribution formulae for the fatigue life is not recommended for the bimodal tension process in the present case we attempted to develop surrogate models capable of fatigue evaluation of mooring lines based on a finite database of rainflow damages in the ann model seven different bimodal spectra parameters are used as input variables and then the correction factors are generated by this model for the frequency domain approach to obtain accurate results the kriging model was also established to make time domain predictions by using wave parameters as independent variables the proposed surrogate models allow efficient prediction and their results are consistent with time domain results i e for rfc and miner s cumulative rule the time domain analysis needs expensive computational effort while the proposed surrogate models greatly improve the efficiency of fatigue analysis with high accuracy the low computational cost made the surrogate models a broad application prospect a fatigue limit state function was constructed based on the lognormal or weibull distribution assumption for random variables or the fatigue life the probability of failure of the most loaded line estimated via the surrogate models was compared those for spectral techniques and the api recommendation the surrogate models provided similar predictions to the tda whereas the other models provided conservative results thus the surrogate models provide efficient alternatives for probabilistic fatigue analysis however the accuracy of the surrogate models is affected by the selection or number of training data for different subjects such as risers or other components of floating structures credit authorship contribution statement yuliang zhao conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization sheng dong conceptualization methodology formal analysis resources writing original draft writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was supported by the national natural science foundation of china shandong joint fund u1706226 and the national natural science foundation of china 51779236 
21153,collisions at sea are frequently caused by human related factors such as manoeuvre timing mistakes risk assessment failures and deficiencies in strategies for collision avoidance these factors reveal the importance of the automation systems in providing safety of navigation thus a decision support system was developed in this study that can be a reference to the ship operators in the implementation of the collision avoidance action in case of an encounter situation involving risk of collision both qualitative and quantitative methods were conducted in the study in the qualitative research process the variable constraints in the mathematical model and the inputs of the scenarios implemented in experiments were determined based on the findings obtained from experts interviews in the quantitative research process the problem solution was reached with the developed algorithm colav ga which is formed based on the genetic algorithm and fuzzy logic the developed algorithm was validated in a virtual environment using a bridge simulator and in a real environment with an autonomous surface vehicle asv with satisfactory results the output of this research is expected to contribute to the safety of navigation the developed algorithm can be used as a collision avoidance sub module for autonomous ships and asv keywords genetic algorithm fuzzy logic collision avoidance ship 1 introduction in dynamic environments such as aviation and maritime transportation collision is one of the most important problems which brings negative impacts to human lives and the environment lazarowska 2015a s li et al 2019b 2019a in order to overcome such a problem it is necessary to place special emphasis on training and establish effective procedures however the most important factor in such a situation is the experience of the navigators who perform the precautionary action the navigators practically perform this action based on experience rather than the training they received and the procedures to be followed however even an experienced navigator can make a wrong assessment and cause an accident perera et al 2015 for this reason limiting subjective decisions taken by navigators in navigation and supporting them with a decision support system will undoubtedly reduce the risk of collision and contribute to increasing the safety of navigation perera et al 2011 tsou and hsueh 2010 navigation is a complex process as it requires continuous analysis and monitoring of large amounts of data increasing marine traffic especially makes navigation more difficult and complicated for navigators lazarowska 2012 navigation includes the interaction of factors such as environment ship and human dynamic and static data certain and uncertain information quantitative calculation and qualitative reasoning tsou and hsueh 2010 for this reason making a navigation assessment considering these factors is critical for the safety of navigation improper and inadequate assessment may lead to accidents so this assessment process should be supported lazarowska 2012 the collision avoidance action is a multi criteria problem while applying this action there should be a balance between the safety of navigation and navigation cost smierzchalski and michalewicz 1998 in other words the collision avoidance process should not only include collision risk assessment and avoidance action but also consider optimizing the amount of deviation distance from the original route su et al 2012 this research consists of two main parts qualitative and quantitative research process for the solution of the collision avoidance problem at sea as a result of the findings obtained using the interview method in the qualitative research process the inputs of the scenario tests and the variable constraints in the mathematical model created for problem solving were determined in the quantitative research process the designed algorithm structure was coded with c programming language on microsoft visual studio 2017 platform problem solution was reached with this algorithm called colav ga which is based on ga and fuzzy logic approaches the solutions generated by the algorithm were tested in a virtual environment with a bridge simulator transas ntpro 5000 in turkey and in a real environment with an autonomous surface vehicle asv in norway the remaining sections of the paper are organized as follows section 2 introduces the literature review and describes the originality of the research followed by section 3 which provides the methodology and the model explanation of the proposed method section 4 presents experimental test results and section 5 provides a discussion and a comparison with other models proposed by various authors followed by the conclusions including final evaluation of the results and recommendations for further studies in section 6 2 literature review and originality conditions such as manoeuvre timing errors collision risk assessment failures and deficiencies in strategies necessary for collision avoidance which are human based are the main indicators that cause collision tsou and hsueh 2010 automation and decision support systems become important in terms of eliminating or minimizing these human based errors from this point of view the psychological and physical burden on the navigator will decrease with the decision support system this will reduce the risk of collision and contribute to the safety of navigation on the other hand the system can be integrated as a collision avoidance sub module in autonomous ships and unmanned surface vehicles collison causes not only financial loss but also injuries and large environmental pollution therefore collision avoidance is one of the issues that have been discussed in recent years especially with the emerging concept of autonomous and unmanned ships tsou 2019 researchers have proposed various methods techniques and models with different approaches on ship encounter situations and collision avoidance route problem at sea which have become an important issue especially over the past decade it is possible to divide these studies into 4 groups according to approach types deterministic artificial intelligence ai hybrid systems and simulation fiskin et al 2018 reviewed these approaches in detail with a systematic approach deterministic methods always produce exact and identical results for every execution akkoyunlu and engin 2011 such methods follow a strict and precise execution process it is commonly stated that the most traditional and classical algorithms have a deterministic structure yang et al 2010 and nowadays they lose their effectiveness and have difficulty in explaining the complexity in real time decision making processes büyükyazıcı and taşar 2011 in related field deterministic approaches e g fiskin et al 2019 szlapczynski 2008 szlapczyński 2007 tam and bucknall 2010 yavin et al 1998 include certain analytical definitions to provide exact results related to navigation and route problem deterministic methods have an advantage over ai based methods because of providing exact results ai methods basically consist of fuzzy logic heuristic and meta heuristic algorithms artificial neural networks ann and similar methods the studies by grinyak and devyatisil nyi 2016 lee et al 2015 perera et al 2011 2010 su et al 2012 and li et al 2019 are some important studies based on fuzzy logic on the other hand as an example of the ai approach cheng et al 2007 hao et al 2007 kang et al 2018 lazarowska 2015b 2014 and tsou et al 2010 proposed heuristic and meta heuristic based methods and lisowski 2000 and simsir et al 2014 introduced ann based methods to solve the problem the most obvious difference between these types of algorithms from other approaches is that they can produce near optimal results in a short time for complex problems with their learning capacity and high computing ability since the 1970s researches have been basically carried out the application of standard heuristic and meta heuristic algorithms kaveh and ilchi ghazaan 2018 however thereafter hybrid algorithms emerged with an idea that the uniform algorithm is limited in problem solving and that combining it with another algorithm may be more effective and feasible especially in solving large scale real life problems blum and roli 2008 hybrid algorithms are algorithms created by combining at least two different algorithms to provide a more efficient execution process in related literature cheng and liu 2007 and perera et al 2015 conducted studies to solve the problem with a hybrid approach cheng and liu 2007 combined genetic algorithm and simulated annealing algorithm and perera et al 2015 combined fuzzy logic and ann to create hybrid models a simulation method is defined as combining methods and applications in order to imitate the behaviour of real systems using computers with the appropriate software in other words it is the process of designing and creating computer aided models for a better understanding of the behaviours shown by real systems that form under certain conditions kelton et al 2003 models created with the simulation technique may not always offer optimum results the performance of a system is measured by examining all the scenarios with different variables for this reason a simulation method is a tool that tries to optimize a system considering various scenarios rather than directly optimizing it esmer 2009 studies conducted by liu et al 2007 and johansen et al 2016 are based on the simulation method liu et al 2007 proposed a model based on multi agent simulation and johansen et al 2016 introduced an approach based on the predictive control model as a result this approach uses an ai method based on fuzzy logic and a meta heuristic algorithm with the applications and achievements below this research is thought to have an original contribution considering the related literature determination of the size of the ship safety domain of the own ship os with the fuzzy inference system fis created by considering factors determined as a result of expert interviews unlike similar studies in this approach in accordance with international regulations for preventing collisions at sea colreg rule 16 the position where the collision avoidance manoeuvre is to be applied is determined by the system user considering the distance of the target ship ts called as mx tots i e action range to the ts unlike similar studies in this approach in accordance with colreg rule 8 d manoeuvring to return the original route is made after the ts is considered as clear unlike similar studies in this approach offering the option of producing results according to the optimization goal shortest path or mx tots of the system user determining the constraints used in the algorithm structure and sample scenario inputs as a result of the findings obtained from expert interviews conducted within the scope of the qualitative research process controlling the validity and reliability and testing the applicability of the system with scenario tests were performed in a virtual environment with a bridge simulator and in a real environment with asv capability to produce results with course alteration or speed change manoeuvre in case of a risk of collision between two ships at sea the give way ship needs to alter her course or speed to eliminate the risk as per colreg in such cases the automatic radar plotting aid arpa radar is a critical device to get assistance arpa reports whether there is a potential collision risk between the two ships but does not provide any optimal routes to avoid collision collision avoidance action performed by the navigator subjectively based on experience competence and arpa supported will be carried out through a decision support system ultimately this study is considered to be important due to the following possible circumstances the system contributes to the reduction of human errors arising from subjective judgments the system also contributes to the enhancement of navigational safety by reducing the psychological and physical burden on the decision maker in decision making the system can be a reference in decision making for vessel traffic services vts operators and navigators the system aims to provide the optimal collision avoidance route it hereby will be possible to save fuel and time the system will contribute to increasing safe ship control automation the system can be integrated as a collision avoidance sub module in autonomous ships and unmanned surface vehicles 3 methodology the method of the study basically consists of two main parts in the qualitative research process a total of 10 interviews were organized with ship masters and officers to determine the variable constraints in the mathematical model the factors affecting the ship domain and the inputs of the scenario tests in the quantitative research process the results obtained with the solution algorithm colav ga created based on ga and fuzzy logic approaches were tested in a virtual environment with the bridge simulator and in a real environment with asv 3 1 conceptual framework of the study the conceptual framework of the study mainly consists of a total of 3 steps as shown in fig 1 at the first step a preliminary survey was conducted by taking the expert judgments and recommendations regarding the research subject and the related literature were examined in the second step exploratory researches were conducted in this research process the findings arising from the qualitative research methods using the interview technique were analysed in order to determine the variable constraints factors affecting ship safety domain and inputs of scenario tests then by creating a ga and fuzzy logic based algorithm structure the initial results regarding the solution of the problem were obtained at the last stage the developed system was tested in a virtual and real environment for validity and reliability 3 2 problem definition the most important cause of marine accidents is the human factor bowo and furusho 2019 operators tend to make mistakes by nature even if they have higher education and experience intelligent decision support and guidance systems therefore have an important place in terms of navigational safety and useful to guide the operators lee et al 2019 perera et al 2015 encounter situations at sea occur in two sub environmental situations coastal areas and open sea although there are many external systems vts separation line etc that provide support in coastal areas there is no navigation system at open sea to support navigation in order to avoid collision in encounter situations involving collision risk at open sea navigators decide the action they take by getting support from the bridge devices arpa radar which is the most commonly utilized bridge device in encounter situations is a critical device in this regard although the trial manoeuvre feature gives an idea about the movement of the ships in time it cannot automatically calculate the optimal collision avoidance action to be performed for this reason this study focuses on the optimal collision avoidance route planning at open sea or non congested waters in case of a collision risk at sea actions to be taken by the ship officers are regulated by the colreg rules the ship which is defined as a give way vessel according to the rules must alter her course speed or both in order to eliminate collision risk colreg classifies the ships as a give way vessel and a stand on vessel in case of encounter and constitutes regulations for one to one encounter situations involving only two vessels for this reason problems arise in complex traffic conditions in such cases in practice the navigators communicate with each other and they try to conduct their manoeuvring decision considering colreg rules this study therefore focused on one to one encounter situation as in many similar studies brcko and švetak 2013 candeloro et al 2017 fiskin et al 2019 hongdan et al 2014 2015a 2015b kang et al 2018 mostefa 2014 naeem et al 2012 perera et al 2015 szlapczynski 2015 tsou et al 2010 wei et al 2015 xu 2014 xu et al 2014 it is possible to divide the collision avoidance manoeuvre into four phases according to the different purposes it has li and ma 2016 tsou et al 2010 i initial navigation phase at this phase the closest point of approach cpa of the nearby obstacles e g other ships and buoys are tracked in case of an obstacle that violates the ship domain i e minimum cpa the necessary alarms are kept in order to give an alert ii warning phase in the event that an obstacle being tracked violates the ship domain if the obstacle is a ship the type of encounter and the roles of the ships are determined according to the colreg if the os is the give way vessel the vessel obliges to make the necessary manoeuvre to eliminate the risk of collision ts as a stand on vessel on the other hand is responsible for maintaining the current motion course and speed iii collision avoidance manoeuvre phase collision avoidance manoeuvre is performed in this phase the manoeuvre to be performed should be neither too small for the ts to perceive nor large to get too far from the original route in this phase the aim is to eliminate the risk of collision by preventing the violation of ship domain in principle iv returning to the original route after making sure that the collision avoidance manoeuvre is successfully completed and the target is clear returning to the original route is performed 3 3 mathematical model and algorithm structure 3 3 1 fitness function model this study theoretically aims to obtain the minimum collision avoidance route length more specifically it is aimed to minimize the total length of route leg formed from the position wp 1 where the ship starts the manoeuvre to avoid collision to the position wp 2 where it manoeuvres to return to the original route and the route leg formed from the position wp 2 where it manoeuvres to return to the original route to the position wp 3 where it enters the original route the fitness function determined for this purpose is defined by equation 1 1 f x m i n i 1 n 1 m i where f x denotes the fitness function n is the number of the wp m i is the distance passed in the i leg of the collision avoidance route as shown in fig 2 the collision avoidance route consists of a total of 3 wp i e two route legs therefore since n 3 the fitness function can be expressed in another way by equation 2 2 f x min m w p 1 w p 2 m w p 2 w p 3 where m w p 1 w p 2 is the distance passed after the collision avoidance manoeuvre the length of the first leg of the collision avoidance route m w p 2 w p 3 is the distance passed after returning manoeuvre to the original route the length of the second leg of the collision avoidance route representing with equation 3 and equation 4 respectively 3 m w p 1 w p 2 t w p 1 w p 2 v o s t 4 m w p 2 w p 3 t w p 2 w p 3 v o s t where t w p 1 w p 2 is the proceeding time in the first leg of the collision avoidance route t w p 2 w p 3 is the proceeding time in the second leg of the collision avoidance route v o s is the speed over ground of the os equations 5 8 represent the motion model of the os and ts using the kinematic model the distance between the ships d o s t s t is calculated with equation 9 using the 2 dimensional euclidean distance formula 5 x o s t x o s t 1 s i n φ o s v o s t 6 y o s t y o s t 1 c o s φ o s v o s t 7 x t s t x t s t 1 s i n φ t s v t s t 8 y t s t y t s t 1 c o s φ t s v t s t 9 d o s t s t x o s t x t s t 2 y o s t y t s t 2 where x o s t is the x axis value of the position of the os at time t y o s t is the y axis value of the position of the os at time t x t s t is the x axis value of the position of the ts at time t y t s t is the y axis value of the position of the ts at time t φ o s is the course of the os φ t s is the course of the ts v t s is the speed of the ts the relative velocity between ships v o s t s is calculated by equation 10 using the cosine theorem 10 v o s t s v o s 2 v t s 2 2 v o s v t s c o s φ o s t s where φ o s t s is the difference between courses of the os and ts and defined by equation 11 11 φ o s t s φ o s φ t s 3 3 2 decision variables as illustrated in fig 2 the algorithm structure contains a total of 4 decision variables for the course change manoeuvre these decision variables are as follows t w p 0 w p 1 proceeding time in minutes from the initial position wp 0 to position of course change to avoid collision wp 1 δ ψ 1 course change to be applied at wp 1 to avoid collision t w p 1 w p 2 proceeding time in minutes from wp 1 to position of course change to return the original route wp 2 δ ψ 2 course change to be applied at wp 2 to return the original route 3 3 3 constraints in optimization problems the best result of the fitness function is searched in the range of constraints determined for decision variables in this study the constraints determined for the decision variables are defined by equation 12 16 respectively 12 10 t w p 0 w p 1 63 t w p 0 w p 1 t c p a 13 5 δ ψ 1 63 14 5 t w p 1 w p 2 31 15 63 δ ψ 2 10 16 c p a min d o s t s t s d f u z z y t w p 0 w p 1 10 63 in minute unlike existing models in the literature the value of this variable can be obtained according to two different approaches 1 making a course change to avoid collision before the distance to the ts set by the system user mx tots and 2 by ga without determining any distance to the ts these approaches which are provided as two options have advantages and disadvantages comparing them within each other the interviewed experts noted that the former one is more suitable for real life practices the experts also added that they make the manoeuvre at a certain distance mostly 8 10 nm to the ts when this distance called mx tots is provided to the system ga is not looking for a value for this variable since it is obvious at which position the os turns this provides an advantage in two perspectives being more suitable for real life practices and decreasing execution time to reach the optimal solution this approach also meets the give way vessel shall so far as possible take early and substantial action to keep well clear rule in colreg rule 16 in the second approach ga provides this variable in this approach ships can be very close to each other at the manoeuvring time since the distance to which the manoeuvre is to be applied has not been determined however it is considered to be applicable for low speeds or ships with high manoeuvrability the advantage of this approach is that the optimal collision avoidance route length is shorter than generated by the other approach the interviewed experts stated that the proceeding time between 10 min and 1 h until the collision avoidance manoeuvre is sufficient considering this the variable is represented by a 6 bit in the binary number system 1111112 6310 this variable has to be less than time to the closest point of approach tcpa this variable can be obtained according to two different approaches by mx tots or by ga which are described in detail above when this variable is determined by ga it has been realised that there may be more convergence between ships than it should be interviewed experts stated that a collision avoidance manoeuvre should be performed at a specified distance from the target ship for this reason the mx tots option that allows the user to determine this distance has been introduced determining this parameter with ga ensures that the total length of the collision avoidance trajectory is shorter but more convergence between ships involves risks in terms of navigational safety although determination with mx tots increases the total length of the collision avoidance trajectory it is more applicable in practice δ ψ 1 5 63 in degree course alteration manoeuvre should be made in accordance with colreg rule 16 which states that it will be so obvious that another vessel can easily perceive according to the findings obtained as a result of the question addressed to the experts in order to reveal how this rule is applied in practice the constraint of this variable was determined between 5 to 60 similar to the previous one the constraint was determined to be 63 instead of 60 as it is represented by a 6 bit the larger this variable the harder the ship has to turn as the angle of manoeuvre increases the loss of speed in turns increases and the distance to be covered by the ship can be different from the planned accordingly therefore the lower this value the closer the ship can sail to her planned trajectory t w p 1 w p 2 5 31 in minute colreg rule 8 d dictates that action taken to avoid a collision with another vessel shall be such as to result in passing at a safe distance in accordance with this rule the os should wait for the return to the original route until the ts becomes clear as a result of expert interviews it was revealed that when the ts is boarded it is accepted as clear the constraint of this variable was also determined between 5 min to half an hour this constraint of this variable is represented by a 5 bit since the maximum value of a 5 bit is 31 in the binary number system the constraint interval is set to 31 instead of 30 111112 3110 δ ψ 2 10 63 in degree this constraint of this variable is represented by a 6 bit between 10 to 60 similar to the constraint of the second variable where minus denotes turning to the reverse side i e to the port side the value produced here is added to the δ ψ 1 resulting in a course manoeuvre degree for returning to the original route finally the last constraint is the distance between the ships when they are closest min d o s t s t called cpa which should be greater than or equal to the ship domain s d f u z z y of the ship in order to obtain the minimum collision avoidance route length it must be equal 3 3 4 assumptions some assumptions were considered to simplify the complexity of the problem before the algorithm structure is formed these assumptions are as follows i collision risk assessment is based on whether the ship domain is violated ii as a stand on vessel the ts keeps its motion by maintaining speed and course iii navigational data of ships speed route etc is obtained from any system in practice this data is obtained through devices such as automatic identification system ais arpa electronic chart display and information system ecdis iv the ships are considered to comply with the colreg rules and act according to the rules v ship movements are calculated with a kinematic model approach vi loss of time and speed while manoeuvring is ignored vii the ships sail in calm water condition but not in the sea state 3 3 5 genetic algorithm structure in this study the binary coding system 0 1 was used to encode the chromosomes in this system the length of chromosomes is equal to the total number of genes of each decision variable each chromosome represents a possible solution according to the fitness function with this coding there are a total of 223 8388608 chromosomes and possible solutions represented by each chromosome considering the studies in the literature the number of chromosomes in the population was determined to be 50 the gene arrays of the chromosomes were randomly sorted and the number of individuals was kept constant in each generation after calculating the fitness value of each chromosome in the population the roulette wheel and elitism method were used for parent selection after the selected individuals were randomly matched a single point crossover operator was applied for the next generation production with the possibility of 0 7 crossover rate then a bitwise mutation operator was applied to the individuals in the new generation with the probability of 0 03 mutation rate the algorithm was terminated by determining the maximum number of iterations as 100 iterations ga parameters the algorithm flowchart and the pseudo code used in this study are shown in table 1 fig 3 and table a 2 respectively 3 3 6 collision risk assessment collision risk assessment is a fundamental concept in sea navigation there are a total of 3 main methods to conduct a collision risk assessment in practice methods based on traffic flow theory ship safety domain and methods based on distance to the closest point of approach dcpa and tcpa xu and wang 2014 zhang and meng 2020 in this study collision risk assessment was carried out with the ship safety domain the ship safety domain hereinafter called as ship domain an area that surrounds the ship keeps the ship away from other surface objects i e other ships objects etc goodwin 1975 each ship on navigation sets a ship domain violation of this area by any stationary or moving object is considered the risk of collision other objects must be kept out from this area to eliminate the risk of collision there are many different approaches applied in determining the ship domain in the literature these methods are classified as follows empirical knowledge based analytical and probabilistic fiskin et al 2020 szlapczynski and szlapczynska 2017 in these methods the shape of the ship domain is focused differently the circle is a shape of ship domain that researchers often work on davis et al 1980 jingsong et al 1993 zhu et al 2001 moreover elliptical coldwell 1983 hexagon lisowski et al 2000 irregular shape pietrzykowski 2008 quadrangle dinh and im 2016 and polygonal fiskin et al 2020 are other proposed ship domain types in this study a circle shaped ship domain developed with a knowledge based approach was used to assess the collision risk the circle shaped ship domain is the most widely used form of ship domain in practice the ship domain is typically determined by masters based on their experience and expertise in addition companies also determine the minimum required distance between a target and a ship this minimum distance is included in the company navigation policy fuzzy inference system fis was used in this study for determining the ship domain size considering that it would be important to determine which factor is important to the size of the ship domain which is determined generally based on experience mamdani type fis method fuzzy set and fuzzy rule base were created by using multiple input single output miso if then rules in creating a fuzzy ship domain sd fuzzy triangular and trapezoid membership functions for fuzzification the sum method as the aggregation method and the centroid method as the defuzzification method were employed the system created with matlab r2019b fuzzy logic tool was defined over 8 linguistic input variables and 1 linguistic output variable input variables were determined as a result of expert interviews as follows navigator experience k weather condition s ship size b ship speed h manoeuvrability m traffic state t day night g visibility v the output variable was determined as the radius of the ship domain sd fuzzy this can be expressed briefly as sd fuzzy k s b h m t g v with an eight dimensional n 8 input vector a total of 231 fuzzy rules were created with all input variables the model structure of the fis including fuzzy numbers type of membership functions and universal size defined for each linguistic variable is similar to the model proposed by yardımcı et al 2019 and fiskin 2019 the structure of the fis is illustrated in fig 4 the order of importance was made for input variables based on expert interviews according to this order of importance weight coefficients are defined for fuzzy rules in which the variables take place the weight coefficients of fuzzy rules determine their effects on the fuzzy system the coefficients of fuzzy rules are determined as follows the ratio of the number of statements taken by the experts for each input variable in the total number of statements was determined ship size b has the highest rate with 25 93 category a each of the variables ship speed h weather condition s and traffic state t have a ratio of 14 82 category b each of the variables manoeuvrability m navigator experience k day night g and visibility v have a ratio of 7 41 category c since each fuzzy rule includes two input variables the calculation of the weight coefficients of the variables according to the categories is shown in table 2 4 experimental test results experimental tests were applied to test the validity reliability and applicability of the developed system in this context experimental tests were carried out in a virtual environment with the bridge simulator in maritime faculty dokuz eylül university deu i̇zmir turkey and in a real environment in trondheim fjord trondheim norway with asv in cooperation with norwegian university of science and technology centre for autonomous marine operations and systems ntnu amos and maritime robotics as mr in these experiments various scenarios were tested considering different ship encounter types ship encounter types are defined in colreg rules as head on crossing and overtaking head on indicates that two ships are approaching in reciprocal or nearly reciprocal directions and mainly refer to rule 14 crossing is that two ships are on cross direction potentially involving the collision risk and mainly refer to rule 15 overtaking states that one ship is approaching with another ship at an angle larger than 22 5 abaft her beam and mainly refer to rule 13 in this paper only a head on situation experiment is presented for each experiment to demonstrate the system execution because of the limitation of the paper size results of other encounter types of both virtual and real environment experiments are shown in table a 1 4 1 virtual environment experiment bridge simulator test scenario inputs for this experiment were set as sd fuzzy 2 nm v o s 14 knots φ o s 000 v t s 15 knots φ t s 184 r b t s 002 d o s t s 31 nm and mx tots 8 nm as shown in table 3 in this scenario the cpa was calculated by the algorithm as 0 04 nm tcpa 64 2ı dcpa 14 98 nm the value of the cpa must be greater than or equal to the ship domain in order to eliminate the risk of collision and ensure a safe passage c p a s d f u z z y in this case since the ship domain size is determined as 2 nm it is necessary to make a collision avoidance manoeuvre assuming that there is a risk of collision between the ships on the other hand the cpa value was also calculated as 0 04 nm by the bridge simulator this shows that the developed algorithm calculates the cpa correctly the algorithm was run 100 times with a computer with intel core i7 7700 2 80 ghz processor 16 gb ram 64 bit operating system and reached the solution in periods ranging from 5 99 s to 6 73 s mean 6 35 s as shown in fig 5 this demonstrates that the algorithm is applicable to real time applications the program produced identical results in every execution it was revealed that ga parameters do not affect the convergence to the best solution because the identical solutions were returned in every execution however it was found out that the parameters only affect the speed of the algorithm to reach a solution which is illustrated in fig 5 as a result different parameter settings can affect the computational time of the algorithm rather than the solution the solutions produced by the algorithm for head on situation scenario are shown in table 4 the values in the top row in the table are optimal values the solution provided by the algorithm says that after proceeding 48 ı turn 32 to starboard then proceed on the new route for 16 8 ı and turn 62 to the opposite side i e to port then proceed on the new route for 17 8 ı and turn 30 to starboard when the os moves according to this command the length of the collision avoidance route is 8 07 nm at this stage a bridge simulator scenario test with the same scenario input was conducted to validate the solution provided by the algorithm the scenario design of the bridge simulator was formed according to the sample scenario inputs in this scenario the os and ts were chosen as a bulk carrier with a displacement of 44081 t and a container ship with a displacement of 32025 t respectively as illustrated in fig 6 fig 7 shows the positions of the ships on the chart at the beginning of the scenario according to the scenario inputs the ts was positioned as relative bearing 002 and the distance is 31 nm fig 8 and fig 9 show the stepwise comparative images of the bridge simulator and the developed program based on the developed algorithm on the left side of the figures shows the chart screen of the bridge simulator in the middle of the figures shows the radar screen of the bridge simulator and on the right side of the figures shows the ship movement simulation based on the solution provided by the developed algorithm in the chart screen red lines denote trajectories of the ships in the program screen purple line and green lines denote the optimal route of the os and other potential routes that are not optimal respectively moreover the green circle on the radar screen and the red circle on the program screen are the ship domain of the os as shown in fig 8 the os proceeded for 48ı t w p 0 w p 1 according to the optimal result provided by the algorithm and reached the position w p 1 where it would make the collision avoidance manoeuvre δ ψ 1 in this position the os turned 32 δ ψ 1 to starboard 8 nm away from the ts mx tots to make the collision avoidance manoeuvre after the manoeuvre the time t w p 1 w p 2 which is the time to proceed on the first leg of the collision avoidance route has started as shown in fig 9 the os reached the position w p 2 by proceeding 16 8ı t w p 1 w p 2 where it would turn to her original route in this position it turned 62 δ ψ 2 to the opposite side i e port to turn back to the original route then the os proceeded 17 8ı t w p 2 w p 3 and turned 30 δ ψ 3 to starboard as suggested by the algorithm finally it entered her original route and finalized the collision avoidance action on the control console of the bridge simulator there is a feature that records and shows the trajectory of the ships this control screen allows the distance covered by the ships to be measured fig 10 shows the trajectory tracks of the ships that appeared in this scenario the first leg of the collision avoidance route was measured as 3 9 nm and the second leg as 4 17 nm and it turned out to be 8 07 nm in total this value is equal to the route length calculated by the algorithm this demonstrates that the algorithm calculates correctly and properly in order to accurately measure the performance of the developed algorithm taking into account the loss of speed occurring in the turns the simulator was paused when the ship reached the turning positions and was placed on the starting point of the next leg fig 11 shows the instantaneous distance graph between ships depending on time it is revealed that the distance between the ships when they are closest to each other i e cpa is equal to the ship domain and the distance between the ships are increasing gradually after being closest finally fig 12 shows the values of the linguistic input variables defined for the fis created for the sd fuzzy calculation and the value of the output variable obtained as a result of these input variables each row in the figure represents one fuzzy rule as shown in the figure the values of linguistic input variables were defined as k s b h m t g v 6 2 225 14 0 8 0 2 0 1 8 fis calculated the ship domain radius as 2 nm considering these inputs this value was defined for the collision avoidance system as the ship domain of the os in a virtual environment experiment 4 2 real environment experiment autonomous surface vehicle asv test simulation applications are useful tools for evaluating the performance and accuracy of algorithms but they cannot replace real scale tests experiments on the virtual environment can include simplification and facilitation which may prevent evaluating the algorithm performance accurately for this reason in addition to the results obtained with simulation real environment tests are also important in evaluating algorithm performance hagen 2017 considering this fact real environment experiments were also conducted in this study in this section details of the real environment experiments applied with the asv together with ntnu amos and mr cooperation are provided in detail in real environment experiments an asv named telemetron owned by mr was used as the os and munkholmen ii a tugboat owned by the trondheim port authority was used as the ts during the experiments the asv connects the on board system simulator obs of mr whose interface is illustrated in fig 14 fig 15 and fig 17 to manage and track the process ais data from both asv and munkholmen ii is recorded simultaneously for every second by the system the system also provides the recorded data as a log file which includes latitude longitude cog sog rate of turn yaw and etc to allow the analysis of the experiment results the asv was utilized by many other studies kufoalor et al 2020 tengesdal et al 2020 as well these studies also demonstrated that the asv is consistent and reliable for use in experiments experimental tests were carried out on the east side of munkholmen island in a 2 nm diameter area taking into account the shallow regions and traffic lines as shown in fig 13 this area is located between 63 26 28 7 n 10 23 35 8 e 63 28 9 1 n 10 23 41 6 e coordinates at trondheim bay trondheim fjord norway it is among the test areas determined by the international network for autonomous ships inas for autonomous ship researches the experimental test process applied with asv consists of two steps simulation test and field test details about these steps are shown in table 5 before the field tests to be applied with the asv simulation tests were performed in the obs developed by mr in order to verify the scenarios by seeing the movements of the ships in advance the simulation tests revealed that scenarios are applicable for the field tests only in the crossing scenario the os and ts were seen to be too close to posing a collision risk so the ship domain and mx tots inputs were revised to be applied in the field test after the simulation test field tests were applied in a real environment with telemetron and virtual ts at the last step real environmental experiments were completed by applying field tests with telemetron and munkholmen ii scenario inputs for this experiment were set as sd fuzzy 0 15 nm v o s 7 knots φ o s 000 v t s 6 knots φ t s 180 r b t s 000 d o s t s 1 5 nm and mx tots 0 5 nm as shown in table 6 the movement of the ships leads to the risk of collision cpa 0 sd fuzzy as a result of these inputs the optimal result provided by the algorithm was as shown in table 7 according to this output the asv made the collision avoidance navigation the trajectory of the asv to avoid collision in the head on situation scenario is presented step by step in figs 14 fig 15 fig 17 for simulation test field test with virtual ts and field test with real ts respectively figs 16 and 18 also show the expected and measured course and speed values of the asv during the collision avoidance navigation applied in the field test with virtual ts and field test with real ts respectively the green line in the figures represents the trajectory of the asv as shown in fig 14 in the simulation test asv performed the collision avoidance navigation as expected in accordance with the output provided by the algorithm in this scenario there were no instantaneous changes and deviations in the speed and course of asv as there was no wind and current effect this contributed to measure the optimal collision avoidance route length exactly as the algorithm output only minor speed changes were observed in the turns but no effect on the optimal collision avoidance route length as shown in fig 15 in the field test with virtual ts the asv performed the collision avoidance navigation in accordance with the output provided by the algorithm in this test due to the effect of wind with 1 55 m s instantaneous small deviations were observed in the speed and course of the asv as shown in fig 16 despite the wind effect the asv generally made its navigation in the expected speed and course the length of the trajectory 0 59 nm that occurred at the end of the collision avoidance navigation was exactly the same as the algorithm output as shown in fig 17 in the field test with real ts the asv performed the collision avoidance navigation in accordance with the output provided by the algorithm in this test due to the effect of wind with 4 18 m s instantaneous small deviations were observed in the speed and course of asv as shown in fig 18 despite the wind effect the asv generally made its navigation safely at the expected speed and course although there was a higher wind effect compared to the previous day the length of the trajectory 0 51 nm that occurred at the end of the collision avoidance navigation was measured close to the algorithm output 5 discussion in this part of the study we aimed to discuss the presented method with the result of the other methods in the related field the presented method and determined current methods were taken into consideration for comparison various encounter types i e head on and crossing were established to demonstrate the performance of the presented method the methods introduced by tsou et al 2010 lazarowska 2014 and kang et al 2018 which are ai based methods and lazarowska 2016 and fiskin et al 2019 which are deterministic based methods were chosen for comparison with different parameter settings shown in table 8 the first column in the table provides the case number the second column shows the encounter type of the cases followed by the third column and fourth column which present the navigational data inputs belong to the os and ts respectively table 9 and table 10 on the other hand show the numerical results of the comparison scenarios and an in depth comparison of the methods used for discussion respectively 5 1 case 1 comparison with a pso based method a comparison of the trajectories of the oss generated by a particle swarm optimization pso based method introduced by kang et al 2018 and colav ga is illustrated in fig 19 a numerical results produced by both methods are compared in table 9 it is clear that the solution by the colav ga notably outperformed the pso based algorithm the difference in the length of the trajectories was measured as 2 26 nm in terms of the computational time on the other hand colav ga reached the solution in a much shorter time the trajectory produced by the pso based method however comprised more acute angles it should be mentioned that this can be an advantage in terms of navigational comfort and not overloading the engine of ships this situation may not be however very important for future concepts e g unmanned ships autonomous ships it should be also stated how we determined the size of the ship domain for this case in order to ensure an accurate comparison in the pso based method to assess the collision risk tam and bucknall 2010b s ship domain concept which mainly varies according to ship speed was used the ship domain determined in the pso based method is semi elliptical and its semi minor and semi major axes were assumed to be 0 55 nm for 30 knots for a head on encounter situation 5 2 case 2 comparison with an aco based method and deterministic method called tba in this case the results achieved by the colav ga were discussed with the solutions returned by an ant colony optimization aco based method proposed by lazarowska 2014 and the deterministic method called tba introduced by lazarowska 2016 the comparison of the trajectories obtained by these three methods for an example of an encounter situation entitled case 2 in table 8 is illustrated in fig 19 b the collision risk assessment in the aco based method and the tba method was made with a hexagonal ship domain with the longest diagonal line of 1 25 nm we determined the size of the ship domain for this exemplary situation considering this value fig 19 b shows that the trajectory marked by the colav ga is shorter than the trajectories determined by the other two methods the computational time is in favour of the colav ga compared to the aco based method but we cannot say the same when compared to that of the tba method with the advantage of being a deterministic method tba returned the solution in a much shorter time as shown in table 9 5 3 case 3 comparison with a ga based method case 3 provides a comparison between the solutions determined by the colav ga and a ga based method proposed by tsou et al 2010 numerical results produced by both methods are compared in table 9 it is obvious that the result by the colav ga outperformed the ga based method which is illustrated in fig 19 c the difference of the length of the trajectories was calculated as 1 02 nm in terms of the computational time on the other hand colav ga reached the solution in a much shorter time 5 4 case 4 comparison with a deterministic method called wbda a comparison of the trajectories determined by the colav ga and web based deterministic algorithm wbda developed by fiskin et al 2019 is shown in fig 19 d the trajectory provided by colav ga consists of two course alterations the first one of 028 and the second one of 058 while the solution obtained by the wbda also comprises of two course alterations with values of 027 8 and 056 8 respectively the trajectories provided by both algorithms are almost identical with a minor difference of 0 08 nm in favour of the colav ga in terms of the computational time however with the advantage of being a deterministic method wbda reached the solution in a much shorter time as demonstrated in table 9 in this exemplary case we should provide the return distance rd which is the final point distance to return the os to its original route in the wbda method the rd is given for the os the wbda method was also developed by some of the authors in this study firstly this case was executed in the colav ga then we calculated the rd distance using the sine theorem and used it as input for wbda to ensure an accurate comparison to sum up the colav ga outperformed in terms of computational time compared to ai based methods but we cannot say the same against deterministic methods the comparison study demonstrated that deterministic methods return solutions in a much shorter time however it should be emphasized that the computational time of colav ga which is about 2 7 s is also at an acceptable level for real time applications 6 conclusion in this study in encounter situations at sea that is considered to be a risk of collision collision avoidance route planning and optimization was performed for give way vessels for this purpose ga a meta heuristic algorithm and fuzzy logic based solution algorithm called colav ga was developed in conclusion the benefits and contributions of this research can be listed as follows the algorithm meets colreg requirements the algorithm produces identical solutions in every run execution time of the algorithm is very short this allows it to be used in real time applications variable constraints and scenario inputs were determined as a result of interviews with experts algorithm was verified in a real environment with asv and in a virtual environment with a bridge simulator fuzzy logic approach was used to calculate the ship domain thus determining the size of the ship domain is removed from subjectivity by linking to rules and objective principles taking into account the colreg rule 16 determining the point where the collision avoidance manoeuvre will be applied determined by the system user considering the distance of the ts thus the os is enabled to manoeuvre at a safe distance to the ts considering the colreg rule 8 d manoeuvring to return to the original route is made after the ts is considered as clear the algorithm can produce solutions according to the navigator s optimization goal shortest path or mxtots the algorithm has the capability to produce optimal results with course alteration and speed change manoeuvre options there are some limitations to the implementation of the research in this research the interview method was used as a data collection method in the qualitative research process since it is not possible to reach the whole target population in the interview method the research is carried out through the sample population the sample size consists of a total of 10 people including 1 pilot interview in this study the sample size considered sufficient for interviews that key data are intended to be obtained was reached however the current sample size can be considered as one of the limitations of qualitative research in the interview method certain answers cannot be obtained from some participants in line with the objectives of the research this situation emerges as another limitation of the research another limitation is the motion of the ts changes in motion strategy of the ts are not taken into account if the course or speed change of the ts is detected a reactive approach with recalculation is made according to new data in order to further develop the system weights of fuzzy rules can be defined according to the order of importance of ship domain input variables utilizing multi criteria decision making methods ahp anp etc for further studies moreover for future studies a comparative study can be conducted to examine the effects of different ship domain types on the collision avoidance route funding this study was granted by the scientific research coordination unit of dokuz eylül university project number 2017 kb sos 005 the scientific and technological research council of turkey tubitak project number 1059b141800295 and the research council of norway through centre for autonomous marine operations and systems amos grant 223254 credit authorship contribution statement remzi fiskin conceptualization methodology writing original draft preparation software validation writing review editing oguz atik methodology data curation supervision writing review editing hakki kisi methodology literature review visualization investigation writing review editing efendi nasibov methodology writing original draft preparation software tor arne johansen methodology software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful to maritime robotics as for involving them in the real environment experiments leading to substantial results we would like to thank stephanie kemna arild hepso and caio swan de freitas from maritime robotics and trondheim port authority for their efforts to make the sea trials with the telemetron possible and special thanks to d kwame minde kufoalor from ntnu for his useful comments and efforts on this study appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108502 appendix a other situation results and pseudo code of the algorithm table a 1 other encounter types results of both virtual and real environment experiments table a 1 virtual environment experiment other encounter types results inputs sd nm v knot φ o r b ts o d os ts nm mx tots nm crossing os 2 14 000 7 ts 15 240 030 20 overtaking os 2 16 000 5 ts 7 000 000 12 outputs t w p 0 w p 1 m δ ψ 1 o t w p 1 w p 2 m δ ψ 2 o t w p 2 w p 3 m δ ψ 3 o m w p 1 w p 2 m w p 2 w p 3 nm crossing 31 2 54 10 2 84 17 47 30 6 6 overtaking 46 8 14 38 4 44 18 58 30 15 19 real environment experiment other encounter types results inputs sd nm v knot φ o r b ts o d os ts nm mx tots nm initial position crossing os 0 2 7 090 0 5 63 27 30 n 010 22 10 2 e ts 6 000 040 1 63 26 46 8 n 010 24 3 69 e overtaking os 0 2 9 000 0 3 63 26 46 8 n 010 24 3 69 e ts 4 000 000 0 5 63 27 16 2 n 010 24 3 69 e outputs t w p 0 w p 1 m δ ψ 1 o t w p 1 w p 2 m δ ψ 2 o t w p 2 w p 3 m δ ψ 3 o m w p 1 w p 2 m w p 2 w p 3 nm crossing 3 6 58 2 4 88 4 07 30 0 75 overtaking 3 32 3 6 54 5 09 22 1 3 table a 2 pseudo code of the algorithm table a 2 function ga 1 begin 2 function create initial population 34 set population size 5 for each individual 6789 assign gene randomly check for any overlap if yes 101112 back to step 7 13 else 141516 assign gene 17 1819 return population 20 function calculate fitness 2122 get population list 23 for each individual 242526 calculate f x m i n i 1 n 1 m i 2728 return fitness value 29 best solutiono min calculate fitness o 30 determine the best individual elitism 31 iteration 0 32 repeat 3334 function roulette wheel selection 3536 get population list 37 for each fitness calculated individual 383940 determine selection probabilities p i f x i i 1 n p f x i 4142 spin the wheel and select individuals return population 43 function crossover 4445 get the list of individuals in the match pool 46 match individuals randomly 47 determine crossover rate 48 for each parent 49 if rand 0 1 c r 5051 determine crossover point randomly 5253 change genes between pairs at crossover point 5455 return child individuals 56 fonksiyon mutation 5758 get the list of child individuals 59 determine mutation rate 60 for each individual 61 if rand 0 1 m r 626364 specify the gene to be mutated randomly and reverse it 65 return new population 66 67 68 calculate fitness 69 best solutiont min calculate fitness t 70 if best solutiont best solutiono 717273 best solutiono best solutiont 74 iteration 75 if iteration iteration number 767778 end 79 else 808182 back to step 32 83 end 
21153,collisions at sea are frequently caused by human related factors such as manoeuvre timing mistakes risk assessment failures and deficiencies in strategies for collision avoidance these factors reveal the importance of the automation systems in providing safety of navigation thus a decision support system was developed in this study that can be a reference to the ship operators in the implementation of the collision avoidance action in case of an encounter situation involving risk of collision both qualitative and quantitative methods were conducted in the study in the qualitative research process the variable constraints in the mathematical model and the inputs of the scenarios implemented in experiments were determined based on the findings obtained from experts interviews in the quantitative research process the problem solution was reached with the developed algorithm colav ga which is formed based on the genetic algorithm and fuzzy logic the developed algorithm was validated in a virtual environment using a bridge simulator and in a real environment with an autonomous surface vehicle asv with satisfactory results the output of this research is expected to contribute to the safety of navigation the developed algorithm can be used as a collision avoidance sub module for autonomous ships and asv keywords genetic algorithm fuzzy logic collision avoidance ship 1 introduction in dynamic environments such as aviation and maritime transportation collision is one of the most important problems which brings negative impacts to human lives and the environment lazarowska 2015a s li et al 2019b 2019a in order to overcome such a problem it is necessary to place special emphasis on training and establish effective procedures however the most important factor in such a situation is the experience of the navigators who perform the precautionary action the navigators practically perform this action based on experience rather than the training they received and the procedures to be followed however even an experienced navigator can make a wrong assessment and cause an accident perera et al 2015 for this reason limiting subjective decisions taken by navigators in navigation and supporting them with a decision support system will undoubtedly reduce the risk of collision and contribute to increasing the safety of navigation perera et al 2011 tsou and hsueh 2010 navigation is a complex process as it requires continuous analysis and monitoring of large amounts of data increasing marine traffic especially makes navigation more difficult and complicated for navigators lazarowska 2012 navigation includes the interaction of factors such as environment ship and human dynamic and static data certain and uncertain information quantitative calculation and qualitative reasoning tsou and hsueh 2010 for this reason making a navigation assessment considering these factors is critical for the safety of navigation improper and inadequate assessment may lead to accidents so this assessment process should be supported lazarowska 2012 the collision avoidance action is a multi criteria problem while applying this action there should be a balance between the safety of navigation and navigation cost smierzchalski and michalewicz 1998 in other words the collision avoidance process should not only include collision risk assessment and avoidance action but also consider optimizing the amount of deviation distance from the original route su et al 2012 this research consists of two main parts qualitative and quantitative research process for the solution of the collision avoidance problem at sea as a result of the findings obtained using the interview method in the qualitative research process the inputs of the scenario tests and the variable constraints in the mathematical model created for problem solving were determined in the quantitative research process the designed algorithm structure was coded with c programming language on microsoft visual studio 2017 platform problem solution was reached with this algorithm called colav ga which is based on ga and fuzzy logic approaches the solutions generated by the algorithm were tested in a virtual environment with a bridge simulator transas ntpro 5000 in turkey and in a real environment with an autonomous surface vehicle asv in norway the remaining sections of the paper are organized as follows section 2 introduces the literature review and describes the originality of the research followed by section 3 which provides the methodology and the model explanation of the proposed method section 4 presents experimental test results and section 5 provides a discussion and a comparison with other models proposed by various authors followed by the conclusions including final evaluation of the results and recommendations for further studies in section 6 2 literature review and originality conditions such as manoeuvre timing errors collision risk assessment failures and deficiencies in strategies necessary for collision avoidance which are human based are the main indicators that cause collision tsou and hsueh 2010 automation and decision support systems become important in terms of eliminating or minimizing these human based errors from this point of view the psychological and physical burden on the navigator will decrease with the decision support system this will reduce the risk of collision and contribute to the safety of navigation on the other hand the system can be integrated as a collision avoidance sub module in autonomous ships and unmanned surface vehicles collison causes not only financial loss but also injuries and large environmental pollution therefore collision avoidance is one of the issues that have been discussed in recent years especially with the emerging concept of autonomous and unmanned ships tsou 2019 researchers have proposed various methods techniques and models with different approaches on ship encounter situations and collision avoidance route problem at sea which have become an important issue especially over the past decade it is possible to divide these studies into 4 groups according to approach types deterministic artificial intelligence ai hybrid systems and simulation fiskin et al 2018 reviewed these approaches in detail with a systematic approach deterministic methods always produce exact and identical results for every execution akkoyunlu and engin 2011 such methods follow a strict and precise execution process it is commonly stated that the most traditional and classical algorithms have a deterministic structure yang et al 2010 and nowadays they lose their effectiveness and have difficulty in explaining the complexity in real time decision making processes büyükyazıcı and taşar 2011 in related field deterministic approaches e g fiskin et al 2019 szlapczynski 2008 szlapczyński 2007 tam and bucknall 2010 yavin et al 1998 include certain analytical definitions to provide exact results related to navigation and route problem deterministic methods have an advantage over ai based methods because of providing exact results ai methods basically consist of fuzzy logic heuristic and meta heuristic algorithms artificial neural networks ann and similar methods the studies by grinyak and devyatisil nyi 2016 lee et al 2015 perera et al 2011 2010 su et al 2012 and li et al 2019 are some important studies based on fuzzy logic on the other hand as an example of the ai approach cheng et al 2007 hao et al 2007 kang et al 2018 lazarowska 2015b 2014 and tsou et al 2010 proposed heuristic and meta heuristic based methods and lisowski 2000 and simsir et al 2014 introduced ann based methods to solve the problem the most obvious difference between these types of algorithms from other approaches is that they can produce near optimal results in a short time for complex problems with their learning capacity and high computing ability since the 1970s researches have been basically carried out the application of standard heuristic and meta heuristic algorithms kaveh and ilchi ghazaan 2018 however thereafter hybrid algorithms emerged with an idea that the uniform algorithm is limited in problem solving and that combining it with another algorithm may be more effective and feasible especially in solving large scale real life problems blum and roli 2008 hybrid algorithms are algorithms created by combining at least two different algorithms to provide a more efficient execution process in related literature cheng and liu 2007 and perera et al 2015 conducted studies to solve the problem with a hybrid approach cheng and liu 2007 combined genetic algorithm and simulated annealing algorithm and perera et al 2015 combined fuzzy logic and ann to create hybrid models a simulation method is defined as combining methods and applications in order to imitate the behaviour of real systems using computers with the appropriate software in other words it is the process of designing and creating computer aided models for a better understanding of the behaviours shown by real systems that form under certain conditions kelton et al 2003 models created with the simulation technique may not always offer optimum results the performance of a system is measured by examining all the scenarios with different variables for this reason a simulation method is a tool that tries to optimize a system considering various scenarios rather than directly optimizing it esmer 2009 studies conducted by liu et al 2007 and johansen et al 2016 are based on the simulation method liu et al 2007 proposed a model based on multi agent simulation and johansen et al 2016 introduced an approach based on the predictive control model as a result this approach uses an ai method based on fuzzy logic and a meta heuristic algorithm with the applications and achievements below this research is thought to have an original contribution considering the related literature determination of the size of the ship safety domain of the own ship os with the fuzzy inference system fis created by considering factors determined as a result of expert interviews unlike similar studies in this approach in accordance with international regulations for preventing collisions at sea colreg rule 16 the position where the collision avoidance manoeuvre is to be applied is determined by the system user considering the distance of the target ship ts called as mx tots i e action range to the ts unlike similar studies in this approach in accordance with colreg rule 8 d manoeuvring to return the original route is made after the ts is considered as clear unlike similar studies in this approach offering the option of producing results according to the optimization goal shortest path or mx tots of the system user determining the constraints used in the algorithm structure and sample scenario inputs as a result of the findings obtained from expert interviews conducted within the scope of the qualitative research process controlling the validity and reliability and testing the applicability of the system with scenario tests were performed in a virtual environment with a bridge simulator and in a real environment with asv capability to produce results with course alteration or speed change manoeuvre in case of a risk of collision between two ships at sea the give way ship needs to alter her course or speed to eliminate the risk as per colreg in such cases the automatic radar plotting aid arpa radar is a critical device to get assistance arpa reports whether there is a potential collision risk between the two ships but does not provide any optimal routes to avoid collision collision avoidance action performed by the navigator subjectively based on experience competence and arpa supported will be carried out through a decision support system ultimately this study is considered to be important due to the following possible circumstances the system contributes to the reduction of human errors arising from subjective judgments the system also contributes to the enhancement of navigational safety by reducing the psychological and physical burden on the decision maker in decision making the system can be a reference in decision making for vessel traffic services vts operators and navigators the system aims to provide the optimal collision avoidance route it hereby will be possible to save fuel and time the system will contribute to increasing safe ship control automation the system can be integrated as a collision avoidance sub module in autonomous ships and unmanned surface vehicles 3 methodology the method of the study basically consists of two main parts in the qualitative research process a total of 10 interviews were organized with ship masters and officers to determine the variable constraints in the mathematical model the factors affecting the ship domain and the inputs of the scenario tests in the quantitative research process the results obtained with the solution algorithm colav ga created based on ga and fuzzy logic approaches were tested in a virtual environment with the bridge simulator and in a real environment with asv 3 1 conceptual framework of the study the conceptual framework of the study mainly consists of a total of 3 steps as shown in fig 1 at the first step a preliminary survey was conducted by taking the expert judgments and recommendations regarding the research subject and the related literature were examined in the second step exploratory researches were conducted in this research process the findings arising from the qualitative research methods using the interview technique were analysed in order to determine the variable constraints factors affecting ship safety domain and inputs of scenario tests then by creating a ga and fuzzy logic based algorithm structure the initial results regarding the solution of the problem were obtained at the last stage the developed system was tested in a virtual and real environment for validity and reliability 3 2 problem definition the most important cause of marine accidents is the human factor bowo and furusho 2019 operators tend to make mistakes by nature even if they have higher education and experience intelligent decision support and guidance systems therefore have an important place in terms of navigational safety and useful to guide the operators lee et al 2019 perera et al 2015 encounter situations at sea occur in two sub environmental situations coastal areas and open sea although there are many external systems vts separation line etc that provide support in coastal areas there is no navigation system at open sea to support navigation in order to avoid collision in encounter situations involving collision risk at open sea navigators decide the action they take by getting support from the bridge devices arpa radar which is the most commonly utilized bridge device in encounter situations is a critical device in this regard although the trial manoeuvre feature gives an idea about the movement of the ships in time it cannot automatically calculate the optimal collision avoidance action to be performed for this reason this study focuses on the optimal collision avoidance route planning at open sea or non congested waters in case of a collision risk at sea actions to be taken by the ship officers are regulated by the colreg rules the ship which is defined as a give way vessel according to the rules must alter her course speed or both in order to eliminate collision risk colreg classifies the ships as a give way vessel and a stand on vessel in case of encounter and constitutes regulations for one to one encounter situations involving only two vessels for this reason problems arise in complex traffic conditions in such cases in practice the navigators communicate with each other and they try to conduct their manoeuvring decision considering colreg rules this study therefore focused on one to one encounter situation as in many similar studies brcko and švetak 2013 candeloro et al 2017 fiskin et al 2019 hongdan et al 2014 2015a 2015b kang et al 2018 mostefa 2014 naeem et al 2012 perera et al 2015 szlapczynski 2015 tsou et al 2010 wei et al 2015 xu 2014 xu et al 2014 it is possible to divide the collision avoidance manoeuvre into four phases according to the different purposes it has li and ma 2016 tsou et al 2010 i initial navigation phase at this phase the closest point of approach cpa of the nearby obstacles e g other ships and buoys are tracked in case of an obstacle that violates the ship domain i e minimum cpa the necessary alarms are kept in order to give an alert ii warning phase in the event that an obstacle being tracked violates the ship domain if the obstacle is a ship the type of encounter and the roles of the ships are determined according to the colreg if the os is the give way vessel the vessel obliges to make the necessary manoeuvre to eliminate the risk of collision ts as a stand on vessel on the other hand is responsible for maintaining the current motion course and speed iii collision avoidance manoeuvre phase collision avoidance manoeuvre is performed in this phase the manoeuvre to be performed should be neither too small for the ts to perceive nor large to get too far from the original route in this phase the aim is to eliminate the risk of collision by preventing the violation of ship domain in principle iv returning to the original route after making sure that the collision avoidance manoeuvre is successfully completed and the target is clear returning to the original route is performed 3 3 mathematical model and algorithm structure 3 3 1 fitness function model this study theoretically aims to obtain the minimum collision avoidance route length more specifically it is aimed to minimize the total length of route leg formed from the position wp 1 where the ship starts the manoeuvre to avoid collision to the position wp 2 where it manoeuvres to return to the original route and the route leg formed from the position wp 2 where it manoeuvres to return to the original route to the position wp 3 where it enters the original route the fitness function determined for this purpose is defined by equation 1 1 f x m i n i 1 n 1 m i where f x denotes the fitness function n is the number of the wp m i is the distance passed in the i leg of the collision avoidance route as shown in fig 2 the collision avoidance route consists of a total of 3 wp i e two route legs therefore since n 3 the fitness function can be expressed in another way by equation 2 2 f x min m w p 1 w p 2 m w p 2 w p 3 where m w p 1 w p 2 is the distance passed after the collision avoidance manoeuvre the length of the first leg of the collision avoidance route m w p 2 w p 3 is the distance passed after returning manoeuvre to the original route the length of the second leg of the collision avoidance route representing with equation 3 and equation 4 respectively 3 m w p 1 w p 2 t w p 1 w p 2 v o s t 4 m w p 2 w p 3 t w p 2 w p 3 v o s t where t w p 1 w p 2 is the proceeding time in the first leg of the collision avoidance route t w p 2 w p 3 is the proceeding time in the second leg of the collision avoidance route v o s is the speed over ground of the os equations 5 8 represent the motion model of the os and ts using the kinematic model the distance between the ships d o s t s t is calculated with equation 9 using the 2 dimensional euclidean distance formula 5 x o s t x o s t 1 s i n φ o s v o s t 6 y o s t y o s t 1 c o s φ o s v o s t 7 x t s t x t s t 1 s i n φ t s v t s t 8 y t s t y t s t 1 c o s φ t s v t s t 9 d o s t s t x o s t x t s t 2 y o s t y t s t 2 where x o s t is the x axis value of the position of the os at time t y o s t is the y axis value of the position of the os at time t x t s t is the x axis value of the position of the ts at time t y t s t is the y axis value of the position of the ts at time t φ o s is the course of the os φ t s is the course of the ts v t s is the speed of the ts the relative velocity between ships v o s t s is calculated by equation 10 using the cosine theorem 10 v o s t s v o s 2 v t s 2 2 v o s v t s c o s φ o s t s where φ o s t s is the difference between courses of the os and ts and defined by equation 11 11 φ o s t s φ o s φ t s 3 3 2 decision variables as illustrated in fig 2 the algorithm structure contains a total of 4 decision variables for the course change manoeuvre these decision variables are as follows t w p 0 w p 1 proceeding time in minutes from the initial position wp 0 to position of course change to avoid collision wp 1 δ ψ 1 course change to be applied at wp 1 to avoid collision t w p 1 w p 2 proceeding time in minutes from wp 1 to position of course change to return the original route wp 2 δ ψ 2 course change to be applied at wp 2 to return the original route 3 3 3 constraints in optimization problems the best result of the fitness function is searched in the range of constraints determined for decision variables in this study the constraints determined for the decision variables are defined by equation 12 16 respectively 12 10 t w p 0 w p 1 63 t w p 0 w p 1 t c p a 13 5 δ ψ 1 63 14 5 t w p 1 w p 2 31 15 63 δ ψ 2 10 16 c p a min d o s t s t s d f u z z y t w p 0 w p 1 10 63 in minute unlike existing models in the literature the value of this variable can be obtained according to two different approaches 1 making a course change to avoid collision before the distance to the ts set by the system user mx tots and 2 by ga without determining any distance to the ts these approaches which are provided as two options have advantages and disadvantages comparing them within each other the interviewed experts noted that the former one is more suitable for real life practices the experts also added that they make the manoeuvre at a certain distance mostly 8 10 nm to the ts when this distance called mx tots is provided to the system ga is not looking for a value for this variable since it is obvious at which position the os turns this provides an advantage in two perspectives being more suitable for real life practices and decreasing execution time to reach the optimal solution this approach also meets the give way vessel shall so far as possible take early and substantial action to keep well clear rule in colreg rule 16 in the second approach ga provides this variable in this approach ships can be very close to each other at the manoeuvring time since the distance to which the manoeuvre is to be applied has not been determined however it is considered to be applicable for low speeds or ships with high manoeuvrability the advantage of this approach is that the optimal collision avoidance route length is shorter than generated by the other approach the interviewed experts stated that the proceeding time between 10 min and 1 h until the collision avoidance manoeuvre is sufficient considering this the variable is represented by a 6 bit in the binary number system 1111112 6310 this variable has to be less than time to the closest point of approach tcpa this variable can be obtained according to two different approaches by mx tots or by ga which are described in detail above when this variable is determined by ga it has been realised that there may be more convergence between ships than it should be interviewed experts stated that a collision avoidance manoeuvre should be performed at a specified distance from the target ship for this reason the mx tots option that allows the user to determine this distance has been introduced determining this parameter with ga ensures that the total length of the collision avoidance trajectory is shorter but more convergence between ships involves risks in terms of navigational safety although determination with mx tots increases the total length of the collision avoidance trajectory it is more applicable in practice δ ψ 1 5 63 in degree course alteration manoeuvre should be made in accordance with colreg rule 16 which states that it will be so obvious that another vessel can easily perceive according to the findings obtained as a result of the question addressed to the experts in order to reveal how this rule is applied in practice the constraint of this variable was determined between 5 to 60 similar to the previous one the constraint was determined to be 63 instead of 60 as it is represented by a 6 bit the larger this variable the harder the ship has to turn as the angle of manoeuvre increases the loss of speed in turns increases and the distance to be covered by the ship can be different from the planned accordingly therefore the lower this value the closer the ship can sail to her planned trajectory t w p 1 w p 2 5 31 in minute colreg rule 8 d dictates that action taken to avoid a collision with another vessel shall be such as to result in passing at a safe distance in accordance with this rule the os should wait for the return to the original route until the ts becomes clear as a result of expert interviews it was revealed that when the ts is boarded it is accepted as clear the constraint of this variable was also determined between 5 min to half an hour this constraint of this variable is represented by a 5 bit since the maximum value of a 5 bit is 31 in the binary number system the constraint interval is set to 31 instead of 30 111112 3110 δ ψ 2 10 63 in degree this constraint of this variable is represented by a 6 bit between 10 to 60 similar to the constraint of the second variable where minus denotes turning to the reverse side i e to the port side the value produced here is added to the δ ψ 1 resulting in a course manoeuvre degree for returning to the original route finally the last constraint is the distance between the ships when they are closest min d o s t s t called cpa which should be greater than or equal to the ship domain s d f u z z y of the ship in order to obtain the minimum collision avoidance route length it must be equal 3 3 4 assumptions some assumptions were considered to simplify the complexity of the problem before the algorithm structure is formed these assumptions are as follows i collision risk assessment is based on whether the ship domain is violated ii as a stand on vessel the ts keeps its motion by maintaining speed and course iii navigational data of ships speed route etc is obtained from any system in practice this data is obtained through devices such as automatic identification system ais arpa electronic chart display and information system ecdis iv the ships are considered to comply with the colreg rules and act according to the rules v ship movements are calculated with a kinematic model approach vi loss of time and speed while manoeuvring is ignored vii the ships sail in calm water condition but not in the sea state 3 3 5 genetic algorithm structure in this study the binary coding system 0 1 was used to encode the chromosomes in this system the length of chromosomes is equal to the total number of genes of each decision variable each chromosome represents a possible solution according to the fitness function with this coding there are a total of 223 8388608 chromosomes and possible solutions represented by each chromosome considering the studies in the literature the number of chromosomes in the population was determined to be 50 the gene arrays of the chromosomes were randomly sorted and the number of individuals was kept constant in each generation after calculating the fitness value of each chromosome in the population the roulette wheel and elitism method were used for parent selection after the selected individuals were randomly matched a single point crossover operator was applied for the next generation production with the possibility of 0 7 crossover rate then a bitwise mutation operator was applied to the individuals in the new generation with the probability of 0 03 mutation rate the algorithm was terminated by determining the maximum number of iterations as 100 iterations ga parameters the algorithm flowchart and the pseudo code used in this study are shown in table 1 fig 3 and table a 2 respectively 3 3 6 collision risk assessment collision risk assessment is a fundamental concept in sea navigation there are a total of 3 main methods to conduct a collision risk assessment in practice methods based on traffic flow theory ship safety domain and methods based on distance to the closest point of approach dcpa and tcpa xu and wang 2014 zhang and meng 2020 in this study collision risk assessment was carried out with the ship safety domain the ship safety domain hereinafter called as ship domain an area that surrounds the ship keeps the ship away from other surface objects i e other ships objects etc goodwin 1975 each ship on navigation sets a ship domain violation of this area by any stationary or moving object is considered the risk of collision other objects must be kept out from this area to eliminate the risk of collision there are many different approaches applied in determining the ship domain in the literature these methods are classified as follows empirical knowledge based analytical and probabilistic fiskin et al 2020 szlapczynski and szlapczynska 2017 in these methods the shape of the ship domain is focused differently the circle is a shape of ship domain that researchers often work on davis et al 1980 jingsong et al 1993 zhu et al 2001 moreover elliptical coldwell 1983 hexagon lisowski et al 2000 irregular shape pietrzykowski 2008 quadrangle dinh and im 2016 and polygonal fiskin et al 2020 are other proposed ship domain types in this study a circle shaped ship domain developed with a knowledge based approach was used to assess the collision risk the circle shaped ship domain is the most widely used form of ship domain in practice the ship domain is typically determined by masters based on their experience and expertise in addition companies also determine the minimum required distance between a target and a ship this minimum distance is included in the company navigation policy fuzzy inference system fis was used in this study for determining the ship domain size considering that it would be important to determine which factor is important to the size of the ship domain which is determined generally based on experience mamdani type fis method fuzzy set and fuzzy rule base were created by using multiple input single output miso if then rules in creating a fuzzy ship domain sd fuzzy triangular and trapezoid membership functions for fuzzification the sum method as the aggregation method and the centroid method as the defuzzification method were employed the system created with matlab r2019b fuzzy logic tool was defined over 8 linguistic input variables and 1 linguistic output variable input variables were determined as a result of expert interviews as follows navigator experience k weather condition s ship size b ship speed h manoeuvrability m traffic state t day night g visibility v the output variable was determined as the radius of the ship domain sd fuzzy this can be expressed briefly as sd fuzzy k s b h m t g v with an eight dimensional n 8 input vector a total of 231 fuzzy rules were created with all input variables the model structure of the fis including fuzzy numbers type of membership functions and universal size defined for each linguistic variable is similar to the model proposed by yardımcı et al 2019 and fiskin 2019 the structure of the fis is illustrated in fig 4 the order of importance was made for input variables based on expert interviews according to this order of importance weight coefficients are defined for fuzzy rules in which the variables take place the weight coefficients of fuzzy rules determine their effects on the fuzzy system the coefficients of fuzzy rules are determined as follows the ratio of the number of statements taken by the experts for each input variable in the total number of statements was determined ship size b has the highest rate with 25 93 category a each of the variables ship speed h weather condition s and traffic state t have a ratio of 14 82 category b each of the variables manoeuvrability m navigator experience k day night g and visibility v have a ratio of 7 41 category c since each fuzzy rule includes two input variables the calculation of the weight coefficients of the variables according to the categories is shown in table 2 4 experimental test results experimental tests were applied to test the validity reliability and applicability of the developed system in this context experimental tests were carried out in a virtual environment with the bridge simulator in maritime faculty dokuz eylül university deu i̇zmir turkey and in a real environment in trondheim fjord trondheim norway with asv in cooperation with norwegian university of science and technology centre for autonomous marine operations and systems ntnu amos and maritime robotics as mr in these experiments various scenarios were tested considering different ship encounter types ship encounter types are defined in colreg rules as head on crossing and overtaking head on indicates that two ships are approaching in reciprocal or nearly reciprocal directions and mainly refer to rule 14 crossing is that two ships are on cross direction potentially involving the collision risk and mainly refer to rule 15 overtaking states that one ship is approaching with another ship at an angle larger than 22 5 abaft her beam and mainly refer to rule 13 in this paper only a head on situation experiment is presented for each experiment to demonstrate the system execution because of the limitation of the paper size results of other encounter types of both virtual and real environment experiments are shown in table a 1 4 1 virtual environment experiment bridge simulator test scenario inputs for this experiment were set as sd fuzzy 2 nm v o s 14 knots φ o s 000 v t s 15 knots φ t s 184 r b t s 002 d o s t s 31 nm and mx tots 8 nm as shown in table 3 in this scenario the cpa was calculated by the algorithm as 0 04 nm tcpa 64 2ı dcpa 14 98 nm the value of the cpa must be greater than or equal to the ship domain in order to eliminate the risk of collision and ensure a safe passage c p a s d f u z z y in this case since the ship domain size is determined as 2 nm it is necessary to make a collision avoidance manoeuvre assuming that there is a risk of collision between the ships on the other hand the cpa value was also calculated as 0 04 nm by the bridge simulator this shows that the developed algorithm calculates the cpa correctly the algorithm was run 100 times with a computer with intel core i7 7700 2 80 ghz processor 16 gb ram 64 bit operating system and reached the solution in periods ranging from 5 99 s to 6 73 s mean 6 35 s as shown in fig 5 this demonstrates that the algorithm is applicable to real time applications the program produced identical results in every execution it was revealed that ga parameters do not affect the convergence to the best solution because the identical solutions were returned in every execution however it was found out that the parameters only affect the speed of the algorithm to reach a solution which is illustrated in fig 5 as a result different parameter settings can affect the computational time of the algorithm rather than the solution the solutions produced by the algorithm for head on situation scenario are shown in table 4 the values in the top row in the table are optimal values the solution provided by the algorithm says that after proceeding 48 ı turn 32 to starboard then proceed on the new route for 16 8 ı and turn 62 to the opposite side i e to port then proceed on the new route for 17 8 ı and turn 30 to starboard when the os moves according to this command the length of the collision avoidance route is 8 07 nm at this stage a bridge simulator scenario test with the same scenario input was conducted to validate the solution provided by the algorithm the scenario design of the bridge simulator was formed according to the sample scenario inputs in this scenario the os and ts were chosen as a bulk carrier with a displacement of 44081 t and a container ship with a displacement of 32025 t respectively as illustrated in fig 6 fig 7 shows the positions of the ships on the chart at the beginning of the scenario according to the scenario inputs the ts was positioned as relative bearing 002 and the distance is 31 nm fig 8 and fig 9 show the stepwise comparative images of the bridge simulator and the developed program based on the developed algorithm on the left side of the figures shows the chart screen of the bridge simulator in the middle of the figures shows the radar screen of the bridge simulator and on the right side of the figures shows the ship movement simulation based on the solution provided by the developed algorithm in the chart screen red lines denote trajectories of the ships in the program screen purple line and green lines denote the optimal route of the os and other potential routes that are not optimal respectively moreover the green circle on the radar screen and the red circle on the program screen are the ship domain of the os as shown in fig 8 the os proceeded for 48ı t w p 0 w p 1 according to the optimal result provided by the algorithm and reached the position w p 1 where it would make the collision avoidance manoeuvre δ ψ 1 in this position the os turned 32 δ ψ 1 to starboard 8 nm away from the ts mx tots to make the collision avoidance manoeuvre after the manoeuvre the time t w p 1 w p 2 which is the time to proceed on the first leg of the collision avoidance route has started as shown in fig 9 the os reached the position w p 2 by proceeding 16 8ı t w p 1 w p 2 where it would turn to her original route in this position it turned 62 δ ψ 2 to the opposite side i e port to turn back to the original route then the os proceeded 17 8ı t w p 2 w p 3 and turned 30 δ ψ 3 to starboard as suggested by the algorithm finally it entered her original route and finalized the collision avoidance action on the control console of the bridge simulator there is a feature that records and shows the trajectory of the ships this control screen allows the distance covered by the ships to be measured fig 10 shows the trajectory tracks of the ships that appeared in this scenario the first leg of the collision avoidance route was measured as 3 9 nm and the second leg as 4 17 nm and it turned out to be 8 07 nm in total this value is equal to the route length calculated by the algorithm this demonstrates that the algorithm calculates correctly and properly in order to accurately measure the performance of the developed algorithm taking into account the loss of speed occurring in the turns the simulator was paused when the ship reached the turning positions and was placed on the starting point of the next leg fig 11 shows the instantaneous distance graph between ships depending on time it is revealed that the distance between the ships when they are closest to each other i e cpa is equal to the ship domain and the distance between the ships are increasing gradually after being closest finally fig 12 shows the values of the linguistic input variables defined for the fis created for the sd fuzzy calculation and the value of the output variable obtained as a result of these input variables each row in the figure represents one fuzzy rule as shown in the figure the values of linguistic input variables were defined as k s b h m t g v 6 2 225 14 0 8 0 2 0 1 8 fis calculated the ship domain radius as 2 nm considering these inputs this value was defined for the collision avoidance system as the ship domain of the os in a virtual environment experiment 4 2 real environment experiment autonomous surface vehicle asv test simulation applications are useful tools for evaluating the performance and accuracy of algorithms but they cannot replace real scale tests experiments on the virtual environment can include simplification and facilitation which may prevent evaluating the algorithm performance accurately for this reason in addition to the results obtained with simulation real environment tests are also important in evaluating algorithm performance hagen 2017 considering this fact real environment experiments were also conducted in this study in this section details of the real environment experiments applied with the asv together with ntnu amos and mr cooperation are provided in detail in real environment experiments an asv named telemetron owned by mr was used as the os and munkholmen ii a tugboat owned by the trondheim port authority was used as the ts during the experiments the asv connects the on board system simulator obs of mr whose interface is illustrated in fig 14 fig 15 and fig 17 to manage and track the process ais data from both asv and munkholmen ii is recorded simultaneously for every second by the system the system also provides the recorded data as a log file which includes latitude longitude cog sog rate of turn yaw and etc to allow the analysis of the experiment results the asv was utilized by many other studies kufoalor et al 2020 tengesdal et al 2020 as well these studies also demonstrated that the asv is consistent and reliable for use in experiments experimental tests were carried out on the east side of munkholmen island in a 2 nm diameter area taking into account the shallow regions and traffic lines as shown in fig 13 this area is located between 63 26 28 7 n 10 23 35 8 e 63 28 9 1 n 10 23 41 6 e coordinates at trondheim bay trondheim fjord norway it is among the test areas determined by the international network for autonomous ships inas for autonomous ship researches the experimental test process applied with asv consists of two steps simulation test and field test details about these steps are shown in table 5 before the field tests to be applied with the asv simulation tests were performed in the obs developed by mr in order to verify the scenarios by seeing the movements of the ships in advance the simulation tests revealed that scenarios are applicable for the field tests only in the crossing scenario the os and ts were seen to be too close to posing a collision risk so the ship domain and mx tots inputs were revised to be applied in the field test after the simulation test field tests were applied in a real environment with telemetron and virtual ts at the last step real environmental experiments were completed by applying field tests with telemetron and munkholmen ii scenario inputs for this experiment were set as sd fuzzy 0 15 nm v o s 7 knots φ o s 000 v t s 6 knots φ t s 180 r b t s 000 d o s t s 1 5 nm and mx tots 0 5 nm as shown in table 6 the movement of the ships leads to the risk of collision cpa 0 sd fuzzy as a result of these inputs the optimal result provided by the algorithm was as shown in table 7 according to this output the asv made the collision avoidance navigation the trajectory of the asv to avoid collision in the head on situation scenario is presented step by step in figs 14 fig 15 fig 17 for simulation test field test with virtual ts and field test with real ts respectively figs 16 and 18 also show the expected and measured course and speed values of the asv during the collision avoidance navigation applied in the field test with virtual ts and field test with real ts respectively the green line in the figures represents the trajectory of the asv as shown in fig 14 in the simulation test asv performed the collision avoidance navigation as expected in accordance with the output provided by the algorithm in this scenario there were no instantaneous changes and deviations in the speed and course of asv as there was no wind and current effect this contributed to measure the optimal collision avoidance route length exactly as the algorithm output only minor speed changes were observed in the turns but no effect on the optimal collision avoidance route length as shown in fig 15 in the field test with virtual ts the asv performed the collision avoidance navigation in accordance with the output provided by the algorithm in this test due to the effect of wind with 1 55 m s instantaneous small deviations were observed in the speed and course of the asv as shown in fig 16 despite the wind effect the asv generally made its navigation in the expected speed and course the length of the trajectory 0 59 nm that occurred at the end of the collision avoidance navigation was exactly the same as the algorithm output as shown in fig 17 in the field test with real ts the asv performed the collision avoidance navigation in accordance with the output provided by the algorithm in this test due to the effect of wind with 4 18 m s instantaneous small deviations were observed in the speed and course of asv as shown in fig 18 despite the wind effect the asv generally made its navigation safely at the expected speed and course although there was a higher wind effect compared to the previous day the length of the trajectory 0 51 nm that occurred at the end of the collision avoidance navigation was measured close to the algorithm output 5 discussion in this part of the study we aimed to discuss the presented method with the result of the other methods in the related field the presented method and determined current methods were taken into consideration for comparison various encounter types i e head on and crossing were established to demonstrate the performance of the presented method the methods introduced by tsou et al 2010 lazarowska 2014 and kang et al 2018 which are ai based methods and lazarowska 2016 and fiskin et al 2019 which are deterministic based methods were chosen for comparison with different parameter settings shown in table 8 the first column in the table provides the case number the second column shows the encounter type of the cases followed by the third column and fourth column which present the navigational data inputs belong to the os and ts respectively table 9 and table 10 on the other hand show the numerical results of the comparison scenarios and an in depth comparison of the methods used for discussion respectively 5 1 case 1 comparison with a pso based method a comparison of the trajectories of the oss generated by a particle swarm optimization pso based method introduced by kang et al 2018 and colav ga is illustrated in fig 19 a numerical results produced by both methods are compared in table 9 it is clear that the solution by the colav ga notably outperformed the pso based algorithm the difference in the length of the trajectories was measured as 2 26 nm in terms of the computational time on the other hand colav ga reached the solution in a much shorter time the trajectory produced by the pso based method however comprised more acute angles it should be mentioned that this can be an advantage in terms of navigational comfort and not overloading the engine of ships this situation may not be however very important for future concepts e g unmanned ships autonomous ships it should be also stated how we determined the size of the ship domain for this case in order to ensure an accurate comparison in the pso based method to assess the collision risk tam and bucknall 2010b s ship domain concept which mainly varies according to ship speed was used the ship domain determined in the pso based method is semi elliptical and its semi minor and semi major axes were assumed to be 0 55 nm for 30 knots for a head on encounter situation 5 2 case 2 comparison with an aco based method and deterministic method called tba in this case the results achieved by the colav ga were discussed with the solutions returned by an ant colony optimization aco based method proposed by lazarowska 2014 and the deterministic method called tba introduced by lazarowska 2016 the comparison of the trajectories obtained by these three methods for an example of an encounter situation entitled case 2 in table 8 is illustrated in fig 19 b the collision risk assessment in the aco based method and the tba method was made with a hexagonal ship domain with the longest diagonal line of 1 25 nm we determined the size of the ship domain for this exemplary situation considering this value fig 19 b shows that the trajectory marked by the colav ga is shorter than the trajectories determined by the other two methods the computational time is in favour of the colav ga compared to the aco based method but we cannot say the same when compared to that of the tba method with the advantage of being a deterministic method tba returned the solution in a much shorter time as shown in table 9 5 3 case 3 comparison with a ga based method case 3 provides a comparison between the solutions determined by the colav ga and a ga based method proposed by tsou et al 2010 numerical results produced by both methods are compared in table 9 it is obvious that the result by the colav ga outperformed the ga based method which is illustrated in fig 19 c the difference of the length of the trajectories was calculated as 1 02 nm in terms of the computational time on the other hand colav ga reached the solution in a much shorter time 5 4 case 4 comparison with a deterministic method called wbda a comparison of the trajectories determined by the colav ga and web based deterministic algorithm wbda developed by fiskin et al 2019 is shown in fig 19 d the trajectory provided by colav ga consists of two course alterations the first one of 028 and the second one of 058 while the solution obtained by the wbda also comprises of two course alterations with values of 027 8 and 056 8 respectively the trajectories provided by both algorithms are almost identical with a minor difference of 0 08 nm in favour of the colav ga in terms of the computational time however with the advantage of being a deterministic method wbda reached the solution in a much shorter time as demonstrated in table 9 in this exemplary case we should provide the return distance rd which is the final point distance to return the os to its original route in the wbda method the rd is given for the os the wbda method was also developed by some of the authors in this study firstly this case was executed in the colav ga then we calculated the rd distance using the sine theorem and used it as input for wbda to ensure an accurate comparison to sum up the colav ga outperformed in terms of computational time compared to ai based methods but we cannot say the same against deterministic methods the comparison study demonstrated that deterministic methods return solutions in a much shorter time however it should be emphasized that the computational time of colav ga which is about 2 7 s is also at an acceptable level for real time applications 6 conclusion in this study in encounter situations at sea that is considered to be a risk of collision collision avoidance route planning and optimization was performed for give way vessels for this purpose ga a meta heuristic algorithm and fuzzy logic based solution algorithm called colav ga was developed in conclusion the benefits and contributions of this research can be listed as follows the algorithm meets colreg requirements the algorithm produces identical solutions in every run execution time of the algorithm is very short this allows it to be used in real time applications variable constraints and scenario inputs were determined as a result of interviews with experts algorithm was verified in a real environment with asv and in a virtual environment with a bridge simulator fuzzy logic approach was used to calculate the ship domain thus determining the size of the ship domain is removed from subjectivity by linking to rules and objective principles taking into account the colreg rule 16 determining the point where the collision avoidance manoeuvre will be applied determined by the system user considering the distance of the ts thus the os is enabled to manoeuvre at a safe distance to the ts considering the colreg rule 8 d manoeuvring to return to the original route is made after the ts is considered as clear the algorithm can produce solutions according to the navigator s optimization goal shortest path or mxtots the algorithm has the capability to produce optimal results with course alteration and speed change manoeuvre options there are some limitations to the implementation of the research in this research the interview method was used as a data collection method in the qualitative research process since it is not possible to reach the whole target population in the interview method the research is carried out through the sample population the sample size consists of a total of 10 people including 1 pilot interview in this study the sample size considered sufficient for interviews that key data are intended to be obtained was reached however the current sample size can be considered as one of the limitations of qualitative research in the interview method certain answers cannot be obtained from some participants in line with the objectives of the research this situation emerges as another limitation of the research another limitation is the motion of the ts changes in motion strategy of the ts are not taken into account if the course or speed change of the ts is detected a reactive approach with recalculation is made according to new data in order to further develop the system weights of fuzzy rules can be defined according to the order of importance of ship domain input variables utilizing multi criteria decision making methods ahp anp etc for further studies moreover for future studies a comparative study can be conducted to examine the effects of different ship domain types on the collision avoidance route funding this study was granted by the scientific research coordination unit of dokuz eylül university project number 2017 kb sos 005 the scientific and technological research council of turkey tubitak project number 1059b141800295 and the research council of norway through centre for autonomous marine operations and systems amos grant 223254 credit authorship contribution statement remzi fiskin conceptualization methodology writing original draft preparation software validation writing review editing oguz atik methodology data curation supervision writing review editing hakki kisi methodology literature review visualization investigation writing review editing efendi nasibov methodology writing original draft preparation software tor arne johansen methodology software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful to maritime robotics as for involving them in the real environment experiments leading to substantial results we would like to thank stephanie kemna arild hepso and caio swan de freitas from maritime robotics and trondheim port authority for their efforts to make the sea trials with the telemetron possible and special thanks to d kwame minde kufoalor from ntnu for his useful comments and efforts on this study appendix b supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108502 appendix a other situation results and pseudo code of the algorithm table a 1 other encounter types results of both virtual and real environment experiments table a 1 virtual environment experiment other encounter types results inputs sd nm v knot φ o r b ts o d os ts nm mx tots nm crossing os 2 14 000 7 ts 15 240 030 20 overtaking os 2 16 000 5 ts 7 000 000 12 outputs t w p 0 w p 1 m δ ψ 1 o t w p 1 w p 2 m δ ψ 2 o t w p 2 w p 3 m δ ψ 3 o m w p 1 w p 2 m w p 2 w p 3 nm crossing 31 2 54 10 2 84 17 47 30 6 6 overtaking 46 8 14 38 4 44 18 58 30 15 19 real environment experiment other encounter types results inputs sd nm v knot φ o r b ts o d os ts nm mx tots nm initial position crossing os 0 2 7 090 0 5 63 27 30 n 010 22 10 2 e ts 6 000 040 1 63 26 46 8 n 010 24 3 69 e overtaking os 0 2 9 000 0 3 63 26 46 8 n 010 24 3 69 e ts 4 000 000 0 5 63 27 16 2 n 010 24 3 69 e outputs t w p 0 w p 1 m δ ψ 1 o t w p 1 w p 2 m δ ψ 2 o t w p 2 w p 3 m δ ψ 3 o m w p 1 w p 2 m w p 2 w p 3 nm crossing 3 6 58 2 4 88 4 07 30 0 75 overtaking 3 32 3 6 54 5 09 22 1 3 table a 2 pseudo code of the algorithm table a 2 function ga 1 begin 2 function create initial population 34 set population size 5 for each individual 6789 assign gene randomly check for any overlap if yes 101112 back to step 7 13 else 141516 assign gene 17 1819 return population 20 function calculate fitness 2122 get population list 23 for each individual 242526 calculate f x m i n i 1 n 1 m i 2728 return fitness value 29 best solutiono min calculate fitness o 30 determine the best individual elitism 31 iteration 0 32 repeat 3334 function roulette wheel selection 3536 get population list 37 for each fitness calculated individual 383940 determine selection probabilities p i f x i i 1 n p f x i 4142 spin the wheel and select individuals return population 43 function crossover 4445 get the list of individuals in the match pool 46 match individuals randomly 47 determine crossover rate 48 for each parent 49 if rand 0 1 c r 5051 determine crossover point randomly 5253 change genes between pairs at crossover point 5455 return child individuals 56 fonksiyon mutation 5758 get the list of child individuals 59 determine mutation rate 60 for each individual 61 if rand 0 1 m r 626364 specify the gene to be mutated randomly and reverse it 65 return new population 66 67 68 calculate fitness 69 best solutiont min calculate fitness t 70 if best solutiont best solutiono 717273 best solutiono best solutiont 74 iteration 75 if iteration iteration number 767778 end 79 else 808182 back to step 32 83 end 
21154,the present study provides a robust and systematic approach for the analysis of accidents in enclosed spaces onboard ships an enclosed space is considered a hazardous working environment since its atmosphere contains substances harmful to health despite improvements in safety standards accidents in enclosed spaces remain a major concern for the shipping industry today therefore this paper analyses accidents to identify the factors causing them the study makes use of a fuzzy dematel decision making trial and evaluation laboratory method to evaluate causal factors which can be mitigated through the adoption of certain measures the study focuses on 101 enclosed space accidents incidents which have led to 93 deaths and 96 injuries and determines their causal factors the study findings emphasize the fact that human error and weaknesses in organizational factors are primarily responsible for accidents in enclosed spaces accordingly effective control measures have been identified which can prevent accidents and enhance the safety and sustainability of the shipping industry this study overall makes a contribution to safety management in the shipping industry keywords accident prevention maritime safety safety management enclosed space fuzzy dematel 1 introduction the shipping industry is characterized by ship accidents which cause serious consequences including the loss of lives severe environmental pollution and economic damage eliopoulou et al 2016 the international maritime organization imo has found that shipping is one of the most dangerous industries imo 2002 on earth and research and statistics show that shipping accidents have caused to 20 times more deaths than average coastal industries roberts 2000 2002 nielsen and panayides 2005 the loss of life at sea occurs not just because of maritime accidents such as grounding collision contact fire explosion being wrecked stranded or deficiencies in hull machinery but often because of occupational accidents such as hazards within the workplace roberts and hansen 2002 these include man overboard and enclosed space accidents hansen 1996 nielsen and panayides 2005 roberts marlow 2005 2006 according to statistical studies the primary cause of occupational deaths on ships are accidents incidents that occur in enclosed spaces nielsen 1999 nielsen and panayides 2005 marine accident investigators international forum maiif reports that between 1997 and 2009 there have been at least 101 enclosed space accidents incidents leading to 93 deaths and 96 injuries onboard ships maiif 2009 the marine accident investigation branch maib a governmental organization authorized to investigate all maritime accidents in the united kingdom also examined an accident that occurred on 26 may 2014 in the main carrier hold of the suntis cargo vessel causing the death of three crew members maib 2014 furthermore the study that investigated the confined space fatalities based on the census of fatal occupational injuries data revealed 458 fatalities over the period of 1997 2001 with a rate of 0 07 fatalities per 100 000 workers meyer 2003 specific characteristics of enclosed spaces are laid down in accordance with imo regulations and are i limited openings for entry and exit ii unfavourable natural ventilation and iii not being designed for continuous worker occupancy imo 1997 similar terms have been provided to identify an enclosed space by united states occupational safety and health administration osha and health and safety executive hse osha 1993 hse 2014 although the characteristics of an enclosed space are specified it is not easy to identify an enclosed space particularly when it one which is not normally used shipowners club 2016 an enclosed space is a high risk working environment since its atmosphere may be oxygen deficient oxygen enriched flammable and or toxic imo 2011a b technical and accidents reports that have focused on enclosed space accidents reveal that most of them are triggered by lack of understanding of the dangers of entering enclosed spaces inadequate training and knowledge of the enclosed space entry procedures or a disregard for them imo 2011a b spencer 2012 maib 2014 shipowners club 2016 in addition it is a natural reaction to impulsively enter an enclosed space to help a co worker who has collapsed there without taking the necessary precautions spencer 2012 ics 2014 shipowners club 2016 there is an overwhelming consensus among researchers that the factors responsible for the majority of accidents should be identified in order to prevent similar accidents gaarder et al 1997 o neil 2003 toffoli et al 2005 m ćorović and djurovic 2013 eliopoulou et al 2016 hence it is essential to focus on the causal factors that affect the frequency and severity of ship accidents zeng et al 2016 akyuz et al 2018 in order to identify and mitigate the causal factors researchers must investigate the accidents that have occurred shappell and wiegmann 2000 human environmental and technical issues can all cause accidents but it is necessary to be rigorously precise as to each issue s level of responsibility the efforts of international regulations and researchers have focused thus far mainly on technical and technological aspects of enclosed spaces rather than on the analysis of accidents for instance the imo has introduced recommendations for entering enclosed spaces aboard ships imo 1997 with this regulation a checklist for preparing and using an enclosed space entry permit is recommended in addition the imo s ships and safety of life at sea solas regulation iii 19 imo 2011a b solas 2013 stipulates regular drills in enclosed space entrance and rescue procedures furthermore the possession of certain portable atmosphere testing instruments for enclosed spaces has been enforced by solas regulation xi 1 7 imo 2015 on the other hand there have been only a limited number of studies associated with enclosed space for instance risk analyses for enclosed spaces were conducted by burlet vienney et al 2015 burlet vienney et al 2016 and botti et al 2018 technologies for confined spaces have been investigated by botti et al 2016 and botti et al 2017a a methodology specifying the identification of confined spaces has been developed by botti et al 2017b confined space rescue procedures and training have been proposed by smith et al 2018 and selman et al 2019 naghavi et al 2019 have aimed to explore the human factors that cause confined space accidents using accident investigation reports and semi structured interviews a review of the enclosed space literature underlines the fact that more studies are urgently needed which should identify systematic multidisciplinary and specific characteristics of accidents burlet vienney et al 2014 thus there is a gap in the literature concerning the analysis of accidents in enclosed spaces even though there are some technical reports related to enclosed space accidents the relationships amongst the causes and effects have not yet been investigated with advanced analytical methods however analytic study of causation in accordance with ship operations and management is undoubtedly the most important component of accident prevention shaon et al 2018 this study has analysed accidents that occur in enclosed spaces which are of great practical concern and have yet to be adequately discussed in the current literature in this study 101 enclosed space accidents incidents which have been reported by maiif have been investigated to determine the cause factors maiif 2009 then the fuzzy dematel method is adopted to analyse the relationships among those cause factors the fuzzy dematel method is one of the most commonly utilized models in industry based problems and reveals the critical factors key attributes and relationships among variables tseng and lin 2009 chang et al 2011 nikjoo and saeedpoor 2014 abdullah and zulkifli 2015 akyuz and celik 2015 başhan and ust 2019 the application of the fuzzy dematel model in the shipping industry is rare but it can reveal the causes of accidents in enclosed spaces and thus prevent the loss of life and improve the safety standards on board ships firstly this study contributes to shipping safety literature by specifically focusing on the enclosed space accidents to reveal which causal factors are most crucial to consider existing research in this field primarily provided technical and technological recommendations but practical innovations have not yet been transferred to this industry secondly the study contributes to accidents analysis literature by focusing on the early stages of determining the causation factors for enclosed spaces in the shipping industry thirdly this paper contributes by providing analytic methods in accident research and accident prevention strategies as well as practical measures for safety management of enclosed space operations in the shipping industry fifthly the study encourages researchers practitioners academics professionals administrative authorities and shipping organizations as well as the management of academic organizations involved in the shipping industry to develop an innovative environment for sustainable modes of transportation in addition since many other industries mining construction oil and gas etc have to deal with the enclosed space accidents experts and practitioners from these industries may also find this study s results useful consequently this study aims to remedy the gaps mentioned above and to enhance shipping system safety to achieve this purpose the paper is organised as follows the current section explains the main motivation of study and presents a literature review the following section introduces the research methodologies next application is provided in section three the final section gives conclusions and contributions of the study 2 research methodologies this study combines fuzzy sets and the dematel method for analysing accidents in enclosed spaces onboard ships the dematel is a well known systematic framework for designing and evaluating a complex system that includes causal connections between contributing factors büyüközkan and çifçi 2012 particularly the model primarily takes advantage of the digraphs that split the contributing factors into the cause and the effect group betty et al 2011 more importantly the model s findings provide valuable information about the significance each factor has on the system as a whole zhou et al 2011 thus it is now possible to determine the most important factors that have an effect on other factors since the model has the ability to visualize the structure of complicated causal relationships can determine the most important factors and does not require large amounts of data it has been used in many fields however it suitable for all processes facing challenges that require complex factors to be divided and the significance of factors to be further defined akyuz and celik 2015 in addition to its multi level structure causal connections between contributing factors of enclosed space accidents require advanced modelling to prevent future accidents in this regard responsible decision makers and ship managers would determine the most contributing factors and implement appropriate control measures in order to prevent accidents in enclosed spaces onboard ships however there is some critical defect of the dematel model ranking of contributing factors is performed via interdependent relationships and the aspiration of alternatives cannot be taken into consideration zhou et al 2011 sheng li et al 2018 fuzzy logic is then required to deal with vagueness and inconsistency challenges to overcome the mentioned uncertainties and limitations dematel has been integrated with fuzzy to combine their desired properties in the present study the following sub sections introduce the theory of both methods in this study the fuzzy dematel model has been derived from akyuz celik 2015 and başhan ust 2019 2 1 fuzzy sets introduced by zadeh in 1965 fuzzy logic is a powerful method which overcomes the vagueness inconsistency and uncertainty of human judgment and assessment in decision making decision making problems that concerned complex dynamic systems include imprecision because goals limitations and future acts are not precisely defined zadeh 1965 a fuzzy set converts linguistic terms into fuzzy numbers to avoid combining various experiences opinions ideas and motivations of an individual or group decision maker the perspectives of qualified experts are of particular significance and fuzzy logic methods allow for their contributions to be weighted accordingly thus fuzzy numbers should be generated during the decision making process a triangular fuzzy number membership function mf can be expressed as follows 1 μ ã 0 x l x l m l l x m u x u m m x u 0 x u generally fuzzy numbers are represented through membership although distribution of data and trial error are sometimes used for mfs no specific procedure for selecting mfs does exist sadollah 2018 it is highly dependent on the size and type of the problem considering the fact that this research is an attempt to investigate enclosed space accidents the focal issue has a similar structure to that of control system identification and pattern recognition problems due to its simplicity straight lines and efficiency fast computation the triangular mf is extensively used with these problems sadollah 2018 according to zhao and bose 2002 the triangular mf is superior to all other mfs the triangular mf is therefore chosen for the present study triangular membership function is a common and widely used membership function that can be represented as triple ã l m u where l m and u denote lower medium and upper numbers of the fuzzy sets x y z triangular fuzzy numbers are presented in fig 1 with respect to the above concept table 1 displays the connection between the linguistic terms and triangular fuzzy numbers further various forms of scales including ordinal an exact a ratio an interval or perhaps the combination of such can be included in the present study however it is considered that an ordinal scale linguistic variables is much more suitable to express preferences especially when the number of alternative and qualitative criteria are numerous raj and kumar 1999 hence fig 2 portrays the fuzzy rating and membership function the mathematical calculation of each two triangular fuzzy numbers ã 1 l 1 m 1 u 1 and ã 2 l 2 m 2 u 2 can be described as follows the aggregation of the triangular fuzzy numbers 2 ã 1 ã 2 l 1 l 2 m 1 m 2 u 1 u 2 the subtraction of the triangular fuzzy numbers 3 ã 1 ã 2 l 1 l 2 m 1 m 2 u 1 u 2 the multiplication of the triangular fuzzy numbers 4 ã 1 x ã 2 l 1 x l 2 m 1 x m 2 u 1 x u 2 the arithmetic means of the triangular fuzzy numbers 5 k x ã 1 k x l 1 k x m 2 k x u 2 k 0 6 ã 1 k l 1 k m 1 k u 1 k 2 2 dematel geneva research centre of the battelle memorial institute developed the dematel method to deal with complex and comprehensive decision making problems gabus and fontela 1973 fontela and gabus 1976 dematel is widely accepted as an efficient way of determining the relationship between the causes and effects of measured parameters lin and tzeng 2009 it is particularly beneficial and effective for visualizing the framework of complex causal relationships using matrices and or charts for analysing and exploring complex decision making problems lin 2013 since a method capable of this reveals the interdependent relationship among the factors as well as values of influential effect it has been implemented in many areas such as waste management tseng and lin 2009 supply chain management chang et al 2011 insurance nikjoo and saeedpoor 2014 and crude oil tankers akyuz and celik 2015 the basic steps of the dematel method are explained as follows step 1 measuring the relationship between criteria requires the construction of an initial direct relation matrix for a pair wise comparison firstly experts with required knowledge and experience of the problem should be chosen to assess effect for each factor pair tseng and lin 2009 akyuz and celik 2015 hereby linguistic terms are converted into real values and the direct relation matrix is generated a a i j while the a is a n x n non negative matrix the direct impact of the factor i on factor j represented by a i j however when the i j diagonal elements take zero as their value which indicates there is no effect a i j 0 tseng and lin 2009 akyuz and celik 2015 step 2 the normalized direct relationship matrix d d i j can be obtained from the direct relationship matrix a using the following formula 7 d 1 m a x 1 i n j 1 n a i j step 3 after the normalized direct relationship matrix d is achieved it is possible to acquire the total relation matrix t using formula 8 in which i is represent the identity matrix tseng and lin 2009 akyuz and celik 2015 the element of the formula t i j 4 indicates the indirect effects the i criterion has on the j criterion hence the matrix t provides an overall relationship between each pair of factors tseng and lin 2009 akyuz and celik 2015 8 t d i d 1 step 4 the sum of the t matrix rows and columns are designated as vectors r i and vector c j through formulas 9 and 10 respectively tseng and lin 2009 akyuz and celik 2015 9 r i 1 j n t i j 10 c j 1 j n t i j in the formula where r i refers to any direct and indirect influence provided to all other factors by criterion i c j refers to the degree of influenced impact tseng and lin 2009 akyuz and celik 2015 while r i c j which is called prominence indicates the degree of importance that criterion i has in the total system r i c j which is named relation shows the net effect that criterion i has on the system yang et al 2008 if the value of r i c j is positive the criterion i is clustered under the cause cluster when the value of r i c j is negative the criterion i is clustered under the effect cluster yang et al 2008 tseng and lin 2009 akyuz and celik 2015 certain situations causing accidents can be both cause and effect for example fatigue is both a cause of insufficient training and a result of it step 5 in this step a relationship between the cause and effect diagram is obtained with respect to r i c j and r i c j this makes it possible to visualize the complex interrelation of factors akyuz and celik 2015 2 3 integration of methods fuzzy sets and the dematel method are combined in this sub section to make a robust evaluation of accidents in enclosed spaces onboard ships the fuzzy dematel method requires the user to find the connections between factors and to arrange them based on the form of connection and extent of their impact on each other thus the key benefit of the proposed model is to take into account the fuzziness and handle it with flexibility wu 2012 akyuz and celik 2015 fig 3 displays a flow diagram of the proposed method each basic step of the flow diagram is explained as follows chen yi et al 2007 akyuz and celik 2015 başhan and ust 2019 step 1 at first an expert group whose members have the required knowledge and experience relating to the problem is established they then make the relevant evaluations step 2 in this step critical factors that affect the problem in question should be determined to conduct a proper analysis and evaluation next linguistic terms are arranged with respect to the fuzzy numerical scale in most cases these are no influence very low influence low influence high influence and very high influence thus identical fuzzy members are obtained step 3 then the expert group would perform the pairwise comparisons based on the linguistic variables the fuzzy numbers obtained are defuzzified and aggregated as a crisp value hence an initial direct relation e matrix is achieved 11 e 0 e 1 n e n 1 0 12 e i j l i j m i j u i j step 4 after the initial direct relation matrix is obtained normalization is performed in accordance with the following formulations 13 14 and 15 13 β i e i j j 1 n l i j j 1 n m i j j 1 n u i j 14 γ m a x j 1 n u i j 15 f f 11 f 1 n f n 1 f n n where f e i j γ e i j γ e i j γ e i j γ step 5 afterward to approve lim ω f ω 0 a total relation matrix is computed accordingly the total relation matrix would be represented with respect to the crisp values as shown below 16 t lim ω f f 2 f ω 17 t t 11 t 1 n t n 1 t n n where t i j l i j m i j u i j 18 matrix l i j f l x i f l 1 19 matrix m i j f l x i f m 1 20 matrix u i j f l x i f u 1 step 6 since the t matrix has been calculated it is possible to calculate the r i and c j while the r i presents the sum of the rows c j denotes the sum of the columns as mentioned earlier r i c j summarizes the importance of the factor i while r i c j illustrates the net effect of factor i step 7 coa centre of area which has been developed by ross 2005 to determine b n p best non fuzzy performance values is utilized in this step to defuzzify the obtained r i c j and r i c j thus the objective of the following formulation is the estimation of a convex fuzzy number δ a real number z corresponding to its centre of area gumus et al 2013 21 z μ δ z z d z μ δ z z d z on the other hand g l i j m i j u i j which is a b n p value of a fuzzy number is calculated through the below formula 22 b n p i j u i j l i j m i j l i j 3 l i j step 8 in accordance with the achieved r i c j and r i c j values a cause and effect diagram is constructed in this last step the required formulation is given in step 6 3 analysis of accidents in enclosed space an enclosed space is considered a dangerous working environment since it put crew members lives at risk this stems not only from its atmosphere which can be oxygen deficient polluted or contain flammable and or toxic gases or vapours but also limited openings for entry and exit and not being designed for continuous worker occupancy imo 1997 however crew members still have to be present in an enclosed space during several procedures it is therefore vital that nobody ever enters an enclosed space without essential personal protective equipment ppe until it has been confirmed that pre required measurements atmosphere testing etc have been established despite research and even despite properly implemented international standards accidents still occur in enclosed spaces onboard ships the characteristics of enclosed space accidents fall into two distinct groups although physical failures like leakage equipment failure or failed pipes are often reported as accident triggers in a compromised state human and organizational factors are actually the primary reasons for accidental or intentional problematic occurrences the key failings include incomplete risk analyses especially prior to entering enclosed spaces insufficient oversight and monitoring of work lack of communication between masters and watchkeeping personnel frequent disregard for safety protocols insufficient safety equipment and the absence of an emergency evacuation plan in order to prevent accidents in enclosed space related cause factors and relationships among them should be comprehensively analysed using an advanced method since the accidents in enclosed space lead to catastrophic consequences such as loss of life and economic costs and are also some of the most frequently encountered it is of the utmost importance to prevent similar accidents both to enhance to the safety of the crew members and to improve the sustainability of the shipping industry thus this section presents the application of the fuzzy dematel method on the analysis of accidents in enclosed spaces 3 1 analysis of respondents there are some problems that should be arranged in a particular way to consider all the potential interaction and dependencies among the related factors accidents prevention requires an investigation of the causal factors and relations among them thus it is vital to integrate experts judgements in accidents analyses the linguistic assessment is one suitable way that can be adopted as variables concerning values are not numbers zadeh 1965 a comprehensive survey is conducted with the safety managers and marine superintendents who have extensive experience not just at the managerial level but also at an operational level in shipping the experts have been chosen from the safety practitioners on board ships responsible officer master and watchkeeping personnel chief engineer and ship owner company marine superintendents to reflect the assessment of both sides during the survey the relationship among the causal factors is assessed by selected marine experts according to the linguistic scale in the study the expert group consists of the one master who has ten years of experience one chief engineer who has twelve years of experience and one marine superintendent who has fifteen years of experience they evaluate the causal factors until they reach a consensus on the weighting of each cause 3 2 application of proposed method to begin 101 enclosed space accidents incidents leading to 93 deaths and 96 injuries onboard ships have been investigated to determine common causal factors maiif 2009 table 2 shows the identified causes of enclosed space accidents onboard ships next marine experts assess the relationship among the causal factors in terms with the fuzzy linguistic scale in the study three marine experts have evaluated the relationships and table 3 shows the linguistic assessments of the marine experts consensus on the outcomes based on this evaluation the first direct fuzzy matrix is presented by table 4 then eqs 13 15 have been utilized to the normalization of the direct relation fuzzy matrix which is provided in table 5 respectively after having established the normalization matrix eqs 16 20 have been used respectively to calculate the total relation fuzzy matrix table 6 indicates the total relation fuzzy matrix after performing this calculation according to the figures achieved the fuzzy values of r i c j r i c j and r i c j is calculated and presented in table 7 in the following step eqs 21 and 22 have been taken into account to convert the fuzzy numbers into crisp values the crisp values of the r i c j r i c j and r i c j is demonstrated in table 8 finally it becomes possible to identify cause and effect factors based on the achieved outcomes 3 3 findings and discussion identifying cause and effect factors is crucial in accident prevention since it makes it possible to take optimal precautionary measures chauvin et al 2013 the conducted research allows for the division of the determined factors into two separate groups cause and effect as provided in fig 4 in the figure red denotes the cause group and blue represents the effect group according to the study results the most critical cause factor is c15 multiple tasking combined with the ineffective scheduling which has the highest r i c j 0 35 this implies that c15 has more impact on enclosed space accidents than any other factors c15 also has relatively high r i values 4 77 among the causal factors this means that c15 has a significantly influential impact on other factors as well based on the r i c j figures the second highest cause factor is c18 0 24 using inappropriate equipment in an enclosed space in addition to its second place among the all factors c18 has noteworthy r i values 4 90 the next most noteworthy cause is c6 heavy workload on crew members since its r i c j value is 0 23 which is ranked third among all factors even though the c6 does not have a very high value of r i 4 71 it crucial to realize that it is still one of the key things that have an impact on accidents in enclosed spaces furthermore c17 poor supervision is another prominent cause among the factors due to its value of r i c j and is in the fourth place 0 22 in all cause factors more importantly c17 has the highest r i values 5 20 so it clearly has considerable influence on other factors despite being labelled as cause factors c11 lack of personal protective equipment c16 non compliance with procedures and c3 excessive self confidence of crew members have a relatively moderate impact on the accidents in enclosed spaces considering their r i c j values c11 and c16 have relatively high r i values 4 94 and 4 98 respectively while their r i c j values 0 05 are among the lowest in all factors in the cause group therefore they are not considered critical causes beyond that effect factors also require investigation since they can be impacted by other factors and may also lead to serious consequences according to fig 4 and table 8 c12 lack of required training and guidance about the enclosed space entry has the highest r i c j value 10 22 among all the factors in addition to its quite high influential impact index r i value 5 02 c12 also has the highest influenced impact index c j value 5 20 among all factors on the other hand c12 does not have very low r i c j value when compared to other factors accordingly c12 not only has a significant impact on the other factors but also can be easily affected by other factors at the same time additionally c13 lack of understanding of the potential hazards c5 failed to properly use safety equipment and c14 loss of situational awareness in an enclosed space have relatively higher r i c j values 10 14 10 06 and 9 96 respectively likewise the r i c j values of these effect factors are not very low hence it is clear that these effect factors have been only slightly affected by the other factors c10 insufficient condition assessment for the safety equipment c4 failed to identify potential hazard related to the enclosed space entry and c7 improper rules and roles in the contingency plans also have very high r i c j values 9 97 9 68 and 9 36 respectively however their r i c j values are very low 0 27 0 23 and 0 14 respectively this indicates that they can be easily affected by the other factors other effect factors on the other hand have no significant r i c j values and their r i c j values are relativity low and therefore are strongly influential influenced 3 4 preventive measures proposal as indicated above c15 c18 c6 c17 c12 c13 c5 and c14 are the critical factors that heavily influence the accidents in enclosed space onboard ships it is essential to develop preventive measures regarding these factors in order to avoid similar accidents for this proposed preventive measures are given as follows c15 and c6 are mainly concerned with fatigue although the international convention on standards of training certification and watchkeeping for seafarers stcw 1978 principles of minimum safe manning resolution a 1047 27 and maritime labour convention mlc 2006 provides required guidelines fatigue remains one of the major problems of the shipping industry stcw 2011 imo 2011a b mlc 2006 since fatigue affects everyone irrespective of ability experience and training it is one of the leading causes of accidents hetherington et al 2006 imo 2019 taking into consideration the different types of ships ocean transit patterns and lengths number of trips in the port and port rotations the time a ship spends in the port and unpredictable environmental events it becomes clear that fatigue factors are unique for every ship imo 2019 minimizing and controlling fatigue in shipping requires a comprehensive and systematic approach that starts with ship design and clearly addresses the roles and responsibilities of all stakeholders imo 2019 therefore work and living environment workload management duty scheduling and planning adequate sleep opportunities a healthy shipboard environment and adequate resources including ship manning levels should be considered to ensure fatigue prevention onboard ships imo 2019 accordingly an operational workload should be established with respect to onboard manning levels and comply with hours of work and rest onboard ship imo 2019 c12 c13 and c5 on the other hand originate from lack of required training the solas chapter iii regulation 19 requires that crew members with enclosed space entry and rescue responsibilities must participate in corresponding safety drills at least once every two months but the most serious concern is still lack of training regarding the prevention of enclosed space accidents solas 2013 considering the fact that lack of training is both an influential and influenced factor in such accidents the value of operational training and drills cannot be overemphasized imo 2011a b researchers emphasize the fact that accidents are usually the direct results of seafarers lack of skill and training liu and wu 2003 bhattacharya 2012 hence training strategy should be focused on developing ship specific training and drills and established safety instructions and training initiatives should underline proper utilization of personal safety equipment and procedures imo 2011a b moreover training and drills should be extended in a way that includes a review and briefing after the drills to improve understanding of mistakes made and the potential hazards related to the enclosed space in addition to these points new technology based learning should be integrated into the existing training program to improve the learning outcomes and objectives to illustrate augmented reality or virtual reality based serious games have the potential to enhance seafarers cognitive skills beyond the standard remember understand and apply in this manner the more valuable cognitive skills analyse evaluate and create can be strengthened these are the critical skills for accident prevention a pioneering study concerned with virtual reality training for enclosed space entry has recently been conducted chae et al 2018 c17 and c18 result from poor supervision poor supervision is one of the main causes of accidents in many industries reason 1997 fajer et al 2011 chen and chou 2012 winge et al 2019 stemn et al 2019 smith et al 2019 moreover it develops dissatisfaction among workers and eventually leads to low productivity omisore 2014 stemn et al 2019 accordingly research has underlined the fact that supervisors play an important role in accident prevention since they directly transfer the elements of the safety climate to workers tomas et al 1999 yule et al 2007 managers establish the safety climate and they control the incentives for complying with it such as compensation awards and discipline thompson et al 1998 therefore in order to provide the required supervision managers and responsible decision makers should clearly express their support for safety harmonize the organizational priorities with the safety regulations and ensure effective implementation of a safety management system lastly c14 specifies situational awareness this is another indispensable component of safe operation in enclosed spaces since lack of situational awareness creates an unstable and hazardous working environment given the fact that situational awareness is shaped by individual knowledge experience and training everyone potentially has a unique situational awareness perspective research has further revealed that fatigue and stress are the largest contributory factors in reducing awareness endsley 1995 sneddon et al 2006 as indicated these factors fatigue training and poor supervision obviously play a key role in situation awareness they must be dealt with by other means in order to enhance situational awareness 4 conclusion accident analysis is a critical element of safety management since its main intentions are the prevention of similar incidents and allowing decision makers to improve operational efficiency this study is one of the first that deals with accident analysis in enclosed spaces onboard ships in this paper our proposed model integrates fuzzy sets and dematel to analyse the causal factors and so to prevent future accidents by developing effective precautions or control measures the fuzzy set is used to convert the linguistic terms into fuzzy numbers and the dematel model to evaluate the causal factors and divide them into cause and effect groups in the study 101 enclosed space accidents are first investigated and 18 causal factors are identified secondly the causal factors identified are evaluated by an expert group with respect to the fuzzy numerical scale next causal factors are classified as either causes and effects finally preventive measures are developed for each of the critical factors that heavily influence the accidents the results obtained from the study indicate that the fuzzy dematel method is a robust model capable of the analysis of accidents in enclosed spaces it provides an improved evaluation technique for causal factors the main findings of the research reveal that c15 multiple tasking combined with the ineffective scheduling c6 heavy workload on crew members c12 lack of required training and guidance about the enclosed space entry c13 lack of understanding of the potential hazards c5 failed to proper use of the safety equipment c17 poor supervision c18 using inappropriate equipment in an enclosed space and c14 loss of situational awareness in an enclosed space are the key factors that heavily impact accidents in enclosed spaces in the light of the findings it has become clear that the human element has a significant impact on such accidents in which an operational mistake might lead to loss of lives the results additionally underline that organizational influences poor supervision and a lax safety climate have a huge impact on accidents and efforts need to be taken to prevent minimize and ultimately eliminate them due to the frequency and severity of enclosed space accidents a comprehensive approach should be adopted incorporating both improved safety and sustainability the fuzzy dematel method provides decision makers and practitioners with a systematic and robust accident analysis model for enhancing the safety of ships accordingly the model utilized allows for the improvement of the system s overall safety by providing realistic and flexible measures to be taken which are based on actual accidents in this regard other industries experts and practitioners may also find this study result useful it should be noted though that some of the fundamental drawbacks of these studies is that they are theoretical and dependent on professional assessments future research should be undertaken to tackle the ambiguity of expert judgements and the shortage of analytical evidence in the maritime industry the future studies may be extended to cover bayesian network and other advanced modelling to improve safety management in shipping industry credit authorship contribution statement omer soner conceptualization data curation formal analysis funding acquisition investigation methodology project administration resources supervision software validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108507 
21154,the present study provides a robust and systematic approach for the analysis of accidents in enclosed spaces onboard ships an enclosed space is considered a hazardous working environment since its atmosphere contains substances harmful to health despite improvements in safety standards accidents in enclosed spaces remain a major concern for the shipping industry today therefore this paper analyses accidents to identify the factors causing them the study makes use of a fuzzy dematel decision making trial and evaluation laboratory method to evaluate causal factors which can be mitigated through the adoption of certain measures the study focuses on 101 enclosed space accidents incidents which have led to 93 deaths and 96 injuries and determines their causal factors the study findings emphasize the fact that human error and weaknesses in organizational factors are primarily responsible for accidents in enclosed spaces accordingly effective control measures have been identified which can prevent accidents and enhance the safety and sustainability of the shipping industry this study overall makes a contribution to safety management in the shipping industry keywords accident prevention maritime safety safety management enclosed space fuzzy dematel 1 introduction the shipping industry is characterized by ship accidents which cause serious consequences including the loss of lives severe environmental pollution and economic damage eliopoulou et al 2016 the international maritime organization imo has found that shipping is one of the most dangerous industries imo 2002 on earth and research and statistics show that shipping accidents have caused to 20 times more deaths than average coastal industries roberts 2000 2002 nielsen and panayides 2005 the loss of life at sea occurs not just because of maritime accidents such as grounding collision contact fire explosion being wrecked stranded or deficiencies in hull machinery but often because of occupational accidents such as hazards within the workplace roberts and hansen 2002 these include man overboard and enclosed space accidents hansen 1996 nielsen and panayides 2005 roberts marlow 2005 2006 according to statistical studies the primary cause of occupational deaths on ships are accidents incidents that occur in enclosed spaces nielsen 1999 nielsen and panayides 2005 marine accident investigators international forum maiif reports that between 1997 and 2009 there have been at least 101 enclosed space accidents incidents leading to 93 deaths and 96 injuries onboard ships maiif 2009 the marine accident investigation branch maib a governmental organization authorized to investigate all maritime accidents in the united kingdom also examined an accident that occurred on 26 may 2014 in the main carrier hold of the suntis cargo vessel causing the death of three crew members maib 2014 furthermore the study that investigated the confined space fatalities based on the census of fatal occupational injuries data revealed 458 fatalities over the period of 1997 2001 with a rate of 0 07 fatalities per 100 000 workers meyer 2003 specific characteristics of enclosed spaces are laid down in accordance with imo regulations and are i limited openings for entry and exit ii unfavourable natural ventilation and iii not being designed for continuous worker occupancy imo 1997 similar terms have been provided to identify an enclosed space by united states occupational safety and health administration osha and health and safety executive hse osha 1993 hse 2014 although the characteristics of an enclosed space are specified it is not easy to identify an enclosed space particularly when it one which is not normally used shipowners club 2016 an enclosed space is a high risk working environment since its atmosphere may be oxygen deficient oxygen enriched flammable and or toxic imo 2011a b technical and accidents reports that have focused on enclosed space accidents reveal that most of them are triggered by lack of understanding of the dangers of entering enclosed spaces inadequate training and knowledge of the enclosed space entry procedures or a disregard for them imo 2011a b spencer 2012 maib 2014 shipowners club 2016 in addition it is a natural reaction to impulsively enter an enclosed space to help a co worker who has collapsed there without taking the necessary precautions spencer 2012 ics 2014 shipowners club 2016 there is an overwhelming consensus among researchers that the factors responsible for the majority of accidents should be identified in order to prevent similar accidents gaarder et al 1997 o neil 2003 toffoli et al 2005 m ćorović and djurovic 2013 eliopoulou et al 2016 hence it is essential to focus on the causal factors that affect the frequency and severity of ship accidents zeng et al 2016 akyuz et al 2018 in order to identify and mitigate the causal factors researchers must investigate the accidents that have occurred shappell and wiegmann 2000 human environmental and technical issues can all cause accidents but it is necessary to be rigorously precise as to each issue s level of responsibility the efforts of international regulations and researchers have focused thus far mainly on technical and technological aspects of enclosed spaces rather than on the analysis of accidents for instance the imo has introduced recommendations for entering enclosed spaces aboard ships imo 1997 with this regulation a checklist for preparing and using an enclosed space entry permit is recommended in addition the imo s ships and safety of life at sea solas regulation iii 19 imo 2011a b solas 2013 stipulates regular drills in enclosed space entrance and rescue procedures furthermore the possession of certain portable atmosphere testing instruments for enclosed spaces has been enforced by solas regulation xi 1 7 imo 2015 on the other hand there have been only a limited number of studies associated with enclosed space for instance risk analyses for enclosed spaces were conducted by burlet vienney et al 2015 burlet vienney et al 2016 and botti et al 2018 technologies for confined spaces have been investigated by botti et al 2016 and botti et al 2017a a methodology specifying the identification of confined spaces has been developed by botti et al 2017b confined space rescue procedures and training have been proposed by smith et al 2018 and selman et al 2019 naghavi et al 2019 have aimed to explore the human factors that cause confined space accidents using accident investigation reports and semi structured interviews a review of the enclosed space literature underlines the fact that more studies are urgently needed which should identify systematic multidisciplinary and specific characteristics of accidents burlet vienney et al 2014 thus there is a gap in the literature concerning the analysis of accidents in enclosed spaces even though there are some technical reports related to enclosed space accidents the relationships amongst the causes and effects have not yet been investigated with advanced analytical methods however analytic study of causation in accordance with ship operations and management is undoubtedly the most important component of accident prevention shaon et al 2018 this study has analysed accidents that occur in enclosed spaces which are of great practical concern and have yet to be adequately discussed in the current literature in this study 101 enclosed space accidents incidents which have been reported by maiif have been investigated to determine the cause factors maiif 2009 then the fuzzy dematel method is adopted to analyse the relationships among those cause factors the fuzzy dematel method is one of the most commonly utilized models in industry based problems and reveals the critical factors key attributes and relationships among variables tseng and lin 2009 chang et al 2011 nikjoo and saeedpoor 2014 abdullah and zulkifli 2015 akyuz and celik 2015 başhan and ust 2019 the application of the fuzzy dematel model in the shipping industry is rare but it can reveal the causes of accidents in enclosed spaces and thus prevent the loss of life and improve the safety standards on board ships firstly this study contributes to shipping safety literature by specifically focusing on the enclosed space accidents to reveal which causal factors are most crucial to consider existing research in this field primarily provided technical and technological recommendations but practical innovations have not yet been transferred to this industry secondly the study contributes to accidents analysis literature by focusing on the early stages of determining the causation factors for enclosed spaces in the shipping industry thirdly this paper contributes by providing analytic methods in accident research and accident prevention strategies as well as practical measures for safety management of enclosed space operations in the shipping industry fifthly the study encourages researchers practitioners academics professionals administrative authorities and shipping organizations as well as the management of academic organizations involved in the shipping industry to develop an innovative environment for sustainable modes of transportation in addition since many other industries mining construction oil and gas etc have to deal with the enclosed space accidents experts and practitioners from these industries may also find this study s results useful consequently this study aims to remedy the gaps mentioned above and to enhance shipping system safety to achieve this purpose the paper is organised as follows the current section explains the main motivation of study and presents a literature review the following section introduces the research methodologies next application is provided in section three the final section gives conclusions and contributions of the study 2 research methodologies this study combines fuzzy sets and the dematel method for analysing accidents in enclosed spaces onboard ships the dematel is a well known systematic framework for designing and evaluating a complex system that includes causal connections between contributing factors büyüközkan and çifçi 2012 particularly the model primarily takes advantage of the digraphs that split the contributing factors into the cause and the effect group betty et al 2011 more importantly the model s findings provide valuable information about the significance each factor has on the system as a whole zhou et al 2011 thus it is now possible to determine the most important factors that have an effect on other factors since the model has the ability to visualize the structure of complicated causal relationships can determine the most important factors and does not require large amounts of data it has been used in many fields however it suitable for all processes facing challenges that require complex factors to be divided and the significance of factors to be further defined akyuz and celik 2015 in addition to its multi level structure causal connections between contributing factors of enclosed space accidents require advanced modelling to prevent future accidents in this regard responsible decision makers and ship managers would determine the most contributing factors and implement appropriate control measures in order to prevent accidents in enclosed spaces onboard ships however there is some critical defect of the dematel model ranking of contributing factors is performed via interdependent relationships and the aspiration of alternatives cannot be taken into consideration zhou et al 2011 sheng li et al 2018 fuzzy logic is then required to deal with vagueness and inconsistency challenges to overcome the mentioned uncertainties and limitations dematel has been integrated with fuzzy to combine their desired properties in the present study the following sub sections introduce the theory of both methods in this study the fuzzy dematel model has been derived from akyuz celik 2015 and başhan ust 2019 2 1 fuzzy sets introduced by zadeh in 1965 fuzzy logic is a powerful method which overcomes the vagueness inconsistency and uncertainty of human judgment and assessment in decision making decision making problems that concerned complex dynamic systems include imprecision because goals limitations and future acts are not precisely defined zadeh 1965 a fuzzy set converts linguistic terms into fuzzy numbers to avoid combining various experiences opinions ideas and motivations of an individual or group decision maker the perspectives of qualified experts are of particular significance and fuzzy logic methods allow for their contributions to be weighted accordingly thus fuzzy numbers should be generated during the decision making process a triangular fuzzy number membership function mf can be expressed as follows 1 μ ã 0 x l x l m l l x m u x u m m x u 0 x u generally fuzzy numbers are represented through membership although distribution of data and trial error are sometimes used for mfs no specific procedure for selecting mfs does exist sadollah 2018 it is highly dependent on the size and type of the problem considering the fact that this research is an attempt to investigate enclosed space accidents the focal issue has a similar structure to that of control system identification and pattern recognition problems due to its simplicity straight lines and efficiency fast computation the triangular mf is extensively used with these problems sadollah 2018 according to zhao and bose 2002 the triangular mf is superior to all other mfs the triangular mf is therefore chosen for the present study triangular membership function is a common and widely used membership function that can be represented as triple ã l m u where l m and u denote lower medium and upper numbers of the fuzzy sets x y z triangular fuzzy numbers are presented in fig 1 with respect to the above concept table 1 displays the connection between the linguistic terms and triangular fuzzy numbers further various forms of scales including ordinal an exact a ratio an interval or perhaps the combination of such can be included in the present study however it is considered that an ordinal scale linguistic variables is much more suitable to express preferences especially when the number of alternative and qualitative criteria are numerous raj and kumar 1999 hence fig 2 portrays the fuzzy rating and membership function the mathematical calculation of each two triangular fuzzy numbers ã 1 l 1 m 1 u 1 and ã 2 l 2 m 2 u 2 can be described as follows the aggregation of the triangular fuzzy numbers 2 ã 1 ã 2 l 1 l 2 m 1 m 2 u 1 u 2 the subtraction of the triangular fuzzy numbers 3 ã 1 ã 2 l 1 l 2 m 1 m 2 u 1 u 2 the multiplication of the triangular fuzzy numbers 4 ã 1 x ã 2 l 1 x l 2 m 1 x m 2 u 1 x u 2 the arithmetic means of the triangular fuzzy numbers 5 k x ã 1 k x l 1 k x m 2 k x u 2 k 0 6 ã 1 k l 1 k m 1 k u 1 k 2 2 dematel geneva research centre of the battelle memorial institute developed the dematel method to deal with complex and comprehensive decision making problems gabus and fontela 1973 fontela and gabus 1976 dematel is widely accepted as an efficient way of determining the relationship between the causes and effects of measured parameters lin and tzeng 2009 it is particularly beneficial and effective for visualizing the framework of complex causal relationships using matrices and or charts for analysing and exploring complex decision making problems lin 2013 since a method capable of this reveals the interdependent relationship among the factors as well as values of influential effect it has been implemented in many areas such as waste management tseng and lin 2009 supply chain management chang et al 2011 insurance nikjoo and saeedpoor 2014 and crude oil tankers akyuz and celik 2015 the basic steps of the dematel method are explained as follows step 1 measuring the relationship between criteria requires the construction of an initial direct relation matrix for a pair wise comparison firstly experts with required knowledge and experience of the problem should be chosen to assess effect for each factor pair tseng and lin 2009 akyuz and celik 2015 hereby linguistic terms are converted into real values and the direct relation matrix is generated a a i j while the a is a n x n non negative matrix the direct impact of the factor i on factor j represented by a i j however when the i j diagonal elements take zero as their value which indicates there is no effect a i j 0 tseng and lin 2009 akyuz and celik 2015 step 2 the normalized direct relationship matrix d d i j can be obtained from the direct relationship matrix a using the following formula 7 d 1 m a x 1 i n j 1 n a i j step 3 after the normalized direct relationship matrix d is achieved it is possible to acquire the total relation matrix t using formula 8 in which i is represent the identity matrix tseng and lin 2009 akyuz and celik 2015 the element of the formula t i j 4 indicates the indirect effects the i criterion has on the j criterion hence the matrix t provides an overall relationship between each pair of factors tseng and lin 2009 akyuz and celik 2015 8 t d i d 1 step 4 the sum of the t matrix rows and columns are designated as vectors r i and vector c j through formulas 9 and 10 respectively tseng and lin 2009 akyuz and celik 2015 9 r i 1 j n t i j 10 c j 1 j n t i j in the formula where r i refers to any direct and indirect influence provided to all other factors by criterion i c j refers to the degree of influenced impact tseng and lin 2009 akyuz and celik 2015 while r i c j which is called prominence indicates the degree of importance that criterion i has in the total system r i c j which is named relation shows the net effect that criterion i has on the system yang et al 2008 if the value of r i c j is positive the criterion i is clustered under the cause cluster when the value of r i c j is negative the criterion i is clustered under the effect cluster yang et al 2008 tseng and lin 2009 akyuz and celik 2015 certain situations causing accidents can be both cause and effect for example fatigue is both a cause of insufficient training and a result of it step 5 in this step a relationship between the cause and effect diagram is obtained with respect to r i c j and r i c j this makes it possible to visualize the complex interrelation of factors akyuz and celik 2015 2 3 integration of methods fuzzy sets and the dematel method are combined in this sub section to make a robust evaluation of accidents in enclosed spaces onboard ships the fuzzy dematel method requires the user to find the connections between factors and to arrange them based on the form of connection and extent of their impact on each other thus the key benefit of the proposed model is to take into account the fuzziness and handle it with flexibility wu 2012 akyuz and celik 2015 fig 3 displays a flow diagram of the proposed method each basic step of the flow diagram is explained as follows chen yi et al 2007 akyuz and celik 2015 başhan and ust 2019 step 1 at first an expert group whose members have the required knowledge and experience relating to the problem is established they then make the relevant evaluations step 2 in this step critical factors that affect the problem in question should be determined to conduct a proper analysis and evaluation next linguistic terms are arranged with respect to the fuzzy numerical scale in most cases these are no influence very low influence low influence high influence and very high influence thus identical fuzzy members are obtained step 3 then the expert group would perform the pairwise comparisons based on the linguistic variables the fuzzy numbers obtained are defuzzified and aggregated as a crisp value hence an initial direct relation e matrix is achieved 11 e 0 e 1 n e n 1 0 12 e i j l i j m i j u i j step 4 after the initial direct relation matrix is obtained normalization is performed in accordance with the following formulations 13 14 and 15 13 β i e i j j 1 n l i j j 1 n m i j j 1 n u i j 14 γ m a x j 1 n u i j 15 f f 11 f 1 n f n 1 f n n where f e i j γ e i j γ e i j γ e i j γ step 5 afterward to approve lim ω f ω 0 a total relation matrix is computed accordingly the total relation matrix would be represented with respect to the crisp values as shown below 16 t lim ω f f 2 f ω 17 t t 11 t 1 n t n 1 t n n where t i j l i j m i j u i j 18 matrix l i j f l x i f l 1 19 matrix m i j f l x i f m 1 20 matrix u i j f l x i f u 1 step 6 since the t matrix has been calculated it is possible to calculate the r i and c j while the r i presents the sum of the rows c j denotes the sum of the columns as mentioned earlier r i c j summarizes the importance of the factor i while r i c j illustrates the net effect of factor i step 7 coa centre of area which has been developed by ross 2005 to determine b n p best non fuzzy performance values is utilized in this step to defuzzify the obtained r i c j and r i c j thus the objective of the following formulation is the estimation of a convex fuzzy number δ a real number z corresponding to its centre of area gumus et al 2013 21 z μ δ z z d z μ δ z z d z on the other hand g l i j m i j u i j which is a b n p value of a fuzzy number is calculated through the below formula 22 b n p i j u i j l i j m i j l i j 3 l i j step 8 in accordance with the achieved r i c j and r i c j values a cause and effect diagram is constructed in this last step the required formulation is given in step 6 3 analysis of accidents in enclosed space an enclosed space is considered a dangerous working environment since it put crew members lives at risk this stems not only from its atmosphere which can be oxygen deficient polluted or contain flammable and or toxic gases or vapours but also limited openings for entry and exit and not being designed for continuous worker occupancy imo 1997 however crew members still have to be present in an enclosed space during several procedures it is therefore vital that nobody ever enters an enclosed space without essential personal protective equipment ppe until it has been confirmed that pre required measurements atmosphere testing etc have been established despite research and even despite properly implemented international standards accidents still occur in enclosed spaces onboard ships the characteristics of enclosed space accidents fall into two distinct groups although physical failures like leakage equipment failure or failed pipes are often reported as accident triggers in a compromised state human and organizational factors are actually the primary reasons for accidental or intentional problematic occurrences the key failings include incomplete risk analyses especially prior to entering enclosed spaces insufficient oversight and monitoring of work lack of communication between masters and watchkeeping personnel frequent disregard for safety protocols insufficient safety equipment and the absence of an emergency evacuation plan in order to prevent accidents in enclosed space related cause factors and relationships among them should be comprehensively analysed using an advanced method since the accidents in enclosed space lead to catastrophic consequences such as loss of life and economic costs and are also some of the most frequently encountered it is of the utmost importance to prevent similar accidents both to enhance to the safety of the crew members and to improve the sustainability of the shipping industry thus this section presents the application of the fuzzy dematel method on the analysis of accidents in enclosed spaces 3 1 analysis of respondents there are some problems that should be arranged in a particular way to consider all the potential interaction and dependencies among the related factors accidents prevention requires an investigation of the causal factors and relations among them thus it is vital to integrate experts judgements in accidents analyses the linguistic assessment is one suitable way that can be adopted as variables concerning values are not numbers zadeh 1965 a comprehensive survey is conducted with the safety managers and marine superintendents who have extensive experience not just at the managerial level but also at an operational level in shipping the experts have been chosen from the safety practitioners on board ships responsible officer master and watchkeeping personnel chief engineer and ship owner company marine superintendents to reflect the assessment of both sides during the survey the relationship among the causal factors is assessed by selected marine experts according to the linguistic scale in the study the expert group consists of the one master who has ten years of experience one chief engineer who has twelve years of experience and one marine superintendent who has fifteen years of experience they evaluate the causal factors until they reach a consensus on the weighting of each cause 3 2 application of proposed method to begin 101 enclosed space accidents incidents leading to 93 deaths and 96 injuries onboard ships have been investigated to determine common causal factors maiif 2009 table 2 shows the identified causes of enclosed space accidents onboard ships next marine experts assess the relationship among the causal factors in terms with the fuzzy linguistic scale in the study three marine experts have evaluated the relationships and table 3 shows the linguistic assessments of the marine experts consensus on the outcomes based on this evaluation the first direct fuzzy matrix is presented by table 4 then eqs 13 15 have been utilized to the normalization of the direct relation fuzzy matrix which is provided in table 5 respectively after having established the normalization matrix eqs 16 20 have been used respectively to calculate the total relation fuzzy matrix table 6 indicates the total relation fuzzy matrix after performing this calculation according to the figures achieved the fuzzy values of r i c j r i c j and r i c j is calculated and presented in table 7 in the following step eqs 21 and 22 have been taken into account to convert the fuzzy numbers into crisp values the crisp values of the r i c j r i c j and r i c j is demonstrated in table 8 finally it becomes possible to identify cause and effect factors based on the achieved outcomes 3 3 findings and discussion identifying cause and effect factors is crucial in accident prevention since it makes it possible to take optimal precautionary measures chauvin et al 2013 the conducted research allows for the division of the determined factors into two separate groups cause and effect as provided in fig 4 in the figure red denotes the cause group and blue represents the effect group according to the study results the most critical cause factor is c15 multiple tasking combined with the ineffective scheduling which has the highest r i c j 0 35 this implies that c15 has more impact on enclosed space accidents than any other factors c15 also has relatively high r i values 4 77 among the causal factors this means that c15 has a significantly influential impact on other factors as well based on the r i c j figures the second highest cause factor is c18 0 24 using inappropriate equipment in an enclosed space in addition to its second place among the all factors c18 has noteworthy r i values 4 90 the next most noteworthy cause is c6 heavy workload on crew members since its r i c j value is 0 23 which is ranked third among all factors even though the c6 does not have a very high value of r i 4 71 it crucial to realize that it is still one of the key things that have an impact on accidents in enclosed spaces furthermore c17 poor supervision is another prominent cause among the factors due to its value of r i c j and is in the fourth place 0 22 in all cause factors more importantly c17 has the highest r i values 5 20 so it clearly has considerable influence on other factors despite being labelled as cause factors c11 lack of personal protective equipment c16 non compliance with procedures and c3 excessive self confidence of crew members have a relatively moderate impact on the accidents in enclosed spaces considering their r i c j values c11 and c16 have relatively high r i values 4 94 and 4 98 respectively while their r i c j values 0 05 are among the lowest in all factors in the cause group therefore they are not considered critical causes beyond that effect factors also require investigation since they can be impacted by other factors and may also lead to serious consequences according to fig 4 and table 8 c12 lack of required training and guidance about the enclosed space entry has the highest r i c j value 10 22 among all the factors in addition to its quite high influential impact index r i value 5 02 c12 also has the highest influenced impact index c j value 5 20 among all factors on the other hand c12 does not have very low r i c j value when compared to other factors accordingly c12 not only has a significant impact on the other factors but also can be easily affected by other factors at the same time additionally c13 lack of understanding of the potential hazards c5 failed to properly use safety equipment and c14 loss of situational awareness in an enclosed space have relatively higher r i c j values 10 14 10 06 and 9 96 respectively likewise the r i c j values of these effect factors are not very low hence it is clear that these effect factors have been only slightly affected by the other factors c10 insufficient condition assessment for the safety equipment c4 failed to identify potential hazard related to the enclosed space entry and c7 improper rules and roles in the contingency plans also have very high r i c j values 9 97 9 68 and 9 36 respectively however their r i c j values are very low 0 27 0 23 and 0 14 respectively this indicates that they can be easily affected by the other factors other effect factors on the other hand have no significant r i c j values and their r i c j values are relativity low and therefore are strongly influential influenced 3 4 preventive measures proposal as indicated above c15 c18 c6 c17 c12 c13 c5 and c14 are the critical factors that heavily influence the accidents in enclosed space onboard ships it is essential to develop preventive measures regarding these factors in order to avoid similar accidents for this proposed preventive measures are given as follows c15 and c6 are mainly concerned with fatigue although the international convention on standards of training certification and watchkeeping for seafarers stcw 1978 principles of minimum safe manning resolution a 1047 27 and maritime labour convention mlc 2006 provides required guidelines fatigue remains one of the major problems of the shipping industry stcw 2011 imo 2011a b mlc 2006 since fatigue affects everyone irrespective of ability experience and training it is one of the leading causes of accidents hetherington et al 2006 imo 2019 taking into consideration the different types of ships ocean transit patterns and lengths number of trips in the port and port rotations the time a ship spends in the port and unpredictable environmental events it becomes clear that fatigue factors are unique for every ship imo 2019 minimizing and controlling fatigue in shipping requires a comprehensive and systematic approach that starts with ship design and clearly addresses the roles and responsibilities of all stakeholders imo 2019 therefore work and living environment workload management duty scheduling and planning adequate sleep opportunities a healthy shipboard environment and adequate resources including ship manning levels should be considered to ensure fatigue prevention onboard ships imo 2019 accordingly an operational workload should be established with respect to onboard manning levels and comply with hours of work and rest onboard ship imo 2019 c12 c13 and c5 on the other hand originate from lack of required training the solas chapter iii regulation 19 requires that crew members with enclosed space entry and rescue responsibilities must participate in corresponding safety drills at least once every two months but the most serious concern is still lack of training regarding the prevention of enclosed space accidents solas 2013 considering the fact that lack of training is both an influential and influenced factor in such accidents the value of operational training and drills cannot be overemphasized imo 2011a b researchers emphasize the fact that accidents are usually the direct results of seafarers lack of skill and training liu and wu 2003 bhattacharya 2012 hence training strategy should be focused on developing ship specific training and drills and established safety instructions and training initiatives should underline proper utilization of personal safety equipment and procedures imo 2011a b moreover training and drills should be extended in a way that includes a review and briefing after the drills to improve understanding of mistakes made and the potential hazards related to the enclosed space in addition to these points new technology based learning should be integrated into the existing training program to improve the learning outcomes and objectives to illustrate augmented reality or virtual reality based serious games have the potential to enhance seafarers cognitive skills beyond the standard remember understand and apply in this manner the more valuable cognitive skills analyse evaluate and create can be strengthened these are the critical skills for accident prevention a pioneering study concerned with virtual reality training for enclosed space entry has recently been conducted chae et al 2018 c17 and c18 result from poor supervision poor supervision is one of the main causes of accidents in many industries reason 1997 fajer et al 2011 chen and chou 2012 winge et al 2019 stemn et al 2019 smith et al 2019 moreover it develops dissatisfaction among workers and eventually leads to low productivity omisore 2014 stemn et al 2019 accordingly research has underlined the fact that supervisors play an important role in accident prevention since they directly transfer the elements of the safety climate to workers tomas et al 1999 yule et al 2007 managers establish the safety climate and they control the incentives for complying with it such as compensation awards and discipline thompson et al 1998 therefore in order to provide the required supervision managers and responsible decision makers should clearly express their support for safety harmonize the organizational priorities with the safety regulations and ensure effective implementation of a safety management system lastly c14 specifies situational awareness this is another indispensable component of safe operation in enclosed spaces since lack of situational awareness creates an unstable and hazardous working environment given the fact that situational awareness is shaped by individual knowledge experience and training everyone potentially has a unique situational awareness perspective research has further revealed that fatigue and stress are the largest contributory factors in reducing awareness endsley 1995 sneddon et al 2006 as indicated these factors fatigue training and poor supervision obviously play a key role in situation awareness they must be dealt with by other means in order to enhance situational awareness 4 conclusion accident analysis is a critical element of safety management since its main intentions are the prevention of similar incidents and allowing decision makers to improve operational efficiency this study is one of the first that deals with accident analysis in enclosed spaces onboard ships in this paper our proposed model integrates fuzzy sets and dematel to analyse the causal factors and so to prevent future accidents by developing effective precautions or control measures the fuzzy set is used to convert the linguistic terms into fuzzy numbers and the dematel model to evaluate the causal factors and divide them into cause and effect groups in the study 101 enclosed space accidents are first investigated and 18 causal factors are identified secondly the causal factors identified are evaluated by an expert group with respect to the fuzzy numerical scale next causal factors are classified as either causes and effects finally preventive measures are developed for each of the critical factors that heavily influence the accidents the results obtained from the study indicate that the fuzzy dematel method is a robust model capable of the analysis of accidents in enclosed spaces it provides an improved evaluation technique for causal factors the main findings of the research reveal that c15 multiple tasking combined with the ineffective scheduling c6 heavy workload on crew members c12 lack of required training and guidance about the enclosed space entry c13 lack of understanding of the potential hazards c5 failed to proper use of the safety equipment c17 poor supervision c18 using inappropriate equipment in an enclosed space and c14 loss of situational awareness in an enclosed space are the key factors that heavily impact accidents in enclosed spaces in the light of the findings it has become clear that the human element has a significant impact on such accidents in which an operational mistake might lead to loss of lives the results additionally underline that organizational influences poor supervision and a lax safety climate have a huge impact on accidents and efforts need to be taken to prevent minimize and ultimately eliminate them due to the frequency and severity of enclosed space accidents a comprehensive approach should be adopted incorporating both improved safety and sustainability the fuzzy dematel method provides decision makers and practitioners with a systematic and robust accident analysis model for enhancing the safety of ships accordingly the model utilized allows for the improvement of the system s overall safety by providing realistic and flexible measures to be taken which are based on actual accidents in this regard other industries experts and practitioners may also find this study result useful it should be noted though that some of the fundamental drawbacks of these studies is that they are theoretical and dependent on professional assessments future research should be undertaken to tackle the ambiguity of expert judgements and the shortage of analytical evidence in the maritime industry the future studies may be extended to cover bayesian network and other advanced modelling to improve safety management in shipping industry credit authorship contribution statement omer soner conceptualization data curation formal analysis funding acquisition investigation methodology project administration resources supervision software validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108507 
