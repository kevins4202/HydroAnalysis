index,text
2995,climate change has a direct influence on both hydrology and floodplain vegetation of water courses which are key players in river morphodynamics the river system response to climate change is complex and the effects of non linear interactions between alterations in water sediment and vegetation remain incompletely understood which of these components becomes dominant in shaping the river channel when climate becomes drier or wetter to answer this question we investigate the cross sectional response of sand bed rivers to climate change focusing on channel width and depth which respond directly to changes in boundary stresses thanks to the exceptional availability of long time series of daily discharge and cross sectional profiles the pilcomayo river is an ideal living lab for this investigation we constructed a two dimensional model of the river using the open source state of the art structured delft3d code the highly dynamic behaviour and quick morphological adaptation of the pilcomayo allowed reducing the period of time covered by the simulations because the river cross section adapts its morphology to a new value of the water discharge within hours or days which is crucial for modelling investigations calibration and validation were successfully performed by comparison with historical data we considered several scenarios representing current dryer and wetter climates the results show that a dryer climate reduces the river channel depth and enlarges the width a wetter climate increases the channel depth but produces negligible widening vegetation sparser with a drier climate and denser with a wetter climate is found to control the channel width this analysis is unique and shows which alterations can be expected in alluvial sand bed rivers with natural vegetated banks due to climate change keywords alluvial river pilcomayo river climate change floodplain vegetation river morphodynamics data availability data will be made available on request 1 introduction changing climate affects terrestrial landscapes baker 1995 yang et al 2003 and their components through alterations in precipitation and temperature which directly affect water quantity and quality soil erosion soil moisture and vegetation cover masson delmotte et al 2018 seneviratne et al 2006 sperna weiland et al 2012 trenberth 2011 increasingly frequent extreme events such as floods and draughts combined with deforestation have already intensified sediment production and will govern the future geomorphological trends baker 1995 borrelli et al 2017 cai et al 2014 rivers have a primary role in transport and distribution of water sediment and nutrients sabater et al 2018 wohl et al 2015 alterations in their discharge regime and sediment production church 2006 induce changes in their morphology and dynamics with consequences for the water conveyance and sediment transport grams and schmidt 2005 kondolf 1997 wilby et al 2008 as well as for the quality of their ecosystems wohl et al 2015 floodplain vegetation plays a significant role on the morphological adaptation of rivers gurnell 2014 tal and paola 2010 since it affects the water flow distribution and sediment transport during floods lightbody et al 2019 villada arroyave and crosato 2010 wang et al 2015 protects banks and emerging bars against erosion micheli and kirchner 2002 rominger et al 2010 thorne 1982 and creates the conditions for new floodplain formation hupp and simon 1991 as a result dense vegetation growth on river banks and floodplains reduces the river braiding degree and promotes river meandering crosato and saleh 2011 gibling and davies 2012 gurnell 2014 2012 nardi et al 2013 solari et al 2016 tal and paola 2010 ward et al 2000 isolated trees as well as sparse patchy vegetation however might split the flow promoting the excavation of channels through the floodplain and main channel bifurcation as well as enhancing local bank instability coulthard 2005 ielpi and lapôtre 2019 vargas luna et al 2019b however at the same time floodplain vegetation growth also increases the water levels during floods villada arroyave and crosato 2010 by directly affecting the river discharge regime sperna weiland et al 2012 floodplain vegetation baker 1995 dale et al 2001 and sediment production lane et al 2007 climate change is thus expected to also modify the river morphology this might have important consequences not only for the river landscape and ecosystem but also for the river conveyance the water accessibility the safety of structures the frequency of floods and the human activities this shows the relevance of anticipating and understanding river adaptation to climate change which still remains a challenge harrison et al 2019 reproducing the long term river response to climate changes in the laboratory by combining the effects of altering discharge sediment input and vegetation requires a substantial effort for this if sufficient data are available computational approaches represent a valid alternative arboleda et al 2010 siviglia and crosato 2016 among the different types of water courses sand bed rivers show highly reactive responses to external drivers they quickly adapt their alluvial channel to variations in discharge and sediment input through deposition scouring widening and narrowing martín vide et al 2019 sarker et al 2014 moreover sand bed rivers generally present full sediment mobility and their bed material can be assumed uniform singh et al 2017 for this simulating their morphological adaptation does not require excessively long computational times which makes these systems ideal case studies to investigate the effects of changes in the main drivers of river morphology in the present research we investigate how climate change affects the cross section and particularly the width and depth of a natural sand bed river using a two dimensional numerical model of the pilcomayo river at a location near the border between paraguay and argentina we look at two of the main drivers of channel morphology which have a direct dependency on climate river flow and floodplain vegetation this study is made possible by the availability of a unique set of data containing long time series of daily cross sectional profiles and corresponding discharges in addition due to a bed composition of fine sand the pilcomayo river displays an extraordinary high dynamism martín vide et al 2019 with fast adaptation to new environmental conditions which allows estimating its morphological response to water flow and vegetation alterations with rather quick computations covering relatively short periods of time we consider moderate climate changes corresponding to the 2100 projections of the intergovernmental panel on climate change ipcc special report on emission scenarios a1b hereafter named as the sres a1b scenarios stocker et al 2013 based on which sperna weiland et al 2012 derived the corresponding monthly changes in river discharge world wide by running a multi model ensemble of 12 general circulation models with the global hydrological model pcr globwb van beek and bierkens 2009 for the pilcomayo river this scenario results in 20 30 of flow reduction sperna weiland et al 2012 for sake of comparison the scenarios analysed in this study are the present climate the projected drier climate for the year 2100 as well as the opposite wetter climate each scenario is represented by a water discharge regime derived from the work of sperna weiland et al 2012 affecting also the input output of sediment in the study area and floodplain vegetation the three adopted discharge scenarios represent well the range of variability that more recent global change scenarios displayed for instance montroull et al 2018 analysed the impact of adopting several representative concentration pathways rcps van vuuren et al 2011 on future streamflow scenarios in la plata basin where the pilcomayo lays their conclusion is that the percentage of change in annual mean streamflow in the basin is between 20 to 25 these values are in line to our dry and wet scenarios there are no quantitative studies on how on going global warming will change vegetation but observations show that richer vegetation is found in wetter climates and sparser vegetation in drier climates anadón et al 2014 van oorschot et al 2018 the vegetation scenarios considered in this study are based on these observations which means that floodplain vegetation is assumed to be higher and denser with the considered wetter climate sparser and shorter with the drier climate 2 the pilcomayo river the pilcomayo river flows south eastwards from the andes to the paraguay river a tributary of the paraná for 1 100 km its basin is part of the la plata basin the second largest one in south america after the amazon martín vide et al 2014 the study area is an 8 km long river reach of the lower pilcomayo near the border between paraguay and argentina this zone includes the gauging station misión la paz argentina where the river has a catchment area of 96 000 km2 at this location the pilcomayo divides the argentinian village of misión la paz from the paraguayan village of pozo hondo whereas a 220 metre long international bridge connects the two communities the study reach starts 4 km upstream and ends 4 km downstream of this bridge the river has a meandering style and no tributaries fig 1 it has a mild slope about 0 03 an average main channel width varying from 75 m to some hundreds meters as a function of discharge and wide floodplains covered by sparse vegetation mainly consisting of semi open shrub at low flow conditions the river bed presents many sand bars and areas of lateral sediment deposition fig 1 the river bed material is fine sand with particles ranging between 0 1 and 0 2 mm as indicated by pool and van duijne 1996 the yearly sediment transport rate of this reach of the pilcomayo river is estimated in 140 million tons year for 89 composed of silt and clay wash load not contributing to the morphological changes of the river channel in the study area and thus not considered in this study and for 11 of fine sand martín vide et al 2014 according to the updated köppen geiger classification peel et al 2007 the climate of the pilcomayo basin is temperate with total yearly precipitation ranging between 400 and 500 mm upper basin and 700 1 200 mm lower basin and yearly averaged temperatures of 9 5 c and 23 3 c respectively halcrow serman associados 2006 as far as 90 of the annual precipitation occurs in the period mid november to mid march concentration of rainfall in such a short time causes two physical processes outstanding in the entire basin large floods and intense fluvial erosion deposition pool and van duijne 1996 an important part of the river catchment lies inside the gran chaco a hot semi arid lowland region between the andes and the paraguay river with poor vegetation cover and high soil erodibility the national hydrological network of argentina has records of daily discharges water levels at the station of misión la paz covering the periods november 1960 to august 2018 and september 1964 to july 2019 respectively at this location the maximum recorded discharge is 4 585 m3 s in march 1984 and the minimum is 1 4 m3 s in october 1972 the mean annual discharge being 212 m3 s the wet season is from december to march the maximum value of monthly discharge is 648 m3 s and it corresponds to february while the month with less discharge is september with an average discharge of 22 m3 s the strong flow variability combined with a highly erodible bed composed of fine sand and sparse riparian vegetation makes the lower pilcomayo a notoriously dynamic river with cross sections responding very fast to flow variations capape and martin vide 2015 martín vide et al 2014 pool and van duijne 1996 this can be observed in the video provided by martín vide et al 2019 as supplementary material https ars els cdn com content image 1 s2 0 s0022169419305888 mmc1 mp4 retrieved the 1st december 2020 this is clear also when analysing the daily cross sectional data collected by the tri national committee for the development of the pilcomayo river basin at the two locations near misión la paz in the period 1972 2019 fig 2 as consequence of bank erosion rates also the channel alignment continuously changes fig 3 the current reach scale characteristics of the pilcomayo river in the study area are summarized in table 1 3 materials and methods the analysis of daily data series covering long periods of time allows properly setting up calibrating and validating a reliable numerical model simulating the morphological behaviour of the pilcomayo river the type of sediment forming the alluvial bed fine sand allows assuming full sediment mobility and thus considering a single sediment size in the model reducing computational time singh et al 2017 moreover due to the extremely quick response of the river to changing conditions simulating a single hydrological year can be considered enough to detect the range of effects of alterations in morphological drivers all these factors together make the pilcomayo a unique case to be used as a living lab to investigate the response of alluvial sand bed rivers to climate change 3 1 model description we constructed a two dimensional 2d numerical model of the pilcomayo river using the open source structured delft3d code version 4 1 which solves the 3d reynolds equations for shallow water coupled to sediment transport and sediment balance equations including also a bank erosion formulation deltares 2019 lesser et al 2004 downloadable at https oss deltares nl web delft3d the code has been widely tested and validated for investigations requiring the simulation of the morphological changes of rivers with vegetated floodplains e g arboleda et al 2010 vargas luna et al 2018 villada arroyave and crosato 2010 the model computes water levels and depth averaged flow velocity the latter as a vector with two components in the horizontal plane as well as changes of bed topography and channel alignment including the effects of vegetation on local energy dissipation and sediment transport rate bed level changes are computed at every time step for every grid cell based on sediment budget following exner 1920 approach in which the sediment transport rates are computed using a sediment transport capacity formula 1 1 ε z b t s x x s y y 0 where ε is the bed porosity zb is the bed level t is time sx is the sediment transport rate in the x direction and sy is the sediment transport rate in the y direction in river bends the stream lines have a spiral shape with important vertical flow components near the banks the maximum flow velocity is shifted towards the outer bend altering the bed shear stress direction this affects the sediment transport direction with relevant consequences for the computation of channel bed topography struiksma et al 1985 another factor influencing the sediment transport direction is gravity which is particularly relevant for bed load if the bed is sloping the presence of bars and pools produces important transverse slopes which should be considered by the model the sediment transport direction is therefore corrected by taking into account both the spiral flow and the gravity effects following koch and flokstra s 1980 formulation 2 tan α s sin α t 1 f z b y cos α t 1 f z b x where αs is the direction of sediment transport and αt is the direction of bed shear stress f is a user defined tuning parameter which we computed according to talmon et al 1995 3 f a shld θ bshld d 50 h cshld where θ is the shields parameter d50 is the median sediment grain size h is the local water depth and ashld bshld and cshld are calibration coefficients the model represents bank erosion by transferring a fraction of the erosion occurring at every wet cell to the adjacent dry cell if present which then becomes wet and is then incorporated in the water flow and morphological computations van der wegen and roelvink 2008 for the pilcomayo river 80 of the erosion computed for a cell at the bank toe is transferred to the adjacent floodplain cell with the result of enlarging the wet channel width the effects of vegetation on water flow and sediment transport are taken into account by adjusting the flow resistance as a function of vegetation characteristics two roughness coefficients are computed the global chézy coefficient for the derivation of the depth averaged hydraulic variables and a chézy coefficient of the soil among the plants for the derivation of the bed shear stress and the sediment transport rate following baptist s formulation baptist et al 2007 the method distinguishes between submerged and emerging vegetation plants are represented as vertical rigid cylinders vargas luna et al 2016 with specific density height and diameter the flow velocity is considered uniform through the plants but following a logarithmic vertical profile above the canopy the total shear stress is assumed to be composed of two components 4 ρ g h i τ b τ v in which ρ is the water density g is the acceleration due to gravity h is the local water depth i is the longitudinal water surface slope τb is the bed shear stress and τv is the extra shear stress caused by the presence of vegetation for emerging plants the water depth h is smaller than the plant height hv in this case the two stresses can be written as 5 τ b ρ g c b 2 u v 2 6 τ v 1 2 ρ c d m d h u v 2 where cb is the chézy coefficient of the un vegetated bed uv is the flow velocity through vegetation cd is the drag coefficient of the plants m is the vegetation density per unit area and d is the representative stem diameter the product md being the canopy density a defined by nepf 2012 the global chézy coefficient cr is obtained by combining the two equations with the chézy equation u v c r hi leading to 7 c r 1 1 c b 2 c d m d h 2 g emerging v e g e t a t i o n if the plant height is smaller than the local water depth submerged vegetation the flow is assumed to be split in two parts the flow through the plants and the flow above the canopy in this case 8 c r 1 1 c b 2 c d m d h v 2 g g κ l n h h v submerged v e g e t a t i o n in which κ is the van kármán constant κ 0 41 and hv is the plant height the bed shear stress τb is computed as 9 τ b ρ g c b 2 u 2 where u is the depth averaged flow velocity for which u c r hi and c b is the chézy coefficient of the soil among the plants which is used to compute the bed shear stress and the sediment transport rate in the vegetated areas its value is a function of cb the chézy coefficient of the un vegetated bed corrected to take into account the effects of vegetation which is obtained as 10 c b c b g κ l n h h v 1 c d m d h v 2 g for emerging vegetation c b c b 3 2 model set up considering the significant planimetric changes that occurred in the study area three distinct numerical models were constructed to represent the pilcomayo river in three different periods of time for which long and complete daily data series are available 1972 1973 1980 1981 and 2017 2018 the historical river models 1972 1973 and 1980 1981 were meant for calibration and validation purposes the model of the river in 2017 2018 was used as the morphological starting point for the study of the climate scenarios the following satellites images were used to reconstruct the historical river bank alignments periods 1971 1972 and 1980 1981 landsat 1 3 level 1 retrieved from united station geological survey at https earthexplorer usgs gov period 2017 2019 landsat 8 level 1 retrieved from united station geological survey at https earthexplorer usgs gov in the study reach the bankfull river width between 100 m to several hundreds of meters landsat 1 3 level 1 images have a resolution of 60 m therefore a minimum of 1 full pixel or 1 67 pixels to a maximum of about ten full pixels fit the river width this is enough to recognize and depict the main river channel bankfull width landsat 8 level 1 images have a resolution of 30 m therefore the river width is depicted with a minimum of 3 full pixels or 3 33 pixels the river banks were manually depicted the resulting historical river planimetries are shown in fig 3 topographical elevations were derived using the alos advanced land observing satellite dem of 2011 with resolution of 12 5 12 5 m2 covering an area of 30 km2 downloaded from https www asf alaska edu sar data palsar terrain corrected rtc irregularities in the dem were smoothed out using arcgis s geoprocessing tools process that was finalized using the quickin tools of the delft3d software package the spatial distribution of floodplain vegetation was obtained from the google earth images 1984 to 2016 in a straightforward way by defining the contourlines of the areas presenting the same vegetation cover the current plant characteristics were derived from local photos and simple field observations indicating that floodplain vegetation in the study area can be classified as semi open shrub constituted by 3 m high plants with a density of approximately 7 stems m2 data on growth rates conditions for germination establishment and decay as well as root characteristics of floodplain vegetation are missing this lack of data makes impossible to model the interaction between plant dynamics variations in vegetation characteristics due to colonization growth and decay of plants and the morpho dynamics of the pilcomayo river o hare et al 2016 pasquale et al 2014 perona et al 2012 caponi et al 2020 indicate that vegetation does not establish on migrating bars in case of high uprooting rates during floods the pilcomayo presents powerful and relatively frequent flood events with bars that appear and disappear very quickly this extremely high morphodynamics results in regular removal of sprouts from bars point bars and channel margins fig 1 shows the almost complete absence of vegetation growth on these areas instead vegetation is present on the river floodplains where is appears as a rather uniform semi open shrub it is therefore appropriate to suppose that plant dynamics does not influence the current morphological developments of the pilcomayo river channel in a significant way boothroyd et al 2021 the model domain was discretized in more than 27 000 cells with dimension between 12 15 and 30 30 m fig 3 the upstream boundary conditions consist of water and sediment inflows water inflow is made up of a daily discharge time the sediment inflow is computed as local sediment transport capacity derived as a function of flow velocity particle size bed roughness and other parameters adopting the best performing sediment transport formula van rijn 1984 due to the absence of measured water levels time series at a location close to the end of the model domain the downstream boundary conditions are water levels and sediment outflows being calculated by the model assuming uniform flow the initial bed topography of each historical model was derived numerically it was obtained by running the model for the last 18 months before starting the scenario runs using the measured daily discharges spin up runs before this a preliminary channel was created by lowering the levels in the area between the river banks by 2 5 m summarising the three historical model setups have different initial river bank alignment and bed topography floodplain vegetation cover distribution and different upstream and downstream boundary conditions but the same numerical grid sediment transport formula and physical parameters either derived from the calibration procedure or from physical considerations 3 3 model calibration and validation model calibration was carried out by optimizing the values of several coefficients to best reproduce the river morphological behaviour in the period 1972 1973 imposing initial morphological conditions corresponding to the river alignment of 1972 and model generated 2d bed topography the upstream boundary conditions of this model were the series of daily discharges measured in the same period the sediment input rate was computed as a function of incoming discharge the chosen calibration period can be regarded as a typical hydrological year of the pilcomayo river with a maximum discharge of 1 362 m3 s and an average discharge of 173 m3 s vegetation described by plant height representative stem diameter and density was assumed to be equal to the current climatic condition section 3 4 but with the 1984 spatial distribution derived from google earth lack of historical information on floodplain vegetation prevented us to define the vegetation distribution before 1984 in the calibration process special attention was paid to obtain a good characterisation of the river dynamics represented by the temporal variations of maximum water depth measured at the deepest point thalweg in the monitored cross section the river pilcomayo does not have a dominant horizontal bed structure on which to calibrate a 2d model because its bed topography changes with high speed every day showing daily appearance and disappearance of bars and shoals as a response to discharge variations fig 2 and fig 3 it was therefore meaningful to calibrate the model in such a way that it captures the measured river dynamics compared to the cross section averaged bed level the thalweg level incorporates some information on cross sectional shape for instance the average bed level hardly responds to the formation of bars the presence of alternate bars would deepen the thalweg without changing the average bed level significantly moreover the thalweg would be deeper with alternate bars rather than with central or multiple bars crosato and mosselman 2009 besides the temporal variation of the maximum water depth calibration was based also on the temporal variations of the wet cross sectional area and on the yearly volume of transported sediment on the basis of the best performance compared to measured data to decide which calibration simulation is the best performing one a multi criteria analysis was carried out by computing the coefficient of determination r2 the root mean square error rmse and the mean absolute error mae relative to wet area and maximum water depth of the cross section for each specific calibration run by comparing computed and measured values moriasi et al 2015 the calibration parameters are the following chezy s coefficient of bare bed the same value for main channel and floodplain soil corresponding to cb in equations 4 10 chezy s coefficient of the vegetated floodplains the baptist s method allows deriving two values of chezy s coefficient from the bare bed roughness coefficient cb and the plant characteristics one to be used for the computation of the hydrodynamic characteristics either equation 7 or 8 and the other one for the bed shear stress equation 10 transverse slope effects on the sediment transport direction where ashld αs and αt are calibration parameters equations 2 and 3 multiplication factor for suspended sediment concentration formula of van rijn 1984 multiplication factor for bed load transport vector magnitude of the formula of engelund and hansen 1967 the downstream boundary conditions affect not only the flow distribution and the morphological changes in the last part of the model domain but might gradually impact also the areas more upstream if undesirable backwater effects are created for this reason due to the absence of water level measurements close to the model boundary the calibration process included also the selection of the best performing downstream boundary condition model validation was carried out to assess the model performance based on an independent set of data i e on the morphological changes that occurred in the period 1st january 1980 to 28th february 1981 starting from the 1980 channel alignment and model generated bed topography the model was run using the daily discharges measured in the same period with the values of calibration coefficients derived from the calibration procedure and with the spatial distribution of vegetation of 1984 and plant characteristics of current climate described in section 3 4 3 4 climate scenarios sperna weiland et al 2012 estimated a 25 discharge reduction in december january and february wet season a 30 reduction in march to august and a 20 reduction in september to november dry season in the study area to have a mirror condition for comparing purposes we consider also a wetter climate wet presenting the same percentages of discharge variations of the projected scenario but in opposite direction this means that we consider three different hydrographs fig 4 1 the one representing the current situation base case q bc corresponding to the series of discharges measured in the period september 2017 to august 2018 2 a constructed dryer hydrograph q dry 3 a constructed wetter hydrograph q wet the current total yearly runoff is 9 935 mm3 the one relative to the constructed wet hydrograph is 12 598 mm3 26 8 whereas for the constructed dry hydrograph the total yearly runoff is 7 272 mm3 26 8 due to expected differences in soil moisture the drier climate is assumed to also present reduced floodplain vegetation mass anadón et al 2014 stocker et al 2013 the wetter climate increased vegetation mass van oorschot et al 2018 more specifically considering that the current floodplain vegetation in the area is a semi open shrub we assume that this would turn into open shrub for the climate becoming drier and into close shrub for the climate becoming wetter in total we consider four vegetation scenarios since we also include a case without floodplain vegetation the present distribution of floodplain vegetation is used for all scenarios according to observations and to baptist and de jong 2005 we introduce the following plant heights and canopy densities in the model for the semi open shrub 3 m high plants with a canopy density of 0 07 m 1 corresponding to the current plant characteristics for the open shrub 2 5 m high plants with a canopy density of 0 034 m 1 for the close shrub 3 5 m high plants and canopy density of 0 102 m 1 all plants have a representative stem diameter of 0 01 m finally we assume the drag coefficient of the plants to be cd 1 as suggested by vargas luna et al 2016 regarding vegetation dynamics in terms of vegetation colonization growth and decay it is supposed that these processes do not affect the morphological developments of the pilcomayo river in a significant way also for the moderately drier and wetter climates in drier climates vegetation grows slower and is less dense this diminishes the mutual protection offered by plants enhancing bed erosion around plants and eradication partly counterbalancing the flow reduction although in drier climates the flood intensity might increase see discussion in wetter climates vegetation grows faster and denser but at the same time the water flow increases partly counterbalancing the increase in plant resistance note that this is only valid for moderate climate changes the bare soil of the floodplains among the plants is assumed to have the same roughness as the main channel bed for which we assign the calibrated value of chézy coefficient cb 60 m1 2 s this is used to compute the hydraulic variables and bed shear stress for the case without vegetation it is also used to compute the bed shear stress if plants are emerging but if vegetation is submerged the model computes the bed shear stress using cb equation 10 note that for vegetated areas the hydraulic variables such as the depth averaged flow velocity and the water depth are computed using the global chézy coefficient cr eqs 7 and 8 the spatial distribution of vegetation is assumed equal to the present one derived from google earth for all climatic scenarios the sediment input rates coincide with the transport capacity of the incoming flow computed using van rijn s 1984 formula and depend thus on discharge regime this approach neglects wash load i e the sediment transported in suspension with size of the order of several micrometres clay and silt this sediment does not affect the morphology of dynamic rivers and can thus be neglected from this study focusing on river channel adaptation in total we simulated eight scenarios combining the three discharge hydrographs current wetter and drier with the three different classes of vegetation plus one case without vegetation table 2 the analysis of combinations of these scenarios allows isolating the effects of discharge vegetation and climate all scenario runs started from channel alignment and model generated bed topography of the year 2017 4 results of model calibration and validation the best performing set of input parameters was identified based on 49 runs each one differing in the value of one or more calibration coefficients or parameters which were always falling within their physics sound range as an example the range of values of chézy s coefficient considered in the calibration runs was derived from the results of previous hydrodynamic computations performed using manning s coefficient baldissone et al 2013 brea et al 2014 testa tacchino 2015 concluding that the values to be used for the pilcomayo river in the study area fall between 0 018 s m1 3 and 0 020 s m1 3 which correspond to chézy s coefficients in the range of 50 to 65 m1 2 s with the highest values for high flow conditions the sediment particle diameter was optimized by considering only values falling within the measured range to comply with the estimated value of total yearly sediment transport fernández and garcia 2017 the calibration phase also included the selection of the sediment transport formula note that the sediment transport formula affects not only the sediment transport rates in the study area but also the sediment inputs from upstream and the speed of the morphological developments about the correction of sediment transport direction due to spiral flow and gravity eq 3 we calibrated the coefficient ashld being the one that mostly affects the river bed topography whereas the other two coefficients were given their default values bshld 0 5 and cshld 0 3 the time step used in the computations was nine seconds selected based on preliminary runs the results of the calibration runs show that the best performing downstream boundary condition is the water level recomputed at each time step assuming uniform flow with a value of chézy s coefficient equal to 60 m1 2 s this is the calibrated value of the roughness coefficient for the un vegetated river bed and floodplains composed of sediment having diameter equal to 0 1 mm the best performing value of the coefficient weighing the effects of gravity on sediment transport direction ashld is 0 5 corresponding to a relatively high sediment transport deviation towards the deepest areas of the river bed baar et al 2019 the best performing sediment transport formula is the one developed by van rijn 1984 which is particularly suited for sand bed rivers and distinguishes bed load from suspended load fig 5 a illustrates the results of model calibration with remarkable values of r2 and normalized root mean square error nrmse for the maximum water depth in cross section a location indicated in fig 3 particularly after calibration the error is limited to 19 the mae relative to maximum water depth resulted in 0 31 m and the mae relative to cross sectional wet area in 31 34 m2 the results of the validation run are shown in fig 5b and fig 6 fig 5b illustrates the simulated water depth versus its corresponding measured values showing values of r2 and normalized root mean square error nrmse being similar to the ones of the calibration period additionally fig 6 depicts the comparison between measured and computed bed levels showing a high quality performance of the model the simulated bed levels follow well the pattern of observed data indicating that the model can successfully reproduce the observed cross sectional morphological adaptation of the river 5 results of scenario runs 5 1 effects of discharge and vegetation on main channel cross section fig 7 shows the cross sectional profiles at high flow conditions february 4th 2018 fig 4 in this case the main channel width coincides with the river bankfull width e g vargas luna et al 2019a wilkerson and parker 2011 for smaller discharges the model would give the width and the depth of the water flowing within the main channel which would not represent the channel size but just the lateral and vertical dimensions of the wet area at that particular flow rate moreover at flows smaller than or equal to the bankfull discharge the water would not flow through the side channels making them hard to be recognized visualized from the model results fig 7a indicates the effects of floodplain vegetation since it presents the results of four runs with the same water and sediment inputs hydrograph q bc corresponding to the base case flow and different floodplain vegetation characteristics the cross sectional profiles show that higher vegetation mass veg thin green line enhances levee formation and concentrates the water flow in the main river channel as a result the channel becomes deeper complying with the observations of gurnell 2014 lower vegetation mass veg dotted green line results in more distributed sediment deposition over the floodplains and in a shallower channel in this scenario the channel of the pilcomayo presents a shift of a few tens of meters toward the right bank of the river due to enhanced bank erosion and sediment deposition near the opposite bank finally the extreme scenario in which vegetation is absent results in a relevant main channel shift to the left and in the formation of a small secondary channel to the right noveg black dotted line the main channel is wider and shallower and presents a central bar this is due to morphodynamic instability triggered by the high width to depth ratio of the flow e g crosato and mosselman 2020 the irregular cross section is a clear indication of channel braiding leopold and wolman 1957 fig 7b shows the effects of having a different discharge regime the results of the scenarios with the current floodplain vegetation characteristics veg indicate that higher discharges wet dotted blue line produce a deeper channel contained by larger levees smaller discharges dry dotted red line produce a shallower channel and smaller levees due to the presence of vegetation on banks and floodplains the width of the channel appears to be only slightly influenced by the discharge regime however this conclusion is only valid for moderate changes in water flow as in the studied scenarios with well developed floodplain vegetation as in the study area the smaller discharge regime does not alter the channel width whereas the channel presents some widening with the largest one this is due to the higher near bank flow velocities that are capable of eroding banks despite the presence of vegetation 5 2 effects of climate change on channel cross section and river fluvial style fig 8 shows the cross section a profiles that are obtained for the three considered climate scenarios on different days the extremely fast adaptation of the cross sections of the pilcomayo river fig 2 well reproduced by the model fig 5 allows relating the computed cross section profiles to the discharge of the day almost no differences between climate scenarios can be observed at the start of the simulations when the flow is very low for all the three scenarios e g on 1 september 2017 in fig 4 the quick morphological adaptations that occur during the flood season january to march 2018 result in a systematically wider channel for the drier climate and in a systematically narrower channel for the wetter climate scenario the three climate scenarios present a similar channel depth at low flows however the depth is substantially larger with the wetter climate scenario at the highest discharges which is due to the higher flow rates and the denser vegetation which appears to successfully limit bank erosion the result of the wet climate scenario is thus a higher transient channel excavation of 20 respect to the current scenario fig 8c at the end of the wet season fig 8f when the flow is low again the wet areas are similar for all the three considered climates sediment deposition occurring during the falling limb of the flood waves results in a similar bed level rise for all the three climates since more sediment is transported and thus deposited with the wetter climate instead the width is maintained and our results indicate that the bankfull width can be expected to increase by 35 45 in 2100 due to the forecasted climate change fig 8b f fig 9 shows the yearly sand transport rates of the river for all the considered scenarios an increase in sediment transport rates can be expected if the climate becomes wetter 46 1 a decrease if the climate becomes drier 39 1 fig 9 allows also detecting the effects of changes in floodplain vegetation in combination with the present discharge hydrograph green bars either a higher or a lower vegetation mass would increase the yearly sediment transport rates a denser vegetation veg would increase the sediment transport capacity of the flow by enhancing its concentration and velocity in the main channel 3 9 a lower floodplain vegetation mass veg would increase the sediment input through a slight increase in bank erosion 0 3 a similar effect of vegetation is found in combination with the drier hydrograph red bars instead a larger vegetation mass veg would but only slightly decrease the yearly sediment transport rate in combination with the wetter hydrograph blue bars this is mainly due bank erosion zeroing finally it is important to consider that these results exclude wash load including the finest part of the sediment transported by the flow would not affect the configuration of the main river channel but would result in higher floodplain sedimentation rates with deposition occurring further away from the main channel margin than sand fig 10 shows the water coverage in the study area with the present discharge hydrograph but without floodplain vegetation on february 4th 2018 peak flow of 3 934 m3 s on that day being the discharge above bankfull it is possible to detect the presence of channels excavated through the floodplains in this case the river presents multiple channel excavation and main channel shift resulting in a braided system with substantial straightening the present channel sinuosity is 1 3 calculated as average sinuosity in the period 1972 2017 table 1 while the predicted sinuosity without floodplain vegetation under the bc noveg scenario is 1 1 fig 10 considering that the downstream boundary conditions water levels and the upstream boundary conditions 2d flow distribution are the same river straightening means also steepening of the longitudinal water level profile and indeed the longitudinal slope increases from 0 038 present situation table 1 to 0 044 fig 10 6 discussion the model covers one hydrological year to shows how the river cross section evolves with different climatic and vegetation settings since the morphodynamic response of rivers is complex and depends on sequences of floods and dry periods we needed a real hydrograph as basis to construct the drier and wetter scenarios in fact we could not reproduce the morphodynamic river response with annual or seasonal mean streamflows additionally the choice of covering one year is justified by the intrinsic morphodynamics of the pilcomayo river our case study this river has such a strong dynamic that the cross section drastically changes every day as a response to the discharge variation for this reason and after having well reproduced this behavior with the model and analyzed its morphodynamics chapter 5 we decided that we can link the cross section that is measured in one day to the discharge ultimately this work does not want to forecast the pilcomayo river morphology due to global change but more in general to disentangle the river response to plausible dryer and wetter scenarios a specific further study on how the pilcomayo will evolve in the future due to climate change would be certainly an important contribution in our model sediment input is computed as a function of inflow characteristics using the sediment transport formula of van rijn 1984 which includes suspended load and is particularly appropriate for fine sand as all transport capacity formulas van rijn s does not include wash load i e the transport of very fine material silt and clay which is supply limited rather than capacity limited thus the decrease in discharge characterizing the dry climate also results in reduced sediment input to the study area whereas for the wetter climate our model predicts larger sediment inputs wash load supply is mainly related to soil erosion in the river catchment in this study we do not consider the effects of changing climate on sediment production pitlick et al 2012 verhaar et al 2010 the reduction of vegetation cover due to a drier climate is expected to result in increased soil erodibility in the river catchment and larger sediment inputs to the river the transport of sand which is capacity limited is expected to decrease if the discharges decrease fig 9 however dry climates often present extreme discharge variations due to rainfall concentration in brief periods so it is not clear whether higher but shorter discharge peaks would actually increase or decrease the total bed load in the river as a result of an increase in sediment load we can expect enhanced bed aggradation to occur where the slope of the river decreases further enhancing the tendency towards a braided style at these locations germanoski and schumm 1993 a wetter climate would have opposite effects i e reduction of sediment production enhancing a meandering style gurnell 2012 the effects of vegetation on hydraulic resistance sediment transport and bed erosion are included in the model in a static way by assuming a certain distribution of plants with constant characteristics height density representative diameter on the floodplain depending on scenario however vegetation processes colonization growth decay are known to interact with the river dynamics caponi et al 2020 van oorschot et al 2016 and are affected by climate liu and lei 2015 roerink et al 2003 lack of data and the choice to concentrate the analysis in one hydrological year do not allow including vegetation dynamics this means that our work does not represent the transition period i e when the river channel evolves until the characteristics of the floodplain vegetation reach the configuration expected in the future climate by including the effects of vegetation on water flow and sediment transport the model indirectly reproduces also part of the protecting effects of plants on river banks due to the higher roughness caused by riparian vegetation the main flow is deflected towards the centre of the channel and the near bank flow velocity as well as the near bank bed shear stress are reduced this decreases erosion of the river bed near the bank which our model partially converts in bank erosion van der wegen and roelvink 2008 and enhances levee formation crosato and saleh 2011 the model ignores bank strengthening by roots and bank reinforcement by slump blocks that armour cut banks in addition the model does not account for vegetation dynamics in terms of colonization growth and decay of plants this becomes important in river systems where plants have the possibility to colonize emerging bars and banks during low flows and have the time to grow strong enough to resist the next flood serlet et al 2018 in rivers where plant dynamics plays a role this is found to enhance bank accretion and opposite bank erosion which results in increased river meandering vargas luna et al 2019b as previously described measured data on plant colonization growth temporal changes in plant density etc are lacking the only vegetation data available for this study is the type of vegetation that is dominant in the area whereas we derived historical floodplain vegetation cover distribution from satellite images vegetation dynamics depends not only on plant species but also on climate soil type and moisture which means that we could derive this information from studies carried out elsewhere along the pilcomayo vegetation is mainly present on the floodplain and rarely on bars a clear sign that vegetation processes are governed by the river dynamics and do not play a relevant role in the cross sectional dynamics of the river vargas luna duró et al 2019b showed that colonization of emerging bars by vegetation increases opposite bank erosion but does not affect channel width and depth focus of this research not considering vegetation dynamics could be a shortcoming in the generalization of the results for sand bed rivers in different climatic settings moreover considering that the interaction river vegetation is affected by scale gurnell 2014 we conclude that our study case and the results herein presented are strictly representative of rivers having size compared to pilcomayo s located in similar climatic settings and having similar hydro morphological conditions in any case our results indicate the right trends of river morphological variations under moderate climate change in general and that our results can be used as a guidance to include climate change effects in forecasting the long term evolution of rivers the results of this study provide also a reference tool to analyse past changes of river environments assuming no human influence the results provide also an insight to predict the effects of combinations of interventions for instance regarding floodplain vegetation management e g gonzález et al 2017 and alterations of the river discharge on the width and depth of the main river channel e g su et al 2021 a recent study chen et al 2019 shows that the hydrological regime leaves an imprint on the longitudinal profile of rivers in particular based on nasa data sets and numerical modelling chen et al 2019 show that drier climates aridity reduce the river sinuosity and produce steeper longitudinal slopes our results show that the absence of floodplain vegetation increases the longitudinal slope of the river through channel straightening as a result of river braiding fig 10 overall a light flow straightening is also obtained for the moderately drier climate see table 3 thus our results appear to support chen et al s observations the central region of the study area has remained straight for at least the period covered by our study 1972 2018 we do not have data explaining this which might be due to either artificial or natural vegetation bank reinforcement or to the characteristics of the bank material in that region to explain this we recommend carrying out some field investigations focusing on the characterization of the river banks 7 conclusions this numerical study analyses the adaptation to climate of sand bed rivers considering the pilcomayo as an example for the climate scenarios we considered the 2100 projections of the intergovernmental panel on climate change ipcc special report on emission scenario a1b hereafter named as the sres a1b scenario stocker et al 2013 our model reproduces historical cross sectional changes that follow the measured ones which gives confidence in our results we then used the model to assess the response of the main river channel to climate change considering the forecast for the year 2100 as well as its opposite the river climate being described by a combination of hydrological regime and floodplain vegetation characteristics the main finding of this investigation results from the analysis of the either combined or separate effects of alterations in discharge regime and floodplain vegetation both resulting from climate change these alterations interact with each other and affect the river morphology in a non linear way complicating the analysis of their single roles in the process of climate adaptation our results show that for moderate climate changes vegetation governs the river channel width whereas discharge in presence of floodplain vegetation mainly affects the main channel depth and the levee formation previous works not considering the role of riparian vegetation found a much stronger effect of discharge alteration on channel width e g vargas luna et al 2019b the difference is mainly due to having now considered the effects of plants on river banks which is obtained in our model only partially since the strengthening effects of roots and the mechanical reinforcement of slump blocks that shelter failed banks and limit further erosion are not considered due to this we can expect plants to have an even stronger role in governing the river width than our results are able to demonstrate previous works have shown that floodplain vegetation growth lead to important changes of the river morphology which even result in a different fluvial style for instance from braiding to meandering e g crosato and saleh 2011 gurnell 2014 tal and paola 2010 villada arroyave and crosato 2010 this is confirmed also by the results of our study showing that without vegetation the pilcomayo river would be braided summarising we find that for sand bed rivers in temperate climates a moderately dryer climate characterized by reduced water flow and scarcer floodplain vegetation will result in a shallower and wider water course with floodplains and banks that are more prone to erosion the projected change for the pilcomayo river in 2100 is a consistent bankfull width increase by 35 45 respect to the current scenario a moderately wetter climate characterized by increased water flow and denser floodplain vegetation during floods will produce a transient deeper channel by 20 respect to the current scenario whereas channel widening will be limited by vegetation offering a more effective protection to cut banks 8 research data the national hydrological network of argentina has records for daily discharge water level and cross sectional profile at the station of misión la paz in front of pozo hondo 22 22 38 s 62 31 24 w from 1960 to 2018 the time series of discharges and water levels were downloaded from http bdhi hidricosargentina gob ar the time series of the cross section was downloaded from www pilcomayo net the webpage of the tri national committee for the development of the pilcomayo river basin sediment data including sediment characteristics are also available from several documents at www pilcomayo net the models are freely downloadable from the website of ncr netherlands centre of river studies https ncr web org credit authorship contribution statement a crosato conceptualization methodology validation resources formal analysis writing original draft writing review editing supervision project administration a grissetti vázquez methodology software validation formal analysis investigation data curation writing original draft visualization f bregoli conceptualization validation formal analysis writing original draft writing review editing visualization supervision m j franca writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments alberto grissetti carried out this research with funds from the world meteorological organization fellowship programme francesco bregoli received funding from the ec marie curie individual fellowship h2020 priority excellent science grant number 606838 the authors wish to thank dr sergio capapé jacobs uk formerly at universitat politècnica de catalunya for his important suggestions dr paolo paron ihe delft and dr alessandro ielpi laurentian university for reviewing an early version of the manuscript and to the national committee of the pilcomayo river in paraguay for providing access to their database 
2995,climate change has a direct influence on both hydrology and floodplain vegetation of water courses which are key players in river morphodynamics the river system response to climate change is complex and the effects of non linear interactions between alterations in water sediment and vegetation remain incompletely understood which of these components becomes dominant in shaping the river channel when climate becomes drier or wetter to answer this question we investigate the cross sectional response of sand bed rivers to climate change focusing on channel width and depth which respond directly to changes in boundary stresses thanks to the exceptional availability of long time series of daily discharge and cross sectional profiles the pilcomayo river is an ideal living lab for this investigation we constructed a two dimensional model of the river using the open source state of the art structured delft3d code the highly dynamic behaviour and quick morphological adaptation of the pilcomayo allowed reducing the period of time covered by the simulations because the river cross section adapts its morphology to a new value of the water discharge within hours or days which is crucial for modelling investigations calibration and validation were successfully performed by comparison with historical data we considered several scenarios representing current dryer and wetter climates the results show that a dryer climate reduces the river channel depth and enlarges the width a wetter climate increases the channel depth but produces negligible widening vegetation sparser with a drier climate and denser with a wetter climate is found to control the channel width this analysis is unique and shows which alterations can be expected in alluvial sand bed rivers with natural vegetated banks due to climate change keywords alluvial river pilcomayo river climate change floodplain vegetation river morphodynamics data availability data will be made available on request 1 introduction changing climate affects terrestrial landscapes baker 1995 yang et al 2003 and their components through alterations in precipitation and temperature which directly affect water quantity and quality soil erosion soil moisture and vegetation cover masson delmotte et al 2018 seneviratne et al 2006 sperna weiland et al 2012 trenberth 2011 increasingly frequent extreme events such as floods and draughts combined with deforestation have already intensified sediment production and will govern the future geomorphological trends baker 1995 borrelli et al 2017 cai et al 2014 rivers have a primary role in transport and distribution of water sediment and nutrients sabater et al 2018 wohl et al 2015 alterations in their discharge regime and sediment production church 2006 induce changes in their morphology and dynamics with consequences for the water conveyance and sediment transport grams and schmidt 2005 kondolf 1997 wilby et al 2008 as well as for the quality of their ecosystems wohl et al 2015 floodplain vegetation plays a significant role on the morphological adaptation of rivers gurnell 2014 tal and paola 2010 since it affects the water flow distribution and sediment transport during floods lightbody et al 2019 villada arroyave and crosato 2010 wang et al 2015 protects banks and emerging bars against erosion micheli and kirchner 2002 rominger et al 2010 thorne 1982 and creates the conditions for new floodplain formation hupp and simon 1991 as a result dense vegetation growth on river banks and floodplains reduces the river braiding degree and promotes river meandering crosato and saleh 2011 gibling and davies 2012 gurnell 2014 2012 nardi et al 2013 solari et al 2016 tal and paola 2010 ward et al 2000 isolated trees as well as sparse patchy vegetation however might split the flow promoting the excavation of channels through the floodplain and main channel bifurcation as well as enhancing local bank instability coulthard 2005 ielpi and lapôtre 2019 vargas luna et al 2019b however at the same time floodplain vegetation growth also increases the water levels during floods villada arroyave and crosato 2010 by directly affecting the river discharge regime sperna weiland et al 2012 floodplain vegetation baker 1995 dale et al 2001 and sediment production lane et al 2007 climate change is thus expected to also modify the river morphology this might have important consequences not only for the river landscape and ecosystem but also for the river conveyance the water accessibility the safety of structures the frequency of floods and the human activities this shows the relevance of anticipating and understanding river adaptation to climate change which still remains a challenge harrison et al 2019 reproducing the long term river response to climate changes in the laboratory by combining the effects of altering discharge sediment input and vegetation requires a substantial effort for this if sufficient data are available computational approaches represent a valid alternative arboleda et al 2010 siviglia and crosato 2016 among the different types of water courses sand bed rivers show highly reactive responses to external drivers they quickly adapt their alluvial channel to variations in discharge and sediment input through deposition scouring widening and narrowing martín vide et al 2019 sarker et al 2014 moreover sand bed rivers generally present full sediment mobility and their bed material can be assumed uniform singh et al 2017 for this simulating their morphological adaptation does not require excessively long computational times which makes these systems ideal case studies to investigate the effects of changes in the main drivers of river morphology in the present research we investigate how climate change affects the cross section and particularly the width and depth of a natural sand bed river using a two dimensional numerical model of the pilcomayo river at a location near the border between paraguay and argentina we look at two of the main drivers of channel morphology which have a direct dependency on climate river flow and floodplain vegetation this study is made possible by the availability of a unique set of data containing long time series of daily cross sectional profiles and corresponding discharges in addition due to a bed composition of fine sand the pilcomayo river displays an extraordinary high dynamism martín vide et al 2019 with fast adaptation to new environmental conditions which allows estimating its morphological response to water flow and vegetation alterations with rather quick computations covering relatively short periods of time we consider moderate climate changes corresponding to the 2100 projections of the intergovernmental panel on climate change ipcc special report on emission scenarios a1b hereafter named as the sres a1b scenarios stocker et al 2013 based on which sperna weiland et al 2012 derived the corresponding monthly changes in river discharge world wide by running a multi model ensemble of 12 general circulation models with the global hydrological model pcr globwb van beek and bierkens 2009 for the pilcomayo river this scenario results in 20 30 of flow reduction sperna weiland et al 2012 for sake of comparison the scenarios analysed in this study are the present climate the projected drier climate for the year 2100 as well as the opposite wetter climate each scenario is represented by a water discharge regime derived from the work of sperna weiland et al 2012 affecting also the input output of sediment in the study area and floodplain vegetation the three adopted discharge scenarios represent well the range of variability that more recent global change scenarios displayed for instance montroull et al 2018 analysed the impact of adopting several representative concentration pathways rcps van vuuren et al 2011 on future streamflow scenarios in la plata basin where the pilcomayo lays their conclusion is that the percentage of change in annual mean streamflow in the basin is between 20 to 25 these values are in line to our dry and wet scenarios there are no quantitative studies on how on going global warming will change vegetation but observations show that richer vegetation is found in wetter climates and sparser vegetation in drier climates anadón et al 2014 van oorschot et al 2018 the vegetation scenarios considered in this study are based on these observations which means that floodplain vegetation is assumed to be higher and denser with the considered wetter climate sparser and shorter with the drier climate 2 the pilcomayo river the pilcomayo river flows south eastwards from the andes to the paraguay river a tributary of the paraná for 1 100 km its basin is part of the la plata basin the second largest one in south america after the amazon martín vide et al 2014 the study area is an 8 km long river reach of the lower pilcomayo near the border between paraguay and argentina this zone includes the gauging station misión la paz argentina where the river has a catchment area of 96 000 km2 at this location the pilcomayo divides the argentinian village of misión la paz from the paraguayan village of pozo hondo whereas a 220 metre long international bridge connects the two communities the study reach starts 4 km upstream and ends 4 km downstream of this bridge the river has a meandering style and no tributaries fig 1 it has a mild slope about 0 03 an average main channel width varying from 75 m to some hundreds meters as a function of discharge and wide floodplains covered by sparse vegetation mainly consisting of semi open shrub at low flow conditions the river bed presents many sand bars and areas of lateral sediment deposition fig 1 the river bed material is fine sand with particles ranging between 0 1 and 0 2 mm as indicated by pool and van duijne 1996 the yearly sediment transport rate of this reach of the pilcomayo river is estimated in 140 million tons year for 89 composed of silt and clay wash load not contributing to the morphological changes of the river channel in the study area and thus not considered in this study and for 11 of fine sand martín vide et al 2014 according to the updated köppen geiger classification peel et al 2007 the climate of the pilcomayo basin is temperate with total yearly precipitation ranging between 400 and 500 mm upper basin and 700 1 200 mm lower basin and yearly averaged temperatures of 9 5 c and 23 3 c respectively halcrow serman associados 2006 as far as 90 of the annual precipitation occurs in the period mid november to mid march concentration of rainfall in such a short time causes two physical processes outstanding in the entire basin large floods and intense fluvial erosion deposition pool and van duijne 1996 an important part of the river catchment lies inside the gran chaco a hot semi arid lowland region between the andes and the paraguay river with poor vegetation cover and high soil erodibility the national hydrological network of argentina has records of daily discharges water levels at the station of misión la paz covering the periods november 1960 to august 2018 and september 1964 to july 2019 respectively at this location the maximum recorded discharge is 4 585 m3 s in march 1984 and the minimum is 1 4 m3 s in october 1972 the mean annual discharge being 212 m3 s the wet season is from december to march the maximum value of monthly discharge is 648 m3 s and it corresponds to february while the month with less discharge is september with an average discharge of 22 m3 s the strong flow variability combined with a highly erodible bed composed of fine sand and sparse riparian vegetation makes the lower pilcomayo a notoriously dynamic river with cross sections responding very fast to flow variations capape and martin vide 2015 martín vide et al 2014 pool and van duijne 1996 this can be observed in the video provided by martín vide et al 2019 as supplementary material https ars els cdn com content image 1 s2 0 s0022169419305888 mmc1 mp4 retrieved the 1st december 2020 this is clear also when analysing the daily cross sectional data collected by the tri national committee for the development of the pilcomayo river basin at the two locations near misión la paz in the period 1972 2019 fig 2 as consequence of bank erosion rates also the channel alignment continuously changes fig 3 the current reach scale characteristics of the pilcomayo river in the study area are summarized in table 1 3 materials and methods the analysis of daily data series covering long periods of time allows properly setting up calibrating and validating a reliable numerical model simulating the morphological behaviour of the pilcomayo river the type of sediment forming the alluvial bed fine sand allows assuming full sediment mobility and thus considering a single sediment size in the model reducing computational time singh et al 2017 moreover due to the extremely quick response of the river to changing conditions simulating a single hydrological year can be considered enough to detect the range of effects of alterations in morphological drivers all these factors together make the pilcomayo a unique case to be used as a living lab to investigate the response of alluvial sand bed rivers to climate change 3 1 model description we constructed a two dimensional 2d numerical model of the pilcomayo river using the open source structured delft3d code version 4 1 which solves the 3d reynolds equations for shallow water coupled to sediment transport and sediment balance equations including also a bank erosion formulation deltares 2019 lesser et al 2004 downloadable at https oss deltares nl web delft3d the code has been widely tested and validated for investigations requiring the simulation of the morphological changes of rivers with vegetated floodplains e g arboleda et al 2010 vargas luna et al 2018 villada arroyave and crosato 2010 the model computes water levels and depth averaged flow velocity the latter as a vector with two components in the horizontal plane as well as changes of bed topography and channel alignment including the effects of vegetation on local energy dissipation and sediment transport rate bed level changes are computed at every time step for every grid cell based on sediment budget following exner 1920 approach in which the sediment transport rates are computed using a sediment transport capacity formula 1 1 ε z b t s x x s y y 0 where ε is the bed porosity zb is the bed level t is time sx is the sediment transport rate in the x direction and sy is the sediment transport rate in the y direction in river bends the stream lines have a spiral shape with important vertical flow components near the banks the maximum flow velocity is shifted towards the outer bend altering the bed shear stress direction this affects the sediment transport direction with relevant consequences for the computation of channel bed topography struiksma et al 1985 another factor influencing the sediment transport direction is gravity which is particularly relevant for bed load if the bed is sloping the presence of bars and pools produces important transverse slopes which should be considered by the model the sediment transport direction is therefore corrected by taking into account both the spiral flow and the gravity effects following koch and flokstra s 1980 formulation 2 tan α s sin α t 1 f z b y cos α t 1 f z b x where αs is the direction of sediment transport and αt is the direction of bed shear stress f is a user defined tuning parameter which we computed according to talmon et al 1995 3 f a shld θ bshld d 50 h cshld where θ is the shields parameter d50 is the median sediment grain size h is the local water depth and ashld bshld and cshld are calibration coefficients the model represents bank erosion by transferring a fraction of the erosion occurring at every wet cell to the adjacent dry cell if present which then becomes wet and is then incorporated in the water flow and morphological computations van der wegen and roelvink 2008 for the pilcomayo river 80 of the erosion computed for a cell at the bank toe is transferred to the adjacent floodplain cell with the result of enlarging the wet channel width the effects of vegetation on water flow and sediment transport are taken into account by adjusting the flow resistance as a function of vegetation characteristics two roughness coefficients are computed the global chézy coefficient for the derivation of the depth averaged hydraulic variables and a chézy coefficient of the soil among the plants for the derivation of the bed shear stress and the sediment transport rate following baptist s formulation baptist et al 2007 the method distinguishes between submerged and emerging vegetation plants are represented as vertical rigid cylinders vargas luna et al 2016 with specific density height and diameter the flow velocity is considered uniform through the plants but following a logarithmic vertical profile above the canopy the total shear stress is assumed to be composed of two components 4 ρ g h i τ b τ v in which ρ is the water density g is the acceleration due to gravity h is the local water depth i is the longitudinal water surface slope τb is the bed shear stress and τv is the extra shear stress caused by the presence of vegetation for emerging plants the water depth h is smaller than the plant height hv in this case the two stresses can be written as 5 τ b ρ g c b 2 u v 2 6 τ v 1 2 ρ c d m d h u v 2 where cb is the chézy coefficient of the un vegetated bed uv is the flow velocity through vegetation cd is the drag coefficient of the plants m is the vegetation density per unit area and d is the representative stem diameter the product md being the canopy density a defined by nepf 2012 the global chézy coefficient cr is obtained by combining the two equations with the chézy equation u v c r hi leading to 7 c r 1 1 c b 2 c d m d h 2 g emerging v e g e t a t i o n if the plant height is smaller than the local water depth submerged vegetation the flow is assumed to be split in two parts the flow through the plants and the flow above the canopy in this case 8 c r 1 1 c b 2 c d m d h v 2 g g κ l n h h v submerged v e g e t a t i o n in which κ is the van kármán constant κ 0 41 and hv is the plant height the bed shear stress τb is computed as 9 τ b ρ g c b 2 u 2 where u is the depth averaged flow velocity for which u c r hi and c b is the chézy coefficient of the soil among the plants which is used to compute the bed shear stress and the sediment transport rate in the vegetated areas its value is a function of cb the chézy coefficient of the un vegetated bed corrected to take into account the effects of vegetation which is obtained as 10 c b c b g κ l n h h v 1 c d m d h v 2 g for emerging vegetation c b c b 3 2 model set up considering the significant planimetric changes that occurred in the study area three distinct numerical models were constructed to represent the pilcomayo river in three different periods of time for which long and complete daily data series are available 1972 1973 1980 1981 and 2017 2018 the historical river models 1972 1973 and 1980 1981 were meant for calibration and validation purposes the model of the river in 2017 2018 was used as the morphological starting point for the study of the climate scenarios the following satellites images were used to reconstruct the historical river bank alignments periods 1971 1972 and 1980 1981 landsat 1 3 level 1 retrieved from united station geological survey at https earthexplorer usgs gov period 2017 2019 landsat 8 level 1 retrieved from united station geological survey at https earthexplorer usgs gov in the study reach the bankfull river width between 100 m to several hundreds of meters landsat 1 3 level 1 images have a resolution of 60 m therefore a minimum of 1 full pixel or 1 67 pixels to a maximum of about ten full pixels fit the river width this is enough to recognize and depict the main river channel bankfull width landsat 8 level 1 images have a resolution of 30 m therefore the river width is depicted with a minimum of 3 full pixels or 3 33 pixels the river banks were manually depicted the resulting historical river planimetries are shown in fig 3 topographical elevations were derived using the alos advanced land observing satellite dem of 2011 with resolution of 12 5 12 5 m2 covering an area of 30 km2 downloaded from https www asf alaska edu sar data palsar terrain corrected rtc irregularities in the dem were smoothed out using arcgis s geoprocessing tools process that was finalized using the quickin tools of the delft3d software package the spatial distribution of floodplain vegetation was obtained from the google earth images 1984 to 2016 in a straightforward way by defining the contourlines of the areas presenting the same vegetation cover the current plant characteristics were derived from local photos and simple field observations indicating that floodplain vegetation in the study area can be classified as semi open shrub constituted by 3 m high plants with a density of approximately 7 stems m2 data on growth rates conditions for germination establishment and decay as well as root characteristics of floodplain vegetation are missing this lack of data makes impossible to model the interaction between plant dynamics variations in vegetation characteristics due to colonization growth and decay of plants and the morpho dynamics of the pilcomayo river o hare et al 2016 pasquale et al 2014 perona et al 2012 caponi et al 2020 indicate that vegetation does not establish on migrating bars in case of high uprooting rates during floods the pilcomayo presents powerful and relatively frequent flood events with bars that appear and disappear very quickly this extremely high morphodynamics results in regular removal of sprouts from bars point bars and channel margins fig 1 shows the almost complete absence of vegetation growth on these areas instead vegetation is present on the river floodplains where is appears as a rather uniform semi open shrub it is therefore appropriate to suppose that plant dynamics does not influence the current morphological developments of the pilcomayo river channel in a significant way boothroyd et al 2021 the model domain was discretized in more than 27 000 cells with dimension between 12 15 and 30 30 m fig 3 the upstream boundary conditions consist of water and sediment inflows water inflow is made up of a daily discharge time the sediment inflow is computed as local sediment transport capacity derived as a function of flow velocity particle size bed roughness and other parameters adopting the best performing sediment transport formula van rijn 1984 due to the absence of measured water levels time series at a location close to the end of the model domain the downstream boundary conditions are water levels and sediment outflows being calculated by the model assuming uniform flow the initial bed topography of each historical model was derived numerically it was obtained by running the model for the last 18 months before starting the scenario runs using the measured daily discharges spin up runs before this a preliminary channel was created by lowering the levels in the area between the river banks by 2 5 m summarising the three historical model setups have different initial river bank alignment and bed topography floodplain vegetation cover distribution and different upstream and downstream boundary conditions but the same numerical grid sediment transport formula and physical parameters either derived from the calibration procedure or from physical considerations 3 3 model calibration and validation model calibration was carried out by optimizing the values of several coefficients to best reproduce the river morphological behaviour in the period 1972 1973 imposing initial morphological conditions corresponding to the river alignment of 1972 and model generated 2d bed topography the upstream boundary conditions of this model were the series of daily discharges measured in the same period the sediment input rate was computed as a function of incoming discharge the chosen calibration period can be regarded as a typical hydrological year of the pilcomayo river with a maximum discharge of 1 362 m3 s and an average discharge of 173 m3 s vegetation described by plant height representative stem diameter and density was assumed to be equal to the current climatic condition section 3 4 but with the 1984 spatial distribution derived from google earth lack of historical information on floodplain vegetation prevented us to define the vegetation distribution before 1984 in the calibration process special attention was paid to obtain a good characterisation of the river dynamics represented by the temporal variations of maximum water depth measured at the deepest point thalweg in the monitored cross section the river pilcomayo does not have a dominant horizontal bed structure on which to calibrate a 2d model because its bed topography changes with high speed every day showing daily appearance and disappearance of bars and shoals as a response to discharge variations fig 2 and fig 3 it was therefore meaningful to calibrate the model in such a way that it captures the measured river dynamics compared to the cross section averaged bed level the thalweg level incorporates some information on cross sectional shape for instance the average bed level hardly responds to the formation of bars the presence of alternate bars would deepen the thalweg without changing the average bed level significantly moreover the thalweg would be deeper with alternate bars rather than with central or multiple bars crosato and mosselman 2009 besides the temporal variation of the maximum water depth calibration was based also on the temporal variations of the wet cross sectional area and on the yearly volume of transported sediment on the basis of the best performance compared to measured data to decide which calibration simulation is the best performing one a multi criteria analysis was carried out by computing the coefficient of determination r2 the root mean square error rmse and the mean absolute error mae relative to wet area and maximum water depth of the cross section for each specific calibration run by comparing computed and measured values moriasi et al 2015 the calibration parameters are the following chezy s coefficient of bare bed the same value for main channel and floodplain soil corresponding to cb in equations 4 10 chezy s coefficient of the vegetated floodplains the baptist s method allows deriving two values of chezy s coefficient from the bare bed roughness coefficient cb and the plant characteristics one to be used for the computation of the hydrodynamic characteristics either equation 7 or 8 and the other one for the bed shear stress equation 10 transverse slope effects on the sediment transport direction where ashld αs and αt are calibration parameters equations 2 and 3 multiplication factor for suspended sediment concentration formula of van rijn 1984 multiplication factor for bed load transport vector magnitude of the formula of engelund and hansen 1967 the downstream boundary conditions affect not only the flow distribution and the morphological changes in the last part of the model domain but might gradually impact also the areas more upstream if undesirable backwater effects are created for this reason due to the absence of water level measurements close to the model boundary the calibration process included also the selection of the best performing downstream boundary condition model validation was carried out to assess the model performance based on an independent set of data i e on the morphological changes that occurred in the period 1st january 1980 to 28th february 1981 starting from the 1980 channel alignment and model generated bed topography the model was run using the daily discharges measured in the same period with the values of calibration coefficients derived from the calibration procedure and with the spatial distribution of vegetation of 1984 and plant characteristics of current climate described in section 3 4 3 4 climate scenarios sperna weiland et al 2012 estimated a 25 discharge reduction in december january and february wet season a 30 reduction in march to august and a 20 reduction in september to november dry season in the study area to have a mirror condition for comparing purposes we consider also a wetter climate wet presenting the same percentages of discharge variations of the projected scenario but in opposite direction this means that we consider three different hydrographs fig 4 1 the one representing the current situation base case q bc corresponding to the series of discharges measured in the period september 2017 to august 2018 2 a constructed dryer hydrograph q dry 3 a constructed wetter hydrograph q wet the current total yearly runoff is 9 935 mm3 the one relative to the constructed wet hydrograph is 12 598 mm3 26 8 whereas for the constructed dry hydrograph the total yearly runoff is 7 272 mm3 26 8 due to expected differences in soil moisture the drier climate is assumed to also present reduced floodplain vegetation mass anadón et al 2014 stocker et al 2013 the wetter climate increased vegetation mass van oorschot et al 2018 more specifically considering that the current floodplain vegetation in the area is a semi open shrub we assume that this would turn into open shrub for the climate becoming drier and into close shrub for the climate becoming wetter in total we consider four vegetation scenarios since we also include a case without floodplain vegetation the present distribution of floodplain vegetation is used for all scenarios according to observations and to baptist and de jong 2005 we introduce the following plant heights and canopy densities in the model for the semi open shrub 3 m high plants with a canopy density of 0 07 m 1 corresponding to the current plant characteristics for the open shrub 2 5 m high plants with a canopy density of 0 034 m 1 for the close shrub 3 5 m high plants and canopy density of 0 102 m 1 all plants have a representative stem diameter of 0 01 m finally we assume the drag coefficient of the plants to be cd 1 as suggested by vargas luna et al 2016 regarding vegetation dynamics in terms of vegetation colonization growth and decay it is supposed that these processes do not affect the morphological developments of the pilcomayo river in a significant way also for the moderately drier and wetter climates in drier climates vegetation grows slower and is less dense this diminishes the mutual protection offered by plants enhancing bed erosion around plants and eradication partly counterbalancing the flow reduction although in drier climates the flood intensity might increase see discussion in wetter climates vegetation grows faster and denser but at the same time the water flow increases partly counterbalancing the increase in plant resistance note that this is only valid for moderate climate changes the bare soil of the floodplains among the plants is assumed to have the same roughness as the main channel bed for which we assign the calibrated value of chézy coefficient cb 60 m1 2 s this is used to compute the hydraulic variables and bed shear stress for the case without vegetation it is also used to compute the bed shear stress if plants are emerging but if vegetation is submerged the model computes the bed shear stress using cb equation 10 note that for vegetated areas the hydraulic variables such as the depth averaged flow velocity and the water depth are computed using the global chézy coefficient cr eqs 7 and 8 the spatial distribution of vegetation is assumed equal to the present one derived from google earth for all climatic scenarios the sediment input rates coincide with the transport capacity of the incoming flow computed using van rijn s 1984 formula and depend thus on discharge regime this approach neglects wash load i e the sediment transported in suspension with size of the order of several micrometres clay and silt this sediment does not affect the morphology of dynamic rivers and can thus be neglected from this study focusing on river channel adaptation in total we simulated eight scenarios combining the three discharge hydrographs current wetter and drier with the three different classes of vegetation plus one case without vegetation table 2 the analysis of combinations of these scenarios allows isolating the effects of discharge vegetation and climate all scenario runs started from channel alignment and model generated bed topography of the year 2017 4 results of model calibration and validation the best performing set of input parameters was identified based on 49 runs each one differing in the value of one or more calibration coefficients or parameters which were always falling within their physics sound range as an example the range of values of chézy s coefficient considered in the calibration runs was derived from the results of previous hydrodynamic computations performed using manning s coefficient baldissone et al 2013 brea et al 2014 testa tacchino 2015 concluding that the values to be used for the pilcomayo river in the study area fall between 0 018 s m1 3 and 0 020 s m1 3 which correspond to chézy s coefficients in the range of 50 to 65 m1 2 s with the highest values for high flow conditions the sediment particle diameter was optimized by considering only values falling within the measured range to comply with the estimated value of total yearly sediment transport fernández and garcia 2017 the calibration phase also included the selection of the sediment transport formula note that the sediment transport formula affects not only the sediment transport rates in the study area but also the sediment inputs from upstream and the speed of the morphological developments about the correction of sediment transport direction due to spiral flow and gravity eq 3 we calibrated the coefficient ashld being the one that mostly affects the river bed topography whereas the other two coefficients were given their default values bshld 0 5 and cshld 0 3 the time step used in the computations was nine seconds selected based on preliminary runs the results of the calibration runs show that the best performing downstream boundary condition is the water level recomputed at each time step assuming uniform flow with a value of chézy s coefficient equal to 60 m1 2 s this is the calibrated value of the roughness coefficient for the un vegetated river bed and floodplains composed of sediment having diameter equal to 0 1 mm the best performing value of the coefficient weighing the effects of gravity on sediment transport direction ashld is 0 5 corresponding to a relatively high sediment transport deviation towards the deepest areas of the river bed baar et al 2019 the best performing sediment transport formula is the one developed by van rijn 1984 which is particularly suited for sand bed rivers and distinguishes bed load from suspended load fig 5 a illustrates the results of model calibration with remarkable values of r2 and normalized root mean square error nrmse for the maximum water depth in cross section a location indicated in fig 3 particularly after calibration the error is limited to 19 the mae relative to maximum water depth resulted in 0 31 m and the mae relative to cross sectional wet area in 31 34 m2 the results of the validation run are shown in fig 5b and fig 6 fig 5b illustrates the simulated water depth versus its corresponding measured values showing values of r2 and normalized root mean square error nrmse being similar to the ones of the calibration period additionally fig 6 depicts the comparison between measured and computed bed levels showing a high quality performance of the model the simulated bed levels follow well the pattern of observed data indicating that the model can successfully reproduce the observed cross sectional morphological adaptation of the river 5 results of scenario runs 5 1 effects of discharge and vegetation on main channel cross section fig 7 shows the cross sectional profiles at high flow conditions february 4th 2018 fig 4 in this case the main channel width coincides with the river bankfull width e g vargas luna et al 2019a wilkerson and parker 2011 for smaller discharges the model would give the width and the depth of the water flowing within the main channel which would not represent the channel size but just the lateral and vertical dimensions of the wet area at that particular flow rate moreover at flows smaller than or equal to the bankfull discharge the water would not flow through the side channels making them hard to be recognized visualized from the model results fig 7a indicates the effects of floodplain vegetation since it presents the results of four runs with the same water and sediment inputs hydrograph q bc corresponding to the base case flow and different floodplain vegetation characteristics the cross sectional profiles show that higher vegetation mass veg thin green line enhances levee formation and concentrates the water flow in the main river channel as a result the channel becomes deeper complying with the observations of gurnell 2014 lower vegetation mass veg dotted green line results in more distributed sediment deposition over the floodplains and in a shallower channel in this scenario the channel of the pilcomayo presents a shift of a few tens of meters toward the right bank of the river due to enhanced bank erosion and sediment deposition near the opposite bank finally the extreme scenario in which vegetation is absent results in a relevant main channel shift to the left and in the formation of a small secondary channel to the right noveg black dotted line the main channel is wider and shallower and presents a central bar this is due to morphodynamic instability triggered by the high width to depth ratio of the flow e g crosato and mosselman 2020 the irregular cross section is a clear indication of channel braiding leopold and wolman 1957 fig 7b shows the effects of having a different discharge regime the results of the scenarios with the current floodplain vegetation characteristics veg indicate that higher discharges wet dotted blue line produce a deeper channel contained by larger levees smaller discharges dry dotted red line produce a shallower channel and smaller levees due to the presence of vegetation on banks and floodplains the width of the channel appears to be only slightly influenced by the discharge regime however this conclusion is only valid for moderate changes in water flow as in the studied scenarios with well developed floodplain vegetation as in the study area the smaller discharge regime does not alter the channel width whereas the channel presents some widening with the largest one this is due to the higher near bank flow velocities that are capable of eroding banks despite the presence of vegetation 5 2 effects of climate change on channel cross section and river fluvial style fig 8 shows the cross section a profiles that are obtained for the three considered climate scenarios on different days the extremely fast adaptation of the cross sections of the pilcomayo river fig 2 well reproduced by the model fig 5 allows relating the computed cross section profiles to the discharge of the day almost no differences between climate scenarios can be observed at the start of the simulations when the flow is very low for all the three scenarios e g on 1 september 2017 in fig 4 the quick morphological adaptations that occur during the flood season january to march 2018 result in a systematically wider channel for the drier climate and in a systematically narrower channel for the wetter climate scenario the three climate scenarios present a similar channel depth at low flows however the depth is substantially larger with the wetter climate scenario at the highest discharges which is due to the higher flow rates and the denser vegetation which appears to successfully limit bank erosion the result of the wet climate scenario is thus a higher transient channel excavation of 20 respect to the current scenario fig 8c at the end of the wet season fig 8f when the flow is low again the wet areas are similar for all the three considered climates sediment deposition occurring during the falling limb of the flood waves results in a similar bed level rise for all the three climates since more sediment is transported and thus deposited with the wetter climate instead the width is maintained and our results indicate that the bankfull width can be expected to increase by 35 45 in 2100 due to the forecasted climate change fig 8b f fig 9 shows the yearly sand transport rates of the river for all the considered scenarios an increase in sediment transport rates can be expected if the climate becomes wetter 46 1 a decrease if the climate becomes drier 39 1 fig 9 allows also detecting the effects of changes in floodplain vegetation in combination with the present discharge hydrograph green bars either a higher or a lower vegetation mass would increase the yearly sediment transport rates a denser vegetation veg would increase the sediment transport capacity of the flow by enhancing its concentration and velocity in the main channel 3 9 a lower floodplain vegetation mass veg would increase the sediment input through a slight increase in bank erosion 0 3 a similar effect of vegetation is found in combination with the drier hydrograph red bars instead a larger vegetation mass veg would but only slightly decrease the yearly sediment transport rate in combination with the wetter hydrograph blue bars this is mainly due bank erosion zeroing finally it is important to consider that these results exclude wash load including the finest part of the sediment transported by the flow would not affect the configuration of the main river channel but would result in higher floodplain sedimentation rates with deposition occurring further away from the main channel margin than sand fig 10 shows the water coverage in the study area with the present discharge hydrograph but without floodplain vegetation on february 4th 2018 peak flow of 3 934 m3 s on that day being the discharge above bankfull it is possible to detect the presence of channels excavated through the floodplains in this case the river presents multiple channel excavation and main channel shift resulting in a braided system with substantial straightening the present channel sinuosity is 1 3 calculated as average sinuosity in the period 1972 2017 table 1 while the predicted sinuosity without floodplain vegetation under the bc noveg scenario is 1 1 fig 10 considering that the downstream boundary conditions water levels and the upstream boundary conditions 2d flow distribution are the same river straightening means also steepening of the longitudinal water level profile and indeed the longitudinal slope increases from 0 038 present situation table 1 to 0 044 fig 10 6 discussion the model covers one hydrological year to shows how the river cross section evolves with different climatic and vegetation settings since the morphodynamic response of rivers is complex and depends on sequences of floods and dry periods we needed a real hydrograph as basis to construct the drier and wetter scenarios in fact we could not reproduce the morphodynamic river response with annual or seasonal mean streamflows additionally the choice of covering one year is justified by the intrinsic morphodynamics of the pilcomayo river our case study this river has such a strong dynamic that the cross section drastically changes every day as a response to the discharge variation for this reason and after having well reproduced this behavior with the model and analyzed its morphodynamics chapter 5 we decided that we can link the cross section that is measured in one day to the discharge ultimately this work does not want to forecast the pilcomayo river morphology due to global change but more in general to disentangle the river response to plausible dryer and wetter scenarios a specific further study on how the pilcomayo will evolve in the future due to climate change would be certainly an important contribution in our model sediment input is computed as a function of inflow characteristics using the sediment transport formula of van rijn 1984 which includes suspended load and is particularly appropriate for fine sand as all transport capacity formulas van rijn s does not include wash load i e the transport of very fine material silt and clay which is supply limited rather than capacity limited thus the decrease in discharge characterizing the dry climate also results in reduced sediment input to the study area whereas for the wetter climate our model predicts larger sediment inputs wash load supply is mainly related to soil erosion in the river catchment in this study we do not consider the effects of changing climate on sediment production pitlick et al 2012 verhaar et al 2010 the reduction of vegetation cover due to a drier climate is expected to result in increased soil erodibility in the river catchment and larger sediment inputs to the river the transport of sand which is capacity limited is expected to decrease if the discharges decrease fig 9 however dry climates often present extreme discharge variations due to rainfall concentration in brief periods so it is not clear whether higher but shorter discharge peaks would actually increase or decrease the total bed load in the river as a result of an increase in sediment load we can expect enhanced bed aggradation to occur where the slope of the river decreases further enhancing the tendency towards a braided style at these locations germanoski and schumm 1993 a wetter climate would have opposite effects i e reduction of sediment production enhancing a meandering style gurnell 2012 the effects of vegetation on hydraulic resistance sediment transport and bed erosion are included in the model in a static way by assuming a certain distribution of plants with constant characteristics height density representative diameter on the floodplain depending on scenario however vegetation processes colonization growth decay are known to interact with the river dynamics caponi et al 2020 van oorschot et al 2016 and are affected by climate liu and lei 2015 roerink et al 2003 lack of data and the choice to concentrate the analysis in one hydrological year do not allow including vegetation dynamics this means that our work does not represent the transition period i e when the river channel evolves until the characteristics of the floodplain vegetation reach the configuration expected in the future climate by including the effects of vegetation on water flow and sediment transport the model indirectly reproduces also part of the protecting effects of plants on river banks due to the higher roughness caused by riparian vegetation the main flow is deflected towards the centre of the channel and the near bank flow velocity as well as the near bank bed shear stress are reduced this decreases erosion of the river bed near the bank which our model partially converts in bank erosion van der wegen and roelvink 2008 and enhances levee formation crosato and saleh 2011 the model ignores bank strengthening by roots and bank reinforcement by slump blocks that armour cut banks in addition the model does not account for vegetation dynamics in terms of colonization growth and decay of plants this becomes important in river systems where plants have the possibility to colonize emerging bars and banks during low flows and have the time to grow strong enough to resist the next flood serlet et al 2018 in rivers where plant dynamics plays a role this is found to enhance bank accretion and opposite bank erosion which results in increased river meandering vargas luna et al 2019b as previously described measured data on plant colonization growth temporal changes in plant density etc are lacking the only vegetation data available for this study is the type of vegetation that is dominant in the area whereas we derived historical floodplain vegetation cover distribution from satellite images vegetation dynamics depends not only on plant species but also on climate soil type and moisture which means that we could derive this information from studies carried out elsewhere along the pilcomayo vegetation is mainly present on the floodplain and rarely on bars a clear sign that vegetation processes are governed by the river dynamics and do not play a relevant role in the cross sectional dynamics of the river vargas luna duró et al 2019b showed that colonization of emerging bars by vegetation increases opposite bank erosion but does not affect channel width and depth focus of this research not considering vegetation dynamics could be a shortcoming in the generalization of the results for sand bed rivers in different climatic settings moreover considering that the interaction river vegetation is affected by scale gurnell 2014 we conclude that our study case and the results herein presented are strictly representative of rivers having size compared to pilcomayo s located in similar climatic settings and having similar hydro morphological conditions in any case our results indicate the right trends of river morphological variations under moderate climate change in general and that our results can be used as a guidance to include climate change effects in forecasting the long term evolution of rivers the results of this study provide also a reference tool to analyse past changes of river environments assuming no human influence the results provide also an insight to predict the effects of combinations of interventions for instance regarding floodplain vegetation management e g gonzález et al 2017 and alterations of the river discharge on the width and depth of the main river channel e g su et al 2021 a recent study chen et al 2019 shows that the hydrological regime leaves an imprint on the longitudinal profile of rivers in particular based on nasa data sets and numerical modelling chen et al 2019 show that drier climates aridity reduce the river sinuosity and produce steeper longitudinal slopes our results show that the absence of floodplain vegetation increases the longitudinal slope of the river through channel straightening as a result of river braiding fig 10 overall a light flow straightening is also obtained for the moderately drier climate see table 3 thus our results appear to support chen et al s observations the central region of the study area has remained straight for at least the period covered by our study 1972 2018 we do not have data explaining this which might be due to either artificial or natural vegetation bank reinforcement or to the characteristics of the bank material in that region to explain this we recommend carrying out some field investigations focusing on the characterization of the river banks 7 conclusions this numerical study analyses the adaptation to climate of sand bed rivers considering the pilcomayo as an example for the climate scenarios we considered the 2100 projections of the intergovernmental panel on climate change ipcc special report on emission scenario a1b hereafter named as the sres a1b scenario stocker et al 2013 our model reproduces historical cross sectional changes that follow the measured ones which gives confidence in our results we then used the model to assess the response of the main river channel to climate change considering the forecast for the year 2100 as well as its opposite the river climate being described by a combination of hydrological regime and floodplain vegetation characteristics the main finding of this investigation results from the analysis of the either combined or separate effects of alterations in discharge regime and floodplain vegetation both resulting from climate change these alterations interact with each other and affect the river morphology in a non linear way complicating the analysis of their single roles in the process of climate adaptation our results show that for moderate climate changes vegetation governs the river channel width whereas discharge in presence of floodplain vegetation mainly affects the main channel depth and the levee formation previous works not considering the role of riparian vegetation found a much stronger effect of discharge alteration on channel width e g vargas luna et al 2019b the difference is mainly due to having now considered the effects of plants on river banks which is obtained in our model only partially since the strengthening effects of roots and the mechanical reinforcement of slump blocks that shelter failed banks and limit further erosion are not considered due to this we can expect plants to have an even stronger role in governing the river width than our results are able to demonstrate previous works have shown that floodplain vegetation growth lead to important changes of the river morphology which even result in a different fluvial style for instance from braiding to meandering e g crosato and saleh 2011 gurnell 2014 tal and paola 2010 villada arroyave and crosato 2010 this is confirmed also by the results of our study showing that without vegetation the pilcomayo river would be braided summarising we find that for sand bed rivers in temperate climates a moderately dryer climate characterized by reduced water flow and scarcer floodplain vegetation will result in a shallower and wider water course with floodplains and banks that are more prone to erosion the projected change for the pilcomayo river in 2100 is a consistent bankfull width increase by 35 45 respect to the current scenario a moderately wetter climate characterized by increased water flow and denser floodplain vegetation during floods will produce a transient deeper channel by 20 respect to the current scenario whereas channel widening will be limited by vegetation offering a more effective protection to cut banks 8 research data the national hydrological network of argentina has records for daily discharge water level and cross sectional profile at the station of misión la paz in front of pozo hondo 22 22 38 s 62 31 24 w from 1960 to 2018 the time series of discharges and water levels were downloaded from http bdhi hidricosargentina gob ar the time series of the cross section was downloaded from www pilcomayo net the webpage of the tri national committee for the development of the pilcomayo river basin sediment data including sediment characteristics are also available from several documents at www pilcomayo net the models are freely downloadable from the website of ncr netherlands centre of river studies https ncr web org credit authorship contribution statement a crosato conceptualization methodology validation resources formal analysis writing original draft writing review editing supervision project administration a grissetti vázquez methodology software validation formal analysis investigation data curation writing original draft visualization f bregoli conceptualization validation formal analysis writing original draft writing review editing visualization supervision m j franca writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments alberto grissetti carried out this research with funds from the world meteorological organization fellowship programme francesco bregoli received funding from the ec marie curie individual fellowship h2020 priority excellent science grant number 606838 the authors wish to thank dr sergio capapé jacobs uk formerly at universitat politècnica de catalunya for his important suggestions dr paolo paron ihe delft and dr alessandro ielpi laurentian university for reviewing an early version of the manuscript and to the national committee of the pilcomayo river in paraguay for providing access to their database 
2996,the focus of this paper is directed towards developing models for predicting the soil water characteristic curves swccs for coarse and fine grained soils taking account influence of hysteresis and various factors such as the stress state and soil structure respectively for achieving this objective several novel models are derived from the pore size distribution posd curve of the swcc and linked to the well known swcc fitting equations three simple methods are developed from the proposed model that can be used for predicting the scanning swccs of coarse grained soils a modified swcc model is built based on the theoretical background developed for the posd curve that is capable for predicting the of fine grained soils taking account influence of the initial water content and stress state in addition a coupled swcc model is proposed that can be used for explaining the influence of multiple soil parameters the proposed novel yet simple models can be used in numerical modeling of complex coupled hydromechanical problems and for predicting of various properties of unsaturated soils keywords soil water characteristic curve pore size distribution curve hysteretic behavior initial water content initial stress state data availability data will be made available on request nomenclature list of notations α is the contact angle af nf and mf are fitting parameters for the swcc equation proposed by fredlund and xing 1994 av mv and nv are fitting parameters for the swcc equation proposed by van genuchten 1980 alv nlv and mlv are fitting parameters for the swcc equation proposed by authors a v wet and a f wet are model parameters for main wetting curve in van genuchten and fredlund and xing equations respectively ad0 and aw0 are parameters at reference state for the wetting and drying branches respectively pa and pb are model parameters for main wetting curves pc pd pe and pf are model parameters for wetting and dry scanning curves respectively βd λd βw and λw are simplified model parameters for the drying and wetting scanning curves respectively c ψ is the correction function for fredlund and xing 1994 equation e and e0 are void ratio and the value at reference state exp is exponential function fp ψ is occurrence function fdry and gdry are posd functions for drying swcc using fredlund and xing 1994 and van genuchten 1980 equations respectively gs is specific gravity of soil solids h is dummy variable of integration representing soil suction min is the function to find minimum value ψ and ψ0 is soil suction and the value at transition point respectively ψlm and ψhm are soil suction at meeting points of low and high suction respectively ψr and ψr wet are residual soil suction for main drying and wetting curves respectively ψmin and ψmax are minimum and maximum soil suction respectively o is the objective function p r or p ψ is pore size distribution ϕc and ξc are the fitting parameters for modeling initial stress state effect ξi is a parameter to represent initial water content effect ξd and ξw are parameters for taking account of the initial state effects respectively for drying and wetting branches of swcc r is pore radius r0 r1 r2 are radii of the soil pores represent reference state initial stress state e and various initial water content wio respectively rmin is minimum pore size in soils s is the degree of saturation si is initial degree of saturation θ and θ0 is the volumetric water content and the value at transition point θlm and θhm are volumetric water contents for meeting points at low suction and high suction respectively θobv and θpred are measured and predicted volumetric water contents respectively θs θr and θr wet are saturated residual volumetric water content of main drying and wetting branches respectively θ r is the volumetric water content when the pores with radius are smaller than r are filled with water θ pred and θ obv the average values of the predicted and measured volumetric water contents respectively t is surface tension vwi and vwio are volumes of water at initial water content and reference state respectively vvoid and vvoid0 are the volume of voids at initial stress state and reference state respectively wi and wi0 are initial water content and the water content at reference respectively 1 introduction the relationship between water content volumetric or gravimetric or degree of saturation and the soil suction is referred to as the soil water characteristic curve swcc the swcc is also widely referred to as the soil moisture curve and soil water retention curve in the literature fredlund and rahardjo 1993 researchers during the past four decades focused on proposing models for predicting the swcc in the literature since conventional measurement techniques are time consuming e g arya and paris 1981 schaap et al 2001 chin et al 2010 li et al 2016 alves et al 2020 li and vanapalli 2022 the focus of most research studies was mainly directed towards predicting the main drying curve during last two decades complex thermo hydro mechanical chemo thmc behaviors of unsaturated soils were also analyzed by many researchers using the swcc as a tool e g wheeler and sivakumar 1995 gallipoli et al 2003 zhou et al 2012b ni et al 2019 yang and vanapalli 2020 xu et al 2020 rong and mccartney 2021 the research related to the swcc has wide applications in water resources agriculture soil science geotechnical and geo environmental engineering fields e g fredlund et al 1994 nemes et al 2001 qi and vanapalli 2015 cary and zapata 2016 zhu et al 2020 cheng et al 2021 the use of swcc as a tool is receiving more attention in the recent literature for understanding the influence of climate change on the thmc behavior of unsaturated soils bai et al 2020 li et al 2021 a family of swcc taking account of influence soil hysteresis is required for rigorous modeling of the soil behavior fig 1 i two approaches are widely used for modeling hysteretic swcc pham et al 2005 in the literature namely physical based domain models e g parlange 1976 hogarth et al 1988 wei and dewoolkar 2006 min and huy 2010 zhou 2013 likos et al 2014 fu et al 2020 and empirical models e g feng and fredlund 1999 pham et al 2003 zhai et al 2020 experimental studies from the literature suggest that the swcc behavior is significantly influenced by the stress state and initial compaction water content that is strongly related to the pore structure in fine grained soils e g vanapalli et al 1999 ng and pang 2000 fredlund et al 2011 during the last two decades several models have been developed to incorporate the influence of initial stress state into swcc e g wheeler et al 2003 gallipoli et al 2003 sun et al 2007 tarantino and col 2008 tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 zhou and sheng 2015 however the initial water content has a significant influence on the soil structure that impacts the swcc behavior especially in compacted fine grained soils the coupled effects of both the initial stress state and initial water contents are not typically incorporated into models for swccs for this reason there is a need for developing models taking account the influence of various parameters to reliably predict the swccs such models would be valuable for various practical applications in water resources agriculture soil science geotechnical and geo environmental engineering fields in this paper simple yet novel models are proposed for predicting the family of swccs i e main drying and wetting swcc along with scanning curves considering hysteretic nature of coarse grained soils from the pore size distribution posd curve using a set of basic functions and boundary conditions the swccs of fine grained soils are also predicted taking account effects of initial stress state and soil structure associated with the initial water content based on the posd curve the various proposed swcc models in this study are presented in fig 1 ii reasonable comparisons were achieved between the experimental and the predicted results of the swccs for both coarse and fine grained soils the proposed models are valuable for use in numerical modeling of the complex thmc modeling problems and for predicting various properties of unsaturated soils taking account of the influences of wetting and drying cycles associated with environmental factors 2 swcc models for coarse grained soils 2 1 model for main wetting curves the family of swcc that constitutes main drying and wetting curves taking account of hysteresis effects and scanning curves is required for rational interpretation of the soil behavior the water content in the swcc associated with the wetting branch is less than the drying branch at any given soil suction as shown in fig 1 i numerous drying and wetting scanning curves are possible within the main drying wetting swccs the major factors that influence the hysteretic swccs pham et al 2005 include i irregular pore structures inside soils or the ink bottle effect ii the contact angle variation during drying and wetting processes iii entrapped air during wetting iv thixotropic regain or aging due to the wetting drying cyclic history water in soils is stored in the interconnected pores mualem and miller 1979 vanapalli et al 1996 li and vanapalli 2021 and the pores with radii r can be reasonably described by their pore size distribution p r when the pores with radius less than r are filled with water the volumetric water content can be expressed as below fredlund and xing 1994 1 θ r r min r p r d r where θ r is the volumetric water content when the pores with radius are smaller than r are filled with water and rmin is the minimum pore size in soils the water stored in larger pores drain easily due to desaturation associated with an increase in the soil suction since the amount of water in pores can be characterized by pore size r an inverse relationship between soil suction ψ and pore radius r is conventionally used fredlund and xing 1994 as shown in eqs 2 2a 1 r ψ 2b ψ c r 2 t c o s α r where c 2tcosα t is surface tension unit n m α is contact angle between soils and water the widely used capillary law i e eq 2b can be introduced into eq 1 to obtain the relationship below 3 θ r ψ max ψ p c h d c h ψ ψ max p c h c h 2 d h where h is a dummy variable of integration representing soil suction and ψmax is the maximum soil suction representing minimum pore radius several swcc equations have been successfully developed in the literature extending the above philosophy two equations i e eq 4 and eqs 5 proposed by van genuchten 1980 and fredlund and xing 1994 respectively are widely used for modeling the swccs 4 θ θ r θ s θ r 1 1 a v ψ n v m v 5a θ c ψ θ s l n e x p 1 ψ a f n f m f 5b c ψ 1 l n 1 ψ ψ r l n 1 10 6 ψ r where θs and θr are saturated and residual volumetric water contents respectively exp is exponential function av mv and nv are van genuchten 1980 equation fitting parameters af mf and nf are fredlund and xing 1994 equation fitting parameters c ψ is the correction function for fredlund and xing equation and ψr is residual soil suction the corresponding posd functions for these two equations are summarized below 6a g dry a v n v m v ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 6b f dry a f n f m f ψ m f n f ψ a f n f 1 a f e x p 1 ψ a f n f l n e x p 1 ψ a f n f m f 1 where gdry and fdry are posd functions for drying branch by van genuchten equation and fredlund and xing equation respectively several model parameters are typically suggested by various investigators e g zhou 2013 zhou and sheng 2015 for fitting wetting branches of swcc eqs 7 and 8 belong to this category that use fitting parameters a v wet a f wet n and m 7 θ θ r w e t θ s θ r w e t 1 1 a v wet ψ n v m v 8a θ c ψ θ s l n e x p 1 ψ a f wet n f m f 8b c ψ 1 l n 1 ψ ψ r w e t l n 1 10 6 ψ r w e t where a v wet and a f wet are model parameters for main wetting curve in van genuchten and fredlund and xing equations respectively and ψr wet and θr wet are residual soil suction and volumetric water content for main wetting branch respectively this model for fitting wetting branches of swcc provides a theoretical basis of variation of contact angle during drying and wetting cycles e g eqs 2 and 3 however as summarized earlier various factors affect hysteretic behaviors of the swccs e g irregular pore structures inside soils or the ink bottle effect for this reason another model is introduced for modelling the main wetting curve based on eqs 3 and 4 the drying branch of swcc can be expressed as an integral function form using the van genuchten equation i e eq 9a this equation simply implies that all the pores with radius less than r are filled with water during drying process mualem 1976 however the scenario is distinct in wetting branches due to the irregular pore structures that can associated with the ink bottle effect as shown in fig 2 i i e only part of the pores with radius less than r are filled with water zhai et al 2020 the larger pores obstruct the water soaking process as soil suction during wetting process gradually decreases as shown in fig 2 ii the posd functions e g eq 9a represent the possibility of occurrence of the pores with certain radii r e g fredlund and xing 1994 zhai et al 2020 in addition a new occurrence function fp ψ can also be introduced for modeling irregular pore structure zhai et al 2020 for simplicity purposes a linear accumulative possibility function with a range that varies from zero to a value of one can be applied this approach highlights that each size of pore has an equal occurrence chance as shown in eq 9b 9a θ θ r θ s θ r ψ max ψ p ψ d ψ ψ max ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ 9b θ θ r θ s θ r f p ψ ψ max ψ p ψ d ψ 1 ψ ψ lm 1 ψ hm ψ lm d ψ ψ max ψ p ψ d ψ ψ hm ψ ψ hm ψ lm ψ max ψ p ψ d ψ where fp ψ is occurrence function ψlm and ψhm are soil suction at meeting points of low suction and high suction respectively eq 9b is occurrence function fp ψ that is independent of the posd function this equation can be applied to all the posd functions e g eqs 6 for ensuring flexibility of the model the following eq 10 is suggested for modeling main wetting curve from the main drying curve 10 θ θ r θ s θ r f p ψ ψ max ψ p ψ d ψ p a ψ p a p b ψ r ψ p ψ d ψ p a ψ p a p b ψ r ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ where pa and pb are fitting parameters conventionally minimum soil suction ψmin is approximated as zero while ψmax is assumed to as ψr however to ensure fp ψ is consistent with the physical meaning of posd function fp ψ is always zero when it is lower than zero while fp ψ is set as one when it is larger than one i e eq 11a the model performance of eqs 11 is highlighted in fig 3 11a f p ψ p a ψ p a p b 0 f p ψ 1 11b θ θ r θ s θ r f p ψ ψ r ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ 3 methods of modeling scanning curves fig 4 i and ii summarize a typical swcc with hysteresis and scanning curves such a hysteretic behavior typically observed in a coarse grained soil the terminology and other salient features summarized below as a b and c are useful for explaining the scanning curves characteristics for coarse grained soils 3 1 scanning curves characteristics of coarse grained soils a the curves shapes for scanning drying and wetting curves are similar to main drying curve and wetting curves respectively pham et al 2003 li 2005 zhou 2013 b one meeting point i e points d or a in fig 4 i can be found for each main drying and wetting curves c starting from transition point i e points b or c in fig 4 i the drying or wetting scanning curves are gradually approaching to main drying or wetting curves taking account of the above features in this paper three different methods are proposed that are suitable for coarse grained soils 3 2 the first method the first method also referred to as the general method is built from main drying and wetting curves based on the characteristics of scanning curves summarized in a and c as the scanning wetting curve starts from transition point c e g fig 4 i models for main wetting curve e g eqs 11 should be modified based on bayes theorem of possibility i e eq 12 the required eqs 13 for wetting scanning curves can be derived from eqs 9b and 12 12 p a b p b a p a p b 13a θ θ 0 θ s θ 0 ψ 0 ψ ψ hm ψ lm 1 ψ hm ψ 0 ψ hm ψ lm ψ 0 ψ p ψ d ψ ψ max ψ min p ψ d ψ ψ max ψ 0 p ψ d ψ ψ 0 ψ ψ 0 ψ lm ψ 0 ψ p ψ d ψ ψ 0 ψ min p ψ d ψ p c ψ ψ 0 p d ψ 0 ψ p ψ d ψ ψ 0 0 p ψ d ψ p c ψ ψ 0 p d ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ ψ r 0 p ψ d ψ ψ r ψ 0 p ψ d ψ f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 13b f p ws ψ p c ψ ψ 0 p d 0 f p ws ψ 1 where pc and pd are model parameters θ0 and ψ0 are water content and soil suction at transition point e g point c in fig 4 i respectively similarly by using bayes theorem i e eq 12 the model for drying scanning curve can be expressed as following eqs 14 14a θ θ r θ 0 θ r 1 θ 0 θ θ 0 θ r 1 θ 0 θ θ s θ r θ 0 θ r θ s θ r 1 ψ ψ 0 ψ hm ψ lm ψ ψ 0 p ψ d ψ ψ hm ψ 0 ψ hm ψ lm ψ max ψ 0 p ψ d ψ 1 ψ ψ 0 ψ hm ψ 0 ψ ψ 0 p ψ d ψ ψ max ψ 0 p ψ d ψ 1 ψ ψ 0 ψ hm ψ 0 1 ψ max ψ p ψ d ψ ψ max ψ 0 p ψ d ψ 1 ψ p e p f ψ 0 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 14b θ 0 θ θ 0 θ r ψ p e p f ψ 0 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 14c f p ds ψ ψ p e p f ψ 0 0 f p ds ψ 1 where pe and pf are model parameters combining eqs 6a 13 and 14 the model for scanning curves using van genuchten equation can be expressed as following eqs 15 15a θ 0 θ θ 0 θ r f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 15b θ θ 0 θ s θ 0 f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 15c f p ds ψ ψ p e p f ψ 0 0 f p ds ψ 1 15d f p ws ψ p c ψ ψ 0 p d 0 f p ws ψ 1 15e p ψ g dry a v n v m v ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 to highlight the effect of transition point on scanning curves i e ψ0 in eqs 15c and 15d eqs 15c and 15d are further transformed into eqs 16a and 16b respectively 16a f p ds ψ ψ p e p f ψ 0 ψ ψ 0 ψ 0 p e p f ψ 0 β d λ d ψ ψ 0 16b f p ws ψ p c ψ ψ 0 p d p c ψ 0 ψ 0 ψ ψ 0 p d β w λ w ψ 0 ψ where βd and λd are model parameters for scanning curves of drying while λw and βw are parameters for wetting scanning curves eqs 17 can be summarized in a simplified form based on eqs 15 and 16 17a θ 0 θ θ 0 θ r f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 17b θ θ 0 θ s θ 0 f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 17c f p ds ψ β d λ d ψ ψ 0 0 f p ds ψ 1 17d f p ws ψ β w λ w ψ 0 ψ 0 f p ws ψ 1 17e p ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 both f p ds and f p ws are constrained within zero and a value of one such that they are consistent with the main drying and wetting swccs that were discussed earlier this model can also be explained using the posd curve shown in fig 4 ii water drains from the soil along the main drying curve however starting from transition point c soil is gradually filled with water following wetting scanning curve path during wetting process when soil suction decreases to a certain point only partial pores corresponding to a certain radii r are filled with water similarly drying scanning curves represent the water drainage process from main wetting curve to the main drying curve in the posd curve this process represents partial drainage of water from soil pores e g point f in fig 4 i the model i e eqs 15 for each scanning curve can be calibrated by eq 18 18 o a m n m i n θ pred θ obv 2 where o is the objective function and θpred and θobv are the predicted and measured volumetric water contents respectively the calibration process for the first method i e general method is highlighted in fig 4 iii more details regarding calibration are available in later sections based on the salient features of scanning curves in b and c one condition for scanning curves should always be satisfied i e all the scanning curves will finally reach the meeting point shown as points a or d in fig 4 i eqs 19 summarize boundary conditions that are satisfactory for all the scanning curves 19a θ 0 θ hm θ s θ r β d λ d ψ hm ψ 0 ψ hm ψ 0 p ψ d ψ 19b θ lm θ 0 θ s θ r β w λ w ψ 0 ψ lm ψ 0 ψ lm p ψ d ψ where θlm and θhm are volumetric water contents at meeting points of low suction and high suction respectively the scanning curves will intersect on the main drying and wetting curves at different points as shown in fig 1 i however as suction increases or decreases all the drying or wetting curves respectively will reach the meeting points i e points d or a in fig 4 i at high or low suction range i e eqs 19 eqs 17 define two equations along with two parameters for each scanning curve however only one set of boundary condition is proposed as shown in eqs 19 two simplified methods are proposed to find suitable parameters for using eqs 17 and 19 these methods use two different parameters namely β and λ which are summarized below 3 3 the second method the second method i e constant β method uses eqs 20 by setting a constant β for each scanning curves in eqs 17 this constant is obtained by trial and error method based on the earlier discussions after β is fixed in eqs 17 a suitable λ is found by eqs 19 for each of the scanning curves as shown in the flow chart summarized in fig 4 iii 20a β d c o n s t a n t 20b β w c o n s t a n t 3 4 the third method the third method constant λ method that uses eqs 21 is achieved by setting λ as a constant in eqs 17 the trial and error method is introduced to find a suitable parameter λ for each scanning curve the parameter β for each scanning curve is determined using a constant λ value and boundary conditions i e eqs 19 for this method this calibration process is similar for finding parameter β in the second method as shown in fig 4 iii 21a λ d c o n s t a n t 21b λ w c o n s t a n t the above three methods are targeted for predicting the hysteretic behaviors of coarse grained soils typical results for these three methods namely the first the second and the third methods are presented in figs 5 6 and 7 respectively more discussions and modeling results related to the swcc behaviors of fine grained are summarized in the later sections 4 swcc models for fine grained soils the swcc behavior of fine grained soils is significantly influenced by the initial stress state and the soil structure as shown in fig 8 the relationships between posd and how the swcc behavior is influenced by the void ratio has been discussed extensively in the literature during the last two decades two equations eqs 22a and 22b are widely used in the literature e g gallipoli 2012 hu et al 2013 for understanding the influence of void ratio changes associated with the stress state on the swcc and are summarized as below 22a θ θ r θ s θ r 1 1 ψ ϕ c e ξ c n v m v 22b θ θ r θ s θ r 1 1 a 0 ψ e x p ξ c e e 0 n v m v where ϕc and ξc are fitting parameters a0 is parameter av value at reference state e is void ratio and e0 is the void ratio at reference state 4 1 initial stress state effect in this study a new model is proposed which is based on eq 2b i e ψ r f r c r and ψ r0 c r0 the following approximation can be achieved by regarding contact angle as a constant value 23 ψ r ψ r 0 f r 0 1 r r 0 f r 0 2 r r 0 2 ψ r 0 c r 0 2 r r 0 c r 0 3 r r 0 2 ψ r 0 1 1 r 0 r r 0 1 r 0 2 r r 0 2 where r0 is the size of soil pores at reference state r is the radius of soils pores corresponding to another state as initial void ratio is directly related to pore radius as shown in eq 24a eq 23 can be written as eqs 24b and 24c 24a e r e 0 r 0 24b ψ e ψ e 0 1 1 e 0 e e 0 1 e 0 2 e e 0 2 24c ψ e 0 ψ e 1 ξ c e e 0 ξ c 2 e e 0 2 24d θ θ r θ s θ r 1 1 a 0 ψ 1 ξ c e e 0 ξ c 2 2 e e 0 2 n v m v by substituting eq 24c into eq 4 a new model for incorporating initial stress state effect can be proposed i e eq 24d this eq 22 is equivalent to assuming taylor polynomial of order two to form the exponential equations i e eqs 22 4 2 initial water content effect as shown in fig 8 ii initial stress state decreases first and increases later as initial water content increases for the same compaction effort for fine grained soils such as the clays several researchers e g tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 have investigated to understand the influence of initial water content and proposed various models to explain the swcc behavior the models summarized in the earlier section for initial stress state effect can also be applied to analyze the initial water content effect on swccs for example eqs 25b and 25c can be obtained from eq 25a in this equation the pore size decreases with an increase in the initial water content 25a w i 0 r 0 w i r 25b ψ w i 0 ψ w i 1 ξ i w i w i 0 ξ i 2 w i w i 0 2 25c θ θ r θ s θ r 1 1 a 0 ψ 1 ξ i w i w i 0 ξ i 2 2 w i w i 0 2 n v m v where wi is initial water content wi0 is initial water content at reference state and ξi is a parameter that takes account of the influence of initial water content effect this model can also be explained with the aid of another approach as discussed below as highlighted in fig 8 ii void ratio decreases i e soils become denser for initial compaction water content lower than the optimum water content the fine grained soils compacted in this range of water content i e dry of optimum exhibit flocculated structure and typically have large clod sizes e g vanapalli et al 1999 at optimum soils have lowest void ratio after optimum as void ratio increases and the soil attains a dispersed structure i e smaller clod sizes since the clod size can be represented by pore radius r or ln r as initial water content increases eqs 26b and 26c can be built based on eq 26a 26a ln r 1 ln r 0 ξ c e e 0 26b ln r 1 ln r 0 ξ i w i w i 0 26c r 1 r 0 e x p ξ i w i w i 0 typical swcc models e g van genuchten equation eq 4 can be applied along with the eqs 2 3 9a and 26c to derive the relationship below 27 θ θ r θ s θ r 1 1 a 0 ψ e x p ξ i w i w i 0 n v m v it is important to note that eq 27 does not indicate that swcc relies only on 27 the following eq 28 suggests that both initial stress state and water content contribute to the overall shapes of swccs 28 θ θ r θ s θ r 1 1 a 0 ψ e x p ξ c e e 0 ξ i w i w i 0 n v m v applying second order taylor polynomial to eq 28 at wi0 and e0 respectively the following eq 29 can be achieved 29 a v a 0 e x p ξ c e e 0 ξ i w i w i 0 a 0 1 ξ c e e 0 ξ c 2 2 e e 0 2 1 ξ i w i w i 0 ξ i 2 2 w i w i 0 2 eq 29 is the same as the combined form of eqs 24d and 25c these two equations i e eqs 24d and 25c are derived from two distinct approaches as shown in eqs 28 and 29 parameters ξc and ξi affect each other indirectly for example for different initial water contents a0 is distinct and another ξc value must be adopted in eqs 25c 27 28 and 29 initial water content wi can be used however in some cases only initial stress state void ratio is provided e g fig 8 ii to express swccs behaviors for initial water contents greater than optimum by using the information of initial void ratio the following eq 30 is suggested that is based on the information of void ratio 30 a v a 0 1 ξ i e e 0 ξ i 2 2 e e 0 2 in the above equation e0 denotes void ratio at reference state i e at optimum point swccs for the water contents in dry of optimum zones is adopted to calibrate parameter ξi and void ratio in wet side is used for prediction eqs 31a and 31b are suggested for swccs in dry of optimum zones while eqs 31c and 31d are used for prediction of swccs for wet of optimum zones the model results for initial water content and initial stress state effects are highlighted in figs 9 and 10 respectively 31a θ θ r θ s θ r 1 1 a d 0 1 ξ d e e 0 ξ d 2 2 e e 0 2 ψ n v m v 31b θ θ r θ s θ r 1 1 a w 0 1 ξ w e e 0 ξ w 2 2 e e 0 2 ψ n v m v 31a θ θ r θ s θ r 1 1 a d 0 1 ξ d e e 0 ξ d 2 2 e e 0 2 ψ n v m v 31d θ θ r θ s θ r 1 1 a w 0 1 ξ w e e 0 ξ w 2 2 e e 0 2 ψ n v m v where ad0 and aw0 are av values at reference state for wetting and drying branches respectively ξd and ξw are respectively parameters of drying and wetting branches for modeling initial state effect i e initial stress state or initial water content eqs 31a and 31b are general form equations that reflect both initial stress state and water content effects on swccs however they are expressed in terms of initial stress state eqs 31c and 31d are special cases to reflect initial water content effect on swccs in the wet of optimum zone 5 swcc equations derived from traditional models 5 1 coupled model for addressing multiple parameters on swcc the traditional swcc modeling equations use parameters for predicting swcc for a specific set of conditions however in this study a novel model is presented to evaluate and discuss the influence of multi parameters on the swcc fitting process which is summarized below 32 θ θ r θ s θ r 1 1 a v ψ n v m v 1 1 a v ψ max ψ ψ max n v m v 1 1 a v ψ max n v ψ ψ max n v m v as the ratio of ψ to ψmax is a value that is equal to or less than one the following approximation can be used 33 1 a v ψ max n v ψ ψ max n v 1 ψ ψ max n v a v 2 n v the following eq 34 can be derived by substituting eq 33 into eq 4 34 θ θ r θ s θ r 1 1 a v ψ n v m v 1 1 ψ ψ max n v m v a v ψ max n v from eq 34 various sets of suitable parameters can be obtained the results derived from such model are shown in fig 11 5 2 proposed swcc equation from traditional model a coupled swcc model is feasible in the form of eq 35 below which can be obtained from eq 33 and can be expressed in an exponential form equation as below 35 1 a v 2 n v ψ ψ max n v e x p a v 2 n v ψ ψ max n v eq 36 can be derived by substituting eq 35 into eq 4 36 θ θ r θ s θ r 1 1 a v ψ max n v ψ ψ max n v m v 1 e x p a v 2 n v ψ ψ max n v m v the above swcc model can be put in a simplified form as given below 37 θ θ r θ s θ r 1 e x p n lv a lv ψ m lv where alv nlv and mlv are fitting parameters this swcc model performance is evaluated in fig 12 the posd function for the modified swcc is summarized as eq 38 38 f ψ a lv n lv m lv a lv ψ m lv 1 e x p n lv a lv ψ m lv the following eq 39 is used for swcc model evaluation 39 r 2 i 1 n θ obv θ obv θ pred θ pred 2 i 1 n θ obv θ obv 2 i 1 n θ pred θ pred 2 where θ pred and θ obv are the average values of the predicted and measured volumetric water contents respectively 6 results fig 5 presents the results of scanning curves by the first method i e eqs 15 the various parameters used in this method are listed in table 1 data for sand i sand ii and wray sand is collected from poulovassilis 1970 and gillham et al 1976 respectively the intermediate parameters that are used for comparison purposes in this method are listed in table 2 all parameters summarized in table 2 are obtained by using eq 18 this method used for predicting the scanning curves for sand i provides good comparisons with measured values as shown in fig 5 i for sand ii shown in fig 5 ii predicted scanning curves are reasonable however some predicted values are slightly different from the measured values such a behavior may be attributed to using eqs 11 for predicting the main wetting branch due to this reason the scanning curve is flat when it is close to transition points similar trends in scanning curve predictions can also be observed in fig 5 iii for wray sand fig 6 highlights performance of the second method i e eqs 17 with model constraints eqs 19 and 20 for predicting the scanning curves of swccs for various soils the various parameters required for this method are listed in tables 1 and 3 table 3 summarizes the various intermediate parameters required for calculating or for calibration process constant β is determined by trial and error method as discussed earlier there is a close comparison between the predicted and measured experimental values using the second method see fig 6 and eqs 17 with model constraints eqs 19 and 20 for sand i in fig 6 i all the scanning curves are well predicted for sand ii shown in fig 6 ii the shapes for various scanning curves are well captured however the model performance is a bit weaker when it is close to the transition points the results for wray sand presented in fig 6 iii are similar to sand ii fig 7 presents model results using the third method i e eqs 17 with model constraints eqs 19 and 21 for predicting the scanning curves parameters used for this method are listed in tables 1 and 3 in this method constant λ is calibrated by trial and error method while parameter β is determined by eqs 19 most of the scanning curves are well predicted by this method the results of the third method are similar to the second method fig 9 a and b highlight the model performance for swccs measured using the experimental data from vanapalli et al 1999 on compacted fine grained soil specimens these specimens were prepared with different initial water contents representing dry of optimum optimum and wet of optimum conditions subjected to equivalent stress 0 and 25 kpa respectively the initial stress states are also shown in the figures eqs 31a and 31b are used to predict the data of swcc at wet of optimum conditions using the data of swccs of dry of optimum conditions for calibration the model performance shown in fig 9 a suggests the swccs of wet of optimum conditions are reasonably well predicted the overall trend of predicted swccs i e the dash lines are close to the measured values fig 9 b presents predicted swcc under 25 kpa equivalent pressure the measured points are well predicted by the proposed model the variation of parameter av using exponential i e eq 25b and polynomial i e eq 29 models are shown in fig 9 c and d for dry of optimum specimens exponential form equation leads to higher av values as void ratio increases when the parameter value is the same however for specimens with water content greater than optimum av results in a lower value compared with the polynomial form equation various equations have similar performance when the initial stress state e approaches to the reference state e0 fig 10 summarizes swccs results taking account of the influence of various stress states using eqs 31 for data collected from vanapalli et al 1999 tarantino and col 2008 and tarantino 2009 for sandy clay till speswhite kaolin and barcelona silt bcn silt a sandy clayey silt respectively the lines shown with dashes are curves that are used for calibration while the solid lines are predicted swccs for sandy clay till as shown in fig 10 a the prediction curves provide good agreement with measured points because the difference between void ratio of 0 514 and 0 517 is small both measured data and predictions have some overlap the model validation can also be supported using the results of various soils as shown in fig 10 b c and d the model performance for main wetting curves of speswhite kaolin is presented in fig 10 b the predicted swccs with different void ratios e 1 4 1 6 and 1 8 are close to experimental results fig 10 c and d highlight model performance for main drying and wetting curves of bcn silt barcelona silt respectively as shown in fig 10 c most data are reasonably well captured by the model e g eqs 31 used for prediction in fig 10 d main wetting curves are well predicted by the eq 7 as this model is simple and well accepted in the literature since water retention ability is significantly different for soils in dry and wetting processes the wetting and drying behaviors of swccs under various stress states are also different therefore the values of ξd and ξw herein are also different fig 11 provides one possible solution to multi parametric value problem for modeling swcc based on eq 34 as shown in this figure by setting various ψmax values the model has almost the same performance as the original van genuchten equation i e eq 4 and fig 11 a fig 12 highlights performance of a modified swcc model i e eq 37 this equation is derived from van genuchten equation i e eq 4 and it is expressed as an exponential form as shown in the figure most features of swcc curves are well captured by the proposed swcc model i e eq 37 the modified model results summarized in fig 12 provides close performance with the traditional swcc equation i e eq 4 as can be seen in fig 3 7 discussion fig 2 explains the relationship between main and scanning swccs from the posd curves it is of interest to note that the pore structure is not drastically different for hysteretic processes since the water content of wetting and drying curves varies for the same soil suction the variation of scanning curves in the posd curve is dependent on the water drainage and storage processes fig 3 provides comparison between the measured results of main drying and wetting swccs that were fit using van genuchten i e eq 4 and the predictions using the proposed model i e eqs 11 the proposed model for predicting wetting branches of swcc from drying branch is based on the conceptual model of irregular pore structure or ink bottle effect this model assumes that hysteretic behaviors of swccs are dependent on the distinct water soaking paths this assumption is also consistent with the soils posd curve behavior that is not significantly influenced during the drying and wetting cycles this characteristic is useful in the calculation of posd function that is assumed equal to the derivative function of swcc models for drying branch i e eqs 6 this simplified treatment is widely accepted and used in the literature e g fredlund and xing 1994 zhai et al 2020 figs 5 6 and 7 present the results of the proposed three methods i e first second and third methods respectively for scanning curves these methods are based on the posd curves with clear physical meaning li and vanapalli 2021 i e eqs 15 and 17 these are simple methods with only two parameters and only one parameter needs calibration based on eqs 19 20 and 21 for the second and third methods the second and the third methods i e the simplified methods in comparison to the first method are highlighted because one parameter can be fixed by the boundary condition i e eqs 19 the constant β and λ for the second and the third methods i e eqs 20 and 21 respectively are the only parameter that should be calibrated using experiment of scanning curves these methods are simple and have relatively high accuracy the meeting points listed in table 1 are measured points in main curves or scanning curves the measured points in scanning curves are used as meeting points in some cases e g wray sands in figs 5 6 and 7 because there are several measured points for the main wetting curves if the measured points are sparse in main drying or wetting curves the measured points in scanning curves can be used as meeting points that contribute reasonably to capture the features of all scanning curves in the three methods i e the first second and third methods shown in figs 5 6 and 7 respectively parameters λ and β i e eqs 15c 15d 17c and 17d are restrained to be less than or equal to one however as discussed in the earlier section scanning curves can be used to build water and soil suction relationships between the main curves the large pores may partially be filled with water i e the number of soil pores with the same amount of water is more in comparison of posd curve the values of parameters λ and β might be larger than one for some points in the scanning curve however the constraints i e eqs 17 b and d are applied to ensure relatively reasonable curve shapes for the second and the third methods as shown in figs 6 and 7 respectively experimental data of scanning curves is required for calibration purposes such a method is acceptable to find a constant β or λ value for well predicting all scanning curves however as discussed in previous paragraph different constant β or λ values are possible based on trial and error method as discussed earlier using eqs 19 various acceptable parameters values can be obtained using two sets of parameters with only one set of boundary condition as shown in fig 8 swcc behavior of clayey soils is significantly affected by both initial stress state and initial water content the mechanisms associated with the differences in the swcc behavior due to the influence of initial stress state and water content are rather different various types of pores in clayey soils that include macropores and micropores are affected due to the influence of different stress state for example the soils pores in compacted fine grained soils are also influenced by initial water content which contribute to different soil structure this is strongly related to the soil suction that is dependent on different water contents thus the two major mechanical factors that influence the summarized results in fig 8 ii are isotropic mechanical loading and soil suction equations for initial stress state and water content are similar however the mechanisms are distinct as for parameters ξc and ξi e g eqs 24d and 25c they are independent variables representing two influential factors but they are affected by each other e g eqs 28 and 29 since both describe the swcc i e soil water and suction relationship fig 9 a b and 10 a present results of sandy clay till using model parameters for van genuchten equation i e eq 4 as per the discussions summarized in the last paragraph new parameters ξc and ξi can be introduced to evaluate initial stress state and water content effects however each parameter requires calibration of two curves a set of more suitable parameters for van genuchten equations could be obtained with the same two curves however due to the inherent anisotropic nature of soils posd curves may vary significantly yin and vanapalli 2018 fig 10 summarizes the results from eqs 31 they are useful for explaining the meaning of the model derived from the posd curve i e a polynomial form relationship between pore size and initial stress state or initial water content the effects associated with initial stress state and water content can be explained using eq 40 which is obtained by dividing eq 26a by eq 26b 40 ln r 2 ln r 0 ln r 1 ln r 0 ξ i ξ c w i w i 0 e e 0 the void ratio represents the ratio of void volume to soil solid volume and gravimetric water content is the ratio of the mass of water to the mass of soil solids if the volume and the mass of soil solids are the constant by dividing density of water in both sides in eq 40 the following equation can be obtained 41 ln r 2 ln r 0 ln r 1 ln r 0 1 g s ξ i ξ c v w v w 0 v void v v o i d 0 where gs is specific gravity of soil solids vw and vw0 are volumes of water at initial water content and reference state respectively vvoid and vvoid0 are the volume of void at initial stress state and reference state respectively eq 41 can be expressed in differential form as given below 42 δ ln r 2 δ ln r 1 1 g s ξ i ξ c δ v w δ v void because r1 and r2 represent soil suction ψ1 and ψ2 respectively the left side of eq 42 can also be written as below 43 δ ln r 2 δ ln r 1 dln ψ 2 dln ψ 1 the relationship below can be used since degree of saturation s is the ratio of volume of water to volume of soil voids 44 lim δ 0 δ v wi δ v void s i where si is initial degree of saturation s i denotes the derivative of initial degree of saturation a simplified form of relationship can be derived as below by substituting eqs 43 and 44 into 42 45 dln ψ 2 dln ψ 1 1 g s ξ i ξ c s i eq 45 simply describes the effects of both initial stress state and water content on swccs since soil suction represents soil potential ψ it means that both initial stress state and water content affect the variation of overall soil potential from reference state this effect is imposed by altering initial degree of saturation of soils from its reference state e g wheeler et al 2003 tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 8 conclusions in this paper a new model i e eqs 11 is proposed for predicting main wetting swcc curve the from main drying curve the wetting swcc along with its hysteretic features were predicted for a variety of soils using simple equations based on the posd curve that were linked to the well known swcc fitting equations and a set of boundary conditions three methods for predicting scanning curves as well as the corresponding calibration processes are derived for coarse grained soils i e eqs 15 17 and 19 comprehensive comparisons were provided using these equations between the experimental results and the predicted swccs of both coarse grained soils in addition the swccs of fine grained soils were successfully predicted taking account of the influence of stress state and soil structure associated with different initial water contents i e eqs 31 the multi parametric influences for modelling swccs are also evaluated and discussed i e eq 34 and a modified swcc model i e eq 37 is proposed based on van genuchten equation the proposed equations can be used as tools for predicting various properties of unsaturated soils taking account of the influence of soil hysteresis and scanning curves in addition they can be incorporated into numerical models for analyzing the complex thmc behaviors of unsaturated soils credit authorship contribution statement yao li conceptualization methodology data curation writing original draft visualization software formal analysis investigation sai k vanapalli supervision funding acquisition resources conceptualization methodology writing review editing formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author gratefully acknowledges and appreciates the china scholarship council and university of ottawa canada for joint funding for his ph d research program the second author thanks the support from nserc for his discovery grant research programs the authors sincerely thank the constructive criticism of the reviewers that has significantly contributed to improve this paper 
2996,the focus of this paper is directed towards developing models for predicting the soil water characteristic curves swccs for coarse and fine grained soils taking account influence of hysteresis and various factors such as the stress state and soil structure respectively for achieving this objective several novel models are derived from the pore size distribution posd curve of the swcc and linked to the well known swcc fitting equations three simple methods are developed from the proposed model that can be used for predicting the scanning swccs of coarse grained soils a modified swcc model is built based on the theoretical background developed for the posd curve that is capable for predicting the of fine grained soils taking account influence of the initial water content and stress state in addition a coupled swcc model is proposed that can be used for explaining the influence of multiple soil parameters the proposed novel yet simple models can be used in numerical modeling of complex coupled hydromechanical problems and for predicting of various properties of unsaturated soils keywords soil water characteristic curve pore size distribution curve hysteretic behavior initial water content initial stress state data availability data will be made available on request nomenclature list of notations α is the contact angle af nf and mf are fitting parameters for the swcc equation proposed by fredlund and xing 1994 av mv and nv are fitting parameters for the swcc equation proposed by van genuchten 1980 alv nlv and mlv are fitting parameters for the swcc equation proposed by authors a v wet and a f wet are model parameters for main wetting curve in van genuchten and fredlund and xing equations respectively ad0 and aw0 are parameters at reference state for the wetting and drying branches respectively pa and pb are model parameters for main wetting curves pc pd pe and pf are model parameters for wetting and dry scanning curves respectively βd λd βw and λw are simplified model parameters for the drying and wetting scanning curves respectively c ψ is the correction function for fredlund and xing 1994 equation e and e0 are void ratio and the value at reference state exp is exponential function fp ψ is occurrence function fdry and gdry are posd functions for drying swcc using fredlund and xing 1994 and van genuchten 1980 equations respectively gs is specific gravity of soil solids h is dummy variable of integration representing soil suction min is the function to find minimum value ψ and ψ0 is soil suction and the value at transition point respectively ψlm and ψhm are soil suction at meeting points of low and high suction respectively ψr and ψr wet are residual soil suction for main drying and wetting curves respectively ψmin and ψmax are minimum and maximum soil suction respectively o is the objective function p r or p ψ is pore size distribution ϕc and ξc are the fitting parameters for modeling initial stress state effect ξi is a parameter to represent initial water content effect ξd and ξw are parameters for taking account of the initial state effects respectively for drying and wetting branches of swcc r is pore radius r0 r1 r2 are radii of the soil pores represent reference state initial stress state e and various initial water content wio respectively rmin is minimum pore size in soils s is the degree of saturation si is initial degree of saturation θ and θ0 is the volumetric water content and the value at transition point θlm and θhm are volumetric water contents for meeting points at low suction and high suction respectively θobv and θpred are measured and predicted volumetric water contents respectively θs θr and θr wet are saturated residual volumetric water content of main drying and wetting branches respectively θ r is the volumetric water content when the pores with radius are smaller than r are filled with water θ pred and θ obv the average values of the predicted and measured volumetric water contents respectively t is surface tension vwi and vwio are volumes of water at initial water content and reference state respectively vvoid and vvoid0 are the volume of voids at initial stress state and reference state respectively wi and wi0 are initial water content and the water content at reference respectively 1 introduction the relationship between water content volumetric or gravimetric or degree of saturation and the soil suction is referred to as the soil water characteristic curve swcc the swcc is also widely referred to as the soil moisture curve and soil water retention curve in the literature fredlund and rahardjo 1993 researchers during the past four decades focused on proposing models for predicting the swcc in the literature since conventional measurement techniques are time consuming e g arya and paris 1981 schaap et al 2001 chin et al 2010 li et al 2016 alves et al 2020 li and vanapalli 2022 the focus of most research studies was mainly directed towards predicting the main drying curve during last two decades complex thermo hydro mechanical chemo thmc behaviors of unsaturated soils were also analyzed by many researchers using the swcc as a tool e g wheeler and sivakumar 1995 gallipoli et al 2003 zhou et al 2012b ni et al 2019 yang and vanapalli 2020 xu et al 2020 rong and mccartney 2021 the research related to the swcc has wide applications in water resources agriculture soil science geotechnical and geo environmental engineering fields e g fredlund et al 1994 nemes et al 2001 qi and vanapalli 2015 cary and zapata 2016 zhu et al 2020 cheng et al 2021 the use of swcc as a tool is receiving more attention in the recent literature for understanding the influence of climate change on the thmc behavior of unsaturated soils bai et al 2020 li et al 2021 a family of swcc taking account of influence soil hysteresis is required for rigorous modeling of the soil behavior fig 1 i two approaches are widely used for modeling hysteretic swcc pham et al 2005 in the literature namely physical based domain models e g parlange 1976 hogarth et al 1988 wei and dewoolkar 2006 min and huy 2010 zhou 2013 likos et al 2014 fu et al 2020 and empirical models e g feng and fredlund 1999 pham et al 2003 zhai et al 2020 experimental studies from the literature suggest that the swcc behavior is significantly influenced by the stress state and initial compaction water content that is strongly related to the pore structure in fine grained soils e g vanapalli et al 1999 ng and pang 2000 fredlund et al 2011 during the last two decades several models have been developed to incorporate the influence of initial stress state into swcc e g wheeler et al 2003 gallipoli et al 2003 sun et al 2007 tarantino and col 2008 tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 zhou and sheng 2015 however the initial water content has a significant influence on the soil structure that impacts the swcc behavior especially in compacted fine grained soils the coupled effects of both the initial stress state and initial water contents are not typically incorporated into models for swccs for this reason there is a need for developing models taking account the influence of various parameters to reliably predict the swccs such models would be valuable for various practical applications in water resources agriculture soil science geotechnical and geo environmental engineering fields in this paper simple yet novel models are proposed for predicting the family of swccs i e main drying and wetting swcc along with scanning curves considering hysteretic nature of coarse grained soils from the pore size distribution posd curve using a set of basic functions and boundary conditions the swccs of fine grained soils are also predicted taking account effects of initial stress state and soil structure associated with the initial water content based on the posd curve the various proposed swcc models in this study are presented in fig 1 ii reasonable comparisons were achieved between the experimental and the predicted results of the swccs for both coarse and fine grained soils the proposed models are valuable for use in numerical modeling of the complex thmc modeling problems and for predicting various properties of unsaturated soils taking account of the influences of wetting and drying cycles associated with environmental factors 2 swcc models for coarse grained soils 2 1 model for main wetting curves the family of swcc that constitutes main drying and wetting curves taking account of hysteresis effects and scanning curves is required for rational interpretation of the soil behavior the water content in the swcc associated with the wetting branch is less than the drying branch at any given soil suction as shown in fig 1 i numerous drying and wetting scanning curves are possible within the main drying wetting swccs the major factors that influence the hysteretic swccs pham et al 2005 include i irregular pore structures inside soils or the ink bottle effect ii the contact angle variation during drying and wetting processes iii entrapped air during wetting iv thixotropic regain or aging due to the wetting drying cyclic history water in soils is stored in the interconnected pores mualem and miller 1979 vanapalli et al 1996 li and vanapalli 2021 and the pores with radii r can be reasonably described by their pore size distribution p r when the pores with radius less than r are filled with water the volumetric water content can be expressed as below fredlund and xing 1994 1 θ r r min r p r d r where θ r is the volumetric water content when the pores with radius are smaller than r are filled with water and rmin is the minimum pore size in soils the water stored in larger pores drain easily due to desaturation associated with an increase in the soil suction since the amount of water in pores can be characterized by pore size r an inverse relationship between soil suction ψ and pore radius r is conventionally used fredlund and xing 1994 as shown in eqs 2 2a 1 r ψ 2b ψ c r 2 t c o s α r where c 2tcosα t is surface tension unit n m α is contact angle between soils and water the widely used capillary law i e eq 2b can be introduced into eq 1 to obtain the relationship below 3 θ r ψ max ψ p c h d c h ψ ψ max p c h c h 2 d h where h is a dummy variable of integration representing soil suction and ψmax is the maximum soil suction representing minimum pore radius several swcc equations have been successfully developed in the literature extending the above philosophy two equations i e eq 4 and eqs 5 proposed by van genuchten 1980 and fredlund and xing 1994 respectively are widely used for modeling the swccs 4 θ θ r θ s θ r 1 1 a v ψ n v m v 5a θ c ψ θ s l n e x p 1 ψ a f n f m f 5b c ψ 1 l n 1 ψ ψ r l n 1 10 6 ψ r where θs and θr are saturated and residual volumetric water contents respectively exp is exponential function av mv and nv are van genuchten 1980 equation fitting parameters af mf and nf are fredlund and xing 1994 equation fitting parameters c ψ is the correction function for fredlund and xing equation and ψr is residual soil suction the corresponding posd functions for these two equations are summarized below 6a g dry a v n v m v ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 6b f dry a f n f m f ψ m f n f ψ a f n f 1 a f e x p 1 ψ a f n f l n e x p 1 ψ a f n f m f 1 where gdry and fdry are posd functions for drying branch by van genuchten equation and fredlund and xing equation respectively several model parameters are typically suggested by various investigators e g zhou 2013 zhou and sheng 2015 for fitting wetting branches of swcc eqs 7 and 8 belong to this category that use fitting parameters a v wet a f wet n and m 7 θ θ r w e t θ s θ r w e t 1 1 a v wet ψ n v m v 8a θ c ψ θ s l n e x p 1 ψ a f wet n f m f 8b c ψ 1 l n 1 ψ ψ r w e t l n 1 10 6 ψ r w e t where a v wet and a f wet are model parameters for main wetting curve in van genuchten and fredlund and xing equations respectively and ψr wet and θr wet are residual soil suction and volumetric water content for main wetting branch respectively this model for fitting wetting branches of swcc provides a theoretical basis of variation of contact angle during drying and wetting cycles e g eqs 2 and 3 however as summarized earlier various factors affect hysteretic behaviors of the swccs e g irregular pore structures inside soils or the ink bottle effect for this reason another model is introduced for modelling the main wetting curve based on eqs 3 and 4 the drying branch of swcc can be expressed as an integral function form using the van genuchten equation i e eq 9a this equation simply implies that all the pores with radius less than r are filled with water during drying process mualem 1976 however the scenario is distinct in wetting branches due to the irregular pore structures that can associated with the ink bottle effect as shown in fig 2 i i e only part of the pores with radius less than r are filled with water zhai et al 2020 the larger pores obstruct the water soaking process as soil suction during wetting process gradually decreases as shown in fig 2 ii the posd functions e g eq 9a represent the possibility of occurrence of the pores with certain radii r e g fredlund and xing 1994 zhai et al 2020 in addition a new occurrence function fp ψ can also be introduced for modeling irregular pore structure zhai et al 2020 for simplicity purposes a linear accumulative possibility function with a range that varies from zero to a value of one can be applied this approach highlights that each size of pore has an equal occurrence chance as shown in eq 9b 9a θ θ r θ s θ r ψ max ψ p ψ d ψ ψ max ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ 9b θ θ r θ s θ r f p ψ ψ max ψ p ψ d ψ 1 ψ ψ lm 1 ψ hm ψ lm d ψ ψ max ψ p ψ d ψ ψ hm ψ ψ hm ψ lm ψ max ψ p ψ d ψ where fp ψ is occurrence function ψlm and ψhm are soil suction at meeting points of low suction and high suction respectively eq 9b is occurrence function fp ψ that is independent of the posd function this equation can be applied to all the posd functions e g eqs 6 for ensuring flexibility of the model the following eq 10 is suggested for modeling main wetting curve from the main drying curve 10 θ θ r θ s θ r f p ψ ψ max ψ p ψ d ψ p a ψ p a p b ψ r ψ p ψ d ψ p a ψ p a p b ψ r ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ where pa and pb are fitting parameters conventionally minimum soil suction ψmin is approximated as zero while ψmax is assumed to as ψr however to ensure fp ψ is consistent with the physical meaning of posd function fp ψ is always zero when it is lower than zero while fp ψ is set as one when it is larger than one i e eq 11a the model performance of eqs 11 is highlighted in fig 3 11a f p ψ p a ψ p a p b 0 f p ψ 1 11b θ θ r θ s θ r f p ψ ψ r ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 d ψ 3 methods of modeling scanning curves fig 4 i and ii summarize a typical swcc with hysteresis and scanning curves such a hysteretic behavior typically observed in a coarse grained soil the terminology and other salient features summarized below as a b and c are useful for explaining the scanning curves characteristics for coarse grained soils 3 1 scanning curves characteristics of coarse grained soils a the curves shapes for scanning drying and wetting curves are similar to main drying curve and wetting curves respectively pham et al 2003 li 2005 zhou 2013 b one meeting point i e points d or a in fig 4 i can be found for each main drying and wetting curves c starting from transition point i e points b or c in fig 4 i the drying or wetting scanning curves are gradually approaching to main drying or wetting curves taking account of the above features in this paper three different methods are proposed that are suitable for coarse grained soils 3 2 the first method the first method also referred to as the general method is built from main drying and wetting curves based on the characteristics of scanning curves summarized in a and c as the scanning wetting curve starts from transition point c e g fig 4 i models for main wetting curve e g eqs 11 should be modified based on bayes theorem of possibility i e eq 12 the required eqs 13 for wetting scanning curves can be derived from eqs 9b and 12 12 p a b p b a p a p b 13a θ θ 0 θ s θ 0 ψ 0 ψ ψ hm ψ lm 1 ψ hm ψ 0 ψ hm ψ lm ψ 0 ψ p ψ d ψ ψ max ψ min p ψ d ψ ψ max ψ 0 p ψ d ψ ψ 0 ψ ψ 0 ψ lm ψ 0 ψ p ψ d ψ ψ 0 ψ min p ψ d ψ p c ψ ψ 0 p d ψ 0 ψ p ψ d ψ ψ 0 0 p ψ d ψ p c ψ ψ 0 p d ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ ψ r 0 p ψ d ψ ψ r ψ 0 p ψ d ψ f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 13b f p ws ψ p c ψ ψ 0 p d 0 f p ws ψ 1 where pc and pd are model parameters θ0 and ψ0 are water content and soil suction at transition point e g point c in fig 4 i respectively similarly by using bayes theorem i e eq 12 the model for drying scanning curve can be expressed as following eqs 14 14a θ θ r θ 0 θ r 1 θ 0 θ θ 0 θ r 1 θ 0 θ θ s θ r θ 0 θ r θ s θ r 1 ψ ψ 0 ψ hm ψ lm ψ ψ 0 p ψ d ψ ψ hm ψ 0 ψ hm ψ lm ψ max ψ 0 p ψ d ψ 1 ψ ψ 0 ψ hm ψ 0 ψ ψ 0 p ψ d ψ ψ max ψ 0 p ψ d ψ 1 ψ ψ 0 ψ hm ψ 0 1 ψ max ψ p ψ d ψ ψ max ψ 0 p ψ d ψ 1 ψ p e p f ψ 0 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 14b θ 0 θ θ 0 θ r ψ p e p f ψ 0 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 14c f p ds ψ ψ p e p f ψ 0 0 f p ds ψ 1 where pe and pf are model parameters combining eqs 6a 13 and 14 the model for scanning curves using van genuchten equation can be expressed as following eqs 15 15a θ 0 θ θ 0 θ r f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 15b θ θ 0 θ s θ 0 f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 15c f p ds ψ ψ p e p f ψ 0 0 f p ds ψ 1 15d f p ws ψ p c ψ ψ 0 p d 0 f p ws ψ 1 15e p ψ g dry a v n v m v ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 to highlight the effect of transition point on scanning curves i e ψ0 in eqs 15c and 15d eqs 15c and 15d are further transformed into eqs 16a and 16b respectively 16a f p ds ψ ψ p e p f ψ 0 ψ ψ 0 ψ 0 p e p f ψ 0 β d λ d ψ ψ 0 16b f p ws ψ p c ψ ψ 0 p d p c ψ 0 ψ 0 ψ ψ 0 p d β w λ w ψ 0 ψ where βd and λd are model parameters for scanning curves of drying while λw and βw are parameters for wetting scanning curves eqs 17 can be summarized in a simplified form based on eqs 15 and 16 17a θ 0 θ θ 0 θ r f p ds ψ 1 ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 17b θ θ 0 θ s θ 0 f p ws ψ ψ r ψ p ψ d ψ ψ r ψ 0 p ψ d ψ 1 ψ r ψ 0 p ψ d ψ 17c f p ds ψ β d λ d ψ ψ 0 0 f p ds ψ 1 17d f p ws ψ β w λ w ψ 0 ψ 0 f p ws ψ 1 17e p ψ m v n v a v a v ψ n v 1 1 a v ψ n v m v 1 both f p ds and f p ws are constrained within zero and a value of one such that they are consistent with the main drying and wetting swccs that were discussed earlier this model can also be explained using the posd curve shown in fig 4 ii water drains from the soil along the main drying curve however starting from transition point c soil is gradually filled with water following wetting scanning curve path during wetting process when soil suction decreases to a certain point only partial pores corresponding to a certain radii r are filled with water similarly drying scanning curves represent the water drainage process from main wetting curve to the main drying curve in the posd curve this process represents partial drainage of water from soil pores e g point f in fig 4 i the model i e eqs 15 for each scanning curve can be calibrated by eq 18 18 o a m n m i n θ pred θ obv 2 where o is the objective function and θpred and θobv are the predicted and measured volumetric water contents respectively the calibration process for the first method i e general method is highlighted in fig 4 iii more details regarding calibration are available in later sections based on the salient features of scanning curves in b and c one condition for scanning curves should always be satisfied i e all the scanning curves will finally reach the meeting point shown as points a or d in fig 4 i eqs 19 summarize boundary conditions that are satisfactory for all the scanning curves 19a θ 0 θ hm θ s θ r β d λ d ψ hm ψ 0 ψ hm ψ 0 p ψ d ψ 19b θ lm θ 0 θ s θ r β w λ w ψ 0 ψ lm ψ 0 ψ lm p ψ d ψ where θlm and θhm are volumetric water contents at meeting points of low suction and high suction respectively the scanning curves will intersect on the main drying and wetting curves at different points as shown in fig 1 i however as suction increases or decreases all the drying or wetting curves respectively will reach the meeting points i e points d or a in fig 4 i at high or low suction range i e eqs 19 eqs 17 define two equations along with two parameters for each scanning curve however only one set of boundary condition is proposed as shown in eqs 19 two simplified methods are proposed to find suitable parameters for using eqs 17 and 19 these methods use two different parameters namely β and λ which are summarized below 3 3 the second method the second method i e constant β method uses eqs 20 by setting a constant β for each scanning curves in eqs 17 this constant is obtained by trial and error method based on the earlier discussions after β is fixed in eqs 17 a suitable λ is found by eqs 19 for each of the scanning curves as shown in the flow chart summarized in fig 4 iii 20a β d c o n s t a n t 20b β w c o n s t a n t 3 4 the third method the third method constant λ method that uses eqs 21 is achieved by setting λ as a constant in eqs 17 the trial and error method is introduced to find a suitable parameter λ for each scanning curve the parameter β for each scanning curve is determined using a constant λ value and boundary conditions i e eqs 19 for this method this calibration process is similar for finding parameter β in the second method as shown in fig 4 iii 21a λ d c o n s t a n t 21b λ w c o n s t a n t the above three methods are targeted for predicting the hysteretic behaviors of coarse grained soils typical results for these three methods namely the first the second and the third methods are presented in figs 5 6 and 7 respectively more discussions and modeling results related to the swcc behaviors of fine grained are summarized in the later sections 4 swcc models for fine grained soils the swcc behavior of fine grained soils is significantly influenced by the initial stress state and the soil structure as shown in fig 8 the relationships between posd and how the swcc behavior is influenced by the void ratio has been discussed extensively in the literature during the last two decades two equations eqs 22a and 22b are widely used in the literature e g gallipoli 2012 hu et al 2013 for understanding the influence of void ratio changes associated with the stress state on the swcc and are summarized as below 22a θ θ r θ s θ r 1 1 ψ ϕ c e ξ c n v m v 22b θ θ r θ s θ r 1 1 a 0 ψ e x p ξ c e e 0 n v m v where ϕc and ξc are fitting parameters a0 is parameter av value at reference state e is void ratio and e0 is the void ratio at reference state 4 1 initial stress state effect in this study a new model is proposed which is based on eq 2b i e ψ r f r c r and ψ r0 c r0 the following approximation can be achieved by regarding contact angle as a constant value 23 ψ r ψ r 0 f r 0 1 r r 0 f r 0 2 r r 0 2 ψ r 0 c r 0 2 r r 0 c r 0 3 r r 0 2 ψ r 0 1 1 r 0 r r 0 1 r 0 2 r r 0 2 where r0 is the size of soil pores at reference state r is the radius of soils pores corresponding to another state as initial void ratio is directly related to pore radius as shown in eq 24a eq 23 can be written as eqs 24b and 24c 24a e r e 0 r 0 24b ψ e ψ e 0 1 1 e 0 e e 0 1 e 0 2 e e 0 2 24c ψ e 0 ψ e 1 ξ c e e 0 ξ c 2 e e 0 2 24d θ θ r θ s θ r 1 1 a 0 ψ 1 ξ c e e 0 ξ c 2 2 e e 0 2 n v m v by substituting eq 24c into eq 4 a new model for incorporating initial stress state effect can be proposed i e eq 24d this eq 22 is equivalent to assuming taylor polynomial of order two to form the exponential equations i e eqs 22 4 2 initial water content effect as shown in fig 8 ii initial stress state decreases first and increases later as initial water content increases for the same compaction effort for fine grained soils such as the clays several researchers e g tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 have investigated to understand the influence of initial water content and proposed various models to explain the swcc behavior the models summarized in the earlier section for initial stress state effect can also be applied to analyze the initial water content effect on swccs for example eqs 25b and 25c can be obtained from eq 25a in this equation the pore size decreases with an increase in the initial water content 25a w i 0 r 0 w i r 25b ψ w i 0 ψ w i 1 ξ i w i w i 0 ξ i 2 w i w i 0 2 25c θ θ r θ s θ r 1 1 a 0 ψ 1 ξ i w i w i 0 ξ i 2 2 w i w i 0 2 n v m v where wi is initial water content wi0 is initial water content at reference state and ξi is a parameter that takes account of the influence of initial water content effect this model can also be explained with the aid of another approach as discussed below as highlighted in fig 8 ii void ratio decreases i e soils become denser for initial compaction water content lower than the optimum water content the fine grained soils compacted in this range of water content i e dry of optimum exhibit flocculated structure and typically have large clod sizes e g vanapalli et al 1999 at optimum soils have lowest void ratio after optimum as void ratio increases and the soil attains a dispersed structure i e smaller clod sizes since the clod size can be represented by pore radius r or ln r as initial water content increases eqs 26b and 26c can be built based on eq 26a 26a ln r 1 ln r 0 ξ c e e 0 26b ln r 1 ln r 0 ξ i w i w i 0 26c r 1 r 0 e x p ξ i w i w i 0 typical swcc models e g van genuchten equation eq 4 can be applied along with the eqs 2 3 9a and 26c to derive the relationship below 27 θ θ r θ s θ r 1 1 a 0 ψ e x p ξ i w i w i 0 n v m v it is important to note that eq 27 does not indicate that swcc relies only on 27 the following eq 28 suggests that both initial stress state and water content contribute to the overall shapes of swccs 28 θ θ r θ s θ r 1 1 a 0 ψ e x p ξ c e e 0 ξ i w i w i 0 n v m v applying second order taylor polynomial to eq 28 at wi0 and e0 respectively the following eq 29 can be achieved 29 a v a 0 e x p ξ c e e 0 ξ i w i w i 0 a 0 1 ξ c e e 0 ξ c 2 2 e e 0 2 1 ξ i w i w i 0 ξ i 2 2 w i w i 0 2 eq 29 is the same as the combined form of eqs 24d and 25c these two equations i e eqs 24d and 25c are derived from two distinct approaches as shown in eqs 28 and 29 parameters ξc and ξi affect each other indirectly for example for different initial water contents a0 is distinct and another ξc value must be adopted in eqs 25c 27 28 and 29 initial water content wi can be used however in some cases only initial stress state void ratio is provided e g fig 8 ii to express swccs behaviors for initial water contents greater than optimum by using the information of initial void ratio the following eq 30 is suggested that is based on the information of void ratio 30 a v a 0 1 ξ i e e 0 ξ i 2 2 e e 0 2 in the above equation e0 denotes void ratio at reference state i e at optimum point swccs for the water contents in dry of optimum zones is adopted to calibrate parameter ξi and void ratio in wet side is used for prediction eqs 31a and 31b are suggested for swccs in dry of optimum zones while eqs 31c and 31d are used for prediction of swccs for wet of optimum zones the model results for initial water content and initial stress state effects are highlighted in figs 9 and 10 respectively 31a θ θ r θ s θ r 1 1 a d 0 1 ξ d e e 0 ξ d 2 2 e e 0 2 ψ n v m v 31b θ θ r θ s θ r 1 1 a w 0 1 ξ w e e 0 ξ w 2 2 e e 0 2 ψ n v m v 31a θ θ r θ s θ r 1 1 a d 0 1 ξ d e e 0 ξ d 2 2 e e 0 2 ψ n v m v 31d θ θ r θ s θ r 1 1 a w 0 1 ξ w e e 0 ξ w 2 2 e e 0 2 ψ n v m v where ad0 and aw0 are av values at reference state for wetting and drying branches respectively ξd and ξw are respectively parameters of drying and wetting branches for modeling initial state effect i e initial stress state or initial water content eqs 31a and 31b are general form equations that reflect both initial stress state and water content effects on swccs however they are expressed in terms of initial stress state eqs 31c and 31d are special cases to reflect initial water content effect on swccs in the wet of optimum zone 5 swcc equations derived from traditional models 5 1 coupled model for addressing multiple parameters on swcc the traditional swcc modeling equations use parameters for predicting swcc for a specific set of conditions however in this study a novel model is presented to evaluate and discuss the influence of multi parameters on the swcc fitting process which is summarized below 32 θ θ r θ s θ r 1 1 a v ψ n v m v 1 1 a v ψ max ψ ψ max n v m v 1 1 a v ψ max n v ψ ψ max n v m v as the ratio of ψ to ψmax is a value that is equal to or less than one the following approximation can be used 33 1 a v ψ max n v ψ ψ max n v 1 ψ ψ max n v a v 2 n v the following eq 34 can be derived by substituting eq 33 into eq 4 34 θ θ r θ s θ r 1 1 a v ψ n v m v 1 1 ψ ψ max n v m v a v ψ max n v from eq 34 various sets of suitable parameters can be obtained the results derived from such model are shown in fig 11 5 2 proposed swcc equation from traditional model a coupled swcc model is feasible in the form of eq 35 below which can be obtained from eq 33 and can be expressed in an exponential form equation as below 35 1 a v 2 n v ψ ψ max n v e x p a v 2 n v ψ ψ max n v eq 36 can be derived by substituting eq 35 into eq 4 36 θ θ r θ s θ r 1 1 a v ψ max n v ψ ψ max n v m v 1 e x p a v 2 n v ψ ψ max n v m v the above swcc model can be put in a simplified form as given below 37 θ θ r θ s θ r 1 e x p n lv a lv ψ m lv where alv nlv and mlv are fitting parameters this swcc model performance is evaluated in fig 12 the posd function for the modified swcc is summarized as eq 38 38 f ψ a lv n lv m lv a lv ψ m lv 1 e x p n lv a lv ψ m lv the following eq 39 is used for swcc model evaluation 39 r 2 i 1 n θ obv θ obv θ pred θ pred 2 i 1 n θ obv θ obv 2 i 1 n θ pred θ pred 2 where θ pred and θ obv are the average values of the predicted and measured volumetric water contents respectively 6 results fig 5 presents the results of scanning curves by the first method i e eqs 15 the various parameters used in this method are listed in table 1 data for sand i sand ii and wray sand is collected from poulovassilis 1970 and gillham et al 1976 respectively the intermediate parameters that are used for comparison purposes in this method are listed in table 2 all parameters summarized in table 2 are obtained by using eq 18 this method used for predicting the scanning curves for sand i provides good comparisons with measured values as shown in fig 5 i for sand ii shown in fig 5 ii predicted scanning curves are reasonable however some predicted values are slightly different from the measured values such a behavior may be attributed to using eqs 11 for predicting the main wetting branch due to this reason the scanning curve is flat when it is close to transition points similar trends in scanning curve predictions can also be observed in fig 5 iii for wray sand fig 6 highlights performance of the second method i e eqs 17 with model constraints eqs 19 and 20 for predicting the scanning curves of swccs for various soils the various parameters required for this method are listed in tables 1 and 3 table 3 summarizes the various intermediate parameters required for calculating or for calibration process constant β is determined by trial and error method as discussed earlier there is a close comparison between the predicted and measured experimental values using the second method see fig 6 and eqs 17 with model constraints eqs 19 and 20 for sand i in fig 6 i all the scanning curves are well predicted for sand ii shown in fig 6 ii the shapes for various scanning curves are well captured however the model performance is a bit weaker when it is close to the transition points the results for wray sand presented in fig 6 iii are similar to sand ii fig 7 presents model results using the third method i e eqs 17 with model constraints eqs 19 and 21 for predicting the scanning curves parameters used for this method are listed in tables 1 and 3 in this method constant λ is calibrated by trial and error method while parameter β is determined by eqs 19 most of the scanning curves are well predicted by this method the results of the third method are similar to the second method fig 9 a and b highlight the model performance for swccs measured using the experimental data from vanapalli et al 1999 on compacted fine grained soil specimens these specimens were prepared with different initial water contents representing dry of optimum optimum and wet of optimum conditions subjected to equivalent stress 0 and 25 kpa respectively the initial stress states are also shown in the figures eqs 31a and 31b are used to predict the data of swcc at wet of optimum conditions using the data of swccs of dry of optimum conditions for calibration the model performance shown in fig 9 a suggests the swccs of wet of optimum conditions are reasonably well predicted the overall trend of predicted swccs i e the dash lines are close to the measured values fig 9 b presents predicted swcc under 25 kpa equivalent pressure the measured points are well predicted by the proposed model the variation of parameter av using exponential i e eq 25b and polynomial i e eq 29 models are shown in fig 9 c and d for dry of optimum specimens exponential form equation leads to higher av values as void ratio increases when the parameter value is the same however for specimens with water content greater than optimum av results in a lower value compared with the polynomial form equation various equations have similar performance when the initial stress state e approaches to the reference state e0 fig 10 summarizes swccs results taking account of the influence of various stress states using eqs 31 for data collected from vanapalli et al 1999 tarantino and col 2008 and tarantino 2009 for sandy clay till speswhite kaolin and barcelona silt bcn silt a sandy clayey silt respectively the lines shown with dashes are curves that are used for calibration while the solid lines are predicted swccs for sandy clay till as shown in fig 10 a the prediction curves provide good agreement with measured points because the difference between void ratio of 0 514 and 0 517 is small both measured data and predictions have some overlap the model validation can also be supported using the results of various soils as shown in fig 10 b c and d the model performance for main wetting curves of speswhite kaolin is presented in fig 10 b the predicted swccs with different void ratios e 1 4 1 6 and 1 8 are close to experimental results fig 10 c and d highlight model performance for main drying and wetting curves of bcn silt barcelona silt respectively as shown in fig 10 c most data are reasonably well captured by the model e g eqs 31 used for prediction in fig 10 d main wetting curves are well predicted by the eq 7 as this model is simple and well accepted in the literature since water retention ability is significantly different for soils in dry and wetting processes the wetting and drying behaviors of swccs under various stress states are also different therefore the values of ξd and ξw herein are also different fig 11 provides one possible solution to multi parametric value problem for modeling swcc based on eq 34 as shown in this figure by setting various ψmax values the model has almost the same performance as the original van genuchten equation i e eq 4 and fig 11 a fig 12 highlights performance of a modified swcc model i e eq 37 this equation is derived from van genuchten equation i e eq 4 and it is expressed as an exponential form as shown in the figure most features of swcc curves are well captured by the proposed swcc model i e eq 37 the modified model results summarized in fig 12 provides close performance with the traditional swcc equation i e eq 4 as can be seen in fig 3 7 discussion fig 2 explains the relationship between main and scanning swccs from the posd curves it is of interest to note that the pore structure is not drastically different for hysteretic processes since the water content of wetting and drying curves varies for the same soil suction the variation of scanning curves in the posd curve is dependent on the water drainage and storage processes fig 3 provides comparison between the measured results of main drying and wetting swccs that were fit using van genuchten i e eq 4 and the predictions using the proposed model i e eqs 11 the proposed model for predicting wetting branches of swcc from drying branch is based on the conceptual model of irregular pore structure or ink bottle effect this model assumes that hysteretic behaviors of swccs are dependent on the distinct water soaking paths this assumption is also consistent with the soils posd curve behavior that is not significantly influenced during the drying and wetting cycles this characteristic is useful in the calculation of posd function that is assumed equal to the derivative function of swcc models for drying branch i e eqs 6 this simplified treatment is widely accepted and used in the literature e g fredlund and xing 1994 zhai et al 2020 figs 5 6 and 7 present the results of the proposed three methods i e first second and third methods respectively for scanning curves these methods are based on the posd curves with clear physical meaning li and vanapalli 2021 i e eqs 15 and 17 these are simple methods with only two parameters and only one parameter needs calibration based on eqs 19 20 and 21 for the second and third methods the second and the third methods i e the simplified methods in comparison to the first method are highlighted because one parameter can be fixed by the boundary condition i e eqs 19 the constant β and λ for the second and the third methods i e eqs 20 and 21 respectively are the only parameter that should be calibrated using experiment of scanning curves these methods are simple and have relatively high accuracy the meeting points listed in table 1 are measured points in main curves or scanning curves the measured points in scanning curves are used as meeting points in some cases e g wray sands in figs 5 6 and 7 because there are several measured points for the main wetting curves if the measured points are sparse in main drying or wetting curves the measured points in scanning curves can be used as meeting points that contribute reasonably to capture the features of all scanning curves in the three methods i e the first second and third methods shown in figs 5 6 and 7 respectively parameters λ and β i e eqs 15c 15d 17c and 17d are restrained to be less than or equal to one however as discussed in the earlier section scanning curves can be used to build water and soil suction relationships between the main curves the large pores may partially be filled with water i e the number of soil pores with the same amount of water is more in comparison of posd curve the values of parameters λ and β might be larger than one for some points in the scanning curve however the constraints i e eqs 17 b and d are applied to ensure relatively reasonable curve shapes for the second and the third methods as shown in figs 6 and 7 respectively experimental data of scanning curves is required for calibration purposes such a method is acceptable to find a constant β or λ value for well predicting all scanning curves however as discussed in previous paragraph different constant β or λ values are possible based on trial and error method as discussed earlier using eqs 19 various acceptable parameters values can be obtained using two sets of parameters with only one set of boundary condition as shown in fig 8 swcc behavior of clayey soils is significantly affected by both initial stress state and initial water content the mechanisms associated with the differences in the swcc behavior due to the influence of initial stress state and water content are rather different various types of pores in clayey soils that include macropores and micropores are affected due to the influence of different stress state for example the soils pores in compacted fine grained soils are also influenced by initial water content which contribute to different soil structure this is strongly related to the soil suction that is dependent on different water contents thus the two major mechanical factors that influence the summarized results in fig 8 ii are isotropic mechanical loading and soil suction equations for initial stress state and water content are similar however the mechanisms are distinct as for parameters ξc and ξi e g eqs 24d and 25c they are independent variables representing two influential factors but they are affected by each other e g eqs 28 and 29 since both describe the swcc i e soil water and suction relationship fig 9 a b and 10 a present results of sandy clay till using model parameters for van genuchten equation i e eq 4 as per the discussions summarized in the last paragraph new parameters ξc and ξi can be introduced to evaluate initial stress state and water content effects however each parameter requires calibration of two curves a set of more suitable parameters for van genuchten equations could be obtained with the same two curves however due to the inherent anisotropic nature of soils posd curves may vary significantly yin and vanapalli 2018 fig 10 summarizes the results from eqs 31 they are useful for explaining the meaning of the model derived from the posd curve i e a polynomial form relationship between pore size and initial stress state or initial water content the effects associated with initial stress state and water content can be explained using eq 40 which is obtained by dividing eq 26a by eq 26b 40 ln r 2 ln r 0 ln r 1 ln r 0 ξ i ξ c w i w i 0 e e 0 the void ratio represents the ratio of void volume to soil solid volume and gravimetric water content is the ratio of the mass of water to the mass of soil solids if the volume and the mass of soil solids are the constant by dividing density of water in both sides in eq 40 the following equation can be obtained 41 ln r 2 ln r 0 ln r 1 ln r 0 1 g s ξ i ξ c v w v w 0 v void v v o i d 0 where gs is specific gravity of soil solids vw and vw0 are volumes of water at initial water content and reference state respectively vvoid and vvoid0 are the volume of void at initial stress state and reference state respectively eq 41 can be expressed in differential form as given below 42 δ ln r 2 δ ln r 1 1 g s ξ i ξ c δ v w δ v void because r1 and r2 represent soil suction ψ1 and ψ2 respectively the left side of eq 42 can also be written as below 43 δ ln r 2 δ ln r 1 dln ψ 2 dln ψ 1 the relationship below can be used since degree of saturation s is the ratio of volume of water to volume of soil voids 44 lim δ 0 δ v wi δ v void s i where si is initial degree of saturation s i denotes the derivative of initial degree of saturation a simplified form of relationship can be derived as below by substituting eqs 43 and 44 into 42 45 dln ψ 2 dln ψ 1 1 g s ξ i ξ c s i eq 45 simply describes the effects of both initial stress state and water content on swccs since soil suction represents soil potential ψ it means that both initial stress state and water content affect the variation of overall soil potential from reference state this effect is imposed by altering initial degree of saturation of soils from its reference state e g wheeler et al 2003 tarantino 2009 gallipoli 2012 zhou et al 2012a hu et al 2013 8 conclusions in this paper a new model i e eqs 11 is proposed for predicting main wetting swcc curve the from main drying curve the wetting swcc along with its hysteretic features were predicted for a variety of soils using simple equations based on the posd curve that were linked to the well known swcc fitting equations and a set of boundary conditions three methods for predicting scanning curves as well as the corresponding calibration processes are derived for coarse grained soils i e eqs 15 17 and 19 comprehensive comparisons were provided using these equations between the experimental results and the predicted swccs of both coarse grained soils in addition the swccs of fine grained soils were successfully predicted taking account of the influence of stress state and soil structure associated with different initial water contents i e eqs 31 the multi parametric influences for modelling swccs are also evaluated and discussed i e eq 34 and a modified swcc model i e eq 37 is proposed based on van genuchten equation the proposed equations can be used as tools for predicting various properties of unsaturated soils taking account of the influence of soil hysteresis and scanning curves in addition they can be incorporated into numerical models for analyzing the complex thmc behaviors of unsaturated soils credit authorship contribution statement yao li conceptualization methodology data curation writing original draft visualization software formal analysis investigation sai k vanapalli supervision funding acquisition resources conceptualization methodology writing review editing formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author gratefully acknowledges and appreciates the china scholarship council and university of ottawa canada for joint funding for his ph d research program the second author thanks the support from nserc for his discovery grant research programs the authors sincerely thank the constructive criticism of the reviewers that has significantly contributed to improve this paper 
2997,precise estimation of groundwater level gwl fluctuations has a substantial effect on water resources management in the present study to forecast the regional mean monthly time series groundwater level gwl with a range of 4 82 m in urmia plain three different layer structures of gated recurrent unit gru deep learning based neural network models via the module of sequence to sequence regression are designed in this sense 180 time series datasets of regional mean monthly meteorological hydrological and observed water table depths of 42 different monitoring piezometers during the period of oct 2002 sep 2017 are employed as the input variables by using shannon entropy method the most influential parameters on gwl are determined as regional mean monthly air temperature tam precipitation pm total sum water diversion discharge wdm of four main rivers nevertheless cosine amplitude sensitivity analysis confirmed tam as a dominant factor for preventing overfitting problem an algorithm tuning technique via different kinds of hyperparameters is operated in this respect several scenarios are implemented and the optimal hyperparameters are accomplished via the trial and error process as stated by the performance evaluation metrics model grading process and total learnable parameters tlp value the innovative and unique suggested model 3 entitled gru2 double gru model coupled with addition layer with seven layers is carefully chosen as the best model the unique suggested model 3 in the optimal hyperparameters resulted in an r2 of 0 91 a total grade tg of 7 76 an rmse of 0 094 m and a running time of 47 s thus the model 3 can be certainly employed as an effective model to forecast gwl in different agricultural areas keywords regional mean monthly groundwater level gru neural network shannon entropy method cosine amplitude sensitivity analysis data availability data will be made available on request 1 introduction groundwater considers a noteworthy freshwater supply all over the world howbeit this natural source has confronted with diverse problems such as anthropogenetic processes climatical change consequences and naturalistic events that menace its availability houéménou et al 2020 overconsuming groundwater resources by industry and farming sections has brought about extreme water famine and long lasting hydrological and ecological disasters alabjah et al 2018 a groundwater level gwl is a consequence of diverse time limited and autonomous procedures with unnatural and natural basics accurate prediction of gwl fluctuations trend is regarded as a fundamental process to recuperate the groundwater resources and functional supervision by monitoring the waterway but due to uncertainties in the hydrogeological and meteorological factors nonlinear interactions and some human activities defining a mathematical method to determine gwl over a long period in the agrarian districts is contemplated as an arduous undertaking and also a hot subject for many scholars raghavendra and deka 2016 routinely a hydrogeological process can be scrutinized by three approaches including physical statistical and artificial intelligence ai methods lately by perceptible progressions in computer knowledge some sophisticated mathematical methods have been presented concerning environmental and groundwater hydrology gharehbaghi 2016 2017 2022 dalkiliç and gharehbaghi 2021 chen et al 2017 numerical methods were derived from the partial differential equations yet they have some own restrictions and hitches such as the buildup of physical data especially for the long term gwl forecasting daliakopoulos et al 2005 to date to lessen the difficulties and limitations pertinent to numerical methods some standalone data driven methods ddms machine learning based models mlms have been developed for forecasting gwl shiri et al 2013 sahoo and jha 2013 mohanty et al 2013 meshgi et al 2014 mirzavand et al 2015 chang et al 2016 in spite of these methods were characterized as fairly flexible and systematic schemes some shortcomings have been reported such as overfitting problem and extreme uncertainty yoon et al 2011 as well since the non stationary time series gwl the conventional artificial neural networks anns like feed forward neural network ffnn models were encountered serious difficulties such as weights adjustment and lack of capabilities for remembering prior information coulibaly et al 2001 feng et al 2008 to exclude the all above mentioned problems novel structures of big data analytics by a specific kind of deep neural network dnn based models were developed to address precisely the long term randomization and non stationery nature of gwl they have been renewed as the innovative generation of anns in numerous scientific disciplines in recent years generally dnn models have interior self looped cells which cause to recall the prior info and make it efficient for performing time series based tasks graves 2012 they represent a substantial performance in the capability of neural networks nns for mechanically engineering problem related aspects and learning extremely intricate data distributions in the fields of water resources and hydrology shen 2018 the foremost advantage of modelling by dnns is that physical relationships and variables required for defining the physical environment do not necessitate to be clearly described concerning they evaluate the relationship between model input output by a reiterative aspect of the learning process solomatine and obstfeld 2008 as this study focuses on a time series forecasting task and the behavior modelling also includes temporal dependencies consequently gated recurrent unit gru neural network dnns based could be contemplated as an opposite option rumelhart et al 1986 gru was recommended by cho et al 2014 and evolved as a state of the art architecture of recurrent neural networks rnns it has a comparable chain form building with conventional rnns yet the interior functions in gru cells are further elaborated by supplementary cell states in which information can be kept it can successfully forestall the inherent gradient disappearance difficulty in the conventional neural network under the historical data by using relevant internal gates pan et al 2020 practically gru as an extemporized form of rnns is proficient in learning long term dependencies and sequence data modelling on condition that the data volume is not too big cho et al 2014 in fact gru ponders as a modification type of long short term memory lstm as the most common version of dl based neural network albeit both models perform in the same way gru deliberates as a stand in neural network because it is calculably cheaper a quicker learning curve more condensed construction and less learnable parameters zhang et al 2018 park et al 2019 in the present study different layer structures of gru model are designed that the new suggested robust dl based structure 3 considers an innovative coupled version of gru neural network it is willfully developed to increase the estimation accuracy of the time series gwl thus we do not confine our analysis only to the traditional network structure of gru model lately lstm neural network model has been frequently utilized in the field of hydrological science by majority of scholars to forecast lake water level liang et al 2018 short term daily reference evapotranspiration yin et al 2020 and water table depth in different areas zhang et al 2018 bowes et al 2019 vu et al 2020 jeong et al 2020 jeong and park 2019 employed different dnn methods to forecast gwl the results confirmed that lstm and narx nonlinear auto regressive exogenous neural network models were more precise than arx and gru models chen et al 2020 developed a substitute method of groundwater modeling via gru neural network model to progress the effectiveness of parameter auto calibration and global sensitivity analysis the results attested that gru based adoptive model showed a high capability to handle dilemmas with multiple time series output gao et al 2020 forecasted short term runoff with gru and lstm neural networks without using time step optimization in sample generation they reported that gru model yielded in equivalent results as well as lstm model however gru model was selected as a favored model as it needs less time for model training ghasemlounia et al 2021 forecasted gwl fluctuations by operating bi directional long short term memory bilstm deep neural network without employing meteorological and hydrological variables they reported the proposed model simple double bilstm model combined by multiplication layer with the module of sequence to one as the superior model this model in the piezometer 4 with a range of 4 49 m resulted in an r2 of 0 89 and an rmse of 0 17 m yet in the similar physical features the simple double bilstm model resulted in an r2 of 0 77 and an rmse of 0 25 m wunsch et al 2021 compared the ability of different artificial neural networks including lstm convolutional neural networks cnns and narx neural network in forecasting 17 groundwater wells within upper rhine graben region they equated the performance of developed models for predicting on 4 year period by using both sequence to one seq2val and sequence to sequence seq2seq modules via both gwlt 1 and existing meteorological as the input parameters the results confirmed that in the lack of training information narx model was generally outclassed in both seq2val and seq2seq forecasts module compared to the advanced dl techniques although the function of lstm is a growing investigation domain the performance of different layer structures of gru neural network model for predicting more complex natural phenomena is scarce yet to the best of the authors knowledge despite various examinations in the prediction of gwl using the traditional structure of dl based models no investigation has been executed in the literature on probing the function of exclusive suggested model the novelty of this research is developing an advanced gru based neural network structure with the module of sequence to sequence regression for the prediction of intricate natural phenomena such as time series gwl fluctuations the scope and main aims of the current study are as follows 1 to develop different layer structures of gru based neural network models for precise prediction of the regional mean monthly gwl using observed long period water table depth of several piezometers hydrological and meteorological datasets with time series characteristics in urmia plain west azerbaijan iran 2 to specify the optimal amount of intended hyperparameters such as kind of state activation function saf number of neurons non network architectural design nad and dropout rate p rate for well configuration of designed models to lessen the impact of overfitting problem and 3 to evaluate and analogize outcomes of modelling to single out the best designed model by statistical metrics 2 materials and methods 2 1 study area and data acquisition urmia plain is placed on the western side of urmia lake in urmia city west azerbaijan province northwest of iran among 44 55ʹ 45 18ʹe longitude and 37 20ʹ 37 49ʹn latitude coordinates with 1310 m above sea level it has very fertile land a cold semi arid climate and an area of about 98 100 ha nazloochaei rozehchaei shahrchay and barandozchay are the main rivers and chief surface water stores to irrigate this region that after crossing the western highlands flow into urmia lake the total mean yearly water diversion inflow discharge by main rivers is approximately 830e 6 m3 fig 1 describes the geographical location map of the study area in summer season the amount of real evapotranspiration eta is high so groundwater and surface stores are used as supplementary supplies along with local precipitations the mean annual etpot is 800 1400 mm peak rainfall is mostly concentrated in the months of january to may mean annual precipitation and temperature were reported almost 304 mm and 13 5 c respectively earwo 2020 therefore the area is exposed to water drought and consequently groundwater has a significant influence urmia plain aquifer is unconfined wherein the stream direction of groundwater is from the west on the way to urmia lake in the current research to estimate the time series gwl in the study area time series datasets of 180 monthly meteorological observed water table depths of 42 different piezometers and hydrological datasets during the period of oct 2002 sep 2017 are used the meteorological variables are regional average monthly air temperature tam precipitation pm and evaporation etm collected from different meteorological stations and the used hydrological variable is the regional total sum mean monthly water diversion discharge wdm of the main rivers collected from different hydrometry stations positioned fig 2 illustrates the site of the observation piezometers meteorological and hydrometry stations in the study region together with urmia lake basin and main rivers as can be seen from fig 2 entirely 42 monitoring piezometers are applied so as to cover all study regions with randomly observed water table depth time series plots of regional mean monthly gwl meteorological and hydrological variables between oct 2002 sep 2017 are presented in fig 3 a e according to fig 3 the variables used have a time dimension so time in the monthly dimension should be utilized as an independent factor table 1 presents some descriptive statistics of the variables used wherein cv and stdv signify the coefficient of variation and standard deviation respectively according to table 1 the range of gwl between oct 2002 sep 2017 is 4 82 m 2 2 data preprocessing and sensitivity analysis the collected datasets are appraised to determine the most operative variables on gwl between oct 2002 sep 2017 in the study area since the performance of any modelling technique in the accurate forecasting of target primarily relies on an appropriate selection of predictors inapt choosing could undesirably affect the performance of methods regarding in the current investigation via a weighting method the most important input variables are determined finding a suitable weight for each variable has been regarded as one of the chief principles in multi attribute decision making madm problems concerning shannon entropy shortage of certainty of some measures approach which was introduced by shannon 1948 is one of numerous methods for obtaining weights conferred in the literature because the continuous distribution of a random variable varies from skewed to normal probability the entropy value increases consequently a small value of entropy signifies a futile random variable and more irregularity in a system shannon 1948 shannon entropy can be computed by following steps shannon 1948 step 1 normalize the decision matrix 1 f ij x ij j 1 m x ij j 1 m i 1 n step 2 calculate entropy 2 e i k j 1 m f ij l n f ij 3 k 1 lnn where xij is the rating of meteorological or hydrological station i concerning variable j m is the number of variables fij is the normalized xij n is the number of stations k is the entropy constant and ei is the amount of entropy for variable i step 3 determine uncertainty 4 d i 1 e i where di show the degree of deviation or uncertainty of the data for variable i step 4 determine the significance of variable i 5 w j d i i 1 m d i where wj indicates the weight vector of variable j table 2 presents the computed shannon entropy weight value for used time series meteorological and hydrological variables with respect to gwl the computed weighting coefficients show the comparative significance and heterogeneousness of each selected variable for predicting the time series gwl on the basis of table 2 the effect of etm on gwl is discardable because of its minimal total weight value and consequently least impact thus pm tam and wdm elite as the ultimate effective input variables which among these variables tam owing to the maximum total weight value has a high degree of status and contributes strongly in forecasting gwl as the methods target by discounting the effects of etm for small shannon entropy weight value gwl in final functional form would be as follow 6 gwl f t a m p m w d m equation 6 is a time series of multi input and one output variables and considers capable of modelling by dnns to forecast gwl a sensitivity analysis for variables used in equation 6 is adopted to explain the impression of each input variable on the model target by varying each input variable in a fixed rate and preserving the other input variables as fixed ones cosine amplitude scheme is employed to implement the sensitivity analysis as follow momeni et al 2014 7 r ij k 1 n i ik o jk k 1 n i ik 2 k 1 n o jk 2 where ii and oj are the input and output variables and n is the total number of datasets rij value 0 1 clarifies the strength of relationship between every input variable and the output in equation 6 fig 4 reveals the results of rij that as can be seen tam is the utmost sensitive and significant variable in equation 6 for forecasting gwl albeit it is principally expected that pm and wdm to be as most influential parameters in gwl according to table 2 and fig 4 tam is qualified as the dominant factor an explanation for this unconventionality is that whereas urmia plain is largely located in a semi arid part of iran and consequently perceptible reduction of rainfalls rate and main rivers discharge in this region tam plays a substantial role in gwl and has also significant effect in hydrological studies 2 3 models design in relation to table 1 and fig 3 it is intelligible that gwl has unstable behavior by the kurtosis and skewness it can be distinguished that there is a high degree of basic complexity nature and non linearity relationships among the time series variables used in equation 6 consequently robust accurate techniques are required as above mentioned in this investigation to forecast the time series gwl three different layer structures of gru based neural network models are developed since the severe vacillations of gwl bring about inaccuracy and adversative effects on the learning capability of models all datasets initially should be normalized to unit variance and zero mean then all inputs and output variables are separated into two subsections in this sense 70 of total datasets the first 120 months are utilized for calibration of models and the remaining 60 months are applied for validation 2 3 1 gated recurrent unit gru neural network typical neural networks presume the input output variables are autonomous from each other and do not take into consideration the influence of prior information on the inputs that are not appropriate supposition for long term time series prediction nevertheless rnns recurrent neural networks can remind the prior information and use it for estimating the target at large since rnns can maintain the previous information they can tentatively handle information in randomly long sequences but the ordinary rnns with backpropagation bp training algorithm in the learning long term dependencies presented practically weak performance and come upon problems in modeling athiwaratkun and stokes 2017 gru employs a particular gating mechanism of recurrent neural networks rnns in which for resolving integral deficits and improving capability in learning long period dependencies of the primary rnns i e vanishing gradients a specific structure was subjoined to its cell fig 5 explains the functional mechanism and interior memory cell of gru in fig 5 it is supposed that rt is reset gate of gru at time t xt is the input at time t and ht 1 is the hidden state at time t 1 moreover w r and ur signify a weight matrix for the input data and hidden state respectively cho et al 2014 contrary to lstm gru does not contain isolated memory cells vice versa it employs a single hidden state ht to distribute info over time steps as well the input and forget gates are united with an update gate z and rt is straightly applied to ht 1 to attain ht the candidate state which is added to ht chen et al 2020 the paradigm of gru is portrayed via the following equations cho et al 2014 8 zt σ wzxt uzht 1 bz 9 rt σ wrxt urht 1 br 10 h t t a n h w h x t u h r t h t 1 b h 11 h t 1 z t h t 1 z t h t in the above mentioned equations σ and tanh are the logistic sigmoid and hyperbolic tangent functions respectively the symbol characterizes the element wise multiplication and b is the bias vector they are all learnable and unshared factor sets on account of the sigmoid function impact all gates are a vector with amounts limited within the range 0 1 at what time that rt is closed gru will overlook ht 1 and are affected just by xt also zt regulates how much information of ht 1 can be exceeded to ht cho et al 2014 2 3 2 model development in this investigation to progress the ability of designed models the algorithm tuning technique is operated for sake of this aim by tuning the type of saf p rate value non and nad as main hyperparameters is tried to achieve a suitable configuration to thwart the overfitting problem in the designed models since there is not an efficient principle to predetermine appropriate main hyperparameters for a given model on definite data the current process considers a time consuming and demanding task in this direction numerous scenarios are characterized and the apt main hyperparameters are achieved by the user via a trial and error process first of all as suggested by maier et al 2010 the framework of ann models ought to be designed consistent with the intentions of research in this respect we initially developed the general single gru layer network model 1 by matlab 2021a as is shown in fig 6 a then for the sake of tuning nad hyperparameter two different deeper structural models 2 and 3 namely gru2 and gru2 models are developed as are shown in fig 6 b and c as seen in fig 6 the number of layers in the structural models 1 2 and 3 are 5 6 and 7 respectively indeed the model 2 is a simple double gru model whereas the new proposed model 3 is double gru coupled with addition layer with the module of sequence to sequence regression the model 1 is reflected as our baseline and is applied to compare with the performance of other designed models in the structure of designed models the first layer intakes sequence and time series input variables into the layers network models in this respect tam pm wdm are utilized with time steps standing for months as input variables so its size in all developed gru based structures is set to 3 addition layer adds input variables from several neural network layers element wise with an equal dimension the number of inputs in this layer is regulated indiscreetly by matlab software yet it has merely a sole output the mathworks inc 2021a dnns are suitable to analyze large datasets but too high ones can simply cause overfitting in connection with this because dropout layer offers a functioning regularization system it was utilized to preclude this problem hinton et al 2012 the topmost influence of dropout layer is that at each training repetition by updating the system it discounts systematically or dropout some neurons in operated layers with a probability rate of p value srivastava et al 2014 in the present prediction to tune p rate values of 0 4 0 5 and 0 6 are utilized albeit gru neural network layer has enough skill to learn long term time series data its fitting facility could be inadequate zhang et al 2018 so fully connected layer fc must be added to the utilized structures it multiplies the inputs by a weight matrix and next adds a bias vector to expand the fitting ability of designed models the mathworks inc 2021a regarding its input size in developed models in the training stage is set to auto to specify automatically its size by matlab software and its output size is set to 1 the ending layer of designed gru based models is chosen as a regression output layer by which estimates half mean squared error loss for regression missions by loss function as 12 loss i 1 n y o y p 2 where yp and yo are the predicted and observed value of gwl at time i respectively to tune saf various mixtures of tanh and softsign as the activation function are used in gru layers and to tune non diverse values in each model are tested with the gate activation function of sigmoid to update the network bias and weights of the training options in the designed models adam optimization algorithm with 1000 maximum reiterations with an initial learning rate of 0 5 is selected also to lessen the impact of padding the value of mini batch size is set to 20 and gradient threshold is also set to 1 to deter the gradients exploding predicament indeed these appointed factors are the norm of the developed models which have a noticeable influence on their performance 3 performance evaluation metrics in this investigation the coefficient of determination r2 and root mean square error rmse are utilized to evaluate the accurateness and effectiveness of the designed models in forecasting the time series gwl these statistical metrics are formulated by the following equations as follow 13 r 2 i 1 n x i μ x y i μ y n σ x σ y 2 14 rmse i 1 n x i y i 2 n where n denotes the number of datasets y i and x i are the forecasted and measured gwl at the time i σ y and σ x are the standard deviation of the forecasted and measured gwl respectively μ y and μ x are the forecasted and measured gwl respectively the optimum amounts for the aforesaid metrics are 1 and 0 respectively 4 results and discussion 4 1 validation of general single gru model in the model 1 after several experiments the optimal value for p rate saf and non is attained 0 4 tanh and 75 respectively under the optimal scenario in the training stage after 1000 iterations the value of rmse and loss as the performance metrics are approximately obtained 1e 5 and 1e 7 respectively however the value of learning rate is obtained 5e 8 after calibration this model is validated by the testing datasets results of model 1 with respect to p rate saf and non in the calibration and validation stages are presented in table 3 wherein the bolded amounts denote the optimal scenario features in keeping with table 3 it can be understood that too many non 150 induces to increase rmse because of the overfitting problem but smaller non 50 reduces the network learning ability or the underfitting problem also the model 1 in the training stage is more precise than the testing stage as can be seen from table 3 in the same non by increasing p rate the value of running time decreases yet in the same non and p rate the scenarios with saf of softsign are faster than tanh besides in the same p rate by increasing the value of non the running time increases 4 2 validation of double gru models in the training stage of double gru models under the optimal scenario after 1000 iterations the value of rmse and loss as the performance metrics for simple double gru model 2 gru2 model are obtained about 1e 4 and 1e 5 respectively and for the new proposed model 3 about 1e 5 and 1e 7 respectively besides the value of learning rate for both models is obtained 5e 8 as abovementioned different combinations of activation functions were used in saf of gru layers in the hidden layer of both models in this respect in both models after several trials the tanh softsign combinations are specified as an apt option also the ideal value of p rate and non for both models are achieved 0 5 and 50 respectively results of models 2 and 3 with respect to p rate and non are presented in table 4 wherein the expression tanh softsign implies that the kind of saf in gru layers 1 and 2 are the tanh and softsign respectively and also the bolded quantities denote to the optimal scenarios according to table 4 it is also clear that in both models too many non 150 causes to increase rmse because of the overfitting problem nevertheless the smaller non 30 causes the underfitting problem as well both models in the calibration phase are more precise than the validation phase also in the same non by rising p rate the value of running time decreases however in the same p rate by increasing the value of non the running time increases over and above as said in table 4 it can be discerned that by using dissimilar af in the hidden layers of employed models they can learn more complex and nonlinear functions with regards to the tanh softsign combination causes the model not to be more susceptible to the overfitting problem in the training phase softsign activation function can strengthen the rapidity of models training while tanh activation function can suitably distinguish intricate relationships in the long term time series yin et al 2020 however in this case the kind of data has a momentous impact in figuring which combination ponders as the best one 4 3 performance evaluation of designed models in the current research we emphasize the capacity and infrastructure of designed models to assess their performance relating to matlab 2021a offers a significant parameter namely tlp total learnable parameters as a main measure and norm to determine the physical capacity of designed models a model with optimum nad and non definitely results in a good adjusted tlp and consequently reduces the impacts of overfitting problem concerning table 5 is provided to contribute the features of optimal scenario of designed models in the testing stage in keeping with table 5 the model 2 on account of the maximum value of tlp is instinctively anticipated to be the most precise and the best one all the same in keeping with the evaluation metrics it can be noticed that in the same hyperparameters the new proposed model 3 outperforms and predicts more exactly than models 2 and 1 the performance statistics of the model 3 has resulted in an r2 of 0 91 and an rmse of 0 092 m whilst the model 2 and 1 has resulted in an r2 of 0 56 and 0 796 an rmse of 0 279 and 0 1823 m respectively the chief reason for this disagreement and quirkiness can be explained for too extra value of tlp in the model 2 compared to the model 3 and 1 videlicet the model 2 because of overcapacity memorizes partially the training dataset meaning it relatively overfits and losses in the optimization process in sum the model 2 shows weak performance and is not suitable to estimate the time series gwl in the study area all in all according to the value of tlp in the model 3 it can be concluded that in the same hyperparameters inserting addition layer into the model 2 causes to create a suitable nad with a balanced tlp value furthermore it cannot be always concluded that only by increasing the number of gru layers and non the accuracy and capability of designed models are undoubtedly improved regarding as a topmost result for achieving an operative model an appropriate structural architecture with optimal non and well proportioned tlp along with utilizing the algorithm tuning process must be employed in terms of iterations and running time in the designed models the model 3 attributable to the balanced tlp value begets the model to acquire quicker sub optimum weight sets 1000 iterations in the 47 s nonetheless the gru2 model with the highest tlp induces the model to acquire further and even generally optimal weight sets and consequently takes longer to train 1000 iterations in the 53 s fig 7 demonstrates the schematical comparison of the observed and predicted time series gwl by the designed models in the testing stage visual analysis of fig 7 affirms that the model 3 can suitably remember the previous observed time series gwl and fittingly captures the variation trend however the gru2 model fails to fit data and diverges from the observed values particularly in the peak values that indicate to the high deviations for determining the superior model it is necessary to consider the effect of running time scale in this direction the model grading process proposed by vaheddoost et al 2016 is employed as the supplementary statistical comparison for developed models in this process success grade sg and failure grade fg of performance is defined as follows willmott index wi 15 wi 1 i 1 n x i y i 2 i 1 n y i μ x x i μ x 2 nash sutcliffe efficiency nse 16 nse 1 i 1 n x i y i 2 i 1 n x i μ x 2 17 sg w i w i i w i max 10 18 sg n s e ns e i ns e max 10 19 fg r m s e rms e i rms e max 10 20 fg t i m e tim e i tim e max 10 total grade tg of each model obtains by adding up fg and sg of each model separately which can change between 20 and 20 and is defined as follow 21 tg s g w i s g n s e f g r m s e f g t i m e tg obtained by equations 15 21 is presented in table 6 along with the values of tg in table 6 the model 3 is selected as the superior model for forecasting the time series gwl whereas the results gained by the model 1 are the second best it shows that the newly suggested model 3 outperforms and regards as the best and most accurate model 5 conclusion knowledge of predicting groundwater level fluctuations is essential for operative managing of drinking water exclusively in arid and semi arid regions surface subsiding and security of water resources in this sense in the current research we evaluated gwl fluctuations over a long term in urmia plain a farming region in urmia city west azerbaijan province northwest iran by using three different layer structures of gru based neural network models via the seq2seq module modern deep learning scheme to develop models for precise prediction of gwl with time series features 180 mean monthly observed water table depths of 42 different piezometers during the period oct 2002 sep 2017 were used the situation of the applied piezometers was selected so that cover all study regions with different statistical indices for implementing designed models regional average monthly air temperature tam precipitation pm evaporation etm and total sum mean monthly water diversion discharge wdm of main rivers collected from different meteorological and hydrometry stations were evaluated as potential variables however results of data preprocessing by shannon entropy scheme confirmed pm tam and wdm as the effective input variables yet tam was nominated as the most influential and sensitive one by cosine amplitude sensitivity analysis for better configuration and decreasing overfitting or underfitting problems algorithm tuning by saf p rate and nad as hyperparameters accompanied by the trial and error process was adopted the major outcomes of modelling are as follows 1 all developed models in the calibration stage were more precise than the validation stage also in the same non by rising p rate the value of running time reduced yet in the same p rate by increasing the value of non the running time increased 2 in double gru models after several experiments tanh softsign combinations in saf of gru layers in the hidden layer were specified as an apt option also the optimal value for p rate and non in both models were achieved as 0 5 and 50 respectively 3 despite the maximum value of tlp in the model 2 the new proposed model 3 excelled in the models 2 and 1 the models 3 in comparison with the models 2 and 1 makes to diminish the value of rmse almost by 66 and 48 respectively 4 because of the poor performance of the model 2 as a substantial outcome it can be reasoned that for accomplishing an effective model the optimum nad non and tlp through the algorithm tuning and trial and error processes must be utilized the recommended new operational gru based structure 3 by the authors considers exceptional from usual neural network models and has not been regularly employed in the field of hydrology science it presents a satisfactory state of the art approach since its superiority was proven by practical performance counter to the other ai algorithms it considers so inexpensive uncomplicated and time saving as well in the same hyperparameters owing to the well proportioned nad it caused a balanced tlp value and consequently more precision in comparison with the traditional gru based models yet it was taken too long to train and converge compared to the model 2 even with less non accordingly it can be employed as a smart intellectual model to estimate time series gwl under diverse conditions of water resources management this model under the optimal hyperparameters yielded in an r2 of 0 91 an rmse of 0 094 m and an nse of 0 91 however in the developed models by wunsch et al 2021 under the best method i e narx via the seq2seq module and meteorological input parameters gwl modeling in the applied wells dependence on the range of groundwater resulted in an r2 of among 0 08 and 0 72 an rmse of among 0 07 and 0 52 m and an nse of among 0 07 and 0 9 in spite of the remarkable advantages of the novel model 3 it has some limits such as prerequisite to the continual gauge of different water table depths a high number of monitoring piezometers hydrological and meteorological record of data over a long time period to estimate accurately gwl in a study area also because gwl cannot deliberate as a stationary typical hydrological time series or a consistent natural phenomenon forecasting it with different interval responses in an agricultural area is definitely regarded as a demanding and time consuming problem notwithstanding the present investigation appraised the capability of different structures of gru based model in estimating gwl the approaching studies could be performed by other types of methods via hybridizing dnn models with optimization algorithms such as particle swarm optimization pso fertile field algorithm ffa etc then the consequences should be paralleled with the upshots of the present study so as to the excellent ai technique could be specified to end consistent with the consequences of the current modelling the authors advise tlp factor as a noteworthy criterion and critical measure to assess the forecasting capability and performance of designed dnns based models indeed it determines the practical capacity and can be applied to check the overfitting or underfitting problems funding this study was funded by hasan kalyoncu university and shahid chamran university of ahvaz declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we are grateful to the hasan kalyoncu university and research council of shahid chamran university of ahvaz for financial support gn scu wi98 280 also we are also grateful to hamid saadatnejad gharahassanlou for association 
2997,precise estimation of groundwater level gwl fluctuations has a substantial effect on water resources management in the present study to forecast the regional mean monthly time series groundwater level gwl with a range of 4 82 m in urmia plain three different layer structures of gated recurrent unit gru deep learning based neural network models via the module of sequence to sequence regression are designed in this sense 180 time series datasets of regional mean monthly meteorological hydrological and observed water table depths of 42 different monitoring piezometers during the period of oct 2002 sep 2017 are employed as the input variables by using shannon entropy method the most influential parameters on gwl are determined as regional mean monthly air temperature tam precipitation pm total sum water diversion discharge wdm of four main rivers nevertheless cosine amplitude sensitivity analysis confirmed tam as a dominant factor for preventing overfitting problem an algorithm tuning technique via different kinds of hyperparameters is operated in this respect several scenarios are implemented and the optimal hyperparameters are accomplished via the trial and error process as stated by the performance evaluation metrics model grading process and total learnable parameters tlp value the innovative and unique suggested model 3 entitled gru2 double gru model coupled with addition layer with seven layers is carefully chosen as the best model the unique suggested model 3 in the optimal hyperparameters resulted in an r2 of 0 91 a total grade tg of 7 76 an rmse of 0 094 m and a running time of 47 s thus the model 3 can be certainly employed as an effective model to forecast gwl in different agricultural areas keywords regional mean monthly groundwater level gru neural network shannon entropy method cosine amplitude sensitivity analysis data availability data will be made available on request 1 introduction groundwater considers a noteworthy freshwater supply all over the world howbeit this natural source has confronted with diverse problems such as anthropogenetic processes climatical change consequences and naturalistic events that menace its availability houéménou et al 2020 overconsuming groundwater resources by industry and farming sections has brought about extreme water famine and long lasting hydrological and ecological disasters alabjah et al 2018 a groundwater level gwl is a consequence of diverse time limited and autonomous procedures with unnatural and natural basics accurate prediction of gwl fluctuations trend is regarded as a fundamental process to recuperate the groundwater resources and functional supervision by monitoring the waterway but due to uncertainties in the hydrogeological and meteorological factors nonlinear interactions and some human activities defining a mathematical method to determine gwl over a long period in the agrarian districts is contemplated as an arduous undertaking and also a hot subject for many scholars raghavendra and deka 2016 routinely a hydrogeological process can be scrutinized by three approaches including physical statistical and artificial intelligence ai methods lately by perceptible progressions in computer knowledge some sophisticated mathematical methods have been presented concerning environmental and groundwater hydrology gharehbaghi 2016 2017 2022 dalkiliç and gharehbaghi 2021 chen et al 2017 numerical methods were derived from the partial differential equations yet they have some own restrictions and hitches such as the buildup of physical data especially for the long term gwl forecasting daliakopoulos et al 2005 to date to lessen the difficulties and limitations pertinent to numerical methods some standalone data driven methods ddms machine learning based models mlms have been developed for forecasting gwl shiri et al 2013 sahoo and jha 2013 mohanty et al 2013 meshgi et al 2014 mirzavand et al 2015 chang et al 2016 in spite of these methods were characterized as fairly flexible and systematic schemes some shortcomings have been reported such as overfitting problem and extreme uncertainty yoon et al 2011 as well since the non stationary time series gwl the conventional artificial neural networks anns like feed forward neural network ffnn models were encountered serious difficulties such as weights adjustment and lack of capabilities for remembering prior information coulibaly et al 2001 feng et al 2008 to exclude the all above mentioned problems novel structures of big data analytics by a specific kind of deep neural network dnn based models were developed to address precisely the long term randomization and non stationery nature of gwl they have been renewed as the innovative generation of anns in numerous scientific disciplines in recent years generally dnn models have interior self looped cells which cause to recall the prior info and make it efficient for performing time series based tasks graves 2012 they represent a substantial performance in the capability of neural networks nns for mechanically engineering problem related aspects and learning extremely intricate data distributions in the fields of water resources and hydrology shen 2018 the foremost advantage of modelling by dnns is that physical relationships and variables required for defining the physical environment do not necessitate to be clearly described concerning they evaluate the relationship between model input output by a reiterative aspect of the learning process solomatine and obstfeld 2008 as this study focuses on a time series forecasting task and the behavior modelling also includes temporal dependencies consequently gated recurrent unit gru neural network dnns based could be contemplated as an opposite option rumelhart et al 1986 gru was recommended by cho et al 2014 and evolved as a state of the art architecture of recurrent neural networks rnns it has a comparable chain form building with conventional rnns yet the interior functions in gru cells are further elaborated by supplementary cell states in which information can be kept it can successfully forestall the inherent gradient disappearance difficulty in the conventional neural network under the historical data by using relevant internal gates pan et al 2020 practically gru as an extemporized form of rnns is proficient in learning long term dependencies and sequence data modelling on condition that the data volume is not too big cho et al 2014 in fact gru ponders as a modification type of long short term memory lstm as the most common version of dl based neural network albeit both models perform in the same way gru deliberates as a stand in neural network because it is calculably cheaper a quicker learning curve more condensed construction and less learnable parameters zhang et al 2018 park et al 2019 in the present study different layer structures of gru model are designed that the new suggested robust dl based structure 3 considers an innovative coupled version of gru neural network it is willfully developed to increase the estimation accuracy of the time series gwl thus we do not confine our analysis only to the traditional network structure of gru model lately lstm neural network model has been frequently utilized in the field of hydrological science by majority of scholars to forecast lake water level liang et al 2018 short term daily reference evapotranspiration yin et al 2020 and water table depth in different areas zhang et al 2018 bowes et al 2019 vu et al 2020 jeong et al 2020 jeong and park 2019 employed different dnn methods to forecast gwl the results confirmed that lstm and narx nonlinear auto regressive exogenous neural network models were more precise than arx and gru models chen et al 2020 developed a substitute method of groundwater modeling via gru neural network model to progress the effectiveness of parameter auto calibration and global sensitivity analysis the results attested that gru based adoptive model showed a high capability to handle dilemmas with multiple time series output gao et al 2020 forecasted short term runoff with gru and lstm neural networks without using time step optimization in sample generation they reported that gru model yielded in equivalent results as well as lstm model however gru model was selected as a favored model as it needs less time for model training ghasemlounia et al 2021 forecasted gwl fluctuations by operating bi directional long short term memory bilstm deep neural network without employing meteorological and hydrological variables they reported the proposed model simple double bilstm model combined by multiplication layer with the module of sequence to one as the superior model this model in the piezometer 4 with a range of 4 49 m resulted in an r2 of 0 89 and an rmse of 0 17 m yet in the similar physical features the simple double bilstm model resulted in an r2 of 0 77 and an rmse of 0 25 m wunsch et al 2021 compared the ability of different artificial neural networks including lstm convolutional neural networks cnns and narx neural network in forecasting 17 groundwater wells within upper rhine graben region they equated the performance of developed models for predicting on 4 year period by using both sequence to one seq2val and sequence to sequence seq2seq modules via both gwlt 1 and existing meteorological as the input parameters the results confirmed that in the lack of training information narx model was generally outclassed in both seq2val and seq2seq forecasts module compared to the advanced dl techniques although the function of lstm is a growing investigation domain the performance of different layer structures of gru neural network model for predicting more complex natural phenomena is scarce yet to the best of the authors knowledge despite various examinations in the prediction of gwl using the traditional structure of dl based models no investigation has been executed in the literature on probing the function of exclusive suggested model the novelty of this research is developing an advanced gru based neural network structure with the module of sequence to sequence regression for the prediction of intricate natural phenomena such as time series gwl fluctuations the scope and main aims of the current study are as follows 1 to develop different layer structures of gru based neural network models for precise prediction of the regional mean monthly gwl using observed long period water table depth of several piezometers hydrological and meteorological datasets with time series characteristics in urmia plain west azerbaijan iran 2 to specify the optimal amount of intended hyperparameters such as kind of state activation function saf number of neurons non network architectural design nad and dropout rate p rate for well configuration of designed models to lessen the impact of overfitting problem and 3 to evaluate and analogize outcomes of modelling to single out the best designed model by statistical metrics 2 materials and methods 2 1 study area and data acquisition urmia plain is placed on the western side of urmia lake in urmia city west azerbaijan province northwest of iran among 44 55ʹ 45 18ʹe longitude and 37 20ʹ 37 49ʹn latitude coordinates with 1310 m above sea level it has very fertile land a cold semi arid climate and an area of about 98 100 ha nazloochaei rozehchaei shahrchay and barandozchay are the main rivers and chief surface water stores to irrigate this region that after crossing the western highlands flow into urmia lake the total mean yearly water diversion inflow discharge by main rivers is approximately 830e 6 m3 fig 1 describes the geographical location map of the study area in summer season the amount of real evapotranspiration eta is high so groundwater and surface stores are used as supplementary supplies along with local precipitations the mean annual etpot is 800 1400 mm peak rainfall is mostly concentrated in the months of january to may mean annual precipitation and temperature were reported almost 304 mm and 13 5 c respectively earwo 2020 therefore the area is exposed to water drought and consequently groundwater has a significant influence urmia plain aquifer is unconfined wherein the stream direction of groundwater is from the west on the way to urmia lake in the current research to estimate the time series gwl in the study area time series datasets of 180 monthly meteorological observed water table depths of 42 different piezometers and hydrological datasets during the period of oct 2002 sep 2017 are used the meteorological variables are regional average monthly air temperature tam precipitation pm and evaporation etm collected from different meteorological stations and the used hydrological variable is the regional total sum mean monthly water diversion discharge wdm of the main rivers collected from different hydrometry stations positioned fig 2 illustrates the site of the observation piezometers meteorological and hydrometry stations in the study region together with urmia lake basin and main rivers as can be seen from fig 2 entirely 42 monitoring piezometers are applied so as to cover all study regions with randomly observed water table depth time series plots of regional mean monthly gwl meteorological and hydrological variables between oct 2002 sep 2017 are presented in fig 3 a e according to fig 3 the variables used have a time dimension so time in the monthly dimension should be utilized as an independent factor table 1 presents some descriptive statistics of the variables used wherein cv and stdv signify the coefficient of variation and standard deviation respectively according to table 1 the range of gwl between oct 2002 sep 2017 is 4 82 m 2 2 data preprocessing and sensitivity analysis the collected datasets are appraised to determine the most operative variables on gwl between oct 2002 sep 2017 in the study area since the performance of any modelling technique in the accurate forecasting of target primarily relies on an appropriate selection of predictors inapt choosing could undesirably affect the performance of methods regarding in the current investigation via a weighting method the most important input variables are determined finding a suitable weight for each variable has been regarded as one of the chief principles in multi attribute decision making madm problems concerning shannon entropy shortage of certainty of some measures approach which was introduced by shannon 1948 is one of numerous methods for obtaining weights conferred in the literature because the continuous distribution of a random variable varies from skewed to normal probability the entropy value increases consequently a small value of entropy signifies a futile random variable and more irregularity in a system shannon 1948 shannon entropy can be computed by following steps shannon 1948 step 1 normalize the decision matrix 1 f ij x ij j 1 m x ij j 1 m i 1 n step 2 calculate entropy 2 e i k j 1 m f ij l n f ij 3 k 1 lnn where xij is the rating of meteorological or hydrological station i concerning variable j m is the number of variables fij is the normalized xij n is the number of stations k is the entropy constant and ei is the amount of entropy for variable i step 3 determine uncertainty 4 d i 1 e i where di show the degree of deviation or uncertainty of the data for variable i step 4 determine the significance of variable i 5 w j d i i 1 m d i where wj indicates the weight vector of variable j table 2 presents the computed shannon entropy weight value for used time series meteorological and hydrological variables with respect to gwl the computed weighting coefficients show the comparative significance and heterogeneousness of each selected variable for predicting the time series gwl on the basis of table 2 the effect of etm on gwl is discardable because of its minimal total weight value and consequently least impact thus pm tam and wdm elite as the ultimate effective input variables which among these variables tam owing to the maximum total weight value has a high degree of status and contributes strongly in forecasting gwl as the methods target by discounting the effects of etm for small shannon entropy weight value gwl in final functional form would be as follow 6 gwl f t a m p m w d m equation 6 is a time series of multi input and one output variables and considers capable of modelling by dnns to forecast gwl a sensitivity analysis for variables used in equation 6 is adopted to explain the impression of each input variable on the model target by varying each input variable in a fixed rate and preserving the other input variables as fixed ones cosine amplitude scheme is employed to implement the sensitivity analysis as follow momeni et al 2014 7 r ij k 1 n i ik o jk k 1 n i ik 2 k 1 n o jk 2 where ii and oj are the input and output variables and n is the total number of datasets rij value 0 1 clarifies the strength of relationship between every input variable and the output in equation 6 fig 4 reveals the results of rij that as can be seen tam is the utmost sensitive and significant variable in equation 6 for forecasting gwl albeit it is principally expected that pm and wdm to be as most influential parameters in gwl according to table 2 and fig 4 tam is qualified as the dominant factor an explanation for this unconventionality is that whereas urmia plain is largely located in a semi arid part of iran and consequently perceptible reduction of rainfalls rate and main rivers discharge in this region tam plays a substantial role in gwl and has also significant effect in hydrological studies 2 3 models design in relation to table 1 and fig 3 it is intelligible that gwl has unstable behavior by the kurtosis and skewness it can be distinguished that there is a high degree of basic complexity nature and non linearity relationships among the time series variables used in equation 6 consequently robust accurate techniques are required as above mentioned in this investigation to forecast the time series gwl three different layer structures of gru based neural network models are developed since the severe vacillations of gwl bring about inaccuracy and adversative effects on the learning capability of models all datasets initially should be normalized to unit variance and zero mean then all inputs and output variables are separated into two subsections in this sense 70 of total datasets the first 120 months are utilized for calibration of models and the remaining 60 months are applied for validation 2 3 1 gated recurrent unit gru neural network typical neural networks presume the input output variables are autonomous from each other and do not take into consideration the influence of prior information on the inputs that are not appropriate supposition for long term time series prediction nevertheless rnns recurrent neural networks can remind the prior information and use it for estimating the target at large since rnns can maintain the previous information they can tentatively handle information in randomly long sequences but the ordinary rnns with backpropagation bp training algorithm in the learning long term dependencies presented practically weak performance and come upon problems in modeling athiwaratkun and stokes 2017 gru employs a particular gating mechanism of recurrent neural networks rnns in which for resolving integral deficits and improving capability in learning long period dependencies of the primary rnns i e vanishing gradients a specific structure was subjoined to its cell fig 5 explains the functional mechanism and interior memory cell of gru in fig 5 it is supposed that rt is reset gate of gru at time t xt is the input at time t and ht 1 is the hidden state at time t 1 moreover w r and ur signify a weight matrix for the input data and hidden state respectively cho et al 2014 contrary to lstm gru does not contain isolated memory cells vice versa it employs a single hidden state ht to distribute info over time steps as well the input and forget gates are united with an update gate z and rt is straightly applied to ht 1 to attain ht the candidate state which is added to ht chen et al 2020 the paradigm of gru is portrayed via the following equations cho et al 2014 8 zt σ wzxt uzht 1 bz 9 rt σ wrxt urht 1 br 10 h t t a n h w h x t u h r t h t 1 b h 11 h t 1 z t h t 1 z t h t in the above mentioned equations σ and tanh are the logistic sigmoid and hyperbolic tangent functions respectively the symbol characterizes the element wise multiplication and b is the bias vector they are all learnable and unshared factor sets on account of the sigmoid function impact all gates are a vector with amounts limited within the range 0 1 at what time that rt is closed gru will overlook ht 1 and are affected just by xt also zt regulates how much information of ht 1 can be exceeded to ht cho et al 2014 2 3 2 model development in this investigation to progress the ability of designed models the algorithm tuning technique is operated for sake of this aim by tuning the type of saf p rate value non and nad as main hyperparameters is tried to achieve a suitable configuration to thwart the overfitting problem in the designed models since there is not an efficient principle to predetermine appropriate main hyperparameters for a given model on definite data the current process considers a time consuming and demanding task in this direction numerous scenarios are characterized and the apt main hyperparameters are achieved by the user via a trial and error process first of all as suggested by maier et al 2010 the framework of ann models ought to be designed consistent with the intentions of research in this respect we initially developed the general single gru layer network model 1 by matlab 2021a as is shown in fig 6 a then for the sake of tuning nad hyperparameter two different deeper structural models 2 and 3 namely gru2 and gru2 models are developed as are shown in fig 6 b and c as seen in fig 6 the number of layers in the structural models 1 2 and 3 are 5 6 and 7 respectively indeed the model 2 is a simple double gru model whereas the new proposed model 3 is double gru coupled with addition layer with the module of sequence to sequence regression the model 1 is reflected as our baseline and is applied to compare with the performance of other designed models in the structure of designed models the first layer intakes sequence and time series input variables into the layers network models in this respect tam pm wdm are utilized with time steps standing for months as input variables so its size in all developed gru based structures is set to 3 addition layer adds input variables from several neural network layers element wise with an equal dimension the number of inputs in this layer is regulated indiscreetly by matlab software yet it has merely a sole output the mathworks inc 2021a dnns are suitable to analyze large datasets but too high ones can simply cause overfitting in connection with this because dropout layer offers a functioning regularization system it was utilized to preclude this problem hinton et al 2012 the topmost influence of dropout layer is that at each training repetition by updating the system it discounts systematically or dropout some neurons in operated layers with a probability rate of p value srivastava et al 2014 in the present prediction to tune p rate values of 0 4 0 5 and 0 6 are utilized albeit gru neural network layer has enough skill to learn long term time series data its fitting facility could be inadequate zhang et al 2018 so fully connected layer fc must be added to the utilized structures it multiplies the inputs by a weight matrix and next adds a bias vector to expand the fitting ability of designed models the mathworks inc 2021a regarding its input size in developed models in the training stage is set to auto to specify automatically its size by matlab software and its output size is set to 1 the ending layer of designed gru based models is chosen as a regression output layer by which estimates half mean squared error loss for regression missions by loss function as 12 loss i 1 n y o y p 2 where yp and yo are the predicted and observed value of gwl at time i respectively to tune saf various mixtures of tanh and softsign as the activation function are used in gru layers and to tune non diverse values in each model are tested with the gate activation function of sigmoid to update the network bias and weights of the training options in the designed models adam optimization algorithm with 1000 maximum reiterations with an initial learning rate of 0 5 is selected also to lessen the impact of padding the value of mini batch size is set to 20 and gradient threshold is also set to 1 to deter the gradients exploding predicament indeed these appointed factors are the norm of the developed models which have a noticeable influence on their performance 3 performance evaluation metrics in this investigation the coefficient of determination r2 and root mean square error rmse are utilized to evaluate the accurateness and effectiveness of the designed models in forecasting the time series gwl these statistical metrics are formulated by the following equations as follow 13 r 2 i 1 n x i μ x y i μ y n σ x σ y 2 14 rmse i 1 n x i y i 2 n where n denotes the number of datasets y i and x i are the forecasted and measured gwl at the time i σ y and σ x are the standard deviation of the forecasted and measured gwl respectively μ y and μ x are the forecasted and measured gwl respectively the optimum amounts for the aforesaid metrics are 1 and 0 respectively 4 results and discussion 4 1 validation of general single gru model in the model 1 after several experiments the optimal value for p rate saf and non is attained 0 4 tanh and 75 respectively under the optimal scenario in the training stage after 1000 iterations the value of rmse and loss as the performance metrics are approximately obtained 1e 5 and 1e 7 respectively however the value of learning rate is obtained 5e 8 after calibration this model is validated by the testing datasets results of model 1 with respect to p rate saf and non in the calibration and validation stages are presented in table 3 wherein the bolded amounts denote the optimal scenario features in keeping with table 3 it can be understood that too many non 150 induces to increase rmse because of the overfitting problem but smaller non 50 reduces the network learning ability or the underfitting problem also the model 1 in the training stage is more precise than the testing stage as can be seen from table 3 in the same non by increasing p rate the value of running time decreases yet in the same non and p rate the scenarios with saf of softsign are faster than tanh besides in the same p rate by increasing the value of non the running time increases 4 2 validation of double gru models in the training stage of double gru models under the optimal scenario after 1000 iterations the value of rmse and loss as the performance metrics for simple double gru model 2 gru2 model are obtained about 1e 4 and 1e 5 respectively and for the new proposed model 3 about 1e 5 and 1e 7 respectively besides the value of learning rate for both models is obtained 5e 8 as abovementioned different combinations of activation functions were used in saf of gru layers in the hidden layer of both models in this respect in both models after several trials the tanh softsign combinations are specified as an apt option also the ideal value of p rate and non for both models are achieved 0 5 and 50 respectively results of models 2 and 3 with respect to p rate and non are presented in table 4 wherein the expression tanh softsign implies that the kind of saf in gru layers 1 and 2 are the tanh and softsign respectively and also the bolded quantities denote to the optimal scenarios according to table 4 it is also clear that in both models too many non 150 causes to increase rmse because of the overfitting problem nevertheless the smaller non 30 causes the underfitting problem as well both models in the calibration phase are more precise than the validation phase also in the same non by rising p rate the value of running time decreases however in the same p rate by increasing the value of non the running time increases over and above as said in table 4 it can be discerned that by using dissimilar af in the hidden layers of employed models they can learn more complex and nonlinear functions with regards to the tanh softsign combination causes the model not to be more susceptible to the overfitting problem in the training phase softsign activation function can strengthen the rapidity of models training while tanh activation function can suitably distinguish intricate relationships in the long term time series yin et al 2020 however in this case the kind of data has a momentous impact in figuring which combination ponders as the best one 4 3 performance evaluation of designed models in the current research we emphasize the capacity and infrastructure of designed models to assess their performance relating to matlab 2021a offers a significant parameter namely tlp total learnable parameters as a main measure and norm to determine the physical capacity of designed models a model with optimum nad and non definitely results in a good adjusted tlp and consequently reduces the impacts of overfitting problem concerning table 5 is provided to contribute the features of optimal scenario of designed models in the testing stage in keeping with table 5 the model 2 on account of the maximum value of tlp is instinctively anticipated to be the most precise and the best one all the same in keeping with the evaluation metrics it can be noticed that in the same hyperparameters the new proposed model 3 outperforms and predicts more exactly than models 2 and 1 the performance statistics of the model 3 has resulted in an r2 of 0 91 and an rmse of 0 092 m whilst the model 2 and 1 has resulted in an r2 of 0 56 and 0 796 an rmse of 0 279 and 0 1823 m respectively the chief reason for this disagreement and quirkiness can be explained for too extra value of tlp in the model 2 compared to the model 3 and 1 videlicet the model 2 because of overcapacity memorizes partially the training dataset meaning it relatively overfits and losses in the optimization process in sum the model 2 shows weak performance and is not suitable to estimate the time series gwl in the study area all in all according to the value of tlp in the model 3 it can be concluded that in the same hyperparameters inserting addition layer into the model 2 causes to create a suitable nad with a balanced tlp value furthermore it cannot be always concluded that only by increasing the number of gru layers and non the accuracy and capability of designed models are undoubtedly improved regarding as a topmost result for achieving an operative model an appropriate structural architecture with optimal non and well proportioned tlp along with utilizing the algorithm tuning process must be employed in terms of iterations and running time in the designed models the model 3 attributable to the balanced tlp value begets the model to acquire quicker sub optimum weight sets 1000 iterations in the 47 s nonetheless the gru2 model with the highest tlp induces the model to acquire further and even generally optimal weight sets and consequently takes longer to train 1000 iterations in the 53 s fig 7 demonstrates the schematical comparison of the observed and predicted time series gwl by the designed models in the testing stage visual analysis of fig 7 affirms that the model 3 can suitably remember the previous observed time series gwl and fittingly captures the variation trend however the gru2 model fails to fit data and diverges from the observed values particularly in the peak values that indicate to the high deviations for determining the superior model it is necessary to consider the effect of running time scale in this direction the model grading process proposed by vaheddoost et al 2016 is employed as the supplementary statistical comparison for developed models in this process success grade sg and failure grade fg of performance is defined as follows willmott index wi 15 wi 1 i 1 n x i y i 2 i 1 n y i μ x x i μ x 2 nash sutcliffe efficiency nse 16 nse 1 i 1 n x i y i 2 i 1 n x i μ x 2 17 sg w i w i i w i max 10 18 sg n s e ns e i ns e max 10 19 fg r m s e rms e i rms e max 10 20 fg t i m e tim e i tim e max 10 total grade tg of each model obtains by adding up fg and sg of each model separately which can change between 20 and 20 and is defined as follow 21 tg s g w i s g n s e f g r m s e f g t i m e tg obtained by equations 15 21 is presented in table 6 along with the values of tg in table 6 the model 3 is selected as the superior model for forecasting the time series gwl whereas the results gained by the model 1 are the second best it shows that the newly suggested model 3 outperforms and regards as the best and most accurate model 5 conclusion knowledge of predicting groundwater level fluctuations is essential for operative managing of drinking water exclusively in arid and semi arid regions surface subsiding and security of water resources in this sense in the current research we evaluated gwl fluctuations over a long term in urmia plain a farming region in urmia city west azerbaijan province northwest iran by using three different layer structures of gru based neural network models via the seq2seq module modern deep learning scheme to develop models for precise prediction of gwl with time series features 180 mean monthly observed water table depths of 42 different piezometers during the period oct 2002 sep 2017 were used the situation of the applied piezometers was selected so that cover all study regions with different statistical indices for implementing designed models regional average monthly air temperature tam precipitation pm evaporation etm and total sum mean monthly water diversion discharge wdm of main rivers collected from different meteorological and hydrometry stations were evaluated as potential variables however results of data preprocessing by shannon entropy scheme confirmed pm tam and wdm as the effective input variables yet tam was nominated as the most influential and sensitive one by cosine amplitude sensitivity analysis for better configuration and decreasing overfitting or underfitting problems algorithm tuning by saf p rate and nad as hyperparameters accompanied by the trial and error process was adopted the major outcomes of modelling are as follows 1 all developed models in the calibration stage were more precise than the validation stage also in the same non by rising p rate the value of running time reduced yet in the same p rate by increasing the value of non the running time increased 2 in double gru models after several experiments tanh softsign combinations in saf of gru layers in the hidden layer were specified as an apt option also the optimal value for p rate and non in both models were achieved as 0 5 and 50 respectively 3 despite the maximum value of tlp in the model 2 the new proposed model 3 excelled in the models 2 and 1 the models 3 in comparison with the models 2 and 1 makes to diminish the value of rmse almost by 66 and 48 respectively 4 because of the poor performance of the model 2 as a substantial outcome it can be reasoned that for accomplishing an effective model the optimum nad non and tlp through the algorithm tuning and trial and error processes must be utilized the recommended new operational gru based structure 3 by the authors considers exceptional from usual neural network models and has not been regularly employed in the field of hydrology science it presents a satisfactory state of the art approach since its superiority was proven by practical performance counter to the other ai algorithms it considers so inexpensive uncomplicated and time saving as well in the same hyperparameters owing to the well proportioned nad it caused a balanced tlp value and consequently more precision in comparison with the traditional gru based models yet it was taken too long to train and converge compared to the model 2 even with less non accordingly it can be employed as a smart intellectual model to estimate time series gwl under diverse conditions of water resources management this model under the optimal hyperparameters yielded in an r2 of 0 91 an rmse of 0 094 m and an nse of 0 91 however in the developed models by wunsch et al 2021 under the best method i e narx via the seq2seq module and meteorological input parameters gwl modeling in the applied wells dependence on the range of groundwater resulted in an r2 of among 0 08 and 0 72 an rmse of among 0 07 and 0 52 m and an nse of among 0 07 and 0 9 in spite of the remarkable advantages of the novel model 3 it has some limits such as prerequisite to the continual gauge of different water table depths a high number of monitoring piezometers hydrological and meteorological record of data over a long time period to estimate accurately gwl in a study area also because gwl cannot deliberate as a stationary typical hydrological time series or a consistent natural phenomenon forecasting it with different interval responses in an agricultural area is definitely regarded as a demanding and time consuming problem notwithstanding the present investigation appraised the capability of different structures of gru based model in estimating gwl the approaching studies could be performed by other types of methods via hybridizing dnn models with optimization algorithms such as particle swarm optimization pso fertile field algorithm ffa etc then the consequences should be paralleled with the upshots of the present study so as to the excellent ai technique could be specified to end consistent with the consequences of the current modelling the authors advise tlp factor as a noteworthy criterion and critical measure to assess the forecasting capability and performance of designed dnns based models indeed it determines the practical capacity and can be applied to check the overfitting or underfitting problems funding this study was funded by hasan kalyoncu university and shahid chamran university of ahvaz declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we are grateful to the hasan kalyoncu university and research council of shahid chamran university of ahvaz for financial support gn scu wi98 280 also we are also grateful to hamid saadatnejad gharahassanlou for association 
2998,many large metropolitan areas are especially susceptible to floods generated by heavy short duration rainfall the high density of people buildings and infrastructure in these areas underline the importance of developing flood resilient cities and communities an accurate real time flood forecasting system can support decision making for launching preparedness and response actions in short range hours to days and assist mitigating the disturbances caused by floods this study explores the short range predictive capability of a real time flood forecast system by coupling the high resolution rapid refresh hrrr meteorological forecasted variables with a fully distributed hydrological model wrf hydro we provide a comprehensive analysis of short range 36 h forecasts for 19flood events generated by heavy rainfall in small urban and suburban watersheds 200 km2 in the national capital region of the united states flood forecast performance are then assessed using different metrics based on observed data from u s geological survey stream gauges and reanalysis simulations using the stageiv quantitative precipitation estimates results show that despite the high variability of the hrrr cycle to cycle precipitation forecasts the real time flood forecast system can produce skillful forecasts with similar overall performance as the reanalysis simulations achieving 65 of flood detection rate this variability had more impact on forecast skill in smaller subbasins and flood forecasts were more consistent for longer duration and larger spatial extent rainfall hourly flood forecasts performed well even in smaller watersheds correctly detecting flood occurrence with up to 34 h lead time and resulting in low peak flow magnitude and timing errors keywords severe weather quantitative precipitation forecast high resolution rapid refresh hydrologic modeling wrf hydro data availability all data used to conduct this research is publicly available and can be accessed in the following links 1 usgs stream gauges at https dashboard waterdata usgs gov app nwd aoi default 2 nldas 2 at https disc gsfc nasa gov datasets keywords nldas 3 stage iv qpe at https data eol ucar edu dataset 21 093 and 4 hrrr at https rapidrefresh noaa gov hrrr 1 introduction many large metropolitan areas are especially susceptible to floods generated by heavy short duration rainfall due to natural landscape transformations caused by urban development such as the increase of impervious areas nasem 2019 the high density of people buildings and infrastructure in these areas underline the importance of developing flood resilient cities and communities mcclymont et al 2020 an accurate real time flood forecasting system can support decision making for launching preparedness and response actions at the short range hours to days and assist mitigating the disturbances caused by floods carsell et al 2004 hapuarachchi et al 2011 flood warnings are issued when flooding is expected to threaten life and property shortly hours after the occurrence of a specific event such as heavy rainfall nws 2021 and may not provide enough lead time for effective response actions a real time flood forecast system can enable the issuance of early flood warnings or flood watches to inform the public of conditions that may cause flooding in the near future 1 2 days nws 2021 allowing planning and preparation for an approaching event as well as more effective response actions bischiniotis et al 2019 ritter et al 2021 in the united states u s the weather forecast offices wfo of the national oceanic and atmospheric administration s national weather service noaa nws provide the official weather and flood forecasts based on hydrologic and total water level guidance systems the nws river forecasting system nwsrfs and the national water model nwm are the major noaa operational systems providing hydrologic guidance in the u s the nwsrfs outputs are analyzed in the river forecast centers rfcs that issue deterministic and probabilistic stage and streamflow guidance at over 4 000locations with up to 3 6 days lead time connelly et al 1999 in 2016 the nwm officially started producing short range 18 h medium range 10 days and long range 30 days real time streamflow guidance for about 2 7million river segments in the continental united states bales and flowers 2021 noaa 2022b which until version2 1 was based on the wrf hydro modeling framework gochis et al 2018 in coastal areas the main operational water level predictions systems are the extra tropical storm surge kim et al 1996 and extra tropical surge and tide operational forecast system funakoshi et al 2012 while other systems are also available at the regional scale such as cbofs lanerolle et al 2010 and iflood khalid and ferreira 2020 in the chesapeake bay while flooding can be generated from additional mechanisms such as snowmelt storm surge and dam failure this paper focuses on floods generated by intense precipitation in large metropolitan areas real time flood forecast systems suitable for urban areas may use a wide range of techniques collier 2007 wu et al 2020 and in this study we included three main elements information about watershed conditions prior to the forecast start meteorological forcings from numerical weather prediction nwp and hydrologic modeling quantitative precipitation estimates qpes determine past precipitation and in the real time flood forecast context allow hydrologic simulations for estimating watershed conditions prior to the forecast period quantitative precipitation forecasts qpfs predict future precipitation and are key in real time flood forecasting being the main meteorological forcing of hydrologic simulations heavy short duration precipitation is often generated by convective processes that are challenging to model due to their complex evolution of mesoscale meteorological features kerr et al 2017 requiring high resolution order 1 km and convection allowing nwp models the high resolution rapid refresh hrrr is a storm resolving model designed to provide guidance on convective precipitation forecasts at 3 km resolution from the noaa national centers for environmental prediction ncep benjamin et al 2016 the operational hrrr version3 has 18 h duration forecasts with 15 min and 1 h time steps updated every hour and a 36 h duration product with 1 h time step but updated every 6 h the hrrr with 18 hour duration is the meteorological forcing used in the nwm short range forecast and was also adopted in previous short range hydrologic forecasting studies e g awol et al 2021 ghimire et al 2021 seo et al 2018 however the hrrr version3 with 36 hour duration has not been widely studied for producing real time flood forecasting hydrologic modeling has been extensively used for many decades using historical data e g abbott et al 1986 beven 2002 burnash 1973 clark et al 2015 gochis et al 2018 odgen 1997 tijerina et al 2021 serving as a foundation for real time flood forecast systems previous hydrologic forecast studies explored short range 3days awol et al 2021 ghimire et al 2021 seo et al 2018 viterbo et al 2020 and medium 3 10 days to long range 10 days e g adams and dymond 2018 addor et al 2011 arnal et al 2018 emerton et al 2018 liu et al 2022 seo et al 2018 and ghimire et al 2021 showed that hrrr qpf errors generally increase with increasing lead times and decrease with increasing basin size based on streamflow forecasting for the state of iowa awol et al 2021 compared streamflow forecasts from different lumped models and one semi distributed hydrologic model in urban and suburban watersheds in canada and obtained the best results when using the hrrr qpfs viterbo et al 2020 revealed that the hrrr can produce skillful precipitation forecast guidance in terms of area and intensity for high intensity mesoscale events however small qpf displacements influenced the hydrological response at the watershed scale resulting in cycle to cycle shifts for an event in ellicott city md in 2018 although a vast literature on hydrologic hindcasting which is mostly based on observed and assimilated meteorological forcing is available there are limited studies of real time short range hydrologic forecasting using nwp especially in urban and semiurban watersheds most of the previous studies focused on rainfall and streamflow prediction without directly relating the results to flood occurrence and limited to a single watershed wu et al 2020 other studies provided a comprehensive analysis of real time flood forecasting during a single flood event e g seo et al 2018 viterbo et al 2020 however examining multiple flood events across different catchments in large metropolitan areas can provide a better understanding of the effect of qpfs on flood prediction consistency variations in watershed response and implications for real time flood forecasting additionally the application of the hrrr for real time flood forecasting has not been examined for durations beyond 18 h and extending the lead time above this threshold could provide significant value for anticipating flood events the objective of this study was to explore the short range predictive capability of a real time flood forecast system forced with the hrrr in multiple urban and semiurban watersheds and lead times up to 36 h while also attempting to understand the impacts of qpf on the quality of the flood forecast considering the potential benefits of increased forecast lead time such as enabling more effective preparedness and response actions we chose the 36 hour hrrrv3 to assess the short range flood forecast capabilities that can be enabled by current noaa nws nwp complementing the knowledge beyond the 18 hour lead time covered in previous studies seo et al 2018 viterbo et al 2020 to accomplish this goal we developed a real time flood forecast system for the national capital region ncr of the united states including a method for preserving the watershed memory and estimating initial conditions at the forecast start this study was conducted between 20may and 31oct2020 when 19heavy and short duration rainfall events generated floods in the ncr for each event we characterized the qpf errors in precipitation magnitude timing and spatial displacement in comparison with qpes flood forecast simulations are then assessed using data from u s geological survey usgs stream gauges and reanalysis simulations forced with qpes with respect to flood detection skill peak flow timing and magnitude errors lead time and model performance the main contribution consists of exploring multiple flood events systematically across spatial scales and forecast lead times up to 36 h providing key insights on the short range in real time flood forecasting 2 material and methods 2 1 study region and verification data the study region encompasses a rectangular domain 52 km west east by 50 km south north fig 1 in the ncr the ncr is comprised of montgomery and prince george s counties in maryland the northern virginia region nvr and washington dc collectively with a total population of about 5 8million people u s census bureau 2021 the regional climate is temperate humid subtropical characterized by no dry season and a hot summer meaning that there is no significant mean precipitation difference between seasons beck et al 2018 peel et al 2007 the ncr is frequently affected by precipitation driven floods and includes socio economically vulnerable populations to flood as reported by tanir et al 2021 supporting the relevance of a real time flood forecast in this region the model domain was delimited to include gauged watersheds entirely contained in the ncr with different sizes providing a representative multi spatial analysis of the flood forecast system five watersheds contributing to the potomac river are included i e difficult run four mile run and cameron run in virginia and rock creek and anacostia river located both in maryland and washington dc the elevation ranges from 0 to 196 m fig 1 c and most of the studied watersheds are urbanized while difficult run and the upper areas of rock creek and anacostia river watersheds have different types of vegetation cover fig 1 d streamflow data was obtained from the usgs stream gauge network at nine locations as presented in fig 1 and listed in table 1 the stream gauges used in this study are included in the advanced hydrologic prediction service ahps network and are used by the nws to issue flood watches and flood warnings along with the weather forecasts the drainage areas of the subbasins included in this study vary between 7and 189 km2 and for the remainder of the paper we will refer to subbasins 2 3 4 5 and 8 as the smaller 100 km2 and subbasins 1 7 and 9 as the larger 100 km2 subbasins 2 2 flood forecast system framework the flood forecast workflow includes the retrieval of assimilated meteorological data for estimating watershed conditions prior to the forecast start stored in warm start files retrieval of nwp data for forcing the model a fully distributed hydrological model and the analysis of forecast outputs fig 2 a the flood forecast system was designed to produce four forecasts per day with 36 hour duration starting at 0000 0600 1200 and 1800utc fig 2 b while the nwm produce a new short range forecast with 18 hour duration every hour each forecast simulation starts from a warm start file produced from two previous simulation stages i e spinup and hindcast aiming to maintain a watershed memory and provide the best representation of the model hydrologic state at the present time the initial spinup simulation began on 1oct2017 to include one complete water year before the calibration period and more than two years before producing forecasts the spinup simulation is updated daily using meteorological assimilated data that is available up to three days before the present time the hindcast simulation was forced by observed precipitation and meteorological forecasted data and includes the period between the end of the spinup and the initial forecast time 2 2 1 hydrologic modeling the weather research and forecasting model hydrological modeling system wrf hydro was used to perform distributed hydrologic simulations and provide streamflow predictions wrf hydro is an open source and community based modeling architecture developed to facilitate the representation of surface subsurface and channel water flow in a 2 dimensional domain and to enable coupling with atmospheric models gochis et al 2018 a brief overview of the selected wrf hydro configuration is provided in this section while a detailed description can be found in gochis et al 2018 the wrf hydro version5 0 was compiled for one way coupling simulations and using the noah multiparameterization noah mp niu et al 2011 as the land surface model lsm in a 1 km spatial resolution grid the lateral saturated subsurface flow was computed using the quasi 3d flow implemented in the distributed hydrology soil vegetation model dhsvm wigmosta et al 1994 wigmosta and lettenmaier 1999 and the surface overland flow calculation uses a fully unsteady spatially explicit and diffusive wave formulation julien et al 1995 odgen 1997 the channel routing is performed through the gridded channel network using an explicit one dimensional variable time stepping diffusive wave formulation which is a simplification of the more general st venant equations for shallow water wave flow gochis et al 2018 the subsurface flow overland flow and channel routing calculations are performed in the high resolution routing grid prepared with 100 m spatial resolution the rainfall runoff transformation is computed by noah mp in the lsm grid and the infiltration excess and soil exfiltration passed to the high resolution routing grid at each time step gochis et al 2018 we highlight that the impervious coverage is not explicitly represented in wrf hydro version 5 0 the base flow parameterization uses a conceptual groundwater bucket that receives the soil columns drainage from the lsm and slowly discharges the water into the channel grids using an exponential storage discharge function gochis et al 2018 the most relevant parameters for developing a short range forecast system were identified based on the wrf hydro literatures gochis et al 2018 senatore et al 2015 silver et al 2017 yucel et al 2015 zhang et al 2020 and the values were defined based on a sensitivity analysis the wrf hydro parameters named infiltration factor refkdt slope index slope saturated soil hydraulic conductivity dksat multiplier on saturated hydraulic conductivity in lateral flow direction lksatfac multiplier on surface roughness ovroughrt and channel manning roughness mann were calibrated using the dynamically dimensioned search dds algorithm tolson and shoemaker 2007 for each gauged watershed based on the period of 1oct2018 through 30sep2019 see supplementary data s1 2 2 2 meteorological forcings the meteorological forcing variables required by noah mp in wrf hydro are incoming shortwave and longwave radiation specific humidity air temperature surface pressure near surface wind and precipitation rate the forecast simulations were forced using the operational conus hourly product from hrrr version3 with a 36 hour duration and updated every 6 h benjamin et al 2016 this product was chosen over the 18 hour duration and hourly updated hrrr product used in previous studies e g awol et al 2021 ghimire et al 2021 seo et al 2018 viterbo et al 2020 aiming to evaluate the flood predictions for a longer lead time the original hrrr files for the entire conus with 3 km spatial resolution are regridded to the 1 km wrf hydro lsm grid using an earth system modeling framework esmf regridding script pan et al 2018 written in ncar command language ncl ncar 2019 in the spinup simulations we used the north american land data assimilation system phase2 nldas 2 xia et al 2012 to obtain the meteorological forcing variables required by noah mp with the exception of precipitation the nldas 2 data is provided in a 0 125 degree spatial resolution and is also regridded by bilinear interpolation to the 1 km wrf hydro lsm grid using an esmf regridding script ikeda et al 2018 for the precipitation forcing we adopted the stageiv qpe nelson et al 2016 from the noaa nws ncep which is a near real time product generated from the nexrad precipitation processing system pps seo and breidenbach 2002 and the nws river forecast center rfc precipitation processing fulton et al 1998 the gridded precipitation in the conus is provided at a 4 km spatial resolution and was regridded by bilinear interpolation to the 1 km wrf hydro lsm grid using an esmf regridding script prepared by the author in the hindcast simulations we also used the stageiv for the precipitation but the hrrr for all other meteorological forcing variables this methodology was used because the nldas 2 is updated daily with a 3 day lag time which creates a time window with limited availability of observed and assimilated meteorological data hence the hindcast simulations allowed us to overcome this limitation and estimate the initial conditions at the forecast start 2 3 severe weather events this study was conducted during the period of 20may 30oct 2020 when 19severe weather events were identified table 2 the nws ahps provides a flood classification system with four categories associated to its magnitude 1 action near flood 2 minor flood 3 moderate flood and 4 major flood stage noaa nws 2022 the stage and discharge respective to each flood category will vary at each location and are presented in table s2 in supplementary data 1 we defined that a severe weather event occurred when at least one of the nine stream gauges in the model domain reached action stage during or after a rainfall event a minimum time interval of six consecutive hours without rain accumulation over the model domain was adopted to separate different rainfall events 2 4 flood forecast evaluation we evaluated the flood forecast system based on the precipitation forcing and runoff responses for all forecast cycles overlapping each one of the 19severe weather events usually four to six forecast cycles the severe weather event time window consists of the period between the rainfall start and runoff end we performed reanalysis simulations to establish a baseline for the model performance during each forecast cycle where the model was forced using the same initial conditions and meteorological forcing variables from the hrrr but with the stageiv qpe here after referred as reanalysis simulation the stageiv qpe represents the best possible performance of the current model configuration in case a better precipitation product was available at the forecast time the differences between this reanalysis simulation and observed data can mostly be attributed to errors in the qpes and hydrologic model while the comparison between reanalysis and forecast simulations enables the isolation of flood prediction errors solely attributed to the qpf error hence the flood forecast performance evaluation was conducted in five steps 1 quantification of flood detection skill 2 evaluation of the peak flow magnitude and timing errors and relation with lead time 3 assessment of hrrr qpf displacement magnitude and timing errors in comparison with the stageiv qpe and impacts of flood forecast results 4 analysis of hourly simulations on sub hourly watershed response and 5 investigation of forecast performance during the most extreme event 2 4 1 flood detection skill the flood detection skill provides an overall picture of the simulations performance and ability of the system to accomplish the main objective of the flood forecast system which is detecting the flood signal defined by occurrence of nws action stage we used five common skill scores to assess the flood detection skill of reanalysis and forecast simulations based on a contingency table table 3 the metrics consist of the hit rate hr false alarm rate far critical success index csi equitable threat score ets or gilbert skill score and frequency bias fb calculated as follows 1 hr tp tp f n 2 far fp tp f p 3 csi tp tp f p f n 4 ets tp tp random tp f n f p tp random where 5 tp random t p f n t p f p tp f p f n t p 6 fb tp f p tp f n the values in table 3 were computed based on the reanalysis and forecast simulations results for all 19events at each station a positive result is marked when the simulation reaches action stage and is classified as true or negative using the observed data as ground truth once there is more than one forecast cycle overlapping the duration of each event we considered that a true positive or false positive occurred when at least one forecast cycle reached action stage the hr quantifies the fraction of simulations that correctly detect true flood events while the far indicates the fraction of detected flood events that did not occur the fb shows when flood events are overpredicted ratio of the total number of detected flood events to the total number of observed the ets provides the overall forecast skill measuring the fraction of the observed and forecast events that were correctly predicted adjusting for hits associated with random change and allowing scores to be compared more fairly across different stations 2 4 2 flood forecast performance metrics we analyzed the errors in peak flow magnitude and timing which are key pieces of information for flood forecasts and helpful in the decision making process the peak flow magnitude error was calculated as the bias dividing the simulation value by the observed value while the timing error was quantified as the peak flow time shift in comparison with the observations the lead time in this study is defined as the time between the forecast initialization and the start of the rainfall generating the flood event which was analyzed to understand the value that forecast can provide for early warnings the predictive power of the model and quality of the hydrograph was evaluated using the kling gupta efficiency kge eq 7 gupta et al 2009 7 kge 1 r 1 2 σ sim σ obs 1 2 μ sim μ obs 1 2 where r is the linear correlation coefficient σ is the standard deviation and μ is the mean of observations obs and simulations sim the perfect agreement between simulations and observations is achieved when kge is equal to 1 while the model simulations have worse explanatory power than the mean of the observations when kge 0 41 knoben et al 2019 although the kge metric provides useful information about the model predictive power and is widely used in hydrology e g seo et al 2018 tijerina et al 2021 there are limitations in accurately quantifying the model performance clark et al 2021 especially during flood events and we refrain from classifying the model as good or bad based on a range of kge values instead we focus on understanding the relevance of reproducing the observed hydrograph by the model for real time flood management implications 3 results 3 1 flood detection skill following the ahps flood categories at each station we classified the observed stream gauge data during 19severe weather events in the period of this study 20may 30oct 2020 fig 3 a above action stage occurred 43times in seven stations of which 12occurrences reached minor flood and one reached moderate flood the four mile run subbasin station2 was the most frequently affected with 18flood occurrences while sligo creek station5 and rock creek station7 were the most exposed locations to flooding where more than three minor and moderate flood occurrences were recorded in each one no flood event was observed at difficult run station1 or paint branch station6 event18 resulted in the most extreme flooding when one station 7 recorded moderate flood four stations 4 5 8 and 9 had minor flood and one station 2 reached action stage events9 and 19 correspond to the rainfall generated during the passage over the region of hurricanes isaias and zeta respectively the reanalysis simulations which was forced with the stageiv qpe represent the best possible flood forecast performance with this hydrological model in wrf hydro in case a better precipitation forcing product was available at the forecast time when combining all stations and events the reanalysis simulations detected most of the flood occurrences 65 fig 3 b in the smaller subbasins such as turkey branch 7 km2 station4 and sligo creek 17 km2 station5 the ets was 0 43 and 0 30 respectively table 4 at four mile run 33 km2 station2 the ets 0 06 was much lower because the number of false negatives 8 was nearly the same as the number of true positives 10 at nw branch anacostia river 54 km2 station8 and cameron run 88 km2 station3 we found better ets values 0 52 1 00 in larger subbasins such as rock creek 161 km2 station7 the ets 0 65 was also higher indicating a better flood detection skill in larger subbasins however ne branch anacostia river 189 km2 station9 achieved a low ets 0 21 due to the occurrence of more false positives 3 than true positives 1 fig 3 c overall all flood occurrences were detected in nine events meaning that no false negatives occurred in these events and the flood detection skill was perfect in five events 3 4 14 15 and 18 in the forecast simulations the overall flood detection performance based on the contingency table classification fig 3 d was similar to the reanalysis simulations also detecting 65 of all flood occurrences and a total of 10events without false negatives however we found a slight variation in false negatives and an increase in false positives when compared with the reanalysis at four mile run station2 which recorded the highest number of floods the forecast predicted more floods in relation to the reanalysis and improved the skill scores csi 0 72 and ets 0 12 in contrast an increase in false positives at turkey branch station4 and rock creek station7 generated lower skill scores in the forecast simulations we considered that a true positive hit or false positive false alarm happened for a specific event when at least one forecast cycle reached action stage the total number of forecast cycles meeting this condition is presented in fig 3 e and was used to understand the persistency of the forecasts within each event we obtained the best flood forecasts during events 9 18 and 19 when correct predictions were made during the larger number of forecast cycles in comparison with other events often above three cycles we noticed that most of the false negatives misses occurred between june and early august during events 2 4 5 6 7 and 8 while most of the false alarms happened in august with the forecast for event15 standing out by resulting in multiple false positives false alarms in all stations this section quantified the flood forecast system detection skill based on 19severe weather events the overall flood detection performance was equivalent to 65 the forecast simulations also were found to slightly overestimate the flood occurrence resulting in more cycles with false positives here we identify specific events 2 9 15 18 and 19 that are further explored in sections3 3 to 3 5 for supporting the investigation of the cycle to cycle forecast variability sub hourly multipeak representation and forecast system performance for the most extreme events 3 2 peak flow and lead time evaluation the peak flow bias and time shift from all forecast cycles resulting in true positives in comparison with the observations fig 3 d e are shown in fig 4 providing a summary of the peak flow prediction performance across multiple lead time ranges at small subbasins such as turkey branch fig 4 c although only one forecast cycle detected flooding during event18 the detection occurred with a 30 hour lead time and a peak flow time shift of approximately one hour earlier at sligo creek fig 4 d the peak time shift remained mostly below five hours and was often underestimated however the forecast still captured the flood with lead times up to 30 h the peak flow time shift at four mile run was lower than five hours in most of the forecast cycles fig 4 a despite the variation between cycles low peak flow bias was obtained at all lead times ranges in the neighboring subbasin cameron run fig 4 b most of the forecast cycles consistently made good predictions where the peak flow bias was often close to one and a few cycles resulted in large time shifts most likely caused by the temporal displacement of the qpf at another small subbasin nw anacostia branch fig 4 f event18 was detected with 30 h lead time while largely estimating the peak flow despite the difference between cycles good forecasts were obtained for lead times above 18 h demonstrating the potential value added to the forecast with a duration of up to 36 h at rock creek fig 4 e one of the largest subbasins we found many peak flow bias results near to the observations bias 1 and some forecast cycles largely overestimating the discharge also the peak flow time shift indicated a larger spread in comparison with other subbasins the hydrograph analyses in section3 3 provides more insights on these results which revealed a threshold within the model in which it performs well at ne branch anacostia river fig 4 g event18 peak flow magnitude was perfectly predicted in the shortest lead time range but seven hours late on the other hand while the peak flow was overestimated in the forecast cycles above 18 h the peak flow time shift was equal or lower than three hours in this section we evaluated the peak flow magnitude and timing errors and their relation with the lead time providing important information on the differences in peak flow estimation across different forecast cycles in summary the peak flow timing was often predicted with 5 h difference from the observed data and multiple forecast cycles detected flood occurrence and estimated the peak flow with low error in magnitude for lead times above 18 h 3 3 cycle to cycle forecast variability in this section we investigated the hrrr qpf spatial and magnitude cycle to cycle variation and the impacts on the flood forecast consistency to further investigate the cycle to cycle forecast variability sub hourly multipeak representation and the performance during the most extreme events we selected five events 2 9 15 18 and 19 based on the results presented in section3 1 which provided an overall analysis of the flood detection skill peak flow time and magnitude errors for all 19events fig 5 a d shows the stageiv qpe accumulated during five selected events in chronological order and the accumulated absolute bias of the hrrr qpf for each forecast cycle the stageiv qpe for event2 fig 5 a shows three distinct areas with higher rainfall accumulations 25 mm over the domain the absolute bias between the stageiv qpe and each hrrr qpf fig 5 a 1 6 revealed high variability between forecast cycles indicating a tendency of overestimating the rainfall in smaller areas than observed and leading to missing the subbasins where flood was observed 2 3 and 7 during other events 1 to 7 we saw similar spatial and magnitude variability of the hrrr qpfs leading to several false negatives in the flood forecast simulations fig 3 d e during event9 hurricane isaias the precipitation over the gaged subbasins varied between 40 and 80 mm in 14 h and generated floods at four stations which were correctly detected by the reanalysis and consistently forecasted in at least four cycles fig 3 f the first hrrr qpf cycle fig 5 a 1 did not capture most of the precipitation and the last cycle fig 5 a 6 largely overestimated 50 150 mm the rainfall event while lower bias 50 mm in the intermediate cycles fig 5 a 2 5 led to the best flood forecasts for event9 these results indicate a tendency of events with large spatial coverage and higher precipitation amounts to generate more consistent forecasts which was also observed for events 18 and 19 additionally the observed flow at turkey branch station4 and ne branch anacostia river station9 were slightly below flood stage and the combined error of the hrrr qpf and hydrologic model resulted in streamflow overestimation and false positives at these locations at other stations 2 3 5 and 7 the flood occurrence was first predicted with a lead time of 30 h and the best hydrograph performances with a lead time of 24 and 18 h fig 6 the hrrr qpf forecast cycle initialized with 30 hour lead time fig 6 a 1 b 1 c 1 and d 1 predicted the rainfall earlier generating an earlier peak flow 5 12 h in the subsequent forecasts a better agreement between qpe and qpf resulted in smaller peak flow time shift and peak flow bias fig 6 a 2 3 b 2 3 c 2 3 and d 2 3 the rainfall during event9 was characterized by a longer duration and larger spatial coverage where the hrrr qpf showed a good prediction skill and consistency between cycles leading to multiple good flood forecasts across different watershed scales the reanalysis simulations during event9 predicted the peak flow timing with an error less than two hours and the peak flow bias below 14 in the smaller subbasins fig 6 a 3 b 3 and c 3 however the peak flow was largely overestimated at rock creek station7 probably associated with the presence of man made reservoirs such as lake bernard frank and lake needwood originally implemented for flood and sediment control which are not represented in the hydrologic model fig 6 d 3 the hrrr qpf cycles for event19 hurricane zeta showed good spatial fig 3 e and temporal fig 7 agreement with stageiv qpe low bias achieving results similar to those for event9 reinforcing the conjecture that more consistent flood forecasts can be achieved for rainfall events with longer duration and larger extent during event15 flood was observed only at four mile run station2 and correctly detected in the reanalysis and two forecast cycles fig 3 c and d the first flood detection occurred with a lead time of 28 h and peak flow time shift of less than one hour however many false positives occurred in all other stations mainly caused by the displacement and overestimation of the hrrr qpf fig 5 b 1 5 when compared with the stageiv qpe the hrrr qpf showed a tendency to concentrate the rainfall in smaller regions and overestimate the amount by up to 150 200 mm small subbasins such as turkey branch station4 and sligo creek station5 were more sensitive to the rainfall overestimation resulting in three false positives as well as rock creek station7 with four false positives 3 4 sub hourly multipeak analysis in this section we analyzed the effect of hourly simulations on sub hourly watershed response the precipitation during event19 hurricane zeta varied between 45 and 70 mm over a period of 12 h in the subbasins causing floods at three stations 2 3 and 7 that were correctly detected by the reanalysis and forecasts in four to five cycles fig 3 e in contrast with event9 event19 showed multiple peaks in the observed hydrographs while the reanalysis and forecast simulations produced single peak hydrographs at smaller subbasins such as four mile run station2 and cameron run station3 fig 7 this effect can be associated with the temporal resolution hourly of the stageiv qpe and hrrr qpf that cannot represent the sub hourly distribution and consequently the model does not precisely reproduce the multiple peaks in the small size subbasins included in this study although the simulations did not reproduce the multiple hydrograph peaks a visual inspection of the forecasted hydrographs at four mile run fig 7 a 1 3 showed satisfactory agreement with the observed hydrographs kge 0 15 the model overestimated the discharge at cameron run fig 7 b 1 3 however correct flood prediction was consistently achieved during three cycles with lead times above 22 h in addition to event19 we found the occurrence of multiple hydrograph peaks in these subbasins during events 3 4 8 14 and 16 3 5 flood forecast during the most extreme event event18 occurred on 10sep2020 and was the most extreme in the period of this study 20may 31oct 2020 when the highest flood categories were observed the performance during the most extreme events is of high interest for real time flood prediction due to the high potential damage that they can cause hence we chose to conduct a detailed analysis of event18 which also achieved the best forecast performance the accumulated precipitation from stageiv qpe fig 5 e showed that a heavy precipitation cell formed over rock creek and anacostia watersheds generating up to 120 mm of rain in approximately eight hours 1500 2300utc the southern half of rock creek subbasin received a large accumulation 75 mm in comparison with the rest of the region lower accumulations 10 75 mm occurred in the northern parts of the rock creek and anacostia watersheds four mile run subbasin experienced action stage and had a similar rainfall spatial distribution but with lower accumulation in northern regions and higher accumulation in southern parts with a much lower maximum 45 mm the first hrrr qpf cycle starting at 0600 utc 9 sep fig 5 e 1 provided a good prediction of the heaviest precipitation totals however spread over a larger spatial extent than the qpe overestimating the precipitation over most of the domain in other hrrr qpf cycles fig 5 e 2 5 a region with heavy rainfall and circular shape is predicted similar to the pattern in the qpe but with a smaller diameter lower magnitude and spatial displacement the four mile run subbasin received less precipitation than rock creek and anacostia watersheds and besides the first hrrr qpf that overestimated the rainfall fig 5 e 1 there was low absolute bias indicating a good spatial agreement of the total precipitation the forecast initialized at 1200utc on 9 sep fig 8 a at four mile run station 2 shows that the temporal distribution of the hrrr qpf differs from the stage iv qpe but the system is still able to make a satisfactory peak flow prediction the peak flow is slightly underestimated 2 h late and the system correctly predicted the occurrence of action stage with 30 hour lead time turkey branch station4 is the smallest subbasin in this study and most affected by the hrrr underestimation of precipitation correctly predicting flood in only one forecast cycle fig 8 b however the best forecast was made with a lead time of 34 h and 4 h of peak flow time shift too early the hrrr qpf early timing directly affected the peak flow timing once the reanalysis showed good agreement with the observed values flooding was also detected in the first forecast cycle at rock creek station7 and nw branch anacostia river station8 and the best performance happened with a lead time of 24 h fig 8 c although the hrrrqpf led to a prediction of the peak flow about six hours too early at rock creek there was a good agreement in magnitude and hydrograph shape finally at nw anacostia station8 the hrrr qpf peak hour closely matched with the stage iv qpe peak while underestimating the precipitation in other time steps the forecast underestimated the peak flow indicated its occurrence approximately onehour late and produced a satisfactory hydrograph fig 8 d lastly this section investigated the forecast performance during the most extreme event which produced the best forecasts these results demonstrate the potential of the forecast system coupling hrrrv3 with wrf hydro that correctly detected the flood event with 30 h lead time and predicted the peak flow with time shift of 4 h across multiple locations 4 discussion the overall forecast performance was similar to the reanalysis simulations where both detected 65 of all flood events in the study period this result indicates that the forecast simulations which are forced with the hrrr produced similar performance when compared with the reanalysis simulations which use the stageiv qpes demonstrating value to provide flood guidance because of the shifts in cycle to cycle hrrr qpfs the flood forecasts cycles for the same flood event showed high variability especially in shorter and lower rainfall accumulation events this is consistent with the fact that smaller scale storms tend to be less organized to move slowly erratically or become quasi stationary and are difficult to forecast due to their weakly forced nature and chaotic interactions grim et al 2021 additionally the hrrr qpfs often overestimated the precipitation intensity in smaller regions than estimated by the stageiv qpe nevertheless our findings corroborate viterbo et al 2020 which also found large cycle to cycle variability and slight overestimation of the intensity in the hrrr qpf with 18 h duration during a torrential rainfall event in ellicott city maryland on 27may2018 small displacements in space few kilometers and time few hours of the hrrr qpfs strongly influenced the hydrological response at the watershed scale especially in smaller watersheds with lower hit rates such as turkey branch 7 km2 station4 and sligo creek 17 km2 station5 however the effect of these displacements was less critical in larger subbasins included in this study such as rock creek 161 km2 station7 due to higher chances of the watershed capturing the rainfall as also noticed by ghimire et al 2021 if areas receiving the rainfall by qpf and qpe are at different locations but with similar coverage and magnitude within the watershed hydrologic simulations of larger watersheds will have more chances to present a better runoff response the reanalysis and forecast simulations showed limited ability to reproduce observed multi peak hydrographs generated by sub hourly precipitation peaks in small watersheds included in this study such as four mile run 33 km2 station2 and cameron run 88 km2 station3 the hourly resolution of the meteorological forcing defined our simulation time steps of one hour preventing the model representation of multi sub hourly peaks we conducted a comprehensive analysis of the events not limiting to hydrograph metrics such as the kge which showed that the flood forecast achieved satisfactory performance during sub hourly events while the kge is largely used for quantifying hydrologic model performance e g seo et al 2018 tijerina et al 2021 uncertainties related to its estimation require the use of additional metrics to adequately interpret the data clark et al 2021 we found that the kge value from a forecast simulation does not necessarily represent a flood event well when considering not only the hydrograph shape but also the peak flow magnitude and timing the flood forecast performance was superior during precipitation events with larger accumulation and longer duration such as events 9 18 and 19 where a higher number of forecast cycles correctly detect the flood occurrence our results agree with li et al 2021 which also found a better performance of flood forecasts during hurricane harvey in texas when compared with a short duration rainfall event our analysis of multiple flood events also revealed that the flood forecast skill does not necessarily decrease with increasing lead time once flood detection and low bias is achieved for longer lead times as often observed in continuous hydrologic forecasting studies e g awol et al 2021 ghimire et al 2021 many forecasts with lead time above 18 h resulted in better peak flow and hydrograph estimation than shorter duration forecasts demonstrating potential value to increase the time available for decision making using the hrrr product as an example combining hourly updated forecasts up to 18 h and 6 hourly update forecasts above 18 h could enable a multi stage early warning action system approach bischiniotis et al 2019 wang et al 2021 for mitigating the impact of cycle to cycle forecast variability supporting greater lead time for preparedness and response operations in this case preliminary actions could be triggered by a low skilled forecast with a longer lead time while the main action could be activated by a high skilled forecast near to the event start although we used the hrrr which was the best available and suitable nwp product for real time short range forecasting at the time of the events studied here this study was limited to a single deterministic forecast at each cycle considering the qpf and hydrologic modeling uncertainties a single deterministic simulation could have impacted the ability of issuing more persistent cycle to cycle forecasts hence in addition to the benefit of combining the prediction skills from different weather models the use of nwp ensembles can enable multiple forecast simulations and provide an uncertainty range for flood guidance e g cloke and pappenberger 2009 mascaro et al 2010 additionally because our forecast system detected approaching flood events over multiple cycles a time lagged approach hoffman and kalnay 1983 could also contribute to improving the forecast consistency by smoothing the impact of the high variability of the qpfs on flood prediction roberts et al 2020 it is also important to note that we only focused on the analysis of point locations during multiple events where we have stream gauge data rather than flooding extent due to limited flood information from the flood management perspective a real time flood forecast with longer lead times can enable decision makers to launch preparedness actions earlier and increase their effectiveness bischiniotis et al 2019 for instance it can be integrated with the road network to anticipate potential flood areas allowing the identification of alternative routes li et al 2019 versini 2012 and assist emergency response accessibility coles et al 2017 real time flood forecast information is especially important for socio economically vulnerable populations tanir et al 2021 tate et al 2021 which can be more impacted by flood events coupling socio economic vulnerability information with flood forecasts should provide meaningful information from an impact focused perspective merz et al 2020 and guide decisions to allocate resources towards locations under greater threat in this study we demonstrated the value of coupling hrrrv3 with wrf hydro for producing real time flood forecasts with up to 36 h lead time which can be integrated with the aforementioned actions 5 conclusions in this study we characterized the short range predictive capability of a real time flood forecast system using the hrrr as the main nwp forcing during multiple flood events at different watersheds in the national capital region we quantified the flood forecast performance using different metrics for 19flood events during 20may 31oct 2020 the main findings of the study are 1 the hrrr qpf can enable skillful flood forecasts with 65 detection rate when compared with the observations sustaining the performance achieved with the reanalysis simulations using stageiv qpe however the high variability of precipitation location magnitude and timing between cycles directly affected the consistency of the flood forecasts this variability was more critical to smaller than larger subbasins due to higher chances of forecasted precipitation to miss smaller watersheds in consequence of spatial displacements additionally the flood forecasts were more consistent for events with larger spatial coverage and higher precipitation amounts 2 the hourly resolution used in the reanalysis and forecast simulations may have limited the reproduction of sub hourly peaks in smaller subbasins however flood forecasts performed well correctly detecting the flood occurrence and resulting in low peak flow magnitude and timing errors 3 extending the flood forecast above 18 h allowed earlier detection of approaching flood events and in some cases such as in events 9 18 and 19 with superior performance than shorter lead times although the hrrr with 36 h duration is updated only every six hours the use of this product added great value for increasing the lead time of approaching floods and can enable more effective preparedness and response actions lastly nwp systems are in continuous development and further research should investigate forecast improvements using the hrrr version4 with 48 h duration and the evaluation of ensemble nwp products such as the high resolution ensemble forecast href roberts et al 2019 produced by the storm prediction center and the rapid refresh forecast system rrfs noaa 2022a both at noaa the rrfs is the next generation convection allowing rapidly updated ensemble prediction system that is planned to include 18 h and 60 h duration forecasts and become available in late 2023 black et al 2021 noaa 2022a to support better hydrologic forecast in small watersheds subhourly e g 15 min time steps surface meteorological fields outputs could be also investigated future work should also focus on extending the flood forecast overland including a systematic approach for collecting data during flood events to enable the verification of flood forecasts beyond stream gauges and integrate this information to produce impact based forecasts credit authorship contribution statement gustavo de a coelho conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization celso m ferreira conceptualization methodology validation writing review editing supervision funding acquisition james l kinter iii conceptualization validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements g coelho was fully supported by a graduate assistantship from george mason university appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128212 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2998,many large metropolitan areas are especially susceptible to floods generated by heavy short duration rainfall the high density of people buildings and infrastructure in these areas underline the importance of developing flood resilient cities and communities an accurate real time flood forecasting system can support decision making for launching preparedness and response actions in short range hours to days and assist mitigating the disturbances caused by floods this study explores the short range predictive capability of a real time flood forecast system by coupling the high resolution rapid refresh hrrr meteorological forecasted variables with a fully distributed hydrological model wrf hydro we provide a comprehensive analysis of short range 36 h forecasts for 19flood events generated by heavy rainfall in small urban and suburban watersheds 200 km2 in the national capital region of the united states flood forecast performance are then assessed using different metrics based on observed data from u s geological survey stream gauges and reanalysis simulations using the stageiv quantitative precipitation estimates results show that despite the high variability of the hrrr cycle to cycle precipitation forecasts the real time flood forecast system can produce skillful forecasts with similar overall performance as the reanalysis simulations achieving 65 of flood detection rate this variability had more impact on forecast skill in smaller subbasins and flood forecasts were more consistent for longer duration and larger spatial extent rainfall hourly flood forecasts performed well even in smaller watersheds correctly detecting flood occurrence with up to 34 h lead time and resulting in low peak flow magnitude and timing errors keywords severe weather quantitative precipitation forecast high resolution rapid refresh hydrologic modeling wrf hydro data availability all data used to conduct this research is publicly available and can be accessed in the following links 1 usgs stream gauges at https dashboard waterdata usgs gov app nwd aoi default 2 nldas 2 at https disc gsfc nasa gov datasets keywords nldas 3 stage iv qpe at https data eol ucar edu dataset 21 093 and 4 hrrr at https rapidrefresh noaa gov hrrr 1 introduction many large metropolitan areas are especially susceptible to floods generated by heavy short duration rainfall due to natural landscape transformations caused by urban development such as the increase of impervious areas nasem 2019 the high density of people buildings and infrastructure in these areas underline the importance of developing flood resilient cities and communities mcclymont et al 2020 an accurate real time flood forecasting system can support decision making for launching preparedness and response actions at the short range hours to days and assist mitigating the disturbances caused by floods carsell et al 2004 hapuarachchi et al 2011 flood warnings are issued when flooding is expected to threaten life and property shortly hours after the occurrence of a specific event such as heavy rainfall nws 2021 and may not provide enough lead time for effective response actions a real time flood forecast system can enable the issuance of early flood warnings or flood watches to inform the public of conditions that may cause flooding in the near future 1 2 days nws 2021 allowing planning and preparation for an approaching event as well as more effective response actions bischiniotis et al 2019 ritter et al 2021 in the united states u s the weather forecast offices wfo of the national oceanic and atmospheric administration s national weather service noaa nws provide the official weather and flood forecasts based on hydrologic and total water level guidance systems the nws river forecasting system nwsrfs and the national water model nwm are the major noaa operational systems providing hydrologic guidance in the u s the nwsrfs outputs are analyzed in the river forecast centers rfcs that issue deterministic and probabilistic stage and streamflow guidance at over 4 000locations with up to 3 6 days lead time connelly et al 1999 in 2016 the nwm officially started producing short range 18 h medium range 10 days and long range 30 days real time streamflow guidance for about 2 7million river segments in the continental united states bales and flowers 2021 noaa 2022b which until version2 1 was based on the wrf hydro modeling framework gochis et al 2018 in coastal areas the main operational water level predictions systems are the extra tropical storm surge kim et al 1996 and extra tropical surge and tide operational forecast system funakoshi et al 2012 while other systems are also available at the regional scale such as cbofs lanerolle et al 2010 and iflood khalid and ferreira 2020 in the chesapeake bay while flooding can be generated from additional mechanisms such as snowmelt storm surge and dam failure this paper focuses on floods generated by intense precipitation in large metropolitan areas real time flood forecast systems suitable for urban areas may use a wide range of techniques collier 2007 wu et al 2020 and in this study we included three main elements information about watershed conditions prior to the forecast start meteorological forcings from numerical weather prediction nwp and hydrologic modeling quantitative precipitation estimates qpes determine past precipitation and in the real time flood forecast context allow hydrologic simulations for estimating watershed conditions prior to the forecast period quantitative precipitation forecasts qpfs predict future precipitation and are key in real time flood forecasting being the main meteorological forcing of hydrologic simulations heavy short duration precipitation is often generated by convective processes that are challenging to model due to their complex evolution of mesoscale meteorological features kerr et al 2017 requiring high resolution order 1 km and convection allowing nwp models the high resolution rapid refresh hrrr is a storm resolving model designed to provide guidance on convective precipitation forecasts at 3 km resolution from the noaa national centers for environmental prediction ncep benjamin et al 2016 the operational hrrr version3 has 18 h duration forecasts with 15 min and 1 h time steps updated every hour and a 36 h duration product with 1 h time step but updated every 6 h the hrrr with 18 hour duration is the meteorological forcing used in the nwm short range forecast and was also adopted in previous short range hydrologic forecasting studies e g awol et al 2021 ghimire et al 2021 seo et al 2018 however the hrrr version3 with 36 hour duration has not been widely studied for producing real time flood forecasting hydrologic modeling has been extensively used for many decades using historical data e g abbott et al 1986 beven 2002 burnash 1973 clark et al 2015 gochis et al 2018 odgen 1997 tijerina et al 2021 serving as a foundation for real time flood forecast systems previous hydrologic forecast studies explored short range 3days awol et al 2021 ghimire et al 2021 seo et al 2018 viterbo et al 2020 and medium 3 10 days to long range 10 days e g adams and dymond 2018 addor et al 2011 arnal et al 2018 emerton et al 2018 liu et al 2022 seo et al 2018 and ghimire et al 2021 showed that hrrr qpf errors generally increase with increasing lead times and decrease with increasing basin size based on streamflow forecasting for the state of iowa awol et al 2021 compared streamflow forecasts from different lumped models and one semi distributed hydrologic model in urban and suburban watersheds in canada and obtained the best results when using the hrrr qpfs viterbo et al 2020 revealed that the hrrr can produce skillful precipitation forecast guidance in terms of area and intensity for high intensity mesoscale events however small qpf displacements influenced the hydrological response at the watershed scale resulting in cycle to cycle shifts for an event in ellicott city md in 2018 although a vast literature on hydrologic hindcasting which is mostly based on observed and assimilated meteorological forcing is available there are limited studies of real time short range hydrologic forecasting using nwp especially in urban and semiurban watersheds most of the previous studies focused on rainfall and streamflow prediction without directly relating the results to flood occurrence and limited to a single watershed wu et al 2020 other studies provided a comprehensive analysis of real time flood forecasting during a single flood event e g seo et al 2018 viterbo et al 2020 however examining multiple flood events across different catchments in large metropolitan areas can provide a better understanding of the effect of qpfs on flood prediction consistency variations in watershed response and implications for real time flood forecasting additionally the application of the hrrr for real time flood forecasting has not been examined for durations beyond 18 h and extending the lead time above this threshold could provide significant value for anticipating flood events the objective of this study was to explore the short range predictive capability of a real time flood forecast system forced with the hrrr in multiple urban and semiurban watersheds and lead times up to 36 h while also attempting to understand the impacts of qpf on the quality of the flood forecast considering the potential benefits of increased forecast lead time such as enabling more effective preparedness and response actions we chose the 36 hour hrrrv3 to assess the short range flood forecast capabilities that can be enabled by current noaa nws nwp complementing the knowledge beyond the 18 hour lead time covered in previous studies seo et al 2018 viterbo et al 2020 to accomplish this goal we developed a real time flood forecast system for the national capital region ncr of the united states including a method for preserving the watershed memory and estimating initial conditions at the forecast start this study was conducted between 20may and 31oct2020 when 19heavy and short duration rainfall events generated floods in the ncr for each event we characterized the qpf errors in precipitation magnitude timing and spatial displacement in comparison with qpes flood forecast simulations are then assessed using data from u s geological survey usgs stream gauges and reanalysis simulations forced with qpes with respect to flood detection skill peak flow timing and magnitude errors lead time and model performance the main contribution consists of exploring multiple flood events systematically across spatial scales and forecast lead times up to 36 h providing key insights on the short range in real time flood forecasting 2 material and methods 2 1 study region and verification data the study region encompasses a rectangular domain 52 km west east by 50 km south north fig 1 in the ncr the ncr is comprised of montgomery and prince george s counties in maryland the northern virginia region nvr and washington dc collectively with a total population of about 5 8million people u s census bureau 2021 the regional climate is temperate humid subtropical characterized by no dry season and a hot summer meaning that there is no significant mean precipitation difference between seasons beck et al 2018 peel et al 2007 the ncr is frequently affected by precipitation driven floods and includes socio economically vulnerable populations to flood as reported by tanir et al 2021 supporting the relevance of a real time flood forecast in this region the model domain was delimited to include gauged watersheds entirely contained in the ncr with different sizes providing a representative multi spatial analysis of the flood forecast system five watersheds contributing to the potomac river are included i e difficult run four mile run and cameron run in virginia and rock creek and anacostia river located both in maryland and washington dc the elevation ranges from 0 to 196 m fig 1 c and most of the studied watersheds are urbanized while difficult run and the upper areas of rock creek and anacostia river watersheds have different types of vegetation cover fig 1 d streamflow data was obtained from the usgs stream gauge network at nine locations as presented in fig 1 and listed in table 1 the stream gauges used in this study are included in the advanced hydrologic prediction service ahps network and are used by the nws to issue flood watches and flood warnings along with the weather forecasts the drainage areas of the subbasins included in this study vary between 7and 189 km2 and for the remainder of the paper we will refer to subbasins 2 3 4 5 and 8 as the smaller 100 km2 and subbasins 1 7 and 9 as the larger 100 km2 subbasins 2 2 flood forecast system framework the flood forecast workflow includes the retrieval of assimilated meteorological data for estimating watershed conditions prior to the forecast start stored in warm start files retrieval of nwp data for forcing the model a fully distributed hydrological model and the analysis of forecast outputs fig 2 a the flood forecast system was designed to produce four forecasts per day with 36 hour duration starting at 0000 0600 1200 and 1800utc fig 2 b while the nwm produce a new short range forecast with 18 hour duration every hour each forecast simulation starts from a warm start file produced from two previous simulation stages i e spinup and hindcast aiming to maintain a watershed memory and provide the best representation of the model hydrologic state at the present time the initial spinup simulation began on 1oct2017 to include one complete water year before the calibration period and more than two years before producing forecasts the spinup simulation is updated daily using meteorological assimilated data that is available up to three days before the present time the hindcast simulation was forced by observed precipitation and meteorological forecasted data and includes the period between the end of the spinup and the initial forecast time 2 2 1 hydrologic modeling the weather research and forecasting model hydrological modeling system wrf hydro was used to perform distributed hydrologic simulations and provide streamflow predictions wrf hydro is an open source and community based modeling architecture developed to facilitate the representation of surface subsurface and channel water flow in a 2 dimensional domain and to enable coupling with atmospheric models gochis et al 2018 a brief overview of the selected wrf hydro configuration is provided in this section while a detailed description can be found in gochis et al 2018 the wrf hydro version5 0 was compiled for one way coupling simulations and using the noah multiparameterization noah mp niu et al 2011 as the land surface model lsm in a 1 km spatial resolution grid the lateral saturated subsurface flow was computed using the quasi 3d flow implemented in the distributed hydrology soil vegetation model dhsvm wigmosta et al 1994 wigmosta and lettenmaier 1999 and the surface overland flow calculation uses a fully unsteady spatially explicit and diffusive wave formulation julien et al 1995 odgen 1997 the channel routing is performed through the gridded channel network using an explicit one dimensional variable time stepping diffusive wave formulation which is a simplification of the more general st venant equations for shallow water wave flow gochis et al 2018 the subsurface flow overland flow and channel routing calculations are performed in the high resolution routing grid prepared with 100 m spatial resolution the rainfall runoff transformation is computed by noah mp in the lsm grid and the infiltration excess and soil exfiltration passed to the high resolution routing grid at each time step gochis et al 2018 we highlight that the impervious coverage is not explicitly represented in wrf hydro version 5 0 the base flow parameterization uses a conceptual groundwater bucket that receives the soil columns drainage from the lsm and slowly discharges the water into the channel grids using an exponential storage discharge function gochis et al 2018 the most relevant parameters for developing a short range forecast system were identified based on the wrf hydro literatures gochis et al 2018 senatore et al 2015 silver et al 2017 yucel et al 2015 zhang et al 2020 and the values were defined based on a sensitivity analysis the wrf hydro parameters named infiltration factor refkdt slope index slope saturated soil hydraulic conductivity dksat multiplier on saturated hydraulic conductivity in lateral flow direction lksatfac multiplier on surface roughness ovroughrt and channel manning roughness mann were calibrated using the dynamically dimensioned search dds algorithm tolson and shoemaker 2007 for each gauged watershed based on the period of 1oct2018 through 30sep2019 see supplementary data s1 2 2 2 meteorological forcings the meteorological forcing variables required by noah mp in wrf hydro are incoming shortwave and longwave radiation specific humidity air temperature surface pressure near surface wind and precipitation rate the forecast simulations were forced using the operational conus hourly product from hrrr version3 with a 36 hour duration and updated every 6 h benjamin et al 2016 this product was chosen over the 18 hour duration and hourly updated hrrr product used in previous studies e g awol et al 2021 ghimire et al 2021 seo et al 2018 viterbo et al 2020 aiming to evaluate the flood predictions for a longer lead time the original hrrr files for the entire conus with 3 km spatial resolution are regridded to the 1 km wrf hydro lsm grid using an earth system modeling framework esmf regridding script pan et al 2018 written in ncar command language ncl ncar 2019 in the spinup simulations we used the north american land data assimilation system phase2 nldas 2 xia et al 2012 to obtain the meteorological forcing variables required by noah mp with the exception of precipitation the nldas 2 data is provided in a 0 125 degree spatial resolution and is also regridded by bilinear interpolation to the 1 km wrf hydro lsm grid using an esmf regridding script ikeda et al 2018 for the precipitation forcing we adopted the stageiv qpe nelson et al 2016 from the noaa nws ncep which is a near real time product generated from the nexrad precipitation processing system pps seo and breidenbach 2002 and the nws river forecast center rfc precipitation processing fulton et al 1998 the gridded precipitation in the conus is provided at a 4 km spatial resolution and was regridded by bilinear interpolation to the 1 km wrf hydro lsm grid using an esmf regridding script prepared by the author in the hindcast simulations we also used the stageiv for the precipitation but the hrrr for all other meteorological forcing variables this methodology was used because the nldas 2 is updated daily with a 3 day lag time which creates a time window with limited availability of observed and assimilated meteorological data hence the hindcast simulations allowed us to overcome this limitation and estimate the initial conditions at the forecast start 2 3 severe weather events this study was conducted during the period of 20may 30oct 2020 when 19severe weather events were identified table 2 the nws ahps provides a flood classification system with four categories associated to its magnitude 1 action near flood 2 minor flood 3 moderate flood and 4 major flood stage noaa nws 2022 the stage and discharge respective to each flood category will vary at each location and are presented in table s2 in supplementary data 1 we defined that a severe weather event occurred when at least one of the nine stream gauges in the model domain reached action stage during or after a rainfall event a minimum time interval of six consecutive hours without rain accumulation over the model domain was adopted to separate different rainfall events 2 4 flood forecast evaluation we evaluated the flood forecast system based on the precipitation forcing and runoff responses for all forecast cycles overlapping each one of the 19severe weather events usually four to six forecast cycles the severe weather event time window consists of the period between the rainfall start and runoff end we performed reanalysis simulations to establish a baseline for the model performance during each forecast cycle where the model was forced using the same initial conditions and meteorological forcing variables from the hrrr but with the stageiv qpe here after referred as reanalysis simulation the stageiv qpe represents the best possible performance of the current model configuration in case a better precipitation product was available at the forecast time the differences between this reanalysis simulation and observed data can mostly be attributed to errors in the qpes and hydrologic model while the comparison between reanalysis and forecast simulations enables the isolation of flood prediction errors solely attributed to the qpf error hence the flood forecast performance evaluation was conducted in five steps 1 quantification of flood detection skill 2 evaluation of the peak flow magnitude and timing errors and relation with lead time 3 assessment of hrrr qpf displacement magnitude and timing errors in comparison with the stageiv qpe and impacts of flood forecast results 4 analysis of hourly simulations on sub hourly watershed response and 5 investigation of forecast performance during the most extreme event 2 4 1 flood detection skill the flood detection skill provides an overall picture of the simulations performance and ability of the system to accomplish the main objective of the flood forecast system which is detecting the flood signal defined by occurrence of nws action stage we used five common skill scores to assess the flood detection skill of reanalysis and forecast simulations based on a contingency table table 3 the metrics consist of the hit rate hr false alarm rate far critical success index csi equitable threat score ets or gilbert skill score and frequency bias fb calculated as follows 1 hr tp tp f n 2 far fp tp f p 3 csi tp tp f p f n 4 ets tp tp random tp f n f p tp random where 5 tp random t p f n t p f p tp f p f n t p 6 fb tp f p tp f n the values in table 3 were computed based on the reanalysis and forecast simulations results for all 19events at each station a positive result is marked when the simulation reaches action stage and is classified as true or negative using the observed data as ground truth once there is more than one forecast cycle overlapping the duration of each event we considered that a true positive or false positive occurred when at least one forecast cycle reached action stage the hr quantifies the fraction of simulations that correctly detect true flood events while the far indicates the fraction of detected flood events that did not occur the fb shows when flood events are overpredicted ratio of the total number of detected flood events to the total number of observed the ets provides the overall forecast skill measuring the fraction of the observed and forecast events that were correctly predicted adjusting for hits associated with random change and allowing scores to be compared more fairly across different stations 2 4 2 flood forecast performance metrics we analyzed the errors in peak flow magnitude and timing which are key pieces of information for flood forecasts and helpful in the decision making process the peak flow magnitude error was calculated as the bias dividing the simulation value by the observed value while the timing error was quantified as the peak flow time shift in comparison with the observations the lead time in this study is defined as the time between the forecast initialization and the start of the rainfall generating the flood event which was analyzed to understand the value that forecast can provide for early warnings the predictive power of the model and quality of the hydrograph was evaluated using the kling gupta efficiency kge eq 7 gupta et al 2009 7 kge 1 r 1 2 σ sim σ obs 1 2 μ sim μ obs 1 2 where r is the linear correlation coefficient σ is the standard deviation and μ is the mean of observations obs and simulations sim the perfect agreement between simulations and observations is achieved when kge is equal to 1 while the model simulations have worse explanatory power than the mean of the observations when kge 0 41 knoben et al 2019 although the kge metric provides useful information about the model predictive power and is widely used in hydrology e g seo et al 2018 tijerina et al 2021 there are limitations in accurately quantifying the model performance clark et al 2021 especially during flood events and we refrain from classifying the model as good or bad based on a range of kge values instead we focus on understanding the relevance of reproducing the observed hydrograph by the model for real time flood management implications 3 results 3 1 flood detection skill following the ahps flood categories at each station we classified the observed stream gauge data during 19severe weather events in the period of this study 20may 30oct 2020 fig 3 a above action stage occurred 43times in seven stations of which 12occurrences reached minor flood and one reached moderate flood the four mile run subbasin station2 was the most frequently affected with 18flood occurrences while sligo creek station5 and rock creek station7 were the most exposed locations to flooding where more than three minor and moderate flood occurrences were recorded in each one no flood event was observed at difficult run station1 or paint branch station6 event18 resulted in the most extreme flooding when one station 7 recorded moderate flood four stations 4 5 8 and 9 had minor flood and one station 2 reached action stage events9 and 19 correspond to the rainfall generated during the passage over the region of hurricanes isaias and zeta respectively the reanalysis simulations which was forced with the stageiv qpe represent the best possible flood forecast performance with this hydrological model in wrf hydro in case a better precipitation forcing product was available at the forecast time when combining all stations and events the reanalysis simulations detected most of the flood occurrences 65 fig 3 b in the smaller subbasins such as turkey branch 7 km2 station4 and sligo creek 17 km2 station5 the ets was 0 43 and 0 30 respectively table 4 at four mile run 33 km2 station2 the ets 0 06 was much lower because the number of false negatives 8 was nearly the same as the number of true positives 10 at nw branch anacostia river 54 km2 station8 and cameron run 88 km2 station3 we found better ets values 0 52 1 00 in larger subbasins such as rock creek 161 km2 station7 the ets 0 65 was also higher indicating a better flood detection skill in larger subbasins however ne branch anacostia river 189 km2 station9 achieved a low ets 0 21 due to the occurrence of more false positives 3 than true positives 1 fig 3 c overall all flood occurrences were detected in nine events meaning that no false negatives occurred in these events and the flood detection skill was perfect in five events 3 4 14 15 and 18 in the forecast simulations the overall flood detection performance based on the contingency table classification fig 3 d was similar to the reanalysis simulations also detecting 65 of all flood occurrences and a total of 10events without false negatives however we found a slight variation in false negatives and an increase in false positives when compared with the reanalysis at four mile run station2 which recorded the highest number of floods the forecast predicted more floods in relation to the reanalysis and improved the skill scores csi 0 72 and ets 0 12 in contrast an increase in false positives at turkey branch station4 and rock creek station7 generated lower skill scores in the forecast simulations we considered that a true positive hit or false positive false alarm happened for a specific event when at least one forecast cycle reached action stage the total number of forecast cycles meeting this condition is presented in fig 3 e and was used to understand the persistency of the forecasts within each event we obtained the best flood forecasts during events 9 18 and 19 when correct predictions were made during the larger number of forecast cycles in comparison with other events often above three cycles we noticed that most of the false negatives misses occurred between june and early august during events 2 4 5 6 7 and 8 while most of the false alarms happened in august with the forecast for event15 standing out by resulting in multiple false positives false alarms in all stations this section quantified the flood forecast system detection skill based on 19severe weather events the overall flood detection performance was equivalent to 65 the forecast simulations also were found to slightly overestimate the flood occurrence resulting in more cycles with false positives here we identify specific events 2 9 15 18 and 19 that are further explored in sections3 3 to 3 5 for supporting the investigation of the cycle to cycle forecast variability sub hourly multipeak representation and forecast system performance for the most extreme events 3 2 peak flow and lead time evaluation the peak flow bias and time shift from all forecast cycles resulting in true positives in comparison with the observations fig 3 d e are shown in fig 4 providing a summary of the peak flow prediction performance across multiple lead time ranges at small subbasins such as turkey branch fig 4 c although only one forecast cycle detected flooding during event18 the detection occurred with a 30 hour lead time and a peak flow time shift of approximately one hour earlier at sligo creek fig 4 d the peak time shift remained mostly below five hours and was often underestimated however the forecast still captured the flood with lead times up to 30 h the peak flow time shift at four mile run was lower than five hours in most of the forecast cycles fig 4 a despite the variation between cycles low peak flow bias was obtained at all lead times ranges in the neighboring subbasin cameron run fig 4 b most of the forecast cycles consistently made good predictions where the peak flow bias was often close to one and a few cycles resulted in large time shifts most likely caused by the temporal displacement of the qpf at another small subbasin nw anacostia branch fig 4 f event18 was detected with 30 h lead time while largely estimating the peak flow despite the difference between cycles good forecasts were obtained for lead times above 18 h demonstrating the potential value added to the forecast with a duration of up to 36 h at rock creek fig 4 e one of the largest subbasins we found many peak flow bias results near to the observations bias 1 and some forecast cycles largely overestimating the discharge also the peak flow time shift indicated a larger spread in comparison with other subbasins the hydrograph analyses in section3 3 provides more insights on these results which revealed a threshold within the model in which it performs well at ne branch anacostia river fig 4 g event18 peak flow magnitude was perfectly predicted in the shortest lead time range but seven hours late on the other hand while the peak flow was overestimated in the forecast cycles above 18 h the peak flow time shift was equal or lower than three hours in this section we evaluated the peak flow magnitude and timing errors and their relation with the lead time providing important information on the differences in peak flow estimation across different forecast cycles in summary the peak flow timing was often predicted with 5 h difference from the observed data and multiple forecast cycles detected flood occurrence and estimated the peak flow with low error in magnitude for lead times above 18 h 3 3 cycle to cycle forecast variability in this section we investigated the hrrr qpf spatial and magnitude cycle to cycle variation and the impacts on the flood forecast consistency to further investigate the cycle to cycle forecast variability sub hourly multipeak representation and the performance during the most extreme events we selected five events 2 9 15 18 and 19 based on the results presented in section3 1 which provided an overall analysis of the flood detection skill peak flow time and magnitude errors for all 19events fig 5 a d shows the stageiv qpe accumulated during five selected events in chronological order and the accumulated absolute bias of the hrrr qpf for each forecast cycle the stageiv qpe for event2 fig 5 a shows three distinct areas with higher rainfall accumulations 25 mm over the domain the absolute bias between the stageiv qpe and each hrrr qpf fig 5 a 1 6 revealed high variability between forecast cycles indicating a tendency of overestimating the rainfall in smaller areas than observed and leading to missing the subbasins where flood was observed 2 3 and 7 during other events 1 to 7 we saw similar spatial and magnitude variability of the hrrr qpfs leading to several false negatives in the flood forecast simulations fig 3 d e during event9 hurricane isaias the precipitation over the gaged subbasins varied between 40 and 80 mm in 14 h and generated floods at four stations which were correctly detected by the reanalysis and consistently forecasted in at least four cycles fig 3 f the first hrrr qpf cycle fig 5 a 1 did not capture most of the precipitation and the last cycle fig 5 a 6 largely overestimated 50 150 mm the rainfall event while lower bias 50 mm in the intermediate cycles fig 5 a 2 5 led to the best flood forecasts for event9 these results indicate a tendency of events with large spatial coverage and higher precipitation amounts to generate more consistent forecasts which was also observed for events 18 and 19 additionally the observed flow at turkey branch station4 and ne branch anacostia river station9 were slightly below flood stage and the combined error of the hrrr qpf and hydrologic model resulted in streamflow overestimation and false positives at these locations at other stations 2 3 5 and 7 the flood occurrence was first predicted with a lead time of 30 h and the best hydrograph performances with a lead time of 24 and 18 h fig 6 the hrrr qpf forecast cycle initialized with 30 hour lead time fig 6 a 1 b 1 c 1 and d 1 predicted the rainfall earlier generating an earlier peak flow 5 12 h in the subsequent forecasts a better agreement between qpe and qpf resulted in smaller peak flow time shift and peak flow bias fig 6 a 2 3 b 2 3 c 2 3 and d 2 3 the rainfall during event9 was characterized by a longer duration and larger spatial coverage where the hrrr qpf showed a good prediction skill and consistency between cycles leading to multiple good flood forecasts across different watershed scales the reanalysis simulations during event9 predicted the peak flow timing with an error less than two hours and the peak flow bias below 14 in the smaller subbasins fig 6 a 3 b 3 and c 3 however the peak flow was largely overestimated at rock creek station7 probably associated with the presence of man made reservoirs such as lake bernard frank and lake needwood originally implemented for flood and sediment control which are not represented in the hydrologic model fig 6 d 3 the hrrr qpf cycles for event19 hurricane zeta showed good spatial fig 3 e and temporal fig 7 agreement with stageiv qpe low bias achieving results similar to those for event9 reinforcing the conjecture that more consistent flood forecasts can be achieved for rainfall events with longer duration and larger extent during event15 flood was observed only at four mile run station2 and correctly detected in the reanalysis and two forecast cycles fig 3 c and d the first flood detection occurred with a lead time of 28 h and peak flow time shift of less than one hour however many false positives occurred in all other stations mainly caused by the displacement and overestimation of the hrrr qpf fig 5 b 1 5 when compared with the stageiv qpe the hrrr qpf showed a tendency to concentrate the rainfall in smaller regions and overestimate the amount by up to 150 200 mm small subbasins such as turkey branch station4 and sligo creek station5 were more sensitive to the rainfall overestimation resulting in three false positives as well as rock creek station7 with four false positives 3 4 sub hourly multipeak analysis in this section we analyzed the effect of hourly simulations on sub hourly watershed response the precipitation during event19 hurricane zeta varied between 45 and 70 mm over a period of 12 h in the subbasins causing floods at three stations 2 3 and 7 that were correctly detected by the reanalysis and forecasts in four to five cycles fig 3 e in contrast with event9 event19 showed multiple peaks in the observed hydrographs while the reanalysis and forecast simulations produced single peak hydrographs at smaller subbasins such as four mile run station2 and cameron run station3 fig 7 this effect can be associated with the temporal resolution hourly of the stageiv qpe and hrrr qpf that cannot represent the sub hourly distribution and consequently the model does not precisely reproduce the multiple peaks in the small size subbasins included in this study although the simulations did not reproduce the multiple hydrograph peaks a visual inspection of the forecasted hydrographs at four mile run fig 7 a 1 3 showed satisfactory agreement with the observed hydrographs kge 0 15 the model overestimated the discharge at cameron run fig 7 b 1 3 however correct flood prediction was consistently achieved during three cycles with lead times above 22 h in addition to event19 we found the occurrence of multiple hydrograph peaks in these subbasins during events 3 4 8 14 and 16 3 5 flood forecast during the most extreme event event18 occurred on 10sep2020 and was the most extreme in the period of this study 20may 31oct 2020 when the highest flood categories were observed the performance during the most extreme events is of high interest for real time flood prediction due to the high potential damage that they can cause hence we chose to conduct a detailed analysis of event18 which also achieved the best forecast performance the accumulated precipitation from stageiv qpe fig 5 e showed that a heavy precipitation cell formed over rock creek and anacostia watersheds generating up to 120 mm of rain in approximately eight hours 1500 2300utc the southern half of rock creek subbasin received a large accumulation 75 mm in comparison with the rest of the region lower accumulations 10 75 mm occurred in the northern parts of the rock creek and anacostia watersheds four mile run subbasin experienced action stage and had a similar rainfall spatial distribution but with lower accumulation in northern regions and higher accumulation in southern parts with a much lower maximum 45 mm the first hrrr qpf cycle starting at 0600 utc 9 sep fig 5 e 1 provided a good prediction of the heaviest precipitation totals however spread over a larger spatial extent than the qpe overestimating the precipitation over most of the domain in other hrrr qpf cycles fig 5 e 2 5 a region with heavy rainfall and circular shape is predicted similar to the pattern in the qpe but with a smaller diameter lower magnitude and spatial displacement the four mile run subbasin received less precipitation than rock creek and anacostia watersheds and besides the first hrrr qpf that overestimated the rainfall fig 5 e 1 there was low absolute bias indicating a good spatial agreement of the total precipitation the forecast initialized at 1200utc on 9 sep fig 8 a at four mile run station 2 shows that the temporal distribution of the hrrr qpf differs from the stage iv qpe but the system is still able to make a satisfactory peak flow prediction the peak flow is slightly underestimated 2 h late and the system correctly predicted the occurrence of action stage with 30 hour lead time turkey branch station4 is the smallest subbasin in this study and most affected by the hrrr underestimation of precipitation correctly predicting flood in only one forecast cycle fig 8 b however the best forecast was made with a lead time of 34 h and 4 h of peak flow time shift too early the hrrr qpf early timing directly affected the peak flow timing once the reanalysis showed good agreement with the observed values flooding was also detected in the first forecast cycle at rock creek station7 and nw branch anacostia river station8 and the best performance happened with a lead time of 24 h fig 8 c although the hrrrqpf led to a prediction of the peak flow about six hours too early at rock creek there was a good agreement in magnitude and hydrograph shape finally at nw anacostia station8 the hrrr qpf peak hour closely matched with the stage iv qpe peak while underestimating the precipitation in other time steps the forecast underestimated the peak flow indicated its occurrence approximately onehour late and produced a satisfactory hydrograph fig 8 d lastly this section investigated the forecast performance during the most extreme event which produced the best forecasts these results demonstrate the potential of the forecast system coupling hrrrv3 with wrf hydro that correctly detected the flood event with 30 h lead time and predicted the peak flow with time shift of 4 h across multiple locations 4 discussion the overall forecast performance was similar to the reanalysis simulations where both detected 65 of all flood events in the study period this result indicates that the forecast simulations which are forced with the hrrr produced similar performance when compared with the reanalysis simulations which use the stageiv qpes demonstrating value to provide flood guidance because of the shifts in cycle to cycle hrrr qpfs the flood forecasts cycles for the same flood event showed high variability especially in shorter and lower rainfall accumulation events this is consistent with the fact that smaller scale storms tend to be less organized to move slowly erratically or become quasi stationary and are difficult to forecast due to their weakly forced nature and chaotic interactions grim et al 2021 additionally the hrrr qpfs often overestimated the precipitation intensity in smaller regions than estimated by the stageiv qpe nevertheless our findings corroborate viterbo et al 2020 which also found large cycle to cycle variability and slight overestimation of the intensity in the hrrr qpf with 18 h duration during a torrential rainfall event in ellicott city maryland on 27may2018 small displacements in space few kilometers and time few hours of the hrrr qpfs strongly influenced the hydrological response at the watershed scale especially in smaller watersheds with lower hit rates such as turkey branch 7 km2 station4 and sligo creek 17 km2 station5 however the effect of these displacements was less critical in larger subbasins included in this study such as rock creek 161 km2 station7 due to higher chances of the watershed capturing the rainfall as also noticed by ghimire et al 2021 if areas receiving the rainfall by qpf and qpe are at different locations but with similar coverage and magnitude within the watershed hydrologic simulations of larger watersheds will have more chances to present a better runoff response the reanalysis and forecast simulations showed limited ability to reproduce observed multi peak hydrographs generated by sub hourly precipitation peaks in small watersheds included in this study such as four mile run 33 km2 station2 and cameron run 88 km2 station3 the hourly resolution of the meteorological forcing defined our simulation time steps of one hour preventing the model representation of multi sub hourly peaks we conducted a comprehensive analysis of the events not limiting to hydrograph metrics such as the kge which showed that the flood forecast achieved satisfactory performance during sub hourly events while the kge is largely used for quantifying hydrologic model performance e g seo et al 2018 tijerina et al 2021 uncertainties related to its estimation require the use of additional metrics to adequately interpret the data clark et al 2021 we found that the kge value from a forecast simulation does not necessarily represent a flood event well when considering not only the hydrograph shape but also the peak flow magnitude and timing the flood forecast performance was superior during precipitation events with larger accumulation and longer duration such as events 9 18 and 19 where a higher number of forecast cycles correctly detect the flood occurrence our results agree with li et al 2021 which also found a better performance of flood forecasts during hurricane harvey in texas when compared with a short duration rainfall event our analysis of multiple flood events also revealed that the flood forecast skill does not necessarily decrease with increasing lead time once flood detection and low bias is achieved for longer lead times as often observed in continuous hydrologic forecasting studies e g awol et al 2021 ghimire et al 2021 many forecasts with lead time above 18 h resulted in better peak flow and hydrograph estimation than shorter duration forecasts demonstrating potential value to increase the time available for decision making using the hrrr product as an example combining hourly updated forecasts up to 18 h and 6 hourly update forecasts above 18 h could enable a multi stage early warning action system approach bischiniotis et al 2019 wang et al 2021 for mitigating the impact of cycle to cycle forecast variability supporting greater lead time for preparedness and response operations in this case preliminary actions could be triggered by a low skilled forecast with a longer lead time while the main action could be activated by a high skilled forecast near to the event start although we used the hrrr which was the best available and suitable nwp product for real time short range forecasting at the time of the events studied here this study was limited to a single deterministic forecast at each cycle considering the qpf and hydrologic modeling uncertainties a single deterministic simulation could have impacted the ability of issuing more persistent cycle to cycle forecasts hence in addition to the benefit of combining the prediction skills from different weather models the use of nwp ensembles can enable multiple forecast simulations and provide an uncertainty range for flood guidance e g cloke and pappenberger 2009 mascaro et al 2010 additionally because our forecast system detected approaching flood events over multiple cycles a time lagged approach hoffman and kalnay 1983 could also contribute to improving the forecast consistency by smoothing the impact of the high variability of the qpfs on flood prediction roberts et al 2020 it is also important to note that we only focused on the analysis of point locations during multiple events where we have stream gauge data rather than flooding extent due to limited flood information from the flood management perspective a real time flood forecast with longer lead times can enable decision makers to launch preparedness actions earlier and increase their effectiveness bischiniotis et al 2019 for instance it can be integrated with the road network to anticipate potential flood areas allowing the identification of alternative routes li et al 2019 versini 2012 and assist emergency response accessibility coles et al 2017 real time flood forecast information is especially important for socio economically vulnerable populations tanir et al 2021 tate et al 2021 which can be more impacted by flood events coupling socio economic vulnerability information with flood forecasts should provide meaningful information from an impact focused perspective merz et al 2020 and guide decisions to allocate resources towards locations under greater threat in this study we demonstrated the value of coupling hrrrv3 with wrf hydro for producing real time flood forecasts with up to 36 h lead time which can be integrated with the aforementioned actions 5 conclusions in this study we characterized the short range predictive capability of a real time flood forecast system using the hrrr as the main nwp forcing during multiple flood events at different watersheds in the national capital region we quantified the flood forecast performance using different metrics for 19flood events during 20may 31oct 2020 the main findings of the study are 1 the hrrr qpf can enable skillful flood forecasts with 65 detection rate when compared with the observations sustaining the performance achieved with the reanalysis simulations using stageiv qpe however the high variability of precipitation location magnitude and timing between cycles directly affected the consistency of the flood forecasts this variability was more critical to smaller than larger subbasins due to higher chances of forecasted precipitation to miss smaller watersheds in consequence of spatial displacements additionally the flood forecasts were more consistent for events with larger spatial coverage and higher precipitation amounts 2 the hourly resolution used in the reanalysis and forecast simulations may have limited the reproduction of sub hourly peaks in smaller subbasins however flood forecasts performed well correctly detecting the flood occurrence and resulting in low peak flow magnitude and timing errors 3 extending the flood forecast above 18 h allowed earlier detection of approaching flood events and in some cases such as in events 9 18 and 19 with superior performance than shorter lead times although the hrrr with 36 h duration is updated only every six hours the use of this product added great value for increasing the lead time of approaching floods and can enable more effective preparedness and response actions lastly nwp systems are in continuous development and further research should investigate forecast improvements using the hrrr version4 with 48 h duration and the evaluation of ensemble nwp products such as the high resolution ensemble forecast href roberts et al 2019 produced by the storm prediction center and the rapid refresh forecast system rrfs noaa 2022a both at noaa the rrfs is the next generation convection allowing rapidly updated ensemble prediction system that is planned to include 18 h and 60 h duration forecasts and become available in late 2023 black et al 2021 noaa 2022a to support better hydrologic forecast in small watersheds subhourly e g 15 min time steps surface meteorological fields outputs could be also investigated future work should also focus on extending the flood forecast overland including a systematic approach for collecting data during flood events to enable the verification of flood forecasts beyond stream gauges and integrate this information to produce impact based forecasts credit authorship contribution statement gustavo de a coelho conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization celso m ferreira conceptualization methodology validation writing review editing supervision funding acquisition james l kinter iii conceptualization validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements g coelho was fully supported by a graduate assistantship from george mason university appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128212 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2999,radon concentration in groundwater is affected by meteorological and seismo tectonic factors and is sensitive indicators of crustal stress while previous studies have focused on the mechanisms of periodic and precursory radon anomalies few have quantitatively assessed their influences and compared their rates of change under normal and earthquake conditions this study constructs four models to analyze the mechanisms of radon variation under natural and seismic conditions using the extreme gradient boosting method 1 the multi year dynamic variation model 2 the maximal radon concentration model 3 the minimum radon concentration model and 4 the precursory anomaly model the feature relative importance of external factors influencing radon concentration in groundwater are estimated the optimized extreme gradient boosting model estimated the feature importance of spring discharge sd water temperature wt precipitation p barometric pressure bp and antecedent radon ar to be 23 79 22 16 9 81 18 8 and 25 44 respectively thus sd is the most important influence on radon variation under normal conditions for radon variation during the earthquake preparation period the feature relative importance indicates significant changes in wt increasing from 22 16 to 27 70 and sd decreasing from 23 79 to 17 99 although wt was the most important predictor in the precursory anomaly model its effect on radon solubility is insufficient to explain the radon anomalies prior to the lijiang mw 7 0 earthquake analysis of the precursory mechanisms of these radon anomalies in terms of sd wt p bp and radon emanation found that radon anomalies are most likely caused by increases in radon emanation due to the earthquake induced formation of microfractures in rock keywords radon precursory anomaly extreme gradient boosting machine learning 1 introduction seismic activity is a process of energy accumulation and release the buildup of stress during an earthquake preparation period leads to changes in the transportation of subsurface fluids groundwater gas etc from the deep crust to the shallow crust however the subsurface fluid regime has many influences such as meteorological tectonic anthropogenic and stress strain factors all of which create complexity in identifying earthquake related precursor anomalies radon is a powerful tracer of crustal fluid movement and pressure change it is an inert and water soluble gas produced by the uranium decay series and has a half life of 3 825 days igarashi and wakita 1995 radon anomalies are widely recognized as sensitive earthquake precursors hauksson and egill 1981 kawabata et al 2020 kim et al 2019 siino et al 2019 soldati et al 2020 woith 2015 most previous studies have focused on identifying radon anomalies related to subsequent earthquakes the artificial neural network torkar et al 2010 long short term memory model yan et al 2021 and decision tree method zhang et al 2020 zmazek et al 2005 have been used to identify precursor anomalies by finding discrepancies between monitored values and those predicted by mathematical models however there have been limited quantitative analyses of the mechanisms of such anomalous changes recently the newly developed extreme gradient boosting xgboost method has provided an effective way to achieve this this method can estimate the feature relative importance of several variables attributes to a dependent variable bredy et al 2020 lu and ma 2020 this study focuses on quantitatively assessing the influences of external factors on groundwater radon concentration and explaining the mechanisms of precursory anomalies the following steps were employed 1 the partial autocorrelation function and wavelet analysis were used to determine input variables for xgboost 2 four models based on the xgboost method were constructed to evaluate the feature relative importance of input variables to variations in radon concentration in different periods including periods without seismic activity and in the lead up to the lijiang mw 7 0 earthquake 3 the mechanism of radon concentration change in groundwater in different periods was analyzed by the ensemble empirical mode decomposition eemd and end member mixing model to the best of our knowledge the xgboost method has not yet been used to characterize the correlations between precursory anomalous radon concentration in groundwater and external factors the results of this study contribute to understand the mechanism of radon anomalies induced by earthquakes 2 geological setting and anomalous phenomena the banglazhang geothermal field is located in the north of the yunan tibet geothermal belt tectonically it is located in a junction area of three faults including longchuanjiang fault longling ruili fault and nujiang fault guo et al 2020 guo et al 2017b yan et al 2017 the ew striking xiangbaihe sub fault across the geothermal field which acts as a path for the upward flow of groundwater heated by deep heat sources shi et al 2018 banglazhang 1 hot spring blz 1 about 330 km away from the epicenter of lijiang earthquake has been monitored since april 1976 114 earthquakes with magnitudes mw 5 0 have occurred near the area of blz 1 since 1980 zhang et al 2020 fig 1 changes in spring discharge water temperature and radon concentration have been documented following several large earthquakes including the longling mw 7 3 earthquake in 1976 the lijiang mw 7 0 earthquake in 1996 and the sumatra mw 9 1 earthquake in 2004 yan et al 2020 zhang et al 2020 the lijiang mw 7 0 earthquake which occurred on february 3 1996 is the largest normal faulting seismic activity to have occurred along the western boundary of the sichuan yunnan block the epicenter was located at 27 30 n 100 22 e at depth of 10 km the source parameters of the main shock are strike 6 ne dip 44 w and rake 78 zhao et al 1999 it was followed by 1120 aftershocks with magnitudes 2 5 during the subsequent 250 days ji et al 2017 the largest aftershock of mw 6 0 occurred 30 h after the mainshock 3 methods 3 1 partial autocorrelation function partial autocorrelation function pacf is an efficient time series analysis tool which is widely used to explore the correlation between yt and yt k by eliminating the variables interference yt 1 yt 2 yt k 1 partial autocorrelation coefficients are defined as follow 1 φ kk c o r r y t y t k y t 1 y t 2 y t k 1 φ kk is the correlation coefficient between two random variables yt and yt k the yule walker equation is used to calculate the partial autocorrelation coefficients 2 ρ 1 φ k 1 φ k 2 ρ 1 φ kk ρ k 1 ρ 2 φ k 1 ρ 1 φ k 2 φ kk ρ k 2 ρ k φ k 1 ρ k 1 φ k 2 ρ 1 φ kk partial autocorrelation coefficients can be estimated by using the partial autocorrelation coefficients of the samples by changing the value ρ on the yule walker equation with r and counting for k 1 2 to get the value φ kk using cramer rules pacf has been successfully used to analyze the correlation characteristic of time series in hydrogeological science chang et al 2015 yan et al 2021 in this study we also use this method to explore the correlation of time series between radon concentration at time t and antecedent radon concentration 3 2 extreme gradient boosting method decision tree based algorithms are powerful technique for gaining insights into data structures and building predictive models the core objective is to build a model using several input variables x1 x1 x1 xn and one output variable y by establishing regression trees the widely used algorithms used to create ensemble tree models include bagging and boosting algorithms bauer and kohavi 1999 galar et al 2012 zhou et al 2002 bagging algorithms use a process of training homogeneous weak learners by using bootstrap subsets of the original dataset in parallel and combining them based on a deterministic averaging process the final goal is to prevent model overfitting boosting algorithms integrate many weak learners to develop a strong learner in an iterative manner each subsequent weak learner is trained with a new subset of data that includes observations that were not correctly handled by the previous learners the final goal is to reduce the bias of the resulting model by forcing the weak system learner to focus on the harder samples the xgboost method proposed by chen and guestrin 2016 is based on the boosting algorithm which helps process large amounts of data at high speed the most prominent feature of this method is that it can capture complex non linear relationships between two variables x y and utilize the multithreading capacity of a computer processor to improve the calculation accuracy it has been successfully used in various practical applications natekin and knoll 2013 and is recommended for the prediction of naturally occurring phenomena jia et al 2019 singha et al 2021 zhang et al 2021 the decision tree based model used in the xgboost method adopts an iterative method until the stopping criteria are satisfied values are predicted using the following equation 3 y i k 1 k f k x i f k f where y i is the predicted value fk represents an individual regression tree xi is the input variable k is the number of regression functions and f is the space of all possible cases of fks to learn the set of functions used in the model the following regularized function is minimized 4 l ϕ i 1 n l y i y i k 1 k ω f k 5 ω f k γ t 1 2 λ ω 2 where l is a loss function that calculates the difference between the observed value yi and the predicted value y i ω is the regularization term used to penalize the model complexity to avoid overfitting γ is the complexity of each leaf t is the number of leaves in a decision tree λ is the trade off parameter used to scale the penalty and ω is the vector of scores on the leaves the model is trained in an iterative manner formally let y i t 1 be the prediction of the i th instance at the t th iteration then a new function ft is added to minimize the following function 6 l t i 1 n l y i y i t 1 f t x i ω f t a second order taylor series is conducted for the loss function to simplify the equation the equation can be optimized as follow 7 l t i 1 n l y i y i t 1 g i f t x i 1 2 h i f t 2 x i ω f t 8 g i y t 1 l y i y i t 1 9 h i y t 1 2 l y i y i t 1 where g i and h i are the first and second order gradient statistics on the loss function respectively after removing the constant we can obtain the following simplified function 10 l t i 1 n g i f t x i 1 2 h i f t 2 x i ω f t 3 3 model development variation in the radon concentration of groundwater is recognized to be a sensitive indicator of crustal stress and has external influences such as tectonic subsurface fluid and meteorological factors borchiellini et al 1991 woith 2015 we created four models to quantitatively assess the effect of external factors on the variation in radon including 1 the multi year dynamic variation model 2 the maximal radon concentration model 3 the minimum radon concentration model and 4 the precursory anomaly model models 1 2 and 3 analyze the effects of external factors on radon concentration under natural conditions based on a dataset of non seismic activity from 1980 to 2008 model 4 quantifies the effects of external factors on radon based on a dataset from the lijiang mw7 0 earthquake the maximal and minimum radon concentration model were constructed to quantify the rate of change in external influencing factors when the radon concentration reaches its maximal and minimum value under natural conditions all models are based on daily sampling data and were programmed in python programming language daily data on spring discharge water temperature and groundwater radon concentration from 1977 to 2015 were collected from the earthquake administration of yunnan province while meteorological data precipitation and barometric pressure were collected from the baoshan meteorological station due to the monitoring equipment failures regular maintenance and human errors there are inevitably missing data of monitoring data during the period of monitoring the time span of missing data in the time series of radon water temperature and discharge are less than three days the missing data in the dataset of radon water temperature and discharge are only 0 06 0 09 and 0 11 of the dataset which do not change the dataset reliability and characteristic thus missing monitoring data were interpolated from existing measurements using cubic spline interpolation moritz and bartz beielstein 2015 3 3 1 input variable selection as mentioned the xgboost method was selected to map the relationship between the external influences and groundwater radon concentration selecting the appropriate input variables is the most basic and important step in constructing hydrologic models because they provide the basic information about the hydrogeologic system being modeled although hydrologic models have been developed for decades there are no specific guidelines on how to select the input variables accurately wavelet analysis is an effective tool for processing signal data and can capture both time and frequency domain information it is widely used in hydrological models to identify relationships between input and target variables for blz 1 the results of wavelet analysis indicate that the variation in groundwater radon concentration was influenced by spring discharge water temperature and meteorological factors during the period of 1980 2008 the detailed process is presented in zhang et al 2020 thus spring discharge water temperature precipitation and barometric pressure were considered as input variables of the hydrologic models while the groundwater radon concentration was the target variable blz 1 is seated in a stress strain sensitive location in the conjunction area of three faults here precursory or coseismic responses have been observed following serval earthquakes to identify the dynamic characteristics of time series in different periods we split the time series into two parts one is in the period of seismic activities sa and the other is in the period without seismic activities non sa yan et al 2021 zhang et al 2020 zmazek et al 2003 however it is difficult to determine the exact time interval between the hydrologic precursory anomalies and subsequent seismic activities biagi et al 2000 used an empirical formula to describe the relationship between epicentral distance time interval and magnitude 11 log r t 0 63 m 0 15 where r is the epicentral distance km t is the time interval between the hydrological anomaly and subsequent earthquake day and m is the earthquake magnitude due to the highly nonlinear and complex characteristics of earthquake induced precursory anomalies different methods of detecting precursory hydrological anomalies may provide different results the predicted time interval between a hydrological anomaly and subsequent earthquake may also differ according to the method used to further evaluate the reliability of the results we compared the time intervals inferred by biagi et al 2000 with those of other methods fig 2 before the lijiang earthquake zhang et al 2020 used the decision tree method to identify a time interval of 50 days between the radon anomaly in blz 1 and the subsequent earthquake yan 2018 applied superposed epoch analysis to identify precursory times and found that radon anomalies occurred 80 days before earthquakes the exponentially weighted moving average control chart ewma was used to identify the start time of precursory anomalies with the results indicating that the precursory period of radon anomalies is 55 days in the biagi et al 2000 empirical formula the minimum and maximal time intervals between radon anomalies and subsequent earthquakes were 63 days and 126 days respectively a comparison showed that the anomalous periods identified by other methods are basically within those reported by biagi et al 2000 which indicates that their methods can identify anomalies effectively in addition yan et al 2021 used the biagi et al 2000 empirical formula to divide the time series of monitoring data into sa and non sa datasets and applied an lstm model constructed from non sa data to accurately identify hydrological precursory anomalies before the lijiang earthquake qiao et al 2022 used the critical slowing down theory based on biagi et al 2000 empirical formula to successfully identify radon anomalies at eight monitoring stations thus it is reasonable to use biagi et al 2000 empirical formula to identify the precursory period before earthquakes in table 1 and 2 we calculated the time interval of precursory anomalies based on the empirical formula of biagi et al 2000 for 24 earthquakes during the period of 1980 2008 and then divided the dataset into sa and non sa parts for earthquakes occurring in 2000 2001 due to the overlap between the sa start and end dates all were categorized as sa 16 the multi year dynamic variation model was based on the data from all non sa periods between 1980 and 2008 and the precursory anomaly model was based on the dataset in sa 13 during the whole measurement period the maximal and minimum radon concentration occurred in 1983 and 2001 thus the maximal radon concentration model is based on data from non sa 2 with the minimal radon concentration model based on data from non sa 17 3 3 2 feature relative importance evaluating the feature relative importance or contribution of each input variable is useful in creating a predictive model unlike other machine learning algorithms xgboost can compare the predictive power of each input variable and evaluate the feature relative importance in the predictive model during the training process the feature relative importance of each input variable is determined by a measure of relevance i j 2 based on the number of times that variable was selected for splitting in the tree weighted by the squared improvement to the model of each split friedman and meulman 2003 it is defined by the following equation 12 i j 2 1 m m 1 m i j 2 t m the feature relative importance of each input variable in the xgboost model is scaled so that the sum adds to 100 the higher the features relative importance is the stronger the influence of input variable on the predicted model elith et al 2008 3 3 3 data normalization and performance criteria in order to eliminate the dimensional influence and improve learning efficiency the min max normalization approach is introduced to normalize input variables into the range of 0 1 as follow 13 x norm x x min x max x min where x is the observed value xnorm is the normalized value xmax and xmin are the maximal and minimum observed values respectively after training the values output by the model are retransformed through the contrary process of the above equation four error metrics are used to evaluate the models predictive efficiency and accuracy as follow mean absolute percentage error mape 14 mape 1 n i 1 n y i y i y i x 100 root mean square error rmse 15 rmse i 1 n y i y i 2 n nash sutcliffe efficiency nse 16 nse 1 i 1 n y i y i 2 i 1 n y i y i 2 coefficient of determination r2 17 r 2 1 i 1 n y i y i 2 i 1 n y i 2 i 1 n y i 2 n where yi is the observed value y i is the simulated value y i is the mean of the observed values and n is the number of observations the mape is used to evaluate model accuracy as a percentage swanson et al 2011 the rmse is the deviation between the observed and simulated values and smaller values indicate a better model the nse is used to measure the model performance for training and testing and is an efficiency indicator for hydrologic models nse values close to 1 indicate satisfactory model predictability yoon et al 2011 the r2 is a measure of linear regression goodness of fit between observed and modeled values when the rmse is close to zero and the nse and r2 are close to one the model is regarded to be a good fit to the observed values 3 3 4 model training and testing while there is no fixed ratio of training and testing datasets it is believed that the training dataset should comprise 50 of the whole dataset barzegar et al 2019 bredy et al 2020 yu and ma 2021 in this study the whole dataset is split into two subsets 1 training containing 70 of the data randomly selected for each dataset and 2 testing containing the remaining 30 the training process aims to optimize a set of model parameters that enable the model to map the relationship between the input variables and target variable the parameters are summarized in table 3 which are employed to construct four models by using the xgboost method the value of max depth min child weight and colsample by tree are set to 10 0 1 and 1 0 respectively in all models the parameters of n rounds and learning rate are the most varied among the four models the smaller the learning rate the higher the predictive accuracy of the model elith et al 2008 a low learning rate requires a high number of iterations freeman et al 2016 for the multi year dynamic variation model the learning rate is set to 0 05 and the number of iterations is 3500 for the maximal radon concentration model and the minimum radon concentration model there are 5000 n rounds and learning rate are 0 08 and 0 073 respectively for the precursory anomaly model the number of iterations is set to 1500 and the learning rate is set to 0 13 4 results 4 1 partial autocorrelation function result to determine whether antecedent radon can be considered as an input variable partial autocorrelation analysis was conducted on a time series of radon concentration during 1980 2008 as is shown in fig 3 the 0th order partial autocorrelation coefficient is a constant value of 1 the partial autocorrelation coefficient has a slight oscillation about the 0 axis which indicates that the radon time series has a stationary signal the results of pacf show a significant correlation with a lag time of 12 days for radon concentration which falls within the confidence band thus significant autocorrelation exists in the time series of hydrological observations which indicates that the previous radon concentration dataset is suitable for use as the input variable to predict the target variable 4 2 model accuracy the training and testing results of the four models are shown in fig 4 the x axis and y axis represent the observed and predicted values respectively under the ideal condition the predicted results should be distributed over x y or evenly distributed on both sides of the line the closer to the x y line the smaller the errors the training and testing errors are summarized in table 4 the maximum rmse in the training and testing is 0 08 which indicates that the four models have appropriate simulation capacity the nse measures the predictive power of a hydrological model and its result nse 0 8 indicates that the modeling accuracy is high during training and testing the r2 ranges from 0 85 to 0 93 in the training and testing datasets which indicates that the simulated values closely match the observed values the mape value is close to 0 which suggests satisfactory quality for the training and test but the mape ranges from 6 46 to 15 62 in this study meng et al 2019 found that irregular oscillations of a time series may cause high mape values for a predictive model the variation in radon concentration in blz 1 is affected by nearby seismic activity and shows highly irregular oscillation thus this may be the main reason for the high mape of the models 4 3 feature relative importance of input variables the features relative importance of input variables obtained from the four models are summarized in table 5 table 6 and fig 5 for the multi year dynamic variation model ar is the most important predictor with the value of 25 44 the feature relative importance of sd is 23 79 which is slightly larger than that of wt at 22 16 the feature relative importance of p is 9 81 which is the lowest value of all input variables the feature relative importance of bp is 18 8 for the maximal radon concentration model ar is also the most important input variable and its value is 26 63 the sd wt and bp are 25 4 22 97 and 19 74 respectively the lowest value of relative feature importance is p at 5 26 for the minimum radon concentration model sd is the most important input variable with the value of 26 07 the ar wt and bp are 24 29 21 07 and 19 29 respectively the lowest value of relative feature importance is p at 9 28 the feature relative importance obtained from the precursory anomaly model is significantly different from that inferred from the period without seismic activity wt is the most important input variables with a value of 27 7 with the feature relative importance of 10 78 p is still the weakest predictor for the other input variables the values are 25 9 17 99 and 17 63 for ar sd and bp respectively the rates of change in the feature relative importance of the input variables of different models are also calculated the multi year dynamic variation model mydv maximal radon concentration model max rc and minimum radon concentration model min rc are used to analyze the effect of input variables on radon variation under natural conditions compared to the relative feature importance in the mydv those of sd wt p bp and ar obtained from the max rc are 6 77 3 66 46 38 5 00 and 4 68 higher respectively and the those of sd wt p bp and ar obtained from the min rc 9 58 4 92 5 40 2 61 and 4 52 higher respectively except for p in the max rc the rates of change in the relative feature importance of all input variables in the max rc and min rc models are 10 under natural conditions even when the radon concentration reaches the maximum and minimum values the rates of change in the relative feature importance of the input variables are still 10 in addition we also calculate the rates of change in the feature relative importance of input variables between the pa and the mydv max rc and min rc compared to the relative feature importance in the mydv max rc and min rc the rates of change in relative feature importance of sd and wt in the pa range from 20 59 to 31 47 which are significantly greater than those of other input variables this indicates that the effects of water temperature and spring discharge on precursory anomalous changes in radon concentration were obviously greater than those of other factors before the lijiang earthquake although the rate of change in p ranges from 5 40 to 104 94 the feature relative importance of p in different models ranges from 5 26 to 10 78 giving it less influence on the variation in output variables and making it the weakest predictor thus we infer that the precursory anomalous changes in radon before the lijiang mw7 0 earthquake may be attributed to changes in the feature relative importance of spring discharge and water temperature 5 discussion based on the xgboost method we used four models to assess the feature relative importance of external factors on the variation in radon concentration however this analysis did not reveal the mechanism of this variation in this section we explore this mechanism during periods without earthquake and during precursory variation before the lijiang mw 7 0 earthquake 5 1 external influences on radon variation during the non seismic period compared to the multi year dynamic variation model the feature relative importance of the input variables in the maximal radon concentration model and the minimum radon concentration model varies within a small range 10 ar and sd are the two most important input variables for constructing the models the sum of their feature relative importance of them is 50 in this section we focus on the effect of changes in spring discharge on the variation in radon concentration groundwater is an important carrier fluid for the transfer of hydrochemical components and dissolved gas the blz 1 is recharged by rainfall that infiltrates through highly fractured ruptures from the surface to depth after being heated by a magma pocket the spring water is mixed with shallow cold water and returns to the surface due to a hydraulic gradient guo et al 2020 guo et al 2017a shi et al 2018 radon gas dissolution occurs throughout the path of the whole cycle thus variation in spring discharge may play a key role in the variation of radon ensemble empirical mode decomposition eemd was used to decompose the spring discharge time series and explore its variation throughout the measurement period eemd was developed from emd to overcome its mode mixing and data ends effect problems in emd the emd method is based on an assumption that the time series is comprised of different intrinsic modes of oscillation each oscillatory mode can be represented by an intrinsic mode function imf under the following condition 1 the numbers of extrema and zero crossing values are either equal or differ by at most one in the whole time series 2 at any point the mean value of the envelopes defined by the local maxima and minima is zero based on this eemd adds white noise of fixed amplitude to the time series and decomposes it into imf components that are the mean of an ensemble of imfs obtained from n trials finally eemd decomposes the time series into several imfs and the residual item 18 x t c 1 t c 2 t c n t r n t r the residual item r is commonly interpreted as the long time trend castino et al 2017 wu et al 2007 the original time series can be restored by the sum of all imfs and the residual item r as is shown in fig 6 eemd decomposes the spring discharge time series into eight imfs and the residual item r the behavior of the r component indicates that the radon concentration in groundwater decreased gradually from 1980 to 2008 the maximum and minimum value of radon concentration occurred in 1981 and 2001 respectively and there was a decreasing trend during 1980 2008 which is consistent with the eemd results combined with the results of wavelet analysis and the xgboost method we conclude that the variation in spring discharge is the main influence on radon concentration in the period without seismic activity 5 2 identification of precursory anomalies in discharge and water temperature the exponentially weighted moving average control chart ewma has a strong ability to detect gradual drifts and small fluctuations and was used to identify the start times of precursory anomalies in spring discharge water temperature and radon concentration the ewma control chart consists of upper and lower control limits ucl and lcl respectively both can be calculated by the following equation 19 u c l l c l μ l σ λ 2 λ 1 1 λ 2 t in general when the value of λ ranges from 0 05 to 0 25 the ewma has excellent detection ability chen et al 2016 actually the smaller the value of λ the more flexible and effective the ewma is l set as 9 in this study which represents the width of the control limits zhang et al 2019 variables μ and σ denote the arithmetic mean and standard deviation respectively the monitoring data obtained between the two earthquakes july 12 1995 earthquake and lijiang mw7 0 earthquake were used to analyze the ewma control chart and identify precursory anomalies before the lijiang mw7 0 earthquake as shown in fig 7 the precursory periods of radon concentration discharge and water temperature were 55 days 47 days and 45 days respectively the precursory period estimated by the ewma control chart is consistent with the minimum value estimated by biagi et al 2000 empirical formula thus the radon concentration water temperature and discharge showed precursory anomalous changes prior to the lijiang mw7 0 earthquake 5 3 mechanism of radon concentration anomalies before the lijiang mw7 0 earthquake the xgboost results indicate that the feature relative importance of input variables changed during the earthquake preparation process compared with the multi year dynamic variation model the feature relative importance of wt in the precursory anomaly model increased from 22 16 to 27 7 which is the most important vector of all input variables the rate of change in the feature relative importance of wt was 24 97 while those of other input variables were 10 we speculate that the anomalous change in radon concentration before the lijiang mw7 0 earthquake may be related to the variation in water temperature meanwhile the results of wavelet analysis revealed that the variation in radon concentration in blz 1 was affected by changes in spring discharge water temperature precipitation and barometric pressure under natural conditions yan et al 2017 zhang et al 2020 however the xgboost method and wavelet analysis only reveal the relationship between different time series numerically and cannot explain its physical mechanism based on these results we speculate that the anomalous changes in radon concentration prior to the lijiang mw7 0 earthquake may be related to variations in water temperature spring discharge precipitation and barometric pressure the solubility of radon gas in water is affected by temperature which may be the main reason why water temperature appeared to affect radon concentration koike et al 2014 provide an empirical equation for the solubility coefficient of radon s 0 1057 0 405 exp 0 0502 t the solubility coefficient has a negative correlation with water temperature during the period of earthquake preparation the water temperature decreased from 87 9 to 85 and the radon concentration increased from 117 bq l to 285 bq l according to the above equation the solubility coefficient of radon is 0 1106 at 87 9 and 0 1114 at 85 hence the gas solubility at 85 is only 0 7 higher than that at 87 9 which cannot explain the anomalous change in radon concentration from 117 bq l to 285 bq l thus variation in the solubility coefficient at different water temperatures cannot explain the precursory anomalies in radon concentration there may be other factors related to seismic activity that affect the anomalous variation in radon concentration blz 1 contains a mixture of shallow cold water and deep hot water with the ration of 7 3 guo et al 2017a since the solubility coefficient of radon varied according to water temperature there are also significant differences in the radon concentrations of groundwater of different temperatures a previous study revealed that earthquake induced permeability changes affect the discharges of different aquifers and the ratio of shallow cold water to deep hot water shi et al 2018 which may also cause anomalies in groundwater radon concentration kitagawa and koizumi 2000 used the two end members to analyze the earthquake induced mixing process of groundwater from different sources we used a two end member model to analyze the earthquake induced mixing process of groundwater from different sources 21 d observed d s d d 22 t observed t s d s t d d d d s d d where d observed is the observed spring discharge d s and d d are the discharges from shallow cold water and deep hot water respectively t observed is the observed water temperature and t s and t d are the water temperatures of shallow cold water and deep hot water respectively based on the above equations the discharges of shallow and deep sources can be estimated by the following equations 23 d s d observed t observed t d t s t d 24 d d d observed 1 t observed t d t s t d the discharges of shallow and deep sources are shown in fig 8 which indicates that they changed during the earthquake preparation process the shallow cold water discharge change ranging from 0 0069 l s to 0 0075 l s which is a greater change than that of deep hot water ranging from 0 0034 l s to 0 0035 l s this may be the main reason for the anomalous increase in spring discharge and abnormal decrease in water temperature if the anomalous change in radon concentration was due to the mixing of groundwater with different radon concentrations the change should be step like in fact the radon concentration gradually changed from 117 bq l to 285 bq l before the lijiang mw7 0 earthquake thus the anomalous change in groundwater radon concentration cannot be attributed to spring discharge changes during the seismogenic period the influence of barometric pressure on groundwater radon concentration is due to the fact that the radon degassing efficiency is affected by barometric pressure during the measurement process the spring water is sampled and degassed by bubbling with air and transporting it into an ion chamber where the radon concentration is measured by an ionization or scintillation method the lijiang mw7 0 earthquake occurred in february 1996 and its preparation period was in winter as is known the barometric pressure in winter is higher than that in summer higher barometric pressure decreases the degassing efficiency and more gas radon dissolves in water which causes the radon concentration measured in spring water to be low this is inconsistent with the trend in radon concentration during the earthquake preparation period thus the precursory anomalous changes in radon concentration cannot be attributed to variation in barometric pressure according to the results of the hydrogeochemical investigation blz 1 is recharged by meteoric water during the rainy season recharge by rain may dilute the spring water s radon concentration zhang et al 2020 however the accumulated precipitation in december 1995 and january 1996 were only 0 3 mm and 1 3 mm respectively thus the anomalies in radon concentration are unrelated to variations in precipitation in addition to the mechanisms described above previous studies have revealed that precursory anomalies in groundwater radon concentration may be related to 1 gas liquid phase conversion and 2 the expansion contraction of rocks and associated crack formation gas liquid phase conversion is based on the assumption that radon volatilizes from groundwater into the gaseous phase it can only explain anomalous decreases in groundwater radon concentration which is inconsistent with the anomalies observed prior to the lijiang earthquake during the earthquake preparation process earthquake induced crustal stress changes change the rock s physical properties such as the number of micro fractures porosity and surface area per unit volume hoehn and gunten 1989 torgersen et al 2013 radon is produced from 226ra in the natural radioactive decay chain of 238u the content of parent nuclides is not determined by rock rupture but by the physical properties of the rock the exposure of fresh surfaces by seismic activity is believed to allow radon to escape from the rock matrix laboratory results have shown that microfractures can increase rock porosity from 20 to 400 prior to fracture meanwhile anomalously high concentrations of rn he and co2 have been reported in soil gases and spring gases in active fault zones during seismic activity doğan et al 2009 wakita et al 1980 based on thermal infrared satellite images qiang et al 1999 found that regional crustal stress changes caused increased gas release along faults during the lijiang mw7 0 earthquake preparation process blz 1 is located at the intersection of three fault zones where the regional crustal stress changes dramatically microfractures in rocks caused by stress strain changes will increase radon emanation which would alter the groundwater radon concentration reddy and rama 1996 thus the anomalous rise in groundwater radon concentration is attributed to the formation of macroscopic cracks in the rock mass and aquifer systems 6 application of machine learning methods to hydrology based on the quantitatively analysis of radon anomalous change before the lijiang mw7 0 earthquake by the xgboost method this section compares four commonly used machine learning algorithms to analyze their advantages and disadvantages and summarizes the steps for applying machine learning algorithms in hydrology 6 1 comparison of different machine learning methods machine learning methods have attracted increasing attention in hydrology presenting both opportunities and challenges the advantages and disadvantages of different machine learning methods in analyzing hydrological datasets remain unclear we compare the ann rnn lstm and xgboost methods in terms of architecture type of data advantages and disadvantages in the following section table 7 the multilayer perceptron mlp is a commonly used type of feed forward ann its basic architecture comprises three layers input layer hidden layer and output layer if the hidden layer has more than one layer the neural network is called a deep neural network dnn in anns a non linear activation function is used in each node of the hidden and output layers such as sigmoid tanh and softmax the mlp learning process includes back propagation and forward propagation in the forward propagation process the input variables are imported into the input layer and then processed layer by layer in a forward manner in the back propagation process the connection weights of the neural network are updated in reverse layer by layer using optimization methods until the error the difference between the predicted and measured values is reduced to an acceptable level the mlp is a static memoryless network where the neurons are not connected within the same layer the advantage of mlp is that the network can be trained to learn a relationship between the input variables and output variable without prior knowledge of the physical mechanism between them the disadvantage of mlp is that the relationships among the input variables cannot be considered a recurrent neural network rnn is a dynamic neural network used for analyzing time series data unlike the mlp architecture the adjacent neurons in the hidden layer are connected in an rnn through these connections the time dependent information from the input variables of previous stages can be transferred through these neurons in the hidden layer during forward propagation the influence of the initial input variables on the output variable decays with time and the neural network gradually forgets the information of the initial input variable rnns are hard to train for problems with the long time lag between the input variables and output variable during back propagation the vanishing and exploding gradient problems are the greatest shortcomings as they may prevent the network training process from being updated lstm is a special type of rnn that has three memory blocks in the hidden layer forget gate input gate and output gate the gate units in the neural network were introduced by hochreiter and schmidhuber 1997 to overcome the vanishing and exploding gradient problems of rnn a forget gate is used to decide which historical information from the previous neurons can be ignored the input gate is used to determine which information should be extracted from the previous neurons and transferred into the current neurons the output gate controls the information output to the rest of the network all three gates control the flow and transfer of information among the different neurons and layers if the forget gate is set to zero and the input and output gates are set to one and the lstm model will be the same as a standard rnn however there is a trade off between achieving better performance and simplifying the neural network architecture the computational speed of the neural network is affected by the existence of the three memory blocks in the hidden layer compared to a standard rnn lstms are insensitive to the input variables time series lengths compared with other machine learning methods ann rnn and lstm the xgboost method has two advantages it speeds up the learning process by using parallel computing and analyzes the contribution of each input variable to the predictor variable however the xgboost method is still a data driven machine learning algorithm and has some limitations in practical applications selecting the appropriate input variables is the basis for applying this algorithm to establish a model if a physical quantity cannot be input this method cannot calculate the relative feature importance such as the amount of radon emanating from rock failure in addition this algorithm has a black box nature and cannot explain the mechanism linking the input and output variables 6 2 steps for the application of xgboost method in hydrology monitoring variations in physical quantities is one of the most important ways to explain the mechanisms of dynamic change and make predictions however various difficulties and challenges in analyzing time series of monitoring data are often encountered including how to manage missing data select an appropriate analysis method and improve the prediction accuracy applying the xgboost method to the analysis of hydrological monitoring time series involves three steps 1 data collection and complementation and normalization 2 identification of input variables and 3 model parameter adjustment and error analysis 1 data collection complementation and normalization in the analysis of hydrological time series we not only need to analyze the time series of single physical quantities but also analyze time series of other physical quantities related to change such as hydro geochemistry water temperature and meteorological factors the more time series of monitoring variables are collected the easier it is to analyze the mechanisms of change then the continuity of the monitoring data should be examined during the monitoring period there are inevitably many errors in monitoring data due to equipment failure regular maintenance and human error one of the most frequently occurring issues is missing data in most machine learning methods the input data must have equal time intervals various methods of data complementation have been proposed and used in a wide range of applications such as cubic spline interpolation chen et al 2021 inverse distance weighting ke et al 2011 and kriging interpolation dai et al 2003 in addition to eliminate the dimensional influence and improve learning efficiency the raw monitoring data should be normalized 2 identification of input variables due to the fact that the machine learning method only establishes the relationship between input variables and the output variable and cannot explain the mechanism linking them selecting reasonable input variables is a basic step in applying machine learning methods to solve hydrogeological problems common methods of analyzing time series include the cross correlation function qu et al 2021 partial autocorrelation function yan et al 2021 yu et al 2019 and wavelet coherence analysis an et al 2020 yan et al 2017 wavelet coherence analysis is an effective tool for identifying the potential influences on hydrogeological time series in the time and frequency domains which can be used as input variables for a machine learning model in addition to being affected by external influences the dynamics of a time series are also affected by its own dynamics in a previous time period hence the partial autocorrelation function is commonly used to identify the numerical relationship between a time series at time t and at a previous time 3 model parameter adjustment and error analysis unlike the parameters in a traditional hydrological model the parameters in a machine learning model have no physical meaning error indexes need to be applied to adjust the parameters during the establishment process commonly used error indexes include mape rmse nse and the coefficient of determination r in general when the values of mape and rmse are close to zero and the values of nse and r2 are close to one the model performance is excellent 7 conclusion this study employed wavelet analysis and pacf to assess the external influences on variations in groundwater radon concentration at blz 1 under natural background conditions and seismic activity taking the lijiang mw7 0 earthquake as an example we used spring discharge sd water temperature wt precipitation p barometric pressure bp and antecedent radon ar as input variables to construct four models based on xgboost method the results of the multi year dynamic model show that the feature relative importance of each input variable affecting radon variation under natural conditions are 23 79 22 16 9 81 18 80 and 25 44 for sd wt p bp and ar respectively in comparison with this model the rates of change in the feature relative importance of all input variables in the maximal radon concentration and minimum radon concentration models vary within 10 except for ar sd was the most important external influence on radon variation during the period without earthquakes the results of the precursory anomaly model indicate that the feature relative importance of the input variables were 17 99 27 7 10 78 17 63 and 25 9 for sd wt p bp and ar respectively compared with the multi year dynamic variation model the rate of change in the feature relative importance of wt was 24 97 rising from 22 16 to 27 7 which was the largest change of all input variables during the preparation period of the lijiang mw7 0 earthquake an anomalous decrease in water temperature was attributed to changes in spring discharge between the shallow and deep aquifers the shallow cold water discharge changed more than the deep hot water discharge although water temperature was identified as an important predictor of radon anomalies by the xgboost method these temperature changes would not affect the solubility coefficient enough to explain the radon anomalies based on analysis of the precursory mechanism from the perspectives of spring discharge water temperature precipitation barometric pressure and radon emanation the radon anomalies are attributed to the earthquake induced formation of microfractures in rock which increases radon emanation credit authorship contribution statement shouchuan zhang methodology software data curation formal analysis writing original draft investigation zheming shi conceptualization formal analysis writing original draft writing review editing guangcai wang writing review editing funding acquisition rui yan writing review editing funding acquisition zuochen zhang data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china u1602233 41972251 we thank wang ziguan and ma xiao for the helpful discussion of establishing the xgboost model by python language 
2999,radon concentration in groundwater is affected by meteorological and seismo tectonic factors and is sensitive indicators of crustal stress while previous studies have focused on the mechanisms of periodic and precursory radon anomalies few have quantitatively assessed their influences and compared their rates of change under normal and earthquake conditions this study constructs four models to analyze the mechanisms of radon variation under natural and seismic conditions using the extreme gradient boosting method 1 the multi year dynamic variation model 2 the maximal radon concentration model 3 the minimum radon concentration model and 4 the precursory anomaly model the feature relative importance of external factors influencing radon concentration in groundwater are estimated the optimized extreme gradient boosting model estimated the feature importance of spring discharge sd water temperature wt precipitation p barometric pressure bp and antecedent radon ar to be 23 79 22 16 9 81 18 8 and 25 44 respectively thus sd is the most important influence on radon variation under normal conditions for radon variation during the earthquake preparation period the feature relative importance indicates significant changes in wt increasing from 22 16 to 27 70 and sd decreasing from 23 79 to 17 99 although wt was the most important predictor in the precursory anomaly model its effect on radon solubility is insufficient to explain the radon anomalies prior to the lijiang mw 7 0 earthquake analysis of the precursory mechanisms of these radon anomalies in terms of sd wt p bp and radon emanation found that radon anomalies are most likely caused by increases in radon emanation due to the earthquake induced formation of microfractures in rock keywords radon precursory anomaly extreme gradient boosting machine learning 1 introduction seismic activity is a process of energy accumulation and release the buildup of stress during an earthquake preparation period leads to changes in the transportation of subsurface fluids groundwater gas etc from the deep crust to the shallow crust however the subsurface fluid regime has many influences such as meteorological tectonic anthropogenic and stress strain factors all of which create complexity in identifying earthquake related precursor anomalies radon is a powerful tracer of crustal fluid movement and pressure change it is an inert and water soluble gas produced by the uranium decay series and has a half life of 3 825 days igarashi and wakita 1995 radon anomalies are widely recognized as sensitive earthquake precursors hauksson and egill 1981 kawabata et al 2020 kim et al 2019 siino et al 2019 soldati et al 2020 woith 2015 most previous studies have focused on identifying radon anomalies related to subsequent earthquakes the artificial neural network torkar et al 2010 long short term memory model yan et al 2021 and decision tree method zhang et al 2020 zmazek et al 2005 have been used to identify precursor anomalies by finding discrepancies between monitored values and those predicted by mathematical models however there have been limited quantitative analyses of the mechanisms of such anomalous changes recently the newly developed extreme gradient boosting xgboost method has provided an effective way to achieve this this method can estimate the feature relative importance of several variables attributes to a dependent variable bredy et al 2020 lu and ma 2020 this study focuses on quantitatively assessing the influences of external factors on groundwater radon concentration and explaining the mechanisms of precursory anomalies the following steps were employed 1 the partial autocorrelation function and wavelet analysis were used to determine input variables for xgboost 2 four models based on the xgboost method were constructed to evaluate the feature relative importance of input variables to variations in radon concentration in different periods including periods without seismic activity and in the lead up to the lijiang mw 7 0 earthquake 3 the mechanism of radon concentration change in groundwater in different periods was analyzed by the ensemble empirical mode decomposition eemd and end member mixing model to the best of our knowledge the xgboost method has not yet been used to characterize the correlations between precursory anomalous radon concentration in groundwater and external factors the results of this study contribute to understand the mechanism of radon anomalies induced by earthquakes 2 geological setting and anomalous phenomena the banglazhang geothermal field is located in the north of the yunan tibet geothermal belt tectonically it is located in a junction area of three faults including longchuanjiang fault longling ruili fault and nujiang fault guo et al 2020 guo et al 2017b yan et al 2017 the ew striking xiangbaihe sub fault across the geothermal field which acts as a path for the upward flow of groundwater heated by deep heat sources shi et al 2018 banglazhang 1 hot spring blz 1 about 330 km away from the epicenter of lijiang earthquake has been monitored since april 1976 114 earthquakes with magnitudes mw 5 0 have occurred near the area of blz 1 since 1980 zhang et al 2020 fig 1 changes in spring discharge water temperature and radon concentration have been documented following several large earthquakes including the longling mw 7 3 earthquake in 1976 the lijiang mw 7 0 earthquake in 1996 and the sumatra mw 9 1 earthquake in 2004 yan et al 2020 zhang et al 2020 the lijiang mw 7 0 earthquake which occurred on february 3 1996 is the largest normal faulting seismic activity to have occurred along the western boundary of the sichuan yunnan block the epicenter was located at 27 30 n 100 22 e at depth of 10 km the source parameters of the main shock are strike 6 ne dip 44 w and rake 78 zhao et al 1999 it was followed by 1120 aftershocks with magnitudes 2 5 during the subsequent 250 days ji et al 2017 the largest aftershock of mw 6 0 occurred 30 h after the mainshock 3 methods 3 1 partial autocorrelation function partial autocorrelation function pacf is an efficient time series analysis tool which is widely used to explore the correlation between yt and yt k by eliminating the variables interference yt 1 yt 2 yt k 1 partial autocorrelation coefficients are defined as follow 1 φ kk c o r r y t y t k y t 1 y t 2 y t k 1 φ kk is the correlation coefficient between two random variables yt and yt k the yule walker equation is used to calculate the partial autocorrelation coefficients 2 ρ 1 φ k 1 φ k 2 ρ 1 φ kk ρ k 1 ρ 2 φ k 1 ρ 1 φ k 2 φ kk ρ k 2 ρ k φ k 1 ρ k 1 φ k 2 ρ 1 φ kk partial autocorrelation coefficients can be estimated by using the partial autocorrelation coefficients of the samples by changing the value ρ on the yule walker equation with r and counting for k 1 2 to get the value φ kk using cramer rules pacf has been successfully used to analyze the correlation characteristic of time series in hydrogeological science chang et al 2015 yan et al 2021 in this study we also use this method to explore the correlation of time series between radon concentration at time t and antecedent radon concentration 3 2 extreme gradient boosting method decision tree based algorithms are powerful technique for gaining insights into data structures and building predictive models the core objective is to build a model using several input variables x1 x1 x1 xn and one output variable y by establishing regression trees the widely used algorithms used to create ensemble tree models include bagging and boosting algorithms bauer and kohavi 1999 galar et al 2012 zhou et al 2002 bagging algorithms use a process of training homogeneous weak learners by using bootstrap subsets of the original dataset in parallel and combining them based on a deterministic averaging process the final goal is to prevent model overfitting boosting algorithms integrate many weak learners to develop a strong learner in an iterative manner each subsequent weak learner is trained with a new subset of data that includes observations that were not correctly handled by the previous learners the final goal is to reduce the bias of the resulting model by forcing the weak system learner to focus on the harder samples the xgboost method proposed by chen and guestrin 2016 is based on the boosting algorithm which helps process large amounts of data at high speed the most prominent feature of this method is that it can capture complex non linear relationships between two variables x y and utilize the multithreading capacity of a computer processor to improve the calculation accuracy it has been successfully used in various practical applications natekin and knoll 2013 and is recommended for the prediction of naturally occurring phenomena jia et al 2019 singha et al 2021 zhang et al 2021 the decision tree based model used in the xgboost method adopts an iterative method until the stopping criteria are satisfied values are predicted using the following equation 3 y i k 1 k f k x i f k f where y i is the predicted value fk represents an individual regression tree xi is the input variable k is the number of regression functions and f is the space of all possible cases of fks to learn the set of functions used in the model the following regularized function is minimized 4 l ϕ i 1 n l y i y i k 1 k ω f k 5 ω f k γ t 1 2 λ ω 2 where l is a loss function that calculates the difference between the observed value yi and the predicted value y i ω is the regularization term used to penalize the model complexity to avoid overfitting γ is the complexity of each leaf t is the number of leaves in a decision tree λ is the trade off parameter used to scale the penalty and ω is the vector of scores on the leaves the model is trained in an iterative manner formally let y i t 1 be the prediction of the i th instance at the t th iteration then a new function ft is added to minimize the following function 6 l t i 1 n l y i y i t 1 f t x i ω f t a second order taylor series is conducted for the loss function to simplify the equation the equation can be optimized as follow 7 l t i 1 n l y i y i t 1 g i f t x i 1 2 h i f t 2 x i ω f t 8 g i y t 1 l y i y i t 1 9 h i y t 1 2 l y i y i t 1 where g i and h i are the first and second order gradient statistics on the loss function respectively after removing the constant we can obtain the following simplified function 10 l t i 1 n g i f t x i 1 2 h i f t 2 x i ω f t 3 3 model development variation in the radon concentration of groundwater is recognized to be a sensitive indicator of crustal stress and has external influences such as tectonic subsurface fluid and meteorological factors borchiellini et al 1991 woith 2015 we created four models to quantitatively assess the effect of external factors on the variation in radon including 1 the multi year dynamic variation model 2 the maximal radon concentration model 3 the minimum radon concentration model and 4 the precursory anomaly model models 1 2 and 3 analyze the effects of external factors on radon concentration under natural conditions based on a dataset of non seismic activity from 1980 to 2008 model 4 quantifies the effects of external factors on radon based on a dataset from the lijiang mw7 0 earthquake the maximal and minimum radon concentration model were constructed to quantify the rate of change in external influencing factors when the radon concentration reaches its maximal and minimum value under natural conditions all models are based on daily sampling data and were programmed in python programming language daily data on spring discharge water temperature and groundwater radon concentration from 1977 to 2015 were collected from the earthquake administration of yunnan province while meteorological data precipitation and barometric pressure were collected from the baoshan meteorological station due to the monitoring equipment failures regular maintenance and human errors there are inevitably missing data of monitoring data during the period of monitoring the time span of missing data in the time series of radon water temperature and discharge are less than three days the missing data in the dataset of radon water temperature and discharge are only 0 06 0 09 and 0 11 of the dataset which do not change the dataset reliability and characteristic thus missing monitoring data were interpolated from existing measurements using cubic spline interpolation moritz and bartz beielstein 2015 3 3 1 input variable selection as mentioned the xgboost method was selected to map the relationship between the external influences and groundwater radon concentration selecting the appropriate input variables is the most basic and important step in constructing hydrologic models because they provide the basic information about the hydrogeologic system being modeled although hydrologic models have been developed for decades there are no specific guidelines on how to select the input variables accurately wavelet analysis is an effective tool for processing signal data and can capture both time and frequency domain information it is widely used in hydrological models to identify relationships between input and target variables for blz 1 the results of wavelet analysis indicate that the variation in groundwater radon concentration was influenced by spring discharge water temperature and meteorological factors during the period of 1980 2008 the detailed process is presented in zhang et al 2020 thus spring discharge water temperature precipitation and barometric pressure were considered as input variables of the hydrologic models while the groundwater radon concentration was the target variable blz 1 is seated in a stress strain sensitive location in the conjunction area of three faults here precursory or coseismic responses have been observed following serval earthquakes to identify the dynamic characteristics of time series in different periods we split the time series into two parts one is in the period of seismic activities sa and the other is in the period without seismic activities non sa yan et al 2021 zhang et al 2020 zmazek et al 2003 however it is difficult to determine the exact time interval between the hydrologic precursory anomalies and subsequent seismic activities biagi et al 2000 used an empirical formula to describe the relationship between epicentral distance time interval and magnitude 11 log r t 0 63 m 0 15 where r is the epicentral distance km t is the time interval between the hydrological anomaly and subsequent earthquake day and m is the earthquake magnitude due to the highly nonlinear and complex characteristics of earthquake induced precursory anomalies different methods of detecting precursory hydrological anomalies may provide different results the predicted time interval between a hydrological anomaly and subsequent earthquake may also differ according to the method used to further evaluate the reliability of the results we compared the time intervals inferred by biagi et al 2000 with those of other methods fig 2 before the lijiang earthquake zhang et al 2020 used the decision tree method to identify a time interval of 50 days between the radon anomaly in blz 1 and the subsequent earthquake yan 2018 applied superposed epoch analysis to identify precursory times and found that radon anomalies occurred 80 days before earthquakes the exponentially weighted moving average control chart ewma was used to identify the start time of precursory anomalies with the results indicating that the precursory period of radon anomalies is 55 days in the biagi et al 2000 empirical formula the minimum and maximal time intervals between radon anomalies and subsequent earthquakes were 63 days and 126 days respectively a comparison showed that the anomalous periods identified by other methods are basically within those reported by biagi et al 2000 which indicates that their methods can identify anomalies effectively in addition yan et al 2021 used the biagi et al 2000 empirical formula to divide the time series of monitoring data into sa and non sa datasets and applied an lstm model constructed from non sa data to accurately identify hydrological precursory anomalies before the lijiang earthquake qiao et al 2022 used the critical slowing down theory based on biagi et al 2000 empirical formula to successfully identify radon anomalies at eight monitoring stations thus it is reasonable to use biagi et al 2000 empirical formula to identify the precursory period before earthquakes in table 1 and 2 we calculated the time interval of precursory anomalies based on the empirical formula of biagi et al 2000 for 24 earthquakes during the period of 1980 2008 and then divided the dataset into sa and non sa parts for earthquakes occurring in 2000 2001 due to the overlap between the sa start and end dates all were categorized as sa 16 the multi year dynamic variation model was based on the data from all non sa periods between 1980 and 2008 and the precursory anomaly model was based on the dataset in sa 13 during the whole measurement period the maximal and minimum radon concentration occurred in 1983 and 2001 thus the maximal radon concentration model is based on data from non sa 2 with the minimal radon concentration model based on data from non sa 17 3 3 2 feature relative importance evaluating the feature relative importance or contribution of each input variable is useful in creating a predictive model unlike other machine learning algorithms xgboost can compare the predictive power of each input variable and evaluate the feature relative importance in the predictive model during the training process the feature relative importance of each input variable is determined by a measure of relevance i j 2 based on the number of times that variable was selected for splitting in the tree weighted by the squared improvement to the model of each split friedman and meulman 2003 it is defined by the following equation 12 i j 2 1 m m 1 m i j 2 t m the feature relative importance of each input variable in the xgboost model is scaled so that the sum adds to 100 the higher the features relative importance is the stronger the influence of input variable on the predicted model elith et al 2008 3 3 3 data normalization and performance criteria in order to eliminate the dimensional influence and improve learning efficiency the min max normalization approach is introduced to normalize input variables into the range of 0 1 as follow 13 x norm x x min x max x min where x is the observed value xnorm is the normalized value xmax and xmin are the maximal and minimum observed values respectively after training the values output by the model are retransformed through the contrary process of the above equation four error metrics are used to evaluate the models predictive efficiency and accuracy as follow mean absolute percentage error mape 14 mape 1 n i 1 n y i y i y i x 100 root mean square error rmse 15 rmse i 1 n y i y i 2 n nash sutcliffe efficiency nse 16 nse 1 i 1 n y i y i 2 i 1 n y i y i 2 coefficient of determination r2 17 r 2 1 i 1 n y i y i 2 i 1 n y i 2 i 1 n y i 2 n where yi is the observed value y i is the simulated value y i is the mean of the observed values and n is the number of observations the mape is used to evaluate model accuracy as a percentage swanson et al 2011 the rmse is the deviation between the observed and simulated values and smaller values indicate a better model the nse is used to measure the model performance for training and testing and is an efficiency indicator for hydrologic models nse values close to 1 indicate satisfactory model predictability yoon et al 2011 the r2 is a measure of linear regression goodness of fit between observed and modeled values when the rmse is close to zero and the nse and r2 are close to one the model is regarded to be a good fit to the observed values 3 3 4 model training and testing while there is no fixed ratio of training and testing datasets it is believed that the training dataset should comprise 50 of the whole dataset barzegar et al 2019 bredy et al 2020 yu and ma 2021 in this study the whole dataset is split into two subsets 1 training containing 70 of the data randomly selected for each dataset and 2 testing containing the remaining 30 the training process aims to optimize a set of model parameters that enable the model to map the relationship between the input variables and target variable the parameters are summarized in table 3 which are employed to construct four models by using the xgboost method the value of max depth min child weight and colsample by tree are set to 10 0 1 and 1 0 respectively in all models the parameters of n rounds and learning rate are the most varied among the four models the smaller the learning rate the higher the predictive accuracy of the model elith et al 2008 a low learning rate requires a high number of iterations freeman et al 2016 for the multi year dynamic variation model the learning rate is set to 0 05 and the number of iterations is 3500 for the maximal radon concentration model and the minimum radon concentration model there are 5000 n rounds and learning rate are 0 08 and 0 073 respectively for the precursory anomaly model the number of iterations is set to 1500 and the learning rate is set to 0 13 4 results 4 1 partial autocorrelation function result to determine whether antecedent radon can be considered as an input variable partial autocorrelation analysis was conducted on a time series of radon concentration during 1980 2008 as is shown in fig 3 the 0th order partial autocorrelation coefficient is a constant value of 1 the partial autocorrelation coefficient has a slight oscillation about the 0 axis which indicates that the radon time series has a stationary signal the results of pacf show a significant correlation with a lag time of 12 days for radon concentration which falls within the confidence band thus significant autocorrelation exists in the time series of hydrological observations which indicates that the previous radon concentration dataset is suitable for use as the input variable to predict the target variable 4 2 model accuracy the training and testing results of the four models are shown in fig 4 the x axis and y axis represent the observed and predicted values respectively under the ideal condition the predicted results should be distributed over x y or evenly distributed on both sides of the line the closer to the x y line the smaller the errors the training and testing errors are summarized in table 4 the maximum rmse in the training and testing is 0 08 which indicates that the four models have appropriate simulation capacity the nse measures the predictive power of a hydrological model and its result nse 0 8 indicates that the modeling accuracy is high during training and testing the r2 ranges from 0 85 to 0 93 in the training and testing datasets which indicates that the simulated values closely match the observed values the mape value is close to 0 which suggests satisfactory quality for the training and test but the mape ranges from 6 46 to 15 62 in this study meng et al 2019 found that irregular oscillations of a time series may cause high mape values for a predictive model the variation in radon concentration in blz 1 is affected by nearby seismic activity and shows highly irregular oscillation thus this may be the main reason for the high mape of the models 4 3 feature relative importance of input variables the features relative importance of input variables obtained from the four models are summarized in table 5 table 6 and fig 5 for the multi year dynamic variation model ar is the most important predictor with the value of 25 44 the feature relative importance of sd is 23 79 which is slightly larger than that of wt at 22 16 the feature relative importance of p is 9 81 which is the lowest value of all input variables the feature relative importance of bp is 18 8 for the maximal radon concentration model ar is also the most important input variable and its value is 26 63 the sd wt and bp are 25 4 22 97 and 19 74 respectively the lowest value of relative feature importance is p at 5 26 for the minimum radon concentration model sd is the most important input variable with the value of 26 07 the ar wt and bp are 24 29 21 07 and 19 29 respectively the lowest value of relative feature importance is p at 9 28 the feature relative importance obtained from the precursory anomaly model is significantly different from that inferred from the period without seismic activity wt is the most important input variables with a value of 27 7 with the feature relative importance of 10 78 p is still the weakest predictor for the other input variables the values are 25 9 17 99 and 17 63 for ar sd and bp respectively the rates of change in the feature relative importance of the input variables of different models are also calculated the multi year dynamic variation model mydv maximal radon concentration model max rc and minimum radon concentration model min rc are used to analyze the effect of input variables on radon variation under natural conditions compared to the relative feature importance in the mydv those of sd wt p bp and ar obtained from the max rc are 6 77 3 66 46 38 5 00 and 4 68 higher respectively and the those of sd wt p bp and ar obtained from the min rc 9 58 4 92 5 40 2 61 and 4 52 higher respectively except for p in the max rc the rates of change in the relative feature importance of all input variables in the max rc and min rc models are 10 under natural conditions even when the radon concentration reaches the maximum and minimum values the rates of change in the relative feature importance of the input variables are still 10 in addition we also calculate the rates of change in the feature relative importance of input variables between the pa and the mydv max rc and min rc compared to the relative feature importance in the mydv max rc and min rc the rates of change in relative feature importance of sd and wt in the pa range from 20 59 to 31 47 which are significantly greater than those of other input variables this indicates that the effects of water temperature and spring discharge on precursory anomalous changes in radon concentration were obviously greater than those of other factors before the lijiang earthquake although the rate of change in p ranges from 5 40 to 104 94 the feature relative importance of p in different models ranges from 5 26 to 10 78 giving it less influence on the variation in output variables and making it the weakest predictor thus we infer that the precursory anomalous changes in radon before the lijiang mw7 0 earthquake may be attributed to changes in the feature relative importance of spring discharge and water temperature 5 discussion based on the xgboost method we used four models to assess the feature relative importance of external factors on the variation in radon concentration however this analysis did not reveal the mechanism of this variation in this section we explore this mechanism during periods without earthquake and during precursory variation before the lijiang mw 7 0 earthquake 5 1 external influences on radon variation during the non seismic period compared to the multi year dynamic variation model the feature relative importance of the input variables in the maximal radon concentration model and the minimum radon concentration model varies within a small range 10 ar and sd are the two most important input variables for constructing the models the sum of their feature relative importance of them is 50 in this section we focus on the effect of changes in spring discharge on the variation in radon concentration groundwater is an important carrier fluid for the transfer of hydrochemical components and dissolved gas the blz 1 is recharged by rainfall that infiltrates through highly fractured ruptures from the surface to depth after being heated by a magma pocket the spring water is mixed with shallow cold water and returns to the surface due to a hydraulic gradient guo et al 2020 guo et al 2017a shi et al 2018 radon gas dissolution occurs throughout the path of the whole cycle thus variation in spring discharge may play a key role in the variation of radon ensemble empirical mode decomposition eemd was used to decompose the spring discharge time series and explore its variation throughout the measurement period eemd was developed from emd to overcome its mode mixing and data ends effect problems in emd the emd method is based on an assumption that the time series is comprised of different intrinsic modes of oscillation each oscillatory mode can be represented by an intrinsic mode function imf under the following condition 1 the numbers of extrema and zero crossing values are either equal or differ by at most one in the whole time series 2 at any point the mean value of the envelopes defined by the local maxima and minima is zero based on this eemd adds white noise of fixed amplitude to the time series and decomposes it into imf components that are the mean of an ensemble of imfs obtained from n trials finally eemd decomposes the time series into several imfs and the residual item 18 x t c 1 t c 2 t c n t r n t r the residual item r is commonly interpreted as the long time trend castino et al 2017 wu et al 2007 the original time series can be restored by the sum of all imfs and the residual item r as is shown in fig 6 eemd decomposes the spring discharge time series into eight imfs and the residual item r the behavior of the r component indicates that the radon concentration in groundwater decreased gradually from 1980 to 2008 the maximum and minimum value of radon concentration occurred in 1981 and 2001 respectively and there was a decreasing trend during 1980 2008 which is consistent with the eemd results combined with the results of wavelet analysis and the xgboost method we conclude that the variation in spring discharge is the main influence on radon concentration in the period without seismic activity 5 2 identification of precursory anomalies in discharge and water temperature the exponentially weighted moving average control chart ewma has a strong ability to detect gradual drifts and small fluctuations and was used to identify the start times of precursory anomalies in spring discharge water temperature and radon concentration the ewma control chart consists of upper and lower control limits ucl and lcl respectively both can be calculated by the following equation 19 u c l l c l μ l σ λ 2 λ 1 1 λ 2 t in general when the value of λ ranges from 0 05 to 0 25 the ewma has excellent detection ability chen et al 2016 actually the smaller the value of λ the more flexible and effective the ewma is l set as 9 in this study which represents the width of the control limits zhang et al 2019 variables μ and σ denote the arithmetic mean and standard deviation respectively the monitoring data obtained between the two earthquakes july 12 1995 earthquake and lijiang mw7 0 earthquake were used to analyze the ewma control chart and identify precursory anomalies before the lijiang mw7 0 earthquake as shown in fig 7 the precursory periods of radon concentration discharge and water temperature were 55 days 47 days and 45 days respectively the precursory period estimated by the ewma control chart is consistent with the minimum value estimated by biagi et al 2000 empirical formula thus the radon concentration water temperature and discharge showed precursory anomalous changes prior to the lijiang mw7 0 earthquake 5 3 mechanism of radon concentration anomalies before the lijiang mw7 0 earthquake the xgboost results indicate that the feature relative importance of input variables changed during the earthquake preparation process compared with the multi year dynamic variation model the feature relative importance of wt in the precursory anomaly model increased from 22 16 to 27 7 which is the most important vector of all input variables the rate of change in the feature relative importance of wt was 24 97 while those of other input variables were 10 we speculate that the anomalous change in radon concentration before the lijiang mw7 0 earthquake may be related to the variation in water temperature meanwhile the results of wavelet analysis revealed that the variation in radon concentration in blz 1 was affected by changes in spring discharge water temperature precipitation and barometric pressure under natural conditions yan et al 2017 zhang et al 2020 however the xgboost method and wavelet analysis only reveal the relationship between different time series numerically and cannot explain its physical mechanism based on these results we speculate that the anomalous changes in radon concentration prior to the lijiang mw7 0 earthquake may be related to variations in water temperature spring discharge precipitation and barometric pressure the solubility of radon gas in water is affected by temperature which may be the main reason why water temperature appeared to affect radon concentration koike et al 2014 provide an empirical equation for the solubility coefficient of radon s 0 1057 0 405 exp 0 0502 t the solubility coefficient has a negative correlation with water temperature during the period of earthquake preparation the water temperature decreased from 87 9 to 85 and the radon concentration increased from 117 bq l to 285 bq l according to the above equation the solubility coefficient of radon is 0 1106 at 87 9 and 0 1114 at 85 hence the gas solubility at 85 is only 0 7 higher than that at 87 9 which cannot explain the anomalous change in radon concentration from 117 bq l to 285 bq l thus variation in the solubility coefficient at different water temperatures cannot explain the precursory anomalies in radon concentration there may be other factors related to seismic activity that affect the anomalous variation in radon concentration blz 1 contains a mixture of shallow cold water and deep hot water with the ration of 7 3 guo et al 2017a since the solubility coefficient of radon varied according to water temperature there are also significant differences in the radon concentrations of groundwater of different temperatures a previous study revealed that earthquake induced permeability changes affect the discharges of different aquifers and the ratio of shallow cold water to deep hot water shi et al 2018 which may also cause anomalies in groundwater radon concentration kitagawa and koizumi 2000 used the two end members to analyze the earthquake induced mixing process of groundwater from different sources we used a two end member model to analyze the earthquake induced mixing process of groundwater from different sources 21 d observed d s d d 22 t observed t s d s t d d d d s d d where d observed is the observed spring discharge d s and d d are the discharges from shallow cold water and deep hot water respectively t observed is the observed water temperature and t s and t d are the water temperatures of shallow cold water and deep hot water respectively based on the above equations the discharges of shallow and deep sources can be estimated by the following equations 23 d s d observed t observed t d t s t d 24 d d d observed 1 t observed t d t s t d the discharges of shallow and deep sources are shown in fig 8 which indicates that they changed during the earthquake preparation process the shallow cold water discharge change ranging from 0 0069 l s to 0 0075 l s which is a greater change than that of deep hot water ranging from 0 0034 l s to 0 0035 l s this may be the main reason for the anomalous increase in spring discharge and abnormal decrease in water temperature if the anomalous change in radon concentration was due to the mixing of groundwater with different radon concentrations the change should be step like in fact the radon concentration gradually changed from 117 bq l to 285 bq l before the lijiang mw7 0 earthquake thus the anomalous change in groundwater radon concentration cannot be attributed to spring discharge changes during the seismogenic period the influence of barometric pressure on groundwater radon concentration is due to the fact that the radon degassing efficiency is affected by barometric pressure during the measurement process the spring water is sampled and degassed by bubbling with air and transporting it into an ion chamber where the radon concentration is measured by an ionization or scintillation method the lijiang mw7 0 earthquake occurred in february 1996 and its preparation period was in winter as is known the barometric pressure in winter is higher than that in summer higher barometric pressure decreases the degassing efficiency and more gas radon dissolves in water which causes the radon concentration measured in spring water to be low this is inconsistent with the trend in radon concentration during the earthquake preparation period thus the precursory anomalous changes in radon concentration cannot be attributed to variation in barometric pressure according to the results of the hydrogeochemical investigation blz 1 is recharged by meteoric water during the rainy season recharge by rain may dilute the spring water s radon concentration zhang et al 2020 however the accumulated precipitation in december 1995 and january 1996 were only 0 3 mm and 1 3 mm respectively thus the anomalies in radon concentration are unrelated to variations in precipitation in addition to the mechanisms described above previous studies have revealed that precursory anomalies in groundwater radon concentration may be related to 1 gas liquid phase conversion and 2 the expansion contraction of rocks and associated crack formation gas liquid phase conversion is based on the assumption that radon volatilizes from groundwater into the gaseous phase it can only explain anomalous decreases in groundwater radon concentration which is inconsistent with the anomalies observed prior to the lijiang earthquake during the earthquake preparation process earthquake induced crustal stress changes change the rock s physical properties such as the number of micro fractures porosity and surface area per unit volume hoehn and gunten 1989 torgersen et al 2013 radon is produced from 226ra in the natural radioactive decay chain of 238u the content of parent nuclides is not determined by rock rupture but by the physical properties of the rock the exposure of fresh surfaces by seismic activity is believed to allow radon to escape from the rock matrix laboratory results have shown that microfractures can increase rock porosity from 20 to 400 prior to fracture meanwhile anomalously high concentrations of rn he and co2 have been reported in soil gases and spring gases in active fault zones during seismic activity doğan et al 2009 wakita et al 1980 based on thermal infrared satellite images qiang et al 1999 found that regional crustal stress changes caused increased gas release along faults during the lijiang mw7 0 earthquake preparation process blz 1 is located at the intersection of three fault zones where the regional crustal stress changes dramatically microfractures in rocks caused by stress strain changes will increase radon emanation which would alter the groundwater radon concentration reddy and rama 1996 thus the anomalous rise in groundwater radon concentration is attributed to the formation of macroscopic cracks in the rock mass and aquifer systems 6 application of machine learning methods to hydrology based on the quantitatively analysis of radon anomalous change before the lijiang mw7 0 earthquake by the xgboost method this section compares four commonly used machine learning algorithms to analyze their advantages and disadvantages and summarizes the steps for applying machine learning algorithms in hydrology 6 1 comparison of different machine learning methods machine learning methods have attracted increasing attention in hydrology presenting both opportunities and challenges the advantages and disadvantages of different machine learning methods in analyzing hydrological datasets remain unclear we compare the ann rnn lstm and xgboost methods in terms of architecture type of data advantages and disadvantages in the following section table 7 the multilayer perceptron mlp is a commonly used type of feed forward ann its basic architecture comprises three layers input layer hidden layer and output layer if the hidden layer has more than one layer the neural network is called a deep neural network dnn in anns a non linear activation function is used in each node of the hidden and output layers such as sigmoid tanh and softmax the mlp learning process includes back propagation and forward propagation in the forward propagation process the input variables are imported into the input layer and then processed layer by layer in a forward manner in the back propagation process the connection weights of the neural network are updated in reverse layer by layer using optimization methods until the error the difference between the predicted and measured values is reduced to an acceptable level the mlp is a static memoryless network where the neurons are not connected within the same layer the advantage of mlp is that the network can be trained to learn a relationship between the input variables and output variable without prior knowledge of the physical mechanism between them the disadvantage of mlp is that the relationships among the input variables cannot be considered a recurrent neural network rnn is a dynamic neural network used for analyzing time series data unlike the mlp architecture the adjacent neurons in the hidden layer are connected in an rnn through these connections the time dependent information from the input variables of previous stages can be transferred through these neurons in the hidden layer during forward propagation the influence of the initial input variables on the output variable decays with time and the neural network gradually forgets the information of the initial input variable rnns are hard to train for problems with the long time lag between the input variables and output variable during back propagation the vanishing and exploding gradient problems are the greatest shortcomings as they may prevent the network training process from being updated lstm is a special type of rnn that has three memory blocks in the hidden layer forget gate input gate and output gate the gate units in the neural network were introduced by hochreiter and schmidhuber 1997 to overcome the vanishing and exploding gradient problems of rnn a forget gate is used to decide which historical information from the previous neurons can be ignored the input gate is used to determine which information should be extracted from the previous neurons and transferred into the current neurons the output gate controls the information output to the rest of the network all three gates control the flow and transfer of information among the different neurons and layers if the forget gate is set to zero and the input and output gates are set to one and the lstm model will be the same as a standard rnn however there is a trade off between achieving better performance and simplifying the neural network architecture the computational speed of the neural network is affected by the existence of the three memory blocks in the hidden layer compared to a standard rnn lstms are insensitive to the input variables time series lengths compared with other machine learning methods ann rnn and lstm the xgboost method has two advantages it speeds up the learning process by using parallel computing and analyzes the contribution of each input variable to the predictor variable however the xgboost method is still a data driven machine learning algorithm and has some limitations in practical applications selecting the appropriate input variables is the basis for applying this algorithm to establish a model if a physical quantity cannot be input this method cannot calculate the relative feature importance such as the amount of radon emanating from rock failure in addition this algorithm has a black box nature and cannot explain the mechanism linking the input and output variables 6 2 steps for the application of xgboost method in hydrology monitoring variations in physical quantities is one of the most important ways to explain the mechanisms of dynamic change and make predictions however various difficulties and challenges in analyzing time series of monitoring data are often encountered including how to manage missing data select an appropriate analysis method and improve the prediction accuracy applying the xgboost method to the analysis of hydrological monitoring time series involves three steps 1 data collection and complementation and normalization 2 identification of input variables and 3 model parameter adjustment and error analysis 1 data collection complementation and normalization in the analysis of hydrological time series we not only need to analyze the time series of single physical quantities but also analyze time series of other physical quantities related to change such as hydro geochemistry water temperature and meteorological factors the more time series of monitoring variables are collected the easier it is to analyze the mechanisms of change then the continuity of the monitoring data should be examined during the monitoring period there are inevitably many errors in monitoring data due to equipment failure regular maintenance and human error one of the most frequently occurring issues is missing data in most machine learning methods the input data must have equal time intervals various methods of data complementation have been proposed and used in a wide range of applications such as cubic spline interpolation chen et al 2021 inverse distance weighting ke et al 2011 and kriging interpolation dai et al 2003 in addition to eliminate the dimensional influence and improve learning efficiency the raw monitoring data should be normalized 2 identification of input variables due to the fact that the machine learning method only establishes the relationship between input variables and the output variable and cannot explain the mechanism linking them selecting reasonable input variables is a basic step in applying machine learning methods to solve hydrogeological problems common methods of analyzing time series include the cross correlation function qu et al 2021 partial autocorrelation function yan et al 2021 yu et al 2019 and wavelet coherence analysis an et al 2020 yan et al 2017 wavelet coherence analysis is an effective tool for identifying the potential influences on hydrogeological time series in the time and frequency domains which can be used as input variables for a machine learning model in addition to being affected by external influences the dynamics of a time series are also affected by its own dynamics in a previous time period hence the partial autocorrelation function is commonly used to identify the numerical relationship between a time series at time t and at a previous time 3 model parameter adjustment and error analysis unlike the parameters in a traditional hydrological model the parameters in a machine learning model have no physical meaning error indexes need to be applied to adjust the parameters during the establishment process commonly used error indexes include mape rmse nse and the coefficient of determination r in general when the values of mape and rmse are close to zero and the values of nse and r2 are close to one the model performance is excellent 7 conclusion this study employed wavelet analysis and pacf to assess the external influences on variations in groundwater radon concentration at blz 1 under natural background conditions and seismic activity taking the lijiang mw7 0 earthquake as an example we used spring discharge sd water temperature wt precipitation p barometric pressure bp and antecedent radon ar as input variables to construct four models based on xgboost method the results of the multi year dynamic model show that the feature relative importance of each input variable affecting radon variation under natural conditions are 23 79 22 16 9 81 18 80 and 25 44 for sd wt p bp and ar respectively in comparison with this model the rates of change in the feature relative importance of all input variables in the maximal radon concentration and minimum radon concentration models vary within 10 except for ar sd was the most important external influence on radon variation during the period without earthquakes the results of the precursory anomaly model indicate that the feature relative importance of the input variables were 17 99 27 7 10 78 17 63 and 25 9 for sd wt p bp and ar respectively compared with the multi year dynamic variation model the rate of change in the feature relative importance of wt was 24 97 rising from 22 16 to 27 7 which was the largest change of all input variables during the preparation period of the lijiang mw7 0 earthquake an anomalous decrease in water temperature was attributed to changes in spring discharge between the shallow and deep aquifers the shallow cold water discharge changed more than the deep hot water discharge although water temperature was identified as an important predictor of radon anomalies by the xgboost method these temperature changes would not affect the solubility coefficient enough to explain the radon anomalies based on analysis of the precursory mechanism from the perspectives of spring discharge water temperature precipitation barometric pressure and radon emanation the radon anomalies are attributed to the earthquake induced formation of microfractures in rock which increases radon emanation credit authorship contribution statement shouchuan zhang methodology software data curation formal analysis writing original draft investigation zheming shi conceptualization formal analysis writing original draft writing review editing guangcai wang writing review editing funding acquisition rui yan writing review editing funding acquisition zuochen zhang data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china u1602233 41972251 we thank wang ziguan and ma xiao for the helpful discussion of establishing the xgboost model by python language 
