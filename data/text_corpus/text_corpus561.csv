index,text
2805,urbanization causes fundamental shifts in hydrologic partitioning within watersheds leading to excess runoff being quickly routed to nearby conveyances this leads to a host of concerns from flooding to water quality impairments to combat these effects bioretention systems are implemented to restore more natural hydrology in the urban environment to better understand and predict the effectiveness of these interventions there is a need for reliable hydrology models to assess the performance of bioretention cells prior to installation drainmod urban was recently developed to produce hydrographs with a high temporal resolution showing substantial promise during initial testing unfortunately the dataset originally used for testing was limited having minimal occasions of overflow and only consisting of one bioretention location to achieve a more robust analysis of the model drainmod urban was evaluated using two years of monitoring data for four bioretention cells in north carolina the modeled bioretention cells had variable media depths surface storage volumes site conditions and propensity for overflow drainmod urban model parameters were calibrated for a nash sutcliff efficiency nse from 0 14 to 0 60 for drainage and from 0 49 to 0 89 for overflow across the sites using six months of monitoring data model validation confirmed these results producing drainage and overflow hydrographs with accurate timing duration and a range of nses from 0 19 to 0 60 and from 0 49 to 0 81 respectively across the four sites model performance varied across sites high drainage and overflow rates are well predicted compared to extended low rates caused by clogging issues or small storms this study highlights the potential of drainmod urban in modeling bioretention hydrology at a fine temporal scale under varying design configurations keywords bioretention drainmod green infrastructure hydrology modeling data availability data will be made available on request 1 introduction stormwater runoff from the urban environment is listed as one of the major sources of pollutants and hydrologic disruption by the u s environmental protection agency usepa 2017 to ameliorate these effects green infrastructure gi is increasingly being used in stormwater management plans to treat runoff and maintain and or restore the pre development hydrologic regime in urban settings prince george s county 1999 bioretention is a gi practice typically implemented in the urban environment which can be designed into median strips ramp loops traffic circles and parking lot islands ncdenr 2009 these systems consist of a depressed area of engineered soil mixture covered with vegetation and underlain with a gravel bed and underdrains rossman 2015 pioneering field assessments such as hunt et al 2008 and davis 2008 have been critical to understanding and quantifying bioretention performance bioretention reduces runoff volume and peak flows to mitigate flooding and uses biogeochemical processes to improve the quality of stormwater routed to water bodies by removing pollutants such as nitrogen pathogens and suspended solids debusk and wynn 2011 ncdenr 2009 however bioretention performance is sensitive to site conditions leading to a number of efforts to understand key variables affecting the function of these systems and to demonstrate differential performance based on local context fassman beck and saleh 2021 li et al 2018 debusk and wynn 2011 despite these efforts there are a large number of design variations and combinations of variables still untested representing a large amount of effort and expense if field approaches are utilized by providing an efficient and cost effective way to test design options models represent an avenue for the continued comparison and scenario testing indeed reliable hydrologic models are necessary for activities such as the planning and management of gi fassman beck and saleh 2021 determining the effective spatial distribution of gi at the urban watershed scale epps and hathaway 2019 and quantifying groundwater table dynamics zhang and chui 2020 such computational models simplify water flow in systems such as bioretention through concepts from mathematics and physics that facilitate simulation of complex processes liu et al 2014 recent studies have begun to simulate bioretention hydrology using more advanced process based numerical models for example alikhani et al 2020 used the green infrastructure flexible model gifmod to calibrate and validate a catchment scale model against field data over a six week period each with a nash sutcliffe of 0 68 to 0 86 for a log transformed hydrograph of two cells li et al 2021 calibrated a field scale model hydrus one dimensional 1d against experimental data for the purpose of design optimization and obtained an nse greater than 0 5 last a few studies modeled bioretention hydrology with some improvements to account for groundwater influence kim et al 2019 zhang and chui 2020 and pollutant removal taghizadeh et al 2021 a common shortcoming of current models is not accounting for unsaturated flow by assuming that no percolation occurs until the soil reaches the field capacity thus overpredicting the amount of runoff from the cell fassman beck and saleh 2021 another drawback is the use of single event models that neglect the influence of antecedent moisture condition of the soil on infiltration heasom et al 2006 lisenbee et al 2021 reviewed a number of models currently being used to represent bioretention showing that models such as hydrus and gifmod apply richards equation to determine infiltration which requires complex input parameters while other models use a simplified version of richards equation e g green ampt equations such as storm water management model swmm recarga and drainmod notably green ampt assumptions do not account for the variable soil moisture content of bioretention cells drainmod overcomes this limitation using the soil water characteristic curve further internal water storage iws and underdrains can be modeled using drainmod and model for urban stormwater improvement conceptualization music while models such as gifmod hydrus and recarga have limited capability of representing underdrains and lack the ability to model iws zone in upturned elbow configuration brown and hunt 2011a as such drainmod has been identified as a model of interest for representing a diversity of bioretention configurations drainmod is a process based model that was originally created to model drainage in agricultural land due to the similarity in water movement processes through agricultural land and bioretention brown et al 2013 adapted the model to bioretention hydrology drainmod is advantageous in terms of being a continuous long term model with the ability to account for variable soil moisture conditions including unsaturated and partially saturated conditions of bioretention soil layers using the soil water characteristic curve swcc swcc is used to determine the drained volume and upward flux that dominates the infiltration and evapotranspiration through bioretention media lisenbee et al 2020 this is an advancement over other models that use field capacity and saturated volumetric water content which introduce large errors when the water table is close to the surface such as iws configuration brown et al 2013 moreover drainmod can model the internal water storage iws zone in bioretention by adjusting the weir configuration in the model brown et al 2013 using drainmod s daily output including drainage overflow and exfiltration brown et al 2013 calibrated and validated the model for four bioretention cells in north carolina against two years of field data which resulted in nash sutcliffe efficiencies from 0 6 to 0 9 since this initial study more calibration and validation against field measurements for drainmod was conducted by winston 2015 for three bioretention cells in ohio resulting in nses from 0 94 to 0 98 for drainage volumes from 0 71 to 0 97 for overflow volumes and from 0 75 to 0 95 for exfiltration volumes finally li et al 2020 simulated the hydrology and nitrogen transport in bioretention cells in china for the purpose of design optimization the model showed good agreement with monitoring data with nses of 0 78 0 69 and 0 62 during calibration and 0 74 0 66 and 0 65 during validation for drainage nitrate and ammonia nitrogen loss respectively despite these promising results drainmod was evaluated in these studies on a storm to storm basis and only was capable of providing outputs at an hourly temporal scale for urban applications where transport processes are rapid this is often not a high enough resolution lisenbee et al 2020 improved the drainmod hydrology module by developing drainmod urban drainmod urban is capable of simulating drainage overflow and exfiltration with a finer temporal scale up to one minute thus transforming drainmod into a model capable of producing hydrographs that can depict the rapid change in flow in the urban environment this is not only valuable for accessing site scale processes but also understanding how these site scale processes aggregate to the larger watershed lisenbee et al 2020 tested drainmod urban drainage output against 12 events from 7 months of field data for a single bioretention cell in ohio the model demonstrated effective drainage prediction with an nse of 0 60 meanwhile prediction of overflow hydrographs was somewhat poorer with an nse of 0 1 it should be noted that only 4 overflow events occurred at this site over the monitoring period leading to the need for further testing and evaluation as discussed above models identified in literature commonly oversimplify or lack the ability to model underdrains and iws zone thus drainmod urban is a relatively comprehensive drainage model for bioretention practices however this model has only been tested at one location and in particular the ability of the model to simulate overflow hydrographs was not well verified in lisenbee et al 2020 overflow prediction is considered challenging in part due to the relative infrequency of overflow occurring from bioretention resulting in limited data for model testing lisenbee et al 2020 winston 2015 nonetheless accurate overflow prediction is imperative for the application of drainmod urban in the catchment scale verification of model performance over a range of locations and design configurations is also critical before drainmod urban can be considered a viable tool therefore the objectives of this study are 1 assess the ability of drainmod urban to simulate bioretention cell drainage over a diversity of sites and 2 verify that drainmod urban is capable of predicting overflow using a large monitoring dataset that includes more overflow events 2 materials and methods 2 1 site description the study area consists of five bioretention cells constructed in two groups in the impervious asphalt parking lot of a commercial store in nashville nc usa three cells 0 6 m media depth cells were connected in parallel via a pipe with each cell s underdrain routing into the pipe the other two cells 0 9 m media depth cells were connected to a different pipe in the same manner data were only collected at the end of each stormwater pipe thus each set of parallel cells was modeled as a single bioretention cell the detailed bioretention cell characteristics are originally presented by brown and hunt 2012 2011b the two conventionally drained bioretention systems have 0 6 m and 0 9 m depth fill media covered with shrubs perennials and trees without iws the texture of the fill media is classified as sandy loam to loamy sand according to the u s department of agriculture usda cells were originally designed according to north carolina department of environment and natural resources ncdenr 2009 specifications that require capturing the first 2 5 cm of a rainfall event within the surface ponding zone followed by draining that zone within 12 h two years of bioretention cell monitoring data from march 2008 to march 2010 were utilized in this study for calibration and validation of drainmod urban previously the data were parsed into two periods pre repair and post repair and modeled using the original drainmod code i e with daily output by brown et al 2013 these two periods correspond to substantial differences in function due to clogging and construction inaccuracies at the site with both periods being characterized by field monitoring specifically the initial monitoring period pre repair showed increased overflow frequency attributed to both clogging by fine granite during construction and an undersized ponding volume i e surface storage the available storage volume was 28 and 35 of the designed size for the 0 6 m and 0 9 m bioretention cells respectively the two cells were repaired by replacing the top layer of the bioretention media and increasing the storage of both cells by 89 and monitoring continued post repair notably the cells were still undersized relative to their intended design after maintenance resulting in frequent overflow despite this functional concern the sites were favorable for this study s purpose of testing the model capability for simulating overflow the characteristics of the bioretention cells pre and post repair can be observed in table 1 2 2 monitoring methods rainfall intensity and depth were measured on site using a tipping bucket rain gauge isco 674 and manual plastic rain gauge respectively inflow and outflow from the bioretention cells were recorded at 5 min intervals using an automated sampler isco 6712 coupled with a bubbler module isco 730 and sharp crested weirs the outlet pipes from each bioretention system covey combined drainage and overflow from the bioretention cell and are equipped with 90 v notch weirs hence further processing of outflow to separate drainage and overflow was conducted following the approach applied by brown and hunt 2011b the overflow appears as a rapid increase in outflow hydrograph over a short time whereas drainage is a steady flow that increases gradually to separate the overflow and drainage the drainage flow rate before and after the overflow spike is used to interpolate the flow during the overflow period the overflow is obtained by subtracting the drainage from the outflow at the inlet the runoff from the drainage area was not accurately characterized due to the use of a 0 75 m wide rectangular weir resulting in shallow driving head which is challenging to reliably measure therefore inflow to the bioretention cell was estimated using u s epa storm water management model 5 1 swmm using a similar approach to lisenbee et al 2020 the saturated hydraulic conductivity an essential input parameter in the green ampt model was measured using a constant head permeability test as in klute 1986 verification was performed after events larger than 2 5 cm i e those that inundated the system to make sure that the infiltration rate estimated by measuring surface ponding depletion is representative of the constant rate at saturated conditions brown et al 2013 eliminating the effect of the initial moisture condition of the soil green and ampt 1911 the 0 6 m media depth bioretention cell had a hydraulic conductivity of 5 5 cm hr and 4 9 cm hr for the pre and post repair period respectively while the 0 9 m media depth bioretention cell has a 3 5 cm hr and 2 9 cm hr for the pre and post repair period respectively brown et al 2013 volumetric water content in the bioretention cells was measured at four different depths in the 0 6 m and 0 9 m media depths bioretention cells using smart sensors s smc m005 and a hobo microstation for data collection and storage brown et al 2013 2 3 model description as noted above drainmod is a process based continuous simulation model that was originally used to model drainage systems in agricultural fields nitrogen transport salinity and wetland hydrology modeling bioretention hydrology is one of the new applications of drainmod the processes of drainmod listed below are identical to drainmod urban except for the time step at which the processes are simulated the model solves two water balance equations soil surface water balance 1 and soil profile water balance 2 brown et al 2013 1 p f δ s r o 2 δ v a d e t d s f where p is the rainfall f is the infiltration δs is the change in the storage on the surface and ro is the runoff when precipitation rate exceeds infiltration capacity water starts ponding on the surface of the bioretention cell when the storage is full excess water turns into runoff skaggs 1980 for the soil profile water balance δ v a is the change air filled pore volume d is the drainage et is evapotranspiration ds is deep seepage and f is infiltration the drainage rate is computed using the kirkham equation kirkham 1957 when the soil profile is completely saturated the hooghoudt equation is used to compute drainage through the soil when the water table recedes skaggs et al 2012 darcy s law and dupuit forchheimer assumptions are used to compute seepage to compute infiltration using the green ampt equation parameters are obtained from the swcc to account for the change in saturated hydraulic conductivity through the soil profile this is used to calculate an effective ksat at each time step potential evapotranspiration pet is computed using the thornthwaite method thornthwaite 1948 or via user input the actual et is determined based on the soil moisture content if the moisture content of the soil is below the wilting point then the actual et is limited by upward flux depending on the water table depth when the moisture content of soil at the root zone is above the wilting point et is equivalent to pet lisenbee et al 2020 2 4 model input to model bioretention drainmod requires input data including weather data soil characteristics drainage design and vegetation properties these initial model inputs are similar to model input developed by brown et al 2013 for the original drainmod however the use of drainmod urban allows the use of higher resolution runoff and rainfall inputs as discussed above inflows to the bioretention model from the drainage area were computed using swmm at a one minute time interval briefly the parking lot is modeled as a sub catchment which swmm treats as a non linear reservoir with a capacity equivalent to the maximum depression storage precipitation is entered as a model input and infiltration is accounted for using the green ampt model green and ampt 1911 a water balance equation is solved numerically to compute the depth of water over the sub catchment surface if it exceeds the maximum depression storage runoff is generated and routed using manning s equation rossman 2015 notably inflows can be generated using other models or via field observation as available for a given application this inflow is converted to depth within the cell using the drainage area to bioretention area ratio weather files include measured precipitation in 2 min intervals and the daily maximum and minimum air temperature the air temperature was obtained from the state climate office of nc monitoring station nrkm rocky mount located 12 km from the site brown et al 2013 thornthwaite method is applied to compute pet with correction factors originally developed by amatya et al 1995 for a location within 35 km from the study area a constant root depth over the year of 30 and 45 cm is assigned for the 0 6 m and 0 9 m media depth bioretention cells respectively following brown et al 2013 the swcc for each soil layer and the saturated hydraulic conductivity are processed by the drainmod soil utility program to derive the water table volume drained upward flux relationship and infiltration parameters the estimated saturated hydraulic conductivity of the bioretention layer of each cell was initially used and calibrated thereafter the sand and gravel layer estimated saturated hydraulic conductivity is 15 cm h and 200 cm h similar to values used by brown et al 2013 lisenbee et al 2020 following previously measured data in the literature rawls et al 1998 the drainage design is derived from the site characteristics including bioretention cell depth ponding depth drain depth drain size and drain spacing seepage parameters are assigned according to nash county north carolina soil survey recommendations the model accounted for vertical seepage only and no lateral seepage was considered the drainage coefficient is typically used to account for the maximum possible flow according to the geometric configuration of the drain pipe however in the case of bioretention media the drainage of water is limited by the flow of water through soil layers rather than the hydraulic characteristic of the drain pipe thus a large value is assigned to the drainage coefficient to avoid limiting the flow lisenbee et al 2020 2 5 model calibration the nash sutcliffe efficiency coefficient nse and percent bias pbias were used to evaluate the goodness of fit of model output to measured data according to moriasi et al 2007 the nse and pbias are recommended in evaluating the performance of hydrologic models the nse compares the residual variance to the measured data variance eq 3 and ranges from to 1 optimal nse 1 the nse is used to evaluate the overall fit of hydrographs a negative nse indicates that the mean of the measured data provides better estimation than the model pbias indicates the tendency of the model to overestimate pbias 0 or underestimate pbias 0 the measured data with optimal pbias 0 eq 4 as stated by moriasi et al 2007 thus pbias is typically used to evaluate streamflow volume errors and water balances the goodness of fit is evaluated based on the timestep used in the model previous literature indicated acceptable good and excellent model for nse above 0 40 0 60 and 0 75 respectively for daily time step and pbias below 25 skaggs et al 2012 3 nse 1 i 1 n q i sim q i obs 2 i 1 n q i obs q obs 2 4 pbias i 1 n q i obs q i sim 100 i 1 n q i obs where q i sim is the simulated flow q i obs is the observed flow for a given timestep q obs is the average observed flow and n is the number of all the timesteps skaggs et al 2012 provide a qualitative classification of model parameters that can be adjusted during calibration and model parameters that should rarely or never be adjusted during calibration i e above or below the expected range of each parameter in our study the final calibration parameters were selected according to the guidelines by skaggs et al 2012 six model parameters were adjusted during the calibration procedure to achieve the optimum nse and pbias of the overflow and drainage hydrographs the calibration parameters are classified into design parameters seepage parameters and soil parameters the calibrated design parameters were the drainage coefficient and ponding depth calibrated seepage parameters were the thickness of the restrictive layer the piezometric head of the aquifer and the vertical conductivity of the restrictive layer the calibrated soil parameter was the lateral saturated hydraulic conductivity of each soil layer model calibration for other bioretention by lisenbee et al 2020 used the same parameters except for the vertical conductivity of the restrictive layer which was measured for that site thus these parameters are expected to be commonly used in calibrating drainmod urban in future applications the first six months of the monitoring data from each cell were used for model calibration while the second six months were used for model validation drainmod urban was used to compute drainage and overflow from the bioretention at a one minute time interval then the output was aggregated at a five minute interval to match the measured data time interval drainmod urban model calibration followed a similar approach to that used by lisenbee et al 2020 model inputs were set to measured or estimated values then input parameters were adjusted one at a time starting with drainage parameters followed by overflow parameters once the model achieved the maximum cumulative nse and the best hydrograph fit another parameter is calibrated and so on further calibration was performed to minimize the pbias while maintaining the maximum nse visual inspection of hydrographs during this process ensured realistic hydrograph shapes the final calibrated model was selected based on the best nse with the least pbias possible for drainage and overflow drainmod urban was evaluated with respect to the calibrated model s ability to predict 1 the complete time series by considering a single nse and pbias for the calibration and validation period 2 individual event hydrographs peak flow and total volume of both drainage and overflow 3 results and discussion 3 1 model calibration comparing the calibrated model parameters to measured or estimated parameters table 2 at five bioretention cells nashville cells and ursuline college cell showed that the calibrated ponding depths were equivalent to actual ponding depths pre repair and from 35 to 50 less than the measured depths post repair the calibrated piezometric head of the aquifer was 10 higher than estimated value for the 0 9 m pre repair cell and equivalent to estimated values for all other cells the thickness of the restricting layer was set to estimated values for all cells except for 0 6 m pre repair that was 5 less than estimated value the difference between calibrated and estimated vertical conductivity of the restricting layer was between 42 to 100 the difference between the calibrated and the upper limit of measured lateral saturated hydraulic conductivities of the mulch layer lied between 39 and 134 while for the bioretention layer the difference was between 86 and 43 from the upper and lower limit of measured values the calibration sequence used in this study started with the most uncertain parameters such as the lateral saturated hydraulic conductivity and ponding depth followed by less uncertain parameters such as piezometric head of the aquifer thickness and vertical conductivity of the restricting layer 3 1 1 drainage coefficient the drainage coefficient accounts for the hydraulic capacity of the drain pipes it is recommended to use a high drainage coefficient in drainmod in the simulation of bioretention cells since it is predicted that drainage is restricted by the soil parameters rather than the hydraulic capacity of the drain pipes brown et al 2013 drainmod urban uses the daily drainage coefficient to compute the maximum drainage per timestep one minute in this study when the computed drainage exceeds the drainage coefficient the model limits the maximum drainage to the value of the drainage coefficient this affects the drainage hydrograph by introducing constant drainage over time plateau effect instead of a flashy peak as observed in nature thus a high drainage coefficient was used during the calibration of the two bioretention cells pre and post repair to avoid the peak flow plateau effect that was discussed in lisenbee et al 2020 post calibration the drainage coefficient was gradually reduced to the least possible value that does not limit the peak flow table 2 for the pre repair period the drainage coefficient was assigned values equivalent to the maximum observed drainage of 85 cm day and 60 cm day for the 0 6 m and 0 9 m media depth bioretention cells respectively for the post repair period a higher drainage coefficient than the observed daily maximum was assigned of 170 cm day and 75 cm day for the 0 6 m and 0 9 m media depth bioretention cells respectively the high drainage coefficients do not reflect the maximum daily drainage predicted by the model this is attributed to the approach the model uses to compute the peak flow based on the drainage coefficient the model divides the drainage coefficient by the time step to get the peak flow for this time interval which results in small peaks however the maximum daily drainage predicted by the model is less than the drainage coefficient hence it is recommended to compute the drainage coefficient using the same time step used by the model 3 1 2 ponding depth the ponding depth referred to as maximum surface storage in drainmod is considered a design parameter of the bioretention cell that is often adjusted in the calibration process skaggs et al 2012 ponding depth is crucial in partitioning the flow into drainage and overflow for the bioretention cells in the pre repair condition the ponding depth was assigned similar values to the measured depth however for the post repair condition the ponding depth used in calibration is lower than the actual measured ponding depth by 35 to 50 3 1 3 lateral saturated hydraulic conductivity during the post repair period four soil layers were used in the model mulch bioretention media sand and gravel during the pre repair period an additional soil layer was used in the model to account for the clogging that occurred during the construction of the cells the clogging layer is added on top of the bioretention media it was observed that drainage output is not sensitive to the lateral saturated hydraulic conductivity of the sand and gravel layers hence constant values of 15 cm hr and 200 cm hr were assigned in the two bioretention cells both pre and post repair conditions for these layers respectively drainmod urban uses the effective lateral saturated hydraulic conductivity in drainage calculations thus the layer with the lowest hydraulic conductivity governs the drainage output for the pre repair period the calibrated saturated hydraulic conductivities of the mulch layer are higher than the measured values in both cells conversely the calibrated saturated hydraulic conductivities of the bioretention layer had to be reduced below the measured values which is possibly attributed to the clogging issues 3 2 model performance drainage 3 2 1 hydrograph prediction the calibrated drainmod urban model showed good performance in the prediction of drainage hydrographs compared to observed drainage for all cells except for the 0 9 m media depth during the pre repair period see table 3 during the calibration period the nse was 0 44 and 0 60 and pbias was 2 6 and 23 8 for the 0 6 m and 0 9 m media depth cells post repair respectively however for the pre repair period the nse was 0 51 and 0 14 and the pbias was 25 1 and 35 2 for the 0 6 m and 0 9 m media depth cells respectively model validation results were consistent to those of the calibration period as the nse was 0 60 and 0 54 post repair 0 19 and 0 52 pre repair while the pbias was 12 7 and 25 4 post repair and 5 5 and 18 pre repair for the 0 6 m and 0 9 m media depth cells respectively thus the model performed better in drainage prediction during the post repair period compared to the pre repair period this can be attributed to the complicated site condition stemming from the clogging that occurred during the pre repair period which caused low drainage volumes and extended drainage time the model performance for the 0 6 m cell was comparable to the post repair cells despite having slightly lower nse notably the 0 6 m pre repair cells prediction was superior to the 0 9 m pre repair cell the degradation in the performance metrics for the drainage of the 0 9 m cell could be attributed to different clogging pattern that resulted in excessively longer drainage hydrographs with continuous drainage between rainfall events coupled with model tendency to underpredict the falling limbs of hydrograph duration it can be concluded that model calibration to predict drainage in well designed and functioning bioretention cells is straightforward however it gets more challenging but attainable in case of low flows and long drainage period due to clogging when drainage continues to occur between rainfall events individual event nse during the post repair period ranged between 2 27 and 0 92 for the 0 6 m media depth cell with a median event nse of 0 50 individual event nse ranged between 12 04 and 0 86 for the 0 9 m media depth cell with a median event nse of 0 29 lisenbee et al 2020 observed a similar range from 1 75 to 0 80 for individual event nses with median event nse of 0 4 notably the model performed better in the 0 6 m media depth cell compared to the 0 9 m media depth cell for individual events despite the comparable performance of the model in overall drainage prediction 3 2 2 drainage volume the simulated drainage volume of each event was evaluated against the measured drainage volume drainmod urban showed good performance in the prediction of event volume under the hydrograph based calibration process bottom up approach per lisenbee et al 2020 that is adjusting model parameters at a small temporal scale to produce hydrographs that accurately predict peak flow the response time start peak and end of flow and duration of events for the pre repair period cumulative event volume nse was 0 77 and 0 52 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the cumulative event volume nse was 0 90 for both cells fig 1 shows the predicted versus measured drainage volume of all cells during calibration and validation along with their corresponding nse the calibrated models can be seen to systematically underpredict the volume of drainage with pbias of all cells ranging between 15 7 and 9 7 comparatively higher than the ursuline college model by lisenbee et al 2020 that was 6 again the model performed better during the post repair period compared to the pre repair period but overall performance was strong for both also the model was more adept at predicting event volumes than hydrographs which would be expected based on the larger time step associated with this prediction moriasi et al 2007 hence a well calibrated model for drainage hydrographs bottom up approach is capable of good drainage volume prediction this align with lisenbee et al 2022 findings in particular the ability of calibrated drainmod urban to predict hydrographs accurately without compromising volume prediction is an advantages over the commonly used swmm lid bioretention module where user had to trade off volume prediction for hydrographs lisenbee et al 2022 it was observed that 80 of the drainage events with volumes less than 13 m3 precipitation less than 1 cm either had negative nses or did not produce drainage in drainmod urban lisenbee et al 2020 reported low nses for drainage volumes less than 15 m3 to demonstrate the model performance for drainage events with similar volume three events 0 9 m post repair cell with drainage ranging from 55 4 to 56 8 m3 were compared drainmod urban overestimated one event volume by 8 5 nse 0 55 and underestimated the volume of two events by 25 6 and 27 8 nses 0 84 and 0 64 the model predicted higher peak flow for these two events by 0 8 and 13 6 predicted events start time and peak flow time were comparable to those of measured events however the duration of all events was underestimated the difference in nses of those two event hydrographs despite having similar drainage volume indicates that the difference in predicted drainage volume had less impact on the nse compared to the impact of peak flow and event duration on the nse this is consistent with findings by lisenbee et al 2020 3 2 3 drainage event duration and time to peak event duration and time to peak flow are crucial in defining the shape of the hydrograph the model s ability to predict the duration of events and time to peak was assessed graphically as recommended by lisenbee et al 2020 and moriasi et al 2007 the hydrographs of all events during the post repair period of the two bioretention cells showed the model s capability to predict the time of peak flow and the duration of each event with strong accuracy this is consistent with lisenbee et al 2022 findings that calibrated drainmod urban depicts the shape of drainage hydrographs timing and duration properly without introducing plateau effect constant peak over time compared to swmm lid module which produced truncated hydrographs pre repair hydrographs were more complex to predict due to the clogging that resulted in low and irregular flow the modeled hydrographs commonly had time and peak mismatch but events of nse greater than 0 3 had better timing and underpredicted peaks fig 2 presents a sample of events with different nse that indicate the model s ability to accurately predict time to peak and duration of event with a slight shift in end time it is noted that the model predicts the rising portion of the hydrograph better than the falling portion the predicted drainage flow decreases rapidly past the peak flow leading to a small time mismatch with the measured flow as previously stated this explains the poor model performance for the 0 9 m pre repair cell where clogging resulted in excessively slow drainage and elongated the falling limb of hydrographs on the contrary this is not applicable for the 0 6 m pre repair cell where introducing a clogging layer to the model had minor impact on model performance 3 2 4 drainage peak prediction of the drainage peak is significant in the overall performance of the model and is an important characteristic for understanding watershed scale gi performance fig 3 shows the simulated peak flow versus the measured peak flow of all cells for each event at a 5 minute timestep during calibration and validation with their corresponding nses once again performance for peak flow prediction was better for the post repair period compared to the pre repair period the model predicted peak flow with a cumulative nse of 0 24 and 0 38 for the post repair 0 6 m and 0 9 m media depth cells respectively for the whole dataset however the model produced negative cumulative nses for pre repair 0 6 m and 0 9 m media depth cells the model underestimates the peak flow in the post repair period meanwhile the peak flow predicted by the model during the pre repair period had a constant value for all events the constant drainage peak prediction indicates that the clogging layer added to the model with very low lateral saturated hydraulic conductivity limited the peak flow prediction to smaller range particularly a low lateral saturated hydraulic conductivity limits the effective conductivity of all layers which in turn limits peak prediction the nse goodness of fit metric is sensitive to peak prediction therefore even with good timing and overall good volume prediction the hydrograph prediction tends to have poor nse hence the model works best for normal sites with consistent performance and no clogging issues otherwise the user needs to validate the model output ensure good performance 3 3 model performance overflow 3 3 1 hydrograph prediction the performance of drainmod urban in the prediction of overflow hydrographs was not thoroughly assessed in previous literature due to the lack of a significant number of overflow events occurring in the bioretention cells used by lisenbee et al 2020 the clogging and undersized construction that occurred pre repair for the nashville sites resulted in abundant overflow events that were used to calibrate the drainmod urban model and assess its performance the pre repair bioretention cells experienced around 34 overflow events over one year while the post repair period experienced around 15 overflow events the simulated overflow was compared to the observed overflow for the calibration period the nses were 0 56 and 0 89 pre repair and were 0 49 and 0 71 post repair for the 0 6 m and 0 9 m media depth cells respectively table 4 for the validation period the nses were 0 49 and 0 81 pre repair and were 0 64 and 0 63 post repair for the 0 6 m and 0 9 m media depth cells respectively the model performed better in the 0 9 m media depth cell compared to the 0 6 m media depth cell and better than ursuline college cell with an nse of 0 10 observed by lisenbee et al 2020 this is attributed to the bigger number of overflow events available pre repair compared to post repair which allowed for better calibration the simulated overflow pbias showed that the model underestimated the overflow by 8 5 and 6 in the 0 9 m cells pre and post repair respectively higher pbias of 38 8 and 19 were observed for the 0 6 m cells pre and post repair individual event nses ranged from 0 74 to 0 69 median event nse 0 28 and 3 72 to 0 98 median event nse 0 47 and for the 0 6 m and 0 9 m cell pre repair respectively post repair the individual event nses ranged from 0 62 to 0 85 median event nse 0 57 and 8 21 to 0 84 median event nse 0 12 for the 0 9 m and 0 6 m cells respectively for the whole dataset this is consistent with individual event nses range of 1 59 to 0 74 for ursuline college reported by lisenbee et al 2020 despite the higher reported cumulative nse for nashville cells as noted above these values were also generated over a substantially higher number of events than those utilized in lisenbee et al 2020 model calibration improved both the drainage and overflow prediction substantially overflow prediction was sensitive to fewer calibration parameters mostly ponding depth compared to drainage drainage was influenced by the water table level in the model a function of infiltration rate seepage rate and soil water characteristic curve on the scale suggested by skaggs et al 2012 for goodness of fit for daily timesteps it is possible to have excellent overflow prediction nse 0 75 corresponding to poor nse 0 40 or good nse 0 60 drainage prediction for instance the 0 9 m media depth cell model showed poor drainage performance during the pre repair period however the results showed the best overflow prediction performance of the model 3 3 2 overflow volume the modeled overflow volume of each event was compared to the measured overflow volume during calibration and validation shown in fig 4 for the pre repair period cumulative event volume nse was 0 78 and 0 96 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the cumulative event volume nse was 0 59 and 0 83 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset the model predicted the volume of overflow better in pre repair conditions compared to post repair contrary to drainage volume prediction regardless performance was satisfactory under both conditions drainmod urban tends to underestimate the overflow volume by 43 4 1 4 pre repair and 18 3 10 4 post repair for the 0 6 and 0 9 m cells respectively hence the model performed better in the 0 9 m media depth cell models compared to 0 6 m media depth cell models this performance is comparable to ursuline college where overflow volume was overestimated by 9 8 lisenbee et al 2020 it is noted that the model is capable of predicting overflow events with small volumes unlike drainage where the model failed to predict small volume events 13 m3 3 3 3 overflow event duration and time to peak visual inspection of the overflow hydrographs showed good agreement between the predicted and actual event duration and time to peak for most overflow events with high nses a time shift at the beginning of events was observed where the predicted flow precedes the actual flow in multiple events this could be explained by the layout of the bioretention cell that causes a delay in overflow compared to the model that treats them as one cell or could be attributed to some discrepancies in monitoring data two representative events in fig 5 demonstrate the model capability of predicting overflow hydrographs with multiple peaks and more specifically a well predicted hydrograph with time shift right notably the hydrograph with better peak prediction left had higher nse which shows how the nse performance metric favors peak prediction 3 3 4 overflow peak the modeled overflow peak of each event during calibration and validation was compared to the observed peak as shown in fig 6 for the pre repair period the overflow peak had nses of 0 76 and 0 96 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the overflow peak had nses of 0 44 and 0 77 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset the model underestimated the peak of overflow events during the pre repair period in the 0 6 m cell and overestimated the overflow events peak for both cells during the post repair period this could be explained by the ponding depths used in calibration of the post repair models that were less than the actual design depth resulting in a higher estimated overflow likewise lisenbee et al 2020 observed an overestimated peak flow for all events unlike the drainage peak flow prediction the model could predict the variability of overflow peaks of different events without being constrained by any parameter that is no truncated flow rates were observed 4 conclusion this study aimed to test and evaluate drainmod urban s ability to model bioretention cell hydrology using a field monitored dataset of two cells both before and after they were maintained to alleviate clogging drainmod urban was utilized to simulate these four bioretention cell scenarios in nashville nc over two years representing a diversity of conditions including different media depths 0 6 m and 0 9 m surface storage volumes and site conditions e g clogging calibrated model parameters such as ponding depth seepage parameters and lateral saturated hydraulic conductivity differed from measured estimated model parameters by 50 100 and 150 respectively the drainmod urban sequential calibration process started with highly uncertain parameters followed by those with less uncertainty and proved to be an efficient calibration approach for cells pre and post repair the result of this study suggests that drainmod urban is capable of simulating bioretention hydrology across variable cell configurations despite the high temporal resolution of the model output drainmod urban accurately predicted drainage hydrographs and drainage volumes for events with volumes exceeding 13 m3 the nse for drainage hydrographs ranged between 0 14 and 0 60 calibration and 0 19 and 0 60 validation for all cells under normal operating conditions with maximum individual event nses from 0 66 to 0 92 among the scenarios which is exceptional performance for a fine temporal scale drainage volumes were predicted with high nses from 0 52 to 0 90 with an error from 9 7 to 15 7 despite the overall good performance of the model drainmod urban showed some deficiencies in predicting varying drainage peaks of events when a clogging layer is introduced however this had a minor impact on the overall model performance drainmod urban overflow prediction performance was calibrated and validated using monitoring data of four cells with 16 to 34 overflow events per cell the simulated overflow hydrographs showed good agreement with measured data with nse ranging from 0 49 to 0 89 calibration and 0 49 to 0 81 validation and maximum individual event nses from 0 69 to 0 98 among the scenarios the nse for overflow volumes ranged between 0 59 and 0 96 for pre and post repair the model was capable of predicting varying peaks of overflow events with nse 0 46 to 0 96 calibrating the model for hydrographs prediction improved both the drainage and overflow most importantly improved volume prediction this is a superior advantage of drainmod urban over existing models which eliminates the need for calibrating for certain objective in conclusion drainmod urban showed strong performance for modeling bioretention outflow hydrographs and volumes accurately matching measured data this supports the limited amount of testing performed previously on the model most notably the model s capability for simulating overflow hydrographs and volumes has not been well evaluated the results herein suggest the strong capability of the model for this purpose drainmod urban capability to simulate iws zone is one of the model s greatest strengths however the sites used in this study were conventionally drained therefore future bioretention modeling efforts need to test drainmod urban for bioretention designed with iws drainmod urban extensive sensitivity analysis would provide valuable insight about the impact of each input parameter whether estimated measured or calibrated on the hydrograph output and model performance drainmod urban application for bioretention at fine temporal scale represents an avenue for integrating it for watershed scale studies to evaluate the bioretention function at the system level where high accuracy of hydrograph simulation is needed to understand how local elements aggregate to the larger scale credit authorship contribution statement g diab conceptualization methodology investigation software formal analysis writing original draft j m hathaway conceptualization funding acquisition resources supervision writing review editing w a lisenbee methodology investigation validation writing review editing r a brown resources writing review editing w f hunt resources supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement funding for this research was provided by the national science foundation grant no 1553475 and institute for a secure and sustainable environment 
2805,urbanization causes fundamental shifts in hydrologic partitioning within watersheds leading to excess runoff being quickly routed to nearby conveyances this leads to a host of concerns from flooding to water quality impairments to combat these effects bioretention systems are implemented to restore more natural hydrology in the urban environment to better understand and predict the effectiveness of these interventions there is a need for reliable hydrology models to assess the performance of bioretention cells prior to installation drainmod urban was recently developed to produce hydrographs with a high temporal resolution showing substantial promise during initial testing unfortunately the dataset originally used for testing was limited having minimal occasions of overflow and only consisting of one bioretention location to achieve a more robust analysis of the model drainmod urban was evaluated using two years of monitoring data for four bioretention cells in north carolina the modeled bioretention cells had variable media depths surface storage volumes site conditions and propensity for overflow drainmod urban model parameters were calibrated for a nash sutcliff efficiency nse from 0 14 to 0 60 for drainage and from 0 49 to 0 89 for overflow across the sites using six months of monitoring data model validation confirmed these results producing drainage and overflow hydrographs with accurate timing duration and a range of nses from 0 19 to 0 60 and from 0 49 to 0 81 respectively across the four sites model performance varied across sites high drainage and overflow rates are well predicted compared to extended low rates caused by clogging issues or small storms this study highlights the potential of drainmod urban in modeling bioretention hydrology at a fine temporal scale under varying design configurations keywords bioretention drainmod green infrastructure hydrology modeling data availability data will be made available on request 1 introduction stormwater runoff from the urban environment is listed as one of the major sources of pollutants and hydrologic disruption by the u s environmental protection agency usepa 2017 to ameliorate these effects green infrastructure gi is increasingly being used in stormwater management plans to treat runoff and maintain and or restore the pre development hydrologic regime in urban settings prince george s county 1999 bioretention is a gi practice typically implemented in the urban environment which can be designed into median strips ramp loops traffic circles and parking lot islands ncdenr 2009 these systems consist of a depressed area of engineered soil mixture covered with vegetation and underlain with a gravel bed and underdrains rossman 2015 pioneering field assessments such as hunt et al 2008 and davis 2008 have been critical to understanding and quantifying bioretention performance bioretention reduces runoff volume and peak flows to mitigate flooding and uses biogeochemical processes to improve the quality of stormwater routed to water bodies by removing pollutants such as nitrogen pathogens and suspended solids debusk and wynn 2011 ncdenr 2009 however bioretention performance is sensitive to site conditions leading to a number of efforts to understand key variables affecting the function of these systems and to demonstrate differential performance based on local context fassman beck and saleh 2021 li et al 2018 debusk and wynn 2011 despite these efforts there are a large number of design variations and combinations of variables still untested representing a large amount of effort and expense if field approaches are utilized by providing an efficient and cost effective way to test design options models represent an avenue for the continued comparison and scenario testing indeed reliable hydrologic models are necessary for activities such as the planning and management of gi fassman beck and saleh 2021 determining the effective spatial distribution of gi at the urban watershed scale epps and hathaway 2019 and quantifying groundwater table dynamics zhang and chui 2020 such computational models simplify water flow in systems such as bioretention through concepts from mathematics and physics that facilitate simulation of complex processes liu et al 2014 recent studies have begun to simulate bioretention hydrology using more advanced process based numerical models for example alikhani et al 2020 used the green infrastructure flexible model gifmod to calibrate and validate a catchment scale model against field data over a six week period each with a nash sutcliffe of 0 68 to 0 86 for a log transformed hydrograph of two cells li et al 2021 calibrated a field scale model hydrus one dimensional 1d against experimental data for the purpose of design optimization and obtained an nse greater than 0 5 last a few studies modeled bioretention hydrology with some improvements to account for groundwater influence kim et al 2019 zhang and chui 2020 and pollutant removal taghizadeh et al 2021 a common shortcoming of current models is not accounting for unsaturated flow by assuming that no percolation occurs until the soil reaches the field capacity thus overpredicting the amount of runoff from the cell fassman beck and saleh 2021 another drawback is the use of single event models that neglect the influence of antecedent moisture condition of the soil on infiltration heasom et al 2006 lisenbee et al 2021 reviewed a number of models currently being used to represent bioretention showing that models such as hydrus and gifmod apply richards equation to determine infiltration which requires complex input parameters while other models use a simplified version of richards equation e g green ampt equations such as storm water management model swmm recarga and drainmod notably green ampt assumptions do not account for the variable soil moisture content of bioretention cells drainmod overcomes this limitation using the soil water characteristic curve further internal water storage iws and underdrains can be modeled using drainmod and model for urban stormwater improvement conceptualization music while models such as gifmod hydrus and recarga have limited capability of representing underdrains and lack the ability to model iws zone in upturned elbow configuration brown and hunt 2011a as such drainmod has been identified as a model of interest for representing a diversity of bioretention configurations drainmod is a process based model that was originally created to model drainage in agricultural land due to the similarity in water movement processes through agricultural land and bioretention brown et al 2013 adapted the model to bioretention hydrology drainmod is advantageous in terms of being a continuous long term model with the ability to account for variable soil moisture conditions including unsaturated and partially saturated conditions of bioretention soil layers using the soil water characteristic curve swcc swcc is used to determine the drained volume and upward flux that dominates the infiltration and evapotranspiration through bioretention media lisenbee et al 2020 this is an advancement over other models that use field capacity and saturated volumetric water content which introduce large errors when the water table is close to the surface such as iws configuration brown et al 2013 moreover drainmod can model the internal water storage iws zone in bioretention by adjusting the weir configuration in the model brown et al 2013 using drainmod s daily output including drainage overflow and exfiltration brown et al 2013 calibrated and validated the model for four bioretention cells in north carolina against two years of field data which resulted in nash sutcliffe efficiencies from 0 6 to 0 9 since this initial study more calibration and validation against field measurements for drainmod was conducted by winston 2015 for three bioretention cells in ohio resulting in nses from 0 94 to 0 98 for drainage volumes from 0 71 to 0 97 for overflow volumes and from 0 75 to 0 95 for exfiltration volumes finally li et al 2020 simulated the hydrology and nitrogen transport in bioretention cells in china for the purpose of design optimization the model showed good agreement with monitoring data with nses of 0 78 0 69 and 0 62 during calibration and 0 74 0 66 and 0 65 during validation for drainage nitrate and ammonia nitrogen loss respectively despite these promising results drainmod was evaluated in these studies on a storm to storm basis and only was capable of providing outputs at an hourly temporal scale for urban applications where transport processes are rapid this is often not a high enough resolution lisenbee et al 2020 improved the drainmod hydrology module by developing drainmod urban drainmod urban is capable of simulating drainage overflow and exfiltration with a finer temporal scale up to one minute thus transforming drainmod into a model capable of producing hydrographs that can depict the rapid change in flow in the urban environment this is not only valuable for accessing site scale processes but also understanding how these site scale processes aggregate to the larger watershed lisenbee et al 2020 tested drainmod urban drainage output against 12 events from 7 months of field data for a single bioretention cell in ohio the model demonstrated effective drainage prediction with an nse of 0 60 meanwhile prediction of overflow hydrographs was somewhat poorer with an nse of 0 1 it should be noted that only 4 overflow events occurred at this site over the monitoring period leading to the need for further testing and evaluation as discussed above models identified in literature commonly oversimplify or lack the ability to model underdrains and iws zone thus drainmod urban is a relatively comprehensive drainage model for bioretention practices however this model has only been tested at one location and in particular the ability of the model to simulate overflow hydrographs was not well verified in lisenbee et al 2020 overflow prediction is considered challenging in part due to the relative infrequency of overflow occurring from bioretention resulting in limited data for model testing lisenbee et al 2020 winston 2015 nonetheless accurate overflow prediction is imperative for the application of drainmod urban in the catchment scale verification of model performance over a range of locations and design configurations is also critical before drainmod urban can be considered a viable tool therefore the objectives of this study are 1 assess the ability of drainmod urban to simulate bioretention cell drainage over a diversity of sites and 2 verify that drainmod urban is capable of predicting overflow using a large monitoring dataset that includes more overflow events 2 materials and methods 2 1 site description the study area consists of five bioretention cells constructed in two groups in the impervious asphalt parking lot of a commercial store in nashville nc usa three cells 0 6 m media depth cells were connected in parallel via a pipe with each cell s underdrain routing into the pipe the other two cells 0 9 m media depth cells were connected to a different pipe in the same manner data were only collected at the end of each stormwater pipe thus each set of parallel cells was modeled as a single bioretention cell the detailed bioretention cell characteristics are originally presented by brown and hunt 2012 2011b the two conventionally drained bioretention systems have 0 6 m and 0 9 m depth fill media covered with shrubs perennials and trees without iws the texture of the fill media is classified as sandy loam to loamy sand according to the u s department of agriculture usda cells were originally designed according to north carolina department of environment and natural resources ncdenr 2009 specifications that require capturing the first 2 5 cm of a rainfall event within the surface ponding zone followed by draining that zone within 12 h two years of bioretention cell monitoring data from march 2008 to march 2010 were utilized in this study for calibration and validation of drainmod urban previously the data were parsed into two periods pre repair and post repair and modeled using the original drainmod code i e with daily output by brown et al 2013 these two periods correspond to substantial differences in function due to clogging and construction inaccuracies at the site with both periods being characterized by field monitoring specifically the initial monitoring period pre repair showed increased overflow frequency attributed to both clogging by fine granite during construction and an undersized ponding volume i e surface storage the available storage volume was 28 and 35 of the designed size for the 0 6 m and 0 9 m bioretention cells respectively the two cells were repaired by replacing the top layer of the bioretention media and increasing the storage of both cells by 89 and monitoring continued post repair notably the cells were still undersized relative to their intended design after maintenance resulting in frequent overflow despite this functional concern the sites were favorable for this study s purpose of testing the model capability for simulating overflow the characteristics of the bioretention cells pre and post repair can be observed in table 1 2 2 monitoring methods rainfall intensity and depth were measured on site using a tipping bucket rain gauge isco 674 and manual plastic rain gauge respectively inflow and outflow from the bioretention cells were recorded at 5 min intervals using an automated sampler isco 6712 coupled with a bubbler module isco 730 and sharp crested weirs the outlet pipes from each bioretention system covey combined drainage and overflow from the bioretention cell and are equipped with 90 v notch weirs hence further processing of outflow to separate drainage and overflow was conducted following the approach applied by brown and hunt 2011b the overflow appears as a rapid increase in outflow hydrograph over a short time whereas drainage is a steady flow that increases gradually to separate the overflow and drainage the drainage flow rate before and after the overflow spike is used to interpolate the flow during the overflow period the overflow is obtained by subtracting the drainage from the outflow at the inlet the runoff from the drainage area was not accurately characterized due to the use of a 0 75 m wide rectangular weir resulting in shallow driving head which is challenging to reliably measure therefore inflow to the bioretention cell was estimated using u s epa storm water management model 5 1 swmm using a similar approach to lisenbee et al 2020 the saturated hydraulic conductivity an essential input parameter in the green ampt model was measured using a constant head permeability test as in klute 1986 verification was performed after events larger than 2 5 cm i e those that inundated the system to make sure that the infiltration rate estimated by measuring surface ponding depletion is representative of the constant rate at saturated conditions brown et al 2013 eliminating the effect of the initial moisture condition of the soil green and ampt 1911 the 0 6 m media depth bioretention cell had a hydraulic conductivity of 5 5 cm hr and 4 9 cm hr for the pre and post repair period respectively while the 0 9 m media depth bioretention cell has a 3 5 cm hr and 2 9 cm hr for the pre and post repair period respectively brown et al 2013 volumetric water content in the bioretention cells was measured at four different depths in the 0 6 m and 0 9 m media depths bioretention cells using smart sensors s smc m005 and a hobo microstation for data collection and storage brown et al 2013 2 3 model description as noted above drainmod is a process based continuous simulation model that was originally used to model drainage systems in agricultural fields nitrogen transport salinity and wetland hydrology modeling bioretention hydrology is one of the new applications of drainmod the processes of drainmod listed below are identical to drainmod urban except for the time step at which the processes are simulated the model solves two water balance equations soil surface water balance 1 and soil profile water balance 2 brown et al 2013 1 p f δ s r o 2 δ v a d e t d s f where p is the rainfall f is the infiltration δs is the change in the storage on the surface and ro is the runoff when precipitation rate exceeds infiltration capacity water starts ponding on the surface of the bioretention cell when the storage is full excess water turns into runoff skaggs 1980 for the soil profile water balance δ v a is the change air filled pore volume d is the drainage et is evapotranspiration ds is deep seepage and f is infiltration the drainage rate is computed using the kirkham equation kirkham 1957 when the soil profile is completely saturated the hooghoudt equation is used to compute drainage through the soil when the water table recedes skaggs et al 2012 darcy s law and dupuit forchheimer assumptions are used to compute seepage to compute infiltration using the green ampt equation parameters are obtained from the swcc to account for the change in saturated hydraulic conductivity through the soil profile this is used to calculate an effective ksat at each time step potential evapotranspiration pet is computed using the thornthwaite method thornthwaite 1948 or via user input the actual et is determined based on the soil moisture content if the moisture content of the soil is below the wilting point then the actual et is limited by upward flux depending on the water table depth when the moisture content of soil at the root zone is above the wilting point et is equivalent to pet lisenbee et al 2020 2 4 model input to model bioretention drainmod requires input data including weather data soil characteristics drainage design and vegetation properties these initial model inputs are similar to model input developed by brown et al 2013 for the original drainmod however the use of drainmod urban allows the use of higher resolution runoff and rainfall inputs as discussed above inflows to the bioretention model from the drainage area were computed using swmm at a one minute time interval briefly the parking lot is modeled as a sub catchment which swmm treats as a non linear reservoir with a capacity equivalent to the maximum depression storage precipitation is entered as a model input and infiltration is accounted for using the green ampt model green and ampt 1911 a water balance equation is solved numerically to compute the depth of water over the sub catchment surface if it exceeds the maximum depression storage runoff is generated and routed using manning s equation rossman 2015 notably inflows can be generated using other models or via field observation as available for a given application this inflow is converted to depth within the cell using the drainage area to bioretention area ratio weather files include measured precipitation in 2 min intervals and the daily maximum and minimum air temperature the air temperature was obtained from the state climate office of nc monitoring station nrkm rocky mount located 12 km from the site brown et al 2013 thornthwaite method is applied to compute pet with correction factors originally developed by amatya et al 1995 for a location within 35 km from the study area a constant root depth over the year of 30 and 45 cm is assigned for the 0 6 m and 0 9 m media depth bioretention cells respectively following brown et al 2013 the swcc for each soil layer and the saturated hydraulic conductivity are processed by the drainmod soil utility program to derive the water table volume drained upward flux relationship and infiltration parameters the estimated saturated hydraulic conductivity of the bioretention layer of each cell was initially used and calibrated thereafter the sand and gravel layer estimated saturated hydraulic conductivity is 15 cm h and 200 cm h similar to values used by brown et al 2013 lisenbee et al 2020 following previously measured data in the literature rawls et al 1998 the drainage design is derived from the site characteristics including bioretention cell depth ponding depth drain depth drain size and drain spacing seepage parameters are assigned according to nash county north carolina soil survey recommendations the model accounted for vertical seepage only and no lateral seepage was considered the drainage coefficient is typically used to account for the maximum possible flow according to the geometric configuration of the drain pipe however in the case of bioretention media the drainage of water is limited by the flow of water through soil layers rather than the hydraulic characteristic of the drain pipe thus a large value is assigned to the drainage coefficient to avoid limiting the flow lisenbee et al 2020 2 5 model calibration the nash sutcliffe efficiency coefficient nse and percent bias pbias were used to evaluate the goodness of fit of model output to measured data according to moriasi et al 2007 the nse and pbias are recommended in evaluating the performance of hydrologic models the nse compares the residual variance to the measured data variance eq 3 and ranges from to 1 optimal nse 1 the nse is used to evaluate the overall fit of hydrographs a negative nse indicates that the mean of the measured data provides better estimation than the model pbias indicates the tendency of the model to overestimate pbias 0 or underestimate pbias 0 the measured data with optimal pbias 0 eq 4 as stated by moriasi et al 2007 thus pbias is typically used to evaluate streamflow volume errors and water balances the goodness of fit is evaluated based on the timestep used in the model previous literature indicated acceptable good and excellent model for nse above 0 40 0 60 and 0 75 respectively for daily time step and pbias below 25 skaggs et al 2012 3 nse 1 i 1 n q i sim q i obs 2 i 1 n q i obs q obs 2 4 pbias i 1 n q i obs q i sim 100 i 1 n q i obs where q i sim is the simulated flow q i obs is the observed flow for a given timestep q obs is the average observed flow and n is the number of all the timesteps skaggs et al 2012 provide a qualitative classification of model parameters that can be adjusted during calibration and model parameters that should rarely or never be adjusted during calibration i e above or below the expected range of each parameter in our study the final calibration parameters were selected according to the guidelines by skaggs et al 2012 six model parameters were adjusted during the calibration procedure to achieve the optimum nse and pbias of the overflow and drainage hydrographs the calibration parameters are classified into design parameters seepage parameters and soil parameters the calibrated design parameters were the drainage coefficient and ponding depth calibrated seepage parameters were the thickness of the restrictive layer the piezometric head of the aquifer and the vertical conductivity of the restrictive layer the calibrated soil parameter was the lateral saturated hydraulic conductivity of each soil layer model calibration for other bioretention by lisenbee et al 2020 used the same parameters except for the vertical conductivity of the restrictive layer which was measured for that site thus these parameters are expected to be commonly used in calibrating drainmod urban in future applications the first six months of the monitoring data from each cell were used for model calibration while the second six months were used for model validation drainmod urban was used to compute drainage and overflow from the bioretention at a one minute time interval then the output was aggregated at a five minute interval to match the measured data time interval drainmod urban model calibration followed a similar approach to that used by lisenbee et al 2020 model inputs were set to measured or estimated values then input parameters were adjusted one at a time starting with drainage parameters followed by overflow parameters once the model achieved the maximum cumulative nse and the best hydrograph fit another parameter is calibrated and so on further calibration was performed to minimize the pbias while maintaining the maximum nse visual inspection of hydrographs during this process ensured realistic hydrograph shapes the final calibrated model was selected based on the best nse with the least pbias possible for drainage and overflow drainmod urban was evaluated with respect to the calibrated model s ability to predict 1 the complete time series by considering a single nse and pbias for the calibration and validation period 2 individual event hydrographs peak flow and total volume of both drainage and overflow 3 results and discussion 3 1 model calibration comparing the calibrated model parameters to measured or estimated parameters table 2 at five bioretention cells nashville cells and ursuline college cell showed that the calibrated ponding depths were equivalent to actual ponding depths pre repair and from 35 to 50 less than the measured depths post repair the calibrated piezometric head of the aquifer was 10 higher than estimated value for the 0 9 m pre repair cell and equivalent to estimated values for all other cells the thickness of the restricting layer was set to estimated values for all cells except for 0 6 m pre repair that was 5 less than estimated value the difference between calibrated and estimated vertical conductivity of the restricting layer was between 42 to 100 the difference between the calibrated and the upper limit of measured lateral saturated hydraulic conductivities of the mulch layer lied between 39 and 134 while for the bioretention layer the difference was between 86 and 43 from the upper and lower limit of measured values the calibration sequence used in this study started with the most uncertain parameters such as the lateral saturated hydraulic conductivity and ponding depth followed by less uncertain parameters such as piezometric head of the aquifer thickness and vertical conductivity of the restricting layer 3 1 1 drainage coefficient the drainage coefficient accounts for the hydraulic capacity of the drain pipes it is recommended to use a high drainage coefficient in drainmod in the simulation of bioretention cells since it is predicted that drainage is restricted by the soil parameters rather than the hydraulic capacity of the drain pipes brown et al 2013 drainmod urban uses the daily drainage coefficient to compute the maximum drainage per timestep one minute in this study when the computed drainage exceeds the drainage coefficient the model limits the maximum drainage to the value of the drainage coefficient this affects the drainage hydrograph by introducing constant drainage over time plateau effect instead of a flashy peak as observed in nature thus a high drainage coefficient was used during the calibration of the two bioretention cells pre and post repair to avoid the peak flow plateau effect that was discussed in lisenbee et al 2020 post calibration the drainage coefficient was gradually reduced to the least possible value that does not limit the peak flow table 2 for the pre repair period the drainage coefficient was assigned values equivalent to the maximum observed drainage of 85 cm day and 60 cm day for the 0 6 m and 0 9 m media depth bioretention cells respectively for the post repair period a higher drainage coefficient than the observed daily maximum was assigned of 170 cm day and 75 cm day for the 0 6 m and 0 9 m media depth bioretention cells respectively the high drainage coefficients do not reflect the maximum daily drainage predicted by the model this is attributed to the approach the model uses to compute the peak flow based on the drainage coefficient the model divides the drainage coefficient by the time step to get the peak flow for this time interval which results in small peaks however the maximum daily drainage predicted by the model is less than the drainage coefficient hence it is recommended to compute the drainage coefficient using the same time step used by the model 3 1 2 ponding depth the ponding depth referred to as maximum surface storage in drainmod is considered a design parameter of the bioretention cell that is often adjusted in the calibration process skaggs et al 2012 ponding depth is crucial in partitioning the flow into drainage and overflow for the bioretention cells in the pre repair condition the ponding depth was assigned similar values to the measured depth however for the post repair condition the ponding depth used in calibration is lower than the actual measured ponding depth by 35 to 50 3 1 3 lateral saturated hydraulic conductivity during the post repair period four soil layers were used in the model mulch bioretention media sand and gravel during the pre repair period an additional soil layer was used in the model to account for the clogging that occurred during the construction of the cells the clogging layer is added on top of the bioretention media it was observed that drainage output is not sensitive to the lateral saturated hydraulic conductivity of the sand and gravel layers hence constant values of 15 cm hr and 200 cm hr were assigned in the two bioretention cells both pre and post repair conditions for these layers respectively drainmod urban uses the effective lateral saturated hydraulic conductivity in drainage calculations thus the layer with the lowest hydraulic conductivity governs the drainage output for the pre repair period the calibrated saturated hydraulic conductivities of the mulch layer are higher than the measured values in both cells conversely the calibrated saturated hydraulic conductivities of the bioretention layer had to be reduced below the measured values which is possibly attributed to the clogging issues 3 2 model performance drainage 3 2 1 hydrograph prediction the calibrated drainmod urban model showed good performance in the prediction of drainage hydrographs compared to observed drainage for all cells except for the 0 9 m media depth during the pre repair period see table 3 during the calibration period the nse was 0 44 and 0 60 and pbias was 2 6 and 23 8 for the 0 6 m and 0 9 m media depth cells post repair respectively however for the pre repair period the nse was 0 51 and 0 14 and the pbias was 25 1 and 35 2 for the 0 6 m and 0 9 m media depth cells respectively model validation results were consistent to those of the calibration period as the nse was 0 60 and 0 54 post repair 0 19 and 0 52 pre repair while the pbias was 12 7 and 25 4 post repair and 5 5 and 18 pre repair for the 0 6 m and 0 9 m media depth cells respectively thus the model performed better in drainage prediction during the post repair period compared to the pre repair period this can be attributed to the complicated site condition stemming from the clogging that occurred during the pre repair period which caused low drainage volumes and extended drainage time the model performance for the 0 6 m cell was comparable to the post repair cells despite having slightly lower nse notably the 0 6 m pre repair cells prediction was superior to the 0 9 m pre repair cell the degradation in the performance metrics for the drainage of the 0 9 m cell could be attributed to different clogging pattern that resulted in excessively longer drainage hydrographs with continuous drainage between rainfall events coupled with model tendency to underpredict the falling limbs of hydrograph duration it can be concluded that model calibration to predict drainage in well designed and functioning bioretention cells is straightforward however it gets more challenging but attainable in case of low flows and long drainage period due to clogging when drainage continues to occur between rainfall events individual event nse during the post repair period ranged between 2 27 and 0 92 for the 0 6 m media depth cell with a median event nse of 0 50 individual event nse ranged between 12 04 and 0 86 for the 0 9 m media depth cell with a median event nse of 0 29 lisenbee et al 2020 observed a similar range from 1 75 to 0 80 for individual event nses with median event nse of 0 4 notably the model performed better in the 0 6 m media depth cell compared to the 0 9 m media depth cell for individual events despite the comparable performance of the model in overall drainage prediction 3 2 2 drainage volume the simulated drainage volume of each event was evaluated against the measured drainage volume drainmod urban showed good performance in the prediction of event volume under the hydrograph based calibration process bottom up approach per lisenbee et al 2020 that is adjusting model parameters at a small temporal scale to produce hydrographs that accurately predict peak flow the response time start peak and end of flow and duration of events for the pre repair period cumulative event volume nse was 0 77 and 0 52 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the cumulative event volume nse was 0 90 for both cells fig 1 shows the predicted versus measured drainage volume of all cells during calibration and validation along with their corresponding nse the calibrated models can be seen to systematically underpredict the volume of drainage with pbias of all cells ranging between 15 7 and 9 7 comparatively higher than the ursuline college model by lisenbee et al 2020 that was 6 again the model performed better during the post repair period compared to the pre repair period but overall performance was strong for both also the model was more adept at predicting event volumes than hydrographs which would be expected based on the larger time step associated with this prediction moriasi et al 2007 hence a well calibrated model for drainage hydrographs bottom up approach is capable of good drainage volume prediction this align with lisenbee et al 2022 findings in particular the ability of calibrated drainmod urban to predict hydrographs accurately without compromising volume prediction is an advantages over the commonly used swmm lid bioretention module where user had to trade off volume prediction for hydrographs lisenbee et al 2022 it was observed that 80 of the drainage events with volumes less than 13 m3 precipitation less than 1 cm either had negative nses or did not produce drainage in drainmod urban lisenbee et al 2020 reported low nses for drainage volumes less than 15 m3 to demonstrate the model performance for drainage events with similar volume three events 0 9 m post repair cell with drainage ranging from 55 4 to 56 8 m3 were compared drainmod urban overestimated one event volume by 8 5 nse 0 55 and underestimated the volume of two events by 25 6 and 27 8 nses 0 84 and 0 64 the model predicted higher peak flow for these two events by 0 8 and 13 6 predicted events start time and peak flow time were comparable to those of measured events however the duration of all events was underestimated the difference in nses of those two event hydrographs despite having similar drainage volume indicates that the difference in predicted drainage volume had less impact on the nse compared to the impact of peak flow and event duration on the nse this is consistent with findings by lisenbee et al 2020 3 2 3 drainage event duration and time to peak event duration and time to peak flow are crucial in defining the shape of the hydrograph the model s ability to predict the duration of events and time to peak was assessed graphically as recommended by lisenbee et al 2020 and moriasi et al 2007 the hydrographs of all events during the post repair period of the two bioretention cells showed the model s capability to predict the time of peak flow and the duration of each event with strong accuracy this is consistent with lisenbee et al 2022 findings that calibrated drainmod urban depicts the shape of drainage hydrographs timing and duration properly without introducing plateau effect constant peak over time compared to swmm lid module which produced truncated hydrographs pre repair hydrographs were more complex to predict due to the clogging that resulted in low and irregular flow the modeled hydrographs commonly had time and peak mismatch but events of nse greater than 0 3 had better timing and underpredicted peaks fig 2 presents a sample of events with different nse that indicate the model s ability to accurately predict time to peak and duration of event with a slight shift in end time it is noted that the model predicts the rising portion of the hydrograph better than the falling portion the predicted drainage flow decreases rapidly past the peak flow leading to a small time mismatch with the measured flow as previously stated this explains the poor model performance for the 0 9 m pre repair cell where clogging resulted in excessively slow drainage and elongated the falling limb of hydrographs on the contrary this is not applicable for the 0 6 m pre repair cell where introducing a clogging layer to the model had minor impact on model performance 3 2 4 drainage peak prediction of the drainage peak is significant in the overall performance of the model and is an important characteristic for understanding watershed scale gi performance fig 3 shows the simulated peak flow versus the measured peak flow of all cells for each event at a 5 minute timestep during calibration and validation with their corresponding nses once again performance for peak flow prediction was better for the post repair period compared to the pre repair period the model predicted peak flow with a cumulative nse of 0 24 and 0 38 for the post repair 0 6 m and 0 9 m media depth cells respectively for the whole dataset however the model produced negative cumulative nses for pre repair 0 6 m and 0 9 m media depth cells the model underestimates the peak flow in the post repair period meanwhile the peak flow predicted by the model during the pre repair period had a constant value for all events the constant drainage peak prediction indicates that the clogging layer added to the model with very low lateral saturated hydraulic conductivity limited the peak flow prediction to smaller range particularly a low lateral saturated hydraulic conductivity limits the effective conductivity of all layers which in turn limits peak prediction the nse goodness of fit metric is sensitive to peak prediction therefore even with good timing and overall good volume prediction the hydrograph prediction tends to have poor nse hence the model works best for normal sites with consistent performance and no clogging issues otherwise the user needs to validate the model output ensure good performance 3 3 model performance overflow 3 3 1 hydrograph prediction the performance of drainmod urban in the prediction of overflow hydrographs was not thoroughly assessed in previous literature due to the lack of a significant number of overflow events occurring in the bioretention cells used by lisenbee et al 2020 the clogging and undersized construction that occurred pre repair for the nashville sites resulted in abundant overflow events that were used to calibrate the drainmod urban model and assess its performance the pre repair bioretention cells experienced around 34 overflow events over one year while the post repair period experienced around 15 overflow events the simulated overflow was compared to the observed overflow for the calibration period the nses were 0 56 and 0 89 pre repair and were 0 49 and 0 71 post repair for the 0 6 m and 0 9 m media depth cells respectively table 4 for the validation period the nses were 0 49 and 0 81 pre repair and were 0 64 and 0 63 post repair for the 0 6 m and 0 9 m media depth cells respectively the model performed better in the 0 9 m media depth cell compared to the 0 6 m media depth cell and better than ursuline college cell with an nse of 0 10 observed by lisenbee et al 2020 this is attributed to the bigger number of overflow events available pre repair compared to post repair which allowed for better calibration the simulated overflow pbias showed that the model underestimated the overflow by 8 5 and 6 in the 0 9 m cells pre and post repair respectively higher pbias of 38 8 and 19 were observed for the 0 6 m cells pre and post repair individual event nses ranged from 0 74 to 0 69 median event nse 0 28 and 3 72 to 0 98 median event nse 0 47 and for the 0 6 m and 0 9 m cell pre repair respectively post repair the individual event nses ranged from 0 62 to 0 85 median event nse 0 57 and 8 21 to 0 84 median event nse 0 12 for the 0 9 m and 0 6 m cells respectively for the whole dataset this is consistent with individual event nses range of 1 59 to 0 74 for ursuline college reported by lisenbee et al 2020 despite the higher reported cumulative nse for nashville cells as noted above these values were also generated over a substantially higher number of events than those utilized in lisenbee et al 2020 model calibration improved both the drainage and overflow prediction substantially overflow prediction was sensitive to fewer calibration parameters mostly ponding depth compared to drainage drainage was influenced by the water table level in the model a function of infiltration rate seepage rate and soil water characteristic curve on the scale suggested by skaggs et al 2012 for goodness of fit for daily timesteps it is possible to have excellent overflow prediction nse 0 75 corresponding to poor nse 0 40 or good nse 0 60 drainage prediction for instance the 0 9 m media depth cell model showed poor drainage performance during the pre repair period however the results showed the best overflow prediction performance of the model 3 3 2 overflow volume the modeled overflow volume of each event was compared to the measured overflow volume during calibration and validation shown in fig 4 for the pre repair period cumulative event volume nse was 0 78 and 0 96 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the cumulative event volume nse was 0 59 and 0 83 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset the model predicted the volume of overflow better in pre repair conditions compared to post repair contrary to drainage volume prediction regardless performance was satisfactory under both conditions drainmod urban tends to underestimate the overflow volume by 43 4 1 4 pre repair and 18 3 10 4 post repair for the 0 6 and 0 9 m cells respectively hence the model performed better in the 0 9 m media depth cell models compared to 0 6 m media depth cell models this performance is comparable to ursuline college where overflow volume was overestimated by 9 8 lisenbee et al 2020 it is noted that the model is capable of predicting overflow events with small volumes unlike drainage where the model failed to predict small volume events 13 m3 3 3 3 overflow event duration and time to peak visual inspection of the overflow hydrographs showed good agreement between the predicted and actual event duration and time to peak for most overflow events with high nses a time shift at the beginning of events was observed where the predicted flow precedes the actual flow in multiple events this could be explained by the layout of the bioretention cell that causes a delay in overflow compared to the model that treats them as one cell or could be attributed to some discrepancies in monitoring data two representative events in fig 5 demonstrate the model capability of predicting overflow hydrographs with multiple peaks and more specifically a well predicted hydrograph with time shift right notably the hydrograph with better peak prediction left had higher nse which shows how the nse performance metric favors peak prediction 3 3 4 overflow peak the modeled overflow peak of each event during calibration and validation was compared to the observed peak as shown in fig 6 for the pre repair period the overflow peak had nses of 0 76 and 0 96 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset for the post repair period the overflow peak had nses of 0 44 and 0 77 for the 0 6 m and 0 9 m media depth cells respectively for the whole dataset the model underestimated the peak of overflow events during the pre repair period in the 0 6 m cell and overestimated the overflow events peak for both cells during the post repair period this could be explained by the ponding depths used in calibration of the post repair models that were less than the actual design depth resulting in a higher estimated overflow likewise lisenbee et al 2020 observed an overestimated peak flow for all events unlike the drainage peak flow prediction the model could predict the variability of overflow peaks of different events without being constrained by any parameter that is no truncated flow rates were observed 4 conclusion this study aimed to test and evaluate drainmod urban s ability to model bioretention cell hydrology using a field monitored dataset of two cells both before and after they were maintained to alleviate clogging drainmod urban was utilized to simulate these four bioretention cell scenarios in nashville nc over two years representing a diversity of conditions including different media depths 0 6 m and 0 9 m surface storage volumes and site conditions e g clogging calibrated model parameters such as ponding depth seepage parameters and lateral saturated hydraulic conductivity differed from measured estimated model parameters by 50 100 and 150 respectively the drainmod urban sequential calibration process started with highly uncertain parameters followed by those with less uncertainty and proved to be an efficient calibration approach for cells pre and post repair the result of this study suggests that drainmod urban is capable of simulating bioretention hydrology across variable cell configurations despite the high temporal resolution of the model output drainmod urban accurately predicted drainage hydrographs and drainage volumes for events with volumes exceeding 13 m3 the nse for drainage hydrographs ranged between 0 14 and 0 60 calibration and 0 19 and 0 60 validation for all cells under normal operating conditions with maximum individual event nses from 0 66 to 0 92 among the scenarios which is exceptional performance for a fine temporal scale drainage volumes were predicted with high nses from 0 52 to 0 90 with an error from 9 7 to 15 7 despite the overall good performance of the model drainmod urban showed some deficiencies in predicting varying drainage peaks of events when a clogging layer is introduced however this had a minor impact on the overall model performance drainmod urban overflow prediction performance was calibrated and validated using monitoring data of four cells with 16 to 34 overflow events per cell the simulated overflow hydrographs showed good agreement with measured data with nse ranging from 0 49 to 0 89 calibration and 0 49 to 0 81 validation and maximum individual event nses from 0 69 to 0 98 among the scenarios the nse for overflow volumes ranged between 0 59 and 0 96 for pre and post repair the model was capable of predicting varying peaks of overflow events with nse 0 46 to 0 96 calibrating the model for hydrographs prediction improved both the drainage and overflow most importantly improved volume prediction this is a superior advantage of drainmod urban over existing models which eliminates the need for calibrating for certain objective in conclusion drainmod urban showed strong performance for modeling bioretention outflow hydrographs and volumes accurately matching measured data this supports the limited amount of testing performed previously on the model most notably the model s capability for simulating overflow hydrographs and volumes has not been well evaluated the results herein suggest the strong capability of the model for this purpose drainmod urban capability to simulate iws zone is one of the model s greatest strengths however the sites used in this study were conventionally drained therefore future bioretention modeling efforts need to test drainmod urban for bioretention designed with iws drainmod urban extensive sensitivity analysis would provide valuable insight about the impact of each input parameter whether estimated measured or calibrated on the hydrograph output and model performance drainmod urban application for bioretention at fine temporal scale represents an avenue for integrating it for watershed scale studies to evaluate the bioretention function at the system level where high accuracy of hydrograph simulation is needed to understand how local elements aggregate to the larger scale credit authorship contribution statement g diab conceptualization methodology investigation software formal analysis writing original draft j m hathaway conceptualization funding acquisition resources supervision writing review editing w a lisenbee methodology investigation validation writing review editing r a brown resources writing review editing w f hunt resources supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement funding for this research was provided by the national science foundation grant no 1553475 and institute for a secure and sustainable environment 
2806,frost heave models are important tools to study engineering damage in cold regions however multi physical field coupling and different methods of coupling components bring difficulties to compare the models and to optimize their error sources therefore classifying and deconstructing of different frost heave models and further evaluating them are significant for model development we reviewed frost heave models for the past 50 years and built frost heave model families to show the classification and inheritance relationships then the models were deconstructed by the thermal hydraulic framework thf and frost heave quantification method fhqm finally based on simulated and experimental data in cited papers the model errors caused by different thfs and fhqms were analyzed the results show a present frost heave models can be classified as porosity increase based p and ice lens increase based i models and they are tending to merge with each other b thfs of p models regarding freezing soil as porous medium are the main reason for water migration error in the region of multi ice layers which also results high uncertainty of hydraulic parameters under different simulation conditions c the most used two fhqms of p models cause error exceeding 20 because inaccurate relationship between pore strain and frost heave displacement d the errors of thfs and fhqms offset each other which will hidden the error sources of the models this paper can provide a reference for the improvement of frost heave models used in engineering keywords frost heave model classification deconstruction method evaluation error analysis data availability data will be made available on request 1 introduction frost heave refers to the ground uplift caused by the formation of discrete ice layers in freezing soil that are called ice lenses this phenomenon in cold regions is responsible for the damage of roads and infrastructure like underground pipelines tunnels channels and buildings the cold region is extensively distributed on the earth and its areas account for 50 of the land area therefore avoiding frost heave damage is a common problem around the world frost heave models as tools for simulating physical processes are important to study how to avoid the damage researchers have noticed and studied the problem of frost heave more than a century ago taber 1916 1929 1930 however until the 1970s when computers rapidly developed frost heave models were born hydrodynamic models harlan 1973 taylor and luthin 1978 rigid ice models gilpin 1980 hopke 1980 miller 1977 1978 o neill 1983 o neill and miller 1985 and segregation potential models konrad 1982 konrad and morgenstern 1980 1981 1984 were all born during that time these models were developed rapidly and applied in the 1990s excellent reviews of these frost heave models can refer to the work of henry 2000 rempel 2010 and peppin and style 2013 entering the 21st century the model development show two characteristics more in depth research on specific issues and more extensive application for example tubini et al 2021 presented a new model based on the heat transfer equation which allows the user to choose both the space and time discretization without any restriction due to stability and convergence issues this model was combined with richardson richards equation and developed as an open source code for wider application tubini and rigon 2021 these researches provide theoretical basis for the further development of the model another example is the appearance of commercial finite element software like abaqus ansys and comsol multiphysics accelerate the coupling and application of these models on cold region engineering like embankment dam zhang et al 2021 buried pipelines nishimura et al 2009 wang et al 2019 subgrades niu et al 2014 sheng et al 2014 tai et al 2018 teng et al 2020 tian et al 2019 wen et al 2011 yu et al 2016 tunnels and retaining walls liu et al 2019 zhang 2014 and channels li et al 2019 liu et al 2020 the first example is a rigorous research process because it only focuses on specific problems in the coupling model however the second example face two problems because these frost heave models are constructed with methods that sourced from different researches the first problem is that the inheritance and development relationship between different models is unclear the models inherited methods from past different models which results the difficulty in the models classification what is more important evaluating the differences among these models becomes impossible which will impede the inheritance of model advantages and the elimination of model defects the second problem is that validation of frost heave models is insufficient and the model error sources are lacking analysis guymon et al 1993 frost heave models generally have temperature water content and deformation as three state variables the three simulation errors of the three variables interact with each other based on their coupling relationships which has not been carefully analyzed to solve these two problems we need to determine the commonalities and differences of different models and how these cause model errors through the variable relationship of the models we first searched all papers about frost heave models in web of science with theme key words frost heave model from 1970 to 2020 fig 1 then a frost heave model family was constructed which reflects the inheritance and development relationship between different models according to the modeling methods coupling components of these models were deconstructed and classified as the object of evaluation and error analysis finally combining the modeling methods and the features of simulation errors sources of simulation error were analyzed which will answer the question this paper proposed 2 frost heave model classification and deconstruction 2 1 classification two main frost heave model families porosity based and ice lens based fig 2 model families produce their own members with distinctive characteristics the two characteristics have existed since frost heave models appeared and still influence latter models porosity based frost heave models were initially affected by an idea that frost heave occurs when ice content exceeds a critical porosity of freezing soil dirksen and miller 1966 taylor and luthin 1978 because this idea is easy to combine with harlan s model harlan 1973 and taylor and luthin 1978 have successfully modeled it porosity based models are popular in application porosity rate models poromechanical models soil mechanical models and crystallization kinetic models to some extent were influenced by this idea ice lenses are regarded as the main reason for frost heave taber 1930 therefore some models computed frost heave by computing ice lenses growth miller s theory o neill and miller 1985 referred to as secondary frost heave theory frozen fringe theory was the first to yield quantitative predictions of ice lens spacing peppin and style 2013 the biggest difference of this kind of model and the porosity based model is that they model the frozen fringe frozen fringe beneath the last ice lens is the key region for water migration and phase change rigid ice models and their simplified version segregation potential model and separate ice model all regard frozen fringe as an important part what is interesting some latter models inherited the two model families characteristics they derived the separation porosity with ice segregation criterion which can judge when and where ice lens occurs by porosity the authors name them porosity ice lens pi models 2 2 deconstruction commonality differences frost heave is a macro phenomenon due to water heat transfer and phase change during soil freezing therefore the biggest commonality of these frost heave models is that both of them contain two basic components thermal hydraulic frameworks thfs and frost heave quantification methods fhqms thfs simulate the mass and heat transfer of frozen soil and fhqms quantify the displacement frost heave caused by mass transfer and phased change the essential difference between frost heave models is that they used different thfs and fhqms therefore we deconstructed the models by their thfs and fhqms that are used as objects for further comparison and error analysis 2 2 1 thermal hydraulic framework the thermal hydraulic framework thf is two physical field equations thermal and hydraulic field equations coupled together although some papers used different forms of equations the thfs can be classified by their physical mechanism as shown in table 1 and table 2 for citing these heat balance equations conveniently when analyzing their simulation errors they are coded with id t1 is the simplest pde form heat balance equation that only considers the latent heat of freezing in situ on the basis of t1 other heat balance equations consider heat sources like the latent heat of rigid pore ice moving into ice lenses vi ρilfvi θi x convection heat j and more complex heat sources like heat flow caused by hydraulic gradient p dp pw and soil deformation ε 1 n t β εv t t2 is linearity form heat balance equation t2 vi was first proposed by gilpin 1980 sheng et al 1995 improved the t2 vi and considered ice content in frozen fringe t2 vii t12 combines t1 pde form heat balance equation at frozen and unfrozen regions and t2 linear temperature profile at the frozen fringe region the difference of t field equations is mainly reflected in their heat source terms richards equation and its variant forms h1 are the most widely used mass balance equation which only consider mass transfer of water more complicated mass balance equations consider ice velocity vi ρ v i x soil particle displacement ε εv t and crystallization of ice and solute c m α τ t in the first two terms of h1 τ is coefficient of capillary conversion that contains air or ice phase and colloidal or noncolloidal soils darcy s equation combined with clapeyron equation is also a commonly used mass transfer equation h2 which is based on the frozen fringe theory gilpin 1980 first developed and coupled h2 vi with t2 vi as a linear rigid ice model that simplified the miller s pde rigid ice model however he assumed all segregation freezing occur at warmest ice lens and did not consider the ice within frozen fringe to be mobile it constitutes the greatest physical departure from miller s perspective o neill and miller 1985 sheng et al 1995 developed h2 vii that considers pore ice freezing and moving in the fringe that is based on miller s physical hypothesis hydraulic field equations like h1 h1 ε and h1 εc regard frozen soil as porous medium which has the same structure as unfrozen soil another kind equations basing on the frozen fringe theory like h1 vi h1 τ h2 vi and h2 vii regard freezing soil as structure of ice soil interlayer which is consistent with observation 2 2 2 thermal hydraulic framework coupling the control equations of thfs usually are constructed with thermal field equations table 1 and hydraulic field equations table 2 variables in thfs can be classified as two types state variable and functions as state variable the sate variables of these two equations are temperature t unfrozen water content θu and soil water potential φui which can finally be transformed into two independent variables through the state variable triangle as fig 3 shown the difference of thfs caused by the state variable triangle is decided by the accuracy of swc and sfc lu et al 2019 wan et al 2022 another type of variables like heat capacity cv thermal conductivity λ ice content θi water velocity vw ice velocity vi all can be expressed as functions of state variables which result the coupling relationship between the thermal field and hydraulic field significantly these coupling relationships are open and diverse and constitute the main difference between thfs because of their different computing methods and source terms that are optional for example some researches use geometric average method computed heat conductivity λ while other researches use constant λu and λf as unfrozen and frozen soil heat conductivity some thermal filed equations considered convection heat term caused by water flow while the others did not considered it some hydraulic field equations include not only the description of water migration but also the migration of ice these open choices result a big difference of these thfs and an unstable model convergence the method of tubini and rigon 2021 is effective for convergence problems but before this the influence of these open choices on thfs should be analyzed thus a reasonable choice can be made 2 2 3 frost heave quantification method fhqm fhqms of porosity based models the fhqms of porosity based models p models regard frozen soil as a continuous porous medium porosity of p models plays a significant role in fhqms 1 p1 h f 0 h θ u θ i n 0 d x 2 p2 h f 0 h n n 0 1 n d z 0 h e e 0 1 e 0 d z 3 p3 n n m g t t t 0 t m 2 e 1 t t 0 t m 2 t l e σ kk ϛ e θ i θ w 4 p4 1 n t 1 n u t 0 for p1 frost heave equals total volume of water and ice content exceeding initial porosity guymon et al 1993 guymon et al 1980 1984 li et al 2019 li et al 2018 liu et al 2020 selvadurai et al 1999a b shoop and bigl 1997 taylor and luthin 1978 yang and goodings 1998 p2 was derived from the relationship between strain rate and porosity or porosity ratio lai et al 2014a ming and li 2015 ming et al 2016 p3 is an empirical formula for computing porosity change n n t that is a function of temperature t overburden σkk and water and ice content michalowski 1993 michalowski and zhu 2006 zhang 2014 zhang and michalowski 2015 p4 wu et al 2017 zhang et al 2020 used the conservation of mass of soil particles to calculate the displacement of frost heave fhqms of ice lens based models models that quantify frost heave by computing ice lens growth i models should be combined with the ice separation criterion that judges when and where ice lens occurs 5 i a p ob χ p w 1 χ p i 6 i b p i p sep p ob 2 σ sl r 7 i c p lh p ob p c t 8 i d t t s ice separation criterion of i models have four forms ia proposed by miller combines water pressure and ice pressure as total pore pressure o neill and miller 1985 padilla and villeneuve 1992 sheng et al 1995 ice lens will segregate at where total pore pressure exceeds overburden pressure pob ib gilpin 1980 uses a concept separation pressure psep that is a function of overburden pressure pob tension coefficient of ice water interface σsl and radius of particles r when ice pressure pi exceeds psep ice segregates ic based on gilpin s theory through water pressure at soil particle surface plh is used to judge ice separation ji et al 2018 zhou and zhou 2012 zhou et al 2018 id through separation temperature ts is used to judge ice separation konrad 1982 2005 konrad and morgenstern 1980 1981 although these ice separation criterions are semi theoretical they contribute reasonable explanations for ice separation combining with the ice separation criterion fhqms of i models are as following 9 i1 ρ i v i ρ w v w x bot d dt x b x bot ρ w θ w ρ i θ i d x 10 i2 v ff ρ w v i ρ i x x b 11 i3 v ff ρ w 1 i v i ρ i x x b 12 i4 h f ρ w ρ i θ ρ i 0 t f s i t dz dt d t 1 n v h δ t σ z e s z d z 13 i 5 h f α v z s z f w l z f for i1 frost heave caused by ice lens increase vi is computed by the mass balance equation o neill and miller 1985 padilla and villeneuve 1992 ice lens increase in i2 is all computed by water flow from frozen fringe to the warmest ice lens gilpin 1980 konrad 1982 2005 konrad and morgenstern 1980 1981 zhou and zhou 2012 zhou et al 2018 considering the pore ice in frozen fringe i3 computes frost heave by pore ice move and unfrozen water flow from frozen fringe to warmest ice lens sheng et al 1995 for a more accurate simulation i4 considers frost heave caused by ice lens increase frost heave in situ and soil compression strain ji et al 2018 zeng et al 2015 i5 is based on the model of o neill and miller 1985 and incorporated scaling and asymptotic analysis to simplify the complexity equations as a comprehensive formula bronfenbrener et al 2010 fowler and noon 1993 krantz and adams 1996 fhqms of pi models ice separation criterion of pi models hypothesize a critical porosity ratio esep exists if local porosity ratio increase to esep the ice lens occurs 14 pi a e e sep 1 e 0 e s σ p sep x l γ γ 0 d x e 0 zhou and li 2012 and ming and li 2015 believe ice lens separation is related to pore pressure σ and separation strength psep thus they derived an ice separation porosity ratio esep through the elastic hypothesis of frozen soil however the parameter esep have not been further validated and used in computing frost heave ming and li 2015 zhang et al 2018 zhou and li 2012 and the frost heave in their papers were computed by initial porosity ratio e0 or porosity rate n0 for example p2 eq 2 ming and li 2015 or p2 incorporating a thermal strain eq 15 lai et al 2014a was used to quantify the frost heave 15 pi u 0 h n n 0 1 n β t t 0 d x fig 4 shows the coupling relationship of thermal fields t hydraulic fields h and frost heave quantitative methods fhqm negative temperature that changes the water soil potential is the driving force of water migration the frost heave displacement caused by water migration and phase change is quantified by the fhqms the relationship of each coupling components also is the relationship of the error transfer between them the most significant difference among thfs is the mechanism they based capillary theory based h fields h1 h1 ε and h1 εc were inherited and developed from the water migration theory of unfrozen soil that regards soil as porous medium frozen fringe theory based h fields h1 vi h1 τ h2 vi and h2 vii were developed from the experiment observation of soil freezing which focus on the ice segregation and water migration in frozen fringe besides this significant difference the thfs are distinct with each other for the physical terms heat source terms for different t fields and mass transfer terms for different h fields therefore for answer how the different thfs cause simulation error we need to investigate and analyze 1 the error features caused by the different mechanism and 2 the error features caused by the heat source terms and the mass transfer terms based on state variables of fhqms the authors found present fhqms can be classified into two groups a mass based and b mass and temperature based fig 4 frost heaving is a result of water migration and phase change process in soil and temperature hardly changes the density of ice water and soil particles therefore temperature does not need to be a state variable in fhqms but can be taken as a variable affecting mass transfer and phase change the papers published from 2015 to 2020 are most mass based fhqms like p1 p2 and p4 that are easy to be combined with engineering application for mass and temperature based fhqms one kind is focused on the ice segregation mechanism i1 i2 i3 and i4 which restricted to one dimensional frost heave problem another kind regards temperature as a variable of porosity rate function p3 which needs many parameters obtained by experiments thus mass and temperature based fhqms are still difficult to be applicated in engineering and mass based fhqms p1 p2 and p4 need to be further evaluated 3 experimental simulation data in section 2 the frost heave models were deconstructed as thfs and fhqms according to the modeling methods and equations the above modeling methods are numerous and need to be implemented on different finite element software or programs thus it is difficult to analyze the error sources by re simulation we directly used the simulation and experiment data in cited papers to study the errors caused by different modeling methods that can be written as 16 y k g b 1 b 2 v k where yk is a 3 dimensional observation data containing temperature water content and frost heave k 1 2 3 g is simulation result computed by the model b 1 is error caused by the incorrect modeling mechanism b 2 encapsulates all sources of error except for mechanism error b 1 and instrument noise v k as we know b 2 contains the error caused by soil types boundary conditions scale and numerical methods of each model which can be decreased by data assimilation techniques berardi et al 2016 hamilton et al 2018 what should be note that b 2 and v k have no regularity characteristics between different simulations that sourced from different researches thus if the error show the same characteristic between different simulations that used the same modeling method g the characteristic source from b 1 which is the key to find the insufficient of modeling methods and present suggestions for further improving them table 3 shows the data sources and relative information of soil freezing experiments these frost heaving experiments were carried out in laboratory conditions the experiment id are defined with their fhqms and authors names 4 modeling method simulation error analysis 4 1 thermal hydraulic field simulation error 4 1 1 thermal field errors the simulation result of temperature except p1li all tend to overestimate temperature of soil columns at initial stages of freezing fig 5 the reason is that their heat conductivities are underestimated p1li uses constant λu and λf as unfrozen and frozen soil heat conductivity that do not change during simulation other models use geometric average method computed heat conductivity i α λ α θ α that changes with water and ice content the heat conductivity of ice 2 2 w m k is larger than that of water 0 59 w m k if the error does not come from the underestimated ice content it comes from the geometric average method heat sources in the t1 field equation like heat flow caused by convection j latent heat of ice lens increase vi hydraulic pressure gradient p and soil deformation ε have less influence on the t field error than that of heat conductivity thus improving the accuracy of thermal conductivity should be paid much attention besides adding heat source terms 4 1 2 hydraulic field errors most paper of frost heave models did not compare the simulation and observed water content profiles the hydraulic field equations that have been evaluated with water content profiles are h1 h1 εc and h2 vi fig 6 both of these equations can simulate water migration well for example h1 p1taylor pilai1 h1 εc p4zhang and h2 vi i4zeng however the simulation error of some results show the following two features the first feature is that the simulation error of h1 and h1 εc mostly occur at where the water content is the largest according to the secondary frost heave theory and observation in experiment this region is where the multilayer ice lenses occur the idealization of h1 and h1 εc which regards the frozen soil as porous medium probably constitutes the greatest departure from the fact that local ice lens growth destroys the pore structure the local ice lenses accumulate large amount of migration water which is very different with water migration in porous medium therefore the location and thickness of ice lenses rather than pore water content become the key to compute water content at this region h2 vi incorporates the mechanism of ice segregation and water migration in frozen fringe which is more reasonable for computing local ice lens growth than h1 and h1 εc some previous researches konrad 1982 konrad and morgenstern 1980 and i4zeng show h fields basing on frozen fringe theory produce little water migration error at the region where multilayer ice lenses occur another error feature is that h1 has poor ability to simulate different temperature gradient and overburden pressure conditions the temperature gradients of p2ming1 and p2m2 are 0 5 c cm and 0 91 c cm respectively the overburden pressures of pilai1 and pil2 are 50 kpa and 0 kpa respectively although the simulation used the same model and parameters the error will increase when temperature gradient or overburden pressure condition change firstly the insufficient ability of h1 to model the mechanism of ice segregation and frozen fringe is the essential reason for this error pil2 tried to combine separation porosity ratio esep and h1 are used to compute the ice lenses growth but the results show that accurate ice lens thickness remain difficult to simulate in addition the directly reason for the error feature is the inaccurate hydraulic parameters the simulation results of p2ming1 p2m3 p2zhang and pil2 are poor the hydraulic conductivity they used are as a function of temperature kf t α or unfrozen water content kf w β although some researches presented the values of α and β used in their models no evidence show the value of these two parameters invariant with different simulation conditions the idealization of h1 that regarding freezing soil as porous medium also result that the values of α and β have high uncertainty for simulating the effect of these two conditions on ice segregation and increase 4 1 3 thermal hydraulic field coupling errors because t field and h field are coupled together their errors will influence each other fig 6 shows that the maximum simulation errors of the h field mostly occur at the depth with maximum water content however the location of maximum temperature and temperature gradient errors are randomly distributed what s more the t field errors of p4wu and pil2 are small but their water content h field errors are large conversely the h field simulation of p4zhang is accurate but its temperature error is large these two phenomena suggest interaction between the t field error and h field error is very small and can be ignored this explanation seems to contradict the fact that the t field and h field are highly influenced each other by phase change to investigate the cause of the contradiction we analyzed the computational logic of the model as following fig 7 note first the coupling term θ i t in t field and h field equations cannot be the error source t field and h field are coupled with soil freezing curve sfc sfcs used in the models are obtained by experiments which are accurate for simulation therefore the error of θ i t comes from inaccurate t field or h field and the error sources of t field can only come from heat capacity cv and heat conductivity λ fig 7 a accurate h field computed by inaccurate coupling term θ i t suggests that the hydraulic conductivity k or diffusion coefficient d is improper calibrated for the same reason the error sources of inaccurate h field are k or d fig 7 b if the t field is accurate heat capacity cv or heat conductivity λ is improper calibrated only when both the errors of t field and h field are small the parameters of the two fields can be accurate for example pi1lai1 fig 6 4 2 errors from frost heave quantification method fig 4 have shown that mass based fhqms are more popular than that of mass and temperature based fhqms from the physical basis of the two kind fhqms mass based fhqms are more reliable due to the physical premise of conservation of mass the law of conservation of mass includes the effect of pore expansion caused by ice and consolidation compression of frozen fringe on saturated condition a definite quantitative relationship between water and ice content and porosity rate exists mass and temperature based fhqms like i1 i2 and i3 are insufficient without considering the displacement caused by freezing in situ and consolidation in frozen fringe although i4 improved the modeling method of the two problems the application is still not simple for parameters deciding p1 p2 and p4 are three most used mass based fhqms in recent years p1 and p2 can be evaluated by the final porosity computed by water and ice content derived in appendix i p4 is a transient equation of mass conservation that cannot be evaluated directly like p1 and p2 but p4 is true if the frost heave displacement comply with mass conservation quantitative five frost heave experiments for saturated soil are used to evaluate the fhqms of p1 and p2 the first four unidirectional frozen soil columns are open systems with water supply ming and li 2015 ming et al 2016 zeng et al 2015 zhang et al 2020 while the last frozen soil column is closed system without water supply zhang et al 2018 the results show the frost heave computed with final water and ice content profile and p1 are less than observed frost heave for open systems the authors found the error comes from an integral of an nonexistent interval h0 h of n0 h0 and h represent the initial and after freezing height of soil column 0 h 0 n 0 rather than 0 h n 0 represents the total volume of pore before freezing p1 underestimates the frost heave because minus the term 0 h f n 0 0 h n 0 0 h 0 n 0 the frost heave computed with final porosity n and p2 are larger than observed frost heave the authors found that the reason for the error is an incorrect derivation of the relationship between frost heave and porosity n p2 h f 0 h n n 0 1 n d x is true only when the porosity is identical in the integral interval however the porosity of frozen soil after freezing discontent this condition especially at location of ice lenses for example the porosity n at ice lens is 1 and the computed frost heave with p2 will be infinity according to the conservation of mass frost heave displacement equals to the pore volume after freezing subtract the pore volume before freezing thus the authors presented a new mass based fhqm under saturated condition as 17 p h f 0 h θ w θ i d x h 0 n 0 the liner fitting slopes of computed data of p1 p2 and p are 1 2300 0 6484 and 0 9903 respectively which shows the new fhqm p is more accurate than that p1 and p2 the error caused by p1 and p2 are the inaccurate strain relationship rather than the premise of conservation of mass p4 is a strict mass conservation equation thus p4 is accurate like p is although p have a good ability for computing frost heave of open system the obvious error shows that the p is not suitable for closed system fig 8 the error cannot come from the second term of p h0n0 that is initial pore volume thus the error must come from the first term of p 0 h θ w θ i d x which implies that the pores are not only filled with water and ice after freezing but air that enter the pores expelling the soil particles according to yang laplace equation eq 18 the condition for air to enter the saturated freezing soil is that the difference of air water pressure overcomes water interfacial tension which has the same mechanism as dehydration process of soil the experiment data show the tension ranges from 10 to 30 kpa xu et al 2010 as temperature decreases water pressure in saturated soil decrease to 30 kpa is common zhang et al 2016 zhang et al 2014 which means the pressure difference can overcome the tension and air can enter freezing soil for open system the air entering might be replaced by water supply thus the first term 0 h θ w θ i d x is accurate for open system of freezing soil 18 p a p w t 2 γ aw r 4 3 frost heave frost depth error the frost depth and frost heave simulation errors directly computed with data in cited papers are as shown in fig 9 and fig 10 for better comparing the simulation errors the simulation errors of frost depth and frost heave were divided by their maximum observation data because temperature is the index in frost heave models to determine frost depth the accuracy of frost depth is highly dependent on temperature simulation results temperature errors except the large errors for the first 20 freezing duration are typically less than 0 25 c therefore simulation error of frost depth of different models except some outliers almost all are accurate soil type has no obvious effect on the error for most models frost heave error does not exceed 10 of maximum frost heave observed which suggests the simulation results of different models all have good agreement with experimental data however these results cannot prove that the frost heave models have reached high accuracy as previously analyzed it is difficult to control the h field simulation error of these models within 10 the error of water content profile of p2ming p2zhang p4wu and pil2 are obviously more than 20 thus the error that transfer from water content profiles are too large to produce accurate frost heave results unless the errors are hidden by other coupling component of the models for example the underestimated simulation water content of p2ming1 fig 6 combining with the fhqm p2 that overestimated frost heave displacement fig 8 result a plausible frost heave simulation fig 10 5 conclusions the commonality of frost heave models is that both of them can be deconstructed as thermal hydraulic frameworks thfs and frost heave quantification methods fhqms different thfs and fhqms constitute the difference among these models from the mechanism level one kind models p models regarding freezing soil as porous medium built thfs basing on the capillary theory that inherited from unfrozen soil the frost heave of p models are computed with fhqms that are relationships between pore strain and frost heave displacement another kind frost heave models i models regarding freezing soil as structure of ice soil interlayers built thfs basing on the frozen fringe theory the frost heave of i models are mainly computed with ice lenses growth besides the mechanism difference heat source terms and mass transfer terms considered in thfs also constitute the difference between models p models are more popular than i models for the advantage in application for 2 or 3 dimensions problems p models regarding frozen soil as porous medium without considering ice segregation and increase is insufficient which is the essential reason for impeding the improvement of simulation accuracy of water migration in addition for this reason hydraulic parameters of p models have high uncertainty for simulating different temperature and overburden pressure conditions compared with the parameters used in heat conductivity and hydraulic conductivity the error caused by additional heat source terms and mass transfer terms are small the most used two fhqms of p models produce error exceeding 20 because inaccurate relationship between pore strain and frost heave displacement this error can be easily reduced by the formula modified in this paper saturated freezing soil with water supply strictly observe the mass conservation of ice water and soil particles but the relationship might not true for saturated freezing soil without water supply because the air entering the error sources of some models might be covered by a plausible simulation result of frost heave with poor simulation result of thf and fhqm thus each coupling component of the model should be validated separately the key to develop p models is to improve the mechanism for simulating water migration in the region of multilayer ice lenses which contain corresponding function of hydraulic conductivity and their parameters in addition a validated and accurate fhqm cannot be ignored because a small inaccuracy of fhqm will cause a great simulation error of frost heave although i models are more reasonable to simulated ice lenses growth extending them to 2 or 3 dimensions greatly increases the application difficulty before a simple and accurate i model is born incorporating the frozen fringe theory of i models into p models is a good way to compromise the computing capabilities and model realism actually some researchers have been developing this kind models like the pi models in this paper they integrated the frozen fringe mechanism of i model into the hydraulic functions and parameters of p model which is a feasible method but needs further research to improve the accuracy 6 data availability data is available through taylor and luthin 1978 mu and ladanyi 1987 guymon et al 1993 yang and goodings 1998 selvadurai et al 1999a li et al 2018 michalowski and zhu 2006 zhang 2014 liu et al 2019 wu et al 2017 zhang et al 2020 padilla et al 1997 hopke 1980 konrad and shen 1996 nixon 1991 zhou et al 2018 bronfenbrener 2009 sheng et al 1995 teng et al 2020 ming et al 2016 zeng et al 2015 krantz and adams 1996 lai et al 2014b ming and li 2015 zhang et al 2018 and she et al 2018 credit authorship contribution statement sen hao cheng conceptualization data curation methodology writing original draft bernard a engel writing review editing hao xing wu writing review editing pin zhang duan writing review editing yu bao wang funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is jointly supported by the national key research and development program of china 2016yfc0400205 science and technology integrated innovation project shaanxi province of china 2016ktzdny 01 01 and the 111 project b12007 appendix i for saturated soil porosity ratio e and porosity n have relationships with total volumetric water content as 19 e θ w 1 09 θ i 1 θ w 1 09 θ i 20 n θ w 1 09 θ i the volumetric unfrozen water content θw and ice content θi are calculated with sfc used by the models and volumetric total water content after freezing because the local bulk density of saturated soil decreases with water content increase the total water content cannot be calculated by initial bulk density and mass water content the specific gravity of soil particle is constant therefore the volume water content can be calculated as 21 θ w g s 1 w g s where w is mass water content and gs is specific gravity of soil particles appendix ii a thickness of frozen fringe c specific water capacity j kg k cv volumetric heat capacity of soil j m3 k cw volumetric heat capacity of water j m3 k d water diffusivity m2 s dp thermal diffusivity under hydraulic gradient m2 s e void ratio e0 initial void ratio es the void ratio matching maximum pore pressure esep separation void ratio es elastic modulus pa f w source term of water supply kg m3 s gt thermal gradient k m gs specific gravity of soil particles h0 initial height of soil column h height of soil column after freezing hf frost heave displacement h thickness of frozen region ib volume ice content at base of final ice lens i average volume ice content in frozen fringe je convection heat j k hydraulic conductivity cm h lf latent heat j kg m α production rate of α component kg s n porosity n time derivative of porosity 1 s n m parameter decided by curve fitting pw water pressure pa pi ice pressure pa pob over burden pressure pa psep ice pressure when ice segregates pa plh water pressure at a distance of h from the surface of soil particles pa r soil particle radius m sα saturation of α component t time s t temperature c ta a constant ta 273 15 k ttop temperature at top of soil column c tbot temperature at bottom of soil column c ts temperature of ice separation c tf temperature at freezing front c tm the temperature c at which the maximum porosity rate occurs c u displacement variable m vw specific volume of water m3 kg vi specific volume of ice m3 kg vw unfrozen water velocity m s vi ice velocity m s v α r the relative velocity of α component with respect to a moving solid m s vff unfrozen water velocity in frozen fringe m s vh ice lens increase velocity m s wl a parameter related to overburden pressure w mass water content xb the location of base of final ice lens xf the location of freezing front zf displacement of the frozen fringe zf displacement of the soil column surface λ heat conductivity w m k λp heat conductivity of the soil at the frozen fringe w m k λu heat conductivity of the soil at the unfrozen region w m k ρw density of water kg m3 ρi density of ice kg m3 ρd dry density of soil kg m3 θw unfrozen water content θi ice content θsat saturated water content φ water potential pa β thermal stress parameter εv volumetric strain χ a weighting factor σ stress σsl ice water interfacial tension σt ultimate tensile strength of soil σkk the first invariant of the effective stress tensor in the frozen soil ζ a material parameter obtained from calibration γ volumetric weight n m3 
2806,frost heave models are important tools to study engineering damage in cold regions however multi physical field coupling and different methods of coupling components bring difficulties to compare the models and to optimize their error sources therefore classifying and deconstructing of different frost heave models and further evaluating them are significant for model development we reviewed frost heave models for the past 50 years and built frost heave model families to show the classification and inheritance relationships then the models were deconstructed by the thermal hydraulic framework thf and frost heave quantification method fhqm finally based on simulated and experimental data in cited papers the model errors caused by different thfs and fhqms were analyzed the results show a present frost heave models can be classified as porosity increase based p and ice lens increase based i models and they are tending to merge with each other b thfs of p models regarding freezing soil as porous medium are the main reason for water migration error in the region of multi ice layers which also results high uncertainty of hydraulic parameters under different simulation conditions c the most used two fhqms of p models cause error exceeding 20 because inaccurate relationship between pore strain and frost heave displacement d the errors of thfs and fhqms offset each other which will hidden the error sources of the models this paper can provide a reference for the improvement of frost heave models used in engineering keywords frost heave model classification deconstruction method evaluation error analysis data availability data will be made available on request 1 introduction frost heave refers to the ground uplift caused by the formation of discrete ice layers in freezing soil that are called ice lenses this phenomenon in cold regions is responsible for the damage of roads and infrastructure like underground pipelines tunnels channels and buildings the cold region is extensively distributed on the earth and its areas account for 50 of the land area therefore avoiding frost heave damage is a common problem around the world frost heave models as tools for simulating physical processes are important to study how to avoid the damage researchers have noticed and studied the problem of frost heave more than a century ago taber 1916 1929 1930 however until the 1970s when computers rapidly developed frost heave models were born hydrodynamic models harlan 1973 taylor and luthin 1978 rigid ice models gilpin 1980 hopke 1980 miller 1977 1978 o neill 1983 o neill and miller 1985 and segregation potential models konrad 1982 konrad and morgenstern 1980 1981 1984 were all born during that time these models were developed rapidly and applied in the 1990s excellent reviews of these frost heave models can refer to the work of henry 2000 rempel 2010 and peppin and style 2013 entering the 21st century the model development show two characteristics more in depth research on specific issues and more extensive application for example tubini et al 2021 presented a new model based on the heat transfer equation which allows the user to choose both the space and time discretization without any restriction due to stability and convergence issues this model was combined with richardson richards equation and developed as an open source code for wider application tubini and rigon 2021 these researches provide theoretical basis for the further development of the model another example is the appearance of commercial finite element software like abaqus ansys and comsol multiphysics accelerate the coupling and application of these models on cold region engineering like embankment dam zhang et al 2021 buried pipelines nishimura et al 2009 wang et al 2019 subgrades niu et al 2014 sheng et al 2014 tai et al 2018 teng et al 2020 tian et al 2019 wen et al 2011 yu et al 2016 tunnels and retaining walls liu et al 2019 zhang 2014 and channels li et al 2019 liu et al 2020 the first example is a rigorous research process because it only focuses on specific problems in the coupling model however the second example face two problems because these frost heave models are constructed with methods that sourced from different researches the first problem is that the inheritance and development relationship between different models is unclear the models inherited methods from past different models which results the difficulty in the models classification what is more important evaluating the differences among these models becomes impossible which will impede the inheritance of model advantages and the elimination of model defects the second problem is that validation of frost heave models is insufficient and the model error sources are lacking analysis guymon et al 1993 frost heave models generally have temperature water content and deformation as three state variables the three simulation errors of the three variables interact with each other based on their coupling relationships which has not been carefully analyzed to solve these two problems we need to determine the commonalities and differences of different models and how these cause model errors through the variable relationship of the models we first searched all papers about frost heave models in web of science with theme key words frost heave model from 1970 to 2020 fig 1 then a frost heave model family was constructed which reflects the inheritance and development relationship between different models according to the modeling methods coupling components of these models were deconstructed and classified as the object of evaluation and error analysis finally combining the modeling methods and the features of simulation errors sources of simulation error were analyzed which will answer the question this paper proposed 2 frost heave model classification and deconstruction 2 1 classification two main frost heave model families porosity based and ice lens based fig 2 model families produce their own members with distinctive characteristics the two characteristics have existed since frost heave models appeared and still influence latter models porosity based frost heave models were initially affected by an idea that frost heave occurs when ice content exceeds a critical porosity of freezing soil dirksen and miller 1966 taylor and luthin 1978 because this idea is easy to combine with harlan s model harlan 1973 and taylor and luthin 1978 have successfully modeled it porosity based models are popular in application porosity rate models poromechanical models soil mechanical models and crystallization kinetic models to some extent were influenced by this idea ice lenses are regarded as the main reason for frost heave taber 1930 therefore some models computed frost heave by computing ice lenses growth miller s theory o neill and miller 1985 referred to as secondary frost heave theory frozen fringe theory was the first to yield quantitative predictions of ice lens spacing peppin and style 2013 the biggest difference of this kind of model and the porosity based model is that they model the frozen fringe frozen fringe beneath the last ice lens is the key region for water migration and phase change rigid ice models and their simplified version segregation potential model and separate ice model all regard frozen fringe as an important part what is interesting some latter models inherited the two model families characteristics they derived the separation porosity with ice segregation criterion which can judge when and where ice lens occurs by porosity the authors name them porosity ice lens pi models 2 2 deconstruction commonality differences frost heave is a macro phenomenon due to water heat transfer and phase change during soil freezing therefore the biggest commonality of these frost heave models is that both of them contain two basic components thermal hydraulic frameworks thfs and frost heave quantification methods fhqms thfs simulate the mass and heat transfer of frozen soil and fhqms quantify the displacement frost heave caused by mass transfer and phased change the essential difference between frost heave models is that they used different thfs and fhqms therefore we deconstructed the models by their thfs and fhqms that are used as objects for further comparison and error analysis 2 2 1 thermal hydraulic framework the thermal hydraulic framework thf is two physical field equations thermal and hydraulic field equations coupled together although some papers used different forms of equations the thfs can be classified by their physical mechanism as shown in table 1 and table 2 for citing these heat balance equations conveniently when analyzing their simulation errors they are coded with id t1 is the simplest pde form heat balance equation that only considers the latent heat of freezing in situ on the basis of t1 other heat balance equations consider heat sources like the latent heat of rigid pore ice moving into ice lenses vi ρilfvi θi x convection heat j and more complex heat sources like heat flow caused by hydraulic gradient p dp pw and soil deformation ε 1 n t β εv t t2 is linearity form heat balance equation t2 vi was first proposed by gilpin 1980 sheng et al 1995 improved the t2 vi and considered ice content in frozen fringe t2 vii t12 combines t1 pde form heat balance equation at frozen and unfrozen regions and t2 linear temperature profile at the frozen fringe region the difference of t field equations is mainly reflected in their heat source terms richards equation and its variant forms h1 are the most widely used mass balance equation which only consider mass transfer of water more complicated mass balance equations consider ice velocity vi ρ v i x soil particle displacement ε εv t and crystallization of ice and solute c m α τ t in the first two terms of h1 τ is coefficient of capillary conversion that contains air or ice phase and colloidal or noncolloidal soils darcy s equation combined with clapeyron equation is also a commonly used mass transfer equation h2 which is based on the frozen fringe theory gilpin 1980 first developed and coupled h2 vi with t2 vi as a linear rigid ice model that simplified the miller s pde rigid ice model however he assumed all segregation freezing occur at warmest ice lens and did not consider the ice within frozen fringe to be mobile it constitutes the greatest physical departure from miller s perspective o neill and miller 1985 sheng et al 1995 developed h2 vii that considers pore ice freezing and moving in the fringe that is based on miller s physical hypothesis hydraulic field equations like h1 h1 ε and h1 εc regard frozen soil as porous medium which has the same structure as unfrozen soil another kind equations basing on the frozen fringe theory like h1 vi h1 τ h2 vi and h2 vii regard freezing soil as structure of ice soil interlayer which is consistent with observation 2 2 2 thermal hydraulic framework coupling the control equations of thfs usually are constructed with thermal field equations table 1 and hydraulic field equations table 2 variables in thfs can be classified as two types state variable and functions as state variable the sate variables of these two equations are temperature t unfrozen water content θu and soil water potential φui which can finally be transformed into two independent variables through the state variable triangle as fig 3 shown the difference of thfs caused by the state variable triangle is decided by the accuracy of swc and sfc lu et al 2019 wan et al 2022 another type of variables like heat capacity cv thermal conductivity λ ice content θi water velocity vw ice velocity vi all can be expressed as functions of state variables which result the coupling relationship between the thermal field and hydraulic field significantly these coupling relationships are open and diverse and constitute the main difference between thfs because of their different computing methods and source terms that are optional for example some researches use geometric average method computed heat conductivity λ while other researches use constant λu and λf as unfrozen and frozen soil heat conductivity some thermal filed equations considered convection heat term caused by water flow while the others did not considered it some hydraulic field equations include not only the description of water migration but also the migration of ice these open choices result a big difference of these thfs and an unstable model convergence the method of tubini and rigon 2021 is effective for convergence problems but before this the influence of these open choices on thfs should be analyzed thus a reasonable choice can be made 2 2 3 frost heave quantification method fhqm fhqms of porosity based models the fhqms of porosity based models p models regard frozen soil as a continuous porous medium porosity of p models plays a significant role in fhqms 1 p1 h f 0 h θ u θ i n 0 d x 2 p2 h f 0 h n n 0 1 n d z 0 h e e 0 1 e 0 d z 3 p3 n n m g t t t 0 t m 2 e 1 t t 0 t m 2 t l e σ kk ϛ e θ i θ w 4 p4 1 n t 1 n u t 0 for p1 frost heave equals total volume of water and ice content exceeding initial porosity guymon et al 1993 guymon et al 1980 1984 li et al 2019 li et al 2018 liu et al 2020 selvadurai et al 1999a b shoop and bigl 1997 taylor and luthin 1978 yang and goodings 1998 p2 was derived from the relationship between strain rate and porosity or porosity ratio lai et al 2014a ming and li 2015 ming et al 2016 p3 is an empirical formula for computing porosity change n n t that is a function of temperature t overburden σkk and water and ice content michalowski 1993 michalowski and zhu 2006 zhang 2014 zhang and michalowski 2015 p4 wu et al 2017 zhang et al 2020 used the conservation of mass of soil particles to calculate the displacement of frost heave fhqms of ice lens based models models that quantify frost heave by computing ice lens growth i models should be combined with the ice separation criterion that judges when and where ice lens occurs 5 i a p ob χ p w 1 χ p i 6 i b p i p sep p ob 2 σ sl r 7 i c p lh p ob p c t 8 i d t t s ice separation criterion of i models have four forms ia proposed by miller combines water pressure and ice pressure as total pore pressure o neill and miller 1985 padilla and villeneuve 1992 sheng et al 1995 ice lens will segregate at where total pore pressure exceeds overburden pressure pob ib gilpin 1980 uses a concept separation pressure psep that is a function of overburden pressure pob tension coefficient of ice water interface σsl and radius of particles r when ice pressure pi exceeds psep ice segregates ic based on gilpin s theory through water pressure at soil particle surface plh is used to judge ice separation ji et al 2018 zhou and zhou 2012 zhou et al 2018 id through separation temperature ts is used to judge ice separation konrad 1982 2005 konrad and morgenstern 1980 1981 although these ice separation criterions are semi theoretical they contribute reasonable explanations for ice separation combining with the ice separation criterion fhqms of i models are as following 9 i1 ρ i v i ρ w v w x bot d dt x b x bot ρ w θ w ρ i θ i d x 10 i2 v ff ρ w v i ρ i x x b 11 i3 v ff ρ w 1 i v i ρ i x x b 12 i4 h f ρ w ρ i θ ρ i 0 t f s i t dz dt d t 1 n v h δ t σ z e s z d z 13 i 5 h f α v z s z f w l z f for i1 frost heave caused by ice lens increase vi is computed by the mass balance equation o neill and miller 1985 padilla and villeneuve 1992 ice lens increase in i2 is all computed by water flow from frozen fringe to the warmest ice lens gilpin 1980 konrad 1982 2005 konrad and morgenstern 1980 1981 zhou and zhou 2012 zhou et al 2018 considering the pore ice in frozen fringe i3 computes frost heave by pore ice move and unfrozen water flow from frozen fringe to warmest ice lens sheng et al 1995 for a more accurate simulation i4 considers frost heave caused by ice lens increase frost heave in situ and soil compression strain ji et al 2018 zeng et al 2015 i5 is based on the model of o neill and miller 1985 and incorporated scaling and asymptotic analysis to simplify the complexity equations as a comprehensive formula bronfenbrener et al 2010 fowler and noon 1993 krantz and adams 1996 fhqms of pi models ice separation criterion of pi models hypothesize a critical porosity ratio esep exists if local porosity ratio increase to esep the ice lens occurs 14 pi a e e sep 1 e 0 e s σ p sep x l γ γ 0 d x e 0 zhou and li 2012 and ming and li 2015 believe ice lens separation is related to pore pressure σ and separation strength psep thus they derived an ice separation porosity ratio esep through the elastic hypothesis of frozen soil however the parameter esep have not been further validated and used in computing frost heave ming and li 2015 zhang et al 2018 zhou and li 2012 and the frost heave in their papers were computed by initial porosity ratio e0 or porosity rate n0 for example p2 eq 2 ming and li 2015 or p2 incorporating a thermal strain eq 15 lai et al 2014a was used to quantify the frost heave 15 pi u 0 h n n 0 1 n β t t 0 d x fig 4 shows the coupling relationship of thermal fields t hydraulic fields h and frost heave quantitative methods fhqm negative temperature that changes the water soil potential is the driving force of water migration the frost heave displacement caused by water migration and phase change is quantified by the fhqms the relationship of each coupling components also is the relationship of the error transfer between them the most significant difference among thfs is the mechanism they based capillary theory based h fields h1 h1 ε and h1 εc were inherited and developed from the water migration theory of unfrozen soil that regards soil as porous medium frozen fringe theory based h fields h1 vi h1 τ h2 vi and h2 vii were developed from the experiment observation of soil freezing which focus on the ice segregation and water migration in frozen fringe besides this significant difference the thfs are distinct with each other for the physical terms heat source terms for different t fields and mass transfer terms for different h fields therefore for answer how the different thfs cause simulation error we need to investigate and analyze 1 the error features caused by the different mechanism and 2 the error features caused by the heat source terms and the mass transfer terms based on state variables of fhqms the authors found present fhqms can be classified into two groups a mass based and b mass and temperature based fig 4 frost heaving is a result of water migration and phase change process in soil and temperature hardly changes the density of ice water and soil particles therefore temperature does not need to be a state variable in fhqms but can be taken as a variable affecting mass transfer and phase change the papers published from 2015 to 2020 are most mass based fhqms like p1 p2 and p4 that are easy to be combined with engineering application for mass and temperature based fhqms one kind is focused on the ice segregation mechanism i1 i2 i3 and i4 which restricted to one dimensional frost heave problem another kind regards temperature as a variable of porosity rate function p3 which needs many parameters obtained by experiments thus mass and temperature based fhqms are still difficult to be applicated in engineering and mass based fhqms p1 p2 and p4 need to be further evaluated 3 experimental simulation data in section 2 the frost heave models were deconstructed as thfs and fhqms according to the modeling methods and equations the above modeling methods are numerous and need to be implemented on different finite element software or programs thus it is difficult to analyze the error sources by re simulation we directly used the simulation and experiment data in cited papers to study the errors caused by different modeling methods that can be written as 16 y k g b 1 b 2 v k where yk is a 3 dimensional observation data containing temperature water content and frost heave k 1 2 3 g is simulation result computed by the model b 1 is error caused by the incorrect modeling mechanism b 2 encapsulates all sources of error except for mechanism error b 1 and instrument noise v k as we know b 2 contains the error caused by soil types boundary conditions scale and numerical methods of each model which can be decreased by data assimilation techniques berardi et al 2016 hamilton et al 2018 what should be note that b 2 and v k have no regularity characteristics between different simulations that sourced from different researches thus if the error show the same characteristic between different simulations that used the same modeling method g the characteristic source from b 1 which is the key to find the insufficient of modeling methods and present suggestions for further improving them table 3 shows the data sources and relative information of soil freezing experiments these frost heaving experiments were carried out in laboratory conditions the experiment id are defined with their fhqms and authors names 4 modeling method simulation error analysis 4 1 thermal hydraulic field simulation error 4 1 1 thermal field errors the simulation result of temperature except p1li all tend to overestimate temperature of soil columns at initial stages of freezing fig 5 the reason is that their heat conductivities are underestimated p1li uses constant λu and λf as unfrozen and frozen soil heat conductivity that do not change during simulation other models use geometric average method computed heat conductivity i α λ α θ α that changes with water and ice content the heat conductivity of ice 2 2 w m k is larger than that of water 0 59 w m k if the error does not come from the underestimated ice content it comes from the geometric average method heat sources in the t1 field equation like heat flow caused by convection j latent heat of ice lens increase vi hydraulic pressure gradient p and soil deformation ε have less influence on the t field error than that of heat conductivity thus improving the accuracy of thermal conductivity should be paid much attention besides adding heat source terms 4 1 2 hydraulic field errors most paper of frost heave models did not compare the simulation and observed water content profiles the hydraulic field equations that have been evaluated with water content profiles are h1 h1 εc and h2 vi fig 6 both of these equations can simulate water migration well for example h1 p1taylor pilai1 h1 εc p4zhang and h2 vi i4zeng however the simulation error of some results show the following two features the first feature is that the simulation error of h1 and h1 εc mostly occur at where the water content is the largest according to the secondary frost heave theory and observation in experiment this region is where the multilayer ice lenses occur the idealization of h1 and h1 εc which regards the frozen soil as porous medium probably constitutes the greatest departure from the fact that local ice lens growth destroys the pore structure the local ice lenses accumulate large amount of migration water which is very different with water migration in porous medium therefore the location and thickness of ice lenses rather than pore water content become the key to compute water content at this region h2 vi incorporates the mechanism of ice segregation and water migration in frozen fringe which is more reasonable for computing local ice lens growth than h1 and h1 εc some previous researches konrad 1982 konrad and morgenstern 1980 and i4zeng show h fields basing on frozen fringe theory produce little water migration error at the region where multilayer ice lenses occur another error feature is that h1 has poor ability to simulate different temperature gradient and overburden pressure conditions the temperature gradients of p2ming1 and p2m2 are 0 5 c cm and 0 91 c cm respectively the overburden pressures of pilai1 and pil2 are 50 kpa and 0 kpa respectively although the simulation used the same model and parameters the error will increase when temperature gradient or overburden pressure condition change firstly the insufficient ability of h1 to model the mechanism of ice segregation and frozen fringe is the essential reason for this error pil2 tried to combine separation porosity ratio esep and h1 are used to compute the ice lenses growth but the results show that accurate ice lens thickness remain difficult to simulate in addition the directly reason for the error feature is the inaccurate hydraulic parameters the simulation results of p2ming1 p2m3 p2zhang and pil2 are poor the hydraulic conductivity they used are as a function of temperature kf t α or unfrozen water content kf w β although some researches presented the values of α and β used in their models no evidence show the value of these two parameters invariant with different simulation conditions the idealization of h1 that regarding freezing soil as porous medium also result that the values of α and β have high uncertainty for simulating the effect of these two conditions on ice segregation and increase 4 1 3 thermal hydraulic field coupling errors because t field and h field are coupled together their errors will influence each other fig 6 shows that the maximum simulation errors of the h field mostly occur at the depth with maximum water content however the location of maximum temperature and temperature gradient errors are randomly distributed what s more the t field errors of p4wu and pil2 are small but their water content h field errors are large conversely the h field simulation of p4zhang is accurate but its temperature error is large these two phenomena suggest interaction between the t field error and h field error is very small and can be ignored this explanation seems to contradict the fact that the t field and h field are highly influenced each other by phase change to investigate the cause of the contradiction we analyzed the computational logic of the model as following fig 7 note first the coupling term θ i t in t field and h field equations cannot be the error source t field and h field are coupled with soil freezing curve sfc sfcs used in the models are obtained by experiments which are accurate for simulation therefore the error of θ i t comes from inaccurate t field or h field and the error sources of t field can only come from heat capacity cv and heat conductivity λ fig 7 a accurate h field computed by inaccurate coupling term θ i t suggests that the hydraulic conductivity k or diffusion coefficient d is improper calibrated for the same reason the error sources of inaccurate h field are k or d fig 7 b if the t field is accurate heat capacity cv or heat conductivity λ is improper calibrated only when both the errors of t field and h field are small the parameters of the two fields can be accurate for example pi1lai1 fig 6 4 2 errors from frost heave quantification method fig 4 have shown that mass based fhqms are more popular than that of mass and temperature based fhqms from the physical basis of the two kind fhqms mass based fhqms are more reliable due to the physical premise of conservation of mass the law of conservation of mass includes the effect of pore expansion caused by ice and consolidation compression of frozen fringe on saturated condition a definite quantitative relationship between water and ice content and porosity rate exists mass and temperature based fhqms like i1 i2 and i3 are insufficient without considering the displacement caused by freezing in situ and consolidation in frozen fringe although i4 improved the modeling method of the two problems the application is still not simple for parameters deciding p1 p2 and p4 are three most used mass based fhqms in recent years p1 and p2 can be evaluated by the final porosity computed by water and ice content derived in appendix i p4 is a transient equation of mass conservation that cannot be evaluated directly like p1 and p2 but p4 is true if the frost heave displacement comply with mass conservation quantitative five frost heave experiments for saturated soil are used to evaluate the fhqms of p1 and p2 the first four unidirectional frozen soil columns are open systems with water supply ming and li 2015 ming et al 2016 zeng et al 2015 zhang et al 2020 while the last frozen soil column is closed system without water supply zhang et al 2018 the results show the frost heave computed with final water and ice content profile and p1 are less than observed frost heave for open systems the authors found the error comes from an integral of an nonexistent interval h0 h of n0 h0 and h represent the initial and after freezing height of soil column 0 h 0 n 0 rather than 0 h n 0 represents the total volume of pore before freezing p1 underestimates the frost heave because minus the term 0 h f n 0 0 h n 0 0 h 0 n 0 the frost heave computed with final porosity n and p2 are larger than observed frost heave the authors found that the reason for the error is an incorrect derivation of the relationship between frost heave and porosity n p2 h f 0 h n n 0 1 n d x is true only when the porosity is identical in the integral interval however the porosity of frozen soil after freezing discontent this condition especially at location of ice lenses for example the porosity n at ice lens is 1 and the computed frost heave with p2 will be infinity according to the conservation of mass frost heave displacement equals to the pore volume after freezing subtract the pore volume before freezing thus the authors presented a new mass based fhqm under saturated condition as 17 p h f 0 h θ w θ i d x h 0 n 0 the liner fitting slopes of computed data of p1 p2 and p are 1 2300 0 6484 and 0 9903 respectively which shows the new fhqm p is more accurate than that p1 and p2 the error caused by p1 and p2 are the inaccurate strain relationship rather than the premise of conservation of mass p4 is a strict mass conservation equation thus p4 is accurate like p is although p have a good ability for computing frost heave of open system the obvious error shows that the p is not suitable for closed system fig 8 the error cannot come from the second term of p h0n0 that is initial pore volume thus the error must come from the first term of p 0 h θ w θ i d x which implies that the pores are not only filled with water and ice after freezing but air that enter the pores expelling the soil particles according to yang laplace equation eq 18 the condition for air to enter the saturated freezing soil is that the difference of air water pressure overcomes water interfacial tension which has the same mechanism as dehydration process of soil the experiment data show the tension ranges from 10 to 30 kpa xu et al 2010 as temperature decreases water pressure in saturated soil decrease to 30 kpa is common zhang et al 2016 zhang et al 2014 which means the pressure difference can overcome the tension and air can enter freezing soil for open system the air entering might be replaced by water supply thus the first term 0 h θ w θ i d x is accurate for open system of freezing soil 18 p a p w t 2 γ aw r 4 3 frost heave frost depth error the frost depth and frost heave simulation errors directly computed with data in cited papers are as shown in fig 9 and fig 10 for better comparing the simulation errors the simulation errors of frost depth and frost heave were divided by their maximum observation data because temperature is the index in frost heave models to determine frost depth the accuracy of frost depth is highly dependent on temperature simulation results temperature errors except the large errors for the first 20 freezing duration are typically less than 0 25 c therefore simulation error of frost depth of different models except some outliers almost all are accurate soil type has no obvious effect on the error for most models frost heave error does not exceed 10 of maximum frost heave observed which suggests the simulation results of different models all have good agreement with experimental data however these results cannot prove that the frost heave models have reached high accuracy as previously analyzed it is difficult to control the h field simulation error of these models within 10 the error of water content profile of p2ming p2zhang p4wu and pil2 are obviously more than 20 thus the error that transfer from water content profiles are too large to produce accurate frost heave results unless the errors are hidden by other coupling component of the models for example the underestimated simulation water content of p2ming1 fig 6 combining with the fhqm p2 that overestimated frost heave displacement fig 8 result a plausible frost heave simulation fig 10 5 conclusions the commonality of frost heave models is that both of them can be deconstructed as thermal hydraulic frameworks thfs and frost heave quantification methods fhqms different thfs and fhqms constitute the difference among these models from the mechanism level one kind models p models regarding freezing soil as porous medium built thfs basing on the capillary theory that inherited from unfrozen soil the frost heave of p models are computed with fhqms that are relationships between pore strain and frost heave displacement another kind frost heave models i models regarding freezing soil as structure of ice soil interlayers built thfs basing on the frozen fringe theory the frost heave of i models are mainly computed with ice lenses growth besides the mechanism difference heat source terms and mass transfer terms considered in thfs also constitute the difference between models p models are more popular than i models for the advantage in application for 2 or 3 dimensions problems p models regarding frozen soil as porous medium without considering ice segregation and increase is insufficient which is the essential reason for impeding the improvement of simulation accuracy of water migration in addition for this reason hydraulic parameters of p models have high uncertainty for simulating different temperature and overburden pressure conditions compared with the parameters used in heat conductivity and hydraulic conductivity the error caused by additional heat source terms and mass transfer terms are small the most used two fhqms of p models produce error exceeding 20 because inaccurate relationship between pore strain and frost heave displacement this error can be easily reduced by the formula modified in this paper saturated freezing soil with water supply strictly observe the mass conservation of ice water and soil particles but the relationship might not true for saturated freezing soil without water supply because the air entering the error sources of some models might be covered by a plausible simulation result of frost heave with poor simulation result of thf and fhqm thus each coupling component of the model should be validated separately the key to develop p models is to improve the mechanism for simulating water migration in the region of multilayer ice lenses which contain corresponding function of hydraulic conductivity and their parameters in addition a validated and accurate fhqm cannot be ignored because a small inaccuracy of fhqm will cause a great simulation error of frost heave although i models are more reasonable to simulated ice lenses growth extending them to 2 or 3 dimensions greatly increases the application difficulty before a simple and accurate i model is born incorporating the frozen fringe theory of i models into p models is a good way to compromise the computing capabilities and model realism actually some researchers have been developing this kind models like the pi models in this paper they integrated the frozen fringe mechanism of i model into the hydraulic functions and parameters of p model which is a feasible method but needs further research to improve the accuracy 6 data availability data is available through taylor and luthin 1978 mu and ladanyi 1987 guymon et al 1993 yang and goodings 1998 selvadurai et al 1999a li et al 2018 michalowski and zhu 2006 zhang 2014 liu et al 2019 wu et al 2017 zhang et al 2020 padilla et al 1997 hopke 1980 konrad and shen 1996 nixon 1991 zhou et al 2018 bronfenbrener 2009 sheng et al 1995 teng et al 2020 ming et al 2016 zeng et al 2015 krantz and adams 1996 lai et al 2014b ming and li 2015 zhang et al 2018 and she et al 2018 credit authorship contribution statement sen hao cheng conceptualization data curation methodology writing original draft bernard a engel writing review editing hao xing wu writing review editing pin zhang duan writing review editing yu bao wang funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is jointly supported by the national key research and development program of china 2016yfc0400205 science and technology integrated innovation project shaanxi province of china 2016ktzdny 01 01 and the 111 project b12007 appendix i for saturated soil porosity ratio e and porosity n have relationships with total volumetric water content as 19 e θ w 1 09 θ i 1 θ w 1 09 θ i 20 n θ w 1 09 θ i the volumetric unfrozen water content θw and ice content θi are calculated with sfc used by the models and volumetric total water content after freezing because the local bulk density of saturated soil decreases with water content increase the total water content cannot be calculated by initial bulk density and mass water content the specific gravity of soil particle is constant therefore the volume water content can be calculated as 21 θ w g s 1 w g s where w is mass water content and gs is specific gravity of soil particles appendix ii a thickness of frozen fringe c specific water capacity j kg k cv volumetric heat capacity of soil j m3 k cw volumetric heat capacity of water j m3 k d water diffusivity m2 s dp thermal diffusivity under hydraulic gradient m2 s e void ratio e0 initial void ratio es the void ratio matching maximum pore pressure esep separation void ratio es elastic modulus pa f w source term of water supply kg m3 s gt thermal gradient k m gs specific gravity of soil particles h0 initial height of soil column h height of soil column after freezing hf frost heave displacement h thickness of frozen region ib volume ice content at base of final ice lens i average volume ice content in frozen fringe je convection heat j k hydraulic conductivity cm h lf latent heat j kg m α production rate of α component kg s n porosity n time derivative of porosity 1 s n m parameter decided by curve fitting pw water pressure pa pi ice pressure pa pob over burden pressure pa psep ice pressure when ice segregates pa plh water pressure at a distance of h from the surface of soil particles pa r soil particle radius m sα saturation of α component t time s t temperature c ta a constant ta 273 15 k ttop temperature at top of soil column c tbot temperature at bottom of soil column c ts temperature of ice separation c tf temperature at freezing front c tm the temperature c at which the maximum porosity rate occurs c u displacement variable m vw specific volume of water m3 kg vi specific volume of ice m3 kg vw unfrozen water velocity m s vi ice velocity m s v α r the relative velocity of α component with respect to a moving solid m s vff unfrozen water velocity in frozen fringe m s vh ice lens increase velocity m s wl a parameter related to overburden pressure w mass water content xb the location of base of final ice lens xf the location of freezing front zf displacement of the frozen fringe zf displacement of the soil column surface λ heat conductivity w m k λp heat conductivity of the soil at the frozen fringe w m k λu heat conductivity of the soil at the unfrozen region w m k ρw density of water kg m3 ρi density of ice kg m3 ρd dry density of soil kg m3 θw unfrozen water content θi ice content θsat saturated water content φ water potential pa β thermal stress parameter εv volumetric strain χ a weighting factor σ stress σsl ice water interfacial tension σt ultimate tensile strength of soil σkk the first invariant of the effective stress tensor in the frozen soil ζ a material parameter obtained from calibration γ volumetric weight n m3 
2807,the rapid acceleration of the global water cycle caused by changes in global climate trigger complex processes that make conventional machine learning techniques limited in assessing impacts of such changes on terrestrial water storage tws this study introduces an assimilated deep learning neural network to improve the modeling of tws dynamics key predictors and inputs to this deep learning framework include runoff rainfall soil moisture evapotranspiration global teleconnection patterns and sea surface temperatures ssts the proposed back propagation model in this study capitalizes on the availability of remotely sensed observations and model datasets to predict monthly tws a quantity that is difficult to observe in the field but important for the estimation of regional water budget balance and water resource management for agricultural purposes by integrating pre processed outputs from the principal component analysis pca and independent component analysis ica into our network using a deep neural pattern we synthesized tws from 2002 to 2017 and also made future predictions using our trained models results from these analyses showed that the ica bpnn model has a higher predictive accuracy compared to the pca bpnn these models ica bpnn and pca bpnn were used to fit the three dominant temporal patterns of gravity recovery and climate experiment grace observed tws over africa our simulation results from the testing phase indicate that the fits for the prediction of the first three leading modes of tws for both models when compared to the observed grace tws were pca bpnn1 89 pca bpnn2 82 pca bpnn3 84 and ica bpnn1 93 ica bpnn2 88 ica bpnn3 82 the simulation fit of the bpnn corresponding to multi annual time series which are captured in the second and third orthogonal modes and localized patterns of tws were lower than those of annual signals in both the pca and ica bpnn models this was attributed to the fact that the multi annual time series in grace hydrological signals of our test bed are complex compared to the annual patterns of tws on the one hand this exemplifies the superior performance of our predictive framework in modeling naturalized system annual changes in tws driven by only climatic factors on the other hand the complexity in modelling multi annual variations in tws suggests heavily disturbed naturalized systems evidenced in the presence of human water management operations among other anthropogenic activities keywords deep learning neural network nino 3 4 terrestrial water storage bpnn data availability data will be made available on request 1 introduction in today s contemporary society there has been an increase in the application of machine learning theories to hydrological and climatic analysis the ability of these machines to think and act with less human interventions has resulted in heightened efficiency and accuracy in relating non linear climatic datasets and reporting on their influence directly on our planet and indirectly on our daily lives even without these machines being explicitly programmed the concept of machine learning however limits system performance to exclusive machine operations thus allowing them to still think and act as machines kalu et al 2022a the advent of deep learning operations led to a more sophisticated approach to machine learning and is able to address the challenges of the latter because they have been specifically modeled after the human brain therefore an assimilation of both machine and deep learning operations promises to show notable progress in monitoring the multi scale climatic influences on sub regional and continental hydrology using coupled relationships between surrounding oceans and land water storage e g ndehedehe et al 2017 by employing this assimilated deep learning approach we attempt to learn the implications of the dynamic land ocean atmosphere interaction hart et al 2019 reason jagadheesha 2005 localized hydrological operations ndehedehe et al 2017 andam akorful et al 2017 paz et al 2008 and other multi physical trends giannini et al 2008 sheffield wood 2008 oguntunde abiodun 2013 nicholson 2013 on total water storage tws whose deficit or surplus could result in extreme climatic conditions that negatively impacts on the biodiversity terrestrial and aquatic ecosystem as well as atmospheric balance of our environment druyan 2011 in this era of artificial intelligence data driven stochastic techniques have witnessed enhanced accuracy over physically based techniques in hydrological interactions this is easily discerned in the operation of data driven techniques towards parameter estimations calibration procedures and its efficiency in handling different sources of uncertainties better than their physically based counterparts the simplicity and robustness of these techniques in hydrological studies have been widely reported in recent literatures e g sun et al 2019 yu et al 2021 data driven techniques such as boosted regression trees naghibi et al 2016 gene expression programming shah et al 2021 support vector machines rehana 2019 random forest and m5 trees ardabili et al 2019 as well as neural networks oyebode stretch 2019 nourani et al 2019 have been widely applied in hydrological and climate studies neural network is an artificial intelligence algorithm which was inspired by the functioning of the human nervous system gurney 2018 the strength of this network lies in its ability to properly operate disorderly but all inclusive information even without needing strong model assumption it has also been observed to have strong self learning modes good non linear approximations and self adaptive abilities the back propagation bp neural network training algorithm is one of the most popular techniques for forecasting given its powerful problem solving ability its application has been noted in relevant fields such as medicine dimililer 2013 al shayea 2011 finance liang wu 2005 liu wang 2011 accounting olson mossman 2003 koh tan 1999 and even in the earth sciences pradhan et al 2010 pradhan lee 2010 when the bp neural network is applied in any forecast algorithm the related factors which are correlated and contain a large amount of noise embedded in the system are always of large concern okwuashi et al 2021 due to the potential underfitting or overfitting problems noticed in these algorithms it is always pertinent to eliminate the correlation and noise among the input data as much as possible this can help enhance the quality and performance of the bp model as well as its prediction accuracy the use of neural networks in climate prediction studies water resources management research and stream flow forecasting are emerging chang chang 2006 house peters chang 2011 maier et al 2010 moradkhani et al 2004 coulibaly et al 2000 they have also been applied in grace derived tws precipitation and temperature data sun 2013 population and irrigation dataset feng et al 2008 variable pumping and weather conditions coppola jr et al 2007 coppola jr et al 2005a b chu chang 2009 as well as in situ hydro meteorological observations coulibaly et al 2001 the study undertaken by ahmed et al 2019 used the similar approach of nonlinear autoregressive with exogenous input narx neural network model in forecasting grace derived tws however the authors dwelled majorly on hydrological products rainfall evapotranspiration temperature and normalized difference vegetation index and used them as tws drivers but did not encompass the effects of global climatic indices sst sea surface temperatures and teleconnection patterns in their analysis the understanding of climate teleconnections also extends to the sub regional meteorological processes given its impact on atmospheric and weather patterns redelsperger et al 2006 polo et al 2008 losada et al 2010 rodriguez fonseca et al 2011 andam akorful et al 2017 the knowledge of climate teleconnection s influence on tws is critical especially as a result of tws being a hydrologic state parameter integrating important hydrological processes such as groundwater infiltration and recharge kalu et al 2022b an in depth analysis of this concept provides insights on water resource managements wet conditions heat waves and even potential drought conditions previous attempts in modeling this processes have dwelled on the impact of these global hydrological indices on the dynamics of global mean sea level merrifield et al 2012 precipitation index dinezio tierney 2013 and even tws anyah et al 2018 ndehedehe ferreira 2020 ndehedehe et al 2017 de linage et al 2014 as was argued by ndehedehe et al 2017 the 8 year grace data implemented in the study undertaken by philips et al 2012 was restricted and did not accommodate an adequate enso recurring duration given that enso has an energy cycle of 2 5 years furthermore the independent component analysis ica algorithm employed in the teleconnection definition between the model input and output variables in estimating grace derived tws over west africa were found to be insufficient in describing the full observation parameters forootan et al 2014 the studies undertaken by ndehedehe et al 2017 and anyah et al 2018 on the footprints of teleconnection influence on tws only dwelled on the hydrological impact of the climate teleconnection on grace derived tws using the well known ica and multi linear regression these studies did not make notable predictions and estimations that can guide hydrologists in decision making the need for more accurate predictions of tws to adequately manage extreme climatic conditions such as drought and flooding at large continental scales is a strong motivation behind this study in our experiment complex and multi layered deep neural patterns are developed to allow data to be passed between nodes like neurons in highly connected ways this results in a non linear transformation of the input climatic and hydrological datasets which is becoming increasingly abstract as a result of climate change and human interventions on their cycle however prior to this operation the original input datasets which consists of hydrological fluxes ssts and global teleconnection patterns are pre processed using unsupervised statistical decomposition techniques principal component analysis pca and independent component analysis ica to be able to extract their combined dominant patterns and use them in tws estimation also by integrating this third pca and fourth ica order statistics to our neural network we highlighted the impacts of climate variability hydro climate drivers land surface processes and atmospheric circulation systems in tws dynamics therefore in this study we aim to develop an assimilated deep learning framework to predict the impact of sst based hydrological indices on tws using an improved bp based model in this manuscript the ica and the pca are integrated into the well known back propagation neural network bpnn algorithm for the prediction of grace derived tws time series and are subsequently referred to as the ica bpnn and pca bpnn model respectively these models are employed to assess the impacts of these climatic drivers as well as quantify their relative contributions to tws dynamics this study specifically seeks to i develop a deep learning framework to reconstruct climate driven tws with ica bpnn and pca bpnn models using global indices and sst datasets as well as other localized hydrological products such as precipitation evapotranspiration runoff and soil moisture datasets ii investigate the association of multi global climate teleconnection indices on regional tws and highlight the influence of localized hydrological fluxes in modeling tws and iii assess the impacts of key climatic drivers on the temporal and spatial distributions of grace derived tws 2002 2017 these climate drivers are functions of four localized hydrological fluxes i e precipitation evapotranspiration runoff and soil moisture seven prominent sst products of the nearby oceans i e north tropical atlantic nta south tropical atlantic sta east tropical atlantic eta nino 1 2 nino 3 0 nino 3 4 and nino 4 and five global climate teleconnection patterns e g enso north atlantic oscillation nao atlantic multi decadal oscillation amo pacific decadal oscillation pdo and the indian ocean dipole iod our methods pioneer deep learning applications in diagnosing influence of climate teleconnection on terrestrial hydrology on a continental scale by i predicting grace derived tws using an integrated statistical and neural network model ica bpnn and pca bpnn and ii utilizing varied sst and global climate teleconnections datasets as well hydrological products as basic climatic drivers in the regions tws the remainder of this study is segmented as follows section 2 provides a brief introduction of the study region highlighting its role in large scale mesoscale convective interactions with the nearby oceans section 3 gives a thorough discussion on the data and techniques employed we perform and interpret and discus the analysis in section 4 and finally concluded in section 5 2 study region africa is a region with highly variable climate conditions ranging from tropical to semiarid and arid the continent is home to extremely wet river basins i e congo river basin and considerably drier regions i e north africa where the impact of geodetic perturbations such as land subsidence has been reported in recent times cigna tapete 2020 cian et al 2019 rateb hermas 2020 kalu et al 2021b c the hydrological dynamics of the region is mainly driven by soil moisture content runoff evapotranspiration index and precipitation patterns which makes it an ideal test bed for our analysis the main source of precipitation over a large portion of the continent is driven by monsoon systems and has a significant relationship to large scale pattern of ocean atmosphere land interactions giannini et al 2008 this has in turn affected the availability and allocation of freshwater resources in the region over the past few years supporting information 3 in africa freshwater resources are largely found in lakes aquifers watersheds floodplains or wetlands these resources are highly susceptible to natural variabilites climate change and anthropogenic interventions ahmed et al 2014 agutu et al 2017 ndehedehe et al 2017 kalu et al 2021a the climatic condition of the tropical african region is largely governed by convection with the seasonal migration of the tropical rain belt influencing its precipitation patterns potts 1996 the dynamics in the seasonal positioning of the rain belt causes insolation changes thereby resulting to the occurrence of rainfall in the northern southern region during the austral boreal summer nicholson 2017 also the studies of nicholson and selato 2000 and pausata et al 2017 suggests that the african climate is highly susceptible to variations in the walker circulation which is largely demonstrated in the enso processes enso is largely dominant in the equatorial pacific ocean fig 1 it originates from sst anomalies in the region whose changes influence the atmospheric walker circulation patterns thereby altering the strength and location of tropical convection cells hart et al 2019 the propagation of these enso events around the globe are due to the coupled ocean atmosphere system which are propelled by the kelvin and rossby waves pausata et al 2017 eventually reaching the african region the east west trend moisture gradient across the continent is largely affected by the variations in the enso state de oliveira et al 2018 nash et al 2016 this however results in opposing dry and humid climatic conditions between the eastern and western african region during el nino western africa experiences drier climatic conditions than eastern africa and vice versa during la nina events for example during el nino periods eastern africa is noticed to have significant positive anomalies in precipitation patterns of up to 200 mm per year 60 in relation to the yearly precipitation budget during the la nina years whereas western africa encounters a 20 to 40 reduction during this period fer et al 2017 moore et al 2017 these dynamic spatio temporal precipitation changes in africa and its modern driving mechanisms on longer time scales can also be said to be as a result of variations in atlantic meridional overturning circulation waxing of global ice sheets as well as the growing concentration of aerosols and ghgs in the regions atmosphere trauth et al 2005 castañeda et al 2009 dinezio et al 2018 regardless the interplay of these complex driving mechanisms on orbital time scales as well as their corresponding pan african impact on precipitation intensity frequency and patterns still remain ambiguous 3 data 3 1 total water storage from grace the use of the grace derived tws in hydrological research and monitoring has garnered substantial attention over the years its role as a vital tool in sub surface water storage assessment groundwater evaluations and aquifer system processes has been overly explored in recent studies ndehedehe et al 2017 kalu et al 2021a swenson and wahr 2007 famiglietti et al 2015 ndehedehe and ferreira 2020 ndehedehe et al 2019 the grace mission operates at an altitude of 450 km and an inclination of 89 50 it is made up of two low earth orbiting satellites in the same orbital plane the separation of the two satellites is accurately determined by a k band ranging system and the position of each of the twin satellites is established by gps receivers onboard the spacecraft tapley et al 2004 we used the monthly grace products from the university of texas center for space research csr sh to compute tws fields covering april 2002 to june 2017 to assess land water storage over the african region the grace mass concentration solutions mascon blocks were down sampled to a spatial resolution of 0 5 by 0 5 degrees this helped in averaging of the regional cells which were still restricted to the 300 km nominal resolution of the grace the csr mascon approach uses an intermediate solution for the determination of a time variable regularization matrix to estimate the mascon solution this allows the construction of a time variable regularization based solely on the grace data save et al 2016 and ndehedehe and ferreira 2020 explained the essence of this regularization which is key in preventing the mission s signals leaking into the nearby oceans these operations simplify the application of the grace derived datasets in various hydrological and water resource management problems extended details regarding the grace mascon derivation solutions and performance metrics can be found in watkins et al 2015 the mascon dataset applied in our analysis was downloaded from http www csr utexas edu grace rl05 mascons html in its release 05 rl05 the application of grace mascons in global freshwater analysis is increasingly gaining more grounds especially given its simplicity in the implementation of different geophysical constraints to help filter out noise from the level 2 grace dataset wiese et al 2016 the mascon solution arguably provide results homogenous to other global grace products even without performing complex pre processing operations like smoothing and de stripping ndehedehe and ferreira 2020 3 2 satellite precipitation monthly generated trmmv7 3b43 rainfall parameters from april 2002 june 2017 from the national aerospace and space administration nasa goddard space flight center gsfc merged with the integrated multi satellite retrievals for global precipitation measurements imerg were used for this study this was applied in the examination of spatial and temporal inconsistencies in the region given rise by the actions of the sst of climate teleconnection patters dominant in the study area the trmm 3b43 imerg is used to establish the monthly rainfall approximations of the spatio temporal resolutions at 0 25 by 0 25 degrees huffman et al 2007 a large overestimation in the tropical rainforest region of africa over the trmm rainfall radar is ascertained in december january february and in march april may and a minimized bias in june july august and september october november by applying the zonal mean analysis kalu et al 2021a regardless the bias which is relatively sharp for all models in the dry seasons when rainfall is nominal is less prominent in the dry seasons of the african tropical regions it was necessary to rescale the trmm imerg rainfall dataset https disc gsfc nasa gov datasets trmm 3b43 7 summary in a bid to maintain and preserve a consistent spatial resolution with the other datasets e g grace derived tws used in this study 3 3 evapotranspiration remote sensing products are the most practical and feasible means of obtaining spatially distributed evapotranspiration et information over any terrestrial surface the evapotranspiration dataset utilized in this study was made available by the numerical terradynamic simulation group ntsg university of montana modis16a2 global et monthly datasets https modis gsfc nasa gov data dataprod mod16 php from 2002 to 2017 were obtained over a temporal period of 8 days at 0 5 km pixel resolution this et estimates are pre processed products based on the penman monteith equation monteith 1965 and encompass the influence of evaporation from the soil wet canopy and plant transpiration at dry canopy surfaces mu zhao and running 2011 3 4 monthly runoff in a given region tws change δtws represents integrated contributions from precipitation et as well as surface and sub surface runoff via the terrestrial water balance equation chen et al 2020 this shows the impact of monthly runoff in regulating tws dynamics in tropical regions the global runoff data center which provided the monthly runoff dataset used in the experiment https www bafg de grdc operates under the auspice of the world meteorological organization and provides river discharge data of nearly 9000 gauging stations from all over the world it is updated continuously and contains daily and monthly discharge data and can even be used for the verification of atmospheric and hydrologic models this product is generated with an underlying precipitation climatology which is readjusted whenever the observed runoff surpasses the input precipitation and contradicts the terrestrial water budget equation for our study period we averaged runoff data for the four major river basins over our study region i e nile congo niger and zambezi river basins by including monthly runoff estimates as part of our predictors fig 1 we aim to strengthen the performance of our machine learning framework in analyzing hydrological conditions over our test bed 3 5 terraclimate soil moisture terraclimate is a monthly climate and climatic water balance for global terrestrial surfaces it utilizes climatically aided interpolation integrating high spatial resolution climatological normal from the worldclim dataset https www worldclim org with coarser spatial resolution but time varying data from cru ts4 0 https data ceda ac uk badc cru data cru ts and the japanese 55 year reanalysis jra55 https jra kishou go jp jra 55 index en html theoretically the process implements interpolated time varying anomalies from cru ts4 0 jra55 to the high spatial resolution climatology of worldclim to generate a high spatial resolution dataset that covers a broader temporal record to aid our understanding of the influence of soil moisture estimates in the hydro meteorological interactions of multi scale climatic system as well as the role they play in regulating tws we also included soil moisture datasets in our original predictors fig 1 soil moisture plays an important role in the studies of land surface hydrological processes and monitoring of climatic events in tropical regions fan van den dool 2004 ndehedehe et al 2018 their impact on tws however varies based on soil type low level wind temperature and moisture with precipitation and downward radiation asides land water storage processes these components also play significant roles in the surface model behavior of soil moisture contents in tropical regions monthly terraclimate soil moisture data at 0 50 grid for the period between april 2002 to june 2017 was used in this study to improve our deep learning estimation of hydrological operations on continental tws 3 6 teleconnections and sea surface temperature products an overview of the entire datasets used in this study is highlighted in table 1 below more details regarding the teleconnection and sea surface temperature datasets can be found in supporting information 1 4 methodology 4 1 back propagation neural network bpnn the bpnn model applied in this study is used to derive relationships between the grace derived tws on one hand and hydrological fluxes teleconnections and ssts on the other hand the bpnn employs a probabilistic approach in its optimization in relation to the artificial neural network ann it has an explainable learning process flexible topological framework and minimizes possible over fitting see supporting information 2 in addition to their capability in minimizing over fitting the bpnns are multilayer feed forward neural networks which allow a unidirectional information flow some literatures refer to it as a multilayer perceptron procedure e g park et al 2015 this framework links the tws predictors fig 1 with the response variables through a series of successively arranged hidden layers which are made up of non linear elements called neurons the available neurons in the hidden layers initiate new variables based on the predictors from the previous layer which is multiplied with a variable specific weight factor and the addition of a bias term the use of the major hydrological fluxes of our test bed as a predictor was intended to reflect the swift response of surface flood related and groundwater drought related to hydrological effects across the african continent the influence of global teleconnection patterns and ssts on tws has been corroborated by several studies ndehedehe et al 2017 2018 ndehedehe ferreira 2020 ocean atmospheric coupling in the tropical atlantic has been identified as a key regulator of hydrological variability within several nearby river basins and sub regions de linage et al 2014 molinier et al 2009 and zeng et al 2008 also reported that the harsh 2005 and 2010 drought in the central and western amazon were the consequences of warmer tropical north atlantic sea surface temperatures ssts that stimulated northward shift of the itcz and minimized easterlies and moisture advections from the tropical north atlantic to the western and southern regions of the amazon during austral summer de linage et al 2014 therefore their use as tws predictors in this study is justified three combinations of these predictors were tested in this study the first consists of four most dominant hydrologic fluxes in the region i e precipitation evapotranspiration runoff and soil moisture products the second combination includes six sst variants i e nino1 2 nino 3 0 nino3 4 nino4 nta sta and eta and the third combination consist of four teleconnection parameters i e enso nao amo pdo and iod our modeled bpnn is a typical three neuron layer framework with one input layer 16 neurons four sets of hidden layers 6 neurons for each set and an output layer 1 neuron fig 2 the bpnn framework fig 3 allows network neurons from one layer to connect to all the neurons in subsequent layers but with no lateral links within any layer or the possibility of feedback connections apart from the input neurons i e x1 x16 which only links one input value with its corresponding weights wp 1 wp 96 the net input for each discrete neuron can be said to be the total of all input values each multiplied by its weight and a bias term zp which can be referred to as a unit weight from an auxiliary input goethals et al 2007 1 h p 1 i 1 n w p 1 x i z p h q 1 f h p 1 2 h q 1 i 1 n w q 1 h p 1 z q h r 1 f h q 1 3 h r 1 i 1 n w r 1 h q 1 z r h s 1 f h r 1 4 h s 1 i 1 n w s 1 h r 1 z s y p q r s f h 4 where p q r s 1 6 n 16 with eqn 1 to 4 being models of the first to fourth hidden layers respectively the output value y p q r s can be calculated by feeding the net input and the parameters from the hidden layers into the transfer function of the neurons 5 y p q r s f h 4 where h p 1 h q 1 h r 1 h s 1 represents neurons in the first to fourth hidden layers respectively w p 1 w q 1 w r 1 w s 1 are the varying weights originating from the input parameters to the fourth hidden layers respectively z p z q z r z s represents the supplementary weight implemented for better predictions for the first to last hidden layers respectively h 4 depicts a summation of the first to fourth hidden layers while y p q r s is the output which is directly a function of the fourth hidden layer but indirectly a function of the entire bpnn model when developing multi layer perception ann models a rule of thumb is that the number of neurons in the hidden layer must be about half the number of the input layer parameters and should not be more than twice as large long et al 2014 berry linoff 2004 therefore we set the number of hidden neurons to 6 for each of the sets through a trial and error method where bpnns having different numbers of different neurons were tested eqn 4 is subsequently distributed to a transfer function to compute outputs eqn 5 from the hidden neurons connections from the sets of hidden layers to the outputs layer are generated from a linear transfer function 6 grace t w s c s 1 6 w j p q r s z p q r s w j 0 our generated output predictand is the monthly total water storage changes twsc observed by the grace mission subscript j in eqn 6 represents the number of output neurons which in this case is 1 w j p q r s and w j 0 are the varying weights and the bias term of the output layer respectively our bp network was useful in solving the unknowns in eqns 1 to 4 and eqn 6 especially as it focused on the backward propagation of fitted uncertainties through the network to generate optimal weights for second and third layers fig 2 grace derived tws datasets from april 2002 june 2017 totaling 183 months were used for the entire experiment the first 80 of our grace dataset ranging from april 2002 may 2014 was used for the training and validation of the bpnn model while the last 20 ranging from jan 2014 june 2017 was used to test the performance of the trained bpnn model 4 2 principal component analysis pca pca has been widely applied in many data science problems for dimensionality reduction and feature extraction ziehe 2005 ndehedehe et al 2016b it basically works by statistically decomposing a given dataset into numerous dimensions while retaining interpretability and diminishing data loss the popularity and relevance of this statistical technique in climate science is majorly as a result of its proficiency and simplicity in the elucidation of optimized variance parameters even with a minimal number of principal components ndehedehe et al 2016a pca gives the best potential depiction of a p dimensional dataset in q dimensions by trying to amplify the variance in q dimensions the increasing trend in the statistical depiction of periodic signals integrated in multi resolution dataset has resulted in the implementation of the well known pca technique in several vital research areas which includes machine learning image processing bioinformatics or web data analysis as well as the analysis and regionalization of global geophysical time series information montazerolghaem et al 2016 ivits et al 2014 due to the ability of the pca model to linearly combine centered variables given the units of the corresponding parameters are the same motivated its integration into the bpnn framework for prediction purposes pca plays a key role in the rotation of space coordinates which has minimal impact on its data structure therefore the obtained pcs which are the linear combination of variables are known to replicate the fundamental datasets to the greatest degree and are uncorrelated with each other with the assumption that our data matrix has m variables x 1 x 2 x 3 x m 7 x x 11 x 12 x 1 m x 21 x 22 x 2 m x n 1 x n 2 x nm and n times observations in our experiment we normalized the input layer parameters by using the following method 8 y ti x ti x t s t where x t 1 n t 1 n x ti and s t 1 n 1 t 1 n x ti x t 2 for ease and convenience we still denote the normalized y ti as x ti let the eigenvalues of covariance matrix of normalized data be given by λ 1 λ 2 λ m 0 also we assume α 1 α 2 α m to be the equivalent eigenvector the ith principal component is such that f i α i t x where i 1 2 m usually λ k i 1 m λ i is known as the contribution rate of the kth principal component and i 1 k λ i i 1 m λ i is known as the aggregate contribution rate of the first k principal components the first k principal component is assumed to contain the most information of m original variables if the aggregate contribution rate goes beyond 85 liu wang 2011 4 3 independent component analysis ica the ica explores higher order statistical methods that apply statistical moments higher than first order ndehedehe et al 2016b it employs a statistically based identification algorithm to evaluate directional vectors in the form of independent models from a data matrix cardoso 1999 the technique estimates the undetermined dynamics of a system by rotating empirical orthogonal functions aires et al 2002 basically ica decomposes the time series of the given data matrix into a variety of statistically independent root indicators and a mixing matrix as illustrated in ndehedehe et al 2017 assume the measured indicator x t is a zero mean data vector measured at time t and the root indicator s t is a zero mean vector having independently mutual elements such that x t z s t where z is a full rank linear mixing matrix the technique implements a linear transformation as 9 y w t x t w t z s t a t s t so as to determine the solution of the ica model given that a z t w w represents an estimator of a row of the matrix z 1 and y is a linear combination of s i with a i showing the weight since the two independent random parameters tends to the gaussian distribution than the original parameters a t s maintains a better proximity to the gaussian distribution than any s i let w be a maximizing quotient of the non gaussian distribution of w t x this therefore implies that w t x a t s is equivalent to one of the independent parameters negentropy is implemented as a quantitative assessment of the measure of the non gaussian of a random parameter y this concept has a significant relationship to the original entropy which has been used substantially in information theory the entropy of a random parameter can be explained as the information degrees of a given observe variable liu wang 2011 the negentropy j is defined by 10 j y h y gauss h y where h y represents the entropy given by h y p y log p y d y p y is the probability density while y gauss is a gaussian random vector which has an equal covariance matrix with y the negentropy is always less than zero however the only condition for it to be zero is if and only if y follows a gaussian distribution for the estimation of negentropy the approximate computation technique is usually implemented which is given as 11 j y c i e g i y e g i v 2 where c i represents some positive constants v is a gaussian parameter with unit variance and zero mean and g i represents some non quadratic functions this procedure regardless does not guarantee an accurate approximation therefore with the integration of a non quadratic function g we modify the approximation to 12 j y e g y e g v 2 where g y e y 2 2 if the indicators are reiteratively monitored the measured indicators are denoted as original indicator matrix xic when the matrix w the discrete matrix is the inverse of the mixing matrix z the independent component matrix 13 y w x i c has the potential of estimating root indicators s where one row of matrix y represents independent vectors this study however applies the ica technique based on a fixed point algorithm to solve the independent matrix y 1 additional details regarding the numerical steps mathematical formulations and computational routines of the ica technique have been documented in these literatures e g ziehe 2005 theis et al 2005 cardoso 1999 common 1994 4 4 pca bpnn model the bpnn requires a coarse correlation fit for the original 16 input variables table 2 because a good correlation between them signifies that they are composed of more repeated information and as such may result in the reduction of the prediction accuracy of the model while increasing the computational complexity of the entire process liu wang 2011 however our independent variables have been earlier shown to contribute substantially to the fluctuations of the tws in their own peculiar modes the pca technique was applied to the 16 input parameters which have been grouped into hydrological fluxes teleconnection patterns and ssts to generate new variables for the prediction model as follows step one normalize the independent parameters the input layer consists of the independent parameters with varying orders of magnitude therefore it is pertinent to normalize each of the parameters before applying the principal component analysis yang et al 2009 14 x i x i m a x x i the function expressed in eqn 14 attempts the normalization at 0 1 step two the correlation coefficient matrix r is obtained using the normalized data from step one 15 r r ij 16 16 r ij 1 n i 1 n x ii x ij i j 1 2 16 the function expressed in eqn 15 attempts the generation of the r values step three using the generated r values from eqn 15 we compute the characteristic vector and characteristic value and determine the corresponding principal components the monthly temporal patterns of the input parameters from april 2002 june 2017 yield 183 characteristic values λ i i 1 2 183 λ i represents the variance of the principal components the λ i values are arranged in a decreasing sequence λ i λ 2 λ 183 0 as well as their corresponding characteristic vectors l 1 l 2 l 3 l 183 so that the ith principal component can be determined by applying the function 16 y pc i l 1 x l i 1 x 1 l i 2 x 2 l i 16 x 16 where i 1 2 16 step four sum the orderly sets of principal components to allow the accumulated input rate of the variance a i 1 m λ i 1 m λ i to exceed a certain threshold for this study we choose 99 the principal components is computed as y pc 1 y pc 2 y pc 3 y pc m m 184 for every discrete value λ i i 1 2 183 and y pc i i 1 2 m as a linear integration of x i we now take the m principal components as the input parameters for our bpnn model this results in inputting the newly determined m principal components into the bp network and then with the aid of the pca bpnn model we make our optimized predictions 4 5 ica bpnn model for the proposed ica bpnn model fig 3 the independent components of the original 16 input variables are first extracted using the ica technique the discrete independent component ic components of the parameters are characterized by the feature of the original datasets the noisy ic which is regarded as the least effective information of original dataset is also identified in the training after the identification and removal of the noise ic the remaining ic components are used as the input of the bpnn mode recall that from the pca method the generated pcs were only eliminated by correlation however the generated higher order statistics with the ica are independent of each other liu wang 2011 in statistical theory it is believed that independent is a more robust condition than uncorrelated this however is uncovered in the prediction accuracy of the two techniques the basic procedure in this model is to uniquely detect the noise ics after the generation of the latent ics this study however adopts the testing and acceptance tna procedure see cheung xu 2001 liu wang 2011 in solving this problem each of the input variables is considered as a row given the 183 monthly dataset of the 16 original input parameters we derive a matrix x ic of size 16 183 by the ica method explained in eqn 11 the separate matrix w and the independent component matrix y can be generated each row of y the yi of size 1 400 represents an ic each ic represents has been observed to represent different features of the original input layers from previous studies liu wang 2011 we now employ the tna technique in identifying the noise ics the obtained m ics are considered prior to the introduction of the tna we excluded one ic for each iteration and used the remaining m 1 ics to reconstruct the original input matrix let the excluded ics be represented by y k and the reconstructed original input variables be represented by x r 17 x r i 1 i k m a i y i 1 k m where x r x 1 r x 2 r x m r t x i r represents the ith reconstructed variable a i depicts the ith column vector of mixing matrix a which is the inverse of the separate matrix w eqn 9 while y i is the ith ic considering the cases k 1 2 m which entails the repetition of m iterations with the exclusion of one ic we introduce the well known relative hamming distance rhd in estimating the reconstruction error between the priori original and apriori reconstructed parameters which is given as 18 rhd 1 n 1 i 1 n 1 r i t r i t 2 where r i t s i g n a i t 1 a i t r i t s i g n pr i t 1 pr i t in this modeling s i g n p a r a m 1 if param greater than 0 s i g n p a r a m 0 if param 0 and s i g n p a r a m 1 if param 0 also a i pr i and n depicts the actual value the predicted value and the total number of data points respectively with the rhd reconstruction error it is possible to estimate the comparison between the original input parameters and their corresponding reconstructed parameters the rhd shows a higher similarity between the original and corresponding reconstructed parameters if the value is closer to zero conversely when the rhd value is farther from zero it explains that the eliminated ic contains more vital and effective information of the original dataset while depicting the low similarity between the original and reconstructed parameters it is pertinent to find out the reconstruction which guarantees the rhd value closest to zero as it tends to make the most accurate predictions in allusion to the original 16 parameters table 3 represents the rhd reconstruction errors of each iterate table 3 shows that the value of rhd which is reconstructed by using ic1 ic2 ic3 ic4 ic5 and ic6 and eliminating ic7 is the smallest it is deduced that the ic7 contains the least information and ic7 represents the noise ic therefore ic1 ic2 ic3 ic4 ic5 and ic6 were conducted as the input of the proposed ica bp model while ic7 was removed from our training fig 3 4 6 initialization in this exercise a back propagation neural network containing three fully interconnected layers input hidden and output is considered the last neuron of the input and hidden layers is considered a bias node having a resultant output equivalent to 1 assuming the input layer is characterized by available p patterns for the network training then we can represent the totality of the input parameters as an n 1 matrix having p rows and n 1 column with all records of the last column equaling 1 analogously the target dataset can be composed by a matrix w having p rows and m columns supporting information 4 the weights between the neurons in the input and hidden layers form a matrix w with entries w 1 j j i 1 n j 1 n 1 where each discrete w 1 j j interacts with ith neuron of the input layer with the jth neuron of the hidden layer this therefore results in the representation of the hidden layer output as a hidden o u t f 1 w 1 a input i n given that a input i n depicts the transpose of the input matrix similarly the interaction between the neurons weights in the hidden and output layer births a matrix w 2 i j i 1 m j 1 n 1 given that each discrete weight w 2 i j connects the jth neuron of the hidden layer with the jth neuron of the output layer this signifies that from the input through to the output layer the interaction can be represented by the matrix a o i n with n 1 rows and p columns the optimal initial weights of the proposed bpnn with four hidden layers can be evaluated further through minimization as it results in a linear least square problem using the qr factorization technique based on the householder reflections or singular value decomposition algorithm the solution to the linear least squares problem can be obtained containing the optimal weights linking the four hidden layers to the output layer supporting information 4 more details on this procedure can be found in qadir et al 2020 chow cho 2007 4 7 machine learning framework the accuracy index of any technique is usually measured by the trade off amount between calculation interval and performance the bpnn has gained substantial popularity as an optimal training algorithm for prediction studies see maier and dandy 2000 cherkassy and lari najafi 1992 its robustness and ease in implementation make it often preferred to other neural network models for predictions when a sufficient number of relatively noise free parameters are used as input the bpnn network proves to be a superior learning method regardless of the complexity of the specific domain problem walczak cerpa 1999 inasmuch as the bpnn has been prided to have the ability of withstanding noise in the training dataset during its training too many errors in the training may prevent the neural network from learning the desired model goethals et al 2007 walczak and cerpa 1999 recommended the implementation of other learning methods in the case of very few or extremely noisy training datasets algorithms such as the radial basis function networks and the counter propagation networks has been reported to perform well in domains with limited training datasets as well as insufficient and noisy input parameters walczak cerpa 1999 fausett elwasif 1994 barnard wessels 1992 it is noteworthy to point out that the performance of the pca and ica bpnn algorithms is optimized if the operation of several input functions such as the learning rate momentum term error and transfer function is superlative maier and dandy 2000 suggested that the sigmoid transfer functions are one of the most frequently used which includes the hyperbolic and logistic tangent functions the use of other functions such as the linear functions or hard limit functions has also been reported in past studies hagan et al 1997 the error function is the function that is minimized during the training process goethals et al 2007 the mean square error function is the most commonly used error function however an independent and normal error distribution is recommended so as to obtain optimal results this however is not usually the case when the training datasets are heavily composed of outliers maier and dandy 2000 liano 1996 proposed the least mean log squares lmls error function to overcome this problem the learning rate has a direct proportion with the size of the steps taken in the weight index basically learning rates are fixed during the training process and with the use of trial and error methods the optimal learning rates are determined a momentum term is usually integrated into the training algorithm so as to improve convergence rate hagan et al 1997 and learning speed qiann 1999 if the momentum term is greater than 1 0 the training procedure will never converge dai macbeth 1997 this therefore resulted in the suggestion of a learning rate of 0 7 with a momentum range of 0 8 to 0 9 or a learning rate of 0 6 with a momentum of 0 9 by dai macbeth 1997 qiann 1999 on the other hand determined the bounds for the convergence on momentum parameters and learning rate and displayed that the momentum term can enhance the index of learning rates over which the model converges goethals et al 2007 4 7 1 number of hidden layers an increased number of hidden layers allow a neural network to enhance its closeness of fit whereas a smaller number improves the smoothness or extrapolation proficiency of the network walczak cerpa 1999 a neural network with one hidden layer can be likened to perform linearly and has the capability of estimating any function as long as the hidden layer consists of sufficient functions however some studies suggest initiating with at least two hidden layers flood kartam 1994 our study however implemented the trial and error method to determine the optimal number of hidden layers which was based on the experience of the dataset this strategy was implemented because of the highly problematic dependence of many optimal network geometries 4 7 2 number of hidden neurons the number of neurons in the input layer is largely determined by the number of model inputs while the number of neurons in the output layer is equivalent to the number of model outputs however the choice of the number of neurons in the hidden layer s is also a crucial aspect in the determination of the training accuracy index few hidden neurons provide faster training but results in scarce feature detectors while more hidden neurons result in longer training period bebis georgiopoulos 1994 for example if two homogenous networks having similar errors on the training datasets with varying hidden layers are compared the one with few hidden units is likely to produce a more reliable prediction on new cases whereas the more complex one while diminishing the model s ability to generalize on new datasets also has an increased chance of over fitting on the training dataset özesmi özesmi 1999 hung et al 1996 the study undertaken by hecht nielsen 1987 reported that any continuous function with xi inputs in the range 01 and xo outputs can be denoted by a feed forward procedure having 2xi 1 hidden neurons other studies have also proposed the rule of thumb in the determination of the quantity of neurons in the hidden layer while some are based on the number of existing training samples others are focused on the number of input and or output neurons available for the exercise the pioneering rules that suggest the number of hidden neurons as a function of the quantity of input and or output nodes are given in supporting information 5 other studies have also attempted to base the number of training samples nts on the number of connection weights available in the network if the training sample quantity has been fixed an indication of the optimal parameters of connection weights to avoid over fitting can only be achieved by inverting these rules shown in supporting information 6 using the number of connection weights and the number of input and output neurons it is possible to estimate the number of hidden neurons given the divergent nature of the rule of thumb procedure which was actually used in our exercise it was pertinent to consider the number of training samples nts derived after decomposition table 3 and the number of input parameters xi which was the same for both the pca and ica bpnn models for example if only one hidden layer is to be used then the number of connection weights should not be more than nts 0 1 and the number of hidden neurons should not be less than xi xo 0 5 theoretically one sure way of meeting these two conditions is to have a relatively large number of training datasets walczak cerpa 1999 on the other hand suggested that the number of hidden neurons in the last layer should be equivalent to the number of decision factors utilized by domain connoisseurs in attempting the solution of the problem decision factors are the discernable constituents that make up the distinct categories of the input vector system it is largely determined by the number of heuristic rules or clusters utilized in an expert framework goethals et al 2007 alternatively other techniques that promise automatic configuration of hidden layer and neurons parameterization may be utilized see anders korn 1999 nabhan zomaya 1994 bartlett 1994 4 8 deseasonalization of grace derived terrestrial water storage and its multivariate analyses in relation to climate modes we adopted the strategy of eliminating trends and harmonic components of the grace hydrological signals i e deseasonalization so as to properly evaluate the footprints of global climate modes in grace derived tws over the african continent our analysis made use of the residual from deaseasonalization hereafter referred to as dtws in the individual assessment of each independent component the harmonic components and tws trends were compartmentalized from the grace time series using the procedures adopted from ndehedehe et al 2017 this was executed through the parameterization techniques based on the multi linear regression technique kalu et al 2021a ndehedehe and ferreira 2020 19 y m n t ρ 0 ρ 1 t ρ 2 sin 2 π t ρ 3 cos 2 π t ρ 4 sin 4 π t ρ 5 cos 4 π t ρ 6 n t φ n e t where the grid locations are represented by m n the time in years is t the constant offset and linear trend is shown by ρ 0 and ρ 1 respectively the annual signals are shown by ρ 2 and ρ 3 and the semi annual signals are shown by ρ 4 and ρ 5 the amplitude of tws dynamics characterizing the occurrence of large scale ocean atmospheric interplay is represented by ρ 6 the normalized time series generated after the elimination of the long term mean of each climatic mode is represented by n the phase lag between the tws time series and each climate index is represented as φ n while the random error term with respect to time is shown as e t the residual component obtained after the elimination of the linear rates eqn 19 and harmonic components ndehedehe and ferreira 2020 is assumed to consist of prevalent slow dynamic climatic occurrences and other sub regional forcings kalu et al 2021c the application of the local least squares polynomial approximation based filter savitzky and golay 1964 was employed in smoothing the effects of low frequency noise for both dependent dtws and independent precipitation and climate modes parameters the deseaonalized x dtws signal parameters is characterized by 20 x dtws y t ρ 1 t ρ 2 sin 2 π t ρ 2 cos 2 π t ρ 4 sin 4 π t ρ 5 cos 4 π t the need to statistically identify the integrated periodic signals in multi resolution climate datasets is on the rise and has led to numerous applications of pca and ica in the regionalization of climate patterns as well as the assessment of geophysical time series around the globe e g ndehedehe and ferreira 2020 ndehedehe 2019 kalu et al 2021c given its efficiency in separating inter annual signals and long term periodic variations ndehedehe et al 2016a it is the most widely applied statistical tool in climate science grace hydrological signals over the african region are relatively strong and characterized by strong annual and semi annual components which contribute to the difficulty in masking residual variabilities induced by large anomalies of the surrounding oceans and climate teleconnection patterns the use of cumulant statistics to decompose our input layer datasets enhances the perception of these obscured signals to facilitate localization of their signal influences thus making it possible to concurrently relate their temporal evolutions with those of the climate modes after the cumulant decomposition of x dtws the evolving independent mode dtws of variability was compared with the normalized scatter plot of each climate mode to determine their interaction range fig 4 the use of the smoothing spline algorithm was necessitated as a result of the noise impacts in the individual datasets to avoid over fitting of the smoothing spline we adopted the standard k fold validation procedure especially given their efficiency in smoothing spline models kim gu 2004 5 results and discussions the bpnn used in our analysis learns with a significantly higher learning rate especially with an optimized set of weight and bias parameters the back propagation technique was duly enforced to perform learning on our multi layer feed forward neural network given that the back propagation technique learns a set of weights to achieve an optimized weight and bias parameter to generate the best fit the process was duly performed for the pca loss 0 4 and ica loss 0 1 back propagation neural models these results were expected because the original input parameters were optimized prior to the testing phase of the deep learning technique using the pca and ica for the pca bpnn mode we normalized each of the 16 input parameters within the range of 0 and 1 given that they contain varying orders of magnitude however before the principal component analysis is applied the correlation coefficient is obtained from the normalized data which is used to generate the characteristic vector and the characteristic values and finally determine the corresponding principal components of the input layer parameters with the monthly temporal patterns of the input parameters yielding 183 characteristic values and their corresponding characteristic vectors i e april 2002 june 2017 the principal component values are averaged to allow the accumulated input rate of the variance exceed the 99 set threshold for the model this led to the construction of our pca bpnn network whereas for the ica bpnn mode it was pertinent to first extract the individual ic components of the original input parameters given that the ica uses a filtering system we were tasked with the identification and removal of a noise ic which if not removed could impede the accuracy and efficiency of our proposed model the tna technique was used in the identification and removal process given that the ic7 provided the least rhd value it was eliminated from our analysis the rhd algorithm also served as a reconstruction tool in estimating the comparison between the original input parameters and their corresponding reconstructed parameters then we used the first 146 months of each of our independent pca bpnn pc1 pc6 and ica bpnn ic1 ic6 and dependent parameters pca tws pc1 tws pc2 tws pc3 and ica tws ic1 tws ic2 tws ic3 to train for the two models prior to the training of both models we confirmed their synchronization with the csr tws time series our developed models were used in predicting the temporal patterns of the three dominant independent modes of the grace tws before overlaying our entire data for general predictions we tested our trained results using the remaining 37 months dataset and got an average fitting of 88 the details and results of the machine learning framework and assimilation process are discussed further 5 1 impacts of global climate modes on grace hydrological signals part of our objectives for this study was to delineate the impacts and contributions of global teleconnection indices and sst products on continental land water storage using a third pca and fourth order cumulant ica decomposition procedure this was useful in the recognition of significant modes of the deaseasonalised tws which was duly correlated with the normalized indices as represented in fig 4 given that the sst index performs best when tested over relatively smaller localized regions such as river basins ndehedehe and ferreira 2020 we explain that our r index was significantly affected by the large spatial extent of the study region as our strongest correlation with tws was recorded at 0 6714 for the nino 3 0 index our analysis showed that all nino indices as well as the iod maintained the strongest climatic mode influence on the african region figs 4 and 5 however the strength of their influences is mostly felt in the sub saharan region of the continent which houses most of the major river basins in the continent e g congo nile niger and zambezi river basins prior to deaseasonalization procedure we used the spearman s correlation r to determine the extent of relationships between global climate indices and tws fig 1 table 2 iod and sst anomalies of the pacific oceans nino 3 0 and nino 3 4 which corresponds to the enso region show the highest association with the spatial evolutions of tws over the entire african region r 0 5744 0 6714 0 6191 for iod nino 3 0 and nino 3 4 respectively table 2 and fig 7 generally independent patterns of tws dynamics over the study region is largely associated with the iod signals fig 1 the pdo and nao signals showed a weak relationship with the regions tws r 0 2817 and 0 2764 respectively while the enso r 0 4335 nta r 0 3883 amo r 0 3370 eta r 0 2965 sta r 0 3752 and sst parameters of the south pacific ocean nino 1 2 r 0 4733 and nino 4 r 0 3957 exhibited moderate relationships on the region s tws fig 1 the relationships of these climate modes with the spatio temporal patterns of the tws over africa fig 1 highlights the substantial footprint of global climate over the continent from the localized spatio temporal patterns generated from cumulant decomposition dtws we notice higher tws amplitude towards the west east and central african regions these sub regions are key hydrological hotspots hosting the largest river basins in the region figs 5a m in the west east and central sub regions the influence of nino 1 2 nino 3 0 nino 3 4 nino 4 0 sta enso pdo and iod results in considerable magnitudes of over 30 mm to the amplitudes of tws figs 5b e g i l m the influence of these climate modes to the deseasonalized tws in our study region strongly corresponds with their temporal relationships with tws in the study region figs 5a m given that the nino indices are signals from the enso region which is duly characterized by the eastern and central pacific it follows therefore that the tws dynamics over the western and central african regions are driven by the enso phenomenon ndehedehe et al 2017 notwithstanding the low association of the pdo and nao signals with the un deseasonalized tws fig 1 in all hydrological regions the tws estimation based on climate induced amplitudes were only restricted to the pacific ssts i e ninos 1 2 3 0 3 4 4 0 enso pdo iod amo nao and eta building on the work of phillips et al 2012 we corroborate their assertions on the influence of el nino induced water deficits i e positive phase and increased tws i e negative phase caused by la ninas in the tropical region as a direct contributor of sst anomalies in the surrounding oceans ndehedehe and ferreira 2020 also the grid based interactions between these climate modes and the regions tws shows that the land water storage in much of sub saharan africa is influenced by the pacific atlantic and indian ocean teleconnections figs 6a m this was significantly captured after the elimination of trends and harmonic components of the grace hydrological signals see section 4 7 inasmuch as nao and amo showed relatively minor influence on tws figs 5j k and 6j k pacific indices nino 1 2 nino 3 0 nino 3 4 and nino 4 0 tropical atlantic nta eta sta as well as the pdo and iod exhibit significant influence over the regions tws showing relatively higher correlations ranging from 0 6 to 1 figs 6 b e f i l m we also noticed an odd interplay of the nao atlantic indices to the region s tws given that they maintain a close proximity to each other the nao showed a weak relationship to the region s tws fig 1 and also exhibited minute influence fig 5j and correlation fig 6j to the regions deasonalized tws this contradicts the assertion by ndehedehe and ferreira 2020 suggesting that the influences of sst from relatively closer oceans on tws exhibit high correlations however other atlantic modes such as the nta sta eta and amo exhibited good inter relationships with the region s tws thereby corroborating the earlier assertion made by ndehedehe and ferreira 2020 this also explains that the strong influence of pacific contributions such as the el nino la nina interplay to africa s tws exceeds that of the atlantic regardless of the proximity between them fig 1 5 2 identifying dominant independent patterns from existing data the process of dimension reduction is a mandatory strategy in our experiment and is aimed at keeping the problem of identifying independent modes on a grid as well as their statistical interrelationships numerically manageable this phase has to be implemented before constructing the mathematical interplay between the independent and dependent parameters the process also helps in enhancing the prediction skills of the statistical approach used here especially by playing down on the redundant datasets and excluding from our modeling phase table 3 dimension reduction and separation techniques are employed here using the pca and ica algorithms respectively to the predictors hydrological fluxes ssts and climate indices and the predictand grace derived tws as earlier stated principal component analysis is a classical procedure in statistical data analysis data reduction and feature extraction aimed at explaining observed signals as a linear integration of orthogonal principal components the linear combination generated from eqn 8 depicts the predictand tws as orthogonal whereas the generated uncorrelated variables eqn 16 known as the principal components explains the spread variances the coefficients of this linear combination are referred to as loadings and they provide the weights of the original variables in the pcs the empirical orthogonal functions eofs which are generated by computing the eigenvalues and eigenvectors of a spatially weighted anomaly covariance matrix of any input field it represents the spatial distribution or patterns of the input parameter such as tws and is used in understanding the spatial modes of variability and how they change in time the eof pca pair which is often referred to as pc mode ndehedehe et al 2016a because of its usage of the covariance matrix makes it ideal for climate analysis in addition to extracting pcs that highlights areas with high temporal variability the loadings are generated from the normalized eigenvectors which explains the fraction of the total variance derived from the statistic for the independent component analysis on the other hand the deseasonalized signals of the input parameters e g grace derived tws is stored in a matrix x dtws eqn 20 and is further decomposed into spatial and temporal components using eqn 9 from y w t x t we can extract that the columns of x t contains the t dominant unit less temporally independent components ics of tws and the columns of w represents the corresponding spatial maps each column of x t i e temporal pattern along with their corresponding column of w i e spatial pattern depicts an independent mode of variability this was also implemented in the temporally entered extraction maps of the predictors i e hydrological fluxes ssts and teleconnections in the sst extraction we experiment with different t indices to emphasize that the quantity of retained modes from different datasets are not necessarily homogenous forootan et al 2014 in our experiment we noticed that the spatial patterns associated with the independent modes of tws column vectors of eqn 6 pca and eqn 7 ica were stable this therefore implies that spatial patterns are not extremely volatile to varied time series information in case of relating two datasets e g an 8 year and 12 year dataset therefore for both pca bpnn and ica bpnn models we link the temporal components of the predictor datasets i e all columns of x t derived from hydrological products ssts or teleconnection patterns to individual pcs or ics of the predictand i e tws as the case may be the first second and third independent modes of the tws anomalies derived from grace for the two statistical frames are shown in fig 7 the first dominant independent pc mode which explains 67 31 of the variance characterizes the annual water variability over the study region from april 2002 june 2017 the spatial pattern of the first principal component fig 7 depicts a concentration of annual variability to be most dominant over the west african region which houses the niger senegal and volta river basins and the eastern and central african region housing the famous congo river basin the second pca modes of grace tws contain inter annual variability depicting a concentration of the eof loadings over the far end of the west african region and towards the southern african region the trend is homogenously characterized as a net tws loss of the depicted regions figs 8 b e this explains 11 83 of the total variance of the study region the third pca mode explains the least variance with 6 20 of the total variance characterizing another inter annual variability of the study region its spatial pattern depicts a concentration of inter annual variability to be most dominant over central africa with a net tws gain this can largely be attributed to the presence of the congo river basin in the region which has been known to drive hydrological fluxes over the central african region kalu et al 2021a the statistically significant pcs which are represented by the first three pc modes figs 8a c gave a cumulative variance of 85 34 and were assumed as statistically significant signals denoting over 95 of the total tws fluctuations over the study region the results from the independent component analysis were similar to the pc results with the first second and third ic modes maintaining 68 22 11 52 and 6 85 of the regions variance respectively the cumulative variance of the ic modes is 86 59 and is assumed to consist of the most significant signals responsible for tws fluctuations in the study region the temporal evolutions of the ic are also characterized as annual for the first fig 7j and inter annual variations for the second fig 7k and third fig 7l similar to the pc temporal evolutions figs 7d f the pc and ic results correspond to the annual fig 8a and semi annual fig 8b amplitude of the region s tws as well as the trend dynamics fig 8c the west and central african region contribute mostly to the fluctuations in tws this was expected as they house the biggest river basins that contribute substantially to the dynamics of hydrological fluxes in the region the substantial impacts of hydrological changes in our test bed also warranted our usage of localized hydrological products fig 1 as input predictors to help maintain the stability and robustness of our model estimates their influence in regulating the tws dynamics of any region is well captured in the water budget equation chen et al 2020 and tends to provide the most dominant influences in tws dynamics than other global predictors such as ssts and teleconnection patterns our model attempts to predict these normalized temporal patterns of the pc and ic modes for the three most dominant features as shown in figs 7d f pc and 7j l ic using a decomposed pc and filtered ic version of hydrological products ssts and global teleconnection patterns these patterns maintain significant relationship between each other as well as the region s tws dynamics fig 8f supporting information 7 summarizes the percentage variance of all the modes used in this study 5 3 predicting total water storage for predicting tws using the pca bpnn and ica bpnn algorithms we used 80 of our overall grace tws datasets april 2002 may 2014 for training and the remaining 20 of the data june 2014 june 2017 were used to test the performance of our models our inputs for prediction were optimized prior to its inclusion to the machine learning framework section 5 1 for the pca bpnn we used the independent variables with varying order of magnitude fig 9 a whose eigenvectors i e loadings served as our model input figs 9b c the box plot in fig 9a shows the normalized magnitude for all input parameters having their median values at 0 02 precipitation 0 18 evapotranspiration 0 08 runoff 0 10 soil moisture 0 10 nino 1 2 0 08 nino 3 0 0 00 nino 3 4 0 10 nino 4 0 0 12 nta 0 00 sta 0 10 eta 0 10 enso 0 00 nao 0 00 amo 0 05 pdo and 0 00 iod using the characteristic vector and characteristic value generated from the r values we were able to generate the loadings used to predict the grace derived tws for the training period for the ica bpnn model we employed the basic procedure of detecting the noise ic after the initiation of the latent ics using the tna procedure we were able to identify the noise ic i e ic 7 this was implemented using the rhd procedure which estimates the reconstruction error between the original and reconstructed parameters given that the rhd shows a higher similarity between the original and reconstructed parameters we were able to detect ic7 as the parameter whose value is closest to zero and removed it from the training to avoid compromising our test datasets table 3 using the optimal weight and bias parameters we generated table 4 which represents some of our test results for both the testing and training phase fig 3 to regulate the indefiniteness of the hessian h matrix we set the determining parameter to 5 0 10 5 the marquardt adjustment parameter ranged from 1 0e to 03 to 1 0e 07 to obtain the best minimum of our non linear function over our space of input loadings for evaluating the performance of our proposed pca bpnn and ica bpnn models we selected the two sets of input datasets to analyze the models by comparison especially since the two of them were predicting the same quantity using the last 20 ranging from june 2014 june 2017 we were able to test the performance of the trained bpnn models 5 3 1 training step to compute the optimum pca bpnn and ica bpnn we inserted the first 146 months of each mode of grace derived tws fig 7 and the first 146 months of all temporal modes of hydrological fluxes ssts and global teleconnection patterns supporting information 7 in equations 16 and 13 respectively before performing the training step of the bpnn model we ensured that our time series datasets were duly synchronized with the csr tws time series this was then followed by running the bpnn simulation step for both pc and ic modes given that we want to keep our prediction simple we did not consider higher orders of the pc bpnn and ic bpnn models for both the predictors and the predictands our numerically simulated results for both pc1 pc6 and ic1 ic6 of grace tws suggest that the bpnn model provides the best fitting at optimal weight and seed values table 4 to validate our decomposed input datasets we applied the k mean clustering technique for all pc and ic input modes fig 10 the k meansuses a two phase iterative algorithm to minimize the sum of point to centroid distances summed over all k clusters the first phase implements a batch update procedure where each iterate contains reassigned points to their closest cluster centroid at the same time followed by a recalculation of cluster centroids in this phase it is always difficult to obtain a converged solution to a local minimum that is a partition of the data where moving any single point to a different cluster increases the total sum of distances although it is mostly employed for smaller datasets however it is fast but potentially only approximates a solution as a starting point for the second phase in the second phase the online update technique is implemented where points are individually reassigned to reduce the sum of the distances and cluster centroids are computed after each reassignment during this phase each iterate consist of one pass through all the points the phase easily converges to a local minimum even though other local minima with lower total sum of distances may exist generally obtaining the global minimum is computed by a complete choice of starting points however implementing various replicates with random starting points typically leads in a solution that is a global minimum the rms of differences between the simulated tws values from the bpnn models and the pc ics of the grace tws was used as the fit criterion our simulation results indicate that the pca bpnn models provide a fit of 89 82 and 84 for the first second and third independent modes of the pc grace tws while the ica bpnn model provides a fit of 93 88 and 82 for the first second and third independent modes of the ic grace tws for simulating the three dominant components of the grace derived tws figs 11 12 we also overlaid the temporal evolutions of the input pc and ic components fig 11 the simulation fit of the bpnn corresponding to pc2 fig 12b pc3 fig 12c ic2 fig 12e ic3 fig 12f are however lower than that of pc1 fig 12a and ic1 fig 12d this is largely due to the fact that they are characterized by temporal patterns appearing to be much more complex than the annual patterns of pc and ic1 respectively fig 11 therefore they might not have been fully captured by the predictors see fig 12 5 3 2 prediction step and performance assessment having simulated the bpnn model parameters for the three dominant independent modes of the grace tws we used the remaining time series ranging from jan 2014 june 2017 characterizing 20 of our input dataset for testing before overlaying the entire data for the general prediction the indicator time series of all pcs and ics shown in fig 12 were used in the prediction for april 2002 june 2017 the predictions were derived from equation 16 and 13 and their uncertainties were evaluated using the monte carlo approach training and prediction results are shown in fig 12 and table 4 the process of back propagating which is the basic essence of our neural net training was duly employed in this practice we fine tuned the weights and bias of our neural net based on the error rate which is also referred to as the loss function obtained in the previous epochs i e iteration it was necessary to obtain proper tuning of the weights as they ensure lower error rates making the developed model reliable by increasing its generalization for the first epoch the leftmost layer fig 2 which takes the randomly selected bias and weight term as well as the optimized pc and ic inputs begins the training the four layers in the middle which serve as the hidden layers also take the randomly selected bias term of 1 5 using the process of feed forward propagation we generate tws predictions which do not give us our desired result fig 13 as the weights and biases have not yet been tuned this is where the back propagation comes in the back propagation is all about feeding the loss function backwards in such a way that we can fine tune the weights with the help of the gradient descent optimization the weights of the networks are optimized to yield smaller loss in the next iteration this iteration was performed 13 times for the pca bpnn to achieve an acceptable error rate 0 4 and 15 times for the ica bpnn to achieve an acceptable error rate 0 1 table 5 we also used the confusion matrix chart to visualize the performance assessment of our prediction with the observed tws fig 14 the confusion matrix consists of a square matrix having only positive integers the matrix element i j is the number of times an observation of the ith true class was predicted to be of the jth class each color cell of the matrix in fig 14 corresponds to one element of the confusion matrix the fit of the forecast for the first leading modes of total water storage for both models when compared to the observed grace tws values after 10 months was found to be pca bpnn1 84 and ica bpnn1 89 respectively while the other three individual modes are characterized as follows pca bpnn2 67 pca bpnn3 61 ica bpnn2 73 ica bpnn3 65 whereas after 20 months the fit was reduced to pca bpnn1 55 and ica bpnn1 59 for the first leading modes while the second and third modes were reduced to pca bpnn2 48 pca bpnn3 44 ica bpnn2 45 ica bpnn3 40 our uncertainty propagation showed that after 20 months the standard deviation became too large which suggests that our proposed pca and ica model is more or less reliable for predictions of only up to 20 months fig 12b shows that the fit of the forecast is severely affected by multi annual climatic patterns irrespective of the comprehensive predictive parameters used which covered a wide range of the climatic drivers in the african continent our results indicate that the tws prediction from our bpnn models is closer to the observed grace tws dynamics over sub saharan africa when compared to hydrological modeling ndehedehe et al 2018 we found no apparent deviations from tws time series when the bpnn models were compared with the loadings and ics of the grace tws which means that the fit values reported from our experiment are significant this is a huge pointer to the influence of global climate indices in the assessment of tws over regions of significant hydrological interactions like africa as the study undertaken by ahmed et al 2009 over the same region reported a relatively poor performance of the narx model over the congo limpopo and nile basins which were used as test beds for their prediction we suggest that the exclusion of these teleconnection patterns as well as other important hydrological parameters contributed to the relatively poor fit of their study in the overall performance validation carried out in the study the authors reported very good over six watersheds good over one and satisfactory over the remaining basins among other factors the authors attributed the satisfactory performance to prolonged climatic cyclicity that was not adequately represented in the model training phase which is in line with our suggestion in this study however we must also note that including teleconnection parameters in relatively smaller regions such as the limpopo river basin may not produce good prediction results as the influence of these global climate indices are almost insignificant in small river basins like the limpopo river basin however this is left as future dispute to be handled in coming studies for inter annual time scale series figs 7e 7f 7 k 7 l 12b 12c 12e 12f specific care should be taken given that the simulation and prediction of the bpnn models are very sensitive to the temporal patterns of the input parameters when ic s of the predictors are not well defined for e g due to the inclusion of the noise ic generated from the rhd parameters the inter annual forecast of the bpnn might perform very poorly this was tested by the inclusion of ic7 in our input signals results not shown the bias generated from the test was largely found in the interannual predictions of tws 2 and tws 3 and was attributed to the inclusion of the noise ic in the predictions we used the outliers generated from table 4 to plot a residual plot for the two bpnn models fig 15 given the fit levels of our bpnn models our results therefore support the idea of using the presented statistical approach to forecast tws dynamics over the african region 6 conclusion and outlook the rapidly changing dynamics of the global water cycle caused by the intensifying actions of global climate trigger complex processes that make conventional machine learning techniques limited in quantifying the extent of such changes on tws to this end the novel integration of principal component analysis pca and independent component analysis ica to the back propagation neural network bpnn was employed to assess the complex interaction of hydrological fluxes and climate variability indices from well known oceanic hotspots indian atlantic and pacific with freshwater dynamics over a continental scale the bpnn technique propagates the total losses back into the neural network to understand how much of the loss every node is responsible for and subsequently updates the weights in such a way that minimizes the loss by giving the nodes with higher error rates lower weights and vice versa the statistical framework and efficiency of our proposed model is explored using a 15 year grace data which served as the dependent variable against sixteen independent variables the key outcomes from our study are summarized as follows i we identified the strength of the pacific indices in regulating tws against the atlantic indices in the african region this shows the extent and contributions of the well known el nino and la nina oscillations dominant in the pacific in controlling hydrological fluxes and patterns in africa the contributions of the india ocean dipole iod and the ninos nino 3 0 and nino 3 4 were also seen to have very strong influence on the regions tws while other global teleconnection indices provided average contributions towards the region s tws ii our simulation results indicate that the pca bpnn models provide a fit of 89 82 and 84 for the first second and third orthogonal modes of the pc grace tws respectively however the ica bpnn model provides a better fit of 93 88 and 82 for the first second and third independent modes of the ic grace tws for simulating the three dominant components of the grace derived tws our uncertainty propagation showed that after 20 months the standard deviation became too large which suggests that our proposed pca and ica model is more or less reliable for predictions of only up to 20 months with the use of a confusion matrix and a residual plot we analyzed the performance of our predictions and given the minimum bias and fitting index of the ic modes we found out that the ica bpnn model performed better than the pca bpnn model iii the perceived roles of human induced climate change are expected to lead to an increased tws variability this is evidenced in several sub regions of the african continent experiencing higher precipitation and tends to have stronger amplitude and changes in hydrological fluxes and tws for e g the congo and volta river basins some studies have argued that the interplay between the role of human alteration of the natural system and the effects of global climate teleconnections on the regions tws results in complex hydrological processes in this study we pioneer a new deep learning assimilation method for the reconstruction of tws using the ica bpnn and pca bpnn models as well as a thorough investigation of the links between multi global climate teleconnection patterns and variations in continental freshwater tws however further investigation is essential to adequately quantify the contributions of non idealized natural systems i e human water management and other forms of anthropogenic influence such as deforestation on tws over africa as observed by grace satellite iv the pca bpnn proved efficient in assessing location specific impacts of hydrological anomalies while the ica bpnn through its filtering mode provided a more suitable approach in identifying the footprints of large scale hydrological changes in africa given that the climatic pattern in africa mimics that of the global patterns continent wide regions experiencing large scale oscillations such as south american and asia can benefit from this model especially in their assessment of freshwater dynamics based on their varying hydrological processes and global climate actions credit authorship contribution statement ikechukwu kalu writing original draft writing review editing methodology formal analysis conceptualization investigation software christopher e ndehedehe conceptualization supervision software investigation formal analysis methodology writing original draft writing review editing onuwa okwuashi conceptualization writing review editing formal analysis aniekan e eyoh resources supervision vagner g ferreira writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was part of a series of preliminary machine learning experiment that was conceptualized and initiated by dr christopher e ndehedehe based on his australian research council arc project for the 2023 discovery early career researcher award decra christopher is grateful for the arc decra de230101327 funding and also thankful to griffith university s australian rivers institute for the conducive research environment supporting his strategic research in remote sensing hydrology and where the arc decra is hosted appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128498 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2807,the rapid acceleration of the global water cycle caused by changes in global climate trigger complex processes that make conventional machine learning techniques limited in assessing impacts of such changes on terrestrial water storage tws this study introduces an assimilated deep learning neural network to improve the modeling of tws dynamics key predictors and inputs to this deep learning framework include runoff rainfall soil moisture evapotranspiration global teleconnection patterns and sea surface temperatures ssts the proposed back propagation model in this study capitalizes on the availability of remotely sensed observations and model datasets to predict monthly tws a quantity that is difficult to observe in the field but important for the estimation of regional water budget balance and water resource management for agricultural purposes by integrating pre processed outputs from the principal component analysis pca and independent component analysis ica into our network using a deep neural pattern we synthesized tws from 2002 to 2017 and also made future predictions using our trained models results from these analyses showed that the ica bpnn model has a higher predictive accuracy compared to the pca bpnn these models ica bpnn and pca bpnn were used to fit the three dominant temporal patterns of gravity recovery and climate experiment grace observed tws over africa our simulation results from the testing phase indicate that the fits for the prediction of the first three leading modes of tws for both models when compared to the observed grace tws were pca bpnn1 89 pca bpnn2 82 pca bpnn3 84 and ica bpnn1 93 ica bpnn2 88 ica bpnn3 82 the simulation fit of the bpnn corresponding to multi annual time series which are captured in the second and third orthogonal modes and localized patterns of tws were lower than those of annual signals in both the pca and ica bpnn models this was attributed to the fact that the multi annual time series in grace hydrological signals of our test bed are complex compared to the annual patterns of tws on the one hand this exemplifies the superior performance of our predictive framework in modeling naturalized system annual changes in tws driven by only climatic factors on the other hand the complexity in modelling multi annual variations in tws suggests heavily disturbed naturalized systems evidenced in the presence of human water management operations among other anthropogenic activities keywords deep learning neural network nino 3 4 terrestrial water storage bpnn data availability data will be made available on request 1 introduction in today s contemporary society there has been an increase in the application of machine learning theories to hydrological and climatic analysis the ability of these machines to think and act with less human interventions has resulted in heightened efficiency and accuracy in relating non linear climatic datasets and reporting on their influence directly on our planet and indirectly on our daily lives even without these machines being explicitly programmed the concept of machine learning however limits system performance to exclusive machine operations thus allowing them to still think and act as machines kalu et al 2022a the advent of deep learning operations led to a more sophisticated approach to machine learning and is able to address the challenges of the latter because they have been specifically modeled after the human brain therefore an assimilation of both machine and deep learning operations promises to show notable progress in monitoring the multi scale climatic influences on sub regional and continental hydrology using coupled relationships between surrounding oceans and land water storage e g ndehedehe et al 2017 by employing this assimilated deep learning approach we attempt to learn the implications of the dynamic land ocean atmosphere interaction hart et al 2019 reason jagadheesha 2005 localized hydrological operations ndehedehe et al 2017 andam akorful et al 2017 paz et al 2008 and other multi physical trends giannini et al 2008 sheffield wood 2008 oguntunde abiodun 2013 nicholson 2013 on total water storage tws whose deficit or surplus could result in extreme climatic conditions that negatively impacts on the biodiversity terrestrial and aquatic ecosystem as well as atmospheric balance of our environment druyan 2011 in this era of artificial intelligence data driven stochastic techniques have witnessed enhanced accuracy over physically based techniques in hydrological interactions this is easily discerned in the operation of data driven techniques towards parameter estimations calibration procedures and its efficiency in handling different sources of uncertainties better than their physically based counterparts the simplicity and robustness of these techniques in hydrological studies have been widely reported in recent literatures e g sun et al 2019 yu et al 2021 data driven techniques such as boosted regression trees naghibi et al 2016 gene expression programming shah et al 2021 support vector machines rehana 2019 random forest and m5 trees ardabili et al 2019 as well as neural networks oyebode stretch 2019 nourani et al 2019 have been widely applied in hydrological and climate studies neural network is an artificial intelligence algorithm which was inspired by the functioning of the human nervous system gurney 2018 the strength of this network lies in its ability to properly operate disorderly but all inclusive information even without needing strong model assumption it has also been observed to have strong self learning modes good non linear approximations and self adaptive abilities the back propagation bp neural network training algorithm is one of the most popular techniques for forecasting given its powerful problem solving ability its application has been noted in relevant fields such as medicine dimililer 2013 al shayea 2011 finance liang wu 2005 liu wang 2011 accounting olson mossman 2003 koh tan 1999 and even in the earth sciences pradhan et al 2010 pradhan lee 2010 when the bp neural network is applied in any forecast algorithm the related factors which are correlated and contain a large amount of noise embedded in the system are always of large concern okwuashi et al 2021 due to the potential underfitting or overfitting problems noticed in these algorithms it is always pertinent to eliminate the correlation and noise among the input data as much as possible this can help enhance the quality and performance of the bp model as well as its prediction accuracy the use of neural networks in climate prediction studies water resources management research and stream flow forecasting are emerging chang chang 2006 house peters chang 2011 maier et al 2010 moradkhani et al 2004 coulibaly et al 2000 they have also been applied in grace derived tws precipitation and temperature data sun 2013 population and irrigation dataset feng et al 2008 variable pumping and weather conditions coppola jr et al 2007 coppola jr et al 2005a b chu chang 2009 as well as in situ hydro meteorological observations coulibaly et al 2001 the study undertaken by ahmed et al 2019 used the similar approach of nonlinear autoregressive with exogenous input narx neural network model in forecasting grace derived tws however the authors dwelled majorly on hydrological products rainfall evapotranspiration temperature and normalized difference vegetation index and used them as tws drivers but did not encompass the effects of global climatic indices sst sea surface temperatures and teleconnection patterns in their analysis the understanding of climate teleconnections also extends to the sub regional meteorological processes given its impact on atmospheric and weather patterns redelsperger et al 2006 polo et al 2008 losada et al 2010 rodriguez fonseca et al 2011 andam akorful et al 2017 the knowledge of climate teleconnection s influence on tws is critical especially as a result of tws being a hydrologic state parameter integrating important hydrological processes such as groundwater infiltration and recharge kalu et al 2022b an in depth analysis of this concept provides insights on water resource managements wet conditions heat waves and even potential drought conditions previous attempts in modeling this processes have dwelled on the impact of these global hydrological indices on the dynamics of global mean sea level merrifield et al 2012 precipitation index dinezio tierney 2013 and even tws anyah et al 2018 ndehedehe ferreira 2020 ndehedehe et al 2017 de linage et al 2014 as was argued by ndehedehe et al 2017 the 8 year grace data implemented in the study undertaken by philips et al 2012 was restricted and did not accommodate an adequate enso recurring duration given that enso has an energy cycle of 2 5 years furthermore the independent component analysis ica algorithm employed in the teleconnection definition between the model input and output variables in estimating grace derived tws over west africa were found to be insufficient in describing the full observation parameters forootan et al 2014 the studies undertaken by ndehedehe et al 2017 and anyah et al 2018 on the footprints of teleconnection influence on tws only dwelled on the hydrological impact of the climate teleconnection on grace derived tws using the well known ica and multi linear regression these studies did not make notable predictions and estimations that can guide hydrologists in decision making the need for more accurate predictions of tws to adequately manage extreme climatic conditions such as drought and flooding at large continental scales is a strong motivation behind this study in our experiment complex and multi layered deep neural patterns are developed to allow data to be passed between nodes like neurons in highly connected ways this results in a non linear transformation of the input climatic and hydrological datasets which is becoming increasingly abstract as a result of climate change and human interventions on their cycle however prior to this operation the original input datasets which consists of hydrological fluxes ssts and global teleconnection patterns are pre processed using unsupervised statistical decomposition techniques principal component analysis pca and independent component analysis ica to be able to extract their combined dominant patterns and use them in tws estimation also by integrating this third pca and fourth ica order statistics to our neural network we highlighted the impacts of climate variability hydro climate drivers land surface processes and atmospheric circulation systems in tws dynamics therefore in this study we aim to develop an assimilated deep learning framework to predict the impact of sst based hydrological indices on tws using an improved bp based model in this manuscript the ica and the pca are integrated into the well known back propagation neural network bpnn algorithm for the prediction of grace derived tws time series and are subsequently referred to as the ica bpnn and pca bpnn model respectively these models are employed to assess the impacts of these climatic drivers as well as quantify their relative contributions to tws dynamics this study specifically seeks to i develop a deep learning framework to reconstruct climate driven tws with ica bpnn and pca bpnn models using global indices and sst datasets as well as other localized hydrological products such as precipitation evapotranspiration runoff and soil moisture datasets ii investigate the association of multi global climate teleconnection indices on regional tws and highlight the influence of localized hydrological fluxes in modeling tws and iii assess the impacts of key climatic drivers on the temporal and spatial distributions of grace derived tws 2002 2017 these climate drivers are functions of four localized hydrological fluxes i e precipitation evapotranspiration runoff and soil moisture seven prominent sst products of the nearby oceans i e north tropical atlantic nta south tropical atlantic sta east tropical atlantic eta nino 1 2 nino 3 0 nino 3 4 and nino 4 and five global climate teleconnection patterns e g enso north atlantic oscillation nao atlantic multi decadal oscillation amo pacific decadal oscillation pdo and the indian ocean dipole iod our methods pioneer deep learning applications in diagnosing influence of climate teleconnection on terrestrial hydrology on a continental scale by i predicting grace derived tws using an integrated statistical and neural network model ica bpnn and pca bpnn and ii utilizing varied sst and global climate teleconnections datasets as well hydrological products as basic climatic drivers in the regions tws the remainder of this study is segmented as follows section 2 provides a brief introduction of the study region highlighting its role in large scale mesoscale convective interactions with the nearby oceans section 3 gives a thorough discussion on the data and techniques employed we perform and interpret and discus the analysis in section 4 and finally concluded in section 5 2 study region africa is a region with highly variable climate conditions ranging from tropical to semiarid and arid the continent is home to extremely wet river basins i e congo river basin and considerably drier regions i e north africa where the impact of geodetic perturbations such as land subsidence has been reported in recent times cigna tapete 2020 cian et al 2019 rateb hermas 2020 kalu et al 2021b c the hydrological dynamics of the region is mainly driven by soil moisture content runoff evapotranspiration index and precipitation patterns which makes it an ideal test bed for our analysis the main source of precipitation over a large portion of the continent is driven by monsoon systems and has a significant relationship to large scale pattern of ocean atmosphere land interactions giannini et al 2008 this has in turn affected the availability and allocation of freshwater resources in the region over the past few years supporting information 3 in africa freshwater resources are largely found in lakes aquifers watersheds floodplains or wetlands these resources are highly susceptible to natural variabilites climate change and anthropogenic interventions ahmed et al 2014 agutu et al 2017 ndehedehe et al 2017 kalu et al 2021a the climatic condition of the tropical african region is largely governed by convection with the seasonal migration of the tropical rain belt influencing its precipitation patterns potts 1996 the dynamics in the seasonal positioning of the rain belt causes insolation changes thereby resulting to the occurrence of rainfall in the northern southern region during the austral boreal summer nicholson 2017 also the studies of nicholson and selato 2000 and pausata et al 2017 suggests that the african climate is highly susceptible to variations in the walker circulation which is largely demonstrated in the enso processes enso is largely dominant in the equatorial pacific ocean fig 1 it originates from sst anomalies in the region whose changes influence the atmospheric walker circulation patterns thereby altering the strength and location of tropical convection cells hart et al 2019 the propagation of these enso events around the globe are due to the coupled ocean atmosphere system which are propelled by the kelvin and rossby waves pausata et al 2017 eventually reaching the african region the east west trend moisture gradient across the continent is largely affected by the variations in the enso state de oliveira et al 2018 nash et al 2016 this however results in opposing dry and humid climatic conditions between the eastern and western african region during el nino western africa experiences drier climatic conditions than eastern africa and vice versa during la nina events for example during el nino periods eastern africa is noticed to have significant positive anomalies in precipitation patterns of up to 200 mm per year 60 in relation to the yearly precipitation budget during the la nina years whereas western africa encounters a 20 to 40 reduction during this period fer et al 2017 moore et al 2017 these dynamic spatio temporal precipitation changes in africa and its modern driving mechanisms on longer time scales can also be said to be as a result of variations in atlantic meridional overturning circulation waxing of global ice sheets as well as the growing concentration of aerosols and ghgs in the regions atmosphere trauth et al 2005 castañeda et al 2009 dinezio et al 2018 regardless the interplay of these complex driving mechanisms on orbital time scales as well as their corresponding pan african impact on precipitation intensity frequency and patterns still remain ambiguous 3 data 3 1 total water storage from grace the use of the grace derived tws in hydrological research and monitoring has garnered substantial attention over the years its role as a vital tool in sub surface water storage assessment groundwater evaluations and aquifer system processes has been overly explored in recent studies ndehedehe et al 2017 kalu et al 2021a swenson and wahr 2007 famiglietti et al 2015 ndehedehe and ferreira 2020 ndehedehe et al 2019 the grace mission operates at an altitude of 450 km and an inclination of 89 50 it is made up of two low earth orbiting satellites in the same orbital plane the separation of the two satellites is accurately determined by a k band ranging system and the position of each of the twin satellites is established by gps receivers onboard the spacecraft tapley et al 2004 we used the monthly grace products from the university of texas center for space research csr sh to compute tws fields covering april 2002 to june 2017 to assess land water storage over the african region the grace mass concentration solutions mascon blocks were down sampled to a spatial resolution of 0 5 by 0 5 degrees this helped in averaging of the regional cells which were still restricted to the 300 km nominal resolution of the grace the csr mascon approach uses an intermediate solution for the determination of a time variable regularization matrix to estimate the mascon solution this allows the construction of a time variable regularization based solely on the grace data save et al 2016 and ndehedehe and ferreira 2020 explained the essence of this regularization which is key in preventing the mission s signals leaking into the nearby oceans these operations simplify the application of the grace derived datasets in various hydrological and water resource management problems extended details regarding the grace mascon derivation solutions and performance metrics can be found in watkins et al 2015 the mascon dataset applied in our analysis was downloaded from http www csr utexas edu grace rl05 mascons html in its release 05 rl05 the application of grace mascons in global freshwater analysis is increasingly gaining more grounds especially given its simplicity in the implementation of different geophysical constraints to help filter out noise from the level 2 grace dataset wiese et al 2016 the mascon solution arguably provide results homogenous to other global grace products even without performing complex pre processing operations like smoothing and de stripping ndehedehe and ferreira 2020 3 2 satellite precipitation monthly generated trmmv7 3b43 rainfall parameters from april 2002 june 2017 from the national aerospace and space administration nasa goddard space flight center gsfc merged with the integrated multi satellite retrievals for global precipitation measurements imerg were used for this study this was applied in the examination of spatial and temporal inconsistencies in the region given rise by the actions of the sst of climate teleconnection patters dominant in the study area the trmm 3b43 imerg is used to establish the monthly rainfall approximations of the spatio temporal resolutions at 0 25 by 0 25 degrees huffman et al 2007 a large overestimation in the tropical rainforest region of africa over the trmm rainfall radar is ascertained in december january february and in march april may and a minimized bias in june july august and september october november by applying the zonal mean analysis kalu et al 2021a regardless the bias which is relatively sharp for all models in the dry seasons when rainfall is nominal is less prominent in the dry seasons of the african tropical regions it was necessary to rescale the trmm imerg rainfall dataset https disc gsfc nasa gov datasets trmm 3b43 7 summary in a bid to maintain and preserve a consistent spatial resolution with the other datasets e g grace derived tws used in this study 3 3 evapotranspiration remote sensing products are the most practical and feasible means of obtaining spatially distributed evapotranspiration et information over any terrestrial surface the evapotranspiration dataset utilized in this study was made available by the numerical terradynamic simulation group ntsg university of montana modis16a2 global et monthly datasets https modis gsfc nasa gov data dataprod mod16 php from 2002 to 2017 were obtained over a temporal period of 8 days at 0 5 km pixel resolution this et estimates are pre processed products based on the penman monteith equation monteith 1965 and encompass the influence of evaporation from the soil wet canopy and plant transpiration at dry canopy surfaces mu zhao and running 2011 3 4 monthly runoff in a given region tws change δtws represents integrated contributions from precipitation et as well as surface and sub surface runoff via the terrestrial water balance equation chen et al 2020 this shows the impact of monthly runoff in regulating tws dynamics in tropical regions the global runoff data center which provided the monthly runoff dataset used in the experiment https www bafg de grdc operates under the auspice of the world meteorological organization and provides river discharge data of nearly 9000 gauging stations from all over the world it is updated continuously and contains daily and monthly discharge data and can even be used for the verification of atmospheric and hydrologic models this product is generated with an underlying precipitation climatology which is readjusted whenever the observed runoff surpasses the input precipitation and contradicts the terrestrial water budget equation for our study period we averaged runoff data for the four major river basins over our study region i e nile congo niger and zambezi river basins by including monthly runoff estimates as part of our predictors fig 1 we aim to strengthen the performance of our machine learning framework in analyzing hydrological conditions over our test bed 3 5 terraclimate soil moisture terraclimate is a monthly climate and climatic water balance for global terrestrial surfaces it utilizes climatically aided interpolation integrating high spatial resolution climatological normal from the worldclim dataset https www worldclim org with coarser spatial resolution but time varying data from cru ts4 0 https data ceda ac uk badc cru data cru ts and the japanese 55 year reanalysis jra55 https jra kishou go jp jra 55 index en html theoretically the process implements interpolated time varying anomalies from cru ts4 0 jra55 to the high spatial resolution climatology of worldclim to generate a high spatial resolution dataset that covers a broader temporal record to aid our understanding of the influence of soil moisture estimates in the hydro meteorological interactions of multi scale climatic system as well as the role they play in regulating tws we also included soil moisture datasets in our original predictors fig 1 soil moisture plays an important role in the studies of land surface hydrological processes and monitoring of climatic events in tropical regions fan van den dool 2004 ndehedehe et al 2018 their impact on tws however varies based on soil type low level wind temperature and moisture with precipitation and downward radiation asides land water storage processes these components also play significant roles in the surface model behavior of soil moisture contents in tropical regions monthly terraclimate soil moisture data at 0 50 grid for the period between april 2002 to june 2017 was used in this study to improve our deep learning estimation of hydrological operations on continental tws 3 6 teleconnections and sea surface temperature products an overview of the entire datasets used in this study is highlighted in table 1 below more details regarding the teleconnection and sea surface temperature datasets can be found in supporting information 1 4 methodology 4 1 back propagation neural network bpnn the bpnn model applied in this study is used to derive relationships between the grace derived tws on one hand and hydrological fluxes teleconnections and ssts on the other hand the bpnn employs a probabilistic approach in its optimization in relation to the artificial neural network ann it has an explainable learning process flexible topological framework and minimizes possible over fitting see supporting information 2 in addition to their capability in minimizing over fitting the bpnns are multilayer feed forward neural networks which allow a unidirectional information flow some literatures refer to it as a multilayer perceptron procedure e g park et al 2015 this framework links the tws predictors fig 1 with the response variables through a series of successively arranged hidden layers which are made up of non linear elements called neurons the available neurons in the hidden layers initiate new variables based on the predictors from the previous layer which is multiplied with a variable specific weight factor and the addition of a bias term the use of the major hydrological fluxes of our test bed as a predictor was intended to reflect the swift response of surface flood related and groundwater drought related to hydrological effects across the african continent the influence of global teleconnection patterns and ssts on tws has been corroborated by several studies ndehedehe et al 2017 2018 ndehedehe ferreira 2020 ocean atmospheric coupling in the tropical atlantic has been identified as a key regulator of hydrological variability within several nearby river basins and sub regions de linage et al 2014 molinier et al 2009 and zeng et al 2008 also reported that the harsh 2005 and 2010 drought in the central and western amazon were the consequences of warmer tropical north atlantic sea surface temperatures ssts that stimulated northward shift of the itcz and minimized easterlies and moisture advections from the tropical north atlantic to the western and southern regions of the amazon during austral summer de linage et al 2014 therefore their use as tws predictors in this study is justified three combinations of these predictors were tested in this study the first consists of four most dominant hydrologic fluxes in the region i e precipitation evapotranspiration runoff and soil moisture products the second combination includes six sst variants i e nino1 2 nino 3 0 nino3 4 nino4 nta sta and eta and the third combination consist of four teleconnection parameters i e enso nao amo pdo and iod our modeled bpnn is a typical three neuron layer framework with one input layer 16 neurons four sets of hidden layers 6 neurons for each set and an output layer 1 neuron fig 2 the bpnn framework fig 3 allows network neurons from one layer to connect to all the neurons in subsequent layers but with no lateral links within any layer or the possibility of feedback connections apart from the input neurons i e x1 x16 which only links one input value with its corresponding weights wp 1 wp 96 the net input for each discrete neuron can be said to be the total of all input values each multiplied by its weight and a bias term zp which can be referred to as a unit weight from an auxiliary input goethals et al 2007 1 h p 1 i 1 n w p 1 x i z p h q 1 f h p 1 2 h q 1 i 1 n w q 1 h p 1 z q h r 1 f h q 1 3 h r 1 i 1 n w r 1 h q 1 z r h s 1 f h r 1 4 h s 1 i 1 n w s 1 h r 1 z s y p q r s f h 4 where p q r s 1 6 n 16 with eqn 1 to 4 being models of the first to fourth hidden layers respectively the output value y p q r s can be calculated by feeding the net input and the parameters from the hidden layers into the transfer function of the neurons 5 y p q r s f h 4 where h p 1 h q 1 h r 1 h s 1 represents neurons in the first to fourth hidden layers respectively w p 1 w q 1 w r 1 w s 1 are the varying weights originating from the input parameters to the fourth hidden layers respectively z p z q z r z s represents the supplementary weight implemented for better predictions for the first to last hidden layers respectively h 4 depicts a summation of the first to fourth hidden layers while y p q r s is the output which is directly a function of the fourth hidden layer but indirectly a function of the entire bpnn model when developing multi layer perception ann models a rule of thumb is that the number of neurons in the hidden layer must be about half the number of the input layer parameters and should not be more than twice as large long et al 2014 berry linoff 2004 therefore we set the number of hidden neurons to 6 for each of the sets through a trial and error method where bpnns having different numbers of different neurons were tested eqn 4 is subsequently distributed to a transfer function to compute outputs eqn 5 from the hidden neurons connections from the sets of hidden layers to the outputs layer are generated from a linear transfer function 6 grace t w s c s 1 6 w j p q r s z p q r s w j 0 our generated output predictand is the monthly total water storage changes twsc observed by the grace mission subscript j in eqn 6 represents the number of output neurons which in this case is 1 w j p q r s and w j 0 are the varying weights and the bias term of the output layer respectively our bp network was useful in solving the unknowns in eqns 1 to 4 and eqn 6 especially as it focused on the backward propagation of fitted uncertainties through the network to generate optimal weights for second and third layers fig 2 grace derived tws datasets from april 2002 june 2017 totaling 183 months were used for the entire experiment the first 80 of our grace dataset ranging from april 2002 may 2014 was used for the training and validation of the bpnn model while the last 20 ranging from jan 2014 june 2017 was used to test the performance of the trained bpnn model 4 2 principal component analysis pca pca has been widely applied in many data science problems for dimensionality reduction and feature extraction ziehe 2005 ndehedehe et al 2016b it basically works by statistically decomposing a given dataset into numerous dimensions while retaining interpretability and diminishing data loss the popularity and relevance of this statistical technique in climate science is majorly as a result of its proficiency and simplicity in the elucidation of optimized variance parameters even with a minimal number of principal components ndehedehe et al 2016a pca gives the best potential depiction of a p dimensional dataset in q dimensions by trying to amplify the variance in q dimensions the increasing trend in the statistical depiction of periodic signals integrated in multi resolution dataset has resulted in the implementation of the well known pca technique in several vital research areas which includes machine learning image processing bioinformatics or web data analysis as well as the analysis and regionalization of global geophysical time series information montazerolghaem et al 2016 ivits et al 2014 due to the ability of the pca model to linearly combine centered variables given the units of the corresponding parameters are the same motivated its integration into the bpnn framework for prediction purposes pca plays a key role in the rotation of space coordinates which has minimal impact on its data structure therefore the obtained pcs which are the linear combination of variables are known to replicate the fundamental datasets to the greatest degree and are uncorrelated with each other with the assumption that our data matrix has m variables x 1 x 2 x 3 x m 7 x x 11 x 12 x 1 m x 21 x 22 x 2 m x n 1 x n 2 x nm and n times observations in our experiment we normalized the input layer parameters by using the following method 8 y ti x ti x t s t where x t 1 n t 1 n x ti and s t 1 n 1 t 1 n x ti x t 2 for ease and convenience we still denote the normalized y ti as x ti let the eigenvalues of covariance matrix of normalized data be given by λ 1 λ 2 λ m 0 also we assume α 1 α 2 α m to be the equivalent eigenvector the ith principal component is such that f i α i t x where i 1 2 m usually λ k i 1 m λ i is known as the contribution rate of the kth principal component and i 1 k λ i i 1 m λ i is known as the aggregate contribution rate of the first k principal components the first k principal component is assumed to contain the most information of m original variables if the aggregate contribution rate goes beyond 85 liu wang 2011 4 3 independent component analysis ica the ica explores higher order statistical methods that apply statistical moments higher than first order ndehedehe et al 2016b it employs a statistically based identification algorithm to evaluate directional vectors in the form of independent models from a data matrix cardoso 1999 the technique estimates the undetermined dynamics of a system by rotating empirical orthogonal functions aires et al 2002 basically ica decomposes the time series of the given data matrix into a variety of statistically independent root indicators and a mixing matrix as illustrated in ndehedehe et al 2017 assume the measured indicator x t is a zero mean data vector measured at time t and the root indicator s t is a zero mean vector having independently mutual elements such that x t z s t where z is a full rank linear mixing matrix the technique implements a linear transformation as 9 y w t x t w t z s t a t s t so as to determine the solution of the ica model given that a z t w w represents an estimator of a row of the matrix z 1 and y is a linear combination of s i with a i showing the weight since the two independent random parameters tends to the gaussian distribution than the original parameters a t s maintains a better proximity to the gaussian distribution than any s i let w be a maximizing quotient of the non gaussian distribution of w t x this therefore implies that w t x a t s is equivalent to one of the independent parameters negentropy is implemented as a quantitative assessment of the measure of the non gaussian of a random parameter y this concept has a significant relationship to the original entropy which has been used substantially in information theory the entropy of a random parameter can be explained as the information degrees of a given observe variable liu wang 2011 the negentropy j is defined by 10 j y h y gauss h y where h y represents the entropy given by h y p y log p y d y p y is the probability density while y gauss is a gaussian random vector which has an equal covariance matrix with y the negentropy is always less than zero however the only condition for it to be zero is if and only if y follows a gaussian distribution for the estimation of negentropy the approximate computation technique is usually implemented which is given as 11 j y c i e g i y e g i v 2 where c i represents some positive constants v is a gaussian parameter with unit variance and zero mean and g i represents some non quadratic functions this procedure regardless does not guarantee an accurate approximation therefore with the integration of a non quadratic function g we modify the approximation to 12 j y e g y e g v 2 where g y e y 2 2 if the indicators are reiteratively monitored the measured indicators are denoted as original indicator matrix xic when the matrix w the discrete matrix is the inverse of the mixing matrix z the independent component matrix 13 y w x i c has the potential of estimating root indicators s where one row of matrix y represents independent vectors this study however applies the ica technique based on a fixed point algorithm to solve the independent matrix y 1 additional details regarding the numerical steps mathematical formulations and computational routines of the ica technique have been documented in these literatures e g ziehe 2005 theis et al 2005 cardoso 1999 common 1994 4 4 pca bpnn model the bpnn requires a coarse correlation fit for the original 16 input variables table 2 because a good correlation between them signifies that they are composed of more repeated information and as such may result in the reduction of the prediction accuracy of the model while increasing the computational complexity of the entire process liu wang 2011 however our independent variables have been earlier shown to contribute substantially to the fluctuations of the tws in their own peculiar modes the pca technique was applied to the 16 input parameters which have been grouped into hydrological fluxes teleconnection patterns and ssts to generate new variables for the prediction model as follows step one normalize the independent parameters the input layer consists of the independent parameters with varying orders of magnitude therefore it is pertinent to normalize each of the parameters before applying the principal component analysis yang et al 2009 14 x i x i m a x x i the function expressed in eqn 14 attempts the normalization at 0 1 step two the correlation coefficient matrix r is obtained using the normalized data from step one 15 r r ij 16 16 r ij 1 n i 1 n x ii x ij i j 1 2 16 the function expressed in eqn 15 attempts the generation of the r values step three using the generated r values from eqn 15 we compute the characteristic vector and characteristic value and determine the corresponding principal components the monthly temporal patterns of the input parameters from april 2002 june 2017 yield 183 characteristic values λ i i 1 2 183 λ i represents the variance of the principal components the λ i values are arranged in a decreasing sequence λ i λ 2 λ 183 0 as well as their corresponding characteristic vectors l 1 l 2 l 3 l 183 so that the ith principal component can be determined by applying the function 16 y pc i l 1 x l i 1 x 1 l i 2 x 2 l i 16 x 16 where i 1 2 16 step four sum the orderly sets of principal components to allow the accumulated input rate of the variance a i 1 m λ i 1 m λ i to exceed a certain threshold for this study we choose 99 the principal components is computed as y pc 1 y pc 2 y pc 3 y pc m m 184 for every discrete value λ i i 1 2 183 and y pc i i 1 2 m as a linear integration of x i we now take the m principal components as the input parameters for our bpnn model this results in inputting the newly determined m principal components into the bp network and then with the aid of the pca bpnn model we make our optimized predictions 4 5 ica bpnn model for the proposed ica bpnn model fig 3 the independent components of the original 16 input variables are first extracted using the ica technique the discrete independent component ic components of the parameters are characterized by the feature of the original datasets the noisy ic which is regarded as the least effective information of original dataset is also identified in the training after the identification and removal of the noise ic the remaining ic components are used as the input of the bpnn mode recall that from the pca method the generated pcs were only eliminated by correlation however the generated higher order statistics with the ica are independent of each other liu wang 2011 in statistical theory it is believed that independent is a more robust condition than uncorrelated this however is uncovered in the prediction accuracy of the two techniques the basic procedure in this model is to uniquely detect the noise ics after the generation of the latent ics this study however adopts the testing and acceptance tna procedure see cheung xu 2001 liu wang 2011 in solving this problem each of the input variables is considered as a row given the 183 monthly dataset of the 16 original input parameters we derive a matrix x ic of size 16 183 by the ica method explained in eqn 11 the separate matrix w and the independent component matrix y can be generated each row of y the yi of size 1 400 represents an ic each ic represents has been observed to represent different features of the original input layers from previous studies liu wang 2011 we now employ the tna technique in identifying the noise ics the obtained m ics are considered prior to the introduction of the tna we excluded one ic for each iteration and used the remaining m 1 ics to reconstruct the original input matrix let the excluded ics be represented by y k and the reconstructed original input variables be represented by x r 17 x r i 1 i k m a i y i 1 k m where x r x 1 r x 2 r x m r t x i r represents the ith reconstructed variable a i depicts the ith column vector of mixing matrix a which is the inverse of the separate matrix w eqn 9 while y i is the ith ic considering the cases k 1 2 m which entails the repetition of m iterations with the exclusion of one ic we introduce the well known relative hamming distance rhd in estimating the reconstruction error between the priori original and apriori reconstructed parameters which is given as 18 rhd 1 n 1 i 1 n 1 r i t r i t 2 where r i t s i g n a i t 1 a i t r i t s i g n pr i t 1 pr i t in this modeling s i g n p a r a m 1 if param greater than 0 s i g n p a r a m 0 if param 0 and s i g n p a r a m 1 if param 0 also a i pr i and n depicts the actual value the predicted value and the total number of data points respectively with the rhd reconstruction error it is possible to estimate the comparison between the original input parameters and their corresponding reconstructed parameters the rhd shows a higher similarity between the original and corresponding reconstructed parameters if the value is closer to zero conversely when the rhd value is farther from zero it explains that the eliminated ic contains more vital and effective information of the original dataset while depicting the low similarity between the original and reconstructed parameters it is pertinent to find out the reconstruction which guarantees the rhd value closest to zero as it tends to make the most accurate predictions in allusion to the original 16 parameters table 3 represents the rhd reconstruction errors of each iterate table 3 shows that the value of rhd which is reconstructed by using ic1 ic2 ic3 ic4 ic5 and ic6 and eliminating ic7 is the smallest it is deduced that the ic7 contains the least information and ic7 represents the noise ic therefore ic1 ic2 ic3 ic4 ic5 and ic6 were conducted as the input of the proposed ica bp model while ic7 was removed from our training fig 3 4 6 initialization in this exercise a back propagation neural network containing three fully interconnected layers input hidden and output is considered the last neuron of the input and hidden layers is considered a bias node having a resultant output equivalent to 1 assuming the input layer is characterized by available p patterns for the network training then we can represent the totality of the input parameters as an n 1 matrix having p rows and n 1 column with all records of the last column equaling 1 analogously the target dataset can be composed by a matrix w having p rows and m columns supporting information 4 the weights between the neurons in the input and hidden layers form a matrix w with entries w 1 j j i 1 n j 1 n 1 where each discrete w 1 j j interacts with ith neuron of the input layer with the jth neuron of the hidden layer this therefore results in the representation of the hidden layer output as a hidden o u t f 1 w 1 a input i n given that a input i n depicts the transpose of the input matrix similarly the interaction between the neurons weights in the hidden and output layer births a matrix w 2 i j i 1 m j 1 n 1 given that each discrete weight w 2 i j connects the jth neuron of the hidden layer with the jth neuron of the output layer this signifies that from the input through to the output layer the interaction can be represented by the matrix a o i n with n 1 rows and p columns the optimal initial weights of the proposed bpnn with four hidden layers can be evaluated further through minimization as it results in a linear least square problem using the qr factorization technique based on the householder reflections or singular value decomposition algorithm the solution to the linear least squares problem can be obtained containing the optimal weights linking the four hidden layers to the output layer supporting information 4 more details on this procedure can be found in qadir et al 2020 chow cho 2007 4 7 machine learning framework the accuracy index of any technique is usually measured by the trade off amount between calculation interval and performance the bpnn has gained substantial popularity as an optimal training algorithm for prediction studies see maier and dandy 2000 cherkassy and lari najafi 1992 its robustness and ease in implementation make it often preferred to other neural network models for predictions when a sufficient number of relatively noise free parameters are used as input the bpnn network proves to be a superior learning method regardless of the complexity of the specific domain problem walczak cerpa 1999 inasmuch as the bpnn has been prided to have the ability of withstanding noise in the training dataset during its training too many errors in the training may prevent the neural network from learning the desired model goethals et al 2007 walczak and cerpa 1999 recommended the implementation of other learning methods in the case of very few or extremely noisy training datasets algorithms such as the radial basis function networks and the counter propagation networks has been reported to perform well in domains with limited training datasets as well as insufficient and noisy input parameters walczak cerpa 1999 fausett elwasif 1994 barnard wessels 1992 it is noteworthy to point out that the performance of the pca and ica bpnn algorithms is optimized if the operation of several input functions such as the learning rate momentum term error and transfer function is superlative maier and dandy 2000 suggested that the sigmoid transfer functions are one of the most frequently used which includes the hyperbolic and logistic tangent functions the use of other functions such as the linear functions or hard limit functions has also been reported in past studies hagan et al 1997 the error function is the function that is minimized during the training process goethals et al 2007 the mean square error function is the most commonly used error function however an independent and normal error distribution is recommended so as to obtain optimal results this however is not usually the case when the training datasets are heavily composed of outliers maier and dandy 2000 liano 1996 proposed the least mean log squares lmls error function to overcome this problem the learning rate has a direct proportion with the size of the steps taken in the weight index basically learning rates are fixed during the training process and with the use of trial and error methods the optimal learning rates are determined a momentum term is usually integrated into the training algorithm so as to improve convergence rate hagan et al 1997 and learning speed qiann 1999 if the momentum term is greater than 1 0 the training procedure will never converge dai macbeth 1997 this therefore resulted in the suggestion of a learning rate of 0 7 with a momentum range of 0 8 to 0 9 or a learning rate of 0 6 with a momentum of 0 9 by dai macbeth 1997 qiann 1999 on the other hand determined the bounds for the convergence on momentum parameters and learning rate and displayed that the momentum term can enhance the index of learning rates over which the model converges goethals et al 2007 4 7 1 number of hidden layers an increased number of hidden layers allow a neural network to enhance its closeness of fit whereas a smaller number improves the smoothness or extrapolation proficiency of the network walczak cerpa 1999 a neural network with one hidden layer can be likened to perform linearly and has the capability of estimating any function as long as the hidden layer consists of sufficient functions however some studies suggest initiating with at least two hidden layers flood kartam 1994 our study however implemented the trial and error method to determine the optimal number of hidden layers which was based on the experience of the dataset this strategy was implemented because of the highly problematic dependence of many optimal network geometries 4 7 2 number of hidden neurons the number of neurons in the input layer is largely determined by the number of model inputs while the number of neurons in the output layer is equivalent to the number of model outputs however the choice of the number of neurons in the hidden layer s is also a crucial aspect in the determination of the training accuracy index few hidden neurons provide faster training but results in scarce feature detectors while more hidden neurons result in longer training period bebis georgiopoulos 1994 for example if two homogenous networks having similar errors on the training datasets with varying hidden layers are compared the one with few hidden units is likely to produce a more reliable prediction on new cases whereas the more complex one while diminishing the model s ability to generalize on new datasets also has an increased chance of over fitting on the training dataset özesmi özesmi 1999 hung et al 1996 the study undertaken by hecht nielsen 1987 reported that any continuous function with xi inputs in the range 01 and xo outputs can be denoted by a feed forward procedure having 2xi 1 hidden neurons other studies have also proposed the rule of thumb in the determination of the quantity of neurons in the hidden layer while some are based on the number of existing training samples others are focused on the number of input and or output neurons available for the exercise the pioneering rules that suggest the number of hidden neurons as a function of the quantity of input and or output nodes are given in supporting information 5 other studies have also attempted to base the number of training samples nts on the number of connection weights available in the network if the training sample quantity has been fixed an indication of the optimal parameters of connection weights to avoid over fitting can only be achieved by inverting these rules shown in supporting information 6 using the number of connection weights and the number of input and output neurons it is possible to estimate the number of hidden neurons given the divergent nature of the rule of thumb procedure which was actually used in our exercise it was pertinent to consider the number of training samples nts derived after decomposition table 3 and the number of input parameters xi which was the same for both the pca and ica bpnn models for example if only one hidden layer is to be used then the number of connection weights should not be more than nts 0 1 and the number of hidden neurons should not be less than xi xo 0 5 theoretically one sure way of meeting these two conditions is to have a relatively large number of training datasets walczak cerpa 1999 on the other hand suggested that the number of hidden neurons in the last layer should be equivalent to the number of decision factors utilized by domain connoisseurs in attempting the solution of the problem decision factors are the discernable constituents that make up the distinct categories of the input vector system it is largely determined by the number of heuristic rules or clusters utilized in an expert framework goethals et al 2007 alternatively other techniques that promise automatic configuration of hidden layer and neurons parameterization may be utilized see anders korn 1999 nabhan zomaya 1994 bartlett 1994 4 8 deseasonalization of grace derived terrestrial water storage and its multivariate analyses in relation to climate modes we adopted the strategy of eliminating trends and harmonic components of the grace hydrological signals i e deseasonalization so as to properly evaluate the footprints of global climate modes in grace derived tws over the african continent our analysis made use of the residual from deaseasonalization hereafter referred to as dtws in the individual assessment of each independent component the harmonic components and tws trends were compartmentalized from the grace time series using the procedures adopted from ndehedehe et al 2017 this was executed through the parameterization techniques based on the multi linear regression technique kalu et al 2021a ndehedehe and ferreira 2020 19 y m n t ρ 0 ρ 1 t ρ 2 sin 2 π t ρ 3 cos 2 π t ρ 4 sin 4 π t ρ 5 cos 4 π t ρ 6 n t φ n e t where the grid locations are represented by m n the time in years is t the constant offset and linear trend is shown by ρ 0 and ρ 1 respectively the annual signals are shown by ρ 2 and ρ 3 and the semi annual signals are shown by ρ 4 and ρ 5 the amplitude of tws dynamics characterizing the occurrence of large scale ocean atmospheric interplay is represented by ρ 6 the normalized time series generated after the elimination of the long term mean of each climatic mode is represented by n the phase lag between the tws time series and each climate index is represented as φ n while the random error term with respect to time is shown as e t the residual component obtained after the elimination of the linear rates eqn 19 and harmonic components ndehedehe and ferreira 2020 is assumed to consist of prevalent slow dynamic climatic occurrences and other sub regional forcings kalu et al 2021c the application of the local least squares polynomial approximation based filter savitzky and golay 1964 was employed in smoothing the effects of low frequency noise for both dependent dtws and independent precipitation and climate modes parameters the deseaonalized x dtws signal parameters is characterized by 20 x dtws y t ρ 1 t ρ 2 sin 2 π t ρ 2 cos 2 π t ρ 4 sin 4 π t ρ 5 cos 4 π t the need to statistically identify the integrated periodic signals in multi resolution climate datasets is on the rise and has led to numerous applications of pca and ica in the regionalization of climate patterns as well as the assessment of geophysical time series around the globe e g ndehedehe and ferreira 2020 ndehedehe 2019 kalu et al 2021c given its efficiency in separating inter annual signals and long term periodic variations ndehedehe et al 2016a it is the most widely applied statistical tool in climate science grace hydrological signals over the african region are relatively strong and characterized by strong annual and semi annual components which contribute to the difficulty in masking residual variabilities induced by large anomalies of the surrounding oceans and climate teleconnection patterns the use of cumulant statistics to decompose our input layer datasets enhances the perception of these obscured signals to facilitate localization of their signal influences thus making it possible to concurrently relate their temporal evolutions with those of the climate modes after the cumulant decomposition of x dtws the evolving independent mode dtws of variability was compared with the normalized scatter plot of each climate mode to determine their interaction range fig 4 the use of the smoothing spline algorithm was necessitated as a result of the noise impacts in the individual datasets to avoid over fitting of the smoothing spline we adopted the standard k fold validation procedure especially given their efficiency in smoothing spline models kim gu 2004 5 results and discussions the bpnn used in our analysis learns with a significantly higher learning rate especially with an optimized set of weight and bias parameters the back propagation technique was duly enforced to perform learning on our multi layer feed forward neural network given that the back propagation technique learns a set of weights to achieve an optimized weight and bias parameter to generate the best fit the process was duly performed for the pca loss 0 4 and ica loss 0 1 back propagation neural models these results were expected because the original input parameters were optimized prior to the testing phase of the deep learning technique using the pca and ica for the pca bpnn mode we normalized each of the 16 input parameters within the range of 0 and 1 given that they contain varying orders of magnitude however before the principal component analysis is applied the correlation coefficient is obtained from the normalized data which is used to generate the characteristic vector and the characteristic values and finally determine the corresponding principal components of the input layer parameters with the monthly temporal patterns of the input parameters yielding 183 characteristic values and their corresponding characteristic vectors i e april 2002 june 2017 the principal component values are averaged to allow the accumulated input rate of the variance exceed the 99 set threshold for the model this led to the construction of our pca bpnn network whereas for the ica bpnn mode it was pertinent to first extract the individual ic components of the original input parameters given that the ica uses a filtering system we were tasked with the identification and removal of a noise ic which if not removed could impede the accuracy and efficiency of our proposed model the tna technique was used in the identification and removal process given that the ic7 provided the least rhd value it was eliminated from our analysis the rhd algorithm also served as a reconstruction tool in estimating the comparison between the original input parameters and their corresponding reconstructed parameters then we used the first 146 months of each of our independent pca bpnn pc1 pc6 and ica bpnn ic1 ic6 and dependent parameters pca tws pc1 tws pc2 tws pc3 and ica tws ic1 tws ic2 tws ic3 to train for the two models prior to the training of both models we confirmed their synchronization with the csr tws time series our developed models were used in predicting the temporal patterns of the three dominant independent modes of the grace tws before overlaying our entire data for general predictions we tested our trained results using the remaining 37 months dataset and got an average fitting of 88 the details and results of the machine learning framework and assimilation process are discussed further 5 1 impacts of global climate modes on grace hydrological signals part of our objectives for this study was to delineate the impacts and contributions of global teleconnection indices and sst products on continental land water storage using a third pca and fourth order cumulant ica decomposition procedure this was useful in the recognition of significant modes of the deaseasonalised tws which was duly correlated with the normalized indices as represented in fig 4 given that the sst index performs best when tested over relatively smaller localized regions such as river basins ndehedehe and ferreira 2020 we explain that our r index was significantly affected by the large spatial extent of the study region as our strongest correlation with tws was recorded at 0 6714 for the nino 3 0 index our analysis showed that all nino indices as well as the iod maintained the strongest climatic mode influence on the african region figs 4 and 5 however the strength of their influences is mostly felt in the sub saharan region of the continent which houses most of the major river basins in the continent e g congo nile niger and zambezi river basins prior to deaseasonalization procedure we used the spearman s correlation r to determine the extent of relationships between global climate indices and tws fig 1 table 2 iod and sst anomalies of the pacific oceans nino 3 0 and nino 3 4 which corresponds to the enso region show the highest association with the spatial evolutions of tws over the entire african region r 0 5744 0 6714 0 6191 for iod nino 3 0 and nino 3 4 respectively table 2 and fig 7 generally independent patterns of tws dynamics over the study region is largely associated with the iod signals fig 1 the pdo and nao signals showed a weak relationship with the regions tws r 0 2817 and 0 2764 respectively while the enso r 0 4335 nta r 0 3883 amo r 0 3370 eta r 0 2965 sta r 0 3752 and sst parameters of the south pacific ocean nino 1 2 r 0 4733 and nino 4 r 0 3957 exhibited moderate relationships on the region s tws fig 1 the relationships of these climate modes with the spatio temporal patterns of the tws over africa fig 1 highlights the substantial footprint of global climate over the continent from the localized spatio temporal patterns generated from cumulant decomposition dtws we notice higher tws amplitude towards the west east and central african regions these sub regions are key hydrological hotspots hosting the largest river basins in the region figs 5a m in the west east and central sub regions the influence of nino 1 2 nino 3 0 nino 3 4 nino 4 0 sta enso pdo and iod results in considerable magnitudes of over 30 mm to the amplitudes of tws figs 5b e g i l m the influence of these climate modes to the deseasonalized tws in our study region strongly corresponds with their temporal relationships with tws in the study region figs 5a m given that the nino indices are signals from the enso region which is duly characterized by the eastern and central pacific it follows therefore that the tws dynamics over the western and central african regions are driven by the enso phenomenon ndehedehe et al 2017 notwithstanding the low association of the pdo and nao signals with the un deseasonalized tws fig 1 in all hydrological regions the tws estimation based on climate induced amplitudes were only restricted to the pacific ssts i e ninos 1 2 3 0 3 4 4 0 enso pdo iod amo nao and eta building on the work of phillips et al 2012 we corroborate their assertions on the influence of el nino induced water deficits i e positive phase and increased tws i e negative phase caused by la ninas in the tropical region as a direct contributor of sst anomalies in the surrounding oceans ndehedehe and ferreira 2020 also the grid based interactions between these climate modes and the regions tws shows that the land water storage in much of sub saharan africa is influenced by the pacific atlantic and indian ocean teleconnections figs 6a m this was significantly captured after the elimination of trends and harmonic components of the grace hydrological signals see section 4 7 inasmuch as nao and amo showed relatively minor influence on tws figs 5j k and 6j k pacific indices nino 1 2 nino 3 0 nino 3 4 and nino 4 0 tropical atlantic nta eta sta as well as the pdo and iod exhibit significant influence over the regions tws showing relatively higher correlations ranging from 0 6 to 1 figs 6 b e f i l m we also noticed an odd interplay of the nao atlantic indices to the region s tws given that they maintain a close proximity to each other the nao showed a weak relationship to the region s tws fig 1 and also exhibited minute influence fig 5j and correlation fig 6j to the regions deasonalized tws this contradicts the assertion by ndehedehe and ferreira 2020 suggesting that the influences of sst from relatively closer oceans on tws exhibit high correlations however other atlantic modes such as the nta sta eta and amo exhibited good inter relationships with the region s tws thereby corroborating the earlier assertion made by ndehedehe and ferreira 2020 this also explains that the strong influence of pacific contributions such as the el nino la nina interplay to africa s tws exceeds that of the atlantic regardless of the proximity between them fig 1 5 2 identifying dominant independent patterns from existing data the process of dimension reduction is a mandatory strategy in our experiment and is aimed at keeping the problem of identifying independent modes on a grid as well as their statistical interrelationships numerically manageable this phase has to be implemented before constructing the mathematical interplay between the independent and dependent parameters the process also helps in enhancing the prediction skills of the statistical approach used here especially by playing down on the redundant datasets and excluding from our modeling phase table 3 dimension reduction and separation techniques are employed here using the pca and ica algorithms respectively to the predictors hydrological fluxes ssts and climate indices and the predictand grace derived tws as earlier stated principal component analysis is a classical procedure in statistical data analysis data reduction and feature extraction aimed at explaining observed signals as a linear integration of orthogonal principal components the linear combination generated from eqn 8 depicts the predictand tws as orthogonal whereas the generated uncorrelated variables eqn 16 known as the principal components explains the spread variances the coefficients of this linear combination are referred to as loadings and they provide the weights of the original variables in the pcs the empirical orthogonal functions eofs which are generated by computing the eigenvalues and eigenvectors of a spatially weighted anomaly covariance matrix of any input field it represents the spatial distribution or patterns of the input parameter such as tws and is used in understanding the spatial modes of variability and how they change in time the eof pca pair which is often referred to as pc mode ndehedehe et al 2016a because of its usage of the covariance matrix makes it ideal for climate analysis in addition to extracting pcs that highlights areas with high temporal variability the loadings are generated from the normalized eigenvectors which explains the fraction of the total variance derived from the statistic for the independent component analysis on the other hand the deseasonalized signals of the input parameters e g grace derived tws is stored in a matrix x dtws eqn 20 and is further decomposed into spatial and temporal components using eqn 9 from y w t x t we can extract that the columns of x t contains the t dominant unit less temporally independent components ics of tws and the columns of w represents the corresponding spatial maps each column of x t i e temporal pattern along with their corresponding column of w i e spatial pattern depicts an independent mode of variability this was also implemented in the temporally entered extraction maps of the predictors i e hydrological fluxes ssts and teleconnections in the sst extraction we experiment with different t indices to emphasize that the quantity of retained modes from different datasets are not necessarily homogenous forootan et al 2014 in our experiment we noticed that the spatial patterns associated with the independent modes of tws column vectors of eqn 6 pca and eqn 7 ica were stable this therefore implies that spatial patterns are not extremely volatile to varied time series information in case of relating two datasets e g an 8 year and 12 year dataset therefore for both pca bpnn and ica bpnn models we link the temporal components of the predictor datasets i e all columns of x t derived from hydrological products ssts or teleconnection patterns to individual pcs or ics of the predictand i e tws as the case may be the first second and third independent modes of the tws anomalies derived from grace for the two statistical frames are shown in fig 7 the first dominant independent pc mode which explains 67 31 of the variance characterizes the annual water variability over the study region from april 2002 june 2017 the spatial pattern of the first principal component fig 7 depicts a concentration of annual variability to be most dominant over the west african region which houses the niger senegal and volta river basins and the eastern and central african region housing the famous congo river basin the second pca modes of grace tws contain inter annual variability depicting a concentration of the eof loadings over the far end of the west african region and towards the southern african region the trend is homogenously characterized as a net tws loss of the depicted regions figs 8 b e this explains 11 83 of the total variance of the study region the third pca mode explains the least variance with 6 20 of the total variance characterizing another inter annual variability of the study region its spatial pattern depicts a concentration of inter annual variability to be most dominant over central africa with a net tws gain this can largely be attributed to the presence of the congo river basin in the region which has been known to drive hydrological fluxes over the central african region kalu et al 2021a the statistically significant pcs which are represented by the first three pc modes figs 8a c gave a cumulative variance of 85 34 and were assumed as statistically significant signals denoting over 95 of the total tws fluctuations over the study region the results from the independent component analysis were similar to the pc results with the first second and third ic modes maintaining 68 22 11 52 and 6 85 of the regions variance respectively the cumulative variance of the ic modes is 86 59 and is assumed to consist of the most significant signals responsible for tws fluctuations in the study region the temporal evolutions of the ic are also characterized as annual for the first fig 7j and inter annual variations for the second fig 7k and third fig 7l similar to the pc temporal evolutions figs 7d f the pc and ic results correspond to the annual fig 8a and semi annual fig 8b amplitude of the region s tws as well as the trend dynamics fig 8c the west and central african region contribute mostly to the fluctuations in tws this was expected as they house the biggest river basins that contribute substantially to the dynamics of hydrological fluxes in the region the substantial impacts of hydrological changes in our test bed also warranted our usage of localized hydrological products fig 1 as input predictors to help maintain the stability and robustness of our model estimates their influence in regulating the tws dynamics of any region is well captured in the water budget equation chen et al 2020 and tends to provide the most dominant influences in tws dynamics than other global predictors such as ssts and teleconnection patterns our model attempts to predict these normalized temporal patterns of the pc and ic modes for the three most dominant features as shown in figs 7d f pc and 7j l ic using a decomposed pc and filtered ic version of hydrological products ssts and global teleconnection patterns these patterns maintain significant relationship between each other as well as the region s tws dynamics fig 8f supporting information 7 summarizes the percentage variance of all the modes used in this study 5 3 predicting total water storage for predicting tws using the pca bpnn and ica bpnn algorithms we used 80 of our overall grace tws datasets april 2002 may 2014 for training and the remaining 20 of the data june 2014 june 2017 were used to test the performance of our models our inputs for prediction were optimized prior to its inclusion to the machine learning framework section 5 1 for the pca bpnn we used the independent variables with varying order of magnitude fig 9 a whose eigenvectors i e loadings served as our model input figs 9b c the box plot in fig 9a shows the normalized magnitude for all input parameters having their median values at 0 02 precipitation 0 18 evapotranspiration 0 08 runoff 0 10 soil moisture 0 10 nino 1 2 0 08 nino 3 0 0 00 nino 3 4 0 10 nino 4 0 0 12 nta 0 00 sta 0 10 eta 0 10 enso 0 00 nao 0 00 amo 0 05 pdo and 0 00 iod using the characteristic vector and characteristic value generated from the r values we were able to generate the loadings used to predict the grace derived tws for the training period for the ica bpnn model we employed the basic procedure of detecting the noise ic after the initiation of the latent ics using the tna procedure we were able to identify the noise ic i e ic 7 this was implemented using the rhd procedure which estimates the reconstruction error between the original and reconstructed parameters given that the rhd shows a higher similarity between the original and reconstructed parameters we were able to detect ic7 as the parameter whose value is closest to zero and removed it from the training to avoid compromising our test datasets table 3 using the optimal weight and bias parameters we generated table 4 which represents some of our test results for both the testing and training phase fig 3 to regulate the indefiniteness of the hessian h matrix we set the determining parameter to 5 0 10 5 the marquardt adjustment parameter ranged from 1 0e to 03 to 1 0e 07 to obtain the best minimum of our non linear function over our space of input loadings for evaluating the performance of our proposed pca bpnn and ica bpnn models we selected the two sets of input datasets to analyze the models by comparison especially since the two of them were predicting the same quantity using the last 20 ranging from june 2014 june 2017 we were able to test the performance of the trained bpnn models 5 3 1 training step to compute the optimum pca bpnn and ica bpnn we inserted the first 146 months of each mode of grace derived tws fig 7 and the first 146 months of all temporal modes of hydrological fluxes ssts and global teleconnection patterns supporting information 7 in equations 16 and 13 respectively before performing the training step of the bpnn model we ensured that our time series datasets were duly synchronized with the csr tws time series this was then followed by running the bpnn simulation step for both pc and ic modes given that we want to keep our prediction simple we did not consider higher orders of the pc bpnn and ic bpnn models for both the predictors and the predictands our numerically simulated results for both pc1 pc6 and ic1 ic6 of grace tws suggest that the bpnn model provides the best fitting at optimal weight and seed values table 4 to validate our decomposed input datasets we applied the k mean clustering technique for all pc and ic input modes fig 10 the k meansuses a two phase iterative algorithm to minimize the sum of point to centroid distances summed over all k clusters the first phase implements a batch update procedure where each iterate contains reassigned points to their closest cluster centroid at the same time followed by a recalculation of cluster centroids in this phase it is always difficult to obtain a converged solution to a local minimum that is a partition of the data where moving any single point to a different cluster increases the total sum of distances although it is mostly employed for smaller datasets however it is fast but potentially only approximates a solution as a starting point for the second phase in the second phase the online update technique is implemented where points are individually reassigned to reduce the sum of the distances and cluster centroids are computed after each reassignment during this phase each iterate consist of one pass through all the points the phase easily converges to a local minimum even though other local minima with lower total sum of distances may exist generally obtaining the global minimum is computed by a complete choice of starting points however implementing various replicates with random starting points typically leads in a solution that is a global minimum the rms of differences between the simulated tws values from the bpnn models and the pc ics of the grace tws was used as the fit criterion our simulation results indicate that the pca bpnn models provide a fit of 89 82 and 84 for the first second and third independent modes of the pc grace tws while the ica bpnn model provides a fit of 93 88 and 82 for the first second and third independent modes of the ic grace tws for simulating the three dominant components of the grace derived tws figs 11 12 we also overlaid the temporal evolutions of the input pc and ic components fig 11 the simulation fit of the bpnn corresponding to pc2 fig 12b pc3 fig 12c ic2 fig 12e ic3 fig 12f are however lower than that of pc1 fig 12a and ic1 fig 12d this is largely due to the fact that they are characterized by temporal patterns appearing to be much more complex than the annual patterns of pc and ic1 respectively fig 11 therefore they might not have been fully captured by the predictors see fig 12 5 3 2 prediction step and performance assessment having simulated the bpnn model parameters for the three dominant independent modes of the grace tws we used the remaining time series ranging from jan 2014 june 2017 characterizing 20 of our input dataset for testing before overlaying the entire data for the general prediction the indicator time series of all pcs and ics shown in fig 12 were used in the prediction for april 2002 june 2017 the predictions were derived from equation 16 and 13 and their uncertainties were evaluated using the monte carlo approach training and prediction results are shown in fig 12 and table 4 the process of back propagating which is the basic essence of our neural net training was duly employed in this practice we fine tuned the weights and bias of our neural net based on the error rate which is also referred to as the loss function obtained in the previous epochs i e iteration it was necessary to obtain proper tuning of the weights as they ensure lower error rates making the developed model reliable by increasing its generalization for the first epoch the leftmost layer fig 2 which takes the randomly selected bias and weight term as well as the optimized pc and ic inputs begins the training the four layers in the middle which serve as the hidden layers also take the randomly selected bias term of 1 5 using the process of feed forward propagation we generate tws predictions which do not give us our desired result fig 13 as the weights and biases have not yet been tuned this is where the back propagation comes in the back propagation is all about feeding the loss function backwards in such a way that we can fine tune the weights with the help of the gradient descent optimization the weights of the networks are optimized to yield smaller loss in the next iteration this iteration was performed 13 times for the pca bpnn to achieve an acceptable error rate 0 4 and 15 times for the ica bpnn to achieve an acceptable error rate 0 1 table 5 we also used the confusion matrix chart to visualize the performance assessment of our prediction with the observed tws fig 14 the confusion matrix consists of a square matrix having only positive integers the matrix element i j is the number of times an observation of the ith true class was predicted to be of the jth class each color cell of the matrix in fig 14 corresponds to one element of the confusion matrix the fit of the forecast for the first leading modes of total water storage for both models when compared to the observed grace tws values after 10 months was found to be pca bpnn1 84 and ica bpnn1 89 respectively while the other three individual modes are characterized as follows pca bpnn2 67 pca bpnn3 61 ica bpnn2 73 ica bpnn3 65 whereas after 20 months the fit was reduced to pca bpnn1 55 and ica bpnn1 59 for the first leading modes while the second and third modes were reduced to pca bpnn2 48 pca bpnn3 44 ica bpnn2 45 ica bpnn3 40 our uncertainty propagation showed that after 20 months the standard deviation became too large which suggests that our proposed pca and ica model is more or less reliable for predictions of only up to 20 months fig 12b shows that the fit of the forecast is severely affected by multi annual climatic patterns irrespective of the comprehensive predictive parameters used which covered a wide range of the climatic drivers in the african continent our results indicate that the tws prediction from our bpnn models is closer to the observed grace tws dynamics over sub saharan africa when compared to hydrological modeling ndehedehe et al 2018 we found no apparent deviations from tws time series when the bpnn models were compared with the loadings and ics of the grace tws which means that the fit values reported from our experiment are significant this is a huge pointer to the influence of global climate indices in the assessment of tws over regions of significant hydrological interactions like africa as the study undertaken by ahmed et al 2009 over the same region reported a relatively poor performance of the narx model over the congo limpopo and nile basins which were used as test beds for their prediction we suggest that the exclusion of these teleconnection patterns as well as other important hydrological parameters contributed to the relatively poor fit of their study in the overall performance validation carried out in the study the authors reported very good over six watersheds good over one and satisfactory over the remaining basins among other factors the authors attributed the satisfactory performance to prolonged climatic cyclicity that was not adequately represented in the model training phase which is in line with our suggestion in this study however we must also note that including teleconnection parameters in relatively smaller regions such as the limpopo river basin may not produce good prediction results as the influence of these global climate indices are almost insignificant in small river basins like the limpopo river basin however this is left as future dispute to be handled in coming studies for inter annual time scale series figs 7e 7f 7 k 7 l 12b 12c 12e 12f specific care should be taken given that the simulation and prediction of the bpnn models are very sensitive to the temporal patterns of the input parameters when ic s of the predictors are not well defined for e g due to the inclusion of the noise ic generated from the rhd parameters the inter annual forecast of the bpnn might perform very poorly this was tested by the inclusion of ic7 in our input signals results not shown the bias generated from the test was largely found in the interannual predictions of tws 2 and tws 3 and was attributed to the inclusion of the noise ic in the predictions we used the outliers generated from table 4 to plot a residual plot for the two bpnn models fig 15 given the fit levels of our bpnn models our results therefore support the idea of using the presented statistical approach to forecast tws dynamics over the african region 6 conclusion and outlook the rapidly changing dynamics of the global water cycle caused by the intensifying actions of global climate trigger complex processes that make conventional machine learning techniques limited in quantifying the extent of such changes on tws to this end the novel integration of principal component analysis pca and independent component analysis ica to the back propagation neural network bpnn was employed to assess the complex interaction of hydrological fluxes and climate variability indices from well known oceanic hotspots indian atlantic and pacific with freshwater dynamics over a continental scale the bpnn technique propagates the total losses back into the neural network to understand how much of the loss every node is responsible for and subsequently updates the weights in such a way that minimizes the loss by giving the nodes with higher error rates lower weights and vice versa the statistical framework and efficiency of our proposed model is explored using a 15 year grace data which served as the dependent variable against sixteen independent variables the key outcomes from our study are summarized as follows i we identified the strength of the pacific indices in regulating tws against the atlantic indices in the african region this shows the extent and contributions of the well known el nino and la nina oscillations dominant in the pacific in controlling hydrological fluxes and patterns in africa the contributions of the india ocean dipole iod and the ninos nino 3 0 and nino 3 4 were also seen to have very strong influence on the regions tws while other global teleconnection indices provided average contributions towards the region s tws ii our simulation results indicate that the pca bpnn models provide a fit of 89 82 and 84 for the first second and third orthogonal modes of the pc grace tws respectively however the ica bpnn model provides a better fit of 93 88 and 82 for the first second and third independent modes of the ic grace tws for simulating the three dominant components of the grace derived tws our uncertainty propagation showed that after 20 months the standard deviation became too large which suggests that our proposed pca and ica model is more or less reliable for predictions of only up to 20 months with the use of a confusion matrix and a residual plot we analyzed the performance of our predictions and given the minimum bias and fitting index of the ic modes we found out that the ica bpnn model performed better than the pca bpnn model iii the perceived roles of human induced climate change are expected to lead to an increased tws variability this is evidenced in several sub regions of the african continent experiencing higher precipitation and tends to have stronger amplitude and changes in hydrological fluxes and tws for e g the congo and volta river basins some studies have argued that the interplay between the role of human alteration of the natural system and the effects of global climate teleconnections on the regions tws results in complex hydrological processes in this study we pioneer a new deep learning assimilation method for the reconstruction of tws using the ica bpnn and pca bpnn models as well as a thorough investigation of the links between multi global climate teleconnection patterns and variations in continental freshwater tws however further investigation is essential to adequately quantify the contributions of non idealized natural systems i e human water management and other forms of anthropogenic influence such as deforestation on tws over africa as observed by grace satellite iv the pca bpnn proved efficient in assessing location specific impacts of hydrological anomalies while the ica bpnn through its filtering mode provided a more suitable approach in identifying the footprints of large scale hydrological changes in africa given that the climatic pattern in africa mimics that of the global patterns continent wide regions experiencing large scale oscillations such as south american and asia can benefit from this model especially in their assessment of freshwater dynamics based on their varying hydrological processes and global climate actions credit authorship contribution statement ikechukwu kalu writing original draft writing review editing methodology formal analysis conceptualization investigation software christopher e ndehedehe conceptualization supervision software investigation formal analysis methodology writing original draft writing review editing onuwa okwuashi conceptualization writing review editing formal analysis aniekan e eyoh resources supervision vagner g ferreira writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was part of a series of preliminary machine learning experiment that was conceptualized and initiated by dr christopher e ndehedehe based on his australian research council arc project for the 2023 discovery early career researcher award decra christopher is grateful for the arc decra de230101327 funding and also thankful to griffith university s australian rivers institute for the conducive research environment supporting his strategic research in remote sensing hydrology and where the arc decra is hosted appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128498 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2808,one of the most important parameters in the design and implementation of drip irrigation systems is the accurate prediction of the wetting dimensions pattern around the emitters which leads to the precise determination of the distance between the emitters and the drippers this search provides a comprehensive experimental and computational investigation to predict accurate wetting patterns dimensions and area in the layered textural soil profiles under pulse drip irrigation to achieve this first 1217 sets of experiments including the physical and hydrometric properties of two layered soil profiles under plus drip irrigation were carried out at kurdistan university iran then a new hybrid deep learning dl approach comprised of boruta extreme gradient boosting boruta xgb feature selection incorporated with the bidirectional gated recurrent unit bi gru scheme was designed to predict the diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a for each scenario the most influential predictors in terms of input combinations c1 c2 and c3 were extracted among nine available inputs using boruta xgb employed in the bi gru model the multilayer perceptron neural network mlp and adaptive boosting tree aadaboost were also developed as benchmark comparing models based on several metrics e g correlation coefficient r root mean square error rmse and kling gupta efficiency kge and various infographic analyses the outcomes demonstrate that the c3 combination includes the elapsed time emitter outflow rate q initial soil moisture rate θ 1 θ 2 saturated hydraulic conductivity ratio k s 1 k s 2 the ratio of irrigation time in a cycle to the entire cycle time t irr t tot and the ratio of silt sil t 1 s i l t 2 with bi gru yielded better accuracy in terms of r 0 994 rmse 1 295 cm and kge 0 989 for d scenario r 0 995 rmse 1 489 cm and kge 0 992 for v scenario and for a scenario r 0 996 rmse 76 624 cm2 and kge 0 976 than mlp and adaboost models keywords wetting pattern layered soil boruta extreme gradient boosting bidirectional gated recurrent unit adaboost drip irrigation data availability data will be made available on request 1 introduction drip irrigation is commonly utilized in most zones due to its high water use efficiency and minimizes some losses caused by surface runoff evaporation rate and deep percolation the exact knowledge of temporal and spatial patterns of wetting bulbs around the emitters and their impacts on moisture distribution around the root zone is essential for the optimal management and design of drip irrigation systems shiri et al 2020 singh et al 2006 the important parameters of the moisture bulb are the wetting diameter and depth the depth of the moisture distribution must be determined using the obtained root depth whereas its width is relevant to the space of laterals and emitters previous studies al ogaidi et al 2016 elnesr and alazba 2019 kanda et al 2020 solat et al 2021 have shown that wetting patterns significantly depends on the physical properties of soil such as saturated hydraulic conductivity initial moisture bulk density and the sand silt clay fractions in the soil emitter outflow rate the volume of applied water installation depth of the emitter and continuous or pulse water application the accurate prediction of the horizontal and vertical wetting dimensions beneath the emitter is the most effective factor in determining the suitable space between the emitters and laterals in drip irrigation systems kisi et al 2021a shiri et al 2020 the application of simulation models could be a suitable alternative due to the laborious time consuming and costly nature of field laboratory tests there are usually several approaches for predicting the wetting distribution patterns namely analytical solutions kilic 2020 moncef and khemaies 2016 numerical approaches saefuddin et al 2019 šimůnek et al 2006 and empirical models karimi et al 2022 solat et al 2021 analytical and numerical models that solve the flow equation under various conditions require high computational power time consuming and significant skills due to the non linearity of the equation governing the flow through soil media therefore it may be difficult to employ them for operating the objectives although the application of empirical models e g regression based approaches and dimensional analysis is easy these models are site specific and cannot be generalized as can be observed several studies have been performed to predict and or evaluate the wetting front dimensions under continuous drip irrigation in the presence of homogeneous soil profiles in addition less attention has been paid to predict wetting patterns in layered textural soil profiles under pulse drip irrigation according to the outcomes of various studies it is obvious that the wetting patterns in continuous irrigation mode is significantly different from pulsed irrigation mode kisi et al 2021a mohammadbeigi et al 2017 shiri et al 2020 as well as in homogeneous soils when compared to layered textural soil profiles al ogaidi et al 2016 li et al 2007 li et al 2007 conducted experimental tests to study various thicknesses and sequences on moisture and nitrate distribution under the effects of layered textural soils the results indicated that various combinations of applied water volume emitter outflow rate the sequence and thickness of soil layers are highly effective on the moisture front advances and nitrate distributions it was also found that whether a heavy texture over light texture or a light texture over heavy texture there was a slight effect of layered textural soils on downward water movement while a great effect of the layered textural soils on the horizontal moisture distribution al ogaidi et al 2016 suggested the empirical approaches to predict the wetting dimensions for soil layering under continuous drip irrigation using some influential variables in recent decades advances in computer science such as artificial intelligence numerical models optimization algorithms ahmadianfar et al 2021 2020 and data mining methods have made it easier to solve nonlinear problems in various fields of engineering alternatively it is so important to apply suitable methods to predict the wetting dimension with good precision and less computing power for a vast range of influential parameters consequently artificial intelligence techniques e g machine learning ml are usually applied as powerful tools for examining non linear relationships among parameters in this context the application of these methods in various disciplines of water resources engineering has been reported e g predicting wetting pattern distribution of moisture bulb karimi et al 2020 shiri et al 2020 estimation of nitrate distribution pattern jamei et al 2022b simulation of wind drift and evaporation losses from sprinkler irrigation al ghobari et al 2018 prediction of the surface water sodium na concentration and electrical conductivity ec at maroon river in iran ahmadianfar et al 2022b 2022a simulation of moisture redistribution pattern of drip irrigation kisi et al 2021a simulating the hydraulic performance in drainage filters adnan et al 2021 recently deep learning dl methods are one of the achievements of computer science advancement which have attracted the attention of researchers in solving non linear problems of soil science for instance a deep belief network dbn was integrated with the novel macroscopic cellular automata mca model to predict the soil moisture content smc in the zhangye oasis northwest china song et al 2016 in the other case dl remote sensing strategies and traditional neural networks tnn were employed to the estimation of the soil organic carbon soc odebiri et al 2021 besides a regional study based on the era5 climate product datasets aimed to multi step ahead predicts the volumetric soil moisture at 28 locations of serbia using a long short term memory lstm network filipović et al 2022 limited research has been conducted on wetting distribution patterns in layered textural soil profiles hence the main goals of this research are i to predict the area and dimensions of wetting front in layered textural soil profiles under pulse irrigation mode using different input combinations of experimental data ii to evaluate the ability of a new expert framework comprised of the boruta extreme gradient boosting boruta xgb feature selection integrated with bidirectional gated recurrent unit bi gru dl approach in the estimation of wetting front pattern for optimal input combinations iii comparing the main model with two comparative hybrid models applying the mlp and adaboost ml methods also different validation assessments and infographic tools were addressed to evaluate the robustness of the bi gru model in predicting the wetting distribution patterns in layered textural soil 2 materials and methods 2 1 experimental site and data description this study was conducted in a rectangular cube box with 1 m in height 0 5 m in width and 3 m in length between may 18 2018 and september 25 2020 at the university of kurdistan iran to monitor the moisture advances at different times the front plate of the model was made of transparent polycarbonate the cube was divided into three sections with equal dimensions and three tests were carried out simultaneously three soil samples a minor permeable soil heavy texture a moderate permeable soil medium texture and a major permeable soil light texture were used in the tests the soil samples were obtained by mixing various soils and table 1 shows some physical specifications of the investigated soil textures the experiments were conducted for pulse application modes with pulse cycles of 40 20 20 40 and 30 30 min the first value refers to the irrigation time on and the second value refers to the rest time off of the system a total of 54 experiments were performed with three flow outflow rates of 2 4 and 6 l h in various sequences of the two layered soil to evaluate the effects of soil layering on the wetting zone see fig 1 in this study the hydraulic conductivity was calculated by rosseta model schaap et al 2001 and using soil texture parameters percentages of sand clay and silt and bulk density general information on available patterns and experimental design provides in table 2 in the physical model all equipment and facilities of an irrigation system were imitated in accordance with those conditions that occurred in the field e g reservoir off on valve filtration system bypass collection pressure gauge main sub main and lateral pipes also the active time on time of 4 h was considered for all tests in which the same volume of applied water is provided for all treatments during each experiment the locations of the moving wetting front advances on the plexiglass walls were recorded visually at specific times after performing each test the shape of the model s front page and the amounts of moisture in horizontal vertical distribution and wetting zone areas were calculated using the grapher free software the measured variables in this study included the emitter outflow rate q saturated hydraulic conductivity k s total irrigation time t pulse ratio is the ratio of irrigation time in a cycle to the entire cycle time t irr t tot the bulk density of the soil ρ b initial moisture of the soil θ and the percentages of sand silt and clay s si and c respectively these parameters were applied as input variables of the above mentioned approaches for predicting the diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a some statistical information on the input data is presented in table 3 fig 1 illustrates the experimental device and the measured parameters 2 2 boruta extreme gradient boosting feature selection the boruta method is a wrapper approach constructed based on the random forest algorithm rf and renamed after the forest god in slavic mythology breiman 2001 the approach is an extension of the concept proposed by stoppiglia et al 2003 to identify relevant input parameters by comparing the significance of real characteristics to that of random probes stoppiglia et al 2003 boruta computes the z scores of each predictor s inputs for the shadow property the distribution of z score metrics determines the main predictor variables kursa et al 2010 recent advances in open source ensemble ml have made it possible to build this method utilizing the unique robust ensemble tree based algorithms xgboost catboost and decision tree in this study the xgboost algorithm was used instead of rf to rank the significant features to feed the ml models by repeatedly deleting the unimportant features the following stages can be used to summarize the boruta catboost fs method s mechanism kursa et al 2010 1 expanding the information system by making duplicates of all variables 2 rearranging the new features to eliminate correlations with the response 3 run the xgboost model and get z scores 4 identify the shadow variable with the highest z score mzsv and keep every variable that scored higher than the mzsv 5 using the mzsv to perform an equality test for each variable of unclear relevance 6 assuming that variables with considerably lower mzsv are unimportant removing these variables those with greater mzsv are retained 7 deleting shadow variables 8 repeating the operation until the importance of all retained variables is given 2 3 bidirectional gated recurrent unit bi gru recurrent neural networks rnns have been effectively implemented in several areas rnns may utilize their internal states to process time related sequences since they have self connected hidden layers mikolov et al 2010 the gru is an rnn version that overcomes the difficulties of gradient explosions and vanishing gradients in conventional rnns moreover unlike a conventional rnn a gru may learn both long term and short term dependencies liu et al 2020 gru and lstm perform the same functions nevertheless gru cells employ a hidden state that merges the forget and input gates into a single update gate moreover gru combines the hidden and cell states into one state consequently gru has half as many gates as lstm making it a popular form of lstm cell with fewer gates the two gru gates are the update gate and the reset gate these equations represent the gru model 1 r t σ w r h t 1 x t 2 z t σ w z h t 1 x t 3 h t t a n h w h r t h t 1 x t 4 h t 1 z t h t 1 h t z t σ indicates the sigmoid activation function whereas tanh stands for the tangent hyperbolic activation function w r w z and w h are the weight matrices for the variables r t z t and h t 1 correspondingly represents matrix multiplication the two grus that make up the bidirectional gru are stacked on top of one another for the output layer to receive data from both the past and the future the bi gru joins two hidden layers with opposing transmission directions as a result the bi gru model can gather data from two separate directions enabling it to train a more accurate model and produce more accurate predictions cao et al 2021 fig 2 depicts the general bi gru structure the bi gru layer may extract implicit information from well structured input data li et al 2022 the model then combines the two independent output layers into a single layer 5 y t w hy b h t b w hy f h t f b y the variables h t f and h t b at time t represent the output of forward and backward hidden layers respectively w hy f w hy b and b y denote the weights between forward and backward layers and the output bias 2 4 adaptive boosting regression tree adaboost adaptive boosting often known as adaboost is the most widely used boosting algorithm freund and schapire proposed this method in 1997 freund and schapire 1997 as a boosting algorithm previous knowledge of the functioning of the weak learning methodology is not necessary for adaboost implementation freund and schapire 1997 in theory an individual learner regression technique in this study may be weak but as long as each one performs somewhat better than random guessing the final model can evolve into a robust learner as a result several ensemble methodologies are used to enhance the models adaptive boosting adaboost is less sensitive to the overfitting issue than other learning algorithms bai et al 2021 as the weak learner in this study an improved version of the cart method is utilized the cart method always produces a binary dt means that each accessible node has just two child nodes the structure of an adaboost model is depicted in fig 3 adaboost s training algorithm is as follows xu et al 2021 1 assume the input data as d x 1 y 1 x 2 y 2 x n y n and g as the number of iterations 2 establish the initial sample weights as w i 1 n i 1 2 n 3 regarding the number of cycles g 1 2 g a using the present sample weight w g i fit a weak classifier d g x b use the following equations to calculate the classification error rate e g of d g x 6 e g i 1 n w g i i t i 7 i g i 1 d g x i y i 0 d g x i y i c calculate the weight of a weak classifier d g x in the final classifier by 8 α g 1 2 l n 1 e g e g the importance of a weak classifier in the final classifier is denoted by α g d updates are made to the weight of the input data by 9 w g 1 i w g i z g e x p α g y i d g x i 4 the final output is obtained as 10 h x s i g n i 1 g α t d g x 2 5 multilayer perceptron neural network mlp it is well known that artificial neural networks anns can properly depict data changing patterns in non linear and multivariable systems rahimi et al 2015 by emulating the biological neural network of the human brain these numerical models are capable of learning and identifying the non linear functions that regulate various data these networks are composed of a large number of basic components responsible for computation and arranged as neurons to form a layer as input one or more hidden layers and one layer as output sabour et al 2022 in this study the multilayer perceptron neural network model which is highly popular and frequently used was implemented mlp it is essential to note that the mlp model is a variation of the conventional ann model the determination of the correct topology of the mlp model is based on a trial and error process and its final structure is decided by hidden layer and neuron values following is the explicit equation for computing the output value y k of a three layered mlp ghorbani et al 2019 11 y k f out i 1 m w kj f hidden i 1 l w ji x i b jo b ko where l and m respectively represent the number of input and hidden neurons x i is the input layer variable i j and k are the neurons of the input layer hidden layer and output layer respectively f out and f hidden represent the activation functions of the output neuron and hidden neurons respectively b jo is the bias for the j th hidden neuron and b ko is the bias for the k th output neuron connecting the j th neuron in the hidden layer to the k th neuron in the output layer is a weight denoted by w kj w ji is a weight in the hidden layer that connects the i th neuron in the input layer to the j th neuron in the hidden layer in this study all datasets were normalized and separated into testing and training data categories the quickest approach for training the feedback neural network the levenberg marquardt algorithm lma was used to train mlp neural networks gao et al 2019 raheli et al 2017 2 6 goodness of fit metrics seven evaluation metrics including r correlation coefficient nse nash scuttle estimator mccuen et al 2006 kge kling gupta efficiency gupta et al 2009 rmse root mean square error mape mean absolute percent error ia willmott index of agreement willmott 1982 and u95 uncertainty coefficient with 95 percent confidence level were used to evaluate the prediction accuracy of the bi gru mlp and adaboost models for wetting patterns in layered soils the following are the mathematical formulations of the performance metrics jamei et al 2022a 2021 pandey et al 2021 12 r i 1 n wp obs i wp obs wp pred i wp pred i 1 n wp obs i wp obs 2 i 1 n wp pred i wp pred 2 13 rmse 1 n i 1 n wp obs i wp pred i 2 14 i a 1 i 1 n wp obs i wp pred i 2 i 1 n wp obs i wp obs wp obs i wp obs 2 15 mape 1 n i 1 n wp obs i wp pred i wp obs i 100 16 nse 1 i 1 n wp obs i wp pred i 2 i 1 n wp obs i wp obs 2 17 kge 1 r 1 2 α 1 2 β 1 2 18 u 95 1 96 std 2 rmse 2 wp obs i and wp pred i are observed and predicted wetting patterns values wp obs and wp pred are the respective averages of observed and predicted values n is the number of data points and std is the standard deviation in addition α illustrates the relative variability of the predicted and actual values whereas β is the ratio of the predicted and actual mean values a perfect model has r ia nse kge 1 and rmse mape and u95 0 3 model development in this research the accurate prediction of three important scenarios namely diameter of horizontal distribution d downward vertical distribution v and wetted area emitter a have been investigated based on 1217 experimental datasets on the physical and hydrometric properties of the layered soil including the elapsed time emitter outflow rate q saturated hydraulic conductivity ratio of the upper and lower layers k s 1 k s 2 the ratio of irrigation time in a cycle with respect to the entire cycle t irr t tot the bulk density of the rate of the soil layer ρ b 1 ρ b 2 rate of the initial soil moisture at the upper and lower layers θ 1 θ 2 and the ratios of the sand silt and clay in layered soil san d 1 s a n d 2 sil t 1 s i l t 2 and cla y 1 c l a y 2 respectively here a novel robust optimized hybrid dl paradigm namely the boruta xgb feature selection integrated with the bi gru dl framework was designed further the mlp and adaboost ml approaches were also hybridized with boruta xgb feature selection for comparison purposes to avoid overfitting the monte carlo technique with 500 iterations was employed as the cross validation procedure where 75 of whole datasets were allocated for the training and the remaining 25 of datasets were used for testing the modeling components in this study were executed in matlab r2020a mlp and python 3 6 boruta xgb bi gru and adaboost environments the framework of wetting pattern simulation using the hybrid provided models is shown in fig 4 selecting the optimal input combinations is one of the critical steps in data mining investigation with a large number of predictors which can lead to the optimum models accuracy jamei et al 2022c sometimes the use of standalone artificial intelligence methods cannot guarantee higher accuracy making it necessary to devise an appropriate strategy to select the best input predictors recently feature selection approaches have received an amazing attraction from the research community such as the boruta family feature selection which has a high ability to capture non linear relationships between the target variable and predictors jamei et al 2022b in this study the boruta xgb method is adopted to select the best candidate input combinations for all three scenarios i e d v and a scenarios as explained in the methodology of boruta xgb the z score criteria at the intersection with the max shadow benchmark value plays a vital role in determining the optimal input predictors in the present study the feature selecting procedure of these three scenarios was examined individually as shown in fig 5 it can be seen clearly in all scenarios the san d 1 s a n d 2 ρ b 1 ρ b 2 and cla y 1 c l a y 2 are less important than the others and can be omitted on the other hand the parameters of time flow q and θ 1 θ 2 in each scenario have the strong influence on the target estimation then according to the z score the possible optimal combinations i e c1 c2 and c3 can be extracted as listed in table 4 the next stage of the modeling is to optimize the hyperparameters of the artificial intelligence models for each combination in relation to the considered three scenarios for this purpose a grid search strategy jamei et al 2022b has been used for example in the bi gru model the number of layers the number of neurons in each layer the training algorithm and the learning rate value are considered the most important hyperparameters the optimal values of setting parameters related to all the models i e bi gru mlp and adaboost obtained by the grid search are listed in table 5 it should be noted that all input and target vectors data are normalized between 0 and 1 to increase the convergence 4 application results and analysis the prediction capability of the bi gru mlp and adaboost models using the input combinations c1 c2 c3 based on boruta xgb pre processing were evaluated to predict wetting pattern for two layered soil profiles in diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a using r rmse mape kge ia and u95 fig 6 represents the goodness of fit metrics in terms of terms r rmse u95 and nse using bar graphs for the bi gru mlp and adaboost model to predict the d v and a wetting patterns in layered soils for the boruta xgb based input combinations i e c1 c2 c3 analyzing fig 6 it can be seen that the bi gru with input combination c3 i e bi gru c3 was the most precise model to predict the wetting pattern d scenario by acquiring the lowest values of rmse 1 295 cm u95 4 095 and highest r 0 994 nse 0 998 followed by mlp c3 adaboost c3 and so on it is evident that the bi gru with c3 gives a better prediction of the wetting pattern d scenario to predict the wetting patterns v scenario and a scenario the bi gru model with input order c3 again provides precision followed by mlp and adaboost with c3 thus it is proved that the bi gru mlp and adaboost models show better accuracy on input combination c3 as compared to the combinations c1 and c2 overall the bi gru with c3 is the most accurate model to predict the wetting patterns d v and a scenarios table 6 is based on the valuation metrics r rmse mape nse kge ia and u95 to assess the models accuracy using the input combinations c1 c2 and c3 table 6 clearly prove that the bi gru model with input combination c3 achieved higher prediction accuracy such as r 0 994 rmse 1 295 cm mape 4 922 nse 0 988 kge 0 989 ia 0 997 u95 3 592 in testing period following by mlp r 0 985 rmse 2 020 cm mape 9 169 nse 0 971 kge 0 978 ia 0 992 u95 5 589 and adaboost r 0 957 rmse 3 460 cm mape 11 563 nse 0 914 kge 0 915 ia 0 976 u95 9 557 with c3 to predict the d wetting pattern in layered soils analysing table it can be seen that the input combinations c1 and c2 do not generate the highest accuracy in terms of r rmse mape nse kge ia and u95 metrics as compared to c3 when employed in the bi gru mlp and adaboost models to predict the d wetting pattern in layered soils to predict the v and a wetting pattern in layered soils the bi gru with input combination outperform the mlp and adaboost models in table 6 based on bi gru r 0 995 rmse 1 489 cm mape 3 790 nse 0 990 kge 0 992 ia 0 997 u95 4 096 v scenario r 0 996 rmse 76 624 cm2 mape 13 603 nse 0 990 kge 0 976 ia 0 998 u95 206 279 a scenario in comparison with mlp c3 and adaboost c3 in the testing period again it can be noted that bi gru mlp and adaboost models are performing better with input combination c3 against c1 and c2 to predict v and a wetting patterns in layered soils overall the bi gru with c3 is the most efficient model with high accuracy in predicting d v and a wetting pattern in layered soils table 6 fig 7 shows the scatter plots between the predicted and measured wetting patterns in d v and a scenarios based on input combinations c1 c2 and c3 using bi gru mlp and adaboost models by analyzing the input combinations c1 c2 and c3 the predicted and measured wetting patterns in d v and a scenarios for bi gru based on c3 with rc3 0 994 d scenario rc3 0 995 v scenario and rc3 0 996 a scenario is the most accurate wetting patterns prediction model as compared to mlp and adaboost models for c1 and c2 combinations the bi gru also acquired reasonably better and higher values of rc1 and rc2 as compared to the mlp and adaboost models to predict wetting patterns for all d v and a scenarios but in general the bi gru appears to be a well accurate good model using input combination c3 in comparison with benchmark mlp and adaboost models 5 further discussion in this research the proposed bi gru model with input combination c3 has been established to predict wetting patterns in d v and a scenarios the prediction competence of the bi gru is benchmarked against mlp and adaboost models using the c1 c2 and c3 where c3 input order approves its dominance thus verifying that the bi gru with c3 is a well designed wetting patterns prediction model the outcomes of bi gru established that the modeling style was effective in arranging the input in such an order combination i e c3 which increased the precision of the bi gru model fig 8 further illustrates the trends of predicted and measured wetting patterns in terms of the violin plots distribution using bi gru mlp and adaboost models for the d v and a scenarios the bi gru model shows a very close similarity by exhibiting mean 25 69 predicted vs 25 75 measured for the case of d scenario mean 44 70 predicted against 44 52 measured to predict wetting patterns in v scenario and mean 960 60 predicted and 966 2 measured in the a scenario as compared to the distributions acquired by mlp and adaboost models fig 8 confirms that the bi gru compared with benchmarking mlp and adaboost models can achieve maximum accuracy in predicting wetting patterns in d v and a scenarios taylor diagram demonstrates the reference i e measured and predicted wetting patterns generated by bi gru mlp and adaboost models for the diameter of horizontal distribution d downward vertical distribution v and area below the emitter a using the best input combination i e c3 taylor diagram taylor 2001 recommends a comprehensive evaluation among the models i e bi gru mlp adaboost against the reference wetting patterns utilizing standard deviation and correlation coefficient by inspecting fig 9 the analysis verifies that the bi gru green dot is lying close to the reference wetting pattern in d scenario with a correlation coefficient 0 99 as compared to mlp pink dot and adaboost blue dot similarly again the bi gru falls within the close neighborhood of the measured wetting patterns v and a scenarios within the arc 0 99 1 00 against the mlp and adaboost models fig 9 confirms that the bi gru can be considered the most precise wetting patterns prediction model in d v and a scenarios using the combination of inputs c3 fig 10 portrays the relative error percentage of predicted wetting patterns based on input combination c3 for horizontal distribution d vertical distribution v and the area below the emitter a using bi gru mlp and adaboost models by comparison the bi gru model evidently produces better prediction with q25 3 3 median 0 117 q75 3 01 d scenario q25 2 28 median 0 27 q75 1 32 v scenario q25 6 95 median 2 15 q75 1 02 a scenario following by mlp and adaboost models fig 10 thus established that the bi gru at input combination c3 is a precise model to predict wetting patterns in d v and a scenarios compared to mlp and adaboost models the next fig 11 draws the empirical cumulative distribution function ecdf of the residual errors between the predicted wetting patterns generated by bi gru vs mlp and adaboost models for all d v and a scenarios the ecdf of the bi gru model exhibited a very close profile against the benchmark mlp and adaboost models which further verifies the better accuracy of the bi gru model in predicting the wetting patterns further comparing the proposed framework bi gru with the previous work conducted by kisi et al 2021b the outcomes clearly confirmed that the b gru with input combination c3 acquired better precision to predict the wetting patterns in d v and a scenarios for example the quantitive results based on nse exhibit that bi gru with nse 0 988 is superior to anfis fcm psogsa nse 0 9152 kisi et al 2021b for predicting wetting patterns in d similarly the proposed bi gru model in terms of nse 0 990 performs significantly better than anfis fcm psogsa with nse 0 8652 to predict estimate the wetting patterns for the v scenario additionally the proposed modeling approach determine the input combinations c1 c2 and c3 using the boruta xgb pre processing techniques which is an advance powerful input selection while kisi et al 2021b the adopted approach was manually adding the input one by one which is very exhaustive and computationally time consuming thus the proposed bi gru with input combination c3 is a more convenient and feasible approach with advanced deep learning models as compared to kisi et al 2021b the data intelligent models are very powerful tools but the black box nature puts restrictions and limitations on their ability the black box condition is difficult to comprehend and authenticate the complicated associations of the input predictor in the learning process so the combination of ml and numerical weather prediction nwp models can be an interesting approach additionally the bi gru model can also be improved by using bayesian model averaging sloughter et al 2010 and bootstrapping tiwari and chatterjee 2011 to augment the prediction ability and handle uncertainty in the model moreover the boruta xgb technique helps to improve the accuracy of the bi gru to determine the best input combination i e c3 as it has a great potential to rank and select the best inputs the results showed that the bi gru with c3 achieves better accuracy in predicting wetting patterns as compared to the mlp and adaboost models thus it is recognized that bi gru with c3 could be a feasible ai model for hydrological sciences which can deliver helpful insights to the govt on water resource management for agricultural crops climate change scenarios and hydrology from the experimental aspects the presented work has some limitations which are listed along with suggestions this research is for a special condition where the thickness of the first and second layers is 20 and 80 cm respectively since the results of this research may change by changing the thickness of the layers it is recommended to carry out additional studies with the goal of changing the thickness of the layers since the results of this work are based on laboratory conditions it is suggested that field studies should be conducted to calibrate the models this research was performed in laboratory conditions with an almost constant temperature considering that the change in temperature may affect the wetting pattern it is necessary to carry out more studies based on the temperature change this research was done on the surface drip irrigation system with pulse mode so it is suggested to do separate research on the continuous surface irrigation system and the continuous pulse subsurface drip irrigation 6 conclusion and future direction this work investigates the feasibility of the boruta xgb pre processing and bi gru mlp and adaboost to predict soil wetting patterns for horizontal distribution d vertical distribution v and the area below the emitter a the main theme of this paper involves utilizing the boruta xgb technique to rank and select the best possible input combination which can enhance the prediction accuracy of the models the next step is to design and fine tune the bi gru mlp and adaboost models using the three input combinations c1 c2 c3 to predict the wetting patterns in d v and a scenarios the results confirm that the bi gru with input combination c3 includes the elapsed time emitter outflow rate q initial soil moisture rate θ 1 θ 2 saturated hydraulic conductivity ratio k s 1 k s 2 the ratio of irrigation time in a cycle to the entire cycle time t irr t tot and the ratio of silt sil t 1 s i l t 2 predictors exhibit high accuracy for all three wetting patterns d v and a scenarios using r rmse mape nse kge ia and u95 for all three input combinations i e c1 c2 and c3 the bi gru shows a good degree of accuracy as compared to the mlp and adaboost models but the bi gru with c3 was the most precise model to predict the wetting patterns by attaining r 0 994 rmse 1 295 cm mape 4 922 nse 0 988 kge 0 989 ia 0 997 u95 3 592 v scenario r 0 995 rmse 1 489 cm mape 3 790 nse 0 990 kge 0 992 ia 0 997 u95 4 096 v scenario and r 0 996 rmse 76 624 cm2 mape 13 603 nse 0 990 kge 0 976 ia 0 998 u95 206 279 a scenario as compared to the mlp and adaboost models the scope of this work can be extended to the areas of research in agriculture the environment hydrology and the renewable and sustainable energy sector in the future direction from the aspect of experimental investigation the wetting pattern assessment i e dimensions and area in slopping lands can be considered also from the aspect of modeling the other types of dl approach such as lstm bidirectional lstm and sequence two sequence extension of dl approaches can be implemented to estimate wetting patterns in both layered soil and sloping lands credit authorship contribution statement mehdi jamei conceptualization formal analysis visualization software supervision project administration farahnaz karimi data curation methodology resources validation mumtaz ali validation methodology conceptualization writing review editing bakhtiar karimi conceptualization visualization investigation software supervision writing original draft masoud karbasi investigation validation conceptualization methodology younes aminpour formal analysis validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2808,one of the most important parameters in the design and implementation of drip irrigation systems is the accurate prediction of the wetting dimensions pattern around the emitters which leads to the precise determination of the distance between the emitters and the drippers this search provides a comprehensive experimental and computational investigation to predict accurate wetting patterns dimensions and area in the layered textural soil profiles under pulse drip irrigation to achieve this first 1217 sets of experiments including the physical and hydrometric properties of two layered soil profiles under plus drip irrigation were carried out at kurdistan university iran then a new hybrid deep learning dl approach comprised of boruta extreme gradient boosting boruta xgb feature selection incorporated with the bidirectional gated recurrent unit bi gru scheme was designed to predict the diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a for each scenario the most influential predictors in terms of input combinations c1 c2 and c3 were extracted among nine available inputs using boruta xgb employed in the bi gru model the multilayer perceptron neural network mlp and adaptive boosting tree aadaboost were also developed as benchmark comparing models based on several metrics e g correlation coefficient r root mean square error rmse and kling gupta efficiency kge and various infographic analyses the outcomes demonstrate that the c3 combination includes the elapsed time emitter outflow rate q initial soil moisture rate θ 1 θ 2 saturated hydraulic conductivity ratio k s 1 k s 2 the ratio of irrigation time in a cycle to the entire cycle time t irr t tot and the ratio of silt sil t 1 s i l t 2 with bi gru yielded better accuracy in terms of r 0 994 rmse 1 295 cm and kge 0 989 for d scenario r 0 995 rmse 1 489 cm and kge 0 992 for v scenario and for a scenario r 0 996 rmse 76 624 cm2 and kge 0 976 than mlp and adaboost models keywords wetting pattern layered soil boruta extreme gradient boosting bidirectional gated recurrent unit adaboost drip irrigation data availability data will be made available on request 1 introduction drip irrigation is commonly utilized in most zones due to its high water use efficiency and minimizes some losses caused by surface runoff evaporation rate and deep percolation the exact knowledge of temporal and spatial patterns of wetting bulbs around the emitters and their impacts on moisture distribution around the root zone is essential for the optimal management and design of drip irrigation systems shiri et al 2020 singh et al 2006 the important parameters of the moisture bulb are the wetting diameter and depth the depth of the moisture distribution must be determined using the obtained root depth whereas its width is relevant to the space of laterals and emitters previous studies al ogaidi et al 2016 elnesr and alazba 2019 kanda et al 2020 solat et al 2021 have shown that wetting patterns significantly depends on the physical properties of soil such as saturated hydraulic conductivity initial moisture bulk density and the sand silt clay fractions in the soil emitter outflow rate the volume of applied water installation depth of the emitter and continuous or pulse water application the accurate prediction of the horizontal and vertical wetting dimensions beneath the emitter is the most effective factor in determining the suitable space between the emitters and laterals in drip irrigation systems kisi et al 2021a shiri et al 2020 the application of simulation models could be a suitable alternative due to the laborious time consuming and costly nature of field laboratory tests there are usually several approaches for predicting the wetting distribution patterns namely analytical solutions kilic 2020 moncef and khemaies 2016 numerical approaches saefuddin et al 2019 šimůnek et al 2006 and empirical models karimi et al 2022 solat et al 2021 analytical and numerical models that solve the flow equation under various conditions require high computational power time consuming and significant skills due to the non linearity of the equation governing the flow through soil media therefore it may be difficult to employ them for operating the objectives although the application of empirical models e g regression based approaches and dimensional analysis is easy these models are site specific and cannot be generalized as can be observed several studies have been performed to predict and or evaluate the wetting front dimensions under continuous drip irrigation in the presence of homogeneous soil profiles in addition less attention has been paid to predict wetting patterns in layered textural soil profiles under pulse drip irrigation according to the outcomes of various studies it is obvious that the wetting patterns in continuous irrigation mode is significantly different from pulsed irrigation mode kisi et al 2021a mohammadbeigi et al 2017 shiri et al 2020 as well as in homogeneous soils when compared to layered textural soil profiles al ogaidi et al 2016 li et al 2007 li et al 2007 conducted experimental tests to study various thicknesses and sequences on moisture and nitrate distribution under the effects of layered textural soils the results indicated that various combinations of applied water volume emitter outflow rate the sequence and thickness of soil layers are highly effective on the moisture front advances and nitrate distributions it was also found that whether a heavy texture over light texture or a light texture over heavy texture there was a slight effect of layered textural soils on downward water movement while a great effect of the layered textural soils on the horizontal moisture distribution al ogaidi et al 2016 suggested the empirical approaches to predict the wetting dimensions for soil layering under continuous drip irrigation using some influential variables in recent decades advances in computer science such as artificial intelligence numerical models optimization algorithms ahmadianfar et al 2021 2020 and data mining methods have made it easier to solve nonlinear problems in various fields of engineering alternatively it is so important to apply suitable methods to predict the wetting dimension with good precision and less computing power for a vast range of influential parameters consequently artificial intelligence techniques e g machine learning ml are usually applied as powerful tools for examining non linear relationships among parameters in this context the application of these methods in various disciplines of water resources engineering has been reported e g predicting wetting pattern distribution of moisture bulb karimi et al 2020 shiri et al 2020 estimation of nitrate distribution pattern jamei et al 2022b simulation of wind drift and evaporation losses from sprinkler irrigation al ghobari et al 2018 prediction of the surface water sodium na concentration and electrical conductivity ec at maroon river in iran ahmadianfar et al 2022b 2022a simulation of moisture redistribution pattern of drip irrigation kisi et al 2021a simulating the hydraulic performance in drainage filters adnan et al 2021 recently deep learning dl methods are one of the achievements of computer science advancement which have attracted the attention of researchers in solving non linear problems of soil science for instance a deep belief network dbn was integrated with the novel macroscopic cellular automata mca model to predict the soil moisture content smc in the zhangye oasis northwest china song et al 2016 in the other case dl remote sensing strategies and traditional neural networks tnn were employed to the estimation of the soil organic carbon soc odebiri et al 2021 besides a regional study based on the era5 climate product datasets aimed to multi step ahead predicts the volumetric soil moisture at 28 locations of serbia using a long short term memory lstm network filipović et al 2022 limited research has been conducted on wetting distribution patterns in layered textural soil profiles hence the main goals of this research are i to predict the area and dimensions of wetting front in layered textural soil profiles under pulse irrigation mode using different input combinations of experimental data ii to evaluate the ability of a new expert framework comprised of the boruta extreme gradient boosting boruta xgb feature selection integrated with bidirectional gated recurrent unit bi gru dl approach in the estimation of wetting front pattern for optimal input combinations iii comparing the main model with two comparative hybrid models applying the mlp and adaboost ml methods also different validation assessments and infographic tools were addressed to evaluate the robustness of the bi gru model in predicting the wetting distribution patterns in layered textural soil 2 materials and methods 2 1 experimental site and data description this study was conducted in a rectangular cube box with 1 m in height 0 5 m in width and 3 m in length between may 18 2018 and september 25 2020 at the university of kurdistan iran to monitor the moisture advances at different times the front plate of the model was made of transparent polycarbonate the cube was divided into three sections with equal dimensions and three tests were carried out simultaneously three soil samples a minor permeable soil heavy texture a moderate permeable soil medium texture and a major permeable soil light texture were used in the tests the soil samples were obtained by mixing various soils and table 1 shows some physical specifications of the investigated soil textures the experiments were conducted for pulse application modes with pulse cycles of 40 20 20 40 and 30 30 min the first value refers to the irrigation time on and the second value refers to the rest time off of the system a total of 54 experiments were performed with three flow outflow rates of 2 4 and 6 l h in various sequences of the two layered soil to evaluate the effects of soil layering on the wetting zone see fig 1 in this study the hydraulic conductivity was calculated by rosseta model schaap et al 2001 and using soil texture parameters percentages of sand clay and silt and bulk density general information on available patterns and experimental design provides in table 2 in the physical model all equipment and facilities of an irrigation system were imitated in accordance with those conditions that occurred in the field e g reservoir off on valve filtration system bypass collection pressure gauge main sub main and lateral pipes also the active time on time of 4 h was considered for all tests in which the same volume of applied water is provided for all treatments during each experiment the locations of the moving wetting front advances on the plexiglass walls were recorded visually at specific times after performing each test the shape of the model s front page and the amounts of moisture in horizontal vertical distribution and wetting zone areas were calculated using the grapher free software the measured variables in this study included the emitter outflow rate q saturated hydraulic conductivity k s total irrigation time t pulse ratio is the ratio of irrigation time in a cycle to the entire cycle time t irr t tot the bulk density of the soil ρ b initial moisture of the soil θ and the percentages of sand silt and clay s si and c respectively these parameters were applied as input variables of the above mentioned approaches for predicting the diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a some statistical information on the input data is presented in table 3 fig 1 illustrates the experimental device and the measured parameters 2 2 boruta extreme gradient boosting feature selection the boruta method is a wrapper approach constructed based on the random forest algorithm rf and renamed after the forest god in slavic mythology breiman 2001 the approach is an extension of the concept proposed by stoppiglia et al 2003 to identify relevant input parameters by comparing the significance of real characteristics to that of random probes stoppiglia et al 2003 boruta computes the z scores of each predictor s inputs for the shadow property the distribution of z score metrics determines the main predictor variables kursa et al 2010 recent advances in open source ensemble ml have made it possible to build this method utilizing the unique robust ensemble tree based algorithms xgboost catboost and decision tree in this study the xgboost algorithm was used instead of rf to rank the significant features to feed the ml models by repeatedly deleting the unimportant features the following stages can be used to summarize the boruta catboost fs method s mechanism kursa et al 2010 1 expanding the information system by making duplicates of all variables 2 rearranging the new features to eliminate correlations with the response 3 run the xgboost model and get z scores 4 identify the shadow variable with the highest z score mzsv and keep every variable that scored higher than the mzsv 5 using the mzsv to perform an equality test for each variable of unclear relevance 6 assuming that variables with considerably lower mzsv are unimportant removing these variables those with greater mzsv are retained 7 deleting shadow variables 8 repeating the operation until the importance of all retained variables is given 2 3 bidirectional gated recurrent unit bi gru recurrent neural networks rnns have been effectively implemented in several areas rnns may utilize their internal states to process time related sequences since they have self connected hidden layers mikolov et al 2010 the gru is an rnn version that overcomes the difficulties of gradient explosions and vanishing gradients in conventional rnns moreover unlike a conventional rnn a gru may learn both long term and short term dependencies liu et al 2020 gru and lstm perform the same functions nevertheless gru cells employ a hidden state that merges the forget and input gates into a single update gate moreover gru combines the hidden and cell states into one state consequently gru has half as many gates as lstm making it a popular form of lstm cell with fewer gates the two gru gates are the update gate and the reset gate these equations represent the gru model 1 r t σ w r h t 1 x t 2 z t σ w z h t 1 x t 3 h t t a n h w h r t h t 1 x t 4 h t 1 z t h t 1 h t z t σ indicates the sigmoid activation function whereas tanh stands for the tangent hyperbolic activation function w r w z and w h are the weight matrices for the variables r t z t and h t 1 correspondingly represents matrix multiplication the two grus that make up the bidirectional gru are stacked on top of one another for the output layer to receive data from both the past and the future the bi gru joins two hidden layers with opposing transmission directions as a result the bi gru model can gather data from two separate directions enabling it to train a more accurate model and produce more accurate predictions cao et al 2021 fig 2 depicts the general bi gru structure the bi gru layer may extract implicit information from well structured input data li et al 2022 the model then combines the two independent output layers into a single layer 5 y t w hy b h t b w hy f h t f b y the variables h t f and h t b at time t represent the output of forward and backward hidden layers respectively w hy f w hy b and b y denote the weights between forward and backward layers and the output bias 2 4 adaptive boosting regression tree adaboost adaptive boosting often known as adaboost is the most widely used boosting algorithm freund and schapire proposed this method in 1997 freund and schapire 1997 as a boosting algorithm previous knowledge of the functioning of the weak learning methodology is not necessary for adaboost implementation freund and schapire 1997 in theory an individual learner regression technique in this study may be weak but as long as each one performs somewhat better than random guessing the final model can evolve into a robust learner as a result several ensemble methodologies are used to enhance the models adaptive boosting adaboost is less sensitive to the overfitting issue than other learning algorithms bai et al 2021 as the weak learner in this study an improved version of the cart method is utilized the cart method always produces a binary dt means that each accessible node has just two child nodes the structure of an adaboost model is depicted in fig 3 adaboost s training algorithm is as follows xu et al 2021 1 assume the input data as d x 1 y 1 x 2 y 2 x n y n and g as the number of iterations 2 establish the initial sample weights as w i 1 n i 1 2 n 3 regarding the number of cycles g 1 2 g a using the present sample weight w g i fit a weak classifier d g x b use the following equations to calculate the classification error rate e g of d g x 6 e g i 1 n w g i i t i 7 i g i 1 d g x i y i 0 d g x i y i c calculate the weight of a weak classifier d g x in the final classifier by 8 α g 1 2 l n 1 e g e g the importance of a weak classifier in the final classifier is denoted by α g d updates are made to the weight of the input data by 9 w g 1 i w g i z g e x p α g y i d g x i 4 the final output is obtained as 10 h x s i g n i 1 g α t d g x 2 5 multilayer perceptron neural network mlp it is well known that artificial neural networks anns can properly depict data changing patterns in non linear and multivariable systems rahimi et al 2015 by emulating the biological neural network of the human brain these numerical models are capable of learning and identifying the non linear functions that regulate various data these networks are composed of a large number of basic components responsible for computation and arranged as neurons to form a layer as input one or more hidden layers and one layer as output sabour et al 2022 in this study the multilayer perceptron neural network model which is highly popular and frequently used was implemented mlp it is essential to note that the mlp model is a variation of the conventional ann model the determination of the correct topology of the mlp model is based on a trial and error process and its final structure is decided by hidden layer and neuron values following is the explicit equation for computing the output value y k of a three layered mlp ghorbani et al 2019 11 y k f out i 1 m w kj f hidden i 1 l w ji x i b jo b ko where l and m respectively represent the number of input and hidden neurons x i is the input layer variable i j and k are the neurons of the input layer hidden layer and output layer respectively f out and f hidden represent the activation functions of the output neuron and hidden neurons respectively b jo is the bias for the j th hidden neuron and b ko is the bias for the k th output neuron connecting the j th neuron in the hidden layer to the k th neuron in the output layer is a weight denoted by w kj w ji is a weight in the hidden layer that connects the i th neuron in the input layer to the j th neuron in the hidden layer in this study all datasets were normalized and separated into testing and training data categories the quickest approach for training the feedback neural network the levenberg marquardt algorithm lma was used to train mlp neural networks gao et al 2019 raheli et al 2017 2 6 goodness of fit metrics seven evaluation metrics including r correlation coefficient nse nash scuttle estimator mccuen et al 2006 kge kling gupta efficiency gupta et al 2009 rmse root mean square error mape mean absolute percent error ia willmott index of agreement willmott 1982 and u95 uncertainty coefficient with 95 percent confidence level were used to evaluate the prediction accuracy of the bi gru mlp and adaboost models for wetting patterns in layered soils the following are the mathematical formulations of the performance metrics jamei et al 2022a 2021 pandey et al 2021 12 r i 1 n wp obs i wp obs wp pred i wp pred i 1 n wp obs i wp obs 2 i 1 n wp pred i wp pred 2 13 rmse 1 n i 1 n wp obs i wp pred i 2 14 i a 1 i 1 n wp obs i wp pred i 2 i 1 n wp obs i wp obs wp obs i wp obs 2 15 mape 1 n i 1 n wp obs i wp pred i wp obs i 100 16 nse 1 i 1 n wp obs i wp pred i 2 i 1 n wp obs i wp obs 2 17 kge 1 r 1 2 α 1 2 β 1 2 18 u 95 1 96 std 2 rmse 2 wp obs i and wp pred i are observed and predicted wetting patterns values wp obs and wp pred are the respective averages of observed and predicted values n is the number of data points and std is the standard deviation in addition α illustrates the relative variability of the predicted and actual values whereas β is the ratio of the predicted and actual mean values a perfect model has r ia nse kge 1 and rmse mape and u95 0 3 model development in this research the accurate prediction of three important scenarios namely diameter of horizontal distribution d downward vertical distribution v and wetted area emitter a have been investigated based on 1217 experimental datasets on the physical and hydrometric properties of the layered soil including the elapsed time emitter outflow rate q saturated hydraulic conductivity ratio of the upper and lower layers k s 1 k s 2 the ratio of irrigation time in a cycle with respect to the entire cycle t irr t tot the bulk density of the rate of the soil layer ρ b 1 ρ b 2 rate of the initial soil moisture at the upper and lower layers θ 1 θ 2 and the ratios of the sand silt and clay in layered soil san d 1 s a n d 2 sil t 1 s i l t 2 and cla y 1 c l a y 2 respectively here a novel robust optimized hybrid dl paradigm namely the boruta xgb feature selection integrated with the bi gru dl framework was designed further the mlp and adaboost ml approaches were also hybridized with boruta xgb feature selection for comparison purposes to avoid overfitting the monte carlo technique with 500 iterations was employed as the cross validation procedure where 75 of whole datasets were allocated for the training and the remaining 25 of datasets were used for testing the modeling components in this study were executed in matlab r2020a mlp and python 3 6 boruta xgb bi gru and adaboost environments the framework of wetting pattern simulation using the hybrid provided models is shown in fig 4 selecting the optimal input combinations is one of the critical steps in data mining investigation with a large number of predictors which can lead to the optimum models accuracy jamei et al 2022c sometimes the use of standalone artificial intelligence methods cannot guarantee higher accuracy making it necessary to devise an appropriate strategy to select the best input predictors recently feature selection approaches have received an amazing attraction from the research community such as the boruta family feature selection which has a high ability to capture non linear relationships between the target variable and predictors jamei et al 2022b in this study the boruta xgb method is adopted to select the best candidate input combinations for all three scenarios i e d v and a scenarios as explained in the methodology of boruta xgb the z score criteria at the intersection with the max shadow benchmark value plays a vital role in determining the optimal input predictors in the present study the feature selecting procedure of these three scenarios was examined individually as shown in fig 5 it can be seen clearly in all scenarios the san d 1 s a n d 2 ρ b 1 ρ b 2 and cla y 1 c l a y 2 are less important than the others and can be omitted on the other hand the parameters of time flow q and θ 1 θ 2 in each scenario have the strong influence on the target estimation then according to the z score the possible optimal combinations i e c1 c2 and c3 can be extracted as listed in table 4 the next stage of the modeling is to optimize the hyperparameters of the artificial intelligence models for each combination in relation to the considered three scenarios for this purpose a grid search strategy jamei et al 2022b has been used for example in the bi gru model the number of layers the number of neurons in each layer the training algorithm and the learning rate value are considered the most important hyperparameters the optimal values of setting parameters related to all the models i e bi gru mlp and adaboost obtained by the grid search are listed in table 5 it should be noted that all input and target vectors data are normalized between 0 and 1 to increase the convergence 4 application results and analysis the prediction capability of the bi gru mlp and adaboost models using the input combinations c1 c2 c3 based on boruta xgb pre processing were evaluated to predict wetting pattern for two layered soil profiles in diameter of horizontal distribution d downward vertical distribution v and wetting area below the emitter a using r rmse mape kge ia and u95 fig 6 represents the goodness of fit metrics in terms of terms r rmse u95 and nse using bar graphs for the bi gru mlp and adaboost model to predict the d v and a wetting patterns in layered soils for the boruta xgb based input combinations i e c1 c2 c3 analyzing fig 6 it can be seen that the bi gru with input combination c3 i e bi gru c3 was the most precise model to predict the wetting pattern d scenario by acquiring the lowest values of rmse 1 295 cm u95 4 095 and highest r 0 994 nse 0 998 followed by mlp c3 adaboost c3 and so on it is evident that the bi gru with c3 gives a better prediction of the wetting pattern d scenario to predict the wetting patterns v scenario and a scenario the bi gru model with input order c3 again provides precision followed by mlp and adaboost with c3 thus it is proved that the bi gru mlp and adaboost models show better accuracy on input combination c3 as compared to the combinations c1 and c2 overall the bi gru with c3 is the most accurate model to predict the wetting patterns d v and a scenarios table 6 is based on the valuation metrics r rmse mape nse kge ia and u95 to assess the models accuracy using the input combinations c1 c2 and c3 table 6 clearly prove that the bi gru model with input combination c3 achieved higher prediction accuracy such as r 0 994 rmse 1 295 cm mape 4 922 nse 0 988 kge 0 989 ia 0 997 u95 3 592 in testing period following by mlp r 0 985 rmse 2 020 cm mape 9 169 nse 0 971 kge 0 978 ia 0 992 u95 5 589 and adaboost r 0 957 rmse 3 460 cm mape 11 563 nse 0 914 kge 0 915 ia 0 976 u95 9 557 with c3 to predict the d wetting pattern in layered soils analysing table it can be seen that the input combinations c1 and c2 do not generate the highest accuracy in terms of r rmse mape nse kge ia and u95 metrics as compared to c3 when employed in the bi gru mlp and adaboost models to predict the d wetting pattern in layered soils to predict the v and a wetting pattern in layered soils the bi gru with input combination outperform the mlp and adaboost models in table 6 based on bi gru r 0 995 rmse 1 489 cm mape 3 790 nse 0 990 kge 0 992 ia 0 997 u95 4 096 v scenario r 0 996 rmse 76 624 cm2 mape 13 603 nse 0 990 kge 0 976 ia 0 998 u95 206 279 a scenario in comparison with mlp c3 and adaboost c3 in the testing period again it can be noted that bi gru mlp and adaboost models are performing better with input combination c3 against c1 and c2 to predict v and a wetting patterns in layered soils overall the bi gru with c3 is the most efficient model with high accuracy in predicting d v and a wetting pattern in layered soils table 6 fig 7 shows the scatter plots between the predicted and measured wetting patterns in d v and a scenarios based on input combinations c1 c2 and c3 using bi gru mlp and adaboost models by analyzing the input combinations c1 c2 and c3 the predicted and measured wetting patterns in d v and a scenarios for bi gru based on c3 with rc3 0 994 d scenario rc3 0 995 v scenario and rc3 0 996 a scenario is the most accurate wetting patterns prediction model as compared to mlp and adaboost models for c1 and c2 combinations the bi gru also acquired reasonably better and higher values of rc1 and rc2 as compared to the mlp and adaboost models to predict wetting patterns for all d v and a scenarios but in general the bi gru appears to be a well accurate good model using input combination c3 in comparison with benchmark mlp and adaboost models 5 further discussion in this research the proposed bi gru model with input combination c3 has been established to predict wetting patterns in d v and a scenarios the prediction competence of the bi gru is benchmarked against mlp and adaboost models using the c1 c2 and c3 where c3 input order approves its dominance thus verifying that the bi gru with c3 is a well designed wetting patterns prediction model the outcomes of bi gru established that the modeling style was effective in arranging the input in such an order combination i e c3 which increased the precision of the bi gru model fig 8 further illustrates the trends of predicted and measured wetting patterns in terms of the violin plots distribution using bi gru mlp and adaboost models for the d v and a scenarios the bi gru model shows a very close similarity by exhibiting mean 25 69 predicted vs 25 75 measured for the case of d scenario mean 44 70 predicted against 44 52 measured to predict wetting patterns in v scenario and mean 960 60 predicted and 966 2 measured in the a scenario as compared to the distributions acquired by mlp and adaboost models fig 8 confirms that the bi gru compared with benchmarking mlp and adaboost models can achieve maximum accuracy in predicting wetting patterns in d v and a scenarios taylor diagram demonstrates the reference i e measured and predicted wetting patterns generated by bi gru mlp and adaboost models for the diameter of horizontal distribution d downward vertical distribution v and area below the emitter a using the best input combination i e c3 taylor diagram taylor 2001 recommends a comprehensive evaluation among the models i e bi gru mlp adaboost against the reference wetting patterns utilizing standard deviation and correlation coefficient by inspecting fig 9 the analysis verifies that the bi gru green dot is lying close to the reference wetting pattern in d scenario with a correlation coefficient 0 99 as compared to mlp pink dot and adaboost blue dot similarly again the bi gru falls within the close neighborhood of the measured wetting patterns v and a scenarios within the arc 0 99 1 00 against the mlp and adaboost models fig 9 confirms that the bi gru can be considered the most precise wetting patterns prediction model in d v and a scenarios using the combination of inputs c3 fig 10 portrays the relative error percentage of predicted wetting patterns based on input combination c3 for horizontal distribution d vertical distribution v and the area below the emitter a using bi gru mlp and adaboost models by comparison the bi gru model evidently produces better prediction with q25 3 3 median 0 117 q75 3 01 d scenario q25 2 28 median 0 27 q75 1 32 v scenario q25 6 95 median 2 15 q75 1 02 a scenario following by mlp and adaboost models fig 10 thus established that the bi gru at input combination c3 is a precise model to predict wetting patterns in d v and a scenarios compared to mlp and adaboost models the next fig 11 draws the empirical cumulative distribution function ecdf of the residual errors between the predicted wetting patterns generated by bi gru vs mlp and adaboost models for all d v and a scenarios the ecdf of the bi gru model exhibited a very close profile against the benchmark mlp and adaboost models which further verifies the better accuracy of the bi gru model in predicting the wetting patterns further comparing the proposed framework bi gru with the previous work conducted by kisi et al 2021b the outcomes clearly confirmed that the b gru with input combination c3 acquired better precision to predict the wetting patterns in d v and a scenarios for example the quantitive results based on nse exhibit that bi gru with nse 0 988 is superior to anfis fcm psogsa nse 0 9152 kisi et al 2021b for predicting wetting patterns in d similarly the proposed bi gru model in terms of nse 0 990 performs significantly better than anfis fcm psogsa with nse 0 8652 to predict estimate the wetting patterns for the v scenario additionally the proposed modeling approach determine the input combinations c1 c2 and c3 using the boruta xgb pre processing techniques which is an advance powerful input selection while kisi et al 2021b the adopted approach was manually adding the input one by one which is very exhaustive and computationally time consuming thus the proposed bi gru with input combination c3 is a more convenient and feasible approach with advanced deep learning models as compared to kisi et al 2021b the data intelligent models are very powerful tools but the black box nature puts restrictions and limitations on their ability the black box condition is difficult to comprehend and authenticate the complicated associations of the input predictor in the learning process so the combination of ml and numerical weather prediction nwp models can be an interesting approach additionally the bi gru model can also be improved by using bayesian model averaging sloughter et al 2010 and bootstrapping tiwari and chatterjee 2011 to augment the prediction ability and handle uncertainty in the model moreover the boruta xgb technique helps to improve the accuracy of the bi gru to determine the best input combination i e c3 as it has a great potential to rank and select the best inputs the results showed that the bi gru with c3 achieves better accuracy in predicting wetting patterns as compared to the mlp and adaboost models thus it is recognized that bi gru with c3 could be a feasible ai model for hydrological sciences which can deliver helpful insights to the govt on water resource management for agricultural crops climate change scenarios and hydrology from the experimental aspects the presented work has some limitations which are listed along with suggestions this research is for a special condition where the thickness of the first and second layers is 20 and 80 cm respectively since the results of this research may change by changing the thickness of the layers it is recommended to carry out additional studies with the goal of changing the thickness of the layers since the results of this work are based on laboratory conditions it is suggested that field studies should be conducted to calibrate the models this research was performed in laboratory conditions with an almost constant temperature considering that the change in temperature may affect the wetting pattern it is necessary to carry out more studies based on the temperature change this research was done on the surface drip irrigation system with pulse mode so it is suggested to do separate research on the continuous surface irrigation system and the continuous pulse subsurface drip irrigation 6 conclusion and future direction this work investigates the feasibility of the boruta xgb pre processing and bi gru mlp and adaboost to predict soil wetting patterns for horizontal distribution d vertical distribution v and the area below the emitter a the main theme of this paper involves utilizing the boruta xgb technique to rank and select the best possible input combination which can enhance the prediction accuracy of the models the next step is to design and fine tune the bi gru mlp and adaboost models using the three input combinations c1 c2 c3 to predict the wetting patterns in d v and a scenarios the results confirm that the bi gru with input combination c3 includes the elapsed time emitter outflow rate q initial soil moisture rate θ 1 θ 2 saturated hydraulic conductivity ratio k s 1 k s 2 the ratio of irrigation time in a cycle to the entire cycle time t irr t tot and the ratio of silt sil t 1 s i l t 2 predictors exhibit high accuracy for all three wetting patterns d v and a scenarios using r rmse mape nse kge ia and u95 for all three input combinations i e c1 c2 and c3 the bi gru shows a good degree of accuracy as compared to the mlp and adaboost models but the bi gru with c3 was the most precise model to predict the wetting patterns by attaining r 0 994 rmse 1 295 cm mape 4 922 nse 0 988 kge 0 989 ia 0 997 u95 3 592 v scenario r 0 995 rmse 1 489 cm mape 3 790 nse 0 990 kge 0 992 ia 0 997 u95 4 096 v scenario and r 0 996 rmse 76 624 cm2 mape 13 603 nse 0 990 kge 0 976 ia 0 998 u95 206 279 a scenario as compared to the mlp and adaboost models the scope of this work can be extended to the areas of research in agriculture the environment hydrology and the renewable and sustainable energy sector in the future direction from the aspect of experimental investigation the wetting pattern assessment i e dimensions and area in slopping lands can be considered also from the aspect of modeling the other types of dl approach such as lstm bidirectional lstm and sequence two sequence extension of dl approaches can be implemented to estimate wetting patterns in both layered soil and sloping lands credit authorship contribution statement mehdi jamei conceptualization formal analysis visualization software supervision project administration farahnaz karimi data curation methodology resources validation mumtaz ali validation methodology conceptualization writing review editing bakhtiar karimi conceptualization visualization investigation software supervision writing original draft masoud karbasi investigation validation conceptualization methodology younes aminpour formal analysis validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2809,nitrate concentration discharge c q relationshipshave been used to infer nitrate sources storage reactions and transport in watersheds and to reveal key processes that control runoff chemistry yet studies on long term nitrate c q relationships are limited due to scarce high frequency e g daily concentration data in this paper using a long term high frequency dataset 1976 2019 comprising stream flow and nitrate concentrations we quantitatively analyzed the long term variations of event scale hysteresis patterns quantified by hysteresis index hi and flushing index fi to infer the leaching mechanisms of nitrate in an artificially drained agricultural watershed in mid western u s our results revealed that most events exhibited anti clockwise behaviors hi 0 regardless of whether nitrate was flushed or diluted during events this means that water with high levels of nitrate n reaches the stream network slower than water with lower nitrate concentrations long term mean fi was close to zero but had strong seasonal patterns with dilution patterns observed during winter and summer and flushing patterns during late spring and fall the consistently negative hi values regardless of the fi value gave a strong indication of the preponderant role of the near drain zone that usually exhibits accelerated leaching and less accumulation of nitrate in the soil profile in these drained agricultural watersheds both hi and fi depicted strong but opposite seasonality because of weather patterns and agricultural activities particularly n fertilization overall our findings suggest a little evidence of the role of deep groundwater and instead a strong evidence of the role of subsurface drainage as the primary pathway for nitrate transport in drained agricultural watersheds therefore artificial drainage could dampen n legacy caused by the historically intensive n fertilization in drained agricultural landscapes keywords storm hysteresis nitrogen legacy agricultural drainage non point source pollution drainage water quality surface water quality data availability the data used is available from the national center for water quality research heidelberg univ https www heidelberg edu academics research and centers national center for water quality research 1 introduction legacy nitrogen n caused by long term intensive n fertilization has been a major area of research in agricultural water quality baresel and destouni 2006 bieroza et al 2018 hrachowitz et al 2016 van meter and basu 2015 in agricultural watersheds n input that is not taken up by plants can be leached down to deeper groundwater where it may reside for years decades or more before reaching a surface water body depending on groundwater flow paths e g gilmore et al 2016 nitrogen input that is not utilized by plants can also be temporarily stored in soil n pools mainly as soil organic n son which may also reside in the soil profile for years decades or more torn et al 2009 hamilton 2012 hu et al 2019 van meter et al 2016 poffenbarger et al 2018 legacy n can cause a time lag between changes in agricultural activities that introduce n to the landscape and the associated changes in n losses to receiving water bodies e g a considerable amount of n loss could still be observed even after making substantial changes to n related management practices darracq et al 2008 hrachowitz et al 2015 for instance a long term modeling study van meter et al 2018 predicted that reaching the goal of 60 reduction in n loading from the mississippi river basin mrb would take decades even with the most aggressive n use scenarios n use efficiency 100 understanding processes and mechanisms affecting n fate and transport in historically agricultural watersheds is critical for the development of effective long term strategies for minimizing n losses from agricultural landscapes ehrhardt et al 2021 baresel and destouni 2006 meals et al 2010 many researchers reported potentially short hydrological legacy for agricultural watersheds in mid western u s due to the use of artificial drainage in agricultural fields basu et al 2012 schilling and helmers 2008 artificial drainage is used for crop production on naturally poorly drained soils to enhance water movement in the soil profile timely remove excess water in the root zone and provide trafficable conditions for farm machinery artificial drainage dramatically shortens the water flow path to the nearest outlet and thus reduces the hydrological time lag liao et al 2012 schilling et al 2012 schilling et al 2015 estimated that mean travel time of groundwater for fields with drainage systems was 150 times shorter after the installation of drainage systems hence artificial drainage can be thought of as a shortcut for nitrate laden shallow groundwater to surface water bodies bypassing longer flow paths of leaching n into deeper groundwater where water moves slowly towards streams and rivers arenas amado et al 2017 drury et al 1993 gilmore et al 2016 skaggs et al 1994 studies utilized numerical models van meter et al 2018 and advanced analytics of measured hydrologic and stream chemistry data to investigate the role of different processes and mechanisms influencing n fate and transport in the agricultural landscape zhi and li 2020 investigating stream nutrient concentration discharge c q relationships at the event scale could be a useful approach to infer n dynamics in intensively managed watersheds as the response of stream chemistry to discharge can reflect how watersheds store and release water and chemical species researchers have studied event scale c q patterns to infer the sources and controls of constituent transport birkel et al 2017 winter et al 2022 and to reveal temporal variations of stream chemistry blaen et al 2017 dupas et al 2015 musolff et al 2021 specifically analysis of storm hysteresis caused by temporal lags of peaks or troughs between hydrographs and chemographs has been used to characterize event scale c q relationships burns et al 2019 mainly because hysteresis patterns is thought to reveal the relative roles of chemical e g nitrogen in this study availability and hydrological connectivity liu et al 2021a for instance based on c q hysteresis analysis cain et al 2022 concluded that the event basis nitrate c q relationships for agricultural landscapes with subsurface tile drainage and fertilization were highly influenced by the storm event magnitude and antecedent conditions since both factors regulate flow path activation and hydrological connectivity in artificially drained agricultural landscapes therefore investigating c q hysteresis relationships could provide insights on critical processes and mechanisms controlling runoff generation and n dynamics in drained agricultural landscapes measurements of c q at finer resolutions have greater chances to capture rapid changes in stream chemistry occurring in high flow regimes duncan et al 2017 knapp et al 2020 and thus enable researchers to gain better understanding of n dynamics during events liu et al 2020a liu et al 2020b gall et al 2015 for example utilizing higher resolutions hydro biogeochemical measurements from 228 watersheds across the u s zhi and li 2020 reported nitrate flushing patterns increased with stream discharge from agricultural landscapes compared to previously reported chemo stasis of nitrate export from mississippi river basin zhi and li 2020 further attributed the flushing patterns to vertical stratification in n content between shallow and deep groundwater which was caused by n fertilization weak vertical connectivity due to artificial drainage and difference in redox conditions between shallow and deep groundwater in this paper we analyze a long term high frequency measurements of stream discharge and nitrate concentration during 1976 2019 to investigate n fate and transport in an agricultural watershed with historically intensive fertilization and artificial drainage systems in ohio mid western u s previous work by our group indicated the potential for using high frequency measuring techniques to better understand processes and mechanisms controlling n dynamics in drained agricultural land liu et al 2020a liu et al 2020b in this paper we conduct nitrate concentration stream discharge c q hysteresis analysis to 1 investigate the long term variations of hysteresis patterns 2 reveal potential factors e g drainage or n fertilization affecting the long term c q hysteresis patterns and 3 subsequently infer n fate and transport for this intensively drained agricultural watershed findings of this study could help explore the impacts of human activities on nitrate losses from drained agricultural watersheds and possibly inform stakeholders on how to reduce these losses more efficiently 2 materials and methods 2 1 watershed description this study was conducted on a data set collected from honey creek watershed in north central ohio u s https waterdata usgs gov usa nwis uv 04197100 last accessed on aug 14th 2022 fig 1 the 386 km2 149 square miles watershed is a part of the sandusky river basin which is a major source of nutrients and sediment to lake erie richards and baker 2002 tian et al 2016 the soils in honey creek watershed are mostly silt loam and silty clay loam agriculture is the major land use accounting for 80 of the watershed area while forested land represents around 10 of the watershed area table s1 soybean corn wheat and or hay are the main crops grown in the watershed artificial drainage systems have been installed in 60 of arable soils in this watershed to provide soil water conditions favorable to healthy crop growth sugg 2007 in this intensively managed watershed as well as in other croplands in ohio us synthetic fertilizers have long been applied to meet n requirements of crops and improve yields according to a long term dataset synthesized by the united states geological survey usgs historical n fertilization increased significantly in the state of ohio u s from 1940s to mid 1980s and leveled off thereafter fig s3 since fertilization is the primary n input in agricultural watersheds n fertilization was used as a causal factor to explain temporal patterns in nitrate availability in the soil profile in the study watershed 2 2 data preparation and analysis long term measurements of stream discharge and nitrate nitrogen nitrate n concentration were provided by the ohio tributary monitoring program which is operated by the national center for water quality research at heidelberg university and supported by the ohio department of natural resources the measurements were conducted in honey creek at melmore from early 1976 to end of 2019 a rating curve was used to calculate stream discharge as a function of measured stages before 1988 four water samples were collected daily after 1988 three water samples were collected daily using refrigerated auto samplers during days with storm events all water samples were analyzed otherwise only one composite sample was analyzed per day nitrate n concentrations were measured using ion chromatograph thermo scientific dx320 ics2000 detailed description of water sample collection laboratory analysis equipment calibration quality control quality assurance are available on the website of the data source https ncwqr files wordpress com 2019 04 quality assurance plan version 6 20170127 pdf last accessed on aug 14th 2022 details regarding measurements can also be found in previous publications richards and baker 2002 tian et al 2016 2 2 1 event separation based on stream discharge we used a semi automatic event separation approach to extract storm events we calculated the first derivative of the stream discharge against time and then identified potential rising and falling limbs via calibrated thresholds two days the two day threshold was used since event delineation revealed that most of the temporal lags between events were no more than two days subsequently if the temporal lag between rising and falling limbs was less than two days we considered these two limbs as a storm event to simplify event separation for successive storm events with multiple peaks we treated each peak as a storm event all events were manually reviewed and corrected to avoid unexpected errors by the event delineation algorithm fig s4 for the whole dataset we identified 758 storm events from early 1976 to dec 2019 the temporal distribution of these storm events is illustrated in fig s5 the delineated events accounted for 35 of the overall measurement period 5 633 of total 16 043 days and 84 of the total nitrate n export from the study watershed 2 2 2 analysis of event basis hysteresis patterns first the measurements were normalized within an event so that we could compare the hysteresis patterns across months and years we calculated the storm hysteresis index hi lloyd et al 2016 to quantify the direction and strength of hysteresis as follows 1 h i i 1 n c i r i s i n g c i f a l l i n g n where hi is the storm hysteresis index ci rising and ci fallin g are the normalized nitrate n concentrations at the ith segment of the rising and falling limbs of the storm hydrograph respectively n is a scaling factor to linearly interpolate values between actual measurements n 20 since the measurements were normalized hi values ranged from 1 to 1 the absolute value of hi indicates the strength of hysteresis while the sign indicates the direction of the hysteresis loop positive clockwise and negative anti clockwise we also utilized storm flushing index fi a metric suggested by vaughan et al 2017 to describe the change in solute concentration during a storm event the fi which indicates the occurrence of species flushing or dilution during the rising limb of the storm hydrograph is calculated as 2 f i c qpeak r i s i n g c 0 r i s i n g where c0 rising and cqpeak rising are the normalized nitrate n concentrations at the beginning and peak of the rising limb respectivily a positive fi indicates flushing enrichment effect which occurs when the stream discharge in the rising limb has higher nitrate n concentration than the baseflow conversely a negative fi indicates dilution effect which occurs when stream discharge in the rising limb has lower nitrate n concentration than the baseflow as the concentration data were normalized fi values ranged from 1 to 1 depending on the shape of the hysteresis loops in addition to hi and fi we calculated several variables that describe different features of the hydrographs and chemographs of storm events table 1 the variables describing event characteristics were used as potential explanatory variables for the hysteresis metrics response variables in addition to event scale variables listed in table 1 we also quantified the correlation relationships between hi fi and long term nitrogen application and watershed wetness long term n application was quantified by the difference between annual nitrogen application rate and the long term mean nitrogen application rate while watershed wetness was quantified by the deficit of annual water yield calculated as the difference between annual water yield and the long term mean annual water yield furthermore the long term nitrogen application rate was estimated by the total n input by fertilizer in the whole ohio state us from 1945 to 2019 fig s3 the long term water yield was calculated by the stream discharge data measured at the watershed outlet we also fitted simple linear regression models between hysteresis metrics hi and fi and nitrogen application and watershed wetness to quantitatively assess the correlation relationships and their statistical significances 2 2 3 data analysis richards baker flashiness index due to limited long term data documenting the installation of subsurface drainage systems in the study watershed we employed the event basis richards baker flashiness index r b index equation 3 as an implicit indicator for the rate of installation of the subsurface drainage baker et al 2004 jarvie et al 2017 r b index measures the rate of change in stream flow relative to total flow and thus characterizes the flashiness of a watershed in this paper we extended the use of r b index from annual to event scales to quantify the event scale flashiness specifically the higher the r b index values the faster the water leaves the watershed during rainfall or snowmelt events 3 r b i n d e x i 1 n q i q i 1 i 1 n q i where r b index is the richards baker flashiness index q i and q i 1 are the stream discharge values at the ith and i 1 th segments of a storm event respectively mann kendall test the non parametric mann kendall test hirsch and slack 1984 was used to assess the significance of trends of stream discharge and nitrate concentration at the decadal scale if the data were grouped by other factors such as percentiles of stream discharge mann kendall test would assess the significance of annual mean of measurements change point detection we used the pruned exact linear time pelt method implemented in an r package changepoint by killick et al 2012 to detect change points in annual mean nitrate n concentration during the observation period the pelt method identifies change points by minimizing a cost function over temporal segments pruned by potential change points of the overall dataset many researchers used this method to identify change points in hydrological environmental and ecological datasets helton et al 2015 further details regarding the methods to group measurements and to conduct trend analysis are given in the supplemental material s1 analysis of the variance anova we conducted an anova to quantify the inter annual and seasonal variations of hysteresis metrics among years and months since hysteresis metrics showed non normality and stochastic heterogeneity a non parametric method based on bootstrapping and trimmed means was used to analyze the variance among groups if significant differences existed among groups post hoc tests were followed to identify the significant differences between each pair of groups mair and wilcox 2016 spearman s rho ρ we conducted spearman s rho test to evaluate the correlation between hysteresis metrics and descriptors spearman s rho ρ test is a non parametric rank based method to quantify the correlation between two variables a descriptor with a stronger and significant correlation coefficient would have more influence on hysteresis patterns revelle 2017 since features descriptors listed in table 1 might describe similar processes and mechanisms it is possible that such features exhibit high levels of correlation among each other as the correlation analysis focused on the identification of controlling processes we did not exclude those potential features that might correlated with each other 3 results 3 1 long term inter annual and seasonal changes of stream discharge and nitrate concentrations annual mean nitrate n concentrations varied from 1976 to 2019 especially for moderate flows stream flow in the 1st quartile to 3rd quartile range fig 2 a the pelt method detected two change points for nitrate n concentrations in 1989 and 2003 table s2 the annual mean nitrate n concentration data not shown associated with moderate flow exhibited distinct trends in three periods a significant increasing trend p 0 01 from 1976 to 1989 a plateau with a relatively constant annual mean concentration from 1990 until 2003 and a significant declining trend p 0 04 after 2004 however nitrate n concentrations of low and high flow regimes depicted different temporal patterns fig 2a specifically the mean annual nitrate n concentrations of low flow stream flow of 1st quartile remained constant during 1976 2003 and decreased thereafter p 0 01 the nitrate n concentrations of high flow stream flow of 4th quartile showed a similar temporal pattern to nitrate n concentrations of moderate flow until 2004 when it exhibited an abrupt drop instead of a gradual decline monthly mean nitrate n concentrations showed strong but different seasonality for different flow regimes fig 2b generally monthly mean nitrate n concentrations increased with stream flow i e high flows had highest concentrations and low flows had lowest concentrations for low flow monthly nitrate n concentrations were lower than 0 5 mg l 1 except for the winter months with a peak concentration of 5 3 mg l 1 in january in contrast the monthly mean nitrate n concentrations for moderate and high flows exhibited one significant peak in june 5 5 mg l 1 for moderate flow and 9 9 mg l 1 for high flow the monthly nitrate n concentrations were lower than 0 5 mg l 1 during late summer and early fall for both moderate and high flows 3 2 inter annual variations of event based nitrate concentration stream discharge relationship the inter annual variations of storm hi and fi are depicted in fig 3 for the entire dataset the annual mean hi was 0 34 with a standard deviation of 0 31 the first and third quartiles of hi were 0 58 and 0 14 respectively which means most 75 of storm events exhibited anti clockwise loops i e the nitrate concentrations in the rising limb of the hydrograph were generally lower than in the falling limb the annual mean fi was 0 01 with a standard deviation of 0 63 while the first and third quartiles of fi were 0 61 and 0 55 respectively this indicated that fi was approximately normally distributed with zero mean value hence both flushing and dilution type of events had equal probabilities during a year the results of mann kendall trend test showed that there was no significant trend in inter annual variations of either hi or fi p 0 05 however the inter annual variations of fi were much larger than those of hi as suggested by the non parametric anova with trimmed means and bootstrapping for both indices table s3 the anova results revealed insignificant inter annual variations of hi while the differences among inter annual mean values of fi showed significance p 0 05 we did not observe evident changes of hi and fi for the three periods detected in fig 2 data shown in fig s6 3 3 seasonal dynamics of metrics of nitrate concentration stream discharge relationship fig 4 shows the seasonal dynamics of storm hi and fi from 1976 to 2019 mean values of monthly hi ranged from 0 14 to 0 51 and the third quartile 75 percentile for each month varied from 0 37 to 0 12 most of the events exhibited anti clockwise hysteresis loops with different hysteresis strength for each month this suggests that nitrate concentrations in the rising limb of the hydrograph tended to be lower than those during the falling limb on average regardless of whether nitrate exhibited dilution fi 0 or flushing fi 0 pattern during events the overall dynamics of the monthly hi exhibited a w shape curve with peaks occurring in the summer and winter and troughs occurring in the spring and fall months fig 4a the monthly mean values of hi had two peaks in january 0 23 and august 0 14 and two local minima in may 0 45 and october 0 51 the seasonal pattern of fi mirrored those of the hi pattern with mean monthly values of fi ranged from 0 26 to 0 41 interestingly nitrate concentrations inverted patterns during the year they tended to exhibit dilution during events fi 0 in winter and summer with two local minima in august and december and flushing in spring and fall with two peaks of fi in may and october in may and october the 25th percentile values of fi were 0 08 and 0 30 respectively hence 75 of events that occurred in may and october would have higher concentrations of nitrate compared with base flow the fact that the hi indices generally remained negative indicates that nitrate concentration peaks came after the flow peaks this could be attributed to the source of water comprising the rising limb of the hydrograph which was either surface runoff and or subsurface drainage flow from the near drain zone near drain zones contribute disproportionally higher to the total drainage flow particularly when the water table is at or near the soil surface therefore nitrate exhibits accelerated leaching and is less likely to accumulate in these zones which contribute more drainage water during the initial stages of a flow event 3 4 evaluation of factors influencing hysteresis metrics via correlation analysis to further investigate the seasonal patterns of hysteresis metrics according to the post hoc analysis table s3 and monthly hysteresis metrics we further grouped the months based on the four seasons of the year a winter included december january and february b spring included march april and may c summer included june july and august d fall included september october and november among the three month groups we found different correlation patterns for hi and fi with different parameters characterizing the c q patterns table 2 fi significantly correlated with several factors with correlation coefficient ranging from 0 67 to 0 55 and exhibited comparable correlation patterns across month groups flushing index had significant but weak to moderate correlation ρ 0 64 with parameters related to storm discharge rates such as peak discharge rate qpeak magnitude of the discharge δq and mean discharge rate qmean in contrast fi had significant and stronger correlation ρ 0 37 with the parameters related to nitrate concentrations including maximum nitrate n cmax flow weighted nitrate n c w e i g h t e d and magnitude of nitrate n concentrations δc additionally the antecedent conditions e g average stream discharge prior the event e g adi3 adi7 adi30 showed significant and negative correlation with fi ρ 0 47 unlike fi hi was only significantly correlated with several descriptors in winter and spring groups table 2 for winter hi was negatively correlated with the arithmetic and flow weighted mean nitrate n concentration p 0 01 and positively correlated with antecedent conditions adi3 and adi7 for spring hi was significantly and positively correlated with peak discharge mean discharge and relative duration of the rising limbs p 0 01 despite being statistically significant the correlations between hi and the previously mentioned factors were relatively weak with correlation coefficients ranging from 0 37 to 0 26 no significant factors were identified for the summer and fall groups to better relate the results of correlation analysis with controlling factors and mechanisms we also investigated the temporal evolution of subsurface drainage expressed as event scale flashiness of stream discharge in fig 5 fertilizer application fig 6 a and watershed wetness fig 6b during the monitoring period we observed that the event scale r b index increased significantly since 1976 and then leveled off after mid 1980 s from 1976 to 1987 the mean values of r b index increased from 0 15 to 0 37 respectively and the median values of r b index grew from 0 16 to 0 33 respectively from 1987 to 2019 the mean r b index ranged from 0 24 to 0 37 and the median values ranged from 0 23 to 0 36 we also found that the annual mean storm hi and fi were correlated with n fertilization fig 6a and watershed wetness fig 6b with varying levels and opposite patterns the magnitude of hysteresis effects absolute values of hi was slightly greater for greater n fertilization rates fig 6a which means the hysteresis effects were somewhat stronger in years with more n fertilizer input in contrast the storm fi exhibited a strong positive correlation with n fertilization rate the storm fi increased from negative to positive values with increased n fertilization rate which indicated the watershed tended to flush nitrate to streams in greater n fertilization years and dilute nitrate concentration in lower n fertilization years the correlation between storm metrics and watershed wetness were opposite to the correlation between the storm metrics and n fertilization the magnitude of hysteresis effects tended to slightly decrease with higher water yields fig 6b which means the hysteresis effects were somewhat weaker in wet years however storm fi had a strong negative correlation with watershed wetness the storm fi moved from positive values to negative values with increased water yields which indicated the watershed tended to flush nitrate to streams at higher concentrations in dry years and dilute nitrate concentration in wet years 4 discussion 4 1 inter annual nitrate hysteresis patterns and their potential causes our results indicated that the watershed showed negative storm hi for most events which suggests that water with high levels of nitrate n reaches the stream network slower than water with lower nitrate concentrations conversely storm fi exhibited a greater variation with a tendency toward positive fig s6 fig 3 and fig 4 the large variation of fi means both dilution and leaching of nitrate are controlled by many event specific factors such as antecedent conditions and or mean values of nitrate concentrations table 2 the results of this study agreed well with the nitrate hysteresis patterns reported by the majority of studies for agricultural watersheds e g blaen et al 2017 butturini et al 2006 outram et al 2016 williams et al 2018 vaughan et al 2017 for instance williams et al 2018 analyzed nitrate hysteresis for four nested agricultural watersheds with poorly drained soils in western lake erie basin and reported negative hi for 74 of identified events 120 out of 163 a few published studies reported different hysteresis patterns in agricultural watersheds bowes et al 2015 found clockwise nitrate hysteresis in an agricultural watershed without subsurface drainage system in uk and darwiche criado et al 2015 observed different types of hysteresis loops during irrigation and non irrigation periods in an agricultural watershed in spain different hysteresis patterns could be caused by the intensive irrigation events in darwiche criado et al 2015 and differences in nitrate availability over the long term storm hysteresis metrics did not exhibit significant temporal trends suggesting a stationarity phenomenon for the event based nitrate n c q relationships however year to year variabilities of both hi and fi were quite evident fig 3 potential factors contributing to the year to year variabilities of c q relationships are discussed next 4 1 1 artificial subsurface drainage intensive subsurface drainage can substantially influence hysteresis patterns by altering both the hydrological connectivity and nitrate availability in agricultural watersheds subsurface drainage influences hydrological connectivity by lowering groundwater levels in poorly drained soils weakening the direct connection between new event water and old groundwater and expediting water routing processes to receiving waterbodies drury et al 1993 skaggs et al 1994 therefore subsurface drainage can reduce the vertical connectivity precipitation water to groundwater zhi and li 2020 while enhancing lateral water movement when groundwater level becomes shallower than the subsurface drain depths e g significantly less groundwater travel time after installing drainage reported by basu et al 2012 in watersheds in general near stream areas such as riparian buffers along streams are expected to be activated earlier because of the proximity to the stream and the high hydraulic gradient as a result the near stream areas disproportionally contribute to nitrate concentration in the stream flow during the early stages of the rising limb of the hydrograph however in drained agricultural land the near stream areas e g riparian buffers are bypassed by the direct inflow to the stream from the outlet of the drainage system therefore subsurface drainage flow is expected to dominate stream flow during both the rising and falling limbs of the hydrograph except for overland flow that occasionally occurs after large storm events the field hydrology altered by the drainage system creates a gradient in nitrate content within the agricultural field both in the vertical and horizontal directions vertically nitrate levels decline with depth from highest at the biologically active and near nitrate source i e fertilization topsoil layer horizontally nitrate levels decline from highest at the least drained portion of the field i e near the midpoint between the drains to least levels near the drains the near drain areas are characterized by highest hydraulic gradient and therefore disproportionally contribute to the drainage flow particularly at the onset of the drainage events nitrates in the near drain areas exhibit more leaching and less accumulation compared to the areas of the field that are away from the drains as a result the near drain zone is expected to disproportionally contribute to nitrate concentrations during the rising limbs of hydrographs this is supported by our observations that regardless of flushing or dilution effects the hi remained negative additionally subsurface drainage influences nitrate availability by regulating soil wetness and redox conditions that impact n transformation processes in soil profiles improved drainage increases soil aeration which enhances nitrification and slows down denitrification in agricultural watersheds causing nitrate accumulation in the topsoil musolff et al 2016 however event scale c q relationships in agricultural landscapes without intensive subsurface drainage exhibited different hysteresis patterns for example in an agricultural watershed in united kingdom bowes et al 2015 reported clockwise hysteresis loops and dilution effects of nitrate during events such pattern of clockwise loops and dilution effects was mainly affected by rainfall amount and nitrate sources mainly groundwater bowes et al 2015 overall subsurface drainage has been recognized as one of the most dominating factors that cause anti clockwise hysteresis loops in agricultural landscapes blaen et al 2017 bowes et al 2015 in addition as nitrate accumulation in soil profiles can be considerably affected by pre event wetness event scale chemo dynamic status fi is expected to exhibit high variability based on differences in pre event antecedent conditions table 2 williams and mcafee 2021 currently due to the absence of detailed data on drainage system installation it is only possible to qualitatively assess the long term impacts of subsurface drainage on hysteresis patterns with available information it is well documented in the literature that artificial drainage was introduced in early 20th century to enable the conversion of wetlands to croplands in mid western u s and currently subsurface drainage has been widely installed in the poorly drained soil in this region for crop production green et al 2014 jarvie et al 2017 schilling and libra 2000 in our study the calculated event scale r b index values exhibited an increasing trend in 1970s and then leveled off since mid 1980s researchers reported that the lag time between event start and peak increased with subsurface drainage tuohy et al 2016 thus the trend of the r b index reported in this study suggests an increasing trend in subsurface drainage systems installation in the study watershed since the 1970s until mid 1980s when subsurface drainage installation slowed down due to the realization of the negative water quality impacts of agricultural drainage given the hysteresis behavior has been stationary during the monitoring period fig 3 agricultural drainage has already been dominating the hysteresis patterns due to the existence of intensive drainage since 1970s 4 1 2 nitrogen fertilization during the monitoring period 1976 2019 n fertilization exhibited positive correlations with c q hysteresis metrics hi and fi see fig 6a nitrogen fertilization has insignificantly positive correlation with storm hysteresis magnitude absolute values of hi and significantly positive correlation with event scale nitrate flushing fi as greater n fertilizer application brings more nitrogen in this drained agricultural watershed nitrate availability and subsequently nitrate flushing during storm events tends to increase with the increase in n fertilizer application rate fig 6a conversely for those years of lower n fertilization it is supposed to generate nitrate dilution at the event scale although n fertilization has significant correlation with nitrate flushing dilution n fertilization has insignificant correlation with the magnitude of storm hysteresis loops in the study watershed fig 6a possibly due to the dominant role of artificial drainage in the direction and magnitude of nitrate hysteresis loops as discussed in the previous section 4 1 3 year to year watershed wetness this study demonstrated a strong correlation between hysteresis metrics and year to year watershed wetness fig 6b wet years tended to have weaker hysteresis magnitude hi and strong dilution effect large negative fi while dry years had strong flushing effect large positive fi this observed behavior can be explained by the relative roles of both the hydrological connectivity and nitrate availability as affected by watershed wetness dry years are characterized by weak hydrological connectivity that causes considerable differences of nitrate pool sizes between topsoil layers and other activation zones e g shallow groundwater and or near stream areas in dry years nitrate is likely to accumulate in the soil profile especially in the biologically active topsoil layer due possibly to less dilution of runoff reduced n uptake by stressed crops under dry condition and well aerated soil profiles which favors organic n mineralization and nitrification and slows down denitrification randall and mulla 2001 furthermore nitrate is likely to accumulate in zones that are away from direct nitrogen input such as deep soil profiles shallow groundwater and or near stream zones due to limited nitrate transport in dry years the large differences in nitrate pool sizes among different zones can generate stronger hysteresis effects and higher nitrate flushing after dry periods in contrast wet years are characterized by strong hydrological connectivity which leads to relatively higher groundwater levels and greater stream discharge in response to intensive precipitation this leads to small differences of nitrate pool sizes between topsoil layers and other activation zones creating weaker hysteresis patterns furthermore stronger dilution effects tend to occur in wet years when frequent rainfall events prevent nitrate accumulation and subsequent flushing in the watershed therefore the watershed mostly exhibits weaker hysteresis magnitudes and stronger nitrate dilution during wet periods these findings of dry wet cycles are also supported by the finding that fi is significantly affected by the antecedent conditions before the corresponding storms e g q0 and adi3 in table 2 and agree well with many published studies particularly those focused on elevated nutrient export after extreme dry periods macrae et al 2010 outram et al 2014 soulsby et al 2003 4 2 explanation of strong seasonality of hysteresis patterns to explain the seasonality of event hysteresis patterns of c q relationship we used a conceptual model to describe the relationship between discharge generation and soil nitrate availability in the study watershed fig 7 the key drivers controlling the seasonality of c q relationship in this agriculture dominated watershed are fertilization and seasonal climate patterns blaen et al 2017 dupas et al 2016 koenig et al 2017 the seasonal dynamics of hysteresis metrics can be explained by the seasonal variation in hydrological connectivity in the watershed and availability of nitrate in soil and shallow groundwater considering corn as example crop in the study watershed farmers mostly apply commercial fertilizer in the spring and early summer nass usda 1997 nrcs usda 2016 during this period the soil profile has abundant nitrate driven by large n fertilizer input and limited crop uptake as crops grow plant uptake tends to increase and consumes more soil nitrate kleinman et al 2018 ostrom et al 2002 therefore the size of soil nitrate pool shrinks in summer after corn harvest in early fall residual n portion of added fertilizer that is not taken up by crops and mineralization of fresh and readily decomposable crop residues tend to increase nitrate pool in the topsoil the highly mobile soil nitrate can be easily leached even by relatively small storm events in late fall and early winter some farmers would apply fertilizer or animal manure again liu et al 2021b nrcs usda 2016 however the mobility of soil nitrate is mostly restricted by freezing conditions in winter thus during winter and summer months e g dec jan feb july and aug the controlling factors of hysteresis directions and chemo dynamic conditions more dilution are likely related to limited nitrate availability table 2 even though stream discharge is lower in summer july aug because of high et and crop water use discharge generated by storm events tends to correspond to surface runoff carry less nitrate and dilute the nitrate concentration in streams for the spring and late fall months april may jun oct the hysteresis patterns still exhibit anti clockwise directions due to the existence of subsurface drainage system and different nitrate pool sizes between topsoil and other activation zones caused by fertilization since the watershed is not limited by nitrate availability during this period stream nitrate n in fig 7 the factors related to hydrological connectivity e g peak and or mean discharge of storm events are likely to influence hysteresis pattern and chemo dynamic conditions driven by greater nitrate availability and larger differences between nitrate pools in topsoil layers and other activation zones the hysteresis patterns during this period tend to have larger magnitudes and anti clockwise loops with strong tendencies to flush more nitrate during each event fig 4 4 3 implications on n legacy in artificially drained agricultural landscapes our results indicated that the hysteresis patterns for the study watershed exhibited a relatively stationary status at decadal scales fig 3 which could be caused by the combined effects of n fertilization and watershed wetness fig 6 under artificially drained conditions subsurface drainage can be considered the primary controlling factor affecting the hysteresis patterns because its substantial impact on both hydrological connectivity and nitrate availability in this agricultural watershed williams et al 2018 even though fertilization considerably adds n to the agricultural soils the observed direction and magnitude of hysteresis loops were not significantly affected by n fertilization rates fig 6a possibly due to the accelerated transport of n by subsurface drainage which quickly flushed n out of the watershed instead of entering the groundwater and leaves the watershed via much slower flow paths this statement is also supported by the consistently lower levels of nitrate in base flow from the study watershed the low flow regime in fig 2 with the better understanding of hydrological connectivity and nitrate availability inferred by the hysteresis c q analysis in the study watershed we might need to re consider the role of subsurface drainage with regards to the fate and transport of n and the legacy of n fertilization in drained agricultural landscapes perhaps while artificial drainage expedites the export of soluble nitrate from fields to receiving waters it could potentially reduce the legacy of fertilization therefore subsurface drainage could lead to a much quicker response to conservation practices for mitigating excess nitrate losses such as controlled drainage bioreactors and saturated buffers ross et al 2016 in other words drained agricultural landscapes are expected to exhibit shorter lag time between conservation practices implementation and subsequent n load reduction compared to watersheds dominated by naturally well drained soils where n follows long and slow flow paths until it reaches receiving surface water bodies 5 conclusions we analyzed the long term variations of the relationships between nitrate concentrations and stream discharge c q relationships using a long term 1976 2019 high resolution sub daily dataset collected in the honey creek watershed in the lake erie basin mid western u s the study watershed was dominated by artificially drained agricultural land the following conclusions can be drawn from our study generally high stream flow carried more nitrate than low flow annual mean daily nitrate n concentrations exhibited two change points during the study period with an increasing trend followed by a plateau and then a decline in the concentration on a seasonal basis monthly nitrate concentrations in low flows peaked in winter while nitrate concentrations in high flows peaked in late spring and early summer on both annual and season bases event scale hi was consistently negative which means most storm events exhibited anti clockwise loops i e nitrate concentrations in the rising limb of the storm hydrograph were generally lower than in the falling limb the monthly hi exhibited a w shape with strongest hysteresis occurring in the spring and fall and weakest hysteresis occurring in winter and summer the inter annual variations of the event scale fi followed a more or less normal distribution with a mean fi of zero which means both flushing and dilution had equal probabilities of occurrence during the year the fi variability among storms was much larger compared to the variability in hi the seasonal pattern of fi mirrored the seasonal variation of hi events occurring in spring and fall tended to flush nitrate while events occurring in winter and summer tended to cause nitrate dilution as expected both n fertilization and watershed wetness influenced event scale c q relationships the hi was negatively correlated with n fertilization while fi had a positive and stronger correlation with n fertilization wet years exhibited weaker hysteresis and dilution type of events while dry year had stronger hysteresis and flushing type of events intensive subsurface drainage played a dominant role in influencing the observed nitrate c q relationship by altering both the hydrological connectivity and nitrate availability in this drained agricultural watershed the results of this study and other published studies showed that the negative hi or anti clockwise hysteresis loops are characteristics of agricultural watersheds dominated by subsurface drainage intensive drainage weakens the hydrological connectivity with deeper groundwater accelerates nitrate leaching via drainage outflow and reduces nitrate accumulation in the soil profile we hypothesize that intensive drainage may dampen n legacy in artificially drained agricultural landscapes which means drained agricultural watersheds would respond relatively quicker to implementation of nitrogen reduction strategies compared with watershed dominated by naturally well drained soils 9 data availability flow and nitrate concentration data used in this manuscript were downloaded from the national center for water quality research ncwqr in heidelberg university https www heidelberg edu academics research and centers national center for water quality research credit authorship contribution statement wenlong liu conceptualization methodology writing original draft formal analysis shiying tian conceptualization methodology writing review editing mohamed a youssef conceptualization methodology funding acquisition project administration supervision writing review editing françois p birgand conceptualization methodology writing review editing george m chescheir supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the startup funds of yangzhou university no 137012145 and grants awarded by the national institute of food and agriculture nifa u s department of agriculture award numbers 2015 68007 23193 2016 67019 25279 the authors also thank the national center for water quality research ncwqr at heidelberg university for making the flow and nitrate concentrations data publicly available appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128479 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2809,nitrate concentration discharge c q relationshipshave been used to infer nitrate sources storage reactions and transport in watersheds and to reveal key processes that control runoff chemistry yet studies on long term nitrate c q relationships are limited due to scarce high frequency e g daily concentration data in this paper using a long term high frequency dataset 1976 2019 comprising stream flow and nitrate concentrations we quantitatively analyzed the long term variations of event scale hysteresis patterns quantified by hysteresis index hi and flushing index fi to infer the leaching mechanisms of nitrate in an artificially drained agricultural watershed in mid western u s our results revealed that most events exhibited anti clockwise behaviors hi 0 regardless of whether nitrate was flushed or diluted during events this means that water with high levels of nitrate n reaches the stream network slower than water with lower nitrate concentrations long term mean fi was close to zero but had strong seasonal patterns with dilution patterns observed during winter and summer and flushing patterns during late spring and fall the consistently negative hi values regardless of the fi value gave a strong indication of the preponderant role of the near drain zone that usually exhibits accelerated leaching and less accumulation of nitrate in the soil profile in these drained agricultural watersheds both hi and fi depicted strong but opposite seasonality because of weather patterns and agricultural activities particularly n fertilization overall our findings suggest a little evidence of the role of deep groundwater and instead a strong evidence of the role of subsurface drainage as the primary pathway for nitrate transport in drained agricultural watersheds therefore artificial drainage could dampen n legacy caused by the historically intensive n fertilization in drained agricultural landscapes keywords storm hysteresis nitrogen legacy agricultural drainage non point source pollution drainage water quality surface water quality data availability the data used is available from the national center for water quality research heidelberg univ https www heidelberg edu academics research and centers national center for water quality research 1 introduction legacy nitrogen n caused by long term intensive n fertilization has been a major area of research in agricultural water quality baresel and destouni 2006 bieroza et al 2018 hrachowitz et al 2016 van meter and basu 2015 in agricultural watersheds n input that is not taken up by plants can be leached down to deeper groundwater where it may reside for years decades or more before reaching a surface water body depending on groundwater flow paths e g gilmore et al 2016 nitrogen input that is not utilized by plants can also be temporarily stored in soil n pools mainly as soil organic n son which may also reside in the soil profile for years decades or more torn et al 2009 hamilton 2012 hu et al 2019 van meter et al 2016 poffenbarger et al 2018 legacy n can cause a time lag between changes in agricultural activities that introduce n to the landscape and the associated changes in n losses to receiving water bodies e g a considerable amount of n loss could still be observed even after making substantial changes to n related management practices darracq et al 2008 hrachowitz et al 2015 for instance a long term modeling study van meter et al 2018 predicted that reaching the goal of 60 reduction in n loading from the mississippi river basin mrb would take decades even with the most aggressive n use scenarios n use efficiency 100 understanding processes and mechanisms affecting n fate and transport in historically agricultural watersheds is critical for the development of effective long term strategies for minimizing n losses from agricultural landscapes ehrhardt et al 2021 baresel and destouni 2006 meals et al 2010 many researchers reported potentially short hydrological legacy for agricultural watersheds in mid western u s due to the use of artificial drainage in agricultural fields basu et al 2012 schilling and helmers 2008 artificial drainage is used for crop production on naturally poorly drained soils to enhance water movement in the soil profile timely remove excess water in the root zone and provide trafficable conditions for farm machinery artificial drainage dramatically shortens the water flow path to the nearest outlet and thus reduces the hydrological time lag liao et al 2012 schilling et al 2012 schilling et al 2015 estimated that mean travel time of groundwater for fields with drainage systems was 150 times shorter after the installation of drainage systems hence artificial drainage can be thought of as a shortcut for nitrate laden shallow groundwater to surface water bodies bypassing longer flow paths of leaching n into deeper groundwater where water moves slowly towards streams and rivers arenas amado et al 2017 drury et al 1993 gilmore et al 2016 skaggs et al 1994 studies utilized numerical models van meter et al 2018 and advanced analytics of measured hydrologic and stream chemistry data to investigate the role of different processes and mechanisms influencing n fate and transport in the agricultural landscape zhi and li 2020 investigating stream nutrient concentration discharge c q relationships at the event scale could be a useful approach to infer n dynamics in intensively managed watersheds as the response of stream chemistry to discharge can reflect how watersheds store and release water and chemical species researchers have studied event scale c q patterns to infer the sources and controls of constituent transport birkel et al 2017 winter et al 2022 and to reveal temporal variations of stream chemistry blaen et al 2017 dupas et al 2015 musolff et al 2021 specifically analysis of storm hysteresis caused by temporal lags of peaks or troughs between hydrographs and chemographs has been used to characterize event scale c q relationships burns et al 2019 mainly because hysteresis patterns is thought to reveal the relative roles of chemical e g nitrogen in this study availability and hydrological connectivity liu et al 2021a for instance based on c q hysteresis analysis cain et al 2022 concluded that the event basis nitrate c q relationships for agricultural landscapes with subsurface tile drainage and fertilization were highly influenced by the storm event magnitude and antecedent conditions since both factors regulate flow path activation and hydrological connectivity in artificially drained agricultural landscapes therefore investigating c q hysteresis relationships could provide insights on critical processes and mechanisms controlling runoff generation and n dynamics in drained agricultural landscapes measurements of c q at finer resolutions have greater chances to capture rapid changes in stream chemistry occurring in high flow regimes duncan et al 2017 knapp et al 2020 and thus enable researchers to gain better understanding of n dynamics during events liu et al 2020a liu et al 2020b gall et al 2015 for example utilizing higher resolutions hydro biogeochemical measurements from 228 watersheds across the u s zhi and li 2020 reported nitrate flushing patterns increased with stream discharge from agricultural landscapes compared to previously reported chemo stasis of nitrate export from mississippi river basin zhi and li 2020 further attributed the flushing patterns to vertical stratification in n content between shallow and deep groundwater which was caused by n fertilization weak vertical connectivity due to artificial drainage and difference in redox conditions between shallow and deep groundwater in this paper we analyze a long term high frequency measurements of stream discharge and nitrate concentration during 1976 2019 to investigate n fate and transport in an agricultural watershed with historically intensive fertilization and artificial drainage systems in ohio mid western u s previous work by our group indicated the potential for using high frequency measuring techniques to better understand processes and mechanisms controlling n dynamics in drained agricultural land liu et al 2020a liu et al 2020b in this paper we conduct nitrate concentration stream discharge c q hysteresis analysis to 1 investigate the long term variations of hysteresis patterns 2 reveal potential factors e g drainage or n fertilization affecting the long term c q hysteresis patterns and 3 subsequently infer n fate and transport for this intensively drained agricultural watershed findings of this study could help explore the impacts of human activities on nitrate losses from drained agricultural watersheds and possibly inform stakeholders on how to reduce these losses more efficiently 2 materials and methods 2 1 watershed description this study was conducted on a data set collected from honey creek watershed in north central ohio u s https waterdata usgs gov usa nwis uv 04197100 last accessed on aug 14th 2022 fig 1 the 386 km2 149 square miles watershed is a part of the sandusky river basin which is a major source of nutrients and sediment to lake erie richards and baker 2002 tian et al 2016 the soils in honey creek watershed are mostly silt loam and silty clay loam agriculture is the major land use accounting for 80 of the watershed area while forested land represents around 10 of the watershed area table s1 soybean corn wheat and or hay are the main crops grown in the watershed artificial drainage systems have been installed in 60 of arable soils in this watershed to provide soil water conditions favorable to healthy crop growth sugg 2007 in this intensively managed watershed as well as in other croplands in ohio us synthetic fertilizers have long been applied to meet n requirements of crops and improve yields according to a long term dataset synthesized by the united states geological survey usgs historical n fertilization increased significantly in the state of ohio u s from 1940s to mid 1980s and leveled off thereafter fig s3 since fertilization is the primary n input in agricultural watersheds n fertilization was used as a causal factor to explain temporal patterns in nitrate availability in the soil profile in the study watershed 2 2 data preparation and analysis long term measurements of stream discharge and nitrate nitrogen nitrate n concentration were provided by the ohio tributary monitoring program which is operated by the national center for water quality research at heidelberg university and supported by the ohio department of natural resources the measurements were conducted in honey creek at melmore from early 1976 to end of 2019 a rating curve was used to calculate stream discharge as a function of measured stages before 1988 four water samples were collected daily after 1988 three water samples were collected daily using refrigerated auto samplers during days with storm events all water samples were analyzed otherwise only one composite sample was analyzed per day nitrate n concentrations were measured using ion chromatograph thermo scientific dx320 ics2000 detailed description of water sample collection laboratory analysis equipment calibration quality control quality assurance are available on the website of the data source https ncwqr files wordpress com 2019 04 quality assurance plan version 6 20170127 pdf last accessed on aug 14th 2022 details regarding measurements can also be found in previous publications richards and baker 2002 tian et al 2016 2 2 1 event separation based on stream discharge we used a semi automatic event separation approach to extract storm events we calculated the first derivative of the stream discharge against time and then identified potential rising and falling limbs via calibrated thresholds two days the two day threshold was used since event delineation revealed that most of the temporal lags between events were no more than two days subsequently if the temporal lag between rising and falling limbs was less than two days we considered these two limbs as a storm event to simplify event separation for successive storm events with multiple peaks we treated each peak as a storm event all events were manually reviewed and corrected to avoid unexpected errors by the event delineation algorithm fig s4 for the whole dataset we identified 758 storm events from early 1976 to dec 2019 the temporal distribution of these storm events is illustrated in fig s5 the delineated events accounted for 35 of the overall measurement period 5 633 of total 16 043 days and 84 of the total nitrate n export from the study watershed 2 2 2 analysis of event basis hysteresis patterns first the measurements were normalized within an event so that we could compare the hysteresis patterns across months and years we calculated the storm hysteresis index hi lloyd et al 2016 to quantify the direction and strength of hysteresis as follows 1 h i i 1 n c i r i s i n g c i f a l l i n g n where hi is the storm hysteresis index ci rising and ci fallin g are the normalized nitrate n concentrations at the ith segment of the rising and falling limbs of the storm hydrograph respectively n is a scaling factor to linearly interpolate values between actual measurements n 20 since the measurements were normalized hi values ranged from 1 to 1 the absolute value of hi indicates the strength of hysteresis while the sign indicates the direction of the hysteresis loop positive clockwise and negative anti clockwise we also utilized storm flushing index fi a metric suggested by vaughan et al 2017 to describe the change in solute concentration during a storm event the fi which indicates the occurrence of species flushing or dilution during the rising limb of the storm hydrograph is calculated as 2 f i c qpeak r i s i n g c 0 r i s i n g where c0 rising and cqpeak rising are the normalized nitrate n concentrations at the beginning and peak of the rising limb respectivily a positive fi indicates flushing enrichment effect which occurs when the stream discharge in the rising limb has higher nitrate n concentration than the baseflow conversely a negative fi indicates dilution effect which occurs when stream discharge in the rising limb has lower nitrate n concentration than the baseflow as the concentration data were normalized fi values ranged from 1 to 1 depending on the shape of the hysteresis loops in addition to hi and fi we calculated several variables that describe different features of the hydrographs and chemographs of storm events table 1 the variables describing event characteristics were used as potential explanatory variables for the hysteresis metrics response variables in addition to event scale variables listed in table 1 we also quantified the correlation relationships between hi fi and long term nitrogen application and watershed wetness long term n application was quantified by the difference between annual nitrogen application rate and the long term mean nitrogen application rate while watershed wetness was quantified by the deficit of annual water yield calculated as the difference between annual water yield and the long term mean annual water yield furthermore the long term nitrogen application rate was estimated by the total n input by fertilizer in the whole ohio state us from 1945 to 2019 fig s3 the long term water yield was calculated by the stream discharge data measured at the watershed outlet we also fitted simple linear regression models between hysteresis metrics hi and fi and nitrogen application and watershed wetness to quantitatively assess the correlation relationships and their statistical significances 2 2 3 data analysis richards baker flashiness index due to limited long term data documenting the installation of subsurface drainage systems in the study watershed we employed the event basis richards baker flashiness index r b index equation 3 as an implicit indicator for the rate of installation of the subsurface drainage baker et al 2004 jarvie et al 2017 r b index measures the rate of change in stream flow relative to total flow and thus characterizes the flashiness of a watershed in this paper we extended the use of r b index from annual to event scales to quantify the event scale flashiness specifically the higher the r b index values the faster the water leaves the watershed during rainfall or snowmelt events 3 r b i n d e x i 1 n q i q i 1 i 1 n q i where r b index is the richards baker flashiness index q i and q i 1 are the stream discharge values at the ith and i 1 th segments of a storm event respectively mann kendall test the non parametric mann kendall test hirsch and slack 1984 was used to assess the significance of trends of stream discharge and nitrate concentration at the decadal scale if the data were grouped by other factors such as percentiles of stream discharge mann kendall test would assess the significance of annual mean of measurements change point detection we used the pruned exact linear time pelt method implemented in an r package changepoint by killick et al 2012 to detect change points in annual mean nitrate n concentration during the observation period the pelt method identifies change points by minimizing a cost function over temporal segments pruned by potential change points of the overall dataset many researchers used this method to identify change points in hydrological environmental and ecological datasets helton et al 2015 further details regarding the methods to group measurements and to conduct trend analysis are given in the supplemental material s1 analysis of the variance anova we conducted an anova to quantify the inter annual and seasonal variations of hysteresis metrics among years and months since hysteresis metrics showed non normality and stochastic heterogeneity a non parametric method based on bootstrapping and trimmed means was used to analyze the variance among groups if significant differences existed among groups post hoc tests were followed to identify the significant differences between each pair of groups mair and wilcox 2016 spearman s rho ρ we conducted spearman s rho test to evaluate the correlation between hysteresis metrics and descriptors spearman s rho ρ test is a non parametric rank based method to quantify the correlation between two variables a descriptor with a stronger and significant correlation coefficient would have more influence on hysteresis patterns revelle 2017 since features descriptors listed in table 1 might describe similar processes and mechanisms it is possible that such features exhibit high levels of correlation among each other as the correlation analysis focused on the identification of controlling processes we did not exclude those potential features that might correlated with each other 3 results 3 1 long term inter annual and seasonal changes of stream discharge and nitrate concentrations annual mean nitrate n concentrations varied from 1976 to 2019 especially for moderate flows stream flow in the 1st quartile to 3rd quartile range fig 2 a the pelt method detected two change points for nitrate n concentrations in 1989 and 2003 table s2 the annual mean nitrate n concentration data not shown associated with moderate flow exhibited distinct trends in three periods a significant increasing trend p 0 01 from 1976 to 1989 a plateau with a relatively constant annual mean concentration from 1990 until 2003 and a significant declining trend p 0 04 after 2004 however nitrate n concentrations of low and high flow regimes depicted different temporal patterns fig 2a specifically the mean annual nitrate n concentrations of low flow stream flow of 1st quartile remained constant during 1976 2003 and decreased thereafter p 0 01 the nitrate n concentrations of high flow stream flow of 4th quartile showed a similar temporal pattern to nitrate n concentrations of moderate flow until 2004 when it exhibited an abrupt drop instead of a gradual decline monthly mean nitrate n concentrations showed strong but different seasonality for different flow regimes fig 2b generally monthly mean nitrate n concentrations increased with stream flow i e high flows had highest concentrations and low flows had lowest concentrations for low flow monthly nitrate n concentrations were lower than 0 5 mg l 1 except for the winter months with a peak concentration of 5 3 mg l 1 in january in contrast the monthly mean nitrate n concentrations for moderate and high flows exhibited one significant peak in june 5 5 mg l 1 for moderate flow and 9 9 mg l 1 for high flow the monthly nitrate n concentrations were lower than 0 5 mg l 1 during late summer and early fall for both moderate and high flows 3 2 inter annual variations of event based nitrate concentration stream discharge relationship the inter annual variations of storm hi and fi are depicted in fig 3 for the entire dataset the annual mean hi was 0 34 with a standard deviation of 0 31 the first and third quartiles of hi were 0 58 and 0 14 respectively which means most 75 of storm events exhibited anti clockwise loops i e the nitrate concentrations in the rising limb of the hydrograph were generally lower than in the falling limb the annual mean fi was 0 01 with a standard deviation of 0 63 while the first and third quartiles of fi were 0 61 and 0 55 respectively this indicated that fi was approximately normally distributed with zero mean value hence both flushing and dilution type of events had equal probabilities during a year the results of mann kendall trend test showed that there was no significant trend in inter annual variations of either hi or fi p 0 05 however the inter annual variations of fi were much larger than those of hi as suggested by the non parametric anova with trimmed means and bootstrapping for both indices table s3 the anova results revealed insignificant inter annual variations of hi while the differences among inter annual mean values of fi showed significance p 0 05 we did not observe evident changes of hi and fi for the three periods detected in fig 2 data shown in fig s6 3 3 seasonal dynamics of metrics of nitrate concentration stream discharge relationship fig 4 shows the seasonal dynamics of storm hi and fi from 1976 to 2019 mean values of monthly hi ranged from 0 14 to 0 51 and the third quartile 75 percentile for each month varied from 0 37 to 0 12 most of the events exhibited anti clockwise hysteresis loops with different hysteresis strength for each month this suggests that nitrate concentrations in the rising limb of the hydrograph tended to be lower than those during the falling limb on average regardless of whether nitrate exhibited dilution fi 0 or flushing fi 0 pattern during events the overall dynamics of the monthly hi exhibited a w shape curve with peaks occurring in the summer and winter and troughs occurring in the spring and fall months fig 4a the monthly mean values of hi had two peaks in january 0 23 and august 0 14 and two local minima in may 0 45 and october 0 51 the seasonal pattern of fi mirrored those of the hi pattern with mean monthly values of fi ranged from 0 26 to 0 41 interestingly nitrate concentrations inverted patterns during the year they tended to exhibit dilution during events fi 0 in winter and summer with two local minima in august and december and flushing in spring and fall with two peaks of fi in may and october in may and october the 25th percentile values of fi were 0 08 and 0 30 respectively hence 75 of events that occurred in may and october would have higher concentrations of nitrate compared with base flow the fact that the hi indices generally remained negative indicates that nitrate concentration peaks came after the flow peaks this could be attributed to the source of water comprising the rising limb of the hydrograph which was either surface runoff and or subsurface drainage flow from the near drain zone near drain zones contribute disproportionally higher to the total drainage flow particularly when the water table is at or near the soil surface therefore nitrate exhibits accelerated leaching and is less likely to accumulate in these zones which contribute more drainage water during the initial stages of a flow event 3 4 evaluation of factors influencing hysteresis metrics via correlation analysis to further investigate the seasonal patterns of hysteresis metrics according to the post hoc analysis table s3 and monthly hysteresis metrics we further grouped the months based on the four seasons of the year a winter included december january and february b spring included march april and may c summer included june july and august d fall included september october and november among the three month groups we found different correlation patterns for hi and fi with different parameters characterizing the c q patterns table 2 fi significantly correlated with several factors with correlation coefficient ranging from 0 67 to 0 55 and exhibited comparable correlation patterns across month groups flushing index had significant but weak to moderate correlation ρ 0 64 with parameters related to storm discharge rates such as peak discharge rate qpeak magnitude of the discharge δq and mean discharge rate qmean in contrast fi had significant and stronger correlation ρ 0 37 with the parameters related to nitrate concentrations including maximum nitrate n cmax flow weighted nitrate n c w e i g h t e d and magnitude of nitrate n concentrations δc additionally the antecedent conditions e g average stream discharge prior the event e g adi3 adi7 adi30 showed significant and negative correlation with fi ρ 0 47 unlike fi hi was only significantly correlated with several descriptors in winter and spring groups table 2 for winter hi was negatively correlated with the arithmetic and flow weighted mean nitrate n concentration p 0 01 and positively correlated with antecedent conditions adi3 and adi7 for spring hi was significantly and positively correlated with peak discharge mean discharge and relative duration of the rising limbs p 0 01 despite being statistically significant the correlations between hi and the previously mentioned factors were relatively weak with correlation coefficients ranging from 0 37 to 0 26 no significant factors were identified for the summer and fall groups to better relate the results of correlation analysis with controlling factors and mechanisms we also investigated the temporal evolution of subsurface drainage expressed as event scale flashiness of stream discharge in fig 5 fertilizer application fig 6 a and watershed wetness fig 6b during the monitoring period we observed that the event scale r b index increased significantly since 1976 and then leveled off after mid 1980 s from 1976 to 1987 the mean values of r b index increased from 0 15 to 0 37 respectively and the median values of r b index grew from 0 16 to 0 33 respectively from 1987 to 2019 the mean r b index ranged from 0 24 to 0 37 and the median values ranged from 0 23 to 0 36 we also found that the annual mean storm hi and fi were correlated with n fertilization fig 6a and watershed wetness fig 6b with varying levels and opposite patterns the magnitude of hysteresis effects absolute values of hi was slightly greater for greater n fertilization rates fig 6a which means the hysteresis effects were somewhat stronger in years with more n fertilizer input in contrast the storm fi exhibited a strong positive correlation with n fertilization rate the storm fi increased from negative to positive values with increased n fertilization rate which indicated the watershed tended to flush nitrate to streams in greater n fertilization years and dilute nitrate concentration in lower n fertilization years the correlation between storm metrics and watershed wetness were opposite to the correlation between the storm metrics and n fertilization the magnitude of hysteresis effects tended to slightly decrease with higher water yields fig 6b which means the hysteresis effects were somewhat weaker in wet years however storm fi had a strong negative correlation with watershed wetness the storm fi moved from positive values to negative values with increased water yields which indicated the watershed tended to flush nitrate to streams at higher concentrations in dry years and dilute nitrate concentration in wet years 4 discussion 4 1 inter annual nitrate hysteresis patterns and their potential causes our results indicated that the watershed showed negative storm hi for most events which suggests that water with high levels of nitrate n reaches the stream network slower than water with lower nitrate concentrations conversely storm fi exhibited a greater variation with a tendency toward positive fig s6 fig 3 and fig 4 the large variation of fi means both dilution and leaching of nitrate are controlled by many event specific factors such as antecedent conditions and or mean values of nitrate concentrations table 2 the results of this study agreed well with the nitrate hysteresis patterns reported by the majority of studies for agricultural watersheds e g blaen et al 2017 butturini et al 2006 outram et al 2016 williams et al 2018 vaughan et al 2017 for instance williams et al 2018 analyzed nitrate hysteresis for four nested agricultural watersheds with poorly drained soils in western lake erie basin and reported negative hi for 74 of identified events 120 out of 163 a few published studies reported different hysteresis patterns in agricultural watersheds bowes et al 2015 found clockwise nitrate hysteresis in an agricultural watershed without subsurface drainage system in uk and darwiche criado et al 2015 observed different types of hysteresis loops during irrigation and non irrigation periods in an agricultural watershed in spain different hysteresis patterns could be caused by the intensive irrigation events in darwiche criado et al 2015 and differences in nitrate availability over the long term storm hysteresis metrics did not exhibit significant temporal trends suggesting a stationarity phenomenon for the event based nitrate n c q relationships however year to year variabilities of both hi and fi were quite evident fig 3 potential factors contributing to the year to year variabilities of c q relationships are discussed next 4 1 1 artificial subsurface drainage intensive subsurface drainage can substantially influence hysteresis patterns by altering both the hydrological connectivity and nitrate availability in agricultural watersheds subsurface drainage influences hydrological connectivity by lowering groundwater levels in poorly drained soils weakening the direct connection between new event water and old groundwater and expediting water routing processes to receiving waterbodies drury et al 1993 skaggs et al 1994 therefore subsurface drainage can reduce the vertical connectivity precipitation water to groundwater zhi and li 2020 while enhancing lateral water movement when groundwater level becomes shallower than the subsurface drain depths e g significantly less groundwater travel time after installing drainage reported by basu et al 2012 in watersheds in general near stream areas such as riparian buffers along streams are expected to be activated earlier because of the proximity to the stream and the high hydraulic gradient as a result the near stream areas disproportionally contribute to nitrate concentration in the stream flow during the early stages of the rising limb of the hydrograph however in drained agricultural land the near stream areas e g riparian buffers are bypassed by the direct inflow to the stream from the outlet of the drainage system therefore subsurface drainage flow is expected to dominate stream flow during both the rising and falling limbs of the hydrograph except for overland flow that occasionally occurs after large storm events the field hydrology altered by the drainage system creates a gradient in nitrate content within the agricultural field both in the vertical and horizontal directions vertically nitrate levels decline with depth from highest at the biologically active and near nitrate source i e fertilization topsoil layer horizontally nitrate levels decline from highest at the least drained portion of the field i e near the midpoint between the drains to least levels near the drains the near drain areas are characterized by highest hydraulic gradient and therefore disproportionally contribute to the drainage flow particularly at the onset of the drainage events nitrates in the near drain areas exhibit more leaching and less accumulation compared to the areas of the field that are away from the drains as a result the near drain zone is expected to disproportionally contribute to nitrate concentrations during the rising limbs of hydrographs this is supported by our observations that regardless of flushing or dilution effects the hi remained negative additionally subsurface drainage influences nitrate availability by regulating soil wetness and redox conditions that impact n transformation processes in soil profiles improved drainage increases soil aeration which enhances nitrification and slows down denitrification in agricultural watersheds causing nitrate accumulation in the topsoil musolff et al 2016 however event scale c q relationships in agricultural landscapes without intensive subsurface drainage exhibited different hysteresis patterns for example in an agricultural watershed in united kingdom bowes et al 2015 reported clockwise hysteresis loops and dilution effects of nitrate during events such pattern of clockwise loops and dilution effects was mainly affected by rainfall amount and nitrate sources mainly groundwater bowes et al 2015 overall subsurface drainage has been recognized as one of the most dominating factors that cause anti clockwise hysteresis loops in agricultural landscapes blaen et al 2017 bowes et al 2015 in addition as nitrate accumulation in soil profiles can be considerably affected by pre event wetness event scale chemo dynamic status fi is expected to exhibit high variability based on differences in pre event antecedent conditions table 2 williams and mcafee 2021 currently due to the absence of detailed data on drainage system installation it is only possible to qualitatively assess the long term impacts of subsurface drainage on hysteresis patterns with available information it is well documented in the literature that artificial drainage was introduced in early 20th century to enable the conversion of wetlands to croplands in mid western u s and currently subsurface drainage has been widely installed in the poorly drained soil in this region for crop production green et al 2014 jarvie et al 2017 schilling and libra 2000 in our study the calculated event scale r b index values exhibited an increasing trend in 1970s and then leveled off since mid 1980s researchers reported that the lag time between event start and peak increased with subsurface drainage tuohy et al 2016 thus the trend of the r b index reported in this study suggests an increasing trend in subsurface drainage systems installation in the study watershed since the 1970s until mid 1980s when subsurface drainage installation slowed down due to the realization of the negative water quality impacts of agricultural drainage given the hysteresis behavior has been stationary during the monitoring period fig 3 agricultural drainage has already been dominating the hysteresis patterns due to the existence of intensive drainage since 1970s 4 1 2 nitrogen fertilization during the monitoring period 1976 2019 n fertilization exhibited positive correlations with c q hysteresis metrics hi and fi see fig 6a nitrogen fertilization has insignificantly positive correlation with storm hysteresis magnitude absolute values of hi and significantly positive correlation with event scale nitrate flushing fi as greater n fertilizer application brings more nitrogen in this drained agricultural watershed nitrate availability and subsequently nitrate flushing during storm events tends to increase with the increase in n fertilizer application rate fig 6a conversely for those years of lower n fertilization it is supposed to generate nitrate dilution at the event scale although n fertilization has significant correlation with nitrate flushing dilution n fertilization has insignificant correlation with the magnitude of storm hysteresis loops in the study watershed fig 6a possibly due to the dominant role of artificial drainage in the direction and magnitude of nitrate hysteresis loops as discussed in the previous section 4 1 3 year to year watershed wetness this study demonstrated a strong correlation between hysteresis metrics and year to year watershed wetness fig 6b wet years tended to have weaker hysteresis magnitude hi and strong dilution effect large negative fi while dry years had strong flushing effect large positive fi this observed behavior can be explained by the relative roles of both the hydrological connectivity and nitrate availability as affected by watershed wetness dry years are characterized by weak hydrological connectivity that causes considerable differences of nitrate pool sizes between topsoil layers and other activation zones e g shallow groundwater and or near stream areas in dry years nitrate is likely to accumulate in the soil profile especially in the biologically active topsoil layer due possibly to less dilution of runoff reduced n uptake by stressed crops under dry condition and well aerated soil profiles which favors organic n mineralization and nitrification and slows down denitrification randall and mulla 2001 furthermore nitrate is likely to accumulate in zones that are away from direct nitrogen input such as deep soil profiles shallow groundwater and or near stream zones due to limited nitrate transport in dry years the large differences in nitrate pool sizes among different zones can generate stronger hysteresis effects and higher nitrate flushing after dry periods in contrast wet years are characterized by strong hydrological connectivity which leads to relatively higher groundwater levels and greater stream discharge in response to intensive precipitation this leads to small differences of nitrate pool sizes between topsoil layers and other activation zones creating weaker hysteresis patterns furthermore stronger dilution effects tend to occur in wet years when frequent rainfall events prevent nitrate accumulation and subsequent flushing in the watershed therefore the watershed mostly exhibits weaker hysteresis magnitudes and stronger nitrate dilution during wet periods these findings of dry wet cycles are also supported by the finding that fi is significantly affected by the antecedent conditions before the corresponding storms e g q0 and adi3 in table 2 and agree well with many published studies particularly those focused on elevated nutrient export after extreme dry periods macrae et al 2010 outram et al 2014 soulsby et al 2003 4 2 explanation of strong seasonality of hysteresis patterns to explain the seasonality of event hysteresis patterns of c q relationship we used a conceptual model to describe the relationship between discharge generation and soil nitrate availability in the study watershed fig 7 the key drivers controlling the seasonality of c q relationship in this agriculture dominated watershed are fertilization and seasonal climate patterns blaen et al 2017 dupas et al 2016 koenig et al 2017 the seasonal dynamics of hysteresis metrics can be explained by the seasonal variation in hydrological connectivity in the watershed and availability of nitrate in soil and shallow groundwater considering corn as example crop in the study watershed farmers mostly apply commercial fertilizer in the spring and early summer nass usda 1997 nrcs usda 2016 during this period the soil profile has abundant nitrate driven by large n fertilizer input and limited crop uptake as crops grow plant uptake tends to increase and consumes more soil nitrate kleinman et al 2018 ostrom et al 2002 therefore the size of soil nitrate pool shrinks in summer after corn harvest in early fall residual n portion of added fertilizer that is not taken up by crops and mineralization of fresh and readily decomposable crop residues tend to increase nitrate pool in the topsoil the highly mobile soil nitrate can be easily leached even by relatively small storm events in late fall and early winter some farmers would apply fertilizer or animal manure again liu et al 2021b nrcs usda 2016 however the mobility of soil nitrate is mostly restricted by freezing conditions in winter thus during winter and summer months e g dec jan feb july and aug the controlling factors of hysteresis directions and chemo dynamic conditions more dilution are likely related to limited nitrate availability table 2 even though stream discharge is lower in summer july aug because of high et and crop water use discharge generated by storm events tends to correspond to surface runoff carry less nitrate and dilute the nitrate concentration in streams for the spring and late fall months april may jun oct the hysteresis patterns still exhibit anti clockwise directions due to the existence of subsurface drainage system and different nitrate pool sizes between topsoil and other activation zones caused by fertilization since the watershed is not limited by nitrate availability during this period stream nitrate n in fig 7 the factors related to hydrological connectivity e g peak and or mean discharge of storm events are likely to influence hysteresis pattern and chemo dynamic conditions driven by greater nitrate availability and larger differences between nitrate pools in topsoil layers and other activation zones the hysteresis patterns during this period tend to have larger magnitudes and anti clockwise loops with strong tendencies to flush more nitrate during each event fig 4 4 3 implications on n legacy in artificially drained agricultural landscapes our results indicated that the hysteresis patterns for the study watershed exhibited a relatively stationary status at decadal scales fig 3 which could be caused by the combined effects of n fertilization and watershed wetness fig 6 under artificially drained conditions subsurface drainage can be considered the primary controlling factor affecting the hysteresis patterns because its substantial impact on both hydrological connectivity and nitrate availability in this agricultural watershed williams et al 2018 even though fertilization considerably adds n to the agricultural soils the observed direction and magnitude of hysteresis loops were not significantly affected by n fertilization rates fig 6a possibly due to the accelerated transport of n by subsurface drainage which quickly flushed n out of the watershed instead of entering the groundwater and leaves the watershed via much slower flow paths this statement is also supported by the consistently lower levels of nitrate in base flow from the study watershed the low flow regime in fig 2 with the better understanding of hydrological connectivity and nitrate availability inferred by the hysteresis c q analysis in the study watershed we might need to re consider the role of subsurface drainage with regards to the fate and transport of n and the legacy of n fertilization in drained agricultural landscapes perhaps while artificial drainage expedites the export of soluble nitrate from fields to receiving waters it could potentially reduce the legacy of fertilization therefore subsurface drainage could lead to a much quicker response to conservation practices for mitigating excess nitrate losses such as controlled drainage bioreactors and saturated buffers ross et al 2016 in other words drained agricultural landscapes are expected to exhibit shorter lag time between conservation practices implementation and subsequent n load reduction compared to watersheds dominated by naturally well drained soils where n follows long and slow flow paths until it reaches receiving surface water bodies 5 conclusions we analyzed the long term variations of the relationships between nitrate concentrations and stream discharge c q relationships using a long term 1976 2019 high resolution sub daily dataset collected in the honey creek watershed in the lake erie basin mid western u s the study watershed was dominated by artificially drained agricultural land the following conclusions can be drawn from our study generally high stream flow carried more nitrate than low flow annual mean daily nitrate n concentrations exhibited two change points during the study period with an increasing trend followed by a plateau and then a decline in the concentration on a seasonal basis monthly nitrate concentrations in low flows peaked in winter while nitrate concentrations in high flows peaked in late spring and early summer on both annual and season bases event scale hi was consistently negative which means most storm events exhibited anti clockwise loops i e nitrate concentrations in the rising limb of the storm hydrograph were generally lower than in the falling limb the monthly hi exhibited a w shape with strongest hysteresis occurring in the spring and fall and weakest hysteresis occurring in winter and summer the inter annual variations of the event scale fi followed a more or less normal distribution with a mean fi of zero which means both flushing and dilution had equal probabilities of occurrence during the year the fi variability among storms was much larger compared to the variability in hi the seasonal pattern of fi mirrored the seasonal variation of hi events occurring in spring and fall tended to flush nitrate while events occurring in winter and summer tended to cause nitrate dilution as expected both n fertilization and watershed wetness influenced event scale c q relationships the hi was negatively correlated with n fertilization while fi had a positive and stronger correlation with n fertilization wet years exhibited weaker hysteresis and dilution type of events while dry year had stronger hysteresis and flushing type of events intensive subsurface drainage played a dominant role in influencing the observed nitrate c q relationship by altering both the hydrological connectivity and nitrate availability in this drained agricultural watershed the results of this study and other published studies showed that the negative hi or anti clockwise hysteresis loops are characteristics of agricultural watersheds dominated by subsurface drainage intensive drainage weakens the hydrological connectivity with deeper groundwater accelerates nitrate leaching via drainage outflow and reduces nitrate accumulation in the soil profile we hypothesize that intensive drainage may dampen n legacy in artificially drained agricultural landscapes which means drained agricultural watersheds would respond relatively quicker to implementation of nitrogen reduction strategies compared with watershed dominated by naturally well drained soils 9 data availability flow and nitrate concentration data used in this manuscript were downloaded from the national center for water quality research ncwqr in heidelberg university https www heidelberg edu academics research and centers national center for water quality research credit authorship contribution statement wenlong liu conceptualization methodology writing original draft formal analysis shiying tian conceptualization methodology writing review editing mohamed a youssef conceptualization methodology funding acquisition project administration supervision writing review editing françois p birgand conceptualization methodology writing review editing george m chescheir supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the startup funds of yangzhou university no 137012145 and grants awarded by the national institute of food and agriculture nifa u s department of agriculture award numbers 2015 68007 23193 2016 67019 25279 the authors also thank the national center for water quality research ncwqr at heidelberg university for making the flow and nitrate concentrations data publicly available appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128479 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
