index,text
22855,this work predicts hydrodynamic characteristics for a rolling ship hull section flows about the mid section of a kvlcc2 under harmonic excited roll motions are simulated with solutions of navier stokes ns equations filtered by a large eddy simulation les with a finite volume fv solver this solver applies a fourth order compact scheme to discrete spatial terms a fourth order runge kutta scheme to advance equations a momentum interpolation method mim to avoid pressure and velocity decoupling a volume of fluid vof method to capture free surface and a ghost cell immersed boundary method gcibm to simulate rolling ship firstly verification is implemented to confirm the convergency validation is followed by comparison with experimental data then systematic assessments are made on the effects of roll amplitude frequency and bilge keels by analyzing the tendency of roll moment damping and added mass moment of inertia as well as flow structures wave radiation and viscous effects are elucidated through flow structures as a result viscous effect is dominant roll amplitude frequency and bilge keels influence roll hydrodynamic characteristics substantially besides causes of vortex generation shedding and movement variation of dynamic pressure field and mechanism of bilge keel to mitigate roll motion are disclosed keywords roll hydrodynamic characteristics roll damping flow structure harmonic excited roll motion high order finite volume solver viscous effect 1 introduction vortical flow effect and wave radiation are main causes influencing roll motions induced by intricate vortical flow field originated from pressure drop at the ship corner especially for a ship hull with sharp edge fitted with bilge keels prediction of roll hydrodynamic characteristics becomes extraordinarily difficult and due to the inherent nonlinearity of roll response viscous effect is non negligible generally vugts 1968 is the very first scholar who recognizes the importance of viscous effect on roll motion by harmonic excited roll tests and potential theory calculations for various cross sections it is found that potential theory predicts hydrodynamic coefficients for heave and sway motions accurately but reveals large discrepancy for roll motion of which wave damping is small while viscous damping is significant as a result of these findings prediction on ship motions except roll are successfully implemented in terms of potential flow theory see maiti and sen 2001 du et al 2011 and as for roll motion simulation a viscous damping coefficient calculated by empirical formula refer to ikeda 1978 himeno 1981 is incorporated into potential calculation which leads to significant improvement of the accuracy referring to brown and patel 1985 downie et al 1988 however limitation of empirical formula is widely reported in recently years bassler and reed 2009 yıldız et al 2016 thus more careful studies on the mechanism of roll hydrodynamic characteristics is needed experimental study on prediction of roll motion indubitably became a reliable way since the time of william froude 1872 for instance jung et al 2004 2005 applied particle image velocimetry piv to investigate the flow characteristics for regular waves passing a fixed and a free rolling rectangular structure in a wave tank however each test spends enormous amounts and therefore experiment is always performed for typical cases and for validation of numerical methods recently irkal et al 2016 performed such a validation of a computational fluid dynamics cfd approach in estimation of roll damping thus developing a thorough numerical code for prediction of roll motion is imperative realized the importance of the viscous effect yeung and ananthakrishnan 1992 first tried fully viscous flow solver to simulate heave problem based on a finite difference method in a boundary fitted coordinate system and significant progress is made on flow separation vorticity vortex generation and shedding which could not be obtained using the potential theory although yeung and ananthakrishnan 1992 simulated heave problem only it paves a way to roll prediction later korpus and falzarano 1997 applied reynolds averaged ns rans equations to simulate ship roll damping and found that viscous and vortical effects significantly affect damping coefficient and roll moment after that viscous flow solver was developed with increasing popular applications to the prediction of roll hydrodynamic characteristics solving ns equations via a fv discretization on an unstructured grid bangun et al 2010 assessed bilge keel orientation effect on hydrodynamic forces for a harmonic excited roll barge via a fv method on a collocated grid yu and kinnas 2009 predicted roll responses for various ship hull sections via a fv method with the upwind total variation diminishing tvd scheme of roe sweby avalos et al 2014 investigated the influence of bilge keel on roll motion for a floating production storage and offloading fpso via a commercial unsteady rans urans code yıldız et al 2016 calculated roll damping for a ship hull section at shallow draft accuracy of the above mentioned studies is not much higher than second order considering the importance of roll hydrodynamic characteristics in seakeeping prediction numerical method with high order accuracy is a pursuit recently xu et al 2005 bai et al 2017 zhang et al 2018 develop a high order fv solver on a collocated grid where spatial terms are discretized by a fourth order compact scheme temporary terms are advanced by a fourth order runge kutta scheme a mim is for pressure velocity coupling a vof method for free surface capturing a gcibm for moving body treatment and a les model for turbulence simulation contributions of this work are in i extending the previous work of zhang et al 2018 to large eddy simulations on harmonic excited roll motions ii carrying out verification and validation to detect numerical deviation of the present solver iii predicting the harmonic excited roll motions and calculating roll damping coefficients and added mass moment of inertia iv revealing the variation of flow structures including vorticity contours velocity vectors and the dynamic pressure field v analyzing the response of roll amplitude frequency and bilge keel to roll motion vi disclosing the reason causing vortex generation shedding and movement vii bringing insight into the mechanism of bilge keel to mitigate roll motion 2 mathematical formulation the problem under study is schematically depicted in fig 1 mid section of a ship model rolls in a harmonic excited manner about roll center o in a numerical wave tank of water depth h following yeung et al 1998 roll center o is set at the equilibrium free surface roll angle ϕ is positive if ship tilted counterclockwise roll amplitude and frequency are designated by ϕ 0 and ω computation domain of the numerical wave tank is bounded by upstream boundary σ 1 downstream boundary σ 2 top boundary λ bottom boundary γ immersed ship boundary κ free surface ε height of the computation domain is h length of far fields either the upstream boundary or the downstream boundary to ship hull is l as fig 2 shows ship hull is fitted with bilge keels of width b and thickness t inclined an angle β with respect to the hull bottom the ship hull is of draught d breadth b depth d and bilge radius r 2 1 governing equations in this work a large eddy simulation is carried out where velocity and pressure fields are filtered to form resolved scale velocity and pressure fields respectively and effect of unresolved scale fields on the resolved scale fields are reproduced by a subgrid scale sgs model referring to zhang et al 2018 applying a grid filter to incompressible ns equations yields 1 u 0 2 u t u u 1 ρ p ν ν t 2 u g j which reflects conservation of mass and momentum respectively in above equations variables u u x y t u v and p p x y t denote the velocity and pressure fields after filtering ρ x y t and ν x y t are fluid density and kinematic viscosity g is the gravitational acceleration the second term on the left side of eq 2 represents flow convection effect and the second term on the right side is the diffusion effect due to fluid viscosity ν t x y t represents the sgs turbulent viscosity which is estimated by 3 ν t c s δ 2 s where c s is smagorinsky constant δ the filter width s the magnitude of the resolved strain rate tensor 2 2 boundary conditions on κ the immersed ship boundary conditions of no slip are to be imposed 4 u y o y ϕ 0 ω cos ω t 5 v x x 0 ϕ 0 ω cos ω t on ε the free surface instantaneous shape is captured by introduction of a scalar function as for ε κ intersection of the free surface and the immersed boundary free slip conditions are assumed 6 u y 0 7 v y 0 on σ 1 and σ 2 the far field boundaries λ the top boundary and γ the bottom boundary the velocities are set to be zero and free slip conditions 8 u 0 v 0 9 u n 0 v n 0 are imposed where n denotes the direction normal to the boundary and outward the computation domain 2 3 roll moment calculation the ship hull rolls in a harmonic excited manner under the action of roll moment which in numerical simulation is evaluated by an integral of the vector product of the position vector r from roll center and the external force f over κ 10 m κ k r f d s where r x x o i y y o j external force is the sum of the dynamic pressure p dynamic p p ρ g y o y and viscous shear stress force f ν ρ ν u y v x p is the pressure on free surface k denotes the direction normal to the calculation two dimensional plane 3 numerical formulation to discretize the transport equation 2 a high order finite volume solver on a collocated grid is applied at first divide the computation domain into sufficiently fine control volumes i e cells flow variables are specified at the center of each cell representatively as fig 3 shows capital letters such as p are assigned to centers of the cells and the lower case letters e n w and s are assigned to the centers of the faces i e the east north west and south faces which bound cell p as an example here the velocity component u is to be derived integral of eq 2 spatially over cell p by means of a fourth order compact scheme 11 a i c u w w u w b i c u e c i c u w d i c u p o δ x 4 12 a i d u x w w u x w b i d u x e c i d u w d i d u p o δ x 4 yields a semi discretization equation 13 u t p a p u p n b a n b u n b a p p e p w b where a i comes from the convection and diffusion terms which depends on the discretization scheme used superscripts c and d specify convection and diffusion respectively then temporal integral of the above semi discretized equation over a time step δ t from the current time step n to the next time step n 1 by means of a fourth order runge kutta scheme 14 u p n 1 u p n δ t 6 k 1 2 k 2 2 k 3 k 4 δ t ρ p n 1 k a p u p n b a n b u n b b f a c e u f a c e n 1 δ s f a c e 0 f a c e denotes e w n s results an algebraic equation 15 a p u p n b a n b u n b a p p e p w b p here n b represents the four cell nodes ε w n and s neighboring p in fig 3 b is a source term except the one due to pressure gradient and a p is the effective action area on which pressure difference applies that is area of the cross section of cell p algebraic equation for velocity component v can be readily obtained in a similar way discretization of the continuity equation 1 is straight it yields 16 ρ u a e ρ u a w ρ u a n ρ u a s 0 3 1 momentum interpolation method in mim presented by rhie and chow 1983 temporal derivative of velocity and the velocity at face center are expressed in a similar way to eqs 13 and 15 for example at e a face center of cell p they are 17 u e t a p e u e n b a n b n b u n b a p e p e p p b e 18 a p e u e n b a n b n b u n b a p e p e p p b p e the difference of them from eqs 13 and 15 is only at subscripts attached to the coefficients capital letters in eqs 13 and 15 are replaced by lower case letters in eqs 17 and 18 and lower case letters are replaced by capital letters a i b i with lower case subscripts are interpolated by the ones with capital subscripts n b represents the four face centers neighboring to face center e to solve eqs 16 and 18 for solutions of flow field decompose velocity u and pressure p into the guessed ones u and p and the corrections u and p following the treatment of semi implicit method for pressure linked equation simple algorithm velocity correction u does not take contributions from velocities at neighborhoods into account but the influence of pressure difference and the source term starting from eq 18 velocity correction u 19 u e a p a p e p e p p b p a p e is derived meanwhile the guessed velocity u takes the value of the latest updated one which satisfies conservation laws of mass and momentum and is known similarly at other three face centers about cell p the guessed velocities and velocity corrections can be readily derived applying them to eq 16 a pressure correction equation 20 a p p p a e p e a w p w a n p n a s p s b is derived with b ρ u a w ρ u a e ρ u a s ρ u a n solution of above pressure correction equation can be obtained by means of the strong implicit produce sip then pressure and velocity can be successively updated 3 2 treatment of rolling ship the harmonic excited rolling ship will be simulated by a gcibm to avoid decoupling of the velocity and pressure an external forcing f is introduced to eq 17 the momentum interpolation equation at e a face center of cell p after introduction of an external forcing component f x eq 17 becomes 21 u e t a p e u e n b a n b n b u n b a p e p e p p b e f x e on the immersed ship boundary no slip condition demands the external forcing to be 22 f x e u e n 1 u e δ t a p e u e n b a n b n b u n b a p e p e p p b e where u e n 1 is an appropriate estimation of ghost cell velocity at the next time step n 1 and u e is the velocity corresponding to each step of the fourth order runge kutta scheme at the current time step n velocity u e n 1 only exits at the ghost cell and is to be determined which is at present reconstructed by least square high order interpolation peller et al 2010 according to a local direction ghost cell approach berthelsen and faltinsen 2008 effect of external forcing f x e is like the source term b p e and is merged into source term b p e in eq 18 therefore introduction of the external forcing does not change the implementation of the mim in section 3 1 except evaluation of the source term 3 3 capture of free surface a second order piecewise linear interface calculation pilc sort vof method gueyffier et al 1999 is applied to capture the free surface at each instant for this purpose a volume of fluid function f is introduced which can distinguish the cell filled with water f 1 air f 0 or partially water and partially air 0 f 1 where free surface is definitely involved in the cell conservation of function f requires 23 d f d t 0 after the evaluation of the volume of fluid function f fluid density and kinematic viscosity can be updated by 24 ρ f ρ water 1 f ρ air 25 ν f ν water 1 f ν air 3 4 implementation of force calculation referring to lai and peskin 2000 the external force f in eq 10 can be calculated in an alternative way which use the external forcing f rather than the sum of pressure and shearing stress exerted on the immersed boundary of the ship that is 26 f ρ f g j d u d t then the moment is evaluated by an integral of the vector product of the position vector r from roll center and the external force f inside the immersed boundary of the body say domain ω in fig 2 as 27 m ω k r f d v 4 results and discussions in this work to make comparison with tank tests possibly a ship model of kvlcc2 with scale of 1 128 77 is considered in numerical simulation the mid section depicted in fig 2 undergoes harmonic excited roll motion principal particulars of the mid section bilge keels fitted and sizes of the computation domain are given in table 1 4 1 forced roll hydrodynamics single degree of freedom roll motion is governed by conservation of angular momentum as 28 m total i 44 ϕ where m total m g m b m p d m f m e x t is the total roll moment which consists of the moments due to gravity m g buoyancy m b hydrodynamic pressure m p d friction m f and external moment m e x t since roll axis passes through the center of gravity m g 0 hydrostatic pressure is calculated in this simulation thus m p m p d m b represents the moment due to hydrostatic pressure calculated moment m m p m f denotes the moment caused by hydrostatic pressure and friction spring mass damper analogy is applied to obtain roll damping coefficient b 44 and added mass moment of inertia a 44 29 i 44 a 44 ϕ b 44 ϕ c 44 ϕ m e x t in which c 44 ϕ is the restoring moment eqs 28 29 yield 30 a 44 ϕ b 44 ϕ m c 44 ϕ m ω m ω is called the hydrodynamic roll moment then hydrodynamic coefficients can be drawn by means of the fouier analysis 31 a 44 1 π ϕ 0 ω 0 t m ω sin ω t d t 32 b 44 1 π ϕ 0 0 t m ω cos ω t d t below are expressions of dimensionless angular frequency damping coefficient and mass moment of inertia to be used 33 ω ω b 2 g a 44 a 44 ρ a m b 2 b 44 b 44 ρ a m b 2 b 2 g where a m is submerged area of the mid section 4 2 verification and validation feasibility of the code based on the forementioned solver in prediction of roll hydrodynamic characteristics is performed via verification and validation investigations verification is carried out by confirming the convergency of the solver with decreasing cell size and time step for simplicity the bilge keels are taken away and let the mid section without bilge keels fitted roll in a sinusoidal manner with a prescribed amplitude say ϕ 0 0 087 rad and a prescribed frequency say ω 0 952 to confirm the convergency simulations are carried out for three different cell sizes as listed in table 2 and three different time steps listed in table 3 simulations are carried out for three different cell sizes see the first column in table 2 and for three time steps the first column in table 3 we call the smallest cell or time step as fine cell or fine step the largest cell size or time step as coarse cell or step and between them as medium cell or step fig 4 shows time histories of the calculated roll moment due to pressure and friction evaluated from simulation for the three cell sizes and fig 5 shows the calculated moment under three time steps where time step is 0 0003s in fig 4 and cell size near the hull is 0 002 m in fig 5 we can see that moment histories coincide well the amplitude is only getting a little bit smaller with the decrease of cell size and almost same for three time steps to show convergency quantitatively introduce a measurement difference d m 0 34 d m 0 m 0 coarser m 0 fine m 0 fine to measure the difference of the third amplitude of calculated roll moment m 0 due to hydrostatic pressure and friction a physical value obtained from simulation with coarser cell or step from m 0 fine as summarized in tables 2 and 3 the difference decreases with the decrease of cell size and increases a little with the decrease of time step which confirms the convergency of the solver for the sake of accuracy hereafter simulation are performed only for fine cell 0 0010 m and step 0 0005 s validation is implemented by comparing simulated results with experimental data the ship undergoes harmonic excited roll motions table 3 lists roll amplitudes ϕ 0 and frequencies ω of the prescribed sinusoidal roll motions and the corresponding damping coefficients both from experiments and from present simulation the experiments are carried out in circulating water channel at shanghai jiao tong university discrepancy of dimensionless roll damping coefficient between experiment and the corresponding simulation 35 d b 44 experiment b 44 simulation b 44 simulation for each case is summarized in the table from table 4 one can see that present simulation results coincide well with the measured ones discrepancies are very small normally below one percent occasionally ten percent this validates present simulation method besides a harmonic excited roll motion with amplitude ϕ 0 0 1004 rad frequency ω 0 8 performed numerically and experimentally in yeung et al 1998 for a rectangular with 0 02 b bilge radius and 0 5 b draft is simulated to validate the present solver fig 6 shows the comparison of hydrodynamic roll moment with the results of yeung et al 1998 from the figure good agreement is shown the amplitude of roll moment is more accurate compared with one by fsrvm method thus the present solver is capable of predicting performance of harmonic excited roll motion 4 3 roll moments and hydrodynamic coefficients roll amplitude frequency and size of the bilge keels are the factors determining roll moment damping coefficient and added mass moment of inertia table 4 lists the cases to be investigated for variety of roll amplitudes the first column frequencies the second column and bilge keel widths the third column figs 7 9 show the simulated time histories of hydrodynamic roll moment for various amplitudes frequencies and bilge keel widths respectively mark interval in these figures is 50 δ t from figs 7 and 8 we can see that increases of roll amplitude and frequency cause increase of roll moment but have little effect on phase of roll moment from fig 9 it can be seen that wider bilge keel causes roll moment larger but does not significantly change the phase of roll moment spikes and skew of roll moment history are observed which are symptoms of nonlinearity it is more remarkable for wider bilge keels the causes will be reflected in section 4 3 table 5 summarizes for all the cases roll damping coefficient and added mass moment of inertia they are plotted in figs 10 12 from fig 10 one can see that both roll damping and added mass moment of inertia increase with roll amplitude from fig 11 it can be seen that roll damping increase with roll frequency however added mass moment of inertia at first sensitively rises with frequency until a maximum value and then drops mildly from fig 12 obviously roll damping and added mass moment of inertia increase with bilge keel width 4 4 flow structures flow structures consist of velocity vorticity and dynamic pressure fields flow separation vortex generation shedding and movement and pressure variation are interwoven they are the essential physical causes which change hydrodynamic forces of the rolling ship this section enters into detail flow structures to try to uncover the mechanism of roll hydrodynamics behind the harmonic excited roll motions firstly look at dynamic pressure variation fig 13 displays variation of dynamic pressure distributions around the mid section over one roll circle in this case it rolls sinusoidally with amplitude ϕ 0 0 175 rad period t 1 0 s and width of bilge keels b 0 01 m fig 13 a shows pressure distribution at 0 9955s at this instant the mid section experiences almost a full roll cycle and it will go counter clockwise in large speed which means the flow around it flows in large speed we can see from the figure that negative pressure occurs near and behind bilge keels and pressure difference between two sides of each bilge keel is very large therefore bilge keels greatly contributes to the roll moment and a big negative roll moment is resulted fig 13 b corresponds to the instant of 1 1005s mid section enters into ten percent of the second roll cycle and roll speed decreases much which means the flow speed decreases the negative pressure fields now go away from ship bilges and pressure difference between two sides of each bilge keel is not significant this causes a neutral roll moment fig 13 c corresponds to the instant of 1 2498s mid section enters into a quarter of the second roll cycle and the roll motion will be changed from counter clockwise to clockwise and roll speed decrease to zero due to inertia of the flow sign of the pressure difference between two sides of each bilge keel is reversed and sign of roll moment is also altered fig 13 d corresponds to the instant of 1 4448s mid section enters into nearly half of the second roll cycle and the roll speed is very large and its sign is reversed so the flow velocity is very large the situation is quite the opposite of fig 13 a due to big pressure difference between two sides of each bilge keel it causes a big positive roll moment fig 13 e corresponds to the instant of 1 6382s mid section enters into nearly sixty percent of the second roll cycle and roll speed decreases much so flow velocity decreases too the negative pressure fields move away from the ship bilges this causes a nearly neutral roll moment fig 13 f corresponds to the instant of 1 8311s mid section enters into nearly eighty percent of the second roll cycle sign of roll speed is reversed again which causes the sign of roll moment alters fig 13 g corresponds to the instant of 1 9959s it experiences nearly two roll cycle the situation is the same of fig 13 a from above one can find that roll moment negatively correlated with the speed of flow near the mid section though time history of roll moment is calculated by both dynamic pressure and shear stress roll moment caused by dynamic pressure has a coincident variation with total roll moment as shown in fig 13 besides from these figures one can find that free surface changes little during ship rolling this explains that wave radiation has little effect on roll motion variations of vorticity and velocity are followed fig 14 displays vorticity contours and corresponding velocity vectors around the mid section over one roll circle to show the phenomena of flow separation vortex generation shedding and movement vorticity contours are on left side and velocity vectors right side the calculation conditions are set to be same as ones of variation of dynamic pressure distributions in fig 13 fig 14 a shows vorticity and velocity at 0 9955s at this instant the mid section rolls nearly a full cycle and it will go counter clockwise vortices now are all generated in the first roll cycle fig 14 b corresponds to the instant of 1 2498s mid section enters into a quarter of the second roll cycle and it reaches its maximum position size and strength of negative vortices become maximum besides vortices around the left bilge move to ship side and around right bilge moves to ship bottom then ship reverses to clockwise new positive vortices are generated while negative vortices shed from ship surface it can be observed that generation of new positive vortex begins at ship side near left bilge while at ship bottom near right bilge fig 14 c corresponds to the instant of 1 5046s mid section enters into half of the second roll cycle new positive vortices become stronger and negative ones weaken all vortices move against the roll motion fig 14 d corresponds to the instant of 1 7411s mid section enters into three quarters of the second roll cycle and it reaches its maximum position energy of the positive vortices becomes maximum and negative one minimum parts of vortices are diffused mid section reverses to counter clockwise generations of new negative vortices begin at the opposite locations of fig 14 b accompanied with the positive vortices shedding fig 14 e corresponds to the instant of 1 9959s mid section experiences almost two roll cycles the situation is quite the same of fig 14 a above phenomena summarize the phenomena of vortex generation shedding and movement it is observed that location of vortex generation is always ahead of ship rolling direction refer to fig 14 b d this is because that speed of flow near the mid section is larger than one of the mid section then flow separation occurs and then vortices generation phenomena appear besides direction of vortices movement is always opposite of one of ship rolling this is to damp out the roll motion besides with the generation of new vortices old vortices shed from ship surface see fig 14 b d this is due to the phenomenon of flow separation as elucidation before during the movement of vortices they diffuse then influences of roll amplitude and bilge keel on harmonic excited roll motion are investigated via flow structures firstly look at the roll amplitude effect fig 15 displays vorticity contours velocity vectors and dynamic pressures roughly at the instant t 2 t for ship fitted with no bilge keel rolling with various roll amplitudes a ϕ 0 0 087 rad b ϕ 0 0 131 rad c ϕ 0 0 175 rad dimensionless roll frequency is ω 0 952 it is observed that the strength and size of the vortices increase with roll amplitude for small amplitude previous vortices almost diffuse already and for large amplitude previous vortices are still strong besides dynamic pressure becomes large with the increase of roll amplitude since that the speed of flow near the mid section is closely related to roll amplitude and it negatively correlated with roll moment as mentioned before free surface has little change with roll amplitude it reveals that wave radiation has little contribution to roll hydrodynamic characteristics bilge keel effect is followed fig 16 displays vorticity contours velocity vectors and dynamic pressures roughly at the instant t 2 t for ship fitted with various bilge keel widths a b 0 b b 0 005 m c b 0 01 m d b 0 015 m rolling with amplitude ϕ 0 0 175 rad dimensionless roll frequency ω 0 952 it is shown that strength and size of the vortices increase with bilge keel width besides interaction between those vortices is strengthening which accords to their distances from each other thus when ship fits with wider bilge keel the energy which damps out roll motion is getting stronger besides dynamic pressure also increases with bilge keel width it is observed that the main differences of dynamic pressure distributions in these figures appear near and behind bilge keels it turns out that there are two parts damping caused by bilge keel to mitigate roll motion one is due to the variation of dynamic pressure distribution on ship surface which forms the added surface damping another is due to the pressure difference at two sides of bilge keels which forms bilge keel damping as before free surface changes little with bilge keel width proving that viscous effect is extremely important when ship fitted with bilge keels while contribution of wave radiation is small from figs 15 and 16 one can see that flow fields are more complex with increasing roll amplitude and bilge keel width and it causes the spiky and skew of time histories of roll motion in previous section 4 2 5 conclusions this work extends the previous work of zhang et al 2018 to simulate roll hydrodynamic characteristics through the harmonic excited roll motions a high order finite volume solver is applied to obtain flow solutions i e velocity and pressure of ns equations in a vof based wave tank a fourth order compact scheme as well as a fourth order runge kutta scheme discrete governing equations into algebraic forms and then a mim confirms pressure and velocity coupling besides a gcibm simulates the rolling ship the numerical solver turns out to be feasible after verification and validation investigations this work focuses on roll hydrodynamic characteristics accounting for the effects of roll amplitude frequency as well as bilge keel on the roll moment damping coefficient added mass moment of inertia vorticity contour velocity vector and dynamic pressure are carefully investigated the findings are as bellow 1 roll damping coefficient increases with roll amplitude frequency and bilge keel width added mass moment of inertia increases with roll amplitude and bilge keel width but increases firstly with roll amplitude then decreases spikes and skew of roll moment history are observed for ship fitted with bilge keels showing the nonlinearity these phenomena are explained through intricate pressure variation accompanying with the vortex generation shedding and movement 2 free surface changes little during ship rolling observed from flow fields displayed in this paper while vortices are complicated revealing that viscous effect is non negligible for roll motion and wave radiation effect is inconsequential 3 distribution of dynamic pressure is in accordance with roll moment to prevent roll motion and negatively correlated with the speed of flow near the rolling mid section location of vortex generation is always ahead of ship rolling direction due to the phenomenon of flow separation movement of vortex is to damp out roll motion parts of vortex diffuse along with its movement in addition shedding of vortex is accompanied with vortices generation due to flow separation besides strength of vortex and dynamic pressures increase with roll amplitude and bilge keel width interactions between vortices are strengthening with the increase of bilge keel width the mechanism of bilge keel to mitigate roll motion is the variation of the pressure distribution on ship surface and two sides of bilge keels and then forming added surface damping and bilge keel damping respectively acknowledgement this study is financially supported by the national project of the knowledge based ship design hyper integrated platform ii kship ii no zxzy019 
22855,this work predicts hydrodynamic characteristics for a rolling ship hull section flows about the mid section of a kvlcc2 under harmonic excited roll motions are simulated with solutions of navier stokes ns equations filtered by a large eddy simulation les with a finite volume fv solver this solver applies a fourth order compact scheme to discrete spatial terms a fourth order runge kutta scheme to advance equations a momentum interpolation method mim to avoid pressure and velocity decoupling a volume of fluid vof method to capture free surface and a ghost cell immersed boundary method gcibm to simulate rolling ship firstly verification is implemented to confirm the convergency validation is followed by comparison with experimental data then systematic assessments are made on the effects of roll amplitude frequency and bilge keels by analyzing the tendency of roll moment damping and added mass moment of inertia as well as flow structures wave radiation and viscous effects are elucidated through flow structures as a result viscous effect is dominant roll amplitude frequency and bilge keels influence roll hydrodynamic characteristics substantially besides causes of vortex generation shedding and movement variation of dynamic pressure field and mechanism of bilge keel to mitigate roll motion are disclosed keywords roll hydrodynamic characteristics roll damping flow structure harmonic excited roll motion high order finite volume solver viscous effect 1 introduction vortical flow effect and wave radiation are main causes influencing roll motions induced by intricate vortical flow field originated from pressure drop at the ship corner especially for a ship hull with sharp edge fitted with bilge keels prediction of roll hydrodynamic characteristics becomes extraordinarily difficult and due to the inherent nonlinearity of roll response viscous effect is non negligible generally vugts 1968 is the very first scholar who recognizes the importance of viscous effect on roll motion by harmonic excited roll tests and potential theory calculations for various cross sections it is found that potential theory predicts hydrodynamic coefficients for heave and sway motions accurately but reveals large discrepancy for roll motion of which wave damping is small while viscous damping is significant as a result of these findings prediction on ship motions except roll are successfully implemented in terms of potential flow theory see maiti and sen 2001 du et al 2011 and as for roll motion simulation a viscous damping coefficient calculated by empirical formula refer to ikeda 1978 himeno 1981 is incorporated into potential calculation which leads to significant improvement of the accuracy referring to brown and patel 1985 downie et al 1988 however limitation of empirical formula is widely reported in recently years bassler and reed 2009 yıldız et al 2016 thus more careful studies on the mechanism of roll hydrodynamic characteristics is needed experimental study on prediction of roll motion indubitably became a reliable way since the time of william froude 1872 for instance jung et al 2004 2005 applied particle image velocimetry piv to investigate the flow characteristics for regular waves passing a fixed and a free rolling rectangular structure in a wave tank however each test spends enormous amounts and therefore experiment is always performed for typical cases and for validation of numerical methods recently irkal et al 2016 performed such a validation of a computational fluid dynamics cfd approach in estimation of roll damping thus developing a thorough numerical code for prediction of roll motion is imperative realized the importance of the viscous effect yeung and ananthakrishnan 1992 first tried fully viscous flow solver to simulate heave problem based on a finite difference method in a boundary fitted coordinate system and significant progress is made on flow separation vorticity vortex generation and shedding which could not be obtained using the potential theory although yeung and ananthakrishnan 1992 simulated heave problem only it paves a way to roll prediction later korpus and falzarano 1997 applied reynolds averaged ns rans equations to simulate ship roll damping and found that viscous and vortical effects significantly affect damping coefficient and roll moment after that viscous flow solver was developed with increasing popular applications to the prediction of roll hydrodynamic characteristics solving ns equations via a fv discretization on an unstructured grid bangun et al 2010 assessed bilge keel orientation effect on hydrodynamic forces for a harmonic excited roll barge via a fv method on a collocated grid yu and kinnas 2009 predicted roll responses for various ship hull sections via a fv method with the upwind total variation diminishing tvd scheme of roe sweby avalos et al 2014 investigated the influence of bilge keel on roll motion for a floating production storage and offloading fpso via a commercial unsteady rans urans code yıldız et al 2016 calculated roll damping for a ship hull section at shallow draft accuracy of the above mentioned studies is not much higher than second order considering the importance of roll hydrodynamic characteristics in seakeeping prediction numerical method with high order accuracy is a pursuit recently xu et al 2005 bai et al 2017 zhang et al 2018 develop a high order fv solver on a collocated grid where spatial terms are discretized by a fourth order compact scheme temporary terms are advanced by a fourth order runge kutta scheme a mim is for pressure velocity coupling a vof method for free surface capturing a gcibm for moving body treatment and a les model for turbulence simulation contributions of this work are in i extending the previous work of zhang et al 2018 to large eddy simulations on harmonic excited roll motions ii carrying out verification and validation to detect numerical deviation of the present solver iii predicting the harmonic excited roll motions and calculating roll damping coefficients and added mass moment of inertia iv revealing the variation of flow structures including vorticity contours velocity vectors and the dynamic pressure field v analyzing the response of roll amplitude frequency and bilge keel to roll motion vi disclosing the reason causing vortex generation shedding and movement vii bringing insight into the mechanism of bilge keel to mitigate roll motion 2 mathematical formulation the problem under study is schematically depicted in fig 1 mid section of a ship model rolls in a harmonic excited manner about roll center o in a numerical wave tank of water depth h following yeung et al 1998 roll center o is set at the equilibrium free surface roll angle ϕ is positive if ship tilted counterclockwise roll amplitude and frequency are designated by ϕ 0 and ω computation domain of the numerical wave tank is bounded by upstream boundary σ 1 downstream boundary σ 2 top boundary λ bottom boundary γ immersed ship boundary κ free surface ε height of the computation domain is h length of far fields either the upstream boundary or the downstream boundary to ship hull is l as fig 2 shows ship hull is fitted with bilge keels of width b and thickness t inclined an angle β with respect to the hull bottom the ship hull is of draught d breadth b depth d and bilge radius r 2 1 governing equations in this work a large eddy simulation is carried out where velocity and pressure fields are filtered to form resolved scale velocity and pressure fields respectively and effect of unresolved scale fields on the resolved scale fields are reproduced by a subgrid scale sgs model referring to zhang et al 2018 applying a grid filter to incompressible ns equations yields 1 u 0 2 u t u u 1 ρ p ν ν t 2 u g j which reflects conservation of mass and momentum respectively in above equations variables u u x y t u v and p p x y t denote the velocity and pressure fields after filtering ρ x y t and ν x y t are fluid density and kinematic viscosity g is the gravitational acceleration the second term on the left side of eq 2 represents flow convection effect and the second term on the right side is the diffusion effect due to fluid viscosity ν t x y t represents the sgs turbulent viscosity which is estimated by 3 ν t c s δ 2 s where c s is smagorinsky constant δ the filter width s the magnitude of the resolved strain rate tensor 2 2 boundary conditions on κ the immersed ship boundary conditions of no slip are to be imposed 4 u y o y ϕ 0 ω cos ω t 5 v x x 0 ϕ 0 ω cos ω t on ε the free surface instantaneous shape is captured by introduction of a scalar function as for ε κ intersection of the free surface and the immersed boundary free slip conditions are assumed 6 u y 0 7 v y 0 on σ 1 and σ 2 the far field boundaries λ the top boundary and γ the bottom boundary the velocities are set to be zero and free slip conditions 8 u 0 v 0 9 u n 0 v n 0 are imposed where n denotes the direction normal to the boundary and outward the computation domain 2 3 roll moment calculation the ship hull rolls in a harmonic excited manner under the action of roll moment which in numerical simulation is evaluated by an integral of the vector product of the position vector r from roll center and the external force f over κ 10 m κ k r f d s where r x x o i y y o j external force is the sum of the dynamic pressure p dynamic p p ρ g y o y and viscous shear stress force f ν ρ ν u y v x p is the pressure on free surface k denotes the direction normal to the calculation two dimensional plane 3 numerical formulation to discretize the transport equation 2 a high order finite volume solver on a collocated grid is applied at first divide the computation domain into sufficiently fine control volumes i e cells flow variables are specified at the center of each cell representatively as fig 3 shows capital letters such as p are assigned to centers of the cells and the lower case letters e n w and s are assigned to the centers of the faces i e the east north west and south faces which bound cell p as an example here the velocity component u is to be derived integral of eq 2 spatially over cell p by means of a fourth order compact scheme 11 a i c u w w u w b i c u e c i c u w d i c u p o δ x 4 12 a i d u x w w u x w b i d u x e c i d u w d i d u p o δ x 4 yields a semi discretization equation 13 u t p a p u p n b a n b u n b a p p e p w b where a i comes from the convection and diffusion terms which depends on the discretization scheme used superscripts c and d specify convection and diffusion respectively then temporal integral of the above semi discretized equation over a time step δ t from the current time step n to the next time step n 1 by means of a fourth order runge kutta scheme 14 u p n 1 u p n δ t 6 k 1 2 k 2 2 k 3 k 4 δ t ρ p n 1 k a p u p n b a n b u n b b f a c e u f a c e n 1 δ s f a c e 0 f a c e denotes e w n s results an algebraic equation 15 a p u p n b a n b u n b a p p e p w b p here n b represents the four cell nodes ε w n and s neighboring p in fig 3 b is a source term except the one due to pressure gradient and a p is the effective action area on which pressure difference applies that is area of the cross section of cell p algebraic equation for velocity component v can be readily obtained in a similar way discretization of the continuity equation 1 is straight it yields 16 ρ u a e ρ u a w ρ u a n ρ u a s 0 3 1 momentum interpolation method in mim presented by rhie and chow 1983 temporal derivative of velocity and the velocity at face center are expressed in a similar way to eqs 13 and 15 for example at e a face center of cell p they are 17 u e t a p e u e n b a n b n b u n b a p e p e p p b e 18 a p e u e n b a n b n b u n b a p e p e p p b p e the difference of them from eqs 13 and 15 is only at subscripts attached to the coefficients capital letters in eqs 13 and 15 are replaced by lower case letters in eqs 17 and 18 and lower case letters are replaced by capital letters a i b i with lower case subscripts are interpolated by the ones with capital subscripts n b represents the four face centers neighboring to face center e to solve eqs 16 and 18 for solutions of flow field decompose velocity u and pressure p into the guessed ones u and p and the corrections u and p following the treatment of semi implicit method for pressure linked equation simple algorithm velocity correction u does not take contributions from velocities at neighborhoods into account but the influence of pressure difference and the source term starting from eq 18 velocity correction u 19 u e a p a p e p e p p b p a p e is derived meanwhile the guessed velocity u takes the value of the latest updated one which satisfies conservation laws of mass and momentum and is known similarly at other three face centers about cell p the guessed velocities and velocity corrections can be readily derived applying them to eq 16 a pressure correction equation 20 a p p p a e p e a w p w a n p n a s p s b is derived with b ρ u a w ρ u a e ρ u a s ρ u a n solution of above pressure correction equation can be obtained by means of the strong implicit produce sip then pressure and velocity can be successively updated 3 2 treatment of rolling ship the harmonic excited rolling ship will be simulated by a gcibm to avoid decoupling of the velocity and pressure an external forcing f is introduced to eq 17 the momentum interpolation equation at e a face center of cell p after introduction of an external forcing component f x eq 17 becomes 21 u e t a p e u e n b a n b n b u n b a p e p e p p b e f x e on the immersed ship boundary no slip condition demands the external forcing to be 22 f x e u e n 1 u e δ t a p e u e n b a n b n b u n b a p e p e p p b e where u e n 1 is an appropriate estimation of ghost cell velocity at the next time step n 1 and u e is the velocity corresponding to each step of the fourth order runge kutta scheme at the current time step n velocity u e n 1 only exits at the ghost cell and is to be determined which is at present reconstructed by least square high order interpolation peller et al 2010 according to a local direction ghost cell approach berthelsen and faltinsen 2008 effect of external forcing f x e is like the source term b p e and is merged into source term b p e in eq 18 therefore introduction of the external forcing does not change the implementation of the mim in section 3 1 except evaluation of the source term 3 3 capture of free surface a second order piecewise linear interface calculation pilc sort vof method gueyffier et al 1999 is applied to capture the free surface at each instant for this purpose a volume of fluid function f is introduced which can distinguish the cell filled with water f 1 air f 0 or partially water and partially air 0 f 1 where free surface is definitely involved in the cell conservation of function f requires 23 d f d t 0 after the evaluation of the volume of fluid function f fluid density and kinematic viscosity can be updated by 24 ρ f ρ water 1 f ρ air 25 ν f ν water 1 f ν air 3 4 implementation of force calculation referring to lai and peskin 2000 the external force f in eq 10 can be calculated in an alternative way which use the external forcing f rather than the sum of pressure and shearing stress exerted on the immersed boundary of the ship that is 26 f ρ f g j d u d t then the moment is evaluated by an integral of the vector product of the position vector r from roll center and the external force f inside the immersed boundary of the body say domain ω in fig 2 as 27 m ω k r f d v 4 results and discussions in this work to make comparison with tank tests possibly a ship model of kvlcc2 with scale of 1 128 77 is considered in numerical simulation the mid section depicted in fig 2 undergoes harmonic excited roll motion principal particulars of the mid section bilge keels fitted and sizes of the computation domain are given in table 1 4 1 forced roll hydrodynamics single degree of freedom roll motion is governed by conservation of angular momentum as 28 m total i 44 ϕ where m total m g m b m p d m f m e x t is the total roll moment which consists of the moments due to gravity m g buoyancy m b hydrodynamic pressure m p d friction m f and external moment m e x t since roll axis passes through the center of gravity m g 0 hydrostatic pressure is calculated in this simulation thus m p m p d m b represents the moment due to hydrostatic pressure calculated moment m m p m f denotes the moment caused by hydrostatic pressure and friction spring mass damper analogy is applied to obtain roll damping coefficient b 44 and added mass moment of inertia a 44 29 i 44 a 44 ϕ b 44 ϕ c 44 ϕ m e x t in which c 44 ϕ is the restoring moment eqs 28 29 yield 30 a 44 ϕ b 44 ϕ m c 44 ϕ m ω m ω is called the hydrodynamic roll moment then hydrodynamic coefficients can be drawn by means of the fouier analysis 31 a 44 1 π ϕ 0 ω 0 t m ω sin ω t d t 32 b 44 1 π ϕ 0 0 t m ω cos ω t d t below are expressions of dimensionless angular frequency damping coefficient and mass moment of inertia to be used 33 ω ω b 2 g a 44 a 44 ρ a m b 2 b 44 b 44 ρ a m b 2 b 2 g where a m is submerged area of the mid section 4 2 verification and validation feasibility of the code based on the forementioned solver in prediction of roll hydrodynamic characteristics is performed via verification and validation investigations verification is carried out by confirming the convergency of the solver with decreasing cell size and time step for simplicity the bilge keels are taken away and let the mid section without bilge keels fitted roll in a sinusoidal manner with a prescribed amplitude say ϕ 0 0 087 rad and a prescribed frequency say ω 0 952 to confirm the convergency simulations are carried out for three different cell sizes as listed in table 2 and three different time steps listed in table 3 simulations are carried out for three different cell sizes see the first column in table 2 and for three time steps the first column in table 3 we call the smallest cell or time step as fine cell or fine step the largest cell size or time step as coarse cell or step and between them as medium cell or step fig 4 shows time histories of the calculated roll moment due to pressure and friction evaluated from simulation for the three cell sizes and fig 5 shows the calculated moment under three time steps where time step is 0 0003s in fig 4 and cell size near the hull is 0 002 m in fig 5 we can see that moment histories coincide well the amplitude is only getting a little bit smaller with the decrease of cell size and almost same for three time steps to show convergency quantitatively introduce a measurement difference d m 0 34 d m 0 m 0 coarser m 0 fine m 0 fine to measure the difference of the third amplitude of calculated roll moment m 0 due to hydrostatic pressure and friction a physical value obtained from simulation with coarser cell or step from m 0 fine as summarized in tables 2 and 3 the difference decreases with the decrease of cell size and increases a little with the decrease of time step which confirms the convergency of the solver for the sake of accuracy hereafter simulation are performed only for fine cell 0 0010 m and step 0 0005 s validation is implemented by comparing simulated results with experimental data the ship undergoes harmonic excited roll motions table 3 lists roll amplitudes ϕ 0 and frequencies ω of the prescribed sinusoidal roll motions and the corresponding damping coefficients both from experiments and from present simulation the experiments are carried out in circulating water channel at shanghai jiao tong university discrepancy of dimensionless roll damping coefficient between experiment and the corresponding simulation 35 d b 44 experiment b 44 simulation b 44 simulation for each case is summarized in the table from table 4 one can see that present simulation results coincide well with the measured ones discrepancies are very small normally below one percent occasionally ten percent this validates present simulation method besides a harmonic excited roll motion with amplitude ϕ 0 0 1004 rad frequency ω 0 8 performed numerically and experimentally in yeung et al 1998 for a rectangular with 0 02 b bilge radius and 0 5 b draft is simulated to validate the present solver fig 6 shows the comparison of hydrodynamic roll moment with the results of yeung et al 1998 from the figure good agreement is shown the amplitude of roll moment is more accurate compared with one by fsrvm method thus the present solver is capable of predicting performance of harmonic excited roll motion 4 3 roll moments and hydrodynamic coefficients roll amplitude frequency and size of the bilge keels are the factors determining roll moment damping coefficient and added mass moment of inertia table 4 lists the cases to be investigated for variety of roll amplitudes the first column frequencies the second column and bilge keel widths the third column figs 7 9 show the simulated time histories of hydrodynamic roll moment for various amplitudes frequencies and bilge keel widths respectively mark interval in these figures is 50 δ t from figs 7 and 8 we can see that increases of roll amplitude and frequency cause increase of roll moment but have little effect on phase of roll moment from fig 9 it can be seen that wider bilge keel causes roll moment larger but does not significantly change the phase of roll moment spikes and skew of roll moment history are observed which are symptoms of nonlinearity it is more remarkable for wider bilge keels the causes will be reflected in section 4 3 table 5 summarizes for all the cases roll damping coefficient and added mass moment of inertia they are plotted in figs 10 12 from fig 10 one can see that both roll damping and added mass moment of inertia increase with roll amplitude from fig 11 it can be seen that roll damping increase with roll frequency however added mass moment of inertia at first sensitively rises with frequency until a maximum value and then drops mildly from fig 12 obviously roll damping and added mass moment of inertia increase with bilge keel width 4 4 flow structures flow structures consist of velocity vorticity and dynamic pressure fields flow separation vortex generation shedding and movement and pressure variation are interwoven they are the essential physical causes which change hydrodynamic forces of the rolling ship this section enters into detail flow structures to try to uncover the mechanism of roll hydrodynamics behind the harmonic excited roll motions firstly look at dynamic pressure variation fig 13 displays variation of dynamic pressure distributions around the mid section over one roll circle in this case it rolls sinusoidally with amplitude ϕ 0 0 175 rad period t 1 0 s and width of bilge keels b 0 01 m fig 13 a shows pressure distribution at 0 9955s at this instant the mid section experiences almost a full roll cycle and it will go counter clockwise in large speed which means the flow around it flows in large speed we can see from the figure that negative pressure occurs near and behind bilge keels and pressure difference between two sides of each bilge keel is very large therefore bilge keels greatly contributes to the roll moment and a big negative roll moment is resulted fig 13 b corresponds to the instant of 1 1005s mid section enters into ten percent of the second roll cycle and roll speed decreases much which means the flow speed decreases the negative pressure fields now go away from ship bilges and pressure difference between two sides of each bilge keel is not significant this causes a neutral roll moment fig 13 c corresponds to the instant of 1 2498s mid section enters into a quarter of the second roll cycle and the roll motion will be changed from counter clockwise to clockwise and roll speed decrease to zero due to inertia of the flow sign of the pressure difference between two sides of each bilge keel is reversed and sign of roll moment is also altered fig 13 d corresponds to the instant of 1 4448s mid section enters into nearly half of the second roll cycle and the roll speed is very large and its sign is reversed so the flow velocity is very large the situation is quite the opposite of fig 13 a due to big pressure difference between two sides of each bilge keel it causes a big positive roll moment fig 13 e corresponds to the instant of 1 6382s mid section enters into nearly sixty percent of the second roll cycle and roll speed decreases much so flow velocity decreases too the negative pressure fields move away from the ship bilges this causes a nearly neutral roll moment fig 13 f corresponds to the instant of 1 8311s mid section enters into nearly eighty percent of the second roll cycle sign of roll speed is reversed again which causes the sign of roll moment alters fig 13 g corresponds to the instant of 1 9959s it experiences nearly two roll cycle the situation is the same of fig 13 a from above one can find that roll moment negatively correlated with the speed of flow near the mid section though time history of roll moment is calculated by both dynamic pressure and shear stress roll moment caused by dynamic pressure has a coincident variation with total roll moment as shown in fig 13 besides from these figures one can find that free surface changes little during ship rolling this explains that wave radiation has little effect on roll motion variations of vorticity and velocity are followed fig 14 displays vorticity contours and corresponding velocity vectors around the mid section over one roll circle to show the phenomena of flow separation vortex generation shedding and movement vorticity contours are on left side and velocity vectors right side the calculation conditions are set to be same as ones of variation of dynamic pressure distributions in fig 13 fig 14 a shows vorticity and velocity at 0 9955s at this instant the mid section rolls nearly a full cycle and it will go counter clockwise vortices now are all generated in the first roll cycle fig 14 b corresponds to the instant of 1 2498s mid section enters into a quarter of the second roll cycle and it reaches its maximum position size and strength of negative vortices become maximum besides vortices around the left bilge move to ship side and around right bilge moves to ship bottom then ship reverses to clockwise new positive vortices are generated while negative vortices shed from ship surface it can be observed that generation of new positive vortex begins at ship side near left bilge while at ship bottom near right bilge fig 14 c corresponds to the instant of 1 5046s mid section enters into half of the second roll cycle new positive vortices become stronger and negative ones weaken all vortices move against the roll motion fig 14 d corresponds to the instant of 1 7411s mid section enters into three quarters of the second roll cycle and it reaches its maximum position energy of the positive vortices becomes maximum and negative one minimum parts of vortices are diffused mid section reverses to counter clockwise generations of new negative vortices begin at the opposite locations of fig 14 b accompanied with the positive vortices shedding fig 14 e corresponds to the instant of 1 9959s mid section experiences almost two roll cycles the situation is quite the same of fig 14 a above phenomena summarize the phenomena of vortex generation shedding and movement it is observed that location of vortex generation is always ahead of ship rolling direction refer to fig 14 b d this is because that speed of flow near the mid section is larger than one of the mid section then flow separation occurs and then vortices generation phenomena appear besides direction of vortices movement is always opposite of one of ship rolling this is to damp out the roll motion besides with the generation of new vortices old vortices shed from ship surface see fig 14 b d this is due to the phenomenon of flow separation as elucidation before during the movement of vortices they diffuse then influences of roll amplitude and bilge keel on harmonic excited roll motion are investigated via flow structures firstly look at the roll amplitude effect fig 15 displays vorticity contours velocity vectors and dynamic pressures roughly at the instant t 2 t for ship fitted with no bilge keel rolling with various roll amplitudes a ϕ 0 0 087 rad b ϕ 0 0 131 rad c ϕ 0 0 175 rad dimensionless roll frequency is ω 0 952 it is observed that the strength and size of the vortices increase with roll amplitude for small amplitude previous vortices almost diffuse already and for large amplitude previous vortices are still strong besides dynamic pressure becomes large with the increase of roll amplitude since that the speed of flow near the mid section is closely related to roll amplitude and it negatively correlated with roll moment as mentioned before free surface has little change with roll amplitude it reveals that wave radiation has little contribution to roll hydrodynamic characteristics bilge keel effect is followed fig 16 displays vorticity contours velocity vectors and dynamic pressures roughly at the instant t 2 t for ship fitted with various bilge keel widths a b 0 b b 0 005 m c b 0 01 m d b 0 015 m rolling with amplitude ϕ 0 0 175 rad dimensionless roll frequency ω 0 952 it is shown that strength and size of the vortices increase with bilge keel width besides interaction between those vortices is strengthening which accords to their distances from each other thus when ship fits with wider bilge keel the energy which damps out roll motion is getting stronger besides dynamic pressure also increases with bilge keel width it is observed that the main differences of dynamic pressure distributions in these figures appear near and behind bilge keels it turns out that there are two parts damping caused by bilge keel to mitigate roll motion one is due to the variation of dynamic pressure distribution on ship surface which forms the added surface damping another is due to the pressure difference at two sides of bilge keels which forms bilge keel damping as before free surface changes little with bilge keel width proving that viscous effect is extremely important when ship fitted with bilge keels while contribution of wave radiation is small from figs 15 and 16 one can see that flow fields are more complex with increasing roll amplitude and bilge keel width and it causes the spiky and skew of time histories of roll motion in previous section 4 2 5 conclusions this work extends the previous work of zhang et al 2018 to simulate roll hydrodynamic characteristics through the harmonic excited roll motions a high order finite volume solver is applied to obtain flow solutions i e velocity and pressure of ns equations in a vof based wave tank a fourth order compact scheme as well as a fourth order runge kutta scheme discrete governing equations into algebraic forms and then a mim confirms pressure and velocity coupling besides a gcibm simulates the rolling ship the numerical solver turns out to be feasible after verification and validation investigations this work focuses on roll hydrodynamic characteristics accounting for the effects of roll amplitude frequency as well as bilge keel on the roll moment damping coefficient added mass moment of inertia vorticity contour velocity vector and dynamic pressure are carefully investigated the findings are as bellow 1 roll damping coefficient increases with roll amplitude frequency and bilge keel width added mass moment of inertia increases with roll amplitude and bilge keel width but increases firstly with roll amplitude then decreases spikes and skew of roll moment history are observed for ship fitted with bilge keels showing the nonlinearity these phenomena are explained through intricate pressure variation accompanying with the vortex generation shedding and movement 2 free surface changes little during ship rolling observed from flow fields displayed in this paper while vortices are complicated revealing that viscous effect is non negligible for roll motion and wave radiation effect is inconsequential 3 distribution of dynamic pressure is in accordance with roll moment to prevent roll motion and negatively correlated with the speed of flow near the rolling mid section location of vortex generation is always ahead of ship rolling direction due to the phenomenon of flow separation movement of vortex is to damp out roll motion parts of vortex diffuse along with its movement in addition shedding of vortex is accompanied with vortices generation due to flow separation besides strength of vortex and dynamic pressures increase with roll amplitude and bilge keel width interactions between vortices are strengthening with the increase of bilge keel width the mechanism of bilge keel to mitigate roll motion is the variation of the pressure distribution on ship surface and two sides of bilge keels and then forming added surface damping and bilge keel damping respectively acknowledgement this study is financially supported by the national project of the knowledge based ship design hyper integrated platform ii kship ii no zxzy019 
22856,nowadays in order to be competitive on the market it is fundamental to design optimized devices this is especially true in the oil gas sector where the product s weight has a material influence on all operations reducing this parameter implies a significant decrease in the project s cost this paper wants to propose an innovative approach to the study of the kinematic rotation of a prototype machine required to lay down an umbilical product needed for the distribution of electricity among platforms the aim of this paper is to resolve whether an optimization in terms of size and weight of the main piston that activates the chute rotation might be found and if so what might be the magnitude of the possible optimization the project has been carried out in collaboration with f lli righini a world wide leader in designing and manufacturing offshore equipment a comparison between analytical and actual components leads to a real design approach which can be used by other companies and research centers in the field keywords overboarding chute kinematic analysis weight optimization cost analysis offshore engineering list of acronyms pl piston length pf piston force ps piston stroke fc external constant force fv external variable force pw piston weight sf safety factor f g total structure mass elements i ii iii f u umbilical force f f g f u total external force ab distance between the fixed points of application of the beam and the piston l 2 chute length 1 introduction when an ocean communication cable is laying considerable care is usually exercised to ensure safety operation and the integrity of the product one form of apparatus for laying cables is an arrangement mounted on and supported by a floating vessel such as a barge such an apparatus is adapted for laying cables in both shallow and deep sea environment and in one embodiment has a guide means positioned in order to permit a cable to pass over an edge of the vessel and means arranged to support the cable during this operation jordan other installation aspects related to flexible risers and offshore umbilical systems can be found in the paper by johnston 1989 the mechanical behavior of flexible risers and engineering problems regarding such offshore components can be found in de sousa et al 2009 morandeau et al 2013 finally a recent review paper on pipelines risers and umbilicals features must be mentioned drumond et al 2018 where several references on these topics can found for extra reading on the subject the overboarding chute is a specific industrial equipment needed for offshore operations umbilical cable installation to ensure safe journey of the product between the vessel and the seabed the overboarding chute comes as an essential part of a horizontal lay spread chaudhuri 1993 in this paper it will be proposed a solution for the delivery of a 600 mm external diameter umbilical product asked for egina field project in nigeria more than 12 km of umbilical cables should be installed in a water depth up to 700 m in the studied case the client asked to have a cable that partially floats once it reaches the sea water consequently smaller umbilical deflections are expected and the catenary effect will be drastically reduced gueret and lahiri 2013 due to this peculiar request f lli righini proposed a prototype machine characterized by the rotation of an articulated parallelogram this machine even overcome the huge problem of the low umbilical flexibility the cable when laid or retrieved is laid under considerable tensile loads and when subject to bending this gave rise to stress concentrations particularly at the product junctions thanks to the rotation of the above embodiment there will be low risk of damage to umbilical due to very low effective friction and larger chute radius of curvature furthermore it will be explained how this system can even handle floating cable with presence of buoyancies modules saving the operation time and increasing the operators safety this work proposes a procedure to study from a mechanical point of view the stress distribution on this machine during the operation and the lay strategy that is devised for laying the umbilical in various water depths and current conditions special attention to the kinematics of this prototype will be considered by focusing on its possible weight reduction and executive product design 2 overboarding chute an umbilical is a cable that supplies required consumables to an apparatus it can provide air chemicals hydraulic power electric power and fiber optics between subsea equipment and a remote facility dhaigude et al 2018 umbilical systems provide the vital supply and control link from platforms or topside vessels to subsea oil and gas equipment electrical cables and hydraulic tubes are arranged in helical bundles and placed in successive layers depending on the design fig 1 a represents a typical umbilical product the umbilical is stored on a diameter deck basket at the stern of the vessel a level winder mounted on a lattice tower is used to ensure an optimal packing during the load out and to assist the umbilical unreeling during lay it is maintained at the level of the unwinding coil on the carousel at all times the lay system is made of an under bender roller chute to guide the umbilical into the tensioner see fig 1b and c entry aligner and a compensator placed in between these two elements to maintain the hold back tension at a desired threshold maximum value given by axial test this enables the umbilical tension to be sufficiently high to maintain the umbilical constantly wound around the carousel in fig 1d is showed a traditional chute as it can be seen it is completely fixed and its purpose is to only let the cable slip on it it can be noted that this simple chute could not satisfy the initial request by the client for this reason f lli righini suggested a new system that lay and simultaneously fix on the cable a number of buoyancies modules bms to avoid the collision of the massive bms against the vessel haul an innovative kinematic overboarding chute has been proposed the rotational solution ensures the integrity of the product during all its operational activities borgia a movable chute mounted on parallelogram kinematic structure moore and kendall 1980 is showed in fig 2 a the system is basically composed of a structure which supports two different chutes chute 1 is supported by two arms composing a parallelogram kinematic structure that allows to proceed with the lay operation preventing any contact of the bms against the outboard stationary chute 2 once the lay operation starts the axial force given by the piston red object in fig 2a pushes the whole structure that starts to rotate funaioli et al menghetti at the beginning the chute is in the stowed position fig 2b and the first buoy is fixed on the cable then the structure rotates reaching on angle of 37 fig 2c when the chute raises up figures 2d to 2f the product is safety delivered letting the buoy jump over the structure whereas with a traditional fixed chute the buoy would have been engaged by not allowing the lay operation therefore the movable chute 1 placed on a parallelogram kinematic structure allows to proceed with the lay operation preventing any contact of the bms to the outboard stationary chute 2 the buoyancy modules used for this project are shown in fig 3 a the overall bms dimensions are length 1 802 m outside diameter 2 265 m weight 1460 kg gap distance 13 5 m each singular bm is fixed half by half a small tool literally embraces the line with an hydraulic pressure then it will fit with the other half and they will be closed by an external mechanical force by computing the general buoyancy force given by archimede s principle the client will be always able to decide the under water depth position of the umbilical when the lay operation ends the product assumes the configuration shown in fig 3b having a partially floating cable gives many benefits the internal axial force is drastically reduced so the probability of damage even during transportation phase decreases furthermore when the lay project ends the client can be easily move the cable avoiding any other lay operations 3 mechanical model the aim of this paper is to study the overboarding chute mechanism from a kinematic point of view in order to demonstrate if a possible optimization in terms of weight reduction might be carried out a detailed analysis of the model is conducted by increasing the number of variables to get more accurate results by considering the peculiar geometry of an articulated parallelogram cylindrical members are considered to guarantee smooth operations during the bms deployment phases the whole system rotation is divided in several static steps in other words the whole kinematics is modeled as several static configurations in particular the study focuses on 6 particular configurations starting from an initial angle of 20 to a final angle of 105 of inclination of the chute the movement is activated by a piston force oil pressure constantly monitored by dedicated sensors this technology guarantees the maximum flexibility and an accurate control of cylinder stroke due to the huge weight that must be lifted f lli righini designed the proper hydraulic power unit hpu funaioli et al menghetti to deliver the needed amount of oil some technical information concerning the preliminary designed piston features are reported below cylinders stroke is around 7200 mm improvement if any to reduce the overall stroke will be finalized during detailed engineering design each cylinder capacity is 2500 kn at 250 bar enough to cover all working environmental loads cylinders are dimensioned with a working pressure of 320 bar test pressure of 415 bar cylinders are provided with counterbalance valves to guarantee safe operations the idea was given to primarily defined a model that clearly represent the real structure both the beam and the piston are considered as principle driven elements in other words they are responsible of the whole chute rotation russell and shenraj 2015 fig 4 a shows how the whole machine works and the reason why righini developed this technology the buoyancy module vii must be fixed on the cable during the lay operation to do that and to safety avoid the collision of those modules against the vessel or the structure itself elements ii iii iv play a fundamental role the operation is driven by piston i which will have to overcome the tensioner force vi in fig 4b furthermore a number of parameters useful to conduct the structural analysis have been defined in the model of fig 5 a the structure behavior is completely governed only by the configuration angle θ please refer to the given list of acronyms for model definitions the total external force f is considered vertical during the whole rotation and its magnitude does not change during the whole rotation to conduct the analysis a number of matlab codes have been used the main idea was to improve them by trying to get more accurate results the list of matlab codes is reported below code 1 1 dof it provides the pf code 2 2 dof considering fc it provides the piston length variation code 3 2 dof considering fc it provides the piston stroke trend code 4 2 dof considering fc it provides the pf trend code 5 2 dof considering fv it provides the pf trend code 6 2 dof considering fc it provides the pw with the dnv procedure code 7 2 dof considering fv it provides the pw with the dnv procedure main beam structural verification main beam forces diagram 3 1 single degree of freedom model 3 1 1 code 1 for the following model the piston force is computed by a constant vertical force that represents the force due to the umbilical on the carousel it is recalled that the configuration angle can take the values θ θ 0 20 θ 1 105 the following geometric definitions are given fig 5a 1 vertical cathetus c l 2 sin θ 2 horizontal cathetus d ab l 2 cos θ 3 piston length e c 2 d 2 4 angle α tan α c d the moment of the external force around hinge a is 5 m a v b ab f l 2 cos θ the piston force can be calculated with the following formula 6 f p v b sin α it is worth to note that the piston is subjected to a maximum compressive force in the first configuration as long as the rotation goes further it decreases furthermore it reaches a null value for θ 90 as expected when the chute rotation overcomes that value the piston starts pulling fig 5b 3 2 two degrees of freedom model in order to improve the accuracy of the design and to better understand the piston force behavior with respect to the point of application another variable has been introduced as shown in fig 6 a the latter shows how the piston force changes with respect to all possible configurations for the present case both θ and l 1 represent an input vector it is obvious that the level of accuracy can be increased by increasing the number of steps for each vector 3 2 1 code 2 in the following the piston length variation will be implemented this feature is a fundamental parameter for a proper piston design the total weight of a piston is mainly given by the cylinder and rod element dimensions joseph edward shigley and ki 1969 due to the direct relation between weight and cost to design a competitive piston it is strongly advised to define the optimal piston points of application fig 6b shows the piston length variation with respect to both θ and l 1 variables the other input data have been kept the same as the previous case as expected the whole piston length variation increases as l 1 increases thus the two degrees of freedom are defined by θ θ 0 θ 1 l 1 l 11 l 12 and the piston length can be carried out by the classical pythagorean theorem 7 l p l 1 sin θ 2 a b l 1 cos θ 2 3 2 2 code 3 the stroke length is the distance travelled by the piston in each cycle legnani et al 2016 this fundamental parameter generally influences the whole piston size fig 7 a with the same input data all the combinations where a rod length is lower than the cylinder one are considered the piston stroke can be computed with a formula similar to eq 7 8 l i l 1 sin θ 0 2 a b l 1 cos θ 0 2 the actual stroke length for each configuration corresponds to the last value θ 105 3 2 3 code 4 by computing the moment equilibrium equation of the external forces around the fixed hinge a a mathematical procedure has been developed in order to correlate the piston force to both θ and l 1 the chute rotation is modeled as the sum of infinite configurations where each of them has been considered statically fig 7b shows that when l 1 increases the required absolute value of the piston force decreases niemann and winter 1983 in this case two different discretization numbers have been considered to optimize singularly the two variables the two degrees of freedom are defined as θ θ 0 θ 1 l 1 l 11 l 12 and the moment of external force around hinge a is computed as 9 m a 0 v b f ab l 2 cos θ f p v b sin α and the piston force computation is given by 10 l 1 sin α sin α cos α ab l 1 cos θ 11 f p v b a l 1 cos θ l 1 sin θ cos α 3 2 4 code 5 in the following the assumption of considering a constant external force in module and direction is removed by analyzing the studied configurations depitected in fig 8 a and 8f some geometrical data have been extracted in order to compute the external force resultant at each step later on a polynomial function that best fits those points has been found finally the obtained function has been implemented to get a piston force as a function of both θ and l 1 caligaris et al 2016 as it can be seen from table 1 some useful relations among the measured angles can be found during the whole rotation as expected the winding angle increases and the tangential vector decreases fig 9 a tension forces given by cabestano procedure de menna 1998 have been detailed by timoshenko as 12 t u t r exp α max μ 13 t i t r exp α μ t u exp α max μ exp α μ t u exp α α m a x μ i f α α max t i t u i f α 0 t i t u exp α max μ 14 t r t u exp α max μ once t u and t r are known and even the γ angle between them the umbilical resultant can be calculated as follows 15 u r t u 2 t r 2 2 t u t r cos γ the moment of external forces around the hinge a is given by 16 m a f ytot l 2 cos θ f x umb l 2 sin θ ab 0 and the computation of the umbilical resultant components leads to 17 f y u m b f u m b cos β 18 f x u m b f u m b sin β 19 f y t o t f y u m b f g where β is indicated in fig 9a to get the umbilical tension at the extreme points an input data must be given in this case the client asked to have a maximum of 1200 kn of pooling at the launch it means that by setting the tension t u the force t r can be calculated fig 9a once the two components are known the umbilical resultant force u r can be found the umbilical force is calculated by finding the mathematical function that best fit to a series of data set a polynomial function always taking the lowest possible degree the third one in this case has been implemented to approximate the trend of those considered points once the external force function is carried out the procedure to compute the piston force is the same as already shown in code 4 in other words instead of considering a constant vertical force it will be necessary to consider both components f x u m b and f y t o t the external reaction v b has been computed by imposing the equilibrium of the bending moment about hinge a finally the piston force variation with respect to both variables can be represented as depicted in fig 9b 3 2 5 code 6 one of the main driven parameters of the present modeling is the piston weight as for many others structures this parameter can affect all the operations it should be noted that even the price strictly depends on it by analyzing how the piston weight changes with respect to θ and l 1 it is possible to find the most convenient configuration the first procedure followed in this case will be the one that starts from the cylinder pushing verification suggested from the dnv standard for hydraulic cylinders dnv 2017 the cylinder area is computed as the ratio between the known maximum compressive force and the imposed internal oil pressure as 20 a r e a c f max p max d int 2 a r e a c π t p max d int 2 σ s d e x t d int 2 t thus the cylinder moment of inertia can be carried out as 21 i 1 π 64 d e x t 4 d int 4 as it is declared in the aforementioned certification the buckling load can be computed as 22 p e 4 f max a parameter is than given by the dnv regulation to compute the rod moment of inertia i 2 23 z l 1 i 1 l 2 i 2 1 i 2 1 i 1 l 2 π sin 2 π l 1 l 24 i 2 l 2 l 2 π sin 2 π l 1 l z 1 i 1 l 1 l 2 π sin 2 π l 1 l where 25 z π 2 e p e l f i n finally the rod diameter is calculated as 26 d e x t 64 π i 2 1 4 and its weight 27 c w π 4 d e x t 2 d int 2 l i n i z s w analogously the weight of the other elements is computed the procedure to get the piston force necessary to proper design the whole piston elements is the one already shown above it is remarked that in this first part not allowable combinations in terms of stroke are rejected in fact only configurations with a rod length lower than the cylinder one are allowed to compute the external diameter of the cylinder the hoop stress relation has been taken into account timoshenko and goodier 1970 when an internal pressure is applied on a portion of cylinder of length δ l a stress reaction σ 1 occurs on the cylinder edge as 28 a 2 r δ l f p 2 r δ l a 2 t δ l f σ 1 2 t δ l σ 1 p r t t p max d int 2 σ s in the previous paragraph the dnv no 2 9 procedure to verify the buckling phenomena for piston element has been presented a dedicated trend of the obtained rod moment of inertia is represented in fig 10 a depending on the number of steps n it should be noted that a particular behavior can be observed it seems that for some particular combinations of i 2 assume negative values however negative moment of inertias are not physically feasable thus they are neglected during the optimization due to the lack of empirical procedures to compute each element length composing the whole piston an analytical approach based on commercial pistons has been followed the internal diameter of some commercial pistons has been considered and an average ratio between that value and the component length has been found and reported in table 2 the piston must be verified even for the pooling phase after 90 even if this does not occur in the real case of studying e g when the applied force is variable in order to have a general analytical model the pooling verification has been implemented the area present in the cylinder head zone must be enough to support any further traction force from eq 20 for a given force and a maximum acceptable internal oil pressure data input a certain supporting area is required the configurations that will not satisfy this requirement will be rejected after having skimmed all the possible combinations with the three checks it may happen that no solution is found in that case a second procedure is proposed that starts from the verification of the cylinder head see fig 7a and once the required internal diameter is found the buckling phenomena is verified it is obvious that if no traction force occurs the solution is found with the first procedure fig 10b reports both results carried out with the two procedures even if it has been imposed as input data 1 m l 1 5 m it seems that for the given ab l 1 2 5 m this is due to both geometrical reasons many configuration have been removed from the stroke verification and physical reasons combinations with i 2 0 have been eliminated on the other hand the blue trend has overcome even for the pooling verification it can be stated that by using the second procedure a much better result is achieved by fixing the piston at 3 m on the chute more than 1200 kg are saved 3 2 6 code 7 following the dnv no 2 9 procedure the computed variable external force will be implemented obtaining the real piston weight that it would be necessary for each configuration combinations of l 1 and θ values in this way more reliable values of piston weight can be carried out the variable force model is closer to the real force present on the carousel from a practical point of view the following implementation is a merge of the previous applications therefore it will not be shown in detail fig 11 a shows that the present piston weight computed with a variable force is higher than the one obtained with the constant external force even though 1 m l 1 5 m the possible piston point of application stands between 1 6 m and 3 6 m this means that all the other combinations have been neglected for geometrical reasons stroke verification or because they were extreme e g l 1 l 0 6 combinations for which the rod moment of inertia computed by the dnv regulation were negative 4 structural verification all the considered configurations given by the l 1 and θ combinations must be now verified from a structural point of view belluzzi 1982 in fact due to the different results obtained before declaring the best configuration a beam structural verification must be conducted in fact the smaller l 1 the bigger will be the required beam cross section to support the higher shear force for this reason for all possible combinations the piston effect on the chute will be analyzed to figure out whether it is possible to design a smaller cross section a detailed structural design will be developed to verify the cross section under the bending moment shear and axial forces it is worth to note that the main driven parameter of all this modeling is the total system weight piston beam basement finding the lightest configuration means to have found also the cheapest solution referring to the previous fig 11b the following angle relations are given 29 ω 1 π 2 α ω 2 ω ω 1 π 2 θ ω 3 π ω 2 the external force reactions are equal to 30 h a h b f u m b 31 v a f y t o t v b and the piston components acting on the chute correspond to 32 f p x f p cos ω 3 33 f p y f p sin ω 3 by considering a relative reference system located on the chute all forces acting on the beam have been divided into their two components getting the following relations h a x h a cos θ h a y h a sin θ v a x v a sin θ v a y v a cos θ f v x f y sin θ f v y f y cos θ f h x f u m b cos θ f h y f u m b sin θ referring to the classical reference system of a beam the bending moment around the piston point of application can be computed as 34 v a y l 1 h a y l 1 f h y l 2 l 1 f v y l 2 l 1 once the shear forces 34 are known the bending moment diagram can be carried out 35 m x h a y x v a y x 0 x l 1 m x h a y l 1 v a y l 1 f p y x l 1 l 1 x l 2 similarly the shear force is given by 36 t x h a y v a y 0 x l 1 t x h a y v a y f p y l 1 x l 2 and the axial force 37 v a x h a x f p x 0 x l 1 f v x f h x l 1 x l 2 the bending moment diagrams are depicted in fig 12 a as it can be seen the bending moment is always negative the lower fibers are stretched fenner and reddy 2012 the plot is bi linear due to the concentrated force of the piston and it reaches maximum values for small l 1 values as expected the shear diagrams are depicted in fig 12b the beam is initially subjected to a negative shear force and after the piston point of applications it becomes positive finally the axial force is displayed in fig 12c the beam is always subjected to a compressive force mainly given by the umbilical as expected furthermore large forces are achieved for small l 1 values 4 1 cross section design once the internal forces diagrams are drawn their maximum values can be found in order to design the required cross section in the worst case for each l 1 value fig 13 a the beam is subjected to a huge shear force due to the piston force and for this reason the design flexure criteria ziemian 2010 selected has been the one that first impose a certain maximum beam deflection f input data the required beam moment of inertia can be then computed by 38 f f py max a 2 b 2 3 e i l 39 i x x f p y max l 1 2 l 2 l 1 2 3 e l 2 2 f once the required moment of inertia is computed for each configuration the axial stress verification is developed for this system the total axial stress acting on the beam cross section is given by the sum of two contributions one flexural and one axial 40 σ n σ f σ a m f w n a where 41 w i x x h 2 eq 40 corresponds to the so called navier stress from this criteria the following equation must be verified 42 σ n σ v m σ y sf both the yielding stress σ y and the safety factor sf can be selected by the user as input data finally a shear verification must be developed 43 τ τ f σ y 3 sf where 44 τ f χ v a y a by definition the beam is made of a hollow rectangular cross section fig 13b defined in such a way that width and height are a function of the thickness as 45 w i d t h h e i g h t 2 t h i c k n e s s w i d t h 10 thus the structural optimization is simplified from a 3 parameters problem to one to a single parameter one the idea is to find for each configuration a rectangular cross section that fits with the required moment of inertia i given by eq 39 an iterative approach based on the bi section method is used in the code firstly an attempted height vector is defined if the procedure does not give any result an input modification must be considered fig 13c describes the cross section heights with respect to l 1 variation once the geometric dimension has been found the section area is calculated it should be recalled that the cross section has been verified under axial shear and bending moment 4 2 total weight and cost optimization once the cross sections is verified the whole system weight base piston main beam for all configurations can be computed at this stage it is important to study the influence of the length ab on the system total weight fig 17a ab assumes the following values 8 10 12 and 14 m the red star reported in the figure corresponds to the result obtained from f lli righini with ab 13 344 m it seems that the whole system weight can be reduced by fixing the piston lower than 5 m in particularly by setting ab 10 m the lightest configuration can be reached black star on the other hand for ab 10 m a larger weight is reached green curve because the axial force needed to push the whole system increases and a bigger piston is required before resuming the whole analysis an economical aspect must be taken into account fig 17b shows the total cost of the system for all configurations cost analysis is based on some indicative prices for each element considered as listed in table 3 it seems that it would be more convenient to reduce the ab value from the initial 13 344 m 10 m the blue curve reaches the lowest cost as already explained reducing further the ab value would mean to have a heavier and more expensive system especially given by the massive piston dimension in the following section the optimized configuration l 1 3 939 m and ab 10 m will be drawn to check if it is actually achievable if it will be the total system cost will be reduced from the actual 223 100 to 206 500 roughly saving 16 600 saving 7 44 5 discussion a remarkable solution has been carried out it seems that by fixing the piston at a lower l 1 distance with respect to the actual 5 046 m a good improvement in terms of both weight and cost can be achieved this theoretical result will be now verified from a practical point of view in fact the considered model did not take into account the actual physical dimension of each element and for this reason the optimized configuration will be now drawn to check if it is actually feasible a detailed comparison with the proposal made by f lli righini technical office will be carried out to evaluate if the optimized configuration can be physically realized 5 1 theoretical comparison a theoretical comparison the piston has been modeled with a line between the optimized configuration and the predesigned one will be now conducted the more interesting results are the ones related to ab 10 m and ab 12 m as depicted in fig 14 a and b 5 2 configuration with ab 10 m the optimized piston dimension see table 4 is now compared with the one obtained during the preliminary design see fig 14a by decreasing the ab distance from 13 344 m to 10 m and by decreasing l 1 from 5 046 m to the optimal 3 939 m a smaller piston can be designed 5 3 configuration with ab 12 m the second optimized configuration is now reported see fig 14b in the reported case the piston length is 7 412 m see tables 4 6 with ab 12 m and a l 1 4 918 m 5 4 feasible comparison in the last section the optimized solution has been shown from a theoretical point of view in fact no piston dimensions have been drawn so it cannot be stated that those solutions are actually achievable to do that the real dimension of all piston elements cylinder rod and even both extreme hinges will be now taken into account as it has been previously explained one of the main piston verification during the design phase is the stroke one it is mandatory to design a piston which has a rod length lower than the cylinder one furthermore the obstruction of both hinges at the extreme points must be considered because their presence can affect the whole piston stroke the two proposed solutions have been compared in the first and last positions for θ 20 and θ 105 5 5 configuration with ab 10 m as it can be seen from fig 15 the optimized configuration for ab 10 m is not feasible in fact due to the large beam width 850 mm and to the element piston dimension this configuration cannot be realized fig 15b nevertheless for the sake of conciseness the final configuration is displayed in fig 15c as it can be seen the piston would be able to perform the final rotation but it cannot be used with the input data of 20 as starting angle 5 6 configuration with ab 12 m following the same procedure as shown above the following data have been obtained the piston length dimensions have been calculated and listed in tables 4 6 having a larger l 1 means to have a smaller cross section fig 13c this optimized configuration fits well with the whole system dimensions the optimized piston can effectively perform the whole rotation the ab distance is reduced from the predesigned 13 344 m to the obtained 12 m as well as the l 1 passes from 5 046 m to 4 918 m see fig 16 reducing the whole piston length of 1 184 m 8 596 m 7 412 m even the weight decreases from the predesigned 7643 kg to 7043 kg saving 600 kg which roughly correspond to 7200 5 7 safety factor to final check the obtained piston a further verification has been carried out by knowing the maximum compressive force at which the piston will be subjected it corresponds to the stowed position and by calculating its real capacity with the obtained piston dimension a safety factor will be computed taking the same allowable oil pressure of 25 mpa the piston capacity is 46 f p p max a 25 π d int 2 4 4 206 kn 426 5 t the maximum external forces acting on the chute have been considered they correspond to the stowed configuration the bending moment can be calculated as 47 m a f v y l 2 f h y l 2 f p l 1 cos 57 finally the external acting force is 48 f a c t i n g 796 920 13 7 350 13 0 54 4 918 n 393 9 t finally the piston safety factor is 49 s f f p f a c t i n g 1 08 with an 8 of positive margin the optimized piston fully satisfies the required task always verifying the mechanical and structural requirements dictated by the dnv regulation 5 8 overall optimization in fig 17 the total optimized system weight black star is compared with the predesigned one red star it can be seen that the total system cost has been reduced of roughly 12 500 223 100 210 600 saving 5 93 table 7 shows the percentage of weight and cost that have been saved by finding the optimized configuration 6 conclusions the procedure presented in this paper can be applied for any further parallelogram mechanisms in fact by simply changing the data input the user will be able to optimize mechanical systems that are represented by the same technology both the mechanical and structural point of views of the kinematic chute have been considered finding out the best system configuration furthermore a huge limitation concerning the buckling for piston with respect to the dnv regulation has been highlighted this issue has been demonstrated and it complete mathematical description will be developed in a future paper acknowledgments the authors acknowledge fondazione flaminia ravenna italy for supporting the present research the first two authors acknowledge f lli righini for providing data photos and information regarding the present study appendix a supplementary data the following is the supplementary data to this article data profile data profile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 004 
22856,nowadays in order to be competitive on the market it is fundamental to design optimized devices this is especially true in the oil gas sector where the product s weight has a material influence on all operations reducing this parameter implies a significant decrease in the project s cost this paper wants to propose an innovative approach to the study of the kinematic rotation of a prototype machine required to lay down an umbilical product needed for the distribution of electricity among platforms the aim of this paper is to resolve whether an optimization in terms of size and weight of the main piston that activates the chute rotation might be found and if so what might be the magnitude of the possible optimization the project has been carried out in collaboration with f lli righini a world wide leader in designing and manufacturing offshore equipment a comparison between analytical and actual components leads to a real design approach which can be used by other companies and research centers in the field keywords overboarding chute kinematic analysis weight optimization cost analysis offshore engineering list of acronyms pl piston length pf piston force ps piston stroke fc external constant force fv external variable force pw piston weight sf safety factor f g total structure mass elements i ii iii f u umbilical force f f g f u total external force ab distance between the fixed points of application of the beam and the piston l 2 chute length 1 introduction when an ocean communication cable is laying considerable care is usually exercised to ensure safety operation and the integrity of the product one form of apparatus for laying cables is an arrangement mounted on and supported by a floating vessel such as a barge such an apparatus is adapted for laying cables in both shallow and deep sea environment and in one embodiment has a guide means positioned in order to permit a cable to pass over an edge of the vessel and means arranged to support the cable during this operation jordan other installation aspects related to flexible risers and offshore umbilical systems can be found in the paper by johnston 1989 the mechanical behavior of flexible risers and engineering problems regarding such offshore components can be found in de sousa et al 2009 morandeau et al 2013 finally a recent review paper on pipelines risers and umbilicals features must be mentioned drumond et al 2018 where several references on these topics can found for extra reading on the subject the overboarding chute is a specific industrial equipment needed for offshore operations umbilical cable installation to ensure safe journey of the product between the vessel and the seabed the overboarding chute comes as an essential part of a horizontal lay spread chaudhuri 1993 in this paper it will be proposed a solution for the delivery of a 600 mm external diameter umbilical product asked for egina field project in nigeria more than 12 km of umbilical cables should be installed in a water depth up to 700 m in the studied case the client asked to have a cable that partially floats once it reaches the sea water consequently smaller umbilical deflections are expected and the catenary effect will be drastically reduced gueret and lahiri 2013 due to this peculiar request f lli righini proposed a prototype machine characterized by the rotation of an articulated parallelogram this machine even overcome the huge problem of the low umbilical flexibility the cable when laid or retrieved is laid under considerable tensile loads and when subject to bending this gave rise to stress concentrations particularly at the product junctions thanks to the rotation of the above embodiment there will be low risk of damage to umbilical due to very low effective friction and larger chute radius of curvature furthermore it will be explained how this system can even handle floating cable with presence of buoyancies modules saving the operation time and increasing the operators safety this work proposes a procedure to study from a mechanical point of view the stress distribution on this machine during the operation and the lay strategy that is devised for laying the umbilical in various water depths and current conditions special attention to the kinematics of this prototype will be considered by focusing on its possible weight reduction and executive product design 2 overboarding chute an umbilical is a cable that supplies required consumables to an apparatus it can provide air chemicals hydraulic power electric power and fiber optics between subsea equipment and a remote facility dhaigude et al 2018 umbilical systems provide the vital supply and control link from platforms or topside vessels to subsea oil and gas equipment electrical cables and hydraulic tubes are arranged in helical bundles and placed in successive layers depending on the design fig 1 a represents a typical umbilical product the umbilical is stored on a diameter deck basket at the stern of the vessel a level winder mounted on a lattice tower is used to ensure an optimal packing during the load out and to assist the umbilical unreeling during lay it is maintained at the level of the unwinding coil on the carousel at all times the lay system is made of an under bender roller chute to guide the umbilical into the tensioner see fig 1b and c entry aligner and a compensator placed in between these two elements to maintain the hold back tension at a desired threshold maximum value given by axial test this enables the umbilical tension to be sufficiently high to maintain the umbilical constantly wound around the carousel in fig 1d is showed a traditional chute as it can be seen it is completely fixed and its purpose is to only let the cable slip on it it can be noted that this simple chute could not satisfy the initial request by the client for this reason f lli righini suggested a new system that lay and simultaneously fix on the cable a number of buoyancies modules bms to avoid the collision of the massive bms against the vessel haul an innovative kinematic overboarding chute has been proposed the rotational solution ensures the integrity of the product during all its operational activities borgia a movable chute mounted on parallelogram kinematic structure moore and kendall 1980 is showed in fig 2 a the system is basically composed of a structure which supports two different chutes chute 1 is supported by two arms composing a parallelogram kinematic structure that allows to proceed with the lay operation preventing any contact of the bms against the outboard stationary chute 2 once the lay operation starts the axial force given by the piston red object in fig 2a pushes the whole structure that starts to rotate funaioli et al menghetti at the beginning the chute is in the stowed position fig 2b and the first buoy is fixed on the cable then the structure rotates reaching on angle of 37 fig 2c when the chute raises up figures 2d to 2f the product is safety delivered letting the buoy jump over the structure whereas with a traditional fixed chute the buoy would have been engaged by not allowing the lay operation therefore the movable chute 1 placed on a parallelogram kinematic structure allows to proceed with the lay operation preventing any contact of the bms to the outboard stationary chute 2 the buoyancy modules used for this project are shown in fig 3 a the overall bms dimensions are length 1 802 m outside diameter 2 265 m weight 1460 kg gap distance 13 5 m each singular bm is fixed half by half a small tool literally embraces the line with an hydraulic pressure then it will fit with the other half and they will be closed by an external mechanical force by computing the general buoyancy force given by archimede s principle the client will be always able to decide the under water depth position of the umbilical when the lay operation ends the product assumes the configuration shown in fig 3b having a partially floating cable gives many benefits the internal axial force is drastically reduced so the probability of damage even during transportation phase decreases furthermore when the lay project ends the client can be easily move the cable avoiding any other lay operations 3 mechanical model the aim of this paper is to study the overboarding chute mechanism from a kinematic point of view in order to demonstrate if a possible optimization in terms of weight reduction might be carried out a detailed analysis of the model is conducted by increasing the number of variables to get more accurate results by considering the peculiar geometry of an articulated parallelogram cylindrical members are considered to guarantee smooth operations during the bms deployment phases the whole system rotation is divided in several static steps in other words the whole kinematics is modeled as several static configurations in particular the study focuses on 6 particular configurations starting from an initial angle of 20 to a final angle of 105 of inclination of the chute the movement is activated by a piston force oil pressure constantly monitored by dedicated sensors this technology guarantees the maximum flexibility and an accurate control of cylinder stroke due to the huge weight that must be lifted f lli righini designed the proper hydraulic power unit hpu funaioli et al menghetti to deliver the needed amount of oil some technical information concerning the preliminary designed piston features are reported below cylinders stroke is around 7200 mm improvement if any to reduce the overall stroke will be finalized during detailed engineering design each cylinder capacity is 2500 kn at 250 bar enough to cover all working environmental loads cylinders are dimensioned with a working pressure of 320 bar test pressure of 415 bar cylinders are provided with counterbalance valves to guarantee safe operations the idea was given to primarily defined a model that clearly represent the real structure both the beam and the piston are considered as principle driven elements in other words they are responsible of the whole chute rotation russell and shenraj 2015 fig 4 a shows how the whole machine works and the reason why righini developed this technology the buoyancy module vii must be fixed on the cable during the lay operation to do that and to safety avoid the collision of those modules against the vessel or the structure itself elements ii iii iv play a fundamental role the operation is driven by piston i which will have to overcome the tensioner force vi in fig 4b furthermore a number of parameters useful to conduct the structural analysis have been defined in the model of fig 5 a the structure behavior is completely governed only by the configuration angle θ please refer to the given list of acronyms for model definitions the total external force f is considered vertical during the whole rotation and its magnitude does not change during the whole rotation to conduct the analysis a number of matlab codes have been used the main idea was to improve them by trying to get more accurate results the list of matlab codes is reported below code 1 1 dof it provides the pf code 2 2 dof considering fc it provides the piston length variation code 3 2 dof considering fc it provides the piston stroke trend code 4 2 dof considering fc it provides the pf trend code 5 2 dof considering fv it provides the pf trend code 6 2 dof considering fc it provides the pw with the dnv procedure code 7 2 dof considering fv it provides the pw with the dnv procedure main beam structural verification main beam forces diagram 3 1 single degree of freedom model 3 1 1 code 1 for the following model the piston force is computed by a constant vertical force that represents the force due to the umbilical on the carousel it is recalled that the configuration angle can take the values θ θ 0 20 θ 1 105 the following geometric definitions are given fig 5a 1 vertical cathetus c l 2 sin θ 2 horizontal cathetus d ab l 2 cos θ 3 piston length e c 2 d 2 4 angle α tan α c d the moment of the external force around hinge a is 5 m a v b ab f l 2 cos θ the piston force can be calculated with the following formula 6 f p v b sin α it is worth to note that the piston is subjected to a maximum compressive force in the first configuration as long as the rotation goes further it decreases furthermore it reaches a null value for θ 90 as expected when the chute rotation overcomes that value the piston starts pulling fig 5b 3 2 two degrees of freedom model in order to improve the accuracy of the design and to better understand the piston force behavior with respect to the point of application another variable has been introduced as shown in fig 6 a the latter shows how the piston force changes with respect to all possible configurations for the present case both θ and l 1 represent an input vector it is obvious that the level of accuracy can be increased by increasing the number of steps for each vector 3 2 1 code 2 in the following the piston length variation will be implemented this feature is a fundamental parameter for a proper piston design the total weight of a piston is mainly given by the cylinder and rod element dimensions joseph edward shigley and ki 1969 due to the direct relation between weight and cost to design a competitive piston it is strongly advised to define the optimal piston points of application fig 6b shows the piston length variation with respect to both θ and l 1 variables the other input data have been kept the same as the previous case as expected the whole piston length variation increases as l 1 increases thus the two degrees of freedom are defined by θ θ 0 θ 1 l 1 l 11 l 12 and the piston length can be carried out by the classical pythagorean theorem 7 l p l 1 sin θ 2 a b l 1 cos θ 2 3 2 2 code 3 the stroke length is the distance travelled by the piston in each cycle legnani et al 2016 this fundamental parameter generally influences the whole piston size fig 7 a with the same input data all the combinations where a rod length is lower than the cylinder one are considered the piston stroke can be computed with a formula similar to eq 7 8 l i l 1 sin θ 0 2 a b l 1 cos θ 0 2 the actual stroke length for each configuration corresponds to the last value θ 105 3 2 3 code 4 by computing the moment equilibrium equation of the external forces around the fixed hinge a a mathematical procedure has been developed in order to correlate the piston force to both θ and l 1 the chute rotation is modeled as the sum of infinite configurations where each of them has been considered statically fig 7b shows that when l 1 increases the required absolute value of the piston force decreases niemann and winter 1983 in this case two different discretization numbers have been considered to optimize singularly the two variables the two degrees of freedom are defined as θ θ 0 θ 1 l 1 l 11 l 12 and the moment of external force around hinge a is computed as 9 m a 0 v b f ab l 2 cos θ f p v b sin α and the piston force computation is given by 10 l 1 sin α sin α cos α ab l 1 cos θ 11 f p v b a l 1 cos θ l 1 sin θ cos α 3 2 4 code 5 in the following the assumption of considering a constant external force in module and direction is removed by analyzing the studied configurations depitected in fig 8 a and 8f some geometrical data have been extracted in order to compute the external force resultant at each step later on a polynomial function that best fits those points has been found finally the obtained function has been implemented to get a piston force as a function of both θ and l 1 caligaris et al 2016 as it can be seen from table 1 some useful relations among the measured angles can be found during the whole rotation as expected the winding angle increases and the tangential vector decreases fig 9 a tension forces given by cabestano procedure de menna 1998 have been detailed by timoshenko as 12 t u t r exp α max μ 13 t i t r exp α μ t u exp α max μ exp α μ t u exp α α m a x μ i f α α max t i t u i f α 0 t i t u exp α max μ 14 t r t u exp α max μ once t u and t r are known and even the γ angle between them the umbilical resultant can be calculated as follows 15 u r t u 2 t r 2 2 t u t r cos γ the moment of external forces around the hinge a is given by 16 m a f ytot l 2 cos θ f x umb l 2 sin θ ab 0 and the computation of the umbilical resultant components leads to 17 f y u m b f u m b cos β 18 f x u m b f u m b sin β 19 f y t o t f y u m b f g where β is indicated in fig 9a to get the umbilical tension at the extreme points an input data must be given in this case the client asked to have a maximum of 1200 kn of pooling at the launch it means that by setting the tension t u the force t r can be calculated fig 9a once the two components are known the umbilical resultant force u r can be found the umbilical force is calculated by finding the mathematical function that best fit to a series of data set a polynomial function always taking the lowest possible degree the third one in this case has been implemented to approximate the trend of those considered points once the external force function is carried out the procedure to compute the piston force is the same as already shown in code 4 in other words instead of considering a constant vertical force it will be necessary to consider both components f x u m b and f y t o t the external reaction v b has been computed by imposing the equilibrium of the bending moment about hinge a finally the piston force variation with respect to both variables can be represented as depicted in fig 9b 3 2 5 code 6 one of the main driven parameters of the present modeling is the piston weight as for many others structures this parameter can affect all the operations it should be noted that even the price strictly depends on it by analyzing how the piston weight changes with respect to θ and l 1 it is possible to find the most convenient configuration the first procedure followed in this case will be the one that starts from the cylinder pushing verification suggested from the dnv standard for hydraulic cylinders dnv 2017 the cylinder area is computed as the ratio between the known maximum compressive force and the imposed internal oil pressure as 20 a r e a c f max p max d int 2 a r e a c π t p max d int 2 σ s d e x t d int 2 t thus the cylinder moment of inertia can be carried out as 21 i 1 π 64 d e x t 4 d int 4 as it is declared in the aforementioned certification the buckling load can be computed as 22 p e 4 f max a parameter is than given by the dnv regulation to compute the rod moment of inertia i 2 23 z l 1 i 1 l 2 i 2 1 i 2 1 i 1 l 2 π sin 2 π l 1 l 24 i 2 l 2 l 2 π sin 2 π l 1 l z 1 i 1 l 1 l 2 π sin 2 π l 1 l where 25 z π 2 e p e l f i n finally the rod diameter is calculated as 26 d e x t 64 π i 2 1 4 and its weight 27 c w π 4 d e x t 2 d int 2 l i n i z s w analogously the weight of the other elements is computed the procedure to get the piston force necessary to proper design the whole piston elements is the one already shown above it is remarked that in this first part not allowable combinations in terms of stroke are rejected in fact only configurations with a rod length lower than the cylinder one are allowed to compute the external diameter of the cylinder the hoop stress relation has been taken into account timoshenko and goodier 1970 when an internal pressure is applied on a portion of cylinder of length δ l a stress reaction σ 1 occurs on the cylinder edge as 28 a 2 r δ l f p 2 r δ l a 2 t δ l f σ 1 2 t δ l σ 1 p r t t p max d int 2 σ s in the previous paragraph the dnv no 2 9 procedure to verify the buckling phenomena for piston element has been presented a dedicated trend of the obtained rod moment of inertia is represented in fig 10 a depending on the number of steps n it should be noted that a particular behavior can be observed it seems that for some particular combinations of i 2 assume negative values however negative moment of inertias are not physically feasable thus they are neglected during the optimization due to the lack of empirical procedures to compute each element length composing the whole piston an analytical approach based on commercial pistons has been followed the internal diameter of some commercial pistons has been considered and an average ratio between that value and the component length has been found and reported in table 2 the piston must be verified even for the pooling phase after 90 even if this does not occur in the real case of studying e g when the applied force is variable in order to have a general analytical model the pooling verification has been implemented the area present in the cylinder head zone must be enough to support any further traction force from eq 20 for a given force and a maximum acceptable internal oil pressure data input a certain supporting area is required the configurations that will not satisfy this requirement will be rejected after having skimmed all the possible combinations with the three checks it may happen that no solution is found in that case a second procedure is proposed that starts from the verification of the cylinder head see fig 7a and once the required internal diameter is found the buckling phenomena is verified it is obvious that if no traction force occurs the solution is found with the first procedure fig 10b reports both results carried out with the two procedures even if it has been imposed as input data 1 m l 1 5 m it seems that for the given ab l 1 2 5 m this is due to both geometrical reasons many configuration have been removed from the stroke verification and physical reasons combinations with i 2 0 have been eliminated on the other hand the blue trend has overcome even for the pooling verification it can be stated that by using the second procedure a much better result is achieved by fixing the piston at 3 m on the chute more than 1200 kg are saved 3 2 6 code 7 following the dnv no 2 9 procedure the computed variable external force will be implemented obtaining the real piston weight that it would be necessary for each configuration combinations of l 1 and θ values in this way more reliable values of piston weight can be carried out the variable force model is closer to the real force present on the carousel from a practical point of view the following implementation is a merge of the previous applications therefore it will not be shown in detail fig 11 a shows that the present piston weight computed with a variable force is higher than the one obtained with the constant external force even though 1 m l 1 5 m the possible piston point of application stands between 1 6 m and 3 6 m this means that all the other combinations have been neglected for geometrical reasons stroke verification or because they were extreme e g l 1 l 0 6 combinations for which the rod moment of inertia computed by the dnv regulation were negative 4 structural verification all the considered configurations given by the l 1 and θ combinations must be now verified from a structural point of view belluzzi 1982 in fact due to the different results obtained before declaring the best configuration a beam structural verification must be conducted in fact the smaller l 1 the bigger will be the required beam cross section to support the higher shear force for this reason for all possible combinations the piston effect on the chute will be analyzed to figure out whether it is possible to design a smaller cross section a detailed structural design will be developed to verify the cross section under the bending moment shear and axial forces it is worth to note that the main driven parameter of all this modeling is the total system weight piston beam basement finding the lightest configuration means to have found also the cheapest solution referring to the previous fig 11b the following angle relations are given 29 ω 1 π 2 α ω 2 ω ω 1 π 2 θ ω 3 π ω 2 the external force reactions are equal to 30 h a h b f u m b 31 v a f y t o t v b and the piston components acting on the chute correspond to 32 f p x f p cos ω 3 33 f p y f p sin ω 3 by considering a relative reference system located on the chute all forces acting on the beam have been divided into their two components getting the following relations h a x h a cos θ h a y h a sin θ v a x v a sin θ v a y v a cos θ f v x f y sin θ f v y f y cos θ f h x f u m b cos θ f h y f u m b sin θ referring to the classical reference system of a beam the bending moment around the piston point of application can be computed as 34 v a y l 1 h a y l 1 f h y l 2 l 1 f v y l 2 l 1 once the shear forces 34 are known the bending moment diagram can be carried out 35 m x h a y x v a y x 0 x l 1 m x h a y l 1 v a y l 1 f p y x l 1 l 1 x l 2 similarly the shear force is given by 36 t x h a y v a y 0 x l 1 t x h a y v a y f p y l 1 x l 2 and the axial force 37 v a x h a x f p x 0 x l 1 f v x f h x l 1 x l 2 the bending moment diagrams are depicted in fig 12 a as it can be seen the bending moment is always negative the lower fibers are stretched fenner and reddy 2012 the plot is bi linear due to the concentrated force of the piston and it reaches maximum values for small l 1 values as expected the shear diagrams are depicted in fig 12b the beam is initially subjected to a negative shear force and after the piston point of applications it becomes positive finally the axial force is displayed in fig 12c the beam is always subjected to a compressive force mainly given by the umbilical as expected furthermore large forces are achieved for small l 1 values 4 1 cross section design once the internal forces diagrams are drawn their maximum values can be found in order to design the required cross section in the worst case for each l 1 value fig 13 a the beam is subjected to a huge shear force due to the piston force and for this reason the design flexure criteria ziemian 2010 selected has been the one that first impose a certain maximum beam deflection f input data the required beam moment of inertia can be then computed by 38 f f py max a 2 b 2 3 e i l 39 i x x f p y max l 1 2 l 2 l 1 2 3 e l 2 2 f once the required moment of inertia is computed for each configuration the axial stress verification is developed for this system the total axial stress acting on the beam cross section is given by the sum of two contributions one flexural and one axial 40 σ n σ f σ a m f w n a where 41 w i x x h 2 eq 40 corresponds to the so called navier stress from this criteria the following equation must be verified 42 σ n σ v m σ y sf both the yielding stress σ y and the safety factor sf can be selected by the user as input data finally a shear verification must be developed 43 τ τ f σ y 3 sf where 44 τ f χ v a y a by definition the beam is made of a hollow rectangular cross section fig 13b defined in such a way that width and height are a function of the thickness as 45 w i d t h h e i g h t 2 t h i c k n e s s w i d t h 10 thus the structural optimization is simplified from a 3 parameters problem to one to a single parameter one the idea is to find for each configuration a rectangular cross section that fits with the required moment of inertia i given by eq 39 an iterative approach based on the bi section method is used in the code firstly an attempted height vector is defined if the procedure does not give any result an input modification must be considered fig 13c describes the cross section heights with respect to l 1 variation once the geometric dimension has been found the section area is calculated it should be recalled that the cross section has been verified under axial shear and bending moment 4 2 total weight and cost optimization once the cross sections is verified the whole system weight base piston main beam for all configurations can be computed at this stage it is important to study the influence of the length ab on the system total weight fig 17a ab assumes the following values 8 10 12 and 14 m the red star reported in the figure corresponds to the result obtained from f lli righini with ab 13 344 m it seems that the whole system weight can be reduced by fixing the piston lower than 5 m in particularly by setting ab 10 m the lightest configuration can be reached black star on the other hand for ab 10 m a larger weight is reached green curve because the axial force needed to push the whole system increases and a bigger piston is required before resuming the whole analysis an economical aspect must be taken into account fig 17b shows the total cost of the system for all configurations cost analysis is based on some indicative prices for each element considered as listed in table 3 it seems that it would be more convenient to reduce the ab value from the initial 13 344 m 10 m the blue curve reaches the lowest cost as already explained reducing further the ab value would mean to have a heavier and more expensive system especially given by the massive piston dimension in the following section the optimized configuration l 1 3 939 m and ab 10 m will be drawn to check if it is actually achievable if it will be the total system cost will be reduced from the actual 223 100 to 206 500 roughly saving 16 600 saving 7 44 5 discussion a remarkable solution has been carried out it seems that by fixing the piston at a lower l 1 distance with respect to the actual 5 046 m a good improvement in terms of both weight and cost can be achieved this theoretical result will be now verified from a practical point of view in fact the considered model did not take into account the actual physical dimension of each element and for this reason the optimized configuration will be now drawn to check if it is actually feasible a detailed comparison with the proposal made by f lli righini technical office will be carried out to evaluate if the optimized configuration can be physically realized 5 1 theoretical comparison a theoretical comparison the piston has been modeled with a line between the optimized configuration and the predesigned one will be now conducted the more interesting results are the ones related to ab 10 m and ab 12 m as depicted in fig 14 a and b 5 2 configuration with ab 10 m the optimized piston dimension see table 4 is now compared with the one obtained during the preliminary design see fig 14a by decreasing the ab distance from 13 344 m to 10 m and by decreasing l 1 from 5 046 m to the optimal 3 939 m a smaller piston can be designed 5 3 configuration with ab 12 m the second optimized configuration is now reported see fig 14b in the reported case the piston length is 7 412 m see tables 4 6 with ab 12 m and a l 1 4 918 m 5 4 feasible comparison in the last section the optimized solution has been shown from a theoretical point of view in fact no piston dimensions have been drawn so it cannot be stated that those solutions are actually achievable to do that the real dimension of all piston elements cylinder rod and even both extreme hinges will be now taken into account as it has been previously explained one of the main piston verification during the design phase is the stroke one it is mandatory to design a piston which has a rod length lower than the cylinder one furthermore the obstruction of both hinges at the extreme points must be considered because their presence can affect the whole piston stroke the two proposed solutions have been compared in the first and last positions for θ 20 and θ 105 5 5 configuration with ab 10 m as it can be seen from fig 15 the optimized configuration for ab 10 m is not feasible in fact due to the large beam width 850 mm and to the element piston dimension this configuration cannot be realized fig 15b nevertheless for the sake of conciseness the final configuration is displayed in fig 15c as it can be seen the piston would be able to perform the final rotation but it cannot be used with the input data of 20 as starting angle 5 6 configuration with ab 12 m following the same procedure as shown above the following data have been obtained the piston length dimensions have been calculated and listed in tables 4 6 having a larger l 1 means to have a smaller cross section fig 13c this optimized configuration fits well with the whole system dimensions the optimized piston can effectively perform the whole rotation the ab distance is reduced from the predesigned 13 344 m to the obtained 12 m as well as the l 1 passes from 5 046 m to 4 918 m see fig 16 reducing the whole piston length of 1 184 m 8 596 m 7 412 m even the weight decreases from the predesigned 7643 kg to 7043 kg saving 600 kg which roughly correspond to 7200 5 7 safety factor to final check the obtained piston a further verification has been carried out by knowing the maximum compressive force at which the piston will be subjected it corresponds to the stowed position and by calculating its real capacity with the obtained piston dimension a safety factor will be computed taking the same allowable oil pressure of 25 mpa the piston capacity is 46 f p p max a 25 π d int 2 4 4 206 kn 426 5 t the maximum external forces acting on the chute have been considered they correspond to the stowed configuration the bending moment can be calculated as 47 m a f v y l 2 f h y l 2 f p l 1 cos 57 finally the external acting force is 48 f a c t i n g 796 920 13 7 350 13 0 54 4 918 n 393 9 t finally the piston safety factor is 49 s f f p f a c t i n g 1 08 with an 8 of positive margin the optimized piston fully satisfies the required task always verifying the mechanical and structural requirements dictated by the dnv regulation 5 8 overall optimization in fig 17 the total optimized system weight black star is compared with the predesigned one red star it can be seen that the total system cost has been reduced of roughly 12 500 223 100 210 600 saving 5 93 table 7 shows the percentage of weight and cost that have been saved by finding the optimized configuration 6 conclusions the procedure presented in this paper can be applied for any further parallelogram mechanisms in fact by simply changing the data input the user will be able to optimize mechanical systems that are represented by the same technology both the mechanical and structural point of views of the kinematic chute have been considered finding out the best system configuration furthermore a huge limitation concerning the buckling for piston with respect to the dnv regulation has been highlighted this issue has been demonstrated and it complete mathematical description will be developed in a future paper acknowledgments the authors acknowledge fondazione flaminia ravenna italy for supporting the present research the first two authors acknowledge f lli righini for providing data photos and information regarding the present study appendix a supplementary data the following is the supplementary data to this article data profile data profile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 004 
22857,this study focuses on the three dimensional trajectory tracking control problem of an underactuated underwater vehicle subject to parameter uncertainties and external disturbances firstly the five degrees freedom dynamic model of an underactuated auv is constructed and the trajectory tracking error dynamic model is established secondly a nonlinear robust control scheme is presented based on the command filtered backstepping method which not only greatly reduces the computational complexities in the traditional backstepping approach but also filters out the high frequency measurement noise in the trajectory tracking moreover the neural networks and adaptive control techniques are employed to estimate and compensate the effect of parameter uncertainties in the control system thirdly in order to guarantee the approximation precision between the virtual control vaules and the filtered signals a lyapunov based filtered error compensation loop is designed and an anti windup design is also developed to deal with the problem of integral saturation in control input signals after that the stability of the control scheme proposed in this paper is proved in the sense of lyapunov stability theory finally comparative simulations were carried out to illustrate the effectiveness and good robustness of the proposed tracking controller keywords underactuated auv trajectory tracking command filtered backstepping parameter uncertainty neural networks 1 introduction with the rapid development of technique of vehicles the autonomous underwater vehicles auvs has played an important role in many undersea applications such as rescue oceanographic mapping deep sea archaeology geological sampling ocean floor survey oil and gas exploration xu et al 2006 xu and xiao 2007 aguiar and hespanha 2007 campbell et al 2012 wynn and huvenne 2014 to complete the aforementioned tasks perfectly the design of trajectory tracking controllers is very essential however most of auvs are underactuated which means that they lack independent control inputs in all the degrees of freedom this restriction causes that the trajectory tracking control in the three dimensional space is a more difficult problem moreover the auvs usually perform tasks in very complex ocean conditions such as model nonlinearities unknown hydrodynamic coefficients and time varying disturbances induced by ocean currents waves and wind bagheri et al 2010 therefore the precise trajectory tracking control of underactuated auvs is a greatly challenging task in the marine industry in past decades various control approaches have been attempted for the underactuated auvs to deal with the aforementioned technique difficulties the lyapunov based backstepping control scheme is the mainstream approach for the trajectory tracking control of auvs due to the fact that the control law processes outstanding nonlinearities in the control system which can greatly increase the system robustness compared with the linear control methods such as the proportional integral derivative pid and the linear quadratic regulator lqr repoulias and papadopoulos 2007 in bi et al 2010 a nonlinear controller based on the backstepping control technique was presented to deal with the tracking of an underactuated auv with certain parameters in li and lee 2005 an adaptive backstepping control law has been presented for the trajectory tracking control on the vertical plane in reference cui et al 2010 a backstepping based trajectory tracking control which considers the complete kinematics and dynamics of the auv has been proposed and some lyapunov based backstepping algorithms were proposed in do et al 2004 xiang et al 2015 then to deal with the unknown parameters a model based adaptive globally finite time tracking controller was proposed in yan et al 2015 an adaptive fuzzy inverse tracking control scheme based on the backstepping technology for a three degree of freedom dof model has been proposed in chen et al 2016 where the fuzzy logic theory was employed to deal with the model dynamics and external disturbances park 2015 has proposed a neuro adaptive tracking controller where the neural network algorithm was used to compensate the hydrodynamic damping terms of the auvs and the dynamic surface control dsc approach was used to reduce the computational complexities recently due to the good robustness to the model uncertainties and external disturbances the sliding mode control smc has been very popular and successfully applied in the trajectory tracking control of the underactuated auvs in soylu et al 2008 a higher order sliding mode controller has been presented for the chattering free tracking control of an underwater vehicle by designing an adaptive term to replace the discontinuous switching term in the traditional sliding mode control scheme to avoid the chattering effects kim et al 2015 has proposed an integral sliding mode control scheme for an underactuated auv subject to parameter uncertainties and time varying external disturbances where the chattering effects in the control system are greatly reduced by using a hyperbolic tangent function to replace the signum function to improve the robustness of the auv subject to modeling errors and environmental disturbances an adaptive dynamic sliding mode controller has been proposed by combining with the backstepping technique xu et al 2015 in liu et al 2014 an adaptive hierarchical smc scheme has been developed to deal with the stabilization and trajectory tracking of the underactuated auvs other recent studies about trajectory tracking control based on the smc method try to address more literatures joe et al 2014 zhang and wang 2016 2017 liu et al 2017 sun et al 2017 although most of aforementioned trajectory tracking controllers possess good control effects it is very essential to point out that most of them concentrate on the control problems only in the horizontal plane however in three dimensional space the trajectory tracking control for the underactuated auvs is much more challenging due to the fact that the dynamics of the auv is more complicated and the number of degrees of freedom without control actuators increases which makes the tracking controller design more difficult for the reason that only a few researchers have investigated this control problem wang et al 2015 has proposed a feedback gaining backstepping controller which can reduce the complexities of controllers however it can not track curvilinear in the three dimensional space in rezazadegan et al 2015 an adaptive backstepping based controller for the three dimensional trajectory tracking of an underactuated auv was proposed but the tracking errors are only asymptotically convergent in jagtap et al 2016 an interesting reduced order model predictive controller has been proposed however both the model uncertainties and external disturbances are not taken into consideration which restricts its application in practice to cope with the model dynamics and external disturbances liang et al 2017 has developed an adaptive fuzzy robust controller for the three dimensional tracking of the underactuated auvs but it is greatly complex to compute the derivative of the virtual control signals then one interesting solution for tracking control of auv with limited torque is employed in shojaei and dolatshahi 2018 and some formation control schemes of auvs are proposed in shojaei and arefi 2015 peng et al 2013 2015 recently the los controller has been widely used for the guidance and navigation of the auvs which is introduced in fossen et al 2014 elhaki and shojaei 2018 ataei and yousefi koma 2015 in shojaei and dolatshahi 2017 a los target tracking controller for the auvs in the three dimensional space has been developed where adaptive neural network technique was employed to estimate the model uncertainties and the dsc stratrgy was employed to reduce the computational complexities but this previous method only concentrates on the position control of the auv the orientation control is not taken into consideration moreover the dsc method also has a certain amplification effect on the system noise which may reduce the control system stability therefore wang et al 2015 proposed a novel command backstepping controller via the second order filter which avoids the weakness of the dsc method by using the numerical integration approach to obtain the derivative of the virtual control signals but this method has the weakness of integral saturation in control inputs and the filtered approximation precision between the virtual control signals and filtered signals can not be guaranteed toward this end in this paper a three dimensional trajectory track ing controller was proposed for the underactuated auvs by employing the command filtered backstepping approach neural networks and adaptive control techniques which is not addressed in the published literatures based on the above discussion the main contributions of this paper are proposed as follows i the inherent explosion of complexity in the traditional backstepping design is avoided via command filtered backstepping method and a lyapunov based filtered error compensation loop is developed to guarantee the approximation precision between the virtual control vaules and the filtered signals ii an anti windup design is developed to deal with the problems of integral saturation of the control input signals iii all types of model uncertainties can be effectively estimated and compensated by the neural networks and adaptive robust techniques which makes the controller easily to implement in practice the rest of this paper is organised as follows in section 2 the problem formulation including the auv kinematic model dynamic model and error systems is established in section 3 the main results of this paper including the trajectory tracking controller design and stability analysis of the overall control system are proposed in section 4 the numerical simulations and comparative analysis are given to evaluate the tracking performance of the proposed controller finally a brief conclusion is drawn in section 5 2 problem formulation 2 1 auv kinematic and dynamic equations here we neglect auv roll dynamics and then consider a 5 dof kinematic and dynamic models of an underactuated auv subject to the external nonlinear disturbances as do 2013 1 x u cos θ cos ψ v sin ψ w sin θ cos ψ y u cos θ sin ψ v cos ψ w sin θ sin ψ z u sin θ w cos θ θ q ψ r cos θ 2 u m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u 1 m 11 τ e u t v m 11 m 22 u r d 22 m 22 v 1 m 22 τ e v t w m 11 m 33 u q d 33 m 33 w 1 m 33 τ e w t q m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 τ q m 55 τ e q t m 55 r m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r 1 m 66 τ e r t where x y z θ and ψ denote the positions i e surge sway and heave displacements and orientations i e pitch and yaw angles of the underactuated auv respectively in the earth fixed frame the signals u v w q and r represent the surge sway heave pitch and yaw velocities respectively in the body fixed frame in fig 1 the signals τ u τ q and τ r denote the auv control inputs produced by thrusters and propellers τ e u τ e v τ e w τ e q and τ e r represent the bounded nonlinear environmental disturbances the positive constant signals m i i i 1 2 3 5 6 represent the inertia and added mass parameters of the auv and d i i i 1 2 3 5 6 represent the hydrodynamic damping coefficients and other signals are introduced in pettersen and egeland 1999 assumption 1 the sway and heave velocities of auv are passive bounded in the sense that sup t 0 v v m and sup t 0 w w m assumption 2 the external nonlinear disturbances are bounded in the sense that τ e k t d k k u v w q r where d k represent the unknown positive constants shojaei 2016 assumption 3 the auv pitch angle is bounded such that θ t θ max π 2 to prevent any possible singularity in the system stability analysis shojaei 2016 2 2 control objectives in this paper our control objective is to develop an adaptive controller to track the following desired trajectory generated by the virtual target auv in fig 1 3 x d u d cos θ d cos ψ d v d sin ψ d w d sin θ d cos ψ d y d u d cos θ d sin ψ d v d cos ψ d w d sin θ d sin ψ d z d u d sin θ d w d cos θ d θ d q d ψ d r d cos θ d 4 u d m 22 m 11 v d r d m 33 m 11 w d q d d 11 m 11 u d 1 m 11 τ u d v d m 11 m 22 u d r d d 22 m 22 v d w d m 11 m 33 u d q d d 33 m 33 w d q d m 33 m 11 m 55 u d w d d 55 m 55 q d ρ g g m l sin θ d m 55 τ q d m 55 r d m 11 m 22 m 66 u d v d d 66 m 66 r d 1 m 66 τ r d where x d y d z d θ d and ψ d denote the desired position and orientation signals in the earth fixed frame o e x e y e z e u d v d w d q d and r d denote the desired velocity signals in the body fixed frame o b x b y b z b τ u d τ q d and τ r d denote the desired control inputs of auv assumption 4 the desired trajectory signals of the auv η d t υ d t η d t υ d t η d t and υ d t are bounded where η d t x d y d z d θ d ψ d t and υ d t u d v d w d q d r d t 2 3 auv error systems the auv error systems are presented in this section according to fig 1 the following transformation can be proposed to let the position and orientation tracking errors in the earth fixed frame transform to the body fixed frame 5 s cos ψ cos θ x x d cos θ sin ψ y y d sin θ z z d e sin ψ x x d cos ψ y y d h cos ψ sin θ x x d sin ψ sin θ y y d cos θ z z d ψ e ψ ψ d θ e θ θ d where s e and h denote the position tracking errors in the body fixed frame then differentiating 5 along with 1 2 3 and 4 yields the following error systems 6 s u e cos θ e 1 cos θ d cos θ cos ψ e 1 u d sin θ e cos θ sin θ d cos ψ e 1 w d cos θ sin ψ e v d r e q h e v e cos θ d sin ψ e u d cos ψ e 1 v d cos θ d sin ψ e w d s tan θ h r h w e sin θ e sin θ cos θ d cos ψ e 1 u d cos θ e 1 sin θ sin θ d cos ψ e 1 w d sin θ d sin ψ e v d tan θ r e q s ψ e r e cos θ r d cos θ cos θ d cos θ d 1 cos θ d sin θ d sin θ e θ e q e where u e u u d v e v v d w e w w d q e q q d r e r r d according to 6 the signals s θ e and ψ e can be directly stabilized by u e q e and r e and the signals θ e and ψ e are chosen to stabilize the signals e and h respectively additionally the following coordinate transformations are employed to avoid whirling around when e and h are very large do 2009 7 z 1 ψ e arcsin k 1 e s 2 e 2 h 2 z 2 θ e arcsin k 2 h s 2 e 2 h 2 where 0 k 1 1 and 0 k 2 1 then substituting 7 into 6 yields the error system as 8 s u e χ 2 χ cos θ d cos θ χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d r e q h ℓ 1 e v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e s tan θ h r ℓ 2 h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d r e k 1 sin θ v d χ 1 e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d tan θ r e q s ℓ 3 z 1 1 k 1 χ 1 1 cos θ s sin θ h cos θ 1 r e k 1 χ 1 1 χ 2 s e u e ϖ 1 ℓ 4 z 2 1 k 2 χ 2 1 s q e k 2 tan θ χ 2 1 e r e k 2 χ 2 1 χ 2 s h u e ϖ 2 ℓ 5 u e m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u 1 m 11 τ e u t u d v e m 11 m 22 u e r e u e r d u d r e d 22 m 22 v e 1 m 22 τ e v t w e m 11 m 33 u e q e u d q e u e q d d 33 m 33 w e 1 m 33 τ e w t q e m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 τ q m 55 τ e q t m 55 q d r e m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r 1 m 66 τ e r t r d where χ 1 s 2 e 2 h 2 χ 1 1 s 2 1 k 1 2 e 2 h 2 and χ 2 1 s 2 e 2 1 k 2 2 h 2 and ℓ 1 cos z 2 1 χ 2 k 2 sin z 2 h cos θ cos θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 u d sin z 2 χ 2 k 2 cos z 2 1 h cos θ sin θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 w d cos θ sin z 1 χ 1 k 1 cos z 1 1 e χ 1 v d ℓ 2 cos θ d sin z 1 χ 1 k 1 cos z 1 1 e χ 1 u d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 v d sin θ d sin z 1 χ 1 k 1 cos z 1 1 e χ 1 w d ℓ 3 sin z 2 χ 2 k 2 cos z 2 1 h sin θ cos θ d cos z 2 1 χ 1 k 1 sin z 1 e χ 1 u d cos z 2 1 χ 2 k 2 sin z 2 h sin θ sin θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 w d sin θ sin z 1 χ 1 k 1 cos z 2 1 e χ 1 v d ℓ 4 k 1 ℓ 2 s ℓ 1 e ℓ 2 h ℓ 3 e χ 2 χ 1 1 χ 1 1 cos z 2 χ 2 cos θ 1 k 2 sin z 2 h tan θ d sin z 2 k 2 cos z 2 1 h ℓ 5 k 2 χ 2 1 ℓ 3 h χ 2 s ℓ 1 e ℓ 2 h ℓ 3 ϖ 1 r d χ 1 cos 1 θ d cos θ 1 cos z 2 χ 2 k 2 sin z 2 h cos z 2 1 sin z 2 tan θ d k 2 h cos θ 1 χ 1 k 1 χ 1 v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e s tan θ d h r d e χ 2 s χ 2 χ cos θ cos θ d χ 1 χ χ 1 u d k 1 cos θ χ 1 v d e k 2 h cos θ sin θ d χ 1 χ χ 1 w d e v e k 1 cos θ d χ 1 u d e χ 1 χ χ 1 v d k 1 sin θ d χ 1 w d e h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ χ 1 v d e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d ϖ 2 k 2 χ 2 1 w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ χ 1 v d e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d q s tan θ r e h χ 2 s χ 2 χ cos θ cos θ d χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d e v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ v d χ 1 e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d 3 main results 3 1 controller design in this section a trajectory tracking controller is developed based on the command filter backstepping method neural networks and adaptive control techniques in order to avoid the explosion of complexity in the traditional backstepping control approach the control signals are passed via the following command filter farrell et al 2009 9 κ c 2 λ ϖ n κ c ϖ n 2 κ c κ c 0 where κ c 0 x c o y c o z c o θ c o ψ c o u c o q c o r c o t is the vector of desired control signals κ c x c y c z c θ c ψ c u c q c r c t is the vector of filtered control signals ω n and λ are the parameters of the command filter where 0 ω n 1 and λ 0 and the structure of the filter is shown as fig 2 3 1 1 position control for clarity we define the position dynamics as x u x y u y and z u z and then combine with the kinematic equation 1 we get 10 u c o v w 1 0 0 0 1 0 0 0 1 cos θ c o 0 sin θ c o 0 1 0 sin θ c o 0 cos θ c o cos ψ c o sin ψ c o 0 sin ψ c o cos ψ c o 0 0 0 1 u x c u y c u z c according to 10 the following desired virtual signals can be designed as 11 u c o u x c cos θ c o cos ψ c o u y c cos θ c o sin ψ c o u z c sin θ c o θ c o arcsin w 2 u z c 2 arctan u z c ψ c o arcsin v u x c 2 u y c 2 arctan u y c u x c where u x c cos ψ c o u y c sin ψ c o u x c x c u y c y c and u z c z c then the position dynamics of auv can be written as 12 x y z u x u y u z u x c o u y c o u z c o u x u y u z u x c u x c o u y c u y c o u z c u z c o u x c o u y c o u z c o u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ u ψ θ where u u u c ψ ψ ψ c and θ θ θ c and a cos ψ c cos θ c cos θ sin ψ sin θ b b x 1 b x 2 b y 1 b y 2 0 0 c c x 1 c x 2 c y 1 c y 2 c z 1 c z 2 g θ cos θ 1 θ sin θ θ g ψ cos ψ 1 ψ sin ψ ψ where b x 1 u cos θ cos ψ c v sin ψ c w sin θ cos ψ c b x 2 u cos θ sin ψ c v cos ψ c w sin θ sin ψ c b y 1 u c cos θ c sin ψ c v cos ψ c w sin θ sin ψ c b y 2 u c cos θ c cos ψ c v sin ψ c w sin θ cos ψ c c x 1 u cos θ c cos ψ c w sin θ c cos ψ c c x 2 u cos θ c cos ψ c w sin θ c cos ψ c c y 1 u c sin ψ cos θ c w sin θ c sin ψ c c y 2 u c sin ψ cos θ c w cos θ c sin ψ c c z 1 u c sin θ c w cos θ c c z 2 u c cos θ c w sin θ c then we consider the following desired velocities in the earth fixed frame as 13 u x c o α x x u x c u y c o α y y u y c u z c o α z z u z c where x x x c y y y c and z z z c α x α y and α z are the unknown positive constants substitute 13 into 12 and the position dynamic error system can be rewritten as 14 x y z α x x α y y α z z u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ u ψ θ 3 1 2 attitude control for the pitch and yaw control we define the following signals 15 q c o α θ θ θ c θ b s r c o α ψ ψ ψ c ψ b s where θ θ θ c ψ ψ ψ c α θ α ψ are the known positive constants θ b s and ψ b s represent the robust terms designed in section 3 2 based on this definition 15 the closed loop attitude dynamic errors can be proposed as 16 θ q c o q q c q c q c o α θ θ θ c θ b s q q c q c o θ α θ θ θ b s q q c q c o ψ r c o r r c r c r c o cos θ α ψ ψ ψ c ψ b s r r c r c o cos θ ψ α ψ ψ ψ b s r r c r c o r c o cos θ 3 1 3 velocity and angular velocity control we define the velocity errors as u u u c q q q c and r r r c and then the dynamic error equations can be proposed as 17 m 11 u m 22 v r m 33 w q m 11 u c d 11 u τ u τ e u t m 55 q m 33 m 11 u w m 55 q c d 55 q ρ g g m l sin θ τ q τ e q t m 66 r m 11 m 22 u v m 66 r c d 66 r τ r τ e r t then the controllers τ u τ q and τ r can be designed as 18 τ u m 11 α u u α i u ε u u b s ℓ u τ q m 55 α q q α i q ε q q b s ℓ q τ r m 66 α r r α i r ε r r b s ℓ r where ε u u d t ε q q d t ε r r d t α u α q and α r are unknown positive constants u b s q b s and r b s are the robust terms designed in section 3 2 and ℓ u ℓ q and ℓ r are proposed as 19 ℓ u m 22 v r m 33 w q d 11 u m 11 u c ℓ q m 33 m 11 u w d 55 q ρ g g m l sin θ m 55 q c ℓ r m 11 m 22 u v d 66 r m 66 r c 3 1 4 adaptive neural network control in this section to solve the problems of model uncertainties and nonlinear disturbances in the system the radial basis function neural networks rbfnns are employed due to their simplicity and linear parameterization the structure of a typical three layer radial basis function neural network is shown as fig 3 then we define x u v w q r θ u c q c r c t is the input vector of nns f x ℓ u ℓ q ℓ r t is the unknown function in the system and f x can be approximated by the following three layer radial basis function neural network with k nodes 20 f ˆ x w w ξ x where w w u 1 w u 2 w u k w q 1 w q 2 w q k w r 1 w r 2 w r k w u t w q t w r t w is the adjustable weight matrix of the neural network system and ξ x ξ 1 x ξ 2 x ξ 3 x ξ k x t is a neural basis function vector where ξ i x is the basis function which is chosen as the following n t h gaussian functions 21 ξ i x exp x η i 2 μ i 2 i 1 2 3 k where η i and μ i are the centre vector and the standard deviation respectively then we define the optimal weight matrix w as 22 w arg min w ω sup x u f x f x w where ω and u are the compact sets of x and w respectively and then we define the neural network approximation error e x as 23 e x f x f ˆ x w in this paper w represents the estimation of w which is usually estimated by an adaptive rule based on the lyapunov stability theory and the estimation error can be defined as w w w finally the unknown nonlinear function is conducted as 24 f x w ξ x e x where e x satisfies e x e m e m is an unknown positive constant as a result the controller in surge direction is rewritten as 25 τ u m 11 α u u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u w u λ w u u ξ t x λ w u γ u w u ρ u λ ρ u u λ ρ u κ u ρ u ρ u 0 where α u α i u δ u λ w u γ u λ ρ u κ u ρ u 0 are the unknown positive parameters controller in pitch direction is rewritten as 26 τ q m 55 α q q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q w q λ w q q ξ t x λ w q γ q w q ρ q λ ρ q q λ ρ q κ q ρ q ρ q 0 where α q α i q δ q λ w q γ q λ ρ q κ q ρ q 0 are the unknown positive parameters controller in yaw direction is rewritten as 27 τ r m 66 α r r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r w r λ w r r ξ t x λ w r γ r w r ρ r λ ρ r r λ ρ r κ r ρ r ρ r 0 where α r α i r δ r λ w r γ r λ ρ r κ r ρ r 0 are the unknown positive parameters then we substitute 25 26 and 27 into 2 and get the following error dynamics 28 m 11 u m 11 α u u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t m 55 q m 55 α q q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t m 66 r m 66 α r r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t by defining ε u u ε q q and ε r r 28 is rewritten as 29 m 11 ε u m 11 α u ε u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t m 55 ε q m 55 α q ε q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t m 66 ε r m 66 α r ε r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t then by defining ε ε u ε q ε r t and e ε t ε t t and 29 is finally rewritten as 30 e m e τ n where μ 0 3 3 i 3 3 p i 3 3 p k 3 3 t 0 3 3 i 3 3 n u b s m 11 1 w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t q b s m 55 1 w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t r b s m 66 1 w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t p k 3 3 d i a g α u α q α r p i 3 3 d i a g α i u α i q α i r remark 1 it is very necessary to point out that the measurement of auvs parameters are not easy therefore a weakness of this controller is the dependence of the proposed control laws to inertial parameters including m 11 m 55 and m 66 in 25 26 and 27 3 1 5 filter error compemsation loop design in this section a filter error compensation loop is designed to guarantee the approximation precision between the virtual signals and the filtered signals we define the position filtered compensation errors as 31 ϑ x x χ x ϑ y y χ y ϑ z z χ z where χ x χ y and χ z are designed as 32 χ x χ y χ z α x χ x α y χ y α z χ z u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ χ u χ ψ χ θ where χ x 0 χ y 0 χ z 0 0 χ ψ χ θ are designed in 37 and then combine 12 and 32 we get 33 ϑ x ϑ y ϑ z α x ϑ x α y ϑ y α z ϑ z a b g ψ c g θ ϑ u ϑ ψ ϑ θ where ϑ u u χ u ϑ ψ ψ χ ψ and ϑ θ θ χ θ then we consider the following lyapunov function as 34 v x y z 1 2 ϑ x 2 ϑ y 2 ϑ z 2 differentiating 34 along with 12 and 33 we get 35 v x y z ϑ x ϑ x ϑ y ϑ y ϑ z ϑ z α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 ϑ x ϑ y ϑ z a b g ψ c g θ χ u χ ψ χ θ α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 a t ϑ x ϑ y ϑ z t ϑ u g t ψ b t ϑ x ϑ y ϑ z ϑ ψ g t θ c t ϑ x ϑ y ϑ z ϑ θ then we define the pitch and yaw angle filter compensation errors as 36 ϑ ψ ψ χ ψ ϑ θ θ χ θ where χ ψ and χ θ are defined as 37 χ ψ r c r c o χ r cos θ α ψ χ ψ χ θ q c q c o χ q α θ χ θ where χ ψ 0 χ θ 0 χ r χ q 0 then we consider a new lyapunov function as 38 v ψ θ 1 2 ϑ ψ 2 ϑ θ 2 differentiating 38 along with 16 and 37 we get 39 v ψ θ ϑ ψ ϑ ψ ϑ θ ϑ θ ψ χ ψ ϑ ψ θ χ θ ϑ θ r cos θ α ψ ψ ψ b s α ψ χ ψ χ r cos θ ϑ ψ α θ θ q θ b s α θ χ θ χ q ϑ θ α ψ ϑ ψ 2 α θ ϑ θ 2 ϑ r cos θ ϑ ψ ϑ q ϑ θ ψ b s ϑ ψ θ b s ϑ θ where ϑ q q and ϑ r r 3 1 6 anti windup design in this section an anti windup design is developed to avoid the problems of integral saturation of the control input signals the anti windup design is proposed as 40 u s u m u u m u u m u u m u m u u m where u τ u τ q τ r t is the control input vector u s is the control input vector after the anti windup design u m is the limited amplitude of control input signals as a result the controller of anti windup part is proposed as 41 u u s δ s u u s d t where δ s denotes the unknown positive parameter as shown in fig 4 a block diagram of the trajectory tracking control system is proposed in the next section the essential stability proof for the overall control system is proposed 3 2 stability analysis of the overall control system in this section the closed loop stability of the trajectory tracking control system is proposed as the first step we consider the following lyapunov function 42 v v x y z v ψ θ 1 2 e t k e 1 2 k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u 2 m 11 λ ρ u k 22 ρ q 2 m 55 λ ρ q k 23 ρ r 2 m 66 λ ρ r 1 2 ϑ x 2 ϑ y 2 ϑ z 2 ϑ ψ 2 ϑ θ 2 e t k e 1 2 k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u 2 m 11 λ ρ u k 22 ρ q 2 m 55 λ ρ q k 23 ρ r 2 m 66 λ ρ r where k k 1 0 3 3 0 3 3 k 2 is a positive definite symmetric matrix k i d i a g k i 1 k i 2 k i 3 i 1 2 and w k w k w k ρ k ρ k ρ k k u q r then by differentiating 42 along with 30 35 and 39 we get 43 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α θ ϑ θ 2 α ψ ϑ ψ 2 e t η e a t ϑ x ϑ y ϑ z ϑ u g t ψ b t ϑ x ϑ y ϑ z ϑ ψ g t θ c t ϑ x ϑ y ϑ z ϑ θ ϑ r cos θ ϑ ψ θ b s ϑ θ ψ b s ϑ ψ ϑ q ϑ θ k 21 ϑ u u b s k 22 ϑ q q b s k 23 ϑ r r b s k 21 m 11 1 ϑ u w u ξ x ρ u tanh ν ρ u u δ u e w u τ e u t k 22 m 55 1 ϑ q w q ξ x ρ q tanh ν ρ q q δ q e w q τ e q t k 23 m 66 1 ϑ r w r ξ x ρ r tanh ν ρ r r δ r e w r τ e r t k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u ρ u m 11 λ ρ u k 22 ρ q ρ q m 55 λ ρ q k 23 ρ r ρ r m 66 λ ρ r where h 1 2 m t k m a 1 2 0 3 3 p i k 2 k 1 p i k 2 k 1 2 p i k 2 then let choose κ 1 p i k 2 and we get h 0 3 3 0 3 3 0 3 3 p i k 2 then we design the robust terms ψ b s θ b s u b s q b s and r b s as 44 ψ b s g t ψ b t ϑ x ϑ y ϑ z θ b s g t θ c t ϑ x ϑ y ϑ z u b s 1 k 21 a t ϑ x ϑ y ϑ z 45 q b s ϑ θ k 22 r b s ϑ ψ k 23 cos θ substitute 44 and 45 into 43 and we get 46 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α ψ ϑ ψ 2 α θ ϑ θ 2 e t h e k 21 m 11 1 ϑ u w u ξ x ρ u tanh ν ρ u u δ u e w u τ e u t k 22 m 55 1 ϑ q w q ξ x ρ q tanh ν ρ q q δ q e w q τ e q t k 23 m 66 1 ϑ r w r ξ x ρ r tanh ν ρ r r δ r e w r τ e r t k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u ρ u m 11 λ ρ u k 22 ρ q ρ q m 55 λ ρ q k 23 ρ r ρ r m 66 λ ρ r then 46 is expressed as follows by considering lemma polycarpou 2002 inequality h x x h tanh ν h x δ δ t holds for any δ t 0 where ν e ν 1 w k t w k a 1 w k f 2 a 2 w k f 2 ρ k ρ k ρ k 0 a 1 ρ k 2 a 2 ρ k ρ k 0 2 e w k τ e k ρ k k u q r with a 1 1 0 5 σ 2 a 2 0 5 σ 2 and σ 2 2 and combine with 25 26 and 27 47 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α ψ ϑ ψ 2 α θ ϑ θ 2 e t h e a 1 γ u k 21 m 11 1 w u f 2 a 1 γ q k 22 m 55 1 w q f 2 a 1 γ r k 23 m 66 1 w r f 2 a 1 κ u k 21 m 11 1 ρ u 2 a 1 κ q k 22 m 55 1 ρ q 2 a 1 κ r k 23 m 66 1 ρ r 2 a 2 γ u k 21 m 11 1 w u f 2 a 2 γ q k 22 m 55 1 w q f 2 a 2 γ r k 23 m 66 1 w r f 2 a 2 κ u k 21 m 11 1 ρ u ρ u 0 2 a 2 κ q k 22 m 55 1 ρ q ρ q 0 2 a 2 κ r k 23 m 66 1 ρ r ρ r 0 2 δ u δ q δ r as a result 47 can be finally expressed as the following differential inequality 48 v t κ min κ max v t δ where κ max max 1 κ k k 21 m 11 λ w u k 22 m 55 λ w q k 23 m 66 λ w r k 21 m 11 λ ρ u k 22 m 55 λ ρ q k 23 m 66 λ ρ r κ min min α x α y α z α θ α ψ κ h κ w u κ w q κ w r κ ρ u κ ρ q κ ρ r κ w u a 1 γ u k 21 m 11 1 κ w q a 1 γ q k 22 m 55 1 κ w r a 1 γ r k 23 m 66 1 κ ρ u a 1 κ u k 21 m 11 1 κ ρ q a 1 κ q k 22 m 55 1 κ ρ r a 1 κ r k 23 m 66 1 κ p denotes the maximum value in matrix k κ h represents minimum value in matrix h and 49 δ a 2 γ u k 21 m 11 1 w u f 2 a 2 γ q k 22 m 55 1 w q f 2 a 2 γ r k 23 m 66 1 w r f 2 a 2 κ u k 21 m 11 1 ρ u ρ u 0 2 a 2 κ q k 22 m 55 1 ρ q ρ q 0 2 a 2 κ r k 23 m 66 1 ρ r ρ r 0 2 δ u δ q δ r finally this result indicates that all the signals for the overall control system are uniformly ultimately bounded and the trajectory tracking errors ultimately converge to a small neighborhood of the zero this completes the proof 4 numerical simulations in this section numerical simulations are carried out to evaluate the effectiveness and robustness of the presented controller all simulations are performed using matlab software environment for the simulation of a real auv we choose a new flying wing auv fig 5 possessed excellent hydrodynamic properties and its parameters are introduced in wang et al 2018 in order to simulate a more realistic auv we assume that the parameters of auv are unknown completely and the auv is affected by the following environment disturbances 50 d t t d t k ω where d t τ e u t τ e v t τ e w t τ e q t τ e r t t is the vector of environment disturbances ω represents the high frequency measurement noise which has the largest amplitude of ω 1 t diag 100 100 100 100 100 represents the time constant matrix and k diag 10 5 5 10 10 denotes gain parameter matrix then we suppose that auv is required to track the following trajectory 51 x d t a cos ω r t y d t a sin ω r t z d t 2 ω r t a where a 50 ω r π 125 a 1 the initial positions of the auv is given by x 0 10 m y 0 5 m z 0 0 m the initial pitch and yaw angles are provided by θ 0 0 and ψ 0 0 respectively the initial velocities of auv are given by u 0 m s v 0 m s and w 0 m s in the numerical simulation the controller parameters are given by α x 20 α y 10 α z 10 α ψ α θ 8 α u 20 α q α r 10 α i u 5 α i q α i r 5 k 21 10 k 22 k 23 5 and the parameters of the filter are set to ω n 20 r a d s and λ 0 95 furthermore the parameters of rbf neural network with ten hidded nodes proposed in this paper are given by λ w u 20 λ w q 20 λ w r 20 γ u 0 1 γ q 0 1 γ r 0 1 λ ρ u 6 λ ρ q 6 λ ρ r 6 κ u 0 2 κ q 0 2 κ r 0 2 and the centre vector and the standard deviation are chosen as η i 10 8 6 4 2 2 4 6 8 10 t and μ i 20 based on the k clustering method zhang and chu 2012 respectively w is a 3 10 matrix and the initial vaule of w is set to 0 finally the simulation results by using command filter based adaptive neural tracking cfant control the robust smc zhang et al 2016 and the traditional backstepping control are illustrated in figs 6 13 where controller by using traditional backstepping method is shown in appendix a fig 6 depicts the trajectory of the auv in the three dimensional space figs 7 and 8 depict the horizontal plane projection and vertical plane projection for the 3d trajectory respectively and it can be seen that the auv can successfully follow the desired trajectory regardless of the parameter uncertainties and external disturbance as shown in fig 9 the trajectory errors ultimately converge to a small neighborhood of zero and the proposed controller is higher accuracy of trajectory tracking compared with the traditional backstepping control and the sliding mode control velocity response and angle response are shown as figs 10 and 11 and it can be seen that the cfant controller is not sensitive to the environmental disturbances which reveals that cfant controller is of good robustness fig 12 shows that the model uncertainties in the system can be efficiently and accurately compensated by the rbf neural networks finally the control signals for the three methods are shown in fig 13 5 conclusion this brief addresses the 3d trajectory tracking problem of underactuated auv in the presence of model uncertainty unmodeled dynamics and external environment disturbances a design controller is proposed based on command filtered backstepping method rbf neural network and adaptive control techniques a second order filter is designed to obtain derivative of virtual control signals which not only avoids the inherent explosion of complexity but also filters out system high frequency measurement noise moreover a filtered error compensation loop is developed to guarantee the approximation precision between virtual control signals and filtered signals and an emtimator is designed where a rbf neural network system is employed to emtimate and approximate the total uncertainties in the control system the stability of the closed loop system is analyzed based on the lyapunov stability theory finally the simulation results substantiate the effectiveness and good robustness of the proposed tracking controller for the futurework it is of interest to extend these results to cooperative trajectory tracking of underactuated auvs for the futurework the target tracking problems with limited control torques can be developed liu et al 2018 and it is of interest to extend these results to the constrained control of the underactuated auvs peng et al 2018 acknowledgments the authors acknowledge support by the national natural science foundation of china nsfc grant nos 11672094 appendix a conventional backstepping controller according to 8 the conventional backstepping tracking controller for the underactuated auv is proposed as follows τ u m 11 λ 1 u e m 22 m 11 v r m 33 m 11 w q d 11 m 11 u e d u d u d u e d k 1 χ 1 1 χ 1 2 s e z 1 k 2 χ 2 1 χ 2 s h z 2 τ q m 55 λ 2 q e m 11 m 33 m 55 u w d 55 m 55 q e d q d ρ g g m l sin θ m 55 q d q e d 1 k 2 χ 2 1 s z 2 τ r m 66 λ 3 r e m 11 m 22 m 66 u v d 66 m 66 r e d r d r d r e d k 2 tan θ χ 2 1 e z 2 1 k 1 χ 1 1 cos θ s sin θ h z 1 cos θ where u e d k 0 χ 1 s χ 2 χ cos θ d cos θ χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d r e d cos θ c 1 z 1 k 1 χ 1 1 χ 2 s e u e d ϖ 1 ℓ 4 1 k 1 χ 1 1 cos θ s sin θ h cos θ q e d c 2 z 2 2 k 2 tan θ χ 2 1 e r e d k 2 χ 2 1 χ 2 s h u e d ϖ 2 ℓ 5 1 k 2 χ 2 1 s futhermore parameters of the conventional backstepping controller are given by k 0 1 k 1 0 5 and k 2 0 5 c 1 c 2 2 λ 1 λ 2 λ 3 4 
22857,this study focuses on the three dimensional trajectory tracking control problem of an underactuated underwater vehicle subject to parameter uncertainties and external disturbances firstly the five degrees freedom dynamic model of an underactuated auv is constructed and the trajectory tracking error dynamic model is established secondly a nonlinear robust control scheme is presented based on the command filtered backstepping method which not only greatly reduces the computational complexities in the traditional backstepping approach but also filters out the high frequency measurement noise in the trajectory tracking moreover the neural networks and adaptive control techniques are employed to estimate and compensate the effect of parameter uncertainties in the control system thirdly in order to guarantee the approximation precision between the virtual control vaules and the filtered signals a lyapunov based filtered error compensation loop is designed and an anti windup design is also developed to deal with the problem of integral saturation in control input signals after that the stability of the control scheme proposed in this paper is proved in the sense of lyapunov stability theory finally comparative simulations were carried out to illustrate the effectiveness and good robustness of the proposed tracking controller keywords underactuated auv trajectory tracking command filtered backstepping parameter uncertainty neural networks 1 introduction with the rapid development of technique of vehicles the autonomous underwater vehicles auvs has played an important role in many undersea applications such as rescue oceanographic mapping deep sea archaeology geological sampling ocean floor survey oil and gas exploration xu et al 2006 xu and xiao 2007 aguiar and hespanha 2007 campbell et al 2012 wynn and huvenne 2014 to complete the aforementioned tasks perfectly the design of trajectory tracking controllers is very essential however most of auvs are underactuated which means that they lack independent control inputs in all the degrees of freedom this restriction causes that the trajectory tracking control in the three dimensional space is a more difficult problem moreover the auvs usually perform tasks in very complex ocean conditions such as model nonlinearities unknown hydrodynamic coefficients and time varying disturbances induced by ocean currents waves and wind bagheri et al 2010 therefore the precise trajectory tracking control of underactuated auvs is a greatly challenging task in the marine industry in past decades various control approaches have been attempted for the underactuated auvs to deal with the aforementioned technique difficulties the lyapunov based backstepping control scheme is the mainstream approach for the trajectory tracking control of auvs due to the fact that the control law processes outstanding nonlinearities in the control system which can greatly increase the system robustness compared with the linear control methods such as the proportional integral derivative pid and the linear quadratic regulator lqr repoulias and papadopoulos 2007 in bi et al 2010 a nonlinear controller based on the backstepping control technique was presented to deal with the tracking of an underactuated auv with certain parameters in li and lee 2005 an adaptive backstepping control law has been presented for the trajectory tracking control on the vertical plane in reference cui et al 2010 a backstepping based trajectory tracking control which considers the complete kinematics and dynamics of the auv has been proposed and some lyapunov based backstepping algorithms were proposed in do et al 2004 xiang et al 2015 then to deal with the unknown parameters a model based adaptive globally finite time tracking controller was proposed in yan et al 2015 an adaptive fuzzy inverse tracking control scheme based on the backstepping technology for a three degree of freedom dof model has been proposed in chen et al 2016 where the fuzzy logic theory was employed to deal with the model dynamics and external disturbances park 2015 has proposed a neuro adaptive tracking controller where the neural network algorithm was used to compensate the hydrodynamic damping terms of the auvs and the dynamic surface control dsc approach was used to reduce the computational complexities recently due to the good robustness to the model uncertainties and external disturbances the sliding mode control smc has been very popular and successfully applied in the trajectory tracking control of the underactuated auvs in soylu et al 2008 a higher order sliding mode controller has been presented for the chattering free tracking control of an underwater vehicle by designing an adaptive term to replace the discontinuous switching term in the traditional sliding mode control scheme to avoid the chattering effects kim et al 2015 has proposed an integral sliding mode control scheme for an underactuated auv subject to parameter uncertainties and time varying external disturbances where the chattering effects in the control system are greatly reduced by using a hyperbolic tangent function to replace the signum function to improve the robustness of the auv subject to modeling errors and environmental disturbances an adaptive dynamic sliding mode controller has been proposed by combining with the backstepping technique xu et al 2015 in liu et al 2014 an adaptive hierarchical smc scheme has been developed to deal with the stabilization and trajectory tracking of the underactuated auvs other recent studies about trajectory tracking control based on the smc method try to address more literatures joe et al 2014 zhang and wang 2016 2017 liu et al 2017 sun et al 2017 although most of aforementioned trajectory tracking controllers possess good control effects it is very essential to point out that most of them concentrate on the control problems only in the horizontal plane however in three dimensional space the trajectory tracking control for the underactuated auvs is much more challenging due to the fact that the dynamics of the auv is more complicated and the number of degrees of freedom without control actuators increases which makes the tracking controller design more difficult for the reason that only a few researchers have investigated this control problem wang et al 2015 has proposed a feedback gaining backstepping controller which can reduce the complexities of controllers however it can not track curvilinear in the three dimensional space in rezazadegan et al 2015 an adaptive backstepping based controller for the three dimensional trajectory tracking of an underactuated auv was proposed but the tracking errors are only asymptotically convergent in jagtap et al 2016 an interesting reduced order model predictive controller has been proposed however both the model uncertainties and external disturbances are not taken into consideration which restricts its application in practice to cope with the model dynamics and external disturbances liang et al 2017 has developed an adaptive fuzzy robust controller for the three dimensional tracking of the underactuated auvs but it is greatly complex to compute the derivative of the virtual control signals then one interesting solution for tracking control of auv with limited torque is employed in shojaei and dolatshahi 2018 and some formation control schemes of auvs are proposed in shojaei and arefi 2015 peng et al 2013 2015 recently the los controller has been widely used for the guidance and navigation of the auvs which is introduced in fossen et al 2014 elhaki and shojaei 2018 ataei and yousefi koma 2015 in shojaei and dolatshahi 2017 a los target tracking controller for the auvs in the three dimensional space has been developed where adaptive neural network technique was employed to estimate the model uncertainties and the dsc stratrgy was employed to reduce the computational complexities but this previous method only concentrates on the position control of the auv the orientation control is not taken into consideration moreover the dsc method also has a certain amplification effect on the system noise which may reduce the control system stability therefore wang et al 2015 proposed a novel command backstepping controller via the second order filter which avoids the weakness of the dsc method by using the numerical integration approach to obtain the derivative of the virtual control signals but this method has the weakness of integral saturation in control inputs and the filtered approximation precision between the virtual control signals and filtered signals can not be guaranteed toward this end in this paper a three dimensional trajectory track ing controller was proposed for the underactuated auvs by employing the command filtered backstepping approach neural networks and adaptive control techniques which is not addressed in the published literatures based on the above discussion the main contributions of this paper are proposed as follows i the inherent explosion of complexity in the traditional backstepping design is avoided via command filtered backstepping method and a lyapunov based filtered error compensation loop is developed to guarantee the approximation precision between the virtual control vaules and the filtered signals ii an anti windup design is developed to deal with the problems of integral saturation of the control input signals iii all types of model uncertainties can be effectively estimated and compensated by the neural networks and adaptive robust techniques which makes the controller easily to implement in practice the rest of this paper is organised as follows in section 2 the problem formulation including the auv kinematic model dynamic model and error systems is established in section 3 the main results of this paper including the trajectory tracking controller design and stability analysis of the overall control system are proposed in section 4 the numerical simulations and comparative analysis are given to evaluate the tracking performance of the proposed controller finally a brief conclusion is drawn in section 5 2 problem formulation 2 1 auv kinematic and dynamic equations here we neglect auv roll dynamics and then consider a 5 dof kinematic and dynamic models of an underactuated auv subject to the external nonlinear disturbances as do 2013 1 x u cos θ cos ψ v sin ψ w sin θ cos ψ y u cos θ sin ψ v cos ψ w sin θ sin ψ z u sin θ w cos θ θ q ψ r cos θ 2 u m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u 1 m 11 τ e u t v m 11 m 22 u r d 22 m 22 v 1 m 22 τ e v t w m 11 m 33 u q d 33 m 33 w 1 m 33 τ e w t q m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 τ q m 55 τ e q t m 55 r m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r 1 m 66 τ e r t where x y z θ and ψ denote the positions i e surge sway and heave displacements and orientations i e pitch and yaw angles of the underactuated auv respectively in the earth fixed frame the signals u v w q and r represent the surge sway heave pitch and yaw velocities respectively in the body fixed frame in fig 1 the signals τ u τ q and τ r denote the auv control inputs produced by thrusters and propellers τ e u τ e v τ e w τ e q and τ e r represent the bounded nonlinear environmental disturbances the positive constant signals m i i i 1 2 3 5 6 represent the inertia and added mass parameters of the auv and d i i i 1 2 3 5 6 represent the hydrodynamic damping coefficients and other signals are introduced in pettersen and egeland 1999 assumption 1 the sway and heave velocities of auv are passive bounded in the sense that sup t 0 v v m and sup t 0 w w m assumption 2 the external nonlinear disturbances are bounded in the sense that τ e k t d k k u v w q r where d k represent the unknown positive constants shojaei 2016 assumption 3 the auv pitch angle is bounded such that θ t θ max π 2 to prevent any possible singularity in the system stability analysis shojaei 2016 2 2 control objectives in this paper our control objective is to develop an adaptive controller to track the following desired trajectory generated by the virtual target auv in fig 1 3 x d u d cos θ d cos ψ d v d sin ψ d w d sin θ d cos ψ d y d u d cos θ d sin ψ d v d cos ψ d w d sin θ d sin ψ d z d u d sin θ d w d cos θ d θ d q d ψ d r d cos θ d 4 u d m 22 m 11 v d r d m 33 m 11 w d q d d 11 m 11 u d 1 m 11 τ u d v d m 11 m 22 u d r d d 22 m 22 v d w d m 11 m 33 u d q d d 33 m 33 w d q d m 33 m 11 m 55 u d w d d 55 m 55 q d ρ g g m l sin θ d m 55 τ q d m 55 r d m 11 m 22 m 66 u d v d d 66 m 66 r d 1 m 66 τ r d where x d y d z d θ d and ψ d denote the desired position and orientation signals in the earth fixed frame o e x e y e z e u d v d w d q d and r d denote the desired velocity signals in the body fixed frame o b x b y b z b τ u d τ q d and τ r d denote the desired control inputs of auv assumption 4 the desired trajectory signals of the auv η d t υ d t η d t υ d t η d t and υ d t are bounded where η d t x d y d z d θ d ψ d t and υ d t u d v d w d q d r d t 2 3 auv error systems the auv error systems are presented in this section according to fig 1 the following transformation can be proposed to let the position and orientation tracking errors in the earth fixed frame transform to the body fixed frame 5 s cos ψ cos θ x x d cos θ sin ψ y y d sin θ z z d e sin ψ x x d cos ψ y y d h cos ψ sin θ x x d sin ψ sin θ y y d cos θ z z d ψ e ψ ψ d θ e θ θ d where s e and h denote the position tracking errors in the body fixed frame then differentiating 5 along with 1 2 3 and 4 yields the following error systems 6 s u e cos θ e 1 cos θ d cos θ cos ψ e 1 u d sin θ e cos θ sin θ d cos ψ e 1 w d cos θ sin ψ e v d r e q h e v e cos θ d sin ψ e u d cos ψ e 1 v d cos θ d sin ψ e w d s tan θ h r h w e sin θ e sin θ cos θ d cos ψ e 1 u d cos θ e 1 sin θ sin θ d cos ψ e 1 w d sin θ d sin ψ e v d tan θ r e q s ψ e r e cos θ r d cos θ cos θ d cos θ d 1 cos θ d sin θ d sin θ e θ e q e where u e u u d v e v v d w e w w d q e q q d r e r r d according to 6 the signals s θ e and ψ e can be directly stabilized by u e q e and r e and the signals θ e and ψ e are chosen to stabilize the signals e and h respectively additionally the following coordinate transformations are employed to avoid whirling around when e and h are very large do 2009 7 z 1 ψ e arcsin k 1 e s 2 e 2 h 2 z 2 θ e arcsin k 2 h s 2 e 2 h 2 where 0 k 1 1 and 0 k 2 1 then substituting 7 into 6 yields the error system as 8 s u e χ 2 χ cos θ d cos θ χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d r e q h ℓ 1 e v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e s tan θ h r ℓ 2 h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d r e k 1 sin θ v d χ 1 e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d tan θ r e q s ℓ 3 z 1 1 k 1 χ 1 1 cos θ s sin θ h cos θ 1 r e k 1 χ 1 1 χ 2 s e u e ϖ 1 ℓ 4 z 2 1 k 2 χ 2 1 s q e k 2 tan θ χ 2 1 e r e k 2 χ 2 1 χ 2 s h u e ϖ 2 ℓ 5 u e m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u 1 m 11 τ e u t u d v e m 11 m 22 u e r e u e r d u d r e d 22 m 22 v e 1 m 22 τ e v t w e m 11 m 33 u e q e u d q e u e q d d 33 m 33 w e 1 m 33 τ e w t q e m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 τ q m 55 τ e q t m 55 q d r e m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r 1 m 66 τ e r t r d where χ 1 s 2 e 2 h 2 χ 1 1 s 2 1 k 1 2 e 2 h 2 and χ 2 1 s 2 e 2 1 k 2 2 h 2 and ℓ 1 cos z 2 1 χ 2 k 2 sin z 2 h cos θ cos θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 u d sin z 2 χ 2 k 2 cos z 2 1 h cos θ sin θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 w d cos θ sin z 1 χ 1 k 1 cos z 1 1 e χ 1 v d ℓ 2 cos θ d sin z 1 χ 1 k 1 cos z 1 1 e χ 1 u d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 v d sin θ d sin z 1 χ 1 k 1 cos z 1 1 e χ 1 w d ℓ 3 sin z 2 χ 2 k 2 cos z 2 1 h sin θ cos θ d cos z 2 1 χ 1 k 1 sin z 1 e χ 1 u d cos z 2 1 χ 2 k 2 sin z 2 h sin θ sin θ d cos z 1 1 χ 1 k 1 sin z 1 e χ 1 w d sin θ sin z 1 χ 1 k 1 cos z 2 1 e χ 1 v d ℓ 4 k 1 ℓ 2 s ℓ 1 e ℓ 2 h ℓ 3 e χ 2 χ 1 1 χ 1 1 cos z 2 χ 2 cos θ 1 k 2 sin z 2 h tan θ d sin z 2 k 2 cos z 2 1 h ℓ 5 k 2 χ 2 1 ℓ 3 h χ 2 s ℓ 1 e ℓ 2 h ℓ 3 ϖ 1 r d χ 1 cos 1 θ d cos θ 1 cos z 2 χ 2 k 2 sin z 2 h cos z 2 1 sin z 2 tan θ d k 2 h cos θ 1 χ 1 k 1 χ 1 v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e s tan θ d h r d e χ 2 s χ 2 χ cos θ cos θ d χ 1 χ χ 1 u d k 1 cos θ χ 1 v d e k 2 h cos θ sin θ d χ 1 χ χ 1 w d e v e k 1 cos θ d χ 1 u d e χ 1 χ χ 1 v d k 1 sin θ d χ 1 w d e h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ χ 1 v d e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d ϖ 2 k 2 χ 2 1 w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ χ 1 v d e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d q s tan θ r e h χ 2 s χ 2 χ cos θ cos θ d χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d e v e k 1 cos θ d u d χ 1 e χ 1 χ χ 1 v d k 1 sin θ d w d χ 1 e h w e k 2 h sin θ cos θ d χ 1 χ χ 1 u d k 1 sin θ v d χ 1 e χ 2 χ sin θ sin θ d χ 1 χ χ 1 w d 3 main results 3 1 controller design in this section a trajectory tracking controller is developed based on the command filter backstepping method neural networks and adaptive control techniques in order to avoid the explosion of complexity in the traditional backstepping control approach the control signals are passed via the following command filter farrell et al 2009 9 κ c 2 λ ϖ n κ c ϖ n 2 κ c κ c 0 where κ c 0 x c o y c o z c o θ c o ψ c o u c o q c o r c o t is the vector of desired control signals κ c x c y c z c θ c ψ c u c q c r c t is the vector of filtered control signals ω n and λ are the parameters of the command filter where 0 ω n 1 and λ 0 and the structure of the filter is shown as fig 2 3 1 1 position control for clarity we define the position dynamics as x u x y u y and z u z and then combine with the kinematic equation 1 we get 10 u c o v w 1 0 0 0 1 0 0 0 1 cos θ c o 0 sin θ c o 0 1 0 sin θ c o 0 cos θ c o cos ψ c o sin ψ c o 0 sin ψ c o cos ψ c o 0 0 0 1 u x c u y c u z c according to 10 the following desired virtual signals can be designed as 11 u c o u x c cos θ c o cos ψ c o u y c cos θ c o sin ψ c o u z c sin θ c o θ c o arcsin w 2 u z c 2 arctan u z c ψ c o arcsin v u x c 2 u y c 2 arctan u y c u x c where u x c cos ψ c o u y c sin ψ c o u x c x c u y c y c and u z c z c then the position dynamics of auv can be written as 12 x y z u x u y u z u x c o u y c o u z c o u x u y u z u x c u x c o u y c u y c o u z c u z c o u x c o u y c o u z c o u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ u ψ θ where u u u c ψ ψ ψ c and θ θ θ c and a cos ψ c cos θ c cos θ sin ψ sin θ b b x 1 b x 2 b y 1 b y 2 0 0 c c x 1 c x 2 c y 1 c y 2 c z 1 c z 2 g θ cos θ 1 θ sin θ θ g ψ cos ψ 1 ψ sin ψ ψ where b x 1 u cos θ cos ψ c v sin ψ c w sin θ cos ψ c b x 2 u cos θ sin ψ c v cos ψ c w sin θ sin ψ c b y 1 u c cos θ c sin ψ c v cos ψ c w sin θ sin ψ c b y 2 u c cos θ c cos ψ c v sin ψ c w sin θ cos ψ c c x 1 u cos θ c cos ψ c w sin θ c cos ψ c c x 2 u cos θ c cos ψ c w sin θ c cos ψ c c y 1 u c sin ψ cos θ c w sin θ c sin ψ c c y 2 u c sin ψ cos θ c w cos θ c sin ψ c c z 1 u c sin θ c w cos θ c c z 2 u c cos θ c w sin θ c then we consider the following desired velocities in the earth fixed frame as 13 u x c o α x x u x c u y c o α y y u y c u z c o α z z u z c where x x x c y y y c and z z z c α x α y and α z are the unknown positive constants substitute 13 into 12 and the position dynamic error system can be rewritten as 14 x y z α x x α y y α z z u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ u ψ θ 3 1 2 attitude control for the pitch and yaw control we define the following signals 15 q c o α θ θ θ c θ b s r c o α ψ ψ ψ c ψ b s where θ θ θ c ψ ψ ψ c α θ α ψ are the known positive constants θ b s and ψ b s represent the robust terms designed in section 3 2 based on this definition 15 the closed loop attitude dynamic errors can be proposed as 16 θ q c o q q c q c q c o α θ θ θ c θ b s q q c q c o θ α θ θ θ b s q q c q c o ψ r c o r r c r c r c o cos θ α ψ ψ ψ c ψ b s r r c r c o cos θ ψ α ψ ψ ψ b s r r c r c o r c o cos θ 3 1 3 velocity and angular velocity control we define the velocity errors as u u u c q q q c and r r r c and then the dynamic error equations can be proposed as 17 m 11 u m 22 v r m 33 w q m 11 u c d 11 u τ u τ e u t m 55 q m 33 m 11 u w m 55 q c d 55 q ρ g g m l sin θ τ q τ e q t m 66 r m 11 m 22 u v m 66 r c d 66 r τ r τ e r t then the controllers τ u τ q and τ r can be designed as 18 τ u m 11 α u u α i u ε u u b s ℓ u τ q m 55 α q q α i q ε q q b s ℓ q τ r m 66 α r r α i r ε r r b s ℓ r where ε u u d t ε q q d t ε r r d t α u α q and α r are unknown positive constants u b s q b s and r b s are the robust terms designed in section 3 2 and ℓ u ℓ q and ℓ r are proposed as 19 ℓ u m 22 v r m 33 w q d 11 u m 11 u c ℓ q m 33 m 11 u w d 55 q ρ g g m l sin θ m 55 q c ℓ r m 11 m 22 u v d 66 r m 66 r c 3 1 4 adaptive neural network control in this section to solve the problems of model uncertainties and nonlinear disturbances in the system the radial basis function neural networks rbfnns are employed due to their simplicity and linear parameterization the structure of a typical three layer radial basis function neural network is shown as fig 3 then we define x u v w q r θ u c q c r c t is the input vector of nns f x ℓ u ℓ q ℓ r t is the unknown function in the system and f x can be approximated by the following three layer radial basis function neural network with k nodes 20 f ˆ x w w ξ x where w w u 1 w u 2 w u k w q 1 w q 2 w q k w r 1 w r 2 w r k w u t w q t w r t w is the adjustable weight matrix of the neural network system and ξ x ξ 1 x ξ 2 x ξ 3 x ξ k x t is a neural basis function vector where ξ i x is the basis function which is chosen as the following n t h gaussian functions 21 ξ i x exp x η i 2 μ i 2 i 1 2 3 k where η i and μ i are the centre vector and the standard deviation respectively then we define the optimal weight matrix w as 22 w arg min w ω sup x u f x f x w where ω and u are the compact sets of x and w respectively and then we define the neural network approximation error e x as 23 e x f x f ˆ x w in this paper w represents the estimation of w which is usually estimated by an adaptive rule based on the lyapunov stability theory and the estimation error can be defined as w w w finally the unknown nonlinear function is conducted as 24 f x w ξ x e x where e x satisfies e x e m e m is an unknown positive constant as a result the controller in surge direction is rewritten as 25 τ u m 11 α u u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u w u λ w u u ξ t x λ w u γ u w u ρ u λ ρ u u λ ρ u κ u ρ u ρ u 0 where α u α i u δ u λ w u γ u λ ρ u κ u ρ u 0 are the unknown positive parameters controller in pitch direction is rewritten as 26 τ q m 55 α q q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q w q λ w q q ξ t x λ w q γ q w q ρ q λ ρ q q λ ρ q κ q ρ q ρ q 0 where α q α i q δ q λ w q γ q λ ρ q κ q ρ q 0 are the unknown positive parameters controller in yaw direction is rewritten as 27 τ r m 66 α r r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r w r λ w r r ξ t x λ w r γ r w r ρ r λ ρ r r λ ρ r κ r ρ r ρ r 0 where α r α i r δ r λ w r γ r λ ρ r κ r ρ r 0 are the unknown positive parameters then we substitute 25 26 and 27 into 2 and get the following error dynamics 28 m 11 u m 11 α u u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t m 55 q m 55 α q q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t m 66 r m 66 α r r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t by defining ε u u ε q q and ε r r 28 is rewritten as 29 m 11 ε u m 11 α u ε u α i u ε u u b s w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t m 55 ε q m 55 α q ε q α i q ε q q b s w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t m 66 ε r m 66 α r ε r α i r ε r r b s w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t then by defining ε ε u ε q ε r t and e ε t ε t t and 29 is finally rewritten as 30 e m e τ n where μ 0 3 3 i 3 3 p i 3 3 p k 3 3 t 0 3 3 i 3 3 n u b s m 11 1 w u ξ x ρ u tanh ν ρ u u δ u ℓ u τ e u t q b s m 55 1 w q ξ x ρ q tanh ν ρ q q δ q ℓ q τ e q t r b s m 66 1 w r ξ x ρ r tanh ν ρ r r δ r ℓ r τ e r t p k 3 3 d i a g α u α q α r p i 3 3 d i a g α i u α i q α i r remark 1 it is very necessary to point out that the measurement of auvs parameters are not easy therefore a weakness of this controller is the dependence of the proposed control laws to inertial parameters including m 11 m 55 and m 66 in 25 26 and 27 3 1 5 filter error compemsation loop design in this section a filter error compensation loop is designed to guarantee the approximation precision between the virtual signals and the filtered signals we define the position filtered compensation errors as 31 ϑ x x χ x ϑ y y χ y ϑ z z χ z where χ x χ y and χ z are designed as 32 χ x χ y χ z α x χ x α y χ y α z χ z u x c u x c o u y c u y c o u z c u z c o a b g ψ c g θ χ u χ ψ χ θ where χ x 0 χ y 0 χ z 0 0 χ ψ χ θ are designed in 37 and then combine 12 and 32 we get 33 ϑ x ϑ y ϑ z α x ϑ x α y ϑ y α z ϑ z a b g ψ c g θ ϑ u ϑ ψ ϑ θ where ϑ u u χ u ϑ ψ ψ χ ψ and ϑ θ θ χ θ then we consider the following lyapunov function as 34 v x y z 1 2 ϑ x 2 ϑ y 2 ϑ z 2 differentiating 34 along with 12 and 33 we get 35 v x y z ϑ x ϑ x ϑ y ϑ y ϑ z ϑ z α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 ϑ x ϑ y ϑ z a b g ψ c g θ χ u χ ψ χ θ α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 a t ϑ x ϑ y ϑ z t ϑ u g t ψ b t ϑ x ϑ y ϑ z ϑ ψ g t θ c t ϑ x ϑ y ϑ z ϑ θ then we define the pitch and yaw angle filter compensation errors as 36 ϑ ψ ψ χ ψ ϑ θ θ χ θ where χ ψ and χ θ are defined as 37 χ ψ r c r c o χ r cos θ α ψ χ ψ χ θ q c q c o χ q α θ χ θ where χ ψ 0 χ θ 0 χ r χ q 0 then we consider a new lyapunov function as 38 v ψ θ 1 2 ϑ ψ 2 ϑ θ 2 differentiating 38 along with 16 and 37 we get 39 v ψ θ ϑ ψ ϑ ψ ϑ θ ϑ θ ψ χ ψ ϑ ψ θ χ θ ϑ θ r cos θ α ψ ψ ψ b s α ψ χ ψ χ r cos θ ϑ ψ α θ θ q θ b s α θ χ θ χ q ϑ θ α ψ ϑ ψ 2 α θ ϑ θ 2 ϑ r cos θ ϑ ψ ϑ q ϑ θ ψ b s ϑ ψ θ b s ϑ θ where ϑ q q and ϑ r r 3 1 6 anti windup design in this section an anti windup design is developed to avoid the problems of integral saturation of the control input signals the anti windup design is proposed as 40 u s u m u u m u u m u u m u m u u m where u τ u τ q τ r t is the control input vector u s is the control input vector after the anti windup design u m is the limited amplitude of control input signals as a result the controller of anti windup part is proposed as 41 u u s δ s u u s d t where δ s denotes the unknown positive parameter as shown in fig 4 a block diagram of the trajectory tracking control system is proposed in the next section the essential stability proof for the overall control system is proposed 3 2 stability analysis of the overall control system in this section the closed loop stability of the trajectory tracking control system is proposed as the first step we consider the following lyapunov function 42 v v x y z v ψ θ 1 2 e t k e 1 2 k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u 2 m 11 λ ρ u k 22 ρ q 2 m 55 λ ρ q k 23 ρ r 2 m 66 λ ρ r 1 2 ϑ x 2 ϑ y 2 ϑ z 2 ϑ ψ 2 ϑ θ 2 e t k e 1 2 k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u 2 m 11 λ ρ u k 22 ρ q 2 m 55 λ ρ q k 23 ρ r 2 m 66 λ ρ r where k k 1 0 3 3 0 3 3 k 2 is a positive definite symmetric matrix k i d i a g k i 1 k i 2 k i 3 i 1 2 and w k w k w k ρ k ρ k ρ k k u q r then by differentiating 42 along with 30 35 and 39 we get 43 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α θ ϑ θ 2 α ψ ϑ ψ 2 e t η e a t ϑ x ϑ y ϑ z ϑ u g t ψ b t ϑ x ϑ y ϑ z ϑ ψ g t θ c t ϑ x ϑ y ϑ z ϑ θ ϑ r cos θ ϑ ψ θ b s ϑ θ ψ b s ϑ ψ ϑ q ϑ θ k 21 ϑ u u b s k 22 ϑ q q b s k 23 ϑ r r b s k 21 m 11 1 ϑ u w u ξ x ρ u tanh ν ρ u u δ u e w u τ e u t k 22 m 55 1 ϑ q w q ξ x ρ q tanh ν ρ q q δ q e w q τ e q t k 23 m 66 1 ϑ r w r ξ x ρ r tanh ν ρ r r δ r e w r τ e r t k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u ρ u m 11 λ ρ u k 22 ρ q ρ q m 55 λ ρ q k 23 ρ r ρ r m 66 λ ρ r where h 1 2 m t k m a 1 2 0 3 3 p i k 2 k 1 p i k 2 k 1 2 p i k 2 then let choose κ 1 p i k 2 and we get h 0 3 3 0 3 3 0 3 3 p i k 2 then we design the robust terms ψ b s θ b s u b s q b s and r b s as 44 ψ b s g t ψ b t ϑ x ϑ y ϑ z θ b s g t θ c t ϑ x ϑ y ϑ z u b s 1 k 21 a t ϑ x ϑ y ϑ z 45 q b s ϑ θ k 22 r b s ϑ ψ k 23 cos θ substitute 44 and 45 into 43 and we get 46 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α ψ ϑ ψ 2 α θ ϑ θ 2 e t h e k 21 m 11 1 ϑ u w u ξ x ρ u tanh ν ρ u u δ u e w u τ e u t k 22 m 55 1 ϑ q w q ξ x ρ q tanh ν ρ q q δ q e w q τ e q t k 23 m 66 1 ϑ r w r ξ x ρ r tanh ν ρ r r δ r e w r τ e r t k 21 w u t w u m 11 λ w u k 22 w q t w q m 55 λ w q k 23 w r t w r m 66 λ w r k 21 ρ u ρ u m 11 λ ρ u k 22 ρ q ρ q m 55 λ ρ q k 23 ρ r ρ r m 66 λ ρ r then 46 is expressed as follows by considering lemma polycarpou 2002 inequality h x x h tanh ν h x δ δ t holds for any δ t 0 where ν e ν 1 w k t w k a 1 w k f 2 a 2 w k f 2 ρ k ρ k ρ k 0 a 1 ρ k 2 a 2 ρ k ρ k 0 2 e w k τ e k ρ k k u q r with a 1 1 0 5 σ 2 a 2 0 5 σ 2 and σ 2 2 and combine with 25 26 and 27 47 v α x ϑ x 2 α y ϑ y 2 α z ϑ z 2 α ψ ϑ ψ 2 α θ ϑ θ 2 e t h e a 1 γ u k 21 m 11 1 w u f 2 a 1 γ q k 22 m 55 1 w q f 2 a 1 γ r k 23 m 66 1 w r f 2 a 1 κ u k 21 m 11 1 ρ u 2 a 1 κ q k 22 m 55 1 ρ q 2 a 1 κ r k 23 m 66 1 ρ r 2 a 2 γ u k 21 m 11 1 w u f 2 a 2 γ q k 22 m 55 1 w q f 2 a 2 γ r k 23 m 66 1 w r f 2 a 2 κ u k 21 m 11 1 ρ u ρ u 0 2 a 2 κ q k 22 m 55 1 ρ q ρ q 0 2 a 2 κ r k 23 m 66 1 ρ r ρ r 0 2 δ u δ q δ r as a result 47 can be finally expressed as the following differential inequality 48 v t κ min κ max v t δ where κ max max 1 κ k k 21 m 11 λ w u k 22 m 55 λ w q k 23 m 66 λ w r k 21 m 11 λ ρ u k 22 m 55 λ ρ q k 23 m 66 λ ρ r κ min min α x α y α z α θ α ψ κ h κ w u κ w q κ w r κ ρ u κ ρ q κ ρ r κ w u a 1 γ u k 21 m 11 1 κ w q a 1 γ q k 22 m 55 1 κ w r a 1 γ r k 23 m 66 1 κ ρ u a 1 κ u k 21 m 11 1 κ ρ q a 1 κ q k 22 m 55 1 κ ρ r a 1 κ r k 23 m 66 1 κ p denotes the maximum value in matrix k κ h represents minimum value in matrix h and 49 δ a 2 γ u k 21 m 11 1 w u f 2 a 2 γ q k 22 m 55 1 w q f 2 a 2 γ r k 23 m 66 1 w r f 2 a 2 κ u k 21 m 11 1 ρ u ρ u 0 2 a 2 κ q k 22 m 55 1 ρ q ρ q 0 2 a 2 κ r k 23 m 66 1 ρ r ρ r 0 2 δ u δ q δ r finally this result indicates that all the signals for the overall control system are uniformly ultimately bounded and the trajectory tracking errors ultimately converge to a small neighborhood of the zero this completes the proof 4 numerical simulations in this section numerical simulations are carried out to evaluate the effectiveness and robustness of the presented controller all simulations are performed using matlab software environment for the simulation of a real auv we choose a new flying wing auv fig 5 possessed excellent hydrodynamic properties and its parameters are introduced in wang et al 2018 in order to simulate a more realistic auv we assume that the parameters of auv are unknown completely and the auv is affected by the following environment disturbances 50 d t t d t k ω where d t τ e u t τ e v t τ e w t τ e q t τ e r t t is the vector of environment disturbances ω represents the high frequency measurement noise which has the largest amplitude of ω 1 t diag 100 100 100 100 100 represents the time constant matrix and k diag 10 5 5 10 10 denotes gain parameter matrix then we suppose that auv is required to track the following trajectory 51 x d t a cos ω r t y d t a sin ω r t z d t 2 ω r t a where a 50 ω r π 125 a 1 the initial positions of the auv is given by x 0 10 m y 0 5 m z 0 0 m the initial pitch and yaw angles are provided by θ 0 0 and ψ 0 0 respectively the initial velocities of auv are given by u 0 m s v 0 m s and w 0 m s in the numerical simulation the controller parameters are given by α x 20 α y 10 α z 10 α ψ α θ 8 α u 20 α q α r 10 α i u 5 α i q α i r 5 k 21 10 k 22 k 23 5 and the parameters of the filter are set to ω n 20 r a d s and λ 0 95 furthermore the parameters of rbf neural network with ten hidded nodes proposed in this paper are given by λ w u 20 λ w q 20 λ w r 20 γ u 0 1 γ q 0 1 γ r 0 1 λ ρ u 6 λ ρ q 6 λ ρ r 6 κ u 0 2 κ q 0 2 κ r 0 2 and the centre vector and the standard deviation are chosen as η i 10 8 6 4 2 2 4 6 8 10 t and μ i 20 based on the k clustering method zhang and chu 2012 respectively w is a 3 10 matrix and the initial vaule of w is set to 0 finally the simulation results by using command filter based adaptive neural tracking cfant control the robust smc zhang et al 2016 and the traditional backstepping control are illustrated in figs 6 13 where controller by using traditional backstepping method is shown in appendix a fig 6 depicts the trajectory of the auv in the three dimensional space figs 7 and 8 depict the horizontal plane projection and vertical plane projection for the 3d trajectory respectively and it can be seen that the auv can successfully follow the desired trajectory regardless of the parameter uncertainties and external disturbance as shown in fig 9 the trajectory errors ultimately converge to a small neighborhood of zero and the proposed controller is higher accuracy of trajectory tracking compared with the traditional backstepping control and the sliding mode control velocity response and angle response are shown as figs 10 and 11 and it can be seen that the cfant controller is not sensitive to the environmental disturbances which reveals that cfant controller is of good robustness fig 12 shows that the model uncertainties in the system can be efficiently and accurately compensated by the rbf neural networks finally the control signals for the three methods are shown in fig 13 5 conclusion this brief addresses the 3d trajectory tracking problem of underactuated auv in the presence of model uncertainty unmodeled dynamics and external environment disturbances a design controller is proposed based on command filtered backstepping method rbf neural network and adaptive control techniques a second order filter is designed to obtain derivative of virtual control signals which not only avoids the inherent explosion of complexity but also filters out system high frequency measurement noise moreover a filtered error compensation loop is developed to guarantee the approximation precision between virtual control signals and filtered signals and an emtimator is designed where a rbf neural network system is employed to emtimate and approximate the total uncertainties in the control system the stability of the closed loop system is analyzed based on the lyapunov stability theory finally the simulation results substantiate the effectiveness and good robustness of the proposed tracking controller for the futurework it is of interest to extend these results to cooperative trajectory tracking of underactuated auvs for the futurework the target tracking problems with limited control torques can be developed liu et al 2018 and it is of interest to extend these results to the constrained control of the underactuated auvs peng et al 2018 acknowledgments the authors acknowledge support by the national natural science foundation of china nsfc grant nos 11672094 appendix a conventional backstepping controller according to 8 the conventional backstepping tracking controller for the underactuated auv is proposed as follows τ u m 11 λ 1 u e m 22 m 11 v r m 33 m 11 w q d 11 m 11 u e d u d u d u e d k 1 χ 1 1 χ 1 2 s e z 1 k 2 χ 2 1 χ 2 s h z 2 τ q m 55 λ 2 q e m 11 m 33 m 55 u w d 55 m 55 q e d q d ρ g g m l sin θ m 55 q d q e d 1 k 2 χ 2 1 s z 2 τ r m 66 λ 3 r e m 11 m 22 m 66 u v d 66 m 66 r e d r d r d r e d k 2 tan θ χ 2 1 e z 2 1 k 1 χ 1 1 cos θ s sin θ h z 1 cos θ where u e d k 0 χ 1 s χ 2 χ cos θ d cos θ χ 1 χ χ 1 u d k 1 cos θ v d χ 1 e k 2 h cos θ sin θ d χ 1 χ χ 1 w d r e d cos θ c 1 z 1 k 1 χ 1 1 χ 2 s e u e d ϖ 1 ℓ 4 1 k 1 χ 1 1 cos θ s sin θ h cos θ q e d c 2 z 2 2 k 2 tan θ χ 2 1 e r e d k 2 χ 2 1 χ 2 s h u e d ϖ 2 ℓ 5 1 k 2 χ 2 1 s futhermore parameters of the conventional backstepping controller are given by k 0 1 k 1 0 5 and k 2 0 5 c 1 c 2 2 λ 1 λ 2 λ 3 4 
22858,calibration of double peaked spectra based on partitioning of frequency spectra sometimes starts by assuming that relations existing between two observed peaks are valid through the calibration procedure here often two facts are overlooked each system i e swell and wind sea systems in a typical double peaked spectrum contributes to the other one and swell system in its peak zone is highly asymmetric actually peak spectral densities and corresponding peak frequencies of partitioned systems are different from those observed in an integrated double peaked spectrum besides those observed as peak values are not good candidates of the peak due to the asymmetry of swell system to highlight these issues we examine 2 different methods to fit 2 jonswap spectra to double peaked spectra observed in 2 series of measurement in the northern part of the gulf of oman i e 2006 2007 and 2016 one which directly uses observed values and the other which adjusts them discussing such we introduce two modifications one dependent and one independent of measurements here we address how data gathered from integrated double peaked spectra can be modified to maximize accuracy of results this is what less addressed by studies focusing on calibration of spectra while it is of great importance in practice keywords wave systems overlap measurement calibration methods partitioning swell system wind sea system 1 introduction accurate description of a wave spectrum is of great importance for designing coastal and offshore structures in recent decades many attempts have been made to describe ocean waves by introducing wave spectral models however apparently starting by bretschneider spectrum bretschneider 1959 historically the major part of studies have focused on the spectra generated by local wind unimodal spectra called wind sea system sometimes waves arriving from remote areas called swell system combine with wind sea system resulting in emerging bimodal spectra the former type of spectra usually represents one peak however the later one is known as double peaked spectra it should be noted that wave wave interactions also could result in appearance of additional peaks as such interactions affect wave period for example it was discussed that nonlinear triad wave wave interactions change the spectral shape by the generation of both lower and higher harmonic components freilich and guza 1984 all in all it should be noted that spectra might have more than two peaks a situation which has been less investigated however a precise description of double peaked spectra significantly affects sea keeping safety offshore structures design small boat operations and ship passage over harbor entrance wang and hwang 2001 strekalov et al are the pioneers working on double peaked spectra strekalov et al 1972 they implemented a normal distribution for swell system and a pierson moskowitz spectrum for wind sea system later ochi and hubble developed a series of bimodal spectra involving six parameters over 800 observed spectra at the north atlantic ocean while dividing observed spectra into two low frequency and high frequency systems ochi and hubble 1976 they expressed each system with a gamma function a general and flexible function capable of adjusting well to data this spectrum was investigated frequently especially in the region under study gulf of oman panahi et al 2015 panahi et al 2016 golpira et al 2019 guedes soares on the other hand proposed a four parameter theoretical formulation to represent double peaked spectra while he provided an excellent fit to 1000 measured wave spectra from north atlantic ocean and 6000 wave spectra from north sea by combining two jonswap spectrum guedes soares 1984 this assumption about swell spectra i e swell always start from a wind sea system was based on early findings by goda goda 1983 which were recently confirmed by lucas and guedes soares lucas and guedes soares 2015 then he proposed the use of jonswap models with average values of the lateral parameters and of the peak enhancement factor resulting in simple 4 parameters spectrum guedes soares 1984 this model was later applied to a larger data set of spectra from portugal and the parameters were determined in the form of scatter diagrams guedes soares and nolasco 1992 later investigation showed that the mean period as a main input of such method is sensitive to noises in the low or very high frequency tails which consequently might result in inaccurate determination of peak frequencies when using that method so guedes soares and henriques proposed a new method which uses observed peak frequencies instead of mean period in fitting guedes soares and henriques 1998 later torsethaugen used original jonswap spectrum with 5 parameters as he had access to extensive measurements at statfjord field in norwegian waters here a criterion was introduced to distinguish swell dominated and wind dominated spectra and different formulation was proposed for them torsethaugen 1993 accordingly he simplified his model to be more applicable by reducing free parameters torsethaugen 2004 very close to the idea of guedes soares guedes soares 1984 all in all in calibration of double peaked spectra we can identify two basic approaches partitioning of bimodal wave spectra into wind sea and swell systems and then fitting a spectral function to each component assigning an average spectral shape based on the integrated spectral parameters for the first approach it is developed using either frequency spectrum guedes soares 1984 guedes soares and henriques 1998 panahi et al 2015 or frequency direction spectra hanson and phillips 2001 for the second approach which is more like a pure mathematical approach it is frequently used with different fitting algorithms e g generalized least square method an investigation by evans et al shows that outputs of the first approach are not materially different evans et al 2006 while the one based on frequency spectrum sometime performs better besides they argued that significant wave height and mean period of separate systems in the first approach are consistent with expectations while this is often not the case with the second approach which usually uses general information of an integrated spectrum for instance when using torsethaugen spectrum in the second approach it only requires significant wave height and peak frequency of measured double peaked spectrum although it is still possible to use this spectrum in the first approach panahi et al 2015 the first approach is implemented in this study to treat wind sea and swell systems separately following guedes soares 1984 in this study jonswap spectrum is applied on both systems to examine 2 different calibration methods in the first method we insert significant wave height of double peaked spectra two observed peak frequencies and the ratio of the observed maximum spectral ordinates into the fitting procedure while satisfying the relation between zeroth order spectral moment of sea spectrum and those of its systems for the second try we just insert significant wave height of double peaked spectra while satisfying the aforementioned relation this automatically yields to determination of significant wave heights and peak frequencies of partitioned systems representing the best fit considering a predefined error by discussing such we introduce two modified methods one dependent and one independent of measurements benefiting from 2 series of measurement in the gulf of oman i e 2006 2007 and 2016 it should be noted that the second series of measurement was conducted in response two extensive port development plans at this region panahi et al 2017 so the rest of this paper is structured as follows section 2 explains local measurements followed by the methodology in section 3 results including assessment of available methods and new methods are represented in section 4 finally the conclusion can be found in section 5 2 local measurements the wave data in this study have been extracted from a series of measurement conducted in 2016 at seven stations in northern parts of the gulf of oman using nortek acoustic wave and current profiler awac 2018 the location of such stations is illustrated in fig 1 together with stations investigated earlier in 2006 2007 details of each station are presented in table 1 it is evident that new measurements cover a wider area more than 210 km than the previous one less than 10 km the procedure is similar to what was proposed earlier by panahi et al 2015 in which nortek storm v1 14 is used with setting briefly represented in table 2 by targeting those peaks in the time history with significant wave height higher than 0 9 m here we apply the methodology used to identify and select the double peaked spectra described in guedes soares and nolasco 1992 this helps to take into account the statistical uncertainty in the estimation of the spectral densities which might lead to considering a unimodal spectrum as a bimodal one by applying the criterion proposed by torsethaugen torsethaugen 1993 this early step results in total of 417 wind dominated spectra and 823 swell dominated spectra fairly distributed over all the stations respectively in order to avoid statistical dependency of events further we divide time histories into two days intervals and pick only one event per interval here it should be noted that there are methods including more detailed steps to remove correlated event guedes soares and ferreira 1996 but as the length of storms in the region under study is generally less than 48 h we choose that simple criterion such a procedure leads to a total of 224 wind dominated and 388 swell dominated spectra the sample used to apply fitting methods as will be discussed in section 3 here it should be noted that the share of double peaked spectra in the region considering the location of measurement stations is about 30 for all stations 3 methodology by representing the sea spectrum as the sum of two separate frequency spectra each responsible for an individual system we will have the following 1 s f s s f s w f in which s s f and s w f represent swell and wind sea systems respectively consequently its moments must be theoretically equal to the sum of moments of the systems 2 m 0 m 0 s m 0 w 3 m 1 m 1 s m 1 w in which m 0 and m 1 are zeroth and first order spectral moments of the sea spectrum m 0 s and m 1 s are those of swell system and m 0 w and m 1 w belongs to wind sea system considering the relation for significant wave height of the sea spectrum h s 4 m 0 and the one for its mean period t z m 0 2 π m 1 eq 2 and eq 3 can be rewritten as follows 4 h s 2 h s s 2 h s w 2 5 m 0 t z m 0 s t z s m 0 w t z w where h s s and h s w stand for significant wave height of swell and wind sea systems respectively besides t z s and t z w are mean periods of swell and wind sea systems initiated by guedes soares in 1984 many investigations show that jonswap spectrum can appropriately represent swell and wind sea systems guedes soares 1984 guedes soares and nolasco 1992 torsethaugen 1993 guedes soares and henriques 1998 lucas and guedes soares 2015 panahi et al 2015 the spectrum used in this study by adding an extra and somewhat artificial factor to the pierson and moskowitz spectrum pierson and moskowitz 1964 called peak enhancement factor γ jonswap spectrum was introduced as follows hasselmann et al 1973 6 s j o n s w a p f c f f p 5 e x p 5 4 f f p 4 γ a 7 a e x p f f p 2 2 σ 2 f p 2 8 σ 0 07 0 09 f f p f f p where f p stands for the peak frequency besides among different forms of the constant c the one depending on the significant wave height h s is adopted here goda 1979 9 c 5 16 h s 2 f p 1 15 0 1688 γ 0 925 1 909 γ 1 in order to fit two jonswap spectra we need four inputs significant wave height of swell system h s s and its peak frequency f p s together with significant wave height of wind sea system h s w and its peak frequency f p w in the meantime two related peak enhancement factors should be calibrated benefiting from eq 4 and eq 5 guedes soares proposed a practical method to calculate aforementioned four inputs using the following data directly picked from observed double peaked spectra h s h s t z t z t z s t z w f p w f p s assumed to be equal to the ratio of peak frequency of individual systems f p w f p s and s s f p s s w f p w ratio of maximum spectral ordinates assumed to have the following relation if systems are represented by jonswaps spectra guedes soares 1984 10 s s f p s s w f p w s f p s s f p w h s s 2 h s w 2 f p w f p s 1 15 0 1688 γ w 0 925 1 909 γ w γ s a s 1 15 0 1688 γ s 0 925 1 909 γ s γ w a w where tilde accent represents those values picked directly from observed spectra here by assuming γ s and γ w h s s 2 h s w 2 is calculated by eq 10 considering f p w f p s f p w f p s then eq 4 is implemented to extract h s s and h s w considering h s h s while knowing these values and assuming that t z s t z w f p w f p s values of t z s and t z w are calculated by eq 5 consequently f p s and f p w are obtained as a functions of mean periods as introduced by guedes soares 1984 here we have all four required inputs to draw two jonswap models and represent double peaked spectra based on eq 1 here it should be noted that the original form of equations introduced by guedes soares 1984 is based on equal peak enhancement factors i e γ s γ w leading to simple forms this is mostly the case for later studies as such values are free in our research we are using the complete form of equations we will discuss this later in section 4 later it was argued that the method sometimes fails to predict location of peak frequencies in low significant wave height sea states in which the sea spectrum often includes more than two peaks consequently t z which is very sensitive to noises in the low and very high frequency tails would be miscalculated while it is one of the basics of the calibration method then a new method was proposed to overcome this difficulty by overlooking eq 5 and simple replacement of mean period with observed peak frequencies so four necessary inputs were provided by using the following data directly picked from observed double peaked spectra h s h s f p s f p s f p w f p w and s p s s p w s p s s p w guedes soares and henriques 1998 subsequently this method was investigated and approved over other measured data evans et al 2006 it should be noted that this method does not take care of the relation between first order spectral moments in fact benefitting from jonswap spectra while picking those peak frequencies from observation comes at the cost of overlooking eq 5 as with jonswap curve we can not accurately reproduce areas to satisfy relation for the first order spectral moments in other words there is no need to estimate peak frequencies from mean periods and such values are exactly those of integrated observed double peaked spectrum the method is further examined in this study called method1 as represented in fig 2 a in reality meaningful overlap zone stands between swell and wind sea systems therefore we must be aware of the difference between data read from measured spectra and those contribute to imaginary exact spectra representing swell and wind sea systems in a simple word a part of observed s p w may be related to the contribution of swell part and vice versa and on the other hand observed peak frequencies may also differ from the actual ones besides yet we have no means to accurately extract such shapes and all our calibration efforts resulting in best fits still have errors due to pre defined form of our assumed spectral models e g jonswap model so while picking any data from peaks of integrated double peaked spectra as representatives of peaks of partitioned systems we accumulate two types of errors which are overlooked as long as results are of acceptable accuracy so by fixing the form of jonswap model in this study our main target is to further address the first type of error here we also investigate the share of peak spectral ordinates and peak frequencies in accuracy of resultant double peaked spectra after picking spectral values of an event i e f p s f p w s p s and s p w we have s s f and s w f as introduced by method1 but as such spectra have overlap in some events we can apply a slight modification and propose method1 as represented in fig 2 b here by subtracting s w f p s from s f p s and applying the same for the second observed peak s f p w s s f p w we have updated spectral density values in which the share of the other system is somehow excluded so we can follow method1 with such updated spectral densities rather than the original ones directly picked from the observed spectra and the only difference is an update in eq 10 as follows 11 s s f p s s w f p w s f p s s w f p s s f p w s s f p w as eq 11 is used to determine h s s and h s w method1 becomes repetitive here we initialize h s s as suggested by guedes soares 1984 and use them to calculate the ratio in eq 11 by determining s w f p s and s s f p w in the first try after calculating new significant wave heights using eq 4 and eq 11 they are updated in s w f p s and s s f p w and such equations are solved again to find new significant wave heights as another method in this regard we offer method2 as represented in fig 2 c to find the best combination of four required inputs while keeping eq 4 as it stands for energy conservation so here we have three free independent variables one significant wave height and two peak frequencies while the other significant wave height should be calculated from the first one with respect to eq 4 simply we can adjust and calculate them through a simple calibration procedure while minimizing a well defined error to achieve this calibrated values are determined by starting from initial values as outputs of method1 and iteratively changing them in an interval around those values to minimize the error of the resultant spectrum compared to the observed one it should be noted that in a similar effort done by lucas and guedes soares 2015 to investigate the ability of the jonswap spectrum to describe swell spectra both eq 4 and eq 5 were overlooked so by targeting the final error there all four required inputs of two jonswap spectra were treated as independent variables to determine the best fit to measured spectra this method which sacrifices the conservation of energy is less theoretically concrete when compared to above mentioned methods as it does not take care of the both zeroth and first order spectral moments relations changing the prospect to offshore engineers engaged with design of floating structures we want to know which double peaked spectrum works better with what inputs a question which is less addressed compared to extensive spectra fitting attempts in other words based on aforementioned methods many researchers examine different types of spectra and offer a specific one for a region but they rarely notice how measured data must be substituted into developed spectra in practice as noted earlier researchers are aware of uncertainties of observed maximum spectral ordinates and peak frequencies in terms of existing overlap between the two systems so by introducing method2 we want to examine if it is possible to stick to the method1 as a direct method with simple modification of data picked from measured spectra so we are discussing how observed f p s f p w s p s s p w used in method1 can be modified considering outputs of method2 resulting in f p s m f p w m and s p s s p w m by introducing calibration coefficients in other words adjusted values of method2 can be interpreted as calibration coefficients for those values picked from measured double peaked spectra in method1 this is called method1 as represented in fig 2 d and examined against other methods in section 4 2 in this study deviation index d i introduced by liu liu 1983 and implemented by guedes soares and henriques guedes soares and henriques 1998 is adopted as follows 12 d i i 1 n 100 s f i s f i s f i s f i δ f m 0 in this normalized weighted index s stands for the calibrated spectrum and s is the measured one based on investigations of silva in 1988 reported by guedes soares and henriques any value of d i lower than 70 seems satisfactory guedes soares and henriques 1998 although generalized least square method used in this study leads to the minimum error 4 results and discussions 4 1 comparison of calibration methods in order to investigate performance of calibration methods we consider two types of classification as they represent distinct aspects firstly we divide events into wind sea dominated and swell dominated event as discussed earlier in section 2 we further divide such events into those with or without overlap between their peaks when drawing separate spectra following the idea behind eq 1 we can see events in which s s f or s w f has clear presence near the peak frequency of the other one i e spectral density of one system represented by jonswap model using method1 is at least 10 of the observed peak spectral density of the other system which we mark them as events with overlapped systems in contrast there are events in which systems are diminished near the peak frequency of the other one similarly they are called as events with non overlapped systems investigations show that the share of events with overlapped systems is about 20 in wind sea dominated spectra while this is about 67 for swell dominated events in total considering the tail of jonswap spectrum this is reasonable as it results in more swell dominated overlapped events rather than sea dominated overlapped ones here it should be noted that at this stage only we focused on data of 2016 measurement project at the region to investigate calibration methods and calculate required parameters later the data of 2006 2007 measurements project are used in sub section 4 2 to verify introduced modifications performance of method1 and method2 in representation of the sea state is illustrated in figs 3 and 4 for typical events with overlapped systems and non overlapped systems respectively as shown in these figures there are two main reasons behind inaccuracy share of one system into the other one and the position of swell system s peak frequency in comparison to that of wind sea system these two factors somehow are taken into consideration by method2 when compared to method1 method2 does not keep the initial ratio of maximum spectral ordinates determined based on observation fixed within the calibration procedure so it is possible for the ratio to be tuned to reach the lowest amount of d i in this method comparing figs 3 and 4 it is evident that this factor loss its importance when we have events with non overlapped systems but for the second factor it is significant in both events with overlapped and non overlapped systems here method2 relaxes changes of peak frequencies consequently we can expect higher differences between outputs of method1 and method2 for the swell system especially in swell dominated events considering the form of jonswap model this is obvious in both figs 3 and 4 in other words as the form of swell system is different from that of wind sea system either in wind sea dominated or swell dominated events in the sense that its peak point within the peak region is more prone to the right while it is approximately at the middle for the wind sea system this evidently results in incapability of jonswap model to follow the swell system although the jonswap model is reasonably compatible with the wind sea system but the sum of two systems results in an inaccurate double peaked spectrum when using method1 this problem is overcame by method2 which offers tuning of peak frequencies to the extent to represent the lowest d i so peak frequency of the swell system in both wind sea dominated and swell dominated events shifts to the left with method2 for a deeper analysis of such factors inputs of method2 in terms of peak frequency and peak spectral density known as adjusted values are drawn against observed ones in figs 4 and 6 respectively also such results are quantitatively reported in table 3 as discussed on typical events change in peak frequency of wind sea system is lower even negligible than that of swell system either in wind sea dominated or swell dominated events as shown in fig 5 this is mainly due to the shape of jonswap spectrum which is less compatible with the form of swell system besides such changes are approximately similar to each other irrespective of the type of event as peaks always are generally adjusted by a shift to the left in other words adjusted frequencies are less than observed peak frequencies in which this difference is higher for swell systems either in wind sea dominated or swell dominated events it should be reminded that method2 changes values of significant wave heights to the extent to represent the lowest d i consequently spectral densities shown in fig 6 are not among direct inputs of method2 in contrast to those of method1 it is obvious from this figure that peak spectral density of wind sea system decreases while it increases for swell system both in swell dominated and wind sea dominated events besides the difference is higher for swell systems rather than wind sea systems which is in accordance with the form of jonswap spectrum this results in about 30 increase in the ratio of maximum spectral ordinates in method2 while it remains constant in method1 comparing typical events it was obvious that method2 performs better than method1 while zeroth order spectral moment of sea spectrum is the same for observed and adjusted spectra in both methods such methods are quantitatively compared in terms of deviation index and first order spectral moment of sea spectrum in table 4 it is evident that both method1 and method2 have their best performance in terms of d i in wind sea dominated events in which the share of wind sea part is dominant this is mainly due to better performance consistency of jonswap model with wind sea part it is in accordance with results of table 3 in which change of adjusted values are lower for wind sea system in both wind sea dominated and swell dominated events by using method2 when compared to that of swell system accordingly decrease of d i is bigger in swell dominated events than wind sea dominated ones using method2 while zeroth order spectral moment of sea spectrum is kept constant during calibration in both method1 and method2 first order spectral moment is free here method2 performs better than method1 as well the value of peak enhancement factor γ is among those adjusted between 1 0 and 3 3 in both method1 and method2 considering better performance of method2 its d i contour plot is represented in fig 7 it is obvious that γ s 1 1 and γ w 1 yield to the lowest amount d i when applying method2 to 2016 representative events similar investigation showed that they are approximately the same when using method1 then for the rest of the research those values are directly inserted without further calibration of them it should be noted that for fixed γ trial and error is required in method2 to minimize d i while no iteration is required in method1 however method2 results in lowest d i as mentioned earlier there are two main differences between method1 and method2 in terms of peak frequencies and peak spectral densities used as inputs i e f p s f p w and s p s s p w are directly picked from observation in method1 while they are adjusted in method2 to shed light on the share of such adjustments in terms of peak frequencies and ratio of maximum spectral ordinates in method2 this method is repeated by fixing one of them similar to method1 and relaxing the other one so as represented in fig 2 c we have method2 in which ratio of maximum spectral ordinates is fixed and method2 in which peak frequencies are fixed as the observed ones it should be noted that s p s s p w is not the direct input of method2 as significant wave heights are adjusted in it however for method2 we have two constraints as availability of h s and s p s s p w to use eq 4 and eq 10 wind sea and swell systems significant wave heights are calculated by means of these equations rather than their adjustment in method2 itself and the two other parameters peak frequencies are adjusted in this method similar to method2 on the other hand there are three constraints in method2 as availability of h s and two peak frequencies therefore only one parameter i e s p s s p w is changed in this method to get the best result outputs are summarized in table 5 comparing d i of method2 and method2 it is apparent that adjustment of peak frequencies is of higher importance than that of significant wave heights considering previous assessments of typical events as well as the value of d i in swell dominated events we can conclude that incapability of jonswap spectrum in representation of swell system is of higher importance than overlooking the overlap between two systems of double peaked spectra it should be noted that both method2 and method2 requires iterations yet it is clearly less than required iterations in method2 in the next section two modified methods free of any iteration similar to method1 are introduced to improve the results so that four parameters of a double peak spectrum can be calculated directly with less error than direct method1 4 2 modification considering assessment of method1 and method2 and investigating the share of adjustments in spectral densities and peak frequencies to decrease d i in method2 here we are analyzing two modifications of such calibration methods namely method1 and method1 over 2006 2007 measurements as introduced in section 3 method1 is based on early calibration of the ratio of spectral ordinates and peak frequencies while this is not the case for method1 in other words for method1 we use coefficients represented in table 3 which was calculated by examining method2 over 2016 data to calibrate observed peak values of 2006 2007 measurements while method1 is directly applied to 2006 2007 data just like method1 without any pre calibration based on eq 11 they are compared in two typical events in fig 8 and their performance over 2006 2007 representative events is summarized in table 6 investigation shows that method1 has approximately the same performance in terms of d i when compared to that of method2 as discussed earlier the share of spectral density ratio modification in decreasing d i method2 is generally less than that of peak frequency modification method2 so we cannot expect better performance for this modification method when compared to output of method2 but it can be easily extended to all situations as it does not require calibration coefficients here it should be noted that the performance of the method increases in line with the increase in the overlap between wind sea and swell system by dividing the jonswap spectrum into left side and right side with respect the location of peak frequency the right side has a milder slope than the left side so the tail of swell system spectrum easily extends to the peak point of the wind sea system especially in swell dominated events on the other hand the left side of wind sea system spectrum with a relatively steep slope hardly interacts with peak spectral ordinate of the swell system so we should expect less effectiveness of method1 in wind sea dominated events rather than swell dominated ones this is evident from table 6 by comparing d i decrease from method1 to method1 in wind sea dominated and swell dominated events as predicted method1 performs better than method1 both in wind sea dominated and swell dominated events as it modifies both the ratio of spectral ordinates and peak frequencies using modification coefficients acquired from 2016 data investigation similarly it performs better in terms of decreasing the value of d i this is mainly due to asymmetric form of peak zone in swell system of measured event when compared to that of wind sea system here adjustment of peak frequencies results in more compatibility of jonswap model with the swell system although method1 is more accurate than method1 it should be noted that modification factors implemented in method1 are site as well as spectrum shape e g jonswap spectrum dependent while method1 does not need any pre modification therefore the concept introduced in method1 is simply extendable to any site and spectrum shape in the meantime both methods could be applied directly without iterations as this is the case for method1 5 conclusion there are a lot of investigations on calibration of double peaked sea spectrum in which there is high consensus on using jonswap model for both wind sea and swell system we investigated the idea over two sets of measurements at the northern part of the gulf of oman using different two calibration methods then we introduced two modified methods the one dependent and the other one independent of the region while both are direct methods free of iteration for the first modification as an independent of the region method which considers the overlap between wind sea and swell systems it perform better than the conventional method introduced earlier by guedes soares and henriques 1998 and frequently implemented on other datasets e g evans et al 2006 it should be noted that it works as long as we are facing double peaked spectra with overlap between its systems in other cases it is equal to its origin proposed earlier by guedes soares and henriques 1998 for the second modification as a dependent to the region method which is based on modification of observations it performs better than both its origin guedes soares and henriques 1998 and the first modification method in events with or without overlap between systems this is associated with two facts first observed values of peak spectral ordinates and peak frequencies are different from those forming individual systems independent of spectral models e g jonswap model second the form of peak zone in swell system of measured events is very asymmetric when compared to that of wind sea system this is in contrast to the form of jonswap model at that zone in conclusion the jonswap model is less successful to follow the form of swell system when compared to its performance in representing wind sea system this is evident when comparing its performance in wind sea dominated and swell dominated events with all calibration method introduced in this study on the other hand incompatibility between the jonswap model and the form of swell systems in the region under study leads to inaccurate double peaked spectrum especially based on the method1 with fixed peak frequencies therefore using different spectra for wind sea and swell systems may improve the accuracy of the results using method1 or any other calibration methods this offers an avenue for future studies 
22858,calibration of double peaked spectra based on partitioning of frequency spectra sometimes starts by assuming that relations existing between two observed peaks are valid through the calibration procedure here often two facts are overlooked each system i e swell and wind sea systems in a typical double peaked spectrum contributes to the other one and swell system in its peak zone is highly asymmetric actually peak spectral densities and corresponding peak frequencies of partitioned systems are different from those observed in an integrated double peaked spectrum besides those observed as peak values are not good candidates of the peak due to the asymmetry of swell system to highlight these issues we examine 2 different methods to fit 2 jonswap spectra to double peaked spectra observed in 2 series of measurement in the northern part of the gulf of oman i e 2006 2007 and 2016 one which directly uses observed values and the other which adjusts them discussing such we introduce two modifications one dependent and one independent of measurements here we address how data gathered from integrated double peaked spectra can be modified to maximize accuracy of results this is what less addressed by studies focusing on calibration of spectra while it is of great importance in practice keywords wave systems overlap measurement calibration methods partitioning swell system wind sea system 1 introduction accurate description of a wave spectrum is of great importance for designing coastal and offshore structures in recent decades many attempts have been made to describe ocean waves by introducing wave spectral models however apparently starting by bretschneider spectrum bretschneider 1959 historically the major part of studies have focused on the spectra generated by local wind unimodal spectra called wind sea system sometimes waves arriving from remote areas called swell system combine with wind sea system resulting in emerging bimodal spectra the former type of spectra usually represents one peak however the later one is known as double peaked spectra it should be noted that wave wave interactions also could result in appearance of additional peaks as such interactions affect wave period for example it was discussed that nonlinear triad wave wave interactions change the spectral shape by the generation of both lower and higher harmonic components freilich and guza 1984 all in all it should be noted that spectra might have more than two peaks a situation which has been less investigated however a precise description of double peaked spectra significantly affects sea keeping safety offshore structures design small boat operations and ship passage over harbor entrance wang and hwang 2001 strekalov et al are the pioneers working on double peaked spectra strekalov et al 1972 they implemented a normal distribution for swell system and a pierson moskowitz spectrum for wind sea system later ochi and hubble developed a series of bimodal spectra involving six parameters over 800 observed spectra at the north atlantic ocean while dividing observed spectra into two low frequency and high frequency systems ochi and hubble 1976 they expressed each system with a gamma function a general and flexible function capable of adjusting well to data this spectrum was investigated frequently especially in the region under study gulf of oman panahi et al 2015 panahi et al 2016 golpira et al 2019 guedes soares on the other hand proposed a four parameter theoretical formulation to represent double peaked spectra while he provided an excellent fit to 1000 measured wave spectra from north atlantic ocean and 6000 wave spectra from north sea by combining two jonswap spectrum guedes soares 1984 this assumption about swell spectra i e swell always start from a wind sea system was based on early findings by goda goda 1983 which were recently confirmed by lucas and guedes soares lucas and guedes soares 2015 then he proposed the use of jonswap models with average values of the lateral parameters and of the peak enhancement factor resulting in simple 4 parameters spectrum guedes soares 1984 this model was later applied to a larger data set of spectra from portugal and the parameters were determined in the form of scatter diagrams guedes soares and nolasco 1992 later investigation showed that the mean period as a main input of such method is sensitive to noises in the low or very high frequency tails which consequently might result in inaccurate determination of peak frequencies when using that method so guedes soares and henriques proposed a new method which uses observed peak frequencies instead of mean period in fitting guedes soares and henriques 1998 later torsethaugen used original jonswap spectrum with 5 parameters as he had access to extensive measurements at statfjord field in norwegian waters here a criterion was introduced to distinguish swell dominated and wind dominated spectra and different formulation was proposed for them torsethaugen 1993 accordingly he simplified his model to be more applicable by reducing free parameters torsethaugen 2004 very close to the idea of guedes soares guedes soares 1984 all in all in calibration of double peaked spectra we can identify two basic approaches partitioning of bimodal wave spectra into wind sea and swell systems and then fitting a spectral function to each component assigning an average spectral shape based on the integrated spectral parameters for the first approach it is developed using either frequency spectrum guedes soares 1984 guedes soares and henriques 1998 panahi et al 2015 or frequency direction spectra hanson and phillips 2001 for the second approach which is more like a pure mathematical approach it is frequently used with different fitting algorithms e g generalized least square method an investigation by evans et al shows that outputs of the first approach are not materially different evans et al 2006 while the one based on frequency spectrum sometime performs better besides they argued that significant wave height and mean period of separate systems in the first approach are consistent with expectations while this is often not the case with the second approach which usually uses general information of an integrated spectrum for instance when using torsethaugen spectrum in the second approach it only requires significant wave height and peak frequency of measured double peaked spectrum although it is still possible to use this spectrum in the first approach panahi et al 2015 the first approach is implemented in this study to treat wind sea and swell systems separately following guedes soares 1984 in this study jonswap spectrum is applied on both systems to examine 2 different calibration methods in the first method we insert significant wave height of double peaked spectra two observed peak frequencies and the ratio of the observed maximum spectral ordinates into the fitting procedure while satisfying the relation between zeroth order spectral moment of sea spectrum and those of its systems for the second try we just insert significant wave height of double peaked spectra while satisfying the aforementioned relation this automatically yields to determination of significant wave heights and peak frequencies of partitioned systems representing the best fit considering a predefined error by discussing such we introduce two modified methods one dependent and one independent of measurements benefiting from 2 series of measurement in the gulf of oman i e 2006 2007 and 2016 it should be noted that the second series of measurement was conducted in response two extensive port development plans at this region panahi et al 2017 so the rest of this paper is structured as follows section 2 explains local measurements followed by the methodology in section 3 results including assessment of available methods and new methods are represented in section 4 finally the conclusion can be found in section 5 2 local measurements the wave data in this study have been extracted from a series of measurement conducted in 2016 at seven stations in northern parts of the gulf of oman using nortek acoustic wave and current profiler awac 2018 the location of such stations is illustrated in fig 1 together with stations investigated earlier in 2006 2007 details of each station are presented in table 1 it is evident that new measurements cover a wider area more than 210 km than the previous one less than 10 km the procedure is similar to what was proposed earlier by panahi et al 2015 in which nortek storm v1 14 is used with setting briefly represented in table 2 by targeting those peaks in the time history with significant wave height higher than 0 9 m here we apply the methodology used to identify and select the double peaked spectra described in guedes soares and nolasco 1992 this helps to take into account the statistical uncertainty in the estimation of the spectral densities which might lead to considering a unimodal spectrum as a bimodal one by applying the criterion proposed by torsethaugen torsethaugen 1993 this early step results in total of 417 wind dominated spectra and 823 swell dominated spectra fairly distributed over all the stations respectively in order to avoid statistical dependency of events further we divide time histories into two days intervals and pick only one event per interval here it should be noted that there are methods including more detailed steps to remove correlated event guedes soares and ferreira 1996 but as the length of storms in the region under study is generally less than 48 h we choose that simple criterion such a procedure leads to a total of 224 wind dominated and 388 swell dominated spectra the sample used to apply fitting methods as will be discussed in section 3 here it should be noted that the share of double peaked spectra in the region considering the location of measurement stations is about 30 for all stations 3 methodology by representing the sea spectrum as the sum of two separate frequency spectra each responsible for an individual system we will have the following 1 s f s s f s w f in which s s f and s w f represent swell and wind sea systems respectively consequently its moments must be theoretically equal to the sum of moments of the systems 2 m 0 m 0 s m 0 w 3 m 1 m 1 s m 1 w in which m 0 and m 1 are zeroth and first order spectral moments of the sea spectrum m 0 s and m 1 s are those of swell system and m 0 w and m 1 w belongs to wind sea system considering the relation for significant wave height of the sea spectrum h s 4 m 0 and the one for its mean period t z m 0 2 π m 1 eq 2 and eq 3 can be rewritten as follows 4 h s 2 h s s 2 h s w 2 5 m 0 t z m 0 s t z s m 0 w t z w where h s s and h s w stand for significant wave height of swell and wind sea systems respectively besides t z s and t z w are mean periods of swell and wind sea systems initiated by guedes soares in 1984 many investigations show that jonswap spectrum can appropriately represent swell and wind sea systems guedes soares 1984 guedes soares and nolasco 1992 torsethaugen 1993 guedes soares and henriques 1998 lucas and guedes soares 2015 panahi et al 2015 the spectrum used in this study by adding an extra and somewhat artificial factor to the pierson and moskowitz spectrum pierson and moskowitz 1964 called peak enhancement factor γ jonswap spectrum was introduced as follows hasselmann et al 1973 6 s j o n s w a p f c f f p 5 e x p 5 4 f f p 4 γ a 7 a e x p f f p 2 2 σ 2 f p 2 8 σ 0 07 0 09 f f p f f p where f p stands for the peak frequency besides among different forms of the constant c the one depending on the significant wave height h s is adopted here goda 1979 9 c 5 16 h s 2 f p 1 15 0 1688 γ 0 925 1 909 γ 1 in order to fit two jonswap spectra we need four inputs significant wave height of swell system h s s and its peak frequency f p s together with significant wave height of wind sea system h s w and its peak frequency f p w in the meantime two related peak enhancement factors should be calibrated benefiting from eq 4 and eq 5 guedes soares proposed a practical method to calculate aforementioned four inputs using the following data directly picked from observed double peaked spectra h s h s t z t z t z s t z w f p w f p s assumed to be equal to the ratio of peak frequency of individual systems f p w f p s and s s f p s s w f p w ratio of maximum spectral ordinates assumed to have the following relation if systems are represented by jonswaps spectra guedes soares 1984 10 s s f p s s w f p w s f p s s f p w h s s 2 h s w 2 f p w f p s 1 15 0 1688 γ w 0 925 1 909 γ w γ s a s 1 15 0 1688 γ s 0 925 1 909 γ s γ w a w where tilde accent represents those values picked directly from observed spectra here by assuming γ s and γ w h s s 2 h s w 2 is calculated by eq 10 considering f p w f p s f p w f p s then eq 4 is implemented to extract h s s and h s w considering h s h s while knowing these values and assuming that t z s t z w f p w f p s values of t z s and t z w are calculated by eq 5 consequently f p s and f p w are obtained as a functions of mean periods as introduced by guedes soares 1984 here we have all four required inputs to draw two jonswap models and represent double peaked spectra based on eq 1 here it should be noted that the original form of equations introduced by guedes soares 1984 is based on equal peak enhancement factors i e γ s γ w leading to simple forms this is mostly the case for later studies as such values are free in our research we are using the complete form of equations we will discuss this later in section 4 later it was argued that the method sometimes fails to predict location of peak frequencies in low significant wave height sea states in which the sea spectrum often includes more than two peaks consequently t z which is very sensitive to noises in the low and very high frequency tails would be miscalculated while it is one of the basics of the calibration method then a new method was proposed to overcome this difficulty by overlooking eq 5 and simple replacement of mean period with observed peak frequencies so four necessary inputs were provided by using the following data directly picked from observed double peaked spectra h s h s f p s f p s f p w f p w and s p s s p w s p s s p w guedes soares and henriques 1998 subsequently this method was investigated and approved over other measured data evans et al 2006 it should be noted that this method does not take care of the relation between first order spectral moments in fact benefitting from jonswap spectra while picking those peak frequencies from observation comes at the cost of overlooking eq 5 as with jonswap curve we can not accurately reproduce areas to satisfy relation for the first order spectral moments in other words there is no need to estimate peak frequencies from mean periods and such values are exactly those of integrated observed double peaked spectrum the method is further examined in this study called method1 as represented in fig 2 a in reality meaningful overlap zone stands between swell and wind sea systems therefore we must be aware of the difference between data read from measured spectra and those contribute to imaginary exact spectra representing swell and wind sea systems in a simple word a part of observed s p w may be related to the contribution of swell part and vice versa and on the other hand observed peak frequencies may also differ from the actual ones besides yet we have no means to accurately extract such shapes and all our calibration efforts resulting in best fits still have errors due to pre defined form of our assumed spectral models e g jonswap model so while picking any data from peaks of integrated double peaked spectra as representatives of peaks of partitioned systems we accumulate two types of errors which are overlooked as long as results are of acceptable accuracy so by fixing the form of jonswap model in this study our main target is to further address the first type of error here we also investigate the share of peak spectral ordinates and peak frequencies in accuracy of resultant double peaked spectra after picking spectral values of an event i e f p s f p w s p s and s p w we have s s f and s w f as introduced by method1 but as such spectra have overlap in some events we can apply a slight modification and propose method1 as represented in fig 2 b here by subtracting s w f p s from s f p s and applying the same for the second observed peak s f p w s s f p w we have updated spectral density values in which the share of the other system is somehow excluded so we can follow method1 with such updated spectral densities rather than the original ones directly picked from the observed spectra and the only difference is an update in eq 10 as follows 11 s s f p s s w f p w s f p s s w f p s s f p w s s f p w as eq 11 is used to determine h s s and h s w method1 becomes repetitive here we initialize h s s as suggested by guedes soares 1984 and use them to calculate the ratio in eq 11 by determining s w f p s and s s f p w in the first try after calculating new significant wave heights using eq 4 and eq 11 they are updated in s w f p s and s s f p w and such equations are solved again to find new significant wave heights as another method in this regard we offer method2 as represented in fig 2 c to find the best combination of four required inputs while keeping eq 4 as it stands for energy conservation so here we have three free independent variables one significant wave height and two peak frequencies while the other significant wave height should be calculated from the first one with respect to eq 4 simply we can adjust and calculate them through a simple calibration procedure while minimizing a well defined error to achieve this calibrated values are determined by starting from initial values as outputs of method1 and iteratively changing them in an interval around those values to minimize the error of the resultant spectrum compared to the observed one it should be noted that in a similar effort done by lucas and guedes soares 2015 to investigate the ability of the jonswap spectrum to describe swell spectra both eq 4 and eq 5 were overlooked so by targeting the final error there all four required inputs of two jonswap spectra were treated as independent variables to determine the best fit to measured spectra this method which sacrifices the conservation of energy is less theoretically concrete when compared to above mentioned methods as it does not take care of the both zeroth and first order spectral moments relations changing the prospect to offshore engineers engaged with design of floating structures we want to know which double peaked spectrum works better with what inputs a question which is less addressed compared to extensive spectra fitting attempts in other words based on aforementioned methods many researchers examine different types of spectra and offer a specific one for a region but they rarely notice how measured data must be substituted into developed spectra in practice as noted earlier researchers are aware of uncertainties of observed maximum spectral ordinates and peak frequencies in terms of existing overlap between the two systems so by introducing method2 we want to examine if it is possible to stick to the method1 as a direct method with simple modification of data picked from measured spectra so we are discussing how observed f p s f p w s p s s p w used in method1 can be modified considering outputs of method2 resulting in f p s m f p w m and s p s s p w m by introducing calibration coefficients in other words adjusted values of method2 can be interpreted as calibration coefficients for those values picked from measured double peaked spectra in method1 this is called method1 as represented in fig 2 d and examined against other methods in section 4 2 in this study deviation index d i introduced by liu liu 1983 and implemented by guedes soares and henriques guedes soares and henriques 1998 is adopted as follows 12 d i i 1 n 100 s f i s f i s f i s f i δ f m 0 in this normalized weighted index s stands for the calibrated spectrum and s is the measured one based on investigations of silva in 1988 reported by guedes soares and henriques any value of d i lower than 70 seems satisfactory guedes soares and henriques 1998 although generalized least square method used in this study leads to the minimum error 4 results and discussions 4 1 comparison of calibration methods in order to investigate performance of calibration methods we consider two types of classification as they represent distinct aspects firstly we divide events into wind sea dominated and swell dominated event as discussed earlier in section 2 we further divide such events into those with or without overlap between their peaks when drawing separate spectra following the idea behind eq 1 we can see events in which s s f or s w f has clear presence near the peak frequency of the other one i e spectral density of one system represented by jonswap model using method1 is at least 10 of the observed peak spectral density of the other system which we mark them as events with overlapped systems in contrast there are events in which systems are diminished near the peak frequency of the other one similarly they are called as events with non overlapped systems investigations show that the share of events with overlapped systems is about 20 in wind sea dominated spectra while this is about 67 for swell dominated events in total considering the tail of jonswap spectrum this is reasonable as it results in more swell dominated overlapped events rather than sea dominated overlapped ones here it should be noted that at this stage only we focused on data of 2016 measurement project at the region to investigate calibration methods and calculate required parameters later the data of 2006 2007 measurements project are used in sub section 4 2 to verify introduced modifications performance of method1 and method2 in representation of the sea state is illustrated in figs 3 and 4 for typical events with overlapped systems and non overlapped systems respectively as shown in these figures there are two main reasons behind inaccuracy share of one system into the other one and the position of swell system s peak frequency in comparison to that of wind sea system these two factors somehow are taken into consideration by method2 when compared to method1 method2 does not keep the initial ratio of maximum spectral ordinates determined based on observation fixed within the calibration procedure so it is possible for the ratio to be tuned to reach the lowest amount of d i in this method comparing figs 3 and 4 it is evident that this factor loss its importance when we have events with non overlapped systems but for the second factor it is significant in both events with overlapped and non overlapped systems here method2 relaxes changes of peak frequencies consequently we can expect higher differences between outputs of method1 and method2 for the swell system especially in swell dominated events considering the form of jonswap model this is obvious in both figs 3 and 4 in other words as the form of swell system is different from that of wind sea system either in wind sea dominated or swell dominated events in the sense that its peak point within the peak region is more prone to the right while it is approximately at the middle for the wind sea system this evidently results in incapability of jonswap model to follow the swell system although the jonswap model is reasonably compatible with the wind sea system but the sum of two systems results in an inaccurate double peaked spectrum when using method1 this problem is overcame by method2 which offers tuning of peak frequencies to the extent to represent the lowest d i so peak frequency of the swell system in both wind sea dominated and swell dominated events shifts to the left with method2 for a deeper analysis of such factors inputs of method2 in terms of peak frequency and peak spectral density known as adjusted values are drawn against observed ones in figs 4 and 6 respectively also such results are quantitatively reported in table 3 as discussed on typical events change in peak frequency of wind sea system is lower even negligible than that of swell system either in wind sea dominated or swell dominated events as shown in fig 5 this is mainly due to the shape of jonswap spectrum which is less compatible with the form of swell system besides such changes are approximately similar to each other irrespective of the type of event as peaks always are generally adjusted by a shift to the left in other words adjusted frequencies are less than observed peak frequencies in which this difference is higher for swell systems either in wind sea dominated or swell dominated events it should be reminded that method2 changes values of significant wave heights to the extent to represent the lowest d i consequently spectral densities shown in fig 6 are not among direct inputs of method2 in contrast to those of method1 it is obvious from this figure that peak spectral density of wind sea system decreases while it increases for swell system both in swell dominated and wind sea dominated events besides the difference is higher for swell systems rather than wind sea systems which is in accordance with the form of jonswap spectrum this results in about 30 increase in the ratio of maximum spectral ordinates in method2 while it remains constant in method1 comparing typical events it was obvious that method2 performs better than method1 while zeroth order spectral moment of sea spectrum is the same for observed and adjusted spectra in both methods such methods are quantitatively compared in terms of deviation index and first order spectral moment of sea spectrum in table 4 it is evident that both method1 and method2 have their best performance in terms of d i in wind sea dominated events in which the share of wind sea part is dominant this is mainly due to better performance consistency of jonswap model with wind sea part it is in accordance with results of table 3 in which change of adjusted values are lower for wind sea system in both wind sea dominated and swell dominated events by using method2 when compared to that of swell system accordingly decrease of d i is bigger in swell dominated events than wind sea dominated ones using method2 while zeroth order spectral moment of sea spectrum is kept constant during calibration in both method1 and method2 first order spectral moment is free here method2 performs better than method1 as well the value of peak enhancement factor γ is among those adjusted between 1 0 and 3 3 in both method1 and method2 considering better performance of method2 its d i contour plot is represented in fig 7 it is obvious that γ s 1 1 and γ w 1 yield to the lowest amount d i when applying method2 to 2016 representative events similar investigation showed that they are approximately the same when using method1 then for the rest of the research those values are directly inserted without further calibration of them it should be noted that for fixed γ trial and error is required in method2 to minimize d i while no iteration is required in method1 however method2 results in lowest d i as mentioned earlier there are two main differences between method1 and method2 in terms of peak frequencies and peak spectral densities used as inputs i e f p s f p w and s p s s p w are directly picked from observation in method1 while they are adjusted in method2 to shed light on the share of such adjustments in terms of peak frequencies and ratio of maximum spectral ordinates in method2 this method is repeated by fixing one of them similar to method1 and relaxing the other one so as represented in fig 2 c we have method2 in which ratio of maximum spectral ordinates is fixed and method2 in which peak frequencies are fixed as the observed ones it should be noted that s p s s p w is not the direct input of method2 as significant wave heights are adjusted in it however for method2 we have two constraints as availability of h s and s p s s p w to use eq 4 and eq 10 wind sea and swell systems significant wave heights are calculated by means of these equations rather than their adjustment in method2 itself and the two other parameters peak frequencies are adjusted in this method similar to method2 on the other hand there are three constraints in method2 as availability of h s and two peak frequencies therefore only one parameter i e s p s s p w is changed in this method to get the best result outputs are summarized in table 5 comparing d i of method2 and method2 it is apparent that adjustment of peak frequencies is of higher importance than that of significant wave heights considering previous assessments of typical events as well as the value of d i in swell dominated events we can conclude that incapability of jonswap spectrum in representation of swell system is of higher importance than overlooking the overlap between two systems of double peaked spectra it should be noted that both method2 and method2 requires iterations yet it is clearly less than required iterations in method2 in the next section two modified methods free of any iteration similar to method1 are introduced to improve the results so that four parameters of a double peak spectrum can be calculated directly with less error than direct method1 4 2 modification considering assessment of method1 and method2 and investigating the share of adjustments in spectral densities and peak frequencies to decrease d i in method2 here we are analyzing two modifications of such calibration methods namely method1 and method1 over 2006 2007 measurements as introduced in section 3 method1 is based on early calibration of the ratio of spectral ordinates and peak frequencies while this is not the case for method1 in other words for method1 we use coefficients represented in table 3 which was calculated by examining method2 over 2016 data to calibrate observed peak values of 2006 2007 measurements while method1 is directly applied to 2006 2007 data just like method1 without any pre calibration based on eq 11 they are compared in two typical events in fig 8 and their performance over 2006 2007 representative events is summarized in table 6 investigation shows that method1 has approximately the same performance in terms of d i when compared to that of method2 as discussed earlier the share of spectral density ratio modification in decreasing d i method2 is generally less than that of peak frequency modification method2 so we cannot expect better performance for this modification method when compared to output of method2 but it can be easily extended to all situations as it does not require calibration coefficients here it should be noted that the performance of the method increases in line with the increase in the overlap between wind sea and swell system by dividing the jonswap spectrum into left side and right side with respect the location of peak frequency the right side has a milder slope than the left side so the tail of swell system spectrum easily extends to the peak point of the wind sea system especially in swell dominated events on the other hand the left side of wind sea system spectrum with a relatively steep slope hardly interacts with peak spectral ordinate of the swell system so we should expect less effectiveness of method1 in wind sea dominated events rather than swell dominated ones this is evident from table 6 by comparing d i decrease from method1 to method1 in wind sea dominated and swell dominated events as predicted method1 performs better than method1 both in wind sea dominated and swell dominated events as it modifies both the ratio of spectral ordinates and peak frequencies using modification coefficients acquired from 2016 data investigation similarly it performs better in terms of decreasing the value of d i this is mainly due to asymmetric form of peak zone in swell system of measured event when compared to that of wind sea system here adjustment of peak frequencies results in more compatibility of jonswap model with the swell system although method1 is more accurate than method1 it should be noted that modification factors implemented in method1 are site as well as spectrum shape e g jonswap spectrum dependent while method1 does not need any pre modification therefore the concept introduced in method1 is simply extendable to any site and spectrum shape in the meantime both methods could be applied directly without iterations as this is the case for method1 5 conclusion there are a lot of investigations on calibration of double peaked sea spectrum in which there is high consensus on using jonswap model for both wind sea and swell system we investigated the idea over two sets of measurements at the northern part of the gulf of oman using different two calibration methods then we introduced two modified methods the one dependent and the other one independent of the region while both are direct methods free of iteration for the first modification as an independent of the region method which considers the overlap between wind sea and swell systems it perform better than the conventional method introduced earlier by guedes soares and henriques 1998 and frequently implemented on other datasets e g evans et al 2006 it should be noted that it works as long as we are facing double peaked spectra with overlap between its systems in other cases it is equal to its origin proposed earlier by guedes soares and henriques 1998 for the second modification as a dependent to the region method which is based on modification of observations it performs better than both its origin guedes soares and henriques 1998 and the first modification method in events with or without overlap between systems this is associated with two facts first observed values of peak spectral ordinates and peak frequencies are different from those forming individual systems independent of spectral models e g jonswap model second the form of peak zone in swell system of measured events is very asymmetric when compared to that of wind sea system this is in contrast to the form of jonswap model at that zone in conclusion the jonswap model is less successful to follow the form of swell system when compared to its performance in representing wind sea system this is evident when comparing its performance in wind sea dominated and swell dominated events with all calibration method introduced in this study on the other hand incompatibility between the jonswap model and the form of swell systems in the region under study leads to inaccurate double peaked spectrum especially based on the method1 with fixed peak frequencies therefore using different spectra for wind sea and swell systems may improve the accuracy of the results using method1 or any other calibration methods this offers an avenue for future studies 
22859,the seismic response analysis of a reef engineering site is the foundation for the seismic design of artificial islands and other upper constructions this study proposes a two dimensional seismic analysis model for the reef seawater system where the fluid solid coupling effect is considered and the wave radiation effects of infinite fluid and solid domains are simulated by corresponding artificial boundary conditions meanwhile the seismic wave input method based on the substructure of artificial boundaries is modified to accomplish the process of inputting the seismic waves with arbitrary incident angles into the calculation region the accuracy of the proposed model is verified by numerical examples afterwards we conduct the parametric studies and the seismic analysis of a series of practical layered reef models the results indicate that the least favorable slope gradient for the seismic response is generally at approximately 30 and the feature of wave velocity reduction along the vertical direction significantly magnifies the seismic response on the reef flat the peak acceleration ratio near the edges of the reef flat distributes between 3 and 4 while in the middle area it is usually between 1 5 and 2 5 and can reach up to 4 when the width of reef flat decreases keywords reef seawater artificial boundary seismic wave input fluid solid coupling earthquake ground movement 1 introduction significant progress has been made recently in the exploration and exploitation of offshore reefs represented by the construction of artificial islands in the south china sea however such engineered reefs are under constant threat of earthquakes the 1995 hoyogo ken nanbu earthquake for example caused extensive damage to the concrete caisson artificial islands in japan destroying all piers on the islands fukue and kawakami 1996 hence to scientifically exploit offshore reefs and ensure the seismic safety of engineered reefs it is necessary to understand the engineering characteristics and dynamic behaviors of a reef engineering site current reported advances in research on reef engineering sites mainly focus on two topics one is the physical and mechanical properties of calcareous soils and rocks meng et al 2009 wang et al 2011 2017 zhu et al 2014 which have served as the building materials for artificial island constructions the other topic drawing researchers attention is the stability of offshore reefs for example guo et al 2017 and tang et al 2018 analyzed the shallow strata stability of the zhubi and yongshu reefs in the south china sea by the limit equilibrium method by contrast the seismic response of an offshore reef engineering site which is the basis for the seismic design of artificial islands and other upper constructions has received little attention and analysis tools for this subject are limited therefore developing an effective seismic analysis model to investigate the seismic response of reef seawater system is urgent and meaningful the simulation of the seismic response of the reef seawater system involves three key issues the interaction between the reef and seawater the wave radiation effects of the infinite fluid and solid medium and the seismic wave input first from the perspective of the fluid solid coupling effect there are some similarities between the reef seawater system and marine structures the seismic analysis of the latter such as dams fok and chopra 2010 wang et al 2013 seawalls chen and huang 2002 rajesh and choudhury 2016 and deep water piers du et al 2014 wang et al 2018a 2018b 2019 have drawn significant attention for decades and have provided guidance and insight for the dynamic analysis of reef seawater systems however as far as the calculation model is concerned the size of offshore reefs unlike common marine structures is extremely large and their depth and length vary from hundreds to thousands of meters meng et al 2014 under such circumstances the wave propagation in the system especially the wave radiation in infinite seawater and seabed will significantly affect the dynamic behavior of reefs the common method to address the unbounded medium is to intercept a near field calculation domain and set artificial boundaries on the cutoff boundaries which aim to absorb the scattered wave from the internal computational region the artificial boundary for solid medium is a classic research field in geotechnical engineering and thus more mature in development the representative achievements in this area include the boundary element method karabalis and beskos 1984 infinite element method zhao and valliappan 1993 the scaled boundary finite element method yann et al 2004 transmitting boundary liao et al 1984 viscous boundary georges et al 2011 and viscous elastic boundary liu et al 2005 du et al 2006 with the development of ocean engineering in recent years the wave radiation effect of infinite fluid medium is also concerned due to its significant influence on the dynamic response of marine structures and the simulation approaches for this problem have been increasingly studied based on different mathematical physical and mechanical techniques tsai and lee 1990 fan et al 2004 zhang et al 2013 wang et al 2015 very recently we deduced a new fluid artificial boundary based on the media wave theory liu et al 2017 this new fluid artificial boundary belongs to the stress type artificial boundaries and is applicable to the fluid solid coupling dynamic analysis of a large complex reef engineering site due to its superior spatial decoupling characteristics and convenient assembling into finite element software when the artificial boundaries are applied on the cutoff boundaries the third issue mentioned above which requires inputting the earthquake loads into the calculation domain through the cutoff boundaries without affecting the absorption of outgoing waves becomes a concern and needs to be solved to achieve that purpose wolf 1989 converted the normally incident seismic waves into equivalent loads on the one dimensional viscous boundary which is known as the free field boundary method after that yasui et al 1988 modified this method to approximately input the obliquely incident wave then based on the characteristics of the wave field liu and lu 1998 proposed the wave method for viscous elastic boundaries whose equivalent seismic loads are obtained through the analysis of a free field model although the wave method has been proven to be valid and accurate it is still slightly complicated in practice nevertheless further research improved the wave method by calculating the equivalent loads through the dynamic analysis of a substructure model containing the artificial boundaries as a result the seismic wave input method based on the substructure of artificial boundaries was proposed liu et al 2018 while this new method is easier to process it is originally used for the wave input in the land site in this article this new method is further improved to accomplish the seismic wave input in the reef seawater system due to the impacts of ocean currents and monsoons most of the offshore reefs in the south china sea are of somewhat elongated and elliptical shapes zhan et al 1995 take the yongshu reef which is 25 km long and 6 km wide as an example meng et al 2014 when subjected to an earthquake whose vibration direction is orthogonal to the long axis the stress state of its middle section can be approximated to the plane strain state which can be simulated by a two dimensional numerical model therefore a two dimensional time domain seismic analysis model of the reef seawater system is established in this study then the accuracy of this analysis model is verified through numerical examples afterwards a series of seismic analysis of the reef engineering site is conducted and several fundamental issues including the differences between the offshore reef engineering site and land site as well as the influence of the characteristics of the input seismic wave and the topographic factors on the seismic response are discussed 2 numerical methods fig 1 shows a typical cross section schematic of the reef seawater system which is essentially an external source problem of a semi infinite open system considering the fluid solid coupling effect a near field calculation domain should be intercepted to establish the analysis model and the cutoff boundaries need to be manipulated to input the seismic waves and absorb the scattered waves in this section the numerical approaches applied to simulate the reef seawater system specifically the artificial boundaries for fluid and solid medium as well as the seismic wave input method will be introduced on that basis the dynamic analysis model of the reef seawater system will be established 2 1 artificial boundary for fluid medium to simulate the wave radiation effect of an infinite fluid medium a new fluid artificial boundary was proposed by us very recently liu et al 2017 in the following a brief introduction and theoretical derivation of this new fluid artificial boundary is given the cylindrical wave equation for a non viscous and compressible fluid in the two dimensional polar coordinate system is expressed as 1 2 ϕ t 2 c f 2 2 ϕ r 2 1 r ϕ r where ϕ is the displacement potential function namely u r ϕ r u r is the radial displacement c f k ρ f is the velocity of sound in fluid medium k and ρ f are the bulk modulus and density of the fluid respectively in the case of small disturbances the hydrodynamic pressure p can be obtained 2 p k 2 ϕ r 2 1 r ϕ r the approximate solution of eq 1 when only outgoing waves are taken into consideration can be obtained as follows 3 ϕ r t 1 r f r c f t by substituting eq 3 into eq 1 and taking the second derivative with respect to the time variable t the following equation can be obtained 4 2 u r t 2 c f 2 2 r 3 2 f r c f t c f 2 r 1 2 f r c f t combining eqs 1 4 gives 5 p 2 r c f p t 2 ρ f r 2 u r t 2 eq 5 provides the artificial boundary condition on the cutoff boundary this boundary condition can be equivalent to a damper mass system shown in fig 2 and the physical parameters of the equivalent damper mass system are as follows 6 m 2 ρ f r c ρ f c f after discretizing the model through the finite element method the above physical parameters can be changed into the following form 7 m b 2 ρ f r b i a i c b ρ f c f i a i where r b is defined as the distance from the wave source to the boundary node accordingly in the reef seawater finite element model r b is the horizontal distance from the reef slope to the artificial boundary node i a i is the area represented by the artificial boundary node in the finite element model it can be seen that this new artificial boundary for fluid medium belongs to the stress type artificial boundaries and is decoupled in space thus can be easily assembled into finite element software and integrated with the seismic wave input method introduced later 2 2 artificial boundary for solid medium as for the simulation of the unbounded solid domain many numerical approaches as mentioned above have been proposed among these methods the consistent viscous spring artificial boundary element liu et al 2006 has gained widespread use because of its high accuracy and simplified application in this study it is adopted to simulate the wave radiation effect of a reef and seabed the implementation procedure of this method is to extend a layer of solid elements along the normal direction on the solid cutoff boundaries which are defined as the equivalent elements and then fix the outer boundaries of the equivalent element layer meanwhile the material properties of the equivalent elements are designated to ensure that they work equally as the viscous elastic artificial boundary for two dimensional application the shear modulus g young s modulus e and elemental material damping coefficient η of the equivalent elements are given by 8 g α t h g r e α n h g r 1 γ 1 2 γ 1 γ η ρ s r 2 g c s α t c p α n where h is the thickness of the equivalent element layer and r is the distance from the wave source to the artificial boundary node which is usually approximate to the average value since the scattered source is not a single point source for the lateral and bottom equivalent elements in our model the values of r are the distances from the midpoint of the reef bottom to the lateral and bottom boundaries respectively α n and α t are the artificial boundary coefficients whose recommended values are 1 and 0 5 respectively liu et al 2006 c s and c p are the velocities of the shear and compression waves in the solid medium respectively g and ρ s are the shear modulus and mass density of the solid medium respectively γ is the equivalent poisson s ratio defined by 9 γ α 2 2 α 1 α 2 0 α 2 where α α n α t 2 3 seismic wave input method based on the substructure of artificial boundaries in this section the seismic wave input method based on the substructure of artificial boundaries liu et al 2018 is modified to accomplish the process of inputting earthquake waves with arbitrary incident angles into the reef seawater system according to the wave method theory liu and lu 1998 incident seismic wave can be converted into equivalent loads on the cutoff boundaries which are only related to the free wave field and unaffected by internal terrains additionally the reasonable equivalent input seismic loads should ensure that the motions and stresses of the cutoff boundaries are consistent with those of the free wave field therefore by imposing the free wave field motions on the nodes of the free field model and conducting a dynamic analysis the equivalent input seismic loads can be obtained which are exactly the reaction forces on the cutoff boundaries the free field model corresponding to the reef seawater system is a half space model with an overlying seawater layer whose finite element model is shown in fig 3 a the nodes can be classified into three types according to their positions namely the artificial boundary nodes represented by solid red dots the internal nodes next to the artificial boundaries represented by solid blue dots and the remaining internal nodes represented by open circles according to the classification of the nodes the motion equation of the free field model is expressed as 10 m ii 0 m in 0 0 m ni 0 m nn 0 m nb 0 0 m bn 0 m bb 0 u i 0 u n 0 u b 0 c ii 0 c in 0 0 c ni 0 c nn 0 c nb 0 0 c bn 0 c bb 0 u i 0 u n 0 u b 0 k ii 0 k in 0 0 k ni 0 k nn 0 k nb 0 0 k bn 0 k bb 0 u i 0 u n 0 u b 0 0 0 f b where u 0 u 0 and u 0 are the nodal displacement velocity and acceleration vectors of the free field respectively m 0 c 0 and k 0 are the mass damping and stiffness matrices of the free field model respectively the subscripts b n and i denote the artificial boundary nodes internal nodes next to the artificial boundaries and the remaining internal nodes respectively and f b is the reaction force vector on the cutoff boundaries which is also the equivalent input seismic loads according to the theory of finite element discretization when the mesh generation near the artificial boundaries of the reef seawater system is the same as that of the free field model as shown in fig 3 b the following equations can be obtained 11 m nb 0 m nb m bn 0 m bn m bb 0 m bb c nb 0 c nb c bn 0 c bn c bb 0 c bb k nb 0 k nb k bn 0 k bn k bb 0 k bb where m c and k are the mass damping and stiffness matrices of the finite element model of reef seawater system respectively by substituting eq 11 into eq 10 and solving the equations the equivalent input seismic loads f b can be obtained 12 f b m bn u n 0 m bb u b 0 c bn u n 0 c bb u b 0 k bn u n 0 k bb u b 0 furthermore eq 12 can be equivalent to the motion equation of the substructure within the dashed box in fig 3 b which is defined as the substructure of artificial boundaries this equation indicates that if the motions of the artificial boundary nodes and internal nodes next to the artificial boundaries are consistent with those of the free wave field the reaction forces on the artificial boundaries are the equivalent input seismic loads namely the equivalent input seismic loads can be gained through the dynamic analysis of the substructure model under the imposed free wave field motions in addition the substructure model of artificial boundaries can be obtained directly from the finite element model of the reef seawater system instead of establishing a new model notably although eq 12 involves three sets of variables displacement velocity and acceleration only one of them needs to be implemented and the other two sets of variables can be automatically obtained through the dynamic analysis of the substructure model according to the abovementioned theoretical derivations the implementation steps of the seismic wave input method based on the substructure of artificial boundaries in the reef seawater system are provided as follows 1 establish the finite element model of the reef seawater system as shown in fig 3 b then the substructure model can be obtained by deleting all elements containing the remaining internal nodes as shown in fig 4 2 for a given earthquake time history the free wave motions of each node location can be obtained based on the travelling wave theory then by imposing the corresponding free field motions u 0 on each nodes of the substructure model as shown in fig 4 and conducting a dynamic analysis the reaction forces f b on the artificial boundary nodes can be obtained which are exactly the equivalent input seismic loads notably the calculation of the free wave field naturally considers the spatial distributions of the incident waves therefore the wave motions u 0 and the reaction forces f b vary on different substructure nodes and the data management is a bit complex we strongly recommend to develop a subprogram to complete this procedure 3 impose the equivalent input seismic loads f b on the corresponding artificial boundary nodes of the reef seawater model and the process of seismic wave input is accomplished as shown in fig 5 then the seismic response of the reef seawater system can be obtained through dynamic analysis 3 modeling and verification 3 1 dynamic analysis model of reef seawater system now we can establish the dynamic analysis model of the reef seawater system with the help of the numerical approaches introduced above general finite element software ansys is used here for simulation the seawater is modeled by fluid80 elements which are in a displacement scheme and particularly suitable for calculating fluid solid interactions meanwhile solid45 elements are used for modeling the reef seabed and solid artificial boundaries the fluid artificial boundaries are modeled by the recommended combin40 spring damping mass elements liu et al 2017 however both fluid80 and solid45 elements are three dimensional elements thus only one layer of elements in the plane is established in the two dimensional model and the out of plane degrees of freedom of all nodes are constrained additionally the interaction between the fluid and solid is simulated by coupling the coincident nodes in the interface only in the direction normal to the interface bao and liu 2017 the preprocesses including the parameters determination and elements addition of the artificial boundaries as well as the implementation of the seismic wave input method are compiled with the command stream based on ansys parametric design language apdl notably on the basis of the numerical methods introduced in this study other engineering simulation programs are also suitable for establishing the analysis model of the reef seawater system through the similar procedures the reported information shows that the coral sand layers on the reefs in the south china sea are relatively shallow less than 17 3 m beneath them are all the bedrock composed of reef limestone meng et al 2014 in this study we mainly focus on the propagation of seismic wave in the reef seawater system as well as the distribution of ground motion field on the rock site of reef which are the foundation for the seismic design of artificial islands and other upper constructions therefore the influences of the coral sand are neglected and the bedrocks are assumed to be elastic due to their features of high wave velocities sun and lu 1999 besides although the seismic wave input method modified in this study can effectively input any plane waves with arbitrary incident angles into the reef seawater model only the vertical incident sv waves which are the most commonly used load cases in earthquake engineering are considered here for exploration of general regularity here in the model verification and parameter analysis the average slope gradient θ the height of reef h and the width of reef flat l are taken as governing parameters for determining its topography and the distance from the bottom corner of the reef to the cutoff boundary l f as well as the height of the intercepted seabed h s are designated to determine the size of the near field calculation domain as shown in fig 6 additionally according to the reported wave velocity data of the yongshu reef in the south china sea sun and lu 1999 the approximate material properties of the reef seawater system are estimated and listed in table 1 more complicated and practical models will be established and analyzed in the case study of typical layered reef seawater system 3 2 applicability of the fluid artificial boundary in the seismic analysis of the reef seawater system the fluid artificial boundary is derived based on the full space wave theory and has been verified to be accurate in the full space wave radiation problems liu et al 2017 however the applicability of this fluid artificial boundary in the wave propagation simulation of the infinite seawater layer which is essentially a waveguide problem remains to be validated for that purpose the effects of wave propagation in solid medium should be exclude therefore in this numerical example we assume that the solid domain is rigid and the interface between the solid and fluid is vertical the dimensions of the fluid domain are as follows h 600 m and l f 800 m a oscillating wave with a stable period of 1 s is selected as the incident wave as shown in fig 7 the theoretical solution of the hydrodynamic pressure on the lateral wall in this model is given by eq 13 chopra 1967 where h is the height of the observation point above the water bottom u g t is the horizontal acceleration time history of the rigid wall j 0 is the zero order bessel function and λ n 2 n 1 π 2 h the numerical solutions are obtained by two methods present analysis model with fluid artificial boundaries set on the cutoff boundaries and fixing the cutoff boundaries the hydrodynamic pressures of observation points a and b are plotted in fig 8 the heights of a and b above the water bottom are 500 m and 100 m respectively the results show that the hydrodynamic pressures calculated by means of the present analysis model agree well with the theoretical solution indicating that the fluid artificial boundaries can effectively absorb the outgoing waves in the water layer however when the cutoff boundaries are fixed the waves cannot be transmitted to the virtual infinite domain and thus always propagate back and forth in the computational region consequently the result calculated by the fixed boundary model is significantly different from the theoretical solution 3 3 testing of the seismic analysis model of the reef seawater system then we perform the second numerical example to demonstrate the validity of the seismic analysis model of the reef seawater system the dimensions of the model are as follows h 600 m l 500 m θ 30 l f 800 m and h s 1000 m see fig 6 the reef is assumed to be elastic and its material properties are listed in table 1 a dirac δ pulse sv wave with a pulse duration of 0 2 s is vertically inputted through the seismic wave input method its displacement time history and fourier amplitude spectrum are plotted in fig 9 fig 10 shows the snapshots of the calculated displacement wave field it can be observed that the wave front is smooth and continuous near the cutoff boundaries meanwhile in the region where the scattered waves caused by the reef topography have not yet arrived the wave field is consistent with the free wave field as time goes on the scattered waves are completely absorbed by the artificial boundaries consequently it can be indicated from the above phenomena that the numerical approaches adopted in this study including the artificial boundaries for fluid and solid medium and the seismic wave input method work efficiently in our analysis model furthermore the acceleration response of the observation point on the reef flat is given in a dimensionless form a x t defined by 14 a x t a x t max a 0 t where x is the horizontal coordinate of the observation point a x t is horizontal acceleration of the observation point on the reef flat and a 0 t is horizontal acceleration on the surface of the flat ground under the same incident wave fig 11 shows the dimensionless acceleration responses of observation points c and d which are the midpoint and corner point of the reef flat respectively the accuracy of the analysis model is verified by comparing the results with those of the extended mesh method which are obtained by increasing the length of the near field calculation domain so that the reflected wave will not return to the observation point within the calculation time additionally by establishing a calculation model of the same dimensions and material properties but without seawater and then conducting a dynamic analysis the acceleration response of the corresponding land site is obtained and compared with that of the reef engineering site as illustrated in fig 11 it is obvious that the absence of seawater causes significant differences in the acceleration response to be specific the absolute maximum relative error is approximately 14 4 for the midpoint c and approximately 22 5 for the corner point d 4 parametric analysis in this section the influence of input waves and topographic factors on the seismic response are studied through a series of seismic analyses of the reef seawater system previous studies have shown that the slope gradients of reefs in the south china sea are generally between 10 and 60 can occasionally exceed 80 in some areas shan et al 2000 meng et al 2014 to begin nine finite element models of the reef seawater system are established with the sea facing slope gradients θ uniformly distributed between 10 and 90 the other dimensions are h 600 m l 500 m l f 800 m and h s 1000 m see fig 6 the material properties are listed in table 1 the pulse wave shown in fig 9 and the three actual acceleration time histories see fig 12 recorded in the loma prieta earthquake the imperial valley earthquake and the chichi earthquake are selected as the incident sv waves and are input vertically through the seismic wave input method the amplitudes of the seismic acceleration recordings are all set to 0 1 g 4 1 effect of input waves it is well known that the peak ground acceleration pga of the engineering site as the key ground motion parameter for seismic design has always been an area of concern for seismologists and structural engineers to measure the seismic amplification effect of reef engineering sites with respect to the pga the peak acceleration ratio r a is defined by 15 r a x max a x t max a 0 t the spatial distributions of the peak acceleration ratio r a on the reef flat are plotted in fig 13 in which the vertical axis shows the peak acceleration ratio and the horizontal axis shows the x coordinate of each observation point where the midpoint of the reef flat is the origin of the coordinates it can be observed that the spatial distributions of the ground motion field vary significantly with the input dynamic loads in the case of the incident pulse wave when θ 30 the acceleration response near the edge is greatest and the distribution of the peak acceleration ratio r a is u shaped when θ 30 however the acceleration near the middle and edge of the reef flat is higher than that between these two areas and thus the distribution of the peak acceleration ratio r a is w shaped by contrast under the three incident seismic waves the ground motion field is more complicated and it seems difficult to draw a general spatial distribution law of the peak acceleration ratios r a nevertheless it still can be determined that the scaling of acceleration response near the middle of the reef flat is further exacerbated under the incident seismic waves compared with that under the incident pulse wave additionally among the input waves used in this study the peak acceleration ratio r a is substantially greatest in the case of the incident loma prieta wave 4 2 effect of slope gradient θ as illustrated in fig 13 the slope gradient θ has a significant effect on the seismic response of the reef seawater system when θ 30 the peak acceleration ratio r a increases with the slope gradient θ and is greater than 1 at most observation points on reef flat indicating that in this situation the acceleration response of the reef site is further magnified compared with that of flat land site while if θ 30 the acceleration response decreases with an increase in the slope gradient θ consequently it is interesting to find that under any of the incident waves selected in this study the peak acceleration ratio r a is greatest when θ 30 which means that the least favorable slope gradient for the seismic response is approximately 30 to investigate the causes of the above phenomenon the seismic responses of the reef seawater system in the frequency domain are analyzed similarly we define the acceleration response amplification factor in the frequency domain which is also known as the acceleration fourier spectrum ratio as the following 16 h a x f f a x f f 0 f where f is the frequency f a x f and f 0 f are the fourier amplitudes of the horizontal acceleration on the reef flat and the surface of the flat ground under the same incident wave respectively the spatial distributions of the acceleration fourier spectrum ratio h a are plotted in a three dimensional image with frequency f and space coordinate x of the observation point as the horizontal coordinates and the fourier spectrum ratio h a as the vertical coordinate as illustrated in fig 14 note that the graph of the model with the largest spectrum ratio at a certain horizontal position will cover the graphs of other models at the same location obviously when f 5 hz the acceleration fourier spectrum ratio h a of the model with θ 30 is largest at most observation points on the reef flat this also occurs on the area near the edge of the reef flat when 5 hz f 15 hz coincidentally the main frequency components of the pulse wave with a pulse duration of 0 2 s and most actual seismic waves including the three used in this paper are distributed in the frequency bands below 15 hz see figs 9 and 12 within this frequency range the earthquake response in the frequency domain of the model with θ 30 is significantly larger than that of the other models therefore after the fourier inverse transformation the maximum acceleration response in time domain appears when θ 30 with the other geometry and material parameters constant at the selected values in this study 4 3 effect of the reef flat s height h to investigate the impact of the reef height h on the seismic response the finite element models established previously are taken as the reference models and the reef height h is changed to 400 m and 1000 m with other parameters constant the pulse wave shown in fig 9 is inputted normally in each case and the dynamic analyses are conducted then the spatial distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a are calculated the results are shown in fig 15 the comparison of figs 13 a 15 a and 15 c shows that the scaling of the peak acceleration is further exacerbated as the height of reef h increases especially in the middle area of reef flat through analyses in the frequency domain as illustrated in figs 14 and 15 b and 15 d this phenomenon can be substantially attributed to the divergence of the spectrum ratios in the low frequency band f 5 hz under different reef heights in addition another notable phenomenon observed is that from the perspective of both the time domain and frequency domain when the reef height h changes θ 30 is still the least favorable reef slope gradient for the seismic response 4 4 effect of the reef flat s width l then the impact of the width of reef flat l on the seismic response is investigated the height of the reef h remains constant at 600 m and the width of reef flat l is changed to 300 m and 1500 m similarly the pulse wave shown in fig 9 is inputted vertically in each case and the spatial distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a are calculated and plotted in fig 16 comparing figs 13 a 16 a and 16 c it can be determined that the influences of the sloping topography on the seismic response is limited to the vicinity of the corner point to be specific the width of the affected area l is approximately 300 m under the incident pulse wave see fig 16 c within this affected area when θ 40 the peak acceleration ratio r a is greater than 1 indicating that the acceleration response is amplified compared to that of the flat land site by contrast when θ 50 the peak acceleration ratio r a is less than 1 and thus the acceleration response near the edge is reduced additionally when the width of the reef flat l is relatively small l 2l the scaling of the peak acceleration is further exacerbated under the superimposed influence of sloping topographies on both sides with an increase in l the seismic amplification effect of the sloping topography on the central area of the reef flat is gradually reduced and the peak acceleration ratios r a in this area tend to approach 1 the spatial distributions of the acceleration fourier spectrum ratio h a produce a nice consistency with those of the peak acceleration ratio r a see figs 14 and 16 b and 16 c within the area affected by the sloping topography the spectrum ratio fluctuates drastically with the frequency f and the fluctuation range varies with the slope gradient θ however in the area less affected by the sloping topography the spectrum ratio fluctuates slightly at approximately 1 regardless of the slope gradient θ notably the above affected area l 300 m is obtained under the incident pulse wave and is mainly determined by its single peak feature in cases where the seismic waves with multi peaks are inputted the values of l may be different due to the wave superposition but the influence rules and principles of the sloping topography are the same moreover both the distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a demonstrate that even when the width of the reef flat l changes θ 30 is still the least favorable reef slope gradient for the seismic response 5 seismic analysis of typical layered reef seawater system in this section we consider the seismic response of the reef seawater system with more practical and complicated material and geometric characteristics according to the previous reports sun and lu 1999 shan et al 2000 meng et al 2014 here the reef is assumed to be three layered along the vertical direction as shown in fig 17 the shape of the reef is controlled by the width of reef flat l as well as the height h i and the slope gradient θ i of each reef layer where i 1 2 and 3 respectively the velocities of elastic waves and the mass densities of different layers increase with the depth the geometric and material parameters of the layered reef are listed in table 2 and the parameters for determining the range of near field domain are l f 800 m and h s 1000 m notably for the shallow of the reef the geological and topographic data is relatively adequate and credible as for the deep terrain it is currently difficult and costly to conduct detailed surveys due to their special locations and complex environmental conditions considering the limited existing information together with the abovementioned findings of the least favorable reef slope the slope gradient of layer 3 θ 3 is set as 20 25 and 30 respectively besides due to the elongated shapes of most coral reefs in the south china sea the width of reef flat varies in different sections here we set it as 500 m 800 m and 1000 m respectively to analyze the seismic response in different locations on the reef platform the pulse wave shown in fig 9 and the three actual acceleration time histories see fig 12 are selected as the incident waves and are input vertically through the seismic wave input method based on the substructure of artificial boundaries the spatial distributions of the peak acceleration ratio r a on the reef flat are calculated and plotted in fig 18 it can be seen that the spatial distributions of the ground motion field vary significantly under the different input dynamic loads overall extreme values are prone to occur near the edges and midpoints of the reef flat not surprisingly in this numerical example the seismic response is still the largest when θ 3 30 one of the most significant differences in this case compared with the homogeneous models of previous parametric analysis is the addition of weak layers with lower elastic wave velocities due to the transmission of seismic waves from the hard layers to the weak layers the seismic response on the reef flat is further amplified by comparing figs 13 and 18 it can be seen that the peak acceleration ratio r a of the layered reef model is magnified by about 1 times on the basis of the homogeneous reef model moreover in the region near the edges of reef flat the acceleration amplifications under the different widths of reef flat l are relatively consistent with each other and the peak acceleration ratio r a in this area distributes between 3 and 4 as for the middle area the peak acceleration ratio r a is between 1 5 and 2 5 under most circumstances while with the decrease of the width of reef flat l as we analyzed previously in the parametric studies the scaling of the peak acceleration in the middle area is further exacerbated under the superimposed influence of sloping topographies on both sides and the peak acceleration ratio r a can reach up to 4 6 summary and conclusions a dynamic analysis model of the reef seawater system is elaborated in this study which is demonstrated to be an accurate and efficient research tool for seismic calculation of the reef engineering site the parametric studies have been conducted and some basic influence rules of the topographic factors have been presented it points out that the seismic responses of the reef engineering sites are significantly different from those of the corresponding land sites meanwhile an interesting finding is that the least favorable slope gradient θ for the seismic response is generally at approximately 30 in addition based on the reported geological and topographic information together with the findings from the parametric studies we performed the seismic analysis of typical layered reef models the results indicate that the wave velocity reduction along the vertical direction of the reef further magnifies the seismic response on the reef flat the peak acceleration ratio r a near the edges of the reef flat distributes between 3 and 4 while in the middle area it is usually between 1 5 and 2 5 and can reach up to 4 when the width of reef flat l decreases however it should be noted that the numerical models used in this study are idealized and insufficient in describing the diversity and complexity of topographic and material characteristics of real coral reefs meanwhile the selected seismic waves are deficient in reflecting the unique marine seismological environment where the reefs located thus to investigate the detailed dynamic behavior of the important reef engineering sites specific systematic studies should be conducted including seismic zoning and seismic activity parameters determining in the ocean area topographical surveys and deep material properties testing etc on that basis further seismic response studies can be conducted with the help of the presented analysis model of the reef seawater system in this article acknowledgements this work is supported by national natural science foundation of china 51878384 51478247 and national key research and development program of china 2016yfc1402800 their financial support is highly appreciated 
22859,the seismic response analysis of a reef engineering site is the foundation for the seismic design of artificial islands and other upper constructions this study proposes a two dimensional seismic analysis model for the reef seawater system where the fluid solid coupling effect is considered and the wave radiation effects of infinite fluid and solid domains are simulated by corresponding artificial boundary conditions meanwhile the seismic wave input method based on the substructure of artificial boundaries is modified to accomplish the process of inputting the seismic waves with arbitrary incident angles into the calculation region the accuracy of the proposed model is verified by numerical examples afterwards we conduct the parametric studies and the seismic analysis of a series of practical layered reef models the results indicate that the least favorable slope gradient for the seismic response is generally at approximately 30 and the feature of wave velocity reduction along the vertical direction significantly magnifies the seismic response on the reef flat the peak acceleration ratio near the edges of the reef flat distributes between 3 and 4 while in the middle area it is usually between 1 5 and 2 5 and can reach up to 4 when the width of reef flat decreases keywords reef seawater artificial boundary seismic wave input fluid solid coupling earthquake ground movement 1 introduction significant progress has been made recently in the exploration and exploitation of offshore reefs represented by the construction of artificial islands in the south china sea however such engineered reefs are under constant threat of earthquakes the 1995 hoyogo ken nanbu earthquake for example caused extensive damage to the concrete caisson artificial islands in japan destroying all piers on the islands fukue and kawakami 1996 hence to scientifically exploit offshore reefs and ensure the seismic safety of engineered reefs it is necessary to understand the engineering characteristics and dynamic behaviors of a reef engineering site current reported advances in research on reef engineering sites mainly focus on two topics one is the physical and mechanical properties of calcareous soils and rocks meng et al 2009 wang et al 2011 2017 zhu et al 2014 which have served as the building materials for artificial island constructions the other topic drawing researchers attention is the stability of offshore reefs for example guo et al 2017 and tang et al 2018 analyzed the shallow strata stability of the zhubi and yongshu reefs in the south china sea by the limit equilibrium method by contrast the seismic response of an offshore reef engineering site which is the basis for the seismic design of artificial islands and other upper constructions has received little attention and analysis tools for this subject are limited therefore developing an effective seismic analysis model to investigate the seismic response of reef seawater system is urgent and meaningful the simulation of the seismic response of the reef seawater system involves three key issues the interaction between the reef and seawater the wave radiation effects of the infinite fluid and solid medium and the seismic wave input first from the perspective of the fluid solid coupling effect there are some similarities between the reef seawater system and marine structures the seismic analysis of the latter such as dams fok and chopra 2010 wang et al 2013 seawalls chen and huang 2002 rajesh and choudhury 2016 and deep water piers du et al 2014 wang et al 2018a 2018b 2019 have drawn significant attention for decades and have provided guidance and insight for the dynamic analysis of reef seawater systems however as far as the calculation model is concerned the size of offshore reefs unlike common marine structures is extremely large and their depth and length vary from hundreds to thousands of meters meng et al 2014 under such circumstances the wave propagation in the system especially the wave radiation in infinite seawater and seabed will significantly affect the dynamic behavior of reefs the common method to address the unbounded medium is to intercept a near field calculation domain and set artificial boundaries on the cutoff boundaries which aim to absorb the scattered wave from the internal computational region the artificial boundary for solid medium is a classic research field in geotechnical engineering and thus more mature in development the representative achievements in this area include the boundary element method karabalis and beskos 1984 infinite element method zhao and valliappan 1993 the scaled boundary finite element method yann et al 2004 transmitting boundary liao et al 1984 viscous boundary georges et al 2011 and viscous elastic boundary liu et al 2005 du et al 2006 with the development of ocean engineering in recent years the wave radiation effect of infinite fluid medium is also concerned due to its significant influence on the dynamic response of marine structures and the simulation approaches for this problem have been increasingly studied based on different mathematical physical and mechanical techniques tsai and lee 1990 fan et al 2004 zhang et al 2013 wang et al 2015 very recently we deduced a new fluid artificial boundary based on the media wave theory liu et al 2017 this new fluid artificial boundary belongs to the stress type artificial boundaries and is applicable to the fluid solid coupling dynamic analysis of a large complex reef engineering site due to its superior spatial decoupling characteristics and convenient assembling into finite element software when the artificial boundaries are applied on the cutoff boundaries the third issue mentioned above which requires inputting the earthquake loads into the calculation domain through the cutoff boundaries without affecting the absorption of outgoing waves becomes a concern and needs to be solved to achieve that purpose wolf 1989 converted the normally incident seismic waves into equivalent loads on the one dimensional viscous boundary which is known as the free field boundary method after that yasui et al 1988 modified this method to approximately input the obliquely incident wave then based on the characteristics of the wave field liu and lu 1998 proposed the wave method for viscous elastic boundaries whose equivalent seismic loads are obtained through the analysis of a free field model although the wave method has been proven to be valid and accurate it is still slightly complicated in practice nevertheless further research improved the wave method by calculating the equivalent loads through the dynamic analysis of a substructure model containing the artificial boundaries as a result the seismic wave input method based on the substructure of artificial boundaries was proposed liu et al 2018 while this new method is easier to process it is originally used for the wave input in the land site in this article this new method is further improved to accomplish the seismic wave input in the reef seawater system due to the impacts of ocean currents and monsoons most of the offshore reefs in the south china sea are of somewhat elongated and elliptical shapes zhan et al 1995 take the yongshu reef which is 25 km long and 6 km wide as an example meng et al 2014 when subjected to an earthquake whose vibration direction is orthogonal to the long axis the stress state of its middle section can be approximated to the plane strain state which can be simulated by a two dimensional numerical model therefore a two dimensional time domain seismic analysis model of the reef seawater system is established in this study then the accuracy of this analysis model is verified through numerical examples afterwards a series of seismic analysis of the reef engineering site is conducted and several fundamental issues including the differences between the offshore reef engineering site and land site as well as the influence of the characteristics of the input seismic wave and the topographic factors on the seismic response are discussed 2 numerical methods fig 1 shows a typical cross section schematic of the reef seawater system which is essentially an external source problem of a semi infinite open system considering the fluid solid coupling effect a near field calculation domain should be intercepted to establish the analysis model and the cutoff boundaries need to be manipulated to input the seismic waves and absorb the scattered waves in this section the numerical approaches applied to simulate the reef seawater system specifically the artificial boundaries for fluid and solid medium as well as the seismic wave input method will be introduced on that basis the dynamic analysis model of the reef seawater system will be established 2 1 artificial boundary for fluid medium to simulate the wave radiation effect of an infinite fluid medium a new fluid artificial boundary was proposed by us very recently liu et al 2017 in the following a brief introduction and theoretical derivation of this new fluid artificial boundary is given the cylindrical wave equation for a non viscous and compressible fluid in the two dimensional polar coordinate system is expressed as 1 2 ϕ t 2 c f 2 2 ϕ r 2 1 r ϕ r where ϕ is the displacement potential function namely u r ϕ r u r is the radial displacement c f k ρ f is the velocity of sound in fluid medium k and ρ f are the bulk modulus and density of the fluid respectively in the case of small disturbances the hydrodynamic pressure p can be obtained 2 p k 2 ϕ r 2 1 r ϕ r the approximate solution of eq 1 when only outgoing waves are taken into consideration can be obtained as follows 3 ϕ r t 1 r f r c f t by substituting eq 3 into eq 1 and taking the second derivative with respect to the time variable t the following equation can be obtained 4 2 u r t 2 c f 2 2 r 3 2 f r c f t c f 2 r 1 2 f r c f t combining eqs 1 4 gives 5 p 2 r c f p t 2 ρ f r 2 u r t 2 eq 5 provides the artificial boundary condition on the cutoff boundary this boundary condition can be equivalent to a damper mass system shown in fig 2 and the physical parameters of the equivalent damper mass system are as follows 6 m 2 ρ f r c ρ f c f after discretizing the model through the finite element method the above physical parameters can be changed into the following form 7 m b 2 ρ f r b i a i c b ρ f c f i a i where r b is defined as the distance from the wave source to the boundary node accordingly in the reef seawater finite element model r b is the horizontal distance from the reef slope to the artificial boundary node i a i is the area represented by the artificial boundary node in the finite element model it can be seen that this new artificial boundary for fluid medium belongs to the stress type artificial boundaries and is decoupled in space thus can be easily assembled into finite element software and integrated with the seismic wave input method introduced later 2 2 artificial boundary for solid medium as for the simulation of the unbounded solid domain many numerical approaches as mentioned above have been proposed among these methods the consistent viscous spring artificial boundary element liu et al 2006 has gained widespread use because of its high accuracy and simplified application in this study it is adopted to simulate the wave radiation effect of a reef and seabed the implementation procedure of this method is to extend a layer of solid elements along the normal direction on the solid cutoff boundaries which are defined as the equivalent elements and then fix the outer boundaries of the equivalent element layer meanwhile the material properties of the equivalent elements are designated to ensure that they work equally as the viscous elastic artificial boundary for two dimensional application the shear modulus g young s modulus e and elemental material damping coefficient η of the equivalent elements are given by 8 g α t h g r e α n h g r 1 γ 1 2 γ 1 γ η ρ s r 2 g c s α t c p α n where h is the thickness of the equivalent element layer and r is the distance from the wave source to the artificial boundary node which is usually approximate to the average value since the scattered source is not a single point source for the lateral and bottom equivalent elements in our model the values of r are the distances from the midpoint of the reef bottom to the lateral and bottom boundaries respectively α n and α t are the artificial boundary coefficients whose recommended values are 1 and 0 5 respectively liu et al 2006 c s and c p are the velocities of the shear and compression waves in the solid medium respectively g and ρ s are the shear modulus and mass density of the solid medium respectively γ is the equivalent poisson s ratio defined by 9 γ α 2 2 α 1 α 2 0 α 2 where α α n α t 2 3 seismic wave input method based on the substructure of artificial boundaries in this section the seismic wave input method based on the substructure of artificial boundaries liu et al 2018 is modified to accomplish the process of inputting earthquake waves with arbitrary incident angles into the reef seawater system according to the wave method theory liu and lu 1998 incident seismic wave can be converted into equivalent loads on the cutoff boundaries which are only related to the free wave field and unaffected by internal terrains additionally the reasonable equivalent input seismic loads should ensure that the motions and stresses of the cutoff boundaries are consistent with those of the free wave field therefore by imposing the free wave field motions on the nodes of the free field model and conducting a dynamic analysis the equivalent input seismic loads can be obtained which are exactly the reaction forces on the cutoff boundaries the free field model corresponding to the reef seawater system is a half space model with an overlying seawater layer whose finite element model is shown in fig 3 a the nodes can be classified into three types according to their positions namely the artificial boundary nodes represented by solid red dots the internal nodes next to the artificial boundaries represented by solid blue dots and the remaining internal nodes represented by open circles according to the classification of the nodes the motion equation of the free field model is expressed as 10 m ii 0 m in 0 0 m ni 0 m nn 0 m nb 0 0 m bn 0 m bb 0 u i 0 u n 0 u b 0 c ii 0 c in 0 0 c ni 0 c nn 0 c nb 0 0 c bn 0 c bb 0 u i 0 u n 0 u b 0 k ii 0 k in 0 0 k ni 0 k nn 0 k nb 0 0 k bn 0 k bb 0 u i 0 u n 0 u b 0 0 0 f b where u 0 u 0 and u 0 are the nodal displacement velocity and acceleration vectors of the free field respectively m 0 c 0 and k 0 are the mass damping and stiffness matrices of the free field model respectively the subscripts b n and i denote the artificial boundary nodes internal nodes next to the artificial boundaries and the remaining internal nodes respectively and f b is the reaction force vector on the cutoff boundaries which is also the equivalent input seismic loads according to the theory of finite element discretization when the mesh generation near the artificial boundaries of the reef seawater system is the same as that of the free field model as shown in fig 3 b the following equations can be obtained 11 m nb 0 m nb m bn 0 m bn m bb 0 m bb c nb 0 c nb c bn 0 c bn c bb 0 c bb k nb 0 k nb k bn 0 k bn k bb 0 k bb where m c and k are the mass damping and stiffness matrices of the finite element model of reef seawater system respectively by substituting eq 11 into eq 10 and solving the equations the equivalent input seismic loads f b can be obtained 12 f b m bn u n 0 m bb u b 0 c bn u n 0 c bb u b 0 k bn u n 0 k bb u b 0 furthermore eq 12 can be equivalent to the motion equation of the substructure within the dashed box in fig 3 b which is defined as the substructure of artificial boundaries this equation indicates that if the motions of the artificial boundary nodes and internal nodes next to the artificial boundaries are consistent with those of the free wave field the reaction forces on the artificial boundaries are the equivalent input seismic loads namely the equivalent input seismic loads can be gained through the dynamic analysis of the substructure model under the imposed free wave field motions in addition the substructure model of artificial boundaries can be obtained directly from the finite element model of the reef seawater system instead of establishing a new model notably although eq 12 involves three sets of variables displacement velocity and acceleration only one of them needs to be implemented and the other two sets of variables can be automatically obtained through the dynamic analysis of the substructure model according to the abovementioned theoretical derivations the implementation steps of the seismic wave input method based on the substructure of artificial boundaries in the reef seawater system are provided as follows 1 establish the finite element model of the reef seawater system as shown in fig 3 b then the substructure model can be obtained by deleting all elements containing the remaining internal nodes as shown in fig 4 2 for a given earthquake time history the free wave motions of each node location can be obtained based on the travelling wave theory then by imposing the corresponding free field motions u 0 on each nodes of the substructure model as shown in fig 4 and conducting a dynamic analysis the reaction forces f b on the artificial boundary nodes can be obtained which are exactly the equivalent input seismic loads notably the calculation of the free wave field naturally considers the spatial distributions of the incident waves therefore the wave motions u 0 and the reaction forces f b vary on different substructure nodes and the data management is a bit complex we strongly recommend to develop a subprogram to complete this procedure 3 impose the equivalent input seismic loads f b on the corresponding artificial boundary nodes of the reef seawater model and the process of seismic wave input is accomplished as shown in fig 5 then the seismic response of the reef seawater system can be obtained through dynamic analysis 3 modeling and verification 3 1 dynamic analysis model of reef seawater system now we can establish the dynamic analysis model of the reef seawater system with the help of the numerical approaches introduced above general finite element software ansys is used here for simulation the seawater is modeled by fluid80 elements which are in a displacement scheme and particularly suitable for calculating fluid solid interactions meanwhile solid45 elements are used for modeling the reef seabed and solid artificial boundaries the fluid artificial boundaries are modeled by the recommended combin40 spring damping mass elements liu et al 2017 however both fluid80 and solid45 elements are three dimensional elements thus only one layer of elements in the plane is established in the two dimensional model and the out of plane degrees of freedom of all nodes are constrained additionally the interaction between the fluid and solid is simulated by coupling the coincident nodes in the interface only in the direction normal to the interface bao and liu 2017 the preprocesses including the parameters determination and elements addition of the artificial boundaries as well as the implementation of the seismic wave input method are compiled with the command stream based on ansys parametric design language apdl notably on the basis of the numerical methods introduced in this study other engineering simulation programs are also suitable for establishing the analysis model of the reef seawater system through the similar procedures the reported information shows that the coral sand layers on the reefs in the south china sea are relatively shallow less than 17 3 m beneath them are all the bedrock composed of reef limestone meng et al 2014 in this study we mainly focus on the propagation of seismic wave in the reef seawater system as well as the distribution of ground motion field on the rock site of reef which are the foundation for the seismic design of artificial islands and other upper constructions therefore the influences of the coral sand are neglected and the bedrocks are assumed to be elastic due to their features of high wave velocities sun and lu 1999 besides although the seismic wave input method modified in this study can effectively input any plane waves with arbitrary incident angles into the reef seawater model only the vertical incident sv waves which are the most commonly used load cases in earthquake engineering are considered here for exploration of general regularity here in the model verification and parameter analysis the average slope gradient θ the height of reef h and the width of reef flat l are taken as governing parameters for determining its topography and the distance from the bottom corner of the reef to the cutoff boundary l f as well as the height of the intercepted seabed h s are designated to determine the size of the near field calculation domain as shown in fig 6 additionally according to the reported wave velocity data of the yongshu reef in the south china sea sun and lu 1999 the approximate material properties of the reef seawater system are estimated and listed in table 1 more complicated and practical models will be established and analyzed in the case study of typical layered reef seawater system 3 2 applicability of the fluid artificial boundary in the seismic analysis of the reef seawater system the fluid artificial boundary is derived based on the full space wave theory and has been verified to be accurate in the full space wave radiation problems liu et al 2017 however the applicability of this fluid artificial boundary in the wave propagation simulation of the infinite seawater layer which is essentially a waveguide problem remains to be validated for that purpose the effects of wave propagation in solid medium should be exclude therefore in this numerical example we assume that the solid domain is rigid and the interface between the solid and fluid is vertical the dimensions of the fluid domain are as follows h 600 m and l f 800 m a oscillating wave with a stable period of 1 s is selected as the incident wave as shown in fig 7 the theoretical solution of the hydrodynamic pressure on the lateral wall in this model is given by eq 13 chopra 1967 where h is the height of the observation point above the water bottom u g t is the horizontal acceleration time history of the rigid wall j 0 is the zero order bessel function and λ n 2 n 1 π 2 h the numerical solutions are obtained by two methods present analysis model with fluid artificial boundaries set on the cutoff boundaries and fixing the cutoff boundaries the hydrodynamic pressures of observation points a and b are plotted in fig 8 the heights of a and b above the water bottom are 500 m and 100 m respectively the results show that the hydrodynamic pressures calculated by means of the present analysis model agree well with the theoretical solution indicating that the fluid artificial boundaries can effectively absorb the outgoing waves in the water layer however when the cutoff boundaries are fixed the waves cannot be transmitted to the virtual infinite domain and thus always propagate back and forth in the computational region consequently the result calculated by the fixed boundary model is significantly different from the theoretical solution 3 3 testing of the seismic analysis model of the reef seawater system then we perform the second numerical example to demonstrate the validity of the seismic analysis model of the reef seawater system the dimensions of the model are as follows h 600 m l 500 m θ 30 l f 800 m and h s 1000 m see fig 6 the reef is assumed to be elastic and its material properties are listed in table 1 a dirac δ pulse sv wave with a pulse duration of 0 2 s is vertically inputted through the seismic wave input method its displacement time history and fourier amplitude spectrum are plotted in fig 9 fig 10 shows the snapshots of the calculated displacement wave field it can be observed that the wave front is smooth and continuous near the cutoff boundaries meanwhile in the region where the scattered waves caused by the reef topography have not yet arrived the wave field is consistent with the free wave field as time goes on the scattered waves are completely absorbed by the artificial boundaries consequently it can be indicated from the above phenomena that the numerical approaches adopted in this study including the artificial boundaries for fluid and solid medium and the seismic wave input method work efficiently in our analysis model furthermore the acceleration response of the observation point on the reef flat is given in a dimensionless form a x t defined by 14 a x t a x t max a 0 t where x is the horizontal coordinate of the observation point a x t is horizontal acceleration of the observation point on the reef flat and a 0 t is horizontal acceleration on the surface of the flat ground under the same incident wave fig 11 shows the dimensionless acceleration responses of observation points c and d which are the midpoint and corner point of the reef flat respectively the accuracy of the analysis model is verified by comparing the results with those of the extended mesh method which are obtained by increasing the length of the near field calculation domain so that the reflected wave will not return to the observation point within the calculation time additionally by establishing a calculation model of the same dimensions and material properties but without seawater and then conducting a dynamic analysis the acceleration response of the corresponding land site is obtained and compared with that of the reef engineering site as illustrated in fig 11 it is obvious that the absence of seawater causes significant differences in the acceleration response to be specific the absolute maximum relative error is approximately 14 4 for the midpoint c and approximately 22 5 for the corner point d 4 parametric analysis in this section the influence of input waves and topographic factors on the seismic response are studied through a series of seismic analyses of the reef seawater system previous studies have shown that the slope gradients of reefs in the south china sea are generally between 10 and 60 can occasionally exceed 80 in some areas shan et al 2000 meng et al 2014 to begin nine finite element models of the reef seawater system are established with the sea facing slope gradients θ uniformly distributed between 10 and 90 the other dimensions are h 600 m l 500 m l f 800 m and h s 1000 m see fig 6 the material properties are listed in table 1 the pulse wave shown in fig 9 and the three actual acceleration time histories see fig 12 recorded in the loma prieta earthquake the imperial valley earthquake and the chichi earthquake are selected as the incident sv waves and are input vertically through the seismic wave input method the amplitudes of the seismic acceleration recordings are all set to 0 1 g 4 1 effect of input waves it is well known that the peak ground acceleration pga of the engineering site as the key ground motion parameter for seismic design has always been an area of concern for seismologists and structural engineers to measure the seismic amplification effect of reef engineering sites with respect to the pga the peak acceleration ratio r a is defined by 15 r a x max a x t max a 0 t the spatial distributions of the peak acceleration ratio r a on the reef flat are plotted in fig 13 in which the vertical axis shows the peak acceleration ratio and the horizontal axis shows the x coordinate of each observation point where the midpoint of the reef flat is the origin of the coordinates it can be observed that the spatial distributions of the ground motion field vary significantly with the input dynamic loads in the case of the incident pulse wave when θ 30 the acceleration response near the edge is greatest and the distribution of the peak acceleration ratio r a is u shaped when θ 30 however the acceleration near the middle and edge of the reef flat is higher than that between these two areas and thus the distribution of the peak acceleration ratio r a is w shaped by contrast under the three incident seismic waves the ground motion field is more complicated and it seems difficult to draw a general spatial distribution law of the peak acceleration ratios r a nevertheless it still can be determined that the scaling of acceleration response near the middle of the reef flat is further exacerbated under the incident seismic waves compared with that under the incident pulse wave additionally among the input waves used in this study the peak acceleration ratio r a is substantially greatest in the case of the incident loma prieta wave 4 2 effect of slope gradient θ as illustrated in fig 13 the slope gradient θ has a significant effect on the seismic response of the reef seawater system when θ 30 the peak acceleration ratio r a increases with the slope gradient θ and is greater than 1 at most observation points on reef flat indicating that in this situation the acceleration response of the reef site is further magnified compared with that of flat land site while if θ 30 the acceleration response decreases with an increase in the slope gradient θ consequently it is interesting to find that under any of the incident waves selected in this study the peak acceleration ratio r a is greatest when θ 30 which means that the least favorable slope gradient for the seismic response is approximately 30 to investigate the causes of the above phenomenon the seismic responses of the reef seawater system in the frequency domain are analyzed similarly we define the acceleration response amplification factor in the frequency domain which is also known as the acceleration fourier spectrum ratio as the following 16 h a x f f a x f f 0 f where f is the frequency f a x f and f 0 f are the fourier amplitudes of the horizontal acceleration on the reef flat and the surface of the flat ground under the same incident wave respectively the spatial distributions of the acceleration fourier spectrum ratio h a are plotted in a three dimensional image with frequency f and space coordinate x of the observation point as the horizontal coordinates and the fourier spectrum ratio h a as the vertical coordinate as illustrated in fig 14 note that the graph of the model with the largest spectrum ratio at a certain horizontal position will cover the graphs of other models at the same location obviously when f 5 hz the acceleration fourier spectrum ratio h a of the model with θ 30 is largest at most observation points on the reef flat this also occurs on the area near the edge of the reef flat when 5 hz f 15 hz coincidentally the main frequency components of the pulse wave with a pulse duration of 0 2 s and most actual seismic waves including the three used in this paper are distributed in the frequency bands below 15 hz see figs 9 and 12 within this frequency range the earthquake response in the frequency domain of the model with θ 30 is significantly larger than that of the other models therefore after the fourier inverse transformation the maximum acceleration response in time domain appears when θ 30 with the other geometry and material parameters constant at the selected values in this study 4 3 effect of the reef flat s height h to investigate the impact of the reef height h on the seismic response the finite element models established previously are taken as the reference models and the reef height h is changed to 400 m and 1000 m with other parameters constant the pulse wave shown in fig 9 is inputted normally in each case and the dynamic analyses are conducted then the spatial distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a are calculated the results are shown in fig 15 the comparison of figs 13 a 15 a and 15 c shows that the scaling of the peak acceleration is further exacerbated as the height of reef h increases especially in the middle area of reef flat through analyses in the frequency domain as illustrated in figs 14 and 15 b and 15 d this phenomenon can be substantially attributed to the divergence of the spectrum ratios in the low frequency band f 5 hz under different reef heights in addition another notable phenomenon observed is that from the perspective of both the time domain and frequency domain when the reef height h changes θ 30 is still the least favorable reef slope gradient for the seismic response 4 4 effect of the reef flat s width l then the impact of the width of reef flat l on the seismic response is investigated the height of the reef h remains constant at 600 m and the width of reef flat l is changed to 300 m and 1500 m similarly the pulse wave shown in fig 9 is inputted vertically in each case and the spatial distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a are calculated and plotted in fig 16 comparing figs 13 a 16 a and 16 c it can be determined that the influences of the sloping topography on the seismic response is limited to the vicinity of the corner point to be specific the width of the affected area l is approximately 300 m under the incident pulse wave see fig 16 c within this affected area when θ 40 the peak acceleration ratio r a is greater than 1 indicating that the acceleration response is amplified compared to that of the flat land site by contrast when θ 50 the peak acceleration ratio r a is less than 1 and thus the acceleration response near the edge is reduced additionally when the width of the reef flat l is relatively small l 2l the scaling of the peak acceleration is further exacerbated under the superimposed influence of sloping topographies on both sides with an increase in l the seismic amplification effect of the sloping topography on the central area of the reef flat is gradually reduced and the peak acceleration ratios r a in this area tend to approach 1 the spatial distributions of the acceleration fourier spectrum ratio h a produce a nice consistency with those of the peak acceleration ratio r a see figs 14 and 16 b and 16 c within the area affected by the sloping topography the spectrum ratio fluctuates drastically with the frequency f and the fluctuation range varies with the slope gradient θ however in the area less affected by the sloping topography the spectrum ratio fluctuates slightly at approximately 1 regardless of the slope gradient θ notably the above affected area l 300 m is obtained under the incident pulse wave and is mainly determined by its single peak feature in cases where the seismic waves with multi peaks are inputted the values of l may be different due to the wave superposition but the influence rules and principles of the sloping topography are the same moreover both the distributions of the peak acceleration ratio r a and acceleration fourier spectrum ratio h a demonstrate that even when the width of the reef flat l changes θ 30 is still the least favorable reef slope gradient for the seismic response 5 seismic analysis of typical layered reef seawater system in this section we consider the seismic response of the reef seawater system with more practical and complicated material and geometric characteristics according to the previous reports sun and lu 1999 shan et al 2000 meng et al 2014 here the reef is assumed to be three layered along the vertical direction as shown in fig 17 the shape of the reef is controlled by the width of reef flat l as well as the height h i and the slope gradient θ i of each reef layer where i 1 2 and 3 respectively the velocities of elastic waves and the mass densities of different layers increase with the depth the geometric and material parameters of the layered reef are listed in table 2 and the parameters for determining the range of near field domain are l f 800 m and h s 1000 m notably for the shallow of the reef the geological and topographic data is relatively adequate and credible as for the deep terrain it is currently difficult and costly to conduct detailed surveys due to their special locations and complex environmental conditions considering the limited existing information together with the abovementioned findings of the least favorable reef slope the slope gradient of layer 3 θ 3 is set as 20 25 and 30 respectively besides due to the elongated shapes of most coral reefs in the south china sea the width of reef flat varies in different sections here we set it as 500 m 800 m and 1000 m respectively to analyze the seismic response in different locations on the reef platform the pulse wave shown in fig 9 and the three actual acceleration time histories see fig 12 are selected as the incident waves and are input vertically through the seismic wave input method based on the substructure of artificial boundaries the spatial distributions of the peak acceleration ratio r a on the reef flat are calculated and plotted in fig 18 it can be seen that the spatial distributions of the ground motion field vary significantly under the different input dynamic loads overall extreme values are prone to occur near the edges and midpoints of the reef flat not surprisingly in this numerical example the seismic response is still the largest when θ 3 30 one of the most significant differences in this case compared with the homogeneous models of previous parametric analysis is the addition of weak layers with lower elastic wave velocities due to the transmission of seismic waves from the hard layers to the weak layers the seismic response on the reef flat is further amplified by comparing figs 13 and 18 it can be seen that the peak acceleration ratio r a of the layered reef model is magnified by about 1 times on the basis of the homogeneous reef model moreover in the region near the edges of reef flat the acceleration amplifications under the different widths of reef flat l are relatively consistent with each other and the peak acceleration ratio r a in this area distributes between 3 and 4 as for the middle area the peak acceleration ratio r a is between 1 5 and 2 5 under most circumstances while with the decrease of the width of reef flat l as we analyzed previously in the parametric studies the scaling of the peak acceleration in the middle area is further exacerbated under the superimposed influence of sloping topographies on both sides and the peak acceleration ratio r a can reach up to 4 6 summary and conclusions a dynamic analysis model of the reef seawater system is elaborated in this study which is demonstrated to be an accurate and efficient research tool for seismic calculation of the reef engineering site the parametric studies have been conducted and some basic influence rules of the topographic factors have been presented it points out that the seismic responses of the reef engineering sites are significantly different from those of the corresponding land sites meanwhile an interesting finding is that the least favorable slope gradient θ for the seismic response is generally at approximately 30 in addition based on the reported geological and topographic information together with the findings from the parametric studies we performed the seismic analysis of typical layered reef models the results indicate that the wave velocity reduction along the vertical direction of the reef further magnifies the seismic response on the reef flat the peak acceleration ratio r a near the edges of the reef flat distributes between 3 and 4 while in the middle area it is usually between 1 5 and 2 5 and can reach up to 4 when the width of reef flat l decreases however it should be noted that the numerical models used in this study are idealized and insufficient in describing the diversity and complexity of topographic and material characteristics of real coral reefs meanwhile the selected seismic waves are deficient in reflecting the unique marine seismological environment where the reefs located thus to investigate the detailed dynamic behavior of the important reef engineering sites specific systematic studies should be conducted including seismic zoning and seismic activity parameters determining in the ocean area topographical surveys and deep material properties testing etc on that basis further seismic response studies can be conducted with the help of the presented analysis model of the reef seawater system in this article acknowledgements this work is supported by national natural science foundation of china 51878384 51478247 and national key research and development program of china 2016yfc1402800 their financial support is highly appreciated 
