index,text
2595,a comprehensive study of 96 bottled mineral water bmw samples consisting of 21 of the most popular origins and brands sourced from china n 38 france n 20 italy n 10 new zealand n 17 and fiji n 12 has been undertaken the δ 18o and δ 13c of dissolved inorganic carbon dic δ 18o and δ 2h of water mineral elements li na mg k ca sr and ions cl so4 2 f co3 2 hco3 were investigated and used for origin traceability the origin of bmw was confirmed by applying fisher discriminant analysis fisher da and artificial neural network ann models to these variables δ 18odic δ 13cdic δ 18o δ 2h values of bmw showed significant deviations with origin mineral elements and anions varied widely due to different regional geology and hydrology characteristics a discriminant model based on fisher da showed that the identification accuracy of mineral water from different origins was in the range of 81 to 100 whereas the discriminant accuracy was 100 for the training samples and 96 0 for the testing samples calculated by ann hco3 no3 δ 2h δ 18o and f were the most important variables that characterized bmws from different origins using a combination of stable isotopes and different water chemical components bmws from china can be accurately distinguished from other origins using multivariate statistical models keywords bottled mineral water stable isotopes hydrochemistry origin traceability artificial neural network discriminant analysis data availability data will be made available on request 1 introduction bottled mineral water bmw is an important beverage worldwide delivering a safe convenient and reliable source of drinking water pllana and qosa 2019 with increasing economic globalization the number of imported mineral water brands in the chinese market is increasing and the import volume and consumption of mineral water is growing rapidly china s mineral water imports have continued to rise in recent years reaching 166 600 kiloliters and 89 72 million dollars in 2019 unpublished data from china customs however potential health and safety problems driven by economic fraud may exist in the bottled water market such as domestic water counterfeits replacing imported water surface water or tap water sold as higher priced mineral water or glacier water etc china has strict safety standards for bottled mineral water such as gb 19298 2014 general administration of quality supervision 2014 for bottled water and gb 8537 2018 state administration for market regulation 2018 for mineral water yet verifying the origin claims of bottled water has become a huge challenge for chinese consumers and import inspection departments such as china customs therefore the establishment of an efficient and accurate method for authenticity verification of bottled drinking water is very important for china s food safety regulatory authorities various studies have already focused on the origin of bottled drinking water guo et al 2019 orellana et al 2019 however in this study we report new research specifically on bottled mineral water mineral water is naturally formed in underground aquifers and is collected by drilling wells rather than collected from springs which bring water to the surface mineral water contains different levels of minerals trace elements or other components state administration for market regulation 2018 most traceability technologies applied to determine the origin of bottled drinking or mineral water include mineral element fingerprints di giuseppe 2017 ristić et al 2011 hydrogen and oxygen stable isotopes bowen et al 2005 rangarajan and ghosh 2011 carbon and oxygen isotopes of dissolved inorganic carbon dic in water brencic and vreca 2007 87sr 86sr isotopes montgomery et al 2006 voerkelius et al 2010 206pb 208pb isotopes möller et al 2004 chemical composition bityukova and petersell 2010 carter et al 2015 or a combination of these above methods carter et al 2015 fan et al 2018 orellana et al 2019 to date stable isotopes are the most effective origin traceability tool and have been used in various food and beverage research applications such as wine wu et al 2021a wu et al 2019 fruit bong et al 2008 wu et al 2021b zhou et al 2021a milk products bontempo et al 2012 zhou et al 2021b and other beverages chesson et al 2010 most previous studies have shown that the δ 2h and δ 18o values of water are influenced by the geographic and hydrological characteristics of the source such as latitude and longitude rangarajan and ghosh 2011 altitude dotsika et al 2010 temperature burnik šturm et al 2017 elmarami et al 2017 seasonal effects sun et al 2016 xiao et al 2016 and evaporation conditions burnik šturm et al 2017 however current research has neglected the potential input of dic isotopes on the origin traceability of bottled water with only a few publications using this method resulting in limited data for bottled water traceability brencic and vreca 2007 brenčič and vreča 2010 the main factors affecting the stable carbon oxygen isotopic ratio of dic in water are the exchange between co2 in atmosphere polsenaere and abril 2012 usdowski and hoefs 1990 rainfall and runoff inputs liu et al 2010 season effects and biological activity myrbo and shapley 2006 in addition some important hydrological factors such as carbonate content ph pco2 temperature silicate minerals etc can also significantly affect the dic content in water and thus the carbon oxygen stable isotope ratio liu et al 2010 therefore the combination of water and dic stable isotopes may provide a more comprehensive fingerprint for the origin of bottled water which still lacks global scale data different ion and mineral contents are also useful variables for the origin traceability of bottled water and have been described in some studies asante and kreamer 2018 di giuseppe 2017 kim et al 2012 previous studies have suggested that stratigraphic lithological and structural constraints on the aquifer placement plays a very important role and influences the distribution of trace elements in spring and mineral waters peh et al 2010 also the chemical characteristics ph conductivity metasilicic acid and ionic content of natural spring and mineral waters depends on the composition of the rocks and soil through which the water passes pantelic et al 2019 this supports the conclusion that mineral and chemical composition of mineral water may inherit geochemical characteristics from the geology of its aquifer however this practical approach still has many limitations firstly the sampling scale of these studies were usually limited to a certain region or country raco et al 2013 rangarajan and ghosh 2011 secondly water investigations frequently comprised of chemical comparisons but no clear origin tracing methods was put forward for many studies fugedi et al 2010 rangarajan and ghosh 2011 rosborg et al 2005 some studies collected too few samples resulting in a lack of robust data and low model accuracy gutiérrez reguera et al 2016 zuliani et al 2020 similarly some studies have investigated the isotopic distribution characteristics of drinking water within china but no operational methods have been designed to identify the origin of specific water samples guo et al 2019 these studies while meeting local requirements may lead to a mismatch with the larger global community needs thus a widely applicable standardized and accurate traceability scheme is still urgently needed for the traceability of commonly traded bottled mineral water in this study bmw imported into china from key sources were collected to analyze isotopic elemental and hydrochemical fingerprints and to evaluate effective variables for origin traceability the study aims to establish an efficient and accurate method for origin verification of bmw import into china that can clearly seperate chinese bmw from other origins and provide insights into characteristics of bmw from other origins 2 material and methods 2 1 sample collection bmw samples were collected irregularly from october 2020 to april 2021 at local markets and importation ports in china a total of 96 bmw samples from china 38 samples france 20 samples italy 10 samples new zealand 17 samples and fiji 12 samples consisting of 21 of the most popular origins and brands sold and imported into chinese markets were collected and analyzed by shenzhen customs the sampling period lasted for 6 months and the majority of bmws were from different production batches even if they are from the same brand detailed information of the samples is shown in fig 1 and table 1 bmws from china are widely distributed and contain different geographical features such as plateau tibet qinghai high latitude changbai mountain basin sichuan or plain jiangxi sourced water french and italian bmw samples were mainly collected from alpine regions new zealand situated on a plate boundary in the southern pacific ocean is dominated by extensive late oligocene early miocene mudstones marls and limestones campbell et al 2012 and has a relatively unique geological setting and receives oceanic precipitation derived from both tropical and antarctic origins fiji consists of two large islands with numerous smaller islands in the central south pacific ocean close to the equator bmws of these pacific ocean countries are controlled primarily by water vapor and tropical oceanic climate while recent volcanological and active plates tectonics cronin et al 2001 also provided a significantly different water chemistry than is seen in other countries 2 2 sample analysis 2 2 1 stable isotopes the δ 2h and δ 18o values of bmw samples were analyzed using an elemental analyzer pyro isotope ratio mass spectrum ea pyro irms thermo fisher bremen germany isotope analytical methods for δ 2h and δ 18o of bmw are modified from bowen et al 2005 the δ 18odic and δ 13cdic values of bmw dic were analyzed using a gasbench irms gasbench ⅱ device thermo fisher bremen germany detailed analysis methods are included in the supplementary files stable isotope ratios were defined as δ r sample r standard 1 where r sample is the ratio of heavy to light isotope in a measured sample such as 13c 12c 18o 16o and 2h 1h r standard is the ratio of heavy to light isotope in a reference standard in this study the reference standards for δ 18odic and δ 13cdic in water was iaea co 8 calcite δ 18odic 22 7 vs v pdb δ 13cdic 5 764 vs v pdb the reference materials for δ 18o and δ 2h were lgr working standards calibrated periodically against primary iaea calibration standards to v smow slap scale 3e δ 2h 79 6 0 5 δ 18o 11 04 0 15 4e δ 2h 49 2 0 5 δ 18o 7 81 0 15 5e δ 2h 9 9 0 5 δ 18o 2 99 0 15 the long term analytical precision for δ 18odic and δ 13cdic in water dic was 0 2 and that of δ 2h and δ 18o in water was 1 0 and 0 2 respectively 2 2 2 mineral elements the mineral elements found in bottled water were measured following the gb 8538 2016 protocol national health and family planning commission 2016 which is the official and mandatory standard for the safety of bottled water in china nexion 300x inductively coupled plasma mass spectrometry icp ms perkinelmer usa was used to analyse six elements li na mg k ca sr a series of multi elemental standard solutions multi element calibration standard 3 perkinelmer usa in 0 5 nitric acid chromatographically pure were used as the calibration standards in indium was used as an internal standard 50 μg l solution to correct for instrument drift the bmws were diluted 1 400 with 0 5 nitric acid chromatographically pure for na mg k ca while no dilution for li and sr the lod and loq of the elements are shown in table s1 2 2 3 anions the anion concentrations of bmws were measured according to gb 8538 2016 protocols national health and family planning commission 2016 an ics5000 ion chromatograph with an electrical conductivity detector thermo fisher usa was used to analyse the concentrations of the four anions f cl so4 2 no3 2 the calibration standards used for f cl so4 2 no3 2 were prepared from gbw e 082514 gbw e 082515 gbw e 084 347 and gbw e 080264 respectively all standards were purchased from national institute of metrology china nim and approved by the general administration of quality supervision inspection and quarantine of china aqsiq calibration standards with concentrations ranging from 0 1 mg l to 2 0 mg l for f 1 0 mg l to 20 0 mg l for cl so4 2 no3 2 were used to calculate the anion concentrations the lod and loq of the four anions f cl so4 2 and no3 2 are shown in table s1 2 2 4 co3 2 and hco3 the concentrations of co3 2 and hco3 were analyzed according to gb 8538 2016 protocols national health and family planning commission 2016 detailed analysis methods are presented in the supplementary files 2 2 5 metasilicates a cary 300 visible ultraviolet spectrophotometer varia united states of america was employed for the metasilicate measurements and the pretreatment procedures followed a national standard method gb 8538 2016 national health and family planning commission 2016 a detailed analysis method for metasilicates in water is presented in the supplementary files 2 2 6 ph and conductivity an acidity meter seven excellence mettler toledo switzerland was used to measure the ph and conductivity of the bmw s 2 3 statistical analysis in this study differences between groups and within groups were compared by one way analysis of variance one way anova and least significant difference lsd was used as a post hoc comparison method two commonly used multivariate statistical methods fisher discrimination analysis fda and artificial neural network ann were used to predict the origin of bottled mineral water the training and validation methods of multivariate statistical models have previously been used by wu et al 2019 specifically a leave one out validation method was used for fda and for ann 70 of the samples are randomly selected as the training set and the remaining 30 as the validation set to calculate the validation accuracy the number of correctly discriminated samples were divided by the total number of samples to determine the accuracy rate all statistical analyses were performed using spss statistics 26 ibm usa origin 2018 originlab usa was used for plotting the figures 3 results and discussion 3 1 stable isotopes of bottled mineral water 3 1 1 δ18o and δ2h in water bottled mineral water from five countries had δ 18o values ranging from 19 2 to 5 4 with an average value of 9 4 3 3 while the δ 2h values ranged from 148 3 to 35 8 with an average value of 65 8 25 0 table s3 the water isotope ratios of different origin samples obtained in this study showed similar trends to previous water studies bong et al 2009 bowen et al 2005 bottled water from china had the widest range of δ 18o 19 2 to 5 4 and δ 2h 148 3 to 35 7 values fig 2 while bottled water from fiji had the highest δ 18o and δ 2h values up to 5 8 and 45 5 respectively table s3 more positive isotopic values of fiji s bmw are due to its close location to the equator low altitude and tropical highly evaporative environment bowen et al 2007 bmw from france and italy have relatively similar δ 18o and δ 2h values this may be because both french and italian mineral waters come mainly from a similar origin such as an alpine region where they are sourced from similar climates and altitudes table 1 we also evaluated the effect of sampling time on δ 2h and δ 18o in bmws of different origins and found that the bmws collected in different months showed large variability in δ 2h and δ 18o values although no obvious seasonal trends were observed figure s1 this may suggest that the origin effect dominates the water isotopic variation of bmws the global meteoric water line gmwl describes the common trend for precipitation on a global scale isotopic bmw variations on this water line is the product of the global water cycling and other influencing factors δ 2h and δ 18o values of precipitation are primarily dependent on the annual temperature of the location where the rainfall occurred craig 1961 the δ 2h and δ 18o values of the 96 bmw samples show a close fit to the global meteoric water line gmwl with a linear equation of δ 2h 8 14 0 02 δ 18o 10 09 0 2 brencic and vreca 2006 bmw from different countries showed different δ 2h and δ 18o distribution characteristics according to their geographical locations which indicates that δ 2h and δ 18o isotopes are good variables for origin traceability however bmw from china is produced from a wide range of latitudes and altitudes which accounts for the higher variability of δ 2h and δ 18o isotopes for chinese bmw than in other countries also seen in fig 2 the isotopic composition of groundwater represents the long term average of precipitation that occurs in a specific region or in the case of some chinese bmw s snow melt that seeps into the groundwater with its strongly negative isotopic composition bowen et al 2005 therefore china s broad isotopic range of bmw s overlap with other countries and were less distinctive while smaller countries such as fiji and new zealand δ 2h and δ 18o values showed a very good ability to discriminate origin the highly negative δ 2h lower than 110 and δ 18o lower than 15 values seen in some chinese bmw s occur in water bottled in tibet black squares a high altitude and latitude region while δ 2h and δ 18o values are useful to indicate the origin of bmw they are best used to the distinguish countries or production areas with a relatively small geographical range to avoid isotopic overlap with other regions or countries an additional measurement parameter deuterium excess reflects the rain out effect of water sources deuterium excess d excess is a function of the δ 2h and δ 18o values of water d excess δ 2h 8 δ 18o dansgaard 1964 the global network of isotopes in precipitation gnip provides decades of d excess data across the globe which is used to characterize the evolution of water through the hydrologic cycle global meteoric waters have an average d excess value of 10 with significantly lower values characterizing partially evaporated waters and higher values being indicative of recycled moisture bowen et al 2019 bmw s in this study had d excess values of 10 8 4 5 cn 6 8 4 5 fr 6 6 3 0 it 9 0 4 1 nz 0 15 2 4 fj and 8 3 6 2 for all origins it can be inferred that the significantly lower average d excess value of fiji bmw compared to other origins fig 4 is significantly influenced by pacific ocean water vapor and its high temperature climate in europe and central asia higher d excess values 10 are often associated with recycled eastern mediterranean derived precipitation that falls during later winter and spring conversely low d excess values 10 are associated with evaporative summer precipitation derived from the arctic indian and pacific oceans bershaw 2018 this evidence suggests that d excess as well as δ 18o and δ 2h values can be a good variable to describe the water vapor source and the climatic characteristics of the geographical origin 3 1 2 δ18o and δ13c of dic the δ 18odic of bmw from five countries ranged from 23 9 to 8 8 and the δ 13cdic ranged from 13 2 to 4 2 table s2 and showed similar origin trends as the bmw δ 18o and δ 2h values chinese bmw samples showed a larger δ 18odic 23 9 to 11 0 and δ 13cdic 11 9 to 4 2 range than the other origins table s2 fig 2 and fig 3 the formation of δ 18odic and δ 13cdic in water is complex but the main dic sources in groundwater are carbonate and bicarbonate ions derived from dissolution of limestone calcareous rocks redondo and yélamos 2005 therefore the δ 18odic and δ 13cdic values can indicate both the origin and source precipitation surface water or groundwater of the bmw brencic and vreca 2007 the bmw δ 18o values also have a strong linear relationship with δ 18odic y 0 60 x 9 50 r 2 0 52 and δ 13cdic y 0 78 x 15 21 r 2 0 48 fig 3 indicating that they are closely related this study also showed that bmw from fiji new zealand and italy can be distinguished by the δ 18odic and δ 13cdic values indicating that isotope dic values show good potential to trace the origin of bmw fig 3 3 2 chemical fingerprints of mineral water the chemical content of mineral water is not only a matter of water quality and safety but also an important fingerprint reflecting the geology and environment of the aquifer source afsin 1999 misund et al 1999 the chemical elements contained in mineral water such as elements anions ph and other variables all met the chinese mineral water quality criteria refer to gb 8537 2018 table s2 one way anova showed significant differences in the elemental and anion contents of bmw from different countries table 1 p 0 05 indicating that the various analyses of anions ph and chemical contents can provide complimentary evidence for the origin traceability of bmw 3 2 1 elemental content of mineral water key metal elements li na mg k ca and sr in mineral water were analyzed and different origins were compared mean elemental contents of li na mg k ca and sr were 14 05 19 15 μg l tibetan samples not included 2 74 2 35 mg l 17 68 35 26 mg l 15 64 15 71 mg l 17 63 17 67 mg l and 0 98 3 05 mg l respectively table s2 very high levels of li 521 64 μg l to 735 35 μg l were detected in mineral water samples from tibet and were about 10 to 100 times higher than in other samples ranging from undetected to 86 5 μg l for other origins bmw water from france and italy had higher calcium and magnesium contents than other origins suggesting that european bmw is strongly influenced by limestone aquifers which is consistent with previous studies dinelli et al 2012 mineral water originating from northern china qinghai and jilin province has a relatively high na and k contents reaching 77 66 mg l and 9 59 mg l respectively some french bmw showed higher sr contents indicating that they may have come from very old waters table s2 the results show that all metal elements had significant differences according to origin table 2 however the high intra group variability resulted in only a few single elements that could provide limited origin differentiation for example only strontium and calcium contents were useful to differentiate french bmw from other countries the p values of li f and co3 2 were 0 059 0 216 and 0 139 respectively which meant these variables were not suitable for origin differentiation 3 2 2 anions an assessment of the anions in bmw showed there were significance variations among countries p 0 05 except for cl and co3 2 table 2 the f content in chinese bmw was higher than bmw from the other four countries with an average value of 0 43 mg l 0 41 mg l a range of 0 05 mg l to 1 35 mg l a relatively high level of fluoride ions was detected in mineral water from tibet china and according to the reequipments of gb8537 2018 f exceeds 1 mg l needs to be marked on the label fiji showed the lowest average so4 2 content of 1 06 0 26 mg l with values ranging from 0 59 mg l to 1 54 mg l while china showed the highest average so4 2 content 24 94 28 76 mg l the changbai mountain area of jilin has relatively high so4 2 and cl up to 76 5 mg l and 63 5 mg l respectively suggesting that the water here may be subject to some salt contamination table s2 the nitrate content of the studied mineral waters ranged from 0 07 mg l to 12 59 mg l with a mean value of 3 58 3 35 significant differences in nitrate content of bmws from different countries table 2 suggests that nitrate also provides the ability to differentiate origin overall anions provide a small contribution towards distinguishing bmw origin similar to metallic elements but are not robust variables of origin 3 2 3 other variables the presence of metasilicic acid in mineral water is closely related to the hydrolysis of silicates and silica from basalt scoria and soil xiao et al 2019 the release of metasilicates from rocks into mineral water is controlled by ph co2 and rock characteristics yan et al 2017 of the five study countries fiji bmw had the highest metasilicic acid content with a mean of 79 13 6 09 mg l range of 66 60 mg l to 88 60 mg l the ph and electrical conductivity of mineral water are closely related to the level of metals and anions in the water the ph of water samples from most origins was above 7 and therefore alkaline except for jiangxi and sichuan samples from china new zealand bmw s showed the highest ph of the five countries with an average ph value of 8 14 0 48 range of 7 68 to 9 16 the conductivity of french bmw s from alpine regions was the highest of the five countries of origin with a mean value of 922 53 840 56 µs cm range of 207 02 to 2370 87 μs cm this study shows that ph and conductivity of mineral water provides useful trends and potential variable of source geological environment is the main driving factor leading to different chemical composition in mineral water bricker et al 1968 different geological origins e g volcanics sedimentary rocks etc and rock types contribute specific chemical compositions in mineral water through their dissolution of the aquifer host rock van der aa 2003 in this study bmw from fiji has a higher metasilicic acid content and lower hco3 and co3 2 than the other four countries contributing to the higher ph seen in these bmw s generally most of chemical constituents found in bmw show significant differences according to origin p 0 01 except cl and co3 2 table 2 3 3 classification of bottled mineral water 3 3 1 distribution characteristics of chemical components water can be classified into different chemical compositions based on different ion distribution characteristics the piper trigram was first proposed by piper in 1944 and is expressed by the percentage pattern of the three cations na k mg2 ca2 and anions cl so4 2 hco3 naddeo et al 2008 oyebog et al 2012 peh et al 2010 data points in the rhombus and two isosceles triangles represent the distribution characteristics of these anions and cations in water respectively hco3 had the highest relative anion content proportion in the bmw s from the five countries table s2 the cationic combination of bmw s from different production areas showed differences according to origin isosceles triangle at lower left fig 5 the dominant ions in fiji groundwater are na mg2 hco3 yet bmw from the same origin does not necessarily have the same ionic composition bmws from france and italy from alpine regions have a similar cationic composition and is well separated from the other origins mainly because this water originates from a shared alpine regional source with similar geology and precipitation bmw sources from china are widely distributed geographically and chemically different resulting in a more scattered piper diagram distribution these results suggest that the piper trigram can also be used to classify bmw from different country origins and regions using hydro chemical variables 3 3 2 classification in order to better classify the origin of bmws two origin classification models discriminant analysis da and artificial neural network analysis ann were employed which have been successfully applied to the origin analysis of a variety of beverages wu et al 2021a wu et al 2019 zhang et al 2019 moreover it is possible to verify the accuracy of the origin identification models by cross checking the two models bmw from the five countries can be distinguished using isotopic and chemical variables although a few samples overlap fig 6 furthermore the model s accuracy and verification results are shown in table 3 there are 37 bmw samples from china 32 of which are successfully verified as originating from china with a discriminant accuracy of 81 1 chinese bmws are more diverse in origin due to the vast geographical distance and source origins across china which weakens the specificity of isotope and chemical fingerprints thus reducing the identification accuracy as previously discussed there are some similarities between water sourced from france and italy resulting in a slight overlap for these two countries table 4 apart from china the sample classification accuracy rate of the other countries was 90 of note is the model s high 100 accuracy for bmw samples from new zealand and fiji samples from new zealand and fiji were more easily distinguishable from other origins probably due to the specific geographical conditions as described in section 2 1 the total discriminant accuracy was 91 7 and 84 4 for cross validation of all origins the performance of the ann method was investigated using default parameters from spss software see table s5 for detailed ann model parameter settings samples were divided into a training set about 70 and testing set the remaining 30 isotope and chemical variables with significant inter group differences were used to perform the ann model calculations for the training samples all bmw s were correctly assigned to their origin with an accuracy rate of 100 for the verification samples only 1 sample from italy was incorrectly identified as from france while the other 24 samples were correctly verified for their origin in summary the discrimination accuracy rate of the training samples reached 100 and the verification accuracy of the test samples reached 96 0 the normalization importance of all variables was calculated using an ann model fig 7 the top five normalized variables are hco3 no3 δ 2h δ 18o and f these anions mainly reflect a geological contribution to the water source while the isotopes mainly reflect information such as climate and precipitation in addition ann was shown to have better origin tractability than fishers da the bmw samples are all correctly identified by the fisher discriminant analysis model with a discriminant accuracy of 100 variable normalization indicated three of the five most important variables were hydrochemical variables emphasizing their strong contribution to the model s accuracy bmw δ 2h and δ18o values were more useful than dic isotopes for origin classification overall anions and isotopes were the most important variables providing an important basis for determining the origin of bmw from different countries therefore based on these two discriminant models bmw from china france italy new zealand and fiji can be distinguished and a functional classification model can be obtained while a combination of stable isotopes elemental fingerprints and water chemistry variables can enable a robust bmw verification method for different countries not all laboratories have the capacity to analyses all the variables outlined in this study therefore in order to test the model s ability to differentiate different variable classes both individually and in various combinations the respective classification accuracy is determined for different variable combinations isotopes elements and hydrological factors using fisher da table s4 the results show that nearly all combinations of variables correctly distinguished fiji and new zealand bmw from other producing countries with accuracy rates from 91 3 to 100 consistent with the above analyses these results suggest that bmw from these two countries are best differentiated using only elemental content or water chemistry factors as stable isotope analysis alone does not clearly distinguish samples from new zealand and other origins especially china for this study set the combination of water chemistry factors and stable isotope elemental fingerprinting results was found to provide the most effective differentiation table s4 with an accuracy rate 90 suggesting that water chemistry factors are more effective in characterizing some complex production areas in most cases bmw from china had some overlap with new zealand bmw samples suggesting similar isotope fractionation processes may occur in each country this may be mainly due to the large area of china and the diverse climatic and geological conditions zhao et al 2017 resulting in a huge variation in isotopes elements and water chemistry variables table s2 which affects the ability to differentiate chinese bmw from other countries water sources in new zealand and also other origins are also strongly influenced by seasonal factors yang et al 2020 so this study may not provide a complete picture of the annual isotopic variation of new zealand mineral waters due to sample limitations this study shows clear evidence for the ability and accuracy of different isotopic and chemical identification factors that can characterize whether imported water into china is actually mineral water or tap water or if it is being fraudulently sold as domestic mineral water in many cases the methods outlined in this study clearly achieved that goal although given the highly variable geographic context of china some origin overlap may occur which will require more in depth investigation through other forensic techniques such as auditing and physical traceability 4 conclusion stable isotope and hydro chemical variables were used to confirm whether bmw was mineral water rather than tap water and to determine the origin of bmw from five countries stable isotope ratios clearly separated countries based on the global meteoric water parameters such as latitude distance to the ocean and temperature hydro chemical variables had a stronger relationship with aquifer geochemistry and mineralization differences for different countries were successfully highlighted using a piper trigram confirming that the bmw s were genuine mineral water and not tap water a combination of stable isotope and hydro chemical variables were used to construct a discriminant classification model the origin verification accuracy of the origin discriminant model was 91 7 and the cross verification accuracy was 84 4 hco3 no3 δ 2h δ 18o and f were found to be the five most important variables that influenced the model the discrimination accuracy of the training dataset was 100 and the validation dataset was 96 0 using multiple analytical techniques the origin of mineral water from china france italy new zealand and fiji were determined these results show that a combination of stable isotope and hydro chemical analyses combined with a multivariate statistical model is a feasible and robust approach to identify the origin of mineral water in the future this research will provide baseline technical support for further analysis of bmw and drinking water from other countries credit authorship contribution statement hao wu conceptualization resources writing review editing haiquan chen data curation writing original draft bingqing yi data curation karyne m rogers writing review editing xuehai bian formal analysis ni lin formal analysis xiuwen zhou formal analysis baohui jin project administration resources zhi yan formal analysis haichao zhou resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the innovation of science technology commission of shenzhen municipality 20200827115203001 and the national natural science foundation of china 31701699 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128858 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2595,a comprehensive study of 96 bottled mineral water bmw samples consisting of 21 of the most popular origins and brands sourced from china n 38 france n 20 italy n 10 new zealand n 17 and fiji n 12 has been undertaken the δ 18o and δ 13c of dissolved inorganic carbon dic δ 18o and δ 2h of water mineral elements li na mg k ca sr and ions cl so4 2 f co3 2 hco3 were investigated and used for origin traceability the origin of bmw was confirmed by applying fisher discriminant analysis fisher da and artificial neural network ann models to these variables δ 18odic δ 13cdic δ 18o δ 2h values of bmw showed significant deviations with origin mineral elements and anions varied widely due to different regional geology and hydrology characteristics a discriminant model based on fisher da showed that the identification accuracy of mineral water from different origins was in the range of 81 to 100 whereas the discriminant accuracy was 100 for the training samples and 96 0 for the testing samples calculated by ann hco3 no3 δ 2h δ 18o and f were the most important variables that characterized bmws from different origins using a combination of stable isotopes and different water chemical components bmws from china can be accurately distinguished from other origins using multivariate statistical models keywords bottled mineral water stable isotopes hydrochemistry origin traceability artificial neural network discriminant analysis data availability data will be made available on request 1 introduction bottled mineral water bmw is an important beverage worldwide delivering a safe convenient and reliable source of drinking water pllana and qosa 2019 with increasing economic globalization the number of imported mineral water brands in the chinese market is increasing and the import volume and consumption of mineral water is growing rapidly china s mineral water imports have continued to rise in recent years reaching 166 600 kiloliters and 89 72 million dollars in 2019 unpublished data from china customs however potential health and safety problems driven by economic fraud may exist in the bottled water market such as domestic water counterfeits replacing imported water surface water or tap water sold as higher priced mineral water or glacier water etc china has strict safety standards for bottled mineral water such as gb 19298 2014 general administration of quality supervision 2014 for bottled water and gb 8537 2018 state administration for market regulation 2018 for mineral water yet verifying the origin claims of bottled water has become a huge challenge for chinese consumers and import inspection departments such as china customs therefore the establishment of an efficient and accurate method for authenticity verification of bottled drinking water is very important for china s food safety regulatory authorities various studies have already focused on the origin of bottled drinking water guo et al 2019 orellana et al 2019 however in this study we report new research specifically on bottled mineral water mineral water is naturally formed in underground aquifers and is collected by drilling wells rather than collected from springs which bring water to the surface mineral water contains different levels of minerals trace elements or other components state administration for market regulation 2018 most traceability technologies applied to determine the origin of bottled drinking or mineral water include mineral element fingerprints di giuseppe 2017 ristić et al 2011 hydrogen and oxygen stable isotopes bowen et al 2005 rangarajan and ghosh 2011 carbon and oxygen isotopes of dissolved inorganic carbon dic in water brencic and vreca 2007 87sr 86sr isotopes montgomery et al 2006 voerkelius et al 2010 206pb 208pb isotopes möller et al 2004 chemical composition bityukova and petersell 2010 carter et al 2015 or a combination of these above methods carter et al 2015 fan et al 2018 orellana et al 2019 to date stable isotopes are the most effective origin traceability tool and have been used in various food and beverage research applications such as wine wu et al 2021a wu et al 2019 fruit bong et al 2008 wu et al 2021b zhou et al 2021a milk products bontempo et al 2012 zhou et al 2021b and other beverages chesson et al 2010 most previous studies have shown that the δ 2h and δ 18o values of water are influenced by the geographic and hydrological characteristics of the source such as latitude and longitude rangarajan and ghosh 2011 altitude dotsika et al 2010 temperature burnik šturm et al 2017 elmarami et al 2017 seasonal effects sun et al 2016 xiao et al 2016 and evaporation conditions burnik šturm et al 2017 however current research has neglected the potential input of dic isotopes on the origin traceability of bottled water with only a few publications using this method resulting in limited data for bottled water traceability brencic and vreca 2007 brenčič and vreča 2010 the main factors affecting the stable carbon oxygen isotopic ratio of dic in water are the exchange between co2 in atmosphere polsenaere and abril 2012 usdowski and hoefs 1990 rainfall and runoff inputs liu et al 2010 season effects and biological activity myrbo and shapley 2006 in addition some important hydrological factors such as carbonate content ph pco2 temperature silicate minerals etc can also significantly affect the dic content in water and thus the carbon oxygen stable isotope ratio liu et al 2010 therefore the combination of water and dic stable isotopes may provide a more comprehensive fingerprint for the origin of bottled water which still lacks global scale data different ion and mineral contents are also useful variables for the origin traceability of bottled water and have been described in some studies asante and kreamer 2018 di giuseppe 2017 kim et al 2012 previous studies have suggested that stratigraphic lithological and structural constraints on the aquifer placement plays a very important role and influences the distribution of trace elements in spring and mineral waters peh et al 2010 also the chemical characteristics ph conductivity metasilicic acid and ionic content of natural spring and mineral waters depends on the composition of the rocks and soil through which the water passes pantelic et al 2019 this supports the conclusion that mineral and chemical composition of mineral water may inherit geochemical characteristics from the geology of its aquifer however this practical approach still has many limitations firstly the sampling scale of these studies were usually limited to a certain region or country raco et al 2013 rangarajan and ghosh 2011 secondly water investigations frequently comprised of chemical comparisons but no clear origin tracing methods was put forward for many studies fugedi et al 2010 rangarajan and ghosh 2011 rosborg et al 2005 some studies collected too few samples resulting in a lack of robust data and low model accuracy gutiérrez reguera et al 2016 zuliani et al 2020 similarly some studies have investigated the isotopic distribution characteristics of drinking water within china but no operational methods have been designed to identify the origin of specific water samples guo et al 2019 these studies while meeting local requirements may lead to a mismatch with the larger global community needs thus a widely applicable standardized and accurate traceability scheme is still urgently needed for the traceability of commonly traded bottled mineral water in this study bmw imported into china from key sources were collected to analyze isotopic elemental and hydrochemical fingerprints and to evaluate effective variables for origin traceability the study aims to establish an efficient and accurate method for origin verification of bmw import into china that can clearly seperate chinese bmw from other origins and provide insights into characteristics of bmw from other origins 2 material and methods 2 1 sample collection bmw samples were collected irregularly from october 2020 to april 2021 at local markets and importation ports in china a total of 96 bmw samples from china 38 samples france 20 samples italy 10 samples new zealand 17 samples and fiji 12 samples consisting of 21 of the most popular origins and brands sold and imported into chinese markets were collected and analyzed by shenzhen customs the sampling period lasted for 6 months and the majority of bmws were from different production batches even if they are from the same brand detailed information of the samples is shown in fig 1 and table 1 bmws from china are widely distributed and contain different geographical features such as plateau tibet qinghai high latitude changbai mountain basin sichuan or plain jiangxi sourced water french and italian bmw samples were mainly collected from alpine regions new zealand situated on a plate boundary in the southern pacific ocean is dominated by extensive late oligocene early miocene mudstones marls and limestones campbell et al 2012 and has a relatively unique geological setting and receives oceanic precipitation derived from both tropical and antarctic origins fiji consists of two large islands with numerous smaller islands in the central south pacific ocean close to the equator bmws of these pacific ocean countries are controlled primarily by water vapor and tropical oceanic climate while recent volcanological and active plates tectonics cronin et al 2001 also provided a significantly different water chemistry than is seen in other countries 2 2 sample analysis 2 2 1 stable isotopes the δ 2h and δ 18o values of bmw samples were analyzed using an elemental analyzer pyro isotope ratio mass spectrum ea pyro irms thermo fisher bremen germany isotope analytical methods for δ 2h and δ 18o of bmw are modified from bowen et al 2005 the δ 18odic and δ 13cdic values of bmw dic were analyzed using a gasbench irms gasbench ⅱ device thermo fisher bremen germany detailed analysis methods are included in the supplementary files stable isotope ratios were defined as δ r sample r standard 1 where r sample is the ratio of heavy to light isotope in a measured sample such as 13c 12c 18o 16o and 2h 1h r standard is the ratio of heavy to light isotope in a reference standard in this study the reference standards for δ 18odic and δ 13cdic in water was iaea co 8 calcite δ 18odic 22 7 vs v pdb δ 13cdic 5 764 vs v pdb the reference materials for δ 18o and δ 2h were lgr working standards calibrated periodically against primary iaea calibration standards to v smow slap scale 3e δ 2h 79 6 0 5 δ 18o 11 04 0 15 4e δ 2h 49 2 0 5 δ 18o 7 81 0 15 5e δ 2h 9 9 0 5 δ 18o 2 99 0 15 the long term analytical precision for δ 18odic and δ 13cdic in water dic was 0 2 and that of δ 2h and δ 18o in water was 1 0 and 0 2 respectively 2 2 2 mineral elements the mineral elements found in bottled water were measured following the gb 8538 2016 protocol national health and family planning commission 2016 which is the official and mandatory standard for the safety of bottled water in china nexion 300x inductively coupled plasma mass spectrometry icp ms perkinelmer usa was used to analyse six elements li na mg k ca sr a series of multi elemental standard solutions multi element calibration standard 3 perkinelmer usa in 0 5 nitric acid chromatographically pure were used as the calibration standards in indium was used as an internal standard 50 μg l solution to correct for instrument drift the bmws were diluted 1 400 with 0 5 nitric acid chromatographically pure for na mg k ca while no dilution for li and sr the lod and loq of the elements are shown in table s1 2 2 3 anions the anion concentrations of bmws were measured according to gb 8538 2016 protocols national health and family planning commission 2016 an ics5000 ion chromatograph with an electrical conductivity detector thermo fisher usa was used to analyse the concentrations of the four anions f cl so4 2 no3 2 the calibration standards used for f cl so4 2 no3 2 were prepared from gbw e 082514 gbw e 082515 gbw e 084 347 and gbw e 080264 respectively all standards were purchased from national institute of metrology china nim and approved by the general administration of quality supervision inspection and quarantine of china aqsiq calibration standards with concentrations ranging from 0 1 mg l to 2 0 mg l for f 1 0 mg l to 20 0 mg l for cl so4 2 no3 2 were used to calculate the anion concentrations the lod and loq of the four anions f cl so4 2 and no3 2 are shown in table s1 2 2 4 co3 2 and hco3 the concentrations of co3 2 and hco3 were analyzed according to gb 8538 2016 protocols national health and family planning commission 2016 detailed analysis methods are presented in the supplementary files 2 2 5 metasilicates a cary 300 visible ultraviolet spectrophotometer varia united states of america was employed for the metasilicate measurements and the pretreatment procedures followed a national standard method gb 8538 2016 national health and family planning commission 2016 a detailed analysis method for metasilicates in water is presented in the supplementary files 2 2 6 ph and conductivity an acidity meter seven excellence mettler toledo switzerland was used to measure the ph and conductivity of the bmw s 2 3 statistical analysis in this study differences between groups and within groups were compared by one way analysis of variance one way anova and least significant difference lsd was used as a post hoc comparison method two commonly used multivariate statistical methods fisher discrimination analysis fda and artificial neural network ann were used to predict the origin of bottled mineral water the training and validation methods of multivariate statistical models have previously been used by wu et al 2019 specifically a leave one out validation method was used for fda and for ann 70 of the samples are randomly selected as the training set and the remaining 30 as the validation set to calculate the validation accuracy the number of correctly discriminated samples were divided by the total number of samples to determine the accuracy rate all statistical analyses were performed using spss statistics 26 ibm usa origin 2018 originlab usa was used for plotting the figures 3 results and discussion 3 1 stable isotopes of bottled mineral water 3 1 1 δ18o and δ2h in water bottled mineral water from five countries had δ 18o values ranging from 19 2 to 5 4 with an average value of 9 4 3 3 while the δ 2h values ranged from 148 3 to 35 8 with an average value of 65 8 25 0 table s3 the water isotope ratios of different origin samples obtained in this study showed similar trends to previous water studies bong et al 2009 bowen et al 2005 bottled water from china had the widest range of δ 18o 19 2 to 5 4 and δ 2h 148 3 to 35 7 values fig 2 while bottled water from fiji had the highest δ 18o and δ 2h values up to 5 8 and 45 5 respectively table s3 more positive isotopic values of fiji s bmw are due to its close location to the equator low altitude and tropical highly evaporative environment bowen et al 2007 bmw from france and italy have relatively similar δ 18o and δ 2h values this may be because both french and italian mineral waters come mainly from a similar origin such as an alpine region where they are sourced from similar climates and altitudes table 1 we also evaluated the effect of sampling time on δ 2h and δ 18o in bmws of different origins and found that the bmws collected in different months showed large variability in δ 2h and δ 18o values although no obvious seasonal trends were observed figure s1 this may suggest that the origin effect dominates the water isotopic variation of bmws the global meteoric water line gmwl describes the common trend for precipitation on a global scale isotopic bmw variations on this water line is the product of the global water cycling and other influencing factors δ 2h and δ 18o values of precipitation are primarily dependent on the annual temperature of the location where the rainfall occurred craig 1961 the δ 2h and δ 18o values of the 96 bmw samples show a close fit to the global meteoric water line gmwl with a linear equation of δ 2h 8 14 0 02 δ 18o 10 09 0 2 brencic and vreca 2006 bmw from different countries showed different δ 2h and δ 18o distribution characteristics according to their geographical locations which indicates that δ 2h and δ 18o isotopes are good variables for origin traceability however bmw from china is produced from a wide range of latitudes and altitudes which accounts for the higher variability of δ 2h and δ 18o isotopes for chinese bmw than in other countries also seen in fig 2 the isotopic composition of groundwater represents the long term average of precipitation that occurs in a specific region or in the case of some chinese bmw s snow melt that seeps into the groundwater with its strongly negative isotopic composition bowen et al 2005 therefore china s broad isotopic range of bmw s overlap with other countries and were less distinctive while smaller countries such as fiji and new zealand δ 2h and δ 18o values showed a very good ability to discriminate origin the highly negative δ 2h lower than 110 and δ 18o lower than 15 values seen in some chinese bmw s occur in water bottled in tibet black squares a high altitude and latitude region while δ 2h and δ 18o values are useful to indicate the origin of bmw they are best used to the distinguish countries or production areas with a relatively small geographical range to avoid isotopic overlap with other regions or countries an additional measurement parameter deuterium excess reflects the rain out effect of water sources deuterium excess d excess is a function of the δ 2h and δ 18o values of water d excess δ 2h 8 δ 18o dansgaard 1964 the global network of isotopes in precipitation gnip provides decades of d excess data across the globe which is used to characterize the evolution of water through the hydrologic cycle global meteoric waters have an average d excess value of 10 with significantly lower values characterizing partially evaporated waters and higher values being indicative of recycled moisture bowen et al 2019 bmw s in this study had d excess values of 10 8 4 5 cn 6 8 4 5 fr 6 6 3 0 it 9 0 4 1 nz 0 15 2 4 fj and 8 3 6 2 for all origins it can be inferred that the significantly lower average d excess value of fiji bmw compared to other origins fig 4 is significantly influenced by pacific ocean water vapor and its high temperature climate in europe and central asia higher d excess values 10 are often associated with recycled eastern mediterranean derived precipitation that falls during later winter and spring conversely low d excess values 10 are associated with evaporative summer precipitation derived from the arctic indian and pacific oceans bershaw 2018 this evidence suggests that d excess as well as δ 18o and δ 2h values can be a good variable to describe the water vapor source and the climatic characteristics of the geographical origin 3 1 2 δ18o and δ13c of dic the δ 18odic of bmw from five countries ranged from 23 9 to 8 8 and the δ 13cdic ranged from 13 2 to 4 2 table s2 and showed similar origin trends as the bmw δ 18o and δ 2h values chinese bmw samples showed a larger δ 18odic 23 9 to 11 0 and δ 13cdic 11 9 to 4 2 range than the other origins table s2 fig 2 and fig 3 the formation of δ 18odic and δ 13cdic in water is complex but the main dic sources in groundwater are carbonate and bicarbonate ions derived from dissolution of limestone calcareous rocks redondo and yélamos 2005 therefore the δ 18odic and δ 13cdic values can indicate both the origin and source precipitation surface water or groundwater of the bmw brencic and vreca 2007 the bmw δ 18o values also have a strong linear relationship with δ 18odic y 0 60 x 9 50 r 2 0 52 and δ 13cdic y 0 78 x 15 21 r 2 0 48 fig 3 indicating that they are closely related this study also showed that bmw from fiji new zealand and italy can be distinguished by the δ 18odic and δ 13cdic values indicating that isotope dic values show good potential to trace the origin of bmw fig 3 3 2 chemical fingerprints of mineral water the chemical content of mineral water is not only a matter of water quality and safety but also an important fingerprint reflecting the geology and environment of the aquifer source afsin 1999 misund et al 1999 the chemical elements contained in mineral water such as elements anions ph and other variables all met the chinese mineral water quality criteria refer to gb 8537 2018 table s2 one way anova showed significant differences in the elemental and anion contents of bmw from different countries table 1 p 0 05 indicating that the various analyses of anions ph and chemical contents can provide complimentary evidence for the origin traceability of bmw 3 2 1 elemental content of mineral water key metal elements li na mg k ca and sr in mineral water were analyzed and different origins were compared mean elemental contents of li na mg k ca and sr were 14 05 19 15 μg l tibetan samples not included 2 74 2 35 mg l 17 68 35 26 mg l 15 64 15 71 mg l 17 63 17 67 mg l and 0 98 3 05 mg l respectively table s2 very high levels of li 521 64 μg l to 735 35 μg l were detected in mineral water samples from tibet and were about 10 to 100 times higher than in other samples ranging from undetected to 86 5 μg l for other origins bmw water from france and italy had higher calcium and magnesium contents than other origins suggesting that european bmw is strongly influenced by limestone aquifers which is consistent with previous studies dinelli et al 2012 mineral water originating from northern china qinghai and jilin province has a relatively high na and k contents reaching 77 66 mg l and 9 59 mg l respectively some french bmw showed higher sr contents indicating that they may have come from very old waters table s2 the results show that all metal elements had significant differences according to origin table 2 however the high intra group variability resulted in only a few single elements that could provide limited origin differentiation for example only strontium and calcium contents were useful to differentiate french bmw from other countries the p values of li f and co3 2 were 0 059 0 216 and 0 139 respectively which meant these variables were not suitable for origin differentiation 3 2 2 anions an assessment of the anions in bmw showed there were significance variations among countries p 0 05 except for cl and co3 2 table 2 the f content in chinese bmw was higher than bmw from the other four countries with an average value of 0 43 mg l 0 41 mg l a range of 0 05 mg l to 1 35 mg l a relatively high level of fluoride ions was detected in mineral water from tibet china and according to the reequipments of gb8537 2018 f exceeds 1 mg l needs to be marked on the label fiji showed the lowest average so4 2 content of 1 06 0 26 mg l with values ranging from 0 59 mg l to 1 54 mg l while china showed the highest average so4 2 content 24 94 28 76 mg l the changbai mountain area of jilin has relatively high so4 2 and cl up to 76 5 mg l and 63 5 mg l respectively suggesting that the water here may be subject to some salt contamination table s2 the nitrate content of the studied mineral waters ranged from 0 07 mg l to 12 59 mg l with a mean value of 3 58 3 35 significant differences in nitrate content of bmws from different countries table 2 suggests that nitrate also provides the ability to differentiate origin overall anions provide a small contribution towards distinguishing bmw origin similar to metallic elements but are not robust variables of origin 3 2 3 other variables the presence of metasilicic acid in mineral water is closely related to the hydrolysis of silicates and silica from basalt scoria and soil xiao et al 2019 the release of metasilicates from rocks into mineral water is controlled by ph co2 and rock characteristics yan et al 2017 of the five study countries fiji bmw had the highest metasilicic acid content with a mean of 79 13 6 09 mg l range of 66 60 mg l to 88 60 mg l the ph and electrical conductivity of mineral water are closely related to the level of metals and anions in the water the ph of water samples from most origins was above 7 and therefore alkaline except for jiangxi and sichuan samples from china new zealand bmw s showed the highest ph of the five countries with an average ph value of 8 14 0 48 range of 7 68 to 9 16 the conductivity of french bmw s from alpine regions was the highest of the five countries of origin with a mean value of 922 53 840 56 µs cm range of 207 02 to 2370 87 μs cm this study shows that ph and conductivity of mineral water provides useful trends and potential variable of source geological environment is the main driving factor leading to different chemical composition in mineral water bricker et al 1968 different geological origins e g volcanics sedimentary rocks etc and rock types contribute specific chemical compositions in mineral water through their dissolution of the aquifer host rock van der aa 2003 in this study bmw from fiji has a higher metasilicic acid content and lower hco3 and co3 2 than the other four countries contributing to the higher ph seen in these bmw s generally most of chemical constituents found in bmw show significant differences according to origin p 0 01 except cl and co3 2 table 2 3 3 classification of bottled mineral water 3 3 1 distribution characteristics of chemical components water can be classified into different chemical compositions based on different ion distribution characteristics the piper trigram was first proposed by piper in 1944 and is expressed by the percentage pattern of the three cations na k mg2 ca2 and anions cl so4 2 hco3 naddeo et al 2008 oyebog et al 2012 peh et al 2010 data points in the rhombus and two isosceles triangles represent the distribution characteristics of these anions and cations in water respectively hco3 had the highest relative anion content proportion in the bmw s from the five countries table s2 the cationic combination of bmw s from different production areas showed differences according to origin isosceles triangle at lower left fig 5 the dominant ions in fiji groundwater are na mg2 hco3 yet bmw from the same origin does not necessarily have the same ionic composition bmws from france and italy from alpine regions have a similar cationic composition and is well separated from the other origins mainly because this water originates from a shared alpine regional source with similar geology and precipitation bmw sources from china are widely distributed geographically and chemically different resulting in a more scattered piper diagram distribution these results suggest that the piper trigram can also be used to classify bmw from different country origins and regions using hydro chemical variables 3 3 2 classification in order to better classify the origin of bmws two origin classification models discriminant analysis da and artificial neural network analysis ann were employed which have been successfully applied to the origin analysis of a variety of beverages wu et al 2021a wu et al 2019 zhang et al 2019 moreover it is possible to verify the accuracy of the origin identification models by cross checking the two models bmw from the five countries can be distinguished using isotopic and chemical variables although a few samples overlap fig 6 furthermore the model s accuracy and verification results are shown in table 3 there are 37 bmw samples from china 32 of which are successfully verified as originating from china with a discriminant accuracy of 81 1 chinese bmws are more diverse in origin due to the vast geographical distance and source origins across china which weakens the specificity of isotope and chemical fingerprints thus reducing the identification accuracy as previously discussed there are some similarities between water sourced from france and italy resulting in a slight overlap for these two countries table 4 apart from china the sample classification accuracy rate of the other countries was 90 of note is the model s high 100 accuracy for bmw samples from new zealand and fiji samples from new zealand and fiji were more easily distinguishable from other origins probably due to the specific geographical conditions as described in section 2 1 the total discriminant accuracy was 91 7 and 84 4 for cross validation of all origins the performance of the ann method was investigated using default parameters from spss software see table s5 for detailed ann model parameter settings samples were divided into a training set about 70 and testing set the remaining 30 isotope and chemical variables with significant inter group differences were used to perform the ann model calculations for the training samples all bmw s were correctly assigned to their origin with an accuracy rate of 100 for the verification samples only 1 sample from italy was incorrectly identified as from france while the other 24 samples were correctly verified for their origin in summary the discrimination accuracy rate of the training samples reached 100 and the verification accuracy of the test samples reached 96 0 the normalization importance of all variables was calculated using an ann model fig 7 the top five normalized variables are hco3 no3 δ 2h δ 18o and f these anions mainly reflect a geological contribution to the water source while the isotopes mainly reflect information such as climate and precipitation in addition ann was shown to have better origin tractability than fishers da the bmw samples are all correctly identified by the fisher discriminant analysis model with a discriminant accuracy of 100 variable normalization indicated three of the five most important variables were hydrochemical variables emphasizing their strong contribution to the model s accuracy bmw δ 2h and δ18o values were more useful than dic isotopes for origin classification overall anions and isotopes were the most important variables providing an important basis for determining the origin of bmw from different countries therefore based on these two discriminant models bmw from china france italy new zealand and fiji can be distinguished and a functional classification model can be obtained while a combination of stable isotopes elemental fingerprints and water chemistry variables can enable a robust bmw verification method for different countries not all laboratories have the capacity to analyses all the variables outlined in this study therefore in order to test the model s ability to differentiate different variable classes both individually and in various combinations the respective classification accuracy is determined for different variable combinations isotopes elements and hydrological factors using fisher da table s4 the results show that nearly all combinations of variables correctly distinguished fiji and new zealand bmw from other producing countries with accuracy rates from 91 3 to 100 consistent with the above analyses these results suggest that bmw from these two countries are best differentiated using only elemental content or water chemistry factors as stable isotope analysis alone does not clearly distinguish samples from new zealand and other origins especially china for this study set the combination of water chemistry factors and stable isotope elemental fingerprinting results was found to provide the most effective differentiation table s4 with an accuracy rate 90 suggesting that water chemistry factors are more effective in characterizing some complex production areas in most cases bmw from china had some overlap with new zealand bmw samples suggesting similar isotope fractionation processes may occur in each country this may be mainly due to the large area of china and the diverse climatic and geological conditions zhao et al 2017 resulting in a huge variation in isotopes elements and water chemistry variables table s2 which affects the ability to differentiate chinese bmw from other countries water sources in new zealand and also other origins are also strongly influenced by seasonal factors yang et al 2020 so this study may not provide a complete picture of the annual isotopic variation of new zealand mineral waters due to sample limitations this study shows clear evidence for the ability and accuracy of different isotopic and chemical identification factors that can characterize whether imported water into china is actually mineral water or tap water or if it is being fraudulently sold as domestic mineral water in many cases the methods outlined in this study clearly achieved that goal although given the highly variable geographic context of china some origin overlap may occur which will require more in depth investigation through other forensic techniques such as auditing and physical traceability 4 conclusion stable isotope and hydro chemical variables were used to confirm whether bmw was mineral water rather than tap water and to determine the origin of bmw from five countries stable isotope ratios clearly separated countries based on the global meteoric water parameters such as latitude distance to the ocean and temperature hydro chemical variables had a stronger relationship with aquifer geochemistry and mineralization differences for different countries were successfully highlighted using a piper trigram confirming that the bmw s were genuine mineral water and not tap water a combination of stable isotope and hydro chemical variables were used to construct a discriminant classification model the origin verification accuracy of the origin discriminant model was 91 7 and the cross verification accuracy was 84 4 hco3 no3 δ 2h δ 18o and f were found to be the five most important variables that influenced the model the discrimination accuracy of the training dataset was 100 and the validation dataset was 96 0 using multiple analytical techniques the origin of mineral water from china france italy new zealand and fiji were determined these results show that a combination of stable isotope and hydro chemical analyses combined with a multivariate statistical model is a feasible and robust approach to identify the origin of mineral water in the future this research will provide baseline technical support for further analysis of bmw and drinking water from other countries credit authorship contribution statement hao wu conceptualization resources writing review editing haiquan chen data curation writing original draft bingqing yi data curation karyne m rogers writing review editing xuehai bian formal analysis ni lin formal analysis xiuwen zhou formal analysis baohui jin project administration resources zhi yan formal analysis haichao zhou resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the innovation of science technology commission of shenzhen municipality 20200827115203001 and the national natural science foundation of china 31701699 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128858 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2596,arsenic as iron fe organic matter om compound is critical for the mobilization of as under irrigation conditions we explore the interaction mechanism among as fe om components for different reaction pathways in column experiments under irrigation conditions using ferrihydrite coated sand sodium humate ha and as iii arsenic mobilization is strongly controlled by the adsorption of as on fe minerals which in turn is affected by the presence of om in the pure ferrihydrite coated sand column outlet as and ha concentrations gradually increased and reached a stable state in the ferrihydrite as coated sand columns the release of as occurred with ha infiltration and the ha concentrations influenced the release rate of as from the ferrihydrite the results suggest om interacts with as and fe minerals to promote as mobility with the concentration om influencing the amount of as released although competitive adsorption occurred in the presence of om ferrihydrite acts as bridges between as and om to form as fe om ternary complexes and further affected the mobilization of as these results are important for evaluating the migration of as under agricultural activities using high as groundwater for irrigation and indicate managing om and as contaminated water for agricultural activities is required to limit impacts on human health keywords arsenic ferrihydrite organic matter ternary complexation data availability data will be made available on request 1 introduction arsenic as contamination of water and soil has been considered a grand challenge and environmental issue worldwide organic matter om interacts with as affecting the behavior of as in the water environment and sedimentary om is considered closely related to the high concentration of as in sediments aftabtalab et al 2022 om can affect the form of as via redox reactions or the formation of om as complexes mcarthur et al 2001 it also reduces as v in the presence of metal hydro oxides forming water soluble complexes with as iii and as v the presence of om can promote as adsorption and thus reduce as activity saada et al 2003 furthermore om can catalyze both oxidation and reduction processes and can also form as metal om ternary complexes through metal bridging mechanisms redman et al 2002 mineral hydro oxides the water soluble or insoluble inner surface complex with metal cations involving ca2 mn2 4 mg2 or al3 could act as surface catalysts or electron transfer agents and form om metal complexes which may strongly bind to other dissolved anions thereby reducing the possibility of these anions forming surface complexes the interactions between om and fe minerals involve the adsorption of om onto the mineral surface and fe om co precipitation sodano et al 2017 the main structure of om i e carboxyl groups provides abundant binding sites for co precipitation with fe in acidic mineral dominated soils more than 80 of total om occurs co precipitated with fe iii which can inhibit the formation of fe minerals xue et al 2019 the fe om co precipitates exhibit strong selective retention for aromatics with a resulting stability that is higher than that of adsorbed substances chen et al 2014 om in the subsurface environment is an important factor affecting the redox potential it can react with fe hydro oxides which are subsequently reduced and dissolve into other minerals burton et al 2013 xu et al 2019 furthermore different c fe molar ratios can result in fe hydro oxides that exhibit different properties liao et al 2020 humic acid ha contains numerous functional groups and typically represents a large portion of organic matter om morales et al 2012 the functional groups on ha have a significant influence on metal oxides exhibiting a high degree of reactivity and a strong binding ability tang et al 2014 that affects the aggregation retention and bioavailability of metal oxides xu et al 2019 studies focused on as fe and om show om affects as mobilization and migration in the natural environment li et al 2019 wang et al 2019 the adsorption and mobilization of as iii and as v on fe ha complexes has also been reported ma et al 2018 xue et al 2019 however the effect of different reaction pathways among as fe and om on as im mobilization under irrigation conditions has not yet been studied in detail high as groundwater is often accompanied by high ha and fulvic acid content liu et al 2020 using high as groundwater for agricultural irrigation will input as and om into the subsurface and because as is closely related to fe hydro oxides the biogeochemical reaction processes that occur during irrigation are particularly complex xiao et al 2021 xiao et al 2018 irrigation activities using high as groundwater led to the fluctuations in the water table varying redox conditions and the redistribution of as and fe in the near surface sediments om introduced by irrigation generated the ternary complex of as fe om and contributed to the im mobilization of as in the unsaturated saturated zone to determine how different reaction paths and the influence of om concentrations change the properties of fe hydro oxides and further determine the fate of pollutants ferrihydrite coated quartz sand ha and as iii were used in column experiments to understand the reaction mechanism under different reaction paths the experiment considered two reaction path systems under irrigation conditions the results suggest under different irrigation scenarios as desorption can occur and gradually reach a stable state due to the presence of om and surface complexes with ferrihydrite and om which also provide a new perspective on the effect of the interactions among as fe and om on the mobilization and transformation of as under irrigation conditions 2 materials and methods 2 1 materials all glass and plastic used in the experiments were cleaned by soaking in 10 v v hno3 for 24 h followed by repeated rinsing with deionized water diw all solutions were prepared with 18 25 mω cm diw in a highly pure n2 99 999 environment at 25 all chemicals used were of analytical or trace metal grade ha sodium humate purchased from sigma aldrich h16752 2 shanghai china was used to represent om as iii standard solution was prepared by dissolving appropriate amounts of sodium meta arsenite 98 sigma aldrich st louis mo usa in diw sodium chloride nacl prepared at 2 mm was used as the background electrolyte stock solutions of ha were prepared by dissolving 0 50 g of ha in 100 ml of potassium hydroxide 0 1 m liu and cai 2010 when used in the experiments 5 ml of ha stock solution were diluted in 495 ml of diw and filtered through 0 45 μm pore size polytetrafluoroethylene ptfe membrane filters after dilution the working ha solution contained 18 mg l 1 dissolved organic carbon doc and 0 28 0 77 0 07 and 31 2 mg l 1 ca k mg and na respectively 2 2 preparation of the column experiments quartz sand diameter 250 300 μm 99 9 sio2 was cleaned of any metal oxides colloids and clays by sequentially soaking it in 0 01 m hno3 0 01 m naoh and 30 h2o2 for 24 h each rinsing with diw 20 30 times and then drying at 105 for 24 h 2 line ferrihydrite was synthesized by titrating an fecl3 solution with naoh to a ph of 7 5 within 5 min to avoid the precipitation of akageneite burton et al 2011 naoh solution was used to keep the ph of the ferrihydrite floc stable at 7 5 for 2 h cao et al 2020 the resulting floc was rinsed several times with diw until the ec value of the floc equal to that of diw followed by mixing with quartz sand and drying at 80 c with periodic stirring the results of x ray diffraction xrd scanning electron microscopy sem and energy dispersive x ray spectroscopy eds verified the precipitate was pure 2 line ferrihydrite and that the quartz was coated successfully with ferrihydrite fig s1 dry ferrihydrite coated quartz sand was resuspended and maintained for 24 h in 2 mm nacl solution in a highly pure n2 99 999 environment the sand suspension was then transferred to perspex columns each column length 40 cm inner diameter 7 cm was outfitted with sampling ports set at 3 cm intervals from 16 to 28 cm from the bottom of the column labeled as ports 1 to 5 from top to bottom columns for the experiments were filled with cleaned quartz sand from the bottom to 14 5 cm with ferrihydrite coated quartz sand from 14 5 cm to 29 cm and cleaned quartz sand from 29 cm to 35 cm the columns had characteristics as follows effective porosity 0 44 hydraulic conductivity 2 6 10 4 m s 1 longitudinal dispersity 0 11 cm and skewness of breakthrough curve 0 41 2 3 design of the column experiments irrigation water infiltration was added to the top of the column and port 4 was open during the whole experiment to control the water table and worked as the liquid outlet during irrigation the water table remained 2 cm above the quartz flooding the column experiments were divided into two groups totaling five columns table 1 irrigation water was extracted using a pump at a velocity of 440 cm3 d 1 for experiment 1 pore water samples were collected at 1 d intervals over a 16 d reaction period the irrigation was discontinued from day 10 to day 12 and restarted on day 13 until ending on day 15 for experiment 2 the solution containing as iii 1 02 mm was fed into the bottom of the column at a velocity of 220 cm3 d 1 to first create as ferrihydrite coated quartz sand arsenic loading was complete when the effluent as concentration stabilized about 1 02 mm the total as concentration of the final as ferrihydrite coated sand was about 5 7 μm g 1 during the 8 d reaction period irrigation ended on day 7 pore water samples were collected at 1 d intervals the experiments have not been conducted in triplicates to ensure and control for variables that are not relevant to the experiments the sand suspension transferred to perspex columns under the same conditions using the same batch of quartz and ferrihydrite coated quartz sand and the processes of as loading for column c d and e have been completed under the same conditions 2 4 analytical methods solid phase samples were collected from the sampling ports of the post reaction columns and all results are presented on a dry weight basis as species separation in water samples were determined using lc sax anion exchange resin sigma aldrich with samples for total as and as iii measurements acidified to ph 2 with ultra pure hcl aqueous as concentrations were analyzed by hydride generation atomic fluorescence spectrometry hg afs afs 9700 beijing haiguang instruments the concentrations of aqueous total fe were determined by the 1 10 phenanthroline method hydroxylamine hydrochloride used as a reductant samples for doc analysis were acidified to ph 2 with concentrated hcl and stored in brown plastic bottles doc concentrations were measured by a toc crds isotope carbon analyzer picarro america with a detection limit of 0 01 mg l 1 soil samples 1 g were digested with 10 ml 1 1 hcl at 100 for 24 h to determine total as and fe contents the shape of material layers on the sand particle surfaces was identified using x ray diffraction xrd analysis bruker axs d8 focus with a cuka x ray radiation wavelength of 0 15406 nm and a lynxeye detector samples for sem were mounted on aluminum based stubs coated with gold and rapidly transferred to a hitachi su8010 sem system to analyze surface morphology the chemical composition in associated target areas was determined by eds ametek edax appollo xp secondary minerals were identified using raman spectroscopy labram hr evolution horiba jobin yvon s a s france to avoid local heating in the sample which may result in sample transformation particularly ferrihydrite to hematite the influence of the laser power was tested in preliminary experiments the functional groups and related oxidation states on the surface of the samples were analyzed by x ray photoelectron spectroscopy xps thermo scientific k alpha thermofisher samples were analyzed in the c1s o1s fe2p and as3d regions reflecting the major elements present at the surface fourier transform infrared ftir spectra of samples were collected on a vertex 70 spectrometer bruker germany in a wavelength range from 4000 to 400 cm 1 all analysis work was performed at the state key laboratory of biogeology and environmental geology china university of geosciences wuhan 2 5 reactive transport model surface complexation and transport modeling was performed to further interpret the geochemical behavior of as during the experiments using phreeqc interactive 3 6 2 considering the irrigation activity as a recharge process a one dimensional 1d transport model combined with surface complexation reactions was developed the surface complexation reactions in the model were considered as equilibrium reactions without kinetic processes all surface complexation reactions and corresponding constants are shown in table s1 3 results and discussion 3 1 aqueous phase as arsenic concentrations demonstrated different trends in the two experiments in column a fig 1 as concentrations at port 1 increased upon the initiation of reaction and reached a concentration of about 0 6 mm by the end of the experiment arsenic concentrations at ports 2 and 3 showed a similar trend with a gradual increase starting on day 5 concentrations at ports 4 and 5 demonstrated only minor changes in general as concentrations increased both in the vertical dimension from port 5 to port 1 and as time lapsed arsenic concentrations at port 4 were slightly elevated on day 12 but otherwise samples from ports 4 and 5 had consistently stable and low values in columns c and d desorption resulted in effluent as concentrations reaching about 1 71 mm day 4 and 0 69 mm day 2 respectively fig 1 but as concentrations decreased as the experiment proceeded arsenic concentrations decreased in the vertical dimension from port 1 to port 5 in columns c and d and showed similar trends although differing values with concentrations in column c higher than in column d in column d as concentrations at port 1 remained low throughout the experimental period while those at ports 2 and 3 obviously decreased starting from day 3 arsenic concentrations from port 4 showed a small increase from day 1 to day 3 with a sharp drop beginning on day 4 the overall trend of as concentrations at port 1 was the same as for port 2 and port 3 with small differences as desorption occurred in the control column e during the experiments fig 1 in the initial stage of experiment 2 as concentrations at the outlet decreased quickly with time before stabilizing the decline in desorption implies some adsorbed as iii on the ferrihydrite surface is in a highly labile state and rapidly responds to fluctuations in environmental conditions fendorf et al 2010 and the rapid stabilization of the amount released indicates the residual solid as may be adsorbed via more stable inner sphere complexation as iii can combine with fe hydro oxides through a variety of inner sphere complexes of varying strength ona nguema et al 2005 this occurs in combination with outer sphere complexes and h bonded moieties giving rise to extensive but weak complexes that are more sensitive to disturbances huling et al 2017 as a consequence this latter as iii can rapidly desorb in response to decreases in aqueous concentrations caused by water flow cao et al 2020 the interactions between om and fe minerals involve not only the adsorption of om on the mineral surface but also the formation of fe om co precipitates sodano et al 2017 for column a the adsorption of ha and as iii onto ferrihydrite coated sand occurred with the infiltration of irrigation water containing ha and as iii low as and doc concentrations were detected before day 5 and day 3 figs 1 fig s2 respectively and are attributed to adsorption the slow infiltration rate and the gradually decreasing adsorption capacity affected the mobilization of as and doc and thus their concentrations were stable from day 5 and day 3 onward respectively 3 2 variations in fe mineralogy the total amount of solid phase fe present in the ferrihydrite coated quartz sand used in the column experiments was 51 1 μm g 1 the total solid phase fe in these columns remained largely unchanged after the experiments compared to the control columns and the initial state fig s3 pore water fe concentrations were low 1 6 mg l 1 in both experiments despite fluctuations figs s4 s5 and the minimal changes evident in solid phase fe are consistent with the minimal migration and release of fe in the pore water this implies that throughout the process the transformation of as bearing ferrihydrite occurs in situ with high specific surface area and thermodynamic instability ferrihydrite is sensitive to biological abiotic reduction in general reduction reactions can initiate complex interaction pathways that lead to the production of multiple secondary minerals accompanied by the partial dissolution of those minerals fendorf et al 2010 in the present study the simulated aquifer medium was ferrihydrite coated quartz sand the loaded ferrihydrite and secondary minerals generated on the quartz sand base are present as thin layers with the surface area of the quartz sand base layer being much higher than that of the ferrihydrite coated sand an overall analysis of the medium will produce an overpowering quartz base signal which will mask information about the secondary surface minerals based on the above considerations raman spectroscopy was chosen to analyze the secondary minerals the main elements of interest in these experiments are fe as and c secondary minerals may contain fe hydro oxides fe as compounds fe c compounds fe as c compounds and so on raman spectra of these minerals have been studied extensively to better identify the secondary minerals raman spectra for quartz and the common fe minerals likely present in the current experiment were summarized in table s2 in addition spectra were collected for other fe minerals to corroborate the results from other methods the raman spectra of minerals in column a show major peaks at around 209 357 465 and 708 cm 1 fig s6a ferrihydrite peaks around 360 505 and 700 cm 1 are evident in samples from port 1 fig s6a indicating ferrihydrite is still the main mineral present the quartz base signal 128 206 and 464 cm 1 is obvious in samples from port 2 209 465 cm 1 port 3 131 212 209 465 cm 1 and port 4 209 465 cm 1 fig s6a the raman spectral results for samples from columns c and d are different from those for column a for column c goethite peaks are evident in samples from port 1 480 678 cm 1 and hematite peaks in samples from port 5 285 395 cm 1 fig s6b other peaks from samples from ports 2 3 and 4 are identified as characteristic peaks of ferrihydrite and quartz fig s6b goethite peaks are also found in column d in samples from port 3 675 cm 1 and port 4 292 682 cm 1 fig s6c peaks in samples from port 1 and port 2 are identified as characteristic peaks of ferrihydrite and quartz fig s6c however hematite peaks are also evident and attributed to local heating in the sample which results in the transformation of ferrihydrite to hematite legodi and dewaal 2007 mazzetti and thistlethwaite 2002 although preliminary experiments were conducted to determine optimal parameters to avoid local heating in the samples unstable instrument operation may have led to the transformation xps was conducted as an additional analysis of the thin secondary mineral layer on the quartz base surface combined analysis of the hydrochemical and raman results indicated the probable existence of goethite as a secondary mineral for example the gradual dissolution of ferrihydrite may result in the formation of goethite α feooh in the alkaline environment schwertmann 1983 under such conditions the secondary mineral α feooh was too thin to identify by other methods e g xrd and sem but had an obvious xps signal therefore the photoelectron peaks of ferrihydrite and goethite were fitted first when analyzing the xps spectra the relative binding energies and intensity ratio of the core level xps peak features will vary according to the compounds present strong peaks in the fe2p3 2 xps spectra of the samples were present at 710 8 0 3 ev which is the typical fe3 binding energy frau et al 2009 the literature reports the xps spectra main peak for fe iii o from ferrihydrite is at 709 6 ev with multiplet peaks at 708 7 710 7 711 9 and 713 3 ev magnuson et al 2004 however the overall fit results were not good after fitting these peaks the xps spectra main peak for fe iii o from α feooh is 710 2 ev with multiplet peaks at 711 2 712 1 713 2 and 714 5 ev grosvenor et al 2004 combining the ferrihydrite and α feooh peaks resulted in better xps spectra fitting results than using the characteristic peaks of a single mineral fig 3 the peak positions full width at half maximum fwhm and relative abundance from the curve fitting of fe2p3 2 are shown in table s3 the different orders of the addition of om and different intake of om result in different amounts of secondary minerals in the three reaction columns a c and d table s3 ferrihydrite is metastable and can transform to goethite and the solubility product of ferrihydrite ks 10 39 is higher than that of goethite ks 10 41 hansel et al 2004 the process of the transformation can be described as a dissolution crystallization cudennec and lecerf 2006 many adsorbed ions such as phosphate carbonate silicate and calcium can slow down or alter the transformation of ferrihydrite hansel et al 2003 hansel et al 2004 the adsorbed ions occupy the surface sites and inhibit the dissolution of ferrihydrite and the recrystallization of the secondary minerals adsorbed as could make ferrihydrite more stable by occupying the surface sites and inhibiting its transformation campbell and nordstrom 2014 3 3 formation of as fe om complex as mentioned above the infiltration of irrigation water affects the conditions in the reaction columns in experiment 1 ha and as occupied adsorption sites during the infiltration of irrigation water however port 4 was open during the entire experiment resulting in lower solution exchange and reaction below this point the top down entry of irrigation water caused the upper layer of ferrihydrite to adsorb ha and as first so the solid as content correspondingly decreased from top to bottom in contrast the as content reached 68 1 of the maximum as iii adsorption capacity of ferrihydrite before irrigation began in experiment 2 irrigation water infiltration then promoted the desorption of as from the ferrihydrite the introduction of ha accelerated the release of as from the ferrihydrite and contributed to the development of an alkaline environment under such conditions secondary minerals gradually formed the ha also combined with ferrihydrite to form complex compounds with ftir spectra providing evidence of as fe om complexes fig 4 ftir spectra of the ferrihydrite coated sand and ha used in the experiments are shown in fig 3a the absorption bands of fe iii oxides at large wavenumbers 3500 to 3000 cm 1 are due to oh stretching peaks at wavenumbers from 1500 to 400 cm 1 are due to fe o and fe oh lattice vibrations and bends the peak at 690 cm 1 is assigned to stretching modes of tetrahedral and octahedral fe o sites xiao et al 2017 the bands between 1200 and 900 cm 1 are assigned to the asymmetric stretching vibration of si o groups maximum at 1083 cm 1 bosch reig et al 2017 the ftir spectra of ha show a broad band at 3600 to 3200 cm 1 corresponding to the stretching vibrations of oh cooh and h2o bonds stoica et al 2018 the peak at 2923 cm 1 is attributed to the ch stretching vibration in ch2 liu et al 2021 the peaks at 1581 and 1383 cm 1 are attributed to asymmetric and symmetric vibrations for carboxyl coo groups and at 1011 cm 1 to the stretching vibrations of the ch indicating rich oxygen containing functional groups on the surface of pure sodium humate that are beneficial to complexation or adsorption reactions geng et al 2018 rao et al 2009 complexation of coo groups with metals can cause a frequency shift and change the shape of the stretching bands of coo sharma et al 2010 adsorption peaks at 3446 cm 1 are attributed to as o bonding xie et al 2016 in spectra from the two experiments here the as o bond peaks shift from 3446 to 3444 cm 1 column a port 4 or 3446 to 3448 cm 1 column a port 1 column c ports 2 4 5 column d ports 1 2 4 5 fig 3b d and the absorbance of samples from port 4 from each column also considerably increases all of which can be attributed to the formation of as om complexes after irrigation the adsorption peaks around 1630 cm 1 provide evidence of the presence of as fe om complexes liu et al 2020 sharma et al 2010 the signal in the as fe om fraction is attributed to a peak shift from 1581 cm 1 the lower intensities of these as fe om peaks than noted in other studies are the result of relatively low fe mineral content on the quartz surface and lower ha content at the conclusion of the experiments the peaks around 1080 cm 1 correspond to the si o bond in the quartz sand base the peaks around 467 and 777 cm 1 are attributed to the complexation of as and fe hydro oxides zhang et al 2018 and changes in their intensity may be due to the species and content of as and fe hydro oxides the peak at 690 cm 1 is attributed to as oh vibration further confirming the presence of as in these complexes sharma et al 2010 the ftir spectra from samples from each port demonstrate obvious differences for column a signals indicating the complexation of as with fe hydro oxides are not evident in samples from ports 4 and 5 which is attributed to the low as content at these locations in column c the signals associated with as fe om have the highest intensity in column d the ftir spectra for samples from each port demonstrate no significant differences overall as fe om signals from samples from port 4 from each column have higher intensities than samples from other ports for both experiments port 4 remained open for the duration resulting in the largest flow and exchange of constituents the intensities of signals representing the presence of as fe om complexes from other ports of column d are relatively lower perhaps due to the lower doc concentration entering the system fe hydro oxides can also act as bridges between as and om to form ternary complexes sharma et al 2010 although desorption of as occurred along with ha infiltration the original as fe hydro oxides in columns c and d could form as fe om ternary complexes with the ha being carried through the system with irrigation flow in addition surface ferric hydroxyl groups play an important role in the formation of as fe complexes on fe surfaces ona nguema et al 2005 and the inner sphere complexation in particular is responsible for arsenic oxidation zhao et al 2011 since anions compete for the surface functional groups carboxyl group of ha thereby significantly inhibiting the inner sphere complexation the inhibitory effect of ha on as iii oxidation in the ferrihydrite ha co precipitation may be due to the partial coverage of the inner sphere binding sites of the ferrihydrite xue et al 2019 3 4 reactive transport model surface complexation and transport modeling was conducted to simulate the process of experiment 1 to further analyze the behavior of as under irrigation conditions three models of different surface complexation code were chosen model 1 considering ferrihydrite as ferrihydrite om and om as surface complexation model 2 only considering ferrihydrite as surface complexation and model 3 considering ferrihydrite as and ferrihydrite om surface complexation the as concentrations predicted by the model are shown in fig 4 as concentrations predicted by model 3 were higher than the other models at the beginning of the experiment and then lower at the end as concentrations of model 1 were lower than the other models at the beginning of the experiment and then higher in the end and as concentrations of model 2 were intermediate between model 1 and 3 the trends of the three models are similar to that determined experimentally but with obvious differences in values indicating poor model fitting overall the model predictions were higher than the experimental data which may be due to a number of factors on the one hand the complexation parameters of om with as are incomplete and the effects of functional groups on as complexation are not distinguished on the other hand after ferrihydrite adsorbs om the resulting ferrihydrite om complex can still form a ternary complex with as but this possibility is not included in the model 3 5 distribution of solid as with irrigation water infiltrating the gradual entrance of ha and as iii solution resulted in the occupation of surface sites on the ferrihydrite in experiment 1 the arsenic content at port 1 reached nearly 55 9 of the maximum as iii adsorption capacity of ferrihydrite with that at other ports being about 52 1 port 2 6 3 port 3 2 5 port 4 and 1 1 port 5 fig 5 a in experiment 2 solid as contents sampled from the five ports in columns c d and e resulted in a vertically increasing trend fig 5b arsenic content accounted for about 42 1 port 1 50 1 port 2 55 9 port 3 57 7 port 4 and 62 6 port 5 of the maximum as iii adsorption capacity onto ferrihydrite the experiments can be described as a recharge process from the ground into the unsaturated saturated zone in experiment 1 outlet as concentrations reflect the trend of the adsorption curves however the results of solid as analyses and the transport and surface complexation model indicate the adsorption of as onto ferrihydrite did not reach saturation during irrigation due to the presence of om in addition hydrodynamic conditions controlled the surface activity of ferrihydrite by eluting the adsorbed as cao et al 2020 although a transport code was included in the geochemical model the whole transport process could not be accurately described the process of flow infiltration from the top to the outlet of port 4 and final to the bottom needs to be considered for the whole transport process and phreqqc code could not reach at the present stage in experiment 2 as on the surface of the initial ferrihydrite represents about 68 1 of the maximum possible adsorption occupying most of the surface active sites the introduction of ha caused a significant increase in the effluent as concentrations of columns c and d compared to column e fig 1 ha may first drive the desorption of as initially adsorbed through ligand exchange as this process can occupy a large number of active sites on the ferrihydrite surface however the gradually increasing alkaline environment due to the introduction of ha can accelerate the transformation of ferrihydrite the newly formed secondary minerals have a weaker ability to adsorb as leading to its desorption ha can also adsorb as and easily forms complexes with ferrihydrite and then re adsorbs as thus the as concentration in the pore water was observed to fluctuate 4 conclusions knowledge regarding interactions among as fe and om was extended in this study and is helpful for better understanding the interactions and cycling within as fe om systems under irrigation conditions implications with respect to subsurface as im mobilization under irrigation activities is also presented this study also confirms the competition between om and as iii on the surface of the fe iii bearing minerals and the formation of as fe om ternary complexes adsorption and desorption may be the most important processes controlling the fate of as in the environment under different irrigation scenarios as desorption can occur due to a variety of factors firstly when the irrigation water containing ha and as iii the adsorption of ha and as iii onto ferrihydrite coated sand occurred with irrigation going on with the gradually decreasing adsorption capacity concentrations of as and doc came to stable and under another scenario with the irrigation water containing ha the inhibition of as adsorption ha mainly occurs because om competes with as for available binding sites on fe hydro oxide surfaces and the carboxyl groups of om can intensely interact with ferric hydroxyl functional groups through ligand exchange or bond formation besides the rapid response for the declined desorption of as iii on the ferrihydrite surface during irrigation and the rapidly stable desorption amount indicates the residual solid as was adsorbed via more stable inner sphere complexation fe hydro oxides could also act as bridges between as and om to form ternary complexes thus as fe om ternary complexes formed during irrigation and further affected the desorption of as onto ferrihydrite surface sites therefore om may accelerate the mobility of as and the presence of om and ternary as fe om complexes must be taken into account when predicting as mobility this experiment simulates a scenario in which irrigation water containing om and as enters the subsurface this can occur when om accumulates due to agricultural activities in areas affected by high as levels the results are helpful for evaluating the migration of as under agricultural activities using high as groundwater for irrigation and indicate that managing om and or as contaminated water for agricultural activities is required to protect human health moreover work considering biological factors is required for the further understanding of as fe om interactions affecting as mobilization under irrigation activities credit authorship contribution statement ziyi xiao conceptualization formal analysis investigation methodology software writing original draft xianjun xie resources supervision writing review editing kunfu pi writing review editing jiaming gong investigation yanxin wang funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work was financially supported by national natural science foundation of china 42020104005 national key research and development program of china 2021yfa0715900 the ministry of education of china 111 project and the fundamental research funds for the central universities china university of geosciences wuhan appendix a supplementary material supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128837 appendix a supplementary material the following are the supplementary data to this article supplementary data 1 
2596,arsenic as iron fe organic matter om compound is critical for the mobilization of as under irrigation conditions we explore the interaction mechanism among as fe om components for different reaction pathways in column experiments under irrigation conditions using ferrihydrite coated sand sodium humate ha and as iii arsenic mobilization is strongly controlled by the adsorption of as on fe minerals which in turn is affected by the presence of om in the pure ferrihydrite coated sand column outlet as and ha concentrations gradually increased and reached a stable state in the ferrihydrite as coated sand columns the release of as occurred with ha infiltration and the ha concentrations influenced the release rate of as from the ferrihydrite the results suggest om interacts with as and fe minerals to promote as mobility with the concentration om influencing the amount of as released although competitive adsorption occurred in the presence of om ferrihydrite acts as bridges between as and om to form as fe om ternary complexes and further affected the mobilization of as these results are important for evaluating the migration of as under agricultural activities using high as groundwater for irrigation and indicate managing om and as contaminated water for agricultural activities is required to limit impacts on human health keywords arsenic ferrihydrite organic matter ternary complexation data availability data will be made available on request 1 introduction arsenic as contamination of water and soil has been considered a grand challenge and environmental issue worldwide organic matter om interacts with as affecting the behavior of as in the water environment and sedimentary om is considered closely related to the high concentration of as in sediments aftabtalab et al 2022 om can affect the form of as via redox reactions or the formation of om as complexes mcarthur et al 2001 it also reduces as v in the presence of metal hydro oxides forming water soluble complexes with as iii and as v the presence of om can promote as adsorption and thus reduce as activity saada et al 2003 furthermore om can catalyze both oxidation and reduction processes and can also form as metal om ternary complexes through metal bridging mechanisms redman et al 2002 mineral hydro oxides the water soluble or insoluble inner surface complex with metal cations involving ca2 mn2 4 mg2 or al3 could act as surface catalysts or electron transfer agents and form om metal complexes which may strongly bind to other dissolved anions thereby reducing the possibility of these anions forming surface complexes the interactions between om and fe minerals involve the adsorption of om onto the mineral surface and fe om co precipitation sodano et al 2017 the main structure of om i e carboxyl groups provides abundant binding sites for co precipitation with fe in acidic mineral dominated soils more than 80 of total om occurs co precipitated with fe iii which can inhibit the formation of fe minerals xue et al 2019 the fe om co precipitates exhibit strong selective retention for aromatics with a resulting stability that is higher than that of adsorbed substances chen et al 2014 om in the subsurface environment is an important factor affecting the redox potential it can react with fe hydro oxides which are subsequently reduced and dissolve into other minerals burton et al 2013 xu et al 2019 furthermore different c fe molar ratios can result in fe hydro oxides that exhibit different properties liao et al 2020 humic acid ha contains numerous functional groups and typically represents a large portion of organic matter om morales et al 2012 the functional groups on ha have a significant influence on metal oxides exhibiting a high degree of reactivity and a strong binding ability tang et al 2014 that affects the aggregation retention and bioavailability of metal oxides xu et al 2019 studies focused on as fe and om show om affects as mobilization and migration in the natural environment li et al 2019 wang et al 2019 the adsorption and mobilization of as iii and as v on fe ha complexes has also been reported ma et al 2018 xue et al 2019 however the effect of different reaction pathways among as fe and om on as im mobilization under irrigation conditions has not yet been studied in detail high as groundwater is often accompanied by high ha and fulvic acid content liu et al 2020 using high as groundwater for agricultural irrigation will input as and om into the subsurface and because as is closely related to fe hydro oxides the biogeochemical reaction processes that occur during irrigation are particularly complex xiao et al 2021 xiao et al 2018 irrigation activities using high as groundwater led to the fluctuations in the water table varying redox conditions and the redistribution of as and fe in the near surface sediments om introduced by irrigation generated the ternary complex of as fe om and contributed to the im mobilization of as in the unsaturated saturated zone to determine how different reaction paths and the influence of om concentrations change the properties of fe hydro oxides and further determine the fate of pollutants ferrihydrite coated quartz sand ha and as iii were used in column experiments to understand the reaction mechanism under different reaction paths the experiment considered two reaction path systems under irrigation conditions the results suggest under different irrigation scenarios as desorption can occur and gradually reach a stable state due to the presence of om and surface complexes with ferrihydrite and om which also provide a new perspective on the effect of the interactions among as fe and om on the mobilization and transformation of as under irrigation conditions 2 materials and methods 2 1 materials all glass and plastic used in the experiments were cleaned by soaking in 10 v v hno3 for 24 h followed by repeated rinsing with deionized water diw all solutions were prepared with 18 25 mω cm diw in a highly pure n2 99 999 environment at 25 all chemicals used were of analytical or trace metal grade ha sodium humate purchased from sigma aldrich h16752 2 shanghai china was used to represent om as iii standard solution was prepared by dissolving appropriate amounts of sodium meta arsenite 98 sigma aldrich st louis mo usa in diw sodium chloride nacl prepared at 2 mm was used as the background electrolyte stock solutions of ha were prepared by dissolving 0 50 g of ha in 100 ml of potassium hydroxide 0 1 m liu and cai 2010 when used in the experiments 5 ml of ha stock solution were diluted in 495 ml of diw and filtered through 0 45 μm pore size polytetrafluoroethylene ptfe membrane filters after dilution the working ha solution contained 18 mg l 1 dissolved organic carbon doc and 0 28 0 77 0 07 and 31 2 mg l 1 ca k mg and na respectively 2 2 preparation of the column experiments quartz sand diameter 250 300 μm 99 9 sio2 was cleaned of any metal oxides colloids and clays by sequentially soaking it in 0 01 m hno3 0 01 m naoh and 30 h2o2 for 24 h each rinsing with diw 20 30 times and then drying at 105 for 24 h 2 line ferrihydrite was synthesized by titrating an fecl3 solution with naoh to a ph of 7 5 within 5 min to avoid the precipitation of akageneite burton et al 2011 naoh solution was used to keep the ph of the ferrihydrite floc stable at 7 5 for 2 h cao et al 2020 the resulting floc was rinsed several times with diw until the ec value of the floc equal to that of diw followed by mixing with quartz sand and drying at 80 c with periodic stirring the results of x ray diffraction xrd scanning electron microscopy sem and energy dispersive x ray spectroscopy eds verified the precipitate was pure 2 line ferrihydrite and that the quartz was coated successfully with ferrihydrite fig s1 dry ferrihydrite coated quartz sand was resuspended and maintained for 24 h in 2 mm nacl solution in a highly pure n2 99 999 environment the sand suspension was then transferred to perspex columns each column length 40 cm inner diameter 7 cm was outfitted with sampling ports set at 3 cm intervals from 16 to 28 cm from the bottom of the column labeled as ports 1 to 5 from top to bottom columns for the experiments were filled with cleaned quartz sand from the bottom to 14 5 cm with ferrihydrite coated quartz sand from 14 5 cm to 29 cm and cleaned quartz sand from 29 cm to 35 cm the columns had characteristics as follows effective porosity 0 44 hydraulic conductivity 2 6 10 4 m s 1 longitudinal dispersity 0 11 cm and skewness of breakthrough curve 0 41 2 3 design of the column experiments irrigation water infiltration was added to the top of the column and port 4 was open during the whole experiment to control the water table and worked as the liquid outlet during irrigation the water table remained 2 cm above the quartz flooding the column experiments were divided into two groups totaling five columns table 1 irrigation water was extracted using a pump at a velocity of 440 cm3 d 1 for experiment 1 pore water samples were collected at 1 d intervals over a 16 d reaction period the irrigation was discontinued from day 10 to day 12 and restarted on day 13 until ending on day 15 for experiment 2 the solution containing as iii 1 02 mm was fed into the bottom of the column at a velocity of 220 cm3 d 1 to first create as ferrihydrite coated quartz sand arsenic loading was complete when the effluent as concentration stabilized about 1 02 mm the total as concentration of the final as ferrihydrite coated sand was about 5 7 μm g 1 during the 8 d reaction period irrigation ended on day 7 pore water samples were collected at 1 d intervals the experiments have not been conducted in triplicates to ensure and control for variables that are not relevant to the experiments the sand suspension transferred to perspex columns under the same conditions using the same batch of quartz and ferrihydrite coated quartz sand and the processes of as loading for column c d and e have been completed under the same conditions 2 4 analytical methods solid phase samples were collected from the sampling ports of the post reaction columns and all results are presented on a dry weight basis as species separation in water samples were determined using lc sax anion exchange resin sigma aldrich with samples for total as and as iii measurements acidified to ph 2 with ultra pure hcl aqueous as concentrations were analyzed by hydride generation atomic fluorescence spectrometry hg afs afs 9700 beijing haiguang instruments the concentrations of aqueous total fe were determined by the 1 10 phenanthroline method hydroxylamine hydrochloride used as a reductant samples for doc analysis were acidified to ph 2 with concentrated hcl and stored in brown plastic bottles doc concentrations were measured by a toc crds isotope carbon analyzer picarro america with a detection limit of 0 01 mg l 1 soil samples 1 g were digested with 10 ml 1 1 hcl at 100 for 24 h to determine total as and fe contents the shape of material layers on the sand particle surfaces was identified using x ray diffraction xrd analysis bruker axs d8 focus with a cuka x ray radiation wavelength of 0 15406 nm and a lynxeye detector samples for sem were mounted on aluminum based stubs coated with gold and rapidly transferred to a hitachi su8010 sem system to analyze surface morphology the chemical composition in associated target areas was determined by eds ametek edax appollo xp secondary minerals were identified using raman spectroscopy labram hr evolution horiba jobin yvon s a s france to avoid local heating in the sample which may result in sample transformation particularly ferrihydrite to hematite the influence of the laser power was tested in preliminary experiments the functional groups and related oxidation states on the surface of the samples were analyzed by x ray photoelectron spectroscopy xps thermo scientific k alpha thermofisher samples were analyzed in the c1s o1s fe2p and as3d regions reflecting the major elements present at the surface fourier transform infrared ftir spectra of samples were collected on a vertex 70 spectrometer bruker germany in a wavelength range from 4000 to 400 cm 1 all analysis work was performed at the state key laboratory of biogeology and environmental geology china university of geosciences wuhan 2 5 reactive transport model surface complexation and transport modeling was performed to further interpret the geochemical behavior of as during the experiments using phreeqc interactive 3 6 2 considering the irrigation activity as a recharge process a one dimensional 1d transport model combined with surface complexation reactions was developed the surface complexation reactions in the model were considered as equilibrium reactions without kinetic processes all surface complexation reactions and corresponding constants are shown in table s1 3 results and discussion 3 1 aqueous phase as arsenic concentrations demonstrated different trends in the two experiments in column a fig 1 as concentrations at port 1 increased upon the initiation of reaction and reached a concentration of about 0 6 mm by the end of the experiment arsenic concentrations at ports 2 and 3 showed a similar trend with a gradual increase starting on day 5 concentrations at ports 4 and 5 demonstrated only minor changes in general as concentrations increased both in the vertical dimension from port 5 to port 1 and as time lapsed arsenic concentrations at port 4 were slightly elevated on day 12 but otherwise samples from ports 4 and 5 had consistently stable and low values in columns c and d desorption resulted in effluent as concentrations reaching about 1 71 mm day 4 and 0 69 mm day 2 respectively fig 1 but as concentrations decreased as the experiment proceeded arsenic concentrations decreased in the vertical dimension from port 1 to port 5 in columns c and d and showed similar trends although differing values with concentrations in column c higher than in column d in column d as concentrations at port 1 remained low throughout the experimental period while those at ports 2 and 3 obviously decreased starting from day 3 arsenic concentrations from port 4 showed a small increase from day 1 to day 3 with a sharp drop beginning on day 4 the overall trend of as concentrations at port 1 was the same as for port 2 and port 3 with small differences as desorption occurred in the control column e during the experiments fig 1 in the initial stage of experiment 2 as concentrations at the outlet decreased quickly with time before stabilizing the decline in desorption implies some adsorbed as iii on the ferrihydrite surface is in a highly labile state and rapidly responds to fluctuations in environmental conditions fendorf et al 2010 and the rapid stabilization of the amount released indicates the residual solid as may be adsorbed via more stable inner sphere complexation as iii can combine with fe hydro oxides through a variety of inner sphere complexes of varying strength ona nguema et al 2005 this occurs in combination with outer sphere complexes and h bonded moieties giving rise to extensive but weak complexes that are more sensitive to disturbances huling et al 2017 as a consequence this latter as iii can rapidly desorb in response to decreases in aqueous concentrations caused by water flow cao et al 2020 the interactions between om and fe minerals involve not only the adsorption of om on the mineral surface but also the formation of fe om co precipitates sodano et al 2017 for column a the adsorption of ha and as iii onto ferrihydrite coated sand occurred with the infiltration of irrigation water containing ha and as iii low as and doc concentrations were detected before day 5 and day 3 figs 1 fig s2 respectively and are attributed to adsorption the slow infiltration rate and the gradually decreasing adsorption capacity affected the mobilization of as and doc and thus their concentrations were stable from day 5 and day 3 onward respectively 3 2 variations in fe mineralogy the total amount of solid phase fe present in the ferrihydrite coated quartz sand used in the column experiments was 51 1 μm g 1 the total solid phase fe in these columns remained largely unchanged after the experiments compared to the control columns and the initial state fig s3 pore water fe concentrations were low 1 6 mg l 1 in both experiments despite fluctuations figs s4 s5 and the minimal changes evident in solid phase fe are consistent with the minimal migration and release of fe in the pore water this implies that throughout the process the transformation of as bearing ferrihydrite occurs in situ with high specific surface area and thermodynamic instability ferrihydrite is sensitive to biological abiotic reduction in general reduction reactions can initiate complex interaction pathways that lead to the production of multiple secondary minerals accompanied by the partial dissolution of those minerals fendorf et al 2010 in the present study the simulated aquifer medium was ferrihydrite coated quartz sand the loaded ferrihydrite and secondary minerals generated on the quartz sand base are present as thin layers with the surface area of the quartz sand base layer being much higher than that of the ferrihydrite coated sand an overall analysis of the medium will produce an overpowering quartz base signal which will mask information about the secondary surface minerals based on the above considerations raman spectroscopy was chosen to analyze the secondary minerals the main elements of interest in these experiments are fe as and c secondary minerals may contain fe hydro oxides fe as compounds fe c compounds fe as c compounds and so on raman spectra of these minerals have been studied extensively to better identify the secondary minerals raman spectra for quartz and the common fe minerals likely present in the current experiment were summarized in table s2 in addition spectra were collected for other fe minerals to corroborate the results from other methods the raman spectra of minerals in column a show major peaks at around 209 357 465 and 708 cm 1 fig s6a ferrihydrite peaks around 360 505 and 700 cm 1 are evident in samples from port 1 fig s6a indicating ferrihydrite is still the main mineral present the quartz base signal 128 206 and 464 cm 1 is obvious in samples from port 2 209 465 cm 1 port 3 131 212 209 465 cm 1 and port 4 209 465 cm 1 fig s6a the raman spectral results for samples from columns c and d are different from those for column a for column c goethite peaks are evident in samples from port 1 480 678 cm 1 and hematite peaks in samples from port 5 285 395 cm 1 fig s6b other peaks from samples from ports 2 3 and 4 are identified as characteristic peaks of ferrihydrite and quartz fig s6b goethite peaks are also found in column d in samples from port 3 675 cm 1 and port 4 292 682 cm 1 fig s6c peaks in samples from port 1 and port 2 are identified as characteristic peaks of ferrihydrite and quartz fig s6c however hematite peaks are also evident and attributed to local heating in the sample which results in the transformation of ferrihydrite to hematite legodi and dewaal 2007 mazzetti and thistlethwaite 2002 although preliminary experiments were conducted to determine optimal parameters to avoid local heating in the samples unstable instrument operation may have led to the transformation xps was conducted as an additional analysis of the thin secondary mineral layer on the quartz base surface combined analysis of the hydrochemical and raman results indicated the probable existence of goethite as a secondary mineral for example the gradual dissolution of ferrihydrite may result in the formation of goethite α feooh in the alkaline environment schwertmann 1983 under such conditions the secondary mineral α feooh was too thin to identify by other methods e g xrd and sem but had an obvious xps signal therefore the photoelectron peaks of ferrihydrite and goethite were fitted first when analyzing the xps spectra the relative binding energies and intensity ratio of the core level xps peak features will vary according to the compounds present strong peaks in the fe2p3 2 xps spectra of the samples were present at 710 8 0 3 ev which is the typical fe3 binding energy frau et al 2009 the literature reports the xps spectra main peak for fe iii o from ferrihydrite is at 709 6 ev with multiplet peaks at 708 7 710 7 711 9 and 713 3 ev magnuson et al 2004 however the overall fit results were not good after fitting these peaks the xps spectra main peak for fe iii o from α feooh is 710 2 ev with multiplet peaks at 711 2 712 1 713 2 and 714 5 ev grosvenor et al 2004 combining the ferrihydrite and α feooh peaks resulted in better xps spectra fitting results than using the characteristic peaks of a single mineral fig 3 the peak positions full width at half maximum fwhm and relative abundance from the curve fitting of fe2p3 2 are shown in table s3 the different orders of the addition of om and different intake of om result in different amounts of secondary minerals in the three reaction columns a c and d table s3 ferrihydrite is metastable and can transform to goethite and the solubility product of ferrihydrite ks 10 39 is higher than that of goethite ks 10 41 hansel et al 2004 the process of the transformation can be described as a dissolution crystallization cudennec and lecerf 2006 many adsorbed ions such as phosphate carbonate silicate and calcium can slow down or alter the transformation of ferrihydrite hansel et al 2003 hansel et al 2004 the adsorbed ions occupy the surface sites and inhibit the dissolution of ferrihydrite and the recrystallization of the secondary minerals adsorbed as could make ferrihydrite more stable by occupying the surface sites and inhibiting its transformation campbell and nordstrom 2014 3 3 formation of as fe om complex as mentioned above the infiltration of irrigation water affects the conditions in the reaction columns in experiment 1 ha and as occupied adsorption sites during the infiltration of irrigation water however port 4 was open during the entire experiment resulting in lower solution exchange and reaction below this point the top down entry of irrigation water caused the upper layer of ferrihydrite to adsorb ha and as first so the solid as content correspondingly decreased from top to bottom in contrast the as content reached 68 1 of the maximum as iii adsorption capacity of ferrihydrite before irrigation began in experiment 2 irrigation water infiltration then promoted the desorption of as from the ferrihydrite the introduction of ha accelerated the release of as from the ferrihydrite and contributed to the development of an alkaline environment under such conditions secondary minerals gradually formed the ha also combined with ferrihydrite to form complex compounds with ftir spectra providing evidence of as fe om complexes fig 4 ftir spectra of the ferrihydrite coated sand and ha used in the experiments are shown in fig 3a the absorption bands of fe iii oxides at large wavenumbers 3500 to 3000 cm 1 are due to oh stretching peaks at wavenumbers from 1500 to 400 cm 1 are due to fe o and fe oh lattice vibrations and bends the peak at 690 cm 1 is assigned to stretching modes of tetrahedral and octahedral fe o sites xiao et al 2017 the bands between 1200 and 900 cm 1 are assigned to the asymmetric stretching vibration of si o groups maximum at 1083 cm 1 bosch reig et al 2017 the ftir spectra of ha show a broad band at 3600 to 3200 cm 1 corresponding to the stretching vibrations of oh cooh and h2o bonds stoica et al 2018 the peak at 2923 cm 1 is attributed to the ch stretching vibration in ch2 liu et al 2021 the peaks at 1581 and 1383 cm 1 are attributed to asymmetric and symmetric vibrations for carboxyl coo groups and at 1011 cm 1 to the stretching vibrations of the ch indicating rich oxygen containing functional groups on the surface of pure sodium humate that are beneficial to complexation or adsorption reactions geng et al 2018 rao et al 2009 complexation of coo groups with metals can cause a frequency shift and change the shape of the stretching bands of coo sharma et al 2010 adsorption peaks at 3446 cm 1 are attributed to as o bonding xie et al 2016 in spectra from the two experiments here the as o bond peaks shift from 3446 to 3444 cm 1 column a port 4 or 3446 to 3448 cm 1 column a port 1 column c ports 2 4 5 column d ports 1 2 4 5 fig 3b d and the absorbance of samples from port 4 from each column also considerably increases all of which can be attributed to the formation of as om complexes after irrigation the adsorption peaks around 1630 cm 1 provide evidence of the presence of as fe om complexes liu et al 2020 sharma et al 2010 the signal in the as fe om fraction is attributed to a peak shift from 1581 cm 1 the lower intensities of these as fe om peaks than noted in other studies are the result of relatively low fe mineral content on the quartz surface and lower ha content at the conclusion of the experiments the peaks around 1080 cm 1 correspond to the si o bond in the quartz sand base the peaks around 467 and 777 cm 1 are attributed to the complexation of as and fe hydro oxides zhang et al 2018 and changes in their intensity may be due to the species and content of as and fe hydro oxides the peak at 690 cm 1 is attributed to as oh vibration further confirming the presence of as in these complexes sharma et al 2010 the ftir spectra from samples from each port demonstrate obvious differences for column a signals indicating the complexation of as with fe hydro oxides are not evident in samples from ports 4 and 5 which is attributed to the low as content at these locations in column c the signals associated with as fe om have the highest intensity in column d the ftir spectra for samples from each port demonstrate no significant differences overall as fe om signals from samples from port 4 from each column have higher intensities than samples from other ports for both experiments port 4 remained open for the duration resulting in the largest flow and exchange of constituents the intensities of signals representing the presence of as fe om complexes from other ports of column d are relatively lower perhaps due to the lower doc concentration entering the system fe hydro oxides can also act as bridges between as and om to form ternary complexes sharma et al 2010 although desorption of as occurred along with ha infiltration the original as fe hydro oxides in columns c and d could form as fe om ternary complexes with the ha being carried through the system with irrigation flow in addition surface ferric hydroxyl groups play an important role in the formation of as fe complexes on fe surfaces ona nguema et al 2005 and the inner sphere complexation in particular is responsible for arsenic oxidation zhao et al 2011 since anions compete for the surface functional groups carboxyl group of ha thereby significantly inhibiting the inner sphere complexation the inhibitory effect of ha on as iii oxidation in the ferrihydrite ha co precipitation may be due to the partial coverage of the inner sphere binding sites of the ferrihydrite xue et al 2019 3 4 reactive transport model surface complexation and transport modeling was conducted to simulate the process of experiment 1 to further analyze the behavior of as under irrigation conditions three models of different surface complexation code were chosen model 1 considering ferrihydrite as ferrihydrite om and om as surface complexation model 2 only considering ferrihydrite as surface complexation and model 3 considering ferrihydrite as and ferrihydrite om surface complexation the as concentrations predicted by the model are shown in fig 4 as concentrations predicted by model 3 were higher than the other models at the beginning of the experiment and then lower at the end as concentrations of model 1 were lower than the other models at the beginning of the experiment and then higher in the end and as concentrations of model 2 were intermediate between model 1 and 3 the trends of the three models are similar to that determined experimentally but with obvious differences in values indicating poor model fitting overall the model predictions were higher than the experimental data which may be due to a number of factors on the one hand the complexation parameters of om with as are incomplete and the effects of functional groups on as complexation are not distinguished on the other hand after ferrihydrite adsorbs om the resulting ferrihydrite om complex can still form a ternary complex with as but this possibility is not included in the model 3 5 distribution of solid as with irrigation water infiltrating the gradual entrance of ha and as iii solution resulted in the occupation of surface sites on the ferrihydrite in experiment 1 the arsenic content at port 1 reached nearly 55 9 of the maximum as iii adsorption capacity of ferrihydrite with that at other ports being about 52 1 port 2 6 3 port 3 2 5 port 4 and 1 1 port 5 fig 5 a in experiment 2 solid as contents sampled from the five ports in columns c d and e resulted in a vertically increasing trend fig 5b arsenic content accounted for about 42 1 port 1 50 1 port 2 55 9 port 3 57 7 port 4 and 62 6 port 5 of the maximum as iii adsorption capacity onto ferrihydrite the experiments can be described as a recharge process from the ground into the unsaturated saturated zone in experiment 1 outlet as concentrations reflect the trend of the adsorption curves however the results of solid as analyses and the transport and surface complexation model indicate the adsorption of as onto ferrihydrite did not reach saturation during irrigation due to the presence of om in addition hydrodynamic conditions controlled the surface activity of ferrihydrite by eluting the adsorbed as cao et al 2020 although a transport code was included in the geochemical model the whole transport process could not be accurately described the process of flow infiltration from the top to the outlet of port 4 and final to the bottom needs to be considered for the whole transport process and phreqqc code could not reach at the present stage in experiment 2 as on the surface of the initial ferrihydrite represents about 68 1 of the maximum possible adsorption occupying most of the surface active sites the introduction of ha caused a significant increase in the effluent as concentrations of columns c and d compared to column e fig 1 ha may first drive the desorption of as initially adsorbed through ligand exchange as this process can occupy a large number of active sites on the ferrihydrite surface however the gradually increasing alkaline environment due to the introduction of ha can accelerate the transformation of ferrihydrite the newly formed secondary minerals have a weaker ability to adsorb as leading to its desorption ha can also adsorb as and easily forms complexes with ferrihydrite and then re adsorbs as thus the as concentration in the pore water was observed to fluctuate 4 conclusions knowledge regarding interactions among as fe and om was extended in this study and is helpful for better understanding the interactions and cycling within as fe om systems under irrigation conditions implications with respect to subsurface as im mobilization under irrigation activities is also presented this study also confirms the competition between om and as iii on the surface of the fe iii bearing minerals and the formation of as fe om ternary complexes adsorption and desorption may be the most important processes controlling the fate of as in the environment under different irrigation scenarios as desorption can occur due to a variety of factors firstly when the irrigation water containing ha and as iii the adsorption of ha and as iii onto ferrihydrite coated sand occurred with irrigation going on with the gradually decreasing adsorption capacity concentrations of as and doc came to stable and under another scenario with the irrigation water containing ha the inhibition of as adsorption ha mainly occurs because om competes with as for available binding sites on fe hydro oxide surfaces and the carboxyl groups of om can intensely interact with ferric hydroxyl functional groups through ligand exchange or bond formation besides the rapid response for the declined desorption of as iii on the ferrihydrite surface during irrigation and the rapidly stable desorption amount indicates the residual solid as was adsorbed via more stable inner sphere complexation fe hydro oxides could also act as bridges between as and om to form ternary complexes thus as fe om ternary complexes formed during irrigation and further affected the desorption of as onto ferrihydrite surface sites therefore om may accelerate the mobility of as and the presence of om and ternary as fe om complexes must be taken into account when predicting as mobility this experiment simulates a scenario in which irrigation water containing om and as enters the subsurface this can occur when om accumulates due to agricultural activities in areas affected by high as levels the results are helpful for evaluating the migration of as under agricultural activities using high as groundwater for irrigation and indicate that managing om and or as contaminated water for agricultural activities is required to protect human health moreover work considering biological factors is required for the further understanding of as fe om interactions affecting as mobilization under irrigation activities credit authorship contribution statement ziyi xiao conceptualization formal analysis investigation methodology software writing original draft xianjun xie resources supervision writing review editing kunfu pi writing review editing jiaming gong investigation yanxin wang funding acquisition resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work was financially supported by national natural science foundation of china 42020104005 national key research and development program of china 2021yfa0715900 the ministry of education of china 111 project and the fundamental research funds for the central universities china university of geosciences wuhan appendix a supplementary material supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128837 appendix a supplementary material the following are the supplementary data to this article supplementary data 1 
2597,currently specialized system models implemented on the basis of decision support in exceptional emergency situations states using machine learning artificial intelligence including using neural networks to reproduce predict and prevent or minimize the risk of consequences in exceptional situations are useful and are becoming increasingly popular floods also fall under such exceptional situations and states on the basis of which the task of early forecasting of an exceptional situation arises using the example of rising water levels at stationary hydrological posts in order to prevent or minimize the risk the transition of the territory management system under consideration to an exceptional state emergency situation to solve this problem a decision support system is proposed for early prediction of water rise levels based on a neural network intelligent analysis of retrospective data code of a stationary hydrological post automatic station date water level at a stationary hydrological post automatic station atmospheric pressure wind speed snow cover thickness amount of precipitation time and air temperature in order to calculate the values of water levels for 5 days in advance the artificial neural network itself is based on the freely distributed tensorflow machine learning software library and a modified error backpropagation method is used as training the main difference of which is the addition of an artificial neural network ann learning rate increase factor a mathematical model of the subject area is constructed in the form of a multidimensional space and an integrated multidimensional data model a single integrated model describes the subject area quite fully and can be used as a single source of information which provides system information support defined as a set of distributed databases all this makes it possible to improve the accuracy of forecast values of water levels at stationary hydrological posts and automatic stations the main difficulty in early forecasting is a sharp rise in water levels over a short period of time usually 1 day for various reasons our neural network model takes this into account and allows us to give more accurate results the results of the analysis of the effectiveness of the method showed that the proposed decision support system is more accurate the average error does not exceed 55 68 cm for the entire flood period the average error between the real and calculated values in the framework of forecasting for 5 days does not exceed 2 10 compared to existing common methods systems 8 36 this will give the necessary time to special services to carry out anti flood measures to prepare for the protection of technical facilities of enterprises keywords forecasting intellectual analysis neural network analysis retrospective data data mining forecasting water levels data availability the authors do not have permission to share data 1 introduction at present due to the emergence of new various sources and technologies for obtaining and processing data on objects and systems including their locations fundamentally new conditions have been formed for better management of various hydrological processes for example floods and phenomena at the same time within the framework of managing such processes and phenomena a certain duality of the situation arises on the one hand existing models and methods for obtaining and processing data use rather large volumes of heterogeneous information the processing of which requires a fairly large time resource on the other hand there are limiting factors for example the time to make any management decisions based on the available data when these processes occur in our case a flood at the same time data especially as an external factor can directly influence decision making within the framework of various processes in our case hydrological and phenomena including natural ones as they contribute to threats to various integral systems for example urban settlements and subsystems districts of urban settlements based on this in order to make a quality management decision in case of such threats it is necessary to obtain data on ongoing processes and phenomena in advance the complexity of this problem is determined by a sufficiently large number of control parameters the vagueness of requirements and the variability of control goals on the part of various system users and participants in the control process the need to minimize the vulnerability of these systems in the presence of a large number of threats of various nature and complexity to solve this problem it is proposed to obtain information about a possible future phenomenon or process to predict in our case using the example of a flood the rise in water levels of water resources using a subsystem of a geographic information system for managing a territory implemented on the basis of a second generation artificial neural network consider this geographic information system gis for territory management fig 1 let s denote it as a which should have a number of system wide properties including the properties of stability adaptability and emergence in the context of the case under consideration the stability of a gis is understood as its certain ability to return to an equilibrium state after the impact of some external disturbance for example a natural process in our case a flood or a phenomenon that violated this balance adaptability is the ability to change the structure in order to preservation of indicators of the state in the conditions of changes in the external environment at the same time this system has subsystems in fig 1 they are marked with the letters o f and t having studied the properties of which we can determine the properties of the gis itself emergence moreover a gis and all its subsystems despite changes in the external environment interacting with it must maintain integrity properties the considered gis is a complex technical object can be represented as a set of interacting subsystems o f t and it can be characterized by a set of states 1 a o f t the process of operation of such a gis will be accompanied by a change in its states over time as a result of the implementation of relations between its subsystems and the external environment for example during a flood situation for further analysis we can identify the reduced subsystems o f t with the sets of system states given that there are quite a lot of such states depending on the power m 1 m 2 m 3 of the reduced subsets o f t fuzzy clustering of such states can be applied according to the parameters of impact on the subject area obviously not all states or the corresponding clusters are included in the subset of allowed states for which it is possible to restore a stable state of the system by means of a chain of control actions moreover the determination of the states preceding the entry of the gis into one of the critical states is possible due to preventive analytics or forecasting or their modeling we are talking about the study of sequences chains of allowed states of the system leading to critical states causing a violation of the stability of the gis including the states of the gis which can be characterized as new functions and properties of the gis we can talk about the behavior of gis thus set a will consist of subsets b allowed states and c critical states the task of transferring projecting or mapping a part of the states of set c to set b is very relevant this set of mappings can be classified into a subset of simple ones algorithmizable for example by linear programming methods or converter systems and complex ones not amenable to algorithmization based on this the states of the system set c are of great interest the mappings of which in b can be implemented by expert systems including using artificial intelligence systems machine learning and neural networks in this case chains of mappings can be built eventually leading to an allowed state included in b note that in this case potentially possible predictable states or chains of states can be identified leading to exceptional states that do not have a solution in b proceeding from this each of the subsystems shown in fig 1 is characterized by a set of states which can be taken as measurements independent vectors further decomposition of such subsystems leads to some multidimensional space and independent vectors can be taken as the basis of the considered multidimensional space for various fields including hydrology thus the general mathematical model of gis fig 1 is represented by a set of spaces i with measurements entered into them according to the regulatory framework of each subsystem we have that any point d 1 d n d n d i i i together with the measure m 1 m k m k m i i i determine the scheme of each multidimensional space r i d i m i i i it is also obvious that for any point a d i there is a relation projection r a and any point of this projection will simultaneously be the value of the measurement a r a a a l l then the formula space r i a d i r a a l l i i can be taken as a mathematical model of our multidimensional space see section 2 on the basis of the given set of measurements a conclusion suggests itself about the possibility of considering the results of management using the example of a flood situation in a multidimensional space through a sequential analysis for each subspace the obtained independent results can be aggregated by any measurements based on previously specified data for any area in our case for hydrology further it opens up the possibility of establishing new relationships between existing data and new aggregated ones which will form chains of gis states and ultimately leads to a new multidimensional model that takes into account new dimensions thus we smoothly come to multidimensional information objects and an example of systems containing multidimensional information objects are geographic information systems with appropriate content from traditional databases with geographically organized information artificial neural networks depending on their generation are representative data management models that have been successfully used for decades in predicting various processes and critical situations including floods at the same time early accurate and reliable forecasts of critical situations including floods are necessary both for the correct operation of various reservoirs and for the evacuation of residents of flooded and flooded areas various methods have become widespread in forecasting water levels usually subdivided into conceptual models physically based models and black box driven data models for the first two categories it is necessary to know the physical process of the water level rise on water resources which lies at the foundation of the problem itself and is described using any simplified relations for example various statistical calculation methods he et al 2019 luo et al 2019 supriya et al 2015 or partial differential equations numerical methods hu et al 2019 silvestro et al 2019 it is important to note that the first two methods are aimed at short term forecasting 1 day maximum 2 days as for the third category black box models this includes machine learning including the use of artificial intelligence neural networks these models are often used for short term forecasting from 1 h to 1 day but there is also the possibility of their modification for the advance calculation of forecast values machine learning methods can also be used within various hybrid approaches for example combining various statistical machine learning models and time series analysis methodologies fotovatikhah et al 2018 liu et al 2021 mosavi et al 2018 phan and nguyen 2020 taormina and chau 2015 hybrid approaches can take advantage of each approach separately including component models of these approaches to achieve increased accuracy and flexibility the ability to change the forecast for several days in forecasting water levels and flood zones as a result such models show fairly accurate results in short term forecasting but are resource intensive in terms of time indicators calculation time and are often not suitable for early forecasting for example in zhou et al 2022 a hybrid approach xaj mcqrnn xinanjiang monotone composite quantile regression neural network to flood forecasting is considered the novelty of the study lies in the integration of conceptual xaj xinanjiang conceptual model and innovative mcqrnn models to predict every 3 h fpd flood probability density for the example of the jianxi river basin in china in kurian et al 2020 cicily kurian et al for forecasting up to 1 day the flood situation proposed a hybrid ann structure based on a distributed hydrological model using physical data but despite the fact that the tools under consideration relate to machine learning these models are qualitatively suitable only for short term forecasting as part of the use of artificial intelligence methods including neural networks as a rule both models of simple for example multilayer perceptron mlp ahmed et al 2021 hussain et al 2021 lin et al 2020 motta et al 2021 munawar et al 2021 nur adli zakaria et al 2021 zhou et al 2020 and complex structural neural network solutions for example long short term memory lstm alizadeh 2021 ding 2020 fang 2021 fu 2020 kao 2020 nguyen and bae 2020 zuo 2020 wavelet neural networks wnn chen et al 2021 kasiviswanathan 2016 convolutional neural networks cnn barzegar et al 2021 li 2022 tiwari et al 2021 and models including neural networks using a large number of statistical methods e g autoregressive integrated moving average model arma arima kabir 2020 khan et al 2020 wagena et al 2020 adaptive neuro fuzzy inference system anfis adikari 2021 arora 2021 ebtehaj 2021 nonlinear autoregressive network with exogenous inputs narx banihabib et al 2017 bukhari 2020 hadid et al 2020 lee 2020 wunsch et al 2018 for example in zhou et al 2019 yanlai zhou et al developed a fundamentally new anfis artificial neural network model for predicting flood situations for short periods 2 days the novelty lies in a fundamentally new learning algorithm that combines the genetic algorithm and the least squares method in xi 2020 xi chen et al used sa lstm self attentive long short term memory modified classical lstm to predict the flood situation for 7 days in edom 2022 edom moges et al analyzed the information flow in formulating water discharge forecast models using the example of an arid watershed dominated by snow the study showed that in case of early forecasting of a flood situation classical neural network models without a specialized modification for example a learning method are able to calculate predictive values but the accuracy of the forecasts themselves casts doubt on the appropriateness of using these models it is important to note that the main difficulty in forecasting a flood situation is a sharp increase in the water level in a short period of time often within 1 day the reasons for the sharp rise in water levels are heavy rains melting of snow cover and relief the first two parameters are taken into account by our neural network model which has a positive effect on the accuracy of the predicted values the relief is planned to be taken into account in future studies as the necessary data become available thus the above studies have shown that most of the forecasting models of all three categories conceptual physically based models and black box driven data models are quite effective in short term and early forecasting the issue of efficiency remains open and greater predictive accuracy the main advantages of choosing a neural network for early forecasting are the speed efficiency of calculating water level forecast values low resource consumption for calculations i e it is not necessary to have a very powerful server available and forecasting accuracy relative to most other methods for example some hydrological methods shakirzanova and dokus 2022 for forecasting water levels will be more accurate but the time required for calculating water level forecasting is not acceptable since calculations can be made up to several days in the case of software implementation up to one day if we take statistical methods in particular regression calculations of forecast values of water levels ndraha and hsiao 2022 or the least squares method palchevsky et al 2020 then they lose to artificial intelligence methods in terms of accuracy and calculation time the novelty of this study lies in the following 1 for the first time it is proposed to modify the backpropagation learning method by adding a learning rate coefficient to it when calculating predictive values 2 a new unparalleled multidimensional model has been created that takes into account measurements that make it possible to improve the accuracy of forecasting water levels by an artificial neural network at stationary hydrological posts in various critical situations 3 an approach has been developed to forecasting using data from stationary hydrological posts and hydrometeorological stations which makes it possible to predict floods not only in general terms but also pointwise no analogues have been found in the literature including the authors publications 2 models and methods 2 1 multidimensional space the multidimensional space of our subject area hydrology obtained in section 1 is determined by a set of objects and relations between objects which can also be represented by a set of functions thus our control problem is defined in the above described space of a sufficiently large dimension by a set of functions fi then one can define the surface of this space for example as the set of solutions of the system fi 0 this surface can be represented as a coating with many smaller pieces objects these surfaces must have a number of properties 1 they must intersect so that there is a common border 2 in each such surface some metric must be introduced a coordinate system 3 as a result at the point of intersection gluing these metrics intersect accordingly there should be a set of rules for mapping one metric to others adjacent to it those the metrics of different objects are consistent called the tensor law the abstract variety of objects obtained in this way can be represented as a surface in a space of a sufficiently large dimension the dimension is determined since there is a cartesian product as a result at each point on the surface in this case a matrix appears the components of which are products of basis vectors such a manifold is called an abstract riemannian manifold by whitney s theorem we obtain that any manifold with an induced riemannian metric is an abstract riemannian manifold the converse was proved by john nash nash 1956 for any abstract riemannian manifold a space in our case there exists a suitable realization of this manifold inside this space but due to the fact that our space is represented by information objects that are combined on the basis of semantic rules of interaction relations we can conclude that the set of relations between objects is complete on the basis of which the set of solutions fi 0 will be the solution to the problem those our construction is possible and the solution is reduced to the system of equations fi 0 and the properties not taken into account in the model of the subject area can be represented as a separate subject area characterized by these unaccounted properties i e treat it like an environment thus each subject area interacts with the environment and can be considered distributed let w be the studied subject area of hydrological objects w w 1 w n as mentioned earlier all states of the information system are included in a certain finite set of possible states returning to our subject area hydrology we introduce the designation of the state function of the first object based on the difference from the second f i w w i this function determines only a possible state and is not a function in the mathematical sense we can write down the dependence w i 1 f i w w i which defines fuzzy connections between meta objects the domain model is defined by a view function and a family of modeling functions let s be a model of the object domain of objects f m w s according to the modeling function f m we will assign a model r i f i m w i to each object of the subject area that is each object w i w corresponds to a model r i s in this case there must be a function f i r r i кoтopaя which uniquely determines r i 1 based on r i according to the formula r i 1 f i r r i continuing the chain of reasoning we find that r i 1 is determined by the chain w i 1 f i w w i and r i 1 f i 1 m w i 1 having made the appropriate substitutions we obtain r i 1 f i 1 m f i w w i his chain is not unique so the existence of the chain r i f i m w i and r i 1 f i r r i is obvious having made the appropriate substitutions we obtain r i 1 f i r f i m w i comparing the results we can conclude that regardless of the order in which the sequence of operations and mappings are performed the result will be the same that is for any value i we obtain a homomorphism for f i w and f i r the table of variables that are used to describe the objects of the subject area is usually present in an implicit form i e in the form of a set of characteristics of objects of a given area hydrology and does not correspond to any specific object of the subject area to obtain a model of a particular object based on this table it is filled with some specific values we can conclude that each stage of the formation of the semantic model of the subject area is determined by the formalization of the logical relations fixed in the description the description of the subject area is represented on the basis of a table of variables in the form of a multidimensional cube with dimensions corresponding to one of the variables this cube will be redundant because not all objects are present or exist which are described in the specified way on the basis of a set of variables chosen to describe the objects of the subject area the restrictions imposed on these objects are described in a similar way all this can be represented by a system of equations kulikov 2019 kulikov 2020 formalizing the domain model moreover in connection with the supposed distribution of objects there is also an intersection of the sets of their semantic properties based on the above analysis we can divide the structure of the developed system into information objects neural network or a subsystem based on the dss decision support system neural network describe all their dss relations for territory management which will act as interaction interfaces as a result we ensure the completeness of the set of considered relations between the objects of the system that determine its behavior at the same time any information interaction between complex systems subsystems is characterized by an ordered three level structure of interaction the physical level the syntactic level and the semantic level due to the fact that the designed system is divided into information objects which are combined on the basis of semantic rules of interaction we can conclude that the set of relations between the system objects that determine its behavior and on the basis of which the functional reliability analysis is performed is relatively complete thus the relations between the objects of the system can be classified based on the mathematical rules of clear and fuzzy logic which will increase the number of considered parameters supplied to the input of the neural network using multidimensional space as a result improve the accuracy of predictive values of water levels at stationary hydrological stations and automatic stations 2 2 mathematical model of a neural network one of the main factors influencing the state of the territory management gis is the flood which is expressed in the rise in the values of h water levels in water bodies as an example we can take stationary hydrological posts of the republic of bashkortostan the supervising organization responsible for monitoring and forecasting water levels is the state committee of the republic of bashkortostan for emergency situations in this regard we introduce the notation h ji k is the value of the water level measured at the k th gauging station on the i th date of the j th year here k 1 n where n is the number of gauging stations involved in the calculations j is the number of the year i is the specific measurement date he task of early forecasting is it should be noted that the problem of short term forecasting for 1 day was solved in palchevsky 2020 and on the basis of the method proposed in palchevsky et al 2020 forecasting for 2 5 days was performed in that in a specific current i th day of measurement calculate the value of the water level on day i 2 i e h ji 2 k as well as on i 3 h ji 3 k i 4 h ji 4 k and i 5 h ji 5 k for any k 1 n to solve this problem it is proposed to use the results of previous measurements of water levels an array of large retrospective data at all stationary hydrological posts located in the territory under consideration for all previous years the proposed early forecasting method is based on the use of an artificial neural network fig 2 implemented using the freely distributed tensorflow machine learning software library tensorflow the settings of which are presented below the method palchevsky et al 2020 for training ann backpropagation error backpropagation modified by the authors of the article is integrated into this neural network through the api application programming interface as shown by the results of the experiment presented in section 3 the accuracy and time of forecast calculation prove the feasibility of using this method in the framework of early forecasting of water levels at stationary hydrological stations thus the forecasting process is proposed to be carried out in three stages fig 3 data preprocessing the formation of a predictive model and data postprocessing partially this method was used as part of the detection and neutralization of cyber threats palchevsky and khristodulo 2019 at the same time it is important to note that the prediction of water levels h ji 5 k is due to the accuracy of the calculations of the implemented neural network model the value of 5 days was selected not only on the basis of theoretical results but also experimentally for example in senlin 2020 yizi 2019 when forecasting for 4 or more days there are significant discrepancies between the real actual and predicted values of water levels our neural network model allows us to give fairly accurate forecasts for 5 days tested experimentally in section 3 which allows specialized units of the ministry of emergency situations to use these forecast data for the evacuation of residents and entire enterprises of the republic of bashkortostan at the first stage which is performed as a rule before the development of a flood situation the choice of ann parameters is carried out the total number of neurons 107 the number of neurons in the input h jik k 5 и and output h jil k 5 layers the number of intermediate layers 3 and neurons in them h jk k 96 the activation function on the intermediate layers is sigmoid while the linear activation function is used on the output layer due to its weighted sum on each neuron of the output layer palchevsky et al 2020 the amount of data on samples training train 60 validation validation 20 and verification test 20 number of epochs 200 learning rate α 0 90 selected experimentally with further training of the artificial neural network the choice of the above ann parameters was based on their experimental practical selection due to the best accuracy in issuing predictive values of water levels a more detailed comparison is presented in section 3 1 due to the fact that the backpropagation method is taken as the basis for ann training it is necessary to normalize the input values of water levels h to prevent disappearing and exploding gradients 2 h ji k h ji k h min h max h min where h max and h min are the minimum and maximum values of water levels for all data supplied to the input layer of the neural network for all h ji k where k 1 n to train the neural network fig 4 the method of error back propagation modified by the authors of the article is used the essence of the change lies in the application of an experimentally set parameter coefficient of the learning rate of the neural network calculation of the squared error as a rule the network inputs are considered as an input vector h ji k where h ji k h j i 1 k h j i 2 k h jik k and the network outputs can be represented as an output vector h ji k where h ji k h j i 1 k h j i 2 k h jil k while k 1 m and l 1 n in which m and n are the number of values of the input and output vectors accordingly the training sample is a set of pairs r input vectors h jik k and desired reference output vectors h jil k 3 r h j i 1 k h j i 1 k h j i 2 k h j i 2 k h jik k h jil k each time h jik k is applied from r to the neural network the actual output h jil k of the output layer 4 will be calculated 4 h jil k f σ l where σ is the activation function determined by the relation 5 σ h jik k 1 1 e h jik k and being the weighted sum of outputs of neuron j in each intermediate layer hj 6 σ l j 1 j w j k j h j k j where w is the synapse weight k is the k th neuron in the intermediate layer based on this we can determine the squared error for each pair of vectors of the set r by summing the squared errors in each output neuron 7 e l 1 2 k 1 l h ji k k k h ji l k k 2 and as a consequence the total squared error e by summing all pairs of inputs and outputs in the training sample 8 e 1 2 l 1 k k 1 l h ji k k l k h ji l k l k 2 thus the goal of learning is to minimize e by finding an appropriate set of weights w xk 1 and w jk l where l varies from 1 to 4 determination of partial derivatives with respect to the weights of synapses based on relation 7 we can note that 9 de d w jk l h jik k h jil k in this case relying on 6 we obtain 10 d σ k d w jk l h j based on 9 we determine the partial derivative e with respect to the weight w jk to perform gradient descent in 11 for the weights of synapses between the intermediate and output layers 11 de d w jk l h jik k h jil k h jil k σ h jik k h jil k h jk moreover if we consider a particular case of the derivative e between the input and intermediate layers then it is worth highlighting separately that in this case all outputs depend on wxk thus the partial derivative will be as follows 12 de d w xk 1 k 1 l h ji k k k h jil k k h jil k k σ h jik k h jil k k w j k l h j k 1 h j k h jik k thus equations 9 and 10 give all the necessary de dw values for applying 11 and 12 within the framework of gradient descent for all neural network weights changing the weights of synapses each weight will be changed to dw to decrease e 13 w t 1 w t δ w t where δ w t de dw t w t is the synapse weight at time t w t 1 is the modified updated synapse weight and to increase the learning rate of the neural network the previously indicated parameter α is added 14 δ w t de dw t α δ w t 1 at the second stage the forecast model is directly formed and at the third stage the forecast of water level values is performed but since all the values were previously normalized h ji k 0 1 then for their further use in the framework of anti flood measures it is necessary to denormalize h ji l k according to the relation inverse to 2 15 h ji k h ji k h max h min h min 3 analysis of the effectiveness of the proposed method in the framework of predicting the levels of water rise to analyze the effectiveness of the proposed method for predicting water levels we used long term data from measurements of water levels at hydrological stations provided by the bashkir department for hydrometeorology and environmental monitoring bashhydromet from 01 01 2000 to 01 05 2021 for the state committee of the republic of bashkortostan for emergencies in the following form database fig 5 code of the stationary hydrological post automatic station date water level at the stationary hydrological post automatic station atmospheric pressure wind speed snow cover thickness amount of precipitation time and air temperature in the republic of bashkortostan bashhydromet is the only reliable source of information on the above data it is important to note that only the combined use of the above data parameters gives the most accurate forecast values of water levels palchevsky et al 2020 during the experiment many iterations were carried out over the entire period of long term observations from 01 01 2000 to 06 05 2021 to calculate the predicted values of water levels the total array of data used in the experiment is 1 025 815 values of which 60 are long term observational data from 01 01 2000 to 31 12 2013 fed to the training set of the neural network to the test set 20 01 01 2013 31 12 2017 and for the verification one 20 01 01 2018 06 05 2021 while the forecasting depth on the basis of which the predicted value is calculated is set experimentally depending on the stationary hydrological post the article as an example presents the results of an experiment forecasting water levels in the stationary hydrological city of ufa 76289 belaya river during the spring flood of 2021 in the republic of bashkortostan the first stage consisted in comparing the actual and predicted values of water levels at hydrological stations in different periods of the flood the results are shown in table 1 where the actual water level is the actual measured value at the stationary hydrological post and automatic station and the predicted water level is the water level value obtained using the neural network it is important to note that a comparison with other forecasting methods fig 2 was made in palchevsky 2020 according to which neural network forecasting showed a better result the output values turned out to be more accurate than when calculating the forecast values of water levels by other methods every day since the start of monitoring the development of the flood situation in 2021 this is 07 04 2021 the forecast was made for 1 5 days respectively the date of the beginning of the water level during the spring flood can be considered 12 04 2021 that is i 1 using a neural network a forecast was made for the next m for example 1 5 days for 1 gauging station that is n 1 this value of n was taken to reduce the time of the experiment the next day the actual value of water levels was measured at the same posts h j i m k carrying out forecasting daily until 01 05 2021 correspondingly we introduce an additional designation l the number of flood days that is the value l k i m 25 we get 25 forecasts and actual values of water levels for each of n posts for each post which makes it possible to determine the average accuracy of the forecast by to each k th post 16 e cp k 1 l k i m i 1 l k i m e h ji k h j i m k in this case the error e in centimeters on the i th day of the j th year of each k th gauging station is calculated by the ratio of the absolute difference 17 e ji k h ji k h j i m k an important difference between the proposed method for forecasting water levels using an artificial neural network compared to other known methods is the speed of obtaining a forecast and its correctness more accurate with advance forecasting in this case 5 days the results are shown in fig 6 according to table 1 and fig 5 it can be seen that the artificial neural network gives fairly accurate results the average error table 1 does not exceed 55 68 cm for the entire flood period it is important to note that the mean error in centimeters tables 1 8 is the single best measure of model accuracy for the following reasons units of measurement of water levels at stationary hydrological posts and automatic posts are centimeters specialized services including subdivisions of the ministry of emergency situations work with data on water levels which are presented in the form of centimeters in accordance with the state generally accepted standard at the same time an important difference between the proposed artificial neural network model with a modified learning method with backpropagation of errors is the practical accuracy in calculating the predicted values of water levels which is presented in tables 2 6 and fig 7 due to the fact that the forecast is focused on 5 days the experiment on comparative analysis of neural network models was carried out separately for forecasts for each day all models are based on tensorflow the settings are identical to the ann implemented by the authors of the article with the exception of a single layer perceptron and were tested using the backpropagation learning method on the data used for the calculations in table 1 in the above tables 2 6 and fig 7 research data the average errors were calculated table 6 the results of which show that the neural network model of the authors of the article shows the most accurate result 55 56 cm when predicting water levels at stationary hydrological posts and automatic stations this is due to the modified learning method and the peculiarity of the model in other models as a rule a large number of synaptic connections with the exception of a single layer perceptron and other components for example recursions are used which complicate the calculation and give a less accurate result at the same time on the basis of this artificial neural network a subsystem of the geographic information system fig 1 flood forecasting system was implemented with the following functionality viewing all hydrological posts of the republic of bashkortostan with a further transition to the forecasting page for this gauging station figs 8 9 and modeling flood zones fig 10 forecasting water levels with the possibility of adding data and retraining an artificial neural network as well as generating a specialized report fig 11 thus the implemented artificial neural network by the authors of the article showed a more accurate and stable result which proves the feasibility of using the proposed solution in the framework of forecasting and further prevention or minimization of special exceptional situations using the example of early forecasting of water levels during a flood situation 3 1 selection of parameters for training an artificial neural network of the second generation the parameters for training the developed artificial neural network were selected experimentally there are two main reasons for this approach the lack of specialized methods for choosing the training parameters of the second generation ann and the modification by the authors of the article of the method of training the backpropagation of the error at the same time for a pulsed neural network the third generation of ann the authors of the article implemented a universal method for selecting parameters for all types and types of ann training palchevsky 2022 in further studies this method is planned to be applied to second generation anns including flood forecasting in this case the ann parameters are as follows total number of neurons 107 number of neurons in the input layer 6 depends on the number of values on the basis of which we will make a forecast number of neurons in the output layer 5 depends on the number of days for which we will predict water levels number of intermediate layers 3 number of neurons in intermediate layers 96 activation function on the input layer sigmoidal activation function on intermediate layers sigmoidal activation function on the output layer linear amount of data on samples training train 60 validation validation 20 and verification test 20 number of epochs during training 200 learning rate α 0 90 at the same time the current parameters of the ann were compared with other parameters 1 configuration parameters of ann no 1 total number of neurons from 10 to 106 number of neurons in the input layer from 1 to 15 number of neurons in the output layer 5 number of intermediate layers from 1 to 10 number of neurons in intermediate layers from 3 to 100 activation function on the input and intermediate layers sigmoid and on the output linear the amount of data on samples training train 20 60 validation validation 5 20 and verification test 5 20 number of epochs during training 30 20000 learning rate α 0 01 0 99 2 configuration parameters of ann no 2 total number of neurons from 108 to 500 number of neurons in the input layer from 1 to 15 number of neurons in the output layer 5 number of intermediate layers from 1 to 10 number of neurons in intermediate layers from 3 to 400 number of neurons in the output layer 5 activation function on the input and intermediate layers sigmoid and on the output linear the amount of data on samples training train 20 60 validation validation 5 20 and verification test 5 20 number of epochs during training 30 20000 learning rate α 0 01 0 99 3 configuration parameters no 3 current parameters of the authors of the article the results table 7 show the mean values of the errors in the forecast values of water levels calculated using formulas 16 17 thus based on the results presented in table 7 the selected parameters of the artificial neural network form the most accurate ann model for calculating the predicted values of water levels 3 2 comparative analysis of second generation artificial neural network training methods for flood forecasting during the experiments in section 3 the method of error back propagation was chosen and modified which is shown in section 2 2 the main reasons for choosing this learning method are ease of implementation and the ability to modify for various tasks using the api in the tensorflow machine learning library thanks to the possibility of modification adding a learning rate factor 14 and the introduction of data normalization 2 and 15 the learning rate and local convergence were improved by eliminating vanishing and exploding gradients at the same time an experimental comparison was made with other basic and common methods for training anns of the second generation the elastic propagation method resilient propagation rprop bailey 2015 the genetic algorithm genetic algorithm ga takahashi et al 2014 the conjugate gradient method wang 2018 the kohonen learning method carlos 2013 and the levenberg marquardt method ozyildirim and kiran 2021 all these training methods are adapted for forecasting water levels at stationary hydrological posts and automatic stations the results table 8 show the mean values of the errors in the forecast values of water levels calculated by formulas 16 17 thus based on the results table 8 of the experiment on the comparative analysis of the second generation ann training methods the training method proposed by the authors of the article is the most accurate average error is 55 56 cm for predicting the values of water levels at stationary hydrological posts and automatic stations 4 discussion according to table 1 and fig 6 it can be seen that the artificial neural network gives fairly accurate results the average error does not exceed 55 68 cm for the entire flood period thus the implemented artificial neural network showed a more accurate and stable result which proves the feasibility of using the proposed solution in the framework of forecasting and further prevention or minimization of special exceptional situations using the example of predicting water levels in advance during a flood this will allow the special response services to respond in time to the special situation under consideration in order to prevent the development of a critical situation in the area under consideration at the same time an additional study was conducted comparison tables 2 6 fig 7 with other models of neural networks showing the advantage of the artificial neural network developed by the authors in terms of the accuracy of calculating predictive values this analysis also proves the feasibility of using this neural network not only for scientific but also for practical purposes in 2021 the developed ann was used to predict the values of water levels in bashhydromet and the state committee of the republic of bashkortostan for emergencies the study also included two additional comparative analyses selection of artificial neural network configuration parameters section 3 1 comparison section 3 2 of the proposed training method section 2 2 of the second generation neural network with other ann training methods the results of the experiments showed that the proposed modified backpropagation learning method and the second generation artificial neural network most accurately calculate the predicted values of water levels at stationary hydrological stations thus the experiments carried out in this study and the resulting predictive values of water levels proved that the solution proposed by the authors is effective in predicting the flood situation further research will be aimed at improving the accuracy and speed of calculating the forecast values of levels not only in the republic of bashkortostan but also in other regions of the russian federation and other countries 5 conclusions in this study the developed model of an artificial neural network using multidimensional space and the approach necessary for more point forecasting of the flood situation were evaluated the analysis of the effectiveness based on the proposed system showed that the use of an artificial neural network gave more stable results the average error does not exceed 55 68 cm for the entire flood period the average error between real and calculated values does not exceed 2 10 compared to existing common methods systems the average error between the real and calculated values of which is 8 36 when predicting the values of water levels using the example of a spring flood in the republic of bashkortostan which gives the necessary time up to 5 days inclusive for special services to implement anti flood measures to prepare for the protection of technical objects comparison of the anns of the authors with other models of neural networks single layer perceptron 98 49 cm multilayer perceptron 71 25 cm convolutional ann 58 30 cm and classical recurrent ann 78 68 cm showed that the proposed ins predicts more accurately the average error does not exceed 55 68 cm which proves the effectiveness of its use in calculating the forecast values of water levels at stationary hydrological posts and automatic stations taking into account that in the described multidimensional model and multidimensional space individual flood monitoring subsystems can be defined as information object schemes as independent business processes and that the model is built in the form of objects each flood situation monitoring subsystem can be considered as a separate isolated part of the territory management information system any information interaction between complex systems is implemented sequentially at the physical syntactic and semantic levels of interaction considering that our system is divided into information objects united according to the semantic rules of interaction it is possible to declare the relative completeness of the set of considered relationships between the system elements that determine its behavior and are the subject of functional reliability analysis thus the relations between the interacting subsystems of the territorial control system can be classified on the basis of the mathematical rules of clear and fuzzy logics the proposed method allows step by step highlighting the objects of the subject area establishing relationships based on semantically defined attributes building a model of the subject area reducing the uncertainty of knowledge at each stage the concept of building such a system actually reflects the modern strategy of the so called cals technologies and can be considered as a tool for improving efficiency and quality as it fully complies with the spirit and principles of international standards of the iso 9000 series thus the calculated forecasts of water levels with a lead time of several days can be especially useful for warning about flood situations and taking timely measures to prevent special including critical situations in the future these studies are planned to be carried out using the influence on the calculation of forecast values of water levels of such parameters as precipitation forecast forecast of snow cover thickness forecasts of air temperature and water level of reservoirs of the republic of bashkortostan also at the moment the limitation of the proposed solution is the impossibility of obtaining accurate predictive values of water levels for 6 or more days it is planned to expand the possibility of early forecasting of water levels up to 10 days with further mathematical and practical modification of the current ann training method if the experiment is successful our neural network model including the entire subsystem will require further applicability assessment using the example of other regions of the russian federation and other countries in general in addition further research will help improve the accuracy and reliability of our artificial neural network model and the subsystem as a whole in calculating the forecast values of water levels as well as improve the approach to early flood forecasting 6 patents based on the results of this work a patent was obtained in the form of an official certificate of state registration of a computer program no 2 020 611 923 rospatent author contributions e p has developed software and mathematical apparatus of an artificial neural network and designed the manuscript v a r e and t b wrote a manuscript with an overview of existing solutions funding the research is carried out with the financial support of the ministry of education and science of the russian federation as part of the basic part of the state task for higher education institutions feue 2020 0007 institutional review board statement not applicable informed consent statement not applicable data availability statement data for analysis and forecasting are provided by the bashkir hydrometeorological center privately there is no data in the public domain declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2597,currently specialized system models implemented on the basis of decision support in exceptional emergency situations states using machine learning artificial intelligence including using neural networks to reproduce predict and prevent or minimize the risk of consequences in exceptional situations are useful and are becoming increasingly popular floods also fall under such exceptional situations and states on the basis of which the task of early forecasting of an exceptional situation arises using the example of rising water levels at stationary hydrological posts in order to prevent or minimize the risk the transition of the territory management system under consideration to an exceptional state emergency situation to solve this problem a decision support system is proposed for early prediction of water rise levels based on a neural network intelligent analysis of retrospective data code of a stationary hydrological post automatic station date water level at a stationary hydrological post automatic station atmospheric pressure wind speed snow cover thickness amount of precipitation time and air temperature in order to calculate the values of water levels for 5 days in advance the artificial neural network itself is based on the freely distributed tensorflow machine learning software library and a modified error backpropagation method is used as training the main difference of which is the addition of an artificial neural network ann learning rate increase factor a mathematical model of the subject area is constructed in the form of a multidimensional space and an integrated multidimensional data model a single integrated model describes the subject area quite fully and can be used as a single source of information which provides system information support defined as a set of distributed databases all this makes it possible to improve the accuracy of forecast values of water levels at stationary hydrological posts and automatic stations the main difficulty in early forecasting is a sharp rise in water levels over a short period of time usually 1 day for various reasons our neural network model takes this into account and allows us to give more accurate results the results of the analysis of the effectiveness of the method showed that the proposed decision support system is more accurate the average error does not exceed 55 68 cm for the entire flood period the average error between the real and calculated values in the framework of forecasting for 5 days does not exceed 2 10 compared to existing common methods systems 8 36 this will give the necessary time to special services to carry out anti flood measures to prepare for the protection of technical facilities of enterprises keywords forecasting intellectual analysis neural network analysis retrospective data data mining forecasting water levels data availability the authors do not have permission to share data 1 introduction at present due to the emergence of new various sources and technologies for obtaining and processing data on objects and systems including their locations fundamentally new conditions have been formed for better management of various hydrological processes for example floods and phenomena at the same time within the framework of managing such processes and phenomena a certain duality of the situation arises on the one hand existing models and methods for obtaining and processing data use rather large volumes of heterogeneous information the processing of which requires a fairly large time resource on the other hand there are limiting factors for example the time to make any management decisions based on the available data when these processes occur in our case a flood at the same time data especially as an external factor can directly influence decision making within the framework of various processes in our case hydrological and phenomena including natural ones as they contribute to threats to various integral systems for example urban settlements and subsystems districts of urban settlements based on this in order to make a quality management decision in case of such threats it is necessary to obtain data on ongoing processes and phenomena in advance the complexity of this problem is determined by a sufficiently large number of control parameters the vagueness of requirements and the variability of control goals on the part of various system users and participants in the control process the need to minimize the vulnerability of these systems in the presence of a large number of threats of various nature and complexity to solve this problem it is proposed to obtain information about a possible future phenomenon or process to predict in our case using the example of a flood the rise in water levels of water resources using a subsystem of a geographic information system for managing a territory implemented on the basis of a second generation artificial neural network consider this geographic information system gis for territory management fig 1 let s denote it as a which should have a number of system wide properties including the properties of stability adaptability and emergence in the context of the case under consideration the stability of a gis is understood as its certain ability to return to an equilibrium state after the impact of some external disturbance for example a natural process in our case a flood or a phenomenon that violated this balance adaptability is the ability to change the structure in order to preservation of indicators of the state in the conditions of changes in the external environment at the same time this system has subsystems in fig 1 they are marked with the letters o f and t having studied the properties of which we can determine the properties of the gis itself emergence moreover a gis and all its subsystems despite changes in the external environment interacting with it must maintain integrity properties the considered gis is a complex technical object can be represented as a set of interacting subsystems o f t and it can be characterized by a set of states 1 a o f t the process of operation of such a gis will be accompanied by a change in its states over time as a result of the implementation of relations between its subsystems and the external environment for example during a flood situation for further analysis we can identify the reduced subsystems o f t with the sets of system states given that there are quite a lot of such states depending on the power m 1 m 2 m 3 of the reduced subsets o f t fuzzy clustering of such states can be applied according to the parameters of impact on the subject area obviously not all states or the corresponding clusters are included in the subset of allowed states for which it is possible to restore a stable state of the system by means of a chain of control actions moreover the determination of the states preceding the entry of the gis into one of the critical states is possible due to preventive analytics or forecasting or their modeling we are talking about the study of sequences chains of allowed states of the system leading to critical states causing a violation of the stability of the gis including the states of the gis which can be characterized as new functions and properties of the gis we can talk about the behavior of gis thus set a will consist of subsets b allowed states and c critical states the task of transferring projecting or mapping a part of the states of set c to set b is very relevant this set of mappings can be classified into a subset of simple ones algorithmizable for example by linear programming methods or converter systems and complex ones not amenable to algorithmization based on this the states of the system set c are of great interest the mappings of which in b can be implemented by expert systems including using artificial intelligence systems machine learning and neural networks in this case chains of mappings can be built eventually leading to an allowed state included in b note that in this case potentially possible predictable states or chains of states can be identified leading to exceptional states that do not have a solution in b proceeding from this each of the subsystems shown in fig 1 is characterized by a set of states which can be taken as measurements independent vectors further decomposition of such subsystems leads to some multidimensional space and independent vectors can be taken as the basis of the considered multidimensional space for various fields including hydrology thus the general mathematical model of gis fig 1 is represented by a set of spaces i with measurements entered into them according to the regulatory framework of each subsystem we have that any point d 1 d n d n d i i i together with the measure m 1 m k m k m i i i determine the scheme of each multidimensional space r i d i m i i i it is also obvious that for any point a d i there is a relation projection r a and any point of this projection will simultaneously be the value of the measurement a r a a a l l then the formula space r i a d i r a a l l i i can be taken as a mathematical model of our multidimensional space see section 2 on the basis of the given set of measurements a conclusion suggests itself about the possibility of considering the results of management using the example of a flood situation in a multidimensional space through a sequential analysis for each subspace the obtained independent results can be aggregated by any measurements based on previously specified data for any area in our case for hydrology further it opens up the possibility of establishing new relationships between existing data and new aggregated ones which will form chains of gis states and ultimately leads to a new multidimensional model that takes into account new dimensions thus we smoothly come to multidimensional information objects and an example of systems containing multidimensional information objects are geographic information systems with appropriate content from traditional databases with geographically organized information artificial neural networks depending on their generation are representative data management models that have been successfully used for decades in predicting various processes and critical situations including floods at the same time early accurate and reliable forecasts of critical situations including floods are necessary both for the correct operation of various reservoirs and for the evacuation of residents of flooded and flooded areas various methods have become widespread in forecasting water levels usually subdivided into conceptual models physically based models and black box driven data models for the first two categories it is necessary to know the physical process of the water level rise on water resources which lies at the foundation of the problem itself and is described using any simplified relations for example various statistical calculation methods he et al 2019 luo et al 2019 supriya et al 2015 or partial differential equations numerical methods hu et al 2019 silvestro et al 2019 it is important to note that the first two methods are aimed at short term forecasting 1 day maximum 2 days as for the third category black box models this includes machine learning including the use of artificial intelligence neural networks these models are often used for short term forecasting from 1 h to 1 day but there is also the possibility of their modification for the advance calculation of forecast values machine learning methods can also be used within various hybrid approaches for example combining various statistical machine learning models and time series analysis methodologies fotovatikhah et al 2018 liu et al 2021 mosavi et al 2018 phan and nguyen 2020 taormina and chau 2015 hybrid approaches can take advantage of each approach separately including component models of these approaches to achieve increased accuracy and flexibility the ability to change the forecast for several days in forecasting water levels and flood zones as a result such models show fairly accurate results in short term forecasting but are resource intensive in terms of time indicators calculation time and are often not suitable for early forecasting for example in zhou et al 2022 a hybrid approach xaj mcqrnn xinanjiang monotone composite quantile regression neural network to flood forecasting is considered the novelty of the study lies in the integration of conceptual xaj xinanjiang conceptual model and innovative mcqrnn models to predict every 3 h fpd flood probability density for the example of the jianxi river basin in china in kurian et al 2020 cicily kurian et al for forecasting up to 1 day the flood situation proposed a hybrid ann structure based on a distributed hydrological model using physical data but despite the fact that the tools under consideration relate to machine learning these models are qualitatively suitable only for short term forecasting as part of the use of artificial intelligence methods including neural networks as a rule both models of simple for example multilayer perceptron mlp ahmed et al 2021 hussain et al 2021 lin et al 2020 motta et al 2021 munawar et al 2021 nur adli zakaria et al 2021 zhou et al 2020 and complex structural neural network solutions for example long short term memory lstm alizadeh 2021 ding 2020 fang 2021 fu 2020 kao 2020 nguyen and bae 2020 zuo 2020 wavelet neural networks wnn chen et al 2021 kasiviswanathan 2016 convolutional neural networks cnn barzegar et al 2021 li 2022 tiwari et al 2021 and models including neural networks using a large number of statistical methods e g autoregressive integrated moving average model arma arima kabir 2020 khan et al 2020 wagena et al 2020 adaptive neuro fuzzy inference system anfis adikari 2021 arora 2021 ebtehaj 2021 nonlinear autoregressive network with exogenous inputs narx banihabib et al 2017 bukhari 2020 hadid et al 2020 lee 2020 wunsch et al 2018 for example in zhou et al 2019 yanlai zhou et al developed a fundamentally new anfis artificial neural network model for predicting flood situations for short periods 2 days the novelty lies in a fundamentally new learning algorithm that combines the genetic algorithm and the least squares method in xi 2020 xi chen et al used sa lstm self attentive long short term memory modified classical lstm to predict the flood situation for 7 days in edom 2022 edom moges et al analyzed the information flow in formulating water discharge forecast models using the example of an arid watershed dominated by snow the study showed that in case of early forecasting of a flood situation classical neural network models without a specialized modification for example a learning method are able to calculate predictive values but the accuracy of the forecasts themselves casts doubt on the appropriateness of using these models it is important to note that the main difficulty in forecasting a flood situation is a sharp increase in the water level in a short period of time often within 1 day the reasons for the sharp rise in water levels are heavy rains melting of snow cover and relief the first two parameters are taken into account by our neural network model which has a positive effect on the accuracy of the predicted values the relief is planned to be taken into account in future studies as the necessary data become available thus the above studies have shown that most of the forecasting models of all three categories conceptual physically based models and black box driven data models are quite effective in short term and early forecasting the issue of efficiency remains open and greater predictive accuracy the main advantages of choosing a neural network for early forecasting are the speed efficiency of calculating water level forecast values low resource consumption for calculations i e it is not necessary to have a very powerful server available and forecasting accuracy relative to most other methods for example some hydrological methods shakirzanova and dokus 2022 for forecasting water levels will be more accurate but the time required for calculating water level forecasting is not acceptable since calculations can be made up to several days in the case of software implementation up to one day if we take statistical methods in particular regression calculations of forecast values of water levels ndraha and hsiao 2022 or the least squares method palchevsky et al 2020 then they lose to artificial intelligence methods in terms of accuracy and calculation time the novelty of this study lies in the following 1 for the first time it is proposed to modify the backpropagation learning method by adding a learning rate coefficient to it when calculating predictive values 2 a new unparalleled multidimensional model has been created that takes into account measurements that make it possible to improve the accuracy of forecasting water levels by an artificial neural network at stationary hydrological posts in various critical situations 3 an approach has been developed to forecasting using data from stationary hydrological posts and hydrometeorological stations which makes it possible to predict floods not only in general terms but also pointwise no analogues have been found in the literature including the authors publications 2 models and methods 2 1 multidimensional space the multidimensional space of our subject area hydrology obtained in section 1 is determined by a set of objects and relations between objects which can also be represented by a set of functions thus our control problem is defined in the above described space of a sufficiently large dimension by a set of functions fi then one can define the surface of this space for example as the set of solutions of the system fi 0 this surface can be represented as a coating with many smaller pieces objects these surfaces must have a number of properties 1 they must intersect so that there is a common border 2 in each such surface some metric must be introduced a coordinate system 3 as a result at the point of intersection gluing these metrics intersect accordingly there should be a set of rules for mapping one metric to others adjacent to it those the metrics of different objects are consistent called the tensor law the abstract variety of objects obtained in this way can be represented as a surface in a space of a sufficiently large dimension the dimension is determined since there is a cartesian product as a result at each point on the surface in this case a matrix appears the components of which are products of basis vectors such a manifold is called an abstract riemannian manifold by whitney s theorem we obtain that any manifold with an induced riemannian metric is an abstract riemannian manifold the converse was proved by john nash nash 1956 for any abstract riemannian manifold a space in our case there exists a suitable realization of this manifold inside this space but due to the fact that our space is represented by information objects that are combined on the basis of semantic rules of interaction relations we can conclude that the set of relations between objects is complete on the basis of which the set of solutions fi 0 will be the solution to the problem those our construction is possible and the solution is reduced to the system of equations fi 0 and the properties not taken into account in the model of the subject area can be represented as a separate subject area characterized by these unaccounted properties i e treat it like an environment thus each subject area interacts with the environment and can be considered distributed let w be the studied subject area of hydrological objects w w 1 w n as mentioned earlier all states of the information system are included in a certain finite set of possible states returning to our subject area hydrology we introduce the designation of the state function of the first object based on the difference from the second f i w w i this function determines only a possible state and is not a function in the mathematical sense we can write down the dependence w i 1 f i w w i which defines fuzzy connections between meta objects the domain model is defined by a view function and a family of modeling functions let s be a model of the object domain of objects f m w s according to the modeling function f m we will assign a model r i f i m w i to each object of the subject area that is each object w i w corresponds to a model r i s in this case there must be a function f i r r i кoтopaя which uniquely determines r i 1 based on r i according to the formula r i 1 f i r r i continuing the chain of reasoning we find that r i 1 is determined by the chain w i 1 f i w w i and r i 1 f i 1 m w i 1 having made the appropriate substitutions we obtain r i 1 f i 1 m f i w w i his chain is not unique so the existence of the chain r i f i m w i and r i 1 f i r r i is obvious having made the appropriate substitutions we obtain r i 1 f i r f i m w i comparing the results we can conclude that regardless of the order in which the sequence of operations and mappings are performed the result will be the same that is for any value i we obtain a homomorphism for f i w and f i r the table of variables that are used to describe the objects of the subject area is usually present in an implicit form i e in the form of a set of characteristics of objects of a given area hydrology and does not correspond to any specific object of the subject area to obtain a model of a particular object based on this table it is filled with some specific values we can conclude that each stage of the formation of the semantic model of the subject area is determined by the formalization of the logical relations fixed in the description the description of the subject area is represented on the basis of a table of variables in the form of a multidimensional cube with dimensions corresponding to one of the variables this cube will be redundant because not all objects are present or exist which are described in the specified way on the basis of a set of variables chosen to describe the objects of the subject area the restrictions imposed on these objects are described in a similar way all this can be represented by a system of equations kulikov 2019 kulikov 2020 formalizing the domain model moreover in connection with the supposed distribution of objects there is also an intersection of the sets of their semantic properties based on the above analysis we can divide the structure of the developed system into information objects neural network or a subsystem based on the dss decision support system neural network describe all their dss relations for territory management which will act as interaction interfaces as a result we ensure the completeness of the set of considered relations between the objects of the system that determine its behavior at the same time any information interaction between complex systems subsystems is characterized by an ordered three level structure of interaction the physical level the syntactic level and the semantic level due to the fact that the designed system is divided into information objects which are combined on the basis of semantic rules of interaction we can conclude that the set of relations between the system objects that determine its behavior and on the basis of which the functional reliability analysis is performed is relatively complete thus the relations between the objects of the system can be classified based on the mathematical rules of clear and fuzzy logic which will increase the number of considered parameters supplied to the input of the neural network using multidimensional space as a result improve the accuracy of predictive values of water levels at stationary hydrological stations and automatic stations 2 2 mathematical model of a neural network one of the main factors influencing the state of the territory management gis is the flood which is expressed in the rise in the values of h water levels in water bodies as an example we can take stationary hydrological posts of the republic of bashkortostan the supervising organization responsible for monitoring and forecasting water levels is the state committee of the republic of bashkortostan for emergency situations in this regard we introduce the notation h ji k is the value of the water level measured at the k th gauging station on the i th date of the j th year here k 1 n where n is the number of gauging stations involved in the calculations j is the number of the year i is the specific measurement date he task of early forecasting is it should be noted that the problem of short term forecasting for 1 day was solved in palchevsky 2020 and on the basis of the method proposed in palchevsky et al 2020 forecasting for 2 5 days was performed in that in a specific current i th day of measurement calculate the value of the water level on day i 2 i e h ji 2 k as well as on i 3 h ji 3 k i 4 h ji 4 k and i 5 h ji 5 k for any k 1 n to solve this problem it is proposed to use the results of previous measurements of water levels an array of large retrospective data at all stationary hydrological posts located in the territory under consideration for all previous years the proposed early forecasting method is based on the use of an artificial neural network fig 2 implemented using the freely distributed tensorflow machine learning software library tensorflow the settings of which are presented below the method palchevsky et al 2020 for training ann backpropagation error backpropagation modified by the authors of the article is integrated into this neural network through the api application programming interface as shown by the results of the experiment presented in section 3 the accuracy and time of forecast calculation prove the feasibility of using this method in the framework of early forecasting of water levels at stationary hydrological stations thus the forecasting process is proposed to be carried out in three stages fig 3 data preprocessing the formation of a predictive model and data postprocessing partially this method was used as part of the detection and neutralization of cyber threats palchevsky and khristodulo 2019 at the same time it is important to note that the prediction of water levels h ji 5 k is due to the accuracy of the calculations of the implemented neural network model the value of 5 days was selected not only on the basis of theoretical results but also experimentally for example in senlin 2020 yizi 2019 when forecasting for 4 or more days there are significant discrepancies between the real actual and predicted values of water levels our neural network model allows us to give fairly accurate forecasts for 5 days tested experimentally in section 3 which allows specialized units of the ministry of emergency situations to use these forecast data for the evacuation of residents and entire enterprises of the republic of bashkortostan at the first stage which is performed as a rule before the development of a flood situation the choice of ann parameters is carried out the total number of neurons 107 the number of neurons in the input h jik k 5 и and output h jil k 5 layers the number of intermediate layers 3 and neurons in them h jk k 96 the activation function on the intermediate layers is sigmoid while the linear activation function is used on the output layer due to its weighted sum on each neuron of the output layer palchevsky et al 2020 the amount of data on samples training train 60 validation validation 20 and verification test 20 number of epochs 200 learning rate α 0 90 selected experimentally with further training of the artificial neural network the choice of the above ann parameters was based on their experimental practical selection due to the best accuracy in issuing predictive values of water levels a more detailed comparison is presented in section 3 1 due to the fact that the backpropagation method is taken as the basis for ann training it is necessary to normalize the input values of water levels h to prevent disappearing and exploding gradients 2 h ji k h ji k h min h max h min where h max and h min are the minimum and maximum values of water levels for all data supplied to the input layer of the neural network for all h ji k where k 1 n to train the neural network fig 4 the method of error back propagation modified by the authors of the article is used the essence of the change lies in the application of an experimentally set parameter coefficient of the learning rate of the neural network calculation of the squared error as a rule the network inputs are considered as an input vector h ji k where h ji k h j i 1 k h j i 2 k h jik k and the network outputs can be represented as an output vector h ji k where h ji k h j i 1 k h j i 2 k h jil k while k 1 m and l 1 n in which m and n are the number of values of the input and output vectors accordingly the training sample is a set of pairs r input vectors h jik k and desired reference output vectors h jil k 3 r h j i 1 k h j i 1 k h j i 2 k h j i 2 k h jik k h jil k each time h jik k is applied from r to the neural network the actual output h jil k of the output layer 4 will be calculated 4 h jil k f σ l where σ is the activation function determined by the relation 5 σ h jik k 1 1 e h jik k and being the weighted sum of outputs of neuron j in each intermediate layer hj 6 σ l j 1 j w j k j h j k j where w is the synapse weight k is the k th neuron in the intermediate layer based on this we can determine the squared error for each pair of vectors of the set r by summing the squared errors in each output neuron 7 e l 1 2 k 1 l h ji k k k h ji l k k 2 and as a consequence the total squared error e by summing all pairs of inputs and outputs in the training sample 8 e 1 2 l 1 k k 1 l h ji k k l k h ji l k l k 2 thus the goal of learning is to minimize e by finding an appropriate set of weights w xk 1 and w jk l where l varies from 1 to 4 determination of partial derivatives with respect to the weights of synapses based on relation 7 we can note that 9 de d w jk l h jik k h jil k in this case relying on 6 we obtain 10 d σ k d w jk l h j based on 9 we determine the partial derivative e with respect to the weight w jk to perform gradient descent in 11 for the weights of synapses between the intermediate and output layers 11 de d w jk l h jik k h jil k h jil k σ h jik k h jil k h jk moreover if we consider a particular case of the derivative e between the input and intermediate layers then it is worth highlighting separately that in this case all outputs depend on wxk thus the partial derivative will be as follows 12 de d w xk 1 k 1 l h ji k k k h jil k k h jil k k σ h jik k h jil k k w j k l h j k 1 h j k h jik k thus equations 9 and 10 give all the necessary de dw values for applying 11 and 12 within the framework of gradient descent for all neural network weights changing the weights of synapses each weight will be changed to dw to decrease e 13 w t 1 w t δ w t where δ w t de dw t w t is the synapse weight at time t w t 1 is the modified updated synapse weight and to increase the learning rate of the neural network the previously indicated parameter α is added 14 δ w t de dw t α δ w t 1 at the second stage the forecast model is directly formed and at the third stage the forecast of water level values is performed but since all the values were previously normalized h ji k 0 1 then for their further use in the framework of anti flood measures it is necessary to denormalize h ji l k according to the relation inverse to 2 15 h ji k h ji k h max h min h min 3 analysis of the effectiveness of the proposed method in the framework of predicting the levels of water rise to analyze the effectiveness of the proposed method for predicting water levels we used long term data from measurements of water levels at hydrological stations provided by the bashkir department for hydrometeorology and environmental monitoring bashhydromet from 01 01 2000 to 01 05 2021 for the state committee of the republic of bashkortostan for emergencies in the following form database fig 5 code of the stationary hydrological post automatic station date water level at the stationary hydrological post automatic station atmospheric pressure wind speed snow cover thickness amount of precipitation time and air temperature in the republic of bashkortostan bashhydromet is the only reliable source of information on the above data it is important to note that only the combined use of the above data parameters gives the most accurate forecast values of water levels palchevsky et al 2020 during the experiment many iterations were carried out over the entire period of long term observations from 01 01 2000 to 06 05 2021 to calculate the predicted values of water levels the total array of data used in the experiment is 1 025 815 values of which 60 are long term observational data from 01 01 2000 to 31 12 2013 fed to the training set of the neural network to the test set 20 01 01 2013 31 12 2017 and for the verification one 20 01 01 2018 06 05 2021 while the forecasting depth on the basis of which the predicted value is calculated is set experimentally depending on the stationary hydrological post the article as an example presents the results of an experiment forecasting water levels in the stationary hydrological city of ufa 76289 belaya river during the spring flood of 2021 in the republic of bashkortostan the first stage consisted in comparing the actual and predicted values of water levels at hydrological stations in different periods of the flood the results are shown in table 1 where the actual water level is the actual measured value at the stationary hydrological post and automatic station and the predicted water level is the water level value obtained using the neural network it is important to note that a comparison with other forecasting methods fig 2 was made in palchevsky 2020 according to which neural network forecasting showed a better result the output values turned out to be more accurate than when calculating the forecast values of water levels by other methods every day since the start of monitoring the development of the flood situation in 2021 this is 07 04 2021 the forecast was made for 1 5 days respectively the date of the beginning of the water level during the spring flood can be considered 12 04 2021 that is i 1 using a neural network a forecast was made for the next m for example 1 5 days for 1 gauging station that is n 1 this value of n was taken to reduce the time of the experiment the next day the actual value of water levels was measured at the same posts h j i m k carrying out forecasting daily until 01 05 2021 correspondingly we introduce an additional designation l the number of flood days that is the value l k i m 25 we get 25 forecasts and actual values of water levels for each of n posts for each post which makes it possible to determine the average accuracy of the forecast by to each k th post 16 e cp k 1 l k i m i 1 l k i m e h ji k h j i m k in this case the error e in centimeters on the i th day of the j th year of each k th gauging station is calculated by the ratio of the absolute difference 17 e ji k h ji k h j i m k an important difference between the proposed method for forecasting water levels using an artificial neural network compared to other known methods is the speed of obtaining a forecast and its correctness more accurate with advance forecasting in this case 5 days the results are shown in fig 6 according to table 1 and fig 5 it can be seen that the artificial neural network gives fairly accurate results the average error table 1 does not exceed 55 68 cm for the entire flood period it is important to note that the mean error in centimeters tables 1 8 is the single best measure of model accuracy for the following reasons units of measurement of water levels at stationary hydrological posts and automatic posts are centimeters specialized services including subdivisions of the ministry of emergency situations work with data on water levels which are presented in the form of centimeters in accordance with the state generally accepted standard at the same time an important difference between the proposed artificial neural network model with a modified learning method with backpropagation of errors is the practical accuracy in calculating the predicted values of water levels which is presented in tables 2 6 and fig 7 due to the fact that the forecast is focused on 5 days the experiment on comparative analysis of neural network models was carried out separately for forecasts for each day all models are based on tensorflow the settings are identical to the ann implemented by the authors of the article with the exception of a single layer perceptron and were tested using the backpropagation learning method on the data used for the calculations in table 1 in the above tables 2 6 and fig 7 research data the average errors were calculated table 6 the results of which show that the neural network model of the authors of the article shows the most accurate result 55 56 cm when predicting water levels at stationary hydrological posts and automatic stations this is due to the modified learning method and the peculiarity of the model in other models as a rule a large number of synaptic connections with the exception of a single layer perceptron and other components for example recursions are used which complicate the calculation and give a less accurate result at the same time on the basis of this artificial neural network a subsystem of the geographic information system fig 1 flood forecasting system was implemented with the following functionality viewing all hydrological posts of the republic of bashkortostan with a further transition to the forecasting page for this gauging station figs 8 9 and modeling flood zones fig 10 forecasting water levels with the possibility of adding data and retraining an artificial neural network as well as generating a specialized report fig 11 thus the implemented artificial neural network by the authors of the article showed a more accurate and stable result which proves the feasibility of using the proposed solution in the framework of forecasting and further prevention or minimization of special exceptional situations using the example of early forecasting of water levels during a flood situation 3 1 selection of parameters for training an artificial neural network of the second generation the parameters for training the developed artificial neural network were selected experimentally there are two main reasons for this approach the lack of specialized methods for choosing the training parameters of the second generation ann and the modification by the authors of the article of the method of training the backpropagation of the error at the same time for a pulsed neural network the third generation of ann the authors of the article implemented a universal method for selecting parameters for all types and types of ann training palchevsky 2022 in further studies this method is planned to be applied to second generation anns including flood forecasting in this case the ann parameters are as follows total number of neurons 107 number of neurons in the input layer 6 depends on the number of values on the basis of which we will make a forecast number of neurons in the output layer 5 depends on the number of days for which we will predict water levels number of intermediate layers 3 number of neurons in intermediate layers 96 activation function on the input layer sigmoidal activation function on intermediate layers sigmoidal activation function on the output layer linear amount of data on samples training train 60 validation validation 20 and verification test 20 number of epochs during training 200 learning rate α 0 90 at the same time the current parameters of the ann were compared with other parameters 1 configuration parameters of ann no 1 total number of neurons from 10 to 106 number of neurons in the input layer from 1 to 15 number of neurons in the output layer 5 number of intermediate layers from 1 to 10 number of neurons in intermediate layers from 3 to 100 activation function on the input and intermediate layers sigmoid and on the output linear the amount of data on samples training train 20 60 validation validation 5 20 and verification test 5 20 number of epochs during training 30 20000 learning rate α 0 01 0 99 2 configuration parameters of ann no 2 total number of neurons from 108 to 500 number of neurons in the input layer from 1 to 15 number of neurons in the output layer 5 number of intermediate layers from 1 to 10 number of neurons in intermediate layers from 3 to 400 number of neurons in the output layer 5 activation function on the input and intermediate layers sigmoid and on the output linear the amount of data on samples training train 20 60 validation validation 5 20 and verification test 5 20 number of epochs during training 30 20000 learning rate α 0 01 0 99 3 configuration parameters no 3 current parameters of the authors of the article the results table 7 show the mean values of the errors in the forecast values of water levels calculated using formulas 16 17 thus based on the results presented in table 7 the selected parameters of the artificial neural network form the most accurate ann model for calculating the predicted values of water levels 3 2 comparative analysis of second generation artificial neural network training methods for flood forecasting during the experiments in section 3 the method of error back propagation was chosen and modified which is shown in section 2 2 the main reasons for choosing this learning method are ease of implementation and the ability to modify for various tasks using the api in the tensorflow machine learning library thanks to the possibility of modification adding a learning rate factor 14 and the introduction of data normalization 2 and 15 the learning rate and local convergence were improved by eliminating vanishing and exploding gradients at the same time an experimental comparison was made with other basic and common methods for training anns of the second generation the elastic propagation method resilient propagation rprop bailey 2015 the genetic algorithm genetic algorithm ga takahashi et al 2014 the conjugate gradient method wang 2018 the kohonen learning method carlos 2013 and the levenberg marquardt method ozyildirim and kiran 2021 all these training methods are adapted for forecasting water levels at stationary hydrological posts and automatic stations the results table 8 show the mean values of the errors in the forecast values of water levels calculated by formulas 16 17 thus based on the results table 8 of the experiment on the comparative analysis of the second generation ann training methods the training method proposed by the authors of the article is the most accurate average error is 55 56 cm for predicting the values of water levels at stationary hydrological posts and automatic stations 4 discussion according to table 1 and fig 6 it can be seen that the artificial neural network gives fairly accurate results the average error does not exceed 55 68 cm for the entire flood period thus the implemented artificial neural network showed a more accurate and stable result which proves the feasibility of using the proposed solution in the framework of forecasting and further prevention or minimization of special exceptional situations using the example of predicting water levels in advance during a flood this will allow the special response services to respond in time to the special situation under consideration in order to prevent the development of a critical situation in the area under consideration at the same time an additional study was conducted comparison tables 2 6 fig 7 with other models of neural networks showing the advantage of the artificial neural network developed by the authors in terms of the accuracy of calculating predictive values this analysis also proves the feasibility of using this neural network not only for scientific but also for practical purposes in 2021 the developed ann was used to predict the values of water levels in bashhydromet and the state committee of the republic of bashkortostan for emergencies the study also included two additional comparative analyses selection of artificial neural network configuration parameters section 3 1 comparison section 3 2 of the proposed training method section 2 2 of the second generation neural network with other ann training methods the results of the experiments showed that the proposed modified backpropagation learning method and the second generation artificial neural network most accurately calculate the predicted values of water levels at stationary hydrological stations thus the experiments carried out in this study and the resulting predictive values of water levels proved that the solution proposed by the authors is effective in predicting the flood situation further research will be aimed at improving the accuracy and speed of calculating the forecast values of levels not only in the republic of bashkortostan but also in other regions of the russian federation and other countries 5 conclusions in this study the developed model of an artificial neural network using multidimensional space and the approach necessary for more point forecasting of the flood situation were evaluated the analysis of the effectiveness based on the proposed system showed that the use of an artificial neural network gave more stable results the average error does not exceed 55 68 cm for the entire flood period the average error between real and calculated values does not exceed 2 10 compared to existing common methods systems the average error between the real and calculated values of which is 8 36 when predicting the values of water levels using the example of a spring flood in the republic of bashkortostan which gives the necessary time up to 5 days inclusive for special services to implement anti flood measures to prepare for the protection of technical objects comparison of the anns of the authors with other models of neural networks single layer perceptron 98 49 cm multilayer perceptron 71 25 cm convolutional ann 58 30 cm and classical recurrent ann 78 68 cm showed that the proposed ins predicts more accurately the average error does not exceed 55 68 cm which proves the effectiveness of its use in calculating the forecast values of water levels at stationary hydrological posts and automatic stations taking into account that in the described multidimensional model and multidimensional space individual flood monitoring subsystems can be defined as information object schemes as independent business processes and that the model is built in the form of objects each flood situation monitoring subsystem can be considered as a separate isolated part of the territory management information system any information interaction between complex systems is implemented sequentially at the physical syntactic and semantic levels of interaction considering that our system is divided into information objects united according to the semantic rules of interaction it is possible to declare the relative completeness of the set of considered relationships between the system elements that determine its behavior and are the subject of functional reliability analysis thus the relations between the interacting subsystems of the territorial control system can be classified on the basis of the mathematical rules of clear and fuzzy logics the proposed method allows step by step highlighting the objects of the subject area establishing relationships based on semantically defined attributes building a model of the subject area reducing the uncertainty of knowledge at each stage the concept of building such a system actually reflects the modern strategy of the so called cals technologies and can be considered as a tool for improving efficiency and quality as it fully complies with the spirit and principles of international standards of the iso 9000 series thus the calculated forecasts of water levels with a lead time of several days can be especially useful for warning about flood situations and taking timely measures to prevent special including critical situations in the future these studies are planned to be carried out using the influence on the calculation of forecast values of water levels of such parameters as precipitation forecast forecast of snow cover thickness forecasts of air temperature and water level of reservoirs of the republic of bashkortostan also at the moment the limitation of the proposed solution is the impossibility of obtaining accurate predictive values of water levels for 6 or more days it is planned to expand the possibility of early forecasting of water levels up to 10 days with further mathematical and practical modification of the current ann training method if the experiment is successful our neural network model including the entire subsystem will require further applicability assessment using the example of other regions of the russian federation and other countries in general in addition further research will help improve the accuracy and reliability of our artificial neural network model and the subsystem as a whole in calculating the forecast values of water levels as well as improve the approach to early flood forecasting 6 patents based on the results of this work a patent was obtained in the form of an official certificate of state registration of a computer program no 2 020 611 923 rospatent author contributions e p has developed software and mathematical apparatus of an artificial neural network and designed the manuscript v a r e and t b wrote a manuscript with an overview of existing solutions funding the research is carried out with the financial support of the ministry of education and science of the russian federation as part of the basic part of the state task for higher education institutions feue 2020 0007 institutional review board statement not applicable informed consent statement not applicable data availability statement data for analysis and forecasting are provided by the bashkir hydrometeorological center privately there is no data in the public domain declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2598,the current study proposes a new method to downscale the monthly grace derived terrestrial water storage anomaly twsa to 10 km spatial resolution over iran using deep learning methods first the growing neural gas gng method is utilized to cluster the twsa data to find similar patterns the silhouette chou davies scd validity measure a combination of three robust cluster validity measures is used to evaluate the performance of the gng method then the feasibility of deep learning convolutional long short term memory convlstm shallow learning feed forward neural networks ffnn and random forest rf are examined in downscaling grace derived twsa using only remote sensing images the results indicate that the deep learning method outperforms the rf and ffnn models by 7 and 18 respectively then the ground water storage gws data are isolated from twsa showing an agreement between the grace derived gws and ground based measurements with r2 0 76 additionally the downscaled twsa is used to generate annual drought frequency and change detection maps for the gws from 2002 to 2016 annual standardized precipitation index spi drought frequency maps are also produced to gain deeper insight into the water resource scarcity of iran the results indicate that iran has experienced water resource overexploitation since 2011 for agricultural activities while meteorological drought is a trigger and intensifier for the water crisis in iran according to the results iran experienced exceptional drought in some regions and the gws has decreased all over the country in addition further analysis of iran s water resources is provided until 2022 the current study calls for integrated sustainable water resources management in iran otherwise irreversible water and environmental problems with higher frequencies will be expected in the near future keywords grace remote sensing deep learning convolutional long short term memory convlstm drought iran data availability data will be made available on request 1 introduction water resources are increasingly becoming a priority issue at the international level with a continued threat from climate change and anthropogenic activities hence sustainable water resources management needs further investigation especially in freshwater resources as the largest accessible freshwater source groundwater satisfies a significant portion of water demand engström et al 2020 droughts as one of the devastating disasters for water resources are harmful to groundwater as they intensify the depletion and diminish the recharge of groundwater resources groundwater storage may ultimately be affected by meteorological agricultural and hydrological droughts however an accurate assessment of groundwater storage and its dynamics is still challenging compared to surface hydrological components since groundwater storage is not visible abhishek kinouchi 2022 therefore continuous groundwater observations are essential for adequate monitoring and surveying groundwater availability and potential trends unfortunately ground based global groundwater measurements and data availability are poor limiting the investigation of hydrological and environmental extremes and adjusting suitable management policies chen et al 2019 groundwater is an essential source of water as it provides approximately 40 and 36 of global water for agriculture and drinking purposes respectively kourakos et al 2019 especially in arid and semiarid regions particularly in the middle east hameed et al 2019 hameed et al 2020 located in the middle east iran s annual precipitation 273 mm is less than one third of the average precipitation in the world in addition because of the high temperature in the major parts of this country most of the precipitation 73 evaporates these problems for iran s water security coincide with population growth people s water demand and long and short term meteorological droughts safdari et al 2022 while investigating water resources especially groundwater resources is vital in iran due to the lack of sufficient in situ observations for modeling and validation in the country iran s water resources research is quite limited although it has been reported that there are approximately 12 000 piezometers and 15 000 observation wells in iran noori et al 2021 the observations are not complete and not of good quality to be used for long term groundwater monitoring in the country which limits the application of data driven modeling in recent years advancements in remote sensing have shown practical applications in hydrological studies among these are the moderate resolution imaging spectroradiometer modis tropical rainfall measurement mission trmm famine early warning systems network land data assimilation system fldas north american land data assimilation system nldas and gravity recovery and climate experiment grace which have been widely used to collect hydrological data e g zhang et al 2019 zhao et al 2020 verma and katpatal 2020 gavahi et al 2022 for example the terrestrial water storage anomaly twsa data provided by grace satellites started a revolution in water resources research especially in groundwater studies in regions with sparse ground based measurements abhishek kinouchi 2021 the grace products present unprecedented opportunities for the evaluation of groundwater storage anomalies around the world and have been widely used for hydrological and environmental studies e g rodell et al 2018 abhishek kinouchi 2021 engström et al 2021 abhishek kinouchi 2022 however the coarse spatial resolution several hundred kilometers of grace derived groundwater storage gws hampers its applications castellazzi et al 2018 researchers have attempted to address the coarse spatial resolution problem of the twsa data of grace utilizing various techniques for example some researchers have used dynamic downscaling methods to improve the resolution e g houborg et al 2012 shokri et al 2019 while the proposed methods successfully produced grace data with fine spatial resolution most of them require extensive data and computational costs that are not affordable in different locations some others have focused on using statistical techniques including machine learning models for generating the fine spatial resolution grace data set the primary assumption in machine learning methods to downscale grace data is the stationarity between the fine and coarse scale data for instance using grace based data majumdar et al 2020 utilized random forest rf to estimate groundwater withdrawal per unit area at a 5 km resolution several researchers have also employed machine learning methods for downscaling grace data e g verma and katpatal 2020 sahour et al 2020 zhang et al 2021 however different drawbacks have limited the applicability of such methods many of the presented methods require if not based on ground based data and the measurements provided by the local organizations e g seyoum et al 2019 verma and katpatal 2020 this approach hampers the applicability of the methods in regions without enough in situ measurements and accurate ground based data in addition previous studies rarely provided strategies by which the downscaled map could reach a fine spatial resolution at the same time the proposed models were not successful enough as they contain several uncertainties due to downscaling other data sources with regular approaches to be used as auxiliary data moreover some of the studies did not consider the fact that unlike the other spaceborne sensors grace uses the separation between two parts of the twin satellite to detect gravity anomalies and does not provide individual pixels these studies have resampled the predictors to be identical to the spatial resolution of the grace data and used the acquired relationships to downscale the grace data which is an inadequate assumption the current study aims to propose a new approach based on deep learning methods and remote sensing to 1 systematically downscale the twsa product of grace considering the lack of a gws map with fine resolution and high accuracy 2 generate gws data for which this research focuses on utilizing satellite data and fldas products to downscale the twsa 3 develop drought maps using the produced downscaled maps and 4 investigate the main reasons for the water crisis in iran this country has faced water resources problems and harmful environmental situations over the years 2 materials and methods 2 1 proposed methodology this study employs grace derived twsa to investigate water resources conditions at high spatial resolution the proposed methodology is presented in fig 1 for this only the remotely sensed images from satellites and global models are collected which makes the study applicable to regions with no in situ observations in the next step the growing neural gas gng clustering technique is utilized to address the nonrectangular shape of native grace pixels after that three machine learning methods including deep learning convlstm shallow learning feed forward neural network ffnn and random forest rf are used to model the relationship between the inputs with 50 km spatial resolution and the twsa after modeling and determining the best model the residuals between the estimated twsa by the model and the actual twsa data with 50 km resolution are calculated and then interpolated using three methods including spline interpolation inverse distance weighting idw and kriging after that the inputs with 10 km spatial resolution are fed into the model and then the residuals are added to the outputs with 10 km resolution to estimate the twsa at fine spatial resolution in the next stage the downscaled twsa data are used to study drought and water resources in iran the significant reasons for drought are then traced by generating precipitation based drought maps and the change detection map of gws 2 2 the study area iran is located in one of the most water scarce regions of the world fig 2 and with an area of approximately 1 648 195 km2 is the second largest country in the middle east iran contains an appropriate diversity of climates including hyper arid arid semiarid mediterranean semi wet and wet since more than 80 of its area is in the hyper arid arid and semiarid climate categories iran is characterized as an arid region the annual precipitation in this country is 273 mm which is not uniform in different areas since 75 of the precipitation falls on the coast of the caspian sea additionally 72 of the precipitation in iran evaporates and only 25 of the precipitation falls in the crop growing season saatsaz 2020 therefore iran is one of the largest groundwater consumers globally and groundwater provides 60 of the country s total water supply which means that the living of a significant part of the people is highly attached to groundwater in addition population growth and industrial activities have put more pressure on the country s water resources resulting in medium to extremely high water risk in iran s 20 most populous cities safdari et al 2022 2 3 data collection the current study uses remotely sensed data in situ observations and data driven models to acquire monthly data from april 2002 to december 2016 due to the limited availability of in situ observations and the twsa data provided by google earth engine gee in this research modis products including land surface temperature lst and normalized difference vegetation index ndvi precipitation datasets provided by trmm digital elevation model dem by srtm evapotranspiration et soil moisture sm and snow water equivalent swe products of fldas are used as predictors to estimate the twsa of grace after that the sm and swe products of fldas are utilized as auxiliary data to compute the gws table 1 describes the datasets used in the current study 2 3 1 grace launched by the national aeronautics and space administration nasa and the german aerospace center dlr the grace mission includes two satellites that measure earth s gravity characteristics using microwave k band ranging to investigate water resources the surface of earth is not uniform since it contains physical features with different densities such as oceans glaciers and mountains therefore the density inequality is concluded in the gravitational field which is the primary data source for grace twin satellites the grace data include global coverage of a single position in space every month for more information and details please refer to nasa 2002 the grace mission provides three levels of products among which the level 1 data are the raw data and are not available to the public the level 2 product includes the processed data which generate the monthly gravity field estimates in spherical harmonic coefficient form three different centers produce the level 2 data including the geoforschungszentrum potsdam s gfz the university of texas center for space research s csr and the jet propulsion laboratory s jpl the level 3 product is also processed for users who prefer to use the data as mass anomalies on a gridded scale grace tellus while the level 2 product has been used in various studies some researchers have tried to enhance the data quality using post processing methods one of the crucial approaches is to parameterize the gravity field with regional mass concentration functions mascon which works based on level 1 data without post processing watkins et al 2015 the mascon solution reduces the uncertainties compared to the level 2 data as mentioned earlier two of the organizations offer it including m csr and m jpl and goddard space flight center mascons m gsfc the current study utilizes an average of mascon products m ave with 0 5 0 5 spatial sampling note that although the resolution is 0 5 50 50 km the neighboring cells are dependent on each other and we cannot interpret them the same as the pixels of different remote sensing instruments yi et al 2016 2 3 2 predictors the lst is a key parameter in hydrological studies as it presents the energy and water flux between the land surface and atmosphere it has been shown that lst has a close relation with groundwater because the land surface s heat signature has a considerable impact on groundwater gavahi et al 2020 here we use the mod11a2 product of modis to generate average monthly lst maps over iran with a 1 km spatial resolution the ndvi describes the greenness or the photosynthetic absorbed radiation ranging from 1 to 1 as a normalized index higher values indicate higher greenness and denser vegetation cover foroumandi et al 2021 vegetation cover undoubtedly has a close relationship with the groundwater quantity therefore the current research uses the mod13a2 product of modis to collect averaged monthly ndvi maps over iran with a 1 km spatial resolution et is the most extensive term in the terrestrial water budget after precipitation and it has been indicated to have a strong correlation with groundwater carter et al 2018 in this study the et product offered by fldas with a 10 km spatial resolution is utilized to collect monthly total et maps over iran trmm generates monthly precipitation data by combining the outputs of satellites radars and ground gauges g j huffman et al 2007 as precipitation data have undeniable impacts on groundwater we utilize trmm tmpa 3b43 with a 0 25 0 25 spatial resolution to collect monthly precipitation data over iran data by trmm are provided from 1998 to 2020 and afterward integrated multi satellite retrievals for gpm imerg should be used to collect the precipitation data g huffman et al 2020 dem data have been widely used in groundwater studies since they have a strong correlation with groundwater level chen et al 2019 the dem map for iran is acquired from srtm with 3 arc second spatial resolution fldas incorporates ground based and satellite observations using land surface models including the lsm vic and noah models to produce land surface fluxes and states the fldas products by noah are available with 1 2 months s latency at 0 1 degree resolution mcnally et al 2017 in this study fldas is utilized to collect monthly sm and swe data over iran 2 3 3 field observations the groundwater level gwl data are collected via field observations in situ measurements provided by the iran water resources management company iwrm from a total of 205 wells all over the country then the in situ gwl data should be converted to gwsa data to be used as validation data for the downscaled grace derived gwsa to this end gwl is subtracted from the average data from 2004 to 2009 this period is the baseline for grace derived gwsa using the specific yield sy of each well gws can be calculated by multiplying the gwl changes by sy the specific yields for different soil textures are presented in table 2 the specific yield values for the wells are gathered according to safdari et al 2022 2 4 growing neural gas gng in this study the gng clustering method is used to generate the native grace based twsa pixels with similar patterns in the time series the grace data are provided at 1 spatial sampling with an irregular not rectangular shape and then interpolated into 0 50 spatial resolution sahour et al 2020 in this way the pixels do not present the actual data and each pixel is highly correlated with adjacent pixels in this study the gng is used to cluster the twsa data to recognize the pixels with high similarity the new pixels produced by gng are used as the sources for the inputs and output the gng is a self organizing map som based algorithm that as an unsupervised learning method utilizes a growing mechanism for gradual adaptation the original version of the som has two major drawbacks that made this algorithm undesirable for the clustering process in this study 1 the expected number of clusters has a direct influence on the number of neurons and 2 using the original version of the som is time consuming due to the huge structure of inputs however the gng method is able to learn the complicated relationships in this study with no prior knowledge to create a network topology without being restricted in a k dimensional structure gng utilizes the competitive hebbian learning chl growth approach fritzke 1995 the gng learning algorithm steps are presented in fig 3 as follows i start with neuron a and neuron b at random positions in which w a and w b are their associated reference vectors ii generate a random input time series related to a density function p ξ iii find the nearest neuron s1 winner neuron and the second nearest neuron s2 iv increase the age of all edges emanating from s1 to its neighbors v increase the local error of s1 by using the euclidean distance between two vectors as δ e r r o r s 1 w s 1 ξ 2 1 vi relocate s1 and its topological neighbors towards ξ by εw and εn learning rates respectively of the total distance n shows all direct neighbors of s1 2 δ w s 1 ε w ξ w s 1 3 δ w s n ε n ξ w s n vii if there exists an edge between s1 and s2 then zero is set as their age viii remove the edges larger than a max if this results in isolated neurons without emanating edges remove them as well ix for every certain number of inputs generated insert a new neuron x decrease all error variables by multiplying them by a constant β xi delete outliers based on the network edge length average xii if the stopping criterion is not yet achieved proceed to step 2 xiii reorder network neurons using the neighbourhood structure unlike classical clustering algorithms gng has a flexible and adaptable algorithm that makes it practical for learning the topology of high dimensional datasets 2 5 data preprocessing the gee python api and other related libraries in python are employed for collecting and preprocessing the remotely sensed images the remotely sensed tiles that cover iran are mosaiced into a singular image for each predictor and then are clipped to iran s extent for each month the predictors with fine spatial resolution are aggregated to coarse spatial resolution using the linear interpolation method the first time the predictors are aggregated to the newly generated pixels the resolution of the coarse grace derived twsa to train the model and the second time the predictors are aggregated to 10 km resolution to be used as inputs to the model to estimate the twsa with fine spatial resolution then the bands for each product predictors and output are concatenated to generate 4d tensors with the following structure time height width band in addition the zero padding method is used to expand the size of the predictors before imposing the input data into the model to keep the size of the feature maps 2 6 convlstm networks lstm a form of recurrent neural network rnn is a deep learning method that can take full advantage of the information presented in a sequence hochreiter and schmidhuber 1997 the lstm network is able to remove irrelevant information while it keeps a cell state from the preceding set of data through three gates 1 input gate 2 forget gate and 3 output gate each gate constructs a memory block that returns a state variable and the cell output the state variables are defined as a1 a5 in the appendix file gavahi et al 2021 as a combination of convolutional and lstm layers convlstm has been proposed where the convolutional layers are exerted on the input to state and state to state transformations of the lstm layer shi et al 2015 the advantage of convlstm over the lstm model is its ability to extract not only the temporal relationship but also the spatial feature of the inputs which is vital in the current study the structure of a convlstm unit is presented in fig 4 and the structure of the method is defined as a6 a10 in the appendix file the sophisticated structure of convlstm is expected to capture the spatiotemporal features of the hydrological inputs and the complicated groundwater characteristics the 4d tensors produced in the data preprocessing step are utilized as inputs for the model the optimum number of layers is determined by trial and error procedures using multiple experiments before each layer the inputs are normalized using the batch normalization method to have a faster learning procedure and prevent the internal covariate shift loffe szegedy 2015 therefore the number of convlstm layers is set to four and for each block 16 filters with 3 3 size and stride size 1 are applied the same padding method is utilized to keep the size of outputs equal to the size of the inputs the relu activation function is employed for time efficiency gavahi et al 2021 abbaszadeh et al 2022 in the end the extracted features are entered into a flatten layer a final dense layer with 1024 neurons and a hyperbolic tangent tanh activation function and a dropout layer with 0 5 probability the dropout layer is used as a regularization method that randomly ignores a few neurons to prevent the overfitting problem srivastava et al 2014 2 7 random forest rf the rf method which was proposed by breiman 2001 is used in the current study as a supervised algorithm to downscale the grace derived twsa rf is an integrated machine learning method containing several classification and regression decision trees in this method first the bootstrap algorithm is utilized to randomly select samples from the original data to train the model and the remaining data are used for the testing phase in the next stage for each sample a decision tree is built which has no interaction with each other and then all of the trees are combined into the rf model the final results are the average of the outputs of each tree in this study the grace derived twsa data are used as the target dataset and the inputs are fed into the rf model using a trial and error procedure 1000 regression trees are determined to acquire the best performance previous studies have mentioned that the rf model can lead to high accuracy and good performance in dealing with large data it detects the importance of variables and the interactions between them and the overfitting problem is rarely reported chen et al 2019 2 8 shallow learning feed forward neural network ffnn in the current study ffnn is used as a shallow learning model to downscale the grace derived twsa in iran ffnns are dynamic models that aim to estimate outputs by processing data in three layers including input hidden and output layers each layer contains a set of neurons that are linked to the neurons of the next layer ffnns are suitable for modeling hydrological datasets because this model showed promising performance when dealing with nonlinear problems by extrapolating the relationship between the variables without any prior assumption alipour et al 2020 in this study to use ffnns the data are divided into training 70 testing 15 and validation 15 sets to identify the best model additionally the number of neurons in the hidden layer and the epoch number are determined via trial and error procedures nourani et al 2021 2 9 computation of gws the current study uses in situ wells to validate the downscaling method therefore gwsa should be isolated from the grace derived twsa as the grace derived twsa is a vertically integrated water variable that provides the total water storage anomaly a vertical water model is used to extract the groundwater storage anomalies gwsa to evaluate the downscaled data as follows 4 twsa g w s a s w s a s m s a s w e a where swsa smsa and swea are the surface water storage anomaly soil moisture storage anomaly and snow water equivalent anomaly respectively according to previous studies surface water storage anomalies are negligible in arid and semiarid regions because the twsa is significantly controlled by gwsa and smsa rodell et al 2007 yang et al 2018 skaskevych et al 2020 therefore gwsa can be calculated as 5 gwsa t w s a s m s a s w e a the auxiliary data for smsa and swea in this study are collected from the fldas model 2 10 drought indices grace data are sensitive to changes in tws which includes surface water groundwater and soil moisture indicating that the grace dsi drought index can detect hydrological and agricultural droughts however comparing grace based drought indices with traditional drought indices for the validation period is not a correct approach because traditional drought indices deal with different variables that are differently related to drought hence grace should be used as an independent indicator for drought zargar et al 2011 vishwakarma 2020 the standardized grace derived twsa is calculated as the grace dsi in each 10 km cell for year i ranging from 2002 to 2016 as follows m zhao et al 2017 6 grace d s i i twsa i twsa σ i where twsa and σ i are the mean and standard deviation in year i of twsa respectively the grace dsi is able to detect wet events as well as drought conditions using various categories which are tabulated in table 3 the current study calculates the grace dsi to study drought with high spatial resolution in iran in the next stage the standardized precipitation index spi is used to monitor precipitation based drought maps and their intensity in iran although there are some recently developed drought indices such as the standardized precipitation evapotranspiration index spei the spi is used here because this study is interested in finding only the precipitation based drought conditions in each pixel without considering potential evapotranspiration and temperature impacts selecting the spi helps determine if the reason for the recognized droughts by grace dsi in iran is dominated by precipitation to this end using the data provided by the trmm over iran the spi is calculated following the steps provided by mahmoudi et al 2021 and is categorized as presented in table 4 2 11 evaluation criteria the performance of the clustering phase is evaluated using the silhouette chou davies scd index sharghi et al 2022 7 scd sc 0 5 c s 0 5 d b as seen in equation 17 the scd is a combination of three robust cluster validity measures including sc the silhouette coefficient rousseeuw 1987 db the davies bouldin coefficient davies bouldin 1979 and cs the chou su coefficient chou et al 2004 the maximum value of the scd index suggests the best structure of clusters that a clustering method can yield the sc is a measure of how similar an object is to its own cluster compared to other clusters the sc is calculated using the mean intra cluster distance and the mean nearest cluster distance for each sample the db index is defined as the average similarity measure of each cluster with its most similar cluster where similarity is the ratio of within cluster distances to between cluster distances the cs coefficient is a function of the ratio of the sum of within cluster scatter to between cluster separation to deal with clusters of different densities and or sizes and has a small value for good clustering for more details about the sc db and cs please read rousseeuw 1987 davies and bouldin 1979 chou et al 2004 respectively the evaluation of the modeling in the first phase where the predictors are used to estimate the grace based twsa cm with coarse resolution is performed using root mean square error rmse which denotes the ability to estimate volatility and the determination coefficient r2 which reflects the extent to which the modeling is reliable in addition r2 between the downscaled data and the in situ measurements from wells is used to evaluate the accuracy of downscaled groundwater storage data foroumandi et al 2021 8 rmse i 1 n y i y i 2 n 9 r 2 1 y i y i 2 y i y i 2 where y i and y i are the ground truth value and estimated value by the model at the i th step respectively and y i is the averaged ground truth value 3 results and discussion the current study uses remote sensing images and machine learning methods to downscale grace derived twsa to 10 km spatial resolution in the presented framework first only the remotely sensed images are utilized to demonstrate the applicability of the approach in ungagged or poorly gauged regions then the gng clustering method is used to deal with the nonrectangularity feature of grace pixels which has been rarely considered in previous studies in the next stage the convlstm model is used due to its robustness in modeling sequential images the rf and ffnn models which have been widely used in previous studies to downscale the grace data are also used to further evaluate and compare the results after downscaling the grace derived twsa the annual grace dsi drought maps are produced over iran in addition the gws map is generated to not only evaluate the downscaling procedure but also study the groundwater conditions in iran spi drought maps were also created to analyze meteorological drought in iran 3 1 the clustering the gng method is utilized to cluster the grace pixels with high similarity as the original data are not provided with rectangular shapes the monthly time series for each pixel from 2002 to 2016 is used to investigate the changing patterns the adaptation ability and optimized growth of gng lead to the desired resolution of the clustered pixels the output of the clustering phase is presented in fig 5 based on the scd criteria 297 clusters are obtained as the optimal number of clusters by trial and error procedures in this process the gng model is applied with 100 to 400 clusters and the model with 297 clusters shows the highest scd scd 0 738 and the best performance the clustering method is applied as a preprocessing technique to improve the modeling performance and deal with nonrectangular features of grace twsa data homogenous clusters including highly correlated pixels provide confidence about having the best structure of inputs it is worth mentioning that the raw grace data could affect the accuracy of the downscaling process which is overcome by the preprocessing step neural clustering method of gng 3 2 downscaling in this study we use three statistical models to downscale the monthly twsa provided by the grace mission from april 2002 to december 2016 to understand which model is more accurate to study groundwater with high spatial resolution the results of the model performances are presented in table 5 in the first step the lst ndvi precipitation and dem images are aggregated as mentioned in section 2 5 additionally the sm and swe are used as predictors to model the grace derived twsa with coarse spatial resolution the convlstm rf and ffnn models are designed to capture the relationship between the inputs and outputs with coarse spatial resolution the results table 5 indicate that rf outperforms ffnn in the overall validation of the models with 9 higher r2 in the testing phase and is more reliable to localize the twsa the results of the ffnn model in the training phase are much better than the results in the testing phase with 12 superiority which reveals that the ffnn is overfitted during the training process and it is not able to estimate the twsa in the testing step this may be attributed to a large amount of data in this study with little heterogeneity as the twsa is changing from 18 to 9 with a standard deviation of 5 90 in iran the performance of the convlstm model according to the results in table 4 and fig 6 is shown to be more accurate than the previous models 7 and 18 higher r2 in the testing phase than rf and ffnn respectively it is concluded that the convlstm model is reliable for downscaling grace derived twsa data the convlstm model shows better performance with better evaluation results than the rf and ffnn in both the training and testing phases in general convlstm is successful in modeling the grace derived twsa maps in iran because the structure of the model is able to capture spatiotemporal information in a dataset after training the model to learn the relationship between the inputs and the twsa the difference between the outputs with coarse resolution obtained from the model and the original grace derived twsa is calculated as the residuals the residuals expound on the natural random variations in groundwater that are not demonstrated by the model the residuals are then interpolated to 10 km resolution using the spline interpolation kriging and idw methods the final results provided by the three methods are observed to have a 2 9 average relative change indicating that the interpolation method has no considerable impact on the downscaling procedure the weak sensitivity of modeling twsa on residuals reduces the uncertainty in the downscaling procedure because interpolating the residuals using different techniques could add some biases to the estimation of twsa the predictors with 10 km spatial resolution are then fed into the convlstm model to estimate the twsa maps with fine spatial resolution the final downscaled twsa is generated by adding the interpolated residuals into the twsa data obtained by the convlstm model in addition the observed gwsa by wells is calculated to evaluate the downscaling accuracy the r2 metric between the monthly wells and grace derived gwsa with an average value of 0 76 is presented in fig 6 the proposed methodology is never calibrated with in situ measurements therefore the strong correlation denoted that the downscaled outputs via the presented method are reliable for use in hydrological studies particularly in regions with scarce in situ groundwater observations the modeling performance is also evaluated for each basin using the r2 metric and the results are presented in fig 7 the results ranging from 0 71 to 0 89 indicate that although the model has a good ability to downscale the twsa the worst performances are seen in the khaf hamun mashkil bandarabbas and urmia basins to delve deeper into the main reason for this issue the twsa time series for one point in each of the above mentioned basins are plotted in fig 8 the results indicate that the twsa time series in the basins where the model has shown lower performance are complicated and contain changing patterns the changing patterns and significant variations in data may result in lower performance and less accurate outputs in machine learning based models li et al 2021 3 3 drought analysis over iran iran has faced water resources problems and harmful environmental situations over the years the current study downscaled the grace derived twsa to a 10 km spatial resolution to further investigate water resources problems in the country fig 9 presents grace dsi with 10 km spatial resolution and fig 10 shows the map of the spi drought index with 10 km resolution from 2002 to 2016 the drought classification map extracted from the grace data changes more smoothly than the spi drought classification map in different regions as it provides the total water storage based drought the presented methodology and results can inform water resources managers and stakeholders to deal with drought on a regional scale according to the grace dsi classification map iran experienced near normal conditions in 2002 mostly in the western northwestern northern and southwestern regions fig 9 the drought situation became wetter in 2003 and the country experienced an extremely wet climate in the western and northwestern regions in 2004 in 2005 the situation led to extremely wet conditions in northeast east south and southeast iran and very wet conditions in the northern northwestern and western parts the grace dsi map indicates that in 2006 and 2007 iran passed extremely wet conditions and entered a moderately wet year in most of the regions the grace dsi classification map denotes that iran entered a three year era of near normal conditions from 2008 to 2010 after experiencing five years of wet classes according to grace dsi iran endured moderate drought and abnormal drought conditions starting from 2011 which prolonged to the last year of study 2016 in addition from 2011 to 2016 iran s water crisis became more fatal which ended with exceptional drought in the last year in a few locations and extreme and severe drought conditions in other regions generally the grace dsi drought conditions indicate that iran is in a damaging water resources situation the spi classification map fig 10 shows that in 2002 iran was in moderate and mild drought conditions in most of the regions though in 2003 the country experienced severe drought in the middle portion additionally the spi map indicates moderate severe and extremely wet situations in some of the middle portions of iran in 2004 on the other hand the western region s situation changed from extremely wet to severe drought from 2002 to 2005 although the spi map in 2006 denotes extremely wet and normal situations almost all over iran it was changed to moderate severe and extreme drought in 2007 and 2008 further analysis shows that iran again experienced an extremely wet situation in 2009 which did not persist for the following years in 2010 and 2011 iran was mostly in moderate and severe drought conditions and the northwestern regions experienced extreme drought from 2012 to 2015 the country seemed to be wetter than the previous years although some regions were still in drought unfortunately in 2016 several places in iran were again surrounded by moderate and severe drought conditions the literature shows that the meteorological drought characterized by spi effects changed in different regions of the country until 2019 darand fathi 2021 lotfirad et al 2022 due to its arid and semi arid climate conditions iran has always experienced meteorological drought and its associated tensions the grace dsi classification results denote that iran has entered a deteriorating era of water crisis since 2011 the drought extent percentage over iran acquired by grace dsi is presented in fig 11 a according to this figure from 2002 to 2008 iran experienced almost wet conditions while in 2009 the wet conditions ended and the country returned to normal conditions however for the first time almost 20 of the country had abnormally dry conditions the onset of the moderate drought was in 2010 which extended all over the country by 2014 it is worth mentioning that in 2011 approximately 90 of iran was in a dry situation the severe drought that started in 2012 extended to 40 of iran by 2016 the findings of this section are in alignment with a few studies that reported groundwater depletion all over iran which has been extended to recent years in some regions e g amini and hesami 2017 vaheddoost and aksoy 2018 khorrami and malekmohammadi 2021 according to the spi classification iran has been experiencing meteorological droughts in different regions however some extremely wet years are also seen the drought extent over iran acquired by the spi is shown in fig 11b although a drought extent of 30 75 was seen over iran from 2002 to 2011 except for 2006 and 2009 which were 15 and 10 respectively 20 30 of the country was wet and the remaining was in normal condition since 2011 the meteorological drought extent has decreased while for the same period grace dsi reveals continuing severe pressure on iran s water resources these results show that the main reason for the water crisis in iran is not meteorological drought previous studies in different regions of iran indicated that agricultural activities have expanded over the last decades increasing water demand in the northern part of iran industrial and agricultural activities have increased by approximately 70 and almost 250 million us dezhkam et al 2014 badamfirooz and mousazadeh 2019 barzegar et al 2018 and foroumandi et al 2021 reported that agricultural activities in the northwestern regions of iran especially in the lake urmia basin as one of the most important basins in iran are rapidly growing in the south southwestern and western regions increasing agricultural and irrigation activities have been reported especially in kurdistan province located in western iran e g razavi 2014 malmir et al 2015 zandi et al 2017 nourani et al 2022 however the water demand cannot be met by precipitation alone due to significant agricultural expansion foroumandi et al 2022 the change detection map the difference between the first and last years for the gws with a 10 km resolution is presented in fig 12 the results show that groundwater resources are used for irrigation and increasing agricultural activities in the country which have led to groundwater depletion all over iran particularly in the northern and northwestern regions the current study presents an analysis of iran s water resources using the proposed downscaling method until 2016 the time series for the twsa data of grace grids that cover the gharesu gorgan and aras basins from january 2017 to march 2021 were collected from the related organiazations and are plotted in fig 13 a and fig 13b respectively in addition the time series for one observation well in the gharesu gorgan basin and two observation wells in the aras basin are plotted in fig 13c fig 13d and fig 13e the area averaged time series of twsa from january 2017 to february 2022 were also extracted employing the tools provided by nasa jpl https jpl nasa gov and the results are provided in fig 13f it is noted that there is a data gap in twsa between july 2017 and may 2018 due to the temporal gap between grace and grace fo missions velicogna et al 2020 fig 13 indicates that after 2016 the decreasing trend in grace derived twsa and in situ gwl continues in different basins of iran additionally the area averaged time series of the twsa in iran fig 13e shows that the water resources problem becomes more hazardous in the country which is consistent with the literature lotfirad et al 2022 vaheddoost and aksoy 2018 khorrami and malekmohammadi 2021 although the negative trend in the twsa time series of the aras basin is more remarkable than that in the gharesu gorgan basin the gwl of the observation well in gharesu gorgan shows a more severe decreasing trend additionally for two in situ gwl measurements in the aras basin fig 13c shows a positive trend but fig 13e shows a marginally negative trend while both wells are located in the same pixel of grace therefore grace data downscaling is necessary to study different regions generally the decreasing trend until 2022 in twsa and gwl reveals that water resources problems in iran have not been managed properly and still threaten the environment and people the current study denotes that iran s water crisis is heavily influenced by anthropogenic factors imposed by excessive groundwater withdrawal for agricultural and human induced activities while meteorological drought is a trigger and intensifier for depletion previous studies used the term groundwater overexploitation when the amount of abstraction is greater than the total amount of recharge while it can be misleading as human activities and aquifer development may affect the data custodio 2002 using grace dsi the current study defines the term water resources overexploitation for iran which can be defined as when the total amount of water output from the system exceeds or is close to the input water rate for several years the results indicate that the reason for water resources overexploitation in iran is aggressive water withdrawal for food production and irrigation water scarcity is not the only problem caused by water resources overexploitation in iran as previous studies have reported various country wide environmental problems including but not limited to soil salinity and land subsidence e g fathizad et al 2020 babaee et al 2020 4 conclusion the current study uses remote sensing tools clustering techniques and deep learning to downscale grace derived twsa in iran a data poor country with several water related problems the gng method is utilized to find the native grace pixels and the performance of gng is evaluated by the scd criteria then the convlstm ffnn and rf methods are used to estimate the twsa at a fine spatial resolution the proposed methodology can be used to systematically downscale grace derived twsa to 10 km spatial resolution providing grace data with a fine spatial resolution is of great importance since it is one of the main sources for studying groundwater and total water storage especially in regions with sparse ground observations the results indicate that the convlstm outperforms the rf and ffnn models and is successful in downscaling the grace data and in generating groundwater storage maps in iran the generated gwsa data are validated by the in situ gwsa measurements provided by observation wells although the method is accurate enough to study gwl trends and drought there is still a source of uncertainty as there are no reliable data for surface water in iran the current study ignores the contribution of surface water resources when using auxiliary data to isolate the groundwater value this study also investigates other hydrological variables and drought maps to gain insight into the water resources problems in iran the outputs of this study can be used to make specific decisions regarding water resources and groundwater management on a regional scale groundwater resources are crucial in the national water security of iran as they provide 60 of fresh water in the country saatsaz 2020 the current study denotes that iran has experienced long term drought since 2010 while some regions have experienced exceptional drought conditions additionally the gws decreased all over iran from 2002 to 2016 in addition the annual spi maps are generated and the results reveal that meteorological drought is a trigger for iran s water crisis although not the main reason according to the results of this study which are in agreement with previous studies the agricultural expansion in iran with excessive groundwater withdrawal is the main reason for iran s water resources problem which is mentioned here as water resources overexploitation further analysis indicates that the problem will continues up to 2022 one of the limitations of this study is the inaccessibility of ground based crop type classification data which halts further investigation of the details of the impacts of agricultural activities on water resources and specifically groundwater resources future studies may consider investigating agricultural activities and studying water resources problems after 2016 in more detail using other drought indices including the spei and surveying meteorological time series are useful to study water resources and investigate the main reasons for water related issues as the growing water demand in iran has coincided with environmental problems the water scarcity warns that iran needs integrated sustainable water resources management at both the national and regional levels to update the water supply networks improve irrigation efficiency and regulate appropriate strategies in the agriculture sector and cultural awareness declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2598,the current study proposes a new method to downscale the monthly grace derived terrestrial water storage anomaly twsa to 10 km spatial resolution over iran using deep learning methods first the growing neural gas gng method is utilized to cluster the twsa data to find similar patterns the silhouette chou davies scd validity measure a combination of three robust cluster validity measures is used to evaluate the performance of the gng method then the feasibility of deep learning convolutional long short term memory convlstm shallow learning feed forward neural networks ffnn and random forest rf are examined in downscaling grace derived twsa using only remote sensing images the results indicate that the deep learning method outperforms the rf and ffnn models by 7 and 18 respectively then the ground water storage gws data are isolated from twsa showing an agreement between the grace derived gws and ground based measurements with r2 0 76 additionally the downscaled twsa is used to generate annual drought frequency and change detection maps for the gws from 2002 to 2016 annual standardized precipitation index spi drought frequency maps are also produced to gain deeper insight into the water resource scarcity of iran the results indicate that iran has experienced water resource overexploitation since 2011 for agricultural activities while meteorological drought is a trigger and intensifier for the water crisis in iran according to the results iran experienced exceptional drought in some regions and the gws has decreased all over the country in addition further analysis of iran s water resources is provided until 2022 the current study calls for integrated sustainable water resources management in iran otherwise irreversible water and environmental problems with higher frequencies will be expected in the near future keywords grace remote sensing deep learning convolutional long short term memory convlstm drought iran data availability data will be made available on request 1 introduction water resources are increasingly becoming a priority issue at the international level with a continued threat from climate change and anthropogenic activities hence sustainable water resources management needs further investigation especially in freshwater resources as the largest accessible freshwater source groundwater satisfies a significant portion of water demand engström et al 2020 droughts as one of the devastating disasters for water resources are harmful to groundwater as they intensify the depletion and diminish the recharge of groundwater resources groundwater storage may ultimately be affected by meteorological agricultural and hydrological droughts however an accurate assessment of groundwater storage and its dynamics is still challenging compared to surface hydrological components since groundwater storage is not visible abhishek kinouchi 2022 therefore continuous groundwater observations are essential for adequate monitoring and surveying groundwater availability and potential trends unfortunately ground based global groundwater measurements and data availability are poor limiting the investigation of hydrological and environmental extremes and adjusting suitable management policies chen et al 2019 groundwater is an essential source of water as it provides approximately 40 and 36 of global water for agriculture and drinking purposes respectively kourakos et al 2019 especially in arid and semiarid regions particularly in the middle east hameed et al 2019 hameed et al 2020 located in the middle east iran s annual precipitation 273 mm is less than one third of the average precipitation in the world in addition because of the high temperature in the major parts of this country most of the precipitation 73 evaporates these problems for iran s water security coincide with population growth people s water demand and long and short term meteorological droughts safdari et al 2022 while investigating water resources especially groundwater resources is vital in iran due to the lack of sufficient in situ observations for modeling and validation in the country iran s water resources research is quite limited although it has been reported that there are approximately 12 000 piezometers and 15 000 observation wells in iran noori et al 2021 the observations are not complete and not of good quality to be used for long term groundwater monitoring in the country which limits the application of data driven modeling in recent years advancements in remote sensing have shown practical applications in hydrological studies among these are the moderate resolution imaging spectroradiometer modis tropical rainfall measurement mission trmm famine early warning systems network land data assimilation system fldas north american land data assimilation system nldas and gravity recovery and climate experiment grace which have been widely used to collect hydrological data e g zhang et al 2019 zhao et al 2020 verma and katpatal 2020 gavahi et al 2022 for example the terrestrial water storage anomaly twsa data provided by grace satellites started a revolution in water resources research especially in groundwater studies in regions with sparse ground based measurements abhishek kinouchi 2021 the grace products present unprecedented opportunities for the evaluation of groundwater storage anomalies around the world and have been widely used for hydrological and environmental studies e g rodell et al 2018 abhishek kinouchi 2021 engström et al 2021 abhishek kinouchi 2022 however the coarse spatial resolution several hundred kilometers of grace derived groundwater storage gws hampers its applications castellazzi et al 2018 researchers have attempted to address the coarse spatial resolution problem of the twsa data of grace utilizing various techniques for example some researchers have used dynamic downscaling methods to improve the resolution e g houborg et al 2012 shokri et al 2019 while the proposed methods successfully produced grace data with fine spatial resolution most of them require extensive data and computational costs that are not affordable in different locations some others have focused on using statistical techniques including machine learning models for generating the fine spatial resolution grace data set the primary assumption in machine learning methods to downscale grace data is the stationarity between the fine and coarse scale data for instance using grace based data majumdar et al 2020 utilized random forest rf to estimate groundwater withdrawal per unit area at a 5 km resolution several researchers have also employed machine learning methods for downscaling grace data e g verma and katpatal 2020 sahour et al 2020 zhang et al 2021 however different drawbacks have limited the applicability of such methods many of the presented methods require if not based on ground based data and the measurements provided by the local organizations e g seyoum et al 2019 verma and katpatal 2020 this approach hampers the applicability of the methods in regions without enough in situ measurements and accurate ground based data in addition previous studies rarely provided strategies by which the downscaled map could reach a fine spatial resolution at the same time the proposed models were not successful enough as they contain several uncertainties due to downscaling other data sources with regular approaches to be used as auxiliary data moreover some of the studies did not consider the fact that unlike the other spaceborne sensors grace uses the separation between two parts of the twin satellite to detect gravity anomalies and does not provide individual pixels these studies have resampled the predictors to be identical to the spatial resolution of the grace data and used the acquired relationships to downscale the grace data which is an inadequate assumption the current study aims to propose a new approach based on deep learning methods and remote sensing to 1 systematically downscale the twsa product of grace considering the lack of a gws map with fine resolution and high accuracy 2 generate gws data for which this research focuses on utilizing satellite data and fldas products to downscale the twsa 3 develop drought maps using the produced downscaled maps and 4 investigate the main reasons for the water crisis in iran this country has faced water resources problems and harmful environmental situations over the years 2 materials and methods 2 1 proposed methodology this study employs grace derived twsa to investigate water resources conditions at high spatial resolution the proposed methodology is presented in fig 1 for this only the remotely sensed images from satellites and global models are collected which makes the study applicable to regions with no in situ observations in the next step the growing neural gas gng clustering technique is utilized to address the nonrectangular shape of native grace pixels after that three machine learning methods including deep learning convlstm shallow learning feed forward neural network ffnn and random forest rf are used to model the relationship between the inputs with 50 km spatial resolution and the twsa after modeling and determining the best model the residuals between the estimated twsa by the model and the actual twsa data with 50 km resolution are calculated and then interpolated using three methods including spline interpolation inverse distance weighting idw and kriging after that the inputs with 10 km spatial resolution are fed into the model and then the residuals are added to the outputs with 10 km resolution to estimate the twsa at fine spatial resolution in the next stage the downscaled twsa data are used to study drought and water resources in iran the significant reasons for drought are then traced by generating precipitation based drought maps and the change detection map of gws 2 2 the study area iran is located in one of the most water scarce regions of the world fig 2 and with an area of approximately 1 648 195 km2 is the second largest country in the middle east iran contains an appropriate diversity of climates including hyper arid arid semiarid mediterranean semi wet and wet since more than 80 of its area is in the hyper arid arid and semiarid climate categories iran is characterized as an arid region the annual precipitation in this country is 273 mm which is not uniform in different areas since 75 of the precipitation falls on the coast of the caspian sea additionally 72 of the precipitation in iran evaporates and only 25 of the precipitation falls in the crop growing season saatsaz 2020 therefore iran is one of the largest groundwater consumers globally and groundwater provides 60 of the country s total water supply which means that the living of a significant part of the people is highly attached to groundwater in addition population growth and industrial activities have put more pressure on the country s water resources resulting in medium to extremely high water risk in iran s 20 most populous cities safdari et al 2022 2 3 data collection the current study uses remotely sensed data in situ observations and data driven models to acquire monthly data from april 2002 to december 2016 due to the limited availability of in situ observations and the twsa data provided by google earth engine gee in this research modis products including land surface temperature lst and normalized difference vegetation index ndvi precipitation datasets provided by trmm digital elevation model dem by srtm evapotranspiration et soil moisture sm and snow water equivalent swe products of fldas are used as predictors to estimate the twsa of grace after that the sm and swe products of fldas are utilized as auxiliary data to compute the gws table 1 describes the datasets used in the current study 2 3 1 grace launched by the national aeronautics and space administration nasa and the german aerospace center dlr the grace mission includes two satellites that measure earth s gravity characteristics using microwave k band ranging to investigate water resources the surface of earth is not uniform since it contains physical features with different densities such as oceans glaciers and mountains therefore the density inequality is concluded in the gravitational field which is the primary data source for grace twin satellites the grace data include global coverage of a single position in space every month for more information and details please refer to nasa 2002 the grace mission provides three levels of products among which the level 1 data are the raw data and are not available to the public the level 2 product includes the processed data which generate the monthly gravity field estimates in spherical harmonic coefficient form three different centers produce the level 2 data including the geoforschungszentrum potsdam s gfz the university of texas center for space research s csr and the jet propulsion laboratory s jpl the level 3 product is also processed for users who prefer to use the data as mass anomalies on a gridded scale grace tellus while the level 2 product has been used in various studies some researchers have tried to enhance the data quality using post processing methods one of the crucial approaches is to parameterize the gravity field with regional mass concentration functions mascon which works based on level 1 data without post processing watkins et al 2015 the mascon solution reduces the uncertainties compared to the level 2 data as mentioned earlier two of the organizations offer it including m csr and m jpl and goddard space flight center mascons m gsfc the current study utilizes an average of mascon products m ave with 0 5 0 5 spatial sampling note that although the resolution is 0 5 50 50 km the neighboring cells are dependent on each other and we cannot interpret them the same as the pixels of different remote sensing instruments yi et al 2016 2 3 2 predictors the lst is a key parameter in hydrological studies as it presents the energy and water flux between the land surface and atmosphere it has been shown that lst has a close relation with groundwater because the land surface s heat signature has a considerable impact on groundwater gavahi et al 2020 here we use the mod11a2 product of modis to generate average monthly lst maps over iran with a 1 km spatial resolution the ndvi describes the greenness or the photosynthetic absorbed radiation ranging from 1 to 1 as a normalized index higher values indicate higher greenness and denser vegetation cover foroumandi et al 2021 vegetation cover undoubtedly has a close relationship with the groundwater quantity therefore the current research uses the mod13a2 product of modis to collect averaged monthly ndvi maps over iran with a 1 km spatial resolution et is the most extensive term in the terrestrial water budget after precipitation and it has been indicated to have a strong correlation with groundwater carter et al 2018 in this study the et product offered by fldas with a 10 km spatial resolution is utilized to collect monthly total et maps over iran trmm generates monthly precipitation data by combining the outputs of satellites radars and ground gauges g j huffman et al 2007 as precipitation data have undeniable impacts on groundwater we utilize trmm tmpa 3b43 with a 0 25 0 25 spatial resolution to collect monthly precipitation data over iran data by trmm are provided from 1998 to 2020 and afterward integrated multi satellite retrievals for gpm imerg should be used to collect the precipitation data g huffman et al 2020 dem data have been widely used in groundwater studies since they have a strong correlation with groundwater level chen et al 2019 the dem map for iran is acquired from srtm with 3 arc second spatial resolution fldas incorporates ground based and satellite observations using land surface models including the lsm vic and noah models to produce land surface fluxes and states the fldas products by noah are available with 1 2 months s latency at 0 1 degree resolution mcnally et al 2017 in this study fldas is utilized to collect monthly sm and swe data over iran 2 3 3 field observations the groundwater level gwl data are collected via field observations in situ measurements provided by the iran water resources management company iwrm from a total of 205 wells all over the country then the in situ gwl data should be converted to gwsa data to be used as validation data for the downscaled grace derived gwsa to this end gwl is subtracted from the average data from 2004 to 2009 this period is the baseline for grace derived gwsa using the specific yield sy of each well gws can be calculated by multiplying the gwl changes by sy the specific yields for different soil textures are presented in table 2 the specific yield values for the wells are gathered according to safdari et al 2022 2 4 growing neural gas gng in this study the gng clustering method is used to generate the native grace based twsa pixels with similar patterns in the time series the grace data are provided at 1 spatial sampling with an irregular not rectangular shape and then interpolated into 0 50 spatial resolution sahour et al 2020 in this way the pixels do not present the actual data and each pixel is highly correlated with adjacent pixels in this study the gng is used to cluster the twsa data to recognize the pixels with high similarity the new pixels produced by gng are used as the sources for the inputs and output the gng is a self organizing map som based algorithm that as an unsupervised learning method utilizes a growing mechanism for gradual adaptation the original version of the som has two major drawbacks that made this algorithm undesirable for the clustering process in this study 1 the expected number of clusters has a direct influence on the number of neurons and 2 using the original version of the som is time consuming due to the huge structure of inputs however the gng method is able to learn the complicated relationships in this study with no prior knowledge to create a network topology without being restricted in a k dimensional structure gng utilizes the competitive hebbian learning chl growth approach fritzke 1995 the gng learning algorithm steps are presented in fig 3 as follows i start with neuron a and neuron b at random positions in which w a and w b are their associated reference vectors ii generate a random input time series related to a density function p ξ iii find the nearest neuron s1 winner neuron and the second nearest neuron s2 iv increase the age of all edges emanating from s1 to its neighbors v increase the local error of s1 by using the euclidean distance between two vectors as δ e r r o r s 1 w s 1 ξ 2 1 vi relocate s1 and its topological neighbors towards ξ by εw and εn learning rates respectively of the total distance n shows all direct neighbors of s1 2 δ w s 1 ε w ξ w s 1 3 δ w s n ε n ξ w s n vii if there exists an edge between s1 and s2 then zero is set as their age viii remove the edges larger than a max if this results in isolated neurons without emanating edges remove them as well ix for every certain number of inputs generated insert a new neuron x decrease all error variables by multiplying them by a constant β xi delete outliers based on the network edge length average xii if the stopping criterion is not yet achieved proceed to step 2 xiii reorder network neurons using the neighbourhood structure unlike classical clustering algorithms gng has a flexible and adaptable algorithm that makes it practical for learning the topology of high dimensional datasets 2 5 data preprocessing the gee python api and other related libraries in python are employed for collecting and preprocessing the remotely sensed images the remotely sensed tiles that cover iran are mosaiced into a singular image for each predictor and then are clipped to iran s extent for each month the predictors with fine spatial resolution are aggregated to coarse spatial resolution using the linear interpolation method the first time the predictors are aggregated to the newly generated pixels the resolution of the coarse grace derived twsa to train the model and the second time the predictors are aggregated to 10 km resolution to be used as inputs to the model to estimate the twsa with fine spatial resolution then the bands for each product predictors and output are concatenated to generate 4d tensors with the following structure time height width band in addition the zero padding method is used to expand the size of the predictors before imposing the input data into the model to keep the size of the feature maps 2 6 convlstm networks lstm a form of recurrent neural network rnn is a deep learning method that can take full advantage of the information presented in a sequence hochreiter and schmidhuber 1997 the lstm network is able to remove irrelevant information while it keeps a cell state from the preceding set of data through three gates 1 input gate 2 forget gate and 3 output gate each gate constructs a memory block that returns a state variable and the cell output the state variables are defined as a1 a5 in the appendix file gavahi et al 2021 as a combination of convolutional and lstm layers convlstm has been proposed where the convolutional layers are exerted on the input to state and state to state transformations of the lstm layer shi et al 2015 the advantage of convlstm over the lstm model is its ability to extract not only the temporal relationship but also the spatial feature of the inputs which is vital in the current study the structure of a convlstm unit is presented in fig 4 and the structure of the method is defined as a6 a10 in the appendix file the sophisticated structure of convlstm is expected to capture the spatiotemporal features of the hydrological inputs and the complicated groundwater characteristics the 4d tensors produced in the data preprocessing step are utilized as inputs for the model the optimum number of layers is determined by trial and error procedures using multiple experiments before each layer the inputs are normalized using the batch normalization method to have a faster learning procedure and prevent the internal covariate shift loffe szegedy 2015 therefore the number of convlstm layers is set to four and for each block 16 filters with 3 3 size and stride size 1 are applied the same padding method is utilized to keep the size of outputs equal to the size of the inputs the relu activation function is employed for time efficiency gavahi et al 2021 abbaszadeh et al 2022 in the end the extracted features are entered into a flatten layer a final dense layer with 1024 neurons and a hyperbolic tangent tanh activation function and a dropout layer with 0 5 probability the dropout layer is used as a regularization method that randomly ignores a few neurons to prevent the overfitting problem srivastava et al 2014 2 7 random forest rf the rf method which was proposed by breiman 2001 is used in the current study as a supervised algorithm to downscale the grace derived twsa rf is an integrated machine learning method containing several classification and regression decision trees in this method first the bootstrap algorithm is utilized to randomly select samples from the original data to train the model and the remaining data are used for the testing phase in the next stage for each sample a decision tree is built which has no interaction with each other and then all of the trees are combined into the rf model the final results are the average of the outputs of each tree in this study the grace derived twsa data are used as the target dataset and the inputs are fed into the rf model using a trial and error procedure 1000 regression trees are determined to acquire the best performance previous studies have mentioned that the rf model can lead to high accuracy and good performance in dealing with large data it detects the importance of variables and the interactions between them and the overfitting problem is rarely reported chen et al 2019 2 8 shallow learning feed forward neural network ffnn in the current study ffnn is used as a shallow learning model to downscale the grace derived twsa in iran ffnns are dynamic models that aim to estimate outputs by processing data in three layers including input hidden and output layers each layer contains a set of neurons that are linked to the neurons of the next layer ffnns are suitable for modeling hydrological datasets because this model showed promising performance when dealing with nonlinear problems by extrapolating the relationship between the variables without any prior assumption alipour et al 2020 in this study to use ffnns the data are divided into training 70 testing 15 and validation 15 sets to identify the best model additionally the number of neurons in the hidden layer and the epoch number are determined via trial and error procedures nourani et al 2021 2 9 computation of gws the current study uses in situ wells to validate the downscaling method therefore gwsa should be isolated from the grace derived twsa as the grace derived twsa is a vertically integrated water variable that provides the total water storage anomaly a vertical water model is used to extract the groundwater storage anomalies gwsa to evaluate the downscaled data as follows 4 twsa g w s a s w s a s m s a s w e a where swsa smsa and swea are the surface water storage anomaly soil moisture storage anomaly and snow water equivalent anomaly respectively according to previous studies surface water storage anomalies are negligible in arid and semiarid regions because the twsa is significantly controlled by gwsa and smsa rodell et al 2007 yang et al 2018 skaskevych et al 2020 therefore gwsa can be calculated as 5 gwsa t w s a s m s a s w e a the auxiliary data for smsa and swea in this study are collected from the fldas model 2 10 drought indices grace data are sensitive to changes in tws which includes surface water groundwater and soil moisture indicating that the grace dsi drought index can detect hydrological and agricultural droughts however comparing grace based drought indices with traditional drought indices for the validation period is not a correct approach because traditional drought indices deal with different variables that are differently related to drought hence grace should be used as an independent indicator for drought zargar et al 2011 vishwakarma 2020 the standardized grace derived twsa is calculated as the grace dsi in each 10 km cell for year i ranging from 2002 to 2016 as follows m zhao et al 2017 6 grace d s i i twsa i twsa σ i where twsa and σ i are the mean and standard deviation in year i of twsa respectively the grace dsi is able to detect wet events as well as drought conditions using various categories which are tabulated in table 3 the current study calculates the grace dsi to study drought with high spatial resolution in iran in the next stage the standardized precipitation index spi is used to monitor precipitation based drought maps and their intensity in iran although there are some recently developed drought indices such as the standardized precipitation evapotranspiration index spei the spi is used here because this study is interested in finding only the precipitation based drought conditions in each pixel without considering potential evapotranspiration and temperature impacts selecting the spi helps determine if the reason for the recognized droughts by grace dsi in iran is dominated by precipitation to this end using the data provided by the trmm over iran the spi is calculated following the steps provided by mahmoudi et al 2021 and is categorized as presented in table 4 2 11 evaluation criteria the performance of the clustering phase is evaluated using the silhouette chou davies scd index sharghi et al 2022 7 scd sc 0 5 c s 0 5 d b as seen in equation 17 the scd is a combination of three robust cluster validity measures including sc the silhouette coefficient rousseeuw 1987 db the davies bouldin coefficient davies bouldin 1979 and cs the chou su coefficient chou et al 2004 the maximum value of the scd index suggests the best structure of clusters that a clustering method can yield the sc is a measure of how similar an object is to its own cluster compared to other clusters the sc is calculated using the mean intra cluster distance and the mean nearest cluster distance for each sample the db index is defined as the average similarity measure of each cluster with its most similar cluster where similarity is the ratio of within cluster distances to between cluster distances the cs coefficient is a function of the ratio of the sum of within cluster scatter to between cluster separation to deal with clusters of different densities and or sizes and has a small value for good clustering for more details about the sc db and cs please read rousseeuw 1987 davies and bouldin 1979 chou et al 2004 respectively the evaluation of the modeling in the first phase where the predictors are used to estimate the grace based twsa cm with coarse resolution is performed using root mean square error rmse which denotes the ability to estimate volatility and the determination coefficient r2 which reflects the extent to which the modeling is reliable in addition r2 between the downscaled data and the in situ measurements from wells is used to evaluate the accuracy of downscaled groundwater storage data foroumandi et al 2021 8 rmse i 1 n y i y i 2 n 9 r 2 1 y i y i 2 y i y i 2 where y i and y i are the ground truth value and estimated value by the model at the i th step respectively and y i is the averaged ground truth value 3 results and discussion the current study uses remote sensing images and machine learning methods to downscale grace derived twsa to 10 km spatial resolution in the presented framework first only the remotely sensed images are utilized to demonstrate the applicability of the approach in ungagged or poorly gauged regions then the gng clustering method is used to deal with the nonrectangularity feature of grace pixels which has been rarely considered in previous studies in the next stage the convlstm model is used due to its robustness in modeling sequential images the rf and ffnn models which have been widely used in previous studies to downscale the grace data are also used to further evaluate and compare the results after downscaling the grace derived twsa the annual grace dsi drought maps are produced over iran in addition the gws map is generated to not only evaluate the downscaling procedure but also study the groundwater conditions in iran spi drought maps were also created to analyze meteorological drought in iran 3 1 the clustering the gng method is utilized to cluster the grace pixels with high similarity as the original data are not provided with rectangular shapes the monthly time series for each pixel from 2002 to 2016 is used to investigate the changing patterns the adaptation ability and optimized growth of gng lead to the desired resolution of the clustered pixels the output of the clustering phase is presented in fig 5 based on the scd criteria 297 clusters are obtained as the optimal number of clusters by trial and error procedures in this process the gng model is applied with 100 to 400 clusters and the model with 297 clusters shows the highest scd scd 0 738 and the best performance the clustering method is applied as a preprocessing technique to improve the modeling performance and deal with nonrectangular features of grace twsa data homogenous clusters including highly correlated pixels provide confidence about having the best structure of inputs it is worth mentioning that the raw grace data could affect the accuracy of the downscaling process which is overcome by the preprocessing step neural clustering method of gng 3 2 downscaling in this study we use three statistical models to downscale the monthly twsa provided by the grace mission from april 2002 to december 2016 to understand which model is more accurate to study groundwater with high spatial resolution the results of the model performances are presented in table 5 in the first step the lst ndvi precipitation and dem images are aggregated as mentioned in section 2 5 additionally the sm and swe are used as predictors to model the grace derived twsa with coarse spatial resolution the convlstm rf and ffnn models are designed to capture the relationship between the inputs and outputs with coarse spatial resolution the results table 5 indicate that rf outperforms ffnn in the overall validation of the models with 9 higher r2 in the testing phase and is more reliable to localize the twsa the results of the ffnn model in the training phase are much better than the results in the testing phase with 12 superiority which reveals that the ffnn is overfitted during the training process and it is not able to estimate the twsa in the testing step this may be attributed to a large amount of data in this study with little heterogeneity as the twsa is changing from 18 to 9 with a standard deviation of 5 90 in iran the performance of the convlstm model according to the results in table 4 and fig 6 is shown to be more accurate than the previous models 7 and 18 higher r2 in the testing phase than rf and ffnn respectively it is concluded that the convlstm model is reliable for downscaling grace derived twsa data the convlstm model shows better performance with better evaluation results than the rf and ffnn in both the training and testing phases in general convlstm is successful in modeling the grace derived twsa maps in iran because the structure of the model is able to capture spatiotemporal information in a dataset after training the model to learn the relationship between the inputs and the twsa the difference between the outputs with coarse resolution obtained from the model and the original grace derived twsa is calculated as the residuals the residuals expound on the natural random variations in groundwater that are not demonstrated by the model the residuals are then interpolated to 10 km resolution using the spline interpolation kriging and idw methods the final results provided by the three methods are observed to have a 2 9 average relative change indicating that the interpolation method has no considerable impact on the downscaling procedure the weak sensitivity of modeling twsa on residuals reduces the uncertainty in the downscaling procedure because interpolating the residuals using different techniques could add some biases to the estimation of twsa the predictors with 10 km spatial resolution are then fed into the convlstm model to estimate the twsa maps with fine spatial resolution the final downscaled twsa is generated by adding the interpolated residuals into the twsa data obtained by the convlstm model in addition the observed gwsa by wells is calculated to evaluate the downscaling accuracy the r2 metric between the monthly wells and grace derived gwsa with an average value of 0 76 is presented in fig 6 the proposed methodology is never calibrated with in situ measurements therefore the strong correlation denoted that the downscaled outputs via the presented method are reliable for use in hydrological studies particularly in regions with scarce in situ groundwater observations the modeling performance is also evaluated for each basin using the r2 metric and the results are presented in fig 7 the results ranging from 0 71 to 0 89 indicate that although the model has a good ability to downscale the twsa the worst performances are seen in the khaf hamun mashkil bandarabbas and urmia basins to delve deeper into the main reason for this issue the twsa time series for one point in each of the above mentioned basins are plotted in fig 8 the results indicate that the twsa time series in the basins where the model has shown lower performance are complicated and contain changing patterns the changing patterns and significant variations in data may result in lower performance and less accurate outputs in machine learning based models li et al 2021 3 3 drought analysis over iran iran has faced water resources problems and harmful environmental situations over the years the current study downscaled the grace derived twsa to a 10 km spatial resolution to further investigate water resources problems in the country fig 9 presents grace dsi with 10 km spatial resolution and fig 10 shows the map of the spi drought index with 10 km resolution from 2002 to 2016 the drought classification map extracted from the grace data changes more smoothly than the spi drought classification map in different regions as it provides the total water storage based drought the presented methodology and results can inform water resources managers and stakeholders to deal with drought on a regional scale according to the grace dsi classification map iran experienced near normal conditions in 2002 mostly in the western northwestern northern and southwestern regions fig 9 the drought situation became wetter in 2003 and the country experienced an extremely wet climate in the western and northwestern regions in 2004 in 2005 the situation led to extremely wet conditions in northeast east south and southeast iran and very wet conditions in the northern northwestern and western parts the grace dsi map indicates that in 2006 and 2007 iran passed extremely wet conditions and entered a moderately wet year in most of the regions the grace dsi classification map denotes that iran entered a three year era of near normal conditions from 2008 to 2010 after experiencing five years of wet classes according to grace dsi iran endured moderate drought and abnormal drought conditions starting from 2011 which prolonged to the last year of study 2016 in addition from 2011 to 2016 iran s water crisis became more fatal which ended with exceptional drought in the last year in a few locations and extreme and severe drought conditions in other regions generally the grace dsi drought conditions indicate that iran is in a damaging water resources situation the spi classification map fig 10 shows that in 2002 iran was in moderate and mild drought conditions in most of the regions though in 2003 the country experienced severe drought in the middle portion additionally the spi map indicates moderate severe and extremely wet situations in some of the middle portions of iran in 2004 on the other hand the western region s situation changed from extremely wet to severe drought from 2002 to 2005 although the spi map in 2006 denotes extremely wet and normal situations almost all over iran it was changed to moderate severe and extreme drought in 2007 and 2008 further analysis shows that iran again experienced an extremely wet situation in 2009 which did not persist for the following years in 2010 and 2011 iran was mostly in moderate and severe drought conditions and the northwestern regions experienced extreme drought from 2012 to 2015 the country seemed to be wetter than the previous years although some regions were still in drought unfortunately in 2016 several places in iran were again surrounded by moderate and severe drought conditions the literature shows that the meteorological drought characterized by spi effects changed in different regions of the country until 2019 darand fathi 2021 lotfirad et al 2022 due to its arid and semi arid climate conditions iran has always experienced meteorological drought and its associated tensions the grace dsi classification results denote that iran has entered a deteriorating era of water crisis since 2011 the drought extent percentage over iran acquired by grace dsi is presented in fig 11 a according to this figure from 2002 to 2008 iran experienced almost wet conditions while in 2009 the wet conditions ended and the country returned to normal conditions however for the first time almost 20 of the country had abnormally dry conditions the onset of the moderate drought was in 2010 which extended all over the country by 2014 it is worth mentioning that in 2011 approximately 90 of iran was in a dry situation the severe drought that started in 2012 extended to 40 of iran by 2016 the findings of this section are in alignment with a few studies that reported groundwater depletion all over iran which has been extended to recent years in some regions e g amini and hesami 2017 vaheddoost and aksoy 2018 khorrami and malekmohammadi 2021 according to the spi classification iran has been experiencing meteorological droughts in different regions however some extremely wet years are also seen the drought extent over iran acquired by the spi is shown in fig 11b although a drought extent of 30 75 was seen over iran from 2002 to 2011 except for 2006 and 2009 which were 15 and 10 respectively 20 30 of the country was wet and the remaining was in normal condition since 2011 the meteorological drought extent has decreased while for the same period grace dsi reveals continuing severe pressure on iran s water resources these results show that the main reason for the water crisis in iran is not meteorological drought previous studies in different regions of iran indicated that agricultural activities have expanded over the last decades increasing water demand in the northern part of iran industrial and agricultural activities have increased by approximately 70 and almost 250 million us dezhkam et al 2014 badamfirooz and mousazadeh 2019 barzegar et al 2018 and foroumandi et al 2021 reported that agricultural activities in the northwestern regions of iran especially in the lake urmia basin as one of the most important basins in iran are rapidly growing in the south southwestern and western regions increasing agricultural and irrigation activities have been reported especially in kurdistan province located in western iran e g razavi 2014 malmir et al 2015 zandi et al 2017 nourani et al 2022 however the water demand cannot be met by precipitation alone due to significant agricultural expansion foroumandi et al 2022 the change detection map the difference between the first and last years for the gws with a 10 km resolution is presented in fig 12 the results show that groundwater resources are used for irrigation and increasing agricultural activities in the country which have led to groundwater depletion all over iran particularly in the northern and northwestern regions the current study presents an analysis of iran s water resources using the proposed downscaling method until 2016 the time series for the twsa data of grace grids that cover the gharesu gorgan and aras basins from january 2017 to march 2021 were collected from the related organiazations and are plotted in fig 13 a and fig 13b respectively in addition the time series for one observation well in the gharesu gorgan basin and two observation wells in the aras basin are plotted in fig 13c fig 13d and fig 13e the area averaged time series of twsa from january 2017 to february 2022 were also extracted employing the tools provided by nasa jpl https jpl nasa gov and the results are provided in fig 13f it is noted that there is a data gap in twsa between july 2017 and may 2018 due to the temporal gap between grace and grace fo missions velicogna et al 2020 fig 13 indicates that after 2016 the decreasing trend in grace derived twsa and in situ gwl continues in different basins of iran additionally the area averaged time series of the twsa in iran fig 13e shows that the water resources problem becomes more hazardous in the country which is consistent with the literature lotfirad et al 2022 vaheddoost and aksoy 2018 khorrami and malekmohammadi 2021 although the negative trend in the twsa time series of the aras basin is more remarkable than that in the gharesu gorgan basin the gwl of the observation well in gharesu gorgan shows a more severe decreasing trend additionally for two in situ gwl measurements in the aras basin fig 13c shows a positive trend but fig 13e shows a marginally negative trend while both wells are located in the same pixel of grace therefore grace data downscaling is necessary to study different regions generally the decreasing trend until 2022 in twsa and gwl reveals that water resources problems in iran have not been managed properly and still threaten the environment and people the current study denotes that iran s water crisis is heavily influenced by anthropogenic factors imposed by excessive groundwater withdrawal for agricultural and human induced activities while meteorological drought is a trigger and intensifier for depletion previous studies used the term groundwater overexploitation when the amount of abstraction is greater than the total amount of recharge while it can be misleading as human activities and aquifer development may affect the data custodio 2002 using grace dsi the current study defines the term water resources overexploitation for iran which can be defined as when the total amount of water output from the system exceeds or is close to the input water rate for several years the results indicate that the reason for water resources overexploitation in iran is aggressive water withdrawal for food production and irrigation water scarcity is not the only problem caused by water resources overexploitation in iran as previous studies have reported various country wide environmental problems including but not limited to soil salinity and land subsidence e g fathizad et al 2020 babaee et al 2020 4 conclusion the current study uses remote sensing tools clustering techniques and deep learning to downscale grace derived twsa in iran a data poor country with several water related problems the gng method is utilized to find the native grace pixels and the performance of gng is evaluated by the scd criteria then the convlstm ffnn and rf methods are used to estimate the twsa at a fine spatial resolution the proposed methodology can be used to systematically downscale grace derived twsa to 10 km spatial resolution providing grace data with a fine spatial resolution is of great importance since it is one of the main sources for studying groundwater and total water storage especially in regions with sparse ground observations the results indicate that the convlstm outperforms the rf and ffnn models and is successful in downscaling the grace data and in generating groundwater storage maps in iran the generated gwsa data are validated by the in situ gwsa measurements provided by observation wells although the method is accurate enough to study gwl trends and drought there is still a source of uncertainty as there are no reliable data for surface water in iran the current study ignores the contribution of surface water resources when using auxiliary data to isolate the groundwater value this study also investigates other hydrological variables and drought maps to gain insight into the water resources problems in iran the outputs of this study can be used to make specific decisions regarding water resources and groundwater management on a regional scale groundwater resources are crucial in the national water security of iran as they provide 60 of fresh water in the country saatsaz 2020 the current study denotes that iran has experienced long term drought since 2010 while some regions have experienced exceptional drought conditions additionally the gws decreased all over iran from 2002 to 2016 in addition the annual spi maps are generated and the results reveal that meteorological drought is a trigger for iran s water crisis although not the main reason according to the results of this study which are in agreement with previous studies the agricultural expansion in iran with excessive groundwater withdrawal is the main reason for iran s water resources problem which is mentioned here as water resources overexploitation further analysis indicates that the problem will continues up to 2022 one of the limitations of this study is the inaccessibility of ground based crop type classification data which halts further investigation of the details of the impacts of agricultural activities on water resources and specifically groundwater resources future studies may consider investigating agricultural activities and studying water resources problems after 2016 in more detail using other drought indices including the spei and surveying meteorological time series are useful to study water resources and investigate the main reasons for water related issues as the growing water demand in iran has coincided with environmental problems the water scarcity warns that iran needs integrated sustainable water resources management at both the national and regional levels to update the water supply networks improve irrigation efficiency and regulate appropriate strategies in the agriculture sector and cultural awareness declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2599,accurate prediction of groundwater level gwl over a period of time is of great importance for groundwater resources management machine learning techniques due to their great performance have recently been used for this problem previous methods however did not consider the spatial relationships between wells due to the difficulty to handle unstructured well location data in this paper a graph neural network gnn is used to forecast groundwater dynamics where it can represent each well as a node in the graph the spatial information is thus extracted from an interconnected network using graph convolution layers with a self adaptive adjacency matrix the temporal features of the sequence are obtained by gated temporal convolutional networks the model was applied and evaluated for wells in the southwest area of british colombia in canada using data about 11 years 2010 2020 the proposed model performs better in terms of all the defined evaluation metrics when compared with two baseline models long short term memory lstm and gated recurrent units gru moreover when the spatial dependencies are completely unknown the model can still learn them from the data and obtain comparable performance furthermore the proposed model has a high efficiency since it can simultaneously model gwl change for all monitoring wells in the system we also demonstrated that the spatial dependencies between each well could be intuitively interpreted from the learned adjacency matrix keywords graph neural network groundwater level graph wavenet deep learning hydrology data availability data will be made available on request 1 introduction groundwater is one of the essential resources for agricultural irrigation drinking and industrial production megdal et al 2015 in recent years however exploitation and utilization of groundwater becomes more intensive due to climate change e g extreme droughts aslam et al 2018 population growth famiglietti 2014 and rapid urbanization minnig et al 2018 which have severely impacted its availability as such the ability to predict groundwater level gwl plays a significant role in sustainable groundwater resource planning and management creating an accurate gwl model is complex and highly nonlinear in nature since its fluctuations are controlled by various factors such as hydrology e g groundwater recharge and discharge rate meteorology e g atmospheric pressure precipitation and temperature and human activities e g land cover change and reservoir operations dudley et al 2018 sahoo et al 2017 shiri et al 2013 different methods including conceptual physical numerical and statistical models have been proposed to model and predict gwl physical based gwl models can simulate the physical process of water movement and predict its spatiotemporal distribution in a predefined domain brenner et al 2018 chen et al 2021 long et al 2020 yao et al 2015 yousefi et al 2019 zhang et al 2018 generally this approach requires a large number of parameters to define the underlying mechanisms and characterize the study area it is also expensive and time consuming to accurately quantify those parameters through fieldwork and experiments as a consequence the uncertainty resulting from the limited data availability poses challenges for the process of model calibration and validation furthermore the computational burden of numerically solving the governing equations is another concern as it may take several days to obtain reliable predictions although data assimilation approaches can reduce this uncertainty by combining knowledge from model predictions and observations their applications have been limited due to their complex implementation and intensive computation demands yin et al 2020 traditional statistical methods like autoregressive moving average and autoregressive integrated moving average have also been used to simulate groundwater resources ferdowsian and pannell 2009 tankersley et al 1993 von asmuth et al 2008 but those methods do not consider non stationarity and nonlinear characteristics of the gwl data in contrast data driven and machine learning methods can model groundwater dynamics even without knowledge of the underlying physical process those methods can capture the nonlinear relations between the input and target variables and identify the inherent patterns concealed in the time series data cerqueira et al 2019 given this capacity these methods have been widely used in hydrology bai and tahmasebi 2022 jiang et al 2021 mo et al 2020 2019 geoscience bai and tahmasebi 2021a 2021b and climate kurth et al 2019 rasp et al 2018 due to their high computational efficiency moreover the appearance of physics informed neural networks even enables the model to explicitly follow the governing equations that constrain the physical process bai and tahmasebi 2021b kamrava et al 2021 raissi et al 2019 various machine learning models have been applied for gwl modeling including artificial neural networks ann daliakopoulos et al 2005 jeihouni et al 2019 nourani et al 2015 2008 adaptive neuro fuzzy inference systems anfis emamgholizadeh et al 2014 maiti and tiwari 2014 moosavi et al 2013 genetic programming fallah mehdipour et al 2013 kasiviswanathan et al 2016 sadat noori et al 2020 support vector machine ebrahimi and rajaee 2017 liu et al 2009 tang et al 2019 yoon et al 2016 support vector regression guzmán et al 2018 he et al 2020 mirarabi et al 2019 random forest wang et al 2018 nonlinear autoregressive with exogenous inputs neural network di nunno and granata 2020 guzman et al 2017 wunsch et al 2018 convolutional neural network cnn wunsch et al 2021 temporal convolutional network zhang et al 2022 recurrent neural network jeong et al 2020 gated recurrent unit gru cai et al 2021 and long short term memory lstm neural networks vu et al 2021 wu et al 2021 a more comprehensive review about applications of machine learning models for gwl modeling can be found elsewhere rajaee et al 2019 overall these models have demonstrated a comparable or even better performance compared to the results obtained from the numerical models despite of the significant progress in the field of machine learning for gwl modeling it should be noted that the previously proposed data driven methods neglected the spatial relationship in the gwl data since the distribution of monitoring wells usually is irregular in space and thus traditional machine learning models cannot easily handle unstructured irregular data specifically traditional models like ann and anfis usually use several time step history records of hydrological and climatic variables to predict gwl which means the required number of input nodes is directly proportional to the number of variables and number of time steps considered although the coordinates of wells can be incorporated into the input variables it can significantly increase the number of training parameters and the model actually cannot learn the spatial relationship between each well on the other hand we can concatenate the time series data of all wells as a 2d space time image and process it with cnn based model but the unstructured spatial relationship cannot be captured due to the limited reception field of filters gru and lstm show superiority in dealing with long time series data but they do not provide the interface to receive spatial information to deal with such data and when there is a spatial dependency among them therefore graph neural networks gnns have been developed to extract the spatiotemporal patterns from the data with complex structures scarselli et al 2009 constructed the theoretical basis of gnns based on the conceptual model proposed by gori et al 2005 in gnns each object within the unstructured data is represented as a node and each node connects with a different number of unordered neighboring nodes to exchange information researchers have successfully applied gnns to solve problems in different fields including chemistry wieder et al 2020 geoscience hillier et al 2021 and intelligent transportation problems wang et al 2020 in the aspect of hydrological modeling sun et al 2021 compared the performance of different variants of gnns in predicting streamflow and obtained similar or even better performance as compared to lstm but there is no study on the application of gnns in gwl prediction the aim of this study is therefore to evaluate the feasibility of gnns for simultaneous modeling of a groundwater network with multiple monitoring wells in this paper a self adaptive gnn is used to simulate seasonal groundwater level change it includes stacked graph convolution layers to enable the adjacency matrix to be adaptively learned from the data and stacked dilated causal convolution layers to capture temporal dependencies of long sequences the developed model is applied to a gwl dataset consisting of 41 wells mainly located in the southwest british columbia province of canada the results are compared with two different machine learning models including gru and lstm which are well known for extracting patterns from sequential data and are widely used for hydrological modeling cai et al 2021 vu et al 2021 both visual and statistical comparison shows that gnn outperforms baseline models we also demonstrated that the spatial dependencies between each well could be intuitively interpreted from the learned adjacency matrix 2 study area and data to evaluate the effectiveness and efficiency of the proposed gnn for the prediction of gwl change it was tested on a set of data collected from the provincial groundwater observation well network gown of british columbia bc the gown currently includes 226 active observation wells and most of them were completed in different shallow aquifers to monitor gwls and water quality in this study we focus on the observation wells on the southwest side of bc which are mainly located at two sites vancouver island and the lower mainland area of bc most of the monitoring wells included in the dataset have continuous hourly measurements from 2010 to 2020 however these hourly data are quite noisy due to systematic and random errors during measurements the average weekly groundwater level thus was calculated and used as the target variable to predict the wells with the largest data gap of more than one month were not considered while the wells with smaller gaps were interpolated using a spline method to preserve the temporal pattern although it is possible to preprocess the former through the same way the obtained interpolation is too smooth considering such a large data gap this can prevent the proposed model to learn the short term variation of gwl for other wells as it treats all the monitoring wells as a whole and makes predictions simultaneously therefore the gwl data from 2010 to 2020 for 41 monitoring wells were acquired where 76 of them are on vancouver island and the rest in the lower mainland area of bc the depth of selected wells ranges from 24 ft to 830 ft with an average depth of 152 6 ft below ground level bgl all of them have stainless steel casing with diameters ranging from 6 in to 10 in the spatial distribution of these wells is shown in fig 1 the vancouver island is a mountainous island with a geographical extent of 31 285 km2 it has a mild climate with warm dry summers and mild wet winters the western region is significantly wetter than the eastern region due to the vancouver island ranges located near its center where the precipitation ranges from 608 mm to 6 650 mm and is concentrated in the autumn and winter the lower mainland area of bc locates on the southwestern tip of the mainland which covers a surface of 36 303 km2 as fig 2 shows the rain is most frequent in the period from november to march while the summer months are typically dry it has a moderate oceanic climate the temperature in winter is quite mild with a maximum temperature of 8 c while summer has the highest temperature but the maximum temperature generally is below 30 c the groundwater systems in the study area are mainly rainfall dominated and the gwl fluctuations show high seasonality allen et al 2014 on the other hand climate change is expected to accelerate the hydrological cycle through its effect on air temperature precipitation and evapotranspiration chaouche et al 2010 variation of these climate parameters is also likely to affect groundwater recharge smerdon 2017 and interaction between groundwater and surface water scibek et al 2007 therefore grided estimation of daily weather and climate variables was also extracted from daymet thornton et al 2012 and used as part of the inputs which include minimum and maximum temperature precipitation vapor pressure shortwave radiation and day length 3 methods in this study graph wavenet wu et al 2019 as a variation of gnns is applied to simultaneously predict future gwl for all monitoring wells in the groundwater network giving their historical record each well can be represented as a node in the graph and the available gwl data and other ancillary information like hydrological and climatic data are represented as node features during the phase of prediction each well can automatically and selectively aggregate information available at its own node and its neighbors in this section we first give a brief introduction of gnn and mathematically define our problem within this framework next we describe the network structure of graph wavenet which consists of two main building blocks graph convolutional layer gcl and gated temporal convolutional networks tcns finally we introduce the experimental setup evaluation metrics and two baseline models for comparison 3 1 graph neural network gnn can extract non euclidean information from the data represented as graphs as fig 3 shows a graph g v e includes two basic elements a set of nodes v v i i 1 n and a set of edges e e ij where n is the number of nodes in the graph and e ij denotes the edge connecting node pairs v i v j all nodes connected to node v forms its neighborhood n v u v v u e the proximities between any two nodes could be described by the adjacency matrix a r n n which could be calculated based on the prior knowledge like spatial distance randic et al 2010 or functional similarity dahl et al 2013 wang et al 2021 for a finite simple graph the adjacency matrix is a binary matrix where a ij 1 if e ij e and 0 otherwise the symmetry of adjacency matrix also represents the directional dependencies between nodes where a symmetric matrix denotes an undirected graph while a non symmetric matrix for undirected graph the number of neighbors of each node is described by the graph degree matrix d r n n where d ij j a ij if i j and 0 otherwise each node v has an associated feature vector x v r d where d is the total number of features the feature vectors of all nodes form the graph feature matrix x r n d for the problem of spatiotemporal prediction with gnn the node features could change with time assuming each node has the record of d features for t time steps the dataset for n nodes can be represented as a three dimensional tensor x t r n t d in our case each monitoring well could be represented as a node all wells are linked through the hydrological cycle and the connection between wells could be represented by the edge therefore the groundwater network in study area can be described by a graph and the connection between any two wells is quantitatively described by the adjacency matrix the node features include the gwl data and other hydrological and climatic data mentioned in section 2 given the above definitions the gwl prediction problem in this study is cast as a one step ahead forecasting problem given a graph g and s time steps historical record of all features x t s 1 x t our aim is to simultaneously predict gwl at the next m time steps x t 1 x t m for all nodes wells which could be mathematically described as 1 x t s 1 x t g f x t 1 x t m where f r n s d r n m d is the mapping function to be learned 3 2 graph wavenet graph wavenet has shown promising results for spatiotemporal graph modeling fig 4 shows the network structure of graph wavenet where the main working modulus are graph convolution layer and gated temporal convolution network the graph convolution layer includes a self adaptive adjacency matrix which does not require any prior knowledge of the spatial dependencies between each node and can learn it from the data in an end to end manner 3 2 1 graph convolution layer graph convolution is our main approach to extract spatial information from graph data different graph convolution based models have been proposed which could be classified into two categories spectral and spatial based models spectral based models implement the graph convolution with the filters introduced from the domain of graph signal processing and characterize the graph s properties with its normalized laplacian matrix ma et al 2019 spatial based models on the other hand aggregate features from neighbors by convolving themselves with surrounding nodes which is similar to the mechanism of convolutional neural networks cnns yan et al 2018 graph convolutional networks gcns one type of spatial based models and proposed by kipf and welling 2016 uses the first order approximation of chebyshev polynomials to simplify the spectral based graph convolution and aggregates node features with the help of the graph adjacency matrix for a one layer gcn the feature matrix is updated according to the following rule 2 h 1 σ a x w a d 1 2 a d 1 2 a a i n where x r n d is the initial feature matrix w r d k is the matrix of filter parameters h 1 r n k is the updated feature matrix d is the graph degree matrix of a i n is an n dimensional identity matrix and σ is an activation function to add nonlinearity a a i n is the adjacency matrix with self connection the aim of original model is to predict labels for all nodes given partially labeled nodes therefore an identity matrix is added up to the original adjacency matrix i e a self connection is added to aggregate features of the node itself and its neighbors for training stability a is normalized by d to obtain a multiple graph convolution layers can be stacked in a hierarchical manner to extract higher order information from neighbors diffusion convolutional neural networks dcnns developed by atwood and towsley 2016 implement the spatial based graph convolution as a diffusion process compared to gcns dcnns has proven to be more effective in spatial temporal modeling li et al 2017 it updates node features by transferring information from each node to its neighboring nodes until the equilibrium of information distribution is achieved after several diffusion steps the probability of information transition between any two nodes is defined by the probability transition matrix p r n n the diffusion convolution operation for the k th diffusion step is defined as 3 h k w k p k x p a r o w s u m a where is the elementwise multiplication w k r n d is the learnable transformation matrix for the k th diffusion step p k denotes the power k of the probability transition matrix and h k r n d is the features aggregated from k hop neighbors the k hop neighbors of a node v i include all nodes at a distance less than or equal to k from v i for a diffusion process with a finite number of steps the final output can be generalized to a summation of the output from each diffusion step li et al 2017 wu et al 2019 4 h k 0 k p k x w k in recent years spatial based models have been used more widely due to their efficiency and flexibility as compared to spectral based models heidari et al 2022 therefore dcnns is selected as the main working module of the graph convolution layer 3 2 2 self adaptive adjacency matrix traditional gnns learned the graph data based on a static adjacency matrix which was calculated from available physical measurements like spatial distance or connectivity however a predefined adjacency matrix may not be sufficient to capture the spatial dependencies between each pair of nodes since the selection of available measurements is inevitably subjective a dynamic adjacency matrix could also be constructed by using an attention mechanism xie et al 2021 or parametrization of graph structure shi et al 2019 in graph wavenet a self adaptive adjacency matrix a a d p r n n is proposed to learn the latent spatial dependencies from data in an end to end manner 5 a a d p s o f t m a x r e l u e 1 e 2 t clearly it is computationally expensive to directly learn this self adaptive adjacency matrix when the number of considered nodes is huge therefore two embedding matrices e 1 e 2 r n c are used to represent the spatial dependencies between input feature matrix x and updated feature matrix h which can efficiently reduce the number of training parameters from n n to 2 n c c n while some proximity measures defined on the graph can be retained goyal and ferrara 2018 similar to the calculation of node similarity nikolic 2012 the spatial dependencies between input feature matrix and the updated one are derived by multiplying these two embeddings next a relu activation function is used to remove weak connections and a softmax activation function for normalization graph wavenet uses spatial based graph convolution and the proposed self adaptive adjacency matrix can also work as a probability transition matrix thus when the graph structure is available the predefined spatial dependencies is combined with the self learned hidden one and the graph convolution layer gcl of graph wavenet is then defined as 6 h k 0 k p k x w k a a d p k x w a d p it should be noted that only the last term of eq 6 is retained when the graph structure is unknown 3 2 3 temporal convolution layer in graph wavenet temporal convolutional networks tcns are used to extract temporal features from nodes the main operation is dilated causal convolution yu and koltun 2015 which works similarly as the cnn but neglects a fixed number of values when the 1d filter slides over the input sequence mathematically it is defined as 7 x f t s 0 k 1 f s x t d s where x r t is a 1d input sequence f r k denotes the filter with size of k d is the dilation factor determining the skip distance fig 5 shows the stacked dilated causal convolution layers with a fixed kernel size of 2 and dilation factors of 1 2 4 8 the introduction of the dilation factor allows the receptive field to be expanded exponentially with the increase of layer depth it can be seen that the receptive fields of the last three dilated causal convolution layers are even larger than the size of kernel in this way a longer sequence could be processed with fewer layers and less computation burden moreover a gating mechanism was also applied to control information flow within tcns 8 h tanh t c n a x σ t c n b x where tanh is tangent hyperbolic activation function σ is sigmoid activation function and t c n a b are two tcns t c n a is mainly used to capture temporal features while t c n b is for controlling the ratio of information passed via the sigmoid function 3 2 4 graph wavenet architecture during each iteration graph wavenet processes a single batch data x b r b d n l with a batch size of b and a sequence length of l the operation of 1 1 convolution is first applied to extract abstract local features as fig 4 shows the main working module of graph wavenet includes multiple stacked spatial temporal layers in each layer the inputs pass through a gated tcn followed by a gcl the output h from gated tcn is a four dimensional tensor with size of b c n l where c is the dimension of learned hidden temporal pattern a residual connection is also added between inputs and outputs to accelerate model convergence he et al 2016 the output of each spatial temporal layer is summed by the skip connections and then processed by two groups of relu activation function and 1 1 convolutional layer these spatial temporal layers can capture temporal information at different scales by changing the dilation factor for example the first layer captures short term temporal features while the last layer captures long term temporal features it should be noted that the final output h o r l n from graph wavenet can predict future gwl for l time steps at once i e the length of input sequence the goal of this paper is to predict gwl for m future time steps x m r n m d given its s time steps historical record x s r n s d the mean absolute error mae is used to train the graph wavenet and it can be expressed as 9 l x m θ 1 mnd i 1 m j 1 n k 1 d x mjk t i x mjk t i where θ is model parameters to be trained 3 3 experimental setup the gwl data was normalized with its mean and standard deviation and then was chronologically split into training validation and testing datasets with a ratio of 0 60 0 15 0 25 the training dataset corresponds to the period from january 2010 to july 2016 and the validation set corresponds to the period from august 2016 to march 2018 the rest data was used for testing the performance of trained model in our study we considered two kinds of graph wavenet when there is some known information about the spatial relationship a predefined adjacency matrix could be obtained and combined with the self adaptive one which is denoted as gwn in our case the predefined adjacency matrix was calculated based on the distance of any pair of monitoring wells and then was converted to a sparse matrix by threshold gaussian kernel shuman et al 2013 with a threshold of 0 2 otherwise only the self adaptive adjacency matrix is used to automatically learn the spatial dependencies from the data which is denoted as gwn adaptive in both cases eight spatial temporal layers were stacked to construct graph wavenet with the dilation factors set as 1 2 1 2 1 2 1 2 the number of diffusion steps k was set as 2 and fixed for each layer the dimension of node embedding was set as 10 a dropout layer with a rate of 0 5 was added after gcl finally the model was optimized by adam kingma and ba 2015 with a learning rate of 0 001 and was trained for 100 epochs with a batch size of 16 the graph wavenet was implemented with pytorch paszke et al 2019 and trained with an nvidia tesla t4 gpu graph wavenet was compared with two baseline models including lstm and gru these two models are improvements of rnn which can learn long term dependency from time sequence while avoiding the gradient vanishing problem hochreiter and schmidhuber 1997 compared to lstm gru is less complex since it has one less gate to control information flow both of them have been used for groundwater modeling cai et al 2021 wu et al 2021 a more detailed introduction about their mathematical definition and working mechanisms could be found in salem 2022 it should be noted that in our case we trained the model of lstm and gru for each monitoring well separately since their application was mainly focused on a single well instead of the monitoring well network the following hyperparameters were considered for these two models the number of hidden layers 1 2 and the number of neurons in each hidden layer 8 16 32 since they were trained with the data from only one well the model complexity was restricted to avoid overfitting moreover an l2 regularizer with a regularization factor of 0 001 was added to each layer adam was applied to minimize the mean squared error mse for lstm while rmsprop was used to minimize the mae for gru the hyperparameters were tuned based on the performance of the validation dataset and the selected best model has the lowest error the performance of each model was evaluated on the testing dataset and compared based on root mean squared error rmse mean absolute percentage error mape which can be calculated as 10 r m s e i 1 m j 1 n k 1 d x mjk t i x mjk t i 2 mnd 11 mape 1 mnd i 1 m j 1 n k 1 d x mjk t i x mjk t i x mjk t i and mae 4 results and discussion table 1 summarizes the performance of two kinds of graph wavenet and two baseline models the gwn outperformed gwn adaptive lstm and gru in terms of all defined evaluation metrics in particular the performance of gwn adaptive was comparable to other two baseline models which indicated that to some extent the self adaptive adjacency matrix can learn the spatial dependencies from the data gru obtained better results compared to lstm in our case we trained these two baseline models for each monitoring well separately and gru has a lower model complexity and fewer training parameters therefore it performed better even when trained with a relatively small dataset on the other hand it should be noted that compared to these two baseline models graph wavenet was more efficient in terms of computational cost since graph wavenet can treat the monitoring well network as a whole the training process was performed only once and the trained model can simultaneously predict future gwl for all wells in contrast the model structure of lstm and gru must be optimized for each monitoring well thus the total computational time is proportional to the number of wells and the number of possible combinations of predefined hyperparameter options the performance of these two baseline models could be improved further by expanding the search range of considered hyperparameters but at the expense of longer computational time to further compare the performance of graph wavenet with other two baseline models fig 6 shows the observation and prediction from two randomly selected monitoring wells where each well is assumed to have the same probability of being selected variation of gwl in these two wells shows different characteristics the variational trend in the first well is more abrupt with sharp peaks while the second well has a softer variation tendency but with a larger amplitude all four models can capture the seasonality of gwl change in these two wells both gwn and gwn adaptive however outperformed the other two baseline models due to relatively smaller shifts of its predictions from the observations since we restricted the model complexity of baseline models caused by limited available data of each well the predicted curves were smoothed out for capturing the general variational trend of gwl and neglecting some short term changing details we also noted that there were some delays between the predictions of two kinds of graph wavenet and observations as the groundwater system in the study area is rainfall dominated and the flow rate of water in the underground layers is relatively slow the response of groundwater to external signals may exhibit a delay effect considering precipitation being one of the input variables the absolute prediction error of each well at any single future time step is calculated for each model and the corresponding histogram is compared in fig 7 it can be seen that the performance of gwn is more desirable than that of other models as its histogram has a higher peak height at the absolute error of approximately zero to make a more quantitative comparison table 2 lists the statistics of absolute prediction error depending on the applied model from the table it is found that gwn has the lowest mean and median absolute error 0 6736 m and 0 3601 m and smallest interquartile range iqr q3 q1 it is worth noting that the performance of gwn adaptive is still comparable to other two baseline models in terms of the mean and median absolute error and interquartile range which again confirms its effectiveness in automatically capturing the spatial dependencies from data the mae scattered maps of all monitoring wells are shown in fig 8 for different models in the area of the northeast coast of vancouver island and lower mainland all models performed well with small mae in comparison all models show relatively large errors for some wells in the dashed box this region has been enlarged for better illustration as can be seen most monitoring wells in this region were located on some small islands which were quite close to the southeast coast of vancouver island such a geographical condition complicates the hydrological cycle and the used input variable thus may not be enough to capture this complex relationship we also indicated the best and worst fit wells with red arrow and blue dashed arrow correspondingly in fig 8 as can be seen they were mostly located within the dashed box even when predicted with different models which verified the high complexity of hydrological cycle in this region a more quantitative measurement of the goodness of each model is shown in fig 9 with the boxplot of mae for all models gwn performed better with the lowest median metric value and interquartile range moreover it has the smallest range which is possibly due to its ability to simultaneously model all the monitoring wells in the system and the given predefined spatial dependencies on the other hand since we trained lstm and gru for each well separately the hyperparameter tuning process had a large effect on the final prediction error therefore any inappropriate hyperparameter selection could increase the range of the distribution of mae fig 10 provides an intuitive interpretation of the learned spatial dependencies between each well graph wavenet randomly initialized the self adaptive adjacency matrix a adp and learned it from the data in an end to end manner this self adaptive adjacency matrix can explore the hidden spatial dependency between nodes or wells in our case each entry a a d p ij of the self adaptive adjacency matrix denotes the relative importance of the jth well in improving gwl forecasting for the ith well for example it can be seen that there is a strong interdependence between well pairs 6 24 3 22 8 32 18 40 for their high values in the heatmap moreover the range of influence for a single well could also be derived from this map for instance column 19 has more high value points compared to column 1 which means comparatively well 19 is more influential than other wells 5 conclusion in this study graph wavenet was used to predict gwl change over a long term period different from traditional machine learning models this model can incorporate unstructured well location data into the learning process to consider the spatial association between wells the ability of the proposed model for gwl forecasting was evaluated and discussed for the data obtained from the groundwater observation well network of british colombia in canada in addition the proposed model was compared with lstm and gru the proposed model outperformed two baseline models in terms of mae rmse and mape on the testing dataset our comparison showed that predictions from graph wavenet have relatively smaller shifts from observations and can capture short term changing details moreover graph wavenet was more efficient by treating all the monitoring wells in the system as a whole and the boxplots indicated that this mechanism could narrow the range of distribution of mae for each well finally the learned adjacency matrix could intuitively provide the interdependence between each pair of wells and the influential range of a single well the spatial dependencies between wells were represented by two components the predefined adjacency matrix and the self adaptive one available information of the spatial relationship for example physical measurements like distance and connectivity could be incorporated into the former however it may not be sufficient to cover all the valuable information considering the high complexity of hydrological cycle the latter was added to represent other underlying spatial relationship when the spatial dependencies were completely unknown the model was trained only with the self adaptive adjacency matrix the conducted experiments demonstrated that the model can automatically learn the spatial dependencies from the data in an end to end manner and the obtained performance was comparable to other two baseline models but with less computational burden as limitations the proposed model showed some weakness of learning the spatial dependencies for wells located in a complex geographical environment for example a group of small closely packed islands a potential solution is to incorporate more hydrological and climatic information into the input variables for better capturing such a complex hydrological cycle on the other hand when a new monitoring well is added to the network for forecasting the proposed model must be re trained as the adjacency matrix needs to be updated to consider the spatial dependencies on the new well however it is still computationally cheap considering the relatively short training time of roughly ten minutes finally an important direction for future work is to test the capability of proposed model on the dataset showing weak seasonality or covering a wider geographical area credit authorship contribution statement tao bai methodology pejman tahmasebi conceptualization supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2599,accurate prediction of groundwater level gwl over a period of time is of great importance for groundwater resources management machine learning techniques due to their great performance have recently been used for this problem previous methods however did not consider the spatial relationships between wells due to the difficulty to handle unstructured well location data in this paper a graph neural network gnn is used to forecast groundwater dynamics where it can represent each well as a node in the graph the spatial information is thus extracted from an interconnected network using graph convolution layers with a self adaptive adjacency matrix the temporal features of the sequence are obtained by gated temporal convolutional networks the model was applied and evaluated for wells in the southwest area of british colombia in canada using data about 11 years 2010 2020 the proposed model performs better in terms of all the defined evaluation metrics when compared with two baseline models long short term memory lstm and gated recurrent units gru moreover when the spatial dependencies are completely unknown the model can still learn them from the data and obtain comparable performance furthermore the proposed model has a high efficiency since it can simultaneously model gwl change for all monitoring wells in the system we also demonstrated that the spatial dependencies between each well could be intuitively interpreted from the learned adjacency matrix keywords graph neural network groundwater level graph wavenet deep learning hydrology data availability data will be made available on request 1 introduction groundwater is one of the essential resources for agricultural irrigation drinking and industrial production megdal et al 2015 in recent years however exploitation and utilization of groundwater becomes more intensive due to climate change e g extreme droughts aslam et al 2018 population growth famiglietti 2014 and rapid urbanization minnig et al 2018 which have severely impacted its availability as such the ability to predict groundwater level gwl plays a significant role in sustainable groundwater resource planning and management creating an accurate gwl model is complex and highly nonlinear in nature since its fluctuations are controlled by various factors such as hydrology e g groundwater recharge and discharge rate meteorology e g atmospheric pressure precipitation and temperature and human activities e g land cover change and reservoir operations dudley et al 2018 sahoo et al 2017 shiri et al 2013 different methods including conceptual physical numerical and statistical models have been proposed to model and predict gwl physical based gwl models can simulate the physical process of water movement and predict its spatiotemporal distribution in a predefined domain brenner et al 2018 chen et al 2021 long et al 2020 yao et al 2015 yousefi et al 2019 zhang et al 2018 generally this approach requires a large number of parameters to define the underlying mechanisms and characterize the study area it is also expensive and time consuming to accurately quantify those parameters through fieldwork and experiments as a consequence the uncertainty resulting from the limited data availability poses challenges for the process of model calibration and validation furthermore the computational burden of numerically solving the governing equations is another concern as it may take several days to obtain reliable predictions although data assimilation approaches can reduce this uncertainty by combining knowledge from model predictions and observations their applications have been limited due to their complex implementation and intensive computation demands yin et al 2020 traditional statistical methods like autoregressive moving average and autoregressive integrated moving average have also been used to simulate groundwater resources ferdowsian and pannell 2009 tankersley et al 1993 von asmuth et al 2008 but those methods do not consider non stationarity and nonlinear characteristics of the gwl data in contrast data driven and machine learning methods can model groundwater dynamics even without knowledge of the underlying physical process those methods can capture the nonlinear relations between the input and target variables and identify the inherent patterns concealed in the time series data cerqueira et al 2019 given this capacity these methods have been widely used in hydrology bai and tahmasebi 2022 jiang et al 2021 mo et al 2020 2019 geoscience bai and tahmasebi 2021a 2021b and climate kurth et al 2019 rasp et al 2018 due to their high computational efficiency moreover the appearance of physics informed neural networks even enables the model to explicitly follow the governing equations that constrain the physical process bai and tahmasebi 2021b kamrava et al 2021 raissi et al 2019 various machine learning models have been applied for gwl modeling including artificial neural networks ann daliakopoulos et al 2005 jeihouni et al 2019 nourani et al 2015 2008 adaptive neuro fuzzy inference systems anfis emamgholizadeh et al 2014 maiti and tiwari 2014 moosavi et al 2013 genetic programming fallah mehdipour et al 2013 kasiviswanathan et al 2016 sadat noori et al 2020 support vector machine ebrahimi and rajaee 2017 liu et al 2009 tang et al 2019 yoon et al 2016 support vector regression guzmán et al 2018 he et al 2020 mirarabi et al 2019 random forest wang et al 2018 nonlinear autoregressive with exogenous inputs neural network di nunno and granata 2020 guzman et al 2017 wunsch et al 2018 convolutional neural network cnn wunsch et al 2021 temporal convolutional network zhang et al 2022 recurrent neural network jeong et al 2020 gated recurrent unit gru cai et al 2021 and long short term memory lstm neural networks vu et al 2021 wu et al 2021 a more comprehensive review about applications of machine learning models for gwl modeling can be found elsewhere rajaee et al 2019 overall these models have demonstrated a comparable or even better performance compared to the results obtained from the numerical models despite of the significant progress in the field of machine learning for gwl modeling it should be noted that the previously proposed data driven methods neglected the spatial relationship in the gwl data since the distribution of monitoring wells usually is irregular in space and thus traditional machine learning models cannot easily handle unstructured irregular data specifically traditional models like ann and anfis usually use several time step history records of hydrological and climatic variables to predict gwl which means the required number of input nodes is directly proportional to the number of variables and number of time steps considered although the coordinates of wells can be incorporated into the input variables it can significantly increase the number of training parameters and the model actually cannot learn the spatial relationship between each well on the other hand we can concatenate the time series data of all wells as a 2d space time image and process it with cnn based model but the unstructured spatial relationship cannot be captured due to the limited reception field of filters gru and lstm show superiority in dealing with long time series data but they do not provide the interface to receive spatial information to deal with such data and when there is a spatial dependency among them therefore graph neural networks gnns have been developed to extract the spatiotemporal patterns from the data with complex structures scarselli et al 2009 constructed the theoretical basis of gnns based on the conceptual model proposed by gori et al 2005 in gnns each object within the unstructured data is represented as a node and each node connects with a different number of unordered neighboring nodes to exchange information researchers have successfully applied gnns to solve problems in different fields including chemistry wieder et al 2020 geoscience hillier et al 2021 and intelligent transportation problems wang et al 2020 in the aspect of hydrological modeling sun et al 2021 compared the performance of different variants of gnns in predicting streamflow and obtained similar or even better performance as compared to lstm but there is no study on the application of gnns in gwl prediction the aim of this study is therefore to evaluate the feasibility of gnns for simultaneous modeling of a groundwater network with multiple monitoring wells in this paper a self adaptive gnn is used to simulate seasonal groundwater level change it includes stacked graph convolution layers to enable the adjacency matrix to be adaptively learned from the data and stacked dilated causal convolution layers to capture temporal dependencies of long sequences the developed model is applied to a gwl dataset consisting of 41 wells mainly located in the southwest british columbia province of canada the results are compared with two different machine learning models including gru and lstm which are well known for extracting patterns from sequential data and are widely used for hydrological modeling cai et al 2021 vu et al 2021 both visual and statistical comparison shows that gnn outperforms baseline models we also demonstrated that the spatial dependencies between each well could be intuitively interpreted from the learned adjacency matrix 2 study area and data to evaluate the effectiveness and efficiency of the proposed gnn for the prediction of gwl change it was tested on a set of data collected from the provincial groundwater observation well network gown of british columbia bc the gown currently includes 226 active observation wells and most of them were completed in different shallow aquifers to monitor gwls and water quality in this study we focus on the observation wells on the southwest side of bc which are mainly located at two sites vancouver island and the lower mainland area of bc most of the monitoring wells included in the dataset have continuous hourly measurements from 2010 to 2020 however these hourly data are quite noisy due to systematic and random errors during measurements the average weekly groundwater level thus was calculated and used as the target variable to predict the wells with the largest data gap of more than one month were not considered while the wells with smaller gaps were interpolated using a spline method to preserve the temporal pattern although it is possible to preprocess the former through the same way the obtained interpolation is too smooth considering such a large data gap this can prevent the proposed model to learn the short term variation of gwl for other wells as it treats all the monitoring wells as a whole and makes predictions simultaneously therefore the gwl data from 2010 to 2020 for 41 monitoring wells were acquired where 76 of them are on vancouver island and the rest in the lower mainland area of bc the depth of selected wells ranges from 24 ft to 830 ft with an average depth of 152 6 ft below ground level bgl all of them have stainless steel casing with diameters ranging from 6 in to 10 in the spatial distribution of these wells is shown in fig 1 the vancouver island is a mountainous island with a geographical extent of 31 285 km2 it has a mild climate with warm dry summers and mild wet winters the western region is significantly wetter than the eastern region due to the vancouver island ranges located near its center where the precipitation ranges from 608 mm to 6 650 mm and is concentrated in the autumn and winter the lower mainland area of bc locates on the southwestern tip of the mainland which covers a surface of 36 303 km2 as fig 2 shows the rain is most frequent in the period from november to march while the summer months are typically dry it has a moderate oceanic climate the temperature in winter is quite mild with a maximum temperature of 8 c while summer has the highest temperature but the maximum temperature generally is below 30 c the groundwater systems in the study area are mainly rainfall dominated and the gwl fluctuations show high seasonality allen et al 2014 on the other hand climate change is expected to accelerate the hydrological cycle through its effect on air temperature precipitation and evapotranspiration chaouche et al 2010 variation of these climate parameters is also likely to affect groundwater recharge smerdon 2017 and interaction between groundwater and surface water scibek et al 2007 therefore grided estimation of daily weather and climate variables was also extracted from daymet thornton et al 2012 and used as part of the inputs which include minimum and maximum temperature precipitation vapor pressure shortwave radiation and day length 3 methods in this study graph wavenet wu et al 2019 as a variation of gnns is applied to simultaneously predict future gwl for all monitoring wells in the groundwater network giving their historical record each well can be represented as a node in the graph and the available gwl data and other ancillary information like hydrological and climatic data are represented as node features during the phase of prediction each well can automatically and selectively aggregate information available at its own node and its neighbors in this section we first give a brief introduction of gnn and mathematically define our problem within this framework next we describe the network structure of graph wavenet which consists of two main building blocks graph convolutional layer gcl and gated temporal convolutional networks tcns finally we introduce the experimental setup evaluation metrics and two baseline models for comparison 3 1 graph neural network gnn can extract non euclidean information from the data represented as graphs as fig 3 shows a graph g v e includes two basic elements a set of nodes v v i i 1 n and a set of edges e e ij where n is the number of nodes in the graph and e ij denotes the edge connecting node pairs v i v j all nodes connected to node v forms its neighborhood n v u v v u e the proximities between any two nodes could be described by the adjacency matrix a r n n which could be calculated based on the prior knowledge like spatial distance randic et al 2010 or functional similarity dahl et al 2013 wang et al 2021 for a finite simple graph the adjacency matrix is a binary matrix where a ij 1 if e ij e and 0 otherwise the symmetry of adjacency matrix also represents the directional dependencies between nodes where a symmetric matrix denotes an undirected graph while a non symmetric matrix for undirected graph the number of neighbors of each node is described by the graph degree matrix d r n n where d ij j a ij if i j and 0 otherwise each node v has an associated feature vector x v r d where d is the total number of features the feature vectors of all nodes form the graph feature matrix x r n d for the problem of spatiotemporal prediction with gnn the node features could change with time assuming each node has the record of d features for t time steps the dataset for n nodes can be represented as a three dimensional tensor x t r n t d in our case each monitoring well could be represented as a node all wells are linked through the hydrological cycle and the connection between wells could be represented by the edge therefore the groundwater network in study area can be described by a graph and the connection between any two wells is quantitatively described by the adjacency matrix the node features include the gwl data and other hydrological and climatic data mentioned in section 2 given the above definitions the gwl prediction problem in this study is cast as a one step ahead forecasting problem given a graph g and s time steps historical record of all features x t s 1 x t our aim is to simultaneously predict gwl at the next m time steps x t 1 x t m for all nodes wells which could be mathematically described as 1 x t s 1 x t g f x t 1 x t m where f r n s d r n m d is the mapping function to be learned 3 2 graph wavenet graph wavenet has shown promising results for spatiotemporal graph modeling fig 4 shows the network structure of graph wavenet where the main working modulus are graph convolution layer and gated temporal convolution network the graph convolution layer includes a self adaptive adjacency matrix which does not require any prior knowledge of the spatial dependencies between each node and can learn it from the data in an end to end manner 3 2 1 graph convolution layer graph convolution is our main approach to extract spatial information from graph data different graph convolution based models have been proposed which could be classified into two categories spectral and spatial based models spectral based models implement the graph convolution with the filters introduced from the domain of graph signal processing and characterize the graph s properties with its normalized laplacian matrix ma et al 2019 spatial based models on the other hand aggregate features from neighbors by convolving themselves with surrounding nodes which is similar to the mechanism of convolutional neural networks cnns yan et al 2018 graph convolutional networks gcns one type of spatial based models and proposed by kipf and welling 2016 uses the first order approximation of chebyshev polynomials to simplify the spectral based graph convolution and aggregates node features with the help of the graph adjacency matrix for a one layer gcn the feature matrix is updated according to the following rule 2 h 1 σ a x w a d 1 2 a d 1 2 a a i n where x r n d is the initial feature matrix w r d k is the matrix of filter parameters h 1 r n k is the updated feature matrix d is the graph degree matrix of a i n is an n dimensional identity matrix and σ is an activation function to add nonlinearity a a i n is the adjacency matrix with self connection the aim of original model is to predict labels for all nodes given partially labeled nodes therefore an identity matrix is added up to the original adjacency matrix i e a self connection is added to aggregate features of the node itself and its neighbors for training stability a is normalized by d to obtain a multiple graph convolution layers can be stacked in a hierarchical manner to extract higher order information from neighbors diffusion convolutional neural networks dcnns developed by atwood and towsley 2016 implement the spatial based graph convolution as a diffusion process compared to gcns dcnns has proven to be more effective in spatial temporal modeling li et al 2017 it updates node features by transferring information from each node to its neighboring nodes until the equilibrium of information distribution is achieved after several diffusion steps the probability of information transition between any two nodes is defined by the probability transition matrix p r n n the diffusion convolution operation for the k th diffusion step is defined as 3 h k w k p k x p a r o w s u m a where is the elementwise multiplication w k r n d is the learnable transformation matrix for the k th diffusion step p k denotes the power k of the probability transition matrix and h k r n d is the features aggregated from k hop neighbors the k hop neighbors of a node v i include all nodes at a distance less than or equal to k from v i for a diffusion process with a finite number of steps the final output can be generalized to a summation of the output from each diffusion step li et al 2017 wu et al 2019 4 h k 0 k p k x w k in recent years spatial based models have been used more widely due to their efficiency and flexibility as compared to spectral based models heidari et al 2022 therefore dcnns is selected as the main working module of the graph convolution layer 3 2 2 self adaptive adjacency matrix traditional gnns learned the graph data based on a static adjacency matrix which was calculated from available physical measurements like spatial distance or connectivity however a predefined adjacency matrix may not be sufficient to capture the spatial dependencies between each pair of nodes since the selection of available measurements is inevitably subjective a dynamic adjacency matrix could also be constructed by using an attention mechanism xie et al 2021 or parametrization of graph structure shi et al 2019 in graph wavenet a self adaptive adjacency matrix a a d p r n n is proposed to learn the latent spatial dependencies from data in an end to end manner 5 a a d p s o f t m a x r e l u e 1 e 2 t clearly it is computationally expensive to directly learn this self adaptive adjacency matrix when the number of considered nodes is huge therefore two embedding matrices e 1 e 2 r n c are used to represent the spatial dependencies between input feature matrix x and updated feature matrix h which can efficiently reduce the number of training parameters from n n to 2 n c c n while some proximity measures defined on the graph can be retained goyal and ferrara 2018 similar to the calculation of node similarity nikolic 2012 the spatial dependencies between input feature matrix and the updated one are derived by multiplying these two embeddings next a relu activation function is used to remove weak connections and a softmax activation function for normalization graph wavenet uses spatial based graph convolution and the proposed self adaptive adjacency matrix can also work as a probability transition matrix thus when the graph structure is available the predefined spatial dependencies is combined with the self learned hidden one and the graph convolution layer gcl of graph wavenet is then defined as 6 h k 0 k p k x w k a a d p k x w a d p it should be noted that only the last term of eq 6 is retained when the graph structure is unknown 3 2 3 temporal convolution layer in graph wavenet temporal convolutional networks tcns are used to extract temporal features from nodes the main operation is dilated causal convolution yu and koltun 2015 which works similarly as the cnn but neglects a fixed number of values when the 1d filter slides over the input sequence mathematically it is defined as 7 x f t s 0 k 1 f s x t d s where x r t is a 1d input sequence f r k denotes the filter with size of k d is the dilation factor determining the skip distance fig 5 shows the stacked dilated causal convolution layers with a fixed kernel size of 2 and dilation factors of 1 2 4 8 the introduction of the dilation factor allows the receptive field to be expanded exponentially with the increase of layer depth it can be seen that the receptive fields of the last three dilated causal convolution layers are even larger than the size of kernel in this way a longer sequence could be processed with fewer layers and less computation burden moreover a gating mechanism was also applied to control information flow within tcns 8 h tanh t c n a x σ t c n b x where tanh is tangent hyperbolic activation function σ is sigmoid activation function and t c n a b are two tcns t c n a is mainly used to capture temporal features while t c n b is for controlling the ratio of information passed via the sigmoid function 3 2 4 graph wavenet architecture during each iteration graph wavenet processes a single batch data x b r b d n l with a batch size of b and a sequence length of l the operation of 1 1 convolution is first applied to extract abstract local features as fig 4 shows the main working module of graph wavenet includes multiple stacked spatial temporal layers in each layer the inputs pass through a gated tcn followed by a gcl the output h from gated tcn is a four dimensional tensor with size of b c n l where c is the dimension of learned hidden temporal pattern a residual connection is also added between inputs and outputs to accelerate model convergence he et al 2016 the output of each spatial temporal layer is summed by the skip connections and then processed by two groups of relu activation function and 1 1 convolutional layer these spatial temporal layers can capture temporal information at different scales by changing the dilation factor for example the first layer captures short term temporal features while the last layer captures long term temporal features it should be noted that the final output h o r l n from graph wavenet can predict future gwl for l time steps at once i e the length of input sequence the goal of this paper is to predict gwl for m future time steps x m r n m d given its s time steps historical record x s r n s d the mean absolute error mae is used to train the graph wavenet and it can be expressed as 9 l x m θ 1 mnd i 1 m j 1 n k 1 d x mjk t i x mjk t i where θ is model parameters to be trained 3 3 experimental setup the gwl data was normalized with its mean and standard deviation and then was chronologically split into training validation and testing datasets with a ratio of 0 60 0 15 0 25 the training dataset corresponds to the period from january 2010 to july 2016 and the validation set corresponds to the period from august 2016 to march 2018 the rest data was used for testing the performance of trained model in our study we considered two kinds of graph wavenet when there is some known information about the spatial relationship a predefined adjacency matrix could be obtained and combined with the self adaptive one which is denoted as gwn in our case the predefined adjacency matrix was calculated based on the distance of any pair of monitoring wells and then was converted to a sparse matrix by threshold gaussian kernel shuman et al 2013 with a threshold of 0 2 otherwise only the self adaptive adjacency matrix is used to automatically learn the spatial dependencies from the data which is denoted as gwn adaptive in both cases eight spatial temporal layers were stacked to construct graph wavenet with the dilation factors set as 1 2 1 2 1 2 1 2 the number of diffusion steps k was set as 2 and fixed for each layer the dimension of node embedding was set as 10 a dropout layer with a rate of 0 5 was added after gcl finally the model was optimized by adam kingma and ba 2015 with a learning rate of 0 001 and was trained for 100 epochs with a batch size of 16 the graph wavenet was implemented with pytorch paszke et al 2019 and trained with an nvidia tesla t4 gpu graph wavenet was compared with two baseline models including lstm and gru these two models are improvements of rnn which can learn long term dependency from time sequence while avoiding the gradient vanishing problem hochreiter and schmidhuber 1997 compared to lstm gru is less complex since it has one less gate to control information flow both of them have been used for groundwater modeling cai et al 2021 wu et al 2021 a more detailed introduction about their mathematical definition and working mechanisms could be found in salem 2022 it should be noted that in our case we trained the model of lstm and gru for each monitoring well separately since their application was mainly focused on a single well instead of the monitoring well network the following hyperparameters were considered for these two models the number of hidden layers 1 2 and the number of neurons in each hidden layer 8 16 32 since they were trained with the data from only one well the model complexity was restricted to avoid overfitting moreover an l2 regularizer with a regularization factor of 0 001 was added to each layer adam was applied to minimize the mean squared error mse for lstm while rmsprop was used to minimize the mae for gru the hyperparameters were tuned based on the performance of the validation dataset and the selected best model has the lowest error the performance of each model was evaluated on the testing dataset and compared based on root mean squared error rmse mean absolute percentage error mape which can be calculated as 10 r m s e i 1 m j 1 n k 1 d x mjk t i x mjk t i 2 mnd 11 mape 1 mnd i 1 m j 1 n k 1 d x mjk t i x mjk t i x mjk t i and mae 4 results and discussion table 1 summarizes the performance of two kinds of graph wavenet and two baseline models the gwn outperformed gwn adaptive lstm and gru in terms of all defined evaluation metrics in particular the performance of gwn adaptive was comparable to other two baseline models which indicated that to some extent the self adaptive adjacency matrix can learn the spatial dependencies from the data gru obtained better results compared to lstm in our case we trained these two baseline models for each monitoring well separately and gru has a lower model complexity and fewer training parameters therefore it performed better even when trained with a relatively small dataset on the other hand it should be noted that compared to these two baseline models graph wavenet was more efficient in terms of computational cost since graph wavenet can treat the monitoring well network as a whole the training process was performed only once and the trained model can simultaneously predict future gwl for all wells in contrast the model structure of lstm and gru must be optimized for each monitoring well thus the total computational time is proportional to the number of wells and the number of possible combinations of predefined hyperparameter options the performance of these two baseline models could be improved further by expanding the search range of considered hyperparameters but at the expense of longer computational time to further compare the performance of graph wavenet with other two baseline models fig 6 shows the observation and prediction from two randomly selected monitoring wells where each well is assumed to have the same probability of being selected variation of gwl in these two wells shows different characteristics the variational trend in the first well is more abrupt with sharp peaks while the second well has a softer variation tendency but with a larger amplitude all four models can capture the seasonality of gwl change in these two wells both gwn and gwn adaptive however outperformed the other two baseline models due to relatively smaller shifts of its predictions from the observations since we restricted the model complexity of baseline models caused by limited available data of each well the predicted curves were smoothed out for capturing the general variational trend of gwl and neglecting some short term changing details we also noted that there were some delays between the predictions of two kinds of graph wavenet and observations as the groundwater system in the study area is rainfall dominated and the flow rate of water in the underground layers is relatively slow the response of groundwater to external signals may exhibit a delay effect considering precipitation being one of the input variables the absolute prediction error of each well at any single future time step is calculated for each model and the corresponding histogram is compared in fig 7 it can be seen that the performance of gwn is more desirable than that of other models as its histogram has a higher peak height at the absolute error of approximately zero to make a more quantitative comparison table 2 lists the statistics of absolute prediction error depending on the applied model from the table it is found that gwn has the lowest mean and median absolute error 0 6736 m and 0 3601 m and smallest interquartile range iqr q3 q1 it is worth noting that the performance of gwn adaptive is still comparable to other two baseline models in terms of the mean and median absolute error and interquartile range which again confirms its effectiveness in automatically capturing the spatial dependencies from data the mae scattered maps of all monitoring wells are shown in fig 8 for different models in the area of the northeast coast of vancouver island and lower mainland all models performed well with small mae in comparison all models show relatively large errors for some wells in the dashed box this region has been enlarged for better illustration as can be seen most monitoring wells in this region were located on some small islands which were quite close to the southeast coast of vancouver island such a geographical condition complicates the hydrological cycle and the used input variable thus may not be enough to capture this complex relationship we also indicated the best and worst fit wells with red arrow and blue dashed arrow correspondingly in fig 8 as can be seen they were mostly located within the dashed box even when predicted with different models which verified the high complexity of hydrological cycle in this region a more quantitative measurement of the goodness of each model is shown in fig 9 with the boxplot of mae for all models gwn performed better with the lowest median metric value and interquartile range moreover it has the smallest range which is possibly due to its ability to simultaneously model all the monitoring wells in the system and the given predefined spatial dependencies on the other hand since we trained lstm and gru for each well separately the hyperparameter tuning process had a large effect on the final prediction error therefore any inappropriate hyperparameter selection could increase the range of the distribution of mae fig 10 provides an intuitive interpretation of the learned spatial dependencies between each well graph wavenet randomly initialized the self adaptive adjacency matrix a adp and learned it from the data in an end to end manner this self adaptive adjacency matrix can explore the hidden spatial dependency between nodes or wells in our case each entry a a d p ij of the self adaptive adjacency matrix denotes the relative importance of the jth well in improving gwl forecasting for the ith well for example it can be seen that there is a strong interdependence between well pairs 6 24 3 22 8 32 18 40 for their high values in the heatmap moreover the range of influence for a single well could also be derived from this map for instance column 19 has more high value points compared to column 1 which means comparatively well 19 is more influential than other wells 5 conclusion in this study graph wavenet was used to predict gwl change over a long term period different from traditional machine learning models this model can incorporate unstructured well location data into the learning process to consider the spatial association between wells the ability of the proposed model for gwl forecasting was evaluated and discussed for the data obtained from the groundwater observation well network of british colombia in canada in addition the proposed model was compared with lstm and gru the proposed model outperformed two baseline models in terms of mae rmse and mape on the testing dataset our comparison showed that predictions from graph wavenet have relatively smaller shifts from observations and can capture short term changing details moreover graph wavenet was more efficient by treating all the monitoring wells in the system as a whole and the boxplots indicated that this mechanism could narrow the range of distribution of mae for each well finally the learned adjacency matrix could intuitively provide the interdependence between each pair of wells and the influential range of a single well the spatial dependencies between wells were represented by two components the predefined adjacency matrix and the self adaptive one available information of the spatial relationship for example physical measurements like distance and connectivity could be incorporated into the former however it may not be sufficient to cover all the valuable information considering the high complexity of hydrological cycle the latter was added to represent other underlying spatial relationship when the spatial dependencies were completely unknown the model was trained only with the self adaptive adjacency matrix the conducted experiments demonstrated that the model can automatically learn the spatial dependencies from the data in an end to end manner and the obtained performance was comparable to other two baseline models but with less computational burden as limitations the proposed model showed some weakness of learning the spatial dependencies for wells located in a complex geographical environment for example a group of small closely packed islands a potential solution is to incorporate more hydrological and climatic information into the input variables for better capturing such a complex hydrological cycle on the other hand when a new monitoring well is added to the network for forecasting the proposed model must be re trained as the adjacency matrix needs to be updated to consider the spatial dependencies on the new well however it is still computationally cheap considering the relatively short training time of roughly ten minutes finally an important direction for future work is to test the capability of proposed model on the dataset showing weak seasonality or covering a wider geographical area credit authorship contribution statement tao bai methodology pejman tahmasebi conceptualization supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
