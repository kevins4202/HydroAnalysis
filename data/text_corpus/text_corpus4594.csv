index,text
22970,when gps is not available autonomous vehicles can obtain navigation information by observing a source with a camera or an acoustic system mounted on the frame of the vehicle this information can be used in the navigation and to overcome the lack of other sources of positioning however these systems often have a limited range and angular fov due to this restriction motion along some paths will make it impossible to obtain the necessary navigation information as the source is no longer in the vehicle s fov this paper proposes both a path planning approach and a guidance control law that allows the vehicle to preserve landmarks that are critical for the navigation inside the fov while at the same time converging to the proposed path the suggested approach is experimentally validated by implementation in an autonomous underwater vehicle keywords fov constraint landmark based navigation path planning guidance underactuated vehicle 1 introduction one of the challenges that autonomous vehicles face is navigating in environments where information from the global positioning system gps is not available this is a challenge that affects vehicles and systems that operate indoors inside mines or underwater an alternative to the gps is often computer vision or acoustic systems although computer vision and acoustic systems have proven to be able to produce accurate information they sometimes rely on a single source of information either because the camera information only tracks a single visual landmark or because there is only a single node available of an acoustic network in such cases the ability to navigate depends on the constant observation of the source unfortunately the sensors receiving these signals are often limited by the fov an angular restriction to observe a landmark in some configurations the sensors have the ability to change their direction and therefore partially overcome this limitation stolle and rysdyk 2003 rysdyk 2006 other setups may instead have these sensors fixed to the vehicle s frame and then the observability of the landmark becomes dependent on the vehicle s trajectory this restriction makes some paths blind because by following them the vehicle loses sight of the landmark see fig 1 and this can compromise the vehicle s navigation capabilities the path planning problem thus becomes more challenging as it should not only find a feasible collision free path to connect the start and end points but also preserve the view of the target this restriction is often referred as for the field of view constraint in boyadzhiev 1999 tucker 2000 it is observed that certain animals moving with respect to prey or a light source follow a logarithmic spiral this kind of spiral enables them to maintain the prey or light source in their fov at all times during their motion the existence of such trajectories in nature have inspired solutions to the fov constraint a formal definition of fov is given in bhattacharya et al 2007 which following a similar approach as the reeds shepp car in reeds and shepp 1990 describes a combination of straight lines and vision saturated curves that connect any two points in the plane the time optimal combination of trajectories is found and proven by balkcom and mason 2002 for a omnindirectional robot the length optimal solution for a nonholonomic robot with limited fov is given in salaris et al 2010 and the time optimal solution is described in cristofaro et al 2017 proving that the path can be constructed by a finite set of maneuvers variations of the fov problem are addressed in salaris et al 2012a for side facing sensors and hayet 2012 considers the case in which multiple landmarks must be preserved and salaris et al 2015 a solution in the case where the fov is limited vertically as well in addition maniatopoulos et al 2013 proposes a control law that guides the vehicle toward a desired point by using model predictive control mpc and panagou and kyriakopoulos 2013 uses viable state feedback control to ensure the preservation of the fov in lópez nicolás et al 2010 salaris et al 2011 different control schemes are proposed to follow a path optimal in length with an underactuated robot that can turn on the spot and move backward a common approach for path following control of underactuated vehicles is based on the line of sight los guidance fossen 2011 healey and lienard 1993 breivik fossenet al 2008 the los guidance approach has the advantage of being simple and has a very small computational load fossen et al 2015 this guidance law was also generalized for curved paths in børhaug and pettersen 2006 using a serret frenet frame and extended to handle currents in moe et al 2014 however the different versions of los guidance do not deal with restrictions in the fov in this paper we address this issue by proposing an adapted version of the los guidance law considering the restrictions in the fov the paper considers the fov restrictions both in the path planning and the path following problems and these are tackled in two steps the first step is the design of a path by using logarithmic spiral paths which are a particular type of trajectories that appear as general solutions in fov problems being discussed in bhattacharya et al 2007 salaris et al 2010 2012a lópez nicolás et al 2010 furthermore since underactuated underwater vehicles are considered as opposed to mobile robots moving backwards may not be desirable since often the auv thrusters do not work efficiently in the backwards direction and the steering becomes inefficient this restriction limits the set of points that can be reached compared to a robot that can move forward and backwards such as the results presented in bhattacharya et al 2007 lópez nicolás et al 2010 hayet et al 2014 thus the path planning proposed in this paper requires the computation of the reachable set to identify which destination is feasible this paper extends the preliminary results that were presented in sans muntadas et al 2016 with two main contributions the first is a path planning algorithm that computes the set of points that can be reached preserving a landmark and generates a list of waypoints that can be connected with logarithmic spirals the resulting path allows for connecting two points through a path that when followed preserves the fov of at least one landmark see fig 1 the second contribution of this paper is a guidance and path following control law for underactuated vehicles which is an extension of the existing los guidance laws this control law is specifically designed to follow the logarithmic spirals generated in the first step and in addition it ensures that the vehicle s maneuvers preserve the view of the target compared to the path planning approach of salaris et al 2011 hayet et al 2014 the proposed solution trades some optimality in path length to achieve control robustness by using lyapunov theory we prove that the proposed guidance control law makes the vehicles converge to and follow the path in particular in this paper it is proven that the closed loop error dynamics are globally asymptotically stable the paper is organized as follows section 2 describes the problem of the fov section 3 studies the set of points that are reachable given the fov restrictions section 4 proposes a path planning tool section 5 describes a guidance control system and section 6 examines the stability properties of the closed loop system section 7 presents the experimental setup in section 8 the results of the experimental tests are discussed lastly section 9 presents the conclusions 2 problem description we consider an underactuated autonomous underwater vehicle auv that moves on a plane the vehicle is equipped with a thruster and a rudder that provides forward motion and steering the state of the vehicle is defined by its position x y and heading ψ the vehicle has a front facing sensor such as a camera or a ultra short base line usbl that only receives information by having a landmark inside its fov and within a certain range the environment has multiple landmarks transponders l l 1 l 2 l 3 l n distributed at different locations x l n x l n y l n for each landmark a polar coordinate system is defined 1 r l n x x l n 2 y y l n 2 ϕ l n atan 2 y y l n x x l n θ l n ψ ϕ l n π where with respect to each landmark r l n is the range ϕ l n is the azimuth angle and θ l n is the bearing angle see fig 2 in order for the vehicle to have a landmark inside the fov the following conditions must be satisfied condition 1 the landmark is inside the maximum fov range r l n r max condition 2 the bearing angle with respect to the transponder landmark is inside the angle limits fov θ l n θ max π 2 the objective is to describe a path that connects a starting point x 0 x 0 y 0 to a final point x f x f y f while the fov described by conditions 1 and 2 is satisfied for at least one landmark the path has to have point continuity g 0 thus sudden changes in the tangent of the path are permitted assuming that the transient of turning from one direction to the other does not affect the navigation the vehicle is restricted to moving forward in order to plan a path from a starting point to an end point the proposed method starts by analyzing which points can be reached maintaining that the fov conditions are true r ℝ 2 also a control approach is derived to ensure that the vehicle follows the proposed path 3 reachable sets knowing if a point or an intermediate waypoint is reachable is critical in order to plan a path the answer to this depends on the number of landmarks if there is only a single landmark there exists an analytic expression of the set of points that can be reached we denote this set as γ x 0 ℝ 2 given the case of multiple landmarks to our knowledge there is no analytical expression to define the reachable set of points this section thus uses the existing analytical solution of a single landmark to propose and compute a discretized solution of the reachable set given the case of multiple landmarks this section is divided into three parts the first presents the case of the reachable set when there is only a single landmark the next part explains and derives how the solution can be used to describe the reachable set given multiple landmarks and the last part proposes an algorithm and a search tree to compute the reachable set 3 1 single landmark at any given point of a curve or a path described in polar coordinates r ϕ the angle between the radius and the tangent θ is expressed as 2 tan θ r ϕ d r ϕ d ϕ if the angle θ is kept constant the solution of the differential equation that goes through an initial point x 0 r 0 ϕ 0 becomes a logarithmic spiral the literature sometimes refers to this constant angle as the characteristic angle salaris et al 2010 the logarithmic spiral is described by 3 r ϕ r 0 e ϕ ϕ 0 tan θ any point r ψ that is closer to the landmark than the initial point i e r r 0 can be connected with the initial point x 0 r 0 ϕ 0 using the following characteristic angle θ and in logarithmic spiral given in equation 3 4 θ atan ϕ ϕ 0 ln r r 0 thus if the characteristic angle of the spiral θ fulfils condition 2 an underactuated vehicle following that path without sideslip will reach this point r ψ without losing the angular fov consequently all the points that satisfy this condition are contained inside the boundaries described by two logarithmic spirals given by equation 3 with a characteristic angle θ equal to the angular limits of the fov θ θ max and θ θ max in salaris et al 2012a these boundaries are referred to as the limit trajectories t r and t l the set of points reachable from a starting point x 0 is illustrated in fig 3 and can be expressed as 5 γ θ max l n x 0 r l n ϕ l n δ r l n r 0 e δ tan θ max δ π π r l n r max remark 1 the reach case is studied under the property of symmetrical fov for the case of non symmetrical θ min θ θ max an analytic description of the reach set can also be developed this can be of particular interest for planning trajectories for vehicles that are fitted with peripheral vision such as self driving cars or surveillance uavs however the controller described later in this paper requires symmetrical fov and we will therefore not go further into this topic the reader might refer to salaris et al 2012b for a detailed analysis of optimal paths given such circumstances 3 2 multiple landmarks in the presence of multiple landmarks the solution of the reachable set becomes more complex and needs to take into account the different choices of available landmarks and the possibility of switching between them hayet et al 2014 with multiple landmarks the problem becomes much more complex and finding a analytical solution to describe the reachable set is opposite to the case of a single landmark described in equation 5 thus in this paper we propose computing the reachable set using a discretization of the space and extending the results of a single landmark we first define the operator ƶ 6 ƶ x n n γ θ max l n x which is the union of all the individual reachable sets for each landmark given a starting point x 0 the result is all the points that can be connected with a logarithmic spiral by observing only an individual landmark see plot a in fig 4 the set ƶ does not contain all the possible reachable points because at some points in ƶ the vehicle will be able to switch and use another landmark as a reference a possible way to compute the reachable set after such a switch is to repeat ƶ but for all the reachable points previously obtained thus we define ω as the set of points that can be reached from a given set of points a 7 ω a x a ƶ x by iteratively repeating this ω operation on the last obtained set it allows us to find all the points that can be connected with logarithmic paths see plot b c in fig 4 we denote the iteration as r l were l is the number of iterations of ω 8 r l x 0 ω r l 1 x 0 ω ω ω ω ƶ x 0 3 3 computation of the reachable set the iterative operation of computing the reachable set can be resource consuming to alleviate this we simplify the computation of the reachable set by first calculating the hull of the actual set and then the operator ƶ is only applied to the points belonging to the hull note that this reduces the search for new reachable points based on new spirals that start at the boundaries of the current reachable set simplifying the computation of ω 9 ω a x a z x a x hull a ƶ x image 1 the proposed algorithm iteratively searches for new points that can be connected with logarithmic spirals the points that are found to be reachable are stored in a set r to alleviate the computational complexity it calculates the hull h of the known reach set and searches for new points according to equation 9 the points that have already been explored are stored in e and will not be visited again the variable t inside the second for loop temporarily stores the new found reachable points at the same time a search tree g is constructed which connects the new found points with its founder this search tree will later be used to reconstruct an initial path solution the time complexity of the algorithm is o n 2 where n in this particular case represents the number of points or nodes in the discretized set 4 path planning this section describes and proposes a path p that connects the initial and the final point through n concatenated logarithmic spirals the proposed method for path planning uses the search tree g to reconstruct the path by reading backward through the search tree a series of waypoints are found the method starts by reading g x f x i 1 which returns the previous waypoint then iteratively setting g x i 1 x i 2 and we repeat this operation until g x i k x 0 fig 5 illustrates an example of the search tree and the obtained path in this way it returns a list of waypoints x x 0 x 1 x i 1 x f this list of waypoints makes for an initial solution but in most of cases it is not optimal this is due to the way reachable points are found in the algorithm every time the algorithm finds a new reachable point it stores the origin from where that new point was found to be reachable in the algorithm g t x also the simplification proposed in equation 9 to compute the reachable sets uses the hull to compute a solution and as a consequence of this the solution includes many waypoints that are at the limits of the reachable set this puts the spirals at the limits of the fov something which complicates the control and guidance of the vehicle since the convergence to the path might be slower due to a small margin for steering and an overshoot would make the landmark disappear from the fov for these reasons after computing an initial path we optimize it using the following cost function to penalize spirals with bigger characteristic angles θ i see fig 6 4 1 cost function the length of a logarithmic spiral segment can be found integrating a curve between two radius points 10 s i r i l n r i 1 l n 1 r d r d ϕ 2 d r r i l n r i 1 l n cos θ i however if we optimize the path solely based on length this would result in a path composed by straight lines and spiral trajectories at the limits of the fov as seen in bhattacharya et al 2007 thus we propose a cost function c x i 1 x i l n λ based on the spiral length but add an exponential term λ 0 to the cosine thus penalizing bigger characteristic angles θ i the cost of a spiral segment given a reference landmark l n is defined as 11 c x i 1 x i l n λ if r i l n r max or θ i θ max r i l n r i 1 l n cos θ i 1 λ else then since the vehicle can choose between multiple reference landmarks we optimize with respect to which reference landmark makes a shorter path thus the minimal cost of a segment given by two waypoints is defined as the smallest among the different landmark choices l n in l 12 c min x i 1 x i l λ minimize l n c x i 1 x i l n λ subject to l n l the optimization problem solved here using a random walk consists of finding a list of optimized waypoints x and a list of k reference landmarks l l i e l l 2 l 1 l 5 l n with minimal cost in the sum of the segments note that some solutions might use the same landmark more than once 13 minimize x i 1 k c min x i 1 x i l λ subject to x ℝ 2 n remark 2 note that the optimization of the waypoints does not need to belong to the discretized set since the cost function for each spiral guarantees that the fov restrictions are maintained 4 2 path description once the optimized list of waypoints is found we define the path p as a result of connecting all the waypoints with logarithmic spirals each spiral is parametrized by ϖ 0 1 and an index i used to refer to the logarithmic spiral that connects two consecutive waypoints i e x i 1 with x i 14 p p ℝ 2 p r l i ϖ i ϕ l i ϖ i ϖ 0 1 i 1 n x l where 15 r l i ϖ i ϖ r i 1 l i r i l i r i l i ϕ l i ϖ i ϕ i l i tan θ i l i ln ϖ r i 1 l i r i l i 1 1 θ i atan ϕ i 1 l i ϕ i l i ln r i 1 l i r i l i alternatively it can be expressed in global cartesian coordinates 16 x ϖ i x l i ϖ r i 1 l i r i l i r i l i cos ϕ l i ϖ i y ϖ i y l i ϖ r i 1 l i r i l i r i l i sin ϕ l i ϖ i ψ ϖ i θ i ϕ l i ϖ i π the following fig 4 2 shows the results of the optimization as it can be seen the initial solution red line is not optimal and goes trough the limits of the fov three more paths are shown which display the difference of using the proposed cost function the purple line shows the result of optimizing the position of the waypoints when λ 0 which is equivalent to using as a cost function the length of the path this optimization leads to a path very close to the limits of the fov the other two black and yellow line show the path for other values of λ 0 5 and λ 2 and it can be seen that the paths are longer in length but the spirals have smaller characteristic angles remark 3 note that the path planning tool finds the path with the minimum number of spirals a more optimal solution can also be found by adding more waypoints to the optimization with a large amount of way points any solution of a path with limited fov could be discretized using logarithmic spirals sans muntadas et al 2017 5 guidance and control system the control objective is to make the vehicle converge to and follow each logarithmic spiral segment defined between two consecutive waypoints x i and x i 1 using the list of reference landmarks l i to achieve this the system uses a serret frenet frame to describe the position of the vehicle relative to the path a guidance law is then proposed to ensure that the vehicle follows the trajectory 5 1 serret frenet frame update law the serret frenet frame describes the position of the vehicle relative to a virtual particle that moves along the path similar approaches for underwater vehicles have been presented in fossen 2011 moe et al 2014 encarnaçao and pascoal 2000 the total distance travelled s parametrizes the position of the particle within the path afterwards the position of the vehicle relative to the particle is calculated giving x b f y b f ψ b f cf fig 7 the position of the particle along the path is updated as the vehicle moves according to a proposed update law s since the path is described in multiple spiral segments the system has to identify at which segment of the spiral the particle is for this two more terms are used to describe the position one is the index i s that identifies at which spiral segment the particle is and the other is the distance travelled within that particular spiral segment z the index i s is found by identifying the smallest i such that the travelled distance s is smaller than the sum of the lengths of the first i segments an offset s 0 can also be used for an early switch of spiral which can be useful for vehicles with large inertia 17 i s min i s t i 1 i s i s s 0 once i s is known the distance z travelled within that specific segment can be calculated by subtracting the sum of the lengths of all the previous segments from the total distance travelled s 18 z s i 2 i s s i 1 then the variable ϖ that identifies the position within the spiral according to the description in equations 14 and 15 can also be defined as the ratio travelled within the spiral segment which makes the position of the particle within the segment ϖ s 19 ϖ s z s i s given ϖ s i s the global position of the virtual particle can be found using the description of the path in equation 16 x s x ϖ s i s y s y ϖ s i s ψ s ψ ϖ s i s or r s l n ϖ s i s ϕ s l n ϖ s i s when using polar coordinates afterwards combining the particle position and the vehicle state x y ψ the position relative to the serret frenet frame can be calculated as see an illustrative example in fig 7 20 x b f x x s y b f y y s ψ b f ψ ψ s the kinematics of the body frame relative to the serret frenet frame can then be described by the following expression børhaug and pettersen 2006 were u is the surge speed v the sway and κ is the curvature of the path 21 x b f y b f cos ψ b f sin ψ b f sin ψ b f cos ψ b f u v s 0 s 0 κ κ 0 x b f y b f alternatively in an expanded form 22a x b f u cos ψ b f v sin ψ b f s s κ y b f 22b y b f u sin ψ b f v cos ψ b f s κ x b f 5 2 guidance and update law the control objective of making the vehicle converge to and follow the path can then be formalized as follows 23 lim t x b f t 0 lim t y b f t 0 for the guidance the following assumption have been considered assumption 1 the vehicle moves with a bounded forward speed u where 0 u min u u max and the sway speed v is bounded by v v max assumption 2 the angle γ ϕ ϕ s between the angular coordinate of the vehicle s position ϕ and the angular coordinate of the virtual point of the serret frenet frame ϕ s is assumed to be close to zero γ 0 remark 4 assumption 2 depicts that the vehicle and the serret frenet particle observe the landmark from the same angle this is safe to assume when the distance to the path is relatively small compared to the distance to the landmark this simplification avoids needing to consider the position relative to the landmark that should be kept within the fov and thus makes it possible to adapt the well known line of sight guidance for the path following assumption 3 the crab angle β atan v u is small enough such that it does not interfere with the fov remark 5 marine vehicles experience sway velocities while turning and in order to follow the desired path a crab angle is then needed to compensate for such velocities assumption 3 considers that the crab angle β is negligible compared to the whole range of the fov so that it does not need to be considered thus avoiding an over complication of the guidance law the proposed method uses the described logarithmic spirals to design a path that always preserves the fov however whether the vehicle is oriented along the path will depend on the controller used for path following a controller which does not consider the limits of the fov can make the vehicle lose sight of the landmark while steering towards the path the following equation describes the update law that will drive the serret frenet frame along the path as the vehicle moves 24 s u cos ψ b f v sin ψ b f k x x b f the first two terms are the projection of the vehicle velocity onto x b f by doing so the frame moves as fast as the vehicle in that direction for this particular application it is important that x b f remains equal to 0 otherwise an offset between the path and the followed trajectory might appear for this reason the third term k x x b f is introduced which acts as a restoring spring ensuring the convergence of x b f to 0 this allows for overcoming initialization errors or numerical errors caused by the integration of s the following guidance law illustrated in fig 8 is an extension of the well known los guidance law and has been designed for underactuated vehicles that have no independent control input in the sideways direction it commands a desired yaw angle that we will prove later that makes the system described by 21 converge to the desired path 25 ψ d ψ s θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 saturation controller where δ 0 is a design parameter inspired by the line of sight guidance method fossen et al 2003 referred to as the look ahead distance the smaller the value of δ is chosen the more aggressive maneuvering towards the path the larger the value of δ the more stable the system and the slower the convergence to the path is the term β atan v u compensates for the crab angle u is the surge velocity v is sway velocity and u u 2 v 2 the term d θ i is a shifting parameter that makes the heading angle at y b f 0 the same as the desired constant characteristic angle θ i 26 d θ i δtan θ i tan 2 θ max tan 2 θ i thus if a controller is able to make the vehicle follow a desired heading ψ ψ d substituting ψ d according to equation 16 gives 27 θ l n ϕ l n π ψ d θ i ϕ s l n π ψ s θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 θ l n ϕ l n ϕ s l n γ atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 based on assumption 2 3 the crab angle β and the angle γ between the angular coordinate of the serret frenet virtual particle ϕ s and the angular coordinate ϕ of the vehicle s position are too small to affect the fov thus 28 θ l n atan tan θ max y b f d θ i δ 2 y b f d θ i 2 tan θ l n tan θ max y b f d θ i δ 2 y b f d θ i 2 1 thus since the factor of tan θ max is bounded between 1 and 1 the magnitude of the bearing angle θ l n is always smaller than θ max 29 θ l n θ max 5 3 yaw controller the yaw dynamics of the vehicle can in general be written fossen 2011 30 ψ r r f r u v r τ r the following feedback linearizing controller is used to follow the desired yaw angle ψ d provided by the guidance law 25 31 τ r f r u v r ψ d k ψ ψ ψ d k r ψ ψ d where k ψ and k r are strictly positive constant controllers gains by defining ψ ψ ψ d and ψ ψ ψ d and substituting the controller 31 into 30 the yaw error dynamics can be written 32 ξ ψ r 1 0 k ψ k r ψ r λ ξ the system given by 32 is linear and time invariant since the control parameters k ψ 0 and k r 0 λ is hurwitz and the origin ξ 0 is uniformly globally exponentially stable uges the controller 31 thus ensures exponential tracking of the desired yaw angle ψ d provided by 25 5 4 example the simulation illustrated in fig 9 shows the difference between using a conventional los and the proposed guidance the figure shows two different approaches the first one uses los and we see that the vehicle is able to converge much faster however during the approach the landmark is not kept inside the fov contrary to this the proposed guidance approach is able to take into account the limitations of the fov and turn less aggressively thus always maintaining the landmark inside the fov limits 6 stability analysis the controller system proposed in this paper allows an underactuated vehicle to follow a spiral while at the same time preserve the vision of a target to apply this controller to a large class of underactuated vehicles the stability proof has been restricted only to the kinematic model in order to prove the stability we rewrite the expression of ψ b f ψ ψ s 33 ψ b f ψ ψ d ψ ψ s then substituting ψ d by the guidance law 25 34 ψ b f ψ θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 ψ s ψ d ψ s ψ b f ψ θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 α then we group the saturation controller the crab angle and the characteristic angle into a variable α where the expressions for sin α and cos α can be expanded to 35 cos α u v tan θ i δ 2 y b f d θ i v u tan θ i tan θ max y b f d θ i u tan 2 θ max 1 y b f d θ i 2 δ 2 cos θ i sin α v u tan θ i δ 2 y b f d θ i u v tan θ i tan θ max y b f d θ i u tan 2 θ max 1 y b f d θ i 2 δ 2 cos θ i following same approach as in moe et al 2014 sin ψ b f and cos ψ b f can be written as 36 sin ψ b f sin ψ α sin α ψ sin ψ ψ cos α cos ψ 1 ψ sin α cos ψ b f cos ψ α cos α ψ cos ψ 1 ψ cos α sin ψ ψ sin α by substituting the update law 24 into equation 22 we obtain 37a x b f k x x b f s κ y b f 37b y b f u sin ψ b f v cos ψ b f s κ x b f then substituting the update law 24 the controller 31 and the guidance law 25 into equation 21 we obtain 38 x b f k x x b f s κ y b f y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ k 2 cos θ i s κ x b f ψ h u ξ where h u ξ is 39 h u ξ sin ψ ψ u sin θ i tan θ i y b f d θ i cos θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ i 2 cos ψ 1 ψ u cos θ i tan θ i y b f d θ i sin θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ i 2 then by using the coordinates of the yaw error dynamics defined in 32 the closed loop system can be written 41 x b f y b f k x x b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i s 0 κ κ 0 x b f y b f h u ξ ξ 42 h u ξ ξ 0 0 h u ξ 0 ψ r the system composed by equations 32 and 41 constitutes a cascaded system where the nominal system is perturbed by the exponentially stable error dynamics 32 through the interconnection term 42 theorem 1 given an underactuated vehicle described by the dynamical system 21 and 30 if assumptions 1 3 hold then the update law 24 the guidance law 25 and the controller 31 guarantee the achievement of the control objectives 23 proof to prove stability of the nominal part of 41 we choose the quadratic lyapunov function candidate v 1 2 x b f 2 y b f 2 the derivative of v is then obtained as 43 v x b f x b f y b f y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f w y b f δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i k x x b f 2 this expression has two terms first k x x b f 2 which is always 0 and a second one where the the denominator is always positive since condition 2 restricts cos θ i to always being positive in the range of θ i therefore by showing that the numerator which we call w y b f 0 being zero has a unique solution at y b f 0 and that this solution is also a maximum will show that v is negative definite 44 w y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f w 0 0 by taking the first and second derivative of w y b f it can be seen that y b f 0 is a maximum value of w 45 w 0 0 w 0 2 u tan θ max 1 tan 2 θ i tan 2 θ max 0 therefore v is bounded by 46 v u min tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i k x x b f 2 v is thus shown to be negative definite and thus the nominal system is ugas theorem 1 from sontag 1989 can now be applied to prove stability of the entire cascaded system in particular the nominal system is ugas with a quadratic lyapunov function the perturbing error dynamics are uges and the interconnection matrix h u ξ is globally bounded under assumption 1 which guarantees that u is bounded between u min u min and u max u max 2 v max 2 consequently the cascaded system in 41 and 32 is ugas and x b f x b f thus uniformly asymptotically converges to zero thus the control objectives 23 are satisfied 7 experimental setup underwater snake robot and controllers this section presents the experimental setup used to implement and test the guidance and control for an underactuated vehicle described in section 5 with a path planned according to the algorithm proposed in section 4 for the experimental testing in this paper we used the underwater snake robot mamba with thrusters kelasidi et al 2016a as a test platform to validate the proposed approach this is an articulated auv with a thruster module for forward thrust and where the joints of the robot are used instead of rudders to control its direction in the following the experimental setup and details of the underwater snake robot are briefly presented more details can be found in kelasidi et al 2016a 2016b 7 1 experimental setup the experiments were performed in the marine cybernetics laboratory mc lab at ntnu trondheim norway marine cybernetics labora 2016 in a tank of dimensions l 40 m h 1 5 m and w 6 45 m real time measurements of the position and orientation of the robot were obtained by using an underwater motion capture system from qualisys qualisys motion and www qual 2016 installed in the basin the system consists of six identical cameras that can track reflective markers under water inside a working area of dimensions 12 m 1 35 m 5 45 m in the tank we installed two submerged flat panel with a reflective triangle and square representing two landmarks during the experimental trials the robot used for the experiment was equipped with a front camera with a fov of 30 deg below the camera the robot had mounted a template of markers that allowed the camera positioning system to accurately determine the position and heading of the robot at any time see fig 10 the position of the landmarks was obtained using the underwater camera system by attaching a single reflective marker on the flat panel the positions were then used to compute the reachable set and plan a path following the procedure described in sections 3 and 4 the position and the heading of the robot were received from the motion capture system and sent to the computer where the guidance and the controllers were implemented 7 2 the robot the usr mamba with thrusters consists of 18 identical joint modules mounted horizontally and vertically in an alternating fashion kelasidi et al 2016a liljebäck et al 2014 in order for the robot to move according to a strictly horizontal motion pattern the angles for the joints with vertical rotating axis were set to zero degrees during the experiments the robot had a slightly positive buoyancy and was swimming near the water surface for more details regarding the experimental setup see kelasidi et al 2016a 2016b 7 3 heading control the robot is an articulated auv equipped with two thrusters at the tail module to generate the main forward propulsion and the joint angles are used to create a rudder effect this controller follows the approach presented in sans muntadas et al 2017 where the following method for joint control was proposed to control the robot each joint k 1 n 1 should track a reference signal 47 φ k t φ 0 n k n 1 scaling factor where the scaling factor is used to achieve an increasing deflection of each joint from head to tail this feature is advantageous for this approach because it produces smaller deflections at the head module that otherwise could affect the fov the nominal joint angle ϕ 0 is given by the following pi heading controller which is designed to make the actual heading follow its reference 48 φ 0 k p ψ k i ψ τ d τ where k p 0 and k i 0 are control gains note also that low level joint p controllers are implemented in the microcontrollers inside the modules of each link of the robot making each joint follow the reference angles calculated by 47 in addition a low level thruster controller is implemented responsible for making the thruster inputs follow its references the mapping from the thruster inputs to thruster forces for the underwater snake robot used in these experiments can be found in kelasidi et al 2016a 8 results the path planning and guidance approach are experimentally validated in this section fig 11 shows how the heading controller work on top there is a depiction of the reference and the actual joint angles φ k that curvature in the body shapes act as a rudder and enables the robot to follow the desired heading ψ d the plot below how joint controller is able to steer the robot and make the heading follow the reference trajectory fig 12 shows the planned path and the trajectory of the vehicle as it follows the path the fov is depicted at different instances the representation of the fovs illustrates how at the starting point the landmark is too far away outside of the fov to connect the starting and the final path with only one spiral this requires the path planning algorithm to generate an intermediate waypoint and thus two spiral segments to connect the initial and the final point the resulting path is not a straight line and has to take a longer path to ensure the visibility of a landmark the trajectory of the vehicle is colored in black and shows how the guidance and control system enables the vehicle to follow the path while preserving at least one landmark inside the fov while steering to the path fig 13 shows the evolution of the bearing angle θ l n and range r l n positions of the vehicle relative to each landmark as the vehicle follows the path both plots have a region shaded in violet that represents the fov here it can also be seen how the first landmark the triangle at the beginning cannot be used as a reference because it is out of range when the vehicle gets close enough to this landmark the path switches to the second spiral path that leads to the final point the figure also shows how the bearing of the vehicle converges to the spiral characteristic angle the preservation of a landmark inside the fov is also shown in a series of images obtained from the vehicles camera in the first two images the system uses the square landmark as reference and in the next three the triangle landmark is used as a reference 9 conclusions in this paper a path planning algorithm for underactuated vehicles with a limited fov has been presented in particular vehicles that cannot control its sway motion and can only move forward the primary objective is to describe a method to calculate a series of waypoints that when connected with logarithmic spirals generate a path that ensures the visibility of at least one landmark throughout all the path this has been solved implementing an algorithm that computes the points that can be reached given a starting position and uses this solution to reconstruct the path additionally the paper has proposed a cost function to optimize the length of the path but at the same time penalizing paths with a characteristic angle close to the limits of the fov in such situation the vehicle has a small margin for steering and thus converging slower to the path the paper in addition has proposed a guidance and control system that enables an underactuated vehicle to converge to and follow the proposed path preserving the vision of the landmark asymptotic stability of the proposed guidance and control system has been proven under explicit conditions and experimental results have validated the approach acknowledgments the authors gratefully acknowledge the engineers at the department of engineering cybernetics terje haugen glenn angell and daniel bogen for implementing the necessary components for the experimental setup this work was partly supported by the research council of norway through the centers of excellence funding scheme project no 223254 ntnu amos and by vista a basic research program in collaboration between the norwegian academy of science and letters and statoil 
22970,when gps is not available autonomous vehicles can obtain navigation information by observing a source with a camera or an acoustic system mounted on the frame of the vehicle this information can be used in the navigation and to overcome the lack of other sources of positioning however these systems often have a limited range and angular fov due to this restriction motion along some paths will make it impossible to obtain the necessary navigation information as the source is no longer in the vehicle s fov this paper proposes both a path planning approach and a guidance control law that allows the vehicle to preserve landmarks that are critical for the navigation inside the fov while at the same time converging to the proposed path the suggested approach is experimentally validated by implementation in an autonomous underwater vehicle keywords fov constraint landmark based navigation path planning guidance underactuated vehicle 1 introduction one of the challenges that autonomous vehicles face is navigating in environments where information from the global positioning system gps is not available this is a challenge that affects vehicles and systems that operate indoors inside mines or underwater an alternative to the gps is often computer vision or acoustic systems although computer vision and acoustic systems have proven to be able to produce accurate information they sometimes rely on a single source of information either because the camera information only tracks a single visual landmark or because there is only a single node available of an acoustic network in such cases the ability to navigate depends on the constant observation of the source unfortunately the sensors receiving these signals are often limited by the fov an angular restriction to observe a landmark in some configurations the sensors have the ability to change their direction and therefore partially overcome this limitation stolle and rysdyk 2003 rysdyk 2006 other setups may instead have these sensors fixed to the vehicle s frame and then the observability of the landmark becomes dependent on the vehicle s trajectory this restriction makes some paths blind because by following them the vehicle loses sight of the landmark see fig 1 and this can compromise the vehicle s navigation capabilities the path planning problem thus becomes more challenging as it should not only find a feasible collision free path to connect the start and end points but also preserve the view of the target this restriction is often referred as for the field of view constraint in boyadzhiev 1999 tucker 2000 it is observed that certain animals moving with respect to prey or a light source follow a logarithmic spiral this kind of spiral enables them to maintain the prey or light source in their fov at all times during their motion the existence of such trajectories in nature have inspired solutions to the fov constraint a formal definition of fov is given in bhattacharya et al 2007 which following a similar approach as the reeds shepp car in reeds and shepp 1990 describes a combination of straight lines and vision saturated curves that connect any two points in the plane the time optimal combination of trajectories is found and proven by balkcom and mason 2002 for a omnindirectional robot the length optimal solution for a nonholonomic robot with limited fov is given in salaris et al 2010 and the time optimal solution is described in cristofaro et al 2017 proving that the path can be constructed by a finite set of maneuvers variations of the fov problem are addressed in salaris et al 2012a for side facing sensors and hayet 2012 considers the case in which multiple landmarks must be preserved and salaris et al 2015 a solution in the case where the fov is limited vertically as well in addition maniatopoulos et al 2013 proposes a control law that guides the vehicle toward a desired point by using model predictive control mpc and panagou and kyriakopoulos 2013 uses viable state feedback control to ensure the preservation of the fov in lópez nicolás et al 2010 salaris et al 2011 different control schemes are proposed to follow a path optimal in length with an underactuated robot that can turn on the spot and move backward a common approach for path following control of underactuated vehicles is based on the line of sight los guidance fossen 2011 healey and lienard 1993 breivik fossenet al 2008 the los guidance approach has the advantage of being simple and has a very small computational load fossen et al 2015 this guidance law was also generalized for curved paths in børhaug and pettersen 2006 using a serret frenet frame and extended to handle currents in moe et al 2014 however the different versions of los guidance do not deal with restrictions in the fov in this paper we address this issue by proposing an adapted version of the los guidance law considering the restrictions in the fov the paper considers the fov restrictions both in the path planning and the path following problems and these are tackled in two steps the first step is the design of a path by using logarithmic spiral paths which are a particular type of trajectories that appear as general solutions in fov problems being discussed in bhattacharya et al 2007 salaris et al 2010 2012a lópez nicolás et al 2010 furthermore since underactuated underwater vehicles are considered as opposed to mobile robots moving backwards may not be desirable since often the auv thrusters do not work efficiently in the backwards direction and the steering becomes inefficient this restriction limits the set of points that can be reached compared to a robot that can move forward and backwards such as the results presented in bhattacharya et al 2007 lópez nicolás et al 2010 hayet et al 2014 thus the path planning proposed in this paper requires the computation of the reachable set to identify which destination is feasible this paper extends the preliminary results that were presented in sans muntadas et al 2016 with two main contributions the first is a path planning algorithm that computes the set of points that can be reached preserving a landmark and generates a list of waypoints that can be connected with logarithmic spirals the resulting path allows for connecting two points through a path that when followed preserves the fov of at least one landmark see fig 1 the second contribution of this paper is a guidance and path following control law for underactuated vehicles which is an extension of the existing los guidance laws this control law is specifically designed to follow the logarithmic spirals generated in the first step and in addition it ensures that the vehicle s maneuvers preserve the view of the target compared to the path planning approach of salaris et al 2011 hayet et al 2014 the proposed solution trades some optimality in path length to achieve control robustness by using lyapunov theory we prove that the proposed guidance control law makes the vehicles converge to and follow the path in particular in this paper it is proven that the closed loop error dynamics are globally asymptotically stable the paper is organized as follows section 2 describes the problem of the fov section 3 studies the set of points that are reachable given the fov restrictions section 4 proposes a path planning tool section 5 describes a guidance control system and section 6 examines the stability properties of the closed loop system section 7 presents the experimental setup in section 8 the results of the experimental tests are discussed lastly section 9 presents the conclusions 2 problem description we consider an underactuated autonomous underwater vehicle auv that moves on a plane the vehicle is equipped with a thruster and a rudder that provides forward motion and steering the state of the vehicle is defined by its position x y and heading ψ the vehicle has a front facing sensor such as a camera or a ultra short base line usbl that only receives information by having a landmark inside its fov and within a certain range the environment has multiple landmarks transponders l l 1 l 2 l 3 l n distributed at different locations x l n x l n y l n for each landmark a polar coordinate system is defined 1 r l n x x l n 2 y y l n 2 ϕ l n atan 2 y y l n x x l n θ l n ψ ϕ l n π where with respect to each landmark r l n is the range ϕ l n is the azimuth angle and θ l n is the bearing angle see fig 2 in order for the vehicle to have a landmark inside the fov the following conditions must be satisfied condition 1 the landmark is inside the maximum fov range r l n r max condition 2 the bearing angle with respect to the transponder landmark is inside the angle limits fov θ l n θ max π 2 the objective is to describe a path that connects a starting point x 0 x 0 y 0 to a final point x f x f y f while the fov described by conditions 1 and 2 is satisfied for at least one landmark the path has to have point continuity g 0 thus sudden changes in the tangent of the path are permitted assuming that the transient of turning from one direction to the other does not affect the navigation the vehicle is restricted to moving forward in order to plan a path from a starting point to an end point the proposed method starts by analyzing which points can be reached maintaining that the fov conditions are true r ℝ 2 also a control approach is derived to ensure that the vehicle follows the proposed path 3 reachable sets knowing if a point or an intermediate waypoint is reachable is critical in order to plan a path the answer to this depends on the number of landmarks if there is only a single landmark there exists an analytic expression of the set of points that can be reached we denote this set as γ x 0 ℝ 2 given the case of multiple landmarks to our knowledge there is no analytical expression to define the reachable set of points this section thus uses the existing analytical solution of a single landmark to propose and compute a discretized solution of the reachable set given the case of multiple landmarks this section is divided into three parts the first presents the case of the reachable set when there is only a single landmark the next part explains and derives how the solution can be used to describe the reachable set given multiple landmarks and the last part proposes an algorithm and a search tree to compute the reachable set 3 1 single landmark at any given point of a curve or a path described in polar coordinates r ϕ the angle between the radius and the tangent θ is expressed as 2 tan θ r ϕ d r ϕ d ϕ if the angle θ is kept constant the solution of the differential equation that goes through an initial point x 0 r 0 ϕ 0 becomes a logarithmic spiral the literature sometimes refers to this constant angle as the characteristic angle salaris et al 2010 the logarithmic spiral is described by 3 r ϕ r 0 e ϕ ϕ 0 tan θ any point r ψ that is closer to the landmark than the initial point i e r r 0 can be connected with the initial point x 0 r 0 ϕ 0 using the following characteristic angle θ and in logarithmic spiral given in equation 3 4 θ atan ϕ ϕ 0 ln r r 0 thus if the characteristic angle of the spiral θ fulfils condition 2 an underactuated vehicle following that path without sideslip will reach this point r ψ without losing the angular fov consequently all the points that satisfy this condition are contained inside the boundaries described by two logarithmic spirals given by equation 3 with a characteristic angle θ equal to the angular limits of the fov θ θ max and θ θ max in salaris et al 2012a these boundaries are referred to as the limit trajectories t r and t l the set of points reachable from a starting point x 0 is illustrated in fig 3 and can be expressed as 5 γ θ max l n x 0 r l n ϕ l n δ r l n r 0 e δ tan θ max δ π π r l n r max remark 1 the reach case is studied under the property of symmetrical fov for the case of non symmetrical θ min θ θ max an analytic description of the reach set can also be developed this can be of particular interest for planning trajectories for vehicles that are fitted with peripheral vision such as self driving cars or surveillance uavs however the controller described later in this paper requires symmetrical fov and we will therefore not go further into this topic the reader might refer to salaris et al 2012b for a detailed analysis of optimal paths given such circumstances 3 2 multiple landmarks in the presence of multiple landmarks the solution of the reachable set becomes more complex and needs to take into account the different choices of available landmarks and the possibility of switching between them hayet et al 2014 with multiple landmarks the problem becomes much more complex and finding a analytical solution to describe the reachable set is opposite to the case of a single landmark described in equation 5 thus in this paper we propose computing the reachable set using a discretization of the space and extending the results of a single landmark we first define the operator ƶ 6 ƶ x n n γ θ max l n x which is the union of all the individual reachable sets for each landmark given a starting point x 0 the result is all the points that can be connected with a logarithmic spiral by observing only an individual landmark see plot a in fig 4 the set ƶ does not contain all the possible reachable points because at some points in ƶ the vehicle will be able to switch and use another landmark as a reference a possible way to compute the reachable set after such a switch is to repeat ƶ but for all the reachable points previously obtained thus we define ω as the set of points that can be reached from a given set of points a 7 ω a x a ƶ x by iteratively repeating this ω operation on the last obtained set it allows us to find all the points that can be connected with logarithmic paths see plot b c in fig 4 we denote the iteration as r l were l is the number of iterations of ω 8 r l x 0 ω r l 1 x 0 ω ω ω ω ƶ x 0 3 3 computation of the reachable set the iterative operation of computing the reachable set can be resource consuming to alleviate this we simplify the computation of the reachable set by first calculating the hull of the actual set and then the operator ƶ is only applied to the points belonging to the hull note that this reduces the search for new reachable points based on new spirals that start at the boundaries of the current reachable set simplifying the computation of ω 9 ω a x a z x a x hull a ƶ x image 1 the proposed algorithm iteratively searches for new points that can be connected with logarithmic spirals the points that are found to be reachable are stored in a set r to alleviate the computational complexity it calculates the hull h of the known reach set and searches for new points according to equation 9 the points that have already been explored are stored in e and will not be visited again the variable t inside the second for loop temporarily stores the new found reachable points at the same time a search tree g is constructed which connects the new found points with its founder this search tree will later be used to reconstruct an initial path solution the time complexity of the algorithm is o n 2 where n in this particular case represents the number of points or nodes in the discretized set 4 path planning this section describes and proposes a path p that connects the initial and the final point through n concatenated logarithmic spirals the proposed method for path planning uses the search tree g to reconstruct the path by reading backward through the search tree a series of waypoints are found the method starts by reading g x f x i 1 which returns the previous waypoint then iteratively setting g x i 1 x i 2 and we repeat this operation until g x i k x 0 fig 5 illustrates an example of the search tree and the obtained path in this way it returns a list of waypoints x x 0 x 1 x i 1 x f this list of waypoints makes for an initial solution but in most of cases it is not optimal this is due to the way reachable points are found in the algorithm every time the algorithm finds a new reachable point it stores the origin from where that new point was found to be reachable in the algorithm g t x also the simplification proposed in equation 9 to compute the reachable sets uses the hull to compute a solution and as a consequence of this the solution includes many waypoints that are at the limits of the reachable set this puts the spirals at the limits of the fov something which complicates the control and guidance of the vehicle since the convergence to the path might be slower due to a small margin for steering and an overshoot would make the landmark disappear from the fov for these reasons after computing an initial path we optimize it using the following cost function to penalize spirals with bigger characteristic angles θ i see fig 6 4 1 cost function the length of a logarithmic spiral segment can be found integrating a curve between two radius points 10 s i r i l n r i 1 l n 1 r d r d ϕ 2 d r r i l n r i 1 l n cos θ i however if we optimize the path solely based on length this would result in a path composed by straight lines and spiral trajectories at the limits of the fov as seen in bhattacharya et al 2007 thus we propose a cost function c x i 1 x i l n λ based on the spiral length but add an exponential term λ 0 to the cosine thus penalizing bigger characteristic angles θ i the cost of a spiral segment given a reference landmark l n is defined as 11 c x i 1 x i l n λ if r i l n r max or θ i θ max r i l n r i 1 l n cos θ i 1 λ else then since the vehicle can choose between multiple reference landmarks we optimize with respect to which reference landmark makes a shorter path thus the minimal cost of a segment given by two waypoints is defined as the smallest among the different landmark choices l n in l 12 c min x i 1 x i l λ minimize l n c x i 1 x i l n λ subject to l n l the optimization problem solved here using a random walk consists of finding a list of optimized waypoints x and a list of k reference landmarks l l i e l l 2 l 1 l 5 l n with minimal cost in the sum of the segments note that some solutions might use the same landmark more than once 13 minimize x i 1 k c min x i 1 x i l λ subject to x ℝ 2 n remark 2 note that the optimization of the waypoints does not need to belong to the discretized set since the cost function for each spiral guarantees that the fov restrictions are maintained 4 2 path description once the optimized list of waypoints is found we define the path p as a result of connecting all the waypoints with logarithmic spirals each spiral is parametrized by ϖ 0 1 and an index i used to refer to the logarithmic spiral that connects two consecutive waypoints i e x i 1 with x i 14 p p ℝ 2 p r l i ϖ i ϕ l i ϖ i ϖ 0 1 i 1 n x l where 15 r l i ϖ i ϖ r i 1 l i r i l i r i l i ϕ l i ϖ i ϕ i l i tan θ i l i ln ϖ r i 1 l i r i l i 1 1 θ i atan ϕ i 1 l i ϕ i l i ln r i 1 l i r i l i alternatively it can be expressed in global cartesian coordinates 16 x ϖ i x l i ϖ r i 1 l i r i l i r i l i cos ϕ l i ϖ i y ϖ i y l i ϖ r i 1 l i r i l i r i l i sin ϕ l i ϖ i ψ ϖ i θ i ϕ l i ϖ i π the following fig 4 2 shows the results of the optimization as it can be seen the initial solution red line is not optimal and goes trough the limits of the fov three more paths are shown which display the difference of using the proposed cost function the purple line shows the result of optimizing the position of the waypoints when λ 0 which is equivalent to using as a cost function the length of the path this optimization leads to a path very close to the limits of the fov the other two black and yellow line show the path for other values of λ 0 5 and λ 2 and it can be seen that the paths are longer in length but the spirals have smaller characteristic angles remark 3 note that the path planning tool finds the path with the minimum number of spirals a more optimal solution can also be found by adding more waypoints to the optimization with a large amount of way points any solution of a path with limited fov could be discretized using logarithmic spirals sans muntadas et al 2017 5 guidance and control system the control objective is to make the vehicle converge to and follow each logarithmic spiral segment defined between two consecutive waypoints x i and x i 1 using the list of reference landmarks l i to achieve this the system uses a serret frenet frame to describe the position of the vehicle relative to the path a guidance law is then proposed to ensure that the vehicle follows the trajectory 5 1 serret frenet frame update law the serret frenet frame describes the position of the vehicle relative to a virtual particle that moves along the path similar approaches for underwater vehicles have been presented in fossen 2011 moe et al 2014 encarnaçao and pascoal 2000 the total distance travelled s parametrizes the position of the particle within the path afterwards the position of the vehicle relative to the particle is calculated giving x b f y b f ψ b f cf fig 7 the position of the particle along the path is updated as the vehicle moves according to a proposed update law s since the path is described in multiple spiral segments the system has to identify at which segment of the spiral the particle is for this two more terms are used to describe the position one is the index i s that identifies at which spiral segment the particle is and the other is the distance travelled within that particular spiral segment z the index i s is found by identifying the smallest i such that the travelled distance s is smaller than the sum of the lengths of the first i segments an offset s 0 can also be used for an early switch of spiral which can be useful for vehicles with large inertia 17 i s min i s t i 1 i s i s s 0 once i s is known the distance z travelled within that specific segment can be calculated by subtracting the sum of the lengths of all the previous segments from the total distance travelled s 18 z s i 2 i s s i 1 then the variable ϖ that identifies the position within the spiral according to the description in equations 14 and 15 can also be defined as the ratio travelled within the spiral segment which makes the position of the particle within the segment ϖ s 19 ϖ s z s i s given ϖ s i s the global position of the virtual particle can be found using the description of the path in equation 16 x s x ϖ s i s y s y ϖ s i s ψ s ψ ϖ s i s or r s l n ϖ s i s ϕ s l n ϖ s i s when using polar coordinates afterwards combining the particle position and the vehicle state x y ψ the position relative to the serret frenet frame can be calculated as see an illustrative example in fig 7 20 x b f x x s y b f y y s ψ b f ψ ψ s the kinematics of the body frame relative to the serret frenet frame can then be described by the following expression børhaug and pettersen 2006 were u is the surge speed v the sway and κ is the curvature of the path 21 x b f y b f cos ψ b f sin ψ b f sin ψ b f cos ψ b f u v s 0 s 0 κ κ 0 x b f y b f alternatively in an expanded form 22a x b f u cos ψ b f v sin ψ b f s s κ y b f 22b y b f u sin ψ b f v cos ψ b f s κ x b f 5 2 guidance and update law the control objective of making the vehicle converge to and follow the path can then be formalized as follows 23 lim t x b f t 0 lim t y b f t 0 for the guidance the following assumption have been considered assumption 1 the vehicle moves with a bounded forward speed u where 0 u min u u max and the sway speed v is bounded by v v max assumption 2 the angle γ ϕ ϕ s between the angular coordinate of the vehicle s position ϕ and the angular coordinate of the virtual point of the serret frenet frame ϕ s is assumed to be close to zero γ 0 remark 4 assumption 2 depicts that the vehicle and the serret frenet particle observe the landmark from the same angle this is safe to assume when the distance to the path is relatively small compared to the distance to the landmark this simplification avoids needing to consider the position relative to the landmark that should be kept within the fov and thus makes it possible to adapt the well known line of sight guidance for the path following assumption 3 the crab angle β atan v u is small enough such that it does not interfere with the fov remark 5 marine vehicles experience sway velocities while turning and in order to follow the desired path a crab angle is then needed to compensate for such velocities assumption 3 considers that the crab angle β is negligible compared to the whole range of the fov so that it does not need to be considered thus avoiding an over complication of the guidance law the proposed method uses the described logarithmic spirals to design a path that always preserves the fov however whether the vehicle is oriented along the path will depend on the controller used for path following a controller which does not consider the limits of the fov can make the vehicle lose sight of the landmark while steering towards the path the following equation describes the update law that will drive the serret frenet frame along the path as the vehicle moves 24 s u cos ψ b f v sin ψ b f k x x b f the first two terms are the projection of the vehicle velocity onto x b f by doing so the frame moves as fast as the vehicle in that direction for this particular application it is important that x b f remains equal to 0 otherwise an offset between the path and the followed trajectory might appear for this reason the third term k x x b f is introduced which acts as a restoring spring ensuring the convergence of x b f to 0 this allows for overcoming initialization errors or numerical errors caused by the integration of s the following guidance law illustrated in fig 8 is an extension of the well known los guidance law and has been designed for underactuated vehicles that have no independent control input in the sideways direction it commands a desired yaw angle that we will prove later that makes the system described by 21 converge to the desired path 25 ψ d ψ s θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 saturation controller where δ 0 is a design parameter inspired by the line of sight guidance method fossen et al 2003 referred to as the look ahead distance the smaller the value of δ is chosen the more aggressive maneuvering towards the path the larger the value of δ the more stable the system and the slower the convergence to the path is the term β atan v u compensates for the crab angle u is the surge velocity v is sway velocity and u u 2 v 2 the term d θ i is a shifting parameter that makes the heading angle at y b f 0 the same as the desired constant characteristic angle θ i 26 d θ i δtan θ i tan 2 θ max tan 2 θ i thus if a controller is able to make the vehicle follow a desired heading ψ ψ d substituting ψ d according to equation 16 gives 27 θ l n ϕ l n π ψ d θ i ϕ s l n π ψ s θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 θ l n ϕ l n ϕ s l n γ atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 based on assumption 2 3 the crab angle β and the angle γ between the angular coordinate of the serret frenet virtual particle ϕ s and the angular coordinate ϕ of the vehicle s position are too small to affect the fov thus 28 θ l n atan tan θ max y b f d θ i δ 2 y b f d θ i 2 tan θ l n tan θ max y b f d θ i δ 2 y b f d θ i 2 1 thus since the factor of tan θ max is bounded between 1 and 1 the magnitude of the bearing angle θ l n is always smaller than θ max 29 θ l n θ max 5 3 yaw controller the yaw dynamics of the vehicle can in general be written fossen 2011 30 ψ r r f r u v r τ r the following feedback linearizing controller is used to follow the desired yaw angle ψ d provided by the guidance law 25 31 τ r f r u v r ψ d k ψ ψ ψ d k r ψ ψ d where k ψ and k r are strictly positive constant controllers gains by defining ψ ψ ψ d and ψ ψ ψ d and substituting the controller 31 into 30 the yaw error dynamics can be written 32 ξ ψ r 1 0 k ψ k r ψ r λ ξ the system given by 32 is linear and time invariant since the control parameters k ψ 0 and k r 0 λ is hurwitz and the origin ξ 0 is uniformly globally exponentially stable uges the controller 31 thus ensures exponential tracking of the desired yaw angle ψ d provided by 25 5 4 example the simulation illustrated in fig 9 shows the difference between using a conventional los and the proposed guidance the figure shows two different approaches the first one uses los and we see that the vehicle is able to converge much faster however during the approach the landmark is not kept inside the fov contrary to this the proposed guidance approach is able to take into account the limitations of the fov and turn less aggressively thus always maintaining the landmark inside the fov limits 6 stability analysis the controller system proposed in this paper allows an underactuated vehicle to follow a spiral while at the same time preserve the vision of a target to apply this controller to a large class of underactuated vehicles the stability proof has been restricted only to the kinematic model in order to prove the stability we rewrite the expression of ψ b f ψ ψ s 33 ψ b f ψ ψ d ψ ψ s then substituting ψ d by the guidance law 25 34 ψ b f ψ θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 ψ s ψ d ψ s ψ b f ψ θ i atan v u atan tan θ max y b f d θ i δ 2 y b f d θ i 2 α then we group the saturation controller the crab angle and the characteristic angle into a variable α where the expressions for sin α and cos α can be expanded to 35 cos α u v tan θ i δ 2 y b f d θ i v u tan θ i tan θ max y b f d θ i u tan 2 θ max 1 y b f d θ i 2 δ 2 cos θ i sin α v u tan θ i δ 2 y b f d θ i u v tan θ i tan θ max y b f d θ i u tan 2 θ max 1 y b f d θ i 2 δ 2 cos θ i following same approach as in moe et al 2014 sin ψ b f and cos ψ b f can be written as 36 sin ψ b f sin ψ α sin α ψ sin ψ ψ cos α cos ψ 1 ψ sin α cos ψ b f cos ψ α cos α ψ cos ψ 1 ψ cos α sin ψ ψ sin α by substituting the update law 24 into equation 22 we obtain 37a x b f k x x b f s κ y b f 37b y b f u sin ψ b f v cos ψ b f s κ x b f then substituting the update law 24 the controller 31 and the guidance law 25 into equation 21 we obtain 38 x b f k x x b f s κ y b f y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ k 2 cos θ i s κ x b f ψ h u ξ where h u ξ is 39 h u ξ sin ψ ψ u sin θ i tan θ i y b f d θ i cos θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ i 2 cos ψ 1 ψ u cos θ i tan θ i y b f d θ i sin θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ max y b f d θ i 2 then by using the coordinates of the yaw error dynamics defined in 32 the closed loop system can be written 41 x b f y b f k x x b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i s 0 κ κ 0 x b f y b f h u ξ ξ 42 h u ξ ξ 0 0 h u ξ 0 ψ r the system composed by equations 32 and 41 constitutes a cascaded system where the nominal system is perturbed by the exponentially stable error dynamics 32 through the interconnection term 42 theorem 1 given an underactuated vehicle described by the dynamical system 21 and 30 if assumptions 1 3 hold then the update law 24 the guidance law 25 and the controller 31 guarantee the achievement of the control objectives 23 proof to prove stability of the nominal part of 41 we choose the quadratic lyapunov function candidate v 1 2 x b f 2 y b f 2 the derivative of v is then obtained as 43 v x b f x b f y b f y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f w y b f δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i k x x b f 2 this expression has two terms first k x x b f 2 which is always 0 and a second one where the the denominator is always positive since condition 2 restricts cos θ i to always being positive in the range of θ i therefore by showing that the numerator which we call w y b f 0 being zero has a unique solution at y b f 0 and that this solution is also a maximum will show that v is negative definite 44 w y b f u tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f w 0 0 by taking the first and second derivative of w y b f it can be seen that y b f 0 is a maximum value of w 45 w 0 0 w 0 2 u tan θ max 1 tan 2 θ i tan 2 θ max 0 therefore v is bounded by 46 v u min tan θ max y b f d θ i tan θ i δ 2 y b f d θ i 2 y b f δ 2 1 tan 2 θ i y b f d θ i 2 cos θ i k x x b f 2 v is thus shown to be negative definite and thus the nominal system is ugas theorem 1 from sontag 1989 can now be applied to prove stability of the entire cascaded system in particular the nominal system is ugas with a quadratic lyapunov function the perturbing error dynamics are uges and the interconnection matrix h u ξ is globally bounded under assumption 1 which guarantees that u is bounded between u min u min and u max u max 2 v max 2 consequently the cascaded system in 41 and 32 is ugas and x b f x b f thus uniformly asymptotically converges to zero thus the control objectives 23 are satisfied 7 experimental setup underwater snake robot and controllers this section presents the experimental setup used to implement and test the guidance and control for an underactuated vehicle described in section 5 with a path planned according to the algorithm proposed in section 4 for the experimental testing in this paper we used the underwater snake robot mamba with thrusters kelasidi et al 2016a as a test platform to validate the proposed approach this is an articulated auv with a thruster module for forward thrust and where the joints of the robot are used instead of rudders to control its direction in the following the experimental setup and details of the underwater snake robot are briefly presented more details can be found in kelasidi et al 2016a 2016b 7 1 experimental setup the experiments were performed in the marine cybernetics laboratory mc lab at ntnu trondheim norway marine cybernetics labora 2016 in a tank of dimensions l 40 m h 1 5 m and w 6 45 m real time measurements of the position and orientation of the robot were obtained by using an underwater motion capture system from qualisys qualisys motion and www qual 2016 installed in the basin the system consists of six identical cameras that can track reflective markers under water inside a working area of dimensions 12 m 1 35 m 5 45 m in the tank we installed two submerged flat panel with a reflective triangle and square representing two landmarks during the experimental trials the robot used for the experiment was equipped with a front camera with a fov of 30 deg below the camera the robot had mounted a template of markers that allowed the camera positioning system to accurately determine the position and heading of the robot at any time see fig 10 the position of the landmarks was obtained using the underwater camera system by attaching a single reflective marker on the flat panel the positions were then used to compute the reachable set and plan a path following the procedure described in sections 3 and 4 the position and the heading of the robot were received from the motion capture system and sent to the computer where the guidance and the controllers were implemented 7 2 the robot the usr mamba with thrusters consists of 18 identical joint modules mounted horizontally and vertically in an alternating fashion kelasidi et al 2016a liljebäck et al 2014 in order for the robot to move according to a strictly horizontal motion pattern the angles for the joints with vertical rotating axis were set to zero degrees during the experiments the robot had a slightly positive buoyancy and was swimming near the water surface for more details regarding the experimental setup see kelasidi et al 2016a 2016b 7 3 heading control the robot is an articulated auv equipped with two thrusters at the tail module to generate the main forward propulsion and the joint angles are used to create a rudder effect this controller follows the approach presented in sans muntadas et al 2017 where the following method for joint control was proposed to control the robot each joint k 1 n 1 should track a reference signal 47 φ k t φ 0 n k n 1 scaling factor where the scaling factor is used to achieve an increasing deflection of each joint from head to tail this feature is advantageous for this approach because it produces smaller deflections at the head module that otherwise could affect the fov the nominal joint angle ϕ 0 is given by the following pi heading controller which is designed to make the actual heading follow its reference 48 φ 0 k p ψ k i ψ τ d τ where k p 0 and k i 0 are control gains note also that low level joint p controllers are implemented in the microcontrollers inside the modules of each link of the robot making each joint follow the reference angles calculated by 47 in addition a low level thruster controller is implemented responsible for making the thruster inputs follow its references the mapping from the thruster inputs to thruster forces for the underwater snake robot used in these experiments can be found in kelasidi et al 2016a 8 results the path planning and guidance approach are experimentally validated in this section fig 11 shows how the heading controller work on top there is a depiction of the reference and the actual joint angles φ k that curvature in the body shapes act as a rudder and enables the robot to follow the desired heading ψ d the plot below how joint controller is able to steer the robot and make the heading follow the reference trajectory fig 12 shows the planned path and the trajectory of the vehicle as it follows the path the fov is depicted at different instances the representation of the fovs illustrates how at the starting point the landmark is too far away outside of the fov to connect the starting and the final path with only one spiral this requires the path planning algorithm to generate an intermediate waypoint and thus two spiral segments to connect the initial and the final point the resulting path is not a straight line and has to take a longer path to ensure the visibility of a landmark the trajectory of the vehicle is colored in black and shows how the guidance and control system enables the vehicle to follow the path while preserving at least one landmark inside the fov while steering to the path fig 13 shows the evolution of the bearing angle θ l n and range r l n positions of the vehicle relative to each landmark as the vehicle follows the path both plots have a region shaded in violet that represents the fov here it can also be seen how the first landmark the triangle at the beginning cannot be used as a reference because it is out of range when the vehicle gets close enough to this landmark the path switches to the second spiral path that leads to the final point the figure also shows how the bearing of the vehicle converges to the spiral characteristic angle the preservation of a landmark inside the fov is also shown in a series of images obtained from the vehicles camera in the first two images the system uses the square landmark as reference and in the next three the triangle landmark is used as a reference 9 conclusions in this paper a path planning algorithm for underactuated vehicles with a limited fov has been presented in particular vehicles that cannot control its sway motion and can only move forward the primary objective is to describe a method to calculate a series of waypoints that when connected with logarithmic spirals generate a path that ensures the visibility of at least one landmark throughout all the path this has been solved implementing an algorithm that computes the points that can be reached given a starting position and uses this solution to reconstruct the path additionally the paper has proposed a cost function to optimize the length of the path but at the same time penalizing paths with a characteristic angle close to the limits of the fov in such situation the vehicle has a small margin for steering and thus converging slower to the path the paper in addition has proposed a guidance and control system that enables an underactuated vehicle to converge to and follow the proposed path preserving the vision of the landmark asymptotic stability of the proposed guidance and control system has been proven under explicit conditions and experimental results have validated the approach acknowledgments the authors gratefully acknowledge the engineers at the department of engineering cybernetics terje haugen glenn angell and daniel bogen for implementing the necessary components for the experimental setup this work was partly supported by the research council of norway through the centers of excellence funding scheme project no 223254 ntnu amos and by vista a basic research program in collaboration between the norwegian academy of science and letters and statoil 
22971,the present work aims to provide a comprehensive early stage approach to optimise the design synthesis and operation of a marine energy system for liquified gas carriers considering their economic and technical aspects and also weather along the route part a of this work details the approach that we have developed while part b will summarise the first part it will then describe the case study results and discussion as well as the conclusion various propellers 16 engines and 4 operational profiles are assessed in this part we will apply a differential evolution optimisation algorithm whose objective function will be maximised as the net present value the case study is designed to use a liquefied natural gas carrier of 175 000 m3 sailing between lake charles usa and tokyo bay japan via the panama canal all of the suitable matchings for 15 023 propellers are found this approach shows a gain of 22 between the worst individual of the initial population and the worst individual of the final population the required brake power is approximately 22 higher for rough weather than for still water a difference of over 120 was found by comparing varied matchings of economic scenarios and fuel profiles our approach shows a significant gain and highlights the value of exploring a broad range of energy system configurations in an integrated manner especially considering the weather conditions keywords optimisation propulsion dual fuel diesel engine fixed pitch propeller net present value 1 introduction decisions of the greatest impact are made in early stages of ship design when the least information and greatest uncertainty are present chalfant 2015 hence developing ship design tools to make more information available sooner and pushing decision points for later examination is quite advisable in this sense simulations of the overall ship energy system and optimisation studies are of great interest some references published over the last decade in this field include dimopoulos et al 2008 theotokatos 2008 aldous and smith 2012 theotokatos and tzelepis 2013 man 2014 cichowicz et al 2015 tillig et al 2016 mizythras et al 2018 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 and trivyza et al 2018 and a more complete and descriptive state of the art is addressed in the part a of this study to the best of authors knowledge this is the first comprehensive study to focus on the optimisation of energy system selection for liquefied natural gas carriers lngcs fitted with dual fuel low speed diesel engines considering engine propeller and weather conditions within an integrated approach similar comprehensive approaches to simulate and optimise ship energy systems are also found in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 and trivyza et al 2018 the low occurrence of studies found about the optimisation of diesel engine selection might arise from the shortage of suitable engine models for optimisation problems the most used engine models are the so called zero dimensional engine model medica et al 2009 payri et al 2011 guan et al 2015 mavrelos and theotokatos 2018 and the mean value engine model theotokatos 2008 2010 theotokatos and tzelepis 2013 cichowicz et al 2015 guan et al 2014 they have also been combined to explore the advantages of both in baldi et al 2015 and theotokatos et al 2018 when there is no interest in the engine s internal processes the engine can be merely represented by functions that relate for instance load and speed to specific fuel consumption this is the so called transfer function engine model which is the simplest and fastest method precisely for these reasons this is the most suitable model for the design optimisation of the ship s overall energy system some references in this field can be found in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 trivyza et al 2018 benvenuto et al 1994 stefanopoulou and smith 2000 benvenuto and campora 2005 altosole and figari martelli 2014 and marques et al 2017 however models appropriate for iterative procedures that do not require calibration for every single engine were developed in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 marques et al 2017 all based on regression analyses being the last one used in the present work because it addresses dual fuel low speed diesel engines the present work proposes a comprehensive early stage approach to optimise the design synthesis and operation of lngc energy systems considering economic and technical aspects in addition to weather conditions this approach assesses various configurations of propellers and prime movers to find the best matching and it also considers several forms of propulsion chains the need for a re liquefaction plant is also assessed constraints are incorporated to avoid propellers that may present issues regarding strength cavitation and vibration this approach considers different operational profiles for service speeds and fuel to maximise the net present value npv this measure of merit considers operational expenditures opex income and capital expenditures capex given that the methodology was detailed in part a of this study the next section will briefly summarise the methodology the case study results and discussion and the main conclusions will then be presented 2 methodology our method consists of an optimisation process to find the synthesis of components their design characteristics and the operational profile that maximise the npv of an lngc herein the synthesis of components refers to the condition of the propulsion system to hold one or two main engines each one driving a propeller and the existence of shipboard re liquefaction the component design characteristics refer to the propeller and engine specification operational profile refers to the service speed and the fuel to be burnt in each part of the journey namely the fuel profile all of the computations were performed in matlab the proposed approach is explained hereinafter by means of a flowchart further details and an overview of each model can be found in part a of this work fig 1 illustrates the proposed approach towards the optimisation of the synthesis design and operation of an lngc energy system this figure shows the different computations that were followed including the input and output data given a guess of optimisation design variables that is propulsion parameters and service speed the first step is to estimate the brake power and shaft speed in service for each route track the next steps are to compute the specified maximum continuous rating smcr and then determine the suitable engines while still considering the initial guess of the design variables the fourth step is to assess the npv for each suitable engine considering the different fuel profiles having accomplished this a simple search is performed to find the matching engine and fuel profile that holds the maximum npv which is the optimum for that guess of design variables all of these steps are executed iteratively by the optimisation algorithm and the convergence is verified at the end of each run if the algorithm has converged then the optimum engine propeller matching was reached otherwise the optimisation algorithm makes a new guess of propulsion parameters similarly if there are no suitable engines among the available options during a run then that initial guess of design variables is considered to be infeasible and the optimisation algorithm interrupts the run to guess new design variables and then return to the first step 3 case study this section addresses the ship and energy system parameters that were adopted to test the relevance of the developed approach details about the route operational profiles and the economic and optimisation issues are also included 3 1 ship the case study of an lngc with a cargo capacity of 175 000 m3 and with the parameters listed in table 1 was proposed as one may notice there are several different parameters for laden and ballast operation while others do not vary the energy system of the ship is shown schematically in fig 2 where it can be noted that the bog can feed the gcu the dual fuel generation sets the bog compression system and the re liquefaction plant meanwhile dual fuel generation sets provide electricity to the re liquefaction plant other consumers and the bog compression system the existence of a re liquefaction system is not mandatory the ship can hold it or not likewise the ship can have two propulsion chains or only one table 2 lists the energy system parameters for the studied ship some data namely sp bog p o t h and p c o m were achieved by regression from man 2014 the s f o c g e s g c g e s p o c g e and η g were achieved by considering generation sets with engines w34df of 435 kw per cylinder wartsila 2015 because the composition of bog is time dependent an average value for l h v b o g was taken from dimopoulos and frangopoulos 2008 the values of all of the specific fuel consumptions including those from the engine model developed in marques et al 2017 were taken regarding standard lower heating values of 42 700 kj kg and 50 000 kj kg respectively for liquid l h v l and gaseous fuel l h v g they must therefore be rectified regarding lhv hfo and lhv bog assuming that the engine efficiency is a constant regarding fuels of the same phase gaseous or liquid the specific fuel consumption becomes inversely proportional to the lhv hence eq 1 was used to find the specific heavy fuel oil consumption s f o c h f o from the specific fuel oil consumption sfoc for lhv l the specific pilot heavy fuel oil consumption s p o c h f o was analogously calculated similarly the specific bog consumption s g c b o g was calculated from the specific gas consumption sgc for lhv g using eq 2 1 s f o c h f o s f o c l h v l l h v h f o 2 s g c b o g s g c l h v g l h v b o g 3 2 route the ship travels in laden from lake charles to tokyo bay via the panama canal and it returns in ballast following the great circle route as shown in fig 3 this route is used because it is the shortest course between two points on the surface of a sphere the topology of the monthly average wind speed for december 2015 is presented in the same figure a total of 20 way points were considered dividing the route into 19 tracks table 3 presents the route parameters of interest for each route track rt where s is the route track length whilst bn and θ l are 2015 average values respectively concerning beaufort number and encounter angle for the laden trip it is of note that the encounter angle for ballast trip is the supplementary angle of θ l 3 3 operational profile the ship has a different operational profile regarding service speed and fuel to burn depending on the stage of the route as presented in table 4 three levels of service speed were identified to reduce pollution such that the smaller the distance from a continent the slower the speed thus the three levels were low for v r w 12 0 knots kn intermediary for v r w 16 0 kn and high for v r w 19 5 kn moreover because cleaner fuels must be burnt between way points 1 and 5 and also between 19 and 20 due to environmental rules the following four fuel profiles fps were proposed 1 prime mover and generation sets burn hfo wherever possible and mgo only where is necessary such that bog is completely re liquefied 2 prime mover and generation sets burn hfo wherever possible and bog only where is necessary such that only the remaining bog is re liquefied in this case wherever bog is applied the pilot oil is mgo 3 prime mover and generation sets burn only bog in laden while in ballast they burn hfo wherever possible and mgo where is necessary such that only the remaining bog is re liquefied in this case pilot oil is always mgo for the generation sets while the prime mover uses hfo wherever is possible and mgo only where cleaner fuels are required 4 prime mover and generation sets only burn bog during the entire voyage such that there is no re liquefaction plant and the remaining bog is burnt in a gas combustion unit gcu pilot oil is always mgo for the generation sets while the prime mover uses hfo wherever possible and mgo only where cleaner fuels are required although the total time of a round trip mainly depends on the service speeds a constant standing period of 24 h in each port for loading and unloading was also considered moreover this ship has an idle time of 14 days for dry docking or afloat repairs every 2 5 years which is important to calculate the average number of round trips a year n r n d and to estimate the fouling service margin s m f 3 4 economic and optimisation parameters table 5 presents the economic parameters where c j o u includes only the port fees and the panama canal tolls over a round trip the optimisation variables and their ranges are listed in table 6 the last five rows contain the only discrete variables whereas the others are continuous moreover the last three variables are the only secondary ones such that they are not input data they are dependent on the others and they are achieved by running the optimisation algorithm although they are also optimised besides the optimisation variables it is important to mention the factors related to mutation f and crossover cr which equal 0 8 and 0 5 respectively 4 results and discussion the next section will describe the influence of the optimisation algorithm parameters on the npv along the generations the evolution of each variable and the effectiveness of the constraints are assessed including the engine and fuel profile selection effect finally the weather condition effect is discussed 4 1 optimisation algorithm parameters it was necessary to first verify if the population size n p and the number of generations n g used were suitable the convergence of optimisation is heavily dependent on these parameters and their ideal values are specific to every single case therefore three combinations of these parameters were assessed by plotting the maximum mean and minimum of the objective function throughout the generations as shown in fig 4 by comparing fig 4a and b one can notice that doubling the number of generations has a small effect on the objective function doubling the population size was even less influential as can be seen when comparing fig 4b and c thus a population of 120 individuals and 120 generations fig 4c were considered suitable the processing times for a computer fitted with a 3 50 ghz intel core i7 5930k processor with 16 gb of ram were 1 6 2 7 and 5 9 h respectively for case a b and c the worst individual of the final population in comparison with the worst individual of the initial population had the objective function npv increased by 21 20 and 22 respectively for case a b and c 4 2 optimisation summary table 7 shows the optimisation summary which shows the effectiveness of the constraints and a number of computations performed by the algorithm remarkably almost 48 of the 15 023 configurations that were assessed by the algorithm were constrained the peripheral velocity constraint was responsible for over 33 of the rejected designs whereas cavitation was responsible for over 31 the engine was responsible for 18 strength was responsible for 13 and the resonance constraint was responsible for under 4 this table includes some remarks about the optimisation process overall 623 designs were assessed to create the initial population which means that 1 out of every 5 192 was feasible and each offspring member took on average 1 4 s to be generated some particularities were noted about the designs that were rejected due to each constraint over 75 of the designs rejected due to the strength constraint were presented in combination high service speed v r w h number of blades z greater than or equal to six and only one propulsion chain z p nevertheless as 99 of these rejected designs presented z 6 the number of blades was the most influential parameter similar remarks are presented for each constraint in table 7 given that 64 of the designs rejected due to the cavitation constraint had a e a o 0 675 and almost 80 of those rejected due to peripheral velocity had a e a o 0 675 there is no general advice about the best value for expanded area ratio the same occurs for other parameters consequently there is no general advice about the propeller configuration which highlights the usefulness of the proposed approach fig 5 shows the evolution of the 14 optimisation variables for the best individual of each generation it can be observed that almost all of the parameters presented a significant variation range and all of them were steady from the 86 th generation until the end various engines 2 e i d 13 with various numbers of cylinders 5 z c 9 were the best depending on the generation meanwhile fuel profile fp id was the only variable that remained steady throughout the generations this is due to the strong relationship between fuel profile and fuel unit cost which was not changed this fuel profile was always optimum because in the fp2 the ship uses the fuel of lowest unit cost hfo wherever possible and the second cheaper fuel bog only where necessary table 8 presents average μ and standard deviation σ for the optimisation variables and also four alternatives of synthesis design and operation sdo from the final population the variables v r w l l v r w i l v r w l b v r w i b and d presented average values close to their upper limits and low σ which indicates a trend similarly z p trended to its lower limit that is one engine driving directly one propeller fp id presented σ equals zero because there was no variation regardless the other variables as previously explained and illustrated in fig 5 the sdo1 and sdo4 in table 8 are respectively the best optimum and the worst alternative whereas the others are randomly chosen intermediates e i d 7 8 and 12 stand respectively for engines g70 9 5 s70 8 5 and g50 9 5 marques et al 2017 therefore a considerable diversity in size weight and power per cylinder is observed in the final population although there are quite distinct individuals the optimisation results for each sdo are close which indicates that the population is well converged to assess propeller and engine performance eq 3 and eq 4 were used to calculate an average open water efficiency η o a v g and an average engine efficiency η e a v g respectively remarkably the best design does not hold the most efficient either propeller or engine contrarily the sdo4 holds the highest η o a v g and the sdo1 holds the lowest η e a v g the sdo4 presented η o a v g over 17 higher than sdo1 while the sdo2 had η e a v g 1 4 higher than sdo1 3 η o a v g i 1 n r t η o δ s i i 1 n r t δ s i 4 η e a v g i 1 n r t η e δ s i i 1 n r t δ s i the sdo4 presents the highest amount of lng delivered per round trip m l n g but in contrast the lowest annual income because it takes longer to accomplish a round trip δ t r n d accomplishing fewer round trips per year n r n d the sdo1 presents the highest income and the lowest capex but in contrast the highest opex thus these economic measures of merit must be analysed in a combined way such as that performed by npv the npv for the sdo1 is us 12 3 million larger than for the sdo4 accounting for a 2 1 gain as noted one of the strengths of the applied optimisation algorithm is that it achieves a population with various improved designs instead of only one this is important for taking into account the last subjective considerations and making the final decision 4 3 engine and fuel profile effect table 9 lists the average engine efficiency η e a v g average annual income and opex and the capex and npv for every matching of engine configuration and fuel profile fp suitable for sdo2 there are five suitable engine configurations and four fuel profiles totalling 20 matchings to facilitate the analysis the influence of engine configuration and fuel profile for the sdo2 is shown as bar charts in fig 6 as one may observe η e a v g is always the highest for fp4 and the lowest for fp1 whereas it is the same intermediate value for fp2 and fp3 this is due to the assumption that engine efficiency depends only on the fuel phase liquid or gaseous as made in eqs 1 and 2 being independent of the fuel composition engine configuration is more influential on capex whereas income and opex are more affected by the fuel profile the fp id ranking in descending order of npv was 2 1 3 4 for every engine because the best fp id does not occur for the highest efficiency or income or for the lowest expenditures the merit measures that are analysed individually do not indicate the best project among all five suitable engines the best alternative regarding npv was the 4 th engine 7g70 9 5 e i d 7 7 cylinders green ultra long stroke 700 mm of piston diameter mark number 9 5 whilst the worst one was the 2 nd engine 5s90 10 5 e i d 3 5 cylinders super long stroke 900 mm of piston diameter mark number 10 5 for the best engine the fp2 led to an increase of us 22 6 million on npv in comparison with the fp4 this means that a simple search for the best fuel profile provided a gain of over 3 9 comparing the highest and the worst npv among all matchings the gain peaked at us 29 1 million accounting for over 5 1 which illustrates the combined effect of a simple search for the best matching of engine and fuel profile even for the best engine 7g70 9 5 npv would be lower than the worst one in table 8 sdo4 if either fp3 or fp4 were chosen 4 4 weather effect to evaluate the influence of the weather conditions fig 7 shows the total resistance during laden and ballast trips for rough weather average of 2015 given in table 10 and still water weather effect for the laden trip was stronger between way points 14 and 18 where the total resistance in rough weather r t r w was around 139 kn higher than for still water r t s w accounting for an increase of over 9 6 however the largest total resistance for rough weather occurred in ballast between way points 13 and 14 and peaked at 1601 kn in this case the added resistance was only 50 kn representing a 3 2 increase the propeller s open water efficiency was also affected by weather conditions as shown for the sdo1 in fig 8 the strongest influence for the laden trip resulted in a decrease of 2 0 percentage points accounting for under 3 1 between way points 14 and 18 for the ballast condition the effect was most significant between way points 4 and 5 where there was a drop of 1 5 percentage points accounting for a 2 2 drop moreover one can see clearly that the propeller s open water efficiency for still water does not present a trend regarding the service speed the required shaft speeds throughout the voyage for the sdo1 are shown in fig 9 the shaft speed for the entire voyage was higher in rough weather n r w than in still water n s w the increase of n r w in laden condition reached 3 9 rpm between way points 14 and 18 a 4 8 increase however the highest value of n r w occurred in ballast condition peaking at about 86 rpm between way points 13 and 14 a 3 increase the required brake powers throughout the voyage for the sdo1 are shown in fig 10 the brake power in rough weather p b r w and laden condition reached an increase of over 3 9 mw between way points 14 and 18 an increase of almost 22 in comparison with still water p b s w the highest p b r w occurred though in ballast condition peaking at 23 mw between way points 13 and 14 an increase about 13 owing to the overlap of all those effects the brake power in rough weather p b r w was appreciably increased in comparison to the brake power in still water p b s w therefore the operating point of the engine propeller matching is primarily affected by the variation in brake power and secondarily affected by the variation in shaft speed for the purpose of studying the effect of different weathers on the optimisation june and december 2015 conditions were also considered june is a milder month whereas december has more extreme weather table 10 lists beaufort number bn and encounter angle for the laden trip θ l along the route tracks rt for june december and 2015 average encounter angle for the ballast trip is the supplementary angle of θ l more expressive variations in θ l can be observed while bn only varies slightly with respect to its average table 11 presents the variable optimal values for weather conditions from june december and 2015 average power and rotational speed for smcr are presented as is npv the different weather conditions caused some variations on service speed and blade area ratio while all of the other variables had quite discreet changes therefore the smcr point and the npv were slightly affected although more significant influences could be expected the limited number of engines that were considered might have forced similar solutions as shown in fig 11 as can be seen the smcr points are placed on the edge of the e 8 layout diagram and there are no other engines of larger power for near rotational speeds another consideration is that the weather conditions used were approximated from monthly means of daily means hence the occasional most severe weather conditions were balanced by milder conditions insignificantly affecting the mean that is the reason why there is little difference in the three conditions that we assessed 4 5 economic scene effect there is a strong relationship between the optimum fuel profile and the fuel and lng prices as previously mentioned to assess the influence of different economic scenes on the optimum synthesis design and operation data collection of the fuels and lng prices was carried out fig 12 shows the annual average prices of fuels and lng for the period between 2000 and 2015 including the averages for this entire interval although there are appreciable alterations every year the global average mgo price c m g o a v g is almost coincident with the average lng cost insurance and freight c i f l n g a v g likewise the global average hfo price c h f o a v g is almost coincident with the average lng free on board f o b l n g a v g table 12 shows five economic scenes and the global average avg these scenes were selected as they are completely distinct from one another being quite influential on the optimisation therefore the optimisation process was run for each one of the economic scenes whilst the other input data were kept as stated in chap 3 fig 13 illustrates the evolution of the optimisation variables along the generations while table 13 lists the optimal synthesis design and operation variables and the npv for those selected economic scenes the optimisation variables were seen to evolve differently along the generations for each economic scene in fig 13 the optimal configurations were also different evidencing the influence of the economic scene on the synthesis design and operation of the system as previously noted the best configuration presents a steady value of fuel profile f p i d along the generations independent of the economic scene however the optimum f p i d was f p 1 for the 2003 scene f p 2 for the 2006 2008 2015 and average scene and f p 4 for the 2012 scene the f p 3 though was not the optimum for any of the selected economic scenes remembering the description of the fuel profiles sec 3 3 it is acceptable to assume that the f p 1 was the optimum only for the 2003 scene because it was the only time that c h f o and c m g o were both lower than f o b l n g in this case it is more advantageous to burn hfo and mgo and to sell all the lng cargo the f p 4 was the optimum only for the 2012 scene as it was the only time that f o b l n g and c i f l n g were both lower than c h f o in this case the income from the lng supposedly sold instead of burnt would not compensate for the cost of hfo theoretically used for the years 2006 and 2008 the use of hfo instead of bog is predictable because c h f o is lower than f o b l n g the same does not occur in 2015 and in the average scene in which although c h f o is between f o b l n g and c i f l n g f p 2 was the best one in this case the use of bog as fuel would decrease opex but it would also decrease incomes more sharply as can be seen in table 13 the various economic scenes provided quite different configurations with expressive variations on npv the high service speeds varied either in laden or ballast v r w h l or v r w h b while most of the others remained steady in five out of the six cases the diameter of the propeller was the only parameter converging to the same value the different diameter coincided with the only variation in the number of propulsion chains z p the npv for 2012 scene and f p 4 was 36 higher than for the average avg scene and f p 2 furthermore a remarkable difference of over 120 was found by comparing the npv for the 2012 scene and f p 4 with the 2008 scene and f p 2 highlighting the influence of the economic scene and fuel profile on the synthesis design and operation of the system 5 conclusion this work has proposed a comprehensive early stage approach to optimise the synthesis design and operation of an lngc under rough weather it has considered fixed pitch propellers directly driven by dual fuel low speed diesel engines constraints have been incorporated into the approach to avoid propellers that could present issues concerning strength cavitation and vibration different fuel profiles and service speeds have also been assessed a differential evolution optimisation algorithm whose objective function to be maximised is the npv has been used to optimise 14 parameters the computation of 15 023 input data sets have been run in 5 9 h and almost 48 of the configurations have been constrained the peripheral velocity is responsible for most of the rejections the worst individual of the final population has had the objective function increased by 22 in comparison to the worst individual of the initial population the final population has included rather distinct designs with a variation of only 2 1 in the objective function which is a strength of this approach therefore subjective considerations may be taken into account before the final decision with only minor concerns our analysis of the rejected configurations and why they have been rejected shows that there have been no general recommendations about configuration so that the propellers could escape the constraints the best design has not held the most efficient propeller or engine but it has the highest opex which emphasises that these measures of merit must not be considered separately consequently an appropriate objective function must consider them in combination such as done by the npv a simple search for the best matching of fuel profile and engine has provided a gain of over 5 1 the average weather conditions for 2015 have led to an almost 22 increase in brake power and 4 8 increase in shaft speed emphasising the effect of the weather on the engine and propeller operating points in contrast the assessment of weather conditions from different months in 2015 did not show significant effects one reason for this was the limited number of engines that we considered which forced the convergence to similar smcr points another reason is that the weather conditions that we used were approximated from monthly means of daily means which have small differences the optimisation variables were seen to evolve differently along the generations for each one of the six economic scenes that we studied the optimal configurations were also affected it was seen that the use of bog as fuel would decrease opex but it would also decrease income more sharply depending on the economic scene a remarkable difference of over 120 was found by comparing the npv for the best economic scene with the worst thus the combined influence of economic scene and fuel profile on the synthesis design and operation of the system was underlined ultimately our approach has shown significant gains and it has highlighted the need to explore a broad range of propellers and engines and also consider the weather conditions in an integrated way we were able to find the configuration that maximises the npv by assessing various profiles of fuel and service speed including different economic scenes although an lngc has been considered this approach could be applied to other types of ships with only minor adjustments acknowledgements this work was conducted at federal university of rio de janeiro during the first author s doctoral scholarship financed by the brazilian federal agency for support and evaluation of graduate education capes within the ministry of education brazil 
22971,the present work aims to provide a comprehensive early stage approach to optimise the design synthesis and operation of a marine energy system for liquified gas carriers considering their economic and technical aspects and also weather along the route part a of this work details the approach that we have developed while part b will summarise the first part it will then describe the case study results and discussion as well as the conclusion various propellers 16 engines and 4 operational profiles are assessed in this part we will apply a differential evolution optimisation algorithm whose objective function will be maximised as the net present value the case study is designed to use a liquefied natural gas carrier of 175 000 m3 sailing between lake charles usa and tokyo bay japan via the panama canal all of the suitable matchings for 15 023 propellers are found this approach shows a gain of 22 between the worst individual of the initial population and the worst individual of the final population the required brake power is approximately 22 higher for rough weather than for still water a difference of over 120 was found by comparing varied matchings of economic scenarios and fuel profiles our approach shows a significant gain and highlights the value of exploring a broad range of energy system configurations in an integrated manner especially considering the weather conditions keywords optimisation propulsion dual fuel diesel engine fixed pitch propeller net present value 1 introduction decisions of the greatest impact are made in early stages of ship design when the least information and greatest uncertainty are present chalfant 2015 hence developing ship design tools to make more information available sooner and pushing decision points for later examination is quite advisable in this sense simulations of the overall ship energy system and optimisation studies are of great interest some references published over the last decade in this field include dimopoulos et al 2008 theotokatos 2008 aldous and smith 2012 theotokatos and tzelepis 2013 man 2014 cichowicz et al 2015 tillig et al 2016 mizythras et al 2018 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 and trivyza et al 2018 and a more complete and descriptive state of the art is addressed in the part a of this study to the best of authors knowledge this is the first comprehensive study to focus on the optimisation of energy system selection for liquefied natural gas carriers lngcs fitted with dual fuel low speed diesel engines considering engine propeller and weather conditions within an integrated approach similar comprehensive approaches to simulate and optimise ship energy systems are also found in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 and trivyza et al 2018 the low occurrence of studies found about the optimisation of diesel engine selection might arise from the shortage of suitable engine models for optimisation problems the most used engine models are the so called zero dimensional engine model medica et al 2009 payri et al 2011 guan et al 2015 mavrelos and theotokatos 2018 and the mean value engine model theotokatos 2008 2010 theotokatos and tzelepis 2013 cichowicz et al 2015 guan et al 2014 they have also been combined to explore the advantages of both in baldi et al 2015 and theotokatos et al 2018 when there is no interest in the engine s internal processes the engine can be merely represented by functions that relate for instance load and speed to specific fuel consumption this is the so called transfer function engine model which is the simplest and fastest method precisely for these reasons this is the most suitable model for the design optimisation of the ship s overall energy system some references in this field can be found in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 trivyza et al 2018 benvenuto et al 1994 stefanopoulou and smith 2000 benvenuto and campora 2005 altosole and figari martelli 2014 and marques et al 2017 however models appropriate for iterative procedures that do not require calibration for every single engine were developed in tillig et al 2016 tzortzis and frangopoulos 2018 sakalis and frangopoulos 2018 marques et al 2017 all based on regression analyses being the last one used in the present work because it addresses dual fuel low speed diesel engines the present work proposes a comprehensive early stage approach to optimise the design synthesis and operation of lngc energy systems considering economic and technical aspects in addition to weather conditions this approach assesses various configurations of propellers and prime movers to find the best matching and it also considers several forms of propulsion chains the need for a re liquefaction plant is also assessed constraints are incorporated to avoid propellers that may present issues regarding strength cavitation and vibration this approach considers different operational profiles for service speeds and fuel to maximise the net present value npv this measure of merit considers operational expenditures opex income and capital expenditures capex given that the methodology was detailed in part a of this study the next section will briefly summarise the methodology the case study results and discussion and the main conclusions will then be presented 2 methodology our method consists of an optimisation process to find the synthesis of components their design characteristics and the operational profile that maximise the npv of an lngc herein the synthesis of components refers to the condition of the propulsion system to hold one or two main engines each one driving a propeller and the existence of shipboard re liquefaction the component design characteristics refer to the propeller and engine specification operational profile refers to the service speed and the fuel to be burnt in each part of the journey namely the fuel profile all of the computations were performed in matlab the proposed approach is explained hereinafter by means of a flowchart further details and an overview of each model can be found in part a of this work fig 1 illustrates the proposed approach towards the optimisation of the synthesis design and operation of an lngc energy system this figure shows the different computations that were followed including the input and output data given a guess of optimisation design variables that is propulsion parameters and service speed the first step is to estimate the brake power and shaft speed in service for each route track the next steps are to compute the specified maximum continuous rating smcr and then determine the suitable engines while still considering the initial guess of the design variables the fourth step is to assess the npv for each suitable engine considering the different fuel profiles having accomplished this a simple search is performed to find the matching engine and fuel profile that holds the maximum npv which is the optimum for that guess of design variables all of these steps are executed iteratively by the optimisation algorithm and the convergence is verified at the end of each run if the algorithm has converged then the optimum engine propeller matching was reached otherwise the optimisation algorithm makes a new guess of propulsion parameters similarly if there are no suitable engines among the available options during a run then that initial guess of design variables is considered to be infeasible and the optimisation algorithm interrupts the run to guess new design variables and then return to the first step 3 case study this section addresses the ship and energy system parameters that were adopted to test the relevance of the developed approach details about the route operational profiles and the economic and optimisation issues are also included 3 1 ship the case study of an lngc with a cargo capacity of 175 000 m3 and with the parameters listed in table 1 was proposed as one may notice there are several different parameters for laden and ballast operation while others do not vary the energy system of the ship is shown schematically in fig 2 where it can be noted that the bog can feed the gcu the dual fuel generation sets the bog compression system and the re liquefaction plant meanwhile dual fuel generation sets provide electricity to the re liquefaction plant other consumers and the bog compression system the existence of a re liquefaction system is not mandatory the ship can hold it or not likewise the ship can have two propulsion chains or only one table 2 lists the energy system parameters for the studied ship some data namely sp bog p o t h and p c o m were achieved by regression from man 2014 the s f o c g e s g c g e s p o c g e and η g were achieved by considering generation sets with engines w34df of 435 kw per cylinder wartsila 2015 because the composition of bog is time dependent an average value for l h v b o g was taken from dimopoulos and frangopoulos 2008 the values of all of the specific fuel consumptions including those from the engine model developed in marques et al 2017 were taken regarding standard lower heating values of 42 700 kj kg and 50 000 kj kg respectively for liquid l h v l and gaseous fuel l h v g they must therefore be rectified regarding lhv hfo and lhv bog assuming that the engine efficiency is a constant regarding fuels of the same phase gaseous or liquid the specific fuel consumption becomes inversely proportional to the lhv hence eq 1 was used to find the specific heavy fuel oil consumption s f o c h f o from the specific fuel oil consumption sfoc for lhv l the specific pilot heavy fuel oil consumption s p o c h f o was analogously calculated similarly the specific bog consumption s g c b o g was calculated from the specific gas consumption sgc for lhv g using eq 2 1 s f o c h f o s f o c l h v l l h v h f o 2 s g c b o g s g c l h v g l h v b o g 3 2 route the ship travels in laden from lake charles to tokyo bay via the panama canal and it returns in ballast following the great circle route as shown in fig 3 this route is used because it is the shortest course between two points on the surface of a sphere the topology of the monthly average wind speed for december 2015 is presented in the same figure a total of 20 way points were considered dividing the route into 19 tracks table 3 presents the route parameters of interest for each route track rt where s is the route track length whilst bn and θ l are 2015 average values respectively concerning beaufort number and encounter angle for the laden trip it is of note that the encounter angle for ballast trip is the supplementary angle of θ l 3 3 operational profile the ship has a different operational profile regarding service speed and fuel to burn depending on the stage of the route as presented in table 4 three levels of service speed were identified to reduce pollution such that the smaller the distance from a continent the slower the speed thus the three levels were low for v r w 12 0 knots kn intermediary for v r w 16 0 kn and high for v r w 19 5 kn moreover because cleaner fuels must be burnt between way points 1 and 5 and also between 19 and 20 due to environmental rules the following four fuel profiles fps were proposed 1 prime mover and generation sets burn hfo wherever possible and mgo only where is necessary such that bog is completely re liquefied 2 prime mover and generation sets burn hfo wherever possible and bog only where is necessary such that only the remaining bog is re liquefied in this case wherever bog is applied the pilot oil is mgo 3 prime mover and generation sets burn only bog in laden while in ballast they burn hfo wherever possible and mgo where is necessary such that only the remaining bog is re liquefied in this case pilot oil is always mgo for the generation sets while the prime mover uses hfo wherever is possible and mgo only where cleaner fuels are required 4 prime mover and generation sets only burn bog during the entire voyage such that there is no re liquefaction plant and the remaining bog is burnt in a gas combustion unit gcu pilot oil is always mgo for the generation sets while the prime mover uses hfo wherever possible and mgo only where cleaner fuels are required although the total time of a round trip mainly depends on the service speeds a constant standing period of 24 h in each port for loading and unloading was also considered moreover this ship has an idle time of 14 days for dry docking or afloat repairs every 2 5 years which is important to calculate the average number of round trips a year n r n d and to estimate the fouling service margin s m f 3 4 economic and optimisation parameters table 5 presents the economic parameters where c j o u includes only the port fees and the panama canal tolls over a round trip the optimisation variables and their ranges are listed in table 6 the last five rows contain the only discrete variables whereas the others are continuous moreover the last three variables are the only secondary ones such that they are not input data they are dependent on the others and they are achieved by running the optimisation algorithm although they are also optimised besides the optimisation variables it is important to mention the factors related to mutation f and crossover cr which equal 0 8 and 0 5 respectively 4 results and discussion the next section will describe the influence of the optimisation algorithm parameters on the npv along the generations the evolution of each variable and the effectiveness of the constraints are assessed including the engine and fuel profile selection effect finally the weather condition effect is discussed 4 1 optimisation algorithm parameters it was necessary to first verify if the population size n p and the number of generations n g used were suitable the convergence of optimisation is heavily dependent on these parameters and their ideal values are specific to every single case therefore three combinations of these parameters were assessed by plotting the maximum mean and minimum of the objective function throughout the generations as shown in fig 4 by comparing fig 4a and b one can notice that doubling the number of generations has a small effect on the objective function doubling the population size was even less influential as can be seen when comparing fig 4b and c thus a population of 120 individuals and 120 generations fig 4c were considered suitable the processing times for a computer fitted with a 3 50 ghz intel core i7 5930k processor with 16 gb of ram were 1 6 2 7 and 5 9 h respectively for case a b and c the worst individual of the final population in comparison with the worst individual of the initial population had the objective function npv increased by 21 20 and 22 respectively for case a b and c 4 2 optimisation summary table 7 shows the optimisation summary which shows the effectiveness of the constraints and a number of computations performed by the algorithm remarkably almost 48 of the 15 023 configurations that were assessed by the algorithm were constrained the peripheral velocity constraint was responsible for over 33 of the rejected designs whereas cavitation was responsible for over 31 the engine was responsible for 18 strength was responsible for 13 and the resonance constraint was responsible for under 4 this table includes some remarks about the optimisation process overall 623 designs were assessed to create the initial population which means that 1 out of every 5 192 was feasible and each offspring member took on average 1 4 s to be generated some particularities were noted about the designs that were rejected due to each constraint over 75 of the designs rejected due to the strength constraint were presented in combination high service speed v r w h number of blades z greater than or equal to six and only one propulsion chain z p nevertheless as 99 of these rejected designs presented z 6 the number of blades was the most influential parameter similar remarks are presented for each constraint in table 7 given that 64 of the designs rejected due to the cavitation constraint had a e a o 0 675 and almost 80 of those rejected due to peripheral velocity had a e a o 0 675 there is no general advice about the best value for expanded area ratio the same occurs for other parameters consequently there is no general advice about the propeller configuration which highlights the usefulness of the proposed approach fig 5 shows the evolution of the 14 optimisation variables for the best individual of each generation it can be observed that almost all of the parameters presented a significant variation range and all of them were steady from the 86 th generation until the end various engines 2 e i d 13 with various numbers of cylinders 5 z c 9 were the best depending on the generation meanwhile fuel profile fp id was the only variable that remained steady throughout the generations this is due to the strong relationship between fuel profile and fuel unit cost which was not changed this fuel profile was always optimum because in the fp2 the ship uses the fuel of lowest unit cost hfo wherever possible and the second cheaper fuel bog only where necessary table 8 presents average μ and standard deviation σ for the optimisation variables and also four alternatives of synthesis design and operation sdo from the final population the variables v r w l l v r w i l v r w l b v r w i b and d presented average values close to their upper limits and low σ which indicates a trend similarly z p trended to its lower limit that is one engine driving directly one propeller fp id presented σ equals zero because there was no variation regardless the other variables as previously explained and illustrated in fig 5 the sdo1 and sdo4 in table 8 are respectively the best optimum and the worst alternative whereas the others are randomly chosen intermediates e i d 7 8 and 12 stand respectively for engines g70 9 5 s70 8 5 and g50 9 5 marques et al 2017 therefore a considerable diversity in size weight and power per cylinder is observed in the final population although there are quite distinct individuals the optimisation results for each sdo are close which indicates that the population is well converged to assess propeller and engine performance eq 3 and eq 4 were used to calculate an average open water efficiency η o a v g and an average engine efficiency η e a v g respectively remarkably the best design does not hold the most efficient either propeller or engine contrarily the sdo4 holds the highest η o a v g and the sdo1 holds the lowest η e a v g the sdo4 presented η o a v g over 17 higher than sdo1 while the sdo2 had η e a v g 1 4 higher than sdo1 3 η o a v g i 1 n r t η o δ s i i 1 n r t δ s i 4 η e a v g i 1 n r t η e δ s i i 1 n r t δ s i the sdo4 presents the highest amount of lng delivered per round trip m l n g but in contrast the lowest annual income because it takes longer to accomplish a round trip δ t r n d accomplishing fewer round trips per year n r n d the sdo1 presents the highest income and the lowest capex but in contrast the highest opex thus these economic measures of merit must be analysed in a combined way such as that performed by npv the npv for the sdo1 is us 12 3 million larger than for the sdo4 accounting for a 2 1 gain as noted one of the strengths of the applied optimisation algorithm is that it achieves a population with various improved designs instead of only one this is important for taking into account the last subjective considerations and making the final decision 4 3 engine and fuel profile effect table 9 lists the average engine efficiency η e a v g average annual income and opex and the capex and npv for every matching of engine configuration and fuel profile fp suitable for sdo2 there are five suitable engine configurations and four fuel profiles totalling 20 matchings to facilitate the analysis the influence of engine configuration and fuel profile for the sdo2 is shown as bar charts in fig 6 as one may observe η e a v g is always the highest for fp4 and the lowest for fp1 whereas it is the same intermediate value for fp2 and fp3 this is due to the assumption that engine efficiency depends only on the fuel phase liquid or gaseous as made in eqs 1 and 2 being independent of the fuel composition engine configuration is more influential on capex whereas income and opex are more affected by the fuel profile the fp id ranking in descending order of npv was 2 1 3 4 for every engine because the best fp id does not occur for the highest efficiency or income or for the lowest expenditures the merit measures that are analysed individually do not indicate the best project among all five suitable engines the best alternative regarding npv was the 4 th engine 7g70 9 5 e i d 7 7 cylinders green ultra long stroke 700 mm of piston diameter mark number 9 5 whilst the worst one was the 2 nd engine 5s90 10 5 e i d 3 5 cylinders super long stroke 900 mm of piston diameter mark number 10 5 for the best engine the fp2 led to an increase of us 22 6 million on npv in comparison with the fp4 this means that a simple search for the best fuel profile provided a gain of over 3 9 comparing the highest and the worst npv among all matchings the gain peaked at us 29 1 million accounting for over 5 1 which illustrates the combined effect of a simple search for the best matching of engine and fuel profile even for the best engine 7g70 9 5 npv would be lower than the worst one in table 8 sdo4 if either fp3 or fp4 were chosen 4 4 weather effect to evaluate the influence of the weather conditions fig 7 shows the total resistance during laden and ballast trips for rough weather average of 2015 given in table 10 and still water weather effect for the laden trip was stronger between way points 14 and 18 where the total resistance in rough weather r t r w was around 139 kn higher than for still water r t s w accounting for an increase of over 9 6 however the largest total resistance for rough weather occurred in ballast between way points 13 and 14 and peaked at 1601 kn in this case the added resistance was only 50 kn representing a 3 2 increase the propeller s open water efficiency was also affected by weather conditions as shown for the sdo1 in fig 8 the strongest influence for the laden trip resulted in a decrease of 2 0 percentage points accounting for under 3 1 between way points 14 and 18 for the ballast condition the effect was most significant between way points 4 and 5 where there was a drop of 1 5 percentage points accounting for a 2 2 drop moreover one can see clearly that the propeller s open water efficiency for still water does not present a trend regarding the service speed the required shaft speeds throughout the voyage for the sdo1 are shown in fig 9 the shaft speed for the entire voyage was higher in rough weather n r w than in still water n s w the increase of n r w in laden condition reached 3 9 rpm between way points 14 and 18 a 4 8 increase however the highest value of n r w occurred in ballast condition peaking at about 86 rpm between way points 13 and 14 a 3 increase the required brake powers throughout the voyage for the sdo1 are shown in fig 10 the brake power in rough weather p b r w and laden condition reached an increase of over 3 9 mw between way points 14 and 18 an increase of almost 22 in comparison with still water p b s w the highest p b r w occurred though in ballast condition peaking at 23 mw between way points 13 and 14 an increase about 13 owing to the overlap of all those effects the brake power in rough weather p b r w was appreciably increased in comparison to the brake power in still water p b s w therefore the operating point of the engine propeller matching is primarily affected by the variation in brake power and secondarily affected by the variation in shaft speed for the purpose of studying the effect of different weathers on the optimisation june and december 2015 conditions were also considered june is a milder month whereas december has more extreme weather table 10 lists beaufort number bn and encounter angle for the laden trip θ l along the route tracks rt for june december and 2015 average encounter angle for the ballast trip is the supplementary angle of θ l more expressive variations in θ l can be observed while bn only varies slightly with respect to its average table 11 presents the variable optimal values for weather conditions from june december and 2015 average power and rotational speed for smcr are presented as is npv the different weather conditions caused some variations on service speed and blade area ratio while all of the other variables had quite discreet changes therefore the smcr point and the npv were slightly affected although more significant influences could be expected the limited number of engines that were considered might have forced similar solutions as shown in fig 11 as can be seen the smcr points are placed on the edge of the e 8 layout diagram and there are no other engines of larger power for near rotational speeds another consideration is that the weather conditions used were approximated from monthly means of daily means hence the occasional most severe weather conditions were balanced by milder conditions insignificantly affecting the mean that is the reason why there is little difference in the three conditions that we assessed 4 5 economic scene effect there is a strong relationship between the optimum fuel profile and the fuel and lng prices as previously mentioned to assess the influence of different economic scenes on the optimum synthesis design and operation data collection of the fuels and lng prices was carried out fig 12 shows the annual average prices of fuels and lng for the period between 2000 and 2015 including the averages for this entire interval although there are appreciable alterations every year the global average mgo price c m g o a v g is almost coincident with the average lng cost insurance and freight c i f l n g a v g likewise the global average hfo price c h f o a v g is almost coincident with the average lng free on board f o b l n g a v g table 12 shows five economic scenes and the global average avg these scenes were selected as they are completely distinct from one another being quite influential on the optimisation therefore the optimisation process was run for each one of the economic scenes whilst the other input data were kept as stated in chap 3 fig 13 illustrates the evolution of the optimisation variables along the generations while table 13 lists the optimal synthesis design and operation variables and the npv for those selected economic scenes the optimisation variables were seen to evolve differently along the generations for each economic scene in fig 13 the optimal configurations were also different evidencing the influence of the economic scene on the synthesis design and operation of the system as previously noted the best configuration presents a steady value of fuel profile f p i d along the generations independent of the economic scene however the optimum f p i d was f p 1 for the 2003 scene f p 2 for the 2006 2008 2015 and average scene and f p 4 for the 2012 scene the f p 3 though was not the optimum for any of the selected economic scenes remembering the description of the fuel profiles sec 3 3 it is acceptable to assume that the f p 1 was the optimum only for the 2003 scene because it was the only time that c h f o and c m g o were both lower than f o b l n g in this case it is more advantageous to burn hfo and mgo and to sell all the lng cargo the f p 4 was the optimum only for the 2012 scene as it was the only time that f o b l n g and c i f l n g were both lower than c h f o in this case the income from the lng supposedly sold instead of burnt would not compensate for the cost of hfo theoretically used for the years 2006 and 2008 the use of hfo instead of bog is predictable because c h f o is lower than f o b l n g the same does not occur in 2015 and in the average scene in which although c h f o is between f o b l n g and c i f l n g f p 2 was the best one in this case the use of bog as fuel would decrease opex but it would also decrease incomes more sharply as can be seen in table 13 the various economic scenes provided quite different configurations with expressive variations on npv the high service speeds varied either in laden or ballast v r w h l or v r w h b while most of the others remained steady in five out of the six cases the diameter of the propeller was the only parameter converging to the same value the different diameter coincided with the only variation in the number of propulsion chains z p the npv for 2012 scene and f p 4 was 36 higher than for the average avg scene and f p 2 furthermore a remarkable difference of over 120 was found by comparing the npv for the 2012 scene and f p 4 with the 2008 scene and f p 2 highlighting the influence of the economic scene and fuel profile on the synthesis design and operation of the system 5 conclusion this work has proposed a comprehensive early stage approach to optimise the synthesis design and operation of an lngc under rough weather it has considered fixed pitch propellers directly driven by dual fuel low speed diesel engines constraints have been incorporated into the approach to avoid propellers that could present issues concerning strength cavitation and vibration different fuel profiles and service speeds have also been assessed a differential evolution optimisation algorithm whose objective function to be maximised is the npv has been used to optimise 14 parameters the computation of 15 023 input data sets have been run in 5 9 h and almost 48 of the configurations have been constrained the peripheral velocity is responsible for most of the rejections the worst individual of the final population has had the objective function increased by 22 in comparison to the worst individual of the initial population the final population has included rather distinct designs with a variation of only 2 1 in the objective function which is a strength of this approach therefore subjective considerations may be taken into account before the final decision with only minor concerns our analysis of the rejected configurations and why they have been rejected shows that there have been no general recommendations about configuration so that the propellers could escape the constraints the best design has not held the most efficient propeller or engine but it has the highest opex which emphasises that these measures of merit must not be considered separately consequently an appropriate objective function must consider them in combination such as done by the npv a simple search for the best matching of fuel profile and engine has provided a gain of over 5 1 the average weather conditions for 2015 have led to an almost 22 increase in brake power and 4 8 increase in shaft speed emphasising the effect of the weather on the engine and propeller operating points in contrast the assessment of weather conditions from different months in 2015 did not show significant effects one reason for this was the limited number of engines that we considered which forced the convergence to similar smcr points another reason is that the weather conditions that we used were approximated from monthly means of daily means which have small differences the optimisation variables were seen to evolve differently along the generations for each one of the six economic scenes that we studied the optimal configurations were also affected it was seen that the use of bog as fuel would decrease opex but it would also decrease income more sharply depending on the economic scene a remarkable difference of over 120 was found by comparing the npv for the best economic scene with the worst thus the combined influence of economic scene and fuel profile on the synthesis design and operation of the system was underlined ultimately our approach has shown significant gains and it has highlighted the need to explore a broad range of propellers and engines and also consider the weather conditions in an integrated way we were able to find the configuration that maximises the npv by assessing various profiles of fuel and service speed including different economic scenes although an lngc has been considered this approach could be applied to other types of ships with only minor adjustments acknowledgements this work was conducted at federal university of rio de janeiro during the first author s doctoral scholarship financed by the brazilian federal agency for support and evaluation of graduate education capes within the ministry of education brazil 
22972,this study considers an asynchronous multirate data integration problem in the linear state space model with unknown and time varying statistical parameters of the measurement noises to improve performance of the multirate adaptive kalman filter algorithm a multi sensor adaptive kalman filtering algorithm based on variational bayesian approximations has been developed in an asynchronous multirate multi sensor integrated navigation system the proposed filtering algorithm estimates measurement noise variances of the sensors adaptively and also it is robust to anomalous measurements of sensors and however multirate adaptive kalman filter is required to use an appropriate algorithm for outlier rejection to achieve a reliable and optimal estimation of position velocity and orientation a navigation system composed of a strapdown inertial navigation system along with doppler velocity log inclinometer and depth meter with different sampling rates is designed to evaluate performance of multirate error state kalman filter meskf and multirate adaptive error state kalman filter maeskf algorithms and the proposed algorithm results of two experimental tests show that the average relative root mean square error rmse of the position estimated by the proposed filtering algorithm can be decreased approximately 57 and 36 when compared to that of meskf and maeskf algorithms respectively keywords error state kalman filter asynchronous multirate adaptive kalman filter variational bayesian approximations underwater integrated navigation system strapdown inertial navigation system 1 introduction the conventional kalman filter algorithm has been widely implemented for integrating the strapdown inertial navigation system sdins and auxiliary sensors davari and gholami 2017 davari et al 2017 miller et al 2010 shabani et al 2015 sheijani et al 2013 titterton and weston 2004 in sdins the inertial measurement unit imu is directly installed in the vehicle the imu provides measurements related to the acceleration and angular rates of a vehicle the navigation system states such as the position velocity and orientation are estimated through the navigation equation of sdins measurement equations state equations and real measurements a prior exact knowledge of the navigation system dynamics and the statistical information of the process and measurement noise covariance matrix is required for proper conventional kalman filter algorithm performance in most applications the process and measurement noises are often unknown or time varying and they are mostly dependent on the application environment and process dynamics which degrade the accuracy of estimation of kalman filter algorithm a classical way to solve this problem is to use adaptive filters the adaptive kalman filter akf algorithm can estimate the dynamic state and the statistical characteristics of the measurement noise simultaneously the adaptive technique does not need the exact values of the priorstatistical information of the state and therefore kalman filter algorithm performance is improved through the process of filter learning mehra 1970 moreover the outliers within the measured data increase the estimation error and normally adaptive kalman filters use an appropriate algorithm for outlier rejection is used to increase the system accuracy and reliability various adaptive filtering algorithms have been used to estimate the filter s statistical information in dynamic systems and are broadly divided into four categories of bayesian maximum likelihood hasan et al 2010 correlation and covariance matching methods mehra 1970 the adaptive filtering based on maximum likelihood hasan et al 2010 requires a quite long innovation sequence to estimate values of the process and measurements noise covariance in this method the process and measurement noise covariance are calculated through maximizing the likelihood function of the innovations raghavan et al 2006 the main problem of the ml method is high sensitivity to outlier auxiliary data in addition the estimated noise covariance cannot be adjusted immediately with the recent innovation sequences moreover data fusion used in navigation applications with this method is too time consuming and cannot be used in real time applications mohamed and schwarz 1999 the covariance matching technique is based on the innovation or residual sequence and calculates the covariance of the system states by employing a moving window over the streaming data in this method the process and measurement noise covariance values are estimated by matching the calculated covariance value and their theoretical value ding et al 2007 hide et al 2003 maybeck 1982 the correlation technique estimates the covariance matrices based on the autocorrelation function of the output or the innovation sequence one of the disadvantages of this method is its high processing load due to the need for a large window of data furthermore it does not guarantee the positive definiteness of the matrices odelson et al 2006 oussalah and de schutter 2001 the bayesian method is more comprehensive than the aforementioned methods that often approximate bayesian method e g särkkä and nummenmaa 2009 bayesian method excels the ml method in two ways first there are no restrictions on choosing the required data size and second it acts as a robust method because of using a predictive posterior distribution watanabe et al 2004 the navigation accuracy is very sensitive to anomalous measurements and transient disturbances which lead to very poor estimates agamennoni et al 2011 in underwater navigation the velocity of the vehicle is measured using a doppler velocity log dvl allotta et al 2016 kinsey and whitcomb 2004 the dvl measurements sometimes have drastic and unreal changes called the outlier bamnett and lewis 1994 the outliers may originate from instrument errors or circumstance disturbances the variance of measurement noise is time varying because of outlier influence särkkä and nummenmaa 2009 developed variational bayesian approximation based adaptive kalman filter vb akf algorithm to solve the estimation problem with unknown and time varying measurement noise in which only one auxiliary sensor has been implemented the vb akf algorithm is a robust kalman filter in the presence of measurement outliers gao et al 2011 modified vb akf algorithm to be used in a single rate multi sensor system in which the measurement sensors were similar performance of their proposed algorithm was evaluated through numerical simulation previous researches reported applications of akf and or vb akf algorithms in the field of underwater navigation related to the application of single auxiliary sensor or synchronous multi sensors e g dah jing and chen 2011 jwo and weng 2008 yu 2012 to the best of authors knowledge this paper reports the first development of an asynchronous multirate multi sensor adaptive kalman filtering algorithm based on variational bayesian approximations for underwater integrated navigation systems in this paper the vb akf algorithm is modified to estimate the navigation system state and measurement noise variances of multiple asynchronous auxiliary sensors for the underwater integrated navigation system in order to enhance the performance of the akf algorithm unlike akf algorithm the proposed algorithm can tune the covariance matrix of asynchronous auxiliary measurements adaptively in addition the proposed algorithm is not sensitive to outlying measurement and does not require an additional algorithm to remove the corrupted auxiliary data the performance of the proposed algorithm is evaluated through real measurements and its results are compared with those of akf algorithm in both methods the integration structure is based on error state kalman filter eskf this paper is organized as followings section 2 reviews the variational bayesian approximation based on adaptive error state kalman filter vb aeskf and presents the proposed asynchronous multirate vb aeskf algorithm the structure of the integrated inertial navigation system is reviewed in section 2 and equations related to the sdins errors state and measurement models are presented in this section as well in section 3 performance of the proposed algorithm is evaluated using the real data sets finally conclusion remarks are presented in section 4 2 principles of the proposed algorithm in this section principles of the proposed vb maeskf algorithm are presented after a brief introduction to the integrated navigation system vb aeskf algorithm and variational approximation 2 1 integrated navigation system in integrated navigation systems the dynamic equations of sdins are continuous time nonlinear error state space model these systems consist of a set of timedependent equations such as change rates of estimated position velocity orientation and bias instability in these equations the angular rate and linear acceleration are given in body frame and the velocity and position of the vehicle should be estimated in the navigation frame in the dynamic equations of sdins it is assumed that the output error of the accelerometers and gyroscopes are the sum of bias instability and gaussian random noise the accelerometer and gyroscope bias instability are modeled as the summation of random walks and random constants the general form of a continuous time nonlinear state space model suggested by simon 2006 have been applied for the sdins equation 1 in which x is time derivative of navigation system state x is total navigation system state vector of the sdins f is the sdins nonlinear function which describes the dynamic behavior of the navigation system g t is the noise input matrix and w t is the process noise due to uncertainty in the control inputs which is assumed to be a zero mean gaussian white noise distribution with known covariance matrix q t the control input u t is given in equation 2 in which f b ω i b b are linear acceleration and angular rate vectors respectively 1 x t f x t u t g t w t w n 0 q t 2 u f b ω i b b t in this paper the reviewed and proposed integrated navigation algorithms are based on error states of system this paper considers the discrete time linear error state space model as shown in the following equations equations 3 and 4 are error state equation and measurement error equation of ith auxiliary sensor respectively at the case time instant t k that are expressed in eskf the error state and measurement error equations for implementing in the multirate kalman filter have been comprehensively reviewed in davari et al 2017 3 δ x t k a t k 1 δ x t k 1 l t k 1 w t k 1 w t k n 0 q t k 4 δ y i t k h i t k δ x t k m i t k r i t k r i t k n 0 r i t k where δ x k is an n dimensional error state vector n is the number of states considered for the navigation system the error state δ x x t r u e x ˆ represent the expected error between the true state x t r u e and its estimation x ˆ further a t k is n n system state transition matrix l t k 1 is n η dynamic noise distribution matrix w t k 1 is η dimensional input white noise vector which is assumed to be a gaussian distribution with zero mean and η η covariance matrix q t k 1 and η is the number of modeled errors for imu sensors in this paper two types of errors bias instability and random walk for three accelerometers and three gyroscopes are considered thus η is 12 in equation 4 δ y i t k is a d i dimensional measurement error vector and is the difference between the navigation solution from the sdins and auxiliary measurement sensors h i t k and m i t k are d i n measurement output matrix and d i d i measurement noise distribution matrix respectively for i t h auxiliary sensor and r i t k represents d i dimensional measurement noise vector which is assumed to be a zero mean gaussian white noise distribution with d i d i time varying covariance matrix r i t k in this paper sensors are assumed to be independent of each other thus their measurement noises are uncorrelated as shown in equation 5 δ is kronecker delta function 5 e r i t k r j t h r i t k δ i j δ k h in the vb aeskf algorithm the variational bayesian approximation recursively approximates the joint posterior distribution of the error state and measurement noise variance p δ x t 1 k r i t k δ y i t 1 k by using a factorized free form distribution särkkä and nummenmaa 2009 then the state and the measurement noise variances are estimated by means of a fixed point iteration in the recursive algorithm in this paper it is assumed that the prior navigation system state and the process noise variance and unknown measurement noise variance are independent of each other prior to start the vb aeskf algorithm an initialization procedure is used to determine initial value for the state and its noise variance and the prior distribution p δ x t 0 r i t 0 the prior error state information δ x t 0 has a gaussian distribution with m t 0 and p t 0 as its mean and covariance respectively the vb aeskf algorithm is divided into prediction and update phases in the prediction phase the chapman kolmogorov equation approximates the conditional distribution for the error state and the measurement noise variance given by the measurements error δ y i t 1 k 1 as shown in equation 6 6 p δ x t k r i t k δ y i t 1 k 1 p δ x t k δ x t k 1 p r i t k r i t k 1 p δ x t k 1 r i t k 1 δ y i t 1 k 1 d δ x t k 1 d r i t k 1 in the update phase if the measurement data becomes available at t k the prior distribution is updated via bayes rule given in equation 7 c is normalization constant in this paper for prediction and update phases error state and measurement error have been modified in order to solve the problem based on eskf 7 p δ x t k r i t k δ y i t 1 k 1 c p δ y i t 1 k δ x t k r i t k p δ x t k r i t k δ y i t 1 k 1 2 2 variational approximation the variational bayesian method is known as an ensemble learning method it uses a variational approximation for approximating the intractable integral of the bayesian method where the true posterior distribution is approximated with a simpler distribution this is a robust estimation method that reduces the computational complexity beal 2003 ghahramani and beal 1999 ueda and ghahramani 2002 according to särkkä and nummenmaa 2009 it can be assumed that the error states are independent of the measurement noise variances therefore the variational bayesian vb approximation method can be used to approximate the conditional distribution for the error state and the measurement noise variances given measurements error δ y i t 1 k as presented in equation 8 where n and inv gamma represent the gaussian and inverse gamma distributions respectively α i t k and β i t k are parameters of inv gamma distribution for measurement noise variance at t k for ith sensor the implementation details of the vb approximation method for akf algorithm can be found in särkkä and nummenmaa 2009 8 p δ x t k r i t k δ y i t 1 k p δ x t k δ y i t 1 k p r i t k δ y i t 1 k p δ x t k δ y i t 1 k n δ x t k δ x ˆ t k p t k p r i t k δ y i t 1 k i 1 d i i n v g a m m a σ i 2 t k α i t k β i t k 2 3 the proposed vb maeskf algorithm the algorithm proposed in this paper can be applied in integrated navigation system with dissimilar sensors whose sampling rates are different i e asynchronous multi rate sensors using multiple sensors could potentially provide better performance and higher navigation accuracy due to better visibility and complementary information the considered integrated navigation system consist of an imu and m multirate auxiliary sensors with different sample periods t and t i for each sensor respectively let t t 0 t 1 t k t γ and t i t 0 i t 1 i t k i i t γ i i denote the different discrete time sets for imu and the ith auxiliary sensor respectively further г and г i are the largest time instants for the imu and the ith auxiliary sensor respectively and t k and t k i i as shown in equation 9 are the time instant when kth measurement of imu and k i t h measurement of ith auxiliary sensor are available where t and t i are sampling period for imu and ith auxiliary sensor respectively 9 t k t 0 k t t k i i t 0 i k i t i without loss of generality it is assumed that t 0 t 0 i and t i t in general t k i i may not be equal to t k j j even if time instant of two different sensors are equal k i k j i j for the proposed vb maeskf algorithm modified prediction and update phases have been applied in the prediction phase the error state and its covariance are predicted as shown in equations 10 and 11 10 δ x ˆ t k a t k δ x ˆ t k 1 11 p t k a t k 1 p t k 1 a t t k 1 l t k 1 q t k 1 l t t k 1 in this paper estimated quantities are denoted by a hat and and denote values calculated in predict and update phases respectively the parameters of the inv gamma distribution for the ith auxiliary sensor are given in equations 12 and 13 a scale factor 0 ρ i 1 is employed to control the fluctuation of the estimated measurement noise variance if the value of ρ i is close to one fluctuations of the estimated measurement noise variance becomes smooth and the lower values for ρ i the larger the fluctuations 12 α i t k i i ρ i α i t k i 1 i 13 β i t k i i ρ i β i t k i 1 i at t k dimensions of matrices h t k m t k and r t k and dimensions of vectors δ y t k and r t k are d k n d k d k d k d k d k 1 and d k 1 respectively in which d k is expressed as equation 14 14 min i d i d k i 1 m d i if time instant of imu equals with time instant of m auxiliary sensors as presented in equation 15 then α acharya et al 2011 and β acharya et al 2011 are the vectors for the parameters of the inv gamma at t k and are given by equations 16 and 17 15 t k t k 1 1 t k 2 2 t k m m 16 α t k α 1 t k t α 2 t k t α m t k t 17 β t k β 1 t k t β 2 t k t β m t k t the update phase of the proposed algorithm is executed when at least one of the auxiliary sensors data is received at t k if time instant of the sensors do not follow equation 15 a vector s t k s 1 t k s 2 t k s m t k is introduced where s i t k gains a binary value if s i t k 1 it means that the ith sensor measurement at t k is received therefore β t k presented in equation 17 is modified using equations 18 and 19 so that can be used in update phase 18 c t k d i a g s t k 19 β t k c t k β t k if at t k the ith sensor data becomes available the values of the ith sensor measurement output matrix h i t k and the measurement error vector δ y i t k are placed on the total measurement output matrix h t k and the total measurement error vector δ y t k respectively in the case of receiving all of the auxiliary measurements at time step t k equation 15 the measurement output matrix and the measurement error vector are expressed as equations 20 and 21 20 h t k h 1 t k 1 1 t h 2 t k 2 2 t h m t k m m t t 21 δ y t k δ y 1 t k 1 1 t δ y 2 t k 2 2 t δ y m t k m m t t if the measurement noises for different sensors are uncorrelated the measurement noise covariance matrix r t k may be expressed as equation 22 where r i t k i i is variance of the measurement errors for ith sensor at t k 22 r t k e r t k r t k t b l o c k d i a g r 1 t k 1 1 r 2 t k 2 2 r m t k m m receiving a new auxiliary measurement the navigation error state and its associated covariance matrix p t k at t k are estimated through equations 23 29 for a predetermined number of iterations the matrices related to received measurements c t k and c t k follow the constraint shown in equation 30 in which i is an identity matrix the proposed vb maeskf algorithm is summarized in fig 1 23 α t k 1 2 α t k 24 r ˆ t k b l o c k d i a g β 1 t k α 1 t k β 2 t k α 2 t k β m t k α m t k 25 k t k p t k h t k h t k t p t k h t k m t k t r ˆ t k m t k 1 26 δ x ˆ t k δ x ˆ t k k t k δ y t k h t k δ x ˆ t k 27 p t k p t k k t k h t k t p t k h t k m t k t r ˆ t k m t k k t k t 28 β t k c t k β t k 1 2 h t k δ y t k h t k δ x ˆ t k 2 h t k t p t k h t k 29 β t k β t k c t k β t k 30 c t k c t k i in fig 2 a flowchart containing three phases of the integrated navigation system based on vb maeskf for underwater vehicles is shown in stationary condition and before of navigation the initialization phase in two steps i e coarse alignment and fine alignment is done and initial values for system states their variances and parameters of variational bayesian are calculated after the initialization phase the navigation will be started which is included prediction and update phases in the prediction phase the error states their variances and α β are predicted by using the updated values in previous time step in the update phase in the best conditions at a time step for example t k if all possible measurements including data of gps depth meter dvl inclinometer and gyrocompass are available the measurement error vector can be expressed as equation 21 in which m is five at t k 1 1 that only the first sensor gps data is available the relationship between measurement error and error states of the horizontal position are used at t k 2 2 if only the second sensor depth meter data is received the relationship between the measurement error and the error state of the depth are used at t k 3 3 if only the third sensor dvl data is received the relationship between the measurement error and the error states of the velocity are expressed at t k 4 4 the relationship between the measurement error and error states of the attitude are applied and at t k 5 5 if only the fifth sensor gyrocompass data is available the relationship between the measurement error and error states of the heading can be expressed more details for the measurement equation of auxiliary sensors are presented in davari et al 2017 in order to evaluate the required computational time of the proposed algorithm and two others algorithms maeskf and meskf equation 31 is used assimakis et al 2013 31 t a l g c b a l g n a l g t o p where t o p c b a l g and n a l g are the time required to perform a scalar operation calculation burden per iteration and number of iterations in an algorithm respectively the computational burden for three algorithms are summarized in table 1 and n and m are dimensions of state vector and measurement vector respectively in algorithms with the same number of iterations the calculation burdens per iteration can be compared if the integrated navigation system uses full state n 15 and all auxiliary sensors m 9 the computational burden of maeskf is larger than vb maeskf and meskf 3 experimental results to evaluate performance of the proposed algorithm in a dynamic system with unknown and time varying measurement noise statistics two sea tests were performed in the first test trajectory no 1 the vessel travelled approximately 23 km in a round trip for about 337 min and in the second test trajectory no 2 the vessel travelled approximately 9 63 km for about 83 min fig 3 shows these two trajectories in order to determine initial values of the navigation system and deterministic inertial sensors errors an alignment procedure is applied in stationary condition according to the procedure proposed by chen 2008 in the two trajectories the vessel was in stationary condition for 10 min at beginning of the travel subsequent to the alignment the navigation phase is started in which the proposed algorithm estimates navigation system state by using auxiliary measurements provided by the dvl depth meter and inclinometer the gps data is used only as the reference and for initialization more detailed descriptions from the technical specifications of the sensors could be found in table 2 to evaluate the performance of the proposed algorithm meskf algorithm developed by titterton and weston 2004 and farrell 2008 and maeskf algorithm proposed by davari et al 2017 have been applied in the same test cases results of the proposed algorithm are compared with the results of meskf and maeskf algorithms the kalman filter is often regarded as an appropriate estimator for linear gaussian dynamic systems the outlying measurement may result in a reduction of navigation system accuracy and performance breakdowns therefore the kalman filter requires an appropriate algorithm in order to reject the outlier data one of the basic methods to reject outliers is mahalanobis distance which is applied to dvl data in meskf and maeskf algorithms called as rejection criterion in this method if the squared innovation δ y 3 t k 3 3 h 3 t k 3 3 δ x ˆ t k 2 is q times larger than the measurement covariance h 3 t k 3 3 t p t k h 3 t k 3 3 r 3 t k 3 3 then the measurement is rejected the parameter q is called as rejection coefficient and could be tuned to eliminate outliers in order to find the best rejection coefficient for meskf and maeskf algorithms several coefficient values have been applied manually to the algorithms and finally the coefficient with the lowest relative rmse have been selected the rmse of the estimated position in meters and relative rmse in are calculated as shown in equations 32 and 33 where x r e f y r e f z r e f and x e s t y e s t z e s t are the reference and the estimated positions in x y and z directions respectively 32 r m s e 1 n i 1 n x r e f i x e s t i 2 y r e f i y e s t i 2 z r e f i z e s t i 2 33 r e l a t i v e r m s e r m s e t r a v e l l e d d i s t a n c e 100 fig 4 a and b show the relative rmses of the position estimated by using meskf maeskf and vb maeskf algorithms for 25 different values of reject coefficient q in the tests performed on trajectories no 1 and no 2 respectively in trajectory no 1 minimum relative rmses for meskf maeskf and vb maeskf are obtained as 0 8 0 3 and 0 2 of the travelled distance for values of q 600 1800 and 2600 respectively in trajectory no 2 minimum relative rmses for meskf maeskf and vb maeskf are obtained as 1 0 9 and 0 65 for values of q 200 1400 and 2600 respectively the results show that on the one hand the accuracy of meskf and maeskf algorithms is highly dependent on the value of q and its optimum value depends on the trajectory i e it needs to be tuned and on the other hand vb maesk is not sensitive to the value of q the proposed algorithm reduces the value of the squared innovation by accurate estimation of measurement noise covariance of dvl and system states further it is robust to the outliers and anomalous measurements it is clear that increasing the value of q results in a lower probability of rejection the abnormal dvl data leading to an increase in the rmse further decreasing the value of q results in rejecting more number of dvl data however this procedure is not efficient enough since it might reject the original data fig 5 shows an example of the setting value of q the top part of the figure illustrates the dvl measurements in the body frame and its down part shows the rejection criterion over the time of dvl for q 500 furthermore the process noise covariance matrix needs to be manually tuned for every trajectory in order to obtain the best performance of meskf and maeskf algorithms the tuning process has been performed on 12 elements of the process noise covariance matrix fig 6 a and b show the relative rmse of position estimated for different values of the process noise covariance of gyroscope bias as an example in the test performed on trajectory no 1 and no 2 respectively results of this analysis confirm that meskf and maeskf algorithms are more sensitive to process noise covariance compared to vb maeskf algorithm according to fig 6 a for trajectory no 1 the smallest value for the rmses of the position estimated by using meskf maeskf and vb maeskf algorithms are 184 80 and 46 m and relative rmse are 0 8 0 35 and 0 2 of the travelled distance respectively according to these results the proposed algorithm improves the accuracy of the estimated position approximately 75 and 42 compared to meskf and maeskf algorithms correspondingly according to fig 6 b for trajectory no 2 the rmses of the position estimated by the meskf maeskf and vb maeskf algorithms are 102 89 and 62 meters and relative rmse are 1 06 0 91 and 0 65 of the travelled distance correspondingly according to these results the proposed algorithm exhibits an improvement of almost 39 and 30 in position estimation compared to meskf and maeskf algorithms respectively fig 7 and fig 8 show the trajectory estimated by meskf maeskf and vb maeskf algorithms compared to the reference trajectory in trajectory no 1 and no 2 respectively note that the reference trajectory is compiled from smoothed gps data in the east and north directions it should be noted that the estimated trajectories by meskf and maeskf algorithms are calculated using an optimal value of the rejection coefficient q and the process noise covariance which leads to the minimum relative rmse for these two algorithms also the measurement noise covariance matrix has been manually tuned for meskf algorithm however as an advantage for vb maeskf algorithm it does not need to tune optimal value for q to reject abnormal data and the process and measurement noise variances the proposed method is robust to outliers results presented in fig 4 show that on the one hand in underwater navigation the outlier in dvl data decrease the accuracy of estimated position and on the other hand tuning rejection coefficient is very time consuming and should be repeated for each trajectory hence the use of a robust algorithm is highly efficient in fig 9 a and b the absolute error of the estimated position over time using meskf maeskf using the optimum value of q and process and measurement noise variances and vb maeskf algorithms are presented for trajectories no 1 and 2 respectively the absolute error is difference between the estimated and the reference positions in the integrated navigation for the underwater vehicle using vb maeskf figs 7 10 procedure of outlier rejection is not performed it is obvious that although the key parameters of meskf and maeskf algorithms have been tuned for the best performance the absolute error for vb maeskf algorithm over the time is much lower than the two other algorithms in both trajectories no 1 and no 2 with reference to the two graphs in fig 9 a and b it can be concluded that since the test trajectory no 1 is a round trip the absolute error is mostly bounded over the time however the test trajectory no 2 follows a straightahead trajectory and thus the absolute error is growing with time fig 10 a d illustrate the estimated measurements noise variance of dvl inclinometer and depth meter sensors by maeskf and vb maeskf algorithms and the real measurement of the sensors for the test performed on trajectory no 1 similar results for the test performed on trajectory no 2 are shown in fig 10 e h upper graphs in fig 10 a h illustrate the real measurements of the auxiliary sensors and lower graphs shows their estimated noise variance as it is shown at time instants that a rapid change in the auxiliary measurements happens which seems to be the noise effect the estimated noise variance is increased especially for vb maeskf algorithm to optimize the kalman filter performance the navigation results for two trajectories are summarized in table 3 according to these results the vb maeskf algorithm improves the accuracy of the estimated position of both trajectories on average about 57 and 36 compared to meskf and maeskf algorithms respectively 4 conclusion this paper presented an asynchronous multirate multi sensors adaptive kalman filter algorithm to enhance the accuracy of the underwater integrated navigation system in the proposed algorithm maeskf algorithm was modified based on variational bayesian approximations to adaptively tuning the measurement covariance matrix of the asynchronous auxiliary sensors performance of the proposed algorithm has been evaluated through experimental tests performed on two trajectories and comparing to the related results obtained by using meskf and maeskf algorithms results show that the proposed algorithm is robust to outliers and anomalous measurements of the auxiliary sensors compared to meskf and maeskf algorithms furthermore the proposed algorithm is less sensitive to non optimal values of process noise variance than meskf and maeskf algorithms results of the tests show that the average relative rmse of the position estimated by the vb maeskf algorithm is reduced by about 57 and 36 compared to meskf and maeskf algorithms respectively acknowledgment the authors would like to thank mr mehdi emami for his help in data acquisition 
22972,this study considers an asynchronous multirate data integration problem in the linear state space model with unknown and time varying statistical parameters of the measurement noises to improve performance of the multirate adaptive kalman filter algorithm a multi sensor adaptive kalman filtering algorithm based on variational bayesian approximations has been developed in an asynchronous multirate multi sensor integrated navigation system the proposed filtering algorithm estimates measurement noise variances of the sensors adaptively and also it is robust to anomalous measurements of sensors and however multirate adaptive kalman filter is required to use an appropriate algorithm for outlier rejection to achieve a reliable and optimal estimation of position velocity and orientation a navigation system composed of a strapdown inertial navigation system along with doppler velocity log inclinometer and depth meter with different sampling rates is designed to evaluate performance of multirate error state kalman filter meskf and multirate adaptive error state kalman filter maeskf algorithms and the proposed algorithm results of two experimental tests show that the average relative root mean square error rmse of the position estimated by the proposed filtering algorithm can be decreased approximately 57 and 36 when compared to that of meskf and maeskf algorithms respectively keywords error state kalman filter asynchronous multirate adaptive kalman filter variational bayesian approximations underwater integrated navigation system strapdown inertial navigation system 1 introduction the conventional kalman filter algorithm has been widely implemented for integrating the strapdown inertial navigation system sdins and auxiliary sensors davari and gholami 2017 davari et al 2017 miller et al 2010 shabani et al 2015 sheijani et al 2013 titterton and weston 2004 in sdins the inertial measurement unit imu is directly installed in the vehicle the imu provides measurements related to the acceleration and angular rates of a vehicle the navigation system states such as the position velocity and orientation are estimated through the navigation equation of sdins measurement equations state equations and real measurements a prior exact knowledge of the navigation system dynamics and the statistical information of the process and measurement noise covariance matrix is required for proper conventional kalman filter algorithm performance in most applications the process and measurement noises are often unknown or time varying and they are mostly dependent on the application environment and process dynamics which degrade the accuracy of estimation of kalman filter algorithm a classical way to solve this problem is to use adaptive filters the adaptive kalman filter akf algorithm can estimate the dynamic state and the statistical characteristics of the measurement noise simultaneously the adaptive technique does not need the exact values of the priorstatistical information of the state and therefore kalman filter algorithm performance is improved through the process of filter learning mehra 1970 moreover the outliers within the measured data increase the estimation error and normally adaptive kalman filters use an appropriate algorithm for outlier rejection is used to increase the system accuracy and reliability various adaptive filtering algorithms have been used to estimate the filter s statistical information in dynamic systems and are broadly divided into four categories of bayesian maximum likelihood hasan et al 2010 correlation and covariance matching methods mehra 1970 the adaptive filtering based on maximum likelihood hasan et al 2010 requires a quite long innovation sequence to estimate values of the process and measurements noise covariance in this method the process and measurement noise covariance are calculated through maximizing the likelihood function of the innovations raghavan et al 2006 the main problem of the ml method is high sensitivity to outlier auxiliary data in addition the estimated noise covariance cannot be adjusted immediately with the recent innovation sequences moreover data fusion used in navigation applications with this method is too time consuming and cannot be used in real time applications mohamed and schwarz 1999 the covariance matching technique is based on the innovation or residual sequence and calculates the covariance of the system states by employing a moving window over the streaming data in this method the process and measurement noise covariance values are estimated by matching the calculated covariance value and their theoretical value ding et al 2007 hide et al 2003 maybeck 1982 the correlation technique estimates the covariance matrices based on the autocorrelation function of the output or the innovation sequence one of the disadvantages of this method is its high processing load due to the need for a large window of data furthermore it does not guarantee the positive definiteness of the matrices odelson et al 2006 oussalah and de schutter 2001 the bayesian method is more comprehensive than the aforementioned methods that often approximate bayesian method e g särkkä and nummenmaa 2009 bayesian method excels the ml method in two ways first there are no restrictions on choosing the required data size and second it acts as a robust method because of using a predictive posterior distribution watanabe et al 2004 the navigation accuracy is very sensitive to anomalous measurements and transient disturbances which lead to very poor estimates agamennoni et al 2011 in underwater navigation the velocity of the vehicle is measured using a doppler velocity log dvl allotta et al 2016 kinsey and whitcomb 2004 the dvl measurements sometimes have drastic and unreal changes called the outlier bamnett and lewis 1994 the outliers may originate from instrument errors or circumstance disturbances the variance of measurement noise is time varying because of outlier influence särkkä and nummenmaa 2009 developed variational bayesian approximation based adaptive kalman filter vb akf algorithm to solve the estimation problem with unknown and time varying measurement noise in which only one auxiliary sensor has been implemented the vb akf algorithm is a robust kalman filter in the presence of measurement outliers gao et al 2011 modified vb akf algorithm to be used in a single rate multi sensor system in which the measurement sensors were similar performance of their proposed algorithm was evaluated through numerical simulation previous researches reported applications of akf and or vb akf algorithms in the field of underwater navigation related to the application of single auxiliary sensor or synchronous multi sensors e g dah jing and chen 2011 jwo and weng 2008 yu 2012 to the best of authors knowledge this paper reports the first development of an asynchronous multirate multi sensor adaptive kalman filtering algorithm based on variational bayesian approximations for underwater integrated navigation systems in this paper the vb akf algorithm is modified to estimate the navigation system state and measurement noise variances of multiple asynchronous auxiliary sensors for the underwater integrated navigation system in order to enhance the performance of the akf algorithm unlike akf algorithm the proposed algorithm can tune the covariance matrix of asynchronous auxiliary measurements adaptively in addition the proposed algorithm is not sensitive to outlying measurement and does not require an additional algorithm to remove the corrupted auxiliary data the performance of the proposed algorithm is evaluated through real measurements and its results are compared with those of akf algorithm in both methods the integration structure is based on error state kalman filter eskf this paper is organized as followings section 2 reviews the variational bayesian approximation based on adaptive error state kalman filter vb aeskf and presents the proposed asynchronous multirate vb aeskf algorithm the structure of the integrated inertial navigation system is reviewed in section 2 and equations related to the sdins errors state and measurement models are presented in this section as well in section 3 performance of the proposed algorithm is evaluated using the real data sets finally conclusion remarks are presented in section 4 2 principles of the proposed algorithm in this section principles of the proposed vb maeskf algorithm are presented after a brief introduction to the integrated navigation system vb aeskf algorithm and variational approximation 2 1 integrated navigation system in integrated navigation systems the dynamic equations of sdins are continuous time nonlinear error state space model these systems consist of a set of timedependent equations such as change rates of estimated position velocity orientation and bias instability in these equations the angular rate and linear acceleration are given in body frame and the velocity and position of the vehicle should be estimated in the navigation frame in the dynamic equations of sdins it is assumed that the output error of the accelerometers and gyroscopes are the sum of bias instability and gaussian random noise the accelerometer and gyroscope bias instability are modeled as the summation of random walks and random constants the general form of a continuous time nonlinear state space model suggested by simon 2006 have been applied for the sdins equation 1 in which x is time derivative of navigation system state x is total navigation system state vector of the sdins f is the sdins nonlinear function which describes the dynamic behavior of the navigation system g t is the noise input matrix and w t is the process noise due to uncertainty in the control inputs which is assumed to be a zero mean gaussian white noise distribution with known covariance matrix q t the control input u t is given in equation 2 in which f b ω i b b are linear acceleration and angular rate vectors respectively 1 x t f x t u t g t w t w n 0 q t 2 u f b ω i b b t in this paper the reviewed and proposed integrated navigation algorithms are based on error states of system this paper considers the discrete time linear error state space model as shown in the following equations equations 3 and 4 are error state equation and measurement error equation of ith auxiliary sensor respectively at the case time instant t k that are expressed in eskf the error state and measurement error equations for implementing in the multirate kalman filter have been comprehensively reviewed in davari et al 2017 3 δ x t k a t k 1 δ x t k 1 l t k 1 w t k 1 w t k n 0 q t k 4 δ y i t k h i t k δ x t k m i t k r i t k r i t k n 0 r i t k where δ x k is an n dimensional error state vector n is the number of states considered for the navigation system the error state δ x x t r u e x ˆ represent the expected error between the true state x t r u e and its estimation x ˆ further a t k is n n system state transition matrix l t k 1 is n η dynamic noise distribution matrix w t k 1 is η dimensional input white noise vector which is assumed to be a gaussian distribution with zero mean and η η covariance matrix q t k 1 and η is the number of modeled errors for imu sensors in this paper two types of errors bias instability and random walk for three accelerometers and three gyroscopes are considered thus η is 12 in equation 4 δ y i t k is a d i dimensional measurement error vector and is the difference between the navigation solution from the sdins and auxiliary measurement sensors h i t k and m i t k are d i n measurement output matrix and d i d i measurement noise distribution matrix respectively for i t h auxiliary sensor and r i t k represents d i dimensional measurement noise vector which is assumed to be a zero mean gaussian white noise distribution with d i d i time varying covariance matrix r i t k in this paper sensors are assumed to be independent of each other thus their measurement noises are uncorrelated as shown in equation 5 δ is kronecker delta function 5 e r i t k r j t h r i t k δ i j δ k h in the vb aeskf algorithm the variational bayesian approximation recursively approximates the joint posterior distribution of the error state and measurement noise variance p δ x t 1 k r i t k δ y i t 1 k by using a factorized free form distribution särkkä and nummenmaa 2009 then the state and the measurement noise variances are estimated by means of a fixed point iteration in the recursive algorithm in this paper it is assumed that the prior navigation system state and the process noise variance and unknown measurement noise variance are independent of each other prior to start the vb aeskf algorithm an initialization procedure is used to determine initial value for the state and its noise variance and the prior distribution p δ x t 0 r i t 0 the prior error state information δ x t 0 has a gaussian distribution with m t 0 and p t 0 as its mean and covariance respectively the vb aeskf algorithm is divided into prediction and update phases in the prediction phase the chapman kolmogorov equation approximates the conditional distribution for the error state and the measurement noise variance given by the measurements error δ y i t 1 k 1 as shown in equation 6 6 p δ x t k r i t k δ y i t 1 k 1 p δ x t k δ x t k 1 p r i t k r i t k 1 p δ x t k 1 r i t k 1 δ y i t 1 k 1 d δ x t k 1 d r i t k 1 in the update phase if the measurement data becomes available at t k the prior distribution is updated via bayes rule given in equation 7 c is normalization constant in this paper for prediction and update phases error state and measurement error have been modified in order to solve the problem based on eskf 7 p δ x t k r i t k δ y i t 1 k 1 c p δ y i t 1 k δ x t k r i t k p δ x t k r i t k δ y i t 1 k 1 2 2 variational approximation the variational bayesian method is known as an ensemble learning method it uses a variational approximation for approximating the intractable integral of the bayesian method where the true posterior distribution is approximated with a simpler distribution this is a robust estimation method that reduces the computational complexity beal 2003 ghahramani and beal 1999 ueda and ghahramani 2002 according to särkkä and nummenmaa 2009 it can be assumed that the error states are independent of the measurement noise variances therefore the variational bayesian vb approximation method can be used to approximate the conditional distribution for the error state and the measurement noise variances given measurements error δ y i t 1 k as presented in equation 8 where n and inv gamma represent the gaussian and inverse gamma distributions respectively α i t k and β i t k are parameters of inv gamma distribution for measurement noise variance at t k for ith sensor the implementation details of the vb approximation method for akf algorithm can be found in särkkä and nummenmaa 2009 8 p δ x t k r i t k δ y i t 1 k p δ x t k δ y i t 1 k p r i t k δ y i t 1 k p δ x t k δ y i t 1 k n δ x t k δ x ˆ t k p t k p r i t k δ y i t 1 k i 1 d i i n v g a m m a σ i 2 t k α i t k β i t k 2 3 the proposed vb maeskf algorithm the algorithm proposed in this paper can be applied in integrated navigation system with dissimilar sensors whose sampling rates are different i e asynchronous multi rate sensors using multiple sensors could potentially provide better performance and higher navigation accuracy due to better visibility and complementary information the considered integrated navigation system consist of an imu and m multirate auxiliary sensors with different sample periods t and t i for each sensor respectively let t t 0 t 1 t k t γ and t i t 0 i t 1 i t k i i t γ i i denote the different discrete time sets for imu and the ith auxiliary sensor respectively further г and г i are the largest time instants for the imu and the ith auxiliary sensor respectively and t k and t k i i as shown in equation 9 are the time instant when kth measurement of imu and k i t h measurement of ith auxiliary sensor are available where t and t i are sampling period for imu and ith auxiliary sensor respectively 9 t k t 0 k t t k i i t 0 i k i t i without loss of generality it is assumed that t 0 t 0 i and t i t in general t k i i may not be equal to t k j j even if time instant of two different sensors are equal k i k j i j for the proposed vb maeskf algorithm modified prediction and update phases have been applied in the prediction phase the error state and its covariance are predicted as shown in equations 10 and 11 10 δ x ˆ t k a t k δ x ˆ t k 1 11 p t k a t k 1 p t k 1 a t t k 1 l t k 1 q t k 1 l t t k 1 in this paper estimated quantities are denoted by a hat and and denote values calculated in predict and update phases respectively the parameters of the inv gamma distribution for the ith auxiliary sensor are given in equations 12 and 13 a scale factor 0 ρ i 1 is employed to control the fluctuation of the estimated measurement noise variance if the value of ρ i is close to one fluctuations of the estimated measurement noise variance becomes smooth and the lower values for ρ i the larger the fluctuations 12 α i t k i i ρ i α i t k i 1 i 13 β i t k i i ρ i β i t k i 1 i at t k dimensions of matrices h t k m t k and r t k and dimensions of vectors δ y t k and r t k are d k n d k d k d k d k d k 1 and d k 1 respectively in which d k is expressed as equation 14 14 min i d i d k i 1 m d i if time instant of imu equals with time instant of m auxiliary sensors as presented in equation 15 then α acharya et al 2011 and β acharya et al 2011 are the vectors for the parameters of the inv gamma at t k and are given by equations 16 and 17 15 t k t k 1 1 t k 2 2 t k m m 16 α t k α 1 t k t α 2 t k t α m t k t 17 β t k β 1 t k t β 2 t k t β m t k t the update phase of the proposed algorithm is executed when at least one of the auxiliary sensors data is received at t k if time instant of the sensors do not follow equation 15 a vector s t k s 1 t k s 2 t k s m t k is introduced where s i t k gains a binary value if s i t k 1 it means that the ith sensor measurement at t k is received therefore β t k presented in equation 17 is modified using equations 18 and 19 so that can be used in update phase 18 c t k d i a g s t k 19 β t k c t k β t k if at t k the ith sensor data becomes available the values of the ith sensor measurement output matrix h i t k and the measurement error vector δ y i t k are placed on the total measurement output matrix h t k and the total measurement error vector δ y t k respectively in the case of receiving all of the auxiliary measurements at time step t k equation 15 the measurement output matrix and the measurement error vector are expressed as equations 20 and 21 20 h t k h 1 t k 1 1 t h 2 t k 2 2 t h m t k m m t t 21 δ y t k δ y 1 t k 1 1 t δ y 2 t k 2 2 t δ y m t k m m t t if the measurement noises for different sensors are uncorrelated the measurement noise covariance matrix r t k may be expressed as equation 22 where r i t k i i is variance of the measurement errors for ith sensor at t k 22 r t k e r t k r t k t b l o c k d i a g r 1 t k 1 1 r 2 t k 2 2 r m t k m m receiving a new auxiliary measurement the navigation error state and its associated covariance matrix p t k at t k are estimated through equations 23 29 for a predetermined number of iterations the matrices related to received measurements c t k and c t k follow the constraint shown in equation 30 in which i is an identity matrix the proposed vb maeskf algorithm is summarized in fig 1 23 α t k 1 2 α t k 24 r ˆ t k b l o c k d i a g β 1 t k α 1 t k β 2 t k α 2 t k β m t k α m t k 25 k t k p t k h t k h t k t p t k h t k m t k t r ˆ t k m t k 1 26 δ x ˆ t k δ x ˆ t k k t k δ y t k h t k δ x ˆ t k 27 p t k p t k k t k h t k t p t k h t k m t k t r ˆ t k m t k k t k t 28 β t k c t k β t k 1 2 h t k δ y t k h t k δ x ˆ t k 2 h t k t p t k h t k 29 β t k β t k c t k β t k 30 c t k c t k i in fig 2 a flowchart containing three phases of the integrated navigation system based on vb maeskf for underwater vehicles is shown in stationary condition and before of navigation the initialization phase in two steps i e coarse alignment and fine alignment is done and initial values for system states their variances and parameters of variational bayesian are calculated after the initialization phase the navigation will be started which is included prediction and update phases in the prediction phase the error states their variances and α β are predicted by using the updated values in previous time step in the update phase in the best conditions at a time step for example t k if all possible measurements including data of gps depth meter dvl inclinometer and gyrocompass are available the measurement error vector can be expressed as equation 21 in which m is five at t k 1 1 that only the first sensor gps data is available the relationship between measurement error and error states of the horizontal position are used at t k 2 2 if only the second sensor depth meter data is received the relationship between the measurement error and the error state of the depth are used at t k 3 3 if only the third sensor dvl data is received the relationship between the measurement error and the error states of the velocity are expressed at t k 4 4 the relationship between the measurement error and error states of the attitude are applied and at t k 5 5 if only the fifth sensor gyrocompass data is available the relationship between the measurement error and error states of the heading can be expressed more details for the measurement equation of auxiliary sensors are presented in davari et al 2017 in order to evaluate the required computational time of the proposed algorithm and two others algorithms maeskf and meskf equation 31 is used assimakis et al 2013 31 t a l g c b a l g n a l g t o p where t o p c b a l g and n a l g are the time required to perform a scalar operation calculation burden per iteration and number of iterations in an algorithm respectively the computational burden for three algorithms are summarized in table 1 and n and m are dimensions of state vector and measurement vector respectively in algorithms with the same number of iterations the calculation burdens per iteration can be compared if the integrated navigation system uses full state n 15 and all auxiliary sensors m 9 the computational burden of maeskf is larger than vb maeskf and meskf 3 experimental results to evaluate performance of the proposed algorithm in a dynamic system with unknown and time varying measurement noise statistics two sea tests were performed in the first test trajectory no 1 the vessel travelled approximately 23 km in a round trip for about 337 min and in the second test trajectory no 2 the vessel travelled approximately 9 63 km for about 83 min fig 3 shows these two trajectories in order to determine initial values of the navigation system and deterministic inertial sensors errors an alignment procedure is applied in stationary condition according to the procedure proposed by chen 2008 in the two trajectories the vessel was in stationary condition for 10 min at beginning of the travel subsequent to the alignment the navigation phase is started in which the proposed algorithm estimates navigation system state by using auxiliary measurements provided by the dvl depth meter and inclinometer the gps data is used only as the reference and for initialization more detailed descriptions from the technical specifications of the sensors could be found in table 2 to evaluate the performance of the proposed algorithm meskf algorithm developed by titterton and weston 2004 and farrell 2008 and maeskf algorithm proposed by davari et al 2017 have been applied in the same test cases results of the proposed algorithm are compared with the results of meskf and maeskf algorithms the kalman filter is often regarded as an appropriate estimator for linear gaussian dynamic systems the outlying measurement may result in a reduction of navigation system accuracy and performance breakdowns therefore the kalman filter requires an appropriate algorithm in order to reject the outlier data one of the basic methods to reject outliers is mahalanobis distance which is applied to dvl data in meskf and maeskf algorithms called as rejection criterion in this method if the squared innovation δ y 3 t k 3 3 h 3 t k 3 3 δ x ˆ t k 2 is q times larger than the measurement covariance h 3 t k 3 3 t p t k h 3 t k 3 3 r 3 t k 3 3 then the measurement is rejected the parameter q is called as rejection coefficient and could be tuned to eliminate outliers in order to find the best rejection coefficient for meskf and maeskf algorithms several coefficient values have been applied manually to the algorithms and finally the coefficient with the lowest relative rmse have been selected the rmse of the estimated position in meters and relative rmse in are calculated as shown in equations 32 and 33 where x r e f y r e f z r e f and x e s t y e s t z e s t are the reference and the estimated positions in x y and z directions respectively 32 r m s e 1 n i 1 n x r e f i x e s t i 2 y r e f i y e s t i 2 z r e f i z e s t i 2 33 r e l a t i v e r m s e r m s e t r a v e l l e d d i s t a n c e 100 fig 4 a and b show the relative rmses of the position estimated by using meskf maeskf and vb maeskf algorithms for 25 different values of reject coefficient q in the tests performed on trajectories no 1 and no 2 respectively in trajectory no 1 minimum relative rmses for meskf maeskf and vb maeskf are obtained as 0 8 0 3 and 0 2 of the travelled distance for values of q 600 1800 and 2600 respectively in trajectory no 2 minimum relative rmses for meskf maeskf and vb maeskf are obtained as 1 0 9 and 0 65 for values of q 200 1400 and 2600 respectively the results show that on the one hand the accuracy of meskf and maeskf algorithms is highly dependent on the value of q and its optimum value depends on the trajectory i e it needs to be tuned and on the other hand vb maesk is not sensitive to the value of q the proposed algorithm reduces the value of the squared innovation by accurate estimation of measurement noise covariance of dvl and system states further it is robust to the outliers and anomalous measurements it is clear that increasing the value of q results in a lower probability of rejection the abnormal dvl data leading to an increase in the rmse further decreasing the value of q results in rejecting more number of dvl data however this procedure is not efficient enough since it might reject the original data fig 5 shows an example of the setting value of q the top part of the figure illustrates the dvl measurements in the body frame and its down part shows the rejection criterion over the time of dvl for q 500 furthermore the process noise covariance matrix needs to be manually tuned for every trajectory in order to obtain the best performance of meskf and maeskf algorithms the tuning process has been performed on 12 elements of the process noise covariance matrix fig 6 a and b show the relative rmse of position estimated for different values of the process noise covariance of gyroscope bias as an example in the test performed on trajectory no 1 and no 2 respectively results of this analysis confirm that meskf and maeskf algorithms are more sensitive to process noise covariance compared to vb maeskf algorithm according to fig 6 a for trajectory no 1 the smallest value for the rmses of the position estimated by using meskf maeskf and vb maeskf algorithms are 184 80 and 46 m and relative rmse are 0 8 0 35 and 0 2 of the travelled distance respectively according to these results the proposed algorithm improves the accuracy of the estimated position approximately 75 and 42 compared to meskf and maeskf algorithms correspondingly according to fig 6 b for trajectory no 2 the rmses of the position estimated by the meskf maeskf and vb maeskf algorithms are 102 89 and 62 meters and relative rmse are 1 06 0 91 and 0 65 of the travelled distance correspondingly according to these results the proposed algorithm exhibits an improvement of almost 39 and 30 in position estimation compared to meskf and maeskf algorithms respectively fig 7 and fig 8 show the trajectory estimated by meskf maeskf and vb maeskf algorithms compared to the reference trajectory in trajectory no 1 and no 2 respectively note that the reference trajectory is compiled from smoothed gps data in the east and north directions it should be noted that the estimated trajectories by meskf and maeskf algorithms are calculated using an optimal value of the rejection coefficient q and the process noise covariance which leads to the minimum relative rmse for these two algorithms also the measurement noise covariance matrix has been manually tuned for meskf algorithm however as an advantage for vb maeskf algorithm it does not need to tune optimal value for q to reject abnormal data and the process and measurement noise variances the proposed method is robust to outliers results presented in fig 4 show that on the one hand in underwater navigation the outlier in dvl data decrease the accuracy of estimated position and on the other hand tuning rejection coefficient is very time consuming and should be repeated for each trajectory hence the use of a robust algorithm is highly efficient in fig 9 a and b the absolute error of the estimated position over time using meskf maeskf using the optimum value of q and process and measurement noise variances and vb maeskf algorithms are presented for trajectories no 1 and 2 respectively the absolute error is difference between the estimated and the reference positions in the integrated navigation for the underwater vehicle using vb maeskf figs 7 10 procedure of outlier rejection is not performed it is obvious that although the key parameters of meskf and maeskf algorithms have been tuned for the best performance the absolute error for vb maeskf algorithm over the time is much lower than the two other algorithms in both trajectories no 1 and no 2 with reference to the two graphs in fig 9 a and b it can be concluded that since the test trajectory no 1 is a round trip the absolute error is mostly bounded over the time however the test trajectory no 2 follows a straightahead trajectory and thus the absolute error is growing with time fig 10 a d illustrate the estimated measurements noise variance of dvl inclinometer and depth meter sensors by maeskf and vb maeskf algorithms and the real measurement of the sensors for the test performed on trajectory no 1 similar results for the test performed on trajectory no 2 are shown in fig 10 e h upper graphs in fig 10 a h illustrate the real measurements of the auxiliary sensors and lower graphs shows their estimated noise variance as it is shown at time instants that a rapid change in the auxiliary measurements happens which seems to be the noise effect the estimated noise variance is increased especially for vb maeskf algorithm to optimize the kalman filter performance the navigation results for two trajectories are summarized in table 3 according to these results the vb maeskf algorithm improves the accuracy of the estimated position of both trajectories on average about 57 and 36 compared to meskf and maeskf algorithms respectively 4 conclusion this paper presented an asynchronous multirate multi sensors adaptive kalman filter algorithm to enhance the accuracy of the underwater integrated navigation system in the proposed algorithm maeskf algorithm was modified based on variational bayesian approximations to adaptively tuning the measurement covariance matrix of the asynchronous auxiliary sensors performance of the proposed algorithm has been evaluated through experimental tests performed on two trajectories and comparing to the related results obtained by using meskf and maeskf algorithms results show that the proposed algorithm is robust to outliers and anomalous measurements of the auxiliary sensors compared to meskf and maeskf algorithms furthermore the proposed algorithm is less sensitive to non optimal values of process noise variance than meskf and maeskf algorithms results of the tests show that the average relative rmse of the position estimated by the vb maeskf algorithm is reduced by about 57 and 36 compared to meskf and maeskf algorithms respectively acknowledgment the authors would like to thank mr mehdi emami for his help in data acquisition 
22973,this note investigates the decentralized finite time formation control of underactuated unmanned surface vessels usvs in the presence of model uncertainty and environmental disturbance in the algorithm a novel adaptive finite time disturbance observer aftdo is incorporated into the proposed control strategy that enhances its robustness to the environmental disturbance by fusion of neural network nn and minimal learning parameterization mlp techniques the aftdo is constructed without priori information about the ship model and the upper bound of disturbance on the basis of undirected graph the decentralized control law is developed with local information from neighboring usvs specially since the aftdo and the decentralized control law share the same set of nn the whole algorithm is with merits of concise form and less adaptive parameters such design contributes to smaller computation load and facilitates the implementation of the algorithm in ocean engineering the semi global finite time uniformly boundedness sgftub of the closed loop system is proved by the lyapunov theory numerical simulations and comprehensive comparisons are conducted to demonstrate the remarkable performance and superiority of the proposed algorithm keywords underactuated ships undirected graph finite time control formation control disturbance observer 1 introduction as one of the most popular topics in marine cybernetics formation control of multiple underactuated ships has emerged as an exceptionally promising research issue in recent years it can promote the development of advanced marine equipments both in civil and military industries successful application can be found in diverse areas such as multi ships cooperative combat ship underway replenishment marine environment monitoring maritime search and rescue thus it is of practical significance to achieve more efficient reasonable results of formation control for usvs depending on the different theories there are four main approaches proposed to achieve formation control oh et al 2015 virtual structure control ren 2004 beard and lawton 2001 ren and beard 2003 leader follower control jian and chen et al 2010 peng et al 2013 das et al 2002 behavior based control balch t 1998 lawton et al 2003 and topology based control ren 2007 ren and sorensen 2008 the objective of formation control for multiple ships is to drive a group of usvs converge to a predetermined geometric pattern with desired heading angle due to the underactuated constraint for each ship model and restriction of communication among multiple ships it is difficult to design a decentralized formation control algorithm for usvs therefore related researches have been investigated by various of analytic tools in existed literature arrichiello and chiaverini 2006 aguiar et al 2006 dong and farrell 2008 for example an improved cooperative control strategy for underactuated marine vehicles is developed based on fixed topology in dong 2010 meanwhile the result is extended to the switch topology and communication delay cases consider the model uncertainty and marine disturbance a decentralized synchronization control law is proposed by fusion of parametric projection algorithm and dynamic surface control dsc technique the cooperative path following of multiple underactuated surface vessels is realized in hao et al 2013 2014 using the local information from neighbors the problem of formation control with consideration of communication delay for underactuated vessels is addressed in dong and farrell 2008 to enhance the robustness and reduce the chattering of the control system an adaptive proportion integral sliding mode control apismc algorithm is designed to achieve the leader follower formation control of underactuated vessels both the plant uncertainty and unknown disturbance are compensated by the parameter estimation technique sun et al 2017 in li et al 2018 a novel formation control scheme is presented for underactuated surface ships based on nonsingular terminal sliding mode control ntsmc approach although the singular problem is avoided and the result of finite time convergence is obtained the model uncertainty and environmental disturbance are not considered on the other hand the ship formation is inevitably suffered from the environmental disturbance induced by wind wave and current when proceeding at sea the aforementioned papers hao et al 2013 2014 aguiar et al 2006 dong and farrell 2008 all adopted the parameter adaptive strategy to solve the model uncertainty and external disturbance but the reconstruction of the uncertainty information is not achieved disturbance observer is a useful tool to reconstruct the external uncertainty and has been successfully applied in ship motion control zhiquan 2017 liu et al 2011 gao et al 2017 yao et al 2018 the disturbance observer is used in hu et al 2015 but only the result of asymptotic convergence is obtained in zhi 2017 an observer based control algorithm is presented to achieve the course keeping control for marine surface vessel via the estimation of yaw acceleration in wang et al 2017 the unknown external disturbance is observed exactly by the ftdo and thereby facilitates the implementation of the surge and yaw control scheme in order to increase the system s robustness a nonlinear disturbance observer is introduced to estimate the external disturbance in zheng and feroskhan 2018 however the construction of the disturbance observer in these schemes are under the premise of the assumption which the precise information about the ship model and the upper bound of the external disturbance are known such conditions are difficult to achieve in the practical engineering to address the aforementioned problem this paper proposed an observer based control algorithm for multiple underactuated vessels in the presence of model uncertainty and environmental disturbance the main contributions of this paper can be summarized as follows 1 a novel aftdo is designed by fusion of nn and mlp techniques different from the existed literature the proposed aftdo is with merits of concise form and easy construction the rigorous restriction on the prior knowledge about the ship model and the upper bound of the disturbance are removed by parameter adaptation meanwhile the result of finite time convergence of error signals for the closed loop system is obtained 2 an improved finite time decentralized formation control law is presented based on the designed aftdo on the basis of the undirected graph the control algorithm is derived with local information from neighboring usvs since the same set of nn is shared by the aftdo and the proposed control algorithm the computation load is dramatically reduced which facilitate the implementation of the algorithm in ocean engineering 2 problem formulation and preliminaries 2 1 algebraic and graph theory consider the cooperative system which contains n identical usvs the communication topology among the usvs can be described by the undirected graph g g ν ε where ν 1 2 n denotes a finite set with n nodes ε ν ν is a finite set with elements e i j called edge if e i j ε it means there existed the communication from node i to j for a undirected graph e i j ε e j i ε the adjacency matrix a a i j ℜ n n is a square matrix with elements a i j 1 if e i j ε and a i j 0 otherwise d d i j ℜ n n is the degree matrix of graph g and d is a diagonal matrix with elements d i j 1 equals to the number of adjacent nodes of node i l is the laplacian matrix of graph g and can be obtained by l d a 2 2 neural networks in the sequel the radial basis neural network rbfnn is employed as the universal approximator to estimate the unknown part of the ship model yan sheng and xiao feng 2007 the detail expression of nn is defined as s x a x where a ℜ l n is an optimal matrix with l nodes s x s 1 x s 2 x s l x is a rbf vector with the form of gaussian function s j x 1 2 π exp x μ j t x μ j 2 ς j 2 based on the result in zhang and zhang 2014 for any given continuous function f x with f 0 0 defined in the compact set ω x such that the nonlinear function f x can be modeled as 1 f x s x a x ε x ω x where ε x represents the approximation error of nns with unknown upper bound ε 0 2 3 underactuated model of usvs consider n identical underactuated usvs in the horizontal plane their dynamics are referred to zhang et al 2015 li et al 2008 we defined the η i x i y i ψ i t as the position variable and v i u i v i r i t as the velocity variable of vessel ith the kinematic model of the ith usv can be described as 2 x i u i cos ψ i v i sin ψ i y i u i sin ψ i v i cos ψ i ψ i r i where x i y i denotes the position and ψ i denotes the yaw angle of vessel i in the earth fixed frame u i v i r i denote the velocities in surge sway and yaw degree of freedom dof in body fixed frame the dynamics of the ith vessel is formulated as follows 3 u i f u i m u i d w u i m u i τ u i m u i v i f v i m v i d w v i m v i r i f r i m r i d w r i m r i τ r i m r i where f u i c 13 i r i d 11 i u i g u i f v i c 23 i r i d 22 i v i d 23 i r i f r i c 31 i u i c 32 i v i d 32 i r i are nonlinear functions d w u i d w v i d w r i are the forces and moments included by external disturbance c 13 i c 23 i c 31 i c 32 i are centripetal and coriolis coefficients d 11 i d 22 i d 32 i d 33 i are hydrodynamic damping coefficients g u i g v i g r i are unmodeled dynamics and τ u i τ r i are the control inputs respectively are surge force and yaw moment assumption 1 assume that the sway velocity v i is passive bounded for each usv remark 1 since the ship motion in sway direction is dominated by the hydrodynamics damping force and is damped out by this force the sway dynamics is passive boundedness this assumption is consistent with the marine practice and has been detailly analyzed in do et al 2004 by considering different cases 3 decentralized finite time control law design 3 1 construction of the aftdo in this part in order to enhance the robustness of the formation system against the environmental disturbance a novel aftdo is constructed without the information about the ship model and the upper bound of disturbance rigorous analysis is stated to prove the finite time convergence of the aftdo it is known that the nn is an effective tool to approximate the nonlinear functions due to its simplicity and power capacity it is a good candidate to approximate the model uncertainty of usvs in 3 f ℓ i ℓ u v r are unknown smooth functions and they can be approximated by nn as 4 f ℓ i θ ℓ i t s ℓ i ν i ε ℓ i where v i u i v i r i t denotes the input vector θ ℓ i ℜ l denotes the weight vector s l i v i ℜ l is the radial basis function vector l is the number of neurons ε ℓ i is the approximation error 5 f ℓ i θ ℓ i t s ℓ i ν i ε ℓ i ϑ ℓ i φ ℓ i where ϑ ℓ i φ ℓ i are defined as 6 ϑ ℓ i max ϑ ℓ i ε ℓ i φ ℓ i 1 s ℓ i v i then the dynamic model 3 for the ith usv can be formulated as follows 7 m ℓ i ℓ i f ℓ i τ ℓ i d w ℓ i note that d w ℓ i is bounded and d w ℓ i ξ ℓ i ξ ℓ i is the unknown bound of the environmental disturbance induced by the wind wave and current to design the aftdo the following auxiliary state is introduced 8 z ℓ i m ℓ i ℓ i m ℓ i ℓ ˆ i in 8 ℓ ˆ i is given by 9 m ℓ i l i λ ˆ ℓ i φ ℓ i τ ℓ i ξ ˆ ℓ i z ℓ i z ℓ i α 1 sig z ℓ i p α 2 z ℓ i where p is fractional power with 0 p 1 α 1 α 2 are positive constants ξ ˆ ℓ i is the estimation value ξ ℓ i λ ℓ i ϑ ℓ i 2 φ ℓ i φ ℓ i 2 4 b ℓ i 0 b ℓ i is a positive constant sig z ℓ i p sign z ℓ i z ℓ i p 10 ξ l i γ ℓ i z ℓ i σ 1 ℓ i ξ ˆ ℓ i ξ ˆ ℓ i 0 p where γ ℓ i and σ 1 ℓ i are positive constants ξ ˆ ℓ i 0 is the initial value of ξ ˆ ℓ i when t 0 the estimation for d w ℓ i is given by 11 d ˆ w ℓ i α 1 sig z ℓ i p α 2 z ℓ i ξ ˆ ℓ i z ℓ i z ℓ i the mlp based adaptive law for the model uncertainty is as follows 12 λ ˆ ℓ i λ ℓ i z ℓ i φ ℓ i σ 2 ℓ i λ ˆ ℓ i λ ˆ ℓ i 0 p where λ ℓ i σ 2 ℓ i are positive constants λ ˆ ℓ i is the estimation value of λ ℓ i λ ˆ ℓ i 0 is the initial value of λ ˆ ℓ i when t 0 theorem 1 consider the nonlinear system of ship dynamics 7 and the aftdo 11 with adaptive laws 10 12 the initial condition satisfied that z ℓ i 2 0 ξ ˆ ℓ i 2 0 λ ˆ ℓ i 2 0 ρ 1 with any ρ 1 0 then one can tune the parameters α 1 α 2 p γ ℓ i σ 1 ℓ i λ ℓ i and σ 2 ℓ i approximately such that the estimation error d w ℓ i will converge to the neighborhood of zero in finite time proof consider the lyapunov function candidate for the ith usv as follows 13 v 1 1 2 z ℓ i 2 1 2 γ ℓ i ξ ℓ i 2 1 2 λ ℓ i λ ℓ i 2 the time derivative of v 1 is given by 14 v 1 z ℓ i m ℓ i ℓ i m ℓ i l i γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i z ℓ i f ℓ i λ ˆ ℓ i φ ℓ i z ℓ i d w ℓ i z ℓ i ξ ˆ ℓ i z ℓ i z ℓ i α 2 z ℓ i 2 α 1 s i g z ℓ i p 1 γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i α 1 s i g z ℓ i p 1 z ℓ i λ ℓ i φ ℓ i λ ˆ ℓ i φ ℓ i 1 4 b z ℓ i α 2 z ℓ i 2 b z ℓ i b ℓ i 2 d w ℓ i z ℓ i ξ ˆ ℓ i z ℓ i γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i according to 10 12 lemma2 and lemma3 the following inequality can be derived 15 v 1 α 1 sig z ℓ i p 1 1 q 1 p σ 1 ℓ i ξ ℓ i p 1 σ 2 ℓ i λ ℓ i p 1 δ 1 α 1 2 p 1 2 1 2 z ℓ i 2 p 1 2 σ 1 ℓ i 1 q 1 p 2 p 1 2 1 2 ξ ℓ i 2 p 1 2 σ 2 ℓ i 1 q 1 p 2 p 1 2 1 2 λ ℓ i 2 p 1 2 δ 1 where δ 1 ς 1 ς 2 1 p b z ℓ i b ℓ i 2 can be achieved by selecting the parameter b z ℓ i to make 1 4 b z ℓ i α 2 0 the exact values of ς 1 ς 2 can be obtained according to lemma 2 then one can obtain 16 v 1 c 10 v 1 p 1 2 δ 1 with c 10 2 p 1 2 min α 1 σ 1 ℓ i 1 q 1 p σ 2 ℓ i 1 q 1 p based on lemma 1 it is obtained that v 1 t could converge into δ 1 c 10 1 p within the finite time t 1 2 1 p c 10 c 20 v 1 1 p 2 0 δ 1 c 20 1 p 1 p and the bound δ 1 could be small enough by tuning the parameters suitably for t t 1 we can learn that the bound of the time varying disturbance and the perturbation of the ship model can be estimated well since ξ ℓ i 0 and λ ℓ i 0 the auxiliary state z ℓ i is guaranteed to converge to a small neighborhood of zero in finite time by observing the form of 9 and 11 we know that the estimation of environmental disturbance d ˆ w ℓ i is included in z ℓ i thus the estimation error of the aftdo can be presented as follows 17 d w ℓ i d w ℓ i d ˆ w ℓ i m ℓ i ℓ i f ℓ i m ℓ i l i λ ˆ ℓ i φ ℓ i z ℓ i the above inequality indicate that d w ℓ i can converge to a small constant around zero in finite time since the finite time convergence of z ℓ i furthermore the result of d ˆ w ℓ i d w ℓ i can be achieved when ξ ˆ ℓ i ξ ℓ i and λ ˆ ℓ i λ ℓ i this completes the proof remark 2 actually the finite time estimation of the disturbance observer d ˆ w ℓ i for the environmental disturbance d w ℓ i is achieved via the finite time convergence of the error signals z ℓ i ξ ℓ i and λ ℓ i different from the existed disturbance observer the proposed aftdo has two main advantages 1 by introducing the fractional power the proposed aftdo is with the finite time convergence property 2 the assumption about the upper bound of the environmental disturbance which required in traditional disturbance design procedure is relaxed such features contribute to the proposed aftdo is with excellent estimation performance and easy to be implemented in practice 3 2 decentralized finite time control based on aftdo define the reference trajectory as p d t x d t y d t t ℜ 2 for the usvs formation system the desired geometric pattern of the formation is defined as δ δ i where δ i δ x i δ y i t ℜ 2 i 1 2 n step 1 at this step the objective is to stabilize the position variable of each usv to reference trajectory and maintain the desired geometric pattern in finite time for this purpose the kinematics errors are defined as follows see fig 1 18 x e i x d i δ x i x i y e i y d i δ y i y i ψ e i ψ d i ψ i according to the point to point navigation principle of underactuated vessels in li et al 2008 the traking error of the distance for the ith usv is defined as 19 z e i x e i 2 y e i 2 in view of eqs 2 and 18 taking time derivative of z e i and ψ e i we have 20 z e i cos ψ d i x d i sin ψ d i y d i v i sin ψ e i 2 sin 2 0 5 ψ e i u i ψ e i ψ d i r i for u i and r i the corresponding virtual control law can be chosen as 21 α u i k z e i z e i p γ z e i s i g j n i a i j z e i z e j p π z e i α r i k ψ e i ψ e i p ψ d i where π z e i cos ψ d i x d i sin ψ d i y d i v i sin ψ e i 2 u i sin 2 0 5 ψ e i k z e i γ z e i k ψ e i are positive constants remark 3 in the eq 18 ψ d i arctan 2 y e i x e i π π denotes the desired yaw angle relative to the reference trajectory i e the cooperative control problem of the usvs can be transformed into the stabilization of the tracking error z e i ψ e i step 2 the objective of this step is to compel the kinetics variables of each usv converge to the virtual control in finite time by incorporating the proposed aftdo define the kinetics error ℓ e i ℓ i α ℓ i ℓ u r then the following equations can be derived 22 u e i u i α u i r e i r i α r i note that α u i α r i could be obtained by introducing the appropriate differential filter s t d s 1 instead of the analytical method where t d is a time constant such approximation is common in engineering practice and relevant literature can be referred in zhang et al 2017 polycarpou et al 2003 from 2 we have 23 ℓ e i f ℓ i m ℓ i d w ℓ i m ℓ i τ ℓ i m ℓ i α ℓ i chose the formation control law as 24 τ ℓ i k ℓ i ℓ e i p k τ ℓ i ℓ e i α ℓ i λ ˆ τ ℓ i φ ℓ i ℓ e i d ˆ w ℓ i where the λ ˆ τ ℓ i ϑ ℓ i 2 is the estimation of λ τ ℓ i the mlp based adaptive law can be designed as follows 25 λ ˆ τ ℓ i γ τ ℓ i m ℓ i φ ℓ i ℓ e i 2 σ τ ℓ i λ ˆ τ ℓ i λ ˆ τ ℓ i 0 p where γ τ ℓ i σ τ ℓ i are positive constants λ ˆ τ ℓ i 0 is the initial value of λ τ ℓ i when t 0 theorem 2 consider the closed loop formation system consisting of the underactuated usvs 2 3 satisfying assumption 1 the proposed aftdo 11 the formation control law 24 and their corresponding mlp based adaptive laws 10 12 25 for any initial states z ℓ i 0 ϖ i 2 ψ e i 2 0 ℓ e i 2 0 γ ℓ i 1 λ ℓ i 2 0 δ 2 with δ 2 0 parameters k z e i k ψ e i γ z e i k u i k r i γ u i γ r i σ u i σ r i and ϖ i can be tuned approximately such that all the immediate states are semi global finite time uniformly bounded sgftub proof consider the following lyapunov function 26 v 2 1 2 i 1 n z e i ϖ i 2 1 2 i 1 n ψ e i 2 1 2 i 1 n ℓ u r ℓ e i 2 γ τ ℓ i 1 λ τ ℓ i 2 i 1 n ℓ i u i v i r i v 1 then the time derivative of v 2 can be derived as follows 27 v 2 i 1 n z e i ϖ i z e i i 1 n ψ e i ψ e i i 1 n ℓ u r ℓ e i ℓ e i γ τ ℓ i 1 λ τ ℓ i λ τ ℓ i i 1 n ℓ i u i v i r i v 1 from error dynamics 20 and virtual control law 21 the term z e i ϖ i z e i turns to be 28 z e i ϖ i z e i k z e i z e i p 1 z e i γ z e i sig j n i a i j z e i z e j p z e i u e i considering a group of usvs consist of n underactuated vessel the above equation can be re written as follows 29 z e ϖ z e z e k z e ϒ z e l p z e p z e u e z e θ z e p z e 2 u e 4 b 1 b 1 where z e z e 1 z e 2 z e n t u e u e 1 u e 2 u e n t k z e diag k z e 1 k z e 2 k z n θ k z e ϒ z e l p l is the laplacian matrix and l p ℓ i j p ℜ n n note since the communication topology of the usvs formation systems is undirected graph all the eigenvalues of l are nonnegative number then θ is a positive matrix the term ψ e i can be transformed into 30 ψ e i k ψ e i ψ e i p 1 ψ e i r e i k ψ e i ψ e i p 1 ψ e i 2 r e i 2 4 b 2 i b 2 i substitute 23 24 into ℓ e i ℓ e i the following holds 31 ℓ e i ℓ e i k ℓ i m ℓ i ℓ e i p 1 k τ ℓ i m ℓ i ℓ e i 2 ℓ e i f ℓ i m ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i m ℓ i 1 m ℓ i 1 α ℓ i ℓ e i d w ℓ i m ℓ i ℓ e i from 5 and the young s inequality we have 32 ℓ e i f ℓ i m ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i m ℓ i ϑ ℓ i 2 φ ℓ i 2 ℓ e i 2 4 b ℓ i m ℓ i b ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i 2 m ℓ i λ τ ℓ i φ τ ℓ i ℓ e i 2 m ℓ i b ℓ i according young s inequality the following holds 33 1 m ℓ i 1 ℓ e i α ℓ i 1 1 m ℓ i b 3 i α ℓ i 2 ℓ 2 4 b 3 i meanwhile we have 34 1 m ℓ i d w ℓ i ℓ e i 1 m ℓ i b 4 i d w ℓ i 2 ℓ e i 2 4 b 4 i in the view of 32 33 and 34 35 ℓ e i ℓ e i k ℓ i m ℓ i ℓ e i p 1 1 1 m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i k τ ℓ i m ℓ i ℓ e i 2 λ τ ℓ i φ ℓ i ℓ e i 2 m ℓ i b ℓ i b 3 i b 4 i 1 m ℓ i b 3 i b 4 i where b ℓ i b 3 i b 4 i are all positive tuning parameters based on lemma2 and the adaptive law 25 we have 36 γ τ ℓ i 1 λ τ ℓ i λ ˆ τ ℓ i λ τ ℓ i φ ℓ i ℓ e i 2 m ℓ i 1 q 1 p σ τ ℓ i m ℓ i λ τ ℓ i p 1 1 m ℓ i ς τ ℓ i 1 p substitute 29 30 35 36 into 27 we have 37 v 2 λ min θ z e p 1 i 1 n k ψ e i ψ e i p 1 i 1 n ℓ i u i v i r i v 1 i 1 n ℓ i u i r i k ℓ i m ℓ i ℓ e i p 1 1 q 1 p σ τ ℓ i m ℓ i λ ℓ i p 1 δ 2 i 1 n ℓ i u i r i 1 1 m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i ξ k τ ℓ i m ℓ i ℓ e i 2 where ξ z e i 2 4 b 1 i in the case that ℓ i u i otherwise ξ ψ e i 2 4 b 2 i δ 2 b 1 i b 2 i b 3 i b 4 i b ℓ i 1 m ℓ i ς τ ℓ i 1 p to achieve the most beneficial performance of the closed loop system we can chose parameters k τ ℓ i 1 1 m ℓ i m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i ξ according to lemma 3 then 38 v 2 c 11 v 2 p 1 2 δ with δ δ 1 δ 2 c 11 min λ min θ k ψ e i k ℓ i σ ℓ i and from lemma 1 v 2 could converge to the neighborhood of δ c 11 1 p within finite time t 2 2 1 p c 11 c 22 v 2 1 p 2 0 δ c 22 1 p 1 p this completes the proof remark 4 by observing the form of controller 21 24 one can learn that only the local information from the neighbors of the formation system is required when designing the control algorithm therefore the proposed algorithm is decentralized compared with the existed works li et al 2008 dong and farrell 2008 dong 2010 the proposed control scheme is with finite time convergence the fractional power is the key element to achieve the finite time stability in addition the nonzero environmental disturbance is inevitably to be encountered when ship proceeding at sea the result of bounded stability is accord with the practical engineering nn is introduced to address the model uncertainty of the formation system whose approximation ability can be ensured when the input vectors are within a compact set this is the reason for the semi global performance of the closed loop system stability 4 numerical simulations in this section two simulations are conducted to demonstrate the effectiveness of the proposed algorithm the underactuated surface vessel cybership ii skjetne et al 2004 is chosen as the usv model for the simulation the weight of ship model is 23 8 kg the length is 1 255 m and breadth is 0 29 m the dynamic parameters of the ship model are carefully illustrate in table 1 4 1 closed loop performance in the simulation 3 usvs are employed as the formation system to verify the aftdo and the proposed decentralized control algorithm under the time varying disturbance the environmental disturbance is chosen as d w u i 11 12 1 0 35 sin 0 3 t 0 15 cos 0 5 t n d w v i 26 17 76 1 0 3 sin 0 4 t 0 2 cos 0 1 t n d w r i 950 636 1 0 3 sin 0 3 t 0 1 cos 0 5 t n m define the reference trajectory as p d t 0 1 t 0 5 sin 1 π t the corresponding laplaican matrix is l 2 1 1 1 2 1 1 1 2 the geometric pattern for the usvs are δ 1 1 m 0 m δ 2 0 m 1 m δ 3 0 m 1 m the initial position of the 3 usvs are η 1 0 5 m 0 5 m 90 t η 2 0 1 5 m 1 5 m 30 t η 3 0 2 5 m 1 4 m 150 t the initial velocities are v 1 0 v 2 0 v 3 0 0 m s 0 m s 0 s t for the proposed control strategy the control parameters are chosen as table 2 the initial values of the adaptive law λ ˆ ℓ i 0 ξ ˆ ℓ i 0 λ ˆ τ ℓ i 0 are selected randomly within 1 1 the results of the numerical simulation are shown in figs 2 8 fig 2 shows the formation trajectory of the usvs under the proposed control scheme it shows that despite the existence of the model uncertainty and the environmental disturbance each of the 3 usvs could track the desired paths and maintain the triangular pattern well fig 3 shows that the usvs could form the formation in finite time and maintain the desired pattern after then according to fig 4 we can learn that the distance error z e i and attitude error ψ e i of each usv could converge to the neighborhood of the origin in finite time respectively fig 5 shows that the control inputs in surge direction and yaw direction could converge to the neighborhood of the origin in finite time fig 6 demonstrate the estimation of the adaptive parameters λ ˆ τ u i λ ˆ τ r i figs 7 and 8 show the estimation results of the proposed aftdo fig 7 illustrates the facts that the environmental disturbance can be estimated accurately in finite time from fig 8 we can learn that both the model uncertainty and the upper bound of the disturbance can be estimated well by the parameters adaptation of λ ˆ ℓ i ξ ˆ ℓ i 4 2 comparison simulation in the presence of environmental disturbance in this simulation the proposed control scheme are compared with the control scheme of li et al 2008 in the presence of the simulated ocean disturbance for single usv the initial states are selected as η 0 1 m 1 m 60 t v 0 0 m s 0 m s 0 s t the main parameters are selected as p 11 13 k z e i 3 2 k ψ e i 9 6 k τ u i 1 4 10 2 k τ r i 1 56 10 3 according to the physical mathematical model fossen 2011 the simulated ocean disturbance is constructed to model the real sea state of the environment including the sea wind and the irregular wind generated waves we set the average velocity of wind v wind 15 7 m s and wind direction ψ wind 160 i e the 6th level sea state inspired by the norsok wind spectrum and the jonswap wave spectrums the wind forces moments are generated mainly depends on the amplitude of the wave fig 9 illustrates the simulated ocean disturbance figs 10 and 11 show the results of comparison simulation fig 10 show that the tracking errors z e i ψ e i could converge to the neighborhood of the origin under both control scheme and the proposed control scheme could obtain faster convergence than the control scheme in li et al 2008 from fig 11 we learn that the proposed control scheme achieve a better steady state errors than the control scheme in li et al 2008 which contribute to less abrasion of actuators and higher energy efficiency 5 concusions in this paper an improved observer based control algorithm is proposed for multiple underactuated usvs in the presence of model uncertainty and environmental disturbance under the proposed control scheme the desired geometric pattern is achieved in finite time combine nn with mlp the aftdo is constructed without the information about the ship model and the bound of the environmental disturbance and with excellent estimation performance for environmental disturbance on the basis of the undirected graph the control scheme is developed with local information from neighboring usvs meanwhile due to the same set of nn is shared by the aftdo and the decentralized control scheme the proposed algorithm is with the merits of concise form and easy to be implemented in practical engineering this contributes to smaller computation load is achieved when the algorithm is applied in practical engineering finally the sgftub stability is proved by the lyapunov theory acknowledgement this work is partially supported by the national natural science foundation of china no 51679024 51779029 natural science foundation of liaoning province 20180520039 the fundamental research funds for the central university no 3132018301 no 3132018304 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the program for innovative research team in university irt17r13 the doctoral scientific research foundation of liaoning province grant no 20170520189 the national postdoctoral program for innovative talents no bx201600103 and the china postdoctoral science foundation no 2016m601600 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article appendix a some useful lemmas lemma 1 sanjay and dennis 2000 zhang et al 2017 for the system x f x f 0 0 where x ℜ n is the state vector and f u ℜ n is a continuous function on the open set u ℜ n suppose there existed a positive define continuous function v x u ℜ satisfies v x c 1 v p x δ with c 1 0 p 0 1 and small value δ then the original is with finite time uniformly bounded ftb stable equilibrium of the corresponding system and the settling time t satisfies the following equation with 0 c 1 c 2 a1 t 1 c 1 c 2 1 1 p v 1 p x 0 1 1 p δ c 2 1 p p lemma 2 zhang et al 2017 for x ℜ and 0 p 1 q 0 1 a is a constant then the following inequality holds a2 x x a p 1 q 1 p x 1 p ς 1 p lemma 3 zhu et al 2011 xiao et al 2009 for any real number x k k 1 2 n and 0 c 1 then the following inequality holds a4 x 1 x 2 x n c x 1 c x 2 c x n c a5 k 1 3 x k 1 c k 1 3 x k 2 1 c 2 
22973,this note investigates the decentralized finite time formation control of underactuated unmanned surface vessels usvs in the presence of model uncertainty and environmental disturbance in the algorithm a novel adaptive finite time disturbance observer aftdo is incorporated into the proposed control strategy that enhances its robustness to the environmental disturbance by fusion of neural network nn and minimal learning parameterization mlp techniques the aftdo is constructed without priori information about the ship model and the upper bound of disturbance on the basis of undirected graph the decentralized control law is developed with local information from neighboring usvs specially since the aftdo and the decentralized control law share the same set of nn the whole algorithm is with merits of concise form and less adaptive parameters such design contributes to smaller computation load and facilitates the implementation of the algorithm in ocean engineering the semi global finite time uniformly boundedness sgftub of the closed loop system is proved by the lyapunov theory numerical simulations and comprehensive comparisons are conducted to demonstrate the remarkable performance and superiority of the proposed algorithm keywords underactuated ships undirected graph finite time control formation control disturbance observer 1 introduction as one of the most popular topics in marine cybernetics formation control of multiple underactuated ships has emerged as an exceptionally promising research issue in recent years it can promote the development of advanced marine equipments both in civil and military industries successful application can be found in diverse areas such as multi ships cooperative combat ship underway replenishment marine environment monitoring maritime search and rescue thus it is of practical significance to achieve more efficient reasonable results of formation control for usvs depending on the different theories there are four main approaches proposed to achieve formation control oh et al 2015 virtual structure control ren 2004 beard and lawton 2001 ren and beard 2003 leader follower control jian and chen et al 2010 peng et al 2013 das et al 2002 behavior based control balch t 1998 lawton et al 2003 and topology based control ren 2007 ren and sorensen 2008 the objective of formation control for multiple ships is to drive a group of usvs converge to a predetermined geometric pattern with desired heading angle due to the underactuated constraint for each ship model and restriction of communication among multiple ships it is difficult to design a decentralized formation control algorithm for usvs therefore related researches have been investigated by various of analytic tools in existed literature arrichiello and chiaverini 2006 aguiar et al 2006 dong and farrell 2008 for example an improved cooperative control strategy for underactuated marine vehicles is developed based on fixed topology in dong 2010 meanwhile the result is extended to the switch topology and communication delay cases consider the model uncertainty and marine disturbance a decentralized synchronization control law is proposed by fusion of parametric projection algorithm and dynamic surface control dsc technique the cooperative path following of multiple underactuated surface vessels is realized in hao et al 2013 2014 using the local information from neighbors the problem of formation control with consideration of communication delay for underactuated vessels is addressed in dong and farrell 2008 to enhance the robustness and reduce the chattering of the control system an adaptive proportion integral sliding mode control apismc algorithm is designed to achieve the leader follower formation control of underactuated vessels both the plant uncertainty and unknown disturbance are compensated by the parameter estimation technique sun et al 2017 in li et al 2018 a novel formation control scheme is presented for underactuated surface ships based on nonsingular terminal sliding mode control ntsmc approach although the singular problem is avoided and the result of finite time convergence is obtained the model uncertainty and environmental disturbance are not considered on the other hand the ship formation is inevitably suffered from the environmental disturbance induced by wind wave and current when proceeding at sea the aforementioned papers hao et al 2013 2014 aguiar et al 2006 dong and farrell 2008 all adopted the parameter adaptive strategy to solve the model uncertainty and external disturbance but the reconstruction of the uncertainty information is not achieved disturbance observer is a useful tool to reconstruct the external uncertainty and has been successfully applied in ship motion control zhiquan 2017 liu et al 2011 gao et al 2017 yao et al 2018 the disturbance observer is used in hu et al 2015 but only the result of asymptotic convergence is obtained in zhi 2017 an observer based control algorithm is presented to achieve the course keeping control for marine surface vessel via the estimation of yaw acceleration in wang et al 2017 the unknown external disturbance is observed exactly by the ftdo and thereby facilitates the implementation of the surge and yaw control scheme in order to increase the system s robustness a nonlinear disturbance observer is introduced to estimate the external disturbance in zheng and feroskhan 2018 however the construction of the disturbance observer in these schemes are under the premise of the assumption which the precise information about the ship model and the upper bound of the external disturbance are known such conditions are difficult to achieve in the practical engineering to address the aforementioned problem this paper proposed an observer based control algorithm for multiple underactuated vessels in the presence of model uncertainty and environmental disturbance the main contributions of this paper can be summarized as follows 1 a novel aftdo is designed by fusion of nn and mlp techniques different from the existed literature the proposed aftdo is with merits of concise form and easy construction the rigorous restriction on the prior knowledge about the ship model and the upper bound of the disturbance are removed by parameter adaptation meanwhile the result of finite time convergence of error signals for the closed loop system is obtained 2 an improved finite time decentralized formation control law is presented based on the designed aftdo on the basis of the undirected graph the control algorithm is derived with local information from neighboring usvs since the same set of nn is shared by the aftdo and the proposed control algorithm the computation load is dramatically reduced which facilitate the implementation of the algorithm in ocean engineering 2 problem formulation and preliminaries 2 1 algebraic and graph theory consider the cooperative system which contains n identical usvs the communication topology among the usvs can be described by the undirected graph g g ν ε where ν 1 2 n denotes a finite set with n nodes ε ν ν is a finite set with elements e i j called edge if e i j ε it means there existed the communication from node i to j for a undirected graph e i j ε e j i ε the adjacency matrix a a i j ℜ n n is a square matrix with elements a i j 1 if e i j ε and a i j 0 otherwise d d i j ℜ n n is the degree matrix of graph g and d is a diagonal matrix with elements d i j 1 equals to the number of adjacent nodes of node i l is the laplacian matrix of graph g and can be obtained by l d a 2 2 neural networks in the sequel the radial basis neural network rbfnn is employed as the universal approximator to estimate the unknown part of the ship model yan sheng and xiao feng 2007 the detail expression of nn is defined as s x a x where a ℜ l n is an optimal matrix with l nodes s x s 1 x s 2 x s l x is a rbf vector with the form of gaussian function s j x 1 2 π exp x μ j t x μ j 2 ς j 2 based on the result in zhang and zhang 2014 for any given continuous function f x with f 0 0 defined in the compact set ω x such that the nonlinear function f x can be modeled as 1 f x s x a x ε x ω x where ε x represents the approximation error of nns with unknown upper bound ε 0 2 3 underactuated model of usvs consider n identical underactuated usvs in the horizontal plane their dynamics are referred to zhang et al 2015 li et al 2008 we defined the η i x i y i ψ i t as the position variable and v i u i v i r i t as the velocity variable of vessel ith the kinematic model of the ith usv can be described as 2 x i u i cos ψ i v i sin ψ i y i u i sin ψ i v i cos ψ i ψ i r i where x i y i denotes the position and ψ i denotes the yaw angle of vessel i in the earth fixed frame u i v i r i denote the velocities in surge sway and yaw degree of freedom dof in body fixed frame the dynamics of the ith vessel is formulated as follows 3 u i f u i m u i d w u i m u i τ u i m u i v i f v i m v i d w v i m v i r i f r i m r i d w r i m r i τ r i m r i where f u i c 13 i r i d 11 i u i g u i f v i c 23 i r i d 22 i v i d 23 i r i f r i c 31 i u i c 32 i v i d 32 i r i are nonlinear functions d w u i d w v i d w r i are the forces and moments included by external disturbance c 13 i c 23 i c 31 i c 32 i are centripetal and coriolis coefficients d 11 i d 22 i d 32 i d 33 i are hydrodynamic damping coefficients g u i g v i g r i are unmodeled dynamics and τ u i τ r i are the control inputs respectively are surge force and yaw moment assumption 1 assume that the sway velocity v i is passive bounded for each usv remark 1 since the ship motion in sway direction is dominated by the hydrodynamics damping force and is damped out by this force the sway dynamics is passive boundedness this assumption is consistent with the marine practice and has been detailly analyzed in do et al 2004 by considering different cases 3 decentralized finite time control law design 3 1 construction of the aftdo in this part in order to enhance the robustness of the formation system against the environmental disturbance a novel aftdo is constructed without the information about the ship model and the upper bound of disturbance rigorous analysis is stated to prove the finite time convergence of the aftdo it is known that the nn is an effective tool to approximate the nonlinear functions due to its simplicity and power capacity it is a good candidate to approximate the model uncertainty of usvs in 3 f ℓ i ℓ u v r are unknown smooth functions and they can be approximated by nn as 4 f ℓ i θ ℓ i t s ℓ i ν i ε ℓ i where v i u i v i r i t denotes the input vector θ ℓ i ℜ l denotes the weight vector s l i v i ℜ l is the radial basis function vector l is the number of neurons ε ℓ i is the approximation error 5 f ℓ i θ ℓ i t s ℓ i ν i ε ℓ i ϑ ℓ i φ ℓ i where ϑ ℓ i φ ℓ i are defined as 6 ϑ ℓ i max ϑ ℓ i ε ℓ i φ ℓ i 1 s ℓ i v i then the dynamic model 3 for the ith usv can be formulated as follows 7 m ℓ i ℓ i f ℓ i τ ℓ i d w ℓ i note that d w ℓ i is bounded and d w ℓ i ξ ℓ i ξ ℓ i is the unknown bound of the environmental disturbance induced by the wind wave and current to design the aftdo the following auxiliary state is introduced 8 z ℓ i m ℓ i ℓ i m ℓ i ℓ ˆ i in 8 ℓ ˆ i is given by 9 m ℓ i l i λ ˆ ℓ i φ ℓ i τ ℓ i ξ ˆ ℓ i z ℓ i z ℓ i α 1 sig z ℓ i p α 2 z ℓ i where p is fractional power with 0 p 1 α 1 α 2 are positive constants ξ ˆ ℓ i is the estimation value ξ ℓ i λ ℓ i ϑ ℓ i 2 φ ℓ i φ ℓ i 2 4 b ℓ i 0 b ℓ i is a positive constant sig z ℓ i p sign z ℓ i z ℓ i p 10 ξ l i γ ℓ i z ℓ i σ 1 ℓ i ξ ˆ ℓ i ξ ˆ ℓ i 0 p where γ ℓ i and σ 1 ℓ i are positive constants ξ ˆ ℓ i 0 is the initial value of ξ ˆ ℓ i when t 0 the estimation for d w ℓ i is given by 11 d ˆ w ℓ i α 1 sig z ℓ i p α 2 z ℓ i ξ ˆ ℓ i z ℓ i z ℓ i the mlp based adaptive law for the model uncertainty is as follows 12 λ ˆ ℓ i λ ℓ i z ℓ i φ ℓ i σ 2 ℓ i λ ˆ ℓ i λ ˆ ℓ i 0 p where λ ℓ i σ 2 ℓ i are positive constants λ ˆ ℓ i is the estimation value of λ ℓ i λ ˆ ℓ i 0 is the initial value of λ ˆ ℓ i when t 0 theorem 1 consider the nonlinear system of ship dynamics 7 and the aftdo 11 with adaptive laws 10 12 the initial condition satisfied that z ℓ i 2 0 ξ ˆ ℓ i 2 0 λ ˆ ℓ i 2 0 ρ 1 with any ρ 1 0 then one can tune the parameters α 1 α 2 p γ ℓ i σ 1 ℓ i λ ℓ i and σ 2 ℓ i approximately such that the estimation error d w ℓ i will converge to the neighborhood of zero in finite time proof consider the lyapunov function candidate for the ith usv as follows 13 v 1 1 2 z ℓ i 2 1 2 γ ℓ i ξ ℓ i 2 1 2 λ ℓ i λ ℓ i 2 the time derivative of v 1 is given by 14 v 1 z ℓ i m ℓ i ℓ i m ℓ i l i γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i z ℓ i f ℓ i λ ˆ ℓ i φ ℓ i z ℓ i d w ℓ i z ℓ i ξ ˆ ℓ i z ℓ i z ℓ i α 2 z ℓ i 2 α 1 s i g z ℓ i p 1 γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i α 1 s i g z ℓ i p 1 z ℓ i λ ℓ i φ ℓ i λ ˆ ℓ i φ ℓ i 1 4 b z ℓ i α 2 z ℓ i 2 b z ℓ i b ℓ i 2 d w ℓ i z ℓ i ξ ˆ ℓ i z ℓ i γ ℓ i 1 ξ ℓ i ξ l i λ ℓ i 1 λ ℓ i λ l i according to 10 12 lemma2 and lemma3 the following inequality can be derived 15 v 1 α 1 sig z ℓ i p 1 1 q 1 p σ 1 ℓ i ξ ℓ i p 1 σ 2 ℓ i λ ℓ i p 1 δ 1 α 1 2 p 1 2 1 2 z ℓ i 2 p 1 2 σ 1 ℓ i 1 q 1 p 2 p 1 2 1 2 ξ ℓ i 2 p 1 2 σ 2 ℓ i 1 q 1 p 2 p 1 2 1 2 λ ℓ i 2 p 1 2 δ 1 where δ 1 ς 1 ς 2 1 p b z ℓ i b ℓ i 2 can be achieved by selecting the parameter b z ℓ i to make 1 4 b z ℓ i α 2 0 the exact values of ς 1 ς 2 can be obtained according to lemma 2 then one can obtain 16 v 1 c 10 v 1 p 1 2 δ 1 with c 10 2 p 1 2 min α 1 σ 1 ℓ i 1 q 1 p σ 2 ℓ i 1 q 1 p based on lemma 1 it is obtained that v 1 t could converge into δ 1 c 10 1 p within the finite time t 1 2 1 p c 10 c 20 v 1 1 p 2 0 δ 1 c 20 1 p 1 p and the bound δ 1 could be small enough by tuning the parameters suitably for t t 1 we can learn that the bound of the time varying disturbance and the perturbation of the ship model can be estimated well since ξ ℓ i 0 and λ ℓ i 0 the auxiliary state z ℓ i is guaranteed to converge to a small neighborhood of zero in finite time by observing the form of 9 and 11 we know that the estimation of environmental disturbance d ˆ w ℓ i is included in z ℓ i thus the estimation error of the aftdo can be presented as follows 17 d w ℓ i d w ℓ i d ˆ w ℓ i m ℓ i ℓ i f ℓ i m ℓ i l i λ ˆ ℓ i φ ℓ i z ℓ i the above inequality indicate that d w ℓ i can converge to a small constant around zero in finite time since the finite time convergence of z ℓ i furthermore the result of d ˆ w ℓ i d w ℓ i can be achieved when ξ ˆ ℓ i ξ ℓ i and λ ˆ ℓ i λ ℓ i this completes the proof remark 2 actually the finite time estimation of the disturbance observer d ˆ w ℓ i for the environmental disturbance d w ℓ i is achieved via the finite time convergence of the error signals z ℓ i ξ ℓ i and λ ℓ i different from the existed disturbance observer the proposed aftdo has two main advantages 1 by introducing the fractional power the proposed aftdo is with the finite time convergence property 2 the assumption about the upper bound of the environmental disturbance which required in traditional disturbance design procedure is relaxed such features contribute to the proposed aftdo is with excellent estimation performance and easy to be implemented in practice 3 2 decentralized finite time control based on aftdo define the reference trajectory as p d t x d t y d t t ℜ 2 for the usvs formation system the desired geometric pattern of the formation is defined as δ δ i where δ i δ x i δ y i t ℜ 2 i 1 2 n step 1 at this step the objective is to stabilize the position variable of each usv to reference trajectory and maintain the desired geometric pattern in finite time for this purpose the kinematics errors are defined as follows see fig 1 18 x e i x d i δ x i x i y e i y d i δ y i y i ψ e i ψ d i ψ i according to the point to point navigation principle of underactuated vessels in li et al 2008 the traking error of the distance for the ith usv is defined as 19 z e i x e i 2 y e i 2 in view of eqs 2 and 18 taking time derivative of z e i and ψ e i we have 20 z e i cos ψ d i x d i sin ψ d i y d i v i sin ψ e i 2 sin 2 0 5 ψ e i u i ψ e i ψ d i r i for u i and r i the corresponding virtual control law can be chosen as 21 α u i k z e i z e i p γ z e i s i g j n i a i j z e i z e j p π z e i α r i k ψ e i ψ e i p ψ d i where π z e i cos ψ d i x d i sin ψ d i y d i v i sin ψ e i 2 u i sin 2 0 5 ψ e i k z e i γ z e i k ψ e i are positive constants remark 3 in the eq 18 ψ d i arctan 2 y e i x e i π π denotes the desired yaw angle relative to the reference trajectory i e the cooperative control problem of the usvs can be transformed into the stabilization of the tracking error z e i ψ e i step 2 the objective of this step is to compel the kinetics variables of each usv converge to the virtual control in finite time by incorporating the proposed aftdo define the kinetics error ℓ e i ℓ i α ℓ i ℓ u r then the following equations can be derived 22 u e i u i α u i r e i r i α r i note that α u i α r i could be obtained by introducing the appropriate differential filter s t d s 1 instead of the analytical method where t d is a time constant such approximation is common in engineering practice and relevant literature can be referred in zhang et al 2017 polycarpou et al 2003 from 2 we have 23 ℓ e i f ℓ i m ℓ i d w ℓ i m ℓ i τ ℓ i m ℓ i α ℓ i chose the formation control law as 24 τ ℓ i k ℓ i ℓ e i p k τ ℓ i ℓ e i α ℓ i λ ˆ τ ℓ i φ ℓ i ℓ e i d ˆ w ℓ i where the λ ˆ τ ℓ i ϑ ℓ i 2 is the estimation of λ τ ℓ i the mlp based adaptive law can be designed as follows 25 λ ˆ τ ℓ i γ τ ℓ i m ℓ i φ ℓ i ℓ e i 2 σ τ ℓ i λ ˆ τ ℓ i λ ˆ τ ℓ i 0 p where γ τ ℓ i σ τ ℓ i are positive constants λ ˆ τ ℓ i 0 is the initial value of λ τ ℓ i when t 0 theorem 2 consider the closed loop formation system consisting of the underactuated usvs 2 3 satisfying assumption 1 the proposed aftdo 11 the formation control law 24 and their corresponding mlp based adaptive laws 10 12 25 for any initial states z ℓ i 0 ϖ i 2 ψ e i 2 0 ℓ e i 2 0 γ ℓ i 1 λ ℓ i 2 0 δ 2 with δ 2 0 parameters k z e i k ψ e i γ z e i k u i k r i γ u i γ r i σ u i σ r i and ϖ i can be tuned approximately such that all the immediate states are semi global finite time uniformly bounded sgftub proof consider the following lyapunov function 26 v 2 1 2 i 1 n z e i ϖ i 2 1 2 i 1 n ψ e i 2 1 2 i 1 n ℓ u r ℓ e i 2 γ τ ℓ i 1 λ τ ℓ i 2 i 1 n ℓ i u i v i r i v 1 then the time derivative of v 2 can be derived as follows 27 v 2 i 1 n z e i ϖ i z e i i 1 n ψ e i ψ e i i 1 n ℓ u r ℓ e i ℓ e i γ τ ℓ i 1 λ τ ℓ i λ τ ℓ i i 1 n ℓ i u i v i r i v 1 from error dynamics 20 and virtual control law 21 the term z e i ϖ i z e i turns to be 28 z e i ϖ i z e i k z e i z e i p 1 z e i γ z e i sig j n i a i j z e i z e j p z e i u e i considering a group of usvs consist of n underactuated vessel the above equation can be re written as follows 29 z e ϖ z e z e k z e ϒ z e l p z e p z e u e z e θ z e p z e 2 u e 4 b 1 b 1 where z e z e 1 z e 2 z e n t u e u e 1 u e 2 u e n t k z e diag k z e 1 k z e 2 k z n θ k z e ϒ z e l p l is the laplacian matrix and l p ℓ i j p ℜ n n note since the communication topology of the usvs formation systems is undirected graph all the eigenvalues of l are nonnegative number then θ is a positive matrix the term ψ e i can be transformed into 30 ψ e i k ψ e i ψ e i p 1 ψ e i r e i k ψ e i ψ e i p 1 ψ e i 2 r e i 2 4 b 2 i b 2 i substitute 23 24 into ℓ e i ℓ e i the following holds 31 ℓ e i ℓ e i k ℓ i m ℓ i ℓ e i p 1 k τ ℓ i m ℓ i ℓ e i 2 ℓ e i f ℓ i m ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i m ℓ i 1 m ℓ i 1 α ℓ i ℓ e i d w ℓ i m ℓ i ℓ e i from 5 and the young s inequality we have 32 ℓ e i f ℓ i m ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i m ℓ i ϑ ℓ i 2 φ ℓ i 2 ℓ e i 2 4 b ℓ i m ℓ i b ℓ i λ ˆ τ ℓ i φ τ ℓ i ℓ e i 2 m ℓ i λ τ ℓ i φ τ ℓ i ℓ e i 2 m ℓ i b ℓ i according young s inequality the following holds 33 1 m ℓ i 1 ℓ e i α ℓ i 1 1 m ℓ i b 3 i α ℓ i 2 ℓ 2 4 b 3 i meanwhile we have 34 1 m ℓ i d w ℓ i ℓ e i 1 m ℓ i b 4 i d w ℓ i 2 ℓ e i 2 4 b 4 i in the view of 32 33 and 34 35 ℓ e i ℓ e i k ℓ i m ℓ i ℓ e i p 1 1 1 m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i k τ ℓ i m ℓ i ℓ e i 2 λ τ ℓ i φ ℓ i ℓ e i 2 m ℓ i b ℓ i b 3 i b 4 i 1 m ℓ i b 3 i b 4 i where b ℓ i b 3 i b 4 i are all positive tuning parameters based on lemma2 and the adaptive law 25 we have 36 γ τ ℓ i 1 λ τ ℓ i λ ˆ τ ℓ i λ τ ℓ i φ ℓ i ℓ e i 2 m ℓ i 1 q 1 p σ τ ℓ i m ℓ i λ τ ℓ i p 1 1 m ℓ i ς τ ℓ i 1 p substitute 29 30 35 36 into 27 we have 37 v 2 λ min θ z e p 1 i 1 n k ψ e i ψ e i p 1 i 1 n ℓ i u i v i r i v 1 i 1 n ℓ i u i r i k ℓ i m ℓ i ℓ e i p 1 1 q 1 p σ τ ℓ i m ℓ i λ ℓ i p 1 δ 2 i 1 n ℓ i u i r i 1 1 m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i ξ k τ ℓ i m ℓ i ℓ e i 2 where ξ z e i 2 4 b 1 i in the case that ℓ i u i otherwise ξ ψ e i 2 4 b 2 i δ 2 b 1 i b 2 i b 3 i b 4 i b ℓ i 1 m ℓ i ς τ ℓ i 1 p to achieve the most beneficial performance of the closed loop system we can chose parameters k τ ℓ i 1 1 m ℓ i m ℓ i α ℓ i 2 4 b 3 i d w ℓ i 2 4 b 4 i m ℓ i ξ according to lemma 3 then 38 v 2 c 11 v 2 p 1 2 δ with δ δ 1 δ 2 c 11 min λ min θ k ψ e i k ℓ i σ ℓ i and from lemma 1 v 2 could converge to the neighborhood of δ c 11 1 p within finite time t 2 2 1 p c 11 c 22 v 2 1 p 2 0 δ c 22 1 p 1 p this completes the proof remark 4 by observing the form of controller 21 24 one can learn that only the local information from the neighbors of the formation system is required when designing the control algorithm therefore the proposed algorithm is decentralized compared with the existed works li et al 2008 dong and farrell 2008 dong 2010 the proposed control scheme is with finite time convergence the fractional power is the key element to achieve the finite time stability in addition the nonzero environmental disturbance is inevitably to be encountered when ship proceeding at sea the result of bounded stability is accord with the practical engineering nn is introduced to address the model uncertainty of the formation system whose approximation ability can be ensured when the input vectors are within a compact set this is the reason for the semi global performance of the closed loop system stability 4 numerical simulations in this section two simulations are conducted to demonstrate the effectiveness of the proposed algorithm the underactuated surface vessel cybership ii skjetne et al 2004 is chosen as the usv model for the simulation the weight of ship model is 23 8 kg the length is 1 255 m and breadth is 0 29 m the dynamic parameters of the ship model are carefully illustrate in table 1 4 1 closed loop performance in the simulation 3 usvs are employed as the formation system to verify the aftdo and the proposed decentralized control algorithm under the time varying disturbance the environmental disturbance is chosen as d w u i 11 12 1 0 35 sin 0 3 t 0 15 cos 0 5 t n d w v i 26 17 76 1 0 3 sin 0 4 t 0 2 cos 0 1 t n d w r i 950 636 1 0 3 sin 0 3 t 0 1 cos 0 5 t n m define the reference trajectory as p d t 0 1 t 0 5 sin 1 π t the corresponding laplaican matrix is l 2 1 1 1 2 1 1 1 2 the geometric pattern for the usvs are δ 1 1 m 0 m δ 2 0 m 1 m δ 3 0 m 1 m the initial position of the 3 usvs are η 1 0 5 m 0 5 m 90 t η 2 0 1 5 m 1 5 m 30 t η 3 0 2 5 m 1 4 m 150 t the initial velocities are v 1 0 v 2 0 v 3 0 0 m s 0 m s 0 s t for the proposed control strategy the control parameters are chosen as table 2 the initial values of the adaptive law λ ˆ ℓ i 0 ξ ˆ ℓ i 0 λ ˆ τ ℓ i 0 are selected randomly within 1 1 the results of the numerical simulation are shown in figs 2 8 fig 2 shows the formation trajectory of the usvs under the proposed control scheme it shows that despite the existence of the model uncertainty and the environmental disturbance each of the 3 usvs could track the desired paths and maintain the triangular pattern well fig 3 shows that the usvs could form the formation in finite time and maintain the desired pattern after then according to fig 4 we can learn that the distance error z e i and attitude error ψ e i of each usv could converge to the neighborhood of the origin in finite time respectively fig 5 shows that the control inputs in surge direction and yaw direction could converge to the neighborhood of the origin in finite time fig 6 demonstrate the estimation of the adaptive parameters λ ˆ τ u i λ ˆ τ r i figs 7 and 8 show the estimation results of the proposed aftdo fig 7 illustrates the facts that the environmental disturbance can be estimated accurately in finite time from fig 8 we can learn that both the model uncertainty and the upper bound of the disturbance can be estimated well by the parameters adaptation of λ ˆ ℓ i ξ ˆ ℓ i 4 2 comparison simulation in the presence of environmental disturbance in this simulation the proposed control scheme are compared with the control scheme of li et al 2008 in the presence of the simulated ocean disturbance for single usv the initial states are selected as η 0 1 m 1 m 60 t v 0 0 m s 0 m s 0 s t the main parameters are selected as p 11 13 k z e i 3 2 k ψ e i 9 6 k τ u i 1 4 10 2 k τ r i 1 56 10 3 according to the physical mathematical model fossen 2011 the simulated ocean disturbance is constructed to model the real sea state of the environment including the sea wind and the irregular wind generated waves we set the average velocity of wind v wind 15 7 m s and wind direction ψ wind 160 i e the 6th level sea state inspired by the norsok wind spectrum and the jonswap wave spectrums the wind forces moments are generated mainly depends on the amplitude of the wave fig 9 illustrates the simulated ocean disturbance figs 10 and 11 show the results of comparison simulation fig 10 show that the tracking errors z e i ψ e i could converge to the neighborhood of the origin under both control scheme and the proposed control scheme could obtain faster convergence than the control scheme in li et al 2008 from fig 11 we learn that the proposed control scheme achieve a better steady state errors than the control scheme in li et al 2008 which contribute to less abrasion of actuators and higher energy efficiency 5 concusions in this paper an improved observer based control algorithm is proposed for multiple underactuated usvs in the presence of model uncertainty and environmental disturbance under the proposed control scheme the desired geometric pattern is achieved in finite time combine nn with mlp the aftdo is constructed without the information about the ship model and the bound of the environmental disturbance and with excellent estimation performance for environmental disturbance on the basis of the undirected graph the control scheme is developed with local information from neighboring usvs meanwhile due to the same set of nn is shared by the aftdo and the decentralized control scheme the proposed algorithm is with the merits of concise form and easy to be implemented in practical engineering this contributes to smaller computation load is achieved when the algorithm is applied in practical engineering finally the sgftub stability is proved by the lyapunov theory acknowledgement this work is partially supported by the national natural science foundation of china no 51679024 51779029 natural science foundation of liaoning province 20180520039 the fundamental research funds for the central university no 3132018301 no 3132018304 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the program for innovative research team in university irt17r13 the doctoral scientific research foundation of liaoning province grant no 20170520189 the national postdoctoral program for innovative talents no bx201600103 and the china postdoctoral science foundation no 2016m601600 the authors wold like to thank anonymous reviewers for their valuable comments to improve the quality of this article appendix a some useful lemmas lemma 1 sanjay and dennis 2000 zhang et al 2017 for the system x f x f 0 0 where x ℜ n is the state vector and f u ℜ n is a continuous function on the open set u ℜ n suppose there existed a positive define continuous function v x u ℜ satisfies v x c 1 v p x δ with c 1 0 p 0 1 and small value δ then the original is with finite time uniformly bounded ftb stable equilibrium of the corresponding system and the settling time t satisfies the following equation with 0 c 1 c 2 a1 t 1 c 1 c 2 1 1 p v 1 p x 0 1 1 p δ c 2 1 p p lemma 2 zhang et al 2017 for x ℜ and 0 p 1 q 0 1 a is a constant then the following inequality holds a2 x x a p 1 q 1 p x 1 p ς 1 p lemma 3 zhu et al 2011 xiao et al 2009 for any real number x k k 1 2 n and 0 c 1 then the following inequality holds a4 x 1 x 2 x n c x 1 c x 2 c x n c a5 k 1 3 x k 1 c k 1 3 x k 2 1 c 2 
22974,logistics support to offshore operations is challenging especially under severe environmental conditions such as those in the arctic and sub arctic the dominant environmental conditions including waves wind poor visibility and the presence of icebergs and sea ice determine the mode and success of logistics support use of helicopters as a mode of logistics transport becomes ineffective when the distance is longer the visibility is low or the weather is stormy marine logistics support is more reliable and versatile the present work focuses on developing a model for assessing risk associated with marine logistics operations in remote offshore locations beyond helicopter reach frequented with harsh environmental conditions high winds waves and icy conditions the key factors that affect such operations are identified and failure models are developed using fault trees as an improvement advance fault trees are adopted to relax the inherent limitations of the primary model uncertainties in both data and model are considered using the fuzzy inference system and evidence theory application of the proposed model is demonstrated through a case study concerning a remote north atlantic offshore operation the contribution of this study is the identification of the key factors controlling the marine logistics operation and the development of a robust risk model that helps to analyze criticality of the contributing factors the proposed model has the potential to help to develop innovative risk management strategies to support offshore operations keywords logistics risk offshore safety fault tree analysis fuzzy set theory evidence theory 1 introduction operations in harsh environmental conditions are challenging and pose significant risks to people and infrastructures as well as to the environment the arctic and sub arctic regions are considered to have the harshest environmental conditions in the world due to the presence of ice extreme cold high winds and unpredictable weather changes despite the challenging conditions these regions contain proven reserves of hydrocarbons and mineral resources leading to increased interest of the oil and gas and the mining industries tellier 2008 the exploration and development of natural resources in these regions present significant safety and integrity challenges which are identified as the lack of detail in construction and operation standards restricted operating conditions due to extreme weather including different ice features such as pack ice and icebergs remoteness human factors and knowledge and data scarcity khan et al 2014 the stakeholders need an improved understanding of operational challenges to ensure safe operations in such conditions a recent drilling project conducted by statoil canada ltd statoil in the flemish pass basin is an example of distant offshore exploration in the harsh arctic environment the basin is located approximately 480 km east of st john s newfoundland and labrador fig 1 this is the furthest offshore that statoil has developed a project which adds to the cost and logistics challenges project description summary statoil canada ltd 2016 additional fuel requirements to cover the long distance from shore means less cargo capacity for vessels and helicopters the long trip distance poor visibility due to the prevalent occurrence of marine fog particularly in summer and spring and recurrent storms negatively affect the safety and effectiveness of using helicopters for logistics operations jan erik 2014 therefore marine vessels become the only mode of transport in such conditions however the presence of icebergs march to july and sea ice winter and spring may hamper timely vessel transit in addition strong winds snow and freezing rain raise difficulties for on board vessel operations a formal risk assessment of marine logistics operations is required to consider these additional threats so that vessels can perform routine supply as well as successful emergency response the objective of this work is to develop a methodology for assessing risk and to identify critical factors associated with marine logistics operations in remote and ice covered regions the innovations in this work stem from i adapting an advance fault tree to overcome the assumption of independence of faults ii considering a fuzzy inference system to incorporate data uncertainty vagueness and subjectivity and iii considering evidence theory to integrate data from multiple sources and incomplete data the proposed unique model will help to analyze risk factors for marine logistics operations in quantitative terms this will also help in developing effective and efficient risk management strategies the rest of this paper is organized as follows section 2 broadly describes the methodology for risk analysis of marine logistics operations and an illustrated example is presented in section 3 section 4 discusses results and conclusions are provided in section 5 2 methodology to develop logistics risk model the aim of this work is to develop a basis for assessing risk for logistics operations in harsh environments and to provide guidelines for safety measures to overcome associated challenges the framework for this study is illustrated in fig 2 the possible factors that may affect the successful operation at each stage of a logistics operation are identified a fault tree based risk model is developed this model is revised considering interdependence of parameters the risk model is subsequently integrated with fuzzy and evidence theory to overcome the uncertainties of failure probability data these steps are elaborated in the following sections 2 1 logical modelling of marine logistics support 2 1 1 identification of main contributing factors logistics operations are conducted to transport personnel and to provide routine supplies as well as emergency support to recover from hazardous incidents the sequence of activities involved in the process of an emergency logistics operation is presented in fig 3 this process consists of the following phases departure readiness of a supply vessel when an incident has been reported an uninterrupted voyage functionality of on board equipment arrival at the site within the desired time limit and on site operation a successful logistics operation will not be possible if any of these phases fails the risk factors that are involved in each phase of an operation are discussed in the following paragraphs 2 1 1 1 failure delay due to departure readiness the ship cannot depart for er or logistics support if there is insufficient crew a shortage of fuel for the distance lack of safety equipment or engine problems working in cold weather can endanger the crew unless proper preparations are made to equip the vessel and the crew for operating in the cold dark and icy conditions failure due to improper voyage plans has been addressed in detail by kum and sahin 2015 the vessel should be equipped with the following safety features for safe operation lifesaving appliances lifeboats should be enclosed and specially designed to operate in cold weather and turbulent water launching equipment should be designed to avoid the effects of freezing ice immersion suits are necessary for crew survival the reliability information about lifesaving appliances is obtained from bercha et al 2003 firefighting equipment significant risks are associated with the use of firefighting equipment in extremely low temperatures the most significant being the potential freezing of fluids in lines specific risks include freezing of firefighting equipment such as water hoses piping and nozzles portable fire extinguisher storage may be obstructed or frozen fire dampers may freeze in the stowage position navigation equipment navigational equipment of a ship includes steering hydraulic and propulsion systems faulty equipment may result in departure failure antao et al 2006 a modern marine engine has a very complex structure that consists of many mechanical components as well as a fuel system lubricating system cooling system auxiliary system and a control and safety system the reliability features of a vessel engine were described in detail by laskowski 2015 and khorasani 2015 2 1 1 2 unobstructed voyage the main factors that can disrupt the transit of a vessel are environmental factors wind waves and ice loss of hull integrity and operational navigational or communication failure environmental factors the northern regions have extreme climatic conditions that include prolonged winters with sub zero temperatures the presence of different forms of ice features and high wind and waves any precipitation in low temperatures results in snow freezing rain or ice pellets that can reduce visibility and cause the accretion of ice on ships ice movement due to high wind and currents and presence of icebergs can impose the risk of ship besetting incidents the reported ice conditions on ice charts or satellite imagery can change frequently particularly the positions of the ice edge and the location of leads through the pack ice abs 2010 loss of hull integrity ship hull integrity failure may lead to an unsuccessful operation this failure can occur due to causes such as collision with an iceberg human error or operational failure navigational and operational failure navigational failure may occur for many reasons that include radar failure control error propulsion system failure human error and difficulties arising from prevailing weather conditions such as poor visibility probabilistic assessment of a ship s navigational failure was presented by pietrzykowski 2007 amrozowicz et al 1997 the operational safety features of vessels operating in polar waters have been described in imo 2010 the presence of various forms of ice and harsh climatic conditions impose additional operational risk to vessels operating in the arctic and sub arctic regions navigational and operational failure probabilities were presented in afenyo et al 2017 2 1 1 3 equipment functionality failure the equipment may not be fully functional during the er operation because of mechanical failure lack of maintenance or human error human error according to senders and moray 1991 human error is a result of observable behaviour originating from psychological processes on different levels it is evaluated against some performance standards initiated by an event in a situation where it is possible to act in appropriate alternative ways human errors include three aspects evaluation of human behaviour against a performance standard or criterion an event which results the measurable performance is not achieved e g the expected level is not met by the acting agent a degree of volition such that the actor has the opportunity to act in a way that will not be considered erroneous 2 1 1 4 promptness the response time is very important for a successful operation a complete operation could be considered a failure if the vessel does not arrive on time 2 1 1 5 on board fire emergency response failure on site weather conditions and humans also play important roles in this case the on board operation may fail due to lack of manpower absence of personal protective equipment or obstruction of the hazard s location 2 1 2 probabilistic logistics risk model a fault tree ft is a quantitative risk analysis tool a system or component failure is graphically presented as logical relationships with possible causes that can contribute to the system or component failure andrews and moss 2002 a system failure is referred to as a top event and all primary causes are defined as basic events which are connected by logic gates in the ft basic events have binary states i e success failure and are considered as mutually independent khakzad et al 2011 there are several logic gates however the and gate and or gate are mostly used in the ft a fault tree is adapted to its top event that includes only the most credible faults as assessed by the analyst and may not represent all possible system failure causes vesely et al 1981 the emergency response process has been defined and the contributing factors are identified in the previous sections a simple ft model is developed and presented in parts from figs 4 7 the top event is emergency response er failure which is connected by an or gate with vessel readiness unobstructed voyage functionality of equipment promptness and on board operation as failure of any of these events can cause top event failure these intermediate events are further broken down to lower resolution events until primary causes are encountered promptness is considered as a basic event that has not been developed further in this study some of the basic events e g human error or environmental causes may affect different phases of the logistics operation which have been considered in the ft model after constructing a fault tree its outcomes can be analyzed both quantitatively and qualitatively in quantitative analysis the top event failure probability is calculated based on the failure probabilities of the basic events using boolean algebra crowl and louvar 2002 quantitative results are used for identifying quantitative rankings of contributions to system failure and the evaluation of model and data sensitivity vesely et al 1981 in this study the top event probability is calculated using quantitative analysis and the results are verified with the analysis conducted by the fault tree software ferdous et al 2007 the sensitivity analysis is performed to identify the critical factors and is presented in section 4 in qualitative analysis minimal cut sets mcs are used for identifying the critical events to guide the best possible ways of risk reduction measures associated with the top event a minimal cut set is a set of a minimum number of primary events that produces the top event if and only if all the events of the set occur since all the basic events in the primary ft model are connected by an or gate failure of any basic event can lead to the top event failure which means the total number of mcs will be equal to the number of basic events therefore similar results can be obtained through the mcs approach and are not presented here 2 2 adaption of advanced probabilistic approach to develop risk model although fault tree analysis fta is a useful risk assessment technique it suffers from some limitations such as the assumptions of mutually independent basic events and exclusively binary states of events in addition the traditional fta cannot incorporate uncertainties in data several studies presented the fuzzy set theory mamood et al 2013 lavasani et al 2011 ferdous et al 2009 pan and yun 1997 tanaka et al 1983 the evidence theory ferdous et al 2011 limbourg et al 2007 and the hybrid fta lin and wang 1997 to deal with data uncertainty in fta in this study the two main categories of uncertainty namely model uncertainty and data uncertainty are considered the ft model is constructed based on several assumptions which are summarized in table 1 the identified approaches that can be adapted to relax the assumptions are 1 use of the inhibit gate to overcome independencies and leaky and or noisy or and logic to overcome the binary nature and 2 use of a bayesian network bn that provides the flexibility of interdependence and addresses model data uncertainty in this paper a case study has been presented to show how the simplified or gate is replaced by the inhibit gate in the ft to address dependencies initially environmental conditions such as wind wave and ice conditions are assumed to be independent however incidents of sea ice and pack pressured ice occur when sea ice fields converge due to local wind wave and current conditions as well as boundary conditions imposed by the local coastline geometry in near shore cases these events can have serious implications for marine transport operations in ice prone environments as the ice fields impose extreme loads on vessels and structures disrupt maneuverability and endanger personnel safety therefore the combined effects of wind wave and ice conditions should be considered in the study rather than treating those as separate independent events inhibit gates have been introduced to represent their dependencies this study represents a scenario in which the ice conditions are dependent on the additional conditional events wind and wave conditions more details about the inhibit gate are described by andrews and moss 2002 the modified ft has been presented in figs 8 10 2 3 data uncertainty table 2 summarizes the data related assumptions that may result in uncertainty in risk assessment in the advance fta a fuzzy based approach is adopted to the address vagueness and subjectivity of failure probability data and evidence theory is applied to address incomplete and missing data as well as incorporating different experts opinion in the analysis 2 3 1 vagueness and subjectivity of data the theory of fuzzy sets was first introduced by zadeh 1965 it provides a unique way to address vagueness and data uncertainty in traditional fta system failure is evaluated based on the exact value of failure probabilities of the basic events however it is difficult to estimate a precise failure rate or the probability of components failure due to lack of sufficient data or the vague character of the events mahmood et al 2013 fuzzy based approaches effectively deal with imprecision that arises due to subjectivity vagueness which can be useful in risk assessment to handle these types of uncertainties ferdous et al 2009 the fuzzy set of an event contains fuzzy numbers that have varying degrees of membership function μ ranging from 0 to 1 the relationship between the event probability and a membership function is represented by a fuzzy set the degree of membership of element x in the fuzzy set of an event p is mathematically represented as ross 2004 μp x 0 1 fuzzy numbers can be of any form however triangular or trapezoidal fuzzy numbers are commonly used in reliability and risk assessments a triangular fuzzy number tfn is used in this study where fuzzy intervals are determined by different α cut values fig 11 illustrates a tfn and the fuzzy intervals are obtained using the following equation ferdous et al 2011 pan and yun 1997 1 pα pl α pm pl pu α pu pm where pl pm and pu represent minimum most likely and upper values respectively in the α cut level the fuzzy based fta involves the following steps 1 generation of fuzzy probabilities of basic events tfn at various α cut levels 2 estimation of fuzzified top event failure probabilities based on tables 3 and 3 defuzzification of top event failure probability to a crisp value there are several methods for the defuzzification process such as the centre of area method centre of maxima method mean of maxima method and weighted average defuzzify method for this problem top event fuzzy failure probability sets are defuzzified using the centre of maxima method klir and yuan 1995 2 3 2 incomplete data and conflict between expert opinion evidence theory was first proposed by dempster 1966 and later extended by shafer 1976 which is also known as the dempster shafer theory dst missing data and conflicting subjective data can be addressed by evidence theory this helps in many ways such as integrating data from different sources filling missing data sources resolving the issue of varying data for the same cause event and updating the probability when new information becomes available according to dst an event probability is defined with a set of lower and upper bound values which are denoted as belief and plausibility respectively and a mass is assigned for the uncertainty or ignorance about that event dst application on the fta was elaborately described by ferdous et al 2009 2011 the following steps are involved in evidence based fta 1 defining the frame of discernment fod in this study fod ω f s where f and s indicate failure and success respectively the power set includes four subsets φ f s f s and cardinality ω is two 2 assigning basic probability and ignorance of each basic event based on literature and expert opinions 3 combining the individual beliefs of experts if there are more than one and generating a joint belief structure 4 estimating belief and bet of the basic events and the top events 3 application of the proposed model in this study the failure probabilities of each basic event are obtained either from the literature or from expert opinions the failure probabilities of the basic events and corresponding data sources are provided in table 4 the top event failure probability is estimated for both the traditional and advanced fault tree models and presented in table 10 the failure probability calculated by traditional fta is 0 1534 which can be interpreted as indicating that the chance of emergency response er failure is about 1 in every 7 operations this seems very conservative in contrast the estimated failure probability decreases to nearly half which means the chance of failure becomes 1 in every 13 operations when the inhibit gates are used an inhibit gate logically represents an and gate with an external conditional event therefore the replacement of or gates with inhibit gates considerably reduces the top event failure probability probability data related to the exact type of scenarios are not publicly available however based on lloyd s worldwide data for 1994 97 the failure rate of cargo ships is 3 1 10 4 each year which gives the probability of failure as 1 in 18 voyages assuming two days per voyage iaea international atomic energy agency iaea report 2001 3 1 application of fuzzy theory in this study a triangular fuzzy approach is adopted where failure probabilities collected from the literature are considered as the most likely values of basic events reasonable lower and upper boundaries have been set to form the fuzzy triangle for each event the projected failure probabilities of basic events are obtained from the corresponding fuzzy triangles for different α cut levels an example is provided in table 5 where the confidence interval is chosen as 95 α 0 95 fuzzified top event failure probabilities are estimated for each confidence interval and then defuzzified to crisp probability using the centre of maxima method a comparison of the results is presented in table 6 3 2 application of evidence theory evidence theory is used to consider incomplete data and integration of data from multiple sources to illustrate the application of the theory to the proposed model data from two different experts are used both experts have doctoral degrees have conducted several offshore safety related projects and have more than five years of experience in the relevant area the data from these two experts are provided in table 7 two different sets of data have been used to formulate evidence theory in the fta which are combined using both dst and yager rules the combination rules are described in ferdous et al 2011 smarandache and dezert 2004 yager 1987 a sample calculation is presented in table 8 three important characteristics namely belief plausible value and bet of the top event are calculated and presented in table 9 4 discussion the failure probability of logistics operations is estimated using traditional fta advanced fuzzy based fta and evidence theory based fta the summary of results is provided in table 10 the traditional fta gives significantly higher failure probability as the construction of the ft model is overly simplified with or gates only where factor dependencies and data uncertainties are not considered in the advanced fta a non traditional gate such as the inhibit gate is introduced which provides a less conservative probability estimate the use of fuzzy theory in the advanced fta offers a better decision making approach when there is imitated data the estimated failure probability using evidence theory seems relatively high the outcome mainly depends on how the ignorance of probability data is set by different experts based on the expert s knowledge also evidence theory has the advantage that multi source data can be integrated with the analysis and the model can be updated in the light of new information the analysis presented in this study demonstrated the effectiveness of the proposed framework to assess risk in logistics operations it is therefore important to rank the critical factors where preference should be given to improving the reliability of the operations the improvement indices are used to identify the most critical basic events that lead to operational failure the improvement index of an event is calculated by eliminating this event from the fault tree to measure the reduction of the magnitude of top event failure probability ferdous et al 2009 tanaka et al 1983 misra and weber 1990 the following equation is used to evaluate this index 2 fim pt pti pil t pil ti piu t piu ti where pt and pti refer to top event failure probability without and with an eliminated basic event respectively subscripts l and u indicate the lower and upper bound of fuzzy numbers the high ratio of improvement indices and er failure probability of the basic events are plotted in fig 12 this shows that mechanical failure lack of skilled and experienced manpower absence of suitable personal protective equipment failure of navigation equipment and inadequate or missing lifesaving appliances are the most contributory factors that lead to er failure mechanical failure includes a broad range of equipment failure during an on board operation and the failure probability is significantly influenced by the weather conditions bercha 2003 the correlations among mechanical failure human error and existing environmental conditions are not considered in the fta detailed investigation is required to improve the reliability assessment which could be an area of future work 5 conclusions this paper presents a risk model to analyze operational challenges of marine logistics support in harsh environmental conditions the objective of this study is to identify the critical factors that will provide guidance to identify risk reduction measures to achieve a safer and faster approach in responding to this type of operation for example one such measure is the temporary offshore refuge which needs to be further investigated this work provides a basis for developing solutions to emergency marine logistics problems in remote and harsh regions fault trees are used as a tool to develop the risk model application of the proposed ft model is demonstrated by studying an emergency response scenario although the fault tree is a common technique for assessing operational performance and reliability of a system the traditional fault tree suffers from several limitations addressing interdependencies of events adapting to new information and knowledge and handling uncertainties are of fundamental importance for a robust risk model this study addresses these points through 1 consideration of interdependencies of events in the fault tree model through non traditional gates such as the inhibit gate 2 consideration of data uncertainty in the earlier belief or data which is important as often precise data for such analysis are not available the fuzzy based fta approach helps to enhance robustness of the analysis in the presence of vague and subjective data 3 consideration of missing data and conflicting subjective data using evidence theory this consideration helps to integrate data from different sources overcome a missing data problem resolve the issue when there is varying data for the same event and update the probability the sensitivity analysis results reveal that the most critical phase of this process is conducting a successful on board operation after reaching the target location the main challenges include but are not limited to mechanical failure that comprises malfunction of lifeboats failure to launch inability to reach the installation due to severe ice conditions etc and lack of trained and experienced personnel to conduct the operation in such harsh environmental conditions the study presents a generic model which may be used to conduct a marine logistics risk assessment and support an operation in a harsh offshore environment the proposed model can be modified based on region specific features and analysis should be performed using suitable probability data available for that region feedback from two experts with similar education and experience levels are considered in this study more data from experts with diverse backgrounds such as academicians ships captains and other offshore personnel can be incorporated when available a weighting factor can be introduced based on the profession and experience of the experts in addition further investigation is required to develop promptness additional data and a different approach i e a model that can define failure as a function of response time can be proposed as future work the use of the advance fta is a useful tool to model risk for er processes although an alternative modelling approach namely the bn has a more flexible structure than the fault tree and offers better representation of interdependencies and uncertainty handling capacity therefore bn modelling of the er operation could be a promising future study acknowledgements authors thankfully acknowledge funding support from the natural science and engineering council of canada nserc and the canada research chair tier i program in offshore safety and risk engineering 
22974,logistics support to offshore operations is challenging especially under severe environmental conditions such as those in the arctic and sub arctic the dominant environmental conditions including waves wind poor visibility and the presence of icebergs and sea ice determine the mode and success of logistics support use of helicopters as a mode of logistics transport becomes ineffective when the distance is longer the visibility is low or the weather is stormy marine logistics support is more reliable and versatile the present work focuses on developing a model for assessing risk associated with marine logistics operations in remote offshore locations beyond helicopter reach frequented with harsh environmental conditions high winds waves and icy conditions the key factors that affect such operations are identified and failure models are developed using fault trees as an improvement advance fault trees are adopted to relax the inherent limitations of the primary model uncertainties in both data and model are considered using the fuzzy inference system and evidence theory application of the proposed model is demonstrated through a case study concerning a remote north atlantic offshore operation the contribution of this study is the identification of the key factors controlling the marine logistics operation and the development of a robust risk model that helps to analyze criticality of the contributing factors the proposed model has the potential to help to develop innovative risk management strategies to support offshore operations keywords logistics risk offshore safety fault tree analysis fuzzy set theory evidence theory 1 introduction operations in harsh environmental conditions are challenging and pose significant risks to people and infrastructures as well as to the environment the arctic and sub arctic regions are considered to have the harshest environmental conditions in the world due to the presence of ice extreme cold high winds and unpredictable weather changes despite the challenging conditions these regions contain proven reserves of hydrocarbons and mineral resources leading to increased interest of the oil and gas and the mining industries tellier 2008 the exploration and development of natural resources in these regions present significant safety and integrity challenges which are identified as the lack of detail in construction and operation standards restricted operating conditions due to extreme weather including different ice features such as pack ice and icebergs remoteness human factors and knowledge and data scarcity khan et al 2014 the stakeholders need an improved understanding of operational challenges to ensure safe operations in such conditions a recent drilling project conducted by statoil canada ltd statoil in the flemish pass basin is an example of distant offshore exploration in the harsh arctic environment the basin is located approximately 480 km east of st john s newfoundland and labrador fig 1 this is the furthest offshore that statoil has developed a project which adds to the cost and logistics challenges project description summary statoil canada ltd 2016 additional fuel requirements to cover the long distance from shore means less cargo capacity for vessels and helicopters the long trip distance poor visibility due to the prevalent occurrence of marine fog particularly in summer and spring and recurrent storms negatively affect the safety and effectiveness of using helicopters for logistics operations jan erik 2014 therefore marine vessels become the only mode of transport in such conditions however the presence of icebergs march to july and sea ice winter and spring may hamper timely vessel transit in addition strong winds snow and freezing rain raise difficulties for on board vessel operations a formal risk assessment of marine logistics operations is required to consider these additional threats so that vessels can perform routine supply as well as successful emergency response the objective of this work is to develop a methodology for assessing risk and to identify critical factors associated with marine logistics operations in remote and ice covered regions the innovations in this work stem from i adapting an advance fault tree to overcome the assumption of independence of faults ii considering a fuzzy inference system to incorporate data uncertainty vagueness and subjectivity and iii considering evidence theory to integrate data from multiple sources and incomplete data the proposed unique model will help to analyze risk factors for marine logistics operations in quantitative terms this will also help in developing effective and efficient risk management strategies the rest of this paper is organized as follows section 2 broadly describes the methodology for risk analysis of marine logistics operations and an illustrated example is presented in section 3 section 4 discusses results and conclusions are provided in section 5 2 methodology to develop logistics risk model the aim of this work is to develop a basis for assessing risk for logistics operations in harsh environments and to provide guidelines for safety measures to overcome associated challenges the framework for this study is illustrated in fig 2 the possible factors that may affect the successful operation at each stage of a logistics operation are identified a fault tree based risk model is developed this model is revised considering interdependence of parameters the risk model is subsequently integrated with fuzzy and evidence theory to overcome the uncertainties of failure probability data these steps are elaborated in the following sections 2 1 logical modelling of marine logistics support 2 1 1 identification of main contributing factors logistics operations are conducted to transport personnel and to provide routine supplies as well as emergency support to recover from hazardous incidents the sequence of activities involved in the process of an emergency logistics operation is presented in fig 3 this process consists of the following phases departure readiness of a supply vessel when an incident has been reported an uninterrupted voyage functionality of on board equipment arrival at the site within the desired time limit and on site operation a successful logistics operation will not be possible if any of these phases fails the risk factors that are involved in each phase of an operation are discussed in the following paragraphs 2 1 1 1 failure delay due to departure readiness the ship cannot depart for er or logistics support if there is insufficient crew a shortage of fuel for the distance lack of safety equipment or engine problems working in cold weather can endanger the crew unless proper preparations are made to equip the vessel and the crew for operating in the cold dark and icy conditions failure due to improper voyage plans has been addressed in detail by kum and sahin 2015 the vessel should be equipped with the following safety features for safe operation lifesaving appliances lifeboats should be enclosed and specially designed to operate in cold weather and turbulent water launching equipment should be designed to avoid the effects of freezing ice immersion suits are necessary for crew survival the reliability information about lifesaving appliances is obtained from bercha et al 2003 firefighting equipment significant risks are associated with the use of firefighting equipment in extremely low temperatures the most significant being the potential freezing of fluids in lines specific risks include freezing of firefighting equipment such as water hoses piping and nozzles portable fire extinguisher storage may be obstructed or frozen fire dampers may freeze in the stowage position navigation equipment navigational equipment of a ship includes steering hydraulic and propulsion systems faulty equipment may result in departure failure antao et al 2006 a modern marine engine has a very complex structure that consists of many mechanical components as well as a fuel system lubricating system cooling system auxiliary system and a control and safety system the reliability features of a vessel engine were described in detail by laskowski 2015 and khorasani 2015 2 1 1 2 unobstructed voyage the main factors that can disrupt the transit of a vessel are environmental factors wind waves and ice loss of hull integrity and operational navigational or communication failure environmental factors the northern regions have extreme climatic conditions that include prolonged winters with sub zero temperatures the presence of different forms of ice features and high wind and waves any precipitation in low temperatures results in snow freezing rain or ice pellets that can reduce visibility and cause the accretion of ice on ships ice movement due to high wind and currents and presence of icebergs can impose the risk of ship besetting incidents the reported ice conditions on ice charts or satellite imagery can change frequently particularly the positions of the ice edge and the location of leads through the pack ice abs 2010 loss of hull integrity ship hull integrity failure may lead to an unsuccessful operation this failure can occur due to causes such as collision with an iceberg human error or operational failure navigational and operational failure navigational failure may occur for many reasons that include radar failure control error propulsion system failure human error and difficulties arising from prevailing weather conditions such as poor visibility probabilistic assessment of a ship s navigational failure was presented by pietrzykowski 2007 amrozowicz et al 1997 the operational safety features of vessels operating in polar waters have been described in imo 2010 the presence of various forms of ice and harsh climatic conditions impose additional operational risk to vessels operating in the arctic and sub arctic regions navigational and operational failure probabilities were presented in afenyo et al 2017 2 1 1 3 equipment functionality failure the equipment may not be fully functional during the er operation because of mechanical failure lack of maintenance or human error human error according to senders and moray 1991 human error is a result of observable behaviour originating from psychological processes on different levels it is evaluated against some performance standards initiated by an event in a situation where it is possible to act in appropriate alternative ways human errors include three aspects evaluation of human behaviour against a performance standard or criterion an event which results the measurable performance is not achieved e g the expected level is not met by the acting agent a degree of volition such that the actor has the opportunity to act in a way that will not be considered erroneous 2 1 1 4 promptness the response time is very important for a successful operation a complete operation could be considered a failure if the vessel does not arrive on time 2 1 1 5 on board fire emergency response failure on site weather conditions and humans also play important roles in this case the on board operation may fail due to lack of manpower absence of personal protective equipment or obstruction of the hazard s location 2 1 2 probabilistic logistics risk model a fault tree ft is a quantitative risk analysis tool a system or component failure is graphically presented as logical relationships with possible causes that can contribute to the system or component failure andrews and moss 2002 a system failure is referred to as a top event and all primary causes are defined as basic events which are connected by logic gates in the ft basic events have binary states i e success failure and are considered as mutually independent khakzad et al 2011 there are several logic gates however the and gate and or gate are mostly used in the ft a fault tree is adapted to its top event that includes only the most credible faults as assessed by the analyst and may not represent all possible system failure causes vesely et al 1981 the emergency response process has been defined and the contributing factors are identified in the previous sections a simple ft model is developed and presented in parts from figs 4 7 the top event is emergency response er failure which is connected by an or gate with vessel readiness unobstructed voyage functionality of equipment promptness and on board operation as failure of any of these events can cause top event failure these intermediate events are further broken down to lower resolution events until primary causes are encountered promptness is considered as a basic event that has not been developed further in this study some of the basic events e g human error or environmental causes may affect different phases of the logistics operation which have been considered in the ft model after constructing a fault tree its outcomes can be analyzed both quantitatively and qualitatively in quantitative analysis the top event failure probability is calculated based on the failure probabilities of the basic events using boolean algebra crowl and louvar 2002 quantitative results are used for identifying quantitative rankings of contributions to system failure and the evaluation of model and data sensitivity vesely et al 1981 in this study the top event probability is calculated using quantitative analysis and the results are verified with the analysis conducted by the fault tree software ferdous et al 2007 the sensitivity analysis is performed to identify the critical factors and is presented in section 4 in qualitative analysis minimal cut sets mcs are used for identifying the critical events to guide the best possible ways of risk reduction measures associated with the top event a minimal cut set is a set of a minimum number of primary events that produces the top event if and only if all the events of the set occur since all the basic events in the primary ft model are connected by an or gate failure of any basic event can lead to the top event failure which means the total number of mcs will be equal to the number of basic events therefore similar results can be obtained through the mcs approach and are not presented here 2 2 adaption of advanced probabilistic approach to develop risk model although fault tree analysis fta is a useful risk assessment technique it suffers from some limitations such as the assumptions of mutually independent basic events and exclusively binary states of events in addition the traditional fta cannot incorporate uncertainties in data several studies presented the fuzzy set theory mamood et al 2013 lavasani et al 2011 ferdous et al 2009 pan and yun 1997 tanaka et al 1983 the evidence theory ferdous et al 2011 limbourg et al 2007 and the hybrid fta lin and wang 1997 to deal with data uncertainty in fta in this study the two main categories of uncertainty namely model uncertainty and data uncertainty are considered the ft model is constructed based on several assumptions which are summarized in table 1 the identified approaches that can be adapted to relax the assumptions are 1 use of the inhibit gate to overcome independencies and leaky and or noisy or and logic to overcome the binary nature and 2 use of a bayesian network bn that provides the flexibility of interdependence and addresses model data uncertainty in this paper a case study has been presented to show how the simplified or gate is replaced by the inhibit gate in the ft to address dependencies initially environmental conditions such as wind wave and ice conditions are assumed to be independent however incidents of sea ice and pack pressured ice occur when sea ice fields converge due to local wind wave and current conditions as well as boundary conditions imposed by the local coastline geometry in near shore cases these events can have serious implications for marine transport operations in ice prone environments as the ice fields impose extreme loads on vessels and structures disrupt maneuverability and endanger personnel safety therefore the combined effects of wind wave and ice conditions should be considered in the study rather than treating those as separate independent events inhibit gates have been introduced to represent their dependencies this study represents a scenario in which the ice conditions are dependent on the additional conditional events wind and wave conditions more details about the inhibit gate are described by andrews and moss 2002 the modified ft has been presented in figs 8 10 2 3 data uncertainty table 2 summarizes the data related assumptions that may result in uncertainty in risk assessment in the advance fta a fuzzy based approach is adopted to the address vagueness and subjectivity of failure probability data and evidence theory is applied to address incomplete and missing data as well as incorporating different experts opinion in the analysis 2 3 1 vagueness and subjectivity of data the theory of fuzzy sets was first introduced by zadeh 1965 it provides a unique way to address vagueness and data uncertainty in traditional fta system failure is evaluated based on the exact value of failure probabilities of the basic events however it is difficult to estimate a precise failure rate or the probability of components failure due to lack of sufficient data or the vague character of the events mahmood et al 2013 fuzzy based approaches effectively deal with imprecision that arises due to subjectivity vagueness which can be useful in risk assessment to handle these types of uncertainties ferdous et al 2009 the fuzzy set of an event contains fuzzy numbers that have varying degrees of membership function μ ranging from 0 to 1 the relationship between the event probability and a membership function is represented by a fuzzy set the degree of membership of element x in the fuzzy set of an event p is mathematically represented as ross 2004 μp x 0 1 fuzzy numbers can be of any form however triangular or trapezoidal fuzzy numbers are commonly used in reliability and risk assessments a triangular fuzzy number tfn is used in this study where fuzzy intervals are determined by different α cut values fig 11 illustrates a tfn and the fuzzy intervals are obtained using the following equation ferdous et al 2011 pan and yun 1997 1 pα pl α pm pl pu α pu pm where pl pm and pu represent minimum most likely and upper values respectively in the α cut level the fuzzy based fta involves the following steps 1 generation of fuzzy probabilities of basic events tfn at various α cut levels 2 estimation of fuzzified top event failure probabilities based on tables 3 and 3 defuzzification of top event failure probability to a crisp value there are several methods for the defuzzification process such as the centre of area method centre of maxima method mean of maxima method and weighted average defuzzify method for this problem top event fuzzy failure probability sets are defuzzified using the centre of maxima method klir and yuan 1995 2 3 2 incomplete data and conflict between expert opinion evidence theory was first proposed by dempster 1966 and later extended by shafer 1976 which is also known as the dempster shafer theory dst missing data and conflicting subjective data can be addressed by evidence theory this helps in many ways such as integrating data from different sources filling missing data sources resolving the issue of varying data for the same cause event and updating the probability when new information becomes available according to dst an event probability is defined with a set of lower and upper bound values which are denoted as belief and plausibility respectively and a mass is assigned for the uncertainty or ignorance about that event dst application on the fta was elaborately described by ferdous et al 2009 2011 the following steps are involved in evidence based fta 1 defining the frame of discernment fod in this study fod ω f s where f and s indicate failure and success respectively the power set includes four subsets φ f s f s and cardinality ω is two 2 assigning basic probability and ignorance of each basic event based on literature and expert opinions 3 combining the individual beliefs of experts if there are more than one and generating a joint belief structure 4 estimating belief and bet of the basic events and the top events 3 application of the proposed model in this study the failure probabilities of each basic event are obtained either from the literature or from expert opinions the failure probabilities of the basic events and corresponding data sources are provided in table 4 the top event failure probability is estimated for both the traditional and advanced fault tree models and presented in table 10 the failure probability calculated by traditional fta is 0 1534 which can be interpreted as indicating that the chance of emergency response er failure is about 1 in every 7 operations this seems very conservative in contrast the estimated failure probability decreases to nearly half which means the chance of failure becomes 1 in every 13 operations when the inhibit gates are used an inhibit gate logically represents an and gate with an external conditional event therefore the replacement of or gates with inhibit gates considerably reduces the top event failure probability probability data related to the exact type of scenarios are not publicly available however based on lloyd s worldwide data for 1994 97 the failure rate of cargo ships is 3 1 10 4 each year which gives the probability of failure as 1 in 18 voyages assuming two days per voyage iaea international atomic energy agency iaea report 2001 3 1 application of fuzzy theory in this study a triangular fuzzy approach is adopted where failure probabilities collected from the literature are considered as the most likely values of basic events reasonable lower and upper boundaries have been set to form the fuzzy triangle for each event the projected failure probabilities of basic events are obtained from the corresponding fuzzy triangles for different α cut levels an example is provided in table 5 where the confidence interval is chosen as 95 α 0 95 fuzzified top event failure probabilities are estimated for each confidence interval and then defuzzified to crisp probability using the centre of maxima method a comparison of the results is presented in table 6 3 2 application of evidence theory evidence theory is used to consider incomplete data and integration of data from multiple sources to illustrate the application of the theory to the proposed model data from two different experts are used both experts have doctoral degrees have conducted several offshore safety related projects and have more than five years of experience in the relevant area the data from these two experts are provided in table 7 two different sets of data have been used to formulate evidence theory in the fta which are combined using both dst and yager rules the combination rules are described in ferdous et al 2011 smarandache and dezert 2004 yager 1987 a sample calculation is presented in table 8 three important characteristics namely belief plausible value and bet of the top event are calculated and presented in table 9 4 discussion the failure probability of logistics operations is estimated using traditional fta advanced fuzzy based fta and evidence theory based fta the summary of results is provided in table 10 the traditional fta gives significantly higher failure probability as the construction of the ft model is overly simplified with or gates only where factor dependencies and data uncertainties are not considered in the advanced fta a non traditional gate such as the inhibit gate is introduced which provides a less conservative probability estimate the use of fuzzy theory in the advanced fta offers a better decision making approach when there is imitated data the estimated failure probability using evidence theory seems relatively high the outcome mainly depends on how the ignorance of probability data is set by different experts based on the expert s knowledge also evidence theory has the advantage that multi source data can be integrated with the analysis and the model can be updated in the light of new information the analysis presented in this study demonstrated the effectiveness of the proposed framework to assess risk in logistics operations it is therefore important to rank the critical factors where preference should be given to improving the reliability of the operations the improvement indices are used to identify the most critical basic events that lead to operational failure the improvement index of an event is calculated by eliminating this event from the fault tree to measure the reduction of the magnitude of top event failure probability ferdous et al 2009 tanaka et al 1983 misra and weber 1990 the following equation is used to evaluate this index 2 fim pt pti pil t pil ti piu t piu ti where pt and pti refer to top event failure probability without and with an eliminated basic event respectively subscripts l and u indicate the lower and upper bound of fuzzy numbers the high ratio of improvement indices and er failure probability of the basic events are plotted in fig 12 this shows that mechanical failure lack of skilled and experienced manpower absence of suitable personal protective equipment failure of navigation equipment and inadequate or missing lifesaving appliances are the most contributory factors that lead to er failure mechanical failure includes a broad range of equipment failure during an on board operation and the failure probability is significantly influenced by the weather conditions bercha 2003 the correlations among mechanical failure human error and existing environmental conditions are not considered in the fta detailed investigation is required to improve the reliability assessment which could be an area of future work 5 conclusions this paper presents a risk model to analyze operational challenges of marine logistics support in harsh environmental conditions the objective of this study is to identify the critical factors that will provide guidance to identify risk reduction measures to achieve a safer and faster approach in responding to this type of operation for example one such measure is the temporary offshore refuge which needs to be further investigated this work provides a basis for developing solutions to emergency marine logistics problems in remote and harsh regions fault trees are used as a tool to develop the risk model application of the proposed ft model is demonstrated by studying an emergency response scenario although the fault tree is a common technique for assessing operational performance and reliability of a system the traditional fault tree suffers from several limitations addressing interdependencies of events adapting to new information and knowledge and handling uncertainties are of fundamental importance for a robust risk model this study addresses these points through 1 consideration of interdependencies of events in the fault tree model through non traditional gates such as the inhibit gate 2 consideration of data uncertainty in the earlier belief or data which is important as often precise data for such analysis are not available the fuzzy based fta approach helps to enhance robustness of the analysis in the presence of vague and subjective data 3 consideration of missing data and conflicting subjective data using evidence theory this consideration helps to integrate data from different sources overcome a missing data problem resolve the issue when there is varying data for the same event and update the probability the sensitivity analysis results reveal that the most critical phase of this process is conducting a successful on board operation after reaching the target location the main challenges include but are not limited to mechanical failure that comprises malfunction of lifeboats failure to launch inability to reach the installation due to severe ice conditions etc and lack of trained and experienced personnel to conduct the operation in such harsh environmental conditions the study presents a generic model which may be used to conduct a marine logistics risk assessment and support an operation in a harsh offshore environment the proposed model can be modified based on region specific features and analysis should be performed using suitable probability data available for that region feedback from two experts with similar education and experience levels are considered in this study more data from experts with diverse backgrounds such as academicians ships captains and other offshore personnel can be incorporated when available a weighting factor can be introduced based on the profession and experience of the experts in addition further investigation is required to develop promptness additional data and a different approach i e a model that can define failure as a function of response time can be proposed as future work the use of the advance fta is a useful tool to model risk for er processes although an alternative modelling approach namely the bn has a more flexible structure than the fault tree and offers better representation of interdependencies and uncertainty handling capacity therefore bn modelling of the er operation could be a promising future study acknowledgements authors thankfully acknowledge funding support from the natural science and engineering council of canada nserc and the canada research chair tier i program in offshore safety and risk engineering 
