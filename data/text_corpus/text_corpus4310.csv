index,text
21550,the ship stern shaft bearing system is a typical nonlinear system and its dynamic behavior is complex in order to investigate the evolvement of dynamic behavior from the system the attractor theory is introduced based on the calculated dynamic responses of the established dynamic model the system s attractors were reconstructed and the evolvement of dynamic behaviors under different rub impact states was discussed the results show that under the full annular rub impact state the attractor of the system is limit cycle attractor and the volume of it increases gradually under the partial rub impact state the attractor of the system goes through the process of breaking the tours attractor into a chaotic attractor and then converging into a tour attractor and the volume of the attractor increases at first and then decreases under the no rub impact state the attractor of the system is limit cycle attractor and its volume decreases gradually these characters of attractors demonstrate that under different rub impact states the system has experienced periodic motion quasi periodic and chaotic motion the attractors also reveal the evolutions of convergence and divergence keywords ship stern shaft bearing system rub impact dynamic behaviors evolvement attractor 1 introduction rub impact is one of the common faults in the ship stern shaft bearing system han and lee 2019 huang et al 2019 lin et al 2019 yang 2010 zhang et al 2014 long term rub impact will cause the wear of the stern tube bearing and the increase of the gap between the bearing and the journal and even lead to the failure of the ship s propulsion shafting therefore it is essential to identify the rub impact faults and to know the time history of the rub impact evolution from inception to the end as is well known for all when rub impact occurs the rotor system can exhibit abundant dynamic behaviors such as periodic motion quasi periodic motion bifurcation and chaotic motion chouchane and amamou 2011 hou 2015 li et al 2010 liu et al 2013 shen et al 2008 wang et al 2013 2017 yang et al 2018 2017 shen and liu liu et al 2013 shen et al 2008 discovered the rub impact rotor presented complex periodic quasi periodic and chaotic motions and the results can apply to the diagnosis of rub impact rotor faults chouchane and li chouchane and amamou 2011 hou 2015 li et al 2010 discussed the nonlinear vibration characteristics of jeffcott rotor with rub impact and they found the period doubling bifurcation and hopf bifurcation in the system based on these researches some dynamic behaviors such as the existence of the bifurcation and chaotic motions can be used to judge whether a rotor system has a rub impact or not hua et al 2015 however when rub impact occurs the system could exhibit different dynamic characteristics such as approaching or deviating the steady state or a non steady state therefore to accurately assess the security of the system it is not enough to know the dynamic behavior exhibited by the rub impact but to reveal how it evolves unfortunately due to the lack of more effective analysis methods few studies have been undertaken to investigate the evolvement of dynamic behavior during the rub impact process thus it is essential to explore some new methods to discover the evolvement of dynamic behaviors during the rub impact process the attractor is a concept to characterize the dynamic behaviors of a system sun 2019 in the phase space the attractors represent the relatively stable parts of the system and they have an adsorption effect on other unstable points making the system generally tend to a stable state therefore the attractors contains a lot of critical information about the system moreover since the attractors are ubiquitous in dissipative systems it is appropriate to use them to describe the dynamic behaviors numerous studies have shown that the dynamic behavior of a system can be characterized by the phase space trajectory of attractor that is reconstructed from the time series signal oberst and lai 2015 2011 sui and ding 2018 oberst and lai oberst and lai 2015 2011 investigated the generation of significant amplitude vibrations in the noise performance of a brake system and they found its phase space dynamics evolution from a limit cycle over a torus regime to a low dimensional chaotic attractor sui and ding 2018 discussed the bifurcation behavior in a pad on disc frictional system utilizing attractors in the last years some experiments with analyzing the dynamics of a long sliding bearing which is similar to the stern tube bearing of a merchant ship has conducted in our lab xing et al 2020 there are some details of the experiment in appendix a fig a 1 a 2 the results show the attractor can identify the boundary friction mixed friction and liquid friction in the sliding system it demonstrated that the attractor can be useful in the nonlinear dynamic system therefore in this paper the attractor was introduced to investigate the dynamic behaviors of the ship stern shaft bearing system to reconstruct the attractor of the system a dynamic model of the ship stern shaft bearing system based on the oil film force and rub impact force was established and its dynamic responses under different excitation frequencies were calculated by using the runge kutta method the attractors of the ship stern shaft bearing system were reconstructed from the calculated dynamic responses by applying the takens theorem and the correlation integral method c c method the dynamic behaviors of the ship stern shaft bearing system were investigated by the reconstructed attractor 2 the calculation method of the dynamic response of the ship stern shaft bearing system 2 1 dynamic model in this paper the ship stern shaft bearing system with front and aft stern shaft bearings were used as the research object to investigate the dynamic response of rotor under the oil film force and rub impact force its dynamic model was established as shown in fig 1 in the model the excitation force was applied by equivalent mass at the same time only the transverse vibration of the system is considered and the influence of torsional vibration and the gyroscopic effect is ignored in fig 1 the m 1 is the equivalent lumped mass of the input the m 2 and m 4 are the equivalent lumped masses of the stern shaft at the front and aft stern bearing the nonlinear oil film force f and rub impact force p are applied on the two disks the m 3 is the equivalent lumped mass of the stern shaft between the two bearings m 5 is the equivalent lumped mass of output the disks are connected by massless elastic shafts based on the unsteady nonlinear oil film force model proposed by capone in 1991 geng 2019 the nonlinear oil film force f xi and f yi i 1 2 are calculated as follows at first the dimensionless oil film force in the x and y directions of the fixed rectangular coordinate system is calculated by eq 1 1 f x 3 a x v x y α a g x y α sin α 2 s x y α cos α f y 3 a x v x y α a g x y α cos α 2 s x y α sin α where 2 α tan 1 y 2 x x 2 y π 2 sign y 2 x x 2 y π 2 sign y 2 x 3 a x 2 y 2 y 2 x 2 1 x 2 y 2 4 g x y α 2 1 x 2 y 2 π 2 tan 1 y cos α x sin α 1 x 2 y 2 5 v x y α 2 y cos α x sin α g x y α 1 x 2 y 2 6 s x y α x cos α y sin α 1 x cos α y sin α 2 then the dimensional component of the oil film force in the x and y directions are 7 f x s p f x f y s p f y where s p μ n ω r l r c 2 l 2 r 2 s is the sommerfeld correction factor p is the half of the quality of the shaft segment at the bearing μ n is the lubricating oil viscosity c is the average thickness of the oil film r is the radius of the bearing l is the length of the bearing based on a jeffcott rotor model geng 2019 the rub impact force p xi and p yi i 1 2 are calculated as follows regardless of the heating effect of the friction the model of the rub impact force between stern shaft and bearing is shown in fig 2 where p r is the radial impact force p t is the tangential rub force θ is the angle between the radius vector at the contact point and the x axis ω is the rotation velocity of the rotor in this paper δ is the radial clearance of the stator r x 2 y 2 is the radial displacement of the rotor center deviating from the stator center and e is the mass eccentricity of the rotor the radial collision force between the rotor and stator is linear equivalent spring model and the tangential friction force is coulomb friction model so when r δ the collision force and the friction force are respectively 8 p r k r r δ p t f p r where k r is the radial stiffness of the stator f is the friction coefficient by decomposing the radial collision force and the tangential friction force the components p x and p y of the rub impact force in the horizontal and vertical directions are obtained therefore the rub impact force can be expressed in the rectangular coordinate system as 9 p x pr cos θ p t sin θ p y pr sin θ p t cos θ and it follows that 10 p x p y r δ k r r 1 f f 1 x y 2 2 dynamic equations according to the dynamic model of the ship stern shaft bearing system established in section 2 1 the dynamic equations of five mass rotor systems can be built according to newton s second law as shown in eq 11 11 m 1 x 1 c 1 x 1 k 1 x 1 x 2 m 1 e ω 2 cos ω t m 1 y 1 c 1 y 1 k 1 y 1 y 2 m 1 e ω 2 sin ω t m 1 g m 2 x 2 c 2 x 2 k 1 x 2 x 1 k 2 x 2 x 3 m 2 e ω 2 cos ω t f x 1 p x 1 m 2 y 2 c 2 y 2 k 1 y 2 y 1 k 2 y 2 y 3 m 2 e ω 2 sin ω t f y 1 p y 1 m 2 g m 3 x 3 c 3 x 3 k 2 2 x 3 x 2 x 4 m 3 e ω 2 cos ω t m 3 y 3 c 3 y 3 k 2 2 y 3 y 2 y 4 m 3 e ω 2 sin ω t m 3 g m 4 x 4 c 4 x 4 k 2 x 4 x 3 k 3 x 4 x 5 m 4 e ω 2 cos ω t f x 2 p x 2 m 4 y 4 c 4 y 4 k 2 y 4 y 3 k 3 y 4 y 5 m 4 e ω 2 sin ω t f y 2 p y 2 m 4 g m 5 x 5 c 5 x 5 k 3 x 5 x 4 m 5 e ω 2 cos ω t m 5 y 5 c 5 y 5 k 3 y 5 y 4 m 5 e ω 2 sin ω t m 5 g where ki i 1 3 is the bending stiffness of each shaft segment in fig 1 c i i 1 5 is the internal damping coefficient at the five equivalent disks e is the mass eccentricity of unbalanced excitation ω is the excitation frequency and g is the gravitational acceleration 2 3 system parameters in order to make the dynamic model closer to the actual ship stern shaft bearing system based on the literature geng 2019 yang 2010 zhang 2019 and some real data fig b 1 in appendix b the initial parameters of the ship stern shaft bearing system selected in this paper are shown in table 1 among them the five equivalent lumped masses in fig 1 are regarded as rigid thin disks without considering the thickness in this paper the runge kutta method was used in the software matlab to integrate eq 11 and the dynamic response of the ship stern shaft bearing system was computed to obtain the dynamic behaviors of the system under different rub impact states the range of excitation frequency was taken as 0 100 rad s the time step was set as 1 512 of the period and 2200 periods were simulated the data of the first 2000 periods were discarded and the results of the last 200 periods were taken for analysis 3 results and discussions 3 1 the analysis of the dynamic response and rub impact state 3 1 1 the analysis of the dynamic response based on the runge kutta method the dynamic response of the ship stern shaft bearing system in x and y directions can be obtained fig 3 shows the waveforms and spectrums of the dynamic response under three different excitation frequencies it can be seen that when the excitation frequency is 30 rad s the dynamic response of the system shows a periodic waveform and its spectrum is a single peak spectrum as shown in fig 3 a when the excitation frequency is 60 rad s the aperiodic waveforms appear in the dynamic response of the system and its spectrum shows a multiple peak spectrum as shown in fig 3 b when the excitation frequency is 90 rad s the dynamic response of the system returns to the periodic waveform but its spectrum shows a double peak spectrum despite a weak amplitude in the double frequency as shown in fig 3 c besides in fig 3 b the amplitude of the major frequencies in the x and y directions is also larger than that in fig 3 a and c the different time frequency characteristics of the dynamic response in fig 3 shows that when the excitation frequency is around 60 rad s the system s vibration is relatively intense when the excitation frequency is around 30 rad s and 90 rad s the operation of the system is relatively stable therefore the operating state of the system has changed under different excitation frequencies 3 1 2 the analysis of rub impact state according to the dynamic response of the system at the x and y directions the axial displacement r of the stern shaft under different excitation frequencies was calculated the axial displacement can indicate the degree to which the shaft deviates from its initial position during operation when the deviation is severe collision and friction will occur between the shaft and the bearing therefore in order to analyze the system s rub impact state fig 4 shows the maximum and minimum values of axial displacement and the bearing clearance δ is also given it can be found from fig 4 that with the increase of excitation frequency the axial displacement of the system display three stages large value stage i e r δ intermediate value stage i e r min δ r max and small value stage i e r δ according to the rub impact mechanism jiang and chen 2013 ma et al 2014 the variation in axial displacement indicates that the system could go through the different rub impact state and the specific analysis is as follows 1 large value stage as can be seen from fig 4 when the excitation frequency is under 0 51 8 rad s both the maximum and minimum values of shaft displacement exceed the bearing clearance which indicates that the shaft and bearing always stay in touch therefore the system is in a full annular rub impact state at the same time with the increase of excitation frequency both the maximum and minimum value of shaft displacement gradually decrease and they appear a tendency towards separation which means that the full annular rub impact is an unsteady dynamic behavior and it could evolve into a new state as the increase of excitation frequency 2 intermediate value stage when the excitation frequency reaches 51 8 rad s the maximum shaft displacement is greater than the average bearing clearance while the minimum value is less than the average bearing clearance which indicates that an intermittent contact occurs between the shaft and the bearing therefore the system is in a partial rub state moreover it can also be seen from fig 4 that in the excitation frequency ranges from 51 8 rad s to 76 rad s both the maximum and minimum values show a fluctuating state i e their changes are non stationary as the increase of excitation frequency which means that the partial rub impact is a complex and changeable dynamic behavior it could display different evolution as the increase of excitation frequency 3 small value stage when the excitation frequency is 76 100 rad s both the maximum and minimum values of shaft displacement are smaller than the bearing clearance which indicates that no contact occurs between the shaft and bearing therefore the system is in a no rub impact state at the same time with the increase of excitation frequency both the maximum and minimum value of shaft displacement tends to be pretty stable which means that in the no rub impact state the dynamic behavior of the system is stable and it could no longer evolve as the increase of excitation frequency the above analysis shows that with the increase of excitation frequency the ship stern shaft bearing system can present different rub impact states i e the full annular rub impact the partial rub impact and no rub impact which demonstrates that the system can perform different dynamic behaviors however it not clear how these dynamic behaviors evolve during the rub impact process 3 2 evolvement of dynamic behaviors in order to reveal the evolvement of dynamic behaviors during the rub impact process the attractors of the ship stern shaft bearing system were reconstructed by takens theorem sun et al 2015 and c c method hu and chen 2013 from the y direction displacement response under different rub impact states based on the attractors the evolvement of dynamic behaviors was discussed as follows 3 2 1 the full annular rub impact state fig 5 is the reconstructed attractors under the full annular rub impact state it can be found that the trajectory of all the attractors in the phase space displays the limit cycle structure which indicates that the dynamic behavior of the system is characterized by periodic motion moreover the limit cycle gradually increases with the increase of the excitation frequency as shown in fig 5 a j which indicates that the periodic motion is divergent and tends to become unstable therefore under the full annular rub impact state the dynamic behavior of the system is dominated by periodic motion and it evolves toward an unstable state as the increase of the excitation frequency 3 2 2 the partial rub impact state fig 6 is the reconstructed attractors under the partial rub impact state it can be seen that the reconstructed attractors under the partial rub impact state have a more complex structure in phase space than that under the full annular rub impact state with the increase of the excitation frequency they display the torus as shown in fig 6 a the broken torus as shown in fig 6 b the aperiodic orbits as shown in fig 6 c f the broken torus as shown in fig 6 g and the torus as shown in fig 6 h respectively the change of attractor s trajectory in phase space demonstrates that under the partial rub impact state the dynamic behavior of the system undergoes quasi periodic motion then enters into chaotic motion and finally returns to quasi periodic motion furthermore the entry and departure of chaotic motion are caused by the breaking of a quasi periodic torus as shown in fig 6 b and g in the meantime it can also be seen that the volume of the reconstructed attractor in the phase space firstly increases with the excitation frequency and then decreases gradually after the peak about under 64 rad s which indicates that the dynamic behavior of the system is changeable it firstly diverges as the increase of the excitation frequency and then converges gradually after the excitation frequency 64 rad s therefore under the partial rub impact state the dynamic behavior of the system shows complex nonlinear dynamic characteristics involving quasi periodic and chaotic motion it goes through the evolution process from divergence to convergence as the increase of the excitation frequency 3 2 3 the no rub impact state fig 7 is the reconstructed attractors under the no rub impact state as can be observed from fig 7 all the reconstructed attractors display the limit cycle structure and with the increase of the excitation frequency the limit cycle is gradually reduced to a constant state as shown in fig 7 a j therefore under the no rub impact state the dynamic behavior of the system is dominated by periodic motion and it gradually evolves into a stable state as the increase of the excitation frequency 4 conclusion and future work in this paper the dynamic model of the ship stern shaft bearing system was established its dynamics response at the different excitation frequencies was calculated and investigated through this analysis we obtained the three different rub impact states in the system with the increase of excitation frequency full annular rub impact state partial rub impact state and no rub impact state then the attractor was introduced and the evolvement of the dynamic behavior of the system was revealed under different rub impact states the ship stern shaft bearing system shows abundant dynamic behaviors according to the change of the attractor s volume the convergence and divergence of the dynamical behaviors are revealed under the full annular rub impact state the periodic motion evolves toward an unstable state as the system enters the partial rub impact state the dynamic behavior is dominated by quasi periodic and chaotic motion and it goes through the evolution from divergence to convergence as the increase of the excitation frequency under the no rub impact state the dynamic behavior of the system is dominated by periodic motion and it gradually evolves into a stable state therefore the attractors which are constructed by calculated responses can not only reveal the evolution mechanism of dynamic behavior but also characterize the stability of the system under different rub impact states which is essential to identify the rub impact faults and to know the time history of the rub impact evolution from inception to the end in the next time to further verify the simulation results in this paper a multifunctional ship shafting test bed is building as shown in appendix c fig c 1 c 2 by the vibration response signal collected from the experiment the attractor of the system can be constructed and used in the study of the evolution of the dynamic behavior funding this present project is supported by the national natural science foundation of china grant no 51879020 and 51679022 ethics approval this article does not contain any studies with human participants or animals performed by any of the authors credit authorship contribution statement xiaoliang he conceptualization formal analysis writing original draft guobin li conceptualization formal analysis writing original draft hongpeng zhang formal analysis declaration of competing interest the authors declare that they have no known competing for financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a the previous research the experiments to analyzing the dynamics of a long sliding bearing which is similar to the stern tube bearing of a merchant ship were conducted in the friction and wear laboratory of the school of marine engineering dalian maritime university for details of this experiment please refer to the literature xing et al 2020 fig a 1 is the sliding bearing test bench and sensors used in this experiment fig a 2 is the attractors reconstructed from the extracted dynamic response of the sliding system under different states during the experiments it can be seen that the trajectory of the attractor in the phase space displays different structural features under different states which indicates that the sliding bearing system shows different dynamic behaviors the result shows that the attractor can identify the boundary friction mixed friction and liquid friction in the sliding system this experiment is helpful to the research of introducing attractor theory into a nonlinear system fig a 1 the sliding bearing test bench fig a 1 fig a 2 the attractors reconstructed from the dynamic response of the sliding bearing under different states a boundary friction b mixed friction c liquid friction fig a 2 appendix b the reference of the modeling referring to some real ships and shafting test beds as well as some ship designers instruction the parameters of the dynamic model in this paper were determined the diameter length as well as material of the shaft and bearings were chosen by some shafting test beds and the parameters of lubricating oil come from the commonly used marine lubricating oil besides considering there is no propeller in the test bed we have compared the propeller quality of different types of ships and consulted some engineers engaged in ship design apartment based on the data in the literature geng 2019 yang 2010 zhang 2019 and professional guidance fig b 1 we finally determined the reasonable parameters in table 1 fig b 1 some parameters in the literature fig b 1 appendix c the building multifunctional test bed fig c 1 and fig c 2 shows the building multifunctional ship shafting test bed the test bed consists of a slender shaft four sliding bearings a motor and a magnetic particle vibrator the resistance of the magnetic particle vibrator can be regulated by voltage which well simulates the condition of ship shafting under different loads fig c 1 the ship stern shaft bearing system test bed fig c 1 fig c 2 the real test bed fig c 2 
21550,the ship stern shaft bearing system is a typical nonlinear system and its dynamic behavior is complex in order to investigate the evolvement of dynamic behavior from the system the attractor theory is introduced based on the calculated dynamic responses of the established dynamic model the system s attractors were reconstructed and the evolvement of dynamic behaviors under different rub impact states was discussed the results show that under the full annular rub impact state the attractor of the system is limit cycle attractor and the volume of it increases gradually under the partial rub impact state the attractor of the system goes through the process of breaking the tours attractor into a chaotic attractor and then converging into a tour attractor and the volume of the attractor increases at first and then decreases under the no rub impact state the attractor of the system is limit cycle attractor and its volume decreases gradually these characters of attractors demonstrate that under different rub impact states the system has experienced periodic motion quasi periodic and chaotic motion the attractors also reveal the evolutions of convergence and divergence keywords ship stern shaft bearing system rub impact dynamic behaviors evolvement attractor 1 introduction rub impact is one of the common faults in the ship stern shaft bearing system han and lee 2019 huang et al 2019 lin et al 2019 yang 2010 zhang et al 2014 long term rub impact will cause the wear of the stern tube bearing and the increase of the gap between the bearing and the journal and even lead to the failure of the ship s propulsion shafting therefore it is essential to identify the rub impact faults and to know the time history of the rub impact evolution from inception to the end as is well known for all when rub impact occurs the rotor system can exhibit abundant dynamic behaviors such as periodic motion quasi periodic motion bifurcation and chaotic motion chouchane and amamou 2011 hou 2015 li et al 2010 liu et al 2013 shen et al 2008 wang et al 2013 2017 yang et al 2018 2017 shen and liu liu et al 2013 shen et al 2008 discovered the rub impact rotor presented complex periodic quasi periodic and chaotic motions and the results can apply to the diagnosis of rub impact rotor faults chouchane and li chouchane and amamou 2011 hou 2015 li et al 2010 discussed the nonlinear vibration characteristics of jeffcott rotor with rub impact and they found the period doubling bifurcation and hopf bifurcation in the system based on these researches some dynamic behaviors such as the existence of the bifurcation and chaotic motions can be used to judge whether a rotor system has a rub impact or not hua et al 2015 however when rub impact occurs the system could exhibit different dynamic characteristics such as approaching or deviating the steady state or a non steady state therefore to accurately assess the security of the system it is not enough to know the dynamic behavior exhibited by the rub impact but to reveal how it evolves unfortunately due to the lack of more effective analysis methods few studies have been undertaken to investigate the evolvement of dynamic behavior during the rub impact process thus it is essential to explore some new methods to discover the evolvement of dynamic behaviors during the rub impact process the attractor is a concept to characterize the dynamic behaviors of a system sun 2019 in the phase space the attractors represent the relatively stable parts of the system and they have an adsorption effect on other unstable points making the system generally tend to a stable state therefore the attractors contains a lot of critical information about the system moreover since the attractors are ubiquitous in dissipative systems it is appropriate to use them to describe the dynamic behaviors numerous studies have shown that the dynamic behavior of a system can be characterized by the phase space trajectory of attractor that is reconstructed from the time series signal oberst and lai 2015 2011 sui and ding 2018 oberst and lai oberst and lai 2015 2011 investigated the generation of significant amplitude vibrations in the noise performance of a brake system and they found its phase space dynamics evolution from a limit cycle over a torus regime to a low dimensional chaotic attractor sui and ding 2018 discussed the bifurcation behavior in a pad on disc frictional system utilizing attractors in the last years some experiments with analyzing the dynamics of a long sliding bearing which is similar to the stern tube bearing of a merchant ship has conducted in our lab xing et al 2020 there are some details of the experiment in appendix a fig a 1 a 2 the results show the attractor can identify the boundary friction mixed friction and liquid friction in the sliding system it demonstrated that the attractor can be useful in the nonlinear dynamic system therefore in this paper the attractor was introduced to investigate the dynamic behaviors of the ship stern shaft bearing system to reconstruct the attractor of the system a dynamic model of the ship stern shaft bearing system based on the oil film force and rub impact force was established and its dynamic responses under different excitation frequencies were calculated by using the runge kutta method the attractors of the ship stern shaft bearing system were reconstructed from the calculated dynamic responses by applying the takens theorem and the correlation integral method c c method the dynamic behaviors of the ship stern shaft bearing system were investigated by the reconstructed attractor 2 the calculation method of the dynamic response of the ship stern shaft bearing system 2 1 dynamic model in this paper the ship stern shaft bearing system with front and aft stern shaft bearings were used as the research object to investigate the dynamic response of rotor under the oil film force and rub impact force its dynamic model was established as shown in fig 1 in the model the excitation force was applied by equivalent mass at the same time only the transverse vibration of the system is considered and the influence of torsional vibration and the gyroscopic effect is ignored in fig 1 the m 1 is the equivalent lumped mass of the input the m 2 and m 4 are the equivalent lumped masses of the stern shaft at the front and aft stern bearing the nonlinear oil film force f and rub impact force p are applied on the two disks the m 3 is the equivalent lumped mass of the stern shaft between the two bearings m 5 is the equivalent lumped mass of output the disks are connected by massless elastic shafts based on the unsteady nonlinear oil film force model proposed by capone in 1991 geng 2019 the nonlinear oil film force f xi and f yi i 1 2 are calculated as follows at first the dimensionless oil film force in the x and y directions of the fixed rectangular coordinate system is calculated by eq 1 1 f x 3 a x v x y α a g x y α sin α 2 s x y α cos α f y 3 a x v x y α a g x y α cos α 2 s x y α sin α where 2 α tan 1 y 2 x x 2 y π 2 sign y 2 x x 2 y π 2 sign y 2 x 3 a x 2 y 2 y 2 x 2 1 x 2 y 2 4 g x y α 2 1 x 2 y 2 π 2 tan 1 y cos α x sin α 1 x 2 y 2 5 v x y α 2 y cos α x sin α g x y α 1 x 2 y 2 6 s x y α x cos α y sin α 1 x cos α y sin α 2 then the dimensional component of the oil film force in the x and y directions are 7 f x s p f x f y s p f y where s p μ n ω r l r c 2 l 2 r 2 s is the sommerfeld correction factor p is the half of the quality of the shaft segment at the bearing μ n is the lubricating oil viscosity c is the average thickness of the oil film r is the radius of the bearing l is the length of the bearing based on a jeffcott rotor model geng 2019 the rub impact force p xi and p yi i 1 2 are calculated as follows regardless of the heating effect of the friction the model of the rub impact force between stern shaft and bearing is shown in fig 2 where p r is the radial impact force p t is the tangential rub force θ is the angle between the radius vector at the contact point and the x axis ω is the rotation velocity of the rotor in this paper δ is the radial clearance of the stator r x 2 y 2 is the radial displacement of the rotor center deviating from the stator center and e is the mass eccentricity of the rotor the radial collision force between the rotor and stator is linear equivalent spring model and the tangential friction force is coulomb friction model so when r δ the collision force and the friction force are respectively 8 p r k r r δ p t f p r where k r is the radial stiffness of the stator f is the friction coefficient by decomposing the radial collision force and the tangential friction force the components p x and p y of the rub impact force in the horizontal and vertical directions are obtained therefore the rub impact force can be expressed in the rectangular coordinate system as 9 p x pr cos θ p t sin θ p y pr sin θ p t cos θ and it follows that 10 p x p y r δ k r r 1 f f 1 x y 2 2 dynamic equations according to the dynamic model of the ship stern shaft bearing system established in section 2 1 the dynamic equations of five mass rotor systems can be built according to newton s second law as shown in eq 11 11 m 1 x 1 c 1 x 1 k 1 x 1 x 2 m 1 e ω 2 cos ω t m 1 y 1 c 1 y 1 k 1 y 1 y 2 m 1 e ω 2 sin ω t m 1 g m 2 x 2 c 2 x 2 k 1 x 2 x 1 k 2 x 2 x 3 m 2 e ω 2 cos ω t f x 1 p x 1 m 2 y 2 c 2 y 2 k 1 y 2 y 1 k 2 y 2 y 3 m 2 e ω 2 sin ω t f y 1 p y 1 m 2 g m 3 x 3 c 3 x 3 k 2 2 x 3 x 2 x 4 m 3 e ω 2 cos ω t m 3 y 3 c 3 y 3 k 2 2 y 3 y 2 y 4 m 3 e ω 2 sin ω t m 3 g m 4 x 4 c 4 x 4 k 2 x 4 x 3 k 3 x 4 x 5 m 4 e ω 2 cos ω t f x 2 p x 2 m 4 y 4 c 4 y 4 k 2 y 4 y 3 k 3 y 4 y 5 m 4 e ω 2 sin ω t f y 2 p y 2 m 4 g m 5 x 5 c 5 x 5 k 3 x 5 x 4 m 5 e ω 2 cos ω t m 5 y 5 c 5 y 5 k 3 y 5 y 4 m 5 e ω 2 sin ω t m 5 g where ki i 1 3 is the bending stiffness of each shaft segment in fig 1 c i i 1 5 is the internal damping coefficient at the five equivalent disks e is the mass eccentricity of unbalanced excitation ω is the excitation frequency and g is the gravitational acceleration 2 3 system parameters in order to make the dynamic model closer to the actual ship stern shaft bearing system based on the literature geng 2019 yang 2010 zhang 2019 and some real data fig b 1 in appendix b the initial parameters of the ship stern shaft bearing system selected in this paper are shown in table 1 among them the five equivalent lumped masses in fig 1 are regarded as rigid thin disks without considering the thickness in this paper the runge kutta method was used in the software matlab to integrate eq 11 and the dynamic response of the ship stern shaft bearing system was computed to obtain the dynamic behaviors of the system under different rub impact states the range of excitation frequency was taken as 0 100 rad s the time step was set as 1 512 of the period and 2200 periods were simulated the data of the first 2000 periods were discarded and the results of the last 200 periods were taken for analysis 3 results and discussions 3 1 the analysis of the dynamic response and rub impact state 3 1 1 the analysis of the dynamic response based on the runge kutta method the dynamic response of the ship stern shaft bearing system in x and y directions can be obtained fig 3 shows the waveforms and spectrums of the dynamic response under three different excitation frequencies it can be seen that when the excitation frequency is 30 rad s the dynamic response of the system shows a periodic waveform and its spectrum is a single peak spectrum as shown in fig 3 a when the excitation frequency is 60 rad s the aperiodic waveforms appear in the dynamic response of the system and its spectrum shows a multiple peak spectrum as shown in fig 3 b when the excitation frequency is 90 rad s the dynamic response of the system returns to the periodic waveform but its spectrum shows a double peak spectrum despite a weak amplitude in the double frequency as shown in fig 3 c besides in fig 3 b the amplitude of the major frequencies in the x and y directions is also larger than that in fig 3 a and c the different time frequency characteristics of the dynamic response in fig 3 shows that when the excitation frequency is around 60 rad s the system s vibration is relatively intense when the excitation frequency is around 30 rad s and 90 rad s the operation of the system is relatively stable therefore the operating state of the system has changed under different excitation frequencies 3 1 2 the analysis of rub impact state according to the dynamic response of the system at the x and y directions the axial displacement r of the stern shaft under different excitation frequencies was calculated the axial displacement can indicate the degree to which the shaft deviates from its initial position during operation when the deviation is severe collision and friction will occur between the shaft and the bearing therefore in order to analyze the system s rub impact state fig 4 shows the maximum and minimum values of axial displacement and the bearing clearance δ is also given it can be found from fig 4 that with the increase of excitation frequency the axial displacement of the system display three stages large value stage i e r δ intermediate value stage i e r min δ r max and small value stage i e r δ according to the rub impact mechanism jiang and chen 2013 ma et al 2014 the variation in axial displacement indicates that the system could go through the different rub impact state and the specific analysis is as follows 1 large value stage as can be seen from fig 4 when the excitation frequency is under 0 51 8 rad s both the maximum and minimum values of shaft displacement exceed the bearing clearance which indicates that the shaft and bearing always stay in touch therefore the system is in a full annular rub impact state at the same time with the increase of excitation frequency both the maximum and minimum value of shaft displacement gradually decrease and they appear a tendency towards separation which means that the full annular rub impact is an unsteady dynamic behavior and it could evolve into a new state as the increase of excitation frequency 2 intermediate value stage when the excitation frequency reaches 51 8 rad s the maximum shaft displacement is greater than the average bearing clearance while the minimum value is less than the average bearing clearance which indicates that an intermittent contact occurs between the shaft and the bearing therefore the system is in a partial rub state moreover it can also be seen from fig 4 that in the excitation frequency ranges from 51 8 rad s to 76 rad s both the maximum and minimum values show a fluctuating state i e their changes are non stationary as the increase of excitation frequency which means that the partial rub impact is a complex and changeable dynamic behavior it could display different evolution as the increase of excitation frequency 3 small value stage when the excitation frequency is 76 100 rad s both the maximum and minimum values of shaft displacement are smaller than the bearing clearance which indicates that no contact occurs between the shaft and bearing therefore the system is in a no rub impact state at the same time with the increase of excitation frequency both the maximum and minimum value of shaft displacement tends to be pretty stable which means that in the no rub impact state the dynamic behavior of the system is stable and it could no longer evolve as the increase of excitation frequency the above analysis shows that with the increase of excitation frequency the ship stern shaft bearing system can present different rub impact states i e the full annular rub impact the partial rub impact and no rub impact which demonstrates that the system can perform different dynamic behaviors however it not clear how these dynamic behaviors evolve during the rub impact process 3 2 evolvement of dynamic behaviors in order to reveal the evolvement of dynamic behaviors during the rub impact process the attractors of the ship stern shaft bearing system were reconstructed by takens theorem sun et al 2015 and c c method hu and chen 2013 from the y direction displacement response under different rub impact states based on the attractors the evolvement of dynamic behaviors was discussed as follows 3 2 1 the full annular rub impact state fig 5 is the reconstructed attractors under the full annular rub impact state it can be found that the trajectory of all the attractors in the phase space displays the limit cycle structure which indicates that the dynamic behavior of the system is characterized by periodic motion moreover the limit cycle gradually increases with the increase of the excitation frequency as shown in fig 5 a j which indicates that the periodic motion is divergent and tends to become unstable therefore under the full annular rub impact state the dynamic behavior of the system is dominated by periodic motion and it evolves toward an unstable state as the increase of the excitation frequency 3 2 2 the partial rub impact state fig 6 is the reconstructed attractors under the partial rub impact state it can be seen that the reconstructed attractors under the partial rub impact state have a more complex structure in phase space than that under the full annular rub impact state with the increase of the excitation frequency they display the torus as shown in fig 6 a the broken torus as shown in fig 6 b the aperiodic orbits as shown in fig 6 c f the broken torus as shown in fig 6 g and the torus as shown in fig 6 h respectively the change of attractor s trajectory in phase space demonstrates that under the partial rub impact state the dynamic behavior of the system undergoes quasi periodic motion then enters into chaotic motion and finally returns to quasi periodic motion furthermore the entry and departure of chaotic motion are caused by the breaking of a quasi periodic torus as shown in fig 6 b and g in the meantime it can also be seen that the volume of the reconstructed attractor in the phase space firstly increases with the excitation frequency and then decreases gradually after the peak about under 64 rad s which indicates that the dynamic behavior of the system is changeable it firstly diverges as the increase of the excitation frequency and then converges gradually after the excitation frequency 64 rad s therefore under the partial rub impact state the dynamic behavior of the system shows complex nonlinear dynamic characteristics involving quasi periodic and chaotic motion it goes through the evolution process from divergence to convergence as the increase of the excitation frequency 3 2 3 the no rub impact state fig 7 is the reconstructed attractors under the no rub impact state as can be observed from fig 7 all the reconstructed attractors display the limit cycle structure and with the increase of the excitation frequency the limit cycle is gradually reduced to a constant state as shown in fig 7 a j therefore under the no rub impact state the dynamic behavior of the system is dominated by periodic motion and it gradually evolves into a stable state as the increase of the excitation frequency 4 conclusion and future work in this paper the dynamic model of the ship stern shaft bearing system was established its dynamics response at the different excitation frequencies was calculated and investigated through this analysis we obtained the three different rub impact states in the system with the increase of excitation frequency full annular rub impact state partial rub impact state and no rub impact state then the attractor was introduced and the evolvement of the dynamic behavior of the system was revealed under different rub impact states the ship stern shaft bearing system shows abundant dynamic behaviors according to the change of the attractor s volume the convergence and divergence of the dynamical behaviors are revealed under the full annular rub impact state the periodic motion evolves toward an unstable state as the system enters the partial rub impact state the dynamic behavior is dominated by quasi periodic and chaotic motion and it goes through the evolution from divergence to convergence as the increase of the excitation frequency under the no rub impact state the dynamic behavior of the system is dominated by periodic motion and it gradually evolves into a stable state therefore the attractors which are constructed by calculated responses can not only reveal the evolution mechanism of dynamic behavior but also characterize the stability of the system under different rub impact states which is essential to identify the rub impact faults and to know the time history of the rub impact evolution from inception to the end in the next time to further verify the simulation results in this paper a multifunctional ship shafting test bed is building as shown in appendix c fig c 1 c 2 by the vibration response signal collected from the experiment the attractor of the system can be constructed and used in the study of the evolution of the dynamic behavior funding this present project is supported by the national natural science foundation of china grant no 51879020 and 51679022 ethics approval this article does not contain any studies with human participants or animals performed by any of the authors credit authorship contribution statement xiaoliang he conceptualization formal analysis writing original draft guobin li conceptualization formal analysis writing original draft hongpeng zhang formal analysis declaration of competing interest the authors declare that they have no known competing for financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a the previous research the experiments to analyzing the dynamics of a long sliding bearing which is similar to the stern tube bearing of a merchant ship were conducted in the friction and wear laboratory of the school of marine engineering dalian maritime university for details of this experiment please refer to the literature xing et al 2020 fig a 1 is the sliding bearing test bench and sensors used in this experiment fig a 2 is the attractors reconstructed from the extracted dynamic response of the sliding system under different states during the experiments it can be seen that the trajectory of the attractor in the phase space displays different structural features under different states which indicates that the sliding bearing system shows different dynamic behaviors the result shows that the attractor can identify the boundary friction mixed friction and liquid friction in the sliding system this experiment is helpful to the research of introducing attractor theory into a nonlinear system fig a 1 the sliding bearing test bench fig a 1 fig a 2 the attractors reconstructed from the dynamic response of the sliding bearing under different states a boundary friction b mixed friction c liquid friction fig a 2 appendix b the reference of the modeling referring to some real ships and shafting test beds as well as some ship designers instruction the parameters of the dynamic model in this paper were determined the diameter length as well as material of the shaft and bearings were chosen by some shafting test beds and the parameters of lubricating oil come from the commonly used marine lubricating oil besides considering there is no propeller in the test bed we have compared the propeller quality of different types of ships and consulted some engineers engaged in ship design apartment based on the data in the literature geng 2019 yang 2010 zhang 2019 and professional guidance fig b 1 we finally determined the reasonable parameters in table 1 fig b 1 some parameters in the literature fig b 1 appendix c the building multifunctional test bed fig c 1 and fig c 2 shows the building multifunctional ship shafting test bed the test bed consists of a slender shaft four sliding bearings a motor and a magnetic particle vibrator the resistance of the magnetic particle vibrator can be regulated by voltage which well simulates the condition of ship shafting under different loads fig c 1 the ship stern shaft bearing system test bed fig c 1 fig c 2 the real test bed fig c 2 
21551,among various underwater ranging techniques received signal strength rss based ranging method enjoys great popularity because of its accessibility and low cost however this effective method encounters great performance challenges due to multipath phenomenon in this paper to accurately map rss values to distance in the multipath environment ray tracing method based on image sources is introduced into the urick propagation model in this way we can better obtain the relationship between rss and parameters containing distance in the new transmission model however since these parameters cannot be derived with only one rss measurement we utilize multiple rss measurements at different frequencies to calculate them moreover since the mapping problem between rss and distance is ill conditioned we construct additional inequalities based on prior information of the scene and then present an algorithm named interior point to solve the problem we analyze the proposed scheme to derive the lower bound and numerical simulation shows ranging error is minor and almost falls on the top of crlb the results in next simulations and experiment show the localization performance is close to the state of art method based on compressed sensing and ranging accuracy improves up to 2 times when compared to the conventional method keywords underwater distance measurement received signal strength multiple frequencies multipath effect transmission loss model 1 introduction in recent years underwater acoustic wireless sensor networks uawsn have received an increased interest in both civil and military applications such as environmental monitoring vehicle tracking and navigation wei 2012 localization problem has received a lot of attention naturally since it is a fundamental issue of uawsn this is because most of the sensed data in uawsn is meaningless or useless without location information chandrasekhar et al 2006 erol kantarci et al 2010 while global positioning system gps achieves distinguished success in terrestrial wsn it is not feasible to apply it to uawsn widely because gps signals cannot propagate well through water tan et al 2011 fortunately optical waves within the range of 450 550 nm wavelengths blue and green lights do not suffer excessive attenuation in the short distance hanson and radic 2008 uses a green laser with 532 nm wavelength to achieve the data rate of 1 gbps within 2 m wu et al 2017 uses a blue laser with 450 nm wavelength to provide a 7 2 gbps link with distance of 6 m in seawater as for localization saeed et al 2018 develops a low rank matrix approximation method to estimate the missing distance measurements and proposes a closed form convergent iterative solution to mitigate the effect of outliers saeed et al 2019 takes anchor uncertainty of position into account and derives the cramér rao lower bound crlb of error variance for 3d optical localization in addition with the development of underwater optical imaging technology the precise localization of abnormal and salient objects has been widely studied a quaternion number system and principal components analysis pca are combined to estimate a reliable saliency map for underwater images jian et al 2018a b to differentiate salient objects from complex background an algorithm based on discrete wavelet frame transform dwft and sparsity criterion is proposed jian et al 2018a b another optional carrier is acoustic signal which can propagate for longer distance with lower frequency acoustic localization technology can be divided into two categories range based and range free range free scheme utilizes connectivity information to estimate the area of target and it needs relatively high communication overhead or fixed infrastructure chandrasekhar and seah 2007 proposes a coarse grained localization technique called area based localization scheme als in which the sensors save locations of reference nodes and their corresponding transmitted power levels and then identify the area with received signals and its three dimensional version is proposed by zhou et al 2009 a multidimensional scaling mds localization algorithm based on cluster structure is proposed to reduce the computational complexity and improve average location accuracy moorits and jervan 2010 range based schemes are based on some measured metrics which are time of arrival toa diamant et al 2012 time difference of arrival tdoa xu et al 2014 and angle of arrival aoa luo et al 2017 and then a maximum likelihood algorithm or trilateration method is used to calculate the position of the receiver however these schemes require high precision timing synchronization protocol or sensor arrays which require high cost and energy consumption hence they are not really suitable for the applications in uawsn environment in addition due to the multipath phenomena and background noise the transmitted signal is usually impaired hence all of localization schemes proposed contribute to deal with these problems a popular and widely used ranging metric which is sometimes treated as a low hanging fruit and can be combined with the other ranging metrics is the received signal strength rss assume that there are strong signal sources in an area the rss at different position within the area should be different according to the different distance from the signal sources so the fundamental principle of rss based ranging approaches is that the receiver can map the rss to the corresponding distance xu et al 2016 the measurement for rss is easy and convenient to obtain while the mapping of rss to distance accurately is challenging even though according to the theoretical rss path loss models rss decreases monotonically with increasing distance from the signal source in practice the mapping of rss back to distance is error prone due to the signal interference from multipath and channel noise caused by environmental changes especially under the water hence this mapping becomes academic key research issue naturally in order to improve the accuracy of this mapping several research works have been conducted which can be divided into two categories fingerprinting and transmission models rss based fingerprinting scheme requires an offline training step to put rss distance mapping information into a database during ranging the observed rss will be looked up against the database for the associated distance in lee et al 2009 during the offline training step the receiver collected amplitude modulation am acoustic signals at some sampling locations with given coordinates converted it from time domain to frequency domain stored it as rss information associated with the receiver s locations in the database after applying a median filter in the online step the location of the target can be estimated in real time by comparing the observed rss with the mapping information in the database using the maximum likelihood ml method liao et al 2018 obtains the rss information from the channel state information csi defined as the channel frequency response at several subcarrier frequencies an acoustic field program called waymark simulator henson et al 2014 was applied in order to compute the mapping between coordinates of interested area and rss in csi to obtain a grid map database during the ranging the receiver processes received pilot modulated signals to obtain the csi and then location is estimated by finding the best match within the csi distance grid map database however rss based fingerprinting model liu et al 2012 has two major shortcomings firstly the construction of the database needs detailed rss position on the grid map in advance which is difficult to implement in practice secondly the database is not reliable because of the dynamic underwater environment the rss based transmission scheme needs to find the relationship between the distance and rss based on transmission model in which channel features are usually utilized the urick propagation model brekhovskikh et al 1991 is widely used for the modeling of the underwater transmission loss tl because the model equation is difficult to solve analytically newton raphson method is normally used however newton raphson method results in calculation inefficiency and computation instability to solve this problem hosseini et al 2014 presented a conversion method by expressing the urick propagation model via the lambert w function wang et al 2013 introduced a novel semidefinite programming sdp method to convert the optimization problem into a convex one so that the global minimum standing for the location estimated can be obtained however all these transmission model based rss schemes do not consider the multipath effect which is the prominent phenomena in shallow water and this leads to poor ranging performance in practice in addition these researches tend to assume that the rss measurements obey a certain distribution gaussian distribution normally which is over idealistic actually in this paper we focus on finding a ranging scheme with only limited rss measurements by utilizing the feature that the rss measurements are considerably different at different frequencies due to the multipath effect this is because each signal with different frequency will propagate from the transmitter to the receiver along the same multipath however different frequencies affect the received signal phase of sub paths differently which leads to the change in the constructive destructive relations between signals from different paths to our best knowledge it is the first time we utilize the frequency information to make the mapping problem solvable and achieve more accurate ranging performance the main contributions of this paper are as follows 1 ray tracing based on image sources koutsouris et al 2013 is introduced into the urick propagation model in order to accurately map rss values to physical distance in multipath environment we can then obtain the relationship between parameters in the transmission model and rss for given frequencies 2 the distance cannot be derived with only one rss measurement according to the above multipath transmission model to solve this problem we find signal at different frequency propagates from the transmitter to the receiver along the same multipath with various received signal phase and then utilize this frequency diversity to provide additional information 3 since the mapping from rss to physical distance is error prone and has non linear relationship we propose a system of constraint inequalities based on prior information of the scene and practical considerations and then present an algorithm named interior point to solve it in order to validate our concept we analyze the proposed method and derive its crlb and find ranging error almost falls on the top of crlb we then perform simulations using bellhop underwater acoustic simulator qarabaqi and stojanovic 2013 and do experiments in a lake we found that the accuracy of proposed method is close to that of the state of art method based on compressed sensing and it improves up to 2 times when compared with the conventional method based on simple urick model in the practical environment the remainder of this paper is organized as follows section 2 introduces the transmission loss model based on a method of ray tracing with image sources using physical formulations section 3 defines the fitting problem and shows how to use interior point algorithm to solve it section 4 presents some treatments based on practical considerations to improve final performance section 5 evaluates the performance in the perspective of ranging and localization by numerical simulation bellhop simulator and lake experiment section 6 presents the conclusion of our work 2 transmission model based rss considering multipath effect with multiple frequencies in this section we introduce the attenuation characteristics of an acoustic signal in underwater environment and describe how to model multipath effect in this given environment all symbols used in this article are summarized in table 1 2 1 the basic urick model acoustic propagation describes the behavior of acoustic waves when they are transmitted from the transmitters to the receivers during the propagation the power of acoustic waves decreases as the distance increases brekhovskikh et al 1991 an acoustic signal of frequency f traveling over distance l experiences the basic path loss and the received signal power is given by 1 a l f a 0 l k a f l where a 0 is a scaling constant k is the spreading factor used for describing the geometry of propagation and its normal values are from 1 to 2 for cylindrical and spherical spreading respectively the absorption coefficient a f can be obtained from the thorp s empirical formula thorp and william 1967 in the unit of in decibels per kilometer as follows 2 a f 0 11 f 2 1 f 2 44 f 2 4100 f 2 2 75 10 4 f 2 0 003 2 2 ray tracing method based on image sources for multipath effect in shallow water propagation signals from the source can be received at the receiver from different paths except the line of sight los path any signal rays that bounce off the water surface between the water and the air and the floor between the water and the ground are called non line of sight nlos paths the choppy water surface and the varying floor make it difficult for the accurate and efficient calculation of eigenray in this paper we assume that the water boundaries are flat and the water medium is homogeneous we model ray tracing at such circumstance based on the concept of image sources in optics and determine the length and reflection coefficient of each sub path as shown in fig 1 in order to describe the reflections of the rays we consider these rays as optical rays emitted from the corresponding image sources based on specular reflection theory koutsouris et al 2013 we mark the number of reflections from the water surface as n s and the number of reflections from the bottom as n b respectively based on simple geometric knowledge we conclude that if n b is given and greater than 1 the value range of n s can be determined from 4 different reflection cases as n b 1 n b n b n b 1 we define the case index i 1 2 3 4 to label the four cases respectively as shown in fig 1 the two red lines denote special cases when n b 0 in particular los path r 0 3 corresponds to n b n s 0 one sea surface reflection r 0 4 indicates n b 0 n s 1 if n b is given the length of sub path r n b i and its grazing angle θ n b i defined as the angle between the emission direction and the positive half of the z axis can be obtained by the formula below 3 r n b 1 d 2 2 n b h h t h r 2 θ n b 1 sin 1 d r 1 n s n b 1 r n b 2 d 2 2 n b h h t h r 2 θ n b 2 sin 1 d r 2 n s n b 1 r n b 3 d 2 2 n b h h t h r 2 θ n b 3 sin 1 d r 3 n s n b 1 r n b 4 d 2 2 n b h h t h r 2 θ n b 4 sin 1 d r 4 n s n b 1 where h t and h r are the height of transmitter and receiver above the sea floor respectively h is the total depth in this environment and d is horizontal distance between two nodes the second line of equation 3 corresponds to the case where the sea surface reflection precedes the sea floor reflection the third line represents the opposite circumstance based on the principle of reciprocity due to the significant difference between the acoustic impedance of the aqueous medium and the air medium the water surface reflection coefficient is much larger coates 1988 especially the sea water when an acoustic wave travels from water on the boundary with air it will undergo a total internal reflection that means the reflection coefficient γ s 1 for convenience we mark the total number of sub paths solved by image sources method as n p the length of each sub path as l p where p 1 2 n p n p 4 n b 2 and its corresponding grazing angle as θ p according to equation 4 the bottom reflection coefficient of each path can be calculated as follows 4 γ b θ p ρ b sin θ p ρ c c b 2 cos 2 θ p ρ b sin θ p ρ c c b 2 cos 2 θ p cos θ p c c b 1 cos θ p c c b where ρ and c are the density of water and the speed of acoustic wave in water ρ 1000 kg m 3 and c 1500 m s nominally and ρ b and c b are the density of bottom and the speed of acoustic wave in bottom 2 3 transmission model with multipath effect with formulas 1 4 the transfer function h p f for the p th sub path can be modeled as 5 h p f γ p a l p f where γ p is the reflection coefficient along the p th sub path considering the different path phases the superimposed signal at the receiver is a summation of complex numbers liu et al 2016 hence the overall transfer function in the multipath environment can be obtained as follows 6 h f p h p f e j 2 π f τ p where τ p is the propagation time difference compared to the los path and it can be obtained by the relationship τ p l p l 1 c the theoretical value of the transmission loss at the receiver is 7 t l f h h t d h r 20 log h f where h t and h r are the height of transmitter and receiver above the floor e g sea floor respectively h is the total depth in this environment d is horizontal distance between two nodes f is frequency used for transmission 3 location estimation algorithm 3 1 objective function from equations 1 7 we can obtain the relationship between rss and h t h h r d for a given frequency f the most important parameter d can be obtained from solving equation 8 below 8 t l f h h t d h r t l f however it is not possible to solve equation 8 just for a selected frequency f because the number of equations is less than the number of critical variables in order to solve this problem we need to create equation 8 in multiple frequencies the received rss measurements at different frequencies t l f j j 1 2 m allow us to establish a set of equations as follows 9 t l f j h h t d h r t l f j however equation 9 may be overdetermined the number of unknowns is less than the number of equations and cannot be solved because of measurement error we can look at this problem in a different angle and treat it as a fitting problem by fitting the outputs of the transmission model as close as possible to the practical measurements under the least mean square error criterion the objective function is defined as follows 10 min x r 4 f x 1 2 j 1 m t l f j t l f j x 2 where the four dimensional position vector x consists of the environmental parameters h t h h r d it is difficult to solve equation 10 analytically because it contains sub items such as squares square roots trigonometric functions and so on thus we use numerical methods to find approximate solutions of the problems since the objective function is not well formed it is difficult to get a satisfying solution from classical numerical method techniques liu et al 2016 the position vector x needed to be solved has additional physical constraints for example considering the intrinsic relationship of the four dimensional position vector x we find that 0 h t h and 0 h r h because transducers only work normally under the water to improve the ranging performance we suggest a way of constructing the constrained inequalities g x based on prior information which will be introduced in detail in section 4 after this treatment the problem is defined as constrained nonlinear optimization fitting problem 3 2 interior point algorithm we then numerically solve for optimal position vector using the interior point approach the original problem can be abstracted as 11 min x r 4 f x 1 2 j 1 m t l j t l f j x 2 s t g x 0 where g x is the constrained inequalities based on prior information discussed in section 4 now a barrier function is introduced in order to convert the original inequality constrained problem to a sequence of equality constrained problems shown below in the variables x and s i 12 min x s i f μ x s i min x s i f x μ i ln s i subject to g x s i 0 where μ 0 by default and there are as many slack variables s i as inequality constraints g x the value of s i are implicitly assumed to be positive as the value of μ decreases to zero the logarithmic term called a barrier function approaches zero so that the minimum of f μ x s i approach the minimum f more details about this method is described in byrd et al 1999 2000 to solve the easier problem shown in equation 12 the algorithm selects one of two main types of steps at each iteration the first one is named as a direct step which attempts to solve the karush kuhn tucker kkt conditions via a linear approximation the other step is a conjugate gradient cg step using a trust region the details and derivation of this step are described in waltz et al 2006 by default the interior point algorithm first attempts to take a direct step for the sake of less computational complexity now we need to determine the most appropriate step length a merit function based on equation 12 is constructed at each iteration and is typically defined as follows 13 x s γ f μ x s γ g x s where γ 0 is a penalty parameter to balance the relative contribution of the objective function and constraints waltz et al 2006 and it should be large enough to force the solution towards feasibility if the value of the merit function decreases in an attempted step the algorithm accepts the attempted step otherwise it attempts a different shorter step in order to obtain a suitable step length the iteration continues until certain criteria are satisfied for example the number of iterations exceeds the default threshold or change in the objective function value is small enough say x s γ ε ε 10 6 when the criteria are satisfied the solution to the problem is a local solution containing our target horizontal distance d 4 additional constraints of the proposed algorithm as mentioned in section 3 because the four unknown parameters in equation 10 jointly affect the final function value the solution is not stable and trustable enough to tackle this problem additional information in the form of g x 0 in equation 11 is needed in this section we will present how to use prior information to construct constraints and how to reduce computational cost based on physical considerations 4 1 limiting the number of image sources in the model according to the image sources method we can calculate the coordinate of image sources iteratively each of which corresponds to a specific sub path hence there are infinite image sources theoretically however additional image sources are getting farther and farther away from the receiver as the number of iterations increases this leads to less and less contribution to the acoustic field that s to say we can limit its number to a reasonable range without sacrificing too much accuracy what s more for typical geological formation of the seabed such as soft mud fine sand etc the reflection coefficient is around 0 5 or less depending on the directional property of the surface and the grazing angle frisk et al 1980 hence more than 96 8 percent of the energy in each nlos path will be consumed during the propagation if the times of sea floor reflections exceed 5 this means these nlos paths can be ignored without sacrificing too much accuracy in the shallow water environment the nlos path will not be extremely much longer than the los path for the sake of simplicity the reflection coefficient is considered to be the only basis for filtering out the nlos path with less energy based on considerations above we set the minimum normalized power threshold to 5 the maximum number of sea floor reflections to 5 4 2 prior information about the practical environment initial value of iterations is an important issue as for optimizing the target function which motivates us to find the upper bound and lower bound of the unknowns at each iteration considering the intrinsic relationship of the four dimensional position vector x we find that h t h and h r h because transducers only work well under the water another consideration is surface variation caused by the wind and location uncertainty displacement of the transmitter the maximum height offsets of the surface and the transmitter are recorded as δ h and δ h t respectively hence the range of them are h δ h h δ h and h t δ h t h t δ h t respectively 4 3 minimum required frequency channels because the number of the unknowns is four in equation 9 the solution to the fitting equation 11 exists only when m 4 this means that we should utilize 4 channels at least in simulations or practical experiments although ray tracing theory is a very effective method for the study of acoustic propagation in inhomogeneous media such as the ocean its applicable condition is at sufficiently high frequencies thorp and william 1967 confined to the frequency response characteristics of the transducers and the sampling rate of the data acquisition card the available frequency range is 20 25 khz in order to avoid the mutual interference we divide the frequency band into 21 channels at most 5 performance evaluation in this section we first numerically analyze the proposed scheme and find it achieves small ranging error which falls on the top of crlb nearly after that we analyze the impact of unique internal factors in our model on ranging by bellhop simulator and then we compare the performance of proposed method with other conventional state of art methods in ranging and localization lastly we conduct an experiment in a lake to prove the proposed method is useful and effective and discuss its advantages and demerits 5 1 numerical analysis in order to find a benchmark for the proposed algorithm crlb for the optimization problem in equation 10 is derived based on equation 1 the rss t l f j measured at the same distance l using different frequency component f j j 1 2 m can be given by 14 t l f j 10 k log l a f l n f j different from other literatures zhang et al 2016 where the additional noise term n f j obeys an independent and identically distributed iid zero mean gaussian distribution we set n f j n μ f j σ 2 after considering the significant impact of frequency on rss although a f is a function of f a f increase slightly when f increases from 20 khz to 25 khz for the sake of simplicity we have a f 1 m j 1 m a f j for all the frequencies similarly μ f j is a complex equation about f and the first order taylor series expansion is used to approximate it that s to say μ f j μ 0 μ 0 f j μ 0 0 refresh formula 14 15 t l f j 10 k log l a f l μ 0 f j w f j for the sake of description we mark 10 k log l a f l as a and μ 0 as b the final expression is 16 t l f j a b f j w f j where a and b are unknown constants w f j obeys an iid zero mean gaussian distribution with variance σ 2 w f j n 0 σ 2 the fisher information matrix can be calculated as 17 i θ ˆ e 2 ln p f j θ ˆ a 2 e 2 ln p f j θ ˆ a b e 2 ln p f j θ ˆ b a e 2 ln p f j θ ˆ b 2 where θ ˆ a b t and the likelihood function p f j θ ˆ is 18 p f j θ ˆ j 1 m 1 2 π σ exp 1 2 σ 2 t l f j a b f j 2 1 2 π σ 2 m 2 exp 1 2 σ 2 j 1 m t l f j a b f j 2 the first order derivatives of this likelihood function can be derived as follows 19 ln p f j θ ˆ a 1 σ 2 j 1 m t l f j a b f j ln p f j θ ˆ b 1 σ 2 j 1 m f j t l f j a b f j the second order derivatives are given as follows 20 2 ln p f j θ ˆ a 2 m σ 2 2 ln p f j θ ˆ a b 1 σ 2 j 1 m f j 2 ln p f j θ ˆ b 2 1 σ 2 j 1 m f j 2 the fisher information matrix is 21 i θ ˆ 1 σ 2 m j 1 m f j j 1 m f j j 1 m f j 2 due to j 1 m j m m 1 2 and j 1 m j 2 m m 1 2 m 1 2 f j a j b if we select the frequencies with equal difference the inverse of fisher information matrix is 22 i 1 θ ˆ 2 σ 2 a 2 m 3 a 2 m 2 a 2 m 2 3 a 2 m a 2 6 a b m 6 b 2 3 a 2 b a m 3 a 2 b a m 6 the crlb of θ ˆ is 23 var a ˆ i 1 θ ˆ 1 1 var b ˆ i 1 θ ˆ 2 2 specially there is negative correlation between the first element i 1 θ ˆ 1 1 and the used number of frequencies m hence the crlb of l will decrease when m increases and this conclusion will be shown in the numerical simulation 5 2 numerical simulation in this section simulation is conducted to study the impact of measurement noise and the used number of frequencies on distance estimation as for this simulation a 0 25 b 19 75 m 5 21 61 b 0 02 k 1 5 the expected distance l 30 and the measurement noise with variance σ 2 0 1 0 2 1 db the root mean square error rmse is calculated by monte carlo simulations with an average of about 2000 distance estimations zhang et al 2016 as shown in fig 2 crlb for m 5 21 61 increases with the variance of measurement noise and it decreases slightly when the number of used frequencies has an increment and we can find that both urick method and proposed method show deteriorating performance with the increase of noise variance furthermore whatever the used number of frequencies is proposed method achieves lower localization error which falls on the top of crlb nearly which shows the proposed method has a significant improvement in performance compared with the urick method 5 3 simulation experiments through the numerical simulation we know that if the environment can be ideally modeled as formulas with additive noise proposed method can reach the crlb however there are inevitable random channel variations in practice such as location uncertainty varying environment complex scattering and motion induced random doppler shift resulting from surface waves or transmitter receiver drifting in order to verify the stability of proposed method we perform simulation experiments using bellhop simulator for uawsn channels qarabaqi and stojanovic 2013 the simulator tool has outstanding performance in predicting communication system s property before deployment and it requires a series of parameters during the initialization phase the spreading factor k was set to 1 5 for typical shallow water environment the speed of acoustic wave in water c and near the sea floor c b was set to 1500 m s and 1480 m s respectively the densities of the water mediums in general and near the sea floor were ρ 1400 kg m 3 and ρ b 1400 kg m 3 respectively the surface height h 0 was set to 3 m the transmitter height h t 0 was set to 2 m the receiver height h r 0 was set to 2 m the height offsets of surface and transmitter obeyed a gaussian distribution with the mean μ of 0 and a standard variance σ of 0 1 the theoretic horizontal distance d 0 for testing was set from 50 m to 300 m with interval of 50 m we used a set of frequencies from 5 khz to 30 khz with the resolution δ f of 2 5 hz the total time of simulation was set to 60 s with the resolution δ t of 0 05s the rest of the parameters were consistent with those in the source code qarabaqi and stojanovic 2013 the output of bellhop simulator was a corresponding transfer function which could be used to calculate the tl at each frequency we chose 20 25 khz as our frequency band at which the acoustic transducers were available typically and divided it into 21 frequencies by default 5 3 1 prior knowledge about the environment prior knowledge about the environment is important to the calculation of distance we obtained the values of rss at different frequencies in order to establish a set of equations 9 and 10 for solving for the unknown parameters x and d in our model the initial value of x is set to h t 0 h 0 h r 0 d 0 other environmental parameters such as k c c b are the same as those set in the bellhop simulator we first solved for x using the basic constraints of x 0 and h t h r h this case is called no prior information pi 0 scenario if there is additional prior knowledge about these four parameters in a specific environment for example the range of the water s depth has been measured in advance then an additional inequality h 0 3 σ h h 0 3 σ will be introduced this case is called single prior information pi 1 scenario furthermore if the variety of the transmitter s height is known which is easily obtained in practice due to the wide application of bathometers two extra inequalities h t 0 3 σ h t h t 0 3 σ h 0 3 σ h h 0 3 σ will be introduced this case is called double prior information pi 2 scenario fig 3 shows the effect of prior knowledge on ranging performance similarly rmse is used to quantify the deviation of the distance d calculated using our model from the real values since the ranging error is usually related to distance we use ranging error ratio 100 rmse d 0 to evaluate the ranging performance from our simulation the average ranging error ratio is 86 38 when pi 0 if we use the prior information about the environment to establish the inequalities mentioned in equations 9 and 10 the performance will be the best about 10 63 on average when pi 2 based on these results we suggest that more practical information about these four parameters is needed 5 3 2 the impact of the number of used frequencies fig 4 compares the ranging error with different number of frequencies m 4 5 11 21 respectively the basic constraint inequalities the two additional constraints h t h t 0 3 σ h 0 3 σ h h 0 3 σ and the initial value x h t 0 h 0 h r 0 d 0 are the same as mentioned before moreover the frequency range of them is identical while the interval between adjacent frequencies is different we find that proposed method has the largest average ranging error ratio around 15 16 when m 4 if we increase the number of used frequencies the average ranging error ratio is changing from 10 03 to 8 93 and then to 10 63 even though there are little difference between ranging performance of the last three simulations m 5 11 21 we suggest using more frequencies if possible this is because the practical measurements may fail at some frequencies due to environmental factors thus we should try to use more frequencies to make the proposed method more robust in practical underwater environment 5 3 3 ranging performance compared with conventional method we use bellhop simulator to generate channel information and select 21 frequencies with full prior knowledge about the environment to estimate the distance as for urick method we use formula 1 with center frequency information to calculate the distance as shown in fig 5 the ranging error ratio of proposed method varies from 2 to 22 while that of urick method is at least higher than 27 5 3 4 localization performance compared with conventional state of art method to compare proposed method with the conventional method based on urick model and an state of art method based on compressed sensing cs dong et al 2019 for localization we design a medium scale region covering an area of tens of thousands of square meters with six reference nodes blue triangle distributed around the target black pentagram from 50 m to 300 m respectively and then use the same 200 sets of rss information from bellhop simulator as the input of ranging lastly the trilateration algorithm yang and liu 2009 is introduced to locate the target following the idea based on cs we divide the region into 40 50 grids the resolution of grid is 10 m and locate the target on a nearby grid point as shown in fig 6 a the positioning result green dot of proposed method is tightly wrapped around the target in fig 6 d most of output of the state of art method is the red dot the horizontal dilution of precision hdop is introduced to evaluate the localization performance in a two dimensional plane hdop is defined by the mean error of euclidean distance between estimated location x ˆ y ˆ and the true location x y 24 hdop 1 n i 1 n x x i ˆ 2 y y i ˆ 2 in this simulation hdop is calculated to be 9 3601 for proposed method and hdop 85 8468 hdop 9 1906 for the conventional and state of art method respectively obviously proposed method performs better than the conventional method and it has the same performance as the state of art method in terms of localization 5 4 practical experiments 5 4 1 experimental setup as shown in fig 7 a our localization scheme is deployed in the jingye lake located at the campus of tianjin university tianjin china where due to the limitation of lake size the scale of experiment is smaller than the simulation the dimension of the lake is about 130 m l 70 m w 5 m d our mission is to locate the target at the northwest corner of the pavilion red pentagram four reference nodes blue triangles which are about 10 m 30 m 50 m 70 m away from the target respectively are deployed along the shore a complete set of equipment from b k company is used in the experiment which includes five b k 8104 hydrophones one power amplifier with type of 2713 and four 3050 a 040 daq data acquisition cards additionally the notebook pc installed with b k official software is used for controlling the instruments data storage and localization considering the shallow depth of the lake and the frequency response characteristics of the hydrophones we set the transmitted frequency ranging from 20 0 to 25 0 khz with the interval of adjacent frequencies of 250 hz the wavelengths of these acoustic monophonic signals are on the order of centimeter and the wavelength difference between adjacent frequency signals is much smaller than 0 07 cm the duration of the signal at each frequency used for transmission is 30 ms while the time interval between the frequencies should be large enough to mitigate the effects of multipath expansion and we set it to 120 ms as shown in fig 8 a the initial signal strengths at all frequencies are the same in the experiment the target node transmitter sends the signal every 5 s the data acquisition cards reference nodes collect the received signals and deliver them to the pc at the sampling frequency of 131 072 khz in which the signals frequency is analyzed and the tl is calculated as shown in fig 8 b the values of rss measured at each frequency are different the difference in the values of rss can be up to 20 db this demonstrates the significance of phase for the total signals the reason why the rss at different frequency is different is that even though different frequency signals propagate from the transmitter to the receiver along the same multipath each different frequency affects the received signal phase of sub paths differently this leads to the change in the constructive destructive relations among signals from different paths 5 4 2 performance of ranging localization experiment in the lake after acquiring the experiment data we use proposed method and urick method to estimate the distance between the target and four reference nodes shown in fig 7 a rmse is calculated to evaluate the ranging performance as shown in fig 9 the average ranging error ratio is 10 65 by proposed method and 39 62 by urick method respectively hence proposed method reduces the ranging error by at least 50 compared to the urick method after we performed the ranging calculation for each reference node using proposed method we estimate 2 dimensional position of the target in the lake by applying the basic trilateration algorithm in this experiment fig 10 the value of hdop for proposed method and for the conventional method are 11 2291 and 18 9536 respectively this shows that the localization accuracy improves almost 200 percent another observation is that the performance is better when the target is in the area enclosed by the reference nodes and it is the best when the target is at the center of the region joel et al 2016 hence localization accuracy can be improved further if we try to adjust the structure of the reference nodes this will be tested and discussed in our future work as for the advantages of the proposed method it does not need extra hardware and can reduce cost and power consumption because it is based on rss another distinguished advantage is that we utilize the multiple frequency information to achieve more accurate ranging performance comparable to the state of art method in the other hand proposed method also needs to be improved firstly to obtain the effective rss from the received signal containing measurement noise the signal to noise ratio should be large enough so the range of this scheme may be limited secondly due to the random movements of surface or aquatic organisms we will meet with link failure or measurement outliers which will degrades the ranging performance if ignored finally although using many frequencies can improve the ranging performance we cannot use too many channels because this will cause calculation cost increasing we need to balance them 6 conclusion in this paper we propose a novel ranging method in the uawsn environment with limited hardware to reduce cost and power consumption we model the impact of multipath phenomenon on rss measurements and find the conventional urick model is too simple to convert the measured rss to the corresponding distance accurately in order to deal with this problem most of the existing works tend to start from a statistical point of view and introduce an additional term which obeys the gaussian distribution unfortunately this assumption may be not practical under the water we abandon this approach and introduce a ray tracing method based on image sources into the urick propagation model to accurately map rss values to physical distance we utilize rss measurement at different frequencies to make the system of inequalities solvable however the solution is not stable and trustable enough because the problem is non liner and ill conditioned to deal with this issue we construct constraints based on prior information of the environment and then present a numerical algorithm named interior point to solve it the numerical simulation show ranging error almost falls on the top of crlb in all cases the medium scale simulation based on bellhop simulator shows that the average localization errors of this paper is very close to that of the state of art method both of them are within 9 m compared to around 86 m using conventional method in the small scale lake experiment the average ranging error ratio is below 10 and localization error is within 11 m on average compared to 39 and 19 m by using conventional method hence both ranging and localization results show that proposed method is superior to the conventional method and its performance is close to the state of art method based on compressed sensing credit authorship contribution statement quan tao methodology writing original draft writing review editing yu cao conceptualization methodology boonsit yimwadsana methodology xiaomei fu methodology writing review editing funding this research was supported in part by national natural science foundation of china grant no 61571323 and in part by the talented young scientist program of ministry of science and technology people s republic of china and the ministry of science and technology thailand thailand 19 001 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge school of marine science and technology for providing b k equipment and we thank the anonymous reviewers for their constructive comments appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 multimedia component 11 multimedia component 11 multimedia component 12 multimedia component 12 multimedia component 13 multimedia component 13 multimedia component 14 multimedia component 14 multimedia component 15 multimedia component 15 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107772 
21551,among various underwater ranging techniques received signal strength rss based ranging method enjoys great popularity because of its accessibility and low cost however this effective method encounters great performance challenges due to multipath phenomenon in this paper to accurately map rss values to distance in the multipath environment ray tracing method based on image sources is introduced into the urick propagation model in this way we can better obtain the relationship between rss and parameters containing distance in the new transmission model however since these parameters cannot be derived with only one rss measurement we utilize multiple rss measurements at different frequencies to calculate them moreover since the mapping problem between rss and distance is ill conditioned we construct additional inequalities based on prior information of the scene and then present an algorithm named interior point to solve the problem we analyze the proposed scheme to derive the lower bound and numerical simulation shows ranging error is minor and almost falls on the top of crlb the results in next simulations and experiment show the localization performance is close to the state of art method based on compressed sensing and ranging accuracy improves up to 2 times when compared to the conventional method keywords underwater distance measurement received signal strength multiple frequencies multipath effect transmission loss model 1 introduction in recent years underwater acoustic wireless sensor networks uawsn have received an increased interest in both civil and military applications such as environmental monitoring vehicle tracking and navigation wei 2012 localization problem has received a lot of attention naturally since it is a fundamental issue of uawsn this is because most of the sensed data in uawsn is meaningless or useless without location information chandrasekhar et al 2006 erol kantarci et al 2010 while global positioning system gps achieves distinguished success in terrestrial wsn it is not feasible to apply it to uawsn widely because gps signals cannot propagate well through water tan et al 2011 fortunately optical waves within the range of 450 550 nm wavelengths blue and green lights do not suffer excessive attenuation in the short distance hanson and radic 2008 uses a green laser with 532 nm wavelength to achieve the data rate of 1 gbps within 2 m wu et al 2017 uses a blue laser with 450 nm wavelength to provide a 7 2 gbps link with distance of 6 m in seawater as for localization saeed et al 2018 develops a low rank matrix approximation method to estimate the missing distance measurements and proposes a closed form convergent iterative solution to mitigate the effect of outliers saeed et al 2019 takes anchor uncertainty of position into account and derives the cramér rao lower bound crlb of error variance for 3d optical localization in addition with the development of underwater optical imaging technology the precise localization of abnormal and salient objects has been widely studied a quaternion number system and principal components analysis pca are combined to estimate a reliable saliency map for underwater images jian et al 2018a b to differentiate salient objects from complex background an algorithm based on discrete wavelet frame transform dwft and sparsity criterion is proposed jian et al 2018a b another optional carrier is acoustic signal which can propagate for longer distance with lower frequency acoustic localization technology can be divided into two categories range based and range free range free scheme utilizes connectivity information to estimate the area of target and it needs relatively high communication overhead or fixed infrastructure chandrasekhar and seah 2007 proposes a coarse grained localization technique called area based localization scheme als in which the sensors save locations of reference nodes and their corresponding transmitted power levels and then identify the area with received signals and its three dimensional version is proposed by zhou et al 2009 a multidimensional scaling mds localization algorithm based on cluster structure is proposed to reduce the computational complexity and improve average location accuracy moorits and jervan 2010 range based schemes are based on some measured metrics which are time of arrival toa diamant et al 2012 time difference of arrival tdoa xu et al 2014 and angle of arrival aoa luo et al 2017 and then a maximum likelihood algorithm or trilateration method is used to calculate the position of the receiver however these schemes require high precision timing synchronization protocol or sensor arrays which require high cost and energy consumption hence they are not really suitable for the applications in uawsn environment in addition due to the multipath phenomena and background noise the transmitted signal is usually impaired hence all of localization schemes proposed contribute to deal with these problems a popular and widely used ranging metric which is sometimes treated as a low hanging fruit and can be combined with the other ranging metrics is the received signal strength rss assume that there are strong signal sources in an area the rss at different position within the area should be different according to the different distance from the signal sources so the fundamental principle of rss based ranging approaches is that the receiver can map the rss to the corresponding distance xu et al 2016 the measurement for rss is easy and convenient to obtain while the mapping of rss to distance accurately is challenging even though according to the theoretical rss path loss models rss decreases monotonically with increasing distance from the signal source in practice the mapping of rss back to distance is error prone due to the signal interference from multipath and channel noise caused by environmental changes especially under the water hence this mapping becomes academic key research issue naturally in order to improve the accuracy of this mapping several research works have been conducted which can be divided into two categories fingerprinting and transmission models rss based fingerprinting scheme requires an offline training step to put rss distance mapping information into a database during ranging the observed rss will be looked up against the database for the associated distance in lee et al 2009 during the offline training step the receiver collected amplitude modulation am acoustic signals at some sampling locations with given coordinates converted it from time domain to frequency domain stored it as rss information associated with the receiver s locations in the database after applying a median filter in the online step the location of the target can be estimated in real time by comparing the observed rss with the mapping information in the database using the maximum likelihood ml method liao et al 2018 obtains the rss information from the channel state information csi defined as the channel frequency response at several subcarrier frequencies an acoustic field program called waymark simulator henson et al 2014 was applied in order to compute the mapping between coordinates of interested area and rss in csi to obtain a grid map database during the ranging the receiver processes received pilot modulated signals to obtain the csi and then location is estimated by finding the best match within the csi distance grid map database however rss based fingerprinting model liu et al 2012 has two major shortcomings firstly the construction of the database needs detailed rss position on the grid map in advance which is difficult to implement in practice secondly the database is not reliable because of the dynamic underwater environment the rss based transmission scheme needs to find the relationship between the distance and rss based on transmission model in which channel features are usually utilized the urick propagation model brekhovskikh et al 1991 is widely used for the modeling of the underwater transmission loss tl because the model equation is difficult to solve analytically newton raphson method is normally used however newton raphson method results in calculation inefficiency and computation instability to solve this problem hosseini et al 2014 presented a conversion method by expressing the urick propagation model via the lambert w function wang et al 2013 introduced a novel semidefinite programming sdp method to convert the optimization problem into a convex one so that the global minimum standing for the location estimated can be obtained however all these transmission model based rss schemes do not consider the multipath effect which is the prominent phenomena in shallow water and this leads to poor ranging performance in practice in addition these researches tend to assume that the rss measurements obey a certain distribution gaussian distribution normally which is over idealistic actually in this paper we focus on finding a ranging scheme with only limited rss measurements by utilizing the feature that the rss measurements are considerably different at different frequencies due to the multipath effect this is because each signal with different frequency will propagate from the transmitter to the receiver along the same multipath however different frequencies affect the received signal phase of sub paths differently which leads to the change in the constructive destructive relations between signals from different paths to our best knowledge it is the first time we utilize the frequency information to make the mapping problem solvable and achieve more accurate ranging performance the main contributions of this paper are as follows 1 ray tracing based on image sources koutsouris et al 2013 is introduced into the urick propagation model in order to accurately map rss values to physical distance in multipath environment we can then obtain the relationship between parameters in the transmission model and rss for given frequencies 2 the distance cannot be derived with only one rss measurement according to the above multipath transmission model to solve this problem we find signal at different frequency propagates from the transmitter to the receiver along the same multipath with various received signal phase and then utilize this frequency diversity to provide additional information 3 since the mapping from rss to physical distance is error prone and has non linear relationship we propose a system of constraint inequalities based on prior information of the scene and practical considerations and then present an algorithm named interior point to solve it in order to validate our concept we analyze the proposed method and derive its crlb and find ranging error almost falls on the top of crlb we then perform simulations using bellhop underwater acoustic simulator qarabaqi and stojanovic 2013 and do experiments in a lake we found that the accuracy of proposed method is close to that of the state of art method based on compressed sensing and it improves up to 2 times when compared with the conventional method based on simple urick model in the practical environment the remainder of this paper is organized as follows section 2 introduces the transmission loss model based on a method of ray tracing with image sources using physical formulations section 3 defines the fitting problem and shows how to use interior point algorithm to solve it section 4 presents some treatments based on practical considerations to improve final performance section 5 evaluates the performance in the perspective of ranging and localization by numerical simulation bellhop simulator and lake experiment section 6 presents the conclusion of our work 2 transmission model based rss considering multipath effect with multiple frequencies in this section we introduce the attenuation characteristics of an acoustic signal in underwater environment and describe how to model multipath effect in this given environment all symbols used in this article are summarized in table 1 2 1 the basic urick model acoustic propagation describes the behavior of acoustic waves when they are transmitted from the transmitters to the receivers during the propagation the power of acoustic waves decreases as the distance increases brekhovskikh et al 1991 an acoustic signal of frequency f traveling over distance l experiences the basic path loss and the received signal power is given by 1 a l f a 0 l k a f l where a 0 is a scaling constant k is the spreading factor used for describing the geometry of propagation and its normal values are from 1 to 2 for cylindrical and spherical spreading respectively the absorption coefficient a f can be obtained from the thorp s empirical formula thorp and william 1967 in the unit of in decibels per kilometer as follows 2 a f 0 11 f 2 1 f 2 44 f 2 4100 f 2 2 75 10 4 f 2 0 003 2 2 ray tracing method based on image sources for multipath effect in shallow water propagation signals from the source can be received at the receiver from different paths except the line of sight los path any signal rays that bounce off the water surface between the water and the air and the floor between the water and the ground are called non line of sight nlos paths the choppy water surface and the varying floor make it difficult for the accurate and efficient calculation of eigenray in this paper we assume that the water boundaries are flat and the water medium is homogeneous we model ray tracing at such circumstance based on the concept of image sources in optics and determine the length and reflection coefficient of each sub path as shown in fig 1 in order to describe the reflections of the rays we consider these rays as optical rays emitted from the corresponding image sources based on specular reflection theory koutsouris et al 2013 we mark the number of reflections from the water surface as n s and the number of reflections from the bottom as n b respectively based on simple geometric knowledge we conclude that if n b is given and greater than 1 the value range of n s can be determined from 4 different reflection cases as n b 1 n b n b n b 1 we define the case index i 1 2 3 4 to label the four cases respectively as shown in fig 1 the two red lines denote special cases when n b 0 in particular los path r 0 3 corresponds to n b n s 0 one sea surface reflection r 0 4 indicates n b 0 n s 1 if n b is given the length of sub path r n b i and its grazing angle θ n b i defined as the angle between the emission direction and the positive half of the z axis can be obtained by the formula below 3 r n b 1 d 2 2 n b h h t h r 2 θ n b 1 sin 1 d r 1 n s n b 1 r n b 2 d 2 2 n b h h t h r 2 θ n b 2 sin 1 d r 2 n s n b 1 r n b 3 d 2 2 n b h h t h r 2 θ n b 3 sin 1 d r 3 n s n b 1 r n b 4 d 2 2 n b h h t h r 2 θ n b 4 sin 1 d r 4 n s n b 1 where h t and h r are the height of transmitter and receiver above the sea floor respectively h is the total depth in this environment and d is horizontal distance between two nodes the second line of equation 3 corresponds to the case where the sea surface reflection precedes the sea floor reflection the third line represents the opposite circumstance based on the principle of reciprocity due to the significant difference between the acoustic impedance of the aqueous medium and the air medium the water surface reflection coefficient is much larger coates 1988 especially the sea water when an acoustic wave travels from water on the boundary with air it will undergo a total internal reflection that means the reflection coefficient γ s 1 for convenience we mark the total number of sub paths solved by image sources method as n p the length of each sub path as l p where p 1 2 n p n p 4 n b 2 and its corresponding grazing angle as θ p according to equation 4 the bottom reflection coefficient of each path can be calculated as follows 4 γ b θ p ρ b sin θ p ρ c c b 2 cos 2 θ p ρ b sin θ p ρ c c b 2 cos 2 θ p cos θ p c c b 1 cos θ p c c b where ρ and c are the density of water and the speed of acoustic wave in water ρ 1000 kg m 3 and c 1500 m s nominally and ρ b and c b are the density of bottom and the speed of acoustic wave in bottom 2 3 transmission model with multipath effect with formulas 1 4 the transfer function h p f for the p th sub path can be modeled as 5 h p f γ p a l p f where γ p is the reflection coefficient along the p th sub path considering the different path phases the superimposed signal at the receiver is a summation of complex numbers liu et al 2016 hence the overall transfer function in the multipath environment can be obtained as follows 6 h f p h p f e j 2 π f τ p where τ p is the propagation time difference compared to the los path and it can be obtained by the relationship τ p l p l 1 c the theoretical value of the transmission loss at the receiver is 7 t l f h h t d h r 20 log h f where h t and h r are the height of transmitter and receiver above the floor e g sea floor respectively h is the total depth in this environment d is horizontal distance between two nodes f is frequency used for transmission 3 location estimation algorithm 3 1 objective function from equations 1 7 we can obtain the relationship between rss and h t h h r d for a given frequency f the most important parameter d can be obtained from solving equation 8 below 8 t l f h h t d h r t l f however it is not possible to solve equation 8 just for a selected frequency f because the number of equations is less than the number of critical variables in order to solve this problem we need to create equation 8 in multiple frequencies the received rss measurements at different frequencies t l f j j 1 2 m allow us to establish a set of equations as follows 9 t l f j h h t d h r t l f j however equation 9 may be overdetermined the number of unknowns is less than the number of equations and cannot be solved because of measurement error we can look at this problem in a different angle and treat it as a fitting problem by fitting the outputs of the transmission model as close as possible to the practical measurements under the least mean square error criterion the objective function is defined as follows 10 min x r 4 f x 1 2 j 1 m t l f j t l f j x 2 where the four dimensional position vector x consists of the environmental parameters h t h h r d it is difficult to solve equation 10 analytically because it contains sub items such as squares square roots trigonometric functions and so on thus we use numerical methods to find approximate solutions of the problems since the objective function is not well formed it is difficult to get a satisfying solution from classical numerical method techniques liu et al 2016 the position vector x needed to be solved has additional physical constraints for example considering the intrinsic relationship of the four dimensional position vector x we find that 0 h t h and 0 h r h because transducers only work normally under the water to improve the ranging performance we suggest a way of constructing the constrained inequalities g x based on prior information which will be introduced in detail in section 4 after this treatment the problem is defined as constrained nonlinear optimization fitting problem 3 2 interior point algorithm we then numerically solve for optimal position vector using the interior point approach the original problem can be abstracted as 11 min x r 4 f x 1 2 j 1 m t l j t l f j x 2 s t g x 0 where g x is the constrained inequalities based on prior information discussed in section 4 now a barrier function is introduced in order to convert the original inequality constrained problem to a sequence of equality constrained problems shown below in the variables x and s i 12 min x s i f μ x s i min x s i f x μ i ln s i subject to g x s i 0 where μ 0 by default and there are as many slack variables s i as inequality constraints g x the value of s i are implicitly assumed to be positive as the value of μ decreases to zero the logarithmic term called a barrier function approaches zero so that the minimum of f μ x s i approach the minimum f more details about this method is described in byrd et al 1999 2000 to solve the easier problem shown in equation 12 the algorithm selects one of two main types of steps at each iteration the first one is named as a direct step which attempts to solve the karush kuhn tucker kkt conditions via a linear approximation the other step is a conjugate gradient cg step using a trust region the details and derivation of this step are described in waltz et al 2006 by default the interior point algorithm first attempts to take a direct step for the sake of less computational complexity now we need to determine the most appropriate step length a merit function based on equation 12 is constructed at each iteration and is typically defined as follows 13 x s γ f μ x s γ g x s where γ 0 is a penalty parameter to balance the relative contribution of the objective function and constraints waltz et al 2006 and it should be large enough to force the solution towards feasibility if the value of the merit function decreases in an attempted step the algorithm accepts the attempted step otherwise it attempts a different shorter step in order to obtain a suitable step length the iteration continues until certain criteria are satisfied for example the number of iterations exceeds the default threshold or change in the objective function value is small enough say x s γ ε ε 10 6 when the criteria are satisfied the solution to the problem is a local solution containing our target horizontal distance d 4 additional constraints of the proposed algorithm as mentioned in section 3 because the four unknown parameters in equation 10 jointly affect the final function value the solution is not stable and trustable enough to tackle this problem additional information in the form of g x 0 in equation 11 is needed in this section we will present how to use prior information to construct constraints and how to reduce computational cost based on physical considerations 4 1 limiting the number of image sources in the model according to the image sources method we can calculate the coordinate of image sources iteratively each of which corresponds to a specific sub path hence there are infinite image sources theoretically however additional image sources are getting farther and farther away from the receiver as the number of iterations increases this leads to less and less contribution to the acoustic field that s to say we can limit its number to a reasonable range without sacrificing too much accuracy what s more for typical geological formation of the seabed such as soft mud fine sand etc the reflection coefficient is around 0 5 or less depending on the directional property of the surface and the grazing angle frisk et al 1980 hence more than 96 8 percent of the energy in each nlos path will be consumed during the propagation if the times of sea floor reflections exceed 5 this means these nlos paths can be ignored without sacrificing too much accuracy in the shallow water environment the nlos path will not be extremely much longer than the los path for the sake of simplicity the reflection coefficient is considered to be the only basis for filtering out the nlos path with less energy based on considerations above we set the minimum normalized power threshold to 5 the maximum number of sea floor reflections to 5 4 2 prior information about the practical environment initial value of iterations is an important issue as for optimizing the target function which motivates us to find the upper bound and lower bound of the unknowns at each iteration considering the intrinsic relationship of the four dimensional position vector x we find that h t h and h r h because transducers only work well under the water another consideration is surface variation caused by the wind and location uncertainty displacement of the transmitter the maximum height offsets of the surface and the transmitter are recorded as δ h and δ h t respectively hence the range of them are h δ h h δ h and h t δ h t h t δ h t respectively 4 3 minimum required frequency channels because the number of the unknowns is four in equation 9 the solution to the fitting equation 11 exists only when m 4 this means that we should utilize 4 channels at least in simulations or practical experiments although ray tracing theory is a very effective method for the study of acoustic propagation in inhomogeneous media such as the ocean its applicable condition is at sufficiently high frequencies thorp and william 1967 confined to the frequency response characteristics of the transducers and the sampling rate of the data acquisition card the available frequency range is 20 25 khz in order to avoid the mutual interference we divide the frequency band into 21 channels at most 5 performance evaluation in this section we first numerically analyze the proposed scheme and find it achieves small ranging error which falls on the top of crlb nearly after that we analyze the impact of unique internal factors in our model on ranging by bellhop simulator and then we compare the performance of proposed method with other conventional state of art methods in ranging and localization lastly we conduct an experiment in a lake to prove the proposed method is useful and effective and discuss its advantages and demerits 5 1 numerical analysis in order to find a benchmark for the proposed algorithm crlb for the optimization problem in equation 10 is derived based on equation 1 the rss t l f j measured at the same distance l using different frequency component f j j 1 2 m can be given by 14 t l f j 10 k log l a f l n f j different from other literatures zhang et al 2016 where the additional noise term n f j obeys an independent and identically distributed iid zero mean gaussian distribution we set n f j n μ f j σ 2 after considering the significant impact of frequency on rss although a f is a function of f a f increase slightly when f increases from 20 khz to 25 khz for the sake of simplicity we have a f 1 m j 1 m a f j for all the frequencies similarly μ f j is a complex equation about f and the first order taylor series expansion is used to approximate it that s to say μ f j μ 0 μ 0 f j μ 0 0 refresh formula 14 15 t l f j 10 k log l a f l μ 0 f j w f j for the sake of description we mark 10 k log l a f l as a and μ 0 as b the final expression is 16 t l f j a b f j w f j where a and b are unknown constants w f j obeys an iid zero mean gaussian distribution with variance σ 2 w f j n 0 σ 2 the fisher information matrix can be calculated as 17 i θ ˆ e 2 ln p f j θ ˆ a 2 e 2 ln p f j θ ˆ a b e 2 ln p f j θ ˆ b a e 2 ln p f j θ ˆ b 2 where θ ˆ a b t and the likelihood function p f j θ ˆ is 18 p f j θ ˆ j 1 m 1 2 π σ exp 1 2 σ 2 t l f j a b f j 2 1 2 π σ 2 m 2 exp 1 2 σ 2 j 1 m t l f j a b f j 2 the first order derivatives of this likelihood function can be derived as follows 19 ln p f j θ ˆ a 1 σ 2 j 1 m t l f j a b f j ln p f j θ ˆ b 1 σ 2 j 1 m f j t l f j a b f j the second order derivatives are given as follows 20 2 ln p f j θ ˆ a 2 m σ 2 2 ln p f j θ ˆ a b 1 σ 2 j 1 m f j 2 ln p f j θ ˆ b 2 1 σ 2 j 1 m f j 2 the fisher information matrix is 21 i θ ˆ 1 σ 2 m j 1 m f j j 1 m f j j 1 m f j 2 due to j 1 m j m m 1 2 and j 1 m j 2 m m 1 2 m 1 2 f j a j b if we select the frequencies with equal difference the inverse of fisher information matrix is 22 i 1 θ ˆ 2 σ 2 a 2 m 3 a 2 m 2 a 2 m 2 3 a 2 m a 2 6 a b m 6 b 2 3 a 2 b a m 3 a 2 b a m 6 the crlb of θ ˆ is 23 var a ˆ i 1 θ ˆ 1 1 var b ˆ i 1 θ ˆ 2 2 specially there is negative correlation between the first element i 1 θ ˆ 1 1 and the used number of frequencies m hence the crlb of l will decrease when m increases and this conclusion will be shown in the numerical simulation 5 2 numerical simulation in this section simulation is conducted to study the impact of measurement noise and the used number of frequencies on distance estimation as for this simulation a 0 25 b 19 75 m 5 21 61 b 0 02 k 1 5 the expected distance l 30 and the measurement noise with variance σ 2 0 1 0 2 1 db the root mean square error rmse is calculated by monte carlo simulations with an average of about 2000 distance estimations zhang et al 2016 as shown in fig 2 crlb for m 5 21 61 increases with the variance of measurement noise and it decreases slightly when the number of used frequencies has an increment and we can find that both urick method and proposed method show deteriorating performance with the increase of noise variance furthermore whatever the used number of frequencies is proposed method achieves lower localization error which falls on the top of crlb nearly which shows the proposed method has a significant improvement in performance compared with the urick method 5 3 simulation experiments through the numerical simulation we know that if the environment can be ideally modeled as formulas with additive noise proposed method can reach the crlb however there are inevitable random channel variations in practice such as location uncertainty varying environment complex scattering and motion induced random doppler shift resulting from surface waves or transmitter receiver drifting in order to verify the stability of proposed method we perform simulation experiments using bellhop simulator for uawsn channels qarabaqi and stojanovic 2013 the simulator tool has outstanding performance in predicting communication system s property before deployment and it requires a series of parameters during the initialization phase the spreading factor k was set to 1 5 for typical shallow water environment the speed of acoustic wave in water c and near the sea floor c b was set to 1500 m s and 1480 m s respectively the densities of the water mediums in general and near the sea floor were ρ 1400 kg m 3 and ρ b 1400 kg m 3 respectively the surface height h 0 was set to 3 m the transmitter height h t 0 was set to 2 m the receiver height h r 0 was set to 2 m the height offsets of surface and transmitter obeyed a gaussian distribution with the mean μ of 0 and a standard variance σ of 0 1 the theoretic horizontal distance d 0 for testing was set from 50 m to 300 m with interval of 50 m we used a set of frequencies from 5 khz to 30 khz with the resolution δ f of 2 5 hz the total time of simulation was set to 60 s with the resolution δ t of 0 05s the rest of the parameters were consistent with those in the source code qarabaqi and stojanovic 2013 the output of bellhop simulator was a corresponding transfer function which could be used to calculate the tl at each frequency we chose 20 25 khz as our frequency band at which the acoustic transducers were available typically and divided it into 21 frequencies by default 5 3 1 prior knowledge about the environment prior knowledge about the environment is important to the calculation of distance we obtained the values of rss at different frequencies in order to establish a set of equations 9 and 10 for solving for the unknown parameters x and d in our model the initial value of x is set to h t 0 h 0 h r 0 d 0 other environmental parameters such as k c c b are the same as those set in the bellhop simulator we first solved for x using the basic constraints of x 0 and h t h r h this case is called no prior information pi 0 scenario if there is additional prior knowledge about these four parameters in a specific environment for example the range of the water s depth has been measured in advance then an additional inequality h 0 3 σ h h 0 3 σ will be introduced this case is called single prior information pi 1 scenario furthermore if the variety of the transmitter s height is known which is easily obtained in practice due to the wide application of bathometers two extra inequalities h t 0 3 σ h t h t 0 3 σ h 0 3 σ h h 0 3 σ will be introduced this case is called double prior information pi 2 scenario fig 3 shows the effect of prior knowledge on ranging performance similarly rmse is used to quantify the deviation of the distance d calculated using our model from the real values since the ranging error is usually related to distance we use ranging error ratio 100 rmse d 0 to evaluate the ranging performance from our simulation the average ranging error ratio is 86 38 when pi 0 if we use the prior information about the environment to establish the inequalities mentioned in equations 9 and 10 the performance will be the best about 10 63 on average when pi 2 based on these results we suggest that more practical information about these four parameters is needed 5 3 2 the impact of the number of used frequencies fig 4 compares the ranging error with different number of frequencies m 4 5 11 21 respectively the basic constraint inequalities the two additional constraints h t h t 0 3 σ h 0 3 σ h h 0 3 σ and the initial value x h t 0 h 0 h r 0 d 0 are the same as mentioned before moreover the frequency range of them is identical while the interval between adjacent frequencies is different we find that proposed method has the largest average ranging error ratio around 15 16 when m 4 if we increase the number of used frequencies the average ranging error ratio is changing from 10 03 to 8 93 and then to 10 63 even though there are little difference between ranging performance of the last three simulations m 5 11 21 we suggest using more frequencies if possible this is because the practical measurements may fail at some frequencies due to environmental factors thus we should try to use more frequencies to make the proposed method more robust in practical underwater environment 5 3 3 ranging performance compared with conventional method we use bellhop simulator to generate channel information and select 21 frequencies with full prior knowledge about the environment to estimate the distance as for urick method we use formula 1 with center frequency information to calculate the distance as shown in fig 5 the ranging error ratio of proposed method varies from 2 to 22 while that of urick method is at least higher than 27 5 3 4 localization performance compared with conventional state of art method to compare proposed method with the conventional method based on urick model and an state of art method based on compressed sensing cs dong et al 2019 for localization we design a medium scale region covering an area of tens of thousands of square meters with six reference nodes blue triangle distributed around the target black pentagram from 50 m to 300 m respectively and then use the same 200 sets of rss information from bellhop simulator as the input of ranging lastly the trilateration algorithm yang and liu 2009 is introduced to locate the target following the idea based on cs we divide the region into 40 50 grids the resolution of grid is 10 m and locate the target on a nearby grid point as shown in fig 6 a the positioning result green dot of proposed method is tightly wrapped around the target in fig 6 d most of output of the state of art method is the red dot the horizontal dilution of precision hdop is introduced to evaluate the localization performance in a two dimensional plane hdop is defined by the mean error of euclidean distance between estimated location x ˆ y ˆ and the true location x y 24 hdop 1 n i 1 n x x i ˆ 2 y y i ˆ 2 in this simulation hdop is calculated to be 9 3601 for proposed method and hdop 85 8468 hdop 9 1906 for the conventional and state of art method respectively obviously proposed method performs better than the conventional method and it has the same performance as the state of art method in terms of localization 5 4 practical experiments 5 4 1 experimental setup as shown in fig 7 a our localization scheme is deployed in the jingye lake located at the campus of tianjin university tianjin china where due to the limitation of lake size the scale of experiment is smaller than the simulation the dimension of the lake is about 130 m l 70 m w 5 m d our mission is to locate the target at the northwest corner of the pavilion red pentagram four reference nodes blue triangles which are about 10 m 30 m 50 m 70 m away from the target respectively are deployed along the shore a complete set of equipment from b k company is used in the experiment which includes five b k 8104 hydrophones one power amplifier with type of 2713 and four 3050 a 040 daq data acquisition cards additionally the notebook pc installed with b k official software is used for controlling the instruments data storage and localization considering the shallow depth of the lake and the frequency response characteristics of the hydrophones we set the transmitted frequency ranging from 20 0 to 25 0 khz with the interval of adjacent frequencies of 250 hz the wavelengths of these acoustic monophonic signals are on the order of centimeter and the wavelength difference between adjacent frequency signals is much smaller than 0 07 cm the duration of the signal at each frequency used for transmission is 30 ms while the time interval between the frequencies should be large enough to mitigate the effects of multipath expansion and we set it to 120 ms as shown in fig 8 a the initial signal strengths at all frequencies are the same in the experiment the target node transmitter sends the signal every 5 s the data acquisition cards reference nodes collect the received signals and deliver them to the pc at the sampling frequency of 131 072 khz in which the signals frequency is analyzed and the tl is calculated as shown in fig 8 b the values of rss measured at each frequency are different the difference in the values of rss can be up to 20 db this demonstrates the significance of phase for the total signals the reason why the rss at different frequency is different is that even though different frequency signals propagate from the transmitter to the receiver along the same multipath each different frequency affects the received signal phase of sub paths differently this leads to the change in the constructive destructive relations among signals from different paths 5 4 2 performance of ranging localization experiment in the lake after acquiring the experiment data we use proposed method and urick method to estimate the distance between the target and four reference nodes shown in fig 7 a rmse is calculated to evaluate the ranging performance as shown in fig 9 the average ranging error ratio is 10 65 by proposed method and 39 62 by urick method respectively hence proposed method reduces the ranging error by at least 50 compared to the urick method after we performed the ranging calculation for each reference node using proposed method we estimate 2 dimensional position of the target in the lake by applying the basic trilateration algorithm in this experiment fig 10 the value of hdop for proposed method and for the conventional method are 11 2291 and 18 9536 respectively this shows that the localization accuracy improves almost 200 percent another observation is that the performance is better when the target is in the area enclosed by the reference nodes and it is the best when the target is at the center of the region joel et al 2016 hence localization accuracy can be improved further if we try to adjust the structure of the reference nodes this will be tested and discussed in our future work as for the advantages of the proposed method it does not need extra hardware and can reduce cost and power consumption because it is based on rss another distinguished advantage is that we utilize the multiple frequency information to achieve more accurate ranging performance comparable to the state of art method in the other hand proposed method also needs to be improved firstly to obtain the effective rss from the received signal containing measurement noise the signal to noise ratio should be large enough so the range of this scheme may be limited secondly due to the random movements of surface or aquatic organisms we will meet with link failure or measurement outliers which will degrades the ranging performance if ignored finally although using many frequencies can improve the ranging performance we cannot use too many channels because this will cause calculation cost increasing we need to balance them 6 conclusion in this paper we propose a novel ranging method in the uawsn environment with limited hardware to reduce cost and power consumption we model the impact of multipath phenomenon on rss measurements and find the conventional urick model is too simple to convert the measured rss to the corresponding distance accurately in order to deal with this problem most of the existing works tend to start from a statistical point of view and introduce an additional term which obeys the gaussian distribution unfortunately this assumption may be not practical under the water we abandon this approach and introduce a ray tracing method based on image sources into the urick propagation model to accurately map rss values to physical distance we utilize rss measurement at different frequencies to make the system of inequalities solvable however the solution is not stable and trustable enough because the problem is non liner and ill conditioned to deal with this issue we construct constraints based on prior information of the environment and then present a numerical algorithm named interior point to solve it the numerical simulation show ranging error almost falls on the top of crlb in all cases the medium scale simulation based on bellhop simulator shows that the average localization errors of this paper is very close to that of the state of art method both of them are within 9 m compared to around 86 m using conventional method in the small scale lake experiment the average ranging error ratio is below 10 and localization error is within 11 m on average compared to 39 and 19 m by using conventional method hence both ranging and localization results show that proposed method is superior to the conventional method and its performance is close to the state of art method based on compressed sensing credit authorship contribution statement quan tao methodology writing original draft writing review editing yu cao conceptualization methodology boonsit yimwadsana methodology xiaomei fu methodology writing review editing funding this research was supported in part by national natural science foundation of china grant no 61571323 and in part by the talented young scientist program of ministry of science and technology people s republic of china and the ministry of science and technology thailand thailand 19 001 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge school of marine science and technology for providing b k equipment and we thank the anonymous reviewers for their constructive comments appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 multimedia component 11 multimedia component 11 multimedia component 12 multimedia component 12 multimedia component 13 multimedia component 13 multimedia component 14 multimedia component 14 multimedia component 15 multimedia component 15 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107772 
21552,in this paper the dynamic effects of wind turbine installation angle and wind turbine pendulum motion on the constant wind vector and the variation of the real wind vector acting on the blade are discussed respectively the effects of these two conditions on the aerodynamic load and torque of wind turbine are analyzed based on this theory the classical bem is dynamically modified and the specific method of dynamic correction is proposed the modified bem is used to simulate the aerodynamic load and blade load distribution of wind turbines by comparing and analyzing the previous methods the correctness of this method is proved a new aerodynamic load calculation method is proposed for the new energy industry especially for the wind energy industry which can assist engineers in the design analysis control and evaluation of wind turbines keywords bem dynamic modification aerodynamic load of wind turbine wind turbine nomenclature symbols and meaning of the symbols v 1 the inflow velocity at infinity v a the wind speed at front of wind wheel v the wind speed acting on blade p the air pressure at infinity ω the angular velocity of air induced by blades ω the angular velocity of wind wheel rotation k the loss correction coefficient α the inflow angle k tip the tip loss coefficient k hub the root loss coefficient b the number of blades c the chord length of blade element c n the axial force coefficient c n the tangential force coefficient v 0 the real wind speed acting on blade element α the angle between the real wind speed and the blade γ the yaw angle θ the tilt angle ϕ the cone angle β the pitch angle ψ the blade rotation angle h hub the hub height 1 induction aerodynamic load is part of the decisive effects that wind turbine must consider it directly affects the structural design of a wind turbine blade the design of the generator set and the design of control system if it is a floating offshore wind turbine the aerodynamic load will even affect the design of a floating foundation and the mooring system therefore it is extremely important to accurately predict the aerodynamic load that the wind turbine bears in its work there are relatively mature forecasting methods for aerodynamic loads of wind turbines on land under the assumption of rigid blades wind energy captured by wind turbines is closely related to wind speed tip speed ratio coefficient blade geometry its control system etc t ouyang ouyang et al 2017 proposed a data mining method in the research and used it to predict the output power of wind turbines at different wind speeds tip speed ratio coefficients and pitch angles the research results also proved the crucial relationship between aerodynamic loads and the operation of wind turbines many researchers have been attempting to make the interaction between air and wind turbines clear and thorough but limited by the size of wind turbines it is difficult to use real wind turbines for direct experiments however due to the widespread application of cfd commercial software many researchers use cfd software to simulate the interaction between environment and wind turbine x cai cai et al 2016 uses cfd software to simulate the non static wind turbine the author constructs a simulation wind field considers the wind shear effect in actual environment and uses a finite element method to simulate and analyze the interaction between the wind turbine and wind field it can be observed in the results that both the axial load and the blade torque are changing dynamically and the vortices generated by the blade rotation will also change the aerodynamic load this dynamic change is the difficulty in calculating the air load of wind turbine cfd simulation and blade element momentum theory is commonly used to calculate the air load of wind turbines cfd simulation usually needs three dimensional flow field analysis to analyze the flow field of the entire structure of wind turbines which will lead to time consuming simulation and high hardware requirements li et al 2015 ghasemian and nejat 2015 therefore relatively traditional blade element momentum bem theory is more commonly used in industrial production bem is a combined application of blade element theory and the momentum theorem firstly the wind field is simplified to a stream tube the actual wind speed acting on the wind wheel is obtained by using the bernoulli equation before and after the wind wheel then according to the blade element theory the blade is divided into infinite segments and the static mechanical performance of each section of the airfoil in the flow field is computed finally the results of the two methods are combined and the axial and tangential inducing factors are used as bridge to calculate the information of the axial thrust torque and output power of the wind turbine the bem theory is to reduce time consuming inevitably has shortcomings such as the inability to simulate the vortices generated by wind turbines therefore bem theory usually needs a series of modifications such as the prandtl modification luo et al 2015 for the tip loss the modification for the dynamic stall of airfoil gordon leishman 2002 and the glauert modification glauert 1926 for yaw the modification of bem is still in progress chao peng peng et al 2017 used the bem to research the flutter coefficients of blades the blade loads were divided into vibration loads and flutter loads caused by aerodynamic loads in this study the author improved calculation methods of two inducing factors the purpose of this method is to modify the rigidity assumption of blades in traditional bem jerson rogério pinheiro va vaz et al 2011 considered the wake vortices caused by the airflow passing through the wind turbine in the calculation of blade loads this study considered the influence of the wake vortices behind the wind turbine on air loads jc dai dai et al 2011 et al applied the theory of dynamic stall of an airfoil to the analysis of blade load the author considered that the unstable attachment flow would lead to the dynamic stall effect of airfoil due to the existence of yaw angle and revised the iterative calculation process of two inducing factors lin wang wang et al 2014 et al took aeroelastic performance of blade into account in the calculation of blade load combined with bem obtained the thrust and torque generated by blade elastic deformation and also revised the calculation method of inducing factor the dynamic modification of bem is one of the main concerns of researchers currently the results of some studies it can be seen that after modification bem is closer to the engineering reality and also shows the development potential and application value of bem but through more researchers research on the details of the wind field it is found that the current modifications are not enough to make bem accurate enough to fully reflect the changing law of the air load in a constant wind field the induced factor and load distribution calculated by traditional bem and some modified bem remain constant which means that the average value of air load may be corrected accurately but the actual fluctuation law of air load can not be simulated by bem liping dai daiqiang zhou et al 2017 uses cfd software to analyze the influence of blade pitch angle of power load torque and so on it shows that the installation angle of the wind turbine structure has great impact on the actual working effect in particular it will cause periodic fluctuations of power and thrust with the rotation of wind turbines fernando l ponta ponta et al 2016a et al analyzed the effects of geometric installation angles of wind turbines such as yaw angle inclination angle and pitch angle on the performance of wind turbines and plotted the performance curves of wind turbines affected by geometric installation angles under constant wind field from the curve it can be seen that even the constant wind field will be affected by the actual installation and periodic fluctuations will occur xin shen shen et al 2018 used lift surface method to simulate the output power and thrust of a floating wind turbine under a given vibration signal from the change curve it can be seen that for a 5 mw wind turbine the theoretical fluctuation of the input power under a given vibration signal reaches a maximum value of nearly 10 mw and the minimum value is less than 2 mw g r tomasicchio tomasicchio et al 2018 experimented with the vibration of spar offshore wind turbines by using a proportional model the results demonstrate that the swing angle of spar offshore wind turbines is between once the size of wind turbines increases the swing angle of will lead to a sharp increase in the relative wind speed of blade tips thus directly affecting the performance of the wind turbines from the existing conclusions we know that without considering the dynamic changes of wind turbine foundation vibration and wind field the performance fluctuation caused by geometric installation angle is very obvious once the foundation vibration and wind field change the influence will be magnified there are many environmental conditions leading to the vibration of the wind turbine foundation and the change of the wind field for the wind turbine on land there are structural vibration vibration caused by earthquake etc for the wind turbine on the sea there are wave action ocean current action seabed earthquake action vibration caused by other ships etc therefore the reasonable values can not be corrected only by empirical or semi empirical coefficients but also the actual load of wind turbine when the installation angle and environmental conditions work together only by more thorough and objective analysis of the action law of the real load can the structure and parts of the wind turbine be better designed so as to avoid overload blade breakage and abnormal fatigue damage tower breakage mooring system damage and wind turbine control system failure or inadequate capacity to reduce the cost of wind turbine construction and improve the safety of wind turbine operation to provide theoretical support for the new energy industry and to contribute to the global clean renewable energy utilization in summary this study will propose a bem correction method considering dynamic inflow angle analyze the influence of installation angle on aerodynamic load of wind turbine and propose a calculation method for aerodynamic load of wind turbine blade considering both installation angle and structural pendulum motion considering the change of wind turbine performance under known structural load response it serves as a theoretical reference for the in depth study of the design and manufacture of wind turbines 2 comparison of different modifications of classical bem bem is a combination of the momentum theorem and blade element theory it is a common method to simulate aerodynamic loads of wind turbines its purpose is to calculate the axial inducing factor a and tangential inducing factor b by iteration calculation and then calculate important parameters such as power coefficient pressure coefficient and thrust abutunis et al 2019 by using a and b the basic model of wind turbine power theory silvaa et al 2018 is presented in fig 1 it assumes that the energy system composed of wind field and blade is an expanding stream tube the inflow velocity at infinity is v 1 the wind speed at front of wind wheel is v a the wind speed acting on blade is v and the air pressure at infinity is p applying bernoulli equation and the momentum conservation theorem before and after the wind turbine the formulas of thrust and torque expressed by inducing factors can be obtained due to the limitation of the length of the article the momentum theory will not be derived in detail in this paper the formulas can be seen in equs 1 and 2 silvaa et al 2018 1 d f 4 π ρ v 1 2 a 1 a r k d r 2 d t 4 π ρ v 1 ω b 1 a r 3 k d r according to relevant definitions in the industry 3 a v 1 v a v 1 4 b ω 2 ω where ω is the angular velocity of air induced by blades ω is the angular velocity of wind wheel rotation k is the loss correction coefficient which is mostly a semi empirical formula and its purpose is to correct the errors caused by the results such as tip loss and root loss the model of blade element theory is illustrated in fig 2 its basic assumption is that rigid blades are divided into several segments along the span direction and the lift force drag force and air load of each segment are calculated respectively by using the aerodynamic characteristics of blade airfoil by integrating the whole blade the load and performance of the entire blade can be obtained from the blade element theory yoshida 2018 and airfoil aerodynamics the following relations can be obtained 5 d f 1 2 b ρ c v 0 2 c n d r 6 d t 1 2 b ρ c v 0 2 c t d r where b is the number of blades c is the chord length of blade element c n and c t are the axial force coefficient and tangential force coefficient v 0 is the real wind speed acting on blade element 7 c n c l cos α c d sin α 8 c t c l sin α c d cos α the synthesis diagram of the real wind speed acting on a blade element is shown in fig 3 due to the space limitation the relationship between wind speed will not be deduced in detail in this paper the specific process can be referred to any wind turbine aerodynamics textbook the real wind speed of blade element v 0 can be obtained by geometric calculation by using equs 1 2 5 and 6 and taking v 0 into them the following relations can be obtained 9 a 1 a σ c n 4 k sin 2 α 10 b 1 b σ c t 4 k sin α cos α where α is the inflow angle σ b c 2 π r by using equs 9 and 10 a and b can be solved by iteration method the correction coefficients k in equs 9 and 10 usually include tip loss coefficient k tip and hub loss coefficient k hub the expressions of tip correction coefficient and hub correction coefficient are as follows jonkman et al 2009 11 k tip 2 π arccos exp b r r 2 r sin α 12 k hub 2 π arccos exp b r r 0 2 r 0 sin α the angle α between the real wind speed and the blade can be calculated from fig 3 the flow chart of the iteration calculation is shown in fig 4 13 α arctan 1 a v 1 1 b ω r 14 ζ α β the modification method of ref peng et al 2017 is as follows 15 a k 18 k 20 3 c f 50 36 k 12 k 3 k 4 36 k 50 a 0 4 16 c f 1 a 2 σ sin 2 α c l cos α c d sin α the modification method of ref dai et al 2011 is as follows 17 a 1 min 0 5 t 1 6 t 2 t 3 a 0 4 18 t 1 18 σ c n 36 f 2 sin 2 α 40 f sin 2 α 19 t 2 18 f sin 2 α σ c n 36 f 4 sin 4 α 48 f 3 sin 4 α 1 2 20 t 3 9 σ c n 50 f sin 2 α 36 f 2 sin 2 α both of these two methods take care of the axial inducing factor uniquely in the iterative process limited by the length of the article the specific principles of the two methods are not given in this paper this article will only list their correction process eq 15 eq 16 and eq 17 eq 20 the location of these two correction methods in the iterative process is illustrated in fig 3 the results of the two methods are shown in fig 5 a and b c the figure shows the calculation results of the axial induction factor when the wind turbine speed is 10 s 20 s and 30 s and the wind speed is v 1 5 m s as can be seen from fig 5 the x axes of fig 5 is the number of blade elements one blade is divided into 17 segments with the increase of the ratio of rotational speed to wind speed the difference of the axial inducing factor calculated by the two methods also increases gradually the revised value at the tip of the blade is the largest and the ratio of the revised value to the original value exceeds 6 the average correction rates under the three calculation assumptions were 3 29 3 30 and 3 29 respectively due to the different correction methods the inducing factors of the same blade would be significantly different 3 load calculation method and result analysis considering installation angle 3 1 effect of installation angle on wind vector acting on blades the possible angles during the operation of wind turbines are shown in fig 6 the operation control system of wind turbines usually makes the wind turbine have yaw angle γ tilt angle θ cone angle ϕ pitch angle β and blade rotation angle ψ in this study yaw angle pitch angle and cone angle are considered as installation angles the existence of installation angle will make the wind field no longer directly opposite the wind wheel so the assumption of the traditional bem is invalid in order to better solve the difference between the bem hypothesis and the actual situation the wind vector relative to the geodetic coordinate system is converted into the blade section by using the matrix transformation method because the blade rotates the original constant wind vector will change dynamically which will cause the inflow angle to change dynamically therefore this section will modify the bem from the angle of the installation angle s influence on the inflow angle and the relative wind speed 21 a γ cos γ sin γ 0 sin γ cos γ 0 0 0 1 a θ cos θ 0 sin θ 0 1 0 sin θ 0 cos θ a ψ 1 0 0 0 cos ψ sin ψ 0 sin ψ cos ψ a ϕ cos ϕ 0 sin ϕ 0 1 0 sin ϕ 0 cos ϕ a β cos β sin β 0 sin β cos β 0 0 0 1 assuming that each part of the blade is rigid body considering that the coordinate transformation is rotational transformation the transformation matrix of each angle is as follows according to the angle transformation matrix equ 21 the expression method of wind vector v 1 i j k in the coordinate system of blade section equ 22 can be obtained 22 v 1 b v b i v b j v b k n 1 i j k where n 1 is the total transformation matrix of coordinate system 23 n 1 a β a φ a ψ a θ a γ is a quantity related to azimuth angle because the azimuth angle of wind turbine is proportional to the blade speed in normal operation a is also a variable related to time which means n 1 f t assuming that the wind vector is v 1 500 the rotational speed of wind turbine is 5 s yaw angle γ 5 tilt angle θ 5 cone angle ϕ 5 and β are set up according to the model in table 1 model data source is nrel all the real wind speeds acting on blade element can be obtained by equ 22 the variation of real wind speed is shown in fig 7 in which the circumference represents the rotation angle and the ordinate represents the relative wind speed with the chord length of blade element from fig 7 it can be seen that the wind speed of the first blade element fluctuates between 5 0169 and 4 8878 and the angle between 19 3200 and 6 5890 the wind speed of the last blade element fluctuates between 4 8895 and 5 0001 and the angle between 7 1944 and 6 9896 the range of the two fluctuations is smaller than that of the first blade element according to the definition of inducing factor it can be seen that the wind with periodic change will change the inducing factor so it can not be ignored in chao peng s and j c dai s methods of calculating the inducing factor the wind field is constant but it can be seen from the above calculation that when considering the installation angle the constant wind field will change periodically which leads to the inducing factor is no longer a constant value of the time but a change value the inducing factors of this change will directly lead to the periodic variation of thrust and torque and even other coefficients with time 3 2 bem correction method and result analysis considering installation angle as mentioned in 2 1 in the iteration process of classical bem wind speed v 1 is assumed to be a constant value but in fact the relative wind field acting on the blade will change with time and the real wind speed acting on each blade element is different if the constant value is used some errors will occur therefore the correction of this effect should be considered in the iteration calculation process because v 1 b changes periodically with time an improved algorithm of inducing factors a and b can be obtained by iterating with v 1 b instead of v 1 the original formula is eq 13 24 α arctan 1 a v 1 b 1 b ω r by using equ 24 to replace the corresponding items in the original process while retaining the glauert correction coefficient the inducing factor considering the installation angle can be obtained to verify the calculation method proposed in this study the results of j jonkman jonkman et al 2009 w xudong xudong et al 2009 f l ponta ponta et al 2016b are compared according to j jonkman s research the rated wind speed of a 5 mw wind turbine is a the rated speed is b and the 5 mw wind turbine will be propeller controlled to control the input power when the wind speed exceeds the rated wind speed therefore this study will compare the power of the wind turbine before pitch control to verify the computational power of the code fig 8 a is the power comparison assuming that all installation angles are zero fig 8 b indicates the difference between the calculation results of power with or without installation angle each angle of installation is 10 from fig 8 a it can be seen that the code provided in this study fits well with the three authors from fig 8 b it can be seen that due to the existence of installation angle the power of wind turbine decreases significantly in calculation and the faster the wind speed the more obvious the reduction is the cause of this reduction is the change of relative wind speed caused by installation angle if this change is neglected the calculation of thrust torque and other important parameters will be significantly different resulting in accidents therefore this phenomenon can not be ignored in engineering practice fig 9 shows the variation of thrust of wind turbine with blade rotation the thrust is a constant value without considering the installation angle once the installation angle is considered the axial thrust will become a periodic change with time and a relatively small amount it also proves that the control system of wind turbine can reduce the air load on the structure by controlling the installation angle therefore it is necessary to reveal this effect more deeply in order to enhance the control effect 4 load calculation method and result analysis considering the simultaneous action of pendulum motion and installation angle 4 1 effect of pendulum motion on wind vector acting on blades 4 1 1 dynamization of constant wind vector it is assumed that the structural dynamic response of a wind turbine is known when it is in a normal and stable working state assuming that the dynamic response of the structure is ω x t ω y t and ω z t they are rotations around axes x y and z using the method in 2 1 the rotation of coordinate system x y z can be transferred to blade cross section coordinate system and then the real wind vector can be obtained 25 ω x b t ω y b t ω z b t n 1 ω x t ω y t ω z t after the structural response is transferred by equ 25 the response functions and of the blade section are determined these three fixed axis rotations will affect the magnitude and inflow angle of the real wind vector therefore the transformation matrix of coordinate system can be determined according to the principle of 2 1 26 a x b t 1 0 0 0 cos ω y b t sin ω y b t 0 sin ω y b t cos ω y b t a y b t cos ω y b t 0 sin ω y b t 0 1 0 sin ω y b t 0 cos ω y b t a z b t cos ω y b t sin ω y b t 0 sin ω y b t cos ω y b t 0 0 0 1 on the basis of equ 22 by using equ 26 the constant wind vector can be corrected 27 v r e a l t v r e a l b i t v r e a l b j t v r e a l b k t n 2 v b i v b j v b k 28 n 2 a x b t a y b t a z b t it can be proved by equ 27 that after two modifications the wind vector becomes a time dependent variable so the thrust and torque calculated will be time varying rather than constant even if equ 27 is not used the wind vector modified by equ 22 is also time dependent 4 1 2 generation of instantaneous wind speed as showed in fig 10 the pendulum motion caused by environment will not only affect the constant wind vector but also make the structure produce instantaneous wind speed instantaneous wind speed will directly lead to the change of the real wind speed and this change will increase significantly with the increase of the 29 v load t ω t y d 2 h hub l 2 l 1 cos ψ t 2 n π 3 2 n 0 1 2 the instantaneous wind speed caused by pendulum motion can be obtained by equ 29 in equ 29 h hub is the hub height cos 2 n π 3 is the interval between two blades ω y is the pendulum function equ 29 can be used to calculate the instantaneous wind speed at different blade elements the instantaneous wind speed can be added to the real wind speed of the blade section calculated by equ 28 30 v ins tan t v load v real with the replacement of v 1 b in equ 24 the joint correction of pendulum motion and installation angle can be made for bem the flow chart of the correction is shown in fig 11 nrel s jonkman and buhl 2007 studied the oscillation of a 5 mw offshore floating wind turbine by numerical simulation it is concluded that the swing angle of wind turbine is about 4 and the swing frequency is about 0 2 hz at rated operating conditions according to the results of this study we taking the pendulum motion showed in fig 12 as an example the pendulum function is equ 32 32 ω y 4 sin 0 2 π t in ref shen et al 2018 xin shen simulated the wind variation of blades under equ 32 fig 13 a is a comparison between the calculated results of this study and xin shen s fig 13 b is a variation diagram of the real wind speed of three blades of a wind turbine in the case of equ 32 with all installation angles of 10 from fig 13 a when the installation angle is existing the instantaneous wind speed varies and the maximum difference reaches 1 2 m s from fig 13 b the real wind speed of each blade is different in magnitude extreme point and increment and decrease which directly results in the inconsistency of the load on the three blades 4 2 aerodynamic load analysis of wind turbines under different case in order to compare the effects of pendulum motion and installation angle on aerodynamic loads this study will assume three cases for analysis and compare xin shen s simulation results details of cases can be found in table 2 the following conclusions can be drawn from fig 14 a 1 case 3 differs greatly from case 1 and case 2 case 3 is a constant value while case 1 case 2 and x shen all have their respective cycles and peaks and their peak values are significantly different from those of case 3 2 case 2 and x shen have close cycles but the upper and lower peaks are different the upper peak of case 2 is slightly larger than x shen while the lower peak is smaller than x shen this reflects the difference in detail between lift surface method and bem in addition most of the calculated values by these two method are closely 3 case 1 is lower than case 2 which shows that the existence of installation angle reduces thrust but basically maintains the original cycle this conclusion is consistent with the engineering practice 4 by comparing the values of average case 2 and case 3 it can be seen that when external loads act on the wind turbine and cause the wind turbine to produce pendulum motion its average thrust will be higher than the constant value of case 3 5 by comparing the values of average case 1 and average case 2 it can be seen that when the wind turbine has yaw angle tilt angle or cone angle the average thrust decreases and the installation angle has control effect on the thrust this conclusion is consistent with the actual control situation of the wind turbine the following conclusions can be drawn from fig 14 b 1 from case 3 and average case 2 it can be seen that when the structure moves due to external loads its average aerodynamic torque will rise which is prone to overload of the main engine 2 comparing average case 2 with average case 1 it can be found that the aerodynamic torque decreases when the installation angle existing this is one of the important methods to prevent the overload of the main engine which is consistent with the actual control situation of the wind turbine 3 other laws are the same as thrust fig 15 a is the thrust comparison diagram of each blade in case 2 because the three blades are located in different spatial positions see fig 10 the thrust will have different amplitudes in the same cycle when there is no installation angle the amplitude is the only constant value fig 15 b is the case 1 blade thrust comparison chart it can be seen that the blade thrust cycle changes and the peak value fluctuates when the installation angle exists the conclusion from fig 14 shows that the average thrust decreases significantly but the peak value of each blade will still reach the value before control if this characteristic is neglected hidden dangers will be buried for the safe operation of the wind turbine 4 3 influence of wind shear on wind speed and calculation example wind shear refers to the phenomenon that wind direction and wind speed change significantly between two points in a short distance in space generally speaking the wind speed at a certain time in a certain place is a function of height which will directly affect the safety of low altitude aircraft and high rise structures wind shear is affected by many conditions mainly thermal factors and dynamic factors among which thermal factors can be attributed to atmospheric stratification and dynamic factors can be attributed to ground roughness the application formula of wind shear in wind industry is as follows 33 v h v hub h h hub χ in the formula χ is the wind shear factor the value is related to many factors such as local topography atmospheric state etc for example the wind shear factors in mountains hills plains and plateaus are different and the value changes with time and space in order to facilitate the development of wind power the relevant national standards china express it as 34 χ log v 2 v 1 h 2 h 1 where v 1 and v 2 are the wind speed at the height of h 1 and h 2 using equ 33 the wind shear factor can be calculated and the function v h can be obtained according to the description in 2 due to the existence of the rotation angle of the blade the blade will be in different height positions in the space at this time if the wind shear is considered the blade elements of each segment at any time will also be in different wind fields with vertical changes as shown in fig 16 the common method to consider the wind shear is to polar coordinate the impeller use the polar coordinate to express the height of the blade at each time and then obtain the wind speed wensha et al 2017 fig 17 is the schematic diagram of polar coordinate method the main idea is to establish a polar coordinate system in the impeller plane and then use the relationship between the polar coordinate system and rectangular coordinate system to find out the spatial position of a segment of the blade element and then obtain the shear wind speed it can be seen from fig 16 that when there is no installation angle and pendulum the polar transformation method can be applied directly once the situation as described in chapter 3 occurs the polar transformation method needs to be modified according to the geometric relationship in fig 18 it is easy to obtain the spatial position of each segment of each blade the expression of instantaneous wind speed can be obtained by combining equ 29 35 v load t ω t y l n t r n 0 1 2 where l n t r is the distance from the position of the r th blade element of the n th blade at the time of t to the rotating axis see fig 18 if the height h n t r at time t is considered it can be expressed as equ 36 after calculating h n t r substitute it into equ 33 to get the shear wind speed v h assuming that the height of the wind turbine tower is 70 m the distance from the yaw shaft to the hub is 5 m the blade speed is 72 6 s the wind shear factor is 0 1 the wind speed at the hub is 12 m s and the other structural dimensions are set according to table 1 the h of the 17 segment blade element can be shown in fig 19 in the actual calculation due to the low pendulum amplitude of the structure the results are not obvious enough so this study enlarges the pendulum amplitude of the structure usually not happen in the actual process only research see table 3 for the simulation situation fig 19 summarizes the calculation results of all simulation conditions in table 3 which simulates the change rule of blade height h in the 17th element of blade 1 in 10 rotation periods it can be seen from fig 19 a that when the wind turbine structure has no installation angle and pendulum movement the change rule of blade element is completely consistentin it can be seen from fig 19 b and c that when the frequency of blade rotation and structure movement is multiple the trajectory of blade height has obvious periodicity especially when the frequency is the same the trajectory of height is basically the same at the same phase of different periods and the distribution is relatively dense it can be seen from fig 19 d and e that when the frequency is inconsistent the height change track will be disordered although it still has periodic characteristics the distribution area of height value will be widened under the same phase of different periods in order to better show the difference of the calculation results fig 19 b and c d and fig 19 a are made a difference and the results are statistical in fig 20 in addition to the above effects the wind shear factor will also lead to the change rule of the instantaneous relative wind speed of the wind turbine blades in order to better analysis the results this paper calculates the shear wind speed according to the simulation conditions in table 4 by observing the results of relative wind speed in fig 21 and fig 22 the influence of wind shear factor on the results is of great importance the wind shear factor will directly affect the amplitude distribution width of relative wind speed the larger the wind shear factor the greater the fluctuation of relative wind speed of the blade which will obviously affect the aerodynamic load of the blade in order to better analyze the influence of wind shear factor fig 23 shows the total thrust and total torque of the blade under condition 2 the increase of wind shear factor directly results in the increase of load amplitude and the widening of load subsection area but also reduces the average load therefore in the actual process of the wind turbine the wind shear factor should be reasonably selected to make it more suitable for the actual wind speed segment of the wind field reduce the design and manufacturing cost and improve the safety index 4 4 prediction of blade load distribution it can be seen from the above iterative process that the change of relative wind speed will directly lead to the change of blade aerodynamics loads and the influence of installation angle structure swing and wind shear on relative wind speed has been analyzed in order to better explain the influence of relative wind speed on blade load distribution this section will simulate the blade load distribution according to table 5 in this study davenport wind spectrum is selected as the simulated wind speed due to the limited space the fitting process of fluctuating wind spectrum will not be introduced in detail in table 4 c represents constant f represents fluctuating wind speed s represents wind shear according to the results of blade thrust distribution under 8 simulation conditions in fig 24 and fig 25 the calculated blade load distribution of classical bem condition 1 has obvious time uniformity while the wind speed in the actual working environment of the wind turbine is not constant condition 3 and condition 7 are load distribution diagrams only considering the wind shear from these two diagrams it can be observed that the load at a certain length changes periodically with time the difference between condition 3 and condition 7 is that condition 3 does not consider the influence of structure swing when the structure swing is an influence factor the load distribution will change significantly condition 2 and condition 6 are the load distribution diagrams only considering the action of fluctuating wind the load distribution of blades is no longer regular and becomes scattered when the structure swing is considered the load distribution regularity is improved which is related to the instantaneous wind vector caused by the structure swing condition 4 and 8 are load distribution diagrams considering both fluctuating wind speed and wind shear when both of them act on the blades at the same time the load distribution is more disordered condition 8 is the result diagram considering all the factors proposed in this paper when the factors affecting the relative wind speed of the wind turbine are considered the load distribution of the blades will become disordered fig 26 and fig 27 are the torque distribution diagram of blade 1 the law is basically similar to the thrust distribution and the analysis conclusion is consistent it can be seen from figs 23 27 that the thrust and torque of the blade element near 11 75 m are relatively large and it is the fourth segment of the blade element under the current model before 36 35 m the thrust of blade element changed greatly and then the change was relatively stable before 28 15 m the torque of blade element changed greatly and then tended to be stable which was the 10th segment of blade element under the current model the closer to the fourth segment of the blade element the denser contour in the image which means the higher the frequency of load change 5 advantages and limitations in this paper the calculation process of blade element momentum theory is discussed in detail and the classical blade element momentum theory is modified based on the actual situation that is the influence of installation angle structure swing wind shear etc the advantages of the modified dynamic blade element momentum theory can be summarized as follows 1 the relative wind speed conditions are more suitable for the actual situation 2 the instantaneous attitude of the wind turbine is included in the load analysis process 3 the iterative results can analyze the load distribution of blades 4 the airfoil layout can be adjusted and replaced at will 5 the iterative calculation speed is relatively fast so resources are saved 6 algorithmic analysis process can help wind turbine control although due to the limitation of research time the theory of dynamic blade momentum still has the following limitations 1 the iterative calculation process of classical blade momentum theory has obvious discrete characteristics and the calculation result is a constant discrete quantity in order to solve the problem of time invariant this paper puts forward the corresponding optimization correction method however based on the blade momentum theory the modified algorithm still has the time varying discrete characteristics 2 in this paper the algorithm correction process does not involve the wake generated by air flow around the blade that is the energy loss of the system taken away by the vortex effect is not considered the reference willis and perairejacob k 2007 spyros 2006 lepape and lecanu 2004 is a representative calculation method of the wake of the blade which is not introduced into the dynamic correction process due to the limitation of research time 6 conclusion through a large number of data analysis and comparison it is proved that the installation angle and structure movement of wind turbine will cause great changes in the real wind speed at blade element if the classical bem is used there will be deviations in thrust aerodynamic torque and other important values and the specific law of load fluctuation can not be revealed in order to solve this problem the blade element momentum theory is revised in this study the specific principle of the modification is given the law of load fluctuation under the combined action of installation angle and pendulum motion of the structure is revealed the variation of aerodynamic load of wind turbine under various combinations is analyzed by using this law the distribution law of thrust and torque of the blade is also analyzed according to ref guzmán et al 2018 dnv standards and other construction standards of offshore platforms such as iec 6400 international standara 2019 law of aerodynamic load revealing and load calculation methods are of great practical significance in engineering this study proceeding from engineering practice focuses on solving practical problems in production and provides theoretical reference for the development of new energy industry the important conclusions of this study can be summarized as following ① by revealing the aerodynamic loads of wind turbines more objectively and detailly it can provide a new theoretical reference for the ultimate loads of wind turbines in structural design and help engineers to make a more detailed assessment of the safety of wind turbines ② the prediction of blade load distribution can provide a fast and reliable theoretical reference for the design of wind turbine blades with the help of lift surface theory or other aerodynamic theories it can help to produce more targeted blades for example the theory of this study can be used to design special blades for the production of wind turbines working in complex geographical areas such as different sea areas altitudes and climatic environments ③ the conclusions and load calculation methods of this study can provide theoretical support for decision making of wind turbine control system for example how can the wind turbine control system more accurately determine the dangerous wind speed with which parameters to prevent the wind turbine from overloading or carry out pitch control ④ compared with cfd simulation the method in this study is faster and easier to program the calculation method in this study can provide help for the design and development of intelligent wind turbine finally it is planned to form an intelligent system for prediction design and optimization of wind turbine wen song et al 2019 credit authorship contribution statement s sang supervision writing review editing hao wen data curation writing original draft software validation writing review editing a x cao methodology x r du methodology x zhu methodology q shi methodology c h qiu methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this article was financial supported by state key laboratory open fund of hydraulic engineering simulation and safety hess 1707 shandong provincial natural science foundation zr2016eem04 key r d plan project of shandong province 2017ghy15101 project of shandong provincial education department j17kb018 
21552,in this paper the dynamic effects of wind turbine installation angle and wind turbine pendulum motion on the constant wind vector and the variation of the real wind vector acting on the blade are discussed respectively the effects of these two conditions on the aerodynamic load and torque of wind turbine are analyzed based on this theory the classical bem is dynamically modified and the specific method of dynamic correction is proposed the modified bem is used to simulate the aerodynamic load and blade load distribution of wind turbines by comparing and analyzing the previous methods the correctness of this method is proved a new aerodynamic load calculation method is proposed for the new energy industry especially for the wind energy industry which can assist engineers in the design analysis control and evaluation of wind turbines keywords bem dynamic modification aerodynamic load of wind turbine wind turbine nomenclature symbols and meaning of the symbols v 1 the inflow velocity at infinity v a the wind speed at front of wind wheel v the wind speed acting on blade p the air pressure at infinity ω the angular velocity of air induced by blades ω the angular velocity of wind wheel rotation k the loss correction coefficient α the inflow angle k tip the tip loss coefficient k hub the root loss coefficient b the number of blades c the chord length of blade element c n the axial force coefficient c n the tangential force coefficient v 0 the real wind speed acting on blade element α the angle between the real wind speed and the blade γ the yaw angle θ the tilt angle ϕ the cone angle β the pitch angle ψ the blade rotation angle h hub the hub height 1 induction aerodynamic load is part of the decisive effects that wind turbine must consider it directly affects the structural design of a wind turbine blade the design of the generator set and the design of control system if it is a floating offshore wind turbine the aerodynamic load will even affect the design of a floating foundation and the mooring system therefore it is extremely important to accurately predict the aerodynamic load that the wind turbine bears in its work there are relatively mature forecasting methods for aerodynamic loads of wind turbines on land under the assumption of rigid blades wind energy captured by wind turbines is closely related to wind speed tip speed ratio coefficient blade geometry its control system etc t ouyang ouyang et al 2017 proposed a data mining method in the research and used it to predict the output power of wind turbines at different wind speeds tip speed ratio coefficients and pitch angles the research results also proved the crucial relationship between aerodynamic loads and the operation of wind turbines many researchers have been attempting to make the interaction between air and wind turbines clear and thorough but limited by the size of wind turbines it is difficult to use real wind turbines for direct experiments however due to the widespread application of cfd commercial software many researchers use cfd software to simulate the interaction between environment and wind turbine x cai cai et al 2016 uses cfd software to simulate the non static wind turbine the author constructs a simulation wind field considers the wind shear effect in actual environment and uses a finite element method to simulate and analyze the interaction between the wind turbine and wind field it can be observed in the results that both the axial load and the blade torque are changing dynamically and the vortices generated by the blade rotation will also change the aerodynamic load this dynamic change is the difficulty in calculating the air load of wind turbine cfd simulation and blade element momentum theory is commonly used to calculate the air load of wind turbines cfd simulation usually needs three dimensional flow field analysis to analyze the flow field of the entire structure of wind turbines which will lead to time consuming simulation and high hardware requirements li et al 2015 ghasemian and nejat 2015 therefore relatively traditional blade element momentum bem theory is more commonly used in industrial production bem is a combined application of blade element theory and the momentum theorem firstly the wind field is simplified to a stream tube the actual wind speed acting on the wind wheel is obtained by using the bernoulli equation before and after the wind wheel then according to the blade element theory the blade is divided into infinite segments and the static mechanical performance of each section of the airfoil in the flow field is computed finally the results of the two methods are combined and the axial and tangential inducing factors are used as bridge to calculate the information of the axial thrust torque and output power of the wind turbine the bem theory is to reduce time consuming inevitably has shortcomings such as the inability to simulate the vortices generated by wind turbines therefore bem theory usually needs a series of modifications such as the prandtl modification luo et al 2015 for the tip loss the modification for the dynamic stall of airfoil gordon leishman 2002 and the glauert modification glauert 1926 for yaw the modification of bem is still in progress chao peng peng et al 2017 used the bem to research the flutter coefficients of blades the blade loads were divided into vibration loads and flutter loads caused by aerodynamic loads in this study the author improved calculation methods of two inducing factors the purpose of this method is to modify the rigidity assumption of blades in traditional bem jerson rogério pinheiro va vaz et al 2011 considered the wake vortices caused by the airflow passing through the wind turbine in the calculation of blade loads this study considered the influence of the wake vortices behind the wind turbine on air loads jc dai dai et al 2011 et al applied the theory of dynamic stall of an airfoil to the analysis of blade load the author considered that the unstable attachment flow would lead to the dynamic stall effect of airfoil due to the existence of yaw angle and revised the iterative calculation process of two inducing factors lin wang wang et al 2014 et al took aeroelastic performance of blade into account in the calculation of blade load combined with bem obtained the thrust and torque generated by blade elastic deformation and also revised the calculation method of inducing factor the dynamic modification of bem is one of the main concerns of researchers currently the results of some studies it can be seen that after modification bem is closer to the engineering reality and also shows the development potential and application value of bem but through more researchers research on the details of the wind field it is found that the current modifications are not enough to make bem accurate enough to fully reflect the changing law of the air load in a constant wind field the induced factor and load distribution calculated by traditional bem and some modified bem remain constant which means that the average value of air load may be corrected accurately but the actual fluctuation law of air load can not be simulated by bem liping dai daiqiang zhou et al 2017 uses cfd software to analyze the influence of blade pitch angle of power load torque and so on it shows that the installation angle of the wind turbine structure has great impact on the actual working effect in particular it will cause periodic fluctuations of power and thrust with the rotation of wind turbines fernando l ponta ponta et al 2016a et al analyzed the effects of geometric installation angles of wind turbines such as yaw angle inclination angle and pitch angle on the performance of wind turbines and plotted the performance curves of wind turbines affected by geometric installation angles under constant wind field from the curve it can be seen that even the constant wind field will be affected by the actual installation and periodic fluctuations will occur xin shen shen et al 2018 used lift surface method to simulate the output power and thrust of a floating wind turbine under a given vibration signal from the change curve it can be seen that for a 5 mw wind turbine the theoretical fluctuation of the input power under a given vibration signal reaches a maximum value of nearly 10 mw and the minimum value is less than 2 mw g r tomasicchio tomasicchio et al 2018 experimented with the vibration of spar offshore wind turbines by using a proportional model the results demonstrate that the swing angle of spar offshore wind turbines is between once the size of wind turbines increases the swing angle of will lead to a sharp increase in the relative wind speed of blade tips thus directly affecting the performance of the wind turbines from the existing conclusions we know that without considering the dynamic changes of wind turbine foundation vibration and wind field the performance fluctuation caused by geometric installation angle is very obvious once the foundation vibration and wind field change the influence will be magnified there are many environmental conditions leading to the vibration of the wind turbine foundation and the change of the wind field for the wind turbine on land there are structural vibration vibration caused by earthquake etc for the wind turbine on the sea there are wave action ocean current action seabed earthquake action vibration caused by other ships etc therefore the reasonable values can not be corrected only by empirical or semi empirical coefficients but also the actual load of wind turbine when the installation angle and environmental conditions work together only by more thorough and objective analysis of the action law of the real load can the structure and parts of the wind turbine be better designed so as to avoid overload blade breakage and abnormal fatigue damage tower breakage mooring system damage and wind turbine control system failure or inadequate capacity to reduce the cost of wind turbine construction and improve the safety of wind turbine operation to provide theoretical support for the new energy industry and to contribute to the global clean renewable energy utilization in summary this study will propose a bem correction method considering dynamic inflow angle analyze the influence of installation angle on aerodynamic load of wind turbine and propose a calculation method for aerodynamic load of wind turbine blade considering both installation angle and structural pendulum motion considering the change of wind turbine performance under known structural load response it serves as a theoretical reference for the in depth study of the design and manufacture of wind turbines 2 comparison of different modifications of classical bem bem is a combination of the momentum theorem and blade element theory it is a common method to simulate aerodynamic loads of wind turbines its purpose is to calculate the axial inducing factor a and tangential inducing factor b by iteration calculation and then calculate important parameters such as power coefficient pressure coefficient and thrust abutunis et al 2019 by using a and b the basic model of wind turbine power theory silvaa et al 2018 is presented in fig 1 it assumes that the energy system composed of wind field and blade is an expanding stream tube the inflow velocity at infinity is v 1 the wind speed at front of wind wheel is v a the wind speed acting on blade is v and the air pressure at infinity is p applying bernoulli equation and the momentum conservation theorem before and after the wind turbine the formulas of thrust and torque expressed by inducing factors can be obtained due to the limitation of the length of the article the momentum theory will not be derived in detail in this paper the formulas can be seen in equs 1 and 2 silvaa et al 2018 1 d f 4 π ρ v 1 2 a 1 a r k d r 2 d t 4 π ρ v 1 ω b 1 a r 3 k d r according to relevant definitions in the industry 3 a v 1 v a v 1 4 b ω 2 ω where ω is the angular velocity of air induced by blades ω is the angular velocity of wind wheel rotation k is the loss correction coefficient which is mostly a semi empirical formula and its purpose is to correct the errors caused by the results such as tip loss and root loss the model of blade element theory is illustrated in fig 2 its basic assumption is that rigid blades are divided into several segments along the span direction and the lift force drag force and air load of each segment are calculated respectively by using the aerodynamic characteristics of blade airfoil by integrating the whole blade the load and performance of the entire blade can be obtained from the blade element theory yoshida 2018 and airfoil aerodynamics the following relations can be obtained 5 d f 1 2 b ρ c v 0 2 c n d r 6 d t 1 2 b ρ c v 0 2 c t d r where b is the number of blades c is the chord length of blade element c n and c t are the axial force coefficient and tangential force coefficient v 0 is the real wind speed acting on blade element 7 c n c l cos α c d sin α 8 c t c l sin α c d cos α the synthesis diagram of the real wind speed acting on a blade element is shown in fig 3 due to the space limitation the relationship between wind speed will not be deduced in detail in this paper the specific process can be referred to any wind turbine aerodynamics textbook the real wind speed of blade element v 0 can be obtained by geometric calculation by using equs 1 2 5 and 6 and taking v 0 into them the following relations can be obtained 9 a 1 a σ c n 4 k sin 2 α 10 b 1 b σ c t 4 k sin α cos α where α is the inflow angle σ b c 2 π r by using equs 9 and 10 a and b can be solved by iteration method the correction coefficients k in equs 9 and 10 usually include tip loss coefficient k tip and hub loss coefficient k hub the expressions of tip correction coefficient and hub correction coefficient are as follows jonkman et al 2009 11 k tip 2 π arccos exp b r r 2 r sin α 12 k hub 2 π arccos exp b r r 0 2 r 0 sin α the angle α between the real wind speed and the blade can be calculated from fig 3 the flow chart of the iteration calculation is shown in fig 4 13 α arctan 1 a v 1 1 b ω r 14 ζ α β the modification method of ref peng et al 2017 is as follows 15 a k 18 k 20 3 c f 50 36 k 12 k 3 k 4 36 k 50 a 0 4 16 c f 1 a 2 σ sin 2 α c l cos α c d sin α the modification method of ref dai et al 2011 is as follows 17 a 1 min 0 5 t 1 6 t 2 t 3 a 0 4 18 t 1 18 σ c n 36 f 2 sin 2 α 40 f sin 2 α 19 t 2 18 f sin 2 α σ c n 36 f 4 sin 4 α 48 f 3 sin 4 α 1 2 20 t 3 9 σ c n 50 f sin 2 α 36 f 2 sin 2 α both of these two methods take care of the axial inducing factor uniquely in the iterative process limited by the length of the article the specific principles of the two methods are not given in this paper this article will only list their correction process eq 15 eq 16 and eq 17 eq 20 the location of these two correction methods in the iterative process is illustrated in fig 3 the results of the two methods are shown in fig 5 a and b c the figure shows the calculation results of the axial induction factor when the wind turbine speed is 10 s 20 s and 30 s and the wind speed is v 1 5 m s as can be seen from fig 5 the x axes of fig 5 is the number of blade elements one blade is divided into 17 segments with the increase of the ratio of rotational speed to wind speed the difference of the axial inducing factor calculated by the two methods also increases gradually the revised value at the tip of the blade is the largest and the ratio of the revised value to the original value exceeds 6 the average correction rates under the three calculation assumptions were 3 29 3 30 and 3 29 respectively due to the different correction methods the inducing factors of the same blade would be significantly different 3 load calculation method and result analysis considering installation angle 3 1 effect of installation angle on wind vector acting on blades the possible angles during the operation of wind turbines are shown in fig 6 the operation control system of wind turbines usually makes the wind turbine have yaw angle γ tilt angle θ cone angle ϕ pitch angle β and blade rotation angle ψ in this study yaw angle pitch angle and cone angle are considered as installation angles the existence of installation angle will make the wind field no longer directly opposite the wind wheel so the assumption of the traditional bem is invalid in order to better solve the difference between the bem hypothesis and the actual situation the wind vector relative to the geodetic coordinate system is converted into the blade section by using the matrix transformation method because the blade rotates the original constant wind vector will change dynamically which will cause the inflow angle to change dynamically therefore this section will modify the bem from the angle of the installation angle s influence on the inflow angle and the relative wind speed 21 a γ cos γ sin γ 0 sin γ cos γ 0 0 0 1 a θ cos θ 0 sin θ 0 1 0 sin θ 0 cos θ a ψ 1 0 0 0 cos ψ sin ψ 0 sin ψ cos ψ a ϕ cos ϕ 0 sin ϕ 0 1 0 sin ϕ 0 cos ϕ a β cos β sin β 0 sin β cos β 0 0 0 1 assuming that each part of the blade is rigid body considering that the coordinate transformation is rotational transformation the transformation matrix of each angle is as follows according to the angle transformation matrix equ 21 the expression method of wind vector v 1 i j k in the coordinate system of blade section equ 22 can be obtained 22 v 1 b v b i v b j v b k n 1 i j k where n 1 is the total transformation matrix of coordinate system 23 n 1 a β a φ a ψ a θ a γ is a quantity related to azimuth angle because the azimuth angle of wind turbine is proportional to the blade speed in normal operation a is also a variable related to time which means n 1 f t assuming that the wind vector is v 1 500 the rotational speed of wind turbine is 5 s yaw angle γ 5 tilt angle θ 5 cone angle ϕ 5 and β are set up according to the model in table 1 model data source is nrel all the real wind speeds acting on blade element can be obtained by equ 22 the variation of real wind speed is shown in fig 7 in which the circumference represents the rotation angle and the ordinate represents the relative wind speed with the chord length of blade element from fig 7 it can be seen that the wind speed of the first blade element fluctuates between 5 0169 and 4 8878 and the angle between 19 3200 and 6 5890 the wind speed of the last blade element fluctuates between 4 8895 and 5 0001 and the angle between 7 1944 and 6 9896 the range of the two fluctuations is smaller than that of the first blade element according to the definition of inducing factor it can be seen that the wind with periodic change will change the inducing factor so it can not be ignored in chao peng s and j c dai s methods of calculating the inducing factor the wind field is constant but it can be seen from the above calculation that when considering the installation angle the constant wind field will change periodically which leads to the inducing factor is no longer a constant value of the time but a change value the inducing factors of this change will directly lead to the periodic variation of thrust and torque and even other coefficients with time 3 2 bem correction method and result analysis considering installation angle as mentioned in 2 1 in the iteration process of classical bem wind speed v 1 is assumed to be a constant value but in fact the relative wind field acting on the blade will change with time and the real wind speed acting on each blade element is different if the constant value is used some errors will occur therefore the correction of this effect should be considered in the iteration calculation process because v 1 b changes periodically with time an improved algorithm of inducing factors a and b can be obtained by iterating with v 1 b instead of v 1 the original formula is eq 13 24 α arctan 1 a v 1 b 1 b ω r by using equ 24 to replace the corresponding items in the original process while retaining the glauert correction coefficient the inducing factor considering the installation angle can be obtained to verify the calculation method proposed in this study the results of j jonkman jonkman et al 2009 w xudong xudong et al 2009 f l ponta ponta et al 2016b are compared according to j jonkman s research the rated wind speed of a 5 mw wind turbine is a the rated speed is b and the 5 mw wind turbine will be propeller controlled to control the input power when the wind speed exceeds the rated wind speed therefore this study will compare the power of the wind turbine before pitch control to verify the computational power of the code fig 8 a is the power comparison assuming that all installation angles are zero fig 8 b indicates the difference between the calculation results of power with or without installation angle each angle of installation is 10 from fig 8 a it can be seen that the code provided in this study fits well with the three authors from fig 8 b it can be seen that due to the existence of installation angle the power of wind turbine decreases significantly in calculation and the faster the wind speed the more obvious the reduction is the cause of this reduction is the change of relative wind speed caused by installation angle if this change is neglected the calculation of thrust torque and other important parameters will be significantly different resulting in accidents therefore this phenomenon can not be ignored in engineering practice fig 9 shows the variation of thrust of wind turbine with blade rotation the thrust is a constant value without considering the installation angle once the installation angle is considered the axial thrust will become a periodic change with time and a relatively small amount it also proves that the control system of wind turbine can reduce the air load on the structure by controlling the installation angle therefore it is necessary to reveal this effect more deeply in order to enhance the control effect 4 load calculation method and result analysis considering the simultaneous action of pendulum motion and installation angle 4 1 effect of pendulum motion on wind vector acting on blades 4 1 1 dynamization of constant wind vector it is assumed that the structural dynamic response of a wind turbine is known when it is in a normal and stable working state assuming that the dynamic response of the structure is ω x t ω y t and ω z t they are rotations around axes x y and z using the method in 2 1 the rotation of coordinate system x y z can be transferred to blade cross section coordinate system and then the real wind vector can be obtained 25 ω x b t ω y b t ω z b t n 1 ω x t ω y t ω z t after the structural response is transferred by equ 25 the response functions and of the blade section are determined these three fixed axis rotations will affect the magnitude and inflow angle of the real wind vector therefore the transformation matrix of coordinate system can be determined according to the principle of 2 1 26 a x b t 1 0 0 0 cos ω y b t sin ω y b t 0 sin ω y b t cos ω y b t a y b t cos ω y b t 0 sin ω y b t 0 1 0 sin ω y b t 0 cos ω y b t a z b t cos ω y b t sin ω y b t 0 sin ω y b t cos ω y b t 0 0 0 1 on the basis of equ 22 by using equ 26 the constant wind vector can be corrected 27 v r e a l t v r e a l b i t v r e a l b j t v r e a l b k t n 2 v b i v b j v b k 28 n 2 a x b t a y b t a z b t it can be proved by equ 27 that after two modifications the wind vector becomes a time dependent variable so the thrust and torque calculated will be time varying rather than constant even if equ 27 is not used the wind vector modified by equ 22 is also time dependent 4 1 2 generation of instantaneous wind speed as showed in fig 10 the pendulum motion caused by environment will not only affect the constant wind vector but also make the structure produce instantaneous wind speed instantaneous wind speed will directly lead to the change of the real wind speed and this change will increase significantly with the increase of the 29 v load t ω t y d 2 h hub l 2 l 1 cos ψ t 2 n π 3 2 n 0 1 2 the instantaneous wind speed caused by pendulum motion can be obtained by equ 29 in equ 29 h hub is the hub height cos 2 n π 3 is the interval between two blades ω y is the pendulum function equ 29 can be used to calculate the instantaneous wind speed at different blade elements the instantaneous wind speed can be added to the real wind speed of the blade section calculated by equ 28 30 v ins tan t v load v real with the replacement of v 1 b in equ 24 the joint correction of pendulum motion and installation angle can be made for bem the flow chart of the correction is shown in fig 11 nrel s jonkman and buhl 2007 studied the oscillation of a 5 mw offshore floating wind turbine by numerical simulation it is concluded that the swing angle of wind turbine is about 4 and the swing frequency is about 0 2 hz at rated operating conditions according to the results of this study we taking the pendulum motion showed in fig 12 as an example the pendulum function is equ 32 32 ω y 4 sin 0 2 π t in ref shen et al 2018 xin shen simulated the wind variation of blades under equ 32 fig 13 a is a comparison between the calculated results of this study and xin shen s fig 13 b is a variation diagram of the real wind speed of three blades of a wind turbine in the case of equ 32 with all installation angles of 10 from fig 13 a when the installation angle is existing the instantaneous wind speed varies and the maximum difference reaches 1 2 m s from fig 13 b the real wind speed of each blade is different in magnitude extreme point and increment and decrease which directly results in the inconsistency of the load on the three blades 4 2 aerodynamic load analysis of wind turbines under different case in order to compare the effects of pendulum motion and installation angle on aerodynamic loads this study will assume three cases for analysis and compare xin shen s simulation results details of cases can be found in table 2 the following conclusions can be drawn from fig 14 a 1 case 3 differs greatly from case 1 and case 2 case 3 is a constant value while case 1 case 2 and x shen all have their respective cycles and peaks and their peak values are significantly different from those of case 3 2 case 2 and x shen have close cycles but the upper and lower peaks are different the upper peak of case 2 is slightly larger than x shen while the lower peak is smaller than x shen this reflects the difference in detail between lift surface method and bem in addition most of the calculated values by these two method are closely 3 case 1 is lower than case 2 which shows that the existence of installation angle reduces thrust but basically maintains the original cycle this conclusion is consistent with the engineering practice 4 by comparing the values of average case 2 and case 3 it can be seen that when external loads act on the wind turbine and cause the wind turbine to produce pendulum motion its average thrust will be higher than the constant value of case 3 5 by comparing the values of average case 1 and average case 2 it can be seen that when the wind turbine has yaw angle tilt angle or cone angle the average thrust decreases and the installation angle has control effect on the thrust this conclusion is consistent with the actual control situation of the wind turbine the following conclusions can be drawn from fig 14 b 1 from case 3 and average case 2 it can be seen that when the structure moves due to external loads its average aerodynamic torque will rise which is prone to overload of the main engine 2 comparing average case 2 with average case 1 it can be found that the aerodynamic torque decreases when the installation angle existing this is one of the important methods to prevent the overload of the main engine which is consistent with the actual control situation of the wind turbine 3 other laws are the same as thrust fig 15 a is the thrust comparison diagram of each blade in case 2 because the three blades are located in different spatial positions see fig 10 the thrust will have different amplitudes in the same cycle when there is no installation angle the amplitude is the only constant value fig 15 b is the case 1 blade thrust comparison chart it can be seen that the blade thrust cycle changes and the peak value fluctuates when the installation angle exists the conclusion from fig 14 shows that the average thrust decreases significantly but the peak value of each blade will still reach the value before control if this characteristic is neglected hidden dangers will be buried for the safe operation of the wind turbine 4 3 influence of wind shear on wind speed and calculation example wind shear refers to the phenomenon that wind direction and wind speed change significantly between two points in a short distance in space generally speaking the wind speed at a certain time in a certain place is a function of height which will directly affect the safety of low altitude aircraft and high rise structures wind shear is affected by many conditions mainly thermal factors and dynamic factors among which thermal factors can be attributed to atmospheric stratification and dynamic factors can be attributed to ground roughness the application formula of wind shear in wind industry is as follows 33 v h v hub h h hub χ in the formula χ is the wind shear factor the value is related to many factors such as local topography atmospheric state etc for example the wind shear factors in mountains hills plains and plateaus are different and the value changes with time and space in order to facilitate the development of wind power the relevant national standards china express it as 34 χ log v 2 v 1 h 2 h 1 where v 1 and v 2 are the wind speed at the height of h 1 and h 2 using equ 33 the wind shear factor can be calculated and the function v h can be obtained according to the description in 2 due to the existence of the rotation angle of the blade the blade will be in different height positions in the space at this time if the wind shear is considered the blade elements of each segment at any time will also be in different wind fields with vertical changes as shown in fig 16 the common method to consider the wind shear is to polar coordinate the impeller use the polar coordinate to express the height of the blade at each time and then obtain the wind speed wensha et al 2017 fig 17 is the schematic diagram of polar coordinate method the main idea is to establish a polar coordinate system in the impeller plane and then use the relationship between the polar coordinate system and rectangular coordinate system to find out the spatial position of a segment of the blade element and then obtain the shear wind speed it can be seen from fig 16 that when there is no installation angle and pendulum the polar transformation method can be applied directly once the situation as described in chapter 3 occurs the polar transformation method needs to be modified according to the geometric relationship in fig 18 it is easy to obtain the spatial position of each segment of each blade the expression of instantaneous wind speed can be obtained by combining equ 29 35 v load t ω t y l n t r n 0 1 2 where l n t r is the distance from the position of the r th blade element of the n th blade at the time of t to the rotating axis see fig 18 if the height h n t r at time t is considered it can be expressed as equ 36 after calculating h n t r substitute it into equ 33 to get the shear wind speed v h assuming that the height of the wind turbine tower is 70 m the distance from the yaw shaft to the hub is 5 m the blade speed is 72 6 s the wind shear factor is 0 1 the wind speed at the hub is 12 m s and the other structural dimensions are set according to table 1 the h of the 17 segment blade element can be shown in fig 19 in the actual calculation due to the low pendulum amplitude of the structure the results are not obvious enough so this study enlarges the pendulum amplitude of the structure usually not happen in the actual process only research see table 3 for the simulation situation fig 19 summarizes the calculation results of all simulation conditions in table 3 which simulates the change rule of blade height h in the 17th element of blade 1 in 10 rotation periods it can be seen from fig 19 a that when the wind turbine structure has no installation angle and pendulum movement the change rule of blade element is completely consistentin it can be seen from fig 19 b and c that when the frequency of blade rotation and structure movement is multiple the trajectory of blade height has obvious periodicity especially when the frequency is the same the trajectory of height is basically the same at the same phase of different periods and the distribution is relatively dense it can be seen from fig 19 d and e that when the frequency is inconsistent the height change track will be disordered although it still has periodic characteristics the distribution area of height value will be widened under the same phase of different periods in order to better show the difference of the calculation results fig 19 b and c d and fig 19 a are made a difference and the results are statistical in fig 20 in addition to the above effects the wind shear factor will also lead to the change rule of the instantaneous relative wind speed of the wind turbine blades in order to better analysis the results this paper calculates the shear wind speed according to the simulation conditions in table 4 by observing the results of relative wind speed in fig 21 and fig 22 the influence of wind shear factor on the results is of great importance the wind shear factor will directly affect the amplitude distribution width of relative wind speed the larger the wind shear factor the greater the fluctuation of relative wind speed of the blade which will obviously affect the aerodynamic load of the blade in order to better analyze the influence of wind shear factor fig 23 shows the total thrust and total torque of the blade under condition 2 the increase of wind shear factor directly results in the increase of load amplitude and the widening of load subsection area but also reduces the average load therefore in the actual process of the wind turbine the wind shear factor should be reasonably selected to make it more suitable for the actual wind speed segment of the wind field reduce the design and manufacturing cost and improve the safety index 4 4 prediction of blade load distribution it can be seen from the above iterative process that the change of relative wind speed will directly lead to the change of blade aerodynamics loads and the influence of installation angle structure swing and wind shear on relative wind speed has been analyzed in order to better explain the influence of relative wind speed on blade load distribution this section will simulate the blade load distribution according to table 5 in this study davenport wind spectrum is selected as the simulated wind speed due to the limited space the fitting process of fluctuating wind spectrum will not be introduced in detail in table 4 c represents constant f represents fluctuating wind speed s represents wind shear according to the results of blade thrust distribution under 8 simulation conditions in fig 24 and fig 25 the calculated blade load distribution of classical bem condition 1 has obvious time uniformity while the wind speed in the actual working environment of the wind turbine is not constant condition 3 and condition 7 are load distribution diagrams only considering the wind shear from these two diagrams it can be observed that the load at a certain length changes periodically with time the difference between condition 3 and condition 7 is that condition 3 does not consider the influence of structure swing when the structure swing is an influence factor the load distribution will change significantly condition 2 and condition 6 are the load distribution diagrams only considering the action of fluctuating wind the load distribution of blades is no longer regular and becomes scattered when the structure swing is considered the load distribution regularity is improved which is related to the instantaneous wind vector caused by the structure swing condition 4 and 8 are load distribution diagrams considering both fluctuating wind speed and wind shear when both of them act on the blades at the same time the load distribution is more disordered condition 8 is the result diagram considering all the factors proposed in this paper when the factors affecting the relative wind speed of the wind turbine are considered the load distribution of the blades will become disordered fig 26 and fig 27 are the torque distribution diagram of blade 1 the law is basically similar to the thrust distribution and the analysis conclusion is consistent it can be seen from figs 23 27 that the thrust and torque of the blade element near 11 75 m are relatively large and it is the fourth segment of the blade element under the current model before 36 35 m the thrust of blade element changed greatly and then the change was relatively stable before 28 15 m the torque of blade element changed greatly and then tended to be stable which was the 10th segment of blade element under the current model the closer to the fourth segment of the blade element the denser contour in the image which means the higher the frequency of load change 5 advantages and limitations in this paper the calculation process of blade element momentum theory is discussed in detail and the classical blade element momentum theory is modified based on the actual situation that is the influence of installation angle structure swing wind shear etc the advantages of the modified dynamic blade element momentum theory can be summarized as follows 1 the relative wind speed conditions are more suitable for the actual situation 2 the instantaneous attitude of the wind turbine is included in the load analysis process 3 the iterative results can analyze the load distribution of blades 4 the airfoil layout can be adjusted and replaced at will 5 the iterative calculation speed is relatively fast so resources are saved 6 algorithmic analysis process can help wind turbine control although due to the limitation of research time the theory of dynamic blade momentum still has the following limitations 1 the iterative calculation process of classical blade momentum theory has obvious discrete characteristics and the calculation result is a constant discrete quantity in order to solve the problem of time invariant this paper puts forward the corresponding optimization correction method however based on the blade momentum theory the modified algorithm still has the time varying discrete characteristics 2 in this paper the algorithm correction process does not involve the wake generated by air flow around the blade that is the energy loss of the system taken away by the vortex effect is not considered the reference willis and perairejacob k 2007 spyros 2006 lepape and lecanu 2004 is a representative calculation method of the wake of the blade which is not introduced into the dynamic correction process due to the limitation of research time 6 conclusion through a large number of data analysis and comparison it is proved that the installation angle and structure movement of wind turbine will cause great changes in the real wind speed at blade element if the classical bem is used there will be deviations in thrust aerodynamic torque and other important values and the specific law of load fluctuation can not be revealed in order to solve this problem the blade element momentum theory is revised in this study the specific principle of the modification is given the law of load fluctuation under the combined action of installation angle and pendulum motion of the structure is revealed the variation of aerodynamic load of wind turbine under various combinations is analyzed by using this law the distribution law of thrust and torque of the blade is also analyzed according to ref guzmán et al 2018 dnv standards and other construction standards of offshore platforms such as iec 6400 international standara 2019 law of aerodynamic load revealing and load calculation methods are of great practical significance in engineering this study proceeding from engineering practice focuses on solving practical problems in production and provides theoretical reference for the development of new energy industry the important conclusions of this study can be summarized as following ① by revealing the aerodynamic loads of wind turbines more objectively and detailly it can provide a new theoretical reference for the ultimate loads of wind turbines in structural design and help engineers to make a more detailed assessment of the safety of wind turbines ② the prediction of blade load distribution can provide a fast and reliable theoretical reference for the design of wind turbine blades with the help of lift surface theory or other aerodynamic theories it can help to produce more targeted blades for example the theory of this study can be used to design special blades for the production of wind turbines working in complex geographical areas such as different sea areas altitudes and climatic environments ③ the conclusions and load calculation methods of this study can provide theoretical support for decision making of wind turbine control system for example how can the wind turbine control system more accurately determine the dangerous wind speed with which parameters to prevent the wind turbine from overloading or carry out pitch control ④ compared with cfd simulation the method in this study is faster and easier to program the calculation method in this study can provide help for the design and development of intelligent wind turbine finally it is planned to form an intelligent system for prediction design and optimization of wind turbine wen song et al 2019 credit authorship contribution statement s sang supervision writing review editing hao wen data curation writing original draft software validation writing review editing a x cao methodology x r du methodology x zhu methodology q shi methodology c h qiu methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this article was financial supported by state key laboratory open fund of hydraulic engineering simulation and safety hess 1707 shandong provincial natural science foundation zr2016eem04 key r d plan project of shandong province 2017ghy15101 project of shandong provincial education department j17kb018 
21553,in the present research the experimental study of wave transmission through a new designated perforated half depth breakwater is investigated for this purpose three models of structures that differed from porosity were tested by measuring three wave heights and at least ten periods in water depth and draft depth from the structure after conducting experimental and analytical studies a comparison was made between theoretical and laboratory data according to the results of the present study the experimental data was completely in agreement with the results obtained from solving the governing equation theory also based the result in a wall with porosity of 15 a 50 decrease in wave height was observed the behavior of each model of the structure against the waves was also justified by careful examination of the wave power the results show that increase in the parameters such as wavelength of incident waves on the structure the wave steepness due to reduction of wavelength in a constant wave height the wave height at a constant wavelength and the wave height with simultaneous decrease in the wavelength could lead to reduction of the wave transmission coefficient from the structure unless the structure had reached the final limit of water volume transmission capacity from itself in time unit keywords experimental study half depth perforated wall wave transfer 1 introduction the coastal walls are generally designed to protect beaches from wave forces and prevent water flowing to coast for proper use of coastal land the hydrostatic pressure fluctuations and the hydrodynamic pressure on the vertical breakwater wall lead to imposition of large forces on the structure and sometimes even their damage or destruction to fix this problem the walls should be heavier and larger to reduce the risk of them being broken or overturned for this reason the technology of perforated wall breakwater was developed this type of structure reduces the height of the designed wall by reducing the level of incident against the waves as well as reducing the wave reflection and the force applied to the wall suh et al 2006 compared the results of a numerical model with a laboratory model on perforated wall caisson break water they tested three perforated plates with the same porosity and different vertical horizontal and perforated slots accordingly the lowest reflection of the breakwater occurred when the ratio of the wavelength chamber to the radiant wavelength was 0 25 koraim and salem 2012 studied a breakwater consisting of a row of semi suspended pipes on the water depth they studied the regular wave periods ranging from of 0 65 1 33 s and height of 5 22 cm they reported that when the structure was in the relative depth d h of 0 5 and zero in porosity at 45 the waves could reach the transmission coefficient less than 20 reflection coefficient higher than 40 and energy dissipation coefficient of about 80 huang 2007 carried out a study on a vertical slotted barrier extending across the water depth this research was conducted for a row of these walls with four different thicknesses and four different percent of porosity in a constant period of 1 1 s and under the incident of five different wave heights of 2 6 cm at h h ratio of 0 2 and a porosity of 20 the ratio of the wave height incidence to water depth reached the transmission coefficient of 70 and reflection coefficient of about 25 several similar studies have also been conducted on semi submerged breakwater relaying on supportive piles or cables fang et al 2018 he and huang 2014 jun et al 2012 koraim 2013 2015 koraim et al 2014 neelamani and ljubic 2018 wang et al 2006 2016 ahmed et al 2011 developed a numerical model based on an eigen function expansion method for regular linear wave interactions with a single and double vertical slotted wall and nonlinear stokes second order wave interactions with a single vertical slotted wall they validated the numerical model by comparing its results with those of previous studies and their own experimental results the authors found that f and the coefficient of porosity ε significantly influence the reflection cr transmission ct and wave energy dissipation ce coefficients of permeable breakwaters while the influence of the added mass coefficient cm is minimal and can be omitted for this configuration elbisy et al 2016 studied examines the hydrodynamic performance of multiple row vertical slotted breakwaters the numerical results indicate that for triple row walls the effect of the arrangement of the chamber widths on hydrodynamic characteristics is not significant except when kd 0 5 there are two major views on assessing the behavior of vertical wave barrier and other perforated structures against the wave the first one is potential flow method based on calculating the velocity of potential function under specific boundary conditions jun et al 2012 kakuno 1983 kojima et al 1988 liu et al 2012 mohammad bagheri et al 2018 qiao et al 2018 venkateswarlu and karmakar 2019 in these studies based on simplified hydraulic theory wave passage through slit type vertical wave barrier was obtained in a state with half depth barrier against wave this theory is based on basic hydraulic principles such as mass conservation momentum and energy equations in this theory the wave transition of the structure and the wave force on the structure are primarily defined by the maximum horizontal component of the water particle velocity that passes through the aperture or slit of the structure with the maximum pressure gradient however the maximum pressure gradient as well as the maximum horizontal velocity of water particles occur at the crest and trough of the wave another theory is based on the basic hydraulic principles regarding the calculating of pressure head loss in fluid flow from the structure hayashi and tokutaro 1966 kakuno 1983 kojima et al 1988 liu and abbaspour 1982 lópez et al 2018 maría et al 2019 mei et al 1974 mohammadbagheri et al 2019 venkateswarlu and karmakar 2019 weiliang et al 2018 examination of waveguide structure designs showed that most of the structures used were high cost extremely complex and time consuming review of the previous researches also indicated that most of the researches on non porous and porous structures have been in full depth therefore in the present study a new design for porous barrier with half depth conditions was designed and tested 2 method and material 2 1 experimental methods the flume used in these experiments had a width length and depth of 5 5 33 and 1 m respectively it consisted of three parts separated by a wall the width of the middle part of the flume where the structure was installed was 1 m and the width of the two sides is 1 5 m the wave generator system was located at the beginning of the flume which included a pedal operated by hydraulic arms with oil pressure at the end of the flume there was also depreciation system of sandy beach to reduce the impact and depreciation of the recurring wave in this study a semi submerged breakwater based on pile made of pvc plastic blocks and cable laying blocks was used the wave transmission coefficient of three different models of structure which had porosity difference were investigated under the regular waves incidence in the period of 0 9 2 2 s and in the elevation range of 5 15 cm figs 1 and 2 table 1 indicated the specifications of laboratory parameters for the formation of breakwater structure including measurement units and the range of variation of each the structural model consisted of a series of cubic blocks of pvc overlapped by the cable table 2 the length width and thickness of these blocks were 9 4 and 1 6 cm respectively the unit weight of the pvc sheet used in the construction of the blocks was 0 486 g cm3 table 2 illustrates the structural characteristics of the model completely in the present study the height of the windage of the structural model was calculated using a heuristic method based on miche rundgren method for non breaking waves assuming of a non porous and rigid wall extending up to half the water depth the metal cables were connected to each other by small cable clip connections first the overall metal cable was connected to the connections installed on the metal frame and then the vertical cables connect the blocks to each other and also to the main cable around the fittings fig 3 the metal frame supporting the block made wall in the flume body had a length width height and thickness of 101 11 101 5 and 0 5 cm respectively due to using some assumptions as the impact of non breaking wave on the structure and intermediate water depth area with relative wavelength between 0 05 d l 0 5 only the waves with the stokes first and second order theory were investigated and the waves of stokes above third order theory were ignored these high steepness waves interact with the reflected wave from the structure and break down the wave shouldn t break before reaching the structure otherwise there will be a little energy dissipation in it also this energy loss cannot be considered as an evaluation of the structure s performance in reducing altitude and wave energy and then it is better to avoid this event after wave transfer from the structure its height was taken by two wave gauges and its mean was recorded as the transmitted wave height from the structure table 3 fig 4 the wave transmission coefficient kt was defined with the ratio of wave height transmitted from the structure ht to the incident wave height to the structure hi 5 k t h t h i after fabricating the first model of structure with 35 porosity and performing the wave series experiments on it the wave transmission coefficients from it were determined and the structural porosity was then reduced for the experiment on the second and third model by covering 60 holes 10 of the structural porosity was reduced and the porosity percentage for the second and third models reached to 25 and 15 respectively then as shown in table 3 the experiments of wave series were again performed for each of them and transmission coefficient was determined 2 2 calibration for this purpose two wave gauges with a distance of 1 m were used at the site of the structure this way in addition to ensuring the validity of wave gauges data used the moving distance of a peak between two wave gauges wave and progressive wave velocity could be determined finally by multiplying it by the wave period the wavelength could be obtained by laboratory method by comparing the recording time of two peaks together in the time series graph recorded by two wave gauges the time difference of the data recording between the two wave gauges could be obtained figs 5 and 6 since the distance between the two wave gauges was 1 m progressive wave velocity was obtained by reversing the time difference eqs 3 and 4 3 c l m δ t sec 4 l c t in the incident wave calibration a significant wave criterion was considered at the structure establishment site and the mean of wave specifications recorded in two wave gauges to determine the scale of the model the maximum power of the wave generation device without suffering excessive pressure or loss of accuracy should be determined to this end the maximum height and period of the wave that could be created by the wave generation device had to be determined this information regarding real waves of the sea were available and had to be compared with laboratory information to determine the maximum scale therefore the scale number required to construct a model must be smaller or ultimately equal to the maximum number of scales based on laboratory limitations the maximum depth of water to be studied in the laboratory must be determined therefore the force limitation on metal cables did not create scale restriction likewise given the constraints that exist it should be examined whether or not those constraints lead to scale restrictions in this research the accepted scale for constructing of the experimental model was 1 20 3 results and discussion after determining the transmitted waves from the three models of structure using eq 5 the wave transmission coefficient from the structure was determined for them since structure width b water depth d and water depth of structure h have constant values they become dimensionless with parameters such as wave height hi and wavelength l thus after adjusting natural conditions to laboratory conditions these constant parameters can be easily calculated for real conditions since in nature each irregular wave has a significant height hs and a significant period ts or in fact a significant wavelength ls therefore by having the indices of this irregular wave and relating them via constructing dimensionless parameter to constant parameters such as structure draft depth structure breadth and water depth these constant parameters could be obtained for natural conditions as they were consistent with the laboratory conditions as shown in fig 7 a d l b of wave transmission coefficient from the structure increased by increasing the relative wave length also by increasing the relative wave height h h and h d the wave transmission coefficient from the structure reduced in lower height ratios h h with decreasing the porosity percentage from the first model to the third model the chart became steeper indicating increase in dependence on dimensionless parameter of l b however increasing the h h ratio and decreasing the porosity of the structure simultaneously decreased the increasing trend of dependence on the dimensionless l b parameter in height ratio h h of 0 6 by reducing the porosity percentage and the third model of structure it had inverse or decreasing trend also by reducing the structure porosity percentage the height ratio h h increased and the wave transmission coefficient from the structure decreased as shown in fig 7a d it can be said that at constant relative wavelength l b with increasing the relative wave height h h leading to increase in wave steepness of h l the wave transmission coefficient from the structure for three models reduced this was clearly shown in fig 7c and d and 8 according to fig 7a d and considering the wave relative height h h as constant value and by reducing the relative wave length l b the wave steepness parameter h l more increased under these conditions the wave transmission coefficient from the structure considerably reduced at relatively low heights at approximately higher heights it slightly decreased or even increased based on the third model the wave relative height h h of 0 6 occurred and in reduction of the wave transmission coefficient from the structure the effect of increasing the wave height on the increasing wave steepness was much more than the effect of reducing wavelength on increasing wave steepness for this reason a relationship cannot be expressed for the change in wave transmission coefficient with increasing wave relative height in a constant wave steepness h l refer to fig s 7c d as shown in fig 8 the wave transmission coefficient increased with increasing the relative wave height h h from 0 2 to 0 4 in constant wave steepness on the other hand the wave transmission coefficient decreased with increasing the relative wave height h h from 0 4 to 0 6 in constant wave steepness this showed that with increasing the wave steepness the trend of changes in wave transmission coefficient with increasing of wave relative height increased and then decreased this trend of increase and decrease was serious due to the reduction of structure porosity percentage to justify the cause of this issue the power of incident wave to the structure and its effect on wave transmission coefficient from the structure in three states of porosity and the changes of wave power with the wave steepness must be investigated as shown in fig 9 a the entire incident wave relative heights h h had high power in their lowest steepness and low power in their highest steepness on the other hand the higher the incident wave height the greater the impact of wavelength on the wave power and vice versa if the wave steepness considered as constant fig 9a the minimum power h h 0 2 average power h h 0 4 and maximum power h h 0 6 intersected each other by following these powers for three models in fig 7e and f 8 9 this issue was justified easily according to the accuracy of each model chart with increasing the height ratio h h and simultaneously increasing wave power the dependence of wave transmission coefficient to wave power decreased and even vice versa however by comparing the charts of all three models decreasing the porosity percentage of the structure although for each h h elevation ratio led to a decrease in the wave passage ratio but at lower elevation ratios with decreasing the porosity percentage of the structure the dependence of the wave transmission coefficient on the wave power increased more slowly until the increase trend of dependency stopped and the reduction trend of dependency appeared for different values of the structure porosity and the different height ratios when the dependence of the wave transmission coefficient on the wave power stops the structure at that height ratio has reached its maximum transmit capacity of water volume and cannot exceed this value this maximum height ratio in which the dependency of wave transmission coefficient from the structure to the increase or decrease in wave power stops as shown in fig 10 may occur in lower amount of porosity for smaller height ratios and in higher amount of porosity for bigger height ratios the comparison of the results of similar researches with the present study is represented in fig 11 and table 4 4 conclusion in the present research based on the laboratory studies on a new semi submerged and perforated wall breakwater design the wave transmission coefficient from the structure with three different porosity percentages was investigated totally 108 experiments were performed on these three models of structure and the following results were obtained a as the period increased increasing the wavelength of incident waves on the structure the wave transmission coefficient from the structure increased except when the structure was at the maximum of water volume transmission capacity in its time unit in this case by increasing the period or wavelength at a constant wave height which results in a decrease in the wave steepness and ultimately in the wave power a decrease in the structural permittivity and ultimately a decrease in the wave transmission coefficient is observed b increase in wave steepness due to the reduction of wavelength in a constant wave height could reduce the wave transmission coefficient from the structure unless the structure had reached the final limit of water volume transmission capacity from itself in time unit the increase in the wave steepness lead to decrease in the wave power and increase in wave transmission coefficient from the structure c increasing the steepness of a wave if it results from an increase in wave height at a constant wavelength decreases the wave transmission coefficient of the structure for alternating period in this study for a period of 1 3 s the decrease in the wave transmission coefficient occurred with increasing wave height at a constant wavelength and the result was reversed for the period before it d increasing the steepness of the wave if it is caused by the increase in the wave height and the simultaneous decrease in the wavelength reduces the wave transmission coefficient of the structure this is because increasing the wave power in this way always results in a downward trend of the wave transmission coefficient even when the structure reaches the final wave volume limit in its time unit by increasing the wave height e the reduction of structure transmission coefficient with the reduction of its porosity percent is less in smaller height ratios h h and is higher in bigger height ratios the reason is that by increasing the incident wave height ratio the structure capacity is decreased for the transmission of more wave powers and by reducing the structure porosity percent the same is occurred again therefore the higher altitudes will have the largest decrease and the smaller altitudes will have the least decrease in the coefficient of passage f the maximum limit of water volume transfer capacity per time unit indicates the maximum volume of water that a structure can pass through per time unit and if the volume of water incidented by the structure per unit time exceeds this value the structure cannot discharge it rapidly this ultimate limit for each porous structure with a specific porosity percentage occurs at a particular height ratio where the slope of the power transmission coefficient diagram becomes zero meaning that the diagram becomes completely horizontal in this case as the power increases the transmission coefficient does not change at all and remains constant under these conditions the structure has reached its ultimate limit of transmission capacity and from now on if the height ratio of the incident wave to the structure is increased due to disturbance in the discharge order of water volume from the structure the slope of the diagram is negative and the transmission coefficient decreases with increasing wave power credit authorship contribution statement mohammad javad choopanizade methodology all authors read and approved the final manuscript morteza bakhtiari conceptualization methodology formal analysis writing original draft all authors read and approved the final manuscript the manuscript was written by writing manuscript mohammad rostami formal analysis all authors read and approved the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the khorramshahr university of marine science and technology for the practical support 
21553,in the present research the experimental study of wave transmission through a new designated perforated half depth breakwater is investigated for this purpose three models of structures that differed from porosity were tested by measuring three wave heights and at least ten periods in water depth and draft depth from the structure after conducting experimental and analytical studies a comparison was made between theoretical and laboratory data according to the results of the present study the experimental data was completely in agreement with the results obtained from solving the governing equation theory also based the result in a wall with porosity of 15 a 50 decrease in wave height was observed the behavior of each model of the structure against the waves was also justified by careful examination of the wave power the results show that increase in the parameters such as wavelength of incident waves on the structure the wave steepness due to reduction of wavelength in a constant wave height the wave height at a constant wavelength and the wave height with simultaneous decrease in the wavelength could lead to reduction of the wave transmission coefficient from the structure unless the structure had reached the final limit of water volume transmission capacity from itself in time unit keywords experimental study half depth perforated wall wave transfer 1 introduction the coastal walls are generally designed to protect beaches from wave forces and prevent water flowing to coast for proper use of coastal land the hydrostatic pressure fluctuations and the hydrodynamic pressure on the vertical breakwater wall lead to imposition of large forces on the structure and sometimes even their damage or destruction to fix this problem the walls should be heavier and larger to reduce the risk of them being broken or overturned for this reason the technology of perforated wall breakwater was developed this type of structure reduces the height of the designed wall by reducing the level of incident against the waves as well as reducing the wave reflection and the force applied to the wall suh et al 2006 compared the results of a numerical model with a laboratory model on perforated wall caisson break water they tested three perforated plates with the same porosity and different vertical horizontal and perforated slots accordingly the lowest reflection of the breakwater occurred when the ratio of the wavelength chamber to the radiant wavelength was 0 25 koraim and salem 2012 studied a breakwater consisting of a row of semi suspended pipes on the water depth they studied the regular wave periods ranging from of 0 65 1 33 s and height of 5 22 cm they reported that when the structure was in the relative depth d h of 0 5 and zero in porosity at 45 the waves could reach the transmission coefficient less than 20 reflection coefficient higher than 40 and energy dissipation coefficient of about 80 huang 2007 carried out a study on a vertical slotted barrier extending across the water depth this research was conducted for a row of these walls with four different thicknesses and four different percent of porosity in a constant period of 1 1 s and under the incident of five different wave heights of 2 6 cm at h h ratio of 0 2 and a porosity of 20 the ratio of the wave height incidence to water depth reached the transmission coefficient of 70 and reflection coefficient of about 25 several similar studies have also been conducted on semi submerged breakwater relaying on supportive piles or cables fang et al 2018 he and huang 2014 jun et al 2012 koraim 2013 2015 koraim et al 2014 neelamani and ljubic 2018 wang et al 2006 2016 ahmed et al 2011 developed a numerical model based on an eigen function expansion method for regular linear wave interactions with a single and double vertical slotted wall and nonlinear stokes second order wave interactions with a single vertical slotted wall they validated the numerical model by comparing its results with those of previous studies and their own experimental results the authors found that f and the coefficient of porosity ε significantly influence the reflection cr transmission ct and wave energy dissipation ce coefficients of permeable breakwaters while the influence of the added mass coefficient cm is minimal and can be omitted for this configuration elbisy et al 2016 studied examines the hydrodynamic performance of multiple row vertical slotted breakwaters the numerical results indicate that for triple row walls the effect of the arrangement of the chamber widths on hydrodynamic characteristics is not significant except when kd 0 5 there are two major views on assessing the behavior of vertical wave barrier and other perforated structures against the wave the first one is potential flow method based on calculating the velocity of potential function under specific boundary conditions jun et al 2012 kakuno 1983 kojima et al 1988 liu et al 2012 mohammad bagheri et al 2018 qiao et al 2018 venkateswarlu and karmakar 2019 in these studies based on simplified hydraulic theory wave passage through slit type vertical wave barrier was obtained in a state with half depth barrier against wave this theory is based on basic hydraulic principles such as mass conservation momentum and energy equations in this theory the wave transition of the structure and the wave force on the structure are primarily defined by the maximum horizontal component of the water particle velocity that passes through the aperture or slit of the structure with the maximum pressure gradient however the maximum pressure gradient as well as the maximum horizontal velocity of water particles occur at the crest and trough of the wave another theory is based on the basic hydraulic principles regarding the calculating of pressure head loss in fluid flow from the structure hayashi and tokutaro 1966 kakuno 1983 kojima et al 1988 liu and abbaspour 1982 lópez et al 2018 maría et al 2019 mei et al 1974 mohammadbagheri et al 2019 venkateswarlu and karmakar 2019 weiliang et al 2018 examination of waveguide structure designs showed that most of the structures used were high cost extremely complex and time consuming review of the previous researches also indicated that most of the researches on non porous and porous structures have been in full depth therefore in the present study a new design for porous barrier with half depth conditions was designed and tested 2 method and material 2 1 experimental methods the flume used in these experiments had a width length and depth of 5 5 33 and 1 m respectively it consisted of three parts separated by a wall the width of the middle part of the flume where the structure was installed was 1 m and the width of the two sides is 1 5 m the wave generator system was located at the beginning of the flume which included a pedal operated by hydraulic arms with oil pressure at the end of the flume there was also depreciation system of sandy beach to reduce the impact and depreciation of the recurring wave in this study a semi submerged breakwater based on pile made of pvc plastic blocks and cable laying blocks was used the wave transmission coefficient of three different models of structure which had porosity difference were investigated under the regular waves incidence in the period of 0 9 2 2 s and in the elevation range of 5 15 cm figs 1 and 2 table 1 indicated the specifications of laboratory parameters for the formation of breakwater structure including measurement units and the range of variation of each the structural model consisted of a series of cubic blocks of pvc overlapped by the cable table 2 the length width and thickness of these blocks were 9 4 and 1 6 cm respectively the unit weight of the pvc sheet used in the construction of the blocks was 0 486 g cm3 table 2 illustrates the structural characteristics of the model completely in the present study the height of the windage of the structural model was calculated using a heuristic method based on miche rundgren method for non breaking waves assuming of a non porous and rigid wall extending up to half the water depth the metal cables were connected to each other by small cable clip connections first the overall metal cable was connected to the connections installed on the metal frame and then the vertical cables connect the blocks to each other and also to the main cable around the fittings fig 3 the metal frame supporting the block made wall in the flume body had a length width height and thickness of 101 11 101 5 and 0 5 cm respectively due to using some assumptions as the impact of non breaking wave on the structure and intermediate water depth area with relative wavelength between 0 05 d l 0 5 only the waves with the stokes first and second order theory were investigated and the waves of stokes above third order theory were ignored these high steepness waves interact with the reflected wave from the structure and break down the wave shouldn t break before reaching the structure otherwise there will be a little energy dissipation in it also this energy loss cannot be considered as an evaluation of the structure s performance in reducing altitude and wave energy and then it is better to avoid this event after wave transfer from the structure its height was taken by two wave gauges and its mean was recorded as the transmitted wave height from the structure table 3 fig 4 the wave transmission coefficient kt was defined with the ratio of wave height transmitted from the structure ht to the incident wave height to the structure hi 5 k t h t h i after fabricating the first model of structure with 35 porosity and performing the wave series experiments on it the wave transmission coefficients from it were determined and the structural porosity was then reduced for the experiment on the second and third model by covering 60 holes 10 of the structural porosity was reduced and the porosity percentage for the second and third models reached to 25 and 15 respectively then as shown in table 3 the experiments of wave series were again performed for each of them and transmission coefficient was determined 2 2 calibration for this purpose two wave gauges with a distance of 1 m were used at the site of the structure this way in addition to ensuring the validity of wave gauges data used the moving distance of a peak between two wave gauges wave and progressive wave velocity could be determined finally by multiplying it by the wave period the wavelength could be obtained by laboratory method by comparing the recording time of two peaks together in the time series graph recorded by two wave gauges the time difference of the data recording between the two wave gauges could be obtained figs 5 and 6 since the distance between the two wave gauges was 1 m progressive wave velocity was obtained by reversing the time difference eqs 3 and 4 3 c l m δ t sec 4 l c t in the incident wave calibration a significant wave criterion was considered at the structure establishment site and the mean of wave specifications recorded in two wave gauges to determine the scale of the model the maximum power of the wave generation device without suffering excessive pressure or loss of accuracy should be determined to this end the maximum height and period of the wave that could be created by the wave generation device had to be determined this information regarding real waves of the sea were available and had to be compared with laboratory information to determine the maximum scale therefore the scale number required to construct a model must be smaller or ultimately equal to the maximum number of scales based on laboratory limitations the maximum depth of water to be studied in the laboratory must be determined therefore the force limitation on metal cables did not create scale restriction likewise given the constraints that exist it should be examined whether or not those constraints lead to scale restrictions in this research the accepted scale for constructing of the experimental model was 1 20 3 results and discussion after determining the transmitted waves from the three models of structure using eq 5 the wave transmission coefficient from the structure was determined for them since structure width b water depth d and water depth of structure h have constant values they become dimensionless with parameters such as wave height hi and wavelength l thus after adjusting natural conditions to laboratory conditions these constant parameters can be easily calculated for real conditions since in nature each irregular wave has a significant height hs and a significant period ts or in fact a significant wavelength ls therefore by having the indices of this irregular wave and relating them via constructing dimensionless parameter to constant parameters such as structure draft depth structure breadth and water depth these constant parameters could be obtained for natural conditions as they were consistent with the laboratory conditions as shown in fig 7 a d l b of wave transmission coefficient from the structure increased by increasing the relative wave length also by increasing the relative wave height h h and h d the wave transmission coefficient from the structure reduced in lower height ratios h h with decreasing the porosity percentage from the first model to the third model the chart became steeper indicating increase in dependence on dimensionless parameter of l b however increasing the h h ratio and decreasing the porosity of the structure simultaneously decreased the increasing trend of dependence on the dimensionless l b parameter in height ratio h h of 0 6 by reducing the porosity percentage and the third model of structure it had inverse or decreasing trend also by reducing the structure porosity percentage the height ratio h h increased and the wave transmission coefficient from the structure decreased as shown in fig 7a d it can be said that at constant relative wavelength l b with increasing the relative wave height h h leading to increase in wave steepness of h l the wave transmission coefficient from the structure for three models reduced this was clearly shown in fig 7c and d and 8 according to fig 7a d and considering the wave relative height h h as constant value and by reducing the relative wave length l b the wave steepness parameter h l more increased under these conditions the wave transmission coefficient from the structure considerably reduced at relatively low heights at approximately higher heights it slightly decreased or even increased based on the third model the wave relative height h h of 0 6 occurred and in reduction of the wave transmission coefficient from the structure the effect of increasing the wave height on the increasing wave steepness was much more than the effect of reducing wavelength on increasing wave steepness for this reason a relationship cannot be expressed for the change in wave transmission coefficient with increasing wave relative height in a constant wave steepness h l refer to fig s 7c d as shown in fig 8 the wave transmission coefficient increased with increasing the relative wave height h h from 0 2 to 0 4 in constant wave steepness on the other hand the wave transmission coefficient decreased with increasing the relative wave height h h from 0 4 to 0 6 in constant wave steepness this showed that with increasing the wave steepness the trend of changes in wave transmission coefficient with increasing of wave relative height increased and then decreased this trend of increase and decrease was serious due to the reduction of structure porosity percentage to justify the cause of this issue the power of incident wave to the structure and its effect on wave transmission coefficient from the structure in three states of porosity and the changes of wave power with the wave steepness must be investigated as shown in fig 9 a the entire incident wave relative heights h h had high power in their lowest steepness and low power in their highest steepness on the other hand the higher the incident wave height the greater the impact of wavelength on the wave power and vice versa if the wave steepness considered as constant fig 9a the minimum power h h 0 2 average power h h 0 4 and maximum power h h 0 6 intersected each other by following these powers for three models in fig 7e and f 8 9 this issue was justified easily according to the accuracy of each model chart with increasing the height ratio h h and simultaneously increasing wave power the dependence of wave transmission coefficient to wave power decreased and even vice versa however by comparing the charts of all three models decreasing the porosity percentage of the structure although for each h h elevation ratio led to a decrease in the wave passage ratio but at lower elevation ratios with decreasing the porosity percentage of the structure the dependence of the wave transmission coefficient on the wave power increased more slowly until the increase trend of dependency stopped and the reduction trend of dependency appeared for different values of the structure porosity and the different height ratios when the dependence of the wave transmission coefficient on the wave power stops the structure at that height ratio has reached its maximum transmit capacity of water volume and cannot exceed this value this maximum height ratio in which the dependency of wave transmission coefficient from the structure to the increase or decrease in wave power stops as shown in fig 10 may occur in lower amount of porosity for smaller height ratios and in higher amount of porosity for bigger height ratios the comparison of the results of similar researches with the present study is represented in fig 11 and table 4 4 conclusion in the present research based on the laboratory studies on a new semi submerged and perforated wall breakwater design the wave transmission coefficient from the structure with three different porosity percentages was investigated totally 108 experiments were performed on these three models of structure and the following results were obtained a as the period increased increasing the wavelength of incident waves on the structure the wave transmission coefficient from the structure increased except when the structure was at the maximum of water volume transmission capacity in its time unit in this case by increasing the period or wavelength at a constant wave height which results in a decrease in the wave steepness and ultimately in the wave power a decrease in the structural permittivity and ultimately a decrease in the wave transmission coefficient is observed b increase in wave steepness due to the reduction of wavelength in a constant wave height could reduce the wave transmission coefficient from the structure unless the structure had reached the final limit of water volume transmission capacity from itself in time unit the increase in the wave steepness lead to decrease in the wave power and increase in wave transmission coefficient from the structure c increasing the steepness of a wave if it results from an increase in wave height at a constant wavelength decreases the wave transmission coefficient of the structure for alternating period in this study for a period of 1 3 s the decrease in the wave transmission coefficient occurred with increasing wave height at a constant wavelength and the result was reversed for the period before it d increasing the steepness of the wave if it is caused by the increase in the wave height and the simultaneous decrease in the wavelength reduces the wave transmission coefficient of the structure this is because increasing the wave power in this way always results in a downward trend of the wave transmission coefficient even when the structure reaches the final wave volume limit in its time unit by increasing the wave height e the reduction of structure transmission coefficient with the reduction of its porosity percent is less in smaller height ratios h h and is higher in bigger height ratios the reason is that by increasing the incident wave height ratio the structure capacity is decreased for the transmission of more wave powers and by reducing the structure porosity percent the same is occurred again therefore the higher altitudes will have the largest decrease and the smaller altitudes will have the least decrease in the coefficient of passage f the maximum limit of water volume transfer capacity per time unit indicates the maximum volume of water that a structure can pass through per time unit and if the volume of water incidented by the structure per unit time exceeds this value the structure cannot discharge it rapidly this ultimate limit for each porous structure with a specific porosity percentage occurs at a particular height ratio where the slope of the power transmission coefficient diagram becomes zero meaning that the diagram becomes completely horizontal in this case as the power increases the transmission coefficient does not change at all and remains constant under these conditions the structure has reached its ultimate limit of transmission capacity and from now on if the height ratio of the incident wave to the structure is increased due to disturbance in the discharge order of water volume from the structure the slope of the diagram is negative and the transmission coefficient decreases with increasing wave power credit authorship contribution statement mohammad javad choopanizade methodology all authors read and approved the final manuscript morteza bakhtiari conceptualization methodology formal analysis writing original draft all authors read and approved the final manuscript the manuscript was written by writing manuscript mohammad rostami formal analysis all authors read and approved the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the khorramshahr university of marine science and technology for the practical support 
21554,this paper presents a robust nonlinear model predictive control nmpc scheme for the dynamic positioning dp ship subject to time varying environmental disturbances and input saturation the control objective is to steer the perturbed dp ship to track prespecified reference trajectories a nonlinear disturbance observer ndo is designed to estimate the unknown disturbances and uncertainties the nmpc optimization problem is formulated to reject the disturbances by combining the disturbance estimates into the prediction model the partial asymptotical stability of nmpc is guaranteed without considering any terminal costs and terminal constraints furthermore detail time iteration nmpc algorithm for dp ships is presented simulations of the proposed ndo based nmpc scheme are implemented for the modes of setpoint regulation and trajectory tracking respectively simulation results well demonstrate the effectiveness and robustness of the proposed control law keywords dynamic positioning nonlinear model predictive control nonlinear disturbance observer partial stability setpoint regulation trajectory tracking 1 introduction a dynamic positioning dp ship has the capability to automatically track a predetermined position and heading by means of its own thruster system since 1960s the dp system was commercially available it has become the key technology for deep sea research and development sørensen 2011 wang et al 2016 in the 1990s since fossen et al proposed the observer backstepping and passive observer with wave filtering grøvlen and fossen 1996 fossen and grøvlen 1998 fossen and strand 1999 much attention was casted to the nonlinear dp control many advanced control schemes e g the sliding mode tannuri et al 2010 the neural networks du et al 2013 and the adaptive control deng et al 2017 were applied to dp system however the control forces and moment generated by thrusters are limited but all the aforementioned control approaches did not take the input saturation explicitly into account this motivated us the use of model predictive control mpc strategy mpc has become the predominant advanced control approach due to its superior ability to handle constraints henson 1998 darby and nikolaou 2012 cao et al 2019 for dp systems by using of the vessel parallel coordinate system linear mpc lmpc were implemented based on the linearized model chen et al 2012 li et al 2017 qian et al 2016 however the performance of lmpc may not be satisfactory since the dp system is highly nonlinear in order to improve the control performance nonlinear mpc nmpc were utilized in sotnikova and veremey 2013 and veksler et al 2016 furthermore since disturbances due to wind wave ocean current forces and unmodeled dynamics will deviate the vessel from its demanded position it is required to design robust nmpc with the ability to reject disturbances for linear systems the robustness of mpc has been addressed through different approaches the first approach relies on the robustness of deterministic mpc limón marruedo et al 2002 which may lead to constraints violation for tightening of the terminal region another intuitive approach is to use min max mpc bemporad et al 2003 raimondo et al 2009 where the optimal problem is solved for the worst case however this approach is computationally expensive and may be excessively conservative the third approach namely tube based mpc is proposed in langson et al 2004 mayne and langson 2001 and mayne et al 2005 where the center of the tube was obtained based on the nominal system and the trajectory was restricted by an affine feedback law the approach was extended to nonlinear systems in mayne et al 2011 and yu et al 2013 where the feedback law was calculated by another mpc to attenuate the effects of disturbances which increases the computation burden in general the robust nmpc still need further researches due to the abilities to compensate disturbances and uncertainties disturbance observer do based control is regarded as one of the most promising approaches for disturbance rejection li et al 2016 chen et al 2016 yan et al 2017 xu et al 2017 zhang et al 2019 in van 2019 do 2010 and du et al 2016 the do was combined with the sliding mode control the backstepping technique and the dynamic surface control technique respectively to enhance tracking control of surface vessels thus do based nmpc may be an efficient and alternative approach to achieve robust nmpc the do based nmpc adopts do to estimate the unknown disturbance and remove the offset error guo et al 2019 wu et al 2018 wen et al 2018 hu et al 2019 sun et al 2017 where abdelaal et al 2018 proposed a nmpc strategy for trajectory tracking of underactuated vessels based on the nonlinear disturbance observer ndo comparing to the other offset free mpc strategies including the target calculator formulation which need to calculate a steady state target problem maeder et al 2009 bender et al 2017 morari and maeder 2012 tatjewski 2017 deng et al 2019 and the delta input formulation which adopts the augmented model with integrating input variables to gain the input estimates maeder et al 2009 deng et al 2019 gonzález et al 2008 the ndo based nmpc ndo nmpc strategy feeds back the disturbance estimates as a cancellation signal thus the nmpc can be designed based on the nominal system which is relatively easy to solve and stabilize the system however the feedback control law of the traditional ndo nmpc scheme is usually described as u t k x t d ˆ t which may exceed the input limits if the disturbance is too huge thus this paper aims to combine the disturbance into the nmpc receding optimization problem solving stability analysis for nmpc is widely studied it had been proved that by properly choosing a terminal cost and or a terminal attractive region for the finite horizon optimization problems the asymptotic stability can be guaranteed by using the control law u t k x t hu et al 2019 mayne et al 2000 yu et al 2014 however designing the terminal cost and the attractive region is still an open problem and time consuming to solve thus it is the state of the art researches to concern the stability of nmpc without imposing any terminal costs and terminal constraints grüne 2013 reble et al 2011 reble and allgöwer 2012 a very recent study was proposed by la et al 2017 they apply the theory of partial stability to the stability analysis of nmpc motivated by the aforementioned works and noting that the control system usually encounter the problem of plant model mismatch this work aims to design a robust ndo nmpc scheme for ship dynamic positioning in the presence of input saturation external disturbances and plant model mismatch the main contributions are summarized as follows 1 to the best of the author s knowledge in chen et al 2012 li et al 2017 and qian et al 2016 the effects of external disturbances were not considered and in sotnikova and veremey 2013 and veksler et al 2016 only the constant disturbances were taken into account however in real situations the external disturbances are always time varying therefore the proposed scheme aims to take the input saturation the time varying disturbances and the plant model mismatch into account simultaneously 2 the nmpc scheme is designed without any terminal cost and terminal constraints the partial stability for reference tracking of position and heading is ensured 3 the ndo nmpc scheme combines the disturbance estimates into the nmpc receding optimization problem solving which guarantees the input constraints the remainder of this paper is organized as follows section 2 describes the nonlinear mathematical model of dp ship and clarifies the control objective controller synthesis is presented in section 3 the nonlinear disturbance observer is designed then the nmpc scheme without terminal costs and terminal constraints is proposed with partial stability and the real time iteration algorithm is presented section 4 provides the simulation results and discussions the conclusions are described in section 5 notation a continuous function μ r r is a class k function if μ 0 0 ρ is strictly increasing and unbounded r n r m denotes the partial mapping of a vector x r n e g the mapping of x onto its first m components x 1 x 2 x m x represents the 2 norm and x m 2 denotes x t m x 0 and i represent the zero and identity matrix respectively 2 model and problem formulation for dp surface vessels the heave pitch and roll motions are neglected and only the horizontal motions surge sway and yaw are considered two reference frames including the inertial earth fixed frame o x y z and the body fixed frame o b x b y b z b attached to the moving vessel are defined to build the equations of motion then the nonlinear mathematical model for a dp ship can be described as fossen 2011 1 η r ψ ν 2 m ν d ν τ c r t ψ d where η x y ψ t is the position vector depicted in the earth fixed frame including the north east position x y and the heading angle ψ ν u v r t is the velocity vector depicted in the body fixed frame including the surge and sway velocities u v and the yaw rate r m is the inertia matrix including the added inertia which satisfies m m t 0 d is the linear damping matrix r ψ is the transfer matrix the matrices r ψ m and d are given as 3 r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r d x u 0 0 0 y v y r 0 n v n r where m is the mass of the ship i z is the ship s inertia about z b axis x g is the x b coordinate of the center of gravity x y n are referred to as hydrodynamic derivatives see sname 1950 in the kinetics model 2 τ c τ 1 τ 2 τ 3 t is the control forces and moment vector to be determined by the dp controller including the surge force τ 1 the sway force τ 2 and the yaw moment τ 3 which are generated by thrusters thus the control forces and moment are subjected to the saturated nonlinear constraints of thrusters which can be described as 4 τ c m i n τ c τ c m a x where τ c m i n τ 1 m i n τ 2 m i n τ 3 m i n t and τ c m a x τ 1 m a x τ 2 m a x τ 3 m a x t are vectors representing the minimal and maximal forces and moment that the ship s thrust system can provide d d 1 d 2 d 3 t presents the disturbance vector described in the earth fixed frame representing the slow varying environmental disturbance forces and moment due to second order wave wind and ocean current and the model uncertainties due to unmodeled nonlinear dynamics in general the dp mathematical model can be written into a compact state space form that is 5 x t f x t u t d t a t x b t u b d t d t where x x y ψ u v r t is the state vector u τ c is the control input vector y is the output vector f is nonlinear function which can be described by 6 a t 0 3 3 r ψ t 0 3 3 m 1 d b t 0 3 3 m 1 b d t 0 3 3 m 1 r t ψ t the following assumptions are adopted throughout this paper assumption 1 since the ocean environment is slowly changing and has finite energy the disturbances d i i 1 2 3 acting on the ship are assumed to be time varying yet bounded with finite changing rate thus there exists an unknown positive constant ε such that d ε du et al 2016 assumption 2 all the ship state variables including positions heading and velocities are measurable or can be accurately estimated assumption 3 the wave frequency disturbances induced by the first order waves will cause the ship to oscillate around its equilibrium position for a sake of reducing the power consumption and the wear and tear of the thrusters it is not necessary to response for them thus we assume that the wave frequency motions can be accurately removed from the position and heading measurements by wave filtering therefore in this paper we design dp controller only for the low frequency environmental disturbances d noting that for dp vessels the output model is presented as 7 y h x where h i 3 3 0 3 3 which means only the position and heading η x y ψ t is output therefore the control objective is to steer the perturbed dp ship 1 and 2 to track prespecified reference trajectories for the position vector η in the presence of external disturbances and input saturation under assumptions 1 3 in particular for the given reference trajectory η r t x r t y r t ψ r t t we will determine the control input to achieve that 8 lim t η t η r t 0 3 control synthesis 3 1 nonlinear disturbance observer design external disturbances might cause tracking errors if they are not considered in the controller design since the disturbances are often unknown in priori the estimation of disturbances is required in this subsection we will construct a ndo to estimate the unknown disturbances firstly rewritten eq 2 as 9 ν f ν ν u g 1 η d t where f ν ν u m 1 d ν τ c g 1 η m 1 r t ψ then on the basis of do 2010 the nonlinear disturbance observer for the unknown time varying disturbance d t can be constructed as 10 d ˆ t p t l 0 g 1 1 ν 11 p t l 0 p t l 0 g 1 1 ν g 1 1 f ν l 0 g 1 1 ν which will derive as 12 d ˆ t p t l 0 r ψ m ν 13 p t l 0 p t l 0 r ψ m ν r ψ d ν τ c l 0 r ψ m ν where d ˆ t is the estimate of the disturbance d t p t is an auxiliary state vector of the disturbance observer and l 0 is a positive definite symmetric matrix compute the time derivative of d ˆ t along the solution of 2 and 13 we have 14 d ˆ l 0 p l 0 r ψ m ν d l 0 d d ˆ l 0 d where d d d ˆ is the disturbance estimation error its time derivative is 15 d d d ˆ l 0 d d chose the lyapunov function candidate 16 v 1 2 d t d take the time derivative of 16 along the solution of 15 and consider assumption 1 we will have 17 v d t d d t l 0 d d d t l 0 d α d t d 1 4 α d t d λ l 0 α d t d 1 4 α ε 2 2 λ l 0 α v 1 4 α ε 2 where λ l 0 denotes the smallest eigenvalue of matrix l 0 α is an arbitrarily small positive constant such that the young inequality d t d α d t d 1 4 α d t d satisfies and λ l 0 α 0 the solution of 17 can be solved out that 18 v t ε 2 8 α β v 0 ε 2 8 α β e 2 β t where β denotes the value of λ l 0 α from 18 and 16 we have 19 d ε 2 4 α β v 0 ε 2 4 α β e 2 β t obviously d is globally uniformly ultimately bounded therefore we conclude the following theorem theorem 1 under the assumption of d ε the disturbance estimation error d t of the observer 12 and 13 is exponentially converges to a ball centered at the origin with the radius r d 1 4 α λ l 0 α ε the radius can be made arbitrarily small by properly choosing the matrix l 0 and the constant α such that λ l 0 α especially when the disturbance d is a constant ε 0 then d t will converge to zero 3 2 nmpc scheme with partial stability the disturbance estimates obtained by ndo can be compensated by directly fed back as an canceling signal that has an opposite sign of the disturbance magnitude generally the nmpc is designed based on the nominal system without considering the disturbances x t f x t u t 0 thus the optimal control action obtained by the nominal nmpc is a time varying function about the current state which can be described as u t k x t thereby the control input can be designed as u t k x t d ˆ t this traditional approach is simple and direct however when the disturbance magnitude is huge or even exceed the range of the thruster forces the control input u t would no longer constrained by the input saturation therefore we are aiming to design a nmpc scheme which combines the disturbance estimates into its receding horizon optimization process thus the input constraints can be imposed considering the effects of disturbances considering the following general form of nonlinear dynamic system x t f x t u t d t 20 y t h x t t 0 where x t x r n x u t u r n u y t y r n y d t d r n d with 0 x 0 u and f x u x g x y with f 0 0 0 0 for all t let dim x n x dim u n u dim y n y dim d n d the state and input vectors are constrained with x t x u t u where x x u u are compact sets which contains the origin in the interior x u define t 0 as the prediction horizon for each t and the initial state x 0 consider the following nonlinear optimal control problem without terminal cost and terminal constraints 21 min x u t t t l x τ u τ d τ s t x τ f x τ u τ d ˆ τ τ t x t x 0 x τ x u τ u τ t where the initial state x 0 is often substituted by its current estimates x ˆ t based on the control objective 8 the dp ship is demanded to track the predefined reference η r t x r t y r t ψ r t t which means that we only need to guarantee the partial stability of nmpc thus refer to la et al 2017 to guarantee the partial asymptotically stability of the nmpc the stage cost function l r n x r n u r only need to satisfy 22 l x r 0 0 l x u γ x x τ x u τ u with some γ k for each t x 0 suppose that the optimal problem 21 has a solution with the optimal states and controls x τ u τ and the optimal value v t t x 0 use a sampling time t s the time grid t n n t s n 0 1 2 then the first element of u t n is applied to the process thus we can obtain the optimal control action derived from the current states and disturbance estimates 23 u t u t k x t d ˆ t noting that the feedback control law 23 is time varying along with the state and disturbance of each time instant and is obtained inside the nmpc optimization process thus the input will not exceed the thruster saturation constraint for the control objective of tracking the predetermined reference η r t choosing x x y ψ t the stage cost function can be defined as 24 l x τ u τ h x τ x r τ q 2 u τ r 2 y t η r t q 2 u t r 2 where x r τ is the reference state vector determined by η r τ h x r τ q 0 r 0 are diagonal penalty matrices refer to la et al 2017 if the cost function 24 satisfies the supposition h there exist t 0 and δ t k such that for any t x 0 satisfying 21 with x t x 0 we have 25 t t t l x τ u τ δ t x 0 then for any t 0 x 0 x we have v t 2 t x 0 v t 1 t x 0 for 0 t 1 t 2 furthermore if lemma 5 in la et al 2017 satisfies that there exist t t 0 0 and a non decreasing bounded function b t 0 r such that 26 v t t x t b t l x t for any t t t t 0 where l r n r is defined by l x 0 min u u l x 0 u then theorem 4 in la et al 2017 will hold that v t t k 1 x k 1 v t t k x k β t k t k 1 l x τ u τ with 0 β 1 b t 2 t s t t s 1 hence we can conclude that the nmpc closed loop system 21 is partial asymptotically stable with lim t η t η r t 0 which is in accordance with the control objective defined in 8 3 3 discrete time nmpc scheme mpc is often designed based on the discrete time dynamic model therefore using a sampling time of t s we can discretize the dp model 5 at the current operate point as 27 x k 1 a k x k b k u k b d k d k where k t t s is the time step for the current time t x k x k y k ψ k u k v k r k t is the state vector u k τ 1 k τ 2 k τ 3 k t is the control input vector d k d 1 k d 2 k d 3 k t is the disturbance vector y k x k y k ψ k t is the output vector at the time step k respectively the discrete time matrices are computed by 28 a k e a t t s 29 b k a 1 t a k i b t 30 b d k a 1 t a k i b d t thus the discrete time nmpc optimal control problem can be defined as 31 min u k n 1 n p y n k η r k q 2 u n k r 2 s t x n 1 k a k x n k b k u n k b d k d ˆ n k n 0 n p 1 y n k h x n k n 1 n p x 0 k x k x n k x u n k u n 1 n p where x n k u n k are the n steps future predicted state and input vectors of the current sample time k n p t t s is the prediction horizon u k u 0 k t u 2 k t u n c 1 k t t is the vector of n c future control inputs here n c is the control horizon which is always less than n p note that the mpc optimizer 31 only gives an optimal solution of u k while the control inputs over n c are assumed to be unchanged that is u n k u n 1 k when n n c n c 1 n p remark 1 the discrete time model 27 is nonlinear thus we cannot obtain the explicit formulation for the future predictive state sequence x k x 1 k t x 2 k t x n p k t t therefore the future predictive output sequence y k y 1 k t y 2 k t y n p k t t is difficult to calculate this will lead the mpc optimization problem 31 to be nonlinear which is difficult and time consuming to obtain the global optimal solution however for that the sailing status of the dp vessel is slow varying we can assume that the discrete time matrices a k b k and b d k remain unchanged during the predictive horizon therefore the future predictive outputs can be computed like a linear model that the nonlinear optimization problem is turned into a relative easy quadratic optimization problem consequently we can compute the future predictive output y k recursively based on 27 as 32 y k ω x k φ u k λ o d k where o d k b d k d ˆ k and eq 33 in box i then the nonlinear mpc optimization problem 31 will become a sub optimization quadratic problem which can be solved by the active set or interior point method 3 4 ndo nmpc scheme utilizing the nonlinear disturbance observer 12 and 13 we can obtain the disturbance estimates d ˆ t the nmpc optimization problem 21 is designed based on the nonlinear model 20 which considers the disturbances then the disturbance estimates is combined into the prediction model 32 thus we can obtain the optimal feedback control law u t k x t d ˆ t which is effective for the state and disturbance of all the time instants the structure of the ndo nmpc scheme is illustrated in fig 1 the real time iterations for ndo nmpc scheme are summarized as follow 1 initialization choose the initial values x 0 and d ˆ 0 determine the reference trajectory η r t the sampling time t s the predictive horizon n p the control horizon n c the weight matrices q and r and the observer gain matrix l 0 2 for the current k time step obtain the state value x k 3 obtain the disturbance estimates d ˆ k based on the ndo 12 and 13 4 compute the discrete time matrices a k b k and b d k according to eqs 28 30 then calculate the future predictive output y k according to eqs 32 and 33 5 solve the optimization problem 31 obtain the sub optimal solution u 0 t k u 2 t k u n c 1 t k t apply only the first element u k u 0 k k x k d ˆ k 6 set k k 1 then go to 2 4 simulation results and discussions in this section simulations are implemented to demonstrate the effectiveness and robustness of the proposed ndo nmpc scheme for reference tracking of the dp ship 1 and 2 under external disturbances and plant model mismatch the ship chosen for simulation is the cybership ii csii which is a 1 70 scale replica of a supply ship fossen and perez 2007 the priori identified dynamic parameters in 3 for csii are shown in table 1 the lower and upper limits of the input saturated constraints in 4 are set as τ c m i n 2 0 n 2 0 n 1 5 n m t τ c m a x 2 0 n 2 0 n 1 5 n m t respectively 4 1 simulation cases and parameters setting the prediction horizon is n p 100 the control horizon is n c 10 the sample time is t s 0 1 s the penalty matrices and the observer gains are selected as q diag 100 100 100 r diag 1 1 1 l 0 diag 1 1 1 the initial ship state is x 0 0 m 0 m 0 deg 0 m s 0 m s 0 deg s t two cases of control objectives namely setpoint regulation and trajectory tracking are defined to simulate different dp functions they are described as follows case 1 setpoint regulation this is the most basic function for dp ships the dp ship is required to maintain at a fixed point with a certain heading dp station keeping or to move slowly from the initial point to another fixed point with an appointed heading herein the desired fixed point and heading are set as η d 1 m 0 5 m 20 deg t in order to obtain a smooth control the reference signal is set as η r 1 10 s 1 η d case 2 trajectory tracking in some applications the output y t r 3 of dp ship need to track a predefined smooth time varying trajectory η r t r 3 herein the desired trajectory is chose as x r t 3 sin 0 025 t 34 y r t 0 05 t t 0 the desired heading ψ r is taken as the direction of the tangent vector along the path the time varying disturbance is modeled as a first order markov process d t d 1 d γξ where t d diag t d 1 t d 2 t d 3 is a user defined diagonal matrix of positive time constants ξ r 3 is a zero mean white noise vector γ r 3 3 is a diagonal scaling matrix of ξ with d 0 0 n 0 n 0 n m t and t d diag 100 100 100 in both cases to verify the robustness of the proposed method the scaling matrix is set as γ diag 0 25 0 25 0 1 in case 1 and the disturbance magnitude is enlarged in case 2 by setting γ diag 0 4 0 4 0 2 furthermore an artificial plant model mismatch is built by introducing a deterministic error on the dynamic parameters of the plant model the representative perturbed parameter m is set as m 1 5 m for all simulations 4 2 comparison with the disturbance observer based lmpc do lmpc to verify the superiority of the proposed ndo nmpc scheme simulations are also implemented for the do lmpc scheme under the assumption of the yaw rate is zero ψ r 0 such that r ψ 0 the use of vessel parallel coordinates implies that η p r t ψ η and d p r t ψ d then the nonlinear dp model 1 and 2 can be approximated by the linear model 35 η p ν 36 m ν d ν τ c d p the corresponding state space model for 35 and 36 can be written as 37 x p t a x p t b u t b d d p t where x p η p ν and 38 a 0 3 3 i 3 3 0 3 3 m 1 d b b d 0 3 3 m 1 based on 37 the lmpc can be designed together with the following disturbance observer do 39 d ˆ p t p t l 0 m ν 40 p t l 0 p t l 0 d ν τ c l 0 m ν where d ˆ p t is the estimate of d p t when implementing simulations all the parameter settings are identical with the ndo nmpc scheme 4 3 performance of the proposed ndo nmpc scheme simulation results of the two cases are illustrated in figs 2 4 where results of the ndo nmpc and the do lmpc are presented using solid lines and dashed lines respectively while the reference trajectory are presented using dotted lines first see the results of the proposed ndo nmpc approach figs 2 and 4 a show the results of the setpoint regulation case it can be seen from figs 2 a and 4 a that the ship is regulated in a very small range around the setpoint η d 1 m 0 5 m 20 deg t moreover fig 2 b depicts that the proposed ndo can accurately estimate the time varying disturbances the estimation error is bounded fig 2 c and d illustrate how the control inputs changes along with the disturbances and the boundedness of the velocities respectively simulation results demonstrate the effectiveness of the proposed ndo nmpc scheme for time varying disturbances figs 3 and 4 b shows the results of the trajectory tracking case figs 3 a and 4 b illustrate that the ship can accurately track the desired trajectory even when the disturbance magnitude is close to the saturation limit or greater than the limit for a short while fig 3 b depicts again that the disturbance estimation performance is quite well under different control objectives fig 3 c and d describe the control inputs and the changing of the velocities respectively it can be seen that when the disturbance is greater than the control limit the excessive value is cut off in the control input simulation results demonstrate the effectiveness of the proposed ndo nmpc scheme for setpoint regulation and trajectory tracking control the robustness for time varying disturbances is verified as well simulation results for the two cases using do lmpc scheme are depicted with dashed lines in figs 2 4 respectively for case 1 figs 2 a and 4 a show that the ship s position and heading oscillating in a larger range than ndo nmpc since the yaw rate r see dashed line in fig 2 d is not zero any more which is not consistent with the assumption of r 0 the similar situation as case 1 can be concluded for case 2 which can be seen from figs 3 a 4 b and 3 d thus we conclude that when the disturbances are time varying neither for setpoint regulation nor for trajectory tracking control the proposed ndo nmpc control law provides superior control performance and is robust for unknown time varying disturbances and plant model mismatch in the presence of input saturation 5 conclusions this paper proposes a robust nmpc scheme for dp ships based on the nonlinear disturbance observer the environmental disturbances the plant model mismatch and the input saturation are considered simultaneously the disturbances are unknown in prior and are estimated utilizing the ndo then the nmpc is designed by combining the disturbance estimates into the receding optimization problem by choosing a partial state of x x y ψ t the partial asymptotic stability of nmpc is guaranteed to verify the effectiveness and robustness of the proposed ndo nmpc scheme the time varying disturbances are imposed onto the dp ship with regard to the setpoint regulation and trajectory tracking modes simulation results shows that the ndo nmpc scheme shows good robustness that leads to almost zero tracking error the control performance of the proposed scheme is superior comparing to the do lmpc control law credit authorship contribution statement hualin yang conceptualization funding acquisition writing review editing fang deng methodology software writing original draft yan he supervision dongmei jiao validation data curation zhaolin han investigation appendix nmpc partial stability verification now we will verify the partial stability for x η x y ψ t of the proposed nmpc scheme considering y t h x t η t the cost function 24 can be rewritten as l x t u t η t η r t q 2 u t r 2 to claim the nmpc partial stability we need to verify 25 and 26 thus we choose q diag 100 100 100 γ x t η t η r t 2 l x t η t η r t q 2 and the sampling time t s 0 1 s for simplicity we keep the reference point at the origin η r t 0 m 0 m 0 rad t and meanwhile change the initial state x 0 η 0 ν 0 where η 0 is randomly generated between 1 m 1 m π rad t and 1 m 1 m π rad t with zero velocity ν 0 0 m s 0 m s 0 rad s t the disturbance is set as the first order markov process as well with t d diag 100 100 100 and γ diag 0 4 0 4 0 2 to verify 25 we choose t 10 s with t s 0 1 s which is identical with n p 100 in the simulations we calculate the minimum of v t t x t η t η r t 2 at t k t s k 1 2 500 for 100 samples of x 0 numerical simulations give the minimum value 0 0026 thus it is reasonable that 25 is satisfied with δ t x t 0 001 η t η r t 2 to verify 26 we compute the maximum of v t t x t η t η r t q 2 with t k t 0 k 1 2 8 and t 0 5 s and check the value for t 7 8 10 for each t we randomly generate 5 samples of x 0 for simulations thus we total obtain 40 groups of data the results are depicted in fig 5 in the horizontal ordinate the 1st 5th data points are the results of t 5 s the 6th 10th data points are the results of t 10 s and so on it can be seen that the maximum value decreases when t increases the maximum value is 1 015 when t 7 s and is 0 517 when t 8 s thus 26 is fulfilled with t 8 s and b t 0 6 for t 10 s and t s 0 1 s we can obtain β 1 b t 2 t s t t s 0 64 then the theorem 4 in la et al 2017 is fulfilled therefore the ship position and heading η t is asymptotically stable for the ndo nmpc scheme with q diag 100 100 100 t 10 s n p 100 and t s 0 1 s 
21554,this paper presents a robust nonlinear model predictive control nmpc scheme for the dynamic positioning dp ship subject to time varying environmental disturbances and input saturation the control objective is to steer the perturbed dp ship to track prespecified reference trajectories a nonlinear disturbance observer ndo is designed to estimate the unknown disturbances and uncertainties the nmpc optimization problem is formulated to reject the disturbances by combining the disturbance estimates into the prediction model the partial asymptotical stability of nmpc is guaranteed without considering any terminal costs and terminal constraints furthermore detail time iteration nmpc algorithm for dp ships is presented simulations of the proposed ndo based nmpc scheme are implemented for the modes of setpoint regulation and trajectory tracking respectively simulation results well demonstrate the effectiveness and robustness of the proposed control law keywords dynamic positioning nonlinear model predictive control nonlinear disturbance observer partial stability setpoint regulation trajectory tracking 1 introduction a dynamic positioning dp ship has the capability to automatically track a predetermined position and heading by means of its own thruster system since 1960s the dp system was commercially available it has become the key technology for deep sea research and development sørensen 2011 wang et al 2016 in the 1990s since fossen et al proposed the observer backstepping and passive observer with wave filtering grøvlen and fossen 1996 fossen and grøvlen 1998 fossen and strand 1999 much attention was casted to the nonlinear dp control many advanced control schemes e g the sliding mode tannuri et al 2010 the neural networks du et al 2013 and the adaptive control deng et al 2017 were applied to dp system however the control forces and moment generated by thrusters are limited but all the aforementioned control approaches did not take the input saturation explicitly into account this motivated us the use of model predictive control mpc strategy mpc has become the predominant advanced control approach due to its superior ability to handle constraints henson 1998 darby and nikolaou 2012 cao et al 2019 for dp systems by using of the vessel parallel coordinate system linear mpc lmpc were implemented based on the linearized model chen et al 2012 li et al 2017 qian et al 2016 however the performance of lmpc may not be satisfactory since the dp system is highly nonlinear in order to improve the control performance nonlinear mpc nmpc were utilized in sotnikova and veremey 2013 and veksler et al 2016 furthermore since disturbances due to wind wave ocean current forces and unmodeled dynamics will deviate the vessel from its demanded position it is required to design robust nmpc with the ability to reject disturbances for linear systems the robustness of mpc has been addressed through different approaches the first approach relies on the robustness of deterministic mpc limón marruedo et al 2002 which may lead to constraints violation for tightening of the terminal region another intuitive approach is to use min max mpc bemporad et al 2003 raimondo et al 2009 where the optimal problem is solved for the worst case however this approach is computationally expensive and may be excessively conservative the third approach namely tube based mpc is proposed in langson et al 2004 mayne and langson 2001 and mayne et al 2005 where the center of the tube was obtained based on the nominal system and the trajectory was restricted by an affine feedback law the approach was extended to nonlinear systems in mayne et al 2011 and yu et al 2013 where the feedback law was calculated by another mpc to attenuate the effects of disturbances which increases the computation burden in general the robust nmpc still need further researches due to the abilities to compensate disturbances and uncertainties disturbance observer do based control is regarded as one of the most promising approaches for disturbance rejection li et al 2016 chen et al 2016 yan et al 2017 xu et al 2017 zhang et al 2019 in van 2019 do 2010 and du et al 2016 the do was combined with the sliding mode control the backstepping technique and the dynamic surface control technique respectively to enhance tracking control of surface vessels thus do based nmpc may be an efficient and alternative approach to achieve robust nmpc the do based nmpc adopts do to estimate the unknown disturbance and remove the offset error guo et al 2019 wu et al 2018 wen et al 2018 hu et al 2019 sun et al 2017 where abdelaal et al 2018 proposed a nmpc strategy for trajectory tracking of underactuated vessels based on the nonlinear disturbance observer ndo comparing to the other offset free mpc strategies including the target calculator formulation which need to calculate a steady state target problem maeder et al 2009 bender et al 2017 morari and maeder 2012 tatjewski 2017 deng et al 2019 and the delta input formulation which adopts the augmented model with integrating input variables to gain the input estimates maeder et al 2009 deng et al 2019 gonzález et al 2008 the ndo based nmpc ndo nmpc strategy feeds back the disturbance estimates as a cancellation signal thus the nmpc can be designed based on the nominal system which is relatively easy to solve and stabilize the system however the feedback control law of the traditional ndo nmpc scheme is usually described as u t k x t d ˆ t which may exceed the input limits if the disturbance is too huge thus this paper aims to combine the disturbance into the nmpc receding optimization problem solving stability analysis for nmpc is widely studied it had been proved that by properly choosing a terminal cost and or a terminal attractive region for the finite horizon optimization problems the asymptotic stability can be guaranteed by using the control law u t k x t hu et al 2019 mayne et al 2000 yu et al 2014 however designing the terminal cost and the attractive region is still an open problem and time consuming to solve thus it is the state of the art researches to concern the stability of nmpc without imposing any terminal costs and terminal constraints grüne 2013 reble et al 2011 reble and allgöwer 2012 a very recent study was proposed by la et al 2017 they apply the theory of partial stability to the stability analysis of nmpc motivated by the aforementioned works and noting that the control system usually encounter the problem of plant model mismatch this work aims to design a robust ndo nmpc scheme for ship dynamic positioning in the presence of input saturation external disturbances and plant model mismatch the main contributions are summarized as follows 1 to the best of the author s knowledge in chen et al 2012 li et al 2017 and qian et al 2016 the effects of external disturbances were not considered and in sotnikova and veremey 2013 and veksler et al 2016 only the constant disturbances were taken into account however in real situations the external disturbances are always time varying therefore the proposed scheme aims to take the input saturation the time varying disturbances and the plant model mismatch into account simultaneously 2 the nmpc scheme is designed without any terminal cost and terminal constraints the partial stability for reference tracking of position and heading is ensured 3 the ndo nmpc scheme combines the disturbance estimates into the nmpc receding optimization problem solving which guarantees the input constraints the remainder of this paper is organized as follows section 2 describes the nonlinear mathematical model of dp ship and clarifies the control objective controller synthesis is presented in section 3 the nonlinear disturbance observer is designed then the nmpc scheme without terminal costs and terminal constraints is proposed with partial stability and the real time iteration algorithm is presented section 4 provides the simulation results and discussions the conclusions are described in section 5 notation a continuous function μ r r is a class k function if μ 0 0 ρ is strictly increasing and unbounded r n r m denotes the partial mapping of a vector x r n e g the mapping of x onto its first m components x 1 x 2 x m x represents the 2 norm and x m 2 denotes x t m x 0 and i represent the zero and identity matrix respectively 2 model and problem formulation for dp surface vessels the heave pitch and roll motions are neglected and only the horizontal motions surge sway and yaw are considered two reference frames including the inertial earth fixed frame o x y z and the body fixed frame o b x b y b z b attached to the moving vessel are defined to build the equations of motion then the nonlinear mathematical model for a dp ship can be described as fossen 2011 1 η r ψ ν 2 m ν d ν τ c r t ψ d where η x y ψ t is the position vector depicted in the earth fixed frame including the north east position x y and the heading angle ψ ν u v r t is the velocity vector depicted in the body fixed frame including the surge and sway velocities u v and the yaw rate r m is the inertia matrix including the added inertia which satisfies m m t 0 d is the linear damping matrix r ψ is the transfer matrix the matrices r ψ m and d are given as 3 r ψ cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r d x u 0 0 0 y v y r 0 n v n r where m is the mass of the ship i z is the ship s inertia about z b axis x g is the x b coordinate of the center of gravity x y n are referred to as hydrodynamic derivatives see sname 1950 in the kinetics model 2 τ c τ 1 τ 2 τ 3 t is the control forces and moment vector to be determined by the dp controller including the surge force τ 1 the sway force τ 2 and the yaw moment τ 3 which are generated by thrusters thus the control forces and moment are subjected to the saturated nonlinear constraints of thrusters which can be described as 4 τ c m i n τ c τ c m a x where τ c m i n τ 1 m i n τ 2 m i n τ 3 m i n t and τ c m a x τ 1 m a x τ 2 m a x τ 3 m a x t are vectors representing the minimal and maximal forces and moment that the ship s thrust system can provide d d 1 d 2 d 3 t presents the disturbance vector described in the earth fixed frame representing the slow varying environmental disturbance forces and moment due to second order wave wind and ocean current and the model uncertainties due to unmodeled nonlinear dynamics in general the dp mathematical model can be written into a compact state space form that is 5 x t f x t u t d t a t x b t u b d t d t where x x y ψ u v r t is the state vector u τ c is the control input vector y is the output vector f is nonlinear function which can be described by 6 a t 0 3 3 r ψ t 0 3 3 m 1 d b t 0 3 3 m 1 b d t 0 3 3 m 1 r t ψ t the following assumptions are adopted throughout this paper assumption 1 since the ocean environment is slowly changing and has finite energy the disturbances d i i 1 2 3 acting on the ship are assumed to be time varying yet bounded with finite changing rate thus there exists an unknown positive constant ε such that d ε du et al 2016 assumption 2 all the ship state variables including positions heading and velocities are measurable or can be accurately estimated assumption 3 the wave frequency disturbances induced by the first order waves will cause the ship to oscillate around its equilibrium position for a sake of reducing the power consumption and the wear and tear of the thrusters it is not necessary to response for them thus we assume that the wave frequency motions can be accurately removed from the position and heading measurements by wave filtering therefore in this paper we design dp controller only for the low frequency environmental disturbances d noting that for dp vessels the output model is presented as 7 y h x where h i 3 3 0 3 3 which means only the position and heading η x y ψ t is output therefore the control objective is to steer the perturbed dp ship 1 and 2 to track prespecified reference trajectories for the position vector η in the presence of external disturbances and input saturation under assumptions 1 3 in particular for the given reference trajectory η r t x r t y r t ψ r t t we will determine the control input to achieve that 8 lim t η t η r t 0 3 control synthesis 3 1 nonlinear disturbance observer design external disturbances might cause tracking errors if they are not considered in the controller design since the disturbances are often unknown in priori the estimation of disturbances is required in this subsection we will construct a ndo to estimate the unknown disturbances firstly rewritten eq 2 as 9 ν f ν ν u g 1 η d t where f ν ν u m 1 d ν τ c g 1 η m 1 r t ψ then on the basis of do 2010 the nonlinear disturbance observer for the unknown time varying disturbance d t can be constructed as 10 d ˆ t p t l 0 g 1 1 ν 11 p t l 0 p t l 0 g 1 1 ν g 1 1 f ν l 0 g 1 1 ν which will derive as 12 d ˆ t p t l 0 r ψ m ν 13 p t l 0 p t l 0 r ψ m ν r ψ d ν τ c l 0 r ψ m ν where d ˆ t is the estimate of the disturbance d t p t is an auxiliary state vector of the disturbance observer and l 0 is a positive definite symmetric matrix compute the time derivative of d ˆ t along the solution of 2 and 13 we have 14 d ˆ l 0 p l 0 r ψ m ν d l 0 d d ˆ l 0 d where d d d ˆ is the disturbance estimation error its time derivative is 15 d d d ˆ l 0 d d chose the lyapunov function candidate 16 v 1 2 d t d take the time derivative of 16 along the solution of 15 and consider assumption 1 we will have 17 v d t d d t l 0 d d d t l 0 d α d t d 1 4 α d t d λ l 0 α d t d 1 4 α ε 2 2 λ l 0 α v 1 4 α ε 2 where λ l 0 denotes the smallest eigenvalue of matrix l 0 α is an arbitrarily small positive constant such that the young inequality d t d α d t d 1 4 α d t d satisfies and λ l 0 α 0 the solution of 17 can be solved out that 18 v t ε 2 8 α β v 0 ε 2 8 α β e 2 β t where β denotes the value of λ l 0 α from 18 and 16 we have 19 d ε 2 4 α β v 0 ε 2 4 α β e 2 β t obviously d is globally uniformly ultimately bounded therefore we conclude the following theorem theorem 1 under the assumption of d ε the disturbance estimation error d t of the observer 12 and 13 is exponentially converges to a ball centered at the origin with the radius r d 1 4 α λ l 0 α ε the radius can be made arbitrarily small by properly choosing the matrix l 0 and the constant α such that λ l 0 α especially when the disturbance d is a constant ε 0 then d t will converge to zero 3 2 nmpc scheme with partial stability the disturbance estimates obtained by ndo can be compensated by directly fed back as an canceling signal that has an opposite sign of the disturbance magnitude generally the nmpc is designed based on the nominal system without considering the disturbances x t f x t u t 0 thus the optimal control action obtained by the nominal nmpc is a time varying function about the current state which can be described as u t k x t thereby the control input can be designed as u t k x t d ˆ t this traditional approach is simple and direct however when the disturbance magnitude is huge or even exceed the range of the thruster forces the control input u t would no longer constrained by the input saturation therefore we are aiming to design a nmpc scheme which combines the disturbance estimates into its receding horizon optimization process thus the input constraints can be imposed considering the effects of disturbances considering the following general form of nonlinear dynamic system x t f x t u t d t 20 y t h x t t 0 where x t x r n x u t u r n u y t y r n y d t d r n d with 0 x 0 u and f x u x g x y with f 0 0 0 0 for all t let dim x n x dim u n u dim y n y dim d n d the state and input vectors are constrained with x t x u t u where x x u u are compact sets which contains the origin in the interior x u define t 0 as the prediction horizon for each t and the initial state x 0 consider the following nonlinear optimal control problem without terminal cost and terminal constraints 21 min x u t t t l x τ u τ d τ s t x τ f x τ u τ d ˆ τ τ t x t x 0 x τ x u τ u τ t where the initial state x 0 is often substituted by its current estimates x ˆ t based on the control objective 8 the dp ship is demanded to track the predefined reference η r t x r t y r t ψ r t t which means that we only need to guarantee the partial stability of nmpc thus refer to la et al 2017 to guarantee the partial asymptotically stability of the nmpc the stage cost function l r n x r n u r only need to satisfy 22 l x r 0 0 l x u γ x x τ x u τ u with some γ k for each t x 0 suppose that the optimal problem 21 has a solution with the optimal states and controls x τ u τ and the optimal value v t t x 0 use a sampling time t s the time grid t n n t s n 0 1 2 then the first element of u t n is applied to the process thus we can obtain the optimal control action derived from the current states and disturbance estimates 23 u t u t k x t d ˆ t noting that the feedback control law 23 is time varying along with the state and disturbance of each time instant and is obtained inside the nmpc optimization process thus the input will not exceed the thruster saturation constraint for the control objective of tracking the predetermined reference η r t choosing x x y ψ t the stage cost function can be defined as 24 l x τ u τ h x τ x r τ q 2 u τ r 2 y t η r t q 2 u t r 2 where x r τ is the reference state vector determined by η r τ h x r τ q 0 r 0 are diagonal penalty matrices refer to la et al 2017 if the cost function 24 satisfies the supposition h there exist t 0 and δ t k such that for any t x 0 satisfying 21 with x t x 0 we have 25 t t t l x τ u τ δ t x 0 then for any t 0 x 0 x we have v t 2 t x 0 v t 1 t x 0 for 0 t 1 t 2 furthermore if lemma 5 in la et al 2017 satisfies that there exist t t 0 0 and a non decreasing bounded function b t 0 r such that 26 v t t x t b t l x t for any t t t t 0 where l r n r is defined by l x 0 min u u l x 0 u then theorem 4 in la et al 2017 will hold that v t t k 1 x k 1 v t t k x k β t k t k 1 l x τ u τ with 0 β 1 b t 2 t s t t s 1 hence we can conclude that the nmpc closed loop system 21 is partial asymptotically stable with lim t η t η r t 0 which is in accordance with the control objective defined in 8 3 3 discrete time nmpc scheme mpc is often designed based on the discrete time dynamic model therefore using a sampling time of t s we can discretize the dp model 5 at the current operate point as 27 x k 1 a k x k b k u k b d k d k where k t t s is the time step for the current time t x k x k y k ψ k u k v k r k t is the state vector u k τ 1 k τ 2 k τ 3 k t is the control input vector d k d 1 k d 2 k d 3 k t is the disturbance vector y k x k y k ψ k t is the output vector at the time step k respectively the discrete time matrices are computed by 28 a k e a t t s 29 b k a 1 t a k i b t 30 b d k a 1 t a k i b d t thus the discrete time nmpc optimal control problem can be defined as 31 min u k n 1 n p y n k η r k q 2 u n k r 2 s t x n 1 k a k x n k b k u n k b d k d ˆ n k n 0 n p 1 y n k h x n k n 1 n p x 0 k x k x n k x u n k u n 1 n p where x n k u n k are the n steps future predicted state and input vectors of the current sample time k n p t t s is the prediction horizon u k u 0 k t u 2 k t u n c 1 k t t is the vector of n c future control inputs here n c is the control horizon which is always less than n p note that the mpc optimizer 31 only gives an optimal solution of u k while the control inputs over n c are assumed to be unchanged that is u n k u n 1 k when n n c n c 1 n p remark 1 the discrete time model 27 is nonlinear thus we cannot obtain the explicit formulation for the future predictive state sequence x k x 1 k t x 2 k t x n p k t t therefore the future predictive output sequence y k y 1 k t y 2 k t y n p k t t is difficult to calculate this will lead the mpc optimization problem 31 to be nonlinear which is difficult and time consuming to obtain the global optimal solution however for that the sailing status of the dp vessel is slow varying we can assume that the discrete time matrices a k b k and b d k remain unchanged during the predictive horizon therefore the future predictive outputs can be computed like a linear model that the nonlinear optimization problem is turned into a relative easy quadratic optimization problem consequently we can compute the future predictive output y k recursively based on 27 as 32 y k ω x k φ u k λ o d k where o d k b d k d ˆ k and eq 33 in box i then the nonlinear mpc optimization problem 31 will become a sub optimization quadratic problem which can be solved by the active set or interior point method 3 4 ndo nmpc scheme utilizing the nonlinear disturbance observer 12 and 13 we can obtain the disturbance estimates d ˆ t the nmpc optimization problem 21 is designed based on the nonlinear model 20 which considers the disturbances then the disturbance estimates is combined into the prediction model 32 thus we can obtain the optimal feedback control law u t k x t d ˆ t which is effective for the state and disturbance of all the time instants the structure of the ndo nmpc scheme is illustrated in fig 1 the real time iterations for ndo nmpc scheme are summarized as follow 1 initialization choose the initial values x 0 and d ˆ 0 determine the reference trajectory η r t the sampling time t s the predictive horizon n p the control horizon n c the weight matrices q and r and the observer gain matrix l 0 2 for the current k time step obtain the state value x k 3 obtain the disturbance estimates d ˆ k based on the ndo 12 and 13 4 compute the discrete time matrices a k b k and b d k according to eqs 28 30 then calculate the future predictive output y k according to eqs 32 and 33 5 solve the optimization problem 31 obtain the sub optimal solution u 0 t k u 2 t k u n c 1 t k t apply only the first element u k u 0 k k x k d ˆ k 6 set k k 1 then go to 2 4 simulation results and discussions in this section simulations are implemented to demonstrate the effectiveness and robustness of the proposed ndo nmpc scheme for reference tracking of the dp ship 1 and 2 under external disturbances and plant model mismatch the ship chosen for simulation is the cybership ii csii which is a 1 70 scale replica of a supply ship fossen and perez 2007 the priori identified dynamic parameters in 3 for csii are shown in table 1 the lower and upper limits of the input saturated constraints in 4 are set as τ c m i n 2 0 n 2 0 n 1 5 n m t τ c m a x 2 0 n 2 0 n 1 5 n m t respectively 4 1 simulation cases and parameters setting the prediction horizon is n p 100 the control horizon is n c 10 the sample time is t s 0 1 s the penalty matrices and the observer gains are selected as q diag 100 100 100 r diag 1 1 1 l 0 diag 1 1 1 the initial ship state is x 0 0 m 0 m 0 deg 0 m s 0 m s 0 deg s t two cases of control objectives namely setpoint regulation and trajectory tracking are defined to simulate different dp functions they are described as follows case 1 setpoint regulation this is the most basic function for dp ships the dp ship is required to maintain at a fixed point with a certain heading dp station keeping or to move slowly from the initial point to another fixed point with an appointed heading herein the desired fixed point and heading are set as η d 1 m 0 5 m 20 deg t in order to obtain a smooth control the reference signal is set as η r 1 10 s 1 η d case 2 trajectory tracking in some applications the output y t r 3 of dp ship need to track a predefined smooth time varying trajectory η r t r 3 herein the desired trajectory is chose as x r t 3 sin 0 025 t 34 y r t 0 05 t t 0 the desired heading ψ r is taken as the direction of the tangent vector along the path the time varying disturbance is modeled as a first order markov process d t d 1 d γξ where t d diag t d 1 t d 2 t d 3 is a user defined diagonal matrix of positive time constants ξ r 3 is a zero mean white noise vector γ r 3 3 is a diagonal scaling matrix of ξ with d 0 0 n 0 n 0 n m t and t d diag 100 100 100 in both cases to verify the robustness of the proposed method the scaling matrix is set as γ diag 0 25 0 25 0 1 in case 1 and the disturbance magnitude is enlarged in case 2 by setting γ diag 0 4 0 4 0 2 furthermore an artificial plant model mismatch is built by introducing a deterministic error on the dynamic parameters of the plant model the representative perturbed parameter m is set as m 1 5 m for all simulations 4 2 comparison with the disturbance observer based lmpc do lmpc to verify the superiority of the proposed ndo nmpc scheme simulations are also implemented for the do lmpc scheme under the assumption of the yaw rate is zero ψ r 0 such that r ψ 0 the use of vessel parallel coordinates implies that η p r t ψ η and d p r t ψ d then the nonlinear dp model 1 and 2 can be approximated by the linear model 35 η p ν 36 m ν d ν τ c d p the corresponding state space model for 35 and 36 can be written as 37 x p t a x p t b u t b d d p t where x p η p ν and 38 a 0 3 3 i 3 3 0 3 3 m 1 d b b d 0 3 3 m 1 based on 37 the lmpc can be designed together with the following disturbance observer do 39 d ˆ p t p t l 0 m ν 40 p t l 0 p t l 0 d ν τ c l 0 m ν where d ˆ p t is the estimate of d p t when implementing simulations all the parameter settings are identical with the ndo nmpc scheme 4 3 performance of the proposed ndo nmpc scheme simulation results of the two cases are illustrated in figs 2 4 where results of the ndo nmpc and the do lmpc are presented using solid lines and dashed lines respectively while the reference trajectory are presented using dotted lines first see the results of the proposed ndo nmpc approach figs 2 and 4 a show the results of the setpoint regulation case it can be seen from figs 2 a and 4 a that the ship is regulated in a very small range around the setpoint η d 1 m 0 5 m 20 deg t moreover fig 2 b depicts that the proposed ndo can accurately estimate the time varying disturbances the estimation error is bounded fig 2 c and d illustrate how the control inputs changes along with the disturbances and the boundedness of the velocities respectively simulation results demonstrate the effectiveness of the proposed ndo nmpc scheme for time varying disturbances figs 3 and 4 b shows the results of the trajectory tracking case figs 3 a and 4 b illustrate that the ship can accurately track the desired trajectory even when the disturbance magnitude is close to the saturation limit or greater than the limit for a short while fig 3 b depicts again that the disturbance estimation performance is quite well under different control objectives fig 3 c and d describe the control inputs and the changing of the velocities respectively it can be seen that when the disturbance is greater than the control limit the excessive value is cut off in the control input simulation results demonstrate the effectiveness of the proposed ndo nmpc scheme for setpoint regulation and trajectory tracking control the robustness for time varying disturbances is verified as well simulation results for the two cases using do lmpc scheme are depicted with dashed lines in figs 2 4 respectively for case 1 figs 2 a and 4 a show that the ship s position and heading oscillating in a larger range than ndo nmpc since the yaw rate r see dashed line in fig 2 d is not zero any more which is not consistent with the assumption of r 0 the similar situation as case 1 can be concluded for case 2 which can be seen from figs 3 a 4 b and 3 d thus we conclude that when the disturbances are time varying neither for setpoint regulation nor for trajectory tracking control the proposed ndo nmpc control law provides superior control performance and is robust for unknown time varying disturbances and plant model mismatch in the presence of input saturation 5 conclusions this paper proposes a robust nmpc scheme for dp ships based on the nonlinear disturbance observer the environmental disturbances the plant model mismatch and the input saturation are considered simultaneously the disturbances are unknown in prior and are estimated utilizing the ndo then the nmpc is designed by combining the disturbance estimates into the receding optimization problem by choosing a partial state of x x y ψ t the partial asymptotic stability of nmpc is guaranteed to verify the effectiveness and robustness of the proposed ndo nmpc scheme the time varying disturbances are imposed onto the dp ship with regard to the setpoint regulation and trajectory tracking modes simulation results shows that the ndo nmpc scheme shows good robustness that leads to almost zero tracking error the control performance of the proposed scheme is superior comparing to the do lmpc control law credit authorship contribution statement hualin yang conceptualization funding acquisition writing review editing fang deng methodology software writing original draft yan he supervision dongmei jiao validation data curation zhaolin han investigation appendix nmpc partial stability verification now we will verify the partial stability for x η x y ψ t of the proposed nmpc scheme considering y t h x t η t the cost function 24 can be rewritten as l x t u t η t η r t q 2 u t r 2 to claim the nmpc partial stability we need to verify 25 and 26 thus we choose q diag 100 100 100 γ x t η t η r t 2 l x t η t η r t q 2 and the sampling time t s 0 1 s for simplicity we keep the reference point at the origin η r t 0 m 0 m 0 rad t and meanwhile change the initial state x 0 η 0 ν 0 where η 0 is randomly generated between 1 m 1 m π rad t and 1 m 1 m π rad t with zero velocity ν 0 0 m s 0 m s 0 rad s t the disturbance is set as the first order markov process as well with t d diag 100 100 100 and γ diag 0 4 0 4 0 2 to verify 25 we choose t 10 s with t s 0 1 s which is identical with n p 100 in the simulations we calculate the minimum of v t t x t η t η r t 2 at t k t s k 1 2 500 for 100 samples of x 0 numerical simulations give the minimum value 0 0026 thus it is reasonable that 25 is satisfied with δ t x t 0 001 η t η r t 2 to verify 26 we compute the maximum of v t t x t η t η r t q 2 with t k t 0 k 1 2 8 and t 0 5 s and check the value for t 7 8 10 for each t we randomly generate 5 samples of x 0 for simulations thus we total obtain 40 groups of data the results are depicted in fig 5 in the horizontal ordinate the 1st 5th data points are the results of t 5 s the 6th 10th data points are the results of t 10 s and so on it can be seen that the maximum value decreases when t increases the maximum value is 1 015 when t 7 s and is 0 517 when t 8 s thus 26 is fulfilled with t 8 s and b t 0 6 for t 10 s and t s 0 1 s we can obtain β 1 b t 2 t s t t s 0 64 then the theorem 4 in la et al 2017 is fulfilled therefore the ship position and heading η t is asymptotically stable for the ndo nmpc scheme with q diag 100 100 100 t 10 s n p 100 and t s 0 1 s 
