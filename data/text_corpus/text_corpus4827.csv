index,text
24135,mesoscale eddies are ubiquitous in the ocean and play a key role in exchanges across continental slopes in this study the properties of wind driven baroclinic turbulence are investigated using eddy resolving process simulations focusing on the case of retrograde winds that arises around the margins of the subtropical gyres in contrast to a flat bottomed ocean over steep slopes eddies develop from baroclinic instabilities are confined to the top few hundred meters deeper in the water column baroclinic instability and vertical momentum transfer are suppressed so wind input momentum is exported toward the open ocean by eddies before traversing down to the ocean bed close to the sloping topography eddy energy sourced from the upper ocean is converted to potential energy steepening isopycnals and driving bottom trapped prograde flows this process is associated with upgradient lateral buoyancy fluxes and downgradient isopycnal potential vorticity fluxes and cannot be reproduced via linear stability calculations these properties of wind driven shelf slope turbulence are contrasted against simulations with flat bathymetry the key differences described above hinge on the flow close to the steep topographic slope which may be sensitive to the model s vertical coordinate system the simulations are therefore replicated using models that employ geopotential coordinates terrain following coordinates and isopycnal coordinates quantitative inter model discrepancies in the momentum and energy budgets are much more pronounced in the presence of a steep bottom slope however the key findings of this study are consistent across the models suggesting that they are robust and warrant incorporation into parameterizations of eddy transfer across continental slopes keywords mesoscale eddies continental slopes numerical ocean models eddy transfer eddy parameterization 1 introduction numerical ocean models are increasingly capable of resolving mesoscale eddies e g maltrud and mcclean 2005 this parallels the growing observational evidence that oceanic eddies play a crucial role in modulating the large scale ocean circulation and long term climate evolution dong et al 2014 zhang et al 2014 eddies over continental slopes in particular are found to control the exchanges of heat salt and biogeochemical tracers between coastal and deep oceans and subsequently impact water mass formations and global overturning spall 2004 pickart and spall 2007 spall 2010 jungclaus and mellor 2000 serra and ambar 2002 thoma et al 2008 dinniman et al 2011 nøst et al 2011 hattermann et al 2014 stewart and thompson 2012 2015b eddy induced transfer across continental slopes presents a challenge for ocean observing systems nencioli et al 2016 in view of the fact that the local rossby deformation radius may change sharply from tens of kilometers in the deep open ocean to only a few kilometers across the slope this leads to an eddy field with a rich spectrum of variability e g capet et al 2008a b c that is difficult to measure directly moreover while dynamically significant cross slope exchanges driven by eddies are weak and highly transient compared to the generally dominant alongshore flows this renders measurement and isolation of eddy component from the mean field extremely challenging brink 2016a b partly due to these observational limitations eddy resolving process model studies have been vital in facilitating the development and validation of parameterizations of eddy transfer for global ocean climate models e g visbeck et al 1997 most existing eddy parameterizations are implemented based on the local mean state of ocean and have only been validated against simulations of open ocean eddies gent 2011 griffies et al 2000b such parameterizations are unlikely to be applicable to continental slopes which may introduce distinct turbulence regimes characterized by suppression of eddy transfer at depth and intensification near the surface lacasce 1998 lacasce and brink 2000 these dynamical distinctions must be incorporated into existing eddy parameterizations to allow coarse resolution global ocean models to accurately represent exchanges between continental shelves and the open ocean in order to simulate eddying flows accurately models must use horizontal grids that can resolve at least the first rossby radius of deformation hallberg 2013 and vertical grids that can resolve one or more baroclinic modes stewart et al 2017 in contrast the influence of different vertical coordinate systems among various ocean models has received less emphasis each vertical coordinate system has its own merits and limitations in simulating oceanic flows chassignet et al 2000 2006 willebrand et al 2001 for instance griffies et al 2000a models employing the z coordinate i e geopotential levels are effective in representing weakly stratified areas such as the surface mixed layer whereas models using the isopycnal coordinate i e potential density surfaces are more suitable for studying ocean interior tracer transport that is largely adiabatic i e along isopycnal surfaces in certain areas where steep topography produces leading order variations in ocean depth σ coordinate i e terrain following coordiante models may be favorable in practice different vertical coordinate systems may yield different results when applied to the same physical problem regardless of how similarly the models are configured a classic example of this issue is given by studies on density driven overflows at high latitude which consistently suggest that z coordinate models as compared with isopycnal or σ coordinate models tend to generate excessive spurious diapycnal mixing as the dense water descends down the sloping bottom due to the staircase representation of bottom topography roberts et al 1996 ezer and mellor 2004 legg et al 2006 in the scenario of simulating the basin scale dynamics of the north atlantic such flawed overflows lead to severe reduction of north atlantic deep water formation and substantially weaken the atlantic meridional overturning circulation chassignet et al 1996 similarly simulated baroclinic turbulence over continental slopes may be sensitive to the choice of vertical coordinate options and therefore model dependent ezer 2016 in this study we investigate wind driven baroclinic turbulence over continental slopes and characterize its distinctions from the better understood case of turbulence over flat ocean bed e g visbeck et al 1997 abernathey et al 2013 we have chosen to focus on flows driven by retrograde winds i e winds directed counter to the direction of kelvin wave propagation for two reasons first linear stability theory suggests that prograde and retrograde flows exhibit qualitatively different responses to steepening of the bottom slope blumsack and gierasch 1972 mechoso 1980 isachsen 2011 and should therefore be addresses separately second eddy transfer across prograde fronts has been shown to agree well with predictions by linear stability analysis spall 2004 pennel et al 2012 poulin et al 2014 whereas eddy transfer across retrograde flows diverges substantially from linear predictions and warrants further investigation isachsen 2011 we conduct our simulations using the z coordinate mit general circulation model mitgcm marshall et al 1997 the σ coordinate regional ocean modeling system roms shchepetkin and mcwilliams 2005 and the isopycnal coordinate hallberg isopycnal model him hallberg and rhines 1996 by using models that span the range of widely used vertical coordinate systems we are able to evaluate which of the diagnosed eddy behaviors are model independent and therefore dynamically robust furthermore this approach serves as a tool for comparing the representations of flow topography interactions in different ocean models all three models have been documented in previous literature for studying eddy processes over continental regions stewart and thompson 2015a used the mitgcm to quantify shoreward eddy transport of circumpolar deep water cdw across the antarctic continental slope similarly zhang et al 2011 used him to examine the role of eddy topography interactions in driving the cross slope transport of cdw brink 2016a and brink and seo 2016 uses roms to show that spatially uniform wind stress over a continental slope unconditionally creates ample potential energy pe to fuel baroclinic instabilities independent of whether the forcing is upwelling favorable downwelling favorable or temporally oscillating in this manuscript we focus on the dynamics of baroclinic turbulence in a selected reference simulation and on its representation across different models additional parameter sensitivity experiments described briefly in section 5 did not yield qualitatively different results the rest of the article is organized as follows in section 2 we describe the model configurations used in this study in section 3 we characterize the properties of wind driven baroclinic turbulence over continental slopes using our mitgcm reference simulation as contrasted against simulations conducted with a flat ocean bed in section 4 we validate our findings via comparison with identical simulations conducted using roms and him and quantify inter model differences between the models mean circulations momentum energy budgets and potential vorticity fluxes concluding remarks follow in section 5 2 model configuration in this section we describe the models employed and the configuration of simulations the values of physical parameters of our reference model runs are summarized in table 1 to achieve an objective model inter comparison we have kept every aspect of the model configurations identical where possible exceptions include the treatment of surface boundary layer the prescription of biharmonic viscosity and discretization schemes for momentum and tracer equations 2 1 model domain we consider a zonally uniform channel schematically illustrated in fig 1 a with a continental shelf of 500 m depth located at the southern boundary of the domain the shelf is deeper than most realistic continental shelves e g cacchione et al 2002 to ensure that the flow field over the shelf and slope is adequately resolved in all models the ocean is 4000 m deep at the northern boundary and shoals from the center of the domain toward the shelf across an idealized continental slope specifically the bathymetry z h y is defined by 1 h y z s 1 2 h s tanh y y s w s where y is the offshore distance latitude z s 2250 m denotes the vertical slope position h s 3500 m represents the shelf height y s 200 km marks the offshore slope position and w s 50 km is the slope half width the channel spans 800 km and 500 km in the along slope and cross slope directions respectively throughout this work we will use along slope and longitudinal or zonal interachangeably and similarly for the cross slope with latitudinal or meridional the channel is posed on an f plane because changes in depth dominate the background potential vorticity gradient and so the slope can be thought of as being oriented in any direction relative to meridians similar configurations have been used for studying shelf slope eddies and jets in the southern ocean using mitgcm stewart and thompson 2013 2016 stern et al 2015 a series of flat bottomed runs are conducted with identical configurations of the slope runs except that the steep slope is replaced with a large planetary vorticity gradient β 4 10 11 m 1 s 1 across the channel the addition of an artificially large β is necessary for halting the indefinite growth of the energy containing scale rhines 1975 maltrud and vallis 1991 1992 without widening our domain we found that simulations with no planetary vorticity gradient exhibited statistically steady states that were sensitive to their initial conditions 2 2 model grid and discretization we use a horizontal grid spacing of 2 km in all model runs described here simulations conducted at higher 1 km horizontal grid spacing yielded no qualitative differences from the results reported below it should be noted that though all three models use the c grid design and are set to be consistent in horizontal resolution the algorithms for discretizing the momentum and tracer equations differ specifically mitgcm adopts a finite volume scheme to solve the momentum equations in vector invariant form and advects potential temperature using the second order moment scheme of prather 1986 roms uses the third order upwind advection scheme for both momentum and tracer equations him employs the vorticity advection scheme of arakawa and hsu 1990 and advects isopycnal layer thicknesses using a positive definite finite volume scheme due to the differing vertical coordinate systems it is difficult for models to achieve consistent vertical resolutions over a continental slope we have therefore chosen to ensure matched resolutions in the open ocean by setting identical number of vertical levels to make as fair a comparison as possible mitgcm runs are based on 70 vertical geopotential levels with grid spacing increasing from 10 m at the surface to over 100 m at the ocean bed partial grid cells are used to improve resolution of flows over the continental slope griffies et al 2000a roms runs use 70 terrain following vertical levels with unequal vertical grid spacings that increase resolution close to the ocean bed and the sea floor him runs employ 70 vertical isopycnal layers with thicknesses equal to the mitgcm geopotential grid cell thicknesses at the northern boundary where density surfaces outcrop or incrop density layers may have non zero but arbitrarily thin thicknesses hallberg and rhines 1996 refining the vertical grids from 70 to 133 levels yields only slight quantitative changes in our results 2 3 forcing and boundary conditions all model runs are forced at the surface by a steady alongshore wind stress with the profile defined by 2 τ x τ o sin 2 y l w 0 y l w where τ o 0 05 n m2 denotes the maximum strength of wind located at the offshore slope position y s 200 km l w 400 km measures for the width of forcing in the offshore direction and the negative sign on the right hand side of 2 corresponds to the retrograde i e westward direction of wind stress no surface buoyancy flux is prescribed at the ocean bed all model runs are subject to a drag stress with quadratic coefficient c d 2 5 10 3 serving as a sink for momentum and energy imparted by the surface wind stress periodic boundary conditions are used in the alongshore direction no normal flow conditions are imposed at the shoreward and offshore edges of the domain the potential temperature but not the velocity field is restored to a reference exponential profile across a sponge layer of 50 km width at the northern boundary with a maximum relaxation time scale of 7 days to facilitate the evolution of ocean flow into a statistically steady state this effectively fixes the first baroclinic rossby deformation radius at approximately 18 km in the deep ocean expanding the channel width to 800 km while retaining identical relaxation at the northern boundary yielded negligible differences to the results 2 4 viscosity and mixing the surface k profile parameterization kpp large et al 1994 is used in both mitgcm and roms with their respective default settings the richardson number dependent mixing parameterization is also turned on to simulate shear driven diapycnal mixing in him we impose finite diffusivity and viscosity both set to 5 10 3 m2 s over the upper 50 m of the water column these values are chosen based on the surface mixed layer properties from the roms runs determined by kpp in statistically steady state in addition an explicit biharmonic viscosity is used in both mitgcm and him runs for numerical stability we found that a larger biharmonic viscosity was required in him see table 1 to suppress numerical instabilities at the southern wall in roms runs the grid scale energy enstrophy and tracer variance are controlled via the rotated split third order upwind advection scheme 2 5 model integration all models integrate the three dimensional hydrostatic boussinesq momentum equations coupled with a linearized equation of state depending on potential temperature only each simulation is spun up from a resting state at a coarse 4 km resolution for 35 years until a statistically steady state is reached as determined from the time series of total kinetic energy and total potential temperature the solutions are then interpolated onto a finer 2 km grid and re run for another 15 years to re establish statistical equilibrium daily fields taken from the final 5 years are used for analysis 3 continental slope eddy dynamics in this section we describe the properties of baroclinic turbulence in our mitgcm shelf slope reference run throughout this section we contrast our results against the better understood case of a flat bottomed ocean e g visbeck et al 1997 abernathey et al 2013 to simplify the presentation we focus on the shelf slope simulations and include further information on the flat bottomed simulation in appendix b 3 1 stratification and thermal shear current in statistically steady state the surface wind stress has produced a retrograde front associated with a strong thermal shear current accompanied by an energetic eddy field throughout the channel fig 1 a the structures of the time and along shore mean stratification and thermal shear current are shown in fig 1 b two locations are highlighted with blue ticks at surface one marks the latitude y y s 200 km where the wind stress is maximal and the other indicates surface maximum of the thermal shear current these two locations are separated by a distance of 92 km indicating a pronounced asymmetry in the structure of the current relative to an otherwise symmetric surface wind stress profile furthermore a closer inspection of the zonal velocity contours reveals that multiple zonal jets are embedded in the mean current consistent with confinement of the energy containing scale in the cross shore direction by the topographic potential vorticity gradient rhines 1975 thompson 2010 by contrast in a flat bottomed ocean the wind driven current is almost perfectly symmetric about the wind stress maximum see appendix b 3 2 eddy momentum fluxes in order to understand how the asymmetric current structure is established we now analyze the momentum budget following stewart and thompson 2016 the time and zonal mean momentum equation is formulated as 3 t u y v u z w u f 0 v θ θ z f 0 v under the transformed eulerian mean tem framework plumb and ferrari 2005 where denotes the time and zonal mean operator at constant depths eq 3 states that the divergence of eddy momentum fluxes per unit mass on the left hand side are approximately balanced by the coriolis acceleration resulting from the residual meridional flow v on the right hand side the time derivative term approximately vanishes after time averaging but is retained here for clarity the divergence of the mean momentum flux y v u z w u is negligible in magnitude outside of thin surface and bottom boundary layers and thus omitted fluxes of along slope momentum are then determined by the last three terms on the left hand side of 3 namely the meridional eddy momentum flux v u the vertical eddy momentum flux w u and the eddy form stress f 0 v θ θ z the geostrophic approximation of the vertical momentum transfer due to horizontal pressure gradient forces exerted against fluctuations of isopycnal interfaces e g vallis 2006 in fig 2 a we indicate the direction and magnitude of the eddy momentum flux vector via arrows overlaid on the background thermal shear current here we have reversed the signs of the latter three terms in 3 to visualize the fluxes of retrograde momentum and aid interpretation of their relationship to the retrograde winds and mean current note the almost lateral offshore eddy momentum flux confined in the top few hundred meters over the slope and that downward transfer to the ocean bed occurs in the open ocean further notice that the overall eddy momentum flux pathway follows closely the structure of thermal shear current the surface confined lateral momentum flux appears to stem from above the center of the slope and extends as far as y 400 km this pattern of momentum transfer is consistent with suppression of eddy form stress close to the continental slope requiring that surface confined eddies instead export retrograde momentum toward the open ocean where full depth baroclinic instabilties can transfer it to the ocean bed the relocation of mean current via eddy momentum fluxes is similar to the adjustment of the structure of agulhas return current by transient eddies in the southern ocean morrow et al 1992 toward the sloping bottom the thermal shear current weakens and turns prograde this is evident near the junction to deep ocean and at the shelf break meanwhile the local eddy momentum fluxes decrease sharply in magnitude these processes are indicative of an isolated dynamical regime controlled by bottom topography in fig 2 b and c we plot the individual components of eddy fluxes of retrograde momentum note that lateral eddy momentum flux fig 2 b is mainly confined over the upper few hundred meters and directed offshore over most of the domain eddy form stress fig 2 c dominates over the vertical eddy momentum flux fig 2 d by approximately one order of magnitude approaching the slope however these two terms approximately compensate one another as the eddy form stress decreases rapidly in magnitude and even changes sign where there is a prograde thermal shear current fig 2 a while the advective flux continues to transfer momentum downward 3 3 eddy kinetic energy budget though the interior eddy momentum budget clarifies how the structure of thermal shear current is determined it does not offer information on means by which eddies are generated in classic quasi geostrophic qg theory e g pedlosky 1987 eddies are generated via two mechanisms one is baroclinic instability in which potential energy feeds eddy growth the other is barotropic instability in which eddies extract kinetic energy from the mean flow a necessary condition for baroclinic barotropic instability of a qg flow is that the background potential vorticity pv gradient should change sign in the vertical cross stream direction the reader is referred to pedlosky 1987 and vallis 2006 for a review and isachsen 2011 for the interpretation of relevance of layer pv gradients to baroclinic instability the presence of a sloping ocean bed may therefore alter the stability of a flow by modulating the background pv for instance early studies blumsack and gierasch 1972 mechoso 1980 based on the eady 1949 model predict that the ratio between the topographic slope and isopycnal slope denoted by the slope parameter δ determines the baroclinic stability of the along slope flow our simulations correspond to the case δ 1 in which the ocean bed has the same inclination as yet is more steeply tilted than the isopycnals linear theory predicts that such flows should be stable but the cross slope eddy momentum flux discussed in the previous section indicates otherwise to identify the sources of eddies in our simulation we formulate the interior eke budget equation e g chang and orlanski 1993 chapman et al 2015 and stewart and thompson 2016 4 t u h 2 2 u u h 2 2 u ϕ u h u u h w b which states that in statistically steady state the divergence of eke fluxes per unit mass on the left hand side is approximately balanced by the production rates of eke per unit mass from the reservoirs of mke and pe on the right hand here u h u is the horizontal total velocity vector ϕ p ρ 0 denotes the hydrostatic pressure divided by the reference density and b ρ ρ 0 g ρ 0 represents the buoyancy the local derivative term is retained here again for clarity the eke fluxes consist of two terms u u h 2 2 corresponds to the eke flux driven by the total velocity field and u ϕ denotes the eke flux via eddy pressure work in fig 3 a we plot the logarithm of the mean eke per unit mass along with the net eke flux vectors denoted by arrows note that eke is intensified over the top few hundred meters yet almost depleted near the bottom slope around y 200 km the low eke distribution near the slope is consistent with prior numerical studies asserting that steep slopes suppress eddy activities blumsack and gierasch 1972 isachsen 2011 chen and kamenkovich 2013 hetland 2017 the surface intensification over the slope along with the vertical penetration of eke away in the open ocean suggest that these portions of the domain are dynamically decoupled from the region close to the sloping bottom broadly consistent with the findings of lacasce 1998 and lacasce and brink 2000 moreover eke flux in the upper few hundred meters is directed onshore from the deep ocean potentially serving as a non local driver of eddy mean flow interactions across the slope e g chen et al 2014 fig 3 b shows the mke eke conversion term u h u u h with positive negative contour levels denoting eke gain loss from into mke we can further expand this into four terms 5 u h u u h v u y u v v y v w u z u w v z v the first two terms quantify reynolds stress work associated with eddy momentum fluxes acting parallel to the mean shear characteristic of barotropic instabilities the latter two terms quantify reynolds stress work associated with vertical momentum fluxes and mean shear e g as activated in kelvin helmholtz instabilities brink 2016a brink and seo 2016 which are parameterized via the richardson number dependent mixing in the kpp scheme calculation of these terms reveals that the total conversion on the left hand side of 5 is dominated by the first term on the right hand side which is at least one order of magnitude larger than any of the remaining terms suggesting that barotropic energy conversions in our model are primarily due to lateral eddy momentum fluxes and horizontal shear of the mean current as surface generated eddies propagate offshore they convey retrograde momentum anomalies laterally fig 3 b leading to alternating regions of convergence and divergence of momentum effectively accelerating and decelerating different flanks of thermal shear zonal jets these strong local barotropic sinks and sources of eke largely compensate each other in a whole domain integral contour levels of zero mke eke conversion are plotted in fig 3 b gray bold lines to elucidate the spacing of the three zonal jets identified in this simulation though barotropic eke production locally dominates the right hand side of 4 fig 3 d shows that in a domain integrated sense baroclinic production serves as the primary eddy energy source however in contrast to simulations conducted using a flat bottomed ocean the energy production is largely confined to the top few hundred meters over the slope this agrees broadly with earlier studies on the suppressive influence of topography on baroclinic instabilities isachsen 2011 chen and kamenkovich 2013 hetland 2017 in addition both the rossby number of the mean flow quantified by surface relative vorticity normalized by the coriolis frequency and the bulk richardson number in the top 50 m of the water column approach o 1 over the slope not shown indicating that ageostrophic mixed layer instabilities may play a role in seeding eddies boccaletti et al 2007 fox kemper et al 2008 closer to the continental slope eke production weakens and becomes negative with eddies giving up their energy to increase pe such a conversion of eke into pe is unexpected because the tilted isopycnals see green dashed contours in fig 3 d indicate an abundance of available potential energy it then follows that eke close to the slope must be sourced non locally e g chen et al 2014 consistent with the surface confined shoreward eke flux fig 3 a as pe is the ultimate source of the eddy energy in fig 3 c we plot the mke to pe conversion rate per unit mass ψ mean b y stewart and thompson 2016 where ψ mean denotes the mean overturning streamfunction induced by ekman transport the pe production is largely the result of wind driven ekman pumping and suction which creates vertical mean flows that serve to tilt isopycnal surfaces similar to the baroclinic eke production the pe production is confined close to the surface over the continental slope regions of pe destruction are found close to the ocean bed over the slope indicating that vertical mean flows are acting to reduce isopycnal slopes and thereby remove the potential energy being created by eddies see fig 3 d 3 4 ageostrophic circulation the presence of prograde jets associated with the conversion of eke into pe attached to the sloping bottom suggests a locally distinct ageostrophic flow field compared to that in the deep ocean and the flat bottomed ocean c f appendix b we therefore now examine the isopycnal mean and eddy overturning streamfunctions defined as e g wolfe and cessi 2009 6a ψ iso y z ψ iso y θ h 0 v h θ θ d z 6b ψ mean y z ψ mean y θ 1 l x h 0 v h θ θ d z d x 6c ψ eddy ψ iso ψ mean respectively here denotes a 5 year long time mean operator at constant depths h is the heaviside step function and y θ refer to the potential temperature coordinates following the convention of wolfe 2014 the isopycnal and residual streamfunctions are defined in potential temperature coordinates but mapped back to geopotential coordinates for presentation purposes using the time zonal mean potential temperature field at each latitude we plot ψ mean y z and ψ eddy y z in fig 4 a and b respectively in the open ocean surface and bottom ekman transport imposes a clockwise cell in ψ mean occupying the full water depth whereas ψ eddy exhibits a counterclockwise circulation with similar strength as ψ mean approaching the sloping bottom both ψ mean and ψ eddy exhibit sharp transitions in particular ψ mean exhbits counterclockwise cells at the shelf break and near the junction to deep ocean whereas ψ eddy exhibits clockwise cells around the same locations the approximate compensation across the channel between ψ mean and ψ eddy resembling that in the antarctic circumpolar current marshall and radko 2003 is due to the absence of surface buoyancy forcing and is evident in the much weaker isopycnal overturning streamfunction shown in fig 4 c d a clockwise counterclockwise cell in ψ eddy near away from the slope suggests locally upgradient downgradient eddy buoyancy fluxes effectively isopycnal surfaces near the slope are tilted up by eddies that ultimately reverse the thermal shear current by enhancing the meridional buoyancy gradient while feeding the local pool of pe by consuming eke whereas eddies away from the slope act to flatten the sloping isopycnals converting pe into eke the latter process is triggered by baroclinic instabilities that penetrate throughout the water column in the deep ocean fig 3 d while the former can only be sustained by non local sources of eke fig 3 b d in parallel the counterclockwise rotation of ψ mean is supported dynamically by the divergence of eddy retrograde momentum fluxes in addition to bottom friction to see this we note that ψ eddy v θ θ z under the tem framework marshall and radko 2003 plumb and ferrari 2005 vallis 2006 and re cast 3 as 7 t u y v u z w u f 0 v because the time derivative term in 7 is negligible in statistically steady state the negative v associated with a counterclockwise ψ mean cell near the slope requires divergent eddy fluxes of retrograde momentum consistent with the momentum pathway shown in fig 2 a the residual overturning streamfunction ψ iso y θ and its projection in the cartesian space ψ iso y z exhibit much weaker strength compared to ψ mean and ψ eddy in particular the maximum value of ψ iso y z is approximately 15 of the total ekman transport in the absence of surface buoyancy forcing the isopycnal overturning circulation ψ iso y z is driven primarily by eddy stirring of buoyancy along the ocean surface and the bottom slope this mixing might be enhanced by the staircase representation of topography in mitgcm hill et al 2012 griffies et al 2000a b and partly motivates our reproduction of this simulation setup in roms and him 3 5 generation of slope trapped flows one physical interpretation of the existence of slope trapped flows accompanied by pe production from eke is that eddies over the slope transfer pv downgradient to destroy mean potential enstrophy and in doing so transfer their energy to the mean flow see bretherton and haidvogel 1976 salmon 1998 marshalll et al 2012 from the perspective of statistical mechanics maximizing the entropy of the physical system while conserving energy and potential enstrophy gives rise to prograde mean flows holloway 1978 1986 1992 1993 and is referred to as the neptune effect holloway 1996 this entropy maximization is equivalent to minimizing the potential enstrophy associated with the mean flow in the low energy limit venaille 2012 venaille et al 2012 here we provide a qualitative assessment on this conjecture by analyzing the meridional eddy pv flux the pv the eddy component of its meridional flux and the pv diffusivity are calculated via 8a q f 0 z u θ 8b f q 1 l x θ d x u q s 8c κ θ 1 l x θ d x u q s q y θ where z is the vertical unit vector and s θ θ x is a unit vector parallel to time mean potential temperature surfaces x is the zonal unit vector the subscript θ denotes quantities evaluated at constant time mean potential temperature θ 1 2 o c which spans the meridional width of the channel without outcropping or incropping calculations based on nearby surfaces such as θ 1 0 o c do not yield qualitatively different results note that 8a and 8b is an approximation to the eddy potential vorticity flux defined relative to the thickness weighted average velocity and pv fields e g abernathey et al 2013 these formulations of the eddy pv flux are formally identical in the limit of small isopycnal height fluctuations the mean pv and the zonal mean eddy pv flux are plotted with red curves in fig 5 a and b respectively background pv gradient is oriented onshore throughout the channel i e q y θ 0 due to the dominant role of planetary vortex stretching in contrast eddy pv flux appears to be upgradient i e onshore in the deep ocean yet downgradient i e offshore over the slope the global maximum lies near the shelf break coinciding with prograde flow along the ocean bed and production of pe at the expense of eke fig 5 c shows the eddy diffusivity κθ which is positive downgradient and o 100 1000 m2 s across the slope but then turns sharply negative upgradient in the deep ocean with magnitudes typically far exceeding 1000 m2 s we now employ an approximate qg formulation to relate this pattern of pv mixing to the momentum and energy budgets formally the o 1 change in ocean depth and isopycnal layer thicknesses put our simulations beyond the validity of the qg approximation but qg carries the advantage of relative simplicity and thus ease of interpretation and often facilitates understanding of eddy mixing processes in non qg systems e g abernathey et al 2013 we rewrite 3 as 9 t u v q q g f 0 v where 10 v q q g y v u z w u f 0 z v θ θ z y θ v u f 0 z ψ eddy here we have retained the qg assumption of small isopycnal layer thickness variations and fluctuations but relaxed the qg assumption of small isopycnal slope our formulation therefore differs from the usual qg pv flux e g vallis 2006 via the inclusion of the vertical momentum flux divergence z w u this term is non negligible because lateral momentum transfer is largely aligned with isopycnals which are steeply tilted over the continental slope further note that the reynolds stress term y u v is often neglected altogether based on small rossby number arguments e g abernathey et al 2013 but is retained here because it plays a leading role in the momentum budget eq 9 implies that in statistically steady state an offshore eddy pv flux must be balanced by a shoreward isopycnal transport v 0 fig 4 shows that this transport occurs via a pair of weak positive and negative overturning cells over the slope closed diabatically at the ocean surface over the sloping ocean bed and in the northern sponge layer in the upper part of the water column at the shelf break y 160 km z 250 m the eddy streamfunction increases with depth fig 4 b corresponding to an upgradient eddy thickness flux and an upgradient contribution to the pv flux 10 however this upgradient contribution is opposed by a stronger downgradient contribution due to reynolds stress divergence associated with the strong offshore flux of retrograde momentum fig 2 b deeper in the water column at the same latitude y 160 km z 800 m the reynolds stress divergence weakens but eddy streamfunction gradient changes sign resulting in downgradient fluxes of both thickness and pv here the isopycnals are strongly tilted so this downgradient thickness flux actually corresponds to a buoyancy flux directed downward and offshore laterally upgradient and so produces pe at the expense of eke the near slope consumption of eke and destruction of mean potential enstrophy via the downgradient eddy pv flux are qualitatively consistent with the neptune effect holloway 1992 however these features do not appear consistently across the continental slope but are rather confined to two prograde jets visible in fig 2 a this is in agreement with previous studies of statistical mechanics of turbulence over topographic slopes vallis and maltrud 1993 venaille 2012 in practice cross slope eddy pv mixing is approximately confined by the topographic rhines scale and the realized equilibrium state does not reach the theoretical maximum entropy state of the system in which prograde flows occupy the entire slope 4 model inter comparison our pv mixing analysis indicates a distinct flow regime near the slope however it remains unclear whether these near slope flows are being correctly simulated particularly given the staircase representation of topography in mitgcm and the appearance of a non negligible isopycnal overturning circulation despite the absence of surface buoyancy forcing fig 4 d as outlined in section 2 this motivated us to recreate the simulation setup as closely as possible using roms and him spanning the range of widely used model vertical coordinate systems in general all three models produce qualitatively similar results to those described in section 3 in this section we therefore primarily focus on quantitative differences between the models in table 2 we quantify various properties of the statistically steady state over shelf slope topography in all three models to ensure an accurate comparison daily snapshots of velocity and potential temperature from him were interpolated to geopotential coordinates before calculating all results discussed below 4 1 total momentum budget in statistically steady state each model exhibits an upwelling front with a mean retrograde thermal shear current over most of the domain similar to fig 1 here we choose to focus on three aspects of the mean current namely the strength of thermal shear exhibited by the magnitudes of surface bottom velocity profiles the cross slope offset of surface current maximum from the wind stress maximum location and the manifestation of the prograde jets attached to the slope the mean surface u surf and bottom u bot zonal velocity profiles are plotted in fig 6 a both roms and him exhibit qualitatively similar thermal shear currents to mitgcm in particular their surface retrograde flow maxima are shifted offshore from the slope there are cross slope oscillations of u surf associated with multiple retrograde zonal jets and prograde jets form at the ocean bed over the slope these findings suggest that the asymmetric mean current structure and the topographically controlled flow field in the mitgcm run are not qualitatively model dependent despite the nearly identical configurations of the three models surprisingly large quantitative differences arise between them the deviation of the surface current core is 7 km larger in roms and 20 km smaller in him than that in mitgcm see table 2 and the circled dot markers in fig 6 whereas the mitgcm and roms simulations exhibit three distinct surface retrograde jet cores the him simulation only exhibits two 1 1 the jets exhibit pronounced variability especially those at the surface over the slope not shown however over the five year average used in this study the jets are robust features computing the mean velocities from different 5 year periods in the same simulation yields much smaller changes in the jet structure than the magnitudes of the inter model differences in the jets in addition the surface retrograde flow in roms has a smaller global maximum but extends further offshore implying that on average retrograde momentum in roms is exported further from the location of wind stress maximum by eddies than it is in mitgcm on the other hand him generates the strongest surface current over three models and this flow is confined closer to the continental slope where isopycnals tend to be more steeply tilted and thus the baroclinicity is larger him therefore exhibits a slightly stronger baroclinic along slope transport but a much weaker barotropic along slope transport than those found in the mitgcm and roms simulations table 2 although some effects of different vertical coordinate systems on representing the mean current can be understood by analyzing fig 6 a the momentum balance provides greater insight we formulate the vertically integrated mean momentum budget as 11 t u y v u f 0 v τ x ρ 0 c d u bot 2 v bot 2 1 2 u bot where u v and v u are the vertical integrals of u v and v u respectively notice that 11 is just the vertical integral of 7 plus the source sink terms due to surface bottom stresses and differs from the vector invariant form of the momentum equation that is used to integrate the models eq 11 states that the rate of change in the mean zonal momentum is determined by four factors in order namely the lateral divergence of retrograde momentum flux the coriolis force induced by mean meridional flow 2 2 physically the depth integrated coriolis term necessarily vanishes because the flow is incompressible and f 0 is a constant however this term makes a non zero contribution to the model momentum budgets due to the ways the coriolis forcing are discretized in the three models the wind stress and the bottom drag we plot these terms as functions of latitude in fig 6 b d for mitgcm roms and him in general the models exhibit qualitative consistency in their momentum budgets in particular momentum imparted by surface wind stress over the slope is balanced by horizontal momentum flux divergence a corresponding offshore momentum flux convergence leads the offshore deviation of thermal shear current fig 6 a over the slope the bottom drag actually serves as a source of retrograde momentum and thereby removes momentum from the prograde jets attached to the slope in the deep ocean surface momentum input by wind is everywhere small compared to its extraction by bottom drag it is instructive to examine how this momentum balance changes in the absence of the continental slope fig 7 a shows identical diagnostics as in fig 6 b d but calculated from flat bottomed simulations of each of the three models for clarity the shelf slope and deep ocean regions in the slope runs are now referred to as south core and north regions respectively in this case the models are both qualitatively and quantitatively similar momentum injected by wind is largely transfered directly downward and removed by bottom drag with a modest convergence of momentum in the core region by eddies this is consistent with previous studies of wind driven channel flows on a β plane e g marshall and radko 2003 abernathey et al 2013 but qualitatively different from the shelf slope in which eddies transfer all of the wind input momentum offshore the close quantitative agreement between the models in the flat bottomed case suggests that the more substantial quantitative differences in the shelf slope case stem from their differing representations of flow over topography in the shelf slope simulations we identify four major quantitative inter model discrepancies first in contrast with mitgcm the roms and him momentum budgets show higher drag at the top of the slope than at the bottom accompanying stronger prograde slope trapped jets at the top of the slope second the latitudinal spikes over the slope in the mitgcm momentum budget terms fig 6 b are similar to those found by ezer 2016 in a depth integrated vorticity budget analysis and are due to the staircase representation of topography third in the deep ocean momentum flux convergence is strongest in roms and weakest in him yet the maximum along slope velocity is largest in him and weakest in roms this counter intuitive result occurs because stronger momentum fluxes also push the momentum further from the topographic slope where baroclinicity is weaker thus roms also has the strongest barotropic component in its along slope transport and him the weakest see table 2 fourth while both mitgcm and roms show negligible residual terms in their momentum budgets him s residual is comparable to the magnitude of the wind stress this is true even when computed using online averages of terms in the momentum equation see appendix a and when the large spurious coriolis force term is accounted for the flat bottomed him simulation does not produce a comparable residual in the momentum budget fig 7 a suggesting that outcropping of isopycnals surfaces in the presence of a steep slope introduces substantial errors in him s momentum balance 4 2 energy budget fig 8 a shows the structures and magnitudes of depth integrated eke over the full water columns and upper 300 m there is qualitative consistency in the eke profiles between models in that they are approximately symmetric around the eke maxima which are displaced offshore of the continental slope in addition 40 50 of the eke in the slope region is concentrated within the top 300 m of the water column quantitatively mitgcm and roms produce indistinguishable eke profiles and have more than twice as much domain integrated eke as him table 2 in fig 8 b d we present the conversions of pe and mke into eke integrated over the total depths and top 300 m for each of the three models over the slope baroclinic instabilities are surface intensified with approximately 60 of total production of eke from pe confined within the uppermost 300 m table 2 which may partly hinge on surface mixed layer instabilities boccaletti et al 2007 fox kemper et al 2008 in the deep ocean the near surface eke production is similar to that over the slope but sub surface baroclinic instabilities are no longer suppressed by topography so eke production substantially increases the negative baroclinic eke production at the shelf break y 170 km is due to sub surface eke consumption and pe production which is largest in roms and smallest in him in order table 2 reynolds stress work mke eke is largely confined to the uppermost 300 m of the water column and oscillates with latitude in all three models highlighting the presence of multiple retrograde jets the mixed barotropic baroclinic instabilities associated with these jets seem contradictory with the findings by killworth 1980 who asserts that a jet flow is dominated by baroclinic barotropic instabilities if its spatial scale is much larger smaller than the local deformation radius yet barotropic energy conversion in our simulations is essentially a response of baroclinic eddies to the steep slope that suppresses the vertical transfer of momentum consequently though the total eke production consumption at each latitude is locally dominated by reynolds stress work the domain integrated effect of this term is small in all three models fig 7 b shows that when the continental slope is removed baroclinic instabilities become the only eke source throughout the channel see also appendix b note that the maximal baroclinic conversion rates in the flat bottom cases fig 7 b are one order of magnitude smaller than those in the shelf slope cases fig 8 b d in addition the top 300 m now capture only about 10 of the total baroclinic eke production in the core region suggesting that the continental slope confines baroclinic instabilities to near surface waters reynols stress work is a weak eke sink in the vicinity of wind stress maximum c f appendix b due to the eddy momentum flux convergence into the core region a closer inspection of fig 8 b d reveals that the models differ in a number of ways first mitgcm possesses the largest fluctuations in both barotropic and baroclinic energy conversion rates as functions of latitude for instance the highest total eke production rate yellow curves in fig 8 b d is approximately 2 5 10 5 m2 s 3 in mitgcm and approximately 1 5 10 5 m2 s 3 in both roms and him consequently mitgcm supports the largest net eke gain followed by roms and then him table 2 given the almost identical profiles in fig 8 a the higher eke generation in mitgcm compared to roms indicates greater energy dissipation as well second the baroclinic eke consumption close to the slope is more pronounced in roms than in mitgcm and him the rate of production of pe from eke in roms is more than three times higher than that in either mitgcm or him within the slope region table 2 this is likely associated with roms terrain following coordinate system which avoids the spurious mixing and dissipation over staircase topography present in geopotential coordinate models like mitgcm griffies et al 2000a meanwhile him simulates lower eke and weaker eke production than the other models fig 8 a so less eke is available for conversion to pe close to the sloping topography third some spikes can be seen in the profiles shown in fig 8 b again a consequence of the staircase representation of topography in mitgcm fourth the reynolds stress work profiles derived from mitgcm and roms indicate three retrograde jet cores whereas only two are evident in the him simulation various factors could contribute to a change in the number of jets e g vallis and maltrud 1993 thompson and young 2007 so a suite of simulations conducted using each of these three models would likely be required to fully explain this inter model discrepancy 4 3 pv mixing and ageostrophic circulation in section 3 we showed that eddies flux pv downgradient over the continental slope coinciding with downgradient thickness fluxes but upgradient lateral buoyancy fluxes close to the ocean bed this suggests that the slope trapped prograde flows might be understood via statistical mechanical arguments specifically entropy maximization or mean enstrophy minimization often referred to as the neptune effect holloway 1992 venaille et al 2012 we now explore whether roms and him reproduce this dynamical regime over the slope the blue green curves in fig 5 show the profiles of background pv q θ offshore eddy pv fluxes fq and pv diffusivity κθ as functions of latitude from roms him on selected isopycnal surfaces in general background pv is dominated by planetary vortex stretching and thus decreases with latitude over the slope and deep ocean regions in the deep ocean the mean pv differs by a factor of 1 5 between the models but the mean pv gradients are consistently small over the slope however the pv gradients exhibit substantial inter model differences varying by an order of magnitude between models close to the shelf break y 170 km this indicates that the models stratifications at the shelf break are sensitive to the quantitative differences in eddy behavior e g as diagnosed from the momentum and energy budgets in part because the continental shelf stratification is least constrained by the northern sponge layer fig 5 b shows that eddies consistently drive downgradient and upgradient pv fluxes over the slope and in the deep ocean respectively near the shelf break local maxima of eddy pv flux are visible in all models coinciding with locations where eke is converted into pe fig 8 b d the stronger deep ocean upgradient eddy pv fluxes in mitgcm and roms are consistent with the stronger eddy momentum flux convergence in these models fig 6 b d despite these discrepancies a dynamical transition between slope and deep ocean is evident in all of the models fig 9 shows the mean eddy and isopycnal overturning streamfunctions diagnosed from the roms and him shelf slope simulations superscripts r and h respectively correspond to roms and him these circulations are qualitatively similar to that of the mitgcm simulation with strong compensating mean and eddy overturning streamfunctions displaced offshore and circulations of opposite sign trapped close to the ocean bed over the slope close to the ocean bed the downgradient pv flux in all models fig 5 c is supported by a downgradient thickness flux and upgradient buoyancy flux fig 9 c and d thus the slope trapped dynamical regime is a model independent feature though it exhibits substantial quantitative inter model variations for example while roms exhibits two slope trapped mean eddy overturning circulations as in mitgcm only one slope trapped overturning cell is visible in him e g compare fig 9 panels a and b paralleling the reduced number of retrograde jet cores at the surface additionally based on 7 the stronger weaker mean overturning circulation at the shelf break in roms him implies locally larger smaller divergence in eddy fluxes of retrograde momentum consistent with the eddy momentum budget in fig 6 the stronger negative mean slope trapped overturning circulation in roms is accompanied by a stronger positive eddy circulation and thus greater conversion of eke to pe close to the ocean bed consistent with fig 8 and table 2 this highlights a key difference between the mitgcm and roms simulations which have very similar momentum and energy budgets figs 6 8 in roms eke generated close to the surface over the slope is much more efficiently converted to pe at the ocean bed table 2 yielding substantially stronger slope trapped prograde flows fig 6 a and consequently demanding greater export of retrograde momentum to the deep ocean 4 4 linear stability analysis despite the various quantitative inter model discrepancies all of the model simulations show the same qualitative features namely lateral eddy export of momentum surface trapped baroclinic instabilities and the slope trapped upgradient buoyancy fluxes we now ask to what extent can these features and their inter model variations be captured by linear stability analysis which has been widely used to understand topography flow interactions and been shown to have skill in predicting nonlinear eddy behaviors in prograde shelf break currents e g spall 2004 isachsen 2011 pennel et al 2012 poulin et al 2014 to answer this we perform calculations over the continental slope using the linearized quasigeostrophic qg equations e g smith 2007 and isachsen 2011 12 q t j ψ q j ψ q 0 h z 0 b t j ψ b j ψ b 0 z 0 b t j ψ b j ψ b j ψ s b z 0 z h where q 2 ψ γ ψ is the qg potential vorticity pv perturbation γ z f 0 2 n 2 z is conventionally defined as the vortex stretching operator smith 2007 tulloch et al 2011 ψ denotes the qg eddy streamfunction b f 0 ψ z corresponds to buoyancy perturbation and s is the sea floor height the mean geostrophic streamfunction background qg pv and mean buoyancy are denoted as ψ q and b respectively below we solve 12 for the unknown perturbations ψ and q deriving ψ q and b from the mean states of our nonlinear simulations substituting the wave solution of the form 13 ψ φ z e i k x l y ω t into 12 yields 14 ω γ k 2 l 2 φ k q y k u γ k 2 l 2 φ h z 0 ω k u φ z k u z φ 0 z 0 ω k u φ z k u z n 2 f 0 s y φ 0 z h where the ageostrophic meridional velocity has been excluded e g pedlosky 1987 and vallis 2006 here qy is the background qg pv gradient and sy is the horizontal gradient of the sea floor height with respect to latitude eq 14 comprises an eigenvalue problem in terms of the complex frequency ω with eigenfunctions that correspond to the vertical structure φ we solve this eigenvalue problem numerically via vertical discretization of φ as described by smith 2007 following tulloch et al 2011 any unstable modal solution of 14 with wavenumber larger than five times of the inverse deformation radius is abandoned as our model runs barely resolve them in the presence of steep slopes several caveats should be stressed prior to discussing the linear solutions first 12 holds only if the horizontal variations of mean stratification bz are negligible e g pedlosky 1987 and vallis 2006 a condition that is violated by our primitive equation simulations nevertheless such a procedure proved successful in qualitatively understanding eddy field over continental slopes around the lofoten basin across which stratification changes sharply isachsen 2015 second previous qg analysis reveals that ignoring the horizontal shear of velocity may lead to qualitative errors in linear solutions killworth 1980 over steep slopes mean relative vorticity may even dominate the background qg pv and hence impact the growth rates and length scales of baroclinic unstable waves isachsen 2015 we therefore have retained the relative vorticity component when defining q 3 3 inclusion of mean relative vorticity also makes linear calculations two dimensional by encompassing barotropic modes which we have chosen to leave out by imposing 13 because it is the baroclinic instability that serves to generate eddies in our simulations finally analogous to isachsen 2011 2015 the slope here only enters the qg equations via bottom pv sheets in the bottom boundary condition of 12 in contrast our simulations exhibit isopycnal outcropping along the slope an effect that cannot be captured in a qg model fig 10 a shows the normalized vertical structure φ of the fastest growing modes at y 200 km latitude where the bottom slope is steepest the fastest growing modes are all purely meridional noodle modes i e having meridional wave number l 0 chen and kamenkovich 2013 in both the shelf slope and flat bottom simulations using the mean state from the shelf slope runs all models produce unstable linear modes that are strongly surface intensified in qualitative agreement with the surface confined baroclinic energy production shown in fig 3 in contrast in the flat bottom cases the unstable modal structures are of comparable magnitude throughout the water column consistent with the baroclinic energy production at depth in fig 7 b see also appendix b thus while there are quantitative inter model discrepancies in the vertical structures of the solutions both in the shelf slope and flat bottom simulations it seems that the surface intensification of baroclinic energy is explained by linear theory and specifically by suppression of baroclinic instability by the topographic pv gradient in our nonlinear simulations the lower part of the water column over the slope exhibits laterally upgradient buoyancy fluxes and eke consumption fig 10 b d compares the buoyancy fluxes predicted by linear theory against those diagnosed from our nonlinear simulations in the linear qg theory the lateral time zonal mean buoyancy flux can be written as 15 f b 1 2 k c f 0 φ r φ i z φ i φ r z e 2 ω i t where kc is the wavenumber of most unstable wave φr φi denotes the real imaginary part of its structural coefficient φ z and ωi is the growth rate as the wave growth is positive definite we focus on the time independent factor of fb only we focus on linear solutions and nonlinear fluxes derived from latitudes between y 150 km and y 200 km where upgradient buoyancy fluxes appear consistently in the nonlinear model simulations the nonlinear solutions consistently produce relatively large downgradient shoreward buoyancy fluxes in the upper few hundred meters of the water column overlying upgradient offshore buoyancy fluxes in the deeper portions of the water column while the linear solutions also predict strong downgradient buoyancy fluxes close to the surface in the subsurface these fluxes remain downgradient and gradually decrease in magnitude with depth while the linear buoyancy fluxes are very slightly upgradient in a few locations overall the linear prediction is qualitatively different from the nonlinear realizations this disagreement reinforces our conclusion that the upgradient buoyancy fluxes and the associated consumption of eke close to the slope are sustained via non local sources of eke linear stability analysis is built on local mean flow field alone and appears to be incapable of reproducing this phenomenon additionally the linear solutions predict a lateral eddy momentum flux f m 1 2 ϕ 2 z k c l c warneford and dellar 2017 that is identically zero for any noodle mode i e l c 0 where lc denotes the meridional wave number of the most unstable modal solution the linear predictions therefore also fail to capture the strong offshore flux of retrograde momentum and associated reynods stress convergence of energy 5 summary and conclusion eddies over continental slopes play a key role in shaping water mass formations and the ocean general circulation spall 2004 brink 2016b stewart and thompson 2015a nonlinear eddy behaviors resulting from instabilities of prograde baroclinic currents have been shown to be well explained by the linear phase of baroclinic growth in contrast to retrograde baroclinic currents spall 2004 isachsen 2011 pennel et al 2012 in this article we have studied baroclinic turbulence over an idealized continental slope under retrograde winds using three numerical ocean models that span the range of commonly used vertical coordinate systems results that are consistently reproduced between these models are inferred to be insensitive to the discrete representation of flow over topography and therefore most physically robust quantitative discrepancies among models are related to multiple differences in the numerical algorithms listed in section 2 the sources of numerical error e g in the momentum budgets are also model dependent we therefore refrain from offering comment on which model performs best in this application our reference simulations share several key features that distinguish shelf slope baroclinic turbulence from the case of a flat ocean bed momentum imparted by surface wind stress is exported laterally by eddies in the top few hundred meters shifting the thermal shear current offshore this offshore retrograde momentum flux combined with the formation of multiple retrograde jet cores separated approximately by the topographic rhines scale rhines 1975 vallis and maltrud 1993 leads to a series of barotropic energy conversions of alternating signs this eddy momentum transfer is intrinsically nonlinear in nature and cannot be reproduced using qg linear stability theory in the open ocean eddy momentum flux is dominantly downward and balanced by bottom drag when the continental slope is replaced by a flat ocean bed momentum is instead transfered directly downward and locally extracted via bottom drag in our model runs the eddies are principally generated by baroclinic instabilities confined within the uppermost few hundred meters of the water column consistent with the local linear stability analysis and prior studies based on analytical qg models e g chen and kamenkovich 2013 away from the slope baroclinic instabilities penetrate to depth as topographic suppression is mitigated this eke generation serves as a non local driver of pe production close to the sloping ocean bed acting to tilt isopycnals and accelerate prograde near bottom flows this consumption of eke is associated with downgradient eddy pv and thickness fluxes but upgradient lateral buoyancy fluxes the near slope dynamics are therefore qualitatively consistent with the neptune effect holloway 1992 in which eddies drive prograde flows as the system tends toward a state of maximum entropy or minimum mean potential enstrophy venaille et al 2012 additional spin down simulations will be required to further validate this effect the non local energetics associated with this dynamical regime place it beyond the scope of linear theory the angle of bottom topography in our reference simulation is approximately 2 o and thus falls within the average range of steepness of realistic continental slopes e g cacchione et al 2002 we have also performed a series of sensitivity runs based on mitgcm 4 4 since almost no difference is yielded by replacing the kpp in the reference run with a large diffusivity 100 m2 s for parameterizing convective instabilities in mitgcm all sensitivity runs follow this setting for computational efficiency to further verify the applicability of our results by varying key physical parameters namely the slope width to 50 km or 200 km the wind stress maximum to 0 025 n m 2 or 0 1 n m 2 and the thermal expansion coefficient to 5 10 5 o c 1 or 2 10 4 o c 1 all sensitivity runs reproduce the key turbulent properties discussed in section 3 momentum injected by wind is exported laterally by eddies over the top few hundred meters c f sections 3 2 and 4 1 baroclinic instabilities are trapped within the top few hundred meters c f sections 3 3 and 4 2 the conversion of eke into pe dominates the slope trapped flows corresponding to upgradient eddy buoyancy fluxes c f sections 3 3 4 2 and 4 4 here we briefly explore the robustness of the sloping bottom trapped flows under alternative physical conditions fig 11 a shows the bottom along slope velocity profiles as functions of offshore distance after time zonal mean all sensitivity simulations produce prograde flows though with deviating magnitudes and locations the weakest prograde jet is supported by the least stratified flow with halved thermal expansion coefficient contrasted to the reference run accordingly fig 11 b which shows the time zonal averages of conversion rate of pe into eke integrated over the bottom 300 m as functions of latitude suggests that all prograde flows are accompanied by generation of pe from eke though this association is less obvious for weakly stratified flows we also note that previous model studies e g of the california current system fig 4 of colas et al 2013 and the antarctic slope front fig 7 a of stewart and thompson 2016 exhibit eke consumption close to the continental slope lending additional support to our conclusions and their applicability to the ocean figs 12 16 though our findings are qualitatively consistent across different models and sensitivity simulations in parameter ranges relevant to the oceans our study carries a number of caveats associated with our idealized model configuration for instance the simulations do not include zonal variations in bottom topography which can alter the zonal momentum budget 11 via bottom form drag e g molemaker et al 2015 additionally curvature in the continental slope modifies the growth of baroclinic instabilities solodoch et al 2016 and favors breaking of topographic rossby waves stewart et al 2014 2011 buoyancy forcing can also effectively shape the flow field over continental slopes and modulate the pv field we have neglected tides which often play a non negligible role in forming shelf break fronts e g brink 2012 2013 finally we have not incorporated temporal variations in surface wind stress which can impact eddy variabilities over continental slopes zhai and greatbatch 2007 renault et al 2016 further work is required to develop a predictive theory relating the bottom slope and forcing to the resulting mean flow and cross slope eddy transfer expanding our sensitivity simulations and developing such a theory is the subject of ongoing work however our findings do suggest that any parameterization for eddy transfer across continental slopes must include an explicit treatment of the eddy momentum fluxes which make a leading order contribution to the mean circulation in our model runs the downgradient mixing of pv over the slope suggests that a pv based rather than buoyancy based approach to parameterizing eddies over steep slopes may be necessary acknowledgments the authors are thankful to kaushik srinivasan for his help with roms this work used the extreme science and engineering discovery environment xsede towns et al 2014 which is supported by national science foundation grant number aci 1548562 yw and als are supported by national science foundation grant number oce 1538702 the authors thank g e manucharyan and an anonymous reviewer for comments that improved this article appendix a depth integrated momentum budget for him here we briefly describe the calculation of depth integrated momentum budget for him a total of four individual terms are shown in fig 6 d the wind stress input term is simply 2 divided by ρ 0 and consistent across models the depth averaged advection and coriolis acceleration terms located at velocity points of numerical grid boxes in conjunction with the layer thicknesses located at mass points of numerical grid boxes are readily output from the him code the only modification needed for obtaining the depth integrated terms is to linearly interpolate the water column height from mass onto velocity points for computational accuracy the calculation of bottom drag follows exactly the algorithm provided by him code which is based on a quadratic drag law and computes the friction velocity assigned to the bottom 10 m a default value in him from the solutions of velocity field and layer thicknesses appendix b diagnostics from mitgcm flat bottomed run here we reproduce the same plots as in section 3 for the flat bottomed run of mitgcm as a reference for better illustration the value ranges of some diagnostics are modified compared to those in section 3 and noted in the figure captions 
24135,mesoscale eddies are ubiquitous in the ocean and play a key role in exchanges across continental slopes in this study the properties of wind driven baroclinic turbulence are investigated using eddy resolving process simulations focusing on the case of retrograde winds that arises around the margins of the subtropical gyres in contrast to a flat bottomed ocean over steep slopes eddies develop from baroclinic instabilities are confined to the top few hundred meters deeper in the water column baroclinic instability and vertical momentum transfer are suppressed so wind input momentum is exported toward the open ocean by eddies before traversing down to the ocean bed close to the sloping topography eddy energy sourced from the upper ocean is converted to potential energy steepening isopycnals and driving bottom trapped prograde flows this process is associated with upgradient lateral buoyancy fluxes and downgradient isopycnal potential vorticity fluxes and cannot be reproduced via linear stability calculations these properties of wind driven shelf slope turbulence are contrasted against simulations with flat bathymetry the key differences described above hinge on the flow close to the steep topographic slope which may be sensitive to the model s vertical coordinate system the simulations are therefore replicated using models that employ geopotential coordinates terrain following coordinates and isopycnal coordinates quantitative inter model discrepancies in the momentum and energy budgets are much more pronounced in the presence of a steep bottom slope however the key findings of this study are consistent across the models suggesting that they are robust and warrant incorporation into parameterizations of eddy transfer across continental slopes keywords mesoscale eddies continental slopes numerical ocean models eddy transfer eddy parameterization 1 introduction numerical ocean models are increasingly capable of resolving mesoscale eddies e g maltrud and mcclean 2005 this parallels the growing observational evidence that oceanic eddies play a crucial role in modulating the large scale ocean circulation and long term climate evolution dong et al 2014 zhang et al 2014 eddies over continental slopes in particular are found to control the exchanges of heat salt and biogeochemical tracers between coastal and deep oceans and subsequently impact water mass formations and global overturning spall 2004 pickart and spall 2007 spall 2010 jungclaus and mellor 2000 serra and ambar 2002 thoma et al 2008 dinniman et al 2011 nøst et al 2011 hattermann et al 2014 stewart and thompson 2012 2015b eddy induced transfer across continental slopes presents a challenge for ocean observing systems nencioli et al 2016 in view of the fact that the local rossby deformation radius may change sharply from tens of kilometers in the deep open ocean to only a few kilometers across the slope this leads to an eddy field with a rich spectrum of variability e g capet et al 2008a b c that is difficult to measure directly moreover while dynamically significant cross slope exchanges driven by eddies are weak and highly transient compared to the generally dominant alongshore flows this renders measurement and isolation of eddy component from the mean field extremely challenging brink 2016a b partly due to these observational limitations eddy resolving process model studies have been vital in facilitating the development and validation of parameterizations of eddy transfer for global ocean climate models e g visbeck et al 1997 most existing eddy parameterizations are implemented based on the local mean state of ocean and have only been validated against simulations of open ocean eddies gent 2011 griffies et al 2000b such parameterizations are unlikely to be applicable to continental slopes which may introduce distinct turbulence regimes characterized by suppression of eddy transfer at depth and intensification near the surface lacasce 1998 lacasce and brink 2000 these dynamical distinctions must be incorporated into existing eddy parameterizations to allow coarse resolution global ocean models to accurately represent exchanges between continental shelves and the open ocean in order to simulate eddying flows accurately models must use horizontal grids that can resolve at least the first rossby radius of deformation hallberg 2013 and vertical grids that can resolve one or more baroclinic modes stewart et al 2017 in contrast the influence of different vertical coordinate systems among various ocean models has received less emphasis each vertical coordinate system has its own merits and limitations in simulating oceanic flows chassignet et al 2000 2006 willebrand et al 2001 for instance griffies et al 2000a models employing the z coordinate i e geopotential levels are effective in representing weakly stratified areas such as the surface mixed layer whereas models using the isopycnal coordinate i e potential density surfaces are more suitable for studying ocean interior tracer transport that is largely adiabatic i e along isopycnal surfaces in certain areas where steep topography produces leading order variations in ocean depth σ coordinate i e terrain following coordiante models may be favorable in practice different vertical coordinate systems may yield different results when applied to the same physical problem regardless of how similarly the models are configured a classic example of this issue is given by studies on density driven overflows at high latitude which consistently suggest that z coordinate models as compared with isopycnal or σ coordinate models tend to generate excessive spurious diapycnal mixing as the dense water descends down the sloping bottom due to the staircase representation of bottom topography roberts et al 1996 ezer and mellor 2004 legg et al 2006 in the scenario of simulating the basin scale dynamics of the north atlantic such flawed overflows lead to severe reduction of north atlantic deep water formation and substantially weaken the atlantic meridional overturning circulation chassignet et al 1996 similarly simulated baroclinic turbulence over continental slopes may be sensitive to the choice of vertical coordinate options and therefore model dependent ezer 2016 in this study we investigate wind driven baroclinic turbulence over continental slopes and characterize its distinctions from the better understood case of turbulence over flat ocean bed e g visbeck et al 1997 abernathey et al 2013 we have chosen to focus on flows driven by retrograde winds i e winds directed counter to the direction of kelvin wave propagation for two reasons first linear stability theory suggests that prograde and retrograde flows exhibit qualitatively different responses to steepening of the bottom slope blumsack and gierasch 1972 mechoso 1980 isachsen 2011 and should therefore be addresses separately second eddy transfer across prograde fronts has been shown to agree well with predictions by linear stability analysis spall 2004 pennel et al 2012 poulin et al 2014 whereas eddy transfer across retrograde flows diverges substantially from linear predictions and warrants further investigation isachsen 2011 we conduct our simulations using the z coordinate mit general circulation model mitgcm marshall et al 1997 the σ coordinate regional ocean modeling system roms shchepetkin and mcwilliams 2005 and the isopycnal coordinate hallberg isopycnal model him hallberg and rhines 1996 by using models that span the range of widely used vertical coordinate systems we are able to evaluate which of the diagnosed eddy behaviors are model independent and therefore dynamically robust furthermore this approach serves as a tool for comparing the representations of flow topography interactions in different ocean models all three models have been documented in previous literature for studying eddy processes over continental regions stewart and thompson 2015a used the mitgcm to quantify shoreward eddy transport of circumpolar deep water cdw across the antarctic continental slope similarly zhang et al 2011 used him to examine the role of eddy topography interactions in driving the cross slope transport of cdw brink 2016a and brink and seo 2016 uses roms to show that spatially uniform wind stress over a continental slope unconditionally creates ample potential energy pe to fuel baroclinic instabilities independent of whether the forcing is upwelling favorable downwelling favorable or temporally oscillating in this manuscript we focus on the dynamics of baroclinic turbulence in a selected reference simulation and on its representation across different models additional parameter sensitivity experiments described briefly in section 5 did not yield qualitatively different results the rest of the article is organized as follows in section 2 we describe the model configurations used in this study in section 3 we characterize the properties of wind driven baroclinic turbulence over continental slopes using our mitgcm reference simulation as contrasted against simulations conducted with a flat ocean bed in section 4 we validate our findings via comparison with identical simulations conducted using roms and him and quantify inter model differences between the models mean circulations momentum energy budgets and potential vorticity fluxes concluding remarks follow in section 5 2 model configuration in this section we describe the models employed and the configuration of simulations the values of physical parameters of our reference model runs are summarized in table 1 to achieve an objective model inter comparison we have kept every aspect of the model configurations identical where possible exceptions include the treatment of surface boundary layer the prescription of biharmonic viscosity and discretization schemes for momentum and tracer equations 2 1 model domain we consider a zonally uniform channel schematically illustrated in fig 1 a with a continental shelf of 500 m depth located at the southern boundary of the domain the shelf is deeper than most realistic continental shelves e g cacchione et al 2002 to ensure that the flow field over the shelf and slope is adequately resolved in all models the ocean is 4000 m deep at the northern boundary and shoals from the center of the domain toward the shelf across an idealized continental slope specifically the bathymetry z h y is defined by 1 h y z s 1 2 h s tanh y y s w s where y is the offshore distance latitude z s 2250 m denotes the vertical slope position h s 3500 m represents the shelf height y s 200 km marks the offshore slope position and w s 50 km is the slope half width the channel spans 800 km and 500 km in the along slope and cross slope directions respectively throughout this work we will use along slope and longitudinal or zonal interachangeably and similarly for the cross slope with latitudinal or meridional the channel is posed on an f plane because changes in depth dominate the background potential vorticity gradient and so the slope can be thought of as being oriented in any direction relative to meridians similar configurations have been used for studying shelf slope eddies and jets in the southern ocean using mitgcm stewart and thompson 2013 2016 stern et al 2015 a series of flat bottomed runs are conducted with identical configurations of the slope runs except that the steep slope is replaced with a large planetary vorticity gradient β 4 10 11 m 1 s 1 across the channel the addition of an artificially large β is necessary for halting the indefinite growth of the energy containing scale rhines 1975 maltrud and vallis 1991 1992 without widening our domain we found that simulations with no planetary vorticity gradient exhibited statistically steady states that were sensitive to their initial conditions 2 2 model grid and discretization we use a horizontal grid spacing of 2 km in all model runs described here simulations conducted at higher 1 km horizontal grid spacing yielded no qualitative differences from the results reported below it should be noted that though all three models use the c grid design and are set to be consistent in horizontal resolution the algorithms for discretizing the momentum and tracer equations differ specifically mitgcm adopts a finite volume scheme to solve the momentum equations in vector invariant form and advects potential temperature using the second order moment scheme of prather 1986 roms uses the third order upwind advection scheme for both momentum and tracer equations him employs the vorticity advection scheme of arakawa and hsu 1990 and advects isopycnal layer thicknesses using a positive definite finite volume scheme due to the differing vertical coordinate systems it is difficult for models to achieve consistent vertical resolutions over a continental slope we have therefore chosen to ensure matched resolutions in the open ocean by setting identical number of vertical levels to make as fair a comparison as possible mitgcm runs are based on 70 vertical geopotential levels with grid spacing increasing from 10 m at the surface to over 100 m at the ocean bed partial grid cells are used to improve resolution of flows over the continental slope griffies et al 2000a roms runs use 70 terrain following vertical levels with unequal vertical grid spacings that increase resolution close to the ocean bed and the sea floor him runs employ 70 vertical isopycnal layers with thicknesses equal to the mitgcm geopotential grid cell thicknesses at the northern boundary where density surfaces outcrop or incrop density layers may have non zero but arbitrarily thin thicknesses hallberg and rhines 1996 refining the vertical grids from 70 to 133 levels yields only slight quantitative changes in our results 2 3 forcing and boundary conditions all model runs are forced at the surface by a steady alongshore wind stress with the profile defined by 2 τ x τ o sin 2 y l w 0 y l w where τ o 0 05 n m2 denotes the maximum strength of wind located at the offshore slope position y s 200 km l w 400 km measures for the width of forcing in the offshore direction and the negative sign on the right hand side of 2 corresponds to the retrograde i e westward direction of wind stress no surface buoyancy flux is prescribed at the ocean bed all model runs are subject to a drag stress with quadratic coefficient c d 2 5 10 3 serving as a sink for momentum and energy imparted by the surface wind stress periodic boundary conditions are used in the alongshore direction no normal flow conditions are imposed at the shoreward and offshore edges of the domain the potential temperature but not the velocity field is restored to a reference exponential profile across a sponge layer of 50 km width at the northern boundary with a maximum relaxation time scale of 7 days to facilitate the evolution of ocean flow into a statistically steady state this effectively fixes the first baroclinic rossby deformation radius at approximately 18 km in the deep ocean expanding the channel width to 800 km while retaining identical relaxation at the northern boundary yielded negligible differences to the results 2 4 viscosity and mixing the surface k profile parameterization kpp large et al 1994 is used in both mitgcm and roms with their respective default settings the richardson number dependent mixing parameterization is also turned on to simulate shear driven diapycnal mixing in him we impose finite diffusivity and viscosity both set to 5 10 3 m2 s over the upper 50 m of the water column these values are chosen based on the surface mixed layer properties from the roms runs determined by kpp in statistically steady state in addition an explicit biharmonic viscosity is used in both mitgcm and him runs for numerical stability we found that a larger biharmonic viscosity was required in him see table 1 to suppress numerical instabilities at the southern wall in roms runs the grid scale energy enstrophy and tracer variance are controlled via the rotated split third order upwind advection scheme 2 5 model integration all models integrate the three dimensional hydrostatic boussinesq momentum equations coupled with a linearized equation of state depending on potential temperature only each simulation is spun up from a resting state at a coarse 4 km resolution for 35 years until a statistically steady state is reached as determined from the time series of total kinetic energy and total potential temperature the solutions are then interpolated onto a finer 2 km grid and re run for another 15 years to re establish statistical equilibrium daily fields taken from the final 5 years are used for analysis 3 continental slope eddy dynamics in this section we describe the properties of baroclinic turbulence in our mitgcm shelf slope reference run throughout this section we contrast our results against the better understood case of a flat bottomed ocean e g visbeck et al 1997 abernathey et al 2013 to simplify the presentation we focus on the shelf slope simulations and include further information on the flat bottomed simulation in appendix b 3 1 stratification and thermal shear current in statistically steady state the surface wind stress has produced a retrograde front associated with a strong thermal shear current accompanied by an energetic eddy field throughout the channel fig 1 a the structures of the time and along shore mean stratification and thermal shear current are shown in fig 1 b two locations are highlighted with blue ticks at surface one marks the latitude y y s 200 km where the wind stress is maximal and the other indicates surface maximum of the thermal shear current these two locations are separated by a distance of 92 km indicating a pronounced asymmetry in the structure of the current relative to an otherwise symmetric surface wind stress profile furthermore a closer inspection of the zonal velocity contours reveals that multiple zonal jets are embedded in the mean current consistent with confinement of the energy containing scale in the cross shore direction by the topographic potential vorticity gradient rhines 1975 thompson 2010 by contrast in a flat bottomed ocean the wind driven current is almost perfectly symmetric about the wind stress maximum see appendix b 3 2 eddy momentum fluxes in order to understand how the asymmetric current structure is established we now analyze the momentum budget following stewart and thompson 2016 the time and zonal mean momentum equation is formulated as 3 t u y v u z w u f 0 v θ θ z f 0 v under the transformed eulerian mean tem framework plumb and ferrari 2005 where denotes the time and zonal mean operator at constant depths eq 3 states that the divergence of eddy momentum fluxes per unit mass on the left hand side are approximately balanced by the coriolis acceleration resulting from the residual meridional flow v on the right hand side the time derivative term approximately vanishes after time averaging but is retained here for clarity the divergence of the mean momentum flux y v u z w u is negligible in magnitude outside of thin surface and bottom boundary layers and thus omitted fluxes of along slope momentum are then determined by the last three terms on the left hand side of 3 namely the meridional eddy momentum flux v u the vertical eddy momentum flux w u and the eddy form stress f 0 v θ θ z the geostrophic approximation of the vertical momentum transfer due to horizontal pressure gradient forces exerted against fluctuations of isopycnal interfaces e g vallis 2006 in fig 2 a we indicate the direction and magnitude of the eddy momentum flux vector via arrows overlaid on the background thermal shear current here we have reversed the signs of the latter three terms in 3 to visualize the fluxes of retrograde momentum and aid interpretation of their relationship to the retrograde winds and mean current note the almost lateral offshore eddy momentum flux confined in the top few hundred meters over the slope and that downward transfer to the ocean bed occurs in the open ocean further notice that the overall eddy momentum flux pathway follows closely the structure of thermal shear current the surface confined lateral momentum flux appears to stem from above the center of the slope and extends as far as y 400 km this pattern of momentum transfer is consistent with suppression of eddy form stress close to the continental slope requiring that surface confined eddies instead export retrograde momentum toward the open ocean where full depth baroclinic instabilties can transfer it to the ocean bed the relocation of mean current via eddy momentum fluxes is similar to the adjustment of the structure of agulhas return current by transient eddies in the southern ocean morrow et al 1992 toward the sloping bottom the thermal shear current weakens and turns prograde this is evident near the junction to deep ocean and at the shelf break meanwhile the local eddy momentum fluxes decrease sharply in magnitude these processes are indicative of an isolated dynamical regime controlled by bottom topography in fig 2 b and c we plot the individual components of eddy fluxes of retrograde momentum note that lateral eddy momentum flux fig 2 b is mainly confined over the upper few hundred meters and directed offshore over most of the domain eddy form stress fig 2 c dominates over the vertical eddy momentum flux fig 2 d by approximately one order of magnitude approaching the slope however these two terms approximately compensate one another as the eddy form stress decreases rapidly in magnitude and even changes sign where there is a prograde thermal shear current fig 2 a while the advective flux continues to transfer momentum downward 3 3 eddy kinetic energy budget though the interior eddy momentum budget clarifies how the structure of thermal shear current is determined it does not offer information on means by which eddies are generated in classic quasi geostrophic qg theory e g pedlosky 1987 eddies are generated via two mechanisms one is baroclinic instability in which potential energy feeds eddy growth the other is barotropic instability in which eddies extract kinetic energy from the mean flow a necessary condition for baroclinic barotropic instability of a qg flow is that the background potential vorticity pv gradient should change sign in the vertical cross stream direction the reader is referred to pedlosky 1987 and vallis 2006 for a review and isachsen 2011 for the interpretation of relevance of layer pv gradients to baroclinic instability the presence of a sloping ocean bed may therefore alter the stability of a flow by modulating the background pv for instance early studies blumsack and gierasch 1972 mechoso 1980 based on the eady 1949 model predict that the ratio between the topographic slope and isopycnal slope denoted by the slope parameter δ determines the baroclinic stability of the along slope flow our simulations correspond to the case δ 1 in which the ocean bed has the same inclination as yet is more steeply tilted than the isopycnals linear theory predicts that such flows should be stable but the cross slope eddy momentum flux discussed in the previous section indicates otherwise to identify the sources of eddies in our simulation we formulate the interior eke budget equation e g chang and orlanski 1993 chapman et al 2015 and stewart and thompson 2016 4 t u h 2 2 u u h 2 2 u ϕ u h u u h w b which states that in statistically steady state the divergence of eke fluxes per unit mass on the left hand side is approximately balanced by the production rates of eke per unit mass from the reservoirs of mke and pe on the right hand here u h u is the horizontal total velocity vector ϕ p ρ 0 denotes the hydrostatic pressure divided by the reference density and b ρ ρ 0 g ρ 0 represents the buoyancy the local derivative term is retained here again for clarity the eke fluxes consist of two terms u u h 2 2 corresponds to the eke flux driven by the total velocity field and u ϕ denotes the eke flux via eddy pressure work in fig 3 a we plot the logarithm of the mean eke per unit mass along with the net eke flux vectors denoted by arrows note that eke is intensified over the top few hundred meters yet almost depleted near the bottom slope around y 200 km the low eke distribution near the slope is consistent with prior numerical studies asserting that steep slopes suppress eddy activities blumsack and gierasch 1972 isachsen 2011 chen and kamenkovich 2013 hetland 2017 the surface intensification over the slope along with the vertical penetration of eke away in the open ocean suggest that these portions of the domain are dynamically decoupled from the region close to the sloping bottom broadly consistent with the findings of lacasce 1998 and lacasce and brink 2000 moreover eke flux in the upper few hundred meters is directed onshore from the deep ocean potentially serving as a non local driver of eddy mean flow interactions across the slope e g chen et al 2014 fig 3 b shows the mke eke conversion term u h u u h with positive negative contour levels denoting eke gain loss from into mke we can further expand this into four terms 5 u h u u h v u y u v v y v w u z u w v z v the first two terms quantify reynolds stress work associated with eddy momentum fluxes acting parallel to the mean shear characteristic of barotropic instabilities the latter two terms quantify reynolds stress work associated with vertical momentum fluxes and mean shear e g as activated in kelvin helmholtz instabilities brink 2016a brink and seo 2016 which are parameterized via the richardson number dependent mixing in the kpp scheme calculation of these terms reveals that the total conversion on the left hand side of 5 is dominated by the first term on the right hand side which is at least one order of magnitude larger than any of the remaining terms suggesting that barotropic energy conversions in our model are primarily due to lateral eddy momentum fluxes and horizontal shear of the mean current as surface generated eddies propagate offshore they convey retrograde momentum anomalies laterally fig 3 b leading to alternating regions of convergence and divergence of momentum effectively accelerating and decelerating different flanks of thermal shear zonal jets these strong local barotropic sinks and sources of eke largely compensate each other in a whole domain integral contour levels of zero mke eke conversion are plotted in fig 3 b gray bold lines to elucidate the spacing of the three zonal jets identified in this simulation though barotropic eke production locally dominates the right hand side of 4 fig 3 d shows that in a domain integrated sense baroclinic production serves as the primary eddy energy source however in contrast to simulations conducted using a flat bottomed ocean the energy production is largely confined to the top few hundred meters over the slope this agrees broadly with earlier studies on the suppressive influence of topography on baroclinic instabilities isachsen 2011 chen and kamenkovich 2013 hetland 2017 in addition both the rossby number of the mean flow quantified by surface relative vorticity normalized by the coriolis frequency and the bulk richardson number in the top 50 m of the water column approach o 1 over the slope not shown indicating that ageostrophic mixed layer instabilities may play a role in seeding eddies boccaletti et al 2007 fox kemper et al 2008 closer to the continental slope eke production weakens and becomes negative with eddies giving up their energy to increase pe such a conversion of eke into pe is unexpected because the tilted isopycnals see green dashed contours in fig 3 d indicate an abundance of available potential energy it then follows that eke close to the slope must be sourced non locally e g chen et al 2014 consistent with the surface confined shoreward eke flux fig 3 a as pe is the ultimate source of the eddy energy in fig 3 c we plot the mke to pe conversion rate per unit mass ψ mean b y stewart and thompson 2016 where ψ mean denotes the mean overturning streamfunction induced by ekman transport the pe production is largely the result of wind driven ekman pumping and suction which creates vertical mean flows that serve to tilt isopycnal surfaces similar to the baroclinic eke production the pe production is confined close to the surface over the continental slope regions of pe destruction are found close to the ocean bed over the slope indicating that vertical mean flows are acting to reduce isopycnal slopes and thereby remove the potential energy being created by eddies see fig 3 d 3 4 ageostrophic circulation the presence of prograde jets associated with the conversion of eke into pe attached to the sloping bottom suggests a locally distinct ageostrophic flow field compared to that in the deep ocean and the flat bottomed ocean c f appendix b we therefore now examine the isopycnal mean and eddy overturning streamfunctions defined as e g wolfe and cessi 2009 6a ψ iso y z ψ iso y θ h 0 v h θ θ d z 6b ψ mean y z ψ mean y θ 1 l x h 0 v h θ θ d z d x 6c ψ eddy ψ iso ψ mean respectively here denotes a 5 year long time mean operator at constant depths h is the heaviside step function and y θ refer to the potential temperature coordinates following the convention of wolfe 2014 the isopycnal and residual streamfunctions are defined in potential temperature coordinates but mapped back to geopotential coordinates for presentation purposes using the time zonal mean potential temperature field at each latitude we plot ψ mean y z and ψ eddy y z in fig 4 a and b respectively in the open ocean surface and bottom ekman transport imposes a clockwise cell in ψ mean occupying the full water depth whereas ψ eddy exhibits a counterclockwise circulation with similar strength as ψ mean approaching the sloping bottom both ψ mean and ψ eddy exhibit sharp transitions in particular ψ mean exhbits counterclockwise cells at the shelf break and near the junction to deep ocean whereas ψ eddy exhibits clockwise cells around the same locations the approximate compensation across the channel between ψ mean and ψ eddy resembling that in the antarctic circumpolar current marshall and radko 2003 is due to the absence of surface buoyancy forcing and is evident in the much weaker isopycnal overturning streamfunction shown in fig 4 c d a clockwise counterclockwise cell in ψ eddy near away from the slope suggests locally upgradient downgradient eddy buoyancy fluxes effectively isopycnal surfaces near the slope are tilted up by eddies that ultimately reverse the thermal shear current by enhancing the meridional buoyancy gradient while feeding the local pool of pe by consuming eke whereas eddies away from the slope act to flatten the sloping isopycnals converting pe into eke the latter process is triggered by baroclinic instabilities that penetrate throughout the water column in the deep ocean fig 3 d while the former can only be sustained by non local sources of eke fig 3 b d in parallel the counterclockwise rotation of ψ mean is supported dynamically by the divergence of eddy retrograde momentum fluxes in addition to bottom friction to see this we note that ψ eddy v θ θ z under the tem framework marshall and radko 2003 plumb and ferrari 2005 vallis 2006 and re cast 3 as 7 t u y v u z w u f 0 v because the time derivative term in 7 is negligible in statistically steady state the negative v associated with a counterclockwise ψ mean cell near the slope requires divergent eddy fluxes of retrograde momentum consistent with the momentum pathway shown in fig 2 a the residual overturning streamfunction ψ iso y θ and its projection in the cartesian space ψ iso y z exhibit much weaker strength compared to ψ mean and ψ eddy in particular the maximum value of ψ iso y z is approximately 15 of the total ekman transport in the absence of surface buoyancy forcing the isopycnal overturning circulation ψ iso y z is driven primarily by eddy stirring of buoyancy along the ocean surface and the bottom slope this mixing might be enhanced by the staircase representation of topography in mitgcm hill et al 2012 griffies et al 2000a b and partly motivates our reproduction of this simulation setup in roms and him 3 5 generation of slope trapped flows one physical interpretation of the existence of slope trapped flows accompanied by pe production from eke is that eddies over the slope transfer pv downgradient to destroy mean potential enstrophy and in doing so transfer their energy to the mean flow see bretherton and haidvogel 1976 salmon 1998 marshalll et al 2012 from the perspective of statistical mechanics maximizing the entropy of the physical system while conserving energy and potential enstrophy gives rise to prograde mean flows holloway 1978 1986 1992 1993 and is referred to as the neptune effect holloway 1996 this entropy maximization is equivalent to minimizing the potential enstrophy associated with the mean flow in the low energy limit venaille 2012 venaille et al 2012 here we provide a qualitative assessment on this conjecture by analyzing the meridional eddy pv flux the pv the eddy component of its meridional flux and the pv diffusivity are calculated via 8a q f 0 z u θ 8b f q 1 l x θ d x u q s 8c κ θ 1 l x θ d x u q s q y θ where z is the vertical unit vector and s θ θ x is a unit vector parallel to time mean potential temperature surfaces x is the zonal unit vector the subscript θ denotes quantities evaluated at constant time mean potential temperature θ 1 2 o c which spans the meridional width of the channel without outcropping or incropping calculations based on nearby surfaces such as θ 1 0 o c do not yield qualitatively different results note that 8a and 8b is an approximation to the eddy potential vorticity flux defined relative to the thickness weighted average velocity and pv fields e g abernathey et al 2013 these formulations of the eddy pv flux are formally identical in the limit of small isopycnal height fluctuations the mean pv and the zonal mean eddy pv flux are plotted with red curves in fig 5 a and b respectively background pv gradient is oriented onshore throughout the channel i e q y θ 0 due to the dominant role of planetary vortex stretching in contrast eddy pv flux appears to be upgradient i e onshore in the deep ocean yet downgradient i e offshore over the slope the global maximum lies near the shelf break coinciding with prograde flow along the ocean bed and production of pe at the expense of eke fig 5 c shows the eddy diffusivity κθ which is positive downgradient and o 100 1000 m2 s across the slope but then turns sharply negative upgradient in the deep ocean with magnitudes typically far exceeding 1000 m2 s we now employ an approximate qg formulation to relate this pattern of pv mixing to the momentum and energy budgets formally the o 1 change in ocean depth and isopycnal layer thicknesses put our simulations beyond the validity of the qg approximation but qg carries the advantage of relative simplicity and thus ease of interpretation and often facilitates understanding of eddy mixing processes in non qg systems e g abernathey et al 2013 we rewrite 3 as 9 t u v q q g f 0 v where 10 v q q g y v u z w u f 0 z v θ θ z y θ v u f 0 z ψ eddy here we have retained the qg assumption of small isopycnal layer thickness variations and fluctuations but relaxed the qg assumption of small isopycnal slope our formulation therefore differs from the usual qg pv flux e g vallis 2006 via the inclusion of the vertical momentum flux divergence z w u this term is non negligible because lateral momentum transfer is largely aligned with isopycnals which are steeply tilted over the continental slope further note that the reynolds stress term y u v is often neglected altogether based on small rossby number arguments e g abernathey et al 2013 but is retained here because it plays a leading role in the momentum budget eq 9 implies that in statistically steady state an offshore eddy pv flux must be balanced by a shoreward isopycnal transport v 0 fig 4 shows that this transport occurs via a pair of weak positive and negative overturning cells over the slope closed diabatically at the ocean surface over the sloping ocean bed and in the northern sponge layer in the upper part of the water column at the shelf break y 160 km z 250 m the eddy streamfunction increases with depth fig 4 b corresponding to an upgradient eddy thickness flux and an upgradient contribution to the pv flux 10 however this upgradient contribution is opposed by a stronger downgradient contribution due to reynolds stress divergence associated with the strong offshore flux of retrograde momentum fig 2 b deeper in the water column at the same latitude y 160 km z 800 m the reynolds stress divergence weakens but eddy streamfunction gradient changes sign resulting in downgradient fluxes of both thickness and pv here the isopycnals are strongly tilted so this downgradient thickness flux actually corresponds to a buoyancy flux directed downward and offshore laterally upgradient and so produces pe at the expense of eke the near slope consumption of eke and destruction of mean potential enstrophy via the downgradient eddy pv flux are qualitatively consistent with the neptune effect holloway 1992 however these features do not appear consistently across the continental slope but are rather confined to two prograde jets visible in fig 2 a this is in agreement with previous studies of statistical mechanics of turbulence over topographic slopes vallis and maltrud 1993 venaille 2012 in practice cross slope eddy pv mixing is approximately confined by the topographic rhines scale and the realized equilibrium state does not reach the theoretical maximum entropy state of the system in which prograde flows occupy the entire slope 4 model inter comparison our pv mixing analysis indicates a distinct flow regime near the slope however it remains unclear whether these near slope flows are being correctly simulated particularly given the staircase representation of topography in mitgcm and the appearance of a non negligible isopycnal overturning circulation despite the absence of surface buoyancy forcing fig 4 d as outlined in section 2 this motivated us to recreate the simulation setup as closely as possible using roms and him spanning the range of widely used model vertical coordinate systems in general all three models produce qualitatively similar results to those described in section 3 in this section we therefore primarily focus on quantitative differences between the models in table 2 we quantify various properties of the statistically steady state over shelf slope topography in all three models to ensure an accurate comparison daily snapshots of velocity and potential temperature from him were interpolated to geopotential coordinates before calculating all results discussed below 4 1 total momentum budget in statistically steady state each model exhibits an upwelling front with a mean retrograde thermal shear current over most of the domain similar to fig 1 here we choose to focus on three aspects of the mean current namely the strength of thermal shear exhibited by the magnitudes of surface bottom velocity profiles the cross slope offset of surface current maximum from the wind stress maximum location and the manifestation of the prograde jets attached to the slope the mean surface u surf and bottom u bot zonal velocity profiles are plotted in fig 6 a both roms and him exhibit qualitatively similar thermal shear currents to mitgcm in particular their surface retrograde flow maxima are shifted offshore from the slope there are cross slope oscillations of u surf associated with multiple retrograde zonal jets and prograde jets form at the ocean bed over the slope these findings suggest that the asymmetric mean current structure and the topographically controlled flow field in the mitgcm run are not qualitatively model dependent despite the nearly identical configurations of the three models surprisingly large quantitative differences arise between them the deviation of the surface current core is 7 km larger in roms and 20 km smaller in him than that in mitgcm see table 2 and the circled dot markers in fig 6 whereas the mitgcm and roms simulations exhibit three distinct surface retrograde jet cores the him simulation only exhibits two 1 1 the jets exhibit pronounced variability especially those at the surface over the slope not shown however over the five year average used in this study the jets are robust features computing the mean velocities from different 5 year periods in the same simulation yields much smaller changes in the jet structure than the magnitudes of the inter model differences in the jets in addition the surface retrograde flow in roms has a smaller global maximum but extends further offshore implying that on average retrograde momentum in roms is exported further from the location of wind stress maximum by eddies than it is in mitgcm on the other hand him generates the strongest surface current over three models and this flow is confined closer to the continental slope where isopycnals tend to be more steeply tilted and thus the baroclinicity is larger him therefore exhibits a slightly stronger baroclinic along slope transport but a much weaker barotropic along slope transport than those found in the mitgcm and roms simulations table 2 although some effects of different vertical coordinate systems on representing the mean current can be understood by analyzing fig 6 a the momentum balance provides greater insight we formulate the vertically integrated mean momentum budget as 11 t u y v u f 0 v τ x ρ 0 c d u bot 2 v bot 2 1 2 u bot where u v and v u are the vertical integrals of u v and v u respectively notice that 11 is just the vertical integral of 7 plus the source sink terms due to surface bottom stresses and differs from the vector invariant form of the momentum equation that is used to integrate the models eq 11 states that the rate of change in the mean zonal momentum is determined by four factors in order namely the lateral divergence of retrograde momentum flux the coriolis force induced by mean meridional flow 2 2 physically the depth integrated coriolis term necessarily vanishes because the flow is incompressible and f 0 is a constant however this term makes a non zero contribution to the model momentum budgets due to the ways the coriolis forcing are discretized in the three models the wind stress and the bottom drag we plot these terms as functions of latitude in fig 6 b d for mitgcm roms and him in general the models exhibit qualitative consistency in their momentum budgets in particular momentum imparted by surface wind stress over the slope is balanced by horizontal momentum flux divergence a corresponding offshore momentum flux convergence leads the offshore deviation of thermal shear current fig 6 a over the slope the bottom drag actually serves as a source of retrograde momentum and thereby removes momentum from the prograde jets attached to the slope in the deep ocean surface momentum input by wind is everywhere small compared to its extraction by bottom drag it is instructive to examine how this momentum balance changes in the absence of the continental slope fig 7 a shows identical diagnostics as in fig 6 b d but calculated from flat bottomed simulations of each of the three models for clarity the shelf slope and deep ocean regions in the slope runs are now referred to as south core and north regions respectively in this case the models are both qualitatively and quantitatively similar momentum injected by wind is largely transfered directly downward and removed by bottom drag with a modest convergence of momentum in the core region by eddies this is consistent with previous studies of wind driven channel flows on a β plane e g marshall and radko 2003 abernathey et al 2013 but qualitatively different from the shelf slope in which eddies transfer all of the wind input momentum offshore the close quantitative agreement between the models in the flat bottomed case suggests that the more substantial quantitative differences in the shelf slope case stem from their differing representations of flow over topography in the shelf slope simulations we identify four major quantitative inter model discrepancies first in contrast with mitgcm the roms and him momentum budgets show higher drag at the top of the slope than at the bottom accompanying stronger prograde slope trapped jets at the top of the slope second the latitudinal spikes over the slope in the mitgcm momentum budget terms fig 6 b are similar to those found by ezer 2016 in a depth integrated vorticity budget analysis and are due to the staircase representation of topography third in the deep ocean momentum flux convergence is strongest in roms and weakest in him yet the maximum along slope velocity is largest in him and weakest in roms this counter intuitive result occurs because stronger momentum fluxes also push the momentum further from the topographic slope where baroclinicity is weaker thus roms also has the strongest barotropic component in its along slope transport and him the weakest see table 2 fourth while both mitgcm and roms show negligible residual terms in their momentum budgets him s residual is comparable to the magnitude of the wind stress this is true even when computed using online averages of terms in the momentum equation see appendix a and when the large spurious coriolis force term is accounted for the flat bottomed him simulation does not produce a comparable residual in the momentum budget fig 7 a suggesting that outcropping of isopycnals surfaces in the presence of a steep slope introduces substantial errors in him s momentum balance 4 2 energy budget fig 8 a shows the structures and magnitudes of depth integrated eke over the full water columns and upper 300 m there is qualitative consistency in the eke profiles between models in that they are approximately symmetric around the eke maxima which are displaced offshore of the continental slope in addition 40 50 of the eke in the slope region is concentrated within the top 300 m of the water column quantitatively mitgcm and roms produce indistinguishable eke profiles and have more than twice as much domain integrated eke as him table 2 in fig 8 b d we present the conversions of pe and mke into eke integrated over the total depths and top 300 m for each of the three models over the slope baroclinic instabilities are surface intensified with approximately 60 of total production of eke from pe confined within the uppermost 300 m table 2 which may partly hinge on surface mixed layer instabilities boccaletti et al 2007 fox kemper et al 2008 in the deep ocean the near surface eke production is similar to that over the slope but sub surface baroclinic instabilities are no longer suppressed by topography so eke production substantially increases the negative baroclinic eke production at the shelf break y 170 km is due to sub surface eke consumption and pe production which is largest in roms and smallest in him in order table 2 reynolds stress work mke eke is largely confined to the uppermost 300 m of the water column and oscillates with latitude in all three models highlighting the presence of multiple retrograde jets the mixed barotropic baroclinic instabilities associated with these jets seem contradictory with the findings by killworth 1980 who asserts that a jet flow is dominated by baroclinic barotropic instabilities if its spatial scale is much larger smaller than the local deformation radius yet barotropic energy conversion in our simulations is essentially a response of baroclinic eddies to the steep slope that suppresses the vertical transfer of momentum consequently though the total eke production consumption at each latitude is locally dominated by reynolds stress work the domain integrated effect of this term is small in all three models fig 7 b shows that when the continental slope is removed baroclinic instabilities become the only eke source throughout the channel see also appendix b note that the maximal baroclinic conversion rates in the flat bottom cases fig 7 b are one order of magnitude smaller than those in the shelf slope cases fig 8 b d in addition the top 300 m now capture only about 10 of the total baroclinic eke production in the core region suggesting that the continental slope confines baroclinic instabilities to near surface waters reynols stress work is a weak eke sink in the vicinity of wind stress maximum c f appendix b due to the eddy momentum flux convergence into the core region a closer inspection of fig 8 b d reveals that the models differ in a number of ways first mitgcm possesses the largest fluctuations in both barotropic and baroclinic energy conversion rates as functions of latitude for instance the highest total eke production rate yellow curves in fig 8 b d is approximately 2 5 10 5 m2 s 3 in mitgcm and approximately 1 5 10 5 m2 s 3 in both roms and him consequently mitgcm supports the largest net eke gain followed by roms and then him table 2 given the almost identical profiles in fig 8 a the higher eke generation in mitgcm compared to roms indicates greater energy dissipation as well second the baroclinic eke consumption close to the slope is more pronounced in roms than in mitgcm and him the rate of production of pe from eke in roms is more than three times higher than that in either mitgcm or him within the slope region table 2 this is likely associated with roms terrain following coordinate system which avoids the spurious mixing and dissipation over staircase topography present in geopotential coordinate models like mitgcm griffies et al 2000a meanwhile him simulates lower eke and weaker eke production than the other models fig 8 a so less eke is available for conversion to pe close to the sloping topography third some spikes can be seen in the profiles shown in fig 8 b again a consequence of the staircase representation of topography in mitgcm fourth the reynolds stress work profiles derived from mitgcm and roms indicate three retrograde jet cores whereas only two are evident in the him simulation various factors could contribute to a change in the number of jets e g vallis and maltrud 1993 thompson and young 2007 so a suite of simulations conducted using each of these three models would likely be required to fully explain this inter model discrepancy 4 3 pv mixing and ageostrophic circulation in section 3 we showed that eddies flux pv downgradient over the continental slope coinciding with downgradient thickness fluxes but upgradient lateral buoyancy fluxes close to the ocean bed this suggests that the slope trapped prograde flows might be understood via statistical mechanical arguments specifically entropy maximization or mean enstrophy minimization often referred to as the neptune effect holloway 1992 venaille et al 2012 we now explore whether roms and him reproduce this dynamical regime over the slope the blue green curves in fig 5 show the profiles of background pv q θ offshore eddy pv fluxes fq and pv diffusivity κθ as functions of latitude from roms him on selected isopycnal surfaces in general background pv is dominated by planetary vortex stretching and thus decreases with latitude over the slope and deep ocean regions in the deep ocean the mean pv differs by a factor of 1 5 between the models but the mean pv gradients are consistently small over the slope however the pv gradients exhibit substantial inter model differences varying by an order of magnitude between models close to the shelf break y 170 km this indicates that the models stratifications at the shelf break are sensitive to the quantitative differences in eddy behavior e g as diagnosed from the momentum and energy budgets in part because the continental shelf stratification is least constrained by the northern sponge layer fig 5 b shows that eddies consistently drive downgradient and upgradient pv fluxes over the slope and in the deep ocean respectively near the shelf break local maxima of eddy pv flux are visible in all models coinciding with locations where eke is converted into pe fig 8 b d the stronger deep ocean upgradient eddy pv fluxes in mitgcm and roms are consistent with the stronger eddy momentum flux convergence in these models fig 6 b d despite these discrepancies a dynamical transition between slope and deep ocean is evident in all of the models fig 9 shows the mean eddy and isopycnal overturning streamfunctions diagnosed from the roms and him shelf slope simulations superscripts r and h respectively correspond to roms and him these circulations are qualitatively similar to that of the mitgcm simulation with strong compensating mean and eddy overturning streamfunctions displaced offshore and circulations of opposite sign trapped close to the ocean bed over the slope close to the ocean bed the downgradient pv flux in all models fig 5 c is supported by a downgradient thickness flux and upgradient buoyancy flux fig 9 c and d thus the slope trapped dynamical regime is a model independent feature though it exhibits substantial quantitative inter model variations for example while roms exhibits two slope trapped mean eddy overturning circulations as in mitgcm only one slope trapped overturning cell is visible in him e g compare fig 9 panels a and b paralleling the reduced number of retrograde jet cores at the surface additionally based on 7 the stronger weaker mean overturning circulation at the shelf break in roms him implies locally larger smaller divergence in eddy fluxes of retrograde momentum consistent with the eddy momentum budget in fig 6 the stronger negative mean slope trapped overturning circulation in roms is accompanied by a stronger positive eddy circulation and thus greater conversion of eke to pe close to the ocean bed consistent with fig 8 and table 2 this highlights a key difference between the mitgcm and roms simulations which have very similar momentum and energy budgets figs 6 8 in roms eke generated close to the surface over the slope is much more efficiently converted to pe at the ocean bed table 2 yielding substantially stronger slope trapped prograde flows fig 6 a and consequently demanding greater export of retrograde momentum to the deep ocean 4 4 linear stability analysis despite the various quantitative inter model discrepancies all of the model simulations show the same qualitative features namely lateral eddy export of momentum surface trapped baroclinic instabilities and the slope trapped upgradient buoyancy fluxes we now ask to what extent can these features and their inter model variations be captured by linear stability analysis which has been widely used to understand topography flow interactions and been shown to have skill in predicting nonlinear eddy behaviors in prograde shelf break currents e g spall 2004 isachsen 2011 pennel et al 2012 poulin et al 2014 to answer this we perform calculations over the continental slope using the linearized quasigeostrophic qg equations e g smith 2007 and isachsen 2011 12 q t j ψ q j ψ q 0 h z 0 b t j ψ b j ψ b 0 z 0 b t j ψ b j ψ b j ψ s b z 0 z h where q 2 ψ γ ψ is the qg potential vorticity pv perturbation γ z f 0 2 n 2 z is conventionally defined as the vortex stretching operator smith 2007 tulloch et al 2011 ψ denotes the qg eddy streamfunction b f 0 ψ z corresponds to buoyancy perturbation and s is the sea floor height the mean geostrophic streamfunction background qg pv and mean buoyancy are denoted as ψ q and b respectively below we solve 12 for the unknown perturbations ψ and q deriving ψ q and b from the mean states of our nonlinear simulations substituting the wave solution of the form 13 ψ φ z e i k x l y ω t into 12 yields 14 ω γ k 2 l 2 φ k q y k u γ k 2 l 2 φ h z 0 ω k u φ z k u z φ 0 z 0 ω k u φ z k u z n 2 f 0 s y φ 0 z h where the ageostrophic meridional velocity has been excluded e g pedlosky 1987 and vallis 2006 here qy is the background qg pv gradient and sy is the horizontal gradient of the sea floor height with respect to latitude eq 14 comprises an eigenvalue problem in terms of the complex frequency ω with eigenfunctions that correspond to the vertical structure φ we solve this eigenvalue problem numerically via vertical discretization of φ as described by smith 2007 following tulloch et al 2011 any unstable modal solution of 14 with wavenumber larger than five times of the inverse deformation radius is abandoned as our model runs barely resolve them in the presence of steep slopes several caveats should be stressed prior to discussing the linear solutions first 12 holds only if the horizontal variations of mean stratification bz are negligible e g pedlosky 1987 and vallis 2006 a condition that is violated by our primitive equation simulations nevertheless such a procedure proved successful in qualitatively understanding eddy field over continental slopes around the lofoten basin across which stratification changes sharply isachsen 2015 second previous qg analysis reveals that ignoring the horizontal shear of velocity may lead to qualitative errors in linear solutions killworth 1980 over steep slopes mean relative vorticity may even dominate the background qg pv and hence impact the growth rates and length scales of baroclinic unstable waves isachsen 2015 we therefore have retained the relative vorticity component when defining q 3 3 inclusion of mean relative vorticity also makes linear calculations two dimensional by encompassing barotropic modes which we have chosen to leave out by imposing 13 because it is the baroclinic instability that serves to generate eddies in our simulations finally analogous to isachsen 2011 2015 the slope here only enters the qg equations via bottom pv sheets in the bottom boundary condition of 12 in contrast our simulations exhibit isopycnal outcropping along the slope an effect that cannot be captured in a qg model fig 10 a shows the normalized vertical structure φ of the fastest growing modes at y 200 km latitude where the bottom slope is steepest the fastest growing modes are all purely meridional noodle modes i e having meridional wave number l 0 chen and kamenkovich 2013 in both the shelf slope and flat bottom simulations using the mean state from the shelf slope runs all models produce unstable linear modes that are strongly surface intensified in qualitative agreement with the surface confined baroclinic energy production shown in fig 3 in contrast in the flat bottom cases the unstable modal structures are of comparable magnitude throughout the water column consistent with the baroclinic energy production at depth in fig 7 b see also appendix b thus while there are quantitative inter model discrepancies in the vertical structures of the solutions both in the shelf slope and flat bottom simulations it seems that the surface intensification of baroclinic energy is explained by linear theory and specifically by suppression of baroclinic instability by the topographic pv gradient in our nonlinear simulations the lower part of the water column over the slope exhibits laterally upgradient buoyancy fluxes and eke consumption fig 10 b d compares the buoyancy fluxes predicted by linear theory against those diagnosed from our nonlinear simulations in the linear qg theory the lateral time zonal mean buoyancy flux can be written as 15 f b 1 2 k c f 0 φ r φ i z φ i φ r z e 2 ω i t where kc is the wavenumber of most unstable wave φr φi denotes the real imaginary part of its structural coefficient φ z and ωi is the growth rate as the wave growth is positive definite we focus on the time independent factor of fb only we focus on linear solutions and nonlinear fluxes derived from latitudes between y 150 km and y 200 km where upgradient buoyancy fluxes appear consistently in the nonlinear model simulations the nonlinear solutions consistently produce relatively large downgradient shoreward buoyancy fluxes in the upper few hundred meters of the water column overlying upgradient offshore buoyancy fluxes in the deeper portions of the water column while the linear solutions also predict strong downgradient buoyancy fluxes close to the surface in the subsurface these fluxes remain downgradient and gradually decrease in magnitude with depth while the linear buoyancy fluxes are very slightly upgradient in a few locations overall the linear prediction is qualitatively different from the nonlinear realizations this disagreement reinforces our conclusion that the upgradient buoyancy fluxes and the associated consumption of eke close to the slope are sustained via non local sources of eke linear stability analysis is built on local mean flow field alone and appears to be incapable of reproducing this phenomenon additionally the linear solutions predict a lateral eddy momentum flux f m 1 2 ϕ 2 z k c l c warneford and dellar 2017 that is identically zero for any noodle mode i e l c 0 where lc denotes the meridional wave number of the most unstable modal solution the linear predictions therefore also fail to capture the strong offshore flux of retrograde momentum and associated reynods stress convergence of energy 5 summary and conclusion eddies over continental slopes play a key role in shaping water mass formations and the ocean general circulation spall 2004 brink 2016b stewart and thompson 2015a nonlinear eddy behaviors resulting from instabilities of prograde baroclinic currents have been shown to be well explained by the linear phase of baroclinic growth in contrast to retrograde baroclinic currents spall 2004 isachsen 2011 pennel et al 2012 in this article we have studied baroclinic turbulence over an idealized continental slope under retrograde winds using three numerical ocean models that span the range of commonly used vertical coordinate systems results that are consistently reproduced between these models are inferred to be insensitive to the discrete representation of flow over topography and therefore most physically robust quantitative discrepancies among models are related to multiple differences in the numerical algorithms listed in section 2 the sources of numerical error e g in the momentum budgets are also model dependent we therefore refrain from offering comment on which model performs best in this application our reference simulations share several key features that distinguish shelf slope baroclinic turbulence from the case of a flat ocean bed momentum imparted by surface wind stress is exported laterally by eddies in the top few hundred meters shifting the thermal shear current offshore this offshore retrograde momentum flux combined with the formation of multiple retrograde jet cores separated approximately by the topographic rhines scale rhines 1975 vallis and maltrud 1993 leads to a series of barotropic energy conversions of alternating signs this eddy momentum transfer is intrinsically nonlinear in nature and cannot be reproduced using qg linear stability theory in the open ocean eddy momentum flux is dominantly downward and balanced by bottom drag when the continental slope is replaced by a flat ocean bed momentum is instead transfered directly downward and locally extracted via bottom drag in our model runs the eddies are principally generated by baroclinic instabilities confined within the uppermost few hundred meters of the water column consistent with the local linear stability analysis and prior studies based on analytical qg models e g chen and kamenkovich 2013 away from the slope baroclinic instabilities penetrate to depth as topographic suppression is mitigated this eke generation serves as a non local driver of pe production close to the sloping ocean bed acting to tilt isopycnals and accelerate prograde near bottom flows this consumption of eke is associated with downgradient eddy pv and thickness fluxes but upgradient lateral buoyancy fluxes the near slope dynamics are therefore qualitatively consistent with the neptune effect holloway 1992 in which eddies drive prograde flows as the system tends toward a state of maximum entropy or minimum mean potential enstrophy venaille et al 2012 additional spin down simulations will be required to further validate this effect the non local energetics associated with this dynamical regime place it beyond the scope of linear theory the angle of bottom topography in our reference simulation is approximately 2 o and thus falls within the average range of steepness of realistic continental slopes e g cacchione et al 2002 we have also performed a series of sensitivity runs based on mitgcm 4 4 since almost no difference is yielded by replacing the kpp in the reference run with a large diffusivity 100 m2 s for parameterizing convective instabilities in mitgcm all sensitivity runs follow this setting for computational efficiency to further verify the applicability of our results by varying key physical parameters namely the slope width to 50 km or 200 km the wind stress maximum to 0 025 n m 2 or 0 1 n m 2 and the thermal expansion coefficient to 5 10 5 o c 1 or 2 10 4 o c 1 all sensitivity runs reproduce the key turbulent properties discussed in section 3 momentum injected by wind is exported laterally by eddies over the top few hundred meters c f sections 3 2 and 4 1 baroclinic instabilities are trapped within the top few hundred meters c f sections 3 3 and 4 2 the conversion of eke into pe dominates the slope trapped flows corresponding to upgradient eddy buoyancy fluxes c f sections 3 3 4 2 and 4 4 here we briefly explore the robustness of the sloping bottom trapped flows under alternative physical conditions fig 11 a shows the bottom along slope velocity profiles as functions of offshore distance after time zonal mean all sensitivity simulations produce prograde flows though with deviating magnitudes and locations the weakest prograde jet is supported by the least stratified flow with halved thermal expansion coefficient contrasted to the reference run accordingly fig 11 b which shows the time zonal averages of conversion rate of pe into eke integrated over the bottom 300 m as functions of latitude suggests that all prograde flows are accompanied by generation of pe from eke though this association is less obvious for weakly stratified flows we also note that previous model studies e g of the california current system fig 4 of colas et al 2013 and the antarctic slope front fig 7 a of stewart and thompson 2016 exhibit eke consumption close to the continental slope lending additional support to our conclusions and their applicability to the ocean figs 12 16 though our findings are qualitatively consistent across different models and sensitivity simulations in parameter ranges relevant to the oceans our study carries a number of caveats associated with our idealized model configuration for instance the simulations do not include zonal variations in bottom topography which can alter the zonal momentum budget 11 via bottom form drag e g molemaker et al 2015 additionally curvature in the continental slope modifies the growth of baroclinic instabilities solodoch et al 2016 and favors breaking of topographic rossby waves stewart et al 2014 2011 buoyancy forcing can also effectively shape the flow field over continental slopes and modulate the pv field we have neglected tides which often play a non negligible role in forming shelf break fronts e g brink 2012 2013 finally we have not incorporated temporal variations in surface wind stress which can impact eddy variabilities over continental slopes zhai and greatbatch 2007 renault et al 2016 further work is required to develop a predictive theory relating the bottom slope and forcing to the resulting mean flow and cross slope eddy transfer expanding our sensitivity simulations and developing such a theory is the subject of ongoing work however our findings do suggest that any parameterization for eddy transfer across continental slopes must include an explicit treatment of the eddy momentum fluxes which make a leading order contribution to the mean circulation in our model runs the downgradient mixing of pv over the slope suggests that a pv based rather than buoyancy based approach to parameterizing eddies over steep slopes may be necessary acknowledgments the authors are thankful to kaushik srinivasan for his help with roms this work used the extreme science and engineering discovery environment xsede towns et al 2014 which is supported by national science foundation grant number aci 1548562 yw and als are supported by national science foundation grant number oce 1538702 the authors thank g e manucharyan and an anonymous reviewer for comments that improved this article appendix a depth integrated momentum budget for him here we briefly describe the calculation of depth integrated momentum budget for him a total of four individual terms are shown in fig 6 d the wind stress input term is simply 2 divided by ρ 0 and consistent across models the depth averaged advection and coriolis acceleration terms located at velocity points of numerical grid boxes in conjunction with the layer thicknesses located at mass points of numerical grid boxes are readily output from the him code the only modification needed for obtaining the depth integrated terms is to linearly interpolate the water column height from mass onto velocity points for computational accuracy the calculation of bottom drag follows exactly the algorithm provided by him code which is based on a quadratic drag law and computes the friction velocity assigned to the bottom 10 m a default value in him from the solutions of velocity field and layer thicknesses appendix b diagnostics from mitgcm flat bottomed run here we reproduce the same plots as in section 3 for the flat bottomed run of mitgcm as a reference for better illustration the value ranges of some diagnostics are modified compared to those in section 3 and noted in the figure captions 
24136,constant depth or z coordinate ocean models such as mom4 and nemo have become the de facto workhorse in climate applications having attained a mature stage in their development and are well understood a generic shortcoming of this model type however is a tendency for the advection scheme to produce unphysical numerical diapycnal mixing which in some cases may exceed the explicitly parameterised mixing based on observed physical processes and this is likely to have effects on the long timescale evolution of the simulated climate system despite this few quantitative estimates have been made of the typical magnitude of the effective diapycnal diffusivity due to numerical mixing in these models go5 0 is a recent ocean model configuration developed jointly by the uk met office and the national oceanography centre it forms the ocean component of the gc2 climate model and is closely related to the ocean component of the ukesm1 earth system model the uk s contribution to the cmip6 model intercomparison go5 0 uses version 3 4 of the nemo model on the orca025 global tripolar grid an approach to quantifying the numerical diapycnal mixing in this model based on the isopycnal watermass analysis of lee et al 2002 is described and the estimates thereby obtained of the effective diapycnal diffusivity in go5 0 are compared with the values of the explicit diffusivity used by the model it is shown that the effective mixing in this model configuration is up to an order of magnitude higher than the explicit mixing in much of the ocean interior implying that mixing in the model below the mixed layer is largely dominated by numerical mixing this is likely to have adverse consequences for the representation of heat uptake in climate models intended for decadal climate projections and in particular is highly relevant to the interpretation of the cmip6 class of climate models many of which use constant depth ocean models at ¼ resolution keywords global ocean ocean model numerical mixing watermass transformation 1 introduction the importance of using a correct distribution of the diapycnal mixing and hence of the watermass transformation rate to the large scale ocean circulation in climate models is evident the upwelling regions of the global overturning streamfunction are associated with mixing processes munk and wunsch 1998 while the formation of a realistic thermocline relies on appropriate rates of mixing above and below the thermocline luyten et al 1983 in addition the uptake of co2 and heat both in the quasi equilibrium state of control simulations and in simulations of anthropogenic warming will be sensitive to the ocean stratification while embedded biogeochemical systems will also have rather different mean states if the vertical mixing and hence the stratification are inconsistent with those in the real ocean small scale turbulent mixing in ocean models is represented by a variety of parameterisations including bulk schemes e g kraus and turner 1967 the kpp scheme large et al 1994 and the turbulent kinetic energy tke scheme gaspar et al 1990 in these schemes parameters are normally optimised in a more or less heuristic way to approximately reproduce the observed water mass structure so called depth coordinate ocean models which represent the ocean as a stack of levels with constant vertical thickness constitute the majority of ocean models used today leading examples are nemo madec 2016 and version 4 of the gfdl modular ocean model mom4 griffies et al 2008 we note that of the thirty nine climate models contributing to the intergovernmental panel on climate change ipcc fifth assessment report ipcc 2013 thirty two used ocean components formulated with depth coordinates three used terrain following sigma coordinates and four used an isopycnic density coordinate ocean model numerical diapycnal mixing is an intrinsic property of the advection scheme in this class of models and occurs whenever an advective flux crosses density surfaces which in general do not follow the horizontal coordinate surfaces griffies et al 2000 it may be reduced by the use of higher order advection schemes hofmann and morales maqueda 2006 and is absent by construction in the ocean interior in pure isopycnic models like micom bleck and smith 1990 and gold hallberg and adcroft 2009 where advection is along surfaces of constant potential density and diapycnal mixing occurs only as prescribed by the model mixing scheme there are indications that in some regimes the numerical mixing may be of comparable magnitude as and even exceed the mixing generated by the explicit mixing scheme of the model griffies et al 2000 lee et al 2002 this leads over time to the unrealistic modification of critical watermasses which is likely to have undesirable effects on timescales of a decade or longer and this may be critical in climate simulations megann et al 2010 carried out a comparison between the coupled climate models hadcm3 and chime which differ only in that in the latter the depth coordinate ocean component of hadcm3 is replaced with the hybrid isopycnic coordinate hycom bleck 2002 the model with an isopycnic ocean showed markedly superior representation of watermasses such as antarctic intermediate water aaiw and subantarctic mode water samw as well as of the subtropical thermoclines and the sill overflow waters in the north atlantic all consistent with substantially lower numerical mixing a similar conclusion was reached in a similar experiment with two coupled models at gfdl differing only in the replacement in one of the mom4 ocean model by the gold isopycnic coordinate model dunne et al 2012 several approaches to diagnosing the numerical mixing in ocean models have been developed in recent years firstly there are what we might call direct methods which evaluate the mixing generated by the advection scheme at each grid cell these include the use of passive tracers getzlaff et al 2012 and analysis of tracer variance decay burchard and rennau 2008 these may be distinguished from more indirect methods which diagnose the effects of mixing over global or basin scale spatial domains and over time scales long compared with the model time step these include the evaluation of changes in global available potential energy ilıcak et al 2012 and the estimation of diapycnal mixing by evaluating fluxes across density surfaces lee et al 2002 the representation of the overturning circulation in density space walin 1982 is potentially highly revealing of the mechanisms of watermass transformation marsh et al 2000 used an isopycnic density coordinate model to show that changes in density arising from surface buoyancy fluxes which in a lagrangian sense generally act to increase the density of water as it is advected poleward are balanced by changes in density resulting from diffusive mixing in the ocean interior marsh 2000 and subsequently grist et al 2009 showed that surface fluxes when cast into density classes provide an informative proxy for the overturning circulation where the latter is not trivial to estimate directly from the relatively sparse direct observations of the ocean interior lee et al 2002 used this framework to diagnose the interior diapycnal mixing in the occam ¼ global ocean model and then by relating this to the mean vertical density gradient to estimate the effective vertical diffusivity as a function of density and latitude they concluded that in the southern ocean the effects of numerical mixing led to values of the effective diffusivity that were large compared with those applied by the parameterised vertical mixing scheme in the model in this paper we use the technique of lee et al 2002 to analyse the contributions to watermass transformation in the go5 0 ocean model the configuration of the nemo code used in the gc2 coupled climate model williams et al 2015 and closely related to the ocean configuration of the uk earth system model ukesm1 that will be used in the cmip6 intercomparison this model will be shown to have a rather lower drift than occam as used by the former authors we shall use a modified version of the method used by lee et al to derive an estimate of the numerical diffusivity that is compared with the explicit mixing coefficients used in the model where these latter authors examined the numerical mixing in the southern hemisphere with a primary focus on the southern ocean we evaluate the diapycnal transformation rates and effective diffusivities globally as well as separately in the atlantic and indo pacific oceans in section 2 we describe the go5 0 model configuration in section 3 we summarise the methodology of lee et al 2002 and describe the numerical method used in the current paper in section 4 we present the results of this method applied to the model output deriving the diapycnal velocities and effective diffusivities and comparing these with the explicit diffusivities applied by the model s mixing scheme in section 5 we relate the diapycnal mixing to small scale vertical motions and finally section 6 is a summary and discussion 2 model description the model configuration we describe here is go5 0 megann et al 2014 a standard ocean configuration developed jointly between the uk met office and the national environment research council nerc it is used widely in forecasting and climate modelling the current version of the uk met office s foam operational ocean forecasting system blockley et al 2014 and the uk coupled climate model gc2 williams et al 2015 use go5 0 as their ocean component the gc3 climate model williams et al 2017 and the new uk earth system model ukesm1 both aimed at the ipcc sixth assessment report will both use an ocean component closely related to go5 0 in particular sharing its horizontal and vertical grids albeit with a southward extension in the more recent configurations to allow ice shelves to be simulated and most of its physics choices go5 0 is an implementation of version 3 4 of nemo nucleus for european models of the ocean madec 2016 on the global orca025 0 25 tripolar horizontal grid barnier et al 2006 and has 75 constant depth levels in the vertical with level spacing increasing from 1 m at the surface to around 200 m at 6000 m depth the parameters and physics choices are discussed in detail in megann et al 2014 the sea ice is version 4 1 of the los alamos national laboratory sea ice model cice hunke and lipscomb 2010 the integration described here is of the ocean only go5 0 model forced by core2 atmospheric fields large and yeager 2009 and is made over the 30 years from 1976 to 2005 monthly precipitation and daily downward shortwave and longwave radiation are used to force the model directly while six hourly 10 m wind 2 m air humidity and 2 m air temperature are used to compute turbulent air sea and air sea ice fluxes during model integration using the bulk formulae proposed by large and yeager 2009 this configuration has much higher horizontal and vertical resolutions than the ocean of hadcm3 so should permit much better representation of watermasses but still includes the fundamental process of advection across density surfaces characteristic of this model type and indeed griffies et al 2000 suggest that models with eddy permitting or eddy resolving resolutions may have higher numerical mixing because of the vertical motions associated with the eddies go5 0 uses the total variance dissipation tvd scheme zalesak 1979 for horizontal advection of tracers the vertical mixing of tracers and momentum in the go5 0 configuration is parameterised using a modified version of the gaspar et al 1990 turbulent kinetic energy tke scheme described in madec 2016 unresolved vertical mixing processes are represented by a background vertical eddy diffusivity controlled by the parameter rn avt0 in nemo which has a constant value of 1 2 10 5 m2 s 1 at latitudes poleward of 15 decreasing linearly to a value of 1 2 10 6 m2 s 1 at 5 latitude gregg et al 2003 this parameter imposes an absolute minimum value for the diffusivity at each grid point and the contributions of other processes such as double diffusion and breaking internal waves are represented by positive definite increments to this in regimes where the vertical density profile is unstable convection is simulated by an enhanced vertical diffusivity for tracers and momentum of 10 m2 s 1 the time averaged value of the applied explicit vertical diffusivity is saved at each grid point in the routine model output go5 0 uses the unesco equation of state for seawater chen and millero 1987 as implemented by jackett and mcdougall 1995 we note that the 6 hourly surface forcing applied to the model means that our results are more directly comparable with those for the model run 6hw in the study of lee et al 2002 than for their integration with monthly forcing mon with the former demonstrating higher rates of numerical mixing we also note that go5 0 does not apply any horizontal mixing nor does it use the gent and mcwilliams 1990 scheme for parameterised adiabatic eddy mixing we present results from the final ten years 1996 2005 of the thirty year model integration and have used both the monthly mean output and the five day output the latter being expected to better represent the non linear quadratic correlations 3 the method 3 1 using the watermass transformation framework to diagnose vertical mixing lee et al 2002 derive in their appendix b an expression for the effective diffusivity based on the watermass transformation framework of walin 1982 which we shall not reproduce in full here however we will briefly summarise the method and define the quantities we will use to estimate the diapycnal fluxes and effective diffusivity they define a watermass transformation streamfunction by adding the rate of change of the isopycnal volume in density space which we will refer to as drift to the overturning streamfunction 1 g φ ρ ψ φ ρ t v φ ρ where ρ is the density and φ the latitude ψ φ ρ is the overturning streamfunction and v φ ρ is the volume below the isopycnal surface ρ and south of φ g φ ρ is the net density transformation rate at the density surface φ ρ this is primarily composed of the diffusive flux across the surface but there are contributions from the non linear equation of state in this case cabbeling since thermobaricity and neutral surface helicity are identically zero on a potential density surface and from the convergence of density fluxes below the surface ρ we assume both of these may be neglected in this analysis but will discuss cabbeling in section 4 we define a diapycnal velocity gdia as the diapycnal volume flux per unit area this is related to g φ ρ according to 2 g φ ρ y x w x e g d i a d x assuming that there is no lateral diffusion of density below the isopycnal we note that in the go5 0 model configuration only the redi isopycnal diffusion is used and neglecting cabbeling we may define the effective diffusivity as 3 κ e f f ρ m a x ρ g φ ρ y d ρ x w x e ρ z d x in this paper we shall also compare the diagnosed diapycnal velocity gdia with the diapycnal velocity gdiff from the explicit mixing performed by the model 4 g d i f f ρ κ e x p ρ z where κexp is the diffusivity prognosed by the mixing scheme the zonal mean upward diapycnal velocity gdia φ ρ where the angle braces imply zonal averaging is derived from eq 2 by dividing the meridional divergence of the transformation streamfunction g φ ρ by the zonal width across the basin of the density layer at latitude φ 5 g d i a φ ρ g φ ρ y x w x e d x ρ y substituting for g φ ρ from eq 1 gives 6 g d i a φ ρ ψ φ ρ y t v φ ρ y x w x f d x ρ φ ψ φ ρ y x w x f d x ρ φ t z φ ρ where z ρ is the height of the isopycnal ρ in each water column and where we define z φ ρ as the zonal mean isopycnal height at latitude φ we concern ourselves only with the interior part of the ocean that is not directly affected by surface forcing we define a maximum surface density ρ max φ as a function of latitude as the maximum value over the annual cycle of the mean monthly surface density over the final ten year period of the integration we shall discuss here only those regions in density and latitude space φ ρ where the density is higher than ρ max φ the mediterranean and the red sea are excluded in the calculation of ρ max φ since their high surface densities σ 2 36 0 kg m 3 do not relate to direct surface influence on large scale deep watermasses 3 2 numerical solution the above equations were solved in the global atlantic and indo pacific basins in latitude bands 2 wide with the atlantic and indo pacific domains defined to extend from 35 s to 65 n the vertical coordinate was chosen to be potential density referenced to a pressure of 2000 dbar σ 2 this quantity is conserved by construction in adiabatic processes and this choice of reference pressure is accepted as a good compromise maintaining monotonicity in near surface waters and in the abyss over most of the ocean 72 density classes were used values listed in table 1 spanning the range 30 0 σ 2 37 2 kg m 3 a linear density scale was used for σ 2 35 0 kg m 3 while a logarithmic mapping onto the axis was used at densities higher than 35 0 kg m 3 in order to have a good representation of deep and bottom waters in evaluating the diapycnal fluxes a three point smoother was applied in the vertical to reduce sampling effects in the conversion from depth to density coordinate the overturning transports and the zonal integrals were first evaluated on model grid rows for consistency and then assigned to latitude bins for exact results transports should be assigned to density classes at each timestep during integration and a running time average carried out of these in density space however since this framework is not included in the nemo v3 4 code we use the time averages that are available from the model integration to derive an acceptable approximate solution the transformation streamfunction and the effective diffusivity were calculated from both monthly and 5 day mean outputs from the last ten years of the go5 0 model integration it was found that although the overall form of the results was rather similar with the two averaging periods the streamfunction was smoother with the higher frequency forcing so the results we present here are from the 5 day means the drift terms were evaluated from the difference in the mean isopycnal heights z ρ averaged over 5 day means in the first and last years of the ten year period we shall present zonally averaged values of diffusivity both explicit and diagnosed in density classes the diffusivity in these averages is weighted by the vertical density gradient since this corresponds to a diapycnal or vertical density flux rather than a simple thickness weighted mean 4 results 4 1 the overturning streamfunction and watermass transformations the overturning streamfunction calculated with potential density as the vertical axis allows a qualitative visualisation of the large scale effects of diapycnal mixing as it explicitly shows the transport of water across density surfaces fig 1 shows the streamfunctions in the global atlantic and indo pacific domains evaluated as a function of potential density averaged over the final ten years of the go5 0 integration in the steady state non horizontal streamlines imply density transformations the poleward surface circulation labelled here by green arrows is generally associated with buoyancy loss to the atmosphere which corresponds to streamfunction contours that slope downward in density space along the direction of flow in the interior unventilated circulation is generally along streamlines that slope upwards towards lower densities corresponding to buoyancy gain of dense waters due to down gradient mixing with overlying light water although the downward inclined streamlines below σ 2 37 0 at the base of the southward flowing nadw in the atlantic also correspond to mixing in this case with the underlying denser aabw the absence of negative contours in the abyss in fig 1 b implies that the flow of antarctic bottom water into the atlantic has ceased after twenty years of integration although fig 1 c shows that over 12 sv of aabw is still upwelling in the indo pacific where it forms the dominant overturning cell it is clear in fig 1 that not all the interior streamlines are monotonic in particular there is a bulge in the global circulation between 40 and 55 s at densities between 36 2 and 37 0 as well as apparently closed cells in the aabw circulation we shall show that these instances are partly due to adjustment processes related to slow model drift and the residual is likely to result chiefly from nonlinearities in the equation of state cross correlations between density and mass transport on timescales shorter than the 5 day averaging period used here are also likely to form some contribution using 5 day means leads to rather smoother streamlines and diapycnal velocity fields than those derived from monthly means and while there is no reason to assume that shorter time averages would not lead to further improvements these were not available 4 2 diapycnal velocities from the model s mixing scheme fig 2 a shows the mean tracer diffusivity κ on a logarithmic scale as a function of depth as calculated by the tke scheme in go5 0 averaged over the final ten years of the integration on a section at 30 w with contours of the potential density σ 2 the σ 2 37 1 contour approximately marks the upper boundary of antarctic bottom water aabw with north atlantic deep water nadw overlying it this shows that the tke mixing scheme used by the model enhances the mixing coefficient over the mid ocean ridges but away from the ridges the mixed layer and the high latitude convection regions the explicit diffusivity generally takes values between the background diffusivity between 1 2 10 6 m2s 1 within 5 of the equator and 1 2 10 5 m2s 1 in the extra tropics and around ten times the background value generally increasing downwards the large diffusivities at the southern end of the section correspond to the weddell polynya and the associated deep convection that develop in the third decade of the model integration as described in megann et al 2014 fig 2 b shows the same field as in a but now evaluated in density classes in the global domain along with the overturning streamlines solid and dashed lines and an indication of the maximum annual surface density bold dashed line again the large values in the surface forced boundary layer are clear as is the reduced diffusivity close to the equator in the interior the diffusivity tends to increase with density being generally less than 2 10 5 m2 s 1 at densities less than 36 5 kg m 3 but exceeding 1 10 4 m2 s 1 at densities greater than 37 0 kg m 3 comparison with fig 2 a shows that the latter enhanced values correspond to antarctic bottom water or to watermasses lying directly above aabw fig 2 c and d shows the diffusivity in density classes in the atlantic and indo pacific respectively the dependence of the diffusivity on latitude and density is similar to that in the global domain we note that overall the values of κ used by the model are not inconsistent with the diffusivity profiles published by kunze et al 2006 and by waterhouse et al 2014 derived from a wide selection of microstructure measurements specifically these authors infer values of between 10 6 and 10 5 m2 s 1 in the ocean interior with enhanced values of between 10 6 and 10 5 m2 s 1 above rough topography as a baseline for comparison with the effective mixing in the model we first evaluate the diapycnal velocities produced by the explicit mixing scheme in the model gdiff as defined in eq 4 these are presented as a function of latitude and density fig 3 a and as a global plot on three density surfaces indicated by the horizontal dashed red lines in fig 3 a firstly σ 2 36 70 fig 3 b corresponds to a surface just above the southward flowing deep waters σ 2 36 91 fig 3 c is in the centre of the southward flowing nadw and σ 2 37 07 fig 3 d which lies close to the upper boundary of antarctic bottom water values of gdiff in the interior region densities below the dashed black line corresponding to the maximum annual surface density are generally positive consistent with down gradient diapycnal flow the values generally increase from the abyss to the deep and intermediate waters consistent with the increasing magnitude of the vertical density gradient and are high above 5 10 7 m s 1 in the mixed layer the alternating sign of the diapycnal velocity seen between 10 s and the equator in fig 3 a is a numerical artefact from discretisation the negative values in the abyss are a combination of the sharp bottom intensification of the diffusivity from the tke scheme κ z reverses sign near the bottom as is clearly shown in fig 2 along with the relatively coarse resolution when the fields are projected into density space typical values at the top of the deep waters σ 2 36 70 are around 0 5 10 7 m s 1 or approximately 1 5 m year fig 4 shows the rate of change of the height of isopycnal surfaces z ρ in the global ocean as a function of latitude and density as well as zonally averaged on the same density surfaces as fig 3 positive values imply an increase in density at a given depth in the water column over time over much of the global ocean the two lighter isopycnals are deepening corresponding to a lightening of watermasses with the highest rate of drift up to 2 10 7 m s 1 or around 6 5 m year seen in the southern ocean and in the atlantic north of about 30 n this can be interpreted as a general replacement of denser watermasses by lighter water thereby depressing the isopycnals the rate of isopycnal displacement is generally large compared with the fluxes due to explicit mixing but is less spatially smooth than the latter especially away from the equator the densest isopycnal σ 2 37 07 shows a contrast between the atlantic and the rest of the world ocean indicating a reduction of the volume of the bottom waters in the atlantic and an increase elsewhere this is consistent with the presence of a strong aabw cell in the indo pacific and the near disappearance of this cell in the atlantic fig 1 4 3 diagnosed diapycnal velocities we now evaluate the diagnosed diapycnal velocities defined in eq 5 for comparison with the diapycnal velocity gdiff associated with the explicit mixing parameterised by the model as defined in eq 4 we expect these to be a sum of the transformation rate resulting from the explicit mixing and a term resulting from the numerical mixing in the model which is likely to be generally but not necessarily positive in fig 5 we show the diapycnal velocity estimated from the streamfunction alone gψ and the total gdia as functions of density and latitude in the global domain with the overturning streamfunction again overlain to indicate the circulation in density space and with the minimum monthly mean surface density plotted bold dashed line to delimit the directly surface forced transformation regime away from the surfaced forced mixed layers the diapycnal velocity associated with advection across isopycnals gψ is mainly positive corresponding to transformation toward lower densities with typical velocities of between 1 10 7 and 4 10 7 m s 1 or 3 12 m year higher values are seen north of 40 n and south of 40 s as well as in the equatorial upwelling regions we note that these relatively high transformation rates lie in locations in density and latitude space that are at least partially surface forced including the drift term generally has two effects increasing the diagnosed rate of transformation to lower densities and acting to cancel some of the downward diapycnal velocities for instance at σ 2 36 6 and between 40 and 50 s see fig 5 b and in the north atlantic between 35 n and 40 n above σ 2 36 0 fig 5 d there remain regions with a negative gdia in particular in the southern ocean between 50 and 40 s in the abyssal atlantic below σ 2 36 9 and at intermediate densities in the tropical atlantic in the latter case the negative diapycnal velocities correspond to downward kinks in the streamlines in both the southward flowing nadw and in the intermediate water flowing northward above it these kinks seem to be robust also appearing when the streamfunction is calculated with reference pressure of 1000 dbar and 0 dbar as well as being independent of the numerical package used to evaluate ψ comparison of the diagnosed diapycnal velocity gdia fig 5 b with the zonal mean diapycnal velocity gdiff from explicit mixing fig 3 a reveals that while the latter is between 0 5 and 1 5 10 7 m s 1 everywhere within the non surface forced regime with negative values close to the equator and at the upper boundary of aabw gdia is positive almost everywhere outside the southern ocean and in certain latitude bands exceeds 5 10 7 m s 1 although the enhanced gdia in the model does not by itself imply high rates of numerical mixing we shall show in section 4 4 that the effective diffusivity derived from gdia is substantially larger than the explicit diffusivity a question that is pertinent at this point is whether the large values of the diapycnal velocities derived from the overturning streamfunction are an artefact of carrying out the analysis in potential density space rather than using the locally referenced density surfaces used in the model advection and mixing schemes clearly a streamfunction cannot be meaningfully defined on the latter surface which is non conservative as we have already shown the diagnosed diapycnal velocities are large compared with those expected from the model mixing scheme in the potential density range 35 5 σ 2 36 9 e g fig 5 a which as can be verified by inspection of fig 2 a corresponds roughly at mid latitudes to depths between 2000 and 500 m over this depth range our choice of 2000 dbar as reference pressure pref for the density coordinate may not be optimal to investigate the sensitivity of our results to the particular choice of pref the streamfunction was evaluated in the final year of integration for both pref 1000 and 2000 dbar and the zonal mean global diapycnal velocity gψ derived from this in each case with the overturning streamlines drawn as contours for reference fig 6 it should be noted that the range of values in fig 6 is reduced relative to that used in fig 5 for clarity while the values of σ 1 for the vertical scale are chosen to represent the overturning cells in the two cases as comparably as possible if the high transformation rates already described were mainly due to the use of an inappropriate reference pressure we would expect the diapycnal velocity at depths between 500 and 1500 m to be substantially reduced when the reference pressure is changed from 2000 dbar to 1000 dbar instead the zonal mean of gψ has similar magnitudes in the two cases with close correspondence between the regions of larger transformation rates in subtropical latitudes as well as between those regions where gψ is close to zero are even negative namely in the southern ocean and between 0 and 10 n there is nevertheless some sensitivity to reference pressure the values where the nadw flows southwards in the southern hemisphere at 1500 2000 m depth are 30 40 larger with σ 1 fig 6 a than with σ 2 fig 6 b although little corresponding increase in gψ is seen with σ 2 at lower densities i e shallower depths all the same we may conclude with some degree of confidence that our results are to first order robust to the choice of coordinate system used 4 4 estimation of the diapycnal diffusivity in this section we compare the diapycnal diffusivities diagnosed from eq 3 with the explicit diffusivity in the model if our method correctly expresses the watermass transformation rate from the total mixing performed by the model the value of diffusivity it gives will be equivalent to the explicit diffusivity plus an increment due to numerical mixing as shown in section 4 3 the diapycnal velocity is generally between 2 and 10 times larger than that implied by the explicit diffusivity and the local density gradient so we might expect the effective diffusivity to be proportionally larger than the diffusivity applied by the model fig 7 shows the effective diffusivity κeff on the same logarithmic scale as fig 2 in the last ten years of go5 0 in the global atlantic and indo pacific domains evaluated as in eq 3 from the divergence of the overturning streamfunction and the rate of isopycnal drift in each case contours of the overturning streamfunction are overlain to show the mean circulation and as before the maximum monthly surface density is denoted by a bold dashed line the white areas show negative diffusivities on comparison with fig 2 it is immediately clear that the diffusivity inferred from the watermass transformation rate is substantially larger than the explicit diffusivity over much of the ocean at densities higher that the surface forced region in the global domain fig 6 a the region of low diffusivity of below 10 5 m2 s 1 between the equator and 10 n and for densities between the base of the mixed layer and σ 2 36 3 is correctly diagnosed by our scheme indicating that the numerical mixing is low here similarly the diagnosed diffusivity also shows the reduction in value around the equator in all ocean basins the negative value at σ 2 36 3 at 5 n in the indo pacific is close to zero and is likely to result from a truncation error in the densest layers σ 2 37 0 the mixing appears to be dominated by the parameterised enhancement of mixing over rough topography since the values of κeff and κ are comparable here elsewhere however there are values of 3 10 4 m2 s 1 in the density range between σ 2 36 0 and σ 2 36 9 at all latitudes compared with the model diffusivity which is generally between 3 10 5 and 1 10 4 for these watermasses the three regions in fig 7 where there are significant negative diagnosed diffusivities in the ocean interior merit comment these comprise the latitude range 40 50 s in the southern ocean two patches in the north atlantic between 30 n and 50 n and lastly in the tropical atlantic between 20 s and 5 s the former two regions correspond quite closely to the regions where klocker and mcdougall 2010 calculated substantial antidiffusive watermass transformation rates arising from the nonlinear equation of state mainly cabbeling and thermobaricity in a coarse resolution model these authors estimated diapycnal velocities of around 10 7 m s 1 which are not inconsistent with the values of 0 5 1 0 10 7 m s 1 in fig 5 a meaningful offline calculation of the transformation rates from these processes in an eddying model such as go5 0 is near impossible but it seems reasonable to ascribe the negative diffusivities in these first two regimes to nonlinearities in the equation of state the negative values in the tropical atlantic however are unlikely to arise from this source and probably result from shortcomings in the analysis possibly from the neglect of eddy terms in the calculation of volume transports which are noted by nurser and lee 2004 to give rise to spurious features in the overturning circulation we note that the circulation at the western boundary of the atlantic between the equator and 20 s in this model is particularly complex with the southward deep western boundary current partly overlapping in depth with the northward brazil current with each carrying around 10 sv small truncation errors in the partition of the transport into density classes may plausibly lead to the non monotonicity of streamlines seen here finally to clarify the relative contributions of numerical and physical mixing in the model fig 8 shows the ratios of the diagnosed diffusivity fig 7 to the explicit diffusivity fig 2 as a function of latitude and density in the global atlantic and indo pacific regions if the numerical mixing is negligible the ratio should approach unity while if numerical mixing is significant the ratio will be appreciably larger than unity in the global domain the ratio is greater than unity almost everywhere below the maximum surface density the exceptions are the region of negative diagnosed diffusivity between 40 and 50 s already mentioned and in the abyssal waters with potential densities greater than 37 1 kg m 3 although there are enhanced diffusivity values of up to 5 times the explicit value in the northward flowing antarctic bottom water south of 40 s this confirms our interpretation of fig 7 namely that in the deep waters and intermediate waters the numerical mixing is up to an order of magnitude larger than the mixing performed by the mixing scheme 4 5 comparisons with lee et al 2002 results lee et al 2002 estimated the rate of isopycnal drift the diapycnal velocity and the effective diffusivity in the southern hemisphere for the 0 25 global occam model which may be directly compared with the results we have obtained for go5 0 we note that our 20 year spin up of the model before diagnostics are calculated is more than twice the length as the 8 years used by lee et al 2002 so we might expect the diapycnal velocities due to model drift to be smaller relative to those from mixing than in the results presented in the latter paper indeed where the aabw cell in the occam model appeared to have shut down during the spinup period go5 0 produces 12 sv of aabw and is able to export at least a part of this into the northern hemisphere qualitatively lee et al found isopycnals to be sinking at around 5 m year south of 35 s while in go5 0 fig 4 a the isopycnals are sinking at between 1 5 and 4 5 m year in the southern ocean the diapycnal velocities in the region of the path of the antarctic circumpolar current acc in occam lee et al s fig 7 a were estimated to be 40 m year or more corresponding to a total water mass transformation rate of around 15 sv between 40 s and 60 s the transformation rate in go5 0 may be estimated from fig 5 there is about 12 sv of upwelling in this latitude range fig 5 a and when the drift term is taken into account fig 5 b the total transformation rate is likely to be comparable to that in occam the effective diapycnal diffusivity in the occam run with six hourly winds fig 8 c in lee et al has values of over 10 4 m 2 s 2 in the density range 36 84 σ 2 36 94 everywhere south of the equator increasing to 5 10 10 4 m 2s 2 south of 50 s with patches of negative diffusivities 36 70 σ 2 36 80 between 35 s and the equator in go5 0 fig 7 a κeff is greater than 10 4 m2 s 1 in densities between 36 50 and 37 10 with enhanced values south of 50 s and the negative values extend over a similar density range as that in occam but are limited to the latitude band 50 s 40 s in summary our results are quantitatively consistent with those of lee et al 5 sources of numerical mixing 5 1 characterisation of transient flows the main source of numerical diapycnal mixing in the ocean interior is from truncations in the advection scheme where flow is across isopycnals either by transient motions or by the mean circulation as noted by griffies et al 2000 numerical mixing of tracers results from the irreversible component of the numerical advection which is some ideally negligibly small fraction of the physical reversible advection of which the advection scheme is an approximate representation in this section we characterise the vertical motions in the model and discuss their relationship to the numerical diffusivity in the go5 0 model the types of mesoscale variability found in a numerical ocean model of this resolution may be characterised as follows firstly the coherent wavelike features in the upper 1000 m of the tropical atlantic and pacific usually referred to as tropical instability waves legeckis 1977 with dominant wavelengths of around 1000 km but with highly filamentary structure within this eddy like mesoscale variability with a length scale around the first baroclinic rossby radius associated with strong currents such as separated western boundary currents and the antarctic circumpolar current near inertial gravity waves energised by wind stress variability at the western boundary e g blaker et al 2012 internal waves and tides and finally noise like features at or close to the grid scale where the grid is unable to resolve the eddy like features created by barotropic or baroclinic instability mainly at high latitudes and on coastal shelves all of these have strong transient vertical velocities of a metre per day or more in the ocean this motion generally takes the form of isopycnal heave which in non breaking cases results in negligible mixing but in depth coordinate models produces significant cross coordinate flow and therefore has the potential to create numerical mixing in fig 9 we show the mean and rms vertical velocities from a ten year average of 5 day means on the same potential density surfaces as in fig 2 the mean vertical velocities in the gyre scale upwelling and downwelling regions are typically less than 2 10 7 m s 1 or 10 20 cm day while the upwelling rate in the southern ocean is around twice this there are vertical velocities of up to 10 20 10 7 m s 1 with sign alternating over a hundred kilometres or so along the path of the acc and separated boundary currents the rms velocities by contrast reach ten to a hundred times the mean in eddy rich regions such as the southern ocean and the north atlantic the eddy like features in the vertical velocity field are found to be well correlated vertically over two or three thousand metres depth and examination of their time evolution reveals that they are mainly advected by the mean circulation or propagate independently rather than being stationary we note that the rms vertical velocities in a 5 day mean output file in these regions are typically 5 m day and we shall show in section 5 3 that instantaneous vertical velocities are significantly larger than this we conclude that there are persistent vertical motions over most of the ocean depth that have at least the potential to cause significant numerical mixing 5 2 relation between and transient vertical motions and numerical mixing in a pure isopycnic model where the coordinate surfaces in any water column rise and fall in response to vertical adiabatic motions the passage of wavelike or eddy like features will not lead to numerical mixing in a model with a fixed vertical coordinate by contrast vertical motions will inevitably cause advection across the coordinate surfaces if there is a vertical gradient of a tracer and hence will cause at least some mixing even in the absence of explicit mixing the rate of change of density due to vertical advection is given by 7 ρ t w ρ z if the vertical velocity w consists primarily of an alternating flow with a relatively small mean value it is more useful in this context to consider the standard deviation of the advection 8 ρ t s w ρ z where s a a 2 a 2 and the overbar denotes a temporal and spatial mean if the numerical scheme were to preserve exactly the reversibility of the flow this would not result in significant mixing but in a typical depth coordinate model there will be generally a net diffusive exchange of watermass properties across a density surface as a result of this transient flow an associated advective diapycnal velocity gadv may then be defined by dividing by the mean stratification 9 g a d v s w ρ z ρ z gadv is essentially the standard deviation of the vertical velocity weighted by the stratification and represents the potential of the transient vertical velocity primarily to advect density and ultimately to perform numerical mixing although we do not have any a priori quantification of what fraction of the numerical advection is irreversible it is instructive to compare gadv with the total diapycnal velocity gdia from mixing diagnosed earlier from the isopycnal drift and the divergence of the overturning streamfunction in density space eq 6 and shown in fig 3 the ratio of these quantities may be interpreted as the fraction of the transient advection that is irreversible in fig 10 show the mean and standard deviation of the vertical velocity the advective diapycnal velocity gadv as defined in eq 9 and the ratio of the latter to the diagnosed diapycnal velocity gdia from section 4 all in density classes from 5 day means and then averaged in time the time mean vertical velocity fig 10 a over much of the ocean is downward and less than 2 10 7 m s 1 with the exception of the equator the southern ocean and the subpolar north atlantic where there is a mean upwelling of 10 20 10 7 m s 1 the standard deviation of w fig 10 b again can be seen to be an order or two of magnitude larger than the mean note the different ranges on the colour scales and is up to 1000 10 7 m s 2 10 m day in the tropics and subpolar regions and with values generally higher below σ 2 36 9 lower deep waters and bottom waters the advective diapycnal velocity gadv fig 10 c has a similar magnitude and spatial distribution to the standard deviation but is further enhanced in the regions where the w variance is large especially in the north atlantic between 35 and 50 n comparison between figs 5 b and 10 c shows that the spatial distribution of gadv is strikingly similar to that of the diagnosed diapycnal velocity gdia particularly in the tropics and northern hemisphere with large values close to the line of maximum surface density as well as at all densities near the equator and north of 30 n to quantify this fig 9 d shows the ratio of gadv to the diapycnal transformation rate gdia this is generally less than a percent but has values of 2 3 in the ocean interior in the latitude ranges 35 20 s and 20 30 n this suggests that the irreversible part of the numerical vertical advection in this model configuration typically constitutes a few percent of the total the regions with the highest ratios are in the subtropics between 20 and 35 n and s and correspond quite closely to the two regions in subtropical latitudes with the high ratios of numerical to explicit diffusivity fig 8 a suggesting that these transient vertical velocities are at least partly responsible for the excessive mixing there 5 3 identification of high frequency vertical motions blaker et al 2012 analysed a comparable ¼ integration of nemo likewise forced by 6 hourly winds and identified energetic near inertial gravity waves nigws originating in the western boundary currents these are initiated by intense wind events close to the western boundary and propagate towards the equator they have high vertical coherence between the thermocline and the ocean bottom and have periods close to the inertial period wavelengths of 150 200 km and are characterised with vertical velocities between 50 and 100 m day their maximum amplitude in the atlantic is between 25 n and 45 n coinciding with the peaks of effective diffusivity described in section 4 the 15 30 h period of the nigws in this latitude range means that they would not be appreciably detectable in the 5 day output of the integration discussed here and this in turn implies that the vertical velocities shown in figs 9 and 10 significantly underestimate the transient vertical velocity field to illustrate this fig 11 shows the vertical velocities at 2000 m depth and on a section at 55 w with scales chosen to render easy comparison with fig 5 of blaker et al fig 11 a and b is an instantaneous field taken from a restart file from september of year 20 of the go5 0 integration while fig 11 c and d is the mean vertical velocity over a five day period including the instantaneous restart in the instantaneous fields zonal wavefronts can be seen south of 30 s with amplitude of up to 25 m day as well as eddy like and noise like features with substantially larger magnitudes close to the western boundary north of 35 n we remark that the corresponding figure in blaker et al shows vertical velocities of up to 100 m day the authors of that paper note the seasonality of the nigws and the arbitrarily selected date of the output data shown in fig 10 may underrepresent the typical amplitude of these waves by contrast the 5 day mean only shows the downward flow of the deep western boundary current at 40 n and a few noise like features near the shelf with the nigws not visible at all on this scale comparison of the magnitudes of vertical motions in the two timescales confirms that the 5 day averaging causes an underestimate of the short timescale vertical velocity field by up to an order of magnitude griffies et al 2000 suggest a direct relationship between numerical mixing and the vertical courant number wδt δz as we have argued above the stratification will also affect the potential of transient motions to cause numerical mixing but intuitively we might expect the proportion of irreversible advection to be related to the fraction of a grid cell across which advection carries a water parcel in a single time step the vertical grid spacing around 2000 m depth is about 150 m the resolved vertical velocity of 25 m day noted above corresponds to a displacement of 40 cm in a 1350 second model timestep and a vertical courant number of 2 5x10 3 in section 5 2 we estimated the proportion of irreversible advection in those regions where the diagnosed diapycnal diffusivity is large compared with the explicit diffusivity to be of order 10 2 that the vertical courant number in these regions is of the same order of magnitude is then unsurprising 6 summary and discussion we have applied the analysis of lee et al 2002 itself based on the isopycnal watermass transformation framework of walin 1982 to diagnose the effective diapycnal diffusivity κeff in go5 0 a 0 25 global ocean only configuration of the nemo model the diffusivity expressed as a function of potential density and latitude is compared with that prognosed by the model s vertical mixing scheme and it is found that in intermediate and deep water density classes and on the equator and in subtropical latitude bands the values are up to an order of magnitude larger than the explicit diffusivity since the latter is set by the mixing scheme of the model to give a diffusivity with a magnitude and geographical distribution consistent with observational estimates our results imply that the diapycnal mixing of the model is excessive and that it is dominated by numerical mixing as a further check the diapycnal velocity again diagnosed from the overturning circulation in density space is compared with that derived from the explicit diffusivity and with observational estimates of mixing and the former is also found to be up to ten times the explicit diapycnal velocity the standard deviation of the vertical velocity is found to have much larger magnitude than the mean vertical velocity with values of up to 10 m day in the ocean interior in the subpolar and equatorial regions we have defined an effective advective diapycnal velocity as the vertical density advection divided by the density gradient which although quantitatively similar to the vertical velocity explicitly represents the potential of transient motions to perform mixing this again is found to have large values in the same latitude and density ranges as the largest diagnosed diapycnal velocities namely the subpolar and equatorial regions and the deep and intermediate waters we interpret this as evidence that these wavelike or eddy like features are responsible for numerical mixing the ratio of the effective advective diapycnal velocity to the diapycnal velocity derived directly from the watermass transformation rate is found to be generally less than 1 but has values of a few percent in the northern and southern subtropics in density classes containing upper deep waters and lower intermediate waters in these watermasses the diagnosed diapycnal diffusivity was found to exceed the explicit diffusivity by a factor of 5 10 and we interpret this result as indicating that in these regions there is significant irreversibility in the vertical advection we may assume that the numerical diffusion described here in the go5 0 configuration of the nemo model is by no means untypical of z coordinate models with comparable resolution the method used in this paper is successful where the watermass transformation in density space is from denser to less dense water classes consistent with a diffusive flow regime on the large scale in other words that of the global deep water and bottom water overturning cells this is true over most of the model domain in particular we find that the north atlantic deep water nadw has a nearly monotonic transformation rate as it travels southward and mixes with overlying intermediate waters starting with a density of around σ 2 37 05 kg m 3 at 35 n and having around 36 95 kg m 3 at 45 s we have shown that adding a compensating term for the model drift in the form of a rate of change of isopycnal volumes as in lee et al 2002 indeed removes some of these instances at higher densities but there are still some remaining regions of apparently anti diffusive flow and in these cases the method described here fails to return a positive definite value for the diffusivity the regions of negative diffusivity in the southern ocean and north atlantic correspond to the regions characterised by high rates of transformation due to cabbeling and thermobaricity by klocker and mcdougall 2010 and we tentatively ascribe these negative values to densification by these processes the negative κeff in the tropical south atlantic however is more likely to be non physical and is probably a result either of omitting short timescale eddy motions in the volume transports or of truncation errors in space we have shown that there are large transient vertical velocities in the model with high coherence over the ocean depth which take the form of noise like features with length scales close to the model grid at subpolar latitudes eddy like structures near strong mean flows such as separated western boundary currents and the acc and near inertial gravity waves with periods shorter than the five day averaging period of the model output these have amplitudes of 25 50 m day and courant numbers of one or two percent we have defined an advective diapycnal velocity gadv as the standard deviation of the vertical advection of density divided by the vertical density gradient and interpret this as the potential of transient flows to advect density gradients a fraction of this advection will be irreversible as a result of truncation in the numerical advection scheme this has a large scale spatial structure similar to that of the diagnosed diapycnal velocity and in those regions where there is substantial numerical mixing the latter is found to have values of a few percent of the advective diapycnal velocity confirming that the irreversible fraction of the numerical advection is of this order the high levels of small length scale transient features in the vertical velocity in go5 0 may or may not be realistic certainly the presence of poorly resolved quasi mesoscale features in subpolar latitudes and in shallow coastal waters is undesirable and this variability may be reduced by increasing the bilaplacian viscosity or by changing to an alternative parameterisation that is even more focused on the finest length scales such as that of smagorinsky 1963 the better resolved mid latitude mesoscale eddies the near inertial gravity waves and the equatorial instability waves are likely to reflect corresponding features in the ocean but their associated vertical displacements will nevertheless entail strong advection across coordinate surfaces with the potential to perform numerical mixing leclair and madec 2011 formulated a scheme z tilde that permits short timescale periods less than a few days deformations in the vertical coordinate in analogy with isopycnal heave in the real ocean allowing fast waves to propagate without significant vertical advection and showed that this scheme led to a reduction in numerical mixing of up to a factor of five this option was not available in version 3 4 of nemo as used in go5 0 but is present in the latest release of version 3 6 the use of a higher order vertical advection scheme improves the effective vertical resolution of the model james 2000 and hence is likely to reduce the magnitude of numerical mixing such schemes have been implemented in hycom which allows piecewise constant piecewise linear and piecewise parabolic methods pcm plm and ppm respectively to interpolate between vertical levels within a given water column with increasing order of interpolation leading to less diffusion during the regridding of the hybrid vertical coordinate in that model bleck unpublished manuscript a piecewise parabolic method is currently available in nemo and we expect that this may well ameliorate the numerical mixing described here in summary we have identified large amounts of numerical mixing in an eddy permitting global ocean configuration based on a widely used ocean model nemo we stress that this does not implicate nemo specifically since the handling of the vertical coordinate in other depth coordinate models is likely to be similar the fact that closely related configurations are now being used in climate models and earth system models aimed at cmip6 implies that the drifts in the ocean temperature and salinity fields in such models on time scales from decades to centuries will bear a significant imprint of the numerical mixing this weakness of this model class is particularly highlighted by the development of the hybrid isopycnal coordinate model hycom which has much reduced numerical mixing and more recently of generalised coordinate arbitrary lagrangian eulerian models such as the gfdl mom6 in which the vertical coordinate may be optimised for different ocean regimes and which may be made quasi isopycnal in the ocean interior methods to ameliorate the spurious mixing in a depth coordinate model whether by making the vertical advection scheme less diffusive or by permitting quasi lagrangian elastic displacements of coordinate surfaces on short timescales are now available and can only lead to improvements in the performance of the ocean model in both forced and coupled modes acknowledgements this work was funded by natural environment research council uk national capability funding the author would like to thank george nurser for his vital input and encouragement and also remi tailleux gurvan madec and bablu sinha for their many helpful suggestions the manuscript was also substantially improved thanks to the suggestions of the two anonymous reviewers the model was integrated on the monsoon system a collaborative facility supplied under the joint weather and climate research programme which is a strategic partnership between the met office and the natural environment research council and was carried out under the joint ocean modelling programme jomp 
24136,constant depth or z coordinate ocean models such as mom4 and nemo have become the de facto workhorse in climate applications having attained a mature stage in their development and are well understood a generic shortcoming of this model type however is a tendency for the advection scheme to produce unphysical numerical diapycnal mixing which in some cases may exceed the explicitly parameterised mixing based on observed physical processes and this is likely to have effects on the long timescale evolution of the simulated climate system despite this few quantitative estimates have been made of the typical magnitude of the effective diapycnal diffusivity due to numerical mixing in these models go5 0 is a recent ocean model configuration developed jointly by the uk met office and the national oceanography centre it forms the ocean component of the gc2 climate model and is closely related to the ocean component of the ukesm1 earth system model the uk s contribution to the cmip6 model intercomparison go5 0 uses version 3 4 of the nemo model on the orca025 global tripolar grid an approach to quantifying the numerical diapycnal mixing in this model based on the isopycnal watermass analysis of lee et al 2002 is described and the estimates thereby obtained of the effective diapycnal diffusivity in go5 0 are compared with the values of the explicit diffusivity used by the model it is shown that the effective mixing in this model configuration is up to an order of magnitude higher than the explicit mixing in much of the ocean interior implying that mixing in the model below the mixed layer is largely dominated by numerical mixing this is likely to have adverse consequences for the representation of heat uptake in climate models intended for decadal climate projections and in particular is highly relevant to the interpretation of the cmip6 class of climate models many of which use constant depth ocean models at ¼ resolution keywords global ocean ocean model numerical mixing watermass transformation 1 introduction the importance of using a correct distribution of the diapycnal mixing and hence of the watermass transformation rate to the large scale ocean circulation in climate models is evident the upwelling regions of the global overturning streamfunction are associated with mixing processes munk and wunsch 1998 while the formation of a realistic thermocline relies on appropriate rates of mixing above and below the thermocline luyten et al 1983 in addition the uptake of co2 and heat both in the quasi equilibrium state of control simulations and in simulations of anthropogenic warming will be sensitive to the ocean stratification while embedded biogeochemical systems will also have rather different mean states if the vertical mixing and hence the stratification are inconsistent with those in the real ocean small scale turbulent mixing in ocean models is represented by a variety of parameterisations including bulk schemes e g kraus and turner 1967 the kpp scheme large et al 1994 and the turbulent kinetic energy tke scheme gaspar et al 1990 in these schemes parameters are normally optimised in a more or less heuristic way to approximately reproduce the observed water mass structure so called depth coordinate ocean models which represent the ocean as a stack of levels with constant vertical thickness constitute the majority of ocean models used today leading examples are nemo madec 2016 and version 4 of the gfdl modular ocean model mom4 griffies et al 2008 we note that of the thirty nine climate models contributing to the intergovernmental panel on climate change ipcc fifth assessment report ipcc 2013 thirty two used ocean components formulated with depth coordinates three used terrain following sigma coordinates and four used an isopycnic density coordinate ocean model numerical diapycnal mixing is an intrinsic property of the advection scheme in this class of models and occurs whenever an advective flux crosses density surfaces which in general do not follow the horizontal coordinate surfaces griffies et al 2000 it may be reduced by the use of higher order advection schemes hofmann and morales maqueda 2006 and is absent by construction in the ocean interior in pure isopycnic models like micom bleck and smith 1990 and gold hallberg and adcroft 2009 where advection is along surfaces of constant potential density and diapycnal mixing occurs only as prescribed by the model mixing scheme there are indications that in some regimes the numerical mixing may be of comparable magnitude as and even exceed the mixing generated by the explicit mixing scheme of the model griffies et al 2000 lee et al 2002 this leads over time to the unrealistic modification of critical watermasses which is likely to have undesirable effects on timescales of a decade or longer and this may be critical in climate simulations megann et al 2010 carried out a comparison between the coupled climate models hadcm3 and chime which differ only in that in the latter the depth coordinate ocean component of hadcm3 is replaced with the hybrid isopycnic coordinate hycom bleck 2002 the model with an isopycnic ocean showed markedly superior representation of watermasses such as antarctic intermediate water aaiw and subantarctic mode water samw as well as of the subtropical thermoclines and the sill overflow waters in the north atlantic all consistent with substantially lower numerical mixing a similar conclusion was reached in a similar experiment with two coupled models at gfdl differing only in the replacement in one of the mom4 ocean model by the gold isopycnic coordinate model dunne et al 2012 several approaches to diagnosing the numerical mixing in ocean models have been developed in recent years firstly there are what we might call direct methods which evaluate the mixing generated by the advection scheme at each grid cell these include the use of passive tracers getzlaff et al 2012 and analysis of tracer variance decay burchard and rennau 2008 these may be distinguished from more indirect methods which diagnose the effects of mixing over global or basin scale spatial domains and over time scales long compared with the model time step these include the evaluation of changes in global available potential energy ilıcak et al 2012 and the estimation of diapycnal mixing by evaluating fluxes across density surfaces lee et al 2002 the representation of the overturning circulation in density space walin 1982 is potentially highly revealing of the mechanisms of watermass transformation marsh et al 2000 used an isopycnic density coordinate model to show that changes in density arising from surface buoyancy fluxes which in a lagrangian sense generally act to increase the density of water as it is advected poleward are balanced by changes in density resulting from diffusive mixing in the ocean interior marsh 2000 and subsequently grist et al 2009 showed that surface fluxes when cast into density classes provide an informative proxy for the overturning circulation where the latter is not trivial to estimate directly from the relatively sparse direct observations of the ocean interior lee et al 2002 used this framework to diagnose the interior diapycnal mixing in the occam ¼ global ocean model and then by relating this to the mean vertical density gradient to estimate the effective vertical diffusivity as a function of density and latitude they concluded that in the southern ocean the effects of numerical mixing led to values of the effective diffusivity that were large compared with those applied by the parameterised vertical mixing scheme in the model in this paper we use the technique of lee et al 2002 to analyse the contributions to watermass transformation in the go5 0 ocean model the configuration of the nemo code used in the gc2 coupled climate model williams et al 2015 and closely related to the ocean configuration of the uk earth system model ukesm1 that will be used in the cmip6 intercomparison this model will be shown to have a rather lower drift than occam as used by the former authors we shall use a modified version of the method used by lee et al to derive an estimate of the numerical diffusivity that is compared with the explicit mixing coefficients used in the model where these latter authors examined the numerical mixing in the southern hemisphere with a primary focus on the southern ocean we evaluate the diapycnal transformation rates and effective diffusivities globally as well as separately in the atlantic and indo pacific oceans in section 2 we describe the go5 0 model configuration in section 3 we summarise the methodology of lee et al 2002 and describe the numerical method used in the current paper in section 4 we present the results of this method applied to the model output deriving the diapycnal velocities and effective diffusivities and comparing these with the explicit diffusivities applied by the model s mixing scheme in section 5 we relate the diapycnal mixing to small scale vertical motions and finally section 6 is a summary and discussion 2 model description the model configuration we describe here is go5 0 megann et al 2014 a standard ocean configuration developed jointly between the uk met office and the national environment research council nerc it is used widely in forecasting and climate modelling the current version of the uk met office s foam operational ocean forecasting system blockley et al 2014 and the uk coupled climate model gc2 williams et al 2015 use go5 0 as their ocean component the gc3 climate model williams et al 2017 and the new uk earth system model ukesm1 both aimed at the ipcc sixth assessment report will both use an ocean component closely related to go5 0 in particular sharing its horizontal and vertical grids albeit with a southward extension in the more recent configurations to allow ice shelves to be simulated and most of its physics choices go5 0 is an implementation of version 3 4 of nemo nucleus for european models of the ocean madec 2016 on the global orca025 0 25 tripolar horizontal grid barnier et al 2006 and has 75 constant depth levels in the vertical with level spacing increasing from 1 m at the surface to around 200 m at 6000 m depth the parameters and physics choices are discussed in detail in megann et al 2014 the sea ice is version 4 1 of the los alamos national laboratory sea ice model cice hunke and lipscomb 2010 the integration described here is of the ocean only go5 0 model forced by core2 atmospheric fields large and yeager 2009 and is made over the 30 years from 1976 to 2005 monthly precipitation and daily downward shortwave and longwave radiation are used to force the model directly while six hourly 10 m wind 2 m air humidity and 2 m air temperature are used to compute turbulent air sea and air sea ice fluxes during model integration using the bulk formulae proposed by large and yeager 2009 this configuration has much higher horizontal and vertical resolutions than the ocean of hadcm3 so should permit much better representation of watermasses but still includes the fundamental process of advection across density surfaces characteristic of this model type and indeed griffies et al 2000 suggest that models with eddy permitting or eddy resolving resolutions may have higher numerical mixing because of the vertical motions associated with the eddies go5 0 uses the total variance dissipation tvd scheme zalesak 1979 for horizontal advection of tracers the vertical mixing of tracers and momentum in the go5 0 configuration is parameterised using a modified version of the gaspar et al 1990 turbulent kinetic energy tke scheme described in madec 2016 unresolved vertical mixing processes are represented by a background vertical eddy diffusivity controlled by the parameter rn avt0 in nemo which has a constant value of 1 2 10 5 m2 s 1 at latitudes poleward of 15 decreasing linearly to a value of 1 2 10 6 m2 s 1 at 5 latitude gregg et al 2003 this parameter imposes an absolute minimum value for the diffusivity at each grid point and the contributions of other processes such as double diffusion and breaking internal waves are represented by positive definite increments to this in regimes where the vertical density profile is unstable convection is simulated by an enhanced vertical diffusivity for tracers and momentum of 10 m2 s 1 the time averaged value of the applied explicit vertical diffusivity is saved at each grid point in the routine model output go5 0 uses the unesco equation of state for seawater chen and millero 1987 as implemented by jackett and mcdougall 1995 we note that the 6 hourly surface forcing applied to the model means that our results are more directly comparable with those for the model run 6hw in the study of lee et al 2002 than for their integration with monthly forcing mon with the former demonstrating higher rates of numerical mixing we also note that go5 0 does not apply any horizontal mixing nor does it use the gent and mcwilliams 1990 scheme for parameterised adiabatic eddy mixing we present results from the final ten years 1996 2005 of the thirty year model integration and have used both the monthly mean output and the five day output the latter being expected to better represent the non linear quadratic correlations 3 the method 3 1 using the watermass transformation framework to diagnose vertical mixing lee et al 2002 derive in their appendix b an expression for the effective diffusivity based on the watermass transformation framework of walin 1982 which we shall not reproduce in full here however we will briefly summarise the method and define the quantities we will use to estimate the diapycnal fluxes and effective diffusivity they define a watermass transformation streamfunction by adding the rate of change of the isopycnal volume in density space which we will refer to as drift to the overturning streamfunction 1 g φ ρ ψ φ ρ t v φ ρ where ρ is the density and φ the latitude ψ φ ρ is the overturning streamfunction and v φ ρ is the volume below the isopycnal surface ρ and south of φ g φ ρ is the net density transformation rate at the density surface φ ρ this is primarily composed of the diffusive flux across the surface but there are contributions from the non linear equation of state in this case cabbeling since thermobaricity and neutral surface helicity are identically zero on a potential density surface and from the convergence of density fluxes below the surface ρ we assume both of these may be neglected in this analysis but will discuss cabbeling in section 4 we define a diapycnal velocity gdia as the diapycnal volume flux per unit area this is related to g φ ρ according to 2 g φ ρ y x w x e g d i a d x assuming that there is no lateral diffusion of density below the isopycnal we note that in the go5 0 model configuration only the redi isopycnal diffusion is used and neglecting cabbeling we may define the effective diffusivity as 3 κ e f f ρ m a x ρ g φ ρ y d ρ x w x e ρ z d x in this paper we shall also compare the diagnosed diapycnal velocity gdia with the diapycnal velocity gdiff from the explicit mixing performed by the model 4 g d i f f ρ κ e x p ρ z where κexp is the diffusivity prognosed by the mixing scheme the zonal mean upward diapycnal velocity gdia φ ρ where the angle braces imply zonal averaging is derived from eq 2 by dividing the meridional divergence of the transformation streamfunction g φ ρ by the zonal width across the basin of the density layer at latitude φ 5 g d i a φ ρ g φ ρ y x w x e d x ρ y substituting for g φ ρ from eq 1 gives 6 g d i a φ ρ ψ φ ρ y t v φ ρ y x w x f d x ρ φ ψ φ ρ y x w x f d x ρ φ t z φ ρ where z ρ is the height of the isopycnal ρ in each water column and where we define z φ ρ as the zonal mean isopycnal height at latitude φ we concern ourselves only with the interior part of the ocean that is not directly affected by surface forcing we define a maximum surface density ρ max φ as a function of latitude as the maximum value over the annual cycle of the mean monthly surface density over the final ten year period of the integration we shall discuss here only those regions in density and latitude space φ ρ where the density is higher than ρ max φ the mediterranean and the red sea are excluded in the calculation of ρ max φ since their high surface densities σ 2 36 0 kg m 3 do not relate to direct surface influence on large scale deep watermasses 3 2 numerical solution the above equations were solved in the global atlantic and indo pacific basins in latitude bands 2 wide with the atlantic and indo pacific domains defined to extend from 35 s to 65 n the vertical coordinate was chosen to be potential density referenced to a pressure of 2000 dbar σ 2 this quantity is conserved by construction in adiabatic processes and this choice of reference pressure is accepted as a good compromise maintaining monotonicity in near surface waters and in the abyss over most of the ocean 72 density classes were used values listed in table 1 spanning the range 30 0 σ 2 37 2 kg m 3 a linear density scale was used for σ 2 35 0 kg m 3 while a logarithmic mapping onto the axis was used at densities higher than 35 0 kg m 3 in order to have a good representation of deep and bottom waters in evaluating the diapycnal fluxes a three point smoother was applied in the vertical to reduce sampling effects in the conversion from depth to density coordinate the overturning transports and the zonal integrals were first evaluated on model grid rows for consistency and then assigned to latitude bins for exact results transports should be assigned to density classes at each timestep during integration and a running time average carried out of these in density space however since this framework is not included in the nemo v3 4 code we use the time averages that are available from the model integration to derive an acceptable approximate solution the transformation streamfunction and the effective diffusivity were calculated from both monthly and 5 day mean outputs from the last ten years of the go5 0 model integration it was found that although the overall form of the results was rather similar with the two averaging periods the streamfunction was smoother with the higher frequency forcing so the results we present here are from the 5 day means the drift terms were evaluated from the difference in the mean isopycnal heights z ρ averaged over 5 day means in the first and last years of the ten year period we shall present zonally averaged values of diffusivity both explicit and diagnosed in density classes the diffusivity in these averages is weighted by the vertical density gradient since this corresponds to a diapycnal or vertical density flux rather than a simple thickness weighted mean 4 results 4 1 the overturning streamfunction and watermass transformations the overturning streamfunction calculated with potential density as the vertical axis allows a qualitative visualisation of the large scale effects of diapycnal mixing as it explicitly shows the transport of water across density surfaces fig 1 shows the streamfunctions in the global atlantic and indo pacific domains evaluated as a function of potential density averaged over the final ten years of the go5 0 integration in the steady state non horizontal streamlines imply density transformations the poleward surface circulation labelled here by green arrows is generally associated with buoyancy loss to the atmosphere which corresponds to streamfunction contours that slope downward in density space along the direction of flow in the interior unventilated circulation is generally along streamlines that slope upwards towards lower densities corresponding to buoyancy gain of dense waters due to down gradient mixing with overlying light water although the downward inclined streamlines below σ 2 37 0 at the base of the southward flowing nadw in the atlantic also correspond to mixing in this case with the underlying denser aabw the absence of negative contours in the abyss in fig 1 b implies that the flow of antarctic bottom water into the atlantic has ceased after twenty years of integration although fig 1 c shows that over 12 sv of aabw is still upwelling in the indo pacific where it forms the dominant overturning cell it is clear in fig 1 that not all the interior streamlines are monotonic in particular there is a bulge in the global circulation between 40 and 55 s at densities between 36 2 and 37 0 as well as apparently closed cells in the aabw circulation we shall show that these instances are partly due to adjustment processes related to slow model drift and the residual is likely to result chiefly from nonlinearities in the equation of state cross correlations between density and mass transport on timescales shorter than the 5 day averaging period used here are also likely to form some contribution using 5 day means leads to rather smoother streamlines and diapycnal velocity fields than those derived from monthly means and while there is no reason to assume that shorter time averages would not lead to further improvements these were not available 4 2 diapycnal velocities from the model s mixing scheme fig 2 a shows the mean tracer diffusivity κ on a logarithmic scale as a function of depth as calculated by the tke scheme in go5 0 averaged over the final ten years of the integration on a section at 30 w with contours of the potential density σ 2 the σ 2 37 1 contour approximately marks the upper boundary of antarctic bottom water aabw with north atlantic deep water nadw overlying it this shows that the tke mixing scheme used by the model enhances the mixing coefficient over the mid ocean ridges but away from the ridges the mixed layer and the high latitude convection regions the explicit diffusivity generally takes values between the background diffusivity between 1 2 10 6 m2s 1 within 5 of the equator and 1 2 10 5 m2s 1 in the extra tropics and around ten times the background value generally increasing downwards the large diffusivities at the southern end of the section correspond to the weddell polynya and the associated deep convection that develop in the third decade of the model integration as described in megann et al 2014 fig 2 b shows the same field as in a but now evaluated in density classes in the global domain along with the overturning streamlines solid and dashed lines and an indication of the maximum annual surface density bold dashed line again the large values in the surface forced boundary layer are clear as is the reduced diffusivity close to the equator in the interior the diffusivity tends to increase with density being generally less than 2 10 5 m2 s 1 at densities less than 36 5 kg m 3 but exceeding 1 10 4 m2 s 1 at densities greater than 37 0 kg m 3 comparison with fig 2 a shows that the latter enhanced values correspond to antarctic bottom water or to watermasses lying directly above aabw fig 2 c and d shows the diffusivity in density classes in the atlantic and indo pacific respectively the dependence of the diffusivity on latitude and density is similar to that in the global domain we note that overall the values of κ used by the model are not inconsistent with the diffusivity profiles published by kunze et al 2006 and by waterhouse et al 2014 derived from a wide selection of microstructure measurements specifically these authors infer values of between 10 6 and 10 5 m2 s 1 in the ocean interior with enhanced values of between 10 6 and 10 5 m2 s 1 above rough topography as a baseline for comparison with the effective mixing in the model we first evaluate the diapycnal velocities produced by the explicit mixing scheme in the model gdiff as defined in eq 4 these are presented as a function of latitude and density fig 3 a and as a global plot on three density surfaces indicated by the horizontal dashed red lines in fig 3 a firstly σ 2 36 70 fig 3 b corresponds to a surface just above the southward flowing deep waters σ 2 36 91 fig 3 c is in the centre of the southward flowing nadw and σ 2 37 07 fig 3 d which lies close to the upper boundary of antarctic bottom water values of gdiff in the interior region densities below the dashed black line corresponding to the maximum annual surface density are generally positive consistent with down gradient diapycnal flow the values generally increase from the abyss to the deep and intermediate waters consistent with the increasing magnitude of the vertical density gradient and are high above 5 10 7 m s 1 in the mixed layer the alternating sign of the diapycnal velocity seen between 10 s and the equator in fig 3 a is a numerical artefact from discretisation the negative values in the abyss are a combination of the sharp bottom intensification of the diffusivity from the tke scheme κ z reverses sign near the bottom as is clearly shown in fig 2 along with the relatively coarse resolution when the fields are projected into density space typical values at the top of the deep waters σ 2 36 70 are around 0 5 10 7 m s 1 or approximately 1 5 m year fig 4 shows the rate of change of the height of isopycnal surfaces z ρ in the global ocean as a function of latitude and density as well as zonally averaged on the same density surfaces as fig 3 positive values imply an increase in density at a given depth in the water column over time over much of the global ocean the two lighter isopycnals are deepening corresponding to a lightening of watermasses with the highest rate of drift up to 2 10 7 m s 1 or around 6 5 m year seen in the southern ocean and in the atlantic north of about 30 n this can be interpreted as a general replacement of denser watermasses by lighter water thereby depressing the isopycnals the rate of isopycnal displacement is generally large compared with the fluxes due to explicit mixing but is less spatially smooth than the latter especially away from the equator the densest isopycnal σ 2 37 07 shows a contrast between the atlantic and the rest of the world ocean indicating a reduction of the volume of the bottom waters in the atlantic and an increase elsewhere this is consistent with the presence of a strong aabw cell in the indo pacific and the near disappearance of this cell in the atlantic fig 1 4 3 diagnosed diapycnal velocities we now evaluate the diagnosed diapycnal velocities defined in eq 5 for comparison with the diapycnal velocity gdiff associated with the explicit mixing parameterised by the model as defined in eq 4 we expect these to be a sum of the transformation rate resulting from the explicit mixing and a term resulting from the numerical mixing in the model which is likely to be generally but not necessarily positive in fig 5 we show the diapycnal velocity estimated from the streamfunction alone gψ and the total gdia as functions of density and latitude in the global domain with the overturning streamfunction again overlain to indicate the circulation in density space and with the minimum monthly mean surface density plotted bold dashed line to delimit the directly surface forced transformation regime away from the surfaced forced mixed layers the diapycnal velocity associated with advection across isopycnals gψ is mainly positive corresponding to transformation toward lower densities with typical velocities of between 1 10 7 and 4 10 7 m s 1 or 3 12 m year higher values are seen north of 40 n and south of 40 s as well as in the equatorial upwelling regions we note that these relatively high transformation rates lie in locations in density and latitude space that are at least partially surface forced including the drift term generally has two effects increasing the diagnosed rate of transformation to lower densities and acting to cancel some of the downward diapycnal velocities for instance at σ 2 36 6 and between 40 and 50 s see fig 5 b and in the north atlantic between 35 n and 40 n above σ 2 36 0 fig 5 d there remain regions with a negative gdia in particular in the southern ocean between 50 and 40 s in the abyssal atlantic below σ 2 36 9 and at intermediate densities in the tropical atlantic in the latter case the negative diapycnal velocities correspond to downward kinks in the streamlines in both the southward flowing nadw and in the intermediate water flowing northward above it these kinks seem to be robust also appearing when the streamfunction is calculated with reference pressure of 1000 dbar and 0 dbar as well as being independent of the numerical package used to evaluate ψ comparison of the diagnosed diapycnal velocity gdia fig 5 b with the zonal mean diapycnal velocity gdiff from explicit mixing fig 3 a reveals that while the latter is between 0 5 and 1 5 10 7 m s 1 everywhere within the non surface forced regime with negative values close to the equator and at the upper boundary of aabw gdia is positive almost everywhere outside the southern ocean and in certain latitude bands exceeds 5 10 7 m s 1 although the enhanced gdia in the model does not by itself imply high rates of numerical mixing we shall show in section 4 4 that the effective diffusivity derived from gdia is substantially larger than the explicit diffusivity a question that is pertinent at this point is whether the large values of the diapycnal velocities derived from the overturning streamfunction are an artefact of carrying out the analysis in potential density space rather than using the locally referenced density surfaces used in the model advection and mixing schemes clearly a streamfunction cannot be meaningfully defined on the latter surface which is non conservative as we have already shown the diagnosed diapycnal velocities are large compared with those expected from the model mixing scheme in the potential density range 35 5 σ 2 36 9 e g fig 5 a which as can be verified by inspection of fig 2 a corresponds roughly at mid latitudes to depths between 2000 and 500 m over this depth range our choice of 2000 dbar as reference pressure pref for the density coordinate may not be optimal to investigate the sensitivity of our results to the particular choice of pref the streamfunction was evaluated in the final year of integration for both pref 1000 and 2000 dbar and the zonal mean global diapycnal velocity gψ derived from this in each case with the overturning streamlines drawn as contours for reference fig 6 it should be noted that the range of values in fig 6 is reduced relative to that used in fig 5 for clarity while the values of σ 1 for the vertical scale are chosen to represent the overturning cells in the two cases as comparably as possible if the high transformation rates already described were mainly due to the use of an inappropriate reference pressure we would expect the diapycnal velocity at depths between 500 and 1500 m to be substantially reduced when the reference pressure is changed from 2000 dbar to 1000 dbar instead the zonal mean of gψ has similar magnitudes in the two cases with close correspondence between the regions of larger transformation rates in subtropical latitudes as well as between those regions where gψ is close to zero are even negative namely in the southern ocean and between 0 and 10 n there is nevertheless some sensitivity to reference pressure the values where the nadw flows southwards in the southern hemisphere at 1500 2000 m depth are 30 40 larger with σ 1 fig 6 a than with σ 2 fig 6 b although little corresponding increase in gψ is seen with σ 2 at lower densities i e shallower depths all the same we may conclude with some degree of confidence that our results are to first order robust to the choice of coordinate system used 4 4 estimation of the diapycnal diffusivity in this section we compare the diapycnal diffusivities diagnosed from eq 3 with the explicit diffusivity in the model if our method correctly expresses the watermass transformation rate from the total mixing performed by the model the value of diffusivity it gives will be equivalent to the explicit diffusivity plus an increment due to numerical mixing as shown in section 4 3 the diapycnal velocity is generally between 2 and 10 times larger than that implied by the explicit diffusivity and the local density gradient so we might expect the effective diffusivity to be proportionally larger than the diffusivity applied by the model fig 7 shows the effective diffusivity κeff on the same logarithmic scale as fig 2 in the last ten years of go5 0 in the global atlantic and indo pacific domains evaluated as in eq 3 from the divergence of the overturning streamfunction and the rate of isopycnal drift in each case contours of the overturning streamfunction are overlain to show the mean circulation and as before the maximum monthly surface density is denoted by a bold dashed line the white areas show negative diffusivities on comparison with fig 2 it is immediately clear that the diffusivity inferred from the watermass transformation rate is substantially larger than the explicit diffusivity over much of the ocean at densities higher that the surface forced region in the global domain fig 6 a the region of low diffusivity of below 10 5 m2 s 1 between the equator and 10 n and for densities between the base of the mixed layer and σ 2 36 3 is correctly diagnosed by our scheme indicating that the numerical mixing is low here similarly the diagnosed diffusivity also shows the reduction in value around the equator in all ocean basins the negative value at σ 2 36 3 at 5 n in the indo pacific is close to zero and is likely to result from a truncation error in the densest layers σ 2 37 0 the mixing appears to be dominated by the parameterised enhancement of mixing over rough topography since the values of κeff and κ are comparable here elsewhere however there are values of 3 10 4 m2 s 1 in the density range between σ 2 36 0 and σ 2 36 9 at all latitudes compared with the model diffusivity which is generally between 3 10 5 and 1 10 4 for these watermasses the three regions in fig 7 where there are significant negative diagnosed diffusivities in the ocean interior merit comment these comprise the latitude range 40 50 s in the southern ocean two patches in the north atlantic between 30 n and 50 n and lastly in the tropical atlantic between 20 s and 5 s the former two regions correspond quite closely to the regions where klocker and mcdougall 2010 calculated substantial antidiffusive watermass transformation rates arising from the nonlinear equation of state mainly cabbeling and thermobaricity in a coarse resolution model these authors estimated diapycnal velocities of around 10 7 m s 1 which are not inconsistent with the values of 0 5 1 0 10 7 m s 1 in fig 5 a meaningful offline calculation of the transformation rates from these processes in an eddying model such as go5 0 is near impossible but it seems reasonable to ascribe the negative diffusivities in these first two regimes to nonlinearities in the equation of state the negative values in the tropical atlantic however are unlikely to arise from this source and probably result from shortcomings in the analysis possibly from the neglect of eddy terms in the calculation of volume transports which are noted by nurser and lee 2004 to give rise to spurious features in the overturning circulation we note that the circulation at the western boundary of the atlantic between the equator and 20 s in this model is particularly complex with the southward deep western boundary current partly overlapping in depth with the northward brazil current with each carrying around 10 sv small truncation errors in the partition of the transport into density classes may plausibly lead to the non monotonicity of streamlines seen here finally to clarify the relative contributions of numerical and physical mixing in the model fig 8 shows the ratios of the diagnosed diffusivity fig 7 to the explicit diffusivity fig 2 as a function of latitude and density in the global atlantic and indo pacific regions if the numerical mixing is negligible the ratio should approach unity while if numerical mixing is significant the ratio will be appreciably larger than unity in the global domain the ratio is greater than unity almost everywhere below the maximum surface density the exceptions are the region of negative diagnosed diffusivity between 40 and 50 s already mentioned and in the abyssal waters with potential densities greater than 37 1 kg m 3 although there are enhanced diffusivity values of up to 5 times the explicit value in the northward flowing antarctic bottom water south of 40 s this confirms our interpretation of fig 7 namely that in the deep waters and intermediate waters the numerical mixing is up to an order of magnitude larger than the mixing performed by the mixing scheme 4 5 comparisons with lee et al 2002 results lee et al 2002 estimated the rate of isopycnal drift the diapycnal velocity and the effective diffusivity in the southern hemisphere for the 0 25 global occam model which may be directly compared with the results we have obtained for go5 0 we note that our 20 year spin up of the model before diagnostics are calculated is more than twice the length as the 8 years used by lee et al 2002 so we might expect the diapycnal velocities due to model drift to be smaller relative to those from mixing than in the results presented in the latter paper indeed where the aabw cell in the occam model appeared to have shut down during the spinup period go5 0 produces 12 sv of aabw and is able to export at least a part of this into the northern hemisphere qualitatively lee et al found isopycnals to be sinking at around 5 m year south of 35 s while in go5 0 fig 4 a the isopycnals are sinking at between 1 5 and 4 5 m year in the southern ocean the diapycnal velocities in the region of the path of the antarctic circumpolar current acc in occam lee et al s fig 7 a were estimated to be 40 m year or more corresponding to a total water mass transformation rate of around 15 sv between 40 s and 60 s the transformation rate in go5 0 may be estimated from fig 5 there is about 12 sv of upwelling in this latitude range fig 5 a and when the drift term is taken into account fig 5 b the total transformation rate is likely to be comparable to that in occam the effective diapycnal diffusivity in the occam run with six hourly winds fig 8 c in lee et al has values of over 10 4 m 2 s 2 in the density range 36 84 σ 2 36 94 everywhere south of the equator increasing to 5 10 10 4 m 2s 2 south of 50 s with patches of negative diffusivities 36 70 σ 2 36 80 between 35 s and the equator in go5 0 fig 7 a κeff is greater than 10 4 m2 s 1 in densities between 36 50 and 37 10 with enhanced values south of 50 s and the negative values extend over a similar density range as that in occam but are limited to the latitude band 50 s 40 s in summary our results are quantitatively consistent with those of lee et al 5 sources of numerical mixing 5 1 characterisation of transient flows the main source of numerical diapycnal mixing in the ocean interior is from truncations in the advection scheme where flow is across isopycnals either by transient motions or by the mean circulation as noted by griffies et al 2000 numerical mixing of tracers results from the irreversible component of the numerical advection which is some ideally negligibly small fraction of the physical reversible advection of which the advection scheme is an approximate representation in this section we characterise the vertical motions in the model and discuss their relationship to the numerical diffusivity in the go5 0 model the types of mesoscale variability found in a numerical ocean model of this resolution may be characterised as follows firstly the coherent wavelike features in the upper 1000 m of the tropical atlantic and pacific usually referred to as tropical instability waves legeckis 1977 with dominant wavelengths of around 1000 km but with highly filamentary structure within this eddy like mesoscale variability with a length scale around the first baroclinic rossby radius associated with strong currents such as separated western boundary currents and the antarctic circumpolar current near inertial gravity waves energised by wind stress variability at the western boundary e g blaker et al 2012 internal waves and tides and finally noise like features at or close to the grid scale where the grid is unable to resolve the eddy like features created by barotropic or baroclinic instability mainly at high latitudes and on coastal shelves all of these have strong transient vertical velocities of a metre per day or more in the ocean this motion generally takes the form of isopycnal heave which in non breaking cases results in negligible mixing but in depth coordinate models produces significant cross coordinate flow and therefore has the potential to create numerical mixing in fig 9 we show the mean and rms vertical velocities from a ten year average of 5 day means on the same potential density surfaces as in fig 2 the mean vertical velocities in the gyre scale upwelling and downwelling regions are typically less than 2 10 7 m s 1 or 10 20 cm day while the upwelling rate in the southern ocean is around twice this there are vertical velocities of up to 10 20 10 7 m s 1 with sign alternating over a hundred kilometres or so along the path of the acc and separated boundary currents the rms velocities by contrast reach ten to a hundred times the mean in eddy rich regions such as the southern ocean and the north atlantic the eddy like features in the vertical velocity field are found to be well correlated vertically over two or three thousand metres depth and examination of their time evolution reveals that they are mainly advected by the mean circulation or propagate independently rather than being stationary we note that the rms vertical velocities in a 5 day mean output file in these regions are typically 5 m day and we shall show in section 5 3 that instantaneous vertical velocities are significantly larger than this we conclude that there are persistent vertical motions over most of the ocean depth that have at least the potential to cause significant numerical mixing 5 2 relation between and transient vertical motions and numerical mixing in a pure isopycnic model where the coordinate surfaces in any water column rise and fall in response to vertical adiabatic motions the passage of wavelike or eddy like features will not lead to numerical mixing in a model with a fixed vertical coordinate by contrast vertical motions will inevitably cause advection across the coordinate surfaces if there is a vertical gradient of a tracer and hence will cause at least some mixing even in the absence of explicit mixing the rate of change of density due to vertical advection is given by 7 ρ t w ρ z if the vertical velocity w consists primarily of an alternating flow with a relatively small mean value it is more useful in this context to consider the standard deviation of the advection 8 ρ t s w ρ z where s a a 2 a 2 and the overbar denotes a temporal and spatial mean if the numerical scheme were to preserve exactly the reversibility of the flow this would not result in significant mixing but in a typical depth coordinate model there will be generally a net diffusive exchange of watermass properties across a density surface as a result of this transient flow an associated advective diapycnal velocity gadv may then be defined by dividing by the mean stratification 9 g a d v s w ρ z ρ z gadv is essentially the standard deviation of the vertical velocity weighted by the stratification and represents the potential of the transient vertical velocity primarily to advect density and ultimately to perform numerical mixing although we do not have any a priori quantification of what fraction of the numerical advection is irreversible it is instructive to compare gadv with the total diapycnal velocity gdia from mixing diagnosed earlier from the isopycnal drift and the divergence of the overturning streamfunction in density space eq 6 and shown in fig 3 the ratio of these quantities may be interpreted as the fraction of the transient advection that is irreversible in fig 10 show the mean and standard deviation of the vertical velocity the advective diapycnal velocity gadv as defined in eq 9 and the ratio of the latter to the diagnosed diapycnal velocity gdia from section 4 all in density classes from 5 day means and then averaged in time the time mean vertical velocity fig 10 a over much of the ocean is downward and less than 2 10 7 m s 1 with the exception of the equator the southern ocean and the subpolar north atlantic where there is a mean upwelling of 10 20 10 7 m s 1 the standard deviation of w fig 10 b again can be seen to be an order or two of magnitude larger than the mean note the different ranges on the colour scales and is up to 1000 10 7 m s 2 10 m day in the tropics and subpolar regions and with values generally higher below σ 2 36 9 lower deep waters and bottom waters the advective diapycnal velocity gadv fig 10 c has a similar magnitude and spatial distribution to the standard deviation but is further enhanced in the regions where the w variance is large especially in the north atlantic between 35 and 50 n comparison between figs 5 b and 10 c shows that the spatial distribution of gadv is strikingly similar to that of the diagnosed diapycnal velocity gdia particularly in the tropics and northern hemisphere with large values close to the line of maximum surface density as well as at all densities near the equator and north of 30 n to quantify this fig 9 d shows the ratio of gadv to the diapycnal transformation rate gdia this is generally less than a percent but has values of 2 3 in the ocean interior in the latitude ranges 35 20 s and 20 30 n this suggests that the irreversible part of the numerical vertical advection in this model configuration typically constitutes a few percent of the total the regions with the highest ratios are in the subtropics between 20 and 35 n and s and correspond quite closely to the two regions in subtropical latitudes with the high ratios of numerical to explicit diffusivity fig 8 a suggesting that these transient vertical velocities are at least partly responsible for the excessive mixing there 5 3 identification of high frequency vertical motions blaker et al 2012 analysed a comparable ¼ integration of nemo likewise forced by 6 hourly winds and identified energetic near inertial gravity waves nigws originating in the western boundary currents these are initiated by intense wind events close to the western boundary and propagate towards the equator they have high vertical coherence between the thermocline and the ocean bottom and have periods close to the inertial period wavelengths of 150 200 km and are characterised with vertical velocities between 50 and 100 m day their maximum amplitude in the atlantic is between 25 n and 45 n coinciding with the peaks of effective diffusivity described in section 4 the 15 30 h period of the nigws in this latitude range means that they would not be appreciably detectable in the 5 day output of the integration discussed here and this in turn implies that the vertical velocities shown in figs 9 and 10 significantly underestimate the transient vertical velocity field to illustrate this fig 11 shows the vertical velocities at 2000 m depth and on a section at 55 w with scales chosen to render easy comparison with fig 5 of blaker et al fig 11 a and b is an instantaneous field taken from a restart file from september of year 20 of the go5 0 integration while fig 11 c and d is the mean vertical velocity over a five day period including the instantaneous restart in the instantaneous fields zonal wavefronts can be seen south of 30 s with amplitude of up to 25 m day as well as eddy like and noise like features with substantially larger magnitudes close to the western boundary north of 35 n we remark that the corresponding figure in blaker et al shows vertical velocities of up to 100 m day the authors of that paper note the seasonality of the nigws and the arbitrarily selected date of the output data shown in fig 10 may underrepresent the typical amplitude of these waves by contrast the 5 day mean only shows the downward flow of the deep western boundary current at 40 n and a few noise like features near the shelf with the nigws not visible at all on this scale comparison of the magnitudes of vertical motions in the two timescales confirms that the 5 day averaging causes an underestimate of the short timescale vertical velocity field by up to an order of magnitude griffies et al 2000 suggest a direct relationship between numerical mixing and the vertical courant number wδt δz as we have argued above the stratification will also affect the potential of transient motions to cause numerical mixing but intuitively we might expect the proportion of irreversible advection to be related to the fraction of a grid cell across which advection carries a water parcel in a single time step the vertical grid spacing around 2000 m depth is about 150 m the resolved vertical velocity of 25 m day noted above corresponds to a displacement of 40 cm in a 1350 second model timestep and a vertical courant number of 2 5x10 3 in section 5 2 we estimated the proportion of irreversible advection in those regions where the diagnosed diapycnal diffusivity is large compared with the explicit diffusivity to be of order 10 2 that the vertical courant number in these regions is of the same order of magnitude is then unsurprising 6 summary and discussion we have applied the analysis of lee et al 2002 itself based on the isopycnal watermass transformation framework of walin 1982 to diagnose the effective diapycnal diffusivity κeff in go5 0 a 0 25 global ocean only configuration of the nemo model the diffusivity expressed as a function of potential density and latitude is compared with that prognosed by the model s vertical mixing scheme and it is found that in intermediate and deep water density classes and on the equator and in subtropical latitude bands the values are up to an order of magnitude larger than the explicit diffusivity since the latter is set by the mixing scheme of the model to give a diffusivity with a magnitude and geographical distribution consistent with observational estimates our results imply that the diapycnal mixing of the model is excessive and that it is dominated by numerical mixing as a further check the diapycnal velocity again diagnosed from the overturning circulation in density space is compared with that derived from the explicit diffusivity and with observational estimates of mixing and the former is also found to be up to ten times the explicit diapycnal velocity the standard deviation of the vertical velocity is found to have much larger magnitude than the mean vertical velocity with values of up to 10 m day in the ocean interior in the subpolar and equatorial regions we have defined an effective advective diapycnal velocity as the vertical density advection divided by the density gradient which although quantitatively similar to the vertical velocity explicitly represents the potential of transient motions to perform mixing this again is found to have large values in the same latitude and density ranges as the largest diagnosed diapycnal velocities namely the subpolar and equatorial regions and the deep and intermediate waters we interpret this as evidence that these wavelike or eddy like features are responsible for numerical mixing the ratio of the effective advective diapycnal velocity to the diapycnal velocity derived directly from the watermass transformation rate is found to be generally less than 1 but has values of a few percent in the northern and southern subtropics in density classes containing upper deep waters and lower intermediate waters in these watermasses the diagnosed diapycnal diffusivity was found to exceed the explicit diffusivity by a factor of 5 10 and we interpret this result as indicating that in these regions there is significant irreversibility in the vertical advection we may assume that the numerical diffusion described here in the go5 0 configuration of the nemo model is by no means untypical of z coordinate models with comparable resolution the method used in this paper is successful where the watermass transformation in density space is from denser to less dense water classes consistent with a diffusive flow regime on the large scale in other words that of the global deep water and bottom water overturning cells this is true over most of the model domain in particular we find that the north atlantic deep water nadw has a nearly monotonic transformation rate as it travels southward and mixes with overlying intermediate waters starting with a density of around σ 2 37 05 kg m 3 at 35 n and having around 36 95 kg m 3 at 45 s we have shown that adding a compensating term for the model drift in the form of a rate of change of isopycnal volumes as in lee et al 2002 indeed removes some of these instances at higher densities but there are still some remaining regions of apparently anti diffusive flow and in these cases the method described here fails to return a positive definite value for the diffusivity the regions of negative diffusivity in the southern ocean and north atlantic correspond to the regions characterised by high rates of transformation due to cabbeling and thermobaricity by klocker and mcdougall 2010 and we tentatively ascribe these negative values to densification by these processes the negative κeff in the tropical south atlantic however is more likely to be non physical and is probably a result either of omitting short timescale eddy motions in the volume transports or of truncation errors in space we have shown that there are large transient vertical velocities in the model with high coherence over the ocean depth which take the form of noise like features with length scales close to the model grid at subpolar latitudes eddy like structures near strong mean flows such as separated western boundary currents and the acc and near inertial gravity waves with periods shorter than the five day averaging period of the model output these have amplitudes of 25 50 m day and courant numbers of one or two percent we have defined an advective diapycnal velocity gadv as the standard deviation of the vertical advection of density divided by the vertical density gradient and interpret this as the potential of transient flows to advect density gradients a fraction of this advection will be irreversible as a result of truncation in the numerical advection scheme this has a large scale spatial structure similar to that of the diagnosed diapycnal velocity and in those regions where there is substantial numerical mixing the latter is found to have values of a few percent of the advective diapycnal velocity confirming that the irreversible fraction of the numerical advection is of this order the high levels of small length scale transient features in the vertical velocity in go5 0 may or may not be realistic certainly the presence of poorly resolved quasi mesoscale features in subpolar latitudes and in shallow coastal waters is undesirable and this variability may be reduced by increasing the bilaplacian viscosity or by changing to an alternative parameterisation that is even more focused on the finest length scales such as that of smagorinsky 1963 the better resolved mid latitude mesoscale eddies the near inertial gravity waves and the equatorial instability waves are likely to reflect corresponding features in the ocean but their associated vertical displacements will nevertheless entail strong advection across coordinate surfaces with the potential to perform numerical mixing leclair and madec 2011 formulated a scheme z tilde that permits short timescale periods less than a few days deformations in the vertical coordinate in analogy with isopycnal heave in the real ocean allowing fast waves to propagate without significant vertical advection and showed that this scheme led to a reduction in numerical mixing of up to a factor of five this option was not available in version 3 4 of nemo as used in go5 0 but is present in the latest release of version 3 6 the use of a higher order vertical advection scheme improves the effective vertical resolution of the model james 2000 and hence is likely to reduce the magnitude of numerical mixing such schemes have been implemented in hycom which allows piecewise constant piecewise linear and piecewise parabolic methods pcm plm and ppm respectively to interpolate between vertical levels within a given water column with increasing order of interpolation leading to less diffusion during the regridding of the hybrid vertical coordinate in that model bleck unpublished manuscript a piecewise parabolic method is currently available in nemo and we expect that this may well ameliorate the numerical mixing described here in summary we have identified large amounts of numerical mixing in an eddy permitting global ocean configuration based on a widely used ocean model nemo we stress that this does not implicate nemo specifically since the handling of the vertical coordinate in other depth coordinate models is likely to be similar the fact that closely related configurations are now being used in climate models and earth system models aimed at cmip6 implies that the drifts in the ocean temperature and salinity fields in such models on time scales from decades to centuries will bear a significant imprint of the numerical mixing this weakness of this model class is particularly highlighted by the development of the hybrid isopycnal coordinate model hycom which has much reduced numerical mixing and more recently of generalised coordinate arbitrary lagrangian eulerian models such as the gfdl mom6 in which the vertical coordinate may be optimised for different ocean regimes and which may be made quasi isopycnal in the ocean interior methods to ameliorate the spurious mixing in a depth coordinate model whether by making the vertical advection scheme less diffusive or by permitting quasi lagrangian elastic displacements of coordinate surfaces on short timescales are now available and can only lead to improvements in the performance of the ocean model in both forced and coupled modes acknowledgements this work was funded by natural environment research council uk national capability funding the author would like to thank george nurser for his vital input and encouragement and also remi tailleux gurvan madec and bablu sinha for their many helpful suggestions the manuscript was also substantially improved thanks to the suggestions of the two anonymous reviewers the model was integrated on the monsoon system a collaborative facility supplied under the joint weather and climate research programme which is a strategic partnership between the met office and the natural environment research council and was carried out under the joint ocean modelling programme jomp 
24137,model parameters in the suspended cohesive sediment transport models are critical for the accurate simulation of suspended sediment concentrations sscs difficulties in estimating the model parameters still prevent numerical modeling of the sediment transport from achieving a high level of predictability based on a three dimensional cohesive sediment transport model and its adjoint model the satellite remote sensing data of sscs during both spring tide and neap tide retrieved from geostationary ocean color imager goci are assimilated to synchronously estimate four spatially and temporally varying parameters in the hangzhou bay in china including settling velocity resuspension rate inflow open boundary conditions and initial conditions after data assimilation the model performance is significantly improved through several sensitivity experiments the spatial and temporal variation tendencies of the estimated model parameters are verified to be robust and not affected by model settings the pattern for the variations of the estimated parameters is analyzed and summarized the temporal variations and spatial distributions of the estimated settling velocity are negatively correlated with current speed which can be explained using the combination of flocculation process and stokes law the temporal variations and spatial distributions of the estimated resuspension rate are also negatively correlated with current speed which are related to the grain size of the seabed sediments under different current velocities besides the estimated inflow open boundary conditions reach the local maximum values near the low water slack conditions and the estimated initial conditions are negatively correlated with water depth which is consistent with the general understanding the relationships between the estimated parameters and the hydrodynamic fields can be suggestive for improving the parameterization in cohesive sediment transport models keywords sediment transport model data assimilation parameter estimation satellite observations temporal variations spatial distributions 1 introduction estuaries and coastal areas that constitute the interface among terrestrial riverine and marine environments are often characterized by a high concentration of suspended sediments miller and mckee 2004 wang et al 2013 suspended sediments are considered to exert a major influence on the water quality zhang et al 2008 ecosystem cloern 1987 may et al 2003 mclaughlin et al 2003 and geomorphic evolution jia et al 2006 fan et al 2014 therefore comprehensive and accurate knowledge of the distributions of suspended sediments is critical to the nearshore environmental prediction governance and coastal management the in situ and satellite observations are the most direct methods for acquiring the suspended sediment concentrations sscs but they only provide a local description and they are inadequate to synoptically map the sscs wang et al 2016a numerical modeling is an efficient and powerful method to obtain the spatial and temporal distributions of sscs whose development stages and applications were reviewed in papanicolaou et al 2008 and amoudry and souza 2011 amoudry and souza 2011 noted that a very important characteristic of present sediment transport models was the high degree of empiricism and another issue was the mismatch between the model results and experimental data with both advantages and limitations for the methodologies of observing and numerical modeling the data assimilation method can reduce the data model misfit to obtain comprehensive results of sscs by integrating the observations and numerical models there have been some studies on sediment transport problems by applying data assimilation methods including the direct insertion and kriging schemes stroud et al 2009 sequential assimilation using fast and cheap statistical surrogates of the model emulators margvelashvili et al 2013 optimizing model parameters by utilizing the synergy of observations and numerical models pleskachevsky et al 2005 ge et al 2015 a generic method based on the ensemble kalman filtering el serafy et al 2011 and the adjoint data assimilation yang and hamrick 2003 wang et al 2016a adjoint data assimilation was applied into the three dimensional suspended cohesive sediment transport models in yang and hamrick 2003 and wang et al 2016a but it was tested by idealized twin experiments without real observations the practical satellite derived sscs have not been assimilated to estimate the model parameters which motivated this study in the suspended cohesive sediment transport models the physical processes are parameterized by model parameters in fact the model parameters vary over a wide range in the time and space domain which has been proved by the previous works e g fennessy et al 1994 dyer et al 1996 agrawal and pottsmith 2000 xia et al 2004 jacobs et al 2011 manning and schoellhamer 2013 wang et al 2013 yang et al 2016b the model parameters were traditionally assigned to be constants recently a few model parameters have been assumed to be spatially or temporally varying in the numerical simulation of sscs such as settling velocity e g winterwerp 1998 2002 baugh and manning 2007 son and hsu 2008 xie et al 2009 ramírez mendoza et al 2014 and critical stress e g lumborg 2005 chao et al 2008 hu et al 2009a du et al 2010 van der wal et al 2010 carniello et al 2012 ge et al 2015 it should be noted that in most cases usually only one parameter was assumed to be spatially or temporally varying with the adjoint method the temporal or spatial variations of several model parameters can be estimated synchronously by assimilating observations from multiple sources especially the satellite data the adjoint method has been widely applied to estimate the model parameters in atmospheric and oceanographic models e g zou et al 1995 alekseev 2001 lu and zhang 2006 elbern et al 2007 kurokawa et al 2009 chen et al 2014 zhang and wang 2014 gao et al 2015 wang et al 2016b navon 1998 presented an important overview on the parameter estimation in meteorology and oceanography in view of applications of the four dimensional variational data assimilation method to inverse parameter estimation problems on 27 june 2010 the world s first geostationary satellite ocean color sensor the geostationary ocean color imager goci was successfully launched by the republic of korea he et al 2013 unlike the existing polar orbit satellites goci has a high spatial resolution 500 m and a very high temporal resolution 1 h eight images per day ryu et al 2011 he et al 2013 which makes it quite applicable for mapping the surface sscs however the temporal resolution is highly restricted when compared with the numerical models in addition only the surface sscs can be obtained from goci whereas a large portion of the suspended sediments are in the water column especially near the bed besides goci data might be biased due to the cloud in this paper based on a three dimensional suspended cohesive sediment transport model with the adjoint data assimilation developed in wang et al 2016a the goci retrieved sscs are assimilated in the hangzhou bay hzb china the adjoint data assimilation method can not only improve the simulation results of sscs but also synchronously estimate the spatially and temporally varying model parameters emphasis is placed on the analyses of the temporal variations and spatial distributions of the estimated model parameters in the remainder of the paper the numerical model with adjoint data assimilation and satellite remote sensing data are described in section 2 the experiments and the model results are presented in section 3 the discussions of the estimated results of model parameters and this study can be found in section 4 the final conclusions are presented in section 5 2 models and observations 2 1 the suspended cohesive sediment transport model consider a domain ω which covers a region of the estuarine and coastal water the sscs at the initial time in this domain are c 0 let n be the vector normal to the boundaries there are three types of boundaries including the inflow open boundary ω1 the outflow open boundary ω2 and the solid boundary ω3 the evolution of sscs is described by the three dimensional advection diffusion equation with vertical particle settling which is described as follows wang et al 2016a 1 c t u c x v c y w c h σ x k h c x y k h c y h σ k v c h σ w s c h σ 2 c ω 1 c o b c 3 c n ω 2 0 4 c n ω 3 0 5 c t 0 c 0 where c represents the ssc t is the time x y are the horizontal coordinates σ is the vertical coordinate 0 for the bottom and 1 for the surface h is the total water depth including the undisturbed water depth and the sea surface elevation u v and w are the flow velocity components in the x y and σ directions respectively kh and kv are the horizontal and vertical diffusivity coefficients respectively ws denotes the suspended cohesive sediment settling velocity and cobc denotes the sscs at the inflow open boundary at the sea surface the no flux boundary condition is applied which is written as 6 w s c k v h c σ 0 σ 1 at the bottom of the water column the cohesive sediment flux is equal to the combination of erosion and deposition which is described as 7 w s c k v h c σ e d σ 0 where e and d are the erosion rate and deposition rate respectively which are calculated with the well known partheniades krone formulations partheniades 1965 8 e m 0 τ b τ c e 1 τ b τ c e 0 τ b τ c e 9 d w s c 1 1 τ b τ c d τ b τ c d 0 τ b τ c d where m 0 is the resuspension rate τb is the bottom shear stress τce and τcd are the critical shear stress for erosion and deposition respectively and c 1 is the sscs near the bottom eqs 1 9 are referred to as the forward model of suspended cohesive sediment transport the numerical schemes for solving the forward model are given in wang et al 2016a 2 2 the adjoint model a cost function is defined to describe the difference between the modeled and observed sscs wang et al 2016a 10 j 1 2 i j k n w i j k n c i j k n c i j k n 2 where c i j k n and c i j k n are the simulated and observed sscs at the i j k grid point at the n th time step respectively w is the weighting matrix and theoretically should be the inverse of the observation error covariance matrix which can be simplified by assuming that the errors of the data are uncorrelated and equally weighted yu and o brien 1992 in the present study the elements in w are 1 where observations are available and 0 otherwise the lagrangian function is defined as 11 l j i j n k 1 k λ i j k n discretization of left side of eq 1 right side of eq 1 λ i j 0 n λ i j 1 n 2 discretization of right side of eq 2 left side of eq 2 λ i j k n λ i j k 1 n 2 discretization of right side of eq 3 left side of eq 3 where λ denotes the adjoint variable of c k is the total vertical layers for the water column and there is one false layer at the bottom numbered 0 while k 1 represents the false layer at the surface according to the theory of the lagrangian multiplier method the first order derivate of the lagrangian function with respect to the variables and parameters should be zero to minimize the cost function thacker and long 1988 12 l λ i j k n 0 13 l c i j k n 0 14 l p i j k n 0 where p denotes the parameters in the suspended cohesive sediment transport model including kh kv ws m 0 cobc τce τcd and c 0 in fact eq 12 returns the discretization of eq 1 from eq 13 the discrete adjoint model can be derived which governs the evolution of the adjoint variable λ from eq 14 gradients of the cost function with respect to the model parameters are obtained the detailed formulae of the adjoint model and the gradients can be found in wang et al 2016a the minimization algorithm used in the adjustment of parameters is the steepest descent method sdm which is described as follows zhang and lu 2010 15 p k 1 p k β g k g max k where p is the vector of a model parameter arranged in a sequence k is the kth iteration step of data assimilation β is the positive step size g is the negative of the gradient vector of cost function with respect to the model parameter p which can be obtained from eq 14 g max is the l norm of g the sdm is especially efficient and useful when the dimension of parameter space is large zhang and lu 2010 as concluded by elbern et al 2007 and some other works the validity of the data assimilation should be tested by independent observations which were not assimilated but only for verification in this work one tenth of the observations were randomly selected as checking observations cos and the remaining observations were assimilating observations aos which were assimilated into the model the adjoint method is implemented with the following steps step 1 initial guess values of the model parameters are prescribed step 2 the forward sediment transport model is integrated forward in time with the given values of model parameters step 3 the cost function indicated by eq 10 is calculated from the difference between the simulated sscs and aos step 4 driven by the difference between the model results and aos the adjoint model derived from eq 13 is integrated backward in time and the adjoint variables are calculated step 5 the model parameters are adjusted using the sdm and the values of parameters are updated step 6 a certain criterion is set to check whether the cost function has satisfied the requirement of minimization if the criterion is satisfied the iteration will be terminated otherwise return to step 2 the corresponding flowchart is shown in fig 1 in this study the step size in eq 15 is set to be 3 of the initial guess values of the corresponding model parameters to expediently adjust several model parameters synchronously in addition the stop criterion is the difference of cost functions normalized by the values at the first iteration step between the last two steps is less than 3 0 10 5 with a maximum value of 300 for iteration steps 2 3 satellite remote sensing observations he et al 2013 developed a practical atmospheric correction algorithm and a regional empirical algorithm to generate hourly sscs from goci data in the hzb which were validated to be well compared with the in situ buoy observations in this study four days 26 and 27 june 2011 during neap tide 24 and 25 march 2015 during spring tide of sscs retrieved from goci firstly had their median filtering dealt with to reduce the noises near the edge of cloud and then the results were taken as the observations which were called goci retrieved sscs hereinafter 2 4 model settings in this study the suspended cohesive sediment transport model was coupled to the finite volume coastal ocean model fvcom chen et al 2003 which provided the hydrodynamic background fields considering the significant exchange of water between the yangtze estuary and the hzb the model area of fvcom covered the yangtze estuary the hzb and the western part of the east china sea r1 in fig 2 in the vertical dimension four uniform sigma layers were used tidal forcing with eight primary tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 were used at the seaward open boundaries in which the nodal modulation corrections were included the changjiang river and qiantang river runoff were included as river boundary conditions by using the daily river discharge the era interim wind field dee et al 2011 was taken as the surface wind forcing the temperature and salinity were not calculated in the hydrodynamic model for the suspended cohesive sediment transport model the study area was the hzb r2 in fig 2 the horizontal resolution was 0 006 0 006 there were four uniform sigma layers in the vertical direction which were the same as those in the fvcom in the forward model the integral time step was 180 s and the total simulation time was 31 h starting from 0028 utc 26 june 2011 during neap tide and 0028 utc 24 march 2015 during spring tide which were the same as those in the adjoint model the default parameter settings of the cohesive sediment transport model are described as follows the modeling results of sediment transport are sensitive to the initial conditions wang et al 2016a therefore the accurate specification of the initial values of the sscs is important for the sediment transport simulation over short time periods lee et al 2007 yang et al 2016a in this paper the initial conditions were obtained by interpolating the sscs from both satellite and ship measurements there are some values lacked in cloud covered areas at 0028 utc 26 june 2011 and 0028 utc 24 march 2015 therefore all the goci retrieved surface sscs were temporally averaged and the results were spatially interpolated using the nearest neighbor interpolation method to obtain the initial surface sscs during neap tide and spring tide which were shown in fig 3 the in situ sscs were observed at four stations including s1 s2 s4 and s7 see fig 2 in the north of the hzb the observed sscs at s1 and s2 started at 1000 utc 9 may 2005 and ended at 1012 utc 10 may 2005 the observed sscs at s4 and s7 were during the period 0500 utc 8 may 0700 utc 9 may 2005 the water samples at these stations were collected about hourly from three to five layers which were then used to derive sscs through filtration by using 0 45 μm filters the observed sscs were vertically interpolated into the four layers and the mean values were linearly decreased with the number of vertical layers as follows c 1 8870 0 3764 k where k was the number of vertical layers according to the fitting formula the initial sscs at the other layers were given by multiplying the initial surface sscs with coefficients 4 9476 0 9869 k the western open boundaries were taken as the inflow open boundary at which the input sscs were set to 0 15 kg m3 during neap tide according to mwrprc 2011 and 0 1 kg m3 during spring tide according to mwrprc 2015 the seaward open boundaries were taken as the outflow open boundary based on the in situ observations tang 2007 pointed out that the floc settling velocity varied in the order of magnitude of 10 4 10 3 m s in the hzb which was similar to those observed in the yangtze estuary that near the hzb in shi and zhou 2004 and yang et al 2016b meanwhile the settling velocity of the dispersed sediment was about in the order of magnitude of 10 5 m s therefore the default value of the settling velocity was set to 1 0 10 4 m s and the variation range during parameter estimation was from 1 0 10 5 m s to 5 0 10 3 m s according to hu et al 2009a and xie et al 2009 the resuspension rate was set to 3 0 10 6 kg m2 s and the variation range during parameter estimation was from 1 0 10 6 kg m2 s to 1 0 10 4 kg m2 s according to einstein 1950 and hu et al 2009a the critical stresses for erosion and deposition were set to be equal which were set to 0 4 n m2 consistent with the range of critical stress in hu et al 2009a the horizontal and vertical diffusivity coefficients were assigned according to the dimensional analysis wang et al 2016a 3 experiments and results 3 1 verification of hydrodynamic field the accuracy of the suspended cohesive sediment transport model is strongly contingent upon the degree of accuracy of the flow field mehta et al 1989b xie et al 2009 the observations of water level and flow velocity were collected during 29 february 2012 to 16 march 2012 the stations located in the southeast of the hzb as shown in fig 2 the hydrodynamic model was run from 1 february 2012 and the initial 28 days were for spinning up in the northeast of the hzb harmonic constants of each constituent analyzed from the simulated water levels of 30 days were compared with the observed data at tidal gauge stations shown in fig 2 at all the stations the relative errors for amplitude and phase lag were less than 15 in addition the modeled water levels of six stations including shuang he shan shs dai shan ds da yu shan dys yan wo shan yws xi ken shan xks and zhai zi shan zzs were compared with the observations in fig 4 the results showed that the simulated water levels at all these stations were in good agreement with the observations especially during spring tide the simulated depth averaged flow velocity and direction agreed well with the observations at station 1 regardless of the tidal conditions fig 5 the depth averaged flow velocities were slightly underestimated at stations 2 and 3 fig 5 overall the simulated results were acceptable to drive the suspended cohesive sediment transport model for this study 3 2 data assimilation and results two groups of experiments were carried out to assimilate the goci retrieved sscs in which the experiments during neap tide 26 and 27 june 2011 were numbered with prefix n while s was used for spring tide 24 and 25 march 2015 to verify the effect of data assimilation benchmark experiments with index n01 and s01 in which the data assimilation was not used and all the model parameters were set to the default values as described in section 2 4 were carried out conversely in n02 and s02 the data assimilation was implemented and the initial guess values of the model parameters were set to the default values which were the same as those in n01 and s01 the insensitive parameters concluded in wang et al 2016a including the horizontal and vertical diffusivity coefficients were not estimated whether the critical shear stresses for erosion and deposition were equal was still a point of controversy which was disparate in different suspended cohesive sediment transport models therefore the critical shear stresses for erosion and deposition were also not estimated on the contrary the other parameters were supposed to be spatially and temporally varying which were estimated synchronously the detailed model settings of these experiments are listed in table 1 the cost function normalized by the value at the first iteration step and the l 1 norm of gradients of cost function with respect to the estimated parameters are shown in fig 6 in addition the mean absolute errors maes between the simulated sscs and goci retrieved sscs during neap tide and spring tide are listed in tables 2 and 3 respectively for n02 s02 the normalized cost function tended to be stable and was less than 0 63 0 22 after 207 72 iterations see fig 6a and f the mae between the simulated sscs and aos was 6 61 10 2 kg m3 2 04 kg m3 before data assimilation which was the same as that in n01 s01 after assimilation the mae was decreased to 3 76 10 2 kg m3 8 09 10 1 kg m3 in n02 s02 indicating that the model performance was improved with a reduction of 43 12 60 34 in overall simulation error besides the mae between the simulated sscs and cos was reduced to 3 79 10 2 kg m3 8 06 10 1 kg m3 from an initial value of 6 64 10 2 kg m3 2 05 kg m3 in n02 s02 further showing a significant improvement when applying data assimilation the l 1 norm of gradients of cost function with respect to estimated parameters including settling velocity resuspension rate inflow open boundary conditions and initial conditions were reduced stably and largely during the iteration steps fig 6b e for n02 and fig 6g j for s02 indicating that the adjustments of model parameters were effective and the model performance was fairly good the temporally averaged values of the simulated surface sscs at the observed time before data assimilation are shown in fig 7 a fig 8 a while fig 7b fig 8b for those after assimilation in n02 s02 as shown in he et al 2013 the surface sscs retrieved from goci were not continuous and the values were lacked in cloud covered areas the hourly satellite data were first interpolated to obtain the spatial distribution of surface sscs at every observed time and then temporally averaged the averaged values of goci retrieved surface sscs are shown in fig 7c fig 8c in n02 s02 in n02 and s02 the simulated surface sscs after data assimilation had the similar spatial features with the sscs retrieved from goci in which the high values of sscs were near the andong tidal flat and the low values were near the north land boundaries conversely the simulated surface sscs before data assimilation were much larger than the goci retrieved sscs in most areas the correlation coefficient between the simulated and goci retrieved surface sscs was 0 57 0 72 before data assimilation while 0 79 0 85 after data assimilation in n02 s02 showing that the spatial features of the satellite remote sensing data can be reproduced by the modeling results after data assimilation besides the temporally averaged values of the maes between the goci retrieved surface sscs and the corresponding simulated results before data assimilation are shown in fig 7d fig 8d while fig 7e fig 8e for those after assimilation in n02 s02 it was obvious that in n02 and s02 the temporally averaged maes after data assimilation were less than those before data assimilation in almost all the spatial points and less than the temporally averaged values of goci retrieved surface sscs in all the spatial points except those near the south land boundaries indicating that the data assimilation can effectively improve the simulation results during both neap tide and spring tide overall during neap spring tide the simulated sscs after data assimilation in n02 s02 were much closer to the goci retrieved sscs than those before data assimilation in n01 s01 demonstrating that the adjoint data assimilation can improve the model performance and provide a possible method to synchronously estimate the parameters in suspended cohesive sediment transport models 3 3 sensitivity experiments in n02 and s02 the estimation results of the model parameters may be affected by the model settings therefore several numerical experiments were carried out to test the sensitivity of the estimation results to the model settings including the selection of the estimated parameters n11 n13 and s11 s13 the initial guess values and the magnitude of smoothness n21 n24 and s21 s24 and the assimilated observations n31 and s31 to eliminate the contingency introduced by data selection the aos in n02 s02 were equally divided into nine parts then every part was taken as cos and the remaining observations were aos so there were nine new experiments in n31 s31 finally the averaged values of these nine experiments were taken as the results of n31 s31 the detailed model settings of the sensitivity experiments are shown in table 1 the maes between the simulated sscs and the goci retrieved sscs and the correlation coefficients between the estimated parameters in n02 s02 and those in the sensitivity experiments were calculated to test the robustness of the parameter estimation which were shown in table 2 table 3 for all the experiments during neap tide and spring tide the maes were decreased substantially and the simulated results of sscs were improved effectively furthermore all the correlation coefficients between the estimated parameters in n02 s02 and those in sensitivity experiments were larger than 0 7 0 9 although the model settings in the sensitivity experiments were different from those in n02 s02 during neap spring tide the spatial and temporal variations of the estimated parameters in all the experiments were similar to each other indicating that the spatial and temporal variation tendencies of the estimated model parameters were robust and not affected by the model settings 3 4 temporal variations and spatial distributions of the estimated parameters in this study the hydrodynamic field was obtained by running fvcom in which the variations of temperature and salinity were not included besides zhou and gao 2004 pointed out that for very low sscs of the order of 0 1 0 7 kg m3 the settling velocity was independent of sscs as the aggregates or particles settled independently without much mutual interference therefore the effects of sscs were not considered when the variations of the estimated parameters were analyzed in the following analyses it was assumed that water level current speed and water depth were the basic factors influencing the variations of the estimated parameters the temporal variability of the spatially both horizontally and vertically averaged height above seabed current speed and the estimated parameters in n02 and s02 smoothed with a 1 h moving filter are shown in fig 9 the estimated settling velocity reached the local maximum value about 0 15 h before slack water at either low or high water during neap tide see fig 9a while 0 075 h during spring tide see fig 9d during both neap and spring tides the estimated settling velocity first decreased and then increased during the flood and ebb stages in addition the duration of the decrease was much longer than that of the increase in the flood tide which was opposite in the ebb tide see fig 9a and d during both neap and spring tides the estimated resuspension rate was negatively correlated with the current speed and the maximum values occurred near the slack water at either low or high water see fig 9b and e during both neap and spring tides the estimated inflow open boundary conditions reached the maximum values near the low water slack conditions see fig 9c and f the aforementioned relations were the same for both of the stages with and without observations and more obvious during the stage without observations which was shown by the section between the two green lines in each subgraph of fig 9 in order to intuitively show the relationship between the temporal variations of the estimated parameters and the temporal variations of water level and current speed these spatially averaged variables during the time when there were not observations were phase averaged using the methods in voulgaris and meyers 2004 and murphy and voulgaris 2006 and the results are shown in fig 10 all the phenomena obtained from fig 9 can also be seen in fig 10 the correlation coefficients between the temporal variations of current speed and the temporal variations of the estimated parameters including settling velocity and resuspension rate were 0 86 and 0 88 during neap tide while 0 78 and 0 96 during spring tide it can be concluded that the temporal variations of the estimated parameters were closely related with the water level and the current speed during both neap and spring tides the hydrodynamic field and the estimated parameters were first vertically averaged and then phase averaged during the time when there were not observations in n02 and s02 the results smoothed by a 25 point average are shown in fig 11 the spatial distribution of the estimated settling velocity fig 11a and d was significantly positively r 0 81 during neap tide and r 0 90 during spring tide correlated with the estimated resuspension rate fig 11b and e which was similar to the relationship in the temporal variations the current speed fig 11c and f was related with these two parameters especially the resuspension rate the correlation coefficients between the current speed and the estimated parameters including settling velocity and resuspension rate were 0 60 and 0 72 during neap tide while 0 60 and 0 77 during spring tide during both neap and spring tides the values of the estimated initial conditions were higher near the south land boundary and lower near the north land boundary fig 11g and h in addition the minimum values were located near the maximum value of water depth indicating that the initial sscs were negatively 0 43 during neap tide and 0 44 during spring tide correlated with the water depth fig 11i on the whole no matter during spring tide or neap tide both temporal variations and spatial distributions of the estimated parameters were significantly correlated with the hydrodynamic fields in detail both temporal variations and spatial distributions of the estimated settling velocity and resuspension rate were negatively correlated with the current speed the temporal variations of the estimated inflow open boundary conditions were related to the water level which reached the maximum values near the low water slack conditions besides the spatial distribution of the estimated initial conditions was negatively correlated with the water depth 4 discussions 4 1 mechanisms for temporal variations and spatial distributions of the estimated parameters at present there are not enough direct measurements of the model parameters to verify the estimated results the following analyses are carried out trying to explain the mechanisms for temporal variations and spatial distributions of the estimated parameters the suspended fine grained sediments are predominantly in flocculated form impacting the settling velocity characteristics of the sediment in estuaries gibbs et al 1989 van leussen 1997 milligan et al 2001 voulgaris and meyers 2004 according to stokes law the settling velocity of a spherical particle should depend on its size and its effective density which has been successfully applied to flocculated particles using the original or modified versions e g winterwerp 1998 manning and dyer 1999 mikkelsen and pejrup 2001 the previous studies e g sternberg et al 1999 mikkelsen and pejrup 2001 voulgaris and meyers 2004 strom and keyvani 2011 suggested an increase of settling velocity with increasing floc size which was also obtained in the xuliujing of yangtze estuary cheng et al 2005 and pearl river estuary xia et al 2004 china therefore the floc size and sediment size will be positively correlated with the settling velocity in a tidal cycle the tidal current plays an important role in the particle size of suspended sediments li et al 2000 flocculation or aggregation li et al 1996 hu et al 2009b and mean floc diameter verney et al 2011 verney et al 2011 conducted a laboratory experiment to investigate the behavior of a population of flocs during an idealized tidal cycle while considering turbulence which was one key parameter controlling the flocculation processes they found that shear rate which was positively correlated with the current velocity controlled the balance between the aggregation and fragmentation processes and therefore the variation in shear rate caused an inverse change in the mean floc diameter besides based on the in situ observations in the south passage of the yangtze estuary tang 2007 found that the temporal variations of the mean floc diameter were negatively correlated with the current speed therefore there is a negative relationship between the current speed and the sizes of suspended flocs and sediments according to a combination of stokes law and the aforementioned results from the laboratory experiments and in situ observations the variations of settling velocity are negatively correlated with the current speed which has also been demonstrated by the temporal variations and spatial distributions of the estimated settling velocity see figs 10a d and 11 the floc behavior was asymmetrical during the flood and ebb stages of the tidal cycle in verney et al 2011 which was similar to the asymmetrical temporal variations of the estimated settling velocity in this study verney et al 2011 attributed it to the different time scales for the aggregation and fragmentation processes although the flocculation process was not considered in the suspended cohesive sediment transport model in this study the flocculation process can be included implicitly through changes in the settling velocity of fine sediments which has also been employed in previous literatures e g mehta 1986 lick et al 1993 van leussen 1994 the value of resuspension rate is a function of the bed density porosity composition consolidation and evolution of the sediment under the complex and mixed effects of the physical and biological interaction ge et al 2015 the resuspension rate is parameterized as a removal capability of soil material from the seabed surface due to the hydrodynamic induced shear stress ge et al 2015 which was termed the erodibility constant in hayter and mehta 1986 resuspension of cohesive sediment depends not only on the magnitude of applied bed shear stress but also on the seabed erodibility you 2005 on one hand the consolidating soft deposit and the settled consolidated firm bed are the two basic statuses of the seabed in addition gelling and consolidation of the deposit and the associated physicochemical changes eventually result in a settled bed with higher shear strength and more stable structural configuration mehta et al 1989a for a certain shear stress less sediment is resuspended from a fully consolidated bed than from a freshly deposited bed you 2005 on the other hand zhang et al 2017 investigated the erodibility of fluidized cohesive sediments from the seabed of hzb experimentally in unidirectional open flows in their results the critical shear stress for erosion was negatively correlated with the resuspension rate named erosion parameter in their paper which were related with the yield stress by analyzing the data set describing in situ erosion test in baltimore harbor sanford and maa 2001 pointed out that the critical shear stress for erosion increased as the total eroded mass increased indicating that the resuspension rate decreased with erosion depth according to the relationship in zhang et al 2017 sediment in the hzb is predominantly composed of fine and medium silt and transported in suspension xie et al 2009 so the consolidating deposit will be located above the settled consolidated bed in the hzb which results in sediments near the surface being less compacted and relatively easy to be resuspended while sediments below are more compacted and more difficult to be resuspended ziegler and lick 1988 based on the observations at two fixed stations in the south channel of the yangtze estuary which was near the hzb jiang et al 2002 pointed out that during the acceleration phase of flood tide or ebb tide when the current velocity became larger the sediments in the seabed were resuspended and stirred into the water column so the volume weight of the sediments in the seabed was increased which resulted in the resuspension of the sediments in the seabed becoming much more difficult chen et al 2004 collected the sediment samples in the surface of the seabed at a site along the north bank of the hzb and found that the sediment sizes were finer during the accumulation period and coarser during erosion period therefore when the shear stress is larger than the critical value erosion occurs and the sediment sizes in the seabed surface become coarser and more difficult to enter the water column which results in a small resuspension rate conversely the resuspension rate will reach the local maximum value during slack water conditions which has also been shown in the temporal variations and spatial distributions of the estimated resuspension rate see figs 10b e and 11 during the flood stage of the tidal cycle the tidal wave reaches the west open boundary and prevents the inflow sscs from qiantang river so the inflow open boundary conditions decrease and this process can continue until the end of the ebb acceleration phase after that the sscs from qiantang river increase and reach the maximum value during low water slack conditions as shown in fig 10c and f the estimated initial sscs are negatively correlated with the water depth see fig 11g i which is similar to the results obtained from in situ observations and satellite measurement in cai et al 2015 and mao et al 2016 although not exactly equal the estimated model parameters during neap and spring tides have shown similar temporal variations and spatial distributions as given in section 3 4 it indicates that the spatial and temporal variation tendencies of the estimated model parameters are robust and can be applied to different tidal conditions more importantly the estimated results during both spring tide and neap tide conform to the aforementioned physical mechanisms showing that the assignment of model parameters in the suspended cohesive sediment transport models can be realized with the adjoint data assimilation method by incorporating ssc observations and dynamics of the physical process 4 2 the general pattern in a tide cycle the general pattern for the temporal variations of model parameters in a tidal cycle for the hzb which is a typical macro tidal estuary is summarized based on the modeling results in section 3 4 and the analyses in section 4 1 as follows shown in fig 12 1 during the acceleration phase of the flood tide when the current velocity becomes larger stage i in fig 12 the resuspension will occur so the fine sediments at the surface of seabed will be stirred into the water column after that the sediments at the surface of seabed will become coarser which introduces a small resuspension rate meanwhile the increasing shear rate in the water column can promote the fragmentation of the floc also because more fine sediments enter the water column from seabed both the suspended floc size and sediment size will become smaller which results in a small settling velocity according to stokes law these processes will last into the stage where the current velocity reaches the maximum during the flood tide stage ii in fig 12 during which the resuspension rate and settling velocity will be the local minimum 2 when the flood current decreases stage iii in fig 12 the aggregation progressively counterbalances the fragmentation and consequently the suspended floc size will become larger which makes the settling velocity gradually increase according to stokes law on the other hand at a low flow condition the fine sediment will deposit to the seabed which can lead to a larger resuspension rate 3 during the high water slack condition stage iv in fig 12 the suspended floc size will reach its maximum value and correspondingly the settling velocity also reaches the local maximum meanwhile as the proportion of fine sediments at the seabed becomes large the resuspension rate reaches the local maximum after this stage the flocs will settle rapidly 4 the pattern during the ebb tide is quite similar to that in the flood stage except for the asymmetry that is displayed in fig 10a and d which may be related to the different time scales for the aggregation and fragmentation processes verney et al 2011 or the different sediment sources due to horizontal advection wang and xue 1990 besides the inflow open boundary conditions reach its local maximum value near the low water slack condition because of the interaction of tidal current and riverine current 4 3 prospects and limitations of this study 4 3 1 prospects the satellite data have significantly promoted the theory of physical oceanography for example combined with the numerical model the satellite altimetry has reopened the problem of how tidal dissipation is allocated munk 1997 and led the ocean research to an age of altimetry ray 2001 compared with the traditional in situ measurements the satellite derived sscs can increase the horizontal coverage and duration of observations it can be believed that the satellite data of sscs can also improve the theory and modeling of sediment transport and the related morphology evolution especially after increasing the data accuracy this work belongs to the initial attempts to assimilate the satellite derived sscs into the three dimensional suspended cohesive sediment transport model by employing the adjoint method in previous works e g stroud et al 2009 warner et al 2010 bian et al 2013 zeng et al 2015 the model parameters in suspended sediment transport models were set to be constant or based on the empirical formula which may introduce modeling errors when the adjoint data assimilation method is implemented the model parameters can be assumed to be spatially and temporally varying which can reveal the physics of the model parameters that are affected by the time and space dependent sediment characteristics and hydrodynamic forcing in addition the model parameters can be estimated iteratively and automatically rather than adjusted by experience which can improve the efficiency and accuracy as parameter estimation using the adjoint method is based on rigorous mathematical theory the estimated model parameters can improve the simulation results as shown in this study if enough observations can be obtained especially when continuous observations are available in the time dimension data assimilation can be extended to a longer time period as the prediction models of temperature salinity and water level in physical oceanography once the long term simulations of sscs can be accurately carried out it can not only improve the knowledge of the suspended sediment transport processes but also benefit the long term evolution of oceanic morphology which in turn can improve the hydrodynamic simulations 4 3 2 limitations it is necessary to point out that some respects related to data assimilation and model development are restricted in this study which should be further improved in future studies the limitations of this study will be discussed from the following three aspects 1 only the goci retrieved sscs were used for assimilation and independent verification in which the observational error was relatively large for extremely turbid waters he et al 2013 in future studies the contemporaneous in situ observations of sscs are needed to supplement the information in the vertical direction and provide further quality checks 2 the suspended cohesive sediment transport model with the adjoint data assimilation is off line coupled to the hydrodynamic model in this study on the one hand the temperature and salinity are not calculated in the hydrodynamic model and the interaction between the hydrodynamic fields and the suspended sediments is not considered brown et al 2015 pointed out that it was necessary to consider the baroclinic influence even within a hyper tidal region with low freshwater inflow for accurate particle tracking studies on the other hand only the relationships between the estimated parameters and the hydrodynamic fields including current speed water level and water depth are analyzed the obtained relationships are suggestive for improving the parameterization in suspended cohesive sediment transport models especially for areas like the hzb nevertheless there are other factors affecting the model parameters salinity temperature and sscs can also influence the settling velocity dyer 1986 tang 2007 wan et al 2015 the relationships between the settling velocity and salinity are highly dependent on specific environmental conditions for example salinity has no significant effect on the settling velocity in the elbe estuary chen et al 1994 and the amazon continental shelf berhane et al 1997 while salinity shows a noticeable impact on the settling velocity in the yangtze estuary in different forms e g tang 2007 wan et al 2015 and in the pearl river estuary xia et al 2004 for the relationship between the settling velocity and temperature owen 1972 and lau 1994 obtained the opposite results both tang 2007 and wan et al 2015 pointed out that increasing temperature had a positive effect on the settling velocity in the yangtze estuary consequently an on line coupled hydrodynamic and suspended sediment transport model with the adjoint data assimilation is required in future studies for one thing the effects of suspended sediments on hydrodynamic fields including baroclinic forcing effects turbulence damping effect and bottom boundary layer effect ma et al 2014 can be considered for another the potential complicated relationships between the model parameters and the multifarious influence factors can be further explored for example by using the on line coupled model the temporal variations and spatial distributions of the estimated settling velocity may be related to not only the current speed but also the salinity besides the temporal variations of the estimated inflow open boundary conditions may be clearly explained using the variations of salinity near the river mouth 3 compared with the traditional simulation of sscs the participation of adjoint data assimilation which needs more computation resources and computation time challenges the computer hardware and the parallel technique especially for long term simulation the introduction of the advanced parallel techniques and the improved algorithms should be done in the future improvement of the present model 5 conclusions in this study four days 26 and 27 june 2011 during neap tide 24 and 25 march 2015 during spring tide of sscs retrieved from goci were assimilated into a three dimensional cohesive sediment transport model with adjoint data assimilation developed in wang et al 2016a to simulate the sscs and synchronously estimate four spatially and temporally varying model parameters in the hzb in china in addition several sensitivity experiments were carried out to test the sensitivity of the estimation results to the model settings the results of the numerical experiments showed that during both neap tide and spring tide the model performance was significantly improved by assimilating the goci retrieved sscs see tables 2 and 3 in addition the simulated sscs after data assimilation reasonably reproduced the spatial variations of the goci retrieved sscs see figs 7 and 8 besides the temporal and spatial variation tendencies of the estimated model parameters were robust and not affected by the model settings see tables 2 and 3 the temporal variations and spatial distributions of the estimated parameters were significantly correlated with the hydrodynamic fields in detail the temporal variations and spatial distributions of the estimated settling velocity and resuspension rate were negatively correlated with the current speed see figs 10 and 11 the main reason was that when the current velocity became larger the sediments at the surface of seabed will become coarser which introduced a small resuspension rate meanwhile because the increasing shear rate in the water column can promote the fragmentation of floc and more fine sediments entered the water column from the seabed the settling velocity decreased according to stokes law see fig 12 it was the reverse when the current velocity decreased besides the estimated inflow open boundary conditions reached the local maximum value near the low water slack condition because of the interaction of tidal and riverine current see fig 12 the spatial distributions of the estimated initial conditions were negatively correlated with the water depth see fig 11 which was similar to the results obtained from the satellite data and in situ data acknowledgments the authors would like to thank the three anonymous reviewers for their constructive suggestions to greatly improve the manuscript financial support to this study is provided by the national key research and development program of china grant numbers 2017yfc1404000 2017yfa0604100 and 2016yfc1402304 the natural science foundation of zhejiang province grant number ly15d060001 the key research and development program of shandong province grant number 2016zdjs09a02 and the national natural science foundation of china grant number 41206001 
24137,model parameters in the suspended cohesive sediment transport models are critical for the accurate simulation of suspended sediment concentrations sscs difficulties in estimating the model parameters still prevent numerical modeling of the sediment transport from achieving a high level of predictability based on a three dimensional cohesive sediment transport model and its adjoint model the satellite remote sensing data of sscs during both spring tide and neap tide retrieved from geostationary ocean color imager goci are assimilated to synchronously estimate four spatially and temporally varying parameters in the hangzhou bay in china including settling velocity resuspension rate inflow open boundary conditions and initial conditions after data assimilation the model performance is significantly improved through several sensitivity experiments the spatial and temporal variation tendencies of the estimated model parameters are verified to be robust and not affected by model settings the pattern for the variations of the estimated parameters is analyzed and summarized the temporal variations and spatial distributions of the estimated settling velocity are negatively correlated with current speed which can be explained using the combination of flocculation process and stokes law the temporal variations and spatial distributions of the estimated resuspension rate are also negatively correlated with current speed which are related to the grain size of the seabed sediments under different current velocities besides the estimated inflow open boundary conditions reach the local maximum values near the low water slack conditions and the estimated initial conditions are negatively correlated with water depth which is consistent with the general understanding the relationships between the estimated parameters and the hydrodynamic fields can be suggestive for improving the parameterization in cohesive sediment transport models keywords sediment transport model data assimilation parameter estimation satellite observations temporal variations spatial distributions 1 introduction estuaries and coastal areas that constitute the interface among terrestrial riverine and marine environments are often characterized by a high concentration of suspended sediments miller and mckee 2004 wang et al 2013 suspended sediments are considered to exert a major influence on the water quality zhang et al 2008 ecosystem cloern 1987 may et al 2003 mclaughlin et al 2003 and geomorphic evolution jia et al 2006 fan et al 2014 therefore comprehensive and accurate knowledge of the distributions of suspended sediments is critical to the nearshore environmental prediction governance and coastal management the in situ and satellite observations are the most direct methods for acquiring the suspended sediment concentrations sscs but they only provide a local description and they are inadequate to synoptically map the sscs wang et al 2016a numerical modeling is an efficient and powerful method to obtain the spatial and temporal distributions of sscs whose development stages and applications were reviewed in papanicolaou et al 2008 and amoudry and souza 2011 amoudry and souza 2011 noted that a very important characteristic of present sediment transport models was the high degree of empiricism and another issue was the mismatch between the model results and experimental data with both advantages and limitations for the methodologies of observing and numerical modeling the data assimilation method can reduce the data model misfit to obtain comprehensive results of sscs by integrating the observations and numerical models there have been some studies on sediment transport problems by applying data assimilation methods including the direct insertion and kriging schemes stroud et al 2009 sequential assimilation using fast and cheap statistical surrogates of the model emulators margvelashvili et al 2013 optimizing model parameters by utilizing the synergy of observations and numerical models pleskachevsky et al 2005 ge et al 2015 a generic method based on the ensemble kalman filtering el serafy et al 2011 and the adjoint data assimilation yang and hamrick 2003 wang et al 2016a adjoint data assimilation was applied into the three dimensional suspended cohesive sediment transport models in yang and hamrick 2003 and wang et al 2016a but it was tested by idealized twin experiments without real observations the practical satellite derived sscs have not been assimilated to estimate the model parameters which motivated this study in the suspended cohesive sediment transport models the physical processes are parameterized by model parameters in fact the model parameters vary over a wide range in the time and space domain which has been proved by the previous works e g fennessy et al 1994 dyer et al 1996 agrawal and pottsmith 2000 xia et al 2004 jacobs et al 2011 manning and schoellhamer 2013 wang et al 2013 yang et al 2016b the model parameters were traditionally assigned to be constants recently a few model parameters have been assumed to be spatially or temporally varying in the numerical simulation of sscs such as settling velocity e g winterwerp 1998 2002 baugh and manning 2007 son and hsu 2008 xie et al 2009 ramírez mendoza et al 2014 and critical stress e g lumborg 2005 chao et al 2008 hu et al 2009a du et al 2010 van der wal et al 2010 carniello et al 2012 ge et al 2015 it should be noted that in most cases usually only one parameter was assumed to be spatially or temporally varying with the adjoint method the temporal or spatial variations of several model parameters can be estimated synchronously by assimilating observations from multiple sources especially the satellite data the adjoint method has been widely applied to estimate the model parameters in atmospheric and oceanographic models e g zou et al 1995 alekseev 2001 lu and zhang 2006 elbern et al 2007 kurokawa et al 2009 chen et al 2014 zhang and wang 2014 gao et al 2015 wang et al 2016b navon 1998 presented an important overview on the parameter estimation in meteorology and oceanography in view of applications of the four dimensional variational data assimilation method to inverse parameter estimation problems on 27 june 2010 the world s first geostationary satellite ocean color sensor the geostationary ocean color imager goci was successfully launched by the republic of korea he et al 2013 unlike the existing polar orbit satellites goci has a high spatial resolution 500 m and a very high temporal resolution 1 h eight images per day ryu et al 2011 he et al 2013 which makes it quite applicable for mapping the surface sscs however the temporal resolution is highly restricted when compared with the numerical models in addition only the surface sscs can be obtained from goci whereas a large portion of the suspended sediments are in the water column especially near the bed besides goci data might be biased due to the cloud in this paper based on a three dimensional suspended cohesive sediment transport model with the adjoint data assimilation developed in wang et al 2016a the goci retrieved sscs are assimilated in the hangzhou bay hzb china the adjoint data assimilation method can not only improve the simulation results of sscs but also synchronously estimate the spatially and temporally varying model parameters emphasis is placed on the analyses of the temporal variations and spatial distributions of the estimated model parameters in the remainder of the paper the numerical model with adjoint data assimilation and satellite remote sensing data are described in section 2 the experiments and the model results are presented in section 3 the discussions of the estimated results of model parameters and this study can be found in section 4 the final conclusions are presented in section 5 2 models and observations 2 1 the suspended cohesive sediment transport model consider a domain ω which covers a region of the estuarine and coastal water the sscs at the initial time in this domain are c 0 let n be the vector normal to the boundaries there are three types of boundaries including the inflow open boundary ω1 the outflow open boundary ω2 and the solid boundary ω3 the evolution of sscs is described by the three dimensional advection diffusion equation with vertical particle settling which is described as follows wang et al 2016a 1 c t u c x v c y w c h σ x k h c x y k h c y h σ k v c h σ w s c h σ 2 c ω 1 c o b c 3 c n ω 2 0 4 c n ω 3 0 5 c t 0 c 0 where c represents the ssc t is the time x y are the horizontal coordinates σ is the vertical coordinate 0 for the bottom and 1 for the surface h is the total water depth including the undisturbed water depth and the sea surface elevation u v and w are the flow velocity components in the x y and σ directions respectively kh and kv are the horizontal and vertical diffusivity coefficients respectively ws denotes the suspended cohesive sediment settling velocity and cobc denotes the sscs at the inflow open boundary at the sea surface the no flux boundary condition is applied which is written as 6 w s c k v h c σ 0 σ 1 at the bottom of the water column the cohesive sediment flux is equal to the combination of erosion and deposition which is described as 7 w s c k v h c σ e d σ 0 where e and d are the erosion rate and deposition rate respectively which are calculated with the well known partheniades krone formulations partheniades 1965 8 e m 0 τ b τ c e 1 τ b τ c e 0 τ b τ c e 9 d w s c 1 1 τ b τ c d τ b τ c d 0 τ b τ c d where m 0 is the resuspension rate τb is the bottom shear stress τce and τcd are the critical shear stress for erosion and deposition respectively and c 1 is the sscs near the bottom eqs 1 9 are referred to as the forward model of suspended cohesive sediment transport the numerical schemes for solving the forward model are given in wang et al 2016a 2 2 the adjoint model a cost function is defined to describe the difference between the modeled and observed sscs wang et al 2016a 10 j 1 2 i j k n w i j k n c i j k n c i j k n 2 where c i j k n and c i j k n are the simulated and observed sscs at the i j k grid point at the n th time step respectively w is the weighting matrix and theoretically should be the inverse of the observation error covariance matrix which can be simplified by assuming that the errors of the data are uncorrelated and equally weighted yu and o brien 1992 in the present study the elements in w are 1 where observations are available and 0 otherwise the lagrangian function is defined as 11 l j i j n k 1 k λ i j k n discretization of left side of eq 1 right side of eq 1 λ i j 0 n λ i j 1 n 2 discretization of right side of eq 2 left side of eq 2 λ i j k n λ i j k 1 n 2 discretization of right side of eq 3 left side of eq 3 where λ denotes the adjoint variable of c k is the total vertical layers for the water column and there is one false layer at the bottom numbered 0 while k 1 represents the false layer at the surface according to the theory of the lagrangian multiplier method the first order derivate of the lagrangian function with respect to the variables and parameters should be zero to minimize the cost function thacker and long 1988 12 l λ i j k n 0 13 l c i j k n 0 14 l p i j k n 0 where p denotes the parameters in the suspended cohesive sediment transport model including kh kv ws m 0 cobc τce τcd and c 0 in fact eq 12 returns the discretization of eq 1 from eq 13 the discrete adjoint model can be derived which governs the evolution of the adjoint variable λ from eq 14 gradients of the cost function with respect to the model parameters are obtained the detailed formulae of the adjoint model and the gradients can be found in wang et al 2016a the minimization algorithm used in the adjustment of parameters is the steepest descent method sdm which is described as follows zhang and lu 2010 15 p k 1 p k β g k g max k where p is the vector of a model parameter arranged in a sequence k is the kth iteration step of data assimilation β is the positive step size g is the negative of the gradient vector of cost function with respect to the model parameter p which can be obtained from eq 14 g max is the l norm of g the sdm is especially efficient and useful when the dimension of parameter space is large zhang and lu 2010 as concluded by elbern et al 2007 and some other works the validity of the data assimilation should be tested by independent observations which were not assimilated but only for verification in this work one tenth of the observations were randomly selected as checking observations cos and the remaining observations were assimilating observations aos which were assimilated into the model the adjoint method is implemented with the following steps step 1 initial guess values of the model parameters are prescribed step 2 the forward sediment transport model is integrated forward in time with the given values of model parameters step 3 the cost function indicated by eq 10 is calculated from the difference between the simulated sscs and aos step 4 driven by the difference between the model results and aos the adjoint model derived from eq 13 is integrated backward in time and the adjoint variables are calculated step 5 the model parameters are adjusted using the sdm and the values of parameters are updated step 6 a certain criterion is set to check whether the cost function has satisfied the requirement of minimization if the criterion is satisfied the iteration will be terminated otherwise return to step 2 the corresponding flowchart is shown in fig 1 in this study the step size in eq 15 is set to be 3 of the initial guess values of the corresponding model parameters to expediently adjust several model parameters synchronously in addition the stop criterion is the difference of cost functions normalized by the values at the first iteration step between the last two steps is less than 3 0 10 5 with a maximum value of 300 for iteration steps 2 3 satellite remote sensing observations he et al 2013 developed a practical atmospheric correction algorithm and a regional empirical algorithm to generate hourly sscs from goci data in the hzb which were validated to be well compared with the in situ buoy observations in this study four days 26 and 27 june 2011 during neap tide 24 and 25 march 2015 during spring tide of sscs retrieved from goci firstly had their median filtering dealt with to reduce the noises near the edge of cloud and then the results were taken as the observations which were called goci retrieved sscs hereinafter 2 4 model settings in this study the suspended cohesive sediment transport model was coupled to the finite volume coastal ocean model fvcom chen et al 2003 which provided the hydrodynamic background fields considering the significant exchange of water between the yangtze estuary and the hzb the model area of fvcom covered the yangtze estuary the hzb and the western part of the east china sea r1 in fig 2 in the vertical dimension four uniform sigma layers were used tidal forcing with eight primary tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 were used at the seaward open boundaries in which the nodal modulation corrections were included the changjiang river and qiantang river runoff were included as river boundary conditions by using the daily river discharge the era interim wind field dee et al 2011 was taken as the surface wind forcing the temperature and salinity were not calculated in the hydrodynamic model for the suspended cohesive sediment transport model the study area was the hzb r2 in fig 2 the horizontal resolution was 0 006 0 006 there were four uniform sigma layers in the vertical direction which were the same as those in the fvcom in the forward model the integral time step was 180 s and the total simulation time was 31 h starting from 0028 utc 26 june 2011 during neap tide and 0028 utc 24 march 2015 during spring tide which were the same as those in the adjoint model the default parameter settings of the cohesive sediment transport model are described as follows the modeling results of sediment transport are sensitive to the initial conditions wang et al 2016a therefore the accurate specification of the initial values of the sscs is important for the sediment transport simulation over short time periods lee et al 2007 yang et al 2016a in this paper the initial conditions were obtained by interpolating the sscs from both satellite and ship measurements there are some values lacked in cloud covered areas at 0028 utc 26 june 2011 and 0028 utc 24 march 2015 therefore all the goci retrieved surface sscs were temporally averaged and the results were spatially interpolated using the nearest neighbor interpolation method to obtain the initial surface sscs during neap tide and spring tide which were shown in fig 3 the in situ sscs were observed at four stations including s1 s2 s4 and s7 see fig 2 in the north of the hzb the observed sscs at s1 and s2 started at 1000 utc 9 may 2005 and ended at 1012 utc 10 may 2005 the observed sscs at s4 and s7 were during the period 0500 utc 8 may 0700 utc 9 may 2005 the water samples at these stations were collected about hourly from three to five layers which were then used to derive sscs through filtration by using 0 45 μm filters the observed sscs were vertically interpolated into the four layers and the mean values were linearly decreased with the number of vertical layers as follows c 1 8870 0 3764 k where k was the number of vertical layers according to the fitting formula the initial sscs at the other layers were given by multiplying the initial surface sscs with coefficients 4 9476 0 9869 k the western open boundaries were taken as the inflow open boundary at which the input sscs were set to 0 15 kg m3 during neap tide according to mwrprc 2011 and 0 1 kg m3 during spring tide according to mwrprc 2015 the seaward open boundaries were taken as the outflow open boundary based on the in situ observations tang 2007 pointed out that the floc settling velocity varied in the order of magnitude of 10 4 10 3 m s in the hzb which was similar to those observed in the yangtze estuary that near the hzb in shi and zhou 2004 and yang et al 2016b meanwhile the settling velocity of the dispersed sediment was about in the order of magnitude of 10 5 m s therefore the default value of the settling velocity was set to 1 0 10 4 m s and the variation range during parameter estimation was from 1 0 10 5 m s to 5 0 10 3 m s according to hu et al 2009a and xie et al 2009 the resuspension rate was set to 3 0 10 6 kg m2 s and the variation range during parameter estimation was from 1 0 10 6 kg m2 s to 1 0 10 4 kg m2 s according to einstein 1950 and hu et al 2009a the critical stresses for erosion and deposition were set to be equal which were set to 0 4 n m2 consistent with the range of critical stress in hu et al 2009a the horizontal and vertical diffusivity coefficients were assigned according to the dimensional analysis wang et al 2016a 3 experiments and results 3 1 verification of hydrodynamic field the accuracy of the suspended cohesive sediment transport model is strongly contingent upon the degree of accuracy of the flow field mehta et al 1989b xie et al 2009 the observations of water level and flow velocity were collected during 29 february 2012 to 16 march 2012 the stations located in the southeast of the hzb as shown in fig 2 the hydrodynamic model was run from 1 february 2012 and the initial 28 days were for spinning up in the northeast of the hzb harmonic constants of each constituent analyzed from the simulated water levels of 30 days were compared with the observed data at tidal gauge stations shown in fig 2 at all the stations the relative errors for amplitude and phase lag were less than 15 in addition the modeled water levels of six stations including shuang he shan shs dai shan ds da yu shan dys yan wo shan yws xi ken shan xks and zhai zi shan zzs were compared with the observations in fig 4 the results showed that the simulated water levels at all these stations were in good agreement with the observations especially during spring tide the simulated depth averaged flow velocity and direction agreed well with the observations at station 1 regardless of the tidal conditions fig 5 the depth averaged flow velocities were slightly underestimated at stations 2 and 3 fig 5 overall the simulated results were acceptable to drive the suspended cohesive sediment transport model for this study 3 2 data assimilation and results two groups of experiments were carried out to assimilate the goci retrieved sscs in which the experiments during neap tide 26 and 27 june 2011 were numbered with prefix n while s was used for spring tide 24 and 25 march 2015 to verify the effect of data assimilation benchmark experiments with index n01 and s01 in which the data assimilation was not used and all the model parameters were set to the default values as described in section 2 4 were carried out conversely in n02 and s02 the data assimilation was implemented and the initial guess values of the model parameters were set to the default values which were the same as those in n01 and s01 the insensitive parameters concluded in wang et al 2016a including the horizontal and vertical diffusivity coefficients were not estimated whether the critical shear stresses for erosion and deposition were equal was still a point of controversy which was disparate in different suspended cohesive sediment transport models therefore the critical shear stresses for erosion and deposition were also not estimated on the contrary the other parameters were supposed to be spatially and temporally varying which were estimated synchronously the detailed model settings of these experiments are listed in table 1 the cost function normalized by the value at the first iteration step and the l 1 norm of gradients of cost function with respect to the estimated parameters are shown in fig 6 in addition the mean absolute errors maes between the simulated sscs and goci retrieved sscs during neap tide and spring tide are listed in tables 2 and 3 respectively for n02 s02 the normalized cost function tended to be stable and was less than 0 63 0 22 after 207 72 iterations see fig 6a and f the mae between the simulated sscs and aos was 6 61 10 2 kg m3 2 04 kg m3 before data assimilation which was the same as that in n01 s01 after assimilation the mae was decreased to 3 76 10 2 kg m3 8 09 10 1 kg m3 in n02 s02 indicating that the model performance was improved with a reduction of 43 12 60 34 in overall simulation error besides the mae between the simulated sscs and cos was reduced to 3 79 10 2 kg m3 8 06 10 1 kg m3 from an initial value of 6 64 10 2 kg m3 2 05 kg m3 in n02 s02 further showing a significant improvement when applying data assimilation the l 1 norm of gradients of cost function with respect to estimated parameters including settling velocity resuspension rate inflow open boundary conditions and initial conditions were reduced stably and largely during the iteration steps fig 6b e for n02 and fig 6g j for s02 indicating that the adjustments of model parameters were effective and the model performance was fairly good the temporally averaged values of the simulated surface sscs at the observed time before data assimilation are shown in fig 7 a fig 8 a while fig 7b fig 8b for those after assimilation in n02 s02 as shown in he et al 2013 the surface sscs retrieved from goci were not continuous and the values were lacked in cloud covered areas the hourly satellite data were first interpolated to obtain the spatial distribution of surface sscs at every observed time and then temporally averaged the averaged values of goci retrieved surface sscs are shown in fig 7c fig 8c in n02 s02 in n02 and s02 the simulated surface sscs after data assimilation had the similar spatial features with the sscs retrieved from goci in which the high values of sscs were near the andong tidal flat and the low values were near the north land boundaries conversely the simulated surface sscs before data assimilation were much larger than the goci retrieved sscs in most areas the correlation coefficient between the simulated and goci retrieved surface sscs was 0 57 0 72 before data assimilation while 0 79 0 85 after data assimilation in n02 s02 showing that the spatial features of the satellite remote sensing data can be reproduced by the modeling results after data assimilation besides the temporally averaged values of the maes between the goci retrieved surface sscs and the corresponding simulated results before data assimilation are shown in fig 7d fig 8d while fig 7e fig 8e for those after assimilation in n02 s02 it was obvious that in n02 and s02 the temporally averaged maes after data assimilation were less than those before data assimilation in almost all the spatial points and less than the temporally averaged values of goci retrieved surface sscs in all the spatial points except those near the south land boundaries indicating that the data assimilation can effectively improve the simulation results during both neap tide and spring tide overall during neap spring tide the simulated sscs after data assimilation in n02 s02 were much closer to the goci retrieved sscs than those before data assimilation in n01 s01 demonstrating that the adjoint data assimilation can improve the model performance and provide a possible method to synchronously estimate the parameters in suspended cohesive sediment transport models 3 3 sensitivity experiments in n02 and s02 the estimation results of the model parameters may be affected by the model settings therefore several numerical experiments were carried out to test the sensitivity of the estimation results to the model settings including the selection of the estimated parameters n11 n13 and s11 s13 the initial guess values and the magnitude of smoothness n21 n24 and s21 s24 and the assimilated observations n31 and s31 to eliminate the contingency introduced by data selection the aos in n02 s02 were equally divided into nine parts then every part was taken as cos and the remaining observations were aos so there were nine new experiments in n31 s31 finally the averaged values of these nine experiments were taken as the results of n31 s31 the detailed model settings of the sensitivity experiments are shown in table 1 the maes between the simulated sscs and the goci retrieved sscs and the correlation coefficients between the estimated parameters in n02 s02 and those in the sensitivity experiments were calculated to test the robustness of the parameter estimation which were shown in table 2 table 3 for all the experiments during neap tide and spring tide the maes were decreased substantially and the simulated results of sscs were improved effectively furthermore all the correlation coefficients between the estimated parameters in n02 s02 and those in sensitivity experiments were larger than 0 7 0 9 although the model settings in the sensitivity experiments were different from those in n02 s02 during neap spring tide the spatial and temporal variations of the estimated parameters in all the experiments were similar to each other indicating that the spatial and temporal variation tendencies of the estimated model parameters were robust and not affected by the model settings 3 4 temporal variations and spatial distributions of the estimated parameters in this study the hydrodynamic field was obtained by running fvcom in which the variations of temperature and salinity were not included besides zhou and gao 2004 pointed out that for very low sscs of the order of 0 1 0 7 kg m3 the settling velocity was independent of sscs as the aggregates or particles settled independently without much mutual interference therefore the effects of sscs were not considered when the variations of the estimated parameters were analyzed in the following analyses it was assumed that water level current speed and water depth were the basic factors influencing the variations of the estimated parameters the temporal variability of the spatially both horizontally and vertically averaged height above seabed current speed and the estimated parameters in n02 and s02 smoothed with a 1 h moving filter are shown in fig 9 the estimated settling velocity reached the local maximum value about 0 15 h before slack water at either low or high water during neap tide see fig 9a while 0 075 h during spring tide see fig 9d during both neap and spring tides the estimated settling velocity first decreased and then increased during the flood and ebb stages in addition the duration of the decrease was much longer than that of the increase in the flood tide which was opposite in the ebb tide see fig 9a and d during both neap and spring tides the estimated resuspension rate was negatively correlated with the current speed and the maximum values occurred near the slack water at either low or high water see fig 9b and e during both neap and spring tides the estimated inflow open boundary conditions reached the maximum values near the low water slack conditions see fig 9c and f the aforementioned relations were the same for both of the stages with and without observations and more obvious during the stage without observations which was shown by the section between the two green lines in each subgraph of fig 9 in order to intuitively show the relationship between the temporal variations of the estimated parameters and the temporal variations of water level and current speed these spatially averaged variables during the time when there were not observations were phase averaged using the methods in voulgaris and meyers 2004 and murphy and voulgaris 2006 and the results are shown in fig 10 all the phenomena obtained from fig 9 can also be seen in fig 10 the correlation coefficients between the temporal variations of current speed and the temporal variations of the estimated parameters including settling velocity and resuspension rate were 0 86 and 0 88 during neap tide while 0 78 and 0 96 during spring tide it can be concluded that the temporal variations of the estimated parameters were closely related with the water level and the current speed during both neap and spring tides the hydrodynamic field and the estimated parameters were first vertically averaged and then phase averaged during the time when there were not observations in n02 and s02 the results smoothed by a 25 point average are shown in fig 11 the spatial distribution of the estimated settling velocity fig 11a and d was significantly positively r 0 81 during neap tide and r 0 90 during spring tide correlated with the estimated resuspension rate fig 11b and e which was similar to the relationship in the temporal variations the current speed fig 11c and f was related with these two parameters especially the resuspension rate the correlation coefficients between the current speed and the estimated parameters including settling velocity and resuspension rate were 0 60 and 0 72 during neap tide while 0 60 and 0 77 during spring tide during both neap and spring tides the values of the estimated initial conditions were higher near the south land boundary and lower near the north land boundary fig 11g and h in addition the minimum values were located near the maximum value of water depth indicating that the initial sscs were negatively 0 43 during neap tide and 0 44 during spring tide correlated with the water depth fig 11i on the whole no matter during spring tide or neap tide both temporal variations and spatial distributions of the estimated parameters were significantly correlated with the hydrodynamic fields in detail both temporal variations and spatial distributions of the estimated settling velocity and resuspension rate were negatively correlated with the current speed the temporal variations of the estimated inflow open boundary conditions were related to the water level which reached the maximum values near the low water slack conditions besides the spatial distribution of the estimated initial conditions was negatively correlated with the water depth 4 discussions 4 1 mechanisms for temporal variations and spatial distributions of the estimated parameters at present there are not enough direct measurements of the model parameters to verify the estimated results the following analyses are carried out trying to explain the mechanisms for temporal variations and spatial distributions of the estimated parameters the suspended fine grained sediments are predominantly in flocculated form impacting the settling velocity characteristics of the sediment in estuaries gibbs et al 1989 van leussen 1997 milligan et al 2001 voulgaris and meyers 2004 according to stokes law the settling velocity of a spherical particle should depend on its size and its effective density which has been successfully applied to flocculated particles using the original or modified versions e g winterwerp 1998 manning and dyer 1999 mikkelsen and pejrup 2001 the previous studies e g sternberg et al 1999 mikkelsen and pejrup 2001 voulgaris and meyers 2004 strom and keyvani 2011 suggested an increase of settling velocity with increasing floc size which was also obtained in the xuliujing of yangtze estuary cheng et al 2005 and pearl river estuary xia et al 2004 china therefore the floc size and sediment size will be positively correlated with the settling velocity in a tidal cycle the tidal current plays an important role in the particle size of suspended sediments li et al 2000 flocculation or aggregation li et al 1996 hu et al 2009b and mean floc diameter verney et al 2011 verney et al 2011 conducted a laboratory experiment to investigate the behavior of a population of flocs during an idealized tidal cycle while considering turbulence which was one key parameter controlling the flocculation processes they found that shear rate which was positively correlated with the current velocity controlled the balance between the aggregation and fragmentation processes and therefore the variation in shear rate caused an inverse change in the mean floc diameter besides based on the in situ observations in the south passage of the yangtze estuary tang 2007 found that the temporal variations of the mean floc diameter were negatively correlated with the current speed therefore there is a negative relationship between the current speed and the sizes of suspended flocs and sediments according to a combination of stokes law and the aforementioned results from the laboratory experiments and in situ observations the variations of settling velocity are negatively correlated with the current speed which has also been demonstrated by the temporal variations and spatial distributions of the estimated settling velocity see figs 10a d and 11 the floc behavior was asymmetrical during the flood and ebb stages of the tidal cycle in verney et al 2011 which was similar to the asymmetrical temporal variations of the estimated settling velocity in this study verney et al 2011 attributed it to the different time scales for the aggregation and fragmentation processes although the flocculation process was not considered in the suspended cohesive sediment transport model in this study the flocculation process can be included implicitly through changes in the settling velocity of fine sediments which has also been employed in previous literatures e g mehta 1986 lick et al 1993 van leussen 1994 the value of resuspension rate is a function of the bed density porosity composition consolidation and evolution of the sediment under the complex and mixed effects of the physical and biological interaction ge et al 2015 the resuspension rate is parameterized as a removal capability of soil material from the seabed surface due to the hydrodynamic induced shear stress ge et al 2015 which was termed the erodibility constant in hayter and mehta 1986 resuspension of cohesive sediment depends not only on the magnitude of applied bed shear stress but also on the seabed erodibility you 2005 on one hand the consolidating soft deposit and the settled consolidated firm bed are the two basic statuses of the seabed in addition gelling and consolidation of the deposit and the associated physicochemical changes eventually result in a settled bed with higher shear strength and more stable structural configuration mehta et al 1989a for a certain shear stress less sediment is resuspended from a fully consolidated bed than from a freshly deposited bed you 2005 on the other hand zhang et al 2017 investigated the erodibility of fluidized cohesive sediments from the seabed of hzb experimentally in unidirectional open flows in their results the critical shear stress for erosion was negatively correlated with the resuspension rate named erosion parameter in their paper which were related with the yield stress by analyzing the data set describing in situ erosion test in baltimore harbor sanford and maa 2001 pointed out that the critical shear stress for erosion increased as the total eroded mass increased indicating that the resuspension rate decreased with erosion depth according to the relationship in zhang et al 2017 sediment in the hzb is predominantly composed of fine and medium silt and transported in suspension xie et al 2009 so the consolidating deposit will be located above the settled consolidated bed in the hzb which results in sediments near the surface being less compacted and relatively easy to be resuspended while sediments below are more compacted and more difficult to be resuspended ziegler and lick 1988 based on the observations at two fixed stations in the south channel of the yangtze estuary which was near the hzb jiang et al 2002 pointed out that during the acceleration phase of flood tide or ebb tide when the current velocity became larger the sediments in the seabed were resuspended and stirred into the water column so the volume weight of the sediments in the seabed was increased which resulted in the resuspension of the sediments in the seabed becoming much more difficult chen et al 2004 collected the sediment samples in the surface of the seabed at a site along the north bank of the hzb and found that the sediment sizes were finer during the accumulation period and coarser during erosion period therefore when the shear stress is larger than the critical value erosion occurs and the sediment sizes in the seabed surface become coarser and more difficult to enter the water column which results in a small resuspension rate conversely the resuspension rate will reach the local maximum value during slack water conditions which has also been shown in the temporal variations and spatial distributions of the estimated resuspension rate see figs 10b e and 11 during the flood stage of the tidal cycle the tidal wave reaches the west open boundary and prevents the inflow sscs from qiantang river so the inflow open boundary conditions decrease and this process can continue until the end of the ebb acceleration phase after that the sscs from qiantang river increase and reach the maximum value during low water slack conditions as shown in fig 10c and f the estimated initial sscs are negatively correlated with the water depth see fig 11g i which is similar to the results obtained from in situ observations and satellite measurement in cai et al 2015 and mao et al 2016 although not exactly equal the estimated model parameters during neap and spring tides have shown similar temporal variations and spatial distributions as given in section 3 4 it indicates that the spatial and temporal variation tendencies of the estimated model parameters are robust and can be applied to different tidal conditions more importantly the estimated results during both spring tide and neap tide conform to the aforementioned physical mechanisms showing that the assignment of model parameters in the suspended cohesive sediment transport models can be realized with the adjoint data assimilation method by incorporating ssc observations and dynamics of the physical process 4 2 the general pattern in a tide cycle the general pattern for the temporal variations of model parameters in a tidal cycle for the hzb which is a typical macro tidal estuary is summarized based on the modeling results in section 3 4 and the analyses in section 4 1 as follows shown in fig 12 1 during the acceleration phase of the flood tide when the current velocity becomes larger stage i in fig 12 the resuspension will occur so the fine sediments at the surface of seabed will be stirred into the water column after that the sediments at the surface of seabed will become coarser which introduces a small resuspension rate meanwhile the increasing shear rate in the water column can promote the fragmentation of the floc also because more fine sediments enter the water column from seabed both the suspended floc size and sediment size will become smaller which results in a small settling velocity according to stokes law these processes will last into the stage where the current velocity reaches the maximum during the flood tide stage ii in fig 12 during which the resuspension rate and settling velocity will be the local minimum 2 when the flood current decreases stage iii in fig 12 the aggregation progressively counterbalances the fragmentation and consequently the suspended floc size will become larger which makes the settling velocity gradually increase according to stokes law on the other hand at a low flow condition the fine sediment will deposit to the seabed which can lead to a larger resuspension rate 3 during the high water slack condition stage iv in fig 12 the suspended floc size will reach its maximum value and correspondingly the settling velocity also reaches the local maximum meanwhile as the proportion of fine sediments at the seabed becomes large the resuspension rate reaches the local maximum after this stage the flocs will settle rapidly 4 the pattern during the ebb tide is quite similar to that in the flood stage except for the asymmetry that is displayed in fig 10a and d which may be related to the different time scales for the aggregation and fragmentation processes verney et al 2011 or the different sediment sources due to horizontal advection wang and xue 1990 besides the inflow open boundary conditions reach its local maximum value near the low water slack condition because of the interaction of tidal current and riverine current 4 3 prospects and limitations of this study 4 3 1 prospects the satellite data have significantly promoted the theory of physical oceanography for example combined with the numerical model the satellite altimetry has reopened the problem of how tidal dissipation is allocated munk 1997 and led the ocean research to an age of altimetry ray 2001 compared with the traditional in situ measurements the satellite derived sscs can increase the horizontal coverage and duration of observations it can be believed that the satellite data of sscs can also improve the theory and modeling of sediment transport and the related morphology evolution especially after increasing the data accuracy this work belongs to the initial attempts to assimilate the satellite derived sscs into the three dimensional suspended cohesive sediment transport model by employing the adjoint method in previous works e g stroud et al 2009 warner et al 2010 bian et al 2013 zeng et al 2015 the model parameters in suspended sediment transport models were set to be constant or based on the empirical formula which may introduce modeling errors when the adjoint data assimilation method is implemented the model parameters can be assumed to be spatially and temporally varying which can reveal the physics of the model parameters that are affected by the time and space dependent sediment characteristics and hydrodynamic forcing in addition the model parameters can be estimated iteratively and automatically rather than adjusted by experience which can improve the efficiency and accuracy as parameter estimation using the adjoint method is based on rigorous mathematical theory the estimated model parameters can improve the simulation results as shown in this study if enough observations can be obtained especially when continuous observations are available in the time dimension data assimilation can be extended to a longer time period as the prediction models of temperature salinity and water level in physical oceanography once the long term simulations of sscs can be accurately carried out it can not only improve the knowledge of the suspended sediment transport processes but also benefit the long term evolution of oceanic morphology which in turn can improve the hydrodynamic simulations 4 3 2 limitations it is necessary to point out that some respects related to data assimilation and model development are restricted in this study which should be further improved in future studies the limitations of this study will be discussed from the following three aspects 1 only the goci retrieved sscs were used for assimilation and independent verification in which the observational error was relatively large for extremely turbid waters he et al 2013 in future studies the contemporaneous in situ observations of sscs are needed to supplement the information in the vertical direction and provide further quality checks 2 the suspended cohesive sediment transport model with the adjoint data assimilation is off line coupled to the hydrodynamic model in this study on the one hand the temperature and salinity are not calculated in the hydrodynamic model and the interaction between the hydrodynamic fields and the suspended sediments is not considered brown et al 2015 pointed out that it was necessary to consider the baroclinic influence even within a hyper tidal region with low freshwater inflow for accurate particle tracking studies on the other hand only the relationships between the estimated parameters and the hydrodynamic fields including current speed water level and water depth are analyzed the obtained relationships are suggestive for improving the parameterization in suspended cohesive sediment transport models especially for areas like the hzb nevertheless there are other factors affecting the model parameters salinity temperature and sscs can also influence the settling velocity dyer 1986 tang 2007 wan et al 2015 the relationships between the settling velocity and salinity are highly dependent on specific environmental conditions for example salinity has no significant effect on the settling velocity in the elbe estuary chen et al 1994 and the amazon continental shelf berhane et al 1997 while salinity shows a noticeable impact on the settling velocity in the yangtze estuary in different forms e g tang 2007 wan et al 2015 and in the pearl river estuary xia et al 2004 for the relationship between the settling velocity and temperature owen 1972 and lau 1994 obtained the opposite results both tang 2007 and wan et al 2015 pointed out that increasing temperature had a positive effect on the settling velocity in the yangtze estuary consequently an on line coupled hydrodynamic and suspended sediment transport model with the adjoint data assimilation is required in future studies for one thing the effects of suspended sediments on hydrodynamic fields including baroclinic forcing effects turbulence damping effect and bottom boundary layer effect ma et al 2014 can be considered for another the potential complicated relationships between the model parameters and the multifarious influence factors can be further explored for example by using the on line coupled model the temporal variations and spatial distributions of the estimated settling velocity may be related to not only the current speed but also the salinity besides the temporal variations of the estimated inflow open boundary conditions may be clearly explained using the variations of salinity near the river mouth 3 compared with the traditional simulation of sscs the participation of adjoint data assimilation which needs more computation resources and computation time challenges the computer hardware and the parallel technique especially for long term simulation the introduction of the advanced parallel techniques and the improved algorithms should be done in the future improvement of the present model 5 conclusions in this study four days 26 and 27 june 2011 during neap tide 24 and 25 march 2015 during spring tide of sscs retrieved from goci were assimilated into a three dimensional cohesive sediment transport model with adjoint data assimilation developed in wang et al 2016a to simulate the sscs and synchronously estimate four spatially and temporally varying model parameters in the hzb in china in addition several sensitivity experiments were carried out to test the sensitivity of the estimation results to the model settings the results of the numerical experiments showed that during both neap tide and spring tide the model performance was significantly improved by assimilating the goci retrieved sscs see tables 2 and 3 in addition the simulated sscs after data assimilation reasonably reproduced the spatial variations of the goci retrieved sscs see figs 7 and 8 besides the temporal and spatial variation tendencies of the estimated model parameters were robust and not affected by the model settings see tables 2 and 3 the temporal variations and spatial distributions of the estimated parameters were significantly correlated with the hydrodynamic fields in detail the temporal variations and spatial distributions of the estimated settling velocity and resuspension rate were negatively correlated with the current speed see figs 10 and 11 the main reason was that when the current velocity became larger the sediments at the surface of seabed will become coarser which introduced a small resuspension rate meanwhile because the increasing shear rate in the water column can promote the fragmentation of floc and more fine sediments entered the water column from the seabed the settling velocity decreased according to stokes law see fig 12 it was the reverse when the current velocity decreased besides the estimated inflow open boundary conditions reached the local maximum value near the low water slack condition because of the interaction of tidal and riverine current see fig 12 the spatial distributions of the estimated initial conditions were negatively correlated with the water depth see fig 11 which was similar to the results obtained from the satellite data and in situ data acknowledgments the authors would like to thank the three anonymous reviewers for their constructive suggestions to greatly improve the manuscript financial support to this study is provided by the national key research and development program of china grant numbers 2017yfc1404000 2017yfa0604100 and 2016yfc1402304 the natural science foundation of zhejiang province grant number ly15d060001 the key research and development program of shandong province grant number 2016zdjs09a02 and the national natural science foundation of china grant number 41206001 
24138,lagrangian analysis is a powerful way to analyse the output of ocean circulation models and other ocean velocity data such as from altimetry in the lagrangian approach large sets of virtual particles are integrated within the three dimensional time evolving velocity fields over several decades a variety of tools and methods for this purpose have emerged here we review the state of the art in the field of lagrangian analysis of ocean velocity data starting from a fundamental kinematic framework and with a focus on large scale open ocean applications beyond the use of explicit velocity fields we consider the influence of unresolved physics and dynamics on particle trajectories we comprehensively list and discuss the tools currently available for tracking virtual particles we then showcase some of the innovative applications of trajectory data and conclude with some open questions and an outlook the overall goal of this review paper is to reconcile some of the different techniques and methods in lagrangian ocean analysis while recognising the rich diversity of codes that have and continue to emerge and the challenges of the coming age of petascale computing keywords ocean circulation lagrangian analysis connectivity particle tracking future modelling 1 introduction the ocean exhibits a huge range of dynamical motions spanning scales from millimetres to thousands of kilometres as seawater moves each fluid particle carries tracers such as salt nutrients heat as well as particulate matter such as plankton and marine debris for various theoretical and practical applications we are interested in how water moves between ocean regions that is we are interested in mapping out pathways of seawater motion since the transport of seawater and its tracer content as well as the pathways and timescales for that transport are key facets in how the ocean plays a role in climate and marine ecology 1 1 estimating pathways there are two general methods for estimating pathways in the ocean one method makes use of tracers such as the multitude of age tracers described by mouchet et al 2016 and references therein tracer studies are well suited for eulerian methods which make direct use of ocean velocity fields on their native grids the second approach makes exclusive use of the lagrangian perspective of fluid dynamics e g bennett 2006 this method employs an ensemble of virtual passive lagrangian particles of zero spatial extent whose trajectories are determined by the velocity field 1 1 lagrangian particles are also sometimes called e floats by for example bower et al 2009 the velocity fields that are used to move the particles often come from ogcms although there are interesting application using observational based velocities such as surface geostrophic velocities based on satellite altimetry e g d ovidio et al 2009 klocker and abernathey 2014 or measured by high frequency hf radar e g ullman et al 2006 trajectories for virtual particles map out pathlines of the velocity field often including the effect of subgrid scale diffusion statistics of the trajectories then define particle pathways and their associated time scales by following the flow of virtual particles and possibly assigning non zero transports and other properties to them in post processing questions about pathways and flow connectivity can be addressed this review focuses on lagrangian analysis methods facilitated by virtual particles in the open ocean we are partly motivated by the growing array of floating instruments in the ocean along with the improving lagrangian simulation capabilities there is a corresponding need to review the methods and foster new ideas for extracting information about the ocean circulation from the entangled trajectories of floats and or simulated particles we thus aim to summarize the state of the science in lagrangian modelling and analysis focussing on the large scale open ocean circulation hoping to support a new generation of scientists contributing to the development and use of the methods our presentation is aimed at graduate students though any large scale oceanographer or mathematician with an interest in virtual particle analysis could use this paper as a starting point in that sense this paper is intended as an accompanying paper to griffies et al 2000 which provided an introduction to primitive equation ocean models and to ådlandsvik et al 2009 which gave an overview of lagrangian modelling practice from a marine biology perspective 1 2 overview of lagrangian ocean analysis observationalists have been tracking the ocean in a lagrangian fashion since the very early ages of oceanography movements of the currents were documented using either ship drift or the drift of purposely built subsurface floats e g swift and riser 1994 many observations remain inherently lagrangian such as the trajectories of surface drifters shown in fig 1 lumpkin and pazos 2007 the subsurface argo floats lebedev et al 2007 ollitrault and rannou 2013 and the tracking of fish larvae paris et al 2013a and turtle hatchlings scott et al 2014 lagrangian analysis through virtual particle tracking within ogcms began in the 1980s on small scale structures with studies on a theoretical box model awaji et al 1980 as well as a model that incorporated hydrographic data and realistic topography imasato et al 1980 the lagrangian framework of these small scale examples was then applied to the velocity field output of basin scale three dimensional numerical experiments examples include regional deep ocean circulation fujio and imasato 1991 western boundary currents imasato and qiu 1987 fronts pavia and cushman roisin 1988 and gyre transport böning and cox 1988 particle trajectories in global ocean circulation models driven by global hydrographic and wind observations were first achieved in the 1990s fujio et al 1992 döös 1995 drijfhout et al 1996 blanke and raynaud 1997 in recent years more than 100 articles per year are published with the words lagrangian ocean modelling as the topic according to the web of science these papers include studies on the pathways of virtual particles that simulate sea water pathways as well as explicit tracking of tracers such as nutrients e g chenillat et al 2015 jönsson et al 2011 and particulates such as larvae e g cowen et al 2006 paris et al 2005 teske et al 2015 cetina heredia et al 2015 phelps et al 2015 plastics e g lebreton et al 2012 microbes e g hellweger et al 2014 planktic foraminifera e g van sebille et al 2015 jellyfish e g dawson et al 2005 icebergs e g marsh et al 2015 surface drifters e g kjellsson and döös 2012b oil droplets e g paris et al 2012 eel e g baltazar soares et al 2014 pumice e g jutzeler et al 2014 and many more the ocean circulation covers an enormous range of scales and regions as said above in this review we focus primarily on applications on the basin and global scales however it should be noted that there is also extensive lagrangian analysis work done on smaller scales such as in coastal zones and recently in the gulf of mexico through interest in dispersion of the deepwater horizon oil spill e g beron vera and lacasce 2016 haza et al 2016 the lagrangian framework is not only used to analyse velocity fields by computing their integral curves but also to directly solve for the trajectory by casting the equations of motion in a lagrangian framework bennett 2006 lagrangian methods are widely used in engineering including discrete element methods e g kruggel emden et al 2008 and smoothed particle hydrodynamics e g cummins et al 2012 while advances in this field have been made in large scale oceanography both for sub components of ocean models e g bates et al 2012 and for fully lagrangian ocean models haertel and randall 2002 haertel and fedorov 2012 this topic is not the focus of this review instead we focus on lagrangian diagnostic methods to identify oceanic pathways the lagrangian framework for analysing pathways is complementary to the analysis of tracers one of the key differences is the computational cost for each time step movement of a lagrangian particle takes only one set of computations in contrast the advection diffusion of a tracer concentration takes n sets of computation where n is the number of discrete ocean grid cells while one lagrangian particle trajectory does not allow for meaningful analysis of ocean pathways this comparison does show that the computational scaling of the two methods is very different furthermore the experimental design is different for tracer and particle experiments exclusive to particle experiments is that the entire trajectory history of the virtual particles can in principle be stored this history allows for a posteriori analysis of connectivity between different regions of the ocean e g sections 4 5 and 4 6 and conditional statistics e g koszalka et al 2013b van sebille et al 2013 2014 von appen et al 2014 gary et al 2014 durgadoo et al 2017 where subsets of particles can be analysed that obey certain conditions based on their properties for example in van sebille et al 2013 particles in the southern ocean were analysed for how often they looped around antarctica in their journey from the antarctic slope to the deep subtropical basins such an analysis would be hard to do with tracer fields although the latter has its own advantages including a more natural alignment with the treatment of advection and diffusion within models finally another great advantage of lagrangian particle experiments is that particles can be advected at least in offline mode when velocity fields are stored backwards in time this reverse time analysis allows one to investigate where water masses found within a model at a certain location come from 1 3 structure of this paper this paper is structured as follows in section 2 we introduce a kinematic framework used for thinking about lagrangian particles in section 3 we detail how to compute and interpret lagrangian particles including an overview of the available lagrangian diagnostic tools in section 4 we highlight applications of how virtual particle trajectories can be analysed to reveal quantitative and qualitative information about the flow in section 5 we conclude the main part of the paper with future outlooks a selection of appendices then provide examples and detailed discussion of topics introduced earlier in the paper as well as brief descriptions of the different numerical codes introduced in section 3 2 kinematic framework we here introduce a kinematic framework to describe fluid motions the ideas are fundamental to how we make use of both eulerian and lagrangian methods for analysing ocean circulation we make connections to lagrangian analysis methods though reserve algorithmic details for later sections 2 1 lagrangian and eulerian reference frames a lagrangian kinematic approach is based on a description of the fluid in a reference frame that is moving with an infinitesimal fluid particle equivalently a fluid parcel fluid motion is thus the accumulation of continuum particle motion the fluid particle framework that forms the basis for lagrangian kinematics offers a powerful conceptual picture of fluid motion e g salmon 1998 bennett 2006 with this picture taken as the basis for lagrangian methods of analysis eulerian kinematics is a complement to lagrangian kinematics the eulerian approach is based on describing fluid motion in a reference frame that is fixed in space eulerian kinematics is the basis for most numerical ocean circulation models in which the horizontal position of grid cells is held fixed in time 2 2 the top and bottom faces of grid cells are generally moving since the general vertical coordinates defining these surfaces need not be static for example these cell faces may be defined according to constant pressure constant potential density or constant rescaled ocean depth quite generally the technical aim of lagrangian ocean analysis is to estimate the trajectory of virtual fluid particles by making use of eulerian fluid information i e the velocity field 2 2 trajectories or material pathlines the motion of a classical point particle is described by knowledge of its position vector x t which provides the position of the particle at time t as the particle moves it traces out a curve in space referred to as a trajectory when describing n discrete particles we add a discrete label to each of the particle positions x n t for continuum matter such as seawater the discrete label n becomes a continuous vector x a t with a x t t 0 a common though not necessary choice in general the label vector a is referred to as the material coordinate e g salmon 1998 since this coordinate distinguishes between infinitesimal particles comprising the continuum a fluid particle is conceived of as a microscopically large collection of many molecules whose velocity is formally determined as a mass weighted mean of the velocity of the individual molecules i e barycentric velocity as defined in section ii 2 of degroot and mazur 1984 and section 1 9 of salmon 1998 alternatively by making the continuum hypothesis we dispense with molecular degrees of freedom so that a particle is considered a macroscopically small material fluid volume treated as a mathematical continuum and labelled by the material coordinate a for an incompressible fluid the fluid particle has constant volume however its constituents do not remain fixed as they are generally exchanged with adjacent particles through mixing thus changing the particle s tracer content e g water salt nutrients as well as altering its heat all the while maintaining a constant volume the velocity of a fluid particle is the time derivative of the trajectory computed with the material coordinate held fixed the mathematical connection between lagrangian and eulerian descriptions is enabled by equating the particle velocity crossing a point in space x a t x to the fluid velocity field at that point 1 x a t t a v x t where x a t x the relation 1 provides a starting point for lagrangian fluid analysis note that the resulting fluid particle trajectories are sometimes called material pathlines in the fluid mechanics literature e g aris 1962 batchelor 1967 2 3 the material time derivative without trajectories a kinematic description requires time changes of an arbitrary function ψ evaluated along trajectories ψ x a t t use of the chain rule leads to 2 ψ x a t t t t x v x a t t ψ x a t t note that when trajectories are dispensed with as in the eulerian description we recover the more succinct expression for the material time derivative 3 d ψ x t d t t v x t ψ x t where all expressions on the right hand side are taken with respect to the fixed eulerian reference frame 3 3 an alternative derivation of eq 3 which is arguably more straightforward mathematically dispenses with trajectories from the start in which case we express the total differential of a function as d ψ x t d t t ψ d x ψ specifying the spatial increment to correspond to movement of a fluid particle d x v x t d t leads to eq 3 we prefer the derivation using particle trajectories as it exposes the relation between lagrangian and eulerian reference frames the symbol d is commonly used to distinguish the material time derivative from a more general time derivative that is not necessarily following a material fluid particle to illustrate this formalism consider ψ x t x in this case the material time derivative is given by the velocity field at that point 4 d x d t v x t 2 4 steady state volume transport pathways defined by streamtubes within lagrangian ocean analysis there is a long history of interpreting particle trajectories as streamtubes and using this interpretation to compute volume transports döös 1995 blanke and raynaud 1997 see also section 3 2 3 formally the equivalence between streamtubes and material pathways is only valid for steady state flows i e where the flow is constant in time originally the streamtube calculations were indeed performed on time mean steady state velocity fields but they were soon extended to time varying flows for example by assuming piecewise steady flow blanke and raynaud 1997 cf section 3 2 3 over the last two decades however the approach has been widely used in studies of large scale ocean transports see e g section 4 5 justifying a discussion of the mathematical underpinning of streamtubes for steady state flows here in this review manuscript the ocean is a nearly incompressible fluid thus for this review we consider an incompressible boussinesq fluid which means that the velocity field is non divergent 5 v 0 consequently the volume of a material fluid particle remains constant i e it is incompressible a streamtube is a bundle of streamlines so that streamtube sides are parallel to the velocity see e g fig 3 6 in kundu et al 2012 4 4 one may think of streamtubes as the communication cable lines within an incompressible fluid transmitting volume signals within a steady flow for a steady flow streamlines are equivalent to material pathlines in which case streamtubes are material tubes it is for the steady case that we can make use of streamtubes to map out volume transport pathways in an incompressible fluid we see this property by integrating the non divergence constraint eq 5 over the streamtube and making use of gauss s law doing so reveals that volume transport volume per time through the two streamtube ends balances exactly 6 a 1 v n d a a 2 v n d a 0 where n is the outward normal at the respective end and da the corresponding area by construction v n 0 on the streamtube sides so the sides do not contribute to the balance in eq 6 hence the volume transport entering one streamtube end equals to that leaving the other end furthermore the area of the streamtube is inversely proportional to the local normal velocity the transport constraint 6 holds regardless of whether there is diffusive tracer mixing in the boussinesq fluid it follows from the non divergence property of the velocity field in an incompressible fluid however in the presence of diffusive tracer mixing the actual material entering one end of the streamtube is not necessarily the same as the material exiting the other end see also section 2 5 the above properties make streamtubes useful for understanding the circulation in a steady incompressible fluid in particular they provide the mathematical basis for lagrangian analysis methods that tag particles with volume transport e g eckart 1948 welander 1955 the aggregated integral curves for such particles define a probability density function pdf for volume transport pathways in the continuum and under the assumption of a steady flow field volume transport pathways deduced from streamtubes are identical to pathways deduced from particle trajectories determined by time stepping eq 1 we can make use of the volume transport information carried by streamtubes for lagrangian analysis to do so define the starting point for a streamtube by assigning a volume transport to each particle the assigned volume transport is directly proportional to the transport crossing the grid cell face where the particle is initialized in principle we can fill a non divergent flow field without void between streamtubes consequently we can compute streamtube derived volume transport pathways whether the flow is laminar or turbulent however turbulent flow generally requires more streamtubes to develop robust statistics for the transport pathways and also requires that the flow is assumed piecewise steady see also section 3 2 3 as for any transient flow steady state streamlines lose their equivalence to pathlines 2 5 an introduction to tracer transport pathways a finite size material seawater parcel is comprised of fresh water and tracers of other matter such as salts and biogeochemical components 5 5 conservative temperature can also be considered as the concentration of heat in a parcel the reason is that to a very good approximation conservative temperature satisfies a source free tracer equation analogous to salinity mcdougall 2003 graham and mcdougall 2013 tracer concentration c measures the mass of tracer per parcel mass the velocity considered in fluid mechanics is the barycentric velocity section 2 2 so that the mass or volume for a boussinesq fluid of a material fluid parcel is constant however the mass of each trace constituent is not materially constant since tracers are exchanged between parcels through mixing in the presence of concentration gradients since the small scale motions that govern this mixing are hardly ever resolved in ogcms the effect of tracer mixing has to be represented as resolution dependent diffusive transports based on mean distributions in section 2 4 we defined volume transport pathways according to streamtubes in a steady flow here we introduce transport pathways defined by trace constituents in the presence of diffusive tracer mixing tracer and volume transport pathways are distinct the machinery of stochastic differential equations sdes is required to compute tracer transport pathways with details deferred to section 3 3 our purpose here is to anticipate that discussion by introducing various forms of the tracer concentration equation in so doing we also introduce the residual mean velocity 2 5 1 the tracer equation with subgrid scale transport molecular diffusion as well as turbulent subgrid scale transport processes give rise to irreversible diffusive transport as well as reversible advective or skew diffusive transport mathematically we express the subgrid scale tracer transport through a transport tensor j the corresponding tracer concentration equation takes the form 6 6 we assume a boussinesq fluid when writing the tracer eq 7 7 t v c j c where the transport tensor j has units of squared length per time it is convenient to split the transport tensor into the sum of a symmetric and anti symmetric tensor 8 j k a the symmetric tensor k has components satisfying 7 7 we make use of cartesian tensors throughout this review with results generalizable to arbitrary coordinates 9 k i j k j i this tensor corresponds to diffusion so long as it is positive definite the anti symmetric tensor a corresponds to skew diffusion or equivalently to advection e g middleton and loder 1989 griffies 1998 given the decomposition of the transport tensor 8 we find it useful to write the tracer equation in the form 10 t v c k c where 11 v v v defines the residual mean velocity and 12 v j i a i j is known as the eddy induced velocity 8 8 repeated indices are summed over their range notably the eddy induced velocity is non divergent due to the anti symmetry property 13 a i j a j i v 0 consequently the tracer eq 10 can be written in the flux form 14 c t v c k c since both v and v are divergence free one can define a streamtube in a steady state flow according to either velocity field the streamtubes defined by the residual mean velocity are often more relevant than those for the eulerian time mean velocity for ocean transport since the residual mean velocity v incorporates information about subgrid scale eddy advective transport drijfhout et al 2003 for example explicitly calculated particle trajectories with both eulerian mean and residual mean velocities and discussed the differences in overturning pathways particle trajectories using the eulerian mean exhibit motions that cross mean isopycnal surfaces whereas trajectories making use of the residual mean better respect the adiabatic nature of the meridional overturning flow 2 5 2 introducing the fokker planck equation anticipating the discussion of stochastic differential equations sdes in section 3 3 1 we manipulate the diffusive contribution in the tracer eq 14 the aim is to write the tracer concentration equation in the form of a fokker planck equation see eq 24 which describes the time evolution of the probability density function of the tracer for this purpose we use the identity 15 i k i j j c i j k i j c c j k i j so that 16 c t v drift c i j k i j c where we introduced the drift velocity 17 v drift v k the drift velocity generally has a non zero divergence 18 v drift i j k i j since ij kij does not generally vanish 9 9 one notable case where v drift 0 is isotropic diffusion with a constant diffusivity e g molecular diffusion molecular diffusion is generally not relevant for large scale ocean models as models and large scale observations do not resolve down to the kolmogorov scales hence large scale models make use of the far larger and flow dependent eddy diffusivities eq 16 is the tracer equation written in the form of a fokker planck equation tracer transport pathways differ from volume transport pathways in the following ways first as already mentioned the drift velocity v drift is generally divergent hence it is not useful to define steady state tracer streamtubes in terms of v drift second even if k 0 so that the drift velocity is divergent free e g isotropic diffusion with a constant diffusivity tracer pathways are affected by diffusive mixing between fluid particles to represent such diffusion in a lagrangian trajectory calculation requires a stochastic noise term weighted by the diffusion tensor section 3 3 therefore whether one considers volume transport pathways or tracer transport pathways depends on the scientific question and the information available to address that question 2 5 3 using particles to track a tracer patch there is yet another way to consider tracer transport pathways using lagrangian analysis for this approach we represent a patch of tracer as a collection of lagrangian particles e g bennett 2006 lacasce 2008 in this way lagrangian analysis can be used to study tracer dispersion rossi et al 2013 wang et al 2016 in principle in the limit of infinite number of particles and knowledge of the velocity field to arbitrarily fine spatial and temporal resolution the tracer dispersion from lagrangian particles would have theoretically perfect resolution and controllable numerical diffusion how achievable this is in real world simulations remains an area of active research a tracer patch can be represented by a cloud of particles each particle carries a portion of the total tracer content let c denote the tracer volume per particle the corresponding eulerian tracer concentration c x t can be written 19 c x t i 0 n w x x i t c i where n is the total number of particles x i is the particle position and w is a mapping kernel function dimensions inverse volume that maps the particle density to tracer density the kernel function satisfies the normalization condition required to conserve volume 20 ω w d x d y d z 1 where ω is the integral volume in three dimensions the form of w has been extensively investigated in the smoothed particle hydrodynamic approach monaghan 1992 different forms of w exist with different projection errors 3 computing lagrangian particle trajectories in this section we discuss technical aspects of lagrangian modelling and analysis focusing here on the computation of trajectories we consider how trajectories of virtual lagrangian particles can be used in mapping both volume transport pathways and tracer transport pathways recall the distinction discussed in section 2 5 3 1 basic needs for lagrangian trajectory calculations for volume transport pathways one needs a non divergent velocity field a three dimensional non divergent velocity can be produced by sampling a boussinesq ocean model thus offering a means to compute three dimensional trajectories to compute tracer transport trajectories we need both a velocity field and a diffusion tensor the diffusion tensor is a function of the often poorly known subgrid scale flow and it is generally a complex function of the flow field consequently the calculation of tracer transport pathways is somewhat less mature than volume transport pathways though see tables 1 and 2 when using an ocean model we distinguish between two techniques of lagrangian integration the first occurs online whereby trajectories are computed each time step that the eulerian model is updated examples of such online methods are available for volume transport pathways using the velocity field see section 3 5 in contrast we know of no example of online tracer trajectory calculations making use of both the instantaneous velocity field and the diffusion tensor the second method for lagrangian analysis occurs through off line trajectory calculations off line methods make use of stored velocity fields sampled from the eulerian model off line trajectory calculations offer the ability to compute trajectories in a forward mode from their starting point forward in time or in a backward mode from their ending point backward in time as an alternative to velocities generated by ogcms we may use observation based data from floats or drifters which generally give a two dimensional surface velocity e g koszalka et al 2011 we may also diagnose a surface geostrophic velocity by differentiating gridded satellite observations of the sea surface height e g klocker et al 2012b notably both surface drifter float velocities and surface geostrophic velocities generally have a non zero horizontal divergence surface geostrophic velocities are non divergent only on an f plane and the corresponding surface trajectories do therefore not map volume transport pathways nonetheless the resulting surface trajectories do map preferred pathways of the surface flow thus providing useful diagnostic information computation of particle trajectories using a velocity field requires essentially two operations a way to integrate the trajectory eq 1 and a way to interpolate a gridded velocity field to an arbitrary point in space and time in this section we detail these aspects 3 2 temporal integration of the virtual particle trajectory equation when the nth virtual seawater particle is located at the point x n t x we can update its position by time stepping the velocity eq 1 21 x t δ t x t t t δ t v x τ τ d τ where we dropped the trajectory super script n to simplify notation note that the integrand involves the eulerian velocity field v x τ which equals to the lagrangian velocity d x t dt when evaluated at x t x in some applications of lagrangian analysis there is an additional term on the right hand side of eq 21 that represents unresolved physics see section 3 3 2 we explore various flavours of this discrete time stepping see also fig 2 for estimating virtual particle trajectories focussing on the most commonly used schemes however there are many more schemes than discussed here e g chu and fan 2014 liu and chua 2016 in general the accuracy of trajectories computed in ogcm fields depends on accuracy of the time stepping scheme as well as accuracy of the interpolation scheme used to estimate velocity at the time and position of the particle see section 3 4 note that the first three methods explicit implicit and analytical discussed below all result in identical trajectories in the continuum however the trajectories differ in numerical implementations due to algorithmic differences and truncation errors for all methods statistical significance of the diagnosed pathways is enhanced by increasing the number of deployed particles as a rule of thumb one has deployed a sufficient numbers of particles when the physical results of interest do not significantly change as the number of particles is increased e g jones et al 2016 the maximum integration time in eq 21 is limited to the run time of a given model simulation a number of oceanic processes however have time scales that exceed these run times e g england 1995 stouffer 2004 danabasoglu 2004 using lagrangian particles to temporally resolve for example the meridional overturning circulation blanke et al 1999 thomas et al 2015b or inter basin connectivity blanke and speich 2002 can be difficult with many state of the art climate models to address this problem a commonly employed ad hoc method is to loop the model data in time such that the velocity and tracer fields are returned to the first time step once the end has been reached e g döös et al 2008 van sebille et al 2012 thomas et al 2015b this approach thus permits particles to be advected for longer time scales than available from the raw data however particle looping can only work if the model has no drift in the velocity or tracer fields that there are no large unphysical jumps in the fields between the end and the beginning of the model run and that any unphysical jumps will have a small net effect on the particle pathways 3 2 1 explicit time stepping methods one way to integrate eq 21 is to multiply the velocity at a point by a time step δt to estimate the displacement this approach is known as the euler method and is correct to first order in δt better accuracy of the trajectories can be obtained by using higher order methods for the integration of eq 21 one popular method is the 4 th order runge kutta scheme e g butcher 2016 where information of the interpolated velocity field at four increments between time steps tn and t n 1 is used the fourth order runge kutta method is a member of a family of integrators dormand and prince 1980 one interesting extension is adaptive timestepping through a rk45 method where both a fourth order and a fifth order integration are performed the extra computational cost of a fifth order computation is marginal when a fourth order is already performed the difference δ x x 5 x 4 between the fifth order and fourth order solution can be computed if δx is larger than some pre chosen threshold the time step δt of eq 21 can adaptively be reduced for that particle doing so then leads to a straightforward implementation of adaptive timestepping using runge kutta integrators however it is not a priori clear how the error thresholds for δx should be chosen when working with stored velocity data as when virtual particle trajectories are computed offline temporal interpolation is usually required interpolation is needed because the interval between consecutive stored velocity fields is generally longer than the time step δt used to advance the particle trajectories in eq 21 this temporal interpolation of the velocity fields can be a large source of error particularly when the interval with which velocity fields are stored becomes longer than a few days e g valdivieso da costa and blanke 2004 qin et al 2014 3 2 2 time implicit discrete integration schemes to determine volume transport pathways the volume preservation properties of numerical integrators becomes an important consideration symplectic time integration schemes are one method used to maintain volume conservation for discrete methods they can be mathematically shown to exactly conserve area in divergence free 2d fields meaning that the area bounded by a set of particles will stay constant over time in the absence of turbulent diffusion 10 10 see hairer et al 2006 for a comprehensive description of symplectic time integration schemes and leimkuhler and reich 2004 for an introduction with applications targeted at scientists and engineers symplectic methods for lagrangian particles in two dimensions take the same form as symplectic integrators for systems of point vortices but now the velocity is prescribed marsden et al 1999 the disadvantage of these methods is that they are generally implicit in time hence they require iterative methods for example the implicit midpoint rule provides a symplectic integrator for the lagrangian trajectory equation in two dimensions mclachlan 1999 leimkuhler and reich 2004 in three dimensions the concept of symplectic integrators must be extended to lie poisson integrators for 3d incompressible velocity fields mclachlan 1999 leimkuhler and reich 2004 few 3d symplectic integrators are known though the implicit midpoint rule is known to be such an integrator and preserves volume in three dimensions 3 2 3 an analytical discrete streamtube method another volume preserving method to integrate the trajectory eq 21 takes advantage of the discrete continuity equation the resulting virtual particle trajectories respect the volume conservation property of an incompressible boussinesq fluid and thereby are particularly suited for experiments where the focus is on the advective component of the flow in brief this method analytically computes trajectories across grid cells by making use of the gridded velocity field located on grid cell faces this approach approximates streamtubes through the use of volume conservation constraints introduced in section 2 4 while these methods have their origin in applications with steady state velocity fields and the streamtube approach is formally only applicable to these cases there is a large community using extended analytical discrete streamtube methods for time varying flows too these applications typically achieve very similar results to the explicit time stepping schemes algorithms following this approach calculate trajectories for a given steady state velocity field through analytic computation of three dimensional streamtubes blanke and raynaud 1997 if the velocity fields are time evolving it is possible to sub sample them into piecewise steady fields which are only kept constant in time for a short time this approach generally increases the computational cost another method by de vries and döös 2001 allows for analytical trajectories in a time dependent case that accounts for flow changes across time steps döös et al 2017 showed that the time dependent trajectory solution is more accurate than the piecewise steady solution especially in eddying regions and only at a very small additional computational cost see also a 1 2 the analytical calculations are on the scale of a model grid cell for which components of the velocity field or the volume transports are typically expressed on a staggered c grid mesinger and arakawa 1976 i e are known over the six faces of the cell see fig 2 11 11 this method can also be used for a grid or b grid stencils so long as these grids offer conservative volume transport components on tracer cell faces the use of conservative flux based transport schemes is a basic property of any finite volume ocean model regardless the horizontal grid stencil the analytical method is enabled by assuming that within a grid cell the fluid velocity exhibits a linear variation of each velocity component along each corresponding direction so that 22 v subgrid u x v y w z these subgrid scale velocity components u x v y w z are linear functions of their arguments with the precise form of these functions determined by the known velocity components on the cell faces this form of the subgrid scale velocity then allows one to write analytical trajectory equations along the three axes across the grid cell analytic time integration of these equations binds each coordinate point x y z in a grid cell to time in the cell grid cell crossing times in each of the three directions are evaluated independently by imposing any of the six grid cell sides as a possible final position the minimum crossing time specifies the actual crossing time and hence the trajectory this approach then allows for an accurate within the confines of the basic assumption of eq 22 calculation of the final position of a particle on the relevant exit side of the grid cell this method for computing volume transport trajectories is both fast and self consistent it is fast because it only calculates particle positions on the edge of individual grid cells it is self consistent since it respects the local three dimensional non divergence of the boussinesq flow both at the subgrid and the large scale it therefore provides a judicious method to map volume transport pathways by realizing a discrete implementation of streamtubes introduced in section 2 4 streamtube based volume transport is reversible so that backward integrations can be performed to track the origin of a given volume it is for these reasons that practitioners of discrete streamtube methods generally do not introduce diffusion or stochastic noise when computing particle trajectories rather the method is focused on determining volume transport pathways defined from the resolved or the residual mean flow 3 3 computing stochastic trajectories to simulate diffusion and unresolved physics as noted above streamtubes track water volume in a steady state flow however in many applications in oceanography one is interested in tracking tracers such as heat salt or nutrients and how they are affected by subgrid scale diffusion and unresolved physics such as mixed layer processes and deep convection e g van sebille et al 2013 tracer concentrations can directly be computed from the spreading of a cloud of particles described by stochastic differential equations sdes see section 2 5 2 where unresolved physics are represented by stochastic noise two main approaches can be distinguished in efforts to add diffusion to trajectories one is to start with the tracer eq 16 where the eddy transport is parameterized in terms of the eddy induced velocity and the appropriate form of the diffusivity tensor in order to derive the sde for particle trajectories section 3 3 1 the second approach section 3 3 2 is to use an ad hoc sde where a markov model is fit to observations from surface drifter trajectories or virtual particles in a much finer resolution velocity field it remains an active area of research under which circumstances e g underlying research question spatial and temporal model data resolutions and how exactly stochastic noise representing subgrid scale diffusion should be implemented see also section 3 3 3 3 3 1 stochastic trajectories using the fokker planck equation here we provide a brief introduction to the implementation of stochastic terms through the use of a fokker planck equation the discussion here makes use of the more thorough discussions provided in the textbooks by gardiner 1985 jazwinski 1970 and kloeden and platen 1992 as well as the oceanographic review by visser 2008 advantages of this lagrangian sde approach over eulerian tracer computations are that it can deal with steep concentration gradients and that tracer concentration can never become negative a stochastic differential equation sde for a general trajectory x t is given by 23 d x i t a i t x d t σ i k t x d w k t x t 0 x 0 in this equation xi t are components of the tracer trajectory vector x t and d x i t x i t d t x i t is the stochastic particle displacement during the time interval t t d t the term ai t x is a deterministic drift whereas σik t x is related to a tracer diffusion tensor see eqs 25 and 26 below finally wk t is a wiener process or brownian motion modelling stochastic fluctuations that represent unresolved motions like eddies waves or small scale turbulence the increment d w k t w k t d t w k t is a gaussian variable with zero mean and variance dt with non overlapping increments independent of each other the stochastic model 23 is markovian which means that information on the probability density of the trajectory x t at time t is sufficient to make predictions at later times non markovian models require information at earlier times which is generally impractical the presence of the wiener process means that integrating the equation using deterministic calculus does not produce a unique solution we make use of ideas proposed by itô who developed a stochastic calculus to produce a unique solution of the sde 23 12 12 the itô calculus used here is but one mathematical approach for realizing a unique solution to a sde e g gardiner 1985 stratonovich and itô backward approaches offer alternative stochastic integration methods and they can also be used to derive stochastic particle models gräwe et al 2012 shah et al 2011 spivakovskaya et al 2007a 2007b we focus on the itô calculus as it is well known to physicists as is the corresponding fokker planck equation furthermore the drift ai t x of an itô sde represents the mean of the stochastic particle tracks finally the well known euler scheme see eq 28 below is a straightforward numerical approximation of the itô sde whereas this scheme cannot be used to discretize a stratonovich or an itô backward sde a cloud of particles will estimate the probability density p t x for the stochastic tracer trajectories use of an itô stochastic process x t ensures that the probability density function evolves according to the following itô form of the fokker planck or forward kolmogorov equation 24 p t i a i p i j b i j p p t 0 x p 0 x with 25 2 b i j σ i k σ j k we can relate the fokker planck eq 24 to the boussinesq form of the tracer eq 16 so that 13 13 the tensor elements σik t x are not uniquely determined by the diffusion tensor k however all choices consistent with the relation 2 k i j σ i k σ j k result in statistically identical diffusion processes 26 b i j k i j a i v i j k i j p c the corresponding sde for the trajectory is given by 27 d x i t v i k i j x j d t σ i k t x d w k t x t 0 x 0 it is through this connection that we can derive a stochastic lagrangian model for any advection diffusion tracer equation stochastic tracer trajectories can be generated numerically through discrete approximations to the itô stochastic differential equation kloeden and platen 1992 discretizing the continuous stochastic differential eq 27 using the euler scheme leads to 28 x i t δ t x i t v i j k i j δ t σ i k t x δ w k t x t 0 x 0 in this equation δwk t is a gaussian random variable with zero mean and variance δt generated via a random generator the accuracy of the euler scheme is o δ t 1 2 in the strong sense i e for approximating the individual particle trajectories when used to generate many trajectories in order to approximate the probability distribution or equivalently the tracer concentration then the euler scheme is o δ t accurate i e the euler scheme is o δ t in the weak sense more accurate numerical schemes have been developed such as in gräwe et al 2012 shah et al 2011 shah et al 2013 and spivakovskaya et al 2005 2007a 2007b there are methods to compute trajectories directly from a sde for many applications e g kloeden and platen 1992 trajectory computation directly from sdes is less mature in large scale oceanography where it is often difficult to include a realistic diffusion tensor for subgrid scale tracer transport appendix b offers an example of tracer trajectories in the presence of an isopycnal diffusion tensor with a time constant diffusivity this application is nontrivial and a major advance in the lagrangian tracer trajectory method unfortunately it is not fully representative of modern parametrisations for global models whereby the diffusivity is a function of space and time abernathey et al 2013 and the diffusivity tensor may be anisotropic in the lateral directions as well as between lateral and vertical fox kemper et al 2013 even with a constant isopycnal diffusivity sampling components of the 3 3 diffusion tensor for offline analysis is a nontrivial computational task particularly in the presence of realistic temporal variability additional difficulty arises from time variations in the diapycnal diffusivity used for planetary boundary layer schemes consequently the current generation of explicit sdes for tracer trajectories are generally restricted to relatively coarse resolution models with rudimentary subgrid scale parametrisations e g shah et al 2017 although efforts are underway to improve this 3 3 2 a hierarchy of markov models for stochastic trajectories the second approach to adding the effects of diffusion and unresolved physics to particles is to ad hoc find an sde that matches the statistics e g eddy decorrelation time scales and diffusivity of the stochastic trajectories with either observations or particles simulated in finer resolution models this approach has been developed by griffa 1996 and further by berloff and mcwilliams 2003 in the context of ocean models see also vallis 2006 section 10 2 and lacasce 2008 for discussion and veneziani et al 2004 and koszalka et al 2013a for implementations a hierarchy of markov models is considered whereby the stochastic term is added to either particle displacement zeroth order markov model corresponding to uncorrelated eddy velocity field the particle velocity first order model accounting for correlations of the velocity or the particle accelerations in most cases the first order model is found to best approximate the oceanic mesoscale turbulence introduced by coherent eddies in the first order markov model multiplicative noise stochastic noise is used to modify the present position of a particle when updating to a new position in which case the trajectory eq 21 can be written as 29 x t δ t x t 1 ϵ t t δ t v x τ d τ where ϵ is a random number notably the application of noise in this manner does not ensure that x t δ t results from time stepping a divergence free velocity for that purpose we consider an alternative approach whereby we introduce a stochastic divergence free velocity 30 x t δ t x t t t δ t v x τ v noise x τ d τ we can ensure v noise 0 by introducing a stochastic vector streamfunction so that for each grid cell we have 31 v noise x ψ noise x since the stochastic velocity remains non divergent this approach offers a realisation of stochastic streamtubes in steady state flows the choice of either eq 29 or 30 depends on the application and will be further discussed in section 3 3 3 in the zeroth order markov model additive or random walk noise the stochastic noise is added to the particle positions which is often applied in a rather simple form by adding an extra term to the trajectory eq 21 32 x t δ t x t t t δ t v x τ d τ r 2 k δ t in this equation r n 0 1 is a random number taken from the normal distribution with zero mean and unit variance and k is a constant tracer diffusivity a major limitation of this model is that if the drift term is omitted eq 32 will lead to artificial accumulation of particles in regions of low diffusivity requiring an enhancement of the random walk model hunter et al 1993 visser 1997 ross and sharples 2004 berloff and mcwilliams 2002 a myriad of behaviours can be added to a random walk model for capturing the biological characteristic of lagrangian particles examples include diurnal vertical migration temperature dependent planktonic larval duration and time to settling competency while it must be noted that enhanced complexity does not necessarily imply enhanced accuracy studies have shown that even modest vertical migration velocities can significantly alter the dispersal patterns of propagules for example a recirculation in the western irish sea of northwest europe associated with summer stratification retains surface drifters but does not retain vertically migrating organisms phelps et al 2015 3 3 3 when and how to add stochastic terms in the above we have described a few methods to incorporate mixing through stochastic terms however exactly when and how to implement these terms is an open question it will likely depend on the temporal and spatial resolution of the velocity fields as well as the unresolved processes that the added stochastic components are intended to reproduce in particular the consideration should be whether mesoscale coherent eddies and attendant nonlocal transport properties velocity correlations and steep eulerian velocity spectra are resolved by the ocean model velocity field underlying the lagrangian simulations if a velocity field is available at sufficiently high spatial and temporal resolution adding a stochastic component may be unnecessary and high numbers of particles may suffice koszalka et al 2013b if the available velocity field does not resolve important eddy processes a first order or second order markov model may need to be used to account for a velocity correlations induced by the mesoscale eddy field griffa 1996 berloff and mcwilliams 2002 lacasce 2008 the applicability of the stochastic simulations should in any case be verified against existing observations koszalka et al 2013a or high resolution model simulations if available it is also still open how the fokker plank equation approach section 3 3 1 and the ad hoc markov model approach section 3 3 2 can be combined while the first approach is more mathematically rigorous the second provides an insight into the properties of observed or simulated oceanic turbulence on different scales and in different regions and may be useful in building future parameterizations of eddy induced transport in terms of lagrangian stochastic parameterizations we leave this discussion of diffusivity here as the research and understanding of this issue is rapidly evolving and strongly encourage the community to gain a better understanding in how best to implement diffusion and unresolved physics for lagrangian particles 3 4 spatial interpolation the trajectory eq 21 is defined on continuous velocity fields however all ocean models work with discretized grids where velocities are only known on either vertices or edges of the grid cells griffies et al 2000 therefore computing lagrangian trajectories from ocean model data requires reconstruction of the continuous velocity field inside grid cells bilinear trilinear or spline interpolation are viable choices on structured grids interpolation on unstructured grids can be accomplished via methods derived from particle based approaches e g inverse distance weighting or kernel based convolutions or unstructured extension of grid based spatial interpolation e g wachspress interpolation gillette et al 2012 on grids where velocities are defined on the corners of grids e g arakawa a and b the reconstruction choices include weak form reconstruction perot 2000 radial basis functions baudisch et al 2006 or reconstruction via finite element basis functions wang et al 2011 on grids where velocities are known on the edges of grid cells e g arakawa c this reconstruction is often done using simple linear interpolation although more work needs to be done investigating what the errors are that arise from this horizontal interpolation on arbitrary simplexes from vertex data is provided by wachspress interpolation gillette et al 2012 which is a super linear interpolation scheme for arbitrary simplexes for triangles wachspress interpolation is equivalent to barycentric interpolation which is commonly used on triangular meshes and readily available in scientific packages e g python matplotlib a primary benefit of this approach is that it provides a continuous interpolant e g c 0 continuous options for higher order interpolation to obtain c n for n 1 continuity are more complex and less common particularly on arbitrary unstructured meshes horizontal interpolation via wachspress naturally keeps particles within the domain for no slip conditions where the velocity is zero for boundary points on simplexes particles can be constrained to remain within the domain by maintaining cfl 1 where cfl is the courant friedrichs lewy condition e g durran 1999 this implementation is intrinsically free of if statements however free slip boundary conditions require further adaptation vertical interpolation choices include linear and spline interpolants linear interpolation is a standard approach and is consistent within model accuracy particularly for fine vertical resolution spline interpolation however allows representation of vertical curvature but at the potential cost of artificial maxima and minima particle tracking can employ a spatially decoupled advection strategy by splitting horizontal and vertical integration steps into sequential operations the benefit of this approach is that it decouples unstructured interpolants in the horizontal from one dimensional interpolation in the vertical and allows different particle behaviours to be employed for example vertical interpolation of velocities to specific potential density surfaces allows particles to be advected isopycnally and avoid diapycnal mixing that can occur with neutrally buoyant particle advection wolfram et al 2015 3 5 available tools as discussed throughout this section it is in principle straightforward to compute lagrangian particle trajectories by time stepping the trajectory eq 21 one merely needs to save the velocity field and update the trajectories using available software like matlab or python invoking either rudimentary schemes or built in functions such as the matlab ode suite several research groups have developed their own virtual particle codes tailored to specific model output format model grid and boundary conditions examples include a 3d lagrangian matlab code for the mitgcm used by koszalka et al 2013b and von appen et al 2014 and a 2d matlab code of the nonlinear dynamical systems group at eth zurich farazmand and haller 2012 http georgehaller com software software html however significantly more effort is required to develop an analysis code that features a user friendly interface and thus can be utilized across the modelling communities further work is needed to ensure that the code is efficient on data input output the suite of available tools can roughly be separated into two sets first there are large community based lagrangian codes such as ariane tracmass the connectivity modelling system cms and the new parcels code these are model independent run offline i e on stored velocity data and provide extensive control on particle behaviour the second set includes lagrangian codes tied to and sometimes distributed with specific models such as mitgcm hycom nemo roms and mpas o these model specific codes can be run online i e during the computation of the velocity data examples from both types of codes are discussed in appendix a these codes are also summarised in tables 1 and 2 notably all of these codes employ either explicit or implicit time integration of volume transports and while some can incorporate additional random terms section 3 3 2 there are no community codes available for computing tracer trajectories through the sde based methods of section 3 3 1 4 applications of lagrangian particle trajectories for most applications the raw particle trajectories output by lagrangian analysis codes need to be further processed to help answer scientific questions in this section we overview ways in which lagrangian particle trajectories can be used and analysed to improve our understanding of ocean circulation and dynamics 4 1 dispersion and diffusivity the ensemble particle dispersion and its rate of change the diffusivity are the fundamental lagrangian diagnostics of use for understanding tracer transport in oceanic flows particle trajectories can be used to diagnose eddy diffusivity via single pair and cluster techniques the detailed theoretical and practical underpinnings of these techniques in the context of oceanic flows are summarized by lacasce 2008 here we reiterate the main points the single particle diffusivity stems from the seminal work of taylor 1921 it quantifies the ensemble mean rate of particle dispersion from an initial location so that we have 33 κ t 1 2 d d t x 2 t v t x t 0 t v t v τ d τ in this equation x t is the lagrangian virtual particle trajectory and v t d x t d t is the lagrangian particle velocity the taylor formulation pertains to homogeneous stationary and isotropic flows and is non trivial to apply in practice different approaches to estimation of single particle statistics for particles deployed in stationary and homogeneous eulerian flows with cautious notes on particle deployment strategies and transient behavior are discussed by davis 1982 in the context of numerical simulations for modelled ocean flows of realistic complexity the estimation of single particle statistics must be further refined to account for non stationarity and inhomogeneities of the underlying eulerian field davis 1983 1985 1987 1991 under the assumption that the velocity field is slowly varying with respect to the time increment dt in practice dt can be the time step of a lagrangian model this assumption can be satisfied by segmentation of trajectories over a relevant time scale e g seasonal cycle the velocity decorrelation time scale and segregation in space into locally homogeneous regions davis 1991 koszalka and lacasce 2010 see also section 4 3 if the focus is on the transport by mesoscale turbulent flows eddy diffusivity an appropriate technique for the mean or slowly varying flow removal must be applied to the lagrangian velocity in eq 33 e g berloff et al 2002 rypina et al 2012 lumpkin and johnson 2013 the lagrangian transport anisotropy can be quantified by using the concept of tensor diffusivity where eq 33 applies to the different velocity vector components and projection of the flow in the along and across flow directions of maximum dispersion rypina et al 2011 2012 fox kemper et al 2013 kamenkovich et al 2015 wolfram et al 2015 in general anisotropy of the lagrangian transport arises from spatio temporal patterns and velocity correlations due to eddies a significant challenge is that the observed lagrangian particle dispersion is often non diffusive on long time scales e g rypina et al 2012 due to persistent lagrangian flow correlations double particle statistics builds upon the works of batchelor 1952 and bennett 1987 the relative diffusivity the time rate of the mean square pair separation is 34 κ r t 1 2 d d t r 2 t 1 2 d d t m n x m t x n t 2 where the sum is over all pairs of particles m n at times longer than the velocity decorrelation time scale the pair particles move independently from one another and the relative diffusivity is constant at twice the single particle diffusivity lacasce 2008 using the relative diffusivity rectifies the problem of the time mean flow removal by measuring particle relative separation though it will still be influenced by the mean flow shear in practice double particle statistics are often implemented in terms of cluster or moment methods which are equivalent to double particle statistics on the plane lacasce 2008 the single and double particle diagnostics derived from simulated trajectories may be used for the following quantifying the advection by the turbulent mesoscale flows eddy diffusivity in eddying models as a function of time and separation for example for parameterisations of diffusive processes in models that do not resolve eddies poje et al 2010 eddy diffusivity maps obtained by binning see section 4 3 quantify regional variability in eddy diffusivity and other derived statistics eddy length time scales e g lacasce et al 2014 griesel et al 2014 2015 investigating the nature of the oceanic turbulent transport the relative diffusivity as a function of particle separation is related to the eulerian kinetic energy spectra together with the fsles see section 4 2 the relative velocity diagnostics and the pair displacement pdfs can be used to check for consistency with quasigeostrophic turbulence chaotic advection and mean shear lacasce 2008 koszalka et al 2009 4 2 lagrangian coherent structures the ocean is full of eddies jets and other coherent structures which are visible in ocean tracers such as temperature or chlorophyll the field of lagrangian coherent structures lcs aims to identify the kinematic skeleton of such objects based on the lagrangian trajectories of the fluid and to study the role of these structures in transport here we provide a very brief introduction and overview of the field and refer the interested reader to the more comprehensive review articles on the topic e g peacock and dabiri 2010 peacock and haller 2013 haller 2015 the most developed branch of lcs theory is concerned with identifying distinguished material surfaces which serve as the boundaries of coherent regions in unsteady flows according to haller 2015 a method for identifying such surfaces must a be objective i e gives the same result in all observer reference frames b be applicable over a finite time interval c describe an actual material surface and d converge with respect to spatial resolution many different lcs diagnostics have been developed to detect different types of structures a starting point in many lcs identification methods however is the finite time flow map f t 0 t x 0 which gives the positions at time t of particles initially located at x 0 at time t 0 the flow map can only be calculated by numerically advecting a large ensemble of closely spaced lagrangian particles from this flow map one can compute the cauchy green strain tensor c x 0 f t 0 t x 0 t f t 0 t x 0 which measures the magnitude of the growth in separation of infinitesimal perturbations in the initial position space c is characterised by its eigenvalues λ and corresponding eigenvectors the original diagnostic of lcss is the finite time lyapunov exponent ftle the ftle is a measure of the exponential rate of separation of trajectories of infinitesimally close initial points over a finite time interval and is given by 35 f t l e x 0 t 0 τ 1 τ ln λ m a x with λmax the maximum eigenvalue of c over the chosen finite integration time τ t t 0 early applications of the ftle were to distinguish regions of high and low predictability in chaotic flows ftle pierrehumbert and yang 1993 artale et al 1997 later ftle fields were applied to the identification of attracting and repelling transport barriers haller and yuan 2000 lapeyre 2002 the ridges i e curves of local maxima of the ftle field correspond with repelling lcs positions at t 0 as regions of extreme local stretching these structures represent material barriers which remain coherent under advection unlike general material lines attracting lcss which represent the lagrangian skeleton of tracer filaments can similarly be obtained as ridges of the ftle field calculated from a backward time integration haller and sapsis 2011 review different strategies for calculating attracting and repelling lcss from forward and backward time ftles a related diagnostic is the finite size lyapunov exponent fsle aurell et al 1997 which represents the time required for particle separation to reach a specified size fig 3 fsles have also been used widely for lcs identification and can be related to the statistics of turbulent dispersion lacasce 2008 however karrasch and haller 2013 proved that fsle and ftle ridges do not coincide in general and argued that fsles were less reliable for the identification of lcss the statistics of ftle and fsle based on flow maps constructed from lagrangian particle trajectories have been applied to characterize regimes of dispersion and regional differences in mixing drijfhout et al 2003 waugh and abraham 2008 haza et al 2010 lumpkin and elipot 2010 schroeder et al 2011 poje et al 2014 instantaneous maps of ftle and fsle derived from satellite altimetric velocities have also been used to identify lcs positions in the ocean d ovidio et al 2004 olascoaga et al 2006 lehahn et al 2007 beron vera et al 2008 attracting lcs represent transport barriers and indeed several studies have confirmed the tight correlation between the detected structures and fronts of advected tracers including sea surface temperature abraham and bowen 2002 d ovidio et al 2009 chlorophyll concentrations lehahn et al 2007 oxygen bettencourt et al 2015 oil spills mezić et al 2010 and even different dominant phytoplanktonic types d ovidio et al 2010 not all coherent structures relevant for transport can reliably be deduced from the ftle or fsle fields over the past decade lcs detection methods have developed increasing precision at discriminating different flavours of structure geometry resulting in a proliferation of techniques haller 2015 haller and beron vera 2012 used a variational approach to find the least stretching material lines in the forward and backward flow maps the initial positions of these lines called hyperbolic lcss can be identified as the geodesic curves of a riemannian metric related to the cauchy green strain tensor definitions of parabolic and elliptic lcss corresponding to jet cores and vortex boundaries can similarly be made using the tools of differential geometry haller and beron vera 2013 haller 2015 additional methods for vortex identification based on dynamic polar decomposition and lagrangian averaged vorticity deviation have recently been proposed haller 2016 haller et al 2016 while yet a different class of methods identifies lcs based on a probabilistic transfer function froyland et al 2007 a much needed critical comparison of different methods and their performance in different test cases was recently undertaken by hadjighasem et al 2017 which provides valuable practical advice for researchers wishing to implement these techniques a central preoccupation of lcs techniques is the identification of coherent mesoscale eddies beron vera et al 2013 used the elliptic lcs framework to identify materially coherent agulhas rings emphasizing the advantages over eulerian eddy identification methods while froyland et al 2012 applied the transfer function method to the same region wang et al 2016 and froyland et al 2015 used the identified structures to study the transport origin and decay of agulhas ring waters abernathey and haller 2017 used the lagrangian averaged vorticity deviation method of haller et al 2016 to identify eddies in the eastern pacific and quantify their role in meridional dispersion these studies illustrate the value of lcs methods for questions of long range material transport 4 3 probability distributions a common way to visualize trajectory data is to bin particle positions into histograms the result is a map of particle density which when normalised by the total number of particle positions yields a probability map alternatively we can produce probability maps by counting the visit of a particular particle only once per bin and then normalizing by the total number of particles instead of the total number of particle positions e g van sebille et al 2012 von appen et al 2014 both methods offer a useful means to identify flow structure through particle pathways from a set of release points fig 4 illustrates the use of both methods for studying the flow responsible for the spreading of particles originating in the agulhas current fig 4a shows the probability derived from the procedure described at first obviously bins located within the areas of the agulhas current ac the agulhas return current arc and the agulhas ring corridor show the highest probabilities highlighting the most probable spreading pathways along the major currents and via mesoscale eddies but even between the ac and arc there is a region with comparable particle position counts fig 4b reveals that this is not due to a particularly strong circulation feature transporting many particles but rather due to the recirculation of fewer particles one consideration in the choice of bin resolution is aliasing if either the grid resolution is too fine or the period of particle position updates is too long trajectories may pass through more than one histogram bin within a given output time step and thus may not be adequately accounted for the density maps from binning can also be scaled to account for the residence time in bins and the time step of the lagrangian simulation one practice is to scale the particle density maps by the time step dt to obtain the density maps in units of days e g koszalka et al 2011 another is to scale the particle densities in bins with the integral lagrangian time scale tl yielding particle distributions in bins in terms of the number of independent observations n i n d n t t l where t is the total time e g koszalka and lacasce 2010 apart from using particle density maps to assess the water mass pathways and connectivity binning of particle positions and their corresponding properties allows the investigation of mean properties temperature density and their changes along simulated trajectories e g van sebille et al 2014 binning lagrangian velocities to test the gaussianity of their distributions and other velocity statistics is yet another application lacasce 2005 the binning is also used to construct maps of eddy diffusivity from particle simulations in high resolution models e g lacasce et al 2014 griesel et al 2014 2015 using binning to estimate spatially dependent eddy diffusivities pseudo eulerian eddy diffusivity maps and other parameters maps of eddy time and length scales has been widely used in observational lagrangian analysis bauer et al 2002 koszalka et al 2011 rypina et al 2012 lumpkin and johnson 2013 zhurbas 2004 as well as in particle simulations in eddy resolving models e g berloff et al 2002 lacasce et al 2014 griesel et al 2014 2015 binning can be used to verify the spreading of lagrangian particles by comparing the ensemble particle movement with large scale distributions of either conserved quantities such as potential vorticity or a tracer field whose evolution is explicitly computed online in the ogcm e g gary et al 2012 such evaluations can be statistically formalised using pointwise correlation between the binned histogram and the online tracer simons et al 2013 binning is not limited to spatial boxes as particles can be binned by virtually any variable that can be determined along a particle s path for example depth time density temperature salinity etc this sort of binning can be useful to highlight along pathway water mass transformations e g koszalka et al 2013b iudicone et al 2011 gary et al 2014 van sebille et al 2014 particles can also be binned by the distance from the deployment site such a distance metric can be redefined to account for the topographic steering davis 1998 finally an alternative to binning was proposed by koszalka and lacasce 2010 rather than grouping the lagrangian data in bins of fixed size they grouped a fixed number of nearest neighbour particle positions together using a clustering algorithm 4 4 water mass ages and transit times the age of ocean water or the time taken for water to transit between defined regions or reservoirs is a property of the flow that provides useful understanding of the ocean circulation deleersnijder et al 2001 such a metric can be easily derived from lagrangian calculations by determining the transit time of particles since the age of water can also be recovered from float trajectories or observations of chemical tracers fine et al 2002 waugh et al 2004 there is the possibility to use the age to evaluate model results in comparison to observations however this comparison requires careful interpretation khatiwala et al 2001 and has been rare e g haines et al 1999 the age of a parcel of ocean water described by numerous particle trajectories is not unique since different particles may transit between two regions by distinct pathways travelling for different lengths of time phelps et al 2013 as such the age of ocean water is in fact a probability distribution the transit time distribution ttd that an individual particle might take to travel between the two regions holzer and hall 2000 deleersnijder et al 2001 haine and hall 2002 given a sufficient number of lagrangian trajectories a ttd between two regions can be formed from a histogram of the particle ages see fig 5 for an example in the agulhas region in lagrangian ocean analysis the range maximum or variance of this ttd is used to understand the inherent timescales of the circulation e g rühs et al 2013 however transit time distributions are highly sensitive to the spatial scales resolved by the numerical model from which lagrangian trajectories are determined in lagrangian analyses the age can be evaluated as the time since a particle was last within the surface ocean the ventilation timescale in which case it reveals the timescales on which the ocean interacts with the atmosphere and influences global climate this method has been considered for the global ocean blanke and speich 2002 as well as specific water masses koch larrouy et al 2010 in regional seas with riverine forcing an analogue to ventilation with the atmosphere is freshwater age phelps et al 2013 one difficulty is that the ventilation timescale of deep ocean flows which can be on the order of thousands of years often exceeds the length of available ogcm output such that the velocity fields must to be looped to calculate the full ttd see also section 3 2 by considering the entry and exit of particles from an enclosed region transit times can be interpreted as a residence timescale for a marginal sea with one point of exchange such as the baltic sea this has been used as an alternative to the classic box model approach döös et al 2004 jönsson et al 2004 where there are multiple points of exchange such as the arctic ocean the approach determines the timescales on which these gateways interact lique et al 2010 lagrangian transit times are also used to evaluate the timescales on which anomalies in a certain region would influence the flow downstream e g speich et al 2001 van sebille et al 2011 rühs et al 2013 or to determine time integrated properties of specific flows such as the average speed koszalka et al 2013b or the most rapid pathways gary et al 2012 4 5 volume transport and lagrangian streamfunctions among the first uses of basin scale lagrangian particle tracking was to assess seawater volume transports between chosen sites in the ocean resulting in an effective way of quantifying lagrangian connectivity in these applications each particle is tagged with a transport upon release and that transport is then conserved along the trajectory as per the streamtube discussion in section 2 4 we can construct volume transport pathways by summing the transports of particles that connect two regions see fig 6 for an illustrative example just like in the eulerian framework the concept of volume conservation as in a boussinesq fluid discussed in section 2 4 can be used to collapse the full three dimensional transport into a two dimensional streamfunction the unique feature in lagrangian streamfunctions is that they can be constructed for only that part of the flow that connects the section where particles are released and where they are received this concept has been applied to study for example the cold and warm water routes into the atlantic speich et al 2001 2002 drijfhout et al 2003 agulhas leakage durgadoo et al 2017 the pacific to indian ocean connectivity van sebille et al 2014 the lagrangian decomposition of the deacon cell döös et al 2008 and the atlantic moc thomas et al 2015b the concept of lagrangian streamfunctions was introduced by blanke et al 1999 and is closely tied to the analytical integration method section 3 2 3 consider a domain with open boundaries such as the agulhas region around south africa trajectories are initialized along the boundaries of a control volume box in fig 6 and traced until they again reach the boundaries each trajectory is associated with a volume transport and the volume transport is recorded at each grid wall crossing of a trajectory this method results in a non divergent field of volume fluxes through all grid walls that can be integrated to lagrangian streamfunctions it is to be noted that this streamfunction represents the mean flow during the whole integration period i e ideally until all trajectories have left the box both döös et al 2008 and kjellsson and döös 2012a showed that the total lagrangian streamfunction is almost identical to the eulerian streamfunction one of the main differences is that the lagrangian streamfunction is based on trajectories with varying residence times ranging from hours to months or even years while eulerian streamfunctions are snapshots or time averages 4 6 biological connectivity lagrangian particle trajectories can be used to study how water moves around in the ocean additionally lagrangian particles can be interpreted as passively drifting biological particulates many marine organisms reproduce with larvae that are dispersed at the whim of the currents hydrodynamic connectivity therefore has important implications for population dynamics e g kool et al 2013 thomas et al 2014 in particular this connectivity generally allows for longer dispersal and more rapid range expansion than is observed in terrestrial species kinlan and gaines 2003 as well as directly creating range limits gaylord and gaines 2000 understanding these processes and their implications is important for a range of management objectives transport models have provided insights in varied contexts including the creation of robust networks of marine protected areas gaines et al 2003 berglund et al 2012 burgess et al 2014 conservation of coral reefs treml et al 2008 wood et al 2013 sustainability of fisheries gilbert et al 2010 competition between biophysical and hydrodynamical controls on larvae retention phelps et al 2015 and spread of invasive species similar models are frequently applied in coastal scenarios to understand the spread of aquaculture parasites salama and rabe 2013 and invasive benthic organisms brandt et al 2008 it is important to note that horizontal resolution and subgrid scale diffusivity of the underlying eulerian flow field can be a key for the distribution and time scales as it was the case for the dispersion of european glass eels blanke et al 2012 baltazar soares et al 2014 how these larvae interact with the water column depends on a range of characteristics such as size development rate and behaviour mcmanus and woodson 2012 models investigating biological connectivity must therefore account for these characteristics and many others e g visser 2008 paris et al 2013b in addition to physical processes behaviour such as orientation and swimming in response to scent plumes released from suitable habitat holstein et al 2014 staaterman and paris 2013 is often documented as is vertical migration lampert 1989 observations of microchemical markers genetic microsatellite markers and single nucleotide polymorphisms can provide information on realised connectivity between spatially separated populations they can provide a direct comparison for lagrangian tracking predictions e g pujolar et al 2013 wilkins et al 2013 teske et al 2015 in terms of population similarity and can provide evidence of biogeographic barriers for example coral species in the gulf of mexico sammarco et al 2012 recent work hints at the possibility of applying such techniques to understand population connectivity and evaluate predicted patterns at a global scale e g hellweger et al 2014 villar et al 2015 jonsson and watson 2016 5 outlook lagrangian analysis provides a powerful tool to help interpret output from ogcms this power will only increase as ogcms enter peta scale territory in this final section we offer outlooks on where we see new and exciting opportunities and possibilities for the lagrangian analysis of ogcms 5 1 the next generation of particle tools a major challenge with particle tracking is obtaining performance for a large number order of billions of particles for small velocity data sets offline parallel particle tracking can be employed via a single instruction multiple data simd approach e g openmp or gpu based implementations however input output will remain a bottle neck with most codes simply reading in the entire velocity field even if the particles occupy only a subregion of the domain recent advances in the netcdf library toolkit however mean that it is now feasible to read in only those parts of the grid where there are particles so that the number of input output operations could potentially be reduced by orders of magnitude implementation of these new libraries in combination with better memory management and efficient use of tiered cache levels will lead to vastly faster codes that also have smaller memory footprints nevertheless for petabyte scale velocity data sets such as those from grand challenge climate simulations online particle tracking is necessary to avoid the unsustainable storage costs associated with offline particle tracking the challenge in this arena however is utilization of heterogeneous computer architectures message passing mpi between computational nodes is essential and a hybrid approach utilising on node openmp gpu or mic threading will be required on next generation architectures to obtain peak performance task based parallelism if implemented for ogcms may provide at least a partial solution however at present no definitive framework or best practice has been adopted several ogcms already have on line particle diagnostics see appendix a 2 yet no general library for coupled lagrangian particle tracking exists so far as a result development efforts are disjoint and functionalities are often model specific on the other hand run time integration with ogcms requires close coupling with grid data in order to reduce performance overheads while the variety of grid types makes finding a general abstraction difficult moreover such a library needs to provide parallel performance and scalability as well as an easily accessible api that allows it to be integrated with different types of ocean models 5 2 a case for standard tests of particle tools most of the lagrangian particle tracking tools described in section 3 5 have never been compared against each other which makes it hard to assess their skill and fidelity while most codes are designed for very different purposes we propose to develop a set of test cases that we suggest code developers to use when debugging codes this set of test cases would then also serve to highlight differences in explicit versus analytical time stepping codes for example or differences between particle tracking on a b and c grids while we envision the set to grow over time the following would be a minimum requirement a first set of tests to consider are those where analytical expressions are known for trajectories 1 radial rotation with known period this setup tests particle trajectories in the simplest possible flow without time evolution 2 longitudinal shear dispersion flow in a pipe e g fischer et al 2013 to ensure that shear dispersion effects are properly represented 3 effective lateral diffusion due to an oscillating vertical shear flow bowden 1965 to test particle trajectories in a time evolving flow 4 steady state flow around a peninsula ådlandsvik et al 2009 this setup tests particle trajectories in a domain with an obstacle and can be used to test how codes behave near land boundaries 5 steady state flow in a stommel gyre and western boundary current fabbroni 2009 to test particle trajectories in a domain with large gradients in flow speed 6 damped inertial oscillation on a geostrophic flow fabbroni 2009 döös et al 2013 to appropriately quantify sub inertial motion e g loopers 7 for codes that include diffusivity a simulation of brownian motion with a given kh and kv to test for sub grid parameterizations of diffusivity a second set of tests can be considered that do not have an analytical solution but that test for speed and efficiency of the code in more realistic idealized test cases corresponding to eddy resolving simulations e g as are becoming standard in modern climate models 8 zonally periodic baroclinic channel ilıcak et al 2012 berloff et al 2009 abernathey et al 2013 ringler et al 2016 wolfram and ringler 2017a 2017b to explore unconstrained eddy and mean flow interactions e g in an idealized antarctic circumpolar current 9 eddying double gyre flow shevchenko and berloff 2015 wolfram et al 2015 to explore idealized eddying flows constrained within an ocean basin looking forward a list such as this one might form the basis of a lagrangian model intercomparison project lmip similar to that used in the climate modelling community through the coupled model intercomparison project eyring et al 2015 or the ocean model intercomparison project griffies et al 2016 an lmip could host the velocity fields and analytical solutions of the set of test cases needed by particle model developers for debugging purposes to allow for use across a broad suite of analysis software we encourage developers of tools to make the trajectory data cf compliant as stated at http cfconventions org data cf conventions cf conventions 1 6 build cf conventions html discrete sampling geometries 5 3 whole earth system and water cycle modelling beyond quantifying the pathways of seawater in the ocean it is tantalising to consider whether lagrangian methods could be used to track water throughout the entire climate system such analysis could be used to quantify coupled thermodynamic cycles laliberte et al 2015 kjellsson et al 2014 zika et al 2012 döös et al 2012 geographical connectivity gimeno et al 2010 and the transport dilution and fractionation of salt nutrients and oxygen fig 7 here we will discuss such prospects including basic requirements and challenges of such analysis one important reason for modelling the water cycle is the intensification evident over recent decades in ocean salinity hosoda et al 2009 helm et al 2010 durack et al 2012 central to this intensification are changes to moist processes in the atmosphere held and soden 2006 however based on observed salinity and in cmip5 simulations the hydrological cycle intensifies at around half the rate predicted from moist thermodynamics alone skliris et al 2016 while observations are currently inadequate for an accurate quantification of changes in key processes hegerl et al 2015 including precipitation and evaporation over the oceans skliris et al 2014 with a lagrangian description of the global water cycle in coupled climate models it will be possible to fully explore the full range of atmospheric processes that are driving and retarding the observed intensification another motivation is the possibility of tracing stable water isotopes through the earth system stable water isotopes are a cornerstone in paleoclimate reconstructions since their concentrations can be used to infer the source of the water for example water vapour that has evaporated from the ocean has low concentrations of heavy isotopes likewise ice on antarctica also has very low concentrations of heavy isotopes so it is likely that the ice originates from evaporated water that precipitated over the continent gat 1996 hence an observed decrease in heavy isotope concentrations in the ocean could be due to either less evaporation or advection of meltwater from ice sheets or land roche 2013 if we could trace the isotopic composition of water as it moves between oceans atmosphere land and ice we could reconstruct the hydrological cycles of past climates in general if a lagrangian code is to exchange particles between ocean and other components of the earth system it must first deal appropriately with sources and sinks of water within the ocean itself it is now common for ocean models to have explicit water fluxes at the sea surface due to evaporation precipitation and river run off griffies et al 2000 these sources and sinks of water in the ocean should be accounted for in any lagrangian framework e g with sources and sinks of particles regardless of whether water is being traced between components secondly for water to be consistently traced between components of the climate system water must be conserved between them this is for example the case in some sea ice and iceberg models which are integrated into ocean modelling systems martin and adcroft 2010 marsh et al 2015 some of which incidentally use a lagrangian framework however challenges remain in conserving water consistently between the ocean atmosphere terrestrial hydrological systems e g lakes soil moisture groundwater and irrigation and ice sheets tracking water within each component of the earth system other than the ocean presents its own challenges there is for example a rich history of lagrangian methods in meteorology stohl 1998 some having evolved from the oceanographic community e g tracmass see kjellsson and döös 2012a it is common for such methods to track air masses rather than water itself water in the atmosphere comes in three phases vapour liquid and ice making the tracking of water challenging however robust methods are in common use see for example the flexpart model stohl and james 2005 gimeno et al 2010 simulating the movement of water as lagrangian particles between different components of the earth system is further complicated by vast contrasts in scale both in storage and transport rates between them the atmosphere for example holds 0 001 of all the water in the climate system while the ocean holds 97 in contrast the cycle of evaporation and precipitation over the globe amounts to approximately 16 sv i e multiplying global mean precipitation of 2 7 mm day trenberth 1998 by the area of the earth so while storage of water in the atmosphere is small relative to the ocean its transport of water is equivalent to that of major ocean currents differences in scales of motion and numerical description of these systems present great technical challenges beyond the scope of this review 6 concluding remarks in this review article we have presented an extensive overview of the state of the art in lagrangian particle analysis we focused on the use of particles determined by integral curves of the velocity field and large scale open ocean applications based on the collective knowledge of the authors we have identified opportunities and issues for improvements of these methods as we move towards a petascale age of computing we hope that the guidance provided here can provide a starting point for new users as well as an impetus for experienced users and developers of these codes acknowledgements this review paper is the result of very fruitful discussions during the future of lagrangian ocean modelling workshop held at imperial college london uk in september 2015 funding for this workshop was provided through an epsrc institutional sponsorship grant to evs under reference number ep n50869x 1 evs has received funding from the european research council erc under the european unions horizon 2020 research and innovation programme grant agreement no 715386 this research for pjw was supported as part of the energy exascale earth system model e3sm project funded by the u s department of energy office of science office of biological and environmental research funding for hfd was provided by grant no de sc0012457 from the us department of energy pb acknowledges support for this work from nerc grant ne r011567 1 sfg is supported by nerc national capability funding through the extended ellett line programme ed is an honorary research associate with the belgian fund for scientific research f r s fnrs sr was funded grant cp1412 by the cluster of excellence 80 the future ocean within the framework of the excellence initiative by the deutsche forschungsgemeinschaft dfg on behalf of the german federal and state governments we thank sergey danilov editor andrew shao françois primeau nathaniel tarshish and five anonymous reviewers for very helpful comments we also wish to thank all the scientists researchers and programmers who built the ocean general circulation and lagrangian tracking models over the past decades appendix a community tools for lagrangian ocean analysis in this appendix we provide further background to the different community codes both for offline and online particle tracking listed in tables 1 and 2 a1 community based offline 3d lagrangian codes a1 1 ariane ariane is a numerical diagnostic tool developed at the laboratoire de physique des océans brest france it is dedicated to the off line computation of the advective component of 3d trajectories and subsequent volume transport analyses in given velocity and tracer fields most often obtained from the numerical integration of an ocean general circulation model the trajectory integration scheme at the core of the ariane calculations blanke and raynaud 1997 dates back to 1992 speich 1992 it takes full advantage of the volume continuity equation expressed on a c grid mesinger and arakawa 1976 there are several advantages to the analytical calculation of streamlines on the model grid for successive time intervals over which the velocity is assumed to be steady state see section 3 2 3 the method only calculates particle positions on the edge of grid cells and it respects the local three dimensional non divergence of the flow doing so makes the method both fast and accurate in terms of truncation error relative to an rk4 code it offers flexibility too in which backward integrations can be performed to track the origin of a given volume a trajectory scheme that respects the continuity equation shows excellent capability for volume tracing following the streamtube perspective discussed in section 2 4 following the methodology proposed by döös 1995 and taken up by blanke and raynaud 1997 to take advantage of such a scheme water volume transfers between selected control sections can be assessed with great accuracy they can be portrayed by means of lagrangian streamfunctions defined either on a geographic plane blanke et al 1999 or on other sets of coordinates that include the model physical tracers blanke et al 2006 a1 2 tracmass the tracmass lagrangian trajectory code was originally developed by döös 1995 and a thorough documentation was given by döös et al 2013 and döös et al 2017 tracmass has been used to calculate trajectories using velocity and tracer fields from a variety of ocean models tracmass has also been used to study the atmospheric hadley and ferrell cells using era interim as input kjellsson and döös 2012a hence tracmass can handle a wide variety of vertical grids and data formats tracmass solves the path of a trajectory through a grid box analytically see section 3 2 3 trajectories are thus unique and if a trajectory is calculated forward and then backward the solution will be the same up to numerical noise due to round off errors there are two algorithms for calculating the trajectories the original from döös 1995 uses velocities and tracers for trajectory calculations that are assumed piecewise constant in time another algorithm was developed by de vries and döös 2001 where time dependence was taken into account by linearly interpolating the velocities in both time and space döös et al 2017 showed that the time interpolating scheme resulted in much more accurate calculations than the piecewise time constant scheme tracmass trajectories have also been used to simulate the behaviour of surface drifters kjellsson and döös 2012b nilsson et al 2013 comparing the simulated drifter trajectories with observed surface drifter trajectories has showed that coarse resolution ocean models lack variability in the surface currents which is very likely due to the omission of stochastic noise to mimic subgrid scale diffusion a1 3 octopus octopus is an offline particle tracking code first written to conduct offline particle simulation using the southern ocean state estimation mazloff et al 2010 which makes use of the mitgcm the code was used to study tracer evolution wang et al 2016 observed during the diapycnal and isopycnal mixing experiment in the southern ocean dimes gille et al 2007 ledwell et al 2011 it was later used in simulating argo floats as a component of observational system planning for the southern ocean carbon and climate observations and modeling project soccom http soccom princeton edu and in studies of watermass pathways in the southern ocean the interpolation scheme is linear in time and trilinear in space the rk4 scheme is used for time integration the boundary condition is reflective at the surface and solid walls the model is currently written in fortran for structured c grids openmp is implemented for shared memory parallel calculation a1 4 lamta software package the lagrangian manifolds and trajectories analyser lamta consists of a set of functions developed for gnu octave and intended for the analysis of two dimensional velocity fields in particular for oceanic current datasets the source code is freely available and distributed under a gpl license upon direct request to the authors d ovidio and nencioli the package provides routines to compute particle trajectories and lagrangian diagnostics based on user defined velocity fields which include analytical test cases numerical model results and altimetry based surface geostrophic currents the trajectories are computed using a runge kutta fourth order advection scheme section 3 2 1 particle advection can be performed either forward or backward in time the scheme applies bi linear interpolation of velocities in space and if necessary linear interpolation in time lagrangian diagnostics include finite time size lyapunov exponents eddy retention origin of water particles age of a water particles from a given bathymetry the package has been applied to investigate the relationship between satellite based lagrangian coherent structures and ocean surface tracers in the open ocean d ovidio et al 2004 2009 lehahn et al 2007 the retention of mesoscale structures smetacek et al 2012 martin et al 2013 the impact of horizontal advection in structuring ecological niches d ovidio et al 2010 up to top predators cotté et al 2011 de monte et al 2012 bon et al 2015 cotté et al 2015 and for contextualizing biodiversity genomic data sunagawa et al 2015 lamta has been recently included in the spasso software package for an adaptive satellite based sampling for ocean campaigns software package 14 14 http www mio univ amu fr doglioli spasso htm developed to guide the in situ sampling strategy as well as the interpretation of collected observations from sub mesoscale oriented field experiments the package has been used to support experiments in the nw mediterranean latex e g nencioli et al 2011 2013 tropical north atlantic strasse reverdin et al 2015 and southern indian ocean keops2 d ovidio et al 2015 and lohafex martin et al 2013 the code has also been integrated in the package used by cnes aviso to produce global maps of lyapunov exponents and vectors from altimetry data a1 5 the connectivity modeling system cms the connectivity modelling system cms paris et al 2013b is an open source fortran toolbox created at the university of miami for the multi scale tracking of biotic and abiotic particles in the ocean the tool is inherently multiscale allowing for the seamless moving of particles between grids at different resolutions the cms has been used on velocity fields from ofes hycom nemo mitgcm uvic ecco2 sose mom and many other ocean models to compute dispersion connectivity and fate in applications including large scale oceanography marine reserve planning and movement of marine biota all across the world the cms uses rk4 timestepping and tricubic interpolation and is designed to be modular and probabilistic meaning that it is relatively easy to add additional behaviours to the particles with attributed randomly assigned for a distribution of traits modules distributed with the code include random walk diffusion mortality vertical migration mixed layer mixing and a seascape module designed to generate a connectivity matrix output from the source to the final destination of the particles a1 6 other biotic particle models while the cms discussed above is also used for physical oceanography applications the code has been developed as a so called individual based model ibm which serve predominantly biophysical applications another widely used example of an ibm is ichtyop lett et al 2008 http www ichthyop org we will not cover ibms in this discussion as a very good recent overview can be found in lynch et al 2014 a1 7 parcels parcels is an experimental prototype code aimed at exploring novel approaches for lagrangian tracking of virtual ocean tracer particles in the petascale age parcels which is currently under development is designed from the ground up to be efficient and fast for the next generation of ocean circulation models these ocean models are so big and massively parallel and they produce so much data that in a few years we may face a situation where many of the lagrangian frameworks cannot be used on the latest data any more see also section 5 1 the user interface of parcels is written in python while the computational intensive integration is just in time jit compiled into c the code is formed around a flexible and customisable api that allows rapid model development based on discrete time stepping algorithms section 3 2 1 it has a high level abstraction that hides complexities from the user field sampling efficient loop scheduling file i o etc this allows computer architecture experts to optimise underlying methods without changing the high level description of the model a2 online tools within ogcms a2 1 light within mpas o the los alamos national laboratory model for prediction across scales ocean mpas o ringler et al 2013 is a fully unstructured c grid ocean model capable of multiscale ocean simulation that is part of the energy exascale earth system model e3sm formerly known as accelerated climate model for energy acme mpas o uses an online diagnostic particle tracking technique called light wolfram et al 2015 for lagrangian in situ global high performance particle tracking which is integrated within the mpas framework and uses different particle advection modes corresponding to different vertical interpolation schemes for example particles can be advected along isopycnally constrained trajectories time advancement uses a generalized runge kutta sub stepping scheme horizontal interpolation with wachspress interpolation gillette et al 2012 occurs following reconstruction of the full velocity vector via an inverse multi quadratic radial basis function approach baudisch et al 2006 particles are implemented in linked lists on each processor to conserve memory for large particle simulations and parallelism is via mpi parallel communication occurs during the computational step between spatially adjacent processors for particles advecting from one processor to another and global parallel communication is reserved for input and output i o tasks processor exchange lists for i o may either be incrementally updated or globally computed to minimize communication overhead in different particle tracking configurations light provides the capability to advect the same number of particles as cells to obtain a complementary lagrangian description of the flow computed by the eulerian prognostic solver in mpas o a version of mpas o that includes light will be available via the public release of the u s department of energy s energy exascale earth system model e3sm a2 2 nemo nemo the nucleus for european modelling of the ocean model madec and nemo team 2016 includes both lagrangian floats madec 2008 and interactive icebergs module icb both rk4 in addition to the online icebergs option nemo icb marsh et al 2015 icebergs can be forced in offline mode for tracking purposes using the stand alone surface forced sas option as sas icb in both nemo icb and sas icb implementation exploits available mpi parallelism a2 3 mitgcm the massachusetts institute of technology general circulation model mitgcm marshall et al 1997b 1997c is a generalized level coordinate ocean model with a wide range of configuration possibilities the mitgcm includes a package for lagrangian particle advection the lagrangian package named flt is however poorly documented and not described in the literature nevertheless this package provides a convenient way to integrate lagrangian analysis into existing mitgcm setups thereby taking advantage of the mpi parallelism of the model numerically floats are advected using rk4 a fixed memory buffer is allocated for floats on each tile implying that memory is wasted for sparse particle ensembles because of mitgcm s offline mode adcroft et al 2014 which enables loading of velocity fields from files mitgcm can be effectively used as a general purpose lagrangian model numerous studies have employed this configuration for simulating lagrangian trajectories from satellite derived geostrophic velocities klocker et al 2012b 2012a klocker and abernathey 2014 and three dimensional model output abernathey et al 2013 a2 4 hycom hycom the hybrid coordinate ocean model is a generalized hybrid vertical coordinate ocean model isopycnal terrain following and or pressure it is isopycnal in the open stratified ocean but reverts smoothly to a terrain following coordinate in shallow coastal regions and to pressure coordinates near the surface in the mixed layer bleck 2002 chassignet et al 2003 2006 hycom includes online code designed to follow numerical particles during model run time halliwell and garraffo 2002 wallcraft et al 2009 in addition to the ability to follow a fluid particle in three dimensions one can also release both isobaric and isopycnic floats isobaric floats remain at prescribed pressure levels while isopycnic floats remain on prescribed density surfaces because of the generalized or hybrid vertical coordinate of hycom one has to be especially attentive when performing vertical and horizontal interpolations advections the horizontal vertical and temporal interpolation schemes used in hycom to advect the floats are adapted from garraffo et al 2001a 2001b horizontal interpolation is performed using a sixteen point grid box surrounding the float when a sufficient number of good grid points are available bilinear interpolation otherwise vertical interpolation first locates the bounding pressure interfaces and all properties are then linearly interpolated to the float location temporal interpolation is performed using rk4 since the vertical velocity is not a prognostic variable in hycom it is diagnosed using the continuity equation see halliwell and garraffo 2002 and wallcraft et al 2009 for details on the implementation a2 5 roms roms regional ocean model system https www myroms org is a free surface hydrostatic primitive equations ocean model with terrain following vertical coordinates that allow differential stretching shchepetkin and mcwilliams 2005 haidvogel et al 2008 it is an open source parallel fortran code coupled to several models including biogeochemestry waves sediments bio optical and sea ice it offers great flexibility for configuration and is widely used by the scientific community for a diverse range of applications roms includes a module called floats which allows the release and tracking of numerical particles during model run time passive floats can be of 3 different types neutral density 3d lagrangian isobaric remain at prescribed pressure level or geopotential remain at prescribed depth the numerical scheme used to time step simulated floats trajectories is a fourth order milne predictor and fourth order hamming corrector it is possible to add a random walk to the floats to simulate subgrid scale vertical diffusion the random walk component is implemented considering spatially variable diffusivity following hunter et al 1993 floats can either reflect or stick when they hit the surface bottom boundaries clusters of floats with user defined distributions can be released at specified locations it is possible to release particles multiple times at defined time intervals throughout the run recently new subroutines have been implemented to allow for biological floats that behave according to user defined parameters the complex biology of oyster larvae including variable growth rates and vertical swimming dependent on food salinity temperature and turbidity has been implemented narvaez et al 2012a 2012b and is available with the latest roms release appendix b tracer trajectories with isopycnal diffusion we here illustrate the stochastic differential equation discussion from section 3 3 1 we consider the calculation of lagrangian tracer trajectories in a 3d benchmark for diffusive tracer transport from shah et al 2011 2013 note that in two dimensions the approach is slightly different see appendix c for this purpose let x and y denote the horizontal coordinates while z denotes the vertical coordinate and assume zero diapycnal diffusion if ρ is the potential density field assume linear equation of state then the isopycnal diffusion tensor redi 1982 reads 36 k k i ρ x 2 ρ y 2 ρ z 2 ρ y 2 ρ z 2 ρ x ρ y ρ x ρ z ρ y ρ x ρ x 2 ρ z 2 ρ y ρ z ρ z ρ x ρ z ρ y ρ x 2 ρ y 2 here ki represents the isopycnal diffusion coefficient and ρ is given by 37 ρ x y z ρ 0 1 n 2 z g α x sin κ x x α y sin κ y y note that the vertical density gradient is assumed to be constant but the horizontal one is not so that the isopycnal surfaces are not flat the concentration satisfies the following initial value problem 38 c t x i k i j c x j t 0 t t c x t c 0 x to solve this problem with the stochastic model given by eq 27 one needs to decompose the diffusion tensor k in the form 2 k i j σ i k σ j k using a cholesky decomposition method the components of the matrix σ can be determined this decomposition leads to the following stochastic differential equations describing the behaviour of the individual particles note that due to the use the of cholesky decomposition the components σxy σxz and σyz of the matrix σ are zero 39 d x t a x d t 2 σ x x d w x t d y t a y d t 2 σ y x d w x t 2 σ y y d w y t d z t a z d t 2 σ z x d w x t 2 σ z y d w y t x t 0 x 0 y t 0 y 0 z t 0 z 0 where the drift coefficients ax ay and az are given by 40 a x k x x x k x y y a y k y x x k y y y and a z k z x x k z y y in fig 8 a results of a simulation are shown for parameter values that are relevant for ocean transport problems shah et al 2011 2013 here the particles have been released at the origin x y z 0 0 0 a point that belongs to the isopycnal surface the position vector x j t y j t z j t j 1 2 j of each particles is simulated by means of a lagrangian scheme because the diapycnal diffusion is zero the particles should not leave the isopycnal surface however numerical errors are unavoidable and their magnitude can be estimated by means of a spurious diapycnal diffusivity the results presented in fig 8b show that the higher order milstein scheme performs better than the euler scheme appendix c diffusion in two dimensional models and associated lagrangian tracer trajectories this review article deals with lagrangian methods for large scale open ocean applications in oceanography this is why the theoretical developments and the flows dealt with are essentially three dimensional there are however difficulties inherent in one or two dimensional transport models which cannot be regarded as an idealisation or simplification of three dimensional models some aspect thereof are outlined below let h u i i 1 2 and c be functions of the time and horizontal coordinates representing the height of the water column the depth averaged horizontal velocity and the depth averaged concentration of a passive tracer respectively then the continuity equation is 41 t h i h u i 0 and the equation obeyed by the concentration reads e g vanderborght et al 2007 42 t h c i h c u i i h k i j j c where the diffusivity tensor kij is symmetric and positive definite the latter partial differential equation may be transformed into a fokker planck equation in which hc rather than c should be viewed as the unknown 43 t h c i h c u i drift i j k i j h c where the drift velocity is heemink 1990 44 u i drift u i h 1 j h k i j u i i k i j k i j h 1 j h the first two terms on the right hand side of eq 44 are equivalent to those used in three dimensional models whilst the last one is specific to depth integrated models if the last term in 44 is not taken into account in a lagrangian model then particles might tend to concentrate into the shallowest areas which clearly is unphysical and may lead to erroneous conclusions e g spagnol et al 2002 a test case was designed by deleersnijder 2015 that includes an analytical solution for diffusion in a depth varying domain and implemented numerically by thomas et al 2015a this exact solution exhibits a somewhat counter intuitive behaviour with the location of the maximum of the concentration and the tracer patch centre of mass moving in opposite directions somewhat similar developments are made when designing a one dimensional cross section averaged transport model such models are often used to simulate transport processes in elongated domains such as rivers or estuaries e g everbecq et al 2001 hofmann et al 2008 in this case all the variables and parameters depend on time and the along flow coordinate x if s u and c denote the cross sectional area the cross section averaged velocity and the cross section averaged concentration respectively then the one dimensional counterparts to eqs 41 44 are 45a t s x s u 0 45b t s c x s c u x s k x c 45c t s c x s c u drift x x k s c where 46 u drift u s 1 x s k u x k k s 1 x s is the drift velocity and k is the along flow diffusivity in depth and section averaged models the diffusion term is rarely meant to represent turbulent diffusion per se instead it is essentially the effect of shear dispersion e g young and jones 1991 that is to be parameterized i e the impact on the resolved reduced dimension processes of the combined effect of sheared advection and turbulent diffusion in the transversal direction as a consequence the diffusivity coefficients are often significantly larger than those that would be used in a three dimensional model of the same domain 
24138,lagrangian analysis is a powerful way to analyse the output of ocean circulation models and other ocean velocity data such as from altimetry in the lagrangian approach large sets of virtual particles are integrated within the three dimensional time evolving velocity fields over several decades a variety of tools and methods for this purpose have emerged here we review the state of the art in the field of lagrangian analysis of ocean velocity data starting from a fundamental kinematic framework and with a focus on large scale open ocean applications beyond the use of explicit velocity fields we consider the influence of unresolved physics and dynamics on particle trajectories we comprehensively list and discuss the tools currently available for tracking virtual particles we then showcase some of the innovative applications of trajectory data and conclude with some open questions and an outlook the overall goal of this review paper is to reconcile some of the different techniques and methods in lagrangian ocean analysis while recognising the rich diversity of codes that have and continue to emerge and the challenges of the coming age of petascale computing keywords ocean circulation lagrangian analysis connectivity particle tracking future modelling 1 introduction the ocean exhibits a huge range of dynamical motions spanning scales from millimetres to thousands of kilometres as seawater moves each fluid particle carries tracers such as salt nutrients heat as well as particulate matter such as plankton and marine debris for various theoretical and practical applications we are interested in how water moves between ocean regions that is we are interested in mapping out pathways of seawater motion since the transport of seawater and its tracer content as well as the pathways and timescales for that transport are key facets in how the ocean plays a role in climate and marine ecology 1 1 estimating pathways there are two general methods for estimating pathways in the ocean one method makes use of tracers such as the multitude of age tracers described by mouchet et al 2016 and references therein tracer studies are well suited for eulerian methods which make direct use of ocean velocity fields on their native grids the second approach makes exclusive use of the lagrangian perspective of fluid dynamics e g bennett 2006 this method employs an ensemble of virtual passive lagrangian particles of zero spatial extent whose trajectories are determined by the velocity field 1 1 lagrangian particles are also sometimes called e floats by for example bower et al 2009 the velocity fields that are used to move the particles often come from ogcms although there are interesting application using observational based velocities such as surface geostrophic velocities based on satellite altimetry e g d ovidio et al 2009 klocker and abernathey 2014 or measured by high frequency hf radar e g ullman et al 2006 trajectories for virtual particles map out pathlines of the velocity field often including the effect of subgrid scale diffusion statistics of the trajectories then define particle pathways and their associated time scales by following the flow of virtual particles and possibly assigning non zero transports and other properties to them in post processing questions about pathways and flow connectivity can be addressed this review focuses on lagrangian analysis methods facilitated by virtual particles in the open ocean we are partly motivated by the growing array of floating instruments in the ocean along with the improving lagrangian simulation capabilities there is a corresponding need to review the methods and foster new ideas for extracting information about the ocean circulation from the entangled trajectories of floats and or simulated particles we thus aim to summarize the state of the science in lagrangian modelling and analysis focussing on the large scale open ocean circulation hoping to support a new generation of scientists contributing to the development and use of the methods our presentation is aimed at graduate students though any large scale oceanographer or mathematician with an interest in virtual particle analysis could use this paper as a starting point in that sense this paper is intended as an accompanying paper to griffies et al 2000 which provided an introduction to primitive equation ocean models and to ådlandsvik et al 2009 which gave an overview of lagrangian modelling practice from a marine biology perspective 1 2 overview of lagrangian ocean analysis observationalists have been tracking the ocean in a lagrangian fashion since the very early ages of oceanography movements of the currents were documented using either ship drift or the drift of purposely built subsurface floats e g swift and riser 1994 many observations remain inherently lagrangian such as the trajectories of surface drifters shown in fig 1 lumpkin and pazos 2007 the subsurface argo floats lebedev et al 2007 ollitrault and rannou 2013 and the tracking of fish larvae paris et al 2013a and turtle hatchlings scott et al 2014 lagrangian analysis through virtual particle tracking within ogcms began in the 1980s on small scale structures with studies on a theoretical box model awaji et al 1980 as well as a model that incorporated hydrographic data and realistic topography imasato et al 1980 the lagrangian framework of these small scale examples was then applied to the velocity field output of basin scale three dimensional numerical experiments examples include regional deep ocean circulation fujio and imasato 1991 western boundary currents imasato and qiu 1987 fronts pavia and cushman roisin 1988 and gyre transport böning and cox 1988 particle trajectories in global ocean circulation models driven by global hydrographic and wind observations were first achieved in the 1990s fujio et al 1992 döös 1995 drijfhout et al 1996 blanke and raynaud 1997 in recent years more than 100 articles per year are published with the words lagrangian ocean modelling as the topic according to the web of science these papers include studies on the pathways of virtual particles that simulate sea water pathways as well as explicit tracking of tracers such as nutrients e g chenillat et al 2015 jönsson et al 2011 and particulates such as larvae e g cowen et al 2006 paris et al 2005 teske et al 2015 cetina heredia et al 2015 phelps et al 2015 plastics e g lebreton et al 2012 microbes e g hellweger et al 2014 planktic foraminifera e g van sebille et al 2015 jellyfish e g dawson et al 2005 icebergs e g marsh et al 2015 surface drifters e g kjellsson and döös 2012b oil droplets e g paris et al 2012 eel e g baltazar soares et al 2014 pumice e g jutzeler et al 2014 and many more the ocean circulation covers an enormous range of scales and regions as said above in this review we focus primarily on applications on the basin and global scales however it should be noted that there is also extensive lagrangian analysis work done on smaller scales such as in coastal zones and recently in the gulf of mexico through interest in dispersion of the deepwater horizon oil spill e g beron vera and lacasce 2016 haza et al 2016 the lagrangian framework is not only used to analyse velocity fields by computing their integral curves but also to directly solve for the trajectory by casting the equations of motion in a lagrangian framework bennett 2006 lagrangian methods are widely used in engineering including discrete element methods e g kruggel emden et al 2008 and smoothed particle hydrodynamics e g cummins et al 2012 while advances in this field have been made in large scale oceanography both for sub components of ocean models e g bates et al 2012 and for fully lagrangian ocean models haertel and randall 2002 haertel and fedorov 2012 this topic is not the focus of this review instead we focus on lagrangian diagnostic methods to identify oceanic pathways the lagrangian framework for analysing pathways is complementary to the analysis of tracers one of the key differences is the computational cost for each time step movement of a lagrangian particle takes only one set of computations in contrast the advection diffusion of a tracer concentration takes n sets of computation where n is the number of discrete ocean grid cells while one lagrangian particle trajectory does not allow for meaningful analysis of ocean pathways this comparison does show that the computational scaling of the two methods is very different furthermore the experimental design is different for tracer and particle experiments exclusive to particle experiments is that the entire trajectory history of the virtual particles can in principle be stored this history allows for a posteriori analysis of connectivity between different regions of the ocean e g sections 4 5 and 4 6 and conditional statistics e g koszalka et al 2013b van sebille et al 2013 2014 von appen et al 2014 gary et al 2014 durgadoo et al 2017 where subsets of particles can be analysed that obey certain conditions based on their properties for example in van sebille et al 2013 particles in the southern ocean were analysed for how often they looped around antarctica in their journey from the antarctic slope to the deep subtropical basins such an analysis would be hard to do with tracer fields although the latter has its own advantages including a more natural alignment with the treatment of advection and diffusion within models finally another great advantage of lagrangian particle experiments is that particles can be advected at least in offline mode when velocity fields are stored backwards in time this reverse time analysis allows one to investigate where water masses found within a model at a certain location come from 1 3 structure of this paper this paper is structured as follows in section 2 we introduce a kinematic framework used for thinking about lagrangian particles in section 3 we detail how to compute and interpret lagrangian particles including an overview of the available lagrangian diagnostic tools in section 4 we highlight applications of how virtual particle trajectories can be analysed to reveal quantitative and qualitative information about the flow in section 5 we conclude the main part of the paper with future outlooks a selection of appendices then provide examples and detailed discussion of topics introduced earlier in the paper as well as brief descriptions of the different numerical codes introduced in section 3 2 kinematic framework we here introduce a kinematic framework to describe fluid motions the ideas are fundamental to how we make use of both eulerian and lagrangian methods for analysing ocean circulation we make connections to lagrangian analysis methods though reserve algorithmic details for later sections 2 1 lagrangian and eulerian reference frames a lagrangian kinematic approach is based on a description of the fluid in a reference frame that is moving with an infinitesimal fluid particle equivalently a fluid parcel fluid motion is thus the accumulation of continuum particle motion the fluid particle framework that forms the basis for lagrangian kinematics offers a powerful conceptual picture of fluid motion e g salmon 1998 bennett 2006 with this picture taken as the basis for lagrangian methods of analysis eulerian kinematics is a complement to lagrangian kinematics the eulerian approach is based on describing fluid motion in a reference frame that is fixed in space eulerian kinematics is the basis for most numerical ocean circulation models in which the horizontal position of grid cells is held fixed in time 2 2 the top and bottom faces of grid cells are generally moving since the general vertical coordinates defining these surfaces need not be static for example these cell faces may be defined according to constant pressure constant potential density or constant rescaled ocean depth quite generally the technical aim of lagrangian ocean analysis is to estimate the trajectory of virtual fluid particles by making use of eulerian fluid information i e the velocity field 2 2 trajectories or material pathlines the motion of a classical point particle is described by knowledge of its position vector x t which provides the position of the particle at time t as the particle moves it traces out a curve in space referred to as a trajectory when describing n discrete particles we add a discrete label to each of the particle positions x n t for continuum matter such as seawater the discrete label n becomes a continuous vector x a t with a x t t 0 a common though not necessary choice in general the label vector a is referred to as the material coordinate e g salmon 1998 since this coordinate distinguishes between infinitesimal particles comprising the continuum a fluid particle is conceived of as a microscopically large collection of many molecules whose velocity is formally determined as a mass weighted mean of the velocity of the individual molecules i e barycentric velocity as defined in section ii 2 of degroot and mazur 1984 and section 1 9 of salmon 1998 alternatively by making the continuum hypothesis we dispense with molecular degrees of freedom so that a particle is considered a macroscopically small material fluid volume treated as a mathematical continuum and labelled by the material coordinate a for an incompressible fluid the fluid particle has constant volume however its constituents do not remain fixed as they are generally exchanged with adjacent particles through mixing thus changing the particle s tracer content e g water salt nutrients as well as altering its heat all the while maintaining a constant volume the velocity of a fluid particle is the time derivative of the trajectory computed with the material coordinate held fixed the mathematical connection between lagrangian and eulerian descriptions is enabled by equating the particle velocity crossing a point in space x a t x to the fluid velocity field at that point 1 x a t t a v x t where x a t x the relation 1 provides a starting point for lagrangian fluid analysis note that the resulting fluid particle trajectories are sometimes called material pathlines in the fluid mechanics literature e g aris 1962 batchelor 1967 2 3 the material time derivative without trajectories a kinematic description requires time changes of an arbitrary function ψ evaluated along trajectories ψ x a t t use of the chain rule leads to 2 ψ x a t t t t x v x a t t ψ x a t t note that when trajectories are dispensed with as in the eulerian description we recover the more succinct expression for the material time derivative 3 d ψ x t d t t v x t ψ x t where all expressions on the right hand side are taken with respect to the fixed eulerian reference frame 3 3 an alternative derivation of eq 3 which is arguably more straightforward mathematically dispenses with trajectories from the start in which case we express the total differential of a function as d ψ x t d t t ψ d x ψ specifying the spatial increment to correspond to movement of a fluid particle d x v x t d t leads to eq 3 we prefer the derivation using particle trajectories as it exposes the relation between lagrangian and eulerian reference frames the symbol d is commonly used to distinguish the material time derivative from a more general time derivative that is not necessarily following a material fluid particle to illustrate this formalism consider ψ x t x in this case the material time derivative is given by the velocity field at that point 4 d x d t v x t 2 4 steady state volume transport pathways defined by streamtubes within lagrangian ocean analysis there is a long history of interpreting particle trajectories as streamtubes and using this interpretation to compute volume transports döös 1995 blanke and raynaud 1997 see also section 3 2 3 formally the equivalence between streamtubes and material pathways is only valid for steady state flows i e where the flow is constant in time originally the streamtube calculations were indeed performed on time mean steady state velocity fields but they were soon extended to time varying flows for example by assuming piecewise steady flow blanke and raynaud 1997 cf section 3 2 3 over the last two decades however the approach has been widely used in studies of large scale ocean transports see e g section 4 5 justifying a discussion of the mathematical underpinning of streamtubes for steady state flows here in this review manuscript the ocean is a nearly incompressible fluid thus for this review we consider an incompressible boussinesq fluid which means that the velocity field is non divergent 5 v 0 consequently the volume of a material fluid particle remains constant i e it is incompressible a streamtube is a bundle of streamlines so that streamtube sides are parallel to the velocity see e g fig 3 6 in kundu et al 2012 4 4 one may think of streamtubes as the communication cable lines within an incompressible fluid transmitting volume signals within a steady flow for a steady flow streamlines are equivalent to material pathlines in which case streamtubes are material tubes it is for the steady case that we can make use of streamtubes to map out volume transport pathways in an incompressible fluid we see this property by integrating the non divergence constraint eq 5 over the streamtube and making use of gauss s law doing so reveals that volume transport volume per time through the two streamtube ends balances exactly 6 a 1 v n d a a 2 v n d a 0 where n is the outward normal at the respective end and da the corresponding area by construction v n 0 on the streamtube sides so the sides do not contribute to the balance in eq 6 hence the volume transport entering one streamtube end equals to that leaving the other end furthermore the area of the streamtube is inversely proportional to the local normal velocity the transport constraint 6 holds regardless of whether there is diffusive tracer mixing in the boussinesq fluid it follows from the non divergence property of the velocity field in an incompressible fluid however in the presence of diffusive tracer mixing the actual material entering one end of the streamtube is not necessarily the same as the material exiting the other end see also section 2 5 the above properties make streamtubes useful for understanding the circulation in a steady incompressible fluid in particular they provide the mathematical basis for lagrangian analysis methods that tag particles with volume transport e g eckart 1948 welander 1955 the aggregated integral curves for such particles define a probability density function pdf for volume transport pathways in the continuum and under the assumption of a steady flow field volume transport pathways deduced from streamtubes are identical to pathways deduced from particle trajectories determined by time stepping eq 1 we can make use of the volume transport information carried by streamtubes for lagrangian analysis to do so define the starting point for a streamtube by assigning a volume transport to each particle the assigned volume transport is directly proportional to the transport crossing the grid cell face where the particle is initialized in principle we can fill a non divergent flow field without void between streamtubes consequently we can compute streamtube derived volume transport pathways whether the flow is laminar or turbulent however turbulent flow generally requires more streamtubes to develop robust statistics for the transport pathways and also requires that the flow is assumed piecewise steady see also section 3 2 3 as for any transient flow steady state streamlines lose their equivalence to pathlines 2 5 an introduction to tracer transport pathways a finite size material seawater parcel is comprised of fresh water and tracers of other matter such as salts and biogeochemical components 5 5 conservative temperature can also be considered as the concentration of heat in a parcel the reason is that to a very good approximation conservative temperature satisfies a source free tracer equation analogous to salinity mcdougall 2003 graham and mcdougall 2013 tracer concentration c measures the mass of tracer per parcel mass the velocity considered in fluid mechanics is the barycentric velocity section 2 2 so that the mass or volume for a boussinesq fluid of a material fluid parcel is constant however the mass of each trace constituent is not materially constant since tracers are exchanged between parcels through mixing in the presence of concentration gradients since the small scale motions that govern this mixing are hardly ever resolved in ogcms the effect of tracer mixing has to be represented as resolution dependent diffusive transports based on mean distributions in section 2 4 we defined volume transport pathways according to streamtubes in a steady flow here we introduce transport pathways defined by trace constituents in the presence of diffusive tracer mixing tracer and volume transport pathways are distinct the machinery of stochastic differential equations sdes is required to compute tracer transport pathways with details deferred to section 3 3 our purpose here is to anticipate that discussion by introducing various forms of the tracer concentration equation in so doing we also introduce the residual mean velocity 2 5 1 the tracer equation with subgrid scale transport molecular diffusion as well as turbulent subgrid scale transport processes give rise to irreversible diffusive transport as well as reversible advective or skew diffusive transport mathematically we express the subgrid scale tracer transport through a transport tensor j the corresponding tracer concentration equation takes the form 6 6 we assume a boussinesq fluid when writing the tracer eq 7 7 t v c j c where the transport tensor j has units of squared length per time it is convenient to split the transport tensor into the sum of a symmetric and anti symmetric tensor 8 j k a the symmetric tensor k has components satisfying 7 7 we make use of cartesian tensors throughout this review with results generalizable to arbitrary coordinates 9 k i j k j i this tensor corresponds to diffusion so long as it is positive definite the anti symmetric tensor a corresponds to skew diffusion or equivalently to advection e g middleton and loder 1989 griffies 1998 given the decomposition of the transport tensor 8 we find it useful to write the tracer equation in the form 10 t v c k c where 11 v v v defines the residual mean velocity and 12 v j i a i j is known as the eddy induced velocity 8 8 repeated indices are summed over their range notably the eddy induced velocity is non divergent due to the anti symmetry property 13 a i j a j i v 0 consequently the tracer eq 10 can be written in the flux form 14 c t v c k c since both v and v are divergence free one can define a streamtube in a steady state flow according to either velocity field the streamtubes defined by the residual mean velocity are often more relevant than those for the eulerian time mean velocity for ocean transport since the residual mean velocity v incorporates information about subgrid scale eddy advective transport drijfhout et al 2003 for example explicitly calculated particle trajectories with both eulerian mean and residual mean velocities and discussed the differences in overturning pathways particle trajectories using the eulerian mean exhibit motions that cross mean isopycnal surfaces whereas trajectories making use of the residual mean better respect the adiabatic nature of the meridional overturning flow 2 5 2 introducing the fokker planck equation anticipating the discussion of stochastic differential equations sdes in section 3 3 1 we manipulate the diffusive contribution in the tracer eq 14 the aim is to write the tracer concentration equation in the form of a fokker planck equation see eq 24 which describes the time evolution of the probability density function of the tracer for this purpose we use the identity 15 i k i j j c i j k i j c c j k i j so that 16 c t v drift c i j k i j c where we introduced the drift velocity 17 v drift v k the drift velocity generally has a non zero divergence 18 v drift i j k i j since ij kij does not generally vanish 9 9 one notable case where v drift 0 is isotropic diffusion with a constant diffusivity e g molecular diffusion molecular diffusion is generally not relevant for large scale ocean models as models and large scale observations do not resolve down to the kolmogorov scales hence large scale models make use of the far larger and flow dependent eddy diffusivities eq 16 is the tracer equation written in the form of a fokker planck equation tracer transport pathways differ from volume transport pathways in the following ways first as already mentioned the drift velocity v drift is generally divergent hence it is not useful to define steady state tracer streamtubes in terms of v drift second even if k 0 so that the drift velocity is divergent free e g isotropic diffusion with a constant diffusivity tracer pathways are affected by diffusive mixing between fluid particles to represent such diffusion in a lagrangian trajectory calculation requires a stochastic noise term weighted by the diffusion tensor section 3 3 therefore whether one considers volume transport pathways or tracer transport pathways depends on the scientific question and the information available to address that question 2 5 3 using particles to track a tracer patch there is yet another way to consider tracer transport pathways using lagrangian analysis for this approach we represent a patch of tracer as a collection of lagrangian particles e g bennett 2006 lacasce 2008 in this way lagrangian analysis can be used to study tracer dispersion rossi et al 2013 wang et al 2016 in principle in the limit of infinite number of particles and knowledge of the velocity field to arbitrarily fine spatial and temporal resolution the tracer dispersion from lagrangian particles would have theoretically perfect resolution and controllable numerical diffusion how achievable this is in real world simulations remains an area of active research a tracer patch can be represented by a cloud of particles each particle carries a portion of the total tracer content let c denote the tracer volume per particle the corresponding eulerian tracer concentration c x t can be written 19 c x t i 0 n w x x i t c i where n is the total number of particles x i is the particle position and w is a mapping kernel function dimensions inverse volume that maps the particle density to tracer density the kernel function satisfies the normalization condition required to conserve volume 20 ω w d x d y d z 1 where ω is the integral volume in three dimensions the form of w has been extensively investigated in the smoothed particle hydrodynamic approach monaghan 1992 different forms of w exist with different projection errors 3 computing lagrangian particle trajectories in this section we discuss technical aspects of lagrangian modelling and analysis focusing here on the computation of trajectories we consider how trajectories of virtual lagrangian particles can be used in mapping both volume transport pathways and tracer transport pathways recall the distinction discussed in section 2 5 3 1 basic needs for lagrangian trajectory calculations for volume transport pathways one needs a non divergent velocity field a three dimensional non divergent velocity can be produced by sampling a boussinesq ocean model thus offering a means to compute three dimensional trajectories to compute tracer transport trajectories we need both a velocity field and a diffusion tensor the diffusion tensor is a function of the often poorly known subgrid scale flow and it is generally a complex function of the flow field consequently the calculation of tracer transport pathways is somewhat less mature than volume transport pathways though see tables 1 and 2 when using an ocean model we distinguish between two techniques of lagrangian integration the first occurs online whereby trajectories are computed each time step that the eulerian model is updated examples of such online methods are available for volume transport pathways using the velocity field see section 3 5 in contrast we know of no example of online tracer trajectory calculations making use of both the instantaneous velocity field and the diffusion tensor the second method for lagrangian analysis occurs through off line trajectory calculations off line methods make use of stored velocity fields sampled from the eulerian model off line trajectory calculations offer the ability to compute trajectories in a forward mode from their starting point forward in time or in a backward mode from their ending point backward in time as an alternative to velocities generated by ogcms we may use observation based data from floats or drifters which generally give a two dimensional surface velocity e g koszalka et al 2011 we may also diagnose a surface geostrophic velocity by differentiating gridded satellite observations of the sea surface height e g klocker et al 2012b notably both surface drifter float velocities and surface geostrophic velocities generally have a non zero horizontal divergence surface geostrophic velocities are non divergent only on an f plane and the corresponding surface trajectories do therefore not map volume transport pathways nonetheless the resulting surface trajectories do map preferred pathways of the surface flow thus providing useful diagnostic information computation of particle trajectories using a velocity field requires essentially two operations a way to integrate the trajectory eq 1 and a way to interpolate a gridded velocity field to an arbitrary point in space and time in this section we detail these aspects 3 2 temporal integration of the virtual particle trajectory equation when the nth virtual seawater particle is located at the point x n t x we can update its position by time stepping the velocity eq 1 21 x t δ t x t t t δ t v x τ τ d τ where we dropped the trajectory super script n to simplify notation note that the integrand involves the eulerian velocity field v x τ which equals to the lagrangian velocity d x t dt when evaluated at x t x in some applications of lagrangian analysis there is an additional term on the right hand side of eq 21 that represents unresolved physics see section 3 3 2 we explore various flavours of this discrete time stepping see also fig 2 for estimating virtual particle trajectories focussing on the most commonly used schemes however there are many more schemes than discussed here e g chu and fan 2014 liu and chua 2016 in general the accuracy of trajectories computed in ogcm fields depends on accuracy of the time stepping scheme as well as accuracy of the interpolation scheme used to estimate velocity at the time and position of the particle see section 3 4 note that the first three methods explicit implicit and analytical discussed below all result in identical trajectories in the continuum however the trajectories differ in numerical implementations due to algorithmic differences and truncation errors for all methods statistical significance of the diagnosed pathways is enhanced by increasing the number of deployed particles as a rule of thumb one has deployed a sufficient numbers of particles when the physical results of interest do not significantly change as the number of particles is increased e g jones et al 2016 the maximum integration time in eq 21 is limited to the run time of a given model simulation a number of oceanic processes however have time scales that exceed these run times e g england 1995 stouffer 2004 danabasoglu 2004 using lagrangian particles to temporally resolve for example the meridional overturning circulation blanke et al 1999 thomas et al 2015b or inter basin connectivity blanke and speich 2002 can be difficult with many state of the art climate models to address this problem a commonly employed ad hoc method is to loop the model data in time such that the velocity and tracer fields are returned to the first time step once the end has been reached e g döös et al 2008 van sebille et al 2012 thomas et al 2015b this approach thus permits particles to be advected for longer time scales than available from the raw data however particle looping can only work if the model has no drift in the velocity or tracer fields that there are no large unphysical jumps in the fields between the end and the beginning of the model run and that any unphysical jumps will have a small net effect on the particle pathways 3 2 1 explicit time stepping methods one way to integrate eq 21 is to multiply the velocity at a point by a time step δt to estimate the displacement this approach is known as the euler method and is correct to first order in δt better accuracy of the trajectories can be obtained by using higher order methods for the integration of eq 21 one popular method is the 4 th order runge kutta scheme e g butcher 2016 where information of the interpolated velocity field at four increments between time steps tn and t n 1 is used the fourth order runge kutta method is a member of a family of integrators dormand and prince 1980 one interesting extension is adaptive timestepping through a rk45 method where both a fourth order and a fifth order integration are performed the extra computational cost of a fifth order computation is marginal when a fourth order is already performed the difference δ x x 5 x 4 between the fifth order and fourth order solution can be computed if δx is larger than some pre chosen threshold the time step δt of eq 21 can adaptively be reduced for that particle doing so then leads to a straightforward implementation of adaptive timestepping using runge kutta integrators however it is not a priori clear how the error thresholds for δx should be chosen when working with stored velocity data as when virtual particle trajectories are computed offline temporal interpolation is usually required interpolation is needed because the interval between consecutive stored velocity fields is generally longer than the time step δt used to advance the particle trajectories in eq 21 this temporal interpolation of the velocity fields can be a large source of error particularly when the interval with which velocity fields are stored becomes longer than a few days e g valdivieso da costa and blanke 2004 qin et al 2014 3 2 2 time implicit discrete integration schemes to determine volume transport pathways the volume preservation properties of numerical integrators becomes an important consideration symplectic time integration schemes are one method used to maintain volume conservation for discrete methods they can be mathematically shown to exactly conserve area in divergence free 2d fields meaning that the area bounded by a set of particles will stay constant over time in the absence of turbulent diffusion 10 10 see hairer et al 2006 for a comprehensive description of symplectic time integration schemes and leimkuhler and reich 2004 for an introduction with applications targeted at scientists and engineers symplectic methods for lagrangian particles in two dimensions take the same form as symplectic integrators for systems of point vortices but now the velocity is prescribed marsden et al 1999 the disadvantage of these methods is that they are generally implicit in time hence they require iterative methods for example the implicit midpoint rule provides a symplectic integrator for the lagrangian trajectory equation in two dimensions mclachlan 1999 leimkuhler and reich 2004 in three dimensions the concept of symplectic integrators must be extended to lie poisson integrators for 3d incompressible velocity fields mclachlan 1999 leimkuhler and reich 2004 few 3d symplectic integrators are known though the implicit midpoint rule is known to be such an integrator and preserves volume in three dimensions 3 2 3 an analytical discrete streamtube method another volume preserving method to integrate the trajectory eq 21 takes advantage of the discrete continuity equation the resulting virtual particle trajectories respect the volume conservation property of an incompressible boussinesq fluid and thereby are particularly suited for experiments where the focus is on the advective component of the flow in brief this method analytically computes trajectories across grid cells by making use of the gridded velocity field located on grid cell faces this approach approximates streamtubes through the use of volume conservation constraints introduced in section 2 4 while these methods have their origin in applications with steady state velocity fields and the streamtube approach is formally only applicable to these cases there is a large community using extended analytical discrete streamtube methods for time varying flows too these applications typically achieve very similar results to the explicit time stepping schemes algorithms following this approach calculate trajectories for a given steady state velocity field through analytic computation of three dimensional streamtubes blanke and raynaud 1997 if the velocity fields are time evolving it is possible to sub sample them into piecewise steady fields which are only kept constant in time for a short time this approach generally increases the computational cost another method by de vries and döös 2001 allows for analytical trajectories in a time dependent case that accounts for flow changes across time steps döös et al 2017 showed that the time dependent trajectory solution is more accurate than the piecewise steady solution especially in eddying regions and only at a very small additional computational cost see also a 1 2 the analytical calculations are on the scale of a model grid cell for which components of the velocity field or the volume transports are typically expressed on a staggered c grid mesinger and arakawa 1976 i e are known over the six faces of the cell see fig 2 11 11 this method can also be used for a grid or b grid stencils so long as these grids offer conservative volume transport components on tracer cell faces the use of conservative flux based transport schemes is a basic property of any finite volume ocean model regardless the horizontal grid stencil the analytical method is enabled by assuming that within a grid cell the fluid velocity exhibits a linear variation of each velocity component along each corresponding direction so that 22 v subgrid u x v y w z these subgrid scale velocity components u x v y w z are linear functions of their arguments with the precise form of these functions determined by the known velocity components on the cell faces this form of the subgrid scale velocity then allows one to write analytical trajectory equations along the three axes across the grid cell analytic time integration of these equations binds each coordinate point x y z in a grid cell to time in the cell grid cell crossing times in each of the three directions are evaluated independently by imposing any of the six grid cell sides as a possible final position the minimum crossing time specifies the actual crossing time and hence the trajectory this approach then allows for an accurate within the confines of the basic assumption of eq 22 calculation of the final position of a particle on the relevant exit side of the grid cell this method for computing volume transport trajectories is both fast and self consistent it is fast because it only calculates particle positions on the edge of individual grid cells it is self consistent since it respects the local three dimensional non divergence of the boussinesq flow both at the subgrid and the large scale it therefore provides a judicious method to map volume transport pathways by realizing a discrete implementation of streamtubes introduced in section 2 4 streamtube based volume transport is reversible so that backward integrations can be performed to track the origin of a given volume it is for these reasons that practitioners of discrete streamtube methods generally do not introduce diffusion or stochastic noise when computing particle trajectories rather the method is focused on determining volume transport pathways defined from the resolved or the residual mean flow 3 3 computing stochastic trajectories to simulate diffusion and unresolved physics as noted above streamtubes track water volume in a steady state flow however in many applications in oceanography one is interested in tracking tracers such as heat salt or nutrients and how they are affected by subgrid scale diffusion and unresolved physics such as mixed layer processes and deep convection e g van sebille et al 2013 tracer concentrations can directly be computed from the spreading of a cloud of particles described by stochastic differential equations sdes see section 2 5 2 where unresolved physics are represented by stochastic noise two main approaches can be distinguished in efforts to add diffusion to trajectories one is to start with the tracer eq 16 where the eddy transport is parameterized in terms of the eddy induced velocity and the appropriate form of the diffusivity tensor in order to derive the sde for particle trajectories section 3 3 1 the second approach section 3 3 2 is to use an ad hoc sde where a markov model is fit to observations from surface drifter trajectories or virtual particles in a much finer resolution velocity field it remains an active area of research under which circumstances e g underlying research question spatial and temporal model data resolutions and how exactly stochastic noise representing subgrid scale diffusion should be implemented see also section 3 3 3 3 3 1 stochastic trajectories using the fokker planck equation here we provide a brief introduction to the implementation of stochastic terms through the use of a fokker planck equation the discussion here makes use of the more thorough discussions provided in the textbooks by gardiner 1985 jazwinski 1970 and kloeden and platen 1992 as well as the oceanographic review by visser 2008 advantages of this lagrangian sde approach over eulerian tracer computations are that it can deal with steep concentration gradients and that tracer concentration can never become negative a stochastic differential equation sde for a general trajectory x t is given by 23 d x i t a i t x d t σ i k t x d w k t x t 0 x 0 in this equation xi t are components of the tracer trajectory vector x t and d x i t x i t d t x i t is the stochastic particle displacement during the time interval t t d t the term ai t x is a deterministic drift whereas σik t x is related to a tracer diffusion tensor see eqs 25 and 26 below finally wk t is a wiener process or brownian motion modelling stochastic fluctuations that represent unresolved motions like eddies waves or small scale turbulence the increment d w k t w k t d t w k t is a gaussian variable with zero mean and variance dt with non overlapping increments independent of each other the stochastic model 23 is markovian which means that information on the probability density of the trajectory x t at time t is sufficient to make predictions at later times non markovian models require information at earlier times which is generally impractical the presence of the wiener process means that integrating the equation using deterministic calculus does not produce a unique solution we make use of ideas proposed by itô who developed a stochastic calculus to produce a unique solution of the sde 23 12 12 the itô calculus used here is but one mathematical approach for realizing a unique solution to a sde e g gardiner 1985 stratonovich and itô backward approaches offer alternative stochastic integration methods and they can also be used to derive stochastic particle models gräwe et al 2012 shah et al 2011 spivakovskaya et al 2007a 2007b we focus on the itô calculus as it is well known to physicists as is the corresponding fokker planck equation furthermore the drift ai t x of an itô sde represents the mean of the stochastic particle tracks finally the well known euler scheme see eq 28 below is a straightforward numerical approximation of the itô sde whereas this scheme cannot be used to discretize a stratonovich or an itô backward sde a cloud of particles will estimate the probability density p t x for the stochastic tracer trajectories use of an itô stochastic process x t ensures that the probability density function evolves according to the following itô form of the fokker planck or forward kolmogorov equation 24 p t i a i p i j b i j p p t 0 x p 0 x with 25 2 b i j σ i k σ j k we can relate the fokker planck eq 24 to the boussinesq form of the tracer eq 16 so that 13 13 the tensor elements σik t x are not uniquely determined by the diffusion tensor k however all choices consistent with the relation 2 k i j σ i k σ j k result in statistically identical diffusion processes 26 b i j k i j a i v i j k i j p c the corresponding sde for the trajectory is given by 27 d x i t v i k i j x j d t σ i k t x d w k t x t 0 x 0 it is through this connection that we can derive a stochastic lagrangian model for any advection diffusion tracer equation stochastic tracer trajectories can be generated numerically through discrete approximations to the itô stochastic differential equation kloeden and platen 1992 discretizing the continuous stochastic differential eq 27 using the euler scheme leads to 28 x i t δ t x i t v i j k i j δ t σ i k t x δ w k t x t 0 x 0 in this equation δwk t is a gaussian random variable with zero mean and variance δt generated via a random generator the accuracy of the euler scheme is o δ t 1 2 in the strong sense i e for approximating the individual particle trajectories when used to generate many trajectories in order to approximate the probability distribution or equivalently the tracer concentration then the euler scheme is o δ t accurate i e the euler scheme is o δ t in the weak sense more accurate numerical schemes have been developed such as in gräwe et al 2012 shah et al 2011 shah et al 2013 and spivakovskaya et al 2005 2007a 2007b there are methods to compute trajectories directly from a sde for many applications e g kloeden and platen 1992 trajectory computation directly from sdes is less mature in large scale oceanography where it is often difficult to include a realistic diffusion tensor for subgrid scale tracer transport appendix b offers an example of tracer trajectories in the presence of an isopycnal diffusion tensor with a time constant diffusivity this application is nontrivial and a major advance in the lagrangian tracer trajectory method unfortunately it is not fully representative of modern parametrisations for global models whereby the diffusivity is a function of space and time abernathey et al 2013 and the diffusivity tensor may be anisotropic in the lateral directions as well as between lateral and vertical fox kemper et al 2013 even with a constant isopycnal diffusivity sampling components of the 3 3 diffusion tensor for offline analysis is a nontrivial computational task particularly in the presence of realistic temporal variability additional difficulty arises from time variations in the diapycnal diffusivity used for planetary boundary layer schemes consequently the current generation of explicit sdes for tracer trajectories are generally restricted to relatively coarse resolution models with rudimentary subgrid scale parametrisations e g shah et al 2017 although efforts are underway to improve this 3 3 2 a hierarchy of markov models for stochastic trajectories the second approach to adding the effects of diffusion and unresolved physics to particles is to ad hoc find an sde that matches the statistics e g eddy decorrelation time scales and diffusivity of the stochastic trajectories with either observations or particles simulated in finer resolution models this approach has been developed by griffa 1996 and further by berloff and mcwilliams 2003 in the context of ocean models see also vallis 2006 section 10 2 and lacasce 2008 for discussion and veneziani et al 2004 and koszalka et al 2013a for implementations a hierarchy of markov models is considered whereby the stochastic term is added to either particle displacement zeroth order markov model corresponding to uncorrelated eddy velocity field the particle velocity first order model accounting for correlations of the velocity or the particle accelerations in most cases the first order model is found to best approximate the oceanic mesoscale turbulence introduced by coherent eddies in the first order markov model multiplicative noise stochastic noise is used to modify the present position of a particle when updating to a new position in which case the trajectory eq 21 can be written as 29 x t δ t x t 1 ϵ t t δ t v x τ d τ where ϵ is a random number notably the application of noise in this manner does not ensure that x t δ t results from time stepping a divergence free velocity for that purpose we consider an alternative approach whereby we introduce a stochastic divergence free velocity 30 x t δ t x t t t δ t v x τ v noise x τ d τ we can ensure v noise 0 by introducing a stochastic vector streamfunction so that for each grid cell we have 31 v noise x ψ noise x since the stochastic velocity remains non divergent this approach offers a realisation of stochastic streamtubes in steady state flows the choice of either eq 29 or 30 depends on the application and will be further discussed in section 3 3 3 in the zeroth order markov model additive or random walk noise the stochastic noise is added to the particle positions which is often applied in a rather simple form by adding an extra term to the trajectory eq 21 32 x t δ t x t t t δ t v x τ d τ r 2 k δ t in this equation r n 0 1 is a random number taken from the normal distribution with zero mean and unit variance and k is a constant tracer diffusivity a major limitation of this model is that if the drift term is omitted eq 32 will lead to artificial accumulation of particles in regions of low diffusivity requiring an enhancement of the random walk model hunter et al 1993 visser 1997 ross and sharples 2004 berloff and mcwilliams 2002 a myriad of behaviours can be added to a random walk model for capturing the biological characteristic of lagrangian particles examples include diurnal vertical migration temperature dependent planktonic larval duration and time to settling competency while it must be noted that enhanced complexity does not necessarily imply enhanced accuracy studies have shown that even modest vertical migration velocities can significantly alter the dispersal patterns of propagules for example a recirculation in the western irish sea of northwest europe associated with summer stratification retains surface drifters but does not retain vertically migrating organisms phelps et al 2015 3 3 3 when and how to add stochastic terms in the above we have described a few methods to incorporate mixing through stochastic terms however exactly when and how to implement these terms is an open question it will likely depend on the temporal and spatial resolution of the velocity fields as well as the unresolved processes that the added stochastic components are intended to reproduce in particular the consideration should be whether mesoscale coherent eddies and attendant nonlocal transport properties velocity correlations and steep eulerian velocity spectra are resolved by the ocean model velocity field underlying the lagrangian simulations if a velocity field is available at sufficiently high spatial and temporal resolution adding a stochastic component may be unnecessary and high numbers of particles may suffice koszalka et al 2013b if the available velocity field does not resolve important eddy processes a first order or second order markov model may need to be used to account for a velocity correlations induced by the mesoscale eddy field griffa 1996 berloff and mcwilliams 2002 lacasce 2008 the applicability of the stochastic simulations should in any case be verified against existing observations koszalka et al 2013a or high resolution model simulations if available it is also still open how the fokker plank equation approach section 3 3 1 and the ad hoc markov model approach section 3 3 2 can be combined while the first approach is more mathematically rigorous the second provides an insight into the properties of observed or simulated oceanic turbulence on different scales and in different regions and may be useful in building future parameterizations of eddy induced transport in terms of lagrangian stochastic parameterizations we leave this discussion of diffusivity here as the research and understanding of this issue is rapidly evolving and strongly encourage the community to gain a better understanding in how best to implement diffusion and unresolved physics for lagrangian particles 3 4 spatial interpolation the trajectory eq 21 is defined on continuous velocity fields however all ocean models work with discretized grids where velocities are only known on either vertices or edges of the grid cells griffies et al 2000 therefore computing lagrangian trajectories from ocean model data requires reconstruction of the continuous velocity field inside grid cells bilinear trilinear or spline interpolation are viable choices on structured grids interpolation on unstructured grids can be accomplished via methods derived from particle based approaches e g inverse distance weighting or kernel based convolutions or unstructured extension of grid based spatial interpolation e g wachspress interpolation gillette et al 2012 on grids where velocities are defined on the corners of grids e g arakawa a and b the reconstruction choices include weak form reconstruction perot 2000 radial basis functions baudisch et al 2006 or reconstruction via finite element basis functions wang et al 2011 on grids where velocities are known on the edges of grid cells e g arakawa c this reconstruction is often done using simple linear interpolation although more work needs to be done investigating what the errors are that arise from this horizontal interpolation on arbitrary simplexes from vertex data is provided by wachspress interpolation gillette et al 2012 which is a super linear interpolation scheme for arbitrary simplexes for triangles wachspress interpolation is equivalent to barycentric interpolation which is commonly used on triangular meshes and readily available in scientific packages e g python matplotlib a primary benefit of this approach is that it provides a continuous interpolant e g c 0 continuous options for higher order interpolation to obtain c n for n 1 continuity are more complex and less common particularly on arbitrary unstructured meshes horizontal interpolation via wachspress naturally keeps particles within the domain for no slip conditions where the velocity is zero for boundary points on simplexes particles can be constrained to remain within the domain by maintaining cfl 1 where cfl is the courant friedrichs lewy condition e g durran 1999 this implementation is intrinsically free of if statements however free slip boundary conditions require further adaptation vertical interpolation choices include linear and spline interpolants linear interpolation is a standard approach and is consistent within model accuracy particularly for fine vertical resolution spline interpolation however allows representation of vertical curvature but at the potential cost of artificial maxima and minima particle tracking can employ a spatially decoupled advection strategy by splitting horizontal and vertical integration steps into sequential operations the benefit of this approach is that it decouples unstructured interpolants in the horizontal from one dimensional interpolation in the vertical and allows different particle behaviours to be employed for example vertical interpolation of velocities to specific potential density surfaces allows particles to be advected isopycnally and avoid diapycnal mixing that can occur with neutrally buoyant particle advection wolfram et al 2015 3 5 available tools as discussed throughout this section it is in principle straightforward to compute lagrangian particle trajectories by time stepping the trajectory eq 21 one merely needs to save the velocity field and update the trajectories using available software like matlab or python invoking either rudimentary schemes or built in functions such as the matlab ode suite several research groups have developed their own virtual particle codes tailored to specific model output format model grid and boundary conditions examples include a 3d lagrangian matlab code for the mitgcm used by koszalka et al 2013b and von appen et al 2014 and a 2d matlab code of the nonlinear dynamical systems group at eth zurich farazmand and haller 2012 http georgehaller com software software html however significantly more effort is required to develop an analysis code that features a user friendly interface and thus can be utilized across the modelling communities further work is needed to ensure that the code is efficient on data input output the suite of available tools can roughly be separated into two sets first there are large community based lagrangian codes such as ariane tracmass the connectivity modelling system cms and the new parcels code these are model independent run offline i e on stored velocity data and provide extensive control on particle behaviour the second set includes lagrangian codes tied to and sometimes distributed with specific models such as mitgcm hycom nemo roms and mpas o these model specific codes can be run online i e during the computation of the velocity data examples from both types of codes are discussed in appendix a these codes are also summarised in tables 1 and 2 notably all of these codes employ either explicit or implicit time integration of volume transports and while some can incorporate additional random terms section 3 3 2 there are no community codes available for computing tracer trajectories through the sde based methods of section 3 3 1 4 applications of lagrangian particle trajectories for most applications the raw particle trajectories output by lagrangian analysis codes need to be further processed to help answer scientific questions in this section we overview ways in which lagrangian particle trajectories can be used and analysed to improve our understanding of ocean circulation and dynamics 4 1 dispersion and diffusivity the ensemble particle dispersion and its rate of change the diffusivity are the fundamental lagrangian diagnostics of use for understanding tracer transport in oceanic flows particle trajectories can be used to diagnose eddy diffusivity via single pair and cluster techniques the detailed theoretical and practical underpinnings of these techniques in the context of oceanic flows are summarized by lacasce 2008 here we reiterate the main points the single particle diffusivity stems from the seminal work of taylor 1921 it quantifies the ensemble mean rate of particle dispersion from an initial location so that we have 33 κ t 1 2 d d t x 2 t v t x t 0 t v t v τ d τ in this equation x t is the lagrangian virtual particle trajectory and v t d x t d t is the lagrangian particle velocity the taylor formulation pertains to homogeneous stationary and isotropic flows and is non trivial to apply in practice different approaches to estimation of single particle statistics for particles deployed in stationary and homogeneous eulerian flows with cautious notes on particle deployment strategies and transient behavior are discussed by davis 1982 in the context of numerical simulations for modelled ocean flows of realistic complexity the estimation of single particle statistics must be further refined to account for non stationarity and inhomogeneities of the underlying eulerian field davis 1983 1985 1987 1991 under the assumption that the velocity field is slowly varying with respect to the time increment dt in practice dt can be the time step of a lagrangian model this assumption can be satisfied by segmentation of trajectories over a relevant time scale e g seasonal cycle the velocity decorrelation time scale and segregation in space into locally homogeneous regions davis 1991 koszalka and lacasce 2010 see also section 4 3 if the focus is on the transport by mesoscale turbulent flows eddy diffusivity an appropriate technique for the mean or slowly varying flow removal must be applied to the lagrangian velocity in eq 33 e g berloff et al 2002 rypina et al 2012 lumpkin and johnson 2013 the lagrangian transport anisotropy can be quantified by using the concept of tensor diffusivity where eq 33 applies to the different velocity vector components and projection of the flow in the along and across flow directions of maximum dispersion rypina et al 2011 2012 fox kemper et al 2013 kamenkovich et al 2015 wolfram et al 2015 in general anisotropy of the lagrangian transport arises from spatio temporal patterns and velocity correlations due to eddies a significant challenge is that the observed lagrangian particle dispersion is often non diffusive on long time scales e g rypina et al 2012 due to persistent lagrangian flow correlations double particle statistics builds upon the works of batchelor 1952 and bennett 1987 the relative diffusivity the time rate of the mean square pair separation is 34 κ r t 1 2 d d t r 2 t 1 2 d d t m n x m t x n t 2 where the sum is over all pairs of particles m n at times longer than the velocity decorrelation time scale the pair particles move independently from one another and the relative diffusivity is constant at twice the single particle diffusivity lacasce 2008 using the relative diffusivity rectifies the problem of the time mean flow removal by measuring particle relative separation though it will still be influenced by the mean flow shear in practice double particle statistics are often implemented in terms of cluster or moment methods which are equivalent to double particle statistics on the plane lacasce 2008 the single and double particle diagnostics derived from simulated trajectories may be used for the following quantifying the advection by the turbulent mesoscale flows eddy diffusivity in eddying models as a function of time and separation for example for parameterisations of diffusive processes in models that do not resolve eddies poje et al 2010 eddy diffusivity maps obtained by binning see section 4 3 quantify regional variability in eddy diffusivity and other derived statistics eddy length time scales e g lacasce et al 2014 griesel et al 2014 2015 investigating the nature of the oceanic turbulent transport the relative diffusivity as a function of particle separation is related to the eulerian kinetic energy spectra together with the fsles see section 4 2 the relative velocity diagnostics and the pair displacement pdfs can be used to check for consistency with quasigeostrophic turbulence chaotic advection and mean shear lacasce 2008 koszalka et al 2009 4 2 lagrangian coherent structures the ocean is full of eddies jets and other coherent structures which are visible in ocean tracers such as temperature or chlorophyll the field of lagrangian coherent structures lcs aims to identify the kinematic skeleton of such objects based on the lagrangian trajectories of the fluid and to study the role of these structures in transport here we provide a very brief introduction and overview of the field and refer the interested reader to the more comprehensive review articles on the topic e g peacock and dabiri 2010 peacock and haller 2013 haller 2015 the most developed branch of lcs theory is concerned with identifying distinguished material surfaces which serve as the boundaries of coherent regions in unsteady flows according to haller 2015 a method for identifying such surfaces must a be objective i e gives the same result in all observer reference frames b be applicable over a finite time interval c describe an actual material surface and d converge with respect to spatial resolution many different lcs diagnostics have been developed to detect different types of structures a starting point in many lcs identification methods however is the finite time flow map f t 0 t x 0 which gives the positions at time t of particles initially located at x 0 at time t 0 the flow map can only be calculated by numerically advecting a large ensemble of closely spaced lagrangian particles from this flow map one can compute the cauchy green strain tensor c x 0 f t 0 t x 0 t f t 0 t x 0 which measures the magnitude of the growth in separation of infinitesimal perturbations in the initial position space c is characterised by its eigenvalues λ and corresponding eigenvectors the original diagnostic of lcss is the finite time lyapunov exponent ftle the ftle is a measure of the exponential rate of separation of trajectories of infinitesimally close initial points over a finite time interval and is given by 35 f t l e x 0 t 0 τ 1 τ ln λ m a x with λmax the maximum eigenvalue of c over the chosen finite integration time τ t t 0 early applications of the ftle were to distinguish regions of high and low predictability in chaotic flows ftle pierrehumbert and yang 1993 artale et al 1997 later ftle fields were applied to the identification of attracting and repelling transport barriers haller and yuan 2000 lapeyre 2002 the ridges i e curves of local maxima of the ftle field correspond with repelling lcs positions at t 0 as regions of extreme local stretching these structures represent material barriers which remain coherent under advection unlike general material lines attracting lcss which represent the lagrangian skeleton of tracer filaments can similarly be obtained as ridges of the ftle field calculated from a backward time integration haller and sapsis 2011 review different strategies for calculating attracting and repelling lcss from forward and backward time ftles a related diagnostic is the finite size lyapunov exponent fsle aurell et al 1997 which represents the time required for particle separation to reach a specified size fig 3 fsles have also been used widely for lcs identification and can be related to the statistics of turbulent dispersion lacasce 2008 however karrasch and haller 2013 proved that fsle and ftle ridges do not coincide in general and argued that fsles were less reliable for the identification of lcss the statistics of ftle and fsle based on flow maps constructed from lagrangian particle trajectories have been applied to characterize regimes of dispersion and regional differences in mixing drijfhout et al 2003 waugh and abraham 2008 haza et al 2010 lumpkin and elipot 2010 schroeder et al 2011 poje et al 2014 instantaneous maps of ftle and fsle derived from satellite altimetric velocities have also been used to identify lcs positions in the ocean d ovidio et al 2004 olascoaga et al 2006 lehahn et al 2007 beron vera et al 2008 attracting lcs represent transport barriers and indeed several studies have confirmed the tight correlation between the detected structures and fronts of advected tracers including sea surface temperature abraham and bowen 2002 d ovidio et al 2009 chlorophyll concentrations lehahn et al 2007 oxygen bettencourt et al 2015 oil spills mezić et al 2010 and even different dominant phytoplanktonic types d ovidio et al 2010 not all coherent structures relevant for transport can reliably be deduced from the ftle or fsle fields over the past decade lcs detection methods have developed increasing precision at discriminating different flavours of structure geometry resulting in a proliferation of techniques haller 2015 haller and beron vera 2012 used a variational approach to find the least stretching material lines in the forward and backward flow maps the initial positions of these lines called hyperbolic lcss can be identified as the geodesic curves of a riemannian metric related to the cauchy green strain tensor definitions of parabolic and elliptic lcss corresponding to jet cores and vortex boundaries can similarly be made using the tools of differential geometry haller and beron vera 2013 haller 2015 additional methods for vortex identification based on dynamic polar decomposition and lagrangian averaged vorticity deviation have recently been proposed haller 2016 haller et al 2016 while yet a different class of methods identifies lcs based on a probabilistic transfer function froyland et al 2007 a much needed critical comparison of different methods and their performance in different test cases was recently undertaken by hadjighasem et al 2017 which provides valuable practical advice for researchers wishing to implement these techniques a central preoccupation of lcs techniques is the identification of coherent mesoscale eddies beron vera et al 2013 used the elliptic lcs framework to identify materially coherent agulhas rings emphasizing the advantages over eulerian eddy identification methods while froyland et al 2012 applied the transfer function method to the same region wang et al 2016 and froyland et al 2015 used the identified structures to study the transport origin and decay of agulhas ring waters abernathey and haller 2017 used the lagrangian averaged vorticity deviation method of haller et al 2016 to identify eddies in the eastern pacific and quantify their role in meridional dispersion these studies illustrate the value of lcs methods for questions of long range material transport 4 3 probability distributions a common way to visualize trajectory data is to bin particle positions into histograms the result is a map of particle density which when normalised by the total number of particle positions yields a probability map alternatively we can produce probability maps by counting the visit of a particular particle only once per bin and then normalizing by the total number of particles instead of the total number of particle positions e g van sebille et al 2012 von appen et al 2014 both methods offer a useful means to identify flow structure through particle pathways from a set of release points fig 4 illustrates the use of both methods for studying the flow responsible for the spreading of particles originating in the agulhas current fig 4a shows the probability derived from the procedure described at first obviously bins located within the areas of the agulhas current ac the agulhas return current arc and the agulhas ring corridor show the highest probabilities highlighting the most probable spreading pathways along the major currents and via mesoscale eddies but even between the ac and arc there is a region with comparable particle position counts fig 4b reveals that this is not due to a particularly strong circulation feature transporting many particles but rather due to the recirculation of fewer particles one consideration in the choice of bin resolution is aliasing if either the grid resolution is too fine or the period of particle position updates is too long trajectories may pass through more than one histogram bin within a given output time step and thus may not be adequately accounted for the density maps from binning can also be scaled to account for the residence time in bins and the time step of the lagrangian simulation one practice is to scale the particle density maps by the time step dt to obtain the density maps in units of days e g koszalka et al 2011 another is to scale the particle densities in bins with the integral lagrangian time scale tl yielding particle distributions in bins in terms of the number of independent observations n i n d n t t l where t is the total time e g koszalka and lacasce 2010 apart from using particle density maps to assess the water mass pathways and connectivity binning of particle positions and their corresponding properties allows the investigation of mean properties temperature density and their changes along simulated trajectories e g van sebille et al 2014 binning lagrangian velocities to test the gaussianity of their distributions and other velocity statistics is yet another application lacasce 2005 the binning is also used to construct maps of eddy diffusivity from particle simulations in high resolution models e g lacasce et al 2014 griesel et al 2014 2015 using binning to estimate spatially dependent eddy diffusivities pseudo eulerian eddy diffusivity maps and other parameters maps of eddy time and length scales has been widely used in observational lagrangian analysis bauer et al 2002 koszalka et al 2011 rypina et al 2012 lumpkin and johnson 2013 zhurbas 2004 as well as in particle simulations in eddy resolving models e g berloff et al 2002 lacasce et al 2014 griesel et al 2014 2015 binning can be used to verify the spreading of lagrangian particles by comparing the ensemble particle movement with large scale distributions of either conserved quantities such as potential vorticity or a tracer field whose evolution is explicitly computed online in the ogcm e g gary et al 2012 such evaluations can be statistically formalised using pointwise correlation between the binned histogram and the online tracer simons et al 2013 binning is not limited to spatial boxes as particles can be binned by virtually any variable that can be determined along a particle s path for example depth time density temperature salinity etc this sort of binning can be useful to highlight along pathway water mass transformations e g koszalka et al 2013b iudicone et al 2011 gary et al 2014 van sebille et al 2014 particles can also be binned by the distance from the deployment site such a distance metric can be redefined to account for the topographic steering davis 1998 finally an alternative to binning was proposed by koszalka and lacasce 2010 rather than grouping the lagrangian data in bins of fixed size they grouped a fixed number of nearest neighbour particle positions together using a clustering algorithm 4 4 water mass ages and transit times the age of ocean water or the time taken for water to transit between defined regions or reservoirs is a property of the flow that provides useful understanding of the ocean circulation deleersnijder et al 2001 such a metric can be easily derived from lagrangian calculations by determining the transit time of particles since the age of water can also be recovered from float trajectories or observations of chemical tracers fine et al 2002 waugh et al 2004 there is the possibility to use the age to evaluate model results in comparison to observations however this comparison requires careful interpretation khatiwala et al 2001 and has been rare e g haines et al 1999 the age of a parcel of ocean water described by numerous particle trajectories is not unique since different particles may transit between two regions by distinct pathways travelling for different lengths of time phelps et al 2013 as such the age of ocean water is in fact a probability distribution the transit time distribution ttd that an individual particle might take to travel between the two regions holzer and hall 2000 deleersnijder et al 2001 haine and hall 2002 given a sufficient number of lagrangian trajectories a ttd between two regions can be formed from a histogram of the particle ages see fig 5 for an example in the agulhas region in lagrangian ocean analysis the range maximum or variance of this ttd is used to understand the inherent timescales of the circulation e g rühs et al 2013 however transit time distributions are highly sensitive to the spatial scales resolved by the numerical model from which lagrangian trajectories are determined in lagrangian analyses the age can be evaluated as the time since a particle was last within the surface ocean the ventilation timescale in which case it reveals the timescales on which the ocean interacts with the atmosphere and influences global climate this method has been considered for the global ocean blanke and speich 2002 as well as specific water masses koch larrouy et al 2010 in regional seas with riverine forcing an analogue to ventilation with the atmosphere is freshwater age phelps et al 2013 one difficulty is that the ventilation timescale of deep ocean flows which can be on the order of thousands of years often exceeds the length of available ogcm output such that the velocity fields must to be looped to calculate the full ttd see also section 3 2 by considering the entry and exit of particles from an enclosed region transit times can be interpreted as a residence timescale for a marginal sea with one point of exchange such as the baltic sea this has been used as an alternative to the classic box model approach döös et al 2004 jönsson et al 2004 where there are multiple points of exchange such as the arctic ocean the approach determines the timescales on which these gateways interact lique et al 2010 lagrangian transit times are also used to evaluate the timescales on which anomalies in a certain region would influence the flow downstream e g speich et al 2001 van sebille et al 2011 rühs et al 2013 or to determine time integrated properties of specific flows such as the average speed koszalka et al 2013b or the most rapid pathways gary et al 2012 4 5 volume transport and lagrangian streamfunctions among the first uses of basin scale lagrangian particle tracking was to assess seawater volume transports between chosen sites in the ocean resulting in an effective way of quantifying lagrangian connectivity in these applications each particle is tagged with a transport upon release and that transport is then conserved along the trajectory as per the streamtube discussion in section 2 4 we can construct volume transport pathways by summing the transports of particles that connect two regions see fig 6 for an illustrative example just like in the eulerian framework the concept of volume conservation as in a boussinesq fluid discussed in section 2 4 can be used to collapse the full three dimensional transport into a two dimensional streamfunction the unique feature in lagrangian streamfunctions is that they can be constructed for only that part of the flow that connects the section where particles are released and where they are received this concept has been applied to study for example the cold and warm water routes into the atlantic speich et al 2001 2002 drijfhout et al 2003 agulhas leakage durgadoo et al 2017 the pacific to indian ocean connectivity van sebille et al 2014 the lagrangian decomposition of the deacon cell döös et al 2008 and the atlantic moc thomas et al 2015b the concept of lagrangian streamfunctions was introduced by blanke et al 1999 and is closely tied to the analytical integration method section 3 2 3 consider a domain with open boundaries such as the agulhas region around south africa trajectories are initialized along the boundaries of a control volume box in fig 6 and traced until they again reach the boundaries each trajectory is associated with a volume transport and the volume transport is recorded at each grid wall crossing of a trajectory this method results in a non divergent field of volume fluxes through all grid walls that can be integrated to lagrangian streamfunctions it is to be noted that this streamfunction represents the mean flow during the whole integration period i e ideally until all trajectories have left the box both döös et al 2008 and kjellsson and döös 2012a showed that the total lagrangian streamfunction is almost identical to the eulerian streamfunction one of the main differences is that the lagrangian streamfunction is based on trajectories with varying residence times ranging from hours to months or even years while eulerian streamfunctions are snapshots or time averages 4 6 biological connectivity lagrangian particle trajectories can be used to study how water moves around in the ocean additionally lagrangian particles can be interpreted as passively drifting biological particulates many marine organisms reproduce with larvae that are dispersed at the whim of the currents hydrodynamic connectivity therefore has important implications for population dynamics e g kool et al 2013 thomas et al 2014 in particular this connectivity generally allows for longer dispersal and more rapid range expansion than is observed in terrestrial species kinlan and gaines 2003 as well as directly creating range limits gaylord and gaines 2000 understanding these processes and their implications is important for a range of management objectives transport models have provided insights in varied contexts including the creation of robust networks of marine protected areas gaines et al 2003 berglund et al 2012 burgess et al 2014 conservation of coral reefs treml et al 2008 wood et al 2013 sustainability of fisheries gilbert et al 2010 competition between biophysical and hydrodynamical controls on larvae retention phelps et al 2015 and spread of invasive species similar models are frequently applied in coastal scenarios to understand the spread of aquaculture parasites salama and rabe 2013 and invasive benthic organisms brandt et al 2008 it is important to note that horizontal resolution and subgrid scale diffusivity of the underlying eulerian flow field can be a key for the distribution and time scales as it was the case for the dispersion of european glass eels blanke et al 2012 baltazar soares et al 2014 how these larvae interact with the water column depends on a range of characteristics such as size development rate and behaviour mcmanus and woodson 2012 models investigating biological connectivity must therefore account for these characteristics and many others e g visser 2008 paris et al 2013b in addition to physical processes behaviour such as orientation and swimming in response to scent plumes released from suitable habitat holstein et al 2014 staaterman and paris 2013 is often documented as is vertical migration lampert 1989 observations of microchemical markers genetic microsatellite markers and single nucleotide polymorphisms can provide information on realised connectivity between spatially separated populations they can provide a direct comparison for lagrangian tracking predictions e g pujolar et al 2013 wilkins et al 2013 teske et al 2015 in terms of population similarity and can provide evidence of biogeographic barriers for example coral species in the gulf of mexico sammarco et al 2012 recent work hints at the possibility of applying such techniques to understand population connectivity and evaluate predicted patterns at a global scale e g hellweger et al 2014 villar et al 2015 jonsson and watson 2016 5 outlook lagrangian analysis provides a powerful tool to help interpret output from ogcms this power will only increase as ogcms enter peta scale territory in this final section we offer outlooks on where we see new and exciting opportunities and possibilities for the lagrangian analysis of ogcms 5 1 the next generation of particle tools a major challenge with particle tracking is obtaining performance for a large number order of billions of particles for small velocity data sets offline parallel particle tracking can be employed via a single instruction multiple data simd approach e g openmp or gpu based implementations however input output will remain a bottle neck with most codes simply reading in the entire velocity field even if the particles occupy only a subregion of the domain recent advances in the netcdf library toolkit however mean that it is now feasible to read in only those parts of the grid where there are particles so that the number of input output operations could potentially be reduced by orders of magnitude implementation of these new libraries in combination with better memory management and efficient use of tiered cache levels will lead to vastly faster codes that also have smaller memory footprints nevertheless for petabyte scale velocity data sets such as those from grand challenge climate simulations online particle tracking is necessary to avoid the unsustainable storage costs associated with offline particle tracking the challenge in this arena however is utilization of heterogeneous computer architectures message passing mpi between computational nodes is essential and a hybrid approach utilising on node openmp gpu or mic threading will be required on next generation architectures to obtain peak performance task based parallelism if implemented for ogcms may provide at least a partial solution however at present no definitive framework or best practice has been adopted several ogcms already have on line particle diagnostics see appendix a 2 yet no general library for coupled lagrangian particle tracking exists so far as a result development efforts are disjoint and functionalities are often model specific on the other hand run time integration with ogcms requires close coupling with grid data in order to reduce performance overheads while the variety of grid types makes finding a general abstraction difficult moreover such a library needs to provide parallel performance and scalability as well as an easily accessible api that allows it to be integrated with different types of ocean models 5 2 a case for standard tests of particle tools most of the lagrangian particle tracking tools described in section 3 5 have never been compared against each other which makes it hard to assess their skill and fidelity while most codes are designed for very different purposes we propose to develop a set of test cases that we suggest code developers to use when debugging codes this set of test cases would then also serve to highlight differences in explicit versus analytical time stepping codes for example or differences between particle tracking on a b and c grids while we envision the set to grow over time the following would be a minimum requirement a first set of tests to consider are those where analytical expressions are known for trajectories 1 radial rotation with known period this setup tests particle trajectories in the simplest possible flow without time evolution 2 longitudinal shear dispersion flow in a pipe e g fischer et al 2013 to ensure that shear dispersion effects are properly represented 3 effective lateral diffusion due to an oscillating vertical shear flow bowden 1965 to test particle trajectories in a time evolving flow 4 steady state flow around a peninsula ådlandsvik et al 2009 this setup tests particle trajectories in a domain with an obstacle and can be used to test how codes behave near land boundaries 5 steady state flow in a stommel gyre and western boundary current fabbroni 2009 to test particle trajectories in a domain with large gradients in flow speed 6 damped inertial oscillation on a geostrophic flow fabbroni 2009 döös et al 2013 to appropriately quantify sub inertial motion e g loopers 7 for codes that include diffusivity a simulation of brownian motion with a given kh and kv to test for sub grid parameterizations of diffusivity a second set of tests can be considered that do not have an analytical solution but that test for speed and efficiency of the code in more realistic idealized test cases corresponding to eddy resolving simulations e g as are becoming standard in modern climate models 8 zonally periodic baroclinic channel ilıcak et al 2012 berloff et al 2009 abernathey et al 2013 ringler et al 2016 wolfram and ringler 2017a 2017b to explore unconstrained eddy and mean flow interactions e g in an idealized antarctic circumpolar current 9 eddying double gyre flow shevchenko and berloff 2015 wolfram et al 2015 to explore idealized eddying flows constrained within an ocean basin looking forward a list such as this one might form the basis of a lagrangian model intercomparison project lmip similar to that used in the climate modelling community through the coupled model intercomparison project eyring et al 2015 or the ocean model intercomparison project griffies et al 2016 an lmip could host the velocity fields and analytical solutions of the set of test cases needed by particle model developers for debugging purposes to allow for use across a broad suite of analysis software we encourage developers of tools to make the trajectory data cf compliant as stated at http cfconventions org data cf conventions cf conventions 1 6 build cf conventions html discrete sampling geometries 5 3 whole earth system and water cycle modelling beyond quantifying the pathways of seawater in the ocean it is tantalising to consider whether lagrangian methods could be used to track water throughout the entire climate system such analysis could be used to quantify coupled thermodynamic cycles laliberte et al 2015 kjellsson et al 2014 zika et al 2012 döös et al 2012 geographical connectivity gimeno et al 2010 and the transport dilution and fractionation of salt nutrients and oxygen fig 7 here we will discuss such prospects including basic requirements and challenges of such analysis one important reason for modelling the water cycle is the intensification evident over recent decades in ocean salinity hosoda et al 2009 helm et al 2010 durack et al 2012 central to this intensification are changes to moist processes in the atmosphere held and soden 2006 however based on observed salinity and in cmip5 simulations the hydrological cycle intensifies at around half the rate predicted from moist thermodynamics alone skliris et al 2016 while observations are currently inadequate for an accurate quantification of changes in key processes hegerl et al 2015 including precipitation and evaporation over the oceans skliris et al 2014 with a lagrangian description of the global water cycle in coupled climate models it will be possible to fully explore the full range of atmospheric processes that are driving and retarding the observed intensification another motivation is the possibility of tracing stable water isotopes through the earth system stable water isotopes are a cornerstone in paleoclimate reconstructions since their concentrations can be used to infer the source of the water for example water vapour that has evaporated from the ocean has low concentrations of heavy isotopes likewise ice on antarctica also has very low concentrations of heavy isotopes so it is likely that the ice originates from evaporated water that precipitated over the continent gat 1996 hence an observed decrease in heavy isotope concentrations in the ocean could be due to either less evaporation or advection of meltwater from ice sheets or land roche 2013 if we could trace the isotopic composition of water as it moves between oceans atmosphere land and ice we could reconstruct the hydrological cycles of past climates in general if a lagrangian code is to exchange particles between ocean and other components of the earth system it must first deal appropriately with sources and sinks of water within the ocean itself it is now common for ocean models to have explicit water fluxes at the sea surface due to evaporation precipitation and river run off griffies et al 2000 these sources and sinks of water in the ocean should be accounted for in any lagrangian framework e g with sources and sinks of particles regardless of whether water is being traced between components secondly for water to be consistently traced between components of the climate system water must be conserved between them this is for example the case in some sea ice and iceberg models which are integrated into ocean modelling systems martin and adcroft 2010 marsh et al 2015 some of which incidentally use a lagrangian framework however challenges remain in conserving water consistently between the ocean atmosphere terrestrial hydrological systems e g lakes soil moisture groundwater and irrigation and ice sheets tracking water within each component of the earth system other than the ocean presents its own challenges there is for example a rich history of lagrangian methods in meteorology stohl 1998 some having evolved from the oceanographic community e g tracmass see kjellsson and döös 2012a it is common for such methods to track air masses rather than water itself water in the atmosphere comes in three phases vapour liquid and ice making the tracking of water challenging however robust methods are in common use see for example the flexpart model stohl and james 2005 gimeno et al 2010 simulating the movement of water as lagrangian particles between different components of the earth system is further complicated by vast contrasts in scale both in storage and transport rates between them the atmosphere for example holds 0 001 of all the water in the climate system while the ocean holds 97 in contrast the cycle of evaporation and precipitation over the globe amounts to approximately 16 sv i e multiplying global mean precipitation of 2 7 mm day trenberth 1998 by the area of the earth so while storage of water in the atmosphere is small relative to the ocean its transport of water is equivalent to that of major ocean currents differences in scales of motion and numerical description of these systems present great technical challenges beyond the scope of this review 6 concluding remarks in this review article we have presented an extensive overview of the state of the art in lagrangian particle analysis we focused on the use of particles determined by integral curves of the velocity field and large scale open ocean applications based on the collective knowledge of the authors we have identified opportunities and issues for improvements of these methods as we move towards a petascale age of computing we hope that the guidance provided here can provide a starting point for new users as well as an impetus for experienced users and developers of these codes acknowledgements this review paper is the result of very fruitful discussions during the future of lagrangian ocean modelling workshop held at imperial college london uk in september 2015 funding for this workshop was provided through an epsrc institutional sponsorship grant to evs under reference number ep n50869x 1 evs has received funding from the european research council erc under the european unions horizon 2020 research and innovation programme grant agreement no 715386 this research for pjw was supported as part of the energy exascale earth system model e3sm project funded by the u s department of energy office of science office of biological and environmental research funding for hfd was provided by grant no de sc0012457 from the us department of energy pb acknowledges support for this work from nerc grant ne r011567 1 sfg is supported by nerc national capability funding through the extended ellett line programme ed is an honorary research associate with the belgian fund for scientific research f r s fnrs sr was funded grant cp1412 by the cluster of excellence 80 the future ocean within the framework of the excellence initiative by the deutsche forschungsgemeinschaft dfg on behalf of the german federal and state governments we thank sergey danilov editor andrew shao françois primeau nathaniel tarshish and five anonymous reviewers for very helpful comments we also wish to thank all the scientists researchers and programmers who built the ocean general circulation and lagrangian tracking models over the past decades appendix a community tools for lagrangian ocean analysis in this appendix we provide further background to the different community codes both for offline and online particle tracking listed in tables 1 and 2 a1 community based offline 3d lagrangian codes a1 1 ariane ariane is a numerical diagnostic tool developed at the laboratoire de physique des océans brest france it is dedicated to the off line computation of the advective component of 3d trajectories and subsequent volume transport analyses in given velocity and tracer fields most often obtained from the numerical integration of an ocean general circulation model the trajectory integration scheme at the core of the ariane calculations blanke and raynaud 1997 dates back to 1992 speich 1992 it takes full advantage of the volume continuity equation expressed on a c grid mesinger and arakawa 1976 there are several advantages to the analytical calculation of streamlines on the model grid for successive time intervals over which the velocity is assumed to be steady state see section 3 2 3 the method only calculates particle positions on the edge of grid cells and it respects the local three dimensional non divergence of the flow doing so makes the method both fast and accurate in terms of truncation error relative to an rk4 code it offers flexibility too in which backward integrations can be performed to track the origin of a given volume a trajectory scheme that respects the continuity equation shows excellent capability for volume tracing following the streamtube perspective discussed in section 2 4 following the methodology proposed by döös 1995 and taken up by blanke and raynaud 1997 to take advantage of such a scheme water volume transfers between selected control sections can be assessed with great accuracy they can be portrayed by means of lagrangian streamfunctions defined either on a geographic plane blanke et al 1999 or on other sets of coordinates that include the model physical tracers blanke et al 2006 a1 2 tracmass the tracmass lagrangian trajectory code was originally developed by döös 1995 and a thorough documentation was given by döös et al 2013 and döös et al 2017 tracmass has been used to calculate trajectories using velocity and tracer fields from a variety of ocean models tracmass has also been used to study the atmospheric hadley and ferrell cells using era interim as input kjellsson and döös 2012a hence tracmass can handle a wide variety of vertical grids and data formats tracmass solves the path of a trajectory through a grid box analytically see section 3 2 3 trajectories are thus unique and if a trajectory is calculated forward and then backward the solution will be the same up to numerical noise due to round off errors there are two algorithms for calculating the trajectories the original from döös 1995 uses velocities and tracers for trajectory calculations that are assumed piecewise constant in time another algorithm was developed by de vries and döös 2001 where time dependence was taken into account by linearly interpolating the velocities in both time and space döös et al 2017 showed that the time interpolating scheme resulted in much more accurate calculations than the piecewise time constant scheme tracmass trajectories have also been used to simulate the behaviour of surface drifters kjellsson and döös 2012b nilsson et al 2013 comparing the simulated drifter trajectories with observed surface drifter trajectories has showed that coarse resolution ocean models lack variability in the surface currents which is very likely due to the omission of stochastic noise to mimic subgrid scale diffusion a1 3 octopus octopus is an offline particle tracking code first written to conduct offline particle simulation using the southern ocean state estimation mazloff et al 2010 which makes use of the mitgcm the code was used to study tracer evolution wang et al 2016 observed during the diapycnal and isopycnal mixing experiment in the southern ocean dimes gille et al 2007 ledwell et al 2011 it was later used in simulating argo floats as a component of observational system planning for the southern ocean carbon and climate observations and modeling project soccom http soccom princeton edu and in studies of watermass pathways in the southern ocean the interpolation scheme is linear in time and trilinear in space the rk4 scheme is used for time integration the boundary condition is reflective at the surface and solid walls the model is currently written in fortran for structured c grids openmp is implemented for shared memory parallel calculation a1 4 lamta software package the lagrangian manifolds and trajectories analyser lamta consists of a set of functions developed for gnu octave and intended for the analysis of two dimensional velocity fields in particular for oceanic current datasets the source code is freely available and distributed under a gpl license upon direct request to the authors d ovidio and nencioli the package provides routines to compute particle trajectories and lagrangian diagnostics based on user defined velocity fields which include analytical test cases numerical model results and altimetry based surface geostrophic currents the trajectories are computed using a runge kutta fourth order advection scheme section 3 2 1 particle advection can be performed either forward or backward in time the scheme applies bi linear interpolation of velocities in space and if necessary linear interpolation in time lagrangian diagnostics include finite time size lyapunov exponents eddy retention origin of water particles age of a water particles from a given bathymetry the package has been applied to investigate the relationship between satellite based lagrangian coherent structures and ocean surface tracers in the open ocean d ovidio et al 2004 2009 lehahn et al 2007 the retention of mesoscale structures smetacek et al 2012 martin et al 2013 the impact of horizontal advection in structuring ecological niches d ovidio et al 2010 up to top predators cotté et al 2011 de monte et al 2012 bon et al 2015 cotté et al 2015 and for contextualizing biodiversity genomic data sunagawa et al 2015 lamta has been recently included in the spasso software package for an adaptive satellite based sampling for ocean campaigns software package 14 14 http www mio univ amu fr doglioli spasso htm developed to guide the in situ sampling strategy as well as the interpretation of collected observations from sub mesoscale oriented field experiments the package has been used to support experiments in the nw mediterranean latex e g nencioli et al 2011 2013 tropical north atlantic strasse reverdin et al 2015 and southern indian ocean keops2 d ovidio et al 2015 and lohafex martin et al 2013 the code has also been integrated in the package used by cnes aviso to produce global maps of lyapunov exponents and vectors from altimetry data a1 5 the connectivity modeling system cms the connectivity modelling system cms paris et al 2013b is an open source fortran toolbox created at the university of miami for the multi scale tracking of biotic and abiotic particles in the ocean the tool is inherently multiscale allowing for the seamless moving of particles between grids at different resolutions the cms has been used on velocity fields from ofes hycom nemo mitgcm uvic ecco2 sose mom and many other ocean models to compute dispersion connectivity and fate in applications including large scale oceanography marine reserve planning and movement of marine biota all across the world the cms uses rk4 timestepping and tricubic interpolation and is designed to be modular and probabilistic meaning that it is relatively easy to add additional behaviours to the particles with attributed randomly assigned for a distribution of traits modules distributed with the code include random walk diffusion mortality vertical migration mixed layer mixing and a seascape module designed to generate a connectivity matrix output from the source to the final destination of the particles a1 6 other biotic particle models while the cms discussed above is also used for physical oceanography applications the code has been developed as a so called individual based model ibm which serve predominantly biophysical applications another widely used example of an ibm is ichtyop lett et al 2008 http www ichthyop org we will not cover ibms in this discussion as a very good recent overview can be found in lynch et al 2014 a1 7 parcels parcels is an experimental prototype code aimed at exploring novel approaches for lagrangian tracking of virtual ocean tracer particles in the petascale age parcels which is currently under development is designed from the ground up to be efficient and fast for the next generation of ocean circulation models these ocean models are so big and massively parallel and they produce so much data that in a few years we may face a situation where many of the lagrangian frameworks cannot be used on the latest data any more see also section 5 1 the user interface of parcels is written in python while the computational intensive integration is just in time jit compiled into c the code is formed around a flexible and customisable api that allows rapid model development based on discrete time stepping algorithms section 3 2 1 it has a high level abstraction that hides complexities from the user field sampling efficient loop scheduling file i o etc this allows computer architecture experts to optimise underlying methods without changing the high level description of the model a2 online tools within ogcms a2 1 light within mpas o the los alamos national laboratory model for prediction across scales ocean mpas o ringler et al 2013 is a fully unstructured c grid ocean model capable of multiscale ocean simulation that is part of the energy exascale earth system model e3sm formerly known as accelerated climate model for energy acme mpas o uses an online diagnostic particle tracking technique called light wolfram et al 2015 for lagrangian in situ global high performance particle tracking which is integrated within the mpas framework and uses different particle advection modes corresponding to different vertical interpolation schemes for example particles can be advected along isopycnally constrained trajectories time advancement uses a generalized runge kutta sub stepping scheme horizontal interpolation with wachspress interpolation gillette et al 2012 occurs following reconstruction of the full velocity vector via an inverse multi quadratic radial basis function approach baudisch et al 2006 particles are implemented in linked lists on each processor to conserve memory for large particle simulations and parallelism is via mpi parallel communication occurs during the computational step between spatially adjacent processors for particles advecting from one processor to another and global parallel communication is reserved for input and output i o tasks processor exchange lists for i o may either be incrementally updated or globally computed to minimize communication overhead in different particle tracking configurations light provides the capability to advect the same number of particles as cells to obtain a complementary lagrangian description of the flow computed by the eulerian prognostic solver in mpas o a version of mpas o that includes light will be available via the public release of the u s department of energy s energy exascale earth system model e3sm a2 2 nemo nemo the nucleus for european modelling of the ocean model madec and nemo team 2016 includes both lagrangian floats madec 2008 and interactive icebergs module icb both rk4 in addition to the online icebergs option nemo icb marsh et al 2015 icebergs can be forced in offline mode for tracking purposes using the stand alone surface forced sas option as sas icb in both nemo icb and sas icb implementation exploits available mpi parallelism a2 3 mitgcm the massachusetts institute of technology general circulation model mitgcm marshall et al 1997b 1997c is a generalized level coordinate ocean model with a wide range of configuration possibilities the mitgcm includes a package for lagrangian particle advection the lagrangian package named flt is however poorly documented and not described in the literature nevertheless this package provides a convenient way to integrate lagrangian analysis into existing mitgcm setups thereby taking advantage of the mpi parallelism of the model numerically floats are advected using rk4 a fixed memory buffer is allocated for floats on each tile implying that memory is wasted for sparse particle ensembles because of mitgcm s offline mode adcroft et al 2014 which enables loading of velocity fields from files mitgcm can be effectively used as a general purpose lagrangian model numerous studies have employed this configuration for simulating lagrangian trajectories from satellite derived geostrophic velocities klocker et al 2012b 2012a klocker and abernathey 2014 and three dimensional model output abernathey et al 2013 a2 4 hycom hycom the hybrid coordinate ocean model is a generalized hybrid vertical coordinate ocean model isopycnal terrain following and or pressure it is isopycnal in the open stratified ocean but reverts smoothly to a terrain following coordinate in shallow coastal regions and to pressure coordinates near the surface in the mixed layer bleck 2002 chassignet et al 2003 2006 hycom includes online code designed to follow numerical particles during model run time halliwell and garraffo 2002 wallcraft et al 2009 in addition to the ability to follow a fluid particle in three dimensions one can also release both isobaric and isopycnic floats isobaric floats remain at prescribed pressure levels while isopycnic floats remain on prescribed density surfaces because of the generalized or hybrid vertical coordinate of hycom one has to be especially attentive when performing vertical and horizontal interpolations advections the horizontal vertical and temporal interpolation schemes used in hycom to advect the floats are adapted from garraffo et al 2001a 2001b horizontal interpolation is performed using a sixteen point grid box surrounding the float when a sufficient number of good grid points are available bilinear interpolation otherwise vertical interpolation first locates the bounding pressure interfaces and all properties are then linearly interpolated to the float location temporal interpolation is performed using rk4 since the vertical velocity is not a prognostic variable in hycom it is diagnosed using the continuity equation see halliwell and garraffo 2002 and wallcraft et al 2009 for details on the implementation a2 5 roms roms regional ocean model system https www myroms org is a free surface hydrostatic primitive equations ocean model with terrain following vertical coordinates that allow differential stretching shchepetkin and mcwilliams 2005 haidvogel et al 2008 it is an open source parallel fortran code coupled to several models including biogeochemestry waves sediments bio optical and sea ice it offers great flexibility for configuration and is widely used by the scientific community for a diverse range of applications roms includes a module called floats which allows the release and tracking of numerical particles during model run time passive floats can be of 3 different types neutral density 3d lagrangian isobaric remain at prescribed pressure level or geopotential remain at prescribed depth the numerical scheme used to time step simulated floats trajectories is a fourth order milne predictor and fourth order hamming corrector it is possible to add a random walk to the floats to simulate subgrid scale vertical diffusion the random walk component is implemented considering spatially variable diffusivity following hunter et al 1993 floats can either reflect or stick when they hit the surface bottom boundaries clusters of floats with user defined distributions can be released at specified locations it is possible to release particles multiple times at defined time intervals throughout the run recently new subroutines have been implemented to allow for biological floats that behave according to user defined parameters the complex biology of oyster larvae including variable growth rates and vertical swimming dependent on food salinity temperature and turbidity has been implemented narvaez et al 2012a 2012b and is available with the latest roms release appendix b tracer trajectories with isopycnal diffusion we here illustrate the stochastic differential equation discussion from section 3 3 1 we consider the calculation of lagrangian tracer trajectories in a 3d benchmark for diffusive tracer transport from shah et al 2011 2013 note that in two dimensions the approach is slightly different see appendix c for this purpose let x and y denote the horizontal coordinates while z denotes the vertical coordinate and assume zero diapycnal diffusion if ρ is the potential density field assume linear equation of state then the isopycnal diffusion tensor redi 1982 reads 36 k k i ρ x 2 ρ y 2 ρ z 2 ρ y 2 ρ z 2 ρ x ρ y ρ x ρ z ρ y ρ x ρ x 2 ρ z 2 ρ y ρ z ρ z ρ x ρ z ρ y ρ x 2 ρ y 2 here ki represents the isopycnal diffusion coefficient and ρ is given by 37 ρ x y z ρ 0 1 n 2 z g α x sin κ x x α y sin κ y y note that the vertical density gradient is assumed to be constant but the horizontal one is not so that the isopycnal surfaces are not flat the concentration satisfies the following initial value problem 38 c t x i k i j c x j t 0 t t c x t c 0 x to solve this problem with the stochastic model given by eq 27 one needs to decompose the diffusion tensor k in the form 2 k i j σ i k σ j k using a cholesky decomposition method the components of the matrix σ can be determined this decomposition leads to the following stochastic differential equations describing the behaviour of the individual particles note that due to the use the of cholesky decomposition the components σxy σxz and σyz of the matrix σ are zero 39 d x t a x d t 2 σ x x d w x t d y t a y d t 2 σ y x d w x t 2 σ y y d w y t d z t a z d t 2 σ z x d w x t 2 σ z y d w y t x t 0 x 0 y t 0 y 0 z t 0 z 0 where the drift coefficients ax ay and az are given by 40 a x k x x x k x y y a y k y x x k y y y and a z k z x x k z y y in fig 8 a results of a simulation are shown for parameter values that are relevant for ocean transport problems shah et al 2011 2013 here the particles have been released at the origin x y z 0 0 0 a point that belongs to the isopycnal surface the position vector x j t y j t z j t j 1 2 j of each particles is simulated by means of a lagrangian scheme because the diapycnal diffusion is zero the particles should not leave the isopycnal surface however numerical errors are unavoidable and their magnitude can be estimated by means of a spurious diapycnal diffusivity the results presented in fig 8b show that the higher order milstein scheme performs better than the euler scheme appendix c diffusion in two dimensional models and associated lagrangian tracer trajectories this review article deals with lagrangian methods for large scale open ocean applications in oceanography this is why the theoretical developments and the flows dealt with are essentially three dimensional there are however difficulties inherent in one or two dimensional transport models which cannot be regarded as an idealisation or simplification of three dimensional models some aspect thereof are outlined below let h u i i 1 2 and c be functions of the time and horizontal coordinates representing the height of the water column the depth averaged horizontal velocity and the depth averaged concentration of a passive tracer respectively then the continuity equation is 41 t h i h u i 0 and the equation obeyed by the concentration reads e g vanderborght et al 2007 42 t h c i h c u i i h k i j j c where the diffusivity tensor kij is symmetric and positive definite the latter partial differential equation may be transformed into a fokker planck equation in which hc rather than c should be viewed as the unknown 43 t h c i h c u i drift i j k i j h c where the drift velocity is heemink 1990 44 u i drift u i h 1 j h k i j u i i k i j k i j h 1 j h the first two terms on the right hand side of eq 44 are equivalent to those used in three dimensional models whilst the last one is specific to depth integrated models if the last term in 44 is not taken into account in a lagrangian model then particles might tend to concentrate into the shallowest areas which clearly is unphysical and may lead to erroneous conclusions e g spagnol et al 2002 a test case was designed by deleersnijder 2015 that includes an analytical solution for diffusion in a depth varying domain and implemented numerically by thomas et al 2015a this exact solution exhibits a somewhat counter intuitive behaviour with the location of the maximum of the concentration and the tracer patch centre of mass moving in opposite directions somewhat similar developments are made when designing a one dimensional cross section averaged transport model such models are often used to simulate transport processes in elongated domains such as rivers or estuaries e g everbecq et al 2001 hofmann et al 2008 in this case all the variables and parameters depend on time and the along flow coordinate x if s u and c denote the cross sectional area the cross section averaged velocity and the cross section averaged concentration respectively then the one dimensional counterparts to eqs 41 44 are 45a t s x s u 0 45b t s c x s c u x s k x c 45c t s c x s c u drift x x k s c where 46 u drift u s 1 x s k u x k k s 1 x s is the drift velocity and k is the along flow diffusivity in depth and section averaged models the diffusion term is rarely meant to represent turbulent diffusion per se instead it is essentially the effect of shear dispersion e g young and jones 1991 that is to be parameterized i e the impact on the resolved reduced dimension processes of the combined effect of sheared advection and turbulent diffusion in the transversal direction as a consequence the diffusivity coefficients are often significantly larger than those that would be used in a three dimensional model of the same domain 
24139,the sensitivity of antarctic sea ice to increasing glacial freshwater release into the southern ocean is studied in a series of 31 year ocean sea ice iceberg model simulations glaciological estimates of ice shelf melting and iceberg calving are used to better constrain the spatial distribution and magnitude of freshwater forcing around antarctica two scenarios of glacial freshwater forcing have been designed to account for a decadal perturbation in glacial freshwater release to the southern ocean for the first time this perturbation explicitly takes into consideration the spatial distribution of changes in the volume of antarctic ice shelves which is found to be a key component of changes in freshwater release in addition glacial freshwater induced changes in sea ice are compared to typical changes induced by the decadal evolution of atmospheric states our results show that in general the increase in glacial freshwater release increases antarctic sea ice extent but the response is opposite in some regions like the coastal amundsen sea implying that distinct physical mechanisms are involved in the response we also show that changes in freshwater forcing may induce large changes in sea ice thickness explaining about one half of the total change due to the combination of atmospheric and freshwater changes the regional contrasts in our results suggest a need for improving the representation of freshwater sources and their evolution in climate models keywords southern ocean sea ice glacial freshwater 1 introduction the southern ocean plays a substantial role in the earth system for instance it is a significant sink for the anthropogenic carbon dioxide sallée et al 2012 and atmospheric heat roemmich et al 2015 thus mitigating global warming in addition the southern ocean produces the antarctic bottom water aabw which is distributed into the three main oceanic basins atlantic pacific and indian the aabw a key driver of the global thermohaline circulation ventilates the deep ocean due to its high oxygen content mantyla and reid 1983 orsi et al 1999 all these processes are directly impacted by the antarctic sea ice cover its melting and its production some studies have emphasized unexpected trends in antarctic sea ice cover over the last decades e g comiso 2010 while the arctic sea ice extent sie presents a statistically significant decrease of 3 8 per decade the antarctic sie presents a small but statistically significant increase of 1 2 per decade comiso et al 2011 the net increase in antarctic sea ice results from the combination of positive and negative regional trends even if the magnitude and the significance of the total increase remains open to debate polvani and smith 2013 screen 2011 the significance of regional trends in sea ice concentration sic has a larger consensus in the community comiso et al 2011 for instance the ross sea sie has increased by about a 5 per decade while the sie in the amundsen bellingshausen seas sector has decreased by up to 7 per decade turner et al 2009 in addition the trend in number of annual ice covered days exhibits similar regional patterns the southern ocean has gained up to 3 4 days per year of coverage in some locations of the ross sea and has lost up to 3 4 days per year in sectors of the bellingshausen sea stammerjohn et al 2012 while the artic sie response to the climate change is strongly coupled with global atmospheric warming perovich 2011 antarctic sea ice trends seem to result from much more complex processes it has been suggested that observed atmospheric trends in the southern annual mode sam index thompson et al 2011 and the amundsen sea low which affect wind velocities air temperature and humidity may partially explain the observed changes in the antarctic sea ice turner et al 2009 the coupling between sam and the el nino southern oscillation enso may also contribute to the observed regional pattern of the trend stammerjohn et al 2008 kwok et al 2016 however the amplitude of the regional trends and the total increase in sie does not seem to be completely explained by changes of atmospheric origin lefebvre and goosse 2008 in addition other modeling studies have shown that an increased sam trend produced by ozone depletion leads to sea ice reduction in climate models bitz and polvani 2012 sigmond and fyfe 2010 this suggests that other mechanisms must be contributing to the observed trends in sea ice some of the non atmospheric factors affecting the observed sea ice distribution may be related to oceanic and sea ice feedbacks for instance changes in the salt rejection associated with sea ice changes and the freshening of the ocean surface may be affecting oceanic deep heat convection in some regions goosse and zunz 2014 zhang 2007 the observed increase in mass loss from the antarctic ice sheet rignot et al 2011 shepherd et al 2012 may be contributing to salinity changes in the southern ocean jacobs et al 2002 jacobs and giulivi 2010 enhanced continental ice discharge combined with the observed thinning of ice shelves pritchard et al 2012 paolo et al 2015 has increased glacial freshwater injection into the ocean at least since the beginning of the 1990s shepherd et al 2012 this increase in glacial freshwater flux is usually not considered in climate models which may explain why climate models have so far failed to predict trends and regional variability in sie e g turner et al 2013 recent studies have investigated the response of antarctic sea ice to the recent increase in glacial freshwater input to the ocean with a coupled model bintanja et al 2013 swart and fyfe 2013 pauling et al 2016 however they differ in their main conclusions in some cases the impact of perturbations in the glacial freshwater forcing on sea ice is very weak and not significant in other cases the response is relevant but does not match the spatial pattern of the observations this may be due to the lack of consensus over the quantity and spatial distribution of the freshwater perturbation applied in such experiments indeed most ocean models present large differences in their freshwater forcing protocol and neglect the spatial distribution of the sources recent ice shelf mass balance estimates based on satellite data rignot et al 2013 depoorter et al 2013 may help better constrain both the magnitude and the spatial distribution of glacial freshwater released into the southern ocean furthermore recent improvements in the methods to prescribe ice shelf melt mathiot et al 2017 and to distribute the iceberg meltwater through lagrangian models merino et al 2016 marsh et al 2015 now allow a better distribution of the antarctic glacial freshwater over the southern ocean this has been shown to affect sea ice production merino et al 2016 mathiot et al 2017 but as yet it remains neglected by most ocean models in this study we evaluate the impact of the recent enhancement in glacial freshwater fluxes on the sea ice properties in the southern ocean two different freshwater scenarios are proposed to represent the current and pre imbalance ice ocean mass fluxes the scenarios are built upon glaciological estimates of the antarctic ice mass loss and distinguish calving from ice shelf melt both glacial freshwater scenarios are applied to an atmospherically forced eddy permitting ocean sea ice model an improved version of a lagrangian particle iceberg model is coupled with our ocean model in order to distribute the calved mass while ice shelf melt is prescribed following the method proposed by mathiot et al 2017 the sensitivity to changes in glacial freshwater scenario is addressed under the same atmospheric conditions then compared against typical changes induced by decadal atmospheric variability section 2 describes the model set up and the freshwater forcing scenarios section 3 presents the model mean state and trends and section 4 describes the model response to atmosphere and freshwater perturbations and discusses the related mechanisms 2 material and methods 2 1 ocean sea ice model configuration all the numerical experiments performed in this study share the same general model set up simulations use a coupled ocean sea ice iceberg model with interannual atmospheric forcing the ocean component is based on nemov3 5 madec 2014 with a global grid of 0 25 resolution orca025 developed by the drakkar group it considers 75 vertical z levels with partial steps the model is forced by atmospheric data from the interannual dfs5 2 re analysis era interim based dussin et al 2016 brodeau et al 2010 it uses the core bulk formulations with three hourly winds humidity and air temperature and daily cloud cover short and long wave solar radiation and liquid and solid precipitations the ocean component is coupled every time step with the lim2 sea ice model fichefet and morales maqueda 1997 a salinity restoring term towards nodc woa data gouretski and koltermann 2004 with a piston velocity of 50 m 300 days applied to the ocean surface griffies et al 2009 this term is required in atmospherically forced simulations because of the missing atmospheric feedbacks griffies et al 2009 the ocean component is also coupled with the nemo icb lagrangian iceberg module marsh et al 2015 containing the most recent improvements described in merino et al 2016 these latter modifications consider depth dependent ocean velocities and temperatures in the computation of the drag and melt rate applied to icebergs instead of ocean surface properties as in most iceberg models so far all the meltwater from icebergs is put at the ocean surface i e assuming no significant mixing with the iceberg freshwater plume our model configuration does not include ice shelf cavities but adopts the parameterization developed by mathiot et al 2017 to distribute the observation based ice shelf meltwater from antarctica the later emulates the buoyancy driven ice shelf overturning by distributing the coastal runoff over the vertical model levels located between the depth of the ice shelf front and the deepest depth of the glacier grounding line or the bathymetry at the front if shallower than the grounding line mathiot et al 2017 have shown that this method outperforms those in which the ice shelf freshwater is injected at the depth of the ice shelf front e g beckmann and goosse 2003 the prescribed amplitude of iceberg calving and ice shelf melt is described in the next subsection ocean temperature and salinity are initialized from the observational estimates from steele et al 2001 and antarctic sea ice is initialized to 1 m thick wherever ocean surface is below 1 c all the experiments conducted in this study use a 11 year spin up phase which is reasonable for initializing major circulation features and surface properties barnier et al 2006 tréguier et al 2010 and to balance the iceberg mass and melt water from the iceberg module merino et al 2016 after the 11 year spin up the drift in acc transport at drake is 0 2 sv yr exactly as in tréguier et al 2010 who used a very similar nemo configuration and attributed the drift to an erosion of aabw along the simulations it is therefore likely that dense water formation and or its downward transport are poorly represented in our model nonetheless no significant drift of surface fluxes is found after the spin up phase not shown and our methodology prevents our results from being affected by any potential drift because we mostly compare experiments of similar drifts see section 2 3 2 2 freshwater forcing in the southern ocean this section explains how our freshwater forcing is constructed and how our experiments are designed to address the main question of this study in the southern ocean the glacial freshwater fluxes come from melting icebergs and ice shelves the floating extension of outlet glaciers confined in an embayment in the following we present the terms of the ice shelf mass balance section 2 2 1 the recent observational estimates of calving flux and ice shelf melt used to build our mean freshwater forcing over the 2000 2009 period section 2 2 2 and the method developed to reconstruct the mean calving flux and ice shelf melt over the 1990 1999 period section 2 2 3 in the southern ocean glacial freshwater fluxes come from the melting of ice originating from the antarctic ice sheet as we will see in section 2 2 1 and as already conceptually introduced by rye et al 2014 and pauling et al 2016 the amount of glacial freshwater getting into the ocean is strongly affected by changes in the mass of ice shelves the glacial freshwater fluxes can be estimated for the major ice shelves over the 2000 2009 period based on observational studies and accounting for the changing mass of ice shelves section 2 2 2 a number of hypotheses then allow constraining a glacial freshwater scenario representative of the 1990s as described in section 2 2 3 to date no reliable information can be considered for the reconstruction of time varying glacial freshwater fluxes between the two periods so we will run sensitivity experiments in which we apply the two freshwater fluxes with constant fluxes over the entire simulations see section 2 3 such experimental design is similar to bintanja et al 2013 2015 and pauling et al 2016 the analysis of the mean anomalies provides information on the impact of freshwater on the antarctic sea ice prescribing a ramping versus constant freshwater flux may affect the estimation of sea ice trends within a simulation but comparing the mean sea ice between two simulations with constant freshwater forcing does not require any assumption on the ramping shape 2 2 1 the ice shelf mass balance equation the freshwater flux into the southern ocean can come from three continental sources icebergs melting along their trajectories basal melt underneath ice shelves and runoff from surface melting the later is mostly confined to a few regions in the northern antarctic peninsula barrand et al 2013 van den broeke 2005 although it can sporadically be observed in other regions e g nicolas et al 2017 bell et al 2017 furthermore most of the surface melt water refreezes before reaching the ocean irvine fynn et al 2011 therefore the freshwater flux from surface melting is usually neglected compared to the freshwater flux associated with the calving flux cf and the ice shelf basal mass balance bmb to understand these two prominent freshwater fluxes one needs to consider the mass balance of an ice shelf a schematic view of an antarctic ice shelf is shown in fig 1 which describes the main mass fluxes ocean currents and other terms that are used throughout this paper antarctic ice shelves gain mass from the ice inflow through the grounding line gate imaginary surface between the floating and grounded ice and due to snowfall at their surface their mass loss occurs through several processes calving at their front basal melt at the ocean ice interface and wind erosion or sublimation at their surface from the ice shelf point of view the two fluxes of interest for the ocean i e cf and bmb are partly compensated by the surface mass balance smb which includes snow accumulation surface melting refreezing sublimation snow erosion and transport by the wind and the grounding line flux glf the difference between the inputs glf smb and outputs cf bmb results in the mean thickening rate dh dt or ice shelf mass convergence the mass conservation is thus described by the following equation rignot et al 2013 depoorter et al 2013 1 d h d t smb glf cf bmb in the following paragraphs we describe the two different glacial freshwater scenarios applied to our ocean simulations basically our approach consists of determining a pair of cf and bmb values for i a scenario corresponding to the mass exchange between the antarctic ice shelves and the ocean in the 2000s fresh and ii a scenario representative of the situation in the early 1990s fresh this latter scenario built from fresh is based on assumptions on the various terms of the ice shelf mass balance eq 1 and computed for each ice shelf larger than 100 km2 details on the construction of both scenarios fresh and fresh are given in sections 2 2 2 and 2 2 3 respectively and a summary of the two glacial freshwater scenarios with all the terms of eq 1 is presented in fig 2 a detailed comparison of the bmbs corresponding to the two glacial freshwater scenario is shown in fig 3 for each individual ice shelf 2 2 2 scenario fresh scenario fresh represents the antarctica southern ocean freshwater exchanges of the decade 2000 2009 we therefore directly use the cf and bmb fluxes provided by depoorter et al 2013 these estimates are based on data from the icesat period 2003 2009 and previous satellite programs including ers 1 and ers 2 covering a large part of the 1990 1999 decade in many regions the scenario accounts for ice shelf thinning rates that are consistent with the observed enhancement of antarctic mass discharge in depoorter et al 2013 all the sparse collected data were corrected in time to get estimates representative of the decade 2000 2009 this means that their estimates provide a reasonable representation of the annual glacial freshwater fluxes that were released into the southern ocean over that decade and are consistent with other recent estimates over the same period rignot et al 2013 all the ice shelf locations considered in depoorter et al 2013 have been identified on our orca025 model grid following merino et al 2016 for a given ice shelf the bmb flux is homogeneously distributed over all grid points along the corresponding ice shelf front and distributed vertically according to the ice shelf geometry as described in section 2 1 in addition depoorter et al 2013 provide an upscaling mass flux term per oceanic basin so that the total estimated antarctic mass loss can be matched the latter is homogeneously distributed over the coastal surface grid points of the corresponding oceanic basin our forcing strategy does not consider any seasonal variations in bmb because very little is known about such seasonality the cf estimates are used as inputs for the lagrangian iceberg model cf values are kept constant over time with the same calving rates and locations as provided in merino et al 2016 the ocean iceberg model distributes the iceberg meltwater over the southern ocean with seasonal variations related to the ocean properties merino et al 2016 2 2 3 scenario fresh the fresh scenario is designed to represent a reasonable glacial freshwater input into the ocean before the observed antarctic mass imbalance in the early 1990s rignot et al 2011 shepherd et al 2012 the recent acceleration of grounded outlet glaciers is linked to the thinning of ice shelves as a consequence of the enhancement of their basal melting pritchard et al 2012 or collapse scambos et al 2004 our hypothesis is that the antarctic ice shelves were in steady state in the early 1990s d h d t 0 this assumption may not be entirely true at the regional scale as it is known that some glaciers in the amundsen sector were already retreating early in the 80s hughes 1981 smith et al 2016 and the ross sea was already experiencing freshening in the early 1990s jacobs and giulivi 2010 it is nonetheless a good approximation at the scale of antarctica paolo et al 2015 and making other assumptions regionally is not straightforward this assumption may nonetheless result in an overestimation of the glacial freshwater differences between the scenario fresh and fresh in the amundsen sector to construct the fresh scenario we start from the estimates provided by depoorter et al 2013 in addition to setting dh dt to zero further hypotheses regarding smb cf and glf are needed to compute bmb from eq 1 the smb values in depoorter et al 2013 are from a regional atmospheric simulation over 1979 2010 assuming that there has been no significant smb trend over that period monaghan et al 2006 lenaerts et al 2012 we therefore keep the same smb values as in depoorter et al 2013 as they are also representative of the 1990s we make a similar assumption for the cf term because to our knowledge there is no evidence of any trend in calving fluxes of course individual events of ice shelf collapse may introduce interannual variability in cf rott et al 1996 but it would be difficult to associate a statistically significant trend to these events liu et al 2015 it has to be noted that some observed changes in ice shelf velocities are compensated by changes in ice shelf thickness so that the ice mass flow is relatively unchanged which is consistent with the small changes in the position of calving fronts observed over the recent decades now we estimate glf in the early 1990s so that we can deduce bmb from eq 1 to do so we use estimates of antarctic contributions to sea level rise i e of mass loss of the grounded ice sheet since the beginning of the 1990s the mass equation for the grounded part is 2 d m d t smb gr glf where m is the mass of grounded ice glf the grounded line flux and smbgr the surface mass balance of the grounded part of glaciers for some glaciers in west antarctica in the antarctic peninsula like larsen ice shelves and in the east indian sector of east antarctica totten and cook the grounded ice mass loss has been explained by changes in ice dynamics rignot et al 2008 2002 for these glaciers we can therefore express glf in the early 1990s as 3 glf 1990 s glf 2000 s d m d t 1990 s d m d t 2000 s where each quantity is an average over the period in subscript we now assume that the ice sheet was approximately in steady state in the early 1990s so that the second term in the right hand side of eq 3 is neglected we then assume that the third term in the right hand side of eq 3 is given by the observational estimates of shepherd et al 2012 as glf2000s is known from depoorter et al 2013 we can deduce glf1990s for the other glaciers no dynamical changes have been reported and mass changes between the 1990s and the 2000s have been attributed to regional changes in surface mass balance smbgr in these cases it is reasonable to assume that glf has remained unchanged between the 1990s and the 2000s our backward estimation of glf is based on two major assumptions first we assume that antarctica was in steady state in the early 1990s the validity of this assumption is uncertain for example shepherd et al 2012 suggest that the antarctic ice sheet was gaining mass in the early 1990s which would mean that the perturbation introduced between fresh and fresh is globally underestimated although the rate of mass change in the early 1990s is likely negligible compared to the perturbation we introduce second we assume that the rates of mass change provided by shepherd et al 2012 are representative of the 2000s while they actually represent the period 1992 2011 this may again imply an underestimation of the glf differences between the fresh and fresh scenarios since many drainage basins have experienced a strong mass loss acceleration over the recent decades particularly in the amundsen sector rignot et al 2011 sutterley et al 2014 our methodology to construct freshwater scenarios is new in the sense that previous studies analyzing the impact of glacial freshwater perturbations on the southern ocean sea ice were based on empirical perturbations pauling et al 2016 or on sea level rise estimates bintanja et al 2013 swart and fyfe 2013 as pointed out by rye et al 2014 these commonly used approaches neglect ice shelf thinning or thickening and do not make any difference between mass changes of dynamical origin and those originating from changes in the surface mass balance the ice shelves are the antarctic glacial freshwater exchangers with the ocean and therefore the construction of glacial freshwater scenarios should always consider the ice shelves processes and their mass balance equation 2 3 model experiments three model experiments are performed to study the sensitivity of the model to different forcing perturbations fig 4 the three runs use the model set up described in section 2 1 and cover 31 years including 11 years of spin up that are not analyzed in the following the three experiments consider a constant glacial freshwater forcing over the full experiment period because the timing of the changes in freshwater fluxes is poorly known in terms of timing of the freshwater release our experimental design is thus similar to bintanja et al 2013 2015 and pauling et al 2016 swart and fyfe 2013 and pauling et al 2017 used a different method considering melt rates that vary linearly in time however observational studies suggest that mass changes have occurred at an accelerated rather than constant rate with distinctive regional patterns of acceleration rignot et al 2011 sutterley et al 2014 so we have preferred not to make any assumption on the freshwater trend prescribing a ramping versus constant freshwater flux may affect the estimation of sea ice trends within a simulation pauling et al 2017 but here we compare the mean sea ice cover between two simulations with constant freshwater forcing rather than directly comparing the trends our methodology therefore does not rely on any assumption on the detailed timing of the freshwater release and the difference between the two simulations with different freshwater scenarios does represent the typical increase in freshwater release over the recent decades we further note that comparing perturbed mean states rather than trends is also a way to remove the influence of model drifts the control run hereafter the fw experiment simulates the period 1979 2009 with the freshwater scenario fresh described in section 2 2 2 the fw simulation considers the same period 1979 2009 as the fw run but with the freshwater scenario fresh finally the atm run combines the application of the perturbed scenario fresh and an atmospheric forcing period starting and finishing 10 years earlier than the other runs thus covering the period 1969 1999 this 10 year lag in the atmospheric forcing is equivalent to the approximative 10 year lag in the freshwater perturbation fw minus fw it should be noted that 10 of the 11 years of spin up in the atm experiment use atmospheric forcing before the satellite era dfs5 based on the era 40 reanalysis prior to 1979 however all our results are computed after the spin up period i e when the atmospheric forcing is constrained by satellite data importantly the impact of the different spin up between atm and the rest of experiments over 1990 1999 is small compared to the sensitivity reported in this paper not shown fig 5 shows the mean atmospheric perturbations introduced between the fw and atm simulations dfs5 2 tends to be dryer over the recent decades with two exceptions in the region between the ross and amundsen seas and in the western weddell sea over the recent decades air temperature tends to be warmer in the amundsen and bellingshaussen seas the indian sector and the northern weddell sea but it tends to be markedly colder by up to 1 5 c north of the ross sea and in the coastal weddell sea and west pacific sector winds are stronger in the atlantic and west indian sectors and in some coastal regions of the ross and pacific sectors and weaker from the western coast of the peninsula to the amundsen sea a schematic diagram of the three experiments is shown in fig 4 the comparison between fw and fw provides an estimate of the model response to our perturbation in glacial freshwater forcing although there remain large uncertainties this perturbation is a reasonable estimate of the typical decadal change in the freshwater released by the antarctic continent into the ocean in the results and discussion sections the fw minus fw comparison will therefore be referred to as freshwater induced changes the fw versus atm comparison provides an estimate of the impact of the recent decadal atmospheric changes present in the era interim reanalysis this comparison will therefore be referred to as atmospheric induced changes finally the fw minus atm comparison accounts for both the perturbation in the glacial freshwater flux and in the decadal atmospheric forcing this comparison indicates the typical decadal change in the southern ocean as fresh represents the 2000s and fresh the early 1990s hereafter it will be referred to as total changes 3 evaluation of the simulations this section evaluates the ability of the model to represent the ocean and sea ice mean states and sea ice variability the simulated climatological sea ice concentration sic is compared to the nsidc sic in fig 6 overall the model set up is able to reproduce the main spatial distribution with a sic of similar magnitude as in the observations in both summer and winter the model nonetheless has a deficit of sea ice in summer with less concentrated sea ice in the west pacific and the amundsen sectors and a smaller extent of permanent sea ice in the weddell sea than in the observations this summer deficit is typical of orca025 simulations and was also found in most ocean sea ice models forced by another atmospheric reanalysis downes et al 2015 the model also produces too much sea ice over the winter months exhibiting a more concentrated ice pack at the sea ice margins as in other nemo simulations presented in downes et al 2015 the reason for such biases is still a matter of research fig 7 a and b show the sea ice trends computed from experiments fw and fw respectively both simulations present a very similar trend in sic because they are forced by the same atmosphere the simulations reproduce reasonably well the main observed patterns in sic trends fig 7 c i e the positive trend offshore of dronning maud land and in the northern ross sea are well reproduced as well as the negative trends on the western flank of the peninsula nonetheless the model does not reproduce the observed sea ice trends along the ice sheet margins in the pacific sector and in prydz bay it should be noted that holland et al 2014 also managed to reasonably reproduce the observed trends in atmospherically forced ocean hindcasts with regional biases of similar magnitude as in our study for the reasons mentioned in section 2 3 we apply constant rather than ramping freshwater fluxes therefore the effect of different freshwater fluxes between the early 1990s and the 2000s is not seen in the trend of individual simulations but rather in comparisons of simulations with different freshwater fluxes the total decadal sic change fw over 1990 2009 vs atm over 1980 1999 is therefore compared to observations 1990 2009 vs 1980 1999 in fig 8 it should be noted that this decadal difference gives slightly different results compared to linear trends in particular in the weddel and amundsen seas fig 7 c vs fig 8 b again the main patterns of the total decadal sic change are reasonably well reproduced by our simulations fig 8 there are nonetheless significant differences offshore in the amundsen and bellingshausen seas by contrast to the offshore sea ice pack the trends in these regions are well reproduced near the ice sheet margins further investigations indicate that the offshore bias is particularly affected by differences in the spin up between the atm and fw experiments and the positive offshore trend is actually attributed to a spurious signal inherited from the spin up not shown these offshore trends are therefore not analyzed in the following finally we have also made other comparisons to observational estimates that we briefly mention here the patterns and amplitude of the simulated eddy kinetic energy eke was found to be in good agreement with the eke derived from aviso see fig 2 in dinniman et al 2015 not shown the simulated barotropic transport through the drake passage remains within the observed range of 134 11 sv cunningham et al 2003 all along the simulation despite the drift of 0 2 sv yr mentioned in section 2 1 not shown 4 role of the atmospheric and freshwater perturbations on the sea ice decadal changes to analyse and discuss our results we define three regional sectors of analysis in the ross sea the coastal amundsen sea and west pacific east indian sector see fig 8 a these sectors are chosen because they are significantly affected by changes in freshwater fluxes because they are better able to reproduce the observational sic changes than other locations and because each of these boxes is affected by changes in freshwater fluxes through a specific mechanism 4 1 mean sea ice response over the whole southern ocean here we simply describe the general sea ice response to the atmospheric and freshwater perturbations the specific response of individual sectors and the corresponding mechanisms are described in the next sub sections qualitatively the total modeled changes in sic due to both atmosphere and freshwater changes are globally dominated by the atmospheric perturbation especially in the atlantic and west indian sectors where the freshwater perturbation barely affects the sic fig 9 there are nonetheless other sectors where the freshwater perturbation significantly contributes to the total changes such as in the ross amundsen sea and west pacific sectors the quantitative comparison between fw and atm indicates a total change in sea ice extent sie of about 3 0 for the whole southern ocean and the freshwater induced change accounts for about 25 of this total change calculated as the ratio between the freshwater induced signal and the total signal the freshwater induced changes in sea ice thickness sit are relatively more important than the corresponding changes in sic the sit response is again negligible in the atlantic and west indian sectors but is relatively strong in the other sectors fig 10 the total annual change in integrated sea ice volume siv over the whole southern ocean is an increase of 2 8 of which 46 is induced by the perturbation in glacial freshwater fluxes in terms of seasonality the sie response is dominated by the atmospheric changes during the ice covered months i e from march to october while it is dominated by the freshwater changes during the melting months i e from december to february fig 11 a the seasonal response of siv is similar in timing but the relative difference between the atmosphere induced and the freshwater induced parts is smaller than for the sic fig 11 b the timing of sea ice minima and maxima table 1 and the ice season duration isd as defined in stammerjohn et al 2008 are much more affected by the atmospheric perturbation than by the freshwater perturbation the total isd change fig 12 is in good agreement with the isd trend observed over 19792011 stammerjohn et al 2012 even though the magnitude of the observed trend is slightly larger than in our simulations this may be related to the fact that our model experiments ocean forced simulations do not account for coupled processes between the ocean surface and the atmosphere which would arguably amplify the impact of the freshwater induced changes on sea ice because the signal would not be damped by surface salinity restoring 4 2 sea ice response in the west pacific east indian sector in the west pacific east indian sector the sie increases by 5 in response to the total perturbation and 52 of this increase is induced by the freshwater perturbation the siv increases by 10 in response to the total perturbation and 61 of this increase is induced by the freshwater perturbation regarding the seasonality both the freshwater and atmospheric perturbations contribute to increase the sea ice extent and volume over most of the year the relative importance of the two perturbations varies between sie and siv but the freshwater perturbation has a stronger relative importance in late summer and spring from august to november while the freshwater has only a weak influence on the phase of the seasonal cycle the atmosphere perturbation advances the maximum by 10 days delays the minimum by 3 days on average table 1 and increases the sid fig 12 the atmosphere induced sea ice changes in this sector were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven thermodynamical changes we therefore focus more on the mechanisms explaining the freshwater induced changes the freshening of the ocean surface may increase density differences between ocean surface and sub surface water masses this leads to a reinforcement of the density stratification between the ocean surface and subsurface separated by the pycnocline affecting the convection regime and therefore the heat supply from the deeper and warmer ocean to the ocean surface this process suggested by marsland and wolff 2001 may affect thermodynamical sea ice formation resulting in more sea ice in presence of ocean surface freshening a comparison of fig 13 a and b indeed suggests that the freshwater induced increase in sea ice production along the coast is mostly explained by changes in oceanic heat flux at the sea ice base this extra sea ice produced along the coast is then advected offshore explaining the positive freshwater induced sea ice anomaly all over this sector fig 9b 4 3 sea ice response in the ross sea in the ross sector the sie increases by 1 4 in response to the total perturbation and 35 of this increase is induced by the freshwater perturbation as much as 80 of the total increase in siv is induced by the freshwater perturbation regarding the seasonality the freshwater induced thickening compensates for the atmosphere induced thinning in summer december and january in spring and early summer both the atmosphere and freshwater perturbations tend to favor the sea ice extension and thickening with a dominant impact of the atmosphere on the sie but impacts of comparable magnitude for the siv while the freshwater has only a weak influence on the phase of the seasonal cycle the atmosphere perturbation advances the maximum by 15 days on average table 1 and increases the sid fig 12 as in the west pacific east indian sector the atmosphere induced sea ice changes in the ross sea were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven thermodynamical changes and here we focus on the mechanisms explaining the freshwater induced changes a similar mechanism as in the west pacific east indian sector can explain the sea ice response to the freshwater perturbation as shown in fig 13 b the ross sea presents an increase in thermodynamical sea ice production at the coast where the ocean surface is much fresher fig 14 b the freshwater perturbation results in a siv increase of 8 1 1010 m3 during the sea ice production months from march to september the extra siv produced in the fw simulation compared with the fw simulation is found mostly along the coast and is advected resulting in increased sic fig 8 and sit fig 10 this northward export of sea ice in the ross sector is further supported by a strengthened antarctic coastal current acoc which is visible in fig 14 a as a freshwater induced rise in sea surface height in good agreement with rye et al 2014 the stronger acoc contributes to the freshwater induced changes in sea ice divergence in this sector these changes represent a mean siv loss of 1 7 1010 m3 per year which is relatively weak compared with the changes of thermodynamical origin in this sector as shown in table 1 the siv differences in minima between the fw and fw simulations are not significant compared with the siv differences in maxima given the extra siv produced by fw there is an excess of sea ice that needs to be melted during the spring and summer months if both simulations are to show relatively similar sea ice minima according to table 1 the sea ice minimum obtained in the sector does not seem to be much affected by the freshwater or atmospheric perturbations introduced in our experiments however in the fw simulation the melting of sea ice is amplified by summer freshwater induced changes in the oceanic heat reaching the sea ice base see fig 15 a in contrast to the annual means fig 13 a the oceanic heat supplied to the sea ice base in summer is slightly greater in the fw simulation than in the fw simulation represented by lower heat in sea ice formation equivalent in fig 15 a this may be related to a sea ice feedback which helps compensate for the extra sea ice volume produced in winter when the sea ice retreats in late spring the thicker sea ice produced in fw results in colder summer sst as shown in fig 15 b the colder and denser sea surface affects buoyancy and therefore reduces the density stratification under these specific conditions the oceanic heat convection in summer is facilitated in the sector as shown in fig 15 a however this extra oceanic heat is not able to entirely explain the extra sea ice melting in the ross sector obtained in the fw simulation 4 4 sea ice response in the coastal amundsen sea the sea ice response in the amundsen sea is different from the other regions with decreased sie and siv in response to the atmosphere and freshwater changes the sie indeed decreases by 2 7 in response to the total perturbation and 37 of this decrease is induced by the freshwater perturbation the siv decreases by 8 1 in response to the total perturbation and 40 of this decrease is induced by the freshwater perturbation in this sector the atmospheric perturbations dominate the sie response over most of the year and both the atmosphere and the freshwater perturbations play a stronger role in the summer months fig 11 in early fall the atmosphere induced increase in sea ice cover is partly inhibited by the freshwater perturbation fig 11 regarding the phase of the seasonal cycle the freshwater perturbation advances the sea ice minimum by 6 days while the atmosphere perturbation delays it by 9 days on average table 1 unlike the two regions analyzed above the sid in the coastal amundsen sea is decreased by the total perturbation fig 12 the atmosphere induced sea ice changes in the amundsen sea were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven dynamical changes vs thermodynamical in the two previous sectors so we focus more on the mechanisms explaining the freshwater induced changes in the coastal amundsen sea the extra freshwater perturbation tends to increase the oceanic heat flux at the sea ice base fig 13 a this result explains the modeled decrease in sic and sit shown in figs 8 and 10 respectively amundsen is the region of the antarctic coast where the most rapid warming has been observed schmidtko et al 2014 this is due to a number of factors that include atmospheric features the proximity of the region to the warm antarctic circumpolar current acc and topographic features resulting in warm water intrusion into sub surface waters walker et al 2007 jacobs et al 2011 thoma et al 2008 turner et al 2017 in particular observations have indicated intrusions of circumpolar deep water cdw into ice shelf cavities with temperatures of more than 3 c above the freezing point this may be causing strong grounded ice mass loss in the antarctic basins in the sector shepherd et al 2012 due to considerable ice shelf thinning pritchard et al 2012 these observations have been considered in our glacial freshwater scenario reconstruction section 2 2 and make the amundsen sea the region with the largest glacial freshwater forcing perturbation in our experimental set up fig 3 as shown by mathiot et al 2017 and explained in section 2 1 the way glacial freshwater is added into our ocean model is designed to emulate the ice shelf cavity recirculation it is generated by the buoyancy fluxes introduced when distributing the ice shelf freshwater flux along the vertical of the ocean model grid points adjacent to the ice shelf therefore the inclusion of more glacial freshwater strengthens coastal overturning which may result in a stronger heat transport from deep layers to the surface the special conditions found in the amundsen sector i e very warm sub surface water combined with the strongest glacial freshwater perturbation would seem to explain the freshwater induced anomaly in the oceanic heat flux reaching the ocean surface fig 13 a indeed as shown in fig 16 the extra freshwater introduced in the fw simulation affects the coastal stratification and promotes vertical heat transport this leads to sub surface cooling and surface warming in the model as also found by jourdain et al 2017 who explicitly modeled the ice shelf cavities of the amundsen sea in the other sectors like the ross or bellingshausen seas this feature is not dominant in our simulations compared with the impact of surface freshening on sub surface heat convection associated with the mechanism described in marsland and wolff 2001 this warming feature of the amundsen sea sector is consistent with observations jenkins 1999 it has been suggested that an increase in ice shelf melting at the grounding line depth may enhance ice shelf cavity overturning hellmer and olbers 1989 due to buoyancy changes in the interior of the ice shelf cavity as reproduced in our experiments however the magnitude of an associated heat transfer between sub surface and surface water masses is still unclear the inclusion of ice shelf cavities in the ocean model should be considered at least for this sector in order to properly quantify the impact of ice shelf basal melt on the very specific conditions of the amundsen sea sector 5 conclusions the sea ice response to recent changes in antarctic glacial freshwater release into the southern ocean has been investigated with a set of eddy permitting ocean sea ice iceberg model experiments the freshwater induced changes in the global and regional sea ice and ocean properties have been compared with typical atmosphere induced changes and observations our model experiments consist of a control run and two perturbed simulations the control run takes into account a recent glaciological estimate of the magnitude and spatial distribution of iceberg calving fluxes and ice shelf basal melt fluxes the perturbed simulations consider a decadal shift of the atmospheric variables and our own estimate of the pre antarctic imbalance glacial freshwater released into the ocean for the first time the perturbed freshwater scenario takes into account the regional pattern of the recent ice shelf thinning and the dynamical mass change in the grounded antarctic basins it is based entirely on glaciological mass budgets and represents an improvement with respect to previous studies investigating the impact of recent glacial freshwater trends on ocean properties our results show that the freshwater induced changes in sea ice extent sie may overall potentially contribute 25 of the total trend in sie however the regional changes in sie differ markedly with freshwater accounting for 37 of the total decrease in sie in the amundsen sea sector but for 52 of the total increase in sie in the west pacific sector perturbations in freshwater forcing produce a much greater impact on sea ice thickness and therefore on sea ice volume siv for the entire southern ocean the freshwater induced changes in siv represent almost 50 of total modeled changes and are dominant with respect to the atmosphere induced changes in the ross and west pacific sectors in the amundsen sector the increased release of freshwater from the ice shelves results in an enhancement of coastal overturning as supported by regional simulations with an explicit representation of ice shelf cavities jourdain et al 2017 this leads to an increase in the oceanic heat supplied by the very warm sub surface water mass to the ocean surface near the ice sheet margin the freshwater induced changes in siv and sie during the sea ice production months are shown to have only a slight effect on the maximum of the global siv seasonality but with important implications for the ice season duration isd in the ross and west pacific sectors these changes are mostly produced by freshwater induced changes in the oceanic heat convection related to ocean surface freshening changes in the oceanic heat reaching the sea ice base are shown to produce significant thermodynamical changes in sea ice production in addition the freshening of the ocean surface results in a strengthening of the antarctic coastal current acoc which may induce changes in sea ice divergence however such changes remain relatively weak compared with the freshwater induced thermodynamical changes in sea ice production two aspects of our methodology likely lead to an underestimation of the model response to the glacial freshwater perturbation first the assumptions made to reconstruct the freshwater fluxes in the early 1990s are based on rates of ice sheet mass loss estimated over 1992 2011 section 2 2 3 accounting for the mass loss acceleration over the most recent period would have led to a stronger difference between the two freshwater scenarios second the surface salinity restoring applied to our simulations section 2 1 compensates a part of the perturbations in glacial freshwater fluxes the total surface salinity restoring south of 55 s is equivalent to a freshwater flux that is 300 gt yr larger in fw than in fw this means that over the southern ocean restoring compensates 85 of the freshwater perturbation however a large part of this compensation occurs far from the coast once the freshwater has been advected away for example the freshwater flux associated with salinity restoring in the coastal amundsen sector is only 7 gt yr larger in fw than in fw for a perturbation in basal mass balance of 192 gt yr for the ice shelves of this sector in the ross sector restoring is more important accounting for a freshwater difference of 64 gt yr between fw and fw this compensates both the extra freshwater by the ice shelves of the ross sector 5 gt yr and the advection of a significant part of the 192 gt yr from the amundsen sea nakayama et al 2014 in the west pacific east indian sector surface salinity restoring compensates 34 gt yr of the 55 gt yr perturbation in summary surface salinity restoring unlikely affects our estimates of sea ice sensitivity in the coastal amundsen sea but it probably leads to underestimate the impacts of changing glacial freshwater fluxes on sea ice properties in the ross and west pacific east indian sectors most of the changes in glacial freshwater fluxes are believed to occur in the pacific sector especially in the amundsen sector in view of the strong regional contrasts in sea ice sensitivity and associated mechanisms we suggest that the freshwater perturbations applied to ocean models should account for these regional changes instead of uniformly spreading a perturbation around the antarctic continent in addition the recently observed ice shelf imbalance pritchard et al 2012 paolo et al 2015 is by no means negligible compared to the imbalance of the antarctic grounded ice sheet consequently the mass loss of both the floating and the grounded parts need to be taken into account this was not done in previous studies which may explain a part of the differences between our results and those from similar work showing freshwater induced changes in the atlantic and east indian sectors bintanja et al 2013 or showing a very limited response of sea ice to glacial freshwater perturbations pauling et al 2016 swart and fyfe 2013 there are nonetheless other differences for example we use an eddy permitting resolution while the aforementioned studies used models of coarser resolution and we use an ocean only model with salinity restoring while the other studies were based on earth system models no surface salinity restoring finally while our wind and freshwater perturbations represent a typical decadal change from the early 1990s to the early 2000s chosen based on available satellite data we acknowledge that analysing a more recent period could lead to different results the model version customizations and parameters used to run the three experiments presented in this paper are provided on http doi org 10 5281 zenodo 1067648 the output and forcing data are available on request acknowledgments we would like to thank jean marc molines for his invaluable help with model configuration the study was partially funded by the french national research agency anr under the sumer blanc simi 6 2012 project anr 12 bs06 0018 and the trois as project anr 15 ce01 0005 01 nm jls gd and nj are part of labex osug 2020 anr10 labx56 nj is an associate investigator of the arc centre of excellence for climate system science numerical simulations were performed on idris supercomputers saclay france we thank three anonymous reviewers and editor stephen griffies for their useful comments and suggestions 
24139,the sensitivity of antarctic sea ice to increasing glacial freshwater release into the southern ocean is studied in a series of 31 year ocean sea ice iceberg model simulations glaciological estimates of ice shelf melting and iceberg calving are used to better constrain the spatial distribution and magnitude of freshwater forcing around antarctica two scenarios of glacial freshwater forcing have been designed to account for a decadal perturbation in glacial freshwater release to the southern ocean for the first time this perturbation explicitly takes into consideration the spatial distribution of changes in the volume of antarctic ice shelves which is found to be a key component of changes in freshwater release in addition glacial freshwater induced changes in sea ice are compared to typical changes induced by the decadal evolution of atmospheric states our results show that in general the increase in glacial freshwater release increases antarctic sea ice extent but the response is opposite in some regions like the coastal amundsen sea implying that distinct physical mechanisms are involved in the response we also show that changes in freshwater forcing may induce large changes in sea ice thickness explaining about one half of the total change due to the combination of atmospheric and freshwater changes the regional contrasts in our results suggest a need for improving the representation of freshwater sources and their evolution in climate models keywords southern ocean sea ice glacial freshwater 1 introduction the southern ocean plays a substantial role in the earth system for instance it is a significant sink for the anthropogenic carbon dioxide sallée et al 2012 and atmospheric heat roemmich et al 2015 thus mitigating global warming in addition the southern ocean produces the antarctic bottom water aabw which is distributed into the three main oceanic basins atlantic pacific and indian the aabw a key driver of the global thermohaline circulation ventilates the deep ocean due to its high oxygen content mantyla and reid 1983 orsi et al 1999 all these processes are directly impacted by the antarctic sea ice cover its melting and its production some studies have emphasized unexpected trends in antarctic sea ice cover over the last decades e g comiso 2010 while the arctic sea ice extent sie presents a statistically significant decrease of 3 8 per decade the antarctic sie presents a small but statistically significant increase of 1 2 per decade comiso et al 2011 the net increase in antarctic sea ice results from the combination of positive and negative regional trends even if the magnitude and the significance of the total increase remains open to debate polvani and smith 2013 screen 2011 the significance of regional trends in sea ice concentration sic has a larger consensus in the community comiso et al 2011 for instance the ross sea sie has increased by about a 5 per decade while the sie in the amundsen bellingshausen seas sector has decreased by up to 7 per decade turner et al 2009 in addition the trend in number of annual ice covered days exhibits similar regional patterns the southern ocean has gained up to 3 4 days per year of coverage in some locations of the ross sea and has lost up to 3 4 days per year in sectors of the bellingshausen sea stammerjohn et al 2012 while the artic sie response to the climate change is strongly coupled with global atmospheric warming perovich 2011 antarctic sea ice trends seem to result from much more complex processes it has been suggested that observed atmospheric trends in the southern annual mode sam index thompson et al 2011 and the amundsen sea low which affect wind velocities air temperature and humidity may partially explain the observed changes in the antarctic sea ice turner et al 2009 the coupling between sam and the el nino southern oscillation enso may also contribute to the observed regional pattern of the trend stammerjohn et al 2008 kwok et al 2016 however the amplitude of the regional trends and the total increase in sie does not seem to be completely explained by changes of atmospheric origin lefebvre and goosse 2008 in addition other modeling studies have shown that an increased sam trend produced by ozone depletion leads to sea ice reduction in climate models bitz and polvani 2012 sigmond and fyfe 2010 this suggests that other mechanisms must be contributing to the observed trends in sea ice some of the non atmospheric factors affecting the observed sea ice distribution may be related to oceanic and sea ice feedbacks for instance changes in the salt rejection associated with sea ice changes and the freshening of the ocean surface may be affecting oceanic deep heat convection in some regions goosse and zunz 2014 zhang 2007 the observed increase in mass loss from the antarctic ice sheet rignot et al 2011 shepherd et al 2012 may be contributing to salinity changes in the southern ocean jacobs et al 2002 jacobs and giulivi 2010 enhanced continental ice discharge combined with the observed thinning of ice shelves pritchard et al 2012 paolo et al 2015 has increased glacial freshwater injection into the ocean at least since the beginning of the 1990s shepherd et al 2012 this increase in glacial freshwater flux is usually not considered in climate models which may explain why climate models have so far failed to predict trends and regional variability in sie e g turner et al 2013 recent studies have investigated the response of antarctic sea ice to the recent increase in glacial freshwater input to the ocean with a coupled model bintanja et al 2013 swart and fyfe 2013 pauling et al 2016 however they differ in their main conclusions in some cases the impact of perturbations in the glacial freshwater forcing on sea ice is very weak and not significant in other cases the response is relevant but does not match the spatial pattern of the observations this may be due to the lack of consensus over the quantity and spatial distribution of the freshwater perturbation applied in such experiments indeed most ocean models present large differences in their freshwater forcing protocol and neglect the spatial distribution of the sources recent ice shelf mass balance estimates based on satellite data rignot et al 2013 depoorter et al 2013 may help better constrain both the magnitude and the spatial distribution of glacial freshwater released into the southern ocean furthermore recent improvements in the methods to prescribe ice shelf melt mathiot et al 2017 and to distribute the iceberg meltwater through lagrangian models merino et al 2016 marsh et al 2015 now allow a better distribution of the antarctic glacial freshwater over the southern ocean this has been shown to affect sea ice production merino et al 2016 mathiot et al 2017 but as yet it remains neglected by most ocean models in this study we evaluate the impact of the recent enhancement in glacial freshwater fluxes on the sea ice properties in the southern ocean two different freshwater scenarios are proposed to represent the current and pre imbalance ice ocean mass fluxes the scenarios are built upon glaciological estimates of the antarctic ice mass loss and distinguish calving from ice shelf melt both glacial freshwater scenarios are applied to an atmospherically forced eddy permitting ocean sea ice model an improved version of a lagrangian particle iceberg model is coupled with our ocean model in order to distribute the calved mass while ice shelf melt is prescribed following the method proposed by mathiot et al 2017 the sensitivity to changes in glacial freshwater scenario is addressed under the same atmospheric conditions then compared against typical changes induced by decadal atmospheric variability section 2 describes the model set up and the freshwater forcing scenarios section 3 presents the model mean state and trends and section 4 describes the model response to atmosphere and freshwater perturbations and discusses the related mechanisms 2 material and methods 2 1 ocean sea ice model configuration all the numerical experiments performed in this study share the same general model set up simulations use a coupled ocean sea ice iceberg model with interannual atmospheric forcing the ocean component is based on nemov3 5 madec 2014 with a global grid of 0 25 resolution orca025 developed by the drakkar group it considers 75 vertical z levels with partial steps the model is forced by atmospheric data from the interannual dfs5 2 re analysis era interim based dussin et al 2016 brodeau et al 2010 it uses the core bulk formulations with three hourly winds humidity and air temperature and daily cloud cover short and long wave solar radiation and liquid and solid precipitations the ocean component is coupled every time step with the lim2 sea ice model fichefet and morales maqueda 1997 a salinity restoring term towards nodc woa data gouretski and koltermann 2004 with a piston velocity of 50 m 300 days applied to the ocean surface griffies et al 2009 this term is required in atmospherically forced simulations because of the missing atmospheric feedbacks griffies et al 2009 the ocean component is also coupled with the nemo icb lagrangian iceberg module marsh et al 2015 containing the most recent improvements described in merino et al 2016 these latter modifications consider depth dependent ocean velocities and temperatures in the computation of the drag and melt rate applied to icebergs instead of ocean surface properties as in most iceberg models so far all the meltwater from icebergs is put at the ocean surface i e assuming no significant mixing with the iceberg freshwater plume our model configuration does not include ice shelf cavities but adopts the parameterization developed by mathiot et al 2017 to distribute the observation based ice shelf meltwater from antarctica the later emulates the buoyancy driven ice shelf overturning by distributing the coastal runoff over the vertical model levels located between the depth of the ice shelf front and the deepest depth of the glacier grounding line or the bathymetry at the front if shallower than the grounding line mathiot et al 2017 have shown that this method outperforms those in which the ice shelf freshwater is injected at the depth of the ice shelf front e g beckmann and goosse 2003 the prescribed amplitude of iceberg calving and ice shelf melt is described in the next subsection ocean temperature and salinity are initialized from the observational estimates from steele et al 2001 and antarctic sea ice is initialized to 1 m thick wherever ocean surface is below 1 c all the experiments conducted in this study use a 11 year spin up phase which is reasonable for initializing major circulation features and surface properties barnier et al 2006 tréguier et al 2010 and to balance the iceberg mass and melt water from the iceberg module merino et al 2016 after the 11 year spin up the drift in acc transport at drake is 0 2 sv yr exactly as in tréguier et al 2010 who used a very similar nemo configuration and attributed the drift to an erosion of aabw along the simulations it is therefore likely that dense water formation and or its downward transport are poorly represented in our model nonetheless no significant drift of surface fluxes is found after the spin up phase not shown and our methodology prevents our results from being affected by any potential drift because we mostly compare experiments of similar drifts see section 2 3 2 2 freshwater forcing in the southern ocean this section explains how our freshwater forcing is constructed and how our experiments are designed to address the main question of this study in the southern ocean the glacial freshwater fluxes come from melting icebergs and ice shelves the floating extension of outlet glaciers confined in an embayment in the following we present the terms of the ice shelf mass balance section 2 2 1 the recent observational estimates of calving flux and ice shelf melt used to build our mean freshwater forcing over the 2000 2009 period section 2 2 2 and the method developed to reconstruct the mean calving flux and ice shelf melt over the 1990 1999 period section 2 2 3 in the southern ocean glacial freshwater fluxes come from the melting of ice originating from the antarctic ice sheet as we will see in section 2 2 1 and as already conceptually introduced by rye et al 2014 and pauling et al 2016 the amount of glacial freshwater getting into the ocean is strongly affected by changes in the mass of ice shelves the glacial freshwater fluxes can be estimated for the major ice shelves over the 2000 2009 period based on observational studies and accounting for the changing mass of ice shelves section 2 2 2 a number of hypotheses then allow constraining a glacial freshwater scenario representative of the 1990s as described in section 2 2 3 to date no reliable information can be considered for the reconstruction of time varying glacial freshwater fluxes between the two periods so we will run sensitivity experiments in which we apply the two freshwater fluxes with constant fluxes over the entire simulations see section 2 3 such experimental design is similar to bintanja et al 2013 2015 and pauling et al 2016 the analysis of the mean anomalies provides information on the impact of freshwater on the antarctic sea ice prescribing a ramping versus constant freshwater flux may affect the estimation of sea ice trends within a simulation but comparing the mean sea ice between two simulations with constant freshwater forcing does not require any assumption on the ramping shape 2 2 1 the ice shelf mass balance equation the freshwater flux into the southern ocean can come from three continental sources icebergs melting along their trajectories basal melt underneath ice shelves and runoff from surface melting the later is mostly confined to a few regions in the northern antarctic peninsula barrand et al 2013 van den broeke 2005 although it can sporadically be observed in other regions e g nicolas et al 2017 bell et al 2017 furthermore most of the surface melt water refreezes before reaching the ocean irvine fynn et al 2011 therefore the freshwater flux from surface melting is usually neglected compared to the freshwater flux associated with the calving flux cf and the ice shelf basal mass balance bmb to understand these two prominent freshwater fluxes one needs to consider the mass balance of an ice shelf a schematic view of an antarctic ice shelf is shown in fig 1 which describes the main mass fluxes ocean currents and other terms that are used throughout this paper antarctic ice shelves gain mass from the ice inflow through the grounding line gate imaginary surface between the floating and grounded ice and due to snowfall at their surface their mass loss occurs through several processes calving at their front basal melt at the ocean ice interface and wind erosion or sublimation at their surface from the ice shelf point of view the two fluxes of interest for the ocean i e cf and bmb are partly compensated by the surface mass balance smb which includes snow accumulation surface melting refreezing sublimation snow erosion and transport by the wind and the grounding line flux glf the difference between the inputs glf smb and outputs cf bmb results in the mean thickening rate dh dt or ice shelf mass convergence the mass conservation is thus described by the following equation rignot et al 2013 depoorter et al 2013 1 d h d t smb glf cf bmb in the following paragraphs we describe the two different glacial freshwater scenarios applied to our ocean simulations basically our approach consists of determining a pair of cf and bmb values for i a scenario corresponding to the mass exchange between the antarctic ice shelves and the ocean in the 2000s fresh and ii a scenario representative of the situation in the early 1990s fresh this latter scenario built from fresh is based on assumptions on the various terms of the ice shelf mass balance eq 1 and computed for each ice shelf larger than 100 km2 details on the construction of both scenarios fresh and fresh are given in sections 2 2 2 and 2 2 3 respectively and a summary of the two glacial freshwater scenarios with all the terms of eq 1 is presented in fig 2 a detailed comparison of the bmbs corresponding to the two glacial freshwater scenario is shown in fig 3 for each individual ice shelf 2 2 2 scenario fresh scenario fresh represents the antarctica southern ocean freshwater exchanges of the decade 2000 2009 we therefore directly use the cf and bmb fluxes provided by depoorter et al 2013 these estimates are based on data from the icesat period 2003 2009 and previous satellite programs including ers 1 and ers 2 covering a large part of the 1990 1999 decade in many regions the scenario accounts for ice shelf thinning rates that are consistent with the observed enhancement of antarctic mass discharge in depoorter et al 2013 all the sparse collected data were corrected in time to get estimates representative of the decade 2000 2009 this means that their estimates provide a reasonable representation of the annual glacial freshwater fluxes that were released into the southern ocean over that decade and are consistent with other recent estimates over the same period rignot et al 2013 all the ice shelf locations considered in depoorter et al 2013 have been identified on our orca025 model grid following merino et al 2016 for a given ice shelf the bmb flux is homogeneously distributed over all grid points along the corresponding ice shelf front and distributed vertically according to the ice shelf geometry as described in section 2 1 in addition depoorter et al 2013 provide an upscaling mass flux term per oceanic basin so that the total estimated antarctic mass loss can be matched the latter is homogeneously distributed over the coastal surface grid points of the corresponding oceanic basin our forcing strategy does not consider any seasonal variations in bmb because very little is known about such seasonality the cf estimates are used as inputs for the lagrangian iceberg model cf values are kept constant over time with the same calving rates and locations as provided in merino et al 2016 the ocean iceberg model distributes the iceberg meltwater over the southern ocean with seasonal variations related to the ocean properties merino et al 2016 2 2 3 scenario fresh the fresh scenario is designed to represent a reasonable glacial freshwater input into the ocean before the observed antarctic mass imbalance in the early 1990s rignot et al 2011 shepherd et al 2012 the recent acceleration of grounded outlet glaciers is linked to the thinning of ice shelves as a consequence of the enhancement of their basal melting pritchard et al 2012 or collapse scambos et al 2004 our hypothesis is that the antarctic ice shelves were in steady state in the early 1990s d h d t 0 this assumption may not be entirely true at the regional scale as it is known that some glaciers in the amundsen sector were already retreating early in the 80s hughes 1981 smith et al 2016 and the ross sea was already experiencing freshening in the early 1990s jacobs and giulivi 2010 it is nonetheless a good approximation at the scale of antarctica paolo et al 2015 and making other assumptions regionally is not straightforward this assumption may nonetheless result in an overestimation of the glacial freshwater differences between the scenario fresh and fresh in the amundsen sector to construct the fresh scenario we start from the estimates provided by depoorter et al 2013 in addition to setting dh dt to zero further hypotheses regarding smb cf and glf are needed to compute bmb from eq 1 the smb values in depoorter et al 2013 are from a regional atmospheric simulation over 1979 2010 assuming that there has been no significant smb trend over that period monaghan et al 2006 lenaerts et al 2012 we therefore keep the same smb values as in depoorter et al 2013 as they are also representative of the 1990s we make a similar assumption for the cf term because to our knowledge there is no evidence of any trend in calving fluxes of course individual events of ice shelf collapse may introduce interannual variability in cf rott et al 1996 but it would be difficult to associate a statistically significant trend to these events liu et al 2015 it has to be noted that some observed changes in ice shelf velocities are compensated by changes in ice shelf thickness so that the ice mass flow is relatively unchanged which is consistent with the small changes in the position of calving fronts observed over the recent decades now we estimate glf in the early 1990s so that we can deduce bmb from eq 1 to do so we use estimates of antarctic contributions to sea level rise i e of mass loss of the grounded ice sheet since the beginning of the 1990s the mass equation for the grounded part is 2 d m d t smb gr glf where m is the mass of grounded ice glf the grounded line flux and smbgr the surface mass balance of the grounded part of glaciers for some glaciers in west antarctica in the antarctic peninsula like larsen ice shelves and in the east indian sector of east antarctica totten and cook the grounded ice mass loss has been explained by changes in ice dynamics rignot et al 2008 2002 for these glaciers we can therefore express glf in the early 1990s as 3 glf 1990 s glf 2000 s d m d t 1990 s d m d t 2000 s where each quantity is an average over the period in subscript we now assume that the ice sheet was approximately in steady state in the early 1990s so that the second term in the right hand side of eq 3 is neglected we then assume that the third term in the right hand side of eq 3 is given by the observational estimates of shepherd et al 2012 as glf2000s is known from depoorter et al 2013 we can deduce glf1990s for the other glaciers no dynamical changes have been reported and mass changes between the 1990s and the 2000s have been attributed to regional changes in surface mass balance smbgr in these cases it is reasonable to assume that glf has remained unchanged between the 1990s and the 2000s our backward estimation of glf is based on two major assumptions first we assume that antarctica was in steady state in the early 1990s the validity of this assumption is uncertain for example shepherd et al 2012 suggest that the antarctic ice sheet was gaining mass in the early 1990s which would mean that the perturbation introduced between fresh and fresh is globally underestimated although the rate of mass change in the early 1990s is likely negligible compared to the perturbation we introduce second we assume that the rates of mass change provided by shepherd et al 2012 are representative of the 2000s while they actually represent the period 1992 2011 this may again imply an underestimation of the glf differences between the fresh and fresh scenarios since many drainage basins have experienced a strong mass loss acceleration over the recent decades particularly in the amundsen sector rignot et al 2011 sutterley et al 2014 our methodology to construct freshwater scenarios is new in the sense that previous studies analyzing the impact of glacial freshwater perturbations on the southern ocean sea ice were based on empirical perturbations pauling et al 2016 or on sea level rise estimates bintanja et al 2013 swart and fyfe 2013 as pointed out by rye et al 2014 these commonly used approaches neglect ice shelf thinning or thickening and do not make any difference between mass changes of dynamical origin and those originating from changes in the surface mass balance the ice shelves are the antarctic glacial freshwater exchangers with the ocean and therefore the construction of glacial freshwater scenarios should always consider the ice shelves processes and their mass balance equation 2 3 model experiments three model experiments are performed to study the sensitivity of the model to different forcing perturbations fig 4 the three runs use the model set up described in section 2 1 and cover 31 years including 11 years of spin up that are not analyzed in the following the three experiments consider a constant glacial freshwater forcing over the full experiment period because the timing of the changes in freshwater fluxes is poorly known in terms of timing of the freshwater release our experimental design is thus similar to bintanja et al 2013 2015 and pauling et al 2016 swart and fyfe 2013 and pauling et al 2017 used a different method considering melt rates that vary linearly in time however observational studies suggest that mass changes have occurred at an accelerated rather than constant rate with distinctive regional patterns of acceleration rignot et al 2011 sutterley et al 2014 so we have preferred not to make any assumption on the freshwater trend prescribing a ramping versus constant freshwater flux may affect the estimation of sea ice trends within a simulation pauling et al 2017 but here we compare the mean sea ice cover between two simulations with constant freshwater forcing rather than directly comparing the trends our methodology therefore does not rely on any assumption on the detailed timing of the freshwater release and the difference between the two simulations with different freshwater scenarios does represent the typical increase in freshwater release over the recent decades we further note that comparing perturbed mean states rather than trends is also a way to remove the influence of model drifts the control run hereafter the fw experiment simulates the period 1979 2009 with the freshwater scenario fresh described in section 2 2 2 the fw simulation considers the same period 1979 2009 as the fw run but with the freshwater scenario fresh finally the atm run combines the application of the perturbed scenario fresh and an atmospheric forcing period starting and finishing 10 years earlier than the other runs thus covering the period 1969 1999 this 10 year lag in the atmospheric forcing is equivalent to the approximative 10 year lag in the freshwater perturbation fw minus fw it should be noted that 10 of the 11 years of spin up in the atm experiment use atmospheric forcing before the satellite era dfs5 based on the era 40 reanalysis prior to 1979 however all our results are computed after the spin up period i e when the atmospheric forcing is constrained by satellite data importantly the impact of the different spin up between atm and the rest of experiments over 1990 1999 is small compared to the sensitivity reported in this paper not shown fig 5 shows the mean atmospheric perturbations introduced between the fw and atm simulations dfs5 2 tends to be dryer over the recent decades with two exceptions in the region between the ross and amundsen seas and in the western weddell sea over the recent decades air temperature tends to be warmer in the amundsen and bellingshaussen seas the indian sector and the northern weddell sea but it tends to be markedly colder by up to 1 5 c north of the ross sea and in the coastal weddell sea and west pacific sector winds are stronger in the atlantic and west indian sectors and in some coastal regions of the ross and pacific sectors and weaker from the western coast of the peninsula to the amundsen sea a schematic diagram of the three experiments is shown in fig 4 the comparison between fw and fw provides an estimate of the model response to our perturbation in glacial freshwater forcing although there remain large uncertainties this perturbation is a reasonable estimate of the typical decadal change in the freshwater released by the antarctic continent into the ocean in the results and discussion sections the fw minus fw comparison will therefore be referred to as freshwater induced changes the fw versus atm comparison provides an estimate of the impact of the recent decadal atmospheric changes present in the era interim reanalysis this comparison will therefore be referred to as atmospheric induced changes finally the fw minus atm comparison accounts for both the perturbation in the glacial freshwater flux and in the decadal atmospheric forcing this comparison indicates the typical decadal change in the southern ocean as fresh represents the 2000s and fresh the early 1990s hereafter it will be referred to as total changes 3 evaluation of the simulations this section evaluates the ability of the model to represent the ocean and sea ice mean states and sea ice variability the simulated climatological sea ice concentration sic is compared to the nsidc sic in fig 6 overall the model set up is able to reproduce the main spatial distribution with a sic of similar magnitude as in the observations in both summer and winter the model nonetheless has a deficit of sea ice in summer with less concentrated sea ice in the west pacific and the amundsen sectors and a smaller extent of permanent sea ice in the weddell sea than in the observations this summer deficit is typical of orca025 simulations and was also found in most ocean sea ice models forced by another atmospheric reanalysis downes et al 2015 the model also produces too much sea ice over the winter months exhibiting a more concentrated ice pack at the sea ice margins as in other nemo simulations presented in downes et al 2015 the reason for such biases is still a matter of research fig 7 a and b show the sea ice trends computed from experiments fw and fw respectively both simulations present a very similar trend in sic because they are forced by the same atmosphere the simulations reproduce reasonably well the main observed patterns in sic trends fig 7 c i e the positive trend offshore of dronning maud land and in the northern ross sea are well reproduced as well as the negative trends on the western flank of the peninsula nonetheless the model does not reproduce the observed sea ice trends along the ice sheet margins in the pacific sector and in prydz bay it should be noted that holland et al 2014 also managed to reasonably reproduce the observed trends in atmospherically forced ocean hindcasts with regional biases of similar magnitude as in our study for the reasons mentioned in section 2 3 we apply constant rather than ramping freshwater fluxes therefore the effect of different freshwater fluxes between the early 1990s and the 2000s is not seen in the trend of individual simulations but rather in comparisons of simulations with different freshwater fluxes the total decadal sic change fw over 1990 2009 vs atm over 1980 1999 is therefore compared to observations 1990 2009 vs 1980 1999 in fig 8 it should be noted that this decadal difference gives slightly different results compared to linear trends in particular in the weddel and amundsen seas fig 7 c vs fig 8 b again the main patterns of the total decadal sic change are reasonably well reproduced by our simulations fig 8 there are nonetheless significant differences offshore in the amundsen and bellingshausen seas by contrast to the offshore sea ice pack the trends in these regions are well reproduced near the ice sheet margins further investigations indicate that the offshore bias is particularly affected by differences in the spin up between the atm and fw experiments and the positive offshore trend is actually attributed to a spurious signal inherited from the spin up not shown these offshore trends are therefore not analyzed in the following finally we have also made other comparisons to observational estimates that we briefly mention here the patterns and amplitude of the simulated eddy kinetic energy eke was found to be in good agreement with the eke derived from aviso see fig 2 in dinniman et al 2015 not shown the simulated barotropic transport through the drake passage remains within the observed range of 134 11 sv cunningham et al 2003 all along the simulation despite the drift of 0 2 sv yr mentioned in section 2 1 not shown 4 role of the atmospheric and freshwater perturbations on the sea ice decadal changes to analyse and discuss our results we define three regional sectors of analysis in the ross sea the coastal amundsen sea and west pacific east indian sector see fig 8 a these sectors are chosen because they are significantly affected by changes in freshwater fluxes because they are better able to reproduce the observational sic changes than other locations and because each of these boxes is affected by changes in freshwater fluxes through a specific mechanism 4 1 mean sea ice response over the whole southern ocean here we simply describe the general sea ice response to the atmospheric and freshwater perturbations the specific response of individual sectors and the corresponding mechanisms are described in the next sub sections qualitatively the total modeled changes in sic due to both atmosphere and freshwater changes are globally dominated by the atmospheric perturbation especially in the atlantic and west indian sectors where the freshwater perturbation barely affects the sic fig 9 there are nonetheless other sectors where the freshwater perturbation significantly contributes to the total changes such as in the ross amundsen sea and west pacific sectors the quantitative comparison between fw and atm indicates a total change in sea ice extent sie of about 3 0 for the whole southern ocean and the freshwater induced change accounts for about 25 of this total change calculated as the ratio between the freshwater induced signal and the total signal the freshwater induced changes in sea ice thickness sit are relatively more important than the corresponding changes in sic the sit response is again negligible in the atlantic and west indian sectors but is relatively strong in the other sectors fig 10 the total annual change in integrated sea ice volume siv over the whole southern ocean is an increase of 2 8 of which 46 is induced by the perturbation in glacial freshwater fluxes in terms of seasonality the sie response is dominated by the atmospheric changes during the ice covered months i e from march to october while it is dominated by the freshwater changes during the melting months i e from december to february fig 11 a the seasonal response of siv is similar in timing but the relative difference between the atmosphere induced and the freshwater induced parts is smaller than for the sic fig 11 b the timing of sea ice minima and maxima table 1 and the ice season duration isd as defined in stammerjohn et al 2008 are much more affected by the atmospheric perturbation than by the freshwater perturbation the total isd change fig 12 is in good agreement with the isd trend observed over 19792011 stammerjohn et al 2012 even though the magnitude of the observed trend is slightly larger than in our simulations this may be related to the fact that our model experiments ocean forced simulations do not account for coupled processes between the ocean surface and the atmosphere which would arguably amplify the impact of the freshwater induced changes on sea ice because the signal would not be damped by surface salinity restoring 4 2 sea ice response in the west pacific east indian sector in the west pacific east indian sector the sie increases by 5 in response to the total perturbation and 52 of this increase is induced by the freshwater perturbation the siv increases by 10 in response to the total perturbation and 61 of this increase is induced by the freshwater perturbation regarding the seasonality both the freshwater and atmospheric perturbations contribute to increase the sea ice extent and volume over most of the year the relative importance of the two perturbations varies between sie and siv but the freshwater perturbation has a stronger relative importance in late summer and spring from august to november while the freshwater has only a weak influence on the phase of the seasonal cycle the atmosphere perturbation advances the maximum by 10 days delays the minimum by 3 days on average table 1 and increases the sid fig 12 the atmosphere induced sea ice changes in this sector were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven thermodynamical changes we therefore focus more on the mechanisms explaining the freshwater induced changes the freshening of the ocean surface may increase density differences between ocean surface and sub surface water masses this leads to a reinforcement of the density stratification between the ocean surface and subsurface separated by the pycnocline affecting the convection regime and therefore the heat supply from the deeper and warmer ocean to the ocean surface this process suggested by marsland and wolff 2001 may affect thermodynamical sea ice formation resulting in more sea ice in presence of ocean surface freshening a comparison of fig 13 a and b indeed suggests that the freshwater induced increase in sea ice production along the coast is mostly explained by changes in oceanic heat flux at the sea ice base this extra sea ice produced along the coast is then advected offshore explaining the positive freshwater induced sea ice anomaly all over this sector fig 9b 4 3 sea ice response in the ross sea in the ross sector the sie increases by 1 4 in response to the total perturbation and 35 of this increase is induced by the freshwater perturbation as much as 80 of the total increase in siv is induced by the freshwater perturbation regarding the seasonality the freshwater induced thickening compensates for the atmosphere induced thinning in summer december and january in spring and early summer both the atmosphere and freshwater perturbations tend to favor the sea ice extension and thickening with a dominant impact of the atmosphere on the sie but impacts of comparable magnitude for the siv while the freshwater has only a weak influence on the phase of the seasonal cycle the atmosphere perturbation advances the maximum by 15 days on average table 1 and increases the sid fig 12 as in the west pacific east indian sector the atmosphere induced sea ice changes in the ross sea were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven thermodynamical changes and here we focus on the mechanisms explaining the freshwater induced changes a similar mechanism as in the west pacific east indian sector can explain the sea ice response to the freshwater perturbation as shown in fig 13 b the ross sea presents an increase in thermodynamical sea ice production at the coast where the ocean surface is much fresher fig 14 b the freshwater perturbation results in a siv increase of 8 1 1010 m3 during the sea ice production months from march to september the extra siv produced in the fw simulation compared with the fw simulation is found mostly along the coast and is advected resulting in increased sic fig 8 and sit fig 10 this northward export of sea ice in the ross sector is further supported by a strengthened antarctic coastal current acoc which is visible in fig 14 a as a freshwater induced rise in sea surface height in good agreement with rye et al 2014 the stronger acoc contributes to the freshwater induced changes in sea ice divergence in this sector these changes represent a mean siv loss of 1 7 1010 m3 per year which is relatively weak compared with the changes of thermodynamical origin in this sector as shown in table 1 the siv differences in minima between the fw and fw simulations are not significant compared with the siv differences in maxima given the extra siv produced by fw there is an excess of sea ice that needs to be melted during the spring and summer months if both simulations are to show relatively similar sea ice minima according to table 1 the sea ice minimum obtained in the sector does not seem to be much affected by the freshwater or atmospheric perturbations introduced in our experiments however in the fw simulation the melting of sea ice is amplified by summer freshwater induced changes in the oceanic heat reaching the sea ice base see fig 15 a in contrast to the annual means fig 13 a the oceanic heat supplied to the sea ice base in summer is slightly greater in the fw simulation than in the fw simulation represented by lower heat in sea ice formation equivalent in fig 15 a this may be related to a sea ice feedback which helps compensate for the extra sea ice volume produced in winter when the sea ice retreats in late spring the thicker sea ice produced in fw results in colder summer sst as shown in fig 15 b the colder and denser sea surface affects buoyancy and therefore reduces the density stratification under these specific conditions the oceanic heat convection in summer is facilitated in the sector as shown in fig 15 a however this extra oceanic heat is not able to entirely explain the extra sea ice melting in the ross sector obtained in the fw simulation 4 4 sea ice response in the coastal amundsen sea the sea ice response in the amundsen sea is different from the other regions with decreased sie and siv in response to the atmosphere and freshwater changes the sie indeed decreases by 2 7 in response to the total perturbation and 37 of this decrease is induced by the freshwater perturbation the siv decreases by 8 1 in response to the total perturbation and 40 of this decrease is induced by the freshwater perturbation in this sector the atmospheric perturbations dominate the sie response over most of the year and both the atmosphere and the freshwater perturbations play a stronger role in the summer months fig 11 in early fall the atmosphere induced increase in sea ice cover is partly inhibited by the freshwater perturbation fig 11 regarding the phase of the seasonal cycle the freshwater perturbation advances the sea ice minimum by 6 days while the atmosphere perturbation delays it by 9 days on average table 1 unlike the two regions analyzed above the sid in the coastal amundsen sea is decreased by the total perturbation fig 12 the atmosphere induced sea ice changes in the amundsen sea were already described by holland and kwok 2012 and holland et al 2014 in terms of wind driven dynamical changes vs thermodynamical in the two previous sectors so we focus more on the mechanisms explaining the freshwater induced changes in the coastal amundsen sea the extra freshwater perturbation tends to increase the oceanic heat flux at the sea ice base fig 13 a this result explains the modeled decrease in sic and sit shown in figs 8 and 10 respectively amundsen is the region of the antarctic coast where the most rapid warming has been observed schmidtko et al 2014 this is due to a number of factors that include atmospheric features the proximity of the region to the warm antarctic circumpolar current acc and topographic features resulting in warm water intrusion into sub surface waters walker et al 2007 jacobs et al 2011 thoma et al 2008 turner et al 2017 in particular observations have indicated intrusions of circumpolar deep water cdw into ice shelf cavities with temperatures of more than 3 c above the freezing point this may be causing strong grounded ice mass loss in the antarctic basins in the sector shepherd et al 2012 due to considerable ice shelf thinning pritchard et al 2012 these observations have been considered in our glacial freshwater scenario reconstruction section 2 2 and make the amundsen sea the region with the largest glacial freshwater forcing perturbation in our experimental set up fig 3 as shown by mathiot et al 2017 and explained in section 2 1 the way glacial freshwater is added into our ocean model is designed to emulate the ice shelf cavity recirculation it is generated by the buoyancy fluxes introduced when distributing the ice shelf freshwater flux along the vertical of the ocean model grid points adjacent to the ice shelf therefore the inclusion of more glacial freshwater strengthens coastal overturning which may result in a stronger heat transport from deep layers to the surface the special conditions found in the amundsen sector i e very warm sub surface water combined with the strongest glacial freshwater perturbation would seem to explain the freshwater induced anomaly in the oceanic heat flux reaching the ocean surface fig 13 a indeed as shown in fig 16 the extra freshwater introduced in the fw simulation affects the coastal stratification and promotes vertical heat transport this leads to sub surface cooling and surface warming in the model as also found by jourdain et al 2017 who explicitly modeled the ice shelf cavities of the amundsen sea in the other sectors like the ross or bellingshausen seas this feature is not dominant in our simulations compared with the impact of surface freshening on sub surface heat convection associated with the mechanism described in marsland and wolff 2001 this warming feature of the amundsen sea sector is consistent with observations jenkins 1999 it has been suggested that an increase in ice shelf melting at the grounding line depth may enhance ice shelf cavity overturning hellmer and olbers 1989 due to buoyancy changes in the interior of the ice shelf cavity as reproduced in our experiments however the magnitude of an associated heat transfer between sub surface and surface water masses is still unclear the inclusion of ice shelf cavities in the ocean model should be considered at least for this sector in order to properly quantify the impact of ice shelf basal melt on the very specific conditions of the amundsen sea sector 5 conclusions the sea ice response to recent changes in antarctic glacial freshwater release into the southern ocean has been investigated with a set of eddy permitting ocean sea ice iceberg model experiments the freshwater induced changes in the global and regional sea ice and ocean properties have been compared with typical atmosphere induced changes and observations our model experiments consist of a control run and two perturbed simulations the control run takes into account a recent glaciological estimate of the magnitude and spatial distribution of iceberg calving fluxes and ice shelf basal melt fluxes the perturbed simulations consider a decadal shift of the atmospheric variables and our own estimate of the pre antarctic imbalance glacial freshwater released into the ocean for the first time the perturbed freshwater scenario takes into account the regional pattern of the recent ice shelf thinning and the dynamical mass change in the grounded antarctic basins it is based entirely on glaciological mass budgets and represents an improvement with respect to previous studies investigating the impact of recent glacial freshwater trends on ocean properties our results show that the freshwater induced changes in sea ice extent sie may overall potentially contribute 25 of the total trend in sie however the regional changes in sie differ markedly with freshwater accounting for 37 of the total decrease in sie in the amundsen sea sector but for 52 of the total increase in sie in the west pacific sector perturbations in freshwater forcing produce a much greater impact on sea ice thickness and therefore on sea ice volume siv for the entire southern ocean the freshwater induced changes in siv represent almost 50 of total modeled changes and are dominant with respect to the atmosphere induced changes in the ross and west pacific sectors in the amundsen sector the increased release of freshwater from the ice shelves results in an enhancement of coastal overturning as supported by regional simulations with an explicit representation of ice shelf cavities jourdain et al 2017 this leads to an increase in the oceanic heat supplied by the very warm sub surface water mass to the ocean surface near the ice sheet margin the freshwater induced changes in siv and sie during the sea ice production months are shown to have only a slight effect on the maximum of the global siv seasonality but with important implications for the ice season duration isd in the ross and west pacific sectors these changes are mostly produced by freshwater induced changes in the oceanic heat convection related to ocean surface freshening changes in the oceanic heat reaching the sea ice base are shown to produce significant thermodynamical changes in sea ice production in addition the freshening of the ocean surface results in a strengthening of the antarctic coastal current acoc which may induce changes in sea ice divergence however such changes remain relatively weak compared with the freshwater induced thermodynamical changes in sea ice production two aspects of our methodology likely lead to an underestimation of the model response to the glacial freshwater perturbation first the assumptions made to reconstruct the freshwater fluxes in the early 1990s are based on rates of ice sheet mass loss estimated over 1992 2011 section 2 2 3 accounting for the mass loss acceleration over the most recent period would have led to a stronger difference between the two freshwater scenarios second the surface salinity restoring applied to our simulations section 2 1 compensates a part of the perturbations in glacial freshwater fluxes the total surface salinity restoring south of 55 s is equivalent to a freshwater flux that is 300 gt yr larger in fw than in fw this means that over the southern ocean restoring compensates 85 of the freshwater perturbation however a large part of this compensation occurs far from the coast once the freshwater has been advected away for example the freshwater flux associated with salinity restoring in the coastal amundsen sector is only 7 gt yr larger in fw than in fw for a perturbation in basal mass balance of 192 gt yr for the ice shelves of this sector in the ross sector restoring is more important accounting for a freshwater difference of 64 gt yr between fw and fw this compensates both the extra freshwater by the ice shelves of the ross sector 5 gt yr and the advection of a significant part of the 192 gt yr from the amundsen sea nakayama et al 2014 in the west pacific east indian sector surface salinity restoring compensates 34 gt yr of the 55 gt yr perturbation in summary surface salinity restoring unlikely affects our estimates of sea ice sensitivity in the coastal amundsen sea but it probably leads to underestimate the impacts of changing glacial freshwater fluxes on sea ice properties in the ross and west pacific east indian sectors most of the changes in glacial freshwater fluxes are believed to occur in the pacific sector especially in the amundsen sector in view of the strong regional contrasts in sea ice sensitivity and associated mechanisms we suggest that the freshwater perturbations applied to ocean models should account for these regional changes instead of uniformly spreading a perturbation around the antarctic continent in addition the recently observed ice shelf imbalance pritchard et al 2012 paolo et al 2015 is by no means negligible compared to the imbalance of the antarctic grounded ice sheet consequently the mass loss of both the floating and the grounded parts need to be taken into account this was not done in previous studies which may explain a part of the differences between our results and those from similar work showing freshwater induced changes in the atlantic and east indian sectors bintanja et al 2013 or showing a very limited response of sea ice to glacial freshwater perturbations pauling et al 2016 swart and fyfe 2013 there are nonetheless other differences for example we use an eddy permitting resolution while the aforementioned studies used models of coarser resolution and we use an ocean only model with salinity restoring while the other studies were based on earth system models no surface salinity restoring finally while our wind and freshwater perturbations represent a typical decadal change from the early 1990s to the early 2000s chosen based on available satellite data we acknowledge that analysing a more recent period could lead to different results the model version customizations and parameters used to run the three experiments presented in this paper are provided on http doi org 10 5281 zenodo 1067648 the output and forcing data are available on request acknowledgments we would like to thank jean marc molines for his invaluable help with model configuration the study was partially funded by the french national research agency anr under the sumer blanc simi 6 2012 project anr 12 bs06 0018 and the trois as project anr 15 ce01 0005 01 nm jls gd and nj are part of labex osug 2020 anr10 labx56 nj is an associate investigator of the arc centre of excellence for climate system science numerical simulations were performed on idris supercomputers saclay france we thank three anonymous reviewers and editor stephen griffies for their useful comments and suggestions 
