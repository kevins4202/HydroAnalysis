index,text
2630,bathymetry of inland water bodies is essential for river maintenance and flood risk management traditionally in shallow water bodies bathymetry is retrieved by operators wading through the water body with real time kinematic rtk global navigation satellite system gnss whilst in deeper waters it is retrieved with sonar instruments on manned or unmanned boats in the past researchers have documented the use of ground penetrating radar gpr on boats i e water coupled gpr for monitoring the bathymetry of frozen and non frozen water bodies furthermore gpr has been used on helicopters for monitoring ice and snow thickness however deployment of gpr on board unmanned aerial systems uass in non frozen inland water bodies with electric conductivity higher than 100 μs cm as is common in most inland waterbodies in non polar regions is unexplored in this paper we document the possibility to use drone borne and water coupled gpr in several cross sections located in three different waterbodies 1 lake and 2 rivers in denmark these waterbodies had different bed sediment materials and vegetation conditions an electric conductivity varying from 200 to 340 μs cm and depths up to 2 5 m drone borne gpr showed accuracy similar to water coupled gpr when compared to rtk gnss ground truth measurements with a mean absolute error mae of approx 8 cm the only limitations of drone borne gpr were i more restrictive minimum depth requirement typically 0 8 1 1 m for drone borne gpr while 0 3 0 4 m for water coupled gpr ii requirement to fly the gpr antenna at altitudes of approx 0 5 m above the water surface to avoid high spreading losses and strong surface clutter events hiding the signal finally gpr measurements were benchmarked against traditional sonar measurements showing that gpr measurements significantly outperform sonar measurements in waterbodies with medium or high density of aquatic vegetation keywords uas drone water depth bathymetry sonar gpr data availability the dataset used in the study are available online in the repository archived in zenodo org https doi org 10 5281 zenodo 5069749 the repository contains the supplementary material specifically i jupyter notebook with the calculations and plots of the gpr loss components ii all the radargrams iii the processed sonar and gpr observations in text format and iv the plots comparing bathymetry retrieved with the different instruments additional data will be made available on request 1 introduction bathymetric surveys are typically conducted to measure water depth and map the underwater features of a water body bathymetry of inland waterbodies plays a critical role in many hydrological and hydraulic problems and applications indeed the hydrological regime of a lake is largely dependent on its bathymetry yao et al 2018 and similarly the predictive skills of river hydrodynamic models depend on the accuracy of river cross section shape datasets grimaldi et al 2018 to optimize river maintenance and improve flood forecasting bathymetry should be retrieved at regular time intervals with high spatial resolution alsdorf et al 2007 cook and merwade 2009 indeed the temporal variability of bathymetry which is typically caused by processes such as sedimentation erosion and human intervention e g bottom dredging can significantly change the frequency of overbank flooding under the same peak discharge conditions lane et al 2007 stover and montgomery 2001 similarly the high spatial variability of bathymetry along the river course may require continuous or very high resolution mapping to accurately characterise the river morphology and geology diaconu et al 2019 merwade 2009 to acquire bathymetric data different techniques can be used as described in the next sections 2 rtk gnss surveys in shallow water the conventional way of measuring river bathymetry is through cross sectional surveys with rtk gnss at certain locations along the river however these surveys typically require significant man power and are time consuming thus the ratio cost area covered is very high and investigation is typically limited to few cross sections bangen et al 2014 feurer et al 2008 2 1 sonar in navigable rivers river bathymetry is typically measured with single beam or multi beam sonar on board manned or unmanned vessels bio et al 2020 halmai et al 2020 leyland et al 2017 specht et al 2020 stateczny et al 2019 young et al 2017 however sonar systems have limitations especially for the most commonly used frequencies less than 1 mhz in measuring very shallow depths due to surface clutter and multipath effects albright blomberg et al 2013 furthermore the accuracy of sonar significantly degrades in vegetated rivers helminen et al 2019 indeed the high level of reflection of sound waves from the vegetation can result in depth measurements within vegetation canopy sabol 2002 additionally deployment of boats can be complicated in remote areas and is limited to navigable water or especially for unmanned vessels locations without dense floating aquatic vegetation to alleviate the issues of sonar deployment in remote areas or non navigable rivers researchers alvarez et al 2018 bandini et al 2018 and recently companies e g uggs sph engineering latvia and thurn group uk developed sonar systems tethered to an unmanned aerial system uas however the tethered sonar has to remain in contact with water throughout the survey which complicates automatic pilot flights and reduces the possibility to perform beyond visual line of sight flights 2 2 remote sensing methods to overcome the limitations of in situ surveys researchers have developed remote sensing methods to estimate water depth these methods can be categorized into indirect methods which determine the flow area or the mean water depth and direct methods which determine the full bathymetric shape indirect remote sensing methods are based for instance on estimating mean depth from satellite measurements of water surface elevation wse and modelled discharge leon et al 2006 or estimating flow area from wse and cross section mean flow velocity moramarco et al 2019 the focus of this paper is on direct methods which are able to directly observe submerged topography and reconstruct the full cross section shape direct methods to observe bathymetry include i through water photogrammetry ii spectral methods iii bathymetric lidar through water photogrammetry is based on structure from motion sfm algorithms applied to uas imagery and requires correction for the distinct refractive indices of water and air alvarez et al 2018 bagheri et al 2015 dietrich 2016 feurer et al 2008 lane et al 2010 tamminga et al 2014 westaway et al 2001 woodget et al 2015 spectral methods are mostly based on the wavelength dependent exponential attenuation of light in the water column and exploit the correlation between depth and reflectance as according to lyzenga 1978 or stumpf et al 2003 spectral methods to estimate water depth of inland waterbodies have been applied to multispectral or hyperspectral and rgb images from i satellites geyman and maloof 2019 jagalingam et al 2015 lyons et al 2011 muzirafuti et al 2020 wei et al 2020 ii aircrafts carbonneau et al 2006 flener et al 2012 legleiter 2012 marcus et al 2003 and iii uass flener et al 2013 lejot et al 2007 rossi et al 2020 to combine the advantages of the spectral approach which performs better when the sediment is comparatively homogeneous legleiter et al 2009 overstreet and legleiter 2017 and the photogrammetry approach which performs better if the bottom is sufficiently textured to enable feature matching and ensures higher spatial resolution feurer et al 2008 hybrid approaches have been demonstrated slocum et al 2020 starek and giessel 2017 however both spectral and photogrammetry methods are limited to waterbodies with high water clarity and can deliver results only for depths lower than the secchi depth thus these passive remote sensing methods are typically applied to i shallow coastal areas or ii in rivers with sandy or gravel bottom and water depth less than 1 1 5 m brasington et al 2003 marcus et al 2002 winterbottom and gilvear 1997 woodget et al 2015 to overcome the limitations of passive sensors active sensors such as bathymetric lidar systems typically using green wavelength have been used to monitor bathymetry of inland waterbodies from aircrafts bailly et al 2010 charlton et al 2003 hilldale and raff 2008 kinzel et al 2013 2007 lague and feldmann 2020 pan et al 2015 and recently also from satellite missions such as icesat 2 ma et al 2020 parrish et al 2019 the cost weight and size of bathymetric lidar systems challenge uas deployment however in the last 5 years green lidar systems which comply with the payload weight restrictions of uas have entered the market such as the i laser profiler riegl bdf 1 mandlburger et al 2016 ii the scanning lidar systems astralite edge lidar kinzel and legleiter 2019 iii the scanning lidar tdot green amuse oneself inc japan furthermore chen et al 2021 reported the design and performance of a photon counting bathymetric lidar based on a fiber laser pumped green laser the main limitations of the commercial lidar systems are i their cost typically more than 150 000 euros ii their penetration capability only up to 1 1 5 times the secchi depth iii the uncertain performance for low reflectivity bottom types and dense aquatic vegetation 2 3 gpr in frozen water bodies ground penetrating radar gpr or more accurately water penetrating radar outperforms other bathymetric remote sensing techniques because of the high penetration of gpr waves in ice and snow due to the low electric conductivity and low dielectric permittivity of these two media in these applications gpr can be deployed directly on the ice surface lapazaran et al 2016 liu et al 2014 2013 moorman and michel 1997 saintenoy et al 2013 shean and marchant 2010 yoshikawa et al 2006 or also from helicopters grab et al 2018 kovacs 1979 machguth et al 2006 merz et al 2015 rutishauser et al 2016 however in freshwater waterbodies the high electric conductivity and high relative dielectric permittivity of water 80 make gpr based bathymetry monitoring of freshwater significantly more complex than monitoring of ice or snow while the use of gpr deployed water coupled from boats has been documented to successfully monitor bathymetry in lakes haeni 1996 kidmose et al 2013 2011 lachhab et al 2015 sambuelli and bava 2012 swain 2018 and rivers sambuelli et al 2009 air launched gpr antennas are less commonly described in the literature for bathymetric measurements of non frozen waterbodies indeed gpr penetration in deep water is dramatically reduced when the antenna is not water coupled because of transmission reflection and spreading losses delaney et al 1990 and because the rough water surface severely degrades the coherence of the water surface transmission arcone and calkins 1990 some tests have been performed with gpr antennas mounted on suspended cableways costa et al 2006 2000 mason 2004 nobes et al 2018 spicer et al 1997 however at present only one reference to helicopter borne gpr monitoring of freshwater bathymetry is found melcher et al 2002 although the characteristics of the sites such as electric conductivity were not given helicopter borne deployment significantly reduces the survey time compared to water coupled gpr indeed melcher et al 2002 reported that the helicopter could be flown at a low altitude few meters above the surface covering three sites located 100 km from each other within 60 min gpr mounted on uass would also increase survey speed compared to water coupled gprs and would allow for low altitude flights which are significantly less dangerous with uass than with manned helicopters in this paper we show water coupled and drone borne gpr bathymetric measurements of freshwater bodies with electric conductivity between 200 and 340 µs cm we also demonstrate the advantage of using gpr compared to sonar in highly vegetated shallow less than 2 5 m waterbodies 3 methodology in this chapter we first summarize the main equations that describe the theoretical background of gpr detection of bathymetry then we describe the survey methodology and the study areas 3 1 theoretical background gpr detection of bathymetry the gpr signal is significantly attenuated when travelling from air into the water body through the water body and finally reflected from the bottom of the water body the total loss coefficient αtotal estimates the ratio between the emitted power pemitted and received power preceived or the ratio between emitted electric field strength eemitted and received electric field strength ereceived as shown in eq 1 the total loss coefficient αtotal describes the losses involved in gpr signal propagation from the gpr transmitter to the receiver through the water body and can be calculated by adding up the individual losses as shown in eq 2 in which we have i the transmission loss αtrans through the air water interface ii the reflection loss αr from the bottom of the water body iii the propagation loss αp in water iv the spreading loss αspread in air and water in αtotal we did not include losses such as i radar system internal losses ii temperature related losses 1 α total 10 log 10 p received p emitted 20 log 10 e received e emitted 2 α total α trans α r α p α spread 3 2 transmission loss as the gpr wave propagates into water it suffers a transmission loss α trans at the surface which can be calculated with eq 3 as according to jiang and georgakopoulos 2011 and is equal to 8 9 db for air water transmission 3 α t r a n s 2 10 l o g 10 t 2 r e η a i r η w a t e r 4 t 2 η w a t e r η w a t e r η a i r in eq 3 multiplication by 2 is done because the wave needs to travel through the water surface twice in the equation η is the intrinsic impedance computed from the dielectric permittivity specifically ηair of air or ηwater of water re indicates the real part of the complex number t is the transmission coefficient given by eq 4 in the formulation of the transmission loss coefficient we do not consider that the transmission loss may be increased because of the water roughness induced by the downwash generated by a low altitude flying uas however in real world scenario this roughness would indeed increase surface cluttering rappaport et al 2003 affect wave coherence arcone and calkins 1990 and increase the spreading of the gpr waves exiting water thus decreasing the amount of radiation that the receiver acquires 3 3 propagation loss the attenuation of the gpr wave in water can be described through the coefficient αatten np m eq 5 which is reported in annan 2009 shows that the coefficient of attenuation αatten is a function of i the absolute magnetic permeability of water µabs water ii the real part of the absolute permittivity value of water εabs water iii the effective electric conductivity of water σe water the absolute permittivity of water is obtained by multiplying the real component of the relative permittivity εwater by the permittivity of free space ε0 similarly µabs water is obtained by multiplying the relative magnetic permeability of water µwater 1 by magnetic permeability of free space µ0 effective conductivity σe water can be computed through eq 6 cassidy 2009 which contains the static electric conductivity of water σwater the imaginary component of the absolute permittivity of water ε abs water and the angular frequency of the gpr ω the imaginary component of the absolute permittivity of water is obtained by multiplying the imaginary component of the relative permittivity by the permittivity of free space giannoukos et al 2017 different approaches exist to compute the gpr frequency and thus the angular frequency in the medium such as using the centre frequency of the emitted wave lambot et al 2004 schwamborn et al 2002 the entire bandwidth huisman et al 2003 the frequency of the received wave or the dominant frequency expressed as 80 of the nominal centre frequency grimm et al 2006 pérez gracia et al 2008 in this research the last approach was adopted the gpr frequency in water was considered equal to 80 of the nominal centre frequency and thus the angular frequency was computed accordingly as according to jiang and georgakopoulos 2011 the propagation loss αp in db m can be calculated with eq 7 in which d is water depth and the factor two is due to the double pass in water 5 α atten μ a b s w a t e r ε a b s w a t e r σ water e 2 6 σ water e σ water ω ε a b s w a t e r 7 α p 2 10 log 10 e 2 α atten d 3 4 reflection loss reflection loss αr is calculated the same way as transmission losses but by using the reflection coefficient r as shown in eq 8 the reflection loss coefficient is highly dependent on the impedance of the riverbed sediment material reflecting the wave as shown in eq 9 annan 2009 reynolds 1997 8 α r 10 log 10 r 2 9 r ε s e d i m e n t ε w a t e r ε w a t e r ε s e d i m e n t η w a t e r η s e d i m e n t η w a t e r η s e d i m e n t 3 5 spreading loss spreading loss which is related to the flight height and water depth can be calculated with eq 10 where afootprint directwave is the footprint of the direct wave as received by the receiver and afootprint riverbed is the footprint at the river bottom computation of the gpr footprint is complicated and has been approximated by different authors with different equations pérez gracia et al 2008 in this case we applied eq 11 to compute the first fresnel zone and estimate the radius at the water surface rfootprint watersurface from the wavelength in air λair and the flight height h above the water surface as according to leucci and negri 2006 and utsi 2004 this equation is chosen because pérez gracia et al 2008 proved with their experiments in water tanks that it can give a footprint approximation better than other common equations typically used to estimate the footprint such as the equations found in leckebusch and peikert 2001 or conyers 2004 which provide a conservative estimation of the antenna s horizontal resolution capability pérez gracia et al 2008 experimental results determining the footprint when the gpr wave crosses multiple media such as air and water were not found however we here assume that the same equation eq 11 can be applied and thus the radius at the bottom of the water body rfootprint riverbed is computed with eq 12 which is basically a sum of the radius at the water surface after the gpr wave travels through air and the radius at the water bottom if the gpr was water coupled thus the second part of eq 12 contains also the wavelength in water λwater and water depth d with the assumption that the footprint is a perfect circle the area afootprint riverbed can be computed with eq 13 a critical factor in footprint calculation is the choice of the frequency from which to estimate the wavelength in air or water here for computing λair we use the centre frequency of the gekko 80 80 mhz whilst for computing λwater we use the dominant frequency in water i e 80 of the centre frequency 10 α s p r e a d 10 l o g 10 a f o o t p r i n t d i r e c t w a v e a f o o t p r i n t r i v e r b e d 11 r footprint w a t e r s u r f a c e h λ air 4 2 h 2 12 r footprint r i v e r b e d r footprint w a t e r s u r f a c e d λ water 4 2 d 2 13 a f o o t p r i n t r i v e r b e d π r f o o t p r i n t r i v e r b e d 2 3 6 total loss the total loss can be computed with eq 2 an example of computation of total loss is shown in appendix a with a detailed calculation reported in the supplementary material the computed total loss of 41 2 db means that out of a transmitted wave with electric field strength of 1 only an electric field strength of approx 0 01 can be detected in the radargram at the riverbed i e rather small signal these values do not include i radar internal noise ii temperature effects iii effects of water surface roughness fig 1 shows the different loss components in gpr transmission through the water surface propagation through water spreading through both air and water and reflection from the bed of the water body in case the antenna was water coupled transmission loss would be approx 0 and spreading loss would be only approx 3 87 db indeed a significant amount of the spreading loss occurs in air thus a water coupled gpr antenna would exhibit a smaller total loss than an elevated antenna specifically a water coupled antenna would have a total loss of 28 85 db instead of 41 2 db resulting in a significant increase 12 4 db in return signal when the antenna is water coupled this is demonstrated in panels b and c in fig 1 in which we show the experimental result of lifting a handheld 80 mhz gpr antenna from the water surface to 1 m altitude in furesø lake the radargram shows the return electric field strength of the gekko 80 antenna when water coupled around trace 20 and when elevated up to 1 m trace 430 the electric field strength of the return wave corresponding to the lakebed approximately 1 m water depth decreases from 5290 water coupled to approx 1190 bits when the antenna is elevated to 1 m above the water surface corresponding to 20 log10 5290 1190 12 9 db loss when the antenna is elevated thus comparable given the uncertainty in spreading loss to the theoretically computed value of 12 4 db the total loss consisting of transmission spreading propagation and reflection cannot be computed e g by comparing water surface and bottom electric field strength from fig 1 because manufacturer hardware gains are applied to each trace with return times greater than approx 30 ns to improve the gpr wave penetration through water 3 7 gpr sensors in recent years gpr manufactures have developed lightweight gpr units complying with the size and weight limitations of uas and with frequencies 40 120 mhz suitable for bathymetry measurements of non frozen waterbodies as shown in table 1 the gpr units from radarteam and geoscanners use a signal sampling technique called real time sampling rts rts significantly improves signal to noise ratio compared to the alternative interleaved sequential sampling whilst the malå systems use high dynamic range hdr which is similar to real time sampling all the gpr antennas of table 1 allow for 32 bit resolution which results in a theoretical dynamic range of 190 db and an effective dynamic range after averaging denoise filtering of approx 150 db the frequency of the antenna is a critical choice indeed a lower frequency gives lower attenuation coefficient thus lower propagation loss in water and lower spreading loss however it results in worse vertical resolution typically approximately one fourth of the wavelength in water jol 1995 thus approx 10 cm for 80 mhz and worse horizontal resolution 3 8 field instrumentation for this specific research the gpr antenna gekko 80 with rts1600 data processing unit was deployed as sonar the system deeper smart sonar chirp deeper uab lithuania was deployed this sonar records three different frequencies each of which correspond to a different scanning angle specifically 100 khz 47 240 khz 20 and 675 khz 7 the sonar has a maximum depth capability of 100 m and a minimum depth of 0 15 m 675 khz 0 6 m 240 khz and 0 8 m 100 khz measurements were acquired with all the three frequencies although the higher frequency ensures better vertical resolution and typically higher accuracy in shallow water the manufacturer suggests that the 240 khz frequency is less sensitive than the 675 khz frequency to all external factors such as waves wind sonar reeling and trolling the 100 khz frequency was tested because it gives better penetration which could potentially ensure better capability of penetrating aquatic vegetation the sonar when connected to a smartphone through the app fish deeper deeper uab lithuania displays the full waveform data in a colormap plot however from the logged data the user can extract only one numeric water depth value per scan corresponding to the value automatically estimated by the sonar software in real time interpretation of the full waveform plot the sonar can also be configured to send nmea 0183 messages containing depth and position data from the in built gnss receiver via wifi to external devices in addition to gpr and sonar the deployed system included i a gnss receiver zed f9p u blox switzerland equipped with an antcom 3g0xx16a4 xt 1 4 cert multiband antenna ii a single board computer beaglebone black beagleboard org the single board computer was programmed to i log sonar data ii log raw gnss observation and navigation messages and iii send nmea gpgga sentences to the gekko 80 processing unit the gpr system was tested both i in water coupled deployment on board an inflatable boat made of non conductive material and ii in drone borne deployment on board the hexacopter dji matrice 600 dji china the drone was equipped with a radar altimeter from ugcs ugcs sph engineering latvia this radar altimeter enables flight at constant and low altitude in automatic flight missions planned with ugcs ground station software fig 2 shows the water coupled and drone borne deployment of the gekko 80 system the inflatable boat was dragged along the cross section from one side of the river to the other or to a specific point in the lake case study the uas was flown over the same cross section while keeping a constant low altitude with the gpr antenna approx 0 5 0 6 m above the water surface an rtk gnss rover station consisting of a trimble rtk gnss r8s trimble inc usa mounted on a carbon fibre pole was deployed to retrieve i ground truth observations of the elevation of the bed of the water body ii water surface elevation wse i e elevation of the water surface above reference geoid 4 data processing 4 1 gnss processing the gnss data were processed in post processed kinematic ppk mode with the software rtklib demo5 b34b from https rtkexplorer com this specific version of rtklib which differs from the standard version available on https www rtklib com takasu and yasuda 2009 enables processing of observations retrieved on the l2c gps signal retrieved by the u blox zed f9p the used gnss reference station was either from a continuously operated reference station cors provided by gpsnet dk or a locally configured station comprised of a novatel flexpack6 receiver and a novatel gps 703 ggg pinwheel triple frequency 5 gpr processing the gpr data were processed in the software gprsoft geoscanners ab sweden according to the following sequence of steps the return from the water surface is identified to define the time zero reference point detection of water surface is performed with the gprsoft automated phase detection method in which the software tries to follow a layer throughout the radargram based on the phase of a user defined initial point which was selected on the water surface when the gpr is water coupled the water surface return is nearly a flat line when the gpr is drone borne the water surface return may wiggle because drone altitude above the water surface can fluctuate by a few cm the automatic phase detection is able to identify also a wiggling water surface however since the gpr waves travel 10 times faster in air than in water and because of the vertical resolution approx 10 cm of the gpr the effect of changing uas altitude typically only few cm on water surface return time is mostly negligible a background removal filter was applied to the radargram to increase the signal to noise ratio by removing the banded events the background removal is carried out by subtracting the moving average of the background noise from every trace in the gpr profile the signal power of the existing gpr signal was amplified using gains typically with logarithmic gain function the bathymetry layer was extracted by using the layer picking tool provided by gprsoft with automated phase detection after the riverbed layer is identified numeric values such as trace number return time and gnss coordinates are exported furthermore a file containing nmea gpgga messages is exported this file also contains information about the trace number at which each nmea sentence thus each utc timestamp was received the coordinates in the riverbed layer file are corrected with the ppk position computed in rtklib the ppk computed positions are matched with the observations of the riverbed layer file by using the relationship between utc timestamp and trace numbers return time of riverbed is converted into precise depth using the gpr wave speed in water vwater computed with eq 14 in which c is the speed in vacuum and εwater is the real component of relative permittivity of water the variable εwater was estimated as a function of water temperature with the relationship shown in malmberg and maryott 1956 14 v water c ε water 5 1 sonar processing the deeper smart sonar chirp provides nmea 0183 messages with depth and position from the in built gnss receiver since the in built gnss receiver cannot provide very accurate positions the utc timestamps contained in the nmea 0183 are used to match the ppk computed position so that the ppk computed position can be used to accurately re estimate sonar position 5 2 conversion from depth into bathymetry water depth observations retrieved by sonar or gpr are subtracted from wse retrieved by rtk gnss to compute bathymetry thus elevation of the bed of the water body referenced to the chosen datum in this research dvr90 geoid lastly the bathymetric measurements need to be assigned to a position along the cross section reference line which is defined by connecting the two reference points on the left and right streambanks the cross section line is thus divided into intervals of typically 0 2 m to each interval we assign the median of bathymetry measurements of each instrument gpr sonar or rtk gnss that are contained in that interval only observations with a maximum perpendicular distance from the observation to the cross section line of typically 4 m are included in the median the search radius of 4 m is chosen because the horizontal navigation accuracy of the uas is not always optimal and an offset of few meters with respect to the cross section line may occur 5 3 error statistics error statistics such as mean bias error mbe mean absolute error mae and root mean square error rmse were computed by comparing each rtk gnss depth measurements to the median of depth measurements sonar or gpr contained in the same cross section discretization interval if observations were available in that interval statistics were computed on depth not on bathymetry e g a positive mbe for gpr means that the gpr overestimates depth compared to rtk gnss 5 4 study areas the study area consists of two rivers guden å and its tributary nørreå and a lake furesø all of which are located in denmark as shown in fig 3 twelve cross sections in both guden å two in nørreå and one lake profile of approx 70 m in furesø were measured table 2 shows the characteristics for the sites including water temperature and electric conductivity measured with a commercial electric conductivity meter bottom type and vegetation density coordinates of markers located on left and right sides of the profiles and wse measured with rtk gnss furesø presented a sandy bottom while guden å presented a hard silty clay but with several soft clay patches and nørreå had a soft clay with high water content vegetation was absent in furesø in guden å aquatic vegetation was present in all cross sections but especially dense in some portions typically the areas closer to the streambanks of some cross sections the dominant plant species were batrachium and glyceria maxima with the height of the vegetation typically 0 4 0 7 times the water depth similarly in nørreå vegetation was sparser than in guden å but still present water coupled gpr was performed in all sites while sonar and drone borne gpr were performed in most sites but not all depending on uas availability 6 results in fig 4 and fig 5 we show the radargrams of four cross sections 3 in guden å and 1 in furesø while fig 6 compares the bathymetry results of gpr sonar three frequencies and ground truth rtk gnss the radargrams and the bathymetry comparison plots of all the other cross sections are reported in the supplementary material in the radargrams the blue line shows the identified water surface while the red line highlights the gpr return from the water body bed the red line is typically drawn by gprsoft with automated phase detection method while manual correction is performed by the user only in the small portions where automated detection fails typically close to the streambanks the radargrams show two significant differences when the antenna is drone borne left panels compared to when it is water coupled right panel i the electric field strength of the return from the bed of the water body is weaker and ii significantly higher noise level in the early portion of the radargram visible as the white black bands with strong electric field strength that propagate from the water surface until approx 70 100 ns the noise affecting those earlier times is presumably caused by surface cluttering and multipath indeed this noise level was not detected when the handheld gpr was elevated fig 1 the uas carbon fibre structure is suspected to create multiple reflections of the gpr wave furthermore compared to the handheld gpr case we may assume that the roughness on the water surface induced by the uas propellers can affect the water surface reflection loss change wave coherence and increase surface clutter arcone and calkins 1990 comite et al 2017 rappaport et al 2003 the case of furesø which presents minor bed elevation changes along the cross section as visible in fig 6 is representative of the surface clutter issue the noise completely covers the bottom return until the lake is at least 0 8 m deep when the gpr is drone borne whilst when the gpr is water coupled also a depth as shallow as 0 4 m can be detected however in guden å cross sections also water coupled gpr is unable to measure close to the stream banks a 1 2 m horizontal distance from stream edges are unmeasured for two main reasons i the gpr on board the inflatable boat cannot be dragged up to the exact land water edge ii the large gpr footprint is not ideal for measuring the streambanks with steep slopes causing larger errors in the measured depth close to the streambanks e g due to strong reflections from the dry part compared to deeper water as for the furesø case in guden å the drone borne gpr has also a minimum depth that is site dependant but is typically in the order of 1 m e g guden 13859 guden 13770 and guden 9158 in fig 6 and thus higher than for the water coupled case the minimum detectable depth can vary depending on factors such as i slope of the water body bed and ii distance from the streambanks in terms of riverbed slope typically higher slope improves the visibility of the returns from the riverbed in the radargram especially after background noise removal which typically removes flat horizontal bands such as the lines caused by surface clutter in terms of distance from streambanks portions of the water body that are the furthest away from the streambanks are easier to measure because the dry portion of the streambank creates returns that can hide the submerged portion this is especially critical in light of the fact that low frequency antennas such as the gekko 80 are unshielded and thus can detect radiation reflected from any direction the drone borne gpr profile in guden 9158 shows a deeper area in the centre of the river between 17 and 21 m from left bank that is not visible in water coupled gpr and rtk gnss among all case studies this is the only example of significant discrepancy between water coupled and drone borne gpr measurements however because the significant strength of the signal of both the water coupled and the drone borne gpr radargram in that deep portion it is assumed to be caused by the inaccuracy of uas navigation the uas was flown approx 3 4 m horizontal distance from the cross section line and thus the error in drone borne gpr may be associated with local riverbed heterogeneity along the river course in all the drone borne gpr surveys the gpr antenna was flown at a maximum height of approx 0 5 0 6 m because higher elevations showed higher noise level weaker bottom reflection and stronger reflection from the dry portions of the streambanks making identification of the water body bed more complex fig 4 and fig 5 show only one radargram for drone borne and water coupled gpr profile for each cross section however multiple profiles were acquired in each cross sections radargrams acquired by gpr at the same cross section were nearly identical thus gpr measurements are shown to be highly repeatable from fig 6 it is clear that the sonar measurements at 100 khz in furesø are faulty this is most likely caused by the sediment type and especially by too shallow depth for the 100 khz frequency despite a minimum depth of 0 8 m for the 100 khz the manufacturer suggests to use this frequency only for depths above 1 5 m on the other hand the survey in furesø highlights that the minimum depth for 240 khz is approx 0 6 m compared to sonar measurements the main advantage of gpr is that the gpr can sense through dense aquatic vegetation this is especially evident for the centre of the cross sections in guden 9021 and for the portions close to the streambanks in guden 13770 fig 6 b guden 14963 and guden 8370 in the areas which had high vegetation density according to the visual assessment reported in table 2 in those cross sections no sonar frequency including the 100 khz was able to precisely detect the river bed in densely vegetated areas guden 8370 shown in fig 7 demonstrates that sonar bathymetric measurements show an elevation higher than rtk gnss caused by the sonar wave reflection from the vegetation canopy indeed guden 8370 was highly vegetated on the right side as it was also shown in fig 2 in which the inflatable boat is standing on vegetation conversely drone borne and water coupled gpr were not affected by vegetation and were able to penetrate through the submerged canopy the statistics comparing all the depth measurements are shown in table 3 each statistic is computed by comparing the depth measurements of either sonar or gpr with rtk gnss table 3 shows that water coupled gpr shows slightly better mae compared to drone borne gpr in all cross sections apart from guden 13859 and guden 8828 however the main advantage of water coupled gpr is that it can measure more shallow water and closer to the streambanks average statistics are significantly better for gpr water coupled and drone borne than for any sonar frequency among the sonar frequencies the 100 khz shows the worst performance as expected from the worst resolution and because it typically penetrates below soft bottoms whilst the 675 khz shows the best performance apart from guden 13770 240 khz is slightly better guden 14963 and nørreå 43716 however in guden 14963 and nørreå 43716 this is an artifactcaused by the fact that the 675 khz was unable because of connectivity issues to acquire fully continuous observations in the centre of the cross section thus the statistics of the diffferent sonar frequencies are not comparable for those two cross sections indeed the sample size for the statistics computation is smaller for 675 khz compared to the other two frequencies the last row of table 3 reports the average statistics among all sites however direct comparison of the averaged statistics of different instruments should be performed with caution as sonar or drone borne gpr measurements are missing in some sites the averaged statistics show that a mae of approx 8 cm a mbe of approx 2 cm and a rmse of approx 10 cm are achievable with drone borne gpr whilst similar statistics are achieved with water coupled gpr but on a larger number of sites in some cross sections e g guden 8917 guden 9021 and guden 9158 for water coupled gpr rmse is significantly worse than mae this is because rmse is more sensitive to outliers specifically large errors occurring in the steep streambanks close to the water s edge in locations where gpr is reaching the minimum depth capability the cross section in nørreå 43716 measured with water coupled gpr and sonar shows the worst statistics in terms of mae and mbe for gpr which may be caused by overestimation of depth in this cross section that presented soft bottom among the sonar frequencies 675 khz and 240 khz show negative bias which translates into underestimation of water depth vegetation effect whilst 100 khz shows positive bias which may indicate penetration below the bed of the water body 7 discussion we demonstrated that drone borne gpr measurements are feasible in waterbodies with a conductivity up to 340 μs cm and a depth up to 2 5 m gpr shows slightly worse statistics depth overestimation in a cross section with soft bottom when compared to rtk gnss gpr was not tested in waterbodies with higher conductivity or higher water depths thus the possibility of deploying drone borne gpr measurements in those conditions remains unknown especially because the propagation loss increases with electric conductivity and with depth our research shows that gpr measurements give significantly better results than sonar in measuring bathymetry when compared to ground truth ground truth was taken with rtk gnss which has a typical nominal vertical accuracy of approx 2 5 cm furthermore when measuring soft riverbeds the accuracy degrades because it is difficult to keep the bottom plate of the rtk gnss pole exactly at the bed level instead of penetrating a few centimetres into the sediment furthermore stones and local heterogeneities can complicate direct comparison between rtk gnss and the footprint of gpr or sonar additionally nobes et al 2018 found that also suspended sediments can have an influence on the accuracy of gpr bathymetric measurements for these reasons the achieved mae of approx 8 cm for gpr both drone borne and water coupled when compared to rtk gnss is considered satisfactory however drone borne gpr requires a minimum water depth of ca 1 m and shows worst results close to the streambanks thus is not applicable in narrow and very shallow rivers furthermore the low flight altitude requirement for drone borne gpr can also significantly complicate navigation in narrow rivers with riparian vegetation rtk gnss bathymetric measurements typically have a degree of subjectivity when the operator chooses the exact point where to measure e g avoiding to measure on stones or taking measurements on stones thus different surveys can result in slightly different results unless measurements are taken at the exact same cross section location on the other hand gpr surveys have always shown a high degree of repeatability thus multiple profiles retrieved along the same cross sections give nearly identical radargrams however a small degree of subjectivity is left to the user in choosing i the return from the water surface and ii the first point on the return from the bottom especially in portions of the radargram where the automated phase detection method fails thus different experienced users could extract slightly different depth observations typically in the range of 5 10 cm from the same radargram especially in the areas close to the streambanks regarding sonar deployment future research could investigate the usage of a higher frequency sonar above 1 mhz to have a better accuracy at shallow depths furthermore the deployed sonar provides water depth measurements in real time from automatic full waveform interpretation however if the user had the possibility to extract the full waveform as tabulated data enhanced removal of vegetation and better interpretation of the bottom return from the full waveform data could improve results in post processing finally integration of drone borne gpr with techniques such as drone borne topographic lidar or photogrammetry could be performed for estimating the elevation of both submerged gpr and dry topographic lidar portions of the cross sections while interpolation could be performed in the areas between dry and submerged parts 8 conclusions this study assessed the performance of a water coupled and drone borne gpr for mapping bathymetry in inland water bodies significant signal losses especially due to water surface reflection and spreading through air affect elevated gpr antennas compared to water coupled gpr these losses were computed and subsequently demonstrated with an experiment in which a handheld antenna elevated at approx 1 m above the water surface was compared to a water coupled gpr field measurements of bathymetry were taken in three different sites total surveyed cross sections 15 of which 1 in a lake with drone borne gpr water coupled gpr data sonar and ground truth rtk gnss the following results were obtained both water coupled and drone borne gpr measurements with gpr antenna flown at approx 0 5 m above the water surface could detect the bed of the waterbodies two factors are required to effectively map bathymetry with drone borne gpr i a maximum gpr elevation above the water surface of approx 0 5 m and ii a minimum water depth in the range 0 8 1 1 m depending on the inclination of the riverbed and distance to streambanks compared to drone borne gpr water coupled gpr can measure shallower water depth as low as 0 3 0 4 m as the noise caused by surface clutter on the early portions of the radargram does not occur when the gpr antenna is water coupled both water coupled and drone borne gpr provided accurate results with an average mae of approx 8 cm thus similar to the vertical resolution of the gpr at this frequency compared to in situ rtk gnss no significant bias was identified in gpr measurements compared to rtk gnss the applicability of the gpr bathymetry monitoring solution was not limited by the conditions at the chosen survey sites in relation to aquatic vegetation water electric conductivity tested up to 340 µs cm or maximum water depth tested up to 2 5 m gpr was applicable also in waterbodies with soft clay bed but resulted in slightly worse statistics when compared to ground truth the sonar provided unreliable biased results in vegetated water bodies but performed well in non vegetated water bodies when operated at 240 khz and 675 khz funding this work was supported by the project mapping of depth and sediment layer thickness of freshwater bodies with ground penetrating radar gpr onboard drones within the vis europas grønne region innovative løsninger på vandområdet framework funded by the european regional development fund and the projects riverscapes file number 7048 00001b and chinawatersense file number 8087 00002b funded by the innovation fund denmark innovationsfonden credit authorship contribution statement filippo bandini conceptualization methodology data curation visualization software investigation validation writing original draft writing review editing funding acquisition lukas kooij investigation validation bjørn karl mortensen conceptualization methodology investigation software marie boeskov caspersen conceptualization methodology investigation software lasse gammelby thomsen investigation validation daniel olesen methodology resources funding acquisition peter bauer gottwein conceptualization methodology data curation visualization investigation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank niels henrik broge and mark lyon from geopartner inspections a s for collaboration and co financing in the vis project we thank wsp engineering consulting firm for sharing the ground truth rtk gnss observations in situ observations were acquired independently by a professional operator from wsp to perform an independent accuracy validation test of the bathymetric observations appendix a a total loss coefficient was computed for both the water coupled gpr and drone borne gpr the values of the variables used for computing the different losses are shown in table a1 some of these variables are sensitive to temperature for example εwater varies significantly with water temperature from 80 at 20 to 87 7 at 0 andryieuski et al 2015 malmberg and maryott 1956 similarly a 2 increase of σwater per 1 c increase of water temperature typically occurs hayashi 2004 the variables εwater and ε water also depend on the angular frequency of the gpr wave andryieuski et al 2015 however for frequencies below 1 ghz as for the gprs used for bathymetry the frequency effect on εwater is not significant in the supplementary material an example of calculations of the different loss coefficients is documented as a jupyter notebook for example using the variable values from table a1 the losses of table a2 were computed 
2630,bathymetry of inland water bodies is essential for river maintenance and flood risk management traditionally in shallow water bodies bathymetry is retrieved by operators wading through the water body with real time kinematic rtk global navigation satellite system gnss whilst in deeper waters it is retrieved with sonar instruments on manned or unmanned boats in the past researchers have documented the use of ground penetrating radar gpr on boats i e water coupled gpr for monitoring the bathymetry of frozen and non frozen water bodies furthermore gpr has been used on helicopters for monitoring ice and snow thickness however deployment of gpr on board unmanned aerial systems uass in non frozen inland water bodies with electric conductivity higher than 100 μs cm as is common in most inland waterbodies in non polar regions is unexplored in this paper we document the possibility to use drone borne and water coupled gpr in several cross sections located in three different waterbodies 1 lake and 2 rivers in denmark these waterbodies had different bed sediment materials and vegetation conditions an electric conductivity varying from 200 to 340 μs cm and depths up to 2 5 m drone borne gpr showed accuracy similar to water coupled gpr when compared to rtk gnss ground truth measurements with a mean absolute error mae of approx 8 cm the only limitations of drone borne gpr were i more restrictive minimum depth requirement typically 0 8 1 1 m for drone borne gpr while 0 3 0 4 m for water coupled gpr ii requirement to fly the gpr antenna at altitudes of approx 0 5 m above the water surface to avoid high spreading losses and strong surface clutter events hiding the signal finally gpr measurements were benchmarked against traditional sonar measurements showing that gpr measurements significantly outperform sonar measurements in waterbodies with medium or high density of aquatic vegetation keywords uas drone water depth bathymetry sonar gpr data availability the dataset used in the study are available online in the repository archived in zenodo org https doi org 10 5281 zenodo 5069749 the repository contains the supplementary material specifically i jupyter notebook with the calculations and plots of the gpr loss components ii all the radargrams iii the processed sonar and gpr observations in text format and iv the plots comparing bathymetry retrieved with the different instruments additional data will be made available on request 1 introduction bathymetric surveys are typically conducted to measure water depth and map the underwater features of a water body bathymetry of inland waterbodies plays a critical role in many hydrological and hydraulic problems and applications indeed the hydrological regime of a lake is largely dependent on its bathymetry yao et al 2018 and similarly the predictive skills of river hydrodynamic models depend on the accuracy of river cross section shape datasets grimaldi et al 2018 to optimize river maintenance and improve flood forecasting bathymetry should be retrieved at regular time intervals with high spatial resolution alsdorf et al 2007 cook and merwade 2009 indeed the temporal variability of bathymetry which is typically caused by processes such as sedimentation erosion and human intervention e g bottom dredging can significantly change the frequency of overbank flooding under the same peak discharge conditions lane et al 2007 stover and montgomery 2001 similarly the high spatial variability of bathymetry along the river course may require continuous or very high resolution mapping to accurately characterise the river morphology and geology diaconu et al 2019 merwade 2009 to acquire bathymetric data different techniques can be used as described in the next sections 2 rtk gnss surveys in shallow water the conventional way of measuring river bathymetry is through cross sectional surveys with rtk gnss at certain locations along the river however these surveys typically require significant man power and are time consuming thus the ratio cost area covered is very high and investigation is typically limited to few cross sections bangen et al 2014 feurer et al 2008 2 1 sonar in navigable rivers river bathymetry is typically measured with single beam or multi beam sonar on board manned or unmanned vessels bio et al 2020 halmai et al 2020 leyland et al 2017 specht et al 2020 stateczny et al 2019 young et al 2017 however sonar systems have limitations especially for the most commonly used frequencies less than 1 mhz in measuring very shallow depths due to surface clutter and multipath effects albright blomberg et al 2013 furthermore the accuracy of sonar significantly degrades in vegetated rivers helminen et al 2019 indeed the high level of reflection of sound waves from the vegetation can result in depth measurements within vegetation canopy sabol 2002 additionally deployment of boats can be complicated in remote areas and is limited to navigable water or especially for unmanned vessels locations without dense floating aquatic vegetation to alleviate the issues of sonar deployment in remote areas or non navigable rivers researchers alvarez et al 2018 bandini et al 2018 and recently companies e g uggs sph engineering latvia and thurn group uk developed sonar systems tethered to an unmanned aerial system uas however the tethered sonar has to remain in contact with water throughout the survey which complicates automatic pilot flights and reduces the possibility to perform beyond visual line of sight flights 2 2 remote sensing methods to overcome the limitations of in situ surveys researchers have developed remote sensing methods to estimate water depth these methods can be categorized into indirect methods which determine the flow area or the mean water depth and direct methods which determine the full bathymetric shape indirect remote sensing methods are based for instance on estimating mean depth from satellite measurements of water surface elevation wse and modelled discharge leon et al 2006 or estimating flow area from wse and cross section mean flow velocity moramarco et al 2019 the focus of this paper is on direct methods which are able to directly observe submerged topography and reconstruct the full cross section shape direct methods to observe bathymetry include i through water photogrammetry ii spectral methods iii bathymetric lidar through water photogrammetry is based on structure from motion sfm algorithms applied to uas imagery and requires correction for the distinct refractive indices of water and air alvarez et al 2018 bagheri et al 2015 dietrich 2016 feurer et al 2008 lane et al 2010 tamminga et al 2014 westaway et al 2001 woodget et al 2015 spectral methods are mostly based on the wavelength dependent exponential attenuation of light in the water column and exploit the correlation between depth and reflectance as according to lyzenga 1978 or stumpf et al 2003 spectral methods to estimate water depth of inland waterbodies have been applied to multispectral or hyperspectral and rgb images from i satellites geyman and maloof 2019 jagalingam et al 2015 lyons et al 2011 muzirafuti et al 2020 wei et al 2020 ii aircrafts carbonneau et al 2006 flener et al 2012 legleiter 2012 marcus et al 2003 and iii uass flener et al 2013 lejot et al 2007 rossi et al 2020 to combine the advantages of the spectral approach which performs better when the sediment is comparatively homogeneous legleiter et al 2009 overstreet and legleiter 2017 and the photogrammetry approach which performs better if the bottom is sufficiently textured to enable feature matching and ensures higher spatial resolution feurer et al 2008 hybrid approaches have been demonstrated slocum et al 2020 starek and giessel 2017 however both spectral and photogrammetry methods are limited to waterbodies with high water clarity and can deliver results only for depths lower than the secchi depth thus these passive remote sensing methods are typically applied to i shallow coastal areas or ii in rivers with sandy or gravel bottom and water depth less than 1 1 5 m brasington et al 2003 marcus et al 2002 winterbottom and gilvear 1997 woodget et al 2015 to overcome the limitations of passive sensors active sensors such as bathymetric lidar systems typically using green wavelength have been used to monitor bathymetry of inland waterbodies from aircrafts bailly et al 2010 charlton et al 2003 hilldale and raff 2008 kinzel et al 2013 2007 lague and feldmann 2020 pan et al 2015 and recently also from satellite missions such as icesat 2 ma et al 2020 parrish et al 2019 the cost weight and size of bathymetric lidar systems challenge uas deployment however in the last 5 years green lidar systems which comply with the payload weight restrictions of uas have entered the market such as the i laser profiler riegl bdf 1 mandlburger et al 2016 ii the scanning lidar systems astralite edge lidar kinzel and legleiter 2019 iii the scanning lidar tdot green amuse oneself inc japan furthermore chen et al 2021 reported the design and performance of a photon counting bathymetric lidar based on a fiber laser pumped green laser the main limitations of the commercial lidar systems are i their cost typically more than 150 000 euros ii their penetration capability only up to 1 1 5 times the secchi depth iii the uncertain performance for low reflectivity bottom types and dense aquatic vegetation 2 3 gpr in frozen water bodies ground penetrating radar gpr or more accurately water penetrating radar outperforms other bathymetric remote sensing techniques because of the high penetration of gpr waves in ice and snow due to the low electric conductivity and low dielectric permittivity of these two media in these applications gpr can be deployed directly on the ice surface lapazaran et al 2016 liu et al 2014 2013 moorman and michel 1997 saintenoy et al 2013 shean and marchant 2010 yoshikawa et al 2006 or also from helicopters grab et al 2018 kovacs 1979 machguth et al 2006 merz et al 2015 rutishauser et al 2016 however in freshwater waterbodies the high electric conductivity and high relative dielectric permittivity of water 80 make gpr based bathymetry monitoring of freshwater significantly more complex than monitoring of ice or snow while the use of gpr deployed water coupled from boats has been documented to successfully monitor bathymetry in lakes haeni 1996 kidmose et al 2013 2011 lachhab et al 2015 sambuelli and bava 2012 swain 2018 and rivers sambuelli et al 2009 air launched gpr antennas are less commonly described in the literature for bathymetric measurements of non frozen waterbodies indeed gpr penetration in deep water is dramatically reduced when the antenna is not water coupled because of transmission reflection and spreading losses delaney et al 1990 and because the rough water surface severely degrades the coherence of the water surface transmission arcone and calkins 1990 some tests have been performed with gpr antennas mounted on suspended cableways costa et al 2006 2000 mason 2004 nobes et al 2018 spicer et al 1997 however at present only one reference to helicopter borne gpr monitoring of freshwater bathymetry is found melcher et al 2002 although the characteristics of the sites such as electric conductivity were not given helicopter borne deployment significantly reduces the survey time compared to water coupled gpr indeed melcher et al 2002 reported that the helicopter could be flown at a low altitude few meters above the surface covering three sites located 100 km from each other within 60 min gpr mounted on uass would also increase survey speed compared to water coupled gprs and would allow for low altitude flights which are significantly less dangerous with uass than with manned helicopters in this paper we show water coupled and drone borne gpr bathymetric measurements of freshwater bodies with electric conductivity between 200 and 340 µs cm we also demonstrate the advantage of using gpr compared to sonar in highly vegetated shallow less than 2 5 m waterbodies 3 methodology in this chapter we first summarize the main equations that describe the theoretical background of gpr detection of bathymetry then we describe the survey methodology and the study areas 3 1 theoretical background gpr detection of bathymetry the gpr signal is significantly attenuated when travelling from air into the water body through the water body and finally reflected from the bottom of the water body the total loss coefficient αtotal estimates the ratio between the emitted power pemitted and received power preceived or the ratio between emitted electric field strength eemitted and received electric field strength ereceived as shown in eq 1 the total loss coefficient αtotal describes the losses involved in gpr signal propagation from the gpr transmitter to the receiver through the water body and can be calculated by adding up the individual losses as shown in eq 2 in which we have i the transmission loss αtrans through the air water interface ii the reflection loss αr from the bottom of the water body iii the propagation loss αp in water iv the spreading loss αspread in air and water in αtotal we did not include losses such as i radar system internal losses ii temperature related losses 1 α total 10 log 10 p received p emitted 20 log 10 e received e emitted 2 α total α trans α r α p α spread 3 2 transmission loss as the gpr wave propagates into water it suffers a transmission loss α trans at the surface which can be calculated with eq 3 as according to jiang and georgakopoulos 2011 and is equal to 8 9 db for air water transmission 3 α t r a n s 2 10 l o g 10 t 2 r e η a i r η w a t e r 4 t 2 η w a t e r η w a t e r η a i r in eq 3 multiplication by 2 is done because the wave needs to travel through the water surface twice in the equation η is the intrinsic impedance computed from the dielectric permittivity specifically ηair of air or ηwater of water re indicates the real part of the complex number t is the transmission coefficient given by eq 4 in the formulation of the transmission loss coefficient we do not consider that the transmission loss may be increased because of the water roughness induced by the downwash generated by a low altitude flying uas however in real world scenario this roughness would indeed increase surface cluttering rappaport et al 2003 affect wave coherence arcone and calkins 1990 and increase the spreading of the gpr waves exiting water thus decreasing the amount of radiation that the receiver acquires 3 3 propagation loss the attenuation of the gpr wave in water can be described through the coefficient αatten np m eq 5 which is reported in annan 2009 shows that the coefficient of attenuation αatten is a function of i the absolute magnetic permeability of water µabs water ii the real part of the absolute permittivity value of water εabs water iii the effective electric conductivity of water σe water the absolute permittivity of water is obtained by multiplying the real component of the relative permittivity εwater by the permittivity of free space ε0 similarly µabs water is obtained by multiplying the relative magnetic permeability of water µwater 1 by magnetic permeability of free space µ0 effective conductivity σe water can be computed through eq 6 cassidy 2009 which contains the static electric conductivity of water σwater the imaginary component of the absolute permittivity of water ε abs water and the angular frequency of the gpr ω the imaginary component of the absolute permittivity of water is obtained by multiplying the imaginary component of the relative permittivity by the permittivity of free space giannoukos et al 2017 different approaches exist to compute the gpr frequency and thus the angular frequency in the medium such as using the centre frequency of the emitted wave lambot et al 2004 schwamborn et al 2002 the entire bandwidth huisman et al 2003 the frequency of the received wave or the dominant frequency expressed as 80 of the nominal centre frequency grimm et al 2006 pérez gracia et al 2008 in this research the last approach was adopted the gpr frequency in water was considered equal to 80 of the nominal centre frequency and thus the angular frequency was computed accordingly as according to jiang and georgakopoulos 2011 the propagation loss αp in db m can be calculated with eq 7 in which d is water depth and the factor two is due to the double pass in water 5 α atten μ a b s w a t e r ε a b s w a t e r σ water e 2 6 σ water e σ water ω ε a b s w a t e r 7 α p 2 10 log 10 e 2 α atten d 3 4 reflection loss reflection loss αr is calculated the same way as transmission losses but by using the reflection coefficient r as shown in eq 8 the reflection loss coefficient is highly dependent on the impedance of the riverbed sediment material reflecting the wave as shown in eq 9 annan 2009 reynolds 1997 8 α r 10 log 10 r 2 9 r ε s e d i m e n t ε w a t e r ε w a t e r ε s e d i m e n t η w a t e r η s e d i m e n t η w a t e r η s e d i m e n t 3 5 spreading loss spreading loss which is related to the flight height and water depth can be calculated with eq 10 where afootprint directwave is the footprint of the direct wave as received by the receiver and afootprint riverbed is the footprint at the river bottom computation of the gpr footprint is complicated and has been approximated by different authors with different equations pérez gracia et al 2008 in this case we applied eq 11 to compute the first fresnel zone and estimate the radius at the water surface rfootprint watersurface from the wavelength in air λair and the flight height h above the water surface as according to leucci and negri 2006 and utsi 2004 this equation is chosen because pérez gracia et al 2008 proved with their experiments in water tanks that it can give a footprint approximation better than other common equations typically used to estimate the footprint such as the equations found in leckebusch and peikert 2001 or conyers 2004 which provide a conservative estimation of the antenna s horizontal resolution capability pérez gracia et al 2008 experimental results determining the footprint when the gpr wave crosses multiple media such as air and water were not found however we here assume that the same equation eq 11 can be applied and thus the radius at the bottom of the water body rfootprint riverbed is computed with eq 12 which is basically a sum of the radius at the water surface after the gpr wave travels through air and the radius at the water bottom if the gpr was water coupled thus the second part of eq 12 contains also the wavelength in water λwater and water depth d with the assumption that the footprint is a perfect circle the area afootprint riverbed can be computed with eq 13 a critical factor in footprint calculation is the choice of the frequency from which to estimate the wavelength in air or water here for computing λair we use the centre frequency of the gekko 80 80 mhz whilst for computing λwater we use the dominant frequency in water i e 80 of the centre frequency 10 α s p r e a d 10 l o g 10 a f o o t p r i n t d i r e c t w a v e a f o o t p r i n t r i v e r b e d 11 r footprint w a t e r s u r f a c e h λ air 4 2 h 2 12 r footprint r i v e r b e d r footprint w a t e r s u r f a c e d λ water 4 2 d 2 13 a f o o t p r i n t r i v e r b e d π r f o o t p r i n t r i v e r b e d 2 3 6 total loss the total loss can be computed with eq 2 an example of computation of total loss is shown in appendix a with a detailed calculation reported in the supplementary material the computed total loss of 41 2 db means that out of a transmitted wave with electric field strength of 1 only an electric field strength of approx 0 01 can be detected in the radargram at the riverbed i e rather small signal these values do not include i radar internal noise ii temperature effects iii effects of water surface roughness fig 1 shows the different loss components in gpr transmission through the water surface propagation through water spreading through both air and water and reflection from the bed of the water body in case the antenna was water coupled transmission loss would be approx 0 and spreading loss would be only approx 3 87 db indeed a significant amount of the spreading loss occurs in air thus a water coupled gpr antenna would exhibit a smaller total loss than an elevated antenna specifically a water coupled antenna would have a total loss of 28 85 db instead of 41 2 db resulting in a significant increase 12 4 db in return signal when the antenna is water coupled this is demonstrated in panels b and c in fig 1 in which we show the experimental result of lifting a handheld 80 mhz gpr antenna from the water surface to 1 m altitude in furesø lake the radargram shows the return electric field strength of the gekko 80 antenna when water coupled around trace 20 and when elevated up to 1 m trace 430 the electric field strength of the return wave corresponding to the lakebed approximately 1 m water depth decreases from 5290 water coupled to approx 1190 bits when the antenna is elevated to 1 m above the water surface corresponding to 20 log10 5290 1190 12 9 db loss when the antenna is elevated thus comparable given the uncertainty in spreading loss to the theoretically computed value of 12 4 db the total loss consisting of transmission spreading propagation and reflection cannot be computed e g by comparing water surface and bottom electric field strength from fig 1 because manufacturer hardware gains are applied to each trace with return times greater than approx 30 ns to improve the gpr wave penetration through water 3 7 gpr sensors in recent years gpr manufactures have developed lightweight gpr units complying with the size and weight limitations of uas and with frequencies 40 120 mhz suitable for bathymetry measurements of non frozen waterbodies as shown in table 1 the gpr units from radarteam and geoscanners use a signal sampling technique called real time sampling rts rts significantly improves signal to noise ratio compared to the alternative interleaved sequential sampling whilst the malå systems use high dynamic range hdr which is similar to real time sampling all the gpr antennas of table 1 allow for 32 bit resolution which results in a theoretical dynamic range of 190 db and an effective dynamic range after averaging denoise filtering of approx 150 db the frequency of the antenna is a critical choice indeed a lower frequency gives lower attenuation coefficient thus lower propagation loss in water and lower spreading loss however it results in worse vertical resolution typically approximately one fourth of the wavelength in water jol 1995 thus approx 10 cm for 80 mhz and worse horizontal resolution 3 8 field instrumentation for this specific research the gpr antenna gekko 80 with rts1600 data processing unit was deployed as sonar the system deeper smart sonar chirp deeper uab lithuania was deployed this sonar records three different frequencies each of which correspond to a different scanning angle specifically 100 khz 47 240 khz 20 and 675 khz 7 the sonar has a maximum depth capability of 100 m and a minimum depth of 0 15 m 675 khz 0 6 m 240 khz and 0 8 m 100 khz measurements were acquired with all the three frequencies although the higher frequency ensures better vertical resolution and typically higher accuracy in shallow water the manufacturer suggests that the 240 khz frequency is less sensitive than the 675 khz frequency to all external factors such as waves wind sonar reeling and trolling the 100 khz frequency was tested because it gives better penetration which could potentially ensure better capability of penetrating aquatic vegetation the sonar when connected to a smartphone through the app fish deeper deeper uab lithuania displays the full waveform data in a colormap plot however from the logged data the user can extract only one numeric water depth value per scan corresponding to the value automatically estimated by the sonar software in real time interpretation of the full waveform plot the sonar can also be configured to send nmea 0183 messages containing depth and position data from the in built gnss receiver via wifi to external devices in addition to gpr and sonar the deployed system included i a gnss receiver zed f9p u blox switzerland equipped with an antcom 3g0xx16a4 xt 1 4 cert multiband antenna ii a single board computer beaglebone black beagleboard org the single board computer was programmed to i log sonar data ii log raw gnss observation and navigation messages and iii send nmea gpgga sentences to the gekko 80 processing unit the gpr system was tested both i in water coupled deployment on board an inflatable boat made of non conductive material and ii in drone borne deployment on board the hexacopter dji matrice 600 dji china the drone was equipped with a radar altimeter from ugcs ugcs sph engineering latvia this radar altimeter enables flight at constant and low altitude in automatic flight missions planned with ugcs ground station software fig 2 shows the water coupled and drone borne deployment of the gekko 80 system the inflatable boat was dragged along the cross section from one side of the river to the other or to a specific point in the lake case study the uas was flown over the same cross section while keeping a constant low altitude with the gpr antenna approx 0 5 0 6 m above the water surface an rtk gnss rover station consisting of a trimble rtk gnss r8s trimble inc usa mounted on a carbon fibre pole was deployed to retrieve i ground truth observations of the elevation of the bed of the water body ii water surface elevation wse i e elevation of the water surface above reference geoid 4 data processing 4 1 gnss processing the gnss data were processed in post processed kinematic ppk mode with the software rtklib demo5 b34b from https rtkexplorer com this specific version of rtklib which differs from the standard version available on https www rtklib com takasu and yasuda 2009 enables processing of observations retrieved on the l2c gps signal retrieved by the u blox zed f9p the used gnss reference station was either from a continuously operated reference station cors provided by gpsnet dk or a locally configured station comprised of a novatel flexpack6 receiver and a novatel gps 703 ggg pinwheel triple frequency 5 gpr processing the gpr data were processed in the software gprsoft geoscanners ab sweden according to the following sequence of steps the return from the water surface is identified to define the time zero reference point detection of water surface is performed with the gprsoft automated phase detection method in which the software tries to follow a layer throughout the radargram based on the phase of a user defined initial point which was selected on the water surface when the gpr is water coupled the water surface return is nearly a flat line when the gpr is drone borne the water surface return may wiggle because drone altitude above the water surface can fluctuate by a few cm the automatic phase detection is able to identify also a wiggling water surface however since the gpr waves travel 10 times faster in air than in water and because of the vertical resolution approx 10 cm of the gpr the effect of changing uas altitude typically only few cm on water surface return time is mostly negligible a background removal filter was applied to the radargram to increase the signal to noise ratio by removing the banded events the background removal is carried out by subtracting the moving average of the background noise from every trace in the gpr profile the signal power of the existing gpr signal was amplified using gains typically with logarithmic gain function the bathymetry layer was extracted by using the layer picking tool provided by gprsoft with automated phase detection after the riverbed layer is identified numeric values such as trace number return time and gnss coordinates are exported furthermore a file containing nmea gpgga messages is exported this file also contains information about the trace number at which each nmea sentence thus each utc timestamp was received the coordinates in the riverbed layer file are corrected with the ppk position computed in rtklib the ppk computed positions are matched with the observations of the riverbed layer file by using the relationship between utc timestamp and trace numbers return time of riverbed is converted into precise depth using the gpr wave speed in water vwater computed with eq 14 in which c is the speed in vacuum and εwater is the real component of relative permittivity of water the variable εwater was estimated as a function of water temperature with the relationship shown in malmberg and maryott 1956 14 v water c ε water 5 1 sonar processing the deeper smart sonar chirp provides nmea 0183 messages with depth and position from the in built gnss receiver since the in built gnss receiver cannot provide very accurate positions the utc timestamps contained in the nmea 0183 are used to match the ppk computed position so that the ppk computed position can be used to accurately re estimate sonar position 5 2 conversion from depth into bathymetry water depth observations retrieved by sonar or gpr are subtracted from wse retrieved by rtk gnss to compute bathymetry thus elevation of the bed of the water body referenced to the chosen datum in this research dvr90 geoid lastly the bathymetric measurements need to be assigned to a position along the cross section reference line which is defined by connecting the two reference points on the left and right streambanks the cross section line is thus divided into intervals of typically 0 2 m to each interval we assign the median of bathymetry measurements of each instrument gpr sonar or rtk gnss that are contained in that interval only observations with a maximum perpendicular distance from the observation to the cross section line of typically 4 m are included in the median the search radius of 4 m is chosen because the horizontal navigation accuracy of the uas is not always optimal and an offset of few meters with respect to the cross section line may occur 5 3 error statistics error statistics such as mean bias error mbe mean absolute error mae and root mean square error rmse were computed by comparing each rtk gnss depth measurements to the median of depth measurements sonar or gpr contained in the same cross section discretization interval if observations were available in that interval statistics were computed on depth not on bathymetry e g a positive mbe for gpr means that the gpr overestimates depth compared to rtk gnss 5 4 study areas the study area consists of two rivers guden å and its tributary nørreå and a lake furesø all of which are located in denmark as shown in fig 3 twelve cross sections in both guden å two in nørreå and one lake profile of approx 70 m in furesø were measured table 2 shows the characteristics for the sites including water temperature and electric conductivity measured with a commercial electric conductivity meter bottom type and vegetation density coordinates of markers located on left and right sides of the profiles and wse measured with rtk gnss furesø presented a sandy bottom while guden å presented a hard silty clay but with several soft clay patches and nørreå had a soft clay with high water content vegetation was absent in furesø in guden å aquatic vegetation was present in all cross sections but especially dense in some portions typically the areas closer to the streambanks of some cross sections the dominant plant species were batrachium and glyceria maxima with the height of the vegetation typically 0 4 0 7 times the water depth similarly in nørreå vegetation was sparser than in guden å but still present water coupled gpr was performed in all sites while sonar and drone borne gpr were performed in most sites but not all depending on uas availability 6 results in fig 4 and fig 5 we show the radargrams of four cross sections 3 in guden å and 1 in furesø while fig 6 compares the bathymetry results of gpr sonar three frequencies and ground truth rtk gnss the radargrams and the bathymetry comparison plots of all the other cross sections are reported in the supplementary material in the radargrams the blue line shows the identified water surface while the red line highlights the gpr return from the water body bed the red line is typically drawn by gprsoft with automated phase detection method while manual correction is performed by the user only in the small portions where automated detection fails typically close to the streambanks the radargrams show two significant differences when the antenna is drone borne left panels compared to when it is water coupled right panel i the electric field strength of the return from the bed of the water body is weaker and ii significantly higher noise level in the early portion of the radargram visible as the white black bands with strong electric field strength that propagate from the water surface until approx 70 100 ns the noise affecting those earlier times is presumably caused by surface cluttering and multipath indeed this noise level was not detected when the handheld gpr was elevated fig 1 the uas carbon fibre structure is suspected to create multiple reflections of the gpr wave furthermore compared to the handheld gpr case we may assume that the roughness on the water surface induced by the uas propellers can affect the water surface reflection loss change wave coherence and increase surface clutter arcone and calkins 1990 comite et al 2017 rappaport et al 2003 the case of furesø which presents minor bed elevation changes along the cross section as visible in fig 6 is representative of the surface clutter issue the noise completely covers the bottom return until the lake is at least 0 8 m deep when the gpr is drone borne whilst when the gpr is water coupled also a depth as shallow as 0 4 m can be detected however in guden å cross sections also water coupled gpr is unable to measure close to the stream banks a 1 2 m horizontal distance from stream edges are unmeasured for two main reasons i the gpr on board the inflatable boat cannot be dragged up to the exact land water edge ii the large gpr footprint is not ideal for measuring the streambanks with steep slopes causing larger errors in the measured depth close to the streambanks e g due to strong reflections from the dry part compared to deeper water as for the furesø case in guden å the drone borne gpr has also a minimum depth that is site dependant but is typically in the order of 1 m e g guden 13859 guden 13770 and guden 9158 in fig 6 and thus higher than for the water coupled case the minimum detectable depth can vary depending on factors such as i slope of the water body bed and ii distance from the streambanks in terms of riverbed slope typically higher slope improves the visibility of the returns from the riverbed in the radargram especially after background noise removal which typically removes flat horizontal bands such as the lines caused by surface clutter in terms of distance from streambanks portions of the water body that are the furthest away from the streambanks are easier to measure because the dry portion of the streambank creates returns that can hide the submerged portion this is especially critical in light of the fact that low frequency antennas such as the gekko 80 are unshielded and thus can detect radiation reflected from any direction the drone borne gpr profile in guden 9158 shows a deeper area in the centre of the river between 17 and 21 m from left bank that is not visible in water coupled gpr and rtk gnss among all case studies this is the only example of significant discrepancy between water coupled and drone borne gpr measurements however because the significant strength of the signal of both the water coupled and the drone borne gpr radargram in that deep portion it is assumed to be caused by the inaccuracy of uas navigation the uas was flown approx 3 4 m horizontal distance from the cross section line and thus the error in drone borne gpr may be associated with local riverbed heterogeneity along the river course in all the drone borne gpr surveys the gpr antenna was flown at a maximum height of approx 0 5 0 6 m because higher elevations showed higher noise level weaker bottom reflection and stronger reflection from the dry portions of the streambanks making identification of the water body bed more complex fig 4 and fig 5 show only one radargram for drone borne and water coupled gpr profile for each cross section however multiple profiles were acquired in each cross sections radargrams acquired by gpr at the same cross section were nearly identical thus gpr measurements are shown to be highly repeatable from fig 6 it is clear that the sonar measurements at 100 khz in furesø are faulty this is most likely caused by the sediment type and especially by too shallow depth for the 100 khz frequency despite a minimum depth of 0 8 m for the 100 khz the manufacturer suggests to use this frequency only for depths above 1 5 m on the other hand the survey in furesø highlights that the minimum depth for 240 khz is approx 0 6 m compared to sonar measurements the main advantage of gpr is that the gpr can sense through dense aquatic vegetation this is especially evident for the centre of the cross sections in guden 9021 and for the portions close to the streambanks in guden 13770 fig 6 b guden 14963 and guden 8370 in the areas which had high vegetation density according to the visual assessment reported in table 2 in those cross sections no sonar frequency including the 100 khz was able to precisely detect the river bed in densely vegetated areas guden 8370 shown in fig 7 demonstrates that sonar bathymetric measurements show an elevation higher than rtk gnss caused by the sonar wave reflection from the vegetation canopy indeed guden 8370 was highly vegetated on the right side as it was also shown in fig 2 in which the inflatable boat is standing on vegetation conversely drone borne and water coupled gpr were not affected by vegetation and were able to penetrate through the submerged canopy the statistics comparing all the depth measurements are shown in table 3 each statistic is computed by comparing the depth measurements of either sonar or gpr with rtk gnss table 3 shows that water coupled gpr shows slightly better mae compared to drone borne gpr in all cross sections apart from guden 13859 and guden 8828 however the main advantage of water coupled gpr is that it can measure more shallow water and closer to the streambanks average statistics are significantly better for gpr water coupled and drone borne than for any sonar frequency among the sonar frequencies the 100 khz shows the worst performance as expected from the worst resolution and because it typically penetrates below soft bottoms whilst the 675 khz shows the best performance apart from guden 13770 240 khz is slightly better guden 14963 and nørreå 43716 however in guden 14963 and nørreå 43716 this is an artifactcaused by the fact that the 675 khz was unable because of connectivity issues to acquire fully continuous observations in the centre of the cross section thus the statistics of the diffferent sonar frequencies are not comparable for those two cross sections indeed the sample size for the statistics computation is smaller for 675 khz compared to the other two frequencies the last row of table 3 reports the average statistics among all sites however direct comparison of the averaged statistics of different instruments should be performed with caution as sonar or drone borne gpr measurements are missing in some sites the averaged statistics show that a mae of approx 8 cm a mbe of approx 2 cm and a rmse of approx 10 cm are achievable with drone borne gpr whilst similar statistics are achieved with water coupled gpr but on a larger number of sites in some cross sections e g guden 8917 guden 9021 and guden 9158 for water coupled gpr rmse is significantly worse than mae this is because rmse is more sensitive to outliers specifically large errors occurring in the steep streambanks close to the water s edge in locations where gpr is reaching the minimum depth capability the cross section in nørreå 43716 measured with water coupled gpr and sonar shows the worst statistics in terms of mae and mbe for gpr which may be caused by overestimation of depth in this cross section that presented soft bottom among the sonar frequencies 675 khz and 240 khz show negative bias which translates into underestimation of water depth vegetation effect whilst 100 khz shows positive bias which may indicate penetration below the bed of the water body 7 discussion we demonstrated that drone borne gpr measurements are feasible in waterbodies with a conductivity up to 340 μs cm and a depth up to 2 5 m gpr shows slightly worse statistics depth overestimation in a cross section with soft bottom when compared to rtk gnss gpr was not tested in waterbodies with higher conductivity or higher water depths thus the possibility of deploying drone borne gpr measurements in those conditions remains unknown especially because the propagation loss increases with electric conductivity and with depth our research shows that gpr measurements give significantly better results than sonar in measuring bathymetry when compared to ground truth ground truth was taken with rtk gnss which has a typical nominal vertical accuracy of approx 2 5 cm furthermore when measuring soft riverbeds the accuracy degrades because it is difficult to keep the bottom plate of the rtk gnss pole exactly at the bed level instead of penetrating a few centimetres into the sediment furthermore stones and local heterogeneities can complicate direct comparison between rtk gnss and the footprint of gpr or sonar additionally nobes et al 2018 found that also suspended sediments can have an influence on the accuracy of gpr bathymetric measurements for these reasons the achieved mae of approx 8 cm for gpr both drone borne and water coupled when compared to rtk gnss is considered satisfactory however drone borne gpr requires a minimum water depth of ca 1 m and shows worst results close to the streambanks thus is not applicable in narrow and very shallow rivers furthermore the low flight altitude requirement for drone borne gpr can also significantly complicate navigation in narrow rivers with riparian vegetation rtk gnss bathymetric measurements typically have a degree of subjectivity when the operator chooses the exact point where to measure e g avoiding to measure on stones or taking measurements on stones thus different surveys can result in slightly different results unless measurements are taken at the exact same cross section location on the other hand gpr surveys have always shown a high degree of repeatability thus multiple profiles retrieved along the same cross sections give nearly identical radargrams however a small degree of subjectivity is left to the user in choosing i the return from the water surface and ii the first point on the return from the bottom especially in portions of the radargram where the automated phase detection method fails thus different experienced users could extract slightly different depth observations typically in the range of 5 10 cm from the same radargram especially in the areas close to the streambanks regarding sonar deployment future research could investigate the usage of a higher frequency sonar above 1 mhz to have a better accuracy at shallow depths furthermore the deployed sonar provides water depth measurements in real time from automatic full waveform interpretation however if the user had the possibility to extract the full waveform as tabulated data enhanced removal of vegetation and better interpretation of the bottom return from the full waveform data could improve results in post processing finally integration of drone borne gpr with techniques such as drone borne topographic lidar or photogrammetry could be performed for estimating the elevation of both submerged gpr and dry topographic lidar portions of the cross sections while interpolation could be performed in the areas between dry and submerged parts 8 conclusions this study assessed the performance of a water coupled and drone borne gpr for mapping bathymetry in inland water bodies significant signal losses especially due to water surface reflection and spreading through air affect elevated gpr antennas compared to water coupled gpr these losses were computed and subsequently demonstrated with an experiment in which a handheld antenna elevated at approx 1 m above the water surface was compared to a water coupled gpr field measurements of bathymetry were taken in three different sites total surveyed cross sections 15 of which 1 in a lake with drone borne gpr water coupled gpr data sonar and ground truth rtk gnss the following results were obtained both water coupled and drone borne gpr measurements with gpr antenna flown at approx 0 5 m above the water surface could detect the bed of the waterbodies two factors are required to effectively map bathymetry with drone borne gpr i a maximum gpr elevation above the water surface of approx 0 5 m and ii a minimum water depth in the range 0 8 1 1 m depending on the inclination of the riverbed and distance to streambanks compared to drone borne gpr water coupled gpr can measure shallower water depth as low as 0 3 0 4 m as the noise caused by surface clutter on the early portions of the radargram does not occur when the gpr antenna is water coupled both water coupled and drone borne gpr provided accurate results with an average mae of approx 8 cm thus similar to the vertical resolution of the gpr at this frequency compared to in situ rtk gnss no significant bias was identified in gpr measurements compared to rtk gnss the applicability of the gpr bathymetry monitoring solution was not limited by the conditions at the chosen survey sites in relation to aquatic vegetation water electric conductivity tested up to 340 µs cm or maximum water depth tested up to 2 5 m gpr was applicable also in waterbodies with soft clay bed but resulted in slightly worse statistics when compared to ground truth the sonar provided unreliable biased results in vegetated water bodies but performed well in non vegetated water bodies when operated at 240 khz and 675 khz funding this work was supported by the project mapping of depth and sediment layer thickness of freshwater bodies with ground penetrating radar gpr onboard drones within the vis europas grønne region innovative løsninger på vandområdet framework funded by the european regional development fund and the projects riverscapes file number 7048 00001b and chinawatersense file number 8087 00002b funded by the innovation fund denmark innovationsfonden credit authorship contribution statement filippo bandini conceptualization methodology data curation visualization software investigation validation writing original draft writing review editing funding acquisition lukas kooij investigation validation bjørn karl mortensen conceptualization methodology investigation software marie boeskov caspersen conceptualization methodology investigation software lasse gammelby thomsen investigation validation daniel olesen methodology resources funding acquisition peter bauer gottwein conceptualization methodology data curation visualization investigation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank niels henrik broge and mark lyon from geopartner inspections a s for collaboration and co financing in the vis project we thank wsp engineering consulting firm for sharing the ground truth rtk gnss observations in situ observations were acquired independently by a professional operator from wsp to perform an independent accuracy validation test of the bathymetric observations appendix a a total loss coefficient was computed for both the water coupled gpr and drone borne gpr the values of the variables used for computing the different losses are shown in table a1 some of these variables are sensitive to temperature for example εwater varies significantly with water temperature from 80 at 20 to 87 7 at 0 andryieuski et al 2015 malmberg and maryott 1956 similarly a 2 increase of σwater per 1 c increase of water temperature typically occurs hayashi 2004 the variables εwater and ε water also depend on the angular frequency of the gpr wave andryieuski et al 2015 however for frequencies below 1 ghz as for the gprs used for bathymetry the frequency effect on εwater is not significant in the supplementary material an example of calculations of the different loss coefficients is documented as a jupyter notebook for example using the variable values from table a1 the losses of table a2 were computed 
2631,at macroscales e g large river basins nations continents or the globe hydro hazard mitigation under climate change requires accurate applicable hydrologic models especially over cold regions of complicated hydroclimatic relations as an effort to address such a challenge we innovate a macroscale distributed hydro modeling method bayesian principal monotonicity inference bapmi based on climate classification representative grids selection statistical hydrology surrogates based bayesian optimization and variance based sensitivity analyses the method is applied to a typical large cold region watershed i e athabasca river basin in canada and reveals a series of findings such as the following representatives bapmi shows promising skills in quantitatively characterizing macroscale cold region hydrology under overall impacts of heterogeneous climates bayesian optimization of which hyperparameters are insensitive decreases hydro modeling computational time by up to 96 3 and together with climate classification largely enhances bapmi applicability while ensuring modeling accuracies individual bapmi hydro model parameters can explain over ¾ of the variation of hydro modeling accuracies and due to their interaction joint calibration is required for avoiding underestimation of the impacts climatic conditions dominating cross scale uppermost hydrologic variations consist of night temperature 40 day temperature 38 and precipitation 22 for all catchments all river flows along the mainstem are associated with upstream climatic events such as glacier melts climatic impacts decline from upstream to downstream and from summer spring winter to autumn this may relate to tempo spatial heterogeneity of soil vegetation geology human interference and other non climatic factors without this study macroscale distributed hydrologic modeling would lack one advanced method i e bapmi that can immunize against effects of data uncertainty subjective judgement and climatic collinearity adapt to complicated hydroclimatic relations and diverse hydro variable s distributions reveal cross scale uppermost hydrologic variations and through inexpensive computations enhance hydro modeling accuracies to avoid climatic impact underestimation the findings of this study could facilitate bapmi applications and advance macroscale cold region hydrology keywords statistical hydrology macroscale climate change cold region athabasca river canada data availability all data are freely accessible from environment and climate change canada and agriculture and agri food canada 1 introduction the global climate is changing under joint impacts of natural and anthropogenic interferences which poses significant impacts on socio economic and eco environmental systems chen et al 2021 dong et al 2021 models of hydrologic responses to the changing climate provide scientific support for assessing adapting to and mitigating the impacts in water related sectors dong et al 2014a b 2015 two fundamental categories of widely used hydrologic models are physically based and data driven solomatine et al 2009 except their hybridization in a few of recent studies e g xu et al 2022 compared with the former the latter showed encouraging performances in various aspects e g modeling accuracies method adaptability and computational inexpensiveness hu et al 2021 although it also faces additional challenges such as interpretability reichstein et al 2019 one data driven hydro modeling approach of unique functionalities and irreplaceable advantages is stepwise cluster analysis and its variants originating from automatic interaction detection in statistics morgan and sonquist 1963 this approach was applied to modeling hydrologic e g huang et al 2006 wang et al 2021 2022 li et al 2021 2022 as well as climatic e g lu et al 2021 ecological e g kim et al 2011 environmental e g huang 1992 zheng et al 2022 or other systems in this approach a discrete model is built to simulate hydrologic behaviors especially highly nonlinear ones of abrupt changes through recursive binary agglomerations and fissions of paired hydroclimatic samples it could achieve high adaptability by eliminating the reliance of conventional approaches on pre assumed continuous functions immunize against data uncertainty and subjective judgment interferences by rigorous statistical inferences and reveal concurrent variations of multiple hydrologic variables with dominant climatic conditions across scales thus it could enhance hydro modeling accuracies deepen understandings of water cycles and promote advancements of hydro related models its superiorities over physically based e g slurp vic and swat and other data driven methods e g statistical regressions artificial neural networks random forests support vector machines and extreme gradient boosting have been verified in a series of studies e g li et al 2022 fan et al 2015 2016 li et al 2015 zhang et al 2021 sun et al 2018 besides owning these advantages one advanced variant of stepwise cluster analysis i e discrete principal monotonicity inference dpmi cheng et al 2016a b can also let this approach be adaptive to any hydro variable sample distributions instead of only normal ones and avoid potentially endless loops via improvements in algorithmic designs on the other hand macroscale distributed hydrologic modeling studies including those at continental or global scales increasingly flourished with data technological scientific and other progresses especially in the past years scanlon et al 2018 they can quantitatively disclose hydrologic responses to climatic conditions over large catchments enhance scientificity of hydro risk mitigation liu et al 2017 and at the same time accelerate progresses in relevant disciplines e g earth and environmental sciences however performances of macroscale distributed hydrologic models are hardly satisfactory for cold regions such as rokey mountains felfelani et al 2017 this may be associated with additional complexities e g phase changes schellekens et al 2017 cold climates nasab and chu 2020 prairie potholes zhang et al 2020 deep soils sapriza azuri et al 2018 hydrologic variabilities van hoy et al 2020 and extremeness cordeiro et al 2017 sparse gauges vionnet et al 2020 and soil frosts wang 2019 based on verified advantages over physically based and other data driven methods dpmi might be capable of advancing hydro modeling accuracies and insightful understandings of macroscale water cycles in the changing climate nonetheless this has not been explored in the regard of dpmi based macroscale distributed hydrologic modeling several challenges or questions exist 1 heterogeneity of climatic conditions over macroscale catchments especially at high resolutions increases predictors i e independent variables computational burdens and overfitting risks feature selection methods such as correlation analyses ren et al 2020 were widely used to reduce predictors in hydrologic modeling but spatial representativeness of predictors based on heterogeneity analyses was merely considered 2 dpmi consists of an integer optimization module in which differences of columned hydro variable samples between binary by row splits of paired hydroclimatic samples vary with predictors and row numbers and are maximized for extracting hydro variational mechanisms to the largest extent the module leads to unbearable computational burdens and hinders macroscale high resolution applications of dpmi surrogates based integer optimization razavi et al 2012 alizadeh et al 2021 may help address this issue this has not been attempted 3 in macroscale distributed hydrologic modeling parametric calibration is computationally expensive quantitative analyses of individual and interactive impacts of parameters can ease it to facilitate method applications 4 it is an open question which climate variables dominate macroscale hydrologic variations especially in cold regions across various scales dpmi can address it which is hardly achievable for physically based and other data driven methods in such a context this study aims to develop a bayesian principal monotonicity inferential method bapmi for macroscale distributed hydrologic modeling through overcoming limitations and taking advantages of dpmi in this method climate classification representative grids selection and surrogates based integer optimization are integrated with or incorporated into dpmi to eliminate computational burdens without sacrificing hydro modeling accuracies at macroscales parametric sensitivities and cross scale dominant climate variables are identified by mixed level multifactorial analyses and hydro model deconstruction respectively bapmi is applied across a typical macroscale cold region catchment i e athabasca river basin in canada for demonstrating its performances deepening hydrological understandings with a focus on revealing overall impacts of climates on river discharges guiding method applications and advancing macroscale cold region hydrology 2 method development bapmi the bapmi method for macroscale distributed hydrologic modeling can be structured as three modules fig 1 a 1 based on a climate classification method i e recursive dissimilarity and similarity inference cheng et al 2017b representative grids are selected to eliminate redundant climatic conditions and alleviate computational burdens of hydrologic modeling under climatic heterogeneity 2 a surrogates based integer optimization algorithm i e bayesian optimization snoek et al 2012 is incorporated into the discrete principal monotonicity inferential method cheng et al 2016a b to accelerate hydrologic modeling without sacrificing accuracies fig 1b accordingly a series of discrete hydrologic models are constructed by recursive binary cutting and merging of paired hydroclimatic samples based on statistical inferences and dominant climate variables of hydrologic variations across various scales are identified via analyses of the model construction process 3 to facilitate bapmi applications parametric and hyperparametric sensitivities are quantitatively examined by the mixed level multifactorial analysis method brook and arnold 2018 these modules are briefly introduced as follows and their details are stated in the supplementary materials 2 1 climate classification according to the spatial resolution of climatic dataset a macroscale catchment is partitioned as grids of which the number is large e g 1615 for athabasca river basin canada especially if the resolution is fine for the climate variables driving river flows their multi year series over all grids constitute a matrix of which one row represents one grid and one column denotes one climate variable in one lead month through the recursive dissimilarity and similarity inferential climate classification method cheng et al 2017b 2022 text s1 and fig s1 the matrix characterizing tempo spatially heterogeneous climates is classified as a series of submatrices representing climate zones 1 if one climate variable is not normally distributed its samples are converted to a normal distribution text s2 cheng et al 2016a b the conversion is reversed at the end of step 4 2 for every row column combination where the row number nmin nmin 1 r nmin nmin is an integer parameter and r is the sample size the matrix is permutated according to the numerical order of samples in the column and is cut as two matrices by the row the p value in the hypothesis test for the inter matrix difference of samples is calculated the matrix is cut as and replaced with two if the minimal p value for all combinations is not greater than a statistical significance level α the cutting process is applied to all matrices until any of them cannot be cut 3 any pair of matrices are merged as and replaced with one new matrix if the p value in the hypothesis test for the difference of their samples is greater than α the merging process continues until every pair cannot be merged 4 the cutting and merging processes are applied alternately until any new matrix is not generated both intra zone similarity and inter zone dissimilarity of the climate variables are higher than those in subjective classification methods fig s2 cheng et al 2017a reflecting the superiority of bapmi in classifying tempo spatially heterogeneous climates based on the classification grids averaged multi year series of every climate variable are generated for every combination of climate zones and catchments the nash sutcliffe model efficiency coefficient knoben et al 2019 is chosen from diverse metrics cheng et al 2022 to measure the distinction of multi year climate series between the combination and its every grid although the metric may result in poor reproduction of peaks mizukami et al 2019 peaks are beyond foci of this study due to relatively low modeling reliability of hydroclimatic extremes lane et al 2019 the grid of the lowest distinction i e the highest coefficient with the combination is selected to represent the combination establishing the carrier for integrating climate classification and hydrologic modeling 2 2 hydrological modeling based on dpmi a discrete hydrologic model is built through classifying causes and effects relationships between climatic x x 1 x 2 x c and hydrologic y variables text s3 and fig s3 cheng et al 2022 paired samples of x and y constitute a matrix of which every row and every column represent x y in one temporal unit e g day or month and multi year series of xc c 1 2 c or y respectively 1 samples of y are converted to a normal distribution if they are not normally distributed according to a normality test cheng et al 2016a and same with the climate classification the conversion is reversed at the end of step 4 2 for every row column combination where the row number r nmin nmin 1 r nmin and column number c 1 2 c the matrix is permutated by rows according to xc and is cut as two matrices from row r the p value in the hypothesis test for the inter matrix difference of y samples is calculated the minimal p value p for all combinations and the corresponding row and column numbers are identified by bayesian optimization snoek et al 2012 as specified in section 2 3 the climatic variable in the column can explain the uppermost variation of y in the matrix of a certain number of rows i e sample sizes so it is defined as the indicative or criterion climate variable the matrix is cut as and replaced with two if p α the cutting process continues until any matrix cannot be cut 3 the merging process is applied to y samples in any pair of matrices if any pair can be merged 4 both processes are repeated alternately until no new matrix is generated essentially final matrices that partition all paired hydroclimatic samples constitute a discrete hydrologic model see fig s4 for a similar example the model characterizes highly complicated overall hydrologic impacts of climates and enhance hydro modeling accuracies through rigorous statistical inferences it also discretely deconstructs hydroclimatic responsive relationships including phase dependent precipitation impacts the hydrologic response to any given climatic regime can be predicted by reproducing the cutting and merging processes an analysis of the model can identify the indicative climatic variables explaining cross scale i e hydroclimatic samples of various sizes uppermost hydrologic variations 2 3 bayesian optimization for every cutting operation in dpmi based hydrologic modeling minimizing p values that vary with column number i e predictor c 1 2 c and row number i e sample r nmin nmin 1 r nmin is an integer optimization problem its computational load geometrically increases with the numbers of predictors and samples that further increase with tempo spatial scales and resolutions climate variables lead months representative grids sub catchments and other factors since dpmi includes a large number of p value minimization processes in a hierarchical iterative algorithmic framework section 2 2 the total computational time can be several days months or years in macroscale high resolution distributed hydro modeling applications to address this issue bayesian optimization snoek et al 2012 is incorporated into dpmi for accelerating the optimization based on surrogate modeling razavi et al 2012 1 the p values for a given number initpnt of representative combinations of randomly selected row number r and column number c are calculated by the original statistical inferential algorithm in dpmi 2 let p denote the unknown p value for rc i e any combination of r and c through the gaussian process regression sun et al 2014 a nonparametric kernel based probabilistic model is built to predict the conditional distribution of p that according to the gaussian process theory rasmussen and williams 2006 is jointly normally distributed with the calculated p values 3 given an acquisition function for directing rc sampling the minimal p value p is identified through iteratively determining the minimal p value and its rc by the model verifying them by the algorithm and re building the model based on increased paired data this process is repeated until convergence e g for a given number niter of iterations method details are stated in sun et al 2014 as a surrogates based optimization method outperforming others wang et al 2014 bayesian optimization can largely reduce computational time for p identification while maintaining the global optimality of p this is demonstrated in section 5 1 with the help of the climate classification in decreasing predictors this method eliminates the computational hinderance in applying irreplaceable functionalities and advantages of dpmi to macroscale hydrologic or other modeling problems besides it perfectly matches with dpmi that because of not assuming any functional forms this method is widely suitable for any causes and effects relationships in hydrology and other fields the suitability and reliability of dpmi would not be sacrificed by the incorporation of this method 2 4 sensitivity analyses in addition to the climate classification and the bayesian optimization a quantitative analysis of hydro model parametric sensitivities is also helpful for easing computations and applications of bapmi in other macroscale hydrologic or similar modeling problems parameters nmin and α in dpmi as well as hyperparameters initpnt and niter in bayesian optimization might affect hydro modeling processes computations results and accuracies to quantify their impacts the mixed level multifactorial analysis method brook and arnold 2018 is employed text s4 cheng et al 2022 1 for either dpmi or bayesian optimization all combinations of parameters at various levels corresponding to parametric values are generated for every combination modeling outcomes such as hydro model accuracies and minimal p values are calculated 2 the variance of modeling outcomes for all parametric combinations is linearly decomposed as individual effects interactive effects and a residual that cannot be explained by these effects su et al 2020 3 the relative contribution of every effect to the overall variation is estimated by dividing it by the variance 4 a variance test is employed to assess the statistical significance of every effect given a threshold of the statistical significance level the sensitivity analysis method is capable of quantifying both individual and interactive impacts of multiple parameters at various levels on hydro modeling accuracies or p value minimization because of employing variance tests the method can enhance reliability and objectivity of quantification results under data uncertainty most other sensitivity analysis methods can hardly achieve these functionalities song et al 2020 3 case study athabasca river basin canada 3 1 study area it was predicted that the largest changes in the global hydrological cycle would occur in cold regions at mid to high latitudes under climatic impacts nijssen et al 2002 macroscale hydrologic models showed relatively discouraging performances over the regions felfelani et al 2017 thus the bapmi method of high adaptability is applied to athabasca river basin arb canada in consideration of its representation of cold region hydrology beighley et al 2015 large area 153 000 km2 within 52 59 n and 119 107 w nearly natural flows without intense human interferences quality data and requirements of reliable in depth analyses of climatic impacts on river flows for addressing severe hydroclimate related threats bawden et al 2014 cheng et al 2017c arb arising from upstream athabasca glacier on eastern slopes of rocky mountains is closely associated with snow and ice melts st jacques et al 2010 athabasca river as its mainstem is the longest 1 500 km undammed river on canadian prairies and through the largest continental freshwater river delta in north america drains into lake athabasca human activities such as agricultural irrigation and oil sands mining only consume less than 5 of river flows monk et al 2012 implying possibly high climatic impacts on the natural flows its elevation gradually declines from 3 645 to 211 m fig 2 a resulting in a large variation of discharges clay light loam clay loam and loamy sand are dominant soils across different layers figs s5 surficial materials present higher heterogeneity compared with geological and physiographic characteristics kerkhoven and gan 2006 figs s6 to s10 3 2 data historical observations of river flows fig 2b s11 and s12 and table s1 over arb are derived from a hydrometric database hydat of environment and climate change canada ec gc ca that has been compiling quality hydrologic observations across canada for decades ten representative catchments are identified from the digital elevation model of arb fig 2a in the mainstem upstream drainage areas are covered by downstream ones the focus of this case study in terms of advancing hydrological understandings is to reveal overall climatic impacts on river flows across arb due to the unique advantage and method design of bapmi in identifying meteorological forcings of cross scale uppermost hydrologic variation only dominant climate variables are usable in hydrologic modeling consequently predictors in bapmi consist of three representative apel et al 2018 zscheischler et al 2020 dominant yin et al 2018 jiang et al 2022 climatic variables subject to data and computation constraints they are daily minimal near surface air temperature daily maximal near surface air temperature and daily cumulative precipitation historical observations of these climate variables over 1615 10 km grids across arb are collected from a raster gridded dataset nlwis 2007 climate weather gc ca the dataset is derived from verified against and well fitted with long term in situ observations rouhani and leconte 2018 fig 2c to 2e and s13 to s16 show significant tempo spatial heterogeneities of subarctic or boreal climates at various scales 3 3 correlation analyses long term impacts of cross arb climatic conditions on arb outlet discharges are assessed fig 3 through the pearson product moment correlation coefficient pc the spearman s rank correlation coefficient sc and correlation tests pavlin et al 2021 1 nearly zero p values in the tests imply all coefficients are statistically significant due to large sample sizes 2 scs are higher than pcs their differences increase from precipitation to temperature and both coefficients vary synergistically since sc and pc characterize monotonic and linear relationships respectively we may conclude that between hydroclimatic variables monotonicity is more evident than linearity and nonlinear monotonicity increases from precipitation to temperature 3 differences of the coefficients among climate variables imply one typical feature of cold region hydrology over arb i e higher impacts of temperature especially in daytime on river flows than those of precipitation because of the likely dominance of glacier and snow melt runoffs 4 those among lead months reflect the apparent diminution of climatic impacts from current to lead 2 months and excluding a few of abrupt changes of correlation coefficients the colinearity of lead month varied climate conditions in affecting river flows if necessary the selection of climatic conditions may prioritize those of no or short lag times with river flows 5 variations of hydroclimatic correlations with the distances between grids and the outlet indicate that climatic impacts increase from downstream to upstream meanwhile the increasing trends decline from precipitation night temperature to day temperature and are more significant for longer lag times as a violation of the spatial proximity principle in hydroclimatic relationships these point out the potentially close association of the outlet river flows with upstream glaciers snowpacks and other hydrologic components 6 spatial variability of hydrologic correlations with precipitation is higher than that with temperature this may be associated with higher heterogeneity or higher hydro impact complexities of precipitation than that of temperature through revealing variations of hydroclimatic correlations with climate variables lead months grids and correlation coefficients these preliminary analyses build one foundation for hydrologic modeling 3 4 method configurations based on climate classification cheng et al 2017b 71 grids fig 2f are identified to represent 1615 grids across arb afterwards a hydrologic model is built to simulate climatic impacts on river flows around the outlet of every catchment since the crux of this study in terms of methodology is improving computational efficiency of dpmi the advantage of dpmi in quantifying concurrent variations of multi catchment discharges which has been demonstrated in wang et al 2022 is not elaborated again according to the cross validation strategy brodeur et al 2020 paired hydroclimatic samples are split for independently calibrating and verifying hydrologic models in hydrologic modeling parameter nmin fluctuates within 3 5 29 and optional values of parameter α are widely used statistical significance levels i e 0 001 0 01 0 05 and 0 10 in bayesian optimization hyperparameters initpnt and niter are set to 1 2 10 and 1 2 5 respectively in consideration of the diversity of hydro model performances we apply ten metrics text s5 and based on clustering of their correlations fig s17 finally select three representatives for results analyses all programs are written in r 4 bapmi hydro model performances 4 1 calibration calibration accuracies of bapmi hydrologic models for arb catchments as well as paired observations and simulations for three catchments representing up mid and downstream are shown in the left side panel of fig 4 according to the relatively satisfactory accuracies bapmi shows promising skills in quantitatively identifying climatic impacts on arb river flows to a certain extent this demonstrates superiority of bapmi importance of the selected climate variables and reasonableness of the selection furthermore the impacts vary with catchments which may result from soil vegetation geology human interference and other non climatic factors figs s5 to s10 for example lesser slave lake of 1 160 km2 at the upstream of gauge station 07bk006 as a large water retention reservoir flattens hydrographs and lowers hydrologic responses midstream agricultural activities alter water cycles leading to low accuracy models for catchments 07ag004 and 07bc002 in the accordance with linear trend analyses model accuracies decrease from upstream to downstream regardless of the diversity of metrics this implies due to the increase of non climatic impacts on river flows climatic impacts decline from upstream to downstream comparisons of river flow observations and simulations disclose the limit of bapmi in predicting flood magnitudes although it well captures the timing of floods this is mainly because the method design of bapmi in modules metrics mechanisms and other aspects does not focus on the hydrologic cycle under hydroclimatic extremes of low occurrence frequencies bapmi relies on available data and does not assume functional forms as in conventional hydrologic modeling that can extend among hydrologic magnitudes bapmi is adaptative to any causes and effects relationship given quality hydroclimatic data and meanwhile sacrifices the extendibility for low frequency events e g floods namely there is a tradeoff between the adaptability and the extendibility of bapmi hydrologic models addressing such a limit through extreme value theories lombardo et al 2019 sharma and mujumdar 2022 or other methods is one potential improvement of bapmi in follow up studies 4 2 verification performances of bapmi hydrologic models for arb catchments including three representing up mid and downstream during calibration independent verification periods are displayed in the right side panel of fig 4 satisfactory accuracies of the models in calibration are confirmed for verification implying the reliability of bapmi in reproducing macroscale cold region hydrology under climatic impacts it is also similar to hydro model performances during calibration that while predicting flood timing correctly the models tend to underestimate flood magnitudes during verification on the other hand the verification accuracies are decreased compared with calibration one potential cause is the likeliness of bapmi overfitting hydroclimatic data during calibration another is the nonstationarity of hydroclimatic relationships between both periods this may lead to decreases in hydro modeling accuracies underestimates of climatic impacts and risks of misguiding hydro hazard mitigations to prevent these consequences bapmi should be improved by addressing overfitting and nonstationarity issues e g brodeur et al 2020 dhakal et al 2015 in future studies another similarity between calibration and verification is that climatic impacts on river flows decrease from upstream to downstream at the same time one difference between them is that in spite of the diversity of metrics the decreasing trend in verification is more significant than that in calibration the difference may result from dedifferentiation of climatic impacts by the overfitting of hydrologic models in calibration which re emphasizes consequences of data driven hydro model overfitting and the necessity of solving this issue in the future 4 3 intra annual variations of biases to elaborate performances and facilitate applications of bapmi hydrologic models for arb catchments we analyzed both absolute and relative model biases in all years and in individual seasons or months fig 5 according to modeling results spatially heterogeneous river flow magnitudes differentiate both biases e g high absolute biases for downstream catchments 07da001 and 07dd001 versus high relative ones for midstream 07ag004 and 07bc002 besides multi year relative biases of the models fluctuate from 0 1 to 5 5 reflecting the advancement of bapmi in predicting long term averages of river flows and guiding long term water resources management bapmi tends to overestimate hydrologic responses to climatic impacts at the seasonal scale especially in autumn on average absolute biases decrease from autumn 19 8 summer 14 3 winter 6 9 to spring 4 6 m3 s while relative ones decline from autumn 21 winter 11 3 spring 1 7 to summer 0 7 at the monthly scale this method would underestimate the responses in may by 1 june 4 july 6 and november 9 and overestimate them in the other months from 1 8 in april to 32 8 in september from upstream to downstream and from tributaries to mainstem absolute biases show an increasing trend with river flow magnitudes and the trend is altered for relative biases these analyses reveal intra annual variations of considerable climatic impacts on temporal averages of arb river flows in accordance with the relative biases eliminating inter catchment streamflow magnitude differences the arb averaged impacts diminish from summer spring winter to autumn and reach their maximum in may and minimum in september relatively low climatic impacts in september are mainly caused by those for tributaries which may be associated with significant impacts of non climatic factors such as soil vegetation geology and water regulations on hydrologic cycling attention should be paid to autumn especially september in applications of arb hydrologic models and the bapmi method to hydro risk mitigation practices 5 discussion 5 1 enhancement of computational efficiency in bapmi bayesian optimization is applied to accelerate the minimization of p values representing the statistical significance of hydro variable sample differences between binarily divided groups of hydroclimatic samples so as to enhance computational efficiency in dpmi based hydrologic modeling at macroscales the number of climatic conditions in the modeling of river flows around gauge station 07dd001 at the outlet of arb is the highest for all arb catchments the first cutting operation in the modeling is the most time consuming because the original sample size is the highest compared with any subsequent cutting operation thus the minimization of p values in the first cutting operation within bapmi based hydrologic modeling for 07dd001 is chosen as a representative to assess the effectiveness of bayesian optimization fig 6 a shows the changes of p values with partition row numbers and four criterion predictors corresponding to the first four minimal p values to which original hydroclimatic samples are divided according we may find the changes are generally continuous with row numbers and due to the collinearity of the predictors in explaining hydrologic variations are similar for the predictors in contrast the minimal p value in the original dpmi method is identified by the greedy row by row and predictor by predictor search strategy which as one conventional optimization algorithm has low computational efficiencies mugunthan et al 2005 the continuity and the similarity imply the potentiality of bayesian optimization in accelerating p value minimization for the representative example identifying the minimal p value approximately 1 10 85 in original dpmi requires 162 44 s through duplicated applications of bayesian optimization under various hyperparametric settings the time is reduced to 6 05 s on average and the identified p value minimums with the median of 1 3 10 63 are not significantly different with the real minimum fig 6b namely bayesian optimization can decrease the computational time of dpmi by up to 96 3 while ensuring hydro modeling accuracies this exhibits the encouraging effectiveness of bayesian optimization in eliminating the computational hinderance for extensive applications of dpmi of irreplaceable functionalities and advantages in macroscale distributed hydrologic modeling moreover to facilitate bapmi applications especially parametric calibration we examined sensitivities of hyperparameters in bayesian optimization using the mixed level multifactorial analysis method brook and arnold 2018 fig 6c results show that both individual and interactive effects of the hyperparameters are not statistically significant this implies that the hyperparameters pose insignificant impacts on p value minimization their defaulted values can be applied when bapmi is employed to solve other hydro modeling problems 5 2 cross scale critical climate variables in every cutting operation of dpmi the climatic condition to which paired hydroclimatic samples are separated as two groups according can explain the most statistically significant inter group hydro variable difference at the particular sample size i e scale it is defined as the criterion climatic condition and may vary with cutting operations corresponding to various scales for one catchment an integrative analysis of all operations e g table s2 can identify the climatic conditions explaining cross scale uppermost hydrologic variations this is one unique advantage of dpmi the cross scale critical climatic variables csccvs for outlet discharges of arb catchments are shown in fig 7 taking the entire river basin as an example we find that csccvs are composed of up and mid stream night temperature mid and down stream day temperature as well as downstream precipitation fig 7j this is different with the results of correlation analyses fig 3 that focused on overall associations of collineated climatic conditions with runoffs one cause of the difference is that dpmi can eliminate collinearities of predictors among climate variables lead months or grids in the process of identifying csccvs another cause is the capability of dpmi in addressing the hierarchical variation of climatic impacts on river flows with scales or sample sizes through identifying csccvs dpmi gains new insights into hydroclimatic associations and can promote advances in relevant modeling studies in addition for all mainstem catchments csccvs consist of upstream climatic variables implying their significant impacts on cross arb river flows this addresses an open question regarding the uncertain association of arb hydrology with upstream climates peters and prowse 2006 gauged river discharges are closely related to nearby climatic conditions which is a common law in hydrology favier et al 2009 outlet discharges of two midstream catchments 07ag004 and 07bc002 are mainly driven by temperature hydroclimatic relations complicated by this under influences of non climatic factors may explain relatively low hydro modeling accuracies that indicates weak climatic impacts the ratios of night temperature day temperature and precipitation being taken as csccvs for all arb catchments equal to 0 40 0 38 and 0 22 respectively table s3 this implies that following the same order the overall impacts of these climate variables on river flows over the arb decrease gradually 5 3 hydro model parametric impacts to facilitate applications of bapmi impacts of hydro model parameters i e α and nmin on verification accuracies are quantified by mixed level multifactorial analyses fig 8 and s18 to s26 and table s4 the analyses reveal that the impacts are statistically significant for both parameters in most cases and their averages for all representative metrics and catchments reach 0 288 and 0 475 respectively careful calibration of both parameters is required for optimizing accuracies of hydrologic models and its emphasis should be placed on nmin of higher impacts than α besides the variation of the impacts with catchments is more evident than that with metrics we also specify the former variation via scatterplots of the impacts and catchment varied verification accuracies fig s27 and find that regardless of metrics the variation is opposite for both parameters and the overall variation is insignificant due to the offset of the oppositeness in consideration of all metrics we may conclude that for α and nmin the impacts respectively decrease and increase with verification accuracies namely α and nmin are more sensitive if regional climates pose respectively less and more impacts on river flows generally verification accuracies tend to decrease and increase with parameters α and nmin respectively this implies that if sufficient parametric calibration is hardly achievable for applications of bapmi to other macroscale distributed hydrologic or similar modeling practices we would suggest setting a low α e g 0 001 and a high nmin e g 30 it should be noted that the variation of verification accuracies with both parameters depends on catchments and metrics and in some cases is not monotonic and even presents abruptly nonlinear changes in these cases the suggested parametric settings may neglect potentially better performances of bapmi and lead to underestimation of hydrologic impacts of climates the analyses also disclose the significant interaction of both parameters in affecting hydro modeling accuracies this is mainly shown as unparallel especially intersectant lines representing variations of accuracies with α under different values of nmin fig 8c and s18 to s26 if the interaction does not exist the variations should be independent of each other and the lines should be parallel this points out the necessity of jointly calibrating the parameters to avoid the lowering of hydro modeling accuracies and the underestimate of climatic impacts 6 conclusions at macroscales e g large river basins nations continents or the globe advanced hydro modeling methods can improve the scientific support for mitigating heterogeneous hydrologic hazards under climate change in such a context a macroscale distributed hydro modeling method bayesian principal monotonicity inference bapmi was newly developed to quantitatively examine overall hydrologic impacts of climates over large river basins on the basis of climate classification representative grids selection statistical hydrology surrogates based bayesian optimization and variance based sensitivity analysis the method could eliminate effects of data uncertainty subjective judgement and climatic collinearity adapt to any complicated hydroclimatic relations and diverse hydro variable s distributions reveal climatic conditions driving cross scale uppermost hydrologic variations and through inexpensive computations enhance hydro modeling accuracies to avoid climatic impact underestimation in consideration of unsatisfactory performances of macroscale distributed hydrologic models as well as insufficient understandings of complex climatic impacts in cold regions we applied bapmi to catchments across a typical large cold region watershed i e athabasca river basin in canada representative findings in the application are summarized as follows 1 bapmi shows promising skills in quantitatively characterizing macroscale cold region hydrology under the impacts of heterogeneous climates there is a tradeoff between the adaptability and the extendibility of bapmi hydrologic models 2 bayesian optimization decreases hydro modeling computational time by up to 96 3 and largely enhances bapmi applicability while ensuring modeling accuracies its hyperparameters are insensitive and their defaulted values can be initialized in bapmi applications 3 parameters of bapmi hydrologic models can explain over ¾ of the variation of hydro modeling accuracies representing the identifiable climatic impacts their sensitivities vary with the impacts and their joint calibration can avoid underestimates of the impacts 4 the climatic conditions explaining cross scale uppermost hydrologic variations consist of night temperature 40 day temperature 38 and precipitation 22 for all catchments reflecting a gradual decrease in hydrologic impacts of these climate variables the inclusion of upstream climates in the conditions for all mainstem catchments implies the extensive association of river flows with headwater glacier melts and other climate events 5 climatic impacts decline from upstream to downstream diminish from summer spring winter to autumn and are the highest in may and the lowest in september especially for tributaries which may be associated with tempo spatial heterogeneity of soil vegetation geology human interference and other non climatic factors without this study scientific support for mitigating heterogeneous hydrologic hazards under climate change at macroscales would lack one hydro modeling method i e bapmi of unique functionalities and irreplaceable advantages the findings of this study can facilitate extensive applications of bapmi and advance relevant models methods practices etc on the other hand this study can be extended or improved in various aspects typical ones include but are not limited to the followings exploring concurrent variations of multiple hydrologic variables of interests at macroscales using the unique advantage of bapmi enhancing feasibility and reliability of bapmi under hydroclimatic extremes based on extreme value theories metric selection differential modeling or other optional approaches examining possibility of perfecting bapmi skills by considering additional hydro related climatic or other variables e g evapotranspiration based on elimination of data computational and other constraints addressing hydro model overfitting and hydroclimatic relational nonstationarity by improving bapmi algorithmic designs forecasting macroscale hydrologic hazards and their impacts via coupling bapmi with climate projections and impacts analyses eliminating low explainability by elaborating macroscale cold region hydrologic processes based on physics informed variants of bapmi in the context of data abundance developing a dynamic variant of bapmi for advancing real time hydrologic forecasting improving macroscale distributed hydrologic models according to the findings of this study applying bapmi to other macroscale cold region hydrologic or relevant modeling problems e g decomposing impacts of diverse climatic or other factors or discriminating precipitation phases and their changing laws subsequent studies in these aspects will promote contributions of bapmi to advances in macroscale hydrology climate change and other related fields credit authorship contribution statement guanhui cheng conceptualization methodology software formal analysis resources visualization writing original draft writing review editing guohe gordon huang supervision project administration funding acquisition cong dong validation investigation resources data curation declaration of competing interest the authors do not have any competing interests to declare acknowledgements this research was supported by guangdong provincial key laboratory project 2019b121203011 canada research chair program natural science and engineering research council of canada western economic diversification 15269 and mitacs we are very grateful for helpful inputs from the editor the associate editor and anonymous reviewers supplementary materials supplementary materials to this article can be found online at https doi org 10 1016 j jhydrol 2022 128803 supplementary materials the following are the supplementary data to this article supplementary data 1 
2631,at macroscales e g large river basins nations continents or the globe hydro hazard mitigation under climate change requires accurate applicable hydrologic models especially over cold regions of complicated hydroclimatic relations as an effort to address such a challenge we innovate a macroscale distributed hydro modeling method bayesian principal monotonicity inference bapmi based on climate classification representative grids selection statistical hydrology surrogates based bayesian optimization and variance based sensitivity analyses the method is applied to a typical large cold region watershed i e athabasca river basin in canada and reveals a series of findings such as the following representatives bapmi shows promising skills in quantitatively characterizing macroscale cold region hydrology under overall impacts of heterogeneous climates bayesian optimization of which hyperparameters are insensitive decreases hydro modeling computational time by up to 96 3 and together with climate classification largely enhances bapmi applicability while ensuring modeling accuracies individual bapmi hydro model parameters can explain over ¾ of the variation of hydro modeling accuracies and due to their interaction joint calibration is required for avoiding underestimation of the impacts climatic conditions dominating cross scale uppermost hydrologic variations consist of night temperature 40 day temperature 38 and precipitation 22 for all catchments all river flows along the mainstem are associated with upstream climatic events such as glacier melts climatic impacts decline from upstream to downstream and from summer spring winter to autumn this may relate to tempo spatial heterogeneity of soil vegetation geology human interference and other non climatic factors without this study macroscale distributed hydrologic modeling would lack one advanced method i e bapmi that can immunize against effects of data uncertainty subjective judgement and climatic collinearity adapt to complicated hydroclimatic relations and diverse hydro variable s distributions reveal cross scale uppermost hydrologic variations and through inexpensive computations enhance hydro modeling accuracies to avoid climatic impact underestimation the findings of this study could facilitate bapmi applications and advance macroscale cold region hydrology keywords statistical hydrology macroscale climate change cold region athabasca river canada data availability all data are freely accessible from environment and climate change canada and agriculture and agri food canada 1 introduction the global climate is changing under joint impacts of natural and anthropogenic interferences which poses significant impacts on socio economic and eco environmental systems chen et al 2021 dong et al 2021 models of hydrologic responses to the changing climate provide scientific support for assessing adapting to and mitigating the impacts in water related sectors dong et al 2014a b 2015 two fundamental categories of widely used hydrologic models are physically based and data driven solomatine et al 2009 except their hybridization in a few of recent studies e g xu et al 2022 compared with the former the latter showed encouraging performances in various aspects e g modeling accuracies method adaptability and computational inexpensiveness hu et al 2021 although it also faces additional challenges such as interpretability reichstein et al 2019 one data driven hydro modeling approach of unique functionalities and irreplaceable advantages is stepwise cluster analysis and its variants originating from automatic interaction detection in statistics morgan and sonquist 1963 this approach was applied to modeling hydrologic e g huang et al 2006 wang et al 2021 2022 li et al 2021 2022 as well as climatic e g lu et al 2021 ecological e g kim et al 2011 environmental e g huang 1992 zheng et al 2022 or other systems in this approach a discrete model is built to simulate hydrologic behaviors especially highly nonlinear ones of abrupt changes through recursive binary agglomerations and fissions of paired hydroclimatic samples it could achieve high adaptability by eliminating the reliance of conventional approaches on pre assumed continuous functions immunize against data uncertainty and subjective judgment interferences by rigorous statistical inferences and reveal concurrent variations of multiple hydrologic variables with dominant climatic conditions across scales thus it could enhance hydro modeling accuracies deepen understandings of water cycles and promote advancements of hydro related models its superiorities over physically based e g slurp vic and swat and other data driven methods e g statistical regressions artificial neural networks random forests support vector machines and extreme gradient boosting have been verified in a series of studies e g li et al 2022 fan et al 2015 2016 li et al 2015 zhang et al 2021 sun et al 2018 besides owning these advantages one advanced variant of stepwise cluster analysis i e discrete principal monotonicity inference dpmi cheng et al 2016a b can also let this approach be adaptive to any hydro variable sample distributions instead of only normal ones and avoid potentially endless loops via improvements in algorithmic designs on the other hand macroscale distributed hydrologic modeling studies including those at continental or global scales increasingly flourished with data technological scientific and other progresses especially in the past years scanlon et al 2018 they can quantitatively disclose hydrologic responses to climatic conditions over large catchments enhance scientificity of hydro risk mitigation liu et al 2017 and at the same time accelerate progresses in relevant disciplines e g earth and environmental sciences however performances of macroscale distributed hydrologic models are hardly satisfactory for cold regions such as rokey mountains felfelani et al 2017 this may be associated with additional complexities e g phase changes schellekens et al 2017 cold climates nasab and chu 2020 prairie potholes zhang et al 2020 deep soils sapriza azuri et al 2018 hydrologic variabilities van hoy et al 2020 and extremeness cordeiro et al 2017 sparse gauges vionnet et al 2020 and soil frosts wang 2019 based on verified advantages over physically based and other data driven methods dpmi might be capable of advancing hydro modeling accuracies and insightful understandings of macroscale water cycles in the changing climate nonetheless this has not been explored in the regard of dpmi based macroscale distributed hydrologic modeling several challenges or questions exist 1 heterogeneity of climatic conditions over macroscale catchments especially at high resolutions increases predictors i e independent variables computational burdens and overfitting risks feature selection methods such as correlation analyses ren et al 2020 were widely used to reduce predictors in hydrologic modeling but spatial representativeness of predictors based on heterogeneity analyses was merely considered 2 dpmi consists of an integer optimization module in which differences of columned hydro variable samples between binary by row splits of paired hydroclimatic samples vary with predictors and row numbers and are maximized for extracting hydro variational mechanisms to the largest extent the module leads to unbearable computational burdens and hinders macroscale high resolution applications of dpmi surrogates based integer optimization razavi et al 2012 alizadeh et al 2021 may help address this issue this has not been attempted 3 in macroscale distributed hydrologic modeling parametric calibration is computationally expensive quantitative analyses of individual and interactive impacts of parameters can ease it to facilitate method applications 4 it is an open question which climate variables dominate macroscale hydrologic variations especially in cold regions across various scales dpmi can address it which is hardly achievable for physically based and other data driven methods in such a context this study aims to develop a bayesian principal monotonicity inferential method bapmi for macroscale distributed hydrologic modeling through overcoming limitations and taking advantages of dpmi in this method climate classification representative grids selection and surrogates based integer optimization are integrated with or incorporated into dpmi to eliminate computational burdens without sacrificing hydro modeling accuracies at macroscales parametric sensitivities and cross scale dominant climate variables are identified by mixed level multifactorial analyses and hydro model deconstruction respectively bapmi is applied across a typical macroscale cold region catchment i e athabasca river basin in canada for demonstrating its performances deepening hydrological understandings with a focus on revealing overall impacts of climates on river discharges guiding method applications and advancing macroscale cold region hydrology 2 method development bapmi the bapmi method for macroscale distributed hydrologic modeling can be structured as three modules fig 1 a 1 based on a climate classification method i e recursive dissimilarity and similarity inference cheng et al 2017b representative grids are selected to eliminate redundant climatic conditions and alleviate computational burdens of hydrologic modeling under climatic heterogeneity 2 a surrogates based integer optimization algorithm i e bayesian optimization snoek et al 2012 is incorporated into the discrete principal monotonicity inferential method cheng et al 2016a b to accelerate hydrologic modeling without sacrificing accuracies fig 1b accordingly a series of discrete hydrologic models are constructed by recursive binary cutting and merging of paired hydroclimatic samples based on statistical inferences and dominant climate variables of hydrologic variations across various scales are identified via analyses of the model construction process 3 to facilitate bapmi applications parametric and hyperparametric sensitivities are quantitatively examined by the mixed level multifactorial analysis method brook and arnold 2018 these modules are briefly introduced as follows and their details are stated in the supplementary materials 2 1 climate classification according to the spatial resolution of climatic dataset a macroscale catchment is partitioned as grids of which the number is large e g 1615 for athabasca river basin canada especially if the resolution is fine for the climate variables driving river flows their multi year series over all grids constitute a matrix of which one row represents one grid and one column denotes one climate variable in one lead month through the recursive dissimilarity and similarity inferential climate classification method cheng et al 2017b 2022 text s1 and fig s1 the matrix characterizing tempo spatially heterogeneous climates is classified as a series of submatrices representing climate zones 1 if one climate variable is not normally distributed its samples are converted to a normal distribution text s2 cheng et al 2016a b the conversion is reversed at the end of step 4 2 for every row column combination where the row number nmin nmin 1 r nmin nmin is an integer parameter and r is the sample size the matrix is permutated according to the numerical order of samples in the column and is cut as two matrices by the row the p value in the hypothesis test for the inter matrix difference of samples is calculated the matrix is cut as and replaced with two if the minimal p value for all combinations is not greater than a statistical significance level α the cutting process is applied to all matrices until any of them cannot be cut 3 any pair of matrices are merged as and replaced with one new matrix if the p value in the hypothesis test for the difference of their samples is greater than α the merging process continues until every pair cannot be merged 4 the cutting and merging processes are applied alternately until any new matrix is not generated both intra zone similarity and inter zone dissimilarity of the climate variables are higher than those in subjective classification methods fig s2 cheng et al 2017a reflecting the superiority of bapmi in classifying tempo spatially heterogeneous climates based on the classification grids averaged multi year series of every climate variable are generated for every combination of climate zones and catchments the nash sutcliffe model efficiency coefficient knoben et al 2019 is chosen from diverse metrics cheng et al 2022 to measure the distinction of multi year climate series between the combination and its every grid although the metric may result in poor reproduction of peaks mizukami et al 2019 peaks are beyond foci of this study due to relatively low modeling reliability of hydroclimatic extremes lane et al 2019 the grid of the lowest distinction i e the highest coefficient with the combination is selected to represent the combination establishing the carrier for integrating climate classification and hydrologic modeling 2 2 hydrological modeling based on dpmi a discrete hydrologic model is built through classifying causes and effects relationships between climatic x x 1 x 2 x c and hydrologic y variables text s3 and fig s3 cheng et al 2022 paired samples of x and y constitute a matrix of which every row and every column represent x y in one temporal unit e g day or month and multi year series of xc c 1 2 c or y respectively 1 samples of y are converted to a normal distribution if they are not normally distributed according to a normality test cheng et al 2016a and same with the climate classification the conversion is reversed at the end of step 4 2 for every row column combination where the row number r nmin nmin 1 r nmin and column number c 1 2 c the matrix is permutated by rows according to xc and is cut as two matrices from row r the p value in the hypothesis test for the inter matrix difference of y samples is calculated the minimal p value p for all combinations and the corresponding row and column numbers are identified by bayesian optimization snoek et al 2012 as specified in section 2 3 the climatic variable in the column can explain the uppermost variation of y in the matrix of a certain number of rows i e sample sizes so it is defined as the indicative or criterion climate variable the matrix is cut as and replaced with two if p α the cutting process continues until any matrix cannot be cut 3 the merging process is applied to y samples in any pair of matrices if any pair can be merged 4 both processes are repeated alternately until no new matrix is generated essentially final matrices that partition all paired hydroclimatic samples constitute a discrete hydrologic model see fig s4 for a similar example the model characterizes highly complicated overall hydrologic impacts of climates and enhance hydro modeling accuracies through rigorous statistical inferences it also discretely deconstructs hydroclimatic responsive relationships including phase dependent precipitation impacts the hydrologic response to any given climatic regime can be predicted by reproducing the cutting and merging processes an analysis of the model can identify the indicative climatic variables explaining cross scale i e hydroclimatic samples of various sizes uppermost hydrologic variations 2 3 bayesian optimization for every cutting operation in dpmi based hydrologic modeling minimizing p values that vary with column number i e predictor c 1 2 c and row number i e sample r nmin nmin 1 r nmin is an integer optimization problem its computational load geometrically increases with the numbers of predictors and samples that further increase with tempo spatial scales and resolutions climate variables lead months representative grids sub catchments and other factors since dpmi includes a large number of p value minimization processes in a hierarchical iterative algorithmic framework section 2 2 the total computational time can be several days months or years in macroscale high resolution distributed hydro modeling applications to address this issue bayesian optimization snoek et al 2012 is incorporated into dpmi for accelerating the optimization based on surrogate modeling razavi et al 2012 1 the p values for a given number initpnt of representative combinations of randomly selected row number r and column number c are calculated by the original statistical inferential algorithm in dpmi 2 let p denote the unknown p value for rc i e any combination of r and c through the gaussian process regression sun et al 2014 a nonparametric kernel based probabilistic model is built to predict the conditional distribution of p that according to the gaussian process theory rasmussen and williams 2006 is jointly normally distributed with the calculated p values 3 given an acquisition function for directing rc sampling the minimal p value p is identified through iteratively determining the minimal p value and its rc by the model verifying them by the algorithm and re building the model based on increased paired data this process is repeated until convergence e g for a given number niter of iterations method details are stated in sun et al 2014 as a surrogates based optimization method outperforming others wang et al 2014 bayesian optimization can largely reduce computational time for p identification while maintaining the global optimality of p this is demonstrated in section 5 1 with the help of the climate classification in decreasing predictors this method eliminates the computational hinderance in applying irreplaceable functionalities and advantages of dpmi to macroscale hydrologic or other modeling problems besides it perfectly matches with dpmi that because of not assuming any functional forms this method is widely suitable for any causes and effects relationships in hydrology and other fields the suitability and reliability of dpmi would not be sacrificed by the incorporation of this method 2 4 sensitivity analyses in addition to the climate classification and the bayesian optimization a quantitative analysis of hydro model parametric sensitivities is also helpful for easing computations and applications of bapmi in other macroscale hydrologic or similar modeling problems parameters nmin and α in dpmi as well as hyperparameters initpnt and niter in bayesian optimization might affect hydro modeling processes computations results and accuracies to quantify their impacts the mixed level multifactorial analysis method brook and arnold 2018 is employed text s4 cheng et al 2022 1 for either dpmi or bayesian optimization all combinations of parameters at various levels corresponding to parametric values are generated for every combination modeling outcomes such as hydro model accuracies and minimal p values are calculated 2 the variance of modeling outcomes for all parametric combinations is linearly decomposed as individual effects interactive effects and a residual that cannot be explained by these effects su et al 2020 3 the relative contribution of every effect to the overall variation is estimated by dividing it by the variance 4 a variance test is employed to assess the statistical significance of every effect given a threshold of the statistical significance level the sensitivity analysis method is capable of quantifying both individual and interactive impacts of multiple parameters at various levels on hydro modeling accuracies or p value minimization because of employing variance tests the method can enhance reliability and objectivity of quantification results under data uncertainty most other sensitivity analysis methods can hardly achieve these functionalities song et al 2020 3 case study athabasca river basin canada 3 1 study area it was predicted that the largest changes in the global hydrological cycle would occur in cold regions at mid to high latitudes under climatic impacts nijssen et al 2002 macroscale hydrologic models showed relatively discouraging performances over the regions felfelani et al 2017 thus the bapmi method of high adaptability is applied to athabasca river basin arb canada in consideration of its representation of cold region hydrology beighley et al 2015 large area 153 000 km2 within 52 59 n and 119 107 w nearly natural flows without intense human interferences quality data and requirements of reliable in depth analyses of climatic impacts on river flows for addressing severe hydroclimate related threats bawden et al 2014 cheng et al 2017c arb arising from upstream athabasca glacier on eastern slopes of rocky mountains is closely associated with snow and ice melts st jacques et al 2010 athabasca river as its mainstem is the longest 1 500 km undammed river on canadian prairies and through the largest continental freshwater river delta in north america drains into lake athabasca human activities such as agricultural irrigation and oil sands mining only consume less than 5 of river flows monk et al 2012 implying possibly high climatic impacts on the natural flows its elevation gradually declines from 3 645 to 211 m fig 2 a resulting in a large variation of discharges clay light loam clay loam and loamy sand are dominant soils across different layers figs s5 surficial materials present higher heterogeneity compared with geological and physiographic characteristics kerkhoven and gan 2006 figs s6 to s10 3 2 data historical observations of river flows fig 2b s11 and s12 and table s1 over arb are derived from a hydrometric database hydat of environment and climate change canada ec gc ca that has been compiling quality hydrologic observations across canada for decades ten representative catchments are identified from the digital elevation model of arb fig 2a in the mainstem upstream drainage areas are covered by downstream ones the focus of this case study in terms of advancing hydrological understandings is to reveal overall climatic impacts on river flows across arb due to the unique advantage and method design of bapmi in identifying meteorological forcings of cross scale uppermost hydrologic variation only dominant climate variables are usable in hydrologic modeling consequently predictors in bapmi consist of three representative apel et al 2018 zscheischler et al 2020 dominant yin et al 2018 jiang et al 2022 climatic variables subject to data and computation constraints they are daily minimal near surface air temperature daily maximal near surface air temperature and daily cumulative precipitation historical observations of these climate variables over 1615 10 km grids across arb are collected from a raster gridded dataset nlwis 2007 climate weather gc ca the dataset is derived from verified against and well fitted with long term in situ observations rouhani and leconte 2018 fig 2c to 2e and s13 to s16 show significant tempo spatial heterogeneities of subarctic or boreal climates at various scales 3 3 correlation analyses long term impacts of cross arb climatic conditions on arb outlet discharges are assessed fig 3 through the pearson product moment correlation coefficient pc the spearman s rank correlation coefficient sc and correlation tests pavlin et al 2021 1 nearly zero p values in the tests imply all coefficients are statistically significant due to large sample sizes 2 scs are higher than pcs their differences increase from precipitation to temperature and both coefficients vary synergistically since sc and pc characterize monotonic and linear relationships respectively we may conclude that between hydroclimatic variables monotonicity is more evident than linearity and nonlinear monotonicity increases from precipitation to temperature 3 differences of the coefficients among climate variables imply one typical feature of cold region hydrology over arb i e higher impacts of temperature especially in daytime on river flows than those of precipitation because of the likely dominance of glacier and snow melt runoffs 4 those among lead months reflect the apparent diminution of climatic impacts from current to lead 2 months and excluding a few of abrupt changes of correlation coefficients the colinearity of lead month varied climate conditions in affecting river flows if necessary the selection of climatic conditions may prioritize those of no or short lag times with river flows 5 variations of hydroclimatic correlations with the distances between grids and the outlet indicate that climatic impacts increase from downstream to upstream meanwhile the increasing trends decline from precipitation night temperature to day temperature and are more significant for longer lag times as a violation of the spatial proximity principle in hydroclimatic relationships these point out the potentially close association of the outlet river flows with upstream glaciers snowpacks and other hydrologic components 6 spatial variability of hydrologic correlations with precipitation is higher than that with temperature this may be associated with higher heterogeneity or higher hydro impact complexities of precipitation than that of temperature through revealing variations of hydroclimatic correlations with climate variables lead months grids and correlation coefficients these preliminary analyses build one foundation for hydrologic modeling 3 4 method configurations based on climate classification cheng et al 2017b 71 grids fig 2f are identified to represent 1615 grids across arb afterwards a hydrologic model is built to simulate climatic impacts on river flows around the outlet of every catchment since the crux of this study in terms of methodology is improving computational efficiency of dpmi the advantage of dpmi in quantifying concurrent variations of multi catchment discharges which has been demonstrated in wang et al 2022 is not elaborated again according to the cross validation strategy brodeur et al 2020 paired hydroclimatic samples are split for independently calibrating and verifying hydrologic models in hydrologic modeling parameter nmin fluctuates within 3 5 29 and optional values of parameter α are widely used statistical significance levels i e 0 001 0 01 0 05 and 0 10 in bayesian optimization hyperparameters initpnt and niter are set to 1 2 10 and 1 2 5 respectively in consideration of the diversity of hydro model performances we apply ten metrics text s5 and based on clustering of their correlations fig s17 finally select three representatives for results analyses all programs are written in r 4 bapmi hydro model performances 4 1 calibration calibration accuracies of bapmi hydrologic models for arb catchments as well as paired observations and simulations for three catchments representing up mid and downstream are shown in the left side panel of fig 4 according to the relatively satisfactory accuracies bapmi shows promising skills in quantitatively identifying climatic impacts on arb river flows to a certain extent this demonstrates superiority of bapmi importance of the selected climate variables and reasonableness of the selection furthermore the impacts vary with catchments which may result from soil vegetation geology human interference and other non climatic factors figs s5 to s10 for example lesser slave lake of 1 160 km2 at the upstream of gauge station 07bk006 as a large water retention reservoir flattens hydrographs and lowers hydrologic responses midstream agricultural activities alter water cycles leading to low accuracy models for catchments 07ag004 and 07bc002 in the accordance with linear trend analyses model accuracies decrease from upstream to downstream regardless of the diversity of metrics this implies due to the increase of non climatic impacts on river flows climatic impacts decline from upstream to downstream comparisons of river flow observations and simulations disclose the limit of bapmi in predicting flood magnitudes although it well captures the timing of floods this is mainly because the method design of bapmi in modules metrics mechanisms and other aspects does not focus on the hydrologic cycle under hydroclimatic extremes of low occurrence frequencies bapmi relies on available data and does not assume functional forms as in conventional hydrologic modeling that can extend among hydrologic magnitudes bapmi is adaptative to any causes and effects relationship given quality hydroclimatic data and meanwhile sacrifices the extendibility for low frequency events e g floods namely there is a tradeoff between the adaptability and the extendibility of bapmi hydrologic models addressing such a limit through extreme value theories lombardo et al 2019 sharma and mujumdar 2022 or other methods is one potential improvement of bapmi in follow up studies 4 2 verification performances of bapmi hydrologic models for arb catchments including three representing up mid and downstream during calibration independent verification periods are displayed in the right side panel of fig 4 satisfactory accuracies of the models in calibration are confirmed for verification implying the reliability of bapmi in reproducing macroscale cold region hydrology under climatic impacts it is also similar to hydro model performances during calibration that while predicting flood timing correctly the models tend to underestimate flood magnitudes during verification on the other hand the verification accuracies are decreased compared with calibration one potential cause is the likeliness of bapmi overfitting hydroclimatic data during calibration another is the nonstationarity of hydroclimatic relationships between both periods this may lead to decreases in hydro modeling accuracies underestimates of climatic impacts and risks of misguiding hydro hazard mitigations to prevent these consequences bapmi should be improved by addressing overfitting and nonstationarity issues e g brodeur et al 2020 dhakal et al 2015 in future studies another similarity between calibration and verification is that climatic impacts on river flows decrease from upstream to downstream at the same time one difference between them is that in spite of the diversity of metrics the decreasing trend in verification is more significant than that in calibration the difference may result from dedifferentiation of climatic impacts by the overfitting of hydrologic models in calibration which re emphasizes consequences of data driven hydro model overfitting and the necessity of solving this issue in the future 4 3 intra annual variations of biases to elaborate performances and facilitate applications of bapmi hydrologic models for arb catchments we analyzed both absolute and relative model biases in all years and in individual seasons or months fig 5 according to modeling results spatially heterogeneous river flow magnitudes differentiate both biases e g high absolute biases for downstream catchments 07da001 and 07dd001 versus high relative ones for midstream 07ag004 and 07bc002 besides multi year relative biases of the models fluctuate from 0 1 to 5 5 reflecting the advancement of bapmi in predicting long term averages of river flows and guiding long term water resources management bapmi tends to overestimate hydrologic responses to climatic impacts at the seasonal scale especially in autumn on average absolute biases decrease from autumn 19 8 summer 14 3 winter 6 9 to spring 4 6 m3 s while relative ones decline from autumn 21 winter 11 3 spring 1 7 to summer 0 7 at the monthly scale this method would underestimate the responses in may by 1 june 4 july 6 and november 9 and overestimate them in the other months from 1 8 in april to 32 8 in september from upstream to downstream and from tributaries to mainstem absolute biases show an increasing trend with river flow magnitudes and the trend is altered for relative biases these analyses reveal intra annual variations of considerable climatic impacts on temporal averages of arb river flows in accordance with the relative biases eliminating inter catchment streamflow magnitude differences the arb averaged impacts diminish from summer spring winter to autumn and reach their maximum in may and minimum in september relatively low climatic impacts in september are mainly caused by those for tributaries which may be associated with significant impacts of non climatic factors such as soil vegetation geology and water regulations on hydrologic cycling attention should be paid to autumn especially september in applications of arb hydrologic models and the bapmi method to hydro risk mitigation practices 5 discussion 5 1 enhancement of computational efficiency in bapmi bayesian optimization is applied to accelerate the minimization of p values representing the statistical significance of hydro variable sample differences between binarily divided groups of hydroclimatic samples so as to enhance computational efficiency in dpmi based hydrologic modeling at macroscales the number of climatic conditions in the modeling of river flows around gauge station 07dd001 at the outlet of arb is the highest for all arb catchments the first cutting operation in the modeling is the most time consuming because the original sample size is the highest compared with any subsequent cutting operation thus the minimization of p values in the first cutting operation within bapmi based hydrologic modeling for 07dd001 is chosen as a representative to assess the effectiveness of bayesian optimization fig 6 a shows the changes of p values with partition row numbers and four criterion predictors corresponding to the first four minimal p values to which original hydroclimatic samples are divided according we may find the changes are generally continuous with row numbers and due to the collinearity of the predictors in explaining hydrologic variations are similar for the predictors in contrast the minimal p value in the original dpmi method is identified by the greedy row by row and predictor by predictor search strategy which as one conventional optimization algorithm has low computational efficiencies mugunthan et al 2005 the continuity and the similarity imply the potentiality of bayesian optimization in accelerating p value minimization for the representative example identifying the minimal p value approximately 1 10 85 in original dpmi requires 162 44 s through duplicated applications of bayesian optimization under various hyperparametric settings the time is reduced to 6 05 s on average and the identified p value minimums with the median of 1 3 10 63 are not significantly different with the real minimum fig 6b namely bayesian optimization can decrease the computational time of dpmi by up to 96 3 while ensuring hydro modeling accuracies this exhibits the encouraging effectiveness of bayesian optimization in eliminating the computational hinderance for extensive applications of dpmi of irreplaceable functionalities and advantages in macroscale distributed hydrologic modeling moreover to facilitate bapmi applications especially parametric calibration we examined sensitivities of hyperparameters in bayesian optimization using the mixed level multifactorial analysis method brook and arnold 2018 fig 6c results show that both individual and interactive effects of the hyperparameters are not statistically significant this implies that the hyperparameters pose insignificant impacts on p value minimization their defaulted values can be applied when bapmi is employed to solve other hydro modeling problems 5 2 cross scale critical climate variables in every cutting operation of dpmi the climatic condition to which paired hydroclimatic samples are separated as two groups according can explain the most statistically significant inter group hydro variable difference at the particular sample size i e scale it is defined as the criterion climatic condition and may vary with cutting operations corresponding to various scales for one catchment an integrative analysis of all operations e g table s2 can identify the climatic conditions explaining cross scale uppermost hydrologic variations this is one unique advantage of dpmi the cross scale critical climatic variables csccvs for outlet discharges of arb catchments are shown in fig 7 taking the entire river basin as an example we find that csccvs are composed of up and mid stream night temperature mid and down stream day temperature as well as downstream precipitation fig 7j this is different with the results of correlation analyses fig 3 that focused on overall associations of collineated climatic conditions with runoffs one cause of the difference is that dpmi can eliminate collinearities of predictors among climate variables lead months or grids in the process of identifying csccvs another cause is the capability of dpmi in addressing the hierarchical variation of climatic impacts on river flows with scales or sample sizes through identifying csccvs dpmi gains new insights into hydroclimatic associations and can promote advances in relevant modeling studies in addition for all mainstem catchments csccvs consist of upstream climatic variables implying their significant impacts on cross arb river flows this addresses an open question regarding the uncertain association of arb hydrology with upstream climates peters and prowse 2006 gauged river discharges are closely related to nearby climatic conditions which is a common law in hydrology favier et al 2009 outlet discharges of two midstream catchments 07ag004 and 07bc002 are mainly driven by temperature hydroclimatic relations complicated by this under influences of non climatic factors may explain relatively low hydro modeling accuracies that indicates weak climatic impacts the ratios of night temperature day temperature and precipitation being taken as csccvs for all arb catchments equal to 0 40 0 38 and 0 22 respectively table s3 this implies that following the same order the overall impacts of these climate variables on river flows over the arb decrease gradually 5 3 hydro model parametric impacts to facilitate applications of bapmi impacts of hydro model parameters i e α and nmin on verification accuracies are quantified by mixed level multifactorial analyses fig 8 and s18 to s26 and table s4 the analyses reveal that the impacts are statistically significant for both parameters in most cases and their averages for all representative metrics and catchments reach 0 288 and 0 475 respectively careful calibration of both parameters is required for optimizing accuracies of hydrologic models and its emphasis should be placed on nmin of higher impacts than α besides the variation of the impacts with catchments is more evident than that with metrics we also specify the former variation via scatterplots of the impacts and catchment varied verification accuracies fig s27 and find that regardless of metrics the variation is opposite for both parameters and the overall variation is insignificant due to the offset of the oppositeness in consideration of all metrics we may conclude that for α and nmin the impacts respectively decrease and increase with verification accuracies namely α and nmin are more sensitive if regional climates pose respectively less and more impacts on river flows generally verification accuracies tend to decrease and increase with parameters α and nmin respectively this implies that if sufficient parametric calibration is hardly achievable for applications of bapmi to other macroscale distributed hydrologic or similar modeling practices we would suggest setting a low α e g 0 001 and a high nmin e g 30 it should be noted that the variation of verification accuracies with both parameters depends on catchments and metrics and in some cases is not monotonic and even presents abruptly nonlinear changes in these cases the suggested parametric settings may neglect potentially better performances of bapmi and lead to underestimation of hydrologic impacts of climates the analyses also disclose the significant interaction of both parameters in affecting hydro modeling accuracies this is mainly shown as unparallel especially intersectant lines representing variations of accuracies with α under different values of nmin fig 8c and s18 to s26 if the interaction does not exist the variations should be independent of each other and the lines should be parallel this points out the necessity of jointly calibrating the parameters to avoid the lowering of hydro modeling accuracies and the underestimate of climatic impacts 6 conclusions at macroscales e g large river basins nations continents or the globe advanced hydro modeling methods can improve the scientific support for mitigating heterogeneous hydrologic hazards under climate change in such a context a macroscale distributed hydro modeling method bayesian principal monotonicity inference bapmi was newly developed to quantitatively examine overall hydrologic impacts of climates over large river basins on the basis of climate classification representative grids selection statistical hydrology surrogates based bayesian optimization and variance based sensitivity analysis the method could eliminate effects of data uncertainty subjective judgement and climatic collinearity adapt to any complicated hydroclimatic relations and diverse hydro variable s distributions reveal climatic conditions driving cross scale uppermost hydrologic variations and through inexpensive computations enhance hydro modeling accuracies to avoid climatic impact underestimation in consideration of unsatisfactory performances of macroscale distributed hydrologic models as well as insufficient understandings of complex climatic impacts in cold regions we applied bapmi to catchments across a typical large cold region watershed i e athabasca river basin in canada representative findings in the application are summarized as follows 1 bapmi shows promising skills in quantitatively characterizing macroscale cold region hydrology under the impacts of heterogeneous climates there is a tradeoff between the adaptability and the extendibility of bapmi hydrologic models 2 bayesian optimization decreases hydro modeling computational time by up to 96 3 and largely enhances bapmi applicability while ensuring modeling accuracies its hyperparameters are insensitive and their defaulted values can be initialized in bapmi applications 3 parameters of bapmi hydrologic models can explain over ¾ of the variation of hydro modeling accuracies representing the identifiable climatic impacts their sensitivities vary with the impacts and their joint calibration can avoid underestimates of the impacts 4 the climatic conditions explaining cross scale uppermost hydrologic variations consist of night temperature 40 day temperature 38 and precipitation 22 for all catchments reflecting a gradual decrease in hydrologic impacts of these climate variables the inclusion of upstream climates in the conditions for all mainstem catchments implies the extensive association of river flows with headwater glacier melts and other climate events 5 climatic impacts decline from upstream to downstream diminish from summer spring winter to autumn and are the highest in may and the lowest in september especially for tributaries which may be associated with tempo spatial heterogeneity of soil vegetation geology human interference and other non climatic factors without this study scientific support for mitigating heterogeneous hydrologic hazards under climate change at macroscales would lack one hydro modeling method i e bapmi of unique functionalities and irreplaceable advantages the findings of this study can facilitate extensive applications of bapmi and advance relevant models methods practices etc on the other hand this study can be extended or improved in various aspects typical ones include but are not limited to the followings exploring concurrent variations of multiple hydrologic variables of interests at macroscales using the unique advantage of bapmi enhancing feasibility and reliability of bapmi under hydroclimatic extremes based on extreme value theories metric selection differential modeling or other optional approaches examining possibility of perfecting bapmi skills by considering additional hydro related climatic or other variables e g evapotranspiration based on elimination of data computational and other constraints addressing hydro model overfitting and hydroclimatic relational nonstationarity by improving bapmi algorithmic designs forecasting macroscale hydrologic hazards and their impacts via coupling bapmi with climate projections and impacts analyses eliminating low explainability by elaborating macroscale cold region hydrologic processes based on physics informed variants of bapmi in the context of data abundance developing a dynamic variant of bapmi for advancing real time hydrologic forecasting improving macroscale distributed hydrologic models according to the findings of this study applying bapmi to other macroscale cold region hydrologic or relevant modeling problems e g decomposing impacts of diverse climatic or other factors or discriminating precipitation phases and their changing laws subsequent studies in these aspects will promote contributions of bapmi to advances in macroscale hydrology climate change and other related fields credit authorship contribution statement guanhui cheng conceptualization methodology software formal analysis resources visualization writing original draft writing review editing guohe gordon huang supervision project administration funding acquisition cong dong validation investigation resources data curation declaration of competing interest the authors do not have any competing interests to declare acknowledgements this research was supported by guangdong provincial key laboratory project 2019b121203011 canada research chair program natural science and engineering research council of canada western economic diversification 15269 and mitacs we are very grateful for helpful inputs from the editor the associate editor and anonymous reviewers supplementary materials supplementary materials to this article can be found online at https doi org 10 1016 j jhydrol 2022 128803 supplementary materials the following are the supplementary data to this article supplementary data 1 
2632,a numerical method for solving the unsteady one dimensional advection dispersion equation for solute transport in streams and channels imposed with multiple point loading is presented the numerical technique proposes to solve the equation which also includes a first order decay term and a loading term using techniques similar to those employed by the finite volume method fvm the channel length is segmented into cells and the solution aims at evaluating the concentrations at the cell interfaces or the internal nodes at prescribed time steps for the steady condition of the flow the results are computed commencing from a specified time level with known spatial concentration within the domain it is assumed that the boundary nodes at the two ends of the channel one each at the upstream and the downstream are specified with solute concentration values or its spatial gradient at all times unlike the standard within the cell spatial approximations of a variable assumed in the finite volume or finite element schemes the proposed method models the spatial variation of the solute concentration within a cell by an analytical expression in terms of the concentrations at the two boundary nodes of the cell and the influx rate of point loading if any located within the cell using such a closed form function based upon the true nature of the problem not only helps in capturing the spatial variation of concentration within a cell more precisely but also allows a better approximation of its spatial gradients at the cell interfaces thus helping to achieve a more accurate computation of the inter cell dispersive fluxes the performance of the proposed algorithm is evaluated against analytical benchmarks a standard finite difference scheme and one public domain computational package data sets reported from field tests are used for demonstrating the potential of the technique in simulating real situations keywords rivers transport phenomena numerical scheme advection dispersion data availability data will be made available on request 1 introduction the final disposal route for sewage in some cities of india and possibly of a few other developing countries as well are open drains leading to a larger water body such as a river or the ocean ensink et al 2010 rai et al 2012 shrivastava et al 2012 these drains are joined along their paths with contributing tributary channels for the environmental managers assessing the quality of water over time at key locations along a drain and especially at its outlet poses a major concern with the pioneering work of streeter and phelps 1925 a mathematical or computational prediction of the spatial variation of contaminant concentrations in one dimensional channels and streams affected both by contributions from tributaries and simultaneous decay of the constituents with time has become the acceptable standard worldwide thomann and mueller 1987 chapra 1997 martin and mccutcheon 1999 ji 2008 benedini and tsakiris 2013 of these again the advection dispersion equation ade has largely been preferred solved through different numerical techniques like the finite differences finite elements or finite volume methods o neill 1981 gupta et al 1984 chen and falconer 1992 stamou 1992 wang and lacroix 1997 tsai et al 2002 thongmoon and mckibbin 2006 ghosh et al 2008 ding and zhang 2009 sari et al 2010 szymkiewicz 2010 chen and liu 2011 huang and huang 2011 liao 2012 benedini and tsakiris 2013 wadi et al 2014 loucks and van beek 2017 sanjaya and mungkasi 2017 fu et al 2018 li and rui 2018 gordillo et al 2020 hussain et al 2020 these techniques prescribe dividing the one dimensional length of a channel into smaller computational domains or cells and consider an approximation of the variables within each cell through different spatial interpolation functions linear interpolation schemes generate more numerical diffusion than the higher order schemes although the latter may generate greater oscillations bajellan 2015 the peclet number pe and the courant number or the courant friedrichs lewy number are used to define stability criteria in computational algorithms for keeping a check on the appearance of oscillations and numerical diffusion in the solution ewing and wang 2001 at the same time other mathematical models have also been proposed through analytical approaches li et al 1992 guerrero et al 2010 chen and liu 2011 ahsan 2012 nazir et al 2016 in order to overcome the drawbacks of the numerical techniques like accuracy and stability the motivation for the present work stems from a need to propose a numerical technique that is computationally less expensive than the existing methods while addressing the concerns indicated above such as instability numerical diffusion and oscillations the proposed method is demonstrated for solving the unsteady ade while also incorporating a first order decay term and a loading term for a single branched one dimensional channel though the method may be extended to include tributary branches as well the flow parameters are considered non uniform in space but at a steady state in time while the unsteady solution of the ade accepts time varying point loads of solute and specified boundary conditions in the form of time dependent solute concentrations or their spatial gradients the proposed method requires as in most other numerical methods employed for solving differential equations a division of the channel into smaller reaches termed herein as the computation cells the inter cell boundaries referred to as the internal nodes are the locations where the unknown concentrations are evaluated at subsequent time steps since the flow parameters are assumed to remain constant over time the dispersion and decay coefficients are also be assumed to remain time invariant fischer et al 1979 chapra 1997 although their spatial variations may be accepted the variation of channel flow velocity along the length of the channel required as an input to the proposed solution algorithm obtained by solving the steady state gradually varied flow gvf equation valid for prismatic channels with small bottom slopes as described in chaudhry 2008 the governing equation for this technique is obtained by comparing the total head at specified sections of the channel and approximating the head loss between the sections by the manning s or a similar equation that is valid for uniform flows for a given steady state discharge and a specified downstream flow depth the depth and velocity of flows at the specified sections are obtained by techniques such as the standard step method chaudhry 2008 the discretization of the channel length for this purpose use the computation cell that may be different than the one used for computing the concentration values along the channel linear interpolation is adopted to get the hydrodynamic values at computational cells for calculations of concentration values 2 mathematical formulation the computation steps explained in this section assume that the channel is one dimensional and devoid of any transient storage thus allowing the ade to be accepted as a suitable model for simulating the fate and transport of solutes in open channels we thus seek to find the solution to the one dimensional unsteady equation governing the longitudinal spread dispersion and bodily movement advection of the concentration c of a solute in space and time by the ade expressed in a non conservation form as given below benedini and tsakiris 2013 1 c t v c x e 2 c x 2 k c w f o r 0 x l a n d t 0 in eq 1 x is the spatial coordinate in the direction of flow l l is the total length of the channel l t is the time variable t v is the velocity of flow lt 1 e is the longitudinal dispersion coefficient l2t 1 c is the mass concentration of the pollutant or contaminant or solute ml 3 and w is the lateral load of pollutant expressed as mass rate of influx ml 3t 1 the solute released is assumed to be decaying with time at a rate k assumed as a first order decay coefficient t 1 the solution of eq 1 is possible subject to satisfying the specified initial and boundary conditions an upstream boundary condition signifying a known value of time varying solute concentration may commonly be applied as given below 2 c 0 t c 0 t f o r t 0 at the downstream boundary a condition similar to that of the upstream in the form of a time varying concentration may be specified alternately as suggested in literature for example benedini and tsakiris 2013 a zero value of the spatial gradient of the concentration may be specified at this end as given below 3 c x 0 f o r t 0 a t x l the initial condition assuming a zero concentration of the solute along the length of the channel may be specified as 4 c x 0 0 f o r 0 x l given the above description of solute concentration in space and time for the complete one dimensional domain we proceed to discretizing channel length into cells such that the governing equation may be expressed in terms of unknown concentration values at the cell interfaces referred to here as the internal nodes the solution methodology comprises of assembling the cell equations expressed as discrete linear functions of the unknown nodal concentrations at a given time and applying the boundary conditions to obtain a system of equations which on solving yields the unknown concentrations at a future time this procedure is repeated over discrete time steps till a specified final time is reached fig 1 a shows a general layout of the hypothetical stretch of a typical one dimensional channel that is subdivided into m cells of which n are loaded with single point sources where n m the coordinate axis x is reckoned from the upstream end of the channel pointing downstream a representative cell cell i having boundary coordinates x i 1 and x i and bound by nodes i 1 and i respectively may be assumed to contain a solute loading point say load point j located at coordinate xw j as shown in fig 1 a such a typical loaded cell is shown magnified in fig 1 b some cells however may not contain a load as in fig 1 c or as indicated for some cells in fig 1 a note that there are m 1 cell interfaces or internal nodes separating the m cells at the location of the upstream and the downstream boundaries there are two more nodes where the respective boundary conditions eqs 2 or 3 are specified for the entire simulation time the solute concentrations at all the m 1 nodes of the domain are specified at an initial time say t 0 as given in eq 4 and are computed at subsequent times by solving the governing equation eq 1 subject to the boundary conditions the nodal concentrations thus vary in time and may be written for the node i as c i c i t for implementing the proposed computation technique the channel is segmented into several cells for the purpose of computing the nodal concentrations at the cell interfaces in accordance with the following set of rules 1 the size of a cell be limited to ensure a near uniform velocity within its stretch the steady state velocity being determined as indicated in section 1 and 2 one cell may contain at most one point load thus the size of a cell may span the entire length of the channel provided the flow velocity throughout may be considered uniform and there is at most a single loading point within the channel for such a single cell there would not be any internal node but the boundary nodes at the channel s upstream and downstream ends provide the requisite information for solving the equations on the other hand for a channel divided into several cells the solute concentrations at the internal nodes located at the inter cell boundaries are initially unknown but the two extreme nodes coinciding with the boundary nodes of the domain with specified information help in finding the unknown concentration values at the internal nodes as explained below since the velocity within a cell is assumed to be constant throughout its length it may be denoted as v i for cell i consequently the values of the dispersion coefficient and decay coefficient may also be assumed constant for the cell benedini and tsakiris 2013 and the parameters denoted as e i and k i respectively for the cell if cell i contains the point load w j as shown in fig 1 b then eq 1 may be expressed for the cell i as given below 5 c t v i c x e i 2 c x 2 k i c w j f o r x i 1 x x i note that in eq 5 the space averaged velocity v i in the cell is placed outside of the corresponding first order spatial derivative term the solute concentration of the cell i c is assumed as a variable in space and time while the loading w j is a known quantity defined as a constant or as a function of time that is w j w j t w j is set to zero in eq 5 if cell i has no imposed load as in fig 1 c 3 concentration profile within a cell an assumption is made here that the distribution of concentration within a cell under unsteady conditions is similar to that in the steady state accordingly eq 5 may be written for steady state case as below for a general cell i containing the j th lateral load w j located at coordinate xw j fig 1 b by omitting the time derivative 6 0 v i c x x e i x c x x k i c x w j an analytical expression is now derived for the variation of concentration within the cell between x i 1 and xw j and between xw j and x i eq 6 is observed to be a linear differential equation of order two the general solution of which may be expressed as given below 7 c x c a 1 e γ i x α i x c b 1 e γ i x α i x f o r x i 1 x xw j 8 c x c a 2 e γ i x α i x c b 2 e γ i x α i x f o r xw j x x i in eqs 7 and 8 the parameters γ i and α i for the cell i are solely dependent upon the assumed cell constant values of velocity v i dispersion coefficient e i and decay coefficient k i and are expressed as γ i v i 2 e i and α i γ i m i where m i 1 4 e i k i v i 2 at x x w j where the j th load w j is located the continuity of the concentration needs to be preserved which may be expressed as 9 c x xw j c x xw j c x x w j further the change in mass transport rate at x x w j must be equal to w j resulting in the following mathematical statement implying conservation of the solute specie 10 e i c x v i c x xw j e i c x v i c x xw j w j the four constants appearing in eqs 7 and 8 namely c a 1 c b 1 c a 2 c b 2 may be determined in terms of the local boundary conditions that is the concentrations c i 1 and c i at the two boundaries x i 1 and x i of the i th cell together with eqs 9 and 10 the concentration variation within cell i in space c finally be expressed after some algebraic manipulation in two parts as given below maulik 2006 for x i 1 x xw j 11 c x 2 w j e γ i x xw j q i m i sinh α i x i xw j s i n h α i x x i 1 s i n h α i x i x i 1 c i 1 e γ i x x i 1 s i n h α i x i x sinh α i x i x i 1 c i e γ i x x i s i n h α i x x i 1 sinh α i x i x i 1 for xw j x x i 12 c x 2 w j e γ i x xw j q i m i sinh α i xw j x i 1 s i n h α i x i x sinh α i x i x i 1 c i 1 e γ i x x i 1 s i n h α i x i x sinh α i x i x i 1 c i e γ i x x i s i n h α i x x i 1 sinh α i x i x i 1 for a cell without any point load located within its domain fig 1 c the load term w j in eqs 11 and 12 are equated to zero thus leaving only the last two terms in each equation note that the concentrations c i 1 at x i 1 and c i at x i for the i th cell are as yet unknown and computed as a part of the solution as explained in the next section eqs 11 and 12 represent the closed form solution of concentration within the cell as a function of the length variable x and the contained point load w j in terms of the node concentrations c i 1 and c i as per assumption made these equations are also hold good for the unsteady case represented by eq 5 for the cell i since eqs 11 and 12 express the solute concentration within the i th cell containing the j th load w j as c c x w j eq 5 may be rewritten as below 13 c t v i c x e i x c x k i f o r x i 1 x x i in the following section the principle of solute mass conservation is applied by integrating eq 13 over the cell length and obtaining a balance based on temporal gradients of space averaged concentration values and time averaged flux values at the cell interfaces this is similar in philosophy to that followed by the finite volume method fvm however a within cell variation that is based on the nature of the actual physical problem being simulated is assumed in proposed method which is probably being better than any polynomial variation assumption this is the benefit of the proposed method as compared to other numerical schemes eqs 11 and 12 help in computing the spatial concentration derivatives at the cell interfaces and in turn estimating the inter cell dispersive flux for this purpose a simple average of the gradients of concentration for the two neighboring cells across an interface is used for estimating the inter cell flux which however introduces an approximation error 4 flux balance and computation of nodal concentrations as indicated above eq 13 is integrated over a cell i located between the spatial coordinates x i 1 and x i resulting in an equation of the following form 14 x i 1 x i c t d x v i x i 1 x i c x d x e i x i 1 x i x c x d x k i x i 1 x i c d x in order to use eq 14 for solving the unknown concentrations at the computational nodes of the channel over time the time derivative is approximated by a backward in time implicit finite difference scheme assuming a time step of δ t also the fundamental theorem of calculus that is a b d f f b f a is applied to the advective and dispersive flux terms in eq 14 which is then transformed into the following form 15 x i 1 x i c x i t δ t c x i t δ t d x v c x x i v c x x i 1 t δ t e c x x x i e c x x x i 1 t δ t k i x i 1 x i c x t δ t d x note that in eq 15 the flux and the decay terms are assumed to be at the advanced time level that is at t δ t weighted average values between t and t δ t may also be used instead in eq 15 the last term is integrated over the length of the cell using the analytical expressions for the distribution of concentration within a cell given by eqs 11 and 12 the first two terms on the right hand side of eq 15 are evaluated at the inter cell boundaries by averaging the advective and dispersive fluxes between the two neighboring cells as given below 16 v c x x i t δ t 0 5 v i c x x i i v i 1 c x x i i 1 t δ t 17 v c x x i 1 t δ t 0 5 v i 1 c x x i 1 i 1 v i c x x i 1 i t δ t 18 e c x x x i t δ t 0 5 e i c x x x i i e i 1 c x x x i i 1 t δ t 19 e c x x x i 1 t δ t 0 5 e i 1 c x x x i 1 i 1 e i c x x x i 1 i t δ t in eqs 16 to 19 the superscripts over the concentrations and their gradients denote the cell number and subscripts denote the cell boundaries substituting these expressions appropriately in eq 15 for each cell and subsequently the eq 15 is further simplified by using the analytical expressions for the distribution of concentration within each cell given by eqs 11 and 12 a system of linear equations obtained which may be expressed in the following form 20 δ t a d c t δ t d c t δ t f w 0 where a 1 0 0 0 0 0 q 1 r 1 s 1 0 0 0 p 2 q 2 r 2 s 2 0 0 0 p i q i r i s i 0 0 0 0 0 p m 1 q m 1 r m 1 s m 1 0 0 0 0 p m q m r m c c 0 c 1 c 2 c i c m 1 c m f 1 0 0 0 0 0 0 g 1 h 1 0 0 0 0 f 2 g 2 h 2 0 0 0 0 f i g i h i 0 0 0 0 0 f m 1 g m 1 h m 1 0 0 0 0 0 f m g m w c 0 w 1 w 2 w i w m 1 w m d 0 0 0 0 0 0 a 4 1 a 5 1 0 0 0 0 0 a 4 2 a 5 2 0 0 0 0 0 a 4 i a 5 i 0 0 0 0 0 0 a 4 m 1 a 5 m 1 0 0 0 0 0 0 a 4 m a 5 m the terms in all above matrixes are elaborated in appendix a in eq 20 a f and d are square matrices of size m 1 where m is the number of cells c and w are both column matrices of size m 1 representing the nodal concentration values and loading rates it may be recalled that there may be n load points where n m implying that all cells may not have load injection and for such cells the corresponding entries in w would be zero it is also assumed that the concentration or its gradient is known at the boundary nodes defining the channel these boundary conditions have to be appropriately applied for obtaining the unknown nodal concentrations within the channel as functions of time at any given time step the concentration profile within the cell may be obtained with the help of eqs 11 and 12 and using the computed nodal concentrations the final system of equations eq 20 has to be solved implicitly since the unknowns are the nodal concentration values at any time step the solution methodology may easily be changed to explicit or any other time weighting scheme 5 stability and error analysis 5 1 stability analysis a particular method is stable if the cumulative effect of the entire round off error produced in the application of the algorithm is negligible the round off error at location j and time level t is expressed as ξ j t c j t exactsolution c j t approximatesolution it can be shown that for linear algebraic equations produced by discretization the corresponding error terms satisfy the same homogeneous algebraic equations fletcher 2012 hence the error equations corresponding to eq 20 for cell j and time t δ t produces 21 δ t p j ξ j 2 t δ t δ t q j a 4 j ξ j 1 t δ t δ t r j a 5 j ξ j t δ t δ t s j ξ j 1 t δ t a 4 j ξ j 1 t a 5 j ξ j t 0 the von neumann method was used for the stability analysis in this study since although the matrix method can include the boundary conditions on the overall stability of the scheme previous research in comparing these two methods of stability analysis has indicated that the classical von neumann method is generally to be preferred regardless of the type of the boundary conditions hindmarsh et al 1984 fletcher 2012 in the von neumann method the errors distributed along cell boundaries at one time level are expanded as a finite fourier series then the stability or instability of the computational algorithm is determined by considering whether separate fourier components of the error distribution decay or amplify in progressing to the next time level the error associated with c x t at location j and time level t can be expressed as 22 ξ j t g t e i θ j where the time dependence of this fourier component of the error is contained in the complex coefficient g t and the superscript t implies g is raised to the power t i 1 and θ k δ x and k is the wave number θ varies from 0 θ π nazir et al 2016 the numerical stability of a scheme requires that the amplification factor over one complete time step must satisfy the following condition for all possible values of θ 23 g ξ j t δ t ξ j t 1 substitution of error eq 22 into the eq 21 produces the equation 24 δ t p j g t δ t e i θ j 2 δ t q j a 4 j g t δ t e i θ j 1 δ t r j a 5 j g t δ t e i θ j δ t s j g t δ t e i θ j 1 a 4 j g t e i θ j 1 a 5 j g t e i θ j 0 dividing eq 24 by g t e i θ j and further simplification gives 25 g a 4 j e i θ a 5 j δ t p j e 2 i θ δ t q j a 4 j e i θ δ t r j a 5 j δ t s j e i θ eq 25 is reformed by using euler relation e i θ c o s θ i s i n θ 26 g a 4 j c o s θ a 5 j i a 4 j s i n θ δ t p j c o s 2 θ δ t q j c o s θ a 4 j c o s θ δ t r j a 5 j δ t s j c o s θ i δ t p j s i n 2 θ δ t q j s i n θ a 4 j s i n θ δ t s j s i n θ for eq 26 we obtain 27 g x 1 i y 1 x 2 i y 2 arithmetic operations on complex numbers allow us to write eq 27 as 28 g x 1 x 2 y 1 y 2 x 2 2 y 2 2 i y 1 x 2 x 1 y 2 x 2 2 y 2 2 where 29 x 1 a 4 j c o s θ a 5 j y 1 a 4 j s i n θ and 30 x 2 δ t p j c o s 2 θ δ t q j c o s θ a 4 j c o s θ δ t r j a 5 j δ t s j c o s θ y 2 δ t p j s i n 2 θ δ t q j s i n θ a 4 j s i n θ δ t s j s i n θ the amplification factor of g is a complex number and therefore the stability condition g 1 yields the following relation 31 g x 1 x 2 y 1 y 2 x 2 2 y 2 2 2 y 1 x 2 x 1 y 2 x 2 2 y 2 2 2 1 since 0 θ π then inequality 31 which obtains after substituting the values of x 1 x 2 y 1 y 2 from eq 29 and eq 30 can be verify for its extreme values only nazir et al 2016 hence for θ π we obtain 32 g x 1 x 2 1 a 4 j a 5 j a 4 j a 5 j δ t p j q j r j s j 1 the terms in eqs 23 32 are shown in appendix a from parametric analysis it is known that inequalities given in eq 32 are satisfied for any value of v e k and δ t but these inequalities are dependent on r which is the ratio between one cell length to the next cell length it is expressed for cell i from fig 1 as 33 r i x i x i 1 x i 1 x i w h e r e i 1 2 m hence plotting the modulus of amplification factor g versus r shown in fig 2 concluded graphically that the proposed method for unsteady advection and dispersion equation under multiple loading is stable for r 1 and the stability of the scheme at all time step values is consistent with the backward in time treatment of the temporal concentration gradient 5 2 error analysis in determining the accuracy of the proposed discretization method highlighted herein the truncation error te has to be identified the truncation error is the error caused by approximating a mathematical process it is the difference between the original equations to truncated equation or discretized equation original partial differential equation at cell j at time t δ t is c x t t j t δ t v c x x j t δ t e x c x x j t δ t k c x j t δ t 0 when substituting the eqs 16 19 appropriately in eq 15 for cell j at time t δ t the resulted discretized equation is x j 1 x j c x j t δ t c x j t δ t d x 0 5 v j c x x j j v j 1 c x x j j 1 t δ t 0 5 v j 1 c x x j 1 j 1 v j c x x j 1 j t δ t 0 5 e j c x x x j j e j 1 c x x x j j 1 t δ t 0 5 e j 1 c x x x j 1 j 1 e i c x x x j 1 j t δ t k j x j 1 x j c x d x t δ t 0 applying x for eq 35 and simplified as follows c x j t δ t c x j t δ t 0 5 v c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x x j t δ t 0 5 e x c x j x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j t δ t k c x j 1 t δ t 0 from taylor series expansion f t δ t f t δ t df dt o δ t 2 hence eq 36 can be written as 37 c x j t δ t c x t t j c x j t δ t o δ t 2 j 0 5 v c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x x j t δ t 0 5 e x c x j x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j t δ t k c x j 1 t δ t 0 therefore the te e q 37 e q 34 te 38 0 5 v c x x j t δ t 0 5 e x c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 e x c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j 1 t δ t o δ t 2 j te space 0 5 v c x x j t δ t 0 5 e x c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 e x c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j 1 t δ t te time o δ t 2 j further simplification of eq 38 by substituting eqs 11 and 12 showed that the leading temporal term is second order in time implying that the numerical scheme is first order accurate in time and the spatial te that is te space is tending to zero when the differences of γ α from one cell to another cell are tending to 0 at r j 1 j 1 2 m in the case of variations of v e and k spatial truncation error varies with the influence function of 1 k α γ m 6 steady state water quality solution although the proposed method helps in obtaining the changes in concentration in a channel at very fine granularity of time and space a large number of environmental management decisions are based upon time averaged flows and pollution loads in such cases the best option would be to use the solutions of steady state conditions which may easily be achieved by ignoring the time derivative in eq 13 following other approximations as indicated in eqs 16 through 19 and incorporating the prescribed conditions at the boundaries of the channel for steady state conditions an equation of the following form results 39 a c f w 0 eq 39 whose matrices are similar to those of eq 20 represents a system of linear equations in terms of the nodal concentrations and may be evaluated using suitable matrix methods a steady state solution such as that discussed here is also useful in checking the accuracy of the proposed method for multiple point loads since an analytical solution is not available for the time varying version of this case additionally solutions by other numerical methods may be subject to their specific limitations in the following sections the proposed method is tested against steady and unsteady cases with hypothetical data followed by field application 7 model performance 7 1 steady state water quality dynamics sensitivity analysis the main aim of the case study is to study the behavior of relative error obtained between the proposed and exact solutions at various ranges of v e k r and cell lengths at a particular location of the channel consider the particular case of eq 1 with lateral loads for the following boundary conditions c x 0 a t x c x 0 a t x in this case a uniform channel v e both constant is subject to a steady inflow discharge q and two steady lateral point source loads w1 w2 of a contaminant which decays at a constant rate k it is presumed that the loads from the point sources are small compared to the inflow discharge exact solution of the particular case is given in thomann and mueller 1987 by taking the exact solution as a reference sensitivity analysis of the proposed method is evaluated the length of the channel l is considered as 50 km with w 1 500 mg s at xw 1 10 km and w 2 500 mg s at xw 2 35 km and at a steady inflow discharge q 360 m3 hr c x 0 is applied at the upstream x 0 and c x 0 is applied at the downstream x l of the channel since the exact solution is available at a channel length that is theoretically infinite it may not possible to compare both model results near the boundaries hence the relative error re between the value predicted by the proposed method and the true value given by the exact solution is calculated at a location x 15 km which is not too near to boundaries for several values of v ranging from low 0 36 km hr to high 3 6 km hr and several values of e and k simulations are carried out for a wide range of r including r 1 i e uniform cell and with varying cell lengths for each simulation following relation is used for re calculations re predictedvalue t r u e v a l u e truevalue the results of all simulations are presented graphically in figs 3 and 4 in fig 3 horizontal axis is representing the cell length that is numerator in the expression for r refer eq 33 for example if the cell which lies x 15 km is having cell lengths for r 4 are 2 km 5 km 10 km and 15 km then the next cell lengths the denominator in the expression for r should be 0 5 km 1 25 km 2 5 km and 3 75 km respectively during segmentation it is confirmed from fig 3 that at a particular location re remains unchanged for a particular combination of v k and e for every cell length at all values of r 1 fig 4 shown that re decreases with increasing values of v moreover re increases with increasing values of e fig 4 a and decreases with increasing values of k fig 4 b it is confirmed from fig 4 that re is influenced by the function 1 k α γ m refer section 5 at variations of v k and e it may thus be inferred that the proposed method is applicable to all ranges of advective velocities while being independent of the cell size 7 2 steady state water quality dynamics field application maulik 2006 conducted field experiments as a part of research for obtaining the observed bod5 5 day biochemical oxygen demand concentration values at six strategic locations within the study area as shown in fig 5 the 45 km stretch of the hooghly river investigated is close to the city of kolkata erstwhile calcutta in eastern india and spans between the towns of palta and uluberia both a part of the larger administrative district known as the kolkata metropolitan area the stretch of the river under consideration being located in the upper estuary of the river is influenced by diurnal tidal circulations and the study stretch has been shown to be well mixed by maulik 2006 on the basis of method available in thatcher and harleman 1972 hence one dimensional model is applicable for the study stretch to obtain the representative concentrations of steady state slack tide sampling procedure as described in chapra 1997 and thomann and mueller 1987 is followed during each sample collection the observed bod5 values acquired by a team through concurrent measurements on april 6 2004 and may 24 2004 along the study stretch are used for analyzing the performance of the proposed method the common input data for both days are presented in appendix b steady inflow discharges to the study stretch on both days are 2 10 106m3 hr and 2 02 106m3 hr respectively to run the proposed method for this field case the observed bod5 concentration value at palta on the upstream and uluberia on the downstream are used as boundary conditions performance of a water quality model depends on the degree of accuracy of numerical estimation and physical measurement of the model parameters most of the model parameters can be measured physically but physical measurements involve considerable costs and manpower some of the parameters are therefore estimated through model calibration in this study the tidal dispersion coefficient e is estimated by the method proposed by thomann and mueller 1987 and the value of e i for the cell i is obtained as below e i v i x 2 x 1 l n sl 2 sl 1 in the above expression v i advective velocity for the cell i and sl 1 sl 2 salinities of the water represented by the chloride concentrations at two arbitrary point s x 1 and x 2 respectively if chloride concentration is plotted against river stretch measured from upstream on a semi logarithmic scale then considering two arbitrary points in the graph the slope l n sl 2 sl 1 x 2 x 1 may be calculated the slope which also equals v i e i permits estimation of the tidal dispersion coefficient e i provided that the velocity v i is known the velocity v i of cell i obtained from the net flow and cell s mean area of cross section a i maulik 2006 collected the chloride concentration data under similar hydraulic conditions as the bod5 data and provided the following expression for the dispersion coefficient for the study stretch e i k m 2 h r 728 08 v i k m h r genetic algorithm ga mohan and loucks 1995 meier and barkdoll 2000 is used as a calibration technique for estimation of k value the study area is a well mixed tidal stretch and k value is not expected to change drastically within the stretch martin and mccutcheon 1999 mentioned that in steady state models the forcing functions are time averaged the temporal scale used in such cases may be for a week or even longer since the flow patterns and wastewater discharge characteristics do not change drastically within a month for the study area the input averaged over all tidal cycles in each month is used for estimation of the monthly k values the monthly averages of water quality parameters bod 5 objerved are calculated using the water quality monitoring records of 1996 2000 this five year data is available with the west bengal pollution control board to predict the bod 5 values from the proposed method the study stretch is divided into 260 cells based on the model criteria that is each cell should contain single or no lateral point sources refer fig 1 and r 1 therefore cell lengths are varied from 40 m to 1 10 km for given input data refer appendix b the ga has run 500 times with following objective function to ensure the best combinations of the control parameters for satisfactory convergence in optimal solution the combination used for ga is population 80 generation 120 cross over probability 0 8 and mutation probability 0 062 for a search space of k ranging from 0 3 to 0 5 ng 2001 objective function min i bod 5 objerved i bod 5 predicted i 2 where bod 5 objerved i bod5 concentration value as actual measurement at i th location bod 5 predicted i bod5 concentration value obtained by the proposed method using different sets of parameters as selected by the ga operators at i th location the calibrated values of k for april and may months are 0 38 hr and 0 46 hr respectively the obtained profile of velocity and estimated dispersion coefficient along the study stretch are shown in fig 6 a and b respectively fig 6 c and d respectively showed a comparison of results of the spatial variation of bod5 concentration values along the study stretch for the two days on which the observations are made that is april 6 2004 and may 24 2004 for this field application the performance of the proposed method is carried out using correlation coefficient r and chi squared goodness of fit test at 95 percent confidence level results from the performance analyses are presented in table 1 correlation coefficient r this coefficient is used to quantitatively express the relationship between two variables and is defined as r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 where o is the average observed value and p is the average predicted value the range of r varies from 0 randomly related to 1 perfectly related ji 2008 the values of r in the table 1 indicate a fairly good correlation between the predicted results and the observed data acquired on april 6 2004 and may 24 2004 for the study stretch of hooghly river the chi squared values also indicate that the predicted and observed results are not significantly different from each other at a 95 percent confidence level on both observed days the proposed method is further run to study the behavior of relative error obtained between predicted and observed values for a wide range of r including r 1 i e uniform cell and with varying cell lengths re is calculated at location b garden shown in fig 5 for both april 6 2004 and may 24 2004 events at a particular combination of v 0 12 km hr k 0 38 hr e 24 0 km2 hr and v 0 1 km hr k 0 46 hr e 22 0 km2 hr respectively a summary of the results is shown graphically in fig 7 as similar to fig 3 fig 7 further strengthen the statement with field application that at a particular location re remains unchanged for a particular combination of v k and e for every cell length at all values of r 1 from the results it may be inferred that the proposed method has a reasonably acceptable accuracy for field application such as hooghly river 7 3 unsteady state water quality dynamics computational efficiency consider the one dimensional advection dispersion eq 1 without lateral loads w 0 for the following initial and boundary conditions c x 0 0 f o r x 0 c 0 t c 0 f o r t 0 c t 0 f o r t 0 in this case a uniform channel v e both constant in space and time is subjected to a steady inflow discharge q and a continuous upstream loading c 0 of a contaminant which decays at a constant rate k the exact solution of the particular case is given in runkel 1996 by taking the exact solution of this case as a reference the performance and computational efficiency of the proposed method is compared with the implicit finite difference crank nicholson or cn scheme chapra 1997 and the public domain computational package hec ras which uses the quickest ultimate explicit numerical scheme for solving the water quality equations brunner 2010 advection problems sometimes present challenges resulting in non physical oscillations in order to avoid such spatial oscillations it is generally recommended that the peclet number pe which is the ratio of the rate of advection transport to the rate of diffusive dispersive transport v δ x e should be less than or equal to 2 for the cn scheme chapra 1997 benedini and tsakiris 2013 and the universal limiter ultimate employed by hec ras leonard 1979 leonard 1991 here the performance of the proposed method is carried out against cn hec ras and exact solutions at both pe 2 and pe 2 for accuracy and computational efficiency comparisons this is done at a uniform velocity v 3 6 km hr dispersion coefficient 1 0 k m 2 h r and decay coefficient k 0 036 hr by considering four cases a uniform cell size 0 5 km δ t 0 5 hr at p e 2 b uniform cell size 0 5 km δ t 1 0 hr at p e 2 c uniform cell size 2 0 km δ t 0 5 hr at p e 2 d uniform cell size 2 0 km δ t 1 0 hr at p e 2 simulations are carried out for a time of 10 h with a continuous upstream loading c 0 10 mg l and steady inflow discharge q 360 m3 hr the length of the channel l 30 km with the spatial gradient of concentration at the downstream end of the channel x l applied as c x 0 for proposed cn and hec ras methods for hec ras it is necessary to run the steady flow analysis in order to run the water quality module steady flow analysis required steady flow data which consists of boundary conditions and discharge information brunner 2010 therefore a 1 m wide rectangular channel having water surface elevations of 0 1 m and 0 101 m at the upstream and downstream ends of the domain respectively is assumed and steady inflow discharge q 360 m3 hr is given as input to get the uniform velocity v 3 6 km hr the obtained concentration profiles of all three models along with exact solution are shown graphically in fig 8 from fig 8 it may be observed that the results from the cn method are agreeable when the pe 2 at a time step of 0 5 hr but the method starts producing oscillations if either the pe or the time step for computation is increased in the case of hec ras results oscillations are suppressed due to a universal limiter in all cases nevertheless a phase lag dispersion is generated which increases with time step fig 8 b d on other hand the numerical results of the proposed method show good agreement with those given by the exact solutions and are more accurate than those of the cn and hec ras methods at high peclet numbers fig 8 c d and large time steps fig 8 b d furthermore significant differences in computational times are observed among the proposed cn and hec ras methods based on cell size and time step used as may be seen from table 2 which compares the cpu time taken on an intel core i5 machine for one time step of the three methods with a time step of 0 5 hr it is evident from table 2 that the proposed method is at least 45 times faster than hec ras and 35 times faster than cn methods in practical terms this implies that the proposed method offers a more efficient solution with less computational time as it is possible to use larger cell sizes while maintaining the same accuracy in predicting the variables from fig 8 it is also observed that the proposed cn and hec ras methods exhibit minor deviations from the exact solution at downstream boundary and these deviations are seen to increase with time since the exact solution is available at a channel length that is theoretically infinite the study is further carried out to check the behaviour of the proposed cn and hec ras methods at downstream boundary as the channel length increases from 10 to 1000 km the cell size and time step are held constant at 0 5 km and 0 5 hr respectively and the results are compared at time t 4 hr the observed results shown in fig 9 indicate that deviations from the exact solution decrease in all three methods as the channel length is increased in proposed method however the deviations decrease rather rapidly compared to both cn and hec ras methods the results of the unsteady state simulations help in establishing the proposed method as a sufficiently accurate and computationally efficient unsteady water quality predicting method it may worth emphasizing that the accuracy of the method stems from the assumption of an analytical variation of the concentration within a cell eqs 11 and 12 in comparison to the polynomial variations employed by other popular numerical techniques 7 4 unsteady state water quality dynamics field application nordin and sabol 1974 conducted field experiments for determining the longitudinal dispersion coefficient e for various creeks rivers and canals and these observations being published in the u s geological survey reports here the observed data at two sampling points of antietam creek usa obtained on may 27 1969 are considered from the reference for analyzing the performance of the proposed method against hec ras under steady flow conditions the data includes 1 a mass of a conservative solute injected instantaneously at a specific location in the creek 2 time concentration data at two predetermined sampling sites downstream of the injection site 3 distance of the sampling sites from the point of injection 4 flow velocities and discharges in the river at the sampling sites and 5 mixing length of the river the amount of pure tracer m released instantaneously at t 0 and x 0 is 463 6 g 1 022 lb and mixing length of the creek is 0 7 km hence for simulations of the proposed method a one dimensional system in the x direction is considered with the initial conditions c 0 0 m δ x where δ is the dirac delta function and a zero value of the spatial gradient of the concentration is specified at the downstream boundary the concentration of tracer was observed at sampling point 1 for 8 h with a time interval δ t 0 2 h r and then observation of the concentration of tracer at sampling point 2 was commenced for the next 14 h with δ t 0 5 h r as reported the distances of the first and second sampling sites from the point of injection x 0 were 2 574 and 9 574 km respectively there was no appreciable difference in the discharges at these two sites but the flow velocities at sampling sites 1 and 2 were 1 108 and 0 746 km hr respectively and steady inflow discharge was about 4200 m3 hr the simulation domain considered extends from x 0 km to x 9 574 km it is assumed that velocity of the creek from point of injection up to the first sampling site is constant that is 1 108 km hr thus the stretch between points of injection to the first sampling location is assumed as a single cell that is having 2 574 km length and next cell lengths should not be greater than 2 574 km imposed by the stability condition r 1 of the proposed method therefore the stretch between the first and the second sampling points is divided into three cells measure 2 574 km 2 574 km and 1 852 km consecutively assuming a linear variation in velocity between sampling sites 1 and 2 velocity values are interpolated at each intermediate cell node based on available velocity values at these two sites further mean velocity v values are computed for each cell by averaging the velocity values at each cell boundary steady state dispersion coefficient e values for each cell i lies between sampling site 1 and 2 are estimated by a well known method of moments valentine and wood 1979 with the following expression e i v i 2 2 σ 2 2 σ 1 2 t 2 t 1 i 2 t o 4 where σ 1 2 and σ 2 2 are variances of concentration time profiles at sampling sites 1 and 2 respectively while t 1 and t 2 are means of the two concentration time profiles for the cell from point of injection up to the first sampling site σ 2 2 and t 2 are considered at sampling site 1 whereas σ 1 2 0 and t 1 0 are considered at injection point chapra 1997 the summary of computed mean velocity and dispersion coefficient values for each cell of the proposed method is presented in table 3 in hec ras the total simulation domain is divided into 4 cells having the same cell lengths of that proposed method for steady flow analysis in order to get the flow velocities given at site 1 and 2 water surface elevations of 0 5 m and 0 61 m are considered at upstream and downstream ends of the domain respectively and the steady inflow discharge being about 4200 m3 hr is given as input to hec ras for water quality analysis the area under the graph of the observed concentration versus time curve was computed as 110 945 μ g l division of the ordinates of the observed concentration by the mass of the impulse input gives the concentration graph for a unit impulse input and the concentration values c 0 0 110 945 μ g l c 0 t 0 f o r t 0 c x 0 0 f o r x 0 are given as upstream boundary conditions in hec ras a computational time step δ t 0 2 hr is considered for both hec ras and proposed methods and similar dispersion coefficient values presented in table 3 are given as input to hec ras for each cell the predicted time concentration profiles obtained by both the proposed method and the hec ras model are presented in fig 10 the corresponding performance evaluation metrics are presented in table 4 in this study the coefficient of determination for concentration r 2 root mean square error for concentration rmse peak concentration c per expressed as c per simulated peak concentration observed peak concentration 1 100 and error in time to peak concentration t pcer expressed as t pcer time to simulated peak concentration time to observed peak concentration are used to evaluate the solute transport capability of the proposed method and hec ras models from fig 10 it is apparent that the simulated profile predicted by hec ras differs substantially from that observed data at sampling point 2 located at x 9 574 km discontinuity raised due to instantaneous point source at upstream of the domain is the main concern in hec ras on the other hand the proposed method is found to simulate and successfully predict the concentration response in the antietam creek 8 advantages of the proposed method although the modeler may be discouraged from applying the proposed method because of its lengthy and complex expressions the method has certain advantages which as summarized below may prove advantageous overall in the conventional numerical methods the variation of concentration from one cell node to another relies on the discrete derivative approximation in proposed method however a continuous profile of concentration within a cell is inherently assumed as an analytical expression based upon the governing equation of the problem the contributions within the cell due to the concentration at its boundaries as well as the lateral loadings are separately identifiable explicitly in an analytical form this is helpful to policymakers in prioritizing remedial actions in actual cases by controlling the significant sources affecting a cell the proposed method is independent of cell sizes in case of uniform cell size throughout the channel length this is often useful for river stretches where the outfalls are located in close proximity interspersed with wide gaps in an unplanned manner in case of variable cell sizes as per the stability criteria of the proposed method cell lengths must reduce in the downstream direction however this condition may not affect the computational efficiency of the proposed method in all case studies on the other hand for hec ras and cn methods anyway their cell size should be small and equal throughout the domain for accurate results in the formulation of the proposed method a lateral loading source may be placed anywhere within the cell and not necessarily at the cell s centre without affecting the accuracy of the model the proposed method by virtue of its formulation may be applied for any number of cells although limited to steady flows it is applicable for variable parameters such as the dispersion coefficient velocity and decay coefficient which could be functions of space however the parameters need to be approximately uniform within each cell for a given time step 9 limitations and future scope of the proposed method based on the observations of the present investigations the following limitations are made for further development and validation of the proposed method the proposed method is limited to steady flow conditions therefore the possibility of proposed method for unsteady flow conditions may also be developed the ability to use a variable cell length would appear to be an advantage however in some cases the stability condition reduces the efficacy of this claim by introducing unnecessary refined cells application of the proposed method is may be extended to rivers with a number of tributaries or branch outs with considerable flow the formulation may be suitably modified for two dimensional cases with vertical salinity gradient 10 conclusions in the present study a numerical solution approach for the one dimensional unsteady advection dispersion equation under multi point loading is investigated to assess the transport of both non conservative and conservative solutes in open channel flows for assessing the proposed method a range of preliminary test cases are performed the results being compared with analytical results and numerical solutions obtained using the cn method and the commercial software package hec ras the comparisons indicate that proposed method is independent of cell sizes and superior to the cn scheme and the computations carried out by hec ras the efficiency of the proposed method is judged further by validating with the field data obtained by maulik 2006 in the tide dominated hooghly river under steady advection dispersion conditions the observed data of nordin and sabol 1974 for the antietam creek at steady flows are used to prove the model s worthiness under unsteady advection dispersion conditions the study therefore attempts to establish that the proposed numerical approach can be used with confidence in simulating the concentration response in natural rivers estuaries and creeks it may be applied on any number of cells and the cells sizes can vary widely without affecting the precision of the output the stability condition however requires that if the cell size varies it must decrease in the downstream direction 11 declaration funding na conflict of interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper ethics approval na consent to participate all patients included in this study gave consent to participate in this research consent for publication all patients included in this research gave consent to publish the data and images contained within this case report availability of data and material all data produced from this study are provided in this manuscript in the form of graphical representation code availability all codes are available in matlab r2009 version declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the several important and in depth suggestions made by the anonymous reviewers are gratefully acknowledged which have helped in improving the original presentation substantially appendix appendix a a1 q 1 v 1 a 1 1 2 a 2 1 k 1 a 4 1 a2 r 1 0 5 v 1 v 2 a 3 1 a 2 2 2 a 6 1 k 1 a 5 1 a3 s 1 a 6 2 a4 p i a 1 i 1 i 2 3 m 1 a5 q i 0 5 v i v i 1 a 1 i a 2 i a 3 i 1 k i a 4 i i 2 3 m 1 a6 r i 0 5 v i v i 1 a 3 i a 2 i 1 a 6 i k i a 5 i i 2 3 m 1 a7 s i a 6 i 1 i 2 3 m 1 a8 p m a 1 m 1 a9 q m 0 5 v m v m 1 a 2 m a 3 m 1 k m a 4 m a10 r m v m a 6 m k m a 5 m a11 g 1 b 1 1 b 2 1 e 1 2 k 1 γ 1 2 α 1 2 e 1 b 1 1 h 1 e 2 b 1 2 a12 f i e i 1 b 2 i 1 g i e i 2 k i γ i 2 α i 2 b 1 i b 2 i h i e i 1 b 1 i 1 i 2 3 m 1 a13 f m e m 1 b 2 m 1 g m b 1 m e m 2 k m γ m 2 α m 2 2 k m b 2 m γ m 2 α m 2 where a14 a 1 i e i α i e γ i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a15 a 2 i e i γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a16 a 3 i e i γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a17 a 4 i α i e γ i x i x i 1 γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 γ i 2 α i 2 s i n h α i x i x i 1 i 2 3 m 1 a18 a 5 i α i e γ i x i x i 1 γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 γ i 2 α i 2 s i n h α i x i x i 1 i 2 3 m 1 a19 a 6 i e i α i e γ i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a20 b 1 i α i q i m i s i n h α i x i xw i s i n h α i x i x i 1 e γ i x i 1 xw i i 2 3 m 1 a21 b 2 i α i q i m i s i n h α i xw i x i 1 s i n h α i x i x i 1 e γ i x i xw i i 2 3 m 1 appendix b input data for steady state case under multipoint loading field application section 7 2 wj kg d xwj km xi km ai m2 xi km ai m2 4 02 1 55 0 75 9251 24 22 40 13013 72 60 00 1 95 1 18 11555 17 22 83 13460 00 75 60 3 69 1 57 9898 82 23 23 12331 40 2 70 4 15 1 96 10003 12 23 58 14707 60 48 60 4 99 2 20 9961 60 23 89 16250 90 125 40 5 92 2 44 9607 20 24 13 15601 55 213 20 6 71 2 71 8509 38 24 38 16319 67 0 16 7 34 2 91 8915 99 24 73 15225 76 0 06 7 73 3 18 12478 08 24 97 13154 75 15 25 8 32 3 42 16535 77 25 23 14429 50 3 00 8 94 3 70 16423 64 25 63 11566 81 0 02 10 18 4 17 16543 04 26 23 11958 00 0 01 10 42 4 52 15421 11 26 74 12168 17 63 65 10 93 4 76 13913 86 27 01 13077 13 0 15 11 09 5 00 13985 76 27 13 12353 06 0 18 11 63 5 27 14899 76 27 36 11630 77 0 32 11 87 5 53 16991 89 27 64 12918 00 165 60 12 43 5 73 17134 06 27 83 13063 07 153 00 12 98 5 93 16785 22 28 18 13403 41 84 60 13 37 6 12 16614 83 28 61 13316 60 4 72 13 63 6 32 16942 20 29 21 12673 50 0 77 13 94 6 73 14328 51 29 84 12617 00 17 99 14 17 7 15 15033 13 30 79 15508 32 16 83 14 48 7 34 14775 06 32 30 17000 91 3 27 15 24 7 54 13298 54 33 30 17779 50 26 08 15 63 7 74 13264 12 33 70 18401 85 154 85 15 83 7 93 12508 21 34 05 21821 50 47 25 16 12 8 13 12019 37 34 37 28379 50 0 62 16 31 8 33 11784 64 34 76 22657 50 102 90 16 63 8 45 11784 64 35 15 20356 55 9 63 16 79 8 54 12136 81 35 61 21583 19 126 90 17 01 8 73 12045 53 36 07 23940 50 729 75 17 25 9 03 12441 62 36 38 22991 94 1 28 18 06 9 39 14136 91 37 62 17008 00 1 62 18 21 9 61 14627 26 38 93 19353 24 0 08 18 49 9 83 14302 25 39 37 19741 04 5 13 18 80 10 20 15117 16 39 86 18131 00 3 95 19 01 10 43 15149 40 40 32 17720 00 637 13 19 23 10 67 14352 52 40 68 17001 10 1 14 19 30 10 94 12816 00 41 03 17616 71 0 36 19 61 11 09 13311 23 41 36 18083 00 249 65 19 77 11 24 13816 19 41 56 18083 00 16 80 20 03 11 39 14020 12 41 78 19038 00 3 78 20 37 11 51 14775 01 42 61 18156 50 123 20 20 62 11 63 14775 01 43 71 19832 49 6 24 20 79 11 88 14326 14 44 24 20088 09 759 00 21 28 12 06 14472 50 44 43 20297 50 2 18 21 95 12 25 14425 00 44 71 20782 93 780 85 22 38 12 44 14440 19 44 91 21520 17 3 40 22 82 12 57 14192 95 97 76 23 21 12 99 13272 28 0 20 23 57 13 39 12745 19 84 52 23 88 13 64 12014 19 177 03 24 12 13 95 12166 89 496 00 24 37 14 17 12075 16 2 52 24 72 14 33 12547 31 1 77 24 96 14 49 12987 28 17 70 25 22 14 70 13360 80 116 55 25 61 14 98 13426 89 69 66 26 20 15 25 13878 50 21 76 26 72 15 51 13883 05 0 09 27 00 15 63 14801 00 59 43 27 12 15 84 14948 50 21 23 27 35 16 14 14010 50 106 47 27 63 16 25 14159 92 0 01 27 82 16 32 15348 94 2109 00 28 17 16 47 16647 84 0 14 28 59 16 63 16590 50 2 08 29 19 16 80 16441 00 0 43 29 82 16 92 16731 50 0 12 30 75 16 94 16731 50 99 10 32 24 17 10 16907 50 292 00 33 26 17 25 17274 00 0 59 33 68 17 65 22128 50 45 36 34 04 18 08 16934 00 0 04 34 35 18 22 16608 76 14 66 34 74 18 33 16569 71 85 60 35 14 18 49 17441 86 0 63 35 59 18 65 17857 57 22 10 36 05 18 81 17380 38 108 50 36 36 18 96 15895 12 120 00 37 54 19 11 15556 48 18 36 38 88 19 24 16278 15 0 12 39 35 19 30 16278 15 3 24 39 84 19 46 15601 50 6 45 40 30 19 62 14580 00 22 44 40 66 19 78 14014 42 7 56 41 02 20 04 12668 00 0 78 41 35 20 38 12854 00 0 45 41 55 20 63 13186 12 38 50 42 57 20 79 13568 43 3 04 43 67 20 98 13239 14 20 88 44 22 21 29 14438 97 0 54 44 43 21 69 11684 00 5 25 44 70 21 97 14010 00 
2632,a numerical method for solving the unsteady one dimensional advection dispersion equation for solute transport in streams and channels imposed with multiple point loading is presented the numerical technique proposes to solve the equation which also includes a first order decay term and a loading term using techniques similar to those employed by the finite volume method fvm the channel length is segmented into cells and the solution aims at evaluating the concentrations at the cell interfaces or the internal nodes at prescribed time steps for the steady condition of the flow the results are computed commencing from a specified time level with known spatial concentration within the domain it is assumed that the boundary nodes at the two ends of the channel one each at the upstream and the downstream are specified with solute concentration values or its spatial gradient at all times unlike the standard within the cell spatial approximations of a variable assumed in the finite volume or finite element schemes the proposed method models the spatial variation of the solute concentration within a cell by an analytical expression in terms of the concentrations at the two boundary nodes of the cell and the influx rate of point loading if any located within the cell using such a closed form function based upon the true nature of the problem not only helps in capturing the spatial variation of concentration within a cell more precisely but also allows a better approximation of its spatial gradients at the cell interfaces thus helping to achieve a more accurate computation of the inter cell dispersive fluxes the performance of the proposed algorithm is evaluated against analytical benchmarks a standard finite difference scheme and one public domain computational package data sets reported from field tests are used for demonstrating the potential of the technique in simulating real situations keywords rivers transport phenomena numerical scheme advection dispersion data availability data will be made available on request 1 introduction the final disposal route for sewage in some cities of india and possibly of a few other developing countries as well are open drains leading to a larger water body such as a river or the ocean ensink et al 2010 rai et al 2012 shrivastava et al 2012 these drains are joined along their paths with contributing tributary channels for the environmental managers assessing the quality of water over time at key locations along a drain and especially at its outlet poses a major concern with the pioneering work of streeter and phelps 1925 a mathematical or computational prediction of the spatial variation of contaminant concentrations in one dimensional channels and streams affected both by contributions from tributaries and simultaneous decay of the constituents with time has become the acceptable standard worldwide thomann and mueller 1987 chapra 1997 martin and mccutcheon 1999 ji 2008 benedini and tsakiris 2013 of these again the advection dispersion equation ade has largely been preferred solved through different numerical techniques like the finite differences finite elements or finite volume methods o neill 1981 gupta et al 1984 chen and falconer 1992 stamou 1992 wang and lacroix 1997 tsai et al 2002 thongmoon and mckibbin 2006 ghosh et al 2008 ding and zhang 2009 sari et al 2010 szymkiewicz 2010 chen and liu 2011 huang and huang 2011 liao 2012 benedini and tsakiris 2013 wadi et al 2014 loucks and van beek 2017 sanjaya and mungkasi 2017 fu et al 2018 li and rui 2018 gordillo et al 2020 hussain et al 2020 these techniques prescribe dividing the one dimensional length of a channel into smaller computational domains or cells and consider an approximation of the variables within each cell through different spatial interpolation functions linear interpolation schemes generate more numerical diffusion than the higher order schemes although the latter may generate greater oscillations bajellan 2015 the peclet number pe and the courant number or the courant friedrichs lewy number are used to define stability criteria in computational algorithms for keeping a check on the appearance of oscillations and numerical diffusion in the solution ewing and wang 2001 at the same time other mathematical models have also been proposed through analytical approaches li et al 1992 guerrero et al 2010 chen and liu 2011 ahsan 2012 nazir et al 2016 in order to overcome the drawbacks of the numerical techniques like accuracy and stability the motivation for the present work stems from a need to propose a numerical technique that is computationally less expensive than the existing methods while addressing the concerns indicated above such as instability numerical diffusion and oscillations the proposed method is demonstrated for solving the unsteady ade while also incorporating a first order decay term and a loading term for a single branched one dimensional channel though the method may be extended to include tributary branches as well the flow parameters are considered non uniform in space but at a steady state in time while the unsteady solution of the ade accepts time varying point loads of solute and specified boundary conditions in the form of time dependent solute concentrations or their spatial gradients the proposed method requires as in most other numerical methods employed for solving differential equations a division of the channel into smaller reaches termed herein as the computation cells the inter cell boundaries referred to as the internal nodes are the locations where the unknown concentrations are evaluated at subsequent time steps since the flow parameters are assumed to remain constant over time the dispersion and decay coefficients are also be assumed to remain time invariant fischer et al 1979 chapra 1997 although their spatial variations may be accepted the variation of channel flow velocity along the length of the channel required as an input to the proposed solution algorithm obtained by solving the steady state gradually varied flow gvf equation valid for prismatic channels with small bottom slopes as described in chaudhry 2008 the governing equation for this technique is obtained by comparing the total head at specified sections of the channel and approximating the head loss between the sections by the manning s or a similar equation that is valid for uniform flows for a given steady state discharge and a specified downstream flow depth the depth and velocity of flows at the specified sections are obtained by techniques such as the standard step method chaudhry 2008 the discretization of the channel length for this purpose use the computation cell that may be different than the one used for computing the concentration values along the channel linear interpolation is adopted to get the hydrodynamic values at computational cells for calculations of concentration values 2 mathematical formulation the computation steps explained in this section assume that the channel is one dimensional and devoid of any transient storage thus allowing the ade to be accepted as a suitable model for simulating the fate and transport of solutes in open channels we thus seek to find the solution to the one dimensional unsteady equation governing the longitudinal spread dispersion and bodily movement advection of the concentration c of a solute in space and time by the ade expressed in a non conservation form as given below benedini and tsakiris 2013 1 c t v c x e 2 c x 2 k c w f o r 0 x l a n d t 0 in eq 1 x is the spatial coordinate in the direction of flow l l is the total length of the channel l t is the time variable t v is the velocity of flow lt 1 e is the longitudinal dispersion coefficient l2t 1 c is the mass concentration of the pollutant or contaminant or solute ml 3 and w is the lateral load of pollutant expressed as mass rate of influx ml 3t 1 the solute released is assumed to be decaying with time at a rate k assumed as a first order decay coefficient t 1 the solution of eq 1 is possible subject to satisfying the specified initial and boundary conditions an upstream boundary condition signifying a known value of time varying solute concentration may commonly be applied as given below 2 c 0 t c 0 t f o r t 0 at the downstream boundary a condition similar to that of the upstream in the form of a time varying concentration may be specified alternately as suggested in literature for example benedini and tsakiris 2013 a zero value of the spatial gradient of the concentration may be specified at this end as given below 3 c x 0 f o r t 0 a t x l the initial condition assuming a zero concentration of the solute along the length of the channel may be specified as 4 c x 0 0 f o r 0 x l given the above description of solute concentration in space and time for the complete one dimensional domain we proceed to discretizing channel length into cells such that the governing equation may be expressed in terms of unknown concentration values at the cell interfaces referred to here as the internal nodes the solution methodology comprises of assembling the cell equations expressed as discrete linear functions of the unknown nodal concentrations at a given time and applying the boundary conditions to obtain a system of equations which on solving yields the unknown concentrations at a future time this procedure is repeated over discrete time steps till a specified final time is reached fig 1 a shows a general layout of the hypothetical stretch of a typical one dimensional channel that is subdivided into m cells of which n are loaded with single point sources where n m the coordinate axis x is reckoned from the upstream end of the channel pointing downstream a representative cell cell i having boundary coordinates x i 1 and x i and bound by nodes i 1 and i respectively may be assumed to contain a solute loading point say load point j located at coordinate xw j as shown in fig 1 a such a typical loaded cell is shown magnified in fig 1 b some cells however may not contain a load as in fig 1 c or as indicated for some cells in fig 1 a note that there are m 1 cell interfaces or internal nodes separating the m cells at the location of the upstream and the downstream boundaries there are two more nodes where the respective boundary conditions eqs 2 or 3 are specified for the entire simulation time the solute concentrations at all the m 1 nodes of the domain are specified at an initial time say t 0 as given in eq 4 and are computed at subsequent times by solving the governing equation eq 1 subject to the boundary conditions the nodal concentrations thus vary in time and may be written for the node i as c i c i t for implementing the proposed computation technique the channel is segmented into several cells for the purpose of computing the nodal concentrations at the cell interfaces in accordance with the following set of rules 1 the size of a cell be limited to ensure a near uniform velocity within its stretch the steady state velocity being determined as indicated in section 1 and 2 one cell may contain at most one point load thus the size of a cell may span the entire length of the channel provided the flow velocity throughout may be considered uniform and there is at most a single loading point within the channel for such a single cell there would not be any internal node but the boundary nodes at the channel s upstream and downstream ends provide the requisite information for solving the equations on the other hand for a channel divided into several cells the solute concentrations at the internal nodes located at the inter cell boundaries are initially unknown but the two extreme nodes coinciding with the boundary nodes of the domain with specified information help in finding the unknown concentration values at the internal nodes as explained below since the velocity within a cell is assumed to be constant throughout its length it may be denoted as v i for cell i consequently the values of the dispersion coefficient and decay coefficient may also be assumed constant for the cell benedini and tsakiris 2013 and the parameters denoted as e i and k i respectively for the cell if cell i contains the point load w j as shown in fig 1 b then eq 1 may be expressed for the cell i as given below 5 c t v i c x e i 2 c x 2 k i c w j f o r x i 1 x x i note that in eq 5 the space averaged velocity v i in the cell is placed outside of the corresponding first order spatial derivative term the solute concentration of the cell i c is assumed as a variable in space and time while the loading w j is a known quantity defined as a constant or as a function of time that is w j w j t w j is set to zero in eq 5 if cell i has no imposed load as in fig 1 c 3 concentration profile within a cell an assumption is made here that the distribution of concentration within a cell under unsteady conditions is similar to that in the steady state accordingly eq 5 may be written for steady state case as below for a general cell i containing the j th lateral load w j located at coordinate xw j fig 1 b by omitting the time derivative 6 0 v i c x x e i x c x x k i c x w j an analytical expression is now derived for the variation of concentration within the cell between x i 1 and xw j and between xw j and x i eq 6 is observed to be a linear differential equation of order two the general solution of which may be expressed as given below 7 c x c a 1 e γ i x α i x c b 1 e γ i x α i x f o r x i 1 x xw j 8 c x c a 2 e γ i x α i x c b 2 e γ i x α i x f o r xw j x x i in eqs 7 and 8 the parameters γ i and α i for the cell i are solely dependent upon the assumed cell constant values of velocity v i dispersion coefficient e i and decay coefficient k i and are expressed as γ i v i 2 e i and α i γ i m i where m i 1 4 e i k i v i 2 at x x w j where the j th load w j is located the continuity of the concentration needs to be preserved which may be expressed as 9 c x xw j c x xw j c x x w j further the change in mass transport rate at x x w j must be equal to w j resulting in the following mathematical statement implying conservation of the solute specie 10 e i c x v i c x xw j e i c x v i c x xw j w j the four constants appearing in eqs 7 and 8 namely c a 1 c b 1 c a 2 c b 2 may be determined in terms of the local boundary conditions that is the concentrations c i 1 and c i at the two boundaries x i 1 and x i of the i th cell together with eqs 9 and 10 the concentration variation within cell i in space c finally be expressed after some algebraic manipulation in two parts as given below maulik 2006 for x i 1 x xw j 11 c x 2 w j e γ i x xw j q i m i sinh α i x i xw j s i n h α i x x i 1 s i n h α i x i x i 1 c i 1 e γ i x x i 1 s i n h α i x i x sinh α i x i x i 1 c i e γ i x x i s i n h α i x x i 1 sinh α i x i x i 1 for xw j x x i 12 c x 2 w j e γ i x xw j q i m i sinh α i xw j x i 1 s i n h α i x i x sinh α i x i x i 1 c i 1 e γ i x x i 1 s i n h α i x i x sinh α i x i x i 1 c i e γ i x x i s i n h α i x x i 1 sinh α i x i x i 1 for a cell without any point load located within its domain fig 1 c the load term w j in eqs 11 and 12 are equated to zero thus leaving only the last two terms in each equation note that the concentrations c i 1 at x i 1 and c i at x i for the i th cell are as yet unknown and computed as a part of the solution as explained in the next section eqs 11 and 12 represent the closed form solution of concentration within the cell as a function of the length variable x and the contained point load w j in terms of the node concentrations c i 1 and c i as per assumption made these equations are also hold good for the unsteady case represented by eq 5 for the cell i since eqs 11 and 12 express the solute concentration within the i th cell containing the j th load w j as c c x w j eq 5 may be rewritten as below 13 c t v i c x e i x c x k i f o r x i 1 x x i in the following section the principle of solute mass conservation is applied by integrating eq 13 over the cell length and obtaining a balance based on temporal gradients of space averaged concentration values and time averaged flux values at the cell interfaces this is similar in philosophy to that followed by the finite volume method fvm however a within cell variation that is based on the nature of the actual physical problem being simulated is assumed in proposed method which is probably being better than any polynomial variation assumption this is the benefit of the proposed method as compared to other numerical schemes eqs 11 and 12 help in computing the spatial concentration derivatives at the cell interfaces and in turn estimating the inter cell dispersive flux for this purpose a simple average of the gradients of concentration for the two neighboring cells across an interface is used for estimating the inter cell flux which however introduces an approximation error 4 flux balance and computation of nodal concentrations as indicated above eq 13 is integrated over a cell i located between the spatial coordinates x i 1 and x i resulting in an equation of the following form 14 x i 1 x i c t d x v i x i 1 x i c x d x e i x i 1 x i x c x d x k i x i 1 x i c d x in order to use eq 14 for solving the unknown concentrations at the computational nodes of the channel over time the time derivative is approximated by a backward in time implicit finite difference scheme assuming a time step of δ t also the fundamental theorem of calculus that is a b d f f b f a is applied to the advective and dispersive flux terms in eq 14 which is then transformed into the following form 15 x i 1 x i c x i t δ t c x i t δ t d x v c x x i v c x x i 1 t δ t e c x x x i e c x x x i 1 t δ t k i x i 1 x i c x t δ t d x note that in eq 15 the flux and the decay terms are assumed to be at the advanced time level that is at t δ t weighted average values between t and t δ t may also be used instead in eq 15 the last term is integrated over the length of the cell using the analytical expressions for the distribution of concentration within a cell given by eqs 11 and 12 the first two terms on the right hand side of eq 15 are evaluated at the inter cell boundaries by averaging the advective and dispersive fluxes between the two neighboring cells as given below 16 v c x x i t δ t 0 5 v i c x x i i v i 1 c x x i i 1 t δ t 17 v c x x i 1 t δ t 0 5 v i 1 c x x i 1 i 1 v i c x x i 1 i t δ t 18 e c x x x i t δ t 0 5 e i c x x x i i e i 1 c x x x i i 1 t δ t 19 e c x x x i 1 t δ t 0 5 e i 1 c x x x i 1 i 1 e i c x x x i 1 i t δ t in eqs 16 to 19 the superscripts over the concentrations and their gradients denote the cell number and subscripts denote the cell boundaries substituting these expressions appropriately in eq 15 for each cell and subsequently the eq 15 is further simplified by using the analytical expressions for the distribution of concentration within each cell given by eqs 11 and 12 a system of linear equations obtained which may be expressed in the following form 20 δ t a d c t δ t d c t δ t f w 0 where a 1 0 0 0 0 0 q 1 r 1 s 1 0 0 0 p 2 q 2 r 2 s 2 0 0 0 p i q i r i s i 0 0 0 0 0 p m 1 q m 1 r m 1 s m 1 0 0 0 0 p m q m r m c c 0 c 1 c 2 c i c m 1 c m f 1 0 0 0 0 0 0 g 1 h 1 0 0 0 0 f 2 g 2 h 2 0 0 0 0 f i g i h i 0 0 0 0 0 f m 1 g m 1 h m 1 0 0 0 0 0 f m g m w c 0 w 1 w 2 w i w m 1 w m d 0 0 0 0 0 0 a 4 1 a 5 1 0 0 0 0 0 a 4 2 a 5 2 0 0 0 0 0 a 4 i a 5 i 0 0 0 0 0 0 a 4 m 1 a 5 m 1 0 0 0 0 0 0 a 4 m a 5 m the terms in all above matrixes are elaborated in appendix a in eq 20 a f and d are square matrices of size m 1 where m is the number of cells c and w are both column matrices of size m 1 representing the nodal concentration values and loading rates it may be recalled that there may be n load points where n m implying that all cells may not have load injection and for such cells the corresponding entries in w would be zero it is also assumed that the concentration or its gradient is known at the boundary nodes defining the channel these boundary conditions have to be appropriately applied for obtaining the unknown nodal concentrations within the channel as functions of time at any given time step the concentration profile within the cell may be obtained with the help of eqs 11 and 12 and using the computed nodal concentrations the final system of equations eq 20 has to be solved implicitly since the unknowns are the nodal concentration values at any time step the solution methodology may easily be changed to explicit or any other time weighting scheme 5 stability and error analysis 5 1 stability analysis a particular method is stable if the cumulative effect of the entire round off error produced in the application of the algorithm is negligible the round off error at location j and time level t is expressed as ξ j t c j t exactsolution c j t approximatesolution it can be shown that for linear algebraic equations produced by discretization the corresponding error terms satisfy the same homogeneous algebraic equations fletcher 2012 hence the error equations corresponding to eq 20 for cell j and time t δ t produces 21 δ t p j ξ j 2 t δ t δ t q j a 4 j ξ j 1 t δ t δ t r j a 5 j ξ j t δ t δ t s j ξ j 1 t δ t a 4 j ξ j 1 t a 5 j ξ j t 0 the von neumann method was used for the stability analysis in this study since although the matrix method can include the boundary conditions on the overall stability of the scheme previous research in comparing these two methods of stability analysis has indicated that the classical von neumann method is generally to be preferred regardless of the type of the boundary conditions hindmarsh et al 1984 fletcher 2012 in the von neumann method the errors distributed along cell boundaries at one time level are expanded as a finite fourier series then the stability or instability of the computational algorithm is determined by considering whether separate fourier components of the error distribution decay or amplify in progressing to the next time level the error associated with c x t at location j and time level t can be expressed as 22 ξ j t g t e i θ j where the time dependence of this fourier component of the error is contained in the complex coefficient g t and the superscript t implies g is raised to the power t i 1 and θ k δ x and k is the wave number θ varies from 0 θ π nazir et al 2016 the numerical stability of a scheme requires that the amplification factor over one complete time step must satisfy the following condition for all possible values of θ 23 g ξ j t δ t ξ j t 1 substitution of error eq 22 into the eq 21 produces the equation 24 δ t p j g t δ t e i θ j 2 δ t q j a 4 j g t δ t e i θ j 1 δ t r j a 5 j g t δ t e i θ j δ t s j g t δ t e i θ j 1 a 4 j g t e i θ j 1 a 5 j g t e i θ j 0 dividing eq 24 by g t e i θ j and further simplification gives 25 g a 4 j e i θ a 5 j δ t p j e 2 i θ δ t q j a 4 j e i θ δ t r j a 5 j δ t s j e i θ eq 25 is reformed by using euler relation e i θ c o s θ i s i n θ 26 g a 4 j c o s θ a 5 j i a 4 j s i n θ δ t p j c o s 2 θ δ t q j c o s θ a 4 j c o s θ δ t r j a 5 j δ t s j c o s θ i δ t p j s i n 2 θ δ t q j s i n θ a 4 j s i n θ δ t s j s i n θ for eq 26 we obtain 27 g x 1 i y 1 x 2 i y 2 arithmetic operations on complex numbers allow us to write eq 27 as 28 g x 1 x 2 y 1 y 2 x 2 2 y 2 2 i y 1 x 2 x 1 y 2 x 2 2 y 2 2 where 29 x 1 a 4 j c o s θ a 5 j y 1 a 4 j s i n θ and 30 x 2 δ t p j c o s 2 θ δ t q j c o s θ a 4 j c o s θ δ t r j a 5 j δ t s j c o s θ y 2 δ t p j s i n 2 θ δ t q j s i n θ a 4 j s i n θ δ t s j s i n θ the amplification factor of g is a complex number and therefore the stability condition g 1 yields the following relation 31 g x 1 x 2 y 1 y 2 x 2 2 y 2 2 2 y 1 x 2 x 1 y 2 x 2 2 y 2 2 2 1 since 0 θ π then inequality 31 which obtains after substituting the values of x 1 x 2 y 1 y 2 from eq 29 and eq 30 can be verify for its extreme values only nazir et al 2016 hence for θ π we obtain 32 g x 1 x 2 1 a 4 j a 5 j a 4 j a 5 j δ t p j q j r j s j 1 the terms in eqs 23 32 are shown in appendix a from parametric analysis it is known that inequalities given in eq 32 are satisfied for any value of v e k and δ t but these inequalities are dependent on r which is the ratio between one cell length to the next cell length it is expressed for cell i from fig 1 as 33 r i x i x i 1 x i 1 x i w h e r e i 1 2 m hence plotting the modulus of amplification factor g versus r shown in fig 2 concluded graphically that the proposed method for unsteady advection and dispersion equation under multiple loading is stable for r 1 and the stability of the scheme at all time step values is consistent with the backward in time treatment of the temporal concentration gradient 5 2 error analysis in determining the accuracy of the proposed discretization method highlighted herein the truncation error te has to be identified the truncation error is the error caused by approximating a mathematical process it is the difference between the original equations to truncated equation or discretized equation original partial differential equation at cell j at time t δ t is c x t t j t δ t v c x x j t δ t e x c x x j t δ t k c x j t δ t 0 when substituting the eqs 16 19 appropriately in eq 15 for cell j at time t δ t the resulted discretized equation is x j 1 x j c x j t δ t c x j t δ t d x 0 5 v j c x x j j v j 1 c x x j j 1 t δ t 0 5 v j 1 c x x j 1 j 1 v j c x x j 1 j t δ t 0 5 e j c x x x j j e j 1 c x x x j j 1 t δ t 0 5 e j 1 c x x x j 1 j 1 e i c x x x j 1 j t δ t k j x j 1 x j c x d x t δ t 0 applying x for eq 35 and simplified as follows c x j t δ t c x j t δ t 0 5 v c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x x j t δ t 0 5 e x c x j x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j t δ t k c x j 1 t δ t 0 from taylor series expansion f t δ t f t δ t df dt o δ t 2 hence eq 36 can be written as 37 c x j t δ t c x t t j c x j t δ t o δ t 2 j 0 5 v c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x x j t δ t 0 5 e x c x j x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j t δ t k c x j 1 t δ t 0 therefore the te e q 37 e q 34 te 38 0 5 v c x x j t δ t 0 5 e x c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 e x c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j 1 t δ t o δ t 2 j te space 0 5 v c x x j t δ t 0 5 e x c x x j t δ t 0 5 v c x j x j 1 t δ t 0 5 e x c x j x j 1 t δ t 0 5 v c x j 1 x j 1 t δ t 0 5 e x c x j 1 x j 1 t δ t k c x j 1 t δ t te time o δ t 2 j further simplification of eq 38 by substituting eqs 11 and 12 showed that the leading temporal term is second order in time implying that the numerical scheme is first order accurate in time and the spatial te that is te space is tending to zero when the differences of γ α from one cell to another cell are tending to 0 at r j 1 j 1 2 m in the case of variations of v e and k spatial truncation error varies with the influence function of 1 k α γ m 6 steady state water quality solution although the proposed method helps in obtaining the changes in concentration in a channel at very fine granularity of time and space a large number of environmental management decisions are based upon time averaged flows and pollution loads in such cases the best option would be to use the solutions of steady state conditions which may easily be achieved by ignoring the time derivative in eq 13 following other approximations as indicated in eqs 16 through 19 and incorporating the prescribed conditions at the boundaries of the channel for steady state conditions an equation of the following form results 39 a c f w 0 eq 39 whose matrices are similar to those of eq 20 represents a system of linear equations in terms of the nodal concentrations and may be evaluated using suitable matrix methods a steady state solution such as that discussed here is also useful in checking the accuracy of the proposed method for multiple point loads since an analytical solution is not available for the time varying version of this case additionally solutions by other numerical methods may be subject to their specific limitations in the following sections the proposed method is tested against steady and unsteady cases with hypothetical data followed by field application 7 model performance 7 1 steady state water quality dynamics sensitivity analysis the main aim of the case study is to study the behavior of relative error obtained between the proposed and exact solutions at various ranges of v e k r and cell lengths at a particular location of the channel consider the particular case of eq 1 with lateral loads for the following boundary conditions c x 0 a t x c x 0 a t x in this case a uniform channel v e both constant is subject to a steady inflow discharge q and two steady lateral point source loads w1 w2 of a contaminant which decays at a constant rate k it is presumed that the loads from the point sources are small compared to the inflow discharge exact solution of the particular case is given in thomann and mueller 1987 by taking the exact solution as a reference sensitivity analysis of the proposed method is evaluated the length of the channel l is considered as 50 km with w 1 500 mg s at xw 1 10 km and w 2 500 mg s at xw 2 35 km and at a steady inflow discharge q 360 m3 hr c x 0 is applied at the upstream x 0 and c x 0 is applied at the downstream x l of the channel since the exact solution is available at a channel length that is theoretically infinite it may not possible to compare both model results near the boundaries hence the relative error re between the value predicted by the proposed method and the true value given by the exact solution is calculated at a location x 15 km which is not too near to boundaries for several values of v ranging from low 0 36 km hr to high 3 6 km hr and several values of e and k simulations are carried out for a wide range of r including r 1 i e uniform cell and with varying cell lengths for each simulation following relation is used for re calculations re predictedvalue t r u e v a l u e truevalue the results of all simulations are presented graphically in figs 3 and 4 in fig 3 horizontal axis is representing the cell length that is numerator in the expression for r refer eq 33 for example if the cell which lies x 15 km is having cell lengths for r 4 are 2 km 5 km 10 km and 15 km then the next cell lengths the denominator in the expression for r should be 0 5 km 1 25 km 2 5 km and 3 75 km respectively during segmentation it is confirmed from fig 3 that at a particular location re remains unchanged for a particular combination of v k and e for every cell length at all values of r 1 fig 4 shown that re decreases with increasing values of v moreover re increases with increasing values of e fig 4 a and decreases with increasing values of k fig 4 b it is confirmed from fig 4 that re is influenced by the function 1 k α γ m refer section 5 at variations of v k and e it may thus be inferred that the proposed method is applicable to all ranges of advective velocities while being independent of the cell size 7 2 steady state water quality dynamics field application maulik 2006 conducted field experiments as a part of research for obtaining the observed bod5 5 day biochemical oxygen demand concentration values at six strategic locations within the study area as shown in fig 5 the 45 km stretch of the hooghly river investigated is close to the city of kolkata erstwhile calcutta in eastern india and spans between the towns of palta and uluberia both a part of the larger administrative district known as the kolkata metropolitan area the stretch of the river under consideration being located in the upper estuary of the river is influenced by diurnal tidal circulations and the study stretch has been shown to be well mixed by maulik 2006 on the basis of method available in thatcher and harleman 1972 hence one dimensional model is applicable for the study stretch to obtain the representative concentrations of steady state slack tide sampling procedure as described in chapra 1997 and thomann and mueller 1987 is followed during each sample collection the observed bod5 values acquired by a team through concurrent measurements on april 6 2004 and may 24 2004 along the study stretch are used for analyzing the performance of the proposed method the common input data for both days are presented in appendix b steady inflow discharges to the study stretch on both days are 2 10 106m3 hr and 2 02 106m3 hr respectively to run the proposed method for this field case the observed bod5 concentration value at palta on the upstream and uluberia on the downstream are used as boundary conditions performance of a water quality model depends on the degree of accuracy of numerical estimation and physical measurement of the model parameters most of the model parameters can be measured physically but physical measurements involve considerable costs and manpower some of the parameters are therefore estimated through model calibration in this study the tidal dispersion coefficient e is estimated by the method proposed by thomann and mueller 1987 and the value of e i for the cell i is obtained as below e i v i x 2 x 1 l n sl 2 sl 1 in the above expression v i advective velocity for the cell i and sl 1 sl 2 salinities of the water represented by the chloride concentrations at two arbitrary point s x 1 and x 2 respectively if chloride concentration is plotted against river stretch measured from upstream on a semi logarithmic scale then considering two arbitrary points in the graph the slope l n sl 2 sl 1 x 2 x 1 may be calculated the slope which also equals v i e i permits estimation of the tidal dispersion coefficient e i provided that the velocity v i is known the velocity v i of cell i obtained from the net flow and cell s mean area of cross section a i maulik 2006 collected the chloride concentration data under similar hydraulic conditions as the bod5 data and provided the following expression for the dispersion coefficient for the study stretch e i k m 2 h r 728 08 v i k m h r genetic algorithm ga mohan and loucks 1995 meier and barkdoll 2000 is used as a calibration technique for estimation of k value the study area is a well mixed tidal stretch and k value is not expected to change drastically within the stretch martin and mccutcheon 1999 mentioned that in steady state models the forcing functions are time averaged the temporal scale used in such cases may be for a week or even longer since the flow patterns and wastewater discharge characteristics do not change drastically within a month for the study area the input averaged over all tidal cycles in each month is used for estimation of the monthly k values the monthly averages of water quality parameters bod 5 objerved are calculated using the water quality monitoring records of 1996 2000 this five year data is available with the west bengal pollution control board to predict the bod 5 values from the proposed method the study stretch is divided into 260 cells based on the model criteria that is each cell should contain single or no lateral point sources refer fig 1 and r 1 therefore cell lengths are varied from 40 m to 1 10 km for given input data refer appendix b the ga has run 500 times with following objective function to ensure the best combinations of the control parameters for satisfactory convergence in optimal solution the combination used for ga is population 80 generation 120 cross over probability 0 8 and mutation probability 0 062 for a search space of k ranging from 0 3 to 0 5 ng 2001 objective function min i bod 5 objerved i bod 5 predicted i 2 where bod 5 objerved i bod5 concentration value as actual measurement at i th location bod 5 predicted i bod5 concentration value obtained by the proposed method using different sets of parameters as selected by the ga operators at i th location the calibrated values of k for april and may months are 0 38 hr and 0 46 hr respectively the obtained profile of velocity and estimated dispersion coefficient along the study stretch are shown in fig 6 a and b respectively fig 6 c and d respectively showed a comparison of results of the spatial variation of bod5 concentration values along the study stretch for the two days on which the observations are made that is april 6 2004 and may 24 2004 for this field application the performance of the proposed method is carried out using correlation coefficient r and chi squared goodness of fit test at 95 percent confidence level results from the performance analyses are presented in table 1 correlation coefficient r this coefficient is used to quantitatively express the relationship between two variables and is defined as r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 where o is the average observed value and p is the average predicted value the range of r varies from 0 randomly related to 1 perfectly related ji 2008 the values of r in the table 1 indicate a fairly good correlation between the predicted results and the observed data acquired on april 6 2004 and may 24 2004 for the study stretch of hooghly river the chi squared values also indicate that the predicted and observed results are not significantly different from each other at a 95 percent confidence level on both observed days the proposed method is further run to study the behavior of relative error obtained between predicted and observed values for a wide range of r including r 1 i e uniform cell and with varying cell lengths re is calculated at location b garden shown in fig 5 for both april 6 2004 and may 24 2004 events at a particular combination of v 0 12 km hr k 0 38 hr e 24 0 km2 hr and v 0 1 km hr k 0 46 hr e 22 0 km2 hr respectively a summary of the results is shown graphically in fig 7 as similar to fig 3 fig 7 further strengthen the statement with field application that at a particular location re remains unchanged for a particular combination of v k and e for every cell length at all values of r 1 from the results it may be inferred that the proposed method has a reasonably acceptable accuracy for field application such as hooghly river 7 3 unsteady state water quality dynamics computational efficiency consider the one dimensional advection dispersion eq 1 without lateral loads w 0 for the following initial and boundary conditions c x 0 0 f o r x 0 c 0 t c 0 f o r t 0 c t 0 f o r t 0 in this case a uniform channel v e both constant in space and time is subjected to a steady inflow discharge q and a continuous upstream loading c 0 of a contaminant which decays at a constant rate k the exact solution of the particular case is given in runkel 1996 by taking the exact solution of this case as a reference the performance and computational efficiency of the proposed method is compared with the implicit finite difference crank nicholson or cn scheme chapra 1997 and the public domain computational package hec ras which uses the quickest ultimate explicit numerical scheme for solving the water quality equations brunner 2010 advection problems sometimes present challenges resulting in non physical oscillations in order to avoid such spatial oscillations it is generally recommended that the peclet number pe which is the ratio of the rate of advection transport to the rate of diffusive dispersive transport v δ x e should be less than or equal to 2 for the cn scheme chapra 1997 benedini and tsakiris 2013 and the universal limiter ultimate employed by hec ras leonard 1979 leonard 1991 here the performance of the proposed method is carried out against cn hec ras and exact solutions at both pe 2 and pe 2 for accuracy and computational efficiency comparisons this is done at a uniform velocity v 3 6 km hr dispersion coefficient 1 0 k m 2 h r and decay coefficient k 0 036 hr by considering four cases a uniform cell size 0 5 km δ t 0 5 hr at p e 2 b uniform cell size 0 5 km δ t 1 0 hr at p e 2 c uniform cell size 2 0 km δ t 0 5 hr at p e 2 d uniform cell size 2 0 km δ t 1 0 hr at p e 2 simulations are carried out for a time of 10 h with a continuous upstream loading c 0 10 mg l and steady inflow discharge q 360 m3 hr the length of the channel l 30 km with the spatial gradient of concentration at the downstream end of the channel x l applied as c x 0 for proposed cn and hec ras methods for hec ras it is necessary to run the steady flow analysis in order to run the water quality module steady flow analysis required steady flow data which consists of boundary conditions and discharge information brunner 2010 therefore a 1 m wide rectangular channel having water surface elevations of 0 1 m and 0 101 m at the upstream and downstream ends of the domain respectively is assumed and steady inflow discharge q 360 m3 hr is given as input to get the uniform velocity v 3 6 km hr the obtained concentration profiles of all three models along with exact solution are shown graphically in fig 8 from fig 8 it may be observed that the results from the cn method are agreeable when the pe 2 at a time step of 0 5 hr but the method starts producing oscillations if either the pe or the time step for computation is increased in the case of hec ras results oscillations are suppressed due to a universal limiter in all cases nevertheless a phase lag dispersion is generated which increases with time step fig 8 b d on other hand the numerical results of the proposed method show good agreement with those given by the exact solutions and are more accurate than those of the cn and hec ras methods at high peclet numbers fig 8 c d and large time steps fig 8 b d furthermore significant differences in computational times are observed among the proposed cn and hec ras methods based on cell size and time step used as may be seen from table 2 which compares the cpu time taken on an intel core i5 machine for one time step of the three methods with a time step of 0 5 hr it is evident from table 2 that the proposed method is at least 45 times faster than hec ras and 35 times faster than cn methods in practical terms this implies that the proposed method offers a more efficient solution with less computational time as it is possible to use larger cell sizes while maintaining the same accuracy in predicting the variables from fig 8 it is also observed that the proposed cn and hec ras methods exhibit minor deviations from the exact solution at downstream boundary and these deviations are seen to increase with time since the exact solution is available at a channel length that is theoretically infinite the study is further carried out to check the behaviour of the proposed cn and hec ras methods at downstream boundary as the channel length increases from 10 to 1000 km the cell size and time step are held constant at 0 5 km and 0 5 hr respectively and the results are compared at time t 4 hr the observed results shown in fig 9 indicate that deviations from the exact solution decrease in all three methods as the channel length is increased in proposed method however the deviations decrease rather rapidly compared to both cn and hec ras methods the results of the unsteady state simulations help in establishing the proposed method as a sufficiently accurate and computationally efficient unsteady water quality predicting method it may worth emphasizing that the accuracy of the method stems from the assumption of an analytical variation of the concentration within a cell eqs 11 and 12 in comparison to the polynomial variations employed by other popular numerical techniques 7 4 unsteady state water quality dynamics field application nordin and sabol 1974 conducted field experiments for determining the longitudinal dispersion coefficient e for various creeks rivers and canals and these observations being published in the u s geological survey reports here the observed data at two sampling points of antietam creek usa obtained on may 27 1969 are considered from the reference for analyzing the performance of the proposed method against hec ras under steady flow conditions the data includes 1 a mass of a conservative solute injected instantaneously at a specific location in the creek 2 time concentration data at two predetermined sampling sites downstream of the injection site 3 distance of the sampling sites from the point of injection 4 flow velocities and discharges in the river at the sampling sites and 5 mixing length of the river the amount of pure tracer m released instantaneously at t 0 and x 0 is 463 6 g 1 022 lb and mixing length of the creek is 0 7 km hence for simulations of the proposed method a one dimensional system in the x direction is considered with the initial conditions c 0 0 m δ x where δ is the dirac delta function and a zero value of the spatial gradient of the concentration is specified at the downstream boundary the concentration of tracer was observed at sampling point 1 for 8 h with a time interval δ t 0 2 h r and then observation of the concentration of tracer at sampling point 2 was commenced for the next 14 h with δ t 0 5 h r as reported the distances of the first and second sampling sites from the point of injection x 0 were 2 574 and 9 574 km respectively there was no appreciable difference in the discharges at these two sites but the flow velocities at sampling sites 1 and 2 were 1 108 and 0 746 km hr respectively and steady inflow discharge was about 4200 m3 hr the simulation domain considered extends from x 0 km to x 9 574 km it is assumed that velocity of the creek from point of injection up to the first sampling site is constant that is 1 108 km hr thus the stretch between points of injection to the first sampling location is assumed as a single cell that is having 2 574 km length and next cell lengths should not be greater than 2 574 km imposed by the stability condition r 1 of the proposed method therefore the stretch between the first and the second sampling points is divided into three cells measure 2 574 km 2 574 km and 1 852 km consecutively assuming a linear variation in velocity between sampling sites 1 and 2 velocity values are interpolated at each intermediate cell node based on available velocity values at these two sites further mean velocity v values are computed for each cell by averaging the velocity values at each cell boundary steady state dispersion coefficient e values for each cell i lies between sampling site 1 and 2 are estimated by a well known method of moments valentine and wood 1979 with the following expression e i v i 2 2 σ 2 2 σ 1 2 t 2 t 1 i 2 t o 4 where σ 1 2 and σ 2 2 are variances of concentration time profiles at sampling sites 1 and 2 respectively while t 1 and t 2 are means of the two concentration time profiles for the cell from point of injection up to the first sampling site σ 2 2 and t 2 are considered at sampling site 1 whereas σ 1 2 0 and t 1 0 are considered at injection point chapra 1997 the summary of computed mean velocity and dispersion coefficient values for each cell of the proposed method is presented in table 3 in hec ras the total simulation domain is divided into 4 cells having the same cell lengths of that proposed method for steady flow analysis in order to get the flow velocities given at site 1 and 2 water surface elevations of 0 5 m and 0 61 m are considered at upstream and downstream ends of the domain respectively and the steady inflow discharge being about 4200 m3 hr is given as input to hec ras for water quality analysis the area under the graph of the observed concentration versus time curve was computed as 110 945 μ g l division of the ordinates of the observed concentration by the mass of the impulse input gives the concentration graph for a unit impulse input and the concentration values c 0 0 110 945 μ g l c 0 t 0 f o r t 0 c x 0 0 f o r x 0 are given as upstream boundary conditions in hec ras a computational time step δ t 0 2 hr is considered for both hec ras and proposed methods and similar dispersion coefficient values presented in table 3 are given as input to hec ras for each cell the predicted time concentration profiles obtained by both the proposed method and the hec ras model are presented in fig 10 the corresponding performance evaluation metrics are presented in table 4 in this study the coefficient of determination for concentration r 2 root mean square error for concentration rmse peak concentration c per expressed as c per simulated peak concentration observed peak concentration 1 100 and error in time to peak concentration t pcer expressed as t pcer time to simulated peak concentration time to observed peak concentration are used to evaluate the solute transport capability of the proposed method and hec ras models from fig 10 it is apparent that the simulated profile predicted by hec ras differs substantially from that observed data at sampling point 2 located at x 9 574 km discontinuity raised due to instantaneous point source at upstream of the domain is the main concern in hec ras on the other hand the proposed method is found to simulate and successfully predict the concentration response in the antietam creek 8 advantages of the proposed method although the modeler may be discouraged from applying the proposed method because of its lengthy and complex expressions the method has certain advantages which as summarized below may prove advantageous overall in the conventional numerical methods the variation of concentration from one cell node to another relies on the discrete derivative approximation in proposed method however a continuous profile of concentration within a cell is inherently assumed as an analytical expression based upon the governing equation of the problem the contributions within the cell due to the concentration at its boundaries as well as the lateral loadings are separately identifiable explicitly in an analytical form this is helpful to policymakers in prioritizing remedial actions in actual cases by controlling the significant sources affecting a cell the proposed method is independent of cell sizes in case of uniform cell size throughout the channel length this is often useful for river stretches where the outfalls are located in close proximity interspersed with wide gaps in an unplanned manner in case of variable cell sizes as per the stability criteria of the proposed method cell lengths must reduce in the downstream direction however this condition may not affect the computational efficiency of the proposed method in all case studies on the other hand for hec ras and cn methods anyway their cell size should be small and equal throughout the domain for accurate results in the formulation of the proposed method a lateral loading source may be placed anywhere within the cell and not necessarily at the cell s centre without affecting the accuracy of the model the proposed method by virtue of its formulation may be applied for any number of cells although limited to steady flows it is applicable for variable parameters such as the dispersion coefficient velocity and decay coefficient which could be functions of space however the parameters need to be approximately uniform within each cell for a given time step 9 limitations and future scope of the proposed method based on the observations of the present investigations the following limitations are made for further development and validation of the proposed method the proposed method is limited to steady flow conditions therefore the possibility of proposed method for unsteady flow conditions may also be developed the ability to use a variable cell length would appear to be an advantage however in some cases the stability condition reduces the efficacy of this claim by introducing unnecessary refined cells application of the proposed method is may be extended to rivers with a number of tributaries or branch outs with considerable flow the formulation may be suitably modified for two dimensional cases with vertical salinity gradient 10 conclusions in the present study a numerical solution approach for the one dimensional unsteady advection dispersion equation under multi point loading is investigated to assess the transport of both non conservative and conservative solutes in open channel flows for assessing the proposed method a range of preliminary test cases are performed the results being compared with analytical results and numerical solutions obtained using the cn method and the commercial software package hec ras the comparisons indicate that proposed method is independent of cell sizes and superior to the cn scheme and the computations carried out by hec ras the efficiency of the proposed method is judged further by validating with the field data obtained by maulik 2006 in the tide dominated hooghly river under steady advection dispersion conditions the observed data of nordin and sabol 1974 for the antietam creek at steady flows are used to prove the model s worthiness under unsteady advection dispersion conditions the study therefore attempts to establish that the proposed numerical approach can be used with confidence in simulating the concentration response in natural rivers estuaries and creeks it may be applied on any number of cells and the cells sizes can vary widely without affecting the precision of the output the stability condition however requires that if the cell size varies it must decrease in the downstream direction 11 declaration funding na conflict of interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper ethics approval na consent to participate all patients included in this study gave consent to participate in this research consent for publication all patients included in this research gave consent to publish the data and images contained within this case report availability of data and material all data produced from this study are provided in this manuscript in the form of graphical representation code availability all codes are available in matlab r2009 version declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the several important and in depth suggestions made by the anonymous reviewers are gratefully acknowledged which have helped in improving the original presentation substantially appendix appendix a a1 q 1 v 1 a 1 1 2 a 2 1 k 1 a 4 1 a2 r 1 0 5 v 1 v 2 a 3 1 a 2 2 2 a 6 1 k 1 a 5 1 a3 s 1 a 6 2 a4 p i a 1 i 1 i 2 3 m 1 a5 q i 0 5 v i v i 1 a 1 i a 2 i a 3 i 1 k i a 4 i i 2 3 m 1 a6 r i 0 5 v i v i 1 a 3 i a 2 i 1 a 6 i k i a 5 i i 2 3 m 1 a7 s i a 6 i 1 i 2 3 m 1 a8 p m a 1 m 1 a9 q m 0 5 v m v m 1 a 2 m a 3 m 1 k m a 4 m a10 r m v m a 6 m k m a 5 m a11 g 1 b 1 1 b 2 1 e 1 2 k 1 γ 1 2 α 1 2 e 1 b 1 1 h 1 e 2 b 1 2 a12 f i e i 1 b 2 i 1 g i e i 2 k i γ i 2 α i 2 b 1 i b 2 i h i e i 1 b 1 i 1 i 2 3 m 1 a13 f m e m 1 b 2 m 1 g m b 1 m e m 2 k m γ m 2 α m 2 2 k m b 2 m γ m 2 α m 2 where a14 a 1 i e i α i e γ i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a15 a 2 i e i γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a16 a 3 i e i γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a17 a 4 i α i e γ i x i x i 1 γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 γ i 2 α i 2 s i n h α i x i x i 1 i 2 3 m 1 a18 a 5 i α i e γ i x i x i 1 γ i s i n h α i x i x i 1 α i c o s h α i x i x i 1 γ i 2 α i 2 s i n h α i x i x i 1 i 2 3 m 1 a19 a 6 i e i α i e γ i x i x i 1 2 s i n h α i x i x i 1 i 2 3 m 1 a20 b 1 i α i q i m i s i n h α i x i xw i s i n h α i x i x i 1 e γ i x i 1 xw i i 2 3 m 1 a21 b 2 i α i q i m i s i n h α i xw i x i 1 s i n h α i x i x i 1 e γ i x i xw i i 2 3 m 1 appendix b input data for steady state case under multipoint loading field application section 7 2 wj kg d xwj km xi km ai m2 xi km ai m2 4 02 1 55 0 75 9251 24 22 40 13013 72 60 00 1 95 1 18 11555 17 22 83 13460 00 75 60 3 69 1 57 9898 82 23 23 12331 40 2 70 4 15 1 96 10003 12 23 58 14707 60 48 60 4 99 2 20 9961 60 23 89 16250 90 125 40 5 92 2 44 9607 20 24 13 15601 55 213 20 6 71 2 71 8509 38 24 38 16319 67 0 16 7 34 2 91 8915 99 24 73 15225 76 0 06 7 73 3 18 12478 08 24 97 13154 75 15 25 8 32 3 42 16535 77 25 23 14429 50 3 00 8 94 3 70 16423 64 25 63 11566 81 0 02 10 18 4 17 16543 04 26 23 11958 00 0 01 10 42 4 52 15421 11 26 74 12168 17 63 65 10 93 4 76 13913 86 27 01 13077 13 0 15 11 09 5 00 13985 76 27 13 12353 06 0 18 11 63 5 27 14899 76 27 36 11630 77 0 32 11 87 5 53 16991 89 27 64 12918 00 165 60 12 43 5 73 17134 06 27 83 13063 07 153 00 12 98 5 93 16785 22 28 18 13403 41 84 60 13 37 6 12 16614 83 28 61 13316 60 4 72 13 63 6 32 16942 20 29 21 12673 50 0 77 13 94 6 73 14328 51 29 84 12617 00 17 99 14 17 7 15 15033 13 30 79 15508 32 16 83 14 48 7 34 14775 06 32 30 17000 91 3 27 15 24 7 54 13298 54 33 30 17779 50 26 08 15 63 7 74 13264 12 33 70 18401 85 154 85 15 83 7 93 12508 21 34 05 21821 50 47 25 16 12 8 13 12019 37 34 37 28379 50 0 62 16 31 8 33 11784 64 34 76 22657 50 102 90 16 63 8 45 11784 64 35 15 20356 55 9 63 16 79 8 54 12136 81 35 61 21583 19 126 90 17 01 8 73 12045 53 36 07 23940 50 729 75 17 25 9 03 12441 62 36 38 22991 94 1 28 18 06 9 39 14136 91 37 62 17008 00 1 62 18 21 9 61 14627 26 38 93 19353 24 0 08 18 49 9 83 14302 25 39 37 19741 04 5 13 18 80 10 20 15117 16 39 86 18131 00 3 95 19 01 10 43 15149 40 40 32 17720 00 637 13 19 23 10 67 14352 52 40 68 17001 10 1 14 19 30 10 94 12816 00 41 03 17616 71 0 36 19 61 11 09 13311 23 41 36 18083 00 249 65 19 77 11 24 13816 19 41 56 18083 00 16 80 20 03 11 39 14020 12 41 78 19038 00 3 78 20 37 11 51 14775 01 42 61 18156 50 123 20 20 62 11 63 14775 01 43 71 19832 49 6 24 20 79 11 88 14326 14 44 24 20088 09 759 00 21 28 12 06 14472 50 44 43 20297 50 2 18 21 95 12 25 14425 00 44 71 20782 93 780 85 22 38 12 44 14440 19 44 91 21520 17 3 40 22 82 12 57 14192 95 97 76 23 21 12 99 13272 28 0 20 23 57 13 39 12745 19 84 52 23 88 13 64 12014 19 177 03 24 12 13 95 12166 89 496 00 24 37 14 17 12075 16 2 52 24 72 14 33 12547 31 1 77 24 96 14 49 12987 28 17 70 25 22 14 70 13360 80 116 55 25 61 14 98 13426 89 69 66 26 20 15 25 13878 50 21 76 26 72 15 51 13883 05 0 09 27 00 15 63 14801 00 59 43 27 12 15 84 14948 50 21 23 27 35 16 14 14010 50 106 47 27 63 16 25 14159 92 0 01 27 82 16 32 15348 94 2109 00 28 17 16 47 16647 84 0 14 28 59 16 63 16590 50 2 08 29 19 16 80 16441 00 0 43 29 82 16 92 16731 50 0 12 30 75 16 94 16731 50 99 10 32 24 17 10 16907 50 292 00 33 26 17 25 17274 00 0 59 33 68 17 65 22128 50 45 36 34 04 18 08 16934 00 0 04 34 35 18 22 16608 76 14 66 34 74 18 33 16569 71 85 60 35 14 18 49 17441 86 0 63 35 59 18 65 17857 57 22 10 36 05 18 81 17380 38 108 50 36 36 18 96 15895 12 120 00 37 54 19 11 15556 48 18 36 38 88 19 24 16278 15 0 12 39 35 19 30 16278 15 3 24 39 84 19 46 15601 50 6 45 40 30 19 62 14580 00 22 44 40 66 19 78 14014 42 7 56 41 02 20 04 12668 00 0 78 41 35 20 38 12854 00 0 45 41 55 20 63 13186 12 38 50 42 57 20 79 13568 43 3 04 43 67 20 98 13239 14 20 88 44 22 21 29 14438 97 0 54 44 43 21 69 11684 00 5 25 44 70 21 97 14010 00 
2633,managed aquifer recharge mar has been applied for groundwater restoration as an effective strategy in many overdraft regions in jinan china mar through river infiltration was conducted regularly in recent years because of the most famous spring groups drying up due to continuous decline of groundwater level caused by extensive pumping a substantial rise of water table 20 m has been observed near the river however the potential change in groundwater quality and geochemistry during mar process remains unknown in this study a flow and multi component reactive transport model was developed to evaluate the impact of mar on chemical reaction processes and the response of groundwater quality to the interaction of river water and groundwater the geochemical conditions of the river water and groundwater are significantly different as river water contained more dissolved organic carbon doc and less nitrate than groundwater did in the study area with intensive agricultural activity this study revealed that nitrate dilution rather than denitrification was the main process responsible for observed groundwater quality change during mar preferential flow occurring in the aquifer resulted in strong spatial variability of nitrate concentrations in the groundwater river water doc aquifer hydraulic conductivity distribution and river aquifer hydrodynamic conditions can all affect the redox condition in the riparian zone by changing either reaction rate or residence time the results from this study indicate that groundwater geochemistry can be significantly altered during mar suggesting the importance of regular monitoring plan to assess the changes in groundwater quality especially in the area where river sediments are rich in organic carbon such monitoring and reactive transport modeling analysis is critical to ensuring that the adverse impact on groundwater quality by potential mar operations be kept to a minimum keywords managed aquifer recharge groundwater quality geochemical environment surface water groundwater interaction preferential flow data availability data will be made available on request 1 introduction managed aquifer recharge mar has been widely applied for drinking water supply agricultural irrigation or sustaining groundwater in europe and u s sprenger et al 2017 for other countries such as china it is an emerging technique that has been used to address the issue of increasing water stress liu and zheng 2016 zheng and guo 2022 for example the south north water transfer project in china aims to deliver 44 8 km3 year of water from yangtze river basin in southern china to yellow river basin in northern china to reduce water stress due to groundwater depletion wilson et al 2017 mar mostly utilizes surface water e g river lake as the source and can be grouped into four categories including enhanced infiltration induced bank infiltration well injection and enhanced storage enhanced infiltration is the simplest and most commonly used technique this technique enhances infiltration by increasing the spreading of surface water at the scale of area line or point water thus infiltrates into subsurface by gravitational force or percolation sprenger et al 2017 since large amount of surface water are introduced into subsurface during mar how to keep the subsurface environment clean and safe becomes increasingly important especially in the area that suffers from groundwater contamination the changes of the groundwater quality and geochemical evolution due to recharged water with different geochemical environment has been reported in many previous studies e g bourg and bertin 1993 stuyfzand 1998 grischek and paufler 2017 bachtouli and comte 2019 which is related to many factors such as the amount of injected fluid content of dissolved oxygen organic matter and mineral species in the infiltrated water in intensive irrigation region highly fluctuating behavior of ammonium near river has been observed groeschke et al 2016 besides climate conditions such as drought can also impact the biogeochemical environments in riparian zone under highly dynamic river flow condition as shown in song et al 2018 besides the hydraulic head change and chemical interactions during mar aquifer heterogeneity especially where preferential flow paths exist is also a major factor that impacts the chemical evolution and distributions in subsurface e g zheng and gorelick 2003 guo and brusseau 2017 guo et al 2019a impacts of soil heterogeneity on contaminant transport in vadose zone and subsurface have been widely studied e g brusseau and guo 2014 slimene et al 2015 guo et al 2017 akbariyeh et al 2018 liu et al 2020 however the thorough investigation of heterogeneity impacts on groundwater quality evolution during mar is still lacking integrated studies of surface and subsurface with highly heterogeneous mixtures on chemical transport and water quality evolution remain few especially involving detailed biogeochemical reactions regular sampling in regions with vulnerable groundwater is important for assessing groundwater quality however the deployment of a dense monitoring network is expensive and thus unrealizable in most cases regional scale transport modeling is a fast growing tool that has been used to assess groundwater quality under anthropogenic or natural condition e g steefel et al 2005 arora et al 2016 li at al 2017 guo et al 2019b guo et al 2020 bao et al 2017 developed a watershed reactive transport model to study the impact of integrated hydrologic process between surface water and groundwater on subsurface geochemical environment this model was further improved by adding biological process to simulate the export of dissolved organic carbon to stream zhi et al 2019 arora et al 2016 used reactive transport modeling toughreact to show that subsurface carbon flux is highly correlated with redox condition microbial activity water table fluctuation and temperature occurring in riparian zone for hyporheic zone the formation of nitrogen hot moments and hot spots are found to be related to the biogeochemical exchange between river and aquifer dwivedi et al 2018a dwivedi et al 2018b the purpose of this work is to assess the potential impact of mar on the biogeochemical environment in the riparian zone under intensive agricultural activities using a numerical model two major questions will be focused 1 how the nitrate distribution beneath agricultural land may evolve after initiation of mar and 2 how river doc may impact the biogeochemical environment during the rapid increase of groundwater level 2 methodology 2 1 study site the study site is located at yufu river in jinan china fig 1 a jinan has long been famous for the widely distributed karst springs fed by yufu river the earliest recorded spring baotu can be traced back to 3000 years ago however some of the springs have dried up in the last two decades due to excessive groundwater pumping aquifer recharge was thus employed to maintain the groundwater level and prevent the drying springs the first aquifer recharge experiment was conducted in 2001 by injecting 5 106 m3 water that released from wohushan reservoir within 12 days an obvious increase of groundwater level can be observed right after the recharge thereafter aquifer recharge has been adopted as a regular strategy to maintain the groundwater level this study focused on changes in groundwater during 10 1 2017 and 5 31 2018 which includes a recharge event initiated on 11 17 2017 fig 2 shows the daily groundwater level at cuima village near yufu river recorded since 10 1 2017 it can be observed that groundwater level increased 20 m in december due to bank infiltration after recharge began followed by 3 months stable before raised again on late march due to the increase of aquifer recharge regional geological information near yufu river was obtained from previous geological survey and boreholes drilled recently near the river the thickness of quaternary strata over this region ranges from 7 to 30 m and the major minerals are limestone dolomite and gypsum soil texture changes from gravel sand to clay in the vertical direction from ground surface water table fluctuates between 20 m and 70 m blow land surface bls and the thickness of unconfined aquifer is in the range of 10 30 m water quality has been monitored by collecting multiple groundwater and river water in the region li et al 2017 and the chemical species are detected in the river the concentration of the major cation ca2 is within the range of 1 29 10 3 3 76 10 3 mol l and the major anion so4 2 is 1 39 10 3 1 41 10 3 mol l in groundwater ca2 concentration is within 1 11 10 3 3 93 10 3 mol l and the major anions hco3 and so4 2 that coming from the dissolution of calcite and gypsum are 3 1 10 3 8 92 10 3 mol l and 6 54 10 4 1 57 10 3 mol l respectively the nitrate concentration is found to be up to 1 94 10 3 mol l in groundwater at some sampling sites far beyond the drinking water standard of nitrate no3 7 26 10 4 mol l established by u s environmental protection agency epa nitrate contamination is attributed to agricultural activities at land surface the impacts of mar on nitrate contamination will be evaluated further 2 2 numerical model 2 2 1 governing equation a 2 d transect model was built to assess the impact of mar on nitrate transport and other naturally existed geochemical species near river pflotran a massively parallel flow and reactive transport simulator was used to simulate the non isothermal variably saturated and reactive transport system hammond et al 2014 the mass balance equation for single phase variably saturated flow is described by three dimension richards equation 1 t φ s η η q q w with darcy flux q m s defined as 2 q k k r μ p ρ g z where ϕ indicates porosity s is saturation η is molar water density kmol m3 ρ is water density kg m3 k is intrinsic permeability m2 kr is relative permeability µ is viscosity pa s p is pressure pa g is gravity m s2 and qw is source sink term kmol m3 s the governing equation for multi component reactive transport in single phase flow is 3 t φ s ψ j ω j q j m ν jm i m s j t with the total flux ωj mol l s defined as 4 ω j q φ s d ψ j where j represents the jth primary species hereinafter ψj is the total concentration mol l qj is the source sink term mol l s νjm is the stoichiometry coefficient of jth primary species in mineral m im is the mineral precipitation dissolution rate based on transition state rate mol l s and sj is the sorbed concentration mol l 2 2 2 model setup the model domain was represented by a regular shape without considering the geometry of the riverbank due to the small portion of the riverbank over the domain fig 3 model dimension was 1000 m in strike direction and 46 2 m in vertical direction with the grid space of 8 m and 0 2 m respectively a fine resolution in vertical direction was aimed to better characterize the rapid change of water table at the boundary during mar two units upper unit 0 31 8 m below the land surface including relative coarse materials and lower unit 31 8 46 2 m below the land surface primarily composed by shale were identified from borehole data the upper unit penetrated to the depth of 31 8 m with permeability as 2 66x10 11 m2 estimated from pumping test the lower unit considered as an impermeable zone was modelled uniformly with a low permeability of 1 10 15 m2 since water table did not rise to shallow depth 3 m during mar the gravel sand layer that presented at shallow depth was not explicitly represented therefore in this study the hydraulic property at the shallow depth was not expected to influence the flow and transport that primarily occurred in saturated zone van genuchten mualem model was used to calculate saturation and relative hydraulic conductivity with parameters adapted from previous study li et al 2018 boundary conditions for flow were assigned by accommodating the physical condition on each side the top boundary was set to be flux type neumann using the measured daily precipitation it was worth noting that the surface infiltration rate may be different from precipitation value given the partition of surface runoff however this was not expected to impact the results much due to the small amount of precipitation during the simulation period compared with recharged water the bottom boundary was set to be zero flux no flow for the west a dirichlet type of boundary was applied using the measured time series of water table fig 2 the dynamics of water table is highly related to the amount of water recharged during mar the vertical pressure profile of the west boundary was assumed to satisfy hydrostatic equilibrium with the reference pressure equivalent to atmospheric pressure 101 325 pa at the water table the same assumption was made for the constant dirichlet boundary condition at the east side and the initial condition the water table at the east side was set to be 35 8 m the minimum water table recorded at the west side temperature was assumed to be constant at 20 c for the simulation the initial or boundary condition for reactive transport were adapted from the composition of groundwater and river water table 1 reduced dissolved organic carbon doc served as the electron donor for aerobic respiration and two step denitrification table 2 doc dissolved from solid organic matter was represented by ch3coo michaelis menten kinetics was used as the rate law for redox reactions 5 r μ max c ed c ed k ed c tea c tea k tea k 1 k 1 c 1 where µmax is the rate constant for the reaction mole l s ced ctea and ci are the concentration of electron donor ed terminal electron acceptor tea and inhibitor i concentration respectively mole l ked ktea and ki are the half saturation constant of ed half saturation constant of tea and inhibition constant respectively mole l note that there could be multiple inhibitors that can inhibit a specific redox reaction for instance sulfate reduction can be inhibited by the amount of oxygen nitrate and ferric iron dissolved in groundwater according to redox ladder such behavior was reflected in the rate law by adding extra inhibition term in equation 5 values used for parameters of reactive transport are listed in table s1 two typical minerals at the study area calcite and gypsum were considered and transition state theory was used as the rate law for precipitation dissolution it is noteworthy that we don t consider temperature dependence of reaction rates due to the relatively constant groundwater temperature at deep vadose zone for riparian zones where temperature varies greatly at daily to seasonal time scale the impact of temperature on reaction rates needs to be considered the molar concentration of each species in groundwater were assigned to the entire domain uniformly for initial condition for top bottom and east boundaries the same values were used for the dirichlet type transport boundary condition it is worth noting that rainwater may have different composition but its impact was considered minor especially on the deep aquifer due to the relatively small amount of precipitation compared to the recharge during the period as mentioned above the molar concentration of each species in river was used to constrain the west boundary because of the direct contact between infiltrated river water and groundwater during mar 2 3 simulation cases multiple cases were designed to assess impacts of controlling factors such as heterogeneity nitrate contamination source and river doc on biogeochemical environment during mar table 3 the base case case 1 assumed a homogeneous upper unit and the observed chemistry data of river water and groundwater were used as initial condition for reactive transport note that the lower unit was considered as an impermeable layer with low permeability of 1 10 15 m2 assigned uniformly case 2 added heterogeneity for the upper layer a random field generator gutjahr 1989 was used to derive the k distribution with the assumption that the permeability of the silty clay was lognormally distributed with mean lnk and variance σln k 2 the heterogeneous upper layer was generated with of geometric mean value of permeability equal to 2 66 10 11 m2 σln k 2 as 1 and anisotropy ratio the ratio of horizontal permeability to vertical permeability of 0 1 fig 4 case 3 and 4 were aimed to evaluate the impact of mar on existing nitrate contamination source under homogeneous and heterogeneous condition respectively since it was difficult to exactly characterize the scale of contamination source a synthetic source region of 40 m in length and 20 m in depth was placed on the upper left corner of the domain the concentration of nitrate source was 1 6 10 3 mol l and the source was implemented as initial condition cases 5 8 and case 9 10 were aimed to evaluate the impact of river doc and the degree of heterogeneity respectively cases 11 13 assumed the less increase of hydraulic head during mar where the values decreased to 80 60 and 40 of the true value respectively and cases 14 15 considered different permeability for the upper layer 3 results 3 1 fluctuation of water table in aquifer the fluctuation of water table is significantly influenced by the amount of infiltrated river water during mar fig 5 illustrates the temporal change of vertical saturation and velocity profiles at different distances away from the west it can be observed that transient change of water table at the boundary propagates toward inland reshaping the saturation profile across the entire domain water table decline is observed until the initiation of recharge on dec 2017 saturation at those observation points increases first and then decreases in the early stage because the smallest value observed in december 2017 was set as the initial water table it is worth emphasizing that the response of saturation profile to the change of hydraulic head at the boundary weakens with distance and the response time depends on hydraulic conductivity or permeability velocity profile over time illustrates the primary flow regime and the dynamics of velocity changes with mar fig 5 note that the flow direction and magnitude are represented by the arrow direction and magnitude respectively it can be observed that the velocity at middle depth is larger than that at shallow or deep depth this is because the intrinsic permeability of the shale layer at deep depth and the relative permeability of the unsaturated zone at shallow are both low vertical pressure profile is shown in fig s1 to help visualize temporal and spatial changes of pressure with the assumption of hydrostatic equilibrium for initial and boundary conditions the horizontal flow is dominant in this study shown by the horizontal velocity fig s2 and vertical velocity fig s3 because of river infiltration for mar 3 2 nitrate loading to groundwater spatial temporal profiles of nitrate under different conditions are compared to evaluate the impact of mar on nitrate evolution here we define the damköhler number for o2 da o2 as 6 da o 2 τ v o 2 where τ is the water residence time 1 s and vo2 is the oxygen reaction rate mole s dao2 can be used as an indicator that dao2 1 and 1 indicate denitrification and nitrification dominant process respectively zarnetske et al 2012 fig s4 shows the spatial profile of dao2 at different time after mar initiated it can be observed that the region river water passing through is aerated and thus under nitrification condition in contrast the region that is not impacted by river inflow is more likely to proceed denitrification because flux is relatively small and water residence time is long enough for denitrification to occur note that precipitation introduces infiltration and can also help denitrification nitrate profiles at the early 70 day medium 130 day and late time 200 day of mar under homogeneous and heterogeneous conditions are shown in fig 6 it can be observed that nitrate content in the region that not impacted by river inflow at shallow depth is almost constant during mar given limited oxygen in aquifer which constrains the nitrification dilution is the dominant process for nitrate change in subsurface the underlain shale serves as a barrier that impedes the downward movement of nitrate the edge of low concentration nitrate migrates inland along the connected high permeability pathways which is consistent to the heterogeneous k field shown in fig 4 the existence of the preferential flow paths pose a potential threat for groundwater quality at the location far away from river localized high concentration spots of nitrate in unsaturated soil have been detected at multiple sites due to downward leaching of irrigation water from land surface nitrate contamination to aquifer 20 30 m bls is minor before applying mar due to the relatively slow infiltration rate however rising water table during mar results in higher risks of groundwater to be contaminated a synthetic patch source was placed in the model to investigate the impact of mar on nitrate contamination to groundwater when local high concentration spots exist fig 7 it is shown that the nitrate source within the saturated zone as groundwater level increases during mar is mixed and diluted the groundwater with high concentration of nitrate migrated downgradient which shows a distinct concentration divergence between groundwater in shallow depth and deeper before fully mixed for the simulation conducted in heterogeneous domain the mixing process is stronger therefore leading to shorter travel distance of high concentration nitrate that has been diluted rapidly the edge of relatively low concentration nitrate is more dispersive and penetrates furthermore towards inland in given time window due to interconnected high permeability paths temporal nitrate profiles at different locations fig s6 also demonstrated that the affected area is strongly dependent on the hydraulic properties more area can be contaminated during mar if preferential flow path exists 3 3 doc loading to groundwater losing river continuously supplies organic carbon in aqueous form to groundwater due to the large amount of organic carbon stored in the river sediments a notable pulse of doc flux is observed instantly as the water table rises and the more water table rises the longer and more significantly the pulse presents fig 8 a the influx can increase up to 60 times of that before mar when mar applied the inflow from river to groundwater increases dramatically resulting in instant increase of doc flux doc commonly serves as electron donor for microbial mediated reaction occurring in reduced groundwater environment fig 8b shows carbon consumption rate ccr and the mean aerobic respiration rate which have similar shape with each other although carbon consumption can be attributed to both aerobic respiration and denitrification aerobic respiration predominates because the river water is oxygenated and the system is limited by carbon dilution factor of nitrate dfn which is defined as the ratio between the remained nitrate mass and the initial nitrate mass in the domain decreases over time as influent river water contain less nitrate compared with groundwater less nitrate is retained in the domain with stronger heterogeneity 3 4 sensitivity analysis of factors impacting groundwater quality sensitivity analysis was conducted to study the impact of multiple factors including river doc degree of heterogeneity change of hydraulic head and permeability it can be observed that ccr has positive correlation with doc concentration fig 9 a in particular ccr is limited by carbon supply when doc concentration is low and constrained by oxygen when doc is high the observed ccrs for simulations with higher doc 3x 4x and 5x are less distinct due to the depletion of oxygen in the system the impact of heterogeneity on ccr is more notable during the periods when water table highly fluctuates after mar applied during which flow rate is significantly increased and the more heterogeneous domain indicates more potential preferential flow resulting in higher ccr in the system whereas when water table gets stable the flow in the system is relatively slow the difference in ccrs for simulations with different heterogeneity is less noticeable fig 9b ccr under heterogeneous condition first outcompetes that under homogeneous condition because more river water recharges the aquifer along the preferential path however as recharged volume decrease ccr declines fast because the low permeability regions may play a more important role by slowing down water movement the influence of hydraulic head change that is determined by the recharged volume fig 9c and permeability fig 9d on ccr can both be explained from the perspective of flux higher flux either by recharging more water or with higher permeability for the aquifer leads to higher ccrs 4 discussion change of geochemical environment is often neglected when restore the groundwater level using mar however it has been widely reported that degradation of organic carbon bounded in river sediments can alter the geochemical environments in adjacent aquifer for example the reductive release of as in van phuc vietnam is attributed to the regular replenishment of river sediments rich in organic carbon wallis et al 2020 it is difficult to evaluate the capability of river to retain organic carbon or in other words how much organic carbon can be released from river sediments because many factors may affect the process such as the structure of riparian plants and the environment favorable for anaerobic decomposition for riparian zone most organic carbon is stored within the shallow soil layer near surface 1 m doc found in groundwater is usually low especially when water table is deep like in our case our model does not consider vertical variation of doc content due to the lack of data nevertheless the contrasting difference between the doc content in river water and groundwater is captured and thoroughly evaluated both dilution and denitrification can reduce the amount of nitrate in the subsurface the former plays a major role at our site and the later can predominate when more doc are supplied by the river the side effect is nitrate can be pushed away towards inland during mar along with dilution process however relative clean aquifer might get contaminated thus a dense network of monitoring well is necessary to evaluate the impact of mar on possible nitrate contamination moreover if extensive preferential flow paths exist such as highly connected conduits or fractures in karst aquifer the nitrate plume formed during mar may penetrate up to kilometers thermal regime in riparian zone is strongly related with the river flow condition losing gaining and important for the formation of hot spots river temperature can vary up to 20 30 c in a seasonal cycle usually with the highest temperature observed in summer and the lowest in winter depending on the local climate condition when it s a losing river in the system groundwater temperature is strongly impacted by the river consequently microbial related reactions whose reaction rates depending on temperature such as aerobic respiration and denitrification may be affected for mar with significant water table change 20 m it is expected that the groundwater temperature would be overwhelmed by the infilter river water in a short time window although we didn t explicitly consider the temperature effect in our study and the reactive impact on groundwater quality is not strong due to rapid flow during mar including a real time measurement of temperature in regular monitoring strategy remains important for better evaluation for the impact of mar on geochemical environments especially in a long term perspective our model made a few simplifications by emphasizing on the increasing saturated flow caused by river infiltration during mar firstly gas diffusion from gaseous phase to aqueous phase is not considered which may underestimate the rate of aerobic respiration occurring at the shallow vadose zone xu et al 2000 but the impact on the reaction in saturated zone is not expected because gas diffusion does not take place below water table secondly decomposition of organic matter is not considered either due to the difficulty to accurately characterize the decomposition rate at the regional scale which depends on sediment age and usually varies a few orders of magnitude appelo and postma 2005 thirdly heterogeneity especially in the horizontal direction is not well characterized due to the limited field information it is possible that more preferential flow paths exist especially in the karst environment which make it difficult to predict the location of the plume in addition to the above limitations the initial distribution of species may also introduce uncertainty for model prediction we applied a homogeneous initial condition for the entire domain whereas some species such as oxygen and doc usually decrease with depth a more realistic initial condition requires the acquisition of water samples from multiple depths which is not available at our study site 5 conclusions regular operation of mar was applied at yufu river in jinan china in recent years to maintain the groundwater level intensive agricultural activities have been developed resulting in massive nitrate contamination the impact of mar on the subsurface environment was first evaluated through a 2d cross section model mainly focusing on the loading of nitrate and organic carbon from river to groundwater the measured hydraulic head and composition of river water and groundwater were used as boundary conditions to drive the flow and reactive transport respectively aerobic respiration and two step denitrification are explicitly modeled through monod kinetics the average carbon consumption rate was used as the metric to evaluate the impact of multiple factors such as river doc loading heterogeneity and change of hydraulic head on reactions we found that denitrification is not likely to occur at our study site during mar because river doc is limited reduction of nitrate is mostly attributed to dilution effect as the introduction of a significant amount of water via mar it is notable that dissolution of nitrate at localized high concentration spots and migration along with groundwater flow can raise risks to the subsurface media randomly distributed low permeability lens can slow down the lateral flow thus less doc is supplied from the river and smaller reaction rate has been obtained the amount of doc decomposed from river sediments is the key factor that determines the redox condition of riparian zone with the increase of river doc denitrification may occur after depletion of oxygen besides reduction of minerals such as mn oxides or fe oxides if available although it is difficult to monitor the decomposition of organic carbon in real time we suggest monitoring doc or redox potential regularly in future when applying mar this study provides an insight into groundwater quality evolution process during mar therefore giving an important support for requirements of effective water quality control measures declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key r d program of china grant no 2021yfc3200502 national natural science foundation of china 42007162 41931292 and 92047202 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128847 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2633,managed aquifer recharge mar has been applied for groundwater restoration as an effective strategy in many overdraft regions in jinan china mar through river infiltration was conducted regularly in recent years because of the most famous spring groups drying up due to continuous decline of groundwater level caused by extensive pumping a substantial rise of water table 20 m has been observed near the river however the potential change in groundwater quality and geochemistry during mar process remains unknown in this study a flow and multi component reactive transport model was developed to evaluate the impact of mar on chemical reaction processes and the response of groundwater quality to the interaction of river water and groundwater the geochemical conditions of the river water and groundwater are significantly different as river water contained more dissolved organic carbon doc and less nitrate than groundwater did in the study area with intensive agricultural activity this study revealed that nitrate dilution rather than denitrification was the main process responsible for observed groundwater quality change during mar preferential flow occurring in the aquifer resulted in strong spatial variability of nitrate concentrations in the groundwater river water doc aquifer hydraulic conductivity distribution and river aquifer hydrodynamic conditions can all affect the redox condition in the riparian zone by changing either reaction rate or residence time the results from this study indicate that groundwater geochemistry can be significantly altered during mar suggesting the importance of regular monitoring plan to assess the changes in groundwater quality especially in the area where river sediments are rich in organic carbon such monitoring and reactive transport modeling analysis is critical to ensuring that the adverse impact on groundwater quality by potential mar operations be kept to a minimum keywords managed aquifer recharge groundwater quality geochemical environment surface water groundwater interaction preferential flow data availability data will be made available on request 1 introduction managed aquifer recharge mar has been widely applied for drinking water supply agricultural irrigation or sustaining groundwater in europe and u s sprenger et al 2017 for other countries such as china it is an emerging technique that has been used to address the issue of increasing water stress liu and zheng 2016 zheng and guo 2022 for example the south north water transfer project in china aims to deliver 44 8 km3 year of water from yangtze river basin in southern china to yellow river basin in northern china to reduce water stress due to groundwater depletion wilson et al 2017 mar mostly utilizes surface water e g river lake as the source and can be grouped into four categories including enhanced infiltration induced bank infiltration well injection and enhanced storage enhanced infiltration is the simplest and most commonly used technique this technique enhances infiltration by increasing the spreading of surface water at the scale of area line or point water thus infiltrates into subsurface by gravitational force or percolation sprenger et al 2017 since large amount of surface water are introduced into subsurface during mar how to keep the subsurface environment clean and safe becomes increasingly important especially in the area that suffers from groundwater contamination the changes of the groundwater quality and geochemical evolution due to recharged water with different geochemical environment has been reported in many previous studies e g bourg and bertin 1993 stuyfzand 1998 grischek and paufler 2017 bachtouli and comte 2019 which is related to many factors such as the amount of injected fluid content of dissolved oxygen organic matter and mineral species in the infiltrated water in intensive irrigation region highly fluctuating behavior of ammonium near river has been observed groeschke et al 2016 besides climate conditions such as drought can also impact the biogeochemical environments in riparian zone under highly dynamic river flow condition as shown in song et al 2018 besides the hydraulic head change and chemical interactions during mar aquifer heterogeneity especially where preferential flow paths exist is also a major factor that impacts the chemical evolution and distributions in subsurface e g zheng and gorelick 2003 guo and brusseau 2017 guo et al 2019a impacts of soil heterogeneity on contaminant transport in vadose zone and subsurface have been widely studied e g brusseau and guo 2014 slimene et al 2015 guo et al 2017 akbariyeh et al 2018 liu et al 2020 however the thorough investigation of heterogeneity impacts on groundwater quality evolution during mar is still lacking integrated studies of surface and subsurface with highly heterogeneous mixtures on chemical transport and water quality evolution remain few especially involving detailed biogeochemical reactions regular sampling in regions with vulnerable groundwater is important for assessing groundwater quality however the deployment of a dense monitoring network is expensive and thus unrealizable in most cases regional scale transport modeling is a fast growing tool that has been used to assess groundwater quality under anthropogenic or natural condition e g steefel et al 2005 arora et al 2016 li at al 2017 guo et al 2019b guo et al 2020 bao et al 2017 developed a watershed reactive transport model to study the impact of integrated hydrologic process between surface water and groundwater on subsurface geochemical environment this model was further improved by adding biological process to simulate the export of dissolved organic carbon to stream zhi et al 2019 arora et al 2016 used reactive transport modeling toughreact to show that subsurface carbon flux is highly correlated with redox condition microbial activity water table fluctuation and temperature occurring in riparian zone for hyporheic zone the formation of nitrogen hot moments and hot spots are found to be related to the biogeochemical exchange between river and aquifer dwivedi et al 2018a dwivedi et al 2018b the purpose of this work is to assess the potential impact of mar on the biogeochemical environment in the riparian zone under intensive agricultural activities using a numerical model two major questions will be focused 1 how the nitrate distribution beneath agricultural land may evolve after initiation of mar and 2 how river doc may impact the biogeochemical environment during the rapid increase of groundwater level 2 methodology 2 1 study site the study site is located at yufu river in jinan china fig 1 a jinan has long been famous for the widely distributed karst springs fed by yufu river the earliest recorded spring baotu can be traced back to 3000 years ago however some of the springs have dried up in the last two decades due to excessive groundwater pumping aquifer recharge was thus employed to maintain the groundwater level and prevent the drying springs the first aquifer recharge experiment was conducted in 2001 by injecting 5 106 m3 water that released from wohushan reservoir within 12 days an obvious increase of groundwater level can be observed right after the recharge thereafter aquifer recharge has been adopted as a regular strategy to maintain the groundwater level this study focused on changes in groundwater during 10 1 2017 and 5 31 2018 which includes a recharge event initiated on 11 17 2017 fig 2 shows the daily groundwater level at cuima village near yufu river recorded since 10 1 2017 it can be observed that groundwater level increased 20 m in december due to bank infiltration after recharge began followed by 3 months stable before raised again on late march due to the increase of aquifer recharge regional geological information near yufu river was obtained from previous geological survey and boreholes drilled recently near the river the thickness of quaternary strata over this region ranges from 7 to 30 m and the major minerals are limestone dolomite and gypsum soil texture changes from gravel sand to clay in the vertical direction from ground surface water table fluctuates between 20 m and 70 m blow land surface bls and the thickness of unconfined aquifer is in the range of 10 30 m water quality has been monitored by collecting multiple groundwater and river water in the region li et al 2017 and the chemical species are detected in the river the concentration of the major cation ca2 is within the range of 1 29 10 3 3 76 10 3 mol l and the major anion so4 2 is 1 39 10 3 1 41 10 3 mol l in groundwater ca2 concentration is within 1 11 10 3 3 93 10 3 mol l and the major anions hco3 and so4 2 that coming from the dissolution of calcite and gypsum are 3 1 10 3 8 92 10 3 mol l and 6 54 10 4 1 57 10 3 mol l respectively the nitrate concentration is found to be up to 1 94 10 3 mol l in groundwater at some sampling sites far beyond the drinking water standard of nitrate no3 7 26 10 4 mol l established by u s environmental protection agency epa nitrate contamination is attributed to agricultural activities at land surface the impacts of mar on nitrate contamination will be evaluated further 2 2 numerical model 2 2 1 governing equation a 2 d transect model was built to assess the impact of mar on nitrate transport and other naturally existed geochemical species near river pflotran a massively parallel flow and reactive transport simulator was used to simulate the non isothermal variably saturated and reactive transport system hammond et al 2014 the mass balance equation for single phase variably saturated flow is described by three dimension richards equation 1 t φ s η η q q w with darcy flux q m s defined as 2 q k k r μ p ρ g z where ϕ indicates porosity s is saturation η is molar water density kmol m3 ρ is water density kg m3 k is intrinsic permeability m2 kr is relative permeability µ is viscosity pa s p is pressure pa g is gravity m s2 and qw is source sink term kmol m3 s the governing equation for multi component reactive transport in single phase flow is 3 t φ s ψ j ω j q j m ν jm i m s j t with the total flux ωj mol l s defined as 4 ω j q φ s d ψ j where j represents the jth primary species hereinafter ψj is the total concentration mol l qj is the source sink term mol l s νjm is the stoichiometry coefficient of jth primary species in mineral m im is the mineral precipitation dissolution rate based on transition state rate mol l s and sj is the sorbed concentration mol l 2 2 2 model setup the model domain was represented by a regular shape without considering the geometry of the riverbank due to the small portion of the riverbank over the domain fig 3 model dimension was 1000 m in strike direction and 46 2 m in vertical direction with the grid space of 8 m and 0 2 m respectively a fine resolution in vertical direction was aimed to better characterize the rapid change of water table at the boundary during mar two units upper unit 0 31 8 m below the land surface including relative coarse materials and lower unit 31 8 46 2 m below the land surface primarily composed by shale were identified from borehole data the upper unit penetrated to the depth of 31 8 m with permeability as 2 66x10 11 m2 estimated from pumping test the lower unit considered as an impermeable zone was modelled uniformly with a low permeability of 1 10 15 m2 since water table did not rise to shallow depth 3 m during mar the gravel sand layer that presented at shallow depth was not explicitly represented therefore in this study the hydraulic property at the shallow depth was not expected to influence the flow and transport that primarily occurred in saturated zone van genuchten mualem model was used to calculate saturation and relative hydraulic conductivity with parameters adapted from previous study li et al 2018 boundary conditions for flow were assigned by accommodating the physical condition on each side the top boundary was set to be flux type neumann using the measured daily precipitation it was worth noting that the surface infiltration rate may be different from precipitation value given the partition of surface runoff however this was not expected to impact the results much due to the small amount of precipitation during the simulation period compared with recharged water the bottom boundary was set to be zero flux no flow for the west a dirichlet type of boundary was applied using the measured time series of water table fig 2 the dynamics of water table is highly related to the amount of water recharged during mar the vertical pressure profile of the west boundary was assumed to satisfy hydrostatic equilibrium with the reference pressure equivalent to atmospheric pressure 101 325 pa at the water table the same assumption was made for the constant dirichlet boundary condition at the east side and the initial condition the water table at the east side was set to be 35 8 m the minimum water table recorded at the west side temperature was assumed to be constant at 20 c for the simulation the initial or boundary condition for reactive transport were adapted from the composition of groundwater and river water table 1 reduced dissolved organic carbon doc served as the electron donor for aerobic respiration and two step denitrification table 2 doc dissolved from solid organic matter was represented by ch3coo michaelis menten kinetics was used as the rate law for redox reactions 5 r μ max c ed c ed k ed c tea c tea k tea k 1 k 1 c 1 where µmax is the rate constant for the reaction mole l s ced ctea and ci are the concentration of electron donor ed terminal electron acceptor tea and inhibitor i concentration respectively mole l ked ktea and ki are the half saturation constant of ed half saturation constant of tea and inhibition constant respectively mole l note that there could be multiple inhibitors that can inhibit a specific redox reaction for instance sulfate reduction can be inhibited by the amount of oxygen nitrate and ferric iron dissolved in groundwater according to redox ladder such behavior was reflected in the rate law by adding extra inhibition term in equation 5 values used for parameters of reactive transport are listed in table s1 two typical minerals at the study area calcite and gypsum were considered and transition state theory was used as the rate law for precipitation dissolution it is noteworthy that we don t consider temperature dependence of reaction rates due to the relatively constant groundwater temperature at deep vadose zone for riparian zones where temperature varies greatly at daily to seasonal time scale the impact of temperature on reaction rates needs to be considered the molar concentration of each species in groundwater were assigned to the entire domain uniformly for initial condition for top bottom and east boundaries the same values were used for the dirichlet type transport boundary condition it is worth noting that rainwater may have different composition but its impact was considered minor especially on the deep aquifer due to the relatively small amount of precipitation compared to the recharge during the period as mentioned above the molar concentration of each species in river was used to constrain the west boundary because of the direct contact between infiltrated river water and groundwater during mar 2 3 simulation cases multiple cases were designed to assess impacts of controlling factors such as heterogeneity nitrate contamination source and river doc on biogeochemical environment during mar table 3 the base case case 1 assumed a homogeneous upper unit and the observed chemistry data of river water and groundwater were used as initial condition for reactive transport note that the lower unit was considered as an impermeable layer with low permeability of 1 10 15 m2 assigned uniformly case 2 added heterogeneity for the upper layer a random field generator gutjahr 1989 was used to derive the k distribution with the assumption that the permeability of the silty clay was lognormally distributed with mean lnk and variance σln k 2 the heterogeneous upper layer was generated with of geometric mean value of permeability equal to 2 66 10 11 m2 σln k 2 as 1 and anisotropy ratio the ratio of horizontal permeability to vertical permeability of 0 1 fig 4 case 3 and 4 were aimed to evaluate the impact of mar on existing nitrate contamination source under homogeneous and heterogeneous condition respectively since it was difficult to exactly characterize the scale of contamination source a synthetic source region of 40 m in length and 20 m in depth was placed on the upper left corner of the domain the concentration of nitrate source was 1 6 10 3 mol l and the source was implemented as initial condition cases 5 8 and case 9 10 were aimed to evaluate the impact of river doc and the degree of heterogeneity respectively cases 11 13 assumed the less increase of hydraulic head during mar where the values decreased to 80 60 and 40 of the true value respectively and cases 14 15 considered different permeability for the upper layer 3 results 3 1 fluctuation of water table in aquifer the fluctuation of water table is significantly influenced by the amount of infiltrated river water during mar fig 5 illustrates the temporal change of vertical saturation and velocity profiles at different distances away from the west it can be observed that transient change of water table at the boundary propagates toward inland reshaping the saturation profile across the entire domain water table decline is observed until the initiation of recharge on dec 2017 saturation at those observation points increases first and then decreases in the early stage because the smallest value observed in december 2017 was set as the initial water table it is worth emphasizing that the response of saturation profile to the change of hydraulic head at the boundary weakens with distance and the response time depends on hydraulic conductivity or permeability velocity profile over time illustrates the primary flow regime and the dynamics of velocity changes with mar fig 5 note that the flow direction and magnitude are represented by the arrow direction and magnitude respectively it can be observed that the velocity at middle depth is larger than that at shallow or deep depth this is because the intrinsic permeability of the shale layer at deep depth and the relative permeability of the unsaturated zone at shallow are both low vertical pressure profile is shown in fig s1 to help visualize temporal and spatial changes of pressure with the assumption of hydrostatic equilibrium for initial and boundary conditions the horizontal flow is dominant in this study shown by the horizontal velocity fig s2 and vertical velocity fig s3 because of river infiltration for mar 3 2 nitrate loading to groundwater spatial temporal profiles of nitrate under different conditions are compared to evaluate the impact of mar on nitrate evolution here we define the damköhler number for o2 da o2 as 6 da o 2 τ v o 2 where τ is the water residence time 1 s and vo2 is the oxygen reaction rate mole s dao2 can be used as an indicator that dao2 1 and 1 indicate denitrification and nitrification dominant process respectively zarnetske et al 2012 fig s4 shows the spatial profile of dao2 at different time after mar initiated it can be observed that the region river water passing through is aerated and thus under nitrification condition in contrast the region that is not impacted by river inflow is more likely to proceed denitrification because flux is relatively small and water residence time is long enough for denitrification to occur note that precipitation introduces infiltration and can also help denitrification nitrate profiles at the early 70 day medium 130 day and late time 200 day of mar under homogeneous and heterogeneous conditions are shown in fig 6 it can be observed that nitrate content in the region that not impacted by river inflow at shallow depth is almost constant during mar given limited oxygen in aquifer which constrains the nitrification dilution is the dominant process for nitrate change in subsurface the underlain shale serves as a barrier that impedes the downward movement of nitrate the edge of low concentration nitrate migrates inland along the connected high permeability pathways which is consistent to the heterogeneous k field shown in fig 4 the existence of the preferential flow paths pose a potential threat for groundwater quality at the location far away from river localized high concentration spots of nitrate in unsaturated soil have been detected at multiple sites due to downward leaching of irrigation water from land surface nitrate contamination to aquifer 20 30 m bls is minor before applying mar due to the relatively slow infiltration rate however rising water table during mar results in higher risks of groundwater to be contaminated a synthetic patch source was placed in the model to investigate the impact of mar on nitrate contamination to groundwater when local high concentration spots exist fig 7 it is shown that the nitrate source within the saturated zone as groundwater level increases during mar is mixed and diluted the groundwater with high concentration of nitrate migrated downgradient which shows a distinct concentration divergence between groundwater in shallow depth and deeper before fully mixed for the simulation conducted in heterogeneous domain the mixing process is stronger therefore leading to shorter travel distance of high concentration nitrate that has been diluted rapidly the edge of relatively low concentration nitrate is more dispersive and penetrates furthermore towards inland in given time window due to interconnected high permeability paths temporal nitrate profiles at different locations fig s6 also demonstrated that the affected area is strongly dependent on the hydraulic properties more area can be contaminated during mar if preferential flow path exists 3 3 doc loading to groundwater losing river continuously supplies organic carbon in aqueous form to groundwater due to the large amount of organic carbon stored in the river sediments a notable pulse of doc flux is observed instantly as the water table rises and the more water table rises the longer and more significantly the pulse presents fig 8 a the influx can increase up to 60 times of that before mar when mar applied the inflow from river to groundwater increases dramatically resulting in instant increase of doc flux doc commonly serves as electron donor for microbial mediated reaction occurring in reduced groundwater environment fig 8b shows carbon consumption rate ccr and the mean aerobic respiration rate which have similar shape with each other although carbon consumption can be attributed to both aerobic respiration and denitrification aerobic respiration predominates because the river water is oxygenated and the system is limited by carbon dilution factor of nitrate dfn which is defined as the ratio between the remained nitrate mass and the initial nitrate mass in the domain decreases over time as influent river water contain less nitrate compared with groundwater less nitrate is retained in the domain with stronger heterogeneity 3 4 sensitivity analysis of factors impacting groundwater quality sensitivity analysis was conducted to study the impact of multiple factors including river doc degree of heterogeneity change of hydraulic head and permeability it can be observed that ccr has positive correlation with doc concentration fig 9 a in particular ccr is limited by carbon supply when doc concentration is low and constrained by oxygen when doc is high the observed ccrs for simulations with higher doc 3x 4x and 5x are less distinct due to the depletion of oxygen in the system the impact of heterogeneity on ccr is more notable during the periods when water table highly fluctuates after mar applied during which flow rate is significantly increased and the more heterogeneous domain indicates more potential preferential flow resulting in higher ccr in the system whereas when water table gets stable the flow in the system is relatively slow the difference in ccrs for simulations with different heterogeneity is less noticeable fig 9b ccr under heterogeneous condition first outcompetes that under homogeneous condition because more river water recharges the aquifer along the preferential path however as recharged volume decrease ccr declines fast because the low permeability regions may play a more important role by slowing down water movement the influence of hydraulic head change that is determined by the recharged volume fig 9c and permeability fig 9d on ccr can both be explained from the perspective of flux higher flux either by recharging more water or with higher permeability for the aquifer leads to higher ccrs 4 discussion change of geochemical environment is often neglected when restore the groundwater level using mar however it has been widely reported that degradation of organic carbon bounded in river sediments can alter the geochemical environments in adjacent aquifer for example the reductive release of as in van phuc vietnam is attributed to the regular replenishment of river sediments rich in organic carbon wallis et al 2020 it is difficult to evaluate the capability of river to retain organic carbon or in other words how much organic carbon can be released from river sediments because many factors may affect the process such as the structure of riparian plants and the environment favorable for anaerobic decomposition for riparian zone most organic carbon is stored within the shallow soil layer near surface 1 m doc found in groundwater is usually low especially when water table is deep like in our case our model does not consider vertical variation of doc content due to the lack of data nevertheless the contrasting difference between the doc content in river water and groundwater is captured and thoroughly evaluated both dilution and denitrification can reduce the amount of nitrate in the subsurface the former plays a major role at our site and the later can predominate when more doc are supplied by the river the side effect is nitrate can be pushed away towards inland during mar along with dilution process however relative clean aquifer might get contaminated thus a dense network of monitoring well is necessary to evaluate the impact of mar on possible nitrate contamination moreover if extensive preferential flow paths exist such as highly connected conduits or fractures in karst aquifer the nitrate plume formed during mar may penetrate up to kilometers thermal regime in riparian zone is strongly related with the river flow condition losing gaining and important for the formation of hot spots river temperature can vary up to 20 30 c in a seasonal cycle usually with the highest temperature observed in summer and the lowest in winter depending on the local climate condition when it s a losing river in the system groundwater temperature is strongly impacted by the river consequently microbial related reactions whose reaction rates depending on temperature such as aerobic respiration and denitrification may be affected for mar with significant water table change 20 m it is expected that the groundwater temperature would be overwhelmed by the infilter river water in a short time window although we didn t explicitly consider the temperature effect in our study and the reactive impact on groundwater quality is not strong due to rapid flow during mar including a real time measurement of temperature in regular monitoring strategy remains important for better evaluation for the impact of mar on geochemical environments especially in a long term perspective our model made a few simplifications by emphasizing on the increasing saturated flow caused by river infiltration during mar firstly gas diffusion from gaseous phase to aqueous phase is not considered which may underestimate the rate of aerobic respiration occurring at the shallow vadose zone xu et al 2000 but the impact on the reaction in saturated zone is not expected because gas diffusion does not take place below water table secondly decomposition of organic matter is not considered either due to the difficulty to accurately characterize the decomposition rate at the regional scale which depends on sediment age and usually varies a few orders of magnitude appelo and postma 2005 thirdly heterogeneity especially in the horizontal direction is not well characterized due to the limited field information it is possible that more preferential flow paths exist especially in the karst environment which make it difficult to predict the location of the plume in addition to the above limitations the initial distribution of species may also introduce uncertainty for model prediction we applied a homogeneous initial condition for the entire domain whereas some species such as oxygen and doc usually decrease with depth a more realistic initial condition requires the acquisition of water samples from multiple depths which is not available at our study site 5 conclusions regular operation of mar was applied at yufu river in jinan china in recent years to maintain the groundwater level intensive agricultural activities have been developed resulting in massive nitrate contamination the impact of mar on the subsurface environment was first evaluated through a 2d cross section model mainly focusing on the loading of nitrate and organic carbon from river to groundwater the measured hydraulic head and composition of river water and groundwater were used as boundary conditions to drive the flow and reactive transport respectively aerobic respiration and two step denitrification are explicitly modeled through monod kinetics the average carbon consumption rate was used as the metric to evaluate the impact of multiple factors such as river doc loading heterogeneity and change of hydraulic head on reactions we found that denitrification is not likely to occur at our study site during mar because river doc is limited reduction of nitrate is mostly attributed to dilution effect as the introduction of a significant amount of water via mar it is notable that dissolution of nitrate at localized high concentration spots and migration along with groundwater flow can raise risks to the subsurface media randomly distributed low permeability lens can slow down the lateral flow thus less doc is supplied from the river and smaller reaction rate has been obtained the amount of doc decomposed from river sediments is the key factor that determines the redox condition of riparian zone with the increase of river doc denitrification may occur after depletion of oxygen besides reduction of minerals such as mn oxides or fe oxides if available although it is difficult to monitor the decomposition of organic carbon in real time we suggest monitoring doc or redox potential regularly in future when applying mar this study provides an insight into groundwater quality evolution process during mar therefore giving an important support for requirements of effective water quality control measures declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key r d program of china grant no 2021yfc3200502 national natural science foundation of china 42007162 41931292 and 92047202 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128847 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2634,a falling head test is a common method to estimate aquifer properties in which the water level in a well is increased suddenly which is a key assumption for the data to be analyzed by traditional methods such as cooper et al and hvorslev methods however there are situations where the water level increases in the well occurs for a relatively long period before it falls in this case theoretically there is no existing method to analyze the data hydrogeologists or geotechnical engineers still use the traditional methods to analyze the data even the water level increase is not instantaneous this study derives a semi analytical solution to describe water level change in this case the mathematical model consists of the injection stage and water level fall stage it is found that the water level mound induced by non instantaneous injection leads to slower decrease of water level in the well comparing to the instantaneous injection this study further analyses the errors of the estimated hydraulic properties if the data are analyzed by traditional methods if calculated by cooper et al method the storativity is underestimated but there is no impact on estimated hydraulic conductivity the hydraulic conductivity calculated by hvorslev method is underestimated and the error of underestimation increases with injection time and aquifer parameters the actual hydraulic conductivity can be a few times of the estimated value for typical aquifer parameters in hong kong furthermore a field experiment is conducted to compare the instantaneous method non instantaneous method and field data the present solution fits the data well and the errors of estimated parameters by instantaneous injection method are consistent with the conclusions in the error analysis keywords falling head test non instantaneous injection semi analytical solution error of cooper et al method error of hvorslev method data availability data will be made available on request 1 introduction in groundwater investigations the aquifer hydraulic properties are key properties to be determined various experiments were developed to estimate these properties among these experiments the single well variable head test known as slug test rising or falling head test is one of the most popular in situ methods the slug test involves instantaneously adding water to or taking it from a well or dropping a slug of known volume into or take it out from the well for most of the piezometers or standpipes for geotechnical engineering purposes the diameter of the well may be too small to allow taking water out of it or dropping a slug into it for example the typical diameter of a piezometer in the united britain and hong kong for geotechnical purposes is only 19 or 25 mm so adding water to conduct a falling head test is the most common slug test in this study the falling head test is mainly discussed without loss of generality to date the theories to analyze the data obtained by slug test under various hydrogeological conditions have been well developed and summarized by butler 1998 for example the cooper et al method cooper et al 1967 and hvorslev method hvorslev 1951 were introduced to analyze the falling head test data in confined aquifers with the cases of fully and partially penetrating wells the bouwer and rice method bouwer and rice 1976 and the dagan method dagan 1978 were introduced to analyze falling head test data in unconfined aquifers with the cases of wells screened below and across the water table for the falling head test in confined aquifers the hvorslev method can only estimate the hydraulic conductivity the cooper et al methods can estimate both hydraulic conductivity and storativity after a falling head test is conducted hydrogeologists use the methods to interpret the data that can estimate both hydraulic conductivity and storativity but geotechnical engineers prefer to use hvorslev method to analyze the data because they are usually only interested in estimating hydraulic conductivity which is sufficient for various geotechnical purposes such as foundation design and slope stability analysis due to the simplicity of data interpretation by hvorslev method the falling head tests have been widely practiced in the geotechnical engineering in many countries or regions such as britain india malaysia and hong kong british geotechnical society 1974 geological investigations and subsurface exploration sectional committee india 1985 geotechnical control office 1987 according to the procedures of the implementation of the falling head test water is injected to the well to raise the water level to a certain value instantaneously in hong kong the water level in the piezometer is required to be raised to a minimum of 3 m cedd 2006 in india the code of practice specified that water level is raised to the top of the well geological investigations and subsurface exploration sectional committee india 1985 the minimum requirement of initial water column height of 3 m is to ensure that sufficient manual measurements of water level can be taken otherwise the time duration for the water level to fall to the initial water level will be very short and only few water level data points can be measured manually which may not be sufficient to produce a reliable water level curve geotechnical control office 1987 although the theoretical requirement using all the data interpretation methods mentioned early is that the water level in the well should be increased instantaneously most geotechnical engineers overlooked this requirement very often fill the water to the top of the well and may leave it for a while there are also situations when imposing instantaneous change of water level is unrealistic for example if the diameter of the well is large or the response zone of the well is long or the aquifer is very permeable it is difficult to ensure enough water level increase without keeping injection of water ding 2006 the common practice by geotechnical engineers is that they obtain the data without creating water level rise instantaneously but then use the analytical equations that are based the assumption of instantaneous injection to deal with the data it is expected that such a practice may lead to errors in estimated parameters but so far there is no study about that analytical studies of falling head tests in confined aquifers with non instantaneous injection of water are carried out in this study theoretically the falling head test with non instantaneous injection can be divided into two stages i e the injection stage and the water level recovery stage the injection stage is quantified by the analytical solution of the response of water level in a finite diameter well to the non instantaneous water injection and this solution has been obtained by papadopulos and cooper jr 1967 and the water level recovery stage is quantified by the analytical model of falling head test with non zero initial water level condition in the aquifer which will be solved in this study then the influence of injection stage on the water level distribution is explored and the error of hydraulic conductivity estimated by the cooper et al method and hvorslev method is analyzed by comparing the hydraulic conductivities estimated by these traditional solutions and the solution derived in this study 2 the instantaneous injection methods prior to introducing the analytical model of falling head test of non instantaneous injection the instantaneous injection methods in confined aquifers are reviewed in this section in a confined aquifer with fully penetrating well and instantaneous injection the cooper et al method and hvorslev method are the major methods for the estimation of hydraulic conductivity fig 1 depicts the general setting of the falling head test and identifies the difference of initial water level distribution between the falling head tests of instantaneous injection fig 1 a and non instantaneous injection fig 1 b 2 1 the cooper et al method the mathematical model of cooper et al method cooper et al 1967 is defined as follows 1 2 h r 2 1 r h r s t h t 2 h t 0 t 0 3 2 π r w t h r t r r r w π r c 2 h t t t 0 4 h r w t h t t 0 5 h r 0 0 r w r 6 h t 0 h 0 where h is the deviation of hydraulic head or water level in the aquifer from static condition s is the coefficient of storage i e storativity b is the aquifer thickness t is the transmissibility of the aquifer t k b k is the hydraulic conductivity r is the radial distance r w is the radius of well screen r c is the radius of well casing h t is the monitored water level in the borehole the mathematical model eqs 1 6 is based on the assumptions of a homogeneous aquifer darcy flow and instantaneous water injection the analytical solution of the mathematical model eqs 1 6 was provided by cooper et al 7 h r t h 0 f α β where 8 α r w 2 r c 2 s β t t r c 2 and f α β is the curve determined by α β and t the mathematical expression of f α β is 9 f α β 2 π 0 e β u 2 α j 0 u r r w u y 0 u 2 α y 1 u y 0 u r r w u j 0 u 2 α j 1 u d u δ u where δ u is 10 δ u u j 0 u 2 α j 1 u 2 u y 0 u 2 α y 1 u 2 from eqs 7 10 the water level recovery curve the well is obtained 11 h t h 0 8 α π 2 0 e β u 2 α d u u 2 δ u the analytical solution eq 11 can be plotted as a series of h t h 0 vs β curves as shown in fig 2 with each curve corresponding to a certain value of α in this figure h h 0 or normalized water level is used normalized water level is used in most of the figures and discussions for the convenience of discussion the word normalized is omitted the cooper et al method is implemented by fitting one of the α curves to the monitored water level recovery curve so the storativity can be calculated based on the definition of α eq 8 and then reading the real time t from the curve at β 1 0 so the transmissibility t of the aquifer is calculated from eq 8 2 2 hvorslev method hvorslev method as an alternative method for the analysis of falling head test data with instantaneous injection involves two different assumptions compared to cooper et al method 1 the elastic storage is ignored in hvorslev method 2 the lateral boundary of the hvorslev method is at finite distance but that of cooper et al method is at infinite distance therefore eqs 1 and 2 are modified as follows in hvorslev method 12 2 h r 2 1 r h r 0 13 h r e t 0 t 0 where r e is the effective radius of the falling head test the analytical solution to the mathematical model defined by hvorslev method is 14 ln h t h 0 f k π r c 2 t where f is the shape factor of the well defined as 15 f 2 π b ln r e r s the hvorslev method is implemented by finding the time t 0 where ln h h 0 1 i e h h 0 0 37 in the water level recovery curve although the assumptions of the cooper et al method and hvorslev method are different chirlin 1989 proved that the estimated hydraulic conductivity by the two methods can be very similar by choosing appropriate value of effective radius r e in hvorslev method 3 non instantaneous injection method in the instantaneous injection model of the falling head test at t 0 there is sharp change in the water level 0 in the aquifer and h 0 in the wellbore fig 1 a however for the falling head test of non instantaneous injection water is injected to the borehole gradually for a certain time period before the water level in the borehole reaches h 0 and a water level mound is formed around the well fig 1 b this water level mound at the end of injection will be initial water level at the recovery stage when injection ceases the mathematical model for the falling head test with non instantaneous injection is developed to describe the water level change during the recovery period the non instantaneous injection model consists of two stages the injection stage and the water level recovery stage the semi analytical solution of water level in the recovery period is derived this solution together with the existing solution in the injection stage is used to discuss the impact of the non instantaneous injection on the water level and parameter estimation 3 1 the injection stage of the falling head test with non instantaneous injection the mathematical model of the injection stage has already been developed by papadopulos and cooper jr 1967 16 2 h r 2 1 r h r s t h t r r w 17 h t 0 t 0 18 2 π r w t h r t r r r w π r c 2 h t t q t 0 19 h r 0 0 r w r where q is the injection rate eq 18 describes that the injection rate to the borehole is equal to the sum of the rate of water flowing from the well to the aquifer and the rate of water volume increase in the borehole the meanings of other equations are straightforward the analytical solution of eqs 16 19 papadopulos and cooper jr 1967 is 20 h r t 2 q α π 2 t 0 1 e β u 2 α j 0 u r r w u y 0 u 2 α y 1 u y 0 u r r w u j 0 u 2 α j 1 u d u u 2 δ u eq 20 quantifies the water level in both the aquifer and the well during the injection stage and provides the initial condition of the water level in the aquifer at the recovery stage 3 2 water level recovery stage of the falling head test with non instantaneous injection after a certain time of injection the water level in the aquifer will be higher than the initial static water level fig 1 b which can be calculated by eq 20 using the water level after non instantaneous as the initial water level the mathematical model of the water level in the recovery stage can be written as 21 2 h r 2 1 r h r s t h t r r w 22 h t 0 t 0 23 2 π r w t h r t r r r w π r c 2 h t t 0 t 0 24 h r 0 g r r w r eq 23 means the decreasing rate of the volume of water in the borehole equals the water flow rate from the borehole to the aquifer eq 24 is the initial water level g r is the hydraulic head distribution at the end of injection time t i and is calculated by eq 20 i e g r h r t i specifically the initial water level in the borehole at the water level recovery stage is given by h 0 g r w by applying the laplace transform with respect to time to eqs 21 23 and using the initial condition defined by eq 24 the analytical solution of the mathematical model defined by eqs 21 24 in the laplace space is 25 h ˆ r p h ˆ 1 r p f r w p r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r h ˆ r p where p is the complex number in laplace space q p s t k 0 q r k 0 q r w and k 1 q r w are the second kind modified bessel functions the derivation of the analytical solution is presented in the support information eq 25 shows that the analytical solution in laplace space is the summation of three terms the first term h ˆ 1 r p is equal to the analytical solution of the mathematical model defined by cooper et al method in laplace space 26 h ˆ 1 r p r c 2 h 0 r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r the second and third terms in eq 25 are the terms quantifying the influence of initial condition g r on the analytical solution in laplace space f r w p and h ˆ r p in eq 25 are calculated as follows 27 f r w p r c 2 i 0 q r w 2 r w t q i 1 q r w r w r 0 g r 0 s t k 0 q r 0 d r 0 28 h ˆ r p k 0 q r r w r r 0 s t g r 0 i 0 q r 0 d r 0 i 0 q r r r 0 s t g r 0 k 0 q r 0 d r 0 where i 0 q r 0 and i 0 q r are the first kind modified bessel functions then the inverse transform of eq 25 yields the analytical solution of eqs 21 24 29 h r t h 0 f α β l 1 f r p where f α β is defined by eq 8 l 1 represents the inverse laplace transform the term f r p in eq 29 is the summation of the second and third terms defined in eq 25 that is 30 f r p f r w p r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r h ˆ r p according to eq 29 the analytical solution is the summation of two terms the first term h 0 f α β is the result of inverse laplace transform of eq 26 and is the analytical solution of mathematical model defined in cooper et al method h 0 f α β can also be regarded as the analytical solution of eqs 21 23 with static water level distribution i e g r 0 the second term l 1 f r p quantifies the influence of initial water level distribution g r on the water level distribution at the second stage therefore the second term in eq 30 determines the difference of water level distribution in the aquifer between the falling head test with instantaneous injection and with non instantaneous injection moreover the term l 1 f r p includes the inverse laplace transform of complex integrals of bessel functions and non linear initial water level distribution g r so it is difficult to find the analytical form of l 1 f r p using the traditional contour integration method then the calculation of the term l 1 f r p is conducted by numerical inversion of laplace transform method de hoog et al 1982 specifically by setting r r w in the analytical solution eq 20 the water level recovery curve in the borehole is obtained 31 h r w t 8 h 0 α π 2 0 e β u 2 α d u u 2 δ u l 1 f r w p as is shown in eq 31 the time domain solution to the equation of falling head test with non instantaneous injection is the summation of two terms the first term is the water level recovery curve of the falling head test with instantaneous injection eq 11 the second term determines the difference between the water level recovery curve of the falling head test with non instantaneous injection and with instantaneous injection the difference will be discussed in the following section in detail as the term l 1 f r w p is calculated by numerical inversion of laplace transform the time domain solution is the semi analytical solution of the mathematical model defined by eqs 21 24 the solution expressed by eq 31 is also examined by solving the governing equations eqs 21 24 numerically which is presented in support information 4 comparison of models given the time domain solution of the falling head test with non instantaneous injection eq 29 the influences of non instantaneous injection on the water level recovery curve and the water level distribution in the aquifer can be explored quantitatively the error of hydraulic conductivity estimated by cooper et al method or hvorslev method from the falling head test of non instantaneous injection can also be quantified 4 1 comparison of water level distributions in the aquifer the influence of non instantaneous injection on the water level distribution in the aquifer is analyzed by comparing the difference of water level distribution between the non instantaneous and the instantaneous injection models the difference is determined by the term of l 1 f r p in eq 29 if l 1 f r p is negative the water level in the non instantaneous model is lower than the instantaneous model otherwise the water level in the former is higher than the latter fig 3 presents the comparison of water level distributions in the aquifer between instantaneous and non instantaneous injection the injection rate is set to be q 2 1 0 4 m 3 s and injection time is 5 min the well configurations are r w 0 06 m r c 0 06 m the aquifer parameters are t 1 1 0 5 m 2 s s 0 01 for instantaneous injection the water level rises from initial water level of 0 while for non instantaneous injection the water level falls from its initial water level as time increases the water level near the well in the non instantaneous case is always higher than that in the instantaneous case it can be concluded that the water level mound induced by the non instantaneous case results in higher water level at the recovery stage than that in the instantaneous case which is expected to influence the water level recovery rate in the well 4 2 comparison of water level recovery curves in the well the influence of non instantaneous injection on the water level recovery curve in the well is analyzed by comparing the difference of water level recovery curves between the non instantaneous and instantaneous cases referring to eq 31 the term l 1 f r p determines the difference of the water level recovery curve in the well the water level in the well in the non instantaneous case is lower or higher than the instantaneous case depending on if l 1 f r p is negative or positive fig 4 compares the water level recovery curves in the well for the non instantaneous case with the same injection rate but different injection time which leads to different h 0 the water level in the well in all the non instantaneous cases are always higher than those in the instantaneous case therefore the water level mound induced by non instantaneous injection leads to slower decrease of water level ratio h h 0 in the borehole a detailed comparison of water level curves during the recovery period for different aquifer parameters t and s is presented in fig 5 the curves are dense or very close to each other when both parameters t and s are small e g fig 5 g however they are relatively apart from each other when both parameters t and s are large e g fig 5 c as will be discussed the impact of the non instantaneous injection on the curves is most significant when both parameters t and s of the aquifer are large and the impact becomes small when t and s are small the slower decrease of water level ratio h h 0 in the borehole is confirmed by comparing the hydraulic gradient h h 0 r r r w at the outside wall of the well r r w at the end of the injection time t i the hydraulic gradient in the instantaneous injection case fig 1 a is much larger than that in the non instantaneous injection case fig 1 b then when the water level in the well starts to fall the situation remains the same i e the hydraulic gradient at the wall of the well as shown in fig 6 in the non instantaneous injection case is always larger than that in instantaneous injection case as a result water level in the wellbore in the case of non instantaneous injection falls slower than the case of instantaneous injection this can explain why the water level for the non instantaneous case is always higher than that of the instantaneous case fig 4 the different hydraulic gradient and thus different flow rate from the well to the aquifer between the instantaneous and non instantaneous injection is the major reason for different behaviors in the water level recovery curves based on which the parameters will be estimated 4 3 error analysis for parameter estimation it is expected that the error may be introduced if the cooper et al method or hvorslev method which are based on instantaneous injection is applied to estimate the hydraulic conductivity using the water level recovery data obtained from non instantaneous injection 4 3 1 error analysis of using cooper et al method with reference to the procedures see the end of section 2 1 implementing cooper et al method the monitored water level recovery curve will be used to fit one of the α curves to obtain the value of α first in the falling head test with non instantaneous injection assuming α 1 is the α value estimated by the instantaneous injection method i e cooper et al method for the data from non instantaneous injection α 1 should be erroneous assuming α 2 is the α vale estimated by the non instantaneous injection method for the same data α 2 should be accurate the estimated values of α 1 and α 2 are also shown in fig 7 and they are obtained by fitting the monitored data using non instantaneous method and the cooper et al method respectively if α 2 is greater than α 1 the α value from the cooper et al method is underestimated otherwise the α value is overestimated whether the α value is over or underestimated is determined as follows 1 according to fig 2 the water level recovery curve with smaller α value is always above the water level recovery curve with larger α value i e the water level in the well decrease slower when the α value or storativity s is smaller in the case of instantaneous injection fig 7 as the α 1 curve is above the α 2 curve then α 2 α 1 the same conclusion is true in the case of non instantaneous injection 2 according to fig 4 the water level recovery curve of non instantaneous injection is always above the water level recovery curve of instantaneous injection i e the water level in the well decreases slower in the non instantaneous case than that in the instantaneous case so it follows that the α 1 curve of non instantaneous injection is always higher than the α 1 curve of instantaneous injection in fig 7 the same can be said for α 2 curves in fig 7 3 as α 0 α 1 it can be concluded that using cooper et al method to fit the water level from non instantaneous injection underestimates the value of α thus the storativity s eq 8 furthermore according to fig 5 in the aquifer with smaller t and s the water level recovery curves in the same curve set are denser e g fig 5 g than the curves in the aquifer with bigger t and s e g fig 5 c therefore there is no much difference in the α value for the aquifers of small t and s estimated by the two methods however the error in the estimated α or s will be significant for the aquifers with large t and s using the cooper et al method in fig 8 the error of estimated α or s by cooper et al method is compared among aquifers with different combination of t and s i e t 1 1 0 5 m 2 s and s 1 1 0 2 fig 8 a c t 1 1 0 6 m 2 s and s 1 1 0 3 fig 8 d f and t 1 1 0 7 m 2 s and s 1 1 0 5 fig 8 g i here it is assumed that r c r w so s α as seen from eq 8 in cooper et al method the α value is estimated by fitting the monitored curve solid lines in fig 8 to the type curves dashed lines in fig 8 take fig 8 a c with t 1 1 0 5 m 2 s and s 1 1 0 2 as an example the estimated α values by cooper et al method are all smaller than 1 1 0 2 because the solid lines in the three sub figures are all above the type curves of α 1 1 0 2 this confirms that the α value is underestimated by cooper et al method in the falling head test with non instantaneous injection moreover the water injection time in fig 8 a c with s 1 1 0 2 is 300 s 600 s 1200 s respectively it can be seen that the distance between the monitored water level recovery curves and the type curves of α 1 1 0 2 becomes longer as the water injection time increases specifically according to fig 8 a c the actual α value of the aquifer is about 10 times of the estimated α value for the injection time of 300 s 600 s 1200 s however as seen in fig 8 g i with t 1 1 0 7 m 2 s and s 1 1 0 5 the differences between the type curve of α 1 1 0 5 and the three monitored water level recovery curves for injection time of 300 s 600 s and 1200 s are all negligible therefore when t and s in an aquifer is small e g fig 8 g i the error of the estimated α value is small too as for the error of hydraulic conductivity estimated by cooper et al method the α 1 curve and α 2 curve are both fitted to the same monitored water level recover curve so the point β 1 0 defined in eq 8 in both α 1 and α 2 curves corresponds to the same time t 0 defined in eq 8 in the monitored water level recovery curve in cooper et al method the hydraulic conductivity is estimated by eq 8 with given β 1 0 and the value of t 0 as the value of t 0 are the same in cooper et al method and non instantaneous injection method using cooper et al method to analyze the data from instantaneous injection and non instantaneous injection will lead the same estimated hydraulic conductivity 4 3 2 factors determining the error of using hvorslev method as explained in section 2 2 the hvorslev method is implemented by finding the time t 0 where ln h t h 0 1 i e h t h 0 0 37 in the monitored water level recovery curve according to fig 5 for the non instantaneous cases the time t 0 required to reach ln h t h 0 1 i e h t h 0 0 37 increases comparing with the case of instantaneous injection according to the analytical solution of hvorslev method described by eq 14 the value of t 0 is inversely proportional to the hydraulic conductivity k therefore if the data from the non instantaneous cases are analyzed by the hvorslev method eq 14 the value of t 0 to reach ln h t h 0 1 i e h t h 0 0 37 should be overestimated which leads to the underestimated hydraulic conductivity among the cases of non instantaneous injection with different injection time the injection with longer time will lead to even longer t 0 and then more significant error of the estimation of the hydraulic conductivity the degree of overestimation in t 0 or underestimation in hydraulic conductivity will not increase proportionally with the injection time as seen from the gradually smaller difference among the curves for different injection times referring to the time domain solution to the falling head test of non instantaneous injection eq 31 the term l 1 f r w p determines the difference between the water level recovery curves of instantaneous injection and non instantaneous injection the value of l 1 f r w p is determined by the aquifer parameter t and s and the initial water level mound created by non instantaneous injection as described by g r furthermore the initial water level mound g r is determined by the time duration of water injection t i therefore this difference is determined by the aquifer parameters t and s and the time duration of water injection t i as can be seen from fig 5 the error is more significant when t and s are larger take fig 5 c when t 1 1 0 5 m 2 s and s 1 1 0 2 as an example t 0 for the falling head test with different injection time of 0 instantaneous 300 600 1200 s can be read from the curves see left inset as 9 11 13 15 min respectively the actual hydraulic conductivity is 122 2 11 9 144 4 13 9 167 15 9 of the estimated hydraulic conductivity by the instantaneous injection method when the injection time equal to 300 600 1200 s because the estimated hydraulic conductivity is inversely proportional to t 0 eq 14 however when t and s are small the error will be small too as seen in fig 5 g when t 1 1 0 7 m 2 s and s 1 1 0 5 t 0 for all the curves are very large and the difference among the t 0 values is relatively small thus the error in the hydraulic conductivity estimated from the tests with different injection time is insignificant the above discussion demonstrates that the error in estimated hydraulic conductivity caused by non instantaneous injection depends on the actual aquifer parameters take hong kong as an example the typical shallow soil profile consists of colluvium overlying decomposed igneous rocks with a thickness of 10 to 20 m jiao et al 2006 most piezometers are installed 15 to 20 m below ground surface the typical hydraulic conductivity of the decomposed igneous rocks is around 1 1 0 7 m s geotechnical engineering office 1993 the colluvium has a storativity of 0 05 and decomposed granite has a storativity of 0 001 to 0 03 geotechnical control office 1982 if the average aquifer thickness is assumed to be 10 m then the aquifer parameter t and s will be the values used in fig 5 b and c the actual hydraulic conductivity is 1 22 to 1 67 times of the estimated hydraulic conductivity by analyzing the data from non instantaneous injection by hvorslev method depending on the water injection duration if the water injection time is longer than 1200 s the actual value can be larger than 1 67 times of the estimated value however the aquifer parameters considered in fig 5 g i could be the clay layer therefore the error of estimated hydraulic conductivity in clay layer is insignificant 5 speculation on falling head test in unconfined aquifer in practice falling head tests are widely used in unconfined aquifers and hvorslev method is approximately used to analyze the data the eqs 29 31 are derived for non instantaneous injection in confined aquifers and cannot be used to study the errors introduced by using hvorslev method to analyze the data from falling head test with non instantaneous injection in unconfined aquifers as discussed early when storativity is as large as 1 1 0 2 as the case of fig 5 c the error becomes significant for the falling head test in an unconfined aquifer the storativity will equal the specific yield which is approximated to be the porosity and is of the magnitude of 0 3 it is then expected that this effect alone may lead to a significant error of the estimated hydraulic conductivity in addition to the effect of porosity there are other factors that may lead to errors as can be seen in fig 1 b and c the flow condition around the well in confined and unconfined aquifers is different the cross section through which water flows from the well to the aquifer is fixed in the confined aquifer fig 1 b but the cross section for the unconfined aquifer depends on the water table fig 1 c and will be much larger than the confined aquifer thus in the instantaneous injection case the flow from the well to the unconfined aquifer will be much faster however if a non instantaneous injection is carried out in an unconfined aquifer the flow from the well to the aquifer is slower than the instantaneous case as discussed in section 4 2 therefore comparing to the instantaneous injection case the non instantaneous injection case will have smaller hydraulic gradient at the wall of the well but will have a larger cross section around the well and hence it is difficult to compare the flow from the well to the aquifer qualitatively between instantaneous and non instantaneous cases and so are the errors further study to explore this difference in the unconfined aquifer is deserved in the future 6 field experiment and data analysis 6 1 introduction to the field experiment to validate the previous error analysis and examine the performance of this semi analytical solution on parameter estimation in non instantaneous cases a series of falling head tests are conducted in the piezometer located near the entrance of fung ping shan museum the university of hong kong the piezometer was installed in an unconfined aquifer with a thickness of 20 83 m according to the drill hole record at this site the soil materials in the unconfined aquifer is completely decomposed granite silty sandy gravel gravelly sand the piezometer is 20 50 m deep the well screen and filter pack are installed within 19 20 m to 20 05 m below the ground level the filter material is sand the water table is 5 0 m below the ground surface before the field experiment the detailed piezometer setting are presented in the figure in support information as the diameter of the piezometer is 25 mm which is quite small the instantaneous increase of water level in the wellbore can be achieved by pouring water into the well suddenly thus three scenarios i e three falling head tests with different injection time were conducted and they are a instantaneous injection b constant injection rate 22 96 ml s for 199 s c same constant injection rate 23 13 ml s for 325 s the water was injected by the peristaltic pump the injection rate was measured and adjusted before the implementation of each falling head test to make sure the injection rates are almost the same in the scenarios b and c during the falling head tests the water level in the piezometer was monitored by a pressure transducer every 5 s 6 2 field data analysis it should be noted that the falling head test is conducted in an unconfined aquifer however as shown in the inset of fig 9 the increase of water level in the borehole at the end of injection stage is only 2 4 m which is much smaller than the thickness of the unconfined aquifer and the well screen is 14 2 m below the water table therefore the rise of water table induced by water injection can be ignored and the flow in the unconfined aquifer can be approximated by the flow in a confined aquifer in fig 9 the difference of water level recovery curves between the instantaneous case and non instantaneous cases is obvious the water level recovery curve with injection of 325 s scenario c is above the curve with injection time of 199 s scenario b and the curve from scenario b is above the curve from instantaneous injection scenario a this confirms the conclusion of error analysis shown in fig 5 i e the flow from the well to the aquifer in the non instantaneous injection case is slower than the flow in the instantaneous case and the difference can be more significant when the injection time increases therefore if the cooper et al method is applied for parameter estimation in scenario c the α value or storativity s will be underestimated if the hvorslev method is applied in scenario c the time t 0 required to reach ln h t h 0 1 will increase which leads to the underestimated hydraulic conductivity in fig 10 the monitored data are fitted by cooper et al method and non instantaneous method for the purpose of parameter estimation as presented in table 1 the t estimated by the non instantaneous injection method and cooper et al method in scenarios b and c are almost the same however the estimated storativities varies among different methods and scenarios the storativities estimated by cooper et al method are different between scenarios b and c and it increases with the injection time moreover the storativities estimated by cooper et al method is smaller than that estimated by non instantaneous method therefore the parameter estimation further illustrates the error of analyzing data from non instantaneous injection by cooper et al method i e storativity s will be underestimated and hydraulic is not influenced meanwhile the water level at the injection stage is required to be fitted when using the non instantaneous injection method to analyze the data from non instantaneous injection as shown in fig 11 this is because the flow rate from the well to the aquifer is determined by the water level mound near the well induced by non instantaneous injection 7 conclusion this study develops a mathematical model for the falling head test with non instantaneous injection to describe the water level recovery process in the wellbore and the spatial distribution of water level in the aquifer this model consists of two stages i e the injection stage and the water level recovery stage the analytical solution of water level at the injection stage was obtained in previous studies and is applied to determine the initial water level distribution of the water level recovery stage the analytical solution of water level in the laplace space at the recovery stage is obtained in this study and the time domain solution is acquired by numerical inversion of laplace transform then the time domain solution is employed to explore the influences of non instantaneous injection on the water level distribution and parameter estimation based on the time domain solution and error analysis it is found that the water level mound induced by non instantaneous injection results in the higher water level near the well moreover because the hydraulic gradient in this case is smaller the flow to the aquifer is slower than the flow in the instantaneous injection case then if cooper et al method is used to fit the data from non instantaneous injection storativity is underestimated but there is no impact on the estimation of hydraulic conductivity if hvorslev method is used the hydraulic conductivity is underestimated both the errors of storativity estimated by cooper et al method and hydraulic conductivity estimated by hvorslev method increase with the injection time duration and the aquifer parameters such as hydraulic conductivity and storativity the error can be a few times bigger than the actual value for the aquifer parameters and injection time used in the discussion this study further speculated the error of hydraulic conductivity estimated from a falling head test conducted in an unconfined aquifer with non instantaneous injection by treating the aquifer as confined and using hvorslev method to analyze the data the specific yield may lead to a significant error but the flow from the well to the aquifer between the instantaneous and non instantaneous cases cannot be compared based on the solution derived in this study due to the smaller hydraulic gradient but larger cross section around the well therefore further study is deserved to explore the influence of non instantaneous injection on the parameter estimation based on the falling head test in unconfined aquifer finally the present solution shows a good fit with the monitored data from the field experiment conducted in this study the errors of the estimated parameters based on the field data are consistent with the conclusions in the error analysis section credit authorship contribution statement rong mao methodology formal analysis field investigation writing original draft jiu jimmy jiao conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by rae improvement fund of the faculty of science the university of hong kong and rae2026 preparation urc supplementary funding for faculties units of assessment the derivation of the analytical solution is presented in the support information appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j jhydrol 2022 128834 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
2634,a falling head test is a common method to estimate aquifer properties in which the water level in a well is increased suddenly which is a key assumption for the data to be analyzed by traditional methods such as cooper et al and hvorslev methods however there are situations where the water level increases in the well occurs for a relatively long period before it falls in this case theoretically there is no existing method to analyze the data hydrogeologists or geotechnical engineers still use the traditional methods to analyze the data even the water level increase is not instantaneous this study derives a semi analytical solution to describe water level change in this case the mathematical model consists of the injection stage and water level fall stage it is found that the water level mound induced by non instantaneous injection leads to slower decrease of water level in the well comparing to the instantaneous injection this study further analyses the errors of the estimated hydraulic properties if the data are analyzed by traditional methods if calculated by cooper et al method the storativity is underestimated but there is no impact on estimated hydraulic conductivity the hydraulic conductivity calculated by hvorslev method is underestimated and the error of underestimation increases with injection time and aquifer parameters the actual hydraulic conductivity can be a few times of the estimated value for typical aquifer parameters in hong kong furthermore a field experiment is conducted to compare the instantaneous method non instantaneous method and field data the present solution fits the data well and the errors of estimated parameters by instantaneous injection method are consistent with the conclusions in the error analysis keywords falling head test non instantaneous injection semi analytical solution error of cooper et al method error of hvorslev method data availability data will be made available on request 1 introduction in groundwater investigations the aquifer hydraulic properties are key properties to be determined various experiments were developed to estimate these properties among these experiments the single well variable head test known as slug test rising or falling head test is one of the most popular in situ methods the slug test involves instantaneously adding water to or taking it from a well or dropping a slug of known volume into or take it out from the well for most of the piezometers or standpipes for geotechnical engineering purposes the diameter of the well may be too small to allow taking water out of it or dropping a slug into it for example the typical diameter of a piezometer in the united britain and hong kong for geotechnical purposes is only 19 or 25 mm so adding water to conduct a falling head test is the most common slug test in this study the falling head test is mainly discussed without loss of generality to date the theories to analyze the data obtained by slug test under various hydrogeological conditions have been well developed and summarized by butler 1998 for example the cooper et al method cooper et al 1967 and hvorslev method hvorslev 1951 were introduced to analyze the falling head test data in confined aquifers with the cases of fully and partially penetrating wells the bouwer and rice method bouwer and rice 1976 and the dagan method dagan 1978 were introduced to analyze falling head test data in unconfined aquifers with the cases of wells screened below and across the water table for the falling head test in confined aquifers the hvorslev method can only estimate the hydraulic conductivity the cooper et al methods can estimate both hydraulic conductivity and storativity after a falling head test is conducted hydrogeologists use the methods to interpret the data that can estimate both hydraulic conductivity and storativity but geotechnical engineers prefer to use hvorslev method to analyze the data because they are usually only interested in estimating hydraulic conductivity which is sufficient for various geotechnical purposes such as foundation design and slope stability analysis due to the simplicity of data interpretation by hvorslev method the falling head tests have been widely practiced in the geotechnical engineering in many countries or regions such as britain india malaysia and hong kong british geotechnical society 1974 geological investigations and subsurface exploration sectional committee india 1985 geotechnical control office 1987 according to the procedures of the implementation of the falling head test water is injected to the well to raise the water level to a certain value instantaneously in hong kong the water level in the piezometer is required to be raised to a minimum of 3 m cedd 2006 in india the code of practice specified that water level is raised to the top of the well geological investigations and subsurface exploration sectional committee india 1985 the minimum requirement of initial water column height of 3 m is to ensure that sufficient manual measurements of water level can be taken otherwise the time duration for the water level to fall to the initial water level will be very short and only few water level data points can be measured manually which may not be sufficient to produce a reliable water level curve geotechnical control office 1987 although the theoretical requirement using all the data interpretation methods mentioned early is that the water level in the well should be increased instantaneously most geotechnical engineers overlooked this requirement very often fill the water to the top of the well and may leave it for a while there are also situations when imposing instantaneous change of water level is unrealistic for example if the diameter of the well is large or the response zone of the well is long or the aquifer is very permeable it is difficult to ensure enough water level increase without keeping injection of water ding 2006 the common practice by geotechnical engineers is that they obtain the data without creating water level rise instantaneously but then use the analytical equations that are based the assumption of instantaneous injection to deal with the data it is expected that such a practice may lead to errors in estimated parameters but so far there is no study about that analytical studies of falling head tests in confined aquifers with non instantaneous injection of water are carried out in this study theoretically the falling head test with non instantaneous injection can be divided into two stages i e the injection stage and the water level recovery stage the injection stage is quantified by the analytical solution of the response of water level in a finite diameter well to the non instantaneous water injection and this solution has been obtained by papadopulos and cooper jr 1967 and the water level recovery stage is quantified by the analytical model of falling head test with non zero initial water level condition in the aquifer which will be solved in this study then the influence of injection stage on the water level distribution is explored and the error of hydraulic conductivity estimated by the cooper et al method and hvorslev method is analyzed by comparing the hydraulic conductivities estimated by these traditional solutions and the solution derived in this study 2 the instantaneous injection methods prior to introducing the analytical model of falling head test of non instantaneous injection the instantaneous injection methods in confined aquifers are reviewed in this section in a confined aquifer with fully penetrating well and instantaneous injection the cooper et al method and hvorslev method are the major methods for the estimation of hydraulic conductivity fig 1 depicts the general setting of the falling head test and identifies the difference of initial water level distribution between the falling head tests of instantaneous injection fig 1 a and non instantaneous injection fig 1 b 2 1 the cooper et al method the mathematical model of cooper et al method cooper et al 1967 is defined as follows 1 2 h r 2 1 r h r s t h t 2 h t 0 t 0 3 2 π r w t h r t r r r w π r c 2 h t t t 0 4 h r w t h t t 0 5 h r 0 0 r w r 6 h t 0 h 0 where h is the deviation of hydraulic head or water level in the aquifer from static condition s is the coefficient of storage i e storativity b is the aquifer thickness t is the transmissibility of the aquifer t k b k is the hydraulic conductivity r is the radial distance r w is the radius of well screen r c is the radius of well casing h t is the monitored water level in the borehole the mathematical model eqs 1 6 is based on the assumptions of a homogeneous aquifer darcy flow and instantaneous water injection the analytical solution of the mathematical model eqs 1 6 was provided by cooper et al 7 h r t h 0 f α β where 8 α r w 2 r c 2 s β t t r c 2 and f α β is the curve determined by α β and t the mathematical expression of f α β is 9 f α β 2 π 0 e β u 2 α j 0 u r r w u y 0 u 2 α y 1 u y 0 u r r w u j 0 u 2 α j 1 u d u δ u where δ u is 10 δ u u j 0 u 2 α j 1 u 2 u y 0 u 2 α y 1 u 2 from eqs 7 10 the water level recovery curve the well is obtained 11 h t h 0 8 α π 2 0 e β u 2 α d u u 2 δ u the analytical solution eq 11 can be plotted as a series of h t h 0 vs β curves as shown in fig 2 with each curve corresponding to a certain value of α in this figure h h 0 or normalized water level is used normalized water level is used in most of the figures and discussions for the convenience of discussion the word normalized is omitted the cooper et al method is implemented by fitting one of the α curves to the monitored water level recovery curve so the storativity can be calculated based on the definition of α eq 8 and then reading the real time t from the curve at β 1 0 so the transmissibility t of the aquifer is calculated from eq 8 2 2 hvorslev method hvorslev method as an alternative method for the analysis of falling head test data with instantaneous injection involves two different assumptions compared to cooper et al method 1 the elastic storage is ignored in hvorslev method 2 the lateral boundary of the hvorslev method is at finite distance but that of cooper et al method is at infinite distance therefore eqs 1 and 2 are modified as follows in hvorslev method 12 2 h r 2 1 r h r 0 13 h r e t 0 t 0 where r e is the effective radius of the falling head test the analytical solution to the mathematical model defined by hvorslev method is 14 ln h t h 0 f k π r c 2 t where f is the shape factor of the well defined as 15 f 2 π b ln r e r s the hvorslev method is implemented by finding the time t 0 where ln h h 0 1 i e h h 0 0 37 in the water level recovery curve although the assumptions of the cooper et al method and hvorslev method are different chirlin 1989 proved that the estimated hydraulic conductivity by the two methods can be very similar by choosing appropriate value of effective radius r e in hvorslev method 3 non instantaneous injection method in the instantaneous injection model of the falling head test at t 0 there is sharp change in the water level 0 in the aquifer and h 0 in the wellbore fig 1 a however for the falling head test of non instantaneous injection water is injected to the borehole gradually for a certain time period before the water level in the borehole reaches h 0 and a water level mound is formed around the well fig 1 b this water level mound at the end of injection will be initial water level at the recovery stage when injection ceases the mathematical model for the falling head test with non instantaneous injection is developed to describe the water level change during the recovery period the non instantaneous injection model consists of two stages the injection stage and the water level recovery stage the semi analytical solution of water level in the recovery period is derived this solution together with the existing solution in the injection stage is used to discuss the impact of the non instantaneous injection on the water level and parameter estimation 3 1 the injection stage of the falling head test with non instantaneous injection the mathematical model of the injection stage has already been developed by papadopulos and cooper jr 1967 16 2 h r 2 1 r h r s t h t r r w 17 h t 0 t 0 18 2 π r w t h r t r r r w π r c 2 h t t q t 0 19 h r 0 0 r w r where q is the injection rate eq 18 describes that the injection rate to the borehole is equal to the sum of the rate of water flowing from the well to the aquifer and the rate of water volume increase in the borehole the meanings of other equations are straightforward the analytical solution of eqs 16 19 papadopulos and cooper jr 1967 is 20 h r t 2 q α π 2 t 0 1 e β u 2 α j 0 u r r w u y 0 u 2 α y 1 u y 0 u r r w u j 0 u 2 α j 1 u d u u 2 δ u eq 20 quantifies the water level in both the aquifer and the well during the injection stage and provides the initial condition of the water level in the aquifer at the recovery stage 3 2 water level recovery stage of the falling head test with non instantaneous injection after a certain time of injection the water level in the aquifer will be higher than the initial static water level fig 1 b which can be calculated by eq 20 using the water level after non instantaneous as the initial water level the mathematical model of the water level in the recovery stage can be written as 21 2 h r 2 1 r h r s t h t r r w 22 h t 0 t 0 23 2 π r w t h r t r r r w π r c 2 h t t 0 t 0 24 h r 0 g r r w r eq 23 means the decreasing rate of the volume of water in the borehole equals the water flow rate from the borehole to the aquifer eq 24 is the initial water level g r is the hydraulic head distribution at the end of injection time t i and is calculated by eq 20 i e g r h r t i specifically the initial water level in the borehole at the water level recovery stage is given by h 0 g r w by applying the laplace transform with respect to time to eqs 21 23 and using the initial condition defined by eq 24 the analytical solution of the mathematical model defined by eqs 21 24 in the laplace space is 25 h ˆ r p h ˆ 1 r p f r w p r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r h ˆ r p where p is the complex number in laplace space q p s t k 0 q r k 0 q r w and k 1 q r w are the second kind modified bessel functions the derivation of the analytical solution is presented in the support information eq 25 shows that the analytical solution in laplace space is the summation of three terms the first term h ˆ 1 r p is equal to the analytical solution of the mathematical model defined by cooper et al method in laplace space 26 h ˆ 1 r p r c 2 h 0 r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r the second and third terms in eq 25 are the terms quantifying the influence of initial condition g r on the analytical solution in laplace space f r w p and h ˆ r p in eq 25 are calculated as follows 27 f r w p r c 2 i 0 q r w 2 r w t q i 1 q r w r w r 0 g r 0 s t k 0 q r 0 d r 0 28 h ˆ r p k 0 q r r w r r 0 s t g r 0 i 0 q r 0 d r 0 i 0 q r r r 0 s t g r 0 k 0 q r 0 d r 0 where i 0 q r 0 and i 0 q r are the first kind modified bessel functions then the inverse transform of eq 25 yields the analytical solution of eqs 21 24 29 h r t h 0 f α β l 1 f r p where f α β is defined by eq 8 l 1 represents the inverse laplace transform the term f r p in eq 29 is the summation of the second and third terms defined in eq 25 that is 30 f r p f r w p r c 2 p k 0 q r w 2 r w t q k 1 q r w k 0 q r h ˆ r p according to eq 29 the analytical solution is the summation of two terms the first term h 0 f α β is the result of inverse laplace transform of eq 26 and is the analytical solution of mathematical model defined in cooper et al method h 0 f α β can also be regarded as the analytical solution of eqs 21 23 with static water level distribution i e g r 0 the second term l 1 f r p quantifies the influence of initial water level distribution g r on the water level distribution at the second stage therefore the second term in eq 30 determines the difference of water level distribution in the aquifer between the falling head test with instantaneous injection and with non instantaneous injection moreover the term l 1 f r p includes the inverse laplace transform of complex integrals of bessel functions and non linear initial water level distribution g r so it is difficult to find the analytical form of l 1 f r p using the traditional contour integration method then the calculation of the term l 1 f r p is conducted by numerical inversion of laplace transform method de hoog et al 1982 specifically by setting r r w in the analytical solution eq 20 the water level recovery curve in the borehole is obtained 31 h r w t 8 h 0 α π 2 0 e β u 2 α d u u 2 δ u l 1 f r w p as is shown in eq 31 the time domain solution to the equation of falling head test with non instantaneous injection is the summation of two terms the first term is the water level recovery curve of the falling head test with instantaneous injection eq 11 the second term determines the difference between the water level recovery curve of the falling head test with non instantaneous injection and with instantaneous injection the difference will be discussed in the following section in detail as the term l 1 f r w p is calculated by numerical inversion of laplace transform the time domain solution is the semi analytical solution of the mathematical model defined by eqs 21 24 the solution expressed by eq 31 is also examined by solving the governing equations eqs 21 24 numerically which is presented in support information 4 comparison of models given the time domain solution of the falling head test with non instantaneous injection eq 29 the influences of non instantaneous injection on the water level recovery curve and the water level distribution in the aquifer can be explored quantitatively the error of hydraulic conductivity estimated by cooper et al method or hvorslev method from the falling head test of non instantaneous injection can also be quantified 4 1 comparison of water level distributions in the aquifer the influence of non instantaneous injection on the water level distribution in the aquifer is analyzed by comparing the difference of water level distribution between the non instantaneous and the instantaneous injection models the difference is determined by the term of l 1 f r p in eq 29 if l 1 f r p is negative the water level in the non instantaneous model is lower than the instantaneous model otherwise the water level in the former is higher than the latter fig 3 presents the comparison of water level distributions in the aquifer between instantaneous and non instantaneous injection the injection rate is set to be q 2 1 0 4 m 3 s and injection time is 5 min the well configurations are r w 0 06 m r c 0 06 m the aquifer parameters are t 1 1 0 5 m 2 s s 0 01 for instantaneous injection the water level rises from initial water level of 0 while for non instantaneous injection the water level falls from its initial water level as time increases the water level near the well in the non instantaneous case is always higher than that in the instantaneous case it can be concluded that the water level mound induced by the non instantaneous case results in higher water level at the recovery stage than that in the instantaneous case which is expected to influence the water level recovery rate in the well 4 2 comparison of water level recovery curves in the well the influence of non instantaneous injection on the water level recovery curve in the well is analyzed by comparing the difference of water level recovery curves between the non instantaneous and instantaneous cases referring to eq 31 the term l 1 f r p determines the difference of the water level recovery curve in the well the water level in the well in the non instantaneous case is lower or higher than the instantaneous case depending on if l 1 f r p is negative or positive fig 4 compares the water level recovery curves in the well for the non instantaneous case with the same injection rate but different injection time which leads to different h 0 the water level in the well in all the non instantaneous cases are always higher than those in the instantaneous case therefore the water level mound induced by non instantaneous injection leads to slower decrease of water level ratio h h 0 in the borehole a detailed comparison of water level curves during the recovery period for different aquifer parameters t and s is presented in fig 5 the curves are dense or very close to each other when both parameters t and s are small e g fig 5 g however they are relatively apart from each other when both parameters t and s are large e g fig 5 c as will be discussed the impact of the non instantaneous injection on the curves is most significant when both parameters t and s of the aquifer are large and the impact becomes small when t and s are small the slower decrease of water level ratio h h 0 in the borehole is confirmed by comparing the hydraulic gradient h h 0 r r r w at the outside wall of the well r r w at the end of the injection time t i the hydraulic gradient in the instantaneous injection case fig 1 a is much larger than that in the non instantaneous injection case fig 1 b then when the water level in the well starts to fall the situation remains the same i e the hydraulic gradient at the wall of the well as shown in fig 6 in the non instantaneous injection case is always larger than that in instantaneous injection case as a result water level in the wellbore in the case of non instantaneous injection falls slower than the case of instantaneous injection this can explain why the water level for the non instantaneous case is always higher than that of the instantaneous case fig 4 the different hydraulic gradient and thus different flow rate from the well to the aquifer between the instantaneous and non instantaneous injection is the major reason for different behaviors in the water level recovery curves based on which the parameters will be estimated 4 3 error analysis for parameter estimation it is expected that the error may be introduced if the cooper et al method or hvorslev method which are based on instantaneous injection is applied to estimate the hydraulic conductivity using the water level recovery data obtained from non instantaneous injection 4 3 1 error analysis of using cooper et al method with reference to the procedures see the end of section 2 1 implementing cooper et al method the monitored water level recovery curve will be used to fit one of the α curves to obtain the value of α first in the falling head test with non instantaneous injection assuming α 1 is the α value estimated by the instantaneous injection method i e cooper et al method for the data from non instantaneous injection α 1 should be erroneous assuming α 2 is the α vale estimated by the non instantaneous injection method for the same data α 2 should be accurate the estimated values of α 1 and α 2 are also shown in fig 7 and they are obtained by fitting the monitored data using non instantaneous method and the cooper et al method respectively if α 2 is greater than α 1 the α value from the cooper et al method is underestimated otherwise the α value is overestimated whether the α value is over or underestimated is determined as follows 1 according to fig 2 the water level recovery curve with smaller α value is always above the water level recovery curve with larger α value i e the water level in the well decrease slower when the α value or storativity s is smaller in the case of instantaneous injection fig 7 as the α 1 curve is above the α 2 curve then α 2 α 1 the same conclusion is true in the case of non instantaneous injection 2 according to fig 4 the water level recovery curve of non instantaneous injection is always above the water level recovery curve of instantaneous injection i e the water level in the well decreases slower in the non instantaneous case than that in the instantaneous case so it follows that the α 1 curve of non instantaneous injection is always higher than the α 1 curve of instantaneous injection in fig 7 the same can be said for α 2 curves in fig 7 3 as α 0 α 1 it can be concluded that using cooper et al method to fit the water level from non instantaneous injection underestimates the value of α thus the storativity s eq 8 furthermore according to fig 5 in the aquifer with smaller t and s the water level recovery curves in the same curve set are denser e g fig 5 g than the curves in the aquifer with bigger t and s e g fig 5 c therefore there is no much difference in the α value for the aquifers of small t and s estimated by the two methods however the error in the estimated α or s will be significant for the aquifers with large t and s using the cooper et al method in fig 8 the error of estimated α or s by cooper et al method is compared among aquifers with different combination of t and s i e t 1 1 0 5 m 2 s and s 1 1 0 2 fig 8 a c t 1 1 0 6 m 2 s and s 1 1 0 3 fig 8 d f and t 1 1 0 7 m 2 s and s 1 1 0 5 fig 8 g i here it is assumed that r c r w so s α as seen from eq 8 in cooper et al method the α value is estimated by fitting the monitored curve solid lines in fig 8 to the type curves dashed lines in fig 8 take fig 8 a c with t 1 1 0 5 m 2 s and s 1 1 0 2 as an example the estimated α values by cooper et al method are all smaller than 1 1 0 2 because the solid lines in the three sub figures are all above the type curves of α 1 1 0 2 this confirms that the α value is underestimated by cooper et al method in the falling head test with non instantaneous injection moreover the water injection time in fig 8 a c with s 1 1 0 2 is 300 s 600 s 1200 s respectively it can be seen that the distance between the monitored water level recovery curves and the type curves of α 1 1 0 2 becomes longer as the water injection time increases specifically according to fig 8 a c the actual α value of the aquifer is about 10 times of the estimated α value for the injection time of 300 s 600 s 1200 s however as seen in fig 8 g i with t 1 1 0 7 m 2 s and s 1 1 0 5 the differences between the type curve of α 1 1 0 5 and the three monitored water level recovery curves for injection time of 300 s 600 s and 1200 s are all negligible therefore when t and s in an aquifer is small e g fig 8 g i the error of the estimated α value is small too as for the error of hydraulic conductivity estimated by cooper et al method the α 1 curve and α 2 curve are both fitted to the same monitored water level recover curve so the point β 1 0 defined in eq 8 in both α 1 and α 2 curves corresponds to the same time t 0 defined in eq 8 in the monitored water level recovery curve in cooper et al method the hydraulic conductivity is estimated by eq 8 with given β 1 0 and the value of t 0 as the value of t 0 are the same in cooper et al method and non instantaneous injection method using cooper et al method to analyze the data from instantaneous injection and non instantaneous injection will lead the same estimated hydraulic conductivity 4 3 2 factors determining the error of using hvorslev method as explained in section 2 2 the hvorslev method is implemented by finding the time t 0 where ln h t h 0 1 i e h t h 0 0 37 in the monitored water level recovery curve according to fig 5 for the non instantaneous cases the time t 0 required to reach ln h t h 0 1 i e h t h 0 0 37 increases comparing with the case of instantaneous injection according to the analytical solution of hvorslev method described by eq 14 the value of t 0 is inversely proportional to the hydraulic conductivity k therefore if the data from the non instantaneous cases are analyzed by the hvorslev method eq 14 the value of t 0 to reach ln h t h 0 1 i e h t h 0 0 37 should be overestimated which leads to the underestimated hydraulic conductivity among the cases of non instantaneous injection with different injection time the injection with longer time will lead to even longer t 0 and then more significant error of the estimation of the hydraulic conductivity the degree of overestimation in t 0 or underestimation in hydraulic conductivity will not increase proportionally with the injection time as seen from the gradually smaller difference among the curves for different injection times referring to the time domain solution to the falling head test of non instantaneous injection eq 31 the term l 1 f r w p determines the difference between the water level recovery curves of instantaneous injection and non instantaneous injection the value of l 1 f r w p is determined by the aquifer parameter t and s and the initial water level mound created by non instantaneous injection as described by g r furthermore the initial water level mound g r is determined by the time duration of water injection t i therefore this difference is determined by the aquifer parameters t and s and the time duration of water injection t i as can be seen from fig 5 the error is more significant when t and s are larger take fig 5 c when t 1 1 0 5 m 2 s and s 1 1 0 2 as an example t 0 for the falling head test with different injection time of 0 instantaneous 300 600 1200 s can be read from the curves see left inset as 9 11 13 15 min respectively the actual hydraulic conductivity is 122 2 11 9 144 4 13 9 167 15 9 of the estimated hydraulic conductivity by the instantaneous injection method when the injection time equal to 300 600 1200 s because the estimated hydraulic conductivity is inversely proportional to t 0 eq 14 however when t and s are small the error will be small too as seen in fig 5 g when t 1 1 0 7 m 2 s and s 1 1 0 5 t 0 for all the curves are very large and the difference among the t 0 values is relatively small thus the error in the hydraulic conductivity estimated from the tests with different injection time is insignificant the above discussion demonstrates that the error in estimated hydraulic conductivity caused by non instantaneous injection depends on the actual aquifer parameters take hong kong as an example the typical shallow soil profile consists of colluvium overlying decomposed igneous rocks with a thickness of 10 to 20 m jiao et al 2006 most piezometers are installed 15 to 20 m below ground surface the typical hydraulic conductivity of the decomposed igneous rocks is around 1 1 0 7 m s geotechnical engineering office 1993 the colluvium has a storativity of 0 05 and decomposed granite has a storativity of 0 001 to 0 03 geotechnical control office 1982 if the average aquifer thickness is assumed to be 10 m then the aquifer parameter t and s will be the values used in fig 5 b and c the actual hydraulic conductivity is 1 22 to 1 67 times of the estimated hydraulic conductivity by analyzing the data from non instantaneous injection by hvorslev method depending on the water injection duration if the water injection time is longer than 1200 s the actual value can be larger than 1 67 times of the estimated value however the aquifer parameters considered in fig 5 g i could be the clay layer therefore the error of estimated hydraulic conductivity in clay layer is insignificant 5 speculation on falling head test in unconfined aquifer in practice falling head tests are widely used in unconfined aquifers and hvorslev method is approximately used to analyze the data the eqs 29 31 are derived for non instantaneous injection in confined aquifers and cannot be used to study the errors introduced by using hvorslev method to analyze the data from falling head test with non instantaneous injection in unconfined aquifers as discussed early when storativity is as large as 1 1 0 2 as the case of fig 5 c the error becomes significant for the falling head test in an unconfined aquifer the storativity will equal the specific yield which is approximated to be the porosity and is of the magnitude of 0 3 it is then expected that this effect alone may lead to a significant error of the estimated hydraulic conductivity in addition to the effect of porosity there are other factors that may lead to errors as can be seen in fig 1 b and c the flow condition around the well in confined and unconfined aquifers is different the cross section through which water flows from the well to the aquifer is fixed in the confined aquifer fig 1 b but the cross section for the unconfined aquifer depends on the water table fig 1 c and will be much larger than the confined aquifer thus in the instantaneous injection case the flow from the well to the unconfined aquifer will be much faster however if a non instantaneous injection is carried out in an unconfined aquifer the flow from the well to the aquifer is slower than the instantaneous case as discussed in section 4 2 therefore comparing to the instantaneous injection case the non instantaneous injection case will have smaller hydraulic gradient at the wall of the well but will have a larger cross section around the well and hence it is difficult to compare the flow from the well to the aquifer qualitatively between instantaneous and non instantaneous cases and so are the errors further study to explore this difference in the unconfined aquifer is deserved in the future 6 field experiment and data analysis 6 1 introduction to the field experiment to validate the previous error analysis and examine the performance of this semi analytical solution on parameter estimation in non instantaneous cases a series of falling head tests are conducted in the piezometer located near the entrance of fung ping shan museum the university of hong kong the piezometer was installed in an unconfined aquifer with a thickness of 20 83 m according to the drill hole record at this site the soil materials in the unconfined aquifer is completely decomposed granite silty sandy gravel gravelly sand the piezometer is 20 50 m deep the well screen and filter pack are installed within 19 20 m to 20 05 m below the ground level the filter material is sand the water table is 5 0 m below the ground surface before the field experiment the detailed piezometer setting are presented in the figure in support information as the diameter of the piezometer is 25 mm which is quite small the instantaneous increase of water level in the wellbore can be achieved by pouring water into the well suddenly thus three scenarios i e three falling head tests with different injection time were conducted and they are a instantaneous injection b constant injection rate 22 96 ml s for 199 s c same constant injection rate 23 13 ml s for 325 s the water was injected by the peristaltic pump the injection rate was measured and adjusted before the implementation of each falling head test to make sure the injection rates are almost the same in the scenarios b and c during the falling head tests the water level in the piezometer was monitored by a pressure transducer every 5 s 6 2 field data analysis it should be noted that the falling head test is conducted in an unconfined aquifer however as shown in the inset of fig 9 the increase of water level in the borehole at the end of injection stage is only 2 4 m which is much smaller than the thickness of the unconfined aquifer and the well screen is 14 2 m below the water table therefore the rise of water table induced by water injection can be ignored and the flow in the unconfined aquifer can be approximated by the flow in a confined aquifer in fig 9 the difference of water level recovery curves between the instantaneous case and non instantaneous cases is obvious the water level recovery curve with injection of 325 s scenario c is above the curve with injection time of 199 s scenario b and the curve from scenario b is above the curve from instantaneous injection scenario a this confirms the conclusion of error analysis shown in fig 5 i e the flow from the well to the aquifer in the non instantaneous injection case is slower than the flow in the instantaneous case and the difference can be more significant when the injection time increases therefore if the cooper et al method is applied for parameter estimation in scenario c the α value or storativity s will be underestimated if the hvorslev method is applied in scenario c the time t 0 required to reach ln h t h 0 1 will increase which leads to the underestimated hydraulic conductivity in fig 10 the monitored data are fitted by cooper et al method and non instantaneous method for the purpose of parameter estimation as presented in table 1 the t estimated by the non instantaneous injection method and cooper et al method in scenarios b and c are almost the same however the estimated storativities varies among different methods and scenarios the storativities estimated by cooper et al method are different between scenarios b and c and it increases with the injection time moreover the storativities estimated by cooper et al method is smaller than that estimated by non instantaneous method therefore the parameter estimation further illustrates the error of analyzing data from non instantaneous injection by cooper et al method i e storativity s will be underestimated and hydraulic is not influenced meanwhile the water level at the injection stage is required to be fitted when using the non instantaneous injection method to analyze the data from non instantaneous injection as shown in fig 11 this is because the flow rate from the well to the aquifer is determined by the water level mound near the well induced by non instantaneous injection 7 conclusion this study develops a mathematical model for the falling head test with non instantaneous injection to describe the water level recovery process in the wellbore and the spatial distribution of water level in the aquifer this model consists of two stages i e the injection stage and the water level recovery stage the analytical solution of water level at the injection stage was obtained in previous studies and is applied to determine the initial water level distribution of the water level recovery stage the analytical solution of water level in the laplace space at the recovery stage is obtained in this study and the time domain solution is acquired by numerical inversion of laplace transform then the time domain solution is employed to explore the influences of non instantaneous injection on the water level distribution and parameter estimation based on the time domain solution and error analysis it is found that the water level mound induced by non instantaneous injection results in the higher water level near the well moreover because the hydraulic gradient in this case is smaller the flow to the aquifer is slower than the flow in the instantaneous injection case then if cooper et al method is used to fit the data from non instantaneous injection storativity is underestimated but there is no impact on the estimation of hydraulic conductivity if hvorslev method is used the hydraulic conductivity is underestimated both the errors of storativity estimated by cooper et al method and hydraulic conductivity estimated by hvorslev method increase with the injection time duration and the aquifer parameters such as hydraulic conductivity and storativity the error can be a few times bigger than the actual value for the aquifer parameters and injection time used in the discussion this study further speculated the error of hydraulic conductivity estimated from a falling head test conducted in an unconfined aquifer with non instantaneous injection by treating the aquifer as confined and using hvorslev method to analyze the data the specific yield may lead to a significant error but the flow from the well to the aquifer between the instantaneous and non instantaneous cases cannot be compared based on the solution derived in this study due to the smaller hydraulic gradient but larger cross section around the well therefore further study is deserved to explore the influence of non instantaneous injection on the parameter estimation based on the falling head test in unconfined aquifer finally the present solution shows a good fit with the monitored data from the field experiment conducted in this study the errors of the estimated parameters based on the field data are consistent with the conclusions in the error analysis section credit authorship contribution statement rong mao methodology formal analysis field investigation writing original draft jiu jimmy jiao conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by rae improvement fund of the faculty of science the university of hong kong and rae2026 preparation urc supplementary funding for faculties units of assessment the derivation of the analytical solution is presented in the support information appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j jhydrol 2022 128834 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
