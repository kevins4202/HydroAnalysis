index,text
145,darcian 2 d flows to subterranean holes are studied analytically by the methods of complex analysis and numerically by hydrus for flow towards two circular or quasi circular tunnels reconstructed as isobars generated by two sinks under a ponded homogeneous soil surface the flow nets the velocity vector fields and riesenkampf s seepage force vectors are found the position of the two tunnels is optimized using a criterion of the total area of the empty space comprised by the isobars with the admissible seepage flow rate as a constraint and the locus of the tunnels as a control variable the case of a partially filled tunnel the contour of which is composed of two conterminous isobaric and equipotential arcs is also analyzed for a grouted tunnel the refraction problem for two potential fields in two subdomains of the half plane of the seepage flow domain is solved for an arbitrary contrast between the hydraulic conductivities of the liner and ambient soil the tunnel grouting is generally eccentric with respect to the tunnel contour high hydraulic gradients in the grouting are detected which is a long term seepage harbinger for any liner materials used by geotechnical engineers keywords subterranean holes complex potential darcian velocity isobars seepage force hydrus modeling list of abbreviations and notations symbol description unit pk 62 77 polubarinova kochina 1962 theory of ground water movement vg van genuchten η ponded water depth m θ volumetric soil water content θr residual water content θs saturated water content porosity k kg saturated hydraulic conductivities m day n α vg soil parameters m 1 p pressure head m h total piezometric head p y in analytical and p z in hydrus models m t time day x y cartesian coordinates in analytical solutions m x z cartesian coordinates in hydrus m v specific discharge darcian velocity m day q1 q2 intensities of sinks seepage flow rates of tunnels m2 day d dc depth of the sink and centre of circular tunnel under the ponded soil surface m w ϕ iψ z x iy complex potential complex physical plane varaibles in analytical solutions m2 day m ϕ ψ velocity potential and stream function m2 day r radius of circular tunnel m 1 introduction subterranean openings as man made structures appeared at the dawn of human civilizations viz holes quasi cylindrical in shape and about 2 1 m in sizes into which coffins christian or wrapped dead bodies islam are placed and backfilled at a depth of 1 2 m from the ground surface of cemeteries metro highway sewage network tunnels at depths of 100 101 m horizontal wells in particular qanat falaj in oman tunnels tapping unconfined alluvium aquifers at depths of 101 102 m repositories of nuclear waste in deep rock at depths of 102 103 m civil defense bunkers of wwi wwii in the urban infrastructure at depths of 100 101 m among others these openings hereafter called tunnels are of a regular shape and well known loci orientation with respect to the vector g of gravitational acceleration natural uncontrolled subsurface openings intersperse the soil and rock continuum large gardens and crop fields areas have an intricate network of holes made by subterranean mammals e g shrewmice pocket gophers moles opossums voles and raccoons 10 1 100 m holes made by social insects in their nests and adjacent soils 10 3 10 2 m wild desert trees and shrubs generate multiple holes made by plants roots which in arid deserts can span 60 70 m deep catacombs of karst caves and cavities among others these holes unlike engineered entities are irregular in their location and orientation see e g photos in the chapter tunnel erosion in zhu and xu 2021 all types of the abovementioned openings hereafter called tunnels are subject to seepage of ambient pore water which commonly percolates down the soil water interacting with the tunnels can originate from rainfall irrigation and ponding of the ground surface by flash floods among others moreover some tunnels are often purposely constructed deep in the beds of shallow lakes lagoons or even seafloors e g for masking the icbm structure or storing nuclear wastes e g the swedish final repository near forsmark 60 m deep under the floor of the baltic sea seepage flows into tunnels and in their vicinity is a crucial phenomenon determining their very sustainability and operational efficiency for example seepage into a tunnel of a london tube is a great nuisance intensive seepage of the highest possible flow rate is the only motivation to construct a qanat falaj hydraulic structure railroad highway urban dam and water transportation tunnels vary in their technical specifications see e g ashjari et al 2019 british 2014 chen et al 2017 2016 hornero et al 2021 jin et al 2016 li et al 2022 2021 preene and chrimes 2021 wang et al 2019 wu et al 2020 xu et al 2021 xue et al 2021 but most of them are subject to the inrush of the ambient groundwater with ensued hazards to the structures and ambient environment ecosystems e g subsidence of the ground surface hydrologists hydrogeologists soil physicists and civil geotechnical groundwater and military engineers studied numerically and analytically 2d 3d steady state or transient seepage into a solitary tunnel or a cluster of 2 3 tunnels either grouted or not placed in homogeneous or heterogeneous isotropic or anisotropic soils which were posited to be porous double porous or fractured media continua the skeleton was assumed to be either rigid or deformable and groundwater either compressible or incompressible see e g aghdam et al 2021 an et al 2021 butscher 2012 dassargues et al 2021 el tani 2003 2010 farhadian and katibeh 2017 fernandez and moon 2010a b font capó et al 2011 fujii and kacimov 1998 gattinoni and scesi 2010 gokdemir et al 2021 2022 gong et al 2018 guo et al 2021 hassani et al 2018 houben et al 2022 huang et al 2021 huangfu et al 2010 kacimov 2005 2007a 2009 kolymbas and wagner 2007 lei 1999 li et al 2018 liu and li 2021 maleki 2018 mityushev and adler 2019 park et al 2008a b perrochet 2005a b perrochet and dematteis 2007 qin et al 2020 shahbazi et al 2021 su et al 2017 sweetenham et al 2017 tang et al 2018a b wang et al 2008 wu et al 2021 yang and yeh 2007 yang et al 2016 2021 ying et al 2018 wang et al 2014 zhang and franklin 1993 zhang et al 2020a while the darcy law for the saturated or unsaturated pore water motion is postulated the hydraulic gradients close to tunnels contours are often so high that non darcian corrections are necessary see e g he et al 2021 zhang et al 2019 2020b mathematically boundary value problems bvps to the elliptic e g laplace s advective dispersion and modified helmholtz s or parabolic e g nonlinear richards richardson and linear nonlinear boussinesq diffusion pdes are formulated the tunnel itself and the seepage feeding boundary are commonly assumed to be a horizontal equipotential and therefore isobaric line or surface a slightly curved water table with accretion is commonly approximated by a horizontal isobar the tunnel itself is assumed to be either a circular or quasi circular isobar or equipotential contour when the seepage bvp is solved i e the flow net the scalar field of pore pressure and the vector field of the darcian velocity are determined the analysis of strains stresses determines the stability of the tunnel s slopes the tunnel s roof zone is most risky and near tunnel skeleton for stability all types of soils deformations erosion and collapsing suffusion colmation heaving sliding etc see e g fernández and alvarez 1994 ivars 2006 lee and nam 2001 2004 lee et al 2006 pand and dias 2016 verruit and booker 2000 zhang et al 2014 should be avoided if this geomechanical examination of the tunnel and its soil vicinity detects unstable conditions regimes seepage induced deformations or soil s degradation then protection measures drainage and lining are designed constructed however a rigorous mathematical analysis of seepage into clusters of tunnels and grouted tunnels is missing specifically in this paper we present new analytical and numerical solutions to bvps for seepage flows towards a two empty tunnels b a tunnel partially filled with water c a grouted tunnel we answer the following main questions how much pore water seeps into the tunnels are the soils and liners around the tunnel able to withstand the pore pressures their gradients hydraulic gradients and seepage forces moreover from the ontological azimuth we believe that most modern modelers in subsurface mechanics except strack 2017 and his group and a few others like tong et al 2022 have abandoned the powerful methods of the theory of holomorphic functions developed mastered and applied to the problems of agricultural horizontal drainage by vedernikov 1939 and polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 indeed most of the above reviewed analytical solutions to bvps are obtained by the methods of images and fourier series expansions applied to a harmonic function piezometric head our analytical and hydrus solutions presented below give the spectrum of seepage characteristics simultaneously the flow net piezometric head and stream function pore pressure distributions vector fields of the darcian velocity hydraulic gradients and the riesenkmapf s seepage force function see pk 77 thus in this paper we expand and despite our focus on the subsurface gaya pluto s realms astronomize the analysis of seepage to tunnels including ones still invisible from the space on mars but mathematically acting as equipotential and isobars kacimov et al 2022a engaging two synergetic modeling weapons the theory of holomorphic functions and hydrus 2 analytical solution for empty and partially filled tunnels we introduce the gauge pressure of pore water p p γ w p where p is the pressure head γ w ρ g ρ is a constant water density and g is the magnitude of gravity acceleration the richards richardson equation see e g radcliffe and šimůnek 2010 governs the dynamics of pore water in both saturated and unsaturated forms 1 θ t k p h in eq 1 is the nabla operator in cartesian coordinates oxy see fig 1 a which illustrates a vertical cross section θ t x y is a volumetric water content k p is the hydraulic conductivity function and h t x y p y is the total piezometric head in fully saturated homogeneous isotropic soils k p k const the saturated hydraulic conductivity then for steady state or transient flows without free boundaries e g phreatic surfaces eq 1 is reduced to the laplace equation 2 δ ϕ t x y δ ψ t x y δ p t x y 0 where δ is the laplacian operator φ t x y ψ t x y is the dyad of harmonic functions viz ϕ t x y k h v is the specific discharge potential also called velocity potential by pk h t x y p y is the total piezometric head v t x y is the vector of specific discharge and ψ is the stream function conjugated with φ via the cauchy riemann conditions see e g pk 62 77 and strack 2017 we introduce a complex physical coordinate z x i y complex potential w φ iψ and complexified darcian velocity v u i v where u t x y and v t x y are the horizontal and vertical components of the specific discharge vector the function w z is holomorphic and v z is antiholomorphic pk 62 we also introduce the riesenkampf force per unit volume of a saturated porous medium see pk 77 for more details which is the vector f r t x y γ w i 1 θ s γ s γ w j ξ where ξ t x y p γ0 y γ0 θ s γ w 1 θ s γ s and γ w γ s and θ s are the specific weights of water solid particles which make the porous medium and porosity respectively the force potential ξ t x y is also a harmonic function this force was evaluated in kacimov and obnosov 2016 for problems of subsurface irrigation where seepage from buried emitters can cause the heaving of the soil surface above them in tunnels which are under construction 3 d effects of seepage near an advancing not lined and not grouted tip of the tunnel see e g chen et al 2022 hong et al 2010 zingg and anagnostou 2018 are ignored in our analysis 2 1 two empty staggered tunnels with their centers connecting segment collimated with gravity in this subsection we study analytically the case of two empty circular tunnels staggered in such a manner that the line connecting their centers c 1 the upper tunnel and c 2 the lower tunnel is parallel with the vector of gravity g see similar settings in guo et al 2021 huang et al 2020 the emptiness of the tunnels is engineeringly ensured by perfect drainage of water dripping exfiltrating into them the distance between the tunnels centers is a their radii are r 1 and r 2 and the depths of the centers counted from the horizontal soil surface ox are d 1 and d 2 water seeps in the lower half plane of fig 1 with two circles cut of this half plane i e the flow domain g z is mathematically triply connected bounded by two circles and a straight line ox a degenerated circle in fig 1a we show the case of a soil surface ponded by a layer of static water of a depth h obviously p h and φ kh along ox and p 0 along the tunnels circumferences we recall that vacuum drainage has been tested in clayey soils see e g grigor ev 1973 in vacuumed tunnels the boundary condition along the tunnels contours should be p pv where pv is a positive constant determined by the vacuum creating air pump vice versa if flooding ponding of soil is fast then the pore air can be piston displaced by imbibing water into the tunnel and therefore the excess positive pressure p pv can be maintained in a dead end subterranean opening like a dead root hole in fig 1b we follow pk 62 and select point i infinity as fiducial i e assume that at this point ψ 0 w kh on the riemann sphere the infinity is imaged by a single point i albeit this point triplicates in the physical plane of fig 1a and our hydrus models below we also follow pk 62 and vedernikov 1939 and assume that the pore water is stagnant at infinity i e v 0 which hydrogeologically means that soil is subtended by an impermeable horizontal bedrock no flow boundary in other words if there are no tunnels then there is no seepage a deep drainage layer or a deep water table can be alternative infinity conditions kacimov et al 2022b pk 62 instead of a ponded soil surface we can also consider the case of tunnels placed under a phreatic surface which is formed by recharge of intensity e from the vadose zone fig 1b where only one tunnel is depicted through which the rain or irrigation water infiltrates in the case of a deep tunnel and free deep drainage to infinity the free drainage boundary condition in hydrus see simunek et al 2018 a steady state phreatic line a dashed curve in fig 1b is only mildly depressed above a seeping tunnel hence this curve can be approximated by a straight horizontal line and mathematically we arrive at the case of flow in fig 1a see e g butscher 2012 if e and the tunnel sizes are small then unsaturated flow takes place near what in soil physics is commonly interpreted as a subsurface cavity which can act as an impermeable barrier philip 1998 kacimov 2007a kacimov et al 2022b yucca mountain deep subsurface structures in nevada where e is small were also investigated as potentially impermeable subterranean openings see e g philip 1998 the topology of seepage flow in fig 1a is characterized by a four branched separatrix and a stagnation point s the two separatrix branches the curved streamlines sls and srs start from the soil surface and end at point s located between the tunnels the remaining branches straight streamlines sb 1 and sa 2 start at s and end at the bottom point b 1 of the upper tunnel and apex a 2 of the lower tunnel respectively the segment slsr of the ponded surface feeds the upper tunnel with the flow rate q 1 the lower tunnel is fed by the rays isl and isr with the flow rate q 2 shi et al 2020 studied topologically similar seepage regimes to vertical wells i e ignoring gravity and zero pressure boundaries for a single tunnel drain vedernikov 1939 and later pk 62 used the method of images and showed that a strictly circular drain completely filled with water i e a constant piezometric head drain can be modeled by a line sink placed at a certain depth d such a sink generates a family of equipotential lines circles each centered at a certain depth larger than d two families of streamlines semi circles are orthogonal to the equipotential circles fujii and kacimov 1998 hereafter fak 98 used the vedernikov solution and showed that the isobar p 0 generated by a line sink albeit not exactly circular can be considered as a quasi circle of a vertical diameter dv and a horizontal diameter dh fig 2 sketches these isobars as solid line ovals strictly circular tunnels contours modeled in section 4 below deviate from these ovals in the same sense as the vedernikov 1939 see also pk 62 77 equipotentials generated by line sinks deviate from strict circles which physically model the lines of contact between gravel packs of horizontal drains and the ambient saturated soil if deviations of isobars in our paper or vedernikov s equipotentials from circles is insignificant then empty tunnels or drains can be approximated by line sinks in other words if at a given sink s depth d its strength q is not too high then the isobar is almost circular i e dv dh 2r and the depth of the sink is almost the same as the depth of the center of the circular tunnel fak 98 also optimized the placement of an empty quasi circular tunnel under the ponded surface viz they proved that an empty tunnel of a given size diameter or cross sectional area seeps at a minimal flow rate qm if placed at a depth dm such an optimum is intuitively clear and follows from the rolle theorem indeed if in fig 1 for a given solitary circular tunnel d 1 r 1 then obviously q 1 while at d 1 the flow rate also blows up q 2 the method of superposition of singularities real and fictitious for modeling of saturated and unsaturated flows is implemented see appendix a similarly to kacimov 2007b kacimov and al maktoumi 2019 kacimov and obnosov 2016 2018 and kacimov et al 2018a b 2019 2020 since p φ k y obtaining the contours of tunnels isobars from eq a2 in appendix a is reduced to the solution of the following implicit equation 3 f x y q 1 2 π ln x 2 y d 1 2 x 2 y d 1 2 q 2 2 π ln x 2 y d 2 2 x 2 y d 2 2 h y 0 we introduce dimensionless quantities h p x y d 1 d 2 d s a d v 1 d v 2 d h 1 d h 2 h p x y d 1 d 2 d s a d v 1 d v 2 d h 1 d h 2 h a r a r h 2 q 1 q 2 ϕ ψ w q 1 q 2 ϕ ψ w k h v v k f r f r γ w and for the sake of brevity drop s from them we used the routine contourplot of wolfram s mathematica 1991 and in fig 3 a plotted the dimensionless isobars p 0 and 0 4 for d 1 1 d 2 2 q 1 q 1 2 1 q 2 q 2 2 2 as well as the streamlines 1 1 all our mathematica programs are open codes and can be shared with the referees readers the two contours p 0 are almost circular and therefore can serve as an excellent approximation of circular tunnels in fig 1a obviously the streamlines in fig 3a are not orthogonal to isobars the segment a 1 o between the surface and top of the upper tunnel is a branch cut fig 3b shows the isobar p 0 and p 0 5 for the same d 1 d 2 q 1 as in fig 3a but for a relatively large value of q 2 cr 1 9988 in this critical case the isobar p 0 is made of two coalescing contours in fig 3c the vicinity of the two osculating components of this tunnel is zoomed the flow net is shown for the right half of the flow domain with equal and regular increments of 0 26 and 0 35 for the equipotential lines and streamlines which are shown by dashed and solid lines respectively at the point in indicated in fig 3c the streamline ψ 2 1 and equipotential line ϕ 1 04 cross the tunnel contour at this point it is evident that the streamline is not orthogonal to the line p 0 with a further increase of q 2 keeping other parameters in this example constant one can not get two disconnected isobaric contours p 0 i e two staggered tunnels in fig 1a can not even be approximated by two mathematical sinks still the equation p 0 x is solvable but with only two roots if q q 2 cr a single p 0 subsurface opening of a fancy dumbbell shape can be modeled by two sinks two or more log singularities could be used to model an elongated isobaric shape that might look like the cross section of a typical qanat tunnel ebrahimi et al 2021 similarly to what is done by the superposition of a line source and a line sink when impermeable rankine bodies are obtained as streamlines separatrices see e g kacimov and obnosov 1997 warrick and fennemore 1995 similarly to variation of q 2 up to its upper bound q 2 c we varied q 1 and d 1 in the range 0 d 1 d 1 cr and d 2 in the range d 2cr d 2 these results are skipped over for the sake of brevity we used the findroot routine of mathematica to solve eq 3 in which we put x 0 with respect to y we find ya 1 yb 1 ya 2 yb 2 and vertical diameters of the tunnels dv 1 and dv 2 fig 4 a shows dv 1 d 2 for q 1 1 d 1 1 and q 2 2 curve 1 and q 2 1 curve 2 fig 4b shows dv 1 d 1 for q 1 1 d 2 5 and q 2 2 curve 1 and q 2 1 curve 2 in fig 4c the curves dv 2 d 2 are plotted for q 1 1 d 1 1 and q 2 2 curve 1 and q 2 1 5 curve 2 in fig 4d the curves dv 2 d 1 are plotted for q 1 1 d 2 2 and q 2 2 2 curve 1 and q 2 2 curve 2 the horizontal sizes of the tunnels are determined slightly differently from fak 98 specifically we have to find both the ordinates and abscissae dh 1 2 and dh 2 2 of m 1 and m 2 i e the tunnel s contour points most protruding to the right in fig 2 for this purpose we used mathematica to evaluate the function f 1 x y dx dy along the isobars p const we skip over the lengthy explicit expression for f 1 for the isobar p 0 the points m 1 and m 2 have the derivative dx dy 0 consequently for a given d 1 d 2 q 1 q 2 we solved the system of two equations 4 f x y 0 f 1 x y 0 with respect to x and y the findroot routine of mathematica solved the system 4 with an initial guess point close to 0 d 1 for the upper tunnel point m 1 and another initial guess point close to 0 d 2 for the lower tunnel point m 2 the roots xm 1 and xm 2 computed by mathematica were eventually doubled to get dh 1 and dh 2 in fig 2 fig 5 shows the horizontal sizes of both tunnels dh 1 d 1 and dh 2 d 1 curves 1 and 2 respectively for q 1 1 q 2 1 and d 2 2 the dimensionless area ar π dv 1 dh 1 dv 2 dh 2 4 of both tunnels was evaluated by approximating their shapes as ellipses having semi axes xm 1 dv 1 2 and xm 2 dv 2 2 fig 6 a illustrates the dependence ar d 1 for q 1 1 d 2 2 and q 2 1 0 8 and 0 6 curves 1 3 respectively the curves have a global maximum local minimum and two end extrema for example curve 2 has a global end minimum at d 1 0 and a global maximum at d 1 0 425 that comports with the optimization in fak 98 the local minimum and the local end maximum are however surprising in fig 6b ar d 1 is plotted for q 1 1and q 2 2 and 1 curves 1 2 correspondingly with the distance a between tunnels centers fixed again analogously to fak 98 a single maximum is attained at a certain depth of the dyad of tunnels e g armax 0 051 at d 1 max 0 66 for the first curve there is a limitation for the quasi elliptic approximation of tunnels shapes which we used the isobar p 0 at the values of tetrad s parameters close to the critical can resemble axial sections of a teardrop see fig 3b or beetroot which is weird in the application to tunnels the ordinate of the stagnation point ys ds is found as the solution of the equation v 0 y 0 the complexified specific recharge is v z d w d z where the overbar means complex conjugation pk 62 then from eq a1 we get 5 v z q 1 π d 1 z 2 d 1 2 q 2 π d 2 z 2 d 2 2 from eq 5 at x 0 we get an equation with respect to y for detection of point s 6 v y q 1 π d 1 y 2 d 1 2 q 2 π d 2 y 2 d 2 2 0 unlike the previous transcendent equations above which we tinkered by findroot eq 6 is a quadratic equation that has two explicitly found real roots we selected a physically meaningful value negative 7 y s d 1 d 2 2 q 1 d 2 d 1 2 q 2 d 1 q 1 d 2 q 2 for the parameters d 1 1 d 2 2 q 1 1 and q 2 2 this gives ds 1 27 next we put the root 7 back into eq a2 where we also set x 0 and get the potential at point s for the parameters in fig 3a this gives ϕs 0 63 that in the complex potential plane determines the locus of the tip of the cut gw fig 2 the distribution of the magnitude of the dimensionless riesenkampf s resultant force fr along the y axis is plotted for d 1 1 d 2 2 q 1 1 q 2 2 the ratios of specific gravities of water and solid particles γs γw 2 65 and porosity θ s 0 4 fig 6c d and e show the modulus of the riesenkampf force along the rays oe 1 e 1 e 2 and e 2 i respectively the maximum force occurs along the perimeters of the two tunnels at four points which are found by solving the equation p 0 y 0 the roots of these equations are yr 0 97 1 03 1 93 2 06 depending on the initial guess point along the ordinate axis the dashed rays intersecting the curves in fig 6c e are called the tunnel perimeters on the graphs for these six parameters the force attains a minimum value of zero at two points on the symmetry line y 1 152 and y 2 624 these minima are found by the findminimum routine of mathematica 2 2 single partially filled tunnel in this subsection we consider a single tunnel partially filled with static free water we use vedernikov s 1939 solution a special case of q 1 q q 2 0 d 1 d see eq a1 the source of this water inside the tunnel can be either seepage from a saturated ambient soil or conveyance of water from somewhere in the direction perpendicular to the oxy plane the trick now is to combine the isobar p 0 generated by a single sink of intensity q 2q and placed at the depth d with certain equipotential lines φ φ1 φ2 φ3 φ4 these lines are circles centered at points z d e1 d e2 d e3 d e4 and have the radii r 1 e r 2 e r 3 e r 4 e see vedernikov 1939 obviously there is a double inequality limitation φ m φ i φ m i e not all equipotential circles 1 φ i generated by a sink and determined by parameters q d intersect the contour p 0 generated by this sink fig 7 a and b shows the case of q 5 and d 1 the dashed contour is the isobar p 0 a complete flow net is presented in fig 7a with streamlines labeled for the right half of the flow domain the isobar p 0 is plotted as a dashed line three equipotential lines ϕ 0 7 1 4 and 1 6 are also plotted fig 7a illustrates that the streamlines vedernikov s 1939 circles are not orthogonal to the quasi circular isobaric tunnel contour while they are orthogonal to the equipotentials also vedernikov s circles in fig 7b we sketched the right half of fig 7a a segment of the equipotential line ϕ 0 7 together with the upper part of the isobar p 0 makes a tunnel contour which is filled with water up to the point t1 this point is an intersection of the two curves ϕ 0 7 and p 0 thus the contour at 1 bt seeps as a line sink the horizontal segment t1t2 represents the free surface of static water in the tunnel another partially filled tunnel of the same q is made by a segment of the equipotential line ϕ 1 4 which together with the upper part of the same isobar p 0 makes another tunnel contour this tunnel is filled with water up to point n 1 which is an intersection of the two curves ϕ 1 4 and p 0 thus the contour an 1 bn in fig 7b seeps as a line sink the horizontal segment n 1 n 2 represents the free surface of static water in the second tunnel the futile equipotential ϕ 1 6 is shown in fig 7a but not in fig 7b because this equipotential contour does not intersect with the isobar p 0 i e this equipotential line is physically useless we used the mathematica routine findroot to solve a system of two equations φ x y φ i p x y 0 with respect to x and y for example for φ φ n 1 4 we got xn 1 0 36 and yn 1 1 4 the maximum φ m for this sink is 1 517 the equipotential circle touches the isobar internally i e there is almost no static water in the tunnel and the minimum φ m for this sink is 0 419 the equipotential circle touches the isobar externally i e the tunnel is almost full of water 3 analytical solution for saturated seepage to grouted tunnel in this section we present an explicit and rigorous analytical solution to 2 d steady saturated seepage towards a solitary grouted tunnel placed under a ponded surface ox fig 8 the soil hydraulic conductivity is now k and the hydraulic conductivity of the grouting also modeled as a darcian porous medium is k g these quantities are arbitrary but unlike the problems of seepage to horizontal drains or vertical wells for which gravel packs filters are made of materials with k g k see e g kacimov and obnosov 2018 in wells with skin effect obnosov et al 2010 and for grouted or lined tunnels an opposite inequality holds k k g i e seepage into the tunnel is inhibited the two porous media are separated by a circumference of a radius r in dimensional quantities centered at point z i dc an empty tunnel is modeled by an isobar p 0 fig 8 this contour is generated by a line sink of intensity q 2q the sink is placed at a depth d eccentric with the interface between the two media the seepage domain gz is made of two subdomains s 1 z z i d c r im z 0 and s 2 z z idc r obviously 0 dc r d dc r the solution trick is the same as in section 2 we reconstruct an isobar p 0 and if it is almost circular then this line is interpreted as a contour of an empty tunnel by varying d we get an almost annular or eccentric grouting zone of conductivity kg while the interior of the dashed contour in fig 8 is discarded similarly zhukovsky placed a vortex in the interior of his airfoils zhukovsky 1949 and discarded a subdomain of his flow domain which is demarcated by a separatrix obtained by superposition of the vortex and dipole at infinity ambient unidirectional flow of an ideal fluid in the notations of this section the solution is written in terms of two complex potentials and darcy s laws with two contrasting hydraulic conductivities w 1 φ1 iψ1 φ1 kh 1 v 1 ϕ 1 and w 2 φ2 iψ2 φ2 kgh 2 v 2 ϕ 2 p 1 φ1 k y p 2 φ2 kg y defined in the exterior and interior of the circle in gz of fig 8a for further comparisons with hydrus below we will keep dimensional quantities along the interface between s 1 and s 2 the refraction conditions hold 8 ϕ 1 k ϕ 2 k g ψ 1 ψ 2 the derivatives of the complex potentials are v 1 d w 1 d z and v 2 d w 2 d z functions v 1 and v 2 should obey the conditions of the abscissa axis acting as an equipotential line and static pore water at infinity im v 1 x 0 x v 1 0 the refraction boundary condition written in a complex form should be met along the circular interface between s 1 and s 2 viz 9 2 k g v 1 τ k k g v 2 τ k g k r 2 τ i d c 2 v 2 τ τ i d c r where τ is a complex variable along the circumference in fig 8 which we recall is the line of mechanical contact between the soil and grouting medium the refraction condition in this form is common in the theory of holomorphic functions see e g the review by zverovich and litvinchuk 1968 and the book by litvinchuk 2000 p 135 eq i eq 9 incorporates two refraction conditions 8 usually formulated in real rather than complex variables viz the continuity of the pressure piezometric head and the normal component of the two flux vectors across the interface see e g pk 62 and strack 2017 our problem is closely related to the refraction problem for two arbitrary circles with conductivity contrasting with that of the plane an exact analytical solution of the latter problem was obtained by obnosov 2011 for a general case of arbitrary singularities not only sinks sources we solved the problem 8 and 9 using the same method as in obnosov 2011 the details of derivations are presented in appendix b in s 2 the complexified darcian velocity is an antiholomorphic function everywhere except a simple pole at z i d therefore its complex conjugate function v 2 z can be represented as follows 10 v 2 z q 2 π z i d v 20 z where v 20 z is holomorphic in s 2 the characteristic function v 20 is written as 11 v 20 z q λ 2 π z i a 1 q 1 λ 2 2 π n 0 λ n z i a n the following notations are introduced in eq 11 12 λ k r 1 k r 1 a n t u 2 n a t z s 1 z 1 z s d c 2 r 2 a d s d s u 2 d c s d c s where kr k g k is a dimensionless conductivity ratio points is are symmetrical to each other about the real axis and the circle s 1 an s when n tends to infinity the characteristic function v 1 in s 1 is 13 v 1 z q 1 λ 2 π n 0 λ n 1 z i a n 1 z i a n the complex potentials in s 1 and s 2 are obtained by integration of eqs 10 11 and 13 with respect to z integration of eq 13 is done from z 0 to z point z 0 is fiducial i e at this point w 1 0 1 then we get 14 w 1 z q 1 λ 2 π n 0 λ n log i a n z i a n z 1 in eq 14 the branches of logarithmic functions are fixed in the z plane with a branch cut from ian to ian through infinity the branches vanish at the point z 0 integration of eqs 10 and 11 is done from the point ag in fig 8 viz from z i dc r to z at point ag the refraction conditions see pk 62 have to be met im w 1 i d c r im w 2 i d c r 0 k r re w 1 i d c r re w 2 i d c r then we obtain 15 w 2 z q 2 π log z i d i d r d c q λ 2 π log z i a 1 i r d c a 1 q 1 λ 2 2 π n 0 λ n log z i a n i r d c a n k r w 1 i d c r in eq 15 the branches of all logarithmic functions vanish at the point i dc r all branches are fixed in the z plane with a cut from the points ian up to infinity except for the first term on the rhs of eq 15 for this logarithm the branch cut extends from the point z id down to infinity we note that analytical solutions for seepage to an empty grouted tunnel reported and used by fernandez and moon 2010a li et al 2018 qin et al 2020 wang et al 2008 wu et al 2021 yang et al 2016 and ying et al 2018 do not take into account and do not even articulate the phenomenon of refraction on the interface between soil and grouting specifically seepage to either a sink and sink generated zero pressure quasi circular isobar in our solution above or a circular isobar with an annular liner sheath is always 2 d in both s 1 and s 2 subdomains of the half plane of fig 8 this is evident from eqs 11 and 13 or eqs 14 and 15 which represent the superposition of an infinite number of sinks and sources for each of which flow is 2 d in fig 9 we show the grouting circumference of a radius r 0 5 m dimensional quantities are used for further comparisons with hydrus results in section 4 in fig 9 a and b computations were carried out for d 1 1 m dc 1 m and q 5 m2 day the series are truncated by n 50 terms the streamlines ψ1 and ψ2 0 0 5 1 1 5 2 2 5 m2 day thin lines are found by the separation of the imaginary part in eqs 14 and 15 the tunnel contour p 0 labeled dashed line is determined using φ1 and φ2 obtained by the separation of the real part in eqs 14 and 15 panels a and b in fig 9a and b illustrate the cases of kr 0 3 and 0 1 respectively obviously the streamlines inside the dashed curve i e in the air zone of the tunnel are unphysical the reconstructed quasi circular tunnel contour has the vertical size dv which is evaluated as the difference in the ordinates of the uppermost point at on the isobar p 0 and its lowermost point bt we used again the mathematica routine findroot to solve the equation p 2 0 y 0 and determined the loci of these points for panels a and b in fig 9 the roots i e the y coordinates of at and bt are 0 689 m and 1 41 m for a and 0 577 m and 1 72 m for b consequently the corresponding tunnels diameters dv are 0 72 m and 0 87 m one has to be cautious with the above described procedure of reconstruction of the p 0 isobar specifically if q in the examples of fig 9 increases above a certain critical value then a negative pressure zone emerges in the soil beneath point bg in fig 8 in this case the whole solution 14 and 15 albeit mathematically formally correct can not be applied to the problem of seepage to a grouted tunnel since the basic assumption in the conceptual model of this section is that the soil and grouting seep under non negative pore pressures to illustrate this we placed the sink in fig 9c and d as d 1 25 and d 0 6 respectively in fig 9c the isobar p 0 is slightly below point bg in fig 9d with a sink hoisted with respect to the center of the grouting circle the isobar p 0 is bulging above point ag in fig 8 i e protruding into the aquifer both cases in fig 9c and d can be considered as a failed grouting albeit mathematically dc and d in fig 8 and our analytical solution can be arbitrary fig 9e presents mathematica plotted with the help of the contourplot routine isotachs v 1 2 const for d 1 3 m dc 1 m q 2 m2 day and kr 0 01 the circular interface between the soil and grouting is a circle of a radius r 0 5 m the grouting air interface is plotted as a dashed quasi circle which has dv 0 92 m in this case the contrast in hydraulic conductivities of two porous subdomains of gz is so high that n 50 is not enough in eqs 10 11 and 13 we increased summation in the series up to n 150 terms to achieve the following convergence criterion at points ag and bg the velocities v 1 and v 2 from the soil and grouting sides of the interface have to coincide up to the third digit obviously the isotachs v 2 inside the dashed contour in fig 9c have to be discarded in the context of the tunnel problem the computed isotachs clearly show that thicker grouting of the tunnel in its roof zone helps in reducing the darcian velocities there which however remain dangerously high in the vicinity of point bg the tunnel floor where the grouting is thin we recall that pk 77 formulated a criterion inequality of seepage induced instability in darcian flows the magnitude of the hydraulic gradient in an unconsolidated soil obeys v 1 k 1 in our dimensionless quantities if the gradient is less than 1 e g between the contour and the grouting soil interface in fig 9e where 1 v 1 k 0 8 then the soil may still be unstable to internal erosion suffusion in the degenerate case of kr 1 no grouting section 2 for the set of parameters in fig 9c i e a single tunnel generated by a sink at d 1 3 m and q 2 m2 day we have a much smaller size dv 0 0038 m i e grouting does comprise a large tunnel s area of the same q on the other hand if we fix dv 0 92 m then a tunnel without grouting will have a much larger q 8 2 m2 day as compared with the grouted case in fig 9c i e kr 0 01 is an efficient counter seepage measure it is noteworthy that unlike the case of formation damage and skin effect in aged wells see e g houben and treskatis 2007 which is detrimental to wells productivity suffusion and translocation of finest particulates of a porous medium lessivage in the vernacular of soil pedology towards the grouting circle in figs 8 and 9 is a positive phenomenon indeed if the near grouting soil gets extra clogging accrued by a long lasting seepage this will only bolster the main mission of the anti seepage aim of grouting by shifting the sink up and down with respect to the center of the grouting circle in fig 8 which can also be an engineering design parameter i e by the effects of eccentric boundaries we can fortify the tunnel from seepage where it is critical optimization of the liner thickness and of the locus of the tunnel itself with purely seepage related criteria for a rigid porous skeleton of s 1 and s 2 can be a preamble of a geomechanical optimization see e g li and zhou 2015 that can be carried out similarly to section 2 we skip over this analysis for the sake of brevity 4 hydrus modeling in this section we use the finite element model fem hydrus 2d radcliffe and šimůnek 2010 šimůnek et al 2018 with the following intentions a cross compare the fem results with those obtained analytically in the previous sections b incorporate various boundary conditions e g tunnels partially filled with water rather than empty ones c model clusters of tunnels centers of which are not on the same vertical line generalizations b c are not amenable to analytical considerations for circular tunnels without any loss of generality we assume that the two tunnels are perfectly circular in their vertical cross sections fig 1a in all our computations we consider the van genuchten s vg soils šimůnek et al 2018 characterized by parameters θ r θ s α n k where θ r is the irreducible volumetric water content and α n represent the vg shape parameters we changed the notation for the vertical cartesian coordinate to z which is more common in soil hydrology 4 1 tunnels with partial filling and their center connecting line collimated with gravity in this subsection seepage is symmetric with respect to the line connecting the tunnels centers and therefore in hydrus only the right half of the flow domain is modeled in fig 10 we assume that the lower tunnel is empty while the upper one is partially filled with trickled exfiltrated water which accumulates at tunnel s bottom e g due to poor drainage we assume that both tunnels have a radius r 1 m the upper tunnel is half filled with static free water and c 1 m 1 is a horizontal air water interface the tunnel centers are placed at z 10 and 15 m in hydrus the flow domains are always finite and the following rectangle sizes in fig 10 are used lh 20 m and lv 30 m these values are large enough as compared with r to mimic the infinity in fig 1a instead of a single point i on the riemann sphere we have points i 1 i 2 and i 3 in fig 10 the segment oi 1 is ponded i e a constant pressure head p 1 m boundary condition is imposed there there is no flow across the segments i 1 i 2 i 2 i 3 i 3 b 2 a 2 b 1 and a 1 o in the upper tunnel p decreases hydrostatically from ht r 2 to 0 along the quarter circle b 1 m 1 here and in section 4 2 we consider the vg loam with θ r θ s α n k 0 078 0 43 3 6 1 m 1 56 0 25 m day a topological peculiarity of flow in this subsection is the shape and position of the separatrix unlike the case of two empty tunnels in section 2 the stagnation point st is now located on b 1 m 1 i e the constant piezometric head segment of the bottom of tunnel 1 the branch srst 1 divides all infiltrated water into two parts ponded water on the left of point sr seeps into the upper tunnel while segment sri 1 feeds the lower tunnel the separatrix branch st 1 st 2 demarcates a zone of seepage from the upper tunnel to the lower tunnel at point st 1 the separatrix kinks if the flow is governed by the laplace equation section 2 from the hodograph analysis kacimov and youngs 2005 showed that the angle between the separatrix branches at st 1 is θ 900 i e this streamline is not orthogonal to the equipotential line b 1 m 1 in fig 10 we skip over the details of the finite element meshing and the iterative solution of the richardson richards equation 2 2 all our hydrus 2d projects are publicly available and can be shared with the referees readers we solved the above stated boundary value problem bvp for this pde with the following initial condition p z decreasing hydrostatically from 31 m to 1 m when z increased from 30 m to 0 the steady state flow velocity field and streamlines are shown in fig 11 fig 11a illustrates the hydrus streamlines and fig 11b zooms the vicinity of the tunnels where the magnitude of darcian velocity is color mapped the point st 1 n with zero velocity is located between the fe node having coordinates x 0 59 m and z 10 81 m and an outflow velocity v 0 0826 cm d and the fe node having coordinates x 0 81 m and z 10 59 m and an inflow velocity v 0 095 cm d along the arc a 1 st 1 n the velocity decreases from the apex tunnel s roof to the quasi stagnation point along st 1 nb 1 the velocity increases again to 0 21 m day for the lower tunnel hydrus detects a red zone of high velocities near the exfiltrating seepage face remarkably the velocity magnitude increases from the apex a 2 where v 0 58 m day to b 2 where v 0 84 m day despite the seepage plume from its ponded bottom the upper tunnel actually hydraulically shades its lower brother which intercepts this plume indeed hydrus shows that the bottom of the second tunnel is more susceptible to seepage erosion than the roof provided the criterion of seepage induced instability is based on the magnitude of the hydraulic gradient as pk 77 conceptualized in her condition h 1of instability of saturated porous massifs we used the boundary fluxes option of hydrus and retrieved the infiltration and exfiltration fluxes as follows from the ponded soil surface a standard infiltration flux qoi 1 3 4285 m2 day the exfiltration flux through a 1 m 1 st is qin 1 0 836 m2 day this quantity is a sum of what comes through both the seepage face a 1 m 1 and a constant total head arc m 1 st the hidden infiltration flux through b 1 st to the lower tunnel is qout 1 0 128 m2 day the upper tunnel is hydrologically a flow through entity the total flow rate into the second tunnel is a sum of qout 1 and qsin 2 2 414 m2 day which is the quantity seeping through st 2 b 2 directly from the ponded soil surface the second tunnel is a gaining hydrological actor in hydrus any degree of filling ht not only r 2 as in the example above in any tunnel can be easily modeled moreover at a specific value ht in fig 10 the upper tunnel acts as a passive entity for which qin 1 qout 1 i e all water seeped into the tunnel from above is oozed back downstream for natural holes made by decayed roots of dead plants such a passive regime is the only one possible because unlike gaining loosing flow through lacustrine hydrology entities ilyinsky and kacimov 1992 kacimov 2000 2007b from which water evaporates or tunnels usually equipped with pumps for dewatering of dripped water macropores in soils do not have mechanisms to uptake the in hole water except macropores under ant domes where social insects consume trickled water 4 2 arbitrarily staggered tunnels in this subsection we consider the case of tunnels of radii r 1 and r 2 whose centers c 1 and c 2 are arbitrarily located at depths dc 1 and dc 2 fig 12 there is no symmetry in this problem and we have to consider the whole flow domain without any loss of generality with respect to tunnels boundary conditions we consider two empty unlined tunnels the centers of which are located distance j apart in the horizontal direction the hydrus cartesian coordinate system i 4 xz is selected such that both tunnels are located sufficiently far from the sides i 1 i 2 i 2 i 3 and i 3 i 4 of the simulation rectangle having sizes lh and lv and selected large enough to avoid the wall effect fig 12 fig 13 a presents the streamlines for seepage from i 4 i 1 ponded to the depth of h 1 m towards this tunnel couple in a vg loam for lh 20 m lv 30 m r 1 1 5 m and r 2 2 m and the coordinates of tunnels centers 7 m 10 m and 13 m 13 m in fig 13b the magnitude of the darcian velocity is color plotted remarkably for both tunnels the maximum darcian velocity shifted from point a 1 to the right and from point a 2 to the left for the upper and lower tunnels respectively this can be attributed to the mutual hydrodynamic shading of this tunnel dyad however these maxima about 0 35 m day along both tunnels contours are dangerously high because the gradients at this point are 0 35 0 25 1 which is above the pk limit of erosional instability of soils a stagnation point s numerically a zone rather than a point is indicated beneath the upper tunnel the total flow rate into the tunnel is q 1 q 2 5 21 m2 day and q 2 3 46 m2 day 4 3 grouted tunnels modeled by hydrus in this subsection we model in hydrus a solitary empty tunnel of a radius ri grouted by an eccentric annular liner a sheath of a radius r e such that the depths of the circles centers are d 4 m and dc 3 5 m respectively the ponding depth h 1 m the ambient soil and grouting material are made of hypothetical soils in which the hydraulic conductivity kg 0 1 m day which is 1 10 of that of the soil k 1 m day we selected lh 7 5 m lv 10 m ri 1 m and r e 2 m i e the thickness of the grouting is 1 5 m at the apex while it is only 0 5 m at the bottom the hydrus simulated flow rate into the tunnel is q 2 1 962 m2 day fig 14 a presents the streamlines with a palette of the magnitude of velocity obviously the grouting near the bottom of the tunnel is at extremely high hydraulic gradients a pressure head distribution along the vertical ordinate axis is shown in fig 14b the grouting especially the segment b 1 bg see also fig 8 is subject to extremely high pressure head gradients the v x plotted in fig 14c is needed for controlling the horizontal size of the hydrus domain viz lh should be large enough to avoid the wall effect with the criterion v 0 at point i 1 for comparisons we modeled the same tunnel and grouting using the analytical formulae of section 3 where we use q 3 924 m3 day and the depth of the sink d 4 m a quasi circular isobar p 0 has ya 1 2 62 m yb 1 4 81 m and therefore dv 2 19 m i e slightly higher than that of the hydrus tunnel circle the analytical velocity at the origin of coordinates is vo 0 23 m day while hydrus gives vo 0 2 m day the analytical pressure heads at the interface points at the ordinate axis are pa g 2 16 m and pbg 5 04 m while hydrus results are pag 2 03 m and pbg 4 4 m if we place the sink deeper in the analytical model at d 4 5 m then for the same q ya 1 2 98 m yb 1 4 99 m and therefore dv is almost the same as the hydrus circle the value of vo is now exactly the same as one in hydrus pag 2 22 m and pbg 4 76 m moreover the maximum of velocity in fig 14c is the same as in the analytical solution thus hydrus results and this solution match well consequently hydrus can be used as a design tool when the sizes of a circular tunnel and liner sheath are fixed and one wants to determine the seepage flow rate the analytical solution can be used in an inverse mode if q is fixed and the tunnel position with respect to oi 1 and the grouting circle are flexible provided that a posteriori the quasi circular shape of the p 0 isobar is checked and seepage is verified to be at positive pressures everywhere in the porous depression zone close to the tunnel bottom 4 4 phreatic flow with accretion in this subsection we consider a grouted tunnel placed under a soil surface with a given infiltration flux e which is sufficiently small not to generate surface ponding fig 1b a vadose zone is formed above the phreatic line p 0 a phreatic fringe forms above this line and below the line p pca where pca is a positive constant which characterizes this fringe as a tension saturated zone in the vedernikov bouwer model see pk 62 77 and kacimov et al 2019 the same hydrus flow domain and soils as in fig 14 are modeled with the following modification of the boundary condition along the soil surface oi1 we now do not specify a constant ponding depth but rather a constant infiltration rate e μ k where μ 1 is a constant determined by the rain intensity obviously μ should be small enough for such a condition to be physically realistic if μ is above a certain threshold value ponding of a horizontal ground surface or runoff takes place fig 15 a shows isobars as contour lines plotted in the range 0 12 p 0 2 for infiltration factor μ 0 08 the water table p 0 is a standard curve with an inflection point the contour p 0 2 is a fancy double ogive the wiggling curve p 0 12 can be considered as a kind of capillary fringe boundary the phreatic line as well as the capillary fringe caves towards the tunnel qualitatively similar to the shapes of phreatic lines in seepage through homogeneous soils in ilyinsky and kacimov 1992 and kacimov and obnosov 2021 in fig 15b the streamlines are shown for μ 0 08 this figure illustrates that immediately under the soil surface infiltration is vertical but closer to the water table the streamlines deflect to the right the shape of some streamlines is quite whimsical reflecting the impact of a draining tunnel and a refracting effect of the grouting in fig 15c isobars are plotted for μ 0 06 in this case the infiltration rate is relatively low such that the phreatic line does not overhang the tunnel an unsaturated gap is positioned above the tunnel apex above the water table a purely unsaturated but 2 d seepage occurs if μ 0 09 ponding of the soil surface occurs in the right upper part of the hydrus domain if kg is increased keeping μ constant then caving of the water table becomes more pronounced such that it cusps towards the tunnel 5 concluding remarks the case of a single quasi circular tunnel modeled by a line sink placed under a horizontal ponded soil surface is amenable to analytical treatment both if the soil is homogeneous vedernikov 1939 or piece wise homogeneous fujii and kacimov 1998 pk 77 and section 3 above the constraints and simplifications in the models used are a rigid porous matrix incompressible one phase and fully steady state saturated flows which despite potentially high hydraulic gradients near the modeled tunnels are assumed to be darcian transience can be taken into account via boundary conditions provided no free phreatic surfaces emerge if the tunnel is strictly circular then the theory of holomorphic functions still gives an analytical solution for isobaric contours in homogeneous soils mityushev and adler 2019 moreover a tunnel of any noncircular shape can be conformally mapped onto a concentric circular annulus see the bieberbach theorem 1953 as verruijt and booker 2000 demonstrated for a circular tunnel after that the dirichlet problem for a harmonic velocity potential can be explicitly solved by the villa formula in terms of schwarz integrals see e g abubakirov and aksent ev 2015 akhiezer 1970 bieberbach 1953 tong et al 2022 demonstrated this procedure for the case of a rectangular tunnel in the future we plan to utilize this technique of solving a mixed rather than dirichlet boundary value problem for a strictly circular but partially filled tunnel for the case of two circular tunnels fig 1a the problem seems prohibitively complex for analytical treatment a triply connected seepage flow domain in fig 1a still can be conformally mapped onto a canonical domain bieberbach 1953 e g a half plane with two slits the so called zhukovsky drains see pk 62 77 however to the best of our knowledge there is no explicit integral formula similar to the villa one which would solve the dirichlet problem in any triply connected domain consequently using numerical models such as hydrus is the only solid method to examine 2 d seepage towards two three and more circular tunnels the results obtained above illustrate that hydrus and analytical solutions match well the method of images vedenrikov 1939 pk 62 is used for circular interfaces between soil and air a flat ponded ground surface and soil and grouting these interfaces are considered as mirrors with respect to which lines sinks and more general hydrodynamic singularities are placed in such a manner that the physical e g the dirichlet refraction robin and other types of boundary conditions are exactly satisfied hydrus is versatile and can model any domain boundaries and interfaces for steady or transient saturated and unsaturated seepage in soils with an arbitrary type of layered heterogeneities the dyad of hydrus and the machinery of holomorphic functions allows one to model behold the intricate details of fluxes pore pressures and forces in the vicinity of invisible subterranean entities credit authorship contribution statement a r kacimov conceptualization formal analysis funding acquisition investigation methodology project administration resources software visualization writing original draft writing review editing yu v obnosov conceptualization formal analysis funding acquisition investigation methodology resources software visualization writing original draft writing review editing j šimůnek conceptualization formal analysis investigation methodology resources software visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the grants dr rg 17 and ig agr swae 22 02 sultan qaboos university oman and by the kazan federal university strategic academic leadership program priority 2030 helpful critiques and comments by two anonymous referees are appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104182 appendix c supplementary materials image application 1 appendix a the method of superposition of line sinks is widely used in analytical studies of darcian flows in well hydraulics see e g vuković and soro 1997 since the seminal zhukovsky 1949 ideas potential flows of an ideal fluid around an airfoil or their cascades are modeled by combining two singularities a real dipole which is equivalent to a unidirectional flow at infinity and a fictitious vortex placed inside the airfoil the method simplifies the analytical treatment of multiple connected domains by reducing them to a simple connected one but with compensated singularities below we follow this zhukovsky laid avenue and extend the fak 98 analysis to multiple staggered tunnels starting from a dyad of line sinks shown in fig 2 the flow domain gz is now a simply connected domain viz the half plane z 0 the characteristic function w z has two logarithmic singularities one at point e 1 z d 1 and another at point e 2 z d 2 the function v z is antiholomorphic in the half plane except points z d 1 z d 2 z ds and z superposition of vedernikov s 1939 complex potentials for two line sinks with two fictitious line sources yields a1 w q 1 2 π ln z i d 1 z i d 1 q 2 2 π ln z i d 2 z i d 2 k h we select the branches of function a1 as follows due to the symmetry of flow and the flow domain gz we consider only its right half the right bottom quarter plane in fig 2 in further hydrus modeling this will save computation time the corresponding complex potential domain gw is a half strip of a height q 1 q 2 2 with a cut e 2 se 1 fig 2 obviously from eq a1 ψ 0 along the streamline ie 2 the curved streamline srs bifurcates at point s along the cut in gw and along the straight segments se 1 and se 2 in gz we have ψ q 2 2 along the straight segments oe 1 in gz the stream function is ψ q 1 q 2 2 the value of potential k hs where hs const h at the stagnation point is a part of the solution the fak 98 trick is the isobars a 1 b 1 and a 2 b 2 in gz are determined by solving the equation p x y 0 in gw fig 2 the images of these two isobars are shown as two thick curves the loci of points a 1 b 1 a 2 and b 2 are computed by solving the equation p 0 y 0 we will show below that this equation can have four or two roots in a special case of three roots the contours of two conterminous empty tunnels coalesce in the case of four roots the corresponding tetrad ya 1 yb 1 ya 2 yb 2 is used for obtaining the vertical diameters of the two tunnels as ya 1 yb 1 and ya 2 yb 2 if the reconstructed curves a 1 b 1 and a 2 b 2 in gz are close to half circles then the two generated isobars p 0 approximate well the genuinely circular contours of the tunnels in fig 1a thus we separate the real part in eq a1 to obtain the potential a2 ϕ q 1 2 π ln x 2 y d 1 2 x 2 y d 1 2 q 2 2 π ln x 2 y d 2 2 x 2 y d 2 2 k h similarly we separate the imaginary part in eq a1 to get the stream function appendix b in this appendix we provide full details of the solution to the problem of seepage in a two component composite made of an aquifer half plane of one conductivity and a circular inclusion of a contrasting conductivity where a line sink which generates a quasi circular isobar as a tunnel contour is placed specifically we prove the validity of eqs 11 and 13 in section 3 the boundary conditions along the real axis and the circular interface between s 1 and s 2 are b1 re v 1 x 0 x v 1 0 v 1 t a v 2 t b r 2 t i d c 2 v 2 t t i d c r here a k kg 2kg b kg k 2kg and there is a line sink of intensity q 2q at the point id i e b2 v 2 z q π z i d v 20 z where the function v 20 z is holomorphic in the domain s 2 we consider the mőbius transformations of the z plane and of the ζ plane onto each other by the functions b3 ζ t 1 z z i s z i s z t ζ i s ζ 1 ζ 1 where the points is are symmetric about both the real x axis and circumference s 2 i e b4 s d c 2 r 2 the first function b2 maps conformally the lower half of the z plane onto the unit disk of the ζ plane and t 1 sk ω k k 1 2 see fig b1 we introduce the notations b5 t 1 i d d s d s a u 2 d c s d c s t ζ i a i d s ζ a ζ 1 t 2 ζ t ζ i d c i d c s ζ u 2 ζ 1 i d c s t 1 ζ we introduce new unknown functions v k ζ v k t ζ k 1 2 and omit the superscript below then using conditions b1 and notations b2 b5 we obtain b6 re v 1 τ 0 τ 1 v 1 1 0 v 1 τ a v 2 τ b u 2 t 1 τ 2 v 2 τ τ u and b7 v 2 ζ q π t 2 ζ v 20 ζ according to the first boundary condition b6 the function v 1 ζ can be analytically continued into the ring u ζ 1 u via the symmetry principle therefore the continued function we keep the same notation for it satisfies the condition v 1 ζ v 1 1 ζ and can be represented as b8 v 1 ζ v 1 ζ v 1 1 ζ where the function v 1 ζ is holomorphic in the circle ζ 1 u without any loss of generality we can assume that v 1 1 0 next we consider the following function b9 f ζ v 1 ζ a v 20 ζ b q u 2 π t 1 ζ 2 t 2 u 2 ζ ζ u a q π t 2 ζ v 1 1 ζ b u 2 t 1 ζ 2 v 20 u 2 ζ ζ u it satisfies the continuity condition f τ f τ for τ u according to the second equality b6 and due to representations b5 has a simple pole at the point ζ u 2 additionally the function f ζ is bounded at infinity and f 1 0 in comport with liouville s theorem we have f ζ c t 1 ζ where c is a constant to be determined clearly c lim ζ 1 t 1 ζ f ζ b q u 2 π t 1 1 2 t 2 u 2 i b q π d c s then from eq b9 we obtain simple algebra is omitted b10 v 1 ζ a v 20 ζ i b q d c d ζ 1 π d s a ζ 1 0 ζ u a q π t 2 1 ζ v 1 ζ b u 2 t 1 1 ζ 2 v 20 u 2 ζ i b q π d c s t 1 1 ζ ζ 1 u exclusion of the function v 1 ζ from the system b10 leads to the relation v 20 ζ λ u 2 ζ 1 2 u 2 ζ 1 2 v 20 u 2 ζ i q π λ d c d ζ 1 d s d c s a u 2 ζ 1 ζ 1 d s a ζ 1 λ ζ 1 d c s u 2 ζ 1 let b11 v 20 ζ ζ 1 v 21 ζ then we get the following functional equation with respect to v 21 ζ b12 v 21 ζ λ u 2 l 1 ζ v 21 u 2 ζ i q π ζ 1 f 0 ζ where b13 f j ζ c 1 m j 1 ζ c 2 m j ζ c 3 l j 1 ζ consequently b14 l j ζ ζ 1 u 2 j ζ 1 m j ζ ζ 1 a u 2 j ζ 1 c 1 λ d c d d s d c s c 2 1 d s c 3 λ d c s from the definitions b13 b14 follows b15 l j ζ l 1 u 2 j ζ l j 1 ζ l j ζ m 1 u 2 j ζ m j 1 ζ l j ζ m 0 u 2 j ζ m j ζ l j ζ f 0 u 2 j ζ f j ζ we replace ζ with u 2ζ in eq b12 the result of this substitution we put into the rhs of eq b12 and using the relations b15 we arrive at v 21 ζ λ u 2 2 l 2 ζ v 21 u 4 ζ i q π ζ 1 λ u 2 l 1 ζ f 1 ζ f 0 ζ we replace ζ with u 4ζ in eq b12 and substitute the result into the rhs of the last equation and so on at the n th step we obtain v 21 ζ λ u 2 n l n ζ v 21 u 2 n ζ i q π ζ 1 j 0 n 1 λ u 2 j l j ζ f j ζ in the limit when n taking into account eq b11 the last relation gives the required solution in the form of a series uniformly and absolutely convergent in the domain ω2 b16 v 20 ζ i q π j 0 λ u 2 j l j ζ f j ζ we rewrite this solution as v 20 ζ i q π c 1 m 1 ζ j 0 λ u 2 j λ u 2 c 1 l j 1 ζ m j ζ c 2 l j ζ m j ζ c 3 l j ζ l j 1 ζ returning now to the z plane we use relations b3 b5 b14 b16 and obtain c 1 m 1 ζ z i λ z i a 1 λ u 2 c 1 l j 1 ζ m j ζ i λ 2 u 2 j 1 z a j 1 z b j 1 c 2 l j ζ m j ζ i u 2 j 1 z a j 1 z b j c 3 l j ζ l j 1 ζ i λ u 2 j 1 z b j 1 z b j 1 where a j s 1 a u 2 j 1 a u 2 j b j s 1 u 2 j 1 u 2 j a 0 d b 0 thus v 20 z q π λ z i a 1 j 0 λ j λ 2 1 z i a j 1 z i b j 1 1 z i a j 1 z i b j λ 1 z i b j 1 z i b j 1 q π λ z i a 1 1 λ j 0 λ j 1 λ z i a j 1 z i b j λ z i b j 1 q λ π z i a 1 q 1 λ 2 π j 0 λ j z i a j or due to eq b2 v 2 z q π z i d q λ π z i a 1 q 1 λ 2 π j 0 λ j z i a j from the first equality b10 b16 and b8 one can obtain we omit simple algebra v 1 z q 1 λ π j 0 λ j 1 z i a j 1 z i a j thus the validity of eqs 11 and 13 in section 3 of the manuscript is proved 
145,darcian 2 d flows to subterranean holes are studied analytically by the methods of complex analysis and numerically by hydrus for flow towards two circular or quasi circular tunnels reconstructed as isobars generated by two sinks under a ponded homogeneous soil surface the flow nets the velocity vector fields and riesenkampf s seepage force vectors are found the position of the two tunnels is optimized using a criterion of the total area of the empty space comprised by the isobars with the admissible seepage flow rate as a constraint and the locus of the tunnels as a control variable the case of a partially filled tunnel the contour of which is composed of two conterminous isobaric and equipotential arcs is also analyzed for a grouted tunnel the refraction problem for two potential fields in two subdomains of the half plane of the seepage flow domain is solved for an arbitrary contrast between the hydraulic conductivities of the liner and ambient soil the tunnel grouting is generally eccentric with respect to the tunnel contour high hydraulic gradients in the grouting are detected which is a long term seepage harbinger for any liner materials used by geotechnical engineers keywords subterranean holes complex potential darcian velocity isobars seepage force hydrus modeling list of abbreviations and notations symbol description unit pk 62 77 polubarinova kochina 1962 theory of ground water movement vg van genuchten η ponded water depth m θ volumetric soil water content θr residual water content θs saturated water content porosity k kg saturated hydraulic conductivities m day n α vg soil parameters m 1 p pressure head m h total piezometric head p y in analytical and p z in hydrus models m t time day x y cartesian coordinates in analytical solutions m x z cartesian coordinates in hydrus m v specific discharge darcian velocity m day q1 q2 intensities of sinks seepage flow rates of tunnels m2 day d dc depth of the sink and centre of circular tunnel under the ponded soil surface m w ϕ iψ z x iy complex potential complex physical plane varaibles in analytical solutions m2 day m ϕ ψ velocity potential and stream function m2 day r radius of circular tunnel m 1 introduction subterranean openings as man made structures appeared at the dawn of human civilizations viz holes quasi cylindrical in shape and about 2 1 m in sizes into which coffins christian or wrapped dead bodies islam are placed and backfilled at a depth of 1 2 m from the ground surface of cemeteries metro highway sewage network tunnels at depths of 100 101 m horizontal wells in particular qanat falaj in oman tunnels tapping unconfined alluvium aquifers at depths of 101 102 m repositories of nuclear waste in deep rock at depths of 102 103 m civil defense bunkers of wwi wwii in the urban infrastructure at depths of 100 101 m among others these openings hereafter called tunnels are of a regular shape and well known loci orientation with respect to the vector g of gravitational acceleration natural uncontrolled subsurface openings intersperse the soil and rock continuum large gardens and crop fields areas have an intricate network of holes made by subterranean mammals e g shrewmice pocket gophers moles opossums voles and raccoons 10 1 100 m holes made by social insects in their nests and adjacent soils 10 3 10 2 m wild desert trees and shrubs generate multiple holes made by plants roots which in arid deserts can span 60 70 m deep catacombs of karst caves and cavities among others these holes unlike engineered entities are irregular in their location and orientation see e g photos in the chapter tunnel erosion in zhu and xu 2021 all types of the abovementioned openings hereafter called tunnels are subject to seepage of ambient pore water which commonly percolates down the soil water interacting with the tunnels can originate from rainfall irrigation and ponding of the ground surface by flash floods among others moreover some tunnels are often purposely constructed deep in the beds of shallow lakes lagoons or even seafloors e g for masking the icbm structure or storing nuclear wastes e g the swedish final repository near forsmark 60 m deep under the floor of the baltic sea seepage flows into tunnels and in their vicinity is a crucial phenomenon determining their very sustainability and operational efficiency for example seepage into a tunnel of a london tube is a great nuisance intensive seepage of the highest possible flow rate is the only motivation to construct a qanat falaj hydraulic structure railroad highway urban dam and water transportation tunnels vary in their technical specifications see e g ashjari et al 2019 british 2014 chen et al 2017 2016 hornero et al 2021 jin et al 2016 li et al 2022 2021 preene and chrimes 2021 wang et al 2019 wu et al 2020 xu et al 2021 xue et al 2021 but most of them are subject to the inrush of the ambient groundwater with ensued hazards to the structures and ambient environment ecosystems e g subsidence of the ground surface hydrologists hydrogeologists soil physicists and civil geotechnical groundwater and military engineers studied numerically and analytically 2d 3d steady state or transient seepage into a solitary tunnel or a cluster of 2 3 tunnels either grouted or not placed in homogeneous or heterogeneous isotropic or anisotropic soils which were posited to be porous double porous or fractured media continua the skeleton was assumed to be either rigid or deformable and groundwater either compressible or incompressible see e g aghdam et al 2021 an et al 2021 butscher 2012 dassargues et al 2021 el tani 2003 2010 farhadian and katibeh 2017 fernandez and moon 2010a b font capó et al 2011 fujii and kacimov 1998 gattinoni and scesi 2010 gokdemir et al 2021 2022 gong et al 2018 guo et al 2021 hassani et al 2018 houben et al 2022 huang et al 2021 huangfu et al 2010 kacimov 2005 2007a 2009 kolymbas and wagner 2007 lei 1999 li et al 2018 liu and li 2021 maleki 2018 mityushev and adler 2019 park et al 2008a b perrochet 2005a b perrochet and dematteis 2007 qin et al 2020 shahbazi et al 2021 su et al 2017 sweetenham et al 2017 tang et al 2018a b wang et al 2008 wu et al 2021 yang and yeh 2007 yang et al 2016 2021 ying et al 2018 wang et al 2014 zhang and franklin 1993 zhang et al 2020a while the darcy law for the saturated or unsaturated pore water motion is postulated the hydraulic gradients close to tunnels contours are often so high that non darcian corrections are necessary see e g he et al 2021 zhang et al 2019 2020b mathematically boundary value problems bvps to the elliptic e g laplace s advective dispersion and modified helmholtz s or parabolic e g nonlinear richards richardson and linear nonlinear boussinesq diffusion pdes are formulated the tunnel itself and the seepage feeding boundary are commonly assumed to be a horizontal equipotential and therefore isobaric line or surface a slightly curved water table with accretion is commonly approximated by a horizontal isobar the tunnel itself is assumed to be either a circular or quasi circular isobar or equipotential contour when the seepage bvp is solved i e the flow net the scalar field of pore pressure and the vector field of the darcian velocity are determined the analysis of strains stresses determines the stability of the tunnel s slopes the tunnel s roof zone is most risky and near tunnel skeleton for stability all types of soils deformations erosion and collapsing suffusion colmation heaving sliding etc see e g fernández and alvarez 1994 ivars 2006 lee and nam 2001 2004 lee et al 2006 pand and dias 2016 verruit and booker 2000 zhang et al 2014 should be avoided if this geomechanical examination of the tunnel and its soil vicinity detects unstable conditions regimes seepage induced deformations or soil s degradation then protection measures drainage and lining are designed constructed however a rigorous mathematical analysis of seepage into clusters of tunnels and grouted tunnels is missing specifically in this paper we present new analytical and numerical solutions to bvps for seepage flows towards a two empty tunnels b a tunnel partially filled with water c a grouted tunnel we answer the following main questions how much pore water seeps into the tunnels are the soils and liners around the tunnel able to withstand the pore pressures their gradients hydraulic gradients and seepage forces moreover from the ontological azimuth we believe that most modern modelers in subsurface mechanics except strack 2017 and his group and a few others like tong et al 2022 have abandoned the powerful methods of the theory of holomorphic functions developed mastered and applied to the problems of agricultural horizontal drainage by vedernikov 1939 and polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 indeed most of the above reviewed analytical solutions to bvps are obtained by the methods of images and fourier series expansions applied to a harmonic function piezometric head our analytical and hydrus solutions presented below give the spectrum of seepage characteristics simultaneously the flow net piezometric head and stream function pore pressure distributions vector fields of the darcian velocity hydraulic gradients and the riesenkmapf s seepage force function see pk 77 thus in this paper we expand and despite our focus on the subsurface gaya pluto s realms astronomize the analysis of seepage to tunnels including ones still invisible from the space on mars but mathematically acting as equipotential and isobars kacimov et al 2022a engaging two synergetic modeling weapons the theory of holomorphic functions and hydrus 2 analytical solution for empty and partially filled tunnels we introduce the gauge pressure of pore water p p γ w p where p is the pressure head γ w ρ g ρ is a constant water density and g is the magnitude of gravity acceleration the richards richardson equation see e g radcliffe and šimůnek 2010 governs the dynamics of pore water in both saturated and unsaturated forms 1 θ t k p h in eq 1 is the nabla operator in cartesian coordinates oxy see fig 1 a which illustrates a vertical cross section θ t x y is a volumetric water content k p is the hydraulic conductivity function and h t x y p y is the total piezometric head in fully saturated homogeneous isotropic soils k p k const the saturated hydraulic conductivity then for steady state or transient flows without free boundaries e g phreatic surfaces eq 1 is reduced to the laplace equation 2 δ ϕ t x y δ ψ t x y δ p t x y 0 where δ is the laplacian operator φ t x y ψ t x y is the dyad of harmonic functions viz ϕ t x y k h v is the specific discharge potential also called velocity potential by pk h t x y p y is the total piezometric head v t x y is the vector of specific discharge and ψ is the stream function conjugated with φ via the cauchy riemann conditions see e g pk 62 77 and strack 2017 we introduce a complex physical coordinate z x i y complex potential w φ iψ and complexified darcian velocity v u i v where u t x y and v t x y are the horizontal and vertical components of the specific discharge vector the function w z is holomorphic and v z is antiholomorphic pk 62 we also introduce the riesenkampf force per unit volume of a saturated porous medium see pk 77 for more details which is the vector f r t x y γ w i 1 θ s γ s γ w j ξ where ξ t x y p γ0 y γ0 θ s γ w 1 θ s γ s and γ w γ s and θ s are the specific weights of water solid particles which make the porous medium and porosity respectively the force potential ξ t x y is also a harmonic function this force was evaluated in kacimov and obnosov 2016 for problems of subsurface irrigation where seepage from buried emitters can cause the heaving of the soil surface above them in tunnels which are under construction 3 d effects of seepage near an advancing not lined and not grouted tip of the tunnel see e g chen et al 2022 hong et al 2010 zingg and anagnostou 2018 are ignored in our analysis 2 1 two empty staggered tunnels with their centers connecting segment collimated with gravity in this subsection we study analytically the case of two empty circular tunnels staggered in such a manner that the line connecting their centers c 1 the upper tunnel and c 2 the lower tunnel is parallel with the vector of gravity g see similar settings in guo et al 2021 huang et al 2020 the emptiness of the tunnels is engineeringly ensured by perfect drainage of water dripping exfiltrating into them the distance between the tunnels centers is a their radii are r 1 and r 2 and the depths of the centers counted from the horizontal soil surface ox are d 1 and d 2 water seeps in the lower half plane of fig 1 with two circles cut of this half plane i e the flow domain g z is mathematically triply connected bounded by two circles and a straight line ox a degenerated circle in fig 1a we show the case of a soil surface ponded by a layer of static water of a depth h obviously p h and φ kh along ox and p 0 along the tunnels circumferences we recall that vacuum drainage has been tested in clayey soils see e g grigor ev 1973 in vacuumed tunnels the boundary condition along the tunnels contours should be p pv where pv is a positive constant determined by the vacuum creating air pump vice versa if flooding ponding of soil is fast then the pore air can be piston displaced by imbibing water into the tunnel and therefore the excess positive pressure p pv can be maintained in a dead end subterranean opening like a dead root hole in fig 1b we follow pk 62 and select point i infinity as fiducial i e assume that at this point ψ 0 w kh on the riemann sphere the infinity is imaged by a single point i albeit this point triplicates in the physical plane of fig 1a and our hydrus models below we also follow pk 62 and vedernikov 1939 and assume that the pore water is stagnant at infinity i e v 0 which hydrogeologically means that soil is subtended by an impermeable horizontal bedrock no flow boundary in other words if there are no tunnels then there is no seepage a deep drainage layer or a deep water table can be alternative infinity conditions kacimov et al 2022b pk 62 instead of a ponded soil surface we can also consider the case of tunnels placed under a phreatic surface which is formed by recharge of intensity e from the vadose zone fig 1b where only one tunnel is depicted through which the rain or irrigation water infiltrates in the case of a deep tunnel and free deep drainage to infinity the free drainage boundary condition in hydrus see simunek et al 2018 a steady state phreatic line a dashed curve in fig 1b is only mildly depressed above a seeping tunnel hence this curve can be approximated by a straight horizontal line and mathematically we arrive at the case of flow in fig 1a see e g butscher 2012 if e and the tunnel sizes are small then unsaturated flow takes place near what in soil physics is commonly interpreted as a subsurface cavity which can act as an impermeable barrier philip 1998 kacimov 2007a kacimov et al 2022b yucca mountain deep subsurface structures in nevada where e is small were also investigated as potentially impermeable subterranean openings see e g philip 1998 the topology of seepage flow in fig 1a is characterized by a four branched separatrix and a stagnation point s the two separatrix branches the curved streamlines sls and srs start from the soil surface and end at point s located between the tunnels the remaining branches straight streamlines sb 1 and sa 2 start at s and end at the bottom point b 1 of the upper tunnel and apex a 2 of the lower tunnel respectively the segment slsr of the ponded surface feeds the upper tunnel with the flow rate q 1 the lower tunnel is fed by the rays isl and isr with the flow rate q 2 shi et al 2020 studied topologically similar seepage regimes to vertical wells i e ignoring gravity and zero pressure boundaries for a single tunnel drain vedernikov 1939 and later pk 62 used the method of images and showed that a strictly circular drain completely filled with water i e a constant piezometric head drain can be modeled by a line sink placed at a certain depth d such a sink generates a family of equipotential lines circles each centered at a certain depth larger than d two families of streamlines semi circles are orthogonal to the equipotential circles fujii and kacimov 1998 hereafter fak 98 used the vedernikov solution and showed that the isobar p 0 generated by a line sink albeit not exactly circular can be considered as a quasi circle of a vertical diameter dv and a horizontal diameter dh fig 2 sketches these isobars as solid line ovals strictly circular tunnels contours modeled in section 4 below deviate from these ovals in the same sense as the vedernikov 1939 see also pk 62 77 equipotentials generated by line sinks deviate from strict circles which physically model the lines of contact between gravel packs of horizontal drains and the ambient saturated soil if deviations of isobars in our paper or vedernikov s equipotentials from circles is insignificant then empty tunnels or drains can be approximated by line sinks in other words if at a given sink s depth d its strength q is not too high then the isobar is almost circular i e dv dh 2r and the depth of the sink is almost the same as the depth of the center of the circular tunnel fak 98 also optimized the placement of an empty quasi circular tunnel under the ponded surface viz they proved that an empty tunnel of a given size diameter or cross sectional area seeps at a minimal flow rate qm if placed at a depth dm such an optimum is intuitively clear and follows from the rolle theorem indeed if in fig 1 for a given solitary circular tunnel d 1 r 1 then obviously q 1 while at d 1 the flow rate also blows up q 2 the method of superposition of singularities real and fictitious for modeling of saturated and unsaturated flows is implemented see appendix a similarly to kacimov 2007b kacimov and al maktoumi 2019 kacimov and obnosov 2016 2018 and kacimov et al 2018a b 2019 2020 since p φ k y obtaining the contours of tunnels isobars from eq a2 in appendix a is reduced to the solution of the following implicit equation 3 f x y q 1 2 π ln x 2 y d 1 2 x 2 y d 1 2 q 2 2 π ln x 2 y d 2 2 x 2 y d 2 2 h y 0 we introduce dimensionless quantities h p x y d 1 d 2 d s a d v 1 d v 2 d h 1 d h 2 h p x y d 1 d 2 d s a d v 1 d v 2 d h 1 d h 2 h a r a r h 2 q 1 q 2 ϕ ψ w q 1 q 2 ϕ ψ w k h v v k f r f r γ w and for the sake of brevity drop s from them we used the routine contourplot of wolfram s mathematica 1991 and in fig 3 a plotted the dimensionless isobars p 0 and 0 4 for d 1 1 d 2 2 q 1 q 1 2 1 q 2 q 2 2 2 as well as the streamlines 1 1 all our mathematica programs are open codes and can be shared with the referees readers the two contours p 0 are almost circular and therefore can serve as an excellent approximation of circular tunnels in fig 1a obviously the streamlines in fig 3a are not orthogonal to isobars the segment a 1 o between the surface and top of the upper tunnel is a branch cut fig 3b shows the isobar p 0 and p 0 5 for the same d 1 d 2 q 1 as in fig 3a but for a relatively large value of q 2 cr 1 9988 in this critical case the isobar p 0 is made of two coalescing contours in fig 3c the vicinity of the two osculating components of this tunnel is zoomed the flow net is shown for the right half of the flow domain with equal and regular increments of 0 26 and 0 35 for the equipotential lines and streamlines which are shown by dashed and solid lines respectively at the point in indicated in fig 3c the streamline ψ 2 1 and equipotential line ϕ 1 04 cross the tunnel contour at this point it is evident that the streamline is not orthogonal to the line p 0 with a further increase of q 2 keeping other parameters in this example constant one can not get two disconnected isobaric contours p 0 i e two staggered tunnels in fig 1a can not even be approximated by two mathematical sinks still the equation p 0 x is solvable but with only two roots if q q 2 cr a single p 0 subsurface opening of a fancy dumbbell shape can be modeled by two sinks two or more log singularities could be used to model an elongated isobaric shape that might look like the cross section of a typical qanat tunnel ebrahimi et al 2021 similarly to what is done by the superposition of a line source and a line sink when impermeable rankine bodies are obtained as streamlines separatrices see e g kacimov and obnosov 1997 warrick and fennemore 1995 similarly to variation of q 2 up to its upper bound q 2 c we varied q 1 and d 1 in the range 0 d 1 d 1 cr and d 2 in the range d 2cr d 2 these results are skipped over for the sake of brevity we used the findroot routine of mathematica to solve eq 3 in which we put x 0 with respect to y we find ya 1 yb 1 ya 2 yb 2 and vertical diameters of the tunnels dv 1 and dv 2 fig 4 a shows dv 1 d 2 for q 1 1 d 1 1 and q 2 2 curve 1 and q 2 1 curve 2 fig 4b shows dv 1 d 1 for q 1 1 d 2 5 and q 2 2 curve 1 and q 2 1 curve 2 in fig 4c the curves dv 2 d 2 are plotted for q 1 1 d 1 1 and q 2 2 curve 1 and q 2 1 5 curve 2 in fig 4d the curves dv 2 d 1 are plotted for q 1 1 d 2 2 and q 2 2 2 curve 1 and q 2 2 curve 2 the horizontal sizes of the tunnels are determined slightly differently from fak 98 specifically we have to find both the ordinates and abscissae dh 1 2 and dh 2 2 of m 1 and m 2 i e the tunnel s contour points most protruding to the right in fig 2 for this purpose we used mathematica to evaluate the function f 1 x y dx dy along the isobars p const we skip over the lengthy explicit expression for f 1 for the isobar p 0 the points m 1 and m 2 have the derivative dx dy 0 consequently for a given d 1 d 2 q 1 q 2 we solved the system of two equations 4 f x y 0 f 1 x y 0 with respect to x and y the findroot routine of mathematica solved the system 4 with an initial guess point close to 0 d 1 for the upper tunnel point m 1 and another initial guess point close to 0 d 2 for the lower tunnel point m 2 the roots xm 1 and xm 2 computed by mathematica were eventually doubled to get dh 1 and dh 2 in fig 2 fig 5 shows the horizontal sizes of both tunnels dh 1 d 1 and dh 2 d 1 curves 1 and 2 respectively for q 1 1 q 2 1 and d 2 2 the dimensionless area ar π dv 1 dh 1 dv 2 dh 2 4 of both tunnels was evaluated by approximating their shapes as ellipses having semi axes xm 1 dv 1 2 and xm 2 dv 2 2 fig 6 a illustrates the dependence ar d 1 for q 1 1 d 2 2 and q 2 1 0 8 and 0 6 curves 1 3 respectively the curves have a global maximum local minimum and two end extrema for example curve 2 has a global end minimum at d 1 0 and a global maximum at d 1 0 425 that comports with the optimization in fak 98 the local minimum and the local end maximum are however surprising in fig 6b ar d 1 is plotted for q 1 1and q 2 2 and 1 curves 1 2 correspondingly with the distance a between tunnels centers fixed again analogously to fak 98 a single maximum is attained at a certain depth of the dyad of tunnels e g armax 0 051 at d 1 max 0 66 for the first curve there is a limitation for the quasi elliptic approximation of tunnels shapes which we used the isobar p 0 at the values of tetrad s parameters close to the critical can resemble axial sections of a teardrop see fig 3b or beetroot which is weird in the application to tunnels the ordinate of the stagnation point ys ds is found as the solution of the equation v 0 y 0 the complexified specific recharge is v z d w d z where the overbar means complex conjugation pk 62 then from eq a1 we get 5 v z q 1 π d 1 z 2 d 1 2 q 2 π d 2 z 2 d 2 2 from eq 5 at x 0 we get an equation with respect to y for detection of point s 6 v y q 1 π d 1 y 2 d 1 2 q 2 π d 2 y 2 d 2 2 0 unlike the previous transcendent equations above which we tinkered by findroot eq 6 is a quadratic equation that has two explicitly found real roots we selected a physically meaningful value negative 7 y s d 1 d 2 2 q 1 d 2 d 1 2 q 2 d 1 q 1 d 2 q 2 for the parameters d 1 1 d 2 2 q 1 1 and q 2 2 this gives ds 1 27 next we put the root 7 back into eq a2 where we also set x 0 and get the potential at point s for the parameters in fig 3a this gives ϕs 0 63 that in the complex potential plane determines the locus of the tip of the cut gw fig 2 the distribution of the magnitude of the dimensionless riesenkampf s resultant force fr along the y axis is plotted for d 1 1 d 2 2 q 1 1 q 2 2 the ratios of specific gravities of water and solid particles γs γw 2 65 and porosity θ s 0 4 fig 6c d and e show the modulus of the riesenkampf force along the rays oe 1 e 1 e 2 and e 2 i respectively the maximum force occurs along the perimeters of the two tunnels at four points which are found by solving the equation p 0 y 0 the roots of these equations are yr 0 97 1 03 1 93 2 06 depending on the initial guess point along the ordinate axis the dashed rays intersecting the curves in fig 6c e are called the tunnel perimeters on the graphs for these six parameters the force attains a minimum value of zero at two points on the symmetry line y 1 152 and y 2 624 these minima are found by the findminimum routine of mathematica 2 2 single partially filled tunnel in this subsection we consider a single tunnel partially filled with static free water we use vedernikov s 1939 solution a special case of q 1 q q 2 0 d 1 d see eq a1 the source of this water inside the tunnel can be either seepage from a saturated ambient soil or conveyance of water from somewhere in the direction perpendicular to the oxy plane the trick now is to combine the isobar p 0 generated by a single sink of intensity q 2q and placed at the depth d with certain equipotential lines φ φ1 φ2 φ3 φ4 these lines are circles centered at points z d e1 d e2 d e3 d e4 and have the radii r 1 e r 2 e r 3 e r 4 e see vedernikov 1939 obviously there is a double inequality limitation φ m φ i φ m i e not all equipotential circles 1 φ i generated by a sink and determined by parameters q d intersect the contour p 0 generated by this sink fig 7 a and b shows the case of q 5 and d 1 the dashed contour is the isobar p 0 a complete flow net is presented in fig 7a with streamlines labeled for the right half of the flow domain the isobar p 0 is plotted as a dashed line three equipotential lines ϕ 0 7 1 4 and 1 6 are also plotted fig 7a illustrates that the streamlines vedernikov s 1939 circles are not orthogonal to the quasi circular isobaric tunnel contour while they are orthogonal to the equipotentials also vedernikov s circles in fig 7b we sketched the right half of fig 7a a segment of the equipotential line ϕ 0 7 together with the upper part of the isobar p 0 makes a tunnel contour which is filled with water up to the point t1 this point is an intersection of the two curves ϕ 0 7 and p 0 thus the contour at 1 bt seeps as a line sink the horizontal segment t1t2 represents the free surface of static water in the tunnel another partially filled tunnel of the same q is made by a segment of the equipotential line ϕ 1 4 which together with the upper part of the same isobar p 0 makes another tunnel contour this tunnel is filled with water up to point n 1 which is an intersection of the two curves ϕ 1 4 and p 0 thus the contour an 1 bn in fig 7b seeps as a line sink the horizontal segment n 1 n 2 represents the free surface of static water in the second tunnel the futile equipotential ϕ 1 6 is shown in fig 7a but not in fig 7b because this equipotential contour does not intersect with the isobar p 0 i e this equipotential line is physically useless we used the mathematica routine findroot to solve a system of two equations φ x y φ i p x y 0 with respect to x and y for example for φ φ n 1 4 we got xn 1 0 36 and yn 1 1 4 the maximum φ m for this sink is 1 517 the equipotential circle touches the isobar internally i e there is almost no static water in the tunnel and the minimum φ m for this sink is 0 419 the equipotential circle touches the isobar externally i e the tunnel is almost full of water 3 analytical solution for saturated seepage to grouted tunnel in this section we present an explicit and rigorous analytical solution to 2 d steady saturated seepage towards a solitary grouted tunnel placed under a ponded surface ox fig 8 the soil hydraulic conductivity is now k and the hydraulic conductivity of the grouting also modeled as a darcian porous medium is k g these quantities are arbitrary but unlike the problems of seepage to horizontal drains or vertical wells for which gravel packs filters are made of materials with k g k see e g kacimov and obnosov 2018 in wells with skin effect obnosov et al 2010 and for grouted or lined tunnels an opposite inequality holds k k g i e seepage into the tunnel is inhibited the two porous media are separated by a circumference of a radius r in dimensional quantities centered at point z i dc an empty tunnel is modeled by an isobar p 0 fig 8 this contour is generated by a line sink of intensity q 2q the sink is placed at a depth d eccentric with the interface between the two media the seepage domain gz is made of two subdomains s 1 z z i d c r im z 0 and s 2 z z idc r obviously 0 dc r d dc r the solution trick is the same as in section 2 we reconstruct an isobar p 0 and if it is almost circular then this line is interpreted as a contour of an empty tunnel by varying d we get an almost annular or eccentric grouting zone of conductivity kg while the interior of the dashed contour in fig 8 is discarded similarly zhukovsky placed a vortex in the interior of his airfoils zhukovsky 1949 and discarded a subdomain of his flow domain which is demarcated by a separatrix obtained by superposition of the vortex and dipole at infinity ambient unidirectional flow of an ideal fluid in the notations of this section the solution is written in terms of two complex potentials and darcy s laws with two contrasting hydraulic conductivities w 1 φ1 iψ1 φ1 kh 1 v 1 ϕ 1 and w 2 φ2 iψ2 φ2 kgh 2 v 2 ϕ 2 p 1 φ1 k y p 2 φ2 kg y defined in the exterior and interior of the circle in gz of fig 8a for further comparisons with hydrus below we will keep dimensional quantities along the interface between s 1 and s 2 the refraction conditions hold 8 ϕ 1 k ϕ 2 k g ψ 1 ψ 2 the derivatives of the complex potentials are v 1 d w 1 d z and v 2 d w 2 d z functions v 1 and v 2 should obey the conditions of the abscissa axis acting as an equipotential line and static pore water at infinity im v 1 x 0 x v 1 0 the refraction boundary condition written in a complex form should be met along the circular interface between s 1 and s 2 viz 9 2 k g v 1 τ k k g v 2 τ k g k r 2 τ i d c 2 v 2 τ τ i d c r where τ is a complex variable along the circumference in fig 8 which we recall is the line of mechanical contact between the soil and grouting medium the refraction condition in this form is common in the theory of holomorphic functions see e g the review by zverovich and litvinchuk 1968 and the book by litvinchuk 2000 p 135 eq i eq 9 incorporates two refraction conditions 8 usually formulated in real rather than complex variables viz the continuity of the pressure piezometric head and the normal component of the two flux vectors across the interface see e g pk 62 and strack 2017 our problem is closely related to the refraction problem for two arbitrary circles with conductivity contrasting with that of the plane an exact analytical solution of the latter problem was obtained by obnosov 2011 for a general case of arbitrary singularities not only sinks sources we solved the problem 8 and 9 using the same method as in obnosov 2011 the details of derivations are presented in appendix b in s 2 the complexified darcian velocity is an antiholomorphic function everywhere except a simple pole at z i d therefore its complex conjugate function v 2 z can be represented as follows 10 v 2 z q 2 π z i d v 20 z where v 20 z is holomorphic in s 2 the characteristic function v 20 is written as 11 v 20 z q λ 2 π z i a 1 q 1 λ 2 2 π n 0 λ n z i a n the following notations are introduced in eq 11 12 λ k r 1 k r 1 a n t u 2 n a t z s 1 z 1 z s d c 2 r 2 a d s d s u 2 d c s d c s where kr k g k is a dimensionless conductivity ratio points is are symmetrical to each other about the real axis and the circle s 1 an s when n tends to infinity the characteristic function v 1 in s 1 is 13 v 1 z q 1 λ 2 π n 0 λ n 1 z i a n 1 z i a n the complex potentials in s 1 and s 2 are obtained by integration of eqs 10 11 and 13 with respect to z integration of eq 13 is done from z 0 to z point z 0 is fiducial i e at this point w 1 0 1 then we get 14 w 1 z q 1 λ 2 π n 0 λ n log i a n z i a n z 1 in eq 14 the branches of logarithmic functions are fixed in the z plane with a branch cut from ian to ian through infinity the branches vanish at the point z 0 integration of eqs 10 and 11 is done from the point ag in fig 8 viz from z i dc r to z at point ag the refraction conditions see pk 62 have to be met im w 1 i d c r im w 2 i d c r 0 k r re w 1 i d c r re w 2 i d c r then we obtain 15 w 2 z q 2 π log z i d i d r d c q λ 2 π log z i a 1 i r d c a 1 q 1 λ 2 2 π n 0 λ n log z i a n i r d c a n k r w 1 i d c r in eq 15 the branches of all logarithmic functions vanish at the point i dc r all branches are fixed in the z plane with a cut from the points ian up to infinity except for the first term on the rhs of eq 15 for this logarithm the branch cut extends from the point z id down to infinity we note that analytical solutions for seepage to an empty grouted tunnel reported and used by fernandez and moon 2010a li et al 2018 qin et al 2020 wang et al 2008 wu et al 2021 yang et al 2016 and ying et al 2018 do not take into account and do not even articulate the phenomenon of refraction on the interface between soil and grouting specifically seepage to either a sink and sink generated zero pressure quasi circular isobar in our solution above or a circular isobar with an annular liner sheath is always 2 d in both s 1 and s 2 subdomains of the half plane of fig 8 this is evident from eqs 11 and 13 or eqs 14 and 15 which represent the superposition of an infinite number of sinks and sources for each of which flow is 2 d in fig 9 we show the grouting circumference of a radius r 0 5 m dimensional quantities are used for further comparisons with hydrus results in section 4 in fig 9 a and b computations were carried out for d 1 1 m dc 1 m and q 5 m2 day the series are truncated by n 50 terms the streamlines ψ1 and ψ2 0 0 5 1 1 5 2 2 5 m2 day thin lines are found by the separation of the imaginary part in eqs 14 and 15 the tunnel contour p 0 labeled dashed line is determined using φ1 and φ2 obtained by the separation of the real part in eqs 14 and 15 panels a and b in fig 9a and b illustrate the cases of kr 0 3 and 0 1 respectively obviously the streamlines inside the dashed curve i e in the air zone of the tunnel are unphysical the reconstructed quasi circular tunnel contour has the vertical size dv which is evaluated as the difference in the ordinates of the uppermost point at on the isobar p 0 and its lowermost point bt we used again the mathematica routine findroot to solve the equation p 2 0 y 0 and determined the loci of these points for panels a and b in fig 9 the roots i e the y coordinates of at and bt are 0 689 m and 1 41 m for a and 0 577 m and 1 72 m for b consequently the corresponding tunnels diameters dv are 0 72 m and 0 87 m one has to be cautious with the above described procedure of reconstruction of the p 0 isobar specifically if q in the examples of fig 9 increases above a certain critical value then a negative pressure zone emerges in the soil beneath point bg in fig 8 in this case the whole solution 14 and 15 albeit mathematically formally correct can not be applied to the problem of seepage to a grouted tunnel since the basic assumption in the conceptual model of this section is that the soil and grouting seep under non negative pore pressures to illustrate this we placed the sink in fig 9c and d as d 1 25 and d 0 6 respectively in fig 9c the isobar p 0 is slightly below point bg in fig 9d with a sink hoisted with respect to the center of the grouting circle the isobar p 0 is bulging above point ag in fig 8 i e protruding into the aquifer both cases in fig 9c and d can be considered as a failed grouting albeit mathematically dc and d in fig 8 and our analytical solution can be arbitrary fig 9e presents mathematica plotted with the help of the contourplot routine isotachs v 1 2 const for d 1 3 m dc 1 m q 2 m2 day and kr 0 01 the circular interface between the soil and grouting is a circle of a radius r 0 5 m the grouting air interface is plotted as a dashed quasi circle which has dv 0 92 m in this case the contrast in hydraulic conductivities of two porous subdomains of gz is so high that n 50 is not enough in eqs 10 11 and 13 we increased summation in the series up to n 150 terms to achieve the following convergence criterion at points ag and bg the velocities v 1 and v 2 from the soil and grouting sides of the interface have to coincide up to the third digit obviously the isotachs v 2 inside the dashed contour in fig 9c have to be discarded in the context of the tunnel problem the computed isotachs clearly show that thicker grouting of the tunnel in its roof zone helps in reducing the darcian velocities there which however remain dangerously high in the vicinity of point bg the tunnel floor where the grouting is thin we recall that pk 77 formulated a criterion inequality of seepage induced instability in darcian flows the magnitude of the hydraulic gradient in an unconsolidated soil obeys v 1 k 1 in our dimensionless quantities if the gradient is less than 1 e g between the contour and the grouting soil interface in fig 9e where 1 v 1 k 0 8 then the soil may still be unstable to internal erosion suffusion in the degenerate case of kr 1 no grouting section 2 for the set of parameters in fig 9c i e a single tunnel generated by a sink at d 1 3 m and q 2 m2 day we have a much smaller size dv 0 0038 m i e grouting does comprise a large tunnel s area of the same q on the other hand if we fix dv 0 92 m then a tunnel without grouting will have a much larger q 8 2 m2 day as compared with the grouted case in fig 9c i e kr 0 01 is an efficient counter seepage measure it is noteworthy that unlike the case of formation damage and skin effect in aged wells see e g houben and treskatis 2007 which is detrimental to wells productivity suffusion and translocation of finest particulates of a porous medium lessivage in the vernacular of soil pedology towards the grouting circle in figs 8 and 9 is a positive phenomenon indeed if the near grouting soil gets extra clogging accrued by a long lasting seepage this will only bolster the main mission of the anti seepage aim of grouting by shifting the sink up and down with respect to the center of the grouting circle in fig 8 which can also be an engineering design parameter i e by the effects of eccentric boundaries we can fortify the tunnel from seepage where it is critical optimization of the liner thickness and of the locus of the tunnel itself with purely seepage related criteria for a rigid porous skeleton of s 1 and s 2 can be a preamble of a geomechanical optimization see e g li and zhou 2015 that can be carried out similarly to section 2 we skip over this analysis for the sake of brevity 4 hydrus modeling in this section we use the finite element model fem hydrus 2d radcliffe and šimůnek 2010 šimůnek et al 2018 with the following intentions a cross compare the fem results with those obtained analytically in the previous sections b incorporate various boundary conditions e g tunnels partially filled with water rather than empty ones c model clusters of tunnels centers of which are not on the same vertical line generalizations b c are not amenable to analytical considerations for circular tunnels without any loss of generality we assume that the two tunnels are perfectly circular in their vertical cross sections fig 1a in all our computations we consider the van genuchten s vg soils šimůnek et al 2018 characterized by parameters θ r θ s α n k where θ r is the irreducible volumetric water content and α n represent the vg shape parameters we changed the notation for the vertical cartesian coordinate to z which is more common in soil hydrology 4 1 tunnels with partial filling and their center connecting line collimated with gravity in this subsection seepage is symmetric with respect to the line connecting the tunnels centers and therefore in hydrus only the right half of the flow domain is modeled in fig 10 we assume that the lower tunnel is empty while the upper one is partially filled with trickled exfiltrated water which accumulates at tunnel s bottom e g due to poor drainage we assume that both tunnels have a radius r 1 m the upper tunnel is half filled with static free water and c 1 m 1 is a horizontal air water interface the tunnel centers are placed at z 10 and 15 m in hydrus the flow domains are always finite and the following rectangle sizes in fig 10 are used lh 20 m and lv 30 m these values are large enough as compared with r to mimic the infinity in fig 1a instead of a single point i on the riemann sphere we have points i 1 i 2 and i 3 in fig 10 the segment oi 1 is ponded i e a constant pressure head p 1 m boundary condition is imposed there there is no flow across the segments i 1 i 2 i 2 i 3 i 3 b 2 a 2 b 1 and a 1 o in the upper tunnel p decreases hydrostatically from ht r 2 to 0 along the quarter circle b 1 m 1 here and in section 4 2 we consider the vg loam with θ r θ s α n k 0 078 0 43 3 6 1 m 1 56 0 25 m day a topological peculiarity of flow in this subsection is the shape and position of the separatrix unlike the case of two empty tunnels in section 2 the stagnation point st is now located on b 1 m 1 i e the constant piezometric head segment of the bottom of tunnel 1 the branch srst 1 divides all infiltrated water into two parts ponded water on the left of point sr seeps into the upper tunnel while segment sri 1 feeds the lower tunnel the separatrix branch st 1 st 2 demarcates a zone of seepage from the upper tunnel to the lower tunnel at point st 1 the separatrix kinks if the flow is governed by the laplace equation section 2 from the hodograph analysis kacimov and youngs 2005 showed that the angle between the separatrix branches at st 1 is θ 900 i e this streamline is not orthogonal to the equipotential line b 1 m 1 in fig 10 we skip over the details of the finite element meshing and the iterative solution of the richardson richards equation 2 2 all our hydrus 2d projects are publicly available and can be shared with the referees readers we solved the above stated boundary value problem bvp for this pde with the following initial condition p z decreasing hydrostatically from 31 m to 1 m when z increased from 30 m to 0 the steady state flow velocity field and streamlines are shown in fig 11 fig 11a illustrates the hydrus streamlines and fig 11b zooms the vicinity of the tunnels where the magnitude of darcian velocity is color mapped the point st 1 n with zero velocity is located between the fe node having coordinates x 0 59 m and z 10 81 m and an outflow velocity v 0 0826 cm d and the fe node having coordinates x 0 81 m and z 10 59 m and an inflow velocity v 0 095 cm d along the arc a 1 st 1 n the velocity decreases from the apex tunnel s roof to the quasi stagnation point along st 1 nb 1 the velocity increases again to 0 21 m day for the lower tunnel hydrus detects a red zone of high velocities near the exfiltrating seepage face remarkably the velocity magnitude increases from the apex a 2 where v 0 58 m day to b 2 where v 0 84 m day despite the seepage plume from its ponded bottom the upper tunnel actually hydraulically shades its lower brother which intercepts this plume indeed hydrus shows that the bottom of the second tunnel is more susceptible to seepage erosion than the roof provided the criterion of seepage induced instability is based on the magnitude of the hydraulic gradient as pk 77 conceptualized in her condition h 1of instability of saturated porous massifs we used the boundary fluxes option of hydrus and retrieved the infiltration and exfiltration fluxes as follows from the ponded soil surface a standard infiltration flux qoi 1 3 4285 m2 day the exfiltration flux through a 1 m 1 st is qin 1 0 836 m2 day this quantity is a sum of what comes through both the seepage face a 1 m 1 and a constant total head arc m 1 st the hidden infiltration flux through b 1 st to the lower tunnel is qout 1 0 128 m2 day the upper tunnel is hydrologically a flow through entity the total flow rate into the second tunnel is a sum of qout 1 and qsin 2 2 414 m2 day which is the quantity seeping through st 2 b 2 directly from the ponded soil surface the second tunnel is a gaining hydrological actor in hydrus any degree of filling ht not only r 2 as in the example above in any tunnel can be easily modeled moreover at a specific value ht in fig 10 the upper tunnel acts as a passive entity for which qin 1 qout 1 i e all water seeped into the tunnel from above is oozed back downstream for natural holes made by decayed roots of dead plants such a passive regime is the only one possible because unlike gaining loosing flow through lacustrine hydrology entities ilyinsky and kacimov 1992 kacimov 2000 2007b from which water evaporates or tunnels usually equipped with pumps for dewatering of dripped water macropores in soils do not have mechanisms to uptake the in hole water except macropores under ant domes where social insects consume trickled water 4 2 arbitrarily staggered tunnels in this subsection we consider the case of tunnels of radii r 1 and r 2 whose centers c 1 and c 2 are arbitrarily located at depths dc 1 and dc 2 fig 12 there is no symmetry in this problem and we have to consider the whole flow domain without any loss of generality with respect to tunnels boundary conditions we consider two empty unlined tunnels the centers of which are located distance j apart in the horizontal direction the hydrus cartesian coordinate system i 4 xz is selected such that both tunnels are located sufficiently far from the sides i 1 i 2 i 2 i 3 and i 3 i 4 of the simulation rectangle having sizes lh and lv and selected large enough to avoid the wall effect fig 12 fig 13 a presents the streamlines for seepage from i 4 i 1 ponded to the depth of h 1 m towards this tunnel couple in a vg loam for lh 20 m lv 30 m r 1 1 5 m and r 2 2 m and the coordinates of tunnels centers 7 m 10 m and 13 m 13 m in fig 13b the magnitude of the darcian velocity is color plotted remarkably for both tunnels the maximum darcian velocity shifted from point a 1 to the right and from point a 2 to the left for the upper and lower tunnels respectively this can be attributed to the mutual hydrodynamic shading of this tunnel dyad however these maxima about 0 35 m day along both tunnels contours are dangerously high because the gradients at this point are 0 35 0 25 1 which is above the pk limit of erosional instability of soils a stagnation point s numerically a zone rather than a point is indicated beneath the upper tunnel the total flow rate into the tunnel is q 1 q 2 5 21 m2 day and q 2 3 46 m2 day 4 3 grouted tunnels modeled by hydrus in this subsection we model in hydrus a solitary empty tunnel of a radius ri grouted by an eccentric annular liner a sheath of a radius r e such that the depths of the circles centers are d 4 m and dc 3 5 m respectively the ponding depth h 1 m the ambient soil and grouting material are made of hypothetical soils in which the hydraulic conductivity kg 0 1 m day which is 1 10 of that of the soil k 1 m day we selected lh 7 5 m lv 10 m ri 1 m and r e 2 m i e the thickness of the grouting is 1 5 m at the apex while it is only 0 5 m at the bottom the hydrus simulated flow rate into the tunnel is q 2 1 962 m2 day fig 14 a presents the streamlines with a palette of the magnitude of velocity obviously the grouting near the bottom of the tunnel is at extremely high hydraulic gradients a pressure head distribution along the vertical ordinate axis is shown in fig 14b the grouting especially the segment b 1 bg see also fig 8 is subject to extremely high pressure head gradients the v x plotted in fig 14c is needed for controlling the horizontal size of the hydrus domain viz lh should be large enough to avoid the wall effect with the criterion v 0 at point i 1 for comparisons we modeled the same tunnel and grouting using the analytical formulae of section 3 where we use q 3 924 m3 day and the depth of the sink d 4 m a quasi circular isobar p 0 has ya 1 2 62 m yb 1 4 81 m and therefore dv 2 19 m i e slightly higher than that of the hydrus tunnel circle the analytical velocity at the origin of coordinates is vo 0 23 m day while hydrus gives vo 0 2 m day the analytical pressure heads at the interface points at the ordinate axis are pa g 2 16 m and pbg 5 04 m while hydrus results are pag 2 03 m and pbg 4 4 m if we place the sink deeper in the analytical model at d 4 5 m then for the same q ya 1 2 98 m yb 1 4 99 m and therefore dv is almost the same as the hydrus circle the value of vo is now exactly the same as one in hydrus pag 2 22 m and pbg 4 76 m moreover the maximum of velocity in fig 14c is the same as in the analytical solution thus hydrus results and this solution match well consequently hydrus can be used as a design tool when the sizes of a circular tunnel and liner sheath are fixed and one wants to determine the seepage flow rate the analytical solution can be used in an inverse mode if q is fixed and the tunnel position with respect to oi 1 and the grouting circle are flexible provided that a posteriori the quasi circular shape of the p 0 isobar is checked and seepage is verified to be at positive pressures everywhere in the porous depression zone close to the tunnel bottom 4 4 phreatic flow with accretion in this subsection we consider a grouted tunnel placed under a soil surface with a given infiltration flux e which is sufficiently small not to generate surface ponding fig 1b a vadose zone is formed above the phreatic line p 0 a phreatic fringe forms above this line and below the line p pca where pca is a positive constant which characterizes this fringe as a tension saturated zone in the vedernikov bouwer model see pk 62 77 and kacimov et al 2019 the same hydrus flow domain and soils as in fig 14 are modeled with the following modification of the boundary condition along the soil surface oi1 we now do not specify a constant ponding depth but rather a constant infiltration rate e μ k where μ 1 is a constant determined by the rain intensity obviously μ should be small enough for such a condition to be physically realistic if μ is above a certain threshold value ponding of a horizontal ground surface or runoff takes place fig 15 a shows isobars as contour lines plotted in the range 0 12 p 0 2 for infiltration factor μ 0 08 the water table p 0 is a standard curve with an inflection point the contour p 0 2 is a fancy double ogive the wiggling curve p 0 12 can be considered as a kind of capillary fringe boundary the phreatic line as well as the capillary fringe caves towards the tunnel qualitatively similar to the shapes of phreatic lines in seepage through homogeneous soils in ilyinsky and kacimov 1992 and kacimov and obnosov 2021 in fig 15b the streamlines are shown for μ 0 08 this figure illustrates that immediately under the soil surface infiltration is vertical but closer to the water table the streamlines deflect to the right the shape of some streamlines is quite whimsical reflecting the impact of a draining tunnel and a refracting effect of the grouting in fig 15c isobars are plotted for μ 0 06 in this case the infiltration rate is relatively low such that the phreatic line does not overhang the tunnel an unsaturated gap is positioned above the tunnel apex above the water table a purely unsaturated but 2 d seepage occurs if μ 0 09 ponding of the soil surface occurs in the right upper part of the hydrus domain if kg is increased keeping μ constant then caving of the water table becomes more pronounced such that it cusps towards the tunnel 5 concluding remarks the case of a single quasi circular tunnel modeled by a line sink placed under a horizontal ponded soil surface is amenable to analytical treatment both if the soil is homogeneous vedernikov 1939 or piece wise homogeneous fujii and kacimov 1998 pk 77 and section 3 above the constraints and simplifications in the models used are a rigid porous matrix incompressible one phase and fully steady state saturated flows which despite potentially high hydraulic gradients near the modeled tunnels are assumed to be darcian transience can be taken into account via boundary conditions provided no free phreatic surfaces emerge if the tunnel is strictly circular then the theory of holomorphic functions still gives an analytical solution for isobaric contours in homogeneous soils mityushev and adler 2019 moreover a tunnel of any noncircular shape can be conformally mapped onto a concentric circular annulus see the bieberbach theorem 1953 as verruijt and booker 2000 demonstrated for a circular tunnel after that the dirichlet problem for a harmonic velocity potential can be explicitly solved by the villa formula in terms of schwarz integrals see e g abubakirov and aksent ev 2015 akhiezer 1970 bieberbach 1953 tong et al 2022 demonstrated this procedure for the case of a rectangular tunnel in the future we plan to utilize this technique of solving a mixed rather than dirichlet boundary value problem for a strictly circular but partially filled tunnel for the case of two circular tunnels fig 1a the problem seems prohibitively complex for analytical treatment a triply connected seepage flow domain in fig 1a still can be conformally mapped onto a canonical domain bieberbach 1953 e g a half plane with two slits the so called zhukovsky drains see pk 62 77 however to the best of our knowledge there is no explicit integral formula similar to the villa one which would solve the dirichlet problem in any triply connected domain consequently using numerical models such as hydrus is the only solid method to examine 2 d seepage towards two three and more circular tunnels the results obtained above illustrate that hydrus and analytical solutions match well the method of images vedenrikov 1939 pk 62 is used for circular interfaces between soil and air a flat ponded ground surface and soil and grouting these interfaces are considered as mirrors with respect to which lines sinks and more general hydrodynamic singularities are placed in such a manner that the physical e g the dirichlet refraction robin and other types of boundary conditions are exactly satisfied hydrus is versatile and can model any domain boundaries and interfaces for steady or transient saturated and unsaturated seepage in soils with an arbitrary type of layered heterogeneities the dyad of hydrus and the machinery of holomorphic functions allows one to model behold the intricate details of fluxes pore pressures and forces in the vicinity of invisible subterranean entities credit authorship contribution statement a r kacimov conceptualization formal analysis funding acquisition investigation methodology project administration resources software visualization writing original draft writing review editing yu v obnosov conceptualization formal analysis funding acquisition investigation methodology resources software visualization writing original draft writing review editing j šimůnek conceptualization formal analysis investigation methodology resources software visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the grants dr rg 17 and ig agr swae 22 02 sultan qaboos university oman and by the kazan federal university strategic academic leadership program priority 2030 helpful critiques and comments by two anonymous referees are appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104182 appendix c supplementary materials image application 1 appendix a the method of superposition of line sinks is widely used in analytical studies of darcian flows in well hydraulics see e g vuković and soro 1997 since the seminal zhukovsky 1949 ideas potential flows of an ideal fluid around an airfoil or their cascades are modeled by combining two singularities a real dipole which is equivalent to a unidirectional flow at infinity and a fictitious vortex placed inside the airfoil the method simplifies the analytical treatment of multiple connected domains by reducing them to a simple connected one but with compensated singularities below we follow this zhukovsky laid avenue and extend the fak 98 analysis to multiple staggered tunnels starting from a dyad of line sinks shown in fig 2 the flow domain gz is now a simply connected domain viz the half plane z 0 the characteristic function w z has two logarithmic singularities one at point e 1 z d 1 and another at point e 2 z d 2 the function v z is antiholomorphic in the half plane except points z d 1 z d 2 z ds and z superposition of vedernikov s 1939 complex potentials for two line sinks with two fictitious line sources yields a1 w q 1 2 π ln z i d 1 z i d 1 q 2 2 π ln z i d 2 z i d 2 k h we select the branches of function a1 as follows due to the symmetry of flow and the flow domain gz we consider only its right half the right bottom quarter plane in fig 2 in further hydrus modeling this will save computation time the corresponding complex potential domain gw is a half strip of a height q 1 q 2 2 with a cut e 2 se 1 fig 2 obviously from eq a1 ψ 0 along the streamline ie 2 the curved streamline srs bifurcates at point s along the cut in gw and along the straight segments se 1 and se 2 in gz we have ψ q 2 2 along the straight segments oe 1 in gz the stream function is ψ q 1 q 2 2 the value of potential k hs where hs const h at the stagnation point is a part of the solution the fak 98 trick is the isobars a 1 b 1 and a 2 b 2 in gz are determined by solving the equation p x y 0 in gw fig 2 the images of these two isobars are shown as two thick curves the loci of points a 1 b 1 a 2 and b 2 are computed by solving the equation p 0 y 0 we will show below that this equation can have four or two roots in a special case of three roots the contours of two conterminous empty tunnels coalesce in the case of four roots the corresponding tetrad ya 1 yb 1 ya 2 yb 2 is used for obtaining the vertical diameters of the two tunnels as ya 1 yb 1 and ya 2 yb 2 if the reconstructed curves a 1 b 1 and a 2 b 2 in gz are close to half circles then the two generated isobars p 0 approximate well the genuinely circular contours of the tunnels in fig 1a thus we separate the real part in eq a1 to obtain the potential a2 ϕ q 1 2 π ln x 2 y d 1 2 x 2 y d 1 2 q 2 2 π ln x 2 y d 2 2 x 2 y d 2 2 k h similarly we separate the imaginary part in eq a1 to get the stream function appendix b in this appendix we provide full details of the solution to the problem of seepage in a two component composite made of an aquifer half plane of one conductivity and a circular inclusion of a contrasting conductivity where a line sink which generates a quasi circular isobar as a tunnel contour is placed specifically we prove the validity of eqs 11 and 13 in section 3 the boundary conditions along the real axis and the circular interface between s 1 and s 2 are b1 re v 1 x 0 x v 1 0 v 1 t a v 2 t b r 2 t i d c 2 v 2 t t i d c r here a k kg 2kg b kg k 2kg and there is a line sink of intensity q 2q at the point id i e b2 v 2 z q π z i d v 20 z where the function v 20 z is holomorphic in the domain s 2 we consider the mőbius transformations of the z plane and of the ζ plane onto each other by the functions b3 ζ t 1 z z i s z i s z t ζ i s ζ 1 ζ 1 where the points is are symmetric about both the real x axis and circumference s 2 i e b4 s d c 2 r 2 the first function b2 maps conformally the lower half of the z plane onto the unit disk of the ζ plane and t 1 sk ω k k 1 2 see fig b1 we introduce the notations b5 t 1 i d d s d s a u 2 d c s d c s t ζ i a i d s ζ a ζ 1 t 2 ζ t ζ i d c i d c s ζ u 2 ζ 1 i d c s t 1 ζ we introduce new unknown functions v k ζ v k t ζ k 1 2 and omit the superscript below then using conditions b1 and notations b2 b5 we obtain b6 re v 1 τ 0 τ 1 v 1 1 0 v 1 τ a v 2 τ b u 2 t 1 τ 2 v 2 τ τ u and b7 v 2 ζ q π t 2 ζ v 20 ζ according to the first boundary condition b6 the function v 1 ζ can be analytically continued into the ring u ζ 1 u via the symmetry principle therefore the continued function we keep the same notation for it satisfies the condition v 1 ζ v 1 1 ζ and can be represented as b8 v 1 ζ v 1 ζ v 1 1 ζ where the function v 1 ζ is holomorphic in the circle ζ 1 u without any loss of generality we can assume that v 1 1 0 next we consider the following function b9 f ζ v 1 ζ a v 20 ζ b q u 2 π t 1 ζ 2 t 2 u 2 ζ ζ u a q π t 2 ζ v 1 1 ζ b u 2 t 1 ζ 2 v 20 u 2 ζ ζ u it satisfies the continuity condition f τ f τ for τ u according to the second equality b6 and due to representations b5 has a simple pole at the point ζ u 2 additionally the function f ζ is bounded at infinity and f 1 0 in comport with liouville s theorem we have f ζ c t 1 ζ where c is a constant to be determined clearly c lim ζ 1 t 1 ζ f ζ b q u 2 π t 1 1 2 t 2 u 2 i b q π d c s then from eq b9 we obtain simple algebra is omitted b10 v 1 ζ a v 20 ζ i b q d c d ζ 1 π d s a ζ 1 0 ζ u a q π t 2 1 ζ v 1 ζ b u 2 t 1 1 ζ 2 v 20 u 2 ζ i b q π d c s t 1 1 ζ ζ 1 u exclusion of the function v 1 ζ from the system b10 leads to the relation v 20 ζ λ u 2 ζ 1 2 u 2 ζ 1 2 v 20 u 2 ζ i q π λ d c d ζ 1 d s d c s a u 2 ζ 1 ζ 1 d s a ζ 1 λ ζ 1 d c s u 2 ζ 1 let b11 v 20 ζ ζ 1 v 21 ζ then we get the following functional equation with respect to v 21 ζ b12 v 21 ζ λ u 2 l 1 ζ v 21 u 2 ζ i q π ζ 1 f 0 ζ where b13 f j ζ c 1 m j 1 ζ c 2 m j ζ c 3 l j 1 ζ consequently b14 l j ζ ζ 1 u 2 j ζ 1 m j ζ ζ 1 a u 2 j ζ 1 c 1 λ d c d d s d c s c 2 1 d s c 3 λ d c s from the definitions b13 b14 follows b15 l j ζ l 1 u 2 j ζ l j 1 ζ l j ζ m 1 u 2 j ζ m j 1 ζ l j ζ m 0 u 2 j ζ m j ζ l j ζ f 0 u 2 j ζ f j ζ we replace ζ with u 2ζ in eq b12 the result of this substitution we put into the rhs of eq b12 and using the relations b15 we arrive at v 21 ζ λ u 2 2 l 2 ζ v 21 u 4 ζ i q π ζ 1 λ u 2 l 1 ζ f 1 ζ f 0 ζ we replace ζ with u 4ζ in eq b12 and substitute the result into the rhs of the last equation and so on at the n th step we obtain v 21 ζ λ u 2 n l n ζ v 21 u 2 n ζ i q π ζ 1 j 0 n 1 λ u 2 j l j ζ f j ζ in the limit when n taking into account eq b11 the last relation gives the required solution in the form of a series uniformly and absolutely convergent in the domain ω2 b16 v 20 ζ i q π j 0 λ u 2 j l j ζ f j ζ we rewrite this solution as v 20 ζ i q π c 1 m 1 ζ j 0 λ u 2 j λ u 2 c 1 l j 1 ζ m j ζ c 2 l j ζ m j ζ c 3 l j ζ l j 1 ζ returning now to the z plane we use relations b3 b5 b14 b16 and obtain c 1 m 1 ζ z i λ z i a 1 λ u 2 c 1 l j 1 ζ m j ζ i λ 2 u 2 j 1 z a j 1 z b j 1 c 2 l j ζ m j ζ i u 2 j 1 z a j 1 z b j c 3 l j ζ l j 1 ζ i λ u 2 j 1 z b j 1 z b j 1 where a j s 1 a u 2 j 1 a u 2 j b j s 1 u 2 j 1 u 2 j a 0 d b 0 thus v 20 z q π λ z i a 1 j 0 λ j λ 2 1 z i a j 1 z i b j 1 1 z i a j 1 z i b j λ 1 z i b j 1 z i b j 1 q π λ z i a 1 1 λ j 0 λ j 1 λ z i a j 1 z i b j λ z i b j 1 q λ π z i a 1 q 1 λ 2 π j 0 λ j z i a j or due to eq b2 v 2 z q π z i d q λ π z i a 1 q 1 λ 2 π j 0 λ j z i a j from the first equality b10 b16 and b8 one can obtain we omit simple algebra v 1 z q 1 λ π j 0 λ j 1 z i a j 1 z i a j thus the validity of eqs 11 and 13 in section 3 of the manuscript is proved 
146,large scale models of fluid flow through fractures are almost exclusively based on poiseuille flow the cubic law when the fracture aperture is time and or spatially varying flow is transient and or flow rates are modest r e 1 poiseuille flow predictions can deviate substantially from the full navier stokes solution and generally do not satisfy conservation of energy a new reduced dimension fracture flow rdff model is derived which more accurately predicts transient fracture flow for incompressible fluids with modest reynolds numbers the rdff model is derived from the two dimensional navier stokes equations and yields a two field model fluid flux and pressure governed by conservation of mass and momentum the rdff model conserves energy and is shown to include both poiseuille flow and forchheimer flow as limiting cases the performance of the rdff model is compared to the existing poiseuille flow model and the solution to the full navier stokes equations in three benchmarks problems the rdff model demonstrates complex transient and inertial behaviours not previously captured and produces up to 400 improvements in error over poiseuille flow in steady state flow conditions for 1 r e 100 the rdff model is demonstrated to be superior in application where the reynold s number is modest and when aperture varies in space and or time keywords fracture flow cubic law non linear flow aperture variation poiseuille flow navier stokes 1 introduction the flow of fluid through fractures is an important aspect of many natural and industrial processes in contaminant transport and groundwater flow fractures form the primary pathway for flow through low permeability rock masses nelson and handin 1978 tang et al 1981 flow in fractures is known to enhance the permeability of porous media under seismic loads elkhoury et al 2011 manga et al 2012 in engineered processes like hydraulic fracturing well stimulation and geothermal heat extraction large volumes of fluid are rapidly forced through thin fractures and fracture networks osiptsov 2017 pandey et al 2018 lecampion et al 2018 models and simulations of flow in fractures deformable or rigid are almost exclusively based on poiseuille flow the analytical solution to the navier stokes equations for incompressible and steady flow between ridge parallel plates it states that the pressure gradient is related to the mean velocity by 1 p 12 μ w 2 v 12 μ w 3 q in which w is the aperture between the plates μ is the kinematic viscosity v is the mean velocity and p is the pressure gradient witherspoon et al 1980 zimmerman and bodvarsson 1996 eq 1 is often presented in terms of the fluid flux q where it has earned the name the cubic law due to its ubiquity in modelling fracture flow in models and simulation involving deformable fractures conservation of mass is derived at the fracture scale using a control volume such that 2 w q in which q is the fluid flux given by the cubic law in eq 1 this upscaled statement of conservation of mass admits both time and spatially varying aperture in contrast to the assumptions underpinning poiseuille flow eqs 1 and 2 are widely used in fracture flow modelling and have been extended to many applications including two phase flow murphy and thomson 1993 non wetting fluid flow lee et al 2013 and hydraulic fracturing with proppant transport dontsov and peirce 2014 rivas and gracie 2020 to name a few despite its widespread use fracture flow models based on poiseuille flow have a number of limitations the underpinning assumptions are often violated including a that flow is steady b that the aperture can be locally approximated by parallel plates even beyond consideration for surface roughness c that inertial forces are negligible d that flow is laminar and e that the rock mass is impermeable the assumption of impermeable walls is often violated when poiseuille flow is applied to modelling flow through fractured porous media but this issue has previously been addressed by modifying poiseuille flow to account for the fluid leak off through permeable fracture walls berkowitz 1989 mohais et al 2012 hosseini and khoei 2021 previous works which have examined fluid driven crack propagation with alternative flow assumptions like turbulent flow dontsov 2016 zia and lecampion 2017 or non newtonian fluids garagash 2006 moukhtari and lecampion 2018 have shown that laminar flow conditions occur in a majority of industrial cases and that inertial terms are only important at very early times when the injection rate is constant however these analyses do not address the inertial effects from non parallel plate geometries small deviations will be shown to be significant or the complex transient effects that arise from new hydraulic fracturing techniques like pressure pulsing parchei esfahani et al 2020 or dynamic stress effects induced by seismicity elkhoury et al 2011 manga et al 2012 there is therefore a need for a new model of fracture flow that is capable of capturing the transient and inertial physics of flow through non parallel apertures at moderate to large reynolds numbers poiseuille flow has been extensively studied analytically numerically and experimentally much of the work has focused on the validity of poiseuille flow as it applies to surface roughness and tortuosity and modifications to poiseuille flow have been proposed to address these factors brown 1995 brush and thomson 2003 nazridoust et al 2006 he et al 2021 several studies of poiseuille flow have devised criteria for when poiseuille flow based models are appropriate zimmerman and bodvarsson 1996 zimmerman et al 1991 these recommendations on the range of applicability of poiseuille flow for fractures are often violated in modern modelling works for example in rivas and gracie 2020 and gee and gracie 2021 flow rates are applied in excess of the limits on the range of applicability while in parchei esfahani et al 2020 transient effects in the fluid are neglected by adopting quasi static poiseuille flow despite the dynamic nature of modelled pressure pulsing poiseuille flow departures significantly from the true fluid behaviour in fractures of varying aperture at even moderate reynolds numbers r e 1 experimental results of fracture flow have shown that poiseuille flow using the average aperture of the fracture produces relatively accurate results up to a reynolds number of about 10 after which flow becomes non linear witherspoon et al 1980 zimmerman et al 2004 ranjith and viete 2011 liu et al 2016 more recent reviews have shown that the onset of non linear flow behaviour can range from 0 1 r e 60 depending on mechanical factors such as shear dilation confining stresses and surface roughness yu et al 2017 the only flow model which has attempted to account for the inertial non linear flow behaviour observed at higher reynolds numbers is forchheimer flow a non linear extension originally developed for non darcian flow through porous media and adapted to fracture flow forchheimer 1901 forchheimer flow relies on an empirical coefficient to capture to the nonlinear behaviour and while there have been attempts to calibrate this empirical coefficient zimmerman et al 2004 ranjith and viete 2011 forchheimer flow rarely sees any use in modern fracture flow simulations it is important to distinguish the type of fractures for which a new reduced dimension model will be applicable fig 1 illustrates three different classes of fractures which may be described by combinations of hydraulic aperture w surface asperities ɛ and wavelength λ the first class illustrated in fig 1 a is the case where the asperities are small compared to the aperture the second class illustrated in fig 1 b is the case in which the roughness asperities wavelength and aperture are all approximately the same order these classes have been the focus of many previous efforts to modify the cubic law to account for surface roughness brown 1995 brush and thomson 2003 nazridoust et al 2006 the second class describes many natural fractures and is often grouped together with surface roughness however the transverse component of flow in this class is significant and cannot be adequately described by a reduced dimension model the third class of fractures illustrated in fig 1 c is the target application of the new model proposed in this manuscript asperities and aperture may be of similar order but the wavelength over which the aperture changes is large and locally the fracture surface is smooth this class of fracture is typically adopted as the idealized geometry for fractures in many modern fracture flow modelling works osiptsov 2017 pandey et al 2018 lecampion et al 2018 in this article an improved fracture flow model is presented it overcomes many of the limitations of the poiseuille flow model by capturing the inertial and transient behaviour of fluid flow through fractures of varying and deformable aperture in inertial dominant flow r e 1 whereas previous modelling efforts have focused on modifying poiseuille flow we start from the full set of navier stokes equations and make simplifying assumptions thereby creating a reduced dimension flow model which allows us to simplify the fracture volume into a fracture plane the new reduced dimension model is verified against the full navier stokes solution and compared to poiseuille flow in the cases of transient flow and spatially and temporally varying aperture fields we demonstrate that our new proposed model captures inertial behaviour previously neglected conserves energy in fractures where poiseuille flow does not and more accurately models transient and steady state flows through fractures with spatially varying aperture in the following section the prevalence of high reynolds number flows in practice is discussed in section 2 a reduced dimension formulation for flow through fractures of deformable aperture is developed and the cases of laminar and turbulent flow are discussed section 3 provides a physical interpretation of each term in the reduced dimension model and examines a number of corollaries which can be derived from the reduced dimension model next section 4 verifies the model with several analytical and numerical problems in which the reduced dimension model is compared against both poiseuille flow and the full navier stokes solutions the models are compared both qualitatively and quantitatively last section 5 summarizes the findings and conclusions 1 1 prevalence of high re flow in practice given the ubiquity of the poiseuille flow model for fracture flow it is reasonable to ask how often non poiseuille flow conditions r e 1 occur in practice first consider a kgd type planar fracture along a wellbore as illustrated in fig 2 a assuming that the rock mass is rigid w 0 the reynolds number is given by the fluid viscosity and density μ and ρ f the total flow rate q and the fracture height h such that r e q ρ f μ h given a fluid with a density of ρ f 1000 kg m 3 and a fracture height of 100 m then the range of reynolds numbers for viscosities and flow rates are given in table 1 the range of flow rates considered suggest that most forced fracture flow applications can expect flows in which inertial forces are dominant over viscous forces r e 1 next consider a radial fracture emanating from a wellbore as illustrated in fig 2 b assuming that the rock mass is rigid w 0 the reynolds number is given by the fluid viscosity and density μ and ρ f the total flow rate q and the radial distance r such that r e q ρ f 2 π μ r therefore the reynolds number decreases radially from wellbore given a constant total flow of q 60 m 3 h for a fluid with a density of ρ f 1000 kg m 3 then the reynolds number for various viscosities at various radial distances is given in table 1 for a 20 cm diameter wellbore very high reynolds numbers occur near the wellbore and while the reynolds numbers decrease rapidly the fracture must extend over 100 m to reach a viscous dominant flow regime r e 1 therefore while poiseuille flow may be a good model for natural flow through fractures in which flow rates are low it seems likely that forced fracture flow situations will lead to high r e flow conditions in which poiseuille flow is not valid 2 model derivation this section develops a reduced dimension set of governing equations for flow through deformable thin varying channels starting from the two dimensional navier stokes equations it largely follows the methodology for flow through an elastic artery set out by olufsen et al 2000 and smith et al 2002 2 1 derivation of the reduced dimensions governing equations consider the flow of fluid through a thin fracture that is wide in the z direction the flow of fluid is governed by the two dimensional navier stokes equations the problem domain is illustrated in fig 3 let x and v x x y t be the coordinate and velocity along the longitudinal axis let y and v y x y t be the transverse coordinate and velocity the fracture is characterized by a scalar aperture w x t which is positive and non zero at all points in the domain flow in the out of plane direction is negligible v z 0 assumption 1 the flow is assumed to be symmetrical across the longitudinal centreline of the fracture assumption 2 the fluid is incompressible and newtonian assumption 3 the rock mass is an impermeable solid such that no fluid leak off occurs through the fracture walls the two dimensional navier stokes equations for an incompressible newtonian fluid are given as 3 v 0 4 ρ f v t v v p μ 2 v in which p p ρ f g k is the modified pressure which includes gravity effects next we will non dimensionalize all quantities such that y w 2 y x λ x v x v v x v y u v y t λ v t p ρ f v 2 p in which w is a characteristic aperture v is a characteristic velocity in the longitudinal direction and u is a characteristic velocity in the transverse direction let λ be a characteristic length defined as λ w 2 v u expanding the non dimensionalized equations we find 5 v x x v y y 0 6 v x t v x v x x v y v x y p x 4 μ λ ρ f v w 2 u 2 v 2 2 v x x 2 2 v x y 2 7 u 2 v 2 v y t v x v y x v y v y y p y u 2 v 2 2 μ ρ f w u u 2 v 2 2 v y x 2 v y y 2 assumption 4 the transverse velocity is much smaller than the longitudinal velocity v x v y v u therefore this derivation is not applicable to flow which have a significant transverse flow component assuming the transverse velocity is small compared to the longitudinal velocity allows us to state that u 2 v 2 0 this implies that the longitudinal viscous forces are negligible and that p y 0 such that the pressure is constant across the aperture the equations are reduced to 8 v x x v y y 0 9 v x t v x v x x v y v x y p x 4 μ λ ρ f v w 2 2 v x y 2 eqs 8 and 9 contain three unknowns in two equations so we will make further assumptions and manipulations to remove v y from these equations next we will integrate eqs 8 and 9 over the aperture let w w w be the non dimensionalized fracture aperture we will first examine the integration of eq 8 since x is independent from y the integral may be written as 10 2 x 0 w 2 v x d y w x v x w 2 2 0 w 2 v y y d y 0 11 2 x 0 w 2 v x d y w x v x w 2 2 v y 0 w 2 0 assumption 5 no slip conditions are assumed at the fracture surface and the shear displacement of the fracture surface is assumed to be small compared to its transverse movement such that v x w 2 u x w 2 0 in which u x is the longitudinal rock mass velocity therefore this derivation is not applicable to flows in which the longitudinal movement shear displacement of the fracture surfaces is large no slip conditions are assumed at the fracture surface which implies that the fluid velocity at the wall is equal to the velocity of the wall the shear velocity of the wall is assumed to be small compared to its transverse movement such that it is negligible the boundary condition is therefore stated as 12 v x w 2 0 while longitudinal movement of the rock mass is assumed to be small transverse movement is not neglected the rate of aperture change w is equal to the sum of the transverse velocity of each fracture surface therefore due to symmetry and the no slip boundary condition the transverse velocity at the fracture surface is 13 v y w 2 1 2 w t next let the non dimensional fluid flux through the fracture be defined as 14 q 2 0 w 2 v x d y w v x in which v x is the mean velocity over the aperture simplifying eq 11 with eqs 12 13 and 14 the continuity equation is given as 15 q x w t 0 next we will examine the conservation of momentum given by eq 9 integrating the equation over the aperture gives 16 t 2 0 w 2 v x d y w t v x w 2 2 0 w 2 v x v x x v y v x y d y w p x 4 μ λ ρ f v w 2 2 0 w 2 2 v x y 2 d y the first term in eq 16 may be simplified using eq 14 such that 17 t 2 0 w 2 v x d y q t while the second term disappears through the no slip boundary condition 12 the third term in 16 can be simplified through the continuity eq 8 and integration by parts this operation is the one dimensional equivalent to inversing the simplification of the convective term in the incompressible navier stokes equation v v v v v v v 0 18 2 0 w 2 v x v x x v y v x y d y 2 0 w 2 v x v x x v x v y y d y from eq 8 v x x v y y 19 2 0 w 2 v x v x x v x v x x d y 20 x 2 0 w 2 v x 2 d y we can further simplify this term by assuming that we know something about the shape of the velocity profile across the aperture assumption 6 let the velocity v x x y t be expressed as v x x y t v x x t n y w x in which n is a shape function describing the velocity profile over the aperture n is expressed as a function of the position along the aperture y w we will introduce a momentum correction factor α which will allow us to express 20 as a function of the dimensionless fluid flux and aperture the momentum correction factor is determined as 21 2 0 w 2 v x 2 d y 2 0 w 2 v x n 2 d y α q 2 w 22 α x 2 w 0 w 2 n y w x 2 d y thus assuming we know the velocity profile across the aperture we can determine the momentum correction factor the momentum correction factor can be interpreted as a measure of how much more momentum is forced into a control volume by the non constant velocity profile compared to a uniform velocity profile α 1 would indicate a perfectly uniform velocity profile which would be physically inadmissible due to the no slip boundary conditions therefore α 1 for all physically admissible velocity profiles in plug flow conditions where v x m a x v x α 1 for fully developed duct flow with a parabolic velocity profile in which v x m a x 1 5 v x α 1 2 α 1 2 indicates a sharper velocity profile in which the maximum velocity is greater than 1 5 v x the momentum correction factor is a unitless scalar but is not necessarily a constant if the velocity profile changes along the fracture last consider the shear stress term from eq 16 23 κ 2 0 w 2 2 v x y 2 d y 2 κ v x y 0 w 2 κ 4 μ λ ρ f v w 2 from the symmetry condition at the centreline the shear stress is subject to the boundary condition 24 v x y 0 0 so that the shear stress term becomes 25 f v 2 κ v x y w 2 and is therefore a body force term equal to the shear stress that is exerted on the fracture walls by the fluid combining the various terms the conservation of momentum is therefore given as 26 q t x α q 2 w w p x f v 2 2 dimensional form of the governing equations the parameter κ κ λ λ λ u is the only part of the formulation that is dependent on the transverse velocity u we can remove this dependence by transferring the system of equations back to dimensional form 27 q x w t 0 28 q t x α q 2 w w ρ f p x f v 29 α 2 w 0 w 2 n 2 d y 30 f v 2 μ ρ f v x y w 2 2 3 flow cases fully laminar and turbulent flow to calculate the friction force and momentum correction factor there must be an assumption about the shape of the velocity profile in this section we will examine the cases of fully developed laminar and turbulent flow through parallel plates 2 3 1 fully developed laminar flow in fully developed laminar flow through parallel plates the velocity profile is parabolic such that 31 v x v m a x 1 2 y w 2 w 2 y w 2 v x 2 3 v m a x thus we can calculate the momentum correction factor and the dissipation force 32 α 6 5 33 f v 12 μ ρ f q w 2 in laminar flow we expect that the friction term will take the general form of 33 with respect to the flow and geometry parameters but that the numerical coefficient will change depending on the velocity profile we therefore introduce the viscous friction coefficient β where 34 f v β μ ρ f q w 2 35 β 2 w 2 q v x y w 2 in which β 12 for the aforementioned parabolic velocity profile for apertures that are not uniform and flow that is not fully developed the parameters α and β would not be constants and would instead take a general form α α r e w β β r e w it is not possible to derive an analytical expression for α and β as the velocity profiles are in general a function of both the upstream and downstream flow conditions and geometries therefore for this article we will assume that all laminar flow follows a parabolic velocity profile and use constant coefficients 2 3 2 fully turbulent flow in general turbulence should be rare in fracture flow while relatively stable eddies may form across the aperture in higher reynolds number flows around surface asperities turbulent behaviour by the formation of random violent eddies due to the instability of the velocity profile at high reynolds numbers is generally not an expected behaviour based on studies of circular pipes we can expect the laminar regime to breakdown around a reynolds number of 2 1 0 3 but studies of fluid driven crack propagation in the turbulent regime have shown that a reynolds number of at least 1 0 4 is required for the turbulent solution to be valid in fracture flow zia and lecampion 2017 therefore many fracture flow situations will occur in the transitional regime between laminar and turbulent flow for turbulent flow we can apply the same derivation to the time averaged navier stokes equations bird et al 2002 repeating the non dimensionalization we again recover that p y 0 the equation governing the conservation of momentum therefore becomes 36 q t x α q 2 w w ρ f p x f v f t 37 f t w 2 w 2 x v x 2 y v x v y d y in which i are the time averaged flow variables and i are the random fluctuations of the flow variables f v now represents the momentum dissipation due to viscous forces while f t represents the momentum dissipation due to turbulent eddy motion the turbulent force can be simplified using the no slip boundary condition 12 such that 38 f t x w 2 w 2 v x 2 d y it is difficult to say anything more about the velocity fluctuations from an analytical standpoint they cannot be evaluated without an empirical correlation or full cfd solution fractures and ducts share similarities in their geometry although fractures contain much higher surface roughness and aperture variations for simplicity we will assume that fractures and ducts have similar behaviour which will let us combine the viscous and turbulent forces into a single dissipation force and adopt the form of the darcy weisbach equation 39 f f v f t 1 2 f d w 2 q 2 in which f d is the darcy friction factor we can now make use of the many empirical friction models that have been proposed over the years to capture friction losses in turbulent duct flow for this article we will propose adopting the phenomenological colebrook white equation for duct flow colebrook 1939 40 1 f d 2 log ε 3 7 d h 2 51 r e f d if r e 4000 in which the hydraulic diameter d h can be expressed in terms of the aperture as d h 2 w and linearly interpolating the friction factor in the transitional regime 2000 r e 4000 more complex friction laws which more accurately capture the complete transition between laminar and turbulent flow for example the yang dou model yang and dou 2010 could easily be adopted instead the colebrook white equation is based on steady state turbulent flow through pipes and is suggested in this article for simplicity it should be replaced with a more appropriate model in cases where unsteady turbulent flow is important lastly to calculate the momentum correction factor α the velocity profile in turbulent flow may be roughly approximated using a power law expression bird et al 2002 41 v x 8 7 v x 1 2 y w 1 7 0 y w 2 this approximate profile fails close to the walls as the velocity gradient is asymptotic but since we have incorporated the viscous force into the darcy weisbach friction force the approximate profile is sufficient to calculate the momentum correction factor we find that α 64 63 the plug flow velocity profile characteristic of turbulent flow results in a momentum correction factor much closer to 1 than the parabolic laminar profile 2 4 general case the governing set of equations in fracture flow may be summarized as follows 42 w t q x 0 43 q t x α q 2 w w ρ f p x 1 2 f d w 2 q 2 44 α α r e w 6 5 if r e 2000 64 63 if r e 4000 45 f d 2 β r e β β r e w 12 if r e 2000 1 f d 2 log ε 7 4 w 2 51 r e f d if r e 4000 46 r e ρ f v x w μ q ν we will refer to the model summarized in this section as the reduced dimension fracture flow model rdff in general one additional governing equation typically the equilibrium of forces is required to describe the relationship between the deformation of the aperture and the fluid pressure w w p the rdff model is more complex than poiseuille flow as it is described by two fields instead of one and requires solving a second non linear differential equation however it does not come with the same computational burden as the full navier stokes equations as the assumptions about the behaviour over the cross section allow us to reduce the fracture volumes to fracture planes 2 5 extension to planes consider the case of a two dimensional plane with deformable aperture which lies upon the x z cartesian plane we can make the same set of assumptions and follow the same derivation for a domain in which v z 0 to derive a planar version of the general rdff equations the velocity components are non dimensionalized according to v x v v x v z v v z and v y u v y the coordinate systems are non dimensionalized according to x λ x z λ z and y w 2 y in which λ w 2 v u following the same procedure as before the governing set of equations is given by 47 w t q 0 48 q t α w q q w ρ f p 1 2 f d w 2 q q 49 r e q ν 50 q q x q z 51 q q x 0 0 q z 52 α α x 0 0 α z 3 physical interpretations and implications of the model in this section we will explore the physical interpretation and implications of each term in the new formulation examine the cases under which we can recover poiseuille and forchheimer flows and examine conservation of energy in the fluid 3 1 physical interpretation of each term consider the derived equation for conservation of momentum in fully developed laminar flow which can be expanded and rearranged as 53 p x ρ f w q t ρ f q 2 w 2 α x α 2 ρ f q w 2 q x α ρ f q 2 w 3 w x β μ q w 3 let us examine the physical interpretation of each term in the equation of motion term 1 transient flux term ρ f w q t this term relates a component of the pressure gradient to changes in fluid flux over time if the fluid flux is not constant over time then there is an additional component to the pressure gradient that is required to overcome the fluid inertia and change the fluid flux this temporal component of the flux is not captured by poiseuille flow which assumes steady state flow term 2 velocity profile term ρ f q 2 w 2 α x this term relates a component of the pressure gradient to the change in the velocity profile along the length of the fracture and is associated with inertial convective forces in fully developed parallel plate flow the velocity profile does not change along the length of the fracture and so this term disappears factored by q 2 this term becomes more important in high r e flows and less important in viscous flows if α is increasing along the fracture it indicates that the velocity profile is becoming sharper i e the maximum velocity is increasing relative to the average velocity if α is decreasing along the fracture then velocity profile is becoming blunter moving towards a plug flow profile with the maximum velocity decreasing relative to the average velocity the negative sign indicates that an increase in maximum velocity results in a decrease in pressure and a decrease in the maximum velocity results in an increase of pressure this term therefore enables a transfer of energy from kinetic energy in the form of velocity to potential energy in the form of pressure further discussion on the conservation of energy in section 3 3 term 3 spatial flux moving boundary term α 2 ρ f q w 2 q x this term relates a component of the pressure gradient to the flux gradient and is associated with convective forces this term determines how much the momentum must change due to expansion and contraction of the fracture aperture from continuity this term can also be written as 54 α 2 ρ f q w 2 q x α 2 ρ f q w 2 w t such that if the aperture exists in a perfectly rigid and static domain w 0 the flux must be constant along the length of the fracture and this term disappears term 4 aperture gradient term α ρ f q 2 w 3 w x this term relates a component of the pressure gradient to the aperture gradient as the change in aperture will create a change in velocity this term means that the formulation is not restricted to the assumption of parallel plate flows and is a major improvement over poiseuille flow factored by q 2 this term becomes more important in high r e flows and less important in viscous flows like the velocity profile term this term enables a transfer between kinetic energy and fluid pressure the aperture term is interesting because it allows for a positive pressure gradient to develop in a diverging flow field aperture increasing in the direction of flow in which friction losses are small such behaviour is impossible under poiseuille flow but can be shown to occur in reality at even moderate reynolds number flows in varying aperture such as those considered later in section 4 3 fig 4 plots the ratio between the rdff and poiseuille flow pressure gradients for steady state laminar flow between rigid non parallel plates as a function of aperture gradient and reynolds number 55 p r d f f p p f α w x β r e 12 r e α 1 2 β 12 the negative contours at positive aperture gradient and high reynolds number indicate the region in which such positive pressure gradients would be expected term 5 viscous friction term β μ q w 3 this term relates a component of the pressure gradient to viscous friction dissipation and is the only term to appear in the poiseuille flow formulation in steady state laminar parallel plate flow all terms except this one disappear and the poiseuille flow formulation is recovered the negative sign indicates that in the absence of other factors fluid flows in the opposite direction of the pressure gradient viscous forces do work on the fluid dissipating the potential energy that exists in the form of fluid pressure 3 2 quasi steady flow conditions in this section we will examine what happens to the rdff model under steady flow conditions and show that previously proposed flow models exist within the solution space of the rdff model 3 2 1 poiseuille flow consider the case of steady laminar flow through rigid parallel plates such that q 0 w 0 q x 0 w x 0 and α x 0 in this case we can reduce the governing eqs 42 and 43 to 56 w ρ f p x 12 μ ρ f q w 2 0 which we can rearrange to find 57 p x 12 μ w 3 q thus recovering the poiseuille flow constitutive relationship between pressure and fluid flux therefore we can conclude that poiseuille flow exists within the solution space of the rdff model 3 2 2 forchheimer flow forchheimer flow is a non linear extension to darcy flow through porous media forchheimer 1901 in fracture flow this relationship takes the form 58 p x 12 μ w 3 q γ q 2 in which γ is an empirical coefficient while forchheimer flow does not see much use in modern models there have been efforts to determine the value of the empirical coefficient γ for fracture flow zimmerman et al 2004 ranjith and viete 2011 forchheimer flow offers the advantage of being a two field model u p as opposed to the three fields required by the rdff model u q p in this section we will recast the rdff model as a two field model to derive an analytical expression for the previously empirical coefficient if we assume that the flow is steady q 0 and the aperture is rigid w 0 q x 0 then we can express the pressure gradient as 59 p x 12 μ w 3 q α ρ f w 3 w x ρ f w 2 α x q 2 comparing 58 and 59 the empirical coefficient can be expressed as 60 γ α ρ f w 3 w x ρ f w 2 α x so that the constitutive relationship between pressure and fluid flux can be expressed as 61 p x 12 μ w 3 1 f 0 q 62 f 0 α ρ f 12 μ w x ρ f w 12 μ α x q in which f 0 is the nonlinear coefficient known as the forchheimer number the forchheimer number is a function of the flow rate q the fracture geometry w w and the distribution of fluid velocity across the aperture α as the fluid flux goes to zero so too does the forchheimer number and the standard poiseuille flow formulation is recovered forchheimer flow offers the advantage of being a two field model but this advantage is accompanied by physical restrictions albeit fewer restrictions than poiseuille flow this formulation for forchheimer flow is only applicable to rigid fractures and quasi steady state flow conditions 3 3 conservation of energy consider bernoulli s principle between points a and b along a rigid fracture of varying aperture in steady state laminar flow the total energy of the fluid at each point is the sum of potential energy and kinetic energy which are functions of the fluid pressure and fluid velocity respectively the points are assumed to be at the same elevation such that the difference in energy between the two points is the total energy dissipated by viscous friction we will integrate over the cross sections a and b to examine the conservation of energy of the bulk fluid we can therefore state the conservation of energy over the cross section as 63 1 2 ρ f w a 2 w a 2 v 2 d y w a 2 w a 2 p d y 1 2 ρ f w b 2 w b 2 v 2 d y w a 2 w a 2 p d y f in which f 0 is the dissipated energy assuming the velocity profile does not change between cross sections a and b constant α we can rearrange this expression to determine that the pressure difference between any two points in a fracture is equal to the energy dissipated by viscous friction plus an additional transfer of energy between kinetic energy and fluid pressure 64 δ p p b p a 1 2 α ρ f q 2 1 w a 2 1 w b 2 f when poiseuille flow is adopted we can integrate the constitutive equation between points a and b to find that the pressure difference is 65 δ p p a a b p x d x p a 66 δ p 12 μ q ξ ξ a b w 3 d x 0 comparing the terms in 64 and 66 it is clear that poiseuille flow only contains a single term to describe the dissipation by viscous friction such that f 12 μ q ξ there is no additional term to transfer energy between kinetic and potential energy and therefore the poiseuille flow constitutive model does not conserve energy when applied to flow through varying aperture fields the lost energy may be small if the difference in aperture is small but it is still non zero next consider the case of adopting the rdff model assuming constant α and β the pressure difference between any two points can be determined as 67 δ p p a a b p x d x p a 68 δ p α ρ f q 2 ξ 2 β μ q ξ 69 ξ 2 a b w 3 w x d x 1 2 1 w a 2 1 w b 2 70 δ p α ρ f q 2 1 2 1 w a 2 1 w b 2 β μ q ξ comparing 64 and 70 it is easily observed that the rdff model contains the additional term to transfer energy between kinetic energy and fluid pressure therefore the rdff model conserves energy in non uniform aperture fields while the poiseuille flow model does not the assumption of constant α is made to simplify the presentation of the analysis and energy is still conserved in the case of non constant α 4 comparisons of navier stokes rdff and poiseuille flow models in this section we will examine the solutions of the full navier stokes the rdff and the poiseuille flow models in three different simple flow problems in which closed form solutions to the poiseuille and rdff models are readily derived these comparisons will demonstrate the shortcomings of the poiseuille flow model and quantitatively measure the error in adopting the rdff and poiseuille flow models 4 1 transient fluid flow between parallel plates consider the flow through a channel of length l that is defined by rigid static parallel plates with aperture w 0 as illustrated in fig 5 the pressure at the outlet is fixed at p o u t p 0 while the pressure at the inlet oscillates such that p i n p 0 sin ω t the resulting flow rate between the inlet and outlet q is then a function of time this example demonstrates that the transient inertial behaviour of the fluid is important assuming that the flow is laminar this problem may be solved analytically for all three flow models the solution is expressed in terms of the dimensionless flux q defined as 71 q 12 μ l q w 0 3 the solution to the navier stokes model and the rdff model are identical and given by 72 q ϕ ω 2 ϕ 2 ω cos ω t ϕ sin ω t ω e ϕ t ϕ 12 μ ρ f w 0 2 in which ϕ is the natural frequency of the fluid in the channel the poiseuille flow solution is given by 73 q sin ω t the navier stokes and rdff solution is a function of the natural frequency of the fluid ϕ and the excitation frequency ω the poiseuille flow solution as it assumes quasi steady state conditions is only a function of the excitation frequency the solutions for different ratios of excitation frequency compared to natural frequency are illustrated in fig 6 when the excitation frequency is large compared to the natural frequency ω ϕ the rdff and navier stokes solutions converge to the quasi steady state poiseuille flow solution and the flow rate changes synchronously with the inlet pressure when the excitation frequency is small compared to the natural frequency ω ϕ the inertial forces are large and very little flow occurs when the excitation and natural frequency are similar ω ϕ there is strong coupling behaviour in the response of the fluid which affects the magnitude of the flow rate and causes the flow rate to lag the boundary condition this example demonstrates how transient inertial fluid forces can affect the flow rate and how the poiseuille flow model is incapable of capturing this behaviour 4 2 transient fluid flow between oscillating parallel plates consider the flow through a submerged channel of length 2 l in which the aperture is defined by parallel plates that oscillate at a fixed amplitude a and frequency ω such that w w 0 1 a sin ω t as illustrated in fig 7 the pressure at the outlets is fixed at p o u t p 0 and the flux q must be zero at the centre of the channel due to symmetry this problem captures both inertial transient and inertial convective effects since the flux is not constant along the length of the domain while the rdff and poiseuille flow solutions may be solved analytically by assuming laminar flow the navier stokes solution for this problem is non trivial both analytically and numerically due to the moving boundaries this example will therefore only compare the results of the rdff and poiseuille flow solutions for both flow models the fluid flux is given by the continuity equation such that 74 q w x the pressure profile along the channel for the poiseuille flow solution is 75 p p 0 12 μ w w 3 l 2 2 x l 2 1 the pressure profile along the channel for the rdff solution assuming constant α and β is 76 p p 0 ρ f w w 2 α w w 2 β μ w 3 w l 2 2 x l 2 1 to compare the models we can examine the dimensionless pressure at the centreline x 0 77 p p 0 t p 0 6 ω μ w 0 l 2 the dimensionless pressure at the centreline p for each model can then be simplified to 78 poiseuille p a cos ω t 1 a sin ω t 3 79 rdff p ω ϕ a sin ω t 1 a sin ω t 2 α a cos ω t 1 a sin ω t 2 a cos ω t 1 a sin ω t 3 ϕ 12 μ ρ f w 0 2 the dimensionless pressure at the centreline for an amplitude of a 0 25 is plotted as a function of time in fig 8 changing the amplitude of the oscillations increases the peak pressures but does not otherwise change the behaviour of the solutions first consider the behaviour of the quasi steady poiseuille flow model in the poiseuille flow model flow only ever moves due to the presence of a pressure gradient since the conservation of mass forces fluid in and out of the channel the pressure gradient develops to accommodate this flow when the aperture reaches a peak or a trough there is a zero pressure gradient at that instant as the fluid momentarily stops before reversing direction the time history for pressure incurs a phase shift towards the aperture troughs because the smaller apertures require larger gradients to move the fluid next consider the behaviour of the rdff model which depends on the natural frequency of the fluid ϕ when the oscillation frequency is small compared to the natural frequency ω ϕ the behaviour trends towards the quasi static poiseuille solution when the oscillation frequency is large compared to the natural frequency ω ϕ inertial effects dominate the response and the solution deviates significantly from poiseuille flow conservation of mass forces fluid in and out of the channel very quickly but the inertial forces try to resist this motion the pressure gradient thus develops in sync with the aperture oscillations but in the opposite direction to the poiseuille flow gradient when fluid is being forced into the channel the pressure increases at the centreline to try and push the fluid back out when fluid is being forced out of the channel the pressure decreases at the centreline forming a large negative backpressure which sucks the fluid back in this example illustrates the complex inertial convective behaviours that arise in problems in which fracture aperture is varies in time and which the poiseuille flow model is incapable of capturing 4 3 steady state fluid flow in channels of varying aperture consider the steady state flow through a rigid fracture of varying aperture as shown in fig 9 the domain is defined by a periodic aperture such that w x w 0 1 ɛ cos 2 π x λ w 0 in which 0 ɛ 1 is the characteristic amplitude and λ is the characteristic wavelength relative to the aperture fluid flows through the fracture at a constant rate of q the pressure at the outlet is fixed at a constant pressure p the rdff and poiseuille flow solutions can be solved analytically the solution is expressed in terms of the dimensionless pressure distribution p as a function of the non dimensionalized coordinate λ x x 80 p w 0 2 ρ f q 2 p p ξ 1 ξ x 0 x 1 81 ξ x 0 x p x d x 82 poiseuille p x λ 12 r e 1 1 ɛ cos 2 π x 3 83 rdff p x 2 π α ɛ sin 2 π x 1 ɛ cos 2 π x 3 λ 12 r e 1 1 ɛ cos 2 π x 3 the solution to the navier stokes equations for this problem is approximated using ansys fluent cfd software the computational domain is illustrated in fig 10 pressure is prescribed at the outlet while the fluid flux is prescribed at the inlet using a fully developed parabolic velocity profile the computational domain contains an inlet and outlet section with constant aperture symmetry is assumed along the centreline of the model the range of tested reynolds number is limited to ensure that the flow remains within the laminar regime such that unsymmetric phenomena like turbulence and vortex shedding are not expected the interior of the domain is three wavelengths long whose sinusoidal aperture is defined by piecewise line segments at a resolution of λ 60 the domain of interest is the central region 0 x λ as illustrated in fig 10 to compare the two dimensional pressure field obtained from cfd with the one dimensional models the average pressure over the aperture for a given position x in the two dimensional model is computed at 61 evenly spaced cross sections along the domain of interest the gradient of the extracted average pressures is computed using central differencing with a second order forward and backward differencing scheme used at each end point the error between the full navier stokes solution and the reduced dimension models ε is calculated as 84 ε i 0 1 p n s x p i x 2 d x 0 1 12 λ r e 1 ɛ 3 2 d x in which p n s x is the gradient of the average pressure from the full cfd model and p i x from either reduced dimension model the error is normalized by the pressure gradient through a parallel plate channel of width w 1 ɛ the cfd simulations were run using the 3rd order muscl flux interpolation scheme and a second order pressure interpolation scheme the cfd simulations were solved using ansys fluent s pressure based coupled solver a coarser mesh was applied to the inlet and outlet sections while a fine structured mesh was applied to the sinusoidal sections between λ x 2 λ the mesh was refined for each combination of ɛ and λ at r e 0 01 until the outputted average pressures converged to a relative change 1 0 4 from the previous mesh the number of cells ranged from 8 1 0 4 in shortest domains up to 5 1 0 5 in the longest domains the cfd model was run for amplitudes ranging from ɛ 0 to ɛ 0 7 wavelengths from λ 1 to λ 20 and reynolds numbers ranging from r e 0 01 to r e 1000 all cases converged to a steady state solution while some cases displayed stable eddy formation no cases displayed any indication of vortex shedding or developing turbulence fig 11 shows a selection of pressure contours throughout the fractures in which the rdff model performs well and performs poorly fig 12 shows the corresponding transverse velocity contours and streamlines within the fractures as seen in figs 11 and 12 the reduced dimension models perform well in cases where the transverse pressure gradients and transverse velocities are small the reduced dimension models perform poorly in cases where the transverse pressure gradients are not negligible the transverse velocities are not small and fundamentally two dimensional phenomena are observed such two dimensional phenomena include the development of eddies within the aperture peaks and the longitudinal velocity maintaining its speed as it exits the narrowed aperture regions demonstrating behaviour akin to a jet rather than fracture flow fig 13 shows the distribution of the pressure gradient over a selection of wavelengths and reynolds number at ɛ 0 3 lastly fig 14 shows the error curves as a function of reynolds number for tested wavelengths and amplitudes while fig 15 shows the relative improvement in error between the rdff and poiseuille flow models the case of ɛ 0 corresponds to parallel plates which both the poiseuille and rdff models capture exactly this case provides an estimate of the error that results from the convergence of the non linear cfd solver the cfd mesh the resolution of the extracted average pressure curve and the calculation of the numerical gradient this error of 1 0 4 is at least an order of magnitude smaller than the error observed in any of the other cases so the error observed in the other cases is attributed to the differences in the models and not the method by which the error is calculated as illustrated in fig 14 the rdff model always performs at least as well as the poiseuille flow model the exception to this trend is the quadrant with high reynolds numbers and short wavelengths in which the poiseuille model has lower error not because it is a better approximation of the physics but rather because neither model performs well the error increases with increasing amplitude and decreases with increasing wavelength as expected the error for any given wavelength and amplitude are linear piecewise continuous functions of the reynolds number at low reynolds numbers the error is constant and with increasing reynolds numbers the error increases logarithmically the transition point between the two behaviours occurs somewhere between 1 r e 100 we therefore define three flow regimes based on the reynolds number the viscous regime r e 1 the weak inertial regime 1 r e 100 and the strong inertial regime r e 100 in the viscous regime r e 1 where inertial forces are negligible the solution to the navier stokes equations is not a function of the reynolds number and is instead only a function of the geometry viscous forces dominate over inertial forces such that the non linear terms in the rdff model are small and the rdff model tends towards the poiseuille flow model and hence why no improvement in the error is observed error in this regime is generally small 5 and both reduced dimension models are generally good at predicting the pressure profile though error increases when the wavelength is short this behaviour is as expected and is consistent with observations from previous studies of poiseuille flow witherspoon et al 1980 zimmerman and bodvarsson 1996 yu et al 2017 fig 16 shows the error in the viscous regime as a function of amplitude and wavelength in the weak inertial regime 1 r e 100 inertial forces start to influence the pressure gradient the error in the poiseuille flow model increases logarithmically starting at a reynolds number of r e 1 for all aperture wavelengths and amplitudes the rdff model performs much better than poiseuille flow showing up to 400 improvements in error the rdff model also eventually demonstrates logarithmically increasing error but the transition point is much later than that of the poiseuille flow model as the wavelength increases so too does the reynolds number at which the rdff transitions from constant to logarithmically increasing error the comparably poor accuracy of the poiseuille flow model in the weak inertial regime is noteworthy because fracture flows in this domain are regularly encountered during industrial processes such as hydraulic fracturing but are also possible during natural phenomena like seismic events furthermore the poiseuille flow model demonstrates significant deviations from the navier stokes behaviour for fractures with even modest deviations from the assumed parallel plate geometry the errors associated with such modest deviations as opposed to those from surface roughness have been presumed to be small in the majority of hydraulic fracture and discrete fracture network analyses the results here demonstrate that significant deviations between the poiseuille flow and navier stokes behaviour exists in common scenarios the rdff model is significantly more accurate in the weak inertial regime for fractures with modest spatial variations in aperture in the strong inertial regime r e 100 error in both models is generally large as neither model is particularly good at predicting the pressure gradient the rdff model still sees improvements in error of at least 10 and up to 300 at long wavelengths at short wavelengths in this regime fundamentally two dimensional phenomena such as the development of stable eddies are observed in the navier stokes solution which is not the kind of behaviour that the reduced dimension models have been developed to capture the cfd solutions show that at high reynolds numbers and larger amplitudes the velocity profile resembles a jet in which flow is contained to a thin region around the centreline this suggests that improvements in error may be possible if an effective hydraulic aperture is adopted at high reynolds number rather than using the geometric aperture calculating the full navier stokes solution also means that we have access to the velocity profiles throughout each fracture we can use these velocity profiles to calculate the true values of the momentum correction factor α and the viscous friction factor β in each tested case fig 17 shows the histograms of each factor extracted from the cfd profiles any cases which exhibited negative flow in the longitudinal direction are ignored as they invalidate the assumptions behind these coefficients both factors are heavily clustered around the parabolic velocity profile values of α 1 2 and β 12 the strong inertial regime shows slightly higher standard deviations but the mean values remain close to the ideal parabolic profiles while the pressure gradient predictions may be improved using the calculated values of α and β it is not possible to determine a general empirical equation for the two factors from these cases the factors display some correlation with aperture curvature in the viscous regime but it is not possible to differentiate whether this is a correlation with aperture curvature or simply the aperture due to the cyclical nature of the sinusoidal aperture the factors also display some correlation to wavelength λ and amplitude ɛ but these are parameters specific to the considered domain therefore we recommend that the momentum correction factor α and the viscous friction factor β be considered as constants within the laminar flow regime such that the factors only change when the flow transitions into the transitional and turbulent flow regimes this example shows the quantitative improvement in the ability of the rdff model to predict the pressure gradient in the case of steady state laminar flow through rigid non parallel apertures error in both models increases with reynolds number and decreases as the wavelength increases while the error in the rdff and poiseuille models is similar in the viscous regime r e 1 the rdff model shows significant improvement in the weak inertial regime 1 r e 100 while the error increases in both models in the strong inertial regime r e 100 the rdff model still shows improvements over poiseuille flow especially at longer wavelengths 5 conclusions poiseuille flow is commonly adopted for modelling flow through fractures for its ease of use relative to the full navier stokes equations poiseuille flow has many physical assumptions and limitations and it does not conserve energy when applied to fractures of variable aperture non poiseuille flow conditions are very common in forced fracture flow processes creating a need for an alternative model that is capable of capturing the inertial and transient behaviours that arise at larger reynolds numbers without the computational burden that accompanies the full navier stokes equations in this article the alternative rdff model for flow through thin deformable fractures has been derived and verified to fulfil this niche the rdff model is demonstrated to capture complex inertial and transient behaviours under transient fluid boundary conditions and moving solid boundary conditions and conserve energy in non parallel plate geometries the rdff model is shown to recover the poiseuille flow model under poiseuille flow conditions and the non linear extension to forchheimer flow is explored the error between the full navier stokes solution and reduced dimension models is quantified for steady state laminar flow through sinusoidally varying aperture fields at moderate reynolds numbers 1 r e 100 the rdff model demonstrates up to 400 improvements in error over the poiseuille flow model while the error of the rdff model increases logarithmically at r e 100 error still improves by at least 10 at shorter wavelengths and up to 300 at longer wavelengths over poiseuille flow above reynold s numbers of r e 500 neither model performs particularly well at the cost of increased complexity the rdff model is demonstrated to be superior to the poiseuille flow model in all possible tested conditions we therefore recommend its adoption in modelling forced fracture flow processes over poiseuille flow future work surrounding the rdff model should include further verification with the full navier stokes equations for rigid and deformable moving boundary problems investigation and calibration of the momentum correction and viscous friction velocity profile factors α and β and experimental validation of the rdff model with real fracture flow data further extensions to the physics of the model should consider modifications for permeable walls with fluid leak off in porous media berkowitz 1989 mohais et al 2012 hosseini and khoei 2021 unsymmetric fractures fluid compressibility and large scale fracture networks bisdom et al 2016 credit authorship contribution statement bruce gee methodology software validation formal analysis investigation data curation writing visualization funding acquisition robert gracie conceptualization methodology resources writing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements dr gracie acknowledges the support of a discovery grant from the natural sciences and engineering research council of canada nserc bruce gee acknowledges the support of an nserc doctoral postgraduate scholarship 
146,large scale models of fluid flow through fractures are almost exclusively based on poiseuille flow the cubic law when the fracture aperture is time and or spatially varying flow is transient and or flow rates are modest r e 1 poiseuille flow predictions can deviate substantially from the full navier stokes solution and generally do not satisfy conservation of energy a new reduced dimension fracture flow rdff model is derived which more accurately predicts transient fracture flow for incompressible fluids with modest reynolds numbers the rdff model is derived from the two dimensional navier stokes equations and yields a two field model fluid flux and pressure governed by conservation of mass and momentum the rdff model conserves energy and is shown to include both poiseuille flow and forchheimer flow as limiting cases the performance of the rdff model is compared to the existing poiseuille flow model and the solution to the full navier stokes equations in three benchmarks problems the rdff model demonstrates complex transient and inertial behaviours not previously captured and produces up to 400 improvements in error over poiseuille flow in steady state flow conditions for 1 r e 100 the rdff model is demonstrated to be superior in application where the reynold s number is modest and when aperture varies in space and or time keywords fracture flow cubic law non linear flow aperture variation poiseuille flow navier stokes 1 introduction the flow of fluid through fractures is an important aspect of many natural and industrial processes in contaminant transport and groundwater flow fractures form the primary pathway for flow through low permeability rock masses nelson and handin 1978 tang et al 1981 flow in fractures is known to enhance the permeability of porous media under seismic loads elkhoury et al 2011 manga et al 2012 in engineered processes like hydraulic fracturing well stimulation and geothermal heat extraction large volumes of fluid are rapidly forced through thin fractures and fracture networks osiptsov 2017 pandey et al 2018 lecampion et al 2018 models and simulations of flow in fractures deformable or rigid are almost exclusively based on poiseuille flow the analytical solution to the navier stokes equations for incompressible and steady flow between ridge parallel plates it states that the pressure gradient is related to the mean velocity by 1 p 12 μ w 2 v 12 μ w 3 q in which w is the aperture between the plates μ is the kinematic viscosity v is the mean velocity and p is the pressure gradient witherspoon et al 1980 zimmerman and bodvarsson 1996 eq 1 is often presented in terms of the fluid flux q where it has earned the name the cubic law due to its ubiquity in modelling fracture flow in models and simulation involving deformable fractures conservation of mass is derived at the fracture scale using a control volume such that 2 w q in which q is the fluid flux given by the cubic law in eq 1 this upscaled statement of conservation of mass admits both time and spatially varying aperture in contrast to the assumptions underpinning poiseuille flow eqs 1 and 2 are widely used in fracture flow modelling and have been extended to many applications including two phase flow murphy and thomson 1993 non wetting fluid flow lee et al 2013 and hydraulic fracturing with proppant transport dontsov and peirce 2014 rivas and gracie 2020 to name a few despite its widespread use fracture flow models based on poiseuille flow have a number of limitations the underpinning assumptions are often violated including a that flow is steady b that the aperture can be locally approximated by parallel plates even beyond consideration for surface roughness c that inertial forces are negligible d that flow is laminar and e that the rock mass is impermeable the assumption of impermeable walls is often violated when poiseuille flow is applied to modelling flow through fractured porous media but this issue has previously been addressed by modifying poiseuille flow to account for the fluid leak off through permeable fracture walls berkowitz 1989 mohais et al 2012 hosseini and khoei 2021 previous works which have examined fluid driven crack propagation with alternative flow assumptions like turbulent flow dontsov 2016 zia and lecampion 2017 or non newtonian fluids garagash 2006 moukhtari and lecampion 2018 have shown that laminar flow conditions occur in a majority of industrial cases and that inertial terms are only important at very early times when the injection rate is constant however these analyses do not address the inertial effects from non parallel plate geometries small deviations will be shown to be significant or the complex transient effects that arise from new hydraulic fracturing techniques like pressure pulsing parchei esfahani et al 2020 or dynamic stress effects induced by seismicity elkhoury et al 2011 manga et al 2012 there is therefore a need for a new model of fracture flow that is capable of capturing the transient and inertial physics of flow through non parallel apertures at moderate to large reynolds numbers poiseuille flow has been extensively studied analytically numerically and experimentally much of the work has focused on the validity of poiseuille flow as it applies to surface roughness and tortuosity and modifications to poiseuille flow have been proposed to address these factors brown 1995 brush and thomson 2003 nazridoust et al 2006 he et al 2021 several studies of poiseuille flow have devised criteria for when poiseuille flow based models are appropriate zimmerman and bodvarsson 1996 zimmerman et al 1991 these recommendations on the range of applicability of poiseuille flow for fractures are often violated in modern modelling works for example in rivas and gracie 2020 and gee and gracie 2021 flow rates are applied in excess of the limits on the range of applicability while in parchei esfahani et al 2020 transient effects in the fluid are neglected by adopting quasi static poiseuille flow despite the dynamic nature of modelled pressure pulsing poiseuille flow departures significantly from the true fluid behaviour in fractures of varying aperture at even moderate reynolds numbers r e 1 experimental results of fracture flow have shown that poiseuille flow using the average aperture of the fracture produces relatively accurate results up to a reynolds number of about 10 after which flow becomes non linear witherspoon et al 1980 zimmerman et al 2004 ranjith and viete 2011 liu et al 2016 more recent reviews have shown that the onset of non linear flow behaviour can range from 0 1 r e 60 depending on mechanical factors such as shear dilation confining stresses and surface roughness yu et al 2017 the only flow model which has attempted to account for the inertial non linear flow behaviour observed at higher reynolds numbers is forchheimer flow a non linear extension originally developed for non darcian flow through porous media and adapted to fracture flow forchheimer 1901 forchheimer flow relies on an empirical coefficient to capture to the nonlinear behaviour and while there have been attempts to calibrate this empirical coefficient zimmerman et al 2004 ranjith and viete 2011 forchheimer flow rarely sees any use in modern fracture flow simulations it is important to distinguish the type of fractures for which a new reduced dimension model will be applicable fig 1 illustrates three different classes of fractures which may be described by combinations of hydraulic aperture w surface asperities ɛ and wavelength λ the first class illustrated in fig 1 a is the case where the asperities are small compared to the aperture the second class illustrated in fig 1 b is the case in which the roughness asperities wavelength and aperture are all approximately the same order these classes have been the focus of many previous efforts to modify the cubic law to account for surface roughness brown 1995 brush and thomson 2003 nazridoust et al 2006 the second class describes many natural fractures and is often grouped together with surface roughness however the transverse component of flow in this class is significant and cannot be adequately described by a reduced dimension model the third class of fractures illustrated in fig 1 c is the target application of the new model proposed in this manuscript asperities and aperture may be of similar order but the wavelength over which the aperture changes is large and locally the fracture surface is smooth this class of fracture is typically adopted as the idealized geometry for fractures in many modern fracture flow modelling works osiptsov 2017 pandey et al 2018 lecampion et al 2018 in this article an improved fracture flow model is presented it overcomes many of the limitations of the poiseuille flow model by capturing the inertial and transient behaviour of fluid flow through fractures of varying and deformable aperture in inertial dominant flow r e 1 whereas previous modelling efforts have focused on modifying poiseuille flow we start from the full set of navier stokes equations and make simplifying assumptions thereby creating a reduced dimension flow model which allows us to simplify the fracture volume into a fracture plane the new reduced dimension model is verified against the full navier stokes solution and compared to poiseuille flow in the cases of transient flow and spatially and temporally varying aperture fields we demonstrate that our new proposed model captures inertial behaviour previously neglected conserves energy in fractures where poiseuille flow does not and more accurately models transient and steady state flows through fractures with spatially varying aperture in the following section the prevalence of high reynolds number flows in practice is discussed in section 2 a reduced dimension formulation for flow through fractures of deformable aperture is developed and the cases of laminar and turbulent flow are discussed section 3 provides a physical interpretation of each term in the reduced dimension model and examines a number of corollaries which can be derived from the reduced dimension model next section 4 verifies the model with several analytical and numerical problems in which the reduced dimension model is compared against both poiseuille flow and the full navier stokes solutions the models are compared both qualitatively and quantitatively last section 5 summarizes the findings and conclusions 1 1 prevalence of high re flow in practice given the ubiquity of the poiseuille flow model for fracture flow it is reasonable to ask how often non poiseuille flow conditions r e 1 occur in practice first consider a kgd type planar fracture along a wellbore as illustrated in fig 2 a assuming that the rock mass is rigid w 0 the reynolds number is given by the fluid viscosity and density μ and ρ f the total flow rate q and the fracture height h such that r e q ρ f μ h given a fluid with a density of ρ f 1000 kg m 3 and a fracture height of 100 m then the range of reynolds numbers for viscosities and flow rates are given in table 1 the range of flow rates considered suggest that most forced fracture flow applications can expect flows in which inertial forces are dominant over viscous forces r e 1 next consider a radial fracture emanating from a wellbore as illustrated in fig 2 b assuming that the rock mass is rigid w 0 the reynolds number is given by the fluid viscosity and density μ and ρ f the total flow rate q and the radial distance r such that r e q ρ f 2 π μ r therefore the reynolds number decreases radially from wellbore given a constant total flow of q 60 m 3 h for a fluid with a density of ρ f 1000 kg m 3 then the reynolds number for various viscosities at various radial distances is given in table 1 for a 20 cm diameter wellbore very high reynolds numbers occur near the wellbore and while the reynolds numbers decrease rapidly the fracture must extend over 100 m to reach a viscous dominant flow regime r e 1 therefore while poiseuille flow may be a good model for natural flow through fractures in which flow rates are low it seems likely that forced fracture flow situations will lead to high r e flow conditions in which poiseuille flow is not valid 2 model derivation this section develops a reduced dimension set of governing equations for flow through deformable thin varying channels starting from the two dimensional navier stokes equations it largely follows the methodology for flow through an elastic artery set out by olufsen et al 2000 and smith et al 2002 2 1 derivation of the reduced dimensions governing equations consider the flow of fluid through a thin fracture that is wide in the z direction the flow of fluid is governed by the two dimensional navier stokes equations the problem domain is illustrated in fig 3 let x and v x x y t be the coordinate and velocity along the longitudinal axis let y and v y x y t be the transverse coordinate and velocity the fracture is characterized by a scalar aperture w x t which is positive and non zero at all points in the domain flow in the out of plane direction is negligible v z 0 assumption 1 the flow is assumed to be symmetrical across the longitudinal centreline of the fracture assumption 2 the fluid is incompressible and newtonian assumption 3 the rock mass is an impermeable solid such that no fluid leak off occurs through the fracture walls the two dimensional navier stokes equations for an incompressible newtonian fluid are given as 3 v 0 4 ρ f v t v v p μ 2 v in which p p ρ f g k is the modified pressure which includes gravity effects next we will non dimensionalize all quantities such that y w 2 y x λ x v x v v x v y u v y t λ v t p ρ f v 2 p in which w is a characteristic aperture v is a characteristic velocity in the longitudinal direction and u is a characteristic velocity in the transverse direction let λ be a characteristic length defined as λ w 2 v u expanding the non dimensionalized equations we find 5 v x x v y y 0 6 v x t v x v x x v y v x y p x 4 μ λ ρ f v w 2 u 2 v 2 2 v x x 2 2 v x y 2 7 u 2 v 2 v y t v x v y x v y v y y p y u 2 v 2 2 μ ρ f w u u 2 v 2 2 v y x 2 v y y 2 assumption 4 the transverse velocity is much smaller than the longitudinal velocity v x v y v u therefore this derivation is not applicable to flow which have a significant transverse flow component assuming the transverse velocity is small compared to the longitudinal velocity allows us to state that u 2 v 2 0 this implies that the longitudinal viscous forces are negligible and that p y 0 such that the pressure is constant across the aperture the equations are reduced to 8 v x x v y y 0 9 v x t v x v x x v y v x y p x 4 μ λ ρ f v w 2 2 v x y 2 eqs 8 and 9 contain three unknowns in two equations so we will make further assumptions and manipulations to remove v y from these equations next we will integrate eqs 8 and 9 over the aperture let w w w be the non dimensionalized fracture aperture we will first examine the integration of eq 8 since x is independent from y the integral may be written as 10 2 x 0 w 2 v x d y w x v x w 2 2 0 w 2 v y y d y 0 11 2 x 0 w 2 v x d y w x v x w 2 2 v y 0 w 2 0 assumption 5 no slip conditions are assumed at the fracture surface and the shear displacement of the fracture surface is assumed to be small compared to its transverse movement such that v x w 2 u x w 2 0 in which u x is the longitudinal rock mass velocity therefore this derivation is not applicable to flows in which the longitudinal movement shear displacement of the fracture surfaces is large no slip conditions are assumed at the fracture surface which implies that the fluid velocity at the wall is equal to the velocity of the wall the shear velocity of the wall is assumed to be small compared to its transverse movement such that it is negligible the boundary condition is therefore stated as 12 v x w 2 0 while longitudinal movement of the rock mass is assumed to be small transverse movement is not neglected the rate of aperture change w is equal to the sum of the transverse velocity of each fracture surface therefore due to symmetry and the no slip boundary condition the transverse velocity at the fracture surface is 13 v y w 2 1 2 w t next let the non dimensional fluid flux through the fracture be defined as 14 q 2 0 w 2 v x d y w v x in which v x is the mean velocity over the aperture simplifying eq 11 with eqs 12 13 and 14 the continuity equation is given as 15 q x w t 0 next we will examine the conservation of momentum given by eq 9 integrating the equation over the aperture gives 16 t 2 0 w 2 v x d y w t v x w 2 2 0 w 2 v x v x x v y v x y d y w p x 4 μ λ ρ f v w 2 2 0 w 2 2 v x y 2 d y the first term in eq 16 may be simplified using eq 14 such that 17 t 2 0 w 2 v x d y q t while the second term disappears through the no slip boundary condition 12 the third term in 16 can be simplified through the continuity eq 8 and integration by parts this operation is the one dimensional equivalent to inversing the simplification of the convective term in the incompressible navier stokes equation v v v v v v v 0 18 2 0 w 2 v x v x x v y v x y d y 2 0 w 2 v x v x x v x v y y d y from eq 8 v x x v y y 19 2 0 w 2 v x v x x v x v x x d y 20 x 2 0 w 2 v x 2 d y we can further simplify this term by assuming that we know something about the shape of the velocity profile across the aperture assumption 6 let the velocity v x x y t be expressed as v x x y t v x x t n y w x in which n is a shape function describing the velocity profile over the aperture n is expressed as a function of the position along the aperture y w we will introduce a momentum correction factor α which will allow us to express 20 as a function of the dimensionless fluid flux and aperture the momentum correction factor is determined as 21 2 0 w 2 v x 2 d y 2 0 w 2 v x n 2 d y α q 2 w 22 α x 2 w 0 w 2 n y w x 2 d y thus assuming we know the velocity profile across the aperture we can determine the momentum correction factor the momentum correction factor can be interpreted as a measure of how much more momentum is forced into a control volume by the non constant velocity profile compared to a uniform velocity profile α 1 would indicate a perfectly uniform velocity profile which would be physically inadmissible due to the no slip boundary conditions therefore α 1 for all physically admissible velocity profiles in plug flow conditions where v x m a x v x α 1 for fully developed duct flow with a parabolic velocity profile in which v x m a x 1 5 v x α 1 2 α 1 2 indicates a sharper velocity profile in which the maximum velocity is greater than 1 5 v x the momentum correction factor is a unitless scalar but is not necessarily a constant if the velocity profile changes along the fracture last consider the shear stress term from eq 16 23 κ 2 0 w 2 2 v x y 2 d y 2 κ v x y 0 w 2 κ 4 μ λ ρ f v w 2 from the symmetry condition at the centreline the shear stress is subject to the boundary condition 24 v x y 0 0 so that the shear stress term becomes 25 f v 2 κ v x y w 2 and is therefore a body force term equal to the shear stress that is exerted on the fracture walls by the fluid combining the various terms the conservation of momentum is therefore given as 26 q t x α q 2 w w p x f v 2 2 dimensional form of the governing equations the parameter κ κ λ λ λ u is the only part of the formulation that is dependent on the transverse velocity u we can remove this dependence by transferring the system of equations back to dimensional form 27 q x w t 0 28 q t x α q 2 w w ρ f p x f v 29 α 2 w 0 w 2 n 2 d y 30 f v 2 μ ρ f v x y w 2 2 3 flow cases fully laminar and turbulent flow to calculate the friction force and momentum correction factor there must be an assumption about the shape of the velocity profile in this section we will examine the cases of fully developed laminar and turbulent flow through parallel plates 2 3 1 fully developed laminar flow in fully developed laminar flow through parallel plates the velocity profile is parabolic such that 31 v x v m a x 1 2 y w 2 w 2 y w 2 v x 2 3 v m a x thus we can calculate the momentum correction factor and the dissipation force 32 α 6 5 33 f v 12 μ ρ f q w 2 in laminar flow we expect that the friction term will take the general form of 33 with respect to the flow and geometry parameters but that the numerical coefficient will change depending on the velocity profile we therefore introduce the viscous friction coefficient β where 34 f v β μ ρ f q w 2 35 β 2 w 2 q v x y w 2 in which β 12 for the aforementioned parabolic velocity profile for apertures that are not uniform and flow that is not fully developed the parameters α and β would not be constants and would instead take a general form α α r e w β β r e w it is not possible to derive an analytical expression for α and β as the velocity profiles are in general a function of both the upstream and downstream flow conditions and geometries therefore for this article we will assume that all laminar flow follows a parabolic velocity profile and use constant coefficients 2 3 2 fully turbulent flow in general turbulence should be rare in fracture flow while relatively stable eddies may form across the aperture in higher reynolds number flows around surface asperities turbulent behaviour by the formation of random violent eddies due to the instability of the velocity profile at high reynolds numbers is generally not an expected behaviour based on studies of circular pipes we can expect the laminar regime to breakdown around a reynolds number of 2 1 0 3 but studies of fluid driven crack propagation in the turbulent regime have shown that a reynolds number of at least 1 0 4 is required for the turbulent solution to be valid in fracture flow zia and lecampion 2017 therefore many fracture flow situations will occur in the transitional regime between laminar and turbulent flow for turbulent flow we can apply the same derivation to the time averaged navier stokes equations bird et al 2002 repeating the non dimensionalization we again recover that p y 0 the equation governing the conservation of momentum therefore becomes 36 q t x α q 2 w w ρ f p x f v f t 37 f t w 2 w 2 x v x 2 y v x v y d y in which i are the time averaged flow variables and i are the random fluctuations of the flow variables f v now represents the momentum dissipation due to viscous forces while f t represents the momentum dissipation due to turbulent eddy motion the turbulent force can be simplified using the no slip boundary condition 12 such that 38 f t x w 2 w 2 v x 2 d y it is difficult to say anything more about the velocity fluctuations from an analytical standpoint they cannot be evaluated without an empirical correlation or full cfd solution fractures and ducts share similarities in their geometry although fractures contain much higher surface roughness and aperture variations for simplicity we will assume that fractures and ducts have similar behaviour which will let us combine the viscous and turbulent forces into a single dissipation force and adopt the form of the darcy weisbach equation 39 f f v f t 1 2 f d w 2 q 2 in which f d is the darcy friction factor we can now make use of the many empirical friction models that have been proposed over the years to capture friction losses in turbulent duct flow for this article we will propose adopting the phenomenological colebrook white equation for duct flow colebrook 1939 40 1 f d 2 log ε 3 7 d h 2 51 r e f d if r e 4000 in which the hydraulic diameter d h can be expressed in terms of the aperture as d h 2 w and linearly interpolating the friction factor in the transitional regime 2000 r e 4000 more complex friction laws which more accurately capture the complete transition between laminar and turbulent flow for example the yang dou model yang and dou 2010 could easily be adopted instead the colebrook white equation is based on steady state turbulent flow through pipes and is suggested in this article for simplicity it should be replaced with a more appropriate model in cases where unsteady turbulent flow is important lastly to calculate the momentum correction factor α the velocity profile in turbulent flow may be roughly approximated using a power law expression bird et al 2002 41 v x 8 7 v x 1 2 y w 1 7 0 y w 2 this approximate profile fails close to the walls as the velocity gradient is asymptotic but since we have incorporated the viscous force into the darcy weisbach friction force the approximate profile is sufficient to calculate the momentum correction factor we find that α 64 63 the plug flow velocity profile characteristic of turbulent flow results in a momentum correction factor much closer to 1 than the parabolic laminar profile 2 4 general case the governing set of equations in fracture flow may be summarized as follows 42 w t q x 0 43 q t x α q 2 w w ρ f p x 1 2 f d w 2 q 2 44 α α r e w 6 5 if r e 2000 64 63 if r e 4000 45 f d 2 β r e β β r e w 12 if r e 2000 1 f d 2 log ε 7 4 w 2 51 r e f d if r e 4000 46 r e ρ f v x w μ q ν we will refer to the model summarized in this section as the reduced dimension fracture flow model rdff in general one additional governing equation typically the equilibrium of forces is required to describe the relationship between the deformation of the aperture and the fluid pressure w w p the rdff model is more complex than poiseuille flow as it is described by two fields instead of one and requires solving a second non linear differential equation however it does not come with the same computational burden as the full navier stokes equations as the assumptions about the behaviour over the cross section allow us to reduce the fracture volumes to fracture planes 2 5 extension to planes consider the case of a two dimensional plane with deformable aperture which lies upon the x z cartesian plane we can make the same set of assumptions and follow the same derivation for a domain in which v z 0 to derive a planar version of the general rdff equations the velocity components are non dimensionalized according to v x v v x v z v v z and v y u v y the coordinate systems are non dimensionalized according to x λ x z λ z and y w 2 y in which λ w 2 v u following the same procedure as before the governing set of equations is given by 47 w t q 0 48 q t α w q q w ρ f p 1 2 f d w 2 q q 49 r e q ν 50 q q x q z 51 q q x 0 0 q z 52 α α x 0 0 α z 3 physical interpretations and implications of the model in this section we will explore the physical interpretation and implications of each term in the new formulation examine the cases under which we can recover poiseuille and forchheimer flows and examine conservation of energy in the fluid 3 1 physical interpretation of each term consider the derived equation for conservation of momentum in fully developed laminar flow which can be expanded and rearranged as 53 p x ρ f w q t ρ f q 2 w 2 α x α 2 ρ f q w 2 q x α ρ f q 2 w 3 w x β μ q w 3 let us examine the physical interpretation of each term in the equation of motion term 1 transient flux term ρ f w q t this term relates a component of the pressure gradient to changes in fluid flux over time if the fluid flux is not constant over time then there is an additional component to the pressure gradient that is required to overcome the fluid inertia and change the fluid flux this temporal component of the flux is not captured by poiseuille flow which assumes steady state flow term 2 velocity profile term ρ f q 2 w 2 α x this term relates a component of the pressure gradient to the change in the velocity profile along the length of the fracture and is associated with inertial convective forces in fully developed parallel plate flow the velocity profile does not change along the length of the fracture and so this term disappears factored by q 2 this term becomes more important in high r e flows and less important in viscous flows if α is increasing along the fracture it indicates that the velocity profile is becoming sharper i e the maximum velocity is increasing relative to the average velocity if α is decreasing along the fracture then velocity profile is becoming blunter moving towards a plug flow profile with the maximum velocity decreasing relative to the average velocity the negative sign indicates that an increase in maximum velocity results in a decrease in pressure and a decrease in the maximum velocity results in an increase of pressure this term therefore enables a transfer of energy from kinetic energy in the form of velocity to potential energy in the form of pressure further discussion on the conservation of energy in section 3 3 term 3 spatial flux moving boundary term α 2 ρ f q w 2 q x this term relates a component of the pressure gradient to the flux gradient and is associated with convective forces this term determines how much the momentum must change due to expansion and contraction of the fracture aperture from continuity this term can also be written as 54 α 2 ρ f q w 2 q x α 2 ρ f q w 2 w t such that if the aperture exists in a perfectly rigid and static domain w 0 the flux must be constant along the length of the fracture and this term disappears term 4 aperture gradient term α ρ f q 2 w 3 w x this term relates a component of the pressure gradient to the aperture gradient as the change in aperture will create a change in velocity this term means that the formulation is not restricted to the assumption of parallel plate flows and is a major improvement over poiseuille flow factored by q 2 this term becomes more important in high r e flows and less important in viscous flows like the velocity profile term this term enables a transfer between kinetic energy and fluid pressure the aperture term is interesting because it allows for a positive pressure gradient to develop in a diverging flow field aperture increasing in the direction of flow in which friction losses are small such behaviour is impossible under poiseuille flow but can be shown to occur in reality at even moderate reynolds number flows in varying aperture such as those considered later in section 4 3 fig 4 plots the ratio between the rdff and poiseuille flow pressure gradients for steady state laminar flow between rigid non parallel plates as a function of aperture gradient and reynolds number 55 p r d f f p p f α w x β r e 12 r e α 1 2 β 12 the negative contours at positive aperture gradient and high reynolds number indicate the region in which such positive pressure gradients would be expected term 5 viscous friction term β μ q w 3 this term relates a component of the pressure gradient to viscous friction dissipation and is the only term to appear in the poiseuille flow formulation in steady state laminar parallel plate flow all terms except this one disappear and the poiseuille flow formulation is recovered the negative sign indicates that in the absence of other factors fluid flows in the opposite direction of the pressure gradient viscous forces do work on the fluid dissipating the potential energy that exists in the form of fluid pressure 3 2 quasi steady flow conditions in this section we will examine what happens to the rdff model under steady flow conditions and show that previously proposed flow models exist within the solution space of the rdff model 3 2 1 poiseuille flow consider the case of steady laminar flow through rigid parallel plates such that q 0 w 0 q x 0 w x 0 and α x 0 in this case we can reduce the governing eqs 42 and 43 to 56 w ρ f p x 12 μ ρ f q w 2 0 which we can rearrange to find 57 p x 12 μ w 3 q thus recovering the poiseuille flow constitutive relationship between pressure and fluid flux therefore we can conclude that poiseuille flow exists within the solution space of the rdff model 3 2 2 forchheimer flow forchheimer flow is a non linear extension to darcy flow through porous media forchheimer 1901 in fracture flow this relationship takes the form 58 p x 12 μ w 3 q γ q 2 in which γ is an empirical coefficient while forchheimer flow does not see much use in modern models there have been efforts to determine the value of the empirical coefficient γ for fracture flow zimmerman et al 2004 ranjith and viete 2011 forchheimer flow offers the advantage of being a two field model u p as opposed to the three fields required by the rdff model u q p in this section we will recast the rdff model as a two field model to derive an analytical expression for the previously empirical coefficient if we assume that the flow is steady q 0 and the aperture is rigid w 0 q x 0 then we can express the pressure gradient as 59 p x 12 μ w 3 q α ρ f w 3 w x ρ f w 2 α x q 2 comparing 58 and 59 the empirical coefficient can be expressed as 60 γ α ρ f w 3 w x ρ f w 2 α x so that the constitutive relationship between pressure and fluid flux can be expressed as 61 p x 12 μ w 3 1 f 0 q 62 f 0 α ρ f 12 μ w x ρ f w 12 μ α x q in which f 0 is the nonlinear coefficient known as the forchheimer number the forchheimer number is a function of the flow rate q the fracture geometry w w and the distribution of fluid velocity across the aperture α as the fluid flux goes to zero so too does the forchheimer number and the standard poiseuille flow formulation is recovered forchheimer flow offers the advantage of being a two field model but this advantage is accompanied by physical restrictions albeit fewer restrictions than poiseuille flow this formulation for forchheimer flow is only applicable to rigid fractures and quasi steady state flow conditions 3 3 conservation of energy consider bernoulli s principle between points a and b along a rigid fracture of varying aperture in steady state laminar flow the total energy of the fluid at each point is the sum of potential energy and kinetic energy which are functions of the fluid pressure and fluid velocity respectively the points are assumed to be at the same elevation such that the difference in energy between the two points is the total energy dissipated by viscous friction we will integrate over the cross sections a and b to examine the conservation of energy of the bulk fluid we can therefore state the conservation of energy over the cross section as 63 1 2 ρ f w a 2 w a 2 v 2 d y w a 2 w a 2 p d y 1 2 ρ f w b 2 w b 2 v 2 d y w a 2 w a 2 p d y f in which f 0 is the dissipated energy assuming the velocity profile does not change between cross sections a and b constant α we can rearrange this expression to determine that the pressure difference between any two points in a fracture is equal to the energy dissipated by viscous friction plus an additional transfer of energy between kinetic energy and fluid pressure 64 δ p p b p a 1 2 α ρ f q 2 1 w a 2 1 w b 2 f when poiseuille flow is adopted we can integrate the constitutive equation between points a and b to find that the pressure difference is 65 δ p p a a b p x d x p a 66 δ p 12 μ q ξ ξ a b w 3 d x 0 comparing the terms in 64 and 66 it is clear that poiseuille flow only contains a single term to describe the dissipation by viscous friction such that f 12 μ q ξ there is no additional term to transfer energy between kinetic and potential energy and therefore the poiseuille flow constitutive model does not conserve energy when applied to flow through varying aperture fields the lost energy may be small if the difference in aperture is small but it is still non zero next consider the case of adopting the rdff model assuming constant α and β the pressure difference between any two points can be determined as 67 δ p p a a b p x d x p a 68 δ p α ρ f q 2 ξ 2 β μ q ξ 69 ξ 2 a b w 3 w x d x 1 2 1 w a 2 1 w b 2 70 δ p α ρ f q 2 1 2 1 w a 2 1 w b 2 β μ q ξ comparing 64 and 70 it is easily observed that the rdff model contains the additional term to transfer energy between kinetic energy and fluid pressure therefore the rdff model conserves energy in non uniform aperture fields while the poiseuille flow model does not the assumption of constant α is made to simplify the presentation of the analysis and energy is still conserved in the case of non constant α 4 comparisons of navier stokes rdff and poiseuille flow models in this section we will examine the solutions of the full navier stokes the rdff and the poiseuille flow models in three different simple flow problems in which closed form solutions to the poiseuille and rdff models are readily derived these comparisons will demonstrate the shortcomings of the poiseuille flow model and quantitatively measure the error in adopting the rdff and poiseuille flow models 4 1 transient fluid flow between parallel plates consider the flow through a channel of length l that is defined by rigid static parallel plates with aperture w 0 as illustrated in fig 5 the pressure at the outlet is fixed at p o u t p 0 while the pressure at the inlet oscillates such that p i n p 0 sin ω t the resulting flow rate between the inlet and outlet q is then a function of time this example demonstrates that the transient inertial behaviour of the fluid is important assuming that the flow is laminar this problem may be solved analytically for all three flow models the solution is expressed in terms of the dimensionless flux q defined as 71 q 12 μ l q w 0 3 the solution to the navier stokes model and the rdff model are identical and given by 72 q ϕ ω 2 ϕ 2 ω cos ω t ϕ sin ω t ω e ϕ t ϕ 12 μ ρ f w 0 2 in which ϕ is the natural frequency of the fluid in the channel the poiseuille flow solution is given by 73 q sin ω t the navier stokes and rdff solution is a function of the natural frequency of the fluid ϕ and the excitation frequency ω the poiseuille flow solution as it assumes quasi steady state conditions is only a function of the excitation frequency the solutions for different ratios of excitation frequency compared to natural frequency are illustrated in fig 6 when the excitation frequency is large compared to the natural frequency ω ϕ the rdff and navier stokes solutions converge to the quasi steady state poiseuille flow solution and the flow rate changes synchronously with the inlet pressure when the excitation frequency is small compared to the natural frequency ω ϕ the inertial forces are large and very little flow occurs when the excitation and natural frequency are similar ω ϕ there is strong coupling behaviour in the response of the fluid which affects the magnitude of the flow rate and causes the flow rate to lag the boundary condition this example demonstrates how transient inertial fluid forces can affect the flow rate and how the poiseuille flow model is incapable of capturing this behaviour 4 2 transient fluid flow between oscillating parallel plates consider the flow through a submerged channel of length 2 l in which the aperture is defined by parallel plates that oscillate at a fixed amplitude a and frequency ω such that w w 0 1 a sin ω t as illustrated in fig 7 the pressure at the outlets is fixed at p o u t p 0 and the flux q must be zero at the centre of the channel due to symmetry this problem captures both inertial transient and inertial convective effects since the flux is not constant along the length of the domain while the rdff and poiseuille flow solutions may be solved analytically by assuming laminar flow the navier stokes solution for this problem is non trivial both analytically and numerically due to the moving boundaries this example will therefore only compare the results of the rdff and poiseuille flow solutions for both flow models the fluid flux is given by the continuity equation such that 74 q w x the pressure profile along the channel for the poiseuille flow solution is 75 p p 0 12 μ w w 3 l 2 2 x l 2 1 the pressure profile along the channel for the rdff solution assuming constant α and β is 76 p p 0 ρ f w w 2 α w w 2 β μ w 3 w l 2 2 x l 2 1 to compare the models we can examine the dimensionless pressure at the centreline x 0 77 p p 0 t p 0 6 ω μ w 0 l 2 the dimensionless pressure at the centreline p for each model can then be simplified to 78 poiseuille p a cos ω t 1 a sin ω t 3 79 rdff p ω ϕ a sin ω t 1 a sin ω t 2 α a cos ω t 1 a sin ω t 2 a cos ω t 1 a sin ω t 3 ϕ 12 μ ρ f w 0 2 the dimensionless pressure at the centreline for an amplitude of a 0 25 is plotted as a function of time in fig 8 changing the amplitude of the oscillations increases the peak pressures but does not otherwise change the behaviour of the solutions first consider the behaviour of the quasi steady poiseuille flow model in the poiseuille flow model flow only ever moves due to the presence of a pressure gradient since the conservation of mass forces fluid in and out of the channel the pressure gradient develops to accommodate this flow when the aperture reaches a peak or a trough there is a zero pressure gradient at that instant as the fluid momentarily stops before reversing direction the time history for pressure incurs a phase shift towards the aperture troughs because the smaller apertures require larger gradients to move the fluid next consider the behaviour of the rdff model which depends on the natural frequency of the fluid ϕ when the oscillation frequency is small compared to the natural frequency ω ϕ the behaviour trends towards the quasi static poiseuille solution when the oscillation frequency is large compared to the natural frequency ω ϕ inertial effects dominate the response and the solution deviates significantly from poiseuille flow conservation of mass forces fluid in and out of the channel very quickly but the inertial forces try to resist this motion the pressure gradient thus develops in sync with the aperture oscillations but in the opposite direction to the poiseuille flow gradient when fluid is being forced into the channel the pressure increases at the centreline to try and push the fluid back out when fluid is being forced out of the channel the pressure decreases at the centreline forming a large negative backpressure which sucks the fluid back in this example illustrates the complex inertial convective behaviours that arise in problems in which fracture aperture is varies in time and which the poiseuille flow model is incapable of capturing 4 3 steady state fluid flow in channels of varying aperture consider the steady state flow through a rigid fracture of varying aperture as shown in fig 9 the domain is defined by a periodic aperture such that w x w 0 1 ɛ cos 2 π x λ w 0 in which 0 ɛ 1 is the characteristic amplitude and λ is the characteristic wavelength relative to the aperture fluid flows through the fracture at a constant rate of q the pressure at the outlet is fixed at a constant pressure p the rdff and poiseuille flow solutions can be solved analytically the solution is expressed in terms of the dimensionless pressure distribution p as a function of the non dimensionalized coordinate λ x x 80 p w 0 2 ρ f q 2 p p ξ 1 ξ x 0 x 1 81 ξ x 0 x p x d x 82 poiseuille p x λ 12 r e 1 1 ɛ cos 2 π x 3 83 rdff p x 2 π α ɛ sin 2 π x 1 ɛ cos 2 π x 3 λ 12 r e 1 1 ɛ cos 2 π x 3 the solution to the navier stokes equations for this problem is approximated using ansys fluent cfd software the computational domain is illustrated in fig 10 pressure is prescribed at the outlet while the fluid flux is prescribed at the inlet using a fully developed parabolic velocity profile the computational domain contains an inlet and outlet section with constant aperture symmetry is assumed along the centreline of the model the range of tested reynolds number is limited to ensure that the flow remains within the laminar regime such that unsymmetric phenomena like turbulence and vortex shedding are not expected the interior of the domain is three wavelengths long whose sinusoidal aperture is defined by piecewise line segments at a resolution of λ 60 the domain of interest is the central region 0 x λ as illustrated in fig 10 to compare the two dimensional pressure field obtained from cfd with the one dimensional models the average pressure over the aperture for a given position x in the two dimensional model is computed at 61 evenly spaced cross sections along the domain of interest the gradient of the extracted average pressures is computed using central differencing with a second order forward and backward differencing scheme used at each end point the error between the full navier stokes solution and the reduced dimension models ε is calculated as 84 ε i 0 1 p n s x p i x 2 d x 0 1 12 λ r e 1 ɛ 3 2 d x in which p n s x is the gradient of the average pressure from the full cfd model and p i x from either reduced dimension model the error is normalized by the pressure gradient through a parallel plate channel of width w 1 ɛ the cfd simulations were run using the 3rd order muscl flux interpolation scheme and a second order pressure interpolation scheme the cfd simulations were solved using ansys fluent s pressure based coupled solver a coarser mesh was applied to the inlet and outlet sections while a fine structured mesh was applied to the sinusoidal sections between λ x 2 λ the mesh was refined for each combination of ɛ and λ at r e 0 01 until the outputted average pressures converged to a relative change 1 0 4 from the previous mesh the number of cells ranged from 8 1 0 4 in shortest domains up to 5 1 0 5 in the longest domains the cfd model was run for amplitudes ranging from ɛ 0 to ɛ 0 7 wavelengths from λ 1 to λ 20 and reynolds numbers ranging from r e 0 01 to r e 1000 all cases converged to a steady state solution while some cases displayed stable eddy formation no cases displayed any indication of vortex shedding or developing turbulence fig 11 shows a selection of pressure contours throughout the fractures in which the rdff model performs well and performs poorly fig 12 shows the corresponding transverse velocity contours and streamlines within the fractures as seen in figs 11 and 12 the reduced dimension models perform well in cases where the transverse pressure gradients and transverse velocities are small the reduced dimension models perform poorly in cases where the transverse pressure gradients are not negligible the transverse velocities are not small and fundamentally two dimensional phenomena are observed such two dimensional phenomena include the development of eddies within the aperture peaks and the longitudinal velocity maintaining its speed as it exits the narrowed aperture regions demonstrating behaviour akin to a jet rather than fracture flow fig 13 shows the distribution of the pressure gradient over a selection of wavelengths and reynolds number at ɛ 0 3 lastly fig 14 shows the error curves as a function of reynolds number for tested wavelengths and amplitudes while fig 15 shows the relative improvement in error between the rdff and poiseuille flow models the case of ɛ 0 corresponds to parallel plates which both the poiseuille and rdff models capture exactly this case provides an estimate of the error that results from the convergence of the non linear cfd solver the cfd mesh the resolution of the extracted average pressure curve and the calculation of the numerical gradient this error of 1 0 4 is at least an order of magnitude smaller than the error observed in any of the other cases so the error observed in the other cases is attributed to the differences in the models and not the method by which the error is calculated as illustrated in fig 14 the rdff model always performs at least as well as the poiseuille flow model the exception to this trend is the quadrant with high reynolds numbers and short wavelengths in which the poiseuille model has lower error not because it is a better approximation of the physics but rather because neither model performs well the error increases with increasing amplitude and decreases with increasing wavelength as expected the error for any given wavelength and amplitude are linear piecewise continuous functions of the reynolds number at low reynolds numbers the error is constant and with increasing reynolds numbers the error increases logarithmically the transition point between the two behaviours occurs somewhere between 1 r e 100 we therefore define three flow regimes based on the reynolds number the viscous regime r e 1 the weak inertial regime 1 r e 100 and the strong inertial regime r e 100 in the viscous regime r e 1 where inertial forces are negligible the solution to the navier stokes equations is not a function of the reynolds number and is instead only a function of the geometry viscous forces dominate over inertial forces such that the non linear terms in the rdff model are small and the rdff model tends towards the poiseuille flow model and hence why no improvement in the error is observed error in this regime is generally small 5 and both reduced dimension models are generally good at predicting the pressure profile though error increases when the wavelength is short this behaviour is as expected and is consistent with observations from previous studies of poiseuille flow witherspoon et al 1980 zimmerman and bodvarsson 1996 yu et al 2017 fig 16 shows the error in the viscous regime as a function of amplitude and wavelength in the weak inertial regime 1 r e 100 inertial forces start to influence the pressure gradient the error in the poiseuille flow model increases logarithmically starting at a reynolds number of r e 1 for all aperture wavelengths and amplitudes the rdff model performs much better than poiseuille flow showing up to 400 improvements in error the rdff model also eventually demonstrates logarithmically increasing error but the transition point is much later than that of the poiseuille flow model as the wavelength increases so too does the reynolds number at which the rdff transitions from constant to logarithmically increasing error the comparably poor accuracy of the poiseuille flow model in the weak inertial regime is noteworthy because fracture flows in this domain are regularly encountered during industrial processes such as hydraulic fracturing but are also possible during natural phenomena like seismic events furthermore the poiseuille flow model demonstrates significant deviations from the navier stokes behaviour for fractures with even modest deviations from the assumed parallel plate geometry the errors associated with such modest deviations as opposed to those from surface roughness have been presumed to be small in the majority of hydraulic fracture and discrete fracture network analyses the results here demonstrate that significant deviations between the poiseuille flow and navier stokes behaviour exists in common scenarios the rdff model is significantly more accurate in the weak inertial regime for fractures with modest spatial variations in aperture in the strong inertial regime r e 100 error in both models is generally large as neither model is particularly good at predicting the pressure gradient the rdff model still sees improvements in error of at least 10 and up to 300 at long wavelengths at short wavelengths in this regime fundamentally two dimensional phenomena such as the development of stable eddies are observed in the navier stokes solution which is not the kind of behaviour that the reduced dimension models have been developed to capture the cfd solutions show that at high reynolds numbers and larger amplitudes the velocity profile resembles a jet in which flow is contained to a thin region around the centreline this suggests that improvements in error may be possible if an effective hydraulic aperture is adopted at high reynolds number rather than using the geometric aperture calculating the full navier stokes solution also means that we have access to the velocity profiles throughout each fracture we can use these velocity profiles to calculate the true values of the momentum correction factor α and the viscous friction factor β in each tested case fig 17 shows the histograms of each factor extracted from the cfd profiles any cases which exhibited negative flow in the longitudinal direction are ignored as they invalidate the assumptions behind these coefficients both factors are heavily clustered around the parabolic velocity profile values of α 1 2 and β 12 the strong inertial regime shows slightly higher standard deviations but the mean values remain close to the ideal parabolic profiles while the pressure gradient predictions may be improved using the calculated values of α and β it is not possible to determine a general empirical equation for the two factors from these cases the factors display some correlation with aperture curvature in the viscous regime but it is not possible to differentiate whether this is a correlation with aperture curvature or simply the aperture due to the cyclical nature of the sinusoidal aperture the factors also display some correlation to wavelength λ and amplitude ɛ but these are parameters specific to the considered domain therefore we recommend that the momentum correction factor α and the viscous friction factor β be considered as constants within the laminar flow regime such that the factors only change when the flow transitions into the transitional and turbulent flow regimes this example shows the quantitative improvement in the ability of the rdff model to predict the pressure gradient in the case of steady state laminar flow through rigid non parallel apertures error in both models increases with reynolds number and decreases as the wavelength increases while the error in the rdff and poiseuille models is similar in the viscous regime r e 1 the rdff model shows significant improvement in the weak inertial regime 1 r e 100 while the error increases in both models in the strong inertial regime r e 100 the rdff model still shows improvements over poiseuille flow especially at longer wavelengths 5 conclusions poiseuille flow is commonly adopted for modelling flow through fractures for its ease of use relative to the full navier stokes equations poiseuille flow has many physical assumptions and limitations and it does not conserve energy when applied to fractures of variable aperture non poiseuille flow conditions are very common in forced fracture flow processes creating a need for an alternative model that is capable of capturing the inertial and transient behaviours that arise at larger reynolds numbers without the computational burden that accompanies the full navier stokes equations in this article the alternative rdff model for flow through thin deformable fractures has been derived and verified to fulfil this niche the rdff model is demonstrated to capture complex inertial and transient behaviours under transient fluid boundary conditions and moving solid boundary conditions and conserve energy in non parallel plate geometries the rdff model is shown to recover the poiseuille flow model under poiseuille flow conditions and the non linear extension to forchheimer flow is explored the error between the full navier stokes solution and reduced dimension models is quantified for steady state laminar flow through sinusoidally varying aperture fields at moderate reynolds numbers 1 r e 100 the rdff model demonstrates up to 400 improvements in error over the poiseuille flow model while the error of the rdff model increases logarithmically at r e 100 error still improves by at least 10 at shorter wavelengths and up to 300 at longer wavelengths over poiseuille flow above reynold s numbers of r e 500 neither model performs particularly well at the cost of increased complexity the rdff model is demonstrated to be superior to the poiseuille flow model in all possible tested conditions we therefore recommend its adoption in modelling forced fracture flow processes over poiseuille flow future work surrounding the rdff model should include further verification with the full navier stokes equations for rigid and deformable moving boundary problems investigation and calibration of the momentum correction and viscous friction velocity profile factors α and β and experimental validation of the rdff model with real fracture flow data further extensions to the physics of the model should consider modifications for permeable walls with fluid leak off in porous media berkowitz 1989 mohais et al 2012 hosseini and khoei 2021 unsymmetric fractures fluid compressibility and large scale fracture networks bisdom et al 2016 credit authorship contribution statement bruce gee methodology software validation formal analysis investigation data curation writing visualization funding acquisition robert gracie conceptualization methodology resources writing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements dr gracie acknowledges the support of a discovery grant from the natural sciences and engineering research council of canada nserc bruce gee acknowledges the support of an nserc doctoral postgraduate scholarship 
147,random walk methods are particularly well suited for modeling anomalous transport processes in complex systems from heterogeneous porous domains to fractured rocks taking full advantage of their multi scale attributes these methods can be integrated into multi scale modeling strategies where they are used for i performing small scale simulations with a high level of description of the heterogeneities ii defining statistical functions that describe these heterogeneities at a larger scale and iii providing upscaled descriptions of the processes while taking into account the impact of the small scale heterogeneities in this work we define such a strategy considering i structural heterogeneities with heterogeneous porosity fields incorporated into fracture matrix systems and ii the reactivity of the system with chemical reactions that are not restricted to linear first order reactions as it is the case in existing upscaled formulations to this end we develop two new modeling methods the reactive time domain random walk r tdrw and upscaled reactive tdrw ur tdrw approaches at small and large scale respectively the numerical methods and multi scale strategy are presented with a general formulation and applied to single species transport and reaction in fracture matrix systems we analyze the impact of different levels of structural heterogeneities and the impact of the reactivity on the breakthrough curves computed at both scales and on the statistical functions that are used in the multi scale strategy this strategy is validated by demonstrating the good agreement between the results obtained at different scales showing promising applications for future work in large scale fracture networks keywords random walk methods heterogeneous systems fracture matrix systems chemical reactions statistical description upscaling methods 1 introduction modeling reactive transport processes that occur in the natural environment is a key challenge for numerous research fields and applications it requires to couple flow transport and chemical processes that are characterized by different space and time scales e g berkowitz et al 2016 references therein e g etancelin et al 2020 considering advective and diffusive mechanisms in heterogeneous geological formations amplifies the ranges of the considered scales and leads to the development of new modeling approaches and the adaptation of existing ones e g berkowitz 2002 neuman 2005 painter et al 2008 aquino and le borgne 2021 random walk rw or particle based methods are well suited to model and upscale anomalous hydrodynamic transport behavior for various scales processes and degrees of heterogeneities e g painter et al 2008 berkowitz et al 2016 noetinger et al 2016 gouze et al 2021 hyman and dentz 2021 taking into account the impact of small scale properties in large scale simulations can be done by parameterizing upscaled rw methods such as continuous time random walk ctrw with spatial and temporal statistics of the particle displacement at the small scale when these statistics are defined from numerical simulations they allow to capture the impact of heterogeneous properties on mass transfer at various scales and to represent for example pre asymptotic behavior that cannot be described by standard upscaling methods relying on the existence of a representative elementary volume rev gjetvaj et al 2015 russian et al 2016 gouze et al 2020 rw methods are also able to deal with a large range of transport regimes including large values of the peclet number in particular when they are used in dual porosity mobile immobile and fracture matrix systems dentz et al 2011 gisladottir et al 2016 cvetkovic 2017 in these cases analytical formulations that are often called memory functions are used to parametrize the diffusion times in the low porosity domain this results in running large scale transport simulations with reasonable computational resources while taking into account heterogeneous properties of the advection dominant domain while standard methods such as finite volume finite difference or finite element require a costly increase in discretization to avoid numerical dispersion issues these features and successful applications in simulating transport processes in heterogeneous systems make rw methods an ideal candidate to establish efficient and robust reactive transport models in heterogeneous systems first efforts into this challenge led so far to models that are used in academic research but they have a strong potential for a larger audience however the rw transport models that are adapted to dual porosity mobile immobile fracture matrix systems mentioned before are based on analytical solutions restricting the simulations to homogeneous properties of the low porosity domain linear relationship between the mobile and immobile domain concentrations and linear first order chemical reactions e g lichtner and kang 2007 dentz et al 2011 analytical formulations of the impact of chemical reactions on the fate of particles are also used in mesh free homogeneous domains by expressing the survival probability of each particle e g benson and meerschaert 2008 ding et al 2013 bolster et al 2016 perez et al 2019 as a result performing efficient simulations of reactive transport processes that are adapted to structural heterogeneities and various kinds of chemical reactions requires the development of new modeling approaches and strategies in this work we present a modeling approach that allows simulating advective and diffusive processes with structural heterogeneities that range from heterogeneous matrix porosity fields to the fracture matrix contrast and chemical reactions that are not restricted to linear first order expressions to this end we take advantage of the multi scale attributes of the tdrw approach and its ability to simulate advective and diffusive mechanisms in heterogeneous systems and we extend its formulation to reactive transport problems in the frame of a multi scale modeling strategy this is inspired by the work of gouze et al 2020 for inert solute in heterogeneous porous domains and it is done here through the development of two numerical methods i the r tdrw reactive tdrw approach that solves the reactive transport 2 dimensional problem at the scale of description of the domain properties i e the pixels that represent void and solid or darcy scale properties such as porosity ii the ur tdrw upscaled reactive tdrw approach that solves the problem on an 1 dimensional upscaled description of the system corresponding to a mobile immobile or dual porosity representation of the domain that is parameterized by small scale simulations in both methods solute transport is represented by the displacement of particles while the chemical reactions are modeled at the pixel scale in the small scale simulations assuming no changes in porosity during the simulations general formulations of the r tdrw and ur tdrw methods for multi species and reactions are presented in section 2 and the considered multi scale strategy in section 3 applications to fracture matrix systems with a single species transport and reaction are shown in section 4 where the presented numerical methods and strategy are validated with analytical solutions section 5 is dedicated to analyzing the impact of structural hydraulic and chemical properties on transport behavior and the ability of both r tdrw and ur tdrw models to describe it 2 methodological background 2 1 problem formulation consider the transport of n s reactive species such that the solute concentration c s x t of species s s 1 n s at position x and time t satisfies the reactive transport equation 1 ϕ x c s x t t u x c s x t d x c s x t r s c s x t with ϕ the porosity u the flow velocity d the diffusion tensor matrix and r s the reaction term related to species s in mobile immobile systems ϕ is set to 1 in the mobile domain and u to 0 in the immobile domain considering isotropic domain properties the tensor d is defined as the effective diffusion coefficient d e d m ϕ n with d m the molecular diffusion coefficient and n 1 the porosity exponent that denotes the effect of tortuosity for n 1 gouze et al 2008 and with d e d m in the mobile domain different reaction terms r s can be considered in the mobile and immobile domains with the expressions r s m and r s i m respectively 2 2 small scale modeling approach small scale simulations are performed on two dimensional domains that are discretized into pixels of regular size δ x eq 1 is solved in these systems by using a reactive tdrw approach as outlined below the displacement of particles is modeled with the tdrw approach which has been formulated for diffusive processes dentz et al 2012 and advective and diffusive processes russian et al 2016 in heterogeneous and homogeneous porosity fields respectively it is expressed here for advective and diffusive processes with space dependent porosity properties using the recursive relationships or random walk process 2 x i n 1 x j n ξ i j t n 1 t n θ j which express the displacement from pixel j to pixel i of a particle being at pixel j after n jumps with the transition length ξ i j and transition time θ j the probability w i j of jumping from pixel j to one of its neighboring pixels i is defined as 3 w i j b i j k v j b k j with b i j d i j δ x u i j δ x 2 h u i j in expression 3 v j is the set of neighboring pixels of pixel j the function h u i j is set to 1 if u i j 0 and 0 otherwise u i j is the flow velocity from pixel j to i and d i j is the harmonic mean of the diffusion coefficients in pixels i and j the time θ j associated with the jump from pixel j to one of its neighboring pixels is drawn from the exponential distribution ψ t τ j of mean τ j that is expressed as 4 ψ t τ j exp t τ j τ j with τ j ϕ j v j k v j b k j with ϕ j and v j the porosity and volume of pixel j reactions are modeled at the pixel scale with the concentration c j s of solute species s in pixel j that is defined as 5 c j s k k j m k s ϕ j v j where k j is the set of particles that are present in pixel j and m k s the mass of solute species s carried by particle k using an operator splitting approach concentration and particle mass in the pixel are updated isochronically that is at discrete times t n n δ t n 1 2 according to the chemical reaction rate r s c s x t associated with the solute species s this implies that 6 c j s c j s δ t r s ϕ j m k s c j s ϕ j v j n k j k k j with n k j the number of particles in the set k j note that after the reaction step mass is distributed equally between all particles according to the new concentration thus before the reaction step particles may carry different masses while after the reaction step they are homogenized 2 3 upscaled models the upscaled formulation of the r tdrw approach presented in section 2 2 relies on a 1d representation of the mobile domain over which advective and diffusive processes are considered and coupled to diffusion in the not physically represented immobile domain the governing equations are derived from expressions 2 and 3 which leads to moving the particles along the 1d mobile domain according to the recursive relation 7 x i n 1 x j n ξ i j with the large scale spatial transition ξ i j and the downstream w d and upstream w u probabilities 8 w d d m 2 d m u δ x w u d m u δ x 2 d m u δ x where d m u and δ x are the molecular diffusion coefficient upscaled flow velocity and pixel size of the 1d mobile domain respectively the displacement expression 7 is associated with the recursive time relation 9 t n 1 t n θ j θ j t j m t j i m t j m ψ t τ j where θ j represents the time of the particle jump from pixel j to one of its neighboring pixels including the times t j m and t j i m spent in the mobile and immobile domains respectively t j m is defined from the 1d reduced form of the tdrw approach corresponding to the exponential distribution ψ t τ j given in 4 for which the distribution mean reduces to τ j δ x 2 2 d m u δ x conversely t j i m is an upscaled description of the diffusive process in the immobile domain whose distribution p τ i m is derived from analytical solutions or small scale numerical models the displacement and time recursive expressions 7 and 9 are associated with the survival probability s j s which is the probability that a particle keeps carrying species s after jumping from pixel j to one of its neighboring pixels s j s is an upscaled description of the reactivity of the system that depends on the time spent in the mobile and immobile domains and is also derived from analytical solutions or small scale numerical simulations 3 multi scale modeling strategy 3 1 upscaled parameter definition the upscaled model presented in section 2 3 requires to define the time spent in the immobile domain t j i m and the survival probability s j s that are associated with the particle jump from pixel j to one of its neighboring pixels and the species s carried by the particle these variables are expressed as 10a t j i m h n j e e 1 n j e τ j e i m s j s s j m s e 1 n j e s j i m s with 10b h n j e 0 if n j e 0 1 otherwise n j e p p k λ j τ j e i m p τ i m 10c s j d s τ 1 n p k s τ w k d s w k d s 0 d m i m in expressions 10 we consider the following definitions n j e is the number of transfers from the mobile to immobile domains as done in gouze et al 2020 this number is drawn from the poisson distribution p p n λ j λ j n e λ j n where n is the number of events and λ j is the distribution parameter defined as λ j t j m γ with γ the time rate for the number of considered events the macro scale parameter γ is defined from small scale simulations as γ 1 τ m p τ m being the local mobile time i e the time spent in the mobile domain between two transfer events called survival time in gouze et al 2020 and p the average value over the particles the upscaled immobile time t j i m depends on the immobile local time τ j e i m which is the time spent in the immobile domain during the e th transfer event i e the time required to go back to the mobile domain for the e th transfer event and is drawn from the immobile local time distribution p τ i m s j m s and s j i m s are the survival probabilities associated with the mobile time t j m and local immobile times τ j e i m respectively that are defined from small scale simulations in expression 10c s τ is the set of particles that spent time τ in the considered domain and enter and exit the domain with the weight w k d s 0 and w k d s in species s respectively in the same expression n p is the total number of particles considered in the simulation 3 2 upscaled parameter computation the upscaled parameter γ distribution p τ i m and probabilities s j m s and s j i m s previously defined are computed from small scale simulations that are performed with the r tdrw approach presented in section 2 2 whereas these variables could be evaluated from full small scale simulations in which the initial domain is fully represented with both the mobile and immobile zones the number of required simulations and their complexity are minimized here by adapting the small scale configurations as explained below as described in table 1 computing the time rate of mobile immobile transfers γ requires to represent both the mobile and immobile domains full configuration the distribution of immobile local times p τ i m and the survival probability in the immobile domain s j i m s can be evaluated from configurations that only represent the immobile zone immobile configuration and the survival probability in the mobile domain s j m s from configurations that only represent the mobile zone mobile configuration in terms of micro scale parameter values γ and p τ i m characterize the structural properties of the system independently of the reactivity of the system implying that they can be evaluated for inert solutes with r s d 0 d i m m whereas s j m s and s j i m s characterize the reactivity of the system in the mobile and immobile domain respectively independently of the physical and structural properties of the immobile and mobile domain respectively 4 configurations and validation 4 1 considered configurations and parameters consider the fracture matrix system shown in fig 1 that corresponds to advection and diffusion processes in a fracture coupled with pure diffusion in the surrounding matrix and chemical reaction in both domains applying the modeling approaches and strategy presented in sections 2 and 3 results in a full 2d description of the system at the small scale with r tdrw and an upscaled 1d description at the fracture scale with ur tdrw in which the surrounding matrix is taken into account without being physically represented this system is considered with the two sets of parameters param1 and param2 that are provided in table 2 param1 corresponds to cases studied in tang et al 1981 and param2 to parameter values mentioned in dentz et al 2011 and gouze et al 2020 the impact of the matrix structural heterogeneities is studied by comparing the results obtained with i homogeneous porosity fields where the porosity ϕ x y is set to a constant value ϕ 0 and ii heterogeneous porosity fields defined from multi gaussian distributions whose averaged value is set to ϕ 0 various heterogeneous fields are simulated by defining a threshold porosity value ϕ t h below which ϕ is set to 0 resulting in increasing the heterogeneity field when increasing parameter ϕ t h fig 2 illustrates such heterogeneous porosity fields described with the harmonic geometric and arithmetic averages equal to 0 01 this field is generated with 1 000 pixels in each direction however when a larger number of pixels is necessary we extend its size by duplicating the porosity field in the required direction s the numerical simulations are performed by setting the size of each mesh element to 5 1 0 5 m for both r tdrw and ur tdrw the number of particles and time steps used ranges from 1 0 4 to 1 0 8 and from 10 to 1 0 5 respectively depending on the considered configurations injection of solute at the inlet of the fracture is simulated by inserting particles in the corresponding pixel at the beginning of the simulations the concentration at the outlet is evaluated by recording the particle arrival times in the fracture pixel located at x l 4 2 validation of the numerical methods the numerical methods and upscaling strategy are validated with the analytical solution provided by tang et al 1981 for a continuous injection in a single fracture surrounded with an infinite matrix assuming no diffusion in the fracture i e d m 0 m 2 s in the fracture the solute concentration at position x along the fracture relatively to the injected concentration is expressed as 11 c f x t e k x u 2 e k x u a erfc x 2 u a t k t e k x u a erfc x 2 u a t k t a b 2 ϕ d 0 t h t x u t x u where k is the decay constant of the chemical reaction r k c fig 3a shows the good agreement between analytical solution 11 and the numerical methods r tdrw and ur tdrw for the set of parameters param1 thus providing a first validation of both the numerical methods and upscaling strategy for l 0 1 m thick black and blue curves in fig 3a these parameters come from the reactive transport problems studied in tang et al 1981 with u u 1 1 1574 1 0 6 m s and u u 2 1 1574 1 0 7 m s denoted as high and low velocity cases in tang et al 1981 and k k 1 0 and k k 2 1 7797 1 0 9 s 1 corresponding to inert and reactive transport the parameters used to run the r tdrw simulations are provided in table 2 while those required for ur tdrw simulations are given in table 3 with the upscaled parameter γ computed from the r tdrw simulations as explained in section 3 the probability density function pdf of local immobile times p τ i m and the survival probability s computed from r tdrw simulations and also required for ur tdrw simulations see section 3 are provided in fig 3b and c black curves respectively the results presented in fig 3a for l 0 1 m show that the considered chemical reaction does not impact the relative concentration observed at the fracture outlet for the high velocity case u u 1 since the curves overlap for k k 1 no reaction and k k 2 corresponding to half life of t 1 2 12 35 years in this case the solute exits the system through the fracture outlet before experiencing a decrease in concentration due to the radioactive decay on the contrary applying the decay constant k 2 for the low velocity case u u 2 results in decreasing the solute concentration of late arrival times in comparison with the inert case k k 1 for which the relative concentration c f reaches 1 for long times results without reaction for a smaller value of l are also plotted to show the impact of this parameter on the transport behavior thin red and green curves in fig 3a it results in the same curve shapes for which the concentrations are observed at earlier times and upscaled with the same upscaled parameters and functions the r tdrw method and upscaled methodology are also validated by comparing the upscaled functions p τ i m and s determined from r tdrw and used in ur tdrw with analytical solutions in fig 3b the black solid line corresponds to p τ i m computed with r tdrw and the magenta thick solid line to the analytical solution presented inappendix the differences observed between these two curves for short times is explained by the numerical approximations that are made below the pixel size and the similar behavior of the curves after these short times validates the numerical method the additional curves shown in fig 3b are presented for comparing the impact of the matrix heterogeneities on the distribution of local immobile times p τ i m we observe that p τ i m is similar when considering a homogeneous porosity field with ϕ 0 01 and a heterogeneous porosity field with average porosity set to 0 01 and no porosity threshold black curve p τ i m is modified when applying a porosity threshold equal and larger than 0 01 from dashed blue to dotted green increasing the porosity threshold ϕ t h from 0 01 to 0 017 results in decreasing the proportion of large values of p τ i m showing that the matrix heterogeneity prevents the particles from spending long times in the matrix in other words increasing the threshold value acts as decreasing the effective depth of the matrix finally in fig 3c the solid lines represent the analytical solution 12 s t exp k t which denotes the relative concentration c t c 0 when considering the reaction d c d t k c with the initial concentration c 0 we see that this solution overlaps with the survival probability computed with the r tdrw method crosses for various values of the half time t 1 2 5 results and analysis in this section we aim at evaluating how the structural physical and chemical properties impact the transport of reactive elements in fracture matrix systems to do so we consider the set of parameters param2 in table 2 and compute the corresponding breakthrough curves btcs with r tdrw and ur tdrw for various péclet numbers porosity fields and chemical reactions fig 4 the upscaled functions and parameters which are computed with the r tdrw simulations and used for the ur tdrw simulations are shown in fig 5 and tables 4 and 5 and the computational performances of both methods are discussed in section 5 4 5 1 hydraulic properties fig 4a shows the btcs for various values of the péclet number that is defined as p e u b d 0 with u b and d 0 the configuration parameters described in fig 1 as expected we observe that decreasing the péclet number i e decreasing the contrast between the advective and diffusive properties results in changing the shape of the btcs it goes from an asymmetric curve with a large quantity of particles arriving at early times due to advection and a slope of 3 2 showing late arrival times due to diffusion p e 1 solid black curve to a symmetric curve characteristic of purely diffusive process p e 1 0 2 dash dotted red curve for p e 1 and p e 1 0 1 the slope is modified at time t h 5 1 0 7 s vertical thin dashed black line which corresponds to the averaged time required to reach the matrix wall i e the time required to cover the matrix width distance h showing the impact of the finite matrix block size on the arrival times fig 4a also shows how the upscaled modeling approach ur tdrw can be used to reproduce the results obtained with the small scale simulations this is done by using the pdf of local immobile times defined for a homogeneous matrix from the r tdrw method black curve in fig 5a and setting the upscaled parameter γ to 0 008 table 4 the results provided by ur tdrw fit well that from r tdrw except for the early times of p e 1 0 2 which shows the limitation of representing a almost purely diffusive behavior i e small péclet numbers with a mobile immobile or fracture matrix upscaled representation 5 2 structural heterogeneities considering the hydraulic properties associated with p e 1 fig 4b shows the impact of the matrix heterogeneities on the btcs considering multi gaussian distributions for the heterogeneous porosity fields fig 2 changing the matrix porosity field from homogeneous with ϕ 0 1 black curve to heterogeneous with ϕ t h 0 0 dashed blue curve does not impact the particle arrival times since the curves overlap however increasing the parameter ϕ t h from 0 0 dashed blue curve to 0 1 dash dotted red curve results in increasing the proportion of early arrival times and thus decreasing the quantity of particles that arrive at late times this phenomenon is enhanced when we keep increasing ϕ t h from 0 1 to 0 15 from dashed red to dash dotted green curves where we observe in addition an earlier peak of arrival times this is observed until ϕ t h reaches the value 0 2 above which no changes are observed and the curve is similar to the case ϕ 0 0 solid magenta curve i e it behaves as if there is no matrix these results show that increasing the porosity threshold results in decreasing the mass transfer from fracture to matrix until that there is no mass transfer when ϕ t h 0 2 corresponding to a pure fracture configuration without surrounding matrix note also that for ϕ t h 0 1 particles exit the matrix before they reach the matrix wall since the distribution of trapping times is cut off before the characteristic time t h as shown in fig 4a for all these cases we see that the ur tdrw method fits well the small scale simulations these results are obtained with the pdfs of local immobile times shown in fig 5a from this figure we observe that adding heterogeneities in the porosity field does not impact the distribution p τ i m since the curves for a homogeneous solid black curve and heterogeneous matrix without threshold dashed blue curve overlap increasing the porosity field complexity by increasing ϕ t h from dashed blue to dotted green curves leads to a decrease in the late arrival times and slightly increases the proportion of short arrival times showing that it is harder for the particles to circulate deep into the matrix in addition to the distributions p τ i m displayed in fig 5a the values of the upscaled parameter γ shown in tables 4 and 5 are used to obtain the ur tdrw results shown in fig 4b from table 4 we see that when ϕ increases from 0 1 to 0 12 for homogeneous porosity fields γ increases from 0 008 to 0 011 leading to more transfer from the fracture to the surrounding matrix note that these values of ϕ correspond to the various averaged values arithmetic harmonic and geometric of the multi gaussian porosity field considered in the heterogeneous case with ϕ t h 0 0 however these changes in γ are too small to impact the particle arrival times since they lead to the same ur tdrw btcs black and blue crosses in fig 4b when considering heterogeneous porosity fields with ϕ t h ranging from 0 0 to 0 2 γ varies from 0 01 which is equivalent to the homogeneous case with the porosity set to the arithmetic mean to 0 0 table 5 this shows that i the value of γ associated with the heterogeneous case with no threshold γ 0 01 for ϕ t h 0 0 is similar to that of γ associated with the homogeneous porosity set to the arithmetic mean of the multi gaussian field γ 0 01 for ϕ 0 11 and ii γ decreases from 0 01 to 0 0 when ϕ t h increases from 0 0 to 0 2 showing that increasing the matrix heterogeneities reduces the fracture matrix transfers this is observed until the extreme case ϕ t h 0 2 for which there is no fracture matrix transfer and the system behaves as a single fracture with no surrounding matrix here we focused on the impact of structural heterogeneity of the matrix on the trapping rate note however that varying the fracture aperture b also impacts on the trapping rate hyman and dentz 2021 show for a homogeneous fracture matrix system that the trapping rate is inversely proportional to the fracture aperture 5 3 chemical reactions we consider now that the transported solute is subject to the chemical reaction described by the reaction term r for simplicity we assume that the same reaction occurs in the fracture and matrix but different reactions could be modeled if needed to focus on the impact of the chemical properties the simulations are run with the homogeneous porosity field described before and as in the previous cases the péclet number is set to 1 fig 4c and d show the btcs computed with tdrw and ur tdrw for the linear reaction r k c and the non linear reaction r k c 2 respectively the survival probabilities that are computed from tdrw and used in ur tdrw are shown in fig 5b c and the upscaled parameter γ is set to the value obtained for a homogeneous porosity field with ϕ 0 1 i e γ 0 008 fig 4c shows the btcs for various values of the damkhöler number d a defined as d a k d m l h from these results we observe that i similar values are obtained for 0 d a 1 0 2 solid black curve implying that in these cases the reaction rate coefficient k is too small to impact the particle arrival times whose behavior is defined by the transport properties and ii when d a 1 0 1 the chemical reaction impacts the particle arrival times with a decrease of the proportion of long arrival times when increasing d a in the latter cases the mass transported by the particles that remain a long time in the system is consumed by the chemical reaction whereas no impact is observed on the short arrival times the same behavior is observed for the non linear reaction fig 4d with a less important impact of the reaction on the arrival times due to the initial mass transported by the particles that is smaller than 1 fig 4c d also show that the results provided by r tdrw and ur tdrw overlap which demonstrates the ability of the ur tdrw method to reproduce linear and non linear reactions considered at the small scale the behavior of the survival probabilities s fig 5b c is consistent with the observations made on the btcs with i no impact of the chemical reaction for 0 d a 1 0 2 with s 1 i e 100 of the particles survive ii a decrease of the survival probability i e an increase of the mass consumed by the reaction when d a 1 0 1 increases and iii larger values of s when considering the non linear reaction i e less mass consumed by the reaction because the initial transported mass is smaller than 1 5 4 computational performances the computational performances of the tdrw and ur tdrw methods are analyzed in the sense of the computational time required to perform the simulations in order to evaluate the impact of the peclet and damkhöler numbers on these performances we report in table 6 the computational times required to obtain the results presented in fig 4a and c all the tdrw and ur tdrw simulations are run with 1 0 6 and 1 0 5 particules respectively except when the peclet number is set to 10 1 and 10 2 for tdrw and p e 1 0 2 for ur tdrw for which n p and n p are set to 1 0 5 and 1 0 4 respectively these changes in the number of particles are necessary to maintain reasonable computation times when decreasing the peclet number when doing so high computation times are observed because it leads to configurations where there is more exchange between the fracture and surrounding matrix i e more particles transfer from the fracture to the matrix these additional transfers result in additional operations that increase the computation times for both tdrw and ur tdrw to which is added the time spent by diffusion in the matrix for tdrw this is illustrated by i similar computation times when decreasing the number of particles of one order of magnitude while decreasing p e from 1 to 10 1 for tdrw and from 10 1 to 10 2 for ur tdrw and ii an increase of one order of magnitude of the computation time when decreasing p e from 10 1 to 10 2 with the same number of particles for tdrw on the contrary we observe that working on a large range of the damkhöler number does not impact the computation time and the required number of particles since increasing the reactivity of the system does not require additional operations in the implemented methods finally comparing the computation times of the tdrw and ur tdrw methods for all the simulations considered in table 6 shows that the upscaling method results in reducing the computation times from one to two orders of magnitude 6 conclusions and discussion the multi scale modeling strategy presented in this work enables us to provide upscaled simulations of transport processes in fracture matrix systems this is done by taking into account i the contrast in transport properties between fracture and matrix advection in the fracture and diffusion in the matrix ii the structural heterogeneities at the matrix scale with heterogeneous porosity fields and iii the reactivity of the system with linear and non linear reactions defining statistical functions that describe the structural heterogeneities on one side and the reactivity of the system on the other side enables us to decouple these two features that have a determinant impact on the breakthrough curves the good agreement between the results obtained at different scales shows the validity of the multi scale procedure which could be used in future work for large scale fractured rocks simulations with multi species transport and reactions our study also shows the good computational performance offered by the upscaling method compared to the small scale modeling approach in addition this performance can be easily greatly improved by using parallel computing since the changes in transport and reactivity of each particle are independent for the small scale models the interest of parallel computing needs to be evaluated because it requires to stop the particles at each chemical time step in order to gather the information needed to simulate the chemical reaction this analysis will need to be done to conduct more complex small scale simulations such as 3d heterogeneous problems which will require additional computing resources reducing the computational cost of more complex configurations could also be done by using hybrid models that combine different scales and kinds of solutions e g tartakovsky et al 2008 battiato et al 2011 roubinet and tartakovsky 2013 for modeling specific realistic multi species chemical systems a chemical reaction rate parameter r s f c j c j s can be defined for each of the n s species and parameterized by the species concentration c j x t with j 1 n s some chemical constants denoting for instance the equilibrium concentration or the concentration required for nucleation c j and any other time dependent and or space dependent parameters such as the reactive surface area s x t the impact of the reactions on the structural properties of the system can also be considered by taking into account the changes in matrix porosity and fracture aperture and for instance the induced changes in the reactive surface area due to precipitation and dissolution reactions the structural properties will be assumed constant over a chemical time step during which particles are moved and they will be updated at the end of each time step when the chemical reactions are considered the upscaling approach embraced in this paper uses a statistical characterization of the small scale transport and reaction processes in order to establish the upscaled reactive transport model while details on the exact small scale behaviors are not retained as in general in upscaling or coarse graining efforts the proposed approach retains statistical information on the fluctuations of small scale processes which are encoded in the distribution of residence times in the matrix the representation of trapping as a poisson process and the survival probabilities that account for chemical reaction the parameters of the upscaled model reflect the small scale physical processes namely advective diffusive transport u and d m and reaction survival probability s m s in the fracture and mass transfer between fracture and matrix trapping rate γ and retention immobile time distribution p τ i m and reaction s i m s in the matrix the number of parameters remains the same when increasing the complexity of the system by introducing a distribution of porosities in the matrix however if complexity is added by introducing additional physical processes additional parameters need to be included to represent these additional processes in the large scale the numerical simulations of the detailed small scale processes are an important step in the upscaling effort because it enables to gain a physical understanding of the small scale processes and their impact on the large scale behavior which enables the systematic derivation of a physically sound large scale model credit authorship contribution statement delphine roubinet conceptualization formal analysis funding acquisition investigation methodology project administration software writing original draft writing review editing philippe gouze conceptualization funding acquisition methodology project administration writing review editing alexandre puyguiraud conceptualization writing review editing marco dentz conceptualization funding acquisition methodology project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors gratefully acknowledge the support of the cnrs pics project crosscale project no 280090 appendix analytical solution for p τ i m the distribution of trapping times inside the matrix is obtained from the solution of a first passage or strictly speaking a first return problem the distribution of trapping times is given by the distribution of times that particles spend in the matrix after they enter the matrix at the fracture matrix interface this is a well known problem and it is also well known that there is a conceptual problem regarding the return problem which is solved by considering diffusion on a grid and place the particle initially at a distance ε from the interface thus we solve now the first passage problem from a point close to the interface across the interface this means we consider the diffusion problem a 1 c y t t d 2 c y t y 2 0 where d is the diffusion coefficient in the immobile region we consider an instantaneous point injection at y y and a zero flux boundary at y h this problem can be solved straightforwardly in laplace space the laplace transform of a 1 reads as a 2 λ c y λ d 2 c y λ y 2 δ y y the solution for c y λ is a 3 c y λ cosh y h sinh y λ d b for y y and a 4 c y λ cosh y h sinh y λ d b for y y we used that concentration is continuous at y y the dirac delta on the right side of a 2 implies a jump condition for the flux this means that a 5 y ε y ε d y λ c y λ d 2 c y λ y 2 1 due to continuity of c y λ at y y this equation implies that a 6 c y λ y c y λ y 1 d thus we obtain for b a 7 b 1 λ d cosh l λ d and the solution for c y λ is a 8 c cosh y h sinh y λ d λ d cosh h λ d y y cosh y h sinh y λ d λ d cosh h λ d y y the first passage time distribution is given by the solute flux through the boundary at y 0 this means a 9 ψ λ y d c y λ y y 0 thus we obtain the explicit laplace space expression a 10 ψ λ y cosh 1 y h λ τ d cosh λ τ d where we defined τ d h 2 d in the limit h we obtain the levy distribution a 11 ψ λ y exp y λ d this expression can be laplace inverted in closed form which gives the levy smirnov density a 12 ψ t y exp y 2 4 d t 4 d t 3 the memory function is defined in terms of the trapping time distribution as a 13 φ λ lim y 0 1 λ τ 1 ψ λ the mean trapping time is obtained from a 10 as a 14 τ ψ λ y λ λ 0 thus we obtain a 15 τ y h τ d inserting a 10 and a 15 gives a 16 φ λ 1 λ τ d tanh λ τ d 
147,random walk methods are particularly well suited for modeling anomalous transport processes in complex systems from heterogeneous porous domains to fractured rocks taking full advantage of their multi scale attributes these methods can be integrated into multi scale modeling strategies where they are used for i performing small scale simulations with a high level of description of the heterogeneities ii defining statistical functions that describe these heterogeneities at a larger scale and iii providing upscaled descriptions of the processes while taking into account the impact of the small scale heterogeneities in this work we define such a strategy considering i structural heterogeneities with heterogeneous porosity fields incorporated into fracture matrix systems and ii the reactivity of the system with chemical reactions that are not restricted to linear first order reactions as it is the case in existing upscaled formulations to this end we develop two new modeling methods the reactive time domain random walk r tdrw and upscaled reactive tdrw ur tdrw approaches at small and large scale respectively the numerical methods and multi scale strategy are presented with a general formulation and applied to single species transport and reaction in fracture matrix systems we analyze the impact of different levels of structural heterogeneities and the impact of the reactivity on the breakthrough curves computed at both scales and on the statistical functions that are used in the multi scale strategy this strategy is validated by demonstrating the good agreement between the results obtained at different scales showing promising applications for future work in large scale fracture networks keywords random walk methods heterogeneous systems fracture matrix systems chemical reactions statistical description upscaling methods 1 introduction modeling reactive transport processes that occur in the natural environment is a key challenge for numerous research fields and applications it requires to couple flow transport and chemical processes that are characterized by different space and time scales e g berkowitz et al 2016 references therein e g etancelin et al 2020 considering advective and diffusive mechanisms in heterogeneous geological formations amplifies the ranges of the considered scales and leads to the development of new modeling approaches and the adaptation of existing ones e g berkowitz 2002 neuman 2005 painter et al 2008 aquino and le borgne 2021 random walk rw or particle based methods are well suited to model and upscale anomalous hydrodynamic transport behavior for various scales processes and degrees of heterogeneities e g painter et al 2008 berkowitz et al 2016 noetinger et al 2016 gouze et al 2021 hyman and dentz 2021 taking into account the impact of small scale properties in large scale simulations can be done by parameterizing upscaled rw methods such as continuous time random walk ctrw with spatial and temporal statistics of the particle displacement at the small scale when these statistics are defined from numerical simulations they allow to capture the impact of heterogeneous properties on mass transfer at various scales and to represent for example pre asymptotic behavior that cannot be described by standard upscaling methods relying on the existence of a representative elementary volume rev gjetvaj et al 2015 russian et al 2016 gouze et al 2020 rw methods are also able to deal with a large range of transport regimes including large values of the peclet number in particular when they are used in dual porosity mobile immobile and fracture matrix systems dentz et al 2011 gisladottir et al 2016 cvetkovic 2017 in these cases analytical formulations that are often called memory functions are used to parametrize the diffusion times in the low porosity domain this results in running large scale transport simulations with reasonable computational resources while taking into account heterogeneous properties of the advection dominant domain while standard methods such as finite volume finite difference or finite element require a costly increase in discretization to avoid numerical dispersion issues these features and successful applications in simulating transport processes in heterogeneous systems make rw methods an ideal candidate to establish efficient and robust reactive transport models in heterogeneous systems first efforts into this challenge led so far to models that are used in academic research but they have a strong potential for a larger audience however the rw transport models that are adapted to dual porosity mobile immobile fracture matrix systems mentioned before are based on analytical solutions restricting the simulations to homogeneous properties of the low porosity domain linear relationship between the mobile and immobile domain concentrations and linear first order chemical reactions e g lichtner and kang 2007 dentz et al 2011 analytical formulations of the impact of chemical reactions on the fate of particles are also used in mesh free homogeneous domains by expressing the survival probability of each particle e g benson and meerschaert 2008 ding et al 2013 bolster et al 2016 perez et al 2019 as a result performing efficient simulations of reactive transport processes that are adapted to structural heterogeneities and various kinds of chemical reactions requires the development of new modeling approaches and strategies in this work we present a modeling approach that allows simulating advective and diffusive processes with structural heterogeneities that range from heterogeneous matrix porosity fields to the fracture matrix contrast and chemical reactions that are not restricted to linear first order expressions to this end we take advantage of the multi scale attributes of the tdrw approach and its ability to simulate advective and diffusive mechanisms in heterogeneous systems and we extend its formulation to reactive transport problems in the frame of a multi scale modeling strategy this is inspired by the work of gouze et al 2020 for inert solute in heterogeneous porous domains and it is done here through the development of two numerical methods i the r tdrw reactive tdrw approach that solves the reactive transport 2 dimensional problem at the scale of description of the domain properties i e the pixels that represent void and solid or darcy scale properties such as porosity ii the ur tdrw upscaled reactive tdrw approach that solves the problem on an 1 dimensional upscaled description of the system corresponding to a mobile immobile or dual porosity representation of the domain that is parameterized by small scale simulations in both methods solute transport is represented by the displacement of particles while the chemical reactions are modeled at the pixel scale in the small scale simulations assuming no changes in porosity during the simulations general formulations of the r tdrw and ur tdrw methods for multi species and reactions are presented in section 2 and the considered multi scale strategy in section 3 applications to fracture matrix systems with a single species transport and reaction are shown in section 4 where the presented numerical methods and strategy are validated with analytical solutions section 5 is dedicated to analyzing the impact of structural hydraulic and chemical properties on transport behavior and the ability of both r tdrw and ur tdrw models to describe it 2 methodological background 2 1 problem formulation consider the transport of n s reactive species such that the solute concentration c s x t of species s s 1 n s at position x and time t satisfies the reactive transport equation 1 ϕ x c s x t t u x c s x t d x c s x t r s c s x t with ϕ the porosity u the flow velocity d the diffusion tensor matrix and r s the reaction term related to species s in mobile immobile systems ϕ is set to 1 in the mobile domain and u to 0 in the immobile domain considering isotropic domain properties the tensor d is defined as the effective diffusion coefficient d e d m ϕ n with d m the molecular diffusion coefficient and n 1 the porosity exponent that denotes the effect of tortuosity for n 1 gouze et al 2008 and with d e d m in the mobile domain different reaction terms r s can be considered in the mobile and immobile domains with the expressions r s m and r s i m respectively 2 2 small scale modeling approach small scale simulations are performed on two dimensional domains that are discretized into pixels of regular size δ x eq 1 is solved in these systems by using a reactive tdrw approach as outlined below the displacement of particles is modeled with the tdrw approach which has been formulated for diffusive processes dentz et al 2012 and advective and diffusive processes russian et al 2016 in heterogeneous and homogeneous porosity fields respectively it is expressed here for advective and diffusive processes with space dependent porosity properties using the recursive relationships or random walk process 2 x i n 1 x j n ξ i j t n 1 t n θ j which express the displacement from pixel j to pixel i of a particle being at pixel j after n jumps with the transition length ξ i j and transition time θ j the probability w i j of jumping from pixel j to one of its neighboring pixels i is defined as 3 w i j b i j k v j b k j with b i j d i j δ x u i j δ x 2 h u i j in expression 3 v j is the set of neighboring pixels of pixel j the function h u i j is set to 1 if u i j 0 and 0 otherwise u i j is the flow velocity from pixel j to i and d i j is the harmonic mean of the diffusion coefficients in pixels i and j the time θ j associated with the jump from pixel j to one of its neighboring pixels is drawn from the exponential distribution ψ t τ j of mean τ j that is expressed as 4 ψ t τ j exp t τ j τ j with τ j ϕ j v j k v j b k j with ϕ j and v j the porosity and volume of pixel j reactions are modeled at the pixel scale with the concentration c j s of solute species s in pixel j that is defined as 5 c j s k k j m k s ϕ j v j where k j is the set of particles that are present in pixel j and m k s the mass of solute species s carried by particle k using an operator splitting approach concentration and particle mass in the pixel are updated isochronically that is at discrete times t n n δ t n 1 2 according to the chemical reaction rate r s c s x t associated with the solute species s this implies that 6 c j s c j s δ t r s ϕ j m k s c j s ϕ j v j n k j k k j with n k j the number of particles in the set k j note that after the reaction step mass is distributed equally between all particles according to the new concentration thus before the reaction step particles may carry different masses while after the reaction step they are homogenized 2 3 upscaled models the upscaled formulation of the r tdrw approach presented in section 2 2 relies on a 1d representation of the mobile domain over which advective and diffusive processes are considered and coupled to diffusion in the not physically represented immobile domain the governing equations are derived from expressions 2 and 3 which leads to moving the particles along the 1d mobile domain according to the recursive relation 7 x i n 1 x j n ξ i j with the large scale spatial transition ξ i j and the downstream w d and upstream w u probabilities 8 w d d m 2 d m u δ x w u d m u δ x 2 d m u δ x where d m u and δ x are the molecular diffusion coefficient upscaled flow velocity and pixel size of the 1d mobile domain respectively the displacement expression 7 is associated with the recursive time relation 9 t n 1 t n θ j θ j t j m t j i m t j m ψ t τ j where θ j represents the time of the particle jump from pixel j to one of its neighboring pixels including the times t j m and t j i m spent in the mobile and immobile domains respectively t j m is defined from the 1d reduced form of the tdrw approach corresponding to the exponential distribution ψ t τ j given in 4 for which the distribution mean reduces to τ j δ x 2 2 d m u δ x conversely t j i m is an upscaled description of the diffusive process in the immobile domain whose distribution p τ i m is derived from analytical solutions or small scale numerical models the displacement and time recursive expressions 7 and 9 are associated with the survival probability s j s which is the probability that a particle keeps carrying species s after jumping from pixel j to one of its neighboring pixels s j s is an upscaled description of the reactivity of the system that depends on the time spent in the mobile and immobile domains and is also derived from analytical solutions or small scale numerical simulations 3 multi scale modeling strategy 3 1 upscaled parameter definition the upscaled model presented in section 2 3 requires to define the time spent in the immobile domain t j i m and the survival probability s j s that are associated with the particle jump from pixel j to one of its neighboring pixels and the species s carried by the particle these variables are expressed as 10a t j i m h n j e e 1 n j e τ j e i m s j s s j m s e 1 n j e s j i m s with 10b h n j e 0 if n j e 0 1 otherwise n j e p p k λ j τ j e i m p τ i m 10c s j d s τ 1 n p k s τ w k d s w k d s 0 d m i m in expressions 10 we consider the following definitions n j e is the number of transfers from the mobile to immobile domains as done in gouze et al 2020 this number is drawn from the poisson distribution p p n λ j λ j n e λ j n where n is the number of events and λ j is the distribution parameter defined as λ j t j m γ with γ the time rate for the number of considered events the macro scale parameter γ is defined from small scale simulations as γ 1 τ m p τ m being the local mobile time i e the time spent in the mobile domain between two transfer events called survival time in gouze et al 2020 and p the average value over the particles the upscaled immobile time t j i m depends on the immobile local time τ j e i m which is the time spent in the immobile domain during the e th transfer event i e the time required to go back to the mobile domain for the e th transfer event and is drawn from the immobile local time distribution p τ i m s j m s and s j i m s are the survival probabilities associated with the mobile time t j m and local immobile times τ j e i m respectively that are defined from small scale simulations in expression 10c s τ is the set of particles that spent time τ in the considered domain and enter and exit the domain with the weight w k d s 0 and w k d s in species s respectively in the same expression n p is the total number of particles considered in the simulation 3 2 upscaled parameter computation the upscaled parameter γ distribution p τ i m and probabilities s j m s and s j i m s previously defined are computed from small scale simulations that are performed with the r tdrw approach presented in section 2 2 whereas these variables could be evaluated from full small scale simulations in which the initial domain is fully represented with both the mobile and immobile zones the number of required simulations and their complexity are minimized here by adapting the small scale configurations as explained below as described in table 1 computing the time rate of mobile immobile transfers γ requires to represent both the mobile and immobile domains full configuration the distribution of immobile local times p τ i m and the survival probability in the immobile domain s j i m s can be evaluated from configurations that only represent the immobile zone immobile configuration and the survival probability in the mobile domain s j m s from configurations that only represent the mobile zone mobile configuration in terms of micro scale parameter values γ and p τ i m characterize the structural properties of the system independently of the reactivity of the system implying that they can be evaluated for inert solutes with r s d 0 d i m m whereas s j m s and s j i m s characterize the reactivity of the system in the mobile and immobile domain respectively independently of the physical and structural properties of the immobile and mobile domain respectively 4 configurations and validation 4 1 considered configurations and parameters consider the fracture matrix system shown in fig 1 that corresponds to advection and diffusion processes in a fracture coupled with pure diffusion in the surrounding matrix and chemical reaction in both domains applying the modeling approaches and strategy presented in sections 2 and 3 results in a full 2d description of the system at the small scale with r tdrw and an upscaled 1d description at the fracture scale with ur tdrw in which the surrounding matrix is taken into account without being physically represented this system is considered with the two sets of parameters param1 and param2 that are provided in table 2 param1 corresponds to cases studied in tang et al 1981 and param2 to parameter values mentioned in dentz et al 2011 and gouze et al 2020 the impact of the matrix structural heterogeneities is studied by comparing the results obtained with i homogeneous porosity fields where the porosity ϕ x y is set to a constant value ϕ 0 and ii heterogeneous porosity fields defined from multi gaussian distributions whose averaged value is set to ϕ 0 various heterogeneous fields are simulated by defining a threshold porosity value ϕ t h below which ϕ is set to 0 resulting in increasing the heterogeneity field when increasing parameter ϕ t h fig 2 illustrates such heterogeneous porosity fields described with the harmonic geometric and arithmetic averages equal to 0 01 this field is generated with 1 000 pixels in each direction however when a larger number of pixels is necessary we extend its size by duplicating the porosity field in the required direction s the numerical simulations are performed by setting the size of each mesh element to 5 1 0 5 m for both r tdrw and ur tdrw the number of particles and time steps used ranges from 1 0 4 to 1 0 8 and from 10 to 1 0 5 respectively depending on the considered configurations injection of solute at the inlet of the fracture is simulated by inserting particles in the corresponding pixel at the beginning of the simulations the concentration at the outlet is evaluated by recording the particle arrival times in the fracture pixel located at x l 4 2 validation of the numerical methods the numerical methods and upscaling strategy are validated with the analytical solution provided by tang et al 1981 for a continuous injection in a single fracture surrounded with an infinite matrix assuming no diffusion in the fracture i e d m 0 m 2 s in the fracture the solute concentration at position x along the fracture relatively to the injected concentration is expressed as 11 c f x t e k x u 2 e k x u a erfc x 2 u a t k t e k x u a erfc x 2 u a t k t a b 2 ϕ d 0 t h t x u t x u where k is the decay constant of the chemical reaction r k c fig 3a shows the good agreement between analytical solution 11 and the numerical methods r tdrw and ur tdrw for the set of parameters param1 thus providing a first validation of both the numerical methods and upscaling strategy for l 0 1 m thick black and blue curves in fig 3a these parameters come from the reactive transport problems studied in tang et al 1981 with u u 1 1 1574 1 0 6 m s and u u 2 1 1574 1 0 7 m s denoted as high and low velocity cases in tang et al 1981 and k k 1 0 and k k 2 1 7797 1 0 9 s 1 corresponding to inert and reactive transport the parameters used to run the r tdrw simulations are provided in table 2 while those required for ur tdrw simulations are given in table 3 with the upscaled parameter γ computed from the r tdrw simulations as explained in section 3 the probability density function pdf of local immobile times p τ i m and the survival probability s computed from r tdrw simulations and also required for ur tdrw simulations see section 3 are provided in fig 3b and c black curves respectively the results presented in fig 3a for l 0 1 m show that the considered chemical reaction does not impact the relative concentration observed at the fracture outlet for the high velocity case u u 1 since the curves overlap for k k 1 no reaction and k k 2 corresponding to half life of t 1 2 12 35 years in this case the solute exits the system through the fracture outlet before experiencing a decrease in concentration due to the radioactive decay on the contrary applying the decay constant k 2 for the low velocity case u u 2 results in decreasing the solute concentration of late arrival times in comparison with the inert case k k 1 for which the relative concentration c f reaches 1 for long times results without reaction for a smaller value of l are also plotted to show the impact of this parameter on the transport behavior thin red and green curves in fig 3a it results in the same curve shapes for which the concentrations are observed at earlier times and upscaled with the same upscaled parameters and functions the r tdrw method and upscaled methodology are also validated by comparing the upscaled functions p τ i m and s determined from r tdrw and used in ur tdrw with analytical solutions in fig 3b the black solid line corresponds to p τ i m computed with r tdrw and the magenta thick solid line to the analytical solution presented inappendix the differences observed between these two curves for short times is explained by the numerical approximations that are made below the pixel size and the similar behavior of the curves after these short times validates the numerical method the additional curves shown in fig 3b are presented for comparing the impact of the matrix heterogeneities on the distribution of local immobile times p τ i m we observe that p τ i m is similar when considering a homogeneous porosity field with ϕ 0 01 and a heterogeneous porosity field with average porosity set to 0 01 and no porosity threshold black curve p τ i m is modified when applying a porosity threshold equal and larger than 0 01 from dashed blue to dotted green increasing the porosity threshold ϕ t h from 0 01 to 0 017 results in decreasing the proportion of large values of p τ i m showing that the matrix heterogeneity prevents the particles from spending long times in the matrix in other words increasing the threshold value acts as decreasing the effective depth of the matrix finally in fig 3c the solid lines represent the analytical solution 12 s t exp k t which denotes the relative concentration c t c 0 when considering the reaction d c d t k c with the initial concentration c 0 we see that this solution overlaps with the survival probability computed with the r tdrw method crosses for various values of the half time t 1 2 5 results and analysis in this section we aim at evaluating how the structural physical and chemical properties impact the transport of reactive elements in fracture matrix systems to do so we consider the set of parameters param2 in table 2 and compute the corresponding breakthrough curves btcs with r tdrw and ur tdrw for various péclet numbers porosity fields and chemical reactions fig 4 the upscaled functions and parameters which are computed with the r tdrw simulations and used for the ur tdrw simulations are shown in fig 5 and tables 4 and 5 and the computational performances of both methods are discussed in section 5 4 5 1 hydraulic properties fig 4a shows the btcs for various values of the péclet number that is defined as p e u b d 0 with u b and d 0 the configuration parameters described in fig 1 as expected we observe that decreasing the péclet number i e decreasing the contrast between the advective and diffusive properties results in changing the shape of the btcs it goes from an asymmetric curve with a large quantity of particles arriving at early times due to advection and a slope of 3 2 showing late arrival times due to diffusion p e 1 solid black curve to a symmetric curve characteristic of purely diffusive process p e 1 0 2 dash dotted red curve for p e 1 and p e 1 0 1 the slope is modified at time t h 5 1 0 7 s vertical thin dashed black line which corresponds to the averaged time required to reach the matrix wall i e the time required to cover the matrix width distance h showing the impact of the finite matrix block size on the arrival times fig 4a also shows how the upscaled modeling approach ur tdrw can be used to reproduce the results obtained with the small scale simulations this is done by using the pdf of local immobile times defined for a homogeneous matrix from the r tdrw method black curve in fig 5a and setting the upscaled parameter γ to 0 008 table 4 the results provided by ur tdrw fit well that from r tdrw except for the early times of p e 1 0 2 which shows the limitation of representing a almost purely diffusive behavior i e small péclet numbers with a mobile immobile or fracture matrix upscaled representation 5 2 structural heterogeneities considering the hydraulic properties associated with p e 1 fig 4b shows the impact of the matrix heterogeneities on the btcs considering multi gaussian distributions for the heterogeneous porosity fields fig 2 changing the matrix porosity field from homogeneous with ϕ 0 1 black curve to heterogeneous with ϕ t h 0 0 dashed blue curve does not impact the particle arrival times since the curves overlap however increasing the parameter ϕ t h from 0 0 dashed blue curve to 0 1 dash dotted red curve results in increasing the proportion of early arrival times and thus decreasing the quantity of particles that arrive at late times this phenomenon is enhanced when we keep increasing ϕ t h from 0 1 to 0 15 from dashed red to dash dotted green curves where we observe in addition an earlier peak of arrival times this is observed until ϕ t h reaches the value 0 2 above which no changes are observed and the curve is similar to the case ϕ 0 0 solid magenta curve i e it behaves as if there is no matrix these results show that increasing the porosity threshold results in decreasing the mass transfer from fracture to matrix until that there is no mass transfer when ϕ t h 0 2 corresponding to a pure fracture configuration without surrounding matrix note also that for ϕ t h 0 1 particles exit the matrix before they reach the matrix wall since the distribution of trapping times is cut off before the characteristic time t h as shown in fig 4a for all these cases we see that the ur tdrw method fits well the small scale simulations these results are obtained with the pdfs of local immobile times shown in fig 5a from this figure we observe that adding heterogeneities in the porosity field does not impact the distribution p τ i m since the curves for a homogeneous solid black curve and heterogeneous matrix without threshold dashed blue curve overlap increasing the porosity field complexity by increasing ϕ t h from dashed blue to dotted green curves leads to a decrease in the late arrival times and slightly increases the proportion of short arrival times showing that it is harder for the particles to circulate deep into the matrix in addition to the distributions p τ i m displayed in fig 5a the values of the upscaled parameter γ shown in tables 4 and 5 are used to obtain the ur tdrw results shown in fig 4b from table 4 we see that when ϕ increases from 0 1 to 0 12 for homogeneous porosity fields γ increases from 0 008 to 0 011 leading to more transfer from the fracture to the surrounding matrix note that these values of ϕ correspond to the various averaged values arithmetic harmonic and geometric of the multi gaussian porosity field considered in the heterogeneous case with ϕ t h 0 0 however these changes in γ are too small to impact the particle arrival times since they lead to the same ur tdrw btcs black and blue crosses in fig 4b when considering heterogeneous porosity fields with ϕ t h ranging from 0 0 to 0 2 γ varies from 0 01 which is equivalent to the homogeneous case with the porosity set to the arithmetic mean to 0 0 table 5 this shows that i the value of γ associated with the heterogeneous case with no threshold γ 0 01 for ϕ t h 0 0 is similar to that of γ associated with the homogeneous porosity set to the arithmetic mean of the multi gaussian field γ 0 01 for ϕ 0 11 and ii γ decreases from 0 01 to 0 0 when ϕ t h increases from 0 0 to 0 2 showing that increasing the matrix heterogeneities reduces the fracture matrix transfers this is observed until the extreme case ϕ t h 0 2 for which there is no fracture matrix transfer and the system behaves as a single fracture with no surrounding matrix here we focused on the impact of structural heterogeneity of the matrix on the trapping rate note however that varying the fracture aperture b also impacts on the trapping rate hyman and dentz 2021 show for a homogeneous fracture matrix system that the trapping rate is inversely proportional to the fracture aperture 5 3 chemical reactions we consider now that the transported solute is subject to the chemical reaction described by the reaction term r for simplicity we assume that the same reaction occurs in the fracture and matrix but different reactions could be modeled if needed to focus on the impact of the chemical properties the simulations are run with the homogeneous porosity field described before and as in the previous cases the péclet number is set to 1 fig 4c and d show the btcs computed with tdrw and ur tdrw for the linear reaction r k c and the non linear reaction r k c 2 respectively the survival probabilities that are computed from tdrw and used in ur tdrw are shown in fig 5b c and the upscaled parameter γ is set to the value obtained for a homogeneous porosity field with ϕ 0 1 i e γ 0 008 fig 4c shows the btcs for various values of the damkhöler number d a defined as d a k d m l h from these results we observe that i similar values are obtained for 0 d a 1 0 2 solid black curve implying that in these cases the reaction rate coefficient k is too small to impact the particle arrival times whose behavior is defined by the transport properties and ii when d a 1 0 1 the chemical reaction impacts the particle arrival times with a decrease of the proportion of long arrival times when increasing d a in the latter cases the mass transported by the particles that remain a long time in the system is consumed by the chemical reaction whereas no impact is observed on the short arrival times the same behavior is observed for the non linear reaction fig 4d with a less important impact of the reaction on the arrival times due to the initial mass transported by the particles that is smaller than 1 fig 4c d also show that the results provided by r tdrw and ur tdrw overlap which demonstrates the ability of the ur tdrw method to reproduce linear and non linear reactions considered at the small scale the behavior of the survival probabilities s fig 5b c is consistent with the observations made on the btcs with i no impact of the chemical reaction for 0 d a 1 0 2 with s 1 i e 100 of the particles survive ii a decrease of the survival probability i e an increase of the mass consumed by the reaction when d a 1 0 1 increases and iii larger values of s when considering the non linear reaction i e less mass consumed by the reaction because the initial transported mass is smaller than 1 5 4 computational performances the computational performances of the tdrw and ur tdrw methods are analyzed in the sense of the computational time required to perform the simulations in order to evaluate the impact of the peclet and damkhöler numbers on these performances we report in table 6 the computational times required to obtain the results presented in fig 4a and c all the tdrw and ur tdrw simulations are run with 1 0 6 and 1 0 5 particules respectively except when the peclet number is set to 10 1 and 10 2 for tdrw and p e 1 0 2 for ur tdrw for which n p and n p are set to 1 0 5 and 1 0 4 respectively these changes in the number of particles are necessary to maintain reasonable computation times when decreasing the peclet number when doing so high computation times are observed because it leads to configurations where there is more exchange between the fracture and surrounding matrix i e more particles transfer from the fracture to the matrix these additional transfers result in additional operations that increase the computation times for both tdrw and ur tdrw to which is added the time spent by diffusion in the matrix for tdrw this is illustrated by i similar computation times when decreasing the number of particles of one order of magnitude while decreasing p e from 1 to 10 1 for tdrw and from 10 1 to 10 2 for ur tdrw and ii an increase of one order of magnitude of the computation time when decreasing p e from 10 1 to 10 2 with the same number of particles for tdrw on the contrary we observe that working on a large range of the damkhöler number does not impact the computation time and the required number of particles since increasing the reactivity of the system does not require additional operations in the implemented methods finally comparing the computation times of the tdrw and ur tdrw methods for all the simulations considered in table 6 shows that the upscaling method results in reducing the computation times from one to two orders of magnitude 6 conclusions and discussion the multi scale modeling strategy presented in this work enables us to provide upscaled simulations of transport processes in fracture matrix systems this is done by taking into account i the contrast in transport properties between fracture and matrix advection in the fracture and diffusion in the matrix ii the structural heterogeneities at the matrix scale with heterogeneous porosity fields and iii the reactivity of the system with linear and non linear reactions defining statistical functions that describe the structural heterogeneities on one side and the reactivity of the system on the other side enables us to decouple these two features that have a determinant impact on the breakthrough curves the good agreement between the results obtained at different scales shows the validity of the multi scale procedure which could be used in future work for large scale fractured rocks simulations with multi species transport and reactions our study also shows the good computational performance offered by the upscaling method compared to the small scale modeling approach in addition this performance can be easily greatly improved by using parallel computing since the changes in transport and reactivity of each particle are independent for the small scale models the interest of parallel computing needs to be evaluated because it requires to stop the particles at each chemical time step in order to gather the information needed to simulate the chemical reaction this analysis will need to be done to conduct more complex small scale simulations such as 3d heterogeneous problems which will require additional computing resources reducing the computational cost of more complex configurations could also be done by using hybrid models that combine different scales and kinds of solutions e g tartakovsky et al 2008 battiato et al 2011 roubinet and tartakovsky 2013 for modeling specific realistic multi species chemical systems a chemical reaction rate parameter r s f c j c j s can be defined for each of the n s species and parameterized by the species concentration c j x t with j 1 n s some chemical constants denoting for instance the equilibrium concentration or the concentration required for nucleation c j and any other time dependent and or space dependent parameters such as the reactive surface area s x t the impact of the reactions on the structural properties of the system can also be considered by taking into account the changes in matrix porosity and fracture aperture and for instance the induced changes in the reactive surface area due to precipitation and dissolution reactions the structural properties will be assumed constant over a chemical time step during which particles are moved and they will be updated at the end of each time step when the chemical reactions are considered the upscaling approach embraced in this paper uses a statistical characterization of the small scale transport and reaction processes in order to establish the upscaled reactive transport model while details on the exact small scale behaviors are not retained as in general in upscaling or coarse graining efforts the proposed approach retains statistical information on the fluctuations of small scale processes which are encoded in the distribution of residence times in the matrix the representation of trapping as a poisson process and the survival probabilities that account for chemical reaction the parameters of the upscaled model reflect the small scale physical processes namely advective diffusive transport u and d m and reaction survival probability s m s in the fracture and mass transfer between fracture and matrix trapping rate γ and retention immobile time distribution p τ i m and reaction s i m s in the matrix the number of parameters remains the same when increasing the complexity of the system by introducing a distribution of porosities in the matrix however if complexity is added by introducing additional physical processes additional parameters need to be included to represent these additional processes in the large scale the numerical simulations of the detailed small scale processes are an important step in the upscaling effort because it enables to gain a physical understanding of the small scale processes and their impact on the large scale behavior which enables the systematic derivation of a physically sound large scale model credit authorship contribution statement delphine roubinet conceptualization formal analysis funding acquisition investigation methodology project administration software writing original draft writing review editing philippe gouze conceptualization funding acquisition methodology project administration writing review editing alexandre puyguiraud conceptualization writing review editing marco dentz conceptualization funding acquisition methodology project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors gratefully acknowledge the support of the cnrs pics project crosscale project no 280090 appendix analytical solution for p τ i m the distribution of trapping times inside the matrix is obtained from the solution of a first passage or strictly speaking a first return problem the distribution of trapping times is given by the distribution of times that particles spend in the matrix after they enter the matrix at the fracture matrix interface this is a well known problem and it is also well known that there is a conceptual problem regarding the return problem which is solved by considering diffusion on a grid and place the particle initially at a distance ε from the interface thus we solve now the first passage problem from a point close to the interface across the interface this means we consider the diffusion problem a 1 c y t t d 2 c y t y 2 0 where d is the diffusion coefficient in the immobile region we consider an instantaneous point injection at y y and a zero flux boundary at y h this problem can be solved straightforwardly in laplace space the laplace transform of a 1 reads as a 2 λ c y λ d 2 c y λ y 2 δ y y the solution for c y λ is a 3 c y λ cosh y h sinh y λ d b for y y and a 4 c y λ cosh y h sinh y λ d b for y y we used that concentration is continuous at y y the dirac delta on the right side of a 2 implies a jump condition for the flux this means that a 5 y ε y ε d y λ c y λ d 2 c y λ y 2 1 due to continuity of c y λ at y y this equation implies that a 6 c y λ y c y λ y 1 d thus we obtain for b a 7 b 1 λ d cosh l λ d and the solution for c y λ is a 8 c cosh y h sinh y λ d λ d cosh h λ d y y cosh y h sinh y λ d λ d cosh h λ d y y the first passage time distribution is given by the solute flux through the boundary at y 0 this means a 9 ψ λ y d c y λ y y 0 thus we obtain the explicit laplace space expression a 10 ψ λ y cosh 1 y h λ τ d cosh λ τ d where we defined τ d h 2 d in the limit h we obtain the levy distribution a 11 ψ λ y exp y λ d this expression can be laplace inverted in closed form which gives the levy smirnov density a 12 ψ t y exp y 2 4 d t 4 d t 3 the memory function is defined in terms of the trapping time distribution as a 13 φ λ lim y 0 1 λ τ 1 ψ λ the mean trapping time is obtained from a 10 as a 14 τ ψ λ y λ λ 0 thus we obtain a 15 τ y h τ d inserting a 10 and a 15 gives a 16 φ λ 1 λ τ d tanh λ τ d 
148,a semi analytical method and the dual porosity model are used to simulate matrix diffusion between parallel fractures the semi analytical modeling parameters can be computed directly using the fracture spacing aperture and matrix properties those parameters do not require calibration to match an analytical solution for matrix diffusion the dual porosity model is applied under the same conditions and its first order mass transfer coefficient is estimated using a shape factor formula an expression of the characteristic diffusion time of the dual porosity method is defined based on fracture spacing and matrix characteristics the dual porosity method can adequately simulate matrix diffusion with a single mass transfer coefficient when the simulation time of the parallel fractures system exceeds the characteristic diffusion time for large fracture spacing the characteristic diffusion time becomes large and the dual porosity method produces less satisfactory results the highest average marginal normalized root mean square error nrmse of the dual porosity model was 18 with calibrations under no decay and no retardation conditions considerations of decay and retardation increased the dual porosity s highest calibrated nrmse to 20 meanwhile the errors between the semi analytical method and the analytical solution were low at nrmses of 5 or less with or without decay and retardation over a range of fracture spacing keywords matrix diffusion dual porosity semi analytical method remchlor md mass transfer coefficient characteristic diffusion time 1 introduction groundwater is susceptible to a variety of contaminants including chlorinated solvents and per and polyfluoroakyl substances those contaminants often form extended dissolved plumes that persist for several decades following their release cherry and mackay 1989 parker et al 1994 1997 esposito and thomson 1999 o hara et al 2000 liu and ball 2002 falta 2005 parker et al 2008 sale et al 2013 a primary cause of plume persistence is a process known colloquially as matrix diffusion whereby a contaminant diffuses from low permeability zones to high permeability zones after a loading period chapman and parker 2005 parker et al 2008 in the loading period the contaminant is released and moves by advection through high permeability areas and diffuses into low permeability areas when clean water is flushed through the system in an unloading period the concentration gradient between the high and low permeability areas reverses creating a condition where the contaminant mass diffuses from the low permeability areas back into the high permeability areas the word matrix in the name of this particular diffusion process originally refers to the low permeability rock adjacent to a fracture which has a much larger permeability than the unfractured matrix recently researchers have emphasized that matrix diffusion can be used to generally describe the mass transfer process between a low permeability zone and a high permeability zone farhat et al 2020 for example in a sand aquifer the matrix can be in the form of clay or silt lenses matrix diffusion is particularly prevalent in highly heterogeneous saturated zones where the porosity of the low permeability areas can be significant allowing the contaminant mass to be loaded in large quantity ball et al 1997 esposito and thomson 1999 parker et al 1994 1997 2004 2008 rasa et al 2011 1 1 previous analytical approaches the baseline of groundwater flow and contaminant transport modeling began in the 1970s when researchers developed the classical advection dispersion equation ade under the assumption that contaminants existed mostly in the dissolved phase and that they could be flushed out of a homogeneous aquifer by pump and treat systems smith and coats 1964 bredehoeft and pinder 1973 konikow 2011 hadley and newell 2014 however when the classical ade is utilized to model contaminant transport in heterogeneous media only molecular diffusion in the high permeability zones is accounted for as part of a hydrodynamic dispersion term not matrix diffusion smith and coats 1964 van genuchten and wierenga 1976 zheng and bennett 2002 the lack of consideration for fine scale diffusion into the low permeability materials and the subsequent release from those zones in the ade explained the ineffectiveness of some pump and treat systems in remediating persistent plumes hadley and newell 2014 analytical solutions capable of simulating matrix diffusion are available but they are typically restricted to a few specific systems such as in the case of a single thin fracture tang et al 1981 and discrete multiple parallel fractures sudicky and frind 1982 in a layered sand silt system when the sand layer is sufficiently thin and the system is well mixed sudicky et al 1985 and starr et al 1985 developed analytical solutions for nonreactive and reactive tracers liu et al 2017 expanded on the analytical solution of tang et al 1981 by allowing for variable advective velocity and dispersion in multiple fracture channels they utilized a response function in their model to specifically capture the fine scale mass exchange between the fracture and the matrix in cases when the peclet number is large and diffusion is limiting however in exchange for improvements to the tang et al 1981 solution the liu et al 2017 solution only works for non sorbing solutes and at high flow rates sale et al 2008 and farhat et al 2012 developed a two dimensional 2 d analytical solution for systems consisting of two semi infinite high permeability and low permeability layers in a case when a finite source exponentially depletes from aquitards bounded by no flux boundaries yang et al 2019 presented a one dimensional 1 d analytical solution for both the loading and unloading periods their analytical solution matched well with the experimental data during the loading of the source and after the source completely depleted analytical solutions give exact concentration profiles efficiently but a new solution needs to be developed whenever the geometry or boundary condition changes 1 2 dual porosity model to simulate matrix diffusion an alternative to utilizing analytical solutions is to capture matrix diffusion using numerical models with spatial and temporal discretization numerous researchers in the literature succeeded at using this type of fine grid numerical model to capture heterogeneity and matrix diffusion at a small scale pruess 1985 chapman et al 2012 parker et al 2008 chapman et al 2012 sale et al 2013 farhat et al 2020 among the numerical codes available mt3dms is a popular choice capable of modeling the advective dispersive and diffusive transport of multiple species zheng and wang 1999 mt3dms has gained wide use because it is directly compatible with the ubiquitous three dimensional 3 d finite difference groundwater flow model modflow developed by the u s geological survey harbaugh 2005 typically one uses modflow to generate steady state or transient flow fields and then uses mt3dms to simulate the transport of the solute within a flow field to specifically tackle matrix diffusive systems without having to maintain a high resolution of spatial and temporal discretization zheng and bennett 2002 included an option to simulate solute transport using a dual porosity model the dual porosity model is conveniently built in to the popular modflow mt3dms numerical codes is mathematically intuitive and is numerically efficient the dual porosity model was proposed as an alternative modeling approach to capture the tailing and asymmetry of effluent concentration profiles which the classical ade could not simulate deans 1963 smith and coats 1964 conceptually the model separates the subsurface into two domains in one domain transport is advectively mobile while in the other it is assumed to be stagnant or immobile the interaction between the two domain is dominated by molecular diffusion which is treated as a mass transfer process and moderated by a first order mass transfer coefficient zheng and bennett 2002 the mass transfer coefficient circumvents the need to spatially discretize the grid to capture matrix diffusion which allows the numerical dual porosity model to run more efficiently than others the first order mass transfer coefficient is the crux of the dual porosity model and perhaps its primary weakness the coefficient is a challenging parameter to quantify haggerty and gorelick 1995 perina 2022 de vries et al 2017 provided a comprehensive list of such attempts which focused on deriving either an analytical expression of the coefficient based on physical parameters or an approximate expression based on integral transformation using infinite series rao et al 1980 and moment analyses parker and valocchi 1986 goltz and roberts 1987 swami et al 2018 also listed several empirical formulas to estimate the mass transfer coefficient using physical properties of the porous media a notable effort was taken by van genuchten 1985 to define the mass transfer coefficient for platy columnar and prismatic aggregate systems van genuchten 1985 utilized geometry dependent shape factors and known analytical solutions of transport between aggregates of simple shapes such as spherical cylindrical and rectangular aggregates to derive first order mass transfer coefficients of more generic aggregate systems the result is a first order rate expression for generic aggregates that has equivalent diffusion characteristics to the expression for the simpler shapes an expression of the first order mass transfer coefficient based on van genuchten 1985 s efforts was shown to produce accurate results in one system of parallel fractures by neville 2006 where the fracture spacing was small and only the loading period was considered we are not aware of previous works in the literature where the time dependency of the dual porosity s mass transfer coefficient is tested over both loading and unloading periods of diffusion and over a range of fracture spacing generally with the exception of simple geometries as van genuchten 1985 evaluated the mass transfer coefficient does not have a direct physical interpretation and has been treated as a calibrating parameter neville et al 2000 one of the most influential studies of the mass transfer coefficient is the series of macrodispersion experiments made at the columbus air force base in mississippi where the dual porosity model was used to simulate the observed field data the site is highly heterogeneous with significant variance in hydraulic conductivity and with preferential flow paths present among low permeability silt and clay lenses adams and gelhar 1992 boggs et al 1992 boggs and adams 1992 feehley et al 2000 applied the dual porosity model to qualitatively replicate the 3 d tritium tracer plumes at the made site when they applied a high mass transfer coefficient to simulate the plume mass they were able to match the observed relative mass closer to the source but were unable to match the observed data further downstream the opposite happened when they applied a low mass transfer coefficient because the low mass transfer coefficient caused the dual porosity model to underestimate the relative mass closer to the source guan et al 2008 explored this behavior further and concluded that the mass transfer coefficient is time dependent and it changes with the evolving tracer plume swami et al 2018 completed 30 sets of tank experiment readings of solute movement through layered porous media they observed that using a single mass transfer coefficient would produce breakthrough curves matching observed data at some cross sections downstream but not all when they averaged the mass transfer coefficients at different locations using an asymptotic distance dependent relationship the fit of the dual porosity model to the observed data improved in another recent effort perina 2022 developed a 3 d analytical solution to the dual porosity model with first order reactions and sorption similar to previous analytical approaches assumptions to the model domain simplify the mass transport equations and make them solveable via laplace transforms and inverse fourier transforms perina 2022 observed that the analytical solution is sensitive to volume of mobile materials present especially when the mass transfer coefficient is low the time dependence of the mass transfer coefficient in the dual porosity model can likely be overcome by using multiple mass transfer coefficients and or multiple volume weighted porosities for the low permeability zones haggerty and gorelick 1995 given the difficulty in defining a single mass transfer coefficient and the lack of the multi rate model implementation in popular numerical codes these approaches have not gained wide use developments in applied mathematics recently have offered researchers an alternative to the classical ade by using fractional derivatives and fractal dimensions allwright and atangana 2018 allwright et al 2021 a fractional derivative is an operator that does not follow the usual integer order integer order derivatives can only capture the change of a function over one quantity whereas a fractional derivative can represent the change of multiple quantities in a fractal space allwright and atangana 2018 direct applications of fractal calculus to the dual porosity model have been limited to flow models xu et al 2016 2017 herrera hernández et al 2018 and not mass transport except for a specific case of cylindrical two zone medium khuzhayorov et al 2020 allwright et al 2021 circumvented the dual porosity concept completely and adapted fractal derivatives directly to the 1 d classical ade in place of the mass transfer coefficient allwright utilized a fractal dimension parameter and a fractal order to moderate various degree of diffusion the newly developed fractal ade can only be solved numerically allwright and atangana 2019 while this novel fractal advection dispersion model is promising it can only simulate 1 d mass transport at the moment which limits its application in full scale field tests in sensitivity analyses of the model allwright et al 2021 observed that the model is highly sensitive to the fractal parameters showing a few tenths variation in the fractal dimension can lead to exponential change in advection and dispersion of the solute adding to the challenge of calibrating the fractal model is the disconnect between the two fractal parameters and the usual hydrogeological field data that are typically utilized to characterize the subsurface 1 3 semi analytical model the reason the dual porosity model is such a compelling approach to overcome the shortcoming of the classical ade is because it is not constrained to the assumptions of analytical solutions and the underlying concept of separating the local diffusive flux from the rest of the mass fluxes is intuitive the model is also easily accessible via the numerical code mt3dms which is often packaged with modflow in a single convenient user interface aquaveo 2019 however its mass transfer coefficient is challenging to estimate and scale dependent in space and time there is a need for an alternative that can capture matrix diffusive effects as efficiently as the dual porosity model while not relying on the first order time dependent mass transfer coefficient the alternative we evaluate here is a semi analytical model that was originally developed by petroleum engineers to compute conductive heat flux from a permeable reservoir to an impermeable caprock vinsome and westerveld 1980 the model combines analytical and numerical modeling by only numerically discretizing the high permeability zones in the aquifer while solving for the conduction heat flux semi analytically using a temperature dependent source sink term computed in each gridblock and at every time step vinsome and westerveld 1980 pruess and wu 1988 1993 observing that heat conduction is analogous to contaminant diffusion bear et al 1994 and falta and wang 2017 adapted the method to simulate transient matrix diffusion of contaminants in semi infinite low permeability layers muskus and falta 2018 expanded the method s capability to simulate finite embedded heterogeneities the current implementation of the model has been successfully tested in both heterogeneous and fractured aquifer systems and in cases where multiple solutes undergo first order parent daughter decay reactions we compare the dual porosity model to the semi analytical method by muskus and falta 2018 in a series of parallel fracture simulations under loading and unloading conditions we focus on systems of parallel fractures as a starting point to establish the utility of the semi analytical method and to utilize a well known analytical solution for this geometry more complex tests can be explored in future works such as simulations in 3 d parallel fractures and 3 d discrete fracture networks this work will be organized as follows in section 2 we discuss the mathematical structure of the dual porosity model including its characteristic diffusion time and introduce the semi analytical method in section 3 we describe the methodology and results of the comparison between the dual porosity model the semi analytical method and an analytical solution in cases where the fracture spacing is varied and in section 4 we show the results of the cases where the decay rates and adsorption are varied 2 matrix diffusion models 2 1 dual porosity model 2 1 1 coupled transport equations and mass transfer coefficient via shape factor the dual porosity model is implemented as an optional feature in popular transport models such as mt3dms to simulate transport in fractured media or highly heterogeneous porous media zheng and wang 1999 in our simulations we assumed a homogeneous and constant groundwater velocity field flowing in x direction with contaminant decay only in the aqueous phase given those assumptions the coupled dual porosity model equations can be written as zheng and wang 1999 zheng and bennett 2002 1 v f ϕ f r c t 1 v f ϕ l r l c l t v f ϕ f d x 2 c x 2 d y 2 c y 2 d z 2 c z 2 x v x c λ ϕ f v f c λ l ϕ l 1 v f c l 2 1 v f ϕ l r l c l t β c c l 1 v f λ l ϕ l c l the subscript l in eqs 1 and 2 symbolizes parameters of the low permeability domain parameters without any subscript or with the subscript f are those of a fracture or a high permeability material eq 1 relates the mass balance in both the high permeability and low permeability domains to the net mass inflows from advective dispersive and first order decay processes eq 2 describes the rate of the diffusive mass transfer between the two domains in eq 1 the volume fraction v f is the ratio of the volume of highly permeable materials to the total volume this parameter specifies the degree of heterogeneity and is the same parameter that was introduced by muskus and falta 2018 the mobile porosity is defined as the product of the volume fraction and the porosity in the high permeability regions 3 ϕ m v v o i d f v v f ϕ f the equation parameter v v o i d f represents the volume of the void space in the high permeability materials whereas v is the total volume of both the low permeability and high permeability materials unlike the mobile porosity ϕ m which is defined over the total volume the high permeability porosity ϕ f is a material property that describes the actual porosity of the high permeability materials similarly the immobile porosity is the product of the volume fraction of the low permeability materials and the porosity in those regions 4 ϕ i m v v o i d l v 1 v f ϕ l the equation parameter v v o i d l is defined as the volume of the void space in the low permeability materials while the parameter ϕ l describes the actual porosity in the low permeability materials the sum of the mobile and immobile porosity is the total porosity ϕ m ϕ i m v f ϕ f 1 v f ϕ l ϕ which is also the ratio of the total void space in both domains over the total volume those porosity definitions are consistent with how zheng and wang 1999 had defined them previously the retardation factors in the low permeability and high permeability materials are r l and r retardation factors are utilized to account for the effects of sorption in the mass balance the aqueous mass concentrations in the low permeability and high permeability materials are c l and c the 3 d dispersion coefficients are d x d y and d z those coefficients control the horizontal vertical and transverse spread of the contaminant in porous media the x direction darcy velocity is v x which is a volumetric flux of water the first order decay rates in the low and high permeability materials are λ l and λ the decay rates control how fast a contaminant can degrade in the model in eq 2 the mass transfer between the two domains is moderated by the mass transfer coefficient β which is typically utilized as a calibrating parameter by practitioners neville et al 2000 an approach by van genuchten 1985 to estimate transport in plane sheet aggregates using a first order rate model was used to develop a mathematical expression for β van genuchten 1985 recognized that first order rate models such as the dual porosity model can be used to approximate transport in a system of plane sheet aggregates which is analogous to a system of parallel fractures he further observed that the mass transfer coefficient in the dual porosity model is a function of a shape factor which was defined as the ratio of the dimensionless time of the parallel fractured system over the dimensionless time of the dual porosity model the dual porosity dimensionless time was found by integrating eq 2 for an initial condition of zero concentration in the matrix and a boundary condition of fracture concentration at unity the dimensionless time of the parallel fractured system is known from an analytical solution of heat conduction in a solid bounded by parallel planes carslaw and jaeger 1959 van genuchten 1985 observed that when the two dimensionless times are plotted to varying concentration in the matrix one could glean from the plot a shape factor that would give a dual porosity matrix concentration equivalent to the analytical matrix concentration the resulting expression is 5 β 3 τ l d ϕ l 1 v f a 2 2 where τ l is the tortuosity factor of the low permeability material in porous media the chemical particles undergoing diffusion do not typically follow a linear path to account for more realistic channels through which the chemical diffuses the tortuosity factor is used the parameter d is the molecular diffusion coefficient and a is the fracture spacing the formula in eq 5 is tested extensively in this work and referred to as the shape factor formula of the first order mass transfer coefficient 2 1 2 characteristic diffusion time of the dual porosity model from the literature feehley et al 2000 swami et al 2018 and from our analysis of the dual porosity model it is observed that the dual porosity method would work in some cases such as one system of parallel fractures shown by neville 2006 but would not work as well in others such as the made site guan et al 2008 bear and cheng 2010 suggested that the dual porosity method is only valid when the concentration difference between the fracture and the matrix has reached a quasi steady state they gave a mathematical expression of when that steady state occurs but their formula did not utilize an effective diffusion coefficient we built on their work by seeking an improved mathematical expression of the characteristic diffusion time for the dual porosity model fig 1 shows a flow chart of how the characteristic diffusion time is derived this is a two pronged approach which begins with the governing equation of a solute diffusing into a low permeability matrix and the dual porosity equation in the low permeability domain boundary conditions are applied to the governing equation so the finite and semi infinite matrix mass fluxes can be analytically solved boundary conditions are applied to the dual porosity equation in the low permeability domain to derive the dual porosity mass flux the relationship between the semi infinite analytical mass flux and the dual porosity mass flux results in the characteristic diffusion time finally we validate the characteristic diffusion time expression by comparing the analytical mass flux in a finite matrix to the dual porosity mass flux fig 2 depicts diffusion of a chemical from a series of parallel fractures into finite matrix regions in between consider a system of parallel fractures where the fracture aperture is b and a is the fracture spacing fig 2 the fractures are orientated for vertical flow through the fracture apertures but they could be horizontal instead during an idealized loading period the aqueous concentration in the fracture is held at a constant concentration c 0 the transient concentration of a chemical diffusing into finite or semi infinite matrix can be described by the governing equation 6 r l c l t τ l d 2 c l x 2 when the matrix is semi infinite crank 1975 gave a solution to eq 6 satisfying the initial condition of c l 0 for x 0 when t 0 and the boundary conditions of c l c 0 at the matrix fracture interface x 0 and c l 0 at x 7 c l sf c 0 erfc x 2 κ t where κ τ l d r l and c l sf is the analytical concentration of a chemical diffusing into a semi infinite matrix the equation parameter κ is essentially an effective diffusion coefficient adjusted for sorption the semi infinite mass flux f l sf entering the matrix was found by taking a derivative of eq 7 with respect to x evaluating it at the matrix interface x 0 and applying fick s first law 8 f l sf ϕ l τ l d c 0 π κ t when the matrix is finite in a system as shown in fig 2 the diffusion of a chemical into the matrix is analogous to the conduction of heat over a finite region powers 1979 provided a solution satisfying the boundary conditions of c l c 0 at both interfaces of the matrix at x 0 and x a and an initial condition of c l 0 when t 0 9 c l c 0 2 π n 1 c 0 c 0 1 n n s i n n π a x e n π a 2 κ t the analytical diffusion mass flux was found by taking the derivative of eq 9 with respect to x and evaluating it at the matrix interface x 0 and applying fick s first law 10 f l 2 ϕ l τ l d a n 1 c 0 c 0 1 n e n π a 2 κ t the semi infinite mass flux in eq 8 was utilized to approximate the characteristic diffusion time of the dual porosity model in a finite matrix system to find the dual porosity mass flux we applied the boundary condition of c c 0 in the fracture to the dual porosity mass transfer equation eq 2 which then becomes 11 c l t β c 0 1 v f ϕ l r l β 1 v f ϕ l r l c l λ l r l c l eq 11 is a linear ordinary differential equation that can be solved by applying an initial condition of c l 0 when t 0 and using the integration factor method which gives the solution 12 c l d p β c 0 β λ l ϕ l 1 v f 1 e β λ l ϕ l 1 v f 1 v f ϕ l r l t the dual porosity mass discharge was found by multiplying the derivative of eq 12 with respect to time with the matrix volume matrix porosity and the matrix retardation factor 13 m l d m l d t r l ϕ l 1 v f v d c l d t β c 0 v e β λ l ϕ l 1 v f 1 v f ϕ l r l t where v a δ z δ y is the total volume the dimension a is used in the x direction for repeated parallel fractures as shown in fig 2 the dual porosity mass flux for a finite matrix system was finally obtained by dividing the dual porosity mass discharge in eq 13 over the cross sectional areas of the fracture on both sides of the matrix a 2 δ z δ y the dual porosity mass flux with the mass transfer coefficient expressed via the shape factor formula eq 5 and with the assumption of no decay is 14 f l d p 6 ϕ l 1 v f τ l d c 0 a e 12 κ a 2 t setting eq 8 equal to eq 14 squaring both sides and isolating the time variable yields an expression that can be solved for the time when the two solutions match 15 t e 24 κ t a 2 a 2 36 π κ note that the fracture aperture is typically several orders of magnitude smaller than the fracture spacing so the volume fraction was omitted from eq 15 eq 15 is in the canonical form of the lambert w function corless et al 1996 y e y x for a real number x 0 there are two roots to eq 15 y 1 w 0 x and y 2 w 1 x the smaller root along the principal branch w 0 x of the lambert w function is the characteristic diffusion time at which the dual porosity model using the shape factor formula of the mass transfer coefficient matches the analytical solution 16 t c w 0 2 3 π a 2 24 κ a 2 85 4 κ spatially the location of the solute in the matrix relative to the maximum diffusion distance i e half the fracture spacing at the characteristic diffusion time is a dimensionless quantity 2 κ t c a 0 22 so regardless of the fracture spacing the parallel fractures system passes the dual porosity s characteristic diffusion time when the chemical s front has penetrated 22 of the maximum matrix distance eq 16 is shown for a range of fracture spacing from 0 1 m to 10 m in fig 3 using τ l 0 1 r l 1 and d 0 0316 m 2 yr representative of trichloroethylene tce at small fracture spacing the characteristic diffusion time is small allowing the accurate use of the dual porosity model however the diffusion time increases as the square of the fracture spacing so using the dual porosity method at larger fracture spacing can lead to inaccurate results we validated the effectiveness of the characteristic diffusion time expression eq 16 by comparing the dual porosity mass flux over a finite matrix region eq 14 to the analytical solution eq 10 in fig 4 we show the characteristic time of the dual porosity method the analytical solution matrix mass flux and the dual porosity mass flux for three cases of fracture spacing at 0 1 m 2 m and 10 m with κ 0 00316 m 2 yr in fig 4 the black dashed line shows the analytical solution mass flux the red line shows the dual porosity mass flux as computed using the shape factor formula of the mass transfer coefficient eq 5 and assuming the matrix tortuosity τ l of 0 1 porosity ϕ l of 0 1 diffusion coefficient d of 0 0316 m 2 yr and negligible volume fraction v f the dual porosity method is effective at matching the analytical solution at the smallest fracture spacing case because the characteristic diffusion time is two orders of magnitude smaller than the total simulation time as the fracture spacing was increased the dual porosity mass flux was only satisfactory at times beyond the characteristic diffusion time at a certain fracture spacing the dual porosity method can be inaccurate in matching the analytical mass flux for hundreds or more years depending on κ in the fracture spacing case of 10 m the time threshold for using the dual porosity method is after 371 years for a κ value of 0 00316 m 2 yr 2 2 semi analytical model the semi analytical model is an adaptation of the vinsome and westerveld method in petroleum engineering to compute heat flux from a permeable reservoir to an impermeable rock vinsome and westerveld 1980 falta and wang 2017 muskus and falta 2018 muskus and falta 2018 developed a 3 d finite difference model in fortran that includes the semi analytical method assuming a uniform flow field called remchlor md farhat et al 2018 built a graphical user interface for the fortran code which can be downloaded free of charge the semi analytical method can simulate matrix diffusion into semi infinite aquitards and into embedded low permeability zones the method was tested in both heterogeneous porous media and parallel fractures with first order parent daughter decay reactions muskus and falta 2018 for a gridblock of volume v the method uses three modeling parameters the volume fraction v f the diffusion area a m d and the characteristic diffusion length l m d from a volume balance of the low permeability material these parameters can be related reducing the number of unknown parameters to two 17 1 v f v a m d l m d in a system of parallel fractures no calibration is required for the semi analytical diffusion parameters because they can be computed directly using the known fracture spacing a and the aperture b the diffusion length and the volume fraction can be computed as 18 l m d a b 2 19 v f b a when the diffusion length and the volume fraction are known the diffusion area a m d can be computed directly using eq 17 in a heterogeneous porous media system if the volume fraction of the high permeability materials can be reliably estimated only either the diffusion area or the characteristic diffusion length is needed to simulate matrix diffusion 3 varying fracture spacing simulations muskus and falta 2018 compared the semi analytical method against an exact analytical solution for a porous media system of 1 d parallel fractures developed by sudicky and frind 1982 they solved a set of coupled equations one for the advective diffusive and dispersive transport in fractures and another equation for only diffusive transport in the matrix adsorption and decay are also considered in both equations sudicky and frind 1982 assumed that the fracture aperture is significantly smaller than the length and that complete mixing exists in the fractures the coupled equations are solved by using laplace transform and crump numerical inversion sudicky and frind 1982 coded the solution in a fortran program called craflush which we used extensively in the present work craflush has an accompanying program called crafit which automates the calibration of breakthrough curves from column experiments toran 2000 in a previous test where matrix diffusion almost completely dominated transport the semi analytical model compared favorably with the results from craflush muskus and falta 2018 in the current work we have expanded the study of matrix diffusion in parallel fractures by testing a series of scenarios where the fracture spacing adsorption and solute decay rates were varied in those test scenarios the concentration simulated by the semi analytical and dual porosity models were compared to that of the analytical solution sudicky and frind 1982 3 1 simulations methodology a 1 d numerical grid with 200 gridblocks of 1 m long in the x direction was created this grid uses an equivalent porous media approximation to represent parallel fractures long et al 1982 anderson and woessner 1992 a range of fracture spacing from 0 1 m to 10 m was tested but the fracture aperture was fixed at b 100 μ m the hydraulic conductivity in the fractures was computed to be 2 30 e 5 m yr using a well known formula k f ρ g b 2 12 μ anderson and woessner 1992 where the water density ρ is 1 00 e 3 kg m 3 the constant of gravitational acceleration g is 9 808 m 2 s and the dynamic viscosity μ is 3 55 e 11 n yr m 2 munson et al 2009 the pore velocity in the fracture was held at 100 m yr the hydraulic gradient for the system was set at 0 0435 which is the ratio of the velocity to the hydraulic conductivity in the fracture for a fracture porosity ϕ f 1 the material porosity was set at ϕ l 0 1 for the matrix the mobile and immobile porosities were computed using eq 3 and eq 4 figs 5 and 6 show the trends of the volume fraction equivalent porous media darcy flux and equivalent hydraulic conductivity values as the fracture spacing increases as the fracture spacing increases there is more low permeability material in the system so the volume fraction decreases the equivalent porous media darcy flux is the largest when the fractures are close together and vice versa the largest equivalent porous media darcy flux was 0 1 m yr the equivalent hydraulic conductivity tested ranges from 230 1 m yr for a fracture spacing of 0 1 m to 2 301 m yr for a fracture spacing of 10 m for each fracture spacing case the pore velocity is a direct input in the analytical model sudicky and frind 1982 whereas the semi analytical model requires an equivalent porous media darcy flux as an input for the dual porosity model as implemented in mt3dms zheng and wang 1999 the darcy flux is not a direct input so an equivalent flow field is generated first using modflow harbaugh 2005 a total of nine flow fields were simulated one for each fracture spacing case each flow field was then used to simulate an equivalent darcy velocity in the dual porosity transport model a flow field can be simulated in modflow by setting head boundary conditions at the upstream and downstream of each flow model using an equivalent hydraulic conductivity and the same gradient of 0 0435 after a flow model ran successfully in modflow a tce source concentration of 100 mg l was introduced at the upstream end of the fractured system advective loading of the source was enforced by setting the dispersivities in the source cells to a small value the source was maintained for 50 years at 0 05 years timestep in each fracture spacing model and following complete source removal clean water was flushed through the system for another 50 years a longitudinal plume dispersivity of 0 5 m or half of the gridblock spacing in the x direction was used in the analytical solution in the semi analytical and dual porosity models advection terms were solved for by the standard finite difference scheme with upstream weighting which has an inherent numerical dispersivity value of 0 5 m same as the value used in the analytical model sudicky and frind 1982 initially neither decay nor adsorption was considered as fracture spacing was varied then simulations were run where the fracture spacing was varied as the solute half life decreases from a no decay condition to 10 years 5 years and 1 year finally simulations were run where the fracture spacing was varied as the retardation factor was increased from 1 no retardation to 2 and 5 modflow and mt3dms models were set up using the graphical user interface groundwater modeling system gms developed by aquaveo 2019 table 1 summarizes the modeling parameters used for the fractured media experiments fracture concentration profiles over distance from the source were plotted at four time periods which were selected to study the system behavior before and after source removal and at high and low concentration gradients to quantitatively evaluate the models the root mean square errors rmses of the semi analytical and dual porosity concentrations in comparison to the analytical solutions were computed at each time period rmse j i 1 n a i s i 2 n where rmse j is the root mean square error for time period j singh et al 2007 a i is the analytical solution s concentration at a distance x i s i is the simulated concentration of either the semi analytical or the dual porosity model and n is the total number of simulated values along the x direction rmses at log scale were computed similarly rmse j log i 1 n l o g a i l o g s i 2 n the normalized root mean squared errors nrmses were calculated by normalizing the rmses by the range of concentrations from the source concentration highest value to the typical method detection limit of dissolved tce 0 001 mg l smallest value nrmse j rmse j c 0 c mdl nrmse j log rmse j log 5 average nrmses of concentration profiles over the four time periods at linear and log scale were computed and are referred to as the marginal nrmses marginal nrmse j 1 4 nrmse j 4 marginal nrmse log j 1 4 nrmse log j 4 the average of those values i e the average marginal nrmses were calculated for each fracture spacing case and for both the semi analytical and the dual porosity concentrations average marginal nrmse marginal nrmse marginal nrmse log 2 the average marginal nrmse was used as a single metric to compare the effectiveness of the semi analytical and the dual porosity models in various fractured systems and under different conditions of plume decay and retardation 3 2 results of fractured media simulations 3 2 1 semi analytical method compared with analytical solution because of the simplified geometry of the parallel fractured system all diffusion modeling parameters of the semi analytical method were computed directly using eq 17 through 19 for the dual porosity model the first order mass transfer coefficient was estimated using the shape factor formula eq 5 because the accuracy of the dual porosity model depends on the characteristic diffusion time the dual porosity model was manually calibrated by adjusting the mass transfer coefficient until the lowest average marginal nrmses for all time periods was found fig 7 shows the concentration profiles from the analytical and semi analytical solutions in four tested fracture spacing cases and it highlights how the fracture spacing influences the shape of the concentration profiles in the fractures the figure includes concentration profiles in blue and yellow from the early time and late time of the loading period respectively the green and purple profiles are from the early time and late time of the unloading period the 1 year profiles blue lines of the loading period for the four fracture spacing cases are similar to one another the semi analytical method was able to match the exponential shape of the analytical loading curve at 1 year both the analytical and the semi analytical concentration profiles in blue were below the detection limit at 10 m from the source in the four fracture spacing cases at 49 years the solute has only advanced a few tens of meters in spite of the 100 m yr pore velocity when the fractures were very close together in the case of 0 1 m spacing the 49 year profile was similar to the shape of a system with a clear but retarded advective front in this small fracture spacing case the solute at source concentration was in the fractures for nearly 40 m before the concentration dropped fig 7d the advective front developed at 50 m from the source as the plume was moving at the apparent transport velocity of 1 m yr which is 100 times slower than the pore velocity in the fractures in the 51 year profiles green lines the clean water front is strongly retarded by matrix diffusion the 100 year concentration profiles purple lines showed the effects of matrix diffusion following source removal and their peak concentrations vary inversely with the fracture spacing at the smallest fracture spacing the concentration profile resembles advective dispersive transport with a high retardation factor the analysis of the concentration profiles indicated a good match between the analytical solution and the semi analytical method over a range of fracture spacing peak concentrations simulated by the semi analytical method were a bit less accurate at large fracture spacing cases during the unloading period but as the spacing was decreased the match became much closer 3 2 2 semi analytical method compared with dual porosity model before comparing the semi analytical and the dual porosity results under matrix diffusion it was verified that the mt3dms dual porosity and the remchlor md semi analytical models produced the same results in the absence of matrix diffusion the objective was to isolate the simulation of the matrix diffusion process from the simulation of other transport processes when comparing the two models in fig 8 the case of 0 1 m fracture spacing is simulated using the semi analytical and the dual porosity models without matrix diffusion to remove matrix diffusion effects the semi analytical method s matrix diffusion area a m d and the dual porosity mass transfer coefficient β were set to zero after one year the advective front was at 100 m from the source and it moved downgradient at the pore velocity of 100 m yr following source removal the 51 year profile mirrored the 1 year profile over the y axis as the system switched from being loaded with a source to being flushed with clean water in the absence of matrix diffusion the clean water front also moves at the pore velocity of 100 m yr the semi analytical and dual porosity profiles are identical indicating that the two models only differ in the way they simulate diffusive transport in the matrix although only the fracture spacing case of 0 1 m is shown here the same analysis was repeated for all fracture spacing cases with the same result after verifying that the mt3dms dual porosity and the remchlor md semi analytical models produced identical concentration profiles in the absence of matrix diffusion diffusion was considered in both models for the semi analytical model the matrix diffusion area was changed from zero to a computed value eq 17 for the dual porosity model the mass transfer coefficient was computed first using the shape factor formula eq 5 then additional mass transfer coefficients were tested by trial and error to gauge the effects the coefficients had on the concentration profile and to calibrate a better fit to the analytical solution fig 9 shows concentration profiles at four time periods for the largest fracture spacing of 10 m the analytical solution is shown as the dashed black line whereas the semi analytical simulation is shown as the blue dash dotted line the dual porosity simulations are shown as solid color lines the mass transfer coefficient with three significant figures is the coefficient computed by the shape factor formula eq 5 while the rest are iterations of the coefficient from calibrations the mass transfer coefficient value that produced the lowest average marginal nrmse value over the four time periods is plotted as asterisks a high mass transfer coefficient simulates a high rate of mass transfer into the matrix so during the loading period that results in lower concentration profiles in the fractures for example the orange solid line associated with the highest mass transfer coefficient of 0 2 yr was barely visible after one year of source loading fig 9 a after 49 years that profile was more visible but it was still the lowest concentration profile fig 9 b as the mass transfer coefficient was decreased the concentration profile became more prominent during the loading period because less mass was transferred to the matrix leaving more mass in the fractures the unloading profiles are directly related to the mass loading behavior if a high mass transfer coefficient was used during the loading period more mass was stored in the matrix and in the unloading period more mass diffused out from the matrix the mass transfer coefficient computed via the shape factor formula was unable to produce concentration profiles that match the analytical solution because the characteristic diffusion time of 371 years has not passed in all four time periods under consideration see fig 3 four orders of magnitude from the initial mass transfer coefficients were tested in a calibration process to improve the fit of the dual porosity concentration profiles even after calibration the dual porosity model was still unable to match the analytical solution because a calibrated mass transfer coefficient that quantitatively placed the dual porosity concentrations close to the analytical solution during the loading period could not match the analytical solution during the unloading period as observed by guan et al 2008 because the mass transfer coefficient is a time dependent parameter it may not be possible to have one parameter that works for all time periods being only applicable to systems at a certain time makes the dual porosity model less useful for simulations such as the one being considered here where the concentration profiles are evaluated over 100 years with a reversal of the matrix diffusion gradients for fracture spacing case of 2 m fig 10 the characteristic diffusion time is only 15 years so the dual porosity model is expected to match the analytical solution better at later times during loading and unloading periods the yellow lines are the concentration profiles produced by the mass transfer coefficient computed using the shape factor eq 5 it matched relatively well with the analytical solution at time periods 49 years and 100 years which are both greater than the characteristic diffusion time of 15 years it did not match the analytical solution at 1 year and 51 years because the characteristic diffusion time which is reset after the source is removed had not been reached the semi analytical method matched analytical solution well at all time periods the profile of the calibrated mass transfer coefficient value was plotted as the cyan asterisk line calibrations were implemented by trial and error to seek the mass transfer coefficient that gave the lowest average marginal nrmse the calibrated coefficient improved the fit at later times but at early times prior to the characteristic diffusion time the dual porosity model was unable to match the analytical solution using a single mass transfer coefficient for all time periods in fracture spacing case of 0 1 m fig 11 the characteristic diffusion time is short at 0 04 years which is less than all four time periods of analysis in this case the dual porosity model is expected to match the analytical solution well at all times the best fit mass transfer coefficient for this case was 0 5 yr which is not far off from the value of 0 378 yr predicted by the shape factor formula though not shown here we plotted the concentration profiles of both models at log scale and observed similar results we repeated the concentration profile comparison for other fracture spacing cases in the range between 0 1 m and 10 m fig 12 summarizes the change of the average marginal nrmses for both the semi analytical and the dual porosity models over the range of fracture spacing the nrmse values for the semi analytical method were consistent at 3 5 or less in contrast the mass transfer coefficient computed by the shape factor formula only worked without calibration at fracture spacing less than approximately 1 m at the largest fracture spacing the uncalibrated dual porosity model produced an error tenfold that of the semi analytical method the effectiveness of the mass transfer coefficient based on the shape factor is limited by the characteristic diffusion time which can only be satisfied at smaller fracture spacing even with calibration the dual porosity model s error could still be five times higher than that of the semi analytical model in the largest fracture spacing case calibration cannot remove the dependency of the mass transfer coefficient on the characteristic diffusion time while a calibrated mass transfer coefficient perhaps can produce a concentration profile that would work at some time periods it did not produce a profile that would work at all times unless the fracture spacing is small 4 simulations with decay and adsorption 4 1 varying decay rate the effects of decay in the same fracture systems were evaluated using a similar approach in fig 13 concentration profiles simulated by the semi analytical method in comparison with the analytical solution in cases from low 10 year half life to fast decay rates 1 year half life are shown the decay rates in the fractures were assumed to be the same as in the matrix the analytical profiles show the changes of the plume concentration under an increasing decay rate near the source the analytical concentration decreased from over 70 mg l to approximately 55 mg l as the decay rate was increased from a half life of 10 years to 1 year following the removal of the source the peak concentration of the 53 year profiles lowered from over 20 mg l under a slow decay rate to 2 mg l under the fastest decay rate the increasing decay rate also reduced the spatial extent of the contaminant exceeding the detection limit from nearly 40 m from the source to only about 15 m the semi analytical method matched the overall shape of the analytical solution well especially in the unloading period the comparison shows that the semi analytical method can be useful when comparing between passive and active remediation strategies to minimize the impact of matrix diffusion in this context the passive approach is to allow a contaminant to naturally attenuate under a slow decay rate while the active approach is to stimulate a higher rate of degradation three additional fracture spacing cases of 0 1 m 5 m and 10 m were simulated with the three decay rates of 10 year 5 year and 1 year half life not shown the semi analytical and the dual porosity profiles were compared with the analytical solutions similar to the no decay cases the semi analytical model was able to match the analytical solution over a range of fracture spacing and decay rates meanwhile the dual porosity model was unable to match the analytical solution at large fracture spacing in smaller fracture spacing cases when the characteristic diffusion time was small the dual porosity model performed better the average marginal nrmses across the four time periods on linear and log scale were computed for each decay rate it was noted that in the case of 1 year half life decay the concentrations were below the detection limit very quickly reducing the analytical solution s sample size from 200 observations to as low as four observations in one time period such a small sample size can skew the average nrmse results high so the nrmses for the 1 year half life decay are not compared fig 14 shows the nrmse results for the 10 year half life and the 5 year half life decay rates the impact of decay on the dual porosity model s accuracy was negligible when the fracture spacing is sufficiently small doubling the decay rate yielded similar nrmse ranges between 0 1 m and 10 m of fracture spacing calibrating the mass transfer coefficient reduced the dual porosity model s nrmses but for the largest fracture spacing even its calibrated nrmse was three to four times than the semi analytical method s the accuracy of the dual porosity model depends on the fracture spacing similar to what we observed when varying fracture spacing without decay meanwhile the accuracy of the semi analytical method with and without decay was consistent with a nrmse less than 5 over a range of fracture spacing 4 2 varying adsorption following the simulations of varying decay rates simulations with only adsorption were evaluated retardation factor of 2 and 5 were tested in the same system of parallel fractures the retardation in the matrix and in the fractures was assumed to be the same fig 15 shows the changes in the concentration profile at fracture spacing of 1 m as the retardation was increased from 1 to 5 as the retardation was increased the matrix s mass storage capacity increased the change was especially apparent in the 100 year profiles purple lines when the peak of the fracture concentration profile decreased because more mass was stored in the matrix the shape of the 1 year and the 49 year profiles was similar to one another but the profiles of the retardation factor of 5 had a shorter spatial extent as the extra storage capacity reduced the dissolved concentration in the fracture the semi analytical method matched the analytical solution during the loading period better than during the unloading period during the unloading period it overestimated the concentration peak but was still able to match the timing of the peak and the overall shape of the analytical solution well the overestimation was less apparent at 1 year after source removal as the retardation rate was increased green lines when overlaying the dual porosity profiles onto the semi analytical and the analytical profiles not shown we observed the same trends as in the varying decay and varying fracture spacing analyses the dual porosity model again performed poorly at larger fracture spacing at the four time periods of analysis at a smaller fracture spacing the model matched better when the characteristic diffusion time was satisfied the average marginal nrmses of the semi analytical and the dual porosity method for each fracture spacing case at both retardation rates were computed and plotted in fig 16 nrmses of the concentration profiles predicted by the shape factor formula yellow lines increased as the fracture spacing and the retardation factor increased calibration reduced the dual porosity model s nrmse but even then it was still over four to five times higher than the semi analytical method s at the largest fracture spacing the nrmses of the semi analytical method were at or below 5 consistent with the cases with and without decay 5 conclusion simulations were performed in parallel fracture systems to compare the effectiveness of the dual porosity and the semi analytical models in simulating dissolved concentrations in the fractures the analytical solution by sudicky and frind 1982 was used as the benchmark in the comparisons the accuracy of the dual porosity model with calibrations was dependent on a characteristic diffusion time which was shown to increase with the square of the fracture spacing at small fracture spacing when the diffusion time was small the dual porosity model showed good accuracy while at larger spacing the model was less accurate in matching the analytical solution a mathematical expression of the mass transfer coefficient based on a shape factor van genuchten 1985 was used in initial dual porosity models prior to calibrations meanwhile the semi analytical method matched the analytical solution at less than 5 nrmse without any calibration required the semi analytical method is not meant to produce an exact match with the analytical solution because at best it is only an approximation of an inherently complex mass transfer process especially in fractured media with a large matrix volume although the match is not exact the semi analytical method produced errors lower and more stable than the alternative the results presented in this work showed that when comparing the semi analytical method and the dual porosity method in cases of varying fracture spacing decay rates and adsorption the semi analytical method is more accurate and robust over a range of fracture spacing unlike the dual porosity method the semi analytical method does not depend on a characteristic diffusion time and its modeling parameters in parallel fractures can be computed directly from the fracture geometry the semi analytical method is currently being studied in 3 d discrete fracture networks parameter unit definition a m d l 2 semi analytical matrix diffusion area a l parallel fractures spacing b l fracture aperture c m l 3 concentration in high permeability high k material c 0 m l 3 initial concentration c l m l 3 concentration in low permeability low k material c l dp m l 3 dual porosity concentration in low k material c l sf m l 3 analytical concentration in semi infinite low k material d l 2 t solute diffusion coefficient d x d y d z l longitudinal transverse and vertical dispersivities f l f l sf m t l 2 analytical mass flux in finite and semi infinite matrix f l dp m t l 2 dual porosity mass flux in finite matrix l m d l semi analytical diffusion length m l m t dual porosity mass discharge in finite matrix r r l retardation factors of high k and low k materials t c t dual porosity characteristic diffusion time v l 3 gridblock volume v f volume fraction v v o i d f v v o i d l volumes of void space in high k and low k materials v x l t darcy velocity in x direction β 1 t mass transfer coefficient κ l 2 t ratio of effective diffusion coefficient over retardation factor λ λ l 1 t degradation rates of high k and low k materials τ τ l tortuosity factors in high k and low k materials ϕ f ϕ l porosities of high k and low k materials ϕ m ϕ i m mobile porosity and immobile porosity credit authorship contribution statement kien t pham conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization ronald w falta conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the environmental security technology certification program estcp united states project er19 5028 and by the strategic environmental research and development program serdp project united states er 2529 
148,a semi analytical method and the dual porosity model are used to simulate matrix diffusion between parallel fractures the semi analytical modeling parameters can be computed directly using the fracture spacing aperture and matrix properties those parameters do not require calibration to match an analytical solution for matrix diffusion the dual porosity model is applied under the same conditions and its first order mass transfer coefficient is estimated using a shape factor formula an expression of the characteristic diffusion time of the dual porosity method is defined based on fracture spacing and matrix characteristics the dual porosity method can adequately simulate matrix diffusion with a single mass transfer coefficient when the simulation time of the parallel fractures system exceeds the characteristic diffusion time for large fracture spacing the characteristic diffusion time becomes large and the dual porosity method produces less satisfactory results the highest average marginal normalized root mean square error nrmse of the dual porosity model was 18 with calibrations under no decay and no retardation conditions considerations of decay and retardation increased the dual porosity s highest calibrated nrmse to 20 meanwhile the errors between the semi analytical method and the analytical solution were low at nrmses of 5 or less with or without decay and retardation over a range of fracture spacing keywords matrix diffusion dual porosity semi analytical method remchlor md mass transfer coefficient characteristic diffusion time 1 introduction groundwater is susceptible to a variety of contaminants including chlorinated solvents and per and polyfluoroakyl substances those contaminants often form extended dissolved plumes that persist for several decades following their release cherry and mackay 1989 parker et al 1994 1997 esposito and thomson 1999 o hara et al 2000 liu and ball 2002 falta 2005 parker et al 2008 sale et al 2013 a primary cause of plume persistence is a process known colloquially as matrix diffusion whereby a contaminant diffuses from low permeability zones to high permeability zones after a loading period chapman and parker 2005 parker et al 2008 in the loading period the contaminant is released and moves by advection through high permeability areas and diffuses into low permeability areas when clean water is flushed through the system in an unloading period the concentration gradient between the high and low permeability areas reverses creating a condition where the contaminant mass diffuses from the low permeability areas back into the high permeability areas the word matrix in the name of this particular diffusion process originally refers to the low permeability rock adjacent to a fracture which has a much larger permeability than the unfractured matrix recently researchers have emphasized that matrix diffusion can be used to generally describe the mass transfer process between a low permeability zone and a high permeability zone farhat et al 2020 for example in a sand aquifer the matrix can be in the form of clay or silt lenses matrix diffusion is particularly prevalent in highly heterogeneous saturated zones where the porosity of the low permeability areas can be significant allowing the contaminant mass to be loaded in large quantity ball et al 1997 esposito and thomson 1999 parker et al 1994 1997 2004 2008 rasa et al 2011 1 1 previous analytical approaches the baseline of groundwater flow and contaminant transport modeling began in the 1970s when researchers developed the classical advection dispersion equation ade under the assumption that contaminants existed mostly in the dissolved phase and that they could be flushed out of a homogeneous aquifer by pump and treat systems smith and coats 1964 bredehoeft and pinder 1973 konikow 2011 hadley and newell 2014 however when the classical ade is utilized to model contaminant transport in heterogeneous media only molecular diffusion in the high permeability zones is accounted for as part of a hydrodynamic dispersion term not matrix diffusion smith and coats 1964 van genuchten and wierenga 1976 zheng and bennett 2002 the lack of consideration for fine scale diffusion into the low permeability materials and the subsequent release from those zones in the ade explained the ineffectiveness of some pump and treat systems in remediating persistent plumes hadley and newell 2014 analytical solutions capable of simulating matrix diffusion are available but they are typically restricted to a few specific systems such as in the case of a single thin fracture tang et al 1981 and discrete multiple parallel fractures sudicky and frind 1982 in a layered sand silt system when the sand layer is sufficiently thin and the system is well mixed sudicky et al 1985 and starr et al 1985 developed analytical solutions for nonreactive and reactive tracers liu et al 2017 expanded on the analytical solution of tang et al 1981 by allowing for variable advective velocity and dispersion in multiple fracture channels they utilized a response function in their model to specifically capture the fine scale mass exchange between the fracture and the matrix in cases when the peclet number is large and diffusion is limiting however in exchange for improvements to the tang et al 1981 solution the liu et al 2017 solution only works for non sorbing solutes and at high flow rates sale et al 2008 and farhat et al 2012 developed a two dimensional 2 d analytical solution for systems consisting of two semi infinite high permeability and low permeability layers in a case when a finite source exponentially depletes from aquitards bounded by no flux boundaries yang et al 2019 presented a one dimensional 1 d analytical solution for both the loading and unloading periods their analytical solution matched well with the experimental data during the loading of the source and after the source completely depleted analytical solutions give exact concentration profiles efficiently but a new solution needs to be developed whenever the geometry or boundary condition changes 1 2 dual porosity model to simulate matrix diffusion an alternative to utilizing analytical solutions is to capture matrix diffusion using numerical models with spatial and temporal discretization numerous researchers in the literature succeeded at using this type of fine grid numerical model to capture heterogeneity and matrix diffusion at a small scale pruess 1985 chapman et al 2012 parker et al 2008 chapman et al 2012 sale et al 2013 farhat et al 2020 among the numerical codes available mt3dms is a popular choice capable of modeling the advective dispersive and diffusive transport of multiple species zheng and wang 1999 mt3dms has gained wide use because it is directly compatible with the ubiquitous three dimensional 3 d finite difference groundwater flow model modflow developed by the u s geological survey harbaugh 2005 typically one uses modflow to generate steady state or transient flow fields and then uses mt3dms to simulate the transport of the solute within a flow field to specifically tackle matrix diffusive systems without having to maintain a high resolution of spatial and temporal discretization zheng and bennett 2002 included an option to simulate solute transport using a dual porosity model the dual porosity model is conveniently built in to the popular modflow mt3dms numerical codes is mathematically intuitive and is numerically efficient the dual porosity model was proposed as an alternative modeling approach to capture the tailing and asymmetry of effluent concentration profiles which the classical ade could not simulate deans 1963 smith and coats 1964 conceptually the model separates the subsurface into two domains in one domain transport is advectively mobile while in the other it is assumed to be stagnant or immobile the interaction between the two domain is dominated by molecular diffusion which is treated as a mass transfer process and moderated by a first order mass transfer coefficient zheng and bennett 2002 the mass transfer coefficient circumvents the need to spatially discretize the grid to capture matrix diffusion which allows the numerical dual porosity model to run more efficiently than others the first order mass transfer coefficient is the crux of the dual porosity model and perhaps its primary weakness the coefficient is a challenging parameter to quantify haggerty and gorelick 1995 perina 2022 de vries et al 2017 provided a comprehensive list of such attempts which focused on deriving either an analytical expression of the coefficient based on physical parameters or an approximate expression based on integral transformation using infinite series rao et al 1980 and moment analyses parker and valocchi 1986 goltz and roberts 1987 swami et al 2018 also listed several empirical formulas to estimate the mass transfer coefficient using physical properties of the porous media a notable effort was taken by van genuchten 1985 to define the mass transfer coefficient for platy columnar and prismatic aggregate systems van genuchten 1985 utilized geometry dependent shape factors and known analytical solutions of transport between aggregates of simple shapes such as spherical cylindrical and rectangular aggregates to derive first order mass transfer coefficients of more generic aggregate systems the result is a first order rate expression for generic aggregates that has equivalent diffusion characteristics to the expression for the simpler shapes an expression of the first order mass transfer coefficient based on van genuchten 1985 s efforts was shown to produce accurate results in one system of parallel fractures by neville 2006 where the fracture spacing was small and only the loading period was considered we are not aware of previous works in the literature where the time dependency of the dual porosity s mass transfer coefficient is tested over both loading and unloading periods of diffusion and over a range of fracture spacing generally with the exception of simple geometries as van genuchten 1985 evaluated the mass transfer coefficient does not have a direct physical interpretation and has been treated as a calibrating parameter neville et al 2000 one of the most influential studies of the mass transfer coefficient is the series of macrodispersion experiments made at the columbus air force base in mississippi where the dual porosity model was used to simulate the observed field data the site is highly heterogeneous with significant variance in hydraulic conductivity and with preferential flow paths present among low permeability silt and clay lenses adams and gelhar 1992 boggs et al 1992 boggs and adams 1992 feehley et al 2000 applied the dual porosity model to qualitatively replicate the 3 d tritium tracer plumes at the made site when they applied a high mass transfer coefficient to simulate the plume mass they were able to match the observed relative mass closer to the source but were unable to match the observed data further downstream the opposite happened when they applied a low mass transfer coefficient because the low mass transfer coefficient caused the dual porosity model to underestimate the relative mass closer to the source guan et al 2008 explored this behavior further and concluded that the mass transfer coefficient is time dependent and it changes with the evolving tracer plume swami et al 2018 completed 30 sets of tank experiment readings of solute movement through layered porous media they observed that using a single mass transfer coefficient would produce breakthrough curves matching observed data at some cross sections downstream but not all when they averaged the mass transfer coefficients at different locations using an asymptotic distance dependent relationship the fit of the dual porosity model to the observed data improved in another recent effort perina 2022 developed a 3 d analytical solution to the dual porosity model with first order reactions and sorption similar to previous analytical approaches assumptions to the model domain simplify the mass transport equations and make them solveable via laplace transforms and inverse fourier transforms perina 2022 observed that the analytical solution is sensitive to volume of mobile materials present especially when the mass transfer coefficient is low the time dependence of the mass transfer coefficient in the dual porosity model can likely be overcome by using multiple mass transfer coefficients and or multiple volume weighted porosities for the low permeability zones haggerty and gorelick 1995 given the difficulty in defining a single mass transfer coefficient and the lack of the multi rate model implementation in popular numerical codes these approaches have not gained wide use developments in applied mathematics recently have offered researchers an alternative to the classical ade by using fractional derivatives and fractal dimensions allwright and atangana 2018 allwright et al 2021 a fractional derivative is an operator that does not follow the usual integer order integer order derivatives can only capture the change of a function over one quantity whereas a fractional derivative can represent the change of multiple quantities in a fractal space allwright and atangana 2018 direct applications of fractal calculus to the dual porosity model have been limited to flow models xu et al 2016 2017 herrera hernández et al 2018 and not mass transport except for a specific case of cylindrical two zone medium khuzhayorov et al 2020 allwright et al 2021 circumvented the dual porosity concept completely and adapted fractal derivatives directly to the 1 d classical ade in place of the mass transfer coefficient allwright utilized a fractal dimension parameter and a fractal order to moderate various degree of diffusion the newly developed fractal ade can only be solved numerically allwright and atangana 2019 while this novel fractal advection dispersion model is promising it can only simulate 1 d mass transport at the moment which limits its application in full scale field tests in sensitivity analyses of the model allwright et al 2021 observed that the model is highly sensitive to the fractal parameters showing a few tenths variation in the fractal dimension can lead to exponential change in advection and dispersion of the solute adding to the challenge of calibrating the fractal model is the disconnect between the two fractal parameters and the usual hydrogeological field data that are typically utilized to characterize the subsurface 1 3 semi analytical model the reason the dual porosity model is such a compelling approach to overcome the shortcoming of the classical ade is because it is not constrained to the assumptions of analytical solutions and the underlying concept of separating the local diffusive flux from the rest of the mass fluxes is intuitive the model is also easily accessible via the numerical code mt3dms which is often packaged with modflow in a single convenient user interface aquaveo 2019 however its mass transfer coefficient is challenging to estimate and scale dependent in space and time there is a need for an alternative that can capture matrix diffusive effects as efficiently as the dual porosity model while not relying on the first order time dependent mass transfer coefficient the alternative we evaluate here is a semi analytical model that was originally developed by petroleum engineers to compute conductive heat flux from a permeable reservoir to an impermeable caprock vinsome and westerveld 1980 the model combines analytical and numerical modeling by only numerically discretizing the high permeability zones in the aquifer while solving for the conduction heat flux semi analytically using a temperature dependent source sink term computed in each gridblock and at every time step vinsome and westerveld 1980 pruess and wu 1988 1993 observing that heat conduction is analogous to contaminant diffusion bear et al 1994 and falta and wang 2017 adapted the method to simulate transient matrix diffusion of contaminants in semi infinite low permeability layers muskus and falta 2018 expanded the method s capability to simulate finite embedded heterogeneities the current implementation of the model has been successfully tested in both heterogeneous and fractured aquifer systems and in cases where multiple solutes undergo first order parent daughter decay reactions we compare the dual porosity model to the semi analytical method by muskus and falta 2018 in a series of parallel fracture simulations under loading and unloading conditions we focus on systems of parallel fractures as a starting point to establish the utility of the semi analytical method and to utilize a well known analytical solution for this geometry more complex tests can be explored in future works such as simulations in 3 d parallel fractures and 3 d discrete fracture networks this work will be organized as follows in section 2 we discuss the mathematical structure of the dual porosity model including its characteristic diffusion time and introduce the semi analytical method in section 3 we describe the methodology and results of the comparison between the dual porosity model the semi analytical method and an analytical solution in cases where the fracture spacing is varied and in section 4 we show the results of the cases where the decay rates and adsorption are varied 2 matrix diffusion models 2 1 dual porosity model 2 1 1 coupled transport equations and mass transfer coefficient via shape factor the dual porosity model is implemented as an optional feature in popular transport models such as mt3dms to simulate transport in fractured media or highly heterogeneous porous media zheng and wang 1999 in our simulations we assumed a homogeneous and constant groundwater velocity field flowing in x direction with contaminant decay only in the aqueous phase given those assumptions the coupled dual porosity model equations can be written as zheng and wang 1999 zheng and bennett 2002 1 v f ϕ f r c t 1 v f ϕ l r l c l t v f ϕ f d x 2 c x 2 d y 2 c y 2 d z 2 c z 2 x v x c λ ϕ f v f c λ l ϕ l 1 v f c l 2 1 v f ϕ l r l c l t β c c l 1 v f λ l ϕ l c l the subscript l in eqs 1 and 2 symbolizes parameters of the low permeability domain parameters without any subscript or with the subscript f are those of a fracture or a high permeability material eq 1 relates the mass balance in both the high permeability and low permeability domains to the net mass inflows from advective dispersive and first order decay processes eq 2 describes the rate of the diffusive mass transfer between the two domains in eq 1 the volume fraction v f is the ratio of the volume of highly permeable materials to the total volume this parameter specifies the degree of heterogeneity and is the same parameter that was introduced by muskus and falta 2018 the mobile porosity is defined as the product of the volume fraction and the porosity in the high permeability regions 3 ϕ m v v o i d f v v f ϕ f the equation parameter v v o i d f represents the volume of the void space in the high permeability materials whereas v is the total volume of both the low permeability and high permeability materials unlike the mobile porosity ϕ m which is defined over the total volume the high permeability porosity ϕ f is a material property that describes the actual porosity of the high permeability materials similarly the immobile porosity is the product of the volume fraction of the low permeability materials and the porosity in those regions 4 ϕ i m v v o i d l v 1 v f ϕ l the equation parameter v v o i d l is defined as the volume of the void space in the low permeability materials while the parameter ϕ l describes the actual porosity in the low permeability materials the sum of the mobile and immobile porosity is the total porosity ϕ m ϕ i m v f ϕ f 1 v f ϕ l ϕ which is also the ratio of the total void space in both domains over the total volume those porosity definitions are consistent with how zheng and wang 1999 had defined them previously the retardation factors in the low permeability and high permeability materials are r l and r retardation factors are utilized to account for the effects of sorption in the mass balance the aqueous mass concentrations in the low permeability and high permeability materials are c l and c the 3 d dispersion coefficients are d x d y and d z those coefficients control the horizontal vertical and transverse spread of the contaminant in porous media the x direction darcy velocity is v x which is a volumetric flux of water the first order decay rates in the low and high permeability materials are λ l and λ the decay rates control how fast a contaminant can degrade in the model in eq 2 the mass transfer between the two domains is moderated by the mass transfer coefficient β which is typically utilized as a calibrating parameter by practitioners neville et al 2000 an approach by van genuchten 1985 to estimate transport in plane sheet aggregates using a first order rate model was used to develop a mathematical expression for β van genuchten 1985 recognized that first order rate models such as the dual porosity model can be used to approximate transport in a system of plane sheet aggregates which is analogous to a system of parallel fractures he further observed that the mass transfer coefficient in the dual porosity model is a function of a shape factor which was defined as the ratio of the dimensionless time of the parallel fractured system over the dimensionless time of the dual porosity model the dual porosity dimensionless time was found by integrating eq 2 for an initial condition of zero concentration in the matrix and a boundary condition of fracture concentration at unity the dimensionless time of the parallel fractured system is known from an analytical solution of heat conduction in a solid bounded by parallel planes carslaw and jaeger 1959 van genuchten 1985 observed that when the two dimensionless times are plotted to varying concentration in the matrix one could glean from the plot a shape factor that would give a dual porosity matrix concentration equivalent to the analytical matrix concentration the resulting expression is 5 β 3 τ l d ϕ l 1 v f a 2 2 where τ l is the tortuosity factor of the low permeability material in porous media the chemical particles undergoing diffusion do not typically follow a linear path to account for more realistic channels through which the chemical diffuses the tortuosity factor is used the parameter d is the molecular diffusion coefficient and a is the fracture spacing the formula in eq 5 is tested extensively in this work and referred to as the shape factor formula of the first order mass transfer coefficient 2 1 2 characteristic diffusion time of the dual porosity model from the literature feehley et al 2000 swami et al 2018 and from our analysis of the dual porosity model it is observed that the dual porosity method would work in some cases such as one system of parallel fractures shown by neville 2006 but would not work as well in others such as the made site guan et al 2008 bear and cheng 2010 suggested that the dual porosity method is only valid when the concentration difference between the fracture and the matrix has reached a quasi steady state they gave a mathematical expression of when that steady state occurs but their formula did not utilize an effective diffusion coefficient we built on their work by seeking an improved mathematical expression of the characteristic diffusion time for the dual porosity model fig 1 shows a flow chart of how the characteristic diffusion time is derived this is a two pronged approach which begins with the governing equation of a solute diffusing into a low permeability matrix and the dual porosity equation in the low permeability domain boundary conditions are applied to the governing equation so the finite and semi infinite matrix mass fluxes can be analytically solved boundary conditions are applied to the dual porosity equation in the low permeability domain to derive the dual porosity mass flux the relationship between the semi infinite analytical mass flux and the dual porosity mass flux results in the characteristic diffusion time finally we validate the characteristic diffusion time expression by comparing the analytical mass flux in a finite matrix to the dual porosity mass flux fig 2 depicts diffusion of a chemical from a series of parallel fractures into finite matrix regions in between consider a system of parallel fractures where the fracture aperture is b and a is the fracture spacing fig 2 the fractures are orientated for vertical flow through the fracture apertures but they could be horizontal instead during an idealized loading period the aqueous concentration in the fracture is held at a constant concentration c 0 the transient concentration of a chemical diffusing into finite or semi infinite matrix can be described by the governing equation 6 r l c l t τ l d 2 c l x 2 when the matrix is semi infinite crank 1975 gave a solution to eq 6 satisfying the initial condition of c l 0 for x 0 when t 0 and the boundary conditions of c l c 0 at the matrix fracture interface x 0 and c l 0 at x 7 c l sf c 0 erfc x 2 κ t where κ τ l d r l and c l sf is the analytical concentration of a chemical diffusing into a semi infinite matrix the equation parameter κ is essentially an effective diffusion coefficient adjusted for sorption the semi infinite mass flux f l sf entering the matrix was found by taking a derivative of eq 7 with respect to x evaluating it at the matrix interface x 0 and applying fick s first law 8 f l sf ϕ l τ l d c 0 π κ t when the matrix is finite in a system as shown in fig 2 the diffusion of a chemical into the matrix is analogous to the conduction of heat over a finite region powers 1979 provided a solution satisfying the boundary conditions of c l c 0 at both interfaces of the matrix at x 0 and x a and an initial condition of c l 0 when t 0 9 c l c 0 2 π n 1 c 0 c 0 1 n n s i n n π a x e n π a 2 κ t the analytical diffusion mass flux was found by taking the derivative of eq 9 with respect to x and evaluating it at the matrix interface x 0 and applying fick s first law 10 f l 2 ϕ l τ l d a n 1 c 0 c 0 1 n e n π a 2 κ t the semi infinite mass flux in eq 8 was utilized to approximate the characteristic diffusion time of the dual porosity model in a finite matrix system to find the dual porosity mass flux we applied the boundary condition of c c 0 in the fracture to the dual porosity mass transfer equation eq 2 which then becomes 11 c l t β c 0 1 v f ϕ l r l β 1 v f ϕ l r l c l λ l r l c l eq 11 is a linear ordinary differential equation that can be solved by applying an initial condition of c l 0 when t 0 and using the integration factor method which gives the solution 12 c l d p β c 0 β λ l ϕ l 1 v f 1 e β λ l ϕ l 1 v f 1 v f ϕ l r l t the dual porosity mass discharge was found by multiplying the derivative of eq 12 with respect to time with the matrix volume matrix porosity and the matrix retardation factor 13 m l d m l d t r l ϕ l 1 v f v d c l d t β c 0 v e β λ l ϕ l 1 v f 1 v f ϕ l r l t where v a δ z δ y is the total volume the dimension a is used in the x direction for repeated parallel fractures as shown in fig 2 the dual porosity mass flux for a finite matrix system was finally obtained by dividing the dual porosity mass discharge in eq 13 over the cross sectional areas of the fracture on both sides of the matrix a 2 δ z δ y the dual porosity mass flux with the mass transfer coefficient expressed via the shape factor formula eq 5 and with the assumption of no decay is 14 f l d p 6 ϕ l 1 v f τ l d c 0 a e 12 κ a 2 t setting eq 8 equal to eq 14 squaring both sides and isolating the time variable yields an expression that can be solved for the time when the two solutions match 15 t e 24 κ t a 2 a 2 36 π κ note that the fracture aperture is typically several orders of magnitude smaller than the fracture spacing so the volume fraction was omitted from eq 15 eq 15 is in the canonical form of the lambert w function corless et al 1996 y e y x for a real number x 0 there are two roots to eq 15 y 1 w 0 x and y 2 w 1 x the smaller root along the principal branch w 0 x of the lambert w function is the characteristic diffusion time at which the dual porosity model using the shape factor formula of the mass transfer coefficient matches the analytical solution 16 t c w 0 2 3 π a 2 24 κ a 2 85 4 κ spatially the location of the solute in the matrix relative to the maximum diffusion distance i e half the fracture spacing at the characteristic diffusion time is a dimensionless quantity 2 κ t c a 0 22 so regardless of the fracture spacing the parallel fractures system passes the dual porosity s characteristic diffusion time when the chemical s front has penetrated 22 of the maximum matrix distance eq 16 is shown for a range of fracture spacing from 0 1 m to 10 m in fig 3 using τ l 0 1 r l 1 and d 0 0316 m 2 yr representative of trichloroethylene tce at small fracture spacing the characteristic diffusion time is small allowing the accurate use of the dual porosity model however the diffusion time increases as the square of the fracture spacing so using the dual porosity method at larger fracture spacing can lead to inaccurate results we validated the effectiveness of the characteristic diffusion time expression eq 16 by comparing the dual porosity mass flux over a finite matrix region eq 14 to the analytical solution eq 10 in fig 4 we show the characteristic time of the dual porosity method the analytical solution matrix mass flux and the dual porosity mass flux for three cases of fracture spacing at 0 1 m 2 m and 10 m with κ 0 00316 m 2 yr in fig 4 the black dashed line shows the analytical solution mass flux the red line shows the dual porosity mass flux as computed using the shape factor formula of the mass transfer coefficient eq 5 and assuming the matrix tortuosity τ l of 0 1 porosity ϕ l of 0 1 diffusion coefficient d of 0 0316 m 2 yr and negligible volume fraction v f the dual porosity method is effective at matching the analytical solution at the smallest fracture spacing case because the characteristic diffusion time is two orders of magnitude smaller than the total simulation time as the fracture spacing was increased the dual porosity mass flux was only satisfactory at times beyond the characteristic diffusion time at a certain fracture spacing the dual porosity method can be inaccurate in matching the analytical mass flux for hundreds or more years depending on κ in the fracture spacing case of 10 m the time threshold for using the dual porosity method is after 371 years for a κ value of 0 00316 m 2 yr 2 2 semi analytical model the semi analytical model is an adaptation of the vinsome and westerveld method in petroleum engineering to compute heat flux from a permeable reservoir to an impermeable rock vinsome and westerveld 1980 falta and wang 2017 muskus and falta 2018 muskus and falta 2018 developed a 3 d finite difference model in fortran that includes the semi analytical method assuming a uniform flow field called remchlor md farhat et al 2018 built a graphical user interface for the fortran code which can be downloaded free of charge the semi analytical method can simulate matrix diffusion into semi infinite aquitards and into embedded low permeability zones the method was tested in both heterogeneous porous media and parallel fractures with first order parent daughter decay reactions muskus and falta 2018 for a gridblock of volume v the method uses three modeling parameters the volume fraction v f the diffusion area a m d and the characteristic diffusion length l m d from a volume balance of the low permeability material these parameters can be related reducing the number of unknown parameters to two 17 1 v f v a m d l m d in a system of parallel fractures no calibration is required for the semi analytical diffusion parameters because they can be computed directly using the known fracture spacing a and the aperture b the diffusion length and the volume fraction can be computed as 18 l m d a b 2 19 v f b a when the diffusion length and the volume fraction are known the diffusion area a m d can be computed directly using eq 17 in a heterogeneous porous media system if the volume fraction of the high permeability materials can be reliably estimated only either the diffusion area or the characteristic diffusion length is needed to simulate matrix diffusion 3 varying fracture spacing simulations muskus and falta 2018 compared the semi analytical method against an exact analytical solution for a porous media system of 1 d parallel fractures developed by sudicky and frind 1982 they solved a set of coupled equations one for the advective diffusive and dispersive transport in fractures and another equation for only diffusive transport in the matrix adsorption and decay are also considered in both equations sudicky and frind 1982 assumed that the fracture aperture is significantly smaller than the length and that complete mixing exists in the fractures the coupled equations are solved by using laplace transform and crump numerical inversion sudicky and frind 1982 coded the solution in a fortran program called craflush which we used extensively in the present work craflush has an accompanying program called crafit which automates the calibration of breakthrough curves from column experiments toran 2000 in a previous test where matrix diffusion almost completely dominated transport the semi analytical model compared favorably with the results from craflush muskus and falta 2018 in the current work we have expanded the study of matrix diffusion in parallel fractures by testing a series of scenarios where the fracture spacing adsorption and solute decay rates were varied in those test scenarios the concentration simulated by the semi analytical and dual porosity models were compared to that of the analytical solution sudicky and frind 1982 3 1 simulations methodology a 1 d numerical grid with 200 gridblocks of 1 m long in the x direction was created this grid uses an equivalent porous media approximation to represent parallel fractures long et al 1982 anderson and woessner 1992 a range of fracture spacing from 0 1 m to 10 m was tested but the fracture aperture was fixed at b 100 μ m the hydraulic conductivity in the fractures was computed to be 2 30 e 5 m yr using a well known formula k f ρ g b 2 12 μ anderson and woessner 1992 where the water density ρ is 1 00 e 3 kg m 3 the constant of gravitational acceleration g is 9 808 m 2 s and the dynamic viscosity μ is 3 55 e 11 n yr m 2 munson et al 2009 the pore velocity in the fracture was held at 100 m yr the hydraulic gradient for the system was set at 0 0435 which is the ratio of the velocity to the hydraulic conductivity in the fracture for a fracture porosity ϕ f 1 the material porosity was set at ϕ l 0 1 for the matrix the mobile and immobile porosities were computed using eq 3 and eq 4 figs 5 and 6 show the trends of the volume fraction equivalent porous media darcy flux and equivalent hydraulic conductivity values as the fracture spacing increases as the fracture spacing increases there is more low permeability material in the system so the volume fraction decreases the equivalent porous media darcy flux is the largest when the fractures are close together and vice versa the largest equivalent porous media darcy flux was 0 1 m yr the equivalent hydraulic conductivity tested ranges from 230 1 m yr for a fracture spacing of 0 1 m to 2 301 m yr for a fracture spacing of 10 m for each fracture spacing case the pore velocity is a direct input in the analytical model sudicky and frind 1982 whereas the semi analytical model requires an equivalent porous media darcy flux as an input for the dual porosity model as implemented in mt3dms zheng and wang 1999 the darcy flux is not a direct input so an equivalent flow field is generated first using modflow harbaugh 2005 a total of nine flow fields were simulated one for each fracture spacing case each flow field was then used to simulate an equivalent darcy velocity in the dual porosity transport model a flow field can be simulated in modflow by setting head boundary conditions at the upstream and downstream of each flow model using an equivalent hydraulic conductivity and the same gradient of 0 0435 after a flow model ran successfully in modflow a tce source concentration of 100 mg l was introduced at the upstream end of the fractured system advective loading of the source was enforced by setting the dispersivities in the source cells to a small value the source was maintained for 50 years at 0 05 years timestep in each fracture spacing model and following complete source removal clean water was flushed through the system for another 50 years a longitudinal plume dispersivity of 0 5 m or half of the gridblock spacing in the x direction was used in the analytical solution in the semi analytical and dual porosity models advection terms were solved for by the standard finite difference scheme with upstream weighting which has an inherent numerical dispersivity value of 0 5 m same as the value used in the analytical model sudicky and frind 1982 initially neither decay nor adsorption was considered as fracture spacing was varied then simulations were run where the fracture spacing was varied as the solute half life decreases from a no decay condition to 10 years 5 years and 1 year finally simulations were run where the fracture spacing was varied as the retardation factor was increased from 1 no retardation to 2 and 5 modflow and mt3dms models were set up using the graphical user interface groundwater modeling system gms developed by aquaveo 2019 table 1 summarizes the modeling parameters used for the fractured media experiments fracture concentration profiles over distance from the source were plotted at four time periods which were selected to study the system behavior before and after source removal and at high and low concentration gradients to quantitatively evaluate the models the root mean square errors rmses of the semi analytical and dual porosity concentrations in comparison to the analytical solutions were computed at each time period rmse j i 1 n a i s i 2 n where rmse j is the root mean square error for time period j singh et al 2007 a i is the analytical solution s concentration at a distance x i s i is the simulated concentration of either the semi analytical or the dual porosity model and n is the total number of simulated values along the x direction rmses at log scale were computed similarly rmse j log i 1 n l o g a i l o g s i 2 n the normalized root mean squared errors nrmses were calculated by normalizing the rmses by the range of concentrations from the source concentration highest value to the typical method detection limit of dissolved tce 0 001 mg l smallest value nrmse j rmse j c 0 c mdl nrmse j log rmse j log 5 average nrmses of concentration profiles over the four time periods at linear and log scale were computed and are referred to as the marginal nrmses marginal nrmse j 1 4 nrmse j 4 marginal nrmse log j 1 4 nrmse log j 4 the average of those values i e the average marginal nrmses were calculated for each fracture spacing case and for both the semi analytical and the dual porosity concentrations average marginal nrmse marginal nrmse marginal nrmse log 2 the average marginal nrmse was used as a single metric to compare the effectiveness of the semi analytical and the dual porosity models in various fractured systems and under different conditions of plume decay and retardation 3 2 results of fractured media simulations 3 2 1 semi analytical method compared with analytical solution because of the simplified geometry of the parallel fractured system all diffusion modeling parameters of the semi analytical method were computed directly using eq 17 through 19 for the dual porosity model the first order mass transfer coefficient was estimated using the shape factor formula eq 5 because the accuracy of the dual porosity model depends on the characteristic diffusion time the dual porosity model was manually calibrated by adjusting the mass transfer coefficient until the lowest average marginal nrmses for all time periods was found fig 7 shows the concentration profiles from the analytical and semi analytical solutions in four tested fracture spacing cases and it highlights how the fracture spacing influences the shape of the concentration profiles in the fractures the figure includes concentration profiles in blue and yellow from the early time and late time of the loading period respectively the green and purple profiles are from the early time and late time of the unloading period the 1 year profiles blue lines of the loading period for the four fracture spacing cases are similar to one another the semi analytical method was able to match the exponential shape of the analytical loading curve at 1 year both the analytical and the semi analytical concentration profiles in blue were below the detection limit at 10 m from the source in the four fracture spacing cases at 49 years the solute has only advanced a few tens of meters in spite of the 100 m yr pore velocity when the fractures were very close together in the case of 0 1 m spacing the 49 year profile was similar to the shape of a system with a clear but retarded advective front in this small fracture spacing case the solute at source concentration was in the fractures for nearly 40 m before the concentration dropped fig 7d the advective front developed at 50 m from the source as the plume was moving at the apparent transport velocity of 1 m yr which is 100 times slower than the pore velocity in the fractures in the 51 year profiles green lines the clean water front is strongly retarded by matrix diffusion the 100 year concentration profiles purple lines showed the effects of matrix diffusion following source removal and their peak concentrations vary inversely with the fracture spacing at the smallest fracture spacing the concentration profile resembles advective dispersive transport with a high retardation factor the analysis of the concentration profiles indicated a good match between the analytical solution and the semi analytical method over a range of fracture spacing peak concentrations simulated by the semi analytical method were a bit less accurate at large fracture spacing cases during the unloading period but as the spacing was decreased the match became much closer 3 2 2 semi analytical method compared with dual porosity model before comparing the semi analytical and the dual porosity results under matrix diffusion it was verified that the mt3dms dual porosity and the remchlor md semi analytical models produced the same results in the absence of matrix diffusion the objective was to isolate the simulation of the matrix diffusion process from the simulation of other transport processes when comparing the two models in fig 8 the case of 0 1 m fracture spacing is simulated using the semi analytical and the dual porosity models without matrix diffusion to remove matrix diffusion effects the semi analytical method s matrix diffusion area a m d and the dual porosity mass transfer coefficient β were set to zero after one year the advective front was at 100 m from the source and it moved downgradient at the pore velocity of 100 m yr following source removal the 51 year profile mirrored the 1 year profile over the y axis as the system switched from being loaded with a source to being flushed with clean water in the absence of matrix diffusion the clean water front also moves at the pore velocity of 100 m yr the semi analytical and dual porosity profiles are identical indicating that the two models only differ in the way they simulate diffusive transport in the matrix although only the fracture spacing case of 0 1 m is shown here the same analysis was repeated for all fracture spacing cases with the same result after verifying that the mt3dms dual porosity and the remchlor md semi analytical models produced identical concentration profiles in the absence of matrix diffusion diffusion was considered in both models for the semi analytical model the matrix diffusion area was changed from zero to a computed value eq 17 for the dual porosity model the mass transfer coefficient was computed first using the shape factor formula eq 5 then additional mass transfer coefficients were tested by trial and error to gauge the effects the coefficients had on the concentration profile and to calibrate a better fit to the analytical solution fig 9 shows concentration profiles at four time periods for the largest fracture spacing of 10 m the analytical solution is shown as the dashed black line whereas the semi analytical simulation is shown as the blue dash dotted line the dual porosity simulations are shown as solid color lines the mass transfer coefficient with three significant figures is the coefficient computed by the shape factor formula eq 5 while the rest are iterations of the coefficient from calibrations the mass transfer coefficient value that produced the lowest average marginal nrmse value over the four time periods is plotted as asterisks a high mass transfer coefficient simulates a high rate of mass transfer into the matrix so during the loading period that results in lower concentration profiles in the fractures for example the orange solid line associated with the highest mass transfer coefficient of 0 2 yr was barely visible after one year of source loading fig 9 a after 49 years that profile was more visible but it was still the lowest concentration profile fig 9 b as the mass transfer coefficient was decreased the concentration profile became more prominent during the loading period because less mass was transferred to the matrix leaving more mass in the fractures the unloading profiles are directly related to the mass loading behavior if a high mass transfer coefficient was used during the loading period more mass was stored in the matrix and in the unloading period more mass diffused out from the matrix the mass transfer coefficient computed via the shape factor formula was unable to produce concentration profiles that match the analytical solution because the characteristic diffusion time of 371 years has not passed in all four time periods under consideration see fig 3 four orders of magnitude from the initial mass transfer coefficients were tested in a calibration process to improve the fit of the dual porosity concentration profiles even after calibration the dual porosity model was still unable to match the analytical solution because a calibrated mass transfer coefficient that quantitatively placed the dual porosity concentrations close to the analytical solution during the loading period could not match the analytical solution during the unloading period as observed by guan et al 2008 because the mass transfer coefficient is a time dependent parameter it may not be possible to have one parameter that works for all time periods being only applicable to systems at a certain time makes the dual porosity model less useful for simulations such as the one being considered here where the concentration profiles are evaluated over 100 years with a reversal of the matrix diffusion gradients for fracture spacing case of 2 m fig 10 the characteristic diffusion time is only 15 years so the dual porosity model is expected to match the analytical solution better at later times during loading and unloading periods the yellow lines are the concentration profiles produced by the mass transfer coefficient computed using the shape factor eq 5 it matched relatively well with the analytical solution at time periods 49 years and 100 years which are both greater than the characteristic diffusion time of 15 years it did not match the analytical solution at 1 year and 51 years because the characteristic diffusion time which is reset after the source is removed had not been reached the semi analytical method matched analytical solution well at all time periods the profile of the calibrated mass transfer coefficient value was plotted as the cyan asterisk line calibrations were implemented by trial and error to seek the mass transfer coefficient that gave the lowest average marginal nrmse the calibrated coefficient improved the fit at later times but at early times prior to the characteristic diffusion time the dual porosity model was unable to match the analytical solution using a single mass transfer coefficient for all time periods in fracture spacing case of 0 1 m fig 11 the characteristic diffusion time is short at 0 04 years which is less than all four time periods of analysis in this case the dual porosity model is expected to match the analytical solution well at all times the best fit mass transfer coefficient for this case was 0 5 yr which is not far off from the value of 0 378 yr predicted by the shape factor formula though not shown here we plotted the concentration profiles of both models at log scale and observed similar results we repeated the concentration profile comparison for other fracture spacing cases in the range between 0 1 m and 10 m fig 12 summarizes the change of the average marginal nrmses for both the semi analytical and the dual porosity models over the range of fracture spacing the nrmse values for the semi analytical method were consistent at 3 5 or less in contrast the mass transfer coefficient computed by the shape factor formula only worked without calibration at fracture spacing less than approximately 1 m at the largest fracture spacing the uncalibrated dual porosity model produced an error tenfold that of the semi analytical method the effectiveness of the mass transfer coefficient based on the shape factor is limited by the characteristic diffusion time which can only be satisfied at smaller fracture spacing even with calibration the dual porosity model s error could still be five times higher than that of the semi analytical model in the largest fracture spacing case calibration cannot remove the dependency of the mass transfer coefficient on the characteristic diffusion time while a calibrated mass transfer coefficient perhaps can produce a concentration profile that would work at some time periods it did not produce a profile that would work at all times unless the fracture spacing is small 4 simulations with decay and adsorption 4 1 varying decay rate the effects of decay in the same fracture systems were evaluated using a similar approach in fig 13 concentration profiles simulated by the semi analytical method in comparison with the analytical solution in cases from low 10 year half life to fast decay rates 1 year half life are shown the decay rates in the fractures were assumed to be the same as in the matrix the analytical profiles show the changes of the plume concentration under an increasing decay rate near the source the analytical concentration decreased from over 70 mg l to approximately 55 mg l as the decay rate was increased from a half life of 10 years to 1 year following the removal of the source the peak concentration of the 53 year profiles lowered from over 20 mg l under a slow decay rate to 2 mg l under the fastest decay rate the increasing decay rate also reduced the spatial extent of the contaminant exceeding the detection limit from nearly 40 m from the source to only about 15 m the semi analytical method matched the overall shape of the analytical solution well especially in the unloading period the comparison shows that the semi analytical method can be useful when comparing between passive and active remediation strategies to minimize the impact of matrix diffusion in this context the passive approach is to allow a contaminant to naturally attenuate under a slow decay rate while the active approach is to stimulate a higher rate of degradation three additional fracture spacing cases of 0 1 m 5 m and 10 m were simulated with the three decay rates of 10 year 5 year and 1 year half life not shown the semi analytical and the dual porosity profiles were compared with the analytical solutions similar to the no decay cases the semi analytical model was able to match the analytical solution over a range of fracture spacing and decay rates meanwhile the dual porosity model was unable to match the analytical solution at large fracture spacing in smaller fracture spacing cases when the characteristic diffusion time was small the dual porosity model performed better the average marginal nrmses across the four time periods on linear and log scale were computed for each decay rate it was noted that in the case of 1 year half life decay the concentrations were below the detection limit very quickly reducing the analytical solution s sample size from 200 observations to as low as four observations in one time period such a small sample size can skew the average nrmse results high so the nrmses for the 1 year half life decay are not compared fig 14 shows the nrmse results for the 10 year half life and the 5 year half life decay rates the impact of decay on the dual porosity model s accuracy was negligible when the fracture spacing is sufficiently small doubling the decay rate yielded similar nrmse ranges between 0 1 m and 10 m of fracture spacing calibrating the mass transfer coefficient reduced the dual porosity model s nrmses but for the largest fracture spacing even its calibrated nrmse was three to four times than the semi analytical method s the accuracy of the dual porosity model depends on the fracture spacing similar to what we observed when varying fracture spacing without decay meanwhile the accuracy of the semi analytical method with and without decay was consistent with a nrmse less than 5 over a range of fracture spacing 4 2 varying adsorption following the simulations of varying decay rates simulations with only adsorption were evaluated retardation factor of 2 and 5 were tested in the same system of parallel fractures the retardation in the matrix and in the fractures was assumed to be the same fig 15 shows the changes in the concentration profile at fracture spacing of 1 m as the retardation was increased from 1 to 5 as the retardation was increased the matrix s mass storage capacity increased the change was especially apparent in the 100 year profiles purple lines when the peak of the fracture concentration profile decreased because more mass was stored in the matrix the shape of the 1 year and the 49 year profiles was similar to one another but the profiles of the retardation factor of 5 had a shorter spatial extent as the extra storage capacity reduced the dissolved concentration in the fracture the semi analytical method matched the analytical solution during the loading period better than during the unloading period during the unloading period it overestimated the concentration peak but was still able to match the timing of the peak and the overall shape of the analytical solution well the overestimation was less apparent at 1 year after source removal as the retardation rate was increased green lines when overlaying the dual porosity profiles onto the semi analytical and the analytical profiles not shown we observed the same trends as in the varying decay and varying fracture spacing analyses the dual porosity model again performed poorly at larger fracture spacing at the four time periods of analysis at a smaller fracture spacing the model matched better when the characteristic diffusion time was satisfied the average marginal nrmses of the semi analytical and the dual porosity method for each fracture spacing case at both retardation rates were computed and plotted in fig 16 nrmses of the concentration profiles predicted by the shape factor formula yellow lines increased as the fracture spacing and the retardation factor increased calibration reduced the dual porosity model s nrmse but even then it was still over four to five times higher than the semi analytical method s at the largest fracture spacing the nrmses of the semi analytical method were at or below 5 consistent with the cases with and without decay 5 conclusion simulations were performed in parallel fracture systems to compare the effectiveness of the dual porosity and the semi analytical models in simulating dissolved concentrations in the fractures the analytical solution by sudicky and frind 1982 was used as the benchmark in the comparisons the accuracy of the dual porosity model with calibrations was dependent on a characteristic diffusion time which was shown to increase with the square of the fracture spacing at small fracture spacing when the diffusion time was small the dual porosity model showed good accuracy while at larger spacing the model was less accurate in matching the analytical solution a mathematical expression of the mass transfer coefficient based on a shape factor van genuchten 1985 was used in initial dual porosity models prior to calibrations meanwhile the semi analytical method matched the analytical solution at less than 5 nrmse without any calibration required the semi analytical method is not meant to produce an exact match with the analytical solution because at best it is only an approximation of an inherently complex mass transfer process especially in fractured media with a large matrix volume although the match is not exact the semi analytical method produced errors lower and more stable than the alternative the results presented in this work showed that when comparing the semi analytical method and the dual porosity method in cases of varying fracture spacing decay rates and adsorption the semi analytical method is more accurate and robust over a range of fracture spacing unlike the dual porosity method the semi analytical method does not depend on a characteristic diffusion time and its modeling parameters in parallel fractures can be computed directly from the fracture geometry the semi analytical method is currently being studied in 3 d discrete fracture networks parameter unit definition a m d l 2 semi analytical matrix diffusion area a l parallel fractures spacing b l fracture aperture c m l 3 concentration in high permeability high k material c 0 m l 3 initial concentration c l m l 3 concentration in low permeability low k material c l dp m l 3 dual porosity concentration in low k material c l sf m l 3 analytical concentration in semi infinite low k material d l 2 t solute diffusion coefficient d x d y d z l longitudinal transverse and vertical dispersivities f l f l sf m t l 2 analytical mass flux in finite and semi infinite matrix f l dp m t l 2 dual porosity mass flux in finite matrix l m d l semi analytical diffusion length m l m t dual porosity mass discharge in finite matrix r r l retardation factors of high k and low k materials t c t dual porosity characteristic diffusion time v l 3 gridblock volume v f volume fraction v v o i d f v v o i d l volumes of void space in high k and low k materials v x l t darcy velocity in x direction β 1 t mass transfer coefficient κ l 2 t ratio of effective diffusion coefficient over retardation factor λ λ l 1 t degradation rates of high k and low k materials τ τ l tortuosity factors in high k and low k materials ϕ f ϕ l porosities of high k and low k materials ϕ m ϕ i m mobile porosity and immobile porosity credit authorship contribution statement kien t pham conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization ronald w falta conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the environmental security technology certification program estcp united states project er19 5028 and by the strategic environmental research and development program serdp project united states er 2529 
149,flows involving immiscible displacement of one fluid by another in a porous media are known to destabilize and form fluid fingering when the non wetting fluid is a highly mobile gas air and the wetting fluid is an in compressible liquid water the classical macroscopic theory is unable to describe the fingered flow in part i of this study we have introduced a model that interprets the mixture of wetting and non wetting fluids within the pore space as a single saturating non uniform pore fluid characterized by a phase field parameter which is considered to be the saturation degree of the wetting fluid in the current study we present a linear stability analysis of its solutions which describe both imbibition and drainage the analysis sheds light on the sensitivity of the flow stability on injection flux imposed pressure gradient and initial saturation degree two dimensional numerical simulation results are as well presented which verify the stability analysis and reveal the rich structure of the fluid fingering realized by this model while these results are found to be in qualitative agreement with experimental observations they also warrant further experimentation to explore the additional features predicted by the model keywords partial saturation phase field modeling stability analysis 1 introduction the classical problem of stability of an interface formed between two immiscible fluids is known to be further complicated by the presence of a confining solid substrate which is a typical scenario in a two phase flow within a porous medium the transition region between the zones saturated by two different fluids within porous media can be described as a mixing region where both fluids partially saturate the pore spaces this mixing region can be viewed and modeled as a diffused interface bridging the two fully saturated zones destabilization of such a diffused interface and eventual fingering formations have a fractal structure rather than smooth formations as in the case of two phase hele shaw flow saffman and taylor 1958 this is in most part due to an intrinsic property of porous media which is the existence of several length scales homsy 1987 nevertheless being able to model such fingering phenomena has its uses in a myriad of applications ranging from soild hydrology glass et al 1988 jarvis 2007 clothier et al 2008 to carbon dioxide co 2 sequestration lackner 2003 torp and gale 2004 orr 2004 ajayi et al 2019 numerous experimental campaigns have been carried out to characterize such flow both in the case of imbibition where the wetting fluid displaces the non wetting fluid and vice versa in the case of drainage while foundations for a systematic characterization of flow instabilities in porous media were laid in the 80 s with the seminal work of lenormand and his colleagues lenormand 1985 lenormand et al 1988 lenormand 1990 subsequent works have shed light on these phenomena in the presence of gravity both in imbibition glass et al 1989b selker et al 1992 yao and hendrickx 1996 bauters et al 2000 shiozawa and fujimaki 2004 and drainage birovljev et al 1991 auradou et al 1999 méheust et al 2002 løvoll et al 2005 among others however continuum scale modeling efforts were largely focused for the case of imbibition especially in the soil hydrology community in this context widely accepted richards equation richards 1931 was known to suffer from its inability to model fingering instabilities due to its unconditional stability against transverse perturbations egorov et al 2003 nieber et al 2005 it has been hypothesized based on experimental evidence bauters et al 2000 shiozawa and fujimaki 2004 dicarlo 2004 dicarlo et al 2010 and related numerical studies nieber et al 2000 eliassi and glass 2001 that fingering type instabilities during infiltration into initially dry soils is associated with an overshoot type non monotonic profile of the water content along the length of the finger and that this overshoot is the cause rather than the consequence of the instability subsequently various model extensions of the richards equation eliassi and glass 2002 2003 dicarlo et al 2008 cueto felgueroso and juanes 2009a to name a few aimed to an extent to reproduce such non monotonic saturation profiles and consequently the fingering type instabilities if a model succeeds in replicating fingering or not is revealed in part through a stability analysis of its solutions against transverse perturbations such analyses were performed for some of these models egorov et al 2002 2003 nieber et al 2005 cueto felgueroso and juanes 2009b revealing their conditionally stable nature in the above mentioned works non monotonic solution profiles were achieved either by a priori choice of non monotonic retention relations or by the use of fourth order in space extensions of the richards equation while in the current work we incorporate both these features a thermodynamically sound basis for this choice as explained in part i is justified through the connection to the cahn hilliard fluid modeling in part i we have introduced the proposed phase field approach based on the framework established in sciarra 2016 that views the presence of two fluids as a single non uniform fluid saturating the pore space this is done by a prescription of double well type bulk fluid energy in the spirit of cahn and hilliard 1958 1959 in combination with a classical capillary energy accounting for the retention effect due to the confinement provided by the pore walls in this context it has been shown that a proposed non convexity of the flux function enables describing both imbibition and drainage solutions in the presence of higher order diffusion which to the authors knowledge has been realized for the first time employing an extended richards equation non monotonicities observed in the solutions have as well been justified with a combination of matched asymptotic analysis and dynamical systems analysis the current work is intended as an extension to the part i presenting a linear stability analysis of the model and revealing its conditionally stable nature the essence of linear stability analysis performed is to understand if a small enough initial perturbation to the base solution grows or decays asymptotically in time by employing the principles of lyapunov stability analysis we complement this analysis with two dimensional model simulations which in part verify the results of the linear stability analysis and also reveal the non linear growth in time of the fingers as well in this model a non monotonicity in the infiltration solutions is accompanied by an ensuing growth of transverse instabilities associated to fingering the effects of varying initial water content and magnitude of imposed pressure gradient have been analyzed in the case of drainage the effect of increasing gravitational component equivalent imposed pressure gradient has been revealed to stabilize the invading front as was observed experimentally méheust et al 2002 further a stability analysis against longitudinal perturbations revealed instability of certain solutions resulting in bubble or droplet like trapped regions behind the invading front which are the consequences of a coarsening process associated to a kind of metastable behavior as described for instance in bates and fife 1990 alikakos et al 1991 this is associated to the non monotonic structure of the fluid bulk energy this work is organized as follows in section 2 a recall is done to the essential aspects related to the construction of the proposed model and excerpts of the one dimensional results from part i are presented briefly section 3 and section 4 are dedicated to detailed linear stability analysis against transverse and longitudinal perturbations respectively results of two dimensional finite element simulations are presented in section 5 that reveal the non linear evolution of the both imbibition and drainage solutions the physical dimensions of quantities within this work are mentioned whenever relevant alongside their corresponding symbols and within square brackets m l t 2 summary of the model in part i of the current study a phase field approach has been introduced to model fluid fluid displacements within porous media based on the thermodynamic framework constructed in sciarra 2016 in essence this model is an extension to the classical richards equation richards 1931 viewing the presence of two different fluids within a pore network as a single non uniform pore fluid further indexed p f saturating the pore space 2 1 the non uniform pore fluid as usual in cahn hilliard type modeling approach an order phase field parameter s r is furnished to distinguish the two phases and the saturation degree of the wetting fluid is assumed to play this role local and non local contributions are postulated to constitute the free energy of the non uniform fluid saturating the porous medium e as was assumed in the part i the solid skeleton is considered to be non deformable in the current analysis the local contribution is assumed to account for the presence of both the fluid fluid and solid fluid interfaces adopting the same notation as in part i the overall free energy density of the non uniform pore fluid per unit reference volume of porous medium is written as 1 ψ p f ϕ ψ l s r ϕ u s r ψ n l ϕ s r where ϕ is the lagrangian porosity of the porous skeleton inline with the above description the local bulk contribution to the free energy density ψ l s r that is responsible for phase segregation and allows for coexistence of the immiscible phases sciarra 2016 has the functional form 2 ψ l s r c γ r s r 2 1 s r 2 where γ mt 2 is the surface tension between the two fluids that compose the non uniform fluid r l is the characteristic radius of channels intrinsic to the porous skeleton which according to leverett 1941 scales with ϰ ϕ 0 here ϰ l2 is the intrinsic permeability of the porous skeleton and ϕ 0 its initial porosity c is a dimensionless parameter signifying the intensity of local contribution to the overall energy the capillary energy density typically is an empirical relation fit to experimental data and in this work we adopt the widely used van genutchen form van genuchten 1980 3 u s r s r 1 p c s d s 4 p c s r u s r π 0 s r s r r e s 1 s r r e s 1 m 1 1 m where p c ml 1t 2 is the classical capillary pressure and π 0 ml 1t 2 is a reference pressure which scales as ρ w g ℓ c ℓ c l is the porous media counterpart of capillary length scale that relates intensity of capillary forces in the porous medium to that of gravity and m is a model parameter s r r e s is the residual saturation degree of the wetting fluid the non local energy density is assumed to be quadratic in the gradient of the fluid content and thus has the form 5 ψ n l ϕ s r c k 2 ϕ s r ϕ s r where c k mlt 2 is a coefficient that determines the spatial influence of this non local energy c k can be reinterpreted as π k ℓ 2 such that a characteristic interface thickness ℓ l is introduced into the equations and a free parameter π k ml 1t 2 appears assuming a rigid porous skeleton ϕ ϕ 0 c o n s t as done further the variational derivative w r t s r of overall free energy of the porous medium gives the chemical potential of the non uniform pore fluid 6 μ p f ψ l s r u s r μ e s r ψ n l ϕ s r μ n l where the first two terms in the expression on the right hand side can be identified as originating from the local contribution and so labeled as effective chemical potential μ e s r μ l s r p c s r identification of μ p f starting from the constitutive prescription of the non uniform fluid and porous solid is detailed in part i 2 2 phase field governing equation conservation of fluid mass within a porous medium fully saturated by the non uniform pore fluid is written as 7 m f t m 0 in its local form where m f ρ f ϕ is the non uniform fluid content per unit volume of porous medium and m is the lagrangian fluid mass flow vector relative to the skeleton for an s r 0 1 a simple linear interpolation can be assumed for the apparent density ρ f of the non uniform fluid kim 2012 starting from the individual densities of pure phases ρ w ρ n w invoking the typical assumptions in soil hydrology hilfer and steinle 2014 the non uniform fluid is assumed to be composed of in compressible water ρ w c o n s t and highly rarefied air the latter being continuously connected to the atmosphere this leads to pressure of air phase being equivalent to reference atmospheric pressure assumed 0 for convenience concurrently invoking an ideal gas law for air implies that its density ρ n w is negligible compared to that of water ρ w ρ n w 0 leading to the following simplification 8 ρ f ρ w s r ρ n w 1 s r ρ w s r further the classical approach to porous media flow that employs the two phase darcy s model is generalized to the flow of the non uniform pore fluid 9 m ρ w ϰ η w k s r μ p f p ρ w ϰ η w k s r μ relating the lagrangian fluid mass flow m ml 2t 1 to the spatial gradient of an augmented chemical potential μ the latter is a sum of the chemical potential of the non uniform pore fluid μ p f and of an imposed linear pressure distribution p λ x where λ ml 2t 2 is a scalar this augmented chemical potential accounts for a more general case incorporating both the effect of an initial background mean flow and that of gravity forces in the case when only gravity forces are considered the pressure distribution p is just proportional to λ ρ w g in the above generalized darcy s flow relation a phenomenological flux function k s r is introduced as a proportionality function and η w ml 1t 1 is the dynamic viscosity of the wetting fluid the specific thermodynamic restrictions on k s r can be found in part i eq 9 in combination with the conservation law for the fluid mass eq 7 and the simplification eq 8 gives a cahn hilliard like local governing equation for the phase field parameter s r in the bulk of the domain 10 ϕ s r t ϰ λ η w k s r x ϰ η w k s r μ p f 0 assuming a rigid porous skeleton ϕ ϕ 0 c o n s t the quantity ϰ λ η w lt 1 can be identified as the magnitude of a saturated mean velocity v m in the porous medium that is equivalent to the saturated hydraulic conductivity when the flow is driven by gravity this multidimensional partial differential equation pde eq 10 encompasses the various features of the non uniform pore fluid and of its flow within a rigid pore network as described earlier in the part i a particular dimensionless grouping of parameters has been proposed by introducing characteristic scaling numbers for length x h l time t h x h v m x h η w ϰ λ and pressure chemical potential p h c γ r l is a characteristic length of the physical domain of the problem under consideration subsequently the following dimensionless numbers were introduced 11 c a v m η w r 2 ϰ c γ δ r r x h d u π 0 r c γ d n l c k r c γ x h 2 π k r c γ ℓ x h 2 whose values depend on those of the material parameters see table 1 2 in part i employing these choices results in the dimensionless counterpart of eq 10 12 ϕ s r t k s r x δ r c a k s r μ e s r δ r c a ϕ d n l k s r δ s r 0 where δ s r denotes the laplacian of s r it is to be noted that now time and spatial descriptions are to be understood as their dimensionless counterparts also with an abuse of notation μ e μ and its different contributions μ l p c μ n l now represent their dimensionless counterparts accordingly the dimensionless augmented chemical potential in eq 9 has the form 13 μ 2 s r 1 3 s r 2 s r 2 μ l s r d u s r s r r e s 1 s r r e s 1 m 1 1 m p c s r d n l ϕ s r μ n l δ s r c a δ r x p from this point all the variables are dimensionless unless either mentioned otherwise or referred to from earlier sections 2 3 one dimensional traveling wave solutions in part i a one dimensional analysis of this phase field model has been done and solutions s r x t of the one dimensional pde 14 ϕ s r t k s r x δ r c a x k s r μ e s r s r x δ r c a ϕ d n l x k s r 3 s r x 3 0 have informed on the presence of similarity profiles of traveling wave tw type with a diffused interface with uniform saturation degrees s s on either side of such interface in the above is introduced as the derivative with respect to the phase field parameter s r these self similar solutions are understood as representative of air water displacements within a non deformable porous network owing to its equivalence to the relative permeability function in classical partial saturation coussy 2004 the flux function k s r is assigned an empirical form widely used van genuchten 1980 luckner et al 1989 15 k s r s r 1 1 s r a b c where a b and c are real constants obtained through experimental fitting it has been numerically shown in part i that diffused interface solutions of eq 14 which represent both imbibition and drainage solutions are possible owing to the proposed non convexity of the flux function k s r these tw type solutions with a translating diffused interface are understood as smeared shock solutions of the riemann problem governed by eq 14 with boundary conditions prescribed by the uniform saturation degrees on either side of the diffused interface s and s the speed of translation of these solutions can be approximated by that of representative sharp shock solutions using the rankine hugoniot jump condition 16 k s k s c ϕ s s subsequently a transformation of eq 14 can be done into the tw coordinate ξ x c t and self similar solutions s ξ of the ordinary differential equation ode 17 ϕ c d s d ξ d k s d ξ δ r c a d d ξ k s μ e s d s d ξ δ r c a ϕ d n l d d ξ k s d 3 s d ξ 3 0 on an infinite domain can be sought after with appropriate boundary conditions at ξ 18 s ξ s d s d ξ ξ 0 s ξ s d s d ξ ξ 0 integrating eq 17 once w r t ξ using the boundary conditions at ξ and assuming higher derivatives of the solution vanish as ξ yields in a canonical form 19 d 3 s d ξ 3 c a δ r ϕ d n l k s ϕ c s s k s k s δ r c a k s μ e s d s d ξ in part i tw solutions satisfying eq 18 and 19 that represent both imbibition and drainage have been resolved numerically over a domain of finite length l 0 100 m that is sufficiently large in comparison to both the length scale of the air water interface ℓ 0 2 m and that of the second order diffusion such that we get a satisfactory approximation of an unbounded domain in the case of imbibition solutions of the pde eq 14 have informed that their self similar region extends from the left boundary condition s to the right boundary condition s consequently tw solutions of 19 were resolved for various values of s and s in eq 18 for s s using a second order accurate central difference scheme to approximate the derivatives involved fig 1 shows these solutions for varying values of s s and λ as such in the physical problem s is related to the dimensionless injection velocity v f by the relation 20 v f δ r c a k s p k s e x where e x is an unit vector in the positive x direction note that p is now the dimensionless counterpart of the linear pressure distribution introduced earlier so the left boundary condition s used to resolve the tw solutions can be related to the magnitude of dimensionless injection velocity k s in the physical problem and from fig 1 a non monotonicities can be observed only for a certain intermediate range of injection velocities this observation is found to be qualitatively inline with quasi one dimensional infiltration experiments dicarlo 2004 into initially dry porous media these non monotonicities in the solutions encompass oscillations and overshoot undershoot all the imbibition solutions were understood as representative of classical compressive in the sense of shock solutions of the hyperbolic limit of eq 14 these imbibition solutions for varying initial saturation degree of the domain and imposed pressure gradient are shown in fig 1 b and fig 1 c respectively drainage solutions of the pde eq 14 on the other hand revealed that for a given set of boundary conditions s s only part of the solution is a self similar diffused interface representing a tw solution and in addition to this the solution is composed of expanding regions fig 2 shows these tw solutions resolved for various values of λ two qualitatively different type solutions have been observed for lower range of λ the diffused interfaces were representative of non classical expansion shock solutions of the hyperbolic limit of eq 14 whereas for higher range of λ the diffused interfaces were representative of non classical under compressive shocks 3 stability against transverse perturbations saffman and taylor 1958 have studied the stability of an horizontal sharp interface separating two viscous fluids within a hele shaw cell driven by an imposed pressure gradient and under the influence of gravity it has been shown that wave like disturbances of arbitrary wavelengths can grow in time and eventually destabilize the interface if the motion of the interface is towards the more viscous fluid and if the velocity is sufficiently large further the effect of surface tension has been suggested referring to the work of chuoke et al 1959 to be acting to limit the range of wavelengths of the disturbances to which the interface is unstable a study of stability of the diffused interface formed within the non uniform pore fluid that is modeled using the eq 12 is warranted given the analogous nature of porous media flow with respect to hele shaw flow with this intention the base solutions resolved as traveling waves are understood as plane wave solutions that are independent of the direction orthogonal to their propagation arbitrary wave like perturbations are then superposed to these base solutions and the growth in time of the former is understood as early time fingering phenomenon 3 1 perturbed problem the base solutions in the physical domain are represented as s 0 x t and they propagate along the x direction exploiting the method of asymptotic expansions the physical solution itself is assumed to be a perturbed one s x y t that is composed of the base solution s 0 x t at the leading order and superposed disturbances resulting in a regular series expansion 21 s x y t s 0 x t ε s 1 x y t ε 2 s 2 x y t where ε represents the magnitude of the disturbance as usually done in asymptotic expansions we underline that convergence problems for solutions when ε 0 will not be covered in this analysis following among others auriault et al 2010 on this subject the reader may wish to refer for instance to hornung 1996 this form of the perturbed solution is inserted back into eq 12 which is further linearized by ignoring quadratic and higher order terms in ε this leads to two problems one of the leading order o 1 and another perturbed problem of order o ε obtained assuming the dimensionless numbers appearing in eq 12 to be of order o 1 and separately collecting terms independent of ε and terms linearly dependent on it the leading order term obviously just involves the base solution s 0 x t s x c t and therefore coincides with eq 17 conversely the perturbed problem 22 ϕ s 1 t k 0 s 1 x δ r c a δ k 0 μ e 0 s 1 δ r c a ϕ d n l k 0 δ s 1 k 0 δ s 0 s 1 0 governs the evolution of a generic disturbance up to order o ε in the above and what follows functions sub scripted 0 are to be understood as evaluated with the base solution noting that the base solution s 0 x t is uniform along y direction and subsequently employing ξ x c t yields the o ε perturbed problem governing s 1 ξ y t in the tw coordinate 23 ϕ s 1 t ϕ c s 1 ξ k 0 s 1 ξ δ r c a s 1 d 2 d ξ 2 k 0 μ e 0 2 s 1 ξ d d ξ k 0 μ e 0 k 0 μ e 0 2 s 1 ξ 2 2 s 1 y 2 δ r c a ϕ d n l s 1 d d ξ k 0 d 3 s 0 d ξ 3 s 1 ξ k 0 d 3 s 0 d ξ 3 d k 0 d ξ 3 s 1 ξ 3 3 s 1 ξ y 2 k 0 4 s 1 ξ 4 2 4 s 1 ξ 2 y 2 4 s 1 y 4 0 now since any generic disturbance can be resolved into its fourier modes modal stability analysis amounts to knowing the growth in time of individual fourier modes composing the disturbance if any one of these modes is found to be growing in time the flow as a whole is to be understood as unstable since any physical disturbance would contain all of these modes following this approach a spatially periodic form is assumed for s 1 24 s 1 ξ y t e i k y σ t s ξ where k is characteristic wave number of the disturbance in y direction σ is the exponential growth factor in time and s ξ is the amplitude of the wave like disturbance allowing variation in direction of propagation ξ introducing eq 24 in eq 23 yields 25 a d 4 s d ξ 4 b d 3 s d ξ 3 c d 2 s d ξ 2 d d s d ξ e s σ s 0 a linear homogeneous ode with spatially varying coefficients identified as 26 a δ r c a d n l k 0 b δ r c a d n l d k 0 d ξ c 1 ϕ δ r c a k 0 μ e 0 2 ϕ d n l k 2 k 0 d 1 ϕ k 0 ϕ c 2 δ r c a d d ξ k 0 μ e 0 δ r c a ϕ d n l k 0 d 3 s 0 d ξ 3 k 2 d k 0 d ξ e 1 ϕ δ r c a d d ξ k 0 μ e 0 k 2 k 0 μ e 0 δ r c a ϕ d n l d d ξ k 0 d 3 s 0 d ξ 3 k 4 k 0 d k 0 d ξ these coefficients are dependent on the base solution s 0 its derivatives w r t ξ and the wave number of the disturbance k since the base solution satisfies boundary conditions s and s while approaching uniformly the boundaries ξ and ξ respectively s needs to vanish uniformly at those boundaries such that the o ε perturbed solution is admissible this results in the following boundary conditions that any s governed by eq 25 needs to satisfy 27 s ξ 0 d s d ξ ξ 0 s ξ 0 d s d ξ ξ 0 3 2 discretization and asymptotic growth decay in the current section for each base solution the pair s and σ are determined numerically varying the value of k we approximate using a second order accurate central difference scheme the derivatives in eq 25 and 27 the physical domain is the same as that is used to resolve the base solutions with l 0 100 m and corresponding dimensionless domain ξ 0 5 0 5 subsequently the discretized problem for s and σ can be posed as an eigen value problem 28 a σ i s 0 where a is a sparse matrix encompassing the coefficients at respective finite difference fd nodes and i is an identity matrix of the same size since for a non trivial s a σ i 0 the solution set for σ is given by the spectrum of a represented σ a following modal stability analysis if sup ℜ σ a 0 then the corresponding perturbation grows exponentially in time according to eq 24 whereas if sup ℜ σ a 0 then all the perturbations s decay exponentially with time in order to numerically approximate this critical eigen value σ s sup ℜ σ a for a given wave number k a krylov schur algorithm available in matlab stewart 2002 has been employed this relation between k and σ s k is plotted as a dispersion curve for each base solution s 0 fig 3 shows the dispersion relation for base solutions which represent imbibition for various values of s s 0 20 and λ ρ w g the wave number of the fastest growing perturbation k f is the one associated to the peak of the dispersion curve for a large value of s 0 96 representing large injection velocity according to eq 20 σ s k is found to be negative for all values k analyzed this indicates an exponential decay of the arbitrary perturbations applied to those base solutions and thus a stable imbibition front which is the associated plane wave as s is reduced the base solutions start to involve non monotonicities and the growth rate σ s k is found to be positive for a range of k this indicates that perturbations within those ranges can potentially grow in time triggering fingering type instabilities as s is reduced further s 0 36 the dispersion curves again indicate exponential stability of the base solutions this is in qualitative agreement with the experimental observations by shiozawa and fujimaki 2004 dicarlo 2004 and the related hypothesis that overshoot profiles of saturation result in an unstable wetting front in gravity driven infiltration nieber et al 2000 eliassi and glass 2001 egorov et al 2003 dicarlo 2013 also indicated in fig 3 is the path followed by the wave number of the fastest growing perturbation k f as s is reduced the interpretation of this path is made clear in fig 4 with the understanding that the wave length associated to the fastest growing perturbation λ k f 2 π k f is representative of the spacing between the early time fingers and the intensity of the non monotonicity is reflected by s m a x s where s m a x is the peak value of the saturation degree attained by the imbibition front for intermediate range of injection velocities the intensity of overshoot in the base solutions is larger and the corresponding finger spacing is smaller whereas the growth rate is larger as the injection velocity either increases moving towards fully saturated conditions or decreases lower than the intermediate range the intensity of overshoot reduces the corresponding finger spacing increases and the growth rate decreases indicating a transition to the stable regime this strongly indicates a correlation between the injection flux and the characteristics of the associated fingering instabilities as observed in experiments glass et al 1989b yao and hendrickx 1996 a similar observation has been done in cueto felgueroso and juanes 2009a also it is interesting to compare the structure of the perturbation with maximum growth rate for a given wave number fig 5 shows this normalized eigen function s determined by solving eq 28 with k 140 and the associated base solutions s 0 superposed for all values of s the eigen function reaches a maximum within the diffused interface between s and s of the base solution however there exists a relative difference in the peak values and the spread along ξ of these peaks among these eigen functions as s reduces the peak value reduces and the spread along ξ increases this indicates a shift towards weaker and more spread out perturbations it can be inferred from this observation that for base solutions that consist a stronger non monotonicity lower s a relatively weaker perturbation is sufficient to render the flow unstable and vice versa fig 6 shows the dispersion relation for base solutions representing imbibition for various values of s s 0 85 and λ ρ w g and the path followed by the wave number of the fastest growing perturbation k f as s is increased for high values of s the base solution seems to be stable the intermediate range of s shows unstable behavior and as s is reduced further the tendency seems to be towards stable behavior however it is to be noted that the lowest value of s in this work is restricted by the residual saturation degree s r r e s 0 1567 this behavior is also plotted in fig 7 showing the relation between the qualitative indicator of finger spacing λ k k f and s a qualitatively similar observation was made in point source infiltration experiments by bauters et al 2000 where water was injected into initially moist sand packs albeit within a lower range of initial water content it was observed that the ensuing finger sizes decreased slightly with increasing initial water content starting from a completely dry condition and after a certain value the finger sizes increased exponentially for k 140 the normalized eigen function s is more spread out along ξ and has a lower maximum value of the peak when s is increased see fig 8 this indicates that for larger s while a weaker and more diffused perturbation can invoke instability in the flow it grows relatively slower in accordance with fig 6 fig 9 shows the dispersion relation for base solutions in fig 1 c that represent imbibition for varying values of λ 0 5 ρ w g ρ w g 1 5 ρ w g and with fixed boundary conditions s 0 20 and s 0 85 for the range of λ studied it is clear that base solutions with a relatively narrower spread along ξ larger λ when leaving the equilibrium state s 0 0 have a wider range of k for which the perturbations are unstable and also larger values of k f and associated peaks corresponding to a relatively faster growing perturbations fig 10 shows the normalized eigen functions s for k 140 along with the corresponding base solutions it can be inferred that for larger values of λ accordingly larger c a the eigen function has a peak value which is higher and relative spread along ξ which is narrower representing a stronger perturbation that is needed to generate an unstable flow and according to the dispersion relation fig 9 this perturbation would grow relatively faster to summarize the case of imbibition linear stability analysis of the infiltrating front provides results consistent with experimental evidence moreover it tells us that for a given imposed pressure gradient stronger the perturbation needed to destabilize the front faster would be its growth and consequently faster would be the destabilized finger and this condition is achieved when the non monotonicity of the base solution is less pronounced for the drainage case fig 11 shows the dispersion relation for base solutions in fig 2 with varying λ as mentioned earlier the drainage base solutions represent two qualitatively different type of tw solutions those solutions representative of non classical under compressive shocks which were observed in the higher range of λ are found to be stable towards transverse perturbations whereas the solutions representative of non classical expansion shocks at the lower range of λ are found to be unstable within a particular range of wave numbers k in spite of those base solutions being monotonic among the latter for the range of λ studied as λ is increased the range of unstable wave numbers increased along with the wave number of the fastest growing perturbation k f from fig 12 for k 150 it can be observed that for higher values of λ the eigen function has a lower peak and a wider spread along ξ representing a weaker perturbation that renders the flow unstable it can be noted that this tendency is contrary to what was observed in the imbibition case while the subsequent growth of an initial disturbance is governed by non linearities inherent to the model in the context of linearized analysis it can be expected that the wave number of the ensuing fingering instability at late times would be close to that of the fastest growing perturbation k f also the upper bound of the range of unstable wave numbers serves as a critical wave number beyond which any perturbations decay in this sense linear stability analysis serves as tool to identify the minimum size of the transverse dimension of a porous medium domain in order to be able to invoke and observe fingering phenomenon taking cue from the above results two dimensional pde simulations in section 5 were initialized within appropriately sized domains and with an imposed transverse perturbation superposing a few random wave numbers in the neighborhood of k f in order to accelerate the onset of instabilities 4 stability against longitudinal perturbations as can be observed from the structure of the base solutions of the tw problem there exist regions of uniform saturation degree ahead and behind the front the solution within these regions is subject to instability in the presence of longitudinal perturbations such as the oscillatory non monotonicities observed in base solutions in the vicinity of the front see fig 1 such instability triggers the formation of banks of fluid perpendicular to the direction of motion of the front which further destabilize transversely to form bubbles behind the front also when a front destabilizes due to transverse perturbations as analyzed in section 3 their ensuing growth forms fingers see section 5 along the length of those fingers there is also a region behind their tips within which the saturation degree is uniform the solution within this region can as well destabilize due to longitudinal perturbations resulting in breakup of those fingers into droplets this is akin to the now well studied plateau rayleigh instability that explains jets of liquid destabilizing and forming coalesced droplets eggers and villermaux 2008 in order to analyze the onset of such instabilities in the current context we consider a longitudinally perturbed solution s x t of eq 14 in the vicinity of a constant and uniform base solution s 0 and expand it in a regular series 29 s x t s 0 ε s 1 x t ε 2 s 2 x t about the base solution with ε now being the magnitude of longitudinal perturbation we follow again the approach employed in section 3 1 by introducing such perturbed solution into eq 12 and assuming that the perturbation is small compared to the base solution this leads to an o ε perturbed equation 30 ϕ s 1 t k 0 s 1 x δ r c a k 0 μ e 0 2 s 1 x δ r c a ϕ d n l k 0 4 s 1 x 4 0 that governs s 1 x t here as well functions sub scripted 0 are to be understood as evaluated with the base solution in order to analyze if a longitudinally harmonic perturbation would grow decay asymptotically in time the following form is assumed for the o ε perturbation 31 s 1 x t e i k x σ t where k is characteristic wave number of the disturbance in x direction and σ is its exponential growth factor in time introducing eq 31 into eq 30 results in an expression for the growth factor in terms of the base solution and the wave number 32 σ s 0 k 1 ϕ δ r c a k 0 μ e 0 k 2 ϕ d n l k 4 i k k 0 similar to what was noted in the section 3 for transverse perturbations any longitudinal perturbation resulting in ℜ σ 0 is to be understood as growing exponentially in time leading to instability about the uniform base solution fig 13 shows the graph of the relation eq 32 in the space of s 0 k ℜ σ for certain values of s 0 there exist a range of wave numbers k for which ℜ σ 0 this region of instability shaded gray in fig 13 b is given by the relation 33 μ e 0 ϕ d n l k 2 between the slope of the effective chemical potential evaluated at s 0 and the square of the wave number fig 13 c shows the dispersion relations in the space of k ℜ σ for uniform saturation values s 0 observed as left boundary conditions s in the base solutions corresponding to imbibition in fig 1 for s 0 0 70 0 75 there is a range of k for which ℜ σ 0 while the respective base solutions for both these cases exhibit oscillations when leaving the uniform equilibrium state s 0 0 it will be shown further using two dimensional simulations in section 5 that only the oscillations in the case s 0 70 are within the range of k that trigger the instabilities behind the front 5 two dimensional simulations in this section we use numerical simulations as a means to examine the non linear growth of perturbations to a base solution in a two dimensional spatial setting to do this the two dimensional domain is initiated with a field of s r x y involving a smooth jump along the x direction and extending homogeneously in the y direction that represents a transition from one fluid phase to another to this field perturbations dependent on y direction are superposed that are sinusoidal in nature involving a few randomized wave lengths this perturbed initial condition is representative of physically realistic conditions where the air water interface in a porous medium is not independent of y direction owing to intrinsic heterogeneities however it is to be noted that these imposed perturbations are only spatial in nature and does not involve perturbations in the value of s r itself 5 1 numerical method and discretization we choose as the primary unknowns the saturation degree s r and the regularized effective chemical potential with known spatially linear pressure contribution μ then the coupled system of equations formed by eqs 12 and 13 is resolved we acknowledge at this point that since our focus is to analyze the general structure of the solutions and to verify the linear stability analysis we have adopted a simple numerical discretization if one intends to resolve the interface with higher accuracy and lower computational cost then the implementation can be extended to more sophisticated techniques of the likes of adaptive refinement martin et al 2005 boyer et al 2009 spatial discretization is done employing a standard galerkin formulation and linear lagrange finite elements time discretization is done using the implicit euler scheme of first order the discrete solutions at n th time step s r n μ n are obtained by searching in a suitable subspace of h 1 ω a hilbert space of admissible functions defined over the discretized domain ω for those functions that solve the non linear coupled variational system 34 ω q ϕ s r n s r n 1 δ t d ω ω δ r c a k s r n q μ n d ω ω n μ q δ r c a k s r n μ n n d ω n μ 0 ω s μ n μ e s r n c a δ r x d ω ω ϕ d n l s s r n d ω ω n s s ϕ d n l s r n n d ω n s 0 for any test functions s and q belonging to h 1 ω and vanishing on the part of the boundary where respectively s r and μ are specified n is the outward unit normal vector to the boundary where it is referred to ω n μ is that part of the boundary where normal derivative of μ is specified which translates to imposing at that part of the boundary an injection or extraction velocity of the fluid with a natural form 35 v f ω n s δ r c a k s r μ ω n s is that part of the boundary where normal derivative of s r is specified the material properties and model parameters used in the current study can be found in table 1 of part i which are in the range typical of silica sands saturated with air water mixture mesh convergence behavior has been tested once chosen initial and boundary conditions corresponding to an imbibition problem and a drainage problem which are elaborated in sections 5 2 and 5 3 to validate the numerical solution in particular successively refined discretization steps have been considered the results of this analysis are reported in appendix 5 2 imbibition fronts the computational domain used for imbibition simulations is a rectangle such that x 0 1 and y 0 0 3 whose physical dimensions correspond to a length of l 20 m and a height of h 6 m displacement of air by water representing imbibition can be understood as a solution which transitions from a higher degree of saturation to a lower one and moves in the direction of the lower saturation in order to realize this the domain is initialized with a solution s r t 0 involving a smooth jump along the x direction between the saturation degree representing the infiltrating water s and that of an initial saturation degree of an almost dry domain s r 0 such that s s r 0 at t 0 the region of the domain initialized with s is restricted to a thin layer at the infiltrating surface x 0 y that is perturbed transversely in the y direction with a few randomized wave lengths within the vicinity of the fastest growing wavelength λ k k f given by the linear stability analysis with boundary conditions s s s s r 0 the initial condition for μ is such that μ t 0 μ p f s r t 0 p for all t 0 the normal derivative of s r is set to vanish at all the boundary surfaces at the left boundary surface x 0 y an injection velocity 36 v f x 0 y δ r c a k s p is imposed this has an effect of inducing imbibition with an uniform saturation degree of s while the normal derivative of μ p f vanishes the boundary at the right x 1 y is drained with a dirichlet boundary condition on μ such that 37 μ x 1 y μ e s r 0 p x 1 y the top x y 0 3 and the bottom x y 0 boundaries are impermeable see schematic fig 14 for a summary of these boundary conditions fig 15 shows such a perturbed initial condition for the case of s 0 75 s r 0 0 20 and its evolution for t 0 under the above boundary conditions and λ ρ w g the perturbations grow in time forming fingers within the domain that are similar to observations in infiltration experiments into initially dry sand glass et al 1989b selker et al 1992 this model indicates that these ensuing fingers are more saturated than the region behind also the advancing tips of the fingers are of higher saturation than the region within the finger itself these observations are inline with the experimental saturation profiles of fingers detected using light transmission by glass et al 1989a the saturation profile within the space between the fingers see fig 15 b is significantly different from that within the finger itself and is also closer to that of the one dimensional base solution these intricate comparisons of the saturation profiles are yet to be realized using meticulously designed experiments the solution of μ p f along with its constituent local and non local components is shown in fig 16 at t s t e p 6000 along with a comparative plot within the vicinity of the tip of the central finger it is clear that while the effective chemical potential μ e is non monotonic owing to the non convex local fluid energy the non local chemical potential μ n l compensates by following the convexity of s r in accordance with eq 6 along the sides of the fingers the fringe region the solution indicates regions of higher μ e this is a consequence of higher saturation degree within this fringe region compared to that of the initially dry region s r 0 see fig 15 a this fringe region as well coincides with the passage of the distinctive swell of the finger tip at an earlier time step the linear stability analysis in section 3 indicates that as the injection velocity v f is increased from the intermediate range the spacing between the fingers increases and their growth rate decreases effectively suppressing the fingering phenomenon this is verified in the two dimensional problem see fig 17 where as s in eq 36 is varied within the range 0 70 0 96 the same trend is observed for the largest injection velocity s 0 96 the initial perturbations are completely suppressed and the imbibition front infiltrates the domain homogeneously for s 0 70 the region behind the infiltrating front which is expected to have an uniform saturation degree of 0 70 is perturbed longitudinally due to the oscillations as seen in the one dimensional solution see fig 1 these oscillations are longitudinal in nature as elaborated in section 4 and grow in time while interacting non linearly with the infiltrating front the result of this kind of instability and the non linear interactions is the formation of bubble like trapped regions of lower saturation see last row of fig 17 5 3 drainage fronts the computational domain used for drainage simulations is a rectangle such that x 0 1 and y 0 0 15 whose physical dimensions correspond to a length of l 20 m and a height of h 3 m drainage of water by air is understood as the contrary of imbibition which is a transition from lower saturation degree to higher moving in the direction of the higher saturation so the initial condition s r t 0 is chosen similar to that of imbibition with a smooth jump along the x direction in the saturation degree from s to s r 0 such that s s r 0 the initially saturated region of the domain is assumed to be close to full saturation s r 0 0 99 the region that is relatively dry s r x y s is restricted to a thin layer at the left boundary x 0 y similar to imbibition this initial condition is perturbed with randomly chosen wave lengths within the vicinity of the fastest growing wave length indicated by the linear stability analysis the initial condition for μ is such that μ t 0 μ p f s r t 0 p owing to the phase field parameter s r of the current model being representative of the saturation degree of the wetting fluid an injection flux of the form eq 35 at the boundary would not be appropriate to induce drainage instead the imposed linear pressure p is allowed to drive the drainage front across the domain by choosing appropriate boundary conditions see schematic fig 18 for all t 0 at the left boundary surface x 0 y dirichlet boundary conditions are setup with s r x 0 y s and 38 μ x 0 y μ e s p x 0 y the boundary at the right x 1 y is drained with a dirichlet boundary condition on μ eq 37 and the normal derivative of s r is set to vanish similar to the imbibition case these set of boundary conditions have an effect of inducing extraction of water at the right boundary that is consistent with the imposed pressure gradient while the normal derivative of μ p f vanishes the top x y 0 15 and the bottom x y 0 boundaries are impermeable and the normal derivative of s r is as well set to vanish fig 19 shows the evolution of s r x y for t 0 of a perturbed initial condition for the case of s 0 20 under the above boundary conditions and for λ 1 5 ρ w g the solution along the length of the domain is consistent with one dimensional pde solutions in part i with a self similar traveling wave part connecting a lower saturation degree s b to a higher s a which represents a non classical expansion shock and this is connected on either side up to the boundary by expanding parts of the solution however the traveling wave part of the solution along the length of the finger has a different lower value compared to that of within the gap between the fingers see fig 19 b t s t e p 250 the latter being consistent with the one dimensional base solution for the imposed boundary conditions in the current problem see fig 2 in fact a one dimensional traveling wave connecting s b to s a that correspond to the solution along the length of the finger would have a higher speed approximated by eq 16 compared to that of within the gap between the fingers which explains the higher speed of the advancing tip of the finger compared to its base as the solution evolves formation and detachment of droplet like structures occurs between the fingers this is due to the growth of longitudinal perturbations to the part of the solution s r x y 0 0775 s b 0 45 between the diffused interface and the expanding region on the left as noted in part i the origin of longitudinal oscillations in this region is related to the nature of the equilibrium state associated to s b of the dynamical system formed by the ode 19 these oscillations tend to grow because s b 0 45 is clearly within the unstable region of uniform base solutions dictated by eq 33 see section 4 this is not true for the solution along the length of the finger because the corresponding s b 0 35 similar to the imbibition case the effective chemical potential μ e is non monotonic and the non local chemical potential μ n l follows the convexity of s r taking positive values just behind the diffused interface see fig 20 in order to verify the prediction of the linear stability analysis done in section 3 we present here the evolution of the solution s r for different values of the gradient of imposed pressure distribution λ inline with the prediction as λ is decreased from 1 5 ρ w g the finger spacing is reduced resulting in thicker fingers and these thicker fingers grow slower see fig 21 however if λ is increased drastically the arbitrary initial perturbations to the diffused drainage front decay in time see fig 22 it is to be noted that for λ 150 ρ w g the diffused front connects between s r 0 8 and the initial saturation degree of s r 0 99 see fig 2 which is indicative of non classical under compressive shock the decay of initial perturbation is revealed by the reduction as the solution evolves of the spatial gap at the diffused interface due to the imposed perturbation at t s t e p 0 the expanding rarefaction part of the solution behind the diffused front does not seem to follow the same rate of decay resulting in persistence of the initial disturbance at the left end of this part of the solution 6 conclusions in this part ii of the study we have presented a systematic linear stability analysis of the solutions of the phase field model introduced in part i by studying the growth decay of imposed initial perturbations the solutions analyzed were both of imbibition and drainage transverse stability analysis of the imbibition solutions has indicated that they are sensitive to imposed infiltration flux as observed in the experiments there seems to be an intermediate range of infiltration fluxes within which appropriately sized perturbations would grow in time forming fluid fingers as the flux was either decreased or increased the fingers tended to become thicker and eventually stabilized below or above certain flux values this behavior of the imbibition solutions seems to be related to the overshoot type non monotonicity as hypothesized in earlier studies one dimensional analysis of the current model done in part i has indicated that this overshoot exists only for certain boundary conditions suggesting that the ensuing instability might be a consequence of the overshoot rather than the cause we have also studied the effect of initial saturation degree of the domain being infiltrated and that of imposed pressure gradient across the domain as observed in experiments increasing initial water content tended to stabilize the infiltration front increasing the imposed pressure gradient within the range studied rendered the infiltration front more susceptible to destabilization on the other hand for the drainage front a larger range of imposed pressure gradient was studied and the drainage front seemed to stabilize at very high pressure gradients an analytical result was also presented for the stability of one dimensional uniform base solutions against longitudinal perturbations in the direction of propagation of the front this result indicated on the possibility of destabilization of the solutions within a particular range of uniform values of the base solutions which could result in the formation of trapped regions of dissimilar saturation in higher dimensions this was shown to be a consequence of the negative slope of the chemical potential in a certain range of saturation degrees which in turn has its origins in the double well structure of the bulk fluid energy employed in this model two dimensional numerical results were as well presented which were based on a finite element implementation these results verify those of the linear stability analysis with respect to finger sizes observed and stabilization of the front when expected the rich structure of the solutions is attributed to the various energy contributions that encompass the non uniform fluid potential while the results were inline with the existing experimental observations the model predicts additional features that maybe observed during air water displacements detailed experiments are warranted both in imbibition and drainage in order to investigate these predictions it is to be noted that our current study only concerns air water displacements within non deformable porous network most natural extension would be to model the porous network as deformable with possible mechanical failure which could be understood either as localization of solid strain or as localized degradation resulting in re modeling of the pore structure this will be the focus of our further research resulting coupling between the solid and fluid flow localizations is also of interest credit authorship contribution statement siddhartha h ommi conceptualization methodology formal analysis data curation writing original draft giulio sciarra conceptualization reviewing supervision panagiotis kotronis conceptualization reviewing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors acknowledge the support of the french national research agency anr for the project stoweng project anr 18 ce05 0033 appendix convergence properties of the two dimensional solutions in order to validate the robustness of the numerical scheme adopted to solve the two dimensional problems presented in sections 5 2 and 5 3 a mesh convergence analysis has been conducted for two test cases relative to an imbibition and a drainage problem as expected reducing the element size implies a decrease of the 2 norm of the difference between solutions both for the saturation degree and the generalized chemical potential computed with successive mesh refinements see fig a 23 data relative to the test cases are reported in the caption of the figure in both cases the number of fingers that emerge and their relative spatial evolution are not affected due to mesh refinement 
149,flows involving immiscible displacement of one fluid by another in a porous media are known to destabilize and form fluid fingering when the non wetting fluid is a highly mobile gas air and the wetting fluid is an in compressible liquid water the classical macroscopic theory is unable to describe the fingered flow in part i of this study we have introduced a model that interprets the mixture of wetting and non wetting fluids within the pore space as a single saturating non uniform pore fluid characterized by a phase field parameter which is considered to be the saturation degree of the wetting fluid in the current study we present a linear stability analysis of its solutions which describe both imbibition and drainage the analysis sheds light on the sensitivity of the flow stability on injection flux imposed pressure gradient and initial saturation degree two dimensional numerical simulation results are as well presented which verify the stability analysis and reveal the rich structure of the fluid fingering realized by this model while these results are found to be in qualitative agreement with experimental observations they also warrant further experimentation to explore the additional features predicted by the model keywords partial saturation phase field modeling stability analysis 1 introduction the classical problem of stability of an interface formed between two immiscible fluids is known to be further complicated by the presence of a confining solid substrate which is a typical scenario in a two phase flow within a porous medium the transition region between the zones saturated by two different fluids within porous media can be described as a mixing region where both fluids partially saturate the pore spaces this mixing region can be viewed and modeled as a diffused interface bridging the two fully saturated zones destabilization of such a diffused interface and eventual fingering formations have a fractal structure rather than smooth formations as in the case of two phase hele shaw flow saffman and taylor 1958 this is in most part due to an intrinsic property of porous media which is the existence of several length scales homsy 1987 nevertheless being able to model such fingering phenomena has its uses in a myriad of applications ranging from soild hydrology glass et al 1988 jarvis 2007 clothier et al 2008 to carbon dioxide co 2 sequestration lackner 2003 torp and gale 2004 orr 2004 ajayi et al 2019 numerous experimental campaigns have been carried out to characterize such flow both in the case of imbibition where the wetting fluid displaces the non wetting fluid and vice versa in the case of drainage while foundations for a systematic characterization of flow instabilities in porous media were laid in the 80 s with the seminal work of lenormand and his colleagues lenormand 1985 lenormand et al 1988 lenormand 1990 subsequent works have shed light on these phenomena in the presence of gravity both in imbibition glass et al 1989b selker et al 1992 yao and hendrickx 1996 bauters et al 2000 shiozawa and fujimaki 2004 and drainage birovljev et al 1991 auradou et al 1999 méheust et al 2002 løvoll et al 2005 among others however continuum scale modeling efforts were largely focused for the case of imbibition especially in the soil hydrology community in this context widely accepted richards equation richards 1931 was known to suffer from its inability to model fingering instabilities due to its unconditional stability against transverse perturbations egorov et al 2003 nieber et al 2005 it has been hypothesized based on experimental evidence bauters et al 2000 shiozawa and fujimaki 2004 dicarlo 2004 dicarlo et al 2010 and related numerical studies nieber et al 2000 eliassi and glass 2001 that fingering type instabilities during infiltration into initially dry soils is associated with an overshoot type non monotonic profile of the water content along the length of the finger and that this overshoot is the cause rather than the consequence of the instability subsequently various model extensions of the richards equation eliassi and glass 2002 2003 dicarlo et al 2008 cueto felgueroso and juanes 2009a to name a few aimed to an extent to reproduce such non monotonic saturation profiles and consequently the fingering type instabilities if a model succeeds in replicating fingering or not is revealed in part through a stability analysis of its solutions against transverse perturbations such analyses were performed for some of these models egorov et al 2002 2003 nieber et al 2005 cueto felgueroso and juanes 2009b revealing their conditionally stable nature in the above mentioned works non monotonic solution profiles were achieved either by a priori choice of non monotonic retention relations or by the use of fourth order in space extensions of the richards equation while in the current work we incorporate both these features a thermodynamically sound basis for this choice as explained in part i is justified through the connection to the cahn hilliard fluid modeling in part i we have introduced the proposed phase field approach based on the framework established in sciarra 2016 that views the presence of two fluids as a single non uniform fluid saturating the pore space this is done by a prescription of double well type bulk fluid energy in the spirit of cahn and hilliard 1958 1959 in combination with a classical capillary energy accounting for the retention effect due to the confinement provided by the pore walls in this context it has been shown that a proposed non convexity of the flux function enables describing both imbibition and drainage solutions in the presence of higher order diffusion which to the authors knowledge has been realized for the first time employing an extended richards equation non monotonicities observed in the solutions have as well been justified with a combination of matched asymptotic analysis and dynamical systems analysis the current work is intended as an extension to the part i presenting a linear stability analysis of the model and revealing its conditionally stable nature the essence of linear stability analysis performed is to understand if a small enough initial perturbation to the base solution grows or decays asymptotically in time by employing the principles of lyapunov stability analysis we complement this analysis with two dimensional model simulations which in part verify the results of the linear stability analysis and also reveal the non linear growth in time of the fingers as well in this model a non monotonicity in the infiltration solutions is accompanied by an ensuing growth of transverse instabilities associated to fingering the effects of varying initial water content and magnitude of imposed pressure gradient have been analyzed in the case of drainage the effect of increasing gravitational component equivalent imposed pressure gradient has been revealed to stabilize the invading front as was observed experimentally méheust et al 2002 further a stability analysis against longitudinal perturbations revealed instability of certain solutions resulting in bubble or droplet like trapped regions behind the invading front which are the consequences of a coarsening process associated to a kind of metastable behavior as described for instance in bates and fife 1990 alikakos et al 1991 this is associated to the non monotonic structure of the fluid bulk energy this work is organized as follows in section 2 a recall is done to the essential aspects related to the construction of the proposed model and excerpts of the one dimensional results from part i are presented briefly section 3 and section 4 are dedicated to detailed linear stability analysis against transverse and longitudinal perturbations respectively results of two dimensional finite element simulations are presented in section 5 that reveal the non linear evolution of the both imbibition and drainage solutions the physical dimensions of quantities within this work are mentioned whenever relevant alongside their corresponding symbols and within square brackets m l t 2 summary of the model in part i of the current study a phase field approach has been introduced to model fluid fluid displacements within porous media based on the thermodynamic framework constructed in sciarra 2016 in essence this model is an extension to the classical richards equation richards 1931 viewing the presence of two different fluids within a pore network as a single non uniform pore fluid further indexed p f saturating the pore space 2 1 the non uniform pore fluid as usual in cahn hilliard type modeling approach an order phase field parameter s r is furnished to distinguish the two phases and the saturation degree of the wetting fluid is assumed to play this role local and non local contributions are postulated to constitute the free energy of the non uniform fluid saturating the porous medium e as was assumed in the part i the solid skeleton is considered to be non deformable in the current analysis the local contribution is assumed to account for the presence of both the fluid fluid and solid fluid interfaces adopting the same notation as in part i the overall free energy density of the non uniform pore fluid per unit reference volume of porous medium is written as 1 ψ p f ϕ ψ l s r ϕ u s r ψ n l ϕ s r where ϕ is the lagrangian porosity of the porous skeleton inline with the above description the local bulk contribution to the free energy density ψ l s r that is responsible for phase segregation and allows for coexistence of the immiscible phases sciarra 2016 has the functional form 2 ψ l s r c γ r s r 2 1 s r 2 where γ mt 2 is the surface tension between the two fluids that compose the non uniform fluid r l is the characteristic radius of channels intrinsic to the porous skeleton which according to leverett 1941 scales with ϰ ϕ 0 here ϰ l2 is the intrinsic permeability of the porous skeleton and ϕ 0 its initial porosity c is a dimensionless parameter signifying the intensity of local contribution to the overall energy the capillary energy density typically is an empirical relation fit to experimental data and in this work we adopt the widely used van genutchen form van genuchten 1980 3 u s r s r 1 p c s d s 4 p c s r u s r π 0 s r s r r e s 1 s r r e s 1 m 1 1 m where p c ml 1t 2 is the classical capillary pressure and π 0 ml 1t 2 is a reference pressure which scales as ρ w g ℓ c ℓ c l is the porous media counterpart of capillary length scale that relates intensity of capillary forces in the porous medium to that of gravity and m is a model parameter s r r e s is the residual saturation degree of the wetting fluid the non local energy density is assumed to be quadratic in the gradient of the fluid content and thus has the form 5 ψ n l ϕ s r c k 2 ϕ s r ϕ s r where c k mlt 2 is a coefficient that determines the spatial influence of this non local energy c k can be reinterpreted as π k ℓ 2 such that a characteristic interface thickness ℓ l is introduced into the equations and a free parameter π k ml 1t 2 appears assuming a rigid porous skeleton ϕ ϕ 0 c o n s t as done further the variational derivative w r t s r of overall free energy of the porous medium gives the chemical potential of the non uniform pore fluid 6 μ p f ψ l s r u s r μ e s r ψ n l ϕ s r μ n l where the first two terms in the expression on the right hand side can be identified as originating from the local contribution and so labeled as effective chemical potential μ e s r μ l s r p c s r identification of μ p f starting from the constitutive prescription of the non uniform fluid and porous solid is detailed in part i 2 2 phase field governing equation conservation of fluid mass within a porous medium fully saturated by the non uniform pore fluid is written as 7 m f t m 0 in its local form where m f ρ f ϕ is the non uniform fluid content per unit volume of porous medium and m is the lagrangian fluid mass flow vector relative to the skeleton for an s r 0 1 a simple linear interpolation can be assumed for the apparent density ρ f of the non uniform fluid kim 2012 starting from the individual densities of pure phases ρ w ρ n w invoking the typical assumptions in soil hydrology hilfer and steinle 2014 the non uniform fluid is assumed to be composed of in compressible water ρ w c o n s t and highly rarefied air the latter being continuously connected to the atmosphere this leads to pressure of air phase being equivalent to reference atmospheric pressure assumed 0 for convenience concurrently invoking an ideal gas law for air implies that its density ρ n w is negligible compared to that of water ρ w ρ n w 0 leading to the following simplification 8 ρ f ρ w s r ρ n w 1 s r ρ w s r further the classical approach to porous media flow that employs the two phase darcy s model is generalized to the flow of the non uniform pore fluid 9 m ρ w ϰ η w k s r μ p f p ρ w ϰ η w k s r μ relating the lagrangian fluid mass flow m ml 2t 1 to the spatial gradient of an augmented chemical potential μ the latter is a sum of the chemical potential of the non uniform pore fluid μ p f and of an imposed linear pressure distribution p λ x where λ ml 2t 2 is a scalar this augmented chemical potential accounts for a more general case incorporating both the effect of an initial background mean flow and that of gravity forces in the case when only gravity forces are considered the pressure distribution p is just proportional to λ ρ w g in the above generalized darcy s flow relation a phenomenological flux function k s r is introduced as a proportionality function and η w ml 1t 1 is the dynamic viscosity of the wetting fluid the specific thermodynamic restrictions on k s r can be found in part i eq 9 in combination with the conservation law for the fluid mass eq 7 and the simplification eq 8 gives a cahn hilliard like local governing equation for the phase field parameter s r in the bulk of the domain 10 ϕ s r t ϰ λ η w k s r x ϰ η w k s r μ p f 0 assuming a rigid porous skeleton ϕ ϕ 0 c o n s t the quantity ϰ λ η w lt 1 can be identified as the magnitude of a saturated mean velocity v m in the porous medium that is equivalent to the saturated hydraulic conductivity when the flow is driven by gravity this multidimensional partial differential equation pde eq 10 encompasses the various features of the non uniform pore fluid and of its flow within a rigid pore network as described earlier in the part i a particular dimensionless grouping of parameters has been proposed by introducing characteristic scaling numbers for length x h l time t h x h v m x h η w ϰ λ and pressure chemical potential p h c γ r l is a characteristic length of the physical domain of the problem under consideration subsequently the following dimensionless numbers were introduced 11 c a v m η w r 2 ϰ c γ δ r r x h d u π 0 r c γ d n l c k r c γ x h 2 π k r c γ ℓ x h 2 whose values depend on those of the material parameters see table 1 2 in part i employing these choices results in the dimensionless counterpart of eq 10 12 ϕ s r t k s r x δ r c a k s r μ e s r δ r c a ϕ d n l k s r δ s r 0 where δ s r denotes the laplacian of s r it is to be noted that now time and spatial descriptions are to be understood as their dimensionless counterparts also with an abuse of notation μ e μ and its different contributions μ l p c μ n l now represent their dimensionless counterparts accordingly the dimensionless augmented chemical potential in eq 9 has the form 13 μ 2 s r 1 3 s r 2 s r 2 μ l s r d u s r s r r e s 1 s r r e s 1 m 1 1 m p c s r d n l ϕ s r μ n l δ s r c a δ r x p from this point all the variables are dimensionless unless either mentioned otherwise or referred to from earlier sections 2 3 one dimensional traveling wave solutions in part i a one dimensional analysis of this phase field model has been done and solutions s r x t of the one dimensional pde 14 ϕ s r t k s r x δ r c a x k s r μ e s r s r x δ r c a ϕ d n l x k s r 3 s r x 3 0 have informed on the presence of similarity profiles of traveling wave tw type with a diffused interface with uniform saturation degrees s s on either side of such interface in the above is introduced as the derivative with respect to the phase field parameter s r these self similar solutions are understood as representative of air water displacements within a non deformable porous network owing to its equivalence to the relative permeability function in classical partial saturation coussy 2004 the flux function k s r is assigned an empirical form widely used van genuchten 1980 luckner et al 1989 15 k s r s r 1 1 s r a b c where a b and c are real constants obtained through experimental fitting it has been numerically shown in part i that diffused interface solutions of eq 14 which represent both imbibition and drainage solutions are possible owing to the proposed non convexity of the flux function k s r these tw type solutions with a translating diffused interface are understood as smeared shock solutions of the riemann problem governed by eq 14 with boundary conditions prescribed by the uniform saturation degrees on either side of the diffused interface s and s the speed of translation of these solutions can be approximated by that of representative sharp shock solutions using the rankine hugoniot jump condition 16 k s k s c ϕ s s subsequently a transformation of eq 14 can be done into the tw coordinate ξ x c t and self similar solutions s ξ of the ordinary differential equation ode 17 ϕ c d s d ξ d k s d ξ δ r c a d d ξ k s μ e s d s d ξ δ r c a ϕ d n l d d ξ k s d 3 s d ξ 3 0 on an infinite domain can be sought after with appropriate boundary conditions at ξ 18 s ξ s d s d ξ ξ 0 s ξ s d s d ξ ξ 0 integrating eq 17 once w r t ξ using the boundary conditions at ξ and assuming higher derivatives of the solution vanish as ξ yields in a canonical form 19 d 3 s d ξ 3 c a δ r ϕ d n l k s ϕ c s s k s k s δ r c a k s μ e s d s d ξ in part i tw solutions satisfying eq 18 and 19 that represent both imbibition and drainage have been resolved numerically over a domain of finite length l 0 100 m that is sufficiently large in comparison to both the length scale of the air water interface ℓ 0 2 m and that of the second order diffusion such that we get a satisfactory approximation of an unbounded domain in the case of imbibition solutions of the pde eq 14 have informed that their self similar region extends from the left boundary condition s to the right boundary condition s consequently tw solutions of 19 were resolved for various values of s and s in eq 18 for s s using a second order accurate central difference scheme to approximate the derivatives involved fig 1 shows these solutions for varying values of s s and λ as such in the physical problem s is related to the dimensionless injection velocity v f by the relation 20 v f δ r c a k s p k s e x where e x is an unit vector in the positive x direction note that p is now the dimensionless counterpart of the linear pressure distribution introduced earlier so the left boundary condition s used to resolve the tw solutions can be related to the magnitude of dimensionless injection velocity k s in the physical problem and from fig 1 a non monotonicities can be observed only for a certain intermediate range of injection velocities this observation is found to be qualitatively inline with quasi one dimensional infiltration experiments dicarlo 2004 into initially dry porous media these non monotonicities in the solutions encompass oscillations and overshoot undershoot all the imbibition solutions were understood as representative of classical compressive in the sense of shock solutions of the hyperbolic limit of eq 14 these imbibition solutions for varying initial saturation degree of the domain and imposed pressure gradient are shown in fig 1 b and fig 1 c respectively drainage solutions of the pde eq 14 on the other hand revealed that for a given set of boundary conditions s s only part of the solution is a self similar diffused interface representing a tw solution and in addition to this the solution is composed of expanding regions fig 2 shows these tw solutions resolved for various values of λ two qualitatively different type solutions have been observed for lower range of λ the diffused interfaces were representative of non classical expansion shock solutions of the hyperbolic limit of eq 14 whereas for higher range of λ the diffused interfaces were representative of non classical under compressive shocks 3 stability against transverse perturbations saffman and taylor 1958 have studied the stability of an horizontal sharp interface separating two viscous fluids within a hele shaw cell driven by an imposed pressure gradient and under the influence of gravity it has been shown that wave like disturbances of arbitrary wavelengths can grow in time and eventually destabilize the interface if the motion of the interface is towards the more viscous fluid and if the velocity is sufficiently large further the effect of surface tension has been suggested referring to the work of chuoke et al 1959 to be acting to limit the range of wavelengths of the disturbances to which the interface is unstable a study of stability of the diffused interface formed within the non uniform pore fluid that is modeled using the eq 12 is warranted given the analogous nature of porous media flow with respect to hele shaw flow with this intention the base solutions resolved as traveling waves are understood as plane wave solutions that are independent of the direction orthogonal to their propagation arbitrary wave like perturbations are then superposed to these base solutions and the growth in time of the former is understood as early time fingering phenomenon 3 1 perturbed problem the base solutions in the physical domain are represented as s 0 x t and they propagate along the x direction exploiting the method of asymptotic expansions the physical solution itself is assumed to be a perturbed one s x y t that is composed of the base solution s 0 x t at the leading order and superposed disturbances resulting in a regular series expansion 21 s x y t s 0 x t ε s 1 x y t ε 2 s 2 x y t where ε represents the magnitude of the disturbance as usually done in asymptotic expansions we underline that convergence problems for solutions when ε 0 will not be covered in this analysis following among others auriault et al 2010 on this subject the reader may wish to refer for instance to hornung 1996 this form of the perturbed solution is inserted back into eq 12 which is further linearized by ignoring quadratic and higher order terms in ε this leads to two problems one of the leading order o 1 and another perturbed problem of order o ε obtained assuming the dimensionless numbers appearing in eq 12 to be of order o 1 and separately collecting terms independent of ε and terms linearly dependent on it the leading order term obviously just involves the base solution s 0 x t s x c t and therefore coincides with eq 17 conversely the perturbed problem 22 ϕ s 1 t k 0 s 1 x δ r c a δ k 0 μ e 0 s 1 δ r c a ϕ d n l k 0 δ s 1 k 0 δ s 0 s 1 0 governs the evolution of a generic disturbance up to order o ε in the above and what follows functions sub scripted 0 are to be understood as evaluated with the base solution noting that the base solution s 0 x t is uniform along y direction and subsequently employing ξ x c t yields the o ε perturbed problem governing s 1 ξ y t in the tw coordinate 23 ϕ s 1 t ϕ c s 1 ξ k 0 s 1 ξ δ r c a s 1 d 2 d ξ 2 k 0 μ e 0 2 s 1 ξ d d ξ k 0 μ e 0 k 0 μ e 0 2 s 1 ξ 2 2 s 1 y 2 δ r c a ϕ d n l s 1 d d ξ k 0 d 3 s 0 d ξ 3 s 1 ξ k 0 d 3 s 0 d ξ 3 d k 0 d ξ 3 s 1 ξ 3 3 s 1 ξ y 2 k 0 4 s 1 ξ 4 2 4 s 1 ξ 2 y 2 4 s 1 y 4 0 now since any generic disturbance can be resolved into its fourier modes modal stability analysis amounts to knowing the growth in time of individual fourier modes composing the disturbance if any one of these modes is found to be growing in time the flow as a whole is to be understood as unstable since any physical disturbance would contain all of these modes following this approach a spatially periodic form is assumed for s 1 24 s 1 ξ y t e i k y σ t s ξ where k is characteristic wave number of the disturbance in y direction σ is the exponential growth factor in time and s ξ is the amplitude of the wave like disturbance allowing variation in direction of propagation ξ introducing eq 24 in eq 23 yields 25 a d 4 s d ξ 4 b d 3 s d ξ 3 c d 2 s d ξ 2 d d s d ξ e s σ s 0 a linear homogeneous ode with spatially varying coefficients identified as 26 a δ r c a d n l k 0 b δ r c a d n l d k 0 d ξ c 1 ϕ δ r c a k 0 μ e 0 2 ϕ d n l k 2 k 0 d 1 ϕ k 0 ϕ c 2 δ r c a d d ξ k 0 μ e 0 δ r c a ϕ d n l k 0 d 3 s 0 d ξ 3 k 2 d k 0 d ξ e 1 ϕ δ r c a d d ξ k 0 μ e 0 k 2 k 0 μ e 0 δ r c a ϕ d n l d d ξ k 0 d 3 s 0 d ξ 3 k 4 k 0 d k 0 d ξ these coefficients are dependent on the base solution s 0 its derivatives w r t ξ and the wave number of the disturbance k since the base solution satisfies boundary conditions s and s while approaching uniformly the boundaries ξ and ξ respectively s needs to vanish uniformly at those boundaries such that the o ε perturbed solution is admissible this results in the following boundary conditions that any s governed by eq 25 needs to satisfy 27 s ξ 0 d s d ξ ξ 0 s ξ 0 d s d ξ ξ 0 3 2 discretization and asymptotic growth decay in the current section for each base solution the pair s and σ are determined numerically varying the value of k we approximate using a second order accurate central difference scheme the derivatives in eq 25 and 27 the physical domain is the same as that is used to resolve the base solutions with l 0 100 m and corresponding dimensionless domain ξ 0 5 0 5 subsequently the discretized problem for s and σ can be posed as an eigen value problem 28 a σ i s 0 where a is a sparse matrix encompassing the coefficients at respective finite difference fd nodes and i is an identity matrix of the same size since for a non trivial s a σ i 0 the solution set for σ is given by the spectrum of a represented σ a following modal stability analysis if sup ℜ σ a 0 then the corresponding perturbation grows exponentially in time according to eq 24 whereas if sup ℜ σ a 0 then all the perturbations s decay exponentially with time in order to numerically approximate this critical eigen value σ s sup ℜ σ a for a given wave number k a krylov schur algorithm available in matlab stewart 2002 has been employed this relation between k and σ s k is plotted as a dispersion curve for each base solution s 0 fig 3 shows the dispersion relation for base solutions which represent imbibition for various values of s s 0 20 and λ ρ w g the wave number of the fastest growing perturbation k f is the one associated to the peak of the dispersion curve for a large value of s 0 96 representing large injection velocity according to eq 20 σ s k is found to be negative for all values k analyzed this indicates an exponential decay of the arbitrary perturbations applied to those base solutions and thus a stable imbibition front which is the associated plane wave as s is reduced the base solutions start to involve non monotonicities and the growth rate σ s k is found to be positive for a range of k this indicates that perturbations within those ranges can potentially grow in time triggering fingering type instabilities as s is reduced further s 0 36 the dispersion curves again indicate exponential stability of the base solutions this is in qualitative agreement with the experimental observations by shiozawa and fujimaki 2004 dicarlo 2004 and the related hypothesis that overshoot profiles of saturation result in an unstable wetting front in gravity driven infiltration nieber et al 2000 eliassi and glass 2001 egorov et al 2003 dicarlo 2013 also indicated in fig 3 is the path followed by the wave number of the fastest growing perturbation k f as s is reduced the interpretation of this path is made clear in fig 4 with the understanding that the wave length associated to the fastest growing perturbation λ k f 2 π k f is representative of the spacing between the early time fingers and the intensity of the non monotonicity is reflected by s m a x s where s m a x is the peak value of the saturation degree attained by the imbibition front for intermediate range of injection velocities the intensity of overshoot in the base solutions is larger and the corresponding finger spacing is smaller whereas the growth rate is larger as the injection velocity either increases moving towards fully saturated conditions or decreases lower than the intermediate range the intensity of overshoot reduces the corresponding finger spacing increases and the growth rate decreases indicating a transition to the stable regime this strongly indicates a correlation between the injection flux and the characteristics of the associated fingering instabilities as observed in experiments glass et al 1989b yao and hendrickx 1996 a similar observation has been done in cueto felgueroso and juanes 2009a also it is interesting to compare the structure of the perturbation with maximum growth rate for a given wave number fig 5 shows this normalized eigen function s determined by solving eq 28 with k 140 and the associated base solutions s 0 superposed for all values of s the eigen function reaches a maximum within the diffused interface between s and s of the base solution however there exists a relative difference in the peak values and the spread along ξ of these peaks among these eigen functions as s reduces the peak value reduces and the spread along ξ increases this indicates a shift towards weaker and more spread out perturbations it can be inferred from this observation that for base solutions that consist a stronger non monotonicity lower s a relatively weaker perturbation is sufficient to render the flow unstable and vice versa fig 6 shows the dispersion relation for base solutions representing imbibition for various values of s s 0 85 and λ ρ w g and the path followed by the wave number of the fastest growing perturbation k f as s is increased for high values of s the base solution seems to be stable the intermediate range of s shows unstable behavior and as s is reduced further the tendency seems to be towards stable behavior however it is to be noted that the lowest value of s in this work is restricted by the residual saturation degree s r r e s 0 1567 this behavior is also plotted in fig 7 showing the relation between the qualitative indicator of finger spacing λ k k f and s a qualitatively similar observation was made in point source infiltration experiments by bauters et al 2000 where water was injected into initially moist sand packs albeit within a lower range of initial water content it was observed that the ensuing finger sizes decreased slightly with increasing initial water content starting from a completely dry condition and after a certain value the finger sizes increased exponentially for k 140 the normalized eigen function s is more spread out along ξ and has a lower maximum value of the peak when s is increased see fig 8 this indicates that for larger s while a weaker and more diffused perturbation can invoke instability in the flow it grows relatively slower in accordance with fig 6 fig 9 shows the dispersion relation for base solutions in fig 1 c that represent imbibition for varying values of λ 0 5 ρ w g ρ w g 1 5 ρ w g and with fixed boundary conditions s 0 20 and s 0 85 for the range of λ studied it is clear that base solutions with a relatively narrower spread along ξ larger λ when leaving the equilibrium state s 0 0 have a wider range of k for which the perturbations are unstable and also larger values of k f and associated peaks corresponding to a relatively faster growing perturbations fig 10 shows the normalized eigen functions s for k 140 along with the corresponding base solutions it can be inferred that for larger values of λ accordingly larger c a the eigen function has a peak value which is higher and relative spread along ξ which is narrower representing a stronger perturbation that is needed to generate an unstable flow and according to the dispersion relation fig 9 this perturbation would grow relatively faster to summarize the case of imbibition linear stability analysis of the infiltrating front provides results consistent with experimental evidence moreover it tells us that for a given imposed pressure gradient stronger the perturbation needed to destabilize the front faster would be its growth and consequently faster would be the destabilized finger and this condition is achieved when the non monotonicity of the base solution is less pronounced for the drainage case fig 11 shows the dispersion relation for base solutions in fig 2 with varying λ as mentioned earlier the drainage base solutions represent two qualitatively different type of tw solutions those solutions representative of non classical under compressive shocks which were observed in the higher range of λ are found to be stable towards transverse perturbations whereas the solutions representative of non classical expansion shocks at the lower range of λ are found to be unstable within a particular range of wave numbers k in spite of those base solutions being monotonic among the latter for the range of λ studied as λ is increased the range of unstable wave numbers increased along with the wave number of the fastest growing perturbation k f from fig 12 for k 150 it can be observed that for higher values of λ the eigen function has a lower peak and a wider spread along ξ representing a weaker perturbation that renders the flow unstable it can be noted that this tendency is contrary to what was observed in the imbibition case while the subsequent growth of an initial disturbance is governed by non linearities inherent to the model in the context of linearized analysis it can be expected that the wave number of the ensuing fingering instability at late times would be close to that of the fastest growing perturbation k f also the upper bound of the range of unstable wave numbers serves as a critical wave number beyond which any perturbations decay in this sense linear stability analysis serves as tool to identify the minimum size of the transverse dimension of a porous medium domain in order to be able to invoke and observe fingering phenomenon taking cue from the above results two dimensional pde simulations in section 5 were initialized within appropriately sized domains and with an imposed transverse perturbation superposing a few random wave numbers in the neighborhood of k f in order to accelerate the onset of instabilities 4 stability against longitudinal perturbations as can be observed from the structure of the base solutions of the tw problem there exist regions of uniform saturation degree ahead and behind the front the solution within these regions is subject to instability in the presence of longitudinal perturbations such as the oscillatory non monotonicities observed in base solutions in the vicinity of the front see fig 1 such instability triggers the formation of banks of fluid perpendicular to the direction of motion of the front which further destabilize transversely to form bubbles behind the front also when a front destabilizes due to transverse perturbations as analyzed in section 3 their ensuing growth forms fingers see section 5 along the length of those fingers there is also a region behind their tips within which the saturation degree is uniform the solution within this region can as well destabilize due to longitudinal perturbations resulting in breakup of those fingers into droplets this is akin to the now well studied plateau rayleigh instability that explains jets of liquid destabilizing and forming coalesced droplets eggers and villermaux 2008 in order to analyze the onset of such instabilities in the current context we consider a longitudinally perturbed solution s x t of eq 14 in the vicinity of a constant and uniform base solution s 0 and expand it in a regular series 29 s x t s 0 ε s 1 x t ε 2 s 2 x t about the base solution with ε now being the magnitude of longitudinal perturbation we follow again the approach employed in section 3 1 by introducing such perturbed solution into eq 12 and assuming that the perturbation is small compared to the base solution this leads to an o ε perturbed equation 30 ϕ s 1 t k 0 s 1 x δ r c a k 0 μ e 0 2 s 1 x δ r c a ϕ d n l k 0 4 s 1 x 4 0 that governs s 1 x t here as well functions sub scripted 0 are to be understood as evaluated with the base solution in order to analyze if a longitudinally harmonic perturbation would grow decay asymptotically in time the following form is assumed for the o ε perturbation 31 s 1 x t e i k x σ t where k is characteristic wave number of the disturbance in x direction and σ is its exponential growth factor in time introducing eq 31 into eq 30 results in an expression for the growth factor in terms of the base solution and the wave number 32 σ s 0 k 1 ϕ δ r c a k 0 μ e 0 k 2 ϕ d n l k 4 i k k 0 similar to what was noted in the section 3 for transverse perturbations any longitudinal perturbation resulting in ℜ σ 0 is to be understood as growing exponentially in time leading to instability about the uniform base solution fig 13 shows the graph of the relation eq 32 in the space of s 0 k ℜ σ for certain values of s 0 there exist a range of wave numbers k for which ℜ σ 0 this region of instability shaded gray in fig 13 b is given by the relation 33 μ e 0 ϕ d n l k 2 between the slope of the effective chemical potential evaluated at s 0 and the square of the wave number fig 13 c shows the dispersion relations in the space of k ℜ σ for uniform saturation values s 0 observed as left boundary conditions s in the base solutions corresponding to imbibition in fig 1 for s 0 0 70 0 75 there is a range of k for which ℜ σ 0 while the respective base solutions for both these cases exhibit oscillations when leaving the uniform equilibrium state s 0 0 it will be shown further using two dimensional simulations in section 5 that only the oscillations in the case s 0 70 are within the range of k that trigger the instabilities behind the front 5 two dimensional simulations in this section we use numerical simulations as a means to examine the non linear growth of perturbations to a base solution in a two dimensional spatial setting to do this the two dimensional domain is initiated with a field of s r x y involving a smooth jump along the x direction and extending homogeneously in the y direction that represents a transition from one fluid phase to another to this field perturbations dependent on y direction are superposed that are sinusoidal in nature involving a few randomized wave lengths this perturbed initial condition is representative of physically realistic conditions where the air water interface in a porous medium is not independent of y direction owing to intrinsic heterogeneities however it is to be noted that these imposed perturbations are only spatial in nature and does not involve perturbations in the value of s r itself 5 1 numerical method and discretization we choose as the primary unknowns the saturation degree s r and the regularized effective chemical potential with known spatially linear pressure contribution μ then the coupled system of equations formed by eqs 12 and 13 is resolved we acknowledge at this point that since our focus is to analyze the general structure of the solutions and to verify the linear stability analysis we have adopted a simple numerical discretization if one intends to resolve the interface with higher accuracy and lower computational cost then the implementation can be extended to more sophisticated techniques of the likes of adaptive refinement martin et al 2005 boyer et al 2009 spatial discretization is done employing a standard galerkin formulation and linear lagrange finite elements time discretization is done using the implicit euler scheme of first order the discrete solutions at n th time step s r n μ n are obtained by searching in a suitable subspace of h 1 ω a hilbert space of admissible functions defined over the discretized domain ω for those functions that solve the non linear coupled variational system 34 ω q ϕ s r n s r n 1 δ t d ω ω δ r c a k s r n q μ n d ω ω n μ q δ r c a k s r n μ n n d ω n μ 0 ω s μ n μ e s r n c a δ r x d ω ω ϕ d n l s s r n d ω ω n s s ϕ d n l s r n n d ω n s 0 for any test functions s and q belonging to h 1 ω and vanishing on the part of the boundary where respectively s r and μ are specified n is the outward unit normal vector to the boundary where it is referred to ω n μ is that part of the boundary where normal derivative of μ is specified which translates to imposing at that part of the boundary an injection or extraction velocity of the fluid with a natural form 35 v f ω n s δ r c a k s r μ ω n s is that part of the boundary where normal derivative of s r is specified the material properties and model parameters used in the current study can be found in table 1 of part i which are in the range typical of silica sands saturated with air water mixture mesh convergence behavior has been tested once chosen initial and boundary conditions corresponding to an imbibition problem and a drainage problem which are elaborated in sections 5 2 and 5 3 to validate the numerical solution in particular successively refined discretization steps have been considered the results of this analysis are reported in appendix 5 2 imbibition fronts the computational domain used for imbibition simulations is a rectangle such that x 0 1 and y 0 0 3 whose physical dimensions correspond to a length of l 20 m and a height of h 6 m displacement of air by water representing imbibition can be understood as a solution which transitions from a higher degree of saturation to a lower one and moves in the direction of the lower saturation in order to realize this the domain is initialized with a solution s r t 0 involving a smooth jump along the x direction between the saturation degree representing the infiltrating water s and that of an initial saturation degree of an almost dry domain s r 0 such that s s r 0 at t 0 the region of the domain initialized with s is restricted to a thin layer at the infiltrating surface x 0 y that is perturbed transversely in the y direction with a few randomized wave lengths within the vicinity of the fastest growing wavelength λ k k f given by the linear stability analysis with boundary conditions s s s s r 0 the initial condition for μ is such that μ t 0 μ p f s r t 0 p for all t 0 the normal derivative of s r is set to vanish at all the boundary surfaces at the left boundary surface x 0 y an injection velocity 36 v f x 0 y δ r c a k s p is imposed this has an effect of inducing imbibition with an uniform saturation degree of s while the normal derivative of μ p f vanishes the boundary at the right x 1 y is drained with a dirichlet boundary condition on μ such that 37 μ x 1 y μ e s r 0 p x 1 y the top x y 0 3 and the bottom x y 0 boundaries are impermeable see schematic fig 14 for a summary of these boundary conditions fig 15 shows such a perturbed initial condition for the case of s 0 75 s r 0 0 20 and its evolution for t 0 under the above boundary conditions and λ ρ w g the perturbations grow in time forming fingers within the domain that are similar to observations in infiltration experiments into initially dry sand glass et al 1989b selker et al 1992 this model indicates that these ensuing fingers are more saturated than the region behind also the advancing tips of the fingers are of higher saturation than the region within the finger itself these observations are inline with the experimental saturation profiles of fingers detected using light transmission by glass et al 1989a the saturation profile within the space between the fingers see fig 15 b is significantly different from that within the finger itself and is also closer to that of the one dimensional base solution these intricate comparisons of the saturation profiles are yet to be realized using meticulously designed experiments the solution of μ p f along with its constituent local and non local components is shown in fig 16 at t s t e p 6000 along with a comparative plot within the vicinity of the tip of the central finger it is clear that while the effective chemical potential μ e is non monotonic owing to the non convex local fluid energy the non local chemical potential μ n l compensates by following the convexity of s r in accordance with eq 6 along the sides of the fingers the fringe region the solution indicates regions of higher μ e this is a consequence of higher saturation degree within this fringe region compared to that of the initially dry region s r 0 see fig 15 a this fringe region as well coincides with the passage of the distinctive swell of the finger tip at an earlier time step the linear stability analysis in section 3 indicates that as the injection velocity v f is increased from the intermediate range the spacing between the fingers increases and their growth rate decreases effectively suppressing the fingering phenomenon this is verified in the two dimensional problem see fig 17 where as s in eq 36 is varied within the range 0 70 0 96 the same trend is observed for the largest injection velocity s 0 96 the initial perturbations are completely suppressed and the imbibition front infiltrates the domain homogeneously for s 0 70 the region behind the infiltrating front which is expected to have an uniform saturation degree of 0 70 is perturbed longitudinally due to the oscillations as seen in the one dimensional solution see fig 1 these oscillations are longitudinal in nature as elaborated in section 4 and grow in time while interacting non linearly with the infiltrating front the result of this kind of instability and the non linear interactions is the formation of bubble like trapped regions of lower saturation see last row of fig 17 5 3 drainage fronts the computational domain used for drainage simulations is a rectangle such that x 0 1 and y 0 0 15 whose physical dimensions correspond to a length of l 20 m and a height of h 3 m drainage of water by air is understood as the contrary of imbibition which is a transition from lower saturation degree to higher moving in the direction of the higher saturation so the initial condition s r t 0 is chosen similar to that of imbibition with a smooth jump along the x direction in the saturation degree from s to s r 0 such that s s r 0 the initially saturated region of the domain is assumed to be close to full saturation s r 0 0 99 the region that is relatively dry s r x y s is restricted to a thin layer at the left boundary x 0 y similar to imbibition this initial condition is perturbed with randomly chosen wave lengths within the vicinity of the fastest growing wave length indicated by the linear stability analysis the initial condition for μ is such that μ t 0 μ p f s r t 0 p owing to the phase field parameter s r of the current model being representative of the saturation degree of the wetting fluid an injection flux of the form eq 35 at the boundary would not be appropriate to induce drainage instead the imposed linear pressure p is allowed to drive the drainage front across the domain by choosing appropriate boundary conditions see schematic fig 18 for all t 0 at the left boundary surface x 0 y dirichlet boundary conditions are setup with s r x 0 y s and 38 μ x 0 y μ e s p x 0 y the boundary at the right x 1 y is drained with a dirichlet boundary condition on μ eq 37 and the normal derivative of s r is set to vanish similar to the imbibition case these set of boundary conditions have an effect of inducing extraction of water at the right boundary that is consistent with the imposed pressure gradient while the normal derivative of μ p f vanishes the top x y 0 15 and the bottom x y 0 boundaries are impermeable and the normal derivative of s r is as well set to vanish fig 19 shows the evolution of s r x y for t 0 of a perturbed initial condition for the case of s 0 20 under the above boundary conditions and for λ 1 5 ρ w g the solution along the length of the domain is consistent with one dimensional pde solutions in part i with a self similar traveling wave part connecting a lower saturation degree s b to a higher s a which represents a non classical expansion shock and this is connected on either side up to the boundary by expanding parts of the solution however the traveling wave part of the solution along the length of the finger has a different lower value compared to that of within the gap between the fingers see fig 19 b t s t e p 250 the latter being consistent with the one dimensional base solution for the imposed boundary conditions in the current problem see fig 2 in fact a one dimensional traveling wave connecting s b to s a that correspond to the solution along the length of the finger would have a higher speed approximated by eq 16 compared to that of within the gap between the fingers which explains the higher speed of the advancing tip of the finger compared to its base as the solution evolves formation and detachment of droplet like structures occurs between the fingers this is due to the growth of longitudinal perturbations to the part of the solution s r x y 0 0775 s b 0 45 between the diffused interface and the expanding region on the left as noted in part i the origin of longitudinal oscillations in this region is related to the nature of the equilibrium state associated to s b of the dynamical system formed by the ode 19 these oscillations tend to grow because s b 0 45 is clearly within the unstable region of uniform base solutions dictated by eq 33 see section 4 this is not true for the solution along the length of the finger because the corresponding s b 0 35 similar to the imbibition case the effective chemical potential μ e is non monotonic and the non local chemical potential μ n l follows the convexity of s r taking positive values just behind the diffused interface see fig 20 in order to verify the prediction of the linear stability analysis done in section 3 we present here the evolution of the solution s r for different values of the gradient of imposed pressure distribution λ inline with the prediction as λ is decreased from 1 5 ρ w g the finger spacing is reduced resulting in thicker fingers and these thicker fingers grow slower see fig 21 however if λ is increased drastically the arbitrary initial perturbations to the diffused drainage front decay in time see fig 22 it is to be noted that for λ 150 ρ w g the diffused front connects between s r 0 8 and the initial saturation degree of s r 0 99 see fig 2 which is indicative of non classical under compressive shock the decay of initial perturbation is revealed by the reduction as the solution evolves of the spatial gap at the diffused interface due to the imposed perturbation at t s t e p 0 the expanding rarefaction part of the solution behind the diffused front does not seem to follow the same rate of decay resulting in persistence of the initial disturbance at the left end of this part of the solution 6 conclusions in this part ii of the study we have presented a systematic linear stability analysis of the solutions of the phase field model introduced in part i by studying the growth decay of imposed initial perturbations the solutions analyzed were both of imbibition and drainage transverse stability analysis of the imbibition solutions has indicated that they are sensitive to imposed infiltration flux as observed in the experiments there seems to be an intermediate range of infiltration fluxes within which appropriately sized perturbations would grow in time forming fluid fingers as the flux was either decreased or increased the fingers tended to become thicker and eventually stabilized below or above certain flux values this behavior of the imbibition solutions seems to be related to the overshoot type non monotonicity as hypothesized in earlier studies one dimensional analysis of the current model done in part i has indicated that this overshoot exists only for certain boundary conditions suggesting that the ensuing instability might be a consequence of the overshoot rather than the cause we have also studied the effect of initial saturation degree of the domain being infiltrated and that of imposed pressure gradient across the domain as observed in experiments increasing initial water content tended to stabilize the infiltration front increasing the imposed pressure gradient within the range studied rendered the infiltration front more susceptible to destabilization on the other hand for the drainage front a larger range of imposed pressure gradient was studied and the drainage front seemed to stabilize at very high pressure gradients an analytical result was also presented for the stability of one dimensional uniform base solutions against longitudinal perturbations in the direction of propagation of the front this result indicated on the possibility of destabilization of the solutions within a particular range of uniform values of the base solutions which could result in the formation of trapped regions of dissimilar saturation in higher dimensions this was shown to be a consequence of the negative slope of the chemical potential in a certain range of saturation degrees which in turn has its origins in the double well structure of the bulk fluid energy employed in this model two dimensional numerical results were as well presented which were based on a finite element implementation these results verify those of the linear stability analysis with respect to finger sizes observed and stabilization of the front when expected the rich structure of the solutions is attributed to the various energy contributions that encompass the non uniform fluid potential while the results were inline with the existing experimental observations the model predicts additional features that maybe observed during air water displacements detailed experiments are warranted both in imbibition and drainage in order to investigate these predictions it is to be noted that our current study only concerns air water displacements within non deformable porous network most natural extension would be to model the porous network as deformable with possible mechanical failure which could be understood either as localization of solid strain or as localized degradation resulting in re modeling of the pore structure this will be the focus of our further research resulting coupling between the solid and fluid flow localizations is also of interest credit authorship contribution statement siddhartha h ommi conceptualization methodology formal analysis data curation writing original draft giulio sciarra conceptualization reviewing supervision panagiotis kotronis conceptualization reviewing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors acknowledge the support of the french national research agency anr for the project stoweng project anr 18 ce05 0033 appendix convergence properties of the two dimensional solutions in order to validate the robustness of the numerical scheme adopted to solve the two dimensional problems presented in sections 5 2 and 5 3 a mesh convergence analysis has been conducted for two test cases relative to an imbibition and a drainage problem as expected reducing the element size implies a decrease of the 2 norm of the difference between solutions both for the saturation degree and the generalized chemical potential computed with successive mesh refinements see fig a 23 data relative to the test cases are reported in the caption of the figure in both cases the number of fingers that emerge and their relative spatial evolution are not affected due to mesh refinement 
