index,text
20515,in a man overboard mob incident a quick and effective search and rescue sar operation is crucial to increase the survival probability of the victim determining the search area and planning paths for the rescue ships are essential for efficient sar operation the search area s determination requires the prediction of the missing person facing the challenges of lacking information about the accurate position and time of falling and the influence of environmental disturbances two main aims of path planning for sar operation are quick arrival at the search area and coverage search with high cumulative possibility of success pos many path planning algorithms have been proposed most of them aim at finding the shortest paths which meet the goal of quick arrival however the path planning for maximizing pos of finding the person is still lacking besides compared to an individual ship a fleet of cooperative maritime autonomous surface ships mass can significantly increase the pos and reduce sar personnel s risk in a time sensitive sar operation therefore in this paper we propose a cooperative path planning framework to search for the missing person in a mob incident using a fleet of fully autonomous mass the framework is divided into three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment forecasting data which determines the search area secondly an adaptive greedy search algorithm is applied to tracking the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation method simulation experiments and sensitivity analysis are carried out to demonstrate the effectiveness of the proposed framework keywords cooperative path planning man overboard multiple mass adaptive greedy algorithm search and rescue 1 introduction maritime autonomous surface ship mass is defined as a ship which to a varying degree can operate independently of human interaction fully autonomous mass have great potential in search and rescue sar operation such as reducing the risk of sar personnel in a dangerous environment among the maritime accidents an increasing number of man overboard mob incidents occur due to the increment of world trade and cruise lines due to the rough sea and temperature of the cold water the person can drown or get hypothermia in a mob incident a quick and effective sar operation is crucial to increase the survival probability of the victim sar is a systematic mission that needs to be planned coordinated controlled and commanded to respond to an emergency yoo et al 2020 sar service includes two main processes search is the operation normally coordinated by a rescue coordination center or rescue subcenter using available personnel and facilities to locate persons in distress rescue is the operation to retrieve persons in distress provide for their initial medical or other needs and deliver them to a place of safety international maritime organization 1979 for most emergencies locating the person is challenging for a mob search the essential is to minimize the expected time and maximize the cumulative probability of success pos over the operation lin and goodrich 2014 two main tasks are the keys throughout the mob search predicting the position of the missing person for determining a search area of limited size planning paths for the rescue ships for quick arrival and coverage search with high cumulative pos for the prediction of the missing person on the one hand the information of accurate falling time and position is unavailable on the other hand influenced by the external environment such as wind wave and current the missing person is drifting thus the possible positions are time varying which also increases the difficulty of search path planning for path planning many path planning algorithms have been proposed such as potential field method khatib 1985 dijkstra s algorithm dijkstra 1959 fast marching sethian 1996 etc most of them aim at finding the shortest paths which meet the goal of quick arrival however the path planning for maximizing pos of finding the person is still lacking unlike the traditional path planning task that plans the shortest collision free path from a start point to end point the coverage path planning cpp calls for a feasible path that increases the cumulative pos within a limited time bourgault et al 2003 yao et al 2019 conventional sar operations use specific strategies to achieve this goal such as parallel track search creeping line search expanding square search and sector search koopman 1957 however those strategies regard the probability of the mob s position as a uniform distribution which is not realistic moreover sar operation is time sensitive taking the mob s position probability into account can significantly increase the survival probability of the person moreover compared to an individual ship greater efficiency and operational capability can be realized by a team of mass chen et al 2018 besides in existing research different unmanned vehicles are suggested to cooperate with each other to play to their strengths in sar operation in the mass and autonomous underwater vehicle auv cooperation system the mass is used to perform an initial large area survey target identification autonomously and the auv search mission is subsequently defined according to the results of the initial survey to provide the precise location of underwater targets and close inspection ferri et al 2015 in the mass and unmanned aerial vehicles uavs cooperation system the uavs are often applied to carry out search tasks because they offer a broader view xiao et al 2017 however in mob search the uavs have some drawbacks firstly the uavs suffer from limited battery life hou et al 2020 secondly uavs are affected more by environmental conditions sea state glare and luminance than mass moreover although a high viewing angle provides a broad view it increases the difficulty of finding a small target in water thus uavs are usually used as assistance helping the sar personnel or cooperating with mass mendonça et al 2016 it is not applicable to include uavs in a fully autonomous search team for a long time moreover in the current situation when unmanned vehicles are used in a sar operation they are remotely controlled by sar personnel rather than carry out the task autonomously in this paper we focus on the search process the first step of carrying out a mob search autonomously is planning the path for the fleet of mass therefore we proposed a cooperative path planning framework to search for the missing person in a mob incident using a fleet of fully autonomous mass the framework is divided into three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment numerical forecasting data that determines the search area secondly an adaptive greedy search algorithm is applied to the fleet to track the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation the main contributions of this paper are as follows 1 a framework for cooperative path planning is proposed for multiple mass to carry out the mob search 2 the stochastic particle simulation is applied to determine the search area and generate the probability map of the mob 3 an adaptive greedy algorithm is proposed for increasing the cumulative pos of the mob in a limited time the remainder of this paper is arranged as follows section 2 provides a literature review on related publications section 3 presents the cooperative path planning framework to search for the missing person in a mob incident in section 4 details of the framework are elaborated in section 5 sensitivity analysis and case study of multi mass path planning in mob search are carried out in section 6 we discuss the role of our framework and the potential of framework in the context of the mass concept and sar operations section 7 concludes the main findings and future research directions 2 literature review 2 1 position prediction the first step of sar operation is to predict the position of the missing person for determining the search area the person in water is usually regarded as a particle the position of the person is influenced by wind and current thus the lagrangian stochastic model that describes the paths of particles in a turbulent flow given knowledge i e statistical description of the random velocity field is often mentioned abascal et al 2015 özgökmen et al 2000 besides to describe the considerable uncertainties during the drifting a monte carlo method that relies on repeated random sampling is often used breivik and allen 2008 the prediction of the position is based on the knowledge about the environmental data such as wind current and wave field many studies on the quantitative and accurate description of environmental forecast data have been carried out for years equipment such as high frequency coastal radars are applied to high precision current data collection abascal et al 2009 models based on historical data are also used shchekinova and kumkar 2015 the uncertainties of the environment forecasting data are usually described by probability distributions breivik et al 2011 2 2 path planning algorithm 2 2 1 shortest path planning the path planning algorithms aim at finding the shortest path which meet the goal of quick arrival for sar operations are classified into three groups graph search based method sampling based method and numerical optimization 1 graph search based method the graph search based method overlays a grid on configuration space and assumes that each configuration corresponds to a grid node two types of search strategies are often used in this category graph traversal algorithms such as depth first search tarjan 1971 and breadth first search bundy and wallen 1984 find the collision free path by traverse from a point to adjacent grid points greedy best first search algorithms pick the best node according to some rule of thumb called a heuristic the representations are heuristic algorithms like the dijkstra 1959 a hart et al 1968 and its variations such as d stentz 1994 and theta daniel et al 2010 heuristic algorithms are widely used for the advantages of easy implementation and time saving for example the a and disktra were used to find the shortest rescue static victim path in the urban flood environment nizami et al 2012 however the graph traversal algorithm is optimal always returns the shortest path while the greedy best first search algorithm results in a feasible path instead of the optimal one 2 sampling based method the sampling based method randomly samples the configuration space or state space and looks for connectivity inside this space gonzalez et al 2016 two widely used sampling based methods in automated vehicles are the probabilistic roadmap method prm and the rapidly exploring random tree rrt the proceeds of prm are divided into learning phase and query phase in the learning phase the continuous space is converted into discrete space and a roadmap is created in the query phase the search algorithm is used to find the collision free path on the roadmap kavraki et al 1996 the rrt is the on line path planning method different from prm rrt allows path planning in semi structured spaces applying the rrt algorithm to find out the shortest path for a group of robots to complete a sar mission is presented in neto et al 2018 3 numerical optimization the optimization method focuses on solving multi objective optimization problems such as minimizing the path length and fuel consumption etc the numerical optimization method is suitable for both static and dynamic environments tavoosi et al 2020 an efficient approach to solve the optimization problem is an evolutionary algorithm that uses mechanisms inspired by biological evolution for example hu and yang 2004 used a genetic algorithm to solve the path planning problem chai et al 2017a 2017b proposed improved differential evolution algorithms to solve the trajectory optimization problem another group of bio inspired algorithms is swarm intelligence algorithms which are based on behavioral models of social creatures like ants bees etc methods like ant colony optimization mohamad et al 2005 and biased particle swarm optimization chai et al 2021 have been used for planning the optimal trajectory for time and energy saving 2 2 2 coverage path planning unlike the traditional path planning task that plans the shortest collision free path from a start point to end point coverage algorithms focus on planning paths for traversing a known area coverage path planning algorithms in existing research can be divided into two groups cellular decomposition and numerical optimization 1 cellular decomposition the processes of cellular decomposition algorithms can be divided into two steps the first step is decomposing the free space into cells and store the decomposition as an adjacency graph the second step is generating the exhaustive path through the adjacency graph galceran and carreras 2013 the primary method considers only convex and joint areas and the path was can be generated by cellular decomposition algorithms queralta et al 2020 such as trapezoidal decomposition choset et al 2005 and boustrophedon decomposition choset 1997 further the generalized boustrophedon decomposition is proposed based on critical points of morse functions i e morse based decomposition acar et al 2002 the morse based decomposition method can handle non polygonal obstacles and can be applied to any dimensional space the grid based method is classified as approximate cellular decomposition for instance the wave front algorithm zelinsky et al 1997 and spiral spanning tree coverage gabriely and rimon 2002 are proposed for grid map coverage path planning 2 numerical optimization setting the coverage task the objective the optimization method can also be used for finding the optimal coverage path the evolution algorithms and swarm intelligence algorithms etc can be used to solve such coverage path planning problems for example the optimal path that considers the robot energy and sensor range limitation is solved by jeddisaravi et al 2016 a hybrid evolutionary algorithm is proposed to find the optimal path obtaining the expected detection time for search tasks in a mob incident du et al 2019 aiming at maximizing the probability of finding a lost target yao et al 2019 designed a framework combining gaussian mixture model and approximation insertion approach using multiple robots can significantly improve the efficiency of coverage search coverage path planning for multiple robots requires cooperation among the agents one way is dividing the area into different parts and each agent is responsible for one part the other is cooperative path planning for example in binney et al 2010 the recursive greedy path planning algorithm is proposed to generate a path for multi robot to gather information of an area 3 methodology in this paper the stochastic particle simulation predicts a missing person s position at sea the step sized statistic method is used to generate a particle distribution map based on the particle distribution map an adaptive greedy search algorithm is proposed to create the target tracking and coverage search paths finally the paths are further smoothed by the line of sight algorithm and the kinematic interpolation the framework is expressed in fig 1 1 position prediction the stochastic particle simulation is used to predicate the position of the missing person and determine the search area the stochastic particle simulation is implemented by the monte carlo method stochastic particle simulation abstracts the search target as an independent particle each particle is assumed to be a mass point with all the motion properties of the search target li et al 2013 after predicting the missing person s position a particle distribution map is generated based on the step sized statistic method 2 target tracking when a mob incident happened the adaptive greedy search algorithm is applied to generate a collision free path for the fleet to track the drifting predicted area the line of sight algorithm is used to smooth and shorten the path 3 coverage search when the distance between the mass and drifting predicted area reaches a predefined threshold the adaptive parameter processor is called to find the relatively optimal setting of the evaluation function for the coverage search algorithm then the coverage search algorithm is used to plan the search path the kinematic interpolation is used to obtain a smooth connection between two segments 4 cooperative path planning for mob search 4 1 position prediction influenced by the external environment such as wind and current the missing person is drifting on the sea surface the predicted position of the missing person determines the search area in the proposed framework the stochastic particle simulation is applied to predict the possible positions of the missing person this method abstracts out the person into an independent particle which is a mass point with all the motion properties of the person by analyzing the disturbance of marine environmental data and the disturbance of leeway the overall drift model of the missing person is established a large number of repeated experiments are then carried out to simulate the drift movement of the missing person i e the so called monte carlo method by recording all particles movement trajectories a search area is determined simultaneously the probability map of the missing person s position can be generated based on the step sized statistic method 4 1 1 initial position errors many factors affect the initial position distribution such as marine environment and meteorology the position and time of mob incident etc if the crews onboard are aware of the mob incident the initial position error of the missing person is small which can reduce the difficulty of sar operation however in practice the mob incident usually occurs without witnesses in the proposed framework we introduce a random error to describe the uncertainty of the initial position if the initial position and time is known a circular normal distribution can be used to describe the initial position error of the missing person li et al 2013 i e 1 f r θ 2 π σ r σ θ 1 ρ 2 1 exp r u r 2 σ r 2 2 ρ r u r θ u θ σ r 2 σ θ 2 θ u θ 2 σ θ 2 2 1 ρ 2 where r is the initial position probability circle radius θ is the angle between the probability circle radius and true north r θ n μ r σ r 2 μ θ σ θ 2 ρ ρ is the coefficient of association if the initial position is unknown the initial position and time can be deduced from known information the last known time denoted as t l a s t and the position denoted as p l a s t that the person is seen onboard the course and speed of the ship during the time interval between t l a s t and the moment the crews realize there is a mob incident denoted as t r e a l i z e in this scenario the mob incident may occur at any time from t l a s t to t r e a l i z e thus in our framework the position prediction of the missing person is calculated in the following way firstly the initial position error still exits following the circular normal distribution as assumed in the above mentioned scenario secondly the moment the mob incident occurs is assumed to follow a uniform distribution thirdly the course and speed of the ship during t l a s t to t r e a l i z e are supposed to follow a uniform distribution lastly combining the possible initial positions the random occur time and ship course and speed the possible positions of the missing person at t r e a l i z e can be calculated 4 1 2 wind and current field the environmental factors being considered in this research are wind and current the wind induced drift of a missing person at sea is represented by leeway i e the relative movement of an object to the surrounding sea due to the wind acting on the water part of the object breivik et al 2011 leeway has a strong linear relationship with wind speed at 10 m above the sea surface allen and plourde 1999 which can be expressed as follows 2 w i w 10 ξ i where w i is the estimated wind speed of particle i at 10 m above sea surface w 10 is the predicted wind speed at 10 m above sea surface ξ i is the wind speed disturbance of particle i at 10 m above the sea surface ξ i obeys a normal distribution with a mathematical expectation of 0 and a variance of σ w i n d 2 denoted as ξ i n 0 σ w i n d 2 two models of leeway are established in allen and plourde 1999 one is the unconstrained leeway model y model and the other one is the constrained wind pressure model 0 model the y model is based on the regression of experiment data however in y model when the wind speed is zero the corresponding leeway value is not zero which does not fit the definition of leeway thus this paper takes the 0 model to describe the motion of a particle 0 model can be expressed as equation 3 because the windage area of a person in the water is small here we only consider the downwind components of leeway 3 l d ˆ a d w i 4 a d ˆ a τ i 10 where l d ˆ is the vector of leeway downwind a d ˆ is the regression coefficient a is the slope of the wind speed at 10m above sea surface τ i is a random perturbation of the leeway coefficient it obeys a normal distribution with a mathematical expectation of 0 and a variance of σ l 2 denoted as τ i n 0 σ l 2 σ l is the standard deviation of systematic estimation the current vector is taken at 0 5 m below the sea surface this coincides with the draft of a typical sar target breivik and allen 2008 the current speed at 0 5 m below the sea surface can be expressed as follows 5 c i ˆ c 0 5 ξ i where c i ˆ is the estimated current speed of particle i at 0 5 m below the sea surface c 0 5 is the predicted value of the current speed at 0 5 m below the sea surface ξ i is the current speed disturbance of particle i at 0 5 m below the sea surface ξ i obeys a normal distribution with a mathematical expectation of 0 and a variance of σ c u r r e n t 2 denoted as ξ i n 0 σ c u r r e n t 2 4 1 3 drift motion model according to the wind and current field the drift velocity vector of a particle in the water can be calculated as follows 6 v d r i f t l d ˆ v c u r r e n t based on the assumptions and simplifications above the overall drift model of the missing person is simplified as follows 7 l o c i t l o c i 0 0 t v d r i f t d t 0 t l d ˆ t v c u r r e n t t d t where l o c i t is the position of the particle i at moment t l o c i 0 is the initial position of the particle i v c u r r e n t is the vector of current induced drift velocity 4 1 4 probability map of the missing person s position as mentioned pos is used to describe the probability of a sar target being successfully rescued which is the key indicator in sar operation the pos depends on two indicators the probability of containment poc and the probability of detection pod wei et al 2020 8 p o s p o c p o d the search area is decomposed into cells the size of the cells is based on the onboard detection equipment s ability the poc represents the probability of a missing person in a cell agbissoh otote et al 2019 using particles to represent the possible positions of the missing person the poc is calculated as follows 9 p o c n c n t where n c is the number of particles in a cell is the total number of particles in the search area in the proposed path planning algorithm the state of cell j is represented by the state of node j the state of node j can be expressed as follow 10 l o c j p o c j where l o c j is the position of node j which is the center position of the cell j p o c j represents the probability of a missing person in cell j the pod represents the possibility of the sar target could be found by the search unit which can be expressed in equation 11 abi zeid and doyon 2003 11 p o d 1 e c 12 c w d t r a c k where c is the coverage probability of the search unit w is the sweep width and it has a strong relationship with the different detectors search environment and types of search objects d t r a c k is the track spacing and it depends on the search pattern with the monte carlo simulation all the predicted positions of the missing person are acquired using the step sized statistic method to calculate the poc of each cell in the search area the possibility map of the position is generated to sum up the pseudocode of the position prediction algorithm is shown as algorithm 1 algorithm 1 position prediction algorithm based on stochastic particle simulation image 1 4 2 target tracking and coverage search after the probability map is generated the path planning algorithm is applied to find the sar operation path subsequently in this section we firstly introduce the motion model of the mass for the mob search secondly the classical greedy search algorithm is introduced thirdly the greedy search algorithm with line of sight smoothing is used for target tracking at the end the adaptive greedy algorithm for coverage search is presented the main modifications 1 an adaptive parameter processor is developed to find the relatively optimal setting of the evaluation function 2 the search range is adaptive 4 2 1 motion models of the mass in the path planning framework a mass is simplified to a mass point and considers its movement on a two dimensional plane whose motion is expressed as a linear discrete time model 13 x i k 1 p i k 1 v i k 1 a i k 1 θ i k 1 p i k v i k δ t 1 2 a i k δ t 2 v i k a i k δ t a i k 1 θ i k 1 where x i k 1 is the state of mass i at the time step k 1 p i v i a i and θ i are the position velocity acceleration and heading of mass i respectively the mass is subject to constraints like the maximum acceleration and speed due to the limitation of the dynamic system and hull structure i e 14 v min v i k 2 v max 15 a min a i k 2 a max where 2 is the euclidean norm as in the mob search task the mass in the fleet carries out the search task with a constant configuration therefore the distances between the mass are constant d i e 16 p i p j d 4 2 2 greedy search algorithm the greedy search algorithm is widely used in vehicle path planning studies liu et al 2016 the basic idea of greedy search algorithm can be expressed as follow 1 setting evaluation function to estimate the value of each node within the fixed search range see equation 17 2 comparing the value of each node and choosing the one with the maximum value to extend in the next step the objective in the heuristic function can be defined as follows 17 c g r e e d y n d i s t p i p s t a r t where the p s t a r t is the start position of mass d i s t p i p s t a r t is the distance between the mass i and the start position at each step 4 2 3 target tracking algorithm 1 evaluation function for target tracking the evaluation function of the adaptive greedy search algorithm in tracking the drifting predicted area is as follows 18 c t r a c k i n g n d i s t p i l o c a r e a where the l o c a r e a is the position of the drifting predicted area d i s t p i l o c a r e a is the spherical distance between the position of mass i and the position of the drifting predicted area at each step 2 line of sight algorithm as mentioned in section 1 target tracking aims at arriving at the drifting predicted area as soon as possible thus we introduce a line of sight algorithm to remove unnecessary tortuous segments if the connection line of mass i path between the position p i k and p i k 1 is not through the barrier nor pass between the shared edge of barriers daniel et al 2010 i e p i k has line of sight to the p i k 1 p i k and p i k 1 are connected directly the pseudocode of the target tracking algorithm is presented in algorithm 2 algorithm 2 target tracking algorithm image 2 4 2 4 coverage search algorithm 1 evaluation function for coverage search if the mass arrive at the drifting predicted area i e reaching the predetermined threshold the coverage search algorithm is called the evaluation function is a weighted sum of the objectives 19 c cov e r a g e n α p o c n β d i s t n where α and β are the weights of the objectives in the function d i s t n is the euclidean distance between node n and its parent node to have the same order of magnitude as the parameter p o c n we make d i s t n dimensionless to efficiently fulfill the coverage search task an adaptive parameter processor is firstly carried out to determine the weights of distance and probability in the evaluation function then the algorithm is applied to an adaptive neighborhood kinematic interpolation is used to smooth the path 2 adaptive parameter processor different settings of evaluation function can lead to varying performances of the adaptive greedy search algorithm thus an adaptive parameter processor is called for balancing the objectives before the proposed algorithm is applied before the coverage search algorithm is called formally the influence of various parameter setting on the results is estimated by an adaptive parameter processor the adaptive parameter processor finds adequate parameter setting which can increase the p o s c u m and limit the t cos t the main process of adaptive parameter processor as follows 1 setting different termination condition one is cumulative pos i e p o s c u m and the other one is estimated consumption time t cos t in coverage search 2 change the evaluation function setting of the coverage search algorithm and applied it to find coverage search path in the search area record the p o s c u m and t cos t of the coverage search path 3 find the relatively optimal setting of evaluation function which can increase the p o s c u m and limit the t cos t the pseudocode of the adaptive parameter processor is provided in algorithm 3 algorithm 3 adaptive parameter processor image 3 3 adaptive search expander the term neighborhood denoted as n g b decides the range that can be explored of the algorithm in each step the higher the value of n g b is the more directions that can be explored in each step and the more number of successor nodes that can be reached chen et al 2016 for example n g b 1 indicates the 8 directions fig 2 a and 8 successor nodes can be explored in each step n g b 3 indicates that the path planning algorithm explores 32 directions and 32 successor nodes in each step shown in fig 2 b when n g b 1 the path planning algorithm may have no expandable nodes in the search range resulting in deadlocks to solve this problem the efficient approach is to expand the range of n g b the larger the value of n g b the more nodes being explored in each step as a result the path is smoother but with a longer calculation time in the proposed algorithm n g b is increased when there are no nodes with the current setting the pseudocode of the adaptive search expander is provided in algorithm 4 algorithm 4 adaptive search expander image 4 4 kinematic interpolation the generated path might be abrupt thus a kinematic interpolation method proposed in long 2015 is adopted for a smooth connection between two segments this interpolation method connects the position p i k and p i k 1 during the sampling time k and k 1 with a smooth trajectory according to the following equations 20 p i t p i k k t v i t d t 21 v i t v i k k t a t d t the acceleration between p i k and p i k 1 is formulated as a linear function of time i e a t b m t substituting a t into equation 20 and equation 21 the states between k and k 1 can be calculated as follows 22 v i t v i k b t k m 2 t k 2 23 p i t p i k v i k t k b 2 t k 2 m 6 t k 3 where v i k v i t v i k 1 is the velocity at k t and k 1 respectively then according to the position and velocity at k and k 1 the coefficient b and m can be solved thus the acceleration between p i k and p i k 1 can be obtained so as the trajectory between them to conclude the pseudocode of the adaptive coverage search algorithm is presented in algorithm 5 algorithm 5 coverage search algorithm image 5 5 simulation experiments in this section a sensitivity analysis of the proposed framework is presented simulation experiments are carried out to illustrate the effectiveness of the proposed method the process includes position prediction target tracking and coverage search are conducted in python on a computer with 64 b intel core i7 9700h cpu with 2 6 ghz frequency 5 1 setup the open water near the chengshantou area is chosen as the study area see fig 3 the red point represents the mob incident position initial position of missing person or p l a s t the sea area near chengshantou is the only way for ships to enter and exit the bohai sea the density of ship traffic in this area is high many fishing boats sail in this area the map is preceded using a 2d cell decomposition of the space the cell size is 0 005 556 m regarding the detective range of infrared cameras the coordinate 37 48 n 122 57 e is set as the reference point to transform the geo coordinate of the positions into the cartesian coordinate system the origin the unit is meter calculated by the spherical distance between position and the reference point the studies on position prediction and path planning are based on the cartesian coordinate system in the following simulations we assume that the mob incident occurred on november 12th 2020 external environment data and the mass that are applied to carry out the search task are given below 1 external environment the wind field data of this sea area are obtained from national maritime search and rescue support system nmsarss according to the weather data of 08 00 a m november 12th to 08 00 a m november 13th the wind speed at 10 m above sea surface is shown in fig 4 the black arrow represents the directions of the wind over time the information of current at 0 5 m below the sea surface is shown in table 1 and fig 5 the directions of the current are represented by the black arrow we adopt the leeway coefficient of survival suit clad person in the water proposed in allen and plourde 1999 related parameters are shown in table 1 2 sar mass fleet a mass lvr 17 is applied as the representative mass of this paper lvr 17 is a small ship equipped with a high definition camera and infrared camera adapted to various sea conditions zhuhai yunzhou intelligent technology co 2020 we assume that the missing person can be found by the ship within the detection range i e pod 1 related technical parameters about lvr 17 are provided in table 2 three mass form a centralized cooperative fleet to operate the sar task after the mob incident happened in the cooperative fleet a decision making mass mass 1 collects and processes data determines the next position and transmits the decision to other mass in the simulations we assume that it takes the cooperative fleet 30 min to prepare before setting off to carry out the search task in the following parts we carry out simulation experiments for sensitivity analysis and a case study in the sensitivity analysis to keep focus on the algorithms obstacles are not considered we compare the impacts of different settings of α β and the coverage search performance of classic and adaptive greedy search algorithms the search area is determined according to the position predicted by the stochastic particle simulation with 1000 particles that drift for 24 h in the case study to be closer to realistic static obstacles are considered such as islands and reefs the sar mass fleet set off from the shore after receiving the mob report with 30 minus preparation related parameters are shown in table 3 5 2 sensitivity analysis of coverage search in this part we design two performance indexes p o s c u m and t cost the influence of the weights in the evaluation function i e α β are analyzed besides through the comparison with the classic greedy search algorithm the superiority of the adaptive greedy search algorithm is demonstrated 5 2 1 influence of α β setting the performance of the coverage search algorithm is influenced by the weights in the evaluation function c coverage n different ratios of α and β result in different t cost and p o s c u m in the proposed framework the weights are set using an adaptive parameter processor this section shows how the adaptive parameter processor works at the same time the influence of α β setting is presented we designed two different cases 1 the same total time case setting t cost 300 minutes as the termination condition and compares with p o s c u m different values of α β 2 the same pos case setting p o s c u m 0 9 as the termination condition and compares t cost with different α β values the results are shown in fig 6 in the same total time case we record the cumulative pos for different α β values correspond to the right y axis of fig 6 in the same pos case we record the estimated consumption time for different α β correspond to the left y axis of fig 6 the high p o s c u m and the small t cost are obtained when α β 1 22 in both cases when α β 22 the curve of same pos and same total time is not always flat the reason for this phenomenon is that the weights indicate the priority of the two objectives in the evaluation function higher α β indicates that the algorithm prefers to find the next position with higher pos however the pos of each cell is stochastic going to a cell of with higher pos does not always guarantee high p o s c u m in the end according to the results in the following simulations the weights of the two objectives in the heuristic function are set as α β 1 5 2 2 comparison of the classic and adaptive greedy search algorithm setting p o s c u m 0 9 as the termination condition a comparison of the paths for an individual mass and the mass fleet calculated by the classic greedy search algorithm and the adaptive method is shown in fig 7 t cost and p o s c u m for each path are given in table 4 in the simulation as the classic greedy search algorithm only considers the poc value and ngb 1 when the mass set off from the start point the classic greedy search algorithm cannot find the node that can lead it to the drift prediction area thus we made the classic greedy search algorithm to select the node closest to the upper right corner before it arrives at the search area i e find the first node with poc value each particle in fig 7 represents a possible position of the missing person the particle distribution in the center of the drifting predicted area is denser than the edges thus the poc of each cell in the center area is higher than the edge the path generated by the adaptive greedy search algorithm reaches the drifting predicted area directly from the starting position and performed a center prioritized coverage search on the contrary the classic greedy search algorithm only contains the poc value of each node the classic method goes to the center directly but encounters a deadlock problem as it cannot find the node to expand with ngb 1 the results given in table 4 show the advantages of the proposed algorithm for both single mass and multi mass cases the proposed greedy search algorithm can find paths with less t cost and more p o s c u m as shown in fig 7 the coverage search path of the proposed algorithm has several sharp turns this phenomenon is reasonable because the resolution of the grid map is 556 m consider the detection range of the detector on board and the ship s maneuverability as shown in table 4 the adaptive greedy search algorithm end without meeting the termination condition the explanation of this accident as follow to ensure that the mass reaches the next waypoint safely and reliably at the specified time 5 min in each step the maximum speed of each mass is limited to 25 kn corresponding to n g b 7 this setting leads to the result that no expandable node in the search range at the last step consequently the algorithm is terminated prematurely 5 3 case study in this section we simulate a mob incident occurs in the chengshantou area occurred on november 12th 2020 two scenarios are analyzed scenario 1 the initial position of the mob is known i e 37 55 n 122 61 e scenario 2 the initial position is unknown but the last know time and position onboard i e t l a s t and p l a s t are known i e p l a s t 37 55 n 122 61 e and t r e a l i z e t l a s t 5 30 60 200 min 5 3 1 cooperative search paths for the mass fleet in scenario 1 1 results of position prediction when the initial time and position of the mob is known the circular normal distribution describes the initial position error of the missing person one thousand particles from a circular normal distribution with 0 5 nm standard deviation start from the reported initial position 37 55 n 122 61 e the particles in the open street map are shown in fig 8 a the coordinate is then converted via calculating the relative spherical distance between each particle and the reference point for subsequential calculation see fig 8 b the stochastic particle simulation is applied to simulate the drift movement of the missing person under the influence of the external marine environment and update the drifting predicted area in real time the drift trajectory of a single particle in 24 h is shown in fig 9 a the sampling interval is 1 h the positions of the 1000 particles drifting for 24 h are shown in fig 9 b the drifting predicted area is generated according to the stochastic particle simulation the probability of the missing person in the search area is calculated via step sized statistic method the number of particles in each change with time as well as the pos fig 10 shows the movement of the particles within 24 h with a sampling interval is 8 h wherein the number indicates the n c of each cell as the pos is calculated by n c fig 10 also provides an insight into the evolution of the probability map 2 results of path planning the decision making mass analyzes the center position of the drifting predicted area at that moment and decision the waypoint in the next step using the proposed target tracking algorithm to show the extreme situation we assume that the cooperative mass set off after the mob incident happened 23 h the collision free target tracking path smoothed with the line of sight algorithm is shown in fig 11 in fig 11 the positions of the drifting predicted area at a different time are represented by gradient colors at that time under the influence of the external marine environment such as wind and current the particles move toward the initial position the sailing speed of the mass exceeds the drift speed of the missing person therefore when the distance between mass and the drifting predicted area reaches the predetermined threshold 556 m we assume that the missing person is nearly stationary then a static probability map at that moment is transmitted for coverage search the whole mob search path including target tracking and coverage search path for the cooperative mass is shown in fig 12 fig 13 is the path smoothed with the kinematic interpolation the p o s c u m of path planning result of the coverage search algorithm is reached 0 907 in 300 min t cost 5 3 2 cooperative search paths for the mass fleet in scenario 2 1 results of position prediction in this scenario the method to predict the drifting area and generate the probability map is the same as scenario 1 however as the accurate mob time is unknown the missing person can fall into the water at any time between t l a s t and t r e a l i z e thus 1000 particles from a circular normal distribution with 0 5 nm standard deviation represent the error in p l a s t the course of the ship is uniformly distributed between 080 and 100 the ship s speed is uniformly distributed between 10kn 12kn the time of mob incident is uniformly distributed between t l a s t and t r e a l i z e in this scenario we set 4 cases with different time intervals between t l a s t and t r e a l i z e see fig 14 under the influence of ship movement and the external disturbances the area of the possible initial positions of the missing person ranges from 3 km 4 km figure 14 a to 80 km 30 km fig 14 d if the crews onboard realize a mob incident occurs faster the area of possible initial positions can be efficiently reduced and therefore the search area can be significantly reduced 2 results of path planning the missing person is drifting when the cooperative fleet is searching in scenario 2 as the range of initial positions become larger the search area becomes larger as well the drifting of the search area has more significant effects than that in scenario 1 thus in scenario 2 a dynamic possibility map changing throughout the sar process is applied for target tracking and coverage search the paths of the mass in the 4 cases shown in fig 14 are presented in figs 15 18 gradient colors represent the position of the drifting predicted area at different time during the coverage search table 5 provides the total search time and the cumulative pos in each case in fig 15 the distance between the east and west boundary of the drifting predicted area is only 4 km as a result the number of the particle of each cell is high almost 100 particles in each cell i e the poc is high the cumulative pos reaches 0 9 within 55 min figs 16 and 17 show that with the increase of time interval between t l a s t and t r e a l i z e the search areas are enlarged and the total search time increases for the first three cases the terminate condition is pos 0 9 however for the case when t r e a l i z e t l a s t 200 m i n u t e s the search area is very large see fig 18 thus in this case we set the maximum time for ship coverage search is 24 h considering the survival time of the person in water united states search and rescue task force 2021 after 24 h search the cumulative pos is only 0 830 5 3 3 performance analysis the coverage search algorithm uses the stochastic particle simulation in real time to update the drifting predicted area in scenario 2 to keep focus we use scenario 1 to analyze the performance of the coverage search algorithm fig 19 shows the total time and time for each module of fifty repeated simulations the time for planning the coverage search path is very short with an average time of 0 055s the target tracking algorithm needs to run the stochastic particle simulation in real time to update the drifting predicted area and thus it needs more time i e average 7 23 s the adaptive parameter processor is kind of brute force and thus it takes the longest but acceptable time i e average 7 82 s 6 discussion 6 1 characteristics of the proposed framework in this paper we introduce a new potential application of mass to support the sar operation we proposed a cooperative path planning framework to search for the missing person in a mob incident using a mass fleet the proposed framework has the following characteristics which make it suitable for mob search 1 the path planning framework consists of a position prediction module to generate a probability map of the missing person s position prediction a target tracking module to follow the drifting prediction area and a coverage search module to search the area with high cumulative pos in a limited time the three modules can fulfill the requirements of path planning for mob searches 2 taking the mob s position probability into account can significantly increase the survival probability of the person however the classic greedy algorithm suffers from the deadlock problem as it goes to the node with maximum pos immediately usually the center of the drifting predicted area in the proposed algorithm we adjust the heuristic function and use an adaptive parameter processor to determine the weights of different objects in the heuristic function for larger pos and shorter total time besides we introduce an adaptive search expander on the one hand this expander is designed because we are using a fleet to search the area on the other hand it helps to break the deadlock 3 different post processing methods are applied to the planned search path the line of sight smoothing is applied to shorten the target tracking path to arrive at the predicted area quickly the kinematic interpolation method is used to obtain a smooth connection between two segments which makes the path easier to follow considering the maneuverability of the mass 6 2 potential of the proposed framework in this paper we assume that the mass fleet used to carry out the mob search are fully autonomous the search process is excited by fully autonomous mass after the mass confirm the position of the missing person it sends information to other manned sar units a unit composed of trained personnel and provided with equipment comes to carry out the rescue task however the proposed framework aims at the planning paths problem which is the first step of sar operations in fact it does not limit the executor according to the imo s definition mass are defined with four degrees of autonomy level 1 ship with automated processes and decision support level 2 remotely controlled ship with seafarers on board level 3 remotely controlled ship without seafarers on board level 4 fully autonomous ship the proposed framework can be extended to path planning for mass with different autonomy levels with adjustments for example with fully autonomous mass we assume that the mass are controlled by robust motion controllers that can accurately track the planned paths under various sea conditions for mass with lower autonomy degrees the influence of the external environment on the motion of the mass should be considered when plannin n t g the path moreover level 1 3 mass involve intensive human machine interactions which means that the human factors cannot be ignored furthermore the proposed framework can be integrated in current sar service the framework provides the position prediction of the missing person and plans the path for target tracking and coverage search supporting the decision making process of the sar personnel a potential concern with the deployment of applying fully autonomous mass or remote controlled mass for sar operation is their legal status now crews onboard can significantly reduce the risk of sar personnel at the same time the absence of a crew on board might raise an issue of legality under the international law of the sea and international maritime law yoo et al 2020 fortunately imo is currently assessing existing imo instruments to see how they might apply to ships with varying degrees of automation through a regulatory scoping exercise on mass sar is included in the list of instruments to be covered in the scoping exercise international maritime organization 2020 therefore we believe that the legal issues will be solved soon and using mass in sar application is promising 7 conclusion in this paper we introduce a new potential application of mass to support the sar operation for mob incidents as the first step we proposed a cooperative path planning framework that consist of three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment forecasting data which determines the search area secondly an adaptive greedy search algorithm is applied to tracking the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation method simulation experiments and sensitivity analysis are carried out to demonstrate the effectiveness of the proposed framework compared with the classic greedy search algorithm the proposed adaptive search algorithm has better coverage search performance in terms of less search time and larger cumulative pos although the proposed framework is designed for mass fleets the planned paths can also be used by the personnel in current sar services this paper is the first step to applying the mass fleet in a sar operation many efforts should be made before using it in reality firstly this paper proposes a centralized cooperative path planning framework for a mass fleet this form is suitable when the mass are from the same sar organization in fact the sar operation in a mob incident is usually carried out by different ships from different authorities such as maritime authorities salvage bureau civil societies and pass by ships these ships are discrete in nature and the decision makers are different to coordinate all the ships can greatly improve the performance of sar operations thus we will consider a discrete framework for the cooperation among heterogenous ships for the next step secondly path planning is the first step to fulfill the mob search tasks autonomously needs the trajectory tracking algorithms besides as we focus on the path planning task in this paper a simplified motion model is used for trajectory tracking precise motion models that describe the maneuverability of the mass will be taken into consideration furthermore in the foreseeable future the core of sar service is still the sar personnel how the proposed framework can be integrated into the sar service and supporting the personnel needs future research credit authorship contribution statement junmin mou methodology resources supervision formal analysis writing original draft tao hu conceptualization methodology investigation writing original draft pengfei chen methodology visualization writing review editing linying chen conceptualization methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is financially supported by the national natural science foundation of china grant no 52001242 and the fundamental research funds for the central universities wut 2021iva051 and 2021ivb020 list of symbols poc the probability of a missing person in a cell pod the possibility of the sar target could be found by the search unit pos the probability of a sar target being successfully rescued n c the number of particles in a cell n t the total number of particles in the search area l o c j position of node j p o c j probability of a missing person in cell j c coverage probability of search unit w sweep width of the search unit d t r a c k the distances between the mass in the fleet x i k 1 the state of mass i at the time step k 1 p i v i a i θ i the position velocity acceleration and heading of mass i r the initial position probability circle radius θ the angle between the probability circle radius and true north μ r mean value of r σ r standard deviation of r μ θ mean value of θ σ θ standard deviation of θ ρ coefficient of association t l a s t the last time when other crew members see the missing person p l a s t last known position t r e a l i z e the moment the crews realize there is a mob incident w i the estimated wind speed of particle i at 10 m above the sea surface w 10 the predicted wind speed at 10 m above the sea surface ξ i the wind speed disturbance of particle i at 10 m above the sea surface σ w i n d the standard deviation of the predicted value of ξ i l d ˆ the vector of leeway downwind a d ˆ the regression coefficient of w i a the slope of the wind speed at 10m above the sea surface τ i random perturbation of the leeway coefficient σ l standard deviation of systematic estimation c i ˆ estimated current speed of particle i at 0 5 m below the sea surface c 0 5 predicted value of the current speed at 0 5 m below the sea surface ξ i the current speed disturbance of particle i at 0 5 m below the sea surface σ c u r r e n t the standard deviation of the predicted value of ξ i v c u r r e n t current induced drift velocity l o c i t the position of the particle i at moment t p s t a r t the start position of mass d i s t p i p s t a r t the distance between the mass i and the start position t cos t estimated consumption time in coverage search p o s c u m cumulative pos l o c a r e a the center position of the drifting predicted area d i s t p i l o c a r e a the spherical distance between the position of mass i and the position of the drifting predicted area n g b search range of path planning algorithm d i s t n euclidean distance between node n and its parent node α β proportional control factor of c cov e r a g e n appendix a supplementary data the following is the supplementary data to this article multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109376 
20515,in a man overboard mob incident a quick and effective search and rescue sar operation is crucial to increase the survival probability of the victim determining the search area and planning paths for the rescue ships are essential for efficient sar operation the search area s determination requires the prediction of the missing person facing the challenges of lacking information about the accurate position and time of falling and the influence of environmental disturbances two main aims of path planning for sar operation are quick arrival at the search area and coverage search with high cumulative possibility of success pos many path planning algorithms have been proposed most of them aim at finding the shortest paths which meet the goal of quick arrival however the path planning for maximizing pos of finding the person is still lacking besides compared to an individual ship a fleet of cooperative maritime autonomous surface ships mass can significantly increase the pos and reduce sar personnel s risk in a time sensitive sar operation therefore in this paper we propose a cooperative path planning framework to search for the missing person in a mob incident using a fleet of fully autonomous mass the framework is divided into three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment forecasting data which determines the search area secondly an adaptive greedy search algorithm is applied to tracking the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation method simulation experiments and sensitivity analysis are carried out to demonstrate the effectiveness of the proposed framework keywords cooperative path planning man overboard multiple mass adaptive greedy algorithm search and rescue 1 introduction maritime autonomous surface ship mass is defined as a ship which to a varying degree can operate independently of human interaction fully autonomous mass have great potential in search and rescue sar operation such as reducing the risk of sar personnel in a dangerous environment among the maritime accidents an increasing number of man overboard mob incidents occur due to the increment of world trade and cruise lines due to the rough sea and temperature of the cold water the person can drown or get hypothermia in a mob incident a quick and effective sar operation is crucial to increase the survival probability of the victim sar is a systematic mission that needs to be planned coordinated controlled and commanded to respond to an emergency yoo et al 2020 sar service includes two main processes search is the operation normally coordinated by a rescue coordination center or rescue subcenter using available personnel and facilities to locate persons in distress rescue is the operation to retrieve persons in distress provide for their initial medical or other needs and deliver them to a place of safety international maritime organization 1979 for most emergencies locating the person is challenging for a mob search the essential is to minimize the expected time and maximize the cumulative probability of success pos over the operation lin and goodrich 2014 two main tasks are the keys throughout the mob search predicting the position of the missing person for determining a search area of limited size planning paths for the rescue ships for quick arrival and coverage search with high cumulative pos for the prediction of the missing person on the one hand the information of accurate falling time and position is unavailable on the other hand influenced by the external environment such as wind wave and current the missing person is drifting thus the possible positions are time varying which also increases the difficulty of search path planning for path planning many path planning algorithms have been proposed such as potential field method khatib 1985 dijkstra s algorithm dijkstra 1959 fast marching sethian 1996 etc most of them aim at finding the shortest paths which meet the goal of quick arrival however the path planning for maximizing pos of finding the person is still lacking unlike the traditional path planning task that plans the shortest collision free path from a start point to end point the coverage path planning cpp calls for a feasible path that increases the cumulative pos within a limited time bourgault et al 2003 yao et al 2019 conventional sar operations use specific strategies to achieve this goal such as parallel track search creeping line search expanding square search and sector search koopman 1957 however those strategies regard the probability of the mob s position as a uniform distribution which is not realistic moreover sar operation is time sensitive taking the mob s position probability into account can significantly increase the survival probability of the person moreover compared to an individual ship greater efficiency and operational capability can be realized by a team of mass chen et al 2018 besides in existing research different unmanned vehicles are suggested to cooperate with each other to play to their strengths in sar operation in the mass and autonomous underwater vehicle auv cooperation system the mass is used to perform an initial large area survey target identification autonomously and the auv search mission is subsequently defined according to the results of the initial survey to provide the precise location of underwater targets and close inspection ferri et al 2015 in the mass and unmanned aerial vehicles uavs cooperation system the uavs are often applied to carry out search tasks because they offer a broader view xiao et al 2017 however in mob search the uavs have some drawbacks firstly the uavs suffer from limited battery life hou et al 2020 secondly uavs are affected more by environmental conditions sea state glare and luminance than mass moreover although a high viewing angle provides a broad view it increases the difficulty of finding a small target in water thus uavs are usually used as assistance helping the sar personnel or cooperating with mass mendonça et al 2016 it is not applicable to include uavs in a fully autonomous search team for a long time moreover in the current situation when unmanned vehicles are used in a sar operation they are remotely controlled by sar personnel rather than carry out the task autonomously in this paper we focus on the search process the first step of carrying out a mob search autonomously is planning the path for the fleet of mass therefore we proposed a cooperative path planning framework to search for the missing person in a mob incident using a fleet of fully autonomous mass the framework is divided into three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment numerical forecasting data that determines the search area secondly an adaptive greedy search algorithm is applied to the fleet to track the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation the main contributions of this paper are as follows 1 a framework for cooperative path planning is proposed for multiple mass to carry out the mob search 2 the stochastic particle simulation is applied to determine the search area and generate the probability map of the mob 3 an adaptive greedy algorithm is proposed for increasing the cumulative pos of the mob in a limited time the remainder of this paper is arranged as follows section 2 provides a literature review on related publications section 3 presents the cooperative path planning framework to search for the missing person in a mob incident in section 4 details of the framework are elaborated in section 5 sensitivity analysis and case study of multi mass path planning in mob search are carried out in section 6 we discuss the role of our framework and the potential of framework in the context of the mass concept and sar operations section 7 concludes the main findings and future research directions 2 literature review 2 1 position prediction the first step of sar operation is to predict the position of the missing person for determining the search area the person in water is usually regarded as a particle the position of the person is influenced by wind and current thus the lagrangian stochastic model that describes the paths of particles in a turbulent flow given knowledge i e statistical description of the random velocity field is often mentioned abascal et al 2015 özgökmen et al 2000 besides to describe the considerable uncertainties during the drifting a monte carlo method that relies on repeated random sampling is often used breivik and allen 2008 the prediction of the position is based on the knowledge about the environmental data such as wind current and wave field many studies on the quantitative and accurate description of environmental forecast data have been carried out for years equipment such as high frequency coastal radars are applied to high precision current data collection abascal et al 2009 models based on historical data are also used shchekinova and kumkar 2015 the uncertainties of the environment forecasting data are usually described by probability distributions breivik et al 2011 2 2 path planning algorithm 2 2 1 shortest path planning the path planning algorithms aim at finding the shortest path which meet the goal of quick arrival for sar operations are classified into three groups graph search based method sampling based method and numerical optimization 1 graph search based method the graph search based method overlays a grid on configuration space and assumes that each configuration corresponds to a grid node two types of search strategies are often used in this category graph traversal algorithms such as depth first search tarjan 1971 and breadth first search bundy and wallen 1984 find the collision free path by traverse from a point to adjacent grid points greedy best first search algorithms pick the best node according to some rule of thumb called a heuristic the representations are heuristic algorithms like the dijkstra 1959 a hart et al 1968 and its variations such as d stentz 1994 and theta daniel et al 2010 heuristic algorithms are widely used for the advantages of easy implementation and time saving for example the a and disktra were used to find the shortest rescue static victim path in the urban flood environment nizami et al 2012 however the graph traversal algorithm is optimal always returns the shortest path while the greedy best first search algorithm results in a feasible path instead of the optimal one 2 sampling based method the sampling based method randomly samples the configuration space or state space and looks for connectivity inside this space gonzalez et al 2016 two widely used sampling based methods in automated vehicles are the probabilistic roadmap method prm and the rapidly exploring random tree rrt the proceeds of prm are divided into learning phase and query phase in the learning phase the continuous space is converted into discrete space and a roadmap is created in the query phase the search algorithm is used to find the collision free path on the roadmap kavraki et al 1996 the rrt is the on line path planning method different from prm rrt allows path planning in semi structured spaces applying the rrt algorithm to find out the shortest path for a group of robots to complete a sar mission is presented in neto et al 2018 3 numerical optimization the optimization method focuses on solving multi objective optimization problems such as minimizing the path length and fuel consumption etc the numerical optimization method is suitable for both static and dynamic environments tavoosi et al 2020 an efficient approach to solve the optimization problem is an evolutionary algorithm that uses mechanisms inspired by biological evolution for example hu and yang 2004 used a genetic algorithm to solve the path planning problem chai et al 2017a 2017b proposed improved differential evolution algorithms to solve the trajectory optimization problem another group of bio inspired algorithms is swarm intelligence algorithms which are based on behavioral models of social creatures like ants bees etc methods like ant colony optimization mohamad et al 2005 and biased particle swarm optimization chai et al 2021 have been used for planning the optimal trajectory for time and energy saving 2 2 2 coverage path planning unlike the traditional path planning task that plans the shortest collision free path from a start point to end point coverage algorithms focus on planning paths for traversing a known area coverage path planning algorithms in existing research can be divided into two groups cellular decomposition and numerical optimization 1 cellular decomposition the processes of cellular decomposition algorithms can be divided into two steps the first step is decomposing the free space into cells and store the decomposition as an adjacency graph the second step is generating the exhaustive path through the adjacency graph galceran and carreras 2013 the primary method considers only convex and joint areas and the path was can be generated by cellular decomposition algorithms queralta et al 2020 such as trapezoidal decomposition choset et al 2005 and boustrophedon decomposition choset 1997 further the generalized boustrophedon decomposition is proposed based on critical points of morse functions i e morse based decomposition acar et al 2002 the morse based decomposition method can handle non polygonal obstacles and can be applied to any dimensional space the grid based method is classified as approximate cellular decomposition for instance the wave front algorithm zelinsky et al 1997 and spiral spanning tree coverage gabriely and rimon 2002 are proposed for grid map coverage path planning 2 numerical optimization setting the coverage task the objective the optimization method can also be used for finding the optimal coverage path the evolution algorithms and swarm intelligence algorithms etc can be used to solve such coverage path planning problems for example the optimal path that considers the robot energy and sensor range limitation is solved by jeddisaravi et al 2016 a hybrid evolutionary algorithm is proposed to find the optimal path obtaining the expected detection time for search tasks in a mob incident du et al 2019 aiming at maximizing the probability of finding a lost target yao et al 2019 designed a framework combining gaussian mixture model and approximation insertion approach using multiple robots can significantly improve the efficiency of coverage search coverage path planning for multiple robots requires cooperation among the agents one way is dividing the area into different parts and each agent is responsible for one part the other is cooperative path planning for example in binney et al 2010 the recursive greedy path planning algorithm is proposed to generate a path for multi robot to gather information of an area 3 methodology in this paper the stochastic particle simulation predicts a missing person s position at sea the step sized statistic method is used to generate a particle distribution map based on the particle distribution map an adaptive greedy search algorithm is proposed to create the target tracking and coverage search paths finally the paths are further smoothed by the line of sight algorithm and the kinematic interpolation the framework is expressed in fig 1 1 position prediction the stochastic particle simulation is used to predicate the position of the missing person and determine the search area the stochastic particle simulation is implemented by the monte carlo method stochastic particle simulation abstracts the search target as an independent particle each particle is assumed to be a mass point with all the motion properties of the search target li et al 2013 after predicting the missing person s position a particle distribution map is generated based on the step sized statistic method 2 target tracking when a mob incident happened the adaptive greedy search algorithm is applied to generate a collision free path for the fleet to track the drifting predicted area the line of sight algorithm is used to smooth and shorten the path 3 coverage search when the distance between the mass and drifting predicted area reaches a predefined threshold the adaptive parameter processor is called to find the relatively optimal setting of the evaluation function for the coverage search algorithm then the coverage search algorithm is used to plan the search path the kinematic interpolation is used to obtain a smooth connection between two segments 4 cooperative path planning for mob search 4 1 position prediction influenced by the external environment such as wind and current the missing person is drifting on the sea surface the predicted position of the missing person determines the search area in the proposed framework the stochastic particle simulation is applied to predict the possible positions of the missing person this method abstracts out the person into an independent particle which is a mass point with all the motion properties of the person by analyzing the disturbance of marine environmental data and the disturbance of leeway the overall drift model of the missing person is established a large number of repeated experiments are then carried out to simulate the drift movement of the missing person i e the so called monte carlo method by recording all particles movement trajectories a search area is determined simultaneously the probability map of the missing person s position can be generated based on the step sized statistic method 4 1 1 initial position errors many factors affect the initial position distribution such as marine environment and meteorology the position and time of mob incident etc if the crews onboard are aware of the mob incident the initial position error of the missing person is small which can reduce the difficulty of sar operation however in practice the mob incident usually occurs without witnesses in the proposed framework we introduce a random error to describe the uncertainty of the initial position if the initial position and time is known a circular normal distribution can be used to describe the initial position error of the missing person li et al 2013 i e 1 f r θ 2 π σ r σ θ 1 ρ 2 1 exp r u r 2 σ r 2 2 ρ r u r θ u θ σ r 2 σ θ 2 θ u θ 2 σ θ 2 2 1 ρ 2 where r is the initial position probability circle radius θ is the angle between the probability circle radius and true north r θ n μ r σ r 2 μ θ σ θ 2 ρ ρ is the coefficient of association if the initial position is unknown the initial position and time can be deduced from known information the last known time denoted as t l a s t and the position denoted as p l a s t that the person is seen onboard the course and speed of the ship during the time interval between t l a s t and the moment the crews realize there is a mob incident denoted as t r e a l i z e in this scenario the mob incident may occur at any time from t l a s t to t r e a l i z e thus in our framework the position prediction of the missing person is calculated in the following way firstly the initial position error still exits following the circular normal distribution as assumed in the above mentioned scenario secondly the moment the mob incident occurs is assumed to follow a uniform distribution thirdly the course and speed of the ship during t l a s t to t r e a l i z e are supposed to follow a uniform distribution lastly combining the possible initial positions the random occur time and ship course and speed the possible positions of the missing person at t r e a l i z e can be calculated 4 1 2 wind and current field the environmental factors being considered in this research are wind and current the wind induced drift of a missing person at sea is represented by leeway i e the relative movement of an object to the surrounding sea due to the wind acting on the water part of the object breivik et al 2011 leeway has a strong linear relationship with wind speed at 10 m above the sea surface allen and plourde 1999 which can be expressed as follows 2 w i w 10 ξ i where w i is the estimated wind speed of particle i at 10 m above sea surface w 10 is the predicted wind speed at 10 m above sea surface ξ i is the wind speed disturbance of particle i at 10 m above the sea surface ξ i obeys a normal distribution with a mathematical expectation of 0 and a variance of σ w i n d 2 denoted as ξ i n 0 σ w i n d 2 two models of leeway are established in allen and plourde 1999 one is the unconstrained leeway model y model and the other one is the constrained wind pressure model 0 model the y model is based on the regression of experiment data however in y model when the wind speed is zero the corresponding leeway value is not zero which does not fit the definition of leeway thus this paper takes the 0 model to describe the motion of a particle 0 model can be expressed as equation 3 because the windage area of a person in the water is small here we only consider the downwind components of leeway 3 l d ˆ a d w i 4 a d ˆ a τ i 10 where l d ˆ is the vector of leeway downwind a d ˆ is the regression coefficient a is the slope of the wind speed at 10m above sea surface τ i is a random perturbation of the leeway coefficient it obeys a normal distribution with a mathematical expectation of 0 and a variance of σ l 2 denoted as τ i n 0 σ l 2 σ l is the standard deviation of systematic estimation the current vector is taken at 0 5 m below the sea surface this coincides with the draft of a typical sar target breivik and allen 2008 the current speed at 0 5 m below the sea surface can be expressed as follows 5 c i ˆ c 0 5 ξ i where c i ˆ is the estimated current speed of particle i at 0 5 m below the sea surface c 0 5 is the predicted value of the current speed at 0 5 m below the sea surface ξ i is the current speed disturbance of particle i at 0 5 m below the sea surface ξ i obeys a normal distribution with a mathematical expectation of 0 and a variance of σ c u r r e n t 2 denoted as ξ i n 0 σ c u r r e n t 2 4 1 3 drift motion model according to the wind and current field the drift velocity vector of a particle in the water can be calculated as follows 6 v d r i f t l d ˆ v c u r r e n t based on the assumptions and simplifications above the overall drift model of the missing person is simplified as follows 7 l o c i t l o c i 0 0 t v d r i f t d t 0 t l d ˆ t v c u r r e n t t d t where l o c i t is the position of the particle i at moment t l o c i 0 is the initial position of the particle i v c u r r e n t is the vector of current induced drift velocity 4 1 4 probability map of the missing person s position as mentioned pos is used to describe the probability of a sar target being successfully rescued which is the key indicator in sar operation the pos depends on two indicators the probability of containment poc and the probability of detection pod wei et al 2020 8 p o s p o c p o d the search area is decomposed into cells the size of the cells is based on the onboard detection equipment s ability the poc represents the probability of a missing person in a cell agbissoh otote et al 2019 using particles to represent the possible positions of the missing person the poc is calculated as follows 9 p o c n c n t where n c is the number of particles in a cell is the total number of particles in the search area in the proposed path planning algorithm the state of cell j is represented by the state of node j the state of node j can be expressed as follow 10 l o c j p o c j where l o c j is the position of node j which is the center position of the cell j p o c j represents the probability of a missing person in cell j the pod represents the possibility of the sar target could be found by the search unit which can be expressed in equation 11 abi zeid and doyon 2003 11 p o d 1 e c 12 c w d t r a c k where c is the coverage probability of the search unit w is the sweep width and it has a strong relationship with the different detectors search environment and types of search objects d t r a c k is the track spacing and it depends on the search pattern with the monte carlo simulation all the predicted positions of the missing person are acquired using the step sized statistic method to calculate the poc of each cell in the search area the possibility map of the position is generated to sum up the pseudocode of the position prediction algorithm is shown as algorithm 1 algorithm 1 position prediction algorithm based on stochastic particle simulation image 1 4 2 target tracking and coverage search after the probability map is generated the path planning algorithm is applied to find the sar operation path subsequently in this section we firstly introduce the motion model of the mass for the mob search secondly the classical greedy search algorithm is introduced thirdly the greedy search algorithm with line of sight smoothing is used for target tracking at the end the adaptive greedy algorithm for coverage search is presented the main modifications 1 an adaptive parameter processor is developed to find the relatively optimal setting of the evaluation function 2 the search range is adaptive 4 2 1 motion models of the mass in the path planning framework a mass is simplified to a mass point and considers its movement on a two dimensional plane whose motion is expressed as a linear discrete time model 13 x i k 1 p i k 1 v i k 1 a i k 1 θ i k 1 p i k v i k δ t 1 2 a i k δ t 2 v i k a i k δ t a i k 1 θ i k 1 where x i k 1 is the state of mass i at the time step k 1 p i v i a i and θ i are the position velocity acceleration and heading of mass i respectively the mass is subject to constraints like the maximum acceleration and speed due to the limitation of the dynamic system and hull structure i e 14 v min v i k 2 v max 15 a min a i k 2 a max where 2 is the euclidean norm as in the mob search task the mass in the fleet carries out the search task with a constant configuration therefore the distances between the mass are constant d i e 16 p i p j d 4 2 2 greedy search algorithm the greedy search algorithm is widely used in vehicle path planning studies liu et al 2016 the basic idea of greedy search algorithm can be expressed as follow 1 setting evaluation function to estimate the value of each node within the fixed search range see equation 17 2 comparing the value of each node and choosing the one with the maximum value to extend in the next step the objective in the heuristic function can be defined as follows 17 c g r e e d y n d i s t p i p s t a r t where the p s t a r t is the start position of mass d i s t p i p s t a r t is the distance between the mass i and the start position at each step 4 2 3 target tracking algorithm 1 evaluation function for target tracking the evaluation function of the adaptive greedy search algorithm in tracking the drifting predicted area is as follows 18 c t r a c k i n g n d i s t p i l o c a r e a where the l o c a r e a is the position of the drifting predicted area d i s t p i l o c a r e a is the spherical distance between the position of mass i and the position of the drifting predicted area at each step 2 line of sight algorithm as mentioned in section 1 target tracking aims at arriving at the drifting predicted area as soon as possible thus we introduce a line of sight algorithm to remove unnecessary tortuous segments if the connection line of mass i path between the position p i k and p i k 1 is not through the barrier nor pass between the shared edge of barriers daniel et al 2010 i e p i k has line of sight to the p i k 1 p i k and p i k 1 are connected directly the pseudocode of the target tracking algorithm is presented in algorithm 2 algorithm 2 target tracking algorithm image 2 4 2 4 coverage search algorithm 1 evaluation function for coverage search if the mass arrive at the drifting predicted area i e reaching the predetermined threshold the coverage search algorithm is called the evaluation function is a weighted sum of the objectives 19 c cov e r a g e n α p o c n β d i s t n where α and β are the weights of the objectives in the function d i s t n is the euclidean distance between node n and its parent node to have the same order of magnitude as the parameter p o c n we make d i s t n dimensionless to efficiently fulfill the coverage search task an adaptive parameter processor is firstly carried out to determine the weights of distance and probability in the evaluation function then the algorithm is applied to an adaptive neighborhood kinematic interpolation is used to smooth the path 2 adaptive parameter processor different settings of evaluation function can lead to varying performances of the adaptive greedy search algorithm thus an adaptive parameter processor is called for balancing the objectives before the proposed algorithm is applied before the coverage search algorithm is called formally the influence of various parameter setting on the results is estimated by an adaptive parameter processor the adaptive parameter processor finds adequate parameter setting which can increase the p o s c u m and limit the t cos t the main process of adaptive parameter processor as follows 1 setting different termination condition one is cumulative pos i e p o s c u m and the other one is estimated consumption time t cos t in coverage search 2 change the evaluation function setting of the coverage search algorithm and applied it to find coverage search path in the search area record the p o s c u m and t cos t of the coverage search path 3 find the relatively optimal setting of evaluation function which can increase the p o s c u m and limit the t cos t the pseudocode of the adaptive parameter processor is provided in algorithm 3 algorithm 3 adaptive parameter processor image 3 3 adaptive search expander the term neighborhood denoted as n g b decides the range that can be explored of the algorithm in each step the higher the value of n g b is the more directions that can be explored in each step and the more number of successor nodes that can be reached chen et al 2016 for example n g b 1 indicates the 8 directions fig 2 a and 8 successor nodes can be explored in each step n g b 3 indicates that the path planning algorithm explores 32 directions and 32 successor nodes in each step shown in fig 2 b when n g b 1 the path planning algorithm may have no expandable nodes in the search range resulting in deadlocks to solve this problem the efficient approach is to expand the range of n g b the larger the value of n g b the more nodes being explored in each step as a result the path is smoother but with a longer calculation time in the proposed algorithm n g b is increased when there are no nodes with the current setting the pseudocode of the adaptive search expander is provided in algorithm 4 algorithm 4 adaptive search expander image 4 4 kinematic interpolation the generated path might be abrupt thus a kinematic interpolation method proposed in long 2015 is adopted for a smooth connection between two segments this interpolation method connects the position p i k and p i k 1 during the sampling time k and k 1 with a smooth trajectory according to the following equations 20 p i t p i k k t v i t d t 21 v i t v i k k t a t d t the acceleration between p i k and p i k 1 is formulated as a linear function of time i e a t b m t substituting a t into equation 20 and equation 21 the states between k and k 1 can be calculated as follows 22 v i t v i k b t k m 2 t k 2 23 p i t p i k v i k t k b 2 t k 2 m 6 t k 3 where v i k v i t v i k 1 is the velocity at k t and k 1 respectively then according to the position and velocity at k and k 1 the coefficient b and m can be solved thus the acceleration between p i k and p i k 1 can be obtained so as the trajectory between them to conclude the pseudocode of the adaptive coverage search algorithm is presented in algorithm 5 algorithm 5 coverage search algorithm image 5 5 simulation experiments in this section a sensitivity analysis of the proposed framework is presented simulation experiments are carried out to illustrate the effectiveness of the proposed method the process includes position prediction target tracking and coverage search are conducted in python on a computer with 64 b intel core i7 9700h cpu with 2 6 ghz frequency 5 1 setup the open water near the chengshantou area is chosen as the study area see fig 3 the red point represents the mob incident position initial position of missing person or p l a s t the sea area near chengshantou is the only way for ships to enter and exit the bohai sea the density of ship traffic in this area is high many fishing boats sail in this area the map is preceded using a 2d cell decomposition of the space the cell size is 0 005 556 m regarding the detective range of infrared cameras the coordinate 37 48 n 122 57 e is set as the reference point to transform the geo coordinate of the positions into the cartesian coordinate system the origin the unit is meter calculated by the spherical distance between position and the reference point the studies on position prediction and path planning are based on the cartesian coordinate system in the following simulations we assume that the mob incident occurred on november 12th 2020 external environment data and the mass that are applied to carry out the search task are given below 1 external environment the wind field data of this sea area are obtained from national maritime search and rescue support system nmsarss according to the weather data of 08 00 a m november 12th to 08 00 a m november 13th the wind speed at 10 m above sea surface is shown in fig 4 the black arrow represents the directions of the wind over time the information of current at 0 5 m below the sea surface is shown in table 1 and fig 5 the directions of the current are represented by the black arrow we adopt the leeway coefficient of survival suit clad person in the water proposed in allen and plourde 1999 related parameters are shown in table 1 2 sar mass fleet a mass lvr 17 is applied as the representative mass of this paper lvr 17 is a small ship equipped with a high definition camera and infrared camera adapted to various sea conditions zhuhai yunzhou intelligent technology co 2020 we assume that the missing person can be found by the ship within the detection range i e pod 1 related technical parameters about lvr 17 are provided in table 2 three mass form a centralized cooperative fleet to operate the sar task after the mob incident happened in the cooperative fleet a decision making mass mass 1 collects and processes data determines the next position and transmits the decision to other mass in the simulations we assume that it takes the cooperative fleet 30 min to prepare before setting off to carry out the search task in the following parts we carry out simulation experiments for sensitivity analysis and a case study in the sensitivity analysis to keep focus on the algorithms obstacles are not considered we compare the impacts of different settings of α β and the coverage search performance of classic and adaptive greedy search algorithms the search area is determined according to the position predicted by the stochastic particle simulation with 1000 particles that drift for 24 h in the case study to be closer to realistic static obstacles are considered such as islands and reefs the sar mass fleet set off from the shore after receiving the mob report with 30 minus preparation related parameters are shown in table 3 5 2 sensitivity analysis of coverage search in this part we design two performance indexes p o s c u m and t cost the influence of the weights in the evaluation function i e α β are analyzed besides through the comparison with the classic greedy search algorithm the superiority of the adaptive greedy search algorithm is demonstrated 5 2 1 influence of α β setting the performance of the coverage search algorithm is influenced by the weights in the evaluation function c coverage n different ratios of α and β result in different t cost and p o s c u m in the proposed framework the weights are set using an adaptive parameter processor this section shows how the adaptive parameter processor works at the same time the influence of α β setting is presented we designed two different cases 1 the same total time case setting t cost 300 minutes as the termination condition and compares with p o s c u m different values of α β 2 the same pos case setting p o s c u m 0 9 as the termination condition and compares t cost with different α β values the results are shown in fig 6 in the same total time case we record the cumulative pos for different α β values correspond to the right y axis of fig 6 in the same pos case we record the estimated consumption time for different α β correspond to the left y axis of fig 6 the high p o s c u m and the small t cost are obtained when α β 1 22 in both cases when α β 22 the curve of same pos and same total time is not always flat the reason for this phenomenon is that the weights indicate the priority of the two objectives in the evaluation function higher α β indicates that the algorithm prefers to find the next position with higher pos however the pos of each cell is stochastic going to a cell of with higher pos does not always guarantee high p o s c u m in the end according to the results in the following simulations the weights of the two objectives in the heuristic function are set as α β 1 5 2 2 comparison of the classic and adaptive greedy search algorithm setting p o s c u m 0 9 as the termination condition a comparison of the paths for an individual mass and the mass fleet calculated by the classic greedy search algorithm and the adaptive method is shown in fig 7 t cost and p o s c u m for each path are given in table 4 in the simulation as the classic greedy search algorithm only considers the poc value and ngb 1 when the mass set off from the start point the classic greedy search algorithm cannot find the node that can lead it to the drift prediction area thus we made the classic greedy search algorithm to select the node closest to the upper right corner before it arrives at the search area i e find the first node with poc value each particle in fig 7 represents a possible position of the missing person the particle distribution in the center of the drifting predicted area is denser than the edges thus the poc of each cell in the center area is higher than the edge the path generated by the adaptive greedy search algorithm reaches the drifting predicted area directly from the starting position and performed a center prioritized coverage search on the contrary the classic greedy search algorithm only contains the poc value of each node the classic method goes to the center directly but encounters a deadlock problem as it cannot find the node to expand with ngb 1 the results given in table 4 show the advantages of the proposed algorithm for both single mass and multi mass cases the proposed greedy search algorithm can find paths with less t cost and more p o s c u m as shown in fig 7 the coverage search path of the proposed algorithm has several sharp turns this phenomenon is reasonable because the resolution of the grid map is 556 m consider the detection range of the detector on board and the ship s maneuverability as shown in table 4 the adaptive greedy search algorithm end without meeting the termination condition the explanation of this accident as follow to ensure that the mass reaches the next waypoint safely and reliably at the specified time 5 min in each step the maximum speed of each mass is limited to 25 kn corresponding to n g b 7 this setting leads to the result that no expandable node in the search range at the last step consequently the algorithm is terminated prematurely 5 3 case study in this section we simulate a mob incident occurs in the chengshantou area occurred on november 12th 2020 two scenarios are analyzed scenario 1 the initial position of the mob is known i e 37 55 n 122 61 e scenario 2 the initial position is unknown but the last know time and position onboard i e t l a s t and p l a s t are known i e p l a s t 37 55 n 122 61 e and t r e a l i z e t l a s t 5 30 60 200 min 5 3 1 cooperative search paths for the mass fleet in scenario 1 1 results of position prediction when the initial time and position of the mob is known the circular normal distribution describes the initial position error of the missing person one thousand particles from a circular normal distribution with 0 5 nm standard deviation start from the reported initial position 37 55 n 122 61 e the particles in the open street map are shown in fig 8 a the coordinate is then converted via calculating the relative spherical distance between each particle and the reference point for subsequential calculation see fig 8 b the stochastic particle simulation is applied to simulate the drift movement of the missing person under the influence of the external marine environment and update the drifting predicted area in real time the drift trajectory of a single particle in 24 h is shown in fig 9 a the sampling interval is 1 h the positions of the 1000 particles drifting for 24 h are shown in fig 9 b the drifting predicted area is generated according to the stochastic particle simulation the probability of the missing person in the search area is calculated via step sized statistic method the number of particles in each change with time as well as the pos fig 10 shows the movement of the particles within 24 h with a sampling interval is 8 h wherein the number indicates the n c of each cell as the pos is calculated by n c fig 10 also provides an insight into the evolution of the probability map 2 results of path planning the decision making mass analyzes the center position of the drifting predicted area at that moment and decision the waypoint in the next step using the proposed target tracking algorithm to show the extreme situation we assume that the cooperative mass set off after the mob incident happened 23 h the collision free target tracking path smoothed with the line of sight algorithm is shown in fig 11 in fig 11 the positions of the drifting predicted area at a different time are represented by gradient colors at that time under the influence of the external marine environment such as wind and current the particles move toward the initial position the sailing speed of the mass exceeds the drift speed of the missing person therefore when the distance between mass and the drifting predicted area reaches the predetermined threshold 556 m we assume that the missing person is nearly stationary then a static probability map at that moment is transmitted for coverage search the whole mob search path including target tracking and coverage search path for the cooperative mass is shown in fig 12 fig 13 is the path smoothed with the kinematic interpolation the p o s c u m of path planning result of the coverage search algorithm is reached 0 907 in 300 min t cost 5 3 2 cooperative search paths for the mass fleet in scenario 2 1 results of position prediction in this scenario the method to predict the drifting area and generate the probability map is the same as scenario 1 however as the accurate mob time is unknown the missing person can fall into the water at any time between t l a s t and t r e a l i z e thus 1000 particles from a circular normal distribution with 0 5 nm standard deviation represent the error in p l a s t the course of the ship is uniformly distributed between 080 and 100 the ship s speed is uniformly distributed between 10kn 12kn the time of mob incident is uniformly distributed between t l a s t and t r e a l i z e in this scenario we set 4 cases with different time intervals between t l a s t and t r e a l i z e see fig 14 under the influence of ship movement and the external disturbances the area of the possible initial positions of the missing person ranges from 3 km 4 km figure 14 a to 80 km 30 km fig 14 d if the crews onboard realize a mob incident occurs faster the area of possible initial positions can be efficiently reduced and therefore the search area can be significantly reduced 2 results of path planning the missing person is drifting when the cooperative fleet is searching in scenario 2 as the range of initial positions become larger the search area becomes larger as well the drifting of the search area has more significant effects than that in scenario 1 thus in scenario 2 a dynamic possibility map changing throughout the sar process is applied for target tracking and coverage search the paths of the mass in the 4 cases shown in fig 14 are presented in figs 15 18 gradient colors represent the position of the drifting predicted area at different time during the coverage search table 5 provides the total search time and the cumulative pos in each case in fig 15 the distance between the east and west boundary of the drifting predicted area is only 4 km as a result the number of the particle of each cell is high almost 100 particles in each cell i e the poc is high the cumulative pos reaches 0 9 within 55 min figs 16 and 17 show that with the increase of time interval between t l a s t and t r e a l i z e the search areas are enlarged and the total search time increases for the first three cases the terminate condition is pos 0 9 however for the case when t r e a l i z e t l a s t 200 m i n u t e s the search area is very large see fig 18 thus in this case we set the maximum time for ship coverage search is 24 h considering the survival time of the person in water united states search and rescue task force 2021 after 24 h search the cumulative pos is only 0 830 5 3 3 performance analysis the coverage search algorithm uses the stochastic particle simulation in real time to update the drifting predicted area in scenario 2 to keep focus we use scenario 1 to analyze the performance of the coverage search algorithm fig 19 shows the total time and time for each module of fifty repeated simulations the time for planning the coverage search path is very short with an average time of 0 055s the target tracking algorithm needs to run the stochastic particle simulation in real time to update the drifting predicted area and thus it needs more time i e average 7 23 s the adaptive parameter processor is kind of brute force and thus it takes the longest but acceptable time i e average 7 82 s 6 discussion 6 1 characteristics of the proposed framework in this paper we introduce a new potential application of mass to support the sar operation we proposed a cooperative path planning framework to search for the missing person in a mob incident using a mass fleet the proposed framework has the following characteristics which make it suitable for mob search 1 the path planning framework consists of a position prediction module to generate a probability map of the missing person s position prediction a target tracking module to follow the drifting prediction area and a coverage search module to search the area with high cumulative pos in a limited time the three modules can fulfill the requirements of path planning for mob searches 2 taking the mob s position probability into account can significantly increase the survival probability of the person however the classic greedy algorithm suffers from the deadlock problem as it goes to the node with maximum pos immediately usually the center of the drifting predicted area in the proposed algorithm we adjust the heuristic function and use an adaptive parameter processor to determine the weights of different objects in the heuristic function for larger pos and shorter total time besides we introduce an adaptive search expander on the one hand this expander is designed because we are using a fleet to search the area on the other hand it helps to break the deadlock 3 different post processing methods are applied to the planned search path the line of sight smoothing is applied to shorten the target tracking path to arrive at the predicted area quickly the kinematic interpolation method is used to obtain a smooth connection between two segments which makes the path easier to follow considering the maneuverability of the mass 6 2 potential of the proposed framework in this paper we assume that the mass fleet used to carry out the mob search are fully autonomous the search process is excited by fully autonomous mass after the mass confirm the position of the missing person it sends information to other manned sar units a unit composed of trained personnel and provided with equipment comes to carry out the rescue task however the proposed framework aims at the planning paths problem which is the first step of sar operations in fact it does not limit the executor according to the imo s definition mass are defined with four degrees of autonomy level 1 ship with automated processes and decision support level 2 remotely controlled ship with seafarers on board level 3 remotely controlled ship without seafarers on board level 4 fully autonomous ship the proposed framework can be extended to path planning for mass with different autonomy levels with adjustments for example with fully autonomous mass we assume that the mass are controlled by robust motion controllers that can accurately track the planned paths under various sea conditions for mass with lower autonomy degrees the influence of the external environment on the motion of the mass should be considered when plannin n t g the path moreover level 1 3 mass involve intensive human machine interactions which means that the human factors cannot be ignored furthermore the proposed framework can be integrated in current sar service the framework provides the position prediction of the missing person and plans the path for target tracking and coverage search supporting the decision making process of the sar personnel a potential concern with the deployment of applying fully autonomous mass or remote controlled mass for sar operation is their legal status now crews onboard can significantly reduce the risk of sar personnel at the same time the absence of a crew on board might raise an issue of legality under the international law of the sea and international maritime law yoo et al 2020 fortunately imo is currently assessing existing imo instruments to see how they might apply to ships with varying degrees of automation through a regulatory scoping exercise on mass sar is included in the list of instruments to be covered in the scoping exercise international maritime organization 2020 therefore we believe that the legal issues will be solved soon and using mass in sar application is promising 7 conclusion in this paper we introduce a new potential application of mass to support the sar operation for mob incidents as the first step we proposed a cooperative path planning framework that consist of three modules i e position prediction target tracking and coverage search firstly the stochastic particle simulation method is used to predict the missing person s position considering the environment forecasting data which determines the search area secondly an adaptive greedy search algorithm is applied to tracking the drifting predicted area thirdly the coverage search algorithm is designed with an adaptive neighborhood and evaluation function for increasing the cumulative pos in a limited time moreover the path is smoothed by the line of sight algorithm and the kinematic interpolation method simulation experiments and sensitivity analysis are carried out to demonstrate the effectiveness of the proposed framework compared with the classic greedy search algorithm the proposed adaptive search algorithm has better coverage search performance in terms of less search time and larger cumulative pos although the proposed framework is designed for mass fleets the planned paths can also be used by the personnel in current sar services this paper is the first step to applying the mass fleet in a sar operation many efforts should be made before using it in reality firstly this paper proposes a centralized cooperative path planning framework for a mass fleet this form is suitable when the mass are from the same sar organization in fact the sar operation in a mob incident is usually carried out by different ships from different authorities such as maritime authorities salvage bureau civil societies and pass by ships these ships are discrete in nature and the decision makers are different to coordinate all the ships can greatly improve the performance of sar operations thus we will consider a discrete framework for the cooperation among heterogenous ships for the next step secondly path planning is the first step to fulfill the mob search tasks autonomously needs the trajectory tracking algorithms besides as we focus on the path planning task in this paper a simplified motion model is used for trajectory tracking precise motion models that describe the maneuverability of the mass will be taken into consideration furthermore in the foreseeable future the core of sar service is still the sar personnel how the proposed framework can be integrated into the sar service and supporting the personnel needs future research credit authorship contribution statement junmin mou methodology resources supervision formal analysis writing original draft tao hu conceptualization methodology investigation writing original draft pengfei chen methodology visualization writing review editing linying chen conceptualization methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is financially supported by the national natural science foundation of china grant no 52001242 and the fundamental research funds for the central universities wut 2021iva051 and 2021ivb020 list of symbols poc the probability of a missing person in a cell pod the possibility of the sar target could be found by the search unit pos the probability of a sar target being successfully rescued n c the number of particles in a cell n t the total number of particles in the search area l o c j position of node j p o c j probability of a missing person in cell j c coverage probability of search unit w sweep width of the search unit d t r a c k the distances between the mass in the fleet x i k 1 the state of mass i at the time step k 1 p i v i a i θ i the position velocity acceleration and heading of mass i r the initial position probability circle radius θ the angle between the probability circle radius and true north μ r mean value of r σ r standard deviation of r μ θ mean value of θ σ θ standard deviation of θ ρ coefficient of association t l a s t the last time when other crew members see the missing person p l a s t last known position t r e a l i z e the moment the crews realize there is a mob incident w i the estimated wind speed of particle i at 10 m above the sea surface w 10 the predicted wind speed at 10 m above the sea surface ξ i the wind speed disturbance of particle i at 10 m above the sea surface σ w i n d the standard deviation of the predicted value of ξ i l d ˆ the vector of leeway downwind a d ˆ the regression coefficient of w i a the slope of the wind speed at 10m above the sea surface τ i random perturbation of the leeway coefficient σ l standard deviation of systematic estimation c i ˆ estimated current speed of particle i at 0 5 m below the sea surface c 0 5 predicted value of the current speed at 0 5 m below the sea surface ξ i the current speed disturbance of particle i at 0 5 m below the sea surface σ c u r r e n t the standard deviation of the predicted value of ξ i v c u r r e n t current induced drift velocity l o c i t the position of the particle i at moment t p s t a r t the start position of mass d i s t p i p s t a r t the distance between the mass i and the start position t cos t estimated consumption time in coverage search p o s c u m cumulative pos l o c a r e a the center position of the drifting predicted area d i s t p i l o c a r e a the spherical distance between the position of mass i and the position of the drifting predicted area n g b search range of path planning algorithm d i s t n euclidean distance between node n and its parent node α β proportional control factor of c cov e r a g e n appendix a supplementary data the following is the supplementary data to this article multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 109376 
20516,a high reliability low cost buoy chain sprocket wave energy capture device is proposed resonance theory is used to improve its wave energy capture efficiency and reduce its cost the testing principle of the buoy chain sprocket model is proposed and comparable resonant and nonresonant experimental floating body models were constructed based on finite depth linear wave theory and the resonance principle then the methods and results of the model experiments are described based on using morison equation to calculate wave load simulation and verification of the model experiment were conducted by using aqwa and orcaflex software finally to eliminate the size effect and the impact of one way wave energy collection based on the simulation technology described above sea state prototype models of resonant and nonresonant buoy chain sprocket wave energy capture devices with one way and two way acquisition characteristics were constructed simulations were then conducted to get the maximum wave energy gathering efficiency the research result indicates that the nonresonant buoy chain sprocket wave energy capture device with one way acquisition has higher wave energy capture efficiency than the resonant buoy chain sprocket wave energy capture device keywords wave energy oscillating buoy resonance technology buoy chain sprocket wave energy capture efficiency 1 introduction owing to the advantages of large reserves wide distribution high energy flow density greenness and sustainability wave energy has attracted increasing attention from human society kofoed et al 2005 leijon et al 2006 at present there are many types of wave energy capture devices from the perspective of wave energy capture technology these can be mainly divided into oscillating water column type raft type contracting wave channel type oscillating float type duck type and pendulum type you et al 2010 among them the oscillating float type is a keen interest in the field of wave energy research because of its simple and reliable structure low manufacturing and deployment maintenance costs and high efficiency song et al 2012 sheng et al 2013 high reliability and low cost are the two main decisive indicators of the maturity of wave energy capture technology high reliability mainly depends on the primary collection principle and structure of the wave energy capture device in addition to effectively reducing the cost of manufacturing deployment and subsequent maintenance of wave energy devices low cost mainly depends on the first level collection efficiency of wave energy capture devices the oscillating float wave energy capture device forms a damped forced vibration system with seawater and waves in which waves are the excitation source yeung 1981 wu et al 2013 using resonance theory can effectively improve the wave energy capture efficiency of an oscillating float wave energy capture device which was first proposed by budar and falnes 1975a 1975b they proposed an oscillating float type wave energy capture device composed of large and small floating bodies and fixed pulleys the natural frequency of the system can be adjusted by using a flywheel with an adjustable moment of inertia when the natural frequency of the device is equal to the natural frequency of the wave and the mechanical load resistance equals the radiation resistance the system is in resonance and the device has the highest wave energy capture efficiency at this time this view derived from the specific oscillating float wave energy capture device was corroborated by many later documents and became a consensus in the field of wave energy research analysis and comparison of the numerical calculation methods of the oscillating float wave energy capture device indicated that the maximum wave energy capture power occurs near the resonance point li and yu 2012 dai dai et al 2017 proposed a double sphere oscillating float wave energy capture device and a model experiment of the device showed that the maximum wave energy capture power occurred near the resonance point cai cai et al 2017 proposed an oscillating float wave energy capture device equipped with an active resonance system inside the float and the numerical simulation results showed that resonance technology can effectively improve the capture power of the device however in recent years some studies have presented different views in a study of the optimisation method of the oscillating float wave energy capture device it was found through numerical calculations that the optimised maximum conversion power does not occur at the resonance point wu et al 2010 shi shi et al 2014 designed a combined oscillating float wave power generation device in their model experiment study it was found that when the incident wave frequency equals the float resonance frequency the model output power is not maximum based on the research of buoy rope drum wave energy capture devices zhu et al 2019 a new type of buoy chain sprocket wave energy capture device is proposed because this scheme is still an oscillating float wave energy capture scheme so resonance technology is used to improve its wave energy capture efficiency therefore the intent of the present study is to construct comparable resonant and nonresonant experimental floating body models based on finite depth linear wave theory the morrison equation and the resonance principle model experiments and hydrodynamic simulations are then used to study the methods of improving the capture efficiency of the buoy chain sprocket wave energy capture device 2 new type of buoy chain sprocket wave energy capture technology the new type of buoy chain sprocket wave energy capture device zhu et al 2019a zhu et al 2019b is mainly composed of a floating body chain sprocket guide rod mechanism gravity anchor anchor chain hydraulic system and power generation system as shown in fig 1 the gravity anchor is laid on the seabed the bottom end of the guide rod is connected to the anchor stone through a spherical hinge pair the top of the guide rod is connected to the chain the other end of the chain is fixed on the top of the floating body the fixed sprocket is fixed on the top of the floating body and the movable sprocket is connected to the piston rod of the hydraulic cylinder the hydraulic cylinder is built into the protective tube the guide rod is built into the duct the duct is firmly connected to the floating body and rollers are installed on the inner side of the lower end of the duct and the outer side of the upper end of the guide rod therefore the guide rod and the duct constituted a rolling pair under the effect of the wave load the floating body of the buoy chain sprocket wave energy capture device mainly produces oscillating motion along the guide rod and pitching motion around the spherical joint when the floating body floats upward along the guide rod the chain pulls up the piston rod of the hydraulic cylinder through the sprocket the hydraulic cylinder produces high pressure oil the high pressure oil drives the hydraulic motor after being buffered by energy storage and the hydraulic motor drives the generator to generate electricity when the floating body sinks along the guide rod the piston of the hydraulic cylinder moves back under the action of low pressure oil and drives the piston rod to retract the chain this process does not capture wave energy therefore the buoy chain sprocket wave energy capture device has the characteristic of one way wave energy capture the pitching movement of the floating body around the ball joint does not collect wave energy but only achieves buffering to ensure the reliability of the device because the inlet and outlet pressures of the hydraulic cylinder are constant the first level wave energy collection of the buoy chain sprocket wave energy capture device has the characteristics of constant load damping and constant chain retraction force compared with the previous buoy rope drum wave energy capture device zhu et al 2019 this new type of buoy chain sprocket wave energy capture device has the following advantages 1 the hydraulic cylinder load replaces the direct drive generator load thereby eliminating the load moment on the rope and reel and completely eliminating abrasion between the rope and reel 2 the hydraulic chain retraction scheme replaces the spring rope retraction scheme it not only has a compact structure but also has a large chain retraction force and long fatigue life 3 a rolling moving pair consisting of a guide rod and a duct replaces the rope guide parts thereby completely eliminating the contact wear of the rope in summary this new type of buoy chain sprocket wave energy capture technology inherits the advantages of the early buoy rope drum device of simple structure low cost and high efficiency it also overcomes the reliability problems of early buoy rope drum devices such as rope wear and short fatigue life of the rope retraction spring moreover because the chain retraction force is greatly increased and becomes adjustable this not only ensures the timely recovery of the chain but also provides a basis for further improvement of the wave energy capture efficiency 3 theoretical basis 3 1 wave theory 3 1 1 selection of wave energy flow calculation formula the wave energy flow calculation formula should be determined by the wave type and the wave type is determined according to the wave condition parameters wang and liang 2013 the wave types of the model experiment and the proposed sea state experiment of full scale prototype were determined and these are listed in table 1 the wave condition of the full scale prototype simulations is determined based on the common wave condition in the sea area of the prototype experiment based on the wave making capacity of existing indoor wave tank the wave period of physical model experiment should be equal to the natural period of the resonant model in order to ensure the normal wave energy collection of the two types of physical models the wave height and water depth are determined by the resonant physical model the wave energy flow calculation formula for a finite water depth linear wave is 1 e w 1 32 π ρ g 2 h 2 t d tanh k d 1 2 k d sinh 2 k d where ρ is the density of seawater in units of kg m3 g is the acceleration of gravity in units of m s2 h is the wave height in units of m t is the wave cycle in units of s d is the diameter of the floating body in units of m k is the wavenumber and d is the water depth in units of m 3 1 2 selection of the method of wave load calculation the method for selecting the wave load calculation should be determined according to the wave condition parameters and the characteristic size of the corresponding floating body wang and liang 2013 the choices of wave load calculation method for the physical model experiment and the proposed sea state experiment are given in table 2 3 2 resonance theory when the mechanical vibration system is underdamped and the external excitation frequency is equal to the natural frequency of the system the amplitude of the forced vibration reaches its maximum value which is called resonance therefore a resonance system can be constructed by changing the excitation source frequency or the natural frequency of the system to make them equal fig 2 shows the resonance characteristic curves of a single degree of freedom forced vibration system in the figure β is the dynamic amplification factor which represents the ratio of the amplitude of the forced vibration to the static deviation λ is the frequency ratio which is the ratio of the circular frequency of the exciting force to the natural frequency of the system and ζ is the damping ratio which reflects the damping characteristics of the vibration system and is defined as wang and cao 2010 2 ζ c 2 k m where c is a linear damping coefficient in units of n s m k is the stiffness coefficient of the system in units of n m and m is the quality of the system in units of n m as shown in fig 2 when λ 1 and ζ 0 707 damping has a significant effect on the amplitude and the power amplification factor β has a maximum value which indicates that resonance occurs when the excitation force frequency is close to the natural frequency of the system when ζ 0 707 the power amplification factor β decreases monotonically with the increase in λ at this time the amplitude no longer has a maximum value and resonance will not occur it can be seen from the analysis above that the damping ratio has an important influence on whether the wave energy capture device can resonate with waves therefore it is necessary to derive a formula to calculate the damping ratio of the vibration system composed of the wave energy capture device and seawater the natural frequency of the free heave system composed of a floating body and seawater is bt 1980 3 ω s ρ g a m m where a is the waterline area of the floating body in units of m2 m is the added mass of the buoy the natural frequency of a single degree of freedom spring oscillator is wang and cao 2010 4 ω s k m where k is the stiffness coefficient of the spring vibrator in units of n m because the oscillating float wave energy capture device mainly collects the energy of the heave motion of the floating body the vibration of the system composed of the float device and seawater in the heave direction can be simplified to a single degree of freedom damped forced vibration then from equations 3 and 4 we can obtain the equivalent spring stiffness coefficient k of the oscillation system composed of the wave energy device and seawater as 5 k ρ g a by substituting equation 5 into equation 2 the damping ratio of the heave system composed of a wave energy device and seawater is calculated as 6 ζ c 2 ρ g a m m 4 physical model experiment 4 1 experimental platform the principle of the physical model test platform of the new type of buoy chain sprocket wave energy capture device is shown in fig 3 because the chain sprocket mechanism is relatively large in size and mass relative to the model floating body it cannot be placed inside the floating body in this study the principle of relative motion was used and the idea of the external equivalent of the chain sprocket mechanism was adopted to research and develop a physical model experimental platform a synchronous belt pulley mechanism was used to replace the chain sprocket mechanism and a magnetic particle damper was used to replace the hydraulic system with system damping the floating body model was located at the front end of the wave tank a duct was fixed to the bottom end of the floating body a rolling guide rod was built into the duct and the lower end of the guide rod was connected to the ball joint at the bottom of the sink the force sensor was fixed at the top of the duct built into the floating body and the lower end of the force sensor was connected to a thin rope made of ultra high molecular weight polyethylene this rope passes through the duct guide rod spherical hinge pair and two rope guides and is then connected to one end of the synchronous belt the other end of the synchronous belt goes around the pulley and is connected to the rope retraction counterweight one side of the synchronous pulley was connected to the encoder shaft and the other side was connected to the magnetic particle damper shaft through a one way bearing the floating body has two types of motion under the action of waves oscillating motion along the guide rod and pitching motion around the spherical joint the pitching motion of the floating body around the spherical hinge pair does not collect wave energy but only achieves buffering when the wave pushes the floating body upward the duct extends along the guide rod and the synchronous belt drives the pulley to rotate forward and then drives the magnetic particle damper to collect wave energy when the floating body descends the duct shrinks along the guide rod and the synchronous belt drives the pulley to rotate in reverse under the pull of the counterweight to ensure that the rope is retracted in time the pulley and damper are connected through a one way bearing and the damper rotor does not rotate when the pulley rotates in the reverse direction therefore the floating body does not collect wave energy during its descent so the model of the buoy chain sprocket wave energy capture device has the characteristics of one way wave energy collection because of the constant damping of the magnetic particle damper the first level wave energy collection of the buoy chain sprocket wave energy capture device has the characteristics of constant load damping while because the acceleration of the oscillating motion of the floating body is small the rope retraction force of the counterweight is approximately constant the wave condition of the model experiment in this study are listed in table 1 the diameter of the small scale model floating body is determined according to the width of the wave tank in order to eliminate the wall effect the ratio of the diameter of the small scale floating body to the width of the wave tank should be less than 0 15 and its height dimension should ensure the floating body is not completely submerged by waves during the physical model experiment the floating bodies of resonance type and the light short type nonresonant type buoy chain sprocket wave energy capture device models are shown in fig 4 and the parameters of the two models are listed in table 3 the actual physical model test platform of the buoy chain sprocket wave energy capture device is shown in fig 5 4 2 data collection and power calculation the encoder is responsible for collecting the relative moving speed v between the duct and the guide rod the force sensor is responsible for collecting the rope tension f the first level instantaneous wave energy collection power p of the model floating body is then given by 7 p f v and the first level average wave energy collection power is 8 p 0 t p d t t where t is the wave period as the sampling frequency f of the acquisition card is 960 hz the digital integral formula for the first level average wave energy collection power p of the wave energy device model is 9 p 0 t p d t t 1 n f t 1 n f t p i 1 n f t 1 n f t f i v i where n is the number of complete wave cycles in the test period p i is the instantaneous power at point i f i is the instantaneous rope tension at point i and v i is the instantaneous relative moving speed of the duct and guide rod at point i the first level average collection efficiency η of the wave energy device model is then 10 η p e ω 4 3 experimental results under the same wave conditions the maximum first order average wave energy collection power was taken as the optimisation target and the damping and rope retraction forces were used as the optimisation parameters to optimise the resonance type and the light short type buoy chain sprocket wave energy capture device models the natural period vibration height damping ratio first level average collected power and efficiency in the optimal state were then determined the experimental test results for the two device models are listed in table 4 the model experiment results of the new type of buoy chain sprocket wave energy capture device show that the natural period of the resonance model in the optimal state is equal to the wave period and that the damping ratio is 0 156 because this value is 0 707 the resonance model in the optimal state is in resonance the damping ratio of the light short model in the optimal state is 1 466 because this is 0 707 the light short model in the optimal state is in an overdamped state and is in a nonresonant state the resonant and light short model floating bodies have the same diameter and the height and mass of the former are significantly larger than the latter but the first level average wave energy collection efficiency of the former 11 4 is significantly smaller than that of the latter 21 2 in other words the model test results indicate that the resonance technology cannot effectively improve the wave energy collection efficiency of the new type of buoy chain sprocket wave energy capture device 5 simulation research because the conclusions of the model experiment of the buoy chain sprocket wave energy capture device are inconsistent with the current consensus in the field of wave energy a hydrodynamic simulation was conducted on an indoor model and a sea state prototype 5 1 key technology of the hydrodynamic simulation in this study aqwa software was used to solve for the hydrodynamic coefficients of the wave energy capture device the obtained coefficients were then inputted into orcaflex software to hydrodynamically simulate the buoy chain sprocket wave energy capture device the first level average collected power and efficiency of the buoy chain sprocket wave energy capture device were calculated according to the hydrodynamic simulation results because the above mentioned hydrodynamic simulation technology can be applied to both the indoor model and the sea state prototype the following key hydrodynamic simulation technologies unless otherwise specified were not distinguished between the model and the prototype and will be referred to collectively as buoy chain sprocket wave energy capture devices 5 1 1 equivalent conversion of the chain sprocket load mechanism the buoy chain sprocket wave energy capture device relies on the chain sprocket mechanism to collect wave energy but the hydrodynamic simulation software orcaflex only has a spring damping module and no chain sprocket load damping module therefore the chain sprocket load mechanism needs to be equivalently converted into a spring damping module as shown in figs 1 and 3 the buoy chain sprocket wave energy capture device uses a hydraulic load and a chain retraction scheme whereas the model test platform uses a damping load and a counterweight rope retraction scheme the two methods are slightly different and the equivalent conversion methods are shown in figs 6 and 7 respectively in the chain sprocket load mechanism f d is the hydraulic load damping force during the rising phase of the floating body of the prototype device m d is the load damping during the rising phase of the floating body of the model device ω is the angular velocity of the sprocket v is the relative moving speed between the duct and the guide rod f is the chain tension f e is the constant chain retraction force and r is the sprocket radius the instantaneous collected power p 1 of the chain sprocket load mechanism of the wave energy capture device is then 11 p 1 f d v f f e v the instantaneous collected power p 2 of the chain sprocket load mechanism of the model is 12 p 2 m d w f f e r w f f e v it can be seen from equations 11 and 12 that the instantaneous power of the chain sprocket load mechanism of the prototype device and the model device can be determined by the pulling force f of the spring damping module the constant chain retraction force f e and the relative speed v of the duct and the guide rod 5 1 2 setting of the damping force because the buoy chain sprocket wave energy capture device has the characteristics of constant damping and one way wave energy acquisition the external damping force needs to be set in the hydrodynamic simulation of the device as shown in fig 8 here v is the relative moving speed between the duct and the guide rod the extension is positive and the contraction is negative 5 1 3 setting of the spring stiffness coefficient the chain sprocket load mechanism is equivalent to a spring damping module and the chain retraction mechanism is equivalent to a chain retraction spring in the wave energy collection process the chain retraction force is approximately constant therefore the spring in orcaflex is set as a constant force spring as shown in fig 9 the constant force spring tension in the model experiment simulation is the gravity of the chain retraction counterweight and the constant force spring tension in the sea state experiment simulation is the chain retraction force of the low pressure cylinder 5 2 calculation of the average first level wave energy collection efficiency after completing the simulation calculation using orcaflex the pull forces f and f d of the rope at the lower end of the damping module and the relative moving speed v between the guide rod and the duct must be extracted in the post processing module the instantaneous external damping force f d is 13 f d f f e where f e is the chain retraction force the formula for calculating the instantaneous wave energy capture power p of the device is as follows 14 p f d v the average collected power of the wave energy capture device in a period t is 15 p 0 t p d t t in orcaflex the data output frequency is set to 100 hz therefore the average capture power p of the wave energy capture device can be approximately regarded as the average value of the device s instantaneous power p i in n complete cycles from 11 15 we can deduce 16 p 0 t p d t t 1 n t f i 1 n t f p i f d n t f i 1 n t f v i where p i f di and v i are the instantaneous collected power instantaneous damping force and relative movement speed between the guide rod and the duct at point i respectively the average first level collection efficiency η of the wave energy capture device is then given by 17 η p e w 5 3 calculation of the equivalent damping coefficient a constant damping force load was adopted in both the prototype and the model of the buoy chain sprocket wave energy capture device therefore when using orcaflex for the hydrodynamic simulation the constant damping force setting was also adopted however when calculating the damping ratio a linear damping coefficient proportional to the speed must be used for this reason in this study the equivalent linear damping coefficient based on the principle of energy conservation was calculated the calculation formula for the average wave energy collected power based on the damping force is shown in eq 16 the average wave energy collected power based on the linear damping coefficient is 18 p 0 t p d t t 0 t f d v d t t 0 t c v 2 d t t c n t f i 1 n t f v i 2 where v i is the instantaneous speed of the device at point i by combining equations 16 and 18 the equivalent damping coefficient c can be obtained as follows 19 c f d i 1 n t f v i i 1 n t f v i 2 5 4 simulation verification of the model experiment using aqwa and orcaflex we constructed the same wave conditions and floating body model as in the indoor model experiment the wet surface of the floating body was meshed at 0 035 m 0 04 m as shown in fig 10 the simulation used the optimal damping force and chain retraction force of the model experiment and the hydrodynamic simulation calculation results are listed in table 5 comparison of tables 4 and 5 shows that in the model experiment of the buoy chain sprocket wave energy capture device the counterweight is used to retract the chain because of the effect of acceleration the chain retraction force is not a constant force but an approximately constant force during the simulation a constant force is used to retract the chain in addition the damping force in the model experiment was not constant and the optimal damping force in table 4 was the equivalent constant damping force but the constant damping force was used in the simulation these differences have little impact on resonance type systems with larger masses resulting in only a slight increase in the simulated vibration height but on light short systems with smaller masses they result in a slight decrease in the vibration height acquisition efficiency and damping ratio however the simulation results of the model experiment also show that the optimal collection efficiency of the resonant system is 11 4 which is significantly lower than the collection efficiency of the light short nonresonant system of 20 8 in other words the resonance technology cannot effectively improve the wave energy collection efficiency of the model of the buoy chain sprocket wave energy capture device 5 5 sea state prototype simulation research to eliminate the influence of the size effect and one way acquisition characteristics wave and full scale prototype models were built under typical sea state conditions based on the above mentioned hydrodynamic simulation technology the wet surface of the floating body was divided into a mesh of 0 78 m 0 4 m and the mesh of the anchor chain and rope was divided into a line mesh with a length of 0 5 m as shown in fig 11 in this study the maximum wave energy collection efficiency was taken as the optimisation goal and the chain retraction force and load damping force were taken as the optimisation parameters the respective optimal first level wave energy collection efficiency was then obtained and further study was made on whether the resonance technology can effectively improve the efficiency of the buoy chain sprocket wave energy capture device the simulation results of the sea state prototype with a one way acquisition feature are given in table 6 and the simulation results of the sea state prototype with a two way acquisition feature are given in table 7 the table results indicate that the sea state prototype with a two way acquisition feature directly drives the plunger pump to generate high pressure oil through the shaft and that the low pressure hydraulic cylinder is only responsible for the retraction of the chain the diameter of the two kinds of full scale prototype floating body is determined according to the rated power generation the mass of the resonant prototype floating body in tables 6 and 7 is determined by the natural period equal to the wave period and the height of the resonant prototype floating body is determined by factors such as its mass floating body diameter and vibration height the mass of the light short prototype floating body in tables 6 and 7 is determined by the practical feasible minimum mass and the height of the light short prototype floating body is determined by factors such as its mass the diameter of the floating body and the vibration height it can be seen from tables 6 and 7 that the collection efficiency of the resonance type buoy chain sprocket wave energy capture device prototype is significantly lower than that of the same type of light short buoy chain sprocket wave energy capture device prototype for both one way and two way wave collection devices given that the size and mass of the resonant wave energy capture device is much larger than that of the light short wave energy capture device the cost performance of the resonant buoy chain sprocket wave energy capture device is significantly lower than that of the light short buoy chain sprocket wave energy capture device in other words the resonance technology cannot effectively improve the collection efficiency of the buoy chain sprocket wave energy capture device it can also be seen from tables 6 and 7 that the buoy chain sprocket wave energy capture device with one way collection characteristics has a higher collection efficiency than that with two way collection characteristics and the former has a simpler structure higher reliability and lower manufacturing and maintenance costs than the latter making it more cost effective in summary resonance technology is not an effective method to improve the wave energy collection efficiency of the prototype buoy chain sprocket wave energy capture device in comparison the light short buoy chain sprocket wave energy capture device prototype with one way collection features has higher collection efficiency and greater cost effectiveness 6 conclusion because the new type of buoy chain sprocket wave energy collection technology is a type of oscillating float wave energy collection technology resonance technology was used in this study to improve its collection efficiency however the indoor model experiment and its simulation research as well as the simulation research of the sea state prototype show that compared with the resonance type wave energy capture device the light short type nonresonant type buoy chain sprocket wave energy capture device not only is smaller in size and lower in cost but also has higher wave energy collection efficiency therefore resonance technology is not an effective method to improve the wave energy collection efficiency of this new type of buoy chain sprocket wave energy capture device and the light short type buoy chain sprocket wave energy capture device with the characteristics of one way collection has higher collection efficiency and greater cost effectiveness the results of this study not only provide theoretical guidance for the research and development of high efficiency prototypes of buoy chain sprocket wave energy capture devices but also demonstrate that resonance technology may not be able to effectively improve the efficiency of all oscillating float wave energy collection devices and should be studied in detail and cannot be generalised credit authorship contribution statement fangdong ji conceptualization software validation investigation data curation writing original draft writing review editing defeng wu software validation yajun li validation zhilin zhu software data curation linsen zhu methodology formal analysis supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research has been supported by the national marine renewable energy project of china grant number ghme2011bl02 and key technology research and development program of shandong province grant number 2018ghy115024 
20516,a high reliability low cost buoy chain sprocket wave energy capture device is proposed resonance theory is used to improve its wave energy capture efficiency and reduce its cost the testing principle of the buoy chain sprocket model is proposed and comparable resonant and nonresonant experimental floating body models were constructed based on finite depth linear wave theory and the resonance principle then the methods and results of the model experiments are described based on using morison equation to calculate wave load simulation and verification of the model experiment were conducted by using aqwa and orcaflex software finally to eliminate the size effect and the impact of one way wave energy collection based on the simulation technology described above sea state prototype models of resonant and nonresonant buoy chain sprocket wave energy capture devices with one way and two way acquisition characteristics were constructed simulations were then conducted to get the maximum wave energy gathering efficiency the research result indicates that the nonresonant buoy chain sprocket wave energy capture device with one way acquisition has higher wave energy capture efficiency than the resonant buoy chain sprocket wave energy capture device keywords wave energy oscillating buoy resonance technology buoy chain sprocket wave energy capture efficiency 1 introduction owing to the advantages of large reserves wide distribution high energy flow density greenness and sustainability wave energy has attracted increasing attention from human society kofoed et al 2005 leijon et al 2006 at present there are many types of wave energy capture devices from the perspective of wave energy capture technology these can be mainly divided into oscillating water column type raft type contracting wave channel type oscillating float type duck type and pendulum type you et al 2010 among them the oscillating float type is a keen interest in the field of wave energy research because of its simple and reliable structure low manufacturing and deployment maintenance costs and high efficiency song et al 2012 sheng et al 2013 high reliability and low cost are the two main decisive indicators of the maturity of wave energy capture technology high reliability mainly depends on the primary collection principle and structure of the wave energy capture device in addition to effectively reducing the cost of manufacturing deployment and subsequent maintenance of wave energy devices low cost mainly depends on the first level collection efficiency of wave energy capture devices the oscillating float wave energy capture device forms a damped forced vibration system with seawater and waves in which waves are the excitation source yeung 1981 wu et al 2013 using resonance theory can effectively improve the wave energy capture efficiency of an oscillating float wave energy capture device which was first proposed by budar and falnes 1975a 1975b they proposed an oscillating float type wave energy capture device composed of large and small floating bodies and fixed pulleys the natural frequency of the system can be adjusted by using a flywheel with an adjustable moment of inertia when the natural frequency of the device is equal to the natural frequency of the wave and the mechanical load resistance equals the radiation resistance the system is in resonance and the device has the highest wave energy capture efficiency at this time this view derived from the specific oscillating float wave energy capture device was corroborated by many later documents and became a consensus in the field of wave energy research analysis and comparison of the numerical calculation methods of the oscillating float wave energy capture device indicated that the maximum wave energy capture power occurs near the resonance point li and yu 2012 dai dai et al 2017 proposed a double sphere oscillating float wave energy capture device and a model experiment of the device showed that the maximum wave energy capture power occurred near the resonance point cai cai et al 2017 proposed an oscillating float wave energy capture device equipped with an active resonance system inside the float and the numerical simulation results showed that resonance technology can effectively improve the capture power of the device however in recent years some studies have presented different views in a study of the optimisation method of the oscillating float wave energy capture device it was found through numerical calculations that the optimised maximum conversion power does not occur at the resonance point wu et al 2010 shi shi et al 2014 designed a combined oscillating float wave power generation device in their model experiment study it was found that when the incident wave frequency equals the float resonance frequency the model output power is not maximum based on the research of buoy rope drum wave energy capture devices zhu et al 2019 a new type of buoy chain sprocket wave energy capture device is proposed because this scheme is still an oscillating float wave energy capture scheme so resonance technology is used to improve its wave energy capture efficiency therefore the intent of the present study is to construct comparable resonant and nonresonant experimental floating body models based on finite depth linear wave theory the morrison equation and the resonance principle model experiments and hydrodynamic simulations are then used to study the methods of improving the capture efficiency of the buoy chain sprocket wave energy capture device 2 new type of buoy chain sprocket wave energy capture technology the new type of buoy chain sprocket wave energy capture device zhu et al 2019a zhu et al 2019b is mainly composed of a floating body chain sprocket guide rod mechanism gravity anchor anchor chain hydraulic system and power generation system as shown in fig 1 the gravity anchor is laid on the seabed the bottom end of the guide rod is connected to the anchor stone through a spherical hinge pair the top of the guide rod is connected to the chain the other end of the chain is fixed on the top of the floating body the fixed sprocket is fixed on the top of the floating body and the movable sprocket is connected to the piston rod of the hydraulic cylinder the hydraulic cylinder is built into the protective tube the guide rod is built into the duct the duct is firmly connected to the floating body and rollers are installed on the inner side of the lower end of the duct and the outer side of the upper end of the guide rod therefore the guide rod and the duct constituted a rolling pair under the effect of the wave load the floating body of the buoy chain sprocket wave energy capture device mainly produces oscillating motion along the guide rod and pitching motion around the spherical joint when the floating body floats upward along the guide rod the chain pulls up the piston rod of the hydraulic cylinder through the sprocket the hydraulic cylinder produces high pressure oil the high pressure oil drives the hydraulic motor after being buffered by energy storage and the hydraulic motor drives the generator to generate electricity when the floating body sinks along the guide rod the piston of the hydraulic cylinder moves back under the action of low pressure oil and drives the piston rod to retract the chain this process does not capture wave energy therefore the buoy chain sprocket wave energy capture device has the characteristic of one way wave energy capture the pitching movement of the floating body around the ball joint does not collect wave energy but only achieves buffering to ensure the reliability of the device because the inlet and outlet pressures of the hydraulic cylinder are constant the first level wave energy collection of the buoy chain sprocket wave energy capture device has the characteristics of constant load damping and constant chain retraction force compared with the previous buoy rope drum wave energy capture device zhu et al 2019 this new type of buoy chain sprocket wave energy capture device has the following advantages 1 the hydraulic cylinder load replaces the direct drive generator load thereby eliminating the load moment on the rope and reel and completely eliminating abrasion between the rope and reel 2 the hydraulic chain retraction scheme replaces the spring rope retraction scheme it not only has a compact structure but also has a large chain retraction force and long fatigue life 3 a rolling moving pair consisting of a guide rod and a duct replaces the rope guide parts thereby completely eliminating the contact wear of the rope in summary this new type of buoy chain sprocket wave energy capture technology inherits the advantages of the early buoy rope drum device of simple structure low cost and high efficiency it also overcomes the reliability problems of early buoy rope drum devices such as rope wear and short fatigue life of the rope retraction spring moreover because the chain retraction force is greatly increased and becomes adjustable this not only ensures the timely recovery of the chain but also provides a basis for further improvement of the wave energy capture efficiency 3 theoretical basis 3 1 wave theory 3 1 1 selection of wave energy flow calculation formula the wave energy flow calculation formula should be determined by the wave type and the wave type is determined according to the wave condition parameters wang and liang 2013 the wave types of the model experiment and the proposed sea state experiment of full scale prototype were determined and these are listed in table 1 the wave condition of the full scale prototype simulations is determined based on the common wave condition in the sea area of the prototype experiment based on the wave making capacity of existing indoor wave tank the wave period of physical model experiment should be equal to the natural period of the resonant model in order to ensure the normal wave energy collection of the two types of physical models the wave height and water depth are determined by the resonant physical model the wave energy flow calculation formula for a finite water depth linear wave is 1 e w 1 32 π ρ g 2 h 2 t d tanh k d 1 2 k d sinh 2 k d where ρ is the density of seawater in units of kg m3 g is the acceleration of gravity in units of m s2 h is the wave height in units of m t is the wave cycle in units of s d is the diameter of the floating body in units of m k is the wavenumber and d is the water depth in units of m 3 1 2 selection of the method of wave load calculation the method for selecting the wave load calculation should be determined according to the wave condition parameters and the characteristic size of the corresponding floating body wang and liang 2013 the choices of wave load calculation method for the physical model experiment and the proposed sea state experiment are given in table 2 3 2 resonance theory when the mechanical vibration system is underdamped and the external excitation frequency is equal to the natural frequency of the system the amplitude of the forced vibration reaches its maximum value which is called resonance therefore a resonance system can be constructed by changing the excitation source frequency or the natural frequency of the system to make them equal fig 2 shows the resonance characteristic curves of a single degree of freedom forced vibration system in the figure β is the dynamic amplification factor which represents the ratio of the amplitude of the forced vibration to the static deviation λ is the frequency ratio which is the ratio of the circular frequency of the exciting force to the natural frequency of the system and ζ is the damping ratio which reflects the damping characteristics of the vibration system and is defined as wang and cao 2010 2 ζ c 2 k m where c is a linear damping coefficient in units of n s m k is the stiffness coefficient of the system in units of n m and m is the quality of the system in units of n m as shown in fig 2 when λ 1 and ζ 0 707 damping has a significant effect on the amplitude and the power amplification factor β has a maximum value which indicates that resonance occurs when the excitation force frequency is close to the natural frequency of the system when ζ 0 707 the power amplification factor β decreases monotonically with the increase in λ at this time the amplitude no longer has a maximum value and resonance will not occur it can be seen from the analysis above that the damping ratio has an important influence on whether the wave energy capture device can resonate with waves therefore it is necessary to derive a formula to calculate the damping ratio of the vibration system composed of the wave energy capture device and seawater the natural frequency of the free heave system composed of a floating body and seawater is bt 1980 3 ω s ρ g a m m where a is the waterline area of the floating body in units of m2 m is the added mass of the buoy the natural frequency of a single degree of freedom spring oscillator is wang and cao 2010 4 ω s k m where k is the stiffness coefficient of the spring vibrator in units of n m because the oscillating float wave energy capture device mainly collects the energy of the heave motion of the floating body the vibration of the system composed of the float device and seawater in the heave direction can be simplified to a single degree of freedom damped forced vibration then from equations 3 and 4 we can obtain the equivalent spring stiffness coefficient k of the oscillation system composed of the wave energy device and seawater as 5 k ρ g a by substituting equation 5 into equation 2 the damping ratio of the heave system composed of a wave energy device and seawater is calculated as 6 ζ c 2 ρ g a m m 4 physical model experiment 4 1 experimental platform the principle of the physical model test platform of the new type of buoy chain sprocket wave energy capture device is shown in fig 3 because the chain sprocket mechanism is relatively large in size and mass relative to the model floating body it cannot be placed inside the floating body in this study the principle of relative motion was used and the idea of the external equivalent of the chain sprocket mechanism was adopted to research and develop a physical model experimental platform a synchronous belt pulley mechanism was used to replace the chain sprocket mechanism and a magnetic particle damper was used to replace the hydraulic system with system damping the floating body model was located at the front end of the wave tank a duct was fixed to the bottom end of the floating body a rolling guide rod was built into the duct and the lower end of the guide rod was connected to the ball joint at the bottom of the sink the force sensor was fixed at the top of the duct built into the floating body and the lower end of the force sensor was connected to a thin rope made of ultra high molecular weight polyethylene this rope passes through the duct guide rod spherical hinge pair and two rope guides and is then connected to one end of the synchronous belt the other end of the synchronous belt goes around the pulley and is connected to the rope retraction counterweight one side of the synchronous pulley was connected to the encoder shaft and the other side was connected to the magnetic particle damper shaft through a one way bearing the floating body has two types of motion under the action of waves oscillating motion along the guide rod and pitching motion around the spherical joint the pitching motion of the floating body around the spherical hinge pair does not collect wave energy but only achieves buffering when the wave pushes the floating body upward the duct extends along the guide rod and the synchronous belt drives the pulley to rotate forward and then drives the magnetic particle damper to collect wave energy when the floating body descends the duct shrinks along the guide rod and the synchronous belt drives the pulley to rotate in reverse under the pull of the counterweight to ensure that the rope is retracted in time the pulley and damper are connected through a one way bearing and the damper rotor does not rotate when the pulley rotates in the reverse direction therefore the floating body does not collect wave energy during its descent so the model of the buoy chain sprocket wave energy capture device has the characteristics of one way wave energy collection because of the constant damping of the magnetic particle damper the first level wave energy collection of the buoy chain sprocket wave energy capture device has the characteristics of constant load damping while because the acceleration of the oscillating motion of the floating body is small the rope retraction force of the counterweight is approximately constant the wave condition of the model experiment in this study are listed in table 1 the diameter of the small scale model floating body is determined according to the width of the wave tank in order to eliminate the wall effect the ratio of the diameter of the small scale floating body to the width of the wave tank should be less than 0 15 and its height dimension should ensure the floating body is not completely submerged by waves during the physical model experiment the floating bodies of resonance type and the light short type nonresonant type buoy chain sprocket wave energy capture device models are shown in fig 4 and the parameters of the two models are listed in table 3 the actual physical model test platform of the buoy chain sprocket wave energy capture device is shown in fig 5 4 2 data collection and power calculation the encoder is responsible for collecting the relative moving speed v between the duct and the guide rod the force sensor is responsible for collecting the rope tension f the first level instantaneous wave energy collection power p of the model floating body is then given by 7 p f v and the first level average wave energy collection power is 8 p 0 t p d t t where t is the wave period as the sampling frequency f of the acquisition card is 960 hz the digital integral formula for the first level average wave energy collection power p of the wave energy device model is 9 p 0 t p d t t 1 n f t 1 n f t p i 1 n f t 1 n f t f i v i where n is the number of complete wave cycles in the test period p i is the instantaneous power at point i f i is the instantaneous rope tension at point i and v i is the instantaneous relative moving speed of the duct and guide rod at point i the first level average collection efficiency η of the wave energy device model is then 10 η p e ω 4 3 experimental results under the same wave conditions the maximum first order average wave energy collection power was taken as the optimisation target and the damping and rope retraction forces were used as the optimisation parameters to optimise the resonance type and the light short type buoy chain sprocket wave energy capture device models the natural period vibration height damping ratio first level average collected power and efficiency in the optimal state were then determined the experimental test results for the two device models are listed in table 4 the model experiment results of the new type of buoy chain sprocket wave energy capture device show that the natural period of the resonance model in the optimal state is equal to the wave period and that the damping ratio is 0 156 because this value is 0 707 the resonance model in the optimal state is in resonance the damping ratio of the light short model in the optimal state is 1 466 because this is 0 707 the light short model in the optimal state is in an overdamped state and is in a nonresonant state the resonant and light short model floating bodies have the same diameter and the height and mass of the former are significantly larger than the latter but the first level average wave energy collection efficiency of the former 11 4 is significantly smaller than that of the latter 21 2 in other words the model test results indicate that the resonance technology cannot effectively improve the wave energy collection efficiency of the new type of buoy chain sprocket wave energy capture device 5 simulation research because the conclusions of the model experiment of the buoy chain sprocket wave energy capture device are inconsistent with the current consensus in the field of wave energy a hydrodynamic simulation was conducted on an indoor model and a sea state prototype 5 1 key technology of the hydrodynamic simulation in this study aqwa software was used to solve for the hydrodynamic coefficients of the wave energy capture device the obtained coefficients were then inputted into orcaflex software to hydrodynamically simulate the buoy chain sprocket wave energy capture device the first level average collected power and efficiency of the buoy chain sprocket wave energy capture device were calculated according to the hydrodynamic simulation results because the above mentioned hydrodynamic simulation technology can be applied to both the indoor model and the sea state prototype the following key hydrodynamic simulation technologies unless otherwise specified were not distinguished between the model and the prototype and will be referred to collectively as buoy chain sprocket wave energy capture devices 5 1 1 equivalent conversion of the chain sprocket load mechanism the buoy chain sprocket wave energy capture device relies on the chain sprocket mechanism to collect wave energy but the hydrodynamic simulation software orcaflex only has a spring damping module and no chain sprocket load damping module therefore the chain sprocket load mechanism needs to be equivalently converted into a spring damping module as shown in figs 1 and 3 the buoy chain sprocket wave energy capture device uses a hydraulic load and a chain retraction scheme whereas the model test platform uses a damping load and a counterweight rope retraction scheme the two methods are slightly different and the equivalent conversion methods are shown in figs 6 and 7 respectively in the chain sprocket load mechanism f d is the hydraulic load damping force during the rising phase of the floating body of the prototype device m d is the load damping during the rising phase of the floating body of the model device ω is the angular velocity of the sprocket v is the relative moving speed between the duct and the guide rod f is the chain tension f e is the constant chain retraction force and r is the sprocket radius the instantaneous collected power p 1 of the chain sprocket load mechanism of the wave energy capture device is then 11 p 1 f d v f f e v the instantaneous collected power p 2 of the chain sprocket load mechanism of the model is 12 p 2 m d w f f e r w f f e v it can be seen from equations 11 and 12 that the instantaneous power of the chain sprocket load mechanism of the prototype device and the model device can be determined by the pulling force f of the spring damping module the constant chain retraction force f e and the relative speed v of the duct and the guide rod 5 1 2 setting of the damping force because the buoy chain sprocket wave energy capture device has the characteristics of constant damping and one way wave energy acquisition the external damping force needs to be set in the hydrodynamic simulation of the device as shown in fig 8 here v is the relative moving speed between the duct and the guide rod the extension is positive and the contraction is negative 5 1 3 setting of the spring stiffness coefficient the chain sprocket load mechanism is equivalent to a spring damping module and the chain retraction mechanism is equivalent to a chain retraction spring in the wave energy collection process the chain retraction force is approximately constant therefore the spring in orcaflex is set as a constant force spring as shown in fig 9 the constant force spring tension in the model experiment simulation is the gravity of the chain retraction counterweight and the constant force spring tension in the sea state experiment simulation is the chain retraction force of the low pressure cylinder 5 2 calculation of the average first level wave energy collection efficiency after completing the simulation calculation using orcaflex the pull forces f and f d of the rope at the lower end of the damping module and the relative moving speed v between the guide rod and the duct must be extracted in the post processing module the instantaneous external damping force f d is 13 f d f f e where f e is the chain retraction force the formula for calculating the instantaneous wave energy capture power p of the device is as follows 14 p f d v the average collected power of the wave energy capture device in a period t is 15 p 0 t p d t t in orcaflex the data output frequency is set to 100 hz therefore the average capture power p of the wave energy capture device can be approximately regarded as the average value of the device s instantaneous power p i in n complete cycles from 11 15 we can deduce 16 p 0 t p d t t 1 n t f i 1 n t f p i f d n t f i 1 n t f v i where p i f di and v i are the instantaneous collected power instantaneous damping force and relative movement speed between the guide rod and the duct at point i respectively the average first level collection efficiency η of the wave energy capture device is then given by 17 η p e w 5 3 calculation of the equivalent damping coefficient a constant damping force load was adopted in both the prototype and the model of the buoy chain sprocket wave energy capture device therefore when using orcaflex for the hydrodynamic simulation the constant damping force setting was also adopted however when calculating the damping ratio a linear damping coefficient proportional to the speed must be used for this reason in this study the equivalent linear damping coefficient based on the principle of energy conservation was calculated the calculation formula for the average wave energy collected power based on the damping force is shown in eq 16 the average wave energy collected power based on the linear damping coefficient is 18 p 0 t p d t t 0 t f d v d t t 0 t c v 2 d t t c n t f i 1 n t f v i 2 where v i is the instantaneous speed of the device at point i by combining equations 16 and 18 the equivalent damping coefficient c can be obtained as follows 19 c f d i 1 n t f v i i 1 n t f v i 2 5 4 simulation verification of the model experiment using aqwa and orcaflex we constructed the same wave conditions and floating body model as in the indoor model experiment the wet surface of the floating body was meshed at 0 035 m 0 04 m as shown in fig 10 the simulation used the optimal damping force and chain retraction force of the model experiment and the hydrodynamic simulation calculation results are listed in table 5 comparison of tables 4 and 5 shows that in the model experiment of the buoy chain sprocket wave energy capture device the counterweight is used to retract the chain because of the effect of acceleration the chain retraction force is not a constant force but an approximately constant force during the simulation a constant force is used to retract the chain in addition the damping force in the model experiment was not constant and the optimal damping force in table 4 was the equivalent constant damping force but the constant damping force was used in the simulation these differences have little impact on resonance type systems with larger masses resulting in only a slight increase in the simulated vibration height but on light short systems with smaller masses they result in a slight decrease in the vibration height acquisition efficiency and damping ratio however the simulation results of the model experiment also show that the optimal collection efficiency of the resonant system is 11 4 which is significantly lower than the collection efficiency of the light short nonresonant system of 20 8 in other words the resonance technology cannot effectively improve the wave energy collection efficiency of the model of the buoy chain sprocket wave energy capture device 5 5 sea state prototype simulation research to eliminate the influence of the size effect and one way acquisition characteristics wave and full scale prototype models were built under typical sea state conditions based on the above mentioned hydrodynamic simulation technology the wet surface of the floating body was divided into a mesh of 0 78 m 0 4 m and the mesh of the anchor chain and rope was divided into a line mesh with a length of 0 5 m as shown in fig 11 in this study the maximum wave energy collection efficiency was taken as the optimisation goal and the chain retraction force and load damping force were taken as the optimisation parameters the respective optimal first level wave energy collection efficiency was then obtained and further study was made on whether the resonance technology can effectively improve the efficiency of the buoy chain sprocket wave energy capture device the simulation results of the sea state prototype with a one way acquisition feature are given in table 6 and the simulation results of the sea state prototype with a two way acquisition feature are given in table 7 the table results indicate that the sea state prototype with a two way acquisition feature directly drives the plunger pump to generate high pressure oil through the shaft and that the low pressure hydraulic cylinder is only responsible for the retraction of the chain the diameter of the two kinds of full scale prototype floating body is determined according to the rated power generation the mass of the resonant prototype floating body in tables 6 and 7 is determined by the natural period equal to the wave period and the height of the resonant prototype floating body is determined by factors such as its mass floating body diameter and vibration height the mass of the light short prototype floating body in tables 6 and 7 is determined by the practical feasible minimum mass and the height of the light short prototype floating body is determined by factors such as its mass the diameter of the floating body and the vibration height it can be seen from tables 6 and 7 that the collection efficiency of the resonance type buoy chain sprocket wave energy capture device prototype is significantly lower than that of the same type of light short buoy chain sprocket wave energy capture device prototype for both one way and two way wave collection devices given that the size and mass of the resonant wave energy capture device is much larger than that of the light short wave energy capture device the cost performance of the resonant buoy chain sprocket wave energy capture device is significantly lower than that of the light short buoy chain sprocket wave energy capture device in other words the resonance technology cannot effectively improve the collection efficiency of the buoy chain sprocket wave energy capture device it can also be seen from tables 6 and 7 that the buoy chain sprocket wave energy capture device with one way collection characteristics has a higher collection efficiency than that with two way collection characteristics and the former has a simpler structure higher reliability and lower manufacturing and maintenance costs than the latter making it more cost effective in summary resonance technology is not an effective method to improve the wave energy collection efficiency of the prototype buoy chain sprocket wave energy capture device in comparison the light short buoy chain sprocket wave energy capture device prototype with one way collection features has higher collection efficiency and greater cost effectiveness 6 conclusion because the new type of buoy chain sprocket wave energy collection technology is a type of oscillating float wave energy collection technology resonance technology was used in this study to improve its collection efficiency however the indoor model experiment and its simulation research as well as the simulation research of the sea state prototype show that compared with the resonance type wave energy capture device the light short type nonresonant type buoy chain sprocket wave energy capture device not only is smaller in size and lower in cost but also has higher wave energy collection efficiency therefore resonance technology is not an effective method to improve the wave energy collection efficiency of this new type of buoy chain sprocket wave energy capture device and the light short type buoy chain sprocket wave energy capture device with the characteristics of one way collection has higher collection efficiency and greater cost effectiveness the results of this study not only provide theoretical guidance for the research and development of high efficiency prototypes of buoy chain sprocket wave energy capture devices but also demonstrate that resonance technology may not be able to effectively improve the efficiency of all oscillating float wave energy collection devices and should be studied in detail and cannot be generalised credit authorship contribution statement fangdong ji conceptualization software validation investigation data curation writing original draft writing review editing defeng wu software validation yajun li validation zhilin zhu software data curation linsen zhu methodology formal analysis supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research has been supported by the national marine renewable energy project of china grant number ghme2011bl02 and key technology research and development program of shandong province grant number 2018ghy115024 
20517,metamodel combined with simulation type reliability method is an effective way to determine the probability of failure p f of complex structural systems and reduce the burden of computational models however some existing challenges in structural reliability analysis are minimizing the number of calls to the numerical model and reducing the computational time most research work considers adaptive methods based on ordinary kriging with a single point enrichment of the experimental design ed this paper presents an active learning reliability method using a hybrid metamodel with multiple point enrichment of ed for structural reliability analysis the hybrid method termed as apckkm mcs takes advantage of the global prediction and local interpolation capability of polynomial chaos expansion pce and kriging respectively the u learning function drives active learning in this approach while k means clustering is proposed for multiple point enrichment purposes two benchmark functions and two practical marine structural cases validate the performance and efficiency of the method the results confirm that the apckkm mcs approach is efficient and reduces the computational time for reliability analysis of complex structures with nonlinearity high dimension input random variables or implicit limit state function keywords structural reliability polynomial chaos kriging active learning function monte carlo simulation experimental design nomenclature abbreviations aic akaike information criterion cdf cumulative density function cov coefficient of variation cpu central processing unit d vine drawable vine ed experimental design fea finite element analysis form first order reliability method fpso floating production storage and offloading lars least angle regression selection lhs latin hypercube sampling lsf limit state function mcs monte carlo simulation mle maximum likelihood estimation pce polynomial chaos expansion pck polynomial chaos kriging pdf probability density function rbdo reliability based design optimization scr steel catenary riser sorm second order reliability method tdp touch down point 1 introduction complex marine structures operating in the harsh and remote ocean environment require higher reliability to ensure safety of life asset and the environment throughout their operational life to ensure higher reliability one would need efficient and robust reliability assessment models weinmeister et al 2019 there have been efforts to develop and use metamodels for engineering structures and systems this ranges from but not limited to polynomial regression artificial neural network support vector regression polynomial chaos expansion pce and kriging weinmeister et al 2019 ocean structures are complex in their physical and functional form with mainly implicit or no closed form limit state function lsf describing their various failure modes bai and jin 2016 for such structures metamodel choice becomes crucial in the limit state design ultimate serviceability and fatigue among these metamodels kriging and pce are non intrusive and have gained wide application for reliability assessment in various engineering fields including marine structures teixeira and soares 2018 pce is a well established metamodel and has wide application in mathematics and engineering it started as a stochastic finite element analysis fea concept in the 90s ghanem and spanos 1997 the method gained usefulness in reliability analysis as a metamodel in the 2000s sudret and der kiureghian 2002 pce is a spectra based metamodelling approach that expresses the system response of finite variance in terms of the polynomial of its input variables it comprises a series of multivariate orthogonal polynomials and their corresponding coefficients the pce approach is relatively simple to construct it provides an easy estimation of the global statistics of the system s response which includes the statistical moment and distribution pce model allows for the computation of sensitivity analysis and it is efficient for resampling purposes marelli sudret 2019 similarly kriging is an interpolation technique that originated in geostatistics the system s response is assumed to follow a gaussian process with a given covariance structure the approach explores the correlation information of existing data samples to obtain the output for new input points it captures the local variability of the response as a function of the neighbouring data points kriging is flexible to a wide range of correlation functions provides a strong interpolation capability among the data points and can produce the mean prediction and associated variance for output response also the statistical information from the output response can be utilized for model refinement through an adaptive process santner et al 2003 various marine related studies have applied the kriging and pce technique in prediction and reliability studies chi et al 2017 demonstrated the legendre pce method s application in the statistical analysis of crosstalk in wire harness for naval ships ni et al 2018 applied the concept of pce in dynamic response analysis of marine risers zhang et al 2021 studied the uncertainty propagation and sensitivity analysis of a marine vehicle s shafting system using the generalized pce method bahmyari et al 2017 research considered the effect of a combination of pce and the galerkin method for the bending analysis of deformable plates lim et al 2018 utilized pce in developing long term surge motion analysis for a moored offshore vessel in another study nguyen et al 2019 developed a pce framework for extreme load analysis of a single body wind energy converter the reliability assessment of subsea anchors using the pce approach also showed its application to subsea facilities charlton rouainia 2019 hu et al 2019 investigated the performance of second and third order pce in hydrological modelling the concept of developing a pce metamodel has also gained practical application in marine concrete analysis bastidas arteaga et al 2020 applied the pce method in uncertainty propagation and sensitivity analysis of chloride induced corrosion on marine concrete structures furthermore kriging metamodels have found wide application in marine science and technology below are some research related applications of kriging in reliability analysis of marine structures and maritime operations morató et al 2019 applied kriging for the reliability analysis of an offshore wind energy converter s monopile support structure teixeira et al 2019 proposed an approach to reduce the computational effort in the fatigue stress analysis of an offshore wind tower using the kriging method gaspar et al 2014 studied kriging s efficiency in developing metamodels for marine structures with its application to a stiffened plate the study showed the superiority of kriging over the polynomial regression method in structural reliability assessment chen et al 2016 applied a combination of kriging metamodels for flexible risers optimal design hill et al 2016 developed a kriging model for motion response monitoring of floating production storage and offloading fpso mooring lines for a vessel shaped fish farm mooring system kriging was applied for optimization purpose li et al 2019 shi et al 2015 developed a metamodel using kriging for reliability assessment of a marine vessel s bottom plate subject to environmental load kriging has also found application in offshore semi submersible reliability assessment xu et al 2018 brandt et al 2017 demonstrated the application of kriging in the fatigue assessment of an offshore wind turbine s jacket support structure wang et al 2019 investigated the optimization of an autonomous underwater vehicle s appendage using kriging abdalla et al 2018 demonstrated the application of kriging in the investigation of the effect of chemicals on worker s exposure at new positions on a coastline bian et al 2019 applied the concept of kriging to monitor the marine environment in coastal china zhang et al 2018 used the interpolation ability of kriging in determining the possibility of drilling sections of formations in oil and gas drilling operations the kriging and pce metamodels can capture local variability and global behaviour of the output response respectively which is a significant strength of these models the polynomial chaos kriging pck method combines these advantages of kriging and pce to produce a robust metamodel that can reduce the rigour involved with computational models schöbi et al 2015 recently research focus has been on combining metamodels for efficient reliability assessment especially in aerospace related research cheng and lu 2020 study focused on developing a metamodel ensemble for reliability assessment pck metamodel has been applied in airfoil and aircraft engine nacelle analysis weinmeister et al 2019 also leifsson et al 2020 utilized pck metamodel in the yield estimation of multiband patch antennas unlike the broad application of pce and kriging in various engineering design areas the potential advantage of pck has not been widely explored especially in the reliability assessment of marine structures this study aims to achieve the following objectives 1 develop an active learning pck framework for marine structure reliability combining pce and ordinary kriging advantages 2 implement a multiple sampling point experimental design ed enrichment of pck metamodel by k means clustering to reduce computational time during reliability analysis rather than a single point enrichment as commonly adopted in active learning studies 3 to present a practical application of the developed framework for marine structural reliability assessment the proposed method is described in this paper as an active learning polynomial chaos kriging using k means clustering apckkm mcs the remainder of this paper is organized as follows section 2 describes the preliminaries of active learning metamodels and reliability section 3 details the methodology with illustrative examples section 4 presents case studies applying the apckkm mcs approach in the reliability based analysis of a truss system and a steel catenary riser scr under operating condition section 5 concludes the study 2 preliminaries 2 1 metamodels with the burden from computational models for complex structures metamodels provide an inexpensive way to approximate input and output relationships using cheap to evaluate analytical models this section will establish the fundamentals of kriging and pce required in pck construction 2 1 1 kriging kriging structure comprises a trend and stochastic part with the latter represented by a stationary gaussian process of zero mean and unit standard deviation equation 1 is a typical representation of the kriging model 1 y m k x β t f x σ g 2 z x β t f x σ g 2 represents the mean value trend function and the variance of the gaussian process respectively the notation z x denotes the stationary gaussian process which is determined by the autocorrelation function r also the response approximation using kriging metamodel is represented as m k x the kriging model parameters such as the coefficient of the trend function β process variance σ g 2 and the hyperparameters θ of the stationary gaussian process are determined by the maximum likelihood estimation mle approach as shown in eq a 1 a 4 of appendix a for the stochastic term kernel selection for the kriging model is made from a range of autocorrelation functions such as linear exponential gaussian and mat e rn this study adopts the more generalized mat e rn autocorrelation function santner et al 2003 with shape parameter ν s 5 2 as shown in eq 2 2 r x x l ν s 5 2 i 1 m 1 5 x x l i 5 x i x i 2 3 l i 2 e x p 5 x i x i l i 2 from the expression x are sample points and l is the correlation length the kriging unique predictor is based on available observation and response data the predicted mean μ y ˆ at a given point gives the output eq 3 finally the predicted variance eq 4 provides further information about the uncertainty of the mean 3 μ y ˆ x f x t β r x t r 1 y f β 4 σ 2 y ˆ x σ 2 1 r t x r 1 r x v t x f t r 1 f 1 v x where 5 v x f t r 1 r x f x r x represents the cross correlation vector between prediction point x and n sample points eq 6 6 r x r θ x x 1 r θ x x 2 r θ x x n 2 1 2 pce pce is a weighted sum of multivariate orthogonal polynomials and considers a finite output variance equation 7 shows the structure of a pce model 7 y m p c e α n m y α ψ α x ψ α x is the polynomial basis function of the multivariate polynomial and y α represents the coefficients of the function the family of orthogonal polynomials satisfies an inner product requirement eq a 5 appendix a the multivariate polynomials are a tensor product of univariate polynomials as shown in eq 8 these polynomials follow the orthogonality condition eq 9 8 ψ α x i 1 m ψ α i x i 9 e ψ α ψ β d x ψ α ψ β f x x d x δ α β there is a natural relationship between orthogonal polynomials and probability distribution the wiener askey scheme attributes specific orthogonal polynomials to a given probability distribution of the random variables xiu and em karniadakis table a 1 appendix a shows the families of orthogonal polynomials and the associated distribution for situations with no specific basis for the distribution type an isoprobabilistic transformation to the desired distribution type in the conventional askey scheme basis is considered lebrun and dutfoy 2009 the pce approach suffers from the curse of dimensionality as shown in eq 10 where the number of required polynomials grows exponentially both in degree and dimension the result increases the computational expense of the model consequently there is a need for truncation of the terms of the polynomial 10 p o p n d p n d p o is the number of terms in the pce n d represents the dimensionality of the random variable and p is the maximum order of the basis polynomial the truncation of the orthogonal polynomial infinite series is achieved using a sparse algorithm that disregards interactive terms and penalizes higher order terms while selecting a p that minimizing the cross validation error fajraoui et al 2017 this approach increases the robustness of the method and prevents overfitting the least angle regression selection lars provides an algorithm that allows for appropriate truncation considering only the orthogonal basis s non zero terms this study adopts lars for its successful application in obtaining the best sparse set blatman and sudret 2011 equation 11 and eq 12 shows the penalized least square with regularization γ and leave one out error l o o which needs to be minimized to obtain the best sparse set of coefficients l o o is a cross validation error which prevents the common overfitting problem peculiar to pce lataniotis et al 2019 11 y α a r g m i n 1 n i 1 n y t ψ α x i m x i 2 γ α a y α 12 l o o 1 n i 1 n m x i m y ˆ i x i 2 v a r y from eq 11 and eq 12 n represents the number of samples points in the ed v a r y denotes response data variance and m y ˆ i x i represents the model response with the exclusion of a data point from the ed 2 1 3 the hybrid metamodel pck to harness the advantage of the commonly used kriging and pce meta modelling technique the sparse pce term as shown in eq 7 is utilized as the trend function in eq 1 the hybrid model effectively combines kriging and pce s model advantage as highlighted in the introduction section and develops a more robust metamodel for reliability assessment of marine structures equation 13 shows a typical pck expression with a polynomial type trend term 13 y m p c k x α a y α ψ α x σ g 2 z x in this approach the sparse polynomial set obtained from the lars algorithm is ranked based on its correlation with the residual obtained and introduced individually as a trend function in the kriging model eq 1 in the process the error is determined at each iterative step until the trend function contains all sparse set of polynomials initially defined the iterative action which minimizes l o o is determined and used as the optimal pck model the calibrated model then serves as a metamodel for response determination the least square minimization approach has the obvious advantage of using an arbitrary number of input points to determine the coefficients if they represent the random input variables 2 2 active learning function and ed enrichment in recent times the enrichment of ed in metamodel construction has become an attractive means to reduce computational cost the enrichment concept reduces the performance function s computational evaluation and improves the metamodel s efficiency and accuracy it selects the next best point in an iterative pattern from the candidate sample pool until it meets the stopping criteria research is still focused on developing active learning functions although these are mainly variants of the existing learning functions the efficient global optimization ego method for computational cost reduction pioneered the concept of active learning jones et al 1998 other active learning methods have developed after the ego approach the expected feasibility function eff bichon et al 2008 and the u function echard et al 2011 selects points from the candidate population with consideration of sample points close to the limit state surface and with considerable uncertainty of the prediction lv et al 2015 proposed the h function which considers sample points with significant prediction error and information entropy close to the limit state surface also sun et al 2017 proposed the least important function lif which considers the improvement of p f of the kriging model with enrichment of the ed although there exist several active learning functions they are rarely applied practically because of their difficulty in implementation however u function stands out in its simplicity in implementation and fast convergence consequently it will be used for active learning in this paper more specifically the u function selects from the candidate pool the sample with the maximum probability of misclassification the u function is premised on the fact that the sign of the performance function affects the next point required for enrichment the probability of misclassification p m i s is shown in eq 14 14 p m i s ф μ g ˆ x σ g ˆ where u x μ g ˆ x σ g ˆ the sample point which minimizes u x eq 15 has a high tendency to change the sign in the vicinity of the limit state surface and is considered the next new point in the ed the smaller the u x value the more prediction uncertain the sign is for the lsf the stopping criterion of the u function is set as min u x 2 15 x n e w a r g m i n u x for x s p where s p is the sample population the initial development and application of active learning methods have focused on ordinary kriging taking advantage of its interpolation and stochastic capabilities also a single point enrichment has been the focus of the active learning methods developed the enrichment of ed is usually achieved by the next best point from the candidate pool as described in eq 15 while most active learning approaches in the literature have enriched the ed with a single point this paper considers multiple enrichment using the weighted k means clustering approach zaki and meira 2014 the clustering weight is determined by p m i s eq 14 the approach significantly reduces the number of iteration while still maintaining the quality of the metamodel and accuracy of the p f 2 3 structural reliability structural reliability aims at determining the probability of failure of structures given random input variables g x represents the lsf that characterizes the performance of the system the limit state surface g x 0 divides the standard normal plane into safe g x 0 and failure regions g x 0 the integral of a joint pdf f x x in the failure domain determines p f eq 16 x represents the random input vector where x x 1 x n t for the joint pdf it is challenging to obtain a closed form solution for this integral 16 p f g x 0 f x x d x the gradient based reliability approach based on taylor s expansion series and the simulation type methods provide an alternative in the determination of the structural system p f examples of this approach include the first order reliability method form and second order reliability method sorm zhao and ono 1999 however the gradient based method presents difficulty in dealing with nonlinear and complex lsf system reliability problems and multiple design points the simulation methods include monte carlo simulation mcs and variance reduction methods like importance sampling is ang et al 1992 line sampling pradlwarter et al 2007 and subset simulation au and beck 2001 the mcs method eq 17 is straightforward to implement independent of the type of lsf and distribution of the input variables mcs has gained useful application in various engineering areas from eq 17 n m c s and n g x 0 represents the sampling size and samples in the failure domain or on the limit state surface respectively also eq 18 shows the coefficient of variation cov which signifies the uncertainty in p f from the mcs approach melchers and beck 2018 17 p f n g x 0 n m c s 18 cov 1 p f p f n m c s the difficulty of mcs application in the reliability assessment of finite element models due to the computational burden during analysis has led to the concept of metamodels to simplify the reliability evaluation of complex engineering systems 3 methodology this section describes the sequential steps for reliability assessment using the proposed apckkm mcs approach for clarity two benchmark functions further explain the framework 3 1 procedural steps step 1 obtain statistical parameters probability distribution and dependency information where necessary of random variables from observation data in this paper the dependence between random variables is determined using copula functions copulas serve as links between univariate marginals and significantly capture tail dependence and nonlinear relationship between random variables nelsen 2006 step 2 with the pdf of the input distribution generate candidate sample points using mcs n m c s the sample points required for ed enrichment at each iterative step are drawn from the candidate pool step 3 initial sampling plan and points of data are determined the study adopts a type of ed called latin hypercube sampling lhs lhs is a space filling method for generating sample points of random variables for metamodel construction forrester et al 2008 the ed is dependent on the dimension of random input variables for the initial ed although there are no agreed methods to determine the number of samples required one of the pioneering works on active learning echard et al 2011 suggested a small initial ed for this purpose about a dozen sample points for systems with random input variables less than twelve 12 this study adopts an initial ed of at least 12 sample points for random variables greater than 12 the initial ed utilized equals the number of random variables where applicable step 4 with a computational model or experiment obtain structural responses for the quantity of interest using the initial ed obtained in step 3 step 5 train the proposed metamodel using initial ed step 3 and responses obtained in step 4 section 2 describes the construction process of the metamodel step 6 obtain candidate pool response with developed apckkm mcs metamodel consequently obtain prediction sign required for candidate pool sample classification and the p f step 7 develop weighted k means clusters in the candidate pool using the u learning function determine the min u x for k means clusters step 8 the min u x which represents the potential enrichment points to the ed are checked against the stopping criteria u x 2 if the possible enrichment points meet the stopping criteria then mcs sufficiency is tested otherwise update the ed in step 5 with the best new sample points and their corresponding responses step 9 determine the candidate pool sufficiency if the cov is less than 5 accept the p f otherwise the candidate sample pool is updated accordingly and the process repeated fig 1 shows the procedure described above for reliability assessment using apckkm mcs in this paper code implementation for reliability analysis is in matlab based software uqlab marelli and sudret 2014 3 2 illustrative examples using benchmark functions this section explains the framework described in section 3 1 using two benchmark functions the reliability results obtained from the proposed method are compared with active learning ordinary kriging metamodel ak mcs and active learning pck with a single point enrichment approach apck mcs 3 2 1 ten dimensional nonlinear function the ten dimensional function is highly nonlinear and shows the relationship between independent random input variables x and the corresponding response g x 19 g x i 1 10 x i 2 10 x 1 2 x 2 2 i 2 9 x i 2 x i 1 2 16 the steps detailed in section 3 1 are applied to the function for metamodel development and reliability assessment step 1 all variables of the ten dimensional function are assumed to be statistically independent and normally distributed x i n 1 0 2 f o r i 1 2 10 step 2 the mcs candidate pool required for the enrichment of the ed comprises of n m c s 10 6 sample points for the input variables of known distribution step 3 the initial ed comprises twelve 12 lhs sampling points for metamodel training step 4 determine the responses g x of the initial sampling points obtained in step 3 step 5 using the initial ed sampling points step 3 and the corresponding responses step 4 the proposed metamodel is constructed as described in eqs 1 13 of section 2 the conventional hermite orthogonal polynomial xiu karniadakis 2002 is selected as the polynomial basis in the metamodel construction with normally distributed variables step 6 the signs for candidate sample points and reliability are determined using the developed metamodel step 7 points with the probability of misclassification are determined using the u learning function this paper considers three clusters k 3 for the weighted k means clustering steps 8 9 next best points from the clusters enrich the ed and the iterative process continues as shown in fig 1 until u x 2 in the candidate pool for reliability analysis the stopping criterion is cov 0 05 the reliability results table 1 obtained with multiple enrichment apckkm mcs are compared with the single sample point enrichment case apck mcs and the conventional ordinary kriging active learning ak mcs also in table 1 is the number of model evaluations n m o d which indicates the number of calls to the numerical metamodel especially when dealing with implicit lsf the number of iteration n i t r required in achieving the stopping condition as shown in the framework fig 1 is also detailed in table 1 the average central processing unit cpu time indicates the average time of convergence of a metamodelling approach simulation is implemented using an i7 7500u 2 90 ghz cpu with an 8 gb memory computer the average cpu time from 40 runs of the proposed method apckkm mcs is compared with apck mcs and ak mcs using the same starting ed fig 2 3 2 2 infinite soil slope problem this section applies the same framework and procedure described in section 3 2 1 to an infinite slope model fig 3 which characterizes soil slope stability subject to water infiltration phoon 2008 equation 20 shows the lsf for the infinite slope problem 20 p γ h h h γ s a t γ w c o s θ t a n γ h h h γ s a t s i n θ 1 the parameters γ and γ s a t in eq 20 are obtained from eq 21 and eq 22 respectively 21 γ γ w g s 0 2 e 1 e 22 γ s a t γ w g s e 1 e 23 u h h h six 6 random variables as shown in table 2 are considered for the infinite slope model the random variables are assumed statistically independent for simplicity of analysis the candidate pool consists of 10 6 mcs sampling points first to train the apckkm mcs metamodel for the infinite slope problem an initial ed containing 12 lhs sampling points and the corresponding response is determined classical orthogonal polynomial related to the probability distribution of infinite slope random variables determines the polynomial basis eq 8 for the uniformly distributed random input variables the legendre polynomial is selected and the hermite orthogonal polynomial for other input random variables of the slope model the lars approach determines the appropriate polynomial truncation for the trend function as detailed in section 2 multiple enrichment of ed for the infinite slope function is achieved using the k means clustering approach k 3 all stopping criteria and learning function as shown in fig 1 are applied to the infinite slope model using the mle approach eq a 1 a 4 table a 1 appendix a the parameters of the metamodel is determined table 3 shows the results of the reliability analysis using the proposed method the results obtained from the reliability assessment are compared with other metamodel types of the same initial ed table 3 fig 4 shows the computational time average from 40 runs of the various metamodels using the same initial ed the illustrative examples show that the results obtained from the combination of pce and kriging apckkm mcs apck mcs comparatively provides a better reliability approximation than the metamodel constructed by ordinary kriging apck mcs 4 application of the proposed metamodel to marine structures this section presents the practical engineering application of the framework described in section 3 in the reliability based design of marine structures the proposed approach apckkm mcs is applied to a 10 bar truss structure and a marine riser scr 4 1 ten bar truss structure truss system has practical application in various aspects of engineering some marine structural application includes offshore vessel guard rails derrick structures crane booms jacket platforms and truss type jack up leg structures this section considers a 10 bar truss system the schematic diagram in fig 5 shows the truss bar system ten 10 random input variables are considered with statistical parameters shown in table 4 the probabilistic parameters considered include the length of the bars l the sectional area of the truss bar a elastic modulus e and the applied point load on the bar p the horizontal and vertical bars are assumed to be of equal length all input variables are considered statistically independent the allowable vertical displacement of the 10 bar system at a given point c as shown in fig 5 is 0 005 equation 24 shows the implicit lsf of the truss system 24 g x 0 005 δ y the framework described in section 3 is applied to the truss system with regards to the initial ed for the truss system this paper utilizes 15 lhs points the metamodel construction basis is the hermite orthogonal polynomial with a nonlinear transformation of the lognormal distribution the vertical displacement of the truss system δ y is obtained from fea a displacement representation of the 10 bar truss system due to applied load is shown in fig 6 the enrichment of the ed is from the candidate pool n m c s 10 6 multiple point enrichment k 3 is utilized from weighted k means clusters in the pool the determination of truss displacement for ed enrichment is achieved using the fea approach with the stopping criteria met table 5 summarises the results obtained using the proposed method fig 7 shows the apckkm mcs reliability plot with iterative steps from the initial ed sample points while meeting the stopping criteria 4 2 scr application as shown in fig 8 scr has practical application in various aspects of oil and gas activities ranging from product export to gas and water injection during petroleum production activities tension leg platforms semi submersibles spars and fpso units are amongst the structures where scr has been successfully applied bai bai 2005 this study considers the prevailing environmental conditions of the flemish pass basin the basin has a huge potential for oil and gas exploration and located about 400 km offshore st john s newfoundland canada this study limits the environmental condition to the wave and current loads acting on the scr during normal operating condition due to data availability two essential points of the scr are the touch down point tdp as shown in fig 8 where the scr makes contacts with the seabed while operating and the scr connection to the offshore vessel the scr is assumed to be free hanging from the flex joint and connected to an fpso on its starboard side the operating depth of the scr in the basin is considered 1190m and the internal transport fluid is crude oil table 6 provides more details of the scr and fpso for this study 4 2 1 statistical parameters and probability distribution determination the significant wave height h s zero crossing period t z and mean surface current v c represents the sea load random variables assumed to be acting on the scr during operations in the flemish pass the statistical summary of the annual environmental operating conditions including the dominant wave and current directions table 7 for the flemish pass is obtained from site specific met ocean data c core 2017 the environmental data is fitted to continuous probability distributions to determine the best fit for the random variables the mle approach is adopted using the minimum akaike information criterion aic to fit various data distribution table b 1 and figure b 1 appendix b the distribution selection is based on the minimum aic with weibull distribution selected for h s and v c for t z the lognormal distribution is selected as shown in table 7 4 2 2 scr dependence modelling of variables the dependence between random variables h s t z and v c is considered in this study and determined using a unique type of copula called the drawable vine d vine copula the d vine copula can handle dependence between variables by the process of decomposition aas et al 2009 the vine is graphically oriented with the dependence relationships between scr random variables in tree 1 of the vine structure and conditional relationships in tree 2 fig 9 for the vine structure the non parametric kendall tau τ k values between the variables are essential in determining the architecture and dependence of the vine trees using sklar s theorem and the minimum aic approach nelsen 2006 the copula s optimal selection is determined from a set of bivariate copulas the bivariate copulas considered for selection are the gaussian t clayton gumbel frank and independent copulas table c 1 appendix c table 8 shows the selected copulas based on minimum aic values it also shows the associated copula parameter θ c and rotation θ r of the vine structure using eq c 1 eq c 3 of appendix c the clayton and rotated clayton 270 o copulas are selected for modelling dependency between the scr s random variables as shown in tree 1 of the d vine structure table 8 4 2 3 initial ed and scr responses following the determination of the optimal copulas for the scr the vectors of dependent random variables with continuous marginals are mapped isoprobabilistic transform onto independent random variables using the rosenblatt transformations eq c 4 eq c 6 table c 1 appendix c consequently independent samples required for initial ed and metamodel construction are obtained an initial ed which comprises 20 lhs points of sea state data is generated with corresponding responses obtained through a time domain dynamic strength analysis of the scr using flexcom flexcom 2019 the random sea wave characteristics are modelled using the pierson moskowitz spectrum a widely used spectrum in wave analysis of structures operating in deepwater massel 1996 for this demonstration the seabed of the flemish pass is modelled as elastic and flat scr responses considered include the maximum and minimum effective tension t m i n t m a x and the maximum von mises stress s v m s in operating condition from the scr effective tension profile obtained for response analysis fig 10 t m i n is observed within the seabed and touchdown zone 0 600m of the scr and t m a x at the flex joint region 1955m for all ed point considered also stress s v m s for the scr is observed about the touchdown zone 400 600m 4 2 4 metamodel multiple enrichment and reliability analysis with the tension and stress responses obtained for the scr and corresponding lhs points as detailed in section 4 2 3 the apckkm mcs metamodel is constructed for the scr system as described in section 2 and further enriched from n m c s 10 6 candidate samples using the weighted k means clustering approach k 3 based on the probability distribution of the random variables and an isoprobabilistic transformation the classical hermite orthogonal polynomial is used as the basis of the trend term 25 g 1 h s t z v c t min t min 0 26 g 2 h s t z v c t a t max 27 g 3 h s t z v c s a s v m s eq 25 27 represents the implicit lsf of the scr considering effective tension and stress the failure condition of the scr is given by g i h s t z v c 0 where i 1 2 3 failure occurs when any one of these conditions is satisfied t min 0 t m a x exceeds the allowable tension t a or s v m s exceeds the allowable stress s a at the given location consequently this paper formulates the scr reliability assessment as a series problem for demonstration t a for the given location is assumed to be 3500 kn also as described by the american petroleum institute api standard s a 0 67 σ y for the scr in operating condition with yield stress σ y api 2013 the failure modes of the scr is expressed as a series system eq 28 28 p f s p u i 1 n g i h s t z v c 0 w h e r e n 3 29 g s c r h s t z v c m i n g 1 h s t z v c g 2 h s t z v c g 3 h s t z v c table 9 shows the enrichment of the system lsf eq 29 and reliability analysis results of the scr using the framework described in section 2 fig 11 shows the convergence plot from the initial ed using the apckkm mcs approach for the scr 4 2 5 predictive metamodel response for scr the predictive capacity of the constructed scr metamodel is evaluated using fifteen 15 mcs points the results show that metamodel apckkm mcs response results are close to the fea responses effective tension and stress from flexcom the cluster of response points on a straight line fig 12 proves the metamodel s effectiveness to predict actual stress and tension on the scr 4 2 6 scr safety compliance using apckkm mcs model for site specific scr safety design reliability assessment results are compared with a target p f the target probability can be national international or facility owner s requirements more specifically the scr reliability results in operating condition using apckkm mcs metamodel table 9 is compared with the target p f for serviceability condition using the det norske veritas dnv requirement for dynamic risers dnv 2001 table d 1 appendix d shows the dnv serviceability limit state requirement from the dnv standard the safety classes described in table d 1 refer to the level of risk to humans and the environment arising from scr failure from the reliability results p f s 8 795e 2 as shown in table 9 for the operating condition the scr can be classed under the normal safety class from the code the normal safety class considers injury to humans and the impact on the environment in the event of scr failure 4 3 discussion of results from the reliability assessment of the benchmark functions it is evident that the deviation of the p f from the mcs reference is relatively smaller for the hybrid metamodels compared to the conventional ak mcs with the apckkm mcs method a deviation of 0 11 for the ten dimensional function table 1 and 0 16 for the infinite slope problem table 2 is observed conversely the ak mcs approach produces the highest deviation with 3 25 for the ten dimensional function table 1 and 2 40 for the infinite slope problem table 2 for the truss and scr with implicit lsf the comparative study of various metamodels tables 5 and 9 reveals that the apckkm mcs approach provides the same accuracy level as the conventional ak mcs and the apck mcs method the computational time reduces considerably using the proposed method when compared to other metamodels presented for the benchmark functions the average cpu time is 45mins and 4 min for the ten dimensional function fig 2 and infinite slope problem fig 4 respectively also time reduction is observed for the truss bar table 5 and the scr table 9 the multiple enrichment using k means clustering and rapid convergence from the combination of the kriging and pce approach reduces the number of computational iterations n i t r during reliability assessment the apckkm mcs metamodel provides a high predictive capacity given input data of random variables from the scr study responses evaluated using this approach are close to those obtained from fea as evident in the alignment of plot points on a straight line for scr tension and stress responses fig 12 consequently obtaining a computationally cheap and efficient method for response determination using the proposed framework the global error ε l o o as determined by the cross validation approach for the truss bar ε l o o 1 06e 7 as seen in table 5 and the scr ε l o o 1 05e 2 from table 9 reveals a high quality of the constructed metamodel making it suitable for response determination and reliability analysis of complex structures regarding the dnv marine riser requirement as detailed in section 4 2 6 an upgrade in the scr safety class to ensure improved reliability during normal operating conditions can be achieved by a reliability based design optimization rbdo scheme for its design parameters this rbdo approach provides a trade off between the design parameters requirements of the scr and achieving a high safety class p f 10 2 10 3 according to the dnv requirement a high safety class table d 1 appendix d will imply a design to reduce the high risk of human injury and significant environmental pollution from system failure the benefit of this is an improved scr design with optimal parameters length diameter material thickness while still achieving a high level of safety compliance requirement for the riser under serviceability condition generally the reliability results help evaluate the compliance level of marine structures to site specific safety standards or regulations for demonstration purpose this paper limits the multiple enrichment of ed to three clusters k 3 only also the scr utilizes three random variables for reliability assessment due to the unavailability of data for other site specific ocean parameters affecting the riser research into a robust metamodel construction for the scr can be considered with data available for other ocean parameters in this study active learning is limited to the u learning function other learning schemes for ed enrichment for the proposed metamodel can be explored in future research 5 conclusions in this paper an active learning hybrid metamodel framework apckkm mcs with multiple point enrichment of ed is proposed for the reliability assessment of marine structures the metamodel is constructed as a combination of pce and kriging models considering their respective advantages and uniqueness the learning and enrichment of ed are achieved using the u learning function and the k means clustering approach respectively the framework is demonstrated on benchmark functions and practical marine structural problems truss bars and scr comparing its performance with the commonly used active learning ordinary kriging metamodel ak mcs and a single point enrichment hybrid model apck mcs the study arrives at the following conclusion 1 as demonstrated the apckkm mcs approach handles a diverse range of reliability problems it includes high dimensional functions nonlinear functions and marine structural problems with implicit lsf the proposed method produces reliable results allows fewer computational model evaluations reduces the computational burden using fea and converges fast minimal iterations to the reference or actual p f 2 a more robust and highly efficient approach that combines state of the art kriging and pce metamodelling methods taking advantage of their capabilities is achieved 3 taking a step ahead with the framework presented to consider multiple ed enrichment using the k means clustering approach with mcs candidate sample points reduces the computational time for reliability analysis as evident in the benchmark examples and marine structural problems 4 apckkm mcs approach also showed a high predictive capacity with limited data fig 12 making it suitable for efficient response determination for marine structures 5 the relatively low model error ε l o o evident in the truss bar and scr cases provides a high level of confidence for the model constructed using apckkm mcs the proposed framework apckkm mcs offers the possibility of applying a combination of metamodels with efficient reliability techniques such as variance reduction methods or subset simulation for reliability based assessment of marine structures with small failure probability 10 5 consequently further research into the performance of multiple enrichment active learning pck using subset simulation method or variance reduction techniques for the reliability of complex marine structures is necessary furthermore its application to a marine riser scr and truss system confirms the suitability of the methodology presented in this paper for the reliability of different types of ocean structures also research into optimal cluster size determination for ed enrichment of high dimensional structural problems is necessary finally an application of the proposed framework to the rbdo of marine systems will be essential credit authorship contribution statement aghatise okoro conceptualization methodology formal analysis software investigation writing original draft writing review editing faisal khan conceptualization methodology writing review editing supervision project administration funding acquisition salim ahmed methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors thankfully acknowledge the financial support provided by the natural sciences and engineering research council of canada nserc through discovery grant and the canada research chair tier i program in offshore safety and risk engineering appendix a kriging parameters mle approach a1 l β σ 2 θ y d e t r 1 2 2 π σ 2 n 2 exp 1 2 σ 2 y f β t r 1 y f β a2 β θ f t r 1 f 1 f t r 1 y a3 σ g 2 θ 1 n y f β t r 1 y f β a4 θ ˆ m l e a r g min θ ε d θ 1 2 l o g d e t r n l o g 2 π σ 2 n f and r represent the regression and correlation matrix respectively pce orthogonal polynomials a5 p j i p k i d i p j i x p k i x f x i x d x δ j k i f j k t h e n δ j k 0 i f j k t h e n δ j k 1 where p j i a n d p k i are candidate polynomials of the i t h variable also f x i x is the probability density function pdf of the i t h variable table a 1 classical orthogonal polynomials xiu em karniadakis 2003 table a 1 distribution type orthogonal polynomial basis ψ k x uniform legendre p k x p k x 1 2 k 1 gaussian hermite h e k x h e k x k gamma laguerre l k a x l k a x г k a 1 k beta jacobi j k a b x j k a b x i a b k where i a b k 2 2 a b 1 2 k a b 1 г k a 1 г k b 1 г k a b 1 г k 1 appendix b table b 1 minimum aic values for variables h s t z and v c table b 1 probability distribution h s m t z s v c m s aic aic aic gaussian 11300 08 11714 27 2405 40 lognormal 11495 82 11610 45 2354 80 exponential 12616 08 19386 39 1569 61 logistic 11330 69 11742 88 2409 65 weibull 10975 31 12013 79 2855 03 gamma 11063 35 11615 62 2783 35 fig b 1 probability distribution fit h s t z and v c fig b 1 appendix c vine copula expressions c 1 f x 1 x n k 1 n f x k j 1 n 1 i 1 n j c i i j i 1 i j 1 f x i x i 1 x i j 1 f x i j x i 1 x i j 1 c 2 i n l θ c i 1 n c u 1 u n θ c i 1 n i n c u 1 u n θ c c 3 a i c 2 i n l θ c 2 k in eq c 1 j represents the trees of the d vine and i represents the edges within each tree of the vine copula l θ c is the loglikelihood function k the number of model parameters u 1 u n ε 0 1 c represents the copula density function f represent the variable cummulative density function cdf and f x k the variable pdf table c 1 bivariate copula functions table c 1 copula type copula function lower tail upper tail copula parameter dependence λ l dependence λ u range θ c clayton u 1 θ c u 2 θ c 1 θ c 2 1 θ c 0 0 gumbel exp i n u 1 i n u 1 i n u 1 θ c 1 θ c 0 2 2 1 θ c 1 frank 1 θ c in 1 e θ c u 1 1 e θ c u 2 1 e θ c 1 0 0 gaussian φ 1 u 1 φ 1 u 1 θ c 0 0 1 1 student t t θ c v t v 1 u 1 t v 1 u 1 θ c t v 1 v 1 1 θ c 1 θ c 2 t v 1 v 1 1 θ c 1 θ c 1 1 v is a parameter of the t copula rosenblatt transformation x in the random vector x x 1 x n with marginal distribution f x i and conditional distribution f x i x 1 x 2 x i 1 the rosenblatt transform is given as z i t x i independent and uniformly distributed 0 1 n aas et al 2009 c 4 t x 1 f x 1 t x 2 f x 2 x 1 t x 3 f x 3 x 1 x 2 t x n f x n x 1 x 2 x n 1 c 5 x u c x u z z i c x i x 1 x i 1 u i u 1 u i 1 inverse rosenblatt transform c 6 x i f 1 x i x 1 x i 1 u i u 1 u i 1 c 1 x i x 1 x i 1 u i u 1 u i 1 where c x i x 1 x i 1 u i u 1 u i 1 is the conditional copula of x and c 1 x i x 1 x i 1 u i u 1 u i 1 the conditional quantile function appendix d table d 1 target failure probability dnv 2001 table d 1 limit state probability basis safety class low normal high serviceability annual per riser 10 1 10 1 10 2 10 2 10 3 ultimate annual per riser 10 3 10 4 10 5 fatigue annual per riser 10 3 10 4 10 5 
20517,metamodel combined with simulation type reliability method is an effective way to determine the probability of failure p f of complex structural systems and reduce the burden of computational models however some existing challenges in structural reliability analysis are minimizing the number of calls to the numerical model and reducing the computational time most research work considers adaptive methods based on ordinary kriging with a single point enrichment of the experimental design ed this paper presents an active learning reliability method using a hybrid metamodel with multiple point enrichment of ed for structural reliability analysis the hybrid method termed as apckkm mcs takes advantage of the global prediction and local interpolation capability of polynomial chaos expansion pce and kriging respectively the u learning function drives active learning in this approach while k means clustering is proposed for multiple point enrichment purposes two benchmark functions and two practical marine structural cases validate the performance and efficiency of the method the results confirm that the apckkm mcs approach is efficient and reduces the computational time for reliability analysis of complex structures with nonlinearity high dimension input random variables or implicit limit state function keywords structural reliability polynomial chaos kriging active learning function monte carlo simulation experimental design nomenclature abbreviations aic akaike information criterion cdf cumulative density function cov coefficient of variation cpu central processing unit d vine drawable vine ed experimental design fea finite element analysis form first order reliability method fpso floating production storage and offloading lars least angle regression selection lhs latin hypercube sampling lsf limit state function mcs monte carlo simulation mle maximum likelihood estimation pce polynomial chaos expansion pck polynomial chaos kriging pdf probability density function rbdo reliability based design optimization scr steel catenary riser sorm second order reliability method tdp touch down point 1 introduction complex marine structures operating in the harsh and remote ocean environment require higher reliability to ensure safety of life asset and the environment throughout their operational life to ensure higher reliability one would need efficient and robust reliability assessment models weinmeister et al 2019 there have been efforts to develop and use metamodels for engineering structures and systems this ranges from but not limited to polynomial regression artificial neural network support vector regression polynomial chaos expansion pce and kriging weinmeister et al 2019 ocean structures are complex in their physical and functional form with mainly implicit or no closed form limit state function lsf describing their various failure modes bai and jin 2016 for such structures metamodel choice becomes crucial in the limit state design ultimate serviceability and fatigue among these metamodels kriging and pce are non intrusive and have gained wide application for reliability assessment in various engineering fields including marine structures teixeira and soares 2018 pce is a well established metamodel and has wide application in mathematics and engineering it started as a stochastic finite element analysis fea concept in the 90s ghanem and spanos 1997 the method gained usefulness in reliability analysis as a metamodel in the 2000s sudret and der kiureghian 2002 pce is a spectra based metamodelling approach that expresses the system response of finite variance in terms of the polynomial of its input variables it comprises a series of multivariate orthogonal polynomials and their corresponding coefficients the pce approach is relatively simple to construct it provides an easy estimation of the global statistics of the system s response which includes the statistical moment and distribution pce model allows for the computation of sensitivity analysis and it is efficient for resampling purposes marelli sudret 2019 similarly kriging is an interpolation technique that originated in geostatistics the system s response is assumed to follow a gaussian process with a given covariance structure the approach explores the correlation information of existing data samples to obtain the output for new input points it captures the local variability of the response as a function of the neighbouring data points kriging is flexible to a wide range of correlation functions provides a strong interpolation capability among the data points and can produce the mean prediction and associated variance for output response also the statistical information from the output response can be utilized for model refinement through an adaptive process santner et al 2003 various marine related studies have applied the kriging and pce technique in prediction and reliability studies chi et al 2017 demonstrated the legendre pce method s application in the statistical analysis of crosstalk in wire harness for naval ships ni et al 2018 applied the concept of pce in dynamic response analysis of marine risers zhang et al 2021 studied the uncertainty propagation and sensitivity analysis of a marine vehicle s shafting system using the generalized pce method bahmyari et al 2017 research considered the effect of a combination of pce and the galerkin method for the bending analysis of deformable plates lim et al 2018 utilized pce in developing long term surge motion analysis for a moored offshore vessel in another study nguyen et al 2019 developed a pce framework for extreme load analysis of a single body wind energy converter the reliability assessment of subsea anchors using the pce approach also showed its application to subsea facilities charlton rouainia 2019 hu et al 2019 investigated the performance of second and third order pce in hydrological modelling the concept of developing a pce metamodel has also gained practical application in marine concrete analysis bastidas arteaga et al 2020 applied the pce method in uncertainty propagation and sensitivity analysis of chloride induced corrosion on marine concrete structures furthermore kriging metamodels have found wide application in marine science and technology below are some research related applications of kriging in reliability analysis of marine structures and maritime operations morató et al 2019 applied kriging for the reliability analysis of an offshore wind energy converter s monopile support structure teixeira et al 2019 proposed an approach to reduce the computational effort in the fatigue stress analysis of an offshore wind tower using the kriging method gaspar et al 2014 studied kriging s efficiency in developing metamodels for marine structures with its application to a stiffened plate the study showed the superiority of kriging over the polynomial regression method in structural reliability assessment chen et al 2016 applied a combination of kriging metamodels for flexible risers optimal design hill et al 2016 developed a kriging model for motion response monitoring of floating production storage and offloading fpso mooring lines for a vessel shaped fish farm mooring system kriging was applied for optimization purpose li et al 2019 shi et al 2015 developed a metamodel using kriging for reliability assessment of a marine vessel s bottom plate subject to environmental load kriging has also found application in offshore semi submersible reliability assessment xu et al 2018 brandt et al 2017 demonstrated the application of kriging in the fatigue assessment of an offshore wind turbine s jacket support structure wang et al 2019 investigated the optimization of an autonomous underwater vehicle s appendage using kriging abdalla et al 2018 demonstrated the application of kriging in the investigation of the effect of chemicals on worker s exposure at new positions on a coastline bian et al 2019 applied the concept of kriging to monitor the marine environment in coastal china zhang et al 2018 used the interpolation ability of kriging in determining the possibility of drilling sections of formations in oil and gas drilling operations the kriging and pce metamodels can capture local variability and global behaviour of the output response respectively which is a significant strength of these models the polynomial chaos kriging pck method combines these advantages of kriging and pce to produce a robust metamodel that can reduce the rigour involved with computational models schöbi et al 2015 recently research focus has been on combining metamodels for efficient reliability assessment especially in aerospace related research cheng and lu 2020 study focused on developing a metamodel ensemble for reliability assessment pck metamodel has been applied in airfoil and aircraft engine nacelle analysis weinmeister et al 2019 also leifsson et al 2020 utilized pck metamodel in the yield estimation of multiband patch antennas unlike the broad application of pce and kriging in various engineering design areas the potential advantage of pck has not been widely explored especially in the reliability assessment of marine structures this study aims to achieve the following objectives 1 develop an active learning pck framework for marine structure reliability combining pce and ordinary kriging advantages 2 implement a multiple sampling point experimental design ed enrichment of pck metamodel by k means clustering to reduce computational time during reliability analysis rather than a single point enrichment as commonly adopted in active learning studies 3 to present a practical application of the developed framework for marine structural reliability assessment the proposed method is described in this paper as an active learning polynomial chaos kriging using k means clustering apckkm mcs the remainder of this paper is organized as follows section 2 describes the preliminaries of active learning metamodels and reliability section 3 details the methodology with illustrative examples section 4 presents case studies applying the apckkm mcs approach in the reliability based analysis of a truss system and a steel catenary riser scr under operating condition section 5 concludes the study 2 preliminaries 2 1 metamodels with the burden from computational models for complex structures metamodels provide an inexpensive way to approximate input and output relationships using cheap to evaluate analytical models this section will establish the fundamentals of kriging and pce required in pck construction 2 1 1 kriging kriging structure comprises a trend and stochastic part with the latter represented by a stationary gaussian process of zero mean and unit standard deviation equation 1 is a typical representation of the kriging model 1 y m k x β t f x σ g 2 z x β t f x σ g 2 represents the mean value trend function and the variance of the gaussian process respectively the notation z x denotes the stationary gaussian process which is determined by the autocorrelation function r also the response approximation using kriging metamodel is represented as m k x the kriging model parameters such as the coefficient of the trend function β process variance σ g 2 and the hyperparameters θ of the stationary gaussian process are determined by the maximum likelihood estimation mle approach as shown in eq a 1 a 4 of appendix a for the stochastic term kernel selection for the kriging model is made from a range of autocorrelation functions such as linear exponential gaussian and mat e rn this study adopts the more generalized mat e rn autocorrelation function santner et al 2003 with shape parameter ν s 5 2 as shown in eq 2 2 r x x l ν s 5 2 i 1 m 1 5 x x l i 5 x i x i 2 3 l i 2 e x p 5 x i x i l i 2 from the expression x are sample points and l is the correlation length the kriging unique predictor is based on available observation and response data the predicted mean μ y ˆ at a given point gives the output eq 3 finally the predicted variance eq 4 provides further information about the uncertainty of the mean 3 μ y ˆ x f x t β r x t r 1 y f β 4 σ 2 y ˆ x σ 2 1 r t x r 1 r x v t x f t r 1 f 1 v x where 5 v x f t r 1 r x f x r x represents the cross correlation vector between prediction point x and n sample points eq 6 6 r x r θ x x 1 r θ x x 2 r θ x x n 2 1 2 pce pce is a weighted sum of multivariate orthogonal polynomials and considers a finite output variance equation 7 shows the structure of a pce model 7 y m p c e α n m y α ψ α x ψ α x is the polynomial basis function of the multivariate polynomial and y α represents the coefficients of the function the family of orthogonal polynomials satisfies an inner product requirement eq a 5 appendix a the multivariate polynomials are a tensor product of univariate polynomials as shown in eq 8 these polynomials follow the orthogonality condition eq 9 8 ψ α x i 1 m ψ α i x i 9 e ψ α ψ β d x ψ α ψ β f x x d x δ α β there is a natural relationship between orthogonal polynomials and probability distribution the wiener askey scheme attributes specific orthogonal polynomials to a given probability distribution of the random variables xiu and em karniadakis table a 1 appendix a shows the families of orthogonal polynomials and the associated distribution for situations with no specific basis for the distribution type an isoprobabilistic transformation to the desired distribution type in the conventional askey scheme basis is considered lebrun and dutfoy 2009 the pce approach suffers from the curse of dimensionality as shown in eq 10 where the number of required polynomials grows exponentially both in degree and dimension the result increases the computational expense of the model consequently there is a need for truncation of the terms of the polynomial 10 p o p n d p n d p o is the number of terms in the pce n d represents the dimensionality of the random variable and p is the maximum order of the basis polynomial the truncation of the orthogonal polynomial infinite series is achieved using a sparse algorithm that disregards interactive terms and penalizes higher order terms while selecting a p that minimizing the cross validation error fajraoui et al 2017 this approach increases the robustness of the method and prevents overfitting the least angle regression selection lars provides an algorithm that allows for appropriate truncation considering only the orthogonal basis s non zero terms this study adopts lars for its successful application in obtaining the best sparse set blatman and sudret 2011 equation 11 and eq 12 shows the penalized least square with regularization γ and leave one out error l o o which needs to be minimized to obtain the best sparse set of coefficients l o o is a cross validation error which prevents the common overfitting problem peculiar to pce lataniotis et al 2019 11 y α a r g m i n 1 n i 1 n y t ψ α x i m x i 2 γ α a y α 12 l o o 1 n i 1 n m x i m y ˆ i x i 2 v a r y from eq 11 and eq 12 n represents the number of samples points in the ed v a r y denotes response data variance and m y ˆ i x i represents the model response with the exclusion of a data point from the ed 2 1 3 the hybrid metamodel pck to harness the advantage of the commonly used kriging and pce meta modelling technique the sparse pce term as shown in eq 7 is utilized as the trend function in eq 1 the hybrid model effectively combines kriging and pce s model advantage as highlighted in the introduction section and develops a more robust metamodel for reliability assessment of marine structures equation 13 shows a typical pck expression with a polynomial type trend term 13 y m p c k x α a y α ψ α x σ g 2 z x in this approach the sparse polynomial set obtained from the lars algorithm is ranked based on its correlation with the residual obtained and introduced individually as a trend function in the kriging model eq 1 in the process the error is determined at each iterative step until the trend function contains all sparse set of polynomials initially defined the iterative action which minimizes l o o is determined and used as the optimal pck model the calibrated model then serves as a metamodel for response determination the least square minimization approach has the obvious advantage of using an arbitrary number of input points to determine the coefficients if they represent the random input variables 2 2 active learning function and ed enrichment in recent times the enrichment of ed in metamodel construction has become an attractive means to reduce computational cost the enrichment concept reduces the performance function s computational evaluation and improves the metamodel s efficiency and accuracy it selects the next best point in an iterative pattern from the candidate sample pool until it meets the stopping criteria research is still focused on developing active learning functions although these are mainly variants of the existing learning functions the efficient global optimization ego method for computational cost reduction pioneered the concept of active learning jones et al 1998 other active learning methods have developed after the ego approach the expected feasibility function eff bichon et al 2008 and the u function echard et al 2011 selects points from the candidate population with consideration of sample points close to the limit state surface and with considerable uncertainty of the prediction lv et al 2015 proposed the h function which considers sample points with significant prediction error and information entropy close to the limit state surface also sun et al 2017 proposed the least important function lif which considers the improvement of p f of the kriging model with enrichment of the ed although there exist several active learning functions they are rarely applied practically because of their difficulty in implementation however u function stands out in its simplicity in implementation and fast convergence consequently it will be used for active learning in this paper more specifically the u function selects from the candidate pool the sample with the maximum probability of misclassification the u function is premised on the fact that the sign of the performance function affects the next point required for enrichment the probability of misclassification p m i s is shown in eq 14 14 p m i s ф μ g ˆ x σ g ˆ where u x μ g ˆ x σ g ˆ the sample point which minimizes u x eq 15 has a high tendency to change the sign in the vicinity of the limit state surface and is considered the next new point in the ed the smaller the u x value the more prediction uncertain the sign is for the lsf the stopping criterion of the u function is set as min u x 2 15 x n e w a r g m i n u x for x s p where s p is the sample population the initial development and application of active learning methods have focused on ordinary kriging taking advantage of its interpolation and stochastic capabilities also a single point enrichment has been the focus of the active learning methods developed the enrichment of ed is usually achieved by the next best point from the candidate pool as described in eq 15 while most active learning approaches in the literature have enriched the ed with a single point this paper considers multiple enrichment using the weighted k means clustering approach zaki and meira 2014 the clustering weight is determined by p m i s eq 14 the approach significantly reduces the number of iteration while still maintaining the quality of the metamodel and accuracy of the p f 2 3 structural reliability structural reliability aims at determining the probability of failure of structures given random input variables g x represents the lsf that characterizes the performance of the system the limit state surface g x 0 divides the standard normal plane into safe g x 0 and failure regions g x 0 the integral of a joint pdf f x x in the failure domain determines p f eq 16 x represents the random input vector where x x 1 x n t for the joint pdf it is challenging to obtain a closed form solution for this integral 16 p f g x 0 f x x d x the gradient based reliability approach based on taylor s expansion series and the simulation type methods provide an alternative in the determination of the structural system p f examples of this approach include the first order reliability method form and second order reliability method sorm zhao and ono 1999 however the gradient based method presents difficulty in dealing with nonlinear and complex lsf system reliability problems and multiple design points the simulation methods include monte carlo simulation mcs and variance reduction methods like importance sampling is ang et al 1992 line sampling pradlwarter et al 2007 and subset simulation au and beck 2001 the mcs method eq 17 is straightforward to implement independent of the type of lsf and distribution of the input variables mcs has gained useful application in various engineering areas from eq 17 n m c s and n g x 0 represents the sampling size and samples in the failure domain or on the limit state surface respectively also eq 18 shows the coefficient of variation cov which signifies the uncertainty in p f from the mcs approach melchers and beck 2018 17 p f n g x 0 n m c s 18 cov 1 p f p f n m c s the difficulty of mcs application in the reliability assessment of finite element models due to the computational burden during analysis has led to the concept of metamodels to simplify the reliability evaluation of complex engineering systems 3 methodology this section describes the sequential steps for reliability assessment using the proposed apckkm mcs approach for clarity two benchmark functions further explain the framework 3 1 procedural steps step 1 obtain statistical parameters probability distribution and dependency information where necessary of random variables from observation data in this paper the dependence between random variables is determined using copula functions copulas serve as links between univariate marginals and significantly capture tail dependence and nonlinear relationship between random variables nelsen 2006 step 2 with the pdf of the input distribution generate candidate sample points using mcs n m c s the sample points required for ed enrichment at each iterative step are drawn from the candidate pool step 3 initial sampling plan and points of data are determined the study adopts a type of ed called latin hypercube sampling lhs lhs is a space filling method for generating sample points of random variables for metamodel construction forrester et al 2008 the ed is dependent on the dimension of random input variables for the initial ed although there are no agreed methods to determine the number of samples required one of the pioneering works on active learning echard et al 2011 suggested a small initial ed for this purpose about a dozen sample points for systems with random input variables less than twelve 12 this study adopts an initial ed of at least 12 sample points for random variables greater than 12 the initial ed utilized equals the number of random variables where applicable step 4 with a computational model or experiment obtain structural responses for the quantity of interest using the initial ed obtained in step 3 step 5 train the proposed metamodel using initial ed step 3 and responses obtained in step 4 section 2 describes the construction process of the metamodel step 6 obtain candidate pool response with developed apckkm mcs metamodel consequently obtain prediction sign required for candidate pool sample classification and the p f step 7 develop weighted k means clusters in the candidate pool using the u learning function determine the min u x for k means clusters step 8 the min u x which represents the potential enrichment points to the ed are checked against the stopping criteria u x 2 if the possible enrichment points meet the stopping criteria then mcs sufficiency is tested otherwise update the ed in step 5 with the best new sample points and their corresponding responses step 9 determine the candidate pool sufficiency if the cov is less than 5 accept the p f otherwise the candidate sample pool is updated accordingly and the process repeated fig 1 shows the procedure described above for reliability assessment using apckkm mcs in this paper code implementation for reliability analysis is in matlab based software uqlab marelli and sudret 2014 3 2 illustrative examples using benchmark functions this section explains the framework described in section 3 1 using two benchmark functions the reliability results obtained from the proposed method are compared with active learning ordinary kriging metamodel ak mcs and active learning pck with a single point enrichment approach apck mcs 3 2 1 ten dimensional nonlinear function the ten dimensional function is highly nonlinear and shows the relationship between independent random input variables x and the corresponding response g x 19 g x i 1 10 x i 2 10 x 1 2 x 2 2 i 2 9 x i 2 x i 1 2 16 the steps detailed in section 3 1 are applied to the function for metamodel development and reliability assessment step 1 all variables of the ten dimensional function are assumed to be statistically independent and normally distributed x i n 1 0 2 f o r i 1 2 10 step 2 the mcs candidate pool required for the enrichment of the ed comprises of n m c s 10 6 sample points for the input variables of known distribution step 3 the initial ed comprises twelve 12 lhs sampling points for metamodel training step 4 determine the responses g x of the initial sampling points obtained in step 3 step 5 using the initial ed sampling points step 3 and the corresponding responses step 4 the proposed metamodel is constructed as described in eqs 1 13 of section 2 the conventional hermite orthogonal polynomial xiu karniadakis 2002 is selected as the polynomial basis in the metamodel construction with normally distributed variables step 6 the signs for candidate sample points and reliability are determined using the developed metamodel step 7 points with the probability of misclassification are determined using the u learning function this paper considers three clusters k 3 for the weighted k means clustering steps 8 9 next best points from the clusters enrich the ed and the iterative process continues as shown in fig 1 until u x 2 in the candidate pool for reliability analysis the stopping criterion is cov 0 05 the reliability results table 1 obtained with multiple enrichment apckkm mcs are compared with the single sample point enrichment case apck mcs and the conventional ordinary kriging active learning ak mcs also in table 1 is the number of model evaluations n m o d which indicates the number of calls to the numerical metamodel especially when dealing with implicit lsf the number of iteration n i t r required in achieving the stopping condition as shown in the framework fig 1 is also detailed in table 1 the average central processing unit cpu time indicates the average time of convergence of a metamodelling approach simulation is implemented using an i7 7500u 2 90 ghz cpu with an 8 gb memory computer the average cpu time from 40 runs of the proposed method apckkm mcs is compared with apck mcs and ak mcs using the same starting ed fig 2 3 2 2 infinite soil slope problem this section applies the same framework and procedure described in section 3 2 1 to an infinite slope model fig 3 which characterizes soil slope stability subject to water infiltration phoon 2008 equation 20 shows the lsf for the infinite slope problem 20 p γ h h h γ s a t γ w c o s θ t a n γ h h h γ s a t s i n θ 1 the parameters γ and γ s a t in eq 20 are obtained from eq 21 and eq 22 respectively 21 γ γ w g s 0 2 e 1 e 22 γ s a t γ w g s e 1 e 23 u h h h six 6 random variables as shown in table 2 are considered for the infinite slope model the random variables are assumed statistically independent for simplicity of analysis the candidate pool consists of 10 6 mcs sampling points first to train the apckkm mcs metamodel for the infinite slope problem an initial ed containing 12 lhs sampling points and the corresponding response is determined classical orthogonal polynomial related to the probability distribution of infinite slope random variables determines the polynomial basis eq 8 for the uniformly distributed random input variables the legendre polynomial is selected and the hermite orthogonal polynomial for other input random variables of the slope model the lars approach determines the appropriate polynomial truncation for the trend function as detailed in section 2 multiple enrichment of ed for the infinite slope function is achieved using the k means clustering approach k 3 all stopping criteria and learning function as shown in fig 1 are applied to the infinite slope model using the mle approach eq a 1 a 4 table a 1 appendix a the parameters of the metamodel is determined table 3 shows the results of the reliability analysis using the proposed method the results obtained from the reliability assessment are compared with other metamodel types of the same initial ed table 3 fig 4 shows the computational time average from 40 runs of the various metamodels using the same initial ed the illustrative examples show that the results obtained from the combination of pce and kriging apckkm mcs apck mcs comparatively provides a better reliability approximation than the metamodel constructed by ordinary kriging apck mcs 4 application of the proposed metamodel to marine structures this section presents the practical engineering application of the framework described in section 3 in the reliability based design of marine structures the proposed approach apckkm mcs is applied to a 10 bar truss structure and a marine riser scr 4 1 ten bar truss structure truss system has practical application in various aspects of engineering some marine structural application includes offshore vessel guard rails derrick structures crane booms jacket platforms and truss type jack up leg structures this section considers a 10 bar truss system the schematic diagram in fig 5 shows the truss bar system ten 10 random input variables are considered with statistical parameters shown in table 4 the probabilistic parameters considered include the length of the bars l the sectional area of the truss bar a elastic modulus e and the applied point load on the bar p the horizontal and vertical bars are assumed to be of equal length all input variables are considered statistically independent the allowable vertical displacement of the 10 bar system at a given point c as shown in fig 5 is 0 005 equation 24 shows the implicit lsf of the truss system 24 g x 0 005 δ y the framework described in section 3 is applied to the truss system with regards to the initial ed for the truss system this paper utilizes 15 lhs points the metamodel construction basis is the hermite orthogonal polynomial with a nonlinear transformation of the lognormal distribution the vertical displacement of the truss system δ y is obtained from fea a displacement representation of the 10 bar truss system due to applied load is shown in fig 6 the enrichment of the ed is from the candidate pool n m c s 10 6 multiple point enrichment k 3 is utilized from weighted k means clusters in the pool the determination of truss displacement for ed enrichment is achieved using the fea approach with the stopping criteria met table 5 summarises the results obtained using the proposed method fig 7 shows the apckkm mcs reliability plot with iterative steps from the initial ed sample points while meeting the stopping criteria 4 2 scr application as shown in fig 8 scr has practical application in various aspects of oil and gas activities ranging from product export to gas and water injection during petroleum production activities tension leg platforms semi submersibles spars and fpso units are amongst the structures where scr has been successfully applied bai bai 2005 this study considers the prevailing environmental conditions of the flemish pass basin the basin has a huge potential for oil and gas exploration and located about 400 km offshore st john s newfoundland canada this study limits the environmental condition to the wave and current loads acting on the scr during normal operating condition due to data availability two essential points of the scr are the touch down point tdp as shown in fig 8 where the scr makes contacts with the seabed while operating and the scr connection to the offshore vessel the scr is assumed to be free hanging from the flex joint and connected to an fpso on its starboard side the operating depth of the scr in the basin is considered 1190m and the internal transport fluid is crude oil table 6 provides more details of the scr and fpso for this study 4 2 1 statistical parameters and probability distribution determination the significant wave height h s zero crossing period t z and mean surface current v c represents the sea load random variables assumed to be acting on the scr during operations in the flemish pass the statistical summary of the annual environmental operating conditions including the dominant wave and current directions table 7 for the flemish pass is obtained from site specific met ocean data c core 2017 the environmental data is fitted to continuous probability distributions to determine the best fit for the random variables the mle approach is adopted using the minimum akaike information criterion aic to fit various data distribution table b 1 and figure b 1 appendix b the distribution selection is based on the minimum aic with weibull distribution selected for h s and v c for t z the lognormal distribution is selected as shown in table 7 4 2 2 scr dependence modelling of variables the dependence between random variables h s t z and v c is considered in this study and determined using a unique type of copula called the drawable vine d vine copula the d vine copula can handle dependence between variables by the process of decomposition aas et al 2009 the vine is graphically oriented with the dependence relationships between scr random variables in tree 1 of the vine structure and conditional relationships in tree 2 fig 9 for the vine structure the non parametric kendall tau τ k values between the variables are essential in determining the architecture and dependence of the vine trees using sklar s theorem and the minimum aic approach nelsen 2006 the copula s optimal selection is determined from a set of bivariate copulas the bivariate copulas considered for selection are the gaussian t clayton gumbel frank and independent copulas table c 1 appendix c table 8 shows the selected copulas based on minimum aic values it also shows the associated copula parameter θ c and rotation θ r of the vine structure using eq c 1 eq c 3 of appendix c the clayton and rotated clayton 270 o copulas are selected for modelling dependency between the scr s random variables as shown in tree 1 of the d vine structure table 8 4 2 3 initial ed and scr responses following the determination of the optimal copulas for the scr the vectors of dependent random variables with continuous marginals are mapped isoprobabilistic transform onto independent random variables using the rosenblatt transformations eq c 4 eq c 6 table c 1 appendix c consequently independent samples required for initial ed and metamodel construction are obtained an initial ed which comprises 20 lhs points of sea state data is generated with corresponding responses obtained through a time domain dynamic strength analysis of the scr using flexcom flexcom 2019 the random sea wave characteristics are modelled using the pierson moskowitz spectrum a widely used spectrum in wave analysis of structures operating in deepwater massel 1996 for this demonstration the seabed of the flemish pass is modelled as elastic and flat scr responses considered include the maximum and minimum effective tension t m i n t m a x and the maximum von mises stress s v m s in operating condition from the scr effective tension profile obtained for response analysis fig 10 t m i n is observed within the seabed and touchdown zone 0 600m of the scr and t m a x at the flex joint region 1955m for all ed point considered also stress s v m s for the scr is observed about the touchdown zone 400 600m 4 2 4 metamodel multiple enrichment and reliability analysis with the tension and stress responses obtained for the scr and corresponding lhs points as detailed in section 4 2 3 the apckkm mcs metamodel is constructed for the scr system as described in section 2 and further enriched from n m c s 10 6 candidate samples using the weighted k means clustering approach k 3 based on the probability distribution of the random variables and an isoprobabilistic transformation the classical hermite orthogonal polynomial is used as the basis of the trend term 25 g 1 h s t z v c t min t min 0 26 g 2 h s t z v c t a t max 27 g 3 h s t z v c s a s v m s eq 25 27 represents the implicit lsf of the scr considering effective tension and stress the failure condition of the scr is given by g i h s t z v c 0 where i 1 2 3 failure occurs when any one of these conditions is satisfied t min 0 t m a x exceeds the allowable tension t a or s v m s exceeds the allowable stress s a at the given location consequently this paper formulates the scr reliability assessment as a series problem for demonstration t a for the given location is assumed to be 3500 kn also as described by the american petroleum institute api standard s a 0 67 σ y for the scr in operating condition with yield stress σ y api 2013 the failure modes of the scr is expressed as a series system eq 28 28 p f s p u i 1 n g i h s t z v c 0 w h e r e n 3 29 g s c r h s t z v c m i n g 1 h s t z v c g 2 h s t z v c g 3 h s t z v c table 9 shows the enrichment of the system lsf eq 29 and reliability analysis results of the scr using the framework described in section 2 fig 11 shows the convergence plot from the initial ed using the apckkm mcs approach for the scr 4 2 5 predictive metamodel response for scr the predictive capacity of the constructed scr metamodel is evaluated using fifteen 15 mcs points the results show that metamodel apckkm mcs response results are close to the fea responses effective tension and stress from flexcom the cluster of response points on a straight line fig 12 proves the metamodel s effectiveness to predict actual stress and tension on the scr 4 2 6 scr safety compliance using apckkm mcs model for site specific scr safety design reliability assessment results are compared with a target p f the target probability can be national international or facility owner s requirements more specifically the scr reliability results in operating condition using apckkm mcs metamodel table 9 is compared with the target p f for serviceability condition using the det norske veritas dnv requirement for dynamic risers dnv 2001 table d 1 appendix d shows the dnv serviceability limit state requirement from the dnv standard the safety classes described in table d 1 refer to the level of risk to humans and the environment arising from scr failure from the reliability results p f s 8 795e 2 as shown in table 9 for the operating condition the scr can be classed under the normal safety class from the code the normal safety class considers injury to humans and the impact on the environment in the event of scr failure 4 3 discussion of results from the reliability assessment of the benchmark functions it is evident that the deviation of the p f from the mcs reference is relatively smaller for the hybrid metamodels compared to the conventional ak mcs with the apckkm mcs method a deviation of 0 11 for the ten dimensional function table 1 and 0 16 for the infinite slope problem table 2 is observed conversely the ak mcs approach produces the highest deviation with 3 25 for the ten dimensional function table 1 and 2 40 for the infinite slope problem table 2 for the truss and scr with implicit lsf the comparative study of various metamodels tables 5 and 9 reveals that the apckkm mcs approach provides the same accuracy level as the conventional ak mcs and the apck mcs method the computational time reduces considerably using the proposed method when compared to other metamodels presented for the benchmark functions the average cpu time is 45mins and 4 min for the ten dimensional function fig 2 and infinite slope problem fig 4 respectively also time reduction is observed for the truss bar table 5 and the scr table 9 the multiple enrichment using k means clustering and rapid convergence from the combination of the kriging and pce approach reduces the number of computational iterations n i t r during reliability assessment the apckkm mcs metamodel provides a high predictive capacity given input data of random variables from the scr study responses evaluated using this approach are close to those obtained from fea as evident in the alignment of plot points on a straight line for scr tension and stress responses fig 12 consequently obtaining a computationally cheap and efficient method for response determination using the proposed framework the global error ε l o o as determined by the cross validation approach for the truss bar ε l o o 1 06e 7 as seen in table 5 and the scr ε l o o 1 05e 2 from table 9 reveals a high quality of the constructed metamodel making it suitable for response determination and reliability analysis of complex structures regarding the dnv marine riser requirement as detailed in section 4 2 6 an upgrade in the scr safety class to ensure improved reliability during normal operating conditions can be achieved by a reliability based design optimization rbdo scheme for its design parameters this rbdo approach provides a trade off between the design parameters requirements of the scr and achieving a high safety class p f 10 2 10 3 according to the dnv requirement a high safety class table d 1 appendix d will imply a design to reduce the high risk of human injury and significant environmental pollution from system failure the benefit of this is an improved scr design with optimal parameters length diameter material thickness while still achieving a high level of safety compliance requirement for the riser under serviceability condition generally the reliability results help evaluate the compliance level of marine structures to site specific safety standards or regulations for demonstration purpose this paper limits the multiple enrichment of ed to three clusters k 3 only also the scr utilizes three random variables for reliability assessment due to the unavailability of data for other site specific ocean parameters affecting the riser research into a robust metamodel construction for the scr can be considered with data available for other ocean parameters in this study active learning is limited to the u learning function other learning schemes for ed enrichment for the proposed metamodel can be explored in future research 5 conclusions in this paper an active learning hybrid metamodel framework apckkm mcs with multiple point enrichment of ed is proposed for the reliability assessment of marine structures the metamodel is constructed as a combination of pce and kriging models considering their respective advantages and uniqueness the learning and enrichment of ed are achieved using the u learning function and the k means clustering approach respectively the framework is demonstrated on benchmark functions and practical marine structural problems truss bars and scr comparing its performance with the commonly used active learning ordinary kriging metamodel ak mcs and a single point enrichment hybrid model apck mcs the study arrives at the following conclusion 1 as demonstrated the apckkm mcs approach handles a diverse range of reliability problems it includes high dimensional functions nonlinear functions and marine structural problems with implicit lsf the proposed method produces reliable results allows fewer computational model evaluations reduces the computational burden using fea and converges fast minimal iterations to the reference or actual p f 2 a more robust and highly efficient approach that combines state of the art kriging and pce metamodelling methods taking advantage of their capabilities is achieved 3 taking a step ahead with the framework presented to consider multiple ed enrichment using the k means clustering approach with mcs candidate sample points reduces the computational time for reliability analysis as evident in the benchmark examples and marine structural problems 4 apckkm mcs approach also showed a high predictive capacity with limited data fig 12 making it suitable for efficient response determination for marine structures 5 the relatively low model error ε l o o evident in the truss bar and scr cases provides a high level of confidence for the model constructed using apckkm mcs the proposed framework apckkm mcs offers the possibility of applying a combination of metamodels with efficient reliability techniques such as variance reduction methods or subset simulation for reliability based assessment of marine structures with small failure probability 10 5 consequently further research into the performance of multiple enrichment active learning pck using subset simulation method or variance reduction techniques for the reliability of complex marine structures is necessary furthermore its application to a marine riser scr and truss system confirms the suitability of the methodology presented in this paper for the reliability of different types of ocean structures also research into optimal cluster size determination for ed enrichment of high dimensional structural problems is necessary finally an application of the proposed framework to the rbdo of marine systems will be essential credit authorship contribution statement aghatise okoro conceptualization methodology formal analysis software investigation writing original draft writing review editing faisal khan conceptualization methodology writing review editing supervision project administration funding acquisition salim ahmed methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors thankfully acknowledge the financial support provided by the natural sciences and engineering research council of canada nserc through discovery grant and the canada research chair tier i program in offshore safety and risk engineering appendix a kriging parameters mle approach a1 l β σ 2 θ y d e t r 1 2 2 π σ 2 n 2 exp 1 2 σ 2 y f β t r 1 y f β a2 β θ f t r 1 f 1 f t r 1 y a3 σ g 2 θ 1 n y f β t r 1 y f β a4 θ ˆ m l e a r g min θ ε d θ 1 2 l o g d e t r n l o g 2 π σ 2 n f and r represent the regression and correlation matrix respectively pce orthogonal polynomials a5 p j i p k i d i p j i x p k i x f x i x d x δ j k i f j k t h e n δ j k 0 i f j k t h e n δ j k 1 where p j i a n d p k i are candidate polynomials of the i t h variable also f x i x is the probability density function pdf of the i t h variable table a 1 classical orthogonal polynomials xiu em karniadakis 2003 table a 1 distribution type orthogonal polynomial basis ψ k x uniform legendre p k x p k x 1 2 k 1 gaussian hermite h e k x h e k x k gamma laguerre l k a x l k a x г k a 1 k beta jacobi j k a b x j k a b x i a b k where i a b k 2 2 a b 1 2 k a b 1 г k a 1 г k b 1 г k a b 1 г k 1 appendix b table b 1 minimum aic values for variables h s t z and v c table b 1 probability distribution h s m t z s v c m s aic aic aic gaussian 11300 08 11714 27 2405 40 lognormal 11495 82 11610 45 2354 80 exponential 12616 08 19386 39 1569 61 logistic 11330 69 11742 88 2409 65 weibull 10975 31 12013 79 2855 03 gamma 11063 35 11615 62 2783 35 fig b 1 probability distribution fit h s t z and v c fig b 1 appendix c vine copula expressions c 1 f x 1 x n k 1 n f x k j 1 n 1 i 1 n j c i i j i 1 i j 1 f x i x i 1 x i j 1 f x i j x i 1 x i j 1 c 2 i n l θ c i 1 n c u 1 u n θ c i 1 n i n c u 1 u n θ c c 3 a i c 2 i n l θ c 2 k in eq c 1 j represents the trees of the d vine and i represents the edges within each tree of the vine copula l θ c is the loglikelihood function k the number of model parameters u 1 u n ε 0 1 c represents the copula density function f represent the variable cummulative density function cdf and f x k the variable pdf table c 1 bivariate copula functions table c 1 copula type copula function lower tail upper tail copula parameter dependence λ l dependence λ u range θ c clayton u 1 θ c u 2 θ c 1 θ c 2 1 θ c 0 0 gumbel exp i n u 1 i n u 1 i n u 1 θ c 1 θ c 0 2 2 1 θ c 1 frank 1 θ c in 1 e θ c u 1 1 e θ c u 2 1 e θ c 1 0 0 gaussian φ 1 u 1 φ 1 u 1 θ c 0 0 1 1 student t t θ c v t v 1 u 1 t v 1 u 1 θ c t v 1 v 1 1 θ c 1 θ c 2 t v 1 v 1 1 θ c 1 θ c 1 1 v is a parameter of the t copula rosenblatt transformation x in the random vector x x 1 x n with marginal distribution f x i and conditional distribution f x i x 1 x 2 x i 1 the rosenblatt transform is given as z i t x i independent and uniformly distributed 0 1 n aas et al 2009 c 4 t x 1 f x 1 t x 2 f x 2 x 1 t x 3 f x 3 x 1 x 2 t x n f x n x 1 x 2 x n 1 c 5 x u c x u z z i c x i x 1 x i 1 u i u 1 u i 1 inverse rosenblatt transform c 6 x i f 1 x i x 1 x i 1 u i u 1 u i 1 c 1 x i x 1 x i 1 u i u 1 u i 1 where c x i x 1 x i 1 u i u 1 u i 1 is the conditional copula of x and c 1 x i x 1 x i 1 u i u 1 u i 1 the conditional quantile function appendix d table d 1 target failure probability dnv 2001 table d 1 limit state probability basis safety class low normal high serviceability annual per riser 10 1 10 1 10 2 10 2 10 3 ultimate annual per riser 10 3 10 4 10 5 fatigue annual per riser 10 3 10 4 10 5 
20518,an approximate ship wake solution that accurately predicts both the wake patterns and the wake amplitudes in any water depth is proposed and validated derivation based on the small amplitude wave theory is first revisited treating a ship as a moving pressure field acting on the water surface for ship shapes symmetric about the transverse pitch axis and away from the immediate vicinity of the ship an approximate solution is sought in contrast to the exact analytical solution consisting of a double integral the approximate solution is simplified through analytical means to consist of a single integral singularities inside the integrand of the exact solution have also been removed hence the computational effort is greatly reduced two extreme ship shape functions are considered to plot the solutions a sharp rectangular shape and a smooth gaussian shape the newly derived approximate solution is validated using 37 satellite images of ship wakes one towing tank experiment and two field experiments then water depth effects on wake patterns are discussed providing means to quickly relate the ship shape weight speed and water depth to the wake characteristics the new ship wake solution is a potentially powerful tool in the study of ship wake inversion keywords ship wake small amplitude water wave theory analytical solution sokhotski plemelji formula 1 introduction the wakes left behind by a moving object floating on the water surface have long been an fascinating subject in the study of water waves it is widely observed that the water wakes left behind by a moving object be it a cruise ship a kayak or a duck share similar characteristics regardless of the shape or size of the object in deep water lord kelvin thomson 1887 first showed that the angle formed by the outermost wakes and the centerline of the object s motion to be a constant 1 θ kelvin sin 1 1 3 19 4 7 employing the small amplitude wave theory havelock 1908 examined water waves generated by a moving pressure point source modeling ships as moving pressure sources acting on the water surface many textbooks on water waves e g stoker 1958 newman 1977 lighthill 1978 johnson 1997 presented integral form solutions for ship waves and analyses on ship wave angles although integral form solutions for ship wakes are long known these solutions involve double integrals with improper bounds and discontinuities in the integrands numerically evaluating these integral form solutions is computationally demanding as a result rarely if ever were the full solutions plotted in classical studies on ship wakes this challenge can be bypassed if it is the general ship wake pattern rather than the exact shape of the wake field left by a specific object that is of concern the method of stationary phase is widely employed to analyze the patterns of ship wakes e g ursell 1960 warren 1961 and yih and zhu 1989a and yih and zhu 1989b while most studies on ship wakes make the deep water assumption lee and lee 2019 derived an equation for the ship wave crest locations applicable in the entire range of water depths effects unaccountable by the classical small amplitude wave theory were also examined for example cumberbatch 1965 and liang and chen 2019 discussed the importance of viscous effects hogben 1972 and zhu et al 2008 discussed the importance of nonlinear effects brown et al 1989 and mei and naciri 1991 investigated the soliton packet observed in the wake of a ship chen and sharma 1995 and shi et al 2018 studied the solitary waves generated ahead of a ship traveling near the critical speed in a shallow channel ellingsen 2014 and li and ellingsen 2016 considered the effects of shear currents on ship wakes and grue 2017 and grue 2020 pointed out that mini tsunamis can be generated when a cruiseferry travels across a depth change as remote sensing techniques improve and satellite images have now become easily accessible a new wave of research efforts on ship wakes have begun aguiar and souza 2009 proposed means to estimate ship velocities from google earth satellite images of ship wakes using aguiar and souza 2009 s method rabaud and moisy 2013 analyzed 37 satellite images of ship wakes and discovered that ship wakes generated by high speed boats appear to form a speed dependent mach like cone unlike the conventional kelvin wake studies exploring this newly discovered phenomenon include to name just a few doyle and mckenzie 2013 darmon et al 2014 noblesse et al 2014 pethiyagoda et al 2014 and rabaud and moisy 2014 he et al 2015 the observation of speed dependent ship wake angles seemingly contradicted the celebrated kelvin wake pattern darmon et al 2014 offered a simple explanation the apparent ship wake angles observed in satellite images most likely correspond to waves of the largest amplitudes the kelvin wake pattern still exists in the analytical solutions at least just not as visible while a vast number of studies on ship wakes exist the focus is usually on the wake patterns the amplitudes of the wakes are rarely discussed or validated perhaps partially due to the fact that wake amplitudes cannot be easily inferred from images of ship wakes which are frequently used to aid the studies on ship wake patterns in many practical applications however the wake amplitudes are as important as if not sometimes more important than the wake patterns for example how big are the wakes generated by a certain vessel of a known size and weight as it enters a harbor at a known speed more ambitiously from elevation calibrated images of ship wakes can one infer the weight of a ship conversely can one use the wakes generated by a marine vessel of a known shape and weight to calibrate remotely sensed images and maybe even infer the representative water depths the above questions lead to the subject of ship wake inversion means to link the wakes generated by a ship to the characteristics of the ship see e g wu 1991 griffin et al 1996 liu and deng 2018 sun et al 2018 to facilitate the inversion process a fast and robust method is essential analytical expressions are particularly suitable for this purpose therefore the objective of this study is to propose an approximate analytical solution to quickly calculate the wakes generated by a ship whose shape and weight are known careful attention shall be paid to ensure that both the wake patterns and the wake amplitudes are correctly captured and that the results can be computed with minimal computational effort for completeness and clarity in section 2 we first briefly review the small amplitude wave theory to be employed to derive the analytical solution for ship wakes in section 3 we derive the complete solution for the transient ship wake generation process in section 4 we introduce two ship shape functions to be used in plotting the solutions in section 5 we outline means to acquire the steady state ship wake solution in section 6 we propose an approximate ship wake solution that can be computed quickly in section 7 we validate the approximate ship wake solution in terms of both the wake patterns and the wake amplitudes in section 8 we examine the effects of water depth on the ship wake patterns and demonstrate how the approximate ship wake solution can be utilized to infer the water depth lastly in section 9 we conclude this study 2 small amplitude wave theory the small amplitude water wave theory is often employed to obtain analytical solutions for water waves generated by a moving ship as sketched in fig 1 the moving ship is approximated as a moving pressure field p x y t exerted on the free surface which is linearized to be the still water level z 0 as a result the pressure forces act in the vertical direction the pressure field has a characteristic length of l the water depth is assumed to be constant h and the characteristic wave amplitude a is assumed to be the same as the characteristic pressure head of the pressure field in small amplitude wave theory a is required to be small in comparison to the water depth h i e a h 1 for incompressible and irrotational flows the laplace equation governs this problem the corresponding linear and fully dispersive wave model is well known see for example mei et al 2005 for completeness here we briefly review the derivation process the dimensionless laplace equation and the boundary conditions are 2 μ 2 ϕ x x μ 2 ϕ y y ϕ z z 0 1 z 0 ϕ z 0 z 1 ϕ z μ 2 η t z 0 ϕ t η p z 0 where ϕ x y z t is the velocity potential p x y t is the moving pressure field approximate ship model acting on the still water surface z 0 and η is the water surface elevation using primes to denote dimensional variables we write the dimensionless variables as 3 x x l y y l z z h t t g h l η x y t η x y t a p x y t p x y t ρ g a ϕ x y z t ϕ x y z t a h l g h where l is the characteristic length of the ship a is the characteristic amplitude of the ship induced pressure field in terms of hydraulic head ρ is the density of water g is the gravitational acceleration and μ h l the system of equations in 2 is a classical linear wave problem and can be solved by applying the laplace and fourier transforms in this study the fourier transform of a function f x is defined as 4 f k 1 2 π f x e i k x d x f x 1 2 π f k e i k x d k where the overline denotes the fourier transformation in the x direction a wide tilde is used to denote that in the y direction while k represents the wavenumber in the x space l represents the wavenumber in the y space in addition triple dots are used to denote the laplace transformation in time which converts the time variable t to the frequency variable s the laplace fourier transformed velocity potential can be solved for as 5 ϕ k l z s 1 cosh μ q 1 s 2 q 2 d 2 cosh μ q z 1 s ϕ x y 0 0 η x y 0 s p k l s where 6 q k 2 l 2 will be used throughout the study to simplify the expressions and 7 d tanh μ q μ q is the normalized wave celerity of linear dispersive waves in constant depth the transformed free surface elevation η is then 8 η k l z s s ϕ x y 0 t ϕ x y 0 0 in deriving 5 and 8 the initial conditions imposed are 9 η x y 0 0 ϕ x y 0 0 constant whereas η x y 0 0 means an initially flat water surface ϕ x y 0 0 constant means zero initial horizontal velocities on the still water surface z 0 3 complete analytical solution to further simplify the solutions 5 and 8 we consider a ship that travels in the x direction at a constant speed u in addition to facilitate the extraction of the physical ship wake solution component to be discussed in section 5 we further generalize the ship induced pressure field by allowing it to grow in time exponentially therefore the dimensionless pressure field has the form 10 p x y t e ϵ t p 0 x f r t y in which p 0 is a ship shape function to be specified the froude number f r is based on the linear wave speed 11 f r u g h and ϵ is a non negative constant to be specified the laplace fourier transform of 10 is available in closed form 12 p k l s p 0 k l 1 s i k f r ϵ where 13 p 0 x y p x y 0 is the ship shape function denoting the initial shape of the ship induced pressure field with 12 η in 8 can be inverse laplace transformed to be 14 η x y t η f r x y t η x y t η f r x y t 1 2 π p 0 k l d 2 d 2 k f r i ϵ 2 q 2 e ϵ t e i k x f r t e i l y d k d l η x y t 1 2 π p 0 k l d 2 d k f r i ϵ q e i q d t d 2 d k f r i ϵ q e i q d t e i k x e i l y d k d l eq 14 is the complete analytical solution for water waves generated by a pressure field specified by 10 which suddenly starts moving at a constant speed at t 0 inspecting the exponential terms in 14 we see that η f r moves with the ship in fact η f r can be expressed as 15 η f r x y t e ϵ t η f r x f r t y 0 η f r represents the trapped wave that moves with the ship on the other hand η travels at the linear wave speed d each different wave component travels at a different speed as required by 7 η represents the free waves that propagates freely away from the ship induced perturbation the free waves result from the sudden perturbation the ship suddenly begins traveling a constant speed in quiescent water at t 0 it is often more convenient to express the solutions in polar coordinates by using the substitutions x r cos θ y r sin θ k q cos ψ and l q sin ψ the integral form solutions 14 can be written as 16 η r θ t η f r r θ t η r θ t η f r r θ t 1 2 π 0 2 π 0 q p 0 q ψ d 2 e ϵ t e i q f r cos ψ t e i q r cos ψ θ d 2 q f r cos ψ i ϵ 2 q 2 d q d ψ η r θ t 1 2 π 0 2 π 0 q p 0 q ψ d 2 d q f r cos ψ i ϵ q e i q d t d 2 d q f r cos ψ i ϵ q e i q d t e i q r cos ψ θ d q d ψ 4 ship induced pressure shape functions as indicated by the complete analytical solution 16 the shape of a ship is modeled by the pressure shape function p 0 in this study we consider two ship induced pressure shape functions of extreme characteristics a rectangular shape with sharp corners and a smooth elliptical gaussian shape the rectangular shape resembles the most extreme case of flat bottomed ship hulls flat bottomed ship hulls are often adopted to achieve shallow draft and stability in calm water recreational e g fishing boats and barges in calm water are typical examples of flat bottomed ships the rectangular shape can also be regarded as approximate u shaped ship hulls which are designed to achieve maximal cargo capacity and travel at relatively low speeds typical examples of u shaped ships include oil tankers bulk carriers and to a lesser extent some container ships the gaussian shape is streamlined and can be regarded as an approximation of v shaped hulls v shaped hulls are adopted to achieve high speeds and stability in waves at the expense of interior volume for stowage or accommodations most powerboats have v shaped hulls while the two analytical ship shape functions are oversimplifications of real ship hulls they do represent two extremely different ship hull characteristics it is understood that a real ship hull should be somewhere in between these two extreme shapes as an illustration in fig 2 the rectangular shape and the gaussian shape are compared with the dtmb 5415 hull which was used in lindenmuth et al 1991 s towing tank experiment to be presented in section 7 2 due to the linearity of the small amplitude wave theory solutions calculated using different shape functions can be superposed therefore it is possible to approximate a real ship hull using a combination of elementary ship shape functions however how to accurately represent a realistic ship hull using elementary functions is beyond the scope of this study 4 1 rectangular shape consider a ship of characteristic length l and characteristic width w the aspect ratio of which is denoted as 17 σ w l approximating the ship as a rectangular box results in the dimensional ship induced pressure shape function 18 p 0 x y ρ g a r h x l 2 h x l 2 h y w 2 h y w 2 in which a r is the ship draft based on the rectangular shape and h is the heaviside step function if the mass m of the ship is known then the ship draft a r based on this rectangular shape can be calculated as 19 a r m l w ρ nondimensionalizing 18 gives 20 p 0 x y h x 1 2 h x 1 2 h y σ 2 h y σ 2 whose double fourier transform is 21 p 0 k l 2 π 1 k 1 l sin k 2 sin σ l 2 2 π q 2 cos ψ sin ψ sin q cos ψ 2 sin σ q sin ψ 2 p 0 q ψ 4 2 gaussian shape a smooth and continuous elliptical gaussian shape can also be specified to approximate a ship of characteristic length l defined to be four times its standard deviation in the x direction and characteristic width w defined to be four times its standard deviation in the y direction the dimensional elliptical gaussian ship shape function reads 22 p 0 x y ρ g a g e 8 x l 2 e 8 y w 2 in which the ship draft a g based on the elliptical gaussian shape is linked to the mass m of the ship as 23 a g 8 π m l w ρ we note that for a ship of a fixed mass m the ship draft a g 23 based on the elliptical gaussian shape is 8 π larger than the ship draft a r 19 based on the rectangular shape 24 a g 8 π a r the nondimensional version of 22 reads 25 p 0 x y e 8 x 2 e 8 y σ 2 whose double fourier transform is 26 p 0 k l σ 16 e k 2 32 e l 2 32 σ 2 σ 16 e q 2 32 cos 2 ψ σ 2 sin 2 ψ p 0 q ψ 5 physical ship wake solution ship wakes refer to water waves that follow behind a ship to model a ship as a translating pressure field of a fixed shape it may appear intuitive to set ϵ 0 in 16 and falsely consider η f r to be the ship wake solution however for ϵ 0 η f r is not the physical ship wake solution the reason is the discontinuities that exist in the expression for η in 16 for ϵ 0 the wave components corresponding to f r cos ψ d have infinitely large amplitudes and travel at the same speed as the ship therefore the η term in 16 also contributes to the ship wake solution for ϵ 0 to illustrate this we plot the complete solution 16 and the two solution components in fig 3 at t 2 6 10 with μ 0 5 f r 0 5 ϵ 0 and using the gaussian ship shape 25 with σ 1 it can be see that η f r includes unphysical waves that are sucked in from downstream of the pressure field these unphysical waves are canceled out by identical but differently signed waves in η to better isolate the physical ship wake solution one classical approach see e g lighthill 1978 and raphaël and gennes 1996 is to assume that the pressure perturbation grows in time as has been done in 10 this effectively requires all solutions to be outgoing away from the perturbation then to recover the solution corresponding to a pressure perturbation that does not grow in time the limit ϵ 0 is taken η f r in 16 with ϵ 0 then corresponds to the physical steady state ship wake solution 27 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 q p 0 q ψ d 2 d 2 q f r cos ψ i ϵ 2 q 2 e i q r ship cos ψ θ ship d q d ψ where r ship θ ship are the cylindrical coordinates centered about the ship which travels in the x direction at a dimensionless speed of f r for μ 0 5 f r 0 5 ϵ 0 001 and using the gaussian shape 25 with σ 1 η ship is plotted in fig 4 by comparison with the transient solution shown in the first column of fig 3 we see that η ship indeed represents the physical steady state ship wake solution i e for a ship that has been moving at a constant speed for an infinitely long duration the deep water approximation of the ship wake solution 27 is well known and widely employed to study ship wakes see e g raphaël and gennes 1996 and darmon et al 2014 however we find that the deep water approximation is unnecessary in many of the following mathematical analyses the ship wake solutions discussed in this study involve no assumptions on the water depth they apply to both shallow water and deep water as long as the wave amplitude is small relative to the water depth due to the limitation of the small amplitude water wave theory heeding dias 2014 s advice that the definition of the froude number must be clearly indicated we stress again that the froude number f r used in 27 is based on the linear long wave celerity as defined in 11 6 approximate ship wake solution by neglecting the term multiplied by ϵ 2 since it is one order smaller for ϵ 0 writing out the expressions for d as given by 7 using the ship based froude number more commonly adopted in the ship hydrodynamics community 28 f s u g l f r μ and moving the negative sign in front of the limit sign in 27 to the denominator of the integrand 27 becomes 29 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 q p 0 q ψ tanh μ q e i q r ship cos ψ θ ship q f s 2 cos 2 ψ tanh μ q 2 i ϵ μ f s cos ψ d q d ψ dividing by f s cos ψ f s cos ψ since cos ψ 0 results in a finite integrand the points where cos ψ 0 can be omitted in the integration cos ψ 0 can be implied in the expressions and using the substitution ϵ 2 μ ϵ then yields 30 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship q f s cos ψ tanh μ q f s cos ψ i ϵ d q d ψ as demonstrated by darmon et al 2014 for the deep water ship wake solution the integrand in 30 can be simplified by the sokhotski plemelji formula see e g blanchard and brüning 2003 the sokhotski plemelji formula commonly used in quantum mechanics states that 31 lim ϵ 0 1 x i ϵ pv 1 x i π δ x where pv denotes the cauchy principal value and δ is the dirac delta function for ϵ 0 the integrand in 30 can be expressed using the sokhotski plemelji formula as 32 lim ϵ 0 tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship q f s cos ψ tanh μ q f s cos ψ i ϵ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship lim ϵ 0 1 q f s cos ψ tanh μ q f s cos ψ i ϵ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship pv 1 q f s cos ψ tanh μ q f s cos ψ i π δ q f s cos ψ tanh μ q f s cos ψ the integral form solution 30 then becomes 33 η ship r ship θ ship η ship 1 r ship θ ship η ship 2 r ship θ ship η ship 1 i 2 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ δ q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ η ship 2 1 2 π pv 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ 1 q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ for the same example using the gaussian ship shape function 25 with μ 0 5 f r 0 5 thus f s 0 35 and σ 1 the integral form solution 33 and the solution components are shown in the top row of fig 5 it is observed that both solution components are finite and must be considered and that only the sum of the two solution components yields a physical ship wake solution we emphasize that the sokhotski plemelji formula does not confer a physical meaning on each of the two terms resulting from the decomposition hence each of η ship 1 and η ship 2 does not have a clear physical meaning only the sum of the two η ship η ship 1 η ship 2 corresponds to the physical ship wake solution when studying physical ship wakes the two terms must be considered together the exact ship wake solution η ship in 27 or 33 is difficult and time consuming to compute using numerical integration methods due to the double integrals and the singularities in the integrands details on our numerical integration techniques are provided in appendix a on the other hand we note that li et al 2019 successfully utilized a fast fourier transform algorithm to approximate the double fourier transform in similar integral form ship wake solutions to further reduce the complexity of the analytical solutions for ship wakes we shall discuss means to simplify each of the two solution components η ship 1 and η ship 2 6 1 darmon et al 2014 s solution darmon et al 2014 simplified the deep water equivalent of η ship 1 in 33 to be 34 η darmon r ship θ ship i 2 π 2 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ for which the notations have been changed so that the definitions are consistent with those used in this study in addition an obvious typo in the sign of the exponent has been corrected as also noticed by li and ellingsen 2016 the integration limits for ψ in 34 were incorrect it should be integrated over a range of 2 π consequently the wave amplitude of 34 is incorrect and the imaginary components do not cancel out the corrected version should read 35 η darmon c r ship θ ship i 2 π 2 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ π 2 3 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ the corrected solution 35 is an exact simplification of η ship 1 in 33 in the deep water limit however discontinuities exist when cos ψ 0 as a result only smooth ship shape functions can be considered such as the gaussian shape 25 the integrals become poorly behaving when sharp shape functions are used such as the rectangular shape 20 darmon et al 2014 incorrectly stated that the deep water equivalent of η ship 2 tended to zero for large r ship due to the integrand s becoming fast oscillating thus η ship 2 was falsely classified as the near field solution it is not and discarded in darmon et al 2014 s analysis and other studies that followed the same approach as clearly shown in fig 5 this is not true the reason is the multiplication of r ship by cos ψ θ ship in the exponent of the exponential function in the integrand of η ship 2 a large r ship can be accompanied by a small cos ψ θ ship where ψ is to be integrated over a range of 2 π to result in nonnegligible net contribution to the integral as can be inferred from fig 5 by falsely neglecting η ship 2 and considering only η ship 1 as the ship wake solution the wave amplitude would be obviously wrong in addition the wave field would be nonzero ahead of the ship i e x ship 0 the mistake of neglecting η ship 2 led li and ellingsen 2016 to believe that the sokhotski plemelji formula were unreliable and to derive through elaborate mathematical analysis the actual far field solution and the actual near field solution for the ship wake problem the sokhotski plemelji formula is of course valid it yields the equality η ship η ship 1 η ship 2 it does not say what each of η ship 1 and η ship 2 represents discarding η ship 2 as done in various past studies is unjustified to the best of our knowledge the present study is the first to investigate η ship 2 although the wave amplitudes in darmon et al 2014 s formulations and the subsequent studies adopting the same assumptions were incorrect the exact amplitudes were not the focus of their study darmon et al 2014 s analysis on the ship wake angle based on the deep water equivalent of η ship 1 for a radially symmetric pressure field remains valid 6 2 solution component η ship 1 here we simplify through exact analytical methods the solution component η ship 1 in 33 which is valid for any water depth since a dirac delta function exists in the integrand of η ship 1 in 33 the integrand is nonzero only when the argument of the dirac delta function equals zero in other words when 36 q f s cos ψ tanh μ q f s cos ψ cos 2 ψ d q 2 f r 2 in which d q is the linear wave speed that has been given in 7 36 can be satisfied only for 37 d q f r q q where d q f r for q q four critical values of ψ exist ψ 1 ψ 2 ψ 3 and ψ 4 in the first quadrant the second quadrant the third quadrant and the fourth quadrant respectively 38 ψ 1 q cos 1 d q f r ψ 2 q π ψ 1 q ψ 3 q π ψ 1 q ψ 4 q 2 π ψ 1 q understanding that only the four critical values of ψ need to be considered we separate the integral of η ship 1 in 33 into four parts 39 η ship 1 n 1 4 i 2 0 π 2 n 1 π 2 n δ q f s cos ψ tanh μ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d ψ d q n 1 4 η ship 1 ψ n where the integral in each part contains a critical ψ value to simplify the expression for η ship 1 ψ n using the dirac delta function we use the substitutions 40 u q f s cos ψ tanh μ q f s cos ψ d ψ 1 q f s sin ψ tanh μ q f s cos ψ tan ψ d u to write η ship 1 ψ 1 as 41 η ship 1 ψ 1 i 2 0 0 π 2 δ q f s cos ψ tanh μ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d ψ d q i 2 0 q f s tanh μ q f s δ u f u q d u d q i 2 0 q f s tanh μ q f s δ u f u q d u d q i 2 q f u ψ ψ 1 q d q in which the fact that the critical ψ 1 exists only for q q is used and the function f is introduced solely for brevity reasons to denote the other terms in the integrand writing out the final expression in 41 fully and further simplifying gives 42 η ship 1 ψ 1 i 4 q cot ψ 1 q p 0 q ψ 1 e i q r ship cos ψ 1 θ ship d q in which the equality in 36 is utilized the procedure can be repeated for η ship 1 ψ 2 η ship 1 ψ 3 and η ship 1 ψ 4 which results in similar expressions but with different signs subsequently the expression for η ship 1 is simplified to be 43 η ship 1 r ship θ ship i 4 n 1 4 q q p 0 q ψ n q cot ψ n q sgn sin ψ n q e i q r ship cos ψ n q θ ship d q in which q is determined from 37 and ψ n is given in 38 η ship 1 in 43 is an exact simplification of η ship 1 in 33 no further approximations are made the double integral in 33 has been simplified to the single integral in 43 as a result the computational effort to evaluate 43 is greatly reduced the newly obtained expression 43 does not invoke assumptions on the water depth and thus can be seen as an extension of darmon et al 2014 s deep water expression for η ship 1 as shown in 35 in addition by eliminating the ψ integral and keeping the q integral as opposed to the other way around the integral in 43 becomes better behaving i e no discontinuities exist in the integrand as a result sharp ship shape functions such as the rectangular shape 20 can be considered in contrast sharp shape functions create challenges in formulations as such that by darmon et al 2014 35 6 3 solution component η ship 2 the solution component η ship 2 in 33 cannot be simplified without approximations to numerically evaluate η ship 2 is as computationally intensive as evaluating the complete solution η ship in 27 therefore to further reduce the complexity of the solution and to devise a ship wake solution for fast computation an efficient approximation for η ship 2 must be sought for a ship shape that is symmetric about the y ship axis i e 44 p 0 q ψ 1 p 0 q ψ 2 p 0 q ψ 3 p 0 q ψ 4 where the definitions of the critical ψ values have been given in 38 it can be shown that η ship 1 is an odd function in x ship and η ship 2 is an even function in x ship within the context of small amplitude wave theory and away from the immediate vicinity of the ship we expect there to be no waves ahead of the ship i e for x ship 0 therefore we impose the following condition on the approximate ship wake solution 45 η ship approx η ship 1 η ship 2 approx 0 for x ship 0 which then gives 46 η ship 2 approx η ship 1 for x ship 0 η ship 1 for x ship 0 since η ship 2 approx should also be an even function in x ship we have thus found an approximation for η ship 2 for x ship symmetric ship shapes i e an even function in x ship and away from the immediate vicinity of the ship i e the water surface elevation directly below the ship is not captured written compactly the approximation reads 47 η ship 2 approx r ship θ ship η ship 1 r ship θ ship sgn cos θ ship 6 4 approximate ship wake solution η ship approx having simplified the solution component η ship 1 through exact analytical methods and found an approximation for the solution component η ship 2 by making use of symmetry we then assemble the approximate ship wake solution to be 48 η ship approx r ship θ ship i 4 n 1 4 1 sgn cos θ ship q q p 0 q ψ n q cot ψ n q sgn sin ψ n q e i q r ship cos ψ n q θ ship d q in which q is determined from 37 and ψ n is given in 38 the complete ship wake solution η ship 33 and the approximate ship wake solution η ship approx 48 are compared in the first column of fig 5 wave profiles along y ship 0 5 are shown in fig 6 it can be seen that the approximate ship wake solution η ship approx describes the full solution η ship extremely well except in the immediate vicinity of the ship η ship approx in 48 is the new approximate analytical solution for ship wakes that we have derived in this study thereafter we shall refer to η ship approx as the approximate ship wake solution the approximate ship wake solution is an accurate approximation of the physical ship wake solution 27 for a ship shape symmetric about the transverse pitch axis and away from the immediate vicinity of the ship the approximate ship wake solution is unprecedented and of practical value mainly due to its reduced complexity and trivial computational effort while the exact integral form analytical solutions such as 16 and 27 are classical in the water wave community they suffer from numerical integration difficulties due to the double integrals and singularities in the integrands on the other hand the approximate ship wake solution can be computed rapidly without numerical difficulties since the double integral is reduced to a single integral and singularities in the integrands have been removed 7 validation tests to validate the newly derived approximate ship wake solution 48 we shall test it in four applications satellite images of real ship wakes a towing tank experiment and two field experiments while modern satellite images serve as a free and easily accessible source of real ship wakes the images provide only information on the ship wake patterns but not their amplitudes hence wave height measurements from physical experiments are still needed to validate the ship wake amplitudes predicted by the approximate ship wake solution 7 1 google earth satellite images aguiar and souza 2009 proposed means to estimate ship velocities from google earth satellite images of ship wakes by measuring the ship wake angles and the ship wake wavelengths and invoking the dispersion relation in deep water rabaud and moisy 2013 used aguiar and souza 2009 s method to analyze a total of 37 google earth satellite images of ship wakes and found that ship wake patterns resemble mach cones for large f s i e the wake angles decrease as f s 1 as opposed to the classical kelvin wake angle 1 darmon et al 2014 argued that the apparent wake angles observed in the satellite images most likely corresponded to ship wakes of the largest amplitudes and not necessarily the kelvin wakes for a radially symmetric gaussian shaped pressure field with large f s darmon et al 2014 showed analytically that the wake angle corresponding to the maximum wave amplitude is 49 θ darmon 1 4 0 1 4 π 1 f s we note that θ darmon θ kelvin at approximately f s 0 66 using the ship locations and parameters provided by rabaud and moisy 2013 we compute the approximate ship wake solutions 48 for these 37 cases of real ship wakes both the rectangular hull shape 20 and the gaussian hull shape 25 are considered only ten cases are presented in this paper the relevant parameters for these ten cases are listed in table 1 while the ship width w is estimated by us from the satellite images all the other parameters are taken directly from rabaud and moisy 2013 the tested ship based froude number ranges from f s 0 14 to f s 1 67 the results are compared in fig 7 for 0 42 f s 1 67 and in fig 8 for 0 14 f s 0 37 the kelvin wake angle θ kelvin and the darmon wake angle θ darmon when applicable are also marked in these figures we remark that only the general ship wake patterns can be inferred from the satellite images the wave amplitudes cannot be determined from these images even the wave phases cannot be easily estimated from the images since the pixel brightness in the images are linked to the water surface steepness and the direction of sunlight in addition the ship dimensions estimated from the satellite images do not faithfully represent the hull dimensions while image enhancing techniques can be implemented to highlight certain features in the satellite images it is not done here all satellite images shown in this study are direct screenshots from google earth three different types of ship wakes can be seen in these figures take the center column of fig 7 e for example the label a marks the classical transverse waves while the label b marks the classical divergent waves these two types of ship wakes are well known in the literature on the other hand secondary waves label c show in the transition area between the transverse waves a and the divergent waves b these secondary waves appear to be highly sensitive to the hull shape the sharper the hull shape such as the extreme case of a rectangular shape the more pronounced the secondary waves therefore in this study we shall refer to these waves marked by the label c as the hull shape waves as can be seen in fig 7 very good agreement between the results are obtained for 0 42 f s 1 67 the performance of the approximate ship wake solution is assessed based on two criteria whether the overall pattern predicted by the approximate solution match that in the satellite images and whether the approximate solutions based on the two different hull shapes agree with each other in terms of both the pattern and the magnitude while some discrepancies exist due to the different hull shapes the overall agreement between the approximate ship wake solution regardless of the hull shape used and the satellite images is exceptional in fig 7 for 0 42 f s 1 67 discrepancies are apparent in fig 8 for 0 14 f s 0 37 the divergent waves in the third column of fig 8 i e the gaussian hull solution become nearly indistinguishable in addition the phases of the transverse waves between the rectangular hull solution and the gaussian hull solution are off however we note that this is also tied to how the characteristic length is defined in the gaussian shape as f s decreases the divergent waves become less and less visible in the satellite images for f s 0 27 the gaussian hull solution seems to stop working yielding negligibly small results this is likely due to rabaud and moisy 2013 s argument that the gaussian shape does not contain sufficient short wave components to excite ship wakes at low f s on the other hand the rectangular hull solution which contains short wave components due to the sharp edges continues to yield sensible results down to f s 0 14 even capturing the hull shape waves that are prevalent in the satellite images nonetheless the accuracy of the rectangular hull solution on the ship wake pattern also becomes questionable for f s 0 27 since differences from the satellite images are obvious overall judging by the ship wake pattern alone we consider 0 42 f s 1 67 to be a safe range where the approximate ship wake solution is valid regardless of the hull shape used more questionably the rectangular hull solution seems to capture the ship wake pattern satisfactorily down to f s 0 27 for f s 0 27 the approximate ship wake solution becomes unreliable and the gaussian hull solution starts to yield negligibly small results 7 2 lindenmuth et al 1991 s towing tank experiment to establish the validity of the approximate ship wake solution the ship wake amplitudes must also be checked from the analysis based on the satellite images we learn that 0 42 f s 1 67 is a safe range where the approximate ship wake solution is valid and 0 27 f s 0 42 is a questionable range where the approximate ship wake solution might be satisfactory but highly dependent on the hull shape this restriction on f s which is linked to the ship speed places a limit on the selection of physical experiments to be used as benchmark tests since a majority of existing experimental measurements were obtained for f s 0 3 lindenmuth et al 1991 measured the ship wake of a 1 24 822 model in a towing tank with f s 0 414 the exact experimental setup was unspecified in terms of the prototype scales the ship length is l 142 m the ship width is w 18 9 m and the draft is 6 16 m gourlay 2019 used this experiment to test the numerical model phflow which employs the nonlinear potential flow theory to solve for ship wakes gourlay 2019 used the real hull shape in the numerical simulation and calculated the displacement volume based on the 6 16 m draft of the dtmb 5415 hull to be 8425 4 m3 hence the ship mass is m 8425 4 ρ kg where ρ is the fluid density the water depth used in lindenmuth et al 1991 s experiment was unspecified gourlay 2019 assumed that the deep water condition applies in our calculations we assume a water depth of 171 m which falls in the deep water range in which the results are no longer depth sensitive for this experiment the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 9 it can be seen that the sharp rectangular hull produces more pronounced waves and highly visible hull shape waves while the smooth gaussian hull produces more mellow waves and barely visible hull shape waves a real ship hull is expected to yield results somewhere in between these two extreme cases experimental measurements are available along y ship 46 m the wave profiles including the experimental measurements from lindenmuth et al 1991 the numerical results from gourlay 2019 our approximate solutions and the exact analytical solutions are compared in fig 10 while both hull shapes yield reasonable ship wake amplitudes the gaussian hull solution appears to agree with measurements more implying the ship hull used in the experiment may be of a smooth nature as shown in fig 2 the dtmb 5415 hull is indeed more streamlined and qualitatively the elliptical gaussian shape appears to be a better approximation than the rectangular shape despite the differences in the exact wave shapes which are tied to the exact ship shape functions assumed the most important discovery here is that the ship wake amplitude predicted by the approximate ship wake solution is valid for f s 0 414 a critical piece of information that cannot be obtained from the comparison with satellite images in addition it can be seen in fig 10 that the approximate solution η ship approx in 48 agrees nearly perfectly with the exact solution η ship in 48 the slight differences are likely due to numerical integration errors since y ship 46 m is sufficiently far away from the immediate vicinity of the ship as indicated in fig 9 the approximate solution η ship approx is a highly accurate approximation of the exact solution η ship 7 3 david et al 2017 s field experiment to validate their boussinesq type numerical model for ship wakes david et al 2017 measured the wakes generated by a boat in river elbe near hamburg germany the patrol boat hafenkapitän is l 19 6 m long and w 5 1 m wide with a 1 5 m draft the shipyard hermann barthel gmbh lists the maximum speed of hafenkapitän as 13 kn 6 69 m s or 24 km h thus even though david et al 2017 reported that the boat traveled at 18 5 m s 36 kn or 66 7 km h in the experiment we believe it was a typo the boat most likely traveled at 18 5 km h 5 14 m s or 10 kn the displacement volume or the mass of the boat was not specified therefore we use the slender ship pressure model of bayraktar and beji 2013 which was adopted by david et al 2017 in their numerical simulations to find the displacement volume to be 49 76 m3 the ship mass is hence m 49 76 ρ kg the boat traveled at 5 14 m s along a straight line where the water depth is between 8 5 m and 9 0 m a wave gauge was located closer to the river bank in a water depth of 7 0 m the closest distance between the wave gage and the boat s path is 25 m while a planer slope better resembled the real bathymetry as adopted in david et al 2017 s numerical simulation our approximate ship wake solution only accepts a constant water depth a constant depth of h 8 5 m is used in calculating the approximate ship wake solution the ship based froude number is thus f s 0 371 while both wind and current effects were present in the field experiment they are not considered in david et al 2017 s numerical simulation or in our approximate ship wake solution for this experiment the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 11 the hull shape effects are again obvious while the sharp rectangular hull produces more pronounced waves and highly visible hull shape waves the smooth gaussian hull produces more mellow waves and barely visible hull shape waves a real ship hull is expected to yield results somewhere in between these two extreme cases a wave gage was located at 25 m away from the boat s path of travel since the boat travels at a constant speed of 5 14 m s the wave profile along y ship 25 m can be converted to match the wave gauge measurements the time origin of david et al 2017 s results was unspecified therefore we determine the needed time shift based on david et al 2017 s numerical results and our gaussian hull solution and consistently use this amount of time shift to plot both the rectangular hull solution and the gaussian hull solution the results are shown in fig 12 firstly we note that our gaussian hull solution agrees well with david et al 2017 s numerical results based also on a smooth hull indicating that neither the variable water depth a constant depth is assumed in our approximate solution while a planar slope is assumed in david et al 2017 s numerical simulation nor nonlinear effects our approximate solution is linear while david et al 2017 s numerical model allows for nonlinearities are significant compared with field measurements both the gaussian hull solution and the numerical results predict reasonable wave amplitudes although the exact wave shapes are noticeably different these smooth hull results appear to capture the main waves between 57 t 67 s but not the frontal waves t 57 s or the rear waves t 67 s on the other hand although the rectangular hull solution does not accurately capture the main waves it appears to capture well both the frontal waves and the rear waves these observations again lead to the conclusion that using the exact hull shape is critical to match the exact shape of ship wakes a real ship hull contains both sharp and smooth components and shall produce ship wakes in between the extreme patterns predicted by the rectangular hull solution and the gaussian hull solution despite the visible discrepancies among the results the most important piece of information gained from this test is that both the rectangular hull solution and the gaussian hull solution predict reasonable wave amplitudes therefore the performance of the approximate ship wake solution is verified for f s 0 371 lastly we remark that the approximate solution η ship approx is virtually identical to the exact solution η ship in fig 12 again indicating that η ship approx is a highly accurate approximation of η ship away from the immediate vicinity of the ship 7 4 dam et al 2008 s field experiment also to validate their boussinesq type numerical model for ship wakes dam et al 2008 measured the wakes generated by a boat in a narrow channel restricted by vertical walls at a straight section of the shingashi river near tokyo japan the channel is 50 m wide the water depth at the left bank 35 m away from the sailing line is 1 9 m deep the water depth at the sailing line and the right bank 15 m away from the sailing line is 4 4 m deep the exact bathymetry is not given a wave gauge was located at 0 5 m away from the right bank or 34 5 m away from the sailing line to measure the free surface elevation in dam et al 2008 s case 14 the boat sakura with l 24 00 m w 6 00 m and m 53 000 kg traveled at a speed of 5 42 m s dam et al 2008 reported the current velocity to be 0 45 m s in the direction of the boat s travel therefore the effective boat speed for wave making is 4 97 m s or f s 0 324 using a constant water depth of h 4 4 m and superposing the solutions to mimic wave reflections from the vertical walls the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 13 similarly to the satellite image with f s 0 33 in fig 8 b in this case with f s 0 324 the gaussian hull solution yields noticeably smaller wave amplitudes than the rectangular hull solution a wave gage was located near the left bank at a distance of 34 5 m away from the boat s path of travel knowing the actual boat speed and the current velocity the wave profile along y ship 34 5 m can be converted to the time series measured at the wave gauge location the field measurements the numerical results from dam et al 2008 the rectangular hull solution and the gaussian hull solution are compared in fig 14 in which t 0 is defined as the instant when the ship bow passes just in front of the wave gauge since the wave gauge is only 0 5 m away from the left bank wave reflection from the left bank is almost immediate on the other hand the right bank is 49 5 m away from wave gauge and the wave reflection from the right bank reaches the wave gauge at about t 20 s the results in fig 14 do not compare well the gaussian hull solution is significantly smaller than the other results suggesting that the gaussian hull solution is no longer valid for f s 0 324 although the rectangular hull solution has the same order of magnitude as the measurements the wave phases do not match well dam et al 2008 s numerical results based on a boussinesq type model employing the slender ship theory of chen and sharma 1995 fare no better than our approximate ship wake solution we also note that a maximum wave height of 1 m as recorded by the wave gauge in a water depth of 1 9 m is highly nonlinear violating the linear wave theory assumed in deriving the ship wake analytical solutions based on this validation test we conclude that the approximate ship wake solution is no longer valid for f s 0 324 despite the disagreements among the results for this case it can be observed in fig 14 that the approximate solution η ship approx still agrees nearly perfectly with the exact solution η ship therefore η ship approx remains a highly accurate approximation of η ship for f s 0 324 even when the validity of the exact solution η ship itself becomes questionable 7 5 discussions having tested the approximate ship wake solution against satellite images one towing tank experiment and two field experiments we conclude that the approximate ship wake solution is valid for 0 414 f s 1 67 and potentially satisfactory for 0 371 f s 0 414 although the wave amplitudes predicted by the approximate ship wake solution are off for f s 0 371 the rectangular hull solution appears to accurately capture the wake angles down to f s 0 14 the lowest froude number considered in this study in addition in all the tests conducted regardless of the value of f s the approximate solution η ship approx agrees nearly perfect with the exact solution η ship away from the immediate vicinity of the ship therefore the approximate ship wake solution is indeed a highly accurate approximation of the exact ship wake solution 8 water depth effects the analytical solutions presented in this study are based on the small amplitude water wave theory without making any assumptions on the water depth therefore the approximate ship wake solution 48 can be used in any water depth to showcase the water depth effects we pick case 14 considered by rabaud and moisy 2013 as an example the relevant parameters are tabulated in table 2 and the google earth satellite image of this case is shown in fig 15 a this case is selected for two main reasons first its ship based froude number f s 0 47 is within the range 0 414 f s 1 67 established in section 7 as where the approximate ship wake solution is valid second its estimated strength of frequency dispersion μ h l 0 19 is generally classified as weakly dispersive in the water wave community put differently the water depth is said to be intermediate where the effects of water depth are non negligible see e g dean and dalrymple 1991 therefore case 14 can be regarded as the intermediate water case to examine the water depth effects we consider two alternate water depths for this vessel to travel in case 14 s with water depth h 2 2 m which is one fifth that of case 14 and case 14 d with water depth h 55 m which is five times that of case 14 we note that whether a 2 2 water depth would be navigable for this vessel is not the subject of discussion here for case 14 s the estimated strength of frequency dispersion is μ h l 0 04 which is sufficiently low for the shallow water assumption to hold therefore case 14 s can be regarded as the shallow water case on the other hand for case 14 d the estimated strength of frequency dispersion is μ h l 0 97 which is sufficiently high for the deep water assumption to hold therefore case 14 d can be regarded as the deep water case 8 1 results based on the approximate ship wake solution for these three cases case 14 case 14 s and case 14 d the results predicted by the approximate ship wake solution 48 are plotted in fig 15 both the rectangular hull solution and the gaussian hull solution are considered in addition the deep water kelvin wake angle 1 the shallow water mach like angle 50 and the detected wake angle are also shown in shallow water linear water waves travel at a dimensionless speed of one therefore for a ship traveling at a super critical speed f r 1 the forced water waves form a mach like cone the angle formed between the wake crests and the ship s direction of travel is 50 θ shallow sin 1 1 f r the detected wake angle shown in fig 15 a is estimated by rabaud and moisy 2013 based on the brightest points of the wake the detected wake angles in the approximate ship wake solutions are determined based on the locations of maximum crest height the water depth effects can be clearly seen in fig 15 in the shallow water case case 14 s since the ship travels at a supercritical speed based on the depth based froude number f r 2 37 the main wake forms a mach like cone whose half angle 50 is different from the deep water kelvin wake angle 1 no detected wake angles can be obtained using the locations of maximum crest height since peaks are not always existent along each wave crest i e the height of each wave crest is nearly uniform in space in the deep water case case 14 d the ship travels at a subcritical speed based on the depth based froude number f r 0 47 a classical wake pattern consisting of transverse waves divergent waves and hull shape waves discussed in section 7 and marked in fig 7 results unsurprisingly the deep water kelvin wake angle 1 agrees well with the detected wake angles in deep water in the intermediate water case case 14 the ship travels at a near critical speed based on the depth based froude number f r 1 06 divergent waves can be clearly identified in the results to some extent hull shape waves can also be identified in the rectangular hull results fig 15 c transverse waves however are absent in the intermediate water case while the detected wake angle agrees nearly perfectly with the kelvin wake angle for the gaussian shape the agreement is less perfect for the rectangular shape for the rectangular shape the kelvin wake angle works better in the deep water case than in the intermediate water case when compared with the detected wake angles interestingly in the intermediate water case the wave crests of the divergent waves appear to be approximately aligned with the shallow water mach like angle suggesting that the divergent waves are still effected by the shallow water wave physics in this intermediate water case on the other hand the hull shape effects observed in these three cases are consistent with the discussions presented in section 7 namely the hull shape waves are particularly noticeable for the rectangular shape and these waves complicate the wake pattern and make identifying a representative ship wake angle more difficult altogether the above results indicate that water depth has noticeable effects on the ship wake pattern and the identification of a representative ship wake angle therefore the deep water assumption widely invoked in classical ship wake studies must be checked carefully to ensure that the actual water depth considered is sufficiently deep since the present study invokes no assumptions on the water depth the approximate ship wake solution 48 is a suitable tool for investigating the effects due to water depth at least in the range 0 414 f s 1 67 for which the approximate ship wake solution has been validated 8 2 possible error in reported water depth this example also hints at the possibility of using the approximate ship wake solution 48 in combination with satellite ship wake images to gauge the water depth in which a ship travels upon close inspection of the satellite image in fig 15 a the intermediate water results in fig 15 c f and the deep water results in fig 15 d g one may argue that the agreement between the satellite image and the deep water results is better than if not at least as good as the agreement between the satellite image and the intermediate water results particularly slight tracks of transverse waves can be seen in the satellite image yet the intermediate water results do not show transverse waves in the deep water results however the transverse waves are clearly visible furthermore the number of transverse waves and the wave phases in the deep water results also appear to agree with the satellite image such a discrepancy is concerning and raises new questions e g is the approximate ship wake solution not accurate is the satellite image not a faithful representation of the wakes is the estimated water depth or other parameters wrong fortunately the last question can be addressed with relative ease and will be shown to be a likely cause using nautical charts from navionics rabaud and moisy 2013 estimated the water depth at this location to be 11 m which is the water depth specified in case 14 however using google earth which uses data from etopo1 noaa national geophysical data center 2009 amante and eakins 2009 we find the water depth at this location to be 66 m using gebco 2020 we find the water depth at this location to be 50 m the latter two depth estimates are much closer to the 55 m depth assumed in the deep water case 14 d than the 11 m depth estimated by rabaud and moisy 2013 therefore it is plausible that the actual water depth at this location and at the time the satellite image was taken november 2009 is closer to 55 m than to 11 m we remark that such an inverse analysis is greatly facilitated by the newly proposed approximate ship wake solution which can be computed quickly and robustly and in any water depth 9 concluding remarks in this study we first reviewed the small amplitude wave theory modeling a ship as a moving pressure field acting on the water surface and clearly stating the assumptions invoked we rederived the classical integral form analytical solution for ship wakes for ship shapes symmetric about the transverse pitch axis and away from the immediate vicinity of the ship we proposed an approximate ship wake solution that can be computed quickly then we validated the newly proposed approximate ship wake solution in terms of both the wake patterns and the wake amplitudes using 37 satellite images of ship wakes one towing tank experiment and two field experiments the validation tests show that both the wake patterns and the wake amplitudes are correctly captured for the ship based froude number range 0 414 f s 1 67 however the wake patterns but not the wake amplitudes appear to be accurately captured for 0 27 f s 0 414 we then used the new ship wake solution to examine the effects of water depths on wake patterns and demonstrated the possibility of using the new solution along with satellite images to infer water depths the newly proposed approximate ship wake solution 48 is unprecedented as it correctly captures both the wake patterns and the wake amplitudes admits both continuous and discontinuous ship shape functions does not invoke the deep water approximation and reduces the double integral in the exact solution to a single integral through analytical means in addition singularities in the integrands of the exact solution have been removed as a result the approximate ship wake solution can be evaluated straightforwardly with numerical integration methods to plot the analytical solutions two ship shape functions in which the ship length width and weight need to be specified are considered a sharp rectangular shape and a smooth gaussian shape while the overall wake patterns are unaffected by the ship shape the detailed characteristics are the differences mainly show in the transition area between the divergent waves and the transverse waves in the form of what we refer to as the hull shape waves in this study we speculate that these hull shape waves are key to linking the characteristics of a ship hull to the characteristics of the wakes it generates it is understood that a real ship hull consists of both sharp and smooth components and therefore should generate wakes with characteristics that fall in between those predicted by the two extreme ship shape functions i e the rectangular shape represents the most discontinuous hull whereas the gaussian shape represents the smoothest hull how to accurately represent a realistic ship hull using a combination of elementary shape functions is beyond the scope of the present study after validating the approximate ship wake solution using available data the approximate solution was used to investigate the effects of water depth on ship wake patterns water depth was found to have noticeable effects on not only the wake pattern but also the identification of a representative wake angle consistent with linear wave theory in shallow water the wake crests form a mach like cone for a ship traveling at a supercritcal speed depth based f r 1 in deep water the wakes are accurately described by classical ship wake theory in intermediate water the wakes manifest a mixture of shallow water characteristics and deep water characteristics by comparing the approximate ship wake solution with a satellite image we discovered a plausibly misreported water depth in a previous study this exercise hints at the possibility of using the approximate ship wake solution to infer representative water depths in satellite images of ship wakes since the analytical solutions presented in this study are derived based on the small amplitude wave theory they are limited by the underlying assumptions first nonlinear effects are not considered the wave amplitude is assumed to be small in comparison to the water depth second the water depth is assumed to be a constant although water depth effects become irrelevant in the deep water limit third the ship is required to travel in a straight line at a constant speed fourth neither capillary effects nor viscous effects are considered fifth ambient winds and currents are neglected in addition in deriving the approximate ship wake solution the ship shape is assumed to be symmetric about the transverse pitch axis furthermore the approximate ship wake solution does not apply in the immediate vicinity of the ship i e the region most critical for calculating the wave resistance of a hull a new approximate ship wake solution that can be computed quickly and robustly is proposed and validated in this study it is hoped that this new solution aids in the ship wake inversion problem due to its trivial computational cost and parametrization it may be particularly suitable for use in combination with machine learning techniques finite depth effects and ship shape effects can all be investigated in the future using this new approximate ship wake solution it is also worthwhile to explore the possibilities of extending the approximate solution to allow for realistic ship shapes that are not symmetric about the transverse pitch axis lastly why the analytical solutions start to deviate from observations at low froude numbers f s 0 371 also warrants further investigation credit authorship contribution statement peter h y lo conceptualization methodology software validation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is supported by the ministry of science and technology of taiwan through grants 109 2221 e 002 094 and 108 2218 e 002 075 appendix a numerical integration techniques to demonstrate how to numerically compute the double integral form analytical solutions we take η ship 2 in 33 as an example 51 η ship 2 r ship θ ship 1 2 π pv 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ 1 q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ for q q in which q is determined from 37 four critical ψ values ψ 1 ψ 2 ψ 3 and ψ 4 as given in 38 cause discontinuities in the integrand of 51 it is shown in appendix b that these discontinuities are integrable based on the cauchy principal value and thus the cauchy principal value of the double integral exists numerically it is necessary to avoid these critical ψ values using a large number n instead of infinity as the upper integration limit for the q integral and invoking the periodicity in ψ we calculate 51 as 52 η ship 2 r ship θ ship 1 2 π pv 0 2 π 0 f q ψ d q d ψ 1 2 π 0 2 π 0 q d f d q d ψ ψ 1 q d ψ 1 q d q d n f d q d ψ ψ 1 q d ψ 2 q d q d n f d q d ψ ψ 2 q d ψ 3 q d q d n f d q d ψ ψ 3 q d ψ 4 q d q d n f d q d ψ where the function f q ψ is introduced temporarily to abbreviate the integrand in 51 and d is a very small number in this study d 1 0 6 and n 100 are used to compute double integrals like 51 when f r 1 so that 37 is unconditionally satisfied i e no q can be solved for q is set to be 0 when q 0 which then corresponds to f r 1 the first approximation term in 52 needs not be computed appendix b discontinuities in the integrand in the expression 51 for η ship 2 each critical ψ n as given in 38 corresponds to a discontinuity of the form 53 i n r ship θ ship lim d 0 q ψ n q d ψ n q d tanh μ q f s cos ψ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d q d ψ where 54 q f s cos ψ n tanh μ q f s cos ψ n 0 using the property 54 and taylor series expansion about ψ ψ n to write 55 cos 2 ψ cos 2 ψ n 2 ψ ψ n sin ψ n cos ψ n we have 56 i lim d 0 q ψ n q d ψ n q d tanh μ q q f s 2 cos 2 ψ tanh μ q q p 0 q ψ e i q r ship cos ψ θ ship d q d ψ lim d 0 q ψ n q d ψ n q d tanh μ q q f s 2 cos 2 ψ n 2 q f s 2 ψ ψ n sin ψ n cos ψ n tanh μ q q p 0 q ψ n e i q r ship cos ψ n θ ship d q d ψ ψ n q d ψ n q d 1 2 tan ψ n q p 0 q ψ n e i q r ship cos ψ n θ ship lim d 0 ψ n q d ψ n q d 1 ψ ψ n d ψ d q with the substitution u ψ ψ n 57 lim d 0 ψ n q d ψ n q d 1 ψ ψ n d ψ lim d 0 d d 1 u d u 0 based on the cauchy principal value therefore the discontinuities in 51 for η ship 2 are integrable based on the cauchy principal value 
20518,an approximate ship wake solution that accurately predicts both the wake patterns and the wake amplitudes in any water depth is proposed and validated derivation based on the small amplitude wave theory is first revisited treating a ship as a moving pressure field acting on the water surface for ship shapes symmetric about the transverse pitch axis and away from the immediate vicinity of the ship an approximate solution is sought in contrast to the exact analytical solution consisting of a double integral the approximate solution is simplified through analytical means to consist of a single integral singularities inside the integrand of the exact solution have also been removed hence the computational effort is greatly reduced two extreme ship shape functions are considered to plot the solutions a sharp rectangular shape and a smooth gaussian shape the newly derived approximate solution is validated using 37 satellite images of ship wakes one towing tank experiment and two field experiments then water depth effects on wake patterns are discussed providing means to quickly relate the ship shape weight speed and water depth to the wake characteristics the new ship wake solution is a potentially powerful tool in the study of ship wake inversion keywords ship wake small amplitude water wave theory analytical solution sokhotski plemelji formula 1 introduction the wakes left behind by a moving object floating on the water surface have long been an fascinating subject in the study of water waves it is widely observed that the water wakes left behind by a moving object be it a cruise ship a kayak or a duck share similar characteristics regardless of the shape or size of the object in deep water lord kelvin thomson 1887 first showed that the angle formed by the outermost wakes and the centerline of the object s motion to be a constant 1 θ kelvin sin 1 1 3 19 4 7 employing the small amplitude wave theory havelock 1908 examined water waves generated by a moving pressure point source modeling ships as moving pressure sources acting on the water surface many textbooks on water waves e g stoker 1958 newman 1977 lighthill 1978 johnson 1997 presented integral form solutions for ship waves and analyses on ship wave angles although integral form solutions for ship wakes are long known these solutions involve double integrals with improper bounds and discontinuities in the integrands numerically evaluating these integral form solutions is computationally demanding as a result rarely if ever were the full solutions plotted in classical studies on ship wakes this challenge can be bypassed if it is the general ship wake pattern rather than the exact shape of the wake field left by a specific object that is of concern the method of stationary phase is widely employed to analyze the patterns of ship wakes e g ursell 1960 warren 1961 and yih and zhu 1989a and yih and zhu 1989b while most studies on ship wakes make the deep water assumption lee and lee 2019 derived an equation for the ship wave crest locations applicable in the entire range of water depths effects unaccountable by the classical small amplitude wave theory were also examined for example cumberbatch 1965 and liang and chen 2019 discussed the importance of viscous effects hogben 1972 and zhu et al 2008 discussed the importance of nonlinear effects brown et al 1989 and mei and naciri 1991 investigated the soliton packet observed in the wake of a ship chen and sharma 1995 and shi et al 2018 studied the solitary waves generated ahead of a ship traveling near the critical speed in a shallow channel ellingsen 2014 and li and ellingsen 2016 considered the effects of shear currents on ship wakes and grue 2017 and grue 2020 pointed out that mini tsunamis can be generated when a cruiseferry travels across a depth change as remote sensing techniques improve and satellite images have now become easily accessible a new wave of research efforts on ship wakes have begun aguiar and souza 2009 proposed means to estimate ship velocities from google earth satellite images of ship wakes using aguiar and souza 2009 s method rabaud and moisy 2013 analyzed 37 satellite images of ship wakes and discovered that ship wakes generated by high speed boats appear to form a speed dependent mach like cone unlike the conventional kelvin wake studies exploring this newly discovered phenomenon include to name just a few doyle and mckenzie 2013 darmon et al 2014 noblesse et al 2014 pethiyagoda et al 2014 and rabaud and moisy 2014 he et al 2015 the observation of speed dependent ship wake angles seemingly contradicted the celebrated kelvin wake pattern darmon et al 2014 offered a simple explanation the apparent ship wake angles observed in satellite images most likely correspond to waves of the largest amplitudes the kelvin wake pattern still exists in the analytical solutions at least just not as visible while a vast number of studies on ship wakes exist the focus is usually on the wake patterns the amplitudes of the wakes are rarely discussed or validated perhaps partially due to the fact that wake amplitudes cannot be easily inferred from images of ship wakes which are frequently used to aid the studies on ship wake patterns in many practical applications however the wake amplitudes are as important as if not sometimes more important than the wake patterns for example how big are the wakes generated by a certain vessel of a known size and weight as it enters a harbor at a known speed more ambitiously from elevation calibrated images of ship wakes can one infer the weight of a ship conversely can one use the wakes generated by a marine vessel of a known shape and weight to calibrate remotely sensed images and maybe even infer the representative water depths the above questions lead to the subject of ship wake inversion means to link the wakes generated by a ship to the characteristics of the ship see e g wu 1991 griffin et al 1996 liu and deng 2018 sun et al 2018 to facilitate the inversion process a fast and robust method is essential analytical expressions are particularly suitable for this purpose therefore the objective of this study is to propose an approximate analytical solution to quickly calculate the wakes generated by a ship whose shape and weight are known careful attention shall be paid to ensure that both the wake patterns and the wake amplitudes are correctly captured and that the results can be computed with minimal computational effort for completeness and clarity in section 2 we first briefly review the small amplitude wave theory to be employed to derive the analytical solution for ship wakes in section 3 we derive the complete solution for the transient ship wake generation process in section 4 we introduce two ship shape functions to be used in plotting the solutions in section 5 we outline means to acquire the steady state ship wake solution in section 6 we propose an approximate ship wake solution that can be computed quickly in section 7 we validate the approximate ship wake solution in terms of both the wake patterns and the wake amplitudes in section 8 we examine the effects of water depth on the ship wake patterns and demonstrate how the approximate ship wake solution can be utilized to infer the water depth lastly in section 9 we conclude this study 2 small amplitude wave theory the small amplitude water wave theory is often employed to obtain analytical solutions for water waves generated by a moving ship as sketched in fig 1 the moving ship is approximated as a moving pressure field p x y t exerted on the free surface which is linearized to be the still water level z 0 as a result the pressure forces act in the vertical direction the pressure field has a characteristic length of l the water depth is assumed to be constant h and the characteristic wave amplitude a is assumed to be the same as the characteristic pressure head of the pressure field in small amplitude wave theory a is required to be small in comparison to the water depth h i e a h 1 for incompressible and irrotational flows the laplace equation governs this problem the corresponding linear and fully dispersive wave model is well known see for example mei et al 2005 for completeness here we briefly review the derivation process the dimensionless laplace equation and the boundary conditions are 2 μ 2 ϕ x x μ 2 ϕ y y ϕ z z 0 1 z 0 ϕ z 0 z 1 ϕ z μ 2 η t z 0 ϕ t η p z 0 where ϕ x y z t is the velocity potential p x y t is the moving pressure field approximate ship model acting on the still water surface z 0 and η is the water surface elevation using primes to denote dimensional variables we write the dimensionless variables as 3 x x l y y l z z h t t g h l η x y t η x y t a p x y t p x y t ρ g a ϕ x y z t ϕ x y z t a h l g h where l is the characteristic length of the ship a is the characteristic amplitude of the ship induced pressure field in terms of hydraulic head ρ is the density of water g is the gravitational acceleration and μ h l the system of equations in 2 is a classical linear wave problem and can be solved by applying the laplace and fourier transforms in this study the fourier transform of a function f x is defined as 4 f k 1 2 π f x e i k x d x f x 1 2 π f k e i k x d k where the overline denotes the fourier transformation in the x direction a wide tilde is used to denote that in the y direction while k represents the wavenumber in the x space l represents the wavenumber in the y space in addition triple dots are used to denote the laplace transformation in time which converts the time variable t to the frequency variable s the laplace fourier transformed velocity potential can be solved for as 5 ϕ k l z s 1 cosh μ q 1 s 2 q 2 d 2 cosh μ q z 1 s ϕ x y 0 0 η x y 0 s p k l s where 6 q k 2 l 2 will be used throughout the study to simplify the expressions and 7 d tanh μ q μ q is the normalized wave celerity of linear dispersive waves in constant depth the transformed free surface elevation η is then 8 η k l z s s ϕ x y 0 t ϕ x y 0 0 in deriving 5 and 8 the initial conditions imposed are 9 η x y 0 0 ϕ x y 0 0 constant whereas η x y 0 0 means an initially flat water surface ϕ x y 0 0 constant means zero initial horizontal velocities on the still water surface z 0 3 complete analytical solution to further simplify the solutions 5 and 8 we consider a ship that travels in the x direction at a constant speed u in addition to facilitate the extraction of the physical ship wake solution component to be discussed in section 5 we further generalize the ship induced pressure field by allowing it to grow in time exponentially therefore the dimensionless pressure field has the form 10 p x y t e ϵ t p 0 x f r t y in which p 0 is a ship shape function to be specified the froude number f r is based on the linear wave speed 11 f r u g h and ϵ is a non negative constant to be specified the laplace fourier transform of 10 is available in closed form 12 p k l s p 0 k l 1 s i k f r ϵ where 13 p 0 x y p x y 0 is the ship shape function denoting the initial shape of the ship induced pressure field with 12 η in 8 can be inverse laplace transformed to be 14 η x y t η f r x y t η x y t η f r x y t 1 2 π p 0 k l d 2 d 2 k f r i ϵ 2 q 2 e ϵ t e i k x f r t e i l y d k d l η x y t 1 2 π p 0 k l d 2 d k f r i ϵ q e i q d t d 2 d k f r i ϵ q e i q d t e i k x e i l y d k d l eq 14 is the complete analytical solution for water waves generated by a pressure field specified by 10 which suddenly starts moving at a constant speed at t 0 inspecting the exponential terms in 14 we see that η f r moves with the ship in fact η f r can be expressed as 15 η f r x y t e ϵ t η f r x f r t y 0 η f r represents the trapped wave that moves with the ship on the other hand η travels at the linear wave speed d each different wave component travels at a different speed as required by 7 η represents the free waves that propagates freely away from the ship induced perturbation the free waves result from the sudden perturbation the ship suddenly begins traveling a constant speed in quiescent water at t 0 it is often more convenient to express the solutions in polar coordinates by using the substitutions x r cos θ y r sin θ k q cos ψ and l q sin ψ the integral form solutions 14 can be written as 16 η r θ t η f r r θ t η r θ t η f r r θ t 1 2 π 0 2 π 0 q p 0 q ψ d 2 e ϵ t e i q f r cos ψ t e i q r cos ψ θ d 2 q f r cos ψ i ϵ 2 q 2 d q d ψ η r θ t 1 2 π 0 2 π 0 q p 0 q ψ d 2 d q f r cos ψ i ϵ q e i q d t d 2 d q f r cos ψ i ϵ q e i q d t e i q r cos ψ θ d q d ψ 4 ship induced pressure shape functions as indicated by the complete analytical solution 16 the shape of a ship is modeled by the pressure shape function p 0 in this study we consider two ship induced pressure shape functions of extreme characteristics a rectangular shape with sharp corners and a smooth elliptical gaussian shape the rectangular shape resembles the most extreme case of flat bottomed ship hulls flat bottomed ship hulls are often adopted to achieve shallow draft and stability in calm water recreational e g fishing boats and barges in calm water are typical examples of flat bottomed ships the rectangular shape can also be regarded as approximate u shaped ship hulls which are designed to achieve maximal cargo capacity and travel at relatively low speeds typical examples of u shaped ships include oil tankers bulk carriers and to a lesser extent some container ships the gaussian shape is streamlined and can be regarded as an approximation of v shaped hulls v shaped hulls are adopted to achieve high speeds and stability in waves at the expense of interior volume for stowage or accommodations most powerboats have v shaped hulls while the two analytical ship shape functions are oversimplifications of real ship hulls they do represent two extremely different ship hull characteristics it is understood that a real ship hull should be somewhere in between these two extreme shapes as an illustration in fig 2 the rectangular shape and the gaussian shape are compared with the dtmb 5415 hull which was used in lindenmuth et al 1991 s towing tank experiment to be presented in section 7 2 due to the linearity of the small amplitude wave theory solutions calculated using different shape functions can be superposed therefore it is possible to approximate a real ship hull using a combination of elementary ship shape functions however how to accurately represent a realistic ship hull using elementary functions is beyond the scope of this study 4 1 rectangular shape consider a ship of characteristic length l and characteristic width w the aspect ratio of which is denoted as 17 σ w l approximating the ship as a rectangular box results in the dimensional ship induced pressure shape function 18 p 0 x y ρ g a r h x l 2 h x l 2 h y w 2 h y w 2 in which a r is the ship draft based on the rectangular shape and h is the heaviside step function if the mass m of the ship is known then the ship draft a r based on this rectangular shape can be calculated as 19 a r m l w ρ nondimensionalizing 18 gives 20 p 0 x y h x 1 2 h x 1 2 h y σ 2 h y σ 2 whose double fourier transform is 21 p 0 k l 2 π 1 k 1 l sin k 2 sin σ l 2 2 π q 2 cos ψ sin ψ sin q cos ψ 2 sin σ q sin ψ 2 p 0 q ψ 4 2 gaussian shape a smooth and continuous elliptical gaussian shape can also be specified to approximate a ship of characteristic length l defined to be four times its standard deviation in the x direction and characteristic width w defined to be four times its standard deviation in the y direction the dimensional elliptical gaussian ship shape function reads 22 p 0 x y ρ g a g e 8 x l 2 e 8 y w 2 in which the ship draft a g based on the elliptical gaussian shape is linked to the mass m of the ship as 23 a g 8 π m l w ρ we note that for a ship of a fixed mass m the ship draft a g 23 based on the elliptical gaussian shape is 8 π larger than the ship draft a r 19 based on the rectangular shape 24 a g 8 π a r the nondimensional version of 22 reads 25 p 0 x y e 8 x 2 e 8 y σ 2 whose double fourier transform is 26 p 0 k l σ 16 e k 2 32 e l 2 32 σ 2 σ 16 e q 2 32 cos 2 ψ σ 2 sin 2 ψ p 0 q ψ 5 physical ship wake solution ship wakes refer to water waves that follow behind a ship to model a ship as a translating pressure field of a fixed shape it may appear intuitive to set ϵ 0 in 16 and falsely consider η f r to be the ship wake solution however for ϵ 0 η f r is not the physical ship wake solution the reason is the discontinuities that exist in the expression for η in 16 for ϵ 0 the wave components corresponding to f r cos ψ d have infinitely large amplitudes and travel at the same speed as the ship therefore the η term in 16 also contributes to the ship wake solution for ϵ 0 to illustrate this we plot the complete solution 16 and the two solution components in fig 3 at t 2 6 10 with μ 0 5 f r 0 5 ϵ 0 and using the gaussian ship shape 25 with σ 1 it can be see that η f r includes unphysical waves that are sucked in from downstream of the pressure field these unphysical waves are canceled out by identical but differently signed waves in η to better isolate the physical ship wake solution one classical approach see e g lighthill 1978 and raphaël and gennes 1996 is to assume that the pressure perturbation grows in time as has been done in 10 this effectively requires all solutions to be outgoing away from the perturbation then to recover the solution corresponding to a pressure perturbation that does not grow in time the limit ϵ 0 is taken η f r in 16 with ϵ 0 then corresponds to the physical steady state ship wake solution 27 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 q p 0 q ψ d 2 d 2 q f r cos ψ i ϵ 2 q 2 e i q r ship cos ψ θ ship d q d ψ where r ship θ ship are the cylindrical coordinates centered about the ship which travels in the x direction at a dimensionless speed of f r for μ 0 5 f r 0 5 ϵ 0 001 and using the gaussian shape 25 with σ 1 η ship is plotted in fig 4 by comparison with the transient solution shown in the first column of fig 3 we see that η ship indeed represents the physical steady state ship wake solution i e for a ship that has been moving at a constant speed for an infinitely long duration the deep water approximation of the ship wake solution 27 is well known and widely employed to study ship wakes see e g raphaël and gennes 1996 and darmon et al 2014 however we find that the deep water approximation is unnecessary in many of the following mathematical analyses the ship wake solutions discussed in this study involve no assumptions on the water depth they apply to both shallow water and deep water as long as the wave amplitude is small relative to the water depth due to the limitation of the small amplitude water wave theory heeding dias 2014 s advice that the definition of the froude number must be clearly indicated we stress again that the froude number f r used in 27 is based on the linear long wave celerity as defined in 11 6 approximate ship wake solution by neglecting the term multiplied by ϵ 2 since it is one order smaller for ϵ 0 writing out the expressions for d as given by 7 using the ship based froude number more commonly adopted in the ship hydrodynamics community 28 f s u g l f r μ and moving the negative sign in front of the limit sign in 27 to the denominator of the integrand 27 becomes 29 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 q p 0 q ψ tanh μ q e i q r ship cos ψ θ ship q f s 2 cos 2 ψ tanh μ q 2 i ϵ μ f s cos ψ d q d ψ dividing by f s cos ψ f s cos ψ since cos ψ 0 results in a finite integrand the points where cos ψ 0 can be omitted in the integration cos ψ 0 can be implied in the expressions and using the substitution ϵ 2 μ ϵ then yields 30 η ship r ship θ ship lim ϵ 0 1 2 π 0 2 π 0 tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship q f s cos ψ tanh μ q f s cos ψ i ϵ d q d ψ as demonstrated by darmon et al 2014 for the deep water ship wake solution the integrand in 30 can be simplified by the sokhotski plemelji formula see e g blanchard and brüning 2003 the sokhotski plemelji formula commonly used in quantum mechanics states that 31 lim ϵ 0 1 x i ϵ pv 1 x i π δ x where pv denotes the cauchy principal value and δ is the dirac delta function for ϵ 0 the integrand in 30 can be expressed using the sokhotski plemelji formula as 32 lim ϵ 0 tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship q f s cos ψ tanh μ q f s cos ψ i ϵ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship lim ϵ 0 1 q f s cos ψ tanh μ q f s cos ψ i ϵ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship pv 1 q f s cos ψ tanh μ q f s cos ψ i π δ q f s cos ψ tanh μ q f s cos ψ the integral form solution 30 then becomes 33 η ship r ship θ ship η ship 1 r ship θ ship η ship 2 r ship θ ship η ship 1 i 2 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ δ q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ η ship 2 1 2 π pv 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ 1 q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ for the same example using the gaussian ship shape function 25 with μ 0 5 f r 0 5 thus f s 0 35 and σ 1 the integral form solution 33 and the solution components are shown in the top row of fig 5 it is observed that both solution components are finite and must be considered and that only the sum of the two solution components yields a physical ship wake solution we emphasize that the sokhotski plemelji formula does not confer a physical meaning on each of the two terms resulting from the decomposition hence each of η ship 1 and η ship 2 does not have a clear physical meaning only the sum of the two η ship η ship 1 η ship 2 corresponds to the physical ship wake solution when studying physical ship wakes the two terms must be considered together the exact ship wake solution η ship in 27 or 33 is difficult and time consuming to compute using numerical integration methods due to the double integrals and the singularities in the integrands details on our numerical integration techniques are provided in appendix a on the other hand we note that li et al 2019 successfully utilized a fast fourier transform algorithm to approximate the double fourier transform in similar integral form ship wake solutions to further reduce the complexity of the analytical solutions for ship wakes we shall discuss means to simplify each of the two solution components η ship 1 and η ship 2 6 1 darmon et al 2014 s solution darmon et al 2014 simplified the deep water equivalent of η ship 1 in 33 to be 34 η darmon r ship θ ship i 2 π 2 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ for which the notations have been changed so that the definitions are consistent with those used in this study in addition an obvious typo in the sign of the exponent has been corrected as also noticed by li and ellingsen 2016 the integration limits for ψ in 34 were incorrect it should be integrated over a range of 2 π consequently the wave amplitude of 34 is incorrect and the imaginary components do not cancel out the corrected version should read 35 η darmon c r ship θ ship i 2 π 2 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ π 2 3 π 2 p 0 1 f s 2 cos 2 ψ ψ 1 f s 4 cos 4 ψ e i q r ship cos ψ θ ship f s 2 cos 2 ψ d ψ the corrected solution 35 is an exact simplification of η ship 1 in 33 in the deep water limit however discontinuities exist when cos ψ 0 as a result only smooth ship shape functions can be considered such as the gaussian shape 25 the integrals become poorly behaving when sharp shape functions are used such as the rectangular shape 20 darmon et al 2014 incorrectly stated that the deep water equivalent of η ship 2 tended to zero for large r ship due to the integrand s becoming fast oscillating thus η ship 2 was falsely classified as the near field solution it is not and discarded in darmon et al 2014 s analysis and other studies that followed the same approach as clearly shown in fig 5 this is not true the reason is the multiplication of r ship by cos ψ θ ship in the exponent of the exponential function in the integrand of η ship 2 a large r ship can be accompanied by a small cos ψ θ ship where ψ is to be integrated over a range of 2 π to result in nonnegligible net contribution to the integral as can be inferred from fig 5 by falsely neglecting η ship 2 and considering only η ship 1 as the ship wake solution the wave amplitude would be obviously wrong in addition the wave field would be nonzero ahead of the ship i e x ship 0 the mistake of neglecting η ship 2 led li and ellingsen 2016 to believe that the sokhotski plemelji formula were unreliable and to derive through elaborate mathematical analysis the actual far field solution and the actual near field solution for the ship wake problem the sokhotski plemelji formula is of course valid it yields the equality η ship η ship 1 η ship 2 it does not say what each of η ship 1 and η ship 2 represents discarding η ship 2 as done in various past studies is unjustified to the best of our knowledge the present study is the first to investigate η ship 2 although the wave amplitudes in darmon et al 2014 s formulations and the subsequent studies adopting the same assumptions were incorrect the exact amplitudes were not the focus of their study darmon et al 2014 s analysis on the ship wake angle based on the deep water equivalent of η ship 1 for a radially symmetric pressure field remains valid 6 2 solution component η ship 1 here we simplify through exact analytical methods the solution component η ship 1 in 33 which is valid for any water depth since a dirac delta function exists in the integrand of η ship 1 in 33 the integrand is nonzero only when the argument of the dirac delta function equals zero in other words when 36 q f s cos ψ tanh μ q f s cos ψ cos 2 ψ d q 2 f r 2 in which d q is the linear wave speed that has been given in 7 36 can be satisfied only for 37 d q f r q q where d q f r for q q four critical values of ψ exist ψ 1 ψ 2 ψ 3 and ψ 4 in the first quadrant the second quadrant the third quadrant and the fourth quadrant respectively 38 ψ 1 q cos 1 d q f r ψ 2 q π ψ 1 q ψ 3 q π ψ 1 q ψ 4 q 2 π ψ 1 q understanding that only the four critical values of ψ need to be considered we separate the integral of η ship 1 in 33 into four parts 39 η ship 1 n 1 4 i 2 0 π 2 n 1 π 2 n δ q f s cos ψ tanh μ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d ψ d q n 1 4 η ship 1 ψ n where the integral in each part contains a critical ψ value to simplify the expression for η ship 1 ψ n using the dirac delta function we use the substitutions 40 u q f s cos ψ tanh μ q f s cos ψ d ψ 1 q f s sin ψ tanh μ q f s cos ψ tan ψ d u to write η ship 1 ψ 1 as 41 η ship 1 ψ 1 i 2 0 0 π 2 δ q f s cos ψ tanh μ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d ψ d q i 2 0 q f s tanh μ q f s δ u f u q d u d q i 2 0 q f s tanh μ q f s δ u f u q d u d q i 2 q f u ψ ψ 1 q d q in which the fact that the critical ψ 1 exists only for q q is used and the function f is introduced solely for brevity reasons to denote the other terms in the integrand writing out the final expression in 41 fully and further simplifying gives 42 η ship 1 ψ 1 i 4 q cot ψ 1 q p 0 q ψ 1 e i q r ship cos ψ 1 θ ship d q in which the equality in 36 is utilized the procedure can be repeated for η ship 1 ψ 2 η ship 1 ψ 3 and η ship 1 ψ 4 which results in similar expressions but with different signs subsequently the expression for η ship 1 is simplified to be 43 η ship 1 r ship θ ship i 4 n 1 4 q q p 0 q ψ n q cot ψ n q sgn sin ψ n q e i q r ship cos ψ n q θ ship d q in which q is determined from 37 and ψ n is given in 38 η ship 1 in 43 is an exact simplification of η ship 1 in 33 no further approximations are made the double integral in 33 has been simplified to the single integral in 43 as a result the computational effort to evaluate 43 is greatly reduced the newly obtained expression 43 does not invoke assumptions on the water depth and thus can be seen as an extension of darmon et al 2014 s deep water expression for η ship 1 as shown in 35 in addition by eliminating the ψ integral and keeping the q integral as opposed to the other way around the integral in 43 becomes better behaving i e no discontinuities exist in the integrand as a result sharp ship shape functions such as the rectangular shape 20 can be considered in contrast sharp shape functions create challenges in formulations as such that by darmon et al 2014 35 6 3 solution component η ship 2 the solution component η ship 2 in 33 cannot be simplified without approximations to numerically evaluate η ship 2 is as computationally intensive as evaluating the complete solution η ship in 27 therefore to further reduce the complexity of the solution and to devise a ship wake solution for fast computation an efficient approximation for η ship 2 must be sought for a ship shape that is symmetric about the y ship axis i e 44 p 0 q ψ 1 p 0 q ψ 2 p 0 q ψ 3 p 0 q ψ 4 where the definitions of the critical ψ values have been given in 38 it can be shown that η ship 1 is an odd function in x ship and η ship 2 is an even function in x ship within the context of small amplitude wave theory and away from the immediate vicinity of the ship we expect there to be no waves ahead of the ship i e for x ship 0 therefore we impose the following condition on the approximate ship wake solution 45 η ship approx η ship 1 η ship 2 approx 0 for x ship 0 which then gives 46 η ship 2 approx η ship 1 for x ship 0 η ship 1 for x ship 0 since η ship 2 approx should also be an even function in x ship we have thus found an approximation for η ship 2 for x ship symmetric ship shapes i e an even function in x ship and away from the immediate vicinity of the ship i e the water surface elevation directly below the ship is not captured written compactly the approximation reads 47 η ship 2 approx r ship θ ship η ship 1 r ship θ ship sgn cos θ ship 6 4 approximate ship wake solution η ship approx having simplified the solution component η ship 1 through exact analytical methods and found an approximation for the solution component η ship 2 by making use of symmetry we then assemble the approximate ship wake solution to be 48 η ship approx r ship θ ship i 4 n 1 4 1 sgn cos θ ship q q p 0 q ψ n q cot ψ n q sgn sin ψ n q e i q r ship cos ψ n q θ ship d q in which q is determined from 37 and ψ n is given in 38 the complete ship wake solution η ship 33 and the approximate ship wake solution η ship approx 48 are compared in the first column of fig 5 wave profiles along y ship 0 5 are shown in fig 6 it can be seen that the approximate ship wake solution η ship approx describes the full solution η ship extremely well except in the immediate vicinity of the ship η ship approx in 48 is the new approximate analytical solution for ship wakes that we have derived in this study thereafter we shall refer to η ship approx as the approximate ship wake solution the approximate ship wake solution is an accurate approximation of the physical ship wake solution 27 for a ship shape symmetric about the transverse pitch axis and away from the immediate vicinity of the ship the approximate ship wake solution is unprecedented and of practical value mainly due to its reduced complexity and trivial computational effort while the exact integral form analytical solutions such as 16 and 27 are classical in the water wave community they suffer from numerical integration difficulties due to the double integrals and singularities in the integrands on the other hand the approximate ship wake solution can be computed rapidly without numerical difficulties since the double integral is reduced to a single integral and singularities in the integrands have been removed 7 validation tests to validate the newly derived approximate ship wake solution 48 we shall test it in four applications satellite images of real ship wakes a towing tank experiment and two field experiments while modern satellite images serve as a free and easily accessible source of real ship wakes the images provide only information on the ship wake patterns but not their amplitudes hence wave height measurements from physical experiments are still needed to validate the ship wake amplitudes predicted by the approximate ship wake solution 7 1 google earth satellite images aguiar and souza 2009 proposed means to estimate ship velocities from google earth satellite images of ship wakes by measuring the ship wake angles and the ship wake wavelengths and invoking the dispersion relation in deep water rabaud and moisy 2013 used aguiar and souza 2009 s method to analyze a total of 37 google earth satellite images of ship wakes and found that ship wake patterns resemble mach cones for large f s i e the wake angles decrease as f s 1 as opposed to the classical kelvin wake angle 1 darmon et al 2014 argued that the apparent wake angles observed in the satellite images most likely corresponded to ship wakes of the largest amplitudes and not necessarily the kelvin wakes for a radially symmetric gaussian shaped pressure field with large f s darmon et al 2014 showed analytically that the wake angle corresponding to the maximum wave amplitude is 49 θ darmon 1 4 0 1 4 π 1 f s we note that θ darmon θ kelvin at approximately f s 0 66 using the ship locations and parameters provided by rabaud and moisy 2013 we compute the approximate ship wake solutions 48 for these 37 cases of real ship wakes both the rectangular hull shape 20 and the gaussian hull shape 25 are considered only ten cases are presented in this paper the relevant parameters for these ten cases are listed in table 1 while the ship width w is estimated by us from the satellite images all the other parameters are taken directly from rabaud and moisy 2013 the tested ship based froude number ranges from f s 0 14 to f s 1 67 the results are compared in fig 7 for 0 42 f s 1 67 and in fig 8 for 0 14 f s 0 37 the kelvin wake angle θ kelvin and the darmon wake angle θ darmon when applicable are also marked in these figures we remark that only the general ship wake patterns can be inferred from the satellite images the wave amplitudes cannot be determined from these images even the wave phases cannot be easily estimated from the images since the pixel brightness in the images are linked to the water surface steepness and the direction of sunlight in addition the ship dimensions estimated from the satellite images do not faithfully represent the hull dimensions while image enhancing techniques can be implemented to highlight certain features in the satellite images it is not done here all satellite images shown in this study are direct screenshots from google earth three different types of ship wakes can be seen in these figures take the center column of fig 7 e for example the label a marks the classical transverse waves while the label b marks the classical divergent waves these two types of ship wakes are well known in the literature on the other hand secondary waves label c show in the transition area between the transverse waves a and the divergent waves b these secondary waves appear to be highly sensitive to the hull shape the sharper the hull shape such as the extreme case of a rectangular shape the more pronounced the secondary waves therefore in this study we shall refer to these waves marked by the label c as the hull shape waves as can be seen in fig 7 very good agreement between the results are obtained for 0 42 f s 1 67 the performance of the approximate ship wake solution is assessed based on two criteria whether the overall pattern predicted by the approximate solution match that in the satellite images and whether the approximate solutions based on the two different hull shapes agree with each other in terms of both the pattern and the magnitude while some discrepancies exist due to the different hull shapes the overall agreement between the approximate ship wake solution regardless of the hull shape used and the satellite images is exceptional in fig 7 for 0 42 f s 1 67 discrepancies are apparent in fig 8 for 0 14 f s 0 37 the divergent waves in the third column of fig 8 i e the gaussian hull solution become nearly indistinguishable in addition the phases of the transverse waves between the rectangular hull solution and the gaussian hull solution are off however we note that this is also tied to how the characteristic length is defined in the gaussian shape as f s decreases the divergent waves become less and less visible in the satellite images for f s 0 27 the gaussian hull solution seems to stop working yielding negligibly small results this is likely due to rabaud and moisy 2013 s argument that the gaussian shape does not contain sufficient short wave components to excite ship wakes at low f s on the other hand the rectangular hull solution which contains short wave components due to the sharp edges continues to yield sensible results down to f s 0 14 even capturing the hull shape waves that are prevalent in the satellite images nonetheless the accuracy of the rectangular hull solution on the ship wake pattern also becomes questionable for f s 0 27 since differences from the satellite images are obvious overall judging by the ship wake pattern alone we consider 0 42 f s 1 67 to be a safe range where the approximate ship wake solution is valid regardless of the hull shape used more questionably the rectangular hull solution seems to capture the ship wake pattern satisfactorily down to f s 0 27 for f s 0 27 the approximate ship wake solution becomes unreliable and the gaussian hull solution starts to yield negligibly small results 7 2 lindenmuth et al 1991 s towing tank experiment to establish the validity of the approximate ship wake solution the ship wake amplitudes must also be checked from the analysis based on the satellite images we learn that 0 42 f s 1 67 is a safe range where the approximate ship wake solution is valid and 0 27 f s 0 42 is a questionable range where the approximate ship wake solution might be satisfactory but highly dependent on the hull shape this restriction on f s which is linked to the ship speed places a limit on the selection of physical experiments to be used as benchmark tests since a majority of existing experimental measurements were obtained for f s 0 3 lindenmuth et al 1991 measured the ship wake of a 1 24 822 model in a towing tank with f s 0 414 the exact experimental setup was unspecified in terms of the prototype scales the ship length is l 142 m the ship width is w 18 9 m and the draft is 6 16 m gourlay 2019 used this experiment to test the numerical model phflow which employs the nonlinear potential flow theory to solve for ship wakes gourlay 2019 used the real hull shape in the numerical simulation and calculated the displacement volume based on the 6 16 m draft of the dtmb 5415 hull to be 8425 4 m3 hence the ship mass is m 8425 4 ρ kg where ρ is the fluid density the water depth used in lindenmuth et al 1991 s experiment was unspecified gourlay 2019 assumed that the deep water condition applies in our calculations we assume a water depth of 171 m which falls in the deep water range in which the results are no longer depth sensitive for this experiment the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 9 it can be seen that the sharp rectangular hull produces more pronounced waves and highly visible hull shape waves while the smooth gaussian hull produces more mellow waves and barely visible hull shape waves a real ship hull is expected to yield results somewhere in between these two extreme cases experimental measurements are available along y ship 46 m the wave profiles including the experimental measurements from lindenmuth et al 1991 the numerical results from gourlay 2019 our approximate solutions and the exact analytical solutions are compared in fig 10 while both hull shapes yield reasonable ship wake amplitudes the gaussian hull solution appears to agree with measurements more implying the ship hull used in the experiment may be of a smooth nature as shown in fig 2 the dtmb 5415 hull is indeed more streamlined and qualitatively the elliptical gaussian shape appears to be a better approximation than the rectangular shape despite the differences in the exact wave shapes which are tied to the exact ship shape functions assumed the most important discovery here is that the ship wake amplitude predicted by the approximate ship wake solution is valid for f s 0 414 a critical piece of information that cannot be obtained from the comparison with satellite images in addition it can be seen in fig 10 that the approximate solution η ship approx in 48 agrees nearly perfectly with the exact solution η ship in 48 the slight differences are likely due to numerical integration errors since y ship 46 m is sufficiently far away from the immediate vicinity of the ship as indicated in fig 9 the approximate solution η ship approx is a highly accurate approximation of the exact solution η ship 7 3 david et al 2017 s field experiment to validate their boussinesq type numerical model for ship wakes david et al 2017 measured the wakes generated by a boat in river elbe near hamburg germany the patrol boat hafenkapitän is l 19 6 m long and w 5 1 m wide with a 1 5 m draft the shipyard hermann barthel gmbh lists the maximum speed of hafenkapitän as 13 kn 6 69 m s or 24 km h thus even though david et al 2017 reported that the boat traveled at 18 5 m s 36 kn or 66 7 km h in the experiment we believe it was a typo the boat most likely traveled at 18 5 km h 5 14 m s or 10 kn the displacement volume or the mass of the boat was not specified therefore we use the slender ship pressure model of bayraktar and beji 2013 which was adopted by david et al 2017 in their numerical simulations to find the displacement volume to be 49 76 m3 the ship mass is hence m 49 76 ρ kg the boat traveled at 5 14 m s along a straight line where the water depth is between 8 5 m and 9 0 m a wave gauge was located closer to the river bank in a water depth of 7 0 m the closest distance between the wave gage and the boat s path is 25 m while a planer slope better resembled the real bathymetry as adopted in david et al 2017 s numerical simulation our approximate ship wake solution only accepts a constant water depth a constant depth of h 8 5 m is used in calculating the approximate ship wake solution the ship based froude number is thus f s 0 371 while both wind and current effects were present in the field experiment they are not considered in david et al 2017 s numerical simulation or in our approximate ship wake solution for this experiment the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 11 the hull shape effects are again obvious while the sharp rectangular hull produces more pronounced waves and highly visible hull shape waves the smooth gaussian hull produces more mellow waves and barely visible hull shape waves a real ship hull is expected to yield results somewhere in between these two extreme cases a wave gage was located at 25 m away from the boat s path of travel since the boat travels at a constant speed of 5 14 m s the wave profile along y ship 25 m can be converted to match the wave gauge measurements the time origin of david et al 2017 s results was unspecified therefore we determine the needed time shift based on david et al 2017 s numerical results and our gaussian hull solution and consistently use this amount of time shift to plot both the rectangular hull solution and the gaussian hull solution the results are shown in fig 12 firstly we note that our gaussian hull solution agrees well with david et al 2017 s numerical results based also on a smooth hull indicating that neither the variable water depth a constant depth is assumed in our approximate solution while a planar slope is assumed in david et al 2017 s numerical simulation nor nonlinear effects our approximate solution is linear while david et al 2017 s numerical model allows for nonlinearities are significant compared with field measurements both the gaussian hull solution and the numerical results predict reasonable wave amplitudes although the exact wave shapes are noticeably different these smooth hull results appear to capture the main waves between 57 t 67 s but not the frontal waves t 57 s or the rear waves t 67 s on the other hand although the rectangular hull solution does not accurately capture the main waves it appears to capture well both the frontal waves and the rear waves these observations again lead to the conclusion that using the exact hull shape is critical to match the exact shape of ship wakes a real ship hull contains both sharp and smooth components and shall produce ship wakes in between the extreme patterns predicted by the rectangular hull solution and the gaussian hull solution despite the visible discrepancies among the results the most important piece of information gained from this test is that both the rectangular hull solution and the gaussian hull solution predict reasonable wave amplitudes therefore the performance of the approximate ship wake solution is verified for f s 0 371 lastly we remark that the approximate solution η ship approx is virtually identical to the exact solution η ship in fig 12 again indicating that η ship approx is a highly accurate approximation of η ship away from the immediate vicinity of the ship 7 4 dam et al 2008 s field experiment also to validate their boussinesq type numerical model for ship wakes dam et al 2008 measured the wakes generated by a boat in a narrow channel restricted by vertical walls at a straight section of the shingashi river near tokyo japan the channel is 50 m wide the water depth at the left bank 35 m away from the sailing line is 1 9 m deep the water depth at the sailing line and the right bank 15 m away from the sailing line is 4 4 m deep the exact bathymetry is not given a wave gauge was located at 0 5 m away from the right bank or 34 5 m away from the sailing line to measure the free surface elevation in dam et al 2008 s case 14 the boat sakura with l 24 00 m w 6 00 m and m 53 000 kg traveled at a speed of 5 42 m s dam et al 2008 reported the current velocity to be 0 45 m s in the direction of the boat s travel therefore the effective boat speed for wave making is 4 97 m s or f s 0 324 using a constant water depth of h 4 4 m and superposing the solutions to mimic wave reflections from the vertical walls the wave fields predicted by the rectangular hull solution and the gaussian hull solution are shown in fig 13 similarly to the satellite image with f s 0 33 in fig 8 b in this case with f s 0 324 the gaussian hull solution yields noticeably smaller wave amplitudes than the rectangular hull solution a wave gage was located near the left bank at a distance of 34 5 m away from the boat s path of travel knowing the actual boat speed and the current velocity the wave profile along y ship 34 5 m can be converted to the time series measured at the wave gauge location the field measurements the numerical results from dam et al 2008 the rectangular hull solution and the gaussian hull solution are compared in fig 14 in which t 0 is defined as the instant when the ship bow passes just in front of the wave gauge since the wave gauge is only 0 5 m away from the left bank wave reflection from the left bank is almost immediate on the other hand the right bank is 49 5 m away from wave gauge and the wave reflection from the right bank reaches the wave gauge at about t 20 s the results in fig 14 do not compare well the gaussian hull solution is significantly smaller than the other results suggesting that the gaussian hull solution is no longer valid for f s 0 324 although the rectangular hull solution has the same order of magnitude as the measurements the wave phases do not match well dam et al 2008 s numerical results based on a boussinesq type model employing the slender ship theory of chen and sharma 1995 fare no better than our approximate ship wake solution we also note that a maximum wave height of 1 m as recorded by the wave gauge in a water depth of 1 9 m is highly nonlinear violating the linear wave theory assumed in deriving the ship wake analytical solutions based on this validation test we conclude that the approximate ship wake solution is no longer valid for f s 0 324 despite the disagreements among the results for this case it can be observed in fig 14 that the approximate solution η ship approx still agrees nearly perfectly with the exact solution η ship therefore η ship approx remains a highly accurate approximation of η ship for f s 0 324 even when the validity of the exact solution η ship itself becomes questionable 7 5 discussions having tested the approximate ship wake solution against satellite images one towing tank experiment and two field experiments we conclude that the approximate ship wake solution is valid for 0 414 f s 1 67 and potentially satisfactory for 0 371 f s 0 414 although the wave amplitudes predicted by the approximate ship wake solution are off for f s 0 371 the rectangular hull solution appears to accurately capture the wake angles down to f s 0 14 the lowest froude number considered in this study in addition in all the tests conducted regardless of the value of f s the approximate solution η ship approx agrees nearly perfect with the exact solution η ship away from the immediate vicinity of the ship therefore the approximate ship wake solution is indeed a highly accurate approximation of the exact ship wake solution 8 water depth effects the analytical solutions presented in this study are based on the small amplitude water wave theory without making any assumptions on the water depth therefore the approximate ship wake solution 48 can be used in any water depth to showcase the water depth effects we pick case 14 considered by rabaud and moisy 2013 as an example the relevant parameters are tabulated in table 2 and the google earth satellite image of this case is shown in fig 15 a this case is selected for two main reasons first its ship based froude number f s 0 47 is within the range 0 414 f s 1 67 established in section 7 as where the approximate ship wake solution is valid second its estimated strength of frequency dispersion μ h l 0 19 is generally classified as weakly dispersive in the water wave community put differently the water depth is said to be intermediate where the effects of water depth are non negligible see e g dean and dalrymple 1991 therefore case 14 can be regarded as the intermediate water case to examine the water depth effects we consider two alternate water depths for this vessel to travel in case 14 s with water depth h 2 2 m which is one fifth that of case 14 and case 14 d with water depth h 55 m which is five times that of case 14 we note that whether a 2 2 water depth would be navigable for this vessel is not the subject of discussion here for case 14 s the estimated strength of frequency dispersion is μ h l 0 04 which is sufficiently low for the shallow water assumption to hold therefore case 14 s can be regarded as the shallow water case on the other hand for case 14 d the estimated strength of frequency dispersion is μ h l 0 97 which is sufficiently high for the deep water assumption to hold therefore case 14 d can be regarded as the deep water case 8 1 results based on the approximate ship wake solution for these three cases case 14 case 14 s and case 14 d the results predicted by the approximate ship wake solution 48 are plotted in fig 15 both the rectangular hull solution and the gaussian hull solution are considered in addition the deep water kelvin wake angle 1 the shallow water mach like angle 50 and the detected wake angle are also shown in shallow water linear water waves travel at a dimensionless speed of one therefore for a ship traveling at a super critical speed f r 1 the forced water waves form a mach like cone the angle formed between the wake crests and the ship s direction of travel is 50 θ shallow sin 1 1 f r the detected wake angle shown in fig 15 a is estimated by rabaud and moisy 2013 based on the brightest points of the wake the detected wake angles in the approximate ship wake solutions are determined based on the locations of maximum crest height the water depth effects can be clearly seen in fig 15 in the shallow water case case 14 s since the ship travels at a supercritical speed based on the depth based froude number f r 2 37 the main wake forms a mach like cone whose half angle 50 is different from the deep water kelvin wake angle 1 no detected wake angles can be obtained using the locations of maximum crest height since peaks are not always existent along each wave crest i e the height of each wave crest is nearly uniform in space in the deep water case case 14 d the ship travels at a subcritical speed based on the depth based froude number f r 0 47 a classical wake pattern consisting of transverse waves divergent waves and hull shape waves discussed in section 7 and marked in fig 7 results unsurprisingly the deep water kelvin wake angle 1 agrees well with the detected wake angles in deep water in the intermediate water case case 14 the ship travels at a near critical speed based on the depth based froude number f r 1 06 divergent waves can be clearly identified in the results to some extent hull shape waves can also be identified in the rectangular hull results fig 15 c transverse waves however are absent in the intermediate water case while the detected wake angle agrees nearly perfectly with the kelvin wake angle for the gaussian shape the agreement is less perfect for the rectangular shape for the rectangular shape the kelvin wake angle works better in the deep water case than in the intermediate water case when compared with the detected wake angles interestingly in the intermediate water case the wave crests of the divergent waves appear to be approximately aligned with the shallow water mach like angle suggesting that the divergent waves are still effected by the shallow water wave physics in this intermediate water case on the other hand the hull shape effects observed in these three cases are consistent with the discussions presented in section 7 namely the hull shape waves are particularly noticeable for the rectangular shape and these waves complicate the wake pattern and make identifying a representative ship wake angle more difficult altogether the above results indicate that water depth has noticeable effects on the ship wake pattern and the identification of a representative ship wake angle therefore the deep water assumption widely invoked in classical ship wake studies must be checked carefully to ensure that the actual water depth considered is sufficiently deep since the present study invokes no assumptions on the water depth the approximate ship wake solution 48 is a suitable tool for investigating the effects due to water depth at least in the range 0 414 f s 1 67 for which the approximate ship wake solution has been validated 8 2 possible error in reported water depth this example also hints at the possibility of using the approximate ship wake solution 48 in combination with satellite ship wake images to gauge the water depth in which a ship travels upon close inspection of the satellite image in fig 15 a the intermediate water results in fig 15 c f and the deep water results in fig 15 d g one may argue that the agreement between the satellite image and the deep water results is better than if not at least as good as the agreement between the satellite image and the intermediate water results particularly slight tracks of transverse waves can be seen in the satellite image yet the intermediate water results do not show transverse waves in the deep water results however the transverse waves are clearly visible furthermore the number of transverse waves and the wave phases in the deep water results also appear to agree with the satellite image such a discrepancy is concerning and raises new questions e g is the approximate ship wake solution not accurate is the satellite image not a faithful representation of the wakes is the estimated water depth or other parameters wrong fortunately the last question can be addressed with relative ease and will be shown to be a likely cause using nautical charts from navionics rabaud and moisy 2013 estimated the water depth at this location to be 11 m which is the water depth specified in case 14 however using google earth which uses data from etopo1 noaa national geophysical data center 2009 amante and eakins 2009 we find the water depth at this location to be 66 m using gebco 2020 we find the water depth at this location to be 50 m the latter two depth estimates are much closer to the 55 m depth assumed in the deep water case 14 d than the 11 m depth estimated by rabaud and moisy 2013 therefore it is plausible that the actual water depth at this location and at the time the satellite image was taken november 2009 is closer to 55 m than to 11 m we remark that such an inverse analysis is greatly facilitated by the newly proposed approximate ship wake solution which can be computed quickly and robustly and in any water depth 9 concluding remarks in this study we first reviewed the small amplitude wave theory modeling a ship as a moving pressure field acting on the water surface and clearly stating the assumptions invoked we rederived the classical integral form analytical solution for ship wakes for ship shapes symmetric about the transverse pitch axis and away from the immediate vicinity of the ship we proposed an approximate ship wake solution that can be computed quickly then we validated the newly proposed approximate ship wake solution in terms of both the wake patterns and the wake amplitudes using 37 satellite images of ship wakes one towing tank experiment and two field experiments the validation tests show that both the wake patterns and the wake amplitudes are correctly captured for the ship based froude number range 0 414 f s 1 67 however the wake patterns but not the wake amplitudes appear to be accurately captured for 0 27 f s 0 414 we then used the new ship wake solution to examine the effects of water depths on wake patterns and demonstrated the possibility of using the new solution along with satellite images to infer water depths the newly proposed approximate ship wake solution 48 is unprecedented as it correctly captures both the wake patterns and the wake amplitudes admits both continuous and discontinuous ship shape functions does not invoke the deep water approximation and reduces the double integral in the exact solution to a single integral through analytical means in addition singularities in the integrands of the exact solution have been removed as a result the approximate ship wake solution can be evaluated straightforwardly with numerical integration methods to plot the analytical solutions two ship shape functions in which the ship length width and weight need to be specified are considered a sharp rectangular shape and a smooth gaussian shape while the overall wake patterns are unaffected by the ship shape the detailed characteristics are the differences mainly show in the transition area between the divergent waves and the transverse waves in the form of what we refer to as the hull shape waves in this study we speculate that these hull shape waves are key to linking the characteristics of a ship hull to the characteristics of the wakes it generates it is understood that a real ship hull consists of both sharp and smooth components and therefore should generate wakes with characteristics that fall in between those predicted by the two extreme ship shape functions i e the rectangular shape represents the most discontinuous hull whereas the gaussian shape represents the smoothest hull how to accurately represent a realistic ship hull using a combination of elementary shape functions is beyond the scope of the present study after validating the approximate ship wake solution using available data the approximate solution was used to investigate the effects of water depth on ship wake patterns water depth was found to have noticeable effects on not only the wake pattern but also the identification of a representative wake angle consistent with linear wave theory in shallow water the wake crests form a mach like cone for a ship traveling at a supercritcal speed depth based f r 1 in deep water the wakes are accurately described by classical ship wake theory in intermediate water the wakes manifest a mixture of shallow water characteristics and deep water characteristics by comparing the approximate ship wake solution with a satellite image we discovered a plausibly misreported water depth in a previous study this exercise hints at the possibility of using the approximate ship wake solution to infer representative water depths in satellite images of ship wakes since the analytical solutions presented in this study are derived based on the small amplitude wave theory they are limited by the underlying assumptions first nonlinear effects are not considered the wave amplitude is assumed to be small in comparison to the water depth second the water depth is assumed to be a constant although water depth effects become irrelevant in the deep water limit third the ship is required to travel in a straight line at a constant speed fourth neither capillary effects nor viscous effects are considered fifth ambient winds and currents are neglected in addition in deriving the approximate ship wake solution the ship shape is assumed to be symmetric about the transverse pitch axis furthermore the approximate ship wake solution does not apply in the immediate vicinity of the ship i e the region most critical for calculating the wave resistance of a hull a new approximate ship wake solution that can be computed quickly and robustly is proposed and validated in this study it is hoped that this new solution aids in the ship wake inversion problem due to its trivial computational cost and parametrization it may be particularly suitable for use in combination with machine learning techniques finite depth effects and ship shape effects can all be investigated in the future using this new approximate ship wake solution it is also worthwhile to explore the possibilities of extending the approximate solution to allow for realistic ship shapes that are not symmetric about the transverse pitch axis lastly why the analytical solutions start to deviate from observations at low froude numbers f s 0 371 also warrants further investigation credit authorship contribution statement peter h y lo conceptualization methodology software validation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is supported by the ministry of science and technology of taiwan through grants 109 2221 e 002 094 and 108 2218 e 002 075 appendix a numerical integration techniques to demonstrate how to numerically compute the double integral form analytical solutions we take η ship 2 in 33 as an example 51 η ship 2 r ship θ ship 1 2 π pv 0 2 π 0 q p 0 q ψ tanh μ q f s cos ψ 1 q f s cos ψ tanh μ q f s cos ψ e i q r ship cos ψ θ ship d q d ψ for q q in which q is determined from 37 four critical ψ values ψ 1 ψ 2 ψ 3 and ψ 4 as given in 38 cause discontinuities in the integrand of 51 it is shown in appendix b that these discontinuities are integrable based on the cauchy principal value and thus the cauchy principal value of the double integral exists numerically it is necessary to avoid these critical ψ values using a large number n instead of infinity as the upper integration limit for the q integral and invoking the periodicity in ψ we calculate 51 as 52 η ship 2 r ship θ ship 1 2 π pv 0 2 π 0 f q ψ d q d ψ 1 2 π 0 2 π 0 q d f d q d ψ ψ 1 q d ψ 1 q d q d n f d q d ψ ψ 1 q d ψ 2 q d q d n f d q d ψ ψ 2 q d ψ 3 q d q d n f d q d ψ ψ 3 q d ψ 4 q d q d n f d q d ψ where the function f q ψ is introduced temporarily to abbreviate the integrand in 51 and d is a very small number in this study d 1 0 6 and n 100 are used to compute double integrals like 51 when f r 1 so that 37 is unconditionally satisfied i e no q can be solved for q is set to be 0 when q 0 which then corresponds to f r 1 the first approximation term in 52 needs not be computed appendix b discontinuities in the integrand in the expression 51 for η ship 2 each critical ψ n as given in 38 corresponds to a discontinuity of the form 53 i n r ship θ ship lim d 0 q ψ n q d ψ n q d tanh μ q f s cos ψ q f s cos ψ tanh μ q f s cos ψ q p 0 q ψ e i q r ship cos ψ θ ship d q d ψ where 54 q f s cos ψ n tanh μ q f s cos ψ n 0 using the property 54 and taylor series expansion about ψ ψ n to write 55 cos 2 ψ cos 2 ψ n 2 ψ ψ n sin ψ n cos ψ n we have 56 i lim d 0 q ψ n q d ψ n q d tanh μ q q f s 2 cos 2 ψ tanh μ q q p 0 q ψ e i q r ship cos ψ θ ship d q d ψ lim d 0 q ψ n q d ψ n q d tanh μ q q f s 2 cos 2 ψ n 2 q f s 2 ψ ψ n sin ψ n cos ψ n tanh μ q q p 0 q ψ n e i q r ship cos ψ n θ ship d q d ψ ψ n q d ψ n q d 1 2 tan ψ n q p 0 q ψ n e i q r ship cos ψ n θ ship lim d 0 ψ n q d ψ n q d 1 ψ ψ n d ψ d q with the substitution u ψ ψ n 57 lim d 0 ψ n q d ψ n q d 1 ψ ψ n d ψ lim d 0 d d 1 u d u 0 based on the cauchy principal value therefore the discontinuities in 51 for η ship 2 are integrable based on the cauchy principal value 
20519,this study presents the unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff model and the vibro acoustic characteristics of a coupled pump jet shafting system suboff model under unsteady excitations the excitations of the pump jet are obtained by cfd and the vibro acoustic responses are predicted by coupled fem bem a mapping method based on radial basis function is established between cfd and structural mesh to apply the distributed pulsation forces on the wet surface of the pump jet the effect of the method used to apply the excitation forces on vibro acoustic responses is investigated by applying distributed or equivalent pulsation forces at different areas of the pump jet modal shapes transmitted forces sound radiation power radiation directivity pattern and panel contributions are reported to illustrate the characteristics of the vibro acoustic responses and the influence of the method used to apply the excitation forces on the responses it is seen that the shaft frequency and the longitudinal mode resonant frequency of the shafting system are the typical characteristic frequencies with large magnitude in vibro acoustic responses of the coupled system compared with applying concentrated forces applied at hub or 0 7 r the responses produced by applying distributed forces on the whole pump jet present modes and excitation characteristics with more reasonable magnitudes illustrating the importance of applying distribute forces instead of concentrated forces besides the contribution of the distributed forces on rotor is dominant since the responses of applying distributed forces on the pump jet and applying distributed forces on rotor are similar keywords pump jet distributed hydrodynamic forces structural modes vibro acoustic response coupled fem bem 1 introduction the noise radiated by ships and vessels will cause damage for marine organism and also undermine the stealth for military ship in the low frequency range the propeller is one of the principal sources of noise rotation of the propeller results in discrete tonal at the blade passing frequency bpf and its harmonics as well as broadband exciting forces besides direct sound radiation into the far field the hydrodynamic forces may cause vibration of the hull through the propulsion shafting system and the fluid the characteristics of the excitation forces and resultant sound radiation are of interest for researchers wei and wang 2013 merz et al 2013 zhang et al 2014 pump jet has become a preferred propulsor of submerged bodies since its advantage to obtain a more uniform inflow to the rotor working inside a duct and its ability to improve the rotor blade cavitation and powering performance for the pump jet propelled ships the hydrodynamic pressures on the duct can also produce direct sound radiation and excite the hull through the stator li et al 2019 qin et al 2017 2019 which makes the characteristics of the vibro acoustic responses of a coupled pump jet shafting system hull model more complex in this study the vibro acoustic responses of a coupled pump jet shafting system suboff model under unsteady excitations of pump jet are investigated the hydrodynamic forces for a propeller or a pump jet propulsor can be predicted by employing the theoretical methods wang et al 2019 sánchez caja et al 2019 the numerical methods merz et al 2013 zhang et al 2014 du et al 2019 lu et al 2018 motallebi nejad et al 2017 ahn and kwon 2015 qiu et al 2020 such as unsteady reynolds average navier stokes urans and large eddy simulation les as well as the experimental methods vali et al 2018 shirazi et al 2019 suryanarayana et al 2010 the unsteady hydrodynamics of a propeller or pump jet behind circumferential nonuniform wake should take into account the mutual interaction of the thruster and of the hull the propulsor s hydrodynamic performance can usually be obtained by carrying experiments in a cavitation tunnel vali et al 2018 shirazi et al 2019 suryanarayana et al 2010 while the measurement of the unsteady force is difficult especially for distributed fluctuation pressure jessup and stuart 1990 one way to overcome this is to obtain the flow velocity distributions produced by the wake through a laser doppler velocimetry ldv system and then to compute the pressure fluctuations on the blade through numerical simulations such as urans and les tian et al 2017 the dynamic modelling of vibration transmission through the propulsion shafting system has been undertaken and the vibro acoustic responses have been predicted for the dynamic model of vibration transmission propellers are denoted as masses springs and beams as well as three dimensional solid elements youssef et al 2015 li et al 2016 huang et al 2017 2018 it is shown that a realistic propeller should be implemented into the dynamic model in order to investigate the influence of propeller flexibility on vibration transmission although a realistic propeller is employed in dynamic modelling the resultant vibro acoustic responses are still influenced by the way to apply the distributed fluctuation pressure to input the excitation the unsteady forces are often considered as concentrated unit or fluctuation forces applied at the hub or at 0 7r r is the radius of the propeller of the propeller blades li et al 2016 huang et al 2017 2018 for broadband force components the unsteady thrust spectrum is obtained and applied at each blade strip by mapping into the nodes on the loading surface of blades chen et al 2017a 2017b to account for the influences of pressure distribution on blades flexibility of the propeller and fluid loading coupled finite element method boundary element method fem bem has been developed to predict the vibro acoustic responses produced by the tonal spectrum unsteady forces applied at the propeller surface zou et al 2017 2019 li et al 2017 he et al 2012 young 2007 for more complex pump jet propelled ships few public researches are available according to the authors knowledge to account for mutual interaction of the propulsor and hull numerical methods are more suitable for submarines propelled by classical propellers several researches have been carried out for example the vibro acoustic responses of a suboff submarine excited by propeller s thrust and side forces has been reported by employing cfd and fem wei and wang 2013 it is shown that the spectrums of a single blade s forces differ a lot from the total blades forces which is attributed to the phase cancellation of different blade s forces however the propeller s force was taken as concentrated force when applied to the fem which ignores the distribution information of each blade force they also pointed out that this problem requires further consideration for the cruising condition the underwater sound radiation is dominated by the vibro acoustic responses of the hull excited by the propulsors and transmitted through structural parts according to the knowledge of the authors there are few public researches concerning with the vibro acoustic responses of the pump jet propelled submarines through shafting system compared to the case of classical propellers the vibro acoustic responses of the pump jet propelled submarines are more complex since the pump jet shafting system submarine will interact with each other to produce a more complex modal characteristic which is not clear due to the existence of duct and stators meanwhile the excitation pulsation pressures are distribution pressures on not only propeller blades but also stators and duct of which modes are excited and strongly contributed to the underwater sound radiation under the distributed pressure has not been reported in order to clarify the above problems the vibro acoustic responses of a pump jet propelled suboff model is researched in this paper aiming to investigate the modal characteristic and vibro acoustic responses of the pump jet propelled suboff model under distributed unsteady hydrodynamics by considering different methods to apply the loads the suboff model is referred to the aff8 darpa sub off model and studied by some researchers liefvendahl and troëng 2011 lungu 2019 chase 2012 after obtaining the distributed unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff model a mapping method based on radial basis function rbf is established between cfd mesh and structural mesh to obtain the distributed pulsation force on structural wet surface the distributed pulsation forces are transformed to frequency domain by fft and then applied individually at each node on the wet surface of the pump jet to yield vibro acoustic responses for the coupled pump jet shafting system suboff model the vibro acoustic responses by considering distributed pulsation force is compared with those obtained by concentrated force to show the importance of taking distribution information into consideration the unsteady hydrodynamics are simulating using ansys fluent commercial software the vibro acoustic responses are simulating using abaqus and virtual lab commercial software the paper is organized as follows in section 2 the fundamental theories on urans coupled fem and bem as well as rbf based mapping are briefly reviewed in section 3 numerical simulation is carried out in subsection 3 1 independent hydrodynamics of the pump jet and suboff are validated and the cfd model of a pump jet running in the wake of a suboff model is established then cfd results of pressure distribution before and after mapping are reported in subsection 3 2 coupled fem model and bem model of the pump jet shafting system suboff model are presented modal results are given firstly to provide analysis bases for the vibro acoustic results then force transmission through bearings sound radiation power level swl are reported and discussed to find the characteristic peaks for different force applying methods radiation directivity pattern is also illustrated to outline the difference between different force applying methods panel contribution analysis is carried out to identify the contribution of the rotor duct stator and hull to sound radiation finally concluding remarks are given 2 theories 2 1 unsteady hydrodynamics of pump jet behind suboff by urans the cfd method is utilized to calculate the pulsation pressure of the pump jet propulsor in the wake of submarine which is used as the excitation source of a coupled pump jet shafting system suboff model the sst k ω menter 1994 turbulence model is employed to obtain the pulsation pressure of the pump jet and submarine in the present simulations the continuity and the momentum equations are expressed as 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j f i ρ where i j 1 2 3 ρ is the density of the fluid p is the mean pressure f i is the body force and ρ u i u j is the reynold stress tensor that needs a closure to close the momentum equation one is based on the assumption of boussinesq s hypothesis the reynold stresses can be expressed as 3 ρ u i u j μ t u i x j u j x i 2 3 ρ k μ t u k x k δ i j according to the shear stress transport sst k ω turbulence model the turbulence kinetic energy k and the specific dissipation rate ω can be obtained from the following equations 4 t ρ k x i ρ k u i x j μ μ t σ k k x j g k ρ β k ω 5 t ρ ω x j ρ ω u j x j μ μ t σ ω ω x j g ω ρ β ω 2 d ω where σ k and σ w are the turbulent prandtl numbers for k and ω d ω is the cross diffusion term g k and g ω represent the generation of k and ω respectively and the turbulent viscosity μ t is defined as 6 μ t ρ k ω 1 max 1 α s f 2 α 1 ω where α and α 1 are the model coefficient and model constant and f 2 is the blending function 2 2 vibro acoustic responses of coupled pump jet shafting system suboff by coupled fem and bem the vibro acoustic responses of the coupled pump jet shafting system suboff model are calculated through 2 steps firstly the structural dynamics responses are calculated via coupled fem secondly the farfield acoustic radiation is calculated based on the vibration velocity on the wet surface by the bem firstly the coupled fem is employed to perform dynamic modeling of the coupled pump jet shafting system suboff structural model the equation of motion is denoted as huang et al 2020 7 m 0 η t π m a x p c 0 0 0 x p k h ρ 0 k a x p f 0 where x are the structural displacements of the structural nodes p are the pressures of nodes in the fluid f represents the unsteady forces of the pump jet m k and c are the structural mass matrix stiffness matrix and damping matrix of the pump jet shafting system suboff structural model c α m β k β k α and β are proportional damping constants for mass and stiffness matrix respectively m a k a and h denotes the mass matrix stiffness matrix of the acoustic medium the fluid structure coupling matrix respectively the structural mass matrix and stiffness matrix are obtained by assembly of the element mass matrix and element stiffness matrix in the global reference system for all the elements 8 k e 1 1 1 1 b t d b j d ξ d η m e 1 1 1 1 ρ s n t n j d ξ d η where ρ s is mass density of the structure j is the jacobi matrix n is the shape function matrix b is the strain displacement matrix d is the bending stiffness matrix the mass matrix and stiffness matrix of the acoustic medium the fluid structure coupling matrix are 9 m a 1 c 2 v a n ψ t n ψ d v k a v a n ψ t n ψ d v η ρ a a n ψ t n d a where c is acoustic velocity of the fluid ψ n ψ ψ w nw n ψ and ψ denotes shape function and nodal velocity potential vector of acoustic element respectively w denotes nodal displacement vector of the structural element on their boundary area a a respectively w πx π denotes the transformation matrix from the structural displacement vectors x to nodal displacement vector w of the structural element on the boundary area for harmonic excitation at angular frequency ω the displacement vectors are obtained as 10 k j ω c ω 2 m ω 2 1 ρ h k a ω 2 m a 1 η t π x f after obtaining the normal velocity of the α th node of the i th element on the boundary area v iα direct bem is employed to obtain the pressure vectors p iα the radiated power on their boundary area a a as well as the pressure in the far field p j bai et al 2013 11 i 1 l α a i j α p i α 4 π i 1 l e i j α p j i 1 l α b i j α v i α j 1 2 n o n b o u n d a r y a r e a a a 12 4 π p j i 1 l α a i j α p i α i 1 l α b i j α v i α j 1 2 m f i e l d p o int s where n is the number of surface nodes and m is the number of field points the coefficients are 13 a i j α a i n α ξ n exp j k r i j α ξ r i j α ξ j ξ d ξ 14 b i j α j ω ρ a i n α ξ exp j k r i j α ξ r i j α ξ j ξ d ξ 15 e i j α a 0 n 1 r i j α ξ j ξ d ξ where j ξ is the jacobian of the transformation a i is the area of the i th element and r i j α ξ is the distance between the j th field point and surface nodes and the α th node of the i th element n ξ represents the acoustic shape function of local coordinate ξ based on the sound pressure of a far field point p and the velocity of the radiating surface v n the panel contribution of different parts of the pump jet shafting system suboff model can be given by 16 p ω e 1 n p a t v e ω t v n e ω where the atv is the acoustic transfer vector the superscript e denotes an element contribution n p is the element numbers the acoustic contribution of a set of elements corresponding to a certain part of structure namely hull rotor duct stator in coupled pump jet shafting system suboff can be evaluated 2 3 mapping of distributed pulsation pressure on structural wet surface between cfd model and structural model based on radial basis function rbf the distributed pulsation pressures on the surface of rotor the stator and the duct obtained by cfd are mapped to the distributed excitation forces applied for nodes on the structural wet surface the mapping method is based on rbf which is used to build up function approximations of the form rao and yang 2017 17 j 1 n λ j ϕ x x j f j where ϕ x x j is a real valued function whose value depends only on the distance between the input and output points f j is represented as a sum of n rbfs each associated with a different center x j and weighted by an approximate coefficient λ j the weights λ j can be estimated using the matrix methods of linear least squares since the approximate function is linear in the weights λ j the rbf employed here is wedndland s c2 function which is expressed as 18 ϕ x x j 1 x x j 4 4 x x j 1 through mapping the distributed pressure at each element center on the structural wet surface is obtained the concentrated force on each node is produced by multiplying the distributed pressure with the area of the corresponding element this concentrated force is decomposed into three force components in cartesian coordinate system with the help of unit normal vector of the element 3 simulation and discussion 3 1 cfd model and unsteady pressure of pump jet behind suboff model a reduced scaled pump jet propulsor with 11 pre swirl stator blades and 9 rotor blades whose parameters are shown in table 1 is designed to match the suboff model the parameters of suboff submarine are listed in table 2 1 validation of cfd model for independent submarine and pump jet firstly the steady hydrodynamics of independent suboff submarine are studied and compared with experimental data to validate the accuracy of the cfd model then the cfd model of a pump jet propulsor with 5 pre swirl stator blades and 7 rotor blades is built and validated by the measured thrust and torque in the cavitation tunnel for the hydrodynamics of independent submarine a cylindrical computational domain in used the computational domain size is set according to ref wei and wang 2013 the domain extends one hull length upstream of the submarine model and two hull lengths downstream of the model thus being 4l in overall length the outer diameter of the circular computational domain is 10d sst k omega model is selected to close the calculation equation and the inflow velocity v s 3 051 m s re 1 2e6 the whole computational domain is discretized into hexahedral cells from a mesh independent analysis the resistance of the submarine converges at 103 23 n with 0 9 relative error compared to the experiment result when the total mesh number reaches 11 18 million and the y plus value of the most areas are between 1 and 2 the accuracy of the mesh and the simulation scheme are validated from the three aspects compared with the experimental results i e resistance at different speeds the axial wake fraction at the propeller disk and the pressure coefficient c p along the meridian line of the hull c p p p 0 0 5ρv s 2 where p is the local static pressure v s is the inlet velocity and p 0 is the ambient pressure bull 1996 as shown in fig 1 it is shown that the results are in good agreement with the experiment indicating the mesh and numerical scheme is accurate a pump jet propulsor with 5 stator blades and 7 rotor blades is modeled and experiment is carried out to validate the accuracy of cfd simulation the turbulence model and calculation method of pump jet are the same with what was used in the study of independent submarine the computational domain of the independent pump jet is shown in fig 2 the whole computational domain is discretized into hexahedral cells the stationary domain meshes is 5 0 million and the rotating domain meshes is 8 0 million the inlet of the computation domain is set as velocity inlet boundary condition where the velocity components are set as axial velocity with no radial and circumferential components for the outlet boundary the static pressure outlet boundary condition with a reference pressure of 0 pa is defined considering the rotation of rotor the whole computational domain is separated into two parts namely the rotating domain and the stationary domain the overlapped surfaces the interface of the rotating domain and the stationary domain between the stationary and the rotating domain are defined as sliding interfaces in order to exchange the flow field information between the stationary and the rotating domains simultaneously then the thrust coefficient k t the torque coefficient k q and the open water efficiency η 0 can be calculated via cfd with k t t r ρ n 2 d 4 k q q r ρ n 2 d 5 η 0 j 2 π k t k q where t r q r ρ n and d are rotor thrust torque the fluid density the revolution speed and the rotor diameter respectively j v a n d is the advance ratio v a is the inlet velocity to assure the reliability and efficiency of the developed numerical model experimental data available for the pump jet is used to validate the numerical results the experiment was carried out in the cavitation tunnel at shanghai jiaotong university as shown in fig 3 the values of k t k q and η 0 of the pump jet agree well with the experimental results 2 cfd model of a pump jet behind suboff after the cfd modeling scheme for independent suboff submarine and pump jet are validated the pump jet and submarine are now combined to obtain the unsteady forces the cfd model is established according to the previously verified grid division method and grid size the computational domain is also divided into stationary domain and a rotating domain and the stationary domain is divided into stator domain and hull domain as is shown in fig 4 the total meshes number of the computational domain is 22 5 million including 10 million for the hull domain 4 5 million for the stator domain and 8 million for the rotating domain the mesh of important parts of the computational domain is shown in fig 5 the inlet flow velocity is 3 05 m s and the rotor blades rotate at 15 rps rotation per second for unsteady calculation taking the steady flow result as initial condition the unsteady calculation is carried out with the time step 1 851e 5 s and a total simulation time of 1 3 s to obtain the unsteady forces 3 unsteady forces and mapping result fig 6 shows the time history and spectrum of the thrust lateral and vertical force for a single rotor blade the static data is neglected and only fluctuating value is presented for the time history results it is observed that the thrust has 11 peaks in one cycle corresponding to the 11 stator blades only one peak exists in the lateral and vertical force within one cycle and the pressure pulsation oscillates from 20n to 20n the spectrum of the thrust for a single blade mainly exhibits peaks at the shaft frequency sf for abbreviation and its multiplier the relatively high peak is 165 hz stator blade passing frequency sbpf for abbreviation and 60 hz 4sf the appearance of 60 hz reflects the fourth order non uniform flow field formed by the rudder on the stern of the hull as for the lateral force and the vertical force a very large peak appears at 15 hz sf it is worth noting that peaks also happen at 150 hz 10sf and 180 hz 12sf which correspond to the multiple sf adjacent to the number of stators the spectrum of each single blade will then be applied at 0 7 r of the middle line of each blade s pressure and suction face of the structural model to investigate the vibro acoustic response under this type of load applying method fig 7 shows the time history and spectrum of thrust lateral and vertical force for the rotor it is observed that there are 9 peaks in one cycle of the rotor corresponding to 9 rotor blades the lateral force and the vertical force of the rotor oscillates between 0 1 n and 0 2 n which is much smaller than that of a single blade the pattern of the single blade forces fluctuation and the excitation spectrums differ a lot from those of the rotor which is attributed to the phase cancellation of different blade s force when they are superimposed to yield the results of the rotor the spectrum of the thrust lateral and vertical force all exhibits strong peaks at 135 2 hz blade passing frequency bpf for abbreviation and its harmonics with the strongest peak at bpf the spectrum of rotor will then be applied at the hub of the rotor for the structural model to investigate the vibro acoustic response under this type of load applying method the pressure distributions after interpolation for different parts of the pump jet are plotted and compared with those by cfd to verify the accuracy of proposed mapping method the results at a time step of 5400 are shown in fig 8 the legend cfd mesh and fem mesh denotes the pressure distribution results directly computed by cfd and the results interpolated for fem mesh it is seen that the pressure distributions as well as the maximum minimum values are almost the same for different parts before and after mapping indicating the proposed mapping method is of high accuracy in order to further verify the accuracy of purposed mapping method in time domain force of a single blade during a period before and after interpolation was plotted in fig 9 it is seen that the difference is very small for forces in three directions therefore the accuracy of the proposed mapping method is high the distributed pulsation forces after interpolation are then applied at the whole pump jet structural nodes to investigate the vibro acoustic response 3 2 coupled fem and bem analysis 1 coupled fem model and bem model the fe model of the coupled pump jet shafting system suboff is established in abaqus as shown in fig 10 a the thickness of the hull shell is 6 mm which is modeled with 33861 s4r shell elements as shown in fig 10 b the shell of the suboff model is stiffened with t shape ring stiffeners which is modeled with 4354 b31 beam elements there are 4 bulkheads along the longitudinal direction the stator of the pump jet is supported at the stern of the suboff model the stator the duct and the rotor are modeled with 22641 c3d8 solid elements as shown in fig 10 c the length and radius of the shaft is 0 89 m and 0 022 m respectively the shaft is supported with a stern tube bearing at the stern of the hull and a thrust bearing at the center of the last bulkhead the shaft is modeled with b31 elements the lateral and vertical stiffness of the stern tube bearing is 4 5e9 n m and 1 7e8 n m respectively the longitudinal lateral and vertical stiffness of the thrust bearing is 6 6e8 n m 2 3e8 n m 6 7e8 n m respectively the material of the hull stiffeners and shaft the stators and the duct is steel the density elastic modulus and poisson s ratio of steel are 7850 kg m3 2 1e11 pa and 0 3 respectively a structural damping of 0 001 is set the material of the rotor is copper the density elastic modulus and poisson s ratio of steel are 8790 kg m3 1 1e11 pa and 0 3 respectively a structural damping of 0 001 is set considering the fluid structure interaction the surrounding fluid outside the suboff and the pump jet is also modeled to couple the pressure and structural velocity on the boundary nodes of the wet surface as shown in fig 10 d the wet surface of the coupled structural model is composed of the surface of the suboff hull the stator the rotor and the duct a cylinder waterbody is developed whose length is 6600 mm and radius is 2500 mm which is 6 times of the maximum radius of the duct the density and bulk modulus of water is 1000 kg m3 and 2e9 pa respectively non reflecting acoustic boundaries are applied at the outside of the waterbody to investigate the effect of load applying method on the vibro acoustic responses four kinds of loads are applied for the coupled fem model i e applying the distributed pulsation force on pump jet wet surface applying the distributed pulsation force on rotor wet surface applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blades applying the equivalent pulsation force at the hub of the rotor after obtaining the velocity on the wet surface of the coupled pump jet shafting system suboff model the velocity is input to lms virtual lab as boundary conditions of the bem mesh the bem mesh includes the wet surface of the hull the wet surface of the duct the stator and the rotor direct bem is employed to calculate the pressure responses on the wet surface and the field points the structural and acoustic mesh size is smaller than 20 mm which will ensure an accurate result within 600 hz for both structural and acoustic responses since the maximum unit length of the acoustic grid is dx 1 6 c f max 0 208 m du et al 2019 3 modal results typical modal shapes of the coupled pump jet shafting system suboff model are shown in fig 11 the characteristic structural modes include the modes of the pump jet such as the mode of the duct the bending vibration mode of the rotor blades the modes of the hull such as the breathing mode in axial direction as well as the bending modes in vertical and transversal directions the swing mode of the sail cap the swing mode of the appendages the modes of the shaft such as the bending modes of the shaft the longitudinal modes of the shaft the modal frequencies are listed in table 3 and only some typical modes are given 4 force transmission force transmitted by bearings can demonstrate the transmission characteristics of the propulsion shafting system fig 12 illustrate force transmission of thrust bearings and stern tube bearings along its directions for different load applying methods the legends pump jet rotor 0 7 r hub denotes applying the distributed pulsation force on pump jet wet surface applying the distributed pulsation force on rotor wet surface applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blades applying the equivalent pulsation force at the hub of the rotor respectively for thrust bearing it is shown that the longitudinal transmitted force is almost the same for the distributed force applied at the pump jet and the distributed force applied at the rotor blades however the force applied at 0 7 r will underestimate the force transmission after 15 2 hz sf while the force applied at the hub will underestimate the force transmission in whole frequency range except at 135 2 hz bpf the largest peak for longitudinal force is at sf five remarkable peaks 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor 135 2 hz bpf and 164 5 hz sbpf as well as 391 4 hz rotor in phase mode dominate the longitudinal transmitted force the curve of lateral and vertical transmitted force by thrust bearing is similar and only vertical transmitted force is given for the vertical transmitted force the curve of the distributed force applied at the pump jet almost overlaps with that of the distributed force applied at the rotor in the studied frequency range the force applied at 0 7 r and the hub will overestimate or underestimate the force transmission at peaks in the whole studied frequency range unlike the longitudinal transmitted force the vertical transmitted force presents much more peaks at shaft frequency and its multiple frequencies the force applied at pump jet rotor and 0 7 r will share the same maximal peak value at 120 hz 8sf while the maximal peak value of force applied at hub is 135 2 hz bpf besides maximal peak at 120 hz the remarkable peaks are shaft frequency 15 2 hz 105 7 hz 7sf 135 2 hz bpf 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor for the vertical transmitted force of the stern tube bearing similar conclusions can be made as those for thrust bearing the remarkable peaks are shaft frequency 15 2 hz 105 7 hz 120 hz 8sf times shaft frequency 135 2 hz bpf 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor it is worth to mention that the longitudinal mode of shafting system is coupled with the lateral and vertical deformation of the rotor explaining that the lateral and vertical transmitted forces are also tonal at the frequencies of longitudinal modes of shafting system the lateral transmitted force of stern tube bearing presents more peaks in studied frequency range compared with that of thrust bearing the magnitude of the vertical transmitted force by the stern tube bearing at shaft frequency is an order smaller than the vertical transmitted force by the thrust bearing the magnitude of the lateral transmitted force by thrust bearing is larger than the lateral transmitted force by the stern tube bearing almost at the whole studied frequency range among these peak frequencies most of them correspond to the harmonics of shaft frequency which can find their counterparts in the force spectrum some of them are structural modes such as the hull bending mode the longitudinal mode of shafting system 5 underwater acoustic radiation sound radiation power level swl for different load applying methods are shown in fig 13 the sound radiation power produced by the distributed forces at rotor will dominate the responses of the pump jet the responses by applying the equivalent force at 0 7 r of each rotor blades will not present enough rotor modes compared with that by the distributed pulsation force at rotor since the modes of rotor are complex the equivalent forces at 0 7 r are concentrated and symmetric which is difficult to excite the irregular and asymmetric modes of the rotor blades for the vibro acoustic response produced by the equivalent force applied at the hub the swl magnitudes will be underestimated especially at low frequencies similar to the transmitted force the swl is also tonal at rotor harmonics and the typical resonant mode frequencies of the structure six remarkable peaks sorted by magnitudes in studied frequency range are 15 2 hz sf 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 164 5 hz sbpf 391 4 hz rotor in phase mode 135 2 hz bpf in addition small peaks appear at 104 9 hz 118 3 hz hull bending mode 150 4 hz 10sf 330 3 hz 22sf 335 1 hz hull longitudinal mode 360 8 hz pump jet mode it is worth to mention that the submarine s modes such as the bending modes contribute not so much to the swl owing to the fact that the force transmitted to hull from the stern tube bearing will not excited significant sound radiation and the force transmitted from the thrust bearing will firstly transmit to the bulkhead not transmit to the hull directly the peaks shown in force transmission of thrust bearing at 209 9 hz and 214 6 hz exhibit remarkable peaks in the swl result indicating that the longitudinal modes of shafting system contribute greatly to the sound radiation 6 radiation directivity pattern sound radiation directivity pattern is reported for the circular field points located at the cross section of the suboff the center of the circular field points is the origin of coordinates and the radius is 50 m the normal direction is along vertical direction and 36 points are evenly spaced in the circular sound radiation directivity pattern for four frequencies 15 2 hz sf 135 2 hz bpf 164 5 hz sbpf and 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor are given in fig 14 for directivity patterns at 164 5 hz and 209 9 hz the curves are almost overlapped one to each other for the distributed forces applied at the pump jet and the rotor only the radiation directivity pattern at 15 2 hz is oval since the length of the submarine is much smaller than the wavelength of underwater sound resulting in a homogenous sound radiation at all directions the radiation directivity pattern at 135 2 hz bpf is a little different at some directions for the distributed forces applied at the pump jet and the rotor only which implies that the distributed forces on the pump jet and the rotor are different at bpf since the duct and stator will also have a peak at bpf and produce sound radiation the radiation directivity pattern at 164 5 hz shapes as a dipole with the maximum sound radiation in longitudinal direction and minimum sound radiation in lateral direction the radiation directivity pattern at 209 9 hz is similar with that at 164 5 hz but with larger sound radiation in lateral direction the sound radiation in longitudinal direction is dominant since the mode at 209 4hz is the longitudinal mode of shafting system contributing most to the longitudinal vibro acoustic response the directivity pattern for the equivalent force applied at 0 7 r is similar to that for the distributed forces applied at the pump jet and the rotor at 164 5 hz and 209 9 hz though the response is smaller the directivity pattern for the equivalent force applied at the hub differs much from the others it is demonstrated that the acoustic responses produced by applying the distributed forces on the rotor are very similar to the acoustic responses produced by applying the distributed forces on the pump jet in most frequencies 7 panel contribution analysis the radiated sound pressure is contributed by different parts of the coupled pump jet shafting system suboff model the field point to evaluate the sound pressure is 50 m over the submarine center in vertical direction the bem mesh is divided into four areas hull rotor stator and duct to identify the contribution of each part the panel contribution calculated by eq 16 is plotted concerning these four areas and the results for the four load applying methods are shown in fig 15 it is shown that load applying methods pump jet rotor 0 7r share similar rules i e the rotor will contribute most near the shaft frequency and the hull will mainly contribute to the sound pressure at the rest of studied frequency range the frequency range for the hull dominated sound radiation locates at 104 9 hz 118 3 hz 209 9 hz 214 6 hz and 338 3 hz 360 4 hz 388 1 hz 391 6 hz 414 7 hz 357 4 hz 366 5 hz 538 7 hz 553 0 hz these frequency ranges will find their characteristic modes of the hull and shafting system that exhibit a strong radiation efficiency as shown in fig 14 however when applying the equivalent pulsation force at the hub the hull will contribute most to the sound pressure in most frequency range therefore by applying the pulsation force at the hub will not reflect the characteristics of a real coupled pump jet shafting system hull model excited by distributed forces through further examination on panel contribution it is confirmed that the acoustic responses produced by applying the distributed pulsation forces on the rotor wet surface are very similar to the acoustic responses produced by applying the distributed pulsation forces on the pump jet wet surface 4 conclusions the vibro acoustic characteristics of a coupled pump jet shafting system suboff model excited by the unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff are reported the excitations of the pump jet are obtained using cfd and the vibro acoustic responses are obtained by coupled fem and bem an interpolation method based on rbf is proposed to map the pressure calculated by cfd to that on the nodes of structural mesh with a high accuracy by employing the distributed pulsation forces on the pump jet wet surface the characteristics of vibro acoustic response are investigated it is shown that except for the characteristic tonal spectrums the vibro acoustic responses exhibit peaks at characteristic structural modes for instance the transmitted force through bearings exhibits peaks at the bending mode and longitudinal mode resonant frequencies of the hull as well as the longitudinal mode resonant frequencies of the shafting system the swl exhibits peaks at the longitudinal mode resonant frequencies of shafting system as well as the longitudinal mode resonant frequency of the hull the vibro acoustic responses under distributed unsteady hydrodynamics by different methods used to apply the excitation force are compared which are defined by applying the distributed pulsation pressure on rotor wet surface only applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blade applying the equivalent pulsation force at the hub of the rotor it is seen the responses produced by applying distributed forces on the whole pump jet present modes and excitation characteristics with more reasonable magnitudes compared with applying concentrated forces applied at hub or 0 7 r illustrating the importance of applying distribute pulsation forces when studying the vibro acoustic responses of pump jet propelled ships besides the vibro acoustic responses produced by applying the distributed forces on the rotor are very similar to those produced by applying the distributed forces on the pump jet in the aspect of spectrum radiation directivity pattern and panel contribution indicating the contribution of the distributed forces on rotor is dominant the hull will make contributions to radiated sound pressure in the frequency ranges where characteristic modes of the hull and shafting system with strong radiation efficiency locate since the vibration transmission paths of pump jet propelled submarine are complex due to the existence of duct and stators how the existence of duct and stators will influence the vibro acoustic responses of pump jet propelled submarine requires further investigation and this will be presented in our next paper credit authorship contribution statement zhiwei su writing original draft conceptualization developed the theoretical formalism and performed the numerical simulations shuaikang shi developed the theoretical formalism and performed the numerical simulations xiuchang huang writing original draft conceptualization zhiqiang rao developed the theoretical formalism and performed the numerical simulations hongxing hua writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully acknowledge the support for this work by the national natural science foundation of china nsfc under grant no 51875336 project sponsored by shanghai rising star program grant no 18qa1402000 
20519,this study presents the unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff model and the vibro acoustic characteristics of a coupled pump jet shafting system suboff model under unsteady excitations the excitations of the pump jet are obtained by cfd and the vibro acoustic responses are predicted by coupled fem bem a mapping method based on radial basis function is established between cfd and structural mesh to apply the distributed pulsation forces on the wet surface of the pump jet the effect of the method used to apply the excitation forces on vibro acoustic responses is investigated by applying distributed or equivalent pulsation forces at different areas of the pump jet modal shapes transmitted forces sound radiation power radiation directivity pattern and panel contributions are reported to illustrate the characteristics of the vibro acoustic responses and the influence of the method used to apply the excitation forces on the responses it is seen that the shaft frequency and the longitudinal mode resonant frequency of the shafting system are the typical characteristic frequencies with large magnitude in vibro acoustic responses of the coupled system compared with applying concentrated forces applied at hub or 0 7 r the responses produced by applying distributed forces on the whole pump jet present modes and excitation characteristics with more reasonable magnitudes illustrating the importance of applying distribute forces instead of concentrated forces besides the contribution of the distributed forces on rotor is dominant since the responses of applying distributed forces on the pump jet and applying distributed forces on rotor are similar keywords pump jet distributed hydrodynamic forces structural modes vibro acoustic response coupled fem bem 1 introduction the noise radiated by ships and vessels will cause damage for marine organism and also undermine the stealth for military ship in the low frequency range the propeller is one of the principal sources of noise rotation of the propeller results in discrete tonal at the blade passing frequency bpf and its harmonics as well as broadband exciting forces besides direct sound radiation into the far field the hydrodynamic forces may cause vibration of the hull through the propulsion shafting system and the fluid the characteristics of the excitation forces and resultant sound radiation are of interest for researchers wei and wang 2013 merz et al 2013 zhang et al 2014 pump jet has become a preferred propulsor of submerged bodies since its advantage to obtain a more uniform inflow to the rotor working inside a duct and its ability to improve the rotor blade cavitation and powering performance for the pump jet propelled ships the hydrodynamic pressures on the duct can also produce direct sound radiation and excite the hull through the stator li et al 2019 qin et al 2017 2019 which makes the characteristics of the vibro acoustic responses of a coupled pump jet shafting system hull model more complex in this study the vibro acoustic responses of a coupled pump jet shafting system suboff model under unsteady excitations of pump jet are investigated the hydrodynamic forces for a propeller or a pump jet propulsor can be predicted by employing the theoretical methods wang et al 2019 sánchez caja et al 2019 the numerical methods merz et al 2013 zhang et al 2014 du et al 2019 lu et al 2018 motallebi nejad et al 2017 ahn and kwon 2015 qiu et al 2020 such as unsteady reynolds average navier stokes urans and large eddy simulation les as well as the experimental methods vali et al 2018 shirazi et al 2019 suryanarayana et al 2010 the unsteady hydrodynamics of a propeller or pump jet behind circumferential nonuniform wake should take into account the mutual interaction of the thruster and of the hull the propulsor s hydrodynamic performance can usually be obtained by carrying experiments in a cavitation tunnel vali et al 2018 shirazi et al 2019 suryanarayana et al 2010 while the measurement of the unsteady force is difficult especially for distributed fluctuation pressure jessup and stuart 1990 one way to overcome this is to obtain the flow velocity distributions produced by the wake through a laser doppler velocimetry ldv system and then to compute the pressure fluctuations on the blade through numerical simulations such as urans and les tian et al 2017 the dynamic modelling of vibration transmission through the propulsion shafting system has been undertaken and the vibro acoustic responses have been predicted for the dynamic model of vibration transmission propellers are denoted as masses springs and beams as well as three dimensional solid elements youssef et al 2015 li et al 2016 huang et al 2017 2018 it is shown that a realistic propeller should be implemented into the dynamic model in order to investigate the influence of propeller flexibility on vibration transmission although a realistic propeller is employed in dynamic modelling the resultant vibro acoustic responses are still influenced by the way to apply the distributed fluctuation pressure to input the excitation the unsteady forces are often considered as concentrated unit or fluctuation forces applied at the hub or at 0 7r r is the radius of the propeller of the propeller blades li et al 2016 huang et al 2017 2018 for broadband force components the unsteady thrust spectrum is obtained and applied at each blade strip by mapping into the nodes on the loading surface of blades chen et al 2017a 2017b to account for the influences of pressure distribution on blades flexibility of the propeller and fluid loading coupled finite element method boundary element method fem bem has been developed to predict the vibro acoustic responses produced by the tonal spectrum unsteady forces applied at the propeller surface zou et al 2017 2019 li et al 2017 he et al 2012 young 2007 for more complex pump jet propelled ships few public researches are available according to the authors knowledge to account for mutual interaction of the propulsor and hull numerical methods are more suitable for submarines propelled by classical propellers several researches have been carried out for example the vibro acoustic responses of a suboff submarine excited by propeller s thrust and side forces has been reported by employing cfd and fem wei and wang 2013 it is shown that the spectrums of a single blade s forces differ a lot from the total blades forces which is attributed to the phase cancellation of different blade s forces however the propeller s force was taken as concentrated force when applied to the fem which ignores the distribution information of each blade force they also pointed out that this problem requires further consideration for the cruising condition the underwater sound radiation is dominated by the vibro acoustic responses of the hull excited by the propulsors and transmitted through structural parts according to the knowledge of the authors there are few public researches concerning with the vibro acoustic responses of the pump jet propelled submarines through shafting system compared to the case of classical propellers the vibro acoustic responses of the pump jet propelled submarines are more complex since the pump jet shafting system submarine will interact with each other to produce a more complex modal characteristic which is not clear due to the existence of duct and stators meanwhile the excitation pulsation pressures are distribution pressures on not only propeller blades but also stators and duct of which modes are excited and strongly contributed to the underwater sound radiation under the distributed pressure has not been reported in order to clarify the above problems the vibro acoustic responses of a pump jet propelled suboff model is researched in this paper aiming to investigate the modal characteristic and vibro acoustic responses of the pump jet propelled suboff model under distributed unsteady hydrodynamics by considering different methods to apply the loads the suboff model is referred to the aff8 darpa sub off model and studied by some researchers liefvendahl and troëng 2011 lungu 2019 chase 2012 after obtaining the distributed unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff model a mapping method based on radial basis function rbf is established between cfd mesh and structural mesh to obtain the distributed pulsation force on structural wet surface the distributed pulsation forces are transformed to frequency domain by fft and then applied individually at each node on the wet surface of the pump jet to yield vibro acoustic responses for the coupled pump jet shafting system suboff model the vibro acoustic responses by considering distributed pulsation force is compared with those obtained by concentrated force to show the importance of taking distribution information into consideration the unsteady hydrodynamics are simulating using ansys fluent commercial software the vibro acoustic responses are simulating using abaqus and virtual lab commercial software the paper is organized as follows in section 2 the fundamental theories on urans coupled fem and bem as well as rbf based mapping are briefly reviewed in section 3 numerical simulation is carried out in subsection 3 1 independent hydrodynamics of the pump jet and suboff are validated and the cfd model of a pump jet running in the wake of a suboff model is established then cfd results of pressure distribution before and after mapping are reported in subsection 3 2 coupled fem model and bem model of the pump jet shafting system suboff model are presented modal results are given firstly to provide analysis bases for the vibro acoustic results then force transmission through bearings sound radiation power level swl are reported and discussed to find the characteristic peaks for different force applying methods radiation directivity pattern is also illustrated to outline the difference between different force applying methods panel contribution analysis is carried out to identify the contribution of the rotor duct stator and hull to sound radiation finally concluding remarks are given 2 theories 2 1 unsteady hydrodynamics of pump jet behind suboff by urans the cfd method is utilized to calculate the pulsation pressure of the pump jet propulsor in the wake of submarine which is used as the excitation source of a coupled pump jet shafting system suboff model the sst k ω menter 1994 turbulence model is employed to obtain the pulsation pressure of the pump jet and submarine in the present simulations the continuity and the momentum equations are expressed as 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j f i ρ where i j 1 2 3 ρ is the density of the fluid p is the mean pressure f i is the body force and ρ u i u j is the reynold stress tensor that needs a closure to close the momentum equation one is based on the assumption of boussinesq s hypothesis the reynold stresses can be expressed as 3 ρ u i u j μ t u i x j u j x i 2 3 ρ k μ t u k x k δ i j according to the shear stress transport sst k ω turbulence model the turbulence kinetic energy k and the specific dissipation rate ω can be obtained from the following equations 4 t ρ k x i ρ k u i x j μ μ t σ k k x j g k ρ β k ω 5 t ρ ω x j ρ ω u j x j μ μ t σ ω ω x j g ω ρ β ω 2 d ω where σ k and σ w are the turbulent prandtl numbers for k and ω d ω is the cross diffusion term g k and g ω represent the generation of k and ω respectively and the turbulent viscosity μ t is defined as 6 μ t ρ k ω 1 max 1 α s f 2 α 1 ω where α and α 1 are the model coefficient and model constant and f 2 is the blending function 2 2 vibro acoustic responses of coupled pump jet shafting system suboff by coupled fem and bem the vibro acoustic responses of the coupled pump jet shafting system suboff model are calculated through 2 steps firstly the structural dynamics responses are calculated via coupled fem secondly the farfield acoustic radiation is calculated based on the vibration velocity on the wet surface by the bem firstly the coupled fem is employed to perform dynamic modeling of the coupled pump jet shafting system suboff structural model the equation of motion is denoted as huang et al 2020 7 m 0 η t π m a x p c 0 0 0 x p k h ρ 0 k a x p f 0 where x are the structural displacements of the structural nodes p are the pressures of nodes in the fluid f represents the unsteady forces of the pump jet m k and c are the structural mass matrix stiffness matrix and damping matrix of the pump jet shafting system suboff structural model c α m β k β k α and β are proportional damping constants for mass and stiffness matrix respectively m a k a and h denotes the mass matrix stiffness matrix of the acoustic medium the fluid structure coupling matrix respectively the structural mass matrix and stiffness matrix are obtained by assembly of the element mass matrix and element stiffness matrix in the global reference system for all the elements 8 k e 1 1 1 1 b t d b j d ξ d η m e 1 1 1 1 ρ s n t n j d ξ d η where ρ s is mass density of the structure j is the jacobi matrix n is the shape function matrix b is the strain displacement matrix d is the bending stiffness matrix the mass matrix and stiffness matrix of the acoustic medium the fluid structure coupling matrix are 9 m a 1 c 2 v a n ψ t n ψ d v k a v a n ψ t n ψ d v η ρ a a n ψ t n d a where c is acoustic velocity of the fluid ψ n ψ ψ w nw n ψ and ψ denotes shape function and nodal velocity potential vector of acoustic element respectively w denotes nodal displacement vector of the structural element on their boundary area a a respectively w πx π denotes the transformation matrix from the structural displacement vectors x to nodal displacement vector w of the structural element on the boundary area for harmonic excitation at angular frequency ω the displacement vectors are obtained as 10 k j ω c ω 2 m ω 2 1 ρ h k a ω 2 m a 1 η t π x f after obtaining the normal velocity of the α th node of the i th element on the boundary area v iα direct bem is employed to obtain the pressure vectors p iα the radiated power on their boundary area a a as well as the pressure in the far field p j bai et al 2013 11 i 1 l α a i j α p i α 4 π i 1 l e i j α p j i 1 l α b i j α v i α j 1 2 n o n b o u n d a r y a r e a a a 12 4 π p j i 1 l α a i j α p i α i 1 l α b i j α v i α j 1 2 m f i e l d p o int s where n is the number of surface nodes and m is the number of field points the coefficients are 13 a i j α a i n α ξ n exp j k r i j α ξ r i j α ξ j ξ d ξ 14 b i j α j ω ρ a i n α ξ exp j k r i j α ξ r i j α ξ j ξ d ξ 15 e i j α a 0 n 1 r i j α ξ j ξ d ξ where j ξ is the jacobian of the transformation a i is the area of the i th element and r i j α ξ is the distance between the j th field point and surface nodes and the α th node of the i th element n ξ represents the acoustic shape function of local coordinate ξ based on the sound pressure of a far field point p and the velocity of the radiating surface v n the panel contribution of different parts of the pump jet shafting system suboff model can be given by 16 p ω e 1 n p a t v e ω t v n e ω where the atv is the acoustic transfer vector the superscript e denotes an element contribution n p is the element numbers the acoustic contribution of a set of elements corresponding to a certain part of structure namely hull rotor duct stator in coupled pump jet shafting system suboff can be evaluated 2 3 mapping of distributed pulsation pressure on structural wet surface between cfd model and structural model based on radial basis function rbf the distributed pulsation pressures on the surface of rotor the stator and the duct obtained by cfd are mapped to the distributed excitation forces applied for nodes on the structural wet surface the mapping method is based on rbf which is used to build up function approximations of the form rao and yang 2017 17 j 1 n λ j ϕ x x j f j where ϕ x x j is a real valued function whose value depends only on the distance between the input and output points f j is represented as a sum of n rbfs each associated with a different center x j and weighted by an approximate coefficient λ j the weights λ j can be estimated using the matrix methods of linear least squares since the approximate function is linear in the weights λ j the rbf employed here is wedndland s c2 function which is expressed as 18 ϕ x x j 1 x x j 4 4 x x j 1 through mapping the distributed pressure at each element center on the structural wet surface is obtained the concentrated force on each node is produced by multiplying the distributed pressure with the area of the corresponding element this concentrated force is decomposed into three force components in cartesian coordinate system with the help of unit normal vector of the element 3 simulation and discussion 3 1 cfd model and unsteady pressure of pump jet behind suboff model a reduced scaled pump jet propulsor with 11 pre swirl stator blades and 9 rotor blades whose parameters are shown in table 1 is designed to match the suboff model the parameters of suboff submarine are listed in table 2 1 validation of cfd model for independent submarine and pump jet firstly the steady hydrodynamics of independent suboff submarine are studied and compared with experimental data to validate the accuracy of the cfd model then the cfd model of a pump jet propulsor with 5 pre swirl stator blades and 7 rotor blades is built and validated by the measured thrust and torque in the cavitation tunnel for the hydrodynamics of independent submarine a cylindrical computational domain in used the computational domain size is set according to ref wei and wang 2013 the domain extends one hull length upstream of the submarine model and two hull lengths downstream of the model thus being 4l in overall length the outer diameter of the circular computational domain is 10d sst k omega model is selected to close the calculation equation and the inflow velocity v s 3 051 m s re 1 2e6 the whole computational domain is discretized into hexahedral cells from a mesh independent analysis the resistance of the submarine converges at 103 23 n with 0 9 relative error compared to the experiment result when the total mesh number reaches 11 18 million and the y plus value of the most areas are between 1 and 2 the accuracy of the mesh and the simulation scheme are validated from the three aspects compared with the experimental results i e resistance at different speeds the axial wake fraction at the propeller disk and the pressure coefficient c p along the meridian line of the hull c p p p 0 0 5ρv s 2 where p is the local static pressure v s is the inlet velocity and p 0 is the ambient pressure bull 1996 as shown in fig 1 it is shown that the results are in good agreement with the experiment indicating the mesh and numerical scheme is accurate a pump jet propulsor with 5 stator blades and 7 rotor blades is modeled and experiment is carried out to validate the accuracy of cfd simulation the turbulence model and calculation method of pump jet are the same with what was used in the study of independent submarine the computational domain of the independent pump jet is shown in fig 2 the whole computational domain is discretized into hexahedral cells the stationary domain meshes is 5 0 million and the rotating domain meshes is 8 0 million the inlet of the computation domain is set as velocity inlet boundary condition where the velocity components are set as axial velocity with no radial and circumferential components for the outlet boundary the static pressure outlet boundary condition with a reference pressure of 0 pa is defined considering the rotation of rotor the whole computational domain is separated into two parts namely the rotating domain and the stationary domain the overlapped surfaces the interface of the rotating domain and the stationary domain between the stationary and the rotating domain are defined as sliding interfaces in order to exchange the flow field information between the stationary and the rotating domains simultaneously then the thrust coefficient k t the torque coefficient k q and the open water efficiency η 0 can be calculated via cfd with k t t r ρ n 2 d 4 k q q r ρ n 2 d 5 η 0 j 2 π k t k q where t r q r ρ n and d are rotor thrust torque the fluid density the revolution speed and the rotor diameter respectively j v a n d is the advance ratio v a is the inlet velocity to assure the reliability and efficiency of the developed numerical model experimental data available for the pump jet is used to validate the numerical results the experiment was carried out in the cavitation tunnel at shanghai jiaotong university as shown in fig 3 the values of k t k q and η 0 of the pump jet agree well with the experimental results 2 cfd model of a pump jet behind suboff after the cfd modeling scheme for independent suboff submarine and pump jet are validated the pump jet and submarine are now combined to obtain the unsteady forces the cfd model is established according to the previously verified grid division method and grid size the computational domain is also divided into stationary domain and a rotating domain and the stationary domain is divided into stator domain and hull domain as is shown in fig 4 the total meshes number of the computational domain is 22 5 million including 10 million for the hull domain 4 5 million for the stator domain and 8 million for the rotating domain the mesh of important parts of the computational domain is shown in fig 5 the inlet flow velocity is 3 05 m s and the rotor blades rotate at 15 rps rotation per second for unsteady calculation taking the steady flow result as initial condition the unsteady calculation is carried out with the time step 1 851e 5 s and a total simulation time of 1 3 s to obtain the unsteady forces 3 unsteady forces and mapping result fig 6 shows the time history and spectrum of the thrust lateral and vertical force for a single rotor blade the static data is neglected and only fluctuating value is presented for the time history results it is observed that the thrust has 11 peaks in one cycle corresponding to the 11 stator blades only one peak exists in the lateral and vertical force within one cycle and the pressure pulsation oscillates from 20n to 20n the spectrum of the thrust for a single blade mainly exhibits peaks at the shaft frequency sf for abbreviation and its multiplier the relatively high peak is 165 hz stator blade passing frequency sbpf for abbreviation and 60 hz 4sf the appearance of 60 hz reflects the fourth order non uniform flow field formed by the rudder on the stern of the hull as for the lateral force and the vertical force a very large peak appears at 15 hz sf it is worth noting that peaks also happen at 150 hz 10sf and 180 hz 12sf which correspond to the multiple sf adjacent to the number of stators the spectrum of each single blade will then be applied at 0 7 r of the middle line of each blade s pressure and suction face of the structural model to investigate the vibro acoustic response under this type of load applying method fig 7 shows the time history and spectrum of thrust lateral and vertical force for the rotor it is observed that there are 9 peaks in one cycle of the rotor corresponding to 9 rotor blades the lateral force and the vertical force of the rotor oscillates between 0 1 n and 0 2 n which is much smaller than that of a single blade the pattern of the single blade forces fluctuation and the excitation spectrums differ a lot from those of the rotor which is attributed to the phase cancellation of different blade s force when they are superimposed to yield the results of the rotor the spectrum of the thrust lateral and vertical force all exhibits strong peaks at 135 2 hz blade passing frequency bpf for abbreviation and its harmonics with the strongest peak at bpf the spectrum of rotor will then be applied at the hub of the rotor for the structural model to investigate the vibro acoustic response under this type of load applying method the pressure distributions after interpolation for different parts of the pump jet are plotted and compared with those by cfd to verify the accuracy of proposed mapping method the results at a time step of 5400 are shown in fig 8 the legend cfd mesh and fem mesh denotes the pressure distribution results directly computed by cfd and the results interpolated for fem mesh it is seen that the pressure distributions as well as the maximum minimum values are almost the same for different parts before and after mapping indicating the proposed mapping method is of high accuracy in order to further verify the accuracy of purposed mapping method in time domain force of a single blade during a period before and after interpolation was plotted in fig 9 it is seen that the difference is very small for forces in three directions therefore the accuracy of the proposed mapping method is high the distributed pulsation forces after interpolation are then applied at the whole pump jet structural nodes to investigate the vibro acoustic response 3 2 coupled fem and bem analysis 1 coupled fem model and bem model the fe model of the coupled pump jet shafting system suboff is established in abaqus as shown in fig 10 a the thickness of the hull shell is 6 mm which is modeled with 33861 s4r shell elements as shown in fig 10 b the shell of the suboff model is stiffened with t shape ring stiffeners which is modeled with 4354 b31 beam elements there are 4 bulkheads along the longitudinal direction the stator of the pump jet is supported at the stern of the suboff model the stator the duct and the rotor are modeled with 22641 c3d8 solid elements as shown in fig 10 c the length and radius of the shaft is 0 89 m and 0 022 m respectively the shaft is supported with a stern tube bearing at the stern of the hull and a thrust bearing at the center of the last bulkhead the shaft is modeled with b31 elements the lateral and vertical stiffness of the stern tube bearing is 4 5e9 n m and 1 7e8 n m respectively the longitudinal lateral and vertical stiffness of the thrust bearing is 6 6e8 n m 2 3e8 n m 6 7e8 n m respectively the material of the hull stiffeners and shaft the stators and the duct is steel the density elastic modulus and poisson s ratio of steel are 7850 kg m3 2 1e11 pa and 0 3 respectively a structural damping of 0 001 is set the material of the rotor is copper the density elastic modulus and poisson s ratio of steel are 8790 kg m3 1 1e11 pa and 0 3 respectively a structural damping of 0 001 is set considering the fluid structure interaction the surrounding fluid outside the suboff and the pump jet is also modeled to couple the pressure and structural velocity on the boundary nodes of the wet surface as shown in fig 10 d the wet surface of the coupled structural model is composed of the surface of the suboff hull the stator the rotor and the duct a cylinder waterbody is developed whose length is 6600 mm and radius is 2500 mm which is 6 times of the maximum radius of the duct the density and bulk modulus of water is 1000 kg m3 and 2e9 pa respectively non reflecting acoustic boundaries are applied at the outside of the waterbody to investigate the effect of load applying method on the vibro acoustic responses four kinds of loads are applied for the coupled fem model i e applying the distributed pulsation force on pump jet wet surface applying the distributed pulsation force on rotor wet surface applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blades applying the equivalent pulsation force at the hub of the rotor after obtaining the velocity on the wet surface of the coupled pump jet shafting system suboff model the velocity is input to lms virtual lab as boundary conditions of the bem mesh the bem mesh includes the wet surface of the hull the wet surface of the duct the stator and the rotor direct bem is employed to calculate the pressure responses on the wet surface and the field points the structural and acoustic mesh size is smaller than 20 mm which will ensure an accurate result within 600 hz for both structural and acoustic responses since the maximum unit length of the acoustic grid is dx 1 6 c f max 0 208 m du et al 2019 3 modal results typical modal shapes of the coupled pump jet shafting system suboff model are shown in fig 11 the characteristic structural modes include the modes of the pump jet such as the mode of the duct the bending vibration mode of the rotor blades the modes of the hull such as the breathing mode in axial direction as well as the bending modes in vertical and transversal directions the swing mode of the sail cap the swing mode of the appendages the modes of the shaft such as the bending modes of the shaft the longitudinal modes of the shaft the modal frequencies are listed in table 3 and only some typical modes are given 4 force transmission force transmitted by bearings can demonstrate the transmission characteristics of the propulsion shafting system fig 12 illustrate force transmission of thrust bearings and stern tube bearings along its directions for different load applying methods the legends pump jet rotor 0 7 r hub denotes applying the distributed pulsation force on pump jet wet surface applying the distributed pulsation force on rotor wet surface applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blades applying the equivalent pulsation force at the hub of the rotor respectively for thrust bearing it is shown that the longitudinal transmitted force is almost the same for the distributed force applied at the pump jet and the distributed force applied at the rotor blades however the force applied at 0 7 r will underestimate the force transmission after 15 2 hz sf while the force applied at the hub will underestimate the force transmission in whole frequency range except at 135 2 hz bpf the largest peak for longitudinal force is at sf five remarkable peaks 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor 135 2 hz bpf and 164 5 hz sbpf as well as 391 4 hz rotor in phase mode dominate the longitudinal transmitted force the curve of lateral and vertical transmitted force by thrust bearing is similar and only vertical transmitted force is given for the vertical transmitted force the curve of the distributed force applied at the pump jet almost overlaps with that of the distributed force applied at the rotor in the studied frequency range the force applied at 0 7 r and the hub will overestimate or underestimate the force transmission at peaks in the whole studied frequency range unlike the longitudinal transmitted force the vertical transmitted force presents much more peaks at shaft frequency and its multiple frequencies the force applied at pump jet rotor and 0 7 r will share the same maximal peak value at 120 hz 8sf while the maximal peak value of force applied at hub is 135 2 hz bpf besides maximal peak at 120 hz the remarkable peaks are shaft frequency 15 2 hz 105 7 hz 7sf 135 2 hz bpf 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor for the vertical transmitted force of the stern tube bearing similar conclusions can be made as those for thrust bearing the remarkable peaks are shaft frequency 15 2 hz 105 7 hz 120 hz 8sf times shaft frequency 135 2 hz bpf 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor it is worth to mention that the longitudinal mode of shafting system is coupled with the lateral and vertical deformation of the rotor explaining that the lateral and vertical transmitted forces are also tonal at the frequencies of longitudinal modes of shafting system the lateral transmitted force of stern tube bearing presents more peaks in studied frequency range compared with that of thrust bearing the magnitude of the vertical transmitted force by the stern tube bearing at shaft frequency is an order smaller than the vertical transmitted force by the thrust bearing the magnitude of the lateral transmitted force by thrust bearing is larger than the lateral transmitted force by the stern tube bearing almost at the whole studied frequency range among these peak frequencies most of them correspond to the harmonics of shaft frequency which can find their counterparts in the force spectrum some of them are structural modes such as the hull bending mode the longitudinal mode of shafting system 5 underwater acoustic radiation sound radiation power level swl for different load applying methods are shown in fig 13 the sound radiation power produced by the distributed forces at rotor will dominate the responses of the pump jet the responses by applying the equivalent force at 0 7 r of each rotor blades will not present enough rotor modes compared with that by the distributed pulsation force at rotor since the modes of rotor are complex the equivalent forces at 0 7 r are concentrated and symmetric which is difficult to excite the irregular and asymmetric modes of the rotor blades for the vibro acoustic response produced by the equivalent force applied at the hub the swl magnitudes will be underestimated especially at low frequencies similar to the transmitted force the swl is also tonal at rotor harmonics and the typical resonant mode frequencies of the structure six remarkable peaks sorted by magnitudes in studied frequency range are 15 2 hz sf 214 6 hz longitudinal mode of shafting system coupled with vertical deformation of rotor 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor 164 5 hz sbpf 391 4 hz rotor in phase mode 135 2 hz bpf in addition small peaks appear at 104 9 hz 118 3 hz hull bending mode 150 4 hz 10sf 330 3 hz 22sf 335 1 hz hull longitudinal mode 360 8 hz pump jet mode it is worth to mention that the submarine s modes such as the bending modes contribute not so much to the swl owing to the fact that the force transmitted to hull from the stern tube bearing will not excited significant sound radiation and the force transmitted from the thrust bearing will firstly transmit to the bulkhead not transmit to the hull directly the peaks shown in force transmission of thrust bearing at 209 9 hz and 214 6 hz exhibit remarkable peaks in the swl result indicating that the longitudinal modes of shafting system contribute greatly to the sound radiation 6 radiation directivity pattern sound radiation directivity pattern is reported for the circular field points located at the cross section of the suboff the center of the circular field points is the origin of coordinates and the radius is 50 m the normal direction is along vertical direction and 36 points are evenly spaced in the circular sound radiation directivity pattern for four frequencies 15 2 hz sf 135 2 hz bpf 164 5 hz sbpf and 209 9 hz longitudinal mode of shafting system coupled with lateral deformation of rotor are given in fig 14 for directivity patterns at 164 5 hz and 209 9 hz the curves are almost overlapped one to each other for the distributed forces applied at the pump jet and the rotor only the radiation directivity pattern at 15 2 hz is oval since the length of the submarine is much smaller than the wavelength of underwater sound resulting in a homogenous sound radiation at all directions the radiation directivity pattern at 135 2 hz bpf is a little different at some directions for the distributed forces applied at the pump jet and the rotor only which implies that the distributed forces on the pump jet and the rotor are different at bpf since the duct and stator will also have a peak at bpf and produce sound radiation the radiation directivity pattern at 164 5 hz shapes as a dipole with the maximum sound radiation in longitudinal direction and minimum sound radiation in lateral direction the radiation directivity pattern at 209 9 hz is similar with that at 164 5 hz but with larger sound radiation in lateral direction the sound radiation in longitudinal direction is dominant since the mode at 209 4hz is the longitudinal mode of shafting system contributing most to the longitudinal vibro acoustic response the directivity pattern for the equivalent force applied at 0 7 r is similar to that for the distributed forces applied at the pump jet and the rotor at 164 5 hz and 209 9 hz though the response is smaller the directivity pattern for the equivalent force applied at the hub differs much from the others it is demonstrated that the acoustic responses produced by applying the distributed forces on the rotor are very similar to the acoustic responses produced by applying the distributed forces on the pump jet in most frequencies 7 panel contribution analysis the radiated sound pressure is contributed by different parts of the coupled pump jet shafting system suboff model the field point to evaluate the sound pressure is 50 m over the submarine center in vertical direction the bem mesh is divided into four areas hull rotor stator and duct to identify the contribution of each part the panel contribution calculated by eq 16 is plotted concerning these four areas and the results for the four load applying methods are shown in fig 15 it is shown that load applying methods pump jet rotor 0 7r share similar rules i e the rotor will contribute most near the shaft frequency and the hull will mainly contribute to the sound pressure at the rest of studied frequency range the frequency range for the hull dominated sound radiation locates at 104 9 hz 118 3 hz 209 9 hz 214 6 hz and 338 3 hz 360 4 hz 388 1 hz 391 6 hz 414 7 hz 357 4 hz 366 5 hz 538 7 hz 553 0 hz these frequency ranges will find their characteristic modes of the hull and shafting system that exhibit a strong radiation efficiency as shown in fig 14 however when applying the equivalent pulsation force at the hub the hull will contribute most to the sound pressure in most frequency range therefore by applying the pulsation force at the hub will not reflect the characteristics of a real coupled pump jet shafting system hull model excited by distributed forces through further examination on panel contribution it is confirmed that the acoustic responses produced by applying the distributed pulsation forces on the rotor wet surface are very similar to the acoustic responses produced by applying the distributed pulsation forces on the pump jet wet surface 4 conclusions the vibro acoustic characteristics of a coupled pump jet shafting system suboff model excited by the unsteady hydrodynamics of the excitations from a pump jet running in the wake of a suboff are reported the excitations of the pump jet are obtained using cfd and the vibro acoustic responses are obtained by coupled fem and bem an interpolation method based on rbf is proposed to map the pressure calculated by cfd to that on the nodes of structural mesh with a high accuracy by employing the distributed pulsation forces on the pump jet wet surface the characteristics of vibro acoustic response are investigated it is shown that except for the characteristic tonal spectrums the vibro acoustic responses exhibit peaks at characteristic structural modes for instance the transmitted force through bearings exhibits peaks at the bending mode and longitudinal mode resonant frequencies of the hull as well as the longitudinal mode resonant frequencies of the shafting system the swl exhibits peaks at the longitudinal mode resonant frequencies of shafting system as well as the longitudinal mode resonant frequency of the hull the vibro acoustic responses under distributed unsteady hydrodynamics by different methods used to apply the excitation force are compared which are defined by applying the distributed pulsation pressure on rotor wet surface only applying the equivalent pulsation force at 0 7 r of the middle line of rotor on both pressure and suction faces of each rotor blade applying the equivalent pulsation force at the hub of the rotor it is seen the responses produced by applying distributed forces on the whole pump jet present modes and excitation characteristics with more reasonable magnitudes compared with applying concentrated forces applied at hub or 0 7 r illustrating the importance of applying distribute pulsation forces when studying the vibro acoustic responses of pump jet propelled ships besides the vibro acoustic responses produced by applying the distributed forces on the rotor are very similar to those produced by applying the distributed forces on the pump jet in the aspect of spectrum radiation directivity pattern and panel contribution indicating the contribution of the distributed forces on rotor is dominant the hull will make contributions to radiated sound pressure in the frequency ranges where characteristic modes of the hull and shafting system with strong radiation efficiency locate since the vibration transmission paths of pump jet propelled submarine are complex due to the existence of duct and stators how the existence of duct and stators will influence the vibro acoustic responses of pump jet propelled submarine requires further investigation and this will be presented in our next paper credit authorship contribution statement zhiwei su writing original draft conceptualization developed the theoretical formalism and performed the numerical simulations shuaikang shi developed the theoretical formalism and performed the numerical simulations xiuchang huang writing original draft conceptualization zhiqiang rao developed the theoretical formalism and performed the numerical simulations hongxing hua writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully acknowledge the support for this work by the national natural science foundation of china nsfc under grant no 51875336 project sponsored by shanghai rising star program grant no 18qa1402000 
